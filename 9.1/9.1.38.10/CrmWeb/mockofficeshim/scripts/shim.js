(window.webpackJsonp=window.webpackJsonp||[]).push([[2],[function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.INITIALIZER="Initializer",e.AUTHENTICATION_PROVIDER="AuthenticationProvider",e.ERROR_HANDLER="ErrorHandler",e.EVENT_MANAGER="EventManager",e.STORAGE="Storage",e.TELEMETRY_ARCHIVER="TelemetryArchiver",e.JS_API_PROVIDER="JsApiProvider",e.RESOURCE_MANAGER="ResourceManager",e.UI_MANAGER="UIManager",e.APP_CHECKER="AppChecker",e.COMPATIBILITY_CHECK="CheckCompatibility",e.CRM_PROVIDER="CRMProvider",e.EXCHANGE_PROVIDER="ExchangeProvider",e.EXCHANGE_API_PROVIDER="ExchangeApiProvider",e.DISPATCHER_COLLECTION="DispatcherCollection",e.DISPATCHER="Dispatcher",e.UNIFIED_CLIENT_LOADER="UnifiedClientLoader",e.WEB_SCRIPT_BRIDGE="WebScriptBridge",e.VALIDATE_USER="ValidateUser",e.DELEGATE_VALIDATOR="DelegateValidator",e.LOAD_TIMEOUT="LoadTimeout",e.COMPONENTS_LOADER="ComponentsLoader",e.PERFORMANCE="Performance",e.EMAIL_ENGAGEMENT="EmailEngagement",e.MAILBOX_ITEM_PROVIDER="MailboxItemProvider",e.CONTACT_TRACKING_MODULE="ContactTrackingModule",e.BOOT_MANAGER="BootManager",e.CONTACTS_MODULE_PROVIDER="ContactsModuleProvider",e.VALIDATE_OFFICEJS="OfficeJsValidator",e.STORAGE_VALIDATOR="StorageValidator",e}();t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(77),n(7)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorCode=n.default;var o=function(e){function t(n,o,i,a){var s=e.call(this,o)||this;return s.code=i,s.componentName=n,a&&(s.innerError=r.default.errorToObject(a),s.innerError.stack=void 0),Object.setPrototypeOf(s,t.prototype),s}return a(t,e),t.fromNativeError=function(e,n,r){var o=new t(e,r.message,n);return o.name=r.name,o.stack=r.stack,o},t.isNativeError=function(e){return!(e&&"componentName"in e)},t}(Error);t.ComponentError=o,t.default=o}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.MESSAGE_RECIPIENTS="MESSAGE_RECIPIENTS",e.MEETING_ATTENDEES="MEETING_ATTENDEES",e.ROOM_MAILBOXES="ROOM_MAILBOXES",e.HTML_BODY="HTML_BODY",e.PLAIN_BODY="PLAIN_BODY",e.EWS_URL="EWS_URL",e.EWS_TOKEN="EWS_TOKEN",e.ATTACHMENT_IDS="ATTACHMENT_IDS",e.RECEIVED_ON="RECEIVED_ON",e.IS_COMPOSE_MODE="IS_COMPOSE_MODE",e.IS_SENT="IS_SENT",e.IS_DELEGATED_MAILBOX="IS_DELEGATED_MAILBOX",e.ITEM_TYPE="ITEM_TYPE",e.SUBJECT="SUBJECT",e.TRACK_STATUS="TRACK_STATUS",e.TRACK_ALLOWED_STATUS="TRACK_ALLOWED_STATUS",e.MAILBOX_ITEM="MAILBOX_ITEM",e.MAILBOX_ITEM_FROM_SERVER="MAILBOX_ITEM_FROM_SERVER",e.SELECTED_RECIPIENT="SELECTED_RECIPIENT",e.USER_PROFILE_EMAIL_ADDRESS="USER_PROFILE_EMAIL_ADDRESS",e.IS_DESKTOP_OUTLOOK="IS_DESKTOP_OUTLOOK",e.RESOLVED_RECIPIENTS="RESOLVED_RECIPIENTS",e.IS_ORGANIZER_RESOLVED_AS_USER="IS_ORGANIZER_RESOLVED_AS_USER",e.IS_LIMITED_MODE="IS_LIMITED_MODE",e.LIMITED_MODE_NOTIFICATION_STATE="LIMITED_MODE_NOTIFICATION_STATE",e.KNOWN_ORG_SETTINGS="KNOWN_ORG_SETTINGS",e.IS_CHECKER_COMMAND_VISIBLE="IS_CHECKER_COMMAND_VISIBLE",e}();t.PropertyNames=n;var r=function(){function e(){}return e.SET_SUBJECT="SET_SUBJECT",e.INSERT_BODY="INSERT_BODY",e.TRACK="TRACK",e.UNTRACK="UNTRACK",e.SET_SELECTED_RECIPIENT="SET_SELECTED_RECIPIENT",e.ADD_ATTACHMENTS="ADD_ATTACHMENTS",e.FOLLOW="FOLLOW",e.UNFOLLOW="UNFOLLOW",e.GET_EMAIL_LINKS="GET_EMAIL_LINKS",e.SET_TRACKING_INFO="SET_TRACKING_INFO",e.REMOVE_TRACKING_INFO="REMOVE_TRACKING_INFO",e.RESOLVE_RECIPIENT_FROM_SCRATCH="RESOLVE_RECIPIENT_FROM_SCRATCH",e.RETRY_TRACK="RETRY_TRACK",e.OPEN_APPCHECKER="OPEN_APPCHECKER",e}();t.ActionNames=r}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(32),n(78)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.getQueryParams=function(){return n.default.getInstance().queryParams.queryParameters},t.isOfficeExists=function(){return!!this._window.Office},t}(r.default);t.default=o}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});t.MAILAPP_EVENT_NAME_PREFIX="mailapp_";t.UCI_EVENT_NAME_PREFIX="uci_";var r={MonitorFailure:"monitor_failure",MonitorSuccess:"monitor_success",Performance:"monitor_performance",TraceEvent:"trace"};t.EVENT_NAME=r;var o={Name:r.Performance,MetricName:"MetricName",MetricValue:"MetricValue",StartTime:"StartTime",StopTime:"StopTime",StopwatchName:"StopwatchName"};t.PerformanceEventParameterName=o;t.BrowserPerformanceEventParameterName={ConnectEnd:"connectEnd",ConnectStart:"connectStart",DomainLookupEnd:"domainLookupEnd",DomainLookupStart:"domainLookupStart",Duration:"duration",FetchStart:"fetchStart",ResourceName:"resourceName",RedirectEnd:"redirectEnd",RedirectStart:"redirectStart",RequestStart:"requestStart",ResponseEnd:"responseEnd",ResponseStart:"responseStart",DecodedBodySize:"decodedBodySize",EncodedBodySize:"encodedBodySize",NextHopProtocol:"nextHopProtocol",SecureConnectionStart:"secureConnectionStart",TransferSize:"transferSize",WorkerStart:"workerStart",Window:"window"};var i={Error:"Error",ErrorCode:"ErrorCode",Url:"Url",FunctionName:"FunctionName",FileName:"FileName",LineNumber:"LineNumber",ColumnNumber:"ColumnNumber",CallStack:"CallStack",ComponentErrorComponentName:"ComponentErrorComponentName",InnerError:"InnerError",InnerErrorComponentName:"InnerErrorComponentName"};t.ErrorEventParameterName=i;var a={Data:"Data",ComponentName:"ComponentName",TraceLevel:"TraceLevel",TimeSinceSessionInit:"TimeSinceSessionInit",NetworkConnectivityState:"NetworkConnectivityState",ShimContextId:"ShimContextId",IsFromCache:"IsFromCache",CallReason:"CallReason",RequestMethod:"RequestMethod",Parameters:"Parameters",MethodName:"MethodName",IsCryptoAvailable:"IsCryptoAvailable",Location:"Location",DiagnosticsName:"DiagnosticsName",Level:"Level",TrackStatus:"TrackStatus",ServerRequestId:"ServerRequestId",ClientRequestId:"ClientRequestId",AuthActivityId:"AuthActivityId",SuggestedMitigation:"SuggestedMitigation",Message:"Message",CallStack:"CallStack",ApplicationEventLevel:"ApplicationEventLevel",UserAgent:"UserAgent",Origin:"Origin"};t.EventParameterName=a;var s={SessionId:"SessionId",OrgId:"OrgId",ServerVersion:"ServerVersion",ShimVersion:"ShimVersion",HostName:"HostName",HostType:"HostType",HostVersion:"HostVersion",InstallId:"InstallId",HostPlatform:"HostPlatform",OWAView:"OWAView",DeploymentEnvironment:"DeploymentEnvironment",ExchangeDeploymentEnvironment:"ExchangeDeploymentEnvironment",Mode:"Mode",ItemType:"ItemType",MailboxId:"MailboxId",ExchangeServerVersion:"ExchangeServerVersion",EWSSchemaVersion:"EWSSchemaVersion"};t.SessionContextParameterName=s;var l=((n={ActivityId:"ActivityId",TimeCreated:"TimeCreated",SessionContextName:"SessionContext",EventContextName:"EventContext",SessionId:s.SessionId,ComponentName:a.ComponentName,TraceLevel:a.TraceLevel,SuggestedMitigation:a.SuggestedMitigation,Message:a.Message,CallStack:i.CallStack,Origin:a.Origin,UserAgent:a.UserAgent,OrgId:s.OrgId,ServerVersion:s.ServerVersion,HostType:s.HostType,MetricName:o.MetricName,StartTime:o.StartTime,MetricValue:o.MetricValue,InnerError:i.InnerError,InnerErrorComponentName:i.InnerErrorComponentName})[i.ErrorCode]=i.ErrorCode,n[a.ShimContextId]=a.ShimContextId,n);t.KnownEventParameterName=l;var u=[i.ErrorCode,a.ShimContextId];function c(e){return l&&!!l[e]}t.isKnownEventParamName=c,t.isKnownEventContextParamName=function(e){return c(e)&&-1!==u.indexOf(e)}}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(44),n(11),n(9),n(3),n(64)],void 0===(o=function(e,t,n,r,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){}return e.restrictedValue=function(){return"*** Restricted ***"},e.serializeEmailAddressDetails=function(t){return{recipientType:t&&t.recipientType,emailAddress:e.restrictedValue()}},e.serializeRecipientRecord=function(t){var n;if(!t||!t.entityReference)return null;var r=t.dataValues[o.PropertyNames.Role],i=r?a.default[r]:null,s=Object.assign({},t.dataValues,((n={})[o.PropertyNames.Email]=e.restrictedValue(),n[o.PropertyNames.Role]=i,n.name=e.restrictedValue(),n));return{entityReference:{Id:t.entityReference.Id&&t.entityReference.Id.guid,LogicalName:t.entityReference.LogicalName},dataValues:s}},e.serializeTrackStatus=function(t){return t?Object.assign(t.Clone(),{CrmRegardingObjectName:e.restrictedValue()}):null},e.defaultSetNotifyUpdate=function(e,t){e.notifyUpdate=function(n,r){t(void 0===n?e.accessor():n,r)}},e.serializeMailboxItem=function(t){if(t&&t.ItemType===r.default[r.default.appointment]){var o=n.default.cloneMailboxItem(t);return o.Location=e.restrictedValue(),o}return t},e.createRecipientsPollingFunction=function(t,n,r,o){return function(a){if(e.defaultSetNotifyUpdate(t,a),n.JsApiProvider.isComposeMode()){var s,l=function(){return i.default.setInterval((function(){t.accessor().then((function(e){return o(s,e)||a(Promise.resolve(e)),s=r(e),e})).catch((function(e){a(Promise.reject(e))}))}),5e3)};t.accessor().then((function(e){s=r(e);var t=l();n.UIManager.subscribeToErrorEvent((function(){i.default.clearInterval(t)}),(function(){t=l()}))})).catch((function(e){}))}}},e}();t.default=s}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.DOCUMENT="Document",e.NETWORK="Network",e.ACCOUNT="Account",e.APPLICATION="Application",e.DEVICE="Device",e.DATA="Data",e.NAVIGATION="Navigation",e.MULTIMEDIA="Multimedia",e.EXTERNAL_CONTEXT="ExternalContext",e.LOGGING="Logging",e.CONTACTS_MODULE="ContactsModule",e}();t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(25),n(19),n(118),n(1)],void 0===(o=function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.errorToObject=function(e){var t={};return"object"!=typeof e||Array.isArray(e)?e:(e?Object.getOwnPropertyNames(e).forEach((function(n){t[n]=e[n]})):t.error="undefined",t)},e.generateKey=function(){var e=r.default.crypto();if(e){var t=e.getRandomValues(new Uint32Array(4));return Array.prototype.slice.call(t).reduce((function(e,t){return e+t.toString(16)}),"")}return n.default.newGuid().guid.replace(/-/g,"")},e.parseToken=function(e){if(!e)throw new i.ComponentError("ParseToken","parseToken() requires a non-empty token",i.ErrorCode.GENERIC);var t=e.split(".")[1];if(!t)throw new i.ComponentError("ParseToken","parseToken() requires a well-formatted token",i.ErrorCode.GENERIC);var n=t.replace(/[-]/g,"+").replace(/[_]/g,"/").replace(/\r\n/g,"");try{return JSON.parse(r.default.atob(n))}catch(e){throw new i.ComponentError("ParseToken","atob() failed with error: "+e.message+". Token length: "+n.length,i.ErrorCode.GENERIC)}},e.intToHexString=function(e){var t=e;return t<0&&(t=t+4294967295+1),t.toString(16)},e.delay=function(e,t){return void 0===t&&(t=function(e){}),new Promise((function(n){return t(r.default.setTimeout(n,e))}))},e.createDeferredPromise=function(){var e,t,n=o.DeferredPromiseState.Pending;return{Promise:new Promise((function(r,i){e=function(e){n=o.DeferredPromiseState.Resolved,r(e)},t=function(e){n=o.DeferredPromiseState.Rejected,i(e)}})),Resolve:e,Reject:t,State:function(){return n}}},e.cleanupGuidFromString=function(e){return e.replace(/(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}/gi,"{Guid}")},e.isVersionGreater=function(e,t){for(var n=e.split("."),r=t.split("."),o=Math.max(n.length,r.length),i=0;i<o;i++){var a=parseInt(n[i],10),s=parseInt(r[i],10);if(!isNaN(a)&&!isNaN(s)){if(a===s)continue;return a<s}return o===r.length}return!1},e.parseMissingPrivilegeFromErrorMessage=function(e){var t=e.match(/is missing (prv(?:Create|Read|Write|Delete|Append|AppendTo|Assign|Share)[\w]+) privilege/i);return t?t[1]:""},e.isRequiredReadPrivilegeForEntities=function(t,n){return t.some((function(t){return e.isRequiredReadPrivilegeForEntity(t,n)}))},e.isRequiredReadPrivilegeForEntity=function(e,t){return("prvRead"+e).toLowerCase()===t.toLowerCase()},e.arrayDifference=function(e,t){return e.filter((function(e){return-1===t.indexOf(e)}))},e.isArrayEqual=function(e,t){return e.length+t.length===0||e.every((function(e,n){return e===t[n]}))},e.assignUpdates=function(e,t,n){var r=this;return t.reduce((function(e,t){var o=n?e.findIndex(n.bind(r,t)):e.indexOf(t);return-1===o?e.push(t):e[o]=t,e}),Array.from(e))},e}();t.default=a}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={principalEmail:"Mscrm.MailApp.principalEmail",sessionId:"UCISessionID",initTime:"UCIInitTime",perfMetricStore:"CRMMailAppPerformanceMetricStorageKey",tokenOnPrem:"MailApp.Token.OnPrem",tokenCallbackRest:"MailApp.Token.Callback.Rest",tokenCallbackEws:"MailApp.Token.Callback.Ews",tokenAdal:"MailApp.Token.Adal",appModuleIdsCache:"MailApp.CRMProvider.AppModuleIds",checkEntitiesReadPrivilegeCache:"MailApp.CRMProvider.CheckEntitiesReadPrivilegeCache",categoryNamesCache:"MailApp.CRMProvider.CategoryNames",getUserValidationCache:"MailApp.CRMProvider.GetUserValidationCache",isFeaturesEnabledCache:"MailApp.CRMProvider.IsFeaturesEnabledCache",whoAmICache:"MailApp.CRMProvider.WhoAmI",systemUsersCache:"MailApp.CRMProvider.SystemUsers",orgSettingsCache:"MailApp.CRMProvider.OrgSettings",loginDialogMode:"MailApp_LoginDialogMode",developerToolsEnabled:"DeveloperToolsSwitch",wsigninFailure:"wsigninFailure",showPerfWidget:"MailApp.ShowPerfWidget",ariaTelemetry:"MailApp.AriaTelemetry",storageValidation:"MailApp.Storage.Validation",storageVersion:"MailApp.Storage.Version",lastPinnedStateTimestamp:"LastPinnedStateTimestamp",unpinnedBootCount:"UnpinnedBootCount",onPremSignInUrl:"MailApp.OnPremSignInUrl",onPremSignOutUrl:"MailApp.OnPremSignOutUrl"}}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0});var o={User:"systemuser",Contact:"contact",Lead:"lead",Account:"account",Organization:"organization",Role:"role"};t.CrmTypeNames=o;var i=[o.Contact,o.Lead,o.User,o.Account];t.CheckEntitiesReadPrivilegeTypeNames=i;t.PropertyNames={Email:"emailaddress",StatusCode:"statecode",IsDisabled:"isdisabled",OwnerId:"ownerid",FollowEmail:"followemail",Role:"role"};var a=((n={})[o.User]="8",n[o.Contact]="2",n[o.Lead]="4",n[o.Account]="1",n);t.CrmTypeNamesToCodes=a;var s=((r={})[o.User]="fullname",r[o.Contact]="fullname",r[o.Lead]="fullname",r[o.Account]="name",r);t.CrmTypeNamesToNameFieldName=s;t.FcbNames={MailAppOpenRecordInBrowser:"FCB.MailAppOpenRecordInBrowser",MailAppResolveRecipientsToAccounts:"FCB.MailAppResolveRecipientsToAccounts",MailAppLimitedMode:"FCB.MailAppLimitedMode",TrackUsingCategoriesDefaultValue:"FCB.TrackUsingCategoriesDefaultValue",ForceUsageOfCustomProperties:"FCB.MailAppForceUsageOfCustomProperties",DisableMailAppChecker:"FCB.DisableMailAppChecker",MailAppEnableAppCheckerChromiumCheck:"FCB.MailAppEnableAppCheckerChromiumCheck",MailAppPinningStateNotification:"FCB.MailAppPinningStateNotification",MailAppEnableCategoriesAPI:"FCB.MailAppEnableCategoriesAPI",MailAppEnableAppointmentTimeChangedEvent:"FCB.MailAppEnableAppointmentTimeChangedEvent",OfficeMailAppEmailEngagement:"FCB.OfficeMailAppEmailEngagement",EmailEngagement:"FCB.EmailEngagement"};t.MailAppModuleUniqueName="AppforOutlookModule"}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.String=0]="String",e[e.Double=1]="Double",e[e.Integer=2]="Integer",e[e.Item=3]="Item",e[e.Calendar=4]="Calendar",e[e.Contacts=5]="Contacts",e[e.Message=6]="Message"}(n||(n={})),t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.message=0]="message",e[e.appointment=1]="appointment",e[e.contact=2]="contact",e[e.folder=3]="folder"}(n||(n={})),t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unspecified=0]="Unspecified",e[e.String=1]="String",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Boolean=4]="Boolean",e[e.Date=5]="Date"}(t.AWTPropertyType||(t.AWTPropertyType={})),function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(t.AWTPiiKind||(t.AWTPiiKind={})),function(e){e[e.NotSet=0]="NotSet",e[e.GenericContent=1]="GenericContent"}(t.AWTCustomerContentKind||(t.AWTCustomerContentKind={})),function(e){e[e.Low=1]="Low",e[e.Normal=2]="Normal",e[e.High=3]="High",e[e.Immediate_sync=5]="Immediate_sync"}(t.AWTEventPriority||(t.AWTEventPriority={})),function(e){e[e.NonRetryableStatus=1]="NonRetryableStatus",e[e.QueueFull=3]="QueueFull"}(t.AWTEventsDroppedReason||(t.AWTEventsDroppedReason={})),function(e){e[e.InvalidEvent=1]="InvalidEvent",e[e.SizeLimitExceeded=2]="SizeLimitExceeded",e[e.KillSwitch=3]="KillSwitch"}(t.AWTEventsRejectedReason||(t.AWTEventsRejectedReason={}))},function(e,t,n){var r,o;r=[n,t,n(33),n(51),n(56),n(36),n(17)],void 0===(o=function(e,t,n,r,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){}return e.createTextInput=function(e,t,o,i){return new r.default(n.default.String,e,t).AppendInput(o,i)},e.createNumberInput=function(e,t,o,i){return new r.default(n.default.Number,e,t).AppendInput(o,i)},e.createDoubleInput=function(e,t,o,i){return new r.default(n.default.Double,e,t).AppendInput(o,i)},e.createCheckbox=function(e,t,o){return new r.default(n.default.Boolean,e,t).AppendInput(o)},e.createDate=function(e,t,o){return new r.default(n.default.Date,e,t).AppendInput(i.formatDate(o,a.DATE_FORMAT))},e.createDateTime=function(e,t,o){return new r.default(n.default.DateTime,e,t).AppendInput(i.formatDate(o,a.DATE_TIME_FORMAT))},e.createTextArea=function(e,t,o){return new r.default(n.default.MultilineString,e,t).AppendInput(o)},e.createHTMLArea=function(e,t,o){return new r.default(n.default.HTMLString,e,t).AppendInput(o)},e.createSelect=function(e,t,o,i,a,s){void 0===a&&(a=!1),void 0===s&&(s=!1);var l={};return i.forEach((function(e){return l[e]=e})),new r.default(n.default.Boolean,e,t).AppendSelect(o,l,a,s)},e.createLocalizableSelect=function(e,t,o,i,a,s){return void 0===a&&(a=!1),void 0===s&&(s=!1),new r.default(n.default.Boolean,e,t).AppendSelect(o,i,a,s)},e.createRecipientsControl=function(e,t,o){return new r.default(n.default.RecipientsControl,e,t).AppendRecipients(o)},e.createRecipientControl=function(e,t,o){return new r.default(n.default.RecipientControl,e,t).AppendRecipient(o)},e.createSection=function(e,t,n){return new o.default(e,t,n)},e}();t.default=s}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(0),n(138),n(1),n(4)],void 0===(o=function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){this._methods={},this.bcd=e,this.applicationContext=t}return e.prototype.getTelemetryComponent=function(){return n.default.DISPATCHER+"."+this.namespace},e.prototype.getNamespace=function(){return this.namespace},e.prototype.registerMethods=function(){},e.prototype.registerMethodWithName=function(e,t,n,i){void 0===i&&(i={});var a=this.getTelemetryComponent()+".RegisterMethod";if(!t)return this.applicationContext.EventManager.ReportComponentFailure(new o.ComponentError(a,"Null argument passed to registerMethodWithName",o.ErrorCode.GENERIC));if(e in this._methods)this.applicationContext.EventManager.ReportTraceWarning(a,"Trying to register a method twice with the same name",{methodName:e});else{var s=new r.default(this,this.applicationContext,e,t,n,i);this._methods[e]=s}},e.prototype.callMethodWithName=function(e,t){var n=this.getTelemetryComponent()+".CallMethodWithName";if(!e||!t)return this.applicationContext.EventManager.ReportComponentFailure(new o.ComponentError(n,"Null argument passed into callMethodWithName",o.ErrorCode.GENERIC));var r=this._methods[e];if(!r)return this.applicationContext.EventManager.ReportComponentFailure(new o.ComponentError(n,"Attempting to call unknown method",o.ErrorCode.GENERIC),[{name:i.EventParameterName.Data,value:e}]);r.invoke(t)},e.prototype.deviceEvent=function(e,t){var r=this;this.applicationContext.ComponentsLoader.ensureComponentLoaded(n.default.WEB_SCRIPT_BRIDGE).then((function(){return r.applicationContext.Bridge.deviceEventWithNamespace(r.namespace,e,t)}))},e.prototype.getInitialState=function(){return{}},e.prototype.unload=function(){},e}();t.default=a}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Read=0]="Read",e[e.Compose=1]="Compose",e[e.Module=2]="Module"}(n||(n={})),t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NotLinked=0]="NotLinked",e[e.WillBeLinked=1]="WillBeLinked",e[e.IsLinked=2]="IsLinked",e[e.WillBeUnlinked=3]="WillBeUnlinked",e[e.WillBeUnlinkedAndDeleted=4]="WillBeUnlinkedAndDeleted",e[e.LinkFailed=5]="LinkFailed",e[e.InProgress=6]="InProgress"}(n||(n={})),t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.HOST_ELEMENT_ID="mockShimConfiguration";t.DATE_FORMAT="yyyy-MM-dd";t.DATE_TIME_FORMAT="yyyy-MM-ddTHH:mm"}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NotLinked=0]="NotLinked",e[e.IsLinked=1]="IsLinked",e[e.LinkFailed=2]="LinkFailed"}(n||(n={})),t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(78)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.getQueryParams=function(){var e={};if(this._window.location.search&&this._window.location.search.length>0)for(var t=this._window.location.search.substr(1).split("&"),n=0;n<t.length;n++){var r=t[n].split("=");e[r[0]]=r[1]}return e},t.isOfficeExists=function(){return!!this._window.Office},t.addAssociateActionFunction=function(){var e=this;this._window.associateActionFunction=function(t,n){e._window.Office.actions.associate(t,n)}},t}(n.default);t.default=r}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(39),n(10),n(65),n(88)],void 0===(o=function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t,n,r,i){return e.call(this,new o.default(t,n),r,i)||this}return a(t,e),t.prototype.toJson=function(){return JSON.stringify({PropertyId:r.default[this.propertyType]+" {00020329-0000-0000-c000-000000000046} Name "+this.propertyName,Value:this.propertyValue})},t.prototype.getInnerSoap=function(){return"<t:ExtendedProperty>\n\t\t\t\t\t"+this.property.toSoap()+"\n\t\t\t\t\t<t:Value>"+n.escapeXml(this.propertyValue)+"</t:Value>\n\t\t\t\t</t:ExtendedProperty>"},t}(i.default);t.default=s}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.TRACKING_STATE="crmLinkState",e.REGARDING_ID="crmRegardingId",e.REGARDING_OBJECT_TYPE="crmRegardingObjectType",e.REGARDING_OBJECT_NAME="Regarding",e.ID="crmid",e.IS_FOLLOWED="crmIsFollowed",e.OBJECT_TYPE_CODE="crmObjectTypeCode",e.TRACKING_STATE_TRACKER="crmLinkStateTracker",e.SSS_PROMOTE_TRACKER="crmSssPromoteTracker",e.IS_TRACKED_FROM_MAILAPP="crmTrackedFromMailApp",e.CRM_CATEGORY_TRACKER="crmCategoryTracker",e.TRACK_TIMESTAMP="crmTrackTimestamp",e.CUSTOM_PROPERTIES="cecp-270a343c-ce6e-4c7e-be25-f29abe0e089b",e}();t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prefillValueIfRequired=function(e){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return"<generated>"===e?""+t()+t()+"-"+t()+"-"+t()+"-"+t()+t()+t():e}}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r,o){for(var i in this._supportMultiSelect=r,this._alowEmpty=o,this.ELEMENT=document.createElement("select"),this.ELEMENT.id=e,this.ELEMENT.className="mockShimControl",this._supportMultiSelect&&(this.ELEMENT.multiple=!0),this._alowEmpty&&(n["-- None --"]="-- None --",t||(t="-- None --")),n){var a=document.createElement("option");a.value=n[i],a.text=i,this._supportMultiSelect?a.selected=-1!==t.indexOf(i):a.selected=t===i,this.ELEMENT.appendChild(a)}}return Object.defineProperty(e.prototype,"VALUE",{get:function(){for(var e=[],t=0;t<this.ELEMENT.children.length;t++)this.ELEMENT.children[t].selected&&e.push(this.ELEMENT.children[t].value);return this._supportMultiSelect?e:this._alowEmpty&&"-- None --"===e[0]?null:e[0]?e[0]:""},set:function(e){var t=this;this._supportMultiSelect?e.forEach((function(e){return t._createAndSelectElementIfAbsent(e)})):this._createAndSelectElementIfAbsent(e);for(var n=0;n<this.ELEMENT.children.length;n++)this._supportMultiSelect?this.ELEMENT.children[n].selected=-1!==e.indexOf(this.ELEMENT.children[n].value):this.ELEMENT.children[n].selected=this.ELEMENT.children[n].value===e},enumerable:!0,configurable:!0}),e.prototype._createAndSelectElementIfAbsent=function(e){for(var t=!1,n=0;n<this.ELEMENT.children.length&&!(t=t||this.ELEMENT.children[n].value===e);n++);if(!t){var r=document.createElement("option");r.value=e,r.text=e,r.selected=!0,this.ELEMENT.appendChild(r)}},e}();t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){void 0===n&&(n="text"),this.ELEMENT=document.createElement("input");try{this.ELEMENT.type=n}catch(e){window.console&&window.console.error("Can't assign input type: '"+n+"', error: "+e.message)}this.ELEMENT.id=e,this.ELEMENT.name=e,null!=t&&(this.ELEMENT.value=t),this.ELEMENT.className="mockShimControl"}return Object.defineProperty(e.prototype,"VALUE",{get:function(){return this.ELEMENT.value},set:function(e){this.ELEMENT.value=e},enumerable:!0,configurable:!0}),e}();t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=/^({?)((\d|[a-f]){8}-(\d|[a-f]){4}-(\d|[a-f]){4}-(\d|[a-f]){4}-(\d|[a-f]){12})(}?)$/,r=/^([a-f\d]{8})([a-f\d]{4})([a-f\d]{4})([a-f\d]{4})([a-f\d]{12})$/,o=function(){function e(t){var n=e._formatGuidString(t);if(!n)throw new Error(t+" is not a valid Guid value.");this.guid=n,Object.freeze(this)}return e.externalGuid=function(t){return t?"{"+t.guid.toUpperCase()+"}":e.EMPTYSTRING},e.fromExternalGuid=function(t){return t?new e(t.replace(/[\{\}]/gi,"")):e.EMPTY},e.toString=function(e){return e?e.guid:null},e.tryParse=function(t){return e.tryParseOrNull(t)||e.EMPTY},e.tryParseOrNull=function(t){var n=e._formatGuidString(t);return n?new e(n):null},e.parse=function(t){return new e(t)},e._formatGuidString=function(e){if(!e)return null;e=e.toLowerCase();var t=n.exec(e);if(t)return t[1].length!==t[8].length?null:t[2];var o=r.exec(e);return o?o.filter((function(e,t){return t>0})).join("-"):null},e.equals=function(t,n){return null==t||null==n?t===n:e.toString(t)===e.toString(n)},e.isNullOrEmpty=function(t){return!t||e.equals(t,e.EMPTY)},e.newGuid=function(){for(var t="",n=0;n<36;n++)if(14===n)t+="4";else if(8===n||13===n||18===n||23===n)t+="-";else if(19===n){var r=Math.floor(16*Math.random());t+="0123456789abcdef".substr(3&r|8,1)}else t+="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return new e(t)},e.EMPTY=new e("00000000-0000-0000-0000-000000000000"),e.EMPTYSTRING="",e}();t.default=o}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(19)],void 0===(o=function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.query=function(e,t){return(e.match(/^#[a-zA-Z0-9-_]+$/)&&!t?n.default.document().getElementById(e.slice(1,e.length)):(t||n.default.document()).querySelector(e))||n.default.document().createElement("div")},e.queryById=function(t,n){return e.query("#"+t,n)},e.queryAll=function(e){return n.default.document().querySelectorAll(e)},e.createFragment=function(e){return n.default.document().createRange().createContextualFragment(e)},e.removeElement=function(t){var n=e.query(t);return n&&n.parentNode.removeChild(n)},e.prepend=function(t,n){var r=e.query(t);r.insertBefore(n,r.firstChild)}}(r||(r={})),t.default=r}.apply(t,r))||(e.exports=o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(50),o=n(12),i=/[xy]/g;t.EventNameAndTypeRegex=/^[a-zA-Z]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,t.EventNameDotRegex=/\./g,t.PropertyNameRegex=/^[a-zA-Z](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,t.StatsApiKey="a387cfcf60114a43a7699f9fbb49289e-9bceb9fe-1c06-460f-96c5-6a0b247358bc-7238";var a=null,s=null,l=null;function u(e){return"string"==typeof e}function c(e){return"number"==typeof e}function d(e){return"boolean"==typeof e}function p(e){return e instanceof Date}function f(e){return 1e4*(e+621355968e5)}function _(){return!("undefined"==typeof navigator||!navigator.product)&&"ReactNative"===navigator.product}function h(e){return e<10?"0"+e:e.toString()}function m(e){return null==e||""===e}t.numberToBondInt64=function(e){var t=new r.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},t.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(i,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},t.isString=u,t.isNumber=c,t.isBoolean=d,t.isDate=p,t.msToTicks=f,t.getTenantId=function(e){var t=e.indexOf("-");return t>-1?e.substring(0,t):""},t.isBeaconsSupported=function(){return null===a&&(a="undefined"!=typeof navigator&&Boolean(navigator.sendBeacon)),a},t.isUint8ArrayAvailable=function(){return null===s&&(s="undefined"!=typeof Uint8Array&&!function(){if("undefined"!=typeof navigator&&navigator.userAgent){var e=navigator.userAgent.toLowerCase();if((e.indexOf("safari")>=0||e.indexOf("firefox")>=0)&&e.indexOf("chrome")<0)return!0}return!1}()&&!_()),s},t.isPriority=function(e){return!(!c(e)||!(e>=1&&e<=3||5===e))},t.sanitizeProperty=function(e,n){return!t.PropertyNameRegex.test(e)||m(n)?null:(m(n.value)&&(n={value:n,type:o.AWTPropertyType.Unspecified}),n.type=function(e,t){switch(t=function(e){if(c(e)&&e>=0&&e<=4)return!0;return!1}(t)?t:o.AWTPropertyType.Unspecified){case o.AWTPropertyType.Unspecified:return function(e){switch(typeof e){case"string":return o.AWTPropertyType.String;case"boolean":return o.AWTPropertyType.Boolean;case"number":return o.AWTPropertyType.Double;case"object":return p(e)?o.AWTPropertyType.Date:null}return null}(e);case o.AWTPropertyType.String:return u(e)?t:null;case o.AWTPropertyType.Boolean:return d(e)?t:null;case o.AWTPropertyType.Date:return p(e)&&NaN!==e.getTime()?t:null;case o.AWTPropertyType.Int64:return c(e)&&e%1==0?t:null;case o.AWTPropertyType.Double:return c(e)?t:null}return null}(n.value,n.type),n.type?(p(n.value)&&(n.value=f(n.value.getTime())),n.pii>0&&n.cc>0?null:n.pii?function(e){if(c(e)&&e>=0&&e<=13)return!0;return!1}(n.pii)?n:null:n.cc?function(e){if(c(e)&&e>=0&&e<=1)return!0;return!1}(n.cc)?n:null:n):null)},t.getISOString=function(e){return e.getUTCFullYear()+"-"+h(e.getUTCMonth()+1)+"-"+h(e.getUTCDate())+"T"+h(e.getUTCHours())+":"+h(e.getUTCMinutes())+":"+h(e.getUTCSeconds())+"."+function(e){if(e<10)return"00"+e;if(e<100)return"0"+e;return e.toString()}(e.getUTCMilliseconds())+"Z"},t.useXDomainRequest=function(){if(null===l){var e=new XMLHttpRequest;l=void 0===e.withCredentials&&"undefined"!=typeof XDomainRequest}return l},t.isReactNative=_},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TrackCategorizedItems={name:"TrackCategorizedItems",enabledValue:"True",defaultValue:!1};t.TrackAppointmentsFromNonOrganizer={name:"TrackAppointmentsFromNonOrganizer",enabledValue:"True",defaultValue:!0};t.DelegateAccessEnabled={name:"DelegateAccessEnabled",enabledValue:"True",defaultValue:!0};t.CreateContactWithoutTracking={name:"CreateContactWithoutTracking",enabledValue:"True",defaultValue:!1};t.EmailInReadModeTrackEnabled={name:"EmailInReadModeTrackEnabled",enabledValue:"True",defaultValue:!1};t.OverrideTrackInCrmBehaviour={name:"OverrideTrackInCrmBehaviour",enabledValue:"1",defaultValue:!1}}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(19)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){if(this._isBrowserSafari=!1,e._instance)throw new Error("UserAgent.getInstance() should be used instead of new()");this._rawValue=n.default.navigator().userAgent;var t=this._rawValue.toLowerCase();this._isBrowserIE=-1!==t.indexOf("msie 10")||-1!==t.indexOf("msie 9.0")||-1!==t.indexOf("trident"),this._isBrowserEdge=(-1!==t.indexOf("edge")||-1!==t.indexOf("edg"))&&!this._isBrowserIE,this._isBrowserChrome=-1!==t.indexOf("chrome")&&!this._isBrowserIE&&!this._isBrowserEdge,this._isBrowserFirefox=-1!==t.indexOf("firefox"),-1===t.indexOf("safari")||this._isBrowserIE||this._isBrowserEdge||(-1!==t.indexOf("chrome")||-1!==t.indexOf("android")?this._isBrowserSafari=!1:this._isBrowserSafari=!0),this._isIPhone=-1!==t.indexOf("iphone"),this._isIPad=-1!==t.indexOf("ipad"),this._isIPod=-1!==t.indexOf("ipod"),this._isAndroid=-1!==t.indexOf("android"),this._isAndroidPhone=this._isAndroid&&-1!==t.indexOf("mobile"),this._isWebKit=-1!==t.indexOf("webkit")&&!this._isBrowserIE,this._isMac=-1!==n.default.navigator().appVersion.indexOf("Mac"),this._isWindows=-1!==n.default.navigator().appVersion.indexOf("Win")||-1!==n.default.navigator().appVersion.indexOf("NT"),this._isWindows80=-1!==n.default.navigator().appVersion.indexOf("Windows NT 6.2"),this._isWindowsDesktop=this._isWindows&&-1!==n.default.navigator().appVersion.indexOf("NT"),this._isWindowsPhone=this._isWindows&&-1!==n.default.navigator().appVersion.indexOf("Phone"),this._isWindows81=-1!==n.default.navigator().appVersion.indexOf("Windows NT 6.3")}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype._parseIOSVersion=function(){return this._parseVersionInteger(new RegExp("OS (\\d+)_(\\d+)_?(\\d+)?"))},e.prototype._parseVersionInteger=function(e){var t=this._rawValue.match(e);return t&&t.length>1?parseInt(t[1],10):-1},e.prototype._parseAndroidVersion=function(){return this._parseVersionFloat("Android")},e.prototype._parseVersionFloat=function(e){var t=this._rawValue.indexOf(e);if(-1!==t){var n=this._rawValue.substring(t+e.length+1,t+e.length+4);return parseFloat(n)}return-1},e.prototype.getIsBrowserIE=function(){return this._isBrowserIE},e.prototype.getIsBrowserEdge=function(){return this._isBrowserEdge},e.prototype.getIsBrowserChrome=function(){return this._isBrowserChrome},e.prototype.getIsBrowserFirefox=function(){return this._isBrowserFirefox},e.prototype.getIsBrowserSafari=function(){return this._isBrowserSafari},e.prototype.isRequiredApiSupported=function(){return"undefined"!=typeof MutationObserver&&"undefined"!=typeof requestAnimationFrame},e.prototype._checkSupportedVersion=function(e,t,n){return!!e&&(t>=n||-1===t)},e.prototype.getIsIPhone=function(){return this._isIPhone},e.prototype.getIsIOSSupported=function(){return this._checkSupportedVersion(this._isIPhone||this._isIPad||this._isIPod,this._parseIOSVersion(),5)},e.prototype.getIsIPad=function(){return this._isIPad},e.prototype.getIsIPod=function(){return this._isIPod},e.prototype.getIsAndroidSupported=function(){return this._checkSupportedVersion(this._isAndroid,this._parseAndroidVersion(),4.4)},e.prototype.getIsChromiumCoreVersionNotLess=function(e){return this._checkSupportedVersion(this._isBrowserChrome||this._isBrowserEdge,this._parseVersionFloat("Chrome"),e)},e.prototype.getIsMac=function(){return this._isMac},e.prototype.getIsWindows=function(){return this._isWindows},e.prototype.getIsWindows80=function(){return this._isWindows80},e.prototype.getIsWindowsDesktop=function(){return this._isWindowsDesktop},e.prototype.getIsWindowsPhone=function(){return this._isWindowsPhone},e.prototype.getIsWindows81=function(){return this._isWindows81},e.prototype.getIsAndroidPhone=function(){return this._isAndroidPhone},e.prototype.getIsAndroid=function(){return this._isAndroid},e.prototype.getBrowserName=function(){return this.getIsBrowserChrome()?"Chrome":this.getIsBrowserEdge()?"Edge":this.getIsBrowserIE()?"IE":this.getIsBrowserFirefox()?"Firefox":this.getIsBrowserSafari()?"Safari":"Other"},e}();t.default=r}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.CALENDAR_ITEM_TYPE="CalendarItemType",e.LOCATION="Location",e.RECURRENCE="Recurrence",e.IS_ALL_DAY_EVENT="IsAllDayEvent",e.RECURRENCE_PATTERN="Pattern",e.CONVERSATION_INDEX="ConversationIndex",e.UID="UID",e.DATE_TIME_SENT="DateTimeSent",e.DATE_TIME_RECEIVED="DateTimeReceived",e.CATEGORIES="Categories",e.ATTACHMENTS="Attachments",e.ATTACHMENT_ID="AttachmentId",e.LAST_MODIFIED_TIME="LastModifiedTime",e.LEGACY_FREE_BUSY_STATUS="LegacyFreeBusyStatus",e.INTERNET_MESSAGE_ID="InternetMessageId",e.IMPORTANCE="Importance",e}();t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.addNotificationListener=function(e){this.listeners.push(e)},e.removeNotificationListener=function(e){for(var t=this.listeners.indexOf(e);t>-1;)this.listeners.splice(t,1),t=this.listeners.indexOf(e)},e.eventsSent=function(e){for(var t=this,n=function(n){r.listeners[n].eventsSent&&setTimeout((function(){return t.listeners[n].eventsSent(e)}),0)},r=this,o=0;o<this.listeners.length;++o)n(o)},e.eventsDropped=function(e,t){for(var n=this,r=function(r){o.listeners[r].eventsDropped&&setTimeout((function(){return n.listeners[r].eventsDropped(e,t)}),0)},o=this,i=0;i<this.listeners.length;++i)r(i)},e.eventsRetrying=function(e){for(var t=this,n=function(n){r.listeners[n].eventsRetrying&&setTimeout((function(){return t.listeners[n].eventsRetrying(e)}),0)},r=this,o=0;o<this.listeners.length;++o)n(o)},e.eventsRejected=function(e,t){for(var n=this,r=function(r){o.listeners[r].eventsRejected&&setTimeout((function(){return n.listeners[r].eventsRejected(e,t)}),0)},o=this,i=0;i<this.listeners.length;++i)r(i)},e.listeners=[],e}();t.default=r},function(e,t,n){var r,o;r=[n,t,n(22),n(13),n(57),n(58),n(59),n(60)],void 0===(o=function(e,t,n,r,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(){var e=this;this._mockOfficeShimConfiguration=window.mockOfficeShimConfiguration,this._elementsCollection={},this.userProfile=new a.default(this._mockOfficeShimConfiguration),this._initUI(),this.queryParams=new i.default(this._mockOfficeShimConfiguration),this.mailboxItem=new o.default(this._mockOfficeShimConfiguration,this.queryParams),this.exchangeConfig=new s.default(this._mockOfficeShimConfiguration,this.mailboxItem.itemTypeControl),this.configured=new Promise((function(t,n){var r=document.getElementById("mockShimConfiguration"),o=document.createElement("input");o.type="button",o.value="Start Mail App!",o.className="mockShimStartButton",o.addEventListener("click",(function(){o.disabled=!0,o.style.display="none",e._flushConfig(),t()})),r.appendChild(o)}))}return Object.defineProperty(e.prototype,"ElementsCollection",{get:function(){return this._elementsCollection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayLanguage",{get:function(){return this._mockOfficeShimConfiguration.displayLanguage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"installId",{get:function(){return this._mockOfficeShimConfiguration.installId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"queryParameters",{get:function(){return this._mockOfficeShimConfiguration.queryParameters},enumerable:!0,configurable:!0}),e.prototype._flushConfig=function(){this._elementsCollection.DISPLAY_LANGUAGE.DISABLED=!0,this._elementsCollection.INSTALL_ID.DISABLED=!0,this.queryParams.FlushConfig(),this.mailboxItem.FlushConfig(),this.userProfile.FlushConfig()},e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype._initUI=function(){this._elementsCollection.DISPLAY_LANGUAGE=r.default.createTextInput("DISPLAY_LANGUAGE","Display Language",this._mockOfficeShimConfiguration.displayLanguage).Hide(),this._elementsCollection.INSTALL_ID=r.default.createTextInput("INSTALL_ID","Install ID",n.prefillValueIfRequired(this._mockOfficeShimConfiguration.installId)).Hide()},e}();t.default=l}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.String=0]="String",e[e.Number=1]="Number",e[e.Double=2]="Double",e[e.Boolean=3]="Boolean",e[e.DateTime=4]="DateTime",e[e.Date=5]="Date",e[e.MultilineString=6]="MultilineString",e[e.HTMLString=7]="HTMLString",e[e.Selector=8]="Selector",e[e.RecipientsControl=9]="RecipientsControl",e[e.RecipientControl=10]="RecipientControl"}(n||(n={})),t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.ELEMENT=document.createElement("textarea"),this.ELEMENT.id=e,this.ELEMENT.value=t,this.ELEMENT.className="wideControl mockShimControl"}return Object.defineProperty(e.prototype,"VALUE",{get:function(){return this.ELEMENT.value},set:function(e){this.ELEMENT.value=e},enumerable:!0,configurable:!0}),e}();t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=["user","distributionList","externalUser","other"]}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";function n(e,t){var n=e<0;n&&(e=-e);for(var r=""+e;r.length<t;)r="0"+r;return n&&(r="-"+r),r}Object.defineProperty(t,"__esModule",{value:!0}),t.intToString=n,t.formatDate=function(e,t){var r=e.getSeconds(),o=e.getMinutes(),i=e.getHours(),a=e.getDate(),s=e.getMonth()+1,l=i<12?"AM":"PM",u=i%12;return 0===u&&(u=12),t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace("ss",n(r,2))).replace("s",n(r))).replace("mm",n(o,2))).replace("m",n(o))).replace("HH",n(i,2))).replace("H",n(i))).replace("hh",n(u,2))).replace("h",n(u))).replace("dd",n(a,2))).replace("d",n(a))).replace("MM",n(s,2))).replace("M",n(s))).replace("yyyy",n(e.getFullYear()))).replace("a",l)}}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(1)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="undefined"!=typeof WeakMap?new WeakMap:null,o=function(e){function t(n,o,i,a){var s=e.call(this,n,o,i)||this;return r&&r.set(s,a),Object.setPrototypeOf(s,t.prototype),s}return a(t,e),Object.defineProperty(t.prototype,"errorMessageParameters",{get:function(){return r?r.get(this):[]},enumerable:!0,configurable:!0}),t.createFromComponentError=function(e,n){return new t(e.componentName,e.message,e.code,n)},t}(n.default);t.default=o}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.OnPremise=0]="OnPremise",e[e.Online=1]="Online"}(n||(n={})),t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&apos;"},r=new RegExp("[<>&\"']","g");t.formatArrayToString=function(e,t,n){return void 0===n&&(n=""),e&&e instanceof Array&&0!==e.length?e.map(t).join(n):""},t.escapeXml=function(e){return e.replace(r,(function(e){return n[e]}))},t.combineObjects=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce((function(e,t){return Object.keys(t).filter((function(e){return t.hasOwnProperty(e)})).forEach((function(n){return e[n]=t[n]})),e}),{})}}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(1),n(85),n(134),n(86),n(7),n(29)],void 0===(o=function(e,t,n,r,o,i,a,s){"use strict";var l;function u(e){if(!e)return Error("No error data provided.");if(e instanceof Error&&e.message)return e;if(e.error instanceof Error&&e.error.message)return e.error;var t=Error(e.message||e.errorMessage);if(e.errorType===r.ErrorType.UnhandledError&&(t.name="UnhandledError"),e.errorType===r.ErrorType.UnhandledRejection&&(t.name="UnhandledRejection"),!t.message)try{t.message=JSON.stringify(a.default.errorToObject(e))}catch(e){t.message="Error provided failed to be stringified: "+e.message}return t.stack=e.stack||e.stackTrace||"No stack available.",t}Object.defineProperty(t,"__esModule",{value:!0}),t.ensureErrorObject=u,t.ensureComponentErrorObject=function(e,t,r){if(void 0===t&&(t=n.ErrorCode.GENERIC),void 0===r&&(r="UnknownComponent"),e instanceof n.ComponentError)return e;var o=u(e);return n.ComponentError.fromNativeError(r,t,o)};var c=((l={})[o.OfficeErrorCode.OperationNotSupportedError]=n.ErrorCode.OFFICE_SAVE_ASYNC_UNSUPPORTED,l[o.OfficeErrorCode.MessageInDifferentStoreError]=n.ErrorCode.OFFICE_SAVE_ASYNC_MESSAGE_IN_DIFFERENT_STORE,l);t.getSaveAsyncErrorCodeByOfficeInternalCode=function(e){return c[e]||n.ErrorCode.OFFICE_SAVE_ASYNC};t.isSaveAsyncUnsupportedInOutlookForWin=function(e){var t=e.hostType,n=e.mailboxDiagnostics;return t===i.default.Outlook&&s.default.getInstance().getIsWindows()&&n.hostVersion&&a.default.isVersionGreater(n.hostVersion,"15.0.5023.1000")},t.isSaveAsyncUnsupportedInOWA=function(e){var t=e.hostType,n=e.mailboxDiagnostics;return t===i.default.OutlookWebApp&&n.hostVersion&&a.default.isVersionGreater(n.hostVersion,"15.1.225.16")}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(39),n(43),n(88)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t,n,o,i){return e.call(this,new r.default(t,n),o,i)||this}return a(t,e),t.prototype.toJson=function(){return this.propertyName+" : "+JSON.stringify(this.propertyValue)},t.prototype.getInnerSoap=function(){var e="string"==typeof this.propertyValue?n.escapeXml(this.propertyValue):n.formatArrayToString(this.propertyValue,(function(e){return"<t:String>"+n.escapeXml(e)+"</t:String>"}));return"<t:"+this.propertyName+">"+e+"</t:"+this.propertyName+">"},t}(o.default);t.default=i}.apply(t,r))||(e.exports=o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(103),o=n(12),i=n(242),a=n(105),s=n(49),l=n(108),u=n(27),c=function(){function e(){}return e.setEventsHandler=function(e){this._eventHandler=e},e.getEventsHandler=function(){return this._eventHandler},e.scheduleTimer=function(){var e=this,t=this._profiles[this._currentProfile][2];this._timeout<0&&t>=0&&!this._paused&&(this._eventHandler.hasEvents()?(0===t&&this._currentBackoffCount>0&&(t=1),this._timeout=setTimeout((function(){return e._batchAndSendEvents()}),t*(1<<this._currentBackoffCount)*1e3)):this._timerCount=0)},e.initialize=function(e){var t=this;this._newEventsAllowed=!0,this._config=e,this._eventHandler=new i.default(e.collectorUri,e.cacheMemorySizeLimitInNumberOfEvents,e.httpXHROverride,e.clockSkewRefreshDurationInMins),this._initializeProfiles(),a.default.initialize((function(e,n){if(t._config.canSendStatEvent("awt_stats")){var r=new s.default("awt_stats");for(var i in r.setEventPriority(o.AWTEventPriority.High),r.setProperty("TenantId",n),e)e.hasOwnProperty(i)&&r.setProperty(i,e[i].toString());l.default.getLogger(u.StatsApiKey).logEvent(r)}}))},e.setTransmitProfile=function(e){this._currentProfile!==e&&void 0!==this._profiles[e]&&(this.clearTimeout(),this._currentProfile=e,this.scheduleTimer())},e.loadTransmitProfiles=function(e){for(var t in this._resetTransmitProfiles(),e)if(e.hasOwnProperty(t)){if(3!==e[t].length)continue;for(var n=2;n>=0;--n)if(e[t][n]<0){for(var r=n;r>=0;--r)e[t][r]=-1;break}for(n=2;n>0;--n)if(e[t][n]>0&&e[t][n-1]>0){var o=e[t][n-1]/e[t][n];e[t][n-1]=Math.ceil(o)*e[t][n]}this._profiles[t]=e[t]}},e.sendEvent=function(e){this._newEventsAllowed&&(this._currentBackoffCount>0&&e.priority===o.AWTEventPriority.Immediate_sync&&(e.priority=o.AWTEventPriority.High),this._eventHandler.addEvent(e),this.scheduleTimer())},e.flush=function(e){var t=(new Date).getTime();!this._paused&&this._lastUploadNowCall+3e4<t&&(this._lastUploadNowCall=t,this._timeout>-1&&(clearTimeout(this._timeout),this._timeout=-1),this._eventHandler.uploadNow(e))},e.pauseTransmission=function(){this._paused||(this.clearTimeout(),this._eventHandler.pauseTransmission(),this._paused=!0)},e.resumeTransmision=function(){this._paused&&(this._paused=!1,this._eventHandler.resumeTransmission(),this.scheduleTimer())},e.flushAndTeardown=function(){a.default.teardown(),this._newEventsAllowed=!1,this.clearTimeout(),this._eventHandler.teardown()},e.backOffTransmission=function(){this._currentBackoffCount<4&&(this._currentBackoffCount++,this.clearTimeout(),this.scheduleTimer())},e.clearBackOff=function(){this._currentBackoffCount>0&&(this._currentBackoffCount=0,this.clearTimeout(),this.scheduleTimer())},e._resetTransmitProfiles=function(){this.clearTimeout(),this._initializeProfiles(),this._currentProfile=r.AWT_REAL_TIME,this.scheduleTimer()},e.clearTimeout=function(){this._timeout>0&&(clearTimeout(this._timeout),this._timeout=-1,this._timerCount=0)},e._batchAndSendEvents=function(){var e=o.AWTEventPriority.High;this._timerCount++,this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][0]?(e=o.AWTEventPriority.Low,this._timerCount=0):this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][1]&&(e=o.AWTEventPriority.Normal),this._eventHandler.sendEventsForPriorityAndAbove(e),this._timeout=-1,this.scheduleTimer()},e._initializeProfiles=function(){this._profiles={},this._profiles[r.AWT_REAL_TIME]=[4,2,1],this._profiles[r.AWT_NEAR_REAL_TIME]=[12,6,3],this._profiles[r.AWT_BEST_EFFORT]=[36,18,9]},e._newEventsAllowed=!1,e._currentProfile=r.AWT_REAL_TIME,e._timeout=-1,e._currentBackoffCount=0,e._paused=!1,e._timerCount=0,e._lastUploadNowCall=0,e}();t.default=c},function(e,t,n){var r,o;r=[n,t,n(10)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this._propertyName=e,this._propertyType=t}return Object.defineProperty(e.prototype,"propertyName",{get:function(){return this._propertyName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"propertyType",{get:function(){return this._propertyType},enumerable:!0,configurable:!0}),e.prototype.toSoap=function(){return'<t:FieldURI FieldURI="'+n.default[this.propertyType].toLocaleLowerCase()+":"+this.propertyName+'" />'},e.prototype.toJson=function(){throw new Error("Not Implemented")},e}();t.default=r}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(154),n(155),n(156),n(67),n(89),n(11)],void 0===(o=function(e,t,n,r,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(){}return e.getRecurrencePatternDetails=function(t){var i={First:1,Second:2,Third:3,Fourth:4,Last:5},a=new n.default,s=t.Pattern.Type;return a.IsNthMonthly=!1,a.IsNthYearly=!1,a.IsWeekDayPattern=!1,a.PatternStartDate=new Date(t.Range.StartDate),-1!==s.indexOf("Daily")?(a.RecurrencePatternType=o.default.Daily,a.Interval=parseInt(t.Pattern.Interval,10),a.DayOfMonth=1,a.MonthOfYear=0):-1!==s.indexOf("Weekly")?(a.RecurrencePatternType=o.default.Weekly,a.Interval=parseInt(t.Pattern.Interval,10),a.DayOfMonth=1,a.MonthOfYear=0,a.DaysOfWeekMask=e.getDaysOfWeek(a.RecurrencePatternType,t.Pattern.DaysOfWeek)):-1!==s.indexOf("AbsoluteMonthly")?(a.RecurrencePatternType=o.default.Monthly,a.IsRelativeMonthlyRecurrencePattern=!1,a.Interval=parseInt(t.Pattern.Interval,10),a.DayOfMonth=parseInt(t.Pattern.DayOfMonth,10),a.MonthOfYear=0):-1!==s.indexOf("RelativeMonthly")?(a.RecurrencePatternType=o.default.Monthly,a.IsRelativeMonthlyRecurrencePattern=!0,a.Interval=parseInt(t.Pattern.Interval,10),a.DaysOfWeekMask=e.getDaysOfWeek(a.RecurrencePatternType,t.Pattern.DaysOfWeek),a.DayOfWeekIndex=parseInt(i[t.Pattern.DayOfWeekIndex].toString(),10),a.MonthOfYear=0):-1!==s.indexOf("AbsoluteYearly")?(a.RecurrencePatternType=o.default.Yearly,a.IsRelativeYearlyRecurrencePattern=!1,a.DayOfMonth=parseInt(t.Pattern.DayOfMonth,10),a.MonthOfYear=parseInt(t.Pattern.MonthOfYear,10)):-1!==s.indexOf("RelativeYearly")&&(a.RecurrencePatternType=o.default.Yearly,a.IsRelativeYearlyRecurrencePattern=!0,a.DaysOfWeekMask=e.getDaysOfWeek(a.RecurrencePatternType,t.Pattern.DaysOfWeek),a.DayOfWeekIndex=parseInt(i[t.Pattern.DayOfWeekIndex].toString(),10),a.MonthOfYear=parseInt(t.Pattern.MonthOfYear,10)),-1!==t.Range.Type.indexOf("NoEnd")?a.PatternEndType=r.default.NoEnd:-1!==t.Range.Type.indexOf("Numbered")?(a.PatternEndType=r.default.Numbered,a.NumberOfOccurrences=parseInt(t.Range.NumberOfOccurrences,10)):-1!==t.Range.Type.indexOf("EndDate")&&(a.PatternEndType=r.default.EndDate,a.PatternEndDate=new Date(t.Range.EndDate)),a},e.getDaysOfWeek=function(e,t){var n={None:0,Sunday:1,Monday:2,Tuesday:4,Wednesday:8,Thursday:16,Friday:32,Weekdays:62,Saturday:64,WeekendDays:65,AllDays:127},r=0,o=t.split(" ");switch(e){case 1:for(var i=0;i<o.length;i++){r|=n[o[i]]}break;case 2:case 3:r=n[o[0]]}return r},e.areEmailAddressDetailsEqual=function(e,t){return!e&&!t||!(!e&&t||e&&!t)&&(e.displayName===t.displayName&&e.emailAddress===t.emailAddress&&e.recipientType===t.recipientType)},e.areEmailAddressDetailsArraysEqual=function(t,n){return!t&&!n||!(!t&&n||t&&!n||t.length!==n.length)&&t.reduce((function(t,r,o){return t&&e.areEmailAddressDetailsEqual(r,n[o])}),!0)},e.parseDateFromExchange=function(e){return e&&-1===e.indexOf("Z")?e+"Z":e},e.isDatesEqual=function(e,t){return e===t||!(!e||!t)&&e.getTime()===t.getTime()},e.isStringArrayEquals=function(e,t){return e===t||!(!e||!t)&&e.sort().join()===t.sort().join()},e.isRecurencPatternsEquals=function(e,t){return e===t||!(!e||!t)&&(e.RecurrencePatternType===t.RecurrencePatternType&&this.isDatesEqual(e.PatternStartDate,t.PatternStartDate)&&this.isDatesEqual(e.PatternEndDate,t.PatternEndDate)&&e.PatternEndType===t.PatternEndType&&e.Interval===t.Interval&&e.IsWeekDayPattern===t.IsWeekDayPattern&&e.IsRelativeYearlyRecurrencePattern===t.IsRelativeYearlyRecurrencePattern&&e.IsRelativeMonthlyRecurrencePattern===t.IsRelativeMonthlyRecurrencePattern&&e.DaysOfWeekMask===t.DaysOfWeekMask&&e.DayOfWeekIndex===t.DayOfWeekIndex&&e.DayOfMonth===t.DayOfMonth&&e.MonthOfYear===t.MonthOfYear&&e.IsNthMonthly===t.IsNthMonthly&&e.IsNthYearly===t.IsNthYearly&&e.NumberOfOccurrences===t.NumberOfOccurrences)},e.areMailboxItemsEqual=function(e,t){if(e===t)return!0;if(e&&t){if(e.Id!==t.Id||e.ItemType!==t.ItemType||e.ItemClass!==t.ItemClass||e.Importance!==t.Importance)return!1;if(!this.isStringArrayEquals(e.Categories,t.Categories))return!1;if(e.ItemType===s.default[s.default.appointment]){var n=e,r=t;return n.GlobalObjectId===r.GlobalObjectId&&n.CalendarItemType===r.CalendarItemType&&this.isDatesEqual(n.ScheduleStart,r.ScheduleStart)&&this.isDatesEqual(n.ScheduleEnd,r.ScheduleEnd)&&n.IsAllDayEvent===r.IsAllDayEvent&&n.Location===r.Location&&n.IsRecurring===r.IsRecurring&&n.LegacyFreeBusyStatus===r.LegacyFreeBusyStatus&&this.isRecurencPatternsEquals(n.RecurrencePatternDetails,r.RecurrencePatternDetails)}return e.InternetMessageId===t.InternetMessageId&&e.ConversationIndex===t.ConversationIndex&&this.isDatesEqual(e.DateTimeSent,t.DateTimeSent)}return!1},e.isMailboxItemChanged=function(e,t){return!(e||!t)||!(!e||!t||e.Id===t.Id)},e.cloneMailboxItem=function(e){var t=new i.default(e.Id);if(e.ItemType===s.default[s.default.appointment]){var r=new a.default(e.Id);t=r;var o=e;if(r.GlobalObjectId=o.GlobalObjectId,r.CalendarItemType=o.CalendarItemType,r.ScheduleStart=o.ScheduleStart,r.ScheduleEnd=o.ScheduleEnd,r.IsAllDayEvent=o.IsAllDayEvent,r.Location=o.Location,r.IsRecurring=o.IsRecurring,r.LegacyFreeBusyStatus=o.LegacyFreeBusyStatus,o.RecurrencePatternDetails){var l=new n.default,u=o.RecurrencePatternDetails;l.RecurrencePatternType=u.RecurrencePatternType,l.PatternStartDate=u.PatternStartDate,l.PatternEndDate=u.PatternEndDate,l.PatternEndType=u.PatternEndType,l.Interval=u.Interval,l.IsWeekDayPattern=u.IsWeekDayPattern,l.IsRelativeYearlyRecurrencePattern=u.IsRelativeYearlyRecurrencePattern,l.IsRelativeMonthlyRecurrencePattern=u.IsRelativeMonthlyRecurrencePattern,l.DaysOfWeekMask=u.DaysOfWeekMask,l.DayOfWeekIndex=u.DayOfWeekIndex,l.DayOfMonth=u.DayOfMonth,l.MonthOfYear=u.MonthOfYear,l.IsNthMonthly=u.IsNthMonthly,l.IsNthYearly=u.IsNthYearly,l.NumberOfOccurrences=u.NumberOfOccurrences,r.RecurrencePatternDetails=l}}else(t=new i.default(e.Id)).InternetMessageId=e.InternetMessageId,t.ConversationIndex=e.ConversationIndex,t.DateTimeSent=e.DateTimeSent,t.DateTimeReceived=e.DateTimeReceived;return t.Categories=[].concat(e.Categories),t.Importance=e.Importance,t.ItemType=e.ItemType,t.ItemClass=e.ItemClass,t},e.cloneEmailAddressDetails=function(e){return e&&{emailAddress:e.emailAddress,displayName:e.displayName,recipientType:e.recipientType}},e.cloneEmailAddressDetailsArray=function(t){return void 0===t&&(t=[]),t.map(e.cloneEmailAddressDetails)},e}();t.default=l}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(77),n(30)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.comparePropertyUpdate=function(e,t){return e.propertyName===t.propertyName},t.default=function e(t,i,a,s,l,u){return void 0===u&&(u=!1),t.ExchangeProvider.MailboxItemProvider.setProperties(a,s,u).catch((function(n){var u,c;if((null===(u=n)||void 0===u?void 0:u.code)===r.default.OFFICE_CATEGORY_UPDATE){var d=t.JsApiProvider.getMailboxItemType();return t.EventManager.ReportTraceWarning("Set properties","Category set with SSS fallback."),e(t,i,l(a,d),s)}if((null===(c=n)||void 0===c?void 0:c.code)===r.default.OFFICE_TRANSIENT_ERROR)return t.EventManager.ReportTraceWarning("Set properties","Only Categories have successfully set. Reflecting updates."),e(t,i,[a.find((function(e){return e.propertyName===o.default.CATEGORIES}))],s,null,!0);throw n})).then((function(){return i.properties[n.PropertyNames.TRACK_STATUS].accessor()}))}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(211)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ApplicationEventLevel=n.ApplicationEventLevel,t.APPLICATION_LEVEL_TO_TRACER_LEVEL_STRING=n.APPLICATION_LEVEL_TO_TRACER_LEVEL_STRING}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(4),n(7)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this._eventName=e,this._eventParameters={},this._eventParameters[n.KnownEventParameterName.EventContextName]={},this._activityId="",this._eventLevel=t,this.addEventParameter(n.EventParameterName.ApplicationEventLevel,this._eventLevel),this.addEventParameter(n.KnownEventParameterName.TimeCreated,new Date)}return e.prototype.toData=function(){var e={};for(var t in this._eventParameters)e[t]=i(this._eventParameters[t]);return{ActivityId:this._activityId,EventName:this.getEventName(),EventValues:e}},e.prototype.addEventParameter=function(e,t){if(void 0===e&&(e="undefined"),null!=t){var o={name:e,value:t};o.name===n.ErrorEventParameterName.Error?o.value=i(r.default.errorToObject(t)):o.value=i(t),o.name===n.EventParameterName.ComponentName&&0!==o.value.indexOf("MailApp.")&&(o.value="MailApp."+o.value),n.KnownEventParameterName.ActivityId===o.name&&(this._activityId=o.value),n.isKnownEventContextParamName(o.name)?(this._addContextParameter(n.KnownEventParameterName.EventContextName,o.name,o.value),this._eventParameters[o.name]=o.value):n.isKnownEventParamName(o.name)?(this._eventParameters[o.name]&&this._addContextParameter(n.KnownEventParameterName.EventContextName,o.name,this._eventParameters[o.name]),this._eventParameters[o.name]=o.value):this._addContextParameter(n.KnownEventParameterName.EventContextName,o.name,o.value)}},e.prototype.getEventParameterValue=function(e){var t;return void 0===(t=e===n.KnownEventParameterName.ActivityId?this._activityId:this._eventParameters[e])&&(t=this._eventParameters[n.KnownEventParameterName.EventContextName][e]),t},e.prototype.getEventParameters=function(){return this._eventParameters},e.prototype.getEventName=function(){return""+n.UCI_EVENT_NAME_PREFIX+this._eventName},e.prototype.getAriaEventName=function(){return""+n.MAILAPP_EVENT_NAME_PREFIX+this._eventName},e.prototype.getActivityId=function(){return this._activityId},e.prototype.getEventLevel=function(){return this._eventLevel},e.prototype._addContextParameter=function(e,t,n){this._eventParameters[e][t]=n},e}();function i(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e?e:e instanceof Date?e.toISOString():JSON.stringify(e)}t.toSimpleTypeValue=i,t.default=o}.apply(t,r))||(e.exports=o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unknown=0]="Unknown",e[e.MSACID=1]="MSACID",e[e.MSAPUID=2]="MSAPUID",e[e.ANID=3]="ANID",e[e.OrgIdCID=4]="OrgIdCID",e[e.OrgIdPUID=5]="OrgIdPUID",e[e.UserObjectId=6]="UserObjectId",e[e.Skype=7]="Skype",e[e.Yammer=8]="Yammer",e[e.EmailAddress=9]="EmailAddress",e[e.PhoneNumber=10]="PhoneNumber",e[e.SipAddress=11]="SipAddress",e[e.MUID=12]="MUID"}(t.AWTUserIdType||(t.AWTUserIdType={})),function(e){e[e.Started=0]="Started",e[e.Ended=1]="Ended"}(t.AWTSessionState||(t.AWTSessionState={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(27),o=n(12),i=function(){function e(e){this._event={name:"",properties:{}},e&&this.setName(e)}return e.prototype.setName=function(e){this._event.name=e},e.prototype.getName=function(){return this._event.name},e.prototype.setType=function(e){this._event.type=e},e.prototype.getType=function(){return this._event.type},e.prototype.setTimestamp=function(e){this._event.timestamp=e},e.prototype.getTimestamp=function(){return this._event.timestamp},e.prototype.setEventPriority=function(e){this._event.priority=e},e.prototype.getEventPriority=function(){return this._event.priority},e.prototype.setProperty=function(e,t,n){void 0===n&&(n=o.AWTPropertyType.Unspecified);var i={value:t,type:n,pii:o.AWTPiiKind.NotSet,cc:o.AWTCustomerContentKind.NotSet};null!==(i=r.sanitizeProperty(e,i))?this._event.properties[e]=i:delete this._event.properties[e]},e.prototype.setPropertyWithPii=function(e,t,n,i){void 0===i&&(i=o.AWTPropertyType.Unspecified);var a={value:t,type:i,pii:n,cc:o.AWTCustomerContentKind.NotSet};null!==(a=r.sanitizeProperty(e,a))?this._event.properties[e]=a:delete this._event.properties[e]},e.prototype.setPropertyWithCustomerContent=function(e,t,n,i){void 0===i&&(i=o.AWTPropertyType.Unspecified);var a={value:t,type:i,pii:o.AWTPiiKind.NotSet,cc:n};null!==(a=r.sanitizeProperty(e,a))?this._event.properties[e]=a:delete this._event.properties[e]},e.prototype.getPropertyMap=function(){return this._event.properties},e.prototype.getEvent=function(){return this._event},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10),this.low<0&&(this.high=-1)}return e.prototype._Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high},e}();t.Int64=r;var o=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10)}return e.prototype._Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high},e}();t.UInt64=o;var i=function(){function e(){}return e._ToByte=function(e){return this._ToUInt8(e)},e._ToUInt8=function(e){return 255&e},e._ToInt32=function(e){return 2147483647&e|2147483648&e},e._ToUInt32=function(e){return 4294967295&e},e}();t.Number=i},function(e,t,n){var r,o;r=[n,t,n(33),n(52),n(23),n(34),n(53),n(24),n(54),n(55),n(17)],void 0===(o=function(e,t,n,r,o,i,a,s,l,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function e(e,t,n){this._id=t,this._elementType=e,this._onChange=[];var r=document.createElement("label");r.htmlFor=t,r.textContent=n,this._element=document.createElement("fieldset"),document.getElementById(c.HOST_ELEMENT_ID).appendChild(this._element),this._element.appendChild(r)}return Object.defineProperty(e.prototype,"ON_CHANGE",{set:function(e){this._onChange.push(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VALUE",{get:function(){return this._input.VALUE},set:function(e){this._input.VALUE=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DISABLED",{set:function(e){this._element.disabled=e},enumerable:!0,configurable:!0}),e.prototype.Hide=function(){return this._element.style.display="none",this},e.prototype.Show=function(){return this._element.style.display="block",this},Object.defineProperty(e.prototype,"Element",{get:function(){return this._element},enumerable:!0,configurable:!0}),e.prototype.AppendInput=function(e,t){var o=this;if(this._input)throw new Error("Control Initialized");switch(this._elementType){case n.default.String:this._input=new s.default(this._id,e);break;case n.default.DateTime:this._input=new s.default(this._id,e,"datetime-local");break;case n.default.Date:this._input=new s.default(this._id,e,"date");break;case n.default.Number:this._input=new s.default(this._id,e,"number");break;case n.default.Double:this._input=new s.default(this._id,e);break;case n.default.Boolean:this._input=new r.default(this._id,e);break;case n.default.MultilineString:this._input=new i.default(this._id,e);break;case n.default.HTMLString:this._input=new a.default(this._id,e)}return this._element.appendChild(this._input.ELEMENT),t&&(this._input.ELEMENT.className+=" "+t),this._input.ELEMENT.addEventListener("change",(function(){if(o._onChange.length>0)for(var e=0;e<o._onChange.length;e++)o._onChange[e]()})),this._elementType===n.default.HTMLString&&this._element.appendChild(this._input.PREVIEW_CONTAINER),this},e.prototype.AppendSelect=function(e,t,n,r){var i=this;if(this._input)throw new Error("Control Initialized");return this._input=new o.default(this._id,e,t,n,r),this._element.appendChild(this._input.ELEMENT),this._input.ELEMENT.addEventListener("change",(function(){if(i._onChange.length>0)for(var e=0;e<i._onChange.length;e++)i._onChange[e]()})),this},e.prototype.AppendRecipients=function(e){if(this._input)throw new Error("Control Initialized");return this._input=new l.default(this._id,e),this._element.appendChild(this._input.ELEMENT),this},e.prototype.AppendRecipient=function(e){if(this._input)throw new Error("Control Initialized");return this._input=new u.default(this._id,e),this._element.appendChild(this._input.ELEMENT),this},e}();t.default=d}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.ELEMENT=document.createElement("input"),this.ELEMENT.type="checkbox",this.ELEMENT.id=e,t&&(this.ELEMENT.checked=t)}return Object.defineProperty(e.prototype,"VALUE",{get:function(){return this.ELEMENT.checked},set:function(e){this.ELEMENT.checked=e},enumerable:!0,configurable:!0}),e}();t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(34)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.PREVIEW_CONTAINER=document.createElement("div"),r.PREVIEW_CONTAINER.className="wideControl";var o=document.createElement("h2");return o.style.fontSize="20px",o.textContent="Preview",r._previewElement=document.createElement("div"),r._previewElement.className="mockShimControl",r._previewElement.innerHTML=n,r._previewElement.id="PREVIEW_"+t,r.ELEMENT.addEventListener("change",(function(){r._previewElement.innerHTML=r.VALUE})),r.PREVIEW_CONTAINER.appendChild(o),r.PREVIEW_CONTAINER.appendChild(r._previewElement),r}return a(t,e),Object.defineProperty(t.prototype,"VALUE",{get:function(){return this.ELEMENT.value},set:function(e){this.ELEMENT.value=e,this._previewElement.innerHTML=e},enumerable:!0,configurable:!0}),t}(n.default);t.default=r}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(24),n(23),n(35)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){t||(t=[]),this.ELEMENT=document.createElement("div"),this.ELEMENT.id=e,this.ELEMENT.className="mockShimFlexbox",this._recipients=[];var n=this._createRecipientItem("","","user","+",this._itemPlusClick.bind(this),!1);this.ELEMENT.appendChild(n.ContainerElement);for(var r=0;r<t.length;r++){var o=this._createRecipientItem(t[r].emailAddress,t[r].displayName,t[r].recipientType||"user","x",this._itemDeleteClick.bind(this),!0);this._recipients.push(o.Recipient),this.ELEMENT.appendChild(o.ContainerElement)}}return Object.defineProperty(e.prototype,"VALUE",{get:function(){return this._recipients},enumerable:!0,configurable:!0}),e.prototype._createRecipientItem=function(e,t,i,a,s,l){var u=document.createElement("div"),c=new n.default("",a,"button");c.ELEMENT.className="mockShimRecipientItemBtn";var d={ContainerElement:u};if(u.className="mockShimRecipientItem",e&&u.setAttribute("data-email",e),l){var p=document.createElement("span");p.className="mockShimRecipientItemText",p.textContent=""+(t||e),p.title=e+" ("+i+")",u.appendChild(p),d.Recipient={displayName:t,emailAddress:e,recipientType:i},c.ELEMENT.onclick=function(){s(d)}}else{u.className+=" mockShimRecipientItemWithNew";var f=new n.default("",t);f.ELEMENT.className="mockShimRecipientInputItem",f.ELEMENT.placeholder="Display Name";var _=new n.default("",e,"email");_.ELEMENT.className="mockShimRecipientInputItem",_.ELEMENT.placeholder="Email Address";var h={};o.default.forEach((function(e){return h[e]=e}));var m=new r.default("",i,h);m.ELEMENT.className="mockShimRecipientInputItem",u.appendChild(f.ELEMENT),u.appendChild(_.ELEMENT),u.appendChild(m.ELEMENT),c.ELEMENT.onclick=function(){_.VALUE?(d.Recipient={displayName:f.VALUE,emailAddress:_.VALUE,recipientType:m.VALUE},s(d),_.VALUE="",f.VALUE=""):alert("Email Address can't be empty")}}return u.appendChild(c.ELEMENT),d},e.prototype._itemDeleteClick=function(e){var t=this._recipients.indexOf(e.Recipient);-1!==t&&(this.ELEMENT.removeChild(e.ContainerElement),this._recipients.splice(t,1))},e.prototype._itemPlusClick=function(e){var t=this._createRecipientItem(e.Recipient.emailAddress,e.Recipient.displayName,e.Recipient.recipientType,"x",this._itemDeleteClick.bind(this),!0);this._recipients.push(t.Recipient),this.ELEMENT.appendChild(t.ContainerElement)},e}();t.default=i}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(24),n(23),n(35)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this.ELEMENT=document.createElement("div"),this.ELEMENT.id=e,this.ELEMENT.className="mockShimRecipientItem mockShimRecipientItemSingle",this._displayNameInput=new n.default("",t?t.displayName:""),this._displayNameInput.ELEMENT.className="mockShimRecipientInputItem",this._displayNameInput.ELEMENT.placeholder="Display Name",this._emailInput=new n.default("",t?t.emailAddress:"","email"),this._emailInput.ELEMENT.className="mockShimRecipientInputItem",this._emailInput.ELEMENT.placeholder="Email Address";var i={};o.default.forEach((function(e){return i[e]=e})),this._select=new r.default("",t?t.recipientType:"",i),this._select.ELEMENT.className="mockShimRecipientInputItem",this.ELEMENT.appendChild(this._displayNameInput.ELEMENT),this.ELEMENT.appendChild(this._emailInput.ELEMENT),this.ELEMENT.appendChild(this._select.ELEMENT)}return Object.defineProperty(e.prototype,"VALUE",{get:function(){return{emailAddress:this._emailInput.VALUE,displayName:this._displayNameInput.VALUE,recipientType:this._select.VALUE}},enumerable:!0,configurable:!0}),e}();t.default=i}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(17)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,r){var o=this;this._element=document.createElement("div"),this._element.id=e,this._element.className="mockOfficeShimSection";var i=document.createElement("h2");i.id=e+"_HEADER",i.innerText=t,this._controlContainers=document.createElement("div"),this._controlContainers.className="mockOfficeShimSectionContent mockShimFlexbox",this._element.appendChild(i),this._element.appendChild(this._controlContainers),i.className="mockOfficeShimSectionHeader "+(r?"mockOfficeShimPlusIcon":"mockOfficeShimMinusIcon"),this._controlContainers.style.height=r?"0px":"auto",i.addEventListener("click",(function(){var e=-1!==i.className.indexOf("mockOfficeShimPlusIcon");i.className="mockOfficeShimSectionHeader "+(e?"mockOfficeShimMinusIcon":"mockOfficeShimPlusIcon"),o._controlContainers.style.height=e?"auto":"0px"})),document.getElementById(n.HOST_ELEMENT_ID).appendChild(this._element)}return Object.defineProperty(e.prototype,"Element",{get:function(){return this._element},enumerable:!0,configurable:!0}),e.prototype.Show=function(){return this.Element.style.display="block",this},e.prototype.Hide=function(){return this.Element.style.display="none",this},e.prototype.AppendControl=function(e){this._controlContainers.appendChild(e)},e.prototype.AppendControls=function(e){for(var t=0;t<e.length;t++)this.AppendControl(e[t])},e}();t.default=r}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(22),n(13)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this._mockOfficeShimConfiguration=e,this._queryParams=t,this._elementsCollection={},this._initUI()}return Object.defineProperty(e.prototype,"ElementsCollection",{get:function(){return this._elementsCollection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemId",{get:function(){return this._elementsCollection.ITEM_ID.VALUE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"internetMessageId",{get:function(){return this._elementsCollection.INTERNET_MESSAGE_ID.VALUE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemType",{get:function(){return this._elementsCollection.ITEM_TYPE.VALUE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dateTimeCreated",{get:function(){return new Date(this._elementsCollection.DATE_TIME_CREATED.VALUE)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"subject",{get:function(){return this._elementsCollection.SUBJECT.VALUE},set:function(e){this._elementsCollection.SUBJECT.VALUE=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"start",{get:function(){return this._elementsCollection.START.VALUE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._elementsCollection.END.VALUE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"body",{get:function(){return this._elementsCollection.BODY.VALUE},set:function(e){this._elementsCollection.BODY.VALUE=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sender",{get:function(){return this._elementsCollection.SENDER_CONTROL.VALUE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"to",{get:function(){return"message"===this._elementsCollection.ITEM_TYPE.VALUE?this._elementsCollection.TO_LINE.VALUE:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cc",{get:function(){return"message"===this._elementsCollection.ITEM_TYPE.VALUE?this._elementsCollection.CC_LINE.VALUE:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bcc",{get:function(){return"message"===this._elementsCollection.ITEM_TYPE.VALUE?this._elementsCollection.BCC_LINE.VALUE:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requiredAttendees",{get:function(){return"message"!==this._elementsCollection.ITEM_TYPE.VALUE?this._elementsCollection.REQUIRED_ATTENDEES.VALUE:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"optionalAttendees",{get:function(){return"message"!==this._elementsCollection.ITEM_TYPE.VALUE?this._elementsCollection.OPTIONAL_ATTENDEES.VALUE:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"organizer",{get:function(){return"message"!==this._elementsCollection.ITEM_TYPE.VALUE?this._elementsCollection.ORGANIZER_CONTROL.VALUE:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemTypeControl",{get:function(){return this._elementsCollection.ITEM_TYPE},enumerable:!0,configurable:!0}),e.prototype.FlushConfig=function(){this._elementsCollection.ITEM_ID.Hide(),this._elementsCollection.INTERNET_MESSAGE_ID.Hide(),this._elementsCollection.ITEM_TYPE.Hide(),this._elementsCollection.DATE_TIME_CREATED.Hide(),-1===this._queryParams.queryParameters.mailAppMode.indexOf("Compose")&&(this._elementsCollection.SENDER_CONTROL.DISABLED=!0,this._elementsCollection.TO_LINE.DISABLED=!0,this._elementsCollection.CC_LINE.DISABLED=!0,this._elementsCollection.BCC_LINE.DISABLED=!0,this._elementsCollection.ORGANIZER_CONTROL.DISABLED=!0,this._elementsCollection.REQUIRED_ATTENDEES.DISABLED=!0,this._elementsCollection.OPTIONAL_ATTENDEES.DISABLED=!0,this._elementsCollection.SUBJECT.DISABLED=!0,this._elementsCollection.START.DISABLED=!0,this._elementsCollection.END.DISABLED=!0,this._elementsCollection.BODY.DISABLED=!0)},e.prototype._initUI=function(){var e=this;this._elementsCollection.ITEM_ID=r.default.createTextInput("ITEM_ID","Item Id",n.prefillValueIfRequired(this._mockOfficeShimConfiguration.mailboxItem.itemId)).Hide(),this._elementsCollection.INTERNET_MESSAGE_ID=r.default.createTextInput("INTERNET_MESSAGE_ID","Internet Message Id",n.prefillValueIfRequired(this._mockOfficeShimConfiguration.mailboxItem.internetMessageId)).Hide(),this._elementsCollection.ITEM_TYPE=r.default.createSelect("ITEM_TYPE","Item Type",this._mockOfficeShimConfiguration.mailboxItem.itemType,["message","appointment"]),this._elementsCollection.DATE_TIME_CREATED=r.default.createDateTime("DATE_TIME_CREATED","Created Date time",new Date(this._mockOfficeShimConfiguration.mailboxItem.dateTimeCreated)||new Date),this._elementsCollection.SENDER_CONTROL=r.default.createRecipientControl("SENDER_CONTROL","From",this._mockOfficeShimConfiguration.mailboxItem.sender),this._elementsCollection.TO_LINE=r.default.createRecipientsControl("TO_LINE","To",this._mockOfficeShimConfiguration.mailboxItem.to),this._elementsCollection.CC_LINE=r.default.createRecipientsControl("CC_LINE","Cc",this._mockOfficeShimConfiguration.mailboxItem.cc),this._elementsCollection.BCC_LINE=r.default.createRecipientsControl("BCC_LINE","Bcc",this._mockOfficeShimConfiguration.mailboxItem.bcc),this._elementsCollection.ORGANIZER_CONTROL=r.default.createRecipientControl("ORGANIZER_CONTROL","Organizer",this._mockOfficeShimConfiguration.mailboxItem.organizer),this._elementsCollection.REQUIRED_ATTENDEES=r.default.createRecipientsControl("REQUIRED_ATTENDEES","Required Attendees",this._mockOfficeShimConfiguration.mailboxItem.requiredAttendees),this._elementsCollection.OPTIONAL_ATTENDEES=r.default.createRecipientsControl("OPTIONAL_ATTENDEES","Optional Attendees",this._mockOfficeShimConfiguration.mailboxItem.optionalAttendees),this._elementsCollection.START=r.default.createDateTime("START","Start",new Date(this._mockOfficeShimConfiguration.mailboxItem.start)),this._elementsCollection.END=r.default.createDateTime("END","End",new Date(this._mockOfficeShimConfiguration.mailboxItem.end));var t=function(){"message"===e._elementsCollection.ITEM_TYPE.VALUE?(e._elementsCollection.DATE_TIME_CREATED.Show(),e._elementsCollection.TO_LINE.Show(),e._elementsCollection.CC_LINE.Show(),e._elementsCollection.BCC_LINE.Show(),e._elementsCollection.ORGANIZER_CONTROL.Hide(),e._elementsCollection.REQUIRED_ATTENDEES.Hide(),e._elementsCollection.OPTIONAL_ATTENDEES.Hide(),e._elementsCollection.START.Hide(),e._elementsCollection.END.Hide()):(e._elementsCollection.DATE_TIME_CREATED.Hide(),e._elementsCollection.TO_LINE.Hide(),e._elementsCollection.CC_LINE.Hide(),e._elementsCollection.BCC_LINE.Hide(),e._elementsCollection.REQUIRED_ATTENDEES.Show(),e._elementsCollection.OPTIONAL_ATTENDEES.Show(),e._elementsCollection.ORGANIZER_CONTROL.Show(),e._elementsCollection.START.Show(),e._elementsCollection.END.Show())};t(),this._elementsCollection.ITEM_TYPE.ON_CHANGE=function(){t()},this._elementsCollection.SUBJECT=r.default.createTextInput("SUBJECT","Subject",this._mockOfficeShimConfiguration.mailboxItem.subject,"wideControl"),this._elementsCollection.BODY=r.default.createHTMLArea("BODY","Body",this._mockOfficeShimConfiguration.mailboxItem.body)},e}();t.default=o}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(13)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._mockOfficeShimConfiguration=e,this._elementsCollection={},this._initUI()}return Object.defineProperty(e.prototype,"ElementsCollection",{get:function(){return this._elementsCollection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"queryParameters",{get:function(){return{org:this._elementsCollection.ORG.VALUE,orgId:this._elementsCollection.ORG_ID.VALUE,mailboxId:this._elementsCollection.MAILBOX_ID.VALUE,ed:this._elementsCollection.EXTERNAL_DOMAIN.VALUE,mailAppMode:this._elementsCollection.MAILAPP_MODE.VALUE,de:this._elementsCollection.DEPLOYMENT_ENVIRONMENT.VALUE,sde:this._elementsCollection.SERVICE_DEPLOYMENT_ENVIRONMENT.VALUE,showperf:this._elementsCollection.SHOWPERF.VALUE?"1":"",collectorurl:this._elementsCollection.COLLECTOR_URL.VALUE,testmode:this._elementsCollection.TEST_MODE.VALUE?"true":"false"}},enumerable:!0,configurable:!0}),e.prototype.setOrgId=function(e){this._elementsCollection.ORG_ID.VALUE=e},e.prototype.FlushConfig=function(){this._elementsCollection.ORG.Hide(),this._elementsCollection.ORG_ID.Hide(),this._elementsCollection.MAILBOX_ID.Hide(),this._elementsCollection.EXTERNAL_DOMAIN.Hide(),this._elementsCollection.MAILAPP_MODE.Hide(),this._elementsCollection.DEPLOYMENT_ENVIRONMENT.Hide(),this._elementsCollection.SERVICE_DEPLOYMENT_ENVIRONMENT.Hide(),this._elementsCollection.SHOWPERF.Hide(),this._elementsCollection.TEST_MODE.Hide(),this._elementsCollection.COLLECTOR_URL.Hide()},e.prototype._getLocationQueryParams=function(){var e={};if(window.location.search&&window.location.search.length>0)for(var t=window.location.search.substr(1).split("&"),n=0;n<t.length;n++){var r=t[n].split("=");e[r[0]]=r[1]}return e},e.prototype._initUI=function(){var e=this._getLocationQueryParams();this._elementsCollection.ORG=n.default.createTextInput("ORG","Organization",e.org||this._mockOfficeShimConfiguration.queryParameters.org).Hide(),this._elementsCollection.ORG_ID=n.default.createTextInput("ORG_ID","Organization Id",e.orgId||this._mockOfficeShimConfiguration.queryParameters.orgId).Hide(),this._elementsCollection.MAILBOX_ID=n.default.createTextInput("MAILBOX_ID","Mailbox Id",e.mailboxId||this._mockOfficeShimConfiguration.queryParameters.mailboxId).Hide(),this._elementsCollection.EXTERNAL_DOMAIN=n.default.createTextInput("EXTERNAL_DOMAIN","External domain",e.ed||this._mockOfficeShimConfiguration.queryParameters.ed).Hide(),this._elementsCollection.MAILAPP_MODE=n.default.createSelect("MAILAPP_MODE","Mail App Mode",e.mailAppMode||this._mockOfficeShimConfiguration.queryParameters.mailAppMode,["ReadDesktop","ReadTablet","ReadPhone","ComposeDesktop","ComposeTablet","ComposePhone"],!1),this._elementsCollection.DEPLOYMENT_ENVIRONMENT=n.default.createSelect("DEPLOYMENT_ENVIRONMENT","Deployment environment",e.de||this._mockOfficeShimConfiguration.queryParameters.de,["onprem","online"]).Hide(),this._elementsCollection.SERVICE_DEPLOYMENT_ENVIRONMENT=n.default.createSelect("SERVICE_DEPLOYMENT_ENVIRONMENT","Exchange deployment environment",e.sde||this._mockOfficeShimConfiguration.queryParameters.sde,["onprem","online"]).Hide(),this._elementsCollection.SHOWPERF=n.default.createCheckbox("SHOWPERF","Show Perf","1"===e.showperf||"1"===this._mockOfficeShimConfiguration.queryParameters.showperf),this._elementsCollection.TEST_MODE=n.default.createCheckbox("TEST_MODE","Test mode","true"===e.testmode||"true"===this._mockOfficeShimConfiguration.queryParameters.testmode),this._elementsCollection.COLLECTOR_URL=n.default.createTextInput("COLLECTOR_URL","Collector URL",e.collectorurl||this._mockOfficeShimConfiguration.queryParameters.collectorurl).Hide()},e}();t.default=r}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(13)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._mockOfficeShimConfiguration=e,this._elementsCollection={},this._initUI()}return Object.defineProperty(e.prototype,"ElementsCollection",{get:function(){return this._elementsCollection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return this._elementsCollection.USER_NAME.VALUE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"emailAddress",{get:function(){return this._elementsCollection.USER_EMAIL.VALUE},enumerable:!0,configurable:!0}),e.prototype.FlushConfig=function(){this._elementsCollection.USER_NAME.Hide(),this._elementsCollection.USER_EMAIL.Hide()},e.prototype._initUI=function(){this._elementsCollection.USER_NAME=n.default.createTextInput("USER_NAME","User Name",this._mockOfficeShimConfiguration.userProfile.displayName),this._elementsCollection.USER_EMAIL=n.default.createTextInput("USER_EMAIL","User Email",this._mockOfficeShimConfiguration.userProfile.emailAddress)},e}();t.default=r}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(22),n(13),n(36),n(17),n(18)],void 0===(o=function(e,t,n,r,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s="APPOINTMENT_UID",l="APPOINTMENT_LOCATION",u="APPOINTMENT_IS_RECURRENCE",c={Account:"Account",BookableResourceBooking:"BookableResourceBooking",BookableResourceBookingHeader:"BookableResourceBookingHeader",Campaign:"Campaign",CampaignActivity:"CampaignActivity",Case:"Incident",Contact:"Contact",Contract:"Contract",Entitlement:"Entitlement","Entitlement Template":"EntitlementTemplate",Invoice:"Invoice","Knowledge Article":"KnowledgeArticle","Knowledge Base Record":"KnowledgeBaseRecord",Lead:"Lead",Opportunity:"Opportunity",Order:"SalesOrder",ProfileAlbum:"ProfileAlbum","Quick Campaign":"QuickCampaign",Quote:"Quote",Site:"Site"},d=["Appointment","RecurringAppointmentMaster","ServiceAppointment","Task","Letter","PhoneCall","Fax","ActivityParty","ExceptionAppointment"],p=function(){function e(e,t){this._mockOfficeShimConfiguration=e,this._itemTypeControl=t,this._elementsCollection={},this._initUI()}return Object.defineProperty(e.prototype,"ElementsCollection",{get:function(){return this._elementsCollection},enumerable:!0,configurable:!0}),e.prototype.setProps=function(e){void 0!==e.crmid&&(this._elementsCollection.CRM_ID.VALUE=e.crmid),void 0!==e.crmTrackingState&&(this._elementsCollection.CRM_TRACKING_STATE.VALUE=e.crmTrackingState),void 0!==e.crmRegardingId&&(this._elementsCollection.CRM_REGARDING_ID.VALUE=e.crmRegardingId),void 0!==e.crmRegardingObjectType&&(this._elementsCollection.CRM_REGARDING_OBJECT_TYPE.VALUE=e.crmRegardingObjectType),void 0!==e.crmRegardingObjectName&&(this._elementsCollection.CRM_REGARDING_OBJECT_NAME.VALUE=e.crmRegardingObjectName),void 0!==e.crmIsFollowed&&(this._elementsCollection.CRM_IS_FOLLOWED.VALUE=e.crmIsFollowed),void 0!==e.crmObjectType&&(this._elementsCollection.CRM_OBJECT_TYPE_CODE.VALUE=e.crmObjectType),void 0!==e.crmTrackTimestamp&&(this._elementsCollection.TRACK_TIMESTAMP.VALUE=o.formatDate(new Date(e.crmTrackTimestamp),i.DATE_TIME_FORMAT)),void 0!==e.crmCategoryTracker&&(this._elementsCollection.CRM_CATEGORY_TRACKER.VALUE=a.default[e.crmCategoryTracker])},e.prototype.setCategories=function(e){e&&(this._elementsCollection.CATEGORIES.VALUE=e)},Object.defineProperty(e.prototype,"props",{get:function(){var e="Empty"===this._elementsCollection.CRM_CATEGORY_TRACKER.VALUE,t={crmid:this._elementsCollection.CRM_ID.VALUE,crmTrackingState:this._elementsCollection.CRM_TRACKING_STATE.VALUE,crmRegardingId:this._elementsCollection.CRM_REGARDING_ID.VALUE,crmRegardingObjectType:this._elementsCollection.CRM_REGARDING_OBJECT_TYPE.VALUE,crmRegardingObjectName:this._elementsCollection.CRM_REGARDING_OBJECT_NAME.VALUE,crmIsFollowed:this._elementsCollection.CRM_IS_FOLLOWED.VALUE,crmObjectType:this._elementsCollection.CRM_OBJECT_TYPE_CODE.VALUE,crmCategoryTracker:e?void 0:a.default[this._elementsCollection.CRM_CATEGORY_TRACKER.VALUE],crmTrackTimestamp:new Date(this._elementsCollection.TRACK_TIMESTAMP.VALUE).toISOString()};if("message"===this._itemTypeControl.VALUE){var n={ConversationIndex:this._elementsCollection.CONVERSATION_INDEX.VALUE,Categories:this._elementsCollection.CATEGORIES.VALUE,DateTimeSent:this._elementsCollection.DATE_TIME_SENT.VALUE,DateTimeReceived:this._elementsCollection.DATE_TIME_RECEIVED.VALUE,Importance:this._elementsCollection.IMPORTANCE.VALUE};return Object.assign(n,t)}var r=null;this._elementsCollection[u].VALUE&&(r={Pattern:{DayOfMonth:this._elementsCollection.APPOINTMENT_RECURRENCE_PATTERN_DAY_OF_MONTH.VALUE,DayOfWeekIndex:this._elementsCollection.APPOINTMENT_RECURRENCE_PATTERN_DAY_OF_WEEK_INDEX.VALUE,DaysOfWeek:this._elementsCollection.APPOINTMENT_RECURRENCE_PATTERN_DAYS_OF_WEEK.VALUE,Interval:this._elementsCollection.APPOINTMENT_RECURRENCE_PATTERN_INTERVAL.VALUE,MonthOfYear:this._elementsCollection.APPOINTMENT_RECURRENCE_PATTERN_MONTH_OF_YEAR.VALUE,Type:this._elementsCollection.APPOINTMENT_RECURRENCE_PATTERN_TYPE.VALUE},Range:{Type:this._elementsCollection.APPOINTMENT_RECURRENCE_RANGE_TYPE.VALUE,StartDate:this._elementsCollection.APPOINTMENT_RECURRENCE_RANGE_START_DATE.VALUE,EndDate:this._elementsCollection.APPOINTMENT_RECURRENCE_RANGE_END_DATE.VALUE,NumberOfOccurrences:this._elementsCollection.APPOINTMENT_RECURRENCE_RANGE_NUMBER_OF_OCCURRENCES.VALUE}});var o={UID:this._elementsCollection[s].VALUE,CalendarItemType:this._elementsCollection.CALENDAR_ITEM_TYPE.VALUE,Location:this._elementsCollection[l].VALUE,IsAllDayEvent:this._elementsCollection.APPOINTMENT_IS_ALL_DAY_EVENT.VALUE,LegacyFreeBusyStatus:this._elementsCollection.APPOINTMENT_LEGACY_FREE_BUSY_STATUS.VALUE,Importance:this._elementsCollection.IMPORTANCE.VALUE,Recurrence:r,Categories:this._elementsCollection.CATEGORIES.VALUE};return Object.assign(o,t)},enumerable:!0,configurable:!0}),e.prototype._getAppointment=function(){return this._mockOfficeShimConfiguration.exchangeProperties||{}},e.prototype._getEmail=function(){return this._mockOfficeShimConfiguration.exchangeProperties||{}},e.prototype._getPattern=function(){return this._getAppointment().Recurrence?this._getAppointment().Recurrence.Pattern:{}},e.prototype._getRange=function(){return this._getAppointment().Recurrence?this._getAppointment().Recurrence.Range:{}},e.prototype._initAppointmentProps=function(){var e;return(e={})[s]=r.default.createTextInput(s,"Unique ID",n.prefillValueIfRequired(this._getAppointment().UID)),e.CALENDAR_ITEM_TYPE=r.default.createSelect("CALENDAR_ITEM_TYPE","Calendar Item Type",this._getAppointment().CalendarItemType||"Single",["Single","Occurrence","Exception","RecurringMaster"]),e[l]=r.default.createTextInput(l,"Location",this._getAppointment().Location),e.APPOINTMENT_IS_ALL_DAY_EVENT=r.default.createCheckbox("APPOINTMENT_IS_ALL_DAY_EVENT","Is all day",this._getAppointment().IsAllDayEvent),e.APPOINTMENT_LEGACY_FREE_BUSY_STATUS=r.default.createSelect("APPOINTMENT_LEGACY_FREE_BUSY_STATUS","Show as",this._getAppointment().LegacyFreeBusyStatus||"Free",["Free","Tentative","Busy","OOF","WorkingElsewhere","NoData"]),e[u]=r.default.createCheckbox(u,"Is reccuring",null!=this._getAppointment().Recurrence),e.APPOINTMENT_RECURRENCE_PATTERN_TYPE=r.default.createSelect("APPOINTMENT_RECURRENCE_PATTERN_TYPE","Type",this._getPattern().Type,["Daily","Weekly","AbsoluteMonthly","RelativeMonthly","AbsoluteYearly","RelativeYearly"]),e.APPOINTMENT_RECURRENCE_PATTERN_INTERVAL=r.default.createTextInput("APPOINTMENT_RECURRENCE_PATTERN_INTERVAL","Interval",this._getPattern().Interval),e.APPOINTMENT_RECURRENCE_PATTERN_DAYS_OF_WEEK=r.default.createTextInput("APPOINTMENT_RECURRENCE_PATTERN_DAYS_OF_WEEK","Days of week",this._getPattern().DaysOfWeek),e.APPOINTMENT_RECURRENCE_PATTERN_DAY_OF_MONTH=r.default.createTextInput("APPOINTMENT_RECURRENCE_PATTERN_DAY_OF_MONTH","Day of month",this._getPattern().DayOfMonth),e.APPOINTMENT_RECURRENCE_PATTERN_DAY_OF_WEEK_INDEX=r.default.createTextInput("APPOINTMENT_RECURRENCE_PATTERN_DAY_OF_WEEK_INDEX","Day of week index",this._getPattern().DayOfWeekIndex),e.APPOINTMENT_RECURRENCE_PATTERN_MONTH_OF_YEAR=r.default.createTextInput("APPOINTMENT_RECURRENCE_PATTERN_MONTH_OF_YEAR","Month of year",this._getPattern().MonthOfYear),e.APPOINTMENT_RECURRENCE_RANGE_TYPE=r.default.createSelect("APPOINTMENT_RECURRENCE_RANGE_TYPE","Range type",this._getRange().Type||"EndDate",["NoEnd","Numbered","EndDate"]),e.APPOINTMENT_RECURRENCE_RANGE_START_DATE=r.default.createDate("APPOINTMENT_RECURRENCE_RANGE_START_DATE","Range start date",new Date(this._getRange().StartDate)),e.APPOINTMENT_RECURRENCE_RANGE_END_DATE=r.default.createDate("APPOINTMENT_RECURRENCE_RANGE_END_DATE","Range end date",new Date(this._getRange().EndDate)),e.APPOINTMENT_RECURRENCE_RANGE_NUMBER_OF_OCCURRENCES=r.default.createTextInput("APPOINTMENT_RECURRENCE_RANGE_NUMBER_OF_OCCURRENCES","End After Number Of Occurrences",this._getRange().NumberOfOccurrences),e},e.prototype._initCommonProps=function(){var e;return(e={}).CATEGORIES=r.default.createSelect("CATEGORIES","Categories",[],["Orange category","Blue category","Tracked To Dynamics 365"],!0),e.IMPORTANCE=r.default.createSelect("IMPORTANCE","Importance",[],["Low","Normal","High"]),e},e.prototype._initCRMProps=function(){var e,t=this._mockOfficeShimConfiguration.exchangeProperties.crmTrackTimestamp;return(e={}).CRM_TRACKING_STATE=r.default.createSelect("CRM_TRACKING_STATE","Link state",this._mockOfficeShimConfiguration.exchangeProperties.crmTrackingState||"NotLinked",["NotLinked","WillBeLinked","IsLinked","WillBeUnlinked","WillBeUnlinkedAndDeleted"]),e.CRM_CATEGORY_TRACKER=r.default.createSelect("CRM_CATEGORY_TRACKER","Crm category tracker","Empty",["NotLinked","IsLinked","LinkFailed","Empty"]),e.CRM_REGARDING_ID=r.default.createTextInput("CRM_REGARDING_ID","Regarding Id",this._mockOfficeShimConfiguration.exchangeProperties.crmRegardingId),e.CRM_REGARDING_OBJECT_TYPE=r.default.createLocalizableSelect("CRM_REGARDING_OBJECT_TYPE","Regarding Object Type",this._mockOfficeShimConfiguration.exchangeProperties.crmRegardingObjectType,c,!1,!0),e.CRM_OBJECT_TYPE_CODE=r.default.createSelect("CRM_OBJECT_TYPE_CODE","Activity Type",this._mockOfficeShimConfiguration.exchangeProperties.crmObjectType,d,!1,!0),e.CRM_REGARDING_OBJECT_NAME=r.default.createTextInput("CRM_REGARDING_OBJECT_NAME","Regarding Name",this._mockOfficeShimConfiguration.exchangeProperties.crmRegardingObjectName),e.CRM_ID=r.default.createTextInput("CRM_ID","CRM Id",this._mockOfficeShimConfiguration.exchangeProperties.crmid),e.CRM_IS_FOLLOWED=r.default.createCheckbox("CRM_IS_FOLLOWED","CRM Is Followed",this._mockOfficeShimConfiguration.exchangeProperties.crmIsFollowed),e.TRACK_TIMESTAMP=r.default.createDateTime("TRACK_TIMESTAMP","Tracking Time",null!=t?new Date(t):new Date),e},e.prototype._initElmailProps=function(){var e;return(e={}).PARENT_FOLDER_ID=r.default.createTextInput("PARENT_FOLDER_ID","Parent Folder Id","").Hide(),e.SENT_FOLDER_ID=r.default.createTextInput("SENT_FOLDER_ID","Sent Folder Id","").Hide(),e.CONVERSATION_INDEX=r.default.createTextInput("CONVERSATION_INDEX","Conversation Index",n.prefillValueIfRequired(this._getEmail().ConversationIndex)),e.DATE_TIME_SENT=r.default.createDateTime("DATE_TIME_SENT","Sent Date",new Date(this._getEmail().DateTimeSent)),e.DATE_TIME_RECEIVED=r.default.createDateTime("DATE_TIME_RECEIVED","Received Date",new Date(this._getEmail().DateTimeReceived)),e},e.prototype._updateRecurringFieldsVisibility=function(e){if("message"!==this._itemTypeControl.VALUE)for(var t in e)-1!==t.indexOf("RECURRENCE_")&&(e[u].VALUE?e[t].Show():e[t].Hide())},e.prototype._createBuiltInProps=function(e,t,n){var o=r.default.createSection("BUILT_IN_PROPS_SECTION","Built In Props",!1);return this._addPropsCollectionToSection(e,o),this._addPropsCollectionToSection(t,o),this._addPropsCollectionToSection(n,o),o},e.prototype._addPropsCollectionToSection=function(e,t){for(var n in e)t.AppendControl(e[n].Element),this._elementsCollection[n]=e[n]},e.prototype._createCRMProps=function(e){var t=r.default.createSection("BUILT_IN_PROPS_SECTION","CRM Props",!1);return this._addPropsCollectionToSection(e,t),t},e.prototype._initUI=function(){var e=this,t=this._initElmailProps(),n=this._initAppointmentProps(),o=this._initCRMProps(),i=this._initCommonProps(),a=r.default.createSection("EXCHANGE_PROPS_SECTION","Exchange Props",!0);this._builtInProps=this._createBuiltInProps(t,n,i),a.AppendControls([this._builtInProps.Element,this._createCRMProps(o).Element]),n[u].ON_CHANGE=function(){return e._updateRecurringFieldsVisibility(n)},this._updateRecurringFieldsVisibility(n);var s=function(){for(var r in n)"message"===e._itemTypeControl.VALUE?n[r].Hide():n[r].Show();for(var r in t)"message"===e._itemTypeControl.VALUE?t[r].Show():t[r].Hide();e._updateRecurringFieldsVisibility(n)};this._itemTypeControl.ON_CHANGE=s,s()},e.prototype.FlushConfig=function(){},e}();t.default=p}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFRAME_ID="WebView",t.IFRAME_SANDBOX="allow-scripts allow-same-origin allow-forms allow-popups allow-popups-to-escape-sandbox allow-downloads"}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unknown=0]="Unknown",e[e.Ok=200]="Ok",e[e.NoContent=204]="NoContent",e[e.MultipleChoices=300]="MultipleChoices",e[e.Found=302]="Found",e[e.NotModified=304]="NotModified",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.InternalServerError=500]="InternalServerError"}(n||(n={})),t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Default=0]="Default",e[e.Token=1]="Token",e[e.Cookie=2]="Cookie",e[e.WIA=3]="WIA"}(n||(n={})),t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Sender=1]="Sender",e[e.To=2]="To",e[e.Cc=3]="Cc",e[e.Bcc=4]="Bcc",e[e.Organizer=5]="Organizer",e[e.RequiredAttendee=6]="RequiredAttendee",e[e.OptionalAttendee=7]="OptionalAttendee"}(n||(n={})),t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(10),n(43)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n){return e.call(this,t,n)||this}return a(t,e),t.prototype.toSoap=function(){return'<t:ExtendedFieldURI DistinguishedPropertySetId="PublicStrings" PropertyName="'+this.propertyName+'" PropertyType="'+n.default[this.propertyType]+'" />'},t.prototype.toJson=function(){throw new Error("Not Implemented")},t}(r.default);t.default=o}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(0),n(1),n(4),n(3)],void 0===(o=function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e,t){void 0===e&&(e=""),void 0===t&&(t=""),this.original=e,this.replacement=t};t.HrefsPair=a;var s="b71fa308-2dca-4ae5-90da-c2088c21a0cc",l="4f395986-5f38-4dbd-98c5-6af11ceb062b",u="color:transparent;text-decoration:none;font-size:0px;visibility:hidden;display:none;height:0px;line-height:0px;overflow:hidden;max-height:0px;float:left;mso-hide:all;width:0px;text-indent:-9999px;";function c(e){var t=e.getAttribute("href");return t&&t.replace(/(.*?)[/]*$/,"$1")}function d(e){var t=i.default.document().createElement("div");return t.innerHTML=e,t}t.getUniqueHrefs=function(e,t){return e.JsApiProvider.getBody().then((function(e){for(var n=[],r=d(e).querySelectorAll('a:not([id*="'+l+"_"+t+'"])'),o=0;o<r.length;o++){var i=c(r[o]);i&&-1===n.indexOf(i)&&n.push(i)}return n}))},t.setTrackingInfo=function(e,t,n,r){return e.JsApiProvider.getBody().then((function(o){var a=d(o),p=l+"_"+t,f="e4bddb03-a05d-4f2a-a429-63001472b26e_"+t,_=s+"_"+t,h=_+"_container",m=a.querySelector('img[id*="'+_+'"]'),v=Array.from(a.querySelectorAll('a:not([id*="'+p+'"])'));if(!m){var E=i.default.document().createElement("img"),g=i.default.document().createElement("p");E.setAttribute("id",_),E.setAttribute("src",n),g.setAttribute("id",h),g.setAttribute("style",u),a.appendChild(g).appendChild(E)}if(r.length>0){r.forEach((function(e){for(var t=0;t<v.length;t++){var n=v[t],r=c(n);if(r&&r.toLowerCase()===e.original.toLowerCase()){var o=a.querySelector('a[href="'+n.getAttribute("href")+'"]');o&&(o.setAttribute("href",e.replacement),o.setAttribute("id",n.getAttribute("id")+"_"+p),v.splice(t,1),t--)}}}));var C=i.default.document().createElement("p");C.setAttribute("id",f),C.setAttribute("style",u),C.textContent=JSON.stringify(r),a.appendChild(C)}return e.JsApiProvider.setBodyHtml(a.innerHTML)}))},t.removeTrackingInfo=function(e,t){return e.JsApiProvider.getBody().then((function(i){var a=d(i),u=l+"_"+t,p="e4bddb03-a05d-4f2a-a429-63001472b26e_"+t,f=s+"_"+t+"_container",_=a.querySelector('[id*="'+p+'"]:last-child');if(_){var h=null;try{h=JSON.parse(_.textContent)}catch(t){return e.EventManager.ReportComponentFailure(new r.ComponentError(n.default.EMAIL_ENGAGEMENT,"Failed to parse JSON of linkPairsContent",r.ErrorCode.JSON_PARSE_FAILURE),[{name:o.ErrorEventParameterName.Error,value:t},{name:o.EventParameterName.Data,value:_.textContent}]),Promise.reject(null)}var m=a.querySelectorAll('a[id*="'+u+'"]');h&&h.length>0&&h.forEach((function(e){for(var t=0;t<m.length;t++){var n=m[t],r=c(n);if(r&&r.toLowerCase()===e.replacement.toLowerCase()){var o=a.querySelector('a[href="'+n.getAttribute("href")+'"]');if(o){var i=n.getAttribute("id").replace("_"+u,"");"null"!==i?o.setAttribute("id",i):o.removeAttribute("id"),o.setAttribute("href",e.original)}}}}))}for(var v=a.querySelectorAll('[id*="'+f+'"], [id*="'+p+'"]'),E=0;E<v.length;E++)v[E].parentNode.removeChild(v[E]);return e.JsApiProvider.setBodyHtml(a.innerHTML)}))}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){this.Id=e};t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RoamingSettingKeys={limitedModeNotificationHasBeenClosed:"LimitedModeNotificationHasBeenClosed",installIdKey:"InstallID",selectedRecipientKey:"SelectedRecipient",isOutlookCheckerCommandVisibleKey:"IsOutlookCheckerCommandVisible"}}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(16)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._crmRegardingObjectId="",this._crmTrackingState=n.default.NotLinked,this._crmRegardingObjectName="",this._crmRegardingObjectType=0,this._crmId="",this._crmObjectTypeCode=0,this._crmIsFollowed=0,this._trackTimestamp=""}return Object.defineProperty(e.prototype,"CrmRegardingObjectId",{get:function(){return this._crmRegardingObjectId},set:function(e){this._crmRegardingObjectId=null==e?"":e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CrmTrackingState",{get:function(){return this._crmTrackingState},set:function(e){this._crmTrackingState=isNaN(e)?0:e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CrmRegardingObjectName",{get:function(){return this._crmRegardingObjectName},set:function(e){this._crmRegardingObjectName=null==e?"":e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CrmRegardingObjectType",{get:function(){return this._crmRegardingObjectType},set:function(e){this._crmRegardingObjectType=isNaN(e)?0:e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CrmId",{get:function(){return this._crmId},set:function(e){this._crmId=null==e?"":e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CrmObjectTypeCode",{get:function(){return this._crmObjectTypeCode},set:function(e){this._crmObjectTypeCode=isNaN(e)?0:e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CrmIsFollowed",{get:function(){return this._crmIsFollowed},set:function(e){this._crmIsFollowed=isNaN(e)?0:e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TrackTimestamp",{get:function(){return this._trackTimestamp},set:function(e){this._trackTimestamp=null==e?"":e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CrmCategoryTracker",{get:function(){return this._crmCategoryTracker},set:function(e){this._crmCategoryTracker=isNaN(e)?void 0:e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsTrackedFromMailApp",{get:function(){return this._isTrackedFromMailApp},set:function(e){this._isTrackedFromMailApp=isNaN(e)?void 0:e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SSSPromoteTracker",{get:function(){return this._sssPromoteTracker},set:function(e){this._sssPromoteTracker=isNaN(e)?void 0:e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TrackingStateTracker",{get:function(){return this._trackingStateTracker},set:function(e){this._trackingStateTracker=isNaN(e)?void 0:e},enumerable:!0,configurable:!0}),e.prototype.Clone=function(){var t=new e;return t._crmId=this._crmId,t._crmTrackingState=this._crmTrackingState,t._crmRegardingObjectId=this._crmRegardingObjectId,t._crmRegardingObjectType=this._crmRegardingObjectType,t._crmRegardingObjectName=this._crmRegardingObjectName,t._crmObjectTypeCode=this._crmObjectTypeCode,t._crmIsFollowed=this._crmIsFollowed,t._crmCategoryTracker=this._crmCategoryTracker,t._trackTimestamp=this._trackTimestamp,t._isTrackedFromMailApp=this._isTrackedFromMailApp,t._sssPromoteTracker=this._sssPromoteTracker,t._trackingStateTracker=this._trackingStateTracker,t},e.prototype.toJSON=function(){return{crmId:this._crmId,crmTrackingState:this._crmTrackingState,crmRegardingObjectId:this._crmRegardingObjectId,crmRegardingObjectType:this._crmRegardingObjectType,crmRegardingObjectName:this._crmRegardingObjectName,crmObjectTypeCode:this._crmObjectTypeCode,crmIsFollowed:this._crmIsFollowed,crmCategoryTracker:this._crmCategoryTracker}},e.equals=function(e,t){var n=function(e){return null==e};return!(!n(e)||!n(t))||!(!e||!t)&&(e.CrmId===t.CrmId&&e.CrmRegardingObjectId===t.CrmRegardingObjectId&&e.CrmRegardingObjectName===t.CrmRegardingObjectName&&e.CrmRegardingObjectType===t.CrmRegardingObjectType&&e.CrmTrackingState===t.CrmTrackingState&&e.TrackTimestamp===t.TrackTimestamp)},e}();t.default=r}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(97),n(3),n(71)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={getItem:function(){},setItem:function(){},removeItem:function(){},clear:function(){}},a=function(){function e(){}return Object.defineProperty(e,"localStorage",{get:function(){return e.getStorage(o.default.LocalStorage)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"sessionStorage",{get:function(){return e.getStorage(o.default.SessionStorage)},enumerable:!0,configurable:!0}),e.getStorage=function(t){return t in o.default?e._retrieveStorage(t)||i:e._retrieveStorage(o.default.LocalStorage)||e._retrieveStorage(o.default.SessionStorage)||i},e._retrieveStorage=function(e){return n.default.isStorageAccessible(e)?e===o.default.LocalStorage?r.default.localStorage():e===o.default.SessionStorage?r.default.sessionStorage():void 0:null},e.getItem=function(t){return e.getStorage().getItem(t)},e.setItem=function(t,n){return e.getStorage().setItem(t,n)},e}();t.default=a}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.LocalStorage=0]="LocalStorage",e[e.SessionStorage=1]="SessionStorage"}(n||(n={})),t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=function(){function e(){}return e.SHOW_MORE_BUTTON="showMoreButton",e.ERROR_INFO="errorInfo",e.SHOW_APP_CHECKER="showAppChecker",e}();t.UIClassNames=r,function(e){e.content="content",e.appchecker="appchecker",e.appcheckerClose="appcheckerClose",e.appcheckerBack="appcheckerBack",e.appcheckerSeeMoreDiagnostics="appcheckerSeeMoreDiagnostics",e.appcheckerDiagnosticsBox="appcheckerDiagnosticsBox",e.appcheckerDownloadLogs="appcheckerDownloadLogs",e.appcheckerClearStorage="appcheckerClearStorage",e.appcheckerPopup="appcheckerPopup",e.appcheckerPopupClose="appcheckerPopupClose",e.appcheckerSectionViews="appcheckerSectionViews",e.appcheckerSectionPrivileges="appcheckerSectionPrivileges",e.appcheckerSectionDashboard="appcheckerSectionDashboard"}(n||(n={})),t.UIIdentifierNames=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(235)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._events=[]}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.handleEvent=function(e,t){this._events.push(e)},e.prototype.getEvents=function(){return this._events},e.prototype.clearEvents=function(){this._events=[]},e}();t.getDeveloperConsoleEventsStoreListener=function(e){return n.default.Initialize(e),r.getInstance()},t.saveEventToDeveloperConsoleStore=function(e){r.getInstance().handleEvent(e)},t.clearDeveloperConsoleStoreEvents=function(){r.getInstance().clearEvents()},t.getDeveloperConsoleStoreEvents=function(){return r.getInstance().getEvents()}}.apply(t,r))||(e.exports=o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(75),o=n(12),i=n(48),a=function(){function e(e,t){this._allowDeviceFields=e,this._properties=t}return e.prototype.setAppId=function(e){this._addContext("AppInfo.Id",e)},e.prototype.setAppVersion=function(e){this._addContext("AppInfo.Version",e)},e.prototype.setAppLanguage=function(e){this._addContext("AppInfo.Language",e)},e.prototype.setDeviceId=function(e){this._allowDeviceFields&&(r.default.checkAndSaveDeviceId(e),this._addContext("DeviceInfo.Id",e))},e.prototype.setDeviceOsName=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.OsName",e)},e.prototype.setDeviceOsVersion=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.OsVersion",e)},e.prototype.setDeviceBrowserName=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserName",e)},e.prototype.setDeviceBrowserVersion=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserVersion",e)},e.prototype.setDeviceMake=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.Make",e)},e.prototype.setDeviceModel=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.Model",e)},e.prototype.setUserId=function(e,t,n){if(!isNaN(n)&&null!==n&&n>=0&&n<=12)this._addContext("UserInfo.IdType",n.toString());else{var r=void 0;switch(t){case o.AWTPiiKind.SipAddress:r=i.AWTUserIdType.SipAddress;break;case o.AWTPiiKind.PhoneNumber:r=i.AWTUserIdType.PhoneNumber;break;case o.AWTPiiKind.SmtpAddress:r=i.AWTUserIdType.EmailAddress;break;default:r=i.AWTUserIdType.Unknown}this._addContext("UserInfo.IdType",r.toString())}if(isNaN(t)||null===t||t===o.AWTPiiKind.NotSet||t>13)switch(n){case i.AWTUserIdType.Skype:t=o.AWTPiiKind.Identity;break;case i.AWTUserIdType.EmailAddress:t=o.AWTPiiKind.SmtpAddress;break;case i.AWTUserIdType.PhoneNumber:t=o.AWTPiiKind.PhoneNumber;break;case i.AWTUserIdType.SipAddress:t=o.AWTPiiKind.SipAddress;break;default:t=o.AWTPiiKind.NotSet}this._addContextWithPii("UserInfo.Id",e,t)},e.prototype.setUserAdvertisingId=function(e){this._addContext("UserInfo.AdvertisingId",e)},e.prototype.setUserTimeZone=function(e){this._addContext("UserInfo.TimeZone",e)},e.prototype.setUserLanguage=function(e){this._addContext("UserInfo.Language",e)},e.prototype._addContext=function(e,t){"string"==typeof t&&this._properties.setProperty(e,t)},e.prototype._addContextWithPii=function(e,t,n){"string"==typeof t&&this._properties.setPropertyWithPii(e,t,n)},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(27),o="MicrosoftApplicationsTelemetryDeviceId",i="MicrosoftApplicationsTelemetryFirstLaunchTime",a="MSIE",s="Chrome",l="Firefox",u="Safari",c="Edge",d="Electron",p="SkypeShell",f="PhantomJS",_="Opera",h="Windows",m="Mac OS X",v="Windows Phone",E="Windows RT",g="iOS",C="Android",y="Linux",I="Chrome OS",T=/(windows|win32)/i,A=/ arm;/i,P=/windows\sphone\s\d+\.\d+/i,S=/(macintosh|mac os x)/i,R=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,b=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,O=/android/i,M=/CrOS/i,N={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},x=function(){function e(){}return e.addPropertyStorageOverride=function(e){return!!e&&(this._propertyStorage=e,!0)},e.autoCollect=function(e,t,n){if(this._semanticContext=e,this._disableCookies=t,this._autoCollect(),n||"undefined"==typeof navigator||(n=navigator.userAgent||""),this._autoCollectFromUserAgent(n),this._disableCookies&&!this._propertyStorage)return this._deleteCookie(o),void this._deleteCookie(i);(this._propertyStorage||this._areCookiesAvailable&&!this._disableCookies)&&this._autoCollectDeviceId()},e.checkAndSaveDeviceId=function(e){if(e){var t=this._getData(o),n=this._getData(i);t!==e&&(n=r.getISOString(new Date)),this._saveData(o,e),this._saveData(i,n),this._setFirstLaunchTime(n)}},e._autoCollectDeviceId=function(){var e=this._getData(o);e||(e=r.newGuid()),this._semanticContext.setDeviceId(e)},e._autoCollect=function(){"undefined"!=typeof document&&document.documentElement&&this._semanticContext.setAppLanguage(document.documentElement.lang),"undefined"!=typeof navigator&&this._semanticContext.setUserLanguage(navigator.userLanguage||navigator.language);var e=(new Date).getTimezoneOffset(),t=e%60,n=(e-t)/60,r="+";n>0&&(r="-"),n=Math.abs(n),t=Math.abs(t),this._semanticContext.setUserTimeZone(r+(n<10?"0"+n:n.toString())+":"+(t<10?"0"+t:t.toString()))},e._autoCollectFromUserAgent=function(e){if(e){var t=this._getBrowserName(e);this._semanticContext.setDeviceBrowserName(t),this._semanticContext.setDeviceBrowserVersion(this._getBrowserVersion(e,t));var n=this._getOsName(e);this._semanticContext.setDeviceOsName(n),this._semanticContext.setDeviceOsVersion(this._getOsVersion(e,n))}},e._getBrowserName=function(e){return this._userAgentContainsString("OPR/",e)?_:this._userAgentContainsString(f,e)?f:this._userAgentContainsString(c,e)?c:this._userAgentContainsString(d,e)?d:this._userAgentContainsString(s,e)?s:this._userAgentContainsString("Trident",e)?a:this._userAgentContainsString(l,e)?l:this._userAgentContainsString(u,e)?u:this._userAgentContainsString(p,e)?p:"Unknown"},e._setFirstLaunchTime=function(e){if(!isNaN(e)){var t=new Date;t.setTime(parseInt(e,10)),e=r.getISOString(t)}this.firstLaunchTime=e},e._userAgentContainsString=function(e,t){return t.indexOf(e)>-1},e._getBrowserVersion=function(e,t){return t===a?this._getIeVersion(e):this._getOtherVersion(t,e)},e._getIeVersion=function(e){var t=e.match(new RegExp(a+" ([\\d,.]+)"));if(t)return t[1];var n=e.match(new RegExp("rv:([\\d,.]+)"));return n?n[1]:void 0},e._getOtherVersion=function(e,t){e===u&&(e="Version");var n=t.match(new RegExp(e+"/([\\d,.]+)"));return n?n[1]:"Unknown"},e._getOsName=function(e){return e.match(P)?v:e.match(A)?E:e.match(R)?g:e.match(O)?C:e.match(b)?y:e.match(S)?m:e.match(T)?h:e.match(M)?I:"Unknown"},e._getOsVersion=function(e,t){return t===h?this._getGenericOsVersion(e,"Windows NT"):t===C?this._getGenericOsVersion(e,t):t===m?this._getMacOsxVersion(e):"Unknown"},e._getGenericOsVersion=function(e,t){var n=e.match(new RegExp(t+" ([\\d,.]+)"));return n?N[n[1]]?N[n[1]]:n[1]:"Unknown"},e._getMacOsxVersion=function(e){var t=e.match(new RegExp(m+" ([\\d,_,.]+)"));if(t){var n=t[1].replace(/_/g,".");if(n){var r=this._getDelimiter(n);return r?n.split(r)[0]:n}}return"Unknown"},e._getDelimiter=function(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null},e._saveData=function(e,t){if(this._propertyStorage)this._propertyStorage.setProperty(e,t);else if(this._areCookiesAvailable){var n=new Date;n.setTime(n.getTime()+31536e6);var r="expires="+n.toUTCString();document.cookie=e+"="+t+"; "+r}},e._getData=function(e){if(this._propertyStorage)return this._propertyStorage.getProperty(e)||"";if(this._areCookiesAvailable){e+="=";for(var t=document.cookie.split(";"),n=0;n<t.length;n++){for(var r=t[n],o=0;" "===r.charAt(o);)o++;if(0===(r=r.substring(o)).indexOf(e))return r.substring(e.length,r.length)}}return""},e._deleteCookie=function(e){this._areCookiesAvailable&&(document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},e._disableCookies=!1,e._areCookiesAvailable="undefined"!=typeof document&&void 0!==document.cookie,e}();t.default=x},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r,o;t.MailAppRolePrivileges=["prvAppendActivity","prvAppendToActivity","prvAppendToAccount","prvAppendToContact","prvCreateActivity","prvCreateContact","prvCreateExchangeSyncIdMapping","prvDeleteActivity","prvDeleteExchangeSyncIdMapping","prvReadAccount","prvReadActivity","prvReadAppModule","prvReadAttribute","prvReadContact","prvReadEmailServerProfile","prvReadEntity","prvReadExchangeSyncIdMapping","prvReadMailbox","prvReadOrganization","prvReadQuery","prvReadRelationship","prvReadRole","prvReadSystemApplicationMetadata","prvReadSystemForm","prvReadUser","prvReadUserQuery","prvReadUserApplicationMetadata","prvReadWebResource","prvSearchAvailability","prvShareActivity","prvSyncToOutlook","prvUseOfficeApps","prvWriteActivity","prvWriteMailbox","prvWriteExchangeSyncIdMapping"],function(e){e.PrivilegeErrorOccurs="https://go.microsoft.com/fwlink/p/?linkid=2135239",e.ViewDeactivated="https://go.microsoft.com/fwlink/p/?linkid=2135478",e.Dashboard="https://go.microsoft.com/fwlink/p/?linkid=2137902"}(n||(n={})),t.HelpLinks=n,function(e){e.MyActiveCases="00000000-0000-0000-00aa-000010001028",e.AllCasesforCustomer="00000000-0000-0000-00aa-000010001039",e.RecentOpportunitiesForInteractionCentricForm="09f55f67-3964-4a94-92e3-25c9d272dc30",e.AllCompetitorsSummary="57bca9ac-87a0-4c28-adc8-2d0a4645f29e",e.AllStakeholders="4e3600fa-b9c8-49f4-b69a-51eba06d9bdf",e.NextActivity="1d145a26-fdb7-45ae-b55a-7befa66e184f",e.LastActivity="924e0056-ebf8-408e-90c3-d3b6bdd676e7"}(r||(r={})),t.ViewIds=r,function(e){e.MailAppDashboard="95f2e667-95c3-e611-80d6-00155db7dbc8"}(o||(o={})),t.SystemFormIds=o}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.isKnownCrmErrorCode=function(t){return-1!==[e.CRM_ORGANIZATION_DISABLED,e.CRM_BUSINESS_UNIT_DISABLED,e.CRM_USER_DISABLED,e.CRM_USER_ROLES_MISSING,e.CRM_USER_LICENSE_MISSING,e.CRM_USER_NOT_MEMBER_OF_ORGANIZATION,e.CRM_USER_MISSING_ADMIN_ONLY_MODE_PERMISSIONS,e.CRM_USER_MISSING_PRIVILEGE].indexOf(t)},e.isKnownLimitedModeErrorCode=function(t){return-1!==[e.UV_MAILBOX_INACTIVE,e.UV_SSS_CONFIG_MISSING,e.UV_SSS_CONFIG_MISSING_FOR_ACT,e.UV_SSS_CONFIG_FAILURE,e.UV_SSS_CONFIG_FAILURE_FOR_ACT,e.UV_EMAIL_ADDRESS_MISMATCH].indexOf(t)},e.isKnownOfficeSaveAsyncErrorCode=function(t){return-1!==[e.OFFICE_SAVE_ASYNC_MESSAGE_IN_DIFFERENT_STORE,e.OFFICE_SAVE_ASYNC_UNSUPPORTED,e.OFFICE_SAVE_ASYNC_UNSUPPORTED_IN_OWA,e.OFFICE_SAVE_ASYNC_UNSUPPORTED_IN_OUTLOOK].indexOf(t)},e.isPluginOrWorkflowError=function(t){return-1!==t.indexOf(e.ISV_ABORTED.toString())||-1!==t.indexOf(e.ISV_UNEXPECTED.toString())||-1!==t.indexOf(e.UNMANAGED_IDS_SQL_ERROR.toString())||-1!==t.indexOf(e.TRANSACTION_NOT_STARTED.toString())},e.UNKNOWN=0,e.GENERIC=2147873296,e.NOT_SUPPORTED=2148007944,e.UNCAUGHT_EXCEPTION=2148007955,e.AUTH_FAILED=2147873301,e.CLIENT_LOAD_TIMEOUT=2147873284,e.XHR_REQUEST_FAILURE=2147942402,e.JSON_PARSE_FAILURE=2147942403,e.DELEGATE_DISABLED=2148007945,e.STORAGE_UNAVAILABLE=2147942405,e.STORAGE_OPERATION=2148007952,e.COMPATIBILITY_DEVICE_SUPPORT=2147881472,e.COMPATIBILITY_BROWSER_SUPPORT=2147881473,e.COMPATIBILITY_OUTLOOK_DESKTOP_WITH_IE_SUPPORT=2147881625,e.COMPATIBILITY_MOBILE_BROWSER_SUPPORT=2147881480,e.UV_SSS_CONFIG_MISSING=2147881474,e.UV_SSS_CONFIG_MISSING_FOR_ACT=2147881495,e.UV_SSS_CONFIG_FAILURE=2147881504,e.UV_SSS_CONFIG_FAILURE_FOR_ACT=2147881505,e.UV_MAILBOX_INACTIVE=2147881494,e.UV_ADMIN_ACCESS=2147881475,e.UV_OFFICE_APPS_PERMISSION=2147881477,e.UV_PRIVILEGE_READ_CONTACT=2147881497,e.UV_TABLET_PRIVILEGES=2147873295,e.UV_EMAIL_ADDRESS_MISMATCH=2147881489,e.UV_OPEN_MAILBOX_EXCEPTION=2147869206,e.OFFICE_ASYNC_CALL_FAILED=2147881513,e.OFFICE_SAVE_ASYNC_UNAVAILABLE=2148007938,e.OFFICE_SAVE_ASYNC=2148007937,e.OFFICE_SAVE_ASYNC_MESSAGE_IN_DIFFERENT_STORE=2147881536,e.OFFICE_SAVE_ASYNC_UNSUPPORTED=2147881537,e.OFFICE_SAVE_ASYNC_UNSUPPORTED_IN_OWA=2147881538,e.OFFICE_SAVE_ASYNC_UNSUPPORTED_IN_OUTLOOK=2147881539,e.OFFICE_DELEGATE_SAVE_ASYNC=2148007943,e.OFFICE_FAILED_TO_LOAD=2147793434,e.OFFICE_MAILBOX_ITEM_UNAVAILABLE=2147791382,e.OFFICE_CATEGORY_UPDATE=2147791383,e.OFFICE_TRANSIENT_ERROR=2147791384,e.EXCHANGE_GENERIC=2148007939,e.EXCHANGE_ITEM_NOT_FOUND=2148007940,e.CRM_ORGANIZATION_DISABLED=2147787012,e.CRM_BUSINESS_UNIT_DISABLED=2147746604,e.CRM_USER_DISABLED=2147746341,e.CRM_USER_ROLES_MISSING=2147757833,e.CRM_USER_LICENSE_MISSING=2147799627,e.CRM_USER_NOT_MEMBER_OF_ORGANIZATION=2147951968,e.CRM_USER_MISSING_ADMIN_ONLY_MODE_PERMISSIONS=2147787027,e.CRM_USER_MISSING_PRIVILEGE=2147746336,e.ISV_ABORTED=-2147220891,e.ISV_UNEXPECTED=-2147220956,e.UNMANAGED_IDS_SQL_ERROR=-2147204784,e.TRANSACTION_NOT_STARTED=-2147220911,e.ACCESS_DENIED=-2147187962,e.CRM_APP_MODULE_PERMISSION=2147942404,e}();t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r};void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.document=function(){return this._window.document},e.screen=function(){return this._window.screen},e.navigator=function(){return this._window.navigator},e.URL=function(){return this._window.URL},e.localStorage=function(){return this._window.localStorage},e.sessionStorage=function(){return this._window.sessionStorage},e.console=function(){return this._window.console?this._window.console:{assert:function(){},error:function(){},exception:function(){},info:function(){},log:function(){},trace:function(){},warn:function(){}}},e.location=function(){return this._window.location},e.atob=function(e){if(this._window.atob)return this._window.atob(e);throw new Error("window.atob undefined")},e.btoa=function(e){if(this._window.btoa)return this._window.btoa(e);throw new Error("window.btoa undefined")},e.crypto=function(){return this._window.crypto||this._window.msCrypto},e.performance=function(){if(this._window.performance)return this._window.performance;throw new Error("window.performance is undefined")},e.Office=function(){return this._window.Office},e.PageLoadStartTime=function(){return this._window.PageLoadStartTime},e.LibrariesLoadStartTime=function(){return this._window.LibrariesLoadStartTime},e.LibrariesLoadEndTime=function(){return this._window.LibrariesLoadEndTime},e.ShimJsLoadEndTime=function(){return this._window.ShimJsLoadEndTime},e.open=function(e,t,n){if(this._window.open)return this._window.open(e,t,n);throw new Error("window.open undefined")},e.setTimeout=function(e,t){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(this._window.setTimeout)return(n=this._window).setTimeout.apply(n,o([e,t],r));throw new Error("window.setTimeout undefined")},e.setInterval=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(this._window.setInterval)return this._window.setInterval(e,t,n);throw new Error("window.setInterval undefined")},e.clearInterval=function(e){if(this._window.clearInterval)return this._window.clearInterval(e);throw new Error("window.clearInterval is undefined")},e.clearTimeout=function(e){if(!this._window.clearTimeout)throw new Error("window.clearTimeout undefined");this._window.clearTimeout(e)},e.postMessage=function(e,t,n){if(!this._window.postMessage)throw new Error("window.postMessage undefined");this._window.postMessage(e,t,n)},e.self=function(){return this._window},e.top=function(){return this._window.top},e.appResource=function(e){if(this._window.RESOURCES)return this._window.RESOURCES[e]},e.appVersion=function(){return this._window.CRM_VERSION_NUMERIC_VALUE},e.shimVersion=function(){return this._window.SHIM_VERSION_NUMERIC_VALUE},e.onError=function(e){this._window.onerror=e},e.addEventListener=function(e,t,n){if(!this._window.addEventListener)throw new Error("window.addEventListener undefined");this._window.addEventListener(e,t,n)},e.removeEventListener=function(e,t){if(!this._window.removeEventListener)throw new Error("window.removeEventListener undefined");this._window.removeEventListener(e,t)},e.dispatchEvent=function(e){if(this._window.dispatchEvent)return this._window.dispatchEvent(e);throw new Error("window.dispatchEvent undefined")},e.adalLoginCallback=function(e){this._window.adalLoginCallback=e},e.adfsLoginCallback=function(e){this._window.adfsLoginCallback=e},e.authLoginCallback=function(e){this._window.authLoginCallback=e},e.authenticatedPageLoaded=function(e){this._window.authenticatedPageLoaded=e},e.AuthenticationContext=function(e){return this._window.AuthenticationContext?new this._window.AuthenticationContext(e):null},e.isOnline=function(){return this._window.navigator.onLine},e._window=window,e}();t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(19),n(7),n(0),n(1),n(37)],void 0===(o=function(e,t,n,r,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){this._bcd=e,this._applicationContext=t,this._loadingDeffered=r.default.createDeferredPromise(),this._bootStarted=!1}return e.prototype.boot=function(e){var t=this;if(!this._bootStarted){this._bootStarted=!0;var r=this._applicationContext.Performance.addStopwatch(o.default.RESOURCE_MANAGER),a=e?"."+e:"",s=n.default.document().createElement("script");s.src="resources/loc/resources"+a+".js?v="+n.default.appVersion(),s.onload=function(){r.stop(),t._loadingDeffered.Resolve()},s.onerror=function(){t._applicationContext.EventManager.ReportComponentFailure(new i.ComponentError(o.default.RESOURCE_MANAGER,"Failed to load "+s.src,i.ErrorCode.GENERIC)),t._loadingDeffered.Resolve()},n.default.document().body.appendChild(s)}},Object.defineProperty(e.prototype,"loadingPromise",{get:function(){return this._loadingDeffered.Promise},enumerable:!0,configurable:!0}),e.prototype.getString=function(e){return n.default.appResource(e)||e},e.prototype.getErrorTitle=function(e){if(!e||e.code===i.ErrorCode.UNKNOWN)return this.getString("MoCA_OWA_Generic_Error_Title");var t=this._getErrorCodeTitleResourceId(e.code),n=this.getString(t);return n===t?this.getString("MoCA_OWA_Generic_Error_Title"):n},e.prototype.getErrorMessage=function(e){if(!e||e.code===i.ErrorCode.UNKNOWN)return this.getString("Error_Message_Generic_Mobile_Client");var t=this._getErrorCodeResourceId(e.code),n=this.getString(t);return n===t?this.getString("Error_Message_Generic_Mobile_Client")+this._getErrorCodeAsHexString(e.code):e instanceof a.default&&e.errorMessageParameters&&e.errorMessageParameters.length?n.format.apply(n,e.errorMessageParameters):n},e.prototype._getErrorCodeResourceId=function(e){return null==e?"":"Error_Message_"+this._getErrorCodeAsHexString(e)},e.prototype._getErrorCodeTitleResourceId=function(e){return this._getErrorCodeResourceId(e)+"_Title"},e.prototype._getErrorCodeAsHexString=function(e){var t=e;return t<0&&(t=t+4294967295+1),"0x"+t.toString(16)},e}();t.ResourceManager=s;var l=["ar-sa","bg-bg","ca-es","zh-tw","cs-cz","da-dk","de-de","el-gr","fi-fi","fr-fr","he-il","hu-hu","it-it","ja-jp","ko-kr","nl-nl","nb-no","pl-pl","pt-br","ro-ro","ru-ru","hr-hr","sk-sk","sv-se","th-th","tr-tr","id-id","uk-ua","sl-si","et-ee","lv-lv","lt-lt","vi-vn","eu-es","hi-in","ms-my","kk-kz","gl-es","zh-cn","pt-pt","sr-latn-rs","zh-hk","es-es","sr-cyrl-rs"];t.bootableResourceManager=function(){return function(e,t){var n=t.ResourceManager;return t.ComponentsLoader.ensureComponentLoaded(o.default.JS_API_PROVIDER).then((function(){var e=t.JsApiProvider.getDisplayLanguage();n.boot(e&&-1!==l.indexOf(e.toLowerCase())?e:null)})),n.loadingPromise}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(0),n(81),n(121)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.IS_FEATURES_ENABLED=n.default.CRM_PROVIDER+"."+r.default.IS_FEATURES_ENABLED,e.CHECK_READ_PRIVILEGE=n.default.CRM_PROVIDER+"."+r.default.CHECK_READ_PRIVILEGE,e.GET_USER_VALIDATION=n.default.CRM_PROVIDER+"."+r.default.GET_USER_VALIDATION,e.GET_APP_ID=n.default.CRM_PROVIDER+"."+o.default.GET_APP_ID,e.WHO_AM_I=n.default.CRM_PROVIDER+"."+o.default.WHO_AM_I,e.ORG_SETTINGS=n.default.CRM_PROVIDER+"."+o.default.ORG_SETTINGS,e.SYSTEM_USER=n.default.CRM_PROVIDER+"."+o.default.SYSTEM_USER,e.ODATA_BATCH_REQUEST=n.default.CRM_PROVIDER+"."+o.default.ODATA_BATCH_REQUEST,e.EXECUTE_ODATA_QUERY=n.default.CRM_PROVIDER+"."+o.default.ODATA_QUERY,e.CATEGORIES=n.default.CRM_PROVIDER+"."+o.default.TRACKING_CATEGORIES,e}();t.default=i}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.GET_USER_VALIDATION="GetUserValidation",e.CHECK_READ_PRIVILEGE="CheckEntitiesReadPrivilege",e.IS_FEATURES_ENABLED="IsFeaturesEnabled",e}();t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(1),n(11),n(15)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAllowedForLimitedMode=function(e){if(!e)return!1;var t=e.code<0?e.code>>>0:e.code;return n.ErrorCode.isKnownLimitedModeErrorCode(t)},t.isTrackAllowedInLimitedMode=function(e,t){return e===r.default.message&&t===o.default.Read}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(62),n(1)],void 0===(o=function(e,t,n,r){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),function(e){var t=function(){function e(e){this._request=e}return e.prototype.header=function(e){var t=this._request.getResponseHeader(e);return!t&&e&&e.toLowerCase&&(t=this._request.getResponseHeader(e.toLowerCase())),t},e.prototype.status=function(){return this._request.status},e.prototype.statusText=function(){return this._request.statusText},e.prototype.responseURL=function(){return this._request.responseURL},e.prototype.data=function(){switch(this._request.responseType){case"text":return this._request.responseText;default:return this._request.response}},e.prototype.getComponentError=function(e){return new r.ComponentError(e,e+" XMLHTTPRequest failed",r.ErrorCode.XHR_REQUEST_FAILURE,new r.ComponentError("XHR",this.data(),this.status()))},e}();e.Response=t;var o=function(){function e(e,t){this._name=e,this._value=t}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.KeyValue=o,e.SendRequest=function(r){return new Promise((function(o,i){var a=r.isSuccessFn?r.isSuccessFn:function(e){return e>=n.default.Ok&&e<n.default.MultipleChoices},s=new XMLHttpRequest,l=r.method?r.method:"GET",u="GET"===l&&r.args?function(e,t){var n=e.split("?");n.reverse();var r=n.length>1?n[0].split("&"):[];return t.forEach((function(e){r.unshift(e.name+"="+e.value)})),n[0]=r.join("&"),n.reverse(),n.join("?")}(r.url,r.args):r.url,c=!1!==r.isAsync,d=function(e){return void 0===e&&(e=""),function(){var n=new t(s);"error"!==e&&a(n.status())?o(n):i(n)}};s.onload=d(null),s.onerror=d("error"),s.ontimeout=d("error"),s.open(l,u,c),function(t,n){void 0===n&&(n=[]);var r=[new e.KeyValue("X-Requested-With","XMLHttpRequest"),new e.KeyValue("Accept","application/json"),new e.KeyValue("Content-Type","application/json; charset=utf-8")];n&&n.length>0&&n.forEach((function(e,t){var n=r.findIndex((function(t){return t.name===e.name}));-1!==n&&r.splice(n,1),r.push(e)}));r.forEach((function(e){t.setRequestHeader(e.name,e.value)}))}(s,r.headers),r.timeout&&(s.timeout=r.timeout);var p=void 0===r.content?null:r.content,f=r.responseType?r.responseType:"text";s.responseType=f,s.send(p)}))}}(o||(o={})),t.default=o}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(123),n(62),n(1),n(83),n(4),n(25),n(7),n(63)],void 0===(o=function(e,t,n,r,o,i,a,s,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){this._applicationContext=t,this._bcd=e}return e.prototype.send=function(e,t){var n=this;return null===this._applicationContext.AuthenticationProvider.getToken()?this._applicationContext.AuthenticationProvider.authenticate().then((function(){return n._sendAuthenticatedRequest(e,t)})):this._sendAuthenticatedRequest(e,t)},e.prototype._sendAuthenticatedRequest=function(t,n,r){var s=this;void 0===r&&(r=!1);var l=this._applicationContext.Performance.addStopwatch(t+".XHR");this._addOrUpdateAuthenticationHeader(n);var u=this._addCorrelationHeadersAndGenerateRequestId(n);return i.default.SendRequest(n).then((function(e){l.stop();var r=e.header("REQ_ID");if(e.header("Content-Type").indexOf("text/html")>-1){var i=e.getComponentError(t);throw e.data().indexOf('errNumber">0x8004A104')>-1?(i.message="Unable to connect to Microsoft Dynamics 365 organization because it is disabled at this time",i.code=o.ErrorCode.CRM_ORGANIZATION_DISABLED,s._applicationContext.EventManager.ReportComponentFailure(i,[{name:a.EventParameterName.ClientRequestId,value:u},{name:a.EventParameterName.ServerRequestId,value:r}]),i):i}var c=s._parseResponse(t,e,n,u,r);if(n.isBatch&&!c.isSuccess&&1===n.batchQueriesCount){i=e.getComponentError(t);throw s._applicationContext.EventManager.ReportComponentFailure(i,[{name:a.EventParameterName.ClientRequestId,value:u},{name:a.EventParameterName.ServerRequestId,value:r}]),i}return c.parsedResponse})).catch((function(l){if(!(l instanceof i.default.Response))throw l;var c=l.header("REQ_ID"),d=s._parseResponse(t,l,n,u,c).parsedResponse,p=e._convertResponseToComponentError(d,t,l),f=o.ErrorCode.isKnownCrmErrorCode(p.code);if(s._isUnauthorizedStatus(l.status())&&!r&&!f)return s._applicationContext.AuthenticationProvider.authenticate().then((function(){return s._sendAuthenticatedRequest(t,n,!0)}));if(n.isBatch&&n.batchQueriesCount>1)return d;throw s._applicationContext.EventManager.ReportComponentFailure(p,[{name:a.EventParameterName.ClientRequestId,value:u},{name:a.EventParameterName.ServerRequestId,value:c},{name:a.EventParameterName.AuthActivityId,value:l.header("AuthActivityId")}]),p}))},e.prototype._isUnauthorizedStatus=function(e){return e===r.default.Unauthorized||e===r.default.Ok||e===r.default.Unknown},e.prototype._addOrUpdateAuthenticationHeader=function(e){var t=this._applicationContext.AuthenticationProvider.getToken();if(t||this._bcd.useAuthMethod===u.default.WIA){var n=this._bcd.useAuthMethod===u.default.WIA?new i.default.KeyValue("withCredentials","True"):new i.default.KeyValue("Authorization","Bearer "+t);e.headers?(e.headers=e.headers.filter((function(e){return e.name!==n.name})),e.headers.unshift(n)):e.headers=[n]}},e.prototype._addCorrelationHeadersAndGenerateRequestId=function(e){var t=this._applicationContext.EventManager.getSessionId(),n=s.default.newGuid().guid,r=[new i.default.KeyValue("Request-Id",n)];return t&&(r.push(new i.default.KeyValue("Client-Session-Id",t)),r.push(new i.default.KeyValue("Client-Activity-Id",t))),e.headers=e.headers?e.headers.concat(r):r,n},e.prototype._parseResponse=function(t,r,i,s,l){var u=r.data();if(!u)return{parsedResponse:u,isSuccess:!1};if(i.isBatch)try{var c=n.parseBatchResponse(r);if(1===i.batchQueriesCount){var d=c[0];return{parsedResponse:d.json(),isSuccess:d.ok}}return{parsedResponse:c.map((function(n){var o=n.json();return n.ok?o:e._convertResponseToComponentError(o,t,r)})),isSuccess:c.every((function(e){return e.ok}))}}catch(e){var p=new o.ComponentError(t,"Failed to parse "+t+" Batch Response, status: "+r.status(),o.ErrorCode.JSON_PARSE_FAILURE);throw this._applicationContext.EventManager.ReportComponentFailure(p,[{name:a.ErrorEventParameterName.Error,value:e},{name:a.EventParameterName.ClientRequestId,value:s},{name:a.EventParameterName.ServerRequestId,value:l}]),p}try{return{parsedResponse:JSON.parse(u)}}catch(e){p=new o.ComponentError(t,"Failed to parse "+t+" XHR.Response JSON, status: "+r.status(),o.ErrorCode.JSON_PARSE_FAILURE);throw this._applicationContext.EventManager.ReportComponentFailure(p,[{name:a.ErrorEventParameterName.Error,value:e},{name:a.EventParameterName.ClientRequestId,value:s},{name:a.EventParameterName.ServerRequestId,value:l}]),p}},e._tryParseCrmError=function(e){try{return e.error?{code:parseInt(e.error.code,16),message:l.default.cleanupGuidFromString(e.error.message||"")}:e._error?{code:parseInt(e._error.Code,16),message:l.default.cleanupGuidFromString(e._error.Description||"")}:null}catch(e){return null}},e._convertResponseToComponentError=function(t,n,r){var i,a=e._tryParseCrmError(t);return o.ErrorCode.isKnownCrmErrorCode(null===(i=a)||void 0===i?void 0:i.code)?new o.ComponentError(n,a.message,a.code):r.getComponentError(n)},e}();t.default=c}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UnhandledError=0]="UnhandledError",e[e.UnhandledRejection=1]="UnhandledRejection"}(n||(n={})),t.ErrorType=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unknown=0]="Unknown",e[e.Outlook=1]="Outlook",e[e.OutlookWebApp=2]="OutlookWebApp",e[e.OutlookMobile=3]="OutlookMobile"}(n||(n={})),t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(149),n(172)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="MAIL_CONTEXT";t.MAIL_CONTEXT=o;t.default=function(e,t){var i={id:o,properties:null,actions:null};return i.properties=r.default.reduce((function(n,r){var o=r(e,t);return o&&o.accessor&&(n[o.id]=o),n}),{}),i.actions=n.default.reduce((function(n,r){var o=r(e,t,i);return o&&o.invoker&&(n[o.id]=o),n}),{}),i}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(11),n(152)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t,n){this.property=e,this._value=t,this._itemType=n}return Object.defineProperty(e.prototype,"propertyValue",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"propertyName",{get:function(){return this.property.propertyName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"propertyType",{get:function(){return this.property.propertyType},enumerable:!0,configurable:!0}),e.prototype._getItemTypeTag=function(){return this._itemType===n.default[n.default.message]||this._itemType===n.default[n.default.appointment]?"Message":this._itemType===n.default[n.default.contact]?"Contact":void 0},e.prototype.getInnerSoap=function(){throw"Not implemented"},e.prototype.toJson=function(){throw"Not implemented"},e.prototype.toSoap=function(){var e=this._getItemTypeTag();return"<t:"+r.default.SET_ITEM_FIELD+">\n\t\t\t\t\t"+this.property.toSoap()+"\n\t\t\t\t\t<t:"+e+">\n\t\t\t\t\t\t"+this.getInnerSoap()+"\n\t\t\t\t\t</t:"+e+">\n\t\t\t\t</t:"+r.default.SET_ITEM_FIELD+">"},e}();t.default=o}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(67)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){return e.call(this,t)||this}return a(t,e),t}(n.default);t.default=r}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){void 0===e&&(e=50),this._itemIds=[],this._recipientEmails={},this._capacity=e}return e.deserialize=function(t,n){void 0===n&&(n=50);var r=new e(n);if(t&&t._itemIds&&t._recipientEmails){r._itemIds=t._itemIds,r._recipientEmails=t._recipientEmails;r._ensureCapacity(0)}return r},e.prototype.add=function(e,t){if(this._recipientEmails[e])this._touch(e);else{this._ensureCapacity(1),this._itemIds.push(e)}this._recipientEmails[e]=t},e.prototype.getEmail=function(e){return this._recipientEmails[e]?(this._touch(e),this._recipientEmails[e]):null},e.prototype._ensureCapacity=function(e){var t=this._itemIds.length+e-this._capacity;if(t>0){for(var n=0;n<t;n++)delete this._recipientEmails[this._itemIds[0]];this._itemIds.splice(0,t)}},e.prototype._touch=function(e){for(var t=this._itemIds,n=t.indexOf(e),r=t.length-1,o=n;o<r;++o){var i=t[o];t[o]=t[o+1],t[o+1]=i}},e}();t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Html=0]="Html",e[e.Text=1]="Text"}(n||(n={})),t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(9),n(64)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return!!e&&!!e.find((function(e){var t=e&&e.dataValues&&e.dataValues[n.PropertyNames.Role]===r.default.Organizer,o=e&&e.entityReference&&e.entityReference.LogicalName===n.CrmTypeNames.User;return t&&o}))}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Single=0]="Single",e[e.Occurrence=1]="Occurrence",e[e.Exception=2]="Exception",e[e.RecurringMaster=3]="RecurringMaster"}(n||(n={})),t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(11),n(69),n(18),n(16),n(93),n(3)],void 0===(o=function(e,t,n,r,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){this._applicationContext=e,this._telemetryBaseComponentName=t}return e.prototype.subscribe=function(e){var t=this,n=this._getNotifyUpdateWithTimeout(e),o=n.notifyUpdateWithTimeout,a=n.clearTimeout;this._applicationContext.ExchangeProvider.MailboxItemProvider.addItemChangedListener((function(e){if(e.isMailboxItemChanged&&(t._activityItem=null,a()),e.mailboxItem&&e.trackStatus){t._trackStatus&&t._trackStatus.CrmTrackingState===i.default.WillBeLinked&&t._trackStatus.CrmTrackingState!==e.trackStatus.CrmTrackingState&&a(),t._mailboxItem=e.mailboxItem,t._trackStatus=e.trackStatus;var n=t._lastEvaluatedTrackStatus?t._lastEvaluatedTrackStatus.Clone():null;t.getTrackStatus().then((function(t){e.isMailboxItemChanged?o(Promise.resolve(t)):r.default.equals(n,t)||o(Promise.resolve(t))}))}}))},e.prototype.getTrackStatus=function(){var e=this;if(this._pendingEvaluation)return this._pendingEvaluation;var t=[];return this._hasBooleanValue(this._isLimitedMode)||t.push(this._applicationContext.CRMProvider.isLimitedMode().then((function(t){return e._isLimitedMode=t}))),this._hasBooleanValue(this._isCategoryTrackingEnabled)||t.push(this._applicationContext.CRMProvider.isCategoryTrackingEnabled().then((function(t){return e._isCategoryTrackingEnabled=t}))),this._mailboxItem||t.push(this._applicationContext.ExchangeProvider.MailboxItemProvider.retrieveMailboxItem().then((function(t){return e._mailboxItem=t}))),this._trackStatus||t.push(this._applicationContext.ExchangeProvider.MailboxItemProvider.retrieveTrackStatus().then((function(t){return e._trackStatus=t}))),this._pendingEvaluation=Promise.all(t).then((function(){return e._evaluateTrackStatus()})).then((function(t){return e._lastEvaluatedTrackStatus=t})),this._pendingEvaluation},e.prototype._evaluateTrackStatus=function(){var e=this;if(this._mailboxItem.ItemType===n.default[n.default.appointment]){var t=this._mailboxItem.CalendarItemType;if(-1!==[a.default[a.default.Occurrence],a.default[a.default.Exception]].indexOf(t))return Promise.resolve(new r.default)}return this._checkSSSTrackResilience().then((function(t){e._pendingEvaluation=null;var n=e._trackStatus.Clone();return t?e._isLimitedMode&&n.CrmTrackingState===i.default.WillBeLinked?(e._applicationContext.EventManager.ReportTraceInfo(e._telemetryBaseComponentName+".Resilience","In Limited Mode we alter pending tracking with failure state to allow retry with Immediate Track"),n.CrmTrackingState=i.default.LinkFailed,n):e._isCategoryTrackingEnabled?n.CrmCategoryTracker===o.default.LinkFailed?(e._applicationContext.EventManager.ReportTraceInfo(e._telemetryBaseComponentName+".CategoriesTracking","Tracking state updated: 'Categorized tracking failed CrmCategoryTracker state is LinkFailed.'"),n.CrmTrackingState=i.default.LinkFailed,n):e._mailboxTrackingCategoryName?e._updateTrackStatusBasedOnCategories(n):e._applicationContext.CRMProvider.getMailboxTrackingCategoryName().then((function(t){return e._mailboxTrackingCategoryName=t})).then((function(){return e._updateTrackStatusBasedOnCategories(n)})):n:(n.CrmTrackingState=i.default.LinkFailed,n)})).catch((function(t){throw e._pendingEvaluation=null,t}))},e.prototype._checkSSSTrackResilience=function(){var e=this;return this._shouldBeProcessedWithSSS()&&this._isTrackPendingTimeout()?(this._applicationContext.EventManager.ReportTraceWarning(this._telemetryBaseComponentName+".Resilience","SSS did not process the item in 20 minutes requesting data from CRM"),this.getActivityItem().then((function(t){return e._applicationContext.EventManager.ReportTraceWarning(e._telemetryBaseComponentName+".Resilience","Activity was "+(t?"":"not")+" found in CRM"),Boolean(t)}))):Promise.resolve(!0)},e.prototype._updateTrackStatusBasedOnCategories=function(e){var t="",n=this._mailboxItem.Categories||[],r=n.length>0&&-1!==n.indexOf(this._mailboxTrackingCategoryName),a=e.CrmTrackingState===i.default.IsLinked,s=e.CrmTrackingState===i.default.WillBeLinked,l=i.default[e.CrmTrackingState];if(!r||a||s||(t="User tracked the item using category without Mail App.",e.CrmTrackingState=i.default.WillBeLinked),e.CrmCategoryTracker!==o.default.IsLinked||r||!a&&!s||(t="Category is not present on the item.",e.CrmTrackingState=i.default.WillBeUnlinked),t){var u=i.default[e.CrmTrackingState];this._applicationContext.EventManager.ReportTraceInfo(this._telemetryBaseComponentName+".CategoriesTracking","Tracking state updated: '"+t+"'",{originalTrackingState:l,newTrackingState:u})}return e},e.prototype._hasBooleanValue=function(e){return!1===e||!0===e},e.prototype._isTrackPendingTimeout=function(){return this._getProcessingStartTicks()+12e5<Date.now()},e.prototype._getProcessingStartTicks=function(){var e=new Date(this._trackStatus.TrackTimestamp).getTime();return this._mailboxItem.ItemType===n.default[n.default.message]&&this._mailboxItem.DateTimeSent?Math.max(e,this._mailboxItem.DateTimeSent.getTime()):e},e.prototype._shouldBeProcessedWithSSS=function(){if(this._trackStatus.CrmTrackingState!==i.default.WillBeLinked)return!1;var e=this._mailboxItem.ItemType===n.default[n.default.message];return(!e||!this._applicationContext.JsApiProvider.isComposeMode())&&!!(this._trackStatus.TrackTimestamp||e&&this._mailboxItem.DateTimeSent)},e.prototype._createOdataEqualsCriteria=function(e,t){return null!==t&&(t="'"+t+"'"),e+" eq "+t},e.prototype.getActivityItem=function(){var e=this;if(this._activityItem)return Promise.resolve(this._activityItem);var t=this._mailboxItem.ItemType,r=this._mailboxItem.InternetMessageId,o=this._mailboxItem,i=[],a=null;if(t===n.default[n.default.message]&&r?(a="emails",i.push(this._createOdataEqualsCriteria("messageid",r))):t===n.default[n.default.appointment]&&o.GlobalObjectId&&(a=o.IsRecurring?"recurringappointmentmasters":"appointments",i.push(this._createOdataEqualsCriteria("globalobjectid",o.GlobalObjectId))),i.push(this._createOdataEqualsCriteria("_regardingobjectid_value",this._trackStatus.CrmRegardingObjectId||null)),a){var s=a+"?$filter="+i.join(" and ")+"&$select="+["activityid","_regardingobjectid_value"].join(",");return this._applicationContext.CRMProvider.executeOdataQuery(s).then((function(t){return Array.isArray(t)&&t[0]?e._activityItem=t[0]:null}))}return this._applicationContext.EventManager.ReportTraceWarning(""+this._telemetryBaseComponentName,"Can not construct query to request item from CRM"),Promise.resolve(null)},e.prototype._getNotifyUpdateWithTimeout=function(e){var t=this,n=null,r=function(e){if(t._shouldBeProcessedWithSSS()&&!t._isTrackPendingTimeout()){var r=Math.max(12e5-Date.now()+t._getProcessingStartTicks(),1e3);n=s.default.setTimeout((function(){return e(t.getTrackStatus())}),r)}},o=function(){n&&(s.default.clearTimeout(n),n=null)};return this.getTrackStatus().then((function(){return r(e)})),{clearTimeout:o,notifyUpdateWithTimeout:function(t){o(),e(t),t.then((function(){return r(e)}))}}},e}();t.default=l}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.convertRawProperties=function(e,t){var n=[];for(var r in e){var o=t(e[r]);o&&n.push(o)}return n},e}();t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.None=0]="None",e[e.WaitingForDependencies=1]="WaitingForDependencies",e[e.Loading=2]="Loading",e[e.Loaded=3]="Loaded",e[e.Failed=4]="Failed"}(n||(n={})),t.ComponentLoadingState=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(3),n(71),n(1),n(0),n(8)],void 0===(o=function(e,t,n,r,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){this._storageSupport={LocalStorage:null,SessionStorage:null}}return e.prototype.isStorageAccessible=function(e){return void 0===e&&(e=r.default.LocalStorage),this._verifyStorageAvailability(r.default[e])},e.prototype.validateStorage=function(e){return void 0===e&&(e=r.default.LocalStorage),this._verifyStorageAvailability(r.default[e])?null:this._storageSupport[r.default[e]]},e.prototype._verifyStorageAvailability=function(e){if(null!==this._storageSupport[e])return!0===this._storageSupport[e];try{var t=e===r.default[r.default.LocalStorage]?n.default.localStorage():n.default.sessionStorage();t.setItem(a.default.storageValidation,"__storageTest__"),t.removeItem(a.default.storageValidation),this._storageSupport[e]=!0}catch(t){this._storageSupport[e]=o.ComponentError.fromNativeError(i.default.BOOT_MANAGER,o.ErrorCode.STORAGE_UNAVAILABLE,t)}return!0===this._storageSupport[e]},e}();t.StorageAvailability=s,t.default=new s}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(229),n(19)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){this._a=r.default.document().createElement("a"),this._a.href=e,this._searchParams=new n.URLSearchParams(this._a.search),this._searchParams.urlInternal=this}return Object.defineProperty(e.prototype,"searchParams",{get:function(){return this._searchParams},set:function(e){},enumerable:!0,configurable:!0}),e.prototype._updateSearchParams=function(){this._searchParams.updateFromUrlInternal()},e.prototype.toString=function(){return this._a.href},Object.defineProperty(e.prototype,"href",{get:function(){return this._a.href},set:function(e){this._a.href=e,this._updateSearchParams()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"protocol",{get:function(){return this._a.protocol},set:function(e){this._a.protocol=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"host",{get:function(){return this._a.host},set:function(e){this._a.host=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hostname",{get:function(){return this._a.hostname},set:function(e){this._a.hostname=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"port",{get:function(){return this._a.port},set:function(e){this._a.port=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pathname",{get:function(){var e=this._a.pathname;return e[0]&&"/"!==e[0]?"/"+e:e},set:function(e){this._a.pathname=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"search",{get:function(){return this._a.search},set:function(e){this._a.search=e,this._updateSearchParams()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hash",{get:function(){return this._a.hash},set:function(e){this._a.hash=e},enumerable:!0,configurable:!0}),e}();t.CrmURL=o,t.getHostname=function(){var e=r.default.location().href,t=e.indexOf(r.default.location().pathname);return e.substring(0,t)}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(19),n(7)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.generate=function(e,t,n){return e?("http://go.microsoft.com/fwlink/?LinkID=398563&client=MailApp"+this._getDeploymentEnvironmentParams()+this._getCrmErrorLinkParam(e)+this._getServerVersionLinkParam()+this._getCorrelationIdLinkParam(t)+this._getOrganizationIdParam(n)).substring(0,2e3):null},e._getDeploymentEnvironmentParams=function(){var e=n.default.getQueryParams();return"&de="+e.de+"&sde="+e.sde},e._getCrmErrorLinkParam=function(e){return e.code?"&error=Microsoft.Crm.Exception:"+r.default.intToHexString(e.code):""},e._getServerVersionLinkParam=function(){var e=n.default.appVersion();return e?"&cv="+e:""},e._getCorrelationIdLinkParam=function(e){return e?"&cid="+encodeURIComponent(e):""},e._getOrganizationIdParam=function(e){if(e)return"&oid="+encodeURIComponent(e)},e}();t.default=o}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(26)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={NotificationComponent:"notificationComponent",get Collapsed(){return this.NotificationComponent+"-collapsed"},get Label(){return this.NotificationComponent+"_label"},get Text(){return this.NotificationComponent+"_text"}};t.ClassNames=r;var o=function(){function e(e){this.targetSelector="#content",this._isRendered=!1,this._applicationContext=e}return e.prototype.render=function(){if(this._isRendered)throw Error("Previous Notification component should be hidden before next render");var e=n.default.createFragment(this.htmlTemplate);return n.default.prepend(this.targetSelector,e),this._isRendered=!0,this},e}();t.NotificationBase=o}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t,n){void 0===t&&(t=-1),void 0===n&&(n=-1),this.name=e,this.startTime=t,this.stopTime=n};t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Low=0]="Low",e[e.High=1]="High"}(n||(n={})),t.SendPriority=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AWT_REAL_TIME="REAL_TIME",t.AWT_NEAR_REAL_TIME="NEAR_REAL_TIME",t.AWT_BEST_EFFORT="BEST_EFFORT"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),o=n(48),i=n(49),a=n(27),s=n(105),l=n(31),u=n(42),c=n(109),d=n(107),p=n(74),f=n(75),_=function(){function e(e){this._apiKey=e,this._contextProperties=new i.default,this._semanticContext=new p.default(!1,this._contextProperties),this._sessionStartTime=0,this._createInitId()}return e.prototype.setContext=function(e,t,n){void 0===n&&(n=r.AWTPropertyType.Unspecified),this._contextProperties.setProperty(e,t,n)},e.prototype.setContextWithPii=function(e,t,n,o){void 0===o&&(o=r.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithPii(e,t,n,o)},e.prototype.setContextWithCustomerContent=function(e,t,n,o){void 0===o&&(o=r.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithCustomerContent(e,t,n,o)},e.prototype.getSemanticContext=function(){return this._semanticContext},e.prototype.logEvent=function(t){if(c.default.loggingEnabled){this._apiKey||(this._apiKey=c.default.defaultTenantToken,this._createInitId());var n=!0;a.isString(t)?t={name:t}:t instanceof i.default&&(t=t.getEvent(),n=!1),s.default.eventReceived(this._apiKey),e._logEvent(e._getInternalEvent(t,this._apiKey,n),this._contextProperties)}},e.prototype.logSession=function(t,n){if(c.default.sessionEnabled){var i={name:"session",type:"session",properties:{}};if(e._addPropertiesToEvent(i,n),i.priority=r.AWTEventPriority.High,t===o.AWTSessionState.Started){if(this._sessionStartTime>0)return;this._sessionStartTime=(new Date).getTime(),this._sessionId=a.newGuid(),this.setContext("Session.Id",this._sessionId),i.properties["Session.State"]="Started"}else{if(t!==o.AWTSessionState.Ended)return;if(0===this._sessionStartTime)return;var s=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);i.properties["Session.Id"]=this._sessionId,i.properties["Session.State"]="Ended",i.properties["Session.Duration"]=s.toString(),i.properties["Session.DurationBucket"]=e._getSessionDurationFromTime(s),this._sessionStartTime=0,this.setContext("Session.Id",null),this._sessionId=void 0}i.properties["Session.FirstLaunchTime"]=f.default.firstLaunchTime,this.logEvent(i)}},e.prototype.getSessionId=function(){return this._sessionId},e.prototype.logFailure=function(t,n,o,i,a){if(t&&n){var s={name:"failure",type:"failure",properties:{}};e._addPropertiesToEvent(s,a),s.properties["Failure.Signature"]=t,s.properties["Failure.Detail"]=n,o&&(s.properties["Failure.Category"]=o),i&&(s.properties["Failure.Id"]=i),s.priority=r.AWTEventPriority.High,this.logEvent(s)}},e.prototype.logPageView=function(t,n,r,o,i,a){if(t&&n){var s={name:"pageview",type:"pageview",properties:{}};e._addPropertiesToEvent(s,a),s.properties["PageView.Id"]=t,s.properties["PageView.Name"]=n,r&&(s.properties["PageView.Category"]=r),o&&(s.properties["PageView.Uri"]=o),i&&(s.properties["PageView.ReferrerUri"]=i),this.logEvent(s)}},e.prototype._createInitId=function(){!e._initIdMap[this._apiKey]&&this._apiKey&&(e._initIdMap[this._apiKey]=a.newGuid())},e._addPropertiesToEvent=function(e,t){if(t)for(var n in t instanceof i.default&&(t=t.getEvent()),t.name&&(e.name=t.name),t.priority&&(e.priority=t.priority),t.properties)t.properties.hasOwnProperty(n)&&(e.properties[n]=t.properties[n])},e._getSessionDurationFromTime=function(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"},e._logEvent=function(e,t){e.name&&a.isString(e.name)?(e.name=e.name.toLowerCase(),e.name=e.name.replace(a.EventNameDotRegex,"_"),e.type&&a.isString(e.type)?e.type=e.type.toLowerCase():e.type="custom",a.EventNameAndTypeRegex.test(e.name)&&a.EventNameAndTypeRegex.test(e.type)?((!a.isNumber(e.timestamp)||e.timestamp<0)&&(e.timestamp=(new Date).getTime()),e.properties||(e.properties={}),this._addContextIfAbsent(e,t.getPropertyMap()),this._addContextIfAbsent(e,c.default.logManagerContext.getPropertyMap()),this._setDefaultProperty(e,"EventInfo.InitId",this._getInitId(e.apiKey)),this._setDefaultProperty(e,"EventInfo.Sequence",this._getSequenceId(e.apiKey)),this._setDefaultProperty(e,"EventInfo.SdkVersion",d.FullVersionString),this._setDefaultProperty(e,"EventInfo.Name",e.name),this._setDefaultProperty(e,"EventInfo.Time",new Date(e.timestamp).toISOString()),a.isPriority(e.priority)||(e.priority=r.AWTEventPriority.Normal),this._sendEvent(e)):l.default.eventsRejected([e],r.AWTEventsRejectedReason.InvalidEvent)):l.default.eventsRejected([e],r.AWTEventsRejectedReason.InvalidEvent)},e._addContextIfAbsent=function(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e.properties[n]||(e.properties[n]=t[n]))},e._setDefaultProperty=function(e,t,n){e.properties[t]={value:n,pii:r.AWTPiiKind.NotSet,type:r.AWTPropertyType.String}},e._sendEvent=function(e){u.default.sendEvent(e)},e._getInternalEvent=function(e,t,n){if(e.properties=e.properties||{},n)for(var r in e.properties)e.properties.hasOwnProperty(r)&&(e.properties[r]=a.sanitizeProperty(r,e.properties[r]),null===e.properties[r]&&delete e.properties[r]);var o=e;return o.id=a.newGuid(),o.apiKey=t,o},e._getInitId=function(t){return e._initIdMap[t]},e._getSequenceId=function(t){return void 0===e._sequenceIdMap[t]&&(e._sequenceIdMap[t]=0),(++e._sequenceIdMap[t]).toString()},e._sequenceIdMap={},e._initIdMap={},e}();t.default=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(27),o=n(31),i=n(12),a=function(){function e(){}return e.initialize=function(e){var t=this;this._sendStats=e,this._isInitalized=!0,o.default.addNotificationListener({eventsSent:function(e){t._addStat("records_sent_count",e.length,e[0].apiKey)},eventsDropped:function(e,n){switch(n){case i.AWTEventsDroppedReason.NonRetryableStatus:t._addStat("d_send_fail",e.length,e[0].apiKey),t._addStat("records_dropped_count",e.length,e[0].apiKey);break;case i.AWTEventsDroppedReason.QueueFull:t._addStat("d_queue_full",e.length,e[0].apiKey)}},eventsRejected:function(e,n){switch(n){case i.AWTEventsRejectedReason.InvalidEvent:t._addStat("r_inv",e.length,e[0].apiKey);break;case i.AWTEventsRejectedReason.KillSwitch:t._addStat("r_kl",e.length,e[0].apiKey);break;case i.AWTEventsRejectedReason.SizeLimitExceeded:t._addStat("r_size",e.length,e[0].apiKey)}t._addStat("r_count",e.length,e[0].apiKey)},eventsRetrying:null}),setTimeout((function(){return t.flush()}),6e4)},e.teardown=function(){this._isInitalized&&(this.flush(),this._isInitalized=!1)},e.eventReceived=function(t){e._addStat("records_received_count",1,t)},e.flush=function(){var e=this;if(this._isInitalized){for(var t in this._stats)this._stats.hasOwnProperty(t)&&this._sendStats(this._stats[t],t);this._stats={},setTimeout((function(){return e.flush()}),6e4)}},e._addStat=function(e,t,n){if(this._isInitalized&&n!==r.StatsApiKey){var o=r.getTenantId(n);this._stats[o]||(this._stats[o]={}),this._stats[o][e]?this._stats[o][e]=this._stats[o][e]+t:this._stats[o][e]=t}},e._isInitalized=!1,e._stats={},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(244),o=n(12),i=n(31),a=n(27),s=function(){function e(){}return e.getPayloadBlob=function(e,t){var n,s=new r.IO.MemoryStream,l=new r.CompactBinaryProtocolWriter(s);for(var u in l._WriteFieldBegin(r._BondDataType._BT_MAP,3,null),l._WriteMapContainerBegin(t,r._BondDataType._BT_STRING,r._BondDataType._BT_LIST),e)if(e.hasOwnProperty(u)){l._WriteString(u);var c=e[u];l._WriteContainerBegin(1,r._BondDataType._BT_STRUCT),l._WriteFieldBegin(r._BondDataType._BT_STRING,2,null),l._WriteString("act_default_source"),l._WriteFieldBegin(r._BondDataType._BT_STRING,5,null),l._WriteString(a.newGuid()),l._WriteFieldBegin(r._BondDataType._BT_INT64,6,null),l._WriteInt64(a.numberToBondInt64(Date.now())),l._WriteFieldBegin(r._BondDataType._BT_LIST,8,null);var d=s._GetBuffer().length+1;l._WriteContainerBegin(e[u].length,r._BondDataType._BT_STRUCT);for(var p=s._GetBuffer().length-d,f=0;f<c.length;++f){var _=s._GetBuffer().length;if(this.writeEvent(c[f],l),s._GetBuffer().length-_>2936012)i.default.eventsRejected([c[f]],o.AWTEventsRejectedReason.SizeLimitExceeded),c.splice(f--,1),s._GetBuffer().splice(_),this._addNewDataPackageSize(c.length,s,p,d);else if(s._GetBuffer().length>2936012){s._GetBuffer().splice(_),n||(n={}),e[u]=c.splice(0,f),n[u]=c,this._addNewDataPackageSize(e[u].length,s,p,d);break}}l._WriteStructEnd(!1)}return l._WriteStructEnd(!1),{payloadBlob:s._GetBuffer(),remainingRequest:n}},e._addNewDataPackageSize=function(e,t,n,o){for(var i=r._Encoding._Varint_GetBytes(r.Number._ToUInt32(e)),a=0;a<n;++a){if(!(a<i.length)){t._GetBuffer().slice(o+a,n-a);break}t._GetBuffer()[o+a]=i[a]}},e.writeEvent=function(e,t){t._WriteFieldBegin(r._BondDataType._BT_STRING,1,null),t._WriteString(e.id),t._WriteFieldBegin(r._BondDataType._BT_INT64,3,null),t._WriteInt64(a.numberToBondInt64(e.timestamp)),t._WriteFieldBegin(r._BondDataType._BT_STRING,5,null),t._WriteString(e.type),t._WriteFieldBegin(r._BondDataType._BT_STRING,6,null),t._WriteString(e.name);var n={},i=0,s={},l=0,u={},c=0,d={},p=0,f={},_=0,h={},m=0,v={},E=0;for(var g in e.properties){if(e.properties.hasOwnProperty(g))if((y=e.properties[g]).cc>0)v[g]=y,E++;else if(y.pii>0)h[g]=y,m++;else switch(y.type){case o.AWTPropertyType.String:n[g]=y.value,i++;break;case o.AWTPropertyType.Int64:s[g]=y.value,l++;break;case o.AWTPropertyType.Double:u[g]=y.value,c++;break;case o.AWTPropertyType.Boolean:d[g]=y.value,p++;break;case o.AWTPropertyType.Date:f[g]=y.value,_++}}if(i)for(var g in t._WriteFieldBegin(r._BondDataType._BT_MAP,13,null),t._WriteMapContainerBegin(i,r._BondDataType._BT_STRING,r._BondDataType._BT_STRING),n)if(n.hasOwnProperty(g)){var C=n[g];t._WriteString(g),t._WriteString(C.toString())}if(m)for(var g in t._WriteFieldBegin(r._BondDataType._BT_MAP,30,null),t._WriteMapContainerBegin(m,r._BondDataType._BT_STRING,r._BondDataType._BT_STRUCT),h)if(h.hasOwnProperty(g)){var y=h[g];t._WriteString(g),t._WriteFieldBegin(r._BondDataType._BT_INT32,1,null),t._WriteInt32(1),t._WriteFieldBegin(r._BondDataType._BT_INT32,2,null),t._WriteInt32(y.pii),t._WriteFieldBegin(r._BondDataType._BT_STRING,3,null),t._WriteString(y.value.toString()),t._WriteStructEnd(!1)}if(p)for(var g in t._WriteFieldBegin(r._BondDataType._BT_MAP,31,null),t._WriteMapContainerBegin(p,r._BondDataType._BT_STRING,r._BondDataType._BT_BOOL),d)if(d.hasOwnProperty(g)){C=d[g];t._WriteString(g),t._WriteBool(C)}if(_)for(var g in t._WriteFieldBegin(r._BondDataType._BT_MAP,32,null),t._WriteMapContainerBegin(_,r._BondDataType._BT_STRING,r._BondDataType._BT_INT64),f)if(f.hasOwnProperty(g)){C=f[g];t._WriteString(g),t._WriteInt64(a.numberToBondInt64(C))}if(l)for(var g in t._WriteFieldBegin(r._BondDataType._BT_MAP,33,null),t._WriteMapContainerBegin(l,r._BondDataType._BT_STRING,r._BondDataType._BT_INT64),s)if(s.hasOwnProperty(g)){C=s[g];t._WriteString(g),t._WriteInt64(a.numberToBondInt64(C))}if(c)for(var g in t._WriteFieldBegin(r._BondDataType._BT_MAP,34,null),t._WriteMapContainerBegin(c,r._BondDataType._BT_STRING,r._BondDataType._BT_DOUBLE),u)if(u.hasOwnProperty(g)){C=u[g];t._WriteString(g),t._WriteDouble(C)}if(E)for(var g in t._WriteFieldBegin(r._BondDataType._BT_MAP,36,null),t._WriteMapContainerBegin(E,r._BondDataType._BT_STRING,r._BondDataType._BT_STRUCT),v)if(v.hasOwnProperty(g)){y=v[g];t._WriteString(g),t._WriteFieldBegin(r._BondDataType._BT_INT32,1,null),t._WriteInt32(y.cc),t._WriteFieldBegin(r._BondDataType._BT_STRING,2,null),t._WriteString(y.value.toString()),t._WriteStructEnd(!1)}t._WriteStructEnd(!1)},e.base64Encode=function(e){return r._Encoding._Base64_GetString(e)},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Version="1.8.1",t.FullVersionString="AWT-Web-JS-"+t.Version},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),o=n(48),i=n(109),a=n(104),s=n(42),l=n(31),u=n(75),c=function(){function e(){}return e.initialize=function(e,t){if(void 0===t&&(t={}),!this._isInitialized)return this._isInitialized=!0,i.default.defaultTenantToken=e,this._overrideValuesFromConfig(t),this._config.disableCookiesUsage&&!this._config.propertyStorageOverride&&(i.default.sessionEnabled=!1),u.default.addPropertyStorageOverride(this._config.propertyStorageOverride),u.default.autoCollect(i.default.semanticContext,this._config.disableCookiesUsage,this._config.userAgent),s.default.initialize(this._config),i.default.loggingEnabled=!0,this._config.enableAutoUserSession&&(this.getLogger().logSession(o.AWTSessionState.Started),window.addEventListener("beforeunload",this.flushAndTeardown)),this.getLogger()},e.getSemanticContext=function(){return i.default.semanticContext},e.flush=function(e){this._isInitialized&&!this._isDestroyed&&s.default.flush(e)},e.flushAndTeardown=function(){this._isInitialized&&!this._isDestroyed&&(this._config.enableAutoUserSession&&this.getLogger().logSession(o.AWTSessionState.Ended),s.default.flushAndTeardown(),i.default.loggingEnabled=!1,this._isDestroyed=!0)},e.pauseTransmission=function(){this._isInitialized&&!this._isDestroyed&&s.default.pauseTransmission()},e.resumeTransmision=function(){this._isInitialized&&!this._isDestroyed&&s.default.resumeTransmision()},e.setTransmitProfile=function(e){this._isInitialized&&!this._isDestroyed&&s.default.setTransmitProfile(e)},e.loadTransmitProfiles=function(e){this._isInitialized&&!this._isDestroyed&&s.default.loadTransmitProfiles(e)},e.setContext=function(e,t,n){void 0===n&&(n=r.AWTPropertyType.Unspecified),i.default.logManagerContext.setProperty(e,t,n)},e.setContextWithPii=function(e,t,n,o){void 0===o&&(o=r.AWTPropertyType.Unspecified),i.default.logManagerContext.setPropertyWithPii(e,t,n,o)},e.setContextWithCustomerContent=function(e,t,n,o){void 0===o&&(o=r.AWTPropertyType.Unspecified),i.default.logManagerContext.setPropertyWithCustomerContent(e,t,n,o)},e.getLogger=function(e){var t=e;return t&&t!==i.default.defaultTenantToken||(t=""),this._loggers[t]||(this._loggers[t]=new a.default(t)),this._loggers[t]},e.addNotificationListener=function(e){l.default.addNotificationListener(e)},e.removeNotificationListener=function(e){l.default.removeNotificationListener(e)},e._overrideValuesFromConfig=function(e){e.collectorUri&&(this._config.collectorUri=e.collectorUri),e.cacheMemorySizeLimitInNumberOfEvents>0&&(this._config.cacheMemorySizeLimitInNumberOfEvents=e.cacheMemorySizeLimitInNumberOfEvents),e.httpXHROverride&&e.httpXHROverride.sendPOST&&(this._config.httpXHROverride=e.httpXHROverride),e.propertyStorageOverride&&e.propertyStorageOverride.getProperty&&e.propertyStorageOverride.setProperty&&(this._config.propertyStorageOverride=e.propertyStorageOverride),e.userAgent&&(this._config.userAgent=e.userAgent),e.disableCookiesUsage&&(this._config.disableCookiesUsage=e.disableCookiesUsage),e.canSendStatEvent&&(this._config.canSendStatEvent=e.canSendStatEvent),e.enableAutoUserSession&&"undefined"!=typeof window&&window.addEventListener&&(this._config.enableAutoUserSession=e.enableAutoUserSession),e.clockSkewRefreshDurationInMins>0&&(this._config.clockSkewRefreshDurationInMins=e.clockSkewRefreshDurationInMins)},e._loggers={},e._isInitialized=!1,e._isDestroyed=!1,e._config={collectorUri:"https://browser.pipe.aria.microsoft.com/Collector/3.0/",cacheMemorySizeLimitInNumberOfEvents:1e4,disableCookiesUsage:!1,canSendStatEvent:function(e){return!0},clockSkewRefreshDurationInMins:0},e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(49),o=n(74),i=function(){function e(){}return e.logManagerContext=new r.default,e.sessionEnabled=!0,e.loggingEnabled=!1,e.defaultTenantToken="",e.semanticContext=new o.default(!0,e.logManagerContext),e}();t.default=i},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Passed=0]="Passed",e[e.Failed=1]="Failed",e[e.Unknown=2]="Unknown"}(n||(n={})),t.DiagCheckState=n,function(e){e[e.Present=0]="Present",e[e.Missing=1]="Missing",e[e.Unknown=2]="Unknown"}(r||(r={})),t.PrivilegeStatus=r}.apply(t,[n,t]))||(e.exports=r)},,function(e,t,n){var r,o;r=[n,t,n(113),n(226)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.default(r.default())}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(114),n(3),n(7),n(1),n(223),n(225),n(37)],void 0===(o=function(e,t,n,r,o,i,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e){this._client=e}return e.prototype._initialize=function(e){return new n.default(e,this._bcd).boot()},e.prototype.boot=function(){var e=this;this._bcd=new a.default(r.default.getQueryParams());var t=this._client.initialize(this._bcd);this._initialize(t).then((function(){t.EventManager.ReportComponentSuccess("Boot.FullLoad"),e._client.renderUI().then((function(){new s.default(t,e._bcd).checkForAppPinningNotification()}))})).catch((function(e){if(i.ComponentError.isNativeError(e)&&(e=i.ComponentError.fromNativeError("BootGenericError",i.ErrorCode.GENERIC,e)),e.code===i.ErrorCode.CRM_USER_MISSING_PRIVILEGE){var n=o.default.parseMissingPrivilegeFromErrorMessage(e.message);e=l.default.createFromComponentError(e,[n])}t.UIManager.showErrorMessage(e)})),t.AppChecker.initialize()},e}();t.default=function(e){new u(e).boot()}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(115),n(116),n(0),n(15),n(79),n(120),n(132),n(135),n(212),n(214),n(8),n(215),n(216),n(217),n(218),n(219),n(220),n(222)],void 0===(o=function(e,t,n,r,o,i,a,s,l,u,c,d,p,f,_,h,m,v,E,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C=function(){function e(e,t){var n=this;this._loadResourcesAndThrow=function(e){var t=Promise.reject(e);if(!n._applicationContext.ComponentsLoader||!n._applicationContext.ComponentsLoader.isComponentLoaded(o.default.RESOURCE_MANAGER)){var r=n._applicationContext.ResourceManager;return r.boot(null),r.loadingPromise.then((function(){return t}))}return t},this._bcd=t,this._applicationContext=e,this._componentsLoader=new E.ComponentsLoader(this._bcd,this._applicationContext)}return e.prototype._onComponentLoaded=function(e,t){this._progressMessageResId||(this._progressMessageResId="MoCA_OWA_Assets_Loading_Message"),e.name===o.default.AUTHENTICATION_PROVIDER?this._progressMessageResId="MoCA_OWA_Authentication_Loading_Message":("MoCA_OWA_Authentication_Loading_Message"!==this._progressMessageResId||t.find((function(e){return e.name===o.default.AUTHENTICATION_PROVIDER})))&&(e.name===o.default.UNIFIED_CLIENT_LOADER?this._progressMessageResId="MoCA_OWA_Client_Assets_Loading_Message":"MoCA_OWA_Client_Assets_Loading_Message"===this._progressMessageResId&&t.find((function(e){return e.name===o.default.UNIFIED_CLIENT_LOADER}))),this._applicationContext.UIManager.showProgressMsg(this._progressMessageResId)},e.prototype.boot=function(){this._componentsLoader.addOnComponentLoaded(this._onComponentLoaded.bind(this)),this._componentsLoader.addDefinition({bootable:f.default(),name:o.default.STORAGE_VALIDATOR,dependsOnComponents:[]}),this._componentsLoader.addDefinition({bootable:v.default(),name:o.default.VALIDATE_OFFICEJS,dependsOnComponents:[o.default.STORAGE_VALIDATOR]}),this._componentsLoader.addDefinition({bootable:d.default(),name:o.default.JS_API_PROVIDER,dependsOnComponents:[o.default.VALIDATE_OFFICEJS]}),this._componentsLoader.addDefinition({bootable:a.bootableResourceManager(),name:o.default.RESOURCE_MANAGER,dependsOnComponents:[]}),this._componentsLoader.addDefinition({bootable:_.default(),name:o.default.COMPATIBILITY_CHECK,dependsOnComponents:[o.default.JS_API_PROVIDER]}),this._componentsLoader.addDefinition({bootable:n.default(),name:o.default.AUTHENTICATION_PROVIDER,dependsOnComponents:[o.default.JS_API_PROVIDER]}),this._componentsLoader.addDefinition({bootable:s.default(),name:o.default.CRM_PROVIDER,dependsOnComponents:[o.default.JS_API_PROVIDER,o.default.AUTHENTICATION_PROVIDER]}),this._componentsLoader.addDefinition({bootable:c.default(),name:o.default.EXCHANGE_PROVIDER,dependsOnComponents:[o.default.CRM_PROVIDER]}),this._componentsLoader.addDefinition({bootable:u.default(),name:o.default.DISPATCHER_COLLECTION,dependsOnComponents:[o.default.JS_API_PROVIDER]}),this._componentsLoader.addDefinition({bootable:h.default(),name:o.default.VALIDATE_USER,dependsOnComponents:[o.default.CRM_PROVIDER,o.default.AUTHENTICATION_PROVIDER]}),this._componentsLoader.addDefinition({bootable:m.default(),name:o.default.DELEGATE_VALIDATOR,dependsOnComponents:[o.default.CRM_PROVIDER,o.default.JS_API_PROVIDER]});var e=this._applicationContext.Storage.getItem(p.default.appModuleIdsCache);return this._componentsLoader.addDefinition({bootable:l.default(),name:o.default.UNIFIED_CLIENT_LOADER,dependsOnComponents:this._bcd.mode!==i.default.Module&&e?[]:[o.default.CRM_PROVIDER,o.default.AUTHENTICATION_PROVIDER]}),this._componentsLoader.addDefinition({bootable:r.default(),name:o.default.WEB_SCRIPT_BRIDGE,dependsOnComponents:[o.default.UNIFIED_CLIENT_LOADER,o.default.DISPATCHER_COLLECTION]}),this._componentsLoader.addDefinition({bootable:g.default(),name:o.default.LOAD_TIMEOUT,dependsOnComponents:[o.default.UNIFIED_CLIENT_LOADER,o.default.DISPATCHER_COLLECTION,o.default.AUTHENTICATION_PROVIDER]}),this._applicationContext.ComponentsLoader=this._componentsLoader,this._componentsLoader.load(),this._componentsLoader.loadingPromise.catch(this._loadResourcesAndThrow)},e}();t.default=C}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this._token="",this._expiryDate=new Date(Date.now()+864e5)}return e.prototype.getToken=function(){return this._token},e.prototype.authenticate=function(e){return Promise.resolve(this._token)},e.prototype.authenticateClient=function(e){return Promise.resolve("<RequestOAuthSecurityTokenResponse><AccessToken>"+this._token+"</AccessToken><EncodedAccessToken>"+this._token+"</EncodedAccessToken><ExpiresOn>"+this._expiryDate.getTime()+"</ExpiresOn></RequestOAuthSecurityTokenResponse>")},e}();t.default=function(){return function(e,t){t.AuthenticationProvider=new n(e,t)}}}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(117),n(119),n(0),n(7),n(1),n(4)],void 0===(o=function(e,t,n,r,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=o.default.WEB_SCRIPT_BRIDGE+".CallMethodWithKey",u=function(){function e(e,t){this._conversationKey=i.default.generateKey(),this._applicationContext=t}return e.prototype.unload=function(){for(var e in this._applicationContext.DispatcherCollection){var t=this._applicationContext.DispatcherCollection[e];t&&t.unload()}this._inputHandler.unload()},e.prototype.callMethodWithKey=function(e,t,n,r,o,i){var u=this._applicationContext.DispatcherCollection[t],c=[{name:s.EventParameterName.Data,value:t}];if(!u)return this._applicationContext.EventManager.ReportComponentFailure(new a.ComponentError(l,"Unknown dispatcher namespace",a.ErrorCode.GENERIC),c);if(e!==this._conversationKey){var d={key:this._conversationKey,callKey:e};return c.push({name:s.EventParameterName.Data,value:d}),this._applicationContext.EventManager.ReportComponentFailure(new a.ComponentError(l,"Attemptng to call native method with invalid key. Possible XSS?",a.ErrorCode.GENERIC),c)}u.callMethodWithName(n,{version:r,args:o,callbacks:i})},e.prototype.performCallbackWithId=function(e,t,n,r){void 0===r&&(r=!1),this._outputHandler.deviceCallbackWithId(e,t,n,r)},e.prototype.unregisterCallbackWithId=function(e){this._outputHandler.deviceUnregisterCallbackWithId(e)},e.prototype.changeStateForDispatcher=function(e,t,n,r){void 0===r&&(r=!1),this._outputHandler.deviceEventWithNamespace(e,t,n,r)},e.prototype._getDispatcherStatesAndRegisterMethods=function(){var e=this,t={};return Object.keys(this._applicationContext.DispatcherCollection).forEach((function(n){var r=e._applicationContext.DispatcherCollection[n];if(r){r.registerMethods();var o=r.getInitialState();t[r.getNamespace()]=o}})),t},e.prototype.deviceEventWithNamespace=function(e,t,n){this._outputHandler.deviceEventWithNamespace(e,t,n)},e.prototype.load=function(){this._inputHandler=new n.default(this._bcd,this._applicationContext),this._outputHandler=new r.default(this._bcd,this._applicationContext),this._states=this._getDispatcherStatesAndRegisterMethods(),this._outputHandler.deviceReadyWithKey(this._conversationKey,this._states)},e}();t.WebScriptBridge=u,t.default=function(){return function(e,t){var n=new u(e,t);return t.Bridge=n,n.load()}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(0),n(4),n(1),n(3),n(6)],void 0===(o=function(e,t,n,r,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n.default.WEB_SCRIPT_BRIDGE+".InputHandler",l=function(){function e(e,t){this._bcd=e,this._applicationContext=t,this._boundMessageHandler=this._messageHandler.bind(this),i.default.addEventListener("message",this._boundMessageHandler,!1)}return e.prototype._messageHandler=function(e){var t=i.default.location().protocol+"//"+i.default.location().host;if(e.data&&(e.origin===t||e.origin+"/"===t)){var n=this._getQueryParameters(e.data);if(n){var l=n.k&&decodeURIComponent(n.k),u=n.n&&decodeURIComponent(n.n),c=n.m&&decodeURIComponent(n.m),d=n.v&&decodeURIComponent(n.v),p=n.t&&decodeURIComponent(n.t),f=n.a&&decodeURIComponent(n.a),_=n.c&&decodeURIComponent(n.c),h=p?parseInt(p,10):null,m=null,v=null;try{m=JSON.parse(f),v=JSON.parse(_)}catch(t){var E=[{name:r.ErrorEventParameterName.Error,value:t.message},{name:r.ErrorEventParameterName.ErrorCode,value:o.ErrorCode.JSON_PARSE_FAILURE},{name:r.EventParameterName.Data,value:e.data}];return void this._applicationContext.EventManager.ReportComponentFailure(new o.ComponentError(s,"Failed to parse JSON of arguments received from the client",o.ErrorCode.GENERIC),E)}if(l&&u&&c&&m&&d&&v){h&&!isNaN(h)&&this._applicationContext.Performance.addRetroactiveStopwatch("PostMessage."+u+"."+c,h,Date.now()),u===a.default.EXTERNAL_CONTEXT||u===a.default.CONTACTS_MODULE&&"SendTelemetryEvents"===c||this._applicationContext.EventManager.ReportTraceInfo(s+".CallMethod",u+"."+c),this._applicationContext.Bridge.callMethodWithKey(l,u,c,d,m,v)}else{var g={key:l,nameSpace:u,method:c,version:d,callbacks:v};this._applicationContext.EventManager.ReportComponentFailure(new o.ComponentError(s,"Invalid arguments received from the client",o.ErrorCode.GENERIC),[{name:r.EventParameterName.Data,value:g}])}}}},e.prototype._getQueryParameters=function(e){void 0===e&&(e="");var t=e.indexOf("?");if(-1===t)return null;for(var n={},r=e.slice(t+1).split("&"),o=0,i=r.length;o<i;o++){var a=r[o],s=a.indexOf("=",0);n[a.substring(0,s)]=a.substring(s+1)}return n},e.prototype.unload=function(){i.default.removeEventListener("message",this._boundMessageHandler),this._boundMessageHandler=null},e}();t.default=l}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Pending=0]="Pending",e[e.Resolved=1]="Resolved",e[e.Rejected=2]="Rejected"}(n||(n={})),t.DeferredPromiseState=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(0),n(61),n(3),n(1),n(6)],void 0===(o=function(e,t,n,r,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n.default.WEB_SCRIPT_BRIDGE+".OutputHandler",l=function(){function e(e,t){this._bcd=e,this._applicationContext=t}return e.prototype.deviceReadyWithKey=function(e,t){this._callNativeBridgeFunction("deviceReady",{nativeArguments:[e,JSON.stringify(t)]}),this._reportTelemetry("DeviceReadyWithKey","Shim ready with key")},e.prototype.deviceCallbackWithId=function(e,t,n,r){this._callNativeBridgeFunction("deviceCallback",{nativeArguments:[e,JSON.stringify(t),n]}),r||this._reportTelemetry("DeviceCallback","CallbackId: "+e+" ("+n+")")},e.prototype.deviceUnregisterCallbackWithId=function(e){this._callNativeBridgeFunction("deviceUnregisterCallback",{nativeArguments:[e]}),this._reportTelemetry("DeviceUnregisterCallback","CallbackId: "+e)},e.prototype.deviceEventWithNamespace=function(e,t,n,r){var o=this,i=this._applicationContext.DispatcherCollection[a.default.APPLICATION];if(i.isClientInitialized)return this._deviceEventWithNamespaceInternal(e,t,n,r);i.clientInitialized.then((function(){o._deviceEventWithNamespaceInternal(e,t,n,r)})).catch((function(){}))},e.prototype._deviceEventWithNamespaceInternal=function(e,t,n,r){this._callNativeBridgeFunction("deviceEvent",{nativeArguments:[e,t,JSON.stringify([n])]}),r||this._reportTelemetry("DeviceEvent",e+"."+t)},e.prototype._callNativeBridgeFunction=function(e,t){var n={target:"PALNativeBridge",functionName:e,functionArguments:t&&t.nativeArguments,timestamp:Date.now()},a=JSON.stringify(n),l=o.default.document().getElementById(r.IFRAME_ID);l&&l.contentWindow?l.contentWindow.postMessage(a,this._applicationContext.OrgUrl):this._applicationContext.EventManager.ReportComponentFailure(new i.ComponentError(s,"Attempting to communicate with non-existent iframe",i.ErrorCode.GENERIC))},e.prototype._reportTelemetry=function(e,t){void 0===t&&(t=""),this._applicationContext.EventManager.ReportTraceInfo(s+"."+e,t)},e}();t.default=l}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};r=[n,t,n(0),n(80),n(38),n(15),n(82),n(1),n(37),n(4),n(3),n(9),n(28),n(6),n(8),n(122),n(84),n(125),n(129),n(130),n(131),n(62),n(7)],void 0===(o=function(e,t,n,r,o,s,l,u,c,d,p,f,_,h,m,v,E,g,C,y,I,T,A){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var P=function(){function e(e,t){this._bcd=e,this._applicationContext=t,this._emailAddressesResolver=new g.default(this._bcd,this._applicationContext),this._crmHttpRequest=new E.default(this._bcd,t),this._mailAppDataService=new I.default(e,t),this._scheduleBackgroundDataRefresh()}return e.prototype.getAppId=function(){var e=this,t=this._createOdataEqualsCriteria("uniquename",f.MailAppModuleUniqueName),n=this._getOdataUri()+"/appmodules?$filter="+t+"&$select=uniquename,appmoduleid";return this._crmHttpRequest.send(r.default.GET_APP_ID,{method:"GET",url:n}).then((function(t){var n=t&&t.value?t.value[0]:null;if(n&&n.appmoduleid){var o=n.appmoduleid;return e._applicationContext.Storage.setItem(m.default.appModuleIdsCache,o),o}var i=new u.ComponentError(r.default.GET_APP_ID,"Don't have permissions to retrieve AppforOutlookModule id",u.ErrorCode.CRM_APP_MODULE_PERMISSION);return e._applicationContext.EventManager.ReportComponentFailure(i,[{name:d.ErrorEventParameterName.Error,value:t}]),Promise.reject(i)}))},e.prototype.isLimitedMode=function(){var e=this;return this.isFeatureControlBitEnabled(f.FcbNames.MailAppLimitedMode).then((function(t){return t&&e.getUserValidation()})).then((function(){return!1})).catch(l.isAllowedForLimitedMode)},e.prototype.getOrgSettings=function(){var e=this._applicationContext.Storage.getItem(m.default.orgSettingsCache);return e?Promise.resolve(e):(this._orgSettingsPromise||(this._orgSettingsPromise=this._getOrgSettingsFromServer()),this._orgSettingsPromise)},e.prototype._getOrgSettingsFromServer=function(){return i(this,void 0,void 0,(function(){var e,t,n=this;return a(this,(function(o){switch(o.label){case 0:return[4,this._getOrganizationId()];case 1:return e=o.sent(),t=this._getOdataUri()+"/organizations("+e+")?$select=orgdborgsettings",[2,this._crmHttpRequest.send(r.default.ORG_SETTINGS,{method:"GET",url:t}).then((function(e){try{var t=y.parse(e);return n._applicationContext.Storage.setItem(m.default.orgSettingsCache,t),t}catch(e){var o=new u.ComponentError(r.default.ORG_SETTINGS,"Failed to parse orgdborgsettings",u.ErrorCode.GENERIC,e);throw n._applicationContext.EventManager.ReportTraceError(o),o}})).catch((function(e){var t;return(null===(t=e)||void 0===t?void 0:t.code)===u.ErrorCode.CRM_USER_MISSING_PRIVILEGE&&n._showMissingReadPrivilegeNotification(e),{}}))]}}))}))},e.prototype._showMissingReadPrivilegeNotification=function(e){var t=this,o=A.default.parseMissingPrivilegeFromErrorMessage(e.message);A.default.isRequiredReadPrivilegeForEntity(f.CrmTypeNames.Organization,o)&&(this._applicationContext.EventManager.ReportTraceError(new u.ComponentError(r.default.ORG_SETTINGS,"Failed to retrieve orgSettings from the server due to missing privilege "+o,e.code,e)),this._applicationContext.ComponentsLoader.ensureComponentLoaded(n.default.RESOURCE_MANAGER).then((function(){t._applicationContext.UIManager.showNotification(c.default.createFromComponentError(e,[o]))})))},e.prototype.getCurrentUserMailboxId=function(){var e=this;return this.whoAmI().then((function(t){return e._getSystemUserRecord(t.UserId).then((function(e){return e.MailboxId}))}))},e.prototype.getCurrentUserEmailAddress=function(){var e=this;return this.whoAmI().then((function(t){return e._getSystemUserRecord(t.UserId).then((function(e){return e.EmailAddress}))}))},e.prototype._getOrganizationId=function(){return i(this,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.whoAmI()];case 1:return(e=t.sent()).OrganizationId!==this._bcd.orgId&&this._applicationContext.EventManager.ReportTraceWarning(r.default.WHO_AM_I,"Org ID from manifest is not equal org ID from whoAmI request",{whoAmIOrgId:e.OrganizationId,manifestOrgId:this._bcd.orgId}),[2,e.OrganizationId];case 2:return t.sent(),this._applicationContext.EventManager.ReportTraceWarning(r.default.WHO_AM_I,"Couldn't get org ID from whoAmI request, fallback to org ID from manifest"),[2,this._bcd.orgId];case 3:return[2]}}))}))},e.prototype.getMailboxTrackingCategoryName=function(){var e=this._applicationContext.Storage.getItem(m.default.categoryNamesCache);return e?Promise.resolve(e):(this._getMailboxTrackingCategoryNamePromise||(this._getMailboxTrackingCategoryNamePromise=this._getMailboxTrackingCategoryFromServer()),this._getMailboxTrackingCategoryNamePromise)},e.prototype.isCategoryTrackingEnabled=function(){var e=this;return this._isCategoryTrackingEnabledPrmise||(this._isCategoryTrackingEnabledPrmise=this._isOrgSettingEnabledWithoutDefaultValue(_.TrackCategorizedItems).then((function(t){var n=e.isFeatureControlBitEnabled(f.FcbNames.TrackUsingCategoriesDefaultValue);return void 0===t?n:t})).then((function(t){return!!t&&e.getMailboxTrackingCategoryName().then((function(e){return!!e}))})),this._isCategoryTrackingEnabledPrmise.then((function(t){e._applicationContext.EventManager.ReportTraceWarning(r.default.CATEGORIES,"Category tracking feature state: '"+(t?"Enabled":"Disabled")+"'")}))),this._isCategoryTrackingEnabledPrmise},e.prototype._getMailboxTrackingCategoryFromServer=function(){var e=this;return this.getCurrentUserMailboxId().then((function(t){var n=e._createOdataEqualsCriteria("exchangecategoryid","2D5D7F9E-44A2-4629-B7E6-2533DB0AAE02"),o=e._createOdataEqualsCriteria("_mailboxid_value",t),i=e._getOdataUri()+"/mailboxtrackingcategories?$filter="+n+" and "+o+"&$select=exchangecategoryname";return e._crmHttpRequest.send(r.default.CATEGORIES,{method:"GET",url:i}).then((function(t){var n=t&&t.value?t.value[0]:null;if(n&&n.exchangecategoryname){e._applicationContext.EventManager.ReportTraceInfo(r.default.CATEGORIES,"Retrieved category successfully",n);var o=n.exchangecategoryname;return e._applicationContext.Storage.setItem(m.default.categoryNamesCache,o),o}e._applicationContext.EventManager.ReportTraceWarning(r.default.CATEGORIES,"Unable to retrieve category name",[{name:d.ErrorEventParameterName.Error,value:t}])})).catch((function(t){return e._applicationContext.EventManager.ReportTraceError(new u.ComponentError(r.default.SYSTEM_USER,"Exception happened while trying to retrieve mailbox tracking category",u.ErrorCode.GENERIC),[{name:d.ErrorEventParameterName.Error,value:t}]),null}))}))},e.prototype._isOrgSettingEnabledWithoutDefaultValue=function(e){return this.getOrgSettings().then((function(t){if(t&&void 0!==t[e.name])return t[e.name]}))},e.prototype._fulfillFcbValues=function(e,t){void 0===t&&(t={});var n=Object.assign({},t);return e.forEach((function(e){null!==n[e]&&void 0!==n[e]||(n[e]=!1)})),n},e.prototype.getFeatureControlBits=function(){var e=this,t=f.FcbNames,n=Object.keys(t).map((function(e){return t[e]})),r={fcbNames:n};return this._mailAppDataService.getMailAppData(I.MailAppDataServiceName.IS_FEATURES_ENABLED,r).then((function(t){return e._fulfillFcbValues(n,t)})).catch((function(){return e._fulfillFcbValues(n)}))},e.prototype.isFeatureControlBitEnabled=function(e){return this.getFeatureControlBits().then((function(t){return t[e]}))},e.prototype.isOrgSettingEnabled=function(e){return this.getOrgSettings().then((function(t){return t&&void 0!==t[e.name]?t[e.name]:e.defaultValue}))},e.prototype.isOrgSettingsEnabled=function(e){var t=this,n=e.map((function(e){return t.isOrgSettingEnabled(e)}));return Promise.all(n).then((function(t){return t.reduce((function(t,n,r){return t[e[r].name]=n,t}),{})}))},e.prototype._scheduleBackgroundDataRefresh=function(){var e=this;Date.now();this._applicationContext.ComponentsLoader.ensureComponentLoaded(n.default.DISPATCHER_COLLECTION).then((function(){e._applicationContext.DispatcherCollection[h.default.APPLICATION].clientInitialized.then((function(){p.default.setTimeout((function(){return e.getUserValidation(!0).catch((function(){}))}),1e4),e._bcd.mode!==s.default.Module&&p.default.setTimeout((function(){return e._getMailboxTrackingCategoryFromServer().catch((function(){}))}),11e3)})).catch((function(){}))}))},e.prototype.getUserValidation=function(e){var t=this;void 0===e&&(e=!1);var n={messageType:this._applicationContext.JsApiProvider.getMailboxItemType()};return this._mailAppDataService.getMailAppData(I.MailAppDataServiceName.GET_USER_VALIDATION,n,(function(e){return C.processResponse(e,t._applicationContext.JsApiProvider.getUserEmailAddress().toLowerCase(),r.default.GET_USER_VALIDATION)}),e).catch((function(e){var n,o;return(null===(o=null===(n=e)||void 0===n?void 0:n.innerError)||void 0===o?void 0:o.code)!==T.default.Unknown?Promise.reject(e):t.whoAmI(!0).then((function(){return Promise.reject(e)})).catch((function(e){return Promise.reject(new u.ComponentError(r.default.GET_USER_VALIDATION,e.message,e.code,e.innerError))}))}))},e.prototype.resolveRecipients=function(){return this._emailAddressesResolver.resolveRecipients()},e.prototype.forceResolveRecipient=function(e){return this._emailAddressesResolver.resolveCachedIfNotResolved(e)},e.prototype.whoAmI=function(e){var t=this;if(void 0===e&&(e=!1),!e){var n=this._applicationContext.Storage.getItem(m.default.whoAmICache);if(n)return Promise.resolve(n)}if(!this._whoAmIPromise){var o=this._getOdataUri()+"/WhoAmI()";this._whoAmIPromise=this._crmHttpRequest.send(r.default.WHO_AM_I,{method:"GET",url:o}).then((function(e){return t._applicationContext.Storage.setItem(m.default.whoAmICache,e),e}))}return this._whoAmIPromise},e.prototype.sendOdataBatchRequest=function(e,t){var n=this._applicationContext.EventManager.getSessionId(),o=v.default(this._getBaseUri(),[e+"?fetchXml="+encodeURIComponent(t)],n,this._getODataEndpointPrefix());return this._crmHttpRequest.send(r.default.ODATA_BATCH_REQUEST+"."+e,o)},e.prototype.sendOdataMultiqueryBatchRequest=function(e,t){var n=this._applicationContext.EventManager.getSessionId(),o=v.default(this._getBaseUri(),t,n,this._getODataEndpointPrefix());return this._crmHttpRequest.send(r.default.ODATA_BATCH_REQUEST+"."+e,o)},e.prototype.checkEntitiesReadPrivilege=function(e){void 0===e&&(e=!1);var t={typeNames:f.CheckEntitiesReadPrivilegeTypeNames};return this._mailAppDataService.getMailAppData(I.MailAppDataServiceName.CHECK_READ_PRIVILEGE,t,null,e)},e.prototype.executeOdataQuery=function(e){var t=this._getOdataUri()+"/"+e;return this._applicationContext.EventManager.ReportTraceInfo(r.default.EXECUTE_ODATA_QUERY,"Executing ODATA query",e),this._crmHttpRequest.send(r.default.EXECUTE_ODATA_QUERY,{url:t}).then((function(e){return e?e.value:null}))},e.prototype._getSystemUserRecord=function(e){var t=this,n=this._applicationContext.Storage.getItem(m.default.systemUsersCache,e);if(n)return Promise.resolve(n);var o=this._getOdataUri()+"/systemusers("+e+")?$select=_defaultmailbox_value,modifiedon,internalemailaddress";return this._crmHttpRequest.send(r.default.SYSTEM_USER,{url:o}).then((function(n){var o={MailboxId:n._defaultmailbox_value,ModifiedOn:n.modifiedon,EmailAddress:n.internalemailaddress};return t._applicationContext.Storage.setItem(m.default.systemUsersCache,o,null,e),o.MailboxId!==t._bcd.mailboxId&&t._applicationContext.EventManager.ReportTraceWarning(r.default.SYSTEM_USER,"Mailbox id in query params is outdated",o.MailboxId),o})).catch((function(e){throw t._applicationContext.EventManager.ReportTraceError(new u.ComponentError(r.default.SYSTEM_USER,"Exception happened while trying to retrieve system users data.",u.ErrorCode.GENERIC),[{name:d.ErrorEventParameterName.Error,value:e}]),e}))},e.prototype._getOdataUri=function(){return this._getBaseUri()+"/api/data/v9.0"},e.prototype._getBaseUri=function(){return this._applicationContext.OrgUrl+this._getODataEndpointPrefix()},e.prototype._getODataEndpointPrefix=function(){return this._bcd.crmDeploymentEnvironment===o.default.Online?"":"/"+this._bcd.orgName},e.prototype._createOdataEqualsCriteria=function(e,t){return e+" eq '"+t+"'"},e}();t.CRMProvider=P,t.default=function(){return function(e,t){if(e.crmDeploymentEnvironment===o.default.OnPremise&&!e.orgName){var i=n.default.CRM_PROVIDER+".CheckOrgName";throw new u.ComponentError(i,"Org name not available for OnPrem deployment",u.ErrorCode.GENERIC)}t.CRMProvider=new P(e,t),p.default.setTimeout((function(){t.CRMProvider.getFeatureControlBits().then((function(e){t.EventManager.ReportTraceInfo(r.default.IS_FEATURES_ENABLED,"Feature Control Bit values",e)})).catch((function(){})),e.mode!==s.default.Module&&t.CRMProvider.getOrgSettings().then((function(e){t.EventManager.ReportTraceInfo(r.default.ORG_SETTINGS,"Org Settings values",e)})).catch((function(){}))}),0)}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.GET_APP_ID="GetAppId",e.WHO_AM_I="WhoAmI",e.ORG_SETTINGS="OrganizationSettings",e.SYSTEM_USER="SystemUser",e.ODATA_QUERY="executeOdataQuery",e.ODATA_BATCH_REQUEST="OdataBatchRequest",e.TRACKING_CATEGORIES="CategoriesTracking",e}();t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(83)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,r,o){void 0===o&&(o="");var i="batch_"+(new Date).getTime(),a=t.reduce((function(e,t){return e+=function(e,t,n,r,o){var i="";i+="--"+o+"\n",i+="Content-Type: application/http\nContent-Transfer-Encoding: binary\n",i+="\n";var a={Prefer:'odata.include-annotations="*"',Accept:"application/json"};return r&&(a["Client-Session-Id"]=r,a["Client-Activity-Id"]=r),i+=function(e,t,n,r){var o="GET "+t+"/api/data/v9.0/"+n+" HTTP/1.1\n";for(var i in r)o+=i+": "+r[i]+"\n";return o}(0,t,n,a),i+="\n"}(0,o,t,r,i)}),""),s="--"+i+"--\r\n\0";return a.endsWith(s+"\n")?a=a.substr(0,a.length-1):a+=s,{url:e+"/api/data/v9.0/$batch",headers:[new n.default.KeyValue("Content-Type","multipart/mixed;boundary="+i)],content:a,method:"POST",isBatch:!0,batchQueriesCount:t.length}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(124)],void 0===(o=function(e,t,n){"use strict";function r(e,t){var n=t.indexOf(":");if(n>=0){var r=t.substring(0,n),o=t.substring(n+1).trim();e[r]=o}return e}function o(e){var t=-1!==e.indexOf("\r\n\r\n"),o=e.trim().split(t?"\r\n\r\n":"\n\n"),i=o[1].split(t?"\r\n":"\n"),a=i.slice(1),s=/(HTTP\/\d\.\d) (\d+) (.*)/gi.exec(i[0]),l=Number(s[2]),u=new n.FetchLikeHeaders(a.reduce(r,{})),c=o[2];return{status:l,ok:200<=l&&299>=l,statusText:s[3],headers:u,json:function(){return c?JSON.parse(c):null},text:function(){return c}}}function i(e){for(var t=[],n=0,r=function(e,t){var n="--"+e+"\r\n";0===t.indexOf(n)||(n="--"+e+"\n");var r=t.split(n);r.splice(0,1);var o=r[r.length-1],i=o.indexOf("--"+e);return r[r.length-1]=o.substring(0,i),r}(e.header("Content-Type").split("; ").pop().split("=").pop(),e.data());n<r.length;n++){var i=o(r[n]);t.push(i)}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.parseBatchResponse=i,t.default=i}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this._headers=e}return e.prototype.append=function(e,t){this._headers[e]=t},e.prototype.get=function(e){return this._headers[e]},e.prototype.has=function(e){return this._headers.hasOwnProperty(e)},e}();t.FetchLikeHeaders=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(0),n(25),n(126),n(9),n(127),n(128),n(39),n(1),n(7),n(37)],void 0===(o=function(e,t,n,r,o,i,a,s,l,u,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p="_parentobjectid_value@Microsoft.Dynamics.CRM.lookuplogicalname",f=n.default.CRM_PROVIDER+".ResolveEmailAddresses",_=function(){function e(e,t){this._bcd=e,this._applicationContext=t,this._recipientsCache=new o.default,this._recipientsRetriever=new s.default(e,t),this._pendingExecutions={}}return e.prototype.getRecipients=function(){return this._recipientsCollection},e.prototype._wrapWithValue=function(e){return e.reduce((function(e,t){return e+"\r\n<value>"+t+"</value>"}),"")},e.prototype._createParentJoinCondition=function(e){return'<link-entity name="'+e+'" to="parentobjectid" from="'+e+'id" link-type="outer" alias="'+e+'alias">\n\t\t\t\t\t<attribute name="'+i.CrmTypeNamesToNameFieldName[e]+'" />\n\t\t\t\t\t<attribute name="entityimage" />\n\t\t\t\t\t'+this._getEntitySpecificAttributes(e)+'\n\t\t\t\t\t<order attribute="createdon" descending="true" />\n\t\t\t\t</link-entity>'},e.prototype._getEntitySpecificAttributes=function(e){return e===i.CrmTypeNames.User?'<attribute name="'+i.PropertyNames.IsDisabled+'" />':'<attribute name="'+i.PropertyNames.OwnerId+'" />\n\t\t\t\t<attribute name="'+i.PropertyNames.StatusCode+'" />'},e.prototype._createFetchXml=function(e,t,n){return'<fetch version="1.0" output-format="xml-platform" mapping="logical" returntotalrecordcount="true" page="1" count="100" no-lock="true">\n\t\t\t<entity name="emailsearch">\n\t\t\t<attribute name="parentobjectid"/>\n\t\t\t<attribute name="emailaddress"/>\n\t\t\t<attribute name="parentobjecttypecode"/>\n\t\t\t<filter type="and">\n\t\t\t\t<condition attribute="emailaddress" operator="in">\n\t\t\t\t\t'+e+'\n\t\t\t\t</condition>\n\t\t\t\t<condition attribute="parentobjecttypecode" operator="in">\n\t\t\t\t\t'+t+"\n\t\t\t\t</condition>\n\t\t\t</filter>\n\t\t\t"+n+"\n\t\t\t</entity>\n\t\t</fetch>"},e.prototype._executeResolveRecipients=function(e,t){var n=this;return void 0===t&&(t=!1),Promise.all([this._applicationContext.CRMProvider.getFeatureControlBits(),this._applicationContext.CRMProvider.checkEntitiesReadPrivilege(t)]).then((function(r){var o=r[0],a=r[1];if(0===(e=e.filter(n._recipientsCache.isRecordExpired.bind(n._recipientsCache))).length)return Promise.resolve();var s=i.CheckEntitiesReadPrivilegeTypeNames.filter((function(e){return a[e]&&n._isFcbEnabledForRecipientsToBeResolvedAsEntity(o,e)}));if(s&&0!==s.length){var c=e.map((function(e){return l.escapeXml(e)})),d=s.map((function(e){return i.CrmTypeNamesToCodes[e]})),p=n._createFetchXml(n._wrapWithValue(c),n._wrapWithValue(d),n._createParentJoinConditionForEntitiesToResolve(s));return n._applicationContext.CRMProvider.sendOdataBatchRequest("emailsearches",p).then((function(t){var r=t&&t.value||[],o=e.concat([]);r.forEach((function(e){var t=n._webApiEntityToRecipientRecord(e),r=t.dataValues[i.PropertyNames.Email].toLowerCase();o=o.filter((function(e){return e.toLowerCase()!==r})),n._addResolvedToCache(t)})),o.forEach(n._recipientsCache.addUnresolved.bind(n._recipientsCache))})).catch((function(r){if(r.code===u.ErrorCode.CRM_USER_MISSING_PRIVILEGE)return n._handleMissingPrivilegeError(r,s,e,t);throw r}))}e.forEach(n._recipientsCache.addUnresolved.bind(n._recipientsCache))}))},e.prototype._handleMissingPrivilegeError=function(e,t,r,o){var a=this,s=c.default.parseMissingPrivilegeFromErrorMessage(e.message);if(c.default.isRequiredReadPrivilegeForEntity(i.CrmTypeNames.Role,s))return this._applicationContext.EventManager.ReportTraceError(new u.default(f+".Fail","Failed to resolve recipients due to missing privilege "+s,e.code,e)),this._applicationContext.ComponentsLoader.ensureComponentLoaded(n.default.RESOURCE_MANAGER).then((function(){a._notification&&a._notification.close(),a._notification=a._applicationContext.UIManager.showNotification(d.default.createFromComponentError(e,[s]))})),void r.forEach((function(e){return a._recipientsCache.addUnresolved(e)}));if(!o&&c.default.isRequiredReadPrivilegeForEntities(t,s))return this._applicationContext.EventManager.ReportTraceInfo(f+".Retry","Retry resolving Email Addresses: missing privilege "+s),this._executeResolveRecipients(r,!0);throw e},e.prototype._isFcbEnabledForRecipientsToBeResolvedAsEntity=function(e,t){return t===i.CrmTypeNames.Account?e[i.FcbNames.MailAppResolveRecipientsToAccounts]:t!==i.CrmTypeNames.Account},e.prototype._createParentJoinConditionForEntitiesToResolve=function(e){var t=this;return e.reduce((function(e,n){return e+t._createParentJoinCondition(n.trim())}),"")},e.prototype._addResolvedToCache=function(e){var t=e.dataValues[i.PropertyNames.Email],n=this._recipientsCache.getResolved(t);n&&this._resolvedRecordSelector.select(n,e)!==e||this._recipientsCache.addResolved(e)},e.prototype._webApiEntityToRecipientRecord=function(e){this._fillEntityLogicalNameIfEmpty(e);var t={emailaddress:e[i.PropertyNames.Email],name:this._getWebApiEntityAliasedProperty(e,i.CrmTypeNamesToNameFieldName[e[p]]),entityImage:this._getWebApiEntityAliasedProperty(e,"entityimage")},n=e[p];n===i.CrmTypeNames.User?t.isdisabled=this._getWebApiEntityAliasedProperty(e,i.PropertyNames.IsDisabled):(t.statecode=this._getWebApiEntityAliasedProperty(e,i.PropertyNames.StatusCode),t.ownerid=this._getWebApiEntityAliasedProperty(e,i.PropertyNames.OwnerId),t.followemail=this._getWebApiEntityAliasedProperty(e,i.PropertyNames.FollowEmail));return{entityReference:{Id:r.default.tryParseOrNull(e._parentobjectid_value),LogicalName:n,Name:t.name},dataValues:t}},e.prototype._fillEntityLogicalNameIfEmpty=function(e){var t=e[p];if(!t){var n=Object.keys(e).find((function(e){return e.indexOf("alias")>-1}));n&&(t=n.indexOf(i.CrmTypeNames.User)>-1?i.CrmTypeNames.User:n.indexOf(i.CrmTypeNames.Contact)>-1?i.CrmTypeNames.Contact:n.indexOf(i.CrmTypeNames.Lead)>-1?i.CrmTypeNames.Lead:n.split("alias.")[0],e[p]=t)}},e.prototype._getWebApiEntityAliasedProperty=function(e,t){return e[e[p]+"alias."+t]},e.prototype._logResolvedRecipientsSummary=function(){var e={emailAddressesCount:this._recipientsCollection?this._recipientsCollection.length:0,recipientTypesCountMap:{}};this._recipientsCollection&&(e.recipientTypesCountMap=this._recipientsCollection.reduce((function(e,t){return e[t.entityReference.LogicalName]=e[t.entityReference.LogicalName]?e[t.entityReference.LogicalName]+1:1,e}),{})),this._applicationContext.EventManager.ReportTraceInfo(f+".Summary","Resolved Email Addresses summary",e)},e.prototype._resolveRecipients=function(e){var t=this;this._currentEmailAddressDetails=e;var n=[],r=e.map((function(e){return e.emailAddress}));if(0===r.length){var o=this._recipientsCollection&&0!==this._recipientsCollection.length;return this._recipientsCollection=n,o&&this._logResolvedRecipientsSummary(),Promise.resolve({recipients:this._recipientsCollection,isChanged:o})}var a=r.map((function(e){return e.toLowerCase()})).sort().join();return this._pendingExecutions[a]?this._pendingExecutions[a]:(this._pendingExecutions[a]=this._executeResolveRecipients(r).then((function(){delete t._pendingExecutions[a];for(var r=0;r<e.length;r++){var o=t._recipientsCache.getResolved(e[r].emailAddress);if(!o){var s={name:e[r].displayName||e[r].emailAddress,emailaddress:e[r].emailAddress};o={entityReference:{Id:null,LogicalName:e[r].recipientType,Name:s.name},dataValues:s}}o.dataValues[i.PropertyNames.Role]=e[r].recipientRole,n.push(o)}var l=t._isRecipientsChanged(n);return l&&(t._recipientsCollection=n,t._logResolvedRecipientsSummary()),{recipients:n,isChanged:l}})),this._pendingExecutions[a])},e.prototype._isRecipientsChanged=function(e){var t=this;return!this._recipientsCollection||this._recipientsCollection.length!==e.length||e.reduce((function(e,n,r){if(t._recipientsCollection&&t._recipientsCollection[r]&&t._recipientsCollection[r].dataValues[i.PropertyNames.Email]===n.dataValues[i.PropertyNames.Email]){var o=t._recipientsCollection[r];(o.entityReference.Id===n.entityReference.Id||null!=o.entityReference.Id&&null!=n.entityReference.Id&&o.entityReference.Id.guid===n.entityReference.Id.guid)&&e.push(o)}return e}),[]).length!==e.length},e.prototype.resolveRecipients=function(){var e=this;return(this._resolvedRecordSelector?this._recipientsRetriever.getEmailAddressDetailsArray():Promise.all([this._applicationContext.CRMProvider.whoAmI(),this._recipientsRetriever.getEmailAddressDetailsArray()]).then((function(t){var n=t[0],r=t[1];return e._resolvedRecordSelector=new a.default(n.UserId),r}))).then((function(t){return e._resolveRecipients(t)}))},e.prototype.resolveCachedIfNotResolved=function(e){return e&&this._recipientsCache.isCached(e)&&!this._recipientsCache.getResolved(e)?(this._recipientsCache.resetRecipient(e),this._resolveRecipients(this._currentEmailAddressDetails)):Promise.resolve(null)},e}();t.default=_}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(9)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._indexedRecipients={},this._indexedStamps={}}return e.prototype.addResolved=function(e){var t=e.dataValues[n.PropertyNames.Email].toLowerCase();this._indexedRecipients[t]=e,this._indexedStamps[t]=new Date},e.prototype.addUnresolved=function(e){e=e.toLowerCase(),this._indexedRecipients[e]=null,this._indexedStamps[e]=new Date},e.prototype.getResolved=function(e){return e=e.toLowerCase(),this._indexedRecipients[e]},e.prototype.getStamp=function(e){return e=e.toLowerCase(),this._indexedStamps[e]},e.prototype.isRecordExpired=function(t){return t=t.toLowerCase(),!this._indexedStamps.hasOwnProperty(t)||(new Date).getTime()-this.getStamp(t).getTime()>e._expirationTime},e.prototype.isCached=function(e){return e=e.toLowerCase(),this._indexedRecipients.hasOwnProperty(e)},e.prototype.resetRecipient=function(e){e=e.toLowerCase(),delete this._indexedRecipients[e],delete this._indexedStamps[e]},e._expirationTime=3e5,e}();t.default=r}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(9)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){var t;this._logicalNamePriorityForRecipientResolution=((t={})[n.CrmTypeNames.Account]=0,t[n.CrmTypeNames.Lead]=1,t[n.CrmTypeNames.Contact]=2,t[n.CrmTypeNames.User]=3,t),this._currentUserId=e}return e.prototype.select=function(e,t){var n=this._isRecordActive(e),r=this._isRecordActive(t);if(!n&&r)return t;if(n&&!r)return e;var o=this._getRecordPriority(e),i=this._getRecordPriority(t);if(o!==i)return o>i?e:t;var a=this._isCreatedByCurrentUser(e),s=this._isCreatedByCurrentUser(t);return!a&&s?t:e},e.prototype._isCreatedByCurrentUser=function(e){return e.entityReference.LogicalName!==n.CrmTypeNames.User&&(e.dataValues[n.PropertyNames.OwnerId]||"").toUpperCase()===this._currentUserId.toUpperCase()},e.prototype._isRecordActive=function(e){return e.entityReference.LogicalName===n.CrmTypeNames.User?!e.dataValues[n.PropertyNames.IsDisabled]:0===e.dataValues[n.PropertyNames.StatusCode]},e.prototype._getRecordPriority=function(e){return this._logicalNamePriorityForRecipientResolution[e.entityReference.LogicalName]},e}();t.default=r}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(64),n(11)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this._bcd=e,this._applicationContext=t,this._isComposeMode=this._applicationContext.JsApiProvider.isComposeMode(),this._userProfileEmail=this._applicationContext.JsApiProvider.getUserEmailAddress()}return e.prototype.getEmailAddressDetailsArray=function(){var e=this;return this._getEmailAddressDetailsArrayInternal().then((function(t){t=e._fillEmailAddresses(t),t=e._removeDuplicates(t);var n=e._applicationContext.JsApiProvider.getMailboxItemType();return(t.length>1||n===r.default[r.default.appointment]||e._isComposeMode)&&(t=t.filter((function(t){return t.emailAddress.toLowerCase()!==e._userProfileEmail.toLowerCase()}))),t}))},e.prototype._getEmailAddressDetailsArrayInternal=function(){var e=this,t=this._applicationContext.JsApiProvider.isAppointment(),r=[];return t?this._applicationContext.JsApiProvider.getMeetingAttendees().then((function(t){return t.organizer&&r.push(e._setRecipientRole(t.organizer,n.default.Organizer)),r=r.concat(t.requiredAttendees.map((function(t){return e._setRecipientRole(t,n.default.RequiredAttendee)}))).concat(t.optionalAttendees.map((function(t){return e._setRecipientRole(t,n.default.OptionalAttendee)})))})):this._applicationContext.JsApiProvider.getMessageRecipients().then((function(t){return t.sender&&r.push(e._setRecipientRole(t.sender,n.default.Sender)),r=r.concat(t.to.map((function(t){return e._setRecipientRole(t,n.default.To)}))).concat(t.cc.map((function(t){return e._setRecipientRole(t,n.default.Cc)}))),t.bcc&&(r=r.concat(t.bcc.map((function(t){return e._setRecipientRole(t,n.default.Bcc)})))),r}))},e.prototype._fillEmailAddresses=function(e){return e.map((function(e){return e.emailAddress||(e.emailAddress=e.displayName),e}))},e.prototype._removeDuplicates=function(e){var t={};return e.reduce((function(e,n){var r=n.emailAddress.toLowerCase();return t.hasOwnProperty(r)||(t[r]=!0,e.push(n)),e}),[])},e.prototype._setRecipientRole=function(e,t){return{recipientRole:t,emailAddress:e.emailAddress,displayName:e.displayName,recipientType:e.recipientType}},e}();t.default=o}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processResponse=function(e,t,n){return e}}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(28)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parse=function(e){var t={},r=e.orgdborgsettings;if(!r)return t;var o=(new DOMParser).parseFromString(r,"text/html").getElementsByTagNameNS("*","orgsettings")[0];if(!o)return t;for(var i=function(e){var r=o.childNodes[e],i=r.nodeName.toLowerCase(),a=Object.keys(n).find((function(e){return n[e].name.toLowerCase()===i}));if(a){var s=n[a],l=r.textContent.toLowerCase()===s.enabledValue.toLowerCase();t[s.name]=l}},a=0;a<o.childNodes.length;a++)i(a);return t}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(0),n(8),n(84),n(81)],void 0===(o=function(e,t,n,r,o,i){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),t.MailAppDataServiceName=i.default;var s=((a={})[i.default.GET_USER_VALIDATION]=r.default.getUserValidationCache,a[i.default.CHECK_READ_PRIVILEGE]=r.default.checkEntitiesReadPrivilegeCache,a[i.default.IS_FEATURES_ENABLED]=r.default.isFeaturesEnabledCache,a),l=function(){function e(e,t){this._mailAppDataPromises={},this._bcd=e,this._applicationContext=t,this._crmHttpRequest=new o.default(this._bcd,t)}return e.prototype.getMailAppData=function(e,t,n,r){var o=this;if(void 0===r&&(r=!1),!r){var i=this._applicationContext.Storage.getItem(s[e]);if(i)return Promise.resolve(i)}return this._mailAppDataPromises[e]||(this._mailAppDataPromises[e]=this._executeMailAppDataCall(e,t).then((function(t){try{var r=n&&n(t)||t;return o._applicationContext.Storage.setItem(s[e],r),r}catch(e){throw e}})).catch((function(t){return o._applicationContext.Storage.removeItem(s[e]),Promise.reject(t)}))),this._mailAppDataPromises[e]},e.prototype._executeMailAppDataCall=function(e,t){var r=n.default.CRM_PROVIDER+"."+e,o=this._applicationContext.OrgUrl+"/AppWebServices/MailAppInitialDataService.asmx/"+e;return this._crmHttpRequest.send(r,{method:"POST",url:o,content:JSON.stringify(t)}).then((function(t){if(t&&t.d)return t.d;throw'"'+e+'" responded with invalid data'}))},e}();t.default=l}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(0),n(38),n(15),n(133),n(1),n(4),n(3),n(61),n(8),n(40),n(29),n(63)],void 0===(o=function(e,t,n,r,o,i,a,s,l,u,c,d,p,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=n.default.UNIFIED_CLIENT_LOADER+".ClientFrameLoad",h=function(){function e(e,t){this._bcd=e,this._applicationContext=t,this._iframeId=u.IFRAME_ID,this._parentElement=l.default.document().getElementById("content")}return e.prototype._loadMailClient=function(){var e=this,t=this._applicationContext.Storage.getItem(c.default.appModuleIdsCache);return t?this._loadFrame(this._mailClientFrameUrl(t)):this._applicationContext.CRMProvider.getAppId().then((function(t){return e._loadFrame(e._mailClientFrameUrl(t))}),(function(e){throw e instanceof a.ComponentError||(e=a.ComponentError.fromNativeError(n.default.UNIFIED_CLIENT_LOADER,a.ErrorCode.GENERIC,e)),e}))},e.prototype._loadModuleClient=function(){return this._loadFrame(this._moduleClientFrameUrl())},e.prototype.loadClient=function(){switch(this._bcd.mode){case o.default.Read:case o.default.Compose:return this._loadMailClient();case o.default.Module:return this._loadModuleClient();default:return this._loadMailClient()}},e.prototype._loadFrame=function(e){var t=this;return new Promise((function(n,r){var o=l.default.document().createElement("iframe");o.setAttribute("id",t._iframeId),p.default.getInstance().getIsBrowserChrome()&&o.setAttribute("sandbox",u.IFRAME_SANDBOX);var i=t._applicationContext.Performance.addStopwatch(_);o.onload=function(){i.stop(),t._applicationContext.EventManager.ReportComponentSuccess(_),t._parentElement.setAttribute("aria-hidden","false"),t._addFrameContentListeners(o),n(o.contentDocument)},o.onerror=r,o.setAttribute("src",e),t._parentElement.appendChild(o),t._applicationContext.EventManager.ReportTraceInfo(_,"Client iframe is appended to DOM")})).catch((function(e){throw new a.ComponentError(_,"Failed to load iframe",a.ErrorCode.GENERIC,d.ensureComponentErrorObject(e))}))},e.prototype._addFrameContentListeners=function(e){var t=this;e.contentWindow&&(e.contentWindow.onerror=function(e,n,r,o,i,a){if(a&&a.length)for(var s=0,l=a;s<l.length;s++){var u=l[s];t._reportFrameError(u.errorMessage,u.fileName,u.lineNumber,u.columnNumber,d.ensureErrorObject(u))}else t._reportFrameError(e,n,r,o,i)})},e.prototype._reportFrameError=function(e,t,n,r,o){this._applicationContext.EventManager.ReportComponentFailure(new a.ComponentError(_,e&&e.length>0?e:"Error in Unified Client frame. Error detail is unavailable",a.ErrorCode.GENERIC,d.ensureComponentErrorObject(o)),[{name:s.ErrorEventParameterName.Error,value:o},{name:s.ErrorEventParameterName.Url,value:t},{name:s.ErrorEventParameterName.LineNumber,value:n},{name:s.ErrorEventParameterName.ColumnNumber,value:r}])},e.prototype._mailClientFrameUrl=function(e){var t=this._bcd.orgName,n=this._bcd.collectorService,r=this._bcd.showPerformance?"&perf=true":"",o=this._bcd.testMode?"&flags="+encodeURIComponent("testmode=true"):"",a=n?"&collectorurl="+n:"",s="&clienthost=3&appid="+e,u=this._bcd.useAuthMethod===f.default.WIA?"":i.default(this._bcd),c="&sv="+l.default.appVersion();return this._applicationContext.OrgUrl+"/uclient/main.htm?org="+t+r+a+u+s+c+o},e.prototype._moduleClientFrameUrl=function(){var e=this._bcd.useAuthMethod,t=this._bcd.orgName,n=r.default[this._bcd.crmDeploymentEnvironment].toString();return this._applicationContext.OrgUrl+"/crmmailapp/outlookmoduleextension/index.html?useAuthMethod="+e+"&org="+t+"&de="+n},e}();t.UnifiedClientLoader=h,t.default=function(){return function(e,t){return new h(e,t).loadClient()}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(3)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return 0===n.default.location().protocol.indexOf("https")?"&liveid=1":""}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UndefinedError=-1]="UndefinedError",e[e.AsyncResultEmpty=-2]="AsyncResultEmpty",e[e.CallTimedOut=-3]="CallTimedOut",e[e.InvalidDataFormat=2006]="InvalidDataFormat",e[e.OperationNotSupportedError=5e3]="OperationNotSupportedError",e[e.InternalError=5001]="InternalError",e[e.DataIsNotOnServer=5005]="DataIsNotOnServer",e[e.BrowserAPINotSupported=5009]="BrowserAPINotSupported",e[e.TooManyIncompleteRequestsError=5100]="TooManyIncompleteRequestsError",e[e.InternalFormatError=9002]="InternalFormatError",e[e.InvalidAttachmentPath=9004]="InvalidAttachmentPath",e[e.HtmlSanitizationFailure=9011]="HtmlSanitizationFailure",e[e.AccessRestricted=9017]="AccessRestricted",e[e.GenericTokenError=9018]="GenericTokenError",e[e.GenericSettingsError=9019]="GenericSettingsError",e[e.GenericResponseError=9020]="GenericResponseError",e[e.SaveError=9021]="SaveError",e[e.MessageInDifferentStoreError=9022]="MessageInDifferentStoreError",e[e.CanOnlyGetTokenForSavedItem=9029]="CanOnlyGetTokenForSavedItem",e[e.CallFailedDueToItemChange=9030]="CallFailedDueToItemChange",e[e.HTTPRequestFailure=9040]="HTTPRequestFailure",e[e.NetworkError=9041]="NetworkError",e[e.InternalServerError=9042]="InternalServerError",e[e.ItemNotSaved=9046]="ItemNotSaved",e[e.DialogClosed=12006]="DialogClosed",e[e.DialogAlreadyOpened=12007]="DialogAlreadyOpened",e[e.EndUserIgnore=12009]="EndUserIgnore"}(r||(r={})),t.OfficeErrorCode=r;var o=((n={})[r.UndefinedError]="Undefined error happened",n[r.AsyncResultEmpty]="AsyncResult response is empty",n[r.CallTimedOut]="Internal call time out",n[r.SaveError]="Connection error occurred",n[r.MessageInDifferentStoreError]="The EWS ID can't be retrieved because the message is saved in a different store",n[r.OperationNotSupportedError]="Operation is not supported",n[r.InternalError]="Internal error",n[r.InternalFormatError]="Internal format error",n[r.TooManyIncompleteRequestsError]="Wait until the previous call completes",n[r.CallFailedDueToItemChange]="Api call failed due to item change",n[r.DialogClosed]="Dialog closed by user",n[r.DialogAlreadyOpened]="Operation failed because this add-in already has an active dialog",n[r.EndUserIgnore]="The user chose to ignore the dialog box.",n[r.InvalidDataFormat]="The format of the specified data object is invalid",n[r.HtmlSanitizationFailure]="The HTML santization has failed",n[r.InvalidAttachmentPath]="The attachment path was invalid",n[r.AccessRestricted]="Access Restricted",n[r.GenericSettingsError]="Generic failure while saving roaming settings",n[r.GenericResponseError]="Generic response error",n[r.DataIsNotOnServer]="Operation failed because the data is not current on the server",n[r.NetworkError]="The user is no longer connected to the network",n[r.InternalServerError]="The Exchange server returned an error",n[r.HTTPRequestFailure]="The request has failed",n[r.GenericTokenError]="Generic token error",n[r.CanOnlyGetTokenForSavedItem]="Can only get token for saved item",n[r.BrowserAPINotSupported]="This browser does not support the requested API",n[r.ItemNotSaved]="The id can't be retrieved until the item is saved",n);t.OfficeErrorMessages=o}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(3),n(6),n(136)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return function(e,t){var i=(new o.default).boot(e,t);-1===n.default.location().protocol.indexOf("https")&&delete i[r.default.ACCOUNT],t.DispatcherCollection=i}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(15),n(137),n(139),n(140),n(141),n(142),n(143),n(144),n(145),n(146),n(147),n(204)],void 0===(o=function(e,t,n,r,o,i,a,s,l,u,c,d,p,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=function(){function e(){}return e.prototype.boot=function(e,t){var _={},h=new r.default(e,t);_[h.getNamespace()]=h;var m=new a.default(e,t);_[m.getNamespace()]=m;var v=new c.default(e,t);_[v.getNamespace()]=v;var E=new s.default(e,t);if(_[E.getNamespace()]=E,e.mode!==n.default.Module){var g=new p.default(e,t);_[g.getNamespace()]=g;var C=new l.default(e,t);_[C.getNamespace()]=C;var y=new u.default(e,t);_[y.getNamespace()]=y;var I=new d.default(e,t);_[I.getNamespace()]=I;var T=new i.default(e,t);_[T.getNamespace()]=T;var A=new o.default(e,t);_[A.getNamespace()]=A}else{var P=new f.default(e,t);_[P.getNamespace()]=P}return _},e}();t.default=_}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(14),n(6)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.namespace=r.default.DEVICE,o}return a(t,e),t.prototype.getInitialState=function(){return{FormFactor:"mailapp"}},t}(n.default);t.default=o}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(0),n(1),n(4)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,i,a,s,l){if(this._dispatcher=e,this._appContext=t,this._name=i,this._function=a,this._argsType=s,this._callbacks=l,!this._dispatcher||!this._appContext)throw new r.ComponentError(n.default.DISPATCHER,"DispatcherMethod.constructor: Either dispatcher or applicationContext instance is null.",r.ErrorCode.GENERIC);if(!(this._name&&this._function&&this._argsType&&this._callbacks)){var u={name:this._name,function:this._function,argsType:this._argsType,callbacks:this._callbacks};this._appContext.EventManager.ReportComponentFailure(new r.ComponentError(this._getTelemetryComponent+".constructor","Missing argument to DispatcherMethod()",r.ErrorCode.GENERIC),[{name:o.EventParameterName.Data,value:u}])}}return Object.defineProperty(e.prototype,"_getTelemetryComponent",{get:function(){return this._dispatcher.getTelemetryComponent()+".Method"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),e.prototype.invoke=function(e){this._verifySchemaWithArgsAndTypes(e)&&this._function.call(this._dispatcher,e)},e.prototype._verifySchemaWithArgsAndTypes=function(e){var t=this._getTelemetryComponent+"."+this._name+".VerifySchema";if(Object.keys(e.args).length!==Object.keys(this._argsType).length)return this._appContext.EventManager.ReportComponentFailure(new r.ComponentError(t,"Invalid number of arguments passed",r.ErrorCode.GENERIC)),!1;if(Object.keys(e.callbacks).length!==Object.keys(this._callbacks).length){var n=[{name:o.EventParameterName.Data,value:{callbacks:e.callbacks,expectedCallbacks:this._callbacks}}];return this._appContext.EventManager.ReportComponentFailure(new r.ComponentError(t,"Invalid number of callbacks passed",r.ErrorCode.GENERIC),n),!1}for(var i in e.args){var a=e.args[i];if(!this._verifyArgument(i,a))return!1}for(var s in e.callbacks){var l=e.callbacks[s];if(!this._verifyCallback(s,l))return!1}return!0},e.prototype._verifyArgument=function(e,t){var n=this._getTelemetryComponent+"."+this._name+".VerifyArgument",i=[{name:o.EventParameterName.Data,value:e}],a=this._argsType[e];return void 0===a?(this._appContext.EventManager.ReportComponentFailure(new r.ComponentError(n,"Argument with unknown name passed for verification",r.ErrorCode.GENERIC),i),!1):null===t||typeof a==typeof t||(this._appContext.EventManager.ReportComponentFailure(new r.ComponentError(n,"Argument with unexpected type passed for verification",r.ErrorCode.GENERIC),i),!1)},e.prototype._verifyCallback=function(e,t){var n=this._getTelemetryComponent+"."+this._name+".VerifyCallback";return e&&t?void 0!==this._callbacks[e]||(this._appContext.EventManager.ReportComponentFailure(new r.ComponentError(n,"Callback with name not found",r.ErrorCode.GENERIC),[{name:o.EventParameterName.Data,value:e}]),!1):(this._appContext.EventManager.ReportComponentFailure(new r.ComponentError(n,"_verifyCallback called with no arguments",r.ErrorCode.GENERIC)),!1)},e}();t.default=i}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(14),n(6),n(29),n(3),n(4),n(1)],void 0===(o=function(e,t,n,r,o,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.namespace=r.default.DATA,o}return a(t,e),t.prototype._base64ToBlob=function(e,t){for(var n=i.default.atob(e),r=n.length,o=new ArrayBuffer(r),a=new Uint8Array(o),s=0;s<r;s++)a[s]=n.charCodeAt(s);return new Blob([o],{type:t})},t.prototype._saveOrOpenBlob=function(e,t){var n=i.default.URL().createObjectURL(e),r=i.default.document().createElement("a");r.setAttribute("href",n),r.setAttribute("target","_blank"),t&&r.setAttribute("download",t),i.default.document().body.appendChild(r),r.click(),i.default.document().body.removeChild(r),i.default.URL().revokeObjectURL(n)},t.prototype._saveBlobForSafari=function(e){var t=this;return new Promise((function(n,r){var a=new FileReader;a.onloadend=function(){var t=a.result,r=i.default.document().getElementById("__mscrm.safariopenfileiframe");r||((r=i.default.document().createElement("iframe")).style.display="none",i.default.document().body.appendChild(r),r.id="__mscrm.safariopenfileiframe");var s=t;(e.type.startsWith("text")||e.type.startsWith("image"))&&(s=s.replace(e.type,"application/octet-stream")),r.src=s,o.default.getInstance().getIsIOSSupported()&&i.default.open(t,"_blank","scrollbars=1,resizable=1,width=1000,height=700"),n()},a.onerror=function(e){t.applicationContext.EventManager.ReportComponentFailure(new l.ComponentError(t.getTelemetryComponent()+".SafariSaveBlob","FileReader failed",l.ErrorCode.GENERIC),[{name:s.ErrorEventParameterName.Error,value:e}]),r()},a.readAsDataURL(e)}))},t.prototype._saveDataFile=function(e){var t=this,n=e.args.dataFile,r=this._base64ToBlob(n.fileContents,n.mimeType);if(i.default.navigator().msSaveBlob)i.default.navigator().msSaveBlob(r,n.filename);else{if(o.default.getInstance().getIsBrowserSafari())return void this._saveBlobForSafari(r).then((function(){t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onSuccessCallback,{dataID:n.filename},!1)}),(function(){t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onErrorCallback,{},!1)}));this._saveOrOpenBlob(r,n.filename)}this.applicationContext.Bridge.performCallbackWithId(e.callbacks.onSuccessCallback,{dataID:n.filename},!1)},t.prototype.registerMethods=function(){var e,t;this.registerMethodWithName("saveDataFile",this._saveDataFile,((e={}).dataFile={},e),((t={}).onErrorCallback="",t.onSuccessCallback="",t))},t}(n.default);t.default=u}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(14),n(6),n(3),n(1)],void 0===(o=function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.namespace=r.default.MULTIMEDIA,o}return a(t,e),t.prototype.getInitialState=function(){return{NativeFilePickerAvailable:!0}},t.prototype._openFilePicker=function(e){var t=this,n=e.args.shouldPickMultipleFiles,r=e.args.fileFilter,a=e.args.maxUploadFileSize;this._pickFileInternal(n,a,r.join(",")).then((function(n){t._fileInput&&o.default.document().body.removeChild(t._fileInput),t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onSuccessCallback,{dataFiles:n},!1)}),(function(n){t.applicationContext.EventManager.ReportComponentFailure(new i.ComponentError(t.getTelemetryComponent()+".PickFile","FileReader failed",n)),t._fileInput&&o.default.document().body.removeChild(t._fileInput),t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onErrorCallback,{errorCode:n},!1)}))},t.prototype._pickFileInternal=function(e,t,n){var r=this;return new Promise((function(i,a){var s=o.default.document().getElementById("filepickerid");s?(r._fileInput=s,r._fileInput.multiple=e,r._fileInput.accept=n):(r._fileInput=o.default.document().createElement("input"),r._fileInput.type="file",r._fileInput.id="filepickerid",r._fileInput.style.display="none",r._fileInput.multiple=e,r._fileInput.accept=n,r._fileInput.onchange=function(e){for(var n=e.target.files,r=0;r<n.length;r++){if(n[r].size>t)return void a(2);if(0===n[r].size)return void a(3)}var o=[],s=0,l=function(e){var t=new FileReader;t.onload=function(){var r=t.result,a={fileContents:r.substring(r.indexOf(",")+1),mimeType:n[e].type,filename:n[e].name,size:n[e].size};o.push(a),++s===n.length&&i(o)},t.onerror=function(e){a(0)},t.readAsDataURL(n[e])};for(r=0;r<n.length;r++)l(r)},o.default.document().body.appendChild(r._fileInput)),r._fileInput.click()}))},t.prototype.registerMethods=function(){var e,t;this.registerMethodWithName("openFilePicker",this._openFilePicker,((e={}).shouldPickMultipleFiles=!1,e.fileFilter=[""],e.pickerLocation=0,e.maxUploadFileSize=0,e),((t={}).onErrorCallback="",t.onSuccessCallback="",t))},t}(n.default);t.default=s}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(1),n(4),n(3),n(6),n(8),n(14)],void 0===(o=function(e,t,n,r,o,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.namespace=i.default.APPLICATION,r._isClientInitialized=!1,r._clientInitializedPromise=new Promise((function(e,t){r._clientInitializedPromiseResolve=e,r._clientInitializedPromiseReject=t})),r}return a(t,e),Object.defineProperty(t.prototype,"clientInitialized",{get:function(){return this._clientInitializedPromise},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isClientInitialized",{get:function(){return this._isClientInitialized},enumerable:!0,configurable:!0}),t.prototype.getInitialState=function(){var e,t=this.applicationContext.Storage.getItem(s.default.initTime);this.applicationContext.Storage.removeItem(s.default.initTime);var n=this.applicationContext.Performance.getMetrics();this.applicationContext.Performance.disable(),this.applicationContext.Performance.clear();var i={MobileClientTelemetry:!0,HideBrandName:!0,HideAppSwitcher:!0};return{DiagnosticsEnabled:!1,WindowLocation:!1,LastPALVersion:"Version1",PushToPull:!1,Pullback:!1,MessageInterface:!0,MessageProtocol:o.default.location().protocol,Version1:!0,OSVersion:"TBD",HasReconfigureSupport:!0,ApplicationName:o.default.location().host,ShimPerformanceMetrics:n,ShimStartTime:new Date(t).getTime(),TelemetryEventsParams:(e={ShimSessionId:this.applicationContext.EventManager.getSessionId()},e[r.SessionContextParameterName.ShimVersion]=o.default.shimVersion(),e),Revision:1,Win8UpdateRevision:1,ProxyMetadataSyncEventsToShim:!0,NativeFCBContext:i}},t.prototype._clientReady=function(e){},t.prototype._clientInitialized=function(e){this._isClientInitialized=!0,this._clientInitializedPromiseResolve()},t.prototype._clientBootError=function(e){var t=e.args.errorDetails;this._clientInitializedPromiseReject(new n.default("ClientBootError",t.message,t.errorCode))},t.prototype.registerMethods=function(){this.registerMethodWithName("clientReady",this._clientReady,{clientState:{}},{}),this.registerMethodWithName("clientInitialized",this._clientInitialized,{},{}),this.registerMethodWithName("clientBootError",this._clientBootError,{deviceErrorAction:0,errorDetails:{}},{})},t}(l.default);t.default=u}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(6),n(14)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o;!function(e){e[e.Cancelled=0]="Cancelled",e[e.Failed=1]="Failed"}(o||(o={}));var i=function(e){function t(t,r){var o=e.call(this,t,r)||this;return o._authFailureResponse="AuthError",o.namespace=n.default.ACCOUNT,o}return a(t,e),t.prototype._requestSecurityToken=function(e){var t=this,n=e.args.refreshToken;this.applicationContext.AuthenticationProvider.authenticateClient(n).then((function(n){var r={requestSecurityTokenResponse:n};t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onRequestSecurityTokenResponse,r,!1)}),(function(n){var r={requestSecurityTokenResponse:t._authFailureResponse,status:o.Failed,errorCode:n.code,errorDescription:n.message};t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onRequestSecurityTokenResponse,r,!1)}))},t.prototype.registerMethods=function(){this.registerMethodWithName("requestSecurityToken",this._requestSecurityToken,{refreshToken:!1},{onRequestSecurityTokenResponse:""})},t}(r.default);t.default=i}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(3),n(6),n(14)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.namespace=r.default.DOCUMENT,o}return a(t,e),t.prototype._launchUrl=function(e){var t=e.args.url;t&&(this.applicationContext.EventManager.ReportTraceInfo(this.getTelemetryComponent()+".LaunchUrl","Attempting to open document",t),n.default.open(t,"_blank","scrollbars=1,resizable=1,width=1000,height=700"))},t.prototype._openDocument=function(e){this.applicationContext.Bridge.performCallbackWithId(e.callbacks.onOpenDocumentComplete,{palErrorCode:0},!1)},t.prototype.registerMethods=function(){var e,t;this.registerMethodWithName("launchURL",this._launchUrl,((e={}).url="",e),{}),this.registerMethodWithName("openDocument",this._openDocument,{dataID:"",fileName:"",mimeType:""},((t={}).onOpenDocumentComplete="",t))},t}(o.default);t.default=i}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(6),n(14)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r){var o=e.call(this,t,r)||this;return o.namespace=n.default.NAVIGATION,o}return a(t,e),t.prototype._updateBackBehavior=function(e){},t.prototype.registerMethods=function(){var e;this.registerMethodWithName("updateBackBehavior",this._updateBackBehavior,((e={}).behavior=0,e))},t}(r.default);t.default=o}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(3),n(6),n(14)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.namespace=r.default.NETWORK,o}return a(t,e),t.prototype._openUrl=function(e){var t=e.args.url;t&&(this.applicationContext.EventManager.ReportTraceInfo(this.getTelemetryComponent()+".OpenUrl","Attempting to open document",t),n.default.open(t,"_blank","scrollbars=1,resizable=1,width=1000,height=700"),this.applicationContext.Bridge.performCallbackWithId(e.callbacks.onMethodReturn,{returnValue:!0},!1))},t.prototype._canOpenUrl=function(e){this.applicationContext.Bridge.performCallbackWithId(e.callbacks.onMethodReturn,{returnValue:!0},!1)},t.prototype.registerMethods=function(){var e,t,n,r;this.registerMethodWithName("openUrl",this._openUrl,((e={}).url="",e),((t={}).onMethodReturn="",t.onMethodException="",t)),this.registerMethodWithName("canOpenUrl",this._canOpenUrl,((n={}).url="",n),((r={}).onMethodReturn="",r.onMethodException="",r))},t}(o.default);t.default=i}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(14),n(6)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.namespace=r.default.LOGGING,o}return a(t,e),t.prototype.registerMethods=function(){var e,t;this.registerMethodWithName("logMessage",(function(){}),((e={}).level=0,e.message="",e),{}),this.registerMethodWithName("logTelemetryData",(function(){}),((t={}).telemetryData="",t),{})},t}(n.default);t.default=o}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(148),n(0),n(202),n(1),n(40),n(4),n(6),n(14),n(203)],void 0===(o=function(e,t,n,r,o,i,s,l,u,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){function t(t,o){var a=e.call(this,t,o)||this;a.namespace=u.default.EXTERNAL_CONTEXT,a._dependentProperties={},a._pendingPropertyRequests=[],a._allPropertiesInitialized=!1,a.applicationContext.ComponentsLoader.ensureComponentLoaded(r.default.WEB_SCRIPT_BRIDGE).then((function(){return a._onBridgeLoaded()})).then((function(){return a._allPropertiesInitialized=!0})),a._initializedProperties={},a._externalContextDispatcherHelper=new d.default(o);try{a._contexts=n.default(a.bcd,a.applicationContext)}catch(e){throw i.ComponentError.fromNativeError(a.getTelemetryComponent()+".constructor",i.ErrorCode.GENERIC,e)}return a}return a(t,e),t.prototype._wrapPropertyValue=function(e,t,n){return{value:e,status:t,errorMessage:n}},t.prototype._convertToExternalContextError=function(e,t,n){var r=s.ensureComponentErrorObject(t),o=n+". Reason: "+r.message;return this._reportTraceErrorTelemetry(e,o,r),{errorCode:r.code,message:o,blockErrorReporting:!1}},t.prototype._knownPropertyUpdate=function(e,t,n,r,i){var a=this;r===o.ExternalContextResultStatus.Success?this._reportPropertyValue("Updating known property",e,t,n,"KnownPropertyUpdate"):r===o.ExternalContextResultStatus.Loading&&this.applicationContext.EventManager.ReportTraceInfo(this._getTelemetryComponentName(e,t,"KnownPropertyUpdate"),"Update known property with state loading"),this.applicationContext.Bridge.changeStateForDispatcher(this.namespace,"KnownPropertyUpdate",{contextId:e,propertyId:t,value:this._wrapPropertyValue(n,r,i)},!0),this._allPropertiesInitialized&&r!==o.ExternalContextResultStatus.Loading&&this._dependentProperties[e]&&this._dependentProperties[e][t]&&this._dependentProperties[e][t].map((function(n){var r=a._contexts[n.contextId].properties[n.propertyId];r.onDependentProperyUpdate?r.onDependentProperyUpdate({contextId:e,propertyId:t}):r.notifyUpdate&&r.notifyUpdate(r.accessor())}))},t.prototype._getPropertyNotifyUpdateFunction=function(e,t){var n=this;return function(r,i){r&&"function"==typeof r.then?(!0!==i&&n._knownPropertyUpdate(e,t.id,void 0,o.ExternalContextResultStatus.Loading),r.then((function(r){n._knownPropertyUpdate(e,t.id,r,o.ExternalContextResultStatus.Success)}),(function(r){var i=n._convertToExternalContextError(n._getTelemetryComponentName(e,t.id,"KnownPropertyUpdate"),r,"NotifyUpdate: failed");n._knownPropertyUpdate(e,t.id,void 0,o.ExternalContextResultStatus.Failed,JSON.stringify(i))}))):n._knownPropertyUpdate(e,t.id,r,o.ExternalContextResultStatus.Success)}},t.prototype._setPropertyNotifyUpdate=function(e,t){var n=this;t.setNotifyUpdate(this._getPropertyNotifyUpdateFunction(e,t)),!t.onItemChanged&&t.updateOnItemChanged&&this.applicationContext.JsApiProvider.addItemChangedHandler((function(){t.notifyUpdate(t.accessor())})),t.dependsOnProperties&&t.dependsOnProperties.map((function(r){var o=r.propertyId,i=r.contextId;n._dependentProperties[i]||(n._dependentProperties[i]={}),n._dependentProperties[i][o]||(n._dependentProperties[i][o]=[]),n._dependentProperties[i][o].push({contextId:e,propertyId:t.id})}))},t.prototype._trimProcessedPropertyRequest=function(e,t){this._pendingPropertyRequests=this._pendingPropertyRequests.reduce((function(n,r){return r.contextId===e&&r.propertyId===t||n.push(r),n}),[])},t.prototype._setIsPropertyInitialized=function(e,t,n){this._initializedProperties[e]||(this._initializedProperties[e]={}),this._initializedProperties[e][t]=n},t.prototype._getIsPropertyInitialized=function(e,t){return!!this._initializedProperties[e]&&this._initializedProperties[e][t]},t.prototype._initializeProperty=function(e,t,n){var r=this;t.onItemChanged&&this.applicationContext.JsApiProvider.addItemChangedHandler((function(){t.onItemChanged()})),t.setNotifyUpdate&&this._setPropertyNotifyUpdate(e,t);var o=t.id,a=!0===t.pushToClient;if(this._setIsPropertyInitialized(e,o,!a),a)return this._getSafePropertyAccessorPromise(t).then((function(i){r._setIsPropertyInitialized(e,o,!0);var a=r._pendingPropertyRequests.filter((function(t){return t.contextId===e&&t.propertyId===o}));a.length>0&&(r._reportPropertyValue("Succesfully returned result for "+a.length+" pending properties",e,o,i,"Pending"),r._trimProcessedPropertyRequest(e,o),a.forEach((function(e){r._performSuccessCallback(e.onSuccessCallback,i)}))),(t.notifyUpdate?t.notifyUpdate:r._getPropertyNotifyUpdateFunction(e,t))(i),n.stop()})).catch((function(a){r._setIsPropertyInitialized(e,o,!0);var u=r._pendingPropertyRequests.filter((function(t){return t.contextId===e&&t.propertyId===o}));u.length>0&&(r._trimProcessedPropertyRequest(e,o),u.forEach((function(n){r._processPropertyFailure(r._getTelemetryComponentName(e,t.id,"Pending"),n.onErrorCallback,a)}))),n.stop();var c=s.ensureComponentErrorObject(a);throw r.applicationContext.EventManager.ReportComponentFailure(new i.ComponentError(r._getTelemetryComponentName(e,t.id,"InitialValue"),"Initial accessor failed. Reason: "+c.message,i.ErrorCode.GENERIC,c),[{name:l.ErrorEventParameterName.Error,value:a}]),c}))},t.prototype._extractPropertiesAccessors=function(e,t){var n=this;return this.applicationContext.EventManager.ReportTraceInfo(this.getTelemetryComponent()+".ExtractAllPropertiesAccessors","Extracting properties accessors for context "+t),e.concat(Object.keys(this._contexts[t].properties).reduce((function(e,r){var o=n._contexts[t].properties[r],i=o.dependsOnComponents&&o.dependsOnComponents.length>0,a=n.applicationContext.Performance.addStopwatch(n._getTelemetryComponentName(t,o.id,"InitialValue"));if(!i||n._isComponentsLoaded(o.dependsOnComponents)){var s=n._initializeProperty(t,o,a);s&&e.push(s)}else e.push(n._waitComponentsLoad(o.dependsOnComponents).then((function(){return n._initializeProperty(t,o,a)})));return e}),[]))},t.prototype._isComponentsLoaded=function(e){var t=this,n=!0;return e&&e.length>0&&e.forEach((function(e){n=n&&t.applicationContext.ComponentsLoader.isComponentLoaded(e)})),n},t.prototype._waitComponentsLoad=function(e){var t=this;if(e&&e.length>0){var n=[];if(e.forEach((function(e){t.applicationContext.ComponentsLoader.isComponentLoaded(e)||n.push(t.applicationContext.ComponentsLoader.ensureComponentLoaded(e))})),n.length>0)return Promise.all(n).then((function(){}))}return Promise.resolve()},t.prototype._processActionFailure=function(e,t,n){var r=this._convertToExternalContextError(e,n,"Invoke external context action failed");this.applicationContext.Bridge.performCallbackWithId(t,{error:r},!1,!0)},t.prototype._processPropertyFailure=function(e,t,n){var r=this._convertToExternalContextError(e,n,"Get external context property Failed");this.applicationContext.Bridge.performCallbackWithId(t,{error:r},!1,!0)},t.prototype._performSuccessCallback=function(e,t){this.applicationContext.Bridge.performCallbackWithId(e,{value:{value:t}},!1,!0)},t.prototype._reportTraceErrorTelemetry=function(e,t,n){var r=n?[{name:l.ErrorEventParameterName.Error,value:n}]:null;this.applicationContext.EventManager.ReportTraceError(new i.ComponentError(e,t,i.ErrorCode.GENERIC),r)},t.prototype._onBridgeLoaded=function(){var e=this,t=Object.keys(this._contexts).reduce(this._extractPropertiesAccessors.bind(this),[]);return Promise.all(t).then((function(){e.applicationContext.EventManager.ReportTraceInfo(e.getTelemetryComponent(),"All properties successfully extracted")})).catch((function(t){e._reportTraceErrorTelemetry(e.getTelemetryComponent(),"Exception happened during inital evaluation of the properties",t)}))},t.prototype._getSafePropertyAccessorPromise=function(e){try{return e.accessor()}catch(e){return Promise.reject(s.ensureComponentErrorObject(e))}},t.prototype._getSafeActionInvokerPromise=function(e,t){try{return e.invoker(t)}catch(e){return Promise.reject(s.ensureComponentErrorObject(e))}},t.prototype._getDataToReport=function(e,t){try{return t?t(e):e}catch(e){return null}},t.prototype._reportPropertyValue=function(e,t,n,r,o){var i=this._contexts[t].properties[n];this.applicationContext.EventManager.ReportComponentSuccess(this._getTelemetryComponentName(t,n,o),e,[{name:l.EventParameterName.Data,value:this._getDataToReport(r,i.serializeValue)}])},t.prototype._reportActionResult=function(e,t,n,r,o){var i=this._contexts[t].actions[n];this.applicationContext.EventManager.ReportComponentSuccess(this._getTelemetryComponentName(t,n,o),e,[{name:l.EventParameterName.Data,value:this._getDataToReport(r,i.serializeResult)}])},t.prototype._reportActionArguments=function(e,t,n,r){var o=this._contexts[e].actions[t];this.applicationContext.EventManager.ReportTraceInfo(this._getTelemetryComponentName(e,t,r),"Invoking external context Action",this._getDataToReport(n,o.serializeArguments))},t.prototype.getInitialState=function(){var e=this;return{AvailableExternalContexts:Object.keys(this._contexts).map((function(t){return{id:t,properties:Object.keys(e._contexts[t].properties),actions:Object.keys(e._contexts[t].actions)}})),KnownProperties:{}}},t.prototype.getExternalContextProperty=function(e){var t=this,n=e.callbacks,r=n.onSuccessCallback,o=n.onErrorCallback,i=e.args,a=i.externalContextId,s=i.externalContextPropertyId,l=i.args,u=this._contexts[a].properties[s];if(!this._getIsPropertyInitialized(a,s)&&!0===u.pushToClient)this._pendingPropertyRequests.push({contextId:a,propertyId:s,onSuccessCallback:r,onErrorCallback:o});else{this._externalContextDispatcherHelper.startTrackingExternalContextItemByHostActivityId(l);var c=this._getTelemetryComponentName(a,s,"GetValue"),d=this.applicationContext.Performance.addStopwatch(c),p=function(e){t._processPropertyFailure(c,o,e),d.stop(),t._externalContextDispatcherHelper.endTrackingExternalContextItemByHostActivityId(l)},f=function(){t.applicationContext.EventManager.ReportTraceInfo(c,"Requesting property"),t._getSafePropertyAccessorPromise(u).then((function(e){t._reportPropertyValue("Succesfully retrieved external context property",a,s,e,"GetValue"),t._performSuccessCallback(r,e),d.stop(),t._externalContextDispatcherHelper.endTrackingExternalContextItemByHostActivityId(l)})).catch(p)};this._isComponentsLoaded(u.dependsOnComponents)?f():this._waitComponentsLoad(u.dependsOnComponents).then(f).catch(p)}},t.prototype._getTelemetryComponentName=function(e,t,n){return this.getTelemetryComponent()+"."+e+"."+t+(n?"."+n:"")},t.prototype.invokeExternalContextAction=function(e){var t=this,n=e.callbacks,r=n.onSuccessCallback,o=n.onErrorCallback,i=e.args,a=i.externalContextId,s=i.externalContextActionId,l=i.args,u=this._contexts[a].actions[s],c=this._getTelemetryComponentName(a,s,"Invoke"),d=this.applicationContext.Performance.addStopwatch(c);this._externalContextDispatcherHelper.startTrackingExternalContextItemByHostActivityId(l);var p=function(e){t._processActionFailure(c,o,e),d.stop(),t._externalContextDispatcherHelper.endTrackingExternalContextItemByHostActivityId(l)},f=function(){t._reportActionArguments(a,s,l,"Invoke"),t._getSafeActionInvokerPromise(u,l).then((function(e){t._reportActionResult("Successfully invoked external context action",a,s,e,"Invoke"),t._performSuccessCallback(r,e),d.stop(),t._externalContextDispatcherHelper.endTrackingExternalContextItemByHostActivityId(l)})).catch(p)};this._isComponentsLoaded(u.dependsOnComponents)?f():this._waitComponentsLoad(u.dependsOnComponents).then(f).catch(p)},t.prototype.registerMethods=function(){this.registerMethodWithName("getExternalContextProperty",this.getExternalContextProperty,{externalContextId:"string",externalContextPropertyId:"string",args:{}},{onSuccessCallback:"",onErrorCallback:""}),this.registerMethodWithName("invokeExternalContextAction",this.invokeExternalContextAction,{externalContextId:"",externalContextActionId:"",args:{}},{onSuccessCallback:"",onErrorCallback:""})},t}(c.default);t.default=p}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(87)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){var r,o=n.default(e,t);return(r={})[o.id]=o,r}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(150),n(151),n(153),n(157),n(158),n(159),n(160),n(161),n(162),n(163),n(164),n(167),n(168),n(171)],void 0===(o=function(e,t,n,r,o,i,a,s,l,u,c,d,p,f,_,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=[i.default,c.default,p.default,_.default,u.default,n.default,r.default,f.default,o.default,d.default,a.default,s.default,l.default,h.default]}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(1),n(4),n(0)],void 0===(o=function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="MailApp.ExternalContext.Actions.AddAttachments";t.default=function(e,t,s){return{id:n.ActionNames.ADD_ATTACHMENTS,invoker:function(e){var n=null;try{n=JSON.parse(e.attachments)}catch(n){return t.EventManager.ReportComponentFailure(new r.ComponentError(a,"Failed to parse 'attachments' JSON",r.ErrorCode.JSON_PARSE_FAILURE),[{name:o.ErrorEventParameterName.Error,value:n.message},{name:o.EventParameterName.Data,value:e.attachments}]),Promise.reject(null)}return n&&Array.isArray(n)&&0!==n.length?Promise.all(n.map((function(e){var n=e.name,r=e.url;return t.JsApiProvider.addFileAttachment(r,n)}))):(t.EventManager.ReportComponentFailure(new r.ComponentError(a,"Attachments array is empty",r.ErrorCode.GENERIC)),Promise.reject(null))},serializeArguments:function(e){var t=JSON.parse(e.attachments);if(!t||!Array.isArray(t)||0===t.length)return t.map((function(e){return e.url}))},dependsOnComponents:[i.default.JS_API_PROVIDER]}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(20),n(10),n(21),n(0),n(1)],void 0===(o=function(e,t,n,r,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,l){return{id:n.ActionNames.FOLLOW,invoker:function(e){var n=e.crmId;if(!n)return t.EventManager.ReportComponentFailure(new s.ComponentError("MailApp.ExternalContext.Actions.Follow",'Input arguments exception: "crmId" should be provided',s.ErrorCode.GENERIC)),Promise.reject(null);var a=t.JsApiProvider.getMailboxItemType(),l=[new r.default(i.default.ID,o.default.String,n,a),new r.default(i.default.IS_FOLLOWED,o.default.Integer,1..toString(),a)];return t.ExchangeProvider.MailboxItemProvider.setProperties(l)},dependsOnComponents:[a.default.EXCHANGE_PROVIDER]}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.APPEND_TO_ITEM_FIELD="AppendToItemField",e.SET_ITEM_FIELD="SetItemField",e.DELETE_ITEM_FIELD="DeleteItemField",e}();t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(1),n(2),n(66),n(5)],void 0===(o=function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,a){return{id:r.ActionNames.GET_EMAIL_LINKS,invoker:function(e){var r=e.crmId;return r?o.getUniqueHrefs(t,r):(t.EventManager.ReportComponentFailure(new n.ComponentError("MailApp.ExternalContext.Actions.GetEmailLinks",'Input arguments exception: "crmId" should be provided',n.ErrorCode.GENERIC)),Promise.reject(null))},serializeResult:i.default.restrictedValue}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){};t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NoEnd=1]="NoEnd",e[e.Numbered=2]="Numbered",e[e.EndDate=3]="EndDate"}(n||(n={})),t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Daily=0]="Daily",e[e.Weekly=1]="Weekly",e[e.Monthly=2]="Monthly",e[e.Yearly=3]="Yearly"}(n||(n={})),t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(2),n(0),n(5)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,i){return{id:n.ActionNames.INSERT_BODY,invoker:function(e){var n=e.value;return n?t.JsApiProvider.prependBody(n):(t.EventManager.ReportTraceInfo("MailApp.ExternalContext.Actions.InsertBody","Nothing to insert message/appointment body.",e),Promise.resolve())},dependsOnComponents:[r.default.JS_API_PROVIDER],serializeResult:o.default.restrictedValue,serializeArguments:o.default.restrictedValue}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(66),n(0),n(5),n(1)],void 0===(o=function(e,t,n,r,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,s){return{id:n.ActionNames.REMOVE_TRACKING_INFO,invoker:function(e){var n=e.crmId;return n?r.removeTrackingInfo(t,n):(t.EventManager.ReportComponentFailure(new a.ComponentError("MailApp.ExternalContext.Actions.RemoveTrackingInfo",'Input arguments exception: "crmId" should be provided',a.ErrorCode.GENERIC)),Promise.reject(null))},dependsOnComponents:[o.default.JS_API_PROVIDER],serializeResult:i.default.restrictedValue}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(0),n(5),n(1)],void 0===(o=function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,a){return{id:n.ActionNames.RESOLVE_RECIPIENT_FROM_SCRATCH,invoker:function(e){var r=e.emailAddress;return r?t.CRMProvider.forceResolveRecipient(r).then((function(){a.properties[n.PropertyNames.RESOLVED_RECIPIENTS].notifyUpdate()})):(t.EventManager.ReportComponentFailure(new i.ComponentError("MailApp.ExternalContext.Actions.ResolveRecipients",'Input arguments exception: "emailAddress" should be provided',i.ErrorCode.GENERIC)),Promise.reject(null))},dependsOnComponents:[r.default.CRM_PROVIDER],serializeResult:o.default.restrictedValue,serializeArguments:o.default.restrictedValue}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(0),n(21),n(10),n(20),n(2),n(5)],void 0===(o=function(e,t,n,r,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,l){return{id:a.ActionNames.RETRY_TRACK,invoker:function(){var e=t.JsApiProvider.getMailboxItemType(),n=(new Date).toISOString(),s=[new i.default(r.default.TRACK_TIMESTAMP,o.default.String,n,e)];return t.ExchangeProvider.MailboxItemProvider.setProperties(s).then((function(){return l.properties[a.PropertyNames.TRACK_STATUS].accessor()}))},serializeResult:s.default.serializeTrackStatus,dependsOnComponents:[n.default.EXCHANGE_PROVIDER]}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(0),n(90),n(68),n(5),n(1)],void 0===(o=function(e,t,n,r,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l="MailApp.ExternalContext.Actions.SetSelectedRecipient";t.default=function(e,t,u){return{id:n.ActionNames.SET_SELECTED_RECIPIENT,invoker:function(e){var r=e.selectedRecipient;if(!r)return t.EventManager.ReportComponentFailure(new s.ComponentError(l,'Input arguments exception: "selectedRecipient" should be provided',s.ErrorCode.GENERIC)),Promise.reject(null);var a=t.JsApiProvider.getMailboxItemId().then((function(e){if(!e)return t.EventManager.ReportTraceError(new s.ComponentError(l,"Unable to set selected recipients because of empty item id",s.ErrorCode.GENERIC)),Promise.resolve();var n=o.default.deserialize(t.JsApiProvider.getRoamingSettingsItem(i.RoamingSettingKeys.selectedRecipientKey));return n.add(e,r),t.JsApiProvider.setRoamingSettingsItem(i.RoamingSettingKeys.selectedRecipientKey,n),t.JsApiProvider.saveRoamingSettingsAsync()}));return u.properties[n.PropertyNames.SELECTED_RECIPIENT].notifyUpdate(a.then((function(){return r}))),a},serializeResult:a.default.restrictedValue,serializeArguments:a.default.restrictedValue,dependsOnComponents:[r.default.EXCHANGE_PROVIDER]}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(0),n(5),n(1)],void 0===(o=function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,a){return{id:n.ActionNames.SET_SUBJECT,invoker:function(e){var n=e.value;return null==n?(t.EventManager.ReportComponentFailure(new i.ComponentError("MailApp.ExternalContext.Actions.SetSubject",'Input arguments exception: "value" should be provided',i.ErrorCode.GENERIC)),Promise.reject(null)):t.JsApiProvider.setSubject(n)},serializeResult:o.default.restrictedValue,serializeArguments:o.default.restrictedValue,dependsOnComponents:[r.default.JS_API_PROVIDER]}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(66),n(1),n(4),n(0)],void 0===(o=function(e,t,n,r,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s="MailApp.ExternalContext.Actions.SetTrackingInfo";t.default=function(e,t,l){return{id:n.ActionNames.SET_TRACKING_INFO,invoker:function(e){var n=e.crmId,a=e.emailTrackingPixelUrl,l=e.emailLinkTrackingUrlPairsJSON;if(!n||!a)return t.EventManager.ReportComponentFailure(new o.ComponentError(s,'Input arguments exception: Both "crmId" and "emailTrackingPixelUrl" should be provided',o.ErrorCode.GENERIC),[{name:i.EventParameterName.Data,value:e}]),Promise.reject(null);var u=null;try{u=JSON.parse(l)}catch(e){return t.EventManager.ReportComponentFailure(new o.ComponentError(s,"Failed to parse JSON of emailLinkTrackingUrlPairsJSON",o.ErrorCode.JSON_PARSE_FAILURE),[{name:i.ErrorEventParameterName.Error,value:e}]),Promise.reject(null)}return r.setTrackingInfo(t,n,a,u)},serializeArgument:function(e){return{crmId:e.crmId,emailTrackingPixelUrl:e.emailTrackingPixelUrl}},dependsOnComponents:[a.default.JS_API_PROVIDER]}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(0),n(4),n(69),n(16),n(165),n(166),n(2),n(5),n(1),n(45),n(9)],void 0===(o=function(e,t,n,r,o,i,a,s,l,u,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,f){return{id:l.ActionNames.TRACK,invoker:function(e){var n=e.id,u=e.entityType,_=e.name,h=e.trackingState,m=e.isTrackingStateUpdate;if(null==h)return t.EventManager.ReportComponentFailure(new c.ComponentError("MailApp.ExternalContext.Actions.Track",'Input arguments exception: "trackingState" should be provided',c.ErrorCode.GENERIC)),Promise.reject(null);if((!n||!u)&&(n||u))return t.EventManager.ReportComponentFailure(new c.ComponentError("MailApp.ExternalContext.Actions.Track",'You must provide both "id" and "entityType" parameters',c.ErrorCode.GENERIC),[{name:r.EventParameterName.Data,value:e}]),Promise.reject(null);if(m){var v=new o.default;return v.CrmId=e.crmId,v.CrmRegardingObjectId=n,v.CrmRegardingObjectName=_,v.CrmRegardingObjectType=u,v.CrmTrackingState=h,h===i.default.InProgress?t.ExchangeProvider.MailboxItemProvider.setPropertiesPending&&t.ExchangeProvider.MailboxItemProvider.setPropertiesPending(l.ActionNames.TRACK):t.ExchangeProvider.MailboxItemProvider.clearPropertiesPending&&t.ExchangeProvider.MailboxItemProvider.clearPropertiesPending(),f.properties[l.PropertyNames.TRACK_STATUS].notifyUpdate(v),Promise.resolve(null)}return t.CRMProvider.isFeatureControlBitEnabled(p.FcbNames.MailAppEnableCategoriesAPI).then((function(r){return r?s.default(t,f,h,n,u,_,e.crmId).then((function(e){return d.default(t,f,e,l.ActionNames.TRACK,s.categoriesFallback)})):h!==i.default.IsLinked?a.default(t,f,h,n,u,_,e.crmId,null):t.CRMProvider.isCategoryTrackingEnabled().then((function(r){return a.default(t,f,h,n,u,_,e.crmId,r)}))}))},serializeArguments:function(e){var t=Object.assign({},e);return t.name=u.default.restrictedValue(),t},serializeResult:u.default.serializeTrackStatus,dependsOnComponents:[n.default.JS_API_PROVIDER,n.default.CRM_PROVIDER,n.default.EXCHANGE_PROVIDER]}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(25),n(30),n(21),n(18),n(11),n(10),n(16),n(20),n(41),n(2)],void 0===(o=function(e,t,n,r,o,i,a,s,l,u,c,d){"use strict";function p(e,t,p,f,_,h,m,v,E){var g,C,y=e.JsApiProvider.getMailboxItemType(),I=(new Date).toISOString(),T=(g=p.CrmTrackingState,(C=f)===l.default.WillBeLinked&&g===l.default.IsLinked?l.default.IsLinked:C),A=[new u.default(o.default.TRACKING_STATE,s.default.Double,T.toString(),y),new u.default(o.default.REGARDING_OBJECT_TYPE,s.default.String,h?h.toString():"",y),new u.default(o.default.REGARDING_ID,s.default.String,_||"",y),new u.default(o.default.REGARDING_OBJECT_NAME,s.default.String,m||"",y),new u.default(o.default.IS_TRACKED_FROM_MAILAPP,s.default.Integer,"1",y),new u.default(o.default.TRACK_TIMESTAMP,s.default.String,I,y)];E&&(A.push(new c.default(r.default.CATEGORIES,s.default.Item,E,y)),A.push(new u.default(o.default.CRM_CATEGORY_TRACKER,s.default.Integer,i.default.IsLinked.toString(),y))),v&&(v=n.default.fromExternalGuid(v).guid,A.push(new u.default(o.default.ID,s.default.String,v,y)));var P=f===l.default.IsLinked?"0":"1";return A.push(new u.default(o.default.TRACKING_STATE_TRACKER,s.default.Integer,P,y)),f===l.default.IsLinked&&y===a.default[a.default.appointment]&&A.push(new u.default(o.default.SSS_PROMOTE_TRACKER,s.default.Integer,"1",y)),e.ExchangeProvider.MailboxItemProvider.setProperties(A).then((function(){return t.properties[d.PropertyNames.TRACK_STATUS].accessor()}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,o,i,a,s){return s?Promise.all([e.ExchangeProvider.MailboxItemProvider.retrieveTrackStatus(),e.ExchangeProvider.MailboxItemProvider.retrieveMailboxItem(),e.CRMProvider.getMailboxTrackingCategoryName()]).then((function(s){var l=s[0],u=s[1],c=s[2],d=u.Categories?u.Categories:[],f=null;return c&&-1===d.indexOf(c)&&(f=d.concat([c])),p(e,t,l,n,r,o,i,a,f)})):e.ExchangeProvider.MailboxItemProvider.retrieveTrackStatus().then((function(s){return p(e,t,s,n,r,o,i,a,null)}))}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(25),n(30),n(21),n(18),n(11),n(10),n(16),n(20),n(41),n(7),n(45)],void 0===(o=function(e,t,n,r,o,i,a,s,l,u,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.categoriesFallback=function(e,t){var n=e.filter((function(e){return e.propertyName!==r.default.CATEGORIES}));return d.default.assignUpdates(n,[new u.default(o.default.CRM_CATEGORY_TRACKER,s.default.Integer,i.default.NotLinked.toString(),t)],p.comparePropertyUpdate)},t.default=function(e,t,f,_,h,m,v){return function(e,t){return e.CRMProvider.isCategoryTrackingEnabled().then((function(n){var r=[e.ExchangeProvider.MailboxItemProvider.retrieveTrackStatus()];return n&&t===l.default.IsLinked&&r.push(e.ExchangeProvider.MailboxItemProvider.retrieveMailboxItem(),e.CRMProvider.getMailboxTrackingCategoryName()),Promise.all(r).then((function(e){var t=e[0],n=e[1],r=e[2];return[t,n&&function(e,t){void 0===e&&(e=[]);var n=null;t&&-1===e.indexOf(t)&&(n=e.concat([t]));return n}(n.Categories,r)]}))}))}(e,f).then((function(t){var E=t[0],g=t[1],C=e.JsApiProvider.getMailboxItemType(),y=function(e,t,r,i,c,d,p,f,_){var h=(new Date).toISOString(),m=(g=i.CrmTrackingState,C=c,C===l.default.WillBeLinked&&g===l.default.IsLinked?l.default.IsLinked:C),v=c===l.default.IsLinked?"0":"1",E=[new u.default(o.default.TRACKING_STATE,s.default.Double,m.toString(),r),new u.default(o.default.REGARDING_OBJECT_TYPE,s.default.String,p?p.toString():"",r),new u.default(o.default.REGARDING_ID,s.default.String,d||"",r),new u.default(o.default.REGARDING_OBJECT_NAME,s.default.String,f||"",r),new u.default(o.default.IS_TRACKED_FROM_MAILAPP,s.default.Integer,"1",r),new u.default(o.default.TRACK_TIMESTAMP,s.default.String,h,r),new u.default(o.default.TRACKING_STATE_TRACKER,s.default.Integer,v,r)];var g,C;_&&(_=n.default.fromExternalGuid(_).guid,E.push(new u.default(o.default.ID,s.default.String,_,r)));c===l.default.IsLinked&&r===a.default[a.default.appointment]&&E.push(new u.default(o.default.SSS_PROMOTE_TRACKER,s.default.Integer,"1",r));return E}(0,0,C,E,f,_,h,m,v);if(g){var I=function(e,t){return[new c.default(r.default.CATEGORIES,s.default.Item,e,t),new u.default(o.default.CRM_CATEGORY_TRACKER,s.default.Integer,i.default.IsLinked.toString(),t)]}(g,C);return d.default.assignUpdates(y,I,p.comparePropertyUpdate)}return y}))}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(21),n(10),n(20),n(2),n(0)],void 0===(o=function(e,t,n,r,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,s){return{id:i.ActionNames.UNFOLLOW,invoker:function(){var e=t.JsApiProvider.getMailboxItemType(),i=[new o.default(n.default.ID,r.default.String,"",e),new o.default(n.default.IS_FOLLOWED,r.default.Integer,(0).toString(),e)];return t.ExchangeProvider.MailboxItemProvider.setProperties(i)},dependsOnComponents:[a.default.EXCHANGE_PROVIDER]}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(0),n(169),n(170),n(2),n(1),n(5),n(45),n(9)],void 0===(o=function(e,t,n,r,o,i,a,s,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,c){return{id:i.ActionNames.UNTRACK,invoker:function(e){var n=e.trackingState;return null==n?Promise.reject(new a.ComponentError("MailApp.ExternalContext.Actions.Untrack",'Input arguments exception: "trackingState" should be provided',a.ErrorCode.GENERIC)):t.CRMProvider.isFeatureControlBitEnabled(u.FcbNames.MailAppEnableCategoriesAPI).then((function(e){return e?o.default(t,c,n).then((function(e){return l.default(t,c,e,i.ActionNames.UNTRACK,o.categoriesFallback)})):t.CRMProvider.isCategoryTrackingEnabled().then((function(e){return r.default(t,c,n,e)}))}))},serializeResult:s.default.serializeTrackStatus,dependsOnComponents:[n.default.JS_API_PROVIDER,n.default.CRM_PROVIDER]}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(30),n(21),n(18),n(10),n(16),n(20),n(41),n(2)],void 0===(o=function(e,t,n,r,o,i,a,s,l,u){"use strict";function c(e,t,c,d,p){void 0===p&&(p=!1);var f=e.JsApiProvider.getMailboxItemType(),_=(new Date).toISOString(),h=[new s.default(r.default.TRACKING_STATE,i.default.Double,c.toString(),f),new s.default(r.default.REGARDING_OBJECT_TYPE,i.default.String,"",f),new s.default(r.default.REGARDING_ID,i.default.String,"",f),new s.default(r.default.REGARDING_OBJECT_NAME,i.default.String,"",f),new s.default(r.default.TRACK_TIMESTAMP,i.default.String,_,f)];d&&h.push(new l.default(n.default.CATEGORIES,i.default.Item,d,f)),p&&h.push(new s.default(r.default.CRM_CATEGORY_TRACKER,i.default.Integer,o.default.NotLinked.toString(),f)),c===a.default.NotLinked&&h.push(new s.default(r.default.ID,i.default.String,"",f));var m=c===a.default.NotLinked?"0":"1";return h.push(new s.default(r.default.TRACKING_STATE_TRACKER,i.default.Integer,m,f)),e.ExchangeProvider.MailboxItemProvider.setProperties(h).then((function(){return t.properties[u.PropertyNames.TRACK_STATUS].accessor()}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r){return r?Promise.all([e.CRMProvider.getMailboxTrackingCategoryName(),e.ExchangeProvider.MailboxItemProvider.retrieveMailboxItem(),e.ExchangeProvider.MailboxItemProvider.retrieveTrackStatus()]).then((function(r){var o=r[0],i=r[1],a=r[2],s=[].concat(i.Categories),l=s.indexOf(o);-1!==l&&s.splice(l,1);var u=void 0!==a.CrmCategoryTracker;return c(e,t,n,s,u)})):c(e,t,n,null)}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(30),n(21),n(18),n(10),n(16),n(20),n(41),n(7),n(45)],void 0===(o=function(e,t,n,r,o,i,a,s,l,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.categoriesFallback=function(e,t){var o=e.find((function(e){return e.propertyName===r.default.TRACKING_STATE})),l=e.filter((function(e){return-1===[n.default.CATEGORIES,r.default.CRM_CATEGORY_TRACKER].indexOf(e.propertyName)})),d=o.propertyValue===a.default.NotLinked.toString()?new s.default(r.default.TRACKING_STATE,i.default.Integer,a.default.WillBeUnlinked.toString(),t):new s.default(r.default.TRACKING_STATE_TRACKER,i.default.Integer,"0",t);return u.default.assignUpdates(l,[d],c.comparePropertyUpdate)},t.default=function(e,t,d){return function(e){return e.CRMProvider.isCategoryTrackingEnabled().then((function(t){var n=[];return t&&n.push(e.ExchangeProvider.MailboxItemProvider.retrieveTrackStatus(),e.ExchangeProvider.MailboxItemProvider.retrieveMailboxItem(),e.CRMProvider.getMailboxTrackingCategoryName()),Promise.all(n).then((function(e){var t=e[0],n=e[1],r=e[2];return[t,n&&function(e,t){void 0===e&&(e=[]);var n=Array.from(e),r=n.indexOf(t);-1!==r&&n.splice(r,1);return n}(n.Categories,r)]}))}))}(e).then((function(t){var p=t[0],f=t[1],_=e.JsApiProvider.getMailboxItemType(),h=function(e,t){var n=(new Date).toISOString(),o=t===a.default.NotLinked?"0":"1",l=[new s.default(r.default.TRACKING_STATE,i.default.Double,t.toString(),e),new s.default(r.default.REGARDING_OBJECT_TYPE,i.default.String,"",e),new s.default(r.default.REGARDING_ID,i.default.String,"",e),new s.default(r.default.REGARDING_OBJECT_NAME,i.default.String,"",e),new s.default(r.default.TRACK_TIMESTAMP,i.default.String,n,e),new s.default(r.default.TRACKING_STATE_TRACKER,i.default.Integer,o,e)];t===a.default.NotLinked&&l.push(new s.default(r.default.ID,i.default.String,"",e));return l}(_,d);if(f){var m=function(e,t,a){var u=[new l.default(n.default.CATEGORIES,i.default.Item,e,t)];void 0!==a.CrmCategoryTracker&&u.push(new s.default(r.default.CRM_CATEGORY_TRACKER,i.default.Integer,o.default.NotLinked.toString(),t));return u}(f,_,p);return u.default.assignUpdates(h,m,c.comparePropertyUpdate)}return h}))}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(1)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="MailApp.ExternalContext.Actions.AppCheckerTask";t.default=function(e,t,i){return{id:n.ActionNames.OPEN_APPCHECKER,invoker:function(e){try{t.EventManager.ReportTraceInfo(o,"Open outlook checker from see why Link");var n=e.openDiagnosticsPage;return t.AppChecker.toggle(n),Promise.resolve()}catch(e){var i=new r.ComponentError(o,"Failed to open appChecker via external context action",r.ErrorCode.GENERIC,e);return Promise.reject(i)}}}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(173),n(174),n(175),n(176),n(177),n(178),n(179),n(180),n(181),n(182),n(183),n(184),n(185),n(186),n(187),n(188),n(189),n(190),n(191),n(192),n(193),n(195),n(197),n(198),n(199),n(200),n(201)],void 0===(o=function(e,t,n,r,o,i,a,s,l,u,c,d,p,f,_,h,m,v,E,g,C,y,I,T,A,P,S,R,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=[o.default,r.default,y.default,a.default,m.default,T.default,u.default,p.default,f.default,_.default,h.default,d.default,c.default,s.default,C.default,n.default,v.default,i.default,E.default,l.default,A.default,I.default,P.default,S.default,g.default,R.default,b.default]}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(11),n(1),n(0)],void 0===(o=function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="MailApp.ExternalContext.Property.AttachmentIds";t.default=function(e,t){return{id:n.PropertyNames.ATTACHMENT_IDS,accessor:function(){try{var e=t.JsApiProvider.getMailboxItemType();if(e===r.default[r.default.message])return t.JsApiProvider.getMessageAttachmentIds();if(e===r.default[r.default.appointment])return t.ExchangeProvider.MailboxItemProvider.getAttachmentIds();var n="Attachments ids retrieval is not supported for "+e+" item type.";return t.EventManager.ReportTraceWarning(a,n),Promise.reject(new o.ComponentError(a,n,o.ErrorCode.GENERIC))}catch(e){return Promise.reject(e)}},dependsOnComponents:[i.default.JS_API_PROVIDER,i.default.EXCHANGE_PROVIDER]}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(0),n(5)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:n.PropertyNames.EWS_TOKEN,accessor:function(){return t.JsApiProvider.getEwsToken()},dependsOnComponents:[r.default.JS_API_PROVIDER],serializeValue:o.default.restrictedValue}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(0)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:n.PropertyNames.EWS_URL,accessor:function(){return Promise.resolve(t.JsApiProvider.getEwsUrl())},pushToClient:!0,dependsOnComponents:[r.default.JS_API_PROVIDER]}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(91),n(0),n(5)],void 0===(o=function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:n.PropertyNames.HTML_BODY,accessor:function(){return t.JsApiProvider.getBody(r.default.Html)},dependsOnComponents:[o.default.JS_API_PROVIDER],serializeValue:i.default.restrictedValue}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(0)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:n.PropertyNames.IS_COMPOSE_MODE,accessor:function(){return Promise.resolve(t.JsApiProvider.isComposeMode())},pushToClient:!0,dependsOnComponents:[r.default.JS_API_PROVIDER]}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(28),n(0)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:n.PropertyNames.IS_DELEGATED_MAILBOX,accessor:function(){return Promise.all([t.JsApiProvider.isDelegatedMailbox(),t.CRMProvider.isOrgSettingEnabled(r.DelegateAccessEnabled)]).then((function(e){var t=e[0],n=e[1];return t&&n}))},pushToClient:!1,dependsOnComponents:[o.default.JS_API_PROVIDER,o.default.CRM_PROVIDER]}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(0)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:n.PropertyNames.IS_DESKTOP_OUTLOOK,accessor:function(){return Promise.resolve(t.JsApiProvider.getIsDesktopOutlook())},pushToClient:!0,dependsOnComponents:[r.default.JS_API_PROVIDER]}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(0),n(92)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:n.PropertyNames.IS_ORGANIZER_RESOLVED_AS_USER,accessor:function(){return t.CRMProvider.resolveRecipients().then((function(e){var t=e.recipients;return o.default(t)}))},dependsOnComponents:[r.default.CRM_PROVIDER]}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(0),n(5)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){var i={id:n.PropertyNames.IS_SENT,accessor:function(){return t.JsApiProvider.isSent()},pushToClient:!0,updateOnItemChanged:!0,setNotifyUpdate:function(e){o.default.defaultSetNotifyUpdate(i,e)},dependsOnComponents:[r.default.JS_API_PROVIDER]};return i}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(0)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:n.PropertyNames.ITEM_TYPE,accessor:function(){return Promise.resolve(t.JsApiProvider.getMailboxItemType())},pushToClient:!0,dependsOnComponents:[r.default.JS_API_PROVIDER]}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(5),n(0)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){var i=!1,a={id:n.PropertyNames.MAILBOX_ITEM,accessor:function(){return t.ExchangeProvider.MailboxItemProvider.retrieveMailboxItem()},onItemChanged:function(){a.notifyUpdate(new Promise((function(){}))),i=!0},setNotifyUpdate:function(e){r.default.defaultSetNotifyUpdate(a,e),t.ExchangeProvider.MailboxItemProvider.addItemChangedListener((function(t){(t.isMailboxItemUpdated||i)&&(e(Promise.resolve(t.mailboxItem)),i=!1)}))},pushToClient:!0,dependsOnComponents:[o.default.EXCHANGE_PROVIDER],serializeValue:r.default.serializeMailboxItem};return a}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(0),n(5)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:n.PropertyNames.MAILBOX_ITEM_FROM_SERVER,accessor:function(){return t.ExchangeProvider.MailboxItemProvider.retrieveMailboxItem()},dependsOnComponents:[r.default.EXCHANGE_PROVIDER],serializeValue:o.default.serializeMailboxItem}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(44),n(2),n(5),n(0)],void 0===(o=function(e,t,n,r,o,i){"use strict";function a(e,t){return!e&&!t||!(!e&&t||e&&!t)&&(n.default.areEmailAddressDetailsEqual(e.sender,t.sender)&&n.default.areEmailAddressDetailsEqual(e.organizer,t.organizer)&&n.default.areEmailAddressDetailsArraysEqual(e.optionalAttendees,t.optionalAttendees)&&n.default.areEmailAddressDetailsArraysEqual(e.requiredAttendees,t.requiredAttendees))}function s(e){return{sender:n.default.cloneEmailAddressDetails(e.sender),organizer:n.default.cloneEmailAddressDetails(e.organizer),optionalAttendees:e.optionalAttendees&&n.default.cloneEmailAddressDetailsArray(e.optionalAttendees),requiredAttendees:e.requiredAttendees&&n.default.cloneEmailAddressDetailsArray(e.requiredAttendees)}}Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){if(!t.JsApiProvider.isAppointment())return null;var n={id:r.PropertyNames.MEETING_ATTENDEES,accessor:function(){return t.JsApiProvider.getMeetingAttendees()},pushToClient:!0,updateOnItemChanged:!0,dependsOnComponents:[i.default.JS_API_PROVIDER],serializeValue:function(e){return{sender:o.default.serializeEmailAddressDetails(e.sender),organizer:o.default.serializeEmailAddressDetails(e.organizer),optionalAttendees:e.optionalAttendees?e.optionalAttendees.map(o.default.serializeEmailAddressDetails):null,requiredAttendees:e.requiredAttendees?e.requiredAttendees.map(o.default.serializeEmailAddressDetails):null}}};return n.setNotifyUpdate=o.default.createRecipientsPollingFunction(n,t,s,a),n}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(5),n(0)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return t.JsApiProvider.isAppointment()?{id:n.PropertyNames.ROOM_MAILBOXES,accessor:function(){return t.JsApiProvider.getRoomMailboxes().catch((function(){return[]}))},pushToClient:!0,updateOnItemChanged:!0,dependsOnComponents:[o.default.JS_API_PROVIDER],serializeValue:function(e){return void 0===e&&(e=[]),e.map(r.default.serializeEmailAddressDetails)}}:null}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(44),n(2),n(5),n(0)],void 0===(o=function(e,t,n,r,o,i){"use strict";function a(e,t){return!e&&!t||!(!e&&t||e&&!t)&&(n.default.areEmailAddressDetailsEqual(e.sender,t.sender)&&n.default.areEmailAddressDetailsArraysEqual(e.to,t.to)&&n.default.areEmailAddressDetailsArraysEqual(e.cc,t.cc)&&n.default.areEmailAddressDetailsArraysEqual(e.bcc,t.bcc))}function s(e){var t=function(e){return e.map((function(e){return e&&{emailAddress:e.emailAddress,displayName:e.displayName,recipientType:e.recipientType}}))};return{sender:e.sender&&{emailAddress:e.sender.emailAddress,displayName:e.sender.displayName,recipientType:e.sender.recipientType},to:e.to&&t(e.to),cc:e.cc&&t(e.cc),bcc:e.bcc&&t(e.bcc)}}Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){if(!t.JsApiProvider.isMessage())return null;var n={id:r.PropertyNames.MESSAGE_RECIPIENTS,accessor:function(){return t.JsApiProvider.getMessageRecipients()},pushToClient:!0,updateOnItemChanged:!0,dependsOnComponents:[i.default.JS_API_PROVIDER],serializeValue:function(e){return{sender:o.default.serializeEmailAddressDetails(e.sender),to:e.to?e.to.map(o.default.serializeEmailAddressDetails):null,cc:e.cc?e.cc.map(o.default.serializeEmailAddressDetails):null,bcc:e.bcc?e.bcc.map(o.default.serializeEmailAddressDetails):null}}};return n.setNotifyUpdate=o.default.createRecipientsPollingFunction(n,t,s,a),n}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(91),n(0),n(5)],void 0===(o=function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:n.PropertyNames.PLAIN_BODY,accessor:function(){return t.JsApiProvider.getBody(r.default.Text)},dependsOnComponents:[o.default.JS_API_PROVIDER],serializeValue:i.default.restrictedValue}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(0),n(6)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){var i=r.default.DISPATCHER+"."+o.default.EXTERNAL_CONTEXT+".Property."+n.PropertyNames.RECEIVED_ON;return{id:n.PropertyNames.RECEIVED_ON,accessor:function(){return t.ExchangeProvider.MailboxItemProvider.retrieveMailboxItem().then((function(e){var n=e.DateTimeReceived;if(n)return n;var r=t.JsApiProvider.getMailboxItem(),o=r&&r.dateTimeCreated;return t.EventManager.ReportTraceWarning(i,"Couldn't get DateTimeReceived property from exchange, fallback to dateTimeCreated property from OfficeJs",{dateTimeCreated:o}),o}))},dependsOnComponents:[r.default.JS_API_PROVIDER]}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(5),n(87),n(2),n(0)],void 0===(o=function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){var a={id:o.PropertyNames.RESOLVED_RECIPIENTS,accessor:function(){return t.CRMProvider.resolveRecipients().then((function(e){return{isNewMailboxItem:!1,recipients:e.recipients}}))},pushToClient:!0,dependsOnProperties:[{contextId:r.MAIL_CONTEXT,propertyId:o.PropertyNames.MESSAGE_RECIPIENTS},{contextId:r.MAIL_CONTEXT,propertyId:o.PropertyNames.MEETING_ATTENDEES}],setNotifyUpdate:function(e){n.default.defaultSetNotifyUpdate(a,e)},onDependentProperyUpdate:function(){t.CRMProvider.resolveRecipients().then((function(e){e&&e.isChanged&&a.notifyUpdate({isNewMailboxItem:!1,recipients:e.recipients})})).catch((function(e){a.notifyUpdate(Promise.reject(e),!0)}))},serializeValue:function(e){return{isNewMailboxItem:e.isNewMailboxItem,recipients:e.recipients?e.recipients.map(n.default.serializeRecipientRecord):null}},dependsOnComponents:[i.default.CRM_PROVIDER,i.default.JS_API_PROVIDER]};return a}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(5),n(0),n(90),n(68)],void 0===(o=function(e,t,n,r,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){var s={id:n.PropertyNames.SELECTED_RECIPIENT,accessor:function(){return t.JsApiProvider.getMailboxItemId().then((function(e){var n=t.JsApiProvider.getRoamingSettingsItem(a.RoamingSettingKeys.selectedRecipientKey);return i.default.deserialize(n).getEmail(e)}))},pushToClient:!0,updateOnItemChanged:!0,setNotifyUpdate:function(e){r.default.defaultSetNotifyUpdate(s,e)},dependsOnComponents:[o.default.JS_API_PROVIDER,o.default.EXCHANGE_PROVIDER],serializeValue:r.default.restrictedValue};return s}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(0),n(5)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:n.PropertyNames.SUBJECT,accessor:function(){return t.JsApiProvider.getSubject()},dependsOnComponents:[r.default.JS_API_PROVIDER],serializeValue:o.default.restrictedValue}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(82),n(28),n(93),n(11),n(5),n(92),n(2),n(194),n(0)],void 0===(o=function(e,t,n,r,o,i,a,s,l,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){var d={id:l.PropertyNames.TRACK_ALLOWED_STATUS,accessor:function(){return Promise.all([t.ExchangeProvider.MailboxItemProvider.retrieveMailboxItem(),t.CRMProvider.isLimitedMode(),t.CRMProvider.isOrgSettingEnabled(r.EmailInReadModeTrackEnabled)]).then((function(a){var l=a[0],c=a[1],d=a[2],p=i.default[t.JsApiProvider.getMailboxItemType()];if(c&&(!n.isTrackAllowedInLimitedMode(p,e.mode)||!d))return u.default.ForbiddenInLimitedMode;return p===i.default.message?function(e){return e.ItemClass&&-1!==e.ItemClass.indexOf("IPM.Schedule")?"IPM.Schedule.Meeting.Request"===e.ItemClass?u.default.ForbiddenMeetingInviteRequest:u.default.ForbiddenMeetingInviteResponse:u.default.Allowed}(l):p===i.default.appointment?function(e,t){return t.CalendarItemType===o.default[o.default.Occurrence]?Promise.resolve(u.default.ForbiddenOccurence):t.CalendarItemType===o.default[o.default.Exception]?Promise.resolve(u.default.ForbiddenException):Promise.all([e.CRMProvider.resolveRecipients(),e.CRMProvider.isOrgSettingEnabled(r.TrackAppointmentsFromNonOrganizer),e.CRMProvider.isOrgSettingEnabled(r.DelegateAccessEnabled),e.JsApiProvider.isDelegatedMailbox()]).then((function(e){var t=e[0].recipients,n=e[1],r=e[2],o=e[3];return n?u.default.Allowed:r&&o?u.default.Allowed:s.default(t)?u.default.ForbiddenForOrganizerResolvedAsUser:u.default.Allowed}))}(t,l):void 0}))},pushToClient:!0,onItemChanged:function(){d.notifyUpdate(new Promise((function(){})))},setNotifyUpdate:function(e){a.default.defaultSetNotifyUpdate(d,e),t.ExchangeProvider.MailboxItemProvider.addItemChangedListener((function(t){t.isMailboxItemChanged&&e(d.accessor())}))},dependsOnComponents:[c.default.JS_API_PROVIDER,c.default.CRM_PROVIDER,c.default.EXCHANGE_PROVIDER],serializeValue:function(e){return u.default[e]}};return d}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Allowed=1]="Allowed",e[e.ForbiddenOccurence=2]="ForbiddenOccurence",e[e.ForbiddenMeetingInviteRequest=3]="ForbiddenMeetingInviteRequest",e[e.ForbiddenMeetingInviteResponse=4]="ForbiddenMeetingInviteResponse",e[e.ForbiddenForOrganizerResolvedAsUser=5]="ForbiddenForOrganizerResolvedAsUser",e[e.ForbiddenInLimitedMode=6]="ForbiddenInLimitedMode",e[e.ForbiddenException=7]="ForbiddenException"}(n||(n={})),t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(0),n(6),n(5),n(94),n(196),n(2),n(9)],void 0===(o=function(e,t,n,r,o,i,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=n.default.DISPATCHER+"."+r.default.EXTERNAL_CONTEXT+".Property."+s.PropertyNames.TRACK_STATUS;t.default=function(e,t){var r=t.ComponentsLoader.ensureComponentLoaded(n.default.CRM_PROVIDER).then((function(){return t.CRMProvider.isFeatureControlBitEnabled(l.FcbNames.MailAppEnableCategoriesAPI).then((function(e){return e?new a.default(t,u):new i.default(t,u)}))})),c={id:s.PropertyNames.TRACK_STATUS,accessor:function(){return r.then((function(e){return e.getTrackStatus()}))},pushToClient:!0,onItemChanged:function(){c.notifyUpdate(new Promise((function(){})))},setNotifyUpdate:function(e){o.default.defaultSetNotifyUpdate(c,e),r.then((function(t){return t.subscribe(e)}))},dependsOnComponents:[n.default.JS_API_PROVIDER,n.default.EXCHANGE_PROVIDER,n.default.CRM_PROVIDER],serializeValue:o.default.serializeTrackStatus};return c}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(16),n(18),n(94)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype._updateTrackStatusBasedOnCategories=function(e){var t="",o=this._mailboxItem.Categories||[],i=o.length>0&&-1!==o.indexOf(this._mailboxTrackingCategoryName),a=e.CrmTrackingState===n.default.IsLinked,s=e.CrmTrackingState===n.default.WillBeLinked,l=-1!==[n.default.WillBeUnlinked,n.default.WillBeUnlinkedAndDeleted].indexOf(e.CrmTrackingState)&&0===e.TrackingStateTracker,u=n.default[e.CrmTrackingState];if(!i||a||s||l||(t="User tracked the item using category without Mail App.",e.CrmTrackingState=n.default.WillBeLinked),e.CrmCategoryTracker!==r.default.IsLinked||i||!a&&!s||(t="Category is not present on the item.",e.CrmTrackingState=n.default.WillBeUnlinked),t){var c=n.default[e.CrmTrackingState];this._applicationContext.EventManager.ReportTraceInfo(this._telemetryBaseComponentName+".CategoriesTracking","Tracking state updated: '"+t+"'",{originalTrackingState:u,newTrackingState:c})}return e},t}(o.default);t.default=i}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(0),n(5)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:n.PropertyNames.USER_PROFILE_EMAIL_ADDRESS,accessor:function(){return Promise.resolve(t.JsApiProvider.getUserEmailAddress())},pushToClient:!0,dependsOnComponents:[r.default.JS_API_PROVIDER],serializeValue:o.default.restrictedValue}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(0)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:n.PropertyNames.IS_LIMITED_MODE,accessor:function(){return t.CRMProvider.isLimitedMode()},pushToClient:!0,dependsOnComponents:[r.default.CRM_PROVIDER]}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(0)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){t.EventManager&&t.EventManager.getSessionId();return{id:n.PropertyNames.LIMITED_MODE_NOTIFICATION_STATE,accessor:function(){return Promise.resolve({hasBeenClosed:!0,helpLink:null})},pushToClient:!0,dependsOnComponents:[r.default.JS_API_PROVIDER]}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(28),n(0)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:n.PropertyNames.KNOWN_ORG_SETTINGS,accessor:function(){return t.CRMProvider.isOrgSettingsEnabled([r.TrackCategorizedItems,r.TrackAppointmentsFromNonOrganizer,r.DelegateAccessEnabled,r.CreateContactWithoutTracking,r.EmailInReadModeTrackEnabled,r.OverrideTrackInCrmBehaviour])},pushToClient:!0,dependsOnComponents:[o.default.CRM_PROVIDER]}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(2),n(0)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:n.PropertyNames.IS_CHECKER_COMMAND_VISIBLE,accessor:function(){return Promise.resolve(t.AppChecker.getCheckerCommandState())},pushToClient:!0,dependsOnComponents:[r.default.JS_API_PROVIDER]}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Loading=0]="Loading",e[e.Success=1]="Success",e[e.Failed=2]="Failed"}(t.ExternalContextResultStatus||(t.ExternalContextResultStatus={}))}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this._itemsInProgressCounter=0,this._applicationContext=e}return e.prototype.startTrackingExternalContextItemByHostActivityId=function(e){var t;(null===(t=e)||void 0===t?void 0:t.hostActivityId)&&(this._itemsInProgressCounter++,this._applicationContext.ExchangeProvider.MailboxItemProvider.pausePolling(),this._applicationContext.EventManager.setHostActivityId(e.hostActivityId))},e.prototype.endTrackingExternalContextItemByHostActivityId=function(e){var t;(null===(t=e)||void 0===t?void 0:t.hostActivityId)&&(1===this._itemsInProgressCounter&&(this._applicationContext.EventManager.resetHostActivityId(),this._applicationContext.ExchangeProvider.MailboxItemProvider.restartPolling()),this._itemsInProgressCounter--)},e}();t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(0),n(1),n(205),n(210),n(46),n(4),n(6),n(14),n(7),n(37)],void 0===(o=function(e,t,n,r,o,i,s,l,u,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.namespace=u.default.CONTACTS_MODULE,r}return a(t,e),t.prototype._displayNewAppointmentForm=function(e){var t=e.args.AppointmentParameters;this.applicationContext.JsApiProvider.displayNewAppointmentForm(t)},t.prototype._getContacts=function(e){var t=this,n=new o.default(e.args.Parameters);this.applicationContext.ExchangeProvider.ContactsModuleProvider.getContacts(n).then((function(n){t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onSuccess,n,!0)}),(function(n){var o=[{name:l.ErrorEventParameterName.Error,value:n}];t.applicationContext.EventManager.ReportComponentFailure(new r.ComponentError(t.getTelemetryComponent()+".GetContacts","Failed to get contact records",r.ErrorCode.GENERIC),o),t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onFailure,{},!0)}))},t.prototype._updateContactProperties=function(e){var t=this,n=e.args.uniqueDispatchKey?e.args.uniqueDispatchKey:"",o=new i.default(e.args.Parameters);this.applicationContext.ExchangeProvider.ContactsModuleProvider.updateContactProperties(o).then((function(){t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onSuccess,{uniqueDispatchKey:n},!0)}),(function(o){var i=[{name:l.ErrorEventParameterName.Error,value:o}];t.applicationContext.EventManager.ReportComponentFailure(new r.ComponentError(t.getTelemetryComponent()+".UpdateContactProperties","Failed to update contact properties",r.ErrorCode.GENERIC),i),t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onFailure,{uniqueDispatchKey:n},!0)}))},t.prototype._getRoamingSettingsItem=function(e){var t=e.args.key,n=this.applicationContext.JsApiProvider.getRoamingSettingsItem(t);this.applicationContext.Bridge.performCallbackWithId(e.callbacks.onSuccess,{result:n},!0)},t.prototype._saveRoamingSettingsAsync=function(e){var t=this;this.applicationContext.JsApiProvider.setRoamingSettingsItem(e.args.key,e.args.value),this.applicationContext.JsApiProvider.saveRoamingSettingsAsync().then((function(){t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onSuccess,{},!0)}),(function(){t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onFailure,{},!0)}))},t.prototype._sendTelemetryEvents=function(e){var t=e.args.events;if(t&&t.length)for(var o in t){var i=t[o],a=[],u=n.default.CONTACT_TRACKING_MODULE+"."+i.component;switch(i.data&&a.push({name:l.EventParameterName.Data,value:i.data}),i.error&&a.push({name:l.ErrorEventParameterName.Error,value:i.error}),i.name){case l.EVENT_NAME.MonitorSuccess:this.applicationContext.EventManager.ReportComponentSuccess(u,null,a);break;case l.EVENT_NAME.MonitorFailure:this.applicationContext.EventManager.ReportComponentFailure(new r.ComponentError(u,i.message,r.ErrorCode.GENERIC),a);break;case l.EVENT_NAME.Performance:this.applicationContext.EventManager.ReportComponentPerformance(u,{name:i.metricName,startTime:i.startTime,stopTime:i.stopTime},a);break;case l.EVENT_NAME.TraceEvent:switch(i.level){case s.ApplicationEventLevel.Error:this.applicationContext.EventManager.ReportTraceError(new r.ComponentError(u,i.message,r.ErrorCode.GENERIC),a);case s.ApplicationEventLevel.Warning:this.applicationContext.EventManager.ReportTraceWarning(u,i.message,i.data);break;default:this.applicationContext.EventManager.ReportTraceInfo(u,i.message,i.data)}}}},t.prototype._showAppError=function(e){var t=this,o=this.getTelemetryComponent()+".ShowAppError",i=e.args.message,a=null===e.args.code?r.ErrorCode.GENERIC:e.args.code,s=new r.ComponentError(o,"Contact Module Failure: "+i,a);if(this.applicationContext.EventManager.ReportComponentFailure(s,[{name:l.ErrorEventParameterName.ComponentErrorComponentName,value:e.args.component}]),s.code===r.ErrorCode.CRM_USER_MISSING_PRIVILEGE){var u=d.default.parseMissingPrivilegeFromErrorMessage(s.message);s=p.default.createFromComponentError(s,[u])}this.applicationContext.ComponentsLoader.ensureComponentLoaded(n.default.RESOURCE_MANAGER).then((function(){return t.applicationContext.UIManager.showErrorMessage(s)}))},t.prototype._getFeatureControlBits=function(e){var t=this;this.applicationContext.CRMProvider.getFeatureControlBits().then((function(n){t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onSuccess,n,!0)}))},t.prototype._getStringValueBundle=function(e){var t=this,r=e.args.valueNames;if(r){this.applicationContext.ComponentsLoader.ensureComponentLoaded(n.default.RESOURCE_MANAGER).then((function(){for(var n={},o=0,i=r.length;o<i;o++)n[r[o]]=t.applicationContext.ResourceManager.getString(r[o]);t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onStringsResult,{values:n},!1)}))}},t.prototype._sendOdataBatchRequest=function(e){var t=this,n=e.args.entityType,r=e.args.fetchXml;this.applicationContext.CRMProvider.sendOdataBatchRequest(n,r).then((function(n){t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onSuccess,n,!0)}),(function(){t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onFailure,{},!0)}))},t.prototype.registerMethods=function(){var e,t,n,r,o,i,a,s,l,u,c,d,p,f;this.registerMethodWithName("DisplayFormForNewAppointment",this._displayNewAppointmentForm,{AppointmentParameters:{}},{}),this.registerMethodWithName("GetContacts",this._getContacts,((e={}).Parameters={},e),((t={}).onSuccess="",t.onFailure="",t)),this.registerMethodWithName("UpdateContactProperties",this._updateContactProperties,((n={}).Parameters={},n.uniqueDispatchKey="",n),((r={}).onSuccess="",r.onFailure="",r)),this.registerMethodWithName("GetRoamingSettingsItem",this._getRoamingSettingsItem,((o={}).key="",o),((i={}).onSuccess="",i)),this.registerMethodWithName("SaveRoamingSettingsAsync",this._saveRoamingSettingsAsync,((a={}).key="",a.value={},a),((s={}).onSuccess="",s.onFailure="",s)),this.registerMethodWithName("SendTelemetryEvents",this._sendTelemetryEvents,((l={}).events={},l),{}),this.registerMethodWithName("ShowAppError",this._showAppError,((u={}).code=0,u.message="",u.component="",u),{}),this.registerMethodWithName("GetFeatureControlBits",this._getFeatureControlBits,{},((c={}).onSuccess="",c)),this.registerMethodWithName("GetStringValueBundle",this._getStringValueBundle,((d={}).valueNames={},d),{onStringsResult:""}),this.registerMethodWithName("SendOdataBatchRequest",this._sendOdataBatchRequest,((p={}).entityType="",p.fetchXml="",p),((f={}).onSuccess="",f.onFailure="",f))},t}(c.default);t.default=f}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(10),n(65),n(206),n(207),n(43),n(208),n(209)],void 0===(o=function(e,t,n,r,o,i,s,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){function t(t){var r=e.call(this,t)||this;if(r._propertiesRestrictions=[],r._extendedPropertiesRestrictions=[],r._maxEntriesReturned=1,r._offset=0,t){var o=t.fieldOrder,a=t.count,l=t.offset;t.propertiesRestrictions&&Array.isArray(t.propertiesRestrictions)&&(r._propertiesRestrictions=r.convertRawProperties(t.propertiesRestrictions,r._convertPropertyToRestriction)),t.extendedPropertiesRestrictions&&Array.isArray(t.extendedPropertiesRestrictions)&&(r._extendedPropertiesRestrictions=r.convertRawProperties(t.extendedPropertiesRestrictions,r._convertExtendedPropertyToRestriction)),o&&o.order&&o.property&&(r._fieldOrder=new i.default(o.order,new s.default(o.property,n.default.Contacts))),!isNaN(a)&&a>0&&(r._maxEntriesReturned=a),!isNaN(l)&&l>0&&(r._offset=l),r._orFilter=!0===t.orFilter}return r}return a(t,e),Object.defineProperty(t.prototype,"maxEntriesReturned",{get:function(){return this._maxEntriesReturned},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"offset",{get:function(){return this._offset},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"orFilter",{get:function(){return this._orFilter},enumerable:!0,configurable:!0}),t.prototype._convertPropertyToRestriction=function(e){return e.name&&null!==e.value&&void 0!==e.value?new l.default(new s.default(e.name,n.default.Contacts),e.value):null},t.prototype._convertExtendedPropertyToRestriction=function(e){if(e.name&&null!==e.type&&void 0!==e.type&&null!==e.value&&void 0!==e.value){e.type;return new o.default(new r.default(e.name,e.type),e.value,!!e.invert&&e.invert)}return null},t.prototype.getPropertiesRestrictions=function(){return this._propertiesRestrictions},t.prototype.getExtendedPropertiesRestrictions=function(){return this._extendedPropertiesRestrictions},t.prototype.getFieldOrder=function(){return this._fieldOrder},t}(u.default);t.default=c}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(39)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,n){void 0===n&&(n=!1),this._property=e,this._value=t,this._invert=n}return e.prototype.toSoap=function(){var e=this._invert?"<t:IsNotEqualTo>":"<t:IsEqualTo>",t=this._invert?"</t:IsNotEqualTo>":"</t:IsEqualTo>";return e+"\n\t\t\t\t\t"+this._property.toSoap()+'\n\t\t\t\t\t<t:FieldURIOrConstant>\n\t\t\t\t\t\t<t:Constant Value="'+n.escapeXml(this._value)+'" />\n\t\t\t\t\t</t:FieldURIOrConstant>\n\t\t\t\t'+t},e.prototype.toJson=function(){throw new Error("Not Implemented")},e}();t.default=r}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=["Ascending","Descending"],r=function(){function e(e,t){this._order=e,this._property=t,-1===n.indexOf(this._order)&&(this._order=n[0])}return e.prototype.toSoap=function(){return'<t:FieldOrder Order="'+this._order+'">\n\t\t\t\t\t'+this._property.toSoap()+"\n\t\t\t\t</t:FieldOrder>"},e.prototype.toJson=function(){throw new Error("Not Implemented")},e}();t.default=r}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(39)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,n,r){void 0===n&&(n="Substring"),void 0===r&&(r="IgnoreCase"),this._property=e,this._value=t,this._containmentMode=n,this._containmentComparison=r}return e.prototype.toSoap=function(){return'<t:Contains ContainmentMode="'+this._containmentMode+'" ContainmentComparison="'+this._containmentComparison+'">\n\t\t\t\t\t'+this._property.toSoap()+'\n\t\t\t\t\t<t:Constant Value="'+n.escapeXml(this._value)+'" />\n\t\t\t\t</t:Contains>'},e.prototype.toJson=function(){throw new Error("Not Implemented")},e}();t.default=r}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(10),n(65),n(43),n(95)],void 0===(o=function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){var n=e.call(this)||this;return n._properties=[],t&&(t.properties&&Array.isArray(t.properties)&&(n._properties=n.convertRawProperties(t.properties,n._convertProperty)),t.extendedProperties&&Array.isArray(t.extendedProperties)&&(n._extendedProperties=n.convertRawProperties(t.extendedProperties,n._convertExtendedProperty))),n}return a(t,e),t.prototype._convertProperty=function(e){return e.name?new o.default(e.name,n.default.Contacts):null},t.prototype._convertExtendedProperty=function(e){return e.name?new r.default(e.name,e.type):null},t.prototype.getProperties=function(){return this._properties},t.prototype.getExtendedProperties=function(){return this._extendedProperties},t}(i.default);t.default=s}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(11),n(10),n(20),n(41),n(95)],void 0===(o=function(e,t,n,r,o,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t){var n=e.call(this)||this;return n._properties=[],t&&(t.properties&&Array.isArray(t.properties)&&(n._properties=n.convertRawProperties(t.properties,n._convertProperty)),t.extendedProperties&&Array.isArray(t.extendedProperties)&&(n._extendedProperties=n.convertRawProperties(t.extendedProperties,n._convertExtendedProperty)),n._itemId=t.id),n}return a(t,e),Object.defineProperty(t.prototype,"itemId",{get:function(){return this._itemId},enumerable:!0,configurable:!0}),t.prototype._convertProperty=function(e){return e.name?new i.default(e.name,r.default.Contacts,e.value,n.default[n.default.contact]):null},t.prototype._convertExtendedProperty=function(e){if(e.name&&null!==e.type&&void 0!==e.type){var t=e.type;return new o.default(e.name,isNaN(t)?r.default.String:t,e.value,n.default[n.default.contact])}return null},t.prototype.getProperties=function(){return this._properties},t.prototype.getExtendedProperties=function(){return this._extendedProperties},t}(s.default);t.default=l}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Log=0]="Log",e[e.Info=1]="Info",e[e.Verbose=2]="Verbose",e[e.Warning=3]="Warning",e[e.Error=4]="Error"}(r||(r={})),t.ApplicationEventLevel=r;var o="Info",i="Verbose",a="Warning",s="Error",l=((n={})[r.Log]=o,n[r.Info]=o,n[r.Verbose]=i,n[r.Warning]=a,n[r.Error]=s,n);t.APPLICATION_LEVEL_TO_TRACER_LEVEL_STRING=l}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(16),n(89),n(67),n(69),n(44),n(30),n(21),n(32),n(213)],void 0===(o=function(e,t,n,r,o,i,a,s,l,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function e(e,t){this._bcd=e,this._applicationContext=t,window.exchangeItemUpdateCount=0,this._mailboxItemProvider=new p(this._applicationContext),this._contactsModuleProvider=new f}return Object.defineProperty(e.prototype,"ExchangeServerVersion",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EwsSchemaVersion",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MailboxItemProvider",{get:function(){return this._mailboxItemProvider},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ContactsModuleProvider",{get:function(){return this._contactsModuleProvider},enumerable:!0,configurable:!0}),e}();t.ExchangeProvider=d;var p=function(){function e(e){this._applicationContext=e,this._itemChangedListeners=[]}return e.prototype._retrieveMailboxItem=function(){var e,t=u.default.getInstance().exchangeConfig.props,n=this._applicationContext.JsApiProvider.getMailboxItemType();if("message"===n){var i=t;(e=new o.default(u.default.getInstance().mailboxItem.itemId)).InternetMessageId=this._applicationContext.JsApiProvider.getMailboxItem().internetMessageId,e.Categories=i.Categories,e.ConversationIndex=i.ConversationIndex,e.DateTimeSent=new Date(i.DateTimeSent),e.DateTimeReceived=new Date(i.DateTimeReceived)}else{var s=t;(e=new r.default(u.default.getInstance().mailboxItem.itemId)).GlobalObjectId=s.UID,e.InternetMessageId=this._applicationContext.JsApiProvider.getMailboxItem().internetMessageId;var l=e;l.CalendarItemType=s.CalendarItemType,l.IsAllDayEvent=s.IsAllDayEvent,l.Location=s.Location,l.IsRecurring=null!=s.Recurrence,l.Categories=s.Categories,l.ScheduleStart=u.default.getInstance().mailboxItem.start,l.ScheduleEnd=u.default.getInstance().mailboxItem.end,l.IsRecurring&&(l.RecurrencePatternDetails=a.default.getRecurrencePatternDetails(s.Recurrence))}return e.ItemType=n,e},e.prototype.retrieveMailboxItem=function(){return Promise.resolve(this._retrieveMailboxItem())},e.prototype._retrieveTrackStatus=function(){var e=u.default.getInstance().exchangeConfig.props,t=new i.default;return t.CrmId=e.crmid,t.CrmTrackingState=n.default[e.crmTrackingState],t.CrmIsFollowed=e.crmIsFollowed?1:0,t.CrmObjectTypeCode=c.CRMEntityTypes[e.crmObjectType],t.CrmRegardingObjectId=e.crmRegardingId,t.CrmRegardingObjectName=e.crmRegardingObjectName,t.TrackTimestamp=e.crmTrackTimestamp,t.CrmCategoryTracker=e.crmCategoryTracker,e.crmRegardingObjectType&&(t.CrmRegardingObjectType=c.CRMEntityTypes[e.crmRegardingObjectType]),t},e.prototype.retrieveTrackStatus=function(){return Promise.resolve(this._retrieveTrackStatus())},e.prototype.setProperties=function(e){var t={};console.log("executing Set crm email properties:"),e.forEach((function(e){console.log("$set prop: '{update.propertyName}' = "+e.propertyValue),t[e.propertyName]=e.propertyValue}));var r=null!==t[l.default.REGARDING_OBJECT_TYPE]&&void 0!==t[l.default.REGARDING_OBJECT_TYPE]?parseInt(t[l.default.REGARDING_OBJECT_TYPE],10):null,o=c.getTypeFormCode(r),i={crmid:t[l.default.ID],crmIsFollowed:t[l.default.IS_FOLLOWED],crmObjectType:t[l.default.OBJECT_TYPE_CODE],crmRegardingId:t[l.default.REGARDING_ID],crmRegardingObjectName:t[l.default.REGARDING_OBJECT_NAME],crmRegardingObjectType:null!==o?o:void 0,crmTrackingState:n.default[t[l.default.TRACKING_STATE]],crmTrackTimestamp:t[l.default.TRACK_TIMESTAMP],crmCategoryTracker:t[l.default.CRM_CATEGORY_TRACKER]};u.default.getInstance().exchangeConfig.setProps(i),u.default.getInstance().exchangeConfig.setCategories(t[s.default.CATEGORIES]),window.exchangeItemUpdateCount++;var a={isTrackStatusUpdated:!0,isMailboxItemUpdated:!0,isMailboxItemChanged:!1,mailboxItem:this._retrieveMailboxItem(),trackStatus:this._retrieveTrackStatus()};return this._itemChangedListeners.forEach((function(e){return e(a)})),Promise.resolve(null)},e.prototype.getAttachmentIds=function(){return Promise.resolve([])},e.prototype.addItemChangedListener=function(e){this._itemChangedListeners.push(e)},e.prototype.pausePolling=function(){},e.prototype.restartPolling=function(){},e}(),f=function(){function e(){}return e.prototype.getContacts=function(e){throw new Error("Not Implemented")},e.prototype.updateContactProperties=function(e){throw new Error("Not Implemented")},e}();t.default=function(){return function(e,t){t.ExchangeProvider=new d(e,t)}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={None:0,Account:1,ActivityMimeAttachment:1001,ActivityParty:135,ActivityPointer:4200,AdvancedSimilarityRule:9949,Annotation:5,AnnualFiscalCalendar:2e3,Appointment:4201,AppModule:9006,AppModuleComponent:9007,AsyncOperation:4700,AttributeMap:4601,Audit:4567,AzureServiceConnection:9936,BulkDeleteFailure:4425,BulkDeleteOperation:4424,BulkOperation:4406,BulkOperationLog:4405,BusinessUnit:10,BusinessUnitNewsArticle:132,Calendar:4003,CalendarRule:4004,Campaign:4400,CampaignActivity:4402,CampaignResponse:4401,ChannelAccessProfile:3005,ChannelAccessProfileEntityAccessLevel:9404,Competitor:123,ResourceGroup:4007,ConstraintBasedGroup:4007,Connection:3234,ConnectionRole:3231,Contact:2,Contract:1010,ContractDetail:1011,ContractTemplate:2011,ConvertRule:9300,ConvertRuleItem:9301,CustomerAddress:1071,CustomControlDefaultConfig:9755,CustomerOpportunityRole:4503,CustomerRelationship:4502,CustomControl:9753,CustomControlResource:9754,Dependency:7105,Discount:1013,Position:50,DiscountType:1080,DisplayString:4102,DocumentIndex:126,DocumentTemplate:9940,DelveActionHub:9961,DuplicateRule:4414,DynamicProperty:1048,DynamicPropertyInstance:1333,DynamicPropertyAssociation:1235,DynamicPropertyOptionSetItem:1049,Email:4202,SocialActivity:4216,SocialProfile:99,Entitlement:9700,EntitlementChannel:9701,ExternalParty:3008,ExternalPartyItem:9987,RoutingRule:8181,RoutingRuleItem:8199,EntitlementTemplate:9702,EntitlementTemplateChannel:9703,EmailServerProfile:9605,Equipment:4e3,Fax:4204,FieldSecurityProfile:1200,FieldPermission:1201,FixedMonthlyFiscalCalendar:2004,Goal:9600,Mailbox:9606,Metric:9603,RollupField:9604,GoalRollupQuery:9602,ImportEntity:4410,ImportFile:4412,ImportJob:9107,ImportLog:4423,ImportMap:4411,Incident:112,IncidentKnowledgeBaseRecord:9931,IncidentResolution:4206,Invoice:1090,InvoiceDetail:1091,KbArticle:127,KbArticleComment:1082,KbArticleTemplate:1016,KnowledgeBaseRecord:9930,KnowledgeSearchModel:9947,Lead:4,Letter:4207,List:4300,ListMember:4301,MailMergeTemplate:9106,MobileOfflineProfile:9866,MobileOfflineProfileItem:9867,MobileOfflineProfileItemAssociation:9868,MonthlyFiscalCalendar:2003,Opportunity:3,OpportunityClose:4208,OpportunityProduct:1083,OrderClose:4209,Organization:1019,PersonalDocumentTemplate:9941,PhoneCall:4210,PluginAssembly:4605,PluginTraceLog:4619,PluginType:4602,PluginTypeStatistic:4603,Post:8e3,PostFollow:8003,PostLike:8006,PriceLevel:1022,Privilege:1023,Product:1024,ProductAssociate:1025,ProductSubstitute:1028,ProductPriceLevel:1026,ProductLineItem:1027,ChannelAccessProfileRule:9400,ChannelAccessProfileRuleItem:9401,Publisher:7101,QuarterlyFiscalCalendar:2002,Queue:2020,QueueItem:2029,Quote:1084,QuoteClose:4211,QuoteDetail:1085,RecurringAppointmentMaster:4251,RelationshipRole:4500,RelationshipRoleMap:4501,Resource:4002,SLA:9750,SLAItem:9751,SLAKPIInstance:9752,Report:9100,ResourceSpec:4006,RibbonCommand:1116,RibbonContextGroup:1115,RibbonCustomization:1120,RibbonDiff:1130,RibbonRule:1117,RibbonTabToCommandMap:1113,SharePointSite:9502,SharePointDocumentLocation:9508,SharePointDocument:9507,SharePointData:9509,SystemApplicationMetadata:7e3,SystemForm:1030,SystemDashboard:1030,InteractionCentricSystemForm:1032,InteractionCentricEntitySystemForm:1033,UserForm:1031,UntrackedEmail:4220,Role:1036,SalesLiterature:1038,SalesLiteratureItem:1070,SalesOrder:1088,SalesOrderDetail:1089,SavedQuery:1039,SavedQueryVisualization:1111,SdkMessageProcessingStep:4608,SdkMessageProcessingStepImage:4615,SemiAnnualFiscalCalendar:2001,Service:4001,ServiceAppointment:4214,ServiceEndpoint:4618,Site:4009,SiteMap:4709,Solution:7100,SolutionComponent:7103,Subject:129,SystemUser:8,Task:4212,Team:9,Template:2010,EmailSignature:9997,Territory:2013,TraceLog:8050,MailboxStatistics:9607,TransactionCurrency:9105,UnresolvedAddress:2012,UoM:1055,UoMSchedule:1056,UserApplicationMetadata:7001,UserFiscalCalendar:1086,UserQuery:4230,UserQueryVisualization:1112,UserSettings:150,Workflow:4703,WebResource:9333,HierarchyRule:8840,SavedOrgInsightsConfiguration:1309,ServiceRestrictionCalendarRule:5003,TimeOffCalendarRule:5004,HolidayCalendarRule:5005,OccurrenceCalendarRule:5006,RecurrenceCalendarRule:5007,OccurringWorkShift:5008,RecurringWorkShift:5009,NotWorkingWorkShift:5010,ActivityScheduling:5011,AppLicense:9002,AppSalesPerson:9003,AppOfflineFilter:9004,AppWorkflowInstance:9005,ReportPropertyDialog:9099,ScriptErrorDialog:9200,ScriptErrorDetailsDialog:9201,DuplicateDetectionDialog:9203,BulkDeleteWizardDialog:9204,ImportWizardDialog:9205,UnresolvedEmailParty:9206,SolutionExportWizard:9207,SolutionImportWizard:9208,AccountAddress:1e3,ContactAddress:1008,NewKbArticle:9202,Entity:9801,Attribute:9802,Relationship:9803,OptionSet:9804,EntityRelationship:9805,AttributePicklistValue:9806,EntityRelationshipRole:9807,RolePrivileges:9808,LocalizedLabel:9809,ViewAttribute:9810,RoleTemplatePrivileges:9811,EntityKey:9812,BaseAddEntityObjectTypeCode:1e4,InternalAddress:1003,CompetitorAddress:1004,LeadAddress:1017,OrganizationUI:1021,RoleTemplate:1037,License:2027,IntegrationStatus:3e3,SubscriptionSyncInfo:33,EntityMap:4600,Notification:4110,BusinessUnitMap:6,DisplayStringMap:4101,Subscription:29,FilterTemplate:30,SubscriptionClients:1072,ColumnMapping:4417,SubscriptionManuallyTrackedObject:34,DuplicateRecord:4415,DuplicateRuleCondition:4416,EmailHash:4023,ImportData:4413,IsvConfig:4705,LookUpMapping:4419,OwnerMapping:4420,ProcessStage:4724,PickListMapping:4418,SdkMessage:4606,SdkMessageFilter:4607,SdkMessagePair:4613,SdkMessageRequest:4609,SdkMessageRequestField:4614,SdkMessageResponse:4610,SdkMessageResponseField:4611,TransformationMapping:4426,WorkflowWaitSubscription:4702,SystemUserPrincipals:14,SyncError:9869,WorkflowDependency:4704,TransformationParameterMapping:4427,ApplicationFile:4707,PrivilegeObjectTypeCodes:31,ClientUpdate:36,OrganizationStatistic:4708,ResourceGroupExpansion:4010,InterProcessLock:4011,SdkMessageProcessingStepSecureConfig:4616,TimeZoneDefinition:4810,TimeZoneLocalizedName:4812,TimeZoneRule:4811,WebWizard:4800,WizardAccessPrivilege:4803,WizardPage:4802,WorkflowLog:4706,ProcessSession:4710,AuthorizationServer:1094,PartnerApplication:1095,Theme:2015,ChannelPropertyGroup:1234,DataPerformance:4450,ChannelProperty:1236,OfficeGraphDocument:9950,SimilarityRule:9951,KnowledgeArticle:9953,KnowledgeArticleViews:9955,LanguageLocale:9957,Feedback:9958,KnowledgeArticleIncident:9954,RecommendationModel:9933,RecommendationModelMapping:9934,RecommendationModelVersion:9935,RecommendationModelVersionHistory:9937,RecommendedDocument:1189,TextAnalyticsEntityMapping:9945,TopicModel:9944,TopicModelConfiguration:9942,TopicModelExecutionHistory:9943,Category:9959,EntityDashboard:9988,Characteristic:1141,RatingValue:1142,RatingModel:1144,BookableResourceBooking:1145,BookableResourceBookingHeader:1146,BookableResourceCategory:1147,BookableResourceCharacteristic:1148,BookableResourceCategoryAssn:1149,BookableResource:1150,BookableResourceGroup:1151,BookingStatus:1152,EntityDataSource:85,NewProcess:950,TranslationProcess:951,PhoneToCaseProcess:952,OpportunitySalesProcess:953,LeadToOpportunitySalesProcess:954,ExpiredProcess:955};t.CRMEntityTypes=n,t.getTypeFormCode=function(e){for(var t in n)if(n[t]===e)return t;return null}}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(15),n(86),n(1),n(11),n(32)],void 0===(o=function(e,t,n,r,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){this._onInitialized=Promise.resolve(),this._bcd=e,this._applicationContext=t,this._userProfile={displayName:a.default.getInstance().userProfile.displayName,emailAddress:a.default.getInstance().userProfile.emailAddress,timeZone:""}}return e.prototype.getIsDesktopOutlook=function(){return this.getHostType()===r.default.Outlook},e.prototype.getInstallId=function(){return a.default.getInstance().installId},e.prototype.getMailboxDiagnostics=function(){return{hostName:"AUTOMATION",hostVersion:"15.0.468.0",OWAView:"ThreeColumns"}},e.prototype.getMailboxItem=function(){return{itemId:a.default.getInstance().mailboxItem.itemId,itemType:a.default.getInstance().mailboxItem.itemType,internetMessageId:a.default.getInstance().mailboxItem.internetMessageId,dateTimeCreated:a.default.getInstance().mailboxItem.dateTimeCreated}},e.prototype.getMailboxItemType=function(){return this.getMailboxItem().itemType},e.prototype.getUserEmailAddress=function(){return this._userProfile.emailAddress},e.prototype.getEwsUrl=function(){return"http://onefram.contoso.com"},e.prototype.getSubject=function(){return Promise.resolve(a.default.getInstance().mailboxItem.subject)},e.prototype.addAppointmentTimeChangeHandler=function(e){},e.prototype.removeAppointmentTimeChangeHandler=function(e){},e.prototype.forcePropertiesSync=function(){},e.prototype.setSubject=function(e){return a.default.getInstance().mailboxItem.subject=e,Promise.resolve()},e.prototype.getStartDate=function(){return Promise.resolve(new Date(a.default.getInstance().mailboxItem.start))},e.prototype.getLocation=function(){throw new Error("Not Implemented")},e.prototype.getRoomMailboxes=function(){return Promise.resolve([])},e.prototype.getEndDate=function(){return Promise.resolve(new Date(a.default.getInstance().mailboxItem.end))},e.prototype.isDelegatedMailbox=function(){return Promise.resolve(!1)},e.prototype.addFileAttachment=function(e,t){return Promise.resolve(null)},e.prototype.makeEwsRequest=function(e,t){throw new Error("Not Implemented")},e.prototype.isSent=function(){return Promise.resolve(!1)},e.prototype.isRestCallbackTokenSupported=function(){return!1},e.prototype.isAppPinningSupported=function(){return!1},e.prototype.getBody=function(e){return Promise.resolve(a.default.getInstance().mailboxItem.body)},e.prototype.prependBody=function(e,t){return a.default.getInstance().mailboxItem.body=e+a.default.getInstance().mailboxItem.body,Promise.resolve(null)},e.prototype.setBodyHtml=function(e){return a.default.getInstance().mailboxItem.body=e,Promise.resolve(null)},Object.defineProperty(e.prototype,"isCategoriesApiSupported",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.getCategories=function(){return Promise.reject(new Error("Not Implemented"))},e.prototype.updateCategories=function(e){return Promise.reject(new Error("Not Implemented"))},e.prototype.getMessageRecipients=function(){var e={sender:a.default.getInstance().mailboxItem.sender,to:a.default.getInstance().mailboxItem.to,cc:a.default.getInstance().mailboxItem.cc};return this.isComposeMode()?Promise.resolve(Object.assign(e,{bcc:a.default.getInstance().mailboxItem.bcc})):Promise.resolve(e)},e.prototype.getMeetingAttendees=function(){return Promise.resolve({sender:a.default.getInstance().mailboxItem.sender,organizer:a.default.getInstance().mailboxItem.organizer,requiredAttendees:a.default.getInstance().mailboxItem.requiredAttendees,optionalAttendees:a.default.getInstance().mailboxItem.optionalAttendees})},e.prototype.setRoamingSettingsItem=function(e,t){localStorage&&localStorage.setItem("FakeRoamingSetting_"+e,JSON.stringify({value:t}))},e.prototype.getRoamingSettingsItem=function(e){if(localStorage){var t=localStorage.getItem("FakeRoamingSetting_"+e);if(t)try{var n=JSON.parse(t);return n?n.value:null}catch(e){return null}}},e.prototype.removeRoamingSettingsItem=function(e){localStorage&&localStorage.removeItem("FakeRoamingSetting_"+e)},e.prototype.saveRoamingSettingsAsync=function(){throw new Error("Not Implemented")},e.prototype.getCustomProperties=function(){return Promise.resolve({})},e.prototype.setCustomProperties=function(e){return Promise.resolve()},e.prototype.removeCustomProperties=function(e){return Promise.resolve()},e.prototype.getToken=function(e){return Promise.resolve(null)},e.prototype.getEwsToken=function(){return Promise.resolve(null)},e.prototype.getMailboxItemId=function(){return a.default.getInstance().mailboxItem.itemId?Promise.resolve(a.default.getInstance().mailboxItem.itemId):Promise.reject(new o.ComponentError("JsApiProvider.SaveItem","Failed to save item.",o.ErrorCode.OFFICE_SAVE_ASYNC))},e.prototype.displayNewAppointmentForm=function(e){throw new Error("Not Implemented")},e.prototype.isComposeMode=function(){return this._bcd.mode===n.default.Compose},e.prototype.getMessageAttachmentIds=function(){return Promise.resolve([])},e.prototype.isMessage=function(){return this.getMailboxItemType()===i.default[i.default.message]},e.prototype.isAppointment=function(){return this.getMailboxItemType()===i.default[i.default.appointment]},e.prototype.openLoginDialog=function(e){throw new Error("Not Implemented")},e.prototype.addItemChangedHandler=function(e){},e.prototype.removeItemChangedHandler=function(e){},e.prototype.getHostType=function(){return r.default.OutlookWebApp},e.prototype.getSharedProperties=function(){return Promise.resolve(null)},e.prototype.getRestVersionEnum=function(){return null},e.prototype.convertToRestId=function(e,t){return""},e.prototype.convertToEwsId=function(e,t){return""},e.prototype.getDisplayLanguage=function(){return"en-US"},e}();t.JsApiProvider=s,t.default=function(){return function(e,t){t.JsApiProvider=new s(e,t)}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this._bcd=e,this._applicationContext=t}return e.prototype.validate=function(){var e=this._applicationContext.Storage.validate();if(e)throw e},e}();t.default=function(){return function(e,t){return new n(e,t).validate()}}}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return function(e,t){return Promise.resolve()}}}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return function(e,t){return Promise.resolve()}}}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(0),n(1),n(9),n(28),n(15)],void 0===(o=function(e,t,n,r,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n.default.DELEGATE_VALIDATOR+".validate";t.hideErrorReason="Switched from shared folder with failed state";var l=function(){function e(e,t){var n=this;this._bcd=e,this._applicationContext=t,this._applicationContext.JsApiProvider.addItemChangedHandler((function(){return n.validate()}))}return e.prototype.validate=function(){var e=this;return this._applicationContext.JsApiProvider.getSharedProperties().then((function(t){if(t){var n=t.delegatePermissions;return Promise.all([e._applicationContext.CRMProvider.isFeatureControlBitEnabled(o.FcbNames.ForceUsageOfCustomProperties),e._applicationContext.CRMProvider.isOrgSettingEnabled(i.DelegateAccessEnabled)]).then((function(e){var t=e[0],o=e[1];if(!t||!o)throw new r.ComponentError(s,"Delegate Scenario is not enabled (FCB: "+t+", OrgDbOrgSetting: "+o+")",r.ErrorCode.DELEGATE_DISABLED);if((n&Office.MailboxEnums.DelegatePermissions.Write)!==Office.MailboxEnums.DelegatePermissions.Write)throw new r.ComponentError(s,"Missing 'Write' permission during Delegate Access scenario. DelegatePermissions: '"+n+"'",r.ErrorCode.DELEGATE_DISABLED)}))}})).then((function(){e._validationResult instanceof r.ComponentError&&(e._applicationContext.UIManager.hideErrorMessage(e._validationResult,"Switched from shared folder with failed state"),e._validationResult=null)})).catch((function(t){e._validationResult=t,e._applicationContext.ComponentsLoader.ensureComponentLoaded(n.default.RESOURCE_MANAGER).then((function(){e._applicationContext.UIManager.showErrorMessage(t)}))}))},e}();t.default=function(){return function(e,t){e.mode!==a.default.Module&&new l(e,t).validate()}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(3),n(1),n(0)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.errorMessage="window.Office not availiable";var i=function(){function e(e,t){this._bcd=e,this._applicationContext=t}return e.prototype.validate=function(){this._checkOfficeAvailibility()},e.prototype._checkOfficeAvailibility=function(){if(!n.default.isOfficeExists())throw new r.default(o.default.VALIDATE_OFFICEJS,"window.Office not availiable",r.ErrorCode.OFFICE_FAILED_TO_LOAD)},e}();t.default=function(){return function(e,t){return new i(e,t).validate()}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(0),n(1),n(4),n(221),n(7),n(96)],void 0===(o=function(e,t,n,r,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentLoadingState=s.ComponentLoadingState;var l=function(){function e(e,t){this._bcd=e,this._applicationContext=t,this._definitions=[],this._components={},this._prevLoadComponentsCount=0,this._isLoadingFailed=!1,this._onComponentLoadedCallbacks=[],this._loadingPromise=a.default.createDeferredPromise(),this._loadStarted=!1}return Object.defineProperty(e.prototype,"loadingPromise",{get:function(){return this._loadingPromise.Promise},enumerable:!0,configurable:!0}),e.prototype.isComponentLoaded=function(e){if(!this._loadStarted)throw new Error("Can't call isComponentLoaded before load started");return this._throwIfComponentAbsent(e),this._components[e].loadingState===s.ComponentLoadingState.Loaded},e.prototype.ensureComponentLoaded=function(e){if(!this._loadStarted)throw new Error("Can't call ensureComponentLoaded before load started");return this._throwIfComponentAbsent(e),this._components[e].loadingDeferred.Promise},e.prototype.getComponentStates=function(){var e=this;return Object.keys(this._components).map((function(t){return{componentName:t,state:e._components[t].loadingState}}))},e.prototype.addDefinition=function(e){if(this._loadStarted)throw new Error("Definition '"+e.name+"' can't be added after load started");if(0!==this._definitions.filter((function(t){return t.name===e.name})).length)throw new Error("Definition '"+e.name+"' already added");this._definitions.push(e),this._components[e.name]={name:e.name,loadingDeferred:a.default.createDeferredPromise(),loadingState:s.ComponentLoadingState.None,bootableResult:void 0}},e.prototype.addOnComponentLoaded=function(e){this._onComponentLoadedCallbacks.push(e)},e.prototype.load=function(){if(this._loadStarted)throw new Error("Load already started");return this._loadStarted=!0,this._checkDependeciesAndLoadComponents(),this.loadingPromise},e.prototype._notifyComponentLoaded=function(e,t){var n=this;this._onComponentLoadedCallbacks.forEach((function(r){r(n._components[e.name],t)}))},e.prototype._ensureAllComponentsLoaded=function(){var e=this,t=this._getComponentsArray().filter((function(t){return e._components[t.name].loadingState===s.ComponentLoadingState.Loaded}));this._definitions.length===t.length&&(this._loadingPromise.Resolve(),this._applicationContext.Performance.setBooted(),i.default(this._applicationContext))},e.prototype._setComponentLoaded=function(e,t,r){var i=this;this._components[e.name].loadingState=s.ComponentLoadingState.Loaded,this._components[e.name].loadingDeferred.Resolve(r);var a=[{name:o.EventParameterName.DiagnosticsName,value:e.name},{name:o.EventParameterName.Location,value:n.default.COMPONENTS_LOADER}];this._applicationContext.EventManager.ReportComponentSuccess("MailApp."+e.name+".Boot",null,a),t.stop(),this._notifyComponentLoaded(e,this._getComponentsArray().filter((function(e){return i._components[e.name].loadingState===s.ComponentLoadingState.Loaded}))),this._ensureAllComponentsLoaded()},e.prototype._setComponentLoadFailed=function(e,t,n){r.ComponentError.isNativeError(n)&&(n=r.ComponentError.fromNativeError(e.name,r.ErrorCode.GENERIC,n)),this._components[e.name].loadingState=s.ComponentLoadingState.Failed,this._loadingPromise.Reject(n),this._isLoadingFailed=!0,t.stop(),i.default(this._applicationContext)},e.prototype._loadComponent=function(e,t){var n,r=this;if(void 0===t&&(t=!1),t)this._components[e.name].loadingState=s.ComponentLoadingState.WaitingForDependencies;else{var o;this._components[e.name].loadingState=s.ComponentLoadingState.Loading;try{o=this._applicationContext.Performance.addStopwatch(e.name+".Boot"),n=e.bootable(this._bcd,this._applicationContext)}catch(t){return void this._setComponentLoadFailed(e,o,t)}this._components[e.name].bootableResult=n,this._isPromise(n)?n.then((function(t){return r._setComponentLoaded(e,o,t)})).catch((function(t){return r._setComponentLoadFailed(e,o,t)})):this._setComponentLoaded(e,o)}},e.prototype._getComponentsArray=function(){var e=[];for(var t in this._components)e.push(this._components[t]);return e},e.prototype._ensureUpdateWaitingComponents=function(){var e=this,t=this._getComponentsArray().filter((function(t){var n=e._components[t.name];return n.loadingState===s.ComponentLoadingState.Loaded||n.loadingState===s.ComponentLoadingState.Loading}));t.length<this._definitions.length&&t.length>this._prevLoadComponentsCount&&(this._prevLoadComponentsCount=t.length,this._checkDependeciesAndLoadComponents())},e.prototype._checkDependeciesAndLoadComponents=function(){var e=this;if(!this._isLoadingFailed){for(var t=!1,n=function(n){var o=!0,i=[],a=r._definitions[n];if(r._components[a.name].loadingState!==s.ComponentLoadingState.None)return"continue";for(var l=0;l<a.dependsOnComponents.length;l++){var u=a.dependsOnComponents[l],c=r._components[u];if(c.loadingState===s.ComponentLoadingState.None||c.loadingState===s.ComponentLoadingState.WaitingForDependencies||c.loadingState===s.ComponentLoadingState.Failed){o=!1;break}var d=r._components[u].bootableResult;r._isPromise(d)&&i.push(d)}o&&(i.length>0?(r._loadComponent(a,!0),Promise.all(i).then((function(){e._loadComponent(a),e._ensureUpdateWaitingComponents()})).catch((function(){}))):r._loadComponent(a)),t=!0},r=this,o=0;o<this._definitions.length;o++)n(o);t&&this._ensureUpdateWaitingComponents()}},e.prototype._isPromise=function(e){return!!e&&!!e.then},e.prototype._throwIfComponentAbsent=function(e){if(!this._components[e])throw new Error("'"+e+"' is not present in the component loader")},e}();t.ComponentsLoader=l}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(4),n(3),n(61)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={xmlhttprequest:"ResourceTimings.XMLHttpRequest",script:"AssetLoad.Script",link:"AssetLoad.Stylesheet",css:"AssetLoad.CssUrl",img:"AssetLoad.Image",iframe:"AssetLoad.IFrame",fetch:"ResourceTimings.Fetch","":"ResourceTimings.Fetch"};function a(e,t,n){return e?!!e[t]||(n.EventManager.ReportTraceWarning("BrowserResourceTimings",t+" is not avaliable on performance object"),!1):(n.EventManager.ReportTraceWarning("BrowserResourceTimings","performance object is not available"),!1)}function s(e){for(var t=document.querySelectorAll("iframe"),n=0;n<t.length;n++){var r=t[n];r instanceof HTMLIFrameElement&&r.getAttribute("id")!==o.IFRAME_ID&&e(r)}}function l(e,t){a(e,"clearResourceTimings",t)&&e.clearResourceTimings()}t.default=function(e){var t=[],o=function(n,r){if(a(n,"getEntriesByType",e))for(var o=0,i=n.getEntriesByType("resource");o<i.length;o++){var s=i[o];t.push({resource:s,performanceObject:n,identifier:r})}},u=e.Performance.addStopwatch("BrowserResourceTimings.metricsСollecting");try{o(r.default.performance(),"MainWindow"),s((function(e){try{o(e.contentWindow.performance,e.id)}catch(e){}})),t.forEach((function(t){!function(e,t){var r=t.performanceObject,o=t.resource,a=r.timing.navigationStart-window.performance.timing.navigationStart,s=i[o.initiatorType];if(s){var l=o.responseEnd-o.startTime,u=r.timing.navigationStart+o.startTime,c=[{name:n.BrowserPerformanceEventParameterName.Window,value:t.identifier}];l<0&&(l=o.duration),o.connectEnd&&c.push({name:n.BrowserPerformanceEventParameterName.ConnectEnd,value:o.connectEnd+a}),o.connectStart&&c.push({name:n.BrowserPerformanceEventParameterName.ConnectStart,value:o.connectStart+a}),o.domainLookupEnd&&c.push({name:n.BrowserPerformanceEventParameterName.DomainLookupEnd,value:o.domainLookupEnd+a}),o.domainLookupStart&&c.push({name:n.BrowserPerformanceEventParameterName.DomainLookupStart,value:o.domainLookupStart+a}),o.duration&&c.push({name:n.BrowserPerformanceEventParameterName.Duration,value:o.duration}),o.fetchStart&&c.push({name:n.BrowserPerformanceEventParameterName.FetchStart,value:o.fetchStart+a}),o.name&&c.push({name:n.BrowserPerformanceEventParameterName.ResourceName,value:o.name}),o.redirectEnd&&c.push({name:n.BrowserPerformanceEventParameterName.RedirectEnd,value:o.redirectEnd+a}),o.redirectStart&&c.push({name:n.BrowserPerformanceEventParameterName.RedirectStart,value:o.redirectStart+a}),o.requestStart&&c.push({name:n.BrowserPerformanceEventParameterName.RequestStart,value:o.requestStart+a}),o.responseEnd&&c.push({name:n.BrowserPerformanceEventParameterName.ResponseEnd,value:o.responseEnd+a}),o.responseStart&&c.push({name:n.BrowserPerformanceEventParameterName.ResponseStart,value:o.responseStart+a}),o.workerStart&&c.push({name:n.BrowserPerformanceEventParameterName.WorkerStart,value:o.workerStart+a}),o.decodedBodySize&&c.push({name:n.BrowserPerformanceEventParameterName.DecodedBodySize,value:o.decodedBodySize}),o.encodedBodySize&&c.push({name:n.BrowserPerformanceEventParameterName.EncodedBodySize,value:o.encodedBodySize}),o.nextHopProtocol&&c.push({name:n.BrowserPerformanceEventParameterName.NextHopProtocol,value:o.nextHopProtocol}),o.secureConnectionStart&&c.push({name:n.BrowserPerformanceEventParameterName.TransferSize,value:o.secureConnectionStart+a}),o.transferSize&&c.push({name:n.BrowserPerformanceEventParameterName.TransferSize,value:o.transferSize}),o.responseStart&&void 0!==o.transferSize&&c.push({name:n.EventParameterName.IsFromCache,value:(0===o.transferSize).toString()}),e.Performance.addRetroactiveStopwatch(s,u,u+l,c)}}(e,t)})),function(e){l(r.default.performance(),e),s((function(t){l(t.contentWindow.performance,e)}))}(e)}catch(t){e.EventManager.ReportTraceWarning("BrowserResourceTimings","Exception occurred while using Performance API")}finally{u.stop()}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(3),n(1),n(6),n(0)],void 0===(o=function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(){return function(e,t){var a=function(e){var t=e.DispatcherCollection[o.default.APPLICATION];if(!t){var n=new r.ComponentError(i.default.LOAD_TIMEOUT,"Application dispatcher is unavailable",r.ErrorCode.GENERIC);return Promise.reject(n)}return t.clientInitialized.catch((function(e){var t="Error during client load";e&&e.componentName&&(t+=": "+e.componentName),e&&e.message&&(t+=" - "+e.message);var n=new r.ComponentError(i.default.LOAD_TIMEOUT,t,r.ErrorCode.GENERIC);return Promise.reject(n)}))}(t),s=new Promise((function(e,t){n.default.setTimeout((function(){var e=new r.ComponentError(i.default.LOAD_TIMEOUT,"Client loader timed out",r.ErrorCode.CLIENT_LOAD_TIMEOUT);t(e)}),3e5)}));return Promise.race([a,s])}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(15),n(224),n(38),n(63),n(8),n(70)],void 0===(o=function(e,t,n,r,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e){this._displayMode=e.mailAppMode,this._orgName=e.org,this._crmDeploymentEnvironment="onprem"===e.de?o.default.OnPremise:o.default.Online,this._exchangeDeploymentEnvironment="onprem"===e.sde?o.default.OnPremise:o.default.Online,this._orgId=e.orgId,this._externalDomain=e.ed,this._mailboxId=e.mailboxId,this._showPerformance=e.showperf&&("true"===e.showperf||"1"===e.showperf),this._showPerformance||(this._showPerformance="true"===s.default.localStorage.getItem(a.default.showPerfWidget)),this._collectorService=e.collectorurl,e.useAuthMethod===i.default.Token.toString()?this._useAuthMethod=i.default.Token:e.useAuthMethod===i.default.Cookie.toString()?this._useAuthMethod=i.default.Cookie:e.useAuthMethod===i.default.WIA.toString()?this._useAuthMethod=i.default.WIA:this._useAuthMethod=i.default.Default,this._secondaryLoad=e.secondaryLoad&&("true"===e.secondaryLoad||"1"===e.secondaryLoad),-1!==this._displayMode.indexOf("Compose")?this._mode=n.default.Compose:-1!==this._displayMode.indexOf("Module")?this._mode=n.default.Module:this._mode=n.default.Read,this._deviceType=r.default.Desktop,void 0!==this._displayMode&&(-1!==this._displayMode.indexOf("Phone")?this._deviceType=r.default.Phone:-1!==this._displayMode.indexOf("Tablet")&&(this._deviceType=r.default.Tablet)),this._testMode="true"===e.testmode}return Object.defineProperty(e.prototype,"orgName",{get:function(){return this._orgName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"orgId",{get:function(){return this._orgId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"externalDomain",{get:function(){return this._externalDomain},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayMode",{get:function(){return this._displayMode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"crmDeploymentEnvironment",{get:function(){return this._crmDeploymentEnvironment},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"exchangeDeploymentEnvironment",{get:function(){return this._exchangeDeploymentEnvironment},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showPerformance",{get:function(){return this._showPerformance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"testMode",{get:function(){return this._testMode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"collectorService",{get:function(){return this._collectorService},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mode",{get:function(){return this._mode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useAuthMethod",{get:function(){return this._useAuthMethod},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"secondaryLoad",{get:function(){return this._secondaryLoad},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deviceType",{get:function(){return this._deviceType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mailboxId",{get:function(){return this._mailboxId},enumerable:!0,configurable:!0}),e}();t.default=l}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Desktop=0]="Desktop",e[e.Tablet=1]="Tablet",e[e.Phone=2]="Phone"}(n||(n={})),t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(0),n(8),n(9),n(15),n(1)],void 0===(o=function(e,t,n,r,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){var n=this;this._appContext=e,this._bcd=t,t.mode!==i.default.Module&&e.JsApiProvider.addItemChangedHandler((function(){return n.updateAppPinningStateInfo()}))}return e.prototype.checkForAppPinningNotification=function(){var e=this;return this._bcd.mode===i.default.Module?Promise.resolve():Promise.all([this._appContext.CRMProvider.isFeatureControlBitEnabled(o.FcbNames.MailAppPinningStateNotification),this._appContext.CRMProvider.isLimitedMode()]).then((function(t){var o=t[0],i=t[1];if(o&&!i&&e._appContext.JsApiProvider.isAppPinningSupported()){var a=e._appContext.Storage.getItem(r.default.unpinnedBootCount),s=e._appContext.Storage.getItem(r.default.lastPinnedStateTimestamp);null!==a&&a>=0?a++:a=1,(!s||e._daysElapsedSinceLastPinned(s)>14)&&a>10&&(e._appContext.UIManager.showAppPinningNotification("PinnedMode_NotificationMessage"),e._appContext.EventManager.ReportTraceInfo(n.default.UI_MANAGER,"Pinning notification shown"),a=0),e._appContext.Storage.setItem(r.default.unpinnedBootCount,a)}})).catch((function(t){e._appContext.EventManager.ReportTraceError(new a.ComponentError(n.default.UI_MANAGER,"Failed to show pinning notification",a.ErrorCode.GENERIC,t))}))},e.prototype.updateAppPinningStateInfo=function(){var e=this;return this._appContext.CRMProvider.isFeatureControlBitEnabled(o.FcbNames.MailAppPinningStateNotification).then((function(t){if(t&&e._appContext.JsApiProvider.isAppPinningSupported()){var o=(new Date).toISOString();e._appContext.Storage.setItem(r.default.lastPinnedStateTimestamp,o),e._appContext.Storage.setItem(r.default.unpinnedBootCount,0),e._appContext.EventManager.ReportTraceInfo(n.default.UI_MANAGER,"App pinning info updated")}})).catch((function(t){e._appContext.EventManager.ReportTraceError(new a.ComponentError(n.default.UI_MANAGER,"Failed to update pinning state info",a.ErrorCode.GENERIC,t))}))},e.prototype._daysElapsedSinceLastPinned=function(e){var t=0;if(e){var n=new Date,r=new Date(e);t=(n.getTime()-r.getTime())/864e5}return t},e}();t.default=s}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(1),n(227),n(79),n(4),n(230),n(26),n(231),n(3),n(8),n(234),n(73),n(236),n(238),n(258),n(259),n(70),n(266)],void 0===(o=function(e,t,n,r,o,i,a,s,l,u,c,d,p,f,_,h,m,v,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(){function e(){this._applicationContext=new h.default}return e.prototype.initialize=function(e){return this._bcd=e,this._initializeApplicationContext()},e.prototype._initializeApplicationContext=function(){var e=this,t=u.default.location().port?":"+u.default.location().port:"";return this._applicationContext.OrgUrl=u.default.location().protocol+"//"+u.default.location().hostname+t,this._applicationContext.Storage=new m.default(this._bcd,this._applicationContext),this._applicationContext.Performance=new f.default(this._bcd,this._applicationContext),this._initializeEventManager(),r.default(this._applicationContext),u.default.setTimeout((function(){e._applicationContext.Performance.addRetroactiveStopwatch("CSSInit",u.default.PageLoadStartTime(),u.default.LibrariesLoadStartTime()),e._applicationContext.Performance.addRetroactiveStopwatch("JsLoad",u.default.LibrariesLoadStartTime(),u.default.LibrariesLoadEndTime()),e._applicationContext.Performance.addRetroactiveStopwatch("ShimJsLoad",u.default.LibrariesLoadEndTime(),u.default.ShimJsLoadEndTime())}),0),this._applicationContext.ResourceManager=new o.ResourceManager(this._bcd,this._applicationContext),this._applicationContext.UIManager=new l.default(this._bcd,this._applicationContext),this._applicationContext.AppChecker=new E.default(this._bcd,this._applicationContext),this._applicationContext.UIManager.subscribeToErrorEvent((function(t){e._applicationContext.EventManager.ReportComponentFailure(new n.default("MailApp.Application",t.message,t.code,t),[{name:i.ErrorEventParameterName.ComponentErrorComponentName,value:t.componentName}])}),(function(t){e._applicationContext.EventManager.ReportComponentSuccess("MailApp.Application","Application restored. Reason: "+t)})),this._applicationContext},e.prototype._initializeEventManager=function(){var e=[];"true"===v.default.getItem(c.default.developerToolsEnabled)?(e.push(p.getDeveloperConsoleEventsStoreListener(this._applicationContext)),e.push(new a.default(new d.default))):e.push(new a.default(u.default.console())),this._applicationContext.EventManager=new _.default(this._bcd,this._applicationContext,e),this._applicationContext.EventManager.Initialize()},e.prototype.renderUI=function(){var e=s.default.query("#loadingContainer");return e.setAttribute("aria-hidden","true"),e.style.display="none",s.default.query("#loadingTitle").setAttribute("aria-live","off"),Promise.resolve(null)},e}();String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,(function(t,n){return void 0!==e[n]?e[n]:t}))}),Object.setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t.default=function(){return new g}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(0),n(85),n(228),n(29),n(19),n(98),n(40),n(4)],void 0===(o=function(e,t,n,r,o,i,a,s,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function c(e,t,n,r,s,l){var u;return void 0===s&&(s=0),void 0===l&&(l=0),!function(e){return!!i.default.getInstance().getIsBrowserIE()&&"143abf4577894d22ae34a054a6dce7fe"===e}(e)?u=function(e,t,n,r,i,s){var l=new o.default(i),u={isOutOfMemoryError:!1};return u.lineNumber=n,u.columnNumber=r,u.func=l.getFunctionName(),u.fileName="index.html",u.browserLanguage=a.default.navigator().language,u.stackTrace=l.getStackTrace(),u.errorMessage=e,u.error=i,u.errorType=s,u}(e,0,s,l,n,r):((u={}).browserLanguage=a.default.navigator().language,u.errorMessage="Out of Memory!",u.lineNumber=s,u.columnNumber=l,u.func="anonymous",u.fileName="index.html",u.isOutOfMemoryError=!0,u.errorType=r,u.error=n),u}t.default=function(e){var t=function(e){return function(t){var o,i=l.ensureComponentErrorObject(t.error,void 0,n.default.ERROR_HANDLER);t.errorType===r.ErrorType.UnhandledError&&(o=[{name:u.ErrorEventParameterName.Error,value:t}]),e.EventManager.ReportComponentFailure(i,o)}}(e);!function(e){a.default.addEventListener("unhandledrejection",(function(t){t.preventDefault&&t.preventDefault();var n=new s.CrmURL(a.default.location().href),o=t.detail||t;if(void 0!==o&&void 0!==o.reason&&void 0!==o.promise)o.promise.catch((function(t){var i=l.ensureErrorObject(t),a=c(i.message,n.pathname,i,r.ErrorType.UnhandledRejection,o.reason.lineNumber,o.reason.columnNumber);e(a)}));else{var i=function(e,t){var n="";try{n=JSON.stringify(t)}catch(e){n="Received an uncaught Unknown Error Event which failed to be stringified for the following reason: "+e.message}return c(n,e,Error("Unknown Error Event"),r.ErrorType.UnhandledRejection)}(n.pathname,t);e(i)}}))}(t),function(e){a.default.onError((function(t,n,o,i,a){a&&!a.message&&t&&(a.message=t);var s=c(t,n,a,r.ErrorType.UnhandledError,o,i);e(s)}))}(t)}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this._stackFrame=this._internalGetStackTrace(e)}return e.prototype.getFunctionName=function(){this._stackFrame.startsWith("    at ")&&(this._stackFrame=this._stackFrame.substr("    at ".length));this._stackFrame.startsWith("Function.")&&(this._stackFrame=this._stackFrame.substr("Function.".length));var e,t=this._stackFrame.indexOf("("),n=this._stackFrame.indexOf(" ");if(-1===t&&-1===n)return"anonymous";e=t>0&&n>0?Math.min(t,n):Math.max(t,n);var r=this._stackFrame.substr(0,e),o=r.indexOf("$",0);if(-1===o)return"anonymous";var i=r.indexOf("$",o+1);if(-1===i)return r;var a=r.indexOf("$",i+1);return-1===a?r:r.substr(i+1,a-o)},e.prototype.getStackTrace=function(){return this._stackFrame},e.prototype._internalGetStackTrace=function(e){if(null==e)return"BrowserErrorHandler.InternalGetStackTrace: Extended error information not available from this browser.";var t=e.stack;if(void 0===t)return"BrowserErrorHandler.InternalGetStackTrace: Exception stack trace not available from this browser.";for(var n=t.split("\n"),r="",o=0;o<n.length;o++){var i=n[o];""!==i&&(r+=i+"\r\n")}return r},e}();t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(t){void 0===t&&(t=""),this._params=[],"string"==typeof t?this._initFromString(t):t instanceof e&&this._initFromUrlParameters(t)}return e.prototype.append=function(e,t){this._params.push({name:e,value:t}),this._update()},e.prototype.delete=function(e){for(var t=this._params.length-1;t>=0;t--){e===this._params[t].name&&this._params.splice(t,1)}this._update()},e.prototype.get=function(e){for(var t=null,n=0;n<this._params.length;n++){var r=this._params[n];if(e===r.name){t=r.value;break}}return t},e.prototype.getAll=function(e){for(var t=[],n=0,r=this._params;n<r.length;n++){var o=r[n];e===o.name&&t.push(o.value)}return t},e.prototype.has=function(e){for(var t=!1,n=0;n<this._params.length;n++){if(e===this._params[n].name){t=!0;break}}return t},e.prototype.set=function(e,t){var n;for(n=0;n<this._params.length;n++){if(e===(o=this._params[n]).name){o.value=t;break}}if(n===this._params.length)this._params.push({name:e,value:t});else for(var r=this._params.length-1;r>n;r--){var o;e===(o=this._params[r]).name&&this._params.splice(r,1)}this._update()},e.prototype.toString=function(){return this._params.map((function(e){var t=e.name,n=e.value;return(t=(t=encodeURIComponent(t)).replace(/%20/g,"+"))+"="+(n=(n=encodeURIComponent(n)).replace(/%20/g,"+"))})).join("&")},e.prototype.toDictionary=function(){return this._params.reduce((function(e,t){return e[t.name]=t.value,e}),{})},e.prototype._initFromString=function(e){var t;"?"===e.charAt(0)&&(e=e.slice(1));for(var n=e.split("&"),r=0;r<n.length;r++){var o=n[r];if(""!==o){var i=void 0,a=void 0;-1!==o.indexOf("=")?(i=(t=o.split("="))[0],a=t[1]):(i=o,a=""),i=i.replace(/\+/g," "),a=a.replace(/\+/g," "),i=decodeURIComponent(i),a=decodeURIComponent(a),this._params.push({name:i,value:a})}}},e.prototype._initFromUrlParameters=function(e){for(var t=0;t<e._params.length;t++){var n=e._params[t],r={name:n.name,value:n.value};this._params.push(r)}},e.prototype._update=function(){this.urlInternal&&(this.urlInternal.search=this.toString())},e.prototype.updateFromUrlInternal=function(){this.urlInternal&&(this._params=[],this._initFromString(this.urlInternal.search))},e}();t.URLSearchParams=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(4),n(46),n(47),n(29)],void 0===(o=function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e){this._console=e}return e.prototype.handleEvent=function(e,t){i.default.getInstance().getIsBrowserChrome()?this._printWebAPIStructured(e):this._printMessage(this._eventToString(e),e.getEventLevel())},e.prototype._printWebAPIStructured=function(e){var t=this,r="Event: "+e.getEventName();this._createGroupSafely(r,(function(){var r=t._getMainInfo(e);t._printMessage(r,e.getEventLevel()),t._createGroupSafely("Details",(function(){t._createGroupSafely("Event Parameters",(function(){t._console.table(t._formatParametersForTable(e.getEventParameters()))}),!0);var r=e.getEventParameterValue(n.ErrorEventParameterName.CallStack);r&&t._createGroupSafely("Call Stack",(function(){t._console.log(r)}),!0)}),!0)}))},e.prototype._createGroupSafely=function(e,t,n){void 0===n&&(n=!1),n?this._console.groupCollapsed(e):this._console.group(e);try{t()}catch(e){}finally{this._console.groupEnd()}},e.prototype._formatParametersForTable=function(e){var t={};for(var r in e){var o=e[r];if(n.KnownEventParameterName.EventContextName===r){if(!o)continue;t=Object.assign(t,this._formatParametersForTable(o))}else if(n.ErrorEventParameterName.CallStack!==r){var i=null!==o?o.toString():"";t[r]={value:i}}}return t},e.prototype._printMessage=function(e,t){switch(t){case r.ApplicationEventLevel.Error:this._console.error(e);break;case r.ApplicationEventLevel.Warning:this._console.warn(e);break;case r.ApplicationEventLevel.Info:this._console.info(e);break;default:this._console.log(e)}},e.prototype._getHeaderString=function(e){var t="["+e.getEventName()+"]";return t+="   "+this._getMainInfo(e)+"\n"},e.prototype._getMainInfo=function(e){var t=e.getEventParameterValue(n.EventParameterName.Message),r=e.getEventParameterValue(n.EventParameterName.ComponentName),o="";return r&&(o="["+r+"]"),n.EVENT_NAME.Performance===e.getEventName()?(o.length>0&&(o+="\n"),o+="MetricName: "+e.getEventParameterValue(n.PerformanceEventParameterName.MetricName)+"\n",o+="MetricValue: "+e.getEventParameterValue(n.PerformanceEventParameterName.MetricValue)+"\n"):t&&(o.length>0&&(o+="\t"),o+="Message: "+t),o},e.prototype._getParameterStringPair=function(e,t){for(var n=e,r=""+o.toSimpleTypeValue(t);r.length>n.length;)n+=" ";for(;n.length>r.length;)r+=" ";return[n+="   ",r+="   "]},e.prototype._getDetailsString=function(e){var t,r=e.getEventParameters(),o="",i="",a="",s="",l="",u="";i+="---Details---\n";for(var c in{}[n.KnownEventParameterName.ActivityId]=e.getActivityId(),r)n.ErrorEventParameterName.CallStack!==c?(l=(t=this._getParameterStringPair(c,r[c]))[0],u=t[1],a.length+l.length>160?(i+=a+"\n",a=l,i+=s+"\n\n",s=u):(a+=l,s+=u)):o=""+r[c];return i+=a+"\n",i+=s+"\n",o&&(i+="---Call Stack---\n"+o),i},e.prototype._eventToString=function(e){var t=this._getHeaderString(e);return t+=this._getDetailsString(e)},e}();t.default=a}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(0),n(26),n(99),n(1),n(19),n(232),n(233),n(72)],void 0===(o=function(e,t,n,r,o,i,a,s,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(t,o){var i=this;this._errorDialogElement=r.default.query("#"+e.errorDialogContainerId),this._error=null,this._eventHandlers=[],this._isErrorDetailsHidden=!0,this._progressMessageTimerId=null,this.showProgressMsg=function(e){if(i._applicationContext.ComponentsLoader.isComponentLoaded(n.default.RESOURCE_MANAGER)){var t=r.default.query("#loadingTitle");if(t.parentNode){var o=i._applicationContext.ResourceManager.getString(e);i._progressMessageTimerId&&a.default.clearTimeout(i._progressMessageTimerId);var s=t.cloneNode();s.innerHTML=o,t.parentNode.replaceChild(s,t),"off"!==t.getAttribute("aria-live")&&(i._progressMessageTimerId=a.default.setTimeout(i.showProgressMsg,5e3,o))}}},this._toggleErrorDetails=function(){i._isErrorDetailsHidden=!i._isErrorDetailsHidden,i._errorDialogElement.querySelector("."+u.UIClassNames.SHOW_MORE_BUTTON+" a").textContent=i._moreButtonLabel,i._errorDialogElement.querySelector("."+u.UIClassNames.ERROR_INFO).setAttribute("aria-hidden",i._isErrorDetailsHidden.toString())},this._bcd=t,this._applicationContext=o}return Object.defineProperty(e.prototype,"_sessionId",{get:function(){return this._applicationContext.EventManager.getSessionId()},enumerable:!0,configurable:!0}),e.areErrorsEqual=function(e,t){return e&&t?e.componentName===t.componentName&&e.code===t.code&&e.message===t.message:e===t},e.prototype.subscribeToErrorEvent=function(e,t){this._error?e(this._error):this._eventHandlers.push([e,t])},e.prototype.hideErrorMessage=function(t,n){!this._error||t&&!e.areErrorsEqual(this._error,t)||(this._error=null,this._hideErrorMessageInternal(),this._errorDialogElement.setAttribute("aria-hidden","true"),this._errorDialogElement.removeAttribute("aria-labelledby"),this._errorDialogElement.removeAttribute("aria-describedby"),this._toggleAriaAttributes(),this._onErrorHidden(n))},e.prototype.showNotification=function(e,t){var n=this._getHelpLink(e),r=t?this._applicationContext.ResourceManager.getString(t):this._applicationContext.ResourceManager.getErrorMessage(e);return new s.default(this._applicationContext,n,r).render()},e.prototype.showAppPinningNotification=function(e){var t=this._applicationContext.ResourceManager.getString(e);new l.default(this._applicationContext,"https://docs.microsoft.com/dynamics365/outlook-app/dynamics-365-app-outlook-user-s-guide?source=docs#experience-app-for-outlook-as-a-pinnable-taskpane",t).render()},e.prototype._getHelpLink=function(e){if(!e||e.code!==i.ErrorCode.UNKNOWN)return o.default.generate(e,this._sessionId,this._bcd.orgId)},e.prototype.showErrorMessage=function(t){if(t||(t=i.ComponentError.fromNativeError(n.default.UI_MANAGER,i.ErrorCode.UNKNOWN,new Error("Unknown error occurred"))),this._error&&e.areErrorsEqual(this._error,t))return this._onErrorEvent(t);this._error&&this._hideErrorMessageInternal(),this._error=t,r.default.query("#loadingContainer").setAttribute("aria-hidden","true"),r.default.query("#loadingTitle").setAttribute("aria-live","off");var o=this._getHelpLink(t),a=this._applicationContext.ResourceManager.getErrorTitle(t),s=this._applicationContext.ResourceManager.getErrorMessage(t),l=this._applicationContext.ResourceManager.getString("MailApp.Generic.ActivityId").format(this._sessionId,(new Date).toUTCString(),t&&t.message||"",t&&t.stack||""),u=this._getErrorMessageTemplate(a,s,l,this._moreButtonLabel,o),c=r.default.createFragment(u);this._errorDialogElement.appendChild(c),this._errorDialogElement.setAttribute("aria-hidden","false"),this._errorDialogElement.setAttribute("aria-labelledby","errorTitle"),this._errorDialogElement.setAttribute("aria-describedby","errorMessage"),this._errorDialogElement.focus(),this._toggleAriaAttributes(!0),this._setShowMoreButtonListener(),this._onErrorEvent(t)},e.prototype._hideErrorMessageInternal=function(){this._isErrorDetailsHidden=!0,this._removeShowMoreButtonListener(),this._errorDialogElement.innerHTML=""},e.prototype._toggleAriaAttributes=function(e){void 0===e&&(e=!1),r.default.query("#content").setAttribute("aria-hidden",e.toString())},e.prototype._setShowMoreButtonListener=function(){this._errorDialogElement.querySelector("."+u.UIClassNames.SHOW_MORE_BUTTON+" a").addEventListener("click",this._toggleErrorDetails)},e.prototype._removeShowMoreButtonListener=function(){this._errorDialogElement.querySelector("."+u.UIClassNames.SHOW_MORE_BUTTON+" a").removeEventListener("click",this._toggleErrorDetails)},Object.defineProperty(e.prototype,"_moreButtonLabel",{get:function(){return this._applicationContext.ResourceManager.getString("MailApp_Error_Show_"+(this._isErrorDetailsHidden?"More":"Less")+"_Button")},enumerable:!0,configurable:!0}),e.prototype._getErrorMessageTemplate=function(e,t,n,r,o){var i=this._applicationContext.ResourceManager.getString("MailApp_ScanForIssuesLabel");return'\n\t\t\t<div class="errorContainer">\n\t\t\t\t<h2 id="errorTitle" class="errorTitle">'+e+'</h2>\n\t\t\t\t<p id="errorMessage" class="errorMessage">'+t+"</p>\n\t\t\t\t"+this._getHelpLinkTemplate(o)+'\n\t\t\t\t<a href="#" class="'+u.UIClassNames.SHOW_APP_CHECKER+'">'+i+'</a>\n\t\t\t\t\n\t\t\t\t<div class="'+u.UIClassNames.SHOW_MORE_BUTTON+'">\n\t\t\t\t\t<a href="#">'+r+'</a>\n\t\t\t\t</div>\n\t\t\t\t<p class="'+u.UIClassNames.ERROR_INFO+'" aria-hidden="'+this._isErrorDetailsHidden+'">'+n+"</p>\n\t\t\t</div>\n\t\t"},e.prototype._getHelpLinkTemplate=function(e){return e?'<div class="helpLink"><a target="_blank" href="'+e+'">'+this._applicationContext.ResourceManager.getString("MoCA_OWA_Help_Link_Text")+"</a></div>":""},e.prototype._onErrorEvent=function(e){var t=this;this._eventHandlers&&this._eventHandlers.length&&this._eventHandlers.forEach((function(r){var o=r[0];try{o(e)}catch(r){e.innerError=i.ComponentError.fromNativeError(n.default.UI_MANAGER,i.ErrorCode.GENERIC,r),t._applicationContext.EventManager.ReportTraceError(e)}}))},e.prototype._onErrorHidden=function(e){var t=this;this._eventHandlers&&this._eventHandlers.length&&this._eventHandlers.forEach((function(r){var o=r[1];try{o(e)}catch(e){var a=i.ComponentError.fromNativeError(n.default.UI_MANAGER,i.ErrorCode.GENERIC,e);t._applicationContext.EventManager.ReportTraceError(a)}}))},e.errorDialogContainerId="errorDialog",e}();t.default=c}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(26),n(100)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n,r){var o=e.call(this,t)||this;return o._isCollapsed=!0,o._message="",o._helpLink="",o._onClick=function(e){o._isCollapsed=!o._isCollapsed&&e.target!==e.currentTarget&&e.target.classList.contains("collapse"),o._setIsCollapsed()},o._message=r,o._helpLink=n,o}return a(t,e),Object.defineProperty(t.prototype,"htmlTemplate",{get:function(){var e=this._applicationContext.ResourceManager.getString("MailApp_LearnMoreLabel");return'\n\t\t\t<div class="'+r.ClassNames.NotificationComponent+" "+r.ClassNames.Collapsed+'" role="presentation">\n\t\t\t\t<span class="svgIcon info"></span>\n\t\t\t\t<div class="'+r.ClassNames.Label+'">\n\t\t\t\t\t<div class="'+r.ClassNames.Text+'" >'+this._message+"</div>\n\t\t\t\t\t<a aria-label="+this._message+'" tabindex="-1" href="'+this._helpLink+'" target="_blank" class="helpLink">'+e+'</a>\n\t\t\t\t</div>\n\t\t\t\t<span class="svgIcon collapse"></span>\n\t\t\t</div>\n\t\t'},enumerable:!0,configurable:!0}),t.prototype.render=function(){return e.prototype.render.call(this),this.setEventListeners(),this},t.prototype._setIsCollapsed=function(){n.default.query("."+r.ClassNames.NotificationComponent).classList.toggle(r.ClassNames.Collapsed,this._isCollapsed)},t.prototype.close=function(){this._isRendered=!1,n.default.query("."+r.ClassNames.NotificationComponent).removeEventListener("click",this._onClick),n.default.removeElement("."+r.ClassNames.NotificationComponent)},t.prototype.setEventListeners=function(){n.default.query("."+r.ClassNames.NotificationComponent).addEventListener("click",this._onClick)},t}(r.NotificationBase);t.default=o}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(26),n(100)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,o,i){var a=e.call(this,t)||this;return a._message="",a._helpLink="",a._onClose=function(){a._isRendered=!1,n.default.query("#notification-close").removeEventListener("click",a._onClose),n.default.removeElement("."+r.ClassNames.NotificationComponent)},a._message=i,a._helpLink=o,a}return a(t,e),Object.defineProperty(t.prototype,"htmlTemplate",{get:function(){var e=this._applicationContext.ResourceManager.getString("MailApp_LearnMoreLabel");return'\n\t\t\t<div class="'+r.ClassNames.NotificationComponent+' role="presentation">\n\t\t\t\t<span class="svgIcon info"></span>\n\t\t\t\t<div class="'+r.ClassNames.Label+'">\n\t\t\t\t\t<div class="'+r.ClassNames.Text+'" >'+this._message+'</div>\n\t\t\t\t\t<a aria-label="'+this._message+'" tabindex="-1" href="'+this._helpLink+'" target="_blank" class="helpLink">'+e+'</a>\n\t\t\t\t</div>\n\t\t\t\t<span class="svgIcon close" style="width: 24px; height: 12px;" id="notification-close"></span>\n\t\t\t</div>\n\t\t'},enumerable:!0,configurable:!0}),t.prototype.render=function(){return e.prototype.render.call(this),this.setEventListeners(),this},t.prototype.setEventListeners=function(){n.default.query("#notification-close").addEventListener("click",this._onClose)},t}(r.NotificationBase);t.default=o}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(4),n(46),n(47),n(3),n(73)],void 0===(o=function(e,t,n,r,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={assert:r.ApplicationEventLevel.Error,error:r.ApplicationEventLevel.Error,exception:r.ApplicationEventLevel.Error,info:r.ApplicationEventLevel.Info,log:r.ApplicationEventLevel.Log,trace:r.ApplicationEventLevel.Verbose,warn:r.ApplicationEventLevel.Warning},l=function(){function e(){if(e._instance)throw new Error("Only one instance of the Console Wrapper could exist at the application runtime. To log amything into console, please use browser console patched methods.");e._instance=this,this._console=i.default.console(),this._wrapMethods()}return e.prototype._wrapMethods=function(){var e=this,t=this._console,n=this,r=function(r){var o=t[r];n[r]="function"==typeof o?o.bind(t):o,s.hasOwnProperty(r)&&(t[r]=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];e._shouldBeCaptured(r,t)&&e._saveUnknownConsoleOutput(r,t),n[r].apply(null,t)})};for(var o in t)r(o)},e.prototype._shouldBeCaptured=function(e,t){return"assert"!==e||!t[0]},e.prototype._saveUnknownConsoleOutput=function(e,t){var i=null!=s[e]?s[e]:r.ApplicationEventLevel.Info,l=new o.default(n.EVENT_NAME.TraceEvent,i);l.addEventParameter(n.EventParameterName.MethodName,e),l.addEventParameter(n.EventParameterName.Message,this._extractMessageFromCallParams(e,t)),l.addEventParameter(n.EventParameterName.Parameters,JSON.stringify(t)),l.addEventParameter(n.EventParameterName.ComponentName,"ConsoleWrapper");var u=r.APPLICATION_LEVEL_TO_TRACER_LEVEL_STRING[i]?r.APPLICATION_LEVEL_TO_TRACER_LEVEL_STRING[i]:"Info";l.addEventParameter(n.EventParameterName.TraceLevel,u),a.saveEventToDeveloperConsoleStore(l)},e.prototype._extractMessageFromCallParams=function(e,t){var r="assert"===e?t[1]:t[0];return r?"Browser console."+e+' was called with message "'+r+'".':"Unable to extract message from console."+e+" call. Please see arguments "+n.EventParameterName.Parameters+" for the details."},e}();t.default=l}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(6),n(3),n(73)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){var t=this;this._applicationContext=e,this._onClientInitialized((function(){r.default.setInterval((function(){t._sendEventsToTheClient()}),1e4)}))}return Object.defineProperty(e.prototype,"DispatcherCollection",{get:function(){var e=this._applicationContext.DispatcherCollection;return e||{}},enumerable:!0,configurable:!0}),e.Initialize=function(t){if(this._instance)throw new Error("DeveloperConsoleEventsSender events sender already initialized!");this._instance=new e(t)},e.prototype._onClientInitialized=function(e){var t=this,r=this.DispatcherCollection[n.default.APPLICATION];r?r.clientInitialized.then(e.bind(this)):setTimeout((function(){t._onClientInitialized(e)}),1e3)},e.prototype._sendEventsToTheClient=function(){var e=o.getDeveloperConsoleStoreEvents();if(e.length){var t=this.DispatcherCollection[n.default.LOGGING];if(t){try{t.deviceEvent("OnNativeApplicationEventsReceived",JSON.stringify(e))}catch(e){}o.clearDeveloperConsoleStoreEvents()}}},e}();t.default=i}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(101),n(237),n(8),n(0),n(1),n(3),n(4),n(6)],void 0===(o=function(e,t,n,r,o,i,a,s,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){this._collectionEnabled=!1,this._isBooting=!1,this._unstoredMetrics=[],this._unloadListenerAttached=!1,this._bcd=e,this._applicationContext=t,this._collectionEnabled=!0,this._isBooting=!0}return e.prototype._createStoredPerformanceMetric=function(e,t,n,r){var o={Name:e,StartTime:t,StopTime:n};if(r){var i=r.reduce((function(e,t){var n,r=t.value;switch(typeof r){case"object":n=r instanceof Date?r.toISOString():JSON.stringify(r);break;default:n=""+r}return e[t.name]=n,e}),{});o.Parameters=i}return o},e.prototype.addStopwatch=function(e,t){return new r.default(this,e,Date.now(),t)},e.prototype.addRetroactiveStopwatch=function(e,t,r,o){if(e&&t&&r&&!(t>r)){var s=new n.default(e,t,r);this.saveMetric(s,o)}else this._applicationContext.EventManager.ReportTraceError(new a.ComponentError(i.default.PERFORMANCE,"Attempt to create retroactive stopwatch from invalid data",a.ErrorCode.GENERIC),[{name:l.PerformanceEventParameterName.StopwatchName,value:e},{name:l.PerformanceEventParameterName.StartTime,value:t},{name:l.PerformanceEventParameterName.StopTime,value:r}])},e.prototype.addMarker=function(e,t){var r=new n.default(e,Date.now(),-1);this.saveMetric(r,t)},e.prototype.disable=function(){this._collectionEnabled=!1},e.prototype.setBooted=function(){this._isBooting=!1},e.prototype.saveMetric=function(e,t){var n=this,r=this._bcd.showPerformance||this._isBooting;if(-1!==e.startTime){if(this._collectionEnabled||r){var o="MailApp."+e.name,a=this._createStoredPerformanceMetric(o,e.startTime,e.stopTime,t);this._collectionEnabled?this._unstoredMetrics.push(a):r&&this._applicationContext.Bridge.deviceEventWithNamespace(u.default.APPLICATION,"ReportPerformance",a)}else this._applicationContext.EventManager.ReportComponentPerformance(i.default.PERFORMANCE,e,t);this._unloadListenerAttached||(s.default.addEventListener("unload",(function(e){n._collectionEnabled&&n._storeMetrics()})),this._unloadListenerAttached=!0)}else this._applicationContext.EventManager.ReportTraceWarning(i.default.PERFORMANCE,"Attempt to save PerformanceMetric with no startTime provided",e.name)},e.prototype.getMetrics=function(){var e=this._applicationContext.Storage.getItem(o.default.perfMetricStore)||[],t=this._unstoredMetrics.concat(e);return JSON.stringify(t)},e.prototype.clear=function(){this._applicationContext.Storage.removeItem(o.default.perfMetricStore),this._unstoredMetrics=[]},e.prototype._storeMetrics=function(){var e=this._applicationContext.Storage.getItem(o.default.perfMetricStore)||[];this._unstoredMetrics.forEach((function(t){return e.push(t)})),this._applicationContext.Storage.setItem(o.default.perfMetricStore,e),this._unstoredMetrics=[]},e}();t.default=c}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});r=[n,t,n(101)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,n,r,o){void 0===r&&(r=-1);var i=e.call(this,n,r)||this;return i._perfStorage=t,i._params=o,i}return a(t,e),t.prototype.start=function(){-1===this.startTime&&(this.startTime=Date.now())},t.prototype.stop=function(){this.stopTime=Date.now(),this._perfStorage.saveMetric(this,this._params)},t}(n.default);t.default=r}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(4),n(46),n(47),n(102),n(239),n(40),n(3),n(0),n(8),n(25),n(6),n(257)],void 0===(o=function(e,t,n,r,o,i,a,s,l,u,c,d,p,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=u.default.EVENT_MANAGER+".PrimaryLoad",h=u.default.EVENT_MANAGER+".SecondaryLoad",m=u.default.EVENT_MANAGER+".PinnedModeLoad",v=function(){function e(e,t,n){void 0===n&&(n=[]),this._initialized=!1,this._bcd=e,this._applicationContext=t,this._eventListeners=n,this._ariaEventListener=new a.default(this._applicationContext),this._eventListeners.unshift(this._ariaEventListener)}return e.prototype.Initialize=function(){this._initialized||(this._initialized=!0,this._eventManagerInitialized())},e.prototype.ReportComponentPerformance=function(e,t,i){var a=new o.default(n.EVENT_NAME.Performance,r.ApplicationEventLevel.Info),s="MailApp."+t.name,l=new Date(t.startTime).toISOString(),u=t.stopTime-t.startTime;a.addEventParameter(n.EventParameterName.ComponentName,e),a.addEventParameter(n.PerformanceEventParameterName.MetricName,s),a.addEventParameter(n.PerformanceEventParameterName.StartTime,l),a.addEventParameter(n.PerformanceEventParameterName.MetricValue,u),this._dispatch(a,i)},e.prototype.ReportComponentSuccess=function(e,t,i){var a=new o.default(n.EVENT_NAME.MonitorSuccess,r.ApplicationEventLevel.Info);a.addEventParameter(n.EventParameterName.ComponentName,e),t&&a.addEventParameter(n.EventParameterName.Message,t),this._dispatch(a,i)},e.prototype.ReportComponentFailure=function(e,t){var r=this._getErrorApplicationEvent(n.EVENT_NAME.MonitorFailure,e);this._dispatch(r,t,i.SendPriority.High)},e.prototype.ReportTraceInfo=function(e,t,o,i){var a=this._getTraceEvent(e,t,r.ApplicationEventLevel.Info);o&&a.addEventParameter(n.EventParameterName.Data,o),this._dispatch(a,i)},e.prototype.ReportTraceWarning=function(e,t,o,i){var a=this._getTraceEvent(e,t,r.ApplicationEventLevel.Warning);o&&a.addEventParameter(n.EventParameterName.Data,o),this._dispatch(a,i)},e.prototype.ReportTraceError=function(e,t){var r=this._getErrorApplicationEvent(n.EVENT_NAME.TraceEvent,e);this._dispatch(r,t)},e.prototype.getSessionId=function(){return this._activeSessionId},e.prototype.onMailboxItemChanged=function(){var e;this._contextId=d.default.newGuid().guid,this.ReportTraceInfo(m,"Application loaded in pinned mode");var t=((e={})[n.EventParameterName.ShimContextId]=this._contextId,e.ShimSessionId=this.getSessionId(),e[n.SessionContextParameterName.ShimVersion]=l.default.shimVersion(),e);this._applicationContext.Bridge.changeStateForDispatcher(p.default.APPLICATION,"TelemetryEventsParams",t)},e.prototype.setHostActivityId=function(e){this._hostActivityId=e},e.prototype.resetHostActivityId=function(){this._hostActivityId=null},e.prototype._getErrorApplicationEvent=function(e,t){var i=new o.default(e,r.ApplicationEventLevel.Error),a=s.ensureComponentErrorObject(t);return i.addEventParameter(n.EventParameterName.ComponentName,a.componentName),i.addEventParameter(n.EventParameterName.Message,a.message),i.addEventParameter(n.ErrorEventParameterName.CallStack,a.stack||"No stack available"),i.addEventParameter(n.ErrorEventParameterName.ErrorCode,a.code),t.innerError&&(i.addEventParameter(n.ErrorEventParameterName.InnerErrorComponentName,t.innerError.componentName),i.addEventParameter(n.ErrorEventParameterName.InnerError,t.innerError)),i},e.prototype._getTraceEvent=function(e,t,i){var a=new o.default(n.EVENT_NAME.TraceEvent,i),s=r.APPLICATION_LEVEL_TO_TRACER_LEVEL_STRING[i];return a.addEventParameter(n.EventParameterName.ComponentName,e),a.addEventParameter(n.EventParameterName.Message,t),a.addEventParameter(n.EventParameterName.TraceLevel,s),a},e.prototype._refreshSessionContext=function(){if(!f.isSessionContextFulfilled){var e=f.getSessionContext(this._bcd,this._applicationContext,this._activeSessionId);this._ariaEventListener.setSessionContext(e)}},e.prototype._dispatch=function(e,t,n){this._refreshSessionContext(),this._extendParameters(e,t),this._eventListeners.forEach((function(t){t.handleEvent(e,n)}))},e.prototype._eventManagerInitialized=function(){this._activeSessionId=this._setSessionId(this._bcd.secondaryLoad),this._sessionInitTime=this._setSessionInitTime(this._bcd.secondaryLoad);var e=this._bcd.secondaryLoad?h:_,t=[{name:n.EventParameterName.TimeSinceSessionInit,value:this._bcd.secondaryLoad?Date.now()-new Date(this._sessionInitTime).getTime():0},{name:n.PerformanceEventParameterName.StartTime,value:this._sessionInitTime}];this.ReportComponentSuccess(u.default.EVENT_MANAGER+".constructor"),this.ReportComponentSuccess(e,"Reporting Load Event",t)},e.prototype._setSessionId=function(e){var t=e?this._applicationContext.Storage.getItem(c.default.sessionId):null;return t||(t=d.default.newGuid().guid,this._applicationContext.Storage.setItem(c.default.sessionId,t)),t},e.prototype._setSessionInitTime=function(e){var t=e?this._applicationContext.Storage.getItem(c.default.initTime):null;return t||(t=JSON.stringify(new Date(l.default.PageLoadStartTime())).replace(/"/g,""),this._applicationContext.Storage.setItem(c.default.initTime,t)),t},e.prototype._extendParameters=function(e,t){var r=this._hostActivityId||this._activeSessionId;if(e.addEventParameter(n.KnownEventParameterName.ActivityId,r),e.addEventParameter(n.KnownEventParameterName.SessionId,this._activeSessionId),this._contextId&&e.addEventParameter(n.EventParameterName.ShimContextId,this._contextId),t&&t.length)for(var o=0,i=t;o<i.length;o++){var a=i[o];a&&e.addEventParameter(a.name,a.value)}e.addEventParameter(n.EventParameterName.NetworkConnectivityState,l.default.isOnline()?"online":"offline")},e}();t.default=v}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(240)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._isReporting=!0,this._telemetryClient=new n.default(e)}return e.prototype.handleEvent=function(e,t){this._isReporting&&this._telemetryClient.logEvent(e,t)},e.prototype.flushAndTearDown=function(){this._isReporting&&this._telemetryClient&&(this._telemetryClient.flushAndTearDown(),this._isReporting=!1,this._telemetryClient=null)},e.prototype.setSessionContext=function(e){this._telemetryClient.setAWTSemanticContext(e)},e}();t.default=r}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(241),n(0),n(4),n(47),n(102),n(98),n(3),n(255),n(256)],void 0===(o=function(e,t,n,r,o,i,a,s,l,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function e(e){this._AWTInit(e)}return e.prototype.getAriaProjectId=function(){return this._ariaProjectId=u.getAriaKeyForOrigin(s.getHostname()),this._ariaProjectId},e.prototype.setAWTSemanticContext=function(e){if(void 0!==this._defaultAriaLogger&&this._defaultAriaLogger.getSemanticContext()){for(var t in e)if(!this._isAriaCommonParameter(t)){var r=i.toSimpleTypeValue(e[t]);this._defaultAriaLogger.setContext(t,r,n.AWTPropertyType.Unspecified)}this._defaultAriaLogger.setContext(o.KnownEventParameterName.UserAgent,window.navigator.userAgent,n.AWTPropertyType.String),this._defaultAriaLogger.setContext(o.KnownEventParameterName.Origin,s.getHostname(),n.AWTPropertyType.String)}},e.prototype.logEvent=function(e,t){if(void 0!==this._defaultAriaLogger){var r=new n.AWTEventProperties(e.getAriaEventName());this._setEventPriority(r,t),r.setProperty("ActivityId",e.getActivityId(),n.AWTPropertyType.String);var o=e.toData().EventValues;for(var i in o)this._isAriaCommonParameter(i)||r.setProperty(i,o[i],n.AWTPropertyType.Unspecified);this._defaultAriaLogger.logEvent(r)}},e.prototype.flushAndTearDown=function(){n.AWTLogManager.flushAndTeardown()},e.prototype._AWTInit=function(e){var t=this,o=this.getAriaProjectId();void 0!==o&&(u.isGCCHighAriaKey(o)?this._defaultAriaLogger=n.AWTLogManager.initialize(o,{collectorUri:n.AWT_COLLECTOR_URL_USGOV_DOJ}):u.isUSDoDAriaKey(o)?this._defaultAriaLogger=n.AWTLogManager.initialize(o,{collectorUri:n.AWT_COLLECTOR_URL_USGOV_DOD}):this._defaultAriaLogger=n.AWTLogManager.initialize(o),this._archiver=new c.default(e),l.default.addEventListener("beforeunload",this._onBeforeUnload),n.AWTLogManager.addNotificationListener({eventsSent:function(e){var n=t._archiver.getEventBatch();n&&n.Events.map((function(e){return t._defaultAriaLogger.logEvent(e)}))},eventsDropped:function(e,n){t._archiver.archiveEventsBatch(e)},eventsRejected:function(t,o){o!==n.AWTEventsRejectedReason.KillSwitch&&e.EventManager.ReportTraceWarning(r.default.TELEMETRY_ARCHIVER,t.length+" events rejected.")},eventsRetrying:function(e){}}))},e.prototype._setEventPriority=function(e,t){void 0!==t&&(t===a.SendPriority.High?e.setEventPriority(n.AWTEventPriority.High):t===a.SendPriority.Low?e.setEventPriority(n.AWTEventPriority.Low):e.setEventPriority(n.AWTEventPriority.Normal))},e.prototype._onBeforeUnload=function(){n.AWTLogManager.flushAndTeardown()},e.prototype._isAriaCommonParameter=function(e){return e===o.KnownEventParameterName.TimeCreated},e}();t.default=d}.apply(t,r))||(e.exports=o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12);t.AWTPropertyType=r.AWTPropertyType,t.AWTPiiKind=r.AWTPiiKind,t.AWTEventPriority=r.AWTEventPriority,t.AWTEventsDroppedReason=r.AWTEventsDroppedReason,t.AWTEventsRejectedReason=r.AWTEventsRejectedReason,t.AWTCustomerContentKind=r.AWTCustomerContentKind;var o=n(48);t.AWTUserIdType=o.AWTUserIdType,t.AWTSessionState=o.AWTSessionState;var i=n(103);t.AWT_BEST_EFFORT=i.AWT_BEST_EFFORT,t.AWT_NEAR_REAL_TIME=i.AWT_NEAR_REAL_TIME,t.AWT_REAL_TIME=i.AWT_REAL_TIME;var a=n(49);t.AWTEventProperties=a.default;var s=n(104);t.AWTLogger=s.default;var l=n(108);t.AWTLogManager=l.default;var u=n(254);t.AWTTransmissionManager=u.default;var c=n(106);t.AWTSerializer=c.default;var d=n(74);t.AWTSemanticContext=d.default,t.AWT_COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_USGOV_DOD="https://pf.pipe.aria.microsoft.com/Collector/3.0",t.AWT_COLLECTOR_URL_USGOV_DOJ="https://tb.pipe.aria.microsoft.com/Collector/3.0"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),o=n(243),i=n(42),a=n(253),s=n(31),l=function(){function e(e,t,n,i){this._queueSizeLimit=t,this._isCurrentlyUploadingNow=!1,this._uploadNowQueue=[],this._shouldDropEventsOnPause=!1,this._paused=!1,this._queueSize=0,this._outboundQueue=[],this._inboundQueues={},this._inboundQueues[r.AWTEventPriority.High]=[],this._inboundQueues[r.AWTEventPriority.Normal]=[],this._inboundQueues[r.AWTEventPriority.Low]=[],this._addEmptyQueues(),this._batcher=new a.default(this._outboundQueue,500),this._httpManager=new o.default(this._outboundQueue,e,this,n,i)}return e.prototype.addEvent=function(e){e.priority===r.AWTEventPriority.Immediate_sync?this._httpManager.sendSynchronousRequest(this._batcher.addEventToBatch(e),e.apiKey):this._queueSize<this._queueSizeLimit?this._addEventToProperQueue(e):this._dropEventWithPriorityOrLess(e.priority)?this._addEventToProperQueue(e):s.default.eventsDropped([e],r.AWTEventsDroppedReason.QueueFull)},e.prototype.sendEventsForPriorityAndAbove=function(e){this._batchEvents(e),this._httpManager.sendQueuedRequests()},e.prototype.hasEvents=function(){return(this._inboundQueues[r.AWTEventPriority.High][0].length>0||this._inboundQueues[r.AWTEventPriority.Normal][0].length>0||this._inboundQueues[r.AWTEventPriority.Low][0].length>0||this._batcher.hasBatch())&&this._httpManager.hasIdleConnection()},e.prototype.addBackRequest=function(e){if(!this._paused||!this._shouldDropEventsOnPause){for(var t in e)if(e.hasOwnProperty(t))for(var n=0;n<e[t].length;++n)e[t][n].sendAttempt<6?this.addEvent(e[t][n]):s.default.eventsDropped([e[t][n]],r.AWTEventsDroppedReason.NonRetryableStatus);i.default.scheduleTimer()}},e.prototype.teardown=function(){this._paused||(this._batchEvents(r.AWTEventPriority.Low),this._httpManager.teardown())},e.prototype.uploadNow=function(e){var t=this;this._addEmptyQueues(),this._isCurrentlyUploadingNow?this._uploadNowQueue.push(e):(this._isCurrentlyUploadingNow=!0,setTimeout((function(){return t._uploadNow(e)}),0))},e.prototype.pauseTransmission=function(){this._paused=!0,this._httpManager.pause(),this.shouldDropEventsOnPause&&(this._queueSize-=this._inboundQueues[r.AWTEventPriority.High][0].length+this._inboundQueues[r.AWTEventPriority.Normal][0].length+this._inboundQueues[r.AWTEventPriority.Low][0].length,this._inboundQueues[r.AWTEventPriority.High][0]=[],this._inboundQueues[r.AWTEventPriority.Normal][0]=[],this._inboundQueues[r.AWTEventPriority.Low][0]=[],this._httpManager.removeQueuedRequests())},e.prototype.resumeTransmission=function(){this._paused=!1,this._httpManager.resume()},e.prototype.shouldDropEventsOnPause=function(e){this._shouldDropEventsOnPause=e},e.prototype._removeFirstQueues=function(){this._inboundQueues[r.AWTEventPriority.High].shift(),this._inboundQueues[r.AWTEventPriority.Normal].shift(),this._inboundQueues[r.AWTEventPriority.Low].shift()},e.prototype._addEmptyQueues=function(){this._inboundQueues[r.AWTEventPriority.High].push([]),this._inboundQueues[r.AWTEventPriority.Normal].push([]),this._inboundQueues[r.AWTEventPriority.Low].push([])},e.prototype._addEventToProperQueue=function(e){this._paused&&this._shouldDropEventsOnPause||(this._queueSize++,this._inboundQueues[e.priority][this._inboundQueues[e.priority].length-1].push(e))},e.prototype._dropEventWithPriorityOrLess=function(e){for(var t=r.AWTEventPriority.Low;t<=e;){if(this._inboundQueues[t][this._inboundQueues[t].length-1].length>0)return s.default.eventsDropped([this._inboundQueues[t][this._inboundQueues[t].length-1].shift()],r.AWTEventsDroppedReason.QueueFull),!0;t++}return!1},e.prototype._batchEvents=function(e){for(var t=r.AWTEventPriority.High;t>=e;){for(;this._inboundQueues[t][0].length>0;){var n=this._inboundQueues[t][0].pop();this._queueSize--,this._batcher.addEventToBatch(n)}t--}this._batcher.flushBatch()},e.prototype._uploadNow=function(e){var t=this;this.hasEvents()&&this.sendEventsForPriorityAndAbove(r.AWTEventPriority.Low),this._checkOutboundQueueEmptyAndSent((function(){t._removeFirstQueues(),null!=e&&e(),t._uploadNowQueue.length>0?setTimeout((function(){return t._uploadNow(t._uploadNowQueue.shift())}),0):(t._isCurrentlyUploadingNow=!1,t.hasEvents()&&i.default.scheduleTimer())}))},e.prototype._checkOutboundQueueEmptyAndSent=function(e){var t=this;this._httpManager.isCompletelyIdle()?e():setTimeout((function(){return t._checkOutboundQueueEmptyAndSent(e)}),250)},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),o=n(106),i=n(250),a=n(251),s=n(252),l=n(107),u=n(27),c=n(31),d=n(42),p=function(){function e(e,t,n,r,o){var i=this;this._requestQueue=e,this._queueManager=n,this._httpInterface=r,this._urlString="?qsp=true&content-type=application%2Fbond-compact-binary&client-id=NO_AUTH&sdk-version="+l.FullVersionString,this._killSwitch=new a.default,this._paused=!1,this._useBeacons=!1,this._activeConnections=0,this._clockSkewManager=new s.default(o),u.isUint8ArrayAvailable()||(this._urlString+="&content-encoding=base64"),this._urlString=t+this._urlString,this._httpInterface||(this._useBeacons=!u.isReactNative(),this._httpInterface={sendPOST:function(e,t,n,r,o,a){try{if(u.useXDomainRequest()){var s=new XDomainRequest;s.open("POST",e),s.onload=function(){o(200,null)},s.onerror=function(){r(400,null)},s.ontimeout=function(){n(500,null)},s.send(t)}else if(u.isReactNative())fetch(e,{body:t,method:"POST"}).then((function(e){var t={};e.headers&&e.headers.forEach((function(e,n){t[n]=e})),o(e.status,t)})).catch((function(e){r(0,{})}));else{var l=new XMLHttpRequest;l.open("POST",e,!a),l.onload=function(){o(l.status,i._convertAllHeadersToMap(l.getAllResponseHeaders()))},l.onerror=function(){r(l.status,i._convertAllHeadersToMap(l.getAllResponseHeaders()))},l.ontimeout=function(){n(l.status,i._convertAllHeadersToMap(l.getAllResponseHeaders()))},l.send(t)}}catch(e){r(400,null)}}})}return e.prototype.hasIdleConnection=function(){return this._activeConnections<2},e.prototype.sendQueuedRequests=function(){for(;this.hasIdleConnection()&&!this._paused&&this._requestQueue.length>0&&this._clockSkewManager.allowRequestSending();)this._activeConnections++,this._sendRequest(this._requestQueue.shift(),0,!1);this.hasIdleConnection()&&d.default.scheduleTimer()},e.prototype.isCompletelyIdle=function(){return 0===this._activeConnections},e.prototype.teardown=function(){for(;this._requestQueue.length>0;)this._sendRequest(this._requestQueue.shift(),0,!0)},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1,this.sendQueuedRequests()},e.prototype.removeQueuedRequests=function(){this._requestQueue.length=0},e.prototype.sendSynchronousRequest=function(e,t){this._paused&&(e[t][0].priority=r.AWTEventPriority.High),this._activeConnections++,this._sendRequest(e,0,!1,!0)},e.prototype._sendRequest=function(e,t,n,i){var a=this;void 0===i&&(i=!1);try{if(this._paused)return this._activeConnections--,void this._queueManager.addBackRequest(e);var s=0,l="";for(var d in e)e.hasOwnProperty(d)&&(this._killSwitch.isTenantKilled(d)?(c.default.eventsRejected(e[d],r.AWTEventsRejectedReason.KillSwitch),delete e[d]):(l.length>0&&(l+=","),l+=d,s++));if(s>0){var p=o.default.getPayloadBlob(e,s);p.remainingRequest&&this._requestQueue.push(p.remainingRequest);var f=this._urlString+"&x-apikey="+l+"&client-time-epoch-millis="+Date.now().toString();this._clockSkewManager.shouldAddClockSkewHeaders()&&(f=f+"&time-delta-to-apply-millis="+this._clockSkewManager.getClockSkewHeaderValue());var _=void 0;for(var d in _=u.isUint8ArrayAvailable()?new Uint8Array(p.payloadBlob):o.default.base64Encode(p.payloadBlob),e)if(e.hasOwnProperty(d))for(var h=0;h<e[d].length;++h)e[d][h].sendAttempt>0?e[d][h].sendAttempt++:e[d][h].sendAttempt=1;if(this._useBeacons&&n&&u.isBeaconsSupported()&&navigator.sendBeacon(f,_))return;this._httpInterface.sendPOST(f,_,(function(r,o){a._retryRequestIfNeeded(r,o,e,s,l,t,n,i)}),(function(r,o){a._retryRequestIfNeeded(r,o,e,s,l,t,n,i)}),(function(r,o){a._retryRequestIfNeeded(r,o,e,s,l,t,n,i)}),n||i)}else n||this._handleRequestFinished(!1,{},n,i)}catch(e){this._handleRequestFinished(!1,{},n,i)}},e.prototype._retryRequestIfNeeded=function(e,t,n,o,a,s,l,u){var p=this,f=!0;if(void 0!==e){if(t){var _=this._killSwitch.setKillSwitchTenants(t["kill-tokens"],t["kill-duration-seconds"]);this._clockSkewManager.setClockSkew(t["time-delta-millis"]);for(var h=0;h<_.length;++h)c.default.eventsRejected(n[_[h]],r.AWTEventsRejectedReason.KillSwitch),delete n[_[h]],o--}else this._clockSkewManager.setClockSkew(null);if(200===e)return void this._handleRequestFinished(!0,n,l,u);(!i.default.shouldRetryForStatus(e)||o<=0)&&(f=!1)}if(f)if(u)this._activeConnections--,n[a][0].priority=r.AWTEventPriority.High,this._queueManager.addBackRequest(n);else if(s<1){for(var m in n)n.hasOwnProperty(m)&&c.default.eventsRetrying(n[m]);setTimeout((function(){return p._sendRequest(n,s+1,!1)}),i.default.getMillisToBackoffForRetry(s))}else this._activeConnections--,d.default.backOffTransmission(),this._queueManager.addBackRequest(n);else this._handleRequestFinished(!1,n,l,u)},e.prototype._handleRequestFinished=function(e,t,n,o){for(var i in e&&d.default.clearBackOff(),t)t.hasOwnProperty(i)&&(e?c.default.eventsSent(t[i]):c.default.eventsDropped(t[i],r.AWTEventsDroppedReason.NonRetryableStatus));this._activeConnections--,o||n||this.sendQueuedRequests()},e.prototype._convertAllHeadersToMap=function(e){var t={};if(e)for(var n=e.split("\n"),r=0;r<n.length;++r){var o=n[r].split(": ");t[o[0]]=o[1]}return t},e}();t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(245);t._BondDataType=r._BondDataType;var o=n(246);t._Encoding=o;var i=n(249);t.IO=i;var a=n(50);t.Int64=a.Int64,t.UInt64=a.UInt64,t.Number=a.Number;var s=function(){function e(e){this._stream=e}return e.prototype._WriteBlob=function(e){this._stream._Write(e,0,e.length)},e.prototype._WriteBool=function(e){this._stream._WriteByte(e?1:0)},e.prototype._WriteContainerBegin=function(e,t){this._WriteUInt8(t),this._WriteUInt32(e)},e.prototype._WriteMapContainerBegin=function(e,t,n){this._WriteUInt8(t),this._WriteUInt8(n),this._WriteUInt32(e)},e.prototype._WriteDouble=function(e){var t=o._Double_GetBytes(e);this._stream._Write(t,0,t.length)},e.prototype._WriteFieldBegin=function(e,t,n){t<=5?this._stream._WriteByte(e|t<<5):t<=255?(this._stream._WriteByte(192|e),this._stream._WriteByte(t)):(this._stream._WriteByte(224|e),this._stream._WriteByte(t),this._stream._WriteByte(t>>8))},e.prototype._WriteInt32=function(e){e=o._Zigzag_EncodeZigzag32(e),this._WriteUInt32(e)},e.prototype._WriteInt64=function(e){this._WriteUInt64(o._Zigzag_EncodeZigzag64(e))},e.prototype._WriteString=function(e){if(""===e)this._WriteUInt32(0);else{var t=o._Utf8_GetBytes(e);this._WriteUInt32(t.length),this._stream._Write(t,0,t.length)}},e.prototype._WriteStructEnd=function(e){this._WriteUInt8(e?r._BondDataType._BT_STOP_BASE:r._BondDataType._BT_STOP)},e.prototype._WriteUInt32=function(e){var t=o._Varint_GetBytes(a.Number._ToUInt32(e));this._stream._Write(t,0,t.length)},e.prototype._WriteUInt64=function(e){var t=o._Varint64_GetBytes(e);this._stream._Write(t,0,t.length)},e.prototype._WriteUInt8=function(e){this._stream._WriteByte(a.Number._ToUInt8(e))},e}();t.CompactBinaryProtocolWriter=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e._BT_STOP=0]="_BT_STOP",e[e._BT_STOP_BASE=1]="_BT_STOP_BASE",e[e._BT_BOOL=2]="_BT_BOOL",e[e._BT_DOUBLE=8]="_BT_DOUBLE",e[e._BT_STRING=9]="_BT_STRING",e[e._BT_STRUCT=10]="_BT_STRUCT",e[e._BT_LIST=11]="_BT_LIST",e[e._BT_MAP=13]="_BT_MAP",e[e._BT_INT32=16]="_BT_INT32",e[e._BT_INT64=17]="_BT_INT64"}(t._BondDataType||(t._BondDataType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(50),o=n(247),i=n(248);t._Utf8_GetBytes=function(e){for(var t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?t.push(192|r>>6,128|63&r):r<55296||r>=57344?t.push(224|r>>12,128|r>>6&63,128|63&r):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++n)),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return t},t._Base64_GetString=function(e){for(var t,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[],o=e.length%3,i=0,a=e.length-o;i<a;i+=3){var s=(e[i]<<16)+(e[i+1]<<8)+e[i+2];r.push([n.charAt((t=s)>>18&63),n.charAt(t>>12&63),n.charAt(t>>6&63),n.charAt(63&t)].join(""))}switch(o){case 1:s=e[e.length-1];r.push(n.charAt(s>>2)),r.push(n.charAt(s<<4&63)),r.push("==");break;case 2:var l=(e[e.length-2]<<8)+e[e.length-1];r.push(n.charAt(l>>10)),r.push(n.charAt(l>>4&63)),r.push(n.charAt(l<<2&63)),r.push("=")}return r.join("")},t._Varint_GetBytes=function(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t},t._Varint64_GetBytes=function(e){for(var t=e.low,n=e.high,r=[];n||4294967168&t;)r.push(127&t|128),t=(127&n)<<25|t>>>7,n>>>=7;return r.push(127&t),r},t._Double_GetBytes=function(e){if(i.BrowserChecker._IsDataViewSupport()){var t=new DataView(new ArrayBuffer(8));t.setFloat64(0,e,!0);for(var n=[],r=0;r<8;++r)n.push(t.getUint8(r));return n}return o.FloatUtils._ConvertNumberToArray(e,!0)},t._Zigzag_EncodeZigzag32=function(e){return(e=r.Number._ToInt32(e))<<1^e>>31},t._Zigzag_EncodeZigzag64=function(e){var t=e.low,n=e.high,o=n<<1|t>>>31,i=t<<1;2147483648&n&&(o=~o,i=~i);var a=new r.UInt64("0");return a.low=i,a.high=o,a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e._ConvertNumberToArray=function(e,t){if(!e)return t?this._doubleZero:this._floatZero;var n=t?52:23,r=(1<<(t?11:8)-1)-1,o=1-r,i=r,a=e<0?1:0;e=Math.abs(e);for(var s=Math.floor(e),l=e-s,u=2*(r+2)+n,c=new Array(u),d=0;d<u;)c[d++]=0;for(d=r+2;d&&s;)c[--d]=s%2,s=Math.floor(s/2);for(d=r+1;d<u-1&&l>0;)(l*=2)>=1?(c[++d]=1,--l):c[++d]=0;for(var p=0;p<u&&!c[p];)p++;var f=r+1-p,_=p+n;if(c[_+1]){for(d=_;d>p&&(c[d]=1-c[d],!c);--d);d===p&&++f}if(f>i||s)return a?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity;if(f<o)return t?this._doubleZero:this._floatZero;if(t){var h=0;for(d=0;d<20;++d)h=h<<1|c[++p];for(var m=0;d<52;++d)m=m<<1|c[++p];return[255&m,m>>8&255,m>>16&255,m>>>24,255&(h=a<<31|2147483647&(h|=f+r<<20)),h>>8&255,h>>16&255,h>>>24]}var v=0;for(d=0;d<23;++d)v=v<<1|c[++p];return[255&(v=a<<31|2147483647&(v|=f+r<<23)),v>>8&255,v>>16&255,v>>>24]},e._floatZero=[0,0,0,0],e._doubleZero=[0,0,0,0,0,0,0,0],e._floatInifinity=[0,0,128,127],e._floatNegInifinity=[0,0,128,255],e._doubleInifinity=[0,0,0,0,0,0,240,127],e._doubleNegInifinity=[0,0,0,0,0,0,240,255],e}();t.FloatUtils=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e._IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},e}();t.BrowserChecker=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(50),o=function(){function e(){this._buffer=[]}return e.prototype._WriteByte=function(e){this._buffer.push(r.Number._ToByte(e))},e.prototype._Write=function(e,t,n){for(;n--;)this._WriteByte(e[t++])},e.prototype._GetBuffer=function(){return this._buffer},e}();t.MemoryStream=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!==e||501===e||505===e)},e.getMillisToBackoffForRetry=function(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(4,e)*n,Math.min(t,12e4)},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._killedTokenDictionary={}}return e.prototype.setKillSwitchTenants=function(e,t){if(e&&t)try{var n=e.split(",");if("this-request-only"===t)return n;for(var r=1e3*parseInt(t,10),o=0;o<n.length;++o)this._killedTokenDictionary[n[o]]=Date.now()+r}catch(e){return[]}return[]},e.prototype.isTenantKilled=function(e){return void 0!==this._killedTokenDictionary[e]&&this._killedTokenDictionary[e]>Date.now()||(delete this._killedTokenDictionary[e],!1)},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.clockSkewRefreshDurationInMins=e,this._reset()}return e.prototype.allowRequestSending=function(){return this._isFirstRequest&&!this._clockSkewSet?(this._isFirstRequest=!1,this._allowRequestSending=!1,!0):this._allowRequestSending},e.prototype.shouldAddClockSkewHeaders=function(){return this._shouldAddClockSkewHeaders},e.prototype.getClockSkewHeaderValue=function(){return this._clockSkewHeaderValue},e.prototype.setClockSkew=function(e){this._clockSkewSet||(e?this._clockSkewHeaderValue=e:this._shouldAddClockSkewHeaders=!1,this._clockSkewSet=!0,this._allowRequestSending=!0)},e.prototype._reset=function(){var e=this;this._isFirstRequest=!0,this._clockSkewSet=!1,this._allowRequestSending=!0,this._shouldAddClockSkewHeaders=!0,this._clockSkewHeaderValue="use-collector-delta",this.clockSkewRefreshDurationInMins>0&&setTimeout((function(){return e._reset()}),6e4*this.clockSkewRefreshDurationInMins)},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),o=function(){function e(e,t){this._outboundQueue=e,this._maxNumberOfEvents=t,this._currentBatch={},this._currentNumEventsInBatch=0}return e.prototype.addEventToBatch=function(e){if(e.priority===r.AWTEventPriority.Immediate_sync){var t={};return t[e.apiKey]=[e],t}return this._currentNumEventsInBatch>=this._maxNumberOfEvents&&this.flushBatch(),void 0===this._currentBatch[e.apiKey]&&(this._currentBatch[e.apiKey]=[]),this._currentBatch[e.apiKey].push(e),this._currentNumEventsInBatch++,null},e.prototype.flushBatch=function(){this._currentNumEventsInBatch>0&&(this._outboundQueue.push(this._currentBatch),this._currentBatch={},this._currentNumEventsInBatch=0)},e.prototype.hasBatch=function(){return this._currentNumEventsInBatch>0},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(42),o=function(){function e(){}return e.setEventsHandler=function(e){r.default.setEventsHandler(e)},e.getEventsHandler=function(){return r.default.getEventsHandler()},e.scheduleTimer=function(){r.default.scheduleTimer()},e}();t.default=o},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=[{id:"PROD",ariaIngestionKey:"0b14a44360bf4cae8e1e090ac91a04e5-3c17b97e-6b3a-4a9b-8407-6e450ff03cd2-7084",allowedOriginRegex:/.*\.crm([2-8]|11|12|14|15)?\.dynamics\.com$/},{id:"GCCHigh",ariaIngestionKey:"7d390bf951b748828d76e5d3c027faa0-9ef46ec8-2e5e-40ba-9f69-b4a13b9feca1-7148",allowedOriginRegex:/.*\.crm\.microsoftdynamics\.us$/},{id:"USDoD",ariaIngestionKey:"8ed6ca832b3c48d48be9c06fdc376398-e81cde17-794e-4380-852b-d01450e08d5c-7306",allowedOriginRegex:/.*\.crm\.appsplatform\.us$/},{id:"GCCModerate",ariaIngestionKey:"774241b9d70e40efb34ddfb995dbfb92-37f51c02-1551-4d6c-acdd-de4f47ee6a98-7274",allowedOriginRegex:/.*\.crm9\.dynamics\.com$/},{id:"Blackforest",ariaIngestionKey:"1d4b56b9dd4d4ca098d7fa7c7af55ece-55115f9e-4619-474c-9aab-80a9f2027a5b-6876",allowedOriginRegex:/.*\.crm\.microsoftdynamics\.de$/},{id:"Mooncake",ariaIngestionKey:"",allowedOriginRegex:/.*\.crm\.microsoftdynamics\.cn$/},{id:"TIP",ariaIngestionKey:"0b14a44360bf4cae8e1e090ac91a04e5-3c17b97e-6b3a-4a9b-8407-6e450ff03cd2-7084",allowedOriginRegex:/.*\.crm10\.dynamics\.com$/},{id:"TEST",ariaIngestionKey:"2602733e020348908569f871ef40fc4b-ecb43f9d-b1e2-4034-aee3-f38471962c48-7333",allowedOriginRegex:/(.*\.crm\.dynamics-int\.com$|.*\.crm[2]?\.crmlivetie\.com$|.*\.contoso\.com:444$|.*\.microsoft\.com$|.*\.msmecrm\.com$|.*\.crm\.crmlivetoday\.com$|.*\.crm\.1boxtest\.com$|.*\.mocaifd\d*\.com:444$|.*\.crm\.crmifd\.com$|.*\.msmecrm\.com:444$|.*localhost.*)/}];function r(e){var t,r=n.find((function(t){return t.id===e}));return void 0!==r&&(t=r.ariaIngestionKey),t}t.getAriaKeyForOrigin=function(e){var t,r=n.find((function(t){return t.allowedOriginRegex.test(e)}));return void 0!==r&&(t=r.ariaIngestionKey),t},t.getAriaKeyForEnvironment=r,t.isGCCHighAriaKey=function(e){return e===r("GCCHigh")},t.isUSDoDAriaKey=function(e){return e===r("USDoD")}}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(8),n(3)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){var t=this;this._archiveStoreKey=n.default.ariaTelemetry,this._MAX_STORED_BATCHES=450,this._applicationContext=e,r.default.addEventListener("unload",(function(){return t._writeEventsToStorage()}))}return e.prototype.archiveEventsBatch=function(e){this._receiveEventsBatch(e)},e.prototype.getEventBatch=function(){if(this._storedEvents||this._loadEventsFromStorage(),0!==this._storedEvents.length)return this._storedEvents.shift()},e.prototype._receiveEventsBatch=function(e){if(e&&e.length){this._storedEvents||this._loadEventsFromStorage();var t=e.slice(),n={Created:Date.now(),Events:t,NumEvents:t.length};this._storedEvents.push(n)}},e.prototype._loadEventsFromStorage=function(){try{var e=this._applicationContext.Storage.getItem(this._archiveStoreKey);this._storedEvents=e&&JSON.parse(e)||[],this._applicationContext.Storage.removeItem(this._archiveStoreKey)}catch(e){this._storedEvents=[],console.error("[Telemetry] 'Retrieve Archive' failure"),console.dirxml(e),console.error(e.stack||e)}},e.prototype._writeEventsToStorage=function(){if(this._storedEvents)try{var e=JSON.stringify(this._storedEvents.slice(0,this._MAX_STORED_BATCHES));this._applicationContext.Storage.setItem(this._archiveStoreKey,e)}catch(e){console.error("[Telemetry] 'Store Save DB' failure"),console.dirxml(e),console.error(e.stack||e)}},e}();t.default=o}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(0),n(38),n(3),n(4)],void 0===(o=function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=!1;t.isSessionContextFulfilled=a,t.getSessionContext=function(e,s,l){var u={};return function(e,t){if(!e.ComponentsLoader||!e.ComponentsLoader.isComponentLoaded(n.default.JS_API_PROVIDER))return!1;var r=e.JsApiProvider.getMailboxDiagnostics();return t[i.SessionContextParameterName.HostName]=r&&r.hostName,t[i.SessionContextParameterName.HostVersion]=r&&r.hostVersion,t[i.SessionContextParameterName.OWAView]=r&&r.OWAView,t[i.SessionContextParameterName.InstallId]=e.JsApiProvider.getInstallId(),t[i.SessionContextParameterName.ItemType]=e.JsApiProvider.getMailboxItemType(),!0}(s,u)&&function(e,t,o){return!!t.ComponentsLoader&&(!(e.exchangeDeploymentEnvironment!==r.default.Online||!t.ComponentsLoader.isComponentLoaded(n.default.JS_API_PROVIDER)||!t.JsApiProvider.isRestCallbackTokenSupported())||!!t.ComponentsLoader.isComponentLoaded(n.default.EXCHANGE_PROVIDER)&&(!(!t.ExchangeProvider.ExchangeServerVersion||(o[i.SessionContextParameterName.ExchangeServerVersion]=t.ExchangeProvider.ExchangeServerVersion,!t.ExchangeProvider.EwsSchemaVersion))&&(o[i.SessionContextParameterName.EWSSchemaVersion]=t.ExchangeProvider.EwsSchemaVersion,!0)))}(e,s,u)&&(t.isSessionContextFulfilled=a=!0),u[i.SessionContextParameterName.DeploymentEnvironment]=r.default[e.crmDeploymentEnvironment],u[i.SessionContextParameterName.ExchangeDeploymentEnvironment]=r.default[e.exchangeDeploymentEnvironment],u[i.SessionContextParameterName.HostType]="MailApp",u[i.SessionContextParameterName.HostPlatform]=o.default.navigator().platform,u[i.SessionContextParameterName.MailboxId]=e.mailboxId,u[i.SessionContextParameterName.Mode]=e.displayMode,u[i.SessionContextParameterName.OrgId]=e.orgId,u[i.SessionContextParameterName.ShimVersion]=o.default.shimVersion(),u[i.SessionContextParameterName.ServerVersion]=o.default.appVersion(),u[i.SessionContextParameterName.SessionId]=l,u}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(0),n(1)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype._reportIfUndefined=function(e,t){if(!t){var n=new r.ComponentError(e,"Trying to access "+e+" before it is initialized",r.ErrorCode.GENERIC);throw this._eventManager&&this._eventManager.ReportComponentFailure(n),n}},Object.defineProperty(e.prototype,"AuthenticationProvider",{get:function(){return this._reportIfUndefined(n.default.AUTHENTICATION_PROVIDER,this._authenticationProvider),this._authenticationProvider},set:function(e){this._authenticationProvider=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EventManager",{get:function(){return this._reportIfUndefined(n.default.EVENT_MANAGER,this._eventManager),this._eventManager},set:function(e){this._eventManager=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Storage",{get:function(){return this._reportIfUndefined(n.default.STORAGE,this._storage),this._storage},set:function(e){this._storage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"JsApiProvider",{get:function(){return this._reportIfUndefined(n.default.JS_API_PROVIDER,this._jsApiProvider),this._jsApiProvider},set:function(e){this._jsApiProvider=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ExchangeProvider",{get:function(){return this._reportIfUndefined(n.default.EXCHANGE_PROVIDER,this._exchangeProvider),this._exchangeProvider},set:function(e){this._exchangeProvider=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Bridge",{get:function(){return this._reportIfUndefined(n.default.WEB_SCRIPT_BRIDGE,this._bridge),this._bridge},set:function(e){this._bridge=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CRMProvider",{get:function(){return this._reportIfUndefined(n.default.CRM_PROVIDER,this._crmProvider),this._crmProvider},set:function(e){this._crmProvider=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DispatcherCollection",{get:function(){return this._reportIfUndefined(n.default.DISPATCHER_COLLECTION,this._dispatcherCollection),this._dispatcherCollection},set:function(e){this._dispatcherCollection=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Performance",{get:function(){return this._reportIfUndefined(n.default.PERFORMANCE,this._performance),this._performance},set:function(e){this._performance=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OrgUrl",{get:function(){return this._orgUrl},set:function(e){this._orgUrl=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ResourceManager",{get:function(){return this._reportIfUndefined(n.default.RESOURCE_MANAGER,this._resourceManager),this._resourceManager},set:function(e){this._resourceManager=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UIManager",{get:function(){return this._reportIfUndefined(n.default.UI_MANAGER,this._uiManager),this._uiManager},set:function(e){this._uiManager=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ComponentsLoader",{get:function(){return this._componentsLoader},set:function(e){this._componentsLoader=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AppChecker",{get:function(){return this._reportIfUndefined(n.default.APP_CHECKER,this._appChecker),this._appChecker},set:function(e){this._appChecker=e},enumerable:!0,configurable:!0}),e}();t.default=o}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(3),n(8),n(260),n(97),n(264)],void 0===(o=function(e,t,n,r,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){this._bcd=e,this._appContext=t,this._storageItemsContainer={},this._validateStorageAccess()}return e.prototype._validateStorageAccess=function(){if(this._validationError=i.default.validateStorage(),!this._validationError)try{this._upgradeLocalStorage()}catch(e){}},e.prototype.getItem=function(e,t){return this._validationError?null:this._getStorageItem(e,t).getData()},e.prototype.setItem=function(e,t,n,r){this._validationError||this._getStorageItem(e,r).setData(t,n)},e.prototype.removeItem=function(e,t){this._validationError||(this._getStorageItem(e,t).removeData(),delete this._storageItemsContainer[e])},e.prototype.getItemExpiry=function(e,t){return this._validationError?null:this._getStorageItem(e,t).getDataExpiry()},e.prototype.validate=function(){return this._validationError},e.prototype.clearCache=function(){this._validationError||(n.default.localStorage().clear(),n.default.sessionStorage().clear())},e.prototype._getStorageItem=function(e,t){return this._storageItemsContainer[e]||(this._storageItemsContainer[e]=new o.default(this._bcd,this._appContext,e,t)),this._storageItemsContainer[e]},e.prototype._upgradeLocalStorage=function(){var e=n.default.localStorage().getItem(r.default.storageVersion),t=n.default.shimVersion();a.default(t,e)},e}();t.default=s}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(4),n(1),n(7),n(261),n(70),n(263)],void 0===(o=function(e,t,n,r,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t,n,r){if(this._applicationContext=t,this._storageKey=n,this._nativeStorage=a.default.getStorage(i.default[n].storageType),this._componentName=i.default[n].componentName,this._dataLifetime=i.default[n].lifetime,r)this._dataKey=r;else{switch(i.default[n].dataKey){case i.DATA_KEYS.UserEmail:this._dataKey=t.JsApiProvider.getUserEmailAddress();break;case i.DATA_KEYS.OrgId:this._dataKey=e.orgId;break;default:this._dataKey=i.default[n].dataKey}this._isRawValueKey=!this._dataKey}}return e.prototype._reportTraceError=function(e,t){this._applicationContext.EventManager.ReportTraceError(new r.ComponentError(this._componentName,e,r.ErrorCode.STORAGE_OPERATION),[{name:n.ErrorEventParameterName.Error,value:o.default.errorToObject(t)}])},e.prototype._getData=function(){var e;try{if(!(e=this._nativeStorage.getItem(this._storageKey)))return null}catch(e){return this._reportTraceError("Failed to get cached item from Storage for "+this._storageKey,e),null}try{return this._isRawValueKey?e:JSON.parse(e)}catch(e){return this._reportTraceError("Failed to parse cached data from Storage for "+this._storageKey,e),this._removeData(null,!0),null}},e.prototype._getMemorizedItem=function(){if(!this._memorizedCachedItem){this._applicationContext.EventManager.ReportTraceInfo(this._componentName,"Getting Storage data for key "+this._storageKey);var e=this._getData();e&&(this._applicationContext.EventManager.ReportTraceInfo(this._componentName,"Storage data retrieved for key "+this._storageKey),this._memorizedCachedItem=this._isRawValueKey?new s.default(e,0):e[this._dataKey])}return this._memorizedCachedItem?this._isExpired(this._memorizedCachedItem.timestamp)?(this._applicationContext.EventManager.ReportTraceInfo(this._componentName,"Storage data for key "+this._storageKey+" expired"),this.removeData(),null):this._memorizedCachedItem:(this._applicationContext.EventManager.ReportTraceInfo(this._componentName,"Data is empty in Storage for key "+this._storageKey),null)},e.prototype._removeData=function(e,t){if(void 0===t&&(t=!1),this._applicationContext.EventManager.ReportTraceInfo(this._componentName,"Clearing Storage data for key "+this._storageKey),this._isRawValueKey||t||!e||1===Object.keys(e).length)try{this._nativeStorage.removeItem(this._storageKey)}catch(e){this._reportTraceError("Failed to clear Storage data for key "+this._storageKey,e)}else delete e[this._dataKey],this._setData(e)},e.prototype._setData=function(e){try{this._nativeStorage.setItem(this._storageKey,this._isRawValueKey?e:JSON.stringify(e))}catch(e){this._reportTraceError("Failed to set Storage data for "+this._storageKey,e)}},e.prototype._isExpired=function(e){return e>0&&e<=Date.now()},e.prototype.getData=function(){var e=this._getMemorizedItem();return e&&e.data},e.prototype.getDataExpiry=function(){var e=this._getMemorizedItem();return e&&e.timestamp},e.prototype.setData=function(e,t){if(null!=e){var n={data:e,timestamp:t||(this._dataLifetime>0?Date.now()+this._dataLifetime:0)};if(this._memorizedCachedItem=n,this._isRawValueKey)this._setData(e);else{var r=this._getData()||{};r[this._dataKey]=n,this._setData(r)}}},e.prototype.removeData=function(e){void 0===e&&(e=!1),this._memorizedCachedItem=null;var t=this._getData();this._removeData(t,e)},e}();t.default=l}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(0),n(80),n(262),n(8),n(71)],void 0===(o=function(e,t,n,r,o,i,a){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0});var l={UserEmail:"UserEmail",OrgId:"OrgId"};t.DATA_KEYS=l;var u=function(e,t,n,r){void 0===r&&(r=a.default.LocalStorage),this.dataKey=e,this.lifetime=t,this.componentName=n,this.storageType=r};t.StorageKeyConfig=u;var c=((s={})[i.default.appModuleIdsCache]=new u(l.OrgId,12096e5,r.default.GET_APP_ID),s[i.default.categoryNamesCache]=new u(l.UserEmail,12096e5,r.default.CATEGORIES),s[i.default.checkEntitiesReadPrivilegeCache]=new u(l.UserEmail,72e5,r.default.CHECK_READ_PRIVILEGE),s[i.default.isFeaturesEnabledCache]=new u(l.OrgId,36e5,r.default.IS_FEATURES_ENABLED),s[i.default.orgSettingsCache]=new u(l.OrgId,864e5,r.default.ORG_SETTINGS),s[i.default.systemUsersCache]=new u(l.UserEmail,864e5,r.default.SYSTEM_USER),s[i.default.getUserValidationCache]=new u(l.UserEmail,18e5,r.default.GET_USER_VALIDATION),s[i.default.whoAmICache]=new u(l.UserEmail,864e5,r.default.WHO_AM_I),s[i.default.orgSettingsCache]=new u(l.OrgId,864e5,r.default.ORG_SETTINGS),s[i.default.sessionId]=new u(null,0,n.default.EVENT_MANAGER),s[i.default.initTime]=new u(null,0,n.default.EVENT_MANAGER),s[i.default.perfMetricStore]=new u(l.OrgId,0,n.default.PERFORMANCE,a.default.SessionStorage),s[i.default.tokenCallbackRest]=new u(l.UserEmail,0,o.default.GET_REST_CALLBACK_TOKEN),s[i.default.tokenCallbackEws]=new u(l.UserEmail,0,o.default.GET_EWS_CALLBACK_TOKEN),s[i.default.tokenOnPrem]=new u(l.UserEmail,0,n.default.AUTHENTICATION_PROVIDER),s[i.default.tokenAdal]=new u(l.UserEmail,0,n.default.AUTHENTICATION_PROVIDER),s[i.default.principalEmail]=new u(null,0,n.default.AUTHENTICATION_PROVIDER),s[i.default.loginDialogMode]=new u(null,0,n.default.AUTHENTICATION_PROVIDER),s[i.default.lastPinnedStateTimestamp]=new u(null,0,n.default.EVENT_MANAGER),s[i.default.unpinnedBootCount]=new u(null,0,n.default.BOOT_MANAGER),s[i.default.ariaTelemetry]=new u(null,0,n.default.TELEMETRY_ARCHIVER),s);t.default=c}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(0)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.PREPEND_BODY=n.default.JS_API_PROVIDER+".PrependBody",e.SET_BODY=n.default.JS_API_PROVIDER+".SetBody",e.SET_SUBJECT=n.default.JS_API_PROVIDER+".SetSubject",e.SET_INSTALL_ID=n.default.JS_API_PROVIDER+".SetInstallId",e.GET_INSTALL_ID=n.default.JS_API_PROVIDER+".GetInstallId",e.ADD_FILE_ATTACHMENT=n.default.JS_API_PROVIDER+".AddFileAttachment",e.RETRIEVE_LOCATION=n.default.JS_API_PROVIDER+".RetrieveLocation",e.RETRIEVE_ROOM_MAILBOXES=n.default.JS_API_PROVIDER+".RetrieveRoomMailboxes",e.RETRIEVE_SCHEDULED_START=n.default.JS_API_PROVIDER+".RetrieveScheduledStart",e.RETRIEVE_SCHEDULED_END=n.default.JS_API_PROVIDER+".RetrieveScheduledEnd",e.RETRIEVE_SHARED_PROPERTIES=n.default.JS_API_PROVIDER+".RetrieveSharedProperties",e.SAVE_ROAMING_SETTINGS=n.default.JS_API_PROVIDER+".SetRoamingSettings",e.LOAD_CUSTOM_PROPERTIES=n.default.JS_API_PROVIDER+".LoadCustomProperties",e.SAVE_CUSTOM_PROPERTIES=n.default.JS_API_PROVIDER+".SaveCustomProperties",e.UPDATE_CUSTOM_PROPERTIES=n.default.JS_API_PROVIDER+".UpdateCustomProperties",e.REMOVE_CUSTOM_PROPERTIES=n.default.JS_API_PROVIDER+".RemoveCustomProperties",e.SAVE_ITEM=n.default.JS_API_PROVIDER+".SaveItem",e.GET_SHARED_PROPERTIES=n.default.JS_API_PROVIDER+".GetSharedProperties",e.GET_COMPOSE_MESSAGE_RECIPIENTS=n.default.JS_API_PROVIDER+".GetComposeMessageRecipients",e.GET_COMPOSE_MEETING_ATTENDEES=n.default.JS_API_PROVIDER+".GetComposeMeetingAttendees",e.RETRIEVE_RECIPIENTS=n.default.JS_API_PROVIDER+".RetrieveRecipients",e.RETRIEVE_ATTENDEES=n.default.JS_API_PROVIDER+".RetrieveAttendees",e.GET_SUBJECT=n.default.JS_API_PROVIDER+".GetSubject",e.GET_BODY=n.default.JS_API_PROVIDER+".GetBody",e.GET_CATEGORIES=n.default.JS_API_PROVIDER+".GetCategories",e.ADD_CATEGORIES=n.default.JS_API_PROVIDER+".AddCategories",e.REMOVE_CATEGORIES=n.default.JS_API_PROVIDER+".RemoveCategories",e.UPDATE_CATEGORIES=n.default.JS_API_PROVIDER+".UpdateCategories",e.OPEN_LOGIN_DIALOG=n.default.JS_API_PROVIDER+".OpenLoginDialog",e.MAKE_EWS_REQUEST=n.default.JS_API_PROVIDER+".MakeEwsRequest",e.CONVERT_TO_REST_ID=n.default.JS_API_PROVIDER+".ConvertToRestId",e.CONVERT_TO_EWS_ID=n.default.JS_API_PROVIDER+".ConvertToEwsId",e.GET_MESSAGE_ATTACHMENTS=n.default.JS_API_PROVIDER+".GetMessageAttachments",e.GET_MAILBOX_ITEM=n.default.JS_API_PROVIDER+".GetMailboxItem",e.GET_MAILBOX_ITEM_TYPE=n.default.JS_API_PROVIDER+".GetMailboxItemType",e.GET_MAILBOX_ITEM_ID=n.default.JS_API_PROVIDER+".GetMailboxItemId",e.GET_ROAMING_SETTING=n.default.JS_API_PROVIDER+".GetRoamingSettingsItem",e.SET_ROAMING_SETTING=n.default.JS_API_PROVIDER+".SetRoamingSettingsItem",e.SAVE_ROAMING_SETTING=n.default.JS_API_PROVIDER+".SaveRoamingSettingsItem",e.REMOVE_ROAMING_SETTING=n.default.JS_API_PROVIDER+".RemoveRoamingSettingsItem",e.GET_MAILBOX_DIAGNOSTICS=n.default.JS_API_PROVIDER+".GetMailboxDiagnostics",e.DISPLAY_APPOINTMENT_FORM=n.default.JS_API_PROVIDER+".DisplayNewAppointmentForm",e.GET_EWS_URL=n.default.JS_API_PROVIDER+".GetEwsUrl",e.SET_DISPLAY_LANGUAGE=n.default.JS_API_PROVIDER+".SetDisplayLanguage",e.GET_DISPLAY_LANGUAGE=n.default.JS_API_PROVIDER+".GetDisplayLanguage",e.GET_HOST_TYPE=n.default.JS_API_PROVIDER+".GetHostType",e.GET_CALLBACK_TOKEN=n.default.JS_API_PROVIDER+".GetCallbackToken",e.GET_REST_CALLBACK_TOKEN=n.default.JS_API_PROVIDER+".GetCallbackToken.Rest",e.GET_EWS_CALLBACK_TOKEN=n.default.JS_API_PROVIDER+".GetCallbackToken.Ews",e.ADD_ITEM_CHANGED_HANDLER=n.default.JS_API_PROVIDER+".AddItemChangedHandler",e.IS_DELEGATED_MAILBOX=n.default.JS_API_PROVIDER+".IsDelegatedMailbox",e.IS_SENT_FOLDER=n.default.JS_API_PROVIDER+".IsSent",e.IS_DESKTOP_OUTLOOK=n.default.JS_API_PROVIDER+".IsDesktopOutlook",e.IS_REST_SUPPORTED=n.default.JS_API_PROVIDER+".IsRestSupported",e.IS_MESSAGE=n.default.JS_API_PROVIDER+".IsMessage",e.IS_APPOINTMENT=n.default.JS_API_PROVIDER+".IsAppointment",e}();t.default=r}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){this.data=e,this.timestamp=t};t.default=n}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(3),n(7),n(8),n(265)],void 0===(o=function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(i.default&&(t||(t="0"),r.default.isVersionGreater(t,e))){var a=Object.keys(n.default.localStorage()),s=function(e){var o=i.default[e],s=Object.keys(o);r.default.isVersionGreater(t,e)&&s.length&&s.forEach((function(e){a.forEach((function(t,r){if(-1!==t.indexOf(e)){var i=o[e];if(i&&i instanceof Function)try{i(e,t)}catch(e){}try{n.default.localStorage().removeItem(t)}catch(e){}}}))}))};for(var l in i.default)s(l);try{n.default.localStorage().setItem(o.default.storageVersion,e)}catch(e){}}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={"1.2.490":{UciDiscoveryEndpoint:null,StoredTelemetryEvents:null,MailApp_DisplayLanguage:null,"MailApp.CRMProvider.OrgSettings.TrackCategorizedItems":null,"MailApp.CRMProvider.OrgSettings.TrackAppointmentsFromNonOrganizer":null,"MailApp.CRMProvider.OrgSettings.DelegateAccessEnabled":null,"MailApp.CRMProvider.OrgSettings.CreateContactWithoutTracking":null,"MailApp.CRMProvider.OrgSettings.EmailInReadModeTrackEnabled":null,"MailApp.CRMProvider.OrgSettings.OverrideTrackInCrmBehaviour":null},"1.2.498":{MailAppRestCallbackToken_:null,MailAppEwsCallbackToken_:null,MailAppTokenExpiry_:null,MailAppToken_:null}}}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};r=[n,t,n(0),n(26),n(3),n(1),n(267),n(9),n(268),n(72),n(38),n(29),n(16),n(76),n(15),n(68)],void 0===(o=function(e,t,n,r,o,s,l,u,c,d,p,f,_,h,m,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=n.default.APP_CHECKER,g=function(){function e(e,t){var s=this;this._bcd=e,this._applicationContext=t,this._targetSelector="#"+d.UIIdentifierNames.content,this._isRendered=!1,this._isChromiumCheckEnabled=!0,this._isPopupRendered=!1,this._DefaultCheckerCommandState=!1,this._checkAllowedAndRun=function(e){return function(){return s._isAllowed().then((function(t){if(t)return e.call(s)}))}},this._renderLanding=function(){return i(s,void 0,void 0,(function(){var e,t,n,o=this;return a(this,(function(i){switch(i.label){case 0:return e=this,[4,this._isFeatureEnabled(u.FcbNames.MailAppEnableAppCheckerChromiumCheck)];case 1:return e._isChromiumCheckEnabled=i.sent(),this._applicationContext.EventManager.ReportTraceInfo(E,"Opening AppChecker Landing Page"),t={isCheckerCommandEnabled:this.getCheckerCommandState(),onCheckerCommandStateChanged:this._setCheckerCommandState},n=this._uiComponentsManager.renderLandingPage(t),this._render(n),r.default.queryById(d.UIIdentifierNames.appcheckerDiagnosticsBox).addEventListener("click",this._renderDiagnostics),this._subscribeToUnmounted((function(){r.default.queryById(d.UIIdentifierNames.appcheckerDiagnosticsBox).removeEventListener("click",o._renderDiagnostics)})),[2]}}))}))},this._setCheckerCommandState=function(e){var t=e?"1":"0";return s._applicationContext.ComponentsLoader.isComponentLoaded(n.default.JS_API_PROVIDER)?(s._applicationContext.JsApiProvider.setRoamingSettingsItem(v.RoamingSettingKeys.isOutlookCheckerCommandVisibleKey,t),s._applicationContext.JsApiProvider.saveRoamingSettingsAsync()):Promise.reject()},this._renderDiagnostics=function(){return i(s,void 0,void 0,(function(){var e,t,r,o,i,s,l,c,d,f,m,v,g,C,y,I,T,A,P,S,R,b,O,M,N,x,D,k,w,L,U,B,V,F,j,W,G,H,q,K,z,J,Y,Q,X;return a(this,(function(a){switch(a.label){case 0:return e=this,[4,this._isFeatureEnabled(u.FcbNames.MailAppEnableAppCheckerChromiumCheck)];case 1:return e._isChromiumCheckEnabled=a.sent(),t=this,[4,this._getData()];case 2:return t._data=a.sent(),r=null===(v=this._data.exchangeMailboxItemContext)||void 0===v?void 0:v.crmTrackStatus,this._applicationContext.EventManager.ReportTraceInfo(E,"Opening AppChecker Diagnostics Page"),o={orgId:this._bcd.orgId,sessionId:this._data.sessionId,outlookEmailAddress:this._applicationContext.ComponentsLoader.isComponentLoaded(n.default.JS_API_PROVIDER)?this._applicationContext.JsApiProvider.getUserEmailAddress():null,mailboxId:this._bcd.mailboxId,crmDeploymentEnvironment:p.default[this._bcd.crmDeploymentEnvironment],exchangeDeploymentEnvironment:p.default[this._bcd.exchangeDeploymentEnvironment],hostName:(null===(g=this._data.officeMailboxItemContext)||void 0===g?void 0:g.hostName)||null,hostVersion:(null===(C=this._data.officeMailboxItemContext)||void 0===C?void 0:C.hostVersion)||null,displayMode:this._bcd.displayMode,orgUrl:this._applicationContext.OrgUrl,browser:this._data.browserName||null,isDelegatedMailbox:void 0!==(null===(y=this._data.officeMailboxItemContext)||void 0===y?void 0:y.isDelegatedMailbox)?this._data.officeMailboxItemContext.isDelegatedMailbox.toString():null,currentDate:this._data.currentDate},i={mailboxItemId:(null===(I=this._data.officeMailboxItemContext)||void 0===I?void 0:I.id)||null,mailboxItemType:(null===(T=this._data.officeMailboxItemContext)||void 0===T?void 0:T.type)||null,messageId:(null===(P=null===(A=this._data.officeMailboxItemContext)||void 0===A?void 0:A.messageId)||void 0===P?void 0:P.replace("<","&lt;").replace(">","&gt;"))||null,crmId:(null===(R=null===(S=r)||void 0===S?void 0:S.CrmId)||void 0===R?void 0:R.replace(/[{}]/g,""))||null,recordUrl:null,trackingState:(null===(b=r)||void 0===b?void 0:b.CrmTrackingState)?_.default[Number(r.CrmTrackingState)]:null,trackedDate:(null===(O=this._data.exchangeMailboxItemContext)||void 0===O?void 0:O.trackedDate)||null,trackedFromMailApp:void 0!==(null===(M=r)||void 0===M?void 0:M.IsTrackedFromMailApp)?1===r.IsTrackedFromMailApp?"true":"false":null,isDelegatedMailbox:void 0!==(null===(N=this._data.officeMailboxItemContext)||void 0===N?void 0:N.isDelegatedMailbox)?this._data.officeMailboxItemContext.isDelegatedMailbox.toString():null,createdDate:(null===(x=this._data.officeMailboxItemContext)||void 0===x?void 0:x.createdDate)||null,modifiedDate:(null===(D=this._data.officeMailboxItemContext)||void 0===D?void 0:D.modifiedDate)||null,sentDate:(null===(k=this._data.exchangeMailboxItemContext)||void 0===k?void 0:k.sentDate)||null,hasAttachments:void 0!==(null===(w=this._data.exchangeMailboxItemContext)||void 0===w?void 0:w.hasAttachments)?this._data.exchangeMailboxItemContext.hasAttachments.toString():null,attachmentCount:(null===(L=this._data.exchangeMailboxItemContext)||void 0===L?void 0:L.attachmentCount)||null,hasD365Category:void 0!==(null===(U=this._data.exchangeMailboxItemContext)||void 0===U?void 0:U.hasD365Category)?null===(B=this._data.exchangeMailboxItemContext.hasD365Category)||void 0===B?void 0:B.toString():null},s={componentsStates:this._data.componentStates,orgId:this._bcd.orgId,sessionId:this._data.sessionId},l={privilegesConfig:(null===(F=null===(V=this._data.diagResults)||void 0===V?void 0:V.VerifyPrivilegesConfig)||void 0===F?void 0:F.privilegeStates)||[],helpLink:h.HelpLinks.PrivilegeErrorOccurs},c={diagResults:this._data.diagResults,isStorageValid:!this._applicationContext.Storage.validate()},d={errorTitle:(null===(W=null===(j=this._data)||void 0===j?void 0:j.errorDetails)||void 0===W?void 0:W.errorTitle)||(null===(H=null===(G=this._data)||void 0===G?void 0:G.trackFailure)||void 0===H?void 0:H.helpText),errorMessage:(null===(K=null===(q=this._data)||void 0===q?void 0:q.errorDetails)||void 0===K?void 0:K.errorMessage)||"",errorInfo:this._getErrorInfo()||(null===(J=null===(z=this._data.trackFailure)||void 0===z?void 0:z.exchangesyncidmapping)||void 0===J?void 0:J.lastsyncerror),helpLink:(null===(Q=null===(Y=this._data)||void 0===Y?void 0:Y.errorDetails)||void 0===Q?void 0:Q.helpLink)||(null===(X=this._data.trackFailure)||void 0===X?void 0:X.helpLink)},o.orgUrl&&(i.mailboxItemType&&i.crmId&&(i.recordUrl=this._getRecordUrl(o.orgUrl,i.mailboxItemType,i.crmId)),o.mailboxUrl=encodeURI(o.orgUrl+"/main.aspx?etc=9606&extraqs=?etc=9606&id={"+o.mailboxId+"}&newWindow=true&pagetype=entityrecord")),o.outlookEmailAddress&&this._data.d365Email&&o.outlookEmailAddress.toLowerCase()!==this._data.d365Email.toLowerCase()&&(o.d365EmailAddress=this._data.d365Email),f={environment:o,mailboxItem:i,components:s,diagchecks:c,errorProps:d,privileges:l},m=this._uiComponentsManager.renderDiagnosticsPage(f),this._render(m),[2]}}))}))},this._closePopup=function(){r.default.queryById(d.UIIdentifierNames.appcheckerPopupClose).removeEventListener("click",s._closePopup),r.default.removeElement("#"+d.UIIdentifierNames.appcheckerPopup),s._isPopupRendered=!1},this._onDownload=function(){return i(s,void 0,void 0,(function(){var e,t;return a(this,(function(n){switch(n.label){case 0:return e=this,[4,this._getData()];case 1:return e._data=n.sent(),t=this._bcd.mailboxId+"_"+(new Date).getTime()+".txt",this._downloadFile(t,JSON.stringify(this._data,null,2)),this._applicationContext.EventManager.ReportTraceInfo(E,"AppChecker Error Logs Downloaded"),[2]}}))}))},this._clearLocalStorage=function(){s._applicationContext.Storage.clearCache(),s._applicationContext.EventManager.ReportTraceInfo(E,"AppChecker LocalStorage Cleared"),s._showPopup("Cache cleared.")},this._close=function(){s._isRendered=!1,s._renderedComponent.onUnmounted(),r.default.queryById(d.UIIdentifierNames.appcheckerClose).removeEventListener("click",s._close),r.default.queryById(d.UIIdentifierNames.appcheckerBack).removeEventListener("click",s._renderLanding),r.default.queryById(d.UIIdentifierNames.appcheckerDownloadLogs).removeEventListener("click",s._onDownload),r.default.queryById(d.UIIdentifierNames.appcheckerClearStorage).removeEventListener("click",s._clearLocalStorage),r.default.removeElement("#"+d.UIIdentifierNames.appchecker),s._renderedComponent=void 0},this._registerToggleListener=function(e){void 0===e&&(e=o.default.document()),e.addEventListener("keyup",s._onKeyUpHandler)},this._onKeyUpHandler=function(e){if(e.ctrlKey&&e.altKey&&89===e.which)return s._checkAllowedAndRun(s.toggle)()},this._registerToggleListener(),this._uiComponentsManager=new c.default(this._applicationContext)}return e.prototype.initialize=function(){var e=this;this._applicationContext.UIManager.subscribeToErrorEvent((function(t){r.default.query("."+d.UIClassNames.SHOW_APP_CHECKER).addEventListener("click",e._checkAllowedAndRun(e._renderDiagnostics)),e._error=t}),(function(t){e._error=null})),this._applicationContext.ComponentsLoader.ensureComponentLoaded(n.default.UNIFIED_CLIENT_LOADER).then(this._registerToggleListener)},e.prototype.toggle=function(e){if(this._isRendered)return this._close();e?this._renderDiagnostics():this._renderLanding()},e.prototype.getCheckerCommandState=function(){var e=this._DefaultCheckerCommandState;if(this._applicationContext.ComponentsLoader.isComponentLoaded(n.default.JS_API_PROVIDER)){var t=this._applicationContext.JsApiProvider.getRoamingSettingsItem(v.RoamingSettingKeys.isOutlookCheckerCommandVisibleKey);e=t?0!==parseInt(t,10):this._DefaultCheckerCommandState}return e},e.prototype._isAllowed=function(){var e=this;return this._applicationContext.ComponentsLoader.isComponentLoaded(n.default.CRM_PROVIDER)?this._applicationContext.CRMProvider.isFeatureControlBitEnabled(u.FcbNames.DisableMailAppChecker).then((function(t){return t&&e._applicationContext.EventManager.ReportTraceInfo(E,"FCB.DisableMailAppChecker blocked AppChecker"),!t})).catch((function(t){return e._applicationContext.EventManager.ReportTraceError(t),!0})):Promise.resolve(!0)},e.prototype._isFeatureEnabled=function(e){return this._applicationContext.ComponentsLoader.isComponentLoaded(n.default.CRM_PROVIDER)?this._applicationContext.CRMProvider.isFeatureControlBitEnabled(e):Promise.resolve(!1)},e.prototype._getTrackFailure=function(e){return i(this,void 0,void 0,(function(){var t,n,r=this;return a(this,(function(o){return t="&$filter=exchangeentryid eq '"+e+"'",n="exchangesyncidmappings?$select="+["exchangeentryid","objectid","lastsyncerror","lastsyncerrorcode","userdecision","isunlinkedincrm","tocrmchangetype"].join(",")+t,[2,this._applicationContext.CRMProvider.executeOdataQuery(n).then((function(e){var t;if(Array.isArray(e)&&e[0]){var n={exchangesyncidmapping:e[0]},r=e[0].lastsyncerror,o=e[0].lastsyncerrorcode;if(-1!==(null===(t=r)||void 0===t?void 0:t.indexOf("PromoteDecision")))return;return s.ErrorCode.isPluginOrWorkflowError(r)?(n.helpText="This item was processed by Server-Side Sync but failed. The error code we found typically indicates the item could not be created successfully because of a problem with a custom plug-in or workflow rule.",n.helpLink="https://support.microsoft.com/help/4466423"):113!==o&&-1===r.indexOf(s.ErrorCode.ACCESS_DENIED.toString())||(n.helpText="This item was processed by Server-Side Sync but failed due to a privilege error.",n.helpLink="https://support.microsoft.com/help/4015092"),n}})).catch((function(e){r._applicationContext.EventManager.ReportTraceError(new s.ComponentError(E,"AppChecker: Unable to retrieve ExchangeSyncIdMapping",s.ErrorCode.GENERIC,e))}))]}))}))},e.prototype._getData=function(){var e,t,r,o,u,c,d,p;return i(this,void 0,void 0,(function(){var i,h,v,g,C,y,I,T,A,P,S,R,b,O,M,N,x,D,k=this;return a(this,(function(a){switch(a.label){case 0:return h={bcd:this._bcd},[4,this._applicationContext.ComponentsLoader.getComponentStates()];case 1:if(h.componentStates=a.sent(),h.sessionId=this._applicationContext.EventManager.getSessionId(),h.currentDate=(new Date).toUTCString(),i=h,this._error&&this._applicationContext.ComponentsLoader.isComponentLoaded(n.default.RESOURCE_MANAGER))try{v={errorTitle:this._applicationContext.ResourceManager.getErrorTitle(this._error),errorMessage:this._applicationContext.ResourceManager.getErrorMessage(this._error),helpLink:l.default.getHelpLink(this._applicationContext,this._bcd,this._error),errorComponent:this._error.componentName,errorCode:this._error.code,stack:this._error.stack},i.errorDetails=v}catch(e){this._applicationContext.EventManager.ReportTraceError(new s.ComponentError(E,"AppChecker: Unable to retrieve error details",s.ErrorCode.GENERIC,e))}if(!this._applicationContext.ComponentsLoader.isComponentLoaded(n.default.JS_API_PROVIDER))return[3,8];a.label=2;case 2:return a.trys.push([2,7,,8]),g=this._applicationContext.JsApiProvider.getMailboxItem(),y={},this._bcd.mode!==m.default.Module?[3,3]:(I=null,[3,5]);case 3:return[4,this._applicationContext.JsApiProvider.getMailboxItemId()];case 4:I=a.sent(),a.label=5;case 5:return y.id=I,y.type=this._applicationContext.JsApiProvider.getMailboxItemType(),y.messageId=this._bcd.mode===m.default.Module?null:null===(e=g)||void 0===e?void 0:e.internetMessageId,y.hostName=this._applicationContext.JsApiProvider.getMailboxDiagnostics().hostName,y.hostVersion=this._applicationContext.JsApiProvider.getMailboxDiagnostics().hostVersion,[4,this._applicationContext.JsApiProvider.isDelegatedMailbox()];case 6:return y.isDelegatedMailbox=a.sent(),y.createdDate=null===(r=null===(t=g)||void 0===t?void 0:t.dateTimeCreated)||void 0===r?void 0:r.toUTCString(),y.modifiedDate=null===(u=null===(o=g)||void 0===o?void 0:o.dateTimeModified)||void 0===u?void 0:u.toUTCString(),C=y,i.officeMailboxItemContext=C,[3,8];case 7:return T=a.sent(),this._applicationContext.EventManager.ReportTraceError(new s.ComponentError(E,"AppChecker: Unable to retrieve Office Mailbox Item Context from JsApiProvider",s.ErrorCode.GENERIC,T)),[3,8];case 8:return this._applicationContext.ComponentsLoader.isComponentLoaded(n.default.EXCHANGE_PROVIDER)&&this._bcd.mode!==m.default.Module?[4,Promise.all([this._applicationContext.ExchangeProvider.MailboxItemProvider.retrieveMailboxItem(),this._applicationContext.ExchangeProvider.MailboxItemProvider.retrieveTrackStatus(),this._applicationContext.ExchangeProvider.MailboxItemProvider.getAttachmentIds()]).then((function(e){var t,n,r,o,a,s,l=e[0],u=e[1],c=e[2],d={crmTrackStatus:u||null,item:l,trackedDate:(null===(t=u)||void 0===t?void 0:t.TrackTimestamp)?new Date(null===(n=u)||void 0===n?void 0:n.TrackTimestamp).toUTCString():null,sentDate:null===(o=null===(r=l)||void 0===r?void 0:r.DateTimeSent)||void 0===o?void 0:o.toUTCString(),hasAttachments:(null===(a=c)||void 0===a?void 0:a.length)>0,attachmentCount:(null===(s=c)||void 0===s?void 0:s.length)||null};i.exchangeMailboxItemContext=d})).then((function(){k._applicationContext.ComponentsLoader.isComponentLoaded(n.default.CRM_PROVIDER)&&k._applicationContext.CRMProvider.getMailboxTrackingCategoryName().then((function(e){var t,n,r;e&&(i.exchangeMailboxItemContext.hasD365Category=(null===(r=null===(n=null===(t=i.exchangeMailboxItemContext)||void 0===t?void 0:t.item)||void 0===n?void 0:n.Categories)||void 0===r?void 0:r.indexOf(e))>-1||null)})).catch((function(e){k._applicationContext.EventManager.ReportTraceError(new s.ComponentError(E,"AppChecker: Unable to retrieve D365 Category Name",s.ErrorCode.GENERIC,e))}))})).catch((function(e){k._applicationContext.EventManager.ReportTraceError(new s.ComponentError(E,"AppChecker: Unable to retrieve Exchange Mailbox Item Context from ExchangeProvider",s.ErrorCode.GENERIC,e))}))]:[3,10];case 9:a.sent(),a.label=10;case 10:return a.trys.push([10,12,,13]),[4,l.default.getDiagDetails(this._applicationContext,this._bcd)];case 11:return A=a.sent(),i.diagResults=A,[3,13];case 12:return P=a.sent(),this._applicationContext.EventManager.ReportTraceError(new s.ComponentError(E,"AppChecker: Unable to retrieve Diagnostic Results",s.ErrorCode.GENERIC,P)),[3,13];case 13:if(!this._applicationContext.ComponentsLoader.isComponentLoaded(n.default.CRM_PROVIDER))return[3,28];a.label=14;case 14:return a.trys.push([14,16,,17]),[4,this._applicationContext.CRMProvider.getFeatureControlBits()];case 15:return S=a.sent(),i.fcb=S,[3,17];case 16:return R=a.sent(),this._applicationContext.EventManager.ReportTraceError(new s.ComponentError(E,"AppChecker: Unable to retrieve Feature Control Bit (FCB) values",s.ErrorCode.GENERIC,R)),[3,17];case 17:return a.trys.push([17,19,,20]),[4,this._applicationContext.CRMProvider.getOrgSettings()];case 18:return b=a.sent(),i.orgSettings=b,[3,20];case 19:return O=a.sent(),this._applicationContext.EventManager.ReportTraceError(new s.ComponentError(E,"AppChecker: Unable to retrieve Org Settings values",s.ErrorCode.GENERIC,O)),[3,20];case 20:return a.trys.push([20,25,,26]),(null===(d=null===(c=i.exchangeMailboxItemContext)||void 0===c?void 0:c.crmTrackStatus)||void 0===d?void 0:d.CrmTrackingState)!==_.default.IsLinked&&null!==(p=i.officeMailboxItemContext)&&void 0!==p&&p.id?i.officeMailboxItemContext.messageId?(M=i,[4,this._getTrackFailure(i.officeMailboxItemContext.messageId)]):[3,22]:[3,24];case 21:return M.trackFailure=a.sent(),[3,24];case 22:return N=encodeURIComponent(i.officeMailboxItemContext.id),x=i,[4,this._getTrackFailure(N)];case 23:x.trackFailure=a.sent(),a.label=24;case 24:return[3,26];case 25:return D=a.sent(),this._applicationContext.EventManager.ReportTraceError(new s.ComponentError(E,"AppChecker: Unable to retrieve track failure",s.ErrorCode.GENERIC,D)),[3,26];case 26:return this._applicationContext.ComponentsLoader.isComponentLoaded(n.default.JS_API_PROVIDER)?[4,this._applicationContext.CRMProvider.getCurrentUserEmailAddress().then((function(e){i.d365Email=e})).catch((function(e){k._applicationContext.EventManager.ReportTraceError(new s.ComponentError(E,"AppChecker: Unable to retrieve email address from user record",s.ErrorCode.GENERIC,e))}))]:[3,28];case 27:a.sent(),a.label=28;case 28:try{i.browserName=f.default.getInstance().getBrowserName()}catch(e){this._applicationContext.EventManager.ReportTraceInfo(E,"AppChecker: Unable to retrieve browser name",s.ErrorCode.GENERIC,e)}return[2,i]}}))}))},e.prototype._downloadFile=function(e,t){var n=new Blob([t],{type:"text/json"});if(o.default.navigator().msSaveOrOpenBlob)o.default.navigator().msSaveBlob(n,e);else{var r=o.default.URL().createObjectURL(n),i=this._applicationContext.JsApiProvider.getIsDesktopOutlook();if(this._isChromiumCheckEnabled&&f.default.getInstance().getIsChromiumCoreVersionNotLess(83)&&!i){this._applicationContext.EventManager.ReportTraceInfo(E,"Opening new window for downloading log file");var a=o.default.open("about:blank",null,"width=600,height=400").document.body;a.setAttribute("style","font-family:'Segoe UI',Arial,sans-serif;font-size:.7em"),a.innerHTML=this._applicationContext.ResourceManager.getString("MailApp_ClickToDownload").format('<a href="'+r+'" download="'+e+'">',"</a>")}else{var s=o.default.document().createElement("a");s.href=r,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s)}}},e.prototype._getErrorInfo=function(){var e=this._error;if(e)return this._applicationContext.ResourceManager.getString("MailApp.Generic.ActivityId").format(this._applicationContext.EventManager.getSessionId(),(new Date).toUTCString(),e&&e.message||"",e&&e.stack||"")},e.prototype._getRecordUrl=function(e,t,n){var r=4202;return"appointment"===t&&(r=4201),e+"/main.aspx?pagetype=entityrecord&etc="+r+"&id="+(n=n.replace(/[{}]/g,""))},e.prototype._render=function(e){this._isRendered&&this._close(),this._renderedComponent=e;var t=r.default.createFragment(this._renderedComponent.layout);r.default.prepend(this._targetSelector,t),this._renderedComponent.onMounted(),r.default.queryById(d.UIIdentifierNames.appcheckerClose).addEventListener("click",this._close),r.default.queryById(d.UIIdentifierNames.appcheckerBack).addEventListener("click",this._renderLanding),r.default.queryById(d.UIIdentifierNames.appcheckerDownloadLogs).addEventListener("click",this._onDownload),r.default.queryById(d.UIIdentifierNames.appcheckerClearStorage).addEventListener("click",this._clearLocalStorage),this._isRendered=!0},e.prototype._showPopup=function(e){this._isPopupRendered&&this._closePopup();var t=this._uiComponentsManager.renderPopup({content:e}),n=r.default.createFragment(t.layout);r.default.prepend("#"+d.UIIdentifierNames.appchecker,n),r.default.queryById(d.UIIdentifierNames.appcheckerPopupClose).addEventListener("click",this._closePopup),this._isPopupRendered=!0},e.prototype._subscribeToUnmounted=function(e){var t=this._renderedComponent.onUnmounted;this._renderedComponent.onUnmounted=function(){e(),t()}},e}();t.default=g}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};r=[n,t,n(0),n(1),n(40),n(110),n(99),n(76),n(9)],void 0===(o=function(e,t,n,r,o,l,u,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=n.default.APP_CHECKER+".DiagChecker",f=function(){function e(){}return e.getDiagDetails=function(e,t){return a(this,void 0,void 0,(function(){var o,a,u,c,d,f,_,h,m,v;return s(this,(function(s){switch(s.label){case 0:return o={},e.ComponentsLoader.isComponentLoaded(n.default.CRM_PROVIDER)?(c=o,[4,this._verifyMailboxTestStatus(e,t)]):(a={state:l.DiagCheckState.Unknown,error:new r.default(p,"Unable to run diagnostic checks. Component "+n.default.CRM_PROVIDER+" is unavailable",r.ErrorCode.UNKNOWN)},u=i(i({},a),{validationMessages:[]}),e.EventManager.ReportTraceError(a.error),o.VerifyMailboxTestStatus=o.VerifyAppModuleAccess=o.VerifyUserEmailAddress=a,o.VerifyPrivilegesConfig=i(i({},a),{privilegeStates:[]}),o.VerifyDeactivatedViews=i(i({},a),{views:[]}),o.VerifyDashboard=u,o.VerifySitemap=u,o.VerifyDashboardSummary=u,[2,o]);case 1:return c.VerifyMailboxTestStatus=s.sent(),d=o,[4,this._verifyAppModuleAccess(e,t)];case 2:return d.VerifyAppModuleAccess=s.sent(),f=o,[4,this._verifyUserEmailAddress(e,t)];case 3:return f.VerifyUserEmailAddress=s.sent(),_=o,[4,this._verifyDeactivatedViews(e)];case 4:return _.VerifyDeactivatedViews=s.sent(),h=o,[4,this._verifyPrivilegesConfig(e)];case 5:return h.VerifyPrivilegesConfig=s.sent(),m=o,[4,this._verifyDashboard(e)];case 6:return m.VerifyDashboard=s.sent(),v=o,[4,this._verifySitemap(e)];case 7:return v.VerifySitemap=s.sent(),o.VerifyDashboardSummary=this._verifyDashboardSummary(o.VerifyDashboard,o.VerifySitemap),[2,o]}}))}))},e._verifyMailboxTestStatus=function(t,n){return a(this,void 0,void 0,(function(){var i,a,u;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,t.CRMProvider.getUserValidation()];case 1:return s.sent(),[2,{state:l.DiagCheckState.Passed,error:null}];case 2:return i=s.sent(),a=o.ensureComponentErrorObject(i),u=this._getMailAppCompatiableErrorCode(a.code),-1!==[r.ErrorCode.UV_SSS_CONFIG_MISSING,r.ErrorCode.UV_SSS_CONFIG_MISSING_FOR_ACT].indexOf(u)?[2,{state:l.DiagCheckState.Failed,error:a,helpLink:e.getHelpLink(t,n,a)}]:[2,{state:l.DiagCheckState.Unknown,error:a}];case 3:return[2]}}))}))},e._verifyAppModuleAccess=function(t,n){return a(this,void 0,void 0,(function(){var i,a;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,t.CRMProvider.getAppId()];case 1:return s.sent(),[2,{state:l.DiagCheckState.Passed,error:null}];case 2:return i=s.sent(),a=o.ensureComponentErrorObject(i),this._getMailAppCompatiableErrorCode(a.code)===r.ErrorCode.CRM_APP_MODULE_PERMISSION?[2,{state:l.DiagCheckState.Failed,error:a,helpLink:e.getHelpLink(t,n,a)}]:[2,{state:l.DiagCheckState.Unknown,error:a}];case 3:return[2]}}))}))},e._verifyUserEmailAddress=function(t,n){return a(this,void 0,void 0,(function(){var i,a;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,t.CRMProvider.getUserValidation()];case 1:return s.sent(),[2,{state:l.DiagCheckState.Passed,error:null}];case 2:return i=s.sent(),a=o.ensureComponentErrorObject(i),this._getMailAppCompatiableErrorCode(a.code)===r.ErrorCode.UV_EMAIL_ADDRESS_MISMATCH?[2,{state:l.DiagCheckState.Failed,error:a,helpLink:e.getHelpLink(t,n,a)}]:[2,{state:l.DiagCheckState.Unknown,error:a}];case 3:return[2]}}))}))},e._verifyDeactivatedViews=function(e){var t=this,n="savedqueries?$select="+["name","returnedtypecode"].join(",")+"&"+("$filter=statecode eq 1 and ("+Object.keys(c.ViewIds).map((function(e){return"savedqueryid eq '"+c.ViewIds[e]+"'"})).join(" or ")+")");return e.CRMProvider.executeOdataQuery(n).then((function(e){return{state:e?e.length?l.DiagCheckState.Failed:l.DiagCheckState.Passed:l.DiagCheckState.Unknown,error:null,views:e}})).catch((function(n){var r=t._getAndReportComponentError(e,"Unable to retrieve Deactivated Views",n);return{state:l.DiagCheckState.Unknown,error:r,views:[]}}))},e._verifyPrivilegesConfig=function(e){var t=this;return e.CRMProvider.whoAmI().then((function(t){var n=t.UserId,r=c.MailAppRolePrivileges.map((function(e){return"systemusers("+n+")/Microsoft.Dynamics.CRM.RetrieveUserPrivilegeByPrivilegeName(PrivilegeName='"+e+"')"}));return e.CRMProvider.sendOdataMultiqueryBatchRequest(p,r)})).then((function(e){return c.MailAppRolePrivileges.reduce((function(t,n,o){var i,a,s;if(null===(i=t[t.length-1])||void 0===i?void 0:i.error)return t;var u,c=e[o],d=l.PrivilegeStatus.Missing;return c instanceof r.default?(d=l.PrivilegeStatus.Unknown,u=c):(null===(s=null===(a=c)||void 0===a?void 0:a.RolePrivileges)||void 0===s?void 0:s.length)&&(d=l.PrivilegeStatus.Present),t.push({privilegeName:n,status:d,error:u}),t}),[])})).then((function(e){return{state:e.every((function(e){return e.status===l.PrivilegeStatus.Present}))?l.DiagCheckState.Passed:e.some((function(e){return e.status===l.PrivilegeStatus.Missing}))?l.DiagCheckState.Failed:l.DiagCheckState.Unknown,error:null,privilegeStates:e}})).catch((function(n){var r=t._getAndReportComponentError(e,"Unable to retrieve User Privileges",n);return{state:l.DiagCheckState.Unknown,error:r,privilegeStates:[]}}))},e._verifyDashboard=function(e){var t=this;return e.CRMProvider.whoAmI().then((function(t){var n="systemusers("+t.UserId+")?$expand=systemuserroles_association($select=roleid)&$select=systemuserroles_association",r=["formactivationstate","formxml"].join(","),o=[n,"systemforms("+c.SystemFormIds.MailAppDashboard+")?$select="+r];return e.CRMProvider.sendOdataMultiqueryBatchRequest(p,o)})).then((function(e){var n=e[0],r=e[1];t._throwIfContainsComponentError([n,r]);var o;if(1===r.formactivationstate){var i=n.systemuserroles_association.map((function(e){return e.roleid.toLowerCase()}));t._verifyDashboardRoles(r.formxml,i)||(o="You don't have access to App for Outlook dashboard. You should be part any of the security roles that can access the dashboard.")}else o="App for Outlook dashboard is not active. You should activate the dashboard and try again.";return t._getDiagResult(o)})).catch((function(n){var r=t._getAndReportComponentError(e,"Unable to validate MailApp Dashboard",n);return{state:l.DiagCheckState.Unknown,error:r,validationMessages:[]}}))},e._verifyDashboardRoles=function(e,t){var n=!0,r=(new DOMParser).parseFromString(e,"application/xml").getElementsByTagName("DisplayConditions");if(r.length){for(var o=r[0].getElementsByTagName("Role"),i=[],a=0;a<o.length;a++)i.push(o.item(a));var s=i.map((function(e){return e.getAttribute("Id").replace(/[{}]/g,"").toLowerCase()}));n=!s.length||s.some((function(e){return t.indexOf(e)>-1}))}return n},e._verifySitemap=function(e){var t=this,n=["appmodulecomponents?$filter="+("componenttype eq 62 and appmoduleid/uniquename eq '"+d.MailAppModuleUniqueName+"'")+"&$select=objectid","sitemaps?$filter=sitemapnameunique eq 'AppforOutlookSiteMap'&$select="+["sitemapxml","sitemapid"].join(",")];return e.CRMProvider.sendOdataMultiqueryBatchRequest(p,n).then((function(e){var n,r=e[0],o=e[1];if(t._throwIfContainsComponentError([r,o]),0===o.value.length)n="App for Outlook sitemap is missing. You should update the app to add the App for Outlook sitemap and try again.";else if(0===r.value.length)n="No sitemap is associated with App for Outlook. You should update the app to add the App for Outlook sitemap and try again.";else if(r.value.length>1)n="More than one sitemaps are configured for App for Outlook. You should update the app to remove all sitemaps except the App for Outlook sitemap and try again.";else{var i=r.value[0],a=o.value[0];i.objectid.toLowerCase()!==a.sitemapid.toLowerCase()&&(n="Unexpected sitemap configured for App for Outlook. You should update the app to remove the current sitemap, then add the App for Outlook sitemap and try again.")}if(!n){var s=o.value[0].sitemapxml;(new DOMParser).parseFromString(s,"application/xml").getElementsByTagName("Area")[0].getElementsByTagName("Group")[0].getElementsByTagName("SubArea")[0].getAttribute("DefaultDashboard").toLowerCase()!==c.SystemFormIds.MailAppDashboard.toLowerCase()&&(n="App for Outlook dashboard should be the default dashboard. You should update the app to configure the default dashboard and try again.")}return t._getDiagResult(n)})).catch((function(n){var r=t._getAndReportComponentError(e,"Unable to validate MailApp Sitemap",n);return{state:l.DiagCheckState.Unknown,error:r,validationMessages:[]}}))},e._verifyDashboardSummary=function(e,t){return{state:e.state===l.DiagCheckState.Failed||t.state===l.DiagCheckState.Failed?l.DiagCheckState.Failed:e.state===l.DiagCheckState.Passed&&t.state===l.DiagCheckState.Passed?l.DiagCheckState.Passed:l.DiagCheckState.Unknown,error:e.error||t.error,validationMessages:e.validationMessages.concat(t.validationMessages)}},e._getDiagResult=function(e){return{state:e?l.DiagCheckState.Failed:l.DiagCheckState.Passed,error:null,validationMessages:e?[e]:[]}},e._getAndReportComponentError=function(e,t,n){var o=new r.default(p,t,r.ErrorCode.UNKNOWN,n);return e.EventManager.ReportTraceError(o),o},e._getMailAppCompatiableErrorCode=function(e){return e<0?e>>>0:e},e._throwIfContainsComponentError=function(e){var t=e.find((function(e){return e instanceof r.default}));if(t)throw t},e.getHelpLink=function(e,t,n){if(!n||n.code!==r.ErrorCode.UNKNOWN)return u.default.generate(n,e.EventManager.getSessionId(),t.orgId)},e}();t.default=f}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(269)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._applicationContext=e,this._componentsMap=n}return e.prototype.renderLandingPage=function(e){return this._renderComponent("AppcheckerLandingPage",e)},e.prototype.renderDiagnosticsPage=function(e){return this._renderComponent("AppcheckerDiagnosticsPage",e)},e.prototype.renderPopup=function(e){return this._renderComponent("AppcheckerPopup",e)},e.prototype._renderComponent=function(e,t){var n=this,r=new this._componentsMap[e](this._applicationContext.ResourceManager),o=r.render(t),i=o.template,a=o.outputProps,s=this._renderTemplate(i,a),l=[r.onMounted.bind(r)].concat(s.onMountedHandlers),u=[r.onUnmounted.bind(r)].concat(s.onUnmountedHandlers);return{layout:s.template,onMounted:function(){return n._safelyCallHandlers(l)},onUnmounted:function(){return n._safelyCallHandlers(u)}}},e.prototype._safelyCallHandlers=function(e){e.forEach((function(e){try{e()}catch(e){}}))},e.prototype._parseComponentsProps=function(e){var t='\\b([A-Za-z0-9]+)\\s*=\\s*"(.*?)"',n=e.match(new RegExp(t,"g"));return n?n.map((function(e){return e.match(new RegExp(t))})).reduce((function(e,t){return t&&(e[t[1]]=t[2]),e}),{}):{}},e.prototype._renderTemplate=function(e,t){for(var n=this,r=[],o=[],i=/<([A-Z][A-Za-z]+)(.*?)(\/)?>(((\s|\S)*?)<\/\1>)?/;e.match(i);)e=e.replace(i,(function(e,i,a,s,l,u){var c=n._parseComponentsProps(a),d=n._componentsMap[i],p=!!s,f="",_="";if(p){if(_=l||"",u)return"invalid template, closing tag detected for self-closing tag: "+i}else f=u;if(d){var h=new d(n._applicationContext.ResourceManager);r.push(h.onMounted.bind(h)),o.push(h.onUnmounted.bind(h));var m=t&&c.props?t[c.props]:{};f&&(m.content=f);var v=h.render(m),E=p?v.outputProps:t,g=n._renderTemplate(v.template,E);return r.push.apply(r,g.onMountedHandlers),o.push.apply(o,g.onUnmountedHandlers),g.template+_}return"unknown component: "+i}));return{template:e,onMountedHandlers:r,onUnmountedHandlers:o}},e}();t.default=r}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};r=[n,t,n(96),n(110),n(72),n(76),n(26),n(25)],void 0===(o=function(e,t,n,r,o,i,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e){this.resourceManager=e}return e.prototype.onMounted=function(){},e.prototype.onUnmounted=function(){},e}(),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){return{template:'\n\t\t\t<div class="appchecker-contaner" id="appchecker">\n\t\t\t\t<div class="appchecker-header">\n\t\t\t\t\t<span class="svgIcon back'+(e.isBackHidden?" hidden":"")+'"'+(e.isBackHidden?' aria-hidden="true"':"")+' id="'+o.UIIdentifierNames.appcheckerBack+'" role="button" title="Back" aria-label="Back"></span>\n\t\t\t\t\t<h2>'+e.title+'</h2>\n\t\t\t\t\t<span class="svgIcon close" id="'+o.UIIdentifierNames.appcheckerClose+'" role="button" title="Close" aria-label="Close"></span>\n\t\t\t\t</div>\n\t\t\t\t'+e.content+"\n\t\t\t</div>\t\n\t\t",outputProps:e}},t}(c);t.AppcheckerContainer=d;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){return{template:'\n\t\t\t<div id="'+o.UIIdentifierNames.appcheckerPopup+'">\n\t\t\t\t<div class="svgIcon close appcheckerPopup-close" id="'+o.UIIdentifierNames.appcheckerPopupClose+'" role="button" title="Close" aria-label="Close"></div>\n\t\t\t\t'+e.content+"\n\t\t\t</div>\n\t\t",outputProps:void 0}},t}(c);t.AppcheckerPopup=p;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){return{template:'\n\t\t\t<div class="appchecker-boxItem" id="'+e.boxId+'">\n\t\t\t\t<h4>'+e.title+'</h4>\n\t\t\t\t<div class="appchecker-box-description">\n\t\t\t\t\t'+e.description+'\n\t\t\t\t</div>\n\t\t\t\t<a href="#" class="appchecker-box-link" id="'+e.linkId+'">'+e.linkText+"</a>\n\t\t\t</div>\n\t\t",outputProps:void 0}},t}(c);t.AppcheckerBox=f;var _=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){return{template:'\n\t\t\t<div class="appchecker-boxes-container">\n\t\t\t\t<AppcheckerBox props="diagnosticsBox"/>\n\t\t\t</div>\n\t\t',outputProps:{diagnosticsBox:{title:"Diagnostics",description:"Review the current state of the add-in and resolve any issues by following the solutions.",linkId:o.UIIdentifierNames.appcheckerSeeMoreDiagnostics,linkText:"Run diagnostics",boxId:o.UIIdentifierNames.appcheckerDiagnosticsBox}}}},t}(c);t.AppcheckerBoxes=_;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){return{template:'\n\t\t\t<AppcheckerContainer props="content">\n\t\t\t\t<AppcheckerToolbar />\n\t\t\t\t<div class="appchecker-main">\n\t\t\t\t\t<AppcheckerSectionContainer props="container">\n\t\t\t\t\t\t<AppcheckerToggleControl props="toggleControl" />\n\t\t\t\t\t</AppcheckerSectionContainer>\n\t\t\t\t\t<AppcheckerBoxes />\n\t\t\t\t</div>\n\t\t\t</AppcheckerContainer>\n\t\t',outputProps:{content:{title:"Outlook Checker",isBackHidden:!0},container:{title:"Show/Hide checker icon",description:"Show or hide the checker icon in the command bar within the app."},toggleControl:{enabledLabel:"Show",disabledLabel:"Hide. Press CTRL+ALT+Y to show.",onCheckerCommandStateChanged:e.onCheckerCommandStateChanged,isCheckerCommandEnabled:e.isCheckerCommandEnabled}}}},t}(c);t.AppcheckerLandingPage=h;var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onClicked=function(){var e=t._isEnabled;t._isEnabled=!t._isEnabled,t._onStateChanged(t._isEnabled).catch((function(){t._isEnabled=e,t._updateUIState()})),t._updateUIState()},t}return a(t,e),t.prototype.render=function(e){return this._id=u.default.newGuid().guid,this._buttonId=this._id+"_button",this._labelId=this._id+"_label",this._isEnabled=e.isCheckerCommandEnabled,this._onStateChanged=e.onCheckerCommandStateChanged,this._enabledLabel=e.enabledLabel,this._disabledLabel=e.disabledLabel,{template:'\n\t\t\t<div class="pillToggleContainer" id="'+this._id+'">\n\t\t\t\t<button id="'+this._buttonId+'" class="pillButton type="button" role="switch">\n\t\t\t\t\t<span class="thumb"></span>\n\t\t\t\t</button>\n\t\t\t\t<span id="'+this._labelId+'" class="pillLabel"></span>\n\t\t\t</div>\n\t\t',outputProps:void 0}},t.prototype.onMounted=function(){l.default.queryById(this._id).addEventListener("click",this._onClicked),this._updateUIState()},t.prototype._updateUIState=function(){var e=l.default.queryById(this._buttonId);this._isEnabled?e.classList.add("pill-enabled"):e.classList.remove("pill-enabled");var t=this._isEnabled?this._enabledLabel:this._disabledLabel;l.default.queryById(this._labelId).innerText=t},t}(c);t.AppcheckerToggleControl=m;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){var t=e.description?"":" hidden";return{template:'\n\t\t\t<div class="appchecker-section-container"'+(e.id?' id="'+e.id+'"':"")+">\n\t\t\t\t<h3>"+e.title+'</h3>\n\t\t\t\t<div class="appchecker-section-description'+t+'">\n\t\t\t\t\t'+(e.description||"")+'\n\t\t\t\t</div>\n\t\t\t\t<div class="appchecker-section-content">\n\t\t\t\t\t'+e.content+"\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t",outputProps:e}},t}(c);t.AppcheckerSectionContainer=v;var E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){return{template:-1===["",null,void 0].indexOf(e.value)?'\n\t\t\t<div class="appchecker-env-detail">\n\t\t\t\t<div class="appchecker-env-detail-label">'+e.label+'</div>\n\t\t\t\t<div class="appchecker-env-detail-value">'+e.value+"</div>\n\t\t\t</div>\n\t\t":"",outputProps:void 0}},t}(c);t.AppcheckerEnvDetail=E;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){return{template:'\n\t\t\t<div class="appchecker-statusline">\n\t\t\t\t<div class="appchecker-statusline-label">'+e.label+'</div>\n\t\t\t\t<div class="appchecker-statusline-state">'+e.value+" "+e.helpLink+"</div>\n\t\t\t</div>\n\t\t",outputProps:void 0}},t}(c);t.AppcheckerRowWithHelplink=g;var C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){var t=e.diagResult||{},n=t.helpLink?"<div class=\"appchecker-statusline-state-helpLink\">\n\t\t\t\t<a target='_blank' href='"+t.helpLink+"'>Go to solution</a>\n\t\t\t</div>":"",o=e.detailsLink&&t.state===r.DiagCheckState.Failed?'<div class="appchecker-statusline-state-helpLink">\n\t\t\t\t<a href=\''+e.detailsLink+"'>Go to details</a>\n\t\t\t</div>":"";return{template:'\n\t\t\t<div class="appchecker-statusline">\n\t\t\t\t<div class="appchecker-statusline-label">'+e.label+'</div>\n\t\t\t\t<div class="appchecker-statusline-state">\n\t\t\t\t\t<div class="appchecker-statusline-state-value">\n\t\t\t\t\t\t'+this._getStateName(t.state)+"\n\t\t\t\t\t</div>\n\t\t\t\t\t"+n+"\n\t\t\t\t\t"+o+"\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t",outputProps:void 0}},t.prototype._getStateName=function(e){if("string"==typeof e)return e;switch(e){case r.DiagCheckState.Passed:return"Passed";case r.DiagCheckState.Failed:return"Failed";case r.DiagCheckState.Unknown:default:return"Unknown"}},t}(c);t.AppcheckerCheckDetail=C;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){var t={OrgId:{label:"Org Id",value:e.orgId},OrgUrl:{label:"Org URL",value:"<a target='_blank' href='"+e.orgUrl+"'>"+e.orgUrl+"</a>"},SessionId:{label:"Session Id",value:e.sessionId},OutlookEmail:{label:"Outlook Email",value:e.outlookEmailAddress},D365Email:{label:"D365 Email",value:e.d365EmailAddress},MailboxId:{label:"Mailbox Id",value:e.mailboxUrl&&e.mailboxId?"<a target='_blank' href='"+e.mailboxUrl+"'>"+e.mailboxId+"</a>":e.mailboxId},Deployment:{label:"CRM/Exchange",value:e.crmDeploymentEnvironment+"/"+e.exchangeDeploymentEnvironment},Outlook:{label:"Outlook",value:e.hostName+"@"+e.hostVersion},DisplayMode:{label:"Display Mode",value:e.displayMode},DelegatedMailbox:{label:"Delegated Mailbox",value:e.isDelegatedMailbox},Browser:{label:"Browser",value:e.browser},CurrentDate:{label:"CurrentDate:",value:e.currentDate}};return{template:'\n\t\t\t<AppcheckerSectionContainer props="container">\n\t\t\t\t<div class="appchecker-env-details-container">\n\t\t\t\t\t<AppcheckerEnvDetail props="OrgId"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="OrgUrl"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="SessionId"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="OutlookEmail"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="D365Email"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="MailboxId"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="Deployment"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="Outlook"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="DisplayMode"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="DelegatedMailbox"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="Browser"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="CurrentDate"/>\n\t\t\t\t</div>\n\t\t\t</AppcheckerSectionContainer>\n\t\t',outputProps:s({container:{title:"Environment",description:"Details of various environmental variables used by App for Outlook."}},t)}},t}(c);t.AppcheckerEnvironmentSection=y;var I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){var t={MailboxItemId:{label:"Id",value:e.mailboxItemId},MailboxItemType:{label:"Type",value:e.mailboxItemType},MessageId:{label:"Message Id",value:e.messageId},CrmId:{label:"Crm Id",value:e.crmId&&e.recordUrl?"<a target='_blank' href='"+e.recordUrl+"'>"+e.crmId+"</a>":e.crmId},TrackingState:{label:"Tracking State",value:e.trackingState},TrackedFromMailApp:{label:"Tracked From MailApp",value:e.trackedFromMailApp},TrackedDate:{label:"Tracked Date",value:e.trackedDate},CreatedDate:{label:"Created Date",value:e.createdDate},ModifiedDate:{label:"Modified Date",value:e.modifiedDate},SentDate:{label:"Sent Date",value:e.sentDate},HasD365Category:{label:"Has D365 Category",value:e.hasD365Category},HasAttachments:{label:"Has Attachments",value:e.hasAttachments},AttachmentCount:{label:"Attachment Count",value:e.attachmentCount}};return{template:'\n\t\t\t<AppcheckerSectionContainer props="container">\n\t\t\t\t<div class="appchecker-env-details-container">\n\t\t\t\t\t<AppcheckerEnvDetail props="MailboxItemId"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="MailboxItemType"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="MessageId"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="CrmId"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="TrackingState"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="TrackedFromMailApp"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="TrackedDate"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="CreatedDate"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="ModifiedDate"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="SentDate"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="HasD365Category"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="HasAttachments"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="AttachmentCount"/>\n\t\t\t\t</div>\n\t\t\t</AppcheckerSectionContainer>\n\t\t',outputProps:s({container:{title:"Mailbox Item",description:"Details of the mail item that is currently selected in Outlook."}},t)}},t}(c);t.AppcheckerMailboxItemSection=I;var T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){var t=this,n=e.componentsStates.reduce((function(n,r){return n[r.componentName]={label:r.componentName,value:t._getStateName(r.state),helpLink:t._getHelpLink(r.componentName,r.state,e.orgId,e.sessionId)},n}),{});return{template:'\n\t\t\t<AppcheckerSectionContainer props="container">\n\t\t\t\t<div class="appchecker-boot-status">\n\t\t\t\t\t'+e.componentsStates.reduce((function(e,t){return e+='\n\t\t\t\t<AppcheckerRowWithHelplink props="'+t.componentName+'"/>\n\t\t\t'}),"")+"\n\t\t\t\t</div>\n\t\t\t</AppcheckerSectionContainer>\n\t\t",outputProps:s({container:{title:"Boot sequence",description:"Detailed status of each boot component, and relevant help or solutions for failed component loads."}},n)}},t.prototype._getHelpLink=function(e,t,r,o){return t===n.ComponentLoadingState.Failed?"<a target='_blank' href='http://go.microsoft.com/fwlink/?LinkID=398563&client=MailApp&error=BootComponent:"+e+"&oid="+r+"&cid="+o+"'>Help</a>":""},t.prototype._getStateName=function(e){switch(e){case n.ComponentLoadingState.None:return"None";case n.ComponentLoadingState.WaitingForDependencies:return"Awaiting dependencies...";case n.ComponentLoadingState.Loading:return"Loading...";case n.ComponentLoadingState.Loaded:return"Loaded";case n.ComponentLoadingState.Failed:default:return"Failed"}},t}(c);t.AppcheckerBootSection=T;var A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){var t=this,n=e.privilegesConfig.filter((function(e){return e.status===r.PrivilegeStatus.Missing})),i=n.reduce((function(e,n){return e[n.privilegeName]={label:n.privilegeName,value:t._getStatusName(n.status),helpLink:""},e}),{}),a=n.map((function(e){return'<AppcheckerRowWithHelplink props="'+e.privilegeName+'"/>'})).join("\r\n"),l="<a target='_blank' href="+e.helpLink+">Learn more</a>",u=s({container:{id:o.UIIdentifierNames.appcheckerSectionPrivileges,title:"Permissions",description:"Details of the missing privileges needed for Dynamics 365 App for Outlook to function properly. "+l+"."}},i);return{template:n.length?'<hr class="appchecker-divider">\n\t\t\t<AppcheckerSectionContainer props="container">\n\t\t\t\t<div class="appchecker-boot-status">\n\t\t\t\t\t'+a+"\n\t\t\t\t</div>\n\t\t\t\t</AppcheckerSectionContainer>":"",outputProps:u}},t.prototype._getStatusName=function(e){switch(e){case r.PrivilegeStatus.Present:return"Present";case r.PrivilegeStatus.Missing:return"Missing";case r.PrivilegeStatus.Unknown:default:return"Unknown"}},t}(c);t.AppcheckerPrivilegesSection=A;var P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){var t,n,r=null===(t=e.list)||void 0===t?void 0:t.map((function(e){return'<li class="appchecker-statusline-label"><span>'+e+"</span></li>"})).join(""),o=e.helpLink?" <a target='_blank' href="+e.helpLink+">Learn more</a>.":"",i={container:{id:e.id,title:e.title,description:""+e.description+o}};return{template:(null===(n=e.list)||void 0===n?void 0:n.length)?'\n\t\t\t<hr class="appchecker-divider">\n\t\t\t<AppcheckerSectionContainer props="container">\n\t\t\t\t<ul>\n\t\t\t\t\t'+r+"\n\t\t\t\t</ul>\n\t\t\t</AppcheckerSectionContainer>\n\t\t":"",outputProps:i}},t}(c);t.AppcheckerListSection=P;var S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){var t,n,r,i,a,s;return{template:'\n\t\t\t<AppcheckerSectionContainer props="container">\n\t\t\t\t<div class="appchecker-diagnostics-checks">\n\t\t\t\t\t<AppcheckerCheckDetail props="localStorage"/>\n\t\t\t\t\t<AppcheckerCheckDetail props="mailboxTestStatus"/>\n\t\t\t\t\t<AppcheckerCheckDetail props="appModuleAccess"/>\n\t\t\t\t\t<AppcheckerCheckDetail props="userEmailAddress"/>\n\t\t\t\t\t<AppcheckerCheckDetail props="privilegesConfig"/>\n\t\t\t\t\t<AppcheckerCheckDetail props="deactivatedViews"/>\n\t\t\t\t\t<AppcheckerCheckDetail props="dashboard"/>\n\t\t\t\t</div>\n\t\t\t</AppcheckerSectionContainer>\n\t\t',outputProps:{container:{title:"Diagnostics Checks",description:"Detailed status of various components and relevant help for failed components."},localStorage:{label:"Local storage",diagResult:{label:"LocalStorage",state:e.isStorageValid?"Passed":"Failed"}},mailboxTestStatus:{label:"Mailbox Test Status",diagResult:null===(t=e.diagResults)||void 0===t?void 0:t.VerifyMailboxTestStatus},appModuleAccess:{label:"App Module Access",diagResult:null===(n=e.diagResults)||void 0===n?void 0:n.VerifyAppModuleAccess},userEmailAddress:{label:"User Email Address",diagResult:null===(r=e.diagResults)||void 0===r?void 0:r.VerifyUserEmailAddress},privilegesConfig:{label:"Permissions",diagResult:null===(i=e.diagResults)||void 0===i?void 0:i.VerifyPrivilegesConfig,detailsLink:"#"+o.UIIdentifierNames.appcheckerSectionPrivileges},deactivatedViews:{label:"Views",diagResult:null===(a=e.diagResults)||void 0===a?void 0:a.VerifyDeactivatedViews,detailsLink:"#"+o.UIIdentifierNames.appcheckerSectionViews},dashboard:{label:"Dashboard",diagResult:null===(s=e.diagResults)||void 0===s?void 0:s.VerifyDashboardSummary,detailsLink:"#"+o.UIIdentifierNames.appcheckerSectionDashboard}}}},t}(c);t.AppcheckerDiagChecksSection=S;var R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){var t=e.helpLink?"<div><a target='_blank' href="+e.helpLink+">Help</a></div>":"";return{template:e.errorTitle||e.errorInfo?'\n\t\t\t<AppcheckerSectionContainer props="container">\n\t\t\t\t<div class="appchecker-error-details">\n\t\t\t\t\t<div>'+(e.errorTitle||"")+"</div>\n\t\t\t\t\t<p>"+(e.errorMessage||"")+'</p>\n\t\t\t\t\t<p class="appchecker-error-info">'+(e.errorInfo||"")+"</p>\n\t\t\t\t\t"+t+'\n\t\t\t\t</div>\n\t\t\t</AppcheckerSectionContainer>\n\t\t\t<hr class="appchecker-divider">\n\t\t':"",outputProps:{container:{title:"Error details",description:"Details of the previously encountered error. Export the logs and share with your administrator."}}}},t}(c);t.AppcheckerErrorDetailsSection=R;var b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){var t="This will clear any errors in the App for Outlook cache. \nCache will be rebuilt upon next login automatically.";return{template:'\n\t\t\t<div class="appchecker-toolbar">\n\t\t\t\t<div class="appchecker-toolbar-button svgIcon download" id="'+o.UIIdentifierNames.appcheckerDownloadLogs+'" role="button" title="Export logs" aria-label="Export logs"></div>\n\t\t\t\t<div class="appchecker-toolbar-button svgIcon clear" id="'+o.UIIdentifierNames.appcheckerClearStorage+'" role="button" title="'+t+'" aria-label="'+t+'"></div>\n\t\t\t</div>\n\t\t',outputProps:void 0}},t}(c);t.AppcheckerToolbar=b;var O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){var t,n,r,a,s,l,u;return{template:'\n\t\t\t<AppcheckerContainer props="content">\n\t\t\t\t<AppcheckerToolbar />\n\t\t\t\t<div class="appchecker-main">\n\t\t\t\t\t<AppcheckerErrorDetailsSection props="errorProps" />\n\t\t\t\t\t<AppcheckerEnvironmentSection props="environment"/>\n\t\t\t\t\t<hr class="appchecker-divider">\n\t\t\t\t\t<AppcheckerMailboxItemSection props="mailboxItem"/>\n\t\t\t\t\t<hr class="appchecker-divider">\n\t\t\t\t\t<AppcheckerDiagChecksSection props="diagchecks"/>\n\t\t\t\t\t<AppcheckerPrivilegesSection props="privileges"/>\n\t\t\t\t\t<AppcheckerListSection props="views"/>\n\t\t\t\t\t<AppcheckerListSection props="dashboard"/>\n\t\t\t\t\t<hr class="appchecker-divider">\n\t\t\t\t\t<AppcheckerBootSection props="components"/>\n\t\t\t\t</div>\n\t\t\t</AppcheckerContainer>\n\t\t',outputProps:{content:{title:"Diagnostics",isBackHidden:!1},environment:e.environment,mailboxItem:e.mailboxItem,components:e.components,privileges:e.privileges,views:{id:o.UIIdentifierNames.appcheckerSectionViews,title:"Views",description:"List of deactivated views used in the Dynamics 365 App for Outlook.",helpLink:i.HelpLinks.ViewDeactivated,list:(null===(a=null===(r=null===(n=null===(t=e.diagchecks)||void 0===t?void 0:t.diagResults)||void 0===n?void 0:n.VerifyDeactivatedViews)||void 0===r?void 0:r.views)||void 0===a?void 0:a.map((function(e){return e.name})))||[]},diagchecks:e.diagchecks,errorProps:e.errorProps,dashboard:{id:o.UIIdentifierNames.appcheckerSectionDashboard,title:"Dashboard",description:"List of configuration issues related to the Dynamics 365 App for Outlook dashboard.",helpLink:i.HelpLinks.Dashboard,list:(null===(u=null===(l=null===(s=e.diagchecks)||void 0===s?void 0:s.diagResults)||void 0===l?void 0:l.VerifyDashboardSummary)||void 0===u?void 0:u.validationMessages)||[]}}}},t}(c);t.AppcheckerDiagnosticsPage=O}.apply(t,r))||(e.exports=o)}],[[112,0]]]);
//# sourceMappingURL=shim.js.map