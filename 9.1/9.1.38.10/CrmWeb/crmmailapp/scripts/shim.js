!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=110)}([function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.INITIALIZER="Initializer",e.AUTHENTICATION_PROVIDER="AuthenticationProvider",e.ERROR_HANDLER="ErrorHandler",e.EVENT_MANAGER="EventManager",e.STORAGE="Storage",e.TELEMETRY_ARCHIVER="TelemetryArchiver",e.JS_API_PROVIDER="JsApiProvider",e.RESOURCE_MANAGER="ResourceManager",e.UI_MANAGER="UIManager",e.APP_CHECKER="AppChecker",e.COMPATIBILITY_CHECK="CheckCompatibility",e.CRM_PROVIDER="CRMProvider",e.EXCHANGE_PROVIDER="ExchangeProvider",e.EXCHANGE_API_PROVIDER="ExchangeApiProvider",e.DISPATCHER_COLLECTION="DispatcherCollection",e.DISPATCHER="Dispatcher",e.UNIFIED_CLIENT_LOADER="UnifiedClientLoader",e.WEB_SCRIPT_BRIDGE="WebScriptBridge",e.VALIDATE_USER="ValidateUser",e.DELEGATE_VALIDATOR="DelegateValidator",e.LOAD_TIMEOUT="LoadTimeout",e.COMPONENTS_LOADER="ComponentsLoader",e.PERFORMANCE="Performance",e.EMAIL_ENGAGEMENT="EmailEngagement",e.MAILBOX_ITEM_PROVIDER="MailboxItemProvider",e.CONTACT_TRACKING_MODULE="ContactTrackingModule",e.BOOT_MANAGER="BootManager",e.CONTACTS_MODULE_PROVIDER="ContactsModuleProvider",e.VALIDATE_OFFICEJS="OfficeJsValidator",e.STORAGE_VALIDATOR="StorageValidator",e}();t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(70),r(6)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorCode=r.default;var o=function(e){function t(r,o,i,a){var s=e.call(this,o)||this;return s.code=i,s.componentName=r,a&&(s.innerError=n.default.errorToObject(a),s.innerError.stack=void 0),Object.setPrototypeOf(s,t.prototype),s}return a(t,e),t.fromNativeError=function(e,r,n){var o=new t(e,n.message,r);return o.name=n.name,o.stack=n.stack,o},t.isNativeError=function(e){return!(e&&"componentName"in e)},t}(Error);t.ComponentError=o,t.default=o}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(114)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.getQueryParams=function(){var e={};if(this._window.location.search&&this._window.location.search.length>0)for(var t=this._window.location.search.substr(1).split("&"),r=0;r<t.length;r++){var n=t[r].split("=");e[n[0]]=n[1]}return e},t.isOfficeExists=function(){return!!this._window.Office},t.addAssociateActionFunction=function(){var e=this;this._window.associateActionFunction=function(t,r){e._window.Office.actions.associate(t,r)}},t}(r.default);t.default=n}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.MESSAGE_RECIPIENTS="MESSAGE_RECIPIENTS",e.MEETING_ATTENDEES="MEETING_ATTENDEES",e.ROOM_MAILBOXES="ROOM_MAILBOXES",e.HTML_BODY="HTML_BODY",e.PLAIN_BODY="PLAIN_BODY",e.EWS_URL="EWS_URL",e.EWS_TOKEN="EWS_TOKEN",e.ATTACHMENT_IDS="ATTACHMENT_IDS",e.RECEIVED_ON="RECEIVED_ON",e.IS_COMPOSE_MODE="IS_COMPOSE_MODE",e.IS_SENT="IS_SENT",e.IS_DELEGATED_MAILBOX="IS_DELEGATED_MAILBOX",e.ITEM_TYPE="ITEM_TYPE",e.SUBJECT="SUBJECT",e.TRACK_STATUS="TRACK_STATUS",e.TRACK_ALLOWED_STATUS="TRACK_ALLOWED_STATUS",e.MAILBOX_ITEM="MAILBOX_ITEM",e.MAILBOX_ITEM_FROM_SERVER="MAILBOX_ITEM_FROM_SERVER",e.SELECTED_RECIPIENT="SELECTED_RECIPIENT",e.USER_PROFILE_EMAIL_ADDRESS="USER_PROFILE_EMAIL_ADDRESS",e.IS_DESKTOP_OUTLOOK="IS_DESKTOP_OUTLOOK",e.RESOLVED_RECIPIENTS="RESOLVED_RECIPIENTS",e.IS_ORGANIZER_RESOLVED_AS_USER="IS_ORGANIZER_RESOLVED_AS_USER",e.IS_LIMITED_MODE="IS_LIMITED_MODE",e.LIMITED_MODE_NOTIFICATION_STATE="LIMITED_MODE_NOTIFICATION_STATE",e.KNOWN_ORG_SETTINGS="KNOWN_ORG_SETTINGS",e.IS_CHECKER_COMMAND_VISIBLE="IS_CHECKER_COMMAND_VISIBLE",e}();t.PropertyNames=r;var n=function(){function e(){}return e.SET_SUBJECT="SET_SUBJECT",e.INSERT_BODY="INSERT_BODY",e.TRACK="TRACK",e.UNTRACK="UNTRACK",e.SET_SELECTED_RECIPIENT="SET_SELECTED_RECIPIENT",e.ADD_ATTACHMENTS="ADD_ATTACHMENTS",e.FOLLOW="FOLLOW",e.UNFOLLOW="UNFOLLOW",e.GET_EMAIL_LINKS="GET_EMAIL_LINKS",e.SET_TRACKING_INFO="SET_TRACKING_INFO",e.REMOVE_TRACKING_INFO="REMOVE_TRACKING_INFO",e.RESOLVE_RECIPIENT_FROM_SCRATCH="RESOLVE_RECIPIENT_FROM_SCRATCH",e.RETRY_TRACK="RETRY_TRACK",e.OPEN_APPCHECKER="OPEN_APPCHECKER",e}();t.ActionNames=n}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0});t.MAILAPP_EVENT_NAME_PREFIX="mailapp_";t.UCI_EVENT_NAME_PREFIX="uci_";var n={MonitorFailure:"monitor_failure",MonitorSuccess:"monitor_success",Performance:"monitor_performance",TraceEvent:"trace"};t.EVENT_NAME=n;var o={Name:n.Performance,MetricName:"MetricName",MetricValue:"MetricValue",StartTime:"StartTime",StopTime:"StopTime",StopwatchName:"StopwatchName"};t.PerformanceEventParameterName=o;t.BrowserPerformanceEventParameterName={ConnectEnd:"connectEnd",ConnectStart:"connectStart",DomainLookupEnd:"domainLookupEnd",DomainLookupStart:"domainLookupStart",Duration:"duration",FetchStart:"fetchStart",ResourceName:"resourceName",RedirectEnd:"redirectEnd",RedirectStart:"redirectStart",RequestStart:"requestStart",ResponseEnd:"responseEnd",ResponseStart:"responseStart",DecodedBodySize:"decodedBodySize",EncodedBodySize:"encodedBodySize",NextHopProtocol:"nextHopProtocol",SecureConnectionStart:"secureConnectionStart",TransferSize:"transferSize",WorkerStart:"workerStart",Window:"window"};var i={Error:"Error",ErrorCode:"ErrorCode",Url:"Url",FunctionName:"FunctionName",FileName:"FileName",LineNumber:"LineNumber",ColumnNumber:"ColumnNumber",CallStack:"CallStack",ComponentErrorComponentName:"ComponentErrorComponentName",InnerError:"InnerError",InnerErrorComponentName:"InnerErrorComponentName"};t.ErrorEventParameterName=i;var a={Data:"Data",ComponentName:"ComponentName",TraceLevel:"TraceLevel",TimeSinceSessionInit:"TimeSinceSessionInit",NetworkConnectivityState:"NetworkConnectivityState",ShimContextId:"ShimContextId",IsFromCache:"IsFromCache",CallReason:"CallReason",RequestMethod:"RequestMethod",Parameters:"Parameters",MethodName:"MethodName",IsCryptoAvailable:"IsCryptoAvailable",Location:"Location",DiagnosticsName:"DiagnosticsName",Level:"Level",TrackStatus:"TrackStatus",ServerRequestId:"ServerRequestId",ClientRequestId:"ClientRequestId",AuthActivityId:"AuthActivityId",SuggestedMitigation:"SuggestedMitigation",Message:"Message",CallStack:"CallStack",ApplicationEventLevel:"ApplicationEventLevel",UserAgent:"UserAgent",Origin:"Origin"};t.EventParameterName=a;var s={SessionId:"SessionId",OrgId:"OrgId",ServerVersion:"ServerVersion",ShimVersion:"ShimVersion",HostName:"HostName",HostType:"HostType",HostVersion:"HostVersion",InstallId:"InstallId",HostPlatform:"HostPlatform",OWAView:"OWAView",DeploymentEnvironment:"DeploymentEnvironment",ExchangeDeploymentEnvironment:"ExchangeDeploymentEnvironment",Mode:"Mode",ItemType:"ItemType",MailboxId:"MailboxId",ExchangeServerVersion:"ExchangeServerVersion",EWSSchemaVersion:"EWSSchemaVersion"};t.SessionContextParameterName=s;var u=((r={ActivityId:"ActivityId",TimeCreated:"TimeCreated",SessionContextName:"SessionContext",EventContextName:"EventContext",SessionId:s.SessionId,ComponentName:a.ComponentName,TraceLevel:a.TraceLevel,SuggestedMitigation:a.SuggestedMitigation,Message:a.Message,CallStack:i.CallStack,Origin:a.Origin,UserAgent:a.UserAgent,OrgId:s.OrgId,ServerVersion:s.ServerVersion,HostType:s.HostType,MetricName:o.MetricName,StartTime:o.StartTime,MetricValue:o.MetricValue,InnerError:i.InnerError,InnerErrorComponentName:i.InnerErrorComponentName})[i.ErrorCode]=i.ErrorCode,r[a.ShimContextId]=a.ShimContextId,r);t.KnownEventParameterName=u;var c=[i.ErrorCode,a.ShimContextId];function l(e){return u&&!!u[e]}t.isKnownEventParamName=l,t.isKnownEventContextParamName=function(e){return l(e)&&-1!==c.indexOf(e)}}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(35),r(10),r(11),r(2),r(50)],void 0===(o=function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){}return e.restrictedValue=function(){return"*** Restricted ***"},e.serializeEmailAddressDetails=function(t){return{recipientType:t&&t.recipientType,emailAddress:e.restrictedValue()}},e.serializeRecipientRecord=function(t){var r;if(!t||!t.entityReference)return null;var n=t.dataValues[o.PropertyNames.Role],i=n?a.default[n]:null,s=Object.assign({},t.dataValues,((r={})[o.PropertyNames.Email]=e.restrictedValue(),r[o.PropertyNames.Role]=i,r.name=e.restrictedValue(),r));return{entityReference:{Id:t.entityReference.Id&&t.entityReference.Id.guid,LogicalName:t.entityReference.LogicalName},dataValues:s}},e.serializeTrackStatus=function(t){return t?Object.assign(t.Clone(),{CrmRegardingObjectName:e.restrictedValue()}):null},e.defaultSetNotifyUpdate=function(e,t){e.notifyUpdate=function(r,n){t(void 0===r?e.accessor():r,n)}},e.serializeMailboxItem=function(t){if(t&&t.ItemType===n.default[n.default.appointment]){var o=r.default.cloneMailboxItem(t);return o.Location=e.restrictedValue(),o}return t},e.createRecipientsPollingFunction=function(t,r,n,o){return function(a){if(e.defaultSetNotifyUpdate(t,a),r.JsApiProvider.isComposeMode()){var s,u=function(){return i.default.setInterval((function(){t.accessor().then((function(e){return o(s,e)||a(Promise.resolve(e)),s=n(e),e})).catch((function(e){a(Promise.reject(e))}))}),5e3)};t.accessor().then((function(e){s=n(e);var t=u();r.UIManager.subscribeToErrorEvent((function(){i.default.clearInterval(t)}),(function(){t=u()}))})).catch((function(e){}))}}},e}();t.default=s}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(20),r(2),r(71),r(1)],void 0===(o=function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.errorToObject=function(e){var t={};return"object"!=typeof e||Array.isArray(e)?e:(e?Object.getOwnPropertyNames(e).forEach((function(r){t[r]=e[r]})):t.error="undefined",t)},e.generateKey=function(){var e=n.default.crypto();if(e){var t=e.getRandomValues(new Uint32Array(4));return Array.prototype.slice.call(t).reduce((function(e,t){return e+t.toString(16)}),"")}return r.default.newGuid().guid.replace(/-/g,"")},e.parseToken=function(e){if(!e)throw new i.ComponentError("ParseToken","parseToken() requires a non-empty token",i.ErrorCode.GENERIC);var t=e.split(".")[1];if(!t)throw new i.ComponentError("ParseToken","parseToken() requires a well-formatted token",i.ErrorCode.GENERIC);var r=t.replace(/[-]/g,"+").replace(/[_]/g,"/").replace(/\r\n/g,"");try{return JSON.parse(n.default.atob(r))}catch(e){throw new i.ComponentError("ParseToken","atob() failed with error: "+e.message+". Token length: "+r.length,i.ErrorCode.GENERIC)}},e.intToHexString=function(e){var t=e;return t<0&&(t=t+4294967295+1),t.toString(16)},e.delay=function(e,t){return void 0===t&&(t=function(e){}),new Promise((function(r){return t(n.default.setTimeout(r,e))}))},e.createDeferredPromise=function(){var e,t,r=o.DeferredPromiseState.Pending;return{Promise:new Promise((function(n,i){e=function(e){r=o.DeferredPromiseState.Resolved,n(e)},t=function(e){r=o.DeferredPromiseState.Rejected,i(e)}})),Resolve:e,Reject:t,State:function(){return r}}},e.cleanupGuidFromString=function(e){return e.replace(/(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}/gi,"{Guid}")},e.isVersionGreater=function(e,t){for(var r=e.split("."),n=t.split("."),o=Math.max(r.length,n.length),i=0;i<o;i++){var a=parseInt(r[i],10),s=parseInt(n[i],10);if(!isNaN(a)&&!isNaN(s)){if(a===s)continue;return a<s}return o===n.length}return!1},e.parseMissingPrivilegeFromErrorMessage=function(e){var t=e.match(/is missing (prv(?:Create|Read|Write|Delete|Append|AppendTo|Assign|Share)[\w]+) privilege/i);return t?t[1]:""},e.isRequiredReadPrivilegeForEntities=function(t,r){return t.some((function(t){return e.isRequiredReadPrivilegeForEntity(t,r)}))},e.isRequiredReadPrivilegeForEntity=function(e,t){return("prvRead"+e).toLowerCase()===t.toLowerCase()},e.arrayDifference=function(e,t){return e.filter((function(e){return-1===t.indexOf(e)}))},e.isArrayEqual=function(e,t){return e.length+t.length===0||e.every((function(e,r){return e===t[r]}))},e.assignUpdates=function(e,t,r){var n=this;return t.reduce((function(e,t){var o=r?e.findIndex(r.bind(n,t)):e.indexOf(t);return-1===o?e.push(t):e[o]=t,e}),Array.from(e))},e}();t.default=a}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.DOCUMENT="Document",e.NETWORK="Network",e.ACCOUNT="Account",e.APPLICATION="Application",e.DEVICE="Device",e.DATA="Data",e.NAVIGATION="Navigation",e.MULTIMEDIA="Multimedia",e.EXTERNAL_CONTEXT="ExternalContext",e.LOGGING="Logging",e.CONTACTS_MODULE="ContactsModule",e}();t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.String=0]="String",e[e.Double=1]="Double",e[e.Integer=2]="Integer",e[e.Item=3]="Item",e[e.Calendar=4]="Calendar",e[e.Contacts=5]="Contacts",e[e.Message=6]="Message"}(r||(r={})),t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={principalEmail:"Mscrm.MailApp.principalEmail",sessionId:"UCISessionID",initTime:"UCIInitTime",perfMetricStore:"CRMMailAppPerformanceMetricStorageKey",tokenOnPrem:"MailApp.Token.OnPrem",tokenCallbackRest:"MailApp.Token.Callback.Rest",tokenCallbackEws:"MailApp.Token.Callback.Ews",tokenAdal:"MailApp.Token.Adal",appModuleIdsCache:"MailApp.CRMProvider.AppModuleIds",checkEntitiesReadPrivilegeCache:"MailApp.CRMProvider.CheckEntitiesReadPrivilegeCache",categoryNamesCache:"MailApp.CRMProvider.CategoryNames",getUserValidationCache:"MailApp.CRMProvider.GetUserValidationCache",isFeaturesEnabledCache:"MailApp.CRMProvider.IsFeaturesEnabledCache",whoAmICache:"MailApp.CRMProvider.WhoAmI",systemUsersCache:"MailApp.CRMProvider.SystemUsers",orgSettingsCache:"MailApp.CRMProvider.OrgSettings",loginDialogMode:"MailApp_LoginDialogMode",developerToolsEnabled:"DeveloperToolsSwitch",wsigninFailure:"wsigninFailure",showPerfWidget:"MailApp.ShowPerfWidget",ariaTelemetry:"MailApp.AriaTelemetry",storageValidation:"MailApp.Storage.Validation",storageVersion:"MailApp.Storage.Version",lastPinnedStateTimestamp:"LastPinnedStateTimestamp",unpinnedBootCount:"UnpinnedBootCount",onPremSignInUrl:"MailApp.OnPremSignInUrl",onPremSignOutUrl:"MailApp.OnPremSignOutUrl"}}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.message=0]="message",e[e.appointment=1]="appointment",e[e.contact=2]="contact",e[e.folder=3]="folder"}(r||(r={})),t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0});var o={User:"systemuser",Contact:"contact",Lead:"lead",Account:"account",Organization:"organization",Role:"role"};t.CrmTypeNames=o;var i=[o.Contact,o.Lead,o.User,o.Account];t.CheckEntitiesReadPrivilegeTypeNames=i;t.PropertyNames={Email:"emailaddress",StatusCode:"statecode",IsDisabled:"isdisabled",OwnerId:"ownerid",FollowEmail:"followemail",Role:"role"};var a=((r={})[o.User]="8",r[o.Contact]="2",r[o.Lead]="4",r[o.Account]="1",r);t.CrmTypeNamesToCodes=a;var s=((n={})[o.User]="fullname",n[o.Contact]="fullname",n[o.Lead]="fullname",n[o.Account]="name",n);t.CrmTypeNamesToNameFieldName=s;t.FcbNames={MailAppOpenRecordInBrowser:"FCB.MailAppOpenRecordInBrowser",MailAppResolveRecipientsToAccounts:"FCB.MailAppResolveRecipientsToAccounts",MailAppLimitedMode:"FCB.MailAppLimitedMode",TrackUsingCategoriesDefaultValue:"FCB.TrackUsingCategoriesDefaultValue",ForceUsageOfCustomProperties:"FCB.MailAppForceUsageOfCustomProperties",DisableMailAppChecker:"FCB.DisableMailAppChecker",MailAppEnableAppCheckerChromiumCheck:"FCB.MailAppEnableAppCheckerChromiumCheck",MailAppPinningStateNotification:"FCB.MailAppPinningStateNotification",MailAppEnableCategoriesAPI:"FCB.MailAppEnableCategoriesAPI",MailAppEnableAppointmentTimeChangedEvent:"FCB.MailAppEnableAppointmentTimeChangedEvent",OfficeMailAppEmailEngagement:"FCB.OfficeMailAppEmailEngagement",EmailEngagement:"FCB.EmailEngagement"};t.MailAppModuleUniqueName="AppforOutlookModule"}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Read=0]="Read",e[e.Compose=1]="Compose",e[e.Module=2]="Module"}(r||(r={})),t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(23),r(8),r(34),r(79)],void 0===(o=function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t,r,n,i){return e.call(this,new o.default(t,r),n,i)||this}return a(t,e),t.prototype.toJson=function(){return JSON.stringify({PropertyId:n.default[this.propertyType]+" {00020329-0000-0000-c000-000000000046} Name "+this.propertyName,Value:this.propertyValue})},t.prototype.getInnerSoap=function(){return"<t:ExtendedProperty>\n\t\t\t\t\t"+this.property.toSoap()+"\n\t\t\t\t\t<t:Value>"+r.escapeXml(this.propertyValue)+"</t:Value>\n\t\t\t\t</t:ExtendedProperty>"},t}(i.default);t.default=s}.apply(t,n))||(e.exports=o)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unspecified=0]="Unspecified",e[e.String=1]="String",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Boolean=4]="Boolean",e[e.Date=5]="Date"}(t.AWTPropertyType||(t.AWTPropertyType={})),function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(t.AWTPiiKind||(t.AWTPiiKind={})),function(e){e[e.NotSet=0]="NotSet",e[e.GenericContent=1]="GenericContent"}(t.AWTCustomerContentKind||(t.AWTCustomerContentKind={})),function(e){e[e.Low=1]="Low",e[e.Normal=2]="Normal",e[e.High=3]="High",e[e.Immediate_sync=5]="Immediate_sync"}(t.AWTEventPriority||(t.AWTEventPriority={})),function(e){e[e.NonRetryableStatus=1]="NonRetryableStatus",e[e.QueueFull=3]="QueueFull"}(t.AWTEventsDroppedReason||(t.AWTEventsDroppedReason={})),function(e){e[e.InvalidEvent=1]="InvalidEvent",e[e.SizeLimitExceeded=2]="SizeLimitExceeded",e[e.KillSwitch=3]="KillSwitch"}(t.AWTEventsRejectedReason||(t.AWTEventsRejectedReason={}))},function(e,t,r){var n,o;n=[r,t,r(0),r(137),r(1),r(4)],void 0===(o=function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){this._methods={},this.bcd=e,this.applicationContext=t}return e.prototype.getTelemetryComponent=function(){return r.default.DISPATCHER+"."+this.namespace},e.prototype.getNamespace=function(){return this.namespace},e.prototype.registerMethods=function(){},e.prototype.registerMethodWithName=function(e,t,r,i){void 0===i&&(i={});var a=this.getTelemetryComponent()+".RegisterMethod";if(!t)return this.applicationContext.EventManager.ReportComponentFailure(new o.ComponentError(a,"Null argument passed to registerMethodWithName",o.ErrorCode.GENERIC));if(e in this._methods)this.applicationContext.EventManager.ReportTraceWarning(a,"Trying to register a method twice with the same name",{methodName:e});else{var s=new n.default(this,this.applicationContext,e,t,r,i);this._methods[e]=s}},e.prototype.callMethodWithName=function(e,t){var r=this.getTelemetryComponent()+".CallMethodWithName";if(!e||!t)return this.applicationContext.EventManager.ReportComponentFailure(new o.ComponentError(r,"Null argument passed into callMethodWithName",o.ErrorCode.GENERIC));var n=this._methods[e];if(!n)return this.applicationContext.EventManager.ReportComponentFailure(new o.ComponentError(r,"Attempting to call unknown method",o.ErrorCode.GENERIC),[{name:i.EventParameterName.Data,value:e}]);n.invoke(t)},e.prototype.deviceEvent=function(e,t){var n=this;this.applicationContext.ComponentsLoader.ensureComponentLoaded(r.default.WEB_SCRIPT_BRIDGE).then((function(){return n.applicationContext.Bridge.deviceEventWithNamespace(n.namespace,e,t)}))},e.prototype.getInitialState=function(){return{}},e.prototype.unload=function(){},e}();t.default=a}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.TRACKING_STATE="crmLinkState",e.REGARDING_ID="crmRegardingId",e.REGARDING_OBJECT_TYPE="crmRegardingObjectType",e.REGARDING_OBJECT_NAME="Regarding",e.ID="crmid",e.IS_FOLLOWED="crmIsFollowed",e.OBJECT_TYPE_CODE="crmObjectTypeCode",e.TRACKING_STATE_TRACKER="crmLinkStateTracker",e.SSS_PROMOTE_TRACKER="crmSssPromoteTracker",e.IS_TRACKED_FROM_MAILAPP="crmTrackedFromMailApp",e.CRM_CATEGORY_TRACKER="crmCategoryTracker",e.TRACK_TIMESTAMP="crmTrackTimestamp",e.CUSTOM_PROPERTIES="cecp-270a343c-ce6e-4c7e-be25-f29abe0e089b",e}();t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.OnPremise=0]="OnPremise",e[e.Online=1]="Online"}(r||(r={})),t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NotLinked=0]="NotLinked",e[e.WillBeLinked=1]="WillBeLinked",e[e.IsLinked=2]="IsLinked",e[e.WillBeUnlinked=3]="WillBeUnlinked",e[e.WillBeUnlinkedAndDeleted=4]="WillBeUnlinkedAndDeleted",e[e.LinkFailed=5]="LinkFailed",e[e.InProgress=6]="InProgress"}(r||(r={})),t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.CALENDAR_ITEM_TYPE="CalendarItemType",e.LOCATION="Location",e.RECURRENCE="Recurrence",e.IS_ALL_DAY_EVENT="IsAllDayEvent",e.RECURRENCE_PATTERN="Pattern",e.CONVERSATION_INDEX="ConversationIndex",e.UID="UID",e.DATE_TIME_SENT="DateTimeSent",e.DATE_TIME_RECEIVED="DateTimeReceived",e.CATEGORIES="Categories",e.ATTACHMENTS="Attachments",e.ATTACHMENT_ID="AttachmentId",e.LAST_MODIFIED_TIME="LastModifiedTime",e.LEGACY_FREE_BUSY_STATUS="LegacyFreeBusyStatus",e.INTERNET_MESSAGE_ID="InternetMessageId",e.IMPORTANCE="Importance",e}();t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=/^({?)((\d|[a-f]){8}-(\d|[a-f]){4}-(\d|[a-f]){4}-(\d|[a-f]){4}-(\d|[a-f]){12})(}?)$/,n=/^([a-f\d]{8})([a-f\d]{4})([a-f\d]{4})([a-f\d]{4})([a-f\d]{12})$/,o=function(){function e(t){var r=e._formatGuidString(t);if(!r)throw new Error(t+" is not a valid Guid value.");this.guid=r,Object.freeze(this)}return e.externalGuid=function(t){return t?"{"+t.guid.toUpperCase()+"}":e.EMPTYSTRING},e.fromExternalGuid=function(t){return t?new e(t.replace(/[\{\}]/gi,"")):e.EMPTY},e.toString=function(e){return e?e.guid:null},e.tryParse=function(t){return e.tryParseOrNull(t)||e.EMPTY},e.tryParseOrNull=function(t){var r=e._formatGuidString(t);return r?new e(r):null},e.parse=function(t){return new e(t)},e._formatGuidString=function(e){if(!e)return null;e=e.toLowerCase();var t=r.exec(e);if(t)return t[1].length!==t[8].length?null:t[2];var o=n.exec(e);return o?o.filter((function(e,t){return t>0})).join("-"):null},e.equals=function(t,r){return null==t||null==r?t===r:e.toString(t)===e.toString(r)},e.isNullOrEmpty=function(t){return!t||e.equals(t,e.EMPTY)},e.newGuid=function(){for(var t="",r=0;r<36;r++)if(14===r)t+="4";else if(8===r||13===r||18===r||23===r)t+="-";else if(19===r){var n=Math.floor(16*Math.random());t+="0123456789abcdef".substr(3&n|8,1)}else t+="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return new e(t)},e.EMPTY=new e("00000000-0000-0000-0000-000000000000"),e.EMPTYSTRING="",e}();t.default=o}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(1),r(72),r(73),r(38),r(6),r(22)],void 0===(o=function(e,t,r,n,o,i,a,s){"use strict";var u;function c(e){if(!e)return Error("No error data provided.");if(e instanceof Error&&e.message)return e;if(e.error instanceof Error&&e.error.message)return e.error;var t=Error(e.message||e.errorMessage);if(e.errorType===n.ErrorType.UnhandledError&&(t.name="UnhandledError"),e.errorType===n.ErrorType.UnhandledRejection&&(t.name="UnhandledRejection"),!t.message)try{t.message=JSON.stringify(a.default.errorToObject(e))}catch(e){t.message="Error provided failed to be stringified: "+e.message}return t.stack=e.stack||e.stackTrace||"No stack available.",t}Object.defineProperty(t,"__esModule",{value:!0}),t.ensureErrorObject=c,t.ensureComponentErrorObject=function(e,t,n){if(void 0===t&&(t=r.ErrorCode.GENERIC),void 0===n&&(n="UnknownComponent"),e instanceof r.ComponentError)return e;var o=c(e);return r.ComponentError.fromNativeError(n,t,o)};var l=((u={})[o.OfficeErrorCode.OperationNotSupportedError]=r.ErrorCode.OFFICE_SAVE_ASYNC_UNSUPPORTED,u[o.OfficeErrorCode.MessageInDifferentStoreError]=r.ErrorCode.OFFICE_SAVE_ASYNC_MESSAGE_IN_DIFFERENT_STORE,u);t.getSaveAsyncErrorCodeByOfficeInternalCode=function(e){return l[e]||r.ErrorCode.OFFICE_SAVE_ASYNC};t.isSaveAsyncUnsupportedInOutlookForWin=function(e){var t=e.hostType,r=e.mailboxDiagnostics;return t===i.default.Outlook&&s.default.getInstance().getIsWindows()&&r.hostVersion&&a.default.isVersionGreater(r.hostVersion,"15.0.5023.1000")},t.isSaveAsyncUnsupportedInOWA=function(e){var t=e.hostType,r=e.mailboxDiagnostics;return t===i.default.OutlookWebApp&&r.hostVersion&&a.default.isVersionGreater(r.hostVersion,"15.1.225.16")}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(2)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){if(this._isBrowserSafari=!1,e._instance)throw new Error("UserAgent.getInstance() should be used instead of new()");this._rawValue=r.default.navigator().userAgent;var t=this._rawValue.toLowerCase();this._isBrowserIE=-1!==t.indexOf("msie 10")||-1!==t.indexOf("msie 9.0")||-1!==t.indexOf("trident"),this._isBrowserEdge=(-1!==t.indexOf("edge")||-1!==t.indexOf("edg"))&&!this._isBrowserIE,this._isBrowserChrome=-1!==t.indexOf("chrome")&&!this._isBrowserIE&&!this._isBrowserEdge,this._isBrowserFirefox=-1!==t.indexOf("firefox"),-1===t.indexOf("safari")||this._isBrowserIE||this._isBrowserEdge||(-1!==t.indexOf("chrome")||-1!==t.indexOf("android")?this._isBrowserSafari=!1:this._isBrowserSafari=!0),this._isIPhone=-1!==t.indexOf("iphone"),this._isIPad=-1!==t.indexOf("ipad"),this._isIPod=-1!==t.indexOf("ipod"),this._isAndroid=-1!==t.indexOf("android"),this._isAndroidPhone=this._isAndroid&&-1!==t.indexOf("mobile"),this._isWebKit=-1!==t.indexOf("webkit")&&!this._isBrowserIE,this._isMac=-1!==r.default.navigator().appVersion.indexOf("Mac"),this._isWindows=-1!==r.default.navigator().appVersion.indexOf("Win")||-1!==r.default.navigator().appVersion.indexOf("NT"),this._isWindows80=-1!==r.default.navigator().appVersion.indexOf("Windows NT 6.2"),this._isWindowsDesktop=this._isWindows&&-1!==r.default.navigator().appVersion.indexOf("NT"),this._isWindowsPhone=this._isWindows&&-1!==r.default.navigator().appVersion.indexOf("Phone"),this._isWindows81=-1!==r.default.navigator().appVersion.indexOf("Windows NT 6.3")}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype._parseIOSVersion=function(){return this._parseVersionInteger(new RegExp("OS (\\d+)_(\\d+)_?(\\d+)?"))},e.prototype._parseVersionInteger=function(e){var t=this._rawValue.match(e);return t&&t.length>1?parseInt(t[1],10):-1},e.prototype._parseAndroidVersion=function(){return this._parseVersionFloat("Android")},e.prototype._parseVersionFloat=function(e){var t=this._rawValue.indexOf(e);if(-1!==t){var r=this._rawValue.substring(t+e.length+1,t+e.length+4);return parseFloat(r)}return-1},e.prototype.getIsBrowserIE=function(){return this._isBrowserIE},e.prototype.getIsBrowserEdge=function(){return this._isBrowserEdge},e.prototype.getIsBrowserChrome=function(){return this._isBrowserChrome},e.prototype.getIsBrowserFirefox=function(){return this._isBrowserFirefox},e.prototype.getIsBrowserSafari=function(){return this._isBrowserSafari},e.prototype.isRequiredApiSupported=function(){return"undefined"!=typeof MutationObserver&&"undefined"!=typeof requestAnimationFrame},e.prototype._checkSupportedVersion=function(e,t,r){return!!e&&(t>=r||-1===t)},e.prototype.getIsIPhone=function(){return this._isIPhone},e.prototype.getIsIOSSupported=function(){return this._checkSupportedVersion(this._isIPhone||this._isIPad||this._isIPod,this._parseIOSVersion(),5)},e.prototype.getIsIPad=function(){return this._isIPad},e.prototype.getIsIPod=function(){return this._isIPod},e.prototype.getIsAndroidSupported=function(){return this._checkSupportedVersion(this._isAndroid,this._parseAndroidVersion(),4.4)},e.prototype.getIsChromiumCoreVersionNotLess=function(e){return this._checkSupportedVersion(this._isBrowserChrome||this._isBrowserEdge,this._parseVersionFloat("Chrome"),e)},e.prototype.getIsMac=function(){return this._isMac},e.prototype.getIsWindows=function(){return this._isWindows},e.prototype.getIsWindows80=function(){return this._isWindows80},e.prototype.getIsWindowsDesktop=function(){return this._isWindowsDesktop},e.prototype.getIsWindowsPhone=function(){return this._isWindowsPhone},e.prototype.getIsWindows81=function(){return this._isWindows81},e.prototype.getIsAndroidPhone=function(){return this._isAndroidPhone},e.prototype.getIsAndroid=function(){return this._isAndroid},e.prototype.getBrowserName=function(){return this.getIsBrowserChrome()?"Chrome":this.getIsBrowserEdge()?"Edge":this.getIsBrowserIE()?"IE":this.getIsBrowserFirefox()?"Firefox":this.getIsBrowserSafari()?"Safari":"Other"},e}();t.default=n}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&apos;"},n=new RegExp("[<>&\"']","g");t.formatArrayToString=function(e,t,r){return void 0===r&&(r=""),e&&e instanceof Array&&0!==e.length?e.map(t).join(r):""},t.escapeXml=function(e){return e.replace(n,(function(e){return r[e]}))},t.combineObjects=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce((function(e,t){return Object.keys(t).filter((function(e){return t.hasOwnProperty(e)})).forEach((function(r){return e[r]=t[r]})),e}),{})}}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(2)],void 0===(o=function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.query=function(e,t){return(e.match(/^#[a-zA-Z0-9-_]+$/)&&!t?r.default.document().getElementById(e.slice(1,e.length)):(t||r.default.document()).querySelector(e))||r.default.document().createElement("div")},e.queryById=function(t,r){return e.query("#"+t,r)},e.queryAll=function(e){return r.default.document().querySelectorAll(e)},e.createFragment=function(e){return r.default.document().createRange().createContextualFragment(e)},e.removeElement=function(t){var r=e.query(t);return r&&r.parentNode.removeChild(r)},e.prepend=function(t,r){var n=e.query(t);n.insertBefore(r,n.firstChild)}}(n||(n={})),t.default=n}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TrackCategorizedItems={name:"TrackCategorizedItems",enabledValue:"True",defaultValue:!1};t.TrackAppointmentsFromNonOrganizer={name:"TrackAppointmentsFromNonOrganizer",enabledValue:"True",defaultValue:!0};t.DelegateAccessEnabled={name:"DelegateAccessEnabled",enabledValue:"True",defaultValue:!0};t.CreateContactWithoutTracking={name:"CreateContactWithoutTracking",enabledValue:"True",defaultValue:!1};t.EmailInReadModeTrackEnabled={name:"EmailInReadModeTrackEnabled",enabledValue:"True",defaultValue:!1};t.OverrideTrackInCrmBehaviour={name:"OverrideTrackInCrmBehaviour",enabledValue:"1",defaultValue:!1}}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(8)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this._propertyName=e,this._propertyType=t}return Object.defineProperty(e.prototype,"propertyName",{get:function(){return this._propertyName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"propertyType",{get:function(){return this._propertyType},enumerable:!0,configurable:!0}),e.prototype.toSoap=function(){return'<t:FieldURI FieldURI="'+r.default[this.propertyType].toLocaleLowerCase()+":"+this.propertyName+'" />'},e.prototype.toJson=function(){throw new Error("Not Implemented")},e}();t.default=n}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(23),r(26),r(79)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t,r,o,i){return e.call(this,new n.default(t,r),o,i)||this}return a(t,e),t.prototype.toJson=function(){return this.propertyName+" : "+JSON.stringify(this.propertyValue)},t.prototype.getInnerSoap=function(){var e="string"==typeof this.propertyValue?r.escapeXml(this.propertyValue):r.formatArrayToString(this.propertyValue,(function(e){return"<t:String>"+r.escapeXml(e)+"</t:String>"}));return"<t:"+this.propertyName+">"+e+"</t:"+this.propertyName+">"},t}(o.default);t.default=i}.apply(t,n))||(e.exports=o)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(47),o=r(14),i=/[xy]/g;t.EventNameAndTypeRegex=/^[a-zA-Z]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,t.EventNameDotRegex=/\./g,t.PropertyNameRegex=/^[a-zA-Z](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,t.StatsApiKey="a387cfcf60114a43a7699f9fbb49289e-9bceb9fe-1c06-460f-96c5-6a0b247358bc-7238";var a=null,s=null,u=null;function c(e){return"string"==typeof e}function l(e){return"number"==typeof e}function p(e){return"boolean"==typeof e}function d(e){return e instanceof Date}function f(e){return 1e4*(e+621355968e5)}function h(){return!("undefined"==typeof navigator||!navigator.product)&&"ReactNative"===navigator.product}function _(e){return e<10?"0"+e:e.toString()}function m(e){return null==e||""===e}t.numberToBondInt64=function(e){var t=new n.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},t.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(i,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},t.isString=c,t.isNumber=l,t.isBoolean=p,t.isDate=d,t.msToTicks=f,t.getTenantId=function(e){var t=e.indexOf("-");return t>-1?e.substring(0,t):""},t.isBeaconsSupported=function(){return null===a&&(a="undefined"!=typeof navigator&&Boolean(navigator.sendBeacon)),a},t.isUint8ArrayAvailable=function(){return null===s&&(s="undefined"!=typeof Uint8Array&&!function(){if("undefined"!=typeof navigator&&navigator.userAgent){var e=navigator.userAgent.toLowerCase();if((e.indexOf("safari")>=0||e.indexOf("firefox")>=0)&&e.indexOf("chrome")<0)return!0}return!1}()&&!h()),s},t.isPriority=function(e){return!(!l(e)||!(e>=1&&e<=3||5===e))},t.sanitizeProperty=function(e,r){return!t.PropertyNameRegex.test(e)||m(r)?null:(m(r.value)&&(r={value:r,type:o.AWTPropertyType.Unspecified}),r.type=function(e,t){switch(t=function(e){if(l(e)&&e>=0&&e<=4)return!0;return!1}(t)?t:o.AWTPropertyType.Unspecified){case o.AWTPropertyType.Unspecified:return function(e){switch(typeof e){case"string":return o.AWTPropertyType.String;case"boolean":return o.AWTPropertyType.Boolean;case"number":return o.AWTPropertyType.Double;case"object":return d(e)?o.AWTPropertyType.Date:null}return null}(e);case o.AWTPropertyType.String:return c(e)?t:null;case o.AWTPropertyType.Boolean:return p(e)?t:null;case o.AWTPropertyType.Date:return d(e)&&NaN!==e.getTime()?t:null;case o.AWTPropertyType.Int64:return l(e)&&e%1==0?t:null;case o.AWTPropertyType.Double:return l(e)?t:null}return null}(r.value,r.type),r.type?(d(r.value)&&(r.value=f(r.value.getTime())),r.pii>0&&r.cc>0?null:r.pii?function(e){if(l(e)&&e>=0&&e<=13)return!0;return!1}(r.pii)?r:null:r.cc?function(e){if(l(e)&&e>=0&&e<=1)return!0;return!1}(r.cc)?r:null:r):null)},t.getISOString=function(e){return e.getUTCFullYear()+"-"+_(e.getUTCMonth()+1)+"-"+_(e.getUTCDate())+"T"+_(e.getUTCHours())+":"+_(e.getUTCMinutes())+":"+_(e.getUTCSeconds())+"."+function(e){if(e<10)return"00"+e;if(e<100)return"0"+e;return e.toString()}(e.getUTCMilliseconds())+"Z"},t.useXDomainRequest=function(){if(null===u){var e=new XMLHttpRequest;u=void 0===e.withCredentials&&"undefined"!=typeof XDomainRequest}return u},t.isReactNative=h},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Default=0]="Default",e[e.Token=1]="Token",e[e.Cookie=2]="Cookie",e[e.WIA=3]="WIA"}(r||(r={})),t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(1)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="undefined"!=typeof WeakMap?new WeakMap:null,o=function(e){function t(r,o,i,a){var s=e.call(this,r,o,i)||this;return n&&n.set(s,a),Object.setPrototypeOf(s,t.prototype),s}return a(t,e),Object.defineProperty(t.prototype,"errorMessageParameters",{get:function(){return n?n.get(this):[]},enumerable:!0,configurable:!0}),t.createFromComponentError=function(e,r){return new t(e.componentName,e.message,e.code,r)},t}(r.default);t.default=o}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NotLinked=0]="NotLinked",e[e.IsLinked=1]="IsLinked",e[e.LinkFailed=2]="LinkFailed"}(r||(r={})),t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.addNotificationListener=function(e){this.listeners.push(e)},e.removeNotificationListener=function(e){for(var t=this.listeners.indexOf(e);t>-1;)this.listeners.splice(t,1),t=this.listeners.indexOf(e)},e.eventsSent=function(e){for(var t=this,r=function(r){n.listeners[r].eventsSent&&setTimeout((function(){return t.listeners[r].eventsSent(e)}),0)},n=this,o=0;o<this.listeners.length;++o)r(o)},e.eventsDropped=function(e,t){for(var r=this,n=function(n){o.listeners[n].eventsDropped&&setTimeout((function(){return r.listeners[n].eventsDropped(e,t)}),0)},o=this,i=0;i<this.listeners.length;++i)n(i)},e.eventsRetrying=function(e){for(var t=this,r=function(r){n.listeners[r].eventsRetrying&&setTimeout((function(){return t.listeners[r].eventsRetrying(e)}),0)},n=this,o=0;o<this.listeners.length;++o)r(o)},e.eventsRejected=function(e,t){for(var r=this,n=function(n){o.listeners[n].eventsRejected&&setTimeout((function(){return r.listeners[n].eventsRejected(e,t)}),0)},o=this,i=0;i<this.listeners.length;++i)n(i)},e.listeners=[],e}();t.default=n},function(e,t,r){var n,o;n=[r,t,r(37),r(1)],void 0===(o=function(e,t,r,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),function(e){var t=function(){function e(e){this._request=e}return e.prototype.header=function(e){var t=this._request.getResponseHeader(e);return!t&&e&&e.toLowerCase&&(t=this._request.getResponseHeader(e.toLowerCase())),t},e.prototype.status=function(){return this._request.status},e.prototype.statusText=function(){return this._request.statusText},e.prototype.responseURL=function(){return this._request.responseURL},e.prototype.data=function(){switch(this._request.responseType){case"text":return this._request.responseText;default:return this._request.response}},e.prototype.getComponentError=function(e){return new n.ComponentError(e,e+" XMLHTTPRequest failed",n.ErrorCode.XHR_REQUEST_FAILURE,new n.ComponentError("XHR",this.data(),this.status()))},e}();e.Response=t;var o=function(){function e(e,t){this._name=e,this._value=t}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.KeyValue=o,e.SendRequest=function(n){return new Promise((function(o,i){var a=n.isSuccessFn?n.isSuccessFn:function(e){return e>=r.default.Ok&&e<r.default.MultipleChoices},s=new XMLHttpRequest,u=n.method?n.method:"GET",c="GET"===u&&n.args?function(e,t){var r=e.split("?");r.reverse();var n=r.length>1?r[0].split("&"):[];return t.forEach((function(e){n.unshift(e.name+"="+e.value)})),r[0]=n.join("&"),r.reverse(),r.join("?")}(n.url,n.args):n.url,l=!1!==n.isAsync,p=function(e){return void 0===e&&(e=""),function(){var r=new t(s);"error"!==e&&a(r.status())?o(r):i(r)}};s.onload=p(null),s.onerror=p("error"),s.ontimeout=p("error"),s.open(u,c,l),function(t,r){void 0===r&&(r=[]);var n=[new e.KeyValue("X-Requested-With","XMLHttpRequest"),new e.KeyValue("Accept","application/json"),new e.KeyValue("Content-Type","application/json; charset=utf-8")];r&&r.length>0&&r.forEach((function(e,t){var r=n.findIndex((function(t){return t.name===e.name}));-1!==r&&n.splice(r,1),n.push(e)}));n.forEach((function(e){t.setRequestHeader(e.name,e.value)}))}(s,n.headers),n.timeout&&(s.timeout=n.timeout);var d=void 0===n.content?null:n.content,f=n.responseType?n.responseType:"text";s.responseType=f,s.send(d)}))}}(o||(o={})),t.default=o}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(8),r(26)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r){return e.call(this,t,r)||this}return a(t,e),t.prototype.toSoap=function(){return'<t:ExtendedFieldURI DistinguishedPropertySetId="PublicStrings" PropertyName="'+this.propertyName+'" PropertyType="'+r.default[this.propertyType]+'" />'},t.prototype.toJson=function(){throw new Error("Not Implemented")},t}(n.default);t.default=o}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(153),r(154),r(155),r(52),r(80),r(10)],void 0===(o=function(e,t,r,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(){}return e.getRecurrencePatternDetails=function(t){var i={First:1,Second:2,Third:3,Fourth:4,Last:5},a=new r.default,s=t.Pattern.Type;return a.IsNthMonthly=!1,a.IsNthYearly=!1,a.IsWeekDayPattern=!1,a.PatternStartDate=new Date(t.Range.StartDate),-1!==s.indexOf("Daily")?(a.RecurrencePatternType=o.default.Daily,a.Interval=parseInt(t.Pattern.Interval,10),a.DayOfMonth=1,a.MonthOfYear=0):-1!==s.indexOf("Weekly")?(a.RecurrencePatternType=o.default.Weekly,a.Interval=parseInt(t.Pattern.Interval,10),a.DayOfMonth=1,a.MonthOfYear=0,a.DaysOfWeekMask=e.getDaysOfWeek(a.RecurrencePatternType,t.Pattern.DaysOfWeek)):-1!==s.indexOf("AbsoluteMonthly")?(a.RecurrencePatternType=o.default.Monthly,a.IsRelativeMonthlyRecurrencePattern=!1,a.Interval=parseInt(t.Pattern.Interval,10),a.DayOfMonth=parseInt(t.Pattern.DayOfMonth,10),a.MonthOfYear=0):-1!==s.indexOf("RelativeMonthly")?(a.RecurrencePatternType=o.default.Monthly,a.IsRelativeMonthlyRecurrencePattern=!0,a.Interval=parseInt(t.Pattern.Interval,10),a.DaysOfWeekMask=e.getDaysOfWeek(a.RecurrencePatternType,t.Pattern.DaysOfWeek),a.DayOfWeekIndex=parseInt(i[t.Pattern.DayOfWeekIndex].toString(),10),a.MonthOfYear=0):-1!==s.indexOf("AbsoluteYearly")?(a.RecurrencePatternType=o.default.Yearly,a.IsRelativeYearlyRecurrencePattern=!1,a.DayOfMonth=parseInt(t.Pattern.DayOfMonth,10),a.MonthOfYear=parseInt(t.Pattern.MonthOfYear,10)):-1!==s.indexOf("RelativeYearly")&&(a.RecurrencePatternType=o.default.Yearly,a.IsRelativeYearlyRecurrencePattern=!0,a.DaysOfWeekMask=e.getDaysOfWeek(a.RecurrencePatternType,t.Pattern.DaysOfWeek),a.DayOfWeekIndex=parseInt(i[t.Pattern.DayOfWeekIndex].toString(),10),a.MonthOfYear=parseInt(t.Pattern.MonthOfYear,10)),-1!==t.Range.Type.indexOf("NoEnd")?a.PatternEndType=n.default.NoEnd:-1!==t.Range.Type.indexOf("Numbered")?(a.PatternEndType=n.default.Numbered,a.NumberOfOccurrences=parseInt(t.Range.NumberOfOccurrences,10)):-1!==t.Range.Type.indexOf("EndDate")&&(a.PatternEndType=n.default.EndDate,a.PatternEndDate=new Date(t.Range.EndDate)),a},e.getDaysOfWeek=function(e,t){var r={None:0,Sunday:1,Monday:2,Tuesday:4,Wednesday:8,Thursday:16,Friday:32,Weekdays:62,Saturday:64,WeekendDays:65,AllDays:127},n=0,o=t.split(" ");switch(e){case 1:for(var i=0;i<o.length;i++){n|=r[o[i]]}break;case 2:case 3:n=r[o[0]]}return n},e.areEmailAddressDetailsEqual=function(e,t){return!e&&!t||!(!e&&t||e&&!t)&&(e.displayName===t.displayName&&e.emailAddress===t.emailAddress&&e.recipientType===t.recipientType)},e.areEmailAddressDetailsArraysEqual=function(t,r){return!t&&!r||!(!t&&r||t&&!r||t.length!==r.length)&&t.reduce((function(t,n,o){return t&&e.areEmailAddressDetailsEqual(n,r[o])}),!0)},e.parseDateFromExchange=function(e){return e&&-1===e.indexOf("Z")?e+"Z":e},e.isDatesEqual=function(e,t){return e===t||!(!e||!t)&&e.getTime()===t.getTime()},e.isStringArrayEquals=function(e,t){return e===t||!(!e||!t)&&e.sort().join()===t.sort().join()},e.isRecurencPatternsEquals=function(e,t){return e===t||!(!e||!t)&&(e.RecurrencePatternType===t.RecurrencePatternType&&this.isDatesEqual(e.PatternStartDate,t.PatternStartDate)&&this.isDatesEqual(e.PatternEndDate,t.PatternEndDate)&&e.PatternEndType===t.PatternEndType&&e.Interval===t.Interval&&e.IsWeekDayPattern===t.IsWeekDayPattern&&e.IsRelativeYearlyRecurrencePattern===t.IsRelativeYearlyRecurrencePattern&&e.IsRelativeMonthlyRecurrencePattern===t.IsRelativeMonthlyRecurrencePattern&&e.DaysOfWeekMask===t.DaysOfWeekMask&&e.DayOfWeekIndex===t.DayOfWeekIndex&&e.DayOfMonth===t.DayOfMonth&&e.MonthOfYear===t.MonthOfYear&&e.IsNthMonthly===t.IsNthMonthly&&e.IsNthYearly===t.IsNthYearly&&e.NumberOfOccurrences===t.NumberOfOccurrences)},e.areMailboxItemsEqual=function(e,t){if(e===t)return!0;if(e&&t){if(e.Id!==t.Id||e.ItemType!==t.ItemType||e.ItemClass!==t.ItemClass||e.Importance!==t.Importance)return!1;if(!this.isStringArrayEquals(e.Categories,t.Categories))return!1;if(e.ItemType===s.default[s.default.appointment]){var r=e,n=t;return r.GlobalObjectId===n.GlobalObjectId&&r.CalendarItemType===n.CalendarItemType&&this.isDatesEqual(r.ScheduleStart,n.ScheduleStart)&&this.isDatesEqual(r.ScheduleEnd,n.ScheduleEnd)&&r.IsAllDayEvent===n.IsAllDayEvent&&r.Location===n.Location&&r.IsRecurring===n.IsRecurring&&r.LegacyFreeBusyStatus===n.LegacyFreeBusyStatus&&this.isRecurencPatternsEquals(r.RecurrencePatternDetails,n.RecurrencePatternDetails)}return e.InternetMessageId===t.InternetMessageId&&e.ConversationIndex===t.ConversationIndex&&this.isDatesEqual(e.DateTimeSent,t.DateTimeSent)}return!1},e.isMailboxItemChanged=function(e,t){return!(e||!t)||!(!e||!t||e.Id===t.Id)},e.cloneMailboxItem=function(e){var t=new i.default(e.Id);if(e.ItemType===s.default[s.default.appointment]){var n=new a.default(e.Id);t=n;var o=e;if(n.GlobalObjectId=o.GlobalObjectId,n.CalendarItemType=o.CalendarItemType,n.ScheduleStart=o.ScheduleStart,n.ScheduleEnd=o.ScheduleEnd,n.IsAllDayEvent=o.IsAllDayEvent,n.Location=o.Location,n.IsRecurring=o.IsRecurring,n.LegacyFreeBusyStatus=o.LegacyFreeBusyStatus,o.RecurrencePatternDetails){var u=new r.default,c=o.RecurrencePatternDetails;u.RecurrencePatternType=c.RecurrencePatternType,u.PatternStartDate=c.PatternStartDate,u.PatternEndDate=c.PatternEndDate,u.PatternEndType=c.PatternEndType,u.Interval=c.Interval,u.IsWeekDayPattern=c.IsWeekDayPattern,u.IsRelativeYearlyRecurrencePattern=c.IsRelativeYearlyRecurrencePattern,u.IsRelativeMonthlyRecurrencePattern=c.IsRelativeMonthlyRecurrencePattern,u.DaysOfWeekMask=c.DaysOfWeekMask,u.DayOfWeekIndex=c.DayOfWeekIndex,u.DayOfMonth=c.DayOfMonth,u.MonthOfYear=c.MonthOfYear,u.IsNthMonthly=c.IsNthMonthly,u.IsNthYearly=c.IsNthYearly,u.NumberOfOccurrences=c.NumberOfOccurrences,n.RecurrencePatternDetails=u}}else(t=new i.default(e.Id)).InternetMessageId=e.InternetMessageId,t.ConversationIndex=e.ConversationIndex,t.DateTimeSent=e.DateTimeSent,t.DateTimeReceived=e.DateTimeReceived;return t.Categories=[].concat(e.Categories),t.Importance=e.Importance,t.ItemType=e.ItemType,t.ItemClass=e.ItemClass,t},e.cloneEmailAddressDetails=function(e){return e&&{emailAddress:e.emailAddress,displayName:e.displayName,recipientType:e.recipientType}},e.cloneEmailAddressDetailsArray=function(t){return void 0===t&&(t=[]),t.map(e.cloneEmailAddressDetails)},e}();t.default=u}.apply(t,n))||(e.exports=o)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(102),o=r(14),i=r(257),a=r(104),s=r(46),u=r(107),c=r(28),l=function(){function e(){}return e.setEventsHandler=function(e){this._eventHandler=e},e.getEventsHandler=function(){return this._eventHandler},e.scheduleTimer=function(){var e=this,t=this._profiles[this._currentProfile][2];this._timeout<0&&t>=0&&!this._paused&&(this._eventHandler.hasEvents()?(0===t&&this._currentBackoffCount>0&&(t=1),this._timeout=setTimeout((function(){return e._batchAndSendEvents()}),t*(1<<this._currentBackoffCount)*1e3)):this._timerCount=0)},e.initialize=function(e){var t=this;this._newEventsAllowed=!0,this._config=e,this._eventHandler=new i.default(e.collectorUri,e.cacheMemorySizeLimitInNumberOfEvents,e.httpXHROverride,e.clockSkewRefreshDurationInMins),this._initializeProfiles(),a.default.initialize((function(e,r){if(t._config.canSendStatEvent("awt_stats")){var n=new s.default("awt_stats");for(var i in n.setEventPriority(o.AWTEventPriority.High),n.setProperty("TenantId",r),e)e.hasOwnProperty(i)&&n.setProperty(i,e[i].toString());u.default.getLogger(c.StatsApiKey).logEvent(n)}}))},e.setTransmitProfile=function(e){this._currentProfile!==e&&void 0!==this._profiles[e]&&(this.clearTimeout(),this._currentProfile=e,this.scheduleTimer())},e.loadTransmitProfiles=function(e){for(var t in this._resetTransmitProfiles(),e)if(e.hasOwnProperty(t)){if(3!==e[t].length)continue;for(var r=2;r>=0;--r)if(e[t][r]<0){for(var n=r;n>=0;--n)e[t][n]=-1;break}for(r=2;r>0;--r)if(e[t][r]>0&&e[t][r-1]>0){var o=e[t][r-1]/e[t][r];e[t][r-1]=Math.ceil(o)*e[t][r]}this._profiles[t]=e[t]}},e.sendEvent=function(e){this._newEventsAllowed&&(this._currentBackoffCount>0&&e.priority===o.AWTEventPriority.Immediate_sync&&(e.priority=o.AWTEventPriority.High),this._eventHandler.addEvent(e),this.scheduleTimer())},e.flush=function(e){var t=(new Date).getTime();!this._paused&&this._lastUploadNowCall+3e4<t&&(this._lastUploadNowCall=t,this._timeout>-1&&(clearTimeout(this._timeout),this._timeout=-1),this._eventHandler.uploadNow(e))},e.pauseTransmission=function(){this._paused||(this.clearTimeout(),this._eventHandler.pauseTransmission(),this._paused=!0)},e.resumeTransmision=function(){this._paused&&(this._paused=!1,this._eventHandler.resumeTransmission(),this.scheduleTimer())},e.flushAndTeardown=function(){a.default.teardown(),this._newEventsAllowed=!1,this.clearTimeout(),this._eventHandler.teardown()},e.backOffTransmission=function(){this._currentBackoffCount<4&&(this._currentBackoffCount++,this.clearTimeout(),this.scheduleTimer())},e.clearBackOff=function(){this._currentBackoffCount>0&&(this._currentBackoffCount=0,this.clearTimeout(),this.scheduleTimer())},e._resetTransmitProfiles=function(){this.clearTimeout(),this._initializeProfiles(),this._currentProfile=n.AWT_REAL_TIME,this.scheduleTimer()},e.clearTimeout=function(){this._timeout>0&&(clearTimeout(this._timeout),this._timeout=-1,this._timerCount=0)},e._batchAndSendEvents=function(){var e=o.AWTEventPriority.High;this._timerCount++,this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][0]?(e=o.AWTEventPriority.Low,this._timerCount=0):this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][1]&&(e=o.AWTEventPriority.Normal),this._eventHandler.sendEventsForPriorityAndAbove(e),this._timeout=-1,this.scheduleTimer()},e._initializeProfiles=function(){this._profiles={},this._profiles[n.AWT_REAL_TIME]=[4,2,1],this._profiles[n.AWT_NEAR_REAL_TIME]=[12,6,3],this._profiles[n.AWT_BEST_EFFORT]=[36,18,9]},e._newEventsAllowed=!1,e._currentProfile=n.AWT_REAL_TIME,e._timeout=-1,e._currentBackoffCount=0,e._paused=!1,e._timerCount=0,e._lastUploadNowCall=0,e}();t.default=l},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unknown=0]="Unknown",e[e.Ok=200]="Ok",e[e.NoContent=204]="NoContent",e[e.MultipleChoices=300]="MultipleChoices",e[e.Found=302]="Found",e[e.NotModified=304]="NotModified",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.InternalServerError=500]="InternalServerError"}(r||(r={})),t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unknown=0]="Unknown",e[e.Outlook=1]="Outlook",e[e.OutlookWebApp=2]="OutlookWebApp",e[e.OutlookMobile=3]="OutlookMobile"}(r||(r={})),t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RoamingSettingKeys={limitedModeNotificationHasBeenClosed:"LimitedModeNotificationHasBeenClosed",installIdKey:"InstallID",selectedRecipientKey:"SelectedRecipient",isOutlookCheckerCommandVisibleKey:"IsOutlookCheckerCommandVisible"}}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(3),r(70),r(19)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.comparePropertyUpdate=function(e,t){return e.propertyName===t.propertyName},t.default=function e(t,i,a,s,u,c){return void 0===c&&(c=!1),t.ExchangeProvider.MailboxItemProvider.setProperties(a,s,c).catch((function(r){var c,l;if((null===(c=r)||void 0===c?void 0:c.code)===n.default.OFFICE_CATEGORY_UPDATE){var p=t.JsApiProvider.getMailboxItemType();return t.EventManager.ReportTraceWarning("Set properties","Category set with SSS fallback."),e(t,i,u(a,p),s)}if((null===(l=r)||void 0===l?void 0:l.code)===n.default.OFFICE_TRANSIENT_ERROR)return t.EventManager.ReportTraceWarning("Set properties","Only Categories have successfully set. Reflecting updates."),e(t,i,[a.find((function(e){return e.propertyName===o.default.CATEGORIES}))],s,null,!0);throw r})).then((function(){return i.properties[r.PropertyNames.TRACK_STATUS].accessor()}))}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(210)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ApplicationEventLevel=r.ApplicationEventLevel,t.APPLICATION_LEVEL_TO_TRACER_LEVEL_STRING=r.APPLICATION_LEVEL_TO_TRACER_LEVEL_STRING}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.response=e}return e.getChildFromNode=function(e,t){return e.getElementsByTagNameNS("*",t)[0]},e.fromString=function(t){return new e((new DOMParser).parseFromString(t,"application/xml"))},e.sliceNameSpace=function(e){var t=e.split(":");return t.length<2?e:t[1]},e.hasSinglePlainTextChild=function(e){return e&&1===e.childNodes.length&&3===e.childNodes[0].nodeType},e.getExtendedPropertyName=function(t){return"ExtendedProperty"!==e.sliceNameSpace(t.nodeName)?"":e.getChildFromNode(t,"ExtendedFieldURI").getAttribute("PropertyName")},e.getExtendedPropertyId=function(t){return"ExtendedProperty"!==e.sliceNameSpace(t.nodeName)?"":e.getChildFromNode(t,"ExtendedFieldURI").getAttribute("PropertyId")},e.getExtendedPropertyValue=function(t){return"ExtendedProperty"!==e.sliceNameSpace(t.nodeName)?"":e.getChildFromNode(t,"Value").textContent},e.prototype.getNode=function(e){return this.getNodes(e)[0]},e.prototype.getNodes=function(e){return this.response.getElementsByTagNameNS("*",e)},e.prototype.getExtendedPropertyValue=function(e){for(var t=this.getNodes("ExtendedFieldURI"),r=0;r<t.length;r++){var n=t.item(r);if(n.attributes.getNamedItem("PropertyName").value===e)return n.nextSibling.textContent}return""},e.prototype.getNodeTextContent=function(e){var t=this.getNode(e);return t&&t.textContent},e.prototype.getServerVersionInfo=function(){var e,t=this.getNode("ServerVersionInfo");if(t&&t.attributes){e={};var r=t.attributes,n=r.getNamedItem("MajorVersion");e.MajorVersion=n?n.value:"";var o=r.getNamedItem("MinorVersion");e.MinorVersion=o?o.value:"";var i=r.getNamedItem("MajorBuildNumber");e.MajorBuildNumber=i?i.value:"";var a=r.getNamedItem("MinorBuildNumber");e.MinorBuildNumber=a?a.value:"";var s=r.getNamedItem("Version");e.Version=s?s.value:""}return e},e}();t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.GET_MAILBOX_ITEM="GetMailBoxItem",e.GET_MAILBOX_ITEM_ATTACHMENTS="GetMailBoxItemAttachments",e.UPDATE_MAILBOX_ITEM="UpdateMailBoxItem",e.GET_CONTACT_ITEMS="GetContactItems",e.UPDATE_CONTACT_ITEMS="UpdateContactItem",e}();t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(4),r(6)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this._eventName=e,this._eventParameters={},this._eventParameters[r.KnownEventParameterName.EventContextName]={},this._activityId="",this._eventLevel=t,this.addEventParameter(r.EventParameterName.ApplicationEventLevel,this._eventLevel),this.addEventParameter(r.KnownEventParameterName.TimeCreated,new Date)}return e.prototype.toData=function(){var e={};for(var t in this._eventParameters)e[t]=i(this._eventParameters[t]);return{ActivityId:this._activityId,EventName:this.getEventName(),EventValues:e}},e.prototype.addEventParameter=function(e,t){if(void 0===e&&(e="undefined"),null!=t){var o={name:e,value:t};o.name===r.ErrorEventParameterName.Error?o.value=i(n.default.errorToObject(t)):o.value=i(t),o.name===r.EventParameterName.ComponentName&&0!==o.value.indexOf("MailApp.")&&(o.value="MailApp."+o.value),r.KnownEventParameterName.ActivityId===o.name&&(this._activityId=o.value),r.isKnownEventContextParamName(o.name)?(this._addContextParameter(r.KnownEventParameterName.EventContextName,o.name,o.value),this._eventParameters[o.name]=o.value):r.isKnownEventParamName(o.name)?(this._eventParameters[o.name]&&this._addContextParameter(r.KnownEventParameterName.EventContextName,o.name,this._eventParameters[o.name]),this._eventParameters[o.name]=o.value):this._addContextParameter(r.KnownEventParameterName.EventContextName,o.name,o.value)}},e.prototype.getEventParameterValue=function(e){var t;return void 0===(t=e===r.KnownEventParameterName.ActivityId?this._activityId:this._eventParameters[e])&&(t=this._eventParameters[r.KnownEventParameterName.EventContextName][e]),t},e.prototype.getEventParameters=function(){return this._eventParameters},e.prototype.getEventName=function(){return""+r.UCI_EVENT_NAME_PREFIX+this._eventName},e.prototype.getAriaEventName=function(){return""+r.MAILAPP_EVENT_NAME_PREFIX+this._eventName},e.prototype.getActivityId=function(){return this._activityId},e.prototype.getEventLevel=function(){return this._eventLevel},e.prototype._addContextParameter=function(e,t,r){this._eventParameters[e][t]=r},e}();function i(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e?e:e instanceof Date?e.toISOString():JSON.stringify(e)}t.toSimpleTypeValue=i,t.default=o}.apply(t,n))||(e.exports=o)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unknown=0]="Unknown",e[e.MSACID=1]="MSACID",e[e.MSAPUID=2]="MSAPUID",e[e.ANID=3]="ANID",e[e.OrgIdCID=4]="OrgIdCID",e[e.OrgIdPUID=5]="OrgIdPUID",e[e.UserObjectId=6]="UserObjectId",e[e.Skype=7]="Skype",e[e.Yammer=8]="Yammer",e[e.EmailAddress=9]="EmailAddress",e[e.PhoneNumber=10]="PhoneNumber",e[e.SipAddress=11]="SipAddress",e[e.MUID=12]="MUID"}(t.AWTUserIdType||(t.AWTUserIdType={})),function(e){e[e.Started=0]="Started",e[e.Ended=1]="Ended"}(t.AWTSessionState||(t.AWTSessionState={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(28),o=r(14),i=function(){function e(e){this._event={name:"",properties:{}},e&&this.setName(e)}return e.prototype.setName=function(e){this._event.name=e},e.prototype.getName=function(){return this._event.name},e.prototype.setType=function(e){this._event.type=e},e.prototype.getType=function(){return this._event.type},e.prototype.setTimestamp=function(e){this._event.timestamp=e},e.prototype.getTimestamp=function(){return this._event.timestamp},e.prototype.setEventPriority=function(e){this._event.priority=e},e.prototype.getEventPriority=function(){return this._event.priority},e.prototype.setProperty=function(e,t,r){void 0===r&&(r=o.AWTPropertyType.Unspecified);var i={value:t,type:r,pii:o.AWTPiiKind.NotSet,cc:o.AWTCustomerContentKind.NotSet};null!==(i=n.sanitizeProperty(e,i))?this._event.properties[e]=i:delete this._event.properties[e]},e.prototype.setPropertyWithPii=function(e,t,r,i){void 0===i&&(i=o.AWTPropertyType.Unspecified);var a={value:t,type:i,pii:r,cc:o.AWTCustomerContentKind.NotSet};null!==(a=n.sanitizeProperty(e,a))?this._event.properties[e]=a:delete this._event.properties[e]},e.prototype.setPropertyWithCustomerContent=function(e,t,r,i){void 0===i&&(i=o.AWTPropertyType.Unspecified);var a={value:t,type:i,pii:o.AWTPiiKind.NotSet,cc:r};null!==(a=n.sanitizeProperty(e,a))?this._event.properties[e]=a:delete this._event.properties[e]},e.prototype.getPropertyMap=function(){return this._event.properties},e.prototype.getEvent=function(){return this._event},e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10),this.low<0&&(this.high=-1)}return e.prototype._Equals=function(t){var r=new e(t);return this.low===r.low&&this.high===r.high},e}();t.Int64=n;var o=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10)}return e.prototype._Equals=function(t){var r=new e(t);return this.low===r.low&&this.high===r.high},e}();t.UInt64=o;var i=function(){function e(){}return e._ToByte=function(e){return this._ToUInt8(e)},e._ToUInt8=function(e){return 255&e},e._ToInt32=function(e){return 2147483647&e|2147483648&e},e._ToUInt32=function(e){return 4294967295&e},e}();t.Number=i},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFRAME_ID="WebView",t.IFRAME_SANDBOX="allow-scripts allow-same-origin allow-forms allow-popups allow-popups-to-escape-sandbox allow-downloads"}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(1),r(10),r(12)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAllowedForLimitedMode=function(e){if(!e)return!1;var t=e.code<0?e.code>>>0:e.code;return r.ErrorCode.isKnownLimitedModeErrorCode(t)},t.isTrackAllowedInLimitedMode=function(e,t){return e===n.default.message&&t===o.default.Read}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Sender=1]="Sender",e[e.To=2]="To",e[e.Cc=3]="Cc",e[e.Bcc=4]="Bcc",e[e.Organizer=5]="Organizer",e[e.RequiredAttendee=6]="RequiredAttendee",e[e.OptionalAttendee=7]="OptionalAttendee"}(r||(r={})),t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(0),r(1),r(4),r(2)],void 0===(o=function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e,t){void 0===e&&(e=""),void 0===t&&(t=""),this.original=e,this.replacement=t};t.HrefsPair=a;var s="b71fa308-2dca-4ae5-90da-c2088c21a0cc",u="4f395986-5f38-4dbd-98c5-6af11ceb062b",c="color:transparent;text-decoration:none;font-size:0px;visibility:hidden;display:none;height:0px;line-height:0px;overflow:hidden;max-height:0px;float:left;mso-hide:all;width:0px;text-indent:-9999px;";function l(e){var t=e.getAttribute("href");return t&&t.replace(/(.*?)[/]*$/,"$1")}function p(e){var t=i.default.document().createElement("div");return t.innerHTML=e,t}t.getUniqueHrefs=function(e,t){return e.JsApiProvider.getBody().then((function(e){for(var r=[],n=p(e).querySelectorAll('a:not([id*="'+u+"_"+t+'"])'),o=0;o<n.length;o++){var i=l(n[o]);i&&-1===r.indexOf(i)&&r.push(i)}return r}))},t.setTrackingInfo=function(e,t,r,n){return e.JsApiProvider.getBody().then((function(o){var a=p(o),d=u+"_"+t,f="e4bddb03-a05d-4f2a-a429-63001472b26e_"+t,h=s+"_"+t,_=h+"_container",m=a.querySelector('img[id*="'+h+'"]'),v=Array.from(a.querySelectorAll('a:not([id*="'+d+'"])'));if(!m){var g=i.default.document().createElement("img"),E=i.default.document().createElement("p");g.setAttribute("id",h),g.setAttribute("src",r),E.setAttribute("id",_),E.setAttribute("style",c),a.appendChild(E).appendChild(g)}if(n.length>0){n.forEach((function(e){for(var t=0;t<v.length;t++){var r=v[t],n=l(r);if(n&&n.toLowerCase()===e.original.toLowerCase()){var o=a.querySelector('a[href="'+r.getAttribute("href")+'"]');o&&(o.setAttribute("href",e.replacement),o.setAttribute("id",r.getAttribute("id")+"_"+d),v.splice(t,1),t--)}}}));var y=i.default.document().createElement("p");y.setAttribute("id",f),y.setAttribute("style",c),y.textContent=JSON.stringify(n),a.appendChild(y)}return e.JsApiProvider.setBodyHtml(a.innerHTML)}))},t.removeTrackingInfo=function(e,t){return e.JsApiProvider.getBody().then((function(i){var a=p(i),c=u+"_"+t,d="e4bddb03-a05d-4f2a-a429-63001472b26e_"+t,f=s+"_"+t+"_container",h=a.querySelector('[id*="'+d+'"]:last-child');if(h){var _=null;try{_=JSON.parse(h.textContent)}catch(t){return e.EventManager.ReportComponentFailure(new n.ComponentError(r.default.EMAIL_ENGAGEMENT,"Failed to parse JSON of linkPairsContent",n.ErrorCode.JSON_PARSE_FAILURE),[{name:o.ErrorEventParameterName.Error,value:t},{name:o.EventParameterName.Data,value:h.textContent}]),Promise.reject(null)}var m=a.querySelectorAll('a[id*="'+c+'"]');_&&_.length>0&&_.forEach((function(e){for(var t=0;t<m.length;t++){var r=m[t],n=l(r);if(n&&n.toLowerCase()===e.replacement.toLowerCase()){var o=a.querySelector('a[href="'+r.getAttribute("href")+'"]');if(o){var i=r.getAttribute("id").replace("_"+c,"");"null"!==i?o.setAttribute("id",i):o.removeAttribute("id"),o.setAttribute("href",e.original)}}}}))}for(var v=a.querySelectorAll('[id*="'+f+'"], [id*="'+d+'"]'),g=0;g<v.length;g++)v[g].parentNode.removeChild(v[g]);return e.JsApiProvider.setBodyHtml(a.innerHTML)}))}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){this.Id=e};t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(18)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._crmRegardingObjectId="",this._crmTrackingState=r.default.NotLinked,this._crmRegardingObjectName="",this._crmRegardingObjectType=0,this._crmId="",this._crmObjectTypeCode=0,this._crmIsFollowed=0,this._trackTimestamp=""}return Object.defineProperty(e.prototype,"CrmRegardingObjectId",{get:function(){return this._crmRegardingObjectId},set:function(e){this._crmRegardingObjectId=null==e?"":e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CrmTrackingState",{get:function(){return this._crmTrackingState},set:function(e){this._crmTrackingState=isNaN(e)?0:e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CrmRegardingObjectName",{get:function(){return this._crmRegardingObjectName},set:function(e){this._crmRegardingObjectName=null==e?"":e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CrmRegardingObjectType",{get:function(){return this._crmRegardingObjectType},set:function(e){this._crmRegardingObjectType=isNaN(e)?0:e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CrmId",{get:function(){return this._crmId},set:function(e){this._crmId=null==e?"":e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CrmObjectTypeCode",{get:function(){return this._crmObjectTypeCode},set:function(e){this._crmObjectTypeCode=isNaN(e)?0:e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CrmIsFollowed",{get:function(){return this._crmIsFollowed},set:function(e){this._crmIsFollowed=isNaN(e)?0:e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TrackTimestamp",{get:function(){return this._trackTimestamp},set:function(e){this._trackTimestamp=null==e?"":e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CrmCategoryTracker",{get:function(){return this._crmCategoryTracker},set:function(e){this._crmCategoryTracker=isNaN(e)?void 0:e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsTrackedFromMailApp",{get:function(){return this._isTrackedFromMailApp},set:function(e){this._isTrackedFromMailApp=isNaN(e)?void 0:e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SSSPromoteTracker",{get:function(){return this._sssPromoteTracker},set:function(e){this._sssPromoteTracker=isNaN(e)?void 0:e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TrackingStateTracker",{get:function(){return this._trackingStateTracker},set:function(e){this._trackingStateTracker=isNaN(e)?void 0:e},enumerable:!0,configurable:!0}),e.prototype.Clone=function(){var t=new e;return t._crmId=this._crmId,t._crmTrackingState=this._crmTrackingState,t._crmRegardingObjectId=this._crmRegardingObjectId,t._crmRegardingObjectType=this._crmRegardingObjectType,t._crmRegardingObjectName=this._crmRegardingObjectName,t._crmObjectTypeCode=this._crmObjectTypeCode,t._crmIsFollowed=this._crmIsFollowed,t._crmCategoryTracker=this._crmCategoryTracker,t._trackTimestamp=this._trackTimestamp,t._isTrackedFromMailApp=this._isTrackedFromMailApp,t._sssPromoteTracker=this._sssPromoteTracker,t._trackingStateTracker=this._trackingStateTracker,t},e.prototype.toJSON=function(){return{crmId:this._crmId,crmTrackingState:this._crmTrackingState,crmRegardingObjectId:this._crmRegardingObjectId,crmRegardingObjectType:this._crmRegardingObjectType,crmRegardingObjectName:this._crmRegardingObjectName,crmObjectTypeCode:this._crmObjectTypeCode,crmIsFollowed:this._crmIsFollowed,crmCategoryTracker:this._crmCategoryTracker}},e.equals=function(e,t){var r=function(e){return null==e};return!(!r(e)||!r(t))||!(!e||!t)&&(e.CrmId===t.CrmId&&e.CrmRegardingObjectId===t.CrmRegardingObjectId&&e.CrmRegardingObjectName===t.CrmRegardingObjectName&&e.CrmRegardingObjectType===t.CrmRegardingObjectType&&e.CrmTrackingState===t.CrmTrackingState&&e.TrackTimestamp===t.TrackTimestamp)},e}();t.default=n}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Html=0]="Html",e[e.Text=1]="Text"}(r||(r={})),t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Single=0]="Single",e[e.Occurrence=1]="Occurrence",e[e.Exception=2]="Exception",e[e.RecurringMaster=3]="RecurringMaster"}(r||(r={})),t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(213)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.apiEndpoint="/api/v2.0/me/",n}return a(t,e),t.prototype.convertToRestId=function(e){return this.applicationContext.JsApiProvider.convertToRestId(e,this.applicationContext.JsApiProvider.getRestVersionEnum().v2_0)},t.prototype.convertToEwsId=function(e){return this.applicationContext.JsApiProvider.convertToEwsId(e,this.applicationContext.JsApiProvider.getRestVersionEnum().v2_0)},t.API_VERSION="RestV2.0",t}(r.default);t.default=n}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.ALWAYS_OVERWRITE="AlwaysOverwrite",e.AUTO_RESOLVE="AutoResolve",e.NEVER_OVERWRITE="NeverOverwrite",e}();t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(16),r(8)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){return e},i=function(e){if(e){var t=parseInt(e,10);if(!isNaN(t))return t}return 0},a=function(e){if(null!=e){var t=parseInt(e,10);return isNaN(t)?0:t}},s={CrmId:{propertyName:r.default.ID,propertyType:n.default.String,parser:o},CrmRegardingObjectId:{propertyName:r.default.REGARDING_ID,propertyType:n.default.String,parser:o},CrmTrackingState:{propertyName:r.default.TRACKING_STATE,propertyType:n.default.Double,parser:i},CrmRegardingObjectName:{propertyName:r.default.REGARDING_OBJECT_NAME,propertyType:n.default.String,parser:o,serializer:function(e){return e?"*** Restricted ***":e}},CrmRegardingObjectType:{propertyName:r.default.REGARDING_OBJECT_TYPE,propertyType:n.default.String,parser:i},CrmObjectTypeCode:{propertyName:r.default.OBJECT_TYPE_CODE,propertyType:n.default.Double,parser:i},CrmIsFollowed:{propertyName:r.default.IS_FOLLOWED,propertyType:n.default.Integer,parser:i},TrackTimestamp:{propertyName:r.default.TRACK_TIMESTAMP,propertyType:n.default.String,parser:o},CrmCategoryTracker:{propertyName:r.default.CRM_CATEGORY_TRACKER,propertyType:n.default.Integer,parser:a},IsTrackedFromMailApp:{propertyName:r.default.IS_TRACKED_FROM_MAILAPP,propertyType:n.default.Integer,parser:a},SSSPromoteTracker:{propertyName:r.default.SSS_PROMOTE_TRACKER,propertyType:n.default.Integer,parser:a},TrackingStateTracker:{propertyName:r.default.TRACKING_STATE_TRACKER,propertyType:n.default.Integer,parser:a}};t.TrackStatusMap=s}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(216),r(4),r(1),r(217)],void 0===(o=function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="Exchange call timed out",s="Amount of exchange call attempts exceeded",u="Item not found in exchange",c="Exchange call failed",l={code:o.ErrorCode.EXCHANGE_GENERIC,name:"Exchange Call Timeout",message:a};t.allRetriesTimeoutError=l;t.default=function(e,t,p,d,f,h){return h||(h={}),h.allRetriesTimeoutError=l,p.getExchangeApiName().then((function(l){var _=function(e,t){return function(i){switch(i){case r.default.Success:return function(r){var o=[{name:n.EventParameterName.Data,value:{attempts:r}}];e.ReportComponentSuccess(t,null,o)};case r.default.CallFailure:return function(r){var i=[{name:n.ErrorEventParameterName.Error,value:r}];e.ReportTraceError(new o.ComponentError(t,c,o.ErrorCode.GENERIC),i)};case r.default.ItemNotFound:e.ReportTraceError(new o.ComponentError(t,u,o.ErrorCode.EXCHANGE_ITEM_NOT_FOUND));break;case r.default.Timeout:e.ReportTraceError(new o.ComponentError(t,a,o.ErrorCode.GENERIC));break;case r.default.MaxRetryReached:e.ReportTraceWarning(t,s)}}}(e.EventManager,t),m=function(e,t,n,o){return function(i){return e.accept(t,n,i).catch((function(e){return o(r.default.CallFailure)(e),Promise.reject(e)}))}}(p,l,d,_),v=new i.default(m,h);return v.init(f).then((function(e){return _(r.default.Success)(v.attemptsCount),e})).catch((function(e){return e.code===o.ErrorCode.EXCHANGE_ITEM_NOT_FOUND?_(r.default.ItemNotFound):e.message===a?_(r.default.Timeout):_(r.default.MaxRetryReached),Promise.reject(e)}))}))}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(43),r(10),r(27),r(13),r(23),r(91)],void 0===(o=function(e,t,r,n,o,i,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){function t(t,o,i,a){void 0===i&&(i=[]);var s=e.call(this,o===n.default.contact?r.default.UPDATE_CONTACT_ITEMS:r.default.UPDATE_MAILBOX_ITEM,t,o)||this;return s._ewsMethodName="UpdateItem",s.properties=[],s.properties=i,s.conflictResolution=a,s}return a(t,e),t.prototype.getSoapBody=function(e){return'<m:ItemChanges><t:ItemChange>\n\t\t\t\t\t<t:ItemId Id="'+this.itemId+'"/>\n\t\t\t\t\t<t:Updates>\n\t\t\t\t\t\t'+s.formatArrayToString(e,(function(e){return e.toSoap()}))+"\n\t\t\t\t\t</t:Updates>\n\t\t\t\t</t:ItemChange></m:ItemChanges>"},t.prototype.getRestBody=function(e){var t=e.filter((function(e){return e.constructor===i.default})),r=e.filter((function(e){return e.constructor===o.default})),n="";return t.length>0&&(n='"SingleValueExtendedProperties": ['+s.formatArrayToString(t,(function(e){return e.toJson()}),",")+"]"),r&&r.length>0&&r.forEach((function(e){return n+=(n?", ":"")+e.toJson()})),"{"+n+"}"},t.prototype.visitRestV2Api=function(e){try{e.setResource(this.getRestResource(e))}catch(e){return Promise.reject(e)}return e.setRequestMethod("PATCH"),e.setBody(this.getRestBody(this.properties)),e.makeRequest(this.name)},t.prototype.visitEwsApi=function(e){return e.setRequestMethod(this._ewsMethodName),e.setMethodDefinition(this.getMethodDefinitionParamaters()),e.setBodyRequest(this.getSoapBody(this.properties)),e.makeRequest(this.name)},t.prototype.getMethodDefinitionParamaters=function(){var e=['ConflictResolution="'+this.conflictResolution+'"'];return this.itemType!==n.default.appointment&&this.itemType!==n.default.message||e.push('MessageDisposition="SaveOnly"'),this.itemType===n.default.appointment&&e.push('SendMeetingInvitationsOrCancellations="SendToNone"'),e},t}(u.default);t.default=c}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.PREPEND_BODY=r.default.JS_API_PROVIDER+".PrependBody",e.SET_BODY=r.default.JS_API_PROVIDER+".SetBody",e.SET_SUBJECT=r.default.JS_API_PROVIDER+".SetSubject",e.SET_INSTALL_ID=r.default.JS_API_PROVIDER+".SetInstallId",e.GET_INSTALL_ID=r.default.JS_API_PROVIDER+".GetInstallId",e.ADD_FILE_ATTACHMENT=r.default.JS_API_PROVIDER+".AddFileAttachment",e.RETRIEVE_LOCATION=r.default.JS_API_PROVIDER+".RetrieveLocation",e.RETRIEVE_ROOM_MAILBOXES=r.default.JS_API_PROVIDER+".RetrieveRoomMailboxes",e.RETRIEVE_SCHEDULED_START=r.default.JS_API_PROVIDER+".RetrieveScheduledStart",e.RETRIEVE_SCHEDULED_END=r.default.JS_API_PROVIDER+".RetrieveScheduledEnd",e.RETRIEVE_SHARED_PROPERTIES=r.default.JS_API_PROVIDER+".RetrieveSharedProperties",e.SAVE_ROAMING_SETTINGS=r.default.JS_API_PROVIDER+".SetRoamingSettings",e.LOAD_CUSTOM_PROPERTIES=r.default.JS_API_PROVIDER+".LoadCustomProperties",e.SAVE_CUSTOM_PROPERTIES=r.default.JS_API_PROVIDER+".SaveCustomProperties",e.UPDATE_CUSTOM_PROPERTIES=r.default.JS_API_PROVIDER+".UpdateCustomProperties",e.REMOVE_CUSTOM_PROPERTIES=r.default.JS_API_PROVIDER+".RemoveCustomProperties",e.SAVE_ITEM=r.default.JS_API_PROVIDER+".SaveItem",e.GET_SHARED_PROPERTIES=r.default.JS_API_PROVIDER+".GetSharedProperties",e.GET_COMPOSE_MESSAGE_RECIPIENTS=r.default.JS_API_PROVIDER+".GetComposeMessageRecipients",e.GET_COMPOSE_MEETING_ATTENDEES=r.default.JS_API_PROVIDER+".GetComposeMeetingAttendees",e.RETRIEVE_RECIPIENTS=r.default.JS_API_PROVIDER+".RetrieveRecipients",e.RETRIEVE_ATTENDEES=r.default.JS_API_PROVIDER+".RetrieveAttendees",e.GET_SUBJECT=r.default.JS_API_PROVIDER+".GetSubject",e.GET_BODY=r.default.JS_API_PROVIDER+".GetBody",e.GET_CATEGORIES=r.default.JS_API_PROVIDER+".GetCategories",e.ADD_CATEGORIES=r.default.JS_API_PROVIDER+".AddCategories",e.REMOVE_CATEGORIES=r.default.JS_API_PROVIDER+".RemoveCategories",e.UPDATE_CATEGORIES=r.default.JS_API_PROVIDER+".UpdateCategories",e.OPEN_LOGIN_DIALOG=r.default.JS_API_PROVIDER+".OpenLoginDialog",e.MAKE_EWS_REQUEST=r.default.JS_API_PROVIDER+".MakeEwsRequest",e.CONVERT_TO_REST_ID=r.default.JS_API_PROVIDER+".ConvertToRestId",e.CONVERT_TO_EWS_ID=r.default.JS_API_PROVIDER+".ConvertToEwsId",e.GET_MESSAGE_ATTACHMENTS=r.default.JS_API_PROVIDER+".GetMessageAttachments",e.GET_MAILBOX_ITEM=r.default.JS_API_PROVIDER+".GetMailboxItem",e.GET_MAILBOX_ITEM_TYPE=r.default.JS_API_PROVIDER+".GetMailboxItemType",e.GET_MAILBOX_ITEM_ID=r.default.JS_API_PROVIDER+".GetMailboxItemId",e.GET_ROAMING_SETTING=r.default.JS_API_PROVIDER+".GetRoamingSettingsItem",e.SET_ROAMING_SETTING=r.default.JS_API_PROVIDER+".SetRoamingSettingsItem",e.SAVE_ROAMING_SETTING=r.default.JS_API_PROVIDER+".SaveRoamingSettingsItem",e.REMOVE_ROAMING_SETTING=r.default.JS_API_PROVIDER+".RemoveRoamingSettingsItem",e.GET_MAILBOX_DIAGNOSTICS=r.default.JS_API_PROVIDER+".GetMailboxDiagnostics",e.DISPLAY_APPOINTMENT_FORM=r.default.JS_API_PROVIDER+".DisplayNewAppointmentForm",e.GET_EWS_URL=r.default.JS_API_PROVIDER+".GetEwsUrl",e.SET_DISPLAY_LANGUAGE=r.default.JS_API_PROVIDER+".SetDisplayLanguage",e.GET_DISPLAY_LANGUAGE=r.default.JS_API_PROVIDER+".GetDisplayLanguage",e.GET_HOST_TYPE=r.default.JS_API_PROVIDER+".GetHostType",e.GET_CALLBACK_TOKEN=r.default.JS_API_PROVIDER+".GetCallbackToken",e.GET_REST_CALLBACK_TOKEN=r.default.JS_API_PROVIDER+".GetCallbackToken.Rest",e.GET_EWS_CALLBACK_TOKEN=r.default.JS_API_PROVIDER+".GetCallbackToken.Ews",e.ADD_ITEM_CHANGED_HANDLER=r.default.JS_API_PROVIDER+".AddItemChangedHandler",e.IS_DELEGATED_MAILBOX=r.default.JS_API_PROVIDER+".IsDelegatedMailbox",e.IS_SENT_FOLDER=r.default.JS_API_PROVIDER+".IsSent",e.IS_DESKTOP_OUTLOOK=r.default.JS_API_PROVIDER+".IsDesktopOutlook",e.IS_REST_SUPPORTED=r.default.JS_API_PROVIDER+".IsRestSupported",e.IS_MESSAGE=r.default.JS_API_PROVIDER+".IsMessage",e.IS_APPOINTMENT=r.default.JS_API_PROVIDER+".IsAppointment",e}();t.default=n}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(73),r(228)],void 0===(o=function(e,t,r,n){"use strict";function o(e){return e&&e.diagnostics?"string"==typeof e.diagnostics?e.diagnostics:JSON.stringify(e.diagnostics):""}Object.defineProperty(t,"__esModule",{value:!0}),t.OfficeErrorCode=r.OfficeErrorCode,t.getOfficeErrorMessage=function(e){if(!e||!e.error)return r.OfficeErrorMessages[r.OfficeErrorCode.AsyncResultEmpty];var t="",n=r.OfficeErrorMessages[e.error.code];t+=n||JSON.stringify(e.error);var i=o(e);return i&&(t+=". Reason: "+i),""===t&&(t=r.OfficeErrorMessages[r.OfficeErrorCode.UndefinedError]),t},t.getOfficeAsyncError=function(e,t){if(!t||!t.error)return new n.default(e,r.OfficeErrorMessages[r.OfficeErrorCode.AsyncResultEmpty],r.OfficeErrorCode.AsyncResultEmpty);var i=r.OfficeErrorMessages[t.error.code];return i?new n.default(e,i,t.error.code,o(t)):new n.default(e,t.error.message||JSON.stringify(t.error),t.error.code||r.OfficeErrorCode.UndefinedError,o(t))}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(96),r(2),r(64)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={getItem:function(){},setItem:function(){},removeItem:function(){},clear:function(){}},a=function(){function e(){}return Object.defineProperty(e,"localStorage",{get:function(){return e.getStorage(o.default.LocalStorage)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"sessionStorage",{get:function(){return e.getStorage(o.default.SessionStorage)},enumerable:!0,configurable:!0}),e.getStorage=function(t){return t in o.default?e._retrieveStorage(t)||i:e._retrieveStorage(o.default.LocalStorage)||e._retrieveStorage(o.default.SessionStorage)||i},e._retrieveStorage=function(e){return r.default.isStorageAccessible(e)?e===o.default.LocalStorage?n.default.localStorage():e===o.default.SessionStorage?n.default.sessionStorage():void 0:null},e.getItem=function(t){return e.getStorage().getItem(t)},e.setItem=function(t,r){return e.getStorage().setItem(t,r)},e}();t.default=a}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.LocalStorage=0]="LocalStorage",e[e.SessionStorage=1]="SessionStorage"}(r||(r={})),t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n=function(){function e(){}return e.SHOW_MORE_BUTTON="showMoreButton",e.ERROR_INFO="errorInfo",e.SHOW_APP_CHECKER="showAppChecker",e}();t.UIClassNames=n,function(e){e.content="content",e.appchecker="appchecker",e.appcheckerClose="appcheckerClose",e.appcheckerBack="appcheckerBack",e.appcheckerSeeMoreDiagnostics="appcheckerSeeMoreDiagnostics",e.appcheckerDiagnosticsBox="appcheckerDiagnosticsBox",e.appcheckerDownloadLogs="appcheckerDownloadLogs",e.appcheckerClearStorage="appcheckerClearStorage",e.appcheckerPopup="appcheckerPopup",e.appcheckerPopupClose="appcheckerPopupClose",e.appcheckerSectionViews="appcheckerSectionViews",e.appcheckerSectionPrivileges="appcheckerSectionPrivileges",e.appcheckerSectionDashboard="appcheckerSectionDashboard"}(r||(r={})),t.UIIdentifierNames=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(250)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._events=[]}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.handleEvent=function(e,t){this._events.push(e)},e.prototype.getEvents=function(){return this._events},e.prototype.clearEvents=function(){this._events=[]},e}();t.getDeveloperConsoleEventsStoreListener=function(e){return r.default.Initialize(e),n.getInstance()},t.saveEventToDeveloperConsoleStore=function(e){n.getInstance().handleEvent(e)},t.clearDeveloperConsoleStoreEvents=function(){n.getInstance().clearEvents()},t.getDeveloperConsoleStoreEvents=function(){return n.getInstance().getEvents()}}.apply(t,n))||(e.exports=o)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(68),o=r(14),i=r(45),a=function(){function e(e,t){this._allowDeviceFields=e,this._properties=t}return e.prototype.setAppId=function(e){this._addContext("AppInfo.Id",e)},e.prototype.setAppVersion=function(e){this._addContext("AppInfo.Version",e)},e.prototype.setAppLanguage=function(e){this._addContext("AppInfo.Language",e)},e.prototype.setDeviceId=function(e){this._allowDeviceFields&&(n.default.checkAndSaveDeviceId(e),this._addContext("DeviceInfo.Id",e))},e.prototype.setDeviceOsName=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.OsName",e)},e.prototype.setDeviceOsVersion=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.OsVersion",e)},e.prototype.setDeviceBrowserName=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserName",e)},e.prototype.setDeviceBrowserVersion=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserVersion",e)},e.prototype.setDeviceMake=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.Make",e)},e.prototype.setDeviceModel=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.Model",e)},e.prototype.setUserId=function(e,t,r){if(!isNaN(r)&&null!==r&&r>=0&&r<=12)this._addContext("UserInfo.IdType",r.toString());else{var n=void 0;switch(t){case o.AWTPiiKind.SipAddress:n=i.AWTUserIdType.SipAddress;break;case o.AWTPiiKind.PhoneNumber:n=i.AWTUserIdType.PhoneNumber;break;case o.AWTPiiKind.SmtpAddress:n=i.AWTUserIdType.EmailAddress;break;default:n=i.AWTUserIdType.Unknown}this._addContext("UserInfo.IdType",n.toString())}if(isNaN(t)||null===t||t===o.AWTPiiKind.NotSet||t>13)switch(r){case i.AWTUserIdType.Skype:t=o.AWTPiiKind.Identity;break;case i.AWTUserIdType.EmailAddress:t=o.AWTPiiKind.SmtpAddress;break;case i.AWTUserIdType.PhoneNumber:t=o.AWTPiiKind.PhoneNumber;break;case i.AWTUserIdType.SipAddress:t=o.AWTPiiKind.SipAddress;break;default:t=o.AWTPiiKind.NotSet}this._addContextWithPii("UserInfo.Id",e,t)},e.prototype.setUserAdvertisingId=function(e){this._addContext("UserInfo.AdvertisingId",e)},e.prototype.setUserTimeZone=function(e){this._addContext("UserInfo.TimeZone",e)},e.prototype.setUserLanguage=function(e){this._addContext("UserInfo.Language",e)},e.prototype._addContext=function(e,t){"string"==typeof t&&this._properties.setProperty(e,t)},e.prototype._addContextWithPii=function(e,t,r){"string"==typeof t&&this._properties.setPropertyWithPii(e,t,r)},e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(28),o="MicrosoftApplicationsTelemetryDeviceId",i="MicrosoftApplicationsTelemetryFirstLaunchTime",a="MSIE",s="Chrome",u="Firefox",c="Safari",l="Edge",p="Electron",d="SkypeShell",f="PhantomJS",h="Opera",_="Windows",m="Mac OS X",v="Windows Phone",g="Windows RT",E="iOS",y="Android",C="Linux",I="Chrome OS",P=/(windows|win32)/i,T=/ arm;/i,A=/windows\sphone\s\d+\.\d+/i,R=/(macintosh|mac os x)/i,S=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,O=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,b=/android/i,M=/CrOS/i,x={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},N=function(){function e(){}return e.addPropertyStorageOverride=function(e){return!!e&&(this._propertyStorage=e,!0)},e.autoCollect=function(e,t,r){if(this._semanticContext=e,this._disableCookies=t,this._autoCollect(),r||"undefined"==typeof navigator||(r=navigator.userAgent||""),this._autoCollectFromUserAgent(r),this._disableCookies&&!this._propertyStorage)return this._deleteCookie(o),void this._deleteCookie(i);(this._propertyStorage||this._areCookiesAvailable&&!this._disableCookies)&&this._autoCollectDeviceId()},e.checkAndSaveDeviceId=function(e){if(e){var t=this._getData(o),r=this._getData(i);t!==e&&(r=n.getISOString(new Date)),this._saveData(o,e),this._saveData(i,r),this._setFirstLaunchTime(r)}},e._autoCollectDeviceId=function(){var e=this._getData(o);e||(e=n.newGuid()),this._semanticContext.setDeviceId(e)},e._autoCollect=function(){"undefined"!=typeof document&&document.documentElement&&this._semanticContext.setAppLanguage(document.documentElement.lang),"undefined"!=typeof navigator&&this._semanticContext.setUserLanguage(navigator.userLanguage||navigator.language);var e=(new Date).getTimezoneOffset(),t=e%60,r=(e-t)/60,n="+";r>0&&(n="-"),r=Math.abs(r),t=Math.abs(t),this._semanticContext.setUserTimeZone(n+(r<10?"0"+r:r.toString())+":"+(t<10?"0"+t:t.toString()))},e._autoCollectFromUserAgent=function(e){if(e){var t=this._getBrowserName(e);this._semanticContext.setDeviceBrowserName(t),this._semanticContext.setDeviceBrowserVersion(this._getBrowserVersion(e,t));var r=this._getOsName(e);this._semanticContext.setDeviceOsName(r),this._semanticContext.setDeviceOsVersion(this._getOsVersion(e,r))}},e._getBrowserName=function(e){return this._userAgentContainsString("OPR/",e)?h:this._userAgentContainsString(f,e)?f:this._userAgentContainsString(l,e)?l:this._userAgentContainsString(p,e)?p:this._userAgentContainsString(s,e)?s:this._userAgentContainsString("Trident",e)?a:this._userAgentContainsString(u,e)?u:this._userAgentContainsString(c,e)?c:this._userAgentContainsString(d,e)?d:"Unknown"},e._setFirstLaunchTime=function(e){if(!isNaN(e)){var t=new Date;t.setTime(parseInt(e,10)),e=n.getISOString(t)}this.firstLaunchTime=e},e._userAgentContainsString=function(e,t){return t.indexOf(e)>-1},e._getBrowserVersion=function(e,t){return t===a?this._getIeVersion(e):this._getOtherVersion(t,e)},e._getIeVersion=function(e){var t=e.match(new RegExp(a+" ([\\d,.]+)"));if(t)return t[1];var r=e.match(new RegExp("rv:([\\d,.]+)"));return r?r[1]:void 0},e._getOtherVersion=function(e,t){e===c&&(e="Version");var r=t.match(new RegExp(e+"/([\\d,.]+)"));return r?r[1]:"Unknown"},e._getOsName=function(e){return e.match(A)?v:e.match(T)?g:e.match(S)?E:e.match(b)?y:e.match(O)?C:e.match(R)?m:e.match(P)?_:e.match(M)?I:"Unknown"},e._getOsVersion=function(e,t){return t===_?this._getGenericOsVersion(e,"Windows NT"):t===y?this._getGenericOsVersion(e,t):t===m?this._getMacOsxVersion(e):"Unknown"},e._getGenericOsVersion=function(e,t){var r=e.match(new RegExp(t+" ([\\d,.]+)"));return r?x[r[1]]?x[r[1]]:r[1]:"Unknown"},e._getMacOsxVersion=function(e){var t=e.match(new RegExp(m+" ([\\d,_,.]+)"));if(t){var r=t[1].replace(/_/g,".");if(r){var n=this._getDelimiter(r);return n?r.split(n)[0]:r}}return"Unknown"},e._getDelimiter=function(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null},e._saveData=function(e,t){if(this._propertyStorage)this._propertyStorage.setProperty(e,t);else if(this._areCookiesAvailable){var r=new Date;r.setTime(r.getTime()+31536e6);var n="expires="+r.toUTCString();document.cookie=e+"="+t+"; "+n}},e._getData=function(e){if(this._propertyStorage)return this._propertyStorage.getProperty(e)||"";if(this._areCookiesAvailable){e+="=";for(var t=document.cookie.split(";"),r=0;r<t.length;r++){for(var n=t[r],o=0;" "===n.charAt(o);)o++;if(0===(n=n.substring(o)).indexOf(e))return n.substring(e.length,n.length)}}return""},e._deleteCookie=function(e){this._areCookiesAvailable&&(document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},e._disableCookies=!1,e._areCookiesAvailable="undefined"!=typeof document&&void 0!==document.cookie,e}();t.default=N},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n,o;t.MailAppRolePrivileges=["prvAppendActivity","prvAppendToActivity","prvAppendToAccount","prvAppendToContact","prvCreateActivity","prvCreateContact","prvCreateExchangeSyncIdMapping","prvDeleteActivity","prvDeleteExchangeSyncIdMapping","prvReadAccount","prvReadActivity","prvReadAppModule","prvReadAttribute","prvReadContact","prvReadEmailServerProfile","prvReadEntity","prvReadExchangeSyncIdMapping","prvReadMailbox","prvReadOrganization","prvReadQuery","prvReadRelationship","prvReadRole","prvReadSystemApplicationMetadata","prvReadSystemForm","prvReadUser","prvReadUserQuery","prvReadUserApplicationMetadata","prvReadWebResource","prvSearchAvailability","prvShareActivity","prvSyncToOutlook","prvUseOfficeApps","prvWriteActivity","prvWriteMailbox","prvWriteExchangeSyncIdMapping"],function(e){e.PrivilegeErrorOccurs="https://go.microsoft.com/fwlink/p/?linkid=2135239",e.ViewDeactivated="https://go.microsoft.com/fwlink/p/?linkid=2135478",e.Dashboard="https://go.microsoft.com/fwlink/p/?linkid=2137902"}(r||(r={})),t.HelpLinks=r,function(e){e.MyActiveCases="00000000-0000-0000-00aa-000010001028",e.AllCasesforCustomer="00000000-0000-0000-00aa-000010001039",e.RecentOpportunitiesForInteractionCentricForm="09f55f67-3964-4a94-92e3-25c9d272dc30",e.AllCompetitorsSummary="57bca9ac-87a0-4c28-adc8-2d0a4645f29e",e.AllStakeholders="4e3600fa-b9c8-49f4-b69a-51eba06d9bdf",e.NextActivity="1d145a26-fdb7-45ae-b55a-7befa66e184f",e.LastActivity="924e0056-ebf8-408e-90c3-d3b6bdd676e7"}(n||(n={})),t.ViewIds=n,function(e){e.MailAppDashboard="95f2e667-95c3-e611-80d6-00155db7dbc8"}(o||(o={})),t.SystemFormIds=o}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.isKnownCrmErrorCode=function(t){return-1!==[e.CRM_ORGANIZATION_DISABLED,e.CRM_BUSINESS_UNIT_DISABLED,e.CRM_USER_DISABLED,e.CRM_USER_ROLES_MISSING,e.CRM_USER_LICENSE_MISSING,e.CRM_USER_NOT_MEMBER_OF_ORGANIZATION,e.CRM_USER_MISSING_ADMIN_ONLY_MODE_PERMISSIONS,e.CRM_USER_MISSING_PRIVILEGE].indexOf(t)},e.isKnownLimitedModeErrorCode=function(t){return-1!==[e.UV_MAILBOX_INACTIVE,e.UV_SSS_CONFIG_MISSING,e.UV_SSS_CONFIG_MISSING_FOR_ACT,e.UV_SSS_CONFIG_FAILURE,e.UV_SSS_CONFIG_FAILURE_FOR_ACT,e.UV_EMAIL_ADDRESS_MISMATCH].indexOf(t)},e.isKnownOfficeSaveAsyncErrorCode=function(t){return-1!==[e.OFFICE_SAVE_ASYNC_MESSAGE_IN_DIFFERENT_STORE,e.OFFICE_SAVE_ASYNC_UNSUPPORTED,e.OFFICE_SAVE_ASYNC_UNSUPPORTED_IN_OWA,e.OFFICE_SAVE_ASYNC_UNSUPPORTED_IN_OUTLOOK].indexOf(t)},e.isPluginOrWorkflowError=function(t){return-1!==t.indexOf(e.ISV_ABORTED.toString())||-1!==t.indexOf(e.ISV_UNEXPECTED.toString())||-1!==t.indexOf(e.UNMANAGED_IDS_SQL_ERROR.toString())||-1!==t.indexOf(e.TRANSACTION_NOT_STARTED.toString())},e.UNKNOWN=0,e.GENERIC=2147873296,e.NOT_SUPPORTED=2148007944,e.UNCAUGHT_EXCEPTION=2148007955,e.AUTH_FAILED=2147873301,e.CLIENT_LOAD_TIMEOUT=2147873284,e.XHR_REQUEST_FAILURE=2147942402,e.JSON_PARSE_FAILURE=2147942403,e.DELEGATE_DISABLED=2148007945,e.STORAGE_UNAVAILABLE=2147942405,e.STORAGE_OPERATION=2148007952,e.COMPATIBILITY_DEVICE_SUPPORT=2147881472,e.COMPATIBILITY_BROWSER_SUPPORT=2147881473,e.COMPATIBILITY_OUTLOOK_DESKTOP_WITH_IE_SUPPORT=2147881625,e.COMPATIBILITY_MOBILE_BROWSER_SUPPORT=2147881480,e.UV_SSS_CONFIG_MISSING=2147881474,e.UV_SSS_CONFIG_MISSING_FOR_ACT=2147881495,e.UV_SSS_CONFIG_FAILURE=2147881504,e.UV_SSS_CONFIG_FAILURE_FOR_ACT=2147881505,e.UV_MAILBOX_INACTIVE=2147881494,e.UV_ADMIN_ACCESS=2147881475,e.UV_OFFICE_APPS_PERMISSION=2147881477,e.UV_PRIVILEGE_READ_CONTACT=2147881497,e.UV_TABLET_PRIVILEGES=2147873295,e.UV_EMAIL_ADDRESS_MISMATCH=2147881489,e.UV_OPEN_MAILBOX_EXCEPTION=2147869206,e.OFFICE_ASYNC_CALL_FAILED=2147881513,e.OFFICE_SAVE_ASYNC_UNAVAILABLE=2148007938,e.OFFICE_SAVE_ASYNC=2148007937,e.OFFICE_SAVE_ASYNC_MESSAGE_IN_DIFFERENT_STORE=2147881536,e.OFFICE_SAVE_ASYNC_UNSUPPORTED=2147881537,e.OFFICE_SAVE_ASYNC_UNSUPPORTED_IN_OWA=2147881538,e.OFFICE_SAVE_ASYNC_UNSUPPORTED_IN_OUTLOOK=2147881539,e.OFFICE_DELEGATE_SAVE_ASYNC=2148007943,e.OFFICE_FAILED_TO_LOAD=2147793434,e.OFFICE_MAILBOX_ITEM_UNAVAILABLE=2147791382,e.OFFICE_CATEGORY_UPDATE=2147791383,e.OFFICE_TRANSIENT_ERROR=2147791384,e.EXCHANGE_GENERIC=2148007939,e.EXCHANGE_ITEM_NOT_FOUND=2148007940,e.CRM_ORGANIZATION_DISABLED=2147787012,e.CRM_BUSINESS_UNIT_DISABLED=2147746604,e.CRM_USER_DISABLED=2147746341,e.CRM_USER_ROLES_MISSING=2147757833,e.CRM_USER_LICENSE_MISSING=2147799627,e.CRM_USER_NOT_MEMBER_OF_ORGANIZATION=2147951968,e.CRM_USER_MISSING_ADMIN_ONLY_MODE_PERMISSIONS=2147787027,e.CRM_USER_MISSING_PRIVILEGE=2147746336,e.ISV_ABORTED=-2147220891,e.ISV_UNEXPECTED=-2147220956,e.UNMANAGED_IDS_SQL_ERROR=-2147204784,e.TRANSACTION_NOT_STARTED=-2147220911,e.ACCESS_DENIED=-2147187962,e.CRM_APP_MODULE_PERMISSION=2147942404,e}();t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Pending=0]="Pending",e[e.Resolved=1]="Resolved",e[e.Rejected=2]="Rejected"}(r||(r={})),t.DeferredPromiseState=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UnhandledError=0]="UnhandledError",e[e.UnhandledRejection=1]="UnhandledRejection"}(r||(r={})),t.ErrorType=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UndefinedError=-1]="UndefinedError",e[e.AsyncResultEmpty=-2]="AsyncResultEmpty",e[e.CallTimedOut=-3]="CallTimedOut",e[e.InvalidDataFormat=2006]="InvalidDataFormat",e[e.OperationNotSupportedError=5e3]="OperationNotSupportedError",e[e.InternalError=5001]="InternalError",e[e.DataIsNotOnServer=5005]="DataIsNotOnServer",e[e.BrowserAPINotSupported=5009]="BrowserAPINotSupported",e[e.TooManyIncompleteRequestsError=5100]="TooManyIncompleteRequestsError",e[e.InternalFormatError=9002]="InternalFormatError",e[e.InvalidAttachmentPath=9004]="InvalidAttachmentPath",e[e.HtmlSanitizationFailure=9011]="HtmlSanitizationFailure",e[e.AccessRestricted=9017]="AccessRestricted",e[e.GenericTokenError=9018]="GenericTokenError",e[e.GenericSettingsError=9019]="GenericSettingsError",e[e.GenericResponseError=9020]="GenericResponseError",e[e.SaveError=9021]="SaveError",e[e.MessageInDifferentStoreError=9022]="MessageInDifferentStoreError",e[e.CanOnlyGetTokenForSavedItem=9029]="CanOnlyGetTokenForSavedItem",e[e.CallFailedDueToItemChange=9030]="CallFailedDueToItemChange",e[e.HTTPRequestFailure=9040]="HTTPRequestFailure",e[e.NetworkError=9041]="NetworkError",e[e.InternalServerError=9042]="InternalServerError",e[e.ItemNotSaved=9046]="ItemNotSaved",e[e.DialogClosed=12006]="DialogClosed",e[e.DialogAlreadyOpened=12007]="DialogAlreadyOpened",e[e.EndUserIgnore=12009]="EndUserIgnore"}(n||(n={})),t.OfficeErrorCode=n;var o=((r={})[n.UndefinedError]="Undefined error happened",r[n.AsyncResultEmpty]="AsyncResult response is empty",r[n.CallTimedOut]="Internal call time out",r[n.SaveError]="Connection error occurred",r[n.MessageInDifferentStoreError]="The EWS ID can't be retrieved because the message is saved in a different store",r[n.OperationNotSupportedError]="Operation is not supported",r[n.InternalError]="Internal error",r[n.InternalFormatError]="Internal format error",r[n.TooManyIncompleteRequestsError]="Wait until the previous call completes",r[n.CallFailedDueToItemChange]="Api call failed due to item change",r[n.DialogClosed]="Dialog closed by user",r[n.DialogAlreadyOpened]="Operation failed because this add-in already has an active dialog",r[n.EndUserIgnore]="The user chose to ignore the dialog box.",r[n.InvalidDataFormat]="The format of the specified data object is invalid",r[n.HtmlSanitizationFailure]="The HTML santization has failed",r[n.InvalidAttachmentPath]="The attachment path was invalid",r[n.AccessRestricted]="Access Restricted",r[n.GenericSettingsError]="Generic failure while saving roaming settings",r[n.GenericResponseError]="Generic response error",r[n.DataIsNotOnServer]="Operation failed because the data is not current on the server",r[n.NetworkError]="The user is no longer connected to the network",r[n.InternalServerError]="The Exchange server returned an error",r[n.HTTPRequestFailure]="The request has failed",r[n.GenericTokenError]="Generic token error",r[n.CanOnlyGetTokenForSavedItem]="Can only get token for saved item",r[n.BrowserAPINotSupported]="This browser does not support the requested API",r[n.ItemNotSaved]="The id can't be retrieved until the item is saved",r);t.OfficeErrorMessages=o}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(2),r(6),r(0),r(1),r(30)],void 0===(o=function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){this._bcd=e,this._applicationContext=t,this._loadingDeffered=n.default.createDeferredPromise(),this._bootStarted=!1}return e.prototype.boot=function(e){var t=this;if(!this._bootStarted){this._bootStarted=!0;var n=this._applicationContext.Performance.addStopwatch(o.default.RESOURCE_MANAGER),a=e?"."+e:"",s=r.default.document().createElement("script");s.src="resources/loc/resources"+a+".js?v="+r.default.appVersion(),s.onload=function(){n.stop(),t._loadingDeffered.Resolve()},s.onerror=function(){t._applicationContext.EventManager.ReportComponentFailure(new i.ComponentError(o.default.RESOURCE_MANAGER,"Failed to load "+s.src,i.ErrorCode.GENERIC)),t._loadingDeffered.Resolve()},r.default.document().body.appendChild(s)}},Object.defineProperty(e.prototype,"loadingPromise",{get:function(){return this._loadingDeffered.Promise},enumerable:!0,configurable:!0}),e.prototype.getString=function(e){return r.default.appResource(e)||e},e.prototype.getErrorTitle=function(e){if(!e||e.code===i.ErrorCode.UNKNOWN)return this.getString("MoCA_OWA_Generic_Error_Title");var t=this._getErrorCodeTitleResourceId(e.code),r=this.getString(t);return r===t?this.getString("MoCA_OWA_Generic_Error_Title"):r},e.prototype.getErrorMessage=function(e){if(!e||e.code===i.ErrorCode.UNKNOWN)return this.getString("Error_Message_Generic_Mobile_Client");var t=this._getErrorCodeResourceId(e.code),r=this.getString(t);return r===t?this.getString("Error_Message_Generic_Mobile_Client")+this._getErrorCodeAsHexString(e.code):e instanceof a.default&&e.errorMessageParameters&&e.errorMessageParameters.length?r.format.apply(r,e.errorMessageParameters):r},e.prototype._getErrorCodeResourceId=function(e){return null==e?"":"Error_Message_"+this._getErrorCodeAsHexString(e)},e.prototype._getErrorCodeTitleResourceId=function(e){return this._getErrorCodeResourceId(e)+"_Title"},e.prototype._getErrorCodeAsHexString=function(e){var t=e;return t<0&&(t=t+4294967295+1),"0x"+t.toString(16)},e}();t.ResourceManager=s;var u=["ar-sa","bg-bg","ca-es","zh-tw","cs-cz","da-dk","de-de","el-gr","fi-fi","fr-fr","he-il","hu-hu","it-it","ja-jp","ko-kr","nl-nl","nb-no","pl-pl","pt-br","ro-ro","ru-ru","hr-hr","sk-sk","sv-se","th-th","tr-tr","id-id","uk-ua","sl-si","et-ee","lv-lv","lt-lt","vi-vn","eu-es","hi-in","ms-my","kk-kz","gl-es","zh-cn","pt-pt","sr-latn-rs","zh-hk","es-es","sr-cyrl-rs"];t.bootableResourceManager=function(){return function(e,t){var r=t.ResourceManager;return t.ComponentsLoader.ensureComponentLoaded(o.default.JS_API_PROVIDER).then((function(){var e=t.JsApiProvider.getDisplayLanguage();r.boot(e&&-1!==u.indexOf(e.toLowerCase())?e:null)})),r.loadingPromise}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(76),r(121)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.IS_FEATURES_ENABLED=r.default.CRM_PROVIDER+"."+n.default.IS_FEATURES_ENABLED,e.CHECK_READ_PRIVILEGE=r.default.CRM_PROVIDER+"."+n.default.CHECK_READ_PRIVILEGE,e.GET_USER_VALIDATION=r.default.CRM_PROVIDER+"."+n.default.GET_USER_VALIDATION,e.GET_APP_ID=r.default.CRM_PROVIDER+"."+o.default.GET_APP_ID,e.WHO_AM_I=r.default.CRM_PROVIDER+"."+o.default.WHO_AM_I,e.ORG_SETTINGS=r.default.CRM_PROVIDER+"."+o.default.ORG_SETTINGS,e.SYSTEM_USER=r.default.CRM_PROVIDER+"."+o.default.SYSTEM_USER,e.ODATA_BATCH_REQUEST=r.default.CRM_PROVIDER+"."+o.default.ODATA_BATCH_REQUEST,e.EXECUTE_ODATA_QUERY=r.default.CRM_PROVIDER+"."+o.default.ODATA_QUERY,e.CATEGORIES=r.default.CRM_PROVIDER+"."+o.default.TRACKING_CATEGORIES,e}();t.default=i}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.GET_USER_VALIDATION="GetUserValidation",e.CHECK_READ_PRIVILEGE="CheckEntitiesReadPrivilege",e.IS_FEATURES_ENABLED="IsFeaturesEnabled",e}();t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(123),r(37),r(1),r(33),r(4),r(20),r(6),r(29)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){this._applicationContext=t,this._bcd=e}return e.prototype.send=function(e,t){var r=this;return null===this._applicationContext.AuthenticationProvider.getToken()?this._applicationContext.AuthenticationProvider.authenticate().then((function(){return r._sendAuthenticatedRequest(e,t)})):this._sendAuthenticatedRequest(e,t)},e.prototype._sendAuthenticatedRequest=function(t,r,n){var s=this;void 0===n&&(n=!1);var u=this._applicationContext.Performance.addStopwatch(t+".XHR");this._addOrUpdateAuthenticationHeader(r);var c=this._addCorrelationHeadersAndGenerateRequestId(r);return i.default.SendRequest(r).then((function(e){u.stop();var n=e.header("REQ_ID");if(e.header("Content-Type").indexOf("text/html")>-1){var i=e.getComponentError(t);throw e.data().indexOf('errNumber">0x8004A104')>-1?(i.message="Unable to connect to Microsoft Dynamics 365 organization because it is disabled at this time",i.code=o.ErrorCode.CRM_ORGANIZATION_DISABLED,s._applicationContext.EventManager.ReportComponentFailure(i,[{name:a.EventParameterName.ClientRequestId,value:c},{name:a.EventParameterName.ServerRequestId,value:n}]),i):i}var l=s._parseResponse(t,e,r,c,n);if(r.isBatch&&!l.isSuccess&&1===r.batchQueriesCount){i=e.getComponentError(t);throw s._applicationContext.EventManager.ReportComponentFailure(i,[{name:a.EventParameterName.ClientRequestId,value:c},{name:a.EventParameterName.ServerRequestId,value:n}]),i}return l.parsedResponse})).catch((function(u){if(!(u instanceof i.default.Response))throw u;var l=u.header("REQ_ID"),p=s._parseResponse(t,u,r,c,l).parsedResponse,d=e._convertResponseToComponentError(p,t,u),f=o.ErrorCode.isKnownCrmErrorCode(d.code);if(s._isUnauthorizedStatus(u.status())&&!n&&!f)return s._applicationContext.AuthenticationProvider.authenticate().then((function(){return s._sendAuthenticatedRequest(t,r,!0)}));if(r.isBatch&&r.batchQueriesCount>1)return p;throw s._applicationContext.EventManager.ReportComponentFailure(d,[{name:a.EventParameterName.ClientRequestId,value:c},{name:a.EventParameterName.ServerRequestId,value:l},{name:a.EventParameterName.AuthActivityId,value:u.header("AuthActivityId")}]),d}))},e.prototype._isUnauthorizedStatus=function(e){return e===n.default.Unauthorized||e===n.default.Ok||e===n.default.Unknown},e.prototype._addOrUpdateAuthenticationHeader=function(e){var t=this._applicationContext.AuthenticationProvider.getToken();if(t||this._bcd.useAuthMethod===c.default.WIA){var r=this._bcd.useAuthMethod===c.default.WIA?new i.default.KeyValue("withCredentials","True"):new i.default.KeyValue("Authorization","Bearer "+t);e.headers?(e.headers=e.headers.filter((function(e){return e.name!==r.name})),e.headers.unshift(r)):e.headers=[r]}},e.prototype._addCorrelationHeadersAndGenerateRequestId=function(e){var t=this._applicationContext.EventManager.getSessionId(),r=s.default.newGuid().guid,n=[new i.default.KeyValue("Request-Id",r)];return t&&(n.push(new i.default.KeyValue("Client-Session-Id",t)),n.push(new i.default.KeyValue("Client-Activity-Id",t))),e.headers=e.headers?e.headers.concat(n):n,r},e.prototype._parseResponse=function(t,n,i,s,u){var c=n.data();if(!c)return{parsedResponse:c,isSuccess:!1};if(i.isBatch)try{var l=r.parseBatchResponse(n);if(1===i.batchQueriesCount){var p=l[0];return{parsedResponse:p.json(),isSuccess:p.ok}}return{parsedResponse:l.map((function(r){var o=r.json();return r.ok?o:e._convertResponseToComponentError(o,t,n)})),isSuccess:l.every((function(e){return e.ok}))}}catch(e){var d=new o.ComponentError(t,"Failed to parse "+t+" Batch Response, status: "+n.status(),o.ErrorCode.JSON_PARSE_FAILURE);throw this._applicationContext.EventManager.ReportComponentFailure(d,[{name:a.ErrorEventParameterName.Error,value:e},{name:a.EventParameterName.ClientRequestId,value:s},{name:a.EventParameterName.ServerRequestId,value:u}]),d}try{return{parsedResponse:JSON.parse(c)}}catch(e){d=new o.ComponentError(t,"Failed to parse "+t+" XHR.Response JSON, status: "+n.status(),o.ErrorCode.JSON_PARSE_FAILURE);throw this._applicationContext.EventManager.ReportComponentFailure(d,[{name:a.ErrorEventParameterName.Error,value:e},{name:a.EventParameterName.ClientRequestId,value:s},{name:a.EventParameterName.ServerRequestId,value:u}]),d}},e._tryParseCrmError=function(e){try{return e.error?{code:parseInt(e.error.code,16),message:u.default.cleanupGuidFromString(e.error.message||"")}:e._error?{code:parseInt(e._error.Code,16),message:u.default.cleanupGuidFromString(e._error.Description||"")}:null}catch(e){return null}},e._convertResponseToComponentError=function(t,r,n){var i,a=e._tryParseCrmError(t);return o.ErrorCode.isKnownCrmErrorCode(null===(i=a)||void 0===i?void 0:i.code)?new o.ComponentError(r,a.message,a.code):n.getComponentError(r)},e}();t.default=l}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(148),r(171)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="MAIL_CONTEXT";t.MAIL_CONTEXT=o;t.default=function(e,t){var i={id:o,properties:null,actions:null};return i.properties=n.default.reduce((function(r,n){var o=n(e,t);return o&&o.accessor&&(r[o.id]=o),r}),{}),i.actions=r.default.reduce((function(r,n){var o=n(e,t,i);return o&&o.invoker&&(r[o.id]=o),r}),{}),i}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(10),r(151)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t,r){this.property=e,this._value=t,this._itemType=r}return Object.defineProperty(e.prototype,"propertyValue",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"propertyName",{get:function(){return this.property.propertyName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"propertyType",{get:function(){return this.property.propertyType},enumerable:!0,configurable:!0}),e.prototype._getItemTypeTag=function(){return this._itemType===r.default[r.default.message]||this._itemType===r.default[r.default.appointment]?"Message":this._itemType===r.default[r.default.contact]?"Contact":void 0},e.prototype.getInnerSoap=function(){throw"Not implemented"},e.prototype.toJson=function(){throw"Not implemented"},e.prototype.toSoap=function(){var e=this._getItemTypeTag();return"<t:"+n.default.SET_ITEM_FIELD+">\n\t\t\t\t\t"+this.property.toSoap()+"\n\t\t\t\t\t<t:"+e+">\n\t\t\t\t\t\t"+this.getInnerSoap()+"\n\t\t\t\t\t</t:"+e+">\n\t\t\t\t</t:"+n.default.SET_ITEM_FIELD+">"},e}();t.default=o}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(52)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t){return e.call(this,t)||this}return a(t,e),t}(r.default);t.default=n}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){void 0===e&&(e=50),this._itemIds=[],this._recipientEmails={},this._capacity=e}return e.deserialize=function(t,r){void 0===r&&(r=50);var n=new e(r);if(t&&t._itemIds&&t._recipientEmails){n._itemIds=t._itemIds,n._recipientEmails=t._recipientEmails;n._ensureCapacity(0)}return n},e.prototype.add=function(e,t){if(this._recipientEmails[e])this._touch(e);else{this._ensureCapacity(1),this._itemIds.push(e)}this._recipientEmails[e]=t},e.prototype.getEmail=function(e){return this._recipientEmails[e]?(this._touch(e),this._recipientEmails[e]):null},e.prototype._ensureCapacity=function(e){var t=this._itemIds.length+e-this._capacity;if(t>0){for(var r=0;r<t;r++)delete this._recipientEmails[this._itemIds[0]];this._itemIds.splice(0,t)}},e.prototype._touch=function(e){for(var t=this._itemIds,r=t.indexOf(e),n=t.length-1,o=r;o<n;++o){var i=t[o];t[o]=t[o+1],t[o+1]=i}},e}();t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(11),r(50)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return!!e&&!!e.find((function(e){var t=e&&e.dataValues&&e.dataValues[r.PropertyNames.Role]===n.default.Organizer,o=e&&e.entityReference&&e.entityReference.LogicalName===r.CrmTypeNames.User;return t&&o}))}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(10),r(53),r(31),r(18),r(55),r(2)],void 0===(o=function(e,t,r,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){this._applicationContext=e,this._telemetryBaseComponentName=t}return e.prototype.subscribe=function(e){var t=this,r=this._getNotifyUpdateWithTimeout(e),o=r.notifyUpdateWithTimeout,a=r.clearTimeout;this._applicationContext.ExchangeProvider.MailboxItemProvider.addItemChangedListener((function(e){if(e.isMailboxItemChanged&&(t._activityItem=null,a()),e.mailboxItem&&e.trackStatus){t._trackStatus&&t._trackStatus.CrmTrackingState===i.default.WillBeLinked&&t._trackStatus.CrmTrackingState!==e.trackStatus.CrmTrackingState&&a(),t._mailboxItem=e.mailboxItem,t._trackStatus=e.trackStatus;var r=t._lastEvaluatedTrackStatus?t._lastEvaluatedTrackStatus.Clone():null;t.getTrackStatus().then((function(t){e.isMailboxItemChanged?o(Promise.resolve(t)):n.default.equals(r,t)||o(Promise.resolve(t))}))}}))},e.prototype.getTrackStatus=function(){var e=this;if(this._pendingEvaluation)return this._pendingEvaluation;var t=[];return this._hasBooleanValue(this._isLimitedMode)||t.push(this._applicationContext.CRMProvider.isLimitedMode().then((function(t){return e._isLimitedMode=t}))),this._hasBooleanValue(this._isCategoryTrackingEnabled)||t.push(this._applicationContext.CRMProvider.isCategoryTrackingEnabled().then((function(t){return e._isCategoryTrackingEnabled=t}))),this._mailboxItem||t.push(this._applicationContext.ExchangeProvider.MailboxItemProvider.retrieveMailboxItem().then((function(t){return e._mailboxItem=t}))),this._trackStatus||t.push(this._applicationContext.ExchangeProvider.MailboxItemProvider.retrieveTrackStatus().then((function(t){return e._trackStatus=t}))),this._pendingEvaluation=Promise.all(t).then((function(){return e._evaluateTrackStatus()})).then((function(t){return e._lastEvaluatedTrackStatus=t})),this._pendingEvaluation},e.prototype._evaluateTrackStatus=function(){var e=this;if(this._mailboxItem.ItemType===r.default[r.default.appointment]){var t=this._mailboxItem.CalendarItemType;if(-1!==[a.default[a.default.Occurrence],a.default[a.default.Exception]].indexOf(t))return Promise.resolve(new n.default)}return this._checkSSSTrackResilience().then((function(t){e._pendingEvaluation=null;var r=e._trackStatus.Clone();return t?e._isLimitedMode&&r.CrmTrackingState===i.default.WillBeLinked?(e._applicationContext.EventManager.ReportTraceInfo(e._telemetryBaseComponentName+".Resilience","In Limited Mode we alter pending tracking with failure state to allow retry with Immediate Track"),r.CrmTrackingState=i.default.LinkFailed,r):e._isCategoryTrackingEnabled?r.CrmCategoryTracker===o.default.LinkFailed?(e._applicationContext.EventManager.ReportTraceInfo(e._telemetryBaseComponentName+".CategoriesTracking","Tracking state updated: 'Categorized tracking failed CrmCategoryTracker state is LinkFailed.'"),r.CrmTrackingState=i.default.LinkFailed,r):e._mailboxTrackingCategoryName?e._updateTrackStatusBasedOnCategories(r):e._applicationContext.CRMProvider.getMailboxTrackingCategoryName().then((function(t){return e._mailboxTrackingCategoryName=t})).then((function(){return e._updateTrackStatusBasedOnCategories(r)})):r:(r.CrmTrackingState=i.default.LinkFailed,r)})).catch((function(t){throw e._pendingEvaluation=null,t}))},e.prototype._checkSSSTrackResilience=function(){var e=this;return this._shouldBeProcessedWithSSS()&&this._isTrackPendingTimeout()?(this._applicationContext.EventManager.ReportTraceWarning(this._telemetryBaseComponentName+".Resilience","SSS did not process the item in 20 minutes requesting data from CRM"),this.getActivityItem().then((function(t){return e._applicationContext.EventManager.ReportTraceWarning(e._telemetryBaseComponentName+".Resilience","Activity was "+(t?"":"not")+" found in CRM"),Boolean(t)}))):Promise.resolve(!0)},e.prototype._updateTrackStatusBasedOnCategories=function(e){var t="",r=this._mailboxItem.Categories||[],n=r.length>0&&-1!==r.indexOf(this._mailboxTrackingCategoryName),a=e.CrmTrackingState===i.default.IsLinked,s=e.CrmTrackingState===i.default.WillBeLinked,u=i.default[e.CrmTrackingState];if(!n||a||s||(t="User tracked the item using category without Mail App.",e.CrmTrackingState=i.default.WillBeLinked),e.CrmCategoryTracker!==o.default.IsLinked||n||!a&&!s||(t="Category is not present on the item.",e.CrmTrackingState=i.default.WillBeUnlinked),t){var c=i.default[e.CrmTrackingState];this._applicationContext.EventManager.ReportTraceInfo(this._telemetryBaseComponentName+".CategoriesTracking","Tracking state updated: '"+t+"'",{originalTrackingState:u,newTrackingState:c})}return e},e.prototype._hasBooleanValue=function(e){return!1===e||!0===e},e.prototype._isTrackPendingTimeout=function(){return this._getProcessingStartTicks()+12e5<Date.now()},e.prototype._getProcessingStartTicks=function(){var e=new Date(this._trackStatus.TrackTimestamp).getTime();return this._mailboxItem.ItemType===r.default[r.default.message]&&this._mailboxItem.DateTimeSent?Math.max(e,this._mailboxItem.DateTimeSent.getTime()):e},e.prototype._shouldBeProcessedWithSSS=function(){if(this._trackStatus.CrmTrackingState!==i.default.WillBeLinked)return!1;var e=this._mailboxItem.ItemType===r.default[r.default.message];return(!e||!this._applicationContext.JsApiProvider.isComposeMode())&&!!(this._trackStatus.TrackTimestamp||e&&this._mailboxItem.DateTimeSent)},e.prototype._createOdataEqualsCriteria=function(e,t){return null!==t&&(t="'"+t+"'"),e+" eq "+t},e.prototype.getActivityItem=function(){var e=this;if(this._activityItem)return Promise.resolve(this._activityItem);var t=this._mailboxItem.ItemType,n=this._mailboxItem.InternetMessageId,o=this._mailboxItem,i=[],a=null;if(t===r.default[r.default.message]&&n?(a="emails",i.push(this._createOdataEqualsCriteria("messageid",n))):t===r.default[r.default.appointment]&&o.GlobalObjectId&&(a=o.IsRecurring?"recurringappointmentmasters":"appointments",i.push(this._createOdataEqualsCriteria("globalobjectid",o.GlobalObjectId))),i.push(this._createOdataEqualsCriteria("_regardingobjectid_value",this._trackStatus.CrmRegardingObjectId||null)),a){var s=a+"?$filter="+i.join(" and ")+"&$select="+["activityid","_regardingobjectid_value"].join(",");return this._applicationContext.CRMProvider.executeOdataQuery(s).then((function(t){return Array.isArray(t)&&t[0]?e._activityItem=t[0]:null}))}return this._applicationContext.EventManager.ReportTraceWarning(""+this._telemetryBaseComponentName,"Can not construct query to request item from CRM"),Promise.resolve(null)},e.prototype._getNotifyUpdateWithTimeout=function(e){var t=this,r=null,n=function(e){if(t._shouldBeProcessedWithSSS()&&!t._isTrackPendingTimeout()){var n=Math.max(12e5-Date.now()+t._getProcessingStartTicks(),1e3);r=s.default.setTimeout((function(){return e(t.getTrackStatus())}),n)}},o=function(){r&&(s.default.clearTimeout(r),r=null)};return this.getTrackStatus().then((function(){return n(e)})),{clearTimeout:o,notifyUpdateWithTimeout:function(t){o(),e(t),t.then((function(){return n(e)}))}}},e}();t.default=u}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.convertRawProperties=function(e,t){var r=[];for(var n in e){var o=t(e[n]);o&&r.push(o)}return r},e}();t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(0),r(1),r(214)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this.bcd=e,this.applicationContext=t}return e.prototype.setRequestMethod=function(e){this.requestMethod=e},e.prototype.makeRequest=function(e){throw new n.ComponentError(r.default.EXCHANGE_API_PROVIDER,"'makeRequest' API is not supported",n.ErrorCode.NOT_SUPPORTED)},e.prototype.convertToRestId=function(e){throw new n.ComponentError(r.default.EXCHANGE_API_PROVIDER,"'convertToRestId' API is not supported",n.ErrorCode.NOT_SUPPORTED)},e.prototype.convertToEwsId=function(e){throw new n.ComponentError(r.default.EXCHANGE_API_PROVIDER,"'convertToEwsId' API is not supported",n.ErrorCode.NOT_SUPPORTED)},e.prototype.handleError=function(e,t){var o=this._isItemNotFoundErrorCode(e)?n.ErrorCode.EXCHANGE_ITEM_NOT_FOUND:n.ErrorCode.EXCHANGE_GENERIC;return new n.ComponentError(r.default.EXCHANGE_API_PROVIDER,"Exchange request failed. Reason: "+t,o)},e.prototype._isItemNotFoundErrorCode=function(e){return e===o.default.ITEM_NOT_FOUND||e===o.default.INVALID_MAILBOX_ITEM_ID},e}();t.default=i}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(56)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.makeRequest=function(t){var r=this;return this.applicationContext.JsApiProvider.getSharedProperties().then((function(n){var o;return n&&(r.endpoint=null===(o=n.targetRestUrl)||void 0===o?void 0:o.replace("/api",""),r.apiEndpoint="/api/v2.0/Users('"+n.owner+"')/"),e.prototype.makeRequest.call(r,t)}))},t.API_VERSION="RestDelegateV2.0",t}(r.default);t.default=n}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(0),r(85),r(42)],void 0===(o=function(e,t,r,n,o){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Success=0]="Success",e[e.Response=1]="Response",e[e.Error=2]="Error"}(i||(i={}));var s=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.exchange2006MessagesNamespace="http://schemas.microsoft.com/exchange/services/2006/messages",n.exchange2006TypesNamespace="http://schemas.microsoft.com/exchange/services/2006/types",n.requestedVersion="Exchange2010",n.methodDefinition="",n.bodyRequest="",n}return a(t,e),t.prototype.makeRequest=function(e){return this.applicationContext.JsApiProvider.makeEwsRequest(e,this._toSoap()).then(this._handleAsyncResult.bind(this))},t.prototype._toSoap=function(){return this._createRequestHeader()+this._bodyToSoap()+this._createRequestFooter()},t.prototype._bodyToSoap=function(){return this.methodDefinition+"\n\t\t\t\t\t"+this.bodyRequest+"\n\t\t\t\t</"+this.requestMethod+">"},t.prototype.setMethodDefinition=function(e){this.methodDefinition="<"+this.requestMethod+' \n\t\t\t\t\txmlns="'+this.exchange2006MessagesNamespace+'" \n\t\t\t\t\txmlns:t="'+this.exchange2006TypesNamespace+'"',e&&(this.methodDefinition+=" "+e.join(" ")),this.methodDefinition+=">"},t.prototype.setBodyRequest=function(e){this.bodyRequest=e},t.prototype._createRequestHeader=function(){return'<?xml version="1.0" encoding="utf-8"?>\n\t\t\t\t\t\t<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" \n\t\t\t\t\t\t\txmlns:xsd="http://www.w3.org/2001/XMLSchema" \n\t\t\t\t\t\t\txmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" \n\t\t\t\t\t\t\txmlns:t="http://schemas.microsoft.com/exchange/services/2006/types"\n\t\t\t\t\t\t\txmlns:m="http://schemas.microsoft.com/exchange/services/2006/messages">\n\t\t\t\t\t\t<soap:Header>\n\t\t\t\t\t\t<t:RequestServerVersion Version="'+this.requestedVersion+'" />\n\t\t\t\t\t\t</soap:Header>\n\t\t\t\t\t\t<soap:Body>'},t.prototype._createRequestFooter=function(){return"</soap:Body> </soap:Envelope>"},t.prototype._handleAsyncResult=function(e){var t=o.default.fromString(e),r=this.requestMethod+"ResponseMessage";this._handleServerVersionInfo(t,e);var n=t.getNode(r);if(!n)throw this.handleError(null,r+" xml node is missing in response");var a=n.getAttribute("ResponseClass");if(a===i[i.Success])return Promise.resolve(t);var s=t.getNodeTextContent("ResponseCode"),u=t.getNodeTextContent("MessageText");throw this.handleError(s,"ResponseClass: "+a+", MessageText: "+u)},t.prototype._handleServerVersionInfo=function(e,n){if(!this.applicationContext.ExchangeProvider.ExchangeServerVersion){var o=void 0;try{o=e.getServerVersionInfo()}catch(e){var i=r.default.EXCHANGE_API_PROVIDER+"."+t.API_VERSION;this.applicationContext.EventManager.ReportTraceWarning(i,"Failed to get ServerVersionInfo from EWS response")}o&&(this.applicationContext.ExchangeProvider.ExchangeServerVersion=o.MajorVersion+"."+o.MinorVersion+"."+o.MajorBuildNumber+"."+o.MinorBuildNumber,this.applicationContext.ExchangeProvider.EwsSchemaVersion=o.Version)}},t.API_VERSION="ManagedEws2010",t}(n.default);t.default=s}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n};n=[r,t,r(0),r(12),r(35),r(1),r(4),r(2),r(7),r(19),r(57),r(16),r(80),r(52),r(53),r(55),r(10),r(8),r(58),r(13),r(59),r(89),r(219),r(90),r(60),r(11)],void 0===(o=function(e,t,r,n,o,s,u,c,l,p,d,f,h,_,m,v,g,E,y,C,I,P,T,A,R,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var O,b=r.default.MAILBOX_ITEM_PROVIDER+".retrieveMailboxItem",M=r.default.MAILBOX_ITEM_PROVIDER+".updateExtendedProperties",x=r.default.MAILBOX_ITEM_PROVIDER+".getAppointmentAttachmentIds";!function(e){e[e.CustomProperties=0]="CustomProperties",e[e.ExtendedProperties=1]="ExtendedProperties"}(O||(O={})),t.PropertiesOrigin=O;var N=function(){function e(e,t,r){var n=this;this._onDataRetrieved=function(e){return n._mailboxItem=e.mailboxItem,n._trackStatus=e.trackStatus,n._compareAndNotify(),n._pendingDataRetrievalPromise=null,n._setupPolling(),e},this._onDataRetrieveFailed=function(e){throw n._compareAndNotify(),n._pendingDataRetrievalPromise=null,n._setupPolling(),e},this._getItemData=function(e){var t=n._applicationContext.JsApiProvider.getMailboxItem(),r=n._instantiateTrackStatus(e),o=n._isAppointment?n._instantiateAppointmentItem(t,e):n._instantiateMessageItem(t,e);return Promise.all([o,r]).then((function(e){return{mailboxItem:e[0],trackStatus:e[1]}}))},this._applicationContext=t,this._bcd=e,this._exchangeApiProvider=r,this._itemChangedListeners=[],this._setupRetrieval(),this._isAppointment&&this._subscribeToAppointmentTimeChangeEvent()}return Object.defineProperty(e.prototype,"_shouldForceCustomProps",{get:function(){var e=this;return this._applicationContext.ComponentsLoader.ensureComponentLoaded(r.default.CRM_PROVIDER).then((function(){return e._applicationContext.CRMProvider.isFeatureControlBitEnabled(S.FcbNames.ForceUsageOfCustomProperties)}))},enumerable:!0,configurable:!0}),e.prototype.retrieveMailboxItem=function(){return this._mailboxItem&&(!0===this._itemIsSynchronizedToExchange||this._shouldUseCustomPropertiesOnly)?Promise.resolve(this._mailboxItem):this._retrieveData().then((function(e){return e.mailboxItem}))},e.prototype.getAttachmentIds=function(){var e=this;return this._applicationContext.JsApiProvider.getMailboxItemId().then((function(t){return I.default(e._applicationContext,x,e._exchangeApiProvider,new T.default(t,e._getItemType(),[p.default.ATTACHMENT_ID])).then((function(e){return e.Attachments.map((function(e){return e[p.default.ATTACHMENT_ID]}))}))}))},e.prototype.retrieveTrackStatus=function(){return this._trackStatus?Promise.resolve(this._trackStatus):this._retrieveData().then((function(e){return e.trackStatus}))},e.prototype.addItemChangedListener=function(e){this._itemChangedListeners.push(e)},e.prototype.setProperties=function(e){var t=this;this._turnOffPolling();var n=this._isOutlookComposeMode?Promise.resolve(!0):this._shouldForceCustomProps,o=!1;return this._pendingSetPropertiesPromise=n.then((function(r){return o=r,t._setPropertiesPromise(e,r)})).catch((function(e){throw t._pendingSetPropertiesPromise=null,t._runPolling(),t._clearInMemoryCache(),t._applicationContext.EventManager.ReportTraceWarning(r.default.MAILBOX_ITEM_PROVIDER,"Failed to set "+(o?"custom":"extended")+" properties",null,[{name:u.ErrorEventParameterName.Error,value:e}]),e})),this._pendingSetPropertiesPromise.then((function(){t._pendingSetPropertiesPromise=null,t._reflectPropertiesUpdates(e),t._runPolling()}))},e.prototype.pausePolling=function(){this._turnOffPolling(!0)},e.prototype.restartPolling=function(){this._pollingEnabled=!0,this._setupPolling()},e.prototype._subscribeToAppointmentTimeChangeEvent=function(){var e=this;this._applicationContext.CRMProvider.isFeatureControlBitEnabled(S.FcbNames.MailAppEnableAppointmentTimeChangedEvent).then((function(t){t&&e._listenToAppointmentTimeChangeEvent()}))},e.prototype._listenToAppointmentTimeChangeEvent=function(){var e=this;this._applicationContext.JsApiProvider.addAppointmentTimeChangeHandler((function(t){var r=e._mailboxItem;r.ScheduleStart=new Date(t.start),r.ScheduleEnd=new Date(t.end)}))},e.prototype._setPropertiesPromise=function(e,t){var r=this;return Promise.all([this._extendWithExistingTrackStatusProperties(e,t),this._applicationContext.JsApiProvider.isDelegatedMailbox()]).then((function(e){var n=e[0],o=e[1];return t?r._setTrackStatusAsCustomProperties(n,o):r._setTrackStatusAsExchangeProperties(n,o)}))},e.prototype._getDataPromise=function(){var e=this;return this._pendingSetPropertiesPromise?this._pendingSetPropertiesPromise.then((function(){return e._executeRetrieval()})).catch((function(){return e._executeRetrieval()})):this._executeRetrieval()},e.prototype._reflectPropertiesUpdates=function(e){var t,n=this,i=!1,a=((t={})[f.default.IS_TRACKED_FROM_MAILAPP]=!0,t[f.default.TRACKING_STATE_TRACKER]=!0,t[f.default.SSS_PROMOTE_TRACKER]=!0,t),s=[],u={};Object.keys(y.TrackStatusMap).forEach((function(e){var t=y.TrackStatusMap[e].parser,r=y.TrackStatusMap[e].propertyName;u[r]={trackStatusPropertyName:e,parser:t}})),e.forEach((function(e){var t=u[e.propertyName];if(e.propertyName===p.default.CATEGORIES){var r=e.propertyValue||[];o.default.isStringArrayEquals(n._mailboxItem.Categories,r)||(n._mailboxItem.Categories=r,i=!0)}else if(t){var c=t.parser(e.propertyValue);n._trackStatus[t.trackStatusPropertyName]!==c&&(n._trackStatus[t.trackStatusPropertyName]=c,i=!0)}else a[e.propertyName]||s.push(e.propertyName)})),s.length>0&&this._applicationContext.EventManager.ReportTraceWarning(r.default.MAILBOX_ITEM_PROVIDER,"Properties were not updated on cached mailbox item or track status. See Data for props list.",s.join()),i&&this._compareAndNotify()},e.prototype._itemChanged=function(e){this._itemChangedListeners.forEach((function(t){return t(e)}))},e.prototype._retrieveData=function(){return this._pendingDataRetrievalPromise||(this._turnOffPolling(),this._pendingDataRetrievalPromise=this._getDataPromise().then(this._onDataRetrieved).catch(this._onDataRetrieveFailed)),this._pendingDataRetrievalPromise},e.prototype._setupPolling=function(){if(!this._mailboxItem)return this._runPolling();if(this._isAppointment){if(-1!==[v.default[v.default.Occurrence],v.default[v.default.Exception]].indexOf(this._mailboxItem.CalendarItemType))return this._turnOffPolling(!0)}else if(this._mailboxItem.ItemClass&&-1!==this._mailboxItem.ItemClass.indexOf("IPM.Schedule"))return this._turnOffPolling();this._runPolling()},e.prototype._executeRetrieval=function(){var e=this;return this._clearInMemoryCache(),this._applicationContext.JsApiProvider.getMailboxItemId().then((function(t){return e._itemId=t,e._retrieveItemData().then(e._getItemData)}))},e.prototype._retrieveItemData=function(e){var t=this,r=P.default.getBuiltInPropertiesToRequest(this._isAppointment),n=P.default.getExtendedPropertiesToRequest(),o=this._retrieveCustomProperties(n);return this._retrieveItemWithExchangeRetry(r,n).then((function(e){return e&&e[f.default.CUSTOM_PROPERTIES]?[e,null]:o.then((function(t){return[e,t]}))})).then((function(e){var r=e[0],o=e[1],a=r&&r[f.default.CUSTOM_PROPERTIES],s=P.default.evaluateCustomProperties(a,o),u=o&&r&&!a&&P.default.hasTrackingState(r)&&P.default.hasTrackingState(o);return s&&P.default.hasTrackingState(s)&&!u?(t._propertiesOrigin=O.CustomProperties,i(i({},s),P.default.pickBuiltInProperties(r,n))):r&&P.default.hasTrackingState(r)?(t._propertiesOrigin=O.ExtendedProperties,r):P.default.pickBuiltInProperties(r,n)}))},e.prototype._retrieveCustomProperties=function(e){return this._applicationContext.JsApiProvider.getCustomProperties().then((function(t){return P.default.filterCustomProperties(t,e)})).catch((function(){}))},e.prototype._retrieveItemWithExchangeRetry=function(e,t){var r=this;if(this._shouldUseCustomPropertiesOnly)return Promise.resolve(null);var n=this._isAppointment&&!1===this._itemIsSynchronizedToExchange?{maxRetryCount:10,requestDelay:1e3,allRetriesTimeout:3e4}:{};return I.default(this._applicationContext,b,this._exchangeApiProvider,new A.default(this._itemId,this._getItemType(),e,t),null,n).then((function(e){return r._itemIsSynchronizedToExchange=!0,P.default.normalize(e,t)})).catch((function(e){if(e&&e.code===s.ErrorCode.EXCHANGE_ITEM_NOT_FOUND)return r._itemIsSynchronizedToExchange=!1,null;throw r._applicationContext.EventManager.ReportComponentFailure(new s.ComponentError(b,"Failed to retrieve data. Reason("+e.name+": "+e.message+")",s.ErrorCode.EXCHANGE_GENERIC)),e}))},Object.defineProperty(e.prototype,"_shouldUseCustomPropertiesOnly",{get:function(){return this._isOutlookComposeMode&&this._isMessage},enumerable:!0,configurable:!0}),e.prototype._setTrackStatusAsExchangeProperties=function(e,t){var r=this;if(this._propertiesOrigin===O.CustomProperties){var n=this._applicationContext.JsApiProvider.getMailboxItemType(),o=JSON.stringify({});e.push(new C.default(f.default.CUSTOM_PROPERTIES,E.default.String,o,n))}return this._setExchangeProperties(e).then((function(){r._propertiesOrigin===O.CustomProperties&&(r._propertiesOrigin=O.ExtendedProperties)})).catch((function(n){if(n&&n.code===s.ErrorCode.EXCHANGE_ITEM_NOT_FOUND&&(r._itemIsSynchronizedToExchange=!1,r._propertiesOrigin!==O.ExtendedProperties))return r._isComposeOrSent().then((function(o){if(o)return r._propertiesOrigin=O.CustomProperties,r._setTrackStatusAsCustomProperties(e,t);throw n}));throw n}))},e.prototype._setExchangeProperties=function(e){var t=this;return this._applicationContext.JsApiProvider.isDelegatedMailbox().then((function(r){return r?t._setExchangePropertiesWithRetry(e,null,{maxRetryCount:1}):t._setExchangePropertiesWithRetry(e)}))},e.prototype._setExchangePropertiesWithRetry=function(e,t,n){var o=this;return this._applicationContext.EventManager.ReportTraceInfo(r.default.MAILBOX_ITEM_PROVIDER,"Updating item on Exchange",P.default.getTelemetryTraceData(e)),this._applicationContext.JsApiProvider.getMailboxItemId().then((function(r){var i=new R.default(r,o._getItemType(),e,d.default.ALWAYS_OVERWRITE);return I.default(o._applicationContext,M,o._exchangeApiProvider,i,t,n)})).then((function(){o._applicationContext.EventManager.ReportTraceInfo(r.default.MAILBOX_ITEM_PROVIDER,"Item was successfully updated on Exchange")}))},e.prototype._setTrackStatusAsCustomProperties=function(e,t){var n,o=P.default.split(e),s=o[0],u=o[1];if(this._applicationContext.EventManager.ReportTraceInfo(r.default.MAILBOX_ITEM_PROVIDER,"Setting custom properties",i(i({},s),((n={})[f.default.REGARDING_OBJECT_NAME]=void 0,n))),!this._itemIsSynchronizedToExchange||this._isOutlookComposeMode&&!u.length||t)return this._applicationContext.JsApiProvider.setCustomProperties(s);var c=this._applicationContext.JsApiProvider.getMailboxItemType(),l=new C.default(f.default.CUSTOM_PROPERTIES,E.default.String,JSON.stringify(s),c);return this._setExchangeProperties(a(u,[l]))},e.prototype._instantiateMessageItem=function(e,t){var r=new _.default(this._itemId),n={};return r.InternetMessageId=e.internetMessageId,t&&(r.ConversationIndex=t.ConversationIndex,r.DateTimeReceived=new Date(o.default.parseDateFromExchange(t.DateTimeReceived)),t.InternetMessageId&&!r.InternetMessageId&&(r.InternetMessageId=t.InternetMessageId,n[p.default.INTERNET_MESSAGE_ID]=t.InternetMessageId),t.DateTimeSent&&(r.DateTimeSent=new Date(o.default.parseDateFromExchange(t.DateTimeSent)))),r.ItemType=e.itemType,r.ItemClass=e.itemClass,r.Categories=t&&t.Categories||[],r.Importance=t&&t.Importance,Object.keys(n).length>0&&this._applicationContext.EventManager.ReportTraceInfo(b,"Additional data from exchange",n),r},e.prototype._instantiateAppointmentItem=function(e,t){var r=new h.default(this._itemId);if(t){switch(r.GlobalObjectId=t.UID,t.CalendarItemType){case"SingleInstance":r.CalendarItemType=v.default[v.default.Single];break;case"SeriesMaster":r.CalendarItemType=v.default[v.default.RecurringMaster];break;default:r.CalendarItemType=t.CalendarItemType}r.Location=t.Location,r.IsRecurring=null!=t.Recurrence,r.IsAllDayEvent=!1,r.LegacyFreeBusyStatus=t.LegacyFreeBusyStatus,null!=t.IsAllDayEvent&&(r.IsAllDayEvent="true"===t.IsAllDayEvent.toString()),r.IsRecurring&&(r.RecurrencePatternDetails=o.default.getRecurrencePatternDetails(t.Recurrence))}return r.ItemType=e.itemType,r.ItemClass=e.itemClass,r.Categories=t&&t.Categories||[],r.Importance=t&&t.Importance,Promise.all([this._applicationContext.JsApiProvider.getStartDate(),this._applicationContext.JsApiProvider.getEndDate(),this._applicationContext.JsApiProvider.getLocation()]).then((function(e){var t=e[0],n=e[1],o=e[2];return r.ScheduleStart=t,r.ScheduleEnd=n,o&&(r.Location=o),r})).catch((function(){return r}))},e.prototype._instantiateTrackStatus=function(e){var t=new m.default;return e&&Object.keys(y.TrackStatusMap).forEach((function(r){var n=y.TrackStatusMap[r].parser,o=y.TrackStatusMap[r].propertyName;t[r]=n(e[o])})),this._applicationContext.JsApiProvider.isComposeMode()?Promise.resolve(t):this._isEmailEngagementFeatureEnabled().then((function(e){return e||(t.CrmIsFollowed=0),t}))},e.prototype._isEmailEngagementFeatureEnabled=function(){var e=[this._applicationContext.CRMProvider.isFeatureControlBitEnabled(S.FcbNames.OfficeMailAppEmailEngagement),this._applicationContext.CRMProvider.isFeatureControlBitEnabled(S.FcbNames.EmailEngagement)];return this._applicationContext.ComponentsLoader.ensureComponentLoaded(r.default.CRM_PROVIDER).then((function(){return Promise.all(e).then((function(e){return e.reduce((function(e,t){return e&&t}),!0)}))}))},e.prototype._sendRetrievedDataToTelemetry=function(e){var t=this,r={};this._trackStatus&&Object.keys(y.TrackStatusMap).forEach((function(e){var n=y.TrackStatusMap[e],o=n.propertyName,i=n.serializer;r[o]=i?i(t._trackStatus[e]):t._trackStatus[e]}));var n=this._mailboxItem||{},o={ItemClass:new String(n.ItemClass),ItemId:new String(this._itemId),Categories:n.Categories||[],Importance:n.Importance};if(e&&(o=Object.assign(o,{isMailboxItemUpdated:e.isMailboxItemUpdated,isTrackStatusUpdated:e.isTrackStatusUpdated})),this._isAppointment){var i=n;o=Object.assign(o,{GlobalObjectId:new String(i.GlobalObjectId),CalendarItemType:new String(i.CalendarItemType),IsRecurring:i.IsRecurring,LegacyFreeBusyStatus:new String(i.LegacyFreeBusyStatus),IsAllDayEvent:i.IsAllDayEvent,ScheduleStart:i.ScheduleStart,ScheduleEnd:i.ScheduleEnd})}else o=Object.assign(o,{InternetMessageId:n.InternetMessageId,ConversationIndex:n.ConversationIndex});this._applicationContext.EventManager.ReportTraceInfo(b,"Retrieved item from exchange",o,[{name:u.EventParameterName.TrackStatus,value:r}])},e.prototype._extendWithExistingTrackStatusProperties=function(e,t){if(void 0===t&&(t=!1),this._propertiesOrigin===O.CustomProperties||t){var r=this._applicationContext.JsApiProvider.getMailboxItemType();return this.retrieveTrackStatus().then((function(t){return P.default.extendWithExistingTrackStatusProperties(e,t,r)}))}return Promise.resolve(e)},e.prototype._onNewItemRetrieved=function(){var e=this._applicationContext.DispatcherCollection[l.default.NAVIGATION];e&&e.deviceEvent("OnRouterReset",null)},e.prototype._setupRetrieval=function(){var e=this;this._pollingEnabled=!0,this._retrieveData().catch((function(){})),this._applicationContext.JsApiProvider.addItemChangedHandler((function(){e._turnOffPolling(),e._itemId=null,e._pendingDataRetrievalPromise=null,e._pendingSetPropertiesPromise=null,e._itemIsSynchronizedToExchange=!1,e._retrieveData().then((function(){return e._onNewItemRetrieved()})).catch((function(){return e._onNewItemRetrieved()}))})),this._applicationContext.UIManager.subscribeToErrorEvent((function(){e._turnOffPolling(!0)}),(function(){e._pollingEnabled=!0,e._runPolling()}))},e.prototype._clearInMemoryCache=function(){this._mailboxItem=null,this._trackStatus=null},e.prototype._turnOffPolling=function(e){void 0===e&&(e=!1),e&&(this._pollingEnabled=!1),this._pollingTimerId&&(c.default.clearInterval(this._pollingTimerId),this._pollingTimerId=null)},e.prototype._runPolling=function(){var e=this;this._pollingEnabled&&!this._pollingTimerId&&(this._pollingTimerId=c.default.setInterval((function(){e._retrieveData().catch((function(){}))}),6e4))},e.prototype._compareAndNotify=function(){var e=!1,t=!1,r=!1;if(void 0===this._prevMailboxItem||void 0===this._prevTrackStatus)return this._prevTrackStatus=this._trackStatus?this._trackStatus.Clone():null,this._prevMailboxItem=this._mailboxItem?o.default.cloneMailboxItem(this._mailboxItem):null,void this._sendRetrievedDataToTelemetry();if(o.default.areMailboxItemsEqual(this._prevMailboxItem,this._mailboxItem)||(e=!0,r=o.default.isMailboxItemChanged(this._prevMailboxItem,this._mailboxItem),this._prevMailboxItem=this._mailboxItem?o.default.cloneMailboxItem(this._mailboxItem):null),m.default.equals(this._prevTrackStatus,this._trackStatus)||(this._prevTrackStatus=this._trackStatus?this._trackStatus.Clone():null,t=!0),e||t){var n={isTrackStatusUpdated:t,isMailboxItemUpdated:e,isMailboxItemChanged:r,mailboxItem:this._mailboxItem,trackStatus:this._trackStatus};this._sendRetrievedDataToTelemetry(n),this._itemChanged(n)}},e.prototype._getItemType=function(){return g.default[this._applicationContext.JsApiProvider.getMailboxItemType()]},e.prototype._isComposeOrSent=function(){return this._bcd.mode===n.default.Compose?Promise.resolve(!0):this._applicationContext.JsApiProvider.isSent()},Object.defineProperty(e.prototype,"_isOutlookComposeMode",{get:function(){return this._bcd.mode===n.default.Compose&&this._applicationContext.JsApiProvider.getIsDesktopOutlook()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_isMessage",{get:function(){return this._applicationContext.JsApiProvider.isMessage()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_isAppointment",{get:function(){return this._applicationContext.JsApiProvider.isAppointment()},enumerable:!0,configurable:!0}),e}();t.default=N}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(34),r(16),r(218),r(13),r(27),r(8),r(26),r(19),r(58)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(){function e(){}return e.filterCustomProperties=function(e,t){if(!e)return null;var r={},n=0;return t.forEach((function(t){var o=t.propertyName,i=e.get(o);void 0!==i&&(n++,r[o]=i)})),n?r:null},e.split=function(e){var t={},r=[];return e.forEach((function(e){if(e instanceof i.default){var n=e;t[n.propertyName]=n.propertyValue}else e instanceof a.default&&r.push(e)})),[t,r]},e.splitPropertiesUpdates=function(e){return e.reduce((function(e,t){return t instanceof i.default?e.customProperties[t.propertyName]=t.propertyValue:t instanceof a.default&&t.propertyName===c.default.CATEGORIES&&(e.categoriesUpdate=t),e}),{customProperties:{},categoriesUpdate:null})},e.normalize=function(e,t){var r=new o.default(e[n.default.CUSTOM_PROPERTIES]);return e[n.default.CUSTOM_PROPERTIES]=this.filterCustomProperties(r,t),e},e.hasUpdatedExchangeCustomProperties=function(e,t,r){if(void 0===r&&(r=!1),!r||this.hasTrackingState(e,!0)&&this.hasTrackingState(t,!0)){var o=e[n.default.TRACK_TIMESTAMP],i=t[n.default.TRACK_TIMESTAMP];if(o&&i)return new Date(o).getTime()>new Date(i).getTime()}},e.evaluateCustomProperties=function(e,t){if(!e||!t)return this._getCustomPropertiesInner(e,t);if(this.hasTrackingState(e)&&this.hasTrackingState(t)){var r=this.hasUpdatedExchangeCustomProperties(e,t);return void 0!==r?r?e:t:this._getCustomPropertiesInner(e,t)}return null},e._getCustomPropertiesInner=function(e,t){return e&&this.hasTrackingState(e)?e:t&&this.hasTrackingState(t)?t:null},e.hasTrackingState=function(e,t){if(void 0===t&&(t=!1),t&&!e)return!1;var r=parseInt(e[n.default.TRACKING_STATE],10);return!isNaN(r)},e.pickBuiltInProperties=function(e,t){if(!e)return null;var r=t.map((function(e){return e.propertyName}));return Object.keys(e).filter((function(e){return-1===r.indexOf(e)})).reduce((function(t,r){return t[r]=e[r],t}),{})},e.getExtendedPropertiesToRequest=function(){return[new r.default(n.default.TRACKING_STATE,s.default.Double),new r.default(n.default.REGARDING_ID,s.default.String),new r.default(n.default.REGARDING_OBJECT_TYPE,s.default.String),new r.default(n.default.REGARDING_OBJECT_NAME,s.default.String),new r.default(n.default.ID,s.default.String),new r.default(n.default.OBJECT_TYPE_CODE,s.default.Double),new r.default(n.default.IS_FOLLOWED,s.default.Integer),new r.default(n.default.TRACK_TIMESTAMP,s.default.String),new r.default(n.default.CRM_CATEGORY_TRACKER,s.default.Integer),new r.default(n.default.IS_TRACKED_FROM_MAILAPP,s.default.Integer),new r.default(n.default.TRACKING_STATE_TRACKER,s.default.Integer),new r.default(n.default.SSS_PROMOTE_TRACKER,s.default.Integer),new r.default(n.default.CUSTOM_PROPERTIES,s.default.String)]},e.getBuiltInPropertiesToRequest=function(e){var t=[new u.default(c.default.CATEGORIES,s.default.Item),new u.default(c.default.IMPORTANCE,s.default.Item)];return e?t.push(new u.default(c.default.CALENDAR_ITEM_TYPE,s.default.Calendar),new u.default(c.default.LOCATION,s.default.Calendar),new u.default(c.default.IS_ALL_DAY_EVENT,s.default.Calendar),new u.default(c.default.RECURRENCE,s.default.Calendar),new u.default(c.default.UID,s.default.Calendar),new u.default(c.default.LEGACY_FREE_BUSY_STATUS,s.default.Calendar)):t.push(new u.default(c.default.CONVERSATION_INDEX,s.default.Message),new u.default(c.default.DATE_TIME_SENT,s.default.Item),new u.default(c.default.DATE_TIME_RECEIVED,s.default.Item),new u.default(c.default.INTERNET_MESSAGE_ID,s.default.Message)),t},e.extendWithExistingTrackStatusProperties=function(e,t,r){var n=Object.keys(l.TrackStatusMap).filter((function(t){return!e.some((function(e){return e.propertyName===l.TrackStatusMap[t].propertyName}))}));return e.concat(n.reduce((function(e,n){var o=t[n];if(void 0!==o){var a="string"==typeof o?o:o.toString(),s=l.TrackStatusMap[n],u=s.propertyName,c=s.propertyType;e.push(new i.default(u,c,a,r))}return e}),[]))},e.getTelemetryTraceData=function(e){var t=n.default.REGARDING_OBJECT_NAME;return e.filter((function(e){return-1===t.indexOf(e.propertyName)})).reduce((function(e,r){var o=r.propertyName,i=r.propertyValue;return e[o]=o===n.default.CUSTOM_PROPERTIES?JSON.parse(i,(function(e,r){return e===t?void 0:r})):i,e}),{})},e.getExchangeCustomProperties=function(e){var t=e&&e[n.default.CUSTOM_PROPERTIES];return t&&this.hasTrackingState(t)?t:null},e.getCategoriesUpdate=function(e){return e.find((function(e){return e instanceof a.default&&e.propertyName===c.default.CATEGORIES}))},e}();t.default=p}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(43),r(10),r(8),r(42),r(91),r(19)],void 0===(o=function(e,t,r,n,o,i,s,u){"use strict";var c,l;Object.defineProperty(t,"__esModule",{value:!0});var p=((c={})[u.default.DATE_TIME_SENT]="SentDateTime",c[u.default.DATE_TIME_RECEIVED]="ReceivedDateTime",c),d=((l={})[u.default.IS_ALL_DAY_EVENT]="IsAllDay",l[u.default.CALENDAR_ITEM_TYPE]="Type",l[u.default.UID]="iCalUId",l[u.default.LEGACY_FREE_BUSY_STATUS]="ShowAs",l),f=function(e){function t(t,n,o,i,a){void 0===o&&(o=[]),void 0===i&&(i=[]),void 0===a&&(a=r.default.GET_MAILBOX_ITEM);var s=e.call(this,a,t,n)||this;return s.properties=o,s.extendedProperties=i,s}return a(t,e),t.prototype.visitRestV2Api=function(e){var t=this;try{e.setResource(this.getRestResource(e))}catch(e){return Promise.reject(e)}return e.setRequestMethod("GET"),e.setParameters(this.getRestParameters(e)),e.makeRequest(this.name).then((function(r){return t.populateDataFromRest(r,e)}))},t.prototype.getRestParameters=function(e){var t=this,r="$select=Id";return this.properties.forEach((function(e){var o=e.propertyName;t.itemType===n.default.appointment?d.hasOwnProperty(o)&&(o=d[o]):p.hasOwnProperty(o)&&(o=p[o]),r+=","+o})),this.extendedProperties.length>0&&(r+="&$expand=SingleValueExtendedProperties($filter=",this.extendedProperties.forEach((function(e,t){t>0&&(r+="%20or%20"),r+="PropertyId%20eq%20'"+o.default[e.propertyType]+"%20{00020329-0000-0000-C000-000000000046}%20Name%20"+e.propertyName+"'"})),r+=")"),r},t.prototype.visitEwsApi=function(e){return e.setRequestMethod("GetItem"),e.setMethodDefinition(),e.setBodyRequest(this.getEwsBodyRequest()),e.makeRequest(this.name).then(this.populateDataFromEws.bind(this))},t.prototype.getEwsBodyRequest=function(){var e=this.getEwsItemType(),t="<"+e+"Shape>\n\t\t\t\t\t\t<t:BaseShape>IdOnly</t:BaseShape>";return this.properties.length+this.extendedProperties.length>0&&(t+="<t:AdditionalProperties>",this.properties.forEach((function(e){t+=e.toSoap()})),this.extendedProperties.forEach((function(e){t+=e.toSoap()})),t+="</t:AdditionalProperties>"),t+="</"+e+"Shape>\n\t\t\t\t\t<"+e+"Ids>\n\t\t\t\t\t\t<t:"+e+'Id Id="'+this.itemId+'" />\n\t\t\t\t\t</'+e+"Ids>"},t.prototype.getEwsItemType=function(){switch(this.itemType){case n.default.folder:return"Folder";default:return"Item"}},t.prototype.populateDataFromEws=function(e){var t={};return this.properties.forEach((function(r){var n=e.getNode(r.propertyName);if(n)if(r.propertyName===u.default.RECURRENCE){var o=n.childNodes[0],a=n.childNodes[1],s=i.default.getChildFromNode(o,"Interval"),c=i.default.getChildFromNode(o,"DaysOfWeek"),l=i.default.getChildFromNode(o,"DayOfWeekIndex"),p=i.default.getChildFromNode(o,"DayOfMonth"),d=i.default.getChildFromNode(o,"MonthOfYear"),f=i.default.getChildFromNode(a,"StartDate"),h=i.default.getChildFromNode(a,"EndDate"),_=i.default.getChildFromNode(a,"NumberOfOccurrences");t.Recurrence={Pattern:{Type:o.localName,Interval:s?s.textContent:null,DaysOfWeek:c?c.textContent:null,DayOfWeekIndex:l?l.textContent:null,DayOfMonth:p?p.textContent:null,MonthOfYear:d?new Date(d.textContent+"-1-01").getMonth()+1:0},Range:{Type:a.localName,StartDate:f?f.textContent.substr(0,10)+"T"+f.textContent.substr(11):null,EndDate:h?h.textContent.substr(0,10)+"T"+h.textContent.substr(11):null,NumberOfOccurrences:_?_.textContent:null}}}else if(r.propertyName===u.default.CATEGORIES){var m=void 0;(v=e.getNode(r.propertyName))&&(m=v.children?Array.prototype.slice.call(v.children):Array.prototype.slice.call(v.childNodes)),t[r.propertyName]=m?m.map((function(e){return e.textContent})):[]}else{var v=e.getNode(r.propertyName);t[r.propertyName]=v?v.textContent:null}})),this.extendedProperties.forEach((function(r){t[r.propertyName]=e.getExtendedPropertyValue(r.propertyName)})),t},t.prototype.populateDataFromRest=function(e,t){var r=this,o={};if(e){this.properties.forEach((function(t){r.itemType===n.default.appointment?d.hasOwnProperty(t.propertyName)?o[t.propertyName]=e[d[t.propertyName]]:t.propertyName===u.default.RECURRENCE&&e.Recurrence?(o.Recurrence=e.Recurrence,o.Recurrence.Pattern.DayOfWeekIndex=e.Recurrence.Pattern.Index,o.Recurrence.Pattern.MonthOfYear=e.Recurrence.Pattern.Month,e.Recurrence.Pattern.DaysOfWeek&&(o.Recurrence.Pattern.DaysOfWeek=e.Recurrence.Pattern.DaysOfWeek.join(" "))):t.propertyName===u.default.LOCATION?o.Location=e.Location.DisplayName:"Start"===t.propertyName?o.Start=e.Start.DateTime:"End"===t.propertyName?o.End=e.End.DateTime:o[t.propertyName]=e[t.propertyName]:p.hasOwnProperty(t.propertyName)?o[t.propertyName]=e[p[t.propertyName]]:o[t.propertyName]=e[t.propertyName]}));var i=e.SingleValueExtendedProperties;if(i)for(var a=0;a<i.length;a++){var s=i[a].PropertyId.split(" Name ")[1];o[s]=i[a].Value}}return o},t}(s.default);t.default=f}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(0),r(1),r(10),r(92)],void 0===(o=function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t,r,n){var o=e.call(this,t)||this;return o.itemId=r,o.itemType=n,o}return a(t,e),t.prototype.getRestResource=function(e){var t;switch(this.itemType){case o.default.message:t="messages";break;case o.default.appointment:t="events";break;default:throw new n.ComponentError(r.default.EXCHANGE_API_PROVIDER,"'getRestResource' is not supported for '"+this.itemType+"' item type",n.ErrorCode.NOT_SUPPORTED)}return t+"/"+e.convertToRestId(this.itemId)},t}(i.default);t.default=s}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(1),r(87),r(56),r(86)],void 0===(o=function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e){this._name=e}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),e.prototype.visit=function(e){return e instanceof a.default?this.visitRestV2Api(e):e instanceof i.default?this.visitRestV2Api(e):e instanceof o.default?this.visitEwsApi(e):this._notSupportedOperation("UnknownAPI")},e.prototype.visitEwsApi=function(e){return this._notSupportedOperation(o.default.API_VERSION)},e.prototype.visitRestV2Api=function(e){return this._notSupportedOperation(i.default.API_VERSION)},e.prototype.visitRestDelegateApi=function(e){return this._notSupportedOperation(a.default.API_VERSION)},e.prototype._notSupportedOperation=function(e){return Promise.reject(new n.ComponentError(r.default.EXCHANGE_API_PROVIDER,"'"+e+"' API is not supported for '"+this.name+"' operation",n.ErrorCode.NOT_SUPPORTED))},e}();t.default=s}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(62),r(1),r(2)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o.default.Office(),a=function(){function e(){}return e.prototype._handleAsyncResponse=function(e,t,o,a){return void 0===a&&(a=[]),this._applicationContext.Performance.addRetroactiveStopwatch(e+".AsyncCall",o,Date.now(),a),t&&t.status===i.AsyncResultStatus.Succeeded?(this._applicationContext.EventManager.ReportComponentSuccess(e,null,a),Promise.resolve(t.value)):Promise.reject(new n.ComponentError(e,r.getOfficeErrorMessage(t),n.ErrorCode.OFFICE_ASYNC_CALL_FAILED,r.getOfficeAsyncError(e,t)))},e}();t.default=a}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Desktop=0]="Desktop",e[e.Tablet=1]="Tablet",e[e.Phone=2]="Phone"}(r||(r={})),t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.None=0]="None",e[e.WaitingForDependencies=1]="WaitingForDependencies",e[e.Loading=2]="Loading",e[e.Loaded=3]="Loaded",e[e.Failed=4]="Failed"}(r||(r={})),t.ComponentLoadingState=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(2),r(64),r(1),r(0),r(9)],void 0===(o=function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){this._storageSupport={LocalStorage:null,SessionStorage:null}}return e.prototype.isStorageAccessible=function(e){return void 0===e&&(e=n.default.LocalStorage),this._verifyStorageAvailability(n.default[e])},e.prototype.validateStorage=function(e){return void 0===e&&(e=n.default.LocalStorage),this._verifyStorageAvailability(n.default[e])?null:this._storageSupport[n.default[e]]},e.prototype._verifyStorageAvailability=function(e){if(null!==this._storageSupport[e])return!0===this._storageSupport[e];try{var t=e===n.default[n.default.LocalStorage]?r.default.localStorage():r.default.sessionStorage();t.setItem(a.default.storageValidation,"__storageTest__"),t.removeItem(a.default.storageValidation),this._storageSupport[e]=!0}catch(t){this._storageSupport[e]=o.ComponentError.fromNativeError(i.default.BOOT_MANAGER,o.ErrorCode.STORAGE_UNAVAILABLE,t)}return!0===this._storageSupport[e]},e}();t.StorageAvailability=s,t.default=new s}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(244),r(2)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){this._a=n.default.document().createElement("a"),this._a.href=e,this._searchParams=new r.URLSearchParams(this._a.search),this._searchParams.urlInternal=this}return Object.defineProperty(e.prototype,"searchParams",{get:function(){return this._searchParams},set:function(e){},enumerable:!0,configurable:!0}),e.prototype._updateSearchParams=function(){this._searchParams.updateFromUrlInternal()},e.prototype.toString=function(){return this._a.href},Object.defineProperty(e.prototype,"href",{get:function(){return this._a.href},set:function(e){this._a.href=e,this._updateSearchParams()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"protocol",{get:function(){return this._a.protocol},set:function(e){this._a.protocol=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"host",{get:function(){return this._a.host},set:function(e){this._a.host=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hostname",{get:function(){return this._a.hostname},set:function(e){this._a.hostname=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"port",{get:function(){return this._a.port},set:function(e){this._a.port=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pathname",{get:function(){var e=this._a.pathname;return e[0]&&"/"!==e[0]?"/"+e:e},set:function(e){this._a.pathname=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"search",{get:function(){return this._a.search},set:function(e){this._a.search=e,this._updateSearchParams()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hash",{get:function(){return this._a.hash},set:function(e){this._a.hash=e},enumerable:!0,configurable:!0}),e}();t.CrmURL=o,t.getHostname=function(){var e=n.default.location().href,t=e.indexOf(n.default.location().pathname);return e.substring(0,t)}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(2),r(6)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.generate=function(e,t,r){return e?("http://go.microsoft.com/fwlink/?LinkID=398563&client=MailApp"+this._getDeploymentEnvironmentParams()+this._getCrmErrorLinkParam(e)+this._getServerVersionLinkParam()+this._getCorrelationIdLinkParam(t)+this._getOrganizationIdParam(r)).substring(0,2e3):null},e._getDeploymentEnvironmentParams=function(){var e=r.default.getQueryParams();return"&de="+e.de+"&sde="+e.sde},e._getCrmErrorLinkParam=function(e){return e.code?"&error=Microsoft.Crm.Exception:"+n.default.intToHexString(e.code):""},e._getServerVersionLinkParam=function(){var e=r.default.appVersion();return e?"&cv="+e:""},e._getCorrelationIdLinkParam=function(e){return e?"&cid="+encodeURIComponent(e):""},e._getOrganizationIdParam=function(e){if(e)return"&oid="+encodeURIComponent(e)},e}();t.default=o}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(24)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={NotificationComponent:"notificationComponent",get Collapsed(){return this.NotificationComponent+"-collapsed"},get Label(){return this.NotificationComponent+"_label"},get Text(){return this.NotificationComponent+"_text"}};t.ClassNames=n;var o=function(){function e(e){this.targetSelector="#content",this._isRendered=!1,this._applicationContext=e}return e.prototype.render=function(){if(this._isRendered)throw Error("Previous Notification component should be hidden before next render");var e=r.default.createFragment(this.htmlTemplate);return r.default.prepend(this.targetSelector,e),this._isRendered=!0,this},e}();t.NotificationBase=o}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,r){void 0===t&&(t=-1),void 0===r&&(r=-1),this.name=e,this.startTime=t,this.stopTime=r};t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Low=0]="Low",e[e.High=1]="High"}(r||(r={})),t.SendPriority=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AWT_REAL_TIME="REAL_TIME",t.AWT_NEAR_REAL_TIME="NEAR_REAL_TIME",t.AWT_BEST_EFFORT="BEST_EFFORT"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(14),o=r(45),i=r(46),a=r(28),s=r(104),u=r(32),c=r(36),l=r(108),p=r(106),d=r(67),f=r(68),h=function(){function e(e){this._apiKey=e,this._contextProperties=new i.default,this._semanticContext=new d.default(!1,this._contextProperties),this._sessionStartTime=0,this._createInitId()}return e.prototype.setContext=function(e,t,r){void 0===r&&(r=n.AWTPropertyType.Unspecified),this._contextProperties.setProperty(e,t,r)},e.prototype.setContextWithPii=function(e,t,r,o){void 0===o&&(o=n.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithPii(e,t,r,o)},e.prototype.setContextWithCustomerContent=function(e,t,r,o){void 0===o&&(o=n.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithCustomerContent(e,t,r,o)},e.prototype.getSemanticContext=function(){return this._semanticContext},e.prototype.logEvent=function(t){if(l.default.loggingEnabled){this._apiKey||(this._apiKey=l.default.defaultTenantToken,this._createInitId());var r=!0;a.isString(t)?t={name:t}:t instanceof i.default&&(t=t.getEvent(),r=!1),s.default.eventReceived(this._apiKey),e._logEvent(e._getInternalEvent(t,this._apiKey,r),this._contextProperties)}},e.prototype.logSession=function(t,r){if(l.default.sessionEnabled){var i={name:"session",type:"session",properties:{}};if(e._addPropertiesToEvent(i,r),i.priority=n.AWTEventPriority.High,t===o.AWTSessionState.Started){if(this._sessionStartTime>0)return;this._sessionStartTime=(new Date).getTime(),this._sessionId=a.newGuid(),this.setContext("Session.Id",this._sessionId),i.properties["Session.State"]="Started"}else{if(t!==o.AWTSessionState.Ended)return;if(0===this._sessionStartTime)return;var s=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);i.properties["Session.Id"]=this._sessionId,i.properties["Session.State"]="Ended",i.properties["Session.Duration"]=s.toString(),i.properties["Session.DurationBucket"]=e._getSessionDurationFromTime(s),this._sessionStartTime=0,this.setContext("Session.Id",null),this._sessionId=void 0}i.properties["Session.FirstLaunchTime"]=f.default.firstLaunchTime,this.logEvent(i)}},e.prototype.getSessionId=function(){return this._sessionId},e.prototype.logFailure=function(t,r,o,i,a){if(t&&r){var s={name:"failure",type:"failure",properties:{}};e._addPropertiesToEvent(s,a),s.properties["Failure.Signature"]=t,s.properties["Failure.Detail"]=r,o&&(s.properties["Failure.Category"]=o),i&&(s.properties["Failure.Id"]=i),s.priority=n.AWTEventPriority.High,this.logEvent(s)}},e.prototype.logPageView=function(t,r,n,o,i,a){if(t&&r){var s={name:"pageview",type:"pageview",properties:{}};e._addPropertiesToEvent(s,a),s.properties["PageView.Id"]=t,s.properties["PageView.Name"]=r,n&&(s.properties["PageView.Category"]=n),o&&(s.properties["PageView.Uri"]=o),i&&(s.properties["PageView.ReferrerUri"]=i),this.logEvent(s)}},e.prototype._createInitId=function(){!e._initIdMap[this._apiKey]&&this._apiKey&&(e._initIdMap[this._apiKey]=a.newGuid())},e._addPropertiesToEvent=function(e,t){if(t)for(var r in t instanceof i.default&&(t=t.getEvent()),t.name&&(e.name=t.name),t.priority&&(e.priority=t.priority),t.properties)t.properties.hasOwnProperty(r)&&(e.properties[r]=t.properties[r])},e._getSessionDurationFromTime=function(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"},e._logEvent=function(e,t){e.name&&a.isString(e.name)?(e.name=e.name.toLowerCase(),e.name=e.name.replace(a.EventNameDotRegex,"_"),e.type&&a.isString(e.type)?e.type=e.type.toLowerCase():e.type="custom",a.EventNameAndTypeRegex.test(e.name)&&a.EventNameAndTypeRegex.test(e.type)?((!a.isNumber(e.timestamp)||e.timestamp<0)&&(e.timestamp=(new Date).getTime()),e.properties||(e.properties={}),this._addContextIfAbsent(e,t.getPropertyMap()),this._addContextIfAbsent(e,l.default.logManagerContext.getPropertyMap()),this._setDefaultProperty(e,"EventInfo.InitId",this._getInitId(e.apiKey)),this._setDefaultProperty(e,"EventInfo.Sequence",this._getSequenceId(e.apiKey)),this._setDefaultProperty(e,"EventInfo.SdkVersion",p.FullVersionString),this._setDefaultProperty(e,"EventInfo.Name",e.name),this._setDefaultProperty(e,"EventInfo.Time",new Date(e.timestamp).toISOString()),a.isPriority(e.priority)||(e.priority=n.AWTEventPriority.Normal),this._sendEvent(e)):u.default.eventsRejected([e],n.AWTEventsRejectedReason.InvalidEvent)):u.default.eventsRejected([e],n.AWTEventsRejectedReason.InvalidEvent)},e._addContextIfAbsent=function(e,t){if(t)for(var r in t)t.hasOwnProperty(r)&&(e.properties[r]||(e.properties[r]=t[r]))},e._setDefaultProperty=function(e,t,r){e.properties[t]={value:r,pii:n.AWTPiiKind.NotSet,type:n.AWTPropertyType.String}},e._sendEvent=function(e){c.default.sendEvent(e)},e._getInternalEvent=function(e,t,r){if(e.properties=e.properties||{},r)for(var n in e.properties)e.properties.hasOwnProperty(n)&&(e.properties[n]=a.sanitizeProperty(n,e.properties[n]),null===e.properties[n]&&delete e.properties[n]);var o=e;return o.id=a.newGuid(),o.apiKey=t,o},e._getInitId=function(t){return e._initIdMap[t]},e._getSequenceId=function(t){return void 0===e._sequenceIdMap[t]&&(e._sequenceIdMap[t]=0),(++e._sequenceIdMap[t]).toString()},e._sequenceIdMap={},e._initIdMap={},e}();t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(28),o=r(32),i=r(14),a=function(){function e(){}return e.initialize=function(e){var t=this;this._sendStats=e,this._isInitalized=!0,o.default.addNotificationListener({eventsSent:function(e){t._addStat("records_sent_count",e.length,e[0].apiKey)},eventsDropped:function(e,r){switch(r){case i.AWTEventsDroppedReason.NonRetryableStatus:t._addStat("d_send_fail",e.length,e[0].apiKey),t._addStat("records_dropped_count",e.length,e[0].apiKey);break;case i.AWTEventsDroppedReason.QueueFull:t._addStat("d_queue_full",e.length,e[0].apiKey)}},eventsRejected:function(e,r){switch(r){case i.AWTEventsRejectedReason.InvalidEvent:t._addStat("r_inv",e.length,e[0].apiKey);break;case i.AWTEventsRejectedReason.KillSwitch:t._addStat("r_kl",e.length,e[0].apiKey);break;case i.AWTEventsRejectedReason.SizeLimitExceeded:t._addStat("r_size",e.length,e[0].apiKey)}t._addStat("r_count",e.length,e[0].apiKey)},eventsRetrying:null}),setTimeout((function(){return t.flush()}),6e4)},e.teardown=function(){this._isInitalized&&(this.flush(),this._isInitalized=!1)},e.eventReceived=function(t){e._addStat("records_received_count",1,t)},e.flush=function(){var e=this;if(this._isInitalized){for(var t in this._stats)this._stats.hasOwnProperty(t)&&this._sendStats(this._stats[t],t);this._stats={},setTimeout((function(){return e.flush()}),6e4)}},e._addStat=function(e,t,r){if(this._isInitalized&&r!==n.StatsApiKey){var o=n.getTenantId(r);this._stats[o]||(this._stats[o]={}),this._stats[o][e]?this._stats[o][e]=this._stats[o][e]+t:this._stats[o][e]=t}},e._isInitalized=!1,e._stats={},e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(259),o=r(14),i=r(32),a=r(28),s=function(){function e(){}return e.getPayloadBlob=function(e,t){var r,s=new n.IO.MemoryStream,u=new n.CompactBinaryProtocolWriter(s);for(var c in u._WriteFieldBegin(n._BondDataType._BT_MAP,3,null),u._WriteMapContainerBegin(t,n._BondDataType._BT_STRING,n._BondDataType._BT_LIST),e)if(e.hasOwnProperty(c)){u._WriteString(c);var l=e[c];u._WriteContainerBegin(1,n._BondDataType._BT_STRUCT),u._WriteFieldBegin(n._BondDataType._BT_STRING,2,null),u._WriteString("act_default_source"),u._WriteFieldBegin(n._BondDataType._BT_STRING,5,null),u._WriteString(a.newGuid()),u._WriteFieldBegin(n._BondDataType._BT_INT64,6,null),u._WriteInt64(a.numberToBondInt64(Date.now())),u._WriteFieldBegin(n._BondDataType._BT_LIST,8,null);var p=s._GetBuffer().length+1;u._WriteContainerBegin(e[c].length,n._BondDataType._BT_STRUCT);for(var d=s._GetBuffer().length-p,f=0;f<l.length;++f){var h=s._GetBuffer().length;if(this.writeEvent(l[f],u),s._GetBuffer().length-h>2936012)i.default.eventsRejected([l[f]],o.AWTEventsRejectedReason.SizeLimitExceeded),l.splice(f--,1),s._GetBuffer().splice(h),this._addNewDataPackageSize(l.length,s,d,p);else if(s._GetBuffer().length>2936012){s._GetBuffer().splice(h),r||(r={}),e[c]=l.splice(0,f),r[c]=l,this._addNewDataPackageSize(e[c].length,s,d,p);break}}u._WriteStructEnd(!1)}return u._WriteStructEnd(!1),{payloadBlob:s._GetBuffer(),remainingRequest:r}},e._addNewDataPackageSize=function(e,t,r,o){for(var i=n._Encoding._Varint_GetBytes(n.Number._ToUInt32(e)),a=0;a<r;++a){if(!(a<i.length)){t._GetBuffer().slice(o+a,r-a);break}t._GetBuffer()[o+a]=i[a]}},e.writeEvent=function(e,t){t._WriteFieldBegin(n._BondDataType._BT_STRING,1,null),t._WriteString(e.id),t._WriteFieldBegin(n._BondDataType._BT_INT64,3,null),t._WriteInt64(a.numberToBondInt64(e.timestamp)),t._WriteFieldBegin(n._BondDataType._BT_STRING,5,null),t._WriteString(e.type),t._WriteFieldBegin(n._BondDataType._BT_STRING,6,null),t._WriteString(e.name);var r={},i=0,s={},u=0,c={},l=0,p={},d=0,f={},h=0,_={},m=0,v={},g=0;for(var E in e.properties){if(e.properties.hasOwnProperty(E))if((C=e.properties[E]).cc>0)v[E]=C,g++;else if(C.pii>0)_[E]=C,m++;else switch(C.type){case o.AWTPropertyType.String:r[E]=C.value,i++;break;case o.AWTPropertyType.Int64:s[E]=C.value,u++;break;case o.AWTPropertyType.Double:c[E]=C.value,l++;break;case o.AWTPropertyType.Boolean:p[E]=C.value,d++;break;case o.AWTPropertyType.Date:f[E]=C.value,h++}}if(i)for(var E in t._WriteFieldBegin(n._BondDataType._BT_MAP,13,null),t._WriteMapContainerBegin(i,n._BondDataType._BT_STRING,n._BondDataType._BT_STRING),r)if(r.hasOwnProperty(E)){var y=r[E];t._WriteString(E),t._WriteString(y.toString())}if(m)for(var E in t._WriteFieldBegin(n._BondDataType._BT_MAP,30,null),t._WriteMapContainerBegin(m,n._BondDataType._BT_STRING,n._BondDataType._BT_STRUCT),_)if(_.hasOwnProperty(E)){var C=_[E];t._WriteString(E),t._WriteFieldBegin(n._BondDataType._BT_INT32,1,null),t._WriteInt32(1),t._WriteFieldBegin(n._BondDataType._BT_INT32,2,null),t._WriteInt32(C.pii),t._WriteFieldBegin(n._BondDataType._BT_STRING,3,null),t._WriteString(C.value.toString()),t._WriteStructEnd(!1)}if(d)for(var E in t._WriteFieldBegin(n._BondDataType._BT_MAP,31,null),t._WriteMapContainerBegin(d,n._BondDataType._BT_STRING,n._BondDataType._BT_BOOL),p)if(p.hasOwnProperty(E)){y=p[E];t._WriteString(E),t._WriteBool(y)}if(h)for(var E in t._WriteFieldBegin(n._BondDataType._BT_MAP,32,null),t._WriteMapContainerBegin(h,n._BondDataType._BT_STRING,n._BondDataType._BT_INT64),f)if(f.hasOwnProperty(E)){y=f[E];t._WriteString(E),t._WriteInt64(a.numberToBondInt64(y))}if(u)for(var E in t._WriteFieldBegin(n._BondDataType._BT_MAP,33,null),t._WriteMapContainerBegin(u,n._BondDataType._BT_STRING,n._BondDataType._BT_INT64),s)if(s.hasOwnProperty(E)){y=s[E];t._WriteString(E),t._WriteInt64(a.numberToBondInt64(y))}if(l)for(var E in t._WriteFieldBegin(n._BondDataType._BT_MAP,34,null),t._WriteMapContainerBegin(l,n._BondDataType._BT_STRING,n._BondDataType._BT_DOUBLE),c)if(c.hasOwnProperty(E)){y=c[E];t._WriteString(E),t._WriteDouble(y)}if(g)for(var E in t._WriteFieldBegin(n._BondDataType._BT_MAP,36,null),t._WriteMapContainerBegin(g,n._BondDataType._BT_STRING,n._BondDataType._BT_STRUCT),v)if(v.hasOwnProperty(E)){C=v[E];t._WriteString(E),t._WriteFieldBegin(n._BondDataType._BT_INT32,1,null),t._WriteInt32(C.cc),t._WriteFieldBegin(n._BondDataType._BT_STRING,2,null),t._WriteString(C.value.toString()),t._WriteStructEnd(!1)}t._WriteStructEnd(!1)},e.base64Encode=function(e){return n._Encoding._Base64_GetString(e)},e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Version="1.8.1",t.FullVersionString="AWT-Web-JS-"+t.Version},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(14),o=r(45),i=r(108),a=r(103),s=r(36),u=r(32),c=r(68),l=function(){function e(){}return e.initialize=function(e,t){if(void 0===t&&(t={}),!this._isInitialized)return this._isInitialized=!0,i.default.defaultTenantToken=e,this._overrideValuesFromConfig(t),this._config.disableCookiesUsage&&!this._config.propertyStorageOverride&&(i.default.sessionEnabled=!1),c.default.addPropertyStorageOverride(this._config.propertyStorageOverride),c.default.autoCollect(i.default.semanticContext,this._config.disableCookiesUsage,this._config.userAgent),s.default.initialize(this._config),i.default.loggingEnabled=!0,this._config.enableAutoUserSession&&(this.getLogger().logSession(o.AWTSessionState.Started),window.addEventListener("beforeunload",this.flushAndTeardown)),this.getLogger()},e.getSemanticContext=function(){return i.default.semanticContext},e.flush=function(e){this._isInitialized&&!this._isDestroyed&&s.default.flush(e)},e.flushAndTeardown=function(){this._isInitialized&&!this._isDestroyed&&(this._config.enableAutoUserSession&&this.getLogger().logSession(o.AWTSessionState.Ended),s.default.flushAndTeardown(),i.default.loggingEnabled=!1,this._isDestroyed=!0)},e.pauseTransmission=function(){this._isInitialized&&!this._isDestroyed&&s.default.pauseTransmission()},e.resumeTransmision=function(){this._isInitialized&&!this._isDestroyed&&s.default.resumeTransmision()},e.setTransmitProfile=function(e){this._isInitialized&&!this._isDestroyed&&s.default.setTransmitProfile(e)},e.loadTransmitProfiles=function(e){this._isInitialized&&!this._isDestroyed&&s.default.loadTransmitProfiles(e)},e.setContext=function(e,t,r){void 0===r&&(r=n.AWTPropertyType.Unspecified),i.default.logManagerContext.setProperty(e,t,r)},e.setContextWithPii=function(e,t,r,o){void 0===o&&(o=n.AWTPropertyType.Unspecified),i.default.logManagerContext.setPropertyWithPii(e,t,r,o)},e.setContextWithCustomerContent=function(e,t,r,o){void 0===o&&(o=n.AWTPropertyType.Unspecified),i.default.logManagerContext.setPropertyWithCustomerContent(e,t,r,o)},e.getLogger=function(e){var t=e;return t&&t!==i.default.defaultTenantToken||(t=""),this._loggers[t]||(this._loggers[t]=new a.default(t)),this._loggers[t]},e.addNotificationListener=function(e){u.default.addNotificationListener(e)},e.removeNotificationListener=function(e){u.default.removeNotificationListener(e)},e._overrideValuesFromConfig=function(e){e.collectorUri&&(this._config.collectorUri=e.collectorUri),e.cacheMemorySizeLimitInNumberOfEvents>0&&(this._config.cacheMemorySizeLimitInNumberOfEvents=e.cacheMemorySizeLimitInNumberOfEvents),e.httpXHROverride&&e.httpXHROverride.sendPOST&&(this._config.httpXHROverride=e.httpXHROverride),e.propertyStorageOverride&&e.propertyStorageOverride.getProperty&&e.propertyStorageOverride.setProperty&&(this._config.propertyStorageOverride=e.propertyStorageOverride),e.userAgent&&(this._config.userAgent=e.userAgent),e.disableCookiesUsage&&(this._config.disableCookiesUsage=e.disableCookiesUsage),e.canSendStatEvent&&(this._config.canSendStatEvent=e.canSendStatEvent),e.enableAutoUserSession&&"undefined"!=typeof window&&window.addEventListener&&(this._config.enableAutoUserSession=e.enableAutoUserSession),e.clockSkewRefreshDurationInMins>0&&(this._config.clockSkewRefreshDurationInMins=e.clockSkewRefreshDurationInMins)},e._loggers={},e._isInitialized=!1,e._isDestroyed=!1,e._config={collectorUri:"https://browser.pipe.aria.microsoft.com/Collector/3.0/",cacheMemorySizeLimitInNumberOfEvents:1e4,disableCookiesUsage:!1,canSendStatEvent:function(e){return!0},clockSkewRefreshDurationInMins:0},e}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(46),o=r(67),i=function(){function e(){}return e.logManagerContext=new n.default,e.sessionEnabled=!0,e.loggingEnabled=!1,e.defaultTenantToken="",e.semanticContext=new o.default(!0,e.logManagerContext),e}();t.default=i},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Passed=0]="Passed",e[e.Failed=1]="Failed",e[e.Unknown=2]="Unknown"}(r||(r={})),t.DiagCheckState=r,function(e){e[e.Present=0]="Present",e[e.Missing=1]="Missing",e[e.Unknown=2]="Unknown"}(n||(n={})),t.PrivilegeStatus=n}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(111),r(241)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.default(n.default())}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(112),r(2),r(6),r(1),r(239),r(240),r(30)],void 0===(o=function(e,t,r,n,o,i,a,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e){this._client=e}return e.prototype._initialize=function(e){return new r.default(e,this._bcd).boot()},e.prototype.boot=function(){var e=this;this._bcd=new a.default(n.default.getQueryParams());var t=this._client.initialize(this._bcd);this._initialize(t).then((function(){t.EventManager.ReportComponentSuccess("Boot.FullLoad"),e._client.renderUI().then((function(){new s.default(t,e._bcd).checkForAppPinningNotification()}))})).catch((function(e){if(i.ComponentError.isNativeError(e)&&(e=i.ComponentError.fromNativeError("BootGenericError",i.ErrorCode.GENERIC,e)),e.code===i.ErrorCode.CRM_USER_MISSING_PRIVILEGE){var r=o.default.parseMissingPrivilegeFromErrorMessage(e.message);e=u.default.createFromComponentError(e,[r])}t.UIManager.showErrorMessage(e)})),t.AppChecker.initialize()},e}();t.default=function(e){new c(e).boot()}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(113),r(117),r(0),r(12),r(74),r(120),r(132),r(134),r(211),r(227),r(9),r(231),r(232),r(233),r(234),r(235),r(236),r(238)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c,l,p,d,f,h,_,m,v,g,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(){function e(e,t){var r=this;this._loadResourcesAndThrow=function(e){var t=Promise.reject(e);if(!r._applicationContext.ComponentsLoader||!r._applicationContext.ComponentsLoader.isComponentLoaded(o.default.RESOURCE_MANAGER)){var n=r._applicationContext.ResourceManager;return n.boot(null),n.loadingPromise.then((function(){return t}))}return t},this._bcd=t,this._applicationContext=e,this._componentsLoader=new g.ComponentsLoader(this._bcd,this._applicationContext)}return e.prototype._onComponentLoaded=function(e,t){this._progressMessageResId||(this._progressMessageResId="MoCA_OWA_Assets_Loading_Message"),e.name===o.default.AUTHENTICATION_PROVIDER?this._progressMessageResId="MoCA_OWA_Authentication_Loading_Message":("MoCA_OWA_Authentication_Loading_Message"!==this._progressMessageResId||t.find((function(e){return e.name===o.default.AUTHENTICATION_PROVIDER})))&&(e.name===o.default.UNIFIED_CLIENT_LOADER?this._progressMessageResId="MoCA_OWA_Client_Assets_Loading_Message":"MoCA_OWA_Client_Assets_Loading_Message"===this._progressMessageResId&&t.find((function(e){return e.name===o.default.UNIFIED_CLIENT_LOADER}))),this._applicationContext.UIManager.showProgressMsg(this._progressMessageResId)},e.prototype.boot=function(){this._componentsLoader.addOnComponentLoaded(this._onComponentLoaded.bind(this)),this._componentsLoader.addDefinition({bootable:f.default(),name:o.default.STORAGE_VALIDATOR,dependsOnComponents:[]}),this._componentsLoader.addDefinition({bootable:v.default(),name:o.default.VALIDATE_OFFICEJS,dependsOnComponents:[o.default.STORAGE_VALIDATOR]}),this._componentsLoader.addDefinition({bootable:p.default(),name:o.default.JS_API_PROVIDER,dependsOnComponents:[o.default.VALIDATE_OFFICEJS]}),this._componentsLoader.addDefinition({bootable:a.bootableResourceManager(),name:o.default.RESOURCE_MANAGER,dependsOnComponents:[]}),this._componentsLoader.addDefinition({bootable:h.default(),name:o.default.COMPATIBILITY_CHECK,dependsOnComponents:[o.default.JS_API_PROVIDER]}),this._componentsLoader.addDefinition({bootable:r.default(),name:o.default.AUTHENTICATION_PROVIDER,dependsOnComponents:[o.default.JS_API_PROVIDER]}),this._componentsLoader.addDefinition({bootable:s.default(),name:o.default.CRM_PROVIDER,dependsOnComponents:[o.default.JS_API_PROVIDER,o.default.AUTHENTICATION_PROVIDER]}),this._componentsLoader.addDefinition({bootable:l.default(),name:o.default.EXCHANGE_PROVIDER,dependsOnComponents:[o.default.CRM_PROVIDER]}),this._componentsLoader.addDefinition({bootable:c.default(),name:o.default.DISPATCHER_COLLECTION,dependsOnComponents:[o.default.JS_API_PROVIDER]}),this._componentsLoader.addDefinition({bootable:_.default(),name:o.default.VALIDATE_USER,dependsOnComponents:[o.default.CRM_PROVIDER,o.default.AUTHENTICATION_PROVIDER]}),this._componentsLoader.addDefinition({bootable:m.default(),name:o.default.DELEGATE_VALIDATOR,dependsOnComponents:[o.default.CRM_PROVIDER,o.default.JS_API_PROVIDER]});var e=this._applicationContext.Storage.getItem(d.default.appModuleIdsCache);return this._componentsLoader.addDefinition({bootable:u.default(),name:o.default.UNIFIED_CLIENT_LOADER,dependsOnComponents:this._bcd.mode!==i.default.Module&&e?[]:[o.default.CRM_PROVIDER,o.default.AUTHENTICATION_PROVIDER]}),this._componentsLoader.addDefinition({bootable:n.default(),name:o.default.WEB_SCRIPT_BRIDGE,dependsOnComponents:[o.default.UNIFIED_CLIENT_LOADER,o.default.DISPATCHER_COLLECTION]}),this._componentsLoader.addDefinition({bootable:E.default(),name:o.default.LOAD_TIMEOUT,dependsOnComponents:[o.default.UNIFIED_CLIENT_LOADER,o.default.DISPATCHER_COLLECTION,o.default.AUTHENTICATION_PROVIDER]}),this._applicationContext.ComponentsLoader=this._componentsLoader,this._componentsLoader.load(),this._componentsLoader.loadingPromise.catch(this._loadResourcesAndThrow)},e}();t.default=y}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(29),r(1),r(6),r(115),r(116)],void 0===(o=function(e,t,r,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){if(this._applicationContext=t,this._authMethod=e.useAuthMethod,null==this._authMethod||this._authMethod===n.default.Default)this._authenticationManager=new s.default(e,t);else switch(this._authMethod){case n.default.Cookie:this._authenticationManager=new a.default(e,t);break;case n.default.WIA:this._authenticationManager=null}this._authMethod===n.default.WIA||this._authenticationManager.initialize()||this._authenticationManager.updateAuthenticationCache(t.JsApiProvider.getUserEmailAddress())}return e.prototype._reportExpiry=function(){var e=new Date(this._authTokenExpiry).toUTCString();this._applicationContext.EventManager.ReportTraceInfo(r.default.AUTHENTICATION_PROVIDER+".TokenExpiry","Token expiration",e)},e.prototype.authenticateClient=function(e){var t=this;return this.authenticate(e).then((function(e){return"<RequestOAuthSecurityTokenResponse><AccessToken>"+e+"</AccessToken><EncodedAccessToken>"+e+"</EncodedAccessToken><ExpiresOn>"+t._authTokenExpiry+"</ExpiresOn></RequestOAuthSecurityTokenResponse>"}))},e.prototype.authenticate=function(e){var t=this;return void 0===e&&(e=!0),this._authMethod===n.default.WIA?Promise.resolve(null):this._authenticationManager.authenticate(e).then((function(e){var r=i.default.parseToken(e);return t._authTokenExpiry=1e3*r.exp,t._authToken=e,t._reportExpiry(),e}),(function(e){var t,n,i,a,s=o.ErrorCode.isKnownOfficeSaveAsyncErrorCode(null===(n=null===(t=e)||void 0===t?void 0:t.innerError)||void 0===n?void 0:n.code)?null===(a=null===(i=e)||void 0===i?void 0:i.innerError)||void 0===a?void 0:a.code:o.ErrorCode.AUTH_FAILED;return Promise.reject(new o.ComponentError(r.default.AUTHENTICATION_PROVIDER,"Failed to authenticate user",s,e))}))},e.prototype.getToken=function(){return this._authToken&&this._authTokenExpiry-Date.now()>3e4?this._authToken:null},e}();t.AuthenticationProvider=u,t.default=function(){return function(e,t){return t.AuthenticationProvider=new u(e,t),t.AuthenticationProvider.authenticate(!1)}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o=this&&this.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n};void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.document=function(){return this._window.document},e.screen=function(){return this._window.screen},e.navigator=function(){return this._window.navigator},e.URL=function(){return this._window.URL},e.localStorage=function(){return this._window.localStorage},e.sessionStorage=function(){return this._window.sessionStorage},e.console=function(){return this._window.console?this._window.console:{assert:function(){},error:function(){},exception:function(){},info:function(){},log:function(){},trace:function(){},warn:function(){}}},e.location=function(){return this._window.location},e.atob=function(e){if(this._window.atob)return this._window.atob(e);throw new Error("window.atob undefined")},e.btoa=function(e){if(this._window.btoa)return this._window.btoa(e);throw new Error("window.btoa undefined")},e.crypto=function(){return this._window.crypto||this._window.msCrypto},e.performance=function(){if(this._window.performance)return this._window.performance;throw new Error("window.performance is undefined")},e.Office=function(){return this._window.Office},e.PageLoadStartTime=function(){return this._window.PageLoadStartTime},e.LibrariesLoadStartTime=function(){return this._window.LibrariesLoadStartTime},e.LibrariesLoadEndTime=function(){return this._window.LibrariesLoadEndTime},e.ShimJsLoadEndTime=function(){return this._window.ShimJsLoadEndTime},e.open=function(e,t,r){if(this._window.open)return this._window.open(e,t,r);throw new Error("window.open undefined")},e.setTimeout=function(e,t){for(var r,n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(this._window.setTimeout)return(r=this._window).setTimeout.apply(r,o([e,t],n));throw new Error("window.setTimeout undefined")},e.setInterval=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];if(this._window.setInterval)return this._window.setInterval(e,t,r);throw new Error("window.setInterval undefined")},e.clearInterval=function(e){if(this._window.clearInterval)return this._window.clearInterval(e);throw new Error("window.clearInterval is undefined")},e.clearTimeout=function(e){if(!this._window.clearTimeout)throw new Error("window.clearTimeout undefined");this._window.clearTimeout(e)},e.postMessage=function(e,t,r){if(!this._window.postMessage)throw new Error("window.postMessage undefined");this._window.postMessage(e,t,r)},e.self=function(){return this._window},e.top=function(){return this._window.top},e.appResource=function(e){if(this._window.RESOURCES)return this._window.RESOURCES[e]},e.appVersion=function(){return this._window.CRM_VERSION_NUMERIC_VALUE},e.shimVersion=function(){return this._window.SHIM_VERSION_NUMERIC_VALUE},e.onError=function(e){this._window.onerror=e},e.addEventListener=function(e,t,r){if(!this._window.addEventListener)throw new Error("window.addEventListener undefined");this._window.addEventListener(e,t,r)},e.removeEventListener=function(e,t){if(!this._window.removeEventListener)throw new Error("window.removeEventListener undefined");this._window.removeEventListener(e,t)},e.dispatchEvent=function(e){if(this._window.dispatchEvent)return this._window.dispatchEvent(e);throw new Error("window.dispatchEvent undefined")},e.adalLoginCallback=function(e){this._window.adalLoginCallback=e},e.adfsLoginCallback=function(e){this._window.adfsLoginCallback=e},e.authLoginCallback=function(e){this._window.authLoginCallback=e},e.authenticatedPageLoaded=function(e){this._window.authenticatedPageLoaded=e},e.AuthenticationContext=function(e){return this._window.AuthenticationContext?new this._window.AuthenticationContext(e):null},e.isOnline=function(){return this._window.navigator.onLine},e._window=window,e}();t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(33),r(2)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this._appContext=t,this._bcd=e}return e.prototype.initialize=function(){return!1},e.prototype.authenticate=function(e){var t=this;if(!this._bcd.secondaryLoad){var n=this._appContext.OrgUrl+"/crmmailapp/authcheck.aspx";r.default.SendRequest({method:"GET",url:n}).then((function(e){e.responseURL()!==n&&t._backUpAuthPlan()}),(function(e){t._backUpAuthPlan()}))}return Promise.resolve(null)},e.prototype._backUpAuthPlan=function(){var e=this._appContext.OrgUrl+"/crmmailapp/auth.aspx";if(n.default.self()!==n.default.top())n.default.authLoginCallback((function(){n.default.location().search+="&secondaryLoad=1"})),n.default.open(e);else{var t=n.default.location().pathname;e+="?MailAppRedirect="+encodeURIComponent(t.substring(t.lastIndexOf("/")+1))+n.default.location().search+"&secondaryLoad=1",n.default.location().href=e}},e.prototype.updateAuthenticationCache=function(e){},e}();t.default=o}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(9),r(0),r(6),r(33),r(2),r(1),r(21),r(37)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=n.default.AUTHENTICATION_PROVIDER+".OnPremise",p=function(){function e(e,t){this._timeOutValue=1e4,this._bcd=e,this._externalDomain=e.externalDomain,this._applicationContext=t,this._redirectUri=this._applicationContext.OrgUrl+"/crmmailapp/code_auth.aspx",this._oAuthDiscoveryEndpoint=this._applicationContext.OrgUrl+"/XRMServices/2011/Organization.svc/web?SdkClientVersion=7.0.0000"}return e.prototype.initialize=function(){var e=this._applicationContext.Storage.getItemExpiry(r.default.tokenOnPrem);return(!e||e<Date.now()+3e5)&&this._clearCache(),!1},e.prototype._clearCache=function(){this._applicationContext.EventManager.ReportTraceInfo(l,"Clear authentication cache"),this._applicationContext.Storage.removeItem(r.default.tokenOnPrem)},e.prototype.authenticate=function(e){return this._retrieveToken(e)},e.prototype._discoverEndpointAndResource=function(){var e=this;return i.default.SendRequest({method:"GET",url:this._oAuthDiscoveryEndpoint,headers:[new i.default.KeyValue("Authorization","Bearer")],isSuccessFn:function(e){return e===c.default.Unauthorized}}).then((function(e){var t,r,n=e.header("WWW-Authenticate");if(n){if(0===(n=n.toLowerCase()).indexOf("bearer"))for(var o=(n=n.slice(6)).split(","),i=0;i<o.length&&(!t||!r);i++){var a=o[i].trim();if(-1!==a.indexOf("authorization_uri")){var u=a.split("=");u.length>1&&(r=u[1])}else if(-1!==a.indexOf("resource_id")){var c=a.split("=");c.length>1&&(t=c[1])}}if(!r||!t)return Promise.reject(new s.ComponentError(l+".Discovery","oAuth discovery response doesn't contain valid data in auth header",s.ErrorCode.AUTH_FAILED))}return Promise.resolve([r,t])}),(function(t){var r=t.getComponentError(l+".Discovery");return e._applicationContext.EventManager.ReportComponentFailure(r),Promise.reject(r)}))},e.prototype._retrieveToken=function(e){var t=this,n=this._applicationContext.Storage.getItem(r.default.tokenOnPrem);return n&&!e?Promise.resolve(n):(this._tokenPromise||(this._tokenPromise=new Promise((function(n,i){t._tokenPromiseResolve=function(e){var i=o.default.parseToken(e);t._applicationContext.Storage.setItem(r.default.tokenOnPrem,e,1e3*i.exp),n(e),t._tokenPromise=null},t._tokenPromiseReject=function(e){var r=new s.ComponentError(l,"Error occurred while performing authentication",s.ErrorCode.AUTH_FAILED,u.ensureComponentErrorObject(e));t._applicationContext.EventManager.ReportComponentFailure(r),i(r),t._tokenPromise=null},t._retrieveTokenInternal(e)}))),this._tokenPromise)},e.prototype._onDiscoverEndpoint=function(e){var t=this,n=e[0],i=e[1]||this._applicationContext.OrgUrl,u=o.default.generateKey(),c=function(e){var r=e;u===r.state_key?t._tokenPromiseResolve(r.access_token):t._tokenPromiseReject(new s.ComponentError(l+".RetrieveToken","State Key mismatch",s.ErrorCode.AUTH_FAILED))};a.default.adfsLoginCallback(c);var p=n+"?client_id="+this._bcd.orgId+"&redirect_uri="+this._redirectUri+"&resource="+i+"&response_type=code&state="+n+"?client_id="+this._bcd.orgId+"-"+u,d=n.substring(0,n.lastIndexOf("/adfs"))+"/adfs/ls/?wa=wsignout1.0",f=this._applicationContext.OrgUrl+"/crmmailapp/out.html";a.default.localStorage().setItem(r.default.onPremSignInUrl,p),a.default.localStorage().setItem(r.default.onPremSignOutUrl,d),this._applicationContext.JsApiProvider.openLoginDialog(f,{signIn:p,signOut:d}).then(c.bind(this)).catch(this._tokenPromiseReject)},e.prototype._retrieveTokenInternal=function(e){this._applicationContext.EventManager.ReportTraceInfo(l+".RetrieveToken","Sign out requested"),this._discoverEndpointAndResource().then(this._onDiscoverEndpoint.bind(this)).catch(this._tokenPromiseReject.bind(this))},e.prototype.updateAuthenticationCache=function(e){e&&(e!==this._applicationContext.Storage.getItem(r.default.principalEmail)&&(this._applicationContext.EventManager.ReportTraceInfo(l,"New user has signed in. Clearing cache"),this._clearCache(),this._applicationContext.Storage.setItem(r.default.principalEmail,e)))},e}();t.default=p}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(118),r(119),r(0),r(6),r(1),r(4)],void 0===(o=function(e,t,r,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=o.default.WEB_SCRIPT_BRIDGE+".CallMethodWithKey",c=function(){function e(e,t){this._conversationKey=i.default.generateKey(),this._applicationContext=t}return e.prototype.unload=function(){for(var e in this._applicationContext.DispatcherCollection){var t=this._applicationContext.DispatcherCollection[e];t&&t.unload()}this._inputHandler.unload()},e.prototype.callMethodWithKey=function(e,t,r,n,o,i){var c=this._applicationContext.DispatcherCollection[t],l=[{name:s.EventParameterName.Data,value:t}];if(!c)return this._applicationContext.EventManager.ReportComponentFailure(new a.ComponentError(u,"Unknown dispatcher namespace",a.ErrorCode.GENERIC),l);if(e!==this._conversationKey){var p={key:this._conversationKey,callKey:e};return l.push({name:s.EventParameterName.Data,value:p}),this._applicationContext.EventManager.ReportComponentFailure(new a.ComponentError(u,"Attemptng to call native method with invalid key. Possible XSS?",a.ErrorCode.GENERIC),l)}c.callMethodWithName(r,{version:n,args:o,callbacks:i})},e.prototype.performCallbackWithId=function(e,t,r,n){void 0===n&&(n=!1),this._outputHandler.deviceCallbackWithId(e,t,r,n)},e.prototype.unregisterCallbackWithId=function(e){this._outputHandler.deviceUnregisterCallbackWithId(e)},e.prototype.changeStateForDispatcher=function(e,t,r,n){void 0===n&&(n=!1),this._outputHandler.deviceEventWithNamespace(e,t,r,n)},e.prototype._getDispatcherStatesAndRegisterMethods=function(){var e=this,t={};return Object.keys(this._applicationContext.DispatcherCollection).forEach((function(r){var n=e._applicationContext.DispatcherCollection[r];if(n){n.registerMethods();var o=n.getInitialState();t[n.getNamespace()]=o}})),t},e.prototype.deviceEventWithNamespace=function(e,t,r){this._outputHandler.deviceEventWithNamespace(e,t,r)},e.prototype.load=function(){this._inputHandler=new r.default(this._bcd,this._applicationContext),this._outputHandler=new n.default(this._bcd,this._applicationContext),this._states=this._getDispatcherStatesAndRegisterMethods(),this._outputHandler.deviceReadyWithKey(this._conversationKey,this._states)},e}();t.WebScriptBridge=c,t.default=function(){return function(e,t){var r=new c(e,t);return t.Bridge=r,r.load()}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(4),r(1),r(2),r(7)],void 0===(o=function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.default.WEB_SCRIPT_BRIDGE+".InputHandler",u=function(){function e(e,t){this._bcd=e,this._applicationContext=t,this._boundMessageHandler=this._messageHandler.bind(this),i.default.addEventListener("message",this._boundMessageHandler,!1)}return e.prototype._messageHandler=function(e){var t=i.default.location().protocol+"//"+i.default.location().host;if(e.data&&(e.origin===t||e.origin+"/"===t)){var r=this._getQueryParameters(e.data);if(r){var u=r.k&&decodeURIComponent(r.k),c=r.n&&decodeURIComponent(r.n),l=r.m&&decodeURIComponent(r.m),p=r.v&&decodeURIComponent(r.v),d=r.t&&decodeURIComponent(r.t),f=r.a&&decodeURIComponent(r.a),h=r.c&&decodeURIComponent(r.c),_=d?parseInt(d,10):null,m=null,v=null;try{m=JSON.parse(f),v=JSON.parse(h)}catch(t){var g=[{name:n.ErrorEventParameterName.Error,value:t.message},{name:n.ErrorEventParameterName.ErrorCode,value:o.ErrorCode.JSON_PARSE_FAILURE},{name:n.EventParameterName.Data,value:e.data}];return void this._applicationContext.EventManager.ReportComponentFailure(new o.ComponentError(s,"Failed to parse JSON of arguments received from the client",o.ErrorCode.GENERIC),g)}if(u&&c&&l&&m&&p&&v){_&&!isNaN(_)&&this._applicationContext.Performance.addRetroactiveStopwatch("PostMessage."+c+"."+l,_,Date.now()),c===a.default.EXTERNAL_CONTEXT||c===a.default.CONTACTS_MODULE&&"SendTelemetryEvents"===l||this._applicationContext.EventManager.ReportTraceInfo(s+".CallMethod",c+"."+l),this._applicationContext.Bridge.callMethodWithKey(u,c,l,p,m,v)}else{var E={key:u,nameSpace:c,method:l,version:p,callbacks:v};this._applicationContext.EventManager.ReportComponentFailure(new o.ComponentError(s,"Invalid arguments received from the client",o.ErrorCode.GENERIC),[{name:n.EventParameterName.Data,value:E}])}}}},e.prototype._getQueryParameters=function(e){void 0===e&&(e="");var t=e.indexOf("?");if(-1===t)return null;for(var r={},n=e.slice(t+1).split("&"),o=0,i=n.length;o<i;o++){var a=n[o],s=a.indexOf("=",0);r[a.substring(0,s)]=a.substring(s+1)}return r},e.prototype.unload=function(){i.default.removeEventListener("message",this._boundMessageHandler),this._boundMessageHandler=null},e}();t.default=u}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(48),r(2),r(1),r(7)],void 0===(o=function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.default.WEB_SCRIPT_BRIDGE+".OutputHandler",u=function(){function e(e,t){this._bcd=e,this._applicationContext=t}return e.prototype.deviceReadyWithKey=function(e,t){this._callNativeBridgeFunction("deviceReady",{nativeArguments:[e,JSON.stringify(t)]}),this._reportTelemetry("DeviceReadyWithKey","Shim ready with key")},e.prototype.deviceCallbackWithId=function(e,t,r,n){this._callNativeBridgeFunction("deviceCallback",{nativeArguments:[e,JSON.stringify(t),r]}),n||this._reportTelemetry("DeviceCallback","CallbackId: "+e+" ("+r+")")},e.prototype.deviceUnregisterCallbackWithId=function(e){this._callNativeBridgeFunction("deviceUnregisterCallback",{nativeArguments:[e]}),this._reportTelemetry("DeviceUnregisterCallback","CallbackId: "+e)},e.prototype.deviceEventWithNamespace=function(e,t,r,n){var o=this,i=this._applicationContext.DispatcherCollection[a.default.APPLICATION];if(i.isClientInitialized)return this._deviceEventWithNamespaceInternal(e,t,r,n);i.clientInitialized.then((function(){o._deviceEventWithNamespaceInternal(e,t,r,n)})).catch((function(){}))},e.prototype._deviceEventWithNamespaceInternal=function(e,t,r,n){this._callNativeBridgeFunction("deviceEvent",{nativeArguments:[e,t,JSON.stringify([r])]}),n||this._reportTelemetry("DeviceEvent",e+"."+t)},e.prototype._callNativeBridgeFunction=function(e,t){var r={target:"PALNativeBridge",functionName:e,functionArguments:t&&t.nativeArguments,timestamp:Date.now()},a=JSON.stringify(r),u=o.default.document().getElementById(n.IFRAME_ID);u&&u.contentWindow?u.contentWindow.postMessage(a,this._applicationContext.OrgUrl):this._applicationContext.EventManager.ReportComponentFailure(new i.ComponentError(s,"Attempting to communicate with non-existent iframe",i.ErrorCode.GENERIC))},e.prototype._reportTelemetry=function(e,t){void 0===t&&(t=""),this._applicationContext.EventManager.ReportTraceInfo(s+"."+e,t)},e}();t.default=u}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};n=[r,t,r(0),r(75),r(17),r(12),r(49),r(1),r(30),r(4),r(2),r(11),r(25),r(7),r(9),r(122),r(77),r(125),r(129),r(130),r(131),r(37),r(6)],void 0===(o=function(e,t,r,n,o,s,u,c,l,p,d,f,h,_,m,v,g,E,y,C,I,P,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var A=function(){function e(e,t){this._bcd=e,this._applicationContext=t,this._emailAddressesResolver=new E.default(this._bcd,this._applicationContext),this._crmHttpRequest=new g.default(this._bcd,t),this._mailAppDataService=new I.default(e,t),this._scheduleBackgroundDataRefresh()}return e.prototype.getAppId=function(){var e=this,t=this._createOdataEqualsCriteria("uniquename",f.MailAppModuleUniqueName),r=this._getOdataUri()+"/appmodules?$filter="+t+"&$select=uniquename,appmoduleid";return this._crmHttpRequest.send(n.default.GET_APP_ID,{method:"GET",url:r}).then((function(t){var r=t&&t.value?t.value[0]:null;if(r&&r.appmoduleid){var o=r.appmoduleid;return e._applicationContext.Storage.setItem(m.default.appModuleIdsCache,o),o}var i=new c.ComponentError(n.default.GET_APP_ID,"Don't have permissions to retrieve AppforOutlookModule id",c.ErrorCode.CRM_APP_MODULE_PERMISSION);return e._applicationContext.EventManager.ReportComponentFailure(i,[{name:p.ErrorEventParameterName.Error,value:t}]),Promise.reject(i)}))},e.prototype.isLimitedMode=function(){var e=this;return this.isFeatureControlBitEnabled(f.FcbNames.MailAppLimitedMode).then((function(t){return t&&e.getUserValidation()})).then((function(){return!1})).catch(u.isAllowedForLimitedMode)},e.prototype.getOrgSettings=function(){var e=this._applicationContext.Storage.getItem(m.default.orgSettingsCache);return e?Promise.resolve(e):(this._orgSettingsPromise||(this._orgSettingsPromise=this._getOrgSettingsFromServer()),this._orgSettingsPromise)},e.prototype._getOrgSettingsFromServer=function(){return i(this,void 0,void 0,(function(){var e,t,r=this;return a(this,(function(o){switch(o.label){case 0:return[4,this._getOrganizationId()];case 1:return e=o.sent(),t=this._getOdataUri()+"/organizations("+e+")?$select=orgdborgsettings",[2,this._crmHttpRequest.send(n.default.ORG_SETTINGS,{method:"GET",url:t}).then((function(e){try{var t=C.parse(e);return r._applicationContext.Storage.setItem(m.default.orgSettingsCache,t),t}catch(e){var o=new c.ComponentError(n.default.ORG_SETTINGS,"Failed to parse orgdborgsettings",c.ErrorCode.GENERIC,e);throw r._applicationContext.EventManager.ReportTraceError(o),o}})).catch((function(e){var t;return(null===(t=e)||void 0===t?void 0:t.code)===c.ErrorCode.CRM_USER_MISSING_PRIVILEGE&&r._showMissingReadPrivilegeNotification(e),{}}))]}}))}))},e.prototype._showMissingReadPrivilegeNotification=function(e){var t=this,o=T.default.parseMissingPrivilegeFromErrorMessage(e.message);T.default.isRequiredReadPrivilegeForEntity(f.CrmTypeNames.Organization,o)&&(this._applicationContext.EventManager.ReportTraceError(new c.ComponentError(n.default.ORG_SETTINGS,"Failed to retrieve orgSettings from the server due to missing privilege "+o,e.code,e)),this._applicationContext.ComponentsLoader.ensureComponentLoaded(r.default.RESOURCE_MANAGER).then((function(){t._applicationContext.UIManager.showNotification(l.default.createFromComponentError(e,[o]))})))},e.prototype.getCurrentUserMailboxId=function(){var e=this;return this.whoAmI().then((function(t){return e._getSystemUserRecord(t.UserId).then((function(e){return e.MailboxId}))}))},e.prototype.getCurrentUserEmailAddress=function(){var e=this;return this.whoAmI().then((function(t){return e._getSystemUserRecord(t.UserId).then((function(e){return e.EmailAddress}))}))},e.prototype._getOrganizationId=function(){return i(this,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.whoAmI()];case 1:return(e=t.sent()).OrganizationId!==this._bcd.orgId&&this._applicationContext.EventManager.ReportTraceWarning(n.default.WHO_AM_I,"Org ID from manifest is not equal org ID from whoAmI request",{whoAmIOrgId:e.OrganizationId,manifestOrgId:this._bcd.orgId}),[2,e.OrganizationId];case 2:return t.sent(),this._applicationContext.EventManager.ReportTraceWarning(n.default.WHO_AM_I,"Couldn't get org ID from whoAmI request, fallback to org ID from manifest"),[2,this._bcd.orgId];case 3:return[2]}}))}))},e.prototype.getMailboxTrackingCategoryName=function(){var e=this._applicationContext.Storage.getItem(m.default.categoryNamesCache);return e?Promise.resolve(e):(this._getMailboxTrackingCategoryNamePromise||(this._getMailboxTrackingCategoryNamePromise=this._getMailboxTrackingCategoryFromServer()),this._getMailboxTrackingCategoryNamePromise)},e.prototype.isCategoryTrackingEnabled=function(){var e=this;return this._isCategoryTrackingEnabledPrmise||(this._isCategoryTrackingEnabledPrmise=this._isOrgSettingEnabledWithoutDefaultValue(h.TrackCategorizedItems).then((function(t){var r=e.isFeatureControlBitEnabled(f.FcbNames.TrackUsingCategoriesDefaultValue);return void 0===t?r:t})).then((function(t){return!!t&&e.getMailboxTrackingCategoryName().then((function(e){return!!e}))})),this._isCategoryTrackingEnabledPrmise.then((function(t){e._applicationContext.EventManager.ReportTraceWarning(n.default.CATEGORIES,"Category tracking feature state: '"+(t?"Enabled":"Disabled")+"'")}))),this._isCategoryTrackingEnabledPrmise},e.prototype._getMailboxTrackingCategoryFromServer=function(){var e=this;return this.getCurrentUserMailboxId().then((function(t){var r=e._createOdataEqualsCriteria("exchangecategoryid","2D5D7F9E-44A2-4629-B7E6-2533DB0AAE02"),o=e._createOdataEqualsCriteria("_mailboxid_value",t),i=e._getOdataUri()+"/mailboxtrackingcategories?$filter="+r+" and "+o+"&$select=exchangecategoryname";return e._crmHttpRequest.send(n.default.CATEGORIES,{method:"GET",url:i}).then((function(t){var r=t&&t.value?t.value[0]:null;if(r&&r.exchangecategoryname){e._applicationContext.EventManager.ReportTraceInfo(n.default.CATEGORIES,"Retrieved category successfully",r);var o=r.exchangecategoryname;return e._applicationContext.Storage.setItem(m.default.categoryNamesCache,o),o}e._applicationContext.EventManager.ReportTraceWarning(n.default.CATEGORIES,"Unable to retrieve category name",[{name:p.ErrorEventParameterName.Error,value:t}])})).catch((function(t){return e._applicationContext.EventManager.ReportTraceError(new c.ComponentError(n.default.SYSTEM_USER,"Exception happened while trying to retrieve mailbox tracking category",c.ErrorCode.GENERIC),[{name:p.ErrorEventParameterName.Error,value:t}]),null}))}))},e.prototype._isOrgSettingEnabledWithoutDefaultValue=function(e){return this.getOrgSettings().then((function(t){if(t&&void 0!==t[e.name])return t[e.name]}))},e.prototype._fulfillFcbValues=function(e,t){void 0===t&&(t={});var r=Object.assign({},t);return e.forEach((function(e){null!==r[e]&&void 0!==r[e]||(r[e]=!1)})),r},e.prototype.getFeatureControlBits=function(){var e=this,t=f.FcbNames,r=Object.keys(t).map((function(e){return t[e]})),n={fcbNames:r};return this._mailAppDataService.getMailAppData(I.MailAppDataServiceName.IS_FEATURES_ENABLED,n).then((function(t){return e._fulfillFcbValues(r,t)})).catch((function(){return e._fulfillFcbValues(r)}))},e.prototype.isFeatureControlBitEnabled=function(e){return this.getFeatureControlBits().then((function(t){return t[e]}))},e.prototype.isOrgSettingEnabled=function(e){return this.getOrgSettings().then((function(t){return t&&void 0!==t[e.name]?t[e.name]:e.defaultValue}))},e.prototype.isOrgSettingsEnabled=function(e){var t=this,r=e.map((function(e){return t.isOrgSettingEnabled(e)}));return Promise.all(r).then((function(t){return t.reduce((function(t,r,n){return t[e[n].name]=r,t}),{})}))},e.prototype._scheduleBackgroundDataRefresh=function(){var e=this;Date.now();this._applicationContext.ComponentsLoader.ensureComponentLoaded(r.default.DISPATCHER_COLLECTION).then((function(){e._applicationContext.DispatcherCollection[_.default.APPLICATION].clientInitialized.then((function(){d.default.setTimeout((function(){return e.getUserValidation(!0).catch((function(){}))}),1e4),e._bcd.mode!==s.default.Module&&d.default.setTimeout((function(){return e._getMailboxTrackingCategoryFromServer().catch((function(){}))}),11e3)})).catch((function(){}))}))},e.prototype.getUserValidation=function(e){var t=this;void 0===e&&(e=!1);var r={messageType:this._applicationContext.JsApiProvider.getMailboxItemType()};return this._mailAppDataService.getMailAppData(I.MailAppDataServiceName.GET_USER_VALIDATION,r,(function(e){return y.processResponse(e,t._applicationContext.JsApiProvider.getUserEmailAddress().toLowerCase(),n.default.GET_USER_VALIDATION)}),e).catch((function(e){var r,o;return(null===(o=null===(r=e)||void 0===r?void 0:r.innerError)||void 0===o?void 0:o.code)!==P.default.Unknown?Promise.reject(e):t.whoAmI(!0).then((function(){return Promise.reject(e)})).catch((function(e){return Promise.reject(new c.ComponentError(n.default.GET_USER_VALIDATION,e.message,e.code,e.innerError))}))}))},e.prototype.resolveRecipients=function(){return this._emailAddressesResolver.resolveRecipients()},e.prototype.forceResolveRecipient=function(e){return this._emailAddressesResolver.resolveCachedIfNotResolved(e)},e.prototype.whoAmI=function(e){var t=this;if(void 0===e&&(e=!1),!e){var r=this._applicationContext.Storage.getItem(m.default.whoAmICache);if(r)return Promise.resolve(r)}if(!this._whoAmIPromise){var o=this._getOdataUri()+"/WhoAmI()";this._whoAmIPromise=this._crmHttpRequest.send(n.default.WHO_AM_I,{method:"GET",url:o}).then((function(e){return t._applicationContext.Storage.setItem(m.default.whoAmICache,e),e}))}return this._whoAmIPromise},e.prototype.sendOdataBatchRequest=function(e,t){var r=this._applicationContext.EventManager.getSessionId(),o=v.default(this._getBaseUri(),[e+"?fetchXml="+encodeURIComponent(t)],r,this._getODataEndpointPrefix());return this._crmHttpRequest.send(n.default.ODATA_BATCH_REQUEST+"."+e,o)},e.prototype.sendOdataMultiqueryBatchRequest=function(e,t){var r=this._applicationContext.EventManager.getSessionId(),o=v.default(this._getBaseUri(),t,r,this._getODataEndpointPrefix());return this._crmHttpRequest.send(n.default.ODATA_BATCH_REQUEST+"."+e,o)},e.prototype.checkEntitiesReadPrivilege=function(e){void 0===e&&(e=!1);var t={typeNames:f.CheckEntitiesReadPrivilegeTypeNames};return this._mailAppDataService.getMailAppData(I.MailAppDataServiceName.CHECK_READ_PRIVILEGE,t,null,e)},e.prototype.executeOdataQuery=function(e){var t=this._getOdataUri()+"/"+e;return this._applicationContext.EventManager.ReportTraceInfo(n.default.EXECUTE_ODATA_QUERY,"Executing ODATA query",e),this._crmHttpRequest.send(n.default.EXECUTE_ODATA_QUERY,{url:t}).then((function(e){return e?e.value:null}))},e.prototype._getSystemUserRecord=function(e){var t=this,r=this._applicationContext.Storage.getItem(m.default.systemUsersCache,e);if(r)return Promise.resolve(r);var o=this._getOdataUri()+"/systemusers("+e+")?$select=_defaultmailbox_value,modifiedon,internalemailaddress";return this._crmHttpRequest.send(n.default.SYSTEM_USER,{url:o}).then((function(r){var o={MailboxId:r._defaultmailbox_value,ModifiedOn:r.modifiedon,EmailAddress:r.internalemailaddress};return t._applicationContext.Storage.setItem(m.default.systemUsersCache,o,null,e),o.MailboxId!==t._bcd.mailboxId&&t._applicationContext.EventManager.ReportTraceWarning(n.default.SYSTEM_USER,"Mailbox id in query params is outdated",o.MailboxId),o})).catch((function(e){throw t._applicationContext.EventManager.ReportTraceError(new c.ComponentError(n.default.SYSTEM_USER,"Exception happened while trying to retrieve system users data.",c.ErrorCode.GENERIC),[{name:p.ErrorEventParameterName.Error,value:e}]),e}))},e.prototype._getOdataUri=function(){return this._getBaseUri()+"/api/data/v9.0"},e.prototype._getBaseUri=function(){return this._applicationContext.OrgUrl+this._getODataEndpointPrefix()},e.prototype._getODataEndpointPrefix=function(){return this._bcd.crmDeploymentEnvironment===o.default.Online?"":"/"+this._bcd.orgName},e.prototype._createOdataEqualsCriteria=function(e,t){return e+" eq '"+t+"'"},e}();t.CRMProvider=A,t.default=function(){return function(e,t){if(e.crmDeploymentEnvironment===o.default.OnPremise&&!e.orgName){var i=r.default.CRM_PROVIDER+".CheckOrgName";throw new c.ComponentError(i,"Org name not available for OnPrem deployment",c.ErrorCode.GENERIC)}t.CRMProvider=new A(e,t),d.default.setTimeout((function(){t.CRMProvider.getFeatureControlBits().then((function(e){t.EventManager.ReportTraceInfo(n.default.IS_FEATURES_ENABLED,"Feature Control Bit values",e)})).catch((function(){})),e.mode!==s.default.Module&&t.CRMProvider.getOrgSettings().then((function(e){t.EventManager.ReportTraceInfo(n.default.ORG_SETTINGS,"Org Settings values",e)})).catch((function(){}))}),0)}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.GET_APP_ID="GetAppId",e.WHO_AM_I="WhoAmI",e.ORG_SETTINGS="OrganizationSettings",e.SYSTEM_USER="SystemUser",e.ODATA_QUERY="executeOdataQuery",e.ODATA_BATCH_REQUEST="OdataBatchRequest",e.TRACKING_CATEGORIES="CategoriesTracking",e}();t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(33)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,n,o){void 0===o&&(o="");var i="batch_"+(new Date).getTime(),a=t.reduce((function(e,t){return e+=function(e,t,r,n,o){var i="";i+="--"+o+"\n",i+="Content-Type: application/http\nContent-Transfer-Encoding: binary\n",i+="\n";var a={Prefer:'odata.include-annotations="*"',Accept:"application/json"};return n&&(a["Client-Session-Id"]=n,a["Client-Activity-Id"]=n),i+=function(e,t,r,n){var o="GET "+t+"/api/data/v9.0/"+r+" HTTP/1.1\n";for(var i in n)o+=i+": "+n[i]+"\n";return o}(0,t,r,a),i+="\n"}(0,o,t,n,i)}),""),s="--"+i+"--\r\n\0";return a.endsWith(s+"\n")?a=a.substr(0,a.length-1):a+=s,{url:e+"/api/data/v9.0/$batch",headers:[new r.default.KeyValue("Content-Type","multipart/mixed;boundary="+i)],content:a,method:"POST",isBatch:!0,batchQueriesCount:t.length}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(124)],void 0===(o=function(e,t,r){"use strict";function n(e,t){var r=t.indexOf(":");if(r>=0){var n=t.substring(0,r),o=t.substring(r+1).trim();e[n]=o}return e}function o(e){var t=-1!==e.indexOf("\r\n\r\n"),o=e.trim().split(t?"\r\n\r\n":"\n\n"),i=o[1].split(t?"\r\n":"\n"),a=i.slice(1),s=/(HTTP\/\d\.\d) (\d+) (.*)/gi.exec(i[0]),u=Number(s[2]),c=new r.FetchLikeHeaders(a.reduce(n,{})),l=o[2];return{status:u,ok:200<=u&&299>=u,statusText:s[3],headers:c,json:function(){return l?JSON.parse(l):null},text:function(){return l}}}function i(e){for(var t=[],r=0,n=function(e,t){var r="--"+e+"\r\n";0===t.indexOf(r)||(r="--"+e+"\n");var n=t.split(r);n.splice(0,1);var o=n[n.length-1],i=o.indexOf("--"+e);return n[n.length-1]=o.substring(0,i),n}(e.header("Content-Type").split("; ").pop().split("=").pop(),e.data());r<n.length;r++){var i=o(n[r]);t.push(i)}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.parseBatchResponse=i,t.default=i}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._headers=e}return e.prototype.append=function(e,t){this._headers[e]=t},e.prototype.get=function(e){return this._headers[e]},e.prototype.has=function(e){return this._headers.hasOwnProperty(e)},e}();t.FetchLikeHeaders=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(0),r(20),r(126),r(11),r(127),r(128),r(23),r(1),r(6),r(30)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c,l,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d="_parentobjectid_value@Microsoft.Dynamics.CRM.lookuplogicalname",f=r.default.CRM_PROVIDER+".ResolveEmailAddresses",h=function(){function e(e,t){this._bcd=e,this._applicationContext=t,this._recipientsCache=new o.default,this._recipientsRetriever=new s.default(e,t),this._pendingExecutions={}}return e.prototype.getRecipients=function(){return this._recipientsCollection},e.prototype._wrapWithValue=function(e){return e.reduce((function(e,t){return e+"\r\n<value>"+t+"</value>"}),"")},e.prototype._createParentJoinCondition=function(e){return'<link-entity name="'+e+'" to="parentobjectid" from="'+e+'id" link-type="outer" alias="'+e+'alias">\n\t\t\t\t\t<attribute name="'+i.CrmTypeNamesToNameFieldName[e]+'" />\n\t\t\t\t\t<attribute name="entityimage" />\n\t\t\t\t\t'+this._getEntitySpecificAttributes(e)+'\n\t\t\t\t\t<order attribute="createdon" descending="true" />\n\t\t\t\t</link-entity>'},e.prototype._getEntitySpecificAttributes=function(e){return e===i.CrmTypeNames.User?'<attribute name="'+i.PropertyNames.IsDisabled+'" />':'<attribute name="'+i.PropertyNames.OwnerId+'" />\n\t\t\t\t<attribute name="'+i.PropertyNames.StatusCode+'" />'},e.prototype._createFetchXml=function(e,t,r){return'<fetch version="1.0" output-format="xml-platform" mapping="logical" returntotalrecordcount="true" page="1" count="100" no-lock="true">\n\t\t\t<entity name="emailsearch">\n\t\t\t<attribute name="parentobjectid"/>\n\t\t\t<attribute name="emailaddress"/>\n\t\t\t<attribute name="parentobjecttypecode"/>\n\t\t\t<filter type="and">\n\t\t\t\t<condition attribute="emailaddress" operator="in">\n\t\t\t\t\t'+e+'\n\t\t\t\t</condition>\n\t\t\t\t<condition attribute="parentobjecttypecode" operator="in">\n\t\t\t\t\t'+t+"\n\t\t\t\t</condition>\n\t\t\t</filter>\n\t\t\t"+r+"\n\t\t\t</entity>\n\t\t</fetch>"},e.prototype._executeResolveRecipients=function(e,t){var r=this;return void 0===t&&(t=!1),Promise.all([this._applicationContext.CRMProvider.getFeatureControlBits(),this._applicationContext.CRMProvider.checkEntitiesReadPrivilege(t)]).then((function(n){var o=n[0],a=n[1];if(0===(e=e.filter(r._recipientsCache.isRecordExpired.bind(r._recipientsCache))).length)return Promise.resolve();var s=i.CheckEntitiesReadPrivilegeTypeNames.filter((function(e){return a[e]&&r._isFcbEnabledForRecipientsToBeResolvedAsEntity(o,e)}));if(s&&0!==s.length){var l=e.map((function(e){return u.escapeXml(e)})),p=s.map((function(e){return i.CrmTypeNamesToCodes[e]})),d=r._createFetchXml(r._wrapWithValue(l),r._wrapWithValue(p),r._createParentJoinConditionForEntitiesToResolve(s));return r._applicationContext.CRMProvider.sendOdataBatchRequest("emailsearches",d).then((function(t){var n=t&&t.value||[],o=e.concat([]);n.forEach((function(e){var t=r._webApiEntityToRecipientRecord(e),n=t.dataValues[i.PropertyNames.Email].toLowerCase();o=o.filter((function(e){return e.toLowerCase()!==n})),r._addResolvedToCache(t)})),o.forEach(r._recipientsCache.addUnresolved.bind(r._recipientsCache))})).catch((function(n){if(n.code===c.ErrorCode.CRM_USER_MISSING_PRIVILEGE)return r._handleMissingPrivilegeError(n,s,e,t);throw n}))}e.forEach(r._recipientsCache.addUnresolved.bind(r._recipientsCache))}))},e.prototype._handleMissingPrivilegeError=function(e,t,n,o){var a=this,s=l.default.parseMissingPrivilegeFromErrorMessage(e.message);if(l.default.isRequiredReadPrivilegeForEntity(i.CrmTypeNames.Role,s))return this._applicationContext.EventManager.ReportTraceError(new c.default(f+".Fail","Failed to resolve recipients due to missing privilege "+s,e.code,e)),this._applicationContext.ComponentsLoader.ensureComponentLoaded(r.default.RESOURCE_MANAGER).then((function(){a._notification&&a._notification.close(),a._notification=a._applicationContext.UIManager.showNotification(p.default.createFromComponentError(e,[s]))})),void n.forEach((function(e){return a._recipientsCache.addUnresolved(e)}));if(!o&&l.default.isRequiredReadPrivilegeForEntities(t,s))return this._applicationContext.EventManager.ReportTraceInfo(f+".Retry","Retry resolving Email Addresses: missing privilege "+s),this._executeResolveRecipients(n,!0);throw e},e.prototype._isFcbEnabledForRecipientsToBeResolvedAsEntity=function(e,t){return t===i.CrmTypeNames.Account?e[i.FcbNames.MailAppResolveRecipientsToAccounts]:t!==i.CrmTypeNames.Account},e.prototype._createParentJoinConditionForEntitiesToResolve=function(e){var t=this;return e.reduce((function(e,r){return e+t._createParentJoinCondition(r.trim())}),"")},e.prototype._addResolvedToCache=function(e){var t=e.dataValues[i.PropertyNames.Email],r=this._recipientsCache.getResolved(t);r&&this._resolvedRecordSelector.select(r,e)!==e||this._recipientsCache.addResolved(e)},e.prototype._webApiEntityToRecipientRecord=function(e){this._fillEntityLogicalNameIfEmpty(e);var t={emailaddress:e[i.PropertyNames.Email],name:this._getWebApiEntityAliasedProperty(e,i.CrmTypeNamesToNameFieldName[e[d]]),entityImage:this._getWebApiEntityAliasedProperty(e,"entityimage")},r=e[d];r===i.CrmTypeNames.User?t.isdisabled=this._getWebApiEntityAliasedProperty(e,i.PropertyNames.IsDisabled):(t.statecode=this._getWebApiEntityAliasedProperty(e,i.PropertyNames.StatusCode),t.ownerid=this._getWebApiEntityAliasedProperty(e,i.PropertyNames.OwnerId),t.followemail=this._getWebApiEntityAliasedProperty(e,i.PropertyNames.FollowEmail));return{entityReference:{Id:n.default.tryParseOrNull(e._parentobjectid_value),LogicalName:r,Name:t.name},dataValues:t}},e.prototype._fillEntityLogicalNameIfEmpty=function(e){var t=e[d];if(!t){var r=Object.keys(e).find((function(e){return e.indexOf("alias")>-1}));r&&(t=r.indexOf(i.CrmTypeNames.User)>-1?i.CrmTypeNames.User:r.indexOf(i.CrmTypeNames.Contact)>-1?i.CrmTypeNames.Contact:r.indexOf(i.CrmTypeNames.Lead)>-1?i.CrmTypeNames.Lead:r.split("alias.")[0],e[d]=t)}},e.prototype._getWebApiEntityAliasedProperty=function(e,t){return e[e[d]+"alias."+t]},e.prototype._logResolvedRecipientsSummary=function(){var e={emailAddressesCount:this._recipientsCollection?this._recipientsCollection.length:0,recipientTypesCountMap:{}};this._recipientsCollection&&(e.recipientTypesCountMap=this._recipientsCollection.reduce((function(e,t){return e[t.entityReference.LogicalName]=e[t.entityReference.LogicalName]?e[t.entityReference.LogicalName]+1:1,e}),{})),this._applicationContext.EventManager.ReportTraceInfo(f+".Summary","Resolved Email Addresses summary",e)},e.prototype._resolveRecipients=function(e){var t=this;this._currentEmailAddressDetails=e;var r=[],n=e.map((function(e){return e.emailAddress}));if(0===n.length){var o=this._recipientsCollection&&0!==this._recipientsCollection.length;return this._recipientsCollection=r,o&&this._logResolvedRecipientsSummary(),Promise.resolve({recipients:this._recipientsCollection,isChanged:o})}var a=n.map((function(e){return e.toLowerCase()})).sort().join();return this._pendingExecutions[a]?this._pendingExecutions[a]:(this._pendingExecutions[a]=this._executeResolveRecipients(n).then((function(){delete t._pendingExecutions[a];for(var n=0;n<e.length;n++){var o=t._recipientsCache.getResolved(e[n].emailAddress);if(!o){var s={name:e[n].displayName||e[n].emailAddress,emailaddress:e[n].emailAddress};o={entityReference:{Id:null,LogicalName:e[n].recipientType,Name:s.name},dataValues:s}}o.dataValues[i.PropertyNames.Role]=e[n].recipientRole,r.push(o)}var u=t._isRecipientsChanged(r);return u&&(t._recipientsCollection=r,t._logResolvedRecipientsSummary()),{recipients:r,isChanged:u}})),this._pendingExecutions[a])},e.prototype._isRecipientsChanged=function(e){var t=this;return!this._recipientsCollection||this._recipientsCollection.length!==e.length||e.reduce((function(e,r,n){if(t._recipientsCollection&&t._recipientsCollection[n]&&t._recipientsCollection[n].dataValues[i.PropertyNames.Email]===r.dataValues[i.PropertyNames.Email]){var o=t._recipientsCollection[n];(o.entityReference.Id===r.entityReference.Id||null!=o.entityReference.Id&&null!=r.entityReference.Id&&o.entityReference.Id.guid===r.entityReference.Id.guid)&&e.push(o)}return e}),[]).length!==e.length},e.prototype.resolveRecipients=function(){var e=this;return(this._resolvedRecordSelector?this._recipientsRetriever.getEmailAddressDetailsArray():Promise.all([this._applicationContext.CRMProvider.whoAmI(),this._recipientsRetriever.getEmailAddressDetailsArray()]).then((function(t){var r=t[0],n=t[1];return e._resolvedRecordSelector=new a.default(r.UserId),n}))).then((function(t){return e._resolveRecipients(t)}))},e.prototype.resolveCachedIfNotResolved=function(e){return e&&this._recipientsCache.isCached(e)&&!this._recipientsCache.getResolved(e)?(this._recipientsCache.resetRecipient(e),this._resolveRecipients(this._currentEmailAddressDetails)):Promise.resolve(null)},e}();t.default=h}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(11)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._indexedRecipients={},this._indexedStamps={}}return e.prototype.addResolved=function(e){var t=e.dataValues[r.PropertyNames.Email].toLowerCase();this._indexedRecipients[t]=e,this._indexedStamps[t]=new Date},e.prototype.addUnresolved=function(e){e=e.toLowerCase(),this._indexedRecipients[e]=null,this._indexedStamps[e]=new Date},e.prototype.getResolved=function(e){return e=e.toLowerCase(),this._indexedRecipients[e]},e.prototype.getStamp=function(e){return e=e.toLowerCase(),this._indexedStamps[e]},e.prototype.isRecordExpired=function(t){return t=t.toLowerCase(),!this._indexedStamps.hasOwnProperty(t)||(new Date).getTime()-this.getStamp(t).getTime()>e._expirationTime},e.prototype.isCached=function(e){return e=e.toLowerCase(),this._indexedRecipients.hasOwnProperty(e)},e.prototype.resetRecipient=function(e){e=e.toLowerCase(),delete this._indexedRecipients[e],delete this._indexedStamps[e]},e._expirationTime=3e5,e}();t.default=n}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(11)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t;this._logicalNamePriorityForRecipientResolution=((t={})[r.CrmTypeNames.Account]=0,t[r.CrmTypeNames.Lead]=1,t[r.CrmTypeNames.Contact]=2,t[r.CrmTypeNames.User]=3,t),this._currentUserId=e}return e.prototype.select=function(e,t){var r=this._isRecordActive(e),n=this._isRecordActive(t);if(!r&&n)return t;if(r&&!n)return e;var o=this._getRecordPriority(e),i=this._getRecordPriority(t);if(o!==i)return o>i?e:t;var a=this._isCreatedByCurrentUser(e),s=this._isCreatedByCurrentUser(t);return!a&&s?t:e},e.prototype._isCreatedByCurrentUser=function(e){return e.entityReference.LogicalName!==r.CrmTypeNames.User&&(e.dataValues[r.PropertyNames.OwnerId]||"").toUpperCase()===this._currentUserId.toUpperCase()},e.prototype._isRecordActive=function(e){return e.entityReference.LogicalName===r.CrmTypeNames.User?!e.dataValues[r.PropertyNames.IsDisabled]:0===e.dataValues[r.PropertyNames.StatusCode]},e.prototype._getRecordPriority=function(e){return this._logicalNamePriorityForRecipientResolution[e.entityReference.LogicalName]},e}();t.default=n}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(50),r(10)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this._bcd=e,this._applicationContext=t,this._isComposeMode=this._applicationContext.JsApiProvider.isComposeMode(),this._userProfileEmail=this._applicationContext.JsApiProvider.getUserEmailAddress()}return e.prototype.getEmailAddressDetailsArray=function(){var e=this;return this._getEmailAddressDetailsArrayInternal().then((function(t){t=e._fillEmailAddresses(t),t=e._removeDuplicates(t);var r=e._applicationContext.JsApiProvider.getMailboxItemType();return(t.length>1||r===n.default[n.default.appointment]||e._isComposeMode)&&(t=t.filter((function(t){return t.emailAddress.toLowerCase()!==e._userProfileEmail.toLowerCase()}))),t}))},e.prototype._getEmailAddressDetailsArrayInternal=function(){var e=this,t=this._applicationContext.JsApiProvider.isAppointment(),n=[];return t?this._applicationContext.JsApiProvider.getMeetingAttendees().then((function(t){return t.organizer&&n.push(e._setRecipientRole(t.organizer,r.default.Organizer)),n=n.concat(t.requiredAttendees.map((function(t){return e._setRecipientRole(t,r.default.RequiredAttendee)}))).concat(t.optionalAttendees.map((function(t){return e._setRecipientRole(t,r.default.OptionalAttendee)})))})):this._applicationContext.JsApiProvider.getMessageRecipients().then((function(t){return t.sender&&n.push(e._setRecipientRole(t.sender,r.default.Sender)),n=n.concat(t.to.map((function(t){return e._setRecipientRole(t,r.default.To)}))).concat(t.cc.map((function(t){return e._setRecipientRole(t,r.default.Cc)}))),t.bcc&&(n=n.concat(t.bcc.map((function(t){return e._setRecipientRole(t,r.default.Bcc)})))),n}))},e.prototype._fillEmailAddresses=function(e){return e.map((function(e){return e.emailAddress||(e.emailAddress=e.displayName),e}))},e.prototype._removeDuplicates=function(e){var t={};return e.reduce((function(e,r){var n=r.emailAddress.toLowerCase();return t.hasOwnProperty(n)||(t[n]=!0,e.push(r)),e}),[])},e.prototype._setRecipientRole=function(e,t){return{recipientRole:t,emailAddress:e.emailAddress,displayName:e.displayName,recipientType:e.recipientType}},e}();t.default=o}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(1),r(30)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processResponse=function(e,t,o){if(!e.IsValid){var i=e.Status&&e.Status.Errors&&e.Status.Errors.length&&e.Status.Errors[0];if(i)throw new r.ComponentError(o,i.DiagnosticMessage,i.ErrorCode);throw new r.ComponentError(o,"User validation failed with no error",r.ErrorCode.GENERIC)}var a=e.UserEmailAddress.toLowerCase();if(t!==a)throw new n.default(o,"Email Addresses in CRM and exchange do not match",r.ErrorCode.UV_EMAIL_ADDRESS_MISMATCH,[t,a]);return e}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(25)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parse=function(e){var t={},n=e.orgdborgsettings;if(!n)return t;var o=(new DOMParser).parseFromString(n,"text/html").getElementsByTagNameNS("*","orgsettings")[0];if(!o)return t;for(var i=function(e){var n=o.childNodes[e],i=n.nodeName.toLowerCase(),a=Object.keys(r).find((function(e){return r[e].name.toLowerCase()===i}));if(a){var s=r[a],u=n.textContent.toLowerCase()===s.enabledValue.toLowerCase();t[s.name]=u}},a=0;a<o.childNodes.length;a++)i(a);return t}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(9),r(77),r(76)],void 0===(o=function(e,t,r,n,o,i){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),t.MailAppDataServiceName=i.default;var s=((a={})[i.default.GET_USER_VALIDATION]=n.default.getUserValidationCache,a[i.default.CHECK_READ_PRIVILEGE]=n.default.checkEntitiesReadPrivilegeCache,a[i.default.IS_FEATURES_ENABLED]=n.default.isFeaturesEnabledCache,a),u=function(){function e(e,t){this._mailAppDataPromises={},this._bcd=e,this._applicationContext=t,this._crmHttpRequest=new o.default(this._bcd,t)}return e.prototype.getMailAppData=function(e,t,r,n){var o=this;if(void 0===n&&(n=!1),!n){var i=this._applicationContext.Storage.getItem(s[e]);if(i)return Promise.resolve(i)}return this._mailAppDataPromises[e]||(this._mailAppDataPromises[e]=this._executeMailAppDataCall(e,t).then((function(t){try{var n=r&&r(t)||t;return o._applicationContext.Storage.setItem(s[e],n),n}catch(e){throw e}})).catch((function(t){return o._applicationContext.Storage.removeItem(s[e]),Promise.reject(t)}))),this._mailAppDataPromises[e]},e.prototype._executeMailAppDataCall=function(e,t){var n=r.default.CRM_PROVIDER+"."+e,o=this._applicationContext.OrgUrl+"/AppWebServices/MailAppInitialDataService.asmx/"+e;return this._crmHttpRequest.send(n,{method:"POST",url:o,content:JSON.stringify(t)}).then((function(t){if(t&&t.d)return t.d;throw'"'+e+'" responded with invalid data'}))},e}();t.default=u}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(17),r(12),r(133),r(1),r(4),r(2),r(48),r(9),r(21),r(22),r(29)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c,l,p,d,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=r.default.UNIFIED_CLIENT_LOADER+".ClientFrameLoad",_=function(){function e(e,t){this._bcd=e,this._applicationContext=t,this._iframeId=c.IFRAME_ID,this._parentElement=u.default.document().getElementById("content")}return e.prototype._loadMailClient=function(){var e=this,t=this._applicationContext.Storage.getItem(l.default.appModuleIdsCache);return t?this._loadFrame(this._mailClientFrameUrl(t)):this._applicationContext.CRMProvider.getAppId().then((function(t){return e._loadFrame(e._mailClientFrameUrl(t))}),(function(e){throw e instanceof a.ComponentError||(e=a.ComponentError.fromNativeError(r.default.UNIFIED_CLIENT_LOADER,a.ErrorCode.GENERIC,e)),e}))},e.prototype._loadModuleClient=function(){return this._loadFrame(this._moduleClientFrameUrl())},e.prototype.loadClient=function(){switch(this._bcd.mode){case o.default.Read:case o.default.Compose:return this._loadMailClient();case o.default.Module:return this._loadModuleClient();default:return this._loadMailClient()}},e.prototype._loadFrame=function(e){var t=this;return new Promise((function(r,n){var o=u.default.document().createElement("iframe");o.setAttribute("id",t._iframeId),d.default.getInstance().getIsBrowserChrome()&&o.setAttribute("sandbox",c.IFRAME_SANDBOX);var i=t._applicationContext.Performance.addStopwatch(h);o.onload=function(){i.stop(),t._applicationContext.EventManager.ReportComponentSuccess(h),t._parentElement.setAttribute("aria-hidden","false"),t._addFrameContentListeners(o),r(o.contentDocument)},o.onerror=n,o.setAttribute("src",e),t._parentElement.appendChild(o),t._applicationContext.EventManager.ReportTraceInfo(h,"Client iframe is appended to DOM")})).catch((function(e){throw new a.ComponentError(h,"Failed to load iframe",a.ErrorCode.GENERIC,p.ensureComponentErrorObject(e))}))},e.prototype._addFrameContentListeners=function(e){var t=this;e.contentWindow&&(e.contentWindow.onerror=function(e,r,n,o,i,a){if(a&&a.length)for(var s=0,u=a;s<u.length;s++){var c=u[s];t._reportFrameError(c.errorMessage,c.fileName,c.lineNumber,c.columnNumber,p.ensureErrorObject(c))}else t._reportFrameError(e,r,n,o,i)})},e.prototype._reportFrameError=function(e,t,r,n,o){this._applicationContext.EventManager.ReportComponentFailure(new a.ComponentError(h,e&&e.length>0?e:"Error in Unified Client frame. Error detail is unavailable",a.ErrorCode.GENERIC,p.ensureComponentErrorObject(o)),[{name:s.ErrorEventParameterName.Error,value:o},{name:s.ErrorEventParameterName.Url,value:t},{name:s.ErrorEventParameterName.LineNumber,value:r},{name:s.ErrorEventParameterName.ColumnNumber,value:n}])},e.prototype._mailClientFrameUrl=function(e){var t=this._bcd.orgName,r=this._bcd.collectorService,n=this._bcd.showPerformance?"&perf=true":"",o=this._bcd.testMode?"&flags="+encodeURIComponent("testmode=true"):"",a=r?"&collectorurl="+r:"",s="&clienthost=3&appid="+e,c=this._bcd.useAuthMethod===f.default.WIA?"":i.default(this._bcd),l="&sv="+u.default.appVersion();return this._applicationContext.OrgUrl+"/uclient/main.htm?org="+t+n+a+c+s+l+o},e.prototype._moduleClientFrameUrl=function(){var e=this._bcd.useAuthMethod,t=this._bcd.orgName,r=n.default[this._bcd.crmDeploymentEnvironment].toString();return this._applicationContext.OrgUrl+"/crmmailapp/outlookmoduleextension/index.html?useAuthMethod="+e+"&org="+t+"&de="+r},e}();t.UnifiedClientLoader=_,t.default=function(){return function(e,t){return new _(e,t).loadClient()}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(2),r(17),r(29)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.useAuthMethod===o.default.Cookie?0===r.default.location().protocol.indexOf("https")?"&skipSetupCookie=1"+(e.crmDeploymentEnvironment===n.default.Online?"&liveid=1":""):"":"&liveid=1&skipSetupCookie=1"}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(135)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return function(e,t){var n=new r.default;t.DispatcherCollection=n.boot(e,t)}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(12),r(136),r(138),r(139),r(140),r(141),r(142),r(143),r(144),r(145),r(146),r(203)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c,l,p,d,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(){function e(){}return e.prototype.boot=function(e,t){var h={},_=new n.default(e,t);h[_.getNamespace()]=_;var m=new a.default(e,t);h[m.getNamespace()]=m;var v=new l.default(e,t);h[v.getNamespace()]=v;var g=new s.default(e,t);if(h[g.getNamespace()]=g,e.mode!==r.default.Module){var E=new d.default(e,t);h[E.getNamespace()]=E;var y=new u.default(e,t);h[y.getNamespace()]=y;var C=new c.default(e,t);h[C.getNamespace()]=C;var I=new p.default(e,t);h[I.getNamespace()]=I;var P=new i.default(e,t);h[P.getNamespace()]=P;var T=new o.default(e,t);h[T.getNamespace()]=T}else{var A=new f.default(e,t);h[A.getNamespace()]=A}return h},e}();t.default=h}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(15),r(7)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r){var o=e.call(this,t,r)||this;return o.namespace=n.default.DEVICE,o}return a(t,e),t.prototype.getInitialState=function(){return{FormFactor:"mailapp"}},t}(r.default);t.default=o}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(1),r(4)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,i,a,s,u){if(this._dispatcher=e,this._appContext=t,this._name=i,this._function=a,this._argsType=s,this._callbacks=u,!this._dispatcher||!this._appContext)throw new n.ComponentError(r.default.DISPATCHER,"DispatcherMethod.constructor: Either dispatcher or applicationContext instance is null.",n.ErrorCode.GENERIC);if(!(this._name&&this._function&&this._argsType&&this._callbacks)){var c={name:this._name,function:this._function,argsType:this._argsType,callbacks:this._callbacks};this._appContext.EventManager.ReportComponentFailure(new n.ComponentError(this._getTelemetryComponent+".constructor","Missing argument to DispatcherMethod()",n.ErrorCode.GENERIC),[{name:o.EventParameterName.Data,value:c}])}}return Object.defineProperty(e.prototype,"_getTelemetryComponent",{get:function(){return this._dispatcher.getTelemetryComponent()+".Method"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),e.prototype.invoke=function(e){this._verifySchemaWithArgsAndTypes(e)&&this._function.call(this._dispatcher,e)},e.prototype._verifySchemaWithArgsAndTypes=function(e){var t=this._getTelemetryComponent+"."+this._name+".VerifySchema";if(Object.keys(e.args).length!==Object.keys(this._argsType).length)return this._appContext.EventManager.ReportComponentFailure(new n.ComponentError(t,"Invalid number of arguments passed",n.ErrorCode.GENERIC)),!1;if(Object.keys(e.callbacks).length!==Object.keys(this._callbacks).length){var r=[{name:o.EventParameterName.Data,value:{callbacks:e.callbacks,expectedCallbacks:this._callbacks}}];return this._appContext.EventManager.ReportComponentFailure(new n.ComponentError(t,"Invalid number of callbacks passed",n.ErrorCode.GENERIC),r),!1}for(var i in e.args){var a=e.args[i];if(!this._verifyArgument(i,a))return!1}for(var s in e.callbacks){var u=e.callbacks[s];if(!this._verifyCallback(s,u))return!1}return!0},e.prototype._verifyArgument=function(e,t){var r=this._getTelemetryComponent+"."+this._name+".VerifyArgument",i=[{name:o.EventParameterName.Data,value:e}],a=this._argsType[e];return void 0===a?(this._appContext.EventManager.ReportComponentFailure(new n.ComponentError(r,"Argument with unknown name passed for verification",n.ErrorCode.GENERIC),i),!1):null===t||typeof a==typeof t||(this._appContext.EventManager.ReportComponentFailure(new n.ComponentError(r,"Argument with unexpected type passed for verification",n.ErrorCode.GENERIC),i),!1)},e.prototype._verifyCallback=function(e,t){var r=this._getTelemetryComponent+"."+this._name+".VerifyCallback";return e&&t?void 0!==this._callbacks[e]||(this._appContext.EventManager.ReportComponentFailure(new n.ComponentError(r,"Callback with name not found",n.ErrorCode.GENERIC),[{name:o.EventParameterName.Data,value:e}]),!1):(this._appContext.EventManager.ReportComponentFailure(new n.ComponentError(r,"_verifyCallback called with no arguments",n.ErrorCode.GENERIC)),!1)},e}();t.default=i}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(15),r(7),r(22),r(2),r(4),r(1)],void 0===(o=function(e,t,r,n,o,i,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){function t(t,r){var o=e.call(this,t,r)||this;return o.namespace=n.default.DATA,o}return a(t,e),t.prototype._base64ToBlob=function(e,t){for(var r=i.default.atob(e),n=r.length,o=new ArrayBuffer(n),a=new Uint8Array(o),s=0;s<n;s++)a[s]=r.charCodeAt(s);return new Blob([o],{type:t})},t.prototype._saveOrOpenBlob=function(e,t){var r=i.default.URL().createObjectURL(e),n=i.default.document().createElement("a");n.setAttribute("href",r),n.setAttribute("target","_blank"),t&&n.setAttribute("download",t),i.default.document().body.appendChild(n),n.click(),i.default.document().body.removeChild(n),i.default.URL().revokeObjectURL(r)},t.prototype._saveBlobForSafari=function(e){var t=this;return new Promise((function(r,n){var a=new FileReader;a.onloadend=function(){var t=a.result,n=i.default.document().getElementById("__mscrm.safariopenfileiframe");n||((n=i.default.document().createElement("iframe")).style.display="none",i.default.document().body.appendChild(n),n.id="__mscrm.safariopenfileiframe");var s=t;(e.type.startsWith("text")||e.type.startsWith("image"))&&(s=s.replace(e.type,"application/octet-stream")),n.src=s,o.default.getInstance().getIsIOSSupported()&&i.default.open(t,"_blank","scrollbars=1,resizable=1,width=1000,height=700"),r()},a.onerror=function(e){t.applicationContext.EventManager.ReportComponentFailure(new u.ComponentError(t.getTelemetryComponent()+".SafariSaveBlob","FileReader failed",u.ErrorCode.GENERIC),[{name:s.ErrorEventParameterName.Error,value:e}]),n()},a.readAsDataURL(e)}))},t.prototype._saveDataFile=function(e){var t=this,r=e.args.dataFile,n=this._base64ToBlob(r.fileContents,r.mimeType);if(i.default.navigator().msSaveBlob)i.default.navigator().msSaveBlob(n,r.filename);else{if(o.default.getInstance().getIsBrowserSafari())return void this._saveBlobForSafari(n).then((function(){t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onSuccessCallback,{dataID:r.filename},!1)}),(function(){t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onErrorCallback,{},!1)}));this._saveOrOpenBlob(n,r.filename)}this.applicationContext.Bridge.performCallbackWithId(e.callbacks.onSuccessCallback,{dataID:r.filename},!1)},t.prototype.registerMethods=function(){var e,t;this.registerMethodWithName("saveDataFile",this._saveDataFile,((e={}).dataFile={},e),((t={}).onErrorCallback="",t.onSuccessCallback="",t))},t}(r.default);t.default=c}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(15),r(7),r(2),r(1)],void 0===(o=function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t,r){var o=e.call(this,t,r)||this;return o.namespace=n.default.MULTIMEDIA,o}return a(t,e),t.prototype.getInitialState=function(){return{NativeFilePickerAvailable:!0}},t.prototype._openFilePicker=function(e){var t=this,r=e.args.shouldPickMultipleFiles,n=e.args.fileFilter,a=e.args.maxUploadFileSize;this._pickFileInternal(r,a,n.join(",")).then((function(r){t._fileInput&&o.default.document().body.removeChild(t._fileInput),t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onSuccessCallback,{dataFiles:r},!1)}),(function(r){t.applicationContext.EventManager.ReportComponentFailure(new i.ComponentError(t.getTelemetryComponent()+".PickFile","FileReader failed",r)),t._fileInput&&o.default.document().body.removeChild(t._fileInput),t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onErrorCallback,{errorCode:r},!1)}))},t.prototype._pickFileInternal=function(e,t,r){var n=this;return new Promise((function(i,a){var s=o.default.document().getElementById("filepickerid");s?(n._fileInput=s,n._fileInput.multiple=e,n._fileInput.accept=r):(n._fileInput=o.default.document().createElement("input"),n._fileInput.type="file",n._fileInput.id="filepickerid",n._fileInput.style.display="none",n._fileInput.multiple=e,n._fileInput.accept=r,n._fileInput.onchange=function(e){for(var r=e.target.files,n=0;n<r.length;n++){if(r[n].size>t)return void a(2);if(0===r[n].size)return void a(3)}var o=[],s=0,u=function(e){var t=new FileReader;t.onload=function(){var n=t.result,a={fileContents:n.substring(n.indexOf(",")+1),mimeType:r[e].type,filename:r[e].name,size:r[e].size};o.push(a),++s===r.length&&i(o)},t.onerror=function(e){a(0)},t.readAsDataURL(r[e])};for(n=0;n<r.length;n++)u(n)},o.default.document().body.appendChild(n._fileInput)),n._fileInput.click()}))},t.prototype.registerMethods=function(){var e,t;this.registerMethodWithName("openFilePicker",this._openFilePicker,((e={}).shouldPickMultipleFiles=!1,e.fileFilter=[""],e.pickerLocation=0,e.maxUploadFileSize=0,e),((t={}).onErrorCallback="",t.onSuccessCallback="",t))},t}(r.default);t.default=s}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(1),r(4),r(2),r(7),r(9),r(15)],void 0===(o=function(e,t,r,n,o,i,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.namespace=i.default.APPLICATION,n._isClientInitialized=!1,n._clientInitializedPromise=new Promise((function(e,t){n._clientInitializedPromiseResolve=e,n._clientInitializedPromiseReject=t})),n}return a(t,e),Object.defineProperty(t.prototype,"clientInitialized",{get:function(){return this._clientInitializedPromise},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isClientInitialized",{get:function(){return this._isClientInitialized},enumerable:!0,configurable:!0}),t.prototype.getInitialState=function(){var e,t=this.applicationContext.Storage.getItem(s.default.initTime);this.applicationContext.Storage.removeItem(s.default.initTime);var r=this.applicationContext.Performance.getMetrics();this.applicationContext.Performance.disable(),this.applicationContext.Performance.clear();var i={MobileClientTelemetry:!0,HideBrandName:!0,HideAppSwitcher:!0};return{DiagnosticsEnabled:!1,WindowLocation:!1,LastPALVersion:"Version1",PushToPull:!1,Pullback:!1,MessageInterface:!0,MessageProtocol:o.default.location().protocol,Version1:!0,OSVersion:"TBD",HasReconfigureSupport:!0,ApplicationName:o.default.location().host,ShimPerformanceMetrics:r,ShimStartTime:new Date(t).getTime(),TelemetryEventsParams:(e={ShimSessionId:this.applicationContext.EventManager.getSessionId()},e[n.SessionContextParameterName.ShimVersion]=o.default.shimVersion(),e),Revision:1,Win8UpdateRevision:1,ProxyMetadataSyncEventsToShim:!0,NativeFCBContext:i}},t.prototype._clientReady=function(e){},t.prototype._clientInitialized=function(e){this._isClientInitialized=!0,this._clientInitializedPromiseResolve()},t.prototype._clientBootError=function(e){var t=e.args.errorDetails;this._clientInitializedPromiseReject(new r.default("ClientBootError",t.message,t.errorCode))},t.prototype.registerMethods=function(){this.registerMethodWithName("clientReady",this._clientReady,{clientState:{}},{}),this.registerMethodWithName("clientInitialized",this._clientInitialized,{},{}),this.registerMethodWithName("clientBootError",this._clientBootError,{deviceErrorAction:0,errorDetails:{}},{})},t}(u.default);t.default=c}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(7),r(15)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o;!function(e){e[e.Cancelled=0]="Cancelled",e[e.Failed=1]="Failed"}(o||(o={}));var i=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o._authFailureResponse="AuthError",o.namespace=r.default.ACCOUNT,o}return a(t,e),t.prototype._requestSecurityToken=function(e){var t=this,r=e.args.refreshToken;this.applicationContext.AuthenticationProvider.authenticateClient(r).then((function(r){var n={requestSecurityTokenResponse:r};t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onRequestSecurityTokenResponse,n,!1)}),(function(r){var n={requestSecurityTokenResponse:t._authFailureResponse,status:o.Failed,errorCode:r.code,errorDescription:r.message};t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onRequestSecurityTokenResponse,n,!1)}))},t.prototype.registerMethods=function(){this.registerMethodWithName("requestSecurityToken",this._requestSecurityToken,{refreshToken:!1},{onRequestSecurityTokenResponse:""})},t}(n.default);t.default=i}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(2),r(7),r(15)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t,r){var o=e.call(this,t,r)||this;return o.namespace=n.default.DOCUMENT,o}return a(t,e),t.prototype._launchUrl=function(e){var t=e.args.url;t&&(this.applicationContext.EventManager.ReportTraceInfo(this.getTelemetryComponent()+".LaunchUrl","Attempting to open document",t),r.default.open(t,"_blank","scrollbars=1,resizable=1,width=1000,height=700"))},t.prototype._openDocument=function(e){this.applicationContext.Bridge.performCallbackWithId(e.callbacks.onOpenDocumentComplete,{palErrorCode:0},!1)},t.prototype.registerMethods=function(){var e,t;this.registerMethodWithName("launchURL",this._launchUrl,((e={}).url="",e),{}),this.registerMethodWithName("openDocument",this._openDocument,{dataID:"",fileName:"",mimeType:""},((t={}).onOpenDocumentComplete="",t))},t}(o.default);t.default=i}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(7),r(15)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.namespace=r.default.NAVIGATION,o}return a(t,e),t.prototype._updateBackBehavior=function(e){},t.prototype.registerMethods=function(){var e;this.registerMethodWithName("updateBackBehavior",this._updateBackBehavior,((e={}).behavior=0,e))},t}(n.default);t.default=o}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(2),r(7),r(15)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t,r){var o=e.call(this,t,r)||this;return o.namespace=n.default.NETWORK,o}return a(t,e),t.prototype._openUrl=function(e){var t=e.args.url;t&&(this.applicationContext.EventManager.ReportTraceInfo(this.getTelemetryComponent()+".OpenUrl","Attempting to open document",t),r.default.open(t,"_blank","scrollbars=1,resizable=1,width=1000,height=700"),this.applicationContext.Bridge.performCallbackWithId(e.callbacks.onMethodReturn,{returnValue:!0},!1))},t.prototype._canOpenUrl=function(e){this.applicationContext.Bridge.performCallbackWithId(e.callbacks.onMethodReturn,{returnValue:!0},!1)},t.prototype.registerMethods=function(){var e,t,r,n;this.registerMethodWithName("openUrl",this._openUrl,((e={}).url="",e),((t={}).onMethodReturn="",t.onMethodException="",t)),this.registerMethodWithName("canOpenUrl",this._canOpenUrl,((r={}).url="",r),((n={}).onMethodReturn="",n.onMethodException="",n))},t}(o.default);t.default=i}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(15),r(7)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r){var o=e.call(this,t,r)||this;return o.namespace=n.default.LOGGING,o}return a(t,e),t.prototype.registerMethods=function(){var e,t;this.registerMethodWithName("logMessage",(function(){}),((e={}).level=0,e.message="",e),{}),this.registerMethodWithName("logTelemetryData",(function(){}),((t={}).telemetryData="",t),{})},t}(r.default);t.default=o}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(147),r(0),r(201),r(1),r(21),r(4),r(7),r(15),r(202)],void 0===(o=function(e,t,r,n,o,i,s,u,c,l,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){function t(t,o){var a=e.call(this,t,o)||this;a.namespace=c.default.EXTERNAL_CONTEXT,a._dependentProperties={},a._pendingPropertyRequests=[],a._allPropertiesInitialized=!1,a.applicationContext.ComponentsLoader.ensureComponentLoaded(n.default.WEB_SCRIPT_BRIDGE).then((function(){return a._onBridgeLoaded()})).then((function(){return a._allPropertiesInitialized=!0})),a._initializedProperties={},a._externalContextDispatcherHelper=new p.default(o);try{a._contexts=r.default(a.bcd,a.applicationContext)}catch(e){throw i.ComponentError.fromNativeError(a.getTelemetryComponent()+".constructor",i.ErrorCode.GENERIC,e)}return a}return a(t,e),t.prototype._wrapPropertyValue=function(e,t,r){return{value:e,status:t,errorMessage:r}},t.prototype._convertToExternalContextError=function(e,t,r){var n=s.ensureComponentErrorObject(t),o=r+". Reason: "+n.message;return this._reportTraceErrorTelemetry(e,o,n),{errorCode:n.code,message:o,blockErrorReporting:!1}},t.prototype._knownPropertyUpdate=function(e,t,r,n,i){var a=this;n===o.ExternalContextResultStatus.Success?this._reportPropertyValue("Updating known property",e,t,r,"KnownPropertyUpdate"):n===o.ExternalContextResultStatus.Loading&&this.applicationContext.EventManager.ReportTraceInfo(this._getTelemetryComponentName(e,t,"KnownPropertyUpdate"),"Update known property with state loading"),this.applicationContext.Bridge.changeStateForDispatcher(this.namespace,"KnownPropertyUpdate",{contextId:e,propertyId:t,value:this._wrapPropertyValue(r,n,i)},!0),this._allPropertiesInitialized&&n!==o.ExternalContextResultStatus.Loading&&this._dependentProperties[e]&&this._dependentProperties[e][t]&&this._dependentProperties[e][t].map((function(r){var n=a._contexts[r.contextId].properties[r.propertyId];n.onDependentProperyUpdate?n.onDependentProperyUpdate({contextId:e,propertyId:t}):n.notifyUpdate&&n.notifyUpdate(n.accessor())}))},t.prototype._getPropertyNotifyUpdateFunction=function(e,t){var r=this;return function(n,i){n&&"function"==typeof n.then?(!0!==i&&r._knownPropertyUpdate(e,t.id,void 0,o.ExternalContextResultStatus.Loading),n.then((function(n){r._knownPropertyUpdate(e,t.id,n,o.ExternalContextResultStatus.Success)}),(function(n){var i=r._convertToExternalContextError(r._getTelemetryComponentName(e,t.id,"KnownPropertyUpdate"),n,"NotifyUpdate: failed");r._knownPropertyUpdate(e,t.id,void 0,o.ExternalContextResultStatus.Failed,JSON.stringify(i))}))):r._knownPropertyUpdate(e,t.id,n,o.ExternalContextResultStatus.Success)}},t.prototype._setPropertyNotifyUpdate=function(e,t){var r=this;t.setNotifyUpdate(this._getPropertyNotifyUpdateFunction(e,t)),!t.onItemChanged&&t.updateOnItemChanged&&this.applicationContext.JsApiProvider.addItemChangedHandler((function(){t.notifyUpdate(t.accessor())})),t.dependsOnProperties&&t.dependsOnProperties.map((function(n){var o=n.propertyId,i=n.contextId;r._dependentProperties[i]||(r._dependentProperties[i]={}),r._dependentProperties[i][o]||(r._dependentProperties[i][o]=[]),r._dependentProperties[i][o].push({contextId:e,propertyId:t.id})}))},t.prototype._trimProcessedPropertyRequest=function(e,t){this._pendingPropertyRequests=this._pendingPropertyRequests.reduce((function(r,n){return n.contextId===e&&n.propertyId===t||r.push(n),r}),[])},t.prototype._setIsPropertyInitialized=function(e,t,r){this._initializedProperties[e]||(this._initializedProperties[e]={}),this._initializedProperties[e][t]=r},t.prototype._getIsPropertyInitialized=function(e,t){return!!this._initializedProperties[e]&&this._initializedProperties[e][t]},t.prototype._initializeProperty=function(e,t,r){var n=this;t.onItemChanged&&this.applicationContext.JsApiProvider.addItemChangedHandler((function(){t.onItemChanged()})),t.setNotifyUpdate&&this._setPropertyNotifyUpdate(e,t);var o=t.id,a=!0===t.pushToClient;if(this._setIsPropertyInitialized(e,o,!a),a)return this._getSafePropertyAccessorPromise(t).then((function(i){n._setIsPropertyInitialized(e,o,!0);var a=n._pendingPropertyRequests.filter((function(t){return t.contextId===e&&t.propertyId===o}));a.length>0&&(n._reportPropertyValue("Succesfully returned result for "+a.length+" pending properties",e,o,i,"Pending"),n._trimProcessedPropertyRequest(e,o),a.forEach((function(e){n._performSuccessCallback(e.onSuccessCallback,i)}))),(t.notifyUpdate?t.notifyUpdate:n._getPropertyNotifyUpdateFunction(e,t))(i),r.stop()})).catch((function(a){n._setIsPropertyInitialized(e,o,!0);var c=n._pendingPropertyRequests.filter((function(t){return t.contextId===e&&t.propertyId===o}));c.length>0&&(n._trimProcessedPropertyRequest(e,o),c.forEach((function(r){n._processPropertyFailure(n._getTelemetryComponentName(e,t.id,"Pending"),r.onErrorCallback,a)}))),r.stop();var l=s.ensureComponentErrorObject(a);throw n.applicationContext.EventManager.ReportComponentFailure(new i.ComponentError(n._getTelemetryComponentName(e,t.id,"InitialValue"),"Initial accessor failed. Reason: "+l.message,i.ErrorCode.GENERIC,l),[{name:u.ErrorEventParameterName.Error,value:a}]),l}))},t.prototype._extractPropertiesAccessors=function(e,t){var r=this;return this.applicationContext.EventManager.ReportTraceInfo(this.getTelemetryComponent()+".ExtractAllPropertiesAccessors","Extracting properties accessors for context "+t),e.concat(Object.keys(this._contexts[t].properties).reduce((function(e,n){var o=r._contexts[t].properties[n],i=o.dependsOnComponents&&o.dependsOnComponents.length>0,a=r.applicationContext.Performance.addStopwatch(r._getTelemetryComponentName(t,o.id,"InitialValue"));if(!i||r._isComponentsLoaded(o.dependsOnComponents)){var s=r._initializeProperty(t,o,a);s&&e.push(s)}else e.push(r._waitComponentsLoad(o.dependsOnComponents).then((function(){return r._initializeProperty(t,o,a)})));return e}),[]))},t.prototype._isComponentsLoaded=function(e){var t=this,r=!0;return e&&e.length>0&&e.forEach((function(e){r=r&&t.applicationContext.ComponentsLoader.isComponentLoaded(e)})),r},t.prototype._waitComponentsLoad=function(e){var t=this;if(e&&e.length>0){var r=[];if(e.forEach((function(e){t.applicationContext.ComponentsLoader.isComponentLoaded(e)||r.push(t.applicationContext.ComponentsLoader.ensureComponentLoaded(e))})),r.length>0)return Promise.all(r).then((function(){}))}return Promise.resolve()},t.prototype._processActionFailure=function(e,t,r){var n=this._convertToExternalContextError(e,r,"Invoke external context action failed");this.applicationContext.Bridge.performCallbackWithId(t,{error:n},!1,!0)},t.prototype._processPropertyFailure=function(e,t,r){var n=this._convertToExternalContextError(e,r,"Get external context property Failed");this.applicationContext.Bridge.performCallbackWithId(t,{error:n},!1,!0)},t.prototype._performSuccessCallback=function(e,t){this.applicationContext.Bridge.performCallbackWithId(e,{value:{value:t}},!1,!0)},t.prototype._reportTraceErrorTelemetry=function(e,t,r){var n=r?[{name:u.ErrorEventParameterName.Error,value:r}]:null;this.applicationContext.EventManager.ReportTraceError(new i.ComponentError(e,t,i.ErrorCode.GENERIC),n)},t.prototype._onBridgeLoaded=function(){var e=this,t=Object.keys(this._contexts).reduce(this._extractPropertiesAccessors.bind(this),[]);return Promise.all(t).then((function(){e.applicationContext.EventManager.ReportTraceInfo(e.getTelemetryComponent(),"All properties successfully extracted")})).catch((function(t){e._reportTraceErrorTelemetry(e.getTelemetryComponent(),"Exception happened during inital evaluation of the properties",t)}))},t.prototype._getSafePropertyAccessorPromise=function(e){try{return e.accessor()}catch(e){return Promise.reject(s.ensureComponentErrorObject(e))}},t.prototype._getSafeActionInvokerPromise=function(e,t){try{return e.invoker(t)}catch(e){return Promise.reject(s.ensureComponentErrorObject(e))}},t.prototype._getDataToReport=function(e,t){try{return t?t(e):e}catch(e){return null}},t.prototype._reportPropertyValue=function(e,t,r,n,o){var i=this._contexts[t].properties[r];this.applicationContext.EventManager.ReportComponentSuccess(this._getTelemetryComponentName(t,r,o),e,[{name:u.EventParameterName.Data,value:this._getDataToReport(n,i.serializeValue)}])},t.prototype._reportActionResult=function(e,t,r,n,o){var i=this._contexts[t].actions[r];this.applicationContext.EventManager.ReportComponentSuccess(this._getTelemetryComponentName(t,r,o),e,[{name:u.EventParameterName.Data,value:this._getDataToReport(n,i.serializeResult)}])},t.prototype._reportActionArguments=function(e,t,r,n){var o=this._contexts[e].actions[t];this.applicationContext.EventManager.ReportTraceInfo(this._getTelemetryComponentName(e,t,n),"Invoking external context Action",this._getDataToReport(r,o.serializeArguments))},t.prototype.getInitialState=function(){var e=this;return{AvailableExternalContexts:Object.keys(this._contexts).map((function(t){return{id:t,properties:Object.keys(e._contexts[t].properties),actions:Object.keys(e._contexts[t].actions)}})),KnownProperties:{}}},t.prototype.getExternalContextProperty=function(e){var t=this,r=e.callbacks,n=r.onSuccessCallback,o=r.onErrorCallback,i=e.args,a=i.externalContextId,s=i.externalContextPropertyId,u=i.args,c=this._contexts[a].properties[s];if(!this._getIsPropertyInitialized(a,s)&&!0===c.pushToClient)this._pendingPropertyRequests.push({contextId:a,propertyId:s,onSuccessCallback:n,onErrorCallback:o});else{this._externalContextDispatcherHelper.startTrackingExternalContextItemByHostActivityId(u);var l=this._getTelemetryComponentName(a,s,"GetValue"),p=this.applicationContext.Performance.addStopwatch(l),d=function(e){t._processPropertyFailure(l,o,e),p.stop(),t._externalContextDispatcherHelper.endTrackingExternalContextItemByHostActivityId(u)},f=function(){t.applicationContext.EventManager.ReportTraceInfo(l,"Requesting property"),t._getSafePropertyAccessorPromise(c).then((function(e){t._reportPropertyValue("Succesfully retrieved external context property",a,s,e,"GetValue"),t._performSuccessCallback(n,e),p.stop(),t._externalContextDispatcherHelper.endTrackingExternalContextItemByHostActivityId(u)})).catch(d)};this._isComponentsLoaded(c.dependsOnComponents)?f():this._waitComponentsLoad(c.dependsOnComponents).then(f).catch(d)}},t.prototype._getTelemetryComponentName=function(e,t,r){return this.getTelemetryComponent()+"."+e+"."+t+(r?"."+r:"")},t.prototype.invokeExternalContextAction=function(e){var t=this,r=e.callbacks,n=r.onSuccessCallback,o=r.onErrorCallback,i=e.args,a=i.externalContextId,s=i.externalContextActionId,u=i.args,c=this._contexts[a].actions[s],l=this._getTelemetryComponentName(a,s,"Invoke"),p=this.applicationContext.Performance.addStopwatch(l);this._externalContextDispatcherHelper.startTrackingExternalContextItemByHostActivityId(u);var d=function(e){t._processActionFailure(l,o,e),p.stop(),t._externalContextDispatcherHelper.endTrackingExternalContextItemByHostActivityId(u)},f=function(){t._reportActionArguments(a,s,u,"Invoke"),t._getSafeActionInvokerPromise(c,u).then((function(e){t._reportActionResult("Successfully invoked external context action",a,s,e,"Invoke"),t._performSuccessCallback(n,e),p.stop(),t._externalContextDispatcherHelper.endTrackingExternalContextItemByHostActivityId(u)})).catch(d)};this._isComponentsLoaded(c.dependsOnComponents)?f():this._waitComponentsLoad(c.dependsOnComponents).then(f).catch(d)},t.prototype.registerMethods=function(){this.registerMethodWithName("getExternalContextProperty",this.getExternalContextProperty,{externalContextId:"string",externalContextPropertyId:"string",args:{}},{onSuccessCallback:"",onErrorCallback:""}),this.registerMethodWithName("invokeExternalContextAction",this.invokeExternalContextAction,{externalContextId:"",externalContextActionId:"",args:{}},{onSuccessCallback:"",onErrorCallback:""})},t}(l.default);t.default=d}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(78)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){var n,o=r.default(e,t);return(n={})[o.id]=o,n}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(149),r(150),r(152),r(156),r(157),r(158),r(159),r(160),r(161),r(162),r(163),r(166),r(167),r(170)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c,l,p,d,f,h,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=[i.default,l.default,d.default,h.default,c.default,r.default,n.default,f.default,o.default,p.default,a.default,s.default,u.default,_.default]}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(1),r(4),r(0)],void 0===(o=function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="MailApp.ExternalContext.Actions.AddAttachments";t.default=function(e,t,s){return{id:r.ActionNames.ADD_ATTACHMENTS,invoker:function(e){var r=null;try{r=JSON.parse(e.attachments)}catch(r){return t.EventManager.ReportComponentFailure(new n.ComponentError(a,"Failed to parse 'attachments' JSON",n.ErrorCode.JSON_PARSE_FAILURE),[{name:o.ErrorEventParameterName.Error,value:r.message},{name:o.EventParameterName.Data,value:e.attachments}]),Promise.reject(null)}return r&&Array.isArray(r)&&0!==r.length?Promise.all(r.map((function(e){var r=e.name,n=e.url;return t.JsApiProvider.addFileAttachment(n,r)}))):(t.EventManager.ReportComponentFailure(new n.ComponentError(a,"Attachments array is empty",n.ErrorCode.GENERIC)),Promise.reject(null))},serializeArguments:function(e){var t=JSON.parse(e.attachments);if(!t||!Array.isArray(t)||0===t.length)return t.map((function(e){return e.url}))},dependsOnComponents:[i.default.JS_API_PROVIDER]}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(13),r(8),r(16),r(0),r(1)],void 0===(o=function(e,t,r,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,u){return{id:r.ActionNames.FOLLOW,invoker:function(e){var r=e.crmId;if(!r)return t.EventManager.ReportComponentFailure(new s.ComponentError("MailApp.ExternalContext.Actions.Follow",'Input arguments exception: "crmId" should be provided',s.ErrorCode.GENERIC)),Promise.reject(null);var a=t.JsApiProvider.getMailboxItemType(),u=[new n.default(i.default.ID,o.default.String,r,a),new n.default(i.default.IS_FOLLOWED,o.default.Integer,1..toString(),a)];return t.ExchangeProvider.MailboxItemProvider.setProperties(u)},dependsOnComponents:[a.default.EXCHANGE_PROVIDER]}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.APPEND_TO_ITEM_FIELD="AppendToItemField",e.SET_ITEM_FIELD="SetItemField",e.DELETE_ITEM_FIELD="DeleteItemField",e}();t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(1),r(3),r(51),r(5)],void 0===(o=function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,a){return{id:n.ActionNames.GET_EMAIL_LINKS,invoker:function(e){var n=e.crmId;return n?o.getUniqueHrefs(t,n):(t.EventManager.ReportComponentFailure(new r.ComponentError("MailApp.ExternalContext.Actions.GetEmailLinks",'Input arguments exception: "crmId" should be provided',r.ErrorCode.GENERIC)),Promise.reject(null))},serializeResult:i.default.restrictedValue}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){};t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NoEnd=1]="NoEnd",e[e.Numbered=2]="Numbered",e[e.EndDate=3]="EndDate"}(r||(r={})),t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Daily=0]="Daily",e[e.Weekly=1]="Weekly",e[e.Monthly=2]="Monthly",e[e.Yearly=3]="Yearly"}(r||(r={})),t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(3),r(0),r(5)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,i){return{id:r.ActionNames.INSERT_BODY,invoker:function(e){var r=e.value;return r?t.JsApiProvider.prependBody(r):(t.EventManager.ReportTraceInfo("MailApp.ExternalContext.Actions.InsertBody","Nothing to insert message/appointment body.",e),Promise.resolve())},dependsOnComponents:[n.default.JS_API_PROVIDER],serializeResult:o.default.restrictedValue,serializeArguments:o.default.restrictedValue}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(51),r(0),r(5),r(1)],void 0===(o=function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,s){return{id:r.ActionNames.REMOVE_TRACKING_INFO,invoker:function(e){var r=e.crmId;return r?n.removeTrackingInfo(t,r):(t.EventManager.ReportComponentFailure(new a.ComponentError("MailApp.ExternalContext.Actions.RemoveTrackingInfo",'Input arguments exception: "crmId" should be provided',a.ErrorCode.GENERIC)),Promise.reject(null))},dependsOnComponents:[o.default.JS_API_PROVIDER],serializeResult:i.default.restrictedValue}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(0),r(5),r(1)],void 0===(o=function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,a){return{id:r.ActionNames.RESOLVE_RECIPIENT_FROM_SCRATCH,invoker:function(e){var n=e.emailAddress;return n?t.CRMProvider.forceResolveRecipient(n).then((function(){a.properties[r.PropertyNames.RESOLVED_RECIPIENTS].notifyUpdate()})):(t.EventManager.ReportComponentFailure(new i.ComponentError("MailApp.ExternalContext.Actions.ResolveRecipients",'Input arguments exception: "emailAddress" should be provided',i.ErrorCode.GENERIC)),Promise.reject(null))},dependsOnComponents:[n.default.CRM_PROVIDER],serializeResult:o.default.restrictedValue,serializeArguments:o.default.restrictedValue}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(16),r(8),r(13),r(3),r(5)],void 0===(o=function(e,t,r,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,u){return{id:a.ActionNames.RETRY_TRACK,invoker:function(){var e=t.JsApiProvider.getMailboxItemType(),r=(new Date).toISOString(),s=[new i.default(n.default.TRACK_TIMESTAMP,o.default.String,r,e)];return t.ExchangeProvider.MailboxItemProvider.setProperties(s).then((function(){return u.properties[a.PropertyNames.TRACK_STATUS].accessor()}))},serializeResult:s.default.serializeTrackStatus,dependsOnComponents:[r.default.EXCHANGE_PROVIDER]}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(0),r(81),r(39),r(5),r(1)],void 0===(o=function(e,t,r,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u="MailApp.ExternalContext.Actions.SetSelectedRecipient";t.default=function(e,t,c){return{id:r.ActionNames.SET_SELECTED_RECIPIENT,invoker:function(e){var n=e.selectedRecipient;if(!n)return t.EventManager.ReportComponentFailure(new s.ComponentError(u,'Input arguments exception: "selectedRecipient" should be provided',s.ErrorCode.GENERIC)),Promise.reject(null);var a=t.JsApiProvider.getMailboxItemId().then((function(e){if(!e)return t.EventManager.ReportTraceError(new s.ComponentError(u,"Unable to set selected recipients because of empty item id",s.ErrorCode.GENERIC)),Promise.resolve();var r=o.default.deserialize(t.JsApiProvider.getRoamingSettingsItem(i.RoamingSettingKeys.selectedRecipientKey));return r.add(e,n),t.JsApiProvider.setRoamingSettingsItem(i.RoamingSettingKeys.selectedRecipientKey,r),t.JsApiProvider.saveRoamingSettingsAsync()}));return c.properties[r.PropertyNames.SELECTED_RECIPIENT].notifyUpdate(a.then((function(){return n}))),a},serializeResult:a.default.restrictedValue,serializeArguments:a.default.restrictedValue,dependsOnComponents:[n.default.EXCHANGE_PROVIDER]}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(0),r(5),r(1)],void 0===(o=function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,a){return{id:r.ActionNames.SET_SUBJECT,invoker:function(e){var r=e.value;return null==r?(t.EventManager.ReportComponentFailure(new i.ComponentError("MailApp.ExternalContext.Actions.SetSubject",'Input arguments exception: "value" should be provided',i.ErrorCode.GENERIC)),Promise.reject(null)):t.JsApiProvider.setSubject(r)},serializeResult:o.default.restrictedValue,serializeArguments:o.default.restrictedValue,dependsOnComponents:[n.default.JS_API_PROVIDER]}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(51),r(1),r(4),r(0)],void 0===(o=function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s="MailApp.ExternalContext.Actions.SetTrackingInfo";t.default=function(e,t,u){return{id:r.ActionNames.SET_TRACKING_INFO,invoker:function(e){var r=e.crmId,a=e.emailTrackingPixelUrl,u=e.emailLinkTrackingUrlPairsJSON;if(!r||!a)return t.EventManager.ReportComponentFailure(new o.ComponentError(s,'Input arguments exception: Both "crmId" and "emailTrackingPixelUrl" should be provided',o.ErrorCode.GENERIC),[{name:i.EventParameterName.Data,value:e}]),Promise.reject(null);var c=null;try{c=JSON.parse(u)}catch(e){return t.EventManager.ReportComponentFailure(new o.ComponentError(s,"Failed to parse JSON of emailLinkTrackingUrlPairsJSON",o.ErrorCode.JSON_PARSE_FAILURE),[{name:i.ErrorEventParameterName.Error,value:e}]),Promise.reject(null)}return n.setTrackingInfo(t,r,a,c)},serializeArgument:function(e){return{crmId:e.crmId,emailTrackingPixelUrl:e.emailTrackingPixelUrl}},dependsOnComponents:[a.default.JS_API_PROVIDER]}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(4),r(53),r(18),r(164),r(165),r(3),r(5),r(1),r(40),r(11)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c,l,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,f){return{id:u.ActionNames.TRACK,invoker:function(e){var r=e.id,c=e.entityType,h=e.name,_=e.trackingState,m=e.isTrackingStateUpdate;if(null==_)return t.EventManager.ReportComponentFailure(new l.ComponentError("MailApp.ExternalContext.Actions.Track",'Input arguments exception: "trackingState" should be provided',l.ErrorCode.GENERIC)),Promise.reject(null);if((!r||!c)&&(r||c))return t.EventManager.ReportComponentFailure(new l.ComponentError("MailApp.ExternalContext.Actions.Track",'You must provide both "id" and "entityType" parameters',l.ErrorCode.GENERIC),[{name:n.EventParameterName.Data,value:e}]),Promise.reject(null);if(m){var v=new o.default;return v.CrmId=e.crmId,v.CrmRegardingObjectId=r,v.CrmRegardingObjectName=h,v.CrmRegardingObjectType=c,v.CrmTrackingState=_,_===i.default.InProgress?t.ExchangeProvider.MailboxItemProvider.setPropertiesPending&&t.ExchangeProvider.MailboxItemProvider.setPropertiesPending(u.ActionNames.TRACK):t.ExchangeProvider.MailboxItemProvider.clearPropertiesPending&&t.ExchangeProvider.MailboxItemProvider.clearPropertiesPending(),f.properties[u.PropertyNames.TRACK_STATUS].notifyUpdate(v),Promise.resolve(null)}return t.CRMProvider.isFeatureControlBitEnabled(d.FcbNames.MailAppEnableCategoriesAPI).then((function(n){return n?s.default(t,f,_,r,c,h,e.crmId).then((function(e){return p.default(t,f,e,u.ActionNames.TRACK,s.categoriesFallback)})):_!==i.default.IsLinked?a.default(t,f,_,r,c,h,e.crmId,null):t.CRMProvider.isCategoryTrackingEnabled().then((function(n){return a.default(t,f,_,r,c,h,e.crmId,n)}))}))},serializeArguments:function(e){var t=Object.assign({},e);return t.name=c.default.restrictedValue(),t},serializeResult:c.default.serializeTrackStatus,dependsOnComponents:[r.default.JS_API_PROVIDER,r.default.CRM_PROVIDER,r.default.EXCHANGE_PROVIDER]}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(20),r(19),r(16),r(31),r(10),r(8),r(18),r(13),r(27),r(3)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c,l,p){"use strict";function d(e,t,d,f,h,_,m,v,g){var E,y,C=e.JsApiProvider.getMailboxItemType(),I=(new Date).toISOString(),P=(E=d.CrmTrackingState,(y=f)===u.default.WillBeLinked&&E===u.default.IsLinked?u.default.IsLinked:y),T=[new c.default(o.default.TRACKING_STATE,s.default.Double,P.toString(),C),new c.default(o.default.REGARDING_OBJECT_TYPE,s.default.String,_?_.toString():"",C),new c.default(o.default.REGARDING_ID,s.default.String,h||"",C),new c.default(o.default.REGARDING_OBJECT_NAME,s.default.String,m||"",C),new c.default(o.default.IS_TRACKED_FROM_MAILAPP,s.default.Integer,"1",C),new c.default(o.default.TRACK_TIMESTAMP,s.default.String,I,C)];g&&(T.push(new l.default(n.default.CATEGORIES,s.default.Item,g,C)),T.push(new c.default(o.default.CRM_CATEGORY_TRACKER,s.default.Integer,i.default.IsLinked.toString(),C))),v&&(v=r.default.fromExternalGuid(v).guid,T.push(new c.default(o.default.ID,s.default.String,v,C)));var A=f===u.default.IsLinked?"0":"1";return T.push(new c.default(o.default.TRACKING_STATE_TRACKER,s.default.Integer,A,C)),f===u.default.IsLinked&&C===a.default[a.default.appointment]&&T.push(new c.default(o.default.SSS_PROMOTE_TRACKER,s.default.Integer,"1",C)),e.ExchangeProvider.MailboxItemProvider.setProperties(T).then((function(){return t.properties[p.PropertyNames.TRACK_STATUS].accessor()}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,n,o,i,a,s){return s?Promise.all([e.ExchangeProvider.MailboxItemProvider.retrieveTrackStatus(),e.ExchangeProvider.MailboxItemProvider.retrieveMailboxItem(),e.CRMProvider.getMailboxTrackingCategoryName()]).then((function(s){var u=s[0],c=s[1],l=s[2],p=c.Categories?c.Categories:[],f=null;return l&&-1===p.indexOf(l)&&(f=p.concat([l])),d(e,t,u,r,n,o,i,a,f)})):e.ExchangeProvider.MailboxItemProvider.retrieveTrackStatus().then((function(s){return d(e,t,s,r,n,o,i,a,null)}))}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(20),r(19),r(16),r(31),r(10),r(8),r(18),r(13),r(27),r(6),r(40)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c,l,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.categoriesFallback=function(e,t){var r=e.filter((function(e){return e.propertyName!==n.default.CATEGORIES}));return p.default.assignUpdates(r,[new c.default(o.default.CRM_CATEGORY_TRACKER,s.default.Integer,i.default.NotLinked.toString(),t)],d.comparePropertyUpdate)},t.default=function(e,t,f,h,_,m,v){return function(e,t){return e.CRMProvider.isCategoryTrackingEnabled().then((function(r){var n=[e.ExchangeProvider.MailboxItemProvider.retrieveTrackStatus()];return r&&t===u.default.IsLinked&&n.push(e.ExchangeProvider.MailboxItemProvider.retrieveMailboxItem(),e.CRMProvider.getMailboxTrackingCategoryName()),Promise.all(n).then((function(e){var t=e[0],r=e[1],n=e[2];return[t,r&&function(e,t){void 0===e&&(e=[]);var r=null;t&&-1===e.indexOf(t)&&(r=e.concat([t]));return r}(r.Categories,n)]}))}))}(e,f).then((function(t){var g=t[0],E=t[1],y=e.JsApiProvider.getMailboxItemType(),C=function(e,t,n,i,l,p,d,f,h){var _=(new Date).toISOString(),m=(E=i.CrmTrackingState,y=l,y===u.default.WillBeLinked&&E===u.default.IsLinked?u.default.IsLinked:y),v=l===u.default.IsLinked?"0":"1",g=[new c.default(o.default.TRACKING_STATE,s.default.Double,m.toString(),n),new c.default(o.default.REGARDING_OBJECT_TYPE,s.default.String,d?d.toString():"",n),new c.default(o.default.REGARDING_ID,s.default.String,p||"",n),new c.default(o.default.REGARDING_OBJECT_NAME,s.default.String,f||"",n),new c.default(o.default.IS_TRACKED_FROM_MAILAPP,s.default.Integer,"1",n),new c.default(o.default.TRACK_TIMESTAMP,s.default.String,_,n),new c.default(o.default.TRACKING_STATE_TRACKER,s.default.Integer,v,n)];var E,y;h&&(h=r.default.fromExternalGuid(h).guid,g.push(new c.default(o.default.ID,s.default.String,h,n)));l===u.default.IsLinked&&n===a.default[a.default.appointment]&&g.push(new c.default(o.default.SSS_PROMOTE_TRACKER,s.default.Integer,"1",n));return g}(0,0,y,g,f,h,_,m,v);if(E){var I=function(e,t){return[new l.default(n.default.CATEGORIES,s.default.Item,e,t),new c.default(o.default.CRM_CATEGORY_TRACKER,s.default.Integer,i.default.IsLinked.toString(),t)]}(E,y);return p.default.assignUpdates(C,I,d.comparePropertyUpdate)}return C}))}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(16),r(8),r(13),r(3),r(0)],void 0===(o=function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,s){return{id:i.ActionNames.UNFOLLOW,invoker:function(){var e=t.JsApiProvider.getMailboxItemType(),i=[new o.default(r.default.ID,n.default.String,"",e),new o.default(r.default.IS_FOLLOWED,n.default.Integer,(0).toString(),e)];return t.ExchangeProvider.MailboxItemProvider.setProperties(i)},dependsOnComponents:[a.default.EXCHANGE_PROVIDER]}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(168),r(169),r(3),r(1),r(5),r(40),r(11)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,l){return{id:i.ActionNames.UNTRACK,invoker:function(e){var r=e.trackingState;return null==r?Promise.reject(new a.ComponentError("MailApp.ExternalContext.Actions.Untrack",'Input arguments exception: "trackingState" should be provided',a.ErrorCode.GENERIC)):t.CRMProvider.isFeatureControlBitEnabled(c.FcbNames.MailAppEnableCategoriesAPI).then((function(e){return e?o.default(t,l,r).then((function(e){return u.default(t,l,e,i.ActionNames.UNTRACK,o.categoriesFallback)})):t.CRMProvider.isCategoryTrackingEnabled().then((function(e){return n.default(t,l,r,e)}))}))},serializeResult:s.default.serializeTrackStatus,dependsOnComponents:[r.default.JS_API_PROVIDER,r.default.CRM_PROVIDER]}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(19),r(16),r(31),r(8),r(18),r(13),r(27),r(3)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c){"use strict";function l(e,t,l,p,d){void 0===d&&(d=!1);var f=e.JsApiProvider.getMailboxItemType(),h=(new Date).toISOString(),_=[new s.default(n.default.TRACKING_STATE,i.default.Double,l.toString(),f),new s.default(n.default.REGARDING_OBJECT_TYPE,i.default.String,"",f),new s.default(n.default.REGARDING_ID,i.default.String,"",f),new s.default(n.default.REGARDING_OBJECT_NAME,i.default.String,"",f),new s.default(n.default.TRACK_TIMESTAMP,i.default.String,h,f)];p&&_.push(new u.default(r.default.CATEGORIES,i.default.Item,p,f)),d&&_.push(new s.default(n.default.CRM_CATEGORY_TRACKER,i.default.Integer,o.default.NotLinked.toString(),f)),l===a.default.NotLinked&&_.push(new s.default(n.default.ID,i.default.String,"",f));var m=l===a.default.NotLinked?"0":"1";return _.push(new s.default(n.default.TRACKING_STATE_TRACKER,i.default.Integer,m,f)),e.ExchangeProvider.MailboxItemProvider.setProperties(_).then((function(){return t.properties[c.PropertyNames.TRACK_STATUS].accessor()}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,n){return n?Promise.all([e.CRMProvider.getMailboxTrackingCategoryName(),e.ExchangeProvider.MailboxItemProvider.retrieveMailboxItem(),e.ExchangeProvider.MailboxItemProvider.retrieveTrackStatus()]).then((function(n){var o=n[0],i=n[1],a=n[2],s=[].concat(i.Categories),u=s.indexOf(o);-1!==u&&s.splice(u,1);var c=void 0!==a.CrmCategoryTracker;return l(e,t,r,s,c)})):l(e,t,r,null)}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(19),r(16),r(31),r(8),r(18),r(13),r(27),r(6),r(40)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.categoriesFallback=function(e,t){var o=e.find((function(e){return e.propertyName===n.default.TRACKING_STATE})),u=e.filter((function(e){return-1===[r.default.CATEGORIES,n.default.CRM_CATEGORY_TRACKER].indexOf(e.propertyName)})),p=o.propertyValue===a.default.NotLinked.toString()?new s.default(n.default.TRACKING_STATE,i.default.Integer,a.default.WillBeUnlinked.toString(),t):new s.default(n.default.TRACKING_STATE_TRACKER,i.default.Integer,"0",t);return c.default.assignUpdates(u,[p],l.comparePropertyUpdate)},t.default=function(e,t,p){return function(e){return e.CRMProvider.isCategoryTrackingEnabled().then((function(t){var r=[];return t&&r.push(e.ExchangeProvider.MailboxItemProvider.retrieveTrackStatus(),e.ExchangeProvider.MailboxItemProvider.retrieveMailboxItem(),e.CRMProvider.getMailboxTrackingCategoryName()),Promise.all(r).then((function(e){var t=e[0],r=e[1],n=e[2];return[t,r&&function(e,t){void 0===e&&(e=[]);var r=Array.from(e),n=r.indexOf(t);-1!==n&&r.splice(n,1);return r}(r.Categories,n)]}))}))}(e).then((function(t){var d=t[0],f=t[1],h=e.JsApiProvider.getMailboxItemType(),_=function(e,t){var r=(new Date).toISOString(),o=t===a.default.NotLinked?"0":"1",u=[new s.default(n.default.TRACKING_STATE,i.default.Double,t.toString(),e),new s.default(n.default.REGARDING_OBJECT_TYPE,i.default.String,"",e),new s.default(n.default.REGARDING_ID,i.default.String,"",e),new s.default(n.default.REGARDING_OBJECT_NAME,i.default.String,"",e),new s.default(n.default.TRACK_TIMESTAMP,i.default.String,r,e),new s.default(n.default.TRACKING_STATE_TRACKER,i.default.Integer,o,e)];t===a.default.NotLinked&&u.push(new s.default(n.default.ID,i.default.String,"",e));return u}(h,p);if(f){var m=function(e,t,a){var c=[new u.default(r.default.CATEGORIES,i.default.Item,e,t)];void 0!==a.CrmCategoryTracker&&c.push(new s.default(n.default.CRM_CATEGORY_TRACKER,i.default.Integer,o.default.NotLinked.toString(),t));return c}(f,h,d);return c.default.assignUpdates(_,m,l.comparePropertyUpdate)}return _}))}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(1)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="MailApp.ExternalContext.Actions.AppCheckerTask";t.default=function(e,t,i){return{id:r.ActionNames.OPEN_APPCHECKER,invoker:function(e){try{t.EventManager.ReportTraceInfo(o,"Open outlook checker from see why Link");var r=e.openDiagnosticsPage;return t.AppChecker.toggle(r),Promise.resolve()}catch(e){var i=new n.ComponentError(o,"Failed to open appChecker via external context action",n.ErrorCode.GENERIC,e);return Promise.reject(i)}}}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(172),r(173),r(174),r(175),r(176),r(177),r(178),r(179),r(180),r(181),r(182),r(183),r(184),r(185),r(186),r(187),r(188),r(189),r(190),r(191),r(192),r(194),r(196),r(197),r(198),r(199),r(200)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c,l,p,d,f,h,_,m,v,g,E,y,C,I,P,T,A,R,S,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=[o.default,n.default,C.default,a.default,m.default,P.default,c.default,d.default,f.default,h.default,_.default,p.default,l.default,s.default,y.default,r.default,v.default,i.default,g.default,u.default,T.default,I.default,A.default,R.default,E.default,S.default,O.default]}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(10),r(1),r(0)],void 0===(o=function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="MailApp.ExternalContext.Property.AttachmentIds";t.default=function(e,t){return{id:r.PropertyNames.ATTACHMENT_IDS,accessor:function(){try{var e=t.JsApiProvider.getMailboxItemType();if(e===n.default[n.default.message])return t.JsApiProvider.getMessageAttachmentIds();if(e===n.default[n.default.appointment])return t.ExchangeProvider.MailboxItemProvider.getAttachmentIds();var r="Attachments ids retrieval is not supported for "+e+" item type.";return t.EventManager.ReportTraceWarning(a,r),Promise.reject(new o.ComponentError(a,r,o.ErrorCode.GENERIC))}catch(e){return Promise.reject(e)}},dependsOnComponents:[i.default.JS_API_PROVIDER,i.default.EXCHANGE_PROVIDER]}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(0),r(5)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:r.PropertyNames.EWS_TOKEN,accessor:function(){return t.JsApiProvider.getEwsToken()},dependsOnComponents:[n.default.JS_API_PROVIDER],serializeValue:o.default.restrictedValue}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(0)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:r.PropertyNames.EWS_URL,accessor:function(){return Promise.resolve(t.JsApiProvider.getEwsUrl())},pushToClient:!0,dependsOnComponents:[n.default.JS_API_PROVIDER]}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(54),r(0),r(5)],void 0===(o=function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:r.PropertyNames.HTML_BODY,accessor:function(){return t.JsApiProvider.getBody(n.default.Html)},dependsOnComponents:[o.default.JS_API_PROVIDER],serializeValue:i.default.restrictedValue}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(0)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:r.PropertyNames.IS_COMPOSE_MODE,accessor:function(){return Promise.resolve(t.JsApiProvider.isComposeMode())},pushToClient:!0,dependsOnComponents:[n.default.JS_API_PROVIDER]}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(25),r(0)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:r.PropertyNames.IS_DELEGATED_MAILBOX,accessor:function(){return Promise.all([t.JsApiProvider.isDelegatedMailbox(),t.CRMProvider.isOrgSettingEnabled(n.DelegateAccessEnabled)]).then((function(e){var t=e[0],r=e[1];return t&&r}))},pushToClient:!1,dependsOnComponents:[o.default.JS_API_PROVIDER,o.default.CRM_PROVIDER]}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(0)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:r.PropertyNames.IS_DESKTOP_OUTLOOK,accessor:function(){return Promise.resolve(t.JsApiProvider.getIsDesktopOutlook())},pushToClient:!0,dependsOnComponents:[n.default.JS_API_PROVIDER]}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(0),r(82)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:r.PropertyNames.IS_ORGANIZER_RESOLVED_AS_USER,accessor:function(){return t.CRMProvider.resolveRecipients().then((function(e){var t=e.recipients;return o.default(t)}))},dependsOnComponents:[n.default.CRM_PROVIDER]}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(0),r(5)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){var i={id:r.PropertyNames.IS_SENT,accessor:function(){return t.JsApiProvider.isSent()},pushToClient:!0,updateOnItemChanged:!0,setNotifyUpdate:function(e){o.default.defaultSetNotifyUpdate(i,e)},dependsOnComponents:[n.default.JS_API_PROVIDER]};return i}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(0)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:r.PropertyNames.ITEM_TYPE,accessor:function(){return Promise.resolve(t.JsApiProvider.getMailboxItemType())},pushToClient:!0,dependsOnComponents:[n.default.JS_API_PROVIDER]}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(5),r(0)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){var i=!1,a={id:r.PropertyNames.MAILBOX_ITEM,accessor:function(){return t.ExchangeProvider.MailboxItemProvider.retrieveMailboxItem()},onItemChanged:function(){a.notifyUpdate(new Promise((function(){}))),i=!0},setNotifyUpdate:function(e){n.default.defaultSetNotifyUpdate(a,e),t.ExchangeProvider.MailboxItemProvider.addItemChangedListener((function(t){(t.isMailboxItemUpdated||i)&&(e(Promise.resolve(t.mailboxItem)),i=!1)}))},pushToClient:!0,dependsOnComponents:[o.default.EXCHANGE_PROVIDER],serializeValue:n.default.serializeMailboxItem};return a}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(0),r(5)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:r.PropertyNames.MAILBOX_ITEM_FROM_SERVER,accessor:function(){return t.ExchangeProvider.MailboxItemProvider.retrieveMailboxItem()},dependsOnComponents:[n.default.EXCHANGE_PROVIDER],serializeValue:o.default.serializeMailboxItem}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(35),r(3),r(5),r(0)],void 0===(o=function(e,t,r,n,o,i){"use strict";function a(e,t){return!e&&!t||!(!e&&t||e&&!t)&&(r.default.areEmailAddressDetailsEqual(e.sender,t.sender)&&r.default.areEmailAddressDetailsEqual(e.organizer,t.organizer)&&r.default.areEmailAddressDetailsArraysEqual(e.optionalAttendees,t.optionalAttendees)&&r.default.areEmailAddressDetailsArraysEqual(e.requiredAttendees,t.requiredAttendees))}function s(e){return{sender:r.default.cloneEmailAddressDetails(e.sender),organizer:r.default.cloneEmailAddressDetails(e.organizer),optionalAttendees:e.optionalAttendees&&r.default.cloneEmailAddressDetailsArray(e.optionalAttendees),requiredAttendees:e.requiredAttendees&&r.default.cloneEmailAddressDetailsArray(e.requiredAttendees)}}Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){if(!t.JsApiProvider.isAppointment())return null;var r={id:n.PropertyNames.MEETING_ATTENDEES,accessor:function(){return t.JsApiProvider.getMeetingAttendees()},pushToClient:!0,updateOnItemChanged:!0,dependsOnComponents:[i.default.JS_API_PROVIDER],serializeValue:function(e){return{sender:o.default.serializeEmailAddressDetails(e.sender),organizer:o.default.serializeEmailAddressDetails(e.organizer),optionalAttendees:e.optionalAttendees?e.optionalAttendees.map(o.default.serializeEmailAddressDetails):null,requiredAttendees:e.requiredAttendees?e.requiredAttendees.map(o.default.serializeEmailAddressDetails):null}}};return r.setNotifyUpdate=o.default.createRecipientsPollingFunction(r,t,s,a),r}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(5),r(0)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return t.JsApiProvider.isAppointment()?{id:r.PropertyNames.ROOM_MAILBOXES,accessor:function(){return t.JsApiProvider.getRoomMailboxes().catch((function(){return[]}))},pushToClient:!0,updateOnItemChanged:!0,dependsOnComponents:[o.default.JS_API_PROVIDER],serializeValue:function(e){return void 0===e&&(e=[]),e.map(n.default.serializeEmailAddressDetails)}}:null}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(35),r(3),r(5),r(0)],void 0===(o=function(e,t,r,n,o,i){"use strict";function a(e,t){return!e&&!t||!(!e&&t||e&&!t)&&(r.default.areEmailAddressDetailsEqual(e.sender,t.sender)&&r.default.areEmailAddressDetailsArraysEqual(e.to,t.to)&&r.default.areEmailAddressDetailsArraysEqual(e.cc,t.cc)&&r.default.areEmailAddressDetailsArraysEqual(e.bcc,t.bcc))}function s(e){var t=function(e){return e.map((function(e){return e&&{emailAddress:e.emailAddress,displayName:e.displayName,recipientType:e.recipientType}}))};return{sender:e.sender&&{emailAddress:e.sender.emailAddress,displayName:e.sender.displayName,recipientType:e.sender.recipientType},to:e.to&&t(e.to),cc:e.cc&&t(e.cc),bcc:e.bcc&&t(e.bcc)}}Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){if(!t.JsApiProvider.isMessage())return null;var r={id:n.PropertyNames.MESSAGE_RECIPIENTS,accessor:function(){return t.JsApiProvider.getMessageRecipients()},pushToClient:!0,updateOnItemChanged:!0,dependsOnComponents:[i.default.JS_API_PROVIDER],serializeValue:function(e){return{sender:o.default.serializeEmailAddressDetails(e.sender),to:e.to?e.to.map(o.default.serializeEmailAddressDetails):null,cc:e.cc?e.cc.map(o.default.serializeEmailAddressDetails):null,bcc:e.bcc?e.bcc.map(o.default.serializeEmailAddressDetails):null}}};return r.setNotifyUpdate=o.default.createRecipientsPollingFunction(r,t,s,a),r}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(54),r(0),r(5)],void 0===(o=function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:r.PropertyNames.PLAIN_BODY,accessor:function(){return t.JsApiProvider.getBody(n.default.Text)},dependsOnComponents:[o.default.JS_API_PROVIDER],serializeValue:i.default.restrictedValue}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(0),r(7)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){var i=n.default.DISPATCHER+"."+o.default.EXTERNAL_CONTEXT+".Property."+r.PropertyNames.RECEIVED_ON;return{id:r.PropertyNames.RECEIVED_ON,accessor:function(){return t.ExchangeProvider.MailboxItemProvider.retrieveMailboxItem().then((function(e){var r=e.DateTimeReceived;if(r)return r;var n=t.JsApiProvider.getMailboxItem(),o=n&&n.dateTimeCreated;return t.EventManager.ReportTraceWarning(i,"Couldn't get DateTimeReceived property from exchange, fallback to dateTimeCreated property from OfficeJs",{dateTimeCreated:o}),o}))},dependsOnComponents:[n.default.JS_API_PROVIDER]}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(5),r(78),r(3),r(0)],void 0===(o=function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){var a={id:o.PropertyNames.RESOLVED_RECIPIENTS,accessor:function(){return t.CRMProvider.resolveRecipients().then((function(e){return{isNewMailboxItem:!1,recipients:e.recipients}}))},pushToClient:!0,dependsOnProperties:[{contextId:n.MAIL_CONTEXT,propertyId:o.PropertyNames.MESSAGE_RECIPIENTS},{contextId:n.MAIL_CONTEXT,propertyId:o.PropertyNames.MEETING_ATTENDEES}],setNotifyUpdate:function(e){r.default.defaultSetNotifyUpdate(a,e)},onDependentProperyUpdate:function(){t.CRMProvider.resolveRecipients().then((function(e){e&&e.isChanged&&a.notifyUpdate({isNewMailboxItem:!1,recipients:e.recipients})})).catch((function(e){a.notifyUpdate(Promise.reject(e),!0)}))},serializeValue:function(e){return{isNewMailboxItem:e.isNewMailboxItem,recipients:e.recipients?e.recipients.map(r.default.serializeRecipientRecord):null}},dependsOnComponents:[i.default.CRM_PROVIDER,i.default.JS_API_PROVIDER]};return a}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(5),r(0),r(81),r(39)],void 0===(o=function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){var s={id:r.PropertyNames.SELECTED_RECIPIENT,accessor:function(){return t.JsApiProvider.getMailboxItemId().then((function(e){var r=t.JsApiProvider.getRoamingSettingsItem(a.RoamingSettingKeys.selectedRecipientKey);return i.default.deserialize(r).getEmail(e)}))},pushToClient:!0,updateOnItemChanged:!0,setNotifyUpdate:function(e){n.default.defaultSetNotifyUpdate(s,e)},dependsOnComponents:[o.default.JS_API_PROVIDER,o.default.EXCHANGE_PROVIDER],serializeValue:n.default.restrictedValue};return s}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(0),r(5)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:r.PropertyNames.SUBJECT,accessor:function(){return t.JsApiProvider.getSubject()},dependsOnComponents:[n.default.JS_API_PROVIDER],serializeValue:o.default.restrictedValue}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(49),r(25),r(55),r(10),r(5),r(82),r(3),r(193),r(0)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){var p={id:u.PropertyNames.TRACK_ALLOWED_STATUS,accessor:function(){return Promise.all([t.ExchangeProvider.MailboxItemProvider.retrieveMailboxItem(),t.CRMProvider.isLimitedMode(),t.CRMProvider.isOrgSettingEnabled(n.EmailInReadModeTrackEnabled)]).then((function(a){var u=a[0],l=a[1],p=a[2],d=i.default[t.JsApiProvider.getMailboxItemType()];if(l&&(!r.isTrackAllowedInLimitedMode(d,e.mode)||!p))return c.default.ForbiddenInLimitedMode;return d===i.default.message?function(e){return e.ItemClass&&-1!==e.ItemClass.indexOf("IPM.Schedule")?"IPM.Schedule.Meeting.Request"===e.ItemClass?c.default.ForbiddenMeetingInviteRequest:c.default.ForbiddenMeetingInviteResponse:c.default.Allowed}(u):d===i.default.appointment?function(e,t){return t.CalendarItemType===o.default[o.default.Occurrence]?Promise.resolve(c.default.ForbiddenOccurence):t.CalendarItemType===o.default[o.default.Exception]?Promise.resolve(c.default.ForbiddenException):Promise.all([e.CRMProvider.resolveRecipients(),e.CRMProvider.isOrgSettingEnabled(n.TrackAppointmentsFromNonOrganizer),e.CRMProvider.isOrgSettingEnabled(n.DelegateAccessEnabled),e.JsApiProvider.isDelegatedMailbox()]).then((function(e){var t=e[0].recipients,r=e[1],n=e[2],o=e[3];return r?c.default.Allowed:n&&o?c.default.Allowed:s.default(t)?c.default.ForbiddenForOrganizerResolvedAsUser:c.default.Allowed}))}(t,u):void 0}))},pushToClient:!0,onItemChanged:function(){p.notifyUpdate(new Promise((function(){})))},setNotifyUpdate:function(e){a.default.defaultSetNotifyUpdate(p,e),t.ExchangeProvider.MailboxItemProvider.addItemChangedListener((function(t){t.isMailboxItemChanged&&e(p.accessor())}))},dependsOnComponents:[l.default.JS_API_PROVIDER,l.default.CRM_PROVIDER,l.default.EXCHANGE_PROVIDER],serializeValue:function(e){return c.default[e]}};return p}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Allowed=1]="Allowed",e[e.ForbiddenOccurence=2]="ForbiddenOccurence",e[e.ForbiddenMeetingInviteRequest=3]="ForbiddenMeetingInviteRequest",e[e.ForbiddenMeetingInviteResponse=4]="ForbiddenMeetingInviteResponse",e[e.ForbiddenForOrganizerResolvedAsUser=5]="ForbiddenForOrganizerResolvedAsUser",e[e.ForbiddenInLimitedMode=6]="ForbiddenInLimitedMode",e[e.ForbiddenException=7]="ForbiddenException"}(r||(r={})),t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(0),r(7),r(5),r(83),r(195),r(3),r(11)],void 0===(o=function(e,t,r,n,o,i,a,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=r.default.DISPATCHER+"."+n.default.EXTERNAL_CONTEXT+".Property."+s.PropertyNames.TRACK_STATUS;t.default=function(e,t){var n=t.ComponentsLoader.ensureComponentLoaded(r.default.CRM_PROVIDER).then((function(){return t.CRMProvider.isFeatureControlBitEnabled(u.FcbNames.MailAppEnableCategoriesAPI).then((function(e){return e?new a.default(t,c):new i.default(t,c)}))})),l={id:s.PropertyNames.TRACK_STATUS,accessor:function(){return n.then((function(e){return e.getTrackStatus()}))},pushToClient:!0,onItemChanged:function(){l.notifyUpdate(new Promise((function(){})))},setNotifyUpdate:function(e){o.default.defaultSetNotifyUpdate(l,e),n.then((function(t){return t.subscribe(e)}))},dependsOnComponents:[r.default.JS_API_PROVIDER,r.default.EXCHANGE_PROVIDER,r.default.CRM_PROVIDER],serializeValue:o.default.serializeTrackStatus};return l}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(18),r(31),r(83)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype._updateTrackStatusBasedOnCategories=function(e){var t="",o=this._mailboxItem.Categories||[],i=o.length>0&&-1!==o.indexOf(this._mailboxTrackingCategoryName),a=e.CrmTrackingState===r.default.IsLinked,s=e.CrmTrackingState===r.default.WillBeLinked,u=-1!==[r.default.WillBeUnlinked,r.default.WillBeUnlinkedAndDeleted].indexOf(e.CrmTrackingState)&&0===e.TrackingStateTracker,c=r.default[e.CrmTrackingState];if(!i||a||s||u||(t="User tracked the item using category without Mail App.",e.CrmTrackingState=r.default.WillBeLinked),e.CrmCategoryTracker!==n.default.IsLinked||i||!a&&!s||(t="Category is not present on the item.",e.CrmTrackingState=r.default.WillBeUnlinked),t){var l=r.default[e.CrmTrackingState];this._applicationContext.EventManager.ReportTraceInfo(this._telemetryBaseComponentName+".CategoriesTracking","Tracking state updated: '"+t+"'",{originalTrackingState:c,newTrackingState:l})}return e},t}(o.default);t.default=i}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(0),r(5)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:r.PropertyNames.USER_PROFILE_EMAIL_ADDRESS,accessor:function(){return Promise.resolve(t.JsApiProvider.getUserEmailAddress())},pushToClient:!0,dependsOnComponents:[n.default.JS_API_PROVIDER],serializeValue:o.default.restrictedValue}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(0)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:r.PropertyNames.IS_LIMITED_MODE,accessor:function(){return t.CRMProvider.isLimitedMode()},pushToClient:!0,dependsOnComponents:[n.default.CRM_PROVIDER]}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(0)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){t.EventManager&&t.EventManager.getSessionId();return{id:r.PropertyNames.LIMITED_MODE_NOTIFICATION_STATE,accessor:function(){return Promise.resolve({hasBeenClosed:!0,helpLink:null})},pushToClient:!0,dependsOnComponents:[n.default.JS_API_PROVIDER]}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(25),r(0)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:r.PropertyNames.KNOWN_ORG_SETTINGS,accessor:function(){return t.CRMProvider.isOrgSettingsEnabled([n.TrackCategorizedItems,n.TrackAppointmentsFromNonOrganizer,n.DelegateAccessEnabled,n.CreateContactWithoutTracking,n.EmailInReadModeTrackEnabled,n.OverrideTrackInCrmBehaviour])},pushToClient:!0,dependsOnComponents:[o.default.CRM_PROVIDER]}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(3),r(0)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return{id:r.PropertyNames.IS_CHECKER_COMMAND_VISIBLE,accessor:function(){return Promise.resolve(t.AppChecker.getCheckerCommandState())},pushToClient:!0,dependsOnComponents:[n.default.JS_API_PROVIDER]}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Loading=0]="Loading",e[e.Success=1]="Success",e[e.Failed=2]="Failed"}(t.ExternalContextResultStatus||(t.ExternalContextResultStatus={}))}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._itemsInProgressCounter=0,this._applicationContext=e}return e.prototype.startTrackingExternalContextItemByHostActivityId=function(e){var t;(null===(t=e)||void 0===t?void 0:t.hostActivityId)&&(this._itemsInProgressCounter++,this._applicationContext.ExchangeProvider.MailboxItemProvider.pausePolling(),this._applicationContext.EventManager.setHostActivityId(e.hostActivityId))},e.prototype.endTrackingExternalContextItemByHostActivityId=function(e){var t;(null===(t=e)||void 0===t?void 0:t.hostActivityId)&&(1===this._itemsInProgressCounter&&(this._applicationContext.EventManager.resetHostActivityId(),this._applicationContext.ExchangeProvider.MailboxItemProvider.restartPolling()),this._itemsInProgressCounter--)},e}();t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(0),r(1),r(204),r(209),r(41),r(4),r(7),r(15),r(6),r(30)],void 0===(o=function(e,t,r,n,o,i,s,u,c,l,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.namespace=c.default.CONTACTS_MODULE,n}return a(t,e),t.prototype._displayNewAppointmentForm=function(e){var t=e.args.AppointmentParameters;this.applicationContext.JsApiProvider.displayNewAppointmentForm(t)},t.prototype._getContacts=function(e){var t=this,r=new o.default(e.args.Parameters);this.applicationContext.ExchangeProvider.ContactsModuleProvider.getContacts(r).then((function(r){t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onSuccess,r,!0)}),(function(r){var o=[{name:u.ErrorEventParameterName.Error,value:r}];t.applicationContext.EventManager.ReportComponentFailure(new n.ComponentError(t.getTelemetryComponent()+".GetContacts","Failed to get contact records",n.ErrorCode.GENERIC),o),t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onFailure,{},!0)}))},t.prototype._updateContactProperties=function(e){var t=this,r=e.args.uniqueDispatchKey?e.args.uniqueDispatchKey:"",o=new i.default(e.args.Parameters);this.applicationContext.ExchangeProvider.ContactsModuleProvider.updateContactProperties(o).then((function(){t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onSuccess,{uniqueDispatchKey:r},!0)}),(function(o){var i=[{name:u.ErrorEventParameterName.Error,value:o}];t.applicationContext.EventManager.ReportComponentFailure(new n.ComponentError(t.getTelemetryComponent()+".UpdateContactProperties","Failed to update contact properties",n.ErrorCode.GENERIC),i),t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onFailure,{uniqueDispatchKey:r},!0)}))},t.prototype._getRoamingSettingsItem=function(e){var t=e.args.key,r=this.applicationContext.JsApiProvider.getRoamingSettingsItem(t);this.applicationContext.Bridge.performCallbackWithId(e.callbacks.onSuccess,{result:r},!0)},t.prototype._saveRoamingSettingsAsync=function(e){var t=this;this.applicationContext.JsApiProvider.setRoamingSettingsItem(e.args.key,e.args.value),this.applicationContext.JsApiProvider.saveRoamingSettingsAsync().then((function(){t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onSuccess,{},!0)}),(function(){t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onFailure,{},!0)}))},t.prototype._sendTelemetryEvents=function(e){var t=e.args.events;if(t&&t.length)for(var o in t){var i=t[o],a=[],c=r.default.CONTACT_TRACKING_MODULE+"."+i.component;switch(i.data&&a.push({name:u.EventParameterName.Data,value:i.data}),i.error&&a.push({name:u.ErrorEventParameterName.Error,value:i.error}),i.name){case u.EVENT_NAME.MonitorSuccess:this.applicationContext.EventManager.ReportComponentSuccess(c,null,a);break;case u.EVENT_NAME.MonitorFailure:this.applicationContext.EventManager.ReportComponentFailure(new n.ComponentError(c,i.message,n.ErrorCode.GENERIC),a);break;case u.EVENT_NAME.Performance:this.applicationContext.EventManager.ReportComponentPerformance(c,{name:i.metricName,startTime:i.startTime,stopTime:i.stopTime},a);break;case u.EVENT_NAME.TraceEvent:switch(i.level){case s.ApplicationEventLevel.Error:this.applicationContext.EventManager.ReportTraceError(new n.ComponentError(c,i.message,n.ErrorCode.GENERIC),a);case s.ApplicationEventLevel.Warning:this.applicationContext.EventManager.ReportTraceWarning(c,i.message,i.data);break;default:this.applicationContext.EventManager.ReportTraceInfo(c,i.message,i.data)}}}},t.prototype._showAppError=function(e){var t=this,o=this.getTelemetryComponent()+".ShowAppError",i=e.args.message,a=null===e.args.code?n.ErrorCode.GENERIC:e.args.code,s=new n.ComponentError(o,"Contact Module Failure: "+i,a);if(this.applicationContext.EventManager.ReportComponentFailure(s,[{name:u.ErrorEventParameterName.ComponentErrorComponentName,value:e.args.component}]),s.code===n.ErrorCode.CRM_USER_MISSING_PRIVILEGE){var c=p.default.parseMissingPrivilegeFromErrorMessage(s.message);s=d.default.createFromComponentError(s,[c])}this.applicationContext.ComponentsLoader.ensureComponentLoaded(r.default.RESOURCE_MANAGER).then((function(){return t.applicationContext.UIManager.showErrorMessage(s)}))},t.prototype._getFeatureControlBits=function(e){var t=this;this.applicationContext.CRMProvider.getFeatureControlBits().then((function(r){t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onSuccess,r,!0)}))},t.prototype._getStringValueBundle=function(e){var t=this,n=e.args.valueNames;if(n){this.applicationContext.ComponentsLoader.ensureComponentLoaded(r.default.RESOURCE_MANAGER).then((function(){for(var r={},o=0,i=n.length;o<i;o++)r[n[o]]=t.applicationContext.ResourceManager.getString(n[o]);t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onStringsResult,{values:r},!1)}))}},t.prototype._sendOdataBatchRequest=function(e){var t=this,r=e.args.entityType,n=e.args.fetchXml;this.applicationContext.CRMProvider.sendOdataBatchRequest(r,n).then((function(r){t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onSuccess,r,!0)}),(function(){t.applicationContext.Bridge.performCallbackWithId(e.callbacks.onFailure,{},!0)}))},t.prototype.registerMethods=function(){var e,t,r,n,o,i,a,s,u,c,l,p,d,f;this.registerMethodWithName("DisplayFormForNewAppointment",this._displayNewAppointmentForm,{AppointmentParameters:{}},{}),this.registerMethodWithName("GetContacts",this._getContacts,((e={}).Parameters={},e),((t={}).onSuccess="",t.onFailure="",t)),this.registerMethodWithName("UpdateContactProperties",this._updateContactProperties,((r={}).Parameters={},r.uniqueDispatchKey="",r),((n={}).onSuccess="",n.onFailure="",n)),this.registerMethodWithName("GetRoamingSettingsItem",this._getRoamingSettingsItem,((o={}).key="",o),((i={}).onSuccess="",i)),this.registerMethodWithName("SaveRoamingSettingsAsync",this._saveRoamingSettingsAsync,((a={}).key="",a.value={},a),((s={}).onSuccess="",s.onFailure="",s)),this.registerMethodWithName("SendTelemetryEvents",this._sendTelemetryEvents,((u={}).events={},u),{}),this.registerMethodWithName("ShowAppError",this._showAppError,((c={}).code=0,c.message="",c.component="",c),{}),this.registerMethodWithName("GetFeatureControlBits",this._getFeatureControlBits,{},((l={}).onSuccess="",l)),this.registerMethodWithName("GetStringValueBundle",this._getStringValueBundle,((p={}).valueNames={},p),{onStringsResult:""}),this.registerMethodWithName("SendOdataBatchRequest",this._sendOdataBatchRequest,((d={}).entityType="",d.fetchXml="",d),((f={}).onSuccess="",f.onFailure="",f))},t}(l.default);t.default=f}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(8),r(34),r(205),r(206),r(26),r(207),r(208)],void 0===(o=function(e,t,r,n,o,i,s,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t){var n=e.call(this,t)||this;if(n._propertiesRestrictions=[],n._extendedPropertiesRestrictions=[],n._maxEntriesReturned=1,n._offset=0,t){var o=t.fieldOrder,a=t.count,u=t.offset;t.propertiesRestrictions&&Array.isArray(t.propertiesRestrictions)&&(n._propertiesRestrictions=n.convertRawProperties(t.propertiesRestrictions,n._convertPropertyToRestriction)),t.extendedPropertiesRestrictions&&Array.isArray(t.extendedPropertiesRestrictions)&&(n._extendedPropertiesRestrictions=n.convertRawProperties(t.extendedPropertiesRestrictions,n._convertExtendedPropertyToRestriction)),o&&o.order&&o.property&&(n._fieldOrder=new i.default(o.order,new s.default(o.property,r.default.Contacts))),!isNaN(a)&&a>0&&(n._maxEntriesReturned=a),!isNaN(u)&&u>0&&(n._offset=u),n._orFilter=!0===t.orFilter}return n}return a(t,e),Object.defineProperty(t.prototype,"maxEntriesReturned",{get:function(){return this._maxEntriesReturned},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"offset",{get:function(){return this._offset},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"orFilter",{get:function(){return this._orFilter},enumerable:!0,configurable:!0}),t.prototype._convertPropertyToRestriction=function(e){return e.name&&null!==e.value&&void 0!==e.value?new u.default(new s.default(e.name,r.default.Contacts),e.value):null},t.prototype._convertExtendedPropertyToRestriction=function(e){if(e.name&&null!==e.type&&void 0!==e.type&&null!==e.value&&void 0!==e.value){e.type;return new o.default(new n.default(e.name,e.type),e.value,!!e.invert&&e.invert)}return null},t.prototype.getPropertiesRestrictions=function(){return this._propertiesRestrictions},t.prototype.getExtendedPropertiesRestrictions=function(){return this._extendedPropertiesRestrictions},t.prototype.getFieldOrder=function(){return this._fieldOrder},t}(c.default);t.default=l}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(23)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,r){void 0===r&&(r=!1),this._property=e,this._value=t,this._invert=r}return e.prototype.toSoap=function(){var e=this._invert?"<t:IsNotEqualTo>":"<t:IsEqualTo>",t=this._invert?"</t:IsNotEqualTo>":"</t:IsEqualTo>";return e+"\n\t\t\t\t\t"+this._property.toSoap()+'\n\t\t\t\t\t<t:FieldURIOrConstant>\n\t\t\t\t\t\t<t:Constant Value="'+r.escapeXml(this._value)+'" />\n\t\t\t\t\t</t:FieldURIOrConstant>\n\t\t\t\t'+t},e.prototype.toJson=function(){throw new Error("Not Implemented")},e}();t.default=n}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["Ascending","Descending"],n=function(){function e(e,t){this._order=e,this._property=t,-1===r.indexOf(this._order)&&(this._order=r[0])}return e.prototype.toSoap=function(){return'<t:FieldOrder Order="'+this._order+'">\n\t\t\t\t\t'+this._property.toSoap()+"\n\t\t\t\t</t:FieldOrder>"},e.prototype.toJson=function(){throw new Error("Not Implemented")},e}();t.default=n}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(23)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,r,n){void 0===r&&(r="Substring"),void 0===n&&(n="IgnoreCase"),this._property=e,this._value=t,this._containmentMode=r,this._containmentComparison=n}return e.prototype.toSoap=function(){return'<t:Contains ContainmentMode="'+this._containmentMode+'" ContainmentComparison="'+this._containmentComparison+'">\n\t\t\t\t\t'+this._property.toSoap()+'\n\t\t\t\t\t<t:Constant Value="'+r.escapeXml(this._value)+'" />\n\t\t\t\t</t:Contains>'},e.prototype.toJson=function(){throw new Error("Not Implemented")},e}();t.default=n}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(8),r(34),r(26),r(84)],void 0===(o=function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){var r=e.call(this)||this;return r._properties=[],t&&(t.properties&&Array.isArray(t.properties)&&(r._properties=r.convertRawProperties(t.properties,r._convertProperty)),t.extendedProperties&&Array.isArray(t.extendedProperties)&&(r._extendedProperties=r.convertRawProperties(t.extendedProperties,r._convertExtendedProperty))),r}return a(t,e),t.prototype._convertProperty=function(e){return e.name?new o.default(e.name,r.default.Contacts):null},t.prototype._convertExtendedProperty=function(e){return e.name?new n.default(e.name,e.type):null},t.prototype.getProperties=function(){return this._properties},t.prototype.getExtendedProperties=function(){return this._extendedProperties},t}(i.default);t.default=s}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(10),r(8),r(13),r(27),r(84)],void 0===(o=function(e,t,r,n,o,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){function t(t){var r=e.call(this)||this;return r._properties=[],t&&(t.properties&&Array.isArray(t.properties)&&(r._properties=r.convertRawProperties(t.properties,r._convertProperty)),t.extendedProperties&&Array.isArray(t.extendedProperties)&&(r._extendedProperties=r.convertRawProperties(t.extendedProperties,r._convertExtendedProperty)),r._itemId=t.id),r}return a(t,e),Object.defineProperty(t.prototype,"itemId",{get:function(){return this._itemId},enumerable:!0,configurable:!0}),t.prototype._convertProperty=function(e){return e.name?new i.default(e.name,n.default.Contacts,e.value,r.default[r.default.contact]):null},t.prototype._convertExtendedProperty=function(e){if(e.name&&null!==e.type&&void 0!==e.type){var t=e.type;return new o.default(e.name,isNaN(t)?n.default.String:t,e.value,r.default[r.default.contact])}return null},t.prototype.getProperties=function(){return this._properties},t.prototype.getExtendedProperties=function(){return this._extendedProperties},t}(s.default);t.default=u}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Log=0]="Log",e[e.Info=1]="Info",e[e.Verbose=2]="Verbose",e[e.Warning=3]="Warning",e[e.Error=4]="Error"}(n||(n={})),t.ApplicationEventLevel=n;var o="Info",i="Verbose",a="Warning",s="Error",u=((r={})[n.Log]=o,r[n.Info]=o,r[n.Verbose]=i,r[n.Warning]=a,r[n.Error]=s,r);t.APPLICATION_LEVEL_TO_TRACER_LEVEL_STRING=u}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(0),r(12),r(1),r(212),r(88),r(220),r(222),r(11)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t,r){this._bcd=e,this._applicationContext=t,this._exchangeApiProvider=new i.default(this._bcd,this._applicationContext),this._bcd.mode!==n.default.Module?this._mailboxItemProvider=r?new s.default(this._bcd,this._applicationContext,this._exchangeApiProvider):new a.default(this._bcd,this._applicationContext,this._exchangeApiProvider):this._contactsModuleProvider=new u.default(this._applicationContext,this._exchangeApiProvider)}return Object.defineProperty(e.prototype,"ExchangeServerVersion",{get:function(){return this._exchangeServerVersion},set:function(e){this._exchangeServerVersion||(this._exchangeServerVersion=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EwsSchemaVersion",{get:function(){return this._ewsSchemaVersion},set:function(e){this._ewsSchemaVersion||(this._ewsSchemaVersion=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MailboxItemProvider",{get:function(){return this._mailboxItemProvider||this._applicationContext.EventManager.ReportComponentFailure(new o.ComponentError(r.default.EXCHANGE_PROVIDER,"Mailbox item provider is absent",o.ErrorCode.GENERIC)),this._mailboxItemProvider},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ContactsModuleProvider",{get:function(){return this._contactsModuleProvider||this._applicationContext.EventManager.ReportComponentFailure(new o.ComponentError(r.default.EXCHANGE_PROVIDER,"Contacts module provider is absent",o.ErrorCode.GENERIC)),this._contactsModuleProvider},enumerable:!0,configurable:!0}),e}();t.ExchangeProvider=l,t.default=function(){return function(e,t){return t.CRMProvider.isFeatureControlBitEnabled(c.FcbNames.MailAppEnableCategoriesAPI).then((function(r){t.ExchangeProvider=new l(e,t,r)}))}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(17),r(12),r(56),r(86),r(87),r(38),r(25),r(1)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(){function e(e,t){this._bcd=e,this._applicationContext=t}return e.prototype.getExchangeApiName=function(){var e=this,t=this._bcd.exchangeDeploymentEnvironment===n.default.OnPremise,a=this._bcd.mode===o.default.Module,c=this._applicationContext.JsApiProvider.isRestCallbackTokenSupported();return a||t||!c?Promise.resolve(s.default.API_VERSION):this._applicationContext.JsApiProvider.getToken().then((function(){return i.default.API_VERSION})).catch((function(t){return e._applicationContext.JsApiProvider.isDelegatedMailbox().then((function(n){var o=e._applicationContext.JsApiProvider.getHostType()===u.default.OutlookMobile;if(n||o)throw new l.ComponentError(r.default.EXCHANGE_API_PROVIDER,"Failed to get callback token in "+(n?"Delegate mode":"Outlook Mobile"),l.ErrorCode.EXCHANGE_GENERIC,t);return e._applicationContext.EventManager.ReportTraceError(new l.ComponentError(r.default.EXCHANGE_API_PROVIDER,"Failed to get callbackToken with Online Exchange. Fallback to "+s.default.API_VERSION,l.ErrorCode.EXCHANGE_GENERIC,t)),s.default.API_VERSION}))}))},e.prototype.accept=function(e,t,n){var o=this;return void 0===n&&(n=!1),e===s.default.API_VERSION?this._makeRequest(t,s.default.API_VERSION):this._applicationContext.JsApiProvider.getHostType()===u.default.OutlookMobile?this._makeRequest(t,i.default.API_VERSION):e===i.default.API_VERSION?this._makeRequest(t,i.default.API_VERSION).catch((function(e){if(e.code===l.ErrorCode.EXCHANGE_ITEM_NOT_FOUND){if(!n)throw e;return Promise.all([o._applicationContext.JsApiProvider.isDelegatedMailbox(),o._applicationContext.ComponentsLoader.ensureComponentLoaded(r.default.CRM_PROVIDER).then((function(){return o._applicationContext.CRMProvider.isOrgSettingEnabled(c.DelegateAccessEnabled)}))]).then((function(r){var n=r[0],i=r[1];if(n&&i)return o._makeRequest(t,a.default.API_VERSION);throw e}))}return o._applicationContext.JsApiProvider.isDelegatedMailbox().then((function(n){if(!n)return o._applicationContext.EventManager.ReportTraceInfo(r.default.EXCHANGE_API_PROVIDER+"."+t.name,"Fallback to "+s.default.API_VERSION),o._makeRequest(t,s.default.API_VERSION);throw e}))})):void 0},e.prototype._getExchangeApiRequestor=function(e){return e===i.default.API_VERSION?new i.default(this._bcd,this._applicationContext):e===a.default.API_VERSION?new a.default(this._bcd,this._applicationContext):new s.default(this._bcd,this._applicationContext)},e.prototype._makeRequest=function(e,t){var n=this,o=r.default.EXCHANGE_API_PROVIDER+"."+e.name+"."+t;return this._applicationContext.EventManager.ReportTraceInfo(o,"Initiating Exchange call"),e.visit(this._getExchangeApiRequestor(t)).then((function(e){return n._applicationContext.EventManager.ReportComponentSuccess(o,"Exchange call succeeded"),e})).catch((function(e){throw n._applicationContext.EventManager.ReportTraceError(new l.ComponentError(o,"Exchange call failed. Reason: "+e.message,l.ErrorCode.EXCHANGE_GENERIC,e)),e}))},e}();t.default=p}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(85),r(0),r(1),r(33),r(6),r(4),r(215),r(29)],void 0===(o=function(e,t,r,n,o,i,s,u,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=""+n.default.EXCHANGE_API_PROVIDER,d=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.apiEndpoint="/api/v1.0/me/",n.body=null,n.requestMethod="GET",n.resource="",n.parameters="",n}return a(t,e),t.prototype.setResource=function(e){this.resource=e},t.prototype.setBody=function(e){this.body=e},t.prototype.makeRequest=function(e){var t=this,r=this.getTelemetryComponentName()+"."+e,n=this.applicationContext.Performance.addStopwatch(r);return this._getToken().then((function(o){return t.endpoint||t._setEndpoint(o),i.default.SendRequest({method:t.requestMethod,url:t._getUrl(),content:t.body,headers:[t.bcd.useAuthMethod===l.default.WIA?new i.default.KeyValue("withCredentials","True"):new i.default.KeyValue("Authorization","Bearer "+o)]}).then((function(e){return n.stop(),t._convertResponse(e)}),(function(n){var o=n instanceof i.default.Response?n.getComponentError(r):n;if(t.applicationContext.EventManager.ReportTraceWarning(r,'Exchange REST API call failed for "'+e+'" visitor',null,[{name:u.EventParameterName.RequestMethod,value:t.requestMethod},{name:u.ErrorEventParameterName.Error,value:o}]),!n.data())throw t.handleError(null,"Exchange REST API request failed. No error details available.");return t._convertResponse(n).then((function(e){var r,n;throw t.handleError(null===(r=e.error)||void 0===r?void 0:r.code,null===(n=e.error)||void 0===n?void 0:n.message)}))}))}))},t.prototype._getToken=function(){return this.applicationContext.JsApiProvider.getToken()},t.prototype._convertResponse=function(e){try{var t=JSON.parse(e.data());return Promise.resolve(t)}catch(e){return this.applicationContext.EventManager.ReportTraceWarning(this.getTelemetryComponentName()+".ConvertResponse","Failed to parse Exchange REST API json response",null,[{name:u.ErrorEventParameterName.ErrorCode,value:o.ErrorCode.JSON_PARSE_FAILURE},{name:u.ErrorEventParameterName.Error,value:e}]),Promise.reject(e)}},t.prototype.setParameters=function(e){this.parameters=e},t.prototype.convertToRestId=function(e){return this.applicationContext.JsApiProvider.convertToRestId(e,this.applicationContext.JsApiProvider.getRestVersionEnum().v1_0)},t.prototype.convertToEwsId=function(e){return this.applicationContext.JsApiProvider.convertToEwsId(e,this.applicationContext.JsApiProvider.getRestVersionEnum().v1_0)},t.prototype.getTelemetryComponentName=function(){var e=this.constructor;return p+"."+e.API_VERSION},t.prototype._getUrl=function(){var e=(this.parameters?"&":"")+"antiCache="+1e6*Math.random();return""+this.endpoint+this.apiEndpoint+this.resource+"?"+this.parameters+e},t.prototype._setEndpoint=function(e){try{var t=s.default.parseToken(e);t.ver===c.default.V1&&(this.endpoint="https://"+t.aud.split("/")[1].split("@")[0]),t.ver!==c.default.V1NEW&&t.ver!==c.default.V2||(this.endpoint=t.aud)}catch(e){throw this.applicationContext.EventManager.ReportComponentFailure(e),new o.ComponentError(p+".setEndpoint","Failed to set Exchange REST API endpoint",o.ErrorCode.GENERIC,e)}},t.API_VERSION="RestV1.0",t}(r.default);t.default=d}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.ITEM_NOT_FOUND="ErrorItemNotFound",e.INVALID_MAILBOX_ITEM_ID="ErrorInvalidMailboxItemId",e.ACCESS_DENIED="ErrorAccessDenied",e}();t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.V1="Exchange.Callback.V1",e.V2="Exchange.Callback.V2",e.V1NEW="STI.User.CallbackToken.V1",e}();t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Success=0]="Success",e[e.CallFailure=1]="CallFailure",e[e.ItemNotFound=2]="ItemNotFound",e[e.Timeout=3]="Timeout",e[e.MaxRetryReached=4]="MaxRetryReached"}(r||(r={})),t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(2),r(6)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){var o=this;this._options={maxRetryCount:3,maxActiveRequests:3,allRetriesTimeout:12e3,allRetriesTimeoutError:null,retryRequestTimeout:3e3,requestDelay:0},this._state={attemptsCount:0,activeRequestsCount:0,isRetryAllowed:!0,requestTimeoutIds:[]},this._onPromiseFulfilled=function(e){return o._disallowRetry(),e},this._onPromiseRejected=function(e){throw o._disallowRetry(),e},this._disallowRetry=function(){o._state.requestTimeoutIds.forEach(r.default.clearTimeout,r.default),o._state.isRetryAllowed=!1},this._retry=function(){if(o._state.isRetryAllowed){if(o._state.attemptsCount>=o._options.maxRetryCount)return void(o._state.isRetryAllowed=!1);if(o._state.activeRequestsCount===o._options.maxActiveRequests)return;var e=o._scheduleAttempt(o._options.retryRequestTimeout),t=o._state.requestTimeoutIds.push(e)-1;o._state.attemptsCount++,o._state.activeRequestsCount++,o._createRequest(o._state.attemptsCount===o._options.maxRetryCount).then(o._resolvePromise).catch((function(n){r.default.clearTimeout(e),o._state.requestTimeoutIds.splice(t,1),o._handleTryError(n)&&o._scheduleAttempt(o._options.requestDelay)}))}},this._handleTryError=function(e){return o._state.activeRequestsCount--,!(o._retryCallback&&o._retryCallback(e)||o._state.attemptsCount>=o._options.maxRetryCount&&0===o._state.activeRequestsCount)||(o._rejectPromise(e),!1)},this._scheduleAttempt=function(e){return r.default.setTimeout(o._retry,e)},this._scheduleAllRetriesTimeout=function(){return n.default.delay(o._options.allRetriesTimeout,(function(e){o._state.requestTimeoutIds.push(e)})).then(o._disallowRetry).then((function(){return Promise.reject(o._options.allRetriesTimeoutError)}))};var i=n.default.createDeferredPromise();this._promise=i.Promise.then(this._onPromiseFulfilled).catch(this._onPromiseRejected),this._resolvePromise=i.Resolve,this._rejectPromise=i.Reject,this._createRequest=e,this._options=Object.assign(this._options,t)}return e.prototype.init=function(e){return this._retryCallback=e,this._retry(),Promise.race([this._scheduleAllRetriesTimeout(),this._promise])},Object.defineProperty(e.prototype,"attemptsCount",{get:function(){return this._state.attemptsCount},enumerable:!0,configurable:!0}),e}();t.default=o}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._rawData=e?JSON.parse(e):{}}return e.prototype.get=function(e){return this._rawData[e]},e.prototype.set=function(e,t){this._rawData[e]=t},e.prototype.remove=function(e){delete this._rawData[e]},e}();t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(90),r(42),r(19),r(8),r(26),r(43)],void 0===(o=function(e,t,r,n,o,i,s,u){"use strict";var c;Object.defineProperty(t,"__esModule",{value:!0});var l="FileAttachment",p="Id",d=((c={})[o.default.ATTACHMENT_ID]="Id",c[o.default.LAST_MODIFIED_TIME]="LastModifiedDateTime",c),f=function(e){function t(t,r,n){void 0===n&&(n=[]);var a=e.call(this,t,r,[new s.default(o.default.ATTACHMENTS,i.default.Item)],[],u.default.GET_MAILBOX_ITEM_ATTACHMENTS)||this;return a._attachmentProperties=n,a}return a(t,e),t.prototype.getRestResource=function(t){return e.prototype.getRestResource.call(this,t)+"/attachments"},t.prototype.getRestParameters=function(e){return"$select="+this._attachmentProperties.map((function(e){return d.hasOwnProperty(e)?d[e]:e})).join(",")},t.prototype.populateDataFromRest=function(t,r){var n=e.prototype.populateDataFromRest.call(this,t,r);return n[o.default.ATTACHMENTS]=this._getAttachmentsFromRestResponse(t,r),n},t.prototype.populateDataFromEws=function(t){var r=e.prototype.populateDataFromEws.call(this,t);return r[o.default.ATTACHMENTS]=this._getAttachmentsFromEwsResonse(t),r},t.prototype._getAttachmentsFromRestResponse=function(e,t){var r=this;if(!e||!e.value||!e.value.length)return[];var n=new Array;return e.value.forEach((function(e){var i=r._mapRestPropertiesToEws(e);i[o.default.ATTACHMENT_ID]&&(i[o.default.ATTACHMENT_ID]=t.convertToEwsId(i[o.default.ATTACHMENT_ID]),n.push(i))})),n},t.prototype._mapRestPropertiesToEws=function(e){var t={};return this._attachmentProperties.forEach((function(r){var n=r;d.hasOwnProperty(r)&&(n=d[r]),t[r]=e[n]})),t},t.prototype._getAttachmentsFromEwsResonse=function(e){var t=this,r=e.getNodes(l);if(r&&r.length&&0!==r.length){var n=new Array;return Array.prototype.slice.call(r).forEach((function(e){if(e&&e.childNodes&&0!==e.childNodes.length){var r=t._attachmentNodeToAttachment(e);r&&n.push(r)}})),n}return[]},t.prototype._attachmentNodeToAttachment=function(e){var t={};return this._attachmentProperties.forEach((function(r){var i=n.default.getChildFromNode(e,r);if(r===o.default.ATTACHMENT_ID){var a=i&&i.attributes&&i.attributes.getNamedItem(p);t[o.default.ATTACHMENT_ID]=i&&a&&a.value}else t[r]=i&&i.textContent})),t[o.default.ATTACHMENT_ID]?t:null},t}(r.default);t.default=f}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};n=[r,t,r(0),r(35),r(1),r(4),r(57),r(16),r(8),r(58),r(13),r(59),r(89),r(60),r(11),r(6),r(88),r(221)],void 0===(o=function(e,t,r,n,o,i,u,c,l,p,d,f,h,_,m,v,g,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=r.default.MAILBOX_ITEM_PROVIDER+".getCategories",C=r.default.MAILBOX_ITEM_PROVIDER+".updateCategories",I=r.default.MAILBOX_ITEM_PROVIDER+".setOfficeProperties",P=r.default.MAILBOX_ITEM_PROVIDER+".updateExtendedProperties",T=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this;return o._pendingItemUpdate=new E.default,o}return a(t,e),Object.defineProperty(t.prototype,"_shouldUseCustomProperties",{get:function(){var e=this;return this._isOutlookComposeMode&&Promise.resolve(!0)||this._applicationContext.ComponentsLoader.ensureComponentLoaded(r.default.CRM_PROVIDER).then((function(){return e._applicationContext.CRMProvider.isFeatureControlBitEnabled(m.FcbNames.ForceUsageOfCustomProperties)}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_shouldUseOfficeJs",{get:function(){return!this._itemIsSynchronizedToExchange||this._isOutlookComposeMode||this._isDelegatedMailbox},enumerable:!0,configurable:!0}),t.prototype.setPropertiesPending=function(e){this._applicationContext.JsApiProvider.isAppPinningSupported()&&(this._applicationContext.EventManager.ReportTraceInfo(r.default.MAILBOX_ITEM_PROVIDER,"Adding item pending update",this._itemId),this._pendingItemUpdate.addUpdate(e,this._itemId,this._isDelegatedMailbox,this._itemIsSynchronizedToExchange))},t.prototype.clearPropertiesPending=function(){this._pendingItemUpdate.clear()},t.prototype.setProperties=function(e,t,r){var n=this;if(void 0===r&&(r=!1),r)return Promise.resolve(this._reflectPropertiesUpdates(e));var o=this._itemId,i=this._pendingItemUpdate.getUpdate(t,o);return i?this._updatePendingItem(e,i):(this._turnOffPolling(),this._setPropertiesPromiseCache(e).then((function(){o===n._itemId&&(n._reflectPropertiesUpdates(e),n._runPolling())})).catch((function(e){if(n._isRetryExpected(e))throw e;if(o===n._itemId)throw n._runPolling(),n._clearInMemoryCache(),e})))},t.prototype._updatePendingItem=function(e,t){var n=this;if(!t.isDelegatedMailbox&&t.isSynchronizedToExchange)return this._applicationContext.EventManager.ReportTraceInfo(r.default.MAILBOX_ITEM_PROVIDER,"Updating pending item in pinned mode",t.itemId),this._shouldUseCustomProperties.then((function(r){if(!r)return n._setPropertiesUsingExchangeApi(e,t.itemId);var o=h.default.splitPropertiesUpdates(e),i=o.customProperties,a=o.categoriesUpdate,s=n._constructExchangeUpdate(i,a);return n._setPropertiesUsingExchangeApi(s,t.itemId)}));this._applicationContext.EventManager.ReportTraceWarning(r.default.MAILBOX_ITEM_PROVIDER,"Unable to update pending item with Exchange call",t)},t.prototype._setPropertiesPromiseCache=function(e){var t=this;return this._pendingSetPropertiesPromise=this._setItemProperties(e).catch((function(e){if(t._isRetryExpected(e))throw e;throw t._pendingSetPropertiesPromise=null,e})),this._pendingSetPropertiesPromise.then((function(){t._pendingSetPropertiesPromise=null}))},t.prototype._setItemProperties=function(e){var t=this;return this._shouldUseCustomProperties.then((function(r){return t._extendWithExistingTrackStatusProperties(e,r).then((function(e){return r?t._setTrackStatusAsCustomProperties(e):t._setTrackStatusAsExchangeProperties(e)}))})).catch((function(e){var n=[{name:i.ErrorEventParameterName.Error,value:e}];throw t._applicationContext.EventManager.ReportTraceWarning(r.default.MAILBOX_ITEM_PROVIDER,"Failed to set properties",null,n),e}))},t.prototype._isRetryExpected=function(e){return-1!==[o.ErrorCode.OFFICE_CATEGORY_UPDATE,o.ErrorCode.OFFICE_TRANSIENT_ERROR].indexOf(e.code)},t.prototype._reflectPropertiesUpdates=function(e){var t,o,i=this,a=!1,s=h.default.splitPropertiesUpdates(e),u=s.customProperties,l=null===(o=s.categoriesUpdate)||void 0===o?void 0:o.propertyValue,d=((t={})[c.default.IS_TRACKED_FROM_MAILAPP]=!0,t[c.default.TRACKING_STATE_TRACKER]=!0,t[c.default.SSS_PROMOTE_TRACKER]=!0,t),f=[],_={};Object.keys(p.TrackStatusMap).forEach((function(e){var t=p.TrackStatusMap[e].parser,r=p.TrackStatusMap[e].propertyName;_[r]={trackStatusPropertyName:e,parser:t}})),l&&!n.default.isStringArrayEquals(this._mailboxItem.Categories,l)&&(this._mailboxItem.Categories=l,a=!0),Object.keys(u).forEach((function(e){var t=_[e];if(t){var r=t.parser(u[e]);i._trackStatus[t.trackStatusPropertyName]!==r&&(i._trackStatus[t.trackStatusPropertyName]=r,a=!0)}else d[e]||f.push(e)})),f.length>0&&this._applicationContext.EventManager.ReportTraceWarning(r.default.MAILBOX_ITEM_PROVIDER,"Properties were not updated on cached mailbox item or track status. See Data for props list.",f.join()),a&&this._compareAndNotify()},t.prototype._executeRetrieval=function(){var e=this;return this._clearInMemoryCache(),Promise.all([this._applicationContext.JsApiProvider.getMailboxItemId(),this._applicationContext.JsApiProvider.isDelegatedMailbox(),this._getCategories()]).then((function(t){var r=t[0],n=t[1],o=t[2];return e._itemId=r,e._isDelegatedMailbox=n,e._retrieveItemData(o).then(e._getItemData)}))},t.prototype._retrieveItemData=function(e){var t=this,r=h.default.getBuiltInPropertiesToRequest(this._isAppointment),n=h.default.getExtendedPropertiesToRequest(),o=this._retrieveCustomProperties(n);return this._retrieveItemWithExchangeRetry(r,n).then((function(e){return h.default.getExchangeCustomProperties(e)&&!t._isOutlookComposeMode?[e,null]:o.then((function(t){return[e,t]}))})).then((function(r){var o=r[0],i=r[1],a=h.default.getExchangeCustomProperties(o),s=h.default.evaluateCustomProperties(a,i),u=h.default.hasUpdatedExchangeCustomProperties(a,i,!0);return o&&e&&!u&&t._shouldUseOfficeJs&&(o.Categories=e),o||(o={Categories:e}),t._parsePropertiesResponse(o,s,n)}))},t.prototype._syncOfficeCacheWithExchange=function(){var e=this;return this._getCategories().then((function(t){if(!v.default.isArrayEqual(e._mailboxItem.Categories,t))return e._applicationContext.JsApiProvider.updateCategories(e._mailboxItem.Categories)}))},t.prototype._parsePropertiesResponse=function(e,t,r){return h.default.hasTrackingState(t,!0)?(this._propertiesOrigin=g.PropertiesOrigin.CustomProperties,s(s({},t),h.default.pickBuiltInProperties(e,r))):h.default.hasTrackingState(e,!0)?(this._propertiesOrigin=g.PropertiesOrigin.ExtendedProperties,e):h.default.pickBuiltInProperties(e,r)},t.prototype._getCategories=function(){var e=this;return this._applicationContext.JsApiProvider.isCategoriesApiSupported?this._applicationContext.JsApiProvider.getCategories().catch((function(t){return e._applicationContext.EventManager.ReportTraceError(new o.ComponentError(y,"Categories retrieval with JS API failed. Fallback trough Exchange call.",o.ErrorCode.GENERIC,t)),null})):Promise.resolve(null)},t.prototype._updateCategoriesUsingOfficeJs=function(e){var t=this;return this._syncOfficeCacheWithExchange().then((function(){return t._applicationContext.JsApiProvider.updateCategories(e)}))},t.prototype._setTrackStatusAsExchangeProperties=function(t){return e.prototype._setTrackStatusAsExchangeProperties.call(this,t,null)},t.prototype._setPropertiesUsingExchangeApi=function(e,t){var n=this;void 0===t&&(t=this._itemId),this._applicationContext.EventManager.ReportTraceInfo(r.default.MAILBOX_ITEM_PROVIDER,"Updating item on Exchange",h.default.getTelemetryTraceData(e));var o=new _.default(t,this._getItemType(),e,u.default.ALWAYS_OVERWRITE);return f.default(this._applicationContext,P,this._exchangeApiProvider,o).then((function(){n._applicationContext.EventManager.ReportTraceInfo(r.default.MAILBOX_ITEM_PROVIDER,"Item was successfully updated on Exchange")}))},t.prototype._setTrackStatusAsCustomProperties=function(e){var t,r=h.default.splitPropertiesUpdates(e),n=r.customProperties,o=r.categoriesUpdate;if(this._shouldUseOfficeJs)return this._setPropertiesUsingOfficeJs(n,null===(t=o)||void 0===t?void 0:t.propertyValue);var i=this._constructExchangeUpdate(n,o);return this._setPropertiesUsingExchangeApi(i)},t.prototype._constructExchangeUpdate=function(e,t){var r=this._applicationContext.JsApiProvider.getMailboxItemType(),n=new d.default(c.default.CUSTOM_PROPERTIES,l.default.String,JSON.stringify(e),r);return t?[n,t]:[n]},t.prototype._setPropertiesUsingOfficeJs=function(e,t){var n,i=this;if(t&&!this._applicationContext.JsApiProvider.isCategoriesApiSupported)throw new o.ComponentError(C,null,o.ErrorCode.OFFICE_CATEGORY_UPDATE);return this._applicationContext.EventManager.ReportTraceInfo(r.default.MAILBOX_ITEM_PROVIDER,"Setting custom properties",s(s({},e),((n={})[c.default.REGARDING_OBJECT_NAME]=void 0,n))),t?this._setCategoriesAndCustomProperties([this._applicationContext.JsApiProvider.setCustomProperties(e,!1),this._updateCategoriesUsingOfficeJs(t)]).then((function(){i._applicationContext.JsApiProvider.forcePropertiesSync()})):this._applicationContext.JsApiProvider.setCustomProperties(e)},t.prototype._setCategoriesAndCustomProperties=function(e){var t=this,r=e[0],n=e[1].catch((function(e){return t._applicationContext.EventManager.ReportTraceError(new o.ComponentError(I,"Set categories with Categories JS API failed",o.ErrorCode.GENERIC,e)),r.then((function(){throw t._applicationContext.EventManager.ReportTraceInfo(I,"Set Category failed and Custom Properties set successfully"),new o.ComponentError(I,null,o.ErrorCode.OFFICE_CATEGORY_UPDATE)})).catch((function(r){throw t._applicationContext.EventManager.ReportTraceError(new o.ComponentError(I,"Set Category and Custom Properties failed",o.ErrorCode.GENERIC,r)),e}))})),i=r.catch((function(e){return t._applicationContext.EventManager.ReportTraceError(e),n.then((function(){throw t._applicationContext.EventManager.ReportTraceInfo(I,"Set Custom Properties failed and Category set successfully"),new o.ComponentError(I,null,o.ErrorCode.OFFICE_TRANSIENT_ERROR)})).catch((function(e){throw t._applicationContext.EventManager.ReportTraceError(new o.ComponentError(I,"Set Custom Properties and Category failed",o.ErrorCode.GENERIC,e)),e}))}));return Promise.all([n,i]).then()},t}(g.default);t.default=T}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._updatesQueue=[]}return e.prototype.addUpdate=function(e,t,r,n){this._updatesQueue.push({actionId:e,itemId:t,isDelegatedMailbox:r,isSynchronizedToExchange:n})},e.prototype.clear=function(){this._updatesQueue=[]},e.prototype.getUpdate=function(e,t){var r,n=(null===(r=this._updatesQueue[0])||void 0===r?void 0:r.actionId)===e&&this._updatesQueue.shift();if(n&&t!==n.itemId)return n},e}();t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(57),r(59),r(10),r(223),r(60),r(0)],void 0===(o=function(e,t,r,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=s.default.CONTACTS_MODULE_PROVIDER+".GetContacts",c=s.default.CONTACTS_MODULE_PROVIDER+".UpdateContactProperties",l=function(){function e(e,t){this._applicationContext=e,this._exchangeApiProvider=t}return e.prototype.getContacts=function(e){return n.default(this._applicationContext,u,this._exchangeApiProvider,new i.default(e))},e.prototype.updateContactProperties=function(e){var t=new a.default(e.itemId,o.default.contact,[].concat(e.getProperties()).concat(e.getExtendedProperties()),r.default.ALWAYS_OVERWRITE);return n.default(this._applicationContext,c,this._exchangeApiProvider,t)},e}();t.default=l}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(43),r(8),r(224),r(34),r(23),r(225),r(92)],void 0===(o=function(e,t,r,n,o,i,s,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t){var a=e.call(this,r.default.GET_CONTACT_ITEMS)||this;return a._ewsMethodName="FindItem",a._extendedPropsForRetrieval=[new i.default("crmid",n.default.String),new i.default("crmLinkState",n.default.Double),new i.default("crmParentAccountId",n.default.String),new o.default(32900,"Address",n.default.String)],a._query=t,a}return a(t,e),t.prototype.visitRestV2Api=function(e){return this.visitEwsApi(e)},t.prototype.visitEwsApi=function(e){return e.setRequestMethod(this._ewsMethodName),e.setMethodDefinition(this.getMethodDefinitionParamaters()),e.setBodyRequest(this._getEwsBodyRequest()),e.makeRequest(this.name).then((function(e){return new u.default(e).parse()}))},t.prototype.getMethodDefinitionParamaters=function(){return['Traversal="Shallow"']},t.prototype._getRestrictionXml=function(){var e=s.formatArrayToString(this._query.getPropertiesRestrictions(),(function(e){return e.toSoap()})),t=s.formatArrayToString(this._query.getExtendedPropertiesRestrictions(),(function(e){return e.toSoap()}));return e||t?(t&&(t="<t:Or>\n\t\t\t\t\t"+t+"\n\t\t\t\t</t:Or>"),e&&this._query.orFilter&&(e="<t:Or>\n\t\t\t\t\t"+e+"\n\t\t\t\t</t:Or>"),"<m:Restriction>\n\t\t\t\t\t<t:And>\n\t\t\t\t\t\t"+t+"\n\t\t\t\t\t\t"+e+"\n\t\t\t\t\t</t:And>\n\t\t\t\t</m:Restriction>"):""},t.prototype._getSortOrderXml=function(){var e=this._query.getFieldOrder();return e?"<m:SortOrder>\n\t\t\t\t\t"+e.toSoap()+"\n\t\t\t\t</m:SortOrder>":""},t.prototype._getAdditionalPropertiesXml=function(){return"<t:AdditionalProperties>\n\t\t\t\t\t"+s.formatArrayToString(this._extendedPropsForRetrieval,(function(e){return e.toSoap()}))+"\n\t\t\t\t</t:AdditionalProperties>"},t.prototype._getEwsBodyRequest=function(){return"<m:ItemShape>\n\t\t\t\t\t<t:BaseShape>AllProperties</t:BaseShape>\n\t\t\t\t\t"+this._getAdditionalPropertiesXml()+'\n\t\t\t\t</m:ItemShape>\n\t\t\t\t<m:IndexedPageItemView BasePoint="Beginning" MaxEntriesReturned="'+this._query.maxEntriesReturned+'" Offset="'+this._query.offset+'" />\n\t\t\t\t\t'+this._getRestrictionXml()+"\n\t\t\t\t\t"+this._getSortOrderXml()+'\n\t\t\t\t<m:ParentFolderIds>\n\t\t\t\t\t<t:DistinguishedFolderId Id="contacts" />\n\t\t\t\t</m:ParentFolderIds>'},t}(c.default);t.default=l}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(26),r(8)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n){var o=e.call(this,null,n)||this;return o._propertyId=t,o._distinguishedPropertySetId=r,o}return a(t,e),t.prototype.toSoap=function(){return'<t:ExtendedFieldURI DistinguishedPropertySetId="'+this._distinguishedPropertySetId+'" PropertyId="'+this._propertyId+'" PropertyType="'+n.default[this.propertyType]+'" />'},t}(r.default);t.default=o}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(42),r(226)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){this.ewsParser=e,this._keyAttribute="Key",this._emailAddressExtendedPropertyId=32900,this._emailAddressExtendedPropertyName="EmailAddress1"}return e.prototype._getContacts=function(){for(var e=this.ewsParser.getNodes("Contact"),t=[],r=0;r<e.length;r++)t.push(this.parseContactNode(e[r]));return t},e.prototype._forEach=function(e,t){for(var r=0;r<e.length;r++)t(e[r])},e.prototype.parseContactNode=function(e){var t=this,n={};return this._forEach(e.childNodes,(function(e){var o=r.default.sliceNameSpace(e.nodeName);if(r.default.hasSinglePlainTextChild(e))n[o]=e.textContent;else switch(o){case"ItemId":n.Id=e.getAttribute("Id"),n.ChangeKey=e.getAttribute("ChangeKey");break;case"EmailAddresses":t._forEach(e.childNodes,(function(e){n[e.getAttribute(t._keyAttribute)]=e.textContent}));break;case"PhysicalAddresses":t._forEach(e.childNodes,(function(e){var o=e.getAttribute(t._keyAttribute);t._forEach(e.childNodes,(function(e){var t=r.default.sliceNameSpace(e.nodeName);n[o+"Address"+t]=e.textContent}))}));break;case"PhoneNumbers":t._forEach(e.childNodes,(function(e){var r=e.getAttribute(t._keyAttribute);n[r]=e.textContent}));break;case"CompleteName":t._forEach(e.childNodes,(function(e){var t=r.default.sliceNameSpace(e.nodeName);switch(t){case"FullName":n[t]=e.textContent}}));break;case"ExtendedProperty":var i=r.default.getExtendedPropertyName(e),a=r.default.getExtendedPropertyId(e),s=r.default.getExtendedPropertyValue(e);n.ExtendedProperties||(n.ExtendedProperties={}),i?n.ExtendedProperties[i]=s:a&&a===t._emailAddressExtendedPropertyId.toString()&&(n.ExtendedProperties[t._emailAddressExtendedPropertyName]=s);break;default:n[o]=""}})),!n.EmailAddress1||-1!==n.EmailAddress1.indexOf("@")&&-1===n.EmailAddress1.indexOf("/")||(n.EmailAddress1=n.ExtendedProperties[this._emailAddressExtendedPropertyName]),n},e.prototype.parse=function(){var e=this.ewsParser.getNode("RootFolder");if(!e)return null;var t=e.getAttribute("TotalItemsInView");return t?new n.default(parseInt(t,10),this._getContacts()):null},e}();t.default=o}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){this.itemsInViewCount=e,this.contacts=t};t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),s=this&&this.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n};n=[r,t,r(0),r(61),r(12),r(1),r(21),r(21),r(38),r(4),r(2),r(71),r(6),r(54),r(10),r(9),r(20),r(62),r(39),r(229),r(23),r(4),r(93),r(17),r(230)],void 0===(o=function(e,t,r,n,o,i,u,c,l,p,d,f,h,_,m,v,g,E,y,C,I,P,T,A,R){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S,O=d.default.Office(),b=r.default.JS_API_PROVIDER+".Event",M=b+".AppointmentTimeChanged";!function(e){e[e.None=0]="None",e[e.Initialized=1]="Initialized",e[e.Ready=2]="Ready"}(S||(S={}));var x,N,w=function(e){function t(t,n,a){var s=e.call(this)||this;return s._bcd=t,s._applicationContext=n,s._itemChangingDeferred=h.default.createDeferredPromise(),s._itemChangedHandlerState=S.None,s._reportTelemetryAsync=function(e,t){return void 0===t&&(t=i.ErrorCode.GENERIC),function(r){var n=c.ensureComponentErrorObject(r,t,e);throw s._applicationContext.EventManager.ReportComponentFailure(n),n}},s._callbackTokenProvider=new C.default(s._bcd,s._applicationContext),s._itemChangedHandlers=[],s._appointmentTimeChangedHandlers=[],s._onInitialized=new Promise((function(e,t){a.then((function(){s._isInitialized=!0,d.default.addAssociateActionFunction(),s._setMailboxItem(),s._setStaticContext(),s.isAppointment()&&s._subscribeToAppointmentTimeChangedEvent(),s.isComposeMode()&&s._trySave("GetItemId-OfficeInitialized").catch((function(e){i.ErrorCode.isKnownOfficeSaveAsyncErrorCode(e.code)&&s._applicationContext.ComponentsLoader.ensureComponentLoaded(r.default.RESOURCE_MANAGER).then((function(){s._applicationContext.UIManager.showNotification(e)}))})),s._bcd.mode!==o.default.Module&&(s._subsribeToItemChangedEvent(),s.addItemChangedHandler(s._applicationContext.EventManager.onMailboxItemChanged.bind(s._applicationContext.EventManager))),e()})).catch(t)})),s}return a(t,e),t.prototype._toOfficeCoercionType=function(e){return e===_.default.Text?O.CoercionType.Text:O.CoercionType.Html},t.prototype._reportError=function(e,t){var r=new i.ComponentError(e,"Office JS API '"+e+"' call error",i.ErrorCode.GENERIC,c.ensureComponentErrorObject(t,i.ErrorCode.UNCAUGHT_EXCEPTION,e));this._applicationContext.EventManager.ReportComponentFailure(r,[{name:p.ErrorEventParameterName.Error,value:t}])},t.prototype._isRecipientsGetAsyncAvailable=function(){return this.getMailboxItemType()===m.default[m.default.appointment]?null!=this.getMailboxItem().requiredAttendees.getAsync:null!=this.getMailboxItem().to.getAsync},t.prototype._isSameDomain=function(e,t){if(e&&t){var r=e.indexOf("@"),n=t.indexOf("@");if(r>0&&n>0)return e.substr(r+1).toLowerCase()===t.substr(n+1).toLowerCase()}return!1},t.prototype._prefillRecipientType=function(e){return e&&!e.recipientType?{recipientType:this._isSameDomain(e.emailAddress,this._getUserEmailAddressDetails().emailAddress)?"user":"externalUser",displayName:e.displayName,emailAddress:e.emailAddress}:e},t.prototype._getComposeMessageRecipients=function(){var e=this,t={},r=this.getMailboxItem(),o=this._applicationContext.Performance.addStopwatch(n.default.GET_COMPOSE_MESSAGE_RECIPIENTS);return this.getUserEmailAddress()&&(t.sender=this._getUserEmailAddressDetails()),Promise.all([this._retrieveRecipientsAsync(r.to),this._retrieveRecipientsAsync(r.cc),this._retrieveRecipientsAsync(r.bcc)]).then((function(r){return o.stop(),t.to=e._cleanupAddressDetailsArray(r[0]),t.cc=e._cleanupAddressDetailsArray(r[1]),t.bcc=e._cleanupAddressDetailsArray(r[2]),t}))},t.prototype._getReadMessageRecipients=function(){var e=this.getMailboxItem(),t={};return e.from&&e.from.emailAddress?t.sender=this._prefillRecipientType(e.from):t.sender=I.combineObjects(e.from||{},this._getUserEmailAddressDetails()),t.to=this._cleanupAddressDetailsArray(e.to),t.cc=this._cleanupAddressDetailsArray(e.cc),Promise.resolve(t)},t.prototype._getComposeMeetingAttendees=function(){var e=this,t=this.getMailboxItem(),r=this._applicationContext.Performance.addStopwatch(n.default.GET_COMPOSE_MEETING_ATTENDEES);return Promise.all([this._getUserEmailAddressDetails(),this._retrieveRecipientsAsync(t.requiredAttendees),this._retrieveRecipientsAsync(t.optionalAttendees)]).then((function(t){var n=t[0],o=t[1],i=t[2];r.stop();var a={},s=[];return n.emailAddress&&(a.sender=n,s.push(n)),a.requiredAttendees=e._cleanupAddressDetailsArray(o,s),a.optionalAttendees=e._cleanupAddressDetailsArray(i,s),a}))},t.prototype._getReadMeetingAttendees=function(){var e={},t=this.getMailboxItem();return t.organizer&&t.organizer.emailAddress&&(e.organizer=this._prefillRecipientType(t.organizer)),t.from&&t.from.emailAddress?e.sender=this._prefillRecipientType(t.from):e.organizer?e.sender=e.organizer:e.sender=I.combineObjects(t.from||{},this._getUserEmailAddressDetails()),e.requiredAttendees=this._cleanupAddressDetailsArray(t.requiredAttendees,[e.sender]),e.optionalAttendees=this._cleanupAddressDetailsArray(t.optionalAttendees,[e.sender]),Promise.resolve(e)},t.prototype._saveCustomProperties=function(e){var t=this,r=Date.now();return new Promise((function(t){return e.saveAsync(t)})).then((function(e){return t._handleAsyncResponse(n.default.SAVE_CUSTOM_PROPERTIES,e,r)})).catch((function(e){var r=c.ensureComponentErrorObject(e,i.ErrorCode.UNCAUGHT_EXCEPTION,n.default.SAVE_CUSTOM_PROPERTIES);throw t._applicationContext.EventManager.ReportComponentFailure(r),r}))},t.prototype._getUserEmailAddressDetails=function(){return{displayName:this._staticContext.userProfile.displayName,emailAddress:this.getUserEmailAddress(),recipientType:"user"}},t.prototype._cleanupAddressDetailsArray=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=[]),e.filter((function(e){return void 0!==e&&t.every((function(t){return t.emailAddress.toLowerCase()!==e.emailAddress.toLowerCase()}))}))},t.prototype._retrieveRecipientsAsync=function(e){var t=this;if(!e)return Promise.resolve([]);var r=Date.now();return new Promise((function(t){return e.getAsync(t)})).then((function(e){return t._handleAsyncResponse(n.default.RETRIEVE_RECIPIENTS,e,r)})).catch((function(e){var r=c.ensureComponentErrorObject(e,i.ErrorCode.UNCAUGHT_EXCEPTION,n.default.RETRIEVE_RECIPIENTS);throw t._applicationContext.EventManager.ReportComponentFailure(r),r}))},t.prototype._isSetSupported=function(e,t){return!(!O.context||!O.context.requirements)&&O.context.requirements.isSetSupported(e,t)},Object.defineProperty(t.prototype,"_ensureMailboxItem",{get:function(){return this._itemChangingDeferred.Promise},enumerable:!0,configurable:!0}),t.prototype._setStaticContext=function(){var e=this._getMailboxDiagnostics();this._staticContext={mailboxDiagnostics:e,displayLanguage:O.context.displayLanguage,installId:this._setInstallId(),itemType:this._setMailboxItemType(),ewsUrl:this._setEwsUrl(),hostType:this._setHostType(e),userProfile:{emailAddress:O.context.mailbox.userProfile.emailAddress,displayName:O.context.mailbox.userProfile.displayName,timeZone:O.context.mailbox.userProfile.timeZone}}},t.prototype.isRestCallbackTokenSupported=function(){return this._isSetSupported("mailbox",1.5)},t.prototype.isAppPinningSupported=function(){var e=this._isSetSupported("mailbox",1.5);if(this.isMessage()&&this._bcd.exchangeDeploymentEnvironment===A.default.Online&&this._bcd.mode===o.default.Read&&e){if(this.getHostType()===l.default.OutlookWebApp)return!0;if(this.getIsDesktopOutlook())return R.isPinnableTaskpaneSupported(this.getMailboxDiagnostics().hostVersion)}return!1},t.prototype.openLoginDialog=function(e,t){var r=this,o=this._isSetSupported("DialogApi",1.1)&&void 0!==O.context.ui.displayDialogAsync,a=o?"OfficeDialog":"ExternalWindow";return this._applicationContext.Storage.setItem(v.default.loginDialogMode,a),new Promise((function(r,a){o?O.context.ui.displayDialogAsync(e,null,(function(e){var o,s;if(e&&e.status===O.AsyncResultStatus.Succeeded){var u=e.value;u.addEventHandler(null===(o=O.EventType)||void 0===o?void 0:o.DialogMessageReceived,(function(e){if(e&&"request-auth-urls"===e.message&&t)u.messageChild(JSON.stringify({signInUrl:t.signIn,signOutUrl:t.signOut}));else{u.close();try{var o=JSON.parse(e.message);r(o)}catch(e){a(new i.ComponentError(n.default.OPEN_LOGIN_DIALOG,"Failed to parse Auth response: "+e.message,i.ErrorCode.JSON_PARSE_FAILURE))}}})),u.addEventHandler(null===(s=O.EventType)||void 0===s?void 0:s.DialogEventReceived,(function(e){var t;u.close();var r={error:{code:null===(t=e)||void 0===t?void 0:t.error}};a(E.getOfficeAsyncError(n.default.OPEN_LOGIN_DIALOG,r))}))}else a(E.getOfficeAsyncError(n.default.OPEN_LOGIN_DIALOG,e))})):d.default.open(e)})).catch((function(e){var t=c.ensureComponentErrorObject(e,i.ErrorCode.UNCAUGHT_EXCEPTION,n.default.OPEN_LOGIN_DIALOG);throw r._applicationContext.EventManager.ReportComponentFailure(t),t}))},t.prototype.getMailboxItem=function(){return this._mailboxItem},t.prototype.getMailboxItemType=function(){return this._staticContext.itemType},t.prototype.getMailboxDiagnostics=function(){return this._staticContext.mailboxDiagnostics},t.prototype.getUserEmailAddress=function(){return this._staticContext.userProfile.emailAddress},t.prototype.getEwsUrl=function(){return this._staticContext.ewsUrl},t.prototype.isMessage=function(){return this.getMailboxItemType()===m.default[m.default.message]},t.prototype.isAppointment=function(){return this.getMailboxItemType()===m.default[m.default.appointment]},t.prototype.prependBody=function(e,t){var r=this,o=this.getMailboxItem().body,a=Date.now();return e?new Promise((function(a,s){return o&&o.prependAsync?e.length>1e6?s(new i.ComponentError(n.default.PREPEND_BODY,"Failed to insert message/appointment body, max limit exceeded.",i.ErrorCode.GENERIC)):void o.prependAsync(e,{coercionType:r._toOfficeCoercionType(t)},a):s(new i.ComponentError(n.default.PREPEND_BODY,"body.prependAsync method is not available.",i.ErrorCode.GENERIC))})).then((function(e){return r._handleAsyncResponse(n.default.PREPEND_BODY,e,a)})).catch((function(e){var t=c.ensureComponentErrorObject(e,i.ErrorCode.UNCAUGHT_EXCEPTION,n.default.PREPEND_BODY);throw r._applicationContext.EventManager.ReportComponentFailure(t),t})):(this._applicationContext.EventManager.ReportTraceInfo(n.default.PREPEND_BODY,"Nothing to insert message/appointment body."),Promise.resolve())},t.prototype.getSubject=function(){var e=this,t=this.getMailboxItem(),r=t;if(!r.subject||!r.subject.getAsync)return Promise.resolve(t.subject);var o=Date.now();return new Promise((function(e){return r.subject.getAsync(e)})).then((function(t){return e._handleAsyncResponse(n.default.GET_SUBJECT,t,o)})).catch((function(t){var r=c.ensureComponentErrorObject(t,i.ErrorCode.UNCAUGHT_EXCEPTION,n.default.GET_SUBJECT);throw e._applicationContext.EventManager.ReportComponentFailure(r),r}))},t.prototype.setSubject=function(e){var t=this,r=this.getMailboxItem(),o=Date.now();return new Promise((function(t,o){if(!r.subject||!r.subject.setAsync)return o(new i.ComponentError(n.default.SET_SUBJECT,"subject.setAsync method is not available.",i.ErrorCode.GENERIC));r.subject.setAsync(e,t)})).then((function(e){return t._handleAsyncResponse(n.default.SET_SUBJECT,e,o)})).catch((function(e){var r=c.ensureComponentErrorObject(e,i.ErrorCode.UNCAUGHT_EXCEPTION,n.default.SET_SUBJECT);throw t._applicationContext.EventManager.ReportComponentFailure(r),r}))},t.prototype.getLocation=function(){var e=this,t=this.getMailboxItem(),r=t;if(!r.location||!r.location.getAsync)return Promise.resolve(t.location);var o=Date.now();return new Promise((function(e){return r.location.getAsync(e)})).then((function(t){return e._handleAsyncResponse(n.default.RETRIEVE_LOCATION,t,o)})).catch((function(t){var r=c.ensureComponentErrorObject(t,i.ErrorCode.UNCAUGHT_EXCEPTION,n.default.RETRIEVE_LOCATION);throw e._applicationContext.EventManager.ReportComponentFailure(r),r}))},t.prototype.getRoomMailboxes=function(){var e=this;return this._itemChangingDeferred.Promise.then((function(t){var r=t;if(!e._isSetSupported("mailbox",1.8)||!r.enhancedLocation||!r.enhancedLocation.getAsync){var o=new i.ComponentError(n.default.RETRIEVE_ROOM_MAILBOXES,"enhancedLocation.getAsync method is not available.",i.ErrorCode.GENERIC);throw e._applicationContext.EventManager.ReportTraceError(o),o}var a=Date.now();return new Promise((function(e){return r.enhancedLocation.getAsync(e)})).then((function(t){return e._handleAsyncResponse(n.default.RETRIEVE_ROOM_MAILBOXES,t,a)})).then((function(e){var t;return(null===(t=e)||void 0===t?void 0:t.length)?e.filter((function(e){return"room"===e.locationIdentifier.type})).map((function(e){return{displayName:e.displayName,emailAddress:e.emailAddress,recipientType:"other"}})):[]})).catch((function(t){var r=c.ensureComponentErrorObject(t,i.ErrorCode.UNCAUGHT_EXCEPTION,n.default.RETRIEVE_ROOM_MAILBOXES);throw e._applicationContext.EventManager.ReportComponentFailure(r),r}))}))},t.prototype.getStartDate=function(){var e=this,t=this.getMailboxItem(),r=t;if(!r.start||!r.start.getAsync)return Promise.resolve(t.start);var o=Date.now();return new Promise((function(e){return r.start.getAsync(e)})).then((function(t){return e._handleAsyncResponse(n.default.RETRIEVE_SCHEDULED_START,t,o)})).catch((function(t){var r=c.ensureComponentErrorObject(t,i.ErrorCode.UNCAUGHT_EXCEPTION,n.default.RETRIEVE_SCHEDULED_START);throw e._applicationContext.EventManager.ReportComponentFailure(r),r}))},t.prototype.getEndDate=function(){var e=this,t=this.getMailboxItem(),r=t;if(!r.end||!r.end.getAsync)return Promise.resolve(t.end);var o=Date.now();return new Promise((function(e){return r.end.getAsync(e)})).then((function(t){return e._handleAsyncResponse(n.default.RETRIEVE_SCHEDULED_END,t,o)})).catch((function(t){var r=c.ensureComponentErrorObject(t,i.ErrorCode.UNCAUGHT_EXCEPTION,n.default.RETRIEVE_SCHEDULED_END);throw e._applicationContext.EventManager.ReportComponentFailure(r),r}))},t.prototype.getSharedProperties=function(){var e=this;return this._sharedPropertiesPromise?this._sharedPropertiesPromise:this._sharedPropertiesPromise=this._itemChangingDeferred.Promise.then((function(t){if(!t||!t.getSharedPropertiesAsync)return null;e._applicationContext.EventManager.ReportTraceInfo(n.default.GET_SHARED_PROPERTIES,"Item is opened in delegated mailbox");var r=Date.now();return new Promise((function(e){t.getSharedPropertiesAsync(e)})).then((function(t){return e._handleAsyncResponse(n.default.GET_SHARED_PROPERTIES,t,r)})).then((function(t){var r=t||{},o=r.delegatePermissions,i=r.targetRestUrl;return e._applicationContext.EventManager.ReportTraceInfo(n.default.GET_SHARED_PROPERTIES,"Shared properties received",{delegatePermissions:o,targetRestUrl:i}),t}))})).catch((function(t){var r=c.ensureComponentErrorObject(t,i.ErrorCode.UNCAUGHT_EXCEPTION,n.default.GET_SHARED_PROPERTIES);throw e._applicationContext.EventManager.ReportComponentFailure(r),r}))},t.prototype.isDelegatedMailbox=function(){return this.getSharedProperties().then(Boolean).catch((function(){return!1}))},t.prototype.addFileAttachment=function(e,t){var r=this,o=this.getMailboxItem(),a=Date.now();return new Promise((function(r,a){return o.addFileAttachmentAsync?e&&e.length>2048?a(new i.ComponentError(n.default.ADD_FILE_ATTACHMENT,"Failed to add attachment to message, max url length exceeded",i.ErrorCode.GENERIC)):t&&t.length>255?a(new i.ComponentError(n.default.ADD_FILE_ATTACHMENT,"Failed to add attachment to message, max attachment name length exceeded",i.ErrorCode.GENERIC)):void o.addFileAttachmentAsync(e,t,r):a(new i.ComponentError(n.default.ADD_FILE_ATTACHMENT,"item.addFileAttachmentAsync method is not available",i.ErrorCode.GENERIC))})).then((function(e){return r._handleAsyncResponse(n.default.ADD_FILE_ATTACHMENT,e,a)})).catch((function(e){var t=c.ensureComponentErrorObject(e,i.ErrorCode.UNCAUGHT_EXCEPTION,n.default.ADD_FILE_ATTACHMENT);throw r._applicationContext.EventManager.ReportComponentFailure(t),t}))},t.prototype._setMailboxItem=function(){if(this._bcd.mode===o.default.Module)return this._itemChangingDeferred.Resolve();if(this._mailboxItem=O.context.mailbox.item,!this._mailboxItem)throw new i.ComponentError(n.default.GET_MAILBOX_ITEM,"OfficeJS has returned null for the mailbox item",i.ErrorCode.OFFICE_MAILBOX_ITEM_UNAVAILABLE);this._itemId=this._mailboxItem.itemId,this._applicationContext.EventManager.ReportTraceInfo(r.default.JS_API_PROVIDER,"Office JS Api set the item",{itemId:this._mailboxItem.itemId,getSharedPropertiesAsync:typeof this._mailboxItem.getSharedPropertiesAsync,saveAsync:typeof this._mailboxItem.saveAsync,addFileAttachmentAsync:typeof this._mailboxItem.addFileAttachmentAsync,addItemAttachmentAsync:typeof this._mailboxItem.addItemAttachmentAsync,removeAttachmentAsync:typeof this._mailboxItem.removeAttachmentAsync,loadCustomPropertiesAsync:typeof this._mailboxItem.loadCustomPropertiesAsync,getSelectedDataAsync:typeof this._mailboxItem.getSelectedDataAsync,setSelectedDataAsync:typeof this._mailboxItem.setSelectedDataAsync,categories:this._mailboxItem.categories?{getAsync:typeof this._mailboxItem.categories.getAsync,addAsync:typeof this._mailboxItem.categories.addAsync,removeAsync:typeof this._mailboxItem.categories.removeAsync}:typeof this._mailboxItem.categories},this.getTelemetryParams()),this._itemChangingDeferred.Resolve(this._mailboxItem)},t.prototype.getTelemetryParams=function(){var e=this._getMailboxDiagnostics();return[{name:P.SessionContextParameterName.ItemType,value:this._mailboxItem&&this._mailboxItem.itemType},{name:P.SessionContextParameterName.OWAView,value:e&&e.OWAView},{name:P.SessionContextParameterName.HostName,value:e&&e.hostName},{name:P.SessionContextParameterName.HostVersion,value:e&&e.hostVersion}]},t.prototype._setInstallId=function(){var e=this,t=this.getRoamingSettingsItem(y.RoamingSettingKeys.installIdKey);return t||(t=g.default.newGuid().guid,this.setRoamingSettingsItem(y.RoamingSettingKeys.installIdKey,t),this.saveRoamingSettingsAsync().catch((function(t){e._applicationContext.EventManager.ReportTraceError(new i.ComponentError(n.default.SET_INSTALL_ID,"Failed to set Install Id",i.ErrorCode.GENERIC,t),[{name:p.ErrorEventParameterName.Error,value:t}])}))),t},t.prototype._setMailboxItemType=function(){if(this._bcd.mode===o.default.Module)return"module";try{var e=this.getMailboxItem();return e?e.itemType:""}catch(e){return this._reportError(n.default.GET_MAILBOX_ITEM_TYPE,e),""}},t.prototype._getMailboxDiagnostics=function(){try{var e=O.context.mailbox.diagnostics;return!e&&O.context.mailbox.$1k_0&&(e=O.context.mailbox.$1k_0),e?{hostName:e.hostName,hostVersion:e.hostVersion,OWAView:e.OWAView}:null}catch(e){return this._reportError(n.default.GET_MAILBOX_DIAGNOSTICS,e),null}},t.prototype._setEwsUrl=function(){if(this._bcd.mode===o.default.Module)return null;try{return O.context.mailbox.ewsUrl}catch(e){return this._reportError(n.default.GET_EWS_URL,e),null}},t.prototype._setHostType=function(e){switch(e&&e.hostName){case"Outlook":case"Mac Outlook":return l.default.Outlook;case"OutlookWebApp":return l.default.OutlookWebApp;case"OutlookIOS":case"OutlookAndroid":return l.default.OutlookMobile;default:return l.default.Unknown}},t.prototype.getInstallId=function(){return this._staticContext.installId},t.prototype.makeEwsRequest=function(e,t){var r=this,o=Date.now(),a=n.default.MAKE_EWS_REQUEST+"."+e;return new Promise((function(e){return O.context.mailbox.makeEwsRequestAsync(t,e)})).then((function(e){return r._handleAsyncResponse(a,e,o).then((function(e){if(!e)throw new i.ComponentError(a,"Exchange SOAP response contains empty body",i.ErrorCode.EXCHANGE_GENERIC);return e}))})).catch((function(e){var t=c.ensureComponentErrorObject(e,i.ErrorCode.UNCAUGHT_EXCEPTION,a);throw r._applicationContext.EventManager.ReportComponentFailure(t),t}))},t.prototype.getDisplayLanguage=function(){return this._staticContext.displayLanguage},t.prototype.isSent=function(){var e=this;return this._bcd.mode===o.default.Read?this._itemChangingDeferred.Promise.then((function(t){var r=t,n="";if(r.itemType===m.default[m.default.appointment]){var o=t;n=o.organizer&&o.organizer.emailAddress}else{var i=r.from&&r.from.emailAddress;n=r.sender?r.sender.emailAddress:i}return!n||e.getUserEmailAddress().toLowerCase()===n.toLowerCase()})):Promise.resolve(!1)},t.prototype.getBody=function(e){var t=this,r=this.getMailboxItem()?this.getMailboxItem().body:null,o=Date.now();return new Promise((function(o,a){if(!r||!r.getAsync)return a(new i.ComponentError(n.default.GET_BODY,"body.getAsync method is not available.",i.ErrorCode.GENERIC));r.getAsync(t._toOfficeCoercionType(e),{},o);d.default.setTimeout((function(){a(new i.ComponentError(n.default.GET_BODY,"body.getAsync method timedout after 3000 ms",i.ErrorCode.GENERIC))}),3e3)})).then((function(e){return t._handleAsyncResponse(n.default.GET_BODY,e,o)})).catch((function(e){var r=c.ensureComponentErrorObject(e,i.ErrorCode.UNCAUGHT_EXCEPTION,n.default.GET_BODY);throw t._applicationContext.EventManager.ReportComponentFailure(r),r}))},t.prototype.setBodyHtml=function(e){var t=this;return this._itemChangingDeferred.Promise.then((function(r){var o=Date.now();return new Promise((function(t,o){if(!r||!r.body.setAsync)return o(new i.ComponentError(n.default.SET_BODY,"body.setAsync method is not available.",i.ErrorCode.GENERIC));r.body.setAsync(e,{coercionType:O.CoercionType.Html},t)})).then((function(e){return t._handleAsyncResponse(n.default.SET_BODY,e,o)})).catch((function(e){var r=c.ensureComponentErrorObject(e,i.ErrorCode.UNCAUGHT_EXCEPTION,n.default.SET_BODY);throw t._applicationContext.EventManager.ReportComponentFailure(r),r}))}))},Object.defineProperty(t.prototype,"isCategoriesApiSupported",{get:function(){return!!this._isSetSupported("mailbox",1.8)&&((!this.isMessage()||!this.isComposeMode()||this.getHostType()!==l.default.OutlookWebApp)&&Boolean(this._mailboxItem.categories&&this._mailboxItem.categories.getAsync&&this._mailboxItem.categories.addAsync&&this._mailboxItem.categories.removeAsync))},enumerable:!0,configurable:!0}),t.prototype.getMessageRecipients=function(){var e=this;return this._itemChangingDeferred.Promise.then((function(t){return e._isRecipientsGetAsyncAvailable()?e._getComposeMessageRecipients():e._getReadMessageRecipients()}))},t.prototype.getMeetingAttendees=function(){var e=this;return this._itemChangingDeferred.Promise.then((function(t){return e._isRecipientsGetAsyncAvailable()?e._getComposeMeetingAttendees():e._getReadMeetingAttendees()}))},t.prototype.setRoamingSettingsItem=function(e,t){try{O.context.roamingSettings.set(e,t)}catch(e){this._reportError(n.default.SET_ROAMING_SETTING,e)}},t.prototype.getRoamingSettingsItem=function(e){try{return O.context.roamingSettings.get(e)}catch(e){return this._reportError(n.default.GET_ROAMING_SETTING,e),null}},t.prototype.removeRoamingSettingsItem=function(e){try{O.context.roamingSettings.remove(e)}catch(e){this._reportError(n.default.REMOVE_ROAMING_SETTING,e)}},t.prototype.saveRoamingSettingsAsync=function(){var e=this,t=Date.now();return new Promise((function(e){return O.context.roamingSettings.saveAsync(e)})).then((function(r){return e._handleAsyncResponse(n.default.SAVE_ROAMING_SETTINGS,r,t)})).catch((function(t){var r=c.ensureComponentErrorObject(t,i.ErrorCode.UNCAUGHT_EXCEPTION,n.default.SAVE_ROAMING_SETTINGS);throw e._applicationContext.EventManager.ReportComponentFailure(r),r}))},t.prototype.getCustomProperties=function(){var e=this,t=Date.now();return this._itemChangingDeferred.Promise.then((function(r){return new Promise((function(e,t){r.loadCustomPropertiesAsync(e);d.default.setTimeout((function(){t(new i.ComponentError(n.default.LOAD_CUSTOM_PROPERTIES,"mailboxItem.loadCustomPropertiesAsync method timedout after 10000 ms",i.ErrorCode.GENERIC))}),1e4)})).then((function(r){return e._handleAsyncResponse(n.default.LOAD_CUSTOM_PROPERTIES,r,t)})).catch((function(t){var r=c.ensureComponentErrorObject(t,i.ErrorCode.UNCAUGHT_EXCEPTION,n.default.LOAD_CUSTOM_PROPERTIES);throw e._applicationContext.EventManager.ReportComponentFailure(r),r}))}))},t.prototype.setCustomProperties=function(e,t){var r=this;return void 0===t&&(t=!0),this.getCustomProperties().then((function(n){for(var o in e)n.set(o,e[o]);return r._saveCustomProperties(n).then((function(){t&&r.forcePropertiesSync()}))}))},t.prototype.removeCustomProperties=function(e,t){var r=this;return void 0===t&&(t=!0),this.getCustomProperties().then((function(n){return e.forEach((function(e){return n.remove(e)})),r._saveCustomProperties(n).then((function(){t&&r.forcePropertiesSync()}))}))},t.prototype.getCategories=function(){var e=this;return this._ensureMailboxItem.then((function(){if(!e.isCategoriesApiSupported)throw new i.ComponentError(n.default.GET_CATEGORIES,"Categories API is not supported",i.ErrorCode.NOT_SUPPORTED)})).then((function(){return e._executeAsync(n.default.GET_CATEGORIES,e._mailboxItem.categories.getAsync)})).then((function(e){return e?e.map((function(e){return e.displayName})):[]})).catch(this._reportTelemetryAsync(n.default.GET_CATEGORIES))},t.prototype.updateCategories=function(e){var t=this;return this._ensureMailboxItem.then((function(){if(!t.isCategoriesApiSupported)throw new i.ComponentError(n.default.UPDATE_CATEGORIES,"Categories API is not supported",i.ErrorCode.NOT_SUPPORTED);return t.getCategories()})).then((function(r){return t._updateCategories(r,e)})).catch(this._reportTelemetryAsync(n.default.UPDATE_CATEGORIES))},t.prototype.getToken=function(e){var t=this;void 0===e&&(e=!1);var r=this.isRestCallbackTokenSupported();if(!e){var o=this._callbackTokenProvider.getCachedToken(r,this._itemId);if(o)return Promise.resolve(o)}return this._itemChangingDeferred.Promise.then((function(e){return t.isComposeMode()&&!t._itemId?t._trySave("getToken").then((function(){return t._callbackTokenProvider.getToken(r)}),(function(e){var r=new i.ComponentError(n.default.GET_CALLBACK_TOKEN,"Unable to get callbackToken as we failed to save item in ComposeMode",e.code,e);throw t._applicationContext.EventManager.ReportComponentFailure(r),r})):t._callbackTokenProvider.getToken(r)}))},t.prototype.getEwsToken=function(){var e=this;return this._itemChangingDeferred.Promise.then((function(t){return e._callbackTokenProvider.getToken(!1)}))},t.prototype.getMailboxItemId=function(){var e=this;return this._itemChangingDeferred.Promise.then((function(t){return e._itemId?Promise.resolve(e._itemId):e.isComposeMode()?e._trySave():Promise.reject(new i.ComponentError(n.default.GET_MAILBOX_ITEM_ID,"Id is empty on mailbox item",i.ErrorCode.GENERIC))})).catch((function(t){var r=c.ensureComponentErrorObject(t,i.ErrorCode.UNCAUGHT_EXCEPTION,n.default.GET_MAILBOX_ITEM_ID);throw e._applicationContext.EventManager.ReportComponentFailure(r),r}))},t.prototype.forcePropertiesSync=function(e){void 0===e&&(e="Save item properties"),this._saveAsyncWithRetry(e).catch((function(){}))},t.prototype._trySave=function(e){var t=this;return this._saveAsyncPromise||(this._saveAsyncPromise=this._saveAsyncWithRetry(e).catch((function(e){t._saveAsyncPromise=null;var r=c.ensureComponentErrorObject(e,i.ErrorCode.UNCAUGHT_EXCEPTION,n.default.SAVE_ITEM);throw t._applicationContext.EventManager.ReportComponentFailure(r,t.getTelemetryParams()),r}))),this._saveAsyncPromise},t.prototype._saveAsyncWithRetry=function(e){var t=this;void 0===e&&(e="getItemId");var r=this.getMailboxItem();if(!r.saveAsync){var o=new i.ComponentError(n.default.SAVE_ITEM,"saveAsync API is not available",i.ErrorCode.OFFICE_SAVE_ASYNC_UNAVAILABLE);return Promise.reject(this._getSaveAsyncError(o))}var a=3,s=function(o){void 0===o&&(o=!1),t._applicationContext.EventManager.ReportTraceInfo(n.default.SAVE_ITEM,(o?"Retrying to save":"Saving")+' item asynchronously for "'+e+'"',null,t.getTelemetryParams());var u=Date.now();return new Promise((function(e){return r.saveAsync(e)})).then((function(r){var o=[{name:p.EventParameterName.CallReason,value:e}];return t._handleAsyncResponse(n.default.SAVE_ITEM,r,u,o)})).then((function(e){if(!e)throw new i.ComponentError(n.default.SAVE_ITEM,"Operation returned empty item Id",i.ErrorCode.OFFICE_SAVE_ASYNC);return t._itemId=e,e})).catch((function(e){t._itemId=null;var r=t._getSaveAsyncError(e);if(i.ErrorCode.isKnownOfficeSaveAsyncErrorCode(r.code))throw r;if(--a)return s(!0);throw r}))};return s()},t.prototype._getSaveAsyncError=function(e){var t,r=null;switch((e=c.ensureComponentErrorObject(e,i.ErrorCode.OFFICE_SAVE_ASYNC,n.default.SAVE_ITEM)).code){case i.ErrorCode.OFFICE_ASYNC_CALL_FAILED:r=u.getSaveAsyncErrorCodeByOfficeInternalCode(null===(t=e.innerError)||void 0===t?void 0:t.code);break;case i.ErrorCode.OFFICE_SAVE_ASYNC_UNAVAILABLE:u.isSaveAsyncUnsupportedInOutlookForWin(this._staticContext)?r=i.ErrorCode.OFFICE_SAVE_ASYNC_UNSUPPORTED_IN_OUTLOOK:u.isSaveAsyncUnsupportedInOWA(this._staticContext)&&(r=i.ErrorCode.OFFICE_SAVE_ASYNC_UNSUPPORTED_IN_OWA)}return r?new i.ComponentError(n.default.SAVE_ITEM,"Failed to save item",r,e):e},t.prototype.displayNewAppointmentForm=function(e){try{O.context.mailbox.displayNewAppointmentForm(e)}catch(e){this._reportError(n.default.DISPLAY_APPOINTMENT_FORM,e)}},t.prototype.isComposeMode=function(){return this._bcd.mode===o.default.Compose},t.prototype.getIsDesktopOutlook=function(){return this.getHostType()===l.default.Outlook},t.prototype.getMessageAttachmentIds=function(){var e=this.getMailboxItem();return this.getMailboxItemType()!==m.default[m.default.message]?Promise.reject(new i.ComponentError(n.default.GET_MESSAGE_ATTACHMENTS,"Can not read attachments for item other than message.",i.ErrorCode.GENERIC)):this.isComposeMode()?Promise.reject(new i.ComponentError(n.default.GET_MESSAGE_ATTACHMENTS,"Can not read attachments in compose. mailboxItem.attachments is empty.",i.ErrorCode.GENERIC)):e.attachments?Promise.resolve(e.attachments.map((function(e){return e.id}))):Promise.reject(new i.ComponentError(n.default.GET_MESSAGE_ATTACHMENTS,"MailboxItem.attachments is not defined.",i.ErrorCode.GENERIC))},t.prototype._onItemChangedHandler=function(e){var t=this,r=b+".ItemChanged",n=!(O&&O.context&&O.context.mailbox&&O.context.mailbox.item);this._applicationContext.EventManager.ReportTraceInfo(r,'Office JS "ItemChanged" event received',{item:!n,booting:this._itemChangedHandlerState!==S.Ready}),this._itemChangedHandlerState!==S.Initialized&&(this._itemChangedHandlerState===S.None&&(this._itemChangedHandlerState=S.Initialized),this._applicationContext.ComponentsLoader.loadingPromise.then((function(){t._itemChangedHandlerState=S.Ready;var n=!(O&&O.context&&O.context.mailbox&&O.context.mailbox.item);if(t._itemChangingDeferred.State()!==f.DeferredPromiseState.Pending&&(t._itemChangingDeferred=h.default.createDeferredPromise(),t._resetAsyncMethodsCache()),n)t._applicationContext.EventManager.ReportTraceInfo(r,"Waiting for Office JS Api to set item");else{t._setMailboxItem(),t._applicationContext.EventManager.ReportTraceInfo(r,"Invoking subscribed handlers");for(var o=0;o<t._itemChangedHandlers.length;o++)t._itemChangedHandlers[o]&&t._itemChangedHandlers[o](e)}}),(function(){return null})).catch((function(e){t._applicationContext.EventManager.ReportTraceError(new i.ComponentError(r,'Office JS "ItemChanged" event handler error',i.ErrorCode.GENERIC),[{name:p.ErrorEventParameterName.Error,value:e}])})))},t.prototype._resetAsyncMethodsCache=function(){this._sharedPropertiesPromise=null,this._saveAsyncPromise=null},t.prototype._subsribeToItemChangedEvent=function(){O.EventType&&O.EventType.ItemChanged&&O.context.mailbox.addHandlerAsync&&O.context.mailbox.addHandlerAsync(O.EventType.ItemChanged,this._onItemChangedHandler.bind(this))},t.prototype.addAppointmentTimeChangeHandler=function(e){this._appointmentTimeChangedHandlers.push(e)},t.prototype.removeAppointmentTimeChangeHandler=function(e){var t=this._appointmentTimeChangedHandlers.indexOf(e);this._appointmentTimeChangedHandlers.splice(t,1)},t.prototype._subscribeToAppointmentTimeChangedEvent=function(){O.EventType&&O.EventType.AppointmentTimeChanged&&this._isSetSupported("mailbox",1.7)&&this._mailboxItem.addHandlerAsync&&this._mailboxItem.addHandlerAsync(O.EventType.AppointmentTimeChanged,this._onAppointmentTimeChangedHandler.bind(this),this._onAppointmentTimeChangedCallback.bind(this))},t.prototype._onAppointmentTimeChangedHandler=function(e){this._applicationContext.EventManager.ReportTraceInfo(M,'Office JS "AppointmentTimeChanged" event received',{args:e});for(var t=0;t<this._appointmentTimeChangedHandlers.length;t++)this._appointmentTimeChangedHandlers[t]&&this._appointmentTimeChangedHandlers[t](e)},t.prototype._onAppointmentTimeChangedCallback=function(e){e.status===O.AsyncResultStatus.Failed&&this._applicationContext.EventManager.ReportTraceError(i.ComponentError.fromNativeError(M,i.ErrorCode.GENERIC,e.error))},t.prototype.addItemChangedHandler=function(e){this._itemChangedHandlers.push(e)},t.prototype.removeItemChangedHandler=function(e){var t=this._itemChangedHandlers.indexOf(e);this._itemChangedHandlers.splice(t,1)},Object.defineProperty(t.prototype,"onInitialized",{get:function(){return this._onInitialized},enumerable:!0,configurable:!0}),t.prototype.getHostType=function(){return this._staticContext.hostType},t.prototype.getRestVersionEnum=function(){return O.MailboxEnums.RestVersion},t.prototype.convertToRestId=function(e,t){return e?O.context.mailbox.convertToRestId?O.context.mailbox.convertToRestId(e,t):(this._applicationContext.EventManager.ReportTraceWarning(n.default.CONVERT_TO_REST_ID,'Office JS API "convertToRestId" is not supported. Converting locally'),e.replace(new RegExp("[/]","g"),"-").replace(new RegExp("[+]","g"),"_")):(this._applicationContext.EventManager.ReportTraceWarning(n.default.CONVERT_TO_REST_ID,"Item id is empty"),"")},t.prototype.convertToEwsId=function(e,t){return e?O.context.mailbox.convertToEwsId?O.context.mailbox.convertToEwsId(e,t):(this._applicationContext.EventManager.ReportTraceWarning(n.default.CONVERT_TO_EWS_ID,'Office JS API "convertToEwsId" is not supported. Converting locally'),e.replace(new RegExp("[-]","g"),"/").replace(new RegExp("[_]","g"),"+")):(this._applicationContext.EventManager.ReportTraceWarning(n.default.CONVERT_TO_EWS_ID,"Item id is empty"),"")},t.prototype._updateCategories=function(e,t){var r,o,i=h.default.arrayDifference(t,e),a=h.default.arrayDifference(e,t);return Promise.all([(null===(r=i)||void 0===r?void 0:r.length)&&this._executeAsync(n.default.ADD_CATEGORIES,this._mailboxItem.categories.addAsync,i),(null===(o=a)||void 0===o?void 0:o.length)&&this._executeAsync(n.default.REMOVE_CATEGORIES,this._mailboxItem.categories.removeAsync,a)]).then()},t.prototype._executeAsync=function(e,t){for(var r=this,n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var a=Date.now();return new Promise((function(e){t.apply(void 0,s(n,[e]))})).then((function(t){return r._handleAsyncResponse(e,t,a)})).catch((function(t){throw c.ensureComponentErrorObject(t,i.ErrorCode.GENERIC,e)}))},t}(T.default);t.JsApiProvider=w;var D=new Promise((function(e,t){x=Date.now(),O.initialize=function(){N=Date.now(),e()}}));t.default=function(){return function(e,t){var n=new w(e,t,D);return t.JsApiProvider=n,D.then((function(){t.Performance.addRetroactiveStopwatch(r.default.JS_API_PROVIDER+".OfficeInitialized",x,N);var e={RequirementSets:O.context&&O.context.requirements,EventTypes:O.EventType,Diagnostics:O.context&&O.context.diagnostics};t.EventManager.ReportTraceInfo(r.default.JS_API_PROVIDER+".OfficeJsContextDetails","Office JS API context details",e,n.getTelemetryParams())})),n.onInitialized}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(1)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(r,n,o,i){var a=e.call(this,r,n,o)||this;return a.diagnostics=i,Object.setPrototypeOf(a,t.prototype),a}return a(t,e),t}(r.default);t.default=n}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(61),r(6),r(9),r(2),r(4),r(1),r(62),r(93)],void 0===(o=function(e,t,r,n,o,i,s,u,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=i.default.Office(),d=function(e){function t(t,n,i){var a=e.call(this)||this;return a._bcd=t,a._applicationContext=n,a._isRest=i,a._storageKey=a._isRest?o.default.tokenCallbackRest:o.default.tokenCallbackEws,a._componentName=a._isRest?r.default.GET_REST_CALLBACK_TOKEN:r.default.GET_EWS_CALLBACK_TOKEN,a}return a(t,e),t.prototype.getToken=function(){var e=this;if(!this._tokenPromise){var t=this._applicationContext.Performance.addStopwatch(this._componentName,[{name:s.EventParameterName.IsFromCache,value:!1}]);this._terminateTokenRefresh(),this._tokenPromise=this._getCallbackToken(),this._tokenPromise.then((function(){t.stop(),e._tokenPromise=null}),(function(){e._tokenPromise=null}))}return this._tokenPromise},t.prototype._getCallbackToken=function(){var e=this;return new Promise((function(t,r){var o,a,l=0,d=function(p){i.default.clearTimeout(a),l++,e._handleAsyncResponse(e._componentName,p,o).then((function(){var o;try{o=e._getRawTokenExpiration(p.value),e._applicationContext.Storage.setItem(e._storageKey,p.value,Date.now()+e._getCleanTokenExpiration(o)),e._scheduleTokenRefresh(o),e._applicationContext.EventManager.ReportComponentSuccess(e._componentName,null,[{name:s.EventParameterName.Data,value:{attempts:l+1}}]),t(p.value)}catch(t){var i=new u.ComponentError(e._componentName,"Failed to parse callback token",u.ErrorCode.GENERIC,t);if(e._applicationContext.EventManager.ReportComponentFailure(i,[{name:s.ErrorEventParameterName.Error,value:n.default.errorToObject(t)}]),l<3)return f(!0);e._applicationContext.EventManager.ReportTraceError(new u.ComponentError(e._componentName,"An error occurred while retrieving the callback token",u.ErrorCode.UNCAUGHT_EXCEPTION,t)),r(i)}})).catch((function(){var t,n,o=new u.ComponentError(e._componentName,c.getOfficeErrorMessage(p),u.ErrorCode.AUTH_FAILED,c.getOfficeAsyncError(e._componentName,p));if(l<3)switch(e._applicationContext.EventManager.ReportTraceError(o),null===(n=null===(t=p)||void 0===t?void 0:t.error)||void 0===n?void 0:n.code){case c.OfficeErrorCode.NetworkError:i.default.setTimeout((function(){return f(!0)}),1e3);break;default:f(!0)}else e._applicationContext.EventManager.ReportComponentFailure(o),r(o)}))},f=function(t){void 0===t&&(t=!1),e._applicationContext.EventManager.ReportTraceInfo(e._componentName,(t?"Retrying to get":"Getting")+" callbackToken asynchronously"),o=Date.now(),p.context.mailbox.getCallbackTokenAsync({isRest:e._isRest},d),a=i.default.setTimeout((function(){e._applicationContext.EventManager.ReportTraceInfo(e._componentName,"Request timed out to get callbackToken asynchronously"),d({value:null,status:p.AsyncResultStatus.Failed,error:{code:c.OfficeErrorCode.CallTimedOut}})}),6e4)};f()}))},t.prototype.getCachedToken=function(e){var t=this._applicationContext.Storage.getItem(this._storageKey);if(!t)return null;try{n.default.parseToken(t)}catch(e){return this._applicationContext.EventManager.ReportTraceError(new u.ComponentError(this._componentName,"Failed to parse token retrieved from Storage",u.ErrorCode.GENERIC,e)),this._applicationContext.Storage.removeItem(this._storageKey),null}if(!this._expirationTimeout){var r=this._applicationContext.Storage.getItemExpiry(this._storageKey);this._scheduleTokenRefresh(r)}return t},t.prototype._scheduleTokenRefresh=function(e){var t=this;this._isRest&&(this._expirationTimeout=i.default.setTimeout((function(){t._applicationContext.EventManager.ReportTraceInfo(t._componentName,"Start scheduled token refresh"),t.getToken().catch((function(){}))}),this._getCleanTokenExpiration(e)))},t.prototype._terminateTokenRefresh=function(){this._expirationTimeout&&i.default.clearTimeout(this._expirationTimeout)},t.prototype._getRawTokenExpiration=function(e,t){var r=n.default.parseToken(e);if(r.appctx){var o=JSON.parse(r.appctx).scope;if(o&&o.indexOf("ParentItemId:")>-1)if(o.replace("ParentItemId:","")!==t)return 0}return 1e3*parseInt(r.exp,10)},t.prototype._getCleanTokenExpiration=function(e){return e-Date.now()-3e4},t}(l.default),f=function(){function e(e,t){this._bcd=e,this._applicationContext=t}return e.prototype.getToken=function(e){return this._getProvider(e).getToken()},e.prototype.getCachedToken=function(e,t){return this._getProvider(e).getCachedToken(t)},e.prototype._getProvider=function(e){return e?(this._restProvider||(this._restProvider=new d(this._bcd,this._applicationContext,!0)),this._restProvider):(this._ewsProvider||(this._ewsProvider=new d(this._bcd,this._applicationContext,!1)),this._ewsProvider)},e}();t.default=f}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(22)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPinnableTaskpaneSupported=function(e){var t=e.split("."),n=t[0],o=t[1],i=t[2];if(r.default.getInstance().getIsWindows()){return n&&parseInt(n,10)>=16&&i&&parseInt(i,10)>=7668}if(r.default.getInstance().getIsMac()){return n&&parseInt(n,10)>=16&&o&&parseInt(o,10)>=13&&o&&parseInt(i,10)>=503}return!1}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this._bcd=e,this._applicationContext=t}return e.prototype.validate=function(){var e=this._applicationContext.Storage.validate();if(e)throw e},e}();t.default=function(){return function(e,t){return new r(e,t).validate()}}}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(0),r(24),r(22),r(94),r(17),r(1),r(38)],void 0===(o=function(e,t,r,n,o,i,a,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){var r;this._errorCodesMessageMap=((r={})[s.ErrorCode.COMPATIBILITY_MOBILE_BROWSER_SUPPORT]="Mobile Devices are not supported by OnPrem configuration",r[s.ErrorCode.COMPATIBILITY_OUTLOOK_DESKTOP_WITH_IE_SUPPORT]="Unsupported IE version with Outlook Desktop",r[s.ErrorCode.COMPATIBILITY_BROWSER_SUPPORT]="Unsupported browser",r[s.ErrorCode.COMPATIBILITY_DEVICE_SUPPORT]="Unsupported device",r),this._bcd=e,this._applicationContext=t}return e.prototype._isOutlookMobile=function(){return this._bcd.deviceType===i.default.Phone||this._bcd.deviceType===i.default.Tablet||o.default.getInstance().getIsAndroid()||o.default.getInstance().getIsIPad()||o.default.getInstance().getIsIPhone()},e.prototype._isBrowserSupported=function(){return(o.default.getInstance().getIsBrowserIE()||o.default.getInstance().getIsBrowserEdge()||o.default.getInstance().getIsBrowserChrome()||o.default.getInstance().getIsBrowserFirefox()||o.default.getInstance().getIsBrowserSafari())&&o.default.getInstance().isRequiredApiSupported()},e.prototype._isDeviceSupported=function(){return o.default.getInstance().getIsIOSSupported()||o.default.getInstance().getIsAndroidSupported()||o.default.getInstance().getIsWindows()||o.default.getInstance().getIsMac()},e.prototype._isMobileDevice=function(){return o.default.getInstance().getIsWindowsPhone()||o.default.getInstance().getIsIPhone()||o.default.getInstance().getIsAndroidPhone()},e.prototype.runCompatibility=function(){var e=n.default.query("#loadingContainer");if(this._isOutlookMobile()&&(n.default.query(".mailApp",e).className+=" outlookMobile"),e.style.display="block",e.setAttribute("aria-hidden","false"),e.focus(),this._validateUserAgentSupport(this._applicationContext.JsApiProvider.getHostType()),this._isMobileDevice()&&this._bcd.exchangeDeploymentEnvironment===a.default.OnPremise)throw this._getErrorComponent(s.ErrorCode.COMPATIBILITY_MOBILE_BROWSER_SUPPORT);if(!this._isDeviceSupported())throw this._getErrorComponent(s.ErrorCode.COMPATIBILITY_DEVICE_SUPPORT)},e.prototype._validateUserAgentSupport=function(e){if(e!==u.default.OutlookMobile)if(e!==u.default.Outlook){if(!this._isBrowserSupported())throw this._getErrorComponent(s.ErrorCode.COMPATIBILITY_BROWSER_SUPPORT)}else if(o.default.getInstance().getIsBrowserIE()&&!o.default.getInstance().isRequiredApiSupported())throw this._getErrorComponent(s.ErrorCode.COMPATIBILITY_OUTLOOK_DESKTOP_WITH_IE_SUPPORT)},e.prototype._getErrorComponent=function(e){return new s.ComponentError(r.default.COMPATIBILITY_CHECK,this._errorCodesMessageMap[e],e)},e}();t.default=function(){return function(e,t){new c(e,t).runCompatibility()}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(49),r(4),r(11)],void 0===(o=function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){this._bcd=e,this._applicationContext=t}return e.prototype.validate=function(){var e=this;return this._applicationContext.CRMProvider.getUserValidation().catch((function(t){return e._applicationContext.EventManager.ReportTraceInfo(r.default.VALIDATE_USER,"Validation of user failed with error",null,[{name:o.ErrorEventParameterName.Error,value:t}]),e._applicationContext.CRMProvider.isFeatureControlBitEnabled(i.FcbNames.MailAppLimitedMode).then((function(o){return o&&n.isAllowedForLimitedMode(t)?(e._applicationContext.EventManager.ReportTraceInfo(r.default.VALIDATE_USER,"Allow user to run mail app in limited mode"),e._applicationContext.ComponentsLoader.ensureComponentLoaded(r.default.RESOURCE_MANAGER).then((function(){e._applicationContext.UIManager.showNotification(t,"LimitedMode_NotificationMessage")})),Promise.resolve()):Promise.reject(t)}))}))},e}();t.default=function(){return function(e,t){return new a(e,t).validate()}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(1),r(11),r(25),r(12)],void 0===(o=function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.default.DELEGATE_VALIDATOR+".validate";t.hideErrorReason="Switched from shared folder with failed state";var u=function(){function e(e,t){var r=this;this._bcd=e,this._applicationContext=t,this._applicationContext.JsApiProvider.addItemChangedHandler((function(){return r.validate()}))}return e.prototype.validate=function(){var e=this;return this._applicationContext.JsApiProvider.getSharedProperties().then((function(t){if(t){var r=t.delegatePermissions;return Promise.all([e._applicationContext.CRMProvider.isFeatureControlBitEnabled(o.FcbNames.ForceUsageOfCustomProperties),e._applicationContext.CRMProvider.isOrgSettingEnabled(i.DelegateAccessEnabled)]).then((function(e){var t=e[0],o=e[1];if(!t||!o)throw new n.ComponentError(s,"Delegate Scenario is not enabled (FCB: "+t+", OrgDbOrgSetting: "+o+")",n.ErrorCode.DELEGATE_DISABLED);if((r&Office.MailboxEnums.DelegatePermissions.Write)!==Office.MailboxEnums.DelegatePermissions.Write)throw new n.ComponentError(s,"Missing 'Write' permission during Delegate Access scenario. DelegatePermissions: '"+r+"'",n.ErrorCode.DELEGATE_DISABLED)}))}})).then((function(){e._validationResult instanceof n.ComponentError&&(e._applicationContext.UIManager.hideErrorMessage(e._validationResult,"Switched from shared folder with failed state"),e._validationResult=null)})).catch((function(t){e._validationResult=t,e._applicationContext.ComponentsLoader.ensureComponentLoaded(r.default.RESOURCE_MANAGER).then((function(){e._applicationContext.UIManager.showErrorMessage(t)}))}))},e}();t.default=function(){return function(e,t){e.mode!==a.default.Module&&new u(e,t).validate()}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(2),r(1),r(0)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.errorMessage="window.Office not availiable";var i=function(){function e(e,t){this._bcd=e,this._applicationContext=t}return e.prototype.validate=function(){this._checkOfficeAvailibility()},e.prototype._checkOfficeAvailibility=function(){if(!r.default.isOfficeExists())throw new n.default(o.default.VALIDATE_OFFICEJS,"window.Office not availiable",n.ErrorCode.OFFICE_FAILED_TO_LOAD)},e}();t.default=function(){return function(e,t){return new i(e,t).validate()}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(1),r(4),r(237),r(6),r(95)],void 0===(o=function(e,t,r,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentLoadingState=s.ComponentLoadingState;var u=function(){function e(e,t){this._bcd=e,this._applicationContext=t,this._definitions=[],this._components={},this._prevLoadComponentsCount=0,this._isLoadingFailed=!1,this._onComponentLoadedCallbacks=[],this._loadingPromise=a.default.createDeferredPromise(),this._loadStarted=!1}return Object.defineProperty(e.prototype,"loadingPromise",{get:function(){return this._loadingPromise.Promise},enumerable:!0,configurable:!0}),e.prototype.isComponentLoaded=function(e){if(!this._loadStarted)throw new Error("Can't call isComponentLoaded before load started");return this._throwIfComponentAbsent(e),this._components[e].loadingState===s.ComponentLoadingState.Loaded},e.prototype.ensureComponentLoaded=function(e){if(!this._loadStarted)throw new Error("Can't call ensureComponentLoaded before load started");return this._throwIfComponentAbsent(e),this._components[e].loadingDeferred.Promise},e.prototype.getComponentStates=function(){var e=this;return Object.keys(this._components).map((function(t){return{componentName:t,state:e._components[t].loadingState}}))},e.prototype.addDefinition=function(e){if(this._loadStarted)throw new Error("Definition '"+e.name+"' can't be added after load started");if(0!==this._definitions.filter((function(t){return t.name===e.name})).length)throw new Error("Definition '"+e.name+"' already added");this._definitions.push(e),this._components[e.name]={name:e.name,loadingDeferred:a.default.createDeferredPromise(),loadingState:s.ComponentLoadingState.None,bootableResult:void 0}},e.prototype.addOnComponentLoaded=function(e){this._onComponentLoadedCallbacks.push(e)},e.prototype.load=function(){if(this._loadStarted)throw new Error("Load already started");return this._loadStarted=!0,this._checkDependeciesAndLoadComponents(),this.loadingPromise},e.prototype._notifyComponentLoaded=function(e,t){var r=this;this._onComponentLoadedCallbacks.forEach((function(n){n(r._components[e.name],t)}))},e.prototype._ensureAllComponentsLoaded=function(){var e=this,t=this._getComponentsArray().filter((function(t){return e._components[t.name].loadingState===s.ComponentLoadingState.Loaded}));this._definitions.length===t.length&&(this._loadingPromise.Resolve(),this._applicationContext.Performance.setBooted(),i.default(this._applicationContext))},e.prototype._setComponentLoaded=function(e,t,n){var i=this;this._components[e.name].loadingState=s.ComponentLoadingState.Loaded,this._components[e.name].loadingDeferred.Resolve(n);var a=[{name:o.EventParameterName.DiagnosticsName,value:e.name},{name:o.EventParameterName.Location,value:r.default.COMPONENTS_LOADER}];this._applicationContext.EventManager.ReportComponentSuccess("MailApp."+e.name+".Boot",null,a),t.stop(),this._notifyComponentLoaded(e,this._getComponentsArray().filter((function(e){return i._components[e.name].loadingState===s.ComponentLoadingState.Loaded}))),this._ensureAllComponentsLoaded()},e.prototype._setComponentLoadFailed=function(e,t,r){n.ComponentError.isNativeError(r)&&(r=n.ComponentError.fromNativeError(e.name,n.ErrorCode.GENERIC,r)),this._components[e.name].loadingState=s.ComponentLoadingState.Failed,this._loadingPromise.Reject(r),this._isLoadingFailed=!0,t.stop(),i.default(this._applicationContext)},e.prototype._loadComponent=function(e,t){var r,n=this;if(void 0===t&&(t=!1),t)this._components[e.name].loadingState=s.ComponentLoadingState.WaitingForDependencies;else{var o;this._components[e.name].loadingState=s.ComponentLoadingState.Loading;try{o=this._applicationContext.Performance.addStopwatch(e.name+".Boot"),r=e.bootable(this._bcd,this._applicationContext)}catch(t){return void this._setComponentLoadFailed(e,o,t)}this._components[e.name].bootableResult=r,this._isPromise(r)?r.then((function(t){return n._setComponentLoaded(e,o,t)})).catch((function(t){return n._setComponentLoadFailed(e,o,t)})):this._setComponentLoaded(e,o)}},e.prototype._getComponentsArray=function(){var e=[];for(var t in this._components)e.push(this._components[t]);return e},e.prototype._ensureUpdateWaitingComponents=function(){var e=this,t=this._getComponentsArray().filter((function(t){var r=e._components[t.name];return r.loadingState===s.ComponentLoadingState.Loaded||r.loadingState===s.ComponentLoadingState.Loading}));t.length<this._definitions.length&&t.length>this._prevLoadComponentsCount&&(this._prevLoadComponentsCount=t.length,this._checkDependeciesAndLoadComponents())},e.prototype._checkDependeciesAndLoadComponents=function(){var e=this;if(!this._isLoadingFailed){for(var t=!1,r=function(r){var o=!0,i=[],a=n._definitions[r];if(n._components[a.name].loadingState!==s.ComponentLoadingState.None)return"continue";for(var u=0;u<a.dependsOnComponents.length;u++){var c=a.dependsOnComponents[u],l=n._components[c];if(l.loadingState===s.ComponentLoadingState.None||l.loadingState===s.ComponentLoadingState.WaitingForDependencies||l.loadingState===s.ComponentLoadingState.Failed){o=!1;break}var p=n._components[c].bootableResult;n._isPromise(p)&&i.push(p)}o&&(i.length>0?(n._loadComponent(a,!0),Promise.all(i).then((function(){e._loadComponent(a),e._ensureUpdateWaitingComponents()})).catch((function(){}))):n._loadComponent(a)),t=!0},n=this,o=0;o<this._definitions.length;o++)r(o);t&&this._ensureUpdateWaitingComponents()}},e.prototype._isPromise=function(e){return!!e&&!!e.then},e.prototype._throwIfComponentAbsent=function(e){if(!this._components[e])throw new Error("'"+e+"' is not present in the component loader")},e}();t.ComponentsLoader=u}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(4),r(2),r(48)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={xmlhttprequest:"ResourceTimings.XMLHttpRequest",script:"AssetLoad.Script",link:"AssetLoad.Stylesheet",css:"AssetLoad.CssUrl",img:"AssetLoad.Image",iframe:"AssetLoad.IFrame",fetch:"ResourceTimings.Fetch","":"ResourceTimings.Fetch"};function a(e,t,r){return e?!!e[t]||(r.EventManager.ReportTraceWarning("BrowserResourceTimings",t+" is not avaliable on performance object"),!1):(r.EventManager.ReportTraceWarning("BrowserResourceTimings","performance object is not available"),!1)}function s(e){for(var t=document.querySelectorAll("iframe"),r=0;r<t.length;r++){var n=t[r];n instanceof HTMLIFrameElement&&n.getAttribute("id")!==o.IFRAME_ID&&e(n)}}function u(e,t){a(e,"clearResourceTimings",t)&&e.clearResourceTimings()}t.default=function(e){var t=[],o=function(r,n){if(a(r,"getEntriesByType",e))for(var o=0,i=r.getEntriesByType("resource");o<i.length;o++){var s=i[o];t.push({resource:s,performanceObject:r,identifier:n})}},c=e.Performance.addStopwatch("BrowserResourceTimings.metricsСollecting");try{o(n.default.performance(),"MainWindow"),s((function(e){try{o(e.contentWindow.performance,e.id)}catch(e){}})),t.forEach((function(t){!function(e,t){var n=t.performanceObject,o=t.resource,a=n.timing.navigationStart-window.performance.timing.navigationStart,s=i[o.initiatorType];if(s){var u=o.responseEnd-o.startTime,c=n.timing.navigationStart+o.startTime,l=[{name:r.BrowserPerformanceEventParameterName.Window,value:t.identifier}];u<0&&(u=o.duration),o.connectEnd&&l.push({name:r.BrowserPerformanceEventParameterName.ConnectEnd,value:o.connectEnd+a}),o.connectStart&&l.push({name:r.BrowserPerformanceEventParameterName.ConnectStart,value:o.connectStart+a}),o.domainLookupEnd&&l.push({name:r.BrowserPerformanceEventParameterName.DomainLookupEnd,value:o.domainLookupEnd+a}),o.domainLookupStart&&l.push({name:r.BrowserPerformanceEventParameterName.DomainLookupStart,value:o.domainLookupStart+a}),o.duration&&l.push({name:r.BrowserPerformanceEventParameterName.Duration,value:o.duration}),o.fetchStart&&l.push({name:r.BrowserPerformanceEventParameterName.FetchStart,value:o.fetchStart+a}),o.name&&l.push({name:r.BrowserPerformanceEventParameterName.ResourceName,value:o.name}),o.redirectEnd&&l.push({name:r.BrowserPerformanceEventParameterName.RedirectEnd,value:o.redirectEnd+a}),o.redirectStart&&l.push({name:r.BrowserPerformanceEventParameterName.RedirectStart,value:o.redirectStart+a}),o.requestStart&&l.push({name:r.BrowserPerformanceEventParameterName.RequestStart,value:o.requestStart+a}),o.responseEnd&&l.push({name:r.BrowserPerformanceEventParameterName.ResponseEnd,value:o.responseEnd+a}),o.responseStart&&l.push({name:r.BrowserPerformanceEventParameterName.ResponseStart,value:o.responseStart+a}),o.workerStart&&l.push({name:r.BrowserPerformanceEventParameterName.WorkerStart,value:o.workerStart+a}),o.decodedBodySize&&l.push({name:r.BrowserPerformanceEventParameterName.DecodedBodySize,value:o.decodedBodySize}),o.encodedBodySize&&l.push({name:r.BrowserPerformanceEventParameterName.EncodedBodySize,value:o.encodedBodySize}),o.nextHopProtocol&&l.push({name:r.BrowserPerformanceEventParameterName.NextHopProtocol,value:o.nextHopProtocol}),o.secureConnectionStart&&l.push({name:r.BrowserPerformanceEventParameterName.TransferSize,value:o.secureConnectionStart+a}),o.transferSize&&l.push({name:r.BrowserPerformanceEventParameterName.TransferSize,value:o.transferSize}),o.responseStart&&void 0!==o.transferSize&&l.push({name:r.EventParameterName.IsFromCache,value:(0===o.transferSize).toString()}),e.Performance.addRetroactiveStopwatch(s,c,c+u,l)}}(e,t)})),function(e){u(n.default.performance(),e),s((function(t){u(t.contentWindow.performance,e)}))}(e)}catch(t){e.EventManager.ReportTraceWarning("BrowserResourceTimings","Exception occurred while using Performance API")}finally{c.stop()}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(2),r(1),r(7),r(0)],void 0===(o=function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(){return function(e,t){var a=function(e){var t=e.DispatcherCollection[o.default.APPLICATION];if(!t){var r=new n.ComponentError(i.default.LOAD_TIMEOUT,"Application dispatcher is unavailable",n.ErrorCode.GENERIC);return Promise.reject(r)}return t.clientInitialized.catch((function(e){var t="Error during client load";e&&e.componentName&&(t+=": "+e.componentName),e&&e.message&&(t+=" - "+e.message);var r=new n.ComponentError(i.default.LOAD_TIMEOUT,t,n.ErrorCode.GENERIC);return Promise.reject(r)}))}(t),s=new Promise((function(e,t){r.default.setTimeout((function(){var e=new n.ComponentError(i.default.LOAD_TIMEOUT,"Client loader timed out",n.ErrorCode.CLIENT_LOAD_TIMEOUT);t(e)}),3e5)}));return Promise.race([a,s])}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(12),r(94),r(17),r(29),r(9),r(63)],void 0===(o=function(e,t,r,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e){this._displayMode=e.mailAppMode,this._orgName=e.org,this._crmDeploymentEnvironment="onprem"===e.de?o.default.OnPremise:o.default.Online,this._exchangeDeploymentEnvironment="onprem"===e.sde?o.default.OnPremise:o.default.Online,this._orgId=e.orgId,this._externalDomain=e.ed,this._mailboxId=e.mailboxId,this._showPerformance=e.showperf&&("true"===e.showperf||"1"===e.showperf),this._showPerformance||(this._showPerformance="true"===s.default.localStorage.getItem(a.default.showPerfWidget)),this._collectorService=e.collectorurl,e.useAuthMethod===i.default.Token.toString()?this._useAuthMethod=i.default.Token:e.useAuthMethod===i.default.Cookie.toString()?this._useAuthMethod=i.default.Cookie:e.useAuthMethod===i.default.WIA.toString()?this._useAuthMethod=i.default.WIA:this._useAuthMethod=i.default.Default,this._secondaryLoad=e.secondaryLoad&&("true"===e.secondaryLoad||"1"===e.secondaryLoad),-1!==this._displayMode.indexOf("Compose")?this._mode=r.default.Compose:-1!==this._displayMode.indexOf("Module")?this._mode=r.default.Module:this._mode=r.default.Read,this._deviceType=n.default.Desktop,void 0!==this._displayMode&&(-1!==this._displayMode.indexOf("Phone")?this._deviceType=n.default.Phone:-1!==this._displayMode.indexOf("Tablet")&&(this._deviceType=n.default.Tablet)),this._testMode="true"===e.testmode}return Object.defineProperty(e.prototype,"orgName",{get:function(){return this._orgName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"orgId",{get:function(){return this._orgId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"externalDomain",{get:function(){return this._externalDomain},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayMode",{get:function(){return this._displayMode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"crmDeploymentEnvironment",{get:function(){return this._crmDeploymentEnvironment},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"exchangeDeploymentEnvironment",{get:function(){return this._exchangeDeploymentEnvironment},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showPerformance",{get:function(){return this._showPerformance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"testMode",{get:function(){return this._testMode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"collectorService",{get:function(){return this._collectorService},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mode",{get:function(){return this._mode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useAuthMethod",{get:function(){return this._useAuthMethod},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"secondaryLoad",{get:function(){return this._secondaryLoad},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deviceType",{get:function(){return this._deviceType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mailboxId",{get:function(){return this._mailboxId},enumerable:!0,configurable:!0}),e}();t.default=u}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(9),r(11),r(12),r(1)],void 0===(o=function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){var r=this;this._appContext=e,this._bcd=t,t.mode!==i.default.Module&&e.JsApiProvider.addItemChangedHandler((function(){return r.updateAppPinningStateInfo()}))}return e.prototype.checkForAppPinningNotification=function(){var e=this;return this._bcd.mode===i.default.Module?Promise.resolve():Promise.all([this._appContext.CRMProvider.isFeatureControlBitEnabled(o.FcbNames.MailAppPinningStateNotification),this._appContext.CRMProvider.isLimitedMode()]).then((function(t){var o=t[0],i=t[1];if(o&&!i&&e._appContext.JsApiProvider.isAppPinningSupported()){var a=e._appContext.Storage.getItem(n.default.unpinnedBootCount),s=e._appContext.Storage.getItem(n.default.lastPinnedStateTimestamp);null!==a&&a>=0?a++:a=1,(!s||e._daysElapsedSinceLastPinned(s)>14)&&a>10&&(e._appContext.UIManager.showAppPinningNotification("PinnedMode_NotificationMessage"),e._appContext.EventManager.ReportTraceInfo(r.default.UI_MANAGER,"Pinning notification shown"),a=0),e._appContext.Storage.setItem(n.default.unpinnedBootCount,a)}})).catch((function(t){e._appContext.EventManager.ReportTraceError(new a.ComponentError(r.default.UI_MANAGER,"Failed to show pinning notification",a.ErrorCode.GENERIC,t))}))},e.prototype.updateAppPinningStateInfo=function(){var e=this;return this._appContext.CRMProvider.isFeatureControlBitEnabled(o.FcbNames.MailAppPinningStateNotification).then((function(t){if(t&&e._appContext.JsApiProvider.isAppPinningSupported()){var o=(new Date).toISOString();e._appContext.Storage.setItem(n.default.lastPinnedStateTimestamp,o),e._appContext.Storage.setItem(n.default.unpinnedBootCount,0),e._appContext.EventManager.ReportTraceInfo(r.default.UI_MANAGER,"App pinning info updated")}})).catch((function(t){e._appContext.EventManager.ReportTraceError(new a.ComponentError(r.default.UI_MANAGER,"Failed to update pinning state info",a.ErrorCode.GENERIC,t))}))},e.prototype._daysElapsedSinceLastPinned=function(e){var t=0;if(e){var r=new Date,n=new Date(e);t=(r.getTime()-n.getTime())/864e5}return t},e}();t.default=s}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(1),r(242),r(74),r(4),r(245),r(24),r(246),r(2),r(9),r(249),r(66),r(251),r(253),r(273),r(274),r(63),r(280)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c,l,p,d,f,h,_,m,v,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=function(){function e(){this._applicationContext=new _.default}return e.prototype.initialize=function(e){return this._bcd=e,this._initializeApplicationContext()},e.prototype._initializeApplicationContext=function(){var e=this,t=c.default.location().port?":"+c.default.location().port:"";return this._applicationContext.OrgUrl=c.default.location().protocol+"//"+c.default.location().hostname+t,this._applicationContext.Storage=new m.default(this._bcd,this._applicationContext),this._applicationContext.Performance=new f.default(this._bcd,this._applicationContext),this._initializeEventManager(),n.default(this._applicationContext),c.default.setTimeout((function(){e._applicationContext.Performance.addRetroactiveStopwatch("CSSInit",c.default.PageLoadStartTime(),c.default.LibrariesLoadStartTime()),e._applicationContext.Performance.addRetroactiveStopwatch("JsLoad",c.default.LibrariesLoadStartTime(),c.default.LibrariesLoadEndTime()),e._applicationContext.Performance.addRetroactiveStopwatch("ShimJsLoad",c.default.LibrariesLoadEndTime(),c.default.ShimJsLoadEndTime())}),0),this._applicationContext.ResourceManager=new o.ResourceManager(this._bcd,this._applicationContext),this._applicationContext.UIManager=new u.default(this._bcd,this._applicationContext),this._applicationContext.AppChecker=new g.default(this._bcd,this._applicationContext),this._applicationContext.UIManager.subscribeToErrorEvent((function(t){e._applicationContext.EventManager.ReportComponentFailure(new r.default("MailApp.Application",t.message,t.code,t),[{name:i.ErrorEventParameterName.ComponentErrorComponentName,value:t.componentName}])}),(function(t){e._applicationContext.EventManager.ReportComponentSuccess("MailApp.Application","Application restored. Reason: "+t)})),this._applicationContext},e.prototype._initializeEventManager=function(){var e=[];"true"===v.default.getItem(l.default.developerToolsEnabled)?(e.push(d.getDeveloperConsoleEventsStoreListener(this._applicationContext)),e.push(new a.default(new p.default))):e.push(new a.default(c.default.console())),this._applicationContext.EventManager=new h.default(this._bcd,this._applicationContext,e),this._applicationContext.EventManager.Initialize()},e.prototype.renderUI=function(){var e=s.default.query("#loadingContainer");return e.setAttribute("aria-hidden","true"),e.style.display="none",s.default.query("#loadingTitle").setAttribute("aria-live","off"),Promise.resolve(null)},e}();String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,(function(t,r){return void 0!==e[r]?e[r]:t}))}),Object.setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t.default=function(){return new E}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(72),r(243),r(22),r(2),r(97),r(21),r(4)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function l(e,t,r,n,s,u){var c;return void 0===s&&(s=0),void 0===u&&(u=0),!function(e){return!!i.default.getInstance().getIsBrowserIE()&&"143abf4577894d22ae34a054a6dce7fe"===e}(e)?c=function(e,t,r,n,i,s){var u=new o.default(i),c={isOutOfMemoryError:!1};return c.lineNumber=r,c.columnNumber=n,c.func=u.getFunctionName(),c.fileName="index.html",c.browserLanguage=a.default.navigator().language,c.stackTrace=u.getStackTrace(),c.errorMessage=e,c.error=i,c.errorType=s,c}(e,0,s,u,r,n):((c={}).browserLanguage=a.default.navigator().language,c.errorMessage="Out of Memory!",c.lineNumber=s,c.columnNumber=u,c.func="anonymous",c.fileName="index.html",c.isOutOfMemoryError=!0,c.errorType=n,c.error=r),c}t.default=function(e){var t=function(e){return function(t){var o,i=u.ensureComponentErrorObject(t.error,void 0,r.default.ERROR_HANDLER);t.errorType===n.ErrorType.UnhandledError&&(o=[{name:c.ErrorEventParameterName.Error,value:t}]),e.EventManager.ReportComponentFailure(i,o)}}(e);!function(e){a.default.addEventListener("unhandledrejection",(function(t){t.preventDefault&&t.preventDefault();var r=new s.CrmURL(a.default.location().href),o=t.detail||t;if(void 0!==o&&void 0!==o.reason&&void 0!==o.promise)o.promise.catch((function(t){var i=u.ensureErrorObject(t),a=l(i.message,r.pathname,i,n.ErrorType.UnhandledRejection,o.reason.lineNumber,o.reason.columnNumber);e(a)}));else{var i=function(e,t){var r="";try{r=JSON.stringify(t)}catch(e){r="Received an uncaught Unknown Error Event which failed to be stringified for the following reason: "+e.message}return l(r,e,Error("Unknown Error Event"),n.ErrorType.UnhandledRejection)}(r.pathname,t);e(i)}}))}(t),function(e){a.default.onError((function(t,r,o,i,a){a&&!a.message&&t&&(a.message=t);var s=l(t,r,a,n.ErrorType.UnhandledError,o,i);e(s)}))}(t)}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._stackFrame=this._internalGetStackTrace(e)}return e.prototype.getFunctionName=function(){this._stackFrame.startsWith("    at ")&&(this._stackFrame=this._stackFrame.substr("    at ".length));this._stackFrame.startsWith("Function.")&&(this._stackFrame=this._stackFrame.substr("Function.".length));var e,t=this._stackFrame.indexOf("("),r=this._stackFrame.indexOf(" ");if(-1===t&&-1===r)return"anonymous";e=t>0&&r>0?Math.min(t,r):Math.max(t,r);var n=this._stackFrame.substr(0,e),o=n.indexOf("$",0);if(-1===o)return"anonymous";var i=n.indexOf("$",o+1);if(-1===i)return n;var a=n.indexOf("$",i+1);return-1===a?n:n.substr(i+1,a-o)},e.prototype.getStackTrace=function(){return this._stackFrame},e.prototype._internalGetStackTrace=function(e){if(null==e)return"BrowserErrorHandler.InternalGetStackTrace: Extended error information not available from this browser.";var t=e.stack;if(void 0===t)return"BrowserErrorHandler.InternalGetStackTrace: Exception stack trace not available from this browser.";for(var r=t.split("\n"),n="",o=0;o<r.length;o++){var i=r[o];""!==i&&(n+=i+"\r\n")}return n},e}();t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(t){void 0===t&&(t=""),this._params=[],"string"==typeof t?this._initFromString(t):t instanceof e&&this._initFromUrlParameters(t)}return e.prototype.append=function(e,t){this._params.push({name:e,value:t}),this._update()},e.prototype.delete=function(e){for(var t=this._params.length-1;t>=0;t--){e===this._params[t].name&&this._params.splice(t,1)}this._update()},e.prototype.get=function(e){for(var t=null,r=0;r<this._params.length;r++){var n=this._params[r];if(e===n.name){t=n.value;break}}return t},e.prototype.getAll=function(e){for(var t=[],r=0,n=this._params;r<n.length;r++){var o=n[r];e===o.name&&t.push(o.value)}return t},e.prototype.has=function(e){for(var t=!1,r=0;r<this._params.length;r++){if(e===this._params[r].name){t=!0;break}}return t},e.prototype.set=function(e,t){var r;for(r=0;r<this._params.length;r++){if(e===(o=this._params[r]).name){o.value=t;break}}if(r===this._params.length)this._params.push({name:e,value:t});else for(var n=this._params.length-1;n>r;n--){var o;e===(o=this._params[n]).name&&this._params.splice(n,1)}this._update()},e.prototype.toString=function(){return this._params.map((function(e){var t=e.name,r=e.value;return(t=(t=encodeURIComponent(t)).replace(/%20/g,"+"))+"="+(r=(r=encodeURIComponent(r)).replace(/%20/g,"+"))})).join("&")},e.prototype.toDictionary=function(){return this._params.reduce((function(e,t){return e[t.name]=t.value,e}),{})},e.prototype._initFromString=function(e){var t;"?"===e.charAt(0)&&(e=e.slice(1));for(var r=e.split("&"),n=0;n<r.length;n++){var o=r[n];if(""!==o){var i=void 0,a=void 0;-1!==o.indexOf("=")?(i=(t=o.split("="))[0],a=t[1]):(i=o,a=""),i=i.replace(/\+/g," "),a=a.replace(/\+/g," "),i=decodeURIComponent(i),a=decodeURIComponent(a),this._params.push({name:i,value:a})}}},e.prototype._initFromUrlParameters=function(e){for(var t=0;t<e._params.length;t++){var r=e._params[t],n={name:r.name,value:r.value};this._params.push(n)}},e.prototype._update=function(){this.urlInternal&&(this.urlInternal.search=this.toString())},e.prototype.updateFromUrlInternal=function(){this.urlInternal&&(this._params=[],this._initFromString(this.urlInternal.search))},e}();t.URLSearchParams=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(4),r(41),r(44),r(22)],void 0===(o=function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e){this._console=e}return e.prototype.handleEvent=function(e,t){i.default.getInstance().getIsBrowserChrome()?this._printWebAPIStructured(e):this._printMessage(this._eventToString(e),e.getEventLevel())},e.prototype._printWebAPIStructured=function(e){var t=this,n="Event: "+e.getEventName();this._createGroupSafely(n,(function(){var n=t._getMainInfo(e);t._printMessage(n,e.getEventLevel()),t._createGroupSafely("Details",(function(){t._createGroupSafely("Event Parameters",(function(){t._console.table(t._formatParametersForTable(e.getEventParameters()))}),!0);var n=e.getEventParameterValue(r.ErrorEventParameterName.CallStack);n&&t._createGroupSafely("Call Stack",(function(){t._console.log(n)}),!0)}),!0)}))},e.prototype._createGroupSafely=function(e,t,r){void 0===r&&(r=!1),r?this._console.groupCollapsed(e):this._console.group(e);try{t()}catch(e){}finally{this._console.groupEnd()}},e.prototype._formatParametersForTable=function(e){var t={};for(var n in e){var o=e[n];if(r.KnownEventParameterName.EventContextName===n){if(!o)continue;t=Object.assign(t,this._formatParametersForTable(o))}else if(r.ErrorEventParameterName.CallStack!==n){var i=null!==o?o.toString():"";t[n]={value:i}}}return t},e.prototype._printMessage=function(e,t){switch(t){case n.ApplicationEventLevel.Error:this._console.error(e);break;case n.ApplicationEventLevel.Warning:this._console.warn(e);break;case n.ApplicationEventLevel.Info:this._console.info(e);break;default:this._console.log(e)}},e.prototype._getHeaderString=function(e){var t="["+e.getEventName()+"]";return t+="   "+this._getMainInfo(e)+"\n"},e.prototype._getMainInfo=function(e){var t=e.getEventParameterValue(r.EventParameterName.Message),n=e.getEventParameterValue(r.EventParameterName.ComponentName),o="";return n&&(o="["+n+"]"),r.EVENT_NAME.Performance===e.getEventName()?(o.length>0&&(o+="\n"),o+="MetricName: "+e.getEventParameterValue(r.PerformanceEventParameterName.MetricName)+"\n",o+="MetricValue: "+e.getEventParameterValue(r.PerformanceEventParameterName.MetricValue)+"\n"):t&&(o.length>0&&(o+="\t"),o+="Message: "+t),o},e.prototype._getParameterStringPair=function(e,t){for(var r=e,n=""+o.toSimpleTypeValue(t);n.length>r.length;)r+=" ";for(;r.length>n.length;)n+=" ";return[r+="   ",n+="   "]},e.prototype._getDetailsString=function(e){var t,n=e.getEventParameters(),o="",i="",a="",s="",u="",c="";i+="---Details---\n";for(var l in{}[r.KnownEventParameterName.ActivityId]=e.getActivityId(),n)r.ErrorEventParameterName.CallStack!==l?(u=(t=this._getParameterStringPair(l,n[l]))[0],c=t[1],a.length+u.length>160?(i+=a+"\n",a=u,i+=s+"\n\n",s=c):(a+=u,s+=c)):o=""+n[l];return i+=a+"\n",i+=s+"\n",o&&(i+="---Call Stack---\n"+o),i},e.prototype._eventToString=function(e){var t=this._getHeaderString(e);return t+=this._getDetailsString(e)},e}();t.default=a}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(24),r(98),r(1),r(2),r(247),r(248),r(65)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(t,o){var i=this;this._errorDialogElement=n.default.query("#"+e.errorDialogContainerId),this._error=null,this._eventHandlers=[],this._isErrorDetailsHidden=!0,this._progressMessageTimerId=null,this.showProgressMsg=function(e){if(i._applicationContext.ComponentsLoader.isComponentLoaded(r.default.RESOURCE_MANAGER)){var t=n.default.query("#loadingTitle");if(t.parentNode){var o=i._applicationContext.ResourceManager.getString(e);i._progressMessageTimerId&&a.default.clearTimeout(i._progressMessageTimerId);var s=t.cloneNode();s.innerHTML=o,t.parentNode.replaceChild(s,t),"off"!==t.getAttribute("aria-live")&&(i._progressMessageTimerId=a.default.setTimeout(i.showProgressMsg,5e3,o))}}},this._toggleErrorDetails=function(){i._isErrorDetailsHidden=!i._isErrorDetailsHidden,i._errorDialogElement.querySelector("."+c.UIClassNames.SHOW_MORE_BUTTON+" a").textContent=i._moreButtonLabel,i._errorDialogElement.querySelector("."+c.UIClassNames.ERROR_INFO).setAttribute("aria-hidden",i._isErrorDetailsHidden.toString())},this._bcd=t,this._applicationContext=o}return Object.defineProperty(e.prototype,"_sessionId",{get:function(){return this._applicationContext.EventManager.getSessionId()},enumerable:!0,configurable:!0}),e.areErrorsEqual=function(e,t){return e&&t?e.componentName===t.componentName&&e.code===t.code&&e.message===t.message:e===t},e.prototype.subscribeToErrorEvent=function(e,t){this._error?e(this._error):this._eventHandlers.push([e,t])},e.prototype.hideErrorMessage=function(t,r){!this._error||t&&!e.areErrorsEqual(this._error,t)||(this._error=null,this._hideErrorMessageInternal(),this._errorDialogElement.setAttribute("aria-hidden","true"),this._errorDialogElement.removeAttribute("aria-labelledby"),this._errorDialogElement.removeAttribute("aria-describedby"),this._toggleAriaAttributes(),this._onErrorHidden(r))},e.prototype.showNotification=function(e,t){var r=this._getHelpLink(e),n=t?this._applicationContext.ResourceManager.getString(t):this._applicationContext.ResourceManager.getErrorMessage(e);return new s.default(this._applicationContext,r,n).render()},e.prototype.showAppPinningNotification=function(e){var t=this._applicationContext.ResourceManager.getString(e);new u.default(this._applicationContext,"https://docs.microsoft.com/dynamics365/outlook-app/dynamics-365-app-outlook-user-s-guide?source=docs#experience-app-for-outlook-as-a-pinnable-taskpane",t).render()},e.prototype._getHelpLink=function(e){if(!e||e.code!==i.ErrorCode.UNKNOWN)return o.default.generate(e,this._sessionId,this._bcd.orgId)},e.prototype.showErrorMessage=function(t){if(t||(t=i.ComponentError.fromNativeError(r.default.UI_MANAGER,i.ErrorCode.UNKNOWN,new Error("Unknown error occurred"))),this._error&&e.areErrorsEqual(this._error,t))return this._onErrorEvent(t);this._error&&this._hideErrorMessageInternal(),this._error=t,n.default.query("#loadingContainer").setAttribute("aria-hidden","true"),n.default.query("#loadingTitle").setAttribute("aria-live","off");var o=this._getHelpLink(t),a=this._applicationContext.ResourceManager.getErrorTitle(t),s=this._applicationContext.ResourceManager.getErrorMessage(t),u=this._applicationContext.ResourceManager.getString("MailApp.Generic.ActivityId").format(this._sessionId,(new Date).toUTCString(),t&&t.message||"",t&&t.stack||""),c=this._getErrorMessageTemplate(a,s,u,this._moreButtonLabel,o),l=n.default.createFragment(c);this._errorDialogElement.appendChild(l),this._errorDialogElement.setAttribute("aria-hidden","false"),this._errorDialogElement.setAttribute("aria-labelledby","errorTitle"),this._errorDialogElement.setAttribute("aria-describedby","errorMessage"),this._errorDialogElement.focus(),this._toggleAriaAttributes(!0),this._setShowMoreButtonListener(),this._onErrorEvent(t)},e.prototype._hideErrorMessageInternal=function(){this._isErrorDetailsHidden=!0,this._removeShowMoreButtonListener(),this._errorDialogElement.innerHTML=""},e.prototype._toggleAriaAttributes=function(e){void 0===e&&(e=!1),n.default.query("#content").setAttribute("aria-hidden",e.toString())},e.prototype._setShowMoreButtonListener=function(){this._errorDialogElement.querySelector("."+c.UIClassNames.SHOW_MORE_BUTTON+" a").addEventListener("click",this._toggleErrorDetails)},e.prototype._removeShowMoreButtonListener=function(){this._errorDialogElement.querySelector("."+c.UIClassNames.SHOW_MORE_BUTTON+" a").removeEventListener("click",this._toggleErrorDetails)},Object.defineProperty(e.prototype,"_moreButtonLabel",{get:function(){return this._applicationContext.ResourceManager.getString("MailApp_Error_Show_"+(this._isErrorDetailsHidden?"More":"Less")+"_Button")},enumerable:!0,configurable:!0}),e.prototype._getErrorMessageTemplate=function(e,t,r,n,o){var i=this._applicationContext.ResourceManager.getString("MailApp_ScanForIssuesLabel");return'\n\t\t\t<div class="errorContainer">\n\t\t\t\t<h2 id="errorTitle" class="errorTitle">'+e+'</h2>\n\t\t\t\t<p id="errorMessage" class="errorMessage">'+t+"</p>\n\t\t\t\t"+this._getHelpLinkTemplate(o)+'\n\t\t\t\t<a href="#" class="'+c.UIClassNames.SHOW_APP_CHECKER+'">'+i+'</a>\n\t\t\t\t\n\t\t\t\t<div class="'+c.UIClassNames.SHOW_MORE_BUTTON+'">\n\t\t\t\t\t<a href="#">'+n+'</a>\n\t\t\t\t</div>\n\t\t\t\t<p class="'+c.UIClassNames.ERROR_INFO+'" aria-hidden="'+this._isErrorDetailsHidden+'">'+r+"</p>\n\t\t\t</div>\n\t\t"},e.prototype._getHelpLinkTemplate=function(e){return e?'<div class="helpLink"><a target="_blank" href="'+e+'">'+this._applicationContext.ResourceManager.getString("MoCA_OWA_Help_Link_Text")+"</a></div>":""},e.prototype._onErrorEvent=function(e){var t=this;this._eventHandlers&&this._eventHandlers.length&&this._eventHandlers.forEach((function(n){var o=n[0];try{o(e)}catch(n){e.innerError=i.ComponentError.fromNativeError(r.default.UI_MANAGER,i.ErrorCode.GENERIC,n),t._applicationContext.EventManager.ReportTraceError(e)}}))},e.prototype._onErrorHidden=function(e){var t=this;this._eventHandlers&&this._eventHandlers.length&&this._eventHandlers.forEach((function(n){var o=n[1];try{o(e)}catch(e){var a=i.ComponentError.fromNativeError(r.default.UI_MANAGER,i.ErrorCode.GENERIC,e);t._applicationContext.EventManager.ReportTraceError(a)}}))},e.errorDialogContainerId="errorDialog",e}();t.default=l}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(24),r(99)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n){var o=e.call(this,t)||this;return o._isCollapsed=!0,o._message="",o._helpLink="",o._onClick=function(e){o._isCollapsed=!o._isCollapsed&&e.target!==e.currentTarget&&e.target.classList.contains("collapse"),o._setIsCollapsed()},o._message=n,o._helpLink=r,o}return a(t,e),Object.defineProperty(t.prototype,"htmlTemplate",{get:function(){var e=this._applicationContext.ResourceManager.getString("MailApp_LearnMoreLabel");return'\n\t\t\t<div class="'+n.ClassNames.NotificationComponent+" "+n.ClassNames.Collapsed+'" role="presentation">\n\t\t\t\t<span class="svgIcon info"></span>\n\t\t\t\t<div class="'+n.ClassNames.Label+'">\n\t\t\t\t\t<div class="'+n.ClassNames.Text+'" >'+this._message+"</div>\n\t\t\t\t\t<a aria-label="+this._message+'" tabindex="-1" href="'+this._helpLink+'" target="_blank" class="helpLink">'+e+'</a>\n\t\t\t\t</div>\n\t\t\t\t<span class="svgIcon collapse"></span>\n\t\t\t</div>\n\t\t'},enumerable:!0,configurable:!0}),t.prototype.render=function(){return e.prototype.render.call(this),this.setEventListeners(),this},t.prototype._setIsCollapsed=function(){r.default.query("."+n.ClassNames.NotificationComponent).classList.toggle(n.ClassNames.Collapsed,this._isCollapsed)},t.prototype.close=function(){this._isRendered=!1,r.default.query("."+n.ClassNames.NotificationComponent).removeEventListener("click",this._onClick),r.default.removeElement("."+n.ClassNames.NotificationComponent)},t.prototype.setEventListeners=function(){r.default.query("."+n.ClassNames.NotificationComponent).addEventListener("click",this._onClick)},t}(n.NotificationBase);t.default=o}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(24),r(99)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,o,i){var a=e.call(this,t)||this;return a._message="",a._helpLink="",a._onClose=function(){a._isRendered=!1,r.default.query("#notification-close").removeEventListener("click",a._onClose),r.default.removeElement("."+n.ClassNames.NotificationComponent)},a._message=i,a._helpLink=o,a}return a(t,e),Object.defineProperty(t.prototype,"htmlTemplate",{get:function(){var e=this._applicationContext.ResourceManager.getString("MailApp_LearnMoreLabel");return'\n\t\t\t<div class="'+n.ClassNames.NotificationComponent+' role="presentation">\n\t\t\t\t<span class="svgIcon info"></span>\n\t\t\t\t<div class="'+n.ClassNames.Label+'">\n\t\t\t\t\t<div class="'+n.ClassNames.Text+'" >'+this._message+'</div>\n\t\t\t\t\t<a aria-label="'+this._message+'" tabindex="-1" href="'+this._helpLink+'" target="_blank" class="helpLink">'+e+'</a>\n\t\t\t\t</div>\n\t\t\t\t<span class="svgIcon close" style="width: 24px; height: 12px;" id="notification-close"></span>\n\t\t\t</div>\n\t\t'},enumerable:!0,configurable:!0}),t.prototype.render=function(){return e.prototype.render.call(this),this.setEventListeners(),this},t.prototype.setEventListeners=function(){r.default.query("#notification-close").addEventListener("click",this._onClose)},t}(n.NotificationBase);t.default=o}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(4),r(41),r(44),r(2),r(66)],void 0===(o=function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={assert:n.ApplicationEventLevel.Error,error:n.ApplicationEventLevel.Error,exception:n.ApplicationEventLevel.Error,info:n.ApplicationEventLevel.Info,log:n.ApplicationEventLevel.Log,trace:n.ApplicationEventLevel.Verbose,warn:n.ApplicationEventLevel.Warning},u=function(){function e(){if(e._instance)throw new Error("Only one instance of the Console Wrapper could exist at the application runtime. To log amything into console, please use browser console patched methods.");e._instance=this,this._console=i.default.console(),this._wrapMethods()}return e.prototype._wrapMethods=function(){var e=this,t=this._console,r=this,n=function(n){var o=t[n];r[n]="function"==typeof o?o.bind(t):o,s.hasOwnProperty(n)&&(t[n]=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];e._shouldBeCaptured(n,t)&&e._saveUnknownConsoleOutput(n,t),r[n].apply(null,t)})};for(var o in t)n(o)},e.prototype._shouldBeCaptured=function(e,t){return"assert"!==e||!t[0]},e.prototype._saveUnknownConsoleOutput=function(e,t){var i=null!=s[e]?s[e]:n.ApplicationEventLevel.Info,u=new o.default(r.EVENT_NAME.TraceEvent,i);u.addEventParameter(r.EventParameterName.MethodName,e),u.addEventParameter(r.EventParameterName.Message,this._extractMessageFromCallParams(e,t)),u.addEventParameter(r.EventParameterName.Parameters,JSON.stringify(t)),u.addEventParameter(r.EventParameterName.ComponentName,"ConsoleWrapper");var c=n.APPLICATION_LEVEL_TO_TRACER_LEVEL_STRING[i]?n.APPLICATION_LEVEL_TO_TRACER_LEVEL_STRING[i]:"Info";u.addEventParameter(r.EventParameterName.TraceLevel,c),a.saveEventToDeveloperConsoleStore(u)},e.prototype._extractMessageFromCallParams=function(e,t){var n="assert"===e?t[1]:t[0];return n?"Browser console."+e+' was called with message "'+n+'".':"Unable to extract message from console."+e+" call. Please see arguments "+r.EventParameterName.Parameters+" for the details."},e}();t.default=u}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(7),r(2),r(66)],void 0===(o=function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){var t=this;this._applicationContext=e,this._onClientInitialized((function(){n.default.setInterval((function(){t._sendEventsToTheClient()}),1e4)}))}return Object.defineProperty(e.prototype,"DispatcherCollection",{get:function(){var e=this._applicationContext.DispatcherCollection;return e||{}},enumerable:!0,configurable:!0}),e.Initialize=function(t){if(this._instance)throw new Error("DeveloperConsoleEventsSender events sender already initialized!");this._instance=new e(t)},e.prototype._onClientInitialized=function(e){var t=this,n=this.DispatcherCollection[r.default.APPLICATION];n?n.clientInitialized.then(e.bind(this)):setTimeout((function(){t._onClientInitialized(e)}),1e3)},e.prototype._sendEventsToTheClient=function(){var e=o.getDeveloperConsoleStoreEvents();if(e.length){var t=this.DispatcherCollection[r.default.LOGGING];if(t){try{t.deviceEvent("OnNativeApplicationEventsReceived",JSON.stringify(e))}catch(e){}o.clearDeveloperConsoleStoreEvents()}}},e}();t.default=i}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(100),r(252),r(9),r(0),r(1),r(2),r(4),r(7)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){this._collectionEnabled=!1,this._isBooting=!1,this._unstoredMetrics=[],this._unloadListenerAttached=!1,this._bcd=e,this._applicationContext=t,this._collectionEnabled=!0,this._isBooting=!0}return e.prototype._createStoredPerformanceMetric=function(e,t,r,n){var o={Name:e,StartTime:t,StopTime:r};if(n){var i=n.reduce((function(e,t){var r,n=t.value;switch(typeof n){case"object":r=n instanceof Date?n.toISOString():JSON.stringify(n);break;default:r=""+n}return e[t.name]=r,e}),{});o.Parameters=i}return o},e.prototype.addStopwatch=function(e,t){return new n.default(this,e,Date.now(),t)},e.prototype.addRetroactiveStopwatch=function(e,t,n,o){if(e&&t&&n&&!(t>n)){var s=new r.default(e,t,n);this.saveMetric(s,o)}else this._applicationContext.EventManager.ReportTraceError(new a.ComponentError(i.default.PERFORMANCE,"Attempt to create retroactive stopwatch from invalid data",a.ErrorCode.GENERIC),[{name:u.PerformanceEventParameterName.StopwatchName,value:e},{name:u.PerformanceEventParameterName.StartTime,value:t},{name:u.PerformanceEventParameterName.StopTime,value:n}])},e.prototype.addMarker=function(e,t){var n=new r.default(e,Date.now(),-1);this.saveMetric(n,t)},e.prototype.disable=function(){this._collectionEnabled=!1},e.prototype.setBooted=function(){this._isBooting=!1},e.prototype.saveMetric=function(e,t){var r=this,n=this._bcd.showPerformance||this._isBooting;if(-1!==e.startTime){if(this._collectionEnabled||n){var o="MailApp."+e.name,a=this._createStoredPerformanceMetric(o,e.startTime,e.stopTime,t);this._collectionEnabled?this._unstoredMetrics.push(a):n&&this._applicationContext.Bridge.deviceEventWithNamespace(c.default.APPLICATION,"ReportPerformance",a)}else this._applicationContext.EventManager.ReportComponentPerformance(i.default.PERFORMANCE,e,t);this._unloadListenerAttached||(s.default.addEventListener("unload",(function(e){r._collectionEnabled&&r._storeMetrics()})),this._unloadListenerAttached=!0)}else this._applicationContext.EventManager.ReportTraceWarning(i.default.PERFORMANCE,"Attempt to save PerformanceMetric with no startTime provided",e.name)},e.prototype.getMetrics=function(){var e=this._applicationContext.Storage.getItem(o.default.perfMetricStore)||[],t=this._unstoredMetrics.concat(e);return JSON.stringify(t)},e.prototype.clear=function(){this._applicationContext.Storage.removeItem(o.default.perfMetricStore),this._unstoredMetrics=[]},e.prototype._storeMetrics=function(){var e=this._applicationContext.Storage.getItem(o.default.perfMetricStore)||[];this._unstoredMetrics.forEach((function(t){return e.push(t)})),this._applicationContext.Storage.setItem(o.default.perfMetricStore,e),this._unstoredMetrics=[]},e}();t.default=l}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});n=[r,t,r(100)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t,r,n,o){void 0===n&&(n=-1);var i=e.call(this,r,n)||this;return i._perfStorage=t,i._params=o,i}return a(t,e),t.prototype.start=function(){-1===this.startTime&&(this.startTime=Date.now())},t.prototype.stop=function(){this.stopTime=Date.now(),this._perfStorage.saveMetric(this,this._params)},t}(r.default);t.default=n}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(4),r(41),r(44),r(101),r(254),r(21),r(2),r(0),r(9),r(20),r(7),r(272)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c,l,p,d,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=c.default.EVENT_MANAGER+".PrimaryLoad",_=c.default.EVENT_MANAGER+".SecondaryLoad",m=c.default.EVENT_MANAGER+".PinnedModeLoad",v=function(){function e(e,t,r){void 0===r&&(r=[]),this._initialized=!1,this._bcd=e,this._applicationContext=t,this._eventListeners=r,this._ariaEventListener=new a.default(this._applicationContext),this._eventListeners.unshift(this._ariaEventListener)}return e.prototype.Initialize=function(){this._initialized||(this._initialized=!0,this._eventManagerInitialized())},e.prototype.ReportComponentPerformance=function(e,t,i){var a=new o.default(r.EVENT_NAME.Performance,n.ApplicationEventLevel.Info),s="MailApp."+t.name,u=new Date(t.startTime).toISOString(),c=t.stopTime-t.startTime;a.addEventParameter(r.EventParameterName.ComponentName,e),a.addEventParameter(r.PerformanceEventParameterName.MetricName,s),a.addEventParameter(r.PerformanceEventParameterName.StartTime,u),a.addEventParameter(r.PerformanceEventParameterName.MetricValue,c),this._dispatch(a,i)},e.prototype.ReportComponentSuccess=function(e,t,i){var a=new o.default(r.EVENT_NAME.MonitorSuccess,n.ApplicationEventLevel.Info);a.addEventParameter(r.EventParameterName.ComponentName,e),t&&a.addEventParameter(r.EventParameterName.Message,t),this._dispatch(a,i)},e.prototype.ReportComponentFailure=function(e,t){var n=this._getErrorApplicationEvent(r.EVENT_NAME.MonitorFailure,e);this._dispatch(n,t,i.SendPriority.High)},e.prototype.ReportTraceInfo=function(e,t,o,i){var a=this._getTraceEvent(e,t,n.ApplicationEventLevel.Info);o&&a.addEventParameter(r.EventParameterName.Data,o),this._dispatch(a,i)},e.prototype.ReportTraceWarning=function(e,t,o,i){var a=this._getTraceEvent(e,t,n.ApplicationEventLevel.Warning);o&&a.addEventParameter(r.EventParameterName.Data,o),this._dispatch(a,i)},e.prototype.ReportTraceError=function(e,t){var n=this._getErrorApplicationEvent(r.EVENT_NAME.TraceEvent,e);this._dispatch(n,t)},e.prototype.getSessionId=function(){return this._activeSessionId},e.prototype.onMailboxItemChanged=function(){var e;this._contextId=p.default.newGuid().guid,this.ReportTraceInfo(m,"Application loaded in pinned mode");var t=((e={})[r.EventParameterName.ShimContextId]=this._contextId,e.ShimSessionId=this.getSessionId(),e[r.SessionContextParameterName.ShimVersion]=u.default.shimVersion(),e);this._applicationContext.Bridge.changeStateForDispatcher(d.default.APPLICATION,"TelemetryEventsParams",t)},e.prototype.setHostActivityId=function(e){this._hostActivityId=e},e.prototype.resetHostActivityId=function(){this._hostActivityId=null},e.prototype._getErrorApplicationEvent=function(e,t){var i=new o.default(e,n.ApplicationEventLevel.Error),a=s.ensureComponentErrorObject(t);return i.addEventParameter(r.EventParameterName.ComponentName,a.componentName),i.addEventParameter(r.EventParameterName.Message,a.message),i.addEventParameter(r.ErrorEventParameterName.CallStack,a.stack||"No stack available"),i.addEventParameter(r.ErrorEventParameterName.ErrorCode,a.code),t.innerError&&(i.addEventParameter(r.ErrorEventParameterName.InnerErrorComponentName,t.innerError.componentName),i.addEventParameter(r.ErrorEventParameterName.InnerError,t.innerError)),i},e.prototype._getTraceEvent=function(e,t,i){var a=new o.default(r.EVENT_NAME.TraceEvent,i),s=n.APPLICATION_LEVEL_TO_TRACER_LEVEL_STRING[i];return a.addEventParameter(r.EventParameterName.ComponentName,e),a.addEventParameter(r.EventParameterName.Message,t),a.addEventParameter(r.EventParameterName.TraceLevel,s),a},e.prototype._refreshSessionContext=function(){if(!f.isSessionContextFulfilled){var e=f.getSessionContext(this._bcd,this._applicationContext,this._activeSessionId);this._ariaEventListener.setSessionContext(e)}},e.prototype._dispatch=function(e,t,r){this._refreshSessionContext(),this._extendParameters(e,t),this._eventListeners.forEach((function(t){t.handleEvent(e,r)}))},e.prototype._eventManagerInitialized=function(){this._activeSessionId=this._setSessionId(this._bcd.secondaryLoad),this._sessionInitTime=this._setSessionInitTime(this._bcd.secondaryLoad);var e=this._bcd.secondaryLoad?_:h,t=[{name:r.EventParameterName.TimeSinceSessionInit,value:this._bcd.secondaryLoad?Date.now()-new Date(this._sessionInitTime).getTime():0},{name:r.PerformanceEventParameterName.StartTime,value:this._sessionInitTime}];this.ReportComponentSuccess(c.default.EVENT_MANAGER+".constructor"),this.ReportComponentSuccess(e,"Reporting Load Event",t)},e.prototype._setSessionId=function(e){var t=e?this._applicationContext.Storage.getItem(l.default.sessionId):null;return t||(t=p.default.newGuid().guid,this._applicationContext.Storage.setItem(l.default.sessionId,t)),t},e.prototype._setSessionInitTime=function(e){var t=e?this._applicationContext.Storage.getItem(l.default.initTime):null;return t||(t=JSON.stringify(new Date(u.default.PageLoadStartTime())).replace(/"/g,""),this._applicationContext.Storage.setItem(l.default.initTime,t)),t},e.prototype._extendParameters=function(e,t){var n=this._hostActivityId||this._activeSessionId;if(e.addEventParameter(r.KnownEventParameterName.ActivityId,n),e.addEventParameter(r.KnownEventParameterName.SessionId,this._activeSessionId),this._contextId&&e.addEventParameter(r.EventParameterName.ShimContextId,this._contextId),t&&t.length)for(var o=0,i=t;o<i.length;o++){var a=i[o];a&&e.addEventParameter(a.name,a.value)}e.addEventParameter(r.EventParameterName.NetworkConnectivityState,u.default.isOnline()?"online":"offline")},e}();t.default=v}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(255)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this._isReporting=!0,this._telemetryClient=new r.default(e)}return e.prototype.handleEvent=function(e,t){this._isReporting&&this._telemetryClient.logEvent(e,t)},e.prototype.flushAndTearDown=function(){this._isReporting&&this._telemetryClient&&(this._telemetryClient.flushAndTearDown(),this._isReporting=!1,this._telemetryClient=null)},e.prototype.setSessionContext=function(e){this._telemetryClient.setAWTSemanticContext(e)},e}();t.default=n}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(256),r(0),r(4),r(44),r(101),r(97),r(2),r(270),r(271)],void 0===(o=function(e,t,r,n,o,i,a,s,u,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(){function e(e){this._AWTInit(e)}return e.prototype.getAriaProjectId=function(){return this._ariaProjectId=c.getAriaKeyForOrigin(s.getHostname()),this._ariaProjectId},e.prototype.setAWTSemanticContext=function(e){if(void 0!==this._defaultAriaLogger&&this._defaultAriaLogger.getSemanticContext()){for(var t in e)if(!this._isAriaCommonParameter(t)){var n=i.toSimpleTypeValue(e[t]);this._defaultAriaLogger.setContext(t,n,r.AWTPropertyType.Unspecified)}this._defaultAriaLogger.setContext(o.KnownEventParameterName.UserAgent,window.navigator.userAgent,r.AWTPropertyType.String),this._defaultAriaLogger.setContext(o.KnownEventParameterName.Origin,s.getHostname(),r.AWTPropertyType.String)}},e.prototype.logEvent=function(e,t){if(void 0!==this._defaultAriaLogger){var n=new r.AWTEventProperties(e.getAriaEventName());this._setEventPriority(n,t),n.setProperty("ActivityId",e.getActivityId(),r.AWTPropertyType.String);var o=e.toData().EventValues;for(var i in o)this._isAriaCommonParameter(i)||n.setProperty(i,o[i],r.AWTPropertyType.Unspecified);this._defaultAriaLogger.logEvent(n)}},e.prototype.flushAndTearDown=function(){r.AWTLogManager.flushAndTeardown()},e.prototype._AWTInit=function(e){var t=this,o=this.getAriaProjectId();void 0!==o&&(c.isGCCHighAriaKey(o)?this._defaultAriaLogger=r.AWTLogManager.initialize(o,{collectorUri:r.AWT_COLLECTOR_URL_USGOV_DOJ}):c.isUSDoDAriaKey(o)?this._defaultAriaLogger=r.AWTLogManager.initialize(o,{collectorUri:r.AWT_COLLECTOR_URL_USGOV_DOD}):this._defaultAriaLogger=r.AWTLogManager.initialize(o),this._archiver=new l.default(e),u.default.addEventListener("beforeunload",this._onBeforeUnload),r.AWTLogManager.addNotificationListener({eventsSent:function(e){var r=t._archiver.getEventBatch();r&&r.Events.map((function(e){return t._defaultAriaLogger.logEvent(e)}))},eventsDropped:function(e,r){t._archiver.archiveEventsBatch(e)},eventsRejected:function(t,o){o!==r.AWTEventsRejectedReason.KillSwitch&&e.EventManager.ReportTraceWarning(n.default.TELEMETRY_ARCHIVER,t.length+" events rejected.")},eventsRetrying:function(e){}}))},e.prototype._setEventPriority=function(e,t){void 0!==t&&(t===a.SendPriority.High?e.setEventPriority(r.AWTEventPriority.High):t===a.SendPriority.Low?e.setEventPriority(r.AWTEventPriority.Low):e.setEventPriority(r.AWTEventPriority.Normal))},e.prototype._onBeforeUnload=function(){r.AWTLogManager.flushAndTeardown()},e.prototype._isAriaCommonParameter=function(e){return e===o.KnownEventParameterName.TimeCreated},e}();t.default=p}.apply(t,n))||(e.exports=o)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(14);t.AWTPropertyType=n.AWTPropertyType,t.AWTPiiKind=n.AWTPiiKind,t.AWTEventPriority=n.AWTEventPriority,t.AWTEventsDroppedReason=n.AWTEventsDroppedReason,t.AWTEventsRejectedReason=n.AWTEventsRejectedReason,t.AWTCustomerContentKind=n.AWTCustomerContentKind;var o=r(45);t.AWTUserIdType=o.AWTUserIdType,t.AWTSessionState=o.AWTSessionState;var i=r(102);t.AWT_BEST_EFFORT=i.AWT_BEST_EFFORT,t.AWT_NEAR_REAL_TIME=i.AWT_NEAR_REAL_TIME,t.AWT_REAL_TIME=i.AWT_REAL_TIME;var a=r(46);t.AWTEventProperties=a.default;var s=r(103);t.AWTLogger=s.default;var u=r(107);t.AWTLogManager=u.default;var c=r(269);t.AWTTransmissionManager=c.default;var l=r(105);t.AWTSerializer=l.default;var p=r(67);t.AWTSemanticContext=p.default,t.AWT_COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_USGOV_DOD="https://pf.pipe.aria.microsoft.com/Collector/3.0",t.AWT_COLLECTOR_URL_USGOV_DOJ="https://tb.pipe.aria.microsoft.com/Collector/3.0"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(14),o=r(258),i=r(36),a=r(268),s=r(32),u=function(){function e(e,t,r,i){this._queueSizeLimit=t,this._isCurrentlyUploadingNow=!1,this._uploadNowQueue=[],this._shouldDropEventsOnPause=!1,this._paused=!1,this._queueSize=0,this._outboundQueue=[],this._inboundQueues={},this._inboundQueues[n.AWTEventPriority.High]=[],this._inboundQueues[n.AWTEventPriority.Normal]=[],this._inboundQueues[n.AWTEventPriority.Low]=[],this._addEmptyQueues(),this._batcher=new a.default(this._outboundQueue,500),this._httpManager=new o.default(this._outboundQueue,e,this,r,i)}return e.prototype.addEvent=function(e){e.priority===n.AWTEventPriority.Immediate_sync?this._httpManager.sendSynchronousRequest(this._batcher.addEventToBatch(e),e.apiKey):this._queueSize<this._queueSizeLimit?this._addEventToProperQueue(e):this._dropEventWithPriorityOrLess(e.priority)?this._addEventToProperQueue(e):s.default.eventsDropped([e],n.AWTEventsDroppedReason.QueueFull)},e.prototype.sendEventsForPriorityAndAbove=function(e){this._batchEvents(e),this._httpManager.sendQueuedRequests()},e.prototype.hasEvents=function(){return(this._inboundQueues[n.AWTEventPriority.High][0].length>0||this._inboundQueues[n.AWTEventPriority.Normal][0].length>0||this._inboundQueues[n.AWTEventPriority.Low][0].length>0||this._batcher.hasBatch())&&this._httpManager.hasIdleConnection()},e.prototype.addBackRequest=function(e){if(!this._paused||!this._shouldDropEventsOnPause){for(var t in e)if(e.hasOwnProperty(t))for(var r=0;r<e[t].length;++r)e[t][r].sendAttempt<6?this.addEvent(e[t][r]):s.default.eventsDropped([e[t][r]],n.AWTEventsDroppedReason.NonRetryableStatus);i.default.scheduleTimer()}},e.prototype.teardown=function(){this._paused||(this._batchEvents(n.AWTEventPriority.Low),this._httpManager.teardown())},e.prototype.uploadNow=function(e){var t=this;this._addEmptyQueues(),this._isCurrentlyUploadingNow?this._uploadNowQueue.push(e):(this._isCurrentlyUploadingNow=!0,setTimeout((function(){return t._uploadNow(e)}),0))},e.prototype.pauseTransmission=function(){this._paused=!0,this._httpManager.pause(),this.shouldDropEventsOnPause&&(this._queueSize-=this._inboundQueues[n.AWTEventPriority.High][0].length+this._inboundQueues[n.AWTEventPriority.Normal][0].length+this._inboundQueues[n.AWTEventPriority.Low][0].length,this._inboundQueues[n.AWTEventPriority.High][0]=[],this._inboundQueues[n.AWTEventPriority.Normal][0]=[],this._inboundQueues[n.AWTEventPriority.Low][0]=[],this._httpManager.removeQueuedRequests())},e.prototype.resumeTransmission=function(){this._paused=!1,this._httpManager.resume()},e.prototype.shouldDropEventsOnPause=function(e){this._shouldDropEventsOnPause=e},e.prototype._removeFirstQueues=function(){this._inboundQueues[n.AWTEventPriority.High].shift(),this._inboundQueues[n.AWTEventPriority.Normal].shift(),this._inboundQueues[n.AWTEventPriority.Low].shift()},e.prototype._addEmptyQueues=function(){this._inboundQueues[n.AWTEventPriority.High].push([]),this._inboundQueues[n.AWTEventPriority.Normal].push([]),this._inboundQueues[n.AWTEventPriority.Low].push([])},e.prototype._addEventToProperQueue=function(e){this._paused&&this._shouldDropEventsOnPause||(this._queueSize++,this._inboundQueues[e.priority][this._inboundQueues[e.priority].length-1].push(e))},e.prototype._dropEventWithPriorityOrLess=function(e){for(var t=n.AWTEventPriority.Low;t<=e;){if(this._inboundQueues[t][this._inboundQueues[t].length-1].length>0)return s.default.eventsDropped([this._inboundQueues[t][this._inboundQueues[t].length-1].shift()],n.AWTEventsDroppedReason.QueueFull),!0;t++}return!1},e.prototype._batchEvents=function(e){for(var t=n.AWTEventPriority.High;t>=e;){for(;this._inboundQueues[t][0].length>0;){var r=this._inboundQueues[t][0].pop();this._queueSize--,this._batcher.addEventToBatch(r)}t--}this._batcher.flushBatch()},e.prototype._uploadNow=function(e){var t=this;this.hasEvents()&&this.sendEventsForPriorityAndAbove(n.AWTEventPriority.Low),this._checkOutboundQueueEmptyAndSent((function(){t._removeFirstQueues(),null!=e&&e(),t._uploadNowQueue.length>0?setTimeout((function(){return t._uploadNow(t._uploadNowQueue.shift())}),0):(t._isCurrentlyUploadingNow=!1,t.hasEvents()&&i.default.scheduleTimer())}))},e.prototype._checkOutboundQueueEmptyAndSent=function(e){var t=this;this._httpManager.isCompletelyIdle()?e():setTimeout((function(){return t._checkOutboundQueueEmptyAndSent(e)}),250)},e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(14),o=r(105),i=r(265),a=r(266),s=r(267),u=r(106),c=r(28),l=r(32),p=r(36),d=function(){function e(e,t,r,n,o){var i=this;this._requestQueue=e,this._queueManager=r,this._httpInterface=n,this._urlString="?qsp=true&content-type=application%2Fbond-compact-binary&client-id=NO_AUTH&sdk-version="+u.FullVersionString,this._killSwitch=new a.default,this._paused=!1,this._useBeacons=!1,this._activeConnections=0,this._clockSkewManager=new s.default(o),c.isUint8ArrayAvailable()||(this._urlString+="&content-encoding=base64"),this._urlString=t+this._urlString,this._httpInterface||(this._useBeacons=!c.isReactNative(),this._httpInterface={sendPOST:function(e,t,r,n,o,a){try{if(c.useXDomainRequest()){var s=new XDomainRequest;s.open("POST",e),s.onload=function(){o(200,null)},s.onerror=function(){n(400,null)},s.ontimeout=function(){r(500,null)},s.send(t)}else if(c.isReactNative())fetch(e,{body:t,method:"POST"}).then((function(e){var t={};e.headers&&e.headers.forEach((function(e,r){t[r]=e})),o(e.status,t)})).catch((function(e){n(0,{})}));else{var u=new XMLHttpRequest;u.open("POST",e,!a),u.onload=function(){o(u.status,i._convertAllHeadersToMap(u.getAllResponseHeaders()))},u.onerror=function(){n(u.status,i._convertAllHeadersToMap(u.getAllResponseHeaders()))},u.ontimeout=function(){r(u.status,i._convertAllHeadersToMap(u.getAllResponseHeaders()))},u.send(t)}}catch(e){n(400,null)}}})}return e.prototype.hasIdleConnection=function(){return this._activeConnections<2},e.prototype.sendQueuedRequests=function(){for(;this.hasIdleConnection()&&!this._paused&&this._requestQueue.length>0&&this._clockSkewManager.allowRequestSending();)this._activeConnections++,this._sendRequest(this._requestQueue.shift(),0,!1);this.hasIdleConnection()&&p.default.scheduleTimer()},e.prototype.isCompletelyIdle=function(){return 0===this._activeConnections},e.prototype.teardown=function(){for(;this._requestQueue.length>0;)this._sendRequest(this._requestQueue.shift(),0,!0)},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1,this.sendQueuedRequests()},e.prototype.removeQueuedRequests=function(){this._requestQueue.length=0},e.prototype.sendSynchronousRequest=function(e,t){this._paused&&(e[t][0].priority=n.AWTEventPriority.High),this._activeConnections++,this._sendRequest(e,0,!1,!0)},e.prototype._sendRequest=function(e,t,r,i){var a=this;void 0===i&&(i=!1);try{if(this._paused)return this._activeConnections--,void this._queueManager.addBackRequest(e);var s=0,u="";for(var p in e)e.hasOwnProperty(p)&&(this._killSwitch.isTenantKilled(p)?(l.default.eventsRejected(e[p],n.AWTEventsRejectedReason.KillSwitch),delete e[p]):(u.length>0&&(u+=","),u+=p,s++));if(s>0){var d=o.default.getPayloadBlob(e,s);d.remainingRequest&&this._requestQueue.push(d.remainingRequest);var f=this._urlString+"&x-apikey="+u+"&client-time-epoch-millis="+Date.now().toString();this._clockSkewManager.shouldAddClockSkewHeaders()&&(f=f+"&time-delta-to-apply-millis="+this._clockSkewManager.getClockSkewHeaderValue());var h=void 0;for(var p in h=c.isUint8ArrayAvailable()?new Uint8Array(d.payloadBlob):o.default.base64Encode(d.payloadBlob),e)if(e.hasOwnProperty(p))for(var _=0;_<e[p].length;++_)e[p][_].sendAttempt>0?e[p][_].sendAttempt++:e[p][_].sendAttempt=1;if(this._useBeacons&&r&&c.isBeaconsSupported()&&navigator.sendBeacon(f,h))return;this._httpInterface.sendPOST(f,h,(function(n,o){a._retryRequestIfNeeded(n,o,e,s,u,t,r,i)}),(function(n,o){a._retryRequestIfNeeded(n,o,e,s,u,t,r,i)}),(function(n,o){a._retryRequestIfNeeded(n,o,e,s,u,t,r,i)}),r||i)}else r||this._handleRequestFinished(!1,{},r,i)}catch(e){this._handleRequestFinished(!1,{},r,i)}},e.prototype._retryRequestIfNeeded=function(e,t,r,o,a,s,u,c){var d=this,f=!0;if(void 0!==e){if(t){var h=this._killSwitch.setKillSwitchTenants(t["kill-tokens"],t["kill-duration-seconds"]);this._clockSkewManager.setClockSkew(t["time-delta-millis"]);for(var _=0;_<h.length;++_)l.default.eventsRejected(r[h[_]],n.AWTEventsRejectedReason.KillSwitch),delete r[h[_]],o--}else this._clockSkewManager.setClockSkew(null);if(200===e)return void this._handleRequestFinished(!0,r,u,c);(!i.default.shouldRetryForStatus(e)||o<=0)&&(f=!1)}if(f)if(c)this._activeConnections--,r[a][0].priority=n.AWTEventPriority.High,this._queueManager.addBackRequest(r);else if(s<1){for(var m in r)r.hasOwnProperty(m)&&l.default.eventsRetrying(r[m]);setTimeout((function(){return d._sendRequest(r,s+1,!1)}),i.default.getMillisToBackoffForRetry(s))}else this._activeConnections--,p.default.backOffTransmission(),this._queueManager.addBackRequest(r);else this._handleRequestFinished(!1,r,u,c)},e.prototype._handleRequestFinished=function(e,t,r,o){for(var i in e&&p.default.clearBackOff(),t)t.hasOwnProperty(i)&&(e?l.default.eventsSent(t[i]):l.default.eventsDropped(t[i],n.AWTEventsDroppedReason.NonRetryableStatus));this._activeConnections--,o||r||this.sendQueuedRequests()},e.prototype._convertAllHeadersToMap=function(e){var t={};if(e)for(var r=e.split("\n"),n=0;n<r.length;++n){var o=r[n].split(": ");t[o[0]]=o[1]}return t},e}();t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(260);t._BondDataType=n._BondDataType;var o=r(261);t._Encoding=o;var i=r(264);t.IO=i;var a=r(47);t.Int64=a.Int64,t.UInt64=a.UInt64,t.Number=a.Number;var s=function(){function e(e){this._stream=e}return e.prototype._WriteBlob=function(e){this._stream._Write(e,0,e.length)},e.prototype._WriteBool=function(e){this._stream._WriteByte(e?1:0)},e.prototype._WriteContainerBegin=function(e,t){this._WriteUInt8(t),this._WriteUInt32(e)},e.prototype._WriteMapContainerBegin=function(e,t,r){this._WriteUInt8(t),this._WriteUInt8(r),this._WriteUInt32(e)},e.prototype._WriteDouble=function(e){var t=o._Double_GetBytes(e);this._stream._Write(t,0,t.length)},e.prototype._WriteFieldBegin=function(e,t,r){t<=5?this._stream._WriteByte(e|t<<5):t<=255?(this._stream._WriteByte(192|e),this._stream._WriteByte(t)):(this._stream._WriteByte(224|e),this._stream._WriteByte(t),this._stream._WriteByte(t>>8))},e.prototype._WriteInt32=function(e){e=o._Zigzag_EncodeZigzag32(e),this._WriteUInt32(e)},e.prototype._WriteInt64=function(e){this._WriteUInt64(o._Zigzag_EncodeZigzag64(e))},e.prototype._WriteString=function(e){if(""===e)this._WriteUInt32(0);else{var t=o._Utf8_GetBytes(e);this._WriteUInt32(t.length),this._stream._Write(t,0,t.length)}},e.prototype._WriteStructEnd=function(e){this._WriteUInt8(e?n._BondDataType._BT_STOP_BASE:n._BondDataType._BT_STOP)},e.prototype._WriteUInt32=function(e){var t=o._Varint_GetBytes(a.Number._ToUInt32(e));this._stream._Write(t,0,t.length)},e.prototype._WriteUInt64=function(e){var t=o._Varint64_GetBytes(e);this._stream._Write(t,0,t.length)},e.prototype._WriteUInt8=function(e){this._stream._WriteByte(a.Number._ToUInt8(e))},e}();t.CompactBinaryProtocolWriter=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e._BT_STOP=0]="_BT_STOP",e[e._BT_STOP_BASE=1]="_BT_STOP_BASE",e[e._BT_BOOL=2]="_BT_BOOL",e[e._BT_DOUBLE=8]="_BT_DOUBLE",e[e._BT_STRING=9]="_BT_STRING",e[e._BT_STRUCT=10]="_BT_STRUCT",e[e._BT_LIST=11]="_BT_LIST",e[e._BT_MAP=13]="_BT_MAP",e[e._BT_INT32=16]="_BT_INT32",e[e._BT_INT64=17]="_BT_INT64"}(t._BondDataType||(t._BondDataType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(47),o=r(262),i=r(263);t._Utf8_GetBytes=function(e){for(var t=[],r=0;r<e.length;++r){var n=e.charCodeAt(r);n<128?t.push(n):n<2048?t.push(192|n>>6,128|63&n):n<55296||n>=57344?t.push(224|n>>12,128|n>>6&63,128|63&n):(n=65536+((1023&n)<<10|1023&e.charCodeAt(++r)),t.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n))}return t},t._Base64_GetString=function(e){for(var t,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[],o=e.length%3,i=0,a=e.length-o;i<a;i+=3){var s=(e[i]<<16)+(e[i+1]<<8)+e[i+2];n.push([r.charAt((t=s)>>18&63),r.charAt(t>>12&63),r.charAt(t>>6&63),r.charAt(63&t)].join(""))}switch(o){case 1:s=e[e.length-1];n.push(r.charAt(s>>2)),n.push(r.charAt(s<<4&63)),n.push("==");break;case 2:var u=(e[e.length-2]<<8)+e[e.length-1];n.push(r.charAt(u>>10)),n.push(r.charAt(u>>4&63)),n.push(r.charAt(u<<2&63)),n.push("=")}return n.join("")},t._Varint_GetBytes=function(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t},t._Varint64_GetBytes=function(e){for(var t=e.low,r=e.high,n=[];r||4294967168&t;)n.push(127&t|128),t=(127&r)<<25|t>>>7,r>>>=7;return n.push(127&t),n},t._Double_GetBytes=function(e){if(i.BrowserChecker._IsDataViewSupport()){var t=new DataView(new ArrayBuffer(8));t.setFloat64(0,e,!0);for(var r=[],n=0;n<8;++n)r.push(t.getUint8(n));return r}return o.FloatUtils._ConvertNumberToArray(e,!0)},t._Zigzag_EncodeZigzag32=function(e){return(e=n.Number._ToInt32(e))<<1^e>>31},t._Zigzag_EncodeZigzag64=function(e){var t=e.low,r=e.high,o=r<<1|t>>>31,i=t<<1;2147483648&r&&(o=~o,i=~i);var a=new n.UInt64("0");return a.low=i,a.high=o,a}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e._ConvertNumberToArray=function(e,t){if(!e)return t?this._doubleZero:this._floatZero;var r=t?52:23,n=(1<<(t?11:8)-1)-1,o=1-n,i=n,a=e<0?1:0;e=Math.abs(e);for(var s=Math.floor(e),u=e-s,c=2*(n+2)+r,l=new Array(c),p=0;p<c;)l[p++]=0;for(p=n+2;p&&s;)l[--p]=s%2,s=Math.floor(s/2);for(p=n+1;p<c-1&&u>0;)(u*=2)>=1?(l[++p]=1,--u):l[++p]=0;for(var d=0;d<c&&!l[d];)d++;var f=n+1-d,h=d+r;if(l[h+1]){for(p=h;p>d&&(l[p]=1-l[p],!l);--p);p===d&&++f}if(f>i||s)return a?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity;if(f<o)return t?this._doubleZero:this._floatZero;if(t){var _=0;for(p=0;p<20;++p)_=_<<1|l[++d];for(var m=0;p<52;++p)m=m<<1|l[++d];return[255&m,m>>8&255,m>>16&255,m>>>24,255&(_=a<<31|2147483647&(_|=f+n<<20)),_>>8&255,_>>16&255,_>>>24]}var v=0;for(p=0;p<23;++p)v=v<<1|l[++d];return[255&(v=a<<31|2147483647&(v|=f+n<<23)),v>>8&255,v>>16&255,v>>>24]},e._floatZero=[0,0,0,0],e._doubleZero=[0,0,0,0,0,0,0,0],e._floatInifinity=[0,0,128,127],e._floatNegInifinity=[0,0,128,255],e._doubleInifinity=[0,0,0,0,0,0,240,127],e._doubleNegInifinity=[0,0,0,0,0,0,240,255],e}();t.FloatUtils=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e._IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},e}();t.BrowserChecker=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(47),o=function(){function e(){this._buffer=[]}return e.prototype._WriteByte=function(e){this._buffer.push(n.Number._ToByte(e))},e.prototype._Write=function(e,t,r){for(;r--;)this._WriteByte(e[t++])},e.prototype._GetBuffer=function(){return this._buffer},e}();t.MemoryStream=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!==e||501===e||505===e)},e.getMillisToBackoffForRetry=function(e){var t,r=Math.floor(1200*Math.random())+2400;return t=Math.pow(4,e)*r,Math.min(t,12e4)},e}();t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._killedTokenDictionary={}}return e.prototype.setKillSwitchTenants=function(e,t){if(e&&t)try{var r=e.split(",");if("this-request-only"===t)return r;for(var n=1e3*parseInt(t,10),o=0;o<r.length;++o)this._killedTokenDictionary[r[o]]=Date.now()+n}catch(e){return[]}return[]},e.prototype.isTenantKilled=function(e){return void 0!==this._killedTokenDictionary[e]&&this._killedTokenDictionary[e]>Date.now()||(delete this._killedTokenDictionary[e],!1)},e}();t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.clockSkewRefreshDurationInMins=e,this._reset()}return e.prototype.allowRequestSending=function(){return this._isFirstRequest&&!this._clockSkewSet?(this._isFirstRequest=!1,this._allowRequestSending=!1,!0):this._allowRequestSending},e.prototype.shouldAddClockSkewHeaders=function(){return this._shouldAddClockSkewHeaders},e.prototype.getClockSkewHeaderValue=function(){return this._clockSkewHeaderValue},e.prototype.setClockSkew=function(e){this._clockSkewSet||(e?this._clockSkewHeaderValue=e:this._shouldAddClockSkewHeaders=!1,this._clockSkewSet=!0,this._allowRequestSending=!0)},e.prototype._reset=function(){var e=this;this._isFirstRequest=!0,this._clockSkewSet=!1,this._allowRequestSending=!0,this._shouldAddClockSkewHeaders=!0,this._clockSkewHeaderValue="use-collector-delta",this.clockSkewRefreshDurationInMins>0&&setTimeout((function(){return e._reset()}),6e4*this.clockSkewRefreshDurationInMins)},e}();t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(14),o=function(){function e(e,t){this._outboundQueue=e,this._maxNumberOfEvents=t,this._currentBatch={},this._currentNumEventsInBatch=0}return e.prototype.addEventToBatch=function(e){if(e.priority===n.AWTEventPriority.Immediate_sync){var t={};return t[e.apiKey]=[e],t}return this._currentNumEventsInBatch>=this._maxNumberOfEvents&&this.flushBatch(),void 0===this._currentBatch[e.apiKey]&&(this._currentBatch[e.apiKey]=[]),this._currentBatch[e.apiKey].push(e),this._currentNumEventsInBatch++,null},e.prototype.flushBatch=function(){this._currentNumEventsInBatch>0&&(this._outboundQueue.push(this._currentBatch),this._currentBatch={},this._currentNumEventsInBatch=0)},e.prototype.hasBatch=function(){return this._currentNumEventsInBatch>0},e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(36),o=function(){function e(){}return e.setEventsHandler=function(e){n.default.setEventsHandler(e)},e.getEventsHandler=function(){return n.default.getEventsHandler()},e.scheduleTimer=function(){n.default.scheduleTimer()},e}();t.default=o},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=[{id:"PROD",ariaIngestionKey:"0b14a44360bf4cae8e1e090ac91a04e5-3c17b97e-6b3a-4a9b-8407-6e450ff03cd2-7084",allowedOriginRegex:/.*\.crm([2-8]|11|12|14|15)?\.dynamics\.com$/},{id:"GCCHigh",ariaIngestionKey:"7d390bf951b748828d76e5d3c027faa0-9ef46ec8-2e5e-40ba-9f69-b4a13b9feca1-7148",allowedOriginRegex:/.*\.crm\.microsoftdynamics\.us$/},{id:"USDoD",ariaIngestionKey:"8ed6ca832b3c48d48be9c06fdc376398-e81cde17-794e-4380-852b-d01450e08d5c-7306",allowedOriginRegex:/.*\.crm\.appsplatform\.us$/},{id:"GCCModerate",ariaIngestionKey:"774241b9d70e40efb34ddfb995dbfb92-37f51c02-1551-4d6c-acdd-de4f47ee6a98-7274",allowedOriginRegex:/.*\.crm9\.dynamics\.com$/},{id:"Blackforest",ariaIngestionKey:"1d4b56b9dd4d4ca098d7fa7c7af55ece-55115f9e-4619-474c-9aab-80a9f2027a5b-6876",allowedOriginRegex:/.*\.crm\.microsoftdynamics\.de$/},{id:"Mooncake",ariaIngestionKey:"",allowedOriginRegex:/.*\.crm\.microsoftdynamics\.cn$/},{id:"TIP",ariaIngestionKey:"0b14a44360bf4cae8e1e090ac91a04e5-3c17b97e-6b3a-4a9b-8407-6e450ff03cd2-7084",allowedOriginRegex:/.*\.crm10\.dynamics\.com$/},{id:"TEST",ariaIngestionKey:"2602733e020348908569f871ef40fc4b-ecb43f9d-b1e2-4034-aee3-f38471962c48-7333",allowedOriginRegex:/(.*\.crm\.dynamics-int\.com$|.*\.crm[2]?\.crmlivetie\.com$|.*\.contoso\.com:444$|.*\.microsoft\.com$|.*\.msmecrm\.com$|.*\.crm\.crmlivetoday\.com$|.*\.crm\.1boxtest\.com$|.*\.mocaifd\d*\.com:444$|.*\.crm\.crmifd\.com$|.*\.msmecrm\.com:444$|.*localhost.*)/}];function n(e){var t,n=r.find((function(t){return t.id===e}));return void 0!==n&&(t=n.ariaIngestionKey),t}t.getAriaKeyForOrigin=function(e){var t,n=r.find((function(t){return t.allowedOriginRegex.test(e)}));return void 0!==n&&(t=n.ariaIngestionKey),t},t.getAriaKeyForEnvironment=n,t.isGCCHighAriaKey=function(e){return e===n("GCCHigh")},t.isUSDoDAriaKey=function(e){return e===n("USDoD")}}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(9),r(2)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){var t=this;this._archiveStoreKey=r.default.ariaTelemetry,this._MAX_STORED_BATCHES=450,this._applicationContext=e,n.default.addEventListener("unload",(function(){return t._writeEventsToStorage()}))}return e.prototype.archiveEventsBatch=function(e){this._receiveEventsBatch(e)},e.prototype.getEventBatch=function(){if(this._storedEvents||this._loadEventsFromStorage(),0!==this._storedEvents.length)return this._storedEvents.shift()},e.prototype._receiveEventsBatch=function(e){if(e&&e.length){this._storedEvents||this._loadEventsFromStorage();var t=e.slice(),r={Created:Date.now(),Events:t,NumEvents:t.length};this._storedEvents.push(r)}},e.prototype._loadEventsFromStorage=function(){try{var e=this._applicationContext.Storage.getItem(this._archiveStoreKey);this._storedEvents=e&&JSON.parse(e)||[],this._applicationContext.Storage.removeItem(this._archiveStoreKey)}catch(e){this._storedEvents=[],console.error("[Telemetry] 'Retrieve Archive' failure"),console.dirxml(e),console.error(e.stack||e)}},e.prototype._writeEventsToStorage=function(){if(this._storedEvents)try{var e=JSON.stringify(this._storedEvents.slice(0,this._MAX_STORED_BATCHES));this._applicationContext.Storage.setItem(this._archiveStoreKey,e)}catch(e){console.error("[Telemetry] 'Store Save DB' failure"),console.dirxml(e),console.error(e.stack||e)}},e}();t.default=o}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(17),r(2),r(4)],void 0===(o=function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=!1;t.isSessionContextFulfilled=a,t.getSessionContext=function(e,s,u){var c={};return function(e,t){if(!e.ComponentsLoader||!e.ComponentsLoader.isComponentLoaded(r.default.JS_API_PROVIDER))return!1;var n=e.JsApiProvider.getMailboxDiagnostics();return t[i.SessionContextParameterName.HostName]=n&&n.hostName,t[i.SessionContextParameterName.HostVersion]=n&&n.hostVersion,t[i.SessionContextParameterName.OWAView]=n&&n.OWAView,t[i.SessionContextParameterName.InstallId]=e.JsApiProvider.getInstallId(),t[i.SessionContextParameterName.ItemType]=e.JsApiProvider.getMailboxItemType(),!0}(s,c)&&function(e,t,o){return!!t.ComponentsLoader&&(!(e.exchangeDeploymentEnvironment!==n.default.Online||!t.ComponentsLoader.isComponentLoaded(r.default.JS_API_PROVIDER)||!t.JsApiProvider.isRestCallbackTokenSupported())||!!t.ComponentsLoader.isComponentLoaded(r.default.EXCHANGE_PROVIDER)&&(!(!t.ExchangeProvider.ExchangeServerVersion||(o[i.SessionContextParameterName.ExchangeServerVersion]=t.ExchangeProvider.ExchangeServerVersion,!t.ExchangeProvider.EwsSchemaVersion))&&(o[i.SessionContextParameterName.EWSSchemaVersion]=t.ExchangeProvider.EwsSchemaVersion,!0)))}(e,s,c)&&(t.isSessionContextFulfilled=a=!0),c[i.SessionContextParameterName.DeploymentEnvironment]=n.default[e.crmDeploymentEnvironment],c[i.SessionContextParameterName.ExchangeDeploymentEnvironment]=n.default[e.exchangeDeploymentEnvironment],c[i.SessionContextParameterName.HostType]="MailApp",c[i.SessionContextParameterName.HostPlatform]=o.default.navigator().platform,c[i.SessionContextParameterName.MailboxId]=e.mailboxId,c[i.SessionContextParameterName.Mode]=e.displayMode,c[i.SessionContextParameterName.OrgId]=e.orgId,c[i.SessionContextParameterName.ShimVersion]=o.default.shimVersion(),c[i.SessionContextParameterName.ServerVersion]=o.default.appVersion(),c[i.SessionContextParameterName.SessionId]=u,c}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(1)],void 0===(o=function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype._reportIfUndefined=function(e,t){if(!t){var r=new n.ComponentError(e,"Trying to access "+e+" before it is initialized",n.ErrorCode.GENERIC);throw this._eventManager&&this._eventManager.ReportComponentFailure(r),r}},Object.defineProperty(e.prototype,"AuthenticationProvider",{get:function(){return this._reportIfUndefined(r.default.AUTHENTICATION_PROVIDER,this._authenticationProvider),this._authenticationProvider},set:function(e){this._authenticationProvider=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EventManager",{get:function(){return this._reportIfUndefined(r.default.EVENT_MANAGER,this._eventManager),this._eventManager},set:function(e){this._eventManager=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Storage",{get:function(){return this._reportIfUndefined(r.default.STORAGE,this._storage),this._storage},set:function(e){this._storage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"JsApiProvider",{get:function(){return this._reportIfUndefined(r.default.JS_API_PROVIDER,this._jsApiProvider),this._jsApiProvider},set:function(e){this._jsApiProvider=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ExchangeProvider",{get:function(){return this._reportIfUndefined(r.default.EXCHANGE_PROVIDER,this._exchangeProvider),this._exchangeProvider},set:function(e){this._exchangeProvider=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Bridge",{get:function(){return this._reportIfUndefined(r.default.WEB_SCRIPT_BRIDGE,this._bridge),this._bridge},set:function(e){this._bridge=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CRMProvider",{get:function(){return this._reportIfUndefined(r.default.CRM_PROVIDER,this._crmProvider),this._crmProvider},set:function(e){this._crmProvider=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DispatcherCollection",{get:function(){return this._reportIfUndefined(r.default.DISPATCHER_COLLECTION,this._dispatcherCollection),this._dispatcherCollection},set:function(e){this._dispatcherCollection=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Performance",{get:function(){return this._reportIfUndefined(r.default.PERFORMANCE,this._performance),this._performance},set:function(e){this._performance=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OrgUrl",{get:function(){return this._orgUrl},set:function(e){this._orgUrl=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ResourceManager",{get:function(){return this._reportIfUndefined(r.default.RESOURCE_MANAGER,this._resourceManager),this._resourceManager},set:function(e){this._resourceManager=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UIManager",{get:function(){return this._reportIfUndefined(r.default.UI_MANAGER,this._uiManager),this._uiManager},set:function(e){this._uiManager=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ComponentsLoader",{get:function(){return this._componentsLoader},set:function(e){this._componentsLoader=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AppChecker",{get:function(){return this._reportIfUndefined(r.default.APP_CHECKER,this._appChecker),this._appChecker},set:function(e){this._appChecker=e},enumerable:!0,configurable:!0}),e}();t.default=o}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(2),r(9),r(275),r(96),r(278)],void 0===(o=function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){this._bcd=e,this._appContext=t,this._storageItemsContainer={},this._validateStorageAccess()}return e.prototype._validateStorageAccess=function(){if(this._validationError=i.default.validateStorage(),!this._validationError)try{this._upgradeLocalStorage()}catch(e){}},e.prototype.getItem=function(e,t){return this._validationError?null:this._getStorageItem(e,t).getData()},e.prototype.setItem=function(e,t,r,n){this._validationError||this._getStorageItem(e,n).setData(t,r)},e.prototype.removeItem=function(e,t){this._validationError||(this._getStorageItem(e,t).removeData(),delete this._storageItemsContainer[e])},e.prototype.getItemExpiry=function(e,t){return this._validationError?null:this._getStorageItem(e,t).getDataExpiry()},e.prototype.validate=function(){return this._validationError},e.prototype.clearCache=function(){this._validationError||(r.default.localStorage().clear(),r.default.sessionStorage().clear())},e.prototype._getStorageItem=function(e,t){return this._storageItemsContainer[e]||(this._storageItemsContainer[e]=new o.default(this._bcd,this._appContext,e,t)),this._storageItemsContainer[e]},e.prototype._upgradeLocalStorage=function(){var e=r.default.localStorage().getItem(n.default.storageVersion),t=r.default.shimVersion();a.default(t,e)},e}();t.default=s}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(4),r(1),r(6),r(276),r(63),r(277)],void 0===(o=function(e,t,r,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t,r,n){if(this._applicationContext=t,this._storageKey=r,this._nativeStorage=a.default.getStorage(i.default[r].storageType),this._componentName=i.default[r].componentName,this._dataLifetime=i.default[r].lifetime,n)this._dataKey=n;else{switch(i.default[r].dataKey){case i.DATA_KEYS.UserEmail:this._dataKey=t.JsApiProvider.getUserEmailAddress();break;case i.DATA_KEYS.OrgId:this._dataKey=e.orgId;break;default:this._dataKey=i.default[r].dataKey}this._isRawValueKey=!this._dataKey}}return e.prototype._reportTraceError=function(e,t){this._applicationContext.EventManager.ReportTraceError(new n.ComponentError(this._componentName,e,n.ErrorCode.STORAGE_OPERATION),[{name:r.ErrorEventParameterName.Error,value:o.default.errorToObject(t)}])},e.prototype._getData=function(){var e;try{if(!(e=this._nativeStorage.getItem(this._storageKey)))return null}catch(e){return this._reportTraceError("Failed to get cached item from Storage for "+this._storageKey,e),null}try{return this._isRawValueKey?e:JSON.parse(e)}catch(e){return this._reportTraceError("Failed to parse cached data from Storage for "+this._storageKey,e),this._removeData(null,!0),null}},e.prototype._getMemorizedItem=function(){if(!this._memorizedCachedItem){this._applicationContext.EventManager.ReportTraceInfo(this._componentName,"Getting Storage data for key "+this._storageKey);var e=this._getData();e&&(this._applicationContext.EventManager.ReportTraceInfo(this._componentName,"Storage data retrieved for key "+this._storageKey),this._memorizedCachedItem=this._isRawValueKey?new s.default(e,0):e[this._dataKey])}return this._memorizedCachedItem?this._isExpired(this._memorizedCachedItem.timestamp)?(this._applicationContext.EventManager.ReportTraceInfo(this._componentName,"Storage data for key "+this._storageKey+" expired"),this.removeData(),null):this._memorizedCachedItem:(this._applicationContext.EventManager.ReportTraceInfo(this._componentName,"Data is empty in Storage for key "+this._storageKey),null)},e.prototype._removeData=function(e,t){if(void 0===t&&(t=!1),this._applicationContext.EventManager.ReportTraceInfo(this._componentName,"Clearing Storage data for key "+this._storageKey),this._isRawValueKey||t||!e||1===Object.keys(e).length)try{this._nativeStorage.removeItem(this._storageKey)}catch(e){this._reportTraceError("Failed to clear Storage data for key "+this._storageKey,e)}else delete e[this._dataKey],this._setData(e)},e.prototype._setData=function(e){try{this._nativeStorage.setItem(this._storageKey,this._isRawValueKey?e:JSON.stringify(e))}catch(e){this._reportTraceError("Failed to set Storage data for "+this._storageKey,e)}},e.prototype._isExpired=function(e){return e>0&&e<=Date.now()},e.prototype.getData=function(){var e=this._getMemorizedItem();return e&&e.data},e.prototype.getDataExpiry=function(){var e=this._getMemorizedItem();return e&&e.timestamp},e.prototype.setData=function(e,t){if(null!=e){var r={data:e,timestamp:t||(this._dataLifetime>0?Date.now()+this._dataLifetime:0)};if(this._memorizedCachedItem=r,this._isRawValueKey)this._setData(e);else{var n=this._getData()||{};n[this._dataKey]=r,this._setData(n)}}},e.prototype.removeData=function(e){void 0===e&&(e=!1),this._memorizedCachedItem=null;var t=this._getData();this._removeData(t,e)},e}();t.default=u}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(0),r(75),r(61),r(9),r(64)],void 0===(o=function(e,t,r,n,o,i,a){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0});var u={UserEmail:"UserEmail",OrgId:"OrgId"};t.DATA_KEYS=u;var c=function(e,t,r,n){void 0===n&&(n=a.default.LocalStorage),this.dataKey=e,this.lifetime=t,this.componentName=r,this.storageType=n};t.StorageKeyConfig=c;var l=((s={})[i.default.appModuleIdsCache]=new c(u.OrgId,12096e5,n.default.GET_APP_ID),s[i.default.categoryNamesCache]=new c(u.UserEmail,12096e5,n.default.CATEGORIES),s[i.default.checkEntitiesReadPrivilegeCache]=new c(u.UserEmail,72e5,n.default.CHECK_READ_PRIVILEGE),s[i.default.isFeaturesEnabledCache]=new c(u.OrgId,36e5,n.default.IS_FEATURES_ENABLED),s[i.default.orgSettingsCache]=new c(u.OrgId,864e5,n.default.ORG_SETTINGS),s[i.default.systemUsersCache]=new c(u.UserEmail,864e5,n.default.SYSTEM_USER),s[i.default.getUserValidationCache]=new c(u.UserEmail,18e5,n.default.GET_USER_VALIDATION),s[i.default.whoAmICache]=new c(u.UserEmail,864e5,n.default.WHO_AM_I),s[i.default.orgSettingsCache]=new c(u.OrgId,864e5,n.default.ORG_SETTINGS),s[i.default.sessionId]=new c(null,0,r.default.EVENT_MANAGER),s[i.default.initTime]=new c(null,0,r.default.EVENT_MANAGER),s[i.default.perfMetricStore]=new c(u.OrgId,0,r.default.PERFORMANCE,a.default.SessionStorage),s[i.default.tokenCallbackRest]=new c(u.UserEmail,0,o.default.GET_REST_CALLBACK_TOKEN),s[i.default.tokenCallbackEws]=new c(u.UserEmail,0,o.default.GET_EWS_CALLBACK_TOKEN),s[i.default.tokenOnPrem]=new c(u.UserEmail,0,r.default.AUTHENTICATION_PROVIDER),s[i.default.tokenAdal]=new c(u.UserEmail,0,r.default.AUTHENTICATION_PROVIDER),s[i.default.principalEmail]=new c(null,0,r.default.AUTHENTICATION_PROVIDER),s[i.default.loginDialogMode]=new c(null,0,r.default.AUTHENTICATION_PROVIDER),s[i.default.lastPinnedStateTimestamp]=new c(null,0,r.default.EVENT_MANAGER),s[i.default.unpinnedBootCount]=new c(null,0,r.default.BOOT_MANAGER),s[i.default.ariaTelemetry]=new c(null,0,r.default.TELEMETRY_ARCHIVER),s);t.default=l}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){this.data=e,this.timestamp=t};t.default=r}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o;n=[r,t,r(2),r(6),r(9),r(279)],void 0===(o=function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(i.default&&(t||(t="0"),n.default.isVersionGreater(t,e))){var a=Object.keys(r.default.localStorage()),s=function(e){var o=i.default[e],s=Object.keys(o);n.default.isVersionGreater(t,e)&&s.length&&s.forEach((function(e){a.forEach((function(t,n){if(-1!==t.indexOf(e)){var i=o[e];if(i&&i instanceof Function)try{i(e,t)}catch(e){}try{r.default.localStorage().removeItem(t)}catch(e){}}}))}))};for(var u in i.default)s(u);try{r.default.localStorage().setItem(o.default.storageVersion,e)}catch(e){}}}}.apply(t,n))||(e.exports=o)},function(e,t,r){var n;void 0===(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={"1.2.490":{UciDiscoveryEndpoint:null,StoredTelemetryEvents:null,MailApp_DisplayLanguage:null,"MailApp.CRMProvider.OrgSettings.TrackCategorizedItems":null,"MailApp.CRMProvider.OrgSettings.TrackAppointmentsFromNonOrganizer":null,"MailApp.CRMProvider.OrgSettings.DelegateAccessEnabled":null,"MailApp.CRMProvider.OrgSettings.CreateContactWithoutTracking":null,"MailApp.CRMProvider.OrgSettings.EmailInReadModeTrackEnabled":null,"MailApp.CRMProvider.OrgSettings.OverrideTrackInCrmBehaviour":null},"1.2.498":{MailAppRestCallbackToken_:null,MailAppEwsCallbackToken_:null,MailAppTokenExpiry_:null,MailAppToken_:null}}}.apply(t,[r,t]))||(e.exports=n)},function(e,t,r){var n,o,i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};n=[r,t,r(0),r(24),r(2),r(1),r(281),r(11),r(282),r(65),r(17),r(22),r(18),r(69),r(12),r(39)],void 0===(o=function(e,t,r,n,o,s,u,c,l,p,d,f,h,_,m,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=r.default.APP_CHECKER,E=function(){function e(e,t){var s=this;this._bcd=e,this._applicationContext=t,this._targetSelector="#"+p.UIIdentifierNames.content,this._isRendered=!1,this._isChromiumCheckEnabled=!0,this._isPopupRendered=!1,this._DefaultCheckerCommandState=!1,this._checkAllowedAndRun=function(e){return function(){return s._isAllowed().then((function(t){if(t)return e.call(s)}))}},this._renderLanding=function(){return i(s,void 0,void 0,(function(){var e,t,r,o=this;return a(this,(function(i){switch(i.label){case 0:return e=this,[4,this._isFeatureEnabled(c.FcbNames.MailAppEnableAppCheckerChromiumCheck)];case 1:return e._isChromiumCheckEnabled=i.sent(),this._applicationContext.EventManager.ReportTraceInfo(g,"Opening AppChecker Landing Page"),t={isCheckerCommandEnabled:this.getCheckerCommandState(),onCheckerCommandStateChanged:this._setCheckerCommandState},r=this._uiComponentsManager.renderLandingPage(t),this._render(r),n.default.queryById(p.UIIdentifierNames.appcheckerDiagnosticsBox).addEventListener("click",this._renderDiagnostics),this._subscribeToUnmounted((function(){n.default.queryById(p.UIIdentifierNames.appcheckerDiagnosticsBox).removeEventListener("click",o._renderDiagnostics)})),[2]}}))}))},this._setCheckerCommandState=function(e){var t=e?"1":"0";return s._applicationContext.ComponentsLoader.isComponentLoaded(r.default.JS_API_PROVIDER)?(s._applicationContext.JsApiProvider.setRoamingSettingsItem(v.RoamingSettingKeys.isOutlookCheckerCommandVisibleKey,t),s._applicationContext.JsApiProvider.saveRoamingSettingsAsync()):Promise.reject()},this._renderDiagnostics=function(){return i(s,void 0,void 0,(function(){var e,t,n,o,i,s,u,l,p,f,m,v,E,y,C,I,P,T,A,R,S,O,b,M,x,N,w,D,k,L,U,F,B,V,j,G,W,H,q,J,K,z,X,Y,Q;return a(this,(function(a){switch(a.label){case 0:return e=this,[4,this._isFeatureEnabled(c.FcbNames.MailAppEnableAppCheckerChromiumCheck)];case 1:return e._isChromiumCheckEnabled=a.sent(),t=this,[4,this._getData()];case 2:return t._data=a.sent(),n=null===(v=this._data.exchangeMailboxItemContext)||void 0===v?void 0:v.crmTrackStatus,this._applicationContext.EventManager.ReportTraceInfo(g,"Opening AppChecker Diagnostics Page"),o={orgId:this._bcd.orgId,sessionId:this._data.sessionId,outlookEmailAddress:this._applicationContext.ComponentsLoader.isComponentLoaded(r.default.JS_API_PROVIDER)?this._applicationContext.JsApiProvider.getUserEmailAddress():null,mailboxId:this._bcd.mailboxId,crmDeploymentEnvironment:d.default[this._bcd.crmDeploymentEnvironment],exchangeDeploymentEnvironment:d.default[this._bcd.exchangeDeploymentEnvironment],hostName:(null===(E=this._data.officeMailboxItemContext)||void 0===E?void 0:E.hostName)||null,hostVersion:(null===(y=this._data.officeMailboxItemContext)||void 0===y?void 0:y.hostVersion)||null,displayMode:this._bcd.displayMode,orgUrl:this._applicationContext.OrgUrl,browser:this._data.browserName||null,isDelegatedMailbox:void 0!==(null===(C=this._data.officeMailboxItemContext)||void 0===C?void 0:C.isDelegatedMailbox)?this._data.officeMailboxItemContext.isDelegatedMailbox.toString():null,currentDate:this._data.currentDate},i={mailboxItemId:(null===(I=this._data.officeMailboxItemContext)||void 0===I?void 0:I.id)||null,mailboxItemType:(null===(P=this._data.officeMailboxItemContext)||void 0===P?void 0:P.type)||null,messageId:(null===(A=null===(T=this._data.officeMailboxItemContext)||void 0===T?void 0:T.messageId)||void 0===A?void 0:A.replace("<","&lt;").replace(">","&gt;"))||null,crmId:(null===(S=null===(R=n)||void 0===R?void 0:R.CrmId)||void 0===S?void 0:S.replace(/[{}]/g,""))||null,recordUrl:null,trackingState:(null===(O=n)||void 0===O?void 0:O.CrmTrackingState)?h.default[Number(n.CrmTrackingState)]:null,trackedDate:(null===(b=this._data.exchangeMailboxItemContext)||void 0===b?void 0:b.trackedDate)||null,trackedFromMailApp:void 0!==(null===(M=n)||void 0===M?void 0:M.IsTrackedFromMailApp)?1===n.IsTrackedFromMailApp?"true":"false":null,isDelegatedMailbox:void 0!==(null===(x=this._data.officeMailboxItemContext)||void 0===x?void 0:x.isDelegatedMailbox)?this._data.officeMailboxItemContext.isDelegatedMailbox.toString():null,createdDate:(null===(N=this._data.officeMailboxItemContext)||void 0===N?void 0:N.createdDate)||null,modifiedDate:(null===(w=this._data.officeMailboxItemContext)||void 0===w?void 0:w.modifiedDate)||null,sentDate:(null===(D=this._data.exchangeMailboxItemContext)||void 0===D?void 0:D.sentDate)||null,hasAttachments:void 0!==(null===(k=this._data.exchangeMailboxItemContext)||void 0===k?void 0:k.hasAttachments)?this._data.exchangeMailboxItemContext.hasAttachments.toString():null,attachmentCount:(null===(L=this._data.exchangeMailboxItemContext)||void 0===L?void 0:L.attachmentCount)||null,hasD365Category:void 0!==(null===(U=this._data.exchangeMailboxItemContext)||void 0===U?void 0:U.hasD365Category)?null===(F=this._data.exchangeMailboxItemContext.hasD365Category)||void 0===F?void 0:F.toString():null},s={componentsStates:this._data.componentStates,orgId:this._bcd.orgId,sessionId:this._data.sessionId},u={privilegesConfig:(null===(V=null===(B=this._data.diagResults)||void 0===B?void 0:B.VerifyPrivilegesConfig)||void 0===V?void 0:V.privilegeStates)||[],helpLink:_.HelpLinks.PrivilegeErrorOccurs},l={diagResults:this._data.diagResults,isStorageValid:!this._applicationContext.Storage.validate()},p={errorTitle:(null===(G=null===(j=this._data)||void 0===j?void 0:j.errorDetails)||void 0===G?void 0:G.errorTitle)||(null===(H=null===(W=this._data)||void 0===W?void 0:W.trackFailure)||void 0===H?void 0:H.helpText),errorMessage:(null===(J=null===(q=this._data)||void 0===q?void 0:q.errorDetails)||void 0===J?void 0:J.errorMessage)||"",errorInfo:this._getErrorInfo()||(null===(z=null===(K=this._data.trackFailure)||void 0===K?void 0:K.exchangesyncidmapping)||void 0===z?void 0:z.lastsyncerror),helpLink:(null===(Y=null===(X=this._data)||void 0===X?void 0:X.errorDetails)||void 0===Y?void 0:Y.helpLink)||(null===(Q=this._data.trackFailure)||void 0===Q?void 0:Q.helpLink)},o.orgUrl&&(i.mailboxItemType&&i.crmId&&(i.recordUrl=this._getRecordUrl(o.orgUrl,i.mailboxItemType,i.crmId)),o.mailboxUrl=encodeURI(o.orgUrl+"/main.aspx?etc=9606&extraqs=?etc=9606&id={"+o.mailboxId+"}&newWindow=true&pagetype=entityrecord")),o.outlookEmailAddress&&this._data.d365Email&&o.outlookEmailAddress.toLowerCase()!==this._data.d365Email.toLowerCase()&&(o.d365EmailAddress=this._data.d365Email),f={environment:o,mailboxItem:i,components:s,diagchecks:l,errorProps:p,privileges:u},m=this._uiComponentsManager.renderDiagnosticsPage(f),this._render(m),[2]}}))}))},this._closePopup=function(){n.default.queryById(p.UIIdentifierNames.appcheckerPopupClose).removeEventListener("click",s._closePopup),n.default.removeElement("#"+p.UIIdentifierNames.appcheckerPopup),s._isPopupRendered=!1},this._onDownload=function(){return i(s,void 0,void 0,(function(){var e,t;return a(this,(function(r){switch(r.label){case 0:return e=this,[4,this._getData()];case 1:return e._data=r.sent(),t=this._bcd.mailboxId+"_"+(new Date).getTime()+".txt",this._downloadFile(t,JSON.stringify(this._data,null,2)),this._applicationContext.EventManager.ReportTraceInfo(g,"AppChecker Error Logs Downloaded"),[2]}}))}))},this._clearLocalStorage=function(){s._applicationContext.Storage.clearCache(),s._applicationContext.EventManager.ReportTraceInfo(g,"AppChecker LocalStorage Cleared"),s._showPopup("Cache cleared.")},this._close=function(){s._isRendered=!1,s._renderedComponent.onUnmounted(),n.default.queryById(p.UIIdentifierNames.appcheckerClose).removeEventListener("click",s._close),n.default.queryById(p.UIIdentifierNames.appcheckerBack).removeEventListener("click",s._renderLanding),n.default.queryById(p.UIIdentifierNames.appcheckerDownloadLogs).removeEventListener("click",s._onDownload),n.default.queryById(p.UIIdentifierNames.appcheckerClearStorage).removeEventListener("click",s._clearLocalStorage),n.default.removeElement("#"+p.UIIdentifierNames.appchecker),s._renderedComponent=void 0},this._registerToggleListener=function(e){void 0===e&&(e=o.default.document()),e.addEventListener("keyup",s._onKeyUpHandler)},this._onKeyUpHandler=function(e){if(e.ctrlKey&&e.altKey&&89===e.which)return s._checkAllowedAndRun(s.toggle)()},this._registerToggleListener(),this._uiComponentsManager=new l.default(this._applicationContext)}return e.prototype.initialize=function(){var e=this;this._applicationContext.UIManager.subscribeToErrorEvent((function(t){n.default.query("."+p.UIClassNames.SHOW_APP_CHECKER).addEventListener("click",e._checkAllowedAndRun(e._renderDiagnostics)),e._error=t}),(function(t){e._error=null})),this._applicationContext.ComponentsLoader.ensureComponentLoaded(r.default.UNIFIED_CLIENT_LOADER).then(this._registerToggleListener)},e.prototype.toggle=function(e){if(this._isRendered)return this._close();e?this._renderDiagnostics():this._renderLanding()},e.prototype.getCheckerCommandState=function(){var e=this._DefaultCheckerCommandState;if(this._applicationContext.ComponentsLoader.isComponentLoaded(r.default.JS_API_PROVIDER)){var t=this._applicationContext.JsApiProvider.getRoamingSettingsItem(v.RoamingSettingKeys.isOutlookCheckerCommandVisibleKey);e=t?0!==parseInt(t,10):this._DefaultCheckerCommandState}return e},e.prototype._isAllowed=function(){var e=this;return this._applicationContext.ComponentsLoader.isComponentLoaded(r.default.CRM_PROVIDER)?this._applicationContext.CRMProvider.isFeatureControlBitEnabled(c.FcbNames.DisableMailAppChecker).then((function(t){return t&&e._applicationContext.EventManager.ReportTraceInfo(g,"FCB.DisableMailAppChecker blocked AppChecker"),!t})).catch((function(t){return e._applicationContext.EventManager.ReportTraceError(t),!0})):Promise.resolve(!0)},e.prototype._isFeatureEnabled=function(e){return this._applicationContext.ComponentsLoader.isComponentLoaded(r.default.CRM_PROVIDER)?this._applicationContext.CRMProvider.isFeatureControlBitEnabled(e):Promise.resolve(!1)},e.prototype._getTrackFailure=function(e){return i(this,void 0,void 0,(function(){var t,r,n=this;return a(this,(function(o){return t="&$filter=exchangeentryid eq '"+e+"'",r="exchangesyncidmappings?$select="+["exchangeentryid","objectid","lastsyncerror","lastsyncerrorcode","userdecision","isunlinkedincrm","tocrmchangetype"].join(",")+t,[2,this._applicationContext.CRMProvider.executeOdataQuery(r).then((function(e){var t;if(Array.isArray(e)&&e[0]){var r={exchangesyncidmapping:e[0]},n=e[0].lastsyncerror,o=e[0].lastsyncerrorcode;if(-1!==(null===(t=n)||void 0===t?void 0:t.indexOf("PromoteDecision")))return;return s.ErrorCode.isPluginOrWorkflowError(n)?(r.helpText="This item was processed by Server-Side Sync but failed. The error code we found typically indicates the item could not be created successfully because of a problem with a custom plug-in or workflow rule.",r.helpLink="https://support.microsoft.com/help/4466423"):113!==o&&-1===n.indexOf(s.ErrorCode.ACCESS_DENIED.toString())||(r.helpText="This item was processed by Server-Side Sync but failed due to a privilege error.",r.helpLink="https://support.microsoft.com/help/4015092"),r}})).catch((function(e){n._applicationContext.EventManager.ReportTraceError(new s.ComponentError(g,"AppChecker: Unable to retrieve ExchangeSyncIdMapping",s.ErrorCode.GENERIC,e))}))]}))}))},e.prototype._getData=function(){var e,t,n,o,c,l,p,d;return i(this,void 0,void 0,(function(){var i,_,v,E,y,C,I,P,T,A,R,S,O,b,M,x,N,w,D=this;return a(this,(function(a){switch(a.label){case 0:return _={bcd:this._bcd},[4,this._applicationContext.ComponentsLoader.getComponentStates()];case 1:if(_.componentStates=a.sent(),_.sessionId=this._applicationContext.EventManager.getSessionId(),_.currentDate=(new Date).toUTCString(),i=_,this._error&&this._applicationContext.ComponentsLoader.isComponentLoaded(r.default.RESOURCE_MANAGER))try{v={errorTitle:this._applicationContext.ResourceManager.getErrorTitle(this._error),errorMessage:this._applicationContext.ResourceManager.getErrorMessage(this._error),helpLink:u.default.getHelpLink(this._applicationContext,this._bcd,this._error),errorComponent:this._error.componentName,errorCode:this._error.code,stack:this._error.stack},i.errorDetails=v}catch(e){this._applicationContext.EventManager.ReportTraceError(new s.ComponentError(g,"AppChecker: Unable to retrieve error details",s.ErrorCode.GENERIC,e))}if(!this._applicationContext.ComponentsLoader.isComponentLoaded(r.default.JS_API_PROVIDER))return[3,8];a.label=2;case 2:return a.trys.push([2,7,,8]),E=this._applicationContext.JsApiProvider.getMailboxItem(),C={},this._bcd.mode!==m.default.Module?[3,3]:(I=null,[3,5]);case 3:return[4,this._applicationContext.JsApiProvider.getMailboxItemId()];case 4:I=a.sent(),a.label=5;case 5:return C.id=I,C.type=this._applicationContext.JsApiProvider.getMailboxItemType(),C.messageId=this._bcd.mode===m.default.Module?null:null===(e=E)||void 0===e?void 0:e.internetMessageId,C.hostName=this._applicationContext.JsApiProvider.getMailboxDiagnostics().hostName,C.hostVersion=this._applicationContext.JsApiProvider.getMailboxDiagnostics().hostVersion,[4,this._applicationContext.JsApiProvider.isDelegatedMailbox()];case 6:return C.isDelegatedMailbox=a.sent(),C.createdDate=null===(n=null===(t=E)||void 0===t?void 0:t.dateTimeCreated)||void 0===n?void 0:n.toUTCString(),C.modifiedDate=null===(c=null===(o=E)||void 0===o?void 0:o.dateTimeModified)||void 0===c?void 0:c.toUTCString(),y=C,i.officeMailboxItemContext=y,[3,8];case 7:return P=a.sent(),this._applicationContext.EventManager.ReportTraceError(new s.ComponentError(g,"AppChecker: Unable to retrieve Office Mailbox Item Context from JsApiProvider",s.ErrorCode.GENERIC,P)),[3,8];case 8:return this._applicationContext.ComponentsLoader.isComponentLoaded(r.default.EXCHANGE_PROVIDER)&&this._bcd.mode!==m.default.Module?[4,Promise.all([this._applicationContext.ExchangeProvider.MailboxItemProvider.retrieveMailboxItem(),this._applicationContext.ExchangeProvider.MailboxItemProvider.retrieveTrackStatus(),this._applicationContext.ExchangeProvider.MailboxItemProvider.getAttachmentIds()]).then((function(e){var t,r,n,o,a,s,u=e[0],c=e[1],l=e[2],p={crmTrackStatus:c||null,item:u,trackedDate:(null===(t=c)||void 0===t?void 0:t.TrackTimestamp)?new Date(null===(r=c)||void 0===r?void 0:r.TrackTimestamp).toUTCString():null,sentDate:null===(o=null===(n=u)||void 0===n?void 0:n.DateTimeSent)||void 0===o?void 0:o.toUTCString(),hasAttachments:(null===(a=l)||void 0===a?void 0:a.length)>0,attachmentCount:(null===(s=l)||void 0===s?void 0:s.length)||null};i.exchangeMailboxItemContext=p})).then((function(){D._applicationContext.ComponentsLoader.isComponentLoaded(r.default.CRM_PROVIDER)&&D._applicationContext.CRMProvider.getMailboxTrackingCategoryName().then((function(e){var t,r,n;e&&(i.exchangeMailboxItemContext.hasD365Category=(null===(n=null===(r=null===(t=i.exchangeMailboxItemContext)||void 0===t?void 0:t.item)||void 0===r?void 0:r.Categories)||void 0===n?void 0:n.indexOf(e))>-1||null)})).catch((function(e){D._applicationContext.EventManager.ReportTraceError(new s.ComponentError(g,"AppChecker: Unable to retrieve D365 Category Name",s.ErrorCode.GENERIC,e))}))})).catch((function(e){D._applicationContext.EventManager.ReportTraceError(new s.ComponentError(g,"AppChecker: Unable to retrieve Exchange Mailbox Item Context from ExchangeProvider",s.ErrorCode.GENERIC,e))}))]:[3,10];case 9:a.sent(),a.label=10;case 10:return a.trys.push([10,12,,13]),[4,u.default.getDiagDetails(this._applicationContext,this._bcd)];case 11:return T=a.sent(),i.diagResults=T,[3,13];case 12:return A=a.sent(),this._applicationContext.EventManager.ReportTraceError(new s.ComponentError(g,"AppChecker: Unable to retrieve Diagnostic Results",s.ErrorCode.GENERIC,A)),[3,13];case 13:if(!this._applicationContext.ComponentsLoader.isComponentLoaded(r.default.CRM_PROVIDER))return[3,28];a.label=14;case 14:return a.trys.push([14,16,,17]),[4,this._applicationContext.CRMProvider.getFeatureControlBits()];case 15:return R=a.sent(),i.fcb=R,[3,17];case 16:return S=a.sent(),this._applicationContext.EventManager.ReportTraceError(new s.ComponentError(g,"AppChecker: Unable to retrieve Feature Control Bit (FCB) values",s.ErrorCode.GENERIC,S)),[3,17];case 17:return a.trys.push([17,19,,20]),[4,this._applicationContext.CRMProvider.getOrgSettings()];case 18:return O=a.sent(),i.orgSettings=O,[3,20];case 19:return b=a.sent(),this._applicationContext.EventManager.ReportTraceError(new s.ComponentError(g,"AppChecker: Unable to retrieve Org Settings values",s.ErrorCode.GENERIC,b)),[3,20];case 20:return a.trys.push([20,25,,26]),(null===(p=null===(l=i.exchangeMailboxItemContext)||void 0===l?void 0:l.crmTrackStatus)||void 0===p?void 0:p.CrmTrackingState)!==h.default.IsLinked&&null!==(d=i.officeMailboxItemContext)&&void 0!==d&&d.id?i.officeMailboxItemContext.messageId?(M=i,[4,this._getTrackFailure(i.officeMailboxItemContext.messageId)]):[3,22]:[3,24];case 21:return M.trackFailure=a.sent(),[3,24];case 22:return x=encodeURIComponent(i.officeMailboxItemContext.id),N=i,[4,this._getTrackFailure(x)];case 23:N.trackFailure=a.sent(),a.label=24;case 24:return[3,26];case 25:return w=a.sent(),this._applicationContext.EventManager.ReportTraceError(new s.ComponentError(g,"AppChecker: Unable to retrieve track failure",s.ErrorCode.GENERIC,w)),[3,26];case 26:return this._applicationContext.ComponentsLoader.isComponentLoaded(r.default.JS_API_PROVIDER)?[4,this._applicationContext.CRMProvider.getCurrentUserEmailAddress().then((function(e){i.d365Email=e})).catch((function(e){D._applicationContext.EventManager.ReportTraceError(new s.ComponentError(g,"AppChecker: Unable to retrieve email address from user record",s.ErrorCode.GENERIC,e))}))]:[3,28];case 27:a.sent(),a.label=28;case 28:try{i.browserName=f.default.getInstance().getBrowserName()}catch(e){this._applicationContext.EventManager.ReportTraceInfo(g,"AppChecker: Unable to retrieve browser name",s.ErrorCode.GENERIC,e)}return[2,i]}}))}))},e.prototype._downloadFile=function(e,t){var r=new Blob([t],{type:"text/json"});if(o.default.navigator().msSaveOrOpenBlob)o.default.navigator().msSaveBlob(r,e);else{var n=o.default.URL().createObjectURL(r),i=this._applicationContext.JsApiProvider.getIsDesktopOutlook();if(this._isChromiumCheckEnabled&&f.default.getInstance().getIsChromiumCoreVersionNotLess(83)&&!i){this._applicationContext.EventManager.ReportTraceInfo(g,"Opening new window for downloading log file");var a=o.default.open("about:blank",null,"width=600,height=400").document.body;a.setAttribute("style","font-family:'Segoe UI',Arial,sans-serif;font-size:.7em"),a.innerHTML=this._applicationContext.ResourceManager.getString("MailApp_ClickToDownload").format('<a href="'+n+'" download="'+e+'">',"</a>")}else{var s=o.default.document().createElement("a");s.href=n,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s)}}},e.prototype._getErrorInfo=function(){var e=this._error;if(e)return this._applicationContext.ResourceManager.getString("MailApp.Generic.ActivityId").format(this._applicationContext.EventManager.getSessionId(),(new Date).toUTCString(),e&&e.message||"",e&&e.stack||"")},e.prototype._getRecordUrl=function(e,t,r){var n=4202;return"appointment"===t&&(n=4201),e+"/main.aspx?pagetype=entityrecord&etc="+n+"&id="+(r=r.replace(/[{}]/g,""))},e.prototype._render=function(e){this._isRendered&&this._close(),this._renderedComponent=e;var t=n.default.createFragment(this._renderedComponent.layout);n.default.prepend(this._targetSelector,t),this._renderedComponent.onMounted(),n.default.queryById(p.UIIdentifierNames.appcheckerClose).addEventListener("click",this._close),n.default.queryById(p.UIIdentifierNames.appcheckerBack).addEventListener("click",this._renderLanding),n.default.queryById(p.UIIdentifierNames.appcheckerDownloadLogs).addEventListener("click",this._onDownload),n.default.queryById(p.UIIdentifierNames.appcheckerClearStorage).addEventListener("click",this._clearLocalStorage),this._isRendered=!0},e.prototype._showPopup=function(e){this._isPopupRendered&&this._closePopup();var t=this._uiComponentsManager.renderPopup({content:e}),r=n.default.createFragment(t.layout);n.default.prepend("#"+p.UIIdentifierNames.appchecker,r),n.default.queryById(p.UIIdentifierNames.appcheckerPopupClose).addEventListener("click",this._closePopup),this._isPopupRendered=!0},e.prototype._subscribeToUnmounted=function(e){var t=this._renderedComponent.onUnmounted;this._renderedComponent.onUnmounted=function(){e(),t()}},e}();t.default=E}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};n=[r,t,r(0),r(1),r(21),r(109),r(98),r(69),r(11)],void 0===(o=function(e,t,r,n,o,u,c,l,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=r.default.APP_CHECKER+".DiagChecker",f=function(){function e(){}return e.getDiagDetails=function(e,t){return a(this,void 0,void 0,(function(){var o,a,c,l,p,f,h,_,m,v;return s(this,(function(s){switch(s.label){case 0:return o={},e.ComponentsLoader.isComponentLoaded(r.default.CRM_PROVIDER)?(l=o,[4,this._verifyMailboxTestStatus(e,t)]):(a={state:u.DiagCheckState.Unknown,error:new n.default(d,"Unable to run diagnostic checks. Component "+r.default.CRM_PROVIDER+" is unavailable",n.ErrorCode.UNKNOWN)},c=i(i({},a),{validationMessages:[]}),e.EventManager.ReportTraceError(a.error),o.VerifyMailboxTestStatus=o.VerifyAppModuleAccess=o.VerifyUserEmailAddress=a,o.VerifyPrivilegesConfig=i(i({},a),{privilegeStates:[]}),o.VerifyDeactivatedViews=i(i({},a),{views:[]}),o.VerifyDashboard=c,o.VerifySitemap=c,o.VerifyDashboardSummary=c,[2,o]);case 1:return l.VerifyMailboxTestStatus=s.sent(),p=o,[4,this._verifyAppModuleAccess(e,t)];case 2:return p.VerifyAppModuleAccess=s.sent(),f=o,[4,this._verifyUserEmailAddress(e,t)];case 3:return f.VerifyUserEmailAddress=s.sent(),h=o,[4,this._verifyDeactivatedViews(e)];case 4:return h.VerifyDeactivatedViews=s.sent(),_=o,[4,this._verifyPrivilegesConfig(e)];case 5:return _.VerifyPrivilegesConfig=s.sent(),m=o,[4,this._verifyDashboard(e)];case 6:return m.VerifyDashboard=s.sent(),v=o,[4,this._verifySitemap(e)];case 7:return v.VerifySitemap=s.sent(),o.VerifyDashboardSummary=this._verifyDashboardSummary(o.VerifyDashboard,o.VerifySitemap),[2,o]}}))}))},e._verifyMailboxTestStatus=function(t,r){return a(this,void 0,void 0,(function(){var i,a,c;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,t.CRMProvider.getUserValidation()];case 1:return s.sent(),[2,{state:u.DiagCheckState.Passed,error:null}];case 2:return i=s.sent(),a=o.ensureComponentErrorObject(i),c=this._getMailAppCompatiableErrorCode(a.code),-1!==[n.ErrorCode.UV_SSS_CONFIG_MISSING,n.ErrorCode.UV_SSS_CONFIG_MISSING_FOR_ACT].indexOf(c)?[2,{state:u.DiagCheckState.Failed,error:a,helpLink:e.getHelpLink(t,r,a)}]:[2,{state:u.DiagCheckState.Unknown,error:a}];case 3:return[2]}}))}))},e._verifyAppModuleAccess=function(t,r){return a(this,void 0,void 0,(function(){var i,a;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,t.CRMProvider.getAppId()];case 1:return s.sent(),[2,{state:u.DiagCheckState.Passed,error:null}];case 2:return i=s.sent(),a=o.ensureComponentErrorObject(i),this._getMailAppCompatiableErrorCode(a.code)===n.ErrorCode.CRM_APP_MODULE_PERMISSION?[2,{state:u.DiagCheckState.Failed,error:a,helpLink:e.getHelpLink(t,r,a)}]:[2,{state:u.DiagCheckState.Unknown,error:a}];case 3:return[2]}}))}))},e._verifyUserEmailAddress=function(t,r){return a(this,void 0,void 0,(function(){var i,a;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,t.CRMProvider.getUserValidation()];case 1:return s.sent(),[2,{state:u.DiagCheckState.Passed,error:null}];case 2:return i=s.sent(),a=o.ensureComponentErrorObject(i),this._getMailAppCompatiableErrorCode(a.code)===n.ErrorCode.UV_EMAIL_ADDRESS_MISMATCH?[2,{state:u.DiagCheckState.Failed,error:a,helpLink:e.getHelpLink(t,r,a)}]:[2,{state:u.DiagCheckState.Unknown,error:a}];case 3:return[2]}}))}))},e._verifyDeactivatedViews=function(e){var t=this,r="savedqueries?$select="+["name","returnedtypecode"].join(",")+"&"+("$filter=statecode eq 1 and ("+Object.keys(l.ViewIds).map((function(e){return"savedqueryid eq '"+l.ViewIds[e]+"'"})).join(" or ")+")");return e.CRMProvider.executeOdataQuery(r).then((function(e){return{state:e?e.length?u.DiagCheckState.Failed:u.DiagCheckState.Passed:u.DiagCheckState.Unknown,error:null,views:e}})).catch((function(r){var n=t._getAndReportComponentError(e,"Unable to retrieve Deactivated Views",r);return{state:u.DiagCheckState.Unknown,error:n,views:[]}}))},e._verifyPrivilegesConfig=function(e){var t=this;return e.CRMProvider.whoAmI().then((function(t){var r=t.UserId,n=l.MailAppRolePrivileges.map((function(e){return"systemusers("+r+")/Microsoft.Dynamics.CRM.RetrieveUserPrivilegeByPrivilegeName(PrivilegeName='"+e+"')"}));return e.CRMProvider.sendOdataMultiqueryBatchRequest(d,n)})).then((function(e){return l.MailAppRolePrivileges.reduce((function(t,r,o){var i,a,s;if(null===(i=t[t.length-1])||void 0===i?void 0:i.error)return t;var c,l=e[o],p=u.PrivilegeStatus.Missing;return l instanceof n.default?(p=u.PrivilegeStatus.Unknown,c=l):(null===(s=null===(a=l)||void 0===a?void 0:a.RolePrivileges)||void 0===s?void 0:s.length)&&(p=u.PrivilegeStatus.Present),t.push({privilegeName:r,status:p,error:c}),t}),[])})).then((function(e){return{state:e.every((function(e){return e.status===u.PrivilegeStatus.Present}))?u.DiagCheckState.Passed:e.some((function(e){return e.status===u.PrivilegeStatus.Missing}))?u.DiagCheckState.Failed:u.DiagCheckState.Unknown,error:null,privilegeStates:e}})).catch((function(r){var n=t._getAndReportComponentError(e,"Unable to retrieve User Privileges",r);return{state:u.DiagCheckState.Unknown,error:n,privilegeStates:[]}}))},e._verifyDashboard=function(e){var t=this;return e.CRMProvider.whoAmI().then((function(t){var r="systemusers("+t.UserId+")?$expand=systemuserroles_association($select=roleid)&$select=systemuserroles_association",n=["formactivationstate","formxml"].join(","),o=[r,"systemforms("+l.SystemFormIds.MailAppDashboard+")?$select="+n];return e.CRMProvider.sendOdataMultiqueryBatchRequest(d,o)})).then((function(e){var r=e[0],n=e[1];t._throwIfContainsComponentError([r,n]);var o;if(1===n.formactivationstate){var i=r.systemuserroles_association.map((function(e){return e.roleid.toLowerCase()}));t._verifyDashboardRoles(n.formxml,i)||(o="You don't have access to App for Outlook dashboard. You should be part any of the security roles that can access the dashboard.")}else o="App for Outlook dashboard is not active. You should activate the dashboard and try again.";return t._getDiagResult(o)})).catch((function(r){var n=t._getAndReportComponentError(e,"Unable to validate MailApp Dashboard",r);return{state:u.DiagCheckState.Unknown,error:n,validationMessages:[]}}))},e._verifyDashboardRoles=function(e,t){var r=!0,n=(new DOMParser).parseFromString(e,"application/xml").getElementsByTagName("DisplayConditions");if(n.length){for(var o=n[0].getElementsByTagName("Role"),i=[],a=0;a<o.length;a++)i.push(o.item(a));var s=i.map((function(e){return e.getAttribute("Id").replace(/[{}]/g,"").toLowerCase()}));r=!s.length||s.some((function(e){return t.indexOf(e)>-1}))}return r},e._verifySitemap=function(e){var t=this,r=["appmodulecomponents?$filter="+("componenttype eq 62 and appmoduleid/uniquename eq '"+p.MailAppModuleUniqueName+"'")+"&$select=objectid","sitemaps?$filter=sitemapnameunique eq 'AppforOutlookSiteMap'&$select="+["sitemapxml","sitemapid"].join(",")];return e.CRMProvider.sendOdataMultiqueryBatchRequest(d,r).then((function(e){var r,n=e[0],o=e[1];if(t._throwIfContainsComponentError([n,o]),0===o.value.length)r="App for Outlook sitemap is missing. You should update the app to add the App for Outlook sitemap and try again.";else if(0===n.value.length)r="No sitemap is associated with App for Outlook. You should update the app to add the App for Outlook sitemap and try again.";else if(n.value.length>1)r="More than one sitemaps are configured for App for Outlook. You should update the app to remove all sitemaps except the App for Outlook sitemap and try again.";else{var i=n.value[0],a=o.value[0];i.objectid.toLowerCase()!==a.sitemapid.toLowerCase()&&(r="Unexpected sitemap configured for App for Outlook. You should update the app to remove the current sitemap, then add the App for Outlook sitemap and try again.")}if(!r){var s=o.value[0].sitemapxml;(new DOMParser).parseFromString(s,"application/xml").getElementsByTagName("Area")[0].getElementsByTagName("Group")[0].getElementsByTagName("SubArea")[0].getAttribute("DefaultDashboard").toLowerCase()!==l.SystemFormIds.MailAppDashboard.toLowerCase()&&(r="App for Outlook dashboard should be the default dashboard. You should update the app to configure the default dashboard and try again.")}return t._getDiagResult(r)})).catch((function(r){var n=t._getAndReportComponentError(e,"Unable to validate MailApp Sitemap",r);return{state:u.DiagCheckState.Unknown,error:n,validationMessages:[]}}))},e._verifyDashboardSummary=function(e,t){return{state:e.state===u.DiagCheckState.Failed||t.state===u.DiagCheckState.Failed?u.DiagCheckState.Failed:e.state===u.DiagCheckState.Passed&&t.state===u.DiagCheckState.Passed?u.DiagCheckState.Passed:u.DiagCheckState.Unknown,error:e.error||t.error,validationMessages:e.validationMessages.concat(t.validationMessages)}},e._getDiagResult=function(e){return{state:e?u.DiagCheckState.Failed:u.DiagCheckState.Passed,error:null,validationMessages:e?[e]:[]}},e._getAndReportComponentError=function(e,t,r){var o=new n.default(d,t,n.ErrorCode.UNKNOWN,r);return e.EventManager.ReportTraceError(o),o},e._getMailAppCompatiableErrorCode=function(e){return e<0?e>>>0:e},e._throwIfContainsComponentError=function(e){var t=e.find((function(e){return e instanceof n.default}));if(t)throw t},e.getHelpLink=function(e,t,r){if(!r||r.code!==n.ErrorCode.UNKNOWN)return c.default.generate(r,e.EventManager.getSessionId(),t.orgId)},e}();t.default=f}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o;n=[r,t,r(283)],void 0===(o=function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this._applicationContext=e,this._componentsMap=r}return e.prototype.renderLandingPage=function(e){return this._renderComponent("AppcheckerLandingPage",e)},e.prototype.renderDiagnosticsPage=function(e){return this._renderComponent("AppcheckerDiagnosticsPage",e)},e.prototype.renderPopup=function(e){return this._renderComponent("AppcheckerPopup",e)},e.prototype._renderComponent=function(e,t){var r=this,n=new this._componentsMap[e](this._applicationContext.ResourceManager),o=n.render(t),i=o.template,a=o.outputProps,s=this._renderTemplate(i,a),u=[n.onMounted.bind(n)].concat(s.onMountedHandlers),c=[n.onUnmounted.bind(n)].concat(s.onUnmountedHandlers);return{layout:s.template,onMounted:function(){return r._safelyCallHandlers(u)},onUnmounted:function(){return r._safelyCallHandlers(c)}}},e.prototype._safelyCallHandlers=function(e){e.forEach((function(e){try{e()}catch(e){}}))},e.prototype._parseComponentsProps=function(e){var t='\\b([A-Za-z0-9]+)\\s*=\\s*"(.*?)"',r=e.match(new RegExp(t,"g"));return r?r.map((function(e){return e.match(new RegExp(t))})).reduce((function(e,t){return t&&(e[t[1]]=t[2]),e}),{}):{}},e.prototype._renderTemplate=function(e,t){for(var r=this,n=[],o=[],i=/<([A-Z][A-Za-z]+)(.*?)(\/)?>(((\s|\S)*?)<\/\1>)?/;e.match(i);)e=e.replace(i,(function(e,i,a,s,u,c){var l=r._parseComponentsProps(a),p=r._componentsMap[i],d=!!s,f="",h="";if(d){if(h=u||"",c)return"invalid template, closing tag detected for self-closing tag: "+i}else f=c;if(p){var _=new p(r._applicationContext.ResourceManager);n.push(_.onMounted.bind(_)),o.push(_.onUnmounted.bind(_));var m=t&&l.props?t[l.props]:{};f&&(m.content=f);var v=_.render(m),g=d?v.outputProps:t,E=r._renderTemplate(v.template,g);return n.push.apply(n,E.onMountedHandlers),o.push.apply(o,E.onUnmountedHandlers),E.template+h}return"unknown component: "+i}));return{template:e,onMountedHandlers:n,onUnmountedHandlers:o}},e}();t.default=n}.apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};n=[r,t,r(95),r(109),r(65),r(69),r(24),r(20)],void 0===(o=function(e,t,r,n,o,i,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e){this.resourceManager=e}return e.prototype.onMounted=function(){},e.prototype.onUnmounted=function(){},e}(),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){return{template:'\n\t\t\t<div class="appchecker-contaner" id="appchecker">\n\t\t\t\t<div class="appchecker-header">\n\t\t\t\t\t<span class="svgIcon back'+(e.isBackHidden?" hidden":"")+'"'+(e.isBackHidden?' aria-hidden="true"':"")+' id="'+o.UIIdentifierNames.appcheckerBack+'" role="button" title="Back" aria-label="Back"></span>\n\t\t\t\t\t<h2>'+e.title+'</h2>\n\t\t\t\t\t<span class="svgIcon close" id="'+o.UIIdentifierNames.appcheckerClose+'" role="button" title="Close" aria-label="Close"></span>\n\t\t\t\t</div>\n\t\t\t\t'+e.content+"\n\t\t\t</div>\t\n\t\t",outputProps:e}},t}(l);t.AppcheckerContainer=p;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){return{template:'\n\t\t\t<div id="'+o.UIIdentifierNames.appcheckerPopup+'">\n\t\t\t\t<div class="svgIcon close appcheckerPopup-close" id="'+o.UIIdentifierNames.appcheckerPopupClose+'" role="button" title="Close" aria-label="Close"></div>\n\t\t\t\t'+e.content+"\n\t\t\t</div>\n\t\t",outputProps:void 0}},t}(l);t.AppcheckerPopup=d;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){return{template:'\n\t\t\t<div class="appchecker-boxItem" id="'+e.boxId+'">\n\t\t\t\t<h4>'+e.title+'</h4>\n\t\t\t\t<div class="appchecker-box-description">\n\t\t\t\t\t'+e.description+'\n\t\t\t\t</div>\n\t\t\t\t<a href="#" class="appchecker-box-link" id="'+e.linkId+'">'+e.linkText+"</a>\n\t\t\t</div>\n\t\t",outputProps:void 0}},t}(l);t.AppcheckerBox=f;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){return{template:'\n\t\t\t<div class="appchecker-boxes-container">\n\t\t\t\t<AppcheckerBox props="diagnosticsBox"/>\n\t\t\t</div>\n\t\t',outputProps:{diagnosticsBox:{title:"Diagnostics",description:"Review the current state of the add-in and resolve any issues by following the solutions.",linkId:o.UIIdentifierNames.appcheckerSeeMoreDiagnostics,linkText:"Run diagnostics",boxId:o.UIIdentifierNames.appcheckerDiagnosticsBox}}}},t}(l);t.AppcheckerBoxes=h;var _=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){return{template:'\n\t\t\t<AppcheckerContainer props="content">\n\t\t\t\t<AppcheckerToolbar />\n\t\t\t\t<div class="appchecker-main">\n\t\t\t\t\t<AppcheckerSectionContainer props="container">\n\t\t\t\t\t\t<AppcheckerToggleControl props="toggleControl" />\n\t\t\t\t\t</AppcheckerSectionContainer>\n\t\t\t\t\t<AppcheckerBoxes />\n\t\t\t\t</div>\n\t\t\t</AppcheckerContainer>\n\t\t',outputProps:{content:{title:"Outlook Checker",isBackHidden:!0},container:{title:"Show/Hide checker icon",description:"Show or hide the checker icon in the command bar within the app."},toggleControl:{enabledLabel:"Show",disabledLabel:"Hide. Press CTRL+ALT+Y to show.",onCheckerCommandStateChanged:e.onCheckerCommandStateChanged,isCheckerCommandEnabled:e.isCheckerCommandEnabled}}}},t}(l);t.AppcheckerLandingPage=_;var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onClicked=function(){var e=t._isEnabled;t._isEnabled=!t._isEnabled,t._onStateChanged(t._isEnabled).catch((function(){t._isEnabled=e,t._updateUIState()})),t._updateUIState()},t}return a(t,e),t.prototype.render=function(e){return this._id=c.default.newGuid().guid,this._buttonId=this._id+"_button",this._labelId=this._id+"_label",this._isEnabled=e.isCheckerCommandEnabled,this._onStateChanged=e.onCheckerCommandStateChanged,this._enabledLabel=e.enabledLabel,this._disabledLabel=e.disabledLabel,{template:'\n\t\t\t<div class="pillToggleContainer" id="'+this._id+'">\n\t\t\t\t<button id="'+this._buttonId+'" class="pillButton type="button" role="switch">\n\t\t\t\t\t<span class="thumb"></span>\n\t\t\t\t</button>\n\t\t\t\t<span id="'+this._labelId+'" class="pillLabel"></span>\n\t\t\t</div>\n\t\t',outputProps:void 0}},t.prototype.onMounted=function(){u.default.queryById(this._id).addEventListener("click",this._onClicked),this._updateUIState()},t.prototype._updateUIState=function(){var e=u.default.queryById(this._buttonId);this._isEnabled?e.classList.add("pill-enabled"):e.classList.remove("pill-enabled");var t=this._isEnabled?this._enabledLabel:this._disabledLabel;u.default.queryById(this._labelId).innerText=t},t}(l);t.AppcheckerToggleControl=m;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){var t=e.description?"":" hidden";return{template:'\n\t\t\t<div class="appchecker-section-container"'+(e.id?' id="'+e.id+'"':"")+">\n\t\t\t\t<h3>"+e.title+'</h3>\n\t\t\t\t<div class="appchecker-section-description'+t+'">\n\t\t\t\t\t'+(e.description||"")+'\n\t\t\t\t</div>\n\t\t\t\t<div class="appchecker-section-content">\n\t\t\t\t\t'+e.content+"\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t",outputProps:e}},t}(l);t.AppcheckerSectionContainer=v;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){return{template:-1===["",null,void 0].indexOf(e.value)?'\n\t\t\t<div class="appchecker-env-detail">\n\t\t\t\t<div class="appchecker-env-detail-label">'+e.label+'</div>\n\t\t\t\t<div class="appchecker-env-detail-value">'+e.value+"</div>\n\t\t\t</div>\n\t\t":"",outputProps:void 0}},t}(l);t.AppcheckerEnvDetail=g;var E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){return{template:'\n\t\t\t<div class="appchecker-statusline">\n\t\t\t\t<div class="appchecker-statusline-label">'+e.label+'</div>\n\t\t\t\t<div class="appchecker-statusline-state">'+e.value+" "+e.helpLink+"</div>\n\t\t\t</div>\n\t\t",outputProps:void 0}},t}(l);t.AppcheckerRowWithHelplink=E;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){var t=e.diagResult||{},r=t.helpLink?"<div class=\"appchecker-statusline-state-helpLink\">\n\t\t\t\t<a target='_blank' href='"+t.helpLink+"'>Go to solution</a>\n\t\t\t</div>":"",o=e.detailsLink&&t.state===n.DiagCheckState.Failed?'<div class="appchecker-statusline-state-helpLink">\n\t\t\t\t<a href=\''+e.detailsLink+"'>Go to details</a>\n\t\t\t</div>":"";return{template:'\n\t\t\t<div class="appchecker-statusline">\n\t\t\t\t<div class="appchecker-statusline-label">'+e.label+'</div>\n\t\t\t\t<div class="appchecker-statusline-state">\n\t\t\t\t\t<div class="appchecker-statusline-state-value">\n\t\t\t\t\t\t'+this._getStateName(t.state)+"\n\t\t\t\t\t</div>\n\t\t\t\t\t"+r+"\n\t\t\t\t\t"+o+"\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t",outputProps:void 0}},t.prototype._getStateName=function(e){if("string"==typeof e)return e;switch(e){case n.DiagCheckState.Passed:return"Passed";case n.DiagCheckState.Failed:return"Failed";case n.DiagCheckState.Unknown:default:return"Unknown"}},t}(l);t.AppcheckerCheckDetail=y;var C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){var t={OrgId:{label:"Org Id",value:e.orgId},OrgUrl:{label:"Org URL",value:"<a target='_blank' href='"+e.orgUrl+"'>"+e.orgUrl+"</a>"},SessionId:{label:"Session Id",value:e.sessionId},OutlookEmail:{label:"Outlook Email",value:e.outlookEmailAddress},D365Email:{label:"D365 Email",value:e.d365EmailAddress},MailboxId:{label:"Mailbox Id",value:e.mailboxUrl&&e.mailboxId?"<a target='_blank' href='"+e.mailboxUrl+"'>"+e.mailboxId+"</a>":e.mailboxId},Deployment:{label:"CRM/Exchange",value:e.crmDeploymentEnvironment+"/"+e.exchangeDeploymentEnvironment},Outlook:{label:"Outlook",value:e.hostName+"@"+e.hostVersion},DisplayMode:{label:"Display Mode",value:e.displayMode},DelegatedMailbox:{label:"Delegated Mailbox",value:e.isDelegatedMailbox},Browser:{label:"Browser",value:e.browser},CurrentDate:{label:"CurrentDate:",value:e.currentDate}};return{template:'\n\t\t\t<AppcheckerSectionContainer props="container">\n\t\t\t\t<div class="appchecker-env-details-container">\n\t\t\t\t\t<AppcheckerEnvDetail props="OrgId"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="OrgUrl"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="SessionId"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="OutlookEmail"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="D365Email"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="MailboxId"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="Deployment"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="Outlook"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="DisplayMode"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="DelegatedMailbox"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="Browser"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="CurrentDate"/>\n\t\t\t\t</div>\n\t\t\t</AppcheckerSectionContainer>\n\t\t',outputProps:s({container:{title:"Environment",description:"Details of various environmental variables used by App for Outlook."}},t)}},t}(l);t.AppcheckerEnvironmentSection=C;var I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){var t={MailboxItemId:{label:"Id",value:e.mailboxItemId},MailboxItemType:{label:"Type",value:e.mailboxItemType},MessageId:{label:"Message Id",value:e.messageId},CrmId:{label:"Crm Id",value:e.crmId&&e.recordUrl?"<a target='_blank' href='"+e.recordUrl+"'>"+e.crmId+"</a>":e.crmId},TrackingState:{label:"Tracking State",value:e.trackingState},TrackedFromMailApp:{label:"Tracked From MailApp",value:e.trackedFromMailApp},TrackedDate:{label:"Tracked Date",value:e.trackedDate},CreatedDate:{label:"Created Date",value:e.createdDate},ModifiedDate:{label:"Modified Date",value:e.modifiedDate},SentDate:{label:"Sent Date",value:e.sentDate},HasD365Category:{label:"Has D365 Category",value:e.hasD365Category},HasAttachments:{label:"Has Attachments",value:e.hasAttachments},AttachmentCount:{label:"Attachment Count",value:e.attachmentCount}};return{template:'\n\t\t\t<AppcheckerSectionContainer props="container">\n\t\t\t\t<div class="appchecker-env-details-container">\n\t\t\t\t\t<AppcheckerEnvDetail props="MailboxItemId"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="MailboxItemType"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="MessageId"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="CrmId"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="TrackingState"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="TrackedFromMailApp"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="TrackedDate"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="CreatedDate"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="ModifiedDate"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="SentDate"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="HasD365Category"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="HasAttachments"/>\n\t\t\t\t\t<AppcheckerEnvDetail props="AttachmentCount"/>\n\t\t\t\t</div>\n\t\t\t</AppcheckerSectionContainer>\n\t\t',outputProps:s({container:{title:"Mailbox Item",description:"Details of the mail item that is currently selected in Outlook."}},t)}},t}(l);t.AppcheckerMailboxItemSection=I;var P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){var t=this,r=e.componentsStates.reduce((function(r,n){return r[n.componentName]={label:n.componentName,value:t._getStateName(n.state),helpLink:t._getHelpLink(n.componentName,n.state,e.orgId,e.sessionId)},r}),{});return{template:'\n\t\t\t<AppcheckerSectionContainer props="container">\n\t\t\t\t<div class="appchecker-boot-status">\n\t\t\t\t\t'+e.componentsStates.reduce((function(e,t){return e+='\n\t\t\t\t<AppcheckerRowWithHelplink props="'+t.componentName+'"/>\n\t\t\t'}),"")+"\n\t\t\t\t</div>\n\t\t\t</AppcheckerSectionContainer>\n\t\t",outputProps:s({container:{title:"Boot sequence",description:"Detailed status of each boot component, and relevant help or solutions for failed component loads."}},r)}},t.prototype._getHelpLink=function(e,t,n,o){return t===r.ComponentLoadingState.Failed?"<a target='_blank' href='http://go.microsoft.com/fwlink/?LinkID=398563&client=MailApp&error=BootComponent:"+e+"&oid="+n+"&cid="+o+"'>Help</a>":""},t.prototype._getStateName=function(e){switch(e){case r.ComponentLoadingState.None:return"None";case r.ComponentLoadingState.WaitingForDependencies:return"Awaiting dependencies...";case r.ComponentLoadingState.Loading:return"Loading...";case r.ComponentLoadingState.Loaded:return"Loaded";case r.ComponentLoadingState.Failed:default:return"Failed"}},t}(l);t.AppcheckerBootSection=P;var T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){var t=this,r=e.privilegesConfig.filter((function(e){return e.status===n.PrivilegeStatus.Missing})),i=r.reduce((function(e,r){return e[r.privilegeName]={label:r.privilegeName,value:t._getStatusName(r.status),helpLink:""},e}),{}),a=r.map((function(e){return'<AppcheckerRowWithHelplink props="'+e.privilegeName+'"/>'})).join("\r\n"),u="<a target='_blank' href="+e.helpLink+">Learn more</a>",c=s({container:{id:o.UIIdentifierNames.appcheckerSectionPrivileges,title:"Permissions",description:"Details of the missing privileges needed for Dynamics 365 App for Outlook to function properly. "+u+"."}},i);return{template:r.length?'<hr class="appchecker-divider">\n\t\t\t<AppcheckerSectionContainer props="container">\n\t\t\t\t<div class="appchecker-boot-status">\n\t\t\t\t\t'+a+"\n\t\t\t\t</div>\n\t\t\t\t</AppcheckerSectionContainer>":"",outputProps:c}},t.prototype._getStatusName=function(e){switch(e){case n.PrivilegeStatus.Present:return"Present";case n.PrivilegeStatus.Missing:return"Missing";case n.PrivilegeStatus.Unknown:default:return"Unknown"}},t}(l);t.AppcheckerPrivilegesSection=T;var A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){var t,r,n=null===(t=e.list)||void 0===t?void 0:t.map((function(e){return'<li class="appchecker-statusline-label"><span>'+e+"</span></li>"})).join(""),o=e.helpLink?" <a target='_blank' href="+e.helpLink+">Learn more</a>.":"",i={container:{id:e.id,title:e.title,description:""+e.description+o}};return{template:(null===(r=e.list)||void 0===r?void 0:r.length)?'\n\t\t\t<hr class="appchecker-divider">\n\t\t\t<AppcheckerSectionContainer props="container">\n\t\t\t\t<ul>\n\t\t\t\t\t'+n+"\n\t\t\t\t</ul>\n\t\t\t</AppcheckerSectionContainer>\n\t\t":"",outputProps:i}},t}(l);t.AppcheckerListSection=A;var R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){var t,r,n,i,a,s;return{template:'\n\t\t\t<AppcheckerSectionContainer props="container">\n\t\t\t\t<div class="appchecker-diagnostics-checks">\n\t\t\t\t\t<AppcheckerCheckDetail props="localStorage"/>\n\t\t\t\t\t<AppcheckerCheckDetail props="mailboxTestStatus"/>\n\t\t\t\t\t<AppcheckerCheckDetail props="appModuleAccess"/>\n\t\t\t\t\t<AppcheckerCheckDetail props="userEmailAddress"/>\n\t\t\t\t\t<AppcheckerCheckDetail props="privilegesConfig"/>\n\t\t\t\t\t<AppcheckerCheckDetail props="deactivatedViews"/>\n\t\t\t\t\t<AppcheckerCheckDetail props="dashboard"/>\n\t\t\t\t</div>\n\t\t\t</AppcheckerSectionContainer>\n\t\t',outputProps:{container:{title:"Diagnostics Checks",description:"Detailed status of various components and relevant help for failed components."},localStorage:{label:"Local storage",diagResult:{label:"LocalStorage",state:e.isStorageValid?"Passed":"Failed"}},mailboxTestStatus:{label:"Mailbox Test Status",diagResult:null===(t=e.diagResults)||void 0===t?void 0:t.VerifyMailboxTestStatus},appModuleAccess:{label:"App Module Access",diagResult:null===(r=e.diagResults)||void 0===r?void 0:r.VerifyAppModuleAccess},userEmailAddress:{label:"User Email Address",diagResult:null===(n=e.diagResults)||void 0===n?void 0:n.VerifyUserEmailAddress},privilegesConfig:{label:"Permissions",diagResult:null===(i=e.diagResults)||void 0===i?void 0:i.VerifyPrivilegesConfig,detailsLink:"#"+o.UIIdentifierNames.appcheckerSectionPrivileges},deactivatedViews:{label:"Views",diagResult:null===(a=e.diagResults)||void 0===a?void 0:a.VerifyDeactivatedViews,detailsLink:"#"+o.UIIdentifierNames.appcheckerSectionViews},dashboard:{label:"Dashboard",diagResult:null===(s=e.diagResults)||void 0===s?void 0:s.VerifyDashboardSummary,detailsLink:"#"+o.UIIdentifierNames.appcheckerSectionDashboard}}}},t}(l);t.AppcheckerDiagChecksSection=R;var S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){var t=e.helpLink?"<div><a target='_blank' href="+e.helpLink+">Help</a></div>":"";return{template:e.errorTitle||e.errorInfo?'\n\t\t\t<AppcheckerSectionContainer props="container">\n\t\t\t\t<div class="appchecker-error-details">\n\t\t\t\t\t<div>'+(e.errorTitle||"")+"</div>\n\t\t\t\t\t<p>"+(e.errorMessage||"")+'</p>\n\t\t\t\t\t<p class="appchecker-error-info">'+(e.errorInfo||"")+"</p>\n\t\t\t\t\t"+t+'\n\t\t\t\t</div>\n\t\t\t</AppcheckerSectionContainer>\n\t\t\t<hr class="appchecker-divider">\n\t\t':"",outputProps:{container:{title:"Error details",description:"Details of the previously encountered error. Export the logs and share with your administrator."}}}},t}(l);t.AppcheckerErrorDetailsSection=S;var O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){var t="This will clear any errors in the App for Outlook cache. \nCache will be rebuilt upon next login automatically.";return{template:'\n\t\t\t<div class="appchecker-toolbar">\n\t\t\t\t<div class="appchecker-toolbar-button svgIcon download" id="'+o.UIIdentifierNames.appcheckerDownloadLogs+'" role="button" title="Export logs" aria-label="Export logs"></div>\n\t\t\t\t<div class="appchecker-toolbar-button svgIcon clear" id="'+o.UIIdentifierNames.appcheckerClearStorage+'" role="button" title="'+t+'" aria-label="'+t+'"></div>\n\t\t\t</div>\n\t\t',outputProps:void 0}},t}(l);t.AppcheckerToolbar=O;var b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(e){var t,r,n,a,s,u,c;return{template:'\n\t\t\t<AppcheckerContainer props="content">\n\t\t\t\t<AppcheckerToolbar />\n\t\t\t\t<div class="appchecker-main">\n\t\t\t\t\t<AppcheckerErrorDetailsSection props="errorProps" />\n\t\t\t\t\t<AppcheckerEnvironmentSection props="environment"/>\n\t\t\t\t\t<hr class="appchecker-divider">\n\t\t\t\t\t<AppcheckerMailboxItemSection props="mailboxItem"/>\n\t\t\t\t\t<hr class="appchecker-divider">\n\t\t\t\t\t<AppcheckerDiagChecksSection props="diagchecks"/>\n\t\t\t\t\t<AppcheckerPrivilegesSection props="privileges"/>\n\t\t\t\t\t<AppcheckerListSection props="views"/>\n\t\t\t\t\t<AppcheckerListSection props="dashboard"/>\n\t\t\t\t\t<hr class="appchecker-divider">\n\t\t\t\t\t<AppcheckerBootSection props="components"/>\n\t\t\t\t</div>\n\t\t\t</AppcheckerContainer>\n\t\t',outputProps:{content:{title:"Diagnostics",isBackHidden:!1},environment:e.environment,mailboxItem:e.mailboxItem,components:e.components,privileges:e.privileges,views:{id:o.UIIdentifierNames.appcheckerSectionViews,title:"Views",description:"List of deactivated views used in the Dynamics 365 App for Outlook.",helpLink:i.HelpLinks.ViewDeactivated,list:(null===(a=null===(n=null===(r=null===(t=e.diagchecks)||void 0===t?void 0:t.diagResults)||void 0===r?void 0:r.VerifyDeactivatedViews)||void 0===n?void 0:n.views)||void 0===a?void 0:a.map((function(e){return e.name})))||[]},diagchecks:e.diagchecks,errorProps:e.errorProps,dashboard:{id:o.UIIdentifierNames.appcheckerSectionDashboard,title:"Dashboard",description:"List of configuration issues related to the Dynamics 365 App for Outlook dashboard.",helpLink:i.HelpLinks.Dashboard,list:(null===(c=null===(u=null===(s=e.diagchecks)||void 0===s?void 0:s.diagResults)||void 0===u?void 0:u.VerifyDashboardSummary)||void 0===c?void 0:c.validationMessages)||[]}}}},t}(l);t.AppcheckerDiagnosticsPage=b}.apply(t,n))||(e.exports=o)}]);
//# sourceMappingURL=NonShip/shim.js.map