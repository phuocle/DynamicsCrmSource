(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/offlinets.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[24],{"5ZTD":function(e,t,r){"use strict";r.d(t,"h",(function(){return ue})),r.d(t,"f",(function(){return de})),r.d(t,"g",(function(){return pe})),r.d(t,"a",(function(){return fe})),r.d(t,"c",(function(){return me})),r.d(t,"i",(function(){return ge})),r.d(t,"d",(function(){return he})),r.d(t,"e",(function(){return be})),r.d(t,"b",(function(){return Oe}));var n,a,i=r("4ciL"),o=r("Nt68");!function(e){e.BooleanType="boolean",e.NullableType="nullable",e.IntegerType="integer",e.Int64Type="int64",e.FloatType="float",e.TimeType="time",e.ShortTimeType="shorttime",e.ShortDateType="shortdate",e.DateMonthType="datemonth",e.CurrencyType="currency",e.DecimalType="decimal",e.StringType="string"}(n||(n={})),function(e){e.SystemUser="systemuser",e.ModifiedOn="modifiedon",e.CreatedOn="createdon",e.ModifiedBy="modifiedby",e.CreatedBy="createdby",e.StateCode="statecode",e.StatusCode="statuscode",e.OwnerId="ownerid"}(a||(a={}));var s,l=r("Xd5/"),c=r("SAYH"),_=r("504W"),u=r("Nzmy"),d=r("+5Bq");!function(e){e.EqualOperator="Equal",e.NotEqualOperator="NotEqual",e.GreaterThanOperator="GreaterThan",e.GreaterThanOrEqualOperator="GreaterThanOrEqual",e.LessThanOperator="LessThan",e.LessThanOrEqualOperator="LessThanOrEqual",e.AndOperator="And"}(s||(s={}));var p=r("MXaZ"),f=r("SoYb"),m=r("FZk4"),g=r("3fL6"),h=r("JUjK"),b=r("lR0U");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const S={parseValue:O,addAttributesInValues:function(e,t,r){const n={};return e.forEach(e=>{const r=!!f.a(e.IsResettable);let a=S.parseValue(t,e.Value,r);(a||null===a&&r)&&(a instanceof c.a&&(a=c.a.toString(a)),n[e.Field]=a)}),n},addAttributesFromSource:function(e,t){const r={};if(e){const n=S.parseValue(t,e);for(const e in n){const t=n[e];t&&t.hasOwnProperty("id")?(r[e+"!id"]=t.id,r[e+"!name"]=t.name,r[e+"!logicalname"]=t.entityType):r[e]=t}}return r},addDefaultAttributes:function(e,t){let r={};t&&t.userId&&t.userDisplayName&&(r=Object.assign(S.setOwnerId(a.OwnerId,t),S.setOwnerId(a.CreatedBy,t),S.setOwnerId(a.ModifiedBy,t)));return r[a.CreatedOn]=y(new Date),r[a.ModifiedOn]=y(new Date),r[a.StateCode]=0,r[a.StatusCode]=1,r},setOwnerId:function(e,t){const r={},n=Object(b.a)(e,"owner");return r[n[0]]=c.a.toString(t.userId),r[n[1]]="systemuser",r[n[2]]=t.userDisplayName,r},getEntityName:function(e,t){if(!t)return null;const r=S.parseValue(e,t);return r?r.toString():null},getConditionResult:function(e,t,r,a,i){switch(a){case n.BooleanType:return t===s.AndOperator?e&&f.a(r):S.getConditionValue(e,t,f.a(r));case n.NullableType:return t===s.EqualOperator?Object(_.a)(e):t===s.NotEqualOperator&&!Object(_.a)(e);case n.IntegerType:return S.getConditionValue(e,t,f.b(r));case n.Int64Type:case n.FloatType:case n.DecimalType:return S.getConditionValue(e,t,f.c(r));case n.TimeType:return S.getConditionValue(e,t,f.d(r));case n.ShortTimeType:case n.ShortDateType:const a=Object(p.k)(r);return t===s.EqualOperator?!!r&&e.getTime()===a.getTime():t===s.NotEqualOperator?!r||e.getTime()!==a.getTime():S.getConditionValue(e,t,a);case n.CurrencyType:const{formatInfoCultureName:o,numberFormatInfo:c,dateFormatInfo:u}=i.userSettings,d=new Sys.CultureInfo(o,c,u);return S.getConditionValue(e,t,Object(l.D)(r,{controlAttributes:{Type:"money"}},d,""));case n.StringType:return S.getConditionValue(e,t,r);default:return!1}},getConditionValue:function(e,t,r){switch(t){case s.GreaterThanOperator:return e>r;case s.GreaterThanOrEqualOperator:return e>=r;case s.LessThanOperator:return e<r;case s.LessThanOrEqualOperator:return e<=r;case s.EqualOperator:return e===r;case s.NotEqualOperator:return e!==r;default:return!1}},getAndOrConditions:function(e,t,r){return e.map(e=>{if(e.LeftOperand&&e.RightOperand)return S.getConditionResult(O(t,e.LeftOperand),e.Operator,O(t,e.RightOperand),e.Type,r)}).filter(e=>!Object(_.a)(e))},createFilterCriteria:function(e,t,r,n,a){if(!(e&&t&&r&&n))throw new Error("Name, Value, OperatorType and Conditiontype must have a value provided.");const i=r===s.AndOperator?g.a.And:g.a.Or;let o=O(a,t);!o||o instanceof c.a||(o=c.a.tryParse(o.toString()));o=c.a.toString(o);let l=h.a.Equals;switch(n){case s.EqualOperator:l=h.a.Equals;break;case s.GreaterThanOperator:l=h.a.GreaterThan;break;case s.GreaterThanOrEqualOperator:l=h.a.GreaterThanEqualTo;break;case s.LessThanOperator:l=h.a.LessThan;break;case s.LessThanOrEqualOperator:l=h.a.LessThanEqualTo;break;case s.NotEqualOperator:l=h.a.NotEquals}return new m.a(e,o,i,l)},getReferenceValue:function(e,t){const{key:r,path:n}=C(e);let a;t&&t.has(r)&&(a=t.get(r),E(a)&&(a=a.rows.item(0)),a=S.getObjectFromMap(n,a));return a},getReferenceValueLength:function(e,t){const{key:r}=C(e);if(t&&t.has(r)){const e=t.get(r);if(E(e))return e.rows.length}return 1},getObjectFromMap:function(e,t){return e.forEach(e=>{t=t&&t.hasOwnProperty(e)?t[e]:void 0}),t}};function O(e,t,r=!1){if(!t){if(r)return t;throw new TypeError("Xml attribute param to parse must have a value provided")}let n=null;switch(t){case o.a.DateTimeNowString:n=y(new Date).trim();break;case o.a.OppCloseDateString:const r=S.getReferenceValue(t,e);if(r){n=y(new Date(r.toString())).trim()}break;default:if(t.startsWith(o.a.NegatedReference)){t=t.substr(o.a.FirstIndex,t.length);const r=S.getReferenceValue(t,e);Object(_.a)(r)||(n=!Object(d.a)(r.toString()))}else n=t.startsWith(o.a.Reference)?S.getReferenceValue(t,e):t===o.a.NullString?null:t}return r||(n=void 0===n?null:n),u.c.info(`CommandStepsCommon: ParseValue: Parsed ${t} to ${n?n.toString():null}`),n}function y(e){return e.toISOString().replace(/T|Z/g," ")}function E(e){return e&&e.hasOwnProperty("rows")}function C(e){const t=e.split(o.a.DotSeperator);return{key:t[0].slice(1),path:t.slice(1)}}var T=r("Uv1Y"),N=r("TBkx"),A=r("iZ7K"),v=r("iF9X"),D=r("Q7Xa"),F=r("TRNQ"),P=r("thzq"),I=r("2LZB"),x=r("3ri3");class L{constructor(e,t,r,n){this._Id=null,this._CommandId=null,this._EntityName=null,this._Operation=0,this._set_id(e),this._set_commandId(t),this.set_entityName(r),this.set_operation(n)}get_id(){return this._Id}_set_id(e){return this._Id=e,e}get_commandId(){return this._CommandId}_set_commandId(e){return this._CommandId=e,e}get_entityName(){return this._EntityName}set_entityName(e){return this._EntityName=e,e}get_operation(){return this._Operation}set_operation(e){return this._Operation=e,e}toDictionary(){const e={};return e[x.k]=this.get_id(),e[x.i]=this.get_commandId(),e[x.j]=this.get_entityName(),e[x.l]=this.get_operation(),e}}var R=r("7tM0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const w={processCreateStep:function(e,t,r,n,a,i){if(e.EntityName){return(new F.a).generateUID().nativePromise().then(s=>{u.c.info("OFFLINE: CommandStepProcessor: processCreateStep: creating "+e.EntityName+" with Id "+s+" for "+e.OperationName+".");const l=S.getEntityName(t,e.EntityName),_=l+o.a.Id,d=e.Attribute.find(e=>e.Field===_);d&&(d.Value===o.a.GuidString?d.Value=c.a.toString(c.a.fromLegacyGuid(s)):d.Value=S.parseValue(t,d.Value));const p=Object.assign(S.addDefaultAttributes(e.EntityName,i),S.addAttributesFromSource(e.Source,t),S.addAttributesInValues(e.Attribute,t));return r.push(new D.a(p,P.a.Create,l)),t.set(e.Result.Name,{entityType:l,id:c.a.tryParse(p[l+o.a.Id])}),d&&(n[_]=d.Value),u.c.info("OFFLINE: CommandStepProcessor: processCreateStep: Creating command entity operation for "+e.EntityName),w.createCommandEntityOperation(a,e.EntityName,1)}).catch(e=>(u.c.error("OFFLINE: CommandStepProcessor: processCreateStep: failed generating UID with error for :"+Object(N.e)(e)),Object(T.b)(e)))}return u.c.error("OFFLINE: CommandStepProcessor: processCreateStep: failed because entity name is null or an empty string in operation for commandId as "+a+" ."),Promise.reject(new T.a("Entity Name is null/empty string in operation."))},processUpdateStep:function(e,t,r,n,a){if(!(e.Attribute&&e.Identifier&&e.Result&&e.EntityName))return u.c.error("OFFLINE: CommandStepProcessor: processUpdateStep: Attribute/Identifier/Result/EntityName is not defined in the operation"),Promise.reject(new T.a("Attribute/Identifier/Result/EntityName is not defined in the operation"));const i=S.getEntityName(t,e.EntityName),s=Object.assign(S.addAttributesFromSource(e.Source,t),S.addAttributesInValues(e.Attribute,t)),l=S.parseValue(t,e.Identifier.Value);s[e.Identifier.Name]=!l||l instanceof c.a?l:c.a.toString(c.a.tryParse(l.toString())),r.push(new D.a(s,P.a.Update,i));let _=i;const d=Object(A.h)(a,i);if(d&&d.IsBPFEntity&&Object(v.g)(a))return Promise.resolve(null);d&&d.IsBPFEntity?_=o.a.BusinessProcessFlowInstance:d&&d.IsActivity&&(_=o.a.ActivityString);const p=null!==s[_+o.a.Id]?s[_+o.a.Id].toString():null;if(!p)return u.c.error("OFFLINE: CommandStepProcessor: processUpdateStep: Failed to parse entityid: "+p+o.a.Id),Promise.reject(new T.a("Failed to parse entityid: "+p+o.a.Id));return t.set(e.Result.Name,{entityType:i,id:c.a.tryParse(p)}),u.c.info("OFFLINE: CommandStepProcessor: processUpdateStep: Creating command entity operation for "+e.EntityName),w.createCommandEntityOperation(n,i,3)},processDeleteStep:function(e,t,r,n){if(!e.Attribute||!e.EntityName)return u.c.error("OFFLINE: CommandStepProcessor: processDeleteStep: Attribute/EntityName is not defined in the operation"),Promise.reject(new T.a("Attribute/EntityName is not defined in the operation"));return r.push(new D.a(S.addAttributesInValues(e.Attribute,t),P.a.Delete,S.getEntityName(t,e.EntityName))),u.c.info("OFFLINE: CommandStepProcessor: processDeleteStep: Creating command entity operation for "+e.EntityName),w.createCommandEntityOperation(n,e.EntityName,2)},processRetrieveStep:function(e,t){if(!e.MultipleCheck||!e.Result||!e.EntityName)return u.c.error("OFFLINE: CommandStepProcessor: processRetrieveStep: Attribute/MultipleCheck/Result/EntityName is not defined in the operation"),Promise.reject(new T.a("Identifier/Result/EntityName is not defined in the operation"));const r=new Array;e.MultipleCheck.forEach(e=>{e.Condition.forEach(e=>{r.push(S.createFilterCriteria(e.LeftOperand,e.RightOperand,e.Type,e.Operator,t))})});const n=new I.a(r),a=new F.a,i=S.getEntityName(t,e.EntityName);return a.retrieve(i,n).nativePromise().then(r=>(t.set(e.Result.Name,r),u.c.info("OFFLINE: CommandStepProcessor: processRetrieveStep: Succeeded resolving the promise with true"),null)).catch(e=>{u.c.error("OFFLINE: CommandStepProcessor: processRetrieveStep: Failed with error: "+Object(N.e)(e)),Object(T.b)(e)})},processConditionCheckStep:function(e,t,r){if(e.MultipleCheck&&0!==Object.keys(e.MultipleCheck).length){const n=[],a=[];let i=!1;u.c.info("OFFLINE: CommandStepProcessor: processConditionCheckStep:  Processing Multiple check for opertion."),e.MultipleCheck.forEach(e=>{if(u.c.info("OFFLINE: CommandStepProcessor: processConditionCheckStep: Processing Multiple check with Multiple Check "+e.Type+" for Condition opertion."),e.Type===s.AndOperator){const a=S.getAndOrConditions(e.Condition,t,r);n.push(...a)}else{const n=S.getAndOrConditions(e.Condition,t,r);a.push(...n)}});const o=e=>!(e.indexOf(!1)>-1),l=e=>e.indexOf(!0)>-1;return n.length>0&&a.length>0?i=l(a)&&o(n):n.length>0?i=o(n):a.length>0&&(i=l(a)),u.c.info("OFFLINE: CommandStepProcessor: processConditionCheckStep setting "+e.Result.Name+" to:"+i),t.set(e.Result.Name,i),Promise.resolve(null)}return u.c.error("OFFLINE: CommandStepProcessor: processConditionCheckStep failed : MultipleCheck is not defined in operation."),Promise.reject(new T.a("MultipleCheck is not defined in operation."))},processSetValueStep:function(e,t){if(e.Result)return t.set(e.Result.Name,S.parseValue(t,e.Result.Value)),u.c.info("OFFLINE: CommandStepProcessor: processSetValueStep setting "+e.Result.Name+" to: "+t.get(e.Result.Name)),Promise.resolve(null);return u.c.error("OFFLINE: CommandStepProcessor: processSetValueStep failed : Result is not defined in operation."),Promise.reject(new T.a("Result is not defined in operation."))},processFailureStep:function(e,t,r){if(e.Message){let n=null;if(e.Message.WebResourceName){const t=Object(R.b)(r,e.Message.WebResourceName);n=t?t[e.Message.Key]:e.Message.Key}return n?Promise.reject(new T.a(S.parseValue(t,n),-2147220891)):(u.c.error("OFFLINE: CommandStepProcessor: processSetValueStep failed : No Message is defined in operation."),Promise.reject(new T.a("Message not defined in operation.")))}return u.c.error("OFFLINE: CommandStepProcessor: processSetValueStep failed : Messages is not defined in operation."),Promise.reject(new T.a("Messages is not defined in operation."))},createCommandEntityOperation:function(e,t,r){return(new F.a).generateUID().nativePromise().then(n=>(u.c.info("OFFLINE: CommandStepProcessor: createCommandEntityOperation: Successfully created command entity operation for "+t),new D.a(new L(n,e,t,r).toDictionary(),P.a.Create,o.a.CommandOperationString))).catch(e=>(u.c.error("OFFLINE: CommandStepProcessor: createCommandEntityOperation: Failed in creating command entity operation because of generate UID failure with error "+Object(N.e)(e)),Object(T.b)(e)))}};var M=r("zAhX"),j=r("LTmj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const k={executeCommand:function(e,t,r,n,a){return B(e,t,r,n,a).then(e=>(u.c.info("OFFLINE: CommandExecutionEngine: executeCommand: Initializing the process to create batch and perform operations."),k.createBatchAndPerformOperations(t,r,e.entityOperations,e.offlineData,e.commandEntities,e.commandId,a))).then(e=>(u.c.info("OFFLINE: CommandExecutionEngine: executeCommand: resolving promise with EntityOperations."),e)).catch(r=>{const n=r.get_Message?new T.a(r.get_Message()):r,i=Object(A.h)(a,e)?Object(A.h)(a,e).Id:null;throw u.c.error("OFFLINE: CommandExecutionEngine: executeCommand: failed with error: "+n.message+" for entity: "+i+" and command: "+t),n})},prepareCommandQueries:function(e,t,r,n,a){return B(e,t,r,n,a).then(e=>(u.c.info("OFFLINE: CommandExecutionEngine: prepareCommandQueries: Initializing the process to create batch and perform operations."),k.createBatch(t,r,e.entityOperations,e.offlineData,e.commandEntities,e.commandId,a))).then(e=>(u.c.info("OFFLINE: CommandExecutionEngine: prepareCommandQueries: resolving promise with EntityOperations."),e)).catch(r=>{const n=r.get_Message?new T.a(r.get_Message()):r,i=Object(A.h)(a,e)?Object(A.h)(a,e).Id:null;throw u.c.error("OFFLINE: CommandExecutionEngine: prepareCommandQueries: failed with error: "+n.message+" for entity: "+i+" and command: "+t),n})},processOperationsSequentially:function(e,t,r,n,a,i){if(e&&0===e.length||t&&0===t.size||Object(_.a)(r)||Object(_.a)(n))return Promise.reject(new T.a("Either operations/updatedMembers is empty or entityOperations/offlineData is null. Invalid input arguments passed."));u.c.info("OFFLINE: CommandExecutionEngine: processOperationsSequentially : Processing each operation sequentially");let o=Promise.resolve([]);return e.forEach(e=>{u.c.info("OFFLINE: CommandExecutionEngine: processOperationsSequentially : processing operation : "+e.OperationName),o=o.then(o=>(e=>{const o=S.parseValue(t,e.IsExecutable);if(o&&Object(f.a)(o.toString()))return u.c.info("OFFLINE: CommandExecutionEngine: processOperationsSequentially : processOperation: executing operation : "+e.OperationName),k.processCommandStep(e,t,r,n,a,i);return Promise.resolve(null)})(e).then(t=>(t&&(u.c.info("OFFLINE: CommandExecutionEngine: processOperationsSequentially : adding command entity operation : "+e.OperationName),o.push(t)),o)).catch(t=>{if(u.c.error("OFFLINE: CommandExecutionEngine: processOperationsSequentially : processing operation : "+e.OperationName+" failed with error: "+Object(N.e)(t)),-2147220891===t.getNegativeErrorCode())return Promise.reject(t);const r=Object(A.h)(i,e.EntityName)?Object(A.h)(i,e.EntityName).Id:null;return Promise.reject(new T.a(`Processing of operation ${e.OperationName} for entityId ${r} failed with error: ${t.message}`))}))}),o},processCommandStep:function(e,t,r,n,a,i){switch(e.OperationName){case o.a.CreateStep:return w.processCreateStep(e,t,r,n,a,i.user);case o.a.RetrieveStep:return w.processRetrieveStep(e,t);case o.a.UpdateStep:return w.processUpdateStep(e,t,r,a,i);case o.a.DeleteStep:return w.processDeleteStep(e,t,r,a);case o.a.SetValueStep:return w.processSetValueStep(e,t);case o.a.ConditionStep:return w.processConditionCheckStep(e,t,i.user);case o.a.FailureStep:return w.processFailureStep(e,t,i)}},createBatchAndPerformOperations:function(e,t,r,n,a,i,o){const s=W(e,t,r,n,a,i,o);if(s)return Promise.reject(s);const l=new F.a;return u.c.info("OFFLINE: CommandExecutionEngine: createBatchAndPerformOperations: Initiating performing of operations."),l.performOperations(r,a,!1).nativePromise().then(e=>r).catch(e=>(u.c.info("OFFLINE: CommandExecutionEngine: createBatchAndPerformOperations: entityOperations: Failed"+Object(N.e)(e)),Object(T.b)(e)))},createBatch:function(e,t,r,n,a,i,o){const s=W(e,t,r,n,a,i,o);if(s)return Promise.reject(s);const l=new F.a;return u.c.info("OFFLINE: CommandExecutionEngine: createBatch: Initiating performing of operations."),l.prepareOperations(r,a,!1).nativePromise().then(e=>e).catch(e=>(u.c.info("OFFLINE: CommandExecutionEngine: createBatch: entityOperations: Failed"+Object(N.e)(e)),Object(T.b)(e)))},createCommand:V,prepareCommandOperation:W};function B(e,t,r,n,a){if(!e||!t||r&&0===Object.keys(r).length||!n)return Promise.reject(new T.a("CommandExecutionEngine _prepareCommandQueries failed due to empty/invalid inputs."));u.c.info("OFFLINE: CommandExecutionEngine: _prepareCommandQueries: Initializing the execution of the command operations corresponding to entityLogicalName as "+e+" and commandName as "+t+" .");const i=[],o=n.CommandRequestData,s={},l=new F.a;return u.c.info("OFFLINE: CommandExecutionEngine: _prepareCommandQueries: Creating a new guid."),l.generateUID().nativePromise().then(e=>(u.c.info("OFFLINE: CommandExecutionEngine: _prepareCommandQueries: Initiating the processing of operations sequentially."),k.processOperationsSequentially(n.Operations,o,i,s,e,a).then(t=>({commandId:e,commandEntities:t,entityOperations:i,offlineData:s}))))}function W(e,t,r,n,a,i,o){return 0===r.length||0===a.length?(u.c.error("OFFLINE: CommandExecutionEngine: prepareCommandOperation: failed because entityOperations or commandEntities are null."),new T.a("Operation could not be performed at the moment. Please try again.")):(a.unshift(V(e,t,n,i,o)),null)}function V(e,t,r,n,a){const s=Object(i.a)(a,t);return s.additionalHeaders||(s.additionalHeaders={}),r&&0!==Object.keys(r).length&&(s.additionalHeaders[o.a.OfflineData]=JSON.stringify(r)),s.urlParameters=s.urlParameters+o.a.OfflinePlaybackUrlParameter,new D.a(new j.a(n,e,M.a.InProgress,JSON.stringify(s)).toDictionary(),P.a.Create,o.a.CommandString)}var U,G,q=r("8CAN");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function z(e,t){const r=new Map;return Array.prototype.forEach.call(e.getElementsByTagName(G.PropertyNode),e=>{if(!e.hasAttribute(U.NameAttribute))throw u.c.error("XamlParser.GetCommandRequestData:CommandRequestData node must have a Name attribute provided."+e),new Error("CommandRequestData node must have a Name attribute provided.");const n=e.getAttribute(U.NameAttribute);r.set(n,t.get(n))}),r}function Y(e){const t={};if(!e.hasAttribute(U.OperationNameAttribute)||!e.hasAttribute(U.EntityNameAttribute)||!e.hasAttribute(U.IsExecutableAttribute))throw u.c.error("XamlParser.GetOperation:Operation node must have a OperationName, EntityName and IsExecutable attributes provided."+e),new Error("Operation node must have a OperationName, EntityName and IsExecutable attributes provided.");return t.OperationName=e.getAttribute(U.OperationNameAttribute),t.EntityName=e.getAttribute(U.EntityNameAttribute),t.IsExecutable=e.getAttribute(U.IsExecutableAttribute),e.hasAttribute(U.SourceAttribute)&&(t.Source=e.getAttribute(U.SourceAttribute)),Array.prototype.forEach.call(e.childNodes,r=>{switch(r.nodeName){case G.AttributesNode:t.Attribute=(n=e,Array.prototype.map.call(n.getElementsByTagName(G.AttributeNode),e=>{const t={};if(!e.hasAttribute(U.FieldAttribute))throw u.c.error("XamlParser.GetAttributes:Attribute node must have a Field attribute provided."+e),new Error("Attribute node must have a Field attribute provided.");t.Field=e.getAttribute(U.FieldAttribute),t.Value=e.firstChild.nodeValue;const r=e.getAttribute(U.IsResettableAttribute);return r&&(t.IsResettable=r),t}));break;case G.ConditionsNode:t.MultipleCheck=function(e){return Array.prototype.map.call(e.getElementsByTagName(G.MultipleCheckNode),e=>{const t={};if(!e.hasAttribute(U.TypeAttribute))throw u.c.error("XamlParser.GetMultipleChecks:MultipleCheck node must have a Type attribute provided."+e),new Error("MultipleCheck node must have a Type attribute provided.");return t.Type=e.getAttribute(U.TypeAttribute),t.Condition=function(e){return Array.prototype.map.call(e.getElementsByTagName(G.ConditionNode),e=>{const t={};if(!(e.hasAttribute(U.LeftOperandAttribute)&&e.hasAttribute(U.RightOperandAttribute)&&e.hasAttribute(U.OperatorAttribute)&&e.hasAttribute(U.TypeAttribute)))throw u.c.error("XamlParser.GetConditions:Condition node must have a Left Operand, Right Operand, Operator and Type attribute provided."+e),new Error("Condition node must have a Left Operand, Right Operand, Operator and Type attribute provided.");return t.LeftOperand=e.getAttribute(U.LeftOperandAttribute),t.RightOperand=e.getAttribute(U.RightOperandAttribute),t.Operator=e.getAttribute(U.OperatorAttribute),t.Type=e.getAttribute(U.TypeAttribute),t})}(e),t})}(e);break;case G.ResultNode:t.Result=function(e){const t=X(e,G.ResultNode);if(!t)throw u.c.error("XamlParser.GetResult:Result node must have a Name and Value attributes provided."+e),new Error("Result node must have a Name and Value attributes provided.");return t}(e);break;case G.IdentifierNode:t.Identifier=function(e){const t=X(e,G.IdentifierNode);if(!t)throw u.c.error("XamlParser.GetIdentifier:Identifier node must have a Name and Value attributes provided."+e),Error("Identifier node must have a Name and Value attributes provided.");return t}(e);break;case G.MessageNode:t.Message=function(e){const t=e.getElementsByTagName(G.MessageNode);if(t&&t.length>0){if(1===t.length){const e=t[0];return{WebResourceName:e.getAttribute(U.WebResourceNameAttribute),Key:e.getAttribute(U.KeyAttribute)}}throw new Error("More than one message found.")}return null}(e)}var n}),t}function X(e,t){const r=e.getElementsByTagName(t),n=(null!=r&&r.length)>0?r[0]:e;return n.hasAttribute(U.NameAttribute)&&n.hasAttribute(U.ValueAttribute)?{Name:n.getAttribute(U.NameAttribute),Value:n.getAttribute(U.ValueAttribute)}:null}!function(e){e.NameAttribute="Name",e.OperationNameAttribute="OperationName",e.EntityNameAttribute="EntityName",e.IsExecutableAttribute="IsExecutable",e.FieldAttribute="field",e.IsResettableAttribute="IsResettable",e.OperatorAttribute="Operator",e.RightOperandAttribute="RightOperand",e.LeftOperandAttribute="LeftOperand",e.TypeAttribute="Type",e.ValueAttribute="Value",e.SourceAttribute="Source",e.WebResourceNameAttribute="WebResourceName",e.KeyAttribute="Key"}(U||(U={})),function(e){e.RootNode="Activity",e.OperationNode="Operation",e.PropertyNode="Property",e.AttributesNode="Attributes",e.ConditionsNode="Conditions",e.ResultNode="Result",e.IdentifierNode="Identifier",e.MultipleCheckNode="MultipleCheck",e.ConditionNode="Condition",e.AttributeNode="Attribute",e.MessageNode="Message"}(G||(G={}));var H,K=r("eXjw"),Q=r("3hnk"),J=r("sZ+8"),$=r("FZDd"),Z=r("ROKC"),ee=r("8o18"),te=r("/bjP"),re=r("XvL5"),ne=r("8tWD");!function(e){e.QualifyLeadCommandName="QualifyLead",e.ConvertActivityCommandName="ConvertActivity",e.LoseOpportunityCommandName="LoseOpportunity",e.WinOpportunityCommandName="WinOpportunity",e.ResolveCaseCommandName="CloseIncident",e.SetState="SetState",e.CloseActivityCommandName="CloseActivity",e.ResolveIncidentCommandName="ResolveIncident"}(H||(H={}));var ae=r("Lyxw"),ie=r("3/02"),oe=r("f07+"),se=r("uIhY"),le=r("odYE"),ce=r("EXJz");let _e;function ue(e,t,r,n){return{type:"offline.noncud.request.process",execute:({dispatch:a,getState:i},o)=>de(e,t,r,{dispatch:a,getState:i},n).then(n=>(u.c.info("OFFLINE: CommandHandler: processCommandRequest: Executing the command operations."),k.executeCommand(e,t,r,n,i()))).then(e=>(u.c.info("OFFLINE: CommandHandler: processCommandRequest: Resolving promise with entity operations."),e)).catch(r=>{throw u.c.error("OFFLINE: CommandHandler: processCommandRequest: failed with error: "+Object(N.e)(r)+" for entity: "+e+" and command: "+t),r})}}function de(e,t,r,n,a){if(u.c.info("OFFLINE: CommandHandler: processCommandRequest: Initializing processing of non cud request with entityName as "+e+", commandName as "+t+"."),!e||!t||!r||0===Object.keys(r).length)return u.c.error("OFFLINE: CommandHandler: processCommandRequest: failed because entity/command/request is empty."),Promise.reject(new T.a("The entityName/commandName/request is empty."));u.c.info("OFFLINE: CommandHandler: processCommandRequest: Retrieving user privilege and custom entity flag for the entity "+e+".");const{getState:i,dispatch:s}=n;return me(e,n).then(t=>{if(!t.get("isPrivileged")){const t=Object(A.h)(i(),e)?Object(A.h)(n.getState(),e).Id:null;throw u.c.error("OFFLINE: CommandHandler: processCommandRequest: failed because the user does not have the privilege of the entity or the write permission on the entity "+t+"."),new T.a("The user does not have the privilege of the entity or the write permission on the entity.")}return t}).then(l=>(u.c.info("OFFLINE: CommandHandler: processCommandRequest: Retrieving command xaml for command "+t+"."),ge(l.get("isActivity")&&l.get("isCustomEntity")&&t===H.ConvertActivityCommandName?"CustomActivity":e,t,n).then(l=>{if(!l)throw u.c.error("OFFLINE: CommandHandler: processCommandRequest: Retrieving command xaml failed because Xaml was not found or was empty for entity "+e+" and command "+t+"."),new T.a("Xaml not found or was empty.");u.c.info("OFFLINE: CommandHandler: processCommandRequest: Parsing the command xaml to get corresponding command operations for command "+t+".");const c=function(e,t){const r=(new DOMParser).parseFromString(e,"text/xml");if(u.c.info("XamlParser.createObjectFromXaml:Creates command operations from commandXaml: "+e),!r.hasChildNodes()||r.childNodes[0].nodeName!==G.RootNode)throw u.c.error("XamlParser.CreateObjectFromXaml:CreateObjectFromXaml must have a valid root node with name Activity. "+e),new Error("CreateObjectFromXaml must have a valid root node with name Activity.");const n=r.getElementsByTagName(G.RootNode)[0];return{CommandRequestData:z(n,t),Operations:Array.prototype.map.call(n.getElementsByTagName(G.OperationNode),Y)}}(l,function(e,t,r){const n=new Map,a=e,i=r&&r.EntityLogicalName;Object.keys(e).filter(e=>a[e]&&("function"!=typeof a[e]||"name"===e||"xmlNamespace"===e)).forEach(o=>{if("entityMoniker"!==o){let s=null;a[o].hasOwnProperty("@odata.type")&&(s=a[o]["@odata.type"].replace(/#Microsoft.Dynamics.CRM./,""));const l=Object.keys(a[o]).filter(e=>Object(ce.c)(e)),c=Object.keys(a[o]).filter(e=>Object(ce.f)(e));if(l&&0!==l.length||c&&0!==c.length){let e=Object.assign({},a[o]);l&&0!==l.length&&l.forEach(n=>{const a=Oe(e[n]),o=Object(ce.c)(n)[1],l=Object(A.y)(t,s||i,o);let c=l&&l.ReferencingAttribute;if(c||(c=o.split("_")[0]),a){delete e[n];const i=Object(J.d)(t,a[0]),o=i&&i.entitylogicalname;if(i){const t={id:a[1],entityType:o,typeCode:f.b(i.objecttypecode)};r&&r[c]&&r[c].name&&(t.name=r[c].name,delete r[c]),e=Object.assign({[c]:t},e)}}}),c&&0!==c.length&&c.forEach(t=>{const r=Object(ce.f)(t)[1];if(r&&null==e[t]){const n={id:null,entityType:null,name:null};delete e[t],e=Object.assign({[r]:n},e)}}),n.set(o,e)}else n.set(o,e[o])}else n.set("entityId",a[o].get_identifier()),n.set("entityName",a[o].get_displayName())}),r&&Object.keys(r).forEach(e=>{n.set(e,r[e])});return n}(r,n.getState(),a));if(!c||!c.Operations||!c.CommandRequestData)throw u.c.error("OFFLINE: CommandHandler: processCommandRequest: failed because the creation of command operations from command xaml failed for command "+t+"."),new T.a("The creation of command operations from command xaml failed.");const _=[];for(const e of c.Operations){const t=S.getEntityName(c.CommandRequestData,e.EntityName);if(o.a.UpdateStep===e.OperationName&&t){const e=Object(A.h)(i(),t);e&&Object(K.b)(e.Initialized)||_.push(s(Object($.f)(t,!1,[])))}}return Promise.all(_).then(()=>c)})))}function pe(e,t,r,n){return{type:"offline.noncud.request.process",execute:({dispatch:a,getState:i},o)=>de(e,t,r,{dispatch:a,getState:i},n).then(n=>(u.c.info("OFFLINE: CommandHandler: prepareCommandRequestQueries: Preparing the command queries."),k.prepareCommandQueries(e,t,r,n,i()))).then(e=>(u.c.info("OFFLINE: CommandHandler: prepareCommandRequestQueries: Resolving promise with queryset dictionary."),e)).catch(r=>{throw u.c.error("OFFLINE: CommandHandler: prepareCommandRequestQueries: failed with error: "+Object(N.e)(r)+" for entity: "+e+" and command: "+t),r})}}function fe(e){const t=e.map(e=>{if(e.get_operationPerformed()===P.a.Create)return{LogicalName:e.get_entityType(),Id:e.get_entity()[e.get_entityType()+"id"]}}).filter(e=>e);return{ok:!0,status:t.length?200:204,json:()=>Promise.resolve({createdEntities:t}),text:()=>Promise.resolve(JSON.stringify({createdEntities:t}))}}function me(e,t){return t.dispatch(Object($.f)(e,!1,[])).then(()=>{const r=Object(A.h)(t.getState(),e);return(new Map).set("isPrivileged",Object(Q.g)(t.getState(),e,3,-1)).set("isActivity",r.IsActivity).set("isCustomEntity",r.IsCustomEntity)}).catch(e=>(u.c.error("retrieveEntity fails"+Object(N.e)(e)),Promise.reject(e)))}function ge(e,t,r){const n=String.format(q.a.CommandXamlRetrievalQuery,t,e);u.c.info("Retrieving commandxaml for "+e+" with sql value: "+n);const a=new ee.a(new te.a,null);return a.set_EntityLogicalName(q.a.OfflineCommandDefinition),a.set_ColumnSet(new re.a([])),a.get_DescriptorSet().updateDescriptorSet(ne.a.Sql,n),r.dispatch(Object(Z.a)(a,null)).then(e=>{const t=e.get_entities();if(t&&1===t.length)return u.c.info("Able to successfully retrieve multiple record from offline db"),t[0].getValue("commanddefinition");throw u.c.error("Retrieved more than one command xaml from db."),Error("Retrieved more than one command xaml from db.")},e=>{throw u.c.error("Unable to Retrieve xaml from offline db "+Object(N.e)(e)),e})}function he(e,t,r){switch(t){case H.QualifyLeadCommandName:case H.ConvertActivityCommandName:case H.WinOpportunityCommandName:case H.LoseOpportunityCommandName:case H.ResolveIncidentCommandName:return Promise.resolve(!0);default:return Object(ae.c)(e.getState(),ie.I)?function(e){if(!_e)return function(e){u.c.info("Retrieving all command names");const t=new ee.a(new te.a,null);return t.set_EntityLogicalName(q.a.OfflineCommandDefinition),t.set_ColumnSet(new re.a([])),t.set_PageSize(100),t.get_DescriptorSet().updateDescriptorSet(ne.a.Sql,q.a.CommandsRetrievalQuery),e.dispatch(Object(Z.a)(t,null)).then(e=>{const t=e.get_entities();if(t&&t.length>0)return u.c.info("Able to successfully retrieve multiple commands from offline db"),t.reduce((e,t)=>{const r=t.getValue("commandname"),n=t.getValue("primaryentitylogicalname");return e.hasOwnProperty(r)?e[r].push(n):e[r]=[n],e},{});throw u.c.error("Retrieved no commands from db."),Error("Retrieved no commands from db.")},e=>{throw u.c.error("Unable to Retrieve commands from offline db "+Object(N.e)(e)),e})}(e).then(e=>{_e=e});return Promise.resolve()}(e).then(()=>function(e,t){return _e&&_e[e]&&-1!==_e[e].indexOf(t)}(t,r)):Promise.resolve(!1)}}function be(e,t,r,n){switch(t.get_name()){case"Create":{const a=t,i=a.get_target(),o=Object(se.b)(e.getState(),i),s=i.get_identifier().LogicalName;r=r||c.a.fromLegacyGuid(i.get_identifier().Id);const l=s+"id";o.hasOwnProperty(l)||c.a.isNullOrEmpty(r)||(o[l]=c.a.toString(r)),n&&Se(i,n);const _=a.get_suppressDuplicateDetection();return new oe.b(s,o,_)}case"Update":{const r=t,a=r.get_target();n&&Se(a,n);const i=r.get_suppressDuplicateDetection();return new oe.g(a.get_identifier().LogicalName,a.get_identifier().Id.toString(),Object(se.b)(e.getState(),a),null,null,!1,i)}case"Delete":{const e=t.get_target();return new oe.c(le.a.legacyToExternalEntityReference(e))}case"ExecuteMultiple":{const r=t,n=r.get_requests().map(t=>be(e,t));return r.get_settings().get_continueOnError()?new oe.d(n):new oe.d([n])}default:return null}}function Se(e,t){e.get_changedFieldNames().forEach(r=>{const n=e.getValue(r);n&&n.hasOwnProperty("Id")&&(t[r]={name:n.Name})})}function Oe(e){const t=e.match("/(.*)\\((.*)\\)");return t&&3===t.length?[t[1],t[2]]:null}},"8CAN":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n;r.d(t,"a",(function(){return n})),function(e){e.OfflineCommandDefinition="offlinecommanddefinition",e.CommandXamlRetrievalQuery="select commanddefinition, commanddefinitionid from offlinecommanddefinition where commandname='{0}' and primaryentitylogicalname='{1}'",e.CommandsRetrievalQuery="select commanddefinitionid, commandname, primaryentitylogicalname from offlinecommanddefinition"}(n||(n={}))},TwA0:function(e,t,r){"use strict";r.r(t),r.d(t,"offlineReducer",(function(){return Z})),r.d(t,"OfflineTypescriptInterface",(function(){return Rr})),r.d(t,"ConstructOfflineState",(function(){return y})),r.d(t,"createReInitializeOfflineAction",(function(){return C.b})),r.d(t,"getOfflineFeatureStatus",(function(){return a.p})),r.d(t,"getIsOfflineEnabled",(function(){return a.k})),r.d(t,"isOfflineAvailableForUse",(function(){return a.w})),r.d(t,"inOfflineEnabledProfile",(function(){return st.a})),r.d(t,"getReInitializeOffline",(function(){return a.u})),r.d(t,"hasOfflineAvailableEntitiesOrProfileVersionHasChanged",(function(){return f})),r.d(t,"hasOfflineConfigurationExceptAvailableEntitiesChanged",(function(){return d})),r.d(t,"initializeOfflineLifecycleAsyncAction",(function(){return T.initializeOfflineLifecycleAsyncAction})),r.d(t,"isOldStateEmpty",(function(){return p})),r.d(t,"OfflineUpdateStateTree",(function(){return E})),r.d(t,"offlineUpdateStateTreeFromSessionState",(function(){return n.a})),r.d(t,"getXrmWebApiOfflineInstance",(function(){return wr})),r.d(t,"OfflineResourceIds",(function(){return yt}));var n=r("vWyY"),a=r("37s6"),i=r("GL3b"),o=r("iF9X"),s=r("NjDY"),l=r("IqkD"),c=r("SAYH"),_=r("504W"),u=r("Nzmy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function d(e,t){return(!c.a.equals(i.c(e),l.e(e))||o.c(e)!==s.s(e)||o.a(e)!==s.m(e)||o.b(e)!==s.r(e))&&(u.c.info("Offline.EvalulateOfflineStatus: returning true"),!0)}function p(e,t,r){if(Object(_.a)(e)||Object(_.a)(t))return u.c.info("Offline.isOldStateEmpty: returning true"),!0}function f(e){return i.d(e)!==l.f(e)||function(e,t){let r=!1;const n=e.length,a=t.length;if(n!==a)r=!0;else for(const n of e)t.indexOf(n)<0&&(r=!0);return r}(i.b(e),l.d(e))}var m=r("8CAN"),g=r("sZ+8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function h(e){return e&&e.offline&&e.offline.client&&e.offline.client.lastMetadataVersionUsedForValidation?e.offline.client.lastMetadataVersionUsedForValidation:null}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var b,S=r("ybGo");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e.ENTITY="entitylogicalname",e.OBJECTTYPECODE="objecttypecode",e.TRANSACTION_CURRENCY="transactioncurrency",e.BUSINESS_PROCESS_FLOW_INSTANCE="businessprocessflowinstance",e.SYSTEM_USER="systemuser"}(b||(b={}));var O=r("/D1P");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function y(e,t,r){let n=Object(a.c)(e);const u=!!Object(o.e)(e)&&Object(a.a)(e),d=Object(i.c)(e);Object(_.a)(d)||c.a.equals(d,c.a.EMPTY)||c.a.equals(d,l.e(e))||(n=!0);const p=function(e,t){e&&((t=Object(_.a)(t)?[]:t).forEach(t=>{e.indexOf(t)<0&&e.push(t)}),e.indexOf(m.a.OfflineCommandDefinition)<0&&e.push(m.a.OfflineCommandDefinition),e.indexOf(b.BUSINESS_PROCESS_FLOW_INSTANCE)<0&&e.push(b.BUSINESS_PROCESS_FLOW_INSTANCE));return e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(l.d(e),function(e){return e&&e.metadata&&e.metadata.offlineBPFEntities?e.metadata.offlineBPFEntities.offlineBPFEntities:null}(e));return{server:{profileId:l.e(e),profileVersion:l.f(e),profileAvailableEntities:p,norsyncServerConnectionString:s.s(e),isTrialOrganization:s.r(e),isMocaOfflineFeatureEnabled:s.m(e)},client:{reInitializeOffline:t||Object(a.u)(e),offlineFeatureStatus:Object(a.p)(e),upSyncStatus:r?O.a.Pending:Object(S.b)(e),offlineDisabledEntities:g.h(e),offlineDisabledPrimaryEntities:g.i(e),offlineAvailablePrimaryEntities:g.g(e),entityPluralName:g.f(e),status:Object(a.q)(e),statusReason:Object(a.r)(e),errorCode:Object(a.n)(e),errorMessage:Object(a.o)(e),existingDatabaseName:Object(a.d)(e),isDbCleanupNeeded:n,isProfileChanged:Object(i.a)(e),lastMetadataVersionUsedForValidation:h(e),isCalculationOfDisabledEntitiesPending:g.c(e),applyApplicationMetadataChanges:u,isUserSelectOffline:Object(a.v)(e),isOfflineFirstTimeSyncCompleted:Object(a.l)(e)}}}function E(e){return{type:"offline.set.state.tree",payload:e}}var C=r("qjwL"),T=r("WTtv"),N=r("2YQW"),A=r("28qD"),v=r("iOI1");var D=r("9bCE"),F=r("Eh/Y"),P=r("QSjj");var I=r("e+ib"),x=r("Rj8P"),L=r("VKvO"),R=r("6u68"),w=r("wje5"),M=r("8Mff"),j=r("eZ32"),k=r("8CLP"),B=r("o1og"),W=r("GUh4"),V=r("GLaK"),U=r("t9aj"),G=r("6lVV"),q=r("JEu3");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const z=Object.freeze({offlineFeatureStatus:M.a.Default,status:j.a.NotAvailable,upSyncStatus:O.a.Pending,offlineDisabledEntities:[],entityPluralName:{},offlineDisabledPrimaryEntities:[],offlineAvailablePrimaryEntities:{},statusReason:k.a.None,errorCode:null,errorMessage:null,existingDatabaseName:"",isDbCleanupNeeded:!1,isProfileChanged:!1,lastMetadataVersionUsedForValidation:"",isCalculationOfDisabledEntitiesPending:!0,reInitializeOffline:!1,applyApplicationMetadataChanges:!1,clientVersion:"",applyingApplicationMetadataChanges:!1,isUserSelectOffline:!1,isSyncing:!1,isOfflineFirstTimeSyncCompleted:!1,isFirstApplyApplicationMetadataChangesDone:!1,isForcedSyncInProgress:!1,isImmediateOfflineDataSyncInProgress:!1,isFileSyncInProgress:!1});var Y=r("iEoY"),X=r("nr11"),H=r("wTHG"),K=r("rCFy"),Q=r("j/Rx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const J=Object.freeze({profileId:c.a.EMPTY,profileVersion:"",profileAvailableEntities:[],norsyncServerConnectionString:"",isTrialOrganization:!1,isMocaOfflineFeatureEnabled:!1,subscriptionId:"",subscriptionErrorMessage:""});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const $={client:function(e=z,t){switch(t.type){case F.a:case"offline.profile.changed":case D.a:case"offline.datamodel.changed":case v.a:case I.a:case P.a:case x.b:case A.a:case C.a:case L.a:case R.a:case w.a:case B.b:case B.a:case x.a:case W.a:case V.a:case U.a:case B.c:case G.a:case G.b:case q.a:return Object.freeze(Object.assign(Object.assign({},e),t.payload));case"offline.set.state.tree":const r=t.payload;return Object.freeze(Object.assign(Object.assign({},e),r.client));default:return e}},server:function(e=J,t){switch(t.type){case Q.a:case Y.a:case X.a:case H.a:case K.a:return Object.freeze(Object.assign(Object.assign({},e),t.payload));case"offline.set.state.tree":const r=t.payload;return Object.freeze(Object.assign(Object.assign({},e),r.server));default:return e}}},Z=Object(N.a)($);var ee=r("5ZTD"),te=r("IaGr"),re=r("zsAz"),ne=r("odYE"),ae=r("TBkx"),ie=r("LbMF"),oe=r("wHbR");function se(e,t){return{type:"offline.create.entity.record",execute:({dispatch:r,getState:n},a)=>a.DataSource.createEmptyEntityRecord(e,null).nativePromise().then(r=>(u.c.info("Was able to successfully create the empty record for "+e+" with default values"),Object(ie.a)(n(),e,oe.b.TransactionCurrencyId)&&function(e,t,r){if(!t[oe.b.TransactionCurrencyId]){const e=Object(l.b)(r);e&&(t[oe.b.TransactionCurrencyId]=ne.a.toLegacyEntityReference(new ne.a(oe.b.TransactionCurrency,e.transactionCurrencyId,e.currencyName)))}}(0,t,n()),Object.keys(t).forEach(e=>{r.setValue(e,t[e])}),r)).then(e=>a.DataSource.create(e,!0,null)).then(e=>(u.c.info("Was able to successfully create the record in offline db for "+e.LogicalName+" id "+e.get_identifier()),{[oe.b.Id]:e.get_identifier(),[oe.b.LogicalName]:e.LogicalName})).catch(e=>{throw u.c.error("Unable to create record sucessfully "+Object(ae.e)(e)),e})}}var le=r("iZ7K"),ce=r("+YnR"),_e=r("EXJz"),ue=r("a8zb"),de=r("HYaY"),pe=r("WRF3"),fe=r("sdkC");var me=r("84PK");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var ge,he,be=r("yQs0"),Se=r("I1N9"),Oe=r("YIt1");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class ye{constructor(e){this.dataType=null,this.value=null,this.value=e,this.dataType=Object.getType(e)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.openBracket=0]="openBracket",e[e.closeBracket=1]="closeBracket",e[e.logicalOperator=2]="logicalOperator",e[e.operand=3]="operand"}(ge||(ge={}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Ee{constructor(e){this.type=0,this.value=null,this.type=this._GetTokenType(e),this.value=e.toLowerCase()}_GetTokenType(e){switch(e.toLowerCase()){case"(":return 0;case")":return ge.closeBracket;case"and":case"or":case"not":return ge.logicalOperator;default:return ge.operand}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Ce{constructor(){this._parseFilterRegex="'.*?'|[^()\\s]+|[()]",this._operatorStack=[],this._operandStack=[]}parse(e){const t=new RegExp(this._parseFilterRegex,Ce._ParseStringGlobally),r=e.match(t);for(let e=0;e<r.length;e++){const t=r[e],n=new Ee(t);switch(n.type){case 0:this._operatorStack.push(new ye(n));break;case ge.closeBracket:this._EvaluateStack(!0);break;case ge.logicalOperator:this._CheckPrecendenceWithLastOperator(n.value)&&this._EvaluateStack(!1),this._operatorStack.push(new ye(n));break;case ge.operand:if(!(e+2<r.length))throw Error.create(String.format("FilterParser: Improper Input string , exception raised after '{0}'",n.value));this._ExtractOperand(e,t,r),e+=2}}if(this._EvaluateStack(!0),1!==this._operandStack.length)throw Error.create("FilterParser: Error while evaluating expression : Input Expression seems to have improper construct");const n=this._operandStack.pop(),a=new Se.a(0,me.a.newGuid().toString());return this._AddToFilterExpression(a,n.value),a}_EvaluateStack(e){for(;this._operatorStack.length>0;){const t=this._operatorStack.pop();if(!(t.value instanceof Ee))throw Error.create("FilterParser:EvaluateExpression Error While Evaluating Stack");{const r=t.value;if(!r.type){e||this._operatorStack.push(new ye(t.value));break}if(r.type===ge.logicalOperator){const e=this._GetLogicalOperator(r.value);let t=null;t=e===Oe.a.Not?this._CreateFilterExpressionWithOperands(e,1):this._CreateFilterExpressionWithOperands(e,2),this._operandStack.push(new ye(t))}}}}_ExtractOperand(e,t,r){const n=r[e+1],a=this._TrimSingleQuotes(r[e+2]),i=new be.a(t,this._GetConditionalOperator(n),a);this._operandStack.push(new ye(i))}_CreateFilterExpressionWithOperands(e,t){if(this._operandStack.length<t)throw Error.create("FilterParser:EvaluateExpression Error While Evaluating Stack :  Input Expression seems to have improper construct");const r=new Se.a(e,me.a.newGuid().toString());for(let e=0;e<t;e++){const e=this._operandStack.pop();this._AddToFilterExpression(r,e.value)}return r}_AddToFilterExpression(e,t){t instanceof Se.a?e.addFilterExpression(t):t instanceof be.a&&e.addCondition(t.get_attributeName(),t.get_operator(),t.get_value())}_TrimSingleQuotes(e){return e.startsWith("'")&&e.endsWith("'")&&(e=(e=e.substring(1,e.length)).substring(0,e.length-1)),e}_CheckPrecendenceWithLastOperator(e){let t=!1;if(!this._operatorStack.length)return t;const r=this._Peek(this._operatorStack);if(r.value instanceof Ee){const n=r.value;if(n.type){if(n.type===ge.logicalOperator){const r=this._GetLogicalOperatorPriority(n.value.toLowerCase());this._GetLogicalOperatorPriority(e.toLowerCase())>r&&(t=!0)}}else t=!1}return t}_GetLogicalOperatorPriority(e){switch(e.toLowerCase()){case"not":return 1;case"and":return 2;case"or":return 3;default:throw Error.create(String.format("An invalid logical operator {0} passed as input parameter.",e))}}_GetConditionalOperator(e){switch(e.toLowerCase()){case"eq":return"eq";case"ne":return"ne";case"gt":return"gt";case"lt":return"lt";case"ge":return"ge";case"le":return"le";default:throw Error.create(String.format("FilterParser: An invalid  conditional operator {0} passed as input parameter.",e))}}_GetLogicalOperator(e){switch(e.toLowerCase()){case"not":return Oe.a.Not;case"and":return 0;case"or":return Oe.a.Or;default:throw Error.create(String.format("An invalid logical operator {0} passed as input parameter.",e))}}_Peek(e){const t=e.pop();return e.push(t),t}}Ce._ParseStringGlobally="g";class Te{constructor(e,t){this._filterExpression=null,this._filterExpression=t}get_filterExpression(){return this._filterExpression}}class Ne{constructor(e){this._expandTerms=null,this._expandTerms=e}get_expandTerms(){return this._expandTerms}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Ae{constructor(){this.text=null,this.position=0,this.kind=0}GetText(){return this.text}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.unknown=0]="unknown",e[e.end=1]="end",e[e.equal=2]="equal",e[e.openParenthesis=3]="openParenthesis",e[e.closeParenthesis=4]="closeParenthesis",e[e.comma=5]="comma",e[e.question=6]="question",e[e.identifier=7]="identifier"}(he||(he={}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class ve{constructor(e){this.text=null,this.textLength=0,this.currentchar=null,this.textPosition=0,this._token=null,this._alphaNumericRegex=new RegExp("[a-zA-Z1-9]","g"),this._whiteSpaceRegex=new RegExp("\\s+","g"),this.text=e,this.textLength=e.length,this._SetCurrentCharAndTextPosition(0),this._token=new Ae}_SetCurrentCharAndTextPosition(e){this.textPosition=e,this.currentchar=this.textPosition<this.textLength?this.text.charAt(this.textPosition):"\0"}nextToken(){return this._NextTokenImplementation()}_NextTokenImplementation(){this._SkipWhiteSpace();const e=this.textPosition;return this._token.kind=this._GetExpressionTokenKind(),this._token.text=this.text.substr(e,this.textPosition-e),this._token.position=e,this._token}get_isValidWhiteSpace(){const e=this.currentchar.toString().match(this._whiteSpaceRegex);return"\0"!==this.currentchar&&!Object(_.a)(e)&&e.length>0}get_position(){return this._token.position}get_token(){return this._token}get_isValidCharForIdentifier(){return"\0"!==this.currentchar&&(this._IsAlphaNumeric(this.currentchar)||"_"===this.currentchar||"$"===this.currentchar)}_IsAlphaNumeric(e){const t=e.toString().match(this._alphaNumericRegex);return!Object(_.a)(t)&&1===t.length}_SkipWhiteSpace(){for(;this.get_isValidWhiteSpace();)this.nextChar()}_GetExpressionTokenKind(){let e=0;switch(this.currentchar){case"(":this.nextChar(),e=he.openParenthesis;break;case")":this.nextChar(),e=he.closeParenthesis;break;case",":this.nextChar(),e=he.comma;break;default:if(this.get_isValidWhiteSpace()){this._SkipWhiteSpace(),e=0;break}if(this.get_isValidCharForIdentifier()){this._ParseIdentifier(),e=he.identifier;break}if(this.textPosition===this.textLength){e=he.end;break}throw Error.create("Unknown CharacterType Received")}return e}nextChar(){this.textPosition<this.textLength&&this.textPosition++,this.currentchar=this.textPosition===this.textLength?"\0":this.text.charAt(this.textPosition)}_ParseIdentifier(){do{this.nextChar()}while(this.get_isValidCharForIdentifier())}advanceThroughBalancedParentheticalExpression(){const e=this.get_position();this._AdvanceThroughBalancedExpression("(",")");return this.text.substr(e,this.textPosition-e)}_AdvanceThroughBalancedExpression(e,t){let r=1;for(;r>0;)this.currentchar===e?r++:this.currentchar===t&&r--,this.nextChar()}}class De{constructor(e){this._lexer=null,this._lexer=e}parseTerm(){const e=this._lexer.get_token().GetText();return this._lexer.nextToken(),e}}class Fe{constructor(e,t){this._navigationProperty=null,this._selectOption=null,this._navigationProperty=e,this._selectOption=t}get_navigationProperty(){return this._navigationProperty}get_selectOption(){return this._selectOption}get_expandTermString(){return this._GetExpandTermString()}_GetExpandTermString(){const e=Object(_.a)(this._selectOption)?null:this._selectOption.get_attributeNames(),t=new Sys.StringBuilder;return t.append(String.format("$expand={0}",this._navigationProperty)),Object(_.a)(e)||t.append(String.format("($select={0})",e.join(","))),t.toString()}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Pe{constructor(e,t){this._propertyName=null,this._optionsText=null,this._whiteSpacesRegex=new RegExp("\\s+","g"),this._propertyName=e,this._optionsText=t}_TrimBraces(e){const t=e.startsWith("("),r=e.endsWith(")");return t&&(e=e.substring(1,e.length)),r&&(e=e.substring(0,e.length-1)),e.trim()}buildExpandTermToken(){Object(_.a)(this._optionsText)||(this._optionsText=this._optionsText.replace(this._whiteSpacesRegex,""),this._optionsText=this._TrimBraces(this._optionsText),this._optionsText=this._optionsText.startsWith("?")?this._optionsText:"?"+this._optionsText);const e=ke(this._optionsText);let t=null;for(const r in e){const n={key:r,value:e[r]};if("$select"!==n.key)throw Error.create(String.format("Query option {0} is not supported within $expand",n.key));t=je(e.$select.toString())}return new Fe(this._propertyName,t)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Ie{constructor(e){this._lexer=null,this._lexer=new ve(e)}parse(){return this._ParseCommaSepratedExpandList()}_ParseCommaSepratedExpandList(){const e=[];if(this._lexer.nextToken(),this._lexer.get_token().kind===he.end)throw Error.create("Invalid Expand Expression passed");for(e.push(this._ParseSingleExpandTerm());this._lexer.get_token().kind===he.comma&&(this._lexer.nextToken(),this._lexer.get_token().kind!==he.end);)e.push(this._ParseSingleExpandTerm());if(this._lexer.get_token().kind!==he.end)throw Error.create("Improper Expand string provided");return new Ne(e)}_ParseSingleExpandTerm(){const e=new De(this._lexer).parseTerm();this._ThrowIfValueNullorUndefined(e,"Relationship Name");let t=null;this._lexer.get_token().kind===he.openParenthesis&&(t=this._lexer.advanceThroughBalancedParentheticalExpression(),this._lexer.nextToken());return new Pe(e,t).buildExpandTermToken()}_ThrowIfValueNullorUndefined(e,t){if(Object(_.a)(e))throw Error.create(String.format("property {0} with value {1} is undefined",t,e))}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class xe{constructor(e,t){this._attributeName=null,this._direction=null,this._ThrowIfDirectionNotValid(t),this._attributeName=e,this._direction=Object(_.a)(t)?"asc":t}_ThrowIfDirectionNotValid(e){if(!Object(_.a)(e)&&"asc"!==e&&"desc"!==e)throw Error.create(String.format(" Invalid OrderBy Construct passed {0}",String.format("{0} {1}",this._attributeName,e)))}get_attributeName(){return this._attributeName}get_isDescending(){return!Object(_.a)(this._direction)&&"desc"===this._direction}}class Le{constructor(e){this._orderbyTermTokens=null,this._orderbyTermTokens=e}get_orderByTermTokens(){return this._orderbyTermTokens}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Re{constructor(e){this._orderByString=null,this._orderByString=e}parse(){let e=null;if(!Object(_.a)(this._orderByString)){const t=this._orderByString.split(",").map(e=>this._GetOrderByTermTokenInternal(e));e=new Le(t)}return e}_GetOrderByTermTokenInternal(e){if(Object(_.a)(e)||!e.length)throw Error.create("Received Empty Orderby String");let t=null,r=null,n=0;const a=e.indexOf(" ",n);if(-1!==a){if(t=e.substr(n,a-n),a!==this._orderByString.length){for(n=a;" "===e.charAt(n);)n++;r=e.substr(n,this._orderByString.length-n)}}else t=e;return new xe(t,r)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class we{constructor(e){this._attributeNames=null,this._attributeNames=e}get_attributeNames(){return this._attributeNames}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Me{constructor(e){this._selectString=null,this._whiteSpaceRegex=new RegExp("\\s+","g"),this._selectString=Object(_.a)(e)?null:e.replace(this._whiteSpaceRegex,"")}parseSelect(){let e=null;if(!Object(_.a)(this._selectString)){const t=this._selectString.split(",");e=new we(t)}return e}}function je(e){return new Me(e).parseSelect()}function ke(e){const t={};if(!e||!e.length)return t;let r,n,a=1;for(;a<e.length;){if(r=e.indexOf("&",a),-1===r&&(r=e.length),n=e.indexOf("=",a),n>r&&(n=-1),-1!==n&&n<r){const i=e.substr(a,n-a),o=e.substr(n+1,r-n-1);Be(t,i),t[i]=o}a=r+1}return t}function Be(e,t){if(!Object(_.a)(t)&&t in e)throw Error.create(String.format("Multiple occurrence of {0} option found in uri input.",t))}class We{constructor(e){this._queryParameters=null,this._expandToken=null,this._filterToken=null,this._selectToken=null,this._orderByToken=null,this._fetchXml=null,this._skipToken=null,this._requestUri=null,this._top=-1,this._requestUri=e}get_expand(){if(this._ParsingRequired("$expand",this._expandToken)){const e=this.get_queryParameters().$expand.toString();this._expandToken=new Ie(e).parse()}return this._expandToken}get_filter(){if(this._ParsingRequired("$filter",this._filterToken)){const e=this.get_queryParameters().$filter.toString();this._filterToken=function(e){const t=(new Ce).parse(e);return new Te(e,t)}(e)}return this._filterToken}get_select(){if(this._ParsingRequired("$select",this._selectToken)){const e=this.get_queryParameters().$select.toString();this._selectToken=je(e)}return this._selectToken}get_requestUri(){return this._requestUri}get_queryParameters(){return(Object(_.a)(this.get_requestUri())||this.get_requestUri().length>0&&Object(_.a)(this._queryParameters))&&(this._queryParameters=ke(this.get_requestUri())),this._queryParameters}get_orderBy(){if(this._ParsingRequired("$orderby",this._orderByToken)){const e=this.get_queryParameters().$orderby.toString();this._orderByToken=function(e){return new Re(e).parse()}(e)}return this._orderByToken}get_top(){if(-1===this._top&&"$top"in this.get_queryParameters()){const e=this.get_queryParameters().$top.toString();this._top=Number.parseLocale(e)}return this._top}get_skipToken(){return this._ParsingRequired("$skiptoken",this._skipToken)&&(this._skipToken=this.get_queryParameters().$skiptoken.toString()),this._skipToken}get_fetchXml(){return this._ParsingRequired("fetchXml",this._fetchXml)&&(this._fetchXml=this.get_queryParameters().fetchXml.toString()),this._fetchXml}_ParsingRequired(e,t){return Object(_.a)(t)&&e in this.get_queryParameters()}}var Ve=r("z+5+"),Ue=r("a8hT");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Ge(e,t,r,n,a,i,o,s){return Object(_e.b)(n,r,e).then(()=>{const l=[];l.push({name:"RequestType",value:r});const _=Object(Ve.c)(e.getState()),d=Object(Ve.b)(e.getState());switch(l.push({name:"MDLSupportedForClientAPI",value:_}),l.push({name:"MDLSupportedForCUD",value:d}),r){case 0:const p=Object(_e.e)(Object.keys(i),n,e.getState());return Object(_e.a)(n,e,i,p),_&&d?Object(Ue.d)().then(t=>e.dispatch(t.oDataOfflineCreate(n,i,l)).then(e=>(u.c.info("MDL Offline Create record operation successful for client api "),Promise.resolve(e)),e=>(u.c.error("MDL Offline Create record operation failed for client api "+Object(ae.e)(e)),Promise.reject(e)))):e.dispatch(se(n,i)).then(e=>(u.c.info("Create record operation successful for client api "),Promise.resolve(e)),e=>(u.c.error("Create record operation failed for client api "+Object(ae.e)(e)),Promise.reject(e)));case 1:const f=Object(_e.e)(Object.keys(i),n,e.getState());return Object(_e.a)(n,e,i,f),i[Object(le.D)(e.getState(),n)]=me.a.tryCreate(a),e.dispatch(function(e,t,r){return{type:"offline.update.entity.record",execute({dispatch:n,getState:a},i){const o=new de.a(new pe.a(e,t[Object(le.D)(a(),e)]),t,r,{},{},new fe.a([]));return o.get_changedFieldNames().push(...Object.keys(t)),i.DataSource.update(o.get_actionableIdentifier(),o,!0,null).nativePromise().then(e=>(u.c.info("Was able to successfully update the record in offline db for "+e.LogicalName+" id  "+e.get_identifier()),{[oe.b.Id]:e.get_identifier(),[oe.b.LogicalName]:e.LogicalName})).catch(e=>{throw u.c.error("Unable to update the record in offline db "+Object(ae.e)(e)),e})}}}(n,i,f)).then(e=>(u.c.info("Update record operation successful for client api "),Promise.resolve(e)),e=>(u.c.error("Update record operation failed for client api "+Object(ae.e)(e)),Promise.reject(e)));case 3:return e.dispatch(function(e,t){return{type:"offline.delete.entity.record",execute:({dispatch:r,getState:n},a)=>a.DataSource.Delete(ne.a.toLegacyEntityReference(new ne.a(e,c.a.parse(t))),null).nativePromise().then(e=>(u.c.info("Was able to successfully delete the record in offline db for "+e.LogicalName+" id "+e.get_identifier()),{[oe.b.Id]:e.get_identifier(),[oe.b.LogicalName]:e.LogicalName})).catch(e=>{throw u.c.error("Unable to delete record in offline db "+Object(ae.e)(e)),e})}}(n,a)).then(r=>(u.c.info("Delete record operation successful for client api "),Object(ce.a)(e,n,c.a.tryParse(a),t),Promise.resolve(r)),e=>(u.c.error("Delete record operation failed for client api "+Object(ae.e)(e)),Promise.reject(e)));case 4:const m=new We(o);return m?Object(_e.g)(r,n,m,e).then(t=>Object(ue.c)(n,a,m,t,e).then(e=>(u.c.info("Retrieve record successful for client api "),Promise.resolve(e)),e=>(u.c.error("Retrieve record operation failed for client api "+Object(ae.e)(e)),Promise.reject(e))),e=>(u.c.error("Retrieve query option not valid with error "+Object(ae.e)(e)),Promise.reject(e))):(u.c.info("oDataQueryRetrieveOptions is null in Retrieve for client api "),Promise.resolve({}));case 5:const g=new We(o);return g?Object(_e.g)(r,n,g,e).then(()=>Object(ue.b)(n,g,s,e).then(e=>(u.c.info("Retrieve multiple record operation successful for client api "),Promise.resolve(e)),e=>(u.c.error("Retrieve Multiple query option not valid with error "+Object(ae.e)(e)),Promise.reject(e))),e=>(u.c.error("Retrieve multiple record operation failed for client api "+Object(ae.e)(e)),Promise.reject(e))):(u.c.info("oDataQueryRetrieveMultipleOptions is null in Retrieve multiple for client api "),Promise.resolve({}))}},e=>Promise.reject(e)).catch(e=>Promise.reject(e))}var qe=r("aRLb");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let ze;class Ye{constructor(e,t){ze=e,this._pageId=t}retrieveRecord(e,t,r){return Ge(ze,this._pageId,4,e,t,null,r)}createRecord(e,t){return Ge(ze,this._pageId,0,e,null,t).then(e=>this._toLookupValue(e))}updateRecord(e,t,r){return Ge(ze,this._pageId,1,e,t,r).then(e=>this._toLookupValue(e))}deleteRecord(e,t){return Ge(ze,this._pageId,3,e,t,null).then(e=>this._toLookupValue(e))}retrieveMultipleRecords(e,t,r){return Ge(ze,this._pageId,5,e,null,null,t,r).then(e=>({entities:e.value,nextLink:e["@odata.nextLink"]}))}execute(e,t){const r=[];let n=null;t&&"EntityLogicalName"in t&&(n=t.EntityLogicalName,r.push({name:"entityName",value:n}));const a=e.getMetadata().operationName;return Object(ee.d)(ze,a,n).then(i=>{if(i)return ze.dispatch(Object(qe.c)(e)).then(()=>ze.dispatch(Object(ee.h)(n,a,e,t)).then(e=>Object(ee.a)(e)));r.push({name:"requestName",value:a});const o="This request is not supported when offline";throw te.a.getInstance().traceManager.getTracer("ClientApi.XrmWebApiOfflineInternal.execute").error(o,r),Object(re.d)(`${o}: ${a}`,2147762446,r)})}isAvailableOffline(e){return Object(g.l)(ze.getState(),e)}_toLookupValue(e){return{id:e[oe.b.Id].toUpperCase(),entityType:e[oe.b.LogicalName]}}}var Xe=r("3bXk"),He=r("EW4s"),Ke=r("l0Rp"),Qe=r("ATrR"),Je=r("Uv1Y"),$e=r("eeMP"),Ze=r("16wZ"),et=r("FZDd"),tt=r("SRlt"),rt=r("pEXn"),nt=r("lEp6"),at=r("JdSN"),it=r("RiLc");function ot(e,t){return{type:"offline.noncud.upsync.async",execute({dispatch:r,getState:n},a){const i=[],o=[],s=a.TraceManager.getTracer("Offline.Upsync");if(!e)return s.error("OFFLINE: OfflineNonCUDUpsyncAsyncAction: executeNonCUDUpSyncRequest: Required parameter is null or undefined : Command.ActionData"),Promise.reject(new Je.a("Required parameter is null or undefined : ActionData"));s.warn("OFFLINE: OfflineNonCUDUpsyncAsyncAction: executeNonCUDUpSyncRequest: Adding parsed actionData to the serialized request array.");const l=[JSON.parse(e)];o.push({[rt.b.ActionType]:Object(u.b)(l)});const _=[];return t&&Object.keys(t).forEach(e=>{_.push(((e,t)=>r(Object(et.f)(e,!1,["versionnumber"])).then(()=>(s.warn("OFFLINE: OfflineNonCUDUpsyncAsyncAction: executeNonCUDUpSyncRequest: Adding RetrieveRequest for "+e+" to the serialized request array."),l.push(Object(Qe.a)(n(),new ne.a(e,new c.a(t)),["versionnumber"])),Promise.resolve()),e=>Promise.resolve()))(t[e],e)),o.push({[rt.b.EntityName]:t[e],[rt.b.ActionType]:"Get",[rt.b.Id]:e})}),i.push({name:rt.b.ActionList,value:Object(nt.b)(o)}),Promise.all(_).then(()=>{s.warn("OFFLINE: OfflineNonCUDUpsyncAsyncAction: executeNonCUDUpSyncRequest: Building a batch request for the serialized requests.");const e=Object(Ke.a)(n(),l);return s.warn("OFFLINE: OfflineNonCUDUpsyncAsyncAction: executeNonCUDUpSyncRequest: Sending batch serialized request to be executed on OData endpoint."),a.DataSource.get_WebAPIService().sendRequest(e,i).then(e=>Object($e.b)(e).then(e=>{if(null!=e&&e.length>0){const t=e.find(e=>!e.ok);return t?tt.c.throwCrmErrorFromResponse(t):(s.warn("Upsync.Success.NonCud",i),e)}})).catch(e=>e instanceof at.a?Object(Ze.c)({dispatch:r,getState:n},e).catch(t=>(e.set_organizationServiceFault(it.b.parseFromJsonRecord(t)),Promise.reject(e))):Promise.reject(new at.a(null,"error",Object(ae.e)(e))))}).catch(e=>(Object(u.a)(i,e),s.error("Upsync.Failure.NonCud",i),e instanceof at.a?Promise.reject(e):Promise.reject(new at.a(null,"error",e.get_error()))))}}}var st=r("17x/"),lt=r("4Us1");var ct=r("smSa"),_t=r("69Qu"),ut=r("yRo8"),dt=r("wyQO"),pt=r("ml6Y");function ft(){return{type:"set.entity.plural.name.action",execute({dispatch:e,getState:t},r){const n=Object(i.b)(t());if(Object(_.a)(n)||0===n.length)return Promise.resolve();let a=!1,o=Object(g.f)(t());o=Object(_.a)(o)?{}:o;const s=function(e){const t={};for(const r in e){t[e[r][b.ENTITY]]=r}return t}(o),l=[];for(const t of n)Object(_.a)(s[t])&&l.push(e(Object(et.f)(t,!1,null)));return Promise.all(l).then(()=>{const i=t();for(const e of n)if(Object(_.a)(s[e])){const r=Object(le.h)(i,e),n={};if(Object(_.a)(r)||Object(_.a)(r.ObjectTypeCode)||Object(_.a)(r.EntitySetName)){const r=Object(le.h)(t(),e)?Object(le.h)(t(),e).Id:null;u.c.error("Offline: OfflineEntityPluralNameAsyncAction: setOfflineEntityPluralNameAction: couldn't get the entity descriptor for "+r)}else n[b.ENTITY]=e,n[b.OBJECTTYPECODE]=r.ObjectTypeCode.toString(),o[r.EntitySetName]=n,u.c.info("Offline: OfflineEntityPluralNameAsyncAction: setOfflineEntityPluralNameAction: successfully got the metadata for "+e),a=!0}for(const e in s)n.indexOf(e)<0&&(delete o[s[e]],a=!0);return a&&!Object(_.a)(o)&&Object.keys(o).length>0&&(e(Object(A.b)(o)),r.DataSource.saveSessionState(pt.a.OfflineEntityPluralNamesKey,o,!1)),u.c.info("Offline: OfflineEntityPluralNameAsyncAction: setOfflineEntityPluralNameAction: Complete"),Promise.resolve()}).catch(e=>(u.c.error("Offline: OfflineEntityPluralNameAsyncAction: setOfflineEntityPluralNameAction: failed with error "+Object(ae.e)(e)),Promise.reject(e)))}}}var mt=r("uIhY"),gt=r("Lyxw"),ht=r("pF61"),bt=r("tHtE"),St=r("E5IU"),Ot=r("RADj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const yt=["_common.styles.duration.htc_71","D1A3FDEE-DE35-43E0-8D04-629726F19C08","2C5BD24E-AF86-4179-9865-52359439BD0E","BE995A69-9CC9-4507-80E3-F46BD0797510","C9A1167E-2464-4E5C-A0B4-872B05B8F667","56796A28-3D03-49E0-8A96-78F796BB0E44","826F4F88-FF87-479D-B0CA-4CA19E481E53","Language_1025","Language_3076","Language_2052","Language_1028","Language_1029","Language_1030","Language_1043","Language_1033","Language_1035","Language_1036","Language_1031","Language_1032","Language_1037","Language_1038","Language_1040","Language_1041","Language_1042","Language_1044","Language_1045","Language_1046","Language_2070","Language_1049","Language_3082","Language_1053","Language_1054","Language_1055","Settings_App_Version","Settings_Brand_Title","Settings_Build_Timestamp","Settings_Client_Session_Id","Settings_Client_Version","Settings_Host_Session_Id","Settings_Host_Context_Id","Settings_Host_Version","Settings_Current_Time","Settings_ExternalCorrelation_Id","Settings_Last_Commit_Version","Settings_License_Terms","Settings_Oct2019_Preview_Notification","Settings_Apr2020_Preview_Notification","Settings_Oct2020_Preview_Notification","Settings_Org_Name","Settings_Preview_Notification","Settings_Privacy_Statement","Settings_Privacy_Statement_Link","Settings_Privacy_Statement_Link_Online","Settings_Server_Version","Settings_Server_Version_Format","ActivityContainerControl.SubjectEllipsesText","Web.Visualization.AxisTitle","Web.Visualization.AxisTitle.DateGrouping","Web.Visualization.EmptyAxisLabel","Web.Visualization.AxisTitle.AVG","Web.Visualization.AxisTitle.SUM","Web.Visualization.AxisTitle.COUNT","Web.Visualization.AxisTitle.COUNTCOLUMN","Web.Visualization.AxisTitle.CurrencySymbol","Web.Visualization.AxisTitle.DateGrouping.DAY","Web.Visualization.AxisTitle.DateGrouping.FISCALPERIOD","Web.Visualization.AxisTitle.DateGrouping.FISCALYEAR","Web.Visualization.AxisTitle.DateGrouping.MONTH","Web.Visualization.AxisTitle.DateGrouping.QUARTER","Web.Visualization.AxisTitle.DateGrouping.WEEK","Web.Visualization.AxisTitle.DateGrouping.YEAR","Calendar_Short_Months","Web.Visualization.Year.Quarter","Web.Visualization.Year.Week","FiscalYear_Format_String_NoSpace","PageLoadingMessage","Chart_NoData_Message","Chart_NoReadPrivilege","Chart_UnavailableOffline","Chart_UnreadableDefinition_Title","Chart_UnreadableDefinition_Message","Chart_Unsupported_Message","Chart_Retrieve_Error_Message","CRM_Personal_Visualization_Group_Name","CRM_System_Visualization_Group_Name","Visualization_EmptyGridMessage","OpenAssociatedGridViewImageButtonTooltip","OpenAssociatedGridViewImageButtonText","Error_Message_0x80061721","ChartAttributeValueMissing","Chart_Unsupported_Title","Error_Message_0x80048306","Error_Message_0x80040226","Visualization_QueryApiMessage","Error_Message_0x8004e023","Web.Visualization_Invalid_Attribute","Error_Message_Visualization_SQLArithmeticOverflow","Error_Message_Visualization_Not_Found","Web.Visualization_Invalid_Aggregate_Type","Error_Message_Visualization_Navigation","Error_Message_Visualization_Navigation_Detail","A4A4842B-7564-4BCF-B21D-4D6A78F17BE1","Error_Message_0x8004410e","Error_Message_0xffffe4a5","AppModule.APIError","Error_Title_Generic","Command_Flyout_Back","More_Commands","Ribbon_Menu_More","No_Options_Available","Web.CommandBar.ErrorLoading_Message","Web.CommandBar.Loading_Message","Web.CommandBar.MoreCommands_ToolTip","Command_Bar_Label","MenuItem_Label_Actions","CC_Error_Loading_Control","ErrorPopup.ErrorCode","ErrorPopup.SessionId","ErrorPopup.ActivityId","ErrorPopup.RequestId","ErrorPopup.Timestamp","ErrorPopup.ErrorDetailsLabel","Button_Label_OK","Error_Message_Incorrect_Error_Code","Error_Title_0x8004b056","Error_Title_0x80700000","Error_Title_0x8005e00c","Error_Title_Generic","L_Client_Session_Id","L_Correlation_Id","L_Current_Time","L_Server_Activity_Id","L_Show_Details_Text","L_Help_Label_Text","Web.Dialog.ErrorCode_Caption","Custom_Event_Event_Name","Custom_Event_WebResource_Name","Custom_Event_Solution_Name","Custom_Event_Publisher_Name","Area_Label_OtherContacts","Area_Label_ProductBundles","AsyncOperationAreaTitle","Audit.Incontext.AreaTitle","Button_Cancel","Button_Label_Close","Button_Label_Save_Footer","Button_Label_SaveContinue","Dialog_Button_DiscardChanges","Button_Label_SaveClose","CC_Duration_Day","CC_Duration_Days","CC_Duration_Hour","CC_Duration_Hours","CC_Duration_Minute","CC_Duration_Minutes","Crm.GenericErrorMessage","CRM_System_View_Group_Name","CRM_User_View_Group_Name","Dialog_Label_Active","Dialog_Label_Inactive","DocumentManagement.Navigation.Documents","Duplicates_Detected_Notification_Message","Duplicates_Ignore_And_Save","Duplicates_View_Duplicates","Error.ReadOnlyEntity","Error_Text_FormToastNotification","Error_Title_0x80040220","Error_Title_0x8004b056","Error_Title_0x8063111b","Flyout.KeyboardShortCut.Tab.NotAllowed","Footer_Caption","Footer_StatusControl_Save_ToolTip","Form_PopOut","FormEditor_Nav_ProcessSessions_Label","FormEditor_Nav_Workflows_Label","FormToastNotification_Success_Save_Message","Header_Fields_Label","ImportFailures_View","L_Create_And_Close_Button_Text","L_List_No_Records_Text","L_Lookup_New_Text","Local_Save_Record_Notification_Status_Message","LOCID_RESOLVE_INFO_TEXT","LOCID_RESOLVE_WARNING_TEXT","MA.List.ListMember.Details.MarketingList","MenuItem_Label_AddObject","MenuItem_Label_SaveAndNew","MenuItem_Label_SaveClose","FormDesigner.PropertiesTab.Options","NamePlural_Prod","NavBar_DetailedPage_Area_CS_SM","NavBar_DetailedPage_Area_IMA","NavBar_DetailedPage_Area_Info","NavBar_DetailedPage_Area_MA","NavBar_DetailedPage_Area_PROC","NavBar_DetailedPage_Area_PROCESS","NavBar_DetailedPage_Area_SFA","Object_Plural_Member","Object_Plural_Substitute","PageLoadingMessage","PageLoadingMessage.ExecuteOnload","PageLoadingMessage.RequestingData","PageLoadingMessage.RequestingDataFromExternalSource","ProcessControl.Configurator.Collapse","ProcessControl.Configurator.Expand","ProcessControl.Notification","ProcessControl.NotificationCount","ReadOnly","RecordSetNavigator.Button.Close.Tooltip","RecordSetNavigator.button.name","RecordSetNavigator.Button.Open.Tooltip","Related_Tab_Label","Role_Editor_Row_Name_Quick_Create","SavingInformation","SharePoint.Form.Saving","SolutionWizard.Button.Export.Tooltip","Tab_Label_Connections","Tab_Label_FeedBack","Tab_Label_History","Tab_Label_PlanningTasks","Tab_Label_RelatedCampaigns","Tab_Label_ResourceGroups","Tab_Label_Services","Tab_Label_TargetLists","Tab_Label_TargetProducts","Tab_Label_WebLeads","Tab_Label_Working_Hours","TabFlyout.KeyboardShortCut.Area","TabFlyout.KeyboardShortCut.Down","TabFlyout.KeyboardShortCut.Enter","TabFlyout.KeyboardShortCut.Escape","TabFlyout.KeyboardShortCut.Up","ToastNotification_Error","ToastNotification_Information","ToastNotification_Warning","UnSavedChangesWarning","Web.Form.RecordSave.Success","Web.NavBar.Go_Back","Web.NavBar.QC_ViewRecord","Web.Tools.FormEditor.TabName","AppDurationControl_Minute","AppDurationControl_Minutes","AppDurationControl_Hour","AppDurationControl_Hours","AppDurationControl_Day","AppDurationControl_Days","Error_Message_Double_Save","FooterFields.KeyboardShortCut.Area","FooterFields.KeyboardShortCut.Escape","FooterFields.KeyboardShortCut.Down","FooterFields.KeyboardShortCut.Up","Web.Footer.MoreFields","Grid_Paging_Mask","Error_Message_Generic_Mobile_Client","Error_Message_Generic","Error_Message_Generic_Instruction","Error_Message_0x8063111b","Error_Message_0x80040217","Web.NavBar.BreadCrumbBar_Text","UnSavedChanges_Title","Grid.Search.ViewTitle.Format","Error_Title_0x83215600","Error_Title_0x83215601","Error_Title_0x83215602","Error_Message_0x83215600","Error_Message_0x83215601","Error_Message_0x83215602","Web.Tabs.MoreTabs","Web.SemanticZoom.Button","Web.Form.EditForm.Label","Web.Header.MoreFields","HeaderFields.KeyboardShortCut.Escape","HeaderFields.KeyboardShortCut.Area","HeaderFields.KeyboardShortCut.Down","HeaderFields.KeyboardShortCut.Up","HeaderFields.More.Error","Field.Required.Error","Field.Number.Error","Field.Currency.Error","Field.Email.Error","Field.Guid.Error","Field.Information.SelectParent","Field.Information.IncompleteChain","Form_NameValuePair","Form_NotificationLabel_NameValuePair","L_InteractionWall_Title","Button_Label_Save","ConfirmSave_DiscardButton","Button_Label_Continue","Error_Title_0x83215607","Error_Message_0x83215607","Form_File_Uploading_Message","Form_Image_Uploading_Message","Form_Image_File_Upload_Fail_Message","Form_File_Upload_Cancelled_Message","Form_Image_Upload_Cancelled_Message","Model_Form_Component_No_Bound_Record_Message","Model_Form_Component_Loading_Message","Model_Form_Component_Unsaved_Linked_Data_Message","Model_Form_Component_Unsaved_Linked_Data_Title","Error_Message_0x80040507","Error_Message_0x80040333","Error_Title_0x80040265","Error_Message_0x80040265","Error_Message_0x80040224","Error_Message_0x80040e01","Error_Message_0x80041102","Error_Message_0x80042f0a","Error_Title_0x80060501","Error_Message_0x80060501","Error_Title_0x83215605","Error_Message_0x83215605","Error_Title_0x83215606","Error_Message_0x83215607","Error_Message_0x83215610","Web.NavBar.Go_Back","Web.NavBar.Help_Desc","Web.NavBar.Help_Title","Web.NavBar.Home_Desc","Web.NavBar.Home_Title","Web.NavBar.ImmersiveSkype_Desc","Web.NavBar.ImmersiveSkype_Title","Web.NavBar.Immersive_Skype_Caption","Web.NavBar.OfflineStatus_Desc","Web.NavBar.OfflineStatus_Title","Web.NavBar.Offline_Status_Caption","Web.NavBar.QuickCreateMenu_Desc","Web.NavBar.QuickCreateMenu_Title","Web.NavBar.Quick_Create_Menu_Caption","Web.NavBar.Relationship_Assistant_Caption","Web.NavBar.Relationship_Assistant_Desc","Web.NavBar.Relationship_Assistant_Title","Web.NavBar.Search_Desc","Web.NavBar.Search_Title","Web.NavBar.SeeWelcomeScreen_Desc","Web.NavBar.SeeWelcomeScreen_Title","Web.NavBar.See_Welcome_Screen_Caption","Web.NavBar.Settings_Caption","Web.NavBar.Settings_Desc","Web.NavBar.Settings_Title","Web.NavBar.Start_Task_Flow_Caption","Web.NavBar.TaskFlow_Desc","Web.NavBar.TaskFlow_Title","Web.NavBar.User_Information_Caption","Web.NavBar.User_Information_Desc","Web.NavBar.User_Information_Title","Web.NavBar.SiteMap","Web.NavBar.SettingsOpenNavTour_Caption","Web.NavBar.SettingsLearningPath_OptIn_Caption","Web.NavBar.SettingsLearningPath_OptOut_Caption","Web.NavBar.UserInfoEditImage_Caption","CRM_System_View_Group_Name","OpenAssociatedGridViewImageButtonTooltip","OpenAssociatedGridViewImageButtonText","OpenAllRecordsViewImageButtonText","OpenAllRecordsViewImageButtonToolTip","FormEditor_Default_Tab","Web__common_error_scriptError_aspx_Text0","CRM_User_View_Group_Name","Error_View_NotAvailable","Error_Entity_NotAvailable","Grid_Title_JumpBar_All","Grid_Selection_JumpBar_All","Grid_JumpBar_Number_ToolTip","Grid_JumpBar_Number_Indicator","Grid_JumpBar_Alphabet","Grid_Title_JumpBar_Letter","Grid_See_More_Tool_Tip","RollupView_Switch_On","RollupView_Switch_Off","RollupView_Switch_Label","CRM_Create_View","CRM_Create_View_Tooltip_Title","CRM_Create_View_Tooltip_Description","Web.View_Label_ViewByDate","GridFilters_SelectAll","ActivityMgmt_Label_ViewByActivityType","ActivityMgmt_Label_ViewByDate","Workplace_Queue_Selector_Title","Error_Message_0x80040226","Grid_Generic_Unknown_Error","CustomControl_Calendar_ErrorView_DefaultMessage","AdvancedFindSearchResultsViewName","Button_ToolTip_Go","Button_ToolTip_Clear","Field_Label_Find","Field_Label_Search_This_View","Field_Label_Search_Quick_Find_View","Search_Label_Search","View_Title_Tooltip","OnDefaultViewToolTip","SetDefaultViewToolTip","ttv_homepage_button_hideChart","ttv_homepage_button_showChart","Display_Entity_dashboard","Grid_JumpBar_AriaLabel","Grid_JumpBar_SelectedFilter","Grid_JumpBar_FilterBy_AriaLabel","Grid_JumpBar_Number_AriaLabel","Grid_JumpBar_Close_AriaLabel","Error.NonUCIEntity","JumpBar_Button_Text","Grid_Paging_Mask","Grid_StatusMessage_Mask","Grid_ItemsSelected_Mask","Grid_TotalCount_Mask","Grid_ToolTip_FirstPage","Grid_ToolTip_PreviousPage","Grid_ToolTip_NextPage","Grid_TotalCount_SpaceMask","Grid_TotalCount_Approximate","Grid_TotalCount_Exact","Grid_See_More_Label_Text","PickList_DateFilter_All","PickList_DateFilter_Next12Months","PickList_DateFilter_Next30Days","PickList_DateFilter_Next6Months","PickList_DateFilter_Next7Days","PickList_DateFilter_Next90Days","PickList_DateFilter_Overdue","PickList_DateFilter_Today","PickList_DateFilter_Tomorrow","PickList_Language_All","MobileClient.Commands.ChangeControl","Grid_See_All_Tool_Tip","Grid_See_All_Label_Text","Button_Label_Cancel","Menu_Label_MoreActions","Button_Label_Cancel","Button_Label_OK","Leave_Page_Text","Leave_This_Page","CustomControl_MaxLengthExceeded_Error","Invalid_Date_Time","Invalid_Decimal","IW_ExportTemplate_MaxValue","IW_ExportTemplate_MinValue","jqGrid.strings.integer","L_IsRequired_Error_Message_Text","Web._forms.styles.INPUT.eml.htc_20","Available_Offline","InteractionCentricUserEducation_SyncStep2","L_Initializing","L_Last_Save_To_CRM_Server_Text","L_Metadata_Changed","L_Metadata_Changed_Text","L_Offline_Available","L_Offline_Not_Available","L_Offline_DB_Not_Available","L_OfflineProfile_Not_Available","L_Sync_Failure","L_Upgrade_Client","Settings_Offline_DisableSync_Information_Message","Metadata_Dialog_Button_Skip","Metadata_Dialog_Button_Update","Metadata_Download_Confirmation","UC_Download_Metadata_Message","Not_Available_Offline","Sync_Status_Dialog_Title","Sync_Status_Error_Message","Error_See_More_Details_Grid","Grid_Loading_Placeholder","View_NotAvailable_In_Offline","Sql_Query_Not_Available","Entity_Not_Available_In_Profile","Offline_Not_Ready_For_Usage","Linked_Entity_Not_Supported_In_Offline","Activity_Entity_Not_Supported_In_Offline","Error_Message_Delete_Multiple_Offline","ServerUnavailableNotification_Title","ServerUnavailableNotification_Message","L_Reconnect_Text","Error_Message_0x8005f211","Error_Title_0x8005f211","offline_notification_text_header","offline_notification_text_body","offline_ui_blocker_notification_text_header","offline_ui_blocker_notification_text_body","offline_notification_reconnect_btn_text","offline_notification_cancel_btn_text","offline_notification_reconnect_fail_text_body","offline_notification_reconnect_progress_indicator_text","offline_notification_reconnect_success_text","Error_Parent_Record_AlreadyExists","offline_notification_user_offline_mode_text","Accessibility_Switch_On","Accessibility_Switch_Off","ToggleOption_title","progress_cancelButton_Label","Download_Progress_Spinner_Label","MoCA_OWA_Client_Download_Metadata_Message","Offline_Status_Dialog_Title","Button_Label_Download_Offline_Metadata","Status_Label","Learn_More_Label","Learn_More_Link_Label","Learn_More_Link_Accessibility_Label","Available_Entities_Label","Not_Available_Entities_Label","Available_Entities_Aria_Label","Not_Available_Entities_Aria_Label","CustomControl_OfflineEntities_InitialDataDownLoadErrorMessage","CustomControl_OfflineEntities_EstimatedTimeLeftLabel","Entity_Header_Label","Last_Sync_Date_Label","Last_Sync_Date_Today_Label","Last_Sync_Date_Yesterday_Label","Last_Sync_Date_At_Label","First_Sync_Complete_Notification","First_Sync_Complete_Notification_Offline_By_Default","Request_Apply_Metadata_Notification","Metadata_Download_Notification","Download_Progress","Offline_Date_Update_Completed","L_Offline_Updating","Available_Offline","MultiSession.NavigateBackButtonTooltip","MultiSession.NavigateBackButtonAriaLabel","Brand_CRM","Change_App_ToolTip","Brand_CRM_Desc","Brand_CRM_Short","Brand_CRM_Online","Brand_PowerApps","InteractionCentricNavBar_QuickCreate_Activities","Navigation_Area_Tooltip","Not_Available_Offline","ResourceCenter_Area_ToolTip","Web.NavBar.All_Areas","Web.NavBar.AppSwitcher_Caption","Web.NavBar.Back_Caption","Web.NavBar.Close_Site_Map","Web.NavBar.Favorites_And_Recent","Web.NavBar.HomeArrow_Caption","Web.NavBar.Navigate_Dynamics365","Web.NavBar.NavigationTip","Web.NavBar.Preview_Watermark_Caption","Web.NavBar.Sandbox_Watermark_Caption","Web.NavBar.Switch_App_Text","Web.NavBar.FocusMainPageContent_Text","SITEMAP_SUBACTION_NOTIFIER","SITEMAP_RECENT_PIN","SITEMAP_RECENT_UNPIN","SITEMAP_RECENT_ENTRY_PINNED","SITEMAP_RECENT_ENTRY_UNPINNED","SITEMAP_RECENT_PIN_BUTTON_LABEL","SITEMAP_RECENT_UNPIN_BUTTON_LABEL","SITEMAP_GROUP_FAVORITES","SITEMAP_GROUP_RECENTLY_USED","SITEMAP_APPS_BUTTON","Mru_Entity_Expand_Tooltip","Mru_Entity_Collapse_Tooltip","SitemapDesigner.Processing","Web.SitemapPanel.Recent","Web.SitemapPanel.Pinned","Web.SitemapPanel.PinnedStatus","Web.SitemapPanel.UnPinnedStatus","Web.SitemapPanel.NoRecentMessage","Web.SitemapPanel.NoPinnedMessage","Web.SitemapPanel.PinAriaLabel","Web.SitemapPanel.UnpinAriaLabel","Web.SitemapPanel.UnpinnedItemTooltip","Web.SitemapPanel.PinnedItemTooltip","Web.SitemapPanel.RecentItems","Web.SitemapPanel.PinnedItems","Web.SitemapPanel.ChangeAreaLabel","Web.SitemapPanel.AreaSwitcherTooltip","Web.SitemapPanel.AreaPaneLabel","Web.SitemapPanel.Recent.ExpandTooltip","Web.SitemapPanel.Recent.CollapseTooltip","Web.SitemapPanel.Pinned.ExpandTooltip","Web.SitemapPanel.Pinned.CollapseTooltip","Button_Label_Cancel","Dialog_Button_Ok","show.unsaved.changes.dialog.async","UnSavedChangesWarning","Web._forms.styles.FORM.crm.htc_Title","Web._forms.styles.FORM.crm.htc_TitleUpdated","UnSavedChanges_TitleUpdated","Button_Label_Keep_Editing","Discard_Message_Create","Discard_Message_Edit","Error_Entity_Not_Allowed","Error_Invalid_Value_For_Attribute","Error_UnexpectedError","Error_SQLExecutionError","Error_SQLGenerationError","Error_Record_NotFound","Error_RetrieveQuery_Option_NotSupported","Error_QueryOption_NotSupported","Error_NoQuery_Options_WithFetchXml","Error_FetchXml_Is_Invalid","Error_OrderByDirection_Is_Invalid","Error_TopQuery_Is_Invalid","Error_Entity_NavigationProperty_Is_Invalid","Error_Entity_NavigationProperty_Not_Defined","Error_QueryOption_Is_Invalid","Error_QueryOption_Is_Null","Error_Invalid_QueryOption_String","Error_Entity_Metadata_Not_Found","Error_Entity_Unavailable_Metadata_Mismatch","Error_Entity_Not_Enabled","Error_Invalid_Entity_Name","Error_Offline_Attribute_Not_Supported","Error_Invalid_Attribute","Error_Entity_Attribute_Metadata_Not_Found","Error_Operation_Without_Privilege","Error_OptionParam_Start_Incorrect","Error_Max_PageSize_NonPositive","Error_Max_PageSize_Not_Number","Error_Invalid_Id_Guid","Error_Invalid_Field_Value","Error_Mandatory_Parameter_IsNull","Error_MobileOffline_DataStore_Unavailable","Error_MobileOffline_Feature_Unavailable","Error_User_Opted_Off","Error_Offline_FCB_Off","Web__common_error_scriptError_aspx_BtnSendReport","Web__common_error_scriptError_aspx_BtnDoNotSendReport","Web__common_error_scriptError_aspx_Text1","Web__common_error_scriptError_aspx_Message","Web_Tools_personalsettings_dialogs_personalsettings_PrivacyTab_ViewPrivacy","Web__common_error_scriptError_aspx_ViewDetails","Mobile__common_error_scriptError_aspx_ViewHowToChangeSettings","Web__common_error_scriptErrorDetails_aspx_Title","Web__common_error_scriptErrorDetails_aspx_FirstLineOfReport","App_Modules_SubArea_Title","AppModuleLandingPage.PublishedAppsFilterText","AppModuleLandingPage.SearchMyApps","AppModuleLandingPage.NoApps","AppModuleLandingPage.NoAppsFoundChangeSearchCriteriaText","AppModuleLandingPage.NoOfflineApps","AppModuleLandingPage.NoMatchingSearch","CRM_Dynamics_Community","CRM_System_Dashboards_Group_Name","CRM_User_Dashboards_Group_Name","CRM_No_Dashboards_Group_Name","DashBoard_Selector_Text_UClient","Ribbon.DashboardTab.Actions.Refresh.Label","Ribbon.DashboardTab.Actions.OpenInPbi.Label","Ribbon.DashboardTab.Actions.UserDefault.Label","Ribbon.DashboardTab.Actions.ClearDefault.Label","Display_Entity_Grid_Page","Dashboard_LiveRegion_DateRangeFilter_Message","Dashboard_LiveRegion_Filter_Removed_Message","Dashboard_LiveRegion_GlobalFilter_Applied","Dashboard_LiveRegion_Initial_Message","Dashboard_LiveRegion_StreamView","Dashboard_LiveRegion_TileView","Dashboard_LiveRegion_VisualFilter_Applied","Dashboard_Tier2_TilesView_Title","VisualFilter_Expand_UClient","VisualFilter_Collapse_UClient","Queue_Panel_Switch_TileView_Text","Queue_Panel_Switch_StreamView_Text","GlobalFilter_Clear","GlobalFilter_CloseFilterPanel","GlobalFilter_Cancel","GlobalFilter_Filters","GlobalFilter_OpenFilterPanel_UClient","GlobalFilter_CloseFilterPanel_UClient","GlobalFilter_No_Attributes","GlobalFilter_ExpandAll","GlobalFilter_CollapseAll","GlobalFilter_Apply","Error_Message_0x8005f213","Error.BoundDashboardOffline","SliderControl_ClearButton","ViewSelectorAllActivities","ButtonText_ViewSyncErrors","DialogTitle_UnResolvedSyncErrors","Offline_SyncError_Records_Warning_Message","ButtonText_Signout","ButtonText_Reconfigure","DialogTitle_UnSyncedRecords","Offline_Records_Warning_Message","Ribbon.DashboardTab.Management.Edit.Label","Ribbon.DashboardTab.Management.Delete.Label","Ribbon.DashboardTab.Actions.Share.Label","Ribbon.DashboardTab.Actions.Assign.Label","Ribbon.DashboardTab.Management.SaveAs.Label","Dialog_Delete_Title","Dialog_Delete_Description","Dialog_Assign_Title","Dialog_Assign_DescriptionSingular","RelatedInformation_Category_FollowUp_Label_AssignTo","SystemCustomization.OwnershipType.UserOwned","Button_Label_Delete","Button_Label_Cancel","Button_Label_Assign","Error.DashboardNoComponents","Error.DashboardUnsupportedComponents","Search_Page_Title","Search_SearchWith_Label","Search_FilterWith_Label_No_Colon","Search_FilterOption_None","Ribbon.AdvancedFind.Show.Results","Web.Tools.personalsettings.dialogs.personalsettings.aspx_213","Web.Tools.personalsettings.dialogs.personalsettings.aspx_212","Search_Noresults_Message","Search_TextInput_Placeholder","Search.Accessibility.Multiple_CategorizedSearchResult","Search.Accessibility.Single_CategorizedSearchResult","Search.Accessibility.ResultLoading","Search_FilterWith_Label_No_Colon","Facet_RecordType","Facet_CreatedOn","Facet_ModifiedOn","Facet_Owner","ReportViewer_PageOf","Search.Accessibility.Search_box","Microsoft_Support","Form_Notification_ErrorLabel","Search.Accessibility.Scan_Barcode","Search.Accessibility.Barcode_Scanned","Search.Accesibility.ViewPreviousPage","Search.Accesibility.ViewNextPage","Button_Label_Add","Dialog_Lookup_Title_Multiple","Dialog_Lookup_Description_Single","TaskBasedFlow_Menu_Loading_Text","TaskBasedFlow_Menu_Empty_Text","TaskBasedFlow_Menu_Header_Text","Mobile_TaskBasedFlow_AppLauncher_Offline","Dialog_Reauthenticate_Dialog_Expired_Description","Dialog_Reauthenticate_Dialog_Description","Dialog_Reauthenticate_Signin_Button","Dialog_Reauthenticate_Cancel_Button","Dialog_Reauthenticate_Close_Button","Error_Message_0x80042F09","Error_Message_0x80042f0c","Error_Message_0x80040225","Error_Message_0x8004032c","Error_Message_0x8005f215","Error_Message_0x80154b50","Error_Message_0x8004D24B","Error_Message_0x80072560","Error_Message_0x8004A104","Error_Message_0x8004a113","ErrorIconAltWarning","ErrorIconAltInformation","PersonalisationSettingHeader","Settings_Mobile_Settings","Settings_ToastNotification_Title","Settings_App_Page","Settings_About","Settings_License_Terms_Link_IPad","Settings_License_Terms_Link_IPhone","Settings_License_Terms_Link_Android","Settings_License_Terms_Link_AndroidPhone","Settings_License_Terms_Link_Windows","Settings_License_Terms_Link_WindowsPhone","Settings_Signout","Settings_Reconfigure","Settings_NativeApp_SettingsScreenTitle","Settings_NativeApp_ProfileScreenTitle","Settings_NativeApp_Personal","Settings_NativeApp_Personal_TimeZone","Settings_NativeApp_Personal_RecordsPerPage","Settings_NativeApp_Personal_Calendar","Settings_NativeApp_Personal_CalendarDefaultView","Settings_NativeApp_Personal_CalendarView_Day","Settings_NativeApp_Personal_CalendarView_Week","Settings_NativeApp_Personal_CalendarView_Month","Settings_NativeApp_Personal_WorkHours","Settings_NativeApp_Personal_WorkHours_Start","Settings_NativeApp_Personal_WorkHours_End","Settings_NativeApp_Device","Settings_NativeApp_Device_LocationAndContent","Settings_NativeApp_Device_LocationAndContent_LegalNotice","Settings_NativeApp_Device_Camera","Settings_NativeApp_Device_SavePhoto","Settings_NativeApp_Device_ImageResolution","Settings_NativeApp_Device_ImageResolution_Default","Settings_NativeApp_Device_IncreaseToastDuration","Settings_NativeApp_Device_OfflineSync","Settings_NativeApp_General","Settings_NativeApp_General_TermsOfUse","Settings_NativeApp_General_PrivacyStatement","Settings_NativeApp_General_SessionDetails","Settings_NativeApp_Status_Init","Settings_NativeApp_Status_InitError","Settings_NativeApp_Status_Offline","Settings_NativeApp_Status_SaveError","Settings_NativeApp_Alert_Title","Settings_NativeApp_Alert_Ok","Settings_NativeApp_Alert_Cancel","Settings_NativeApp_Screen_Back","Settings_NativeApp_Screen_Close","RecordClosed.SyncError.Notification.Error.Text","Ribbon.DashboardTab.Management.New.Label","Ribbon.DashboardTab.Management.New.ToolTipDescription","Ribbon.DashboardTab.Management.PowerBIDashboard.Label","Ribbon.DashboardTab.Management.PowerBIDashboard.ToolTipDescription","Ribbon.DashboardTab.Management.CRMDashboard.Label","Ribbon.DashboardTab.Management.CRMDashboard.ToolTipDescription","Inactivity_Dialog_Warning_Description","Inactivity_Dialog_Error_Description","Inactivity_Dialog_Continue_Button","ErrorIconAltWarning","ErrorIconAltInformation","CustomControl_Calendar_AllDayItem","CustomControl_Calendar_Today","CustomControl_Calendar_WeekView","CustomControl_Calendar_MonthView","CustomControl_Calendar_DayView","CustomControl_Calendar_ErrorView_DefaultMessage","CustomControl_Calendar_ViewMore","ProcessControl.RequiredStepTooltip","Settings_ToastNotificationDialog_Text_ToastNotifacation_Default","Settings_ToastNotificationDialog_Text_ToastNotifacation_Extended","SubArea_InvalidSitemapConfig_Error_Title","SubArea_InvalidSitemapConfig_Error_Message","AppModule.AccessDenied_Title","AppModule.AccessDenied_Message","TaskBasedFlow_Button_Next","TaskBasedFlow_Lookup_Label","Mobile_Error_On_Page_Message","Mobile_TaskBasedFlow_Error_When_Saving_Message","Mobile_TaskBasedFlow_UnableToSave_Message","Error_Title_0x80040220","Mobile_TaskBasedFlow_Offline_Title","Mobile_TaskBasedFlow_Offline_Message","Mobile_TaskBasedFlow_CloseDiscard_Text","Mobile_TaskBasedFlow_ReturnToTaskFlow_Text","Mobile_TaskBasedFlow_DiscardChanges_Text","Mobile_TaskBasedFlow_Error_When_Saving_Title","Mobile_TaskBasedFlow_Error_When_Saving_Message","TaskBasedFlow_Lookup_Label","TaskBasedFlow_Button_Next","Web.AppNavTour.Continue","Web.AppNavTour.DontShowAgain","Web.AppNavTour.DontShowAgainSmall","WelcomePageTitle","NavBar_DetailedPage_Area_AO","Error_Message_0x80061721","Error_Message_0x8005F249","Error_Message_0x8005F24A","Error_Message_0x8005F24B","Quick_Setup_Text","Quick_Setup_Visited_Text","Quick_Setup_Not_Visited_Text","Quick_Setup_Selected_Text","Close_Text","Previous_Text","Next_Text","Settings_Setup_Text","Menu_Text","Settings_Group_Text","App_Shell_Break_Point_Text","Collapse_Group_Text","Expand_Group_Text","Hide_Settings_Text","Show_Settings_Text","Quick_Setup_Close_Tooltip","PageLoadingMessage","offline.metadata.confirm.dialog.async","offline.metadata.downlaod.async","Update_Metadata_Prompt_Title","Workplace_Queue_Selector_All","Workplace_Queue_Selector_Public","Workplace_Queue_Selector_Private","Dashboard_Editor_Open_Title","Dashboard_Editor_Open_Message","Dashboard_Editor_Open_Confirm_Button","Dashboard_Header_Label","Command_Flyout_Loading","FlyoutButton.Aria.Description","Open_More_Flyout","Split_Button_More_Flyout","Split_Button","Ribbon.VisualizationTab.Management.Expand.Label","Side_Panel_Accessibility_Label","GlobalFilter_SaveFilter_Toast_Delete_Success","GlobalFilter_SaveFilter_Toast_Delete_Error","Ribbon.DashboardTab.Actions.YammerButton","QuickEditForm_MaxNumberReached_Title","Error_Message_0x80071156","NOTIFICATIONS_COUNT_MESSAGE_BAR","Form_ReadOnly_Notification_Message","Form_Notification_LongMessage_Expand_Text","Form_Notification_LongMessage_Truncate_Text","Form_ReadOnly_Status","Form_ReadOnly_Permissions_Entity","Form_ReadOnly_Permissions_Record","Form_ReadOnly_Offline","Error_Message_0x8005f1f5","Error_Message_0x8005f1f8","Error_Message_0x8005f1f9","Error_Title_0x80040217","Error_Message_0x8005f20c","Error_Title_0x8005f20c","Error_Message_0x8005f1fe","Error_Message_0x8005f1ff","Error_Message_0x8005f200","Error_Title_0x8005f206","Error_Message_0x8005f206","Error_Title_0x8005f207","Error_Message_0x8005f207","Error_Title_0x8005f208","Error_Message_0x8005f208","Error_Title_0x8005f209","Error_Message_0x8005f209","Error_Title_0x8005f20b","Error_Message_0x8005f20b","Error_Message_0x8005f1fd","Error_Title_0x80043e09","Error_Message_0x80043e09","Error_Title_0x80043e08","Error_Message_0x80043e08","Error_Message_0x8005f1fc","Error_Title_0x83215603","Error_Message_0x83215603","InlineEditControls.SelectToEnter","Web.NavBar.Back_Caption","UCI_LongPressHome_Hint","ActionCard.CFC.Menu.SendFeedback","Grid_AdvancedFilter_AdvancedFilters","GlobalFilter_Cancel","Button_Label_Apply","Web.SFA.Workflow.Variables.Add","MenuItem_Label_AddRow_SentenceCase","MenuItem_Label_AddGroup_SentenceCase","Web.SFA.Workflow.Variables.Delete","Web._controls.listedit.buttons.MoveUp","Web._controls.listedit.buttons.MoveDown_SentenceCas","Grid_AdvancedFilter_MakeGroup","AF_MenuItem_UnGroup","AF_Text_And","AF_Text_Or_SentenceCase","MenuItem_Label_AddRelatedEntity_SentenceCase","Grid_AdvancedFilter_RelatedEntityPlaceholder","Audit.Incontext.Filters.AttributesGroup","Web._tools.search.search.js_12_8_SentenceCase","Audit.Incontext.Filters.AttributesGroup","Grid_AdvancedFilter_DoesNotContainDataWarning","Grid_AdvancedFilter_ManyToOne","Grid_AdvancedFilter_OneToMany","Grid_AdvancedFilter_ManyToMany","Grid_AdvancedFilter_NoRelationships","AF_Aria_MoreCommands","AF_Aria_RowSelector","AF_Aria_GroupSelector","AF_MenuItem_Expand","AF_MenuItem_Collapse","AF_Aria_GroupExpand","AF_Aria_GroupCollapse","AF_Error_QuickFindView","Grid_AdvancedFilter_ErrorMalformed","Grid_AdvancedFilter_InvalidField","Grid_AdvancedFilter_FieldSelector","Web.SFA.Workflow.AssignValueDialog.Operator","SystemCustomization.BusinessRules.ConditionOperator.CONTAINS","SystemCustomization.BusinessRules.ConditionOperator.DOESNOTCONTAIN","SystemCustomization.BusinessRules.ConditionOperator.BEGINSWITH","SystemCustomization.BusinessRules.ConditionOperator.DOESNOTBEGINWITH","SystemCustomization.BusinessRules.ConditionOperator.ENDSWITH","SystemCustomization.BusinessRules.ConditionOperator.DOESNOTENDWITH","SystemCustomization.BusinessRules.ConditionOperator.NOTNULL","SystemCustomization.BusinessRules.ConditionOperator.ISNULL","CustomControl_Grid_Filtering_ConditionOperator_Equals","CustomControl_Grid_Filtering_ConditionOperator_DoesNotEqual","CustomControl_Grid_Filtering_ConditionOperator_Greater","CustomControl_Grid_Filtering_ConditionOperator_GreaterOrEqual","CustomControl_Grid_Filtering_ConditionOperator_Less","CustomControl_Grid_Filtering_ConditionOperator_LessOrEqual","ViewDesigner.RecordFilter.quarter","FiscalYear_Format_String_NoSpace","Web._tools.search.search.js_16_0","CustomControl_Grid_Filtering_ConditionOperator_OnOrAfter","ViewDesigner.RecordFilter.on_or_before","Web._tools.search.search.js_16_3","Web._tools.search.search.js_16_4","Web._tools.search.search.js_16_5","Web._tools.search.search.js_16_6","Web._tools.search.search.js_16_7_SentenceCase","Web._tools.search.search.js_16_8_SentenceCase","Web._tools.search.search.js_16_9_SentenceCase","Web._tools.search.search.js_16_10_SentenceCase","Web._tools.search.search.js_16_11_SentenceCase","Web._tools.search.search.js_16_12_SentenceCase","Web._tools.search.search.js_16_13_SentenceCase","Web._tools.search.search.js_16_14_SentenceCase","Web._tools.search.search.js_16_15_SentenceCase","Web._tools.search.search.js_16_16_SentenceCase","AF_Option_LastXHours_SentenceCase","AF_Option_NextXHours_SentenceCase","AF_Option_LastXDays_SentenceCase","AF_Option_NextXDays_SentenceCase","AF_Option_LastXWeeks_SentenceCase","AF_Option_NextXWeeks_SentenceCase","AF_Option_LastXMonths_SentenceCase","AF_Option_NextXMonths_SentenceCase","AF_Option_LastXYears_SentenceCase","AF_Option_NextXYears_SentenceCase","Search.Time.Range.Anytime","AF_Option_OlderThanXMinutes_SentenceCase","AF_Option_OlderThanXHours_SentenceCase","AF_Option_OlderThanXDays_SentenceCase","AF_Option_OlderThanXWeeks_SentenceCase","AF_Option_OlderThanXMonths_SentenceCase","AF_Option_OlderThanXYears_SentenceCase","AF_Option_InFiscalYear_SentenceCase","AF_Option_LastFiscalYear_SentenceCase","AF_Option_ThisFiscalYear_SentenceCase","AF_Option_NextFiscalYear_SentenceCase","AF_Option_LastXFiscalYears_SentenceCase","AF_Option_NextXFiscalYears_SentenceCase","AF_Option_InFiscalPeriod_SentenceCase","AF_Option_LastFiscalPeriod_SentenceCase","AF_Option_ThisFiscalPeriod_SentenceCase","AF_Option_NextFiscalPeriod_SentenceCase","AF_Option_LastXFiscalPeriods_SentenceCase","AF_Option_NextXFiscalPeriods_SentenceCase","AF_Option_InFiscalPeriodAndYear_SentenceCase","AF_Option_InOrAfterFiscalPeriod_SentenceCase","AF_Option_InOrBeforeFiscalPeriod_SentenceCase","Web._tools.search.search.js_17_4_SentenceCase","Web._tools.search.search.js_17_5_SentenceCase","AF_Option_EqUserLanguage_SentenceCase","Web._tools.search.search.js_17_0_SentenceCase","Web._tools.search.search.js_17_1_SentenceCase","Web._tools.search.search.js_19_1_SentenceCase","Web._tools.search.search.js_19_2_SentenceCase","Web.SFA.Workflow.UnderOperator","Web.SFA.Workflow.NotUnderOperator","ViewDesigner.RecordFilter.above","CustomControl_Calendar_ViewMore","ViewDesigner.RecordFilter.eq_or_above_SentenceCase","ViewDesigner.RecordFilter.eq_or_under_SentenceCase","OwnershipOperator_EqualsCurrentUserOrHierarchy_SentenceCase","OwnershipOperator_EqualsCurrentUserOrHierarchyAndTeams_SentenceCase","OwnershipOperator_EqualsCurrentUserTeams_SentenceCase","OwnershipOperator_EqualsCurrentUserOrUserTeams_SentenceCase","Grid_AdvancedFilter_LoadingResults","KMControl.SearchKMArticles.NoResults","AF_Error_NoValues","Web.SFA.Workflow.AssignValueDialog.Value","Dialog_Disassociate_Header","Grid_AdvancedFilter_NoValue","Grid_AdvancedFilter_MinValue","Grid_AdvancedFilter_MaxValue","Grid_AdvancedFilter_MaxPrecision","Grid_AdvancedFilter_MaxLength","Grid_AdvancedFilter_IncorrectDataType","Grid_AdvancedFilter_durationUnit","Grid_AdvancedFilter_ApplyAdvancedFiltersTitle","Grid_AdvancedFilter_ApplyAdvancedFiltersAriaLabel","Grid_AdvancedFilter_CancelEditingAdvancedFiltersAriaLabel","Grid_AdvancedFilter_OpenAdvancedFilterTitleAndAria","Error.Unsupported.Query.Operator","Error.Missing.Value.Attribute","Error.LinkedEntity.NotAvailable.Offline","Error.MainEntity.NotAvailable.Offline","RelatedMenu_LabelSource_RelationshipMetadata","RelatedMenu_LabelSource_EntityDisplayCollectionName","RelatedMenu_LabelSource_EntityDisplayName","RelatedMenu_LabelSource_ClientAPI","RelatedMenu_LabelSource_HardcodedRelationship","RelatedMenu_LabelSource_FormDescriptorForCurrentUserLanguage","RelatedMenu_LabelSource_FormDescriptorForBaseLanguage","RelatedMenu_LabelSource_FormDescriptorForEnglish","RelatedMenu_Displayed_SetByClientAPI","RelatedMenu_Displayed_SetInFormDescriptor","RelatedMenu_Displayed_SetInRelationshipMetadata","RelatedMenu_Displayed_HardcodedEntityAllowedInUCI","RelatedMenu_NotDisplayed_ShowNavigationItemsOptionDisabled","RelatedMenu_NotDisplayed_HardcodedEntityDisallowedInUCI","RelatedMenu_NotDisplayed_SetByClientAPI","RelatedMenu_NotDisplayed_NotEnabledForUnifiedClient","RelatedMenu_NotDisplayed_RelatedEntityNotInOfflineProfile","RelatedMenu_NotDisplayed_SetInFormDescriptor","RelatedMenu_NotDisplayed_SetInRelationshipMetadata","RelatedMenu_NotDisplayed_IsBPFEntity","RelatedMenu_NotDisplayed_SPDocumentNotConfigured","RelatedMenu_NotDisplayed_NotCustomOrConfigurableSystemRelationship","RelatedMenu_NotDisplayed_NoReadPermissionOnRelatedEntity","RelatedMenu_NotDisplayed_KnowledgeManagementNotEnabled","RelatedMenu_NotDisplayed_ConnectionEntityNotEnabled","RelatedMenu_NotDisplayed_ProcessionEntityCannotTriggerWorkflow","RelatedMenu_NotDisplayed_AsyncOperationEntityCannotTriggerWorkflow","RelatedMenu_NotDisplayed_AuditEntityIsNotCustomizable","RelatedMenu_NotDisplayed_ProductEntityAndRelatedEntityRelationshipNotValid","RelatedMenu_NotDisplayed_FeedbackEntityNotAllowedInUCI","RelatedMenu_NotDisplayed_HardcodedRelationshipNameAndReferencingEntityNotFound","RelevanceSearch.SearchResults","RelevanceSearch.TopResults","RelevanceSearch.ShowNumberOfResults","RelevanceSearch.ShowMore","RelevanceSearch.ShowLess","RelevanceSearch.NoResult","RelevanceSearch.TryDifferentKeyword","RelevanceSearch.ErrorTitle","RelevanceSearch.ErrorSubtitle","RelevanceSearch.Retry","RelevanceSearch.Feedback","RelevanceSearch.Feedback.Provided","RelevanceSearch.EntityNumberOfResults","RelevanceSearch.EntityNumberOfSingleResult","RelevanceSearch.NumberOfResultsBasedOnFields","Button_Label_Yes","Button_Label_No","Control_Enabled_ContextTokenIsNull","Control_Enabled_GridRecordIsEditable","Control_Enabled_ClientAPI","Control_Enabled_FormDescriptor","Control_Enabled_RecordIsActive","Control_Disabled_ClientAPI","Control_Disabled_GridRecordIsNotEditable","Control_Disabled_QuickViewFormAlwaysDisabled","Control_Disabled_IsUCIReadOnlyEntity","Control_Disabled_EntityNotAvailableInOffline","Control_Disabled_NoRecordWritePermissions","Control_Disabled_AttributeNotValidForCreate","Control_Disabled_AttributeNotValidForUpdate","Control_Disabled_NoAssignPermissionsForOwnerField","Control_Disabled_NoWritePermissionsByFieldLevelSecurity","Control_Disabled_FormDescriptor","Control_Disabled_RecordIsInactive","DisableWebResouceControlsMessage","GlobalSearch.SearchBoxPlaceholder","GlobalSearch.ZeroQuery.RecentSearches","GlobalSearch.Suggestions.ShowMoreResults"];var Et=r("x0oY"),Ct=r("3/02"),Tt=r("zjrO"),Nt=r("lMS8"),At=r("a475");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const vt=At.a.get_Instance().get_Cordova();let Dt=!1;const Ft=function(e,t){return{type:"error-callback",code:t,message:e,dbname:void 0,errorcode:void 0,errormessage:void 0}},Pt=function(e){let t;try{t=JSON.parse(e)}catch(e){}return t||e},It=function(e){return e.type&&"on-application-metadata-download-complete"===e.type?Lt(e):xt(e)},xt=function(e){return e.type="on-sync-complete",e.code=4,e.message=e.errormessage||"Update finished with failure",e},Lt=function(e){return e.code=5,e.message=e.errormessage||"Application Metadata download complete with failure",e},Rt=function(){const e=(new Date).getTime();let t=(new Date).getTime();for(;e===t;)t=(new Date).getTime();return t+"000"};class wt{constructor(e){this._openDBs={},this.getDefaultSyncRecallCount(e=>{this._syncRecall=e}),this.getDefaultSyncRecallTimeout(e=>{this._syncTimeout=e}),this._dbPath=e}transaction(e,t,r){const n=new kt(this._dbPath);return e(n),n.complete(r,t)}login(e,t,r,n,a,i,o,s,l,c="",_="",u=-1,d="",p="",f="",m,g="",h=""){const b=()=>{if(this._dbPath=e,this._openDBs[e]=!0,console.log("login: "+e),s)return s()},S=()=>{if(l)return console.log("login return error"),l()};e in this._openDBs?this._logout(e,()=>{this.login(e,t,r,n,a,i,o,s,l,c,_,u,d,p,f,m,g,h)}):vt.exec(b,S,"ClientSyncDatabasePlugin","login",[e,t,r,n,a,i,o,c,_,u,d,"",p,f,m,g,h])}_logout(e,t){const r=()=>{if(delete this._openDBs[e],t)return t()};if(e in this._openDBs)vt.exec(r,null,"ClientSyncDatabasePlugin","logout",[e]);else if(t)return t()}deleteDatabase(e,t,r){const n=()=>{if(delete this._openDBs[name],t)return t()},a=()=>{if(r)return r()};if(e in this._openDBs)vt.exec(n,a,"ClientSyncDatabasePlugin","deleteDatabase",[e]);else if(r)return r()}synchronize(e,t,r,n=-1,a,i){a&&-1===n&&(n=0);const o=r=>{const n=Pt(r);if("on-application-metadata-download-complete"===n.type){if(t)return t(n)}else if("on-sync-complete"===n.type){if(t)return t(n)}else if("on-progress-update"===n.type){if(t)return t(n)}else if("message-callback"===n.type&&e)return e(n)},s=o=>{if(-19===(o=Pt(o)).code){if(a){const n=Pt(o.json);if(void 0===n.model&&r){const e=Ft("cannot call beforeModelChange: model is undefined",-19);return r(e)}if(void 0===n.modelVersion&&r){const e=Ft("cannot recall sync: model version is undefined",-19);return r(e)}a(n.model)&&this.synchronize(e,t,r,n.modelVersion,a,i)}else if(r){const e=Ft("beforeModelChange is undefined",-19);return r(e)}}else if(-20===o.code){if(this._syncRecall>0)this._syncRecall--,setTimeout(()=>{this.synchronize(e,t,r,n,a,i)},this._syncTimeout);else if(this.getDefaultSyncRecallCount(e=>{this._syncRecall=e}),r){const e=Ft(o,-100);return r(e)}}else if(-26===o.code)this._logout(this._dbPath,()=>{if(r)return r(It(o))});else if(r)return r(It(o))};if(this._dbPath in this._openDBs)vt.exec(o,s,"ClientSyncDatabasePlugin","synchronizeDatabase",[this._dbPath,n,JSON.stringify(i)]);else if(r)return r(Ft("Database does not open!",-101))}abort(e,t,r=!1){const n=()=>{if(console.log("abort success"),e)return e()},a=()=>{if(console.log("abort error"),t)return t()};if(r)vt.exec(n,a,"ClientSyncDatabasePlugin","abortSynchronization",["",r]);else if(this._dbPath in this._openDBs)vt.exec(n,a,"ClientSyncDatabasePlugin","abortSynchronization",[this._dbPath,r]);else if(t)return t()}generateUUID(e,t){vt.exec(t=>{if(e)return e(t)},()=>{if(t)return t()},"ClientSyncDatabasePlugin","generateUUID",[1])}getDefaultSyncRecallCount(e){vt.exec(t=>{if(e)return e(t)},null,"ClientSyncDatabasePlugin","getDefaultSyncRecallCount",[])}getDefaultSyncRecallTimeout(e){vt.exec(t=>{if(e)return e(t)},null,"ClientSyncDatabasePlugin","getDefaultSyncRecallTimeout",[])}applyApplicationMetadataChanges(e,t){vt.exec(t=>{if(e)return e()},e=>{if(console.log("applyApplicationMetadataChanges error: "+e),t)return t(e)},"ClientSyncDatabasePlugin","applyApplicationMetadataChanges",[])}}const Mt=[],jt={};class kt{constructor(e){this._dbPath=e,this._trans_id=Rt(),this.__submitted=!1,Mt[this._trans_id]=[],jt[this._trans_id]=new Object}queryCompleteCallback(e,t,r){let n=null;if(t)for(const r in Mt[e])if(Mt[e][r].query_id===t){n=Mt[e][r],1===Mt[e].length?Mt[e]=[]:Mt[e].splice(r,1);break}if(t&&n&&n.callback)return n.callback(r)}escapeJSONVal(e){return e.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\/]/g,"\\/").replace(/[\b]/g,"\\b").replace(/[\f]/g,"\\f").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r").replace(/[\t]/g,"\\t")}fixQueryResult(e){let t="[",r=0;for(const n in e){t+="["!==t?",{":"{",r=0;for(const a in e[n].column)r>0&&(t+=","),"string"==typeof e[n].column[a].Value?t+='"'+e[n].column[a].Key.replace('"','\\"')+'":"'+this.escapeJSONVal(e[n].column[a].Value)+'"':t+='"'+e[n].column[a].Key.replace('"','\\"')+'":'+e[n].column[a].Value,r++;t+="}"}return t+="]",JSON.parse(t)}txCompleteCallback(e,t){const r=e.transId;let n=null,a=null;for(const t in e.results)n=e.results[t].queryId,a=e.results[t].result,n&&this.queryCompleteCallback(r,n,this.fixQueryResult(a));if(t)return t()}add_to_transaction(e,t,r,n,a){const i={};return i.trans_id=e,i.query_id=n?Rt():"",i.query=t,i.params=r||[],i.callback=n,i.err_callback=a,Mt[e]||(Mt[e]=[]),Mt[e].push(i)}executeSql(e,t,r,n){let a=null;r&&(a=e=>{const t=e,n={rows:{item:e=>t[e],length:t.length},rowsAffected:t.rowsAffected,insertId:t.insertId||null};return r(this,n)});let i=null;return n&&(i=e=>n(e,this)),this.add_to_transaction(this._trans_id,e,t,a,i)}complete(e,t){if(!Dt){if(Dt=!0,this.__submitted)throw new Error("Transaction already submitted");this.__submitted=!0;let r=e=>{};t&&(r=e=>(Dt=!1,t(this,e)));const n=t=>{Dt=!1,t=Pt(t),this.txCompleteCallback(t,e)};return vt.exec(n,r,"ClientSyncDatabasePlugin","executeSqlBatch",[JSON.stringify({dbargs:{dbname:this._dbPath},executes:Mt[this._trans_id]})])}setTimeout(()=>{this.complete(e,t)},5)}}let Bt,Wt,Vt,Ut,Gt=!1,qt="",zt="",Yt="",Xt=!1;const Ht=function(){return new Promise(e=>{let t="";const r={};ir("SELECT SyncToken, SubscriptionId FROM _CLIENTSYNC_CONFIG_TABLE").then(n=>{n.rows&&n.rows[0]&&(t=n.rows[0].SyncToken,""===Yt&&(Yt=n.rows[0].SubscriptionId)),Yt&&""!==Yt?t&&""!==t?(r.type="data",r.subscriptionId=Yt,r.syncToken=t,e(r)):(r.type="metadata",r.subscriptionId=Yt,r.syncToken=t,e(r)):(r.type="subscription",e(r))},()=>{r.type="subscription",e(r)})}).then(e=>"subscription"===e.type?Kt():"metadata"===e.type?Zt(e.subscriptionId,e.syncToken):"data"===e.type?Er(!1).then(()=>$t(e.subscriptionId,e.syncToken)):(console.error("Unknown type: ",e.type),Promise.resolve()))},Kt=function(){return Qt(zt+"/api/data/v9.0/SyncSubscription","POST",'{"DeviceId": "15c5452c-f10b-49fd-98a9-f4e1ce340cb9", "SubscriptionType": "UCI"}').then(e=>rr(e.text))},Qt=function(e,t,r){return new Promise((n,a)=>{const i=new XMLHttpRequest;i.open(t||"GET",e,!0),i.setRequestHeader("Content-Type","application/json"),"GET"===t&&i.setRequestHeader("Prefer",'odata.include-annotations="*"'),i.onreadystatechange=function(){i.readyState===XMLHttpRequest.DONE&&(i.status>=200&&i.status<300?n({status:i.status,text:i.responseText}):a({status:i.status,text:i.responseText}))},i.send(r)})},Jt=function(e,t){return ir("UPDATE _CLIENTSYNC_CONFIG_TABLE SET SyncToken= '"+t+"';",null,e)},$t=function(e,t){return Qt(zt+"/api/data/v9.0/SyncSubscriptionInfo(SubscriptionId=@p1,SyncToken=@p2,PageSize=@p3)?@p1='"+e+"'&@p2='"+t+"'&@p3=100","GET","").then(r=>202===r.status||204===r.status?new Promise((r,n)=>{setTimeout(()=>{$t(e,t).then(r,n)},5e3)}):function(e){const t=or(e),r=t.syncToken,n=t.isFinalPage;return sr(t.queries,r).then(()=>n?yr():$t(Yt,r))}(r.text),r=>{if(409===r.status)return console.log("Metadata out of date - do metadata sync"),Zt(e,t);console.error("Page failure: status "+r.status+" response: "+r.text)})},Zt=function(e,t){return Qt(zt+"/api/data/v9.0/SyncSubscriptionMetadataEntities(SubscriptionId='"+e+"',SyncToken='"+t+"')","GET","").then(e=>er(e.text))},er=function(e){const t=mr(e),r=t.syncToken;Jt(null,r);const n=t.isFinalPage;return hr(t.queries,r).then(()=>n?Er(!1).then(e=>br(e).then(()=>$t(Yt,r))):Zt(Yt,r))},tr=function(e,t,r){const n=r?1:0;let a="INSERT OR REPLACE INTO _CLIENTSYNC_CONFIG_TABLE (Key, Version, SubscriptionId, SyncToken, IsValid) VALUES ('key', '1.0','";a=a+t.toString()+"', '', '"+n.toString()+"');",ar(e,a)},rr=function(e){const t=JSON.parse(e);return Yt=t.SubscriptionId,(r=Yt,nr(e=>{ar(e,"CREATE TABLE IF NOT EXISTS EntitySettings (EntityLogicalName TEXT PRIMARY KEY, InitialDataDownloadStatus INTEGER, InitialDataDownloadETAInMinutes INTEGER, LastDataSyncTime TEXT);"),ar(e,"CREATE TABLE IF NOT EXISTS _CLIENTSYNC_CONFIG_TABLE (Key TEXT PRIMARY KEY, Version TEXT, SubscriptionId TEXT, SyncToken TEXT, IsValid INTEGER);"),ar(e,"CREATE TABLE IF NOT EXISTS _NORSYNC_MAIN_LOG_TABLE(SID INTEGER PRIMARY KEY AUTOINCREMENT, TIME_STAMP DATETIME NOT NULL, LOG_TABLE_ID TEXT NOT NULL, DEVICE_ID TEXT, OPERATION_TYPE INTEGER NOT NULL);"),ar(e,"CREATE TABLE IF NOT EXISTS _NORSYNC_SYSTEM_TABLE(SYSTEM_VERSION_ID TEXT NOT NULL, DATA_MODEL_NAME TEXT PRIMARY KEY NOT NULL, DATA_MODEL TEXT NOT NULL, DATA_MODEL_VERSION INTEGER NOT NULL, SEGMENTATION_VERSION INTEGER NOT NULL, LAST_UPDATE_TIME DATETIME NOT NULL DEFAULT 0);"),tr(e,r,!0)})).then(()=>Zt(Yt,""));var r},nr=function(e){return new Promise((t,r)=>{Bt.transaction(t=>{e(t)},e=>{r(e)},()=>{t()})})},ar=function(e,t,r,n,a){e.executeSql(t,r||[],(e,r)=>{console.log("Sync SQL success: "+t),n&&n(r)},(e,r)=>(console.log("Sync SQL error: '"+r.message+"' for query: "+t),a&&a(r),!1))},ir=function(e,t,r){return new Promise((n,a)=>{r?ar(r,e,t,n,a):Bt.transaction(r=>{ar(r,e,t,n,a)})})},or=function(e){const t=JSON.parse(e).SyncData;return{syncToken:t.SyncToken,isFinalPage:t.IsFinalPage,queries:t.Data}},sr=function(e,t){const r=lr(),n=e.UpdatedEntityData,a=e.DeletedEntityData;return console.log("Starting data page processing"),nr(e=>{ar(e,"INSERT INTO _NORSYNC_SUPPRESS_TRIGGERS(value) VALUES(1)");const i=[];let o,s,l;for(o=0;o<n.length;o++){const t=n[o];for(s=0;s<t.Keys.length;s++){const n=t.Values[s],a=t.Keys[s];for(l=0;l<n.Items.length;l++)i.push(dr(e,a,n.Items[l]));i.push(Or(e,a,r))}}for(o=0;o<a.length;o++){const t=a[o];for(s=0;s<t.Keys.length;s++){const n=t.Values[s],a=t.Keys[s];for(l=0;l<n.Items.length;l++)i.push(cr(e,a,n.Items[l]));i.push(Or(e,a,r))}}Promise.all(i).then(()=>{ar(e,"DELETE FROM _NORSYNC_SUPPRESS_TRIGGERS"),Jt(e,t),console.log("Completing data page processing")})})},lr=function(){const e=new Date;return e.getFullYear().toString()+"-"+(e.getMonth()+1).toString().padStart(2,"0")+"-"+e.getDate().toString().padStart(2,"0")+" "+(e.getHours().toString().padStart(2,"0")+":"+e.getMinutes().toString().padStart(2,"0")+":"+e.getSeconds().toString().padStart(2,"0"))},cr=function(e,t,r){return ir("DELETE FROM "+t+" WHERE "+t+"id='"+r+"'",null,e).catch(()=>{})},_r=function(e,t){const r=t,n=t.lastIndexOf("_value");if("_"===r[0]&&-1!==n&&!fr(e,r)){const e=r.substr(1,n-1);if(n===r.length-6)return e+"!id";const t=r.substr(n);if("_value@OData.Community.Display.V1.FormattedValue"===t)return e+"!name";if("_value@Microsoft.Dynamics.CRM.lookuplogicalname"===t)return e+"!logicalname"}return r},ur=function(e){if("boolean"==typeof e)return e?"1":"0";if("string"==typeof e){let t=e;if(!isNaN(Date.parse(e))&&-1!==t.search("T")&&-1!==t.search(":")&&-1!==t.search("Z")&&-1!==t.search("-"))return t=e.replace("T"," "),t=t.replace("Z",""),t}return e},dr=function(e,t,r){let n="INSERT INTO "+t.toString();const a=r;let i=" (",o=" VALUES  (";const s=[];for(const e in a){const r=_r(t,e);pr(t,r)||null===ur(a[e])||(i+="'"+r+"', ",o+="?, ",s.push(ur(a[e])))}return i+=")",i=i.replace(", )",")"),o+=")",o=o.replace(", )",")"),n=n+i+o,ir(n,s,e).catch(()=>{})},pr=function(e,t){return!t||""===t||-1!==t.indexOf("@odata")||-1!==t.lastIndexOf("@Microsoft.Dynamics.CRM.associatednavigationproperty")||-1!==t.lastIndexOf("@OData.Community.Display.V1.FormattedValue")||!fr(e,t)},fr=function(e,t){if(Wt&&Wt.tables)for(let r=0;r<Wt.tables.length;r++)if(Wt.tables[r]&&Wt.tables[r].name===e){const e=Wt.tables[r];if(e.column)for(let r=0;r<e.column.length;r++)if(e.column[r].name===t)return!0;return!1}return!1},mr=function(e){const t=JSON.parse(e).SyncMetadata,r=gr(t),n={syncToken:t.SyncToken,isFinalPage:t.IsFinalPage,metadataVersion:t.MetadataVersion,profileVersion:t.ProfileVersion,queries:r};return Vt=t.MetadataVersion,Ut=t.ProfileVersion,n},gr=function(e){const t=e.Metadata.length,r=[];let n;for(n=0;n<t;n++){const t=e.Metadata[n],a=t.Values.length;for(let e=0;e<a;e++){const n=t.Values[e],a=n.Items.length;for(let e=0;e<a;e++)r.push(n.Items[e])}}return r},hr=function(e,t){return nr(r=>{const n=[];for(let t=0;t<e.length;t++)n.push(ir(e[t],null,r).catch(()=>{}));Promise.all(n).then(()=>{Jt(r,t)})})},br=function(e){return nr(t=>{let r="INSERT OR REPLACE INTO _NORSYNC_SYSTEM_TABLE (SYSTEM_VERSION_ID, DATA_MODEL_NAME, DATA_MODEL, DATA_MODEL_VERSION, SEGMENTATION_VERSION) VALUES";r=r+"('1', '"+qt+"','"+JSON.stringify(e)+"', '1', '1');",ar(t,r),Sr(t,!0)})},Sr=function(e,t){const r="UPDATE _CLIENTSYNC_CONFIG_TABLE SET IsValid= "+(t?1:0).toString()+";";ar(e,r)},Or=function(e,t,r){let n="INSERT OR REPLACE INTO EntitySettings (EntityLogicalName, InitialDataDownloadStatus,InitialDataDownloadETAInMinutes,LastDataSyncTime) VALUES";return n+="('"+t+"', 1, 0, '"+r+"')",ir(n,null,e)},yr=function(){return nr(e=>{const t=[];if(Wt){const r=lr();for(let n=0;n<Wt.tables.length;n++)t.push(Or(e,Wt.tables[n].name,r))}else console.error("No data model when attempting to update entity settings timestamps");return Promise.all(t)}).then(()=>null)},Er=function(e){let t="SELECT name FROM sqlite_master WHERE type='table' and name not like 'sqlite_%' ";return e||(t+="and name not like '_norsync_%' and name not like '_clientsync_%' and name != 'EntitySettings' and name != '__WebKitDatabaseInfoTable__'"),t+=" ORDER BY name;",ir(t).then(r=>{let n=r.rows.length;const a=[];for(let e=0;e<n;e++)a.push(r.rows[e].name);return t="select name from sqlite_sequence ORDER BY name;",ir(t).then(t=>{const r=new Set;if(!1===e){n=t.rows.length;for(let e=0;e<n;e++)r.add(t.rows[e].name)}Wt=new Object;const i=Ut+"#"+Vt;Wt.userData=i,Wt.auth={},Wt.options={},Wt.options.collateNocase=!0,Wt.options.forceClientChanges=!0,Wt.options.reverseColumnFilters=!0,Wt.options.skipClientForeignKeys=!0,Wt.tables=[];const o=[];for(let t=0;t<a.length;t++)!0===e||o.push(Cr(a,a[t],r,Wt));return Promise.all(o).then(()=>Wt)})})},Cr=function(e,t,r,n){return ir("SELECT name, sql FROM sqlite_master WHERE type='table' AND tbl_name = '"+t+"';").then(e=>{const t=e.rows[0].sql.replace(/^[^\(]+\(([^\)]+)\)/g,"$1").split(","),a={primaryKey:[],foreignKeys:[],column:[]};for(let n=0;n<t.length;n++)if(-1===t[n].toString().toUpperCase().search("FOREIGN KEY ")){const i=Tr(t[n].toString().trim());Nr(t[n].toString().trim(),i,r,e.rows[0].name,a.primaryKey),a.column.push(i)}else{const e=Ar(t[n].toString().trim());null!==e&&a.foreignKeys.push(e)}a.columnFilter="",a.dataAvailable=!0,a.filterRules=[],a.name=e.rows[0].name,a.segmentationRules=[],a.syncType="DELTA_SYNC",n.tables.push(a)})},Tr=function(e){const t=new Object;if(null!==e){const r=e.split(" ");t.name=r[0].substring(1,r[0].length-1),null!==r[1]&&(t.type=r[1].toString().toLowerCase()),-1!==e.toString().toUpperCase().search("NOT NULL")?t.mandatory=!0:t.mandatory=!1,t.readOnly=!1}return t},Nr=function(e,t,r,n,a){-1!==e.toString().toUpperCase().search("PRIMARY KEY")?(a.push(t.name),"INTEGER"===t.type.toString().toUpperCase()&&r.has(n)&&(t.autoincrement=!0)):t.autoincrement=!1},Ar=function(e){if(-1!==e.toString().toUpperCase().search("FOREIGN KEY")){const t=new Object;if(t.ownerTable="",t.columns=[],t.ownerColumns=[],t.onUpdate="NO ACTION",t.onDelete="NO ACTION",-1!==e.toString().toUpperCase().search("FOREIGN KEY ")){const r=/^[^\(]+\(([^\)]+)\)/g,n=e.replace(r,"$1"),a=n.indexOf("REFERENCES "),i=n.substring(0,a);for(const e in i)t.columns.push(e.toString().trim());const o=n.indexOf("("),s=n.indexOf(")"),l=n.substring(o+1,s);for(const e in l)t.ownerColumns.push(e.toString().trim());const c=n.substring(a+11,o);t.ownerTable=c;const _=n.toString().toUpperCase().indexOf("ON DELETE"),u=n.toString().toUpperCase().indexOf("ON UPDATE");-1!==_&&-1!==u?(t.onUpdate=n.substring(u+10,n.length).toString().toUpperCase().trim(),t.onDelete=n.substring(_+10,u-1).toString().toUpperCase().trim()):-1!==_&&-1===u?t.onDelete=n.substring(_+10,n.length).toString().toUpperCase().trim():-1!==u&&-1===_&&(t.onUpdate=n.substring(u+10,n.length).toString().toUpperCase().trim())}return t}return null};class vr{constructor(e){this._openDBs={},this._dbPath=e,this.open()}transaction(e,t,r){const n=new Lr;return e(n),n.complete(r,t)}open(){this._dbPath in this._openDBs||(this._openDBs[this._dbPath]=!0),qt=this._dbPath,Bt=window.openDatabase(this._dbPath,"1.0",this._dbPath,104857600)}login(e,t,r,n,a,i,o,s,l,c,_,u,d,p,f,m,g,h){zt=(o?"https":"http")+"://"+n,s()}deleteDatabase(e,t,r){if(e in this._openDBs){if(t)return t()}else if(r)return r()}synchronize(e,t,r,n=-1,a,i){a&&-1===n&&(n=0);const o=function(r){const n=Dr(r);if("on-sync-complete"===n.type){if(t)return t(n)}else if("on-progress-update"===n.type){if(t)return t(n)}else if("message-callback"===n.type&&e)return e(n)};if(Xt){const e={callbackId:null,code:1};if(e.dbname=qt,e.type="on-progress-update",e.progress=0,o)return o(e)}Xt=!0,Ht().then(()=>{const e={callbackId:null,code:2};e.dbname=qt,e.message=null,e.progress=100,e.type="on-sync-complete",o&&o(e),Xt=!1},e=>{console.error("Sync failed: "+e)})}abort(e,t,r){e()}generateUUID(e,t){e(function(){let e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?r:3&r|8).toString(16)})}())}applyApplicationMetadataChanges(){}}const Dr=function(e){let t;try{t=JSON.parse(e)}catch(e){}return t||e},Fr=function(){const e=(new Date).getTime();let t=(new Date).getTime();for(;e===t;)t=(new Date).getTime();return t+"000"},Pr=function(e,t,r){let n=null;if(t)for(const r in Ir[e])if(Ir[e][r].query_id===t){n=Ir[e][r],1===Ir[e].length?Ir[e]=[]:Ir[e].splice(r,1);break}if(t&&n&&n.callback)return n.callback(r)},Ir=[],xr={};class Lr{constructor(){this._trans_id=Fr(),this.__submitted=!1,Ir[this._trans_id]=[],xr[this._trans_id]=new Object}add_to_transaction(e,t,r,n,a){const i=new Object;return i.trans_id=e,i.query_id=n?Fr():"",i.query=t,i.params=r||[],i.callback=n,i.err_callback=a,Ir[e]||(Ir[e]=[]),Ir[e].push(i)}executeSql(e,t,r,n){let a=null;r&&(a=e=>{const t=e,n={rows:{}};n.rows.item=function(e){return t.rows[e]},n.rows.length=t.rows.length,n.rowsAffected=t.rowsAffected;try{n.insertId=t.insertId}catch(e){n.insertId=null}return r(this,n)});let i=null;return n&&(i=e=>n(e,this)),this.add_to_transaction(this._trans_id,e,t,a,i)}complete(e,t){if(Gt)setTimeout(()=>{this.complete(e,t)},5);else{if(Gt=!0,this.__submitted)throw new Error("Transaction already submitted");this.__submitted=!0;let r=(e,t)=>!1;t&&(r=(e,r)=>(Gt=!1,console.log("executeSqlComplete Error: "+r.message),t(this,r.message),!1));const n=function(t){return function(r,n){Gt=!1;const a={};a.transId=t.trans_id,a.results=[];const i={};i.queryId=t.query_id,i.result=n,a.results.push(i),function(e,t){const r=e.transId;let n=null,a=null;for(const t in e.results)n=e.results[t].queryId,a=e.results[t].result,n&&Pr(r,n,a);if(t)t()}(a,e)}};Bt.transaction(e=>{for(let a=0;a<Ir[this._trans_id].length;a++){const i=Ir[this._trans_id][a];console.log("queryId: "+i.query_id+" transId: "+i.trans_id+" query: "+i.query),this._trans_id=i.trans_id,i.query=(0===(t=i.query).toString().indexOf("DROP TABLE")&&(t=(t=t.replace("DROP TABLE IF EXISTS","DELETE FROM")).replace("DROP TABLE","DELETE FROM")),t),e.executeSql(i.query,i.params,n(i),r)}var t})}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Rr{constructor(e,t,r){this._store=null,this._applicationContext=null,this._executionContext={},this._store=e,this._applicationContext=t,this._executionContext=r}setOfflineDatabaseName(e){this._store.dispatch(Object(F.b)(e))}setCalculationOfDisabledOfflineEntitiesPending(e){this._store.dispatch({type:"offline.datamodel.changed",payload:{isCalculationOfDisabledEntitiesPending:e}})}setIsSyncing(e){this._store.dispatch(Object(x.d)(e))}setOfflineStatus(e,t,r=null,n=null){null==e&&(e=this.getOfflineStatus()),null==t&&(t=this.getOfflineStatusReason()),this._store.dispatch(Object(x.c)(e,t,r,n))}setOfflineProfileChanged(e){this._store.dispatch({type:"offline.profile.changed",payload:{isProfileChanged:e}})}setDatabaseCleanUpFlag(e){this._store.dispatch(Object(D.b)(e))}setOfflineDisableInformation(e,t){this._store.dispatch(Object(Xe.a)(e,t))}setMetadataSyncStatus(e){this._store.dispatch(Object(ut.i)({syncStatus:e}))}setOfflineAvailablePrimaryEntities(e){this._store.dispatch(Object(v.b)(e))}setOfflineEntityPluralNamesAction(){this._store.dispatch(ft())}setApplyApplicationMetadataChanges(e){this._store.dispatch(Object(B.d)(e))}setIsOfflineFirstTimeSyncCompleted(e){this._store.dispatch(Object(U.b)(e))}processOfflineValidationsComplete(){const e=this._store.getState();Object(ct.c)(e)===Ot.a.SyncPendingFromServer||Object(i.a)(e)?this._store.dispatch(Object(dt.d)()):Object(a.c)(e)&&this._store.dispatch(Object(C.b)(!0))}executeNonCUDODataRequest(e,t){return new He.a(ot(e,t).execute(this._store,this._applicationContext,this._executionContext))}getBusinessProcessFlowControlData(e,t){return new He.a(function(e,t){return{type:"offline.bpf.control.data",execute({dispatch:r,getState:n},a){let i=[];return e?r(Object(lt.b)(c.a.fromLegacyGuid(e))).then(r=>{const n=c.a.fromLegacyGuid(e).guid;if(r&&r.businessProcessFlows&&r.businessProcessFlows[n]&&r.businessProcessFlows[n].businessProcessFlowStepEntityAttributeControls){const e=r.businessProcessFlows[n].businessProcessFlowStepEntityAttributeControls[t];e&&Object.keys(e).length&&(i=Object.keys(e).map(t=>e[t].DataFieldName),u.c.info("Business process flow control data successfully retrived from get clinet metadata"))}return Promise.resolve(i)}).catch(e=>(u.c.error("Business process flow control data failed to retrived from get clinet metadata"+Object(ae.e)(e)),Promise.reject(e))):(u.c.info("processID is null in get business process flow control data"),Promise.resolve(i))}}}(e,t).execute(this._store,this._applicationContext,this._executionContext))}triggerDisplayForFirstTimeSyncCompleteNotification(){this._store.dispatch(Object(Nt.c)())}triggerFirstTimeRequestToApplyApplicationMetadataChangeNotification(){this._store.dispatch(Object(Nt.b)())}getEntityDictionaryFromPluralName(e){return Object(g.d)(this._store.getState(),e)}getIsMocaOfflineFeatureEnabled(){return Object(o.a)(this._store.getState())}getMetadataSyncStatus(){return Object(ct.c)(this._store.getState())}getOfflineDatabaseName(){return Object(a.d)(this._store.getState())}getOfflineStatus(){return Object(a.q)(this._store.getState())}getOfflineStatusReason(){return Object(a.r)(this._store.getState())}getOfflineFeatureStatus(){return Object(a.p)(this._store.getState())}isOfflineAvailableForUse(){return Object(a.w)(this._store.getState())}getOfflineProfileId(){return c.a.toString(Object(i.c)(this._store.getState()))}getCalculationOfDisabledOfflineEntitiesPending(){return Object(g.c)(this._store.getState())}getServerStatus(){return Object(_t.b)(this._store.getState())}getUpSyncStatus(){return Object(S.b)(this._store.getState())}getOfflineEnabledEntities(){return Object(g.j)(this._store.getState())}isEntityAvailableForOfflineUsage(e){return Object(g.l)(this._store.getState(),e)}getOfflineAvailablePrimaryEntities(){return Object(g.g)(this._store.getState())}getOfflineProfileAvailableEntities(){return Object(i.b)(this._store.getState())}getIsProfileChanged(){return Object(i.a)(this._store.getState())}getLastMetadataVersionUsedForValidation(){return h(this._store.getState())}getOfflineProfileVersion(){return Object(i.d)(this._store.getState())}getIsConflictDetectionEnabledForMobileClient(){return Object(s.k)(this._store.getState())}getNorsyncServerConnectionString(){const e=this._store.getState();return Object(gt.b)(e,"EnableDataSyncService")?Object(ht.a)(e):Object(o.c)(e)}getUserName(){return Object(l.t)(this._store.getState())}getUserId(){return c.a.toLegacyGuid(Object(l.q)(this._store.getState()))}getSubscriptionId(){return Object(o.d)(this._store.getState())}transformToODataValue(e,t,r){return JSON.stringify(Object(mt.g)(this._store.getState(),e,t,r))}reportOfflineComponentPerformance(e,t,r){this._applicationContext.EventManager.ReportComponentPerformance(e,t,r)}reportOfflineComponentSuccess(e,t){this._applicationContext.EventManager.ReportComponentSuccess(e,t)}reportOfflineComponentFailure(e,t,r,n){this._applicationContext.EventManager.ReportComponentFailure(e,t,r,n)}reportOfflineComponentWarn(e,t,r){this._applicationContext.TraceManager.getTracer(e).warn(t,r)}reportOfflineComponentError(e,t,r){this._applicationContext.TraceManager.getTracer(e).error(t,r)}parseFetchXmlForAliasedValues(e){return Object(bt.d)(e)}isDssOfflineEnabled(){const e=this._store.getState();return Object(o.g)(e)}isBrowserOfflineEnabledWithDss(){const e=this._store.getState();return Object(o.f)(e)}isApplicationMetadataDownloadInShimEnabled(){const e=this._store.getState();return Object(o.e)(e)}isAppAvailableOffline(){const e=this._store.getState();return Object(st.b)(e)}getCurrentAppId(){const e=this._store.getState();return Object(St.i)(e)}isUCIOfflineSyncAdaptivePagingEnabled(){const e=this._store.getState();return Object(o.h)(e)}getOfflineResourceStrings(){return yt}isExtendedOfflineClientApiSupportEnabled(){return Object(gt.c)(this._store.getState(),Ct.fb)}getEntityCollectionFromSQLResults(e,t,r,n,a){let i=null;return e instanceof Tt.a&&(i=e.get_FetchXmlForAliasedValues()),Object(_.a)(i)&&!Object(_.a)(e.get_FetchXml())&&(i=Object(bt.d)(e.get_FetchXml())),new He.a(this._store.dispatch(Object(bt.b)(e,i,t,n,null,null,Et.b.SQL,r,a)))}getEntityRecordFromSQLResult(e,t,r,n){const{columnNames:a}=Object(tt.e)(t);return new He.a(this._store.dispatch(Object(Et.e)(r,e.LogicalName,a,t,null,null,null,Et.b.SQL)).then(e=>(e.set_clientRetrieveOptions(n),e)))}createCustomOfflineCommandQueries(e,t,r){const n=new He.a,a=e.get_name();return Object(ee.d)(this._store,a,t).then(i=>{if(i){const i={EntityLogicalName:t},o=c.a.fromLegacyGuid(r);c.a.isNullOrEmpty(o)||(i.id=r.toString());const s=Object(ee.e)(this._store,e,o,i);this._store.dispatch(Object(qe.c)(s)).then(()=>{this._store.dispatch(Object(ee.g)(t,a,s,i)).then(e=>{n.resolve(e)}).catch(e=>{const t=Je.a.toLegacyErrorStatus(e);t.set_ErrorCode(0),n.reject(t)})})}else n.resolve(null)}).catch(e=>{n.reject(Je.a.toLegacyErrorStatus(e))}),n}getApplyApplicationMetadataChanges(){const e=this._store.getState();return Object(a.a)(e)}getOfflineSyncPlugin(e){return this.isBrowserOfflineEnabledWithDss()?new vr(e):function(e){return new wt(e)}(e)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function wr(e,t){return new Ye(e,t)}},WTtv:function(e,t,r){"use strict";r.r(t),r.d(t,"initializeOfflineLifecycleAsyncAction",(function(){return F}));var n=r("Rj8P"),a=r("VKvO"),i=r("TBkx"),o=r("37s6"),s=r("SAYH"),l=r("zmAS"),c=r("e+ib"),_=r("Uv1Y"),u=r("9bCE"),d=r("Eh/Y"),p=r("Nzmy"),f=r("QSjj"),m=r("iOI1"),g=r("eZ32"),h=r("8CLP");var b=r("NjDY"),S=r("GL3b"),O=r("iF9X"),y=r("yRo8"),E=r("ml6Y"),C=r("8Mff");function T(){return{type:"offline.save.sessionstate",execute({getState:e},t){const r=e(),n=Object(o.p)(r),a={},l={},c={},_={},u=[];return n!==C.a.Disabled?(l[E.a.OfflineProfileIdKey]=s.a.toString(S.c(r)),l[E.a.OfflineProfileVersionKey]=S.d(r),l[E.a.OfflineProfileAvailableEntitiesKey]=S.b(r),a[E.a.norsyncServerConnectionStringKey]=O.c(r),a[E.a.isTrialOrganizationKey]=O.b(r).toString(),a[E.a.isMocaOfflineFCBEnabledKey]=O.a(r).toString(),p.c.info("Offline: OfflineSaveSessionState: Saving information to the session state:"+E.a.OfflineProfileDataKey),u.push(t.DataSource.saveSessionState(E.a.OfflineProfileDataKey,l,!1)),p.c.info("Offline: OfflineSaveSessionState: Saving information to the session state:"+E.a.offlineDatabaseInformationKey),u.push(t.DataSource.saveSessionState(E.a.offlineDatabaseInformationKey,a,!1))):(p.c.info("Offline: OfflineSaveSessionState: Clearing the Session State"),u.push(t.DataSource.deleteSessionState(E.a.OfflineProfileDataKey)),u.push(t.DataSource.deleteSessionState(E.a.offlineDatabaseInformationKey)),u.push(t.DataSource.deleteSessionState(E.a.OfflineEntityPluralNamesKey)),u.push(t.DataSource.deleteSessionState(E.a.OfflinePrimaryAvailableEntitiesKey)),u.push(t.DataSource.deleteSessionState(y.a))),_[E.a.isMobileOfflineOptedInKey]=n.toString(),p.c.info("Offline: OfflineSaveSessionState: Saving information to the session state:"+E.a.isMobileOfflineOptedInKey),u.push(t.DataSource.saveSessionState(E.a.isMobileOfflineOptedInKey,_,!1)),c[E.a.OfflineDatabaseKey]=Object(o.d)(r),p.c.info("Offline: OfflineSaveSessionState: Saving information to the session state:"+E.a.OfflineDatabaseKey),u.push(t.DataSource.saveSessionState(E.a.OfflineDatabaseKey,c,!1)),Promise.all(u).then(()=>(p.c.info("Offline: OfflineSaveSessionState: SaveMobileofflineInformation: Complete"),Promise.resolve())).catch(e=>(p.c.error("Offline: OfflineSaveSessionState: SaveMobileofflineInformation: Failed"+Object(i.e)(e)),Promise.reject(e)))}}}var N=r("504W"),A=r("69Qu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function v(e,t,r,a,i){const l=Object(b.m)(t),u=Object(S.e)(t),d=Object(o.p)(t),f=Object(S.c)(t);l&&d!==C.a.Disabled&&(f&&f!==s.a.EMPTY&&u?(d===C.a.Default&&r(Object(c.b)(C.a.Enabled)),r(function(e,t){return{type:"offline.schedule.datasync.async",execute({dispatch:r,getState:a},i){const s=i.OfflineProvider,l=Object(o.d)(a());if(Object(N.a)(l)){const e=Object(A.b)(a())?g.a.Initializing:g.a.NotAvailable;p.c.info("OfflineDataSyncAsyncAction.startOfflineDataSync: The offline status has been set to "+e),r(Object(n.c)(e,h.a.None))}else p.c.info("OfflineDataSyncAsyncAction.startOfflineDataSync: The offline status has been set to Available."),r(Object(n.c)(g.a.Available,h.a.None));return p.c.info("OfflineDataSyncAsyncAction.startOfflineDataSync: Schedule Periodic Sync Job started."),s.schedulePeriodicSyncJob(e,t).nativePromise().catch(_.b)}}}(a,i)),p.c.warn("Offline: OfflineWrapper: OfflinePerformDataSync: The offline feature status is : mobileOfflineOptStatus =  "+d)):(r(Object(n.c)(g.a.NotAvailable,h.a.ProfileUnavailable)),p.c.warn("Offline: OfflineWrapper: OfflinePerformDataSync: The offline feature status is set to "+g.a.NotAvailable)))}function D(e,t,r,a,s){var l;Object(o.c)(t)?(p.c.warn("OfflineWrapper: OfflineInitDataSync: Deleting the existing offline database as isDBCleanNeeded is true "+Object(o.d)(t)),r((l=Object(o.d)(t),{type:"offline.database.delete.async",execute:({dispatch:e,getState:t},r)=>r.OfflineProvider.cleanUpDatabases(l).nativePromise().then(()=>{e(Object(d.b)("")),e(Object(n.c)(g.a.NotAvailable,h.a.None)),e(Object(u.b)(!1)),e(Object(m.b)(null)),e(Object(f.b)(null,null,null))}).catch(e=>(p.c.error("Offline.databaseDeleteAction: OfflineProvider.cleanUpDatabases failed with error:"+Object(i.e)(e)),Promise.reject(e)))})).then(()=>{v(0,t,r,a,s),r(T())},_.b)):(p.c.warn("OfflineWrapper: OfflineInitDataSync: perform offline data sync "),v(0,t,r,a,s),r(T()))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function F(e,t){return{type:"offline.init.lifecycle.async",execute:({dispatch:r,getState:c},_)=>_.OfflineProvider.initializeOfflineDataSource(_.DataSource.get_UserContext()).nativePromise().then(()=>{const i=c(),u=Object(A.b)(i),d=Object(o.d)(i);if(Object(o.p)(c())===C.a.Disabled||null===d||""===d||s.a.equals(s.a.parse(d),s.a.EMPTY)||r(Object(n.c)(g.a.Available,h.a.None)),null!=d){const n=()=>!u||r(Object(l.initializeOfflineUpsyncProcessAsyncAction)()).then(()=>(D(0,c(),r,e,t),!0));return _.OfflineProvider.calculateDisabledOfflineEntities().nativePromise().then(n,n)}return u&&(r(Object(a.b)()),D(0,c(),r,e,t)),!0}).catch(e=>(p.c.error("OFFLINE : initializeOfflineLifecycleAsyncAction Failed"+Object(i.e)(e)),Promise.reject(e)))}}},lEp6:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(e){let t=null;try{t=JSON.parse(e)}catch(e){}return t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){let t="";try{t=JSON.stringify(e)}catch(e){}return t}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}))}}]),window.bundleExecutionMarkers["scripts/offlinets.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();