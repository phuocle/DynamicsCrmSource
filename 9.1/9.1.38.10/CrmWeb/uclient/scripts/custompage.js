(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/custompage.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[55,68],{C8PA:function(e,t,n){var i,o,r;o=[],void 0===(r="function"==typeof(i=function(){"use strict";var e,t,n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
return function(e){!function(e){var t=function(){function t(n,i){if(this.embeddingOptions=n,this.hostWindow=i,!n)throw new e.EmbeddingError("Options cannot be empty");if(this.embeddingOptions.hostName=this.embeddingOptions.hostName?this.ensureTrailingSlash(n.hostName):this._getHostName(),this.embeddingOptions.endpoint&&"INT"===this.embeddingOptions.endpoint?this.webplayerPathSegmentToUse=t.WebplayerCommonPathSegmentForInt:this.webplayerPathSegmentToUse=t.WebplayerCommonPathSegment,this.embeddingOptions.getAccessToken){if(!i)throw new e.EmbeddingError("Host window must be specified when using delegated token authentication");this._authHandler=this._accessTokenRequestHandler.bind(this),this.hostWindow.addEventListener("message",this._authHandler)}var o=n.hostName.match(/https:\/\/([a-z0-9\-\.]*[:0-9]*)/i);if(!o||o.length<2)throw new e.EmbeddingError("Host name is not of the correct format");var r="https://(?:([^s\\/]*).)?"+o[1];this.subDomainRegex=new RegExp(r,"i")}return t.prototype.dispose=function(){this._authHandler&&(this.hostWindow.removeEventListener("message",this._authHandler),this._authHandler=void 0)},t.prototype._accessTokenRequestHandler=function(t){if(this.validateMessageOrigin(t)){var n=t.data;if(n&&void 0!==n.api)switch(n.api){case e.RuntimeToSdkApi.GetAccessToken:var i=t.data,o={id:i.id,api:i.api,success:!1,accessToken:null,errorMessage:null,parentRequestId:""},r=function(e,n){void 0===n&&(n=""),o.success=!0,o.accessToken=e,o.parentRequestId=n,t.source&&t.source.postMessage(o,t.origin)},s=function(e,n){void 0===n&&(n=""),o.success=!1,o.errorMessage=e,o.parentRequestId=n,t.source&&t.source.postMessage(o,t.origin)};this.embeddingOptions.getAccessToken(i.audience,r,s,i.clientRequestId)}}},t.prototype.ensureTrailingSlash=function(e){return"/"!==e.charAt(e.length-1)?e+"/":e},t.prototype.validateMessageOrigin=function(e){var n=!1;return t.HostNameAllowList.forEach((function(t){e.origin===t&&(n=!0)})),n||!!this.subDomainRegex.exec(e.origin)},t.prototype._getHostName=function(){var t;switch(this.embeddingOptions.endpoint){case e.Endpoint.PROD:t="https://apps.powerapps.com/";break;case e.Endpoint.GCCMODERATE:t="https://apps.gov.powerapps.us/";break;case e.Endpoint.GCCHIGH:t="https://apps.high.powerapps.us/";break;case e.Endpoint.INT:t="https://apps.int.powerapps.com/";break;case e.Endpoint.TEST:t="https://apps.test.powerapps.com/";break;case e.Endpoint.DEV:t="https://apps.local.powerapps.com:44329/";break;default:t="https://apps.powerapps.com/"}return t},t.prototype.constructBaseUrl=function(e,n){void 0===n&&(n="");var i=this.embeddingOptions.hostName;return i+=e?t.BaseUrlSdkPathSegment:this.webplayerPathSegmentToUse+"/"+n,this.appendCoreEmbeddingParams(i)},t.prototype.appendCoreEmbeddingParams=function(e){var t=[];this.embeddingOptions.source&&t.push("source="+this.embeddingOptions.source),this.embeddingOptions.locale&&t.push("locale="+this.embeddingOptions.locale),this.embeddingOptions.externalCorrelationId&&t.push("correlationId="+encodeURIComponent(this.embeddingOptions.externalCorrelationId)),this.embeddingOptions.enableOnBehalfOf&&t.push("enableOnBehalfOf=true");var n=t.join("&");return n?-1!==e.indexOf("?")?e+"&"+n:e+"?"+n:e},t.WebplayerCommonPathSegment="webplayer",t.WebplayerCommonPathSegmentForInt="webplayer-int",t.HostNameAllowList=["https://apps.powerapps.com","https://apps.high.powerapps.us","https://apps.gov.powerapps.us","https://apps.preview.powerapps.com","https://apps.preprod.powerapps.com","https://apps.int.powerapps.com","https://apps.test.powerapps.com","https://apps.dev.powerapps.com","https://apps.local.powerapps.com:44329","https://apps.local.powerapps.com:44328"],t.BaseUrlSdkPathSegment="sdk/authoringmetadata",t}();e.CoreEmbedding=t}(e.Embedding||(e.Embedding={}))}(e||(e={})),function(e){!function(e){function t(e){return"object"==typeof e&&"number"==typeof e.api&&("string"==typeof e.id||void 0===e.id)}function n(e,t,n,i){var o=new XMLHttpRequest;return new Promise((function(r,s){o.onreadystatechange=function(){4===o.readyState&&(o.status>=200&&o.status<300?r(o):s({status:o.status,statusText:o.statusText}))},o.open(e,t,!0),n&&Object.keys(n).forEach((function(e){return o.setRequestHeader(e,n[e])})),"POST"===e&&i?(o.setRequestHeader("Content-Type","application/json"),o.send(i)):o.send()}))}!function(e){e.DEV="DEV",e.TEST="TEST",e.PROD="PROD",e.GCCMODERATE="GCCMODERATE",e.GCCHIGH="GCCHIGH",e.INT="INT"}(e.Endpoint||(e.Endpoint={})),function(e){e[e.GetAccessToken=0]="GetAccessToken"}(e.RuntimeToSdkApi||(e.RuntimeToSdkApi={})),e.isRuntimeToSdkRequest=t,e.sendXhr=n;var o=function(e){function t(t){return e.call(this,t)||this}return i(t,e),t}(Error);e.EmbeddingError=o,function(e){e.Table="Table",e.Record="Record"}(e.DataKind||(e.DataKind={})),function(e){e.String="s",e.Number="n",e.Boolean="b",e.Date="d",e.DateTime="D"}(e.DataType||(e.DataType={}))}(e.Embedding||(e.Embedding={}))}(e||(e={})),function(e){!function(e){!function(t){var n,i,o;function r(e,t){var r=e.logger,a=e.renderConsentPage;s(t)&&(n=e,i=t.data.appResourcePayload,o=!0,r.logOperationStart("WebPlayerRuntime.LoadingDisambiguationWithConsentService",t.data.initConsentServiceTimeStamp),a())}function s(e){return e&&e.data&&e.data.appResourcePayload&&"number"==typeof e.data.initConsentServiceTimeStamp}function a(e){o&&p(e)&&n.logger.logOperationEnd("WebPlayerRuntime.LoadingDisambiguationWithConsentService",e.data.consentDialogLoadedTimestamp)}function p(e){return e&&e.data&&"number"==typeof e.data.consentDialogLoadedTimestamp&&"AppPermissionDialog"===e.data.source}function c(){if(o){var t={api:e.PowerAppsEmbeddingCallbackApi.GetPreloadConsentServiceData,data:{appResources:i}};n.postMessageToConsentService(t),i=void 0}}t.initializeConsentService=r,t.onConsentServiceLoaded=a,t.sendPreloadDataToConsentService=c}(e.EmbeddingConsentFlowHelper||(e.EmbeddingConsentFlowHelper={}))}(e.Sdk||(e.Sdk={}))}(t||(t={})),function(e){!function(e){var t=function(){function e(e){this._metricsDictionary={},this._logCallback=e}return e.prototype.logOperationStart=function(e,t){this._metricsDictionary.hasOwnProperty(e)&&t||(this._metricsDictionary[e]={startTimeStamp:t,endTimeStamp:0})},e.prototype.logOperationEnd=function(e,t){if(this._metricsDictionary.hasOwnProperty(e)||!t){this._metricsDictionary[e].endTimeStamp=t;var n=this._metricsDictionary[e].endTimeStamp-this._metricsDictionary[e].startTimeStamp;this._logCallback({operationName:e,duration:n}),delete this._metricsDictionary[e]}},e}();e.EmbeddingLogger=t}(e.Sdk||(e.Sdk={}))}(t||(t={})),function(t){!function(t){function n(e){return"string"==typeof e.url}function i(t){return"string"==typeof t.requestParameters.url&&"string"==typeof t.requestParameters.method&&(!t.requestParameters.headers||"object"==typeof t.requestParameters.headers)&&(!t.requestParameters.retryable||"object"==typeof t.requestParameters.retryable)&&(!t.requestParameters.bodyData||"string"==typeof t.requestParameters.bodyData)&&e.Embedding.isRuntimeToSdkRequest(t)}function o(t){return"string"==typeof t.message&&""!==t.message&&null!==t.message&&(null===t.data||"object"==typeof t.data)&&e.Embedding.isRuntimeToSdkRequest(t)}!function(e){e[e.GetAccessToken=0]="GetAccessToken",e[e.AppLoaded=1]="AppLoaded",e[e.AppClosed=2]="AppClosed",e[e.AppFailed=3]="AppFailed",e[e.RequestHide=4]="RequestHide",e[e.EnableSave=5]="EnableSave",e[e.NewItem=6]="NewItem",e[e.EditItem=7]="EditItem",e[e.ViewItem=8]="ViewItem",e[e.SaveItem=9]="SaveItem",e[e.CancelEditItem=10]="CancelEditItem",e[e.SetProperty=20]="SetProperty",e[e.VisibilityChanged=21]="VisibilityChanged",e[e.ReadyToHandleMessages=22]="ReadyToHandleMessages",e[e.InteractionRequired=23]="InteractionRequired",e[e.SendTrigger=30]="SendTrigger",e[e.SendTriggerResponse=31]="SendTriggerResponse",e[e.SendTelemetryEvent=40]="SendTelemetryEvent",e[e.Log=41]="Log",e[e.DelegateLaunchUrl=42]="DelegateLaunchUrl",e[e.OpenConsentPage=43]="OpenConsentPage",e[e.CloseConsentPage=44]="CloseConsentPage",e[e.SetConsentResult=45]="SetConsentResult",e[e.OpenConnectorAuthPopup=46]="OpenConnectorAuthPopup",e[e.SetConnectorAuthResult=47]="SetConnectorAuthResult",e[e.GetPreloadConsentServiceData=48]="GetPreloadConsentServiceData"}(t.PowerAppsEmbeddingCallbackApi||(t.PowerAppsEmbeddingCallbackApi={})),t.isDelegateLaunchUrlEventCallBackParams=n,t.isAppToHostFunctionsEventCallBackParams=i,t.isAppToHostTelemetryEventCallBackParams=o}(t.Sdk||(t.Sdk={}))}(t||(t={})),function(t){!function(t){var n=function(e){function n(n,i){var o=e.call(this,n,i||window)||this;if(o.sdkVersion="1.3.34",o.appIdConst="/providers/Microsoft.PowerApps/apps/",o.eventListeners={},o.params="",!n.appId)throw new t.PowerAppsEmbeddingError("App Id cannot be empty");if(-1===n.appId.indexOf(o.appIdConst)&&(n.appId=o.appIdConst+n.appId),!n.containerId)throw new t.PowerAppsEmbeddingError("Container Id cannot be empty");if(o.containerElement=document.getElementById(n.containerId),!o.containerElement)throw new t.PowerAppsEmbeddingError("Container div does not exist");if(n.standAloneConsent&&!n.consentContainerId)throw new t.PowerAppsEmbeddingError("Container Id for consent service cannot be empty");if(n.consentContainerId&&(o.consentContainerElement=document.getElementById(n.consentContainerId),!o.consentContainerElement))throw new t.PowerAppsEmbeddingError("Container div for consent service does not exist");return o.options=n,o._onMessageReceived=o._onMessageReceived.bind(o),o._processConnectorAuthResult=o._processConnectorAuthResult.bind(o),o.queuedCdpData=[],o}return i(n,e),n.prototype.sendCdpData=function(e,t){if(t){var n={itemId:e,promise:t};this.sdkOrchestrator?this._sendCdpData(n):this.queuedCdpData.push(n)}},n.prototype.executeAction=function(e,n){if(void 0===n&&(n={}),!this.iframe)throw new Error("renderApp must be called before executeAction");var i,o=n&&n.itemId;switch(e){case"new":i={api:t.PowerAppsEmbeddingCallbackApi.NewItem,originalClickTime:n.originalClickTime};break;case"edit":if(!o)throw new TypeError("options must contain itemId");i={api:t.PowerAppsEmbeddingCallbackApi.EditItem,itemId:o};break;case"view":if(!o)throw new TypeError("options must contain itemId");i={api:t.PowerAppsEmbeddingCallbackApi.ViewItem,itemId:o,originalClickTime:n.originalClickTime};break;case"save":i={api:t.PowerAppsEmbeddingCallbackApi.SaveItem};break;case"cancel":i={api:t.PowerAppsEmbeddingCallbackApi.CancelEditItem};break;case"set-data":i={api:t.PowerAppsEmbeddingCallbackApi.SetProperty,hostType:"dynamic",propertyName:"Data",value:n.data};break;case"log":if(!n&&!n.parentRequestId)throw new TypeError("data must contain parentRequestId");i={api:t.PowerAppsEmbeddingCallbackApi.Log,data:n};break;default:throw new RangeError("Invalid action")}this.iframe.contentWindow.postMessage(i,"*")},n.prototype._constructUrl=function(e){void 0===e&&(e=!1);var t="",n=this._isCallingServiceFabricEndpoint();if(n){var i=decodeURIComponent(this.options.appId).replace(this.appIdConst,""),o=e?"consent":"play";t=this.options.appEnvironmentId?this.options.logicalAppName?""+this.options.hostName+o+"/e/"+this.options.appEnvironmentId+"/an/"+this.options.logicalAppName:""+this.options.hostName+o+"/e/"+this.options.appEnvironmentId+"/a/"+i:""+this.options.hostName+o+"/"+i,t=this.appendCoreEmbeddingParams(t);var r="default";this.options.enableAuthFlowProxy?r="authflowproxy":this.options.getAccessToken&&(r=this.options.enableOnBehalfOf?"onbehalfof":"override");var s=-1!==t.indexOf("?")?"&":"?";t=""+t+s+"authMode="+r,!e&&this.options.standAloneConsent&&(t+="&standAloneConsent=true"),e&&"function"==typeof this.options.openConnectorAuthPopup&&(t+="&openPopupByHost=true&connectorAuthCallbackUrl="+encodeURIComponent(window.location.protocol+"//"+window.location.host+"/webplayer/webClientAuthRedirect.html"))}else{var a="iframeapp";this.options.getAccessToken&&(a="embedapp"),s=-1!==(t=this.constructBaseUrl(n,a)).indexOf("?")?"&":"?",t=""+t+s+"appId="+encodeURIComponent(this.options.appId)}if(t+="&hideNavBar=true",this.options.tenantId&&(t+="&tenantId="+this.options.tenantId),this.options.appInfo&&this.options.appInfo.properties&&this.options.appInfo.properties.backgroundColor?t+="&screenColor="+encodeURIComponent(this.options.appInfo.properties.backgroundColor):this.options.splashScreenCssColor&&(t+="&screenColor="+encodeURIComponent(this.options.splashScreenCssColor)),this.options.delegateLaunchUrl&&(t+="&delegatelaunchurl=true"),this.options.hideAppSplashScreen&&(t+="&hideAppSplash=true"),this.options.packagePropertiesJson&&(t+="&packageProperties="+encodeURIComponent(this.options.packagePropertiesJson)),this.options.cachedFilesJson&&(t+="&skipIframeCreation=true"),t+="&sdkVersion="+this.sdkVersion,t+="&iframeContainerId="+this.options.containerId,this.options.locale&&(t+="&locale="+this.options.locale),this.options.parameters){for(var p in this.options.parameters)this.options.parameters.hasOwnProperty(p)&&(this.params+="&"+p+"="+encodeURIComponent(this.options.parameters[p]));t+=this.params}return this.options.useIntegrationEnvironment&&(t+="&overrideEnvironment=Tip1&overridePackager=Int"),this.options.embedderOrigin&&(t+="&embedderOrigin="+this.options.embedderOrigin),t},n.prototype._generateIframeSize=function(){if(this.options.appInfo&&this.options.appInfo.tags&&this.options.appInfo.tags.primaryDeviceWidth&&this.options.appInfo.tags.primaryDeviceHeight){var e=this.options.appInfo.tags.primaryDeviceHeight/this.options.appInfo.tags.primaryDeviceWidth;if(e>0){if(this.options.maxWidth){var t=(i=parseInt(this.options.maxWidth,10))*e;if(this.options.maxHeight){var n=parseInt(this.options.maxHeight,10);t>n&&(i=n/e,t=n)}return{width:i+"px",height:t+"px"}}var i;return this.options.maxHeight?{width:(i=(t=parseInt(this.options.maxHeight,10))/e)+"px",height:t+"px"}:e>1?{height:"100%",width:(i=100/e)+"%"}:{width:"100%",height:(t=100*e)+"%"}}return console.log("Aspect ratio is: "+e),this._generateIframeSizeWithNoAspectRatio()}return this._generateIframeSizeWithNoAspectRatio()},n.prototype._generateIframeSizeWithNoAspectRatio=function(){return{width:this.options.maxWidth?parseInt(this.options.maxWidth,10)+"px":"100%",height:this.options.maxHeight?parseInt(this.options.maxHeight,10)+"px":"100%"}},n.prototype.overrideWebPlayerPathSegment=function(e){this.webplayerPathSegmentToUse=e},n.prototype._fetchSDKMetadataAndLoad=function(){var e="";e=this._isCallingServiceFabricEndpoint()?this.options.hostName+"sdk/metadata":this.options.hostName+this.webplayerPathSegmentToUse+"/SDKMetadata";var t=this._injectSDKOrchestratorScriptAndRenderApp.bind(this),n=this._renderWebPlayerApp.bind(this),i=this._renderAppWithSdkOrchestrator.bind(this),o=new XMLHttpRequest;o.onload=function(){var e=!0;if(200===this.status){var r=o.responseText;try{var s=JSON.parse(r);s.defaultPublishedAppUrlTemplate&&s.orchestratorScriptLocation&&("undefined"!=typeof WebPlayerSDKOrchestrator?(e=!1,i(s)):(e=!1,t(s,s.orchestratorScriptLocation)))}catch(e){}}e&&n()},o.onerror=function(){n()},o.open("GET",e),o.send()},n.prototype._injectSDKOrchestratorScriptAndRenderApp=function(e,t){var n=document.createElement("SCRIPT");n.setAttribute("crossorigin","anonymous"),n.type="text/javascript",n.async=!1;var i=this._renderWebPlayerApp.bind(this),o=this._renderAppWithSdkOrchestrator.bind(this);n.addEventListener("error",(function(e){i()})),n.addEventListener("load",(function(t){o(e)})),document.head.appendChild(n),n.src=t},n.prototype._renderAppWithSdkOrchestrator=function(e){var t=this;window.addEventListener("message",this._onMessageReceived);var n=this._generateIframeSize();this.sdkOrchestrator=new WebPlayerSDKOrchestrator.SDKOrchestrator(this.containerElement,this._constructUrl(!1),e,this.options.cachedFilesJson,n.width,n.height,this.options.appId,this.options.packagePropertiesJson,this.params);var i=this.sdkOrchestrator.setupIframes();this.iframe=i.hostIframe,this.queuedCdpData.forEach((function(e){t._sendCdpData(e)})),this.queuedCdpData=[],this._initEmbeddingLogger(this.iframe)},n.prototype._sendCdpData=function(e){this.sdkOrchestrator.sendCdpData(e,this.options.overrideSendCdpDataApiEnabled)},n.prototype._renderWebPlayerApp=function(){var e=this._constructUrl(!1);this.iframe=this._createFrame(e),window.addEventListener("message",this._onMessageReceived),this.options.cachedFilesJson=null,this.iframe.name="webPlayer-iFrame",this.containerElement.appendChild(this.iframe),this.options.perceivedNodeQuerySelector&&(this.preceivedNodeToWatch=document.querySelector(this.options.perceivedNodeQuerySelector),this._trackEmbeddedPlayerVisibility()),this._initEmbeddingLogger(this.iframe)},n.prototype._initEmbeddingLogger=function(e){this.embeddingLogger=new t.EmbeddingLogger((function(n){var i={api:t.PowerAppsEmbeddingCallbackApi.Log,data:n};e.contentWindow.postMessage(i,"*")}))},n.prototype._renderConsentPage=function(){this.options.consentDialogOpenCloseHandler&&this.options.consentDialogOpenCloseHandler(!0);var e=this._constructUrl(!0);this.consentIframe=this._createFrame(e),this.consentIframe.name="consentService-iFrame",this.consentContainerElement.appendChild(this.consentIframe)},n.prototype._createFrame=function(e){var t=document.createElement("iframe");if(t.src=e,t.scrolling="no",t.setAttribute("allow","geolocation *; microphone *; camera *; fullscreen *;"),t.allowFullscreen=!0,!navigator.userAgent.match("Edge")){var n=["allow-popups","allow-popups-to-escape-sandbox","allow-same-origin","allow-scripts","allow-forms","allow-orientation-lock"];t.sandbox&&t.sandbox.add?n.forEach((function(e){return t.sandbox.add(e)})):t.setAttribute("sandbox",n.join(" "))}var i=this._generateIframeSize();return t.width=i.width,t.height=i.height,t.style.boxSizing="border-box",t.style.border="none",t},n.prototype.renderApp=function(){this.options.cachedFilesJson&&!this.sdkOrchestrator?this._fetchSDKMetadataAndLoad():this.iframe||this.options.cachedFilesJson||this._renderWebPlayerApp()},n.prototype.dispose=function(){e.prototype.dispose.call(this),this.iframe&&!this.sdkOrchestrator&&(this.containerElement.removeChild(this.iframe),this.iframe=null),this.sdkOrchestrator&&this.sdkOrchestrator.dispose(),this._disposeConsentPage(),this.eventListeners={},window.removeEventListener("message",this._onMessageReceived)},n.prototype._disposeConsentPage=function(){this.consentIframe&&(this.consentContainerElement.removeChild(this.consentIframe),this.consentIframe=null,this.options.consentDialogOpenCloseHandler&&this.options.consentDialogOpenCloseHandler(!1))},n.prototype.addEventListener=function(e,t){if("function"!=typeof t)throw new TypeError("Event listener must be a function");this.eventListeners.hasOwnProperty(e)?this.eventListeners[e].push(t):this.eventListeners[e]=[t]},n.prototype.removeEventListener=function(e,t){if(this.eventListeners.hasOwnProperty(e)){var n=this.eventListeners[e].indexOf(t);-1!==n&&this.eventListeners[e].splice(n,1)}},n.prototype._fireEvent=function(e,t,n,i){if(this.eventListeners.hasOwnProperty(e)){var o=t;t=o.substring(o.lastIndexOf("/")+1),this.eventListeners[e].forEach((function(e){return e(t,o,n,i)}))}},n.prototype._onMessageReceived=function(e){var n=this;if(this.validateMessageOrigin(e)){var i=e.data;if(i&&void 0!==i.api){var o="";switch(i.api){case t.PowerAppsEmbeddingCallbackApi.AppLoaded:o="load";break;case t.PowerAppsEmbeddingCallbackApi.AppClosed:o="unload";break;case t.PowerAppsEmbeddingCallbackApi.AppFailed:o="error";break;case t.PowerAppsEmbeddingCallbackApi.EnableSave:o="enableSave";break;case t.PowerAppsEmbeddingCallbackApi.DelegateLaunchUrl:t.isDelegateLaunchUrlEventCallBackParams(i)&&(o="delegateLaunchUrl");break;case t.PowerAppsEmbeddingCallbackApi.RequestHide:o="requestHide";break;case t.PowerAppsEmbeddingCallbackApi.SendTrigger:t.isAppToHostFunctionsEventCallBackParams(i)&&(o="sendTrigger");break;case t.PowerAppsEmbeddingCallbackApi.ReadyToHandleMessages:return void(this.preceivedNodeToWatch&&this._reportEmbeddedPlayerVisibility());case t.PowerAppsEmbeddingCallbackApi.SendTelemetryEvent:t.isAppToHostTelemetryEventCallBackParams(i)&&(o="telemetry");break;case t.PowerAppsEmbeddingCallbackApi.InteractionRequired:o="interactionRequired",this.options.standAloneConsent&&i&&i.data&&"AppPermissionDialog"===i.data.source&&(t.EmbeddingConsentFlowHelper.onConsentServiceLoaded(i),this.options.consentDialogUserInteractionHandler&&this.options.consentDialogUserInteractionHandler());break;case t.PowerAppsEmbeddingCallbackApi.OpenConsentPage:t.EmbeddingConsentFlowHelper.initializeConsentService({logger:this.embeddingLogger,renderConsentPage:function(){n._renderConsentPage()},postMessageToConsentService:function(e){n.consentIframe&&n.consentIframe.contentWindow&&n.consentIframe.contentWindow.postMessage(e,"*")}},i);break;case t.PowerAppsEmbeddingCallbackApi.CloseConsentPage:this._disposeConsentPage();break;case t.PowerAppsEmbeddingCallbackApi.SetConsentResult:var r={api:t.PowerAppsEmbeddingCallbackApi.SetConsentResult,data:i.data};this.iframe.contentWindow.postMessage(r,"*");break;case t.PowerAppsEmbeddingCallbackApi.OpenConnectorAuthPopup:this.options.openConnectorAuthPopup(i.data,this._processConnectorAuthResult);break;case t.PowerAppsEmbeddingCallbackApi.GetPreloadConsentServiceData:t.EmbeddingConsentFlowHelper.sendPreloadDataToConsentService()}!o||i.appId&&i.appId.toLowerCase()!==this.options.appId.toLowerCase()||i.containerId&&i.containerId!==this.options.containerId||this._fireEvent(o,i.appId,i.containerId,i)}}},n.prototype._processConnectorAuthResult=function(e){if(e&&e.result){var n={api:t.PowerAppsEmbeddingCallbackApi.SetConnectorAuthResult,data:e};this.consentIframe.contentWindow.postMessage(n,"*")}},n.prototype._trackEmbeddedPlayerVisibility=function(){var e=this;"undefined"!=typeof MutationObserver&&new MutationObserver((function(t,n){t.some((function(t){return[e.containerElement,e.iframe].some((function(e){return t.target.contains(e)||t.target===e}))}))&&e._reportEmbeddedPlayerVisibility(n)})).observe(this.preceivedNodeToWatch,{attributes:!0,subtree:!1})},n.prototype._reportEmbeddedPlayerVisibility=function(e){var i=n._isElementOnScreen(this.iframe);this.isPlayerVisible!==i&&this.iframe&&(this.isPlayerVisible=i,this.iframe.contentWindow.postMessage({api:t.PowerAppsEmbeddingCallbackApi.VisibilityChanged,visible:this.isPlayerVisible},"*"),e&&e.disconnect())},n._isElementOnScreen=function(e){if(e){var t=function(e,t){return e.top<=t.top&&e.bottom>=t.bottom&&e.left<=t.left&&e.right>=t.right},n=e.offsetWidth+e.offsetHeight,i=-1===["hidden","collapsed"].indexOf(getComputedStyle(e).visibility),o=t(document.body.getBoundingClientRect(),e.getBoundingClientRect());return!!n&&i&&o}return!1},n.prototype._isCallingServiceFabricEndpoint=function(){return!!this.options.hostName&&/https:\/\/apps(\.\w+)?\.powerapps\.(com|us)/.test(this.options.hostName)},n}(e.Embedding.CoreEmbedding);t.PowerAppsEmbedding=n}(t.Sdk||(t.Sdk={}))}(t||(t={})),function(e){!function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(Error);e.PowerAppsEmbeddingError=t}(e.Sdk||(e.Sdk={}))}(t||(t={})),t})?i.apply(t,o):i)||(e.exports=r)},"i+Mw":function(e,t,n){"use strict";n.r(t),n.d(t,"CustomPage",(function(){return G}));var i=n("gw2m"),o=n("nuS9"),r=n("4fxQ"),s=n("YWpA"),a=n("u+q+"),p=n("N0PS"),c=n("C8PA"),d=n("arV0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e,t){return e.metadata.canvasapps[t]}var u=n("3/02"),h=n("Lyxw"),m=n("QBtP"),f=n("2YQW"),g=n("7cfk"),b=n("wL2W"),v=n("sra9"),w=n("gQ5I"),C=n("pgSX"),E=n("si7p"),y=n("EY5k"),A=n("YxC/"),I=n("tICD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function O(e,t){return{type:"HANDLE_CUSTOMPAGE_INIT_ERROR",async execute({dispatch:n,getState:i},o){var r,s;const a={type:"error"},p=["Button_Label_OK","Web.Dialog.ErrorCode_Caption","L_Show_Details_Text","L_Client_Session_Id","L_Server_Activity_Id","L_Current_Time","Error_Title_Generic"];let c=null===(r=null==t?void 0:t.errorInfo)||void 0===r?void 0:r.localizedMessage;const d=["Error_Title_Generic","Crm.GenericErrorMessage"];try{await n(Object(y.e)(p));const r=Object(A.e)(i(),p),d=Object(A.c)(r,"Error_Title_Generic");c=c||d;const l=Object(A.c)(r,"Button_Label_OK"),u=Object(A.c)(r,"L_Show_Details_Text"),h=Object(A.c)(r,"L_Client_Session_Id"),m=Object(A.c)(r,"L_Current_Time"),f=Object(A.c)(r,"L_Server_Activity_Id"),g=h.replace("{0}",o.EventManager.getCurrentSessionId()),b=f.replace("{0}",o.EventManager.getActivityId()),v=[c,g,b,m.replace("{0}",""+new Date)],O=await n(Object(C.a)(E.d,c,a,l,d,c,l,u,v,!0,e,void 0));if(0!==O.status)throw O.error;await n(Object(I.a)(O.pageId));o.TraceManager.getTracer("CUSTOMPAGE_ERROR_TRACER_CATEGORY").error(c,[{name:"code",value:null===(s=null==t?void 0:t.errorInfo)||void 0===s?void 0:s.code},{name:"errordetails",value:null==t?void 0:t.errorInfo.description},{name:"timestamp",value:null==t?void 0:t.errorInfo.timestamp}]),n(Object(w.e)(e,"dismiss"))}catch(r){if(t&&t.errorInfo){o.TraceManager.getTracer("CUSTOMPAGE_ERROR_TRACER_CATEGORY").error(c,[{name:"code",value:t.errorInfo.code},{name:"errordetails",value:t.errorInfo.description},{name:"timestamp",value:t.errorInfo.timestamp}])}await n(Object(y.e)(d));const s=Object(A.e)(i(),d),p=Object(A.c)(s,"Error_Title_Generic"),l=Object(A.c)(s,"Crm.GenericErrorMessage");await n(Object(C.a)(E.d,"",a,"",p,l)),n(Object(w.e)(e,"dismiss"))}}}}var P=n("BfRu"),S=n("SAYH"),k=n("zJiL"),T=n("JVKK"),_=n("b8TU"),R=n("KOTC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const L={marginTop:0,borderTop:"1px solid #E8EAEC",borderBottom:"1px solid #D8D8D8"};const D=Object(a.a)((function(){let e,t;return function(n,i){const o=Object(d.h)(n,i.id);t!==o&&(t=o,e=Object.values(t));const r=Object(_.c)(n);return{notificationList:e,viewPortWidth:r}}}))((function(e){return e.notificationList&&e.notificationList.length>0?o.createElement(R.a,{loader:()=>Promise.all([n.e(29),n.e(45)]).then(n.bind(null,"XfPn")).then(e=>e.BarNotificationList),props:{id:"page-notification-list",domWidth:e.viewPortWidth,notificationList:e.notificationList,customStyle:L}}):null}));var H=n("QHx/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const x={display:"flex",flexDirection:"column",flex:"1",maxWidth:"100%",overflow:"hidden",height:"100%"},j={width:"100%",height:"100%"};function N(e){var t;switch(null===(t=null==e?void 0:e.notificationInfo)||void 0===t?void 0:t.notificationType){case"error":return k.a;case"success":return k.d;case"warning":return k.e;case"info":default:return k.b}}function M({id:e}){const{canvasAppName:t,appId:n,recordId:i,entityName:w}=Object(a.d)(t=>{var n;const i=Object(d.g)(t,e);return{canvasAppName:i.name,appId:null===(n=l(t,i.name))||void 0===n?void 0:n.canvasappid,recordId:i.recordId,entityName:i.entityName}},f.e),C=Object(a.d)(v.e),E=Object(a.c)(),y=`custompage_${e}_${n}`,A=o.useRef(null),I=Object(a.d)(e=>Object(h.c)(e,u.Ad)),_=Object(a.d)(v.c),R=Object(a.d)(v.b),L=o.useContext(m.a).Router,M=Object(a.d)(t=>Object(H.a)(t,e)),W=L.getHistoryManager().GetHistoryLength(M)>1,U=Object(a.e)(),q=o.useContext(m.a),G=o.useRef(new p.a(U,e,q)),z=o.useContext(m.a).AppHostClient,B=Object(b.b)(),F=B.u&&B.s&&{mep:B.u,mss:B.s};return o.useLayoutEffect(()=>{if(void 0===n)return;if(I){const n=A.current;let o,s=!1;const a=function(e,t){return function(n){if(n&&n.errorInfo){const i=S.a.newGuid().guid;e(Object(P.b)({Level:k.a,Message:n.errorInfo.localizedMessage,UniqueId:i,CloseAction:Object(T.b)(i,t)},t))}}}(E,e),p=function(e,t){return function(n){if(n&&n.notificationInfo){const i=n.notificationInfo.timeoutInMilliSec,o=S.a.newGuid().guid;e(Object(P.b)({Level:N(n),Message:n.notificationInfo.message,UniqueId:o,CloseAction:Object(T.b)(o,t)},t)),i>0&&1e4!==i&&setTimeout(()=>{e(Object(T.b)(o,t))},i)}}}(E,e);return(async()=>{if(_!==g.a.Initialize_Failed){if(_!==g.a.Not_Initialized)try{if(o=await z.getCanvasAppAsync(t),s)return;o.on("canvasAppRuntimeError",a),o.on("canvasAppNotification",p);const e=r.findDOMNode(n);let c;(i||w||W)&&(c={},i&&(c.recordId=i),w&&(c.entityName=w),W&&(c.canNavigateBack=W));const d={containerDiv:e,rootAppServices:{Xrm:G.current},params:c};await o.renderAsync(d)}catch(t){E(O(e,t))}}else E(O(e,R))})(),()=>{s=!0,o&&(o.off("canvasAppRuntimeError",a),o.off("canvasAppNotification",p),o.dispose())}}const o=new c.Sdk.PowerAppsEmbedding({appId:n,containerId:y,hostName:C,parameters:F});return o.renderApp(),()=>o.dispose()},[y,C,I,n,t,_,z,A,F,i,w,E,e,R,W,G]),o.createElement(s.a,{style:x},o.createElement(D,{id:e}),o.createElement(s.a,{id:y,ref:A,style:j}))}var W=n("Nb1E"),U=n("zsAz");var q=n("wge3");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class G{constructor(e){this._id=e}getName(){return i.a}getId(){return this._id}getInitializationAction(){return e=this._id,{type:"custompage.initialize",async execute({dispatch:t,getState:n}){const i=n(),{name:o}=Object(d.g)(i,e);if(l(i,o))return;const r=(await t(Object(W.e)("canvasapp",`?$filter=name eq '${encodeURIComponent(o)}'&$select=canvasappid,displayname`))).value[0];if(!r)throw Object(U.d)("Cannot find page with specified name",void 0,[{name:"pageName",value:o}]);t(function(e){return{type:"metadata.canvasapp.add",payload:e}}({name:o,canvasappid:r.canvasappid,displayname:r.displayname})),Object(h.c)(i,u.Ad)&&t(Object(q.initializeAppHostClient)(r.canvasappid))}};var e}getRootReducer(){return e=>e}getRootComponent(){return M}getCloseAction(e){}}},sra9:function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"a",(function(){return u}));var i=n("NjDY"),o=n("hAdb"),r=n("Lyxw"),s=n("3/02"),a=n("twWZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function p(e){return e.appHostClient.initialized}function c(e){return e.appHostClient.error}function d(e){const{geoName:t,isSovereignCloud:n}=Object(i.x)(e);if(Object(r.c)(e,s.yc))return"Test";switch(null==t?void 0:t.toUpperCase()){case"TIP":const t=Object(o.b)(e,"canvashostenv");switch(null==t?void 0:t.toUpperCase()){case"LOCAL":return"Local";default:return"Test"}case"USG":return"GccHigh";case"NA":if(n)return"Gcc";default:const i=Object(o.b)(e,"canvashostenv");switch(null==i?void 0:i.toUpperCase()){case"PREVIEW":return"Preview";case"INT":return"Int";case"PREPROD":return"Preprod";default:return"Prod"}}}function l(e){switch(d(e)){case"Local":return a.Endpoint.Local;case"Test":return a.Endpoint.Test;case"Int":return a.Endpoint.Int;case"Preprod":return a.Endpoint.Preprod;case"Gcc":return a.Endpoint.Gcc;case"GccHigh":return a.Endpoint.GccHigh;case"Preview":return a.Endpoint.Preview;default:return a.Endpoint.Prod}}function u(e){return e.appHostClient.bundleLoaded}},wge3:function(e,t,n){"use strict";n.r(t),n.d(t,"initializeAppHostClient",(function(){return f})),n.d(t,"getRootAppId",(function(){return b})),n.d(t,"getRootAppLogicalName",(function(){return v})),n.d(t,"runWindowOverrides",(function(){return w}));var i=n("hAdb"),o=n("7cfk"),r=n("P4TJ"),s=n("sra9"),a=n("eL04"),p=n("SAYH"),c=n("P+p9"),d=n("9eA9"),l=n("IqkD"),u=n("EY5k"),h=n("YxC/");function m(e){switch(e){case"error":return 2;case"success":return 1;case"warning":return 3;case"info":default:return 4}}function f(e){return{type:"apphostclient.initialize.async",async execute(t,n){var i,d,f;if(!n.AppHostClient){if(!Object(s.a)(t.getState())){const e=(f=t.getState(),Object(s.e)(f)+"/apphost/clientsdk?version=1");await n.AssetLoader.loadScript(e),t.dispatch({type:r.a,payload:!0})}const v=b(t.getState(),e),w={authMode:5,endpoint:Object(s.e)(t.getState()),_rootAppId:v,hostConfig:{correlationId:n.EventManager.getCurrentSessionId(),locale:Object(l.w)(t.getState()).formatInfoCultureName,source:"UCI"}};try{await function(e,t,n){let i;const o=new Promise((e,t)=>{i=setTimeout(()=>t({message:"PowerAppsHostingSdk.initializeAsync timed out"}),n)}),r=PowerAppsHostingSdk.initializeAsync(t).then(t=>{clearTimeout(i),e.AppHostClient=t});return Promise.race([r,o])}(n,w,9e4),n.AppHostClient.on("appHostClientErrorEvent",(d=t.dispatch,function(e){e&&e.errorInfo&&d(Object(a.b)({level:2,message:e.errorInfo.localizedMessage,id:p.a.newGuid().guid,type:2,showCloseButton:!0}))})),n.AppHostClient.on("appHostClientNotification",function(e){return function(t){if(t&&t.notificationInfo){const n=t.notificationInfo.timeoutInMilliSec,i=p.a.newGuid().guid;e(Object(a.b)({level:m(t.notificationInfo.notificationType),message:t.notificationInfo.message,id:i,type:2,showCloseButton:!0,onCloseHandler:t.notificationInfo.clickHandler})),n>0&&1e4!==n&&setTimeout(()=>{e(Object(c.b)(i))},n)}}}(t.dispatch)),t.dispatch({type:r.b,payload:{initialized:o.a.Initialized,error:void 0}})}catch(o){if(null===(i=null==o?void 0:o.errorInfo)||void 0===i?void 0:i.code)t.dispatch(g(o));else{const e="Crm.GenericErrorMessage",n=[e];t.dispatch(Object(u.e)(n)).then(()=>{const i=Object(h.e)(t.getState(),n);t.dispatch(g({errorInfo:{code:"unknown",localizedMessage:Object(h.c)(i,e),timestamp:Date.now(),description:(null==o?void 0:o.message)||"Unknown error occured while initializing apphostclient"}}))})}const r=[{name:"environment",value:Object(s.d)(t.getState())},{name:"appId",value:e}];throw n.EventManager.ReportComponentFailure("CustomPage.SharedAppHostInitialize",o,void 0,r),o}}}}}function g(e){return{type:r.c,payload:{initialized:o.a.Initialize_Failed,error:e}}}function b(e,t){return Object(i.e)(e,"rootAppId")||t}function v(e,t){return Object(i.b)(e,"appLogicalName")||t}function w(e){const t=e.TraceManager.getTracer("TrustedUCI");XMLHttpRequest=window.routedXHR;const n=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(){const e=arguments[0];let i=arguments[1];const o=arguments[2];if(!1===o){const e=[{name:"url",value:i}];t.error("Sync call attempted",e)}const r=arguments[1].indexOf("/webresources/");if(-1!==r){const e=i.slice(r+"/webresources/".length);i=`${Object(d.b)()}/api/data/v9.0/webresourceset?$filter=name eq '${e}'&$select=content`;const t=this.onload;this.onload=()=>{var e;try{const t=JSON.parse(this.responseText);this._responseText=atob(null===(e=null==t?void 0:t.value[0])||void 0===e?void 0:e.content)}catch(e){}t(this)}}-1===i.indexOf("https://")&&(i=Object(d.b)()+i),n.call(this,e,i)},window.fetch=e=>new Promise((t,n)=>{const i=new XMLHttpRequest;i.open(e.method,e.url),e.headers.forEach((e,t)=>{i.setRequestHeader(t,e)}),i.onload=function(){const e=204===i.status?null:i.response||i.responseText,n=new Headers;i.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach(e=>{const t=e.split(": ");n.append(t.shift(),t.join(": "))});const o=new Response(e,{status:i.status,statusText:i.statusText,headers:n});t(o)},i.onerror=function(){n("Error")},e.text().then(e=>{i.send(e)})})}},zJiL:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"f",(function(){return p}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="SUCCESS",o="ERROR",r="WARNING",s="INFORMATION",a="LOCKED",p=new Set([a])}}]),window.bundleExecutionMarkers["scripts/custompage.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();