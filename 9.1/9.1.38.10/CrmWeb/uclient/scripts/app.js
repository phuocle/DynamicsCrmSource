(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/app.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},function(e){function t(t){for(var r,o,s=t[0],c=t[1],l=t[2],d=0,p=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&p.push(a[o][0]),a[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(u&&u(t);p.length;)p.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==a[c]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={41:0},i=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,r){n=a[e]=[t,r]}));t.push(n[2]=r);var i,s=document.createElement("script");s.charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.src=function(e){return o.p+"scripts/"+({18:"monaco_editor",23:"dialogpage",24:"offlinets",25:"performancescenarios",26:"previewsync",32:"ColumnEditor",33:"DataSetExpressionBuilder",34:"GlobalSearchFlyout",35:"InitializeOfflineLifecycleAsyncAction",36:"MdlProvider",37:"NativeComponents",38:"OfflineStatusFileDownloadStatusList",39:"OpenOfflineStatusDialogAction",40:"activityTypeComboBox",42:"appNameBar",43:"appshellpage",44:"appspage",45:"barnotificationlist",46:"benchmarkpage",47:"breadcrumbbar",48:"businessprocesspagewrapper",49:"cardfeedcontainerflyout",50:"commandchecker",51:"contextualHelpBrowser",52:"contextualHelpBrowser.strings",53:"cordovamediadispatcher",54:"customcontrolpage",55:"custompage",56:"dashboardpage",57:"datadispatcher",58:"developerconsole",59:"documentdispatcher",60:"dynamicsOct2020",61:"editformpage",62:"externalcontextdispatcher",63:"formheaderv2",64:"globalSearchBoxContainer",65:"globalbarnotification",66:"globalcommandbar",67:"gridpage",68:"initializeAppHostClientModule",69:"initializeOfflineUpsyncProcessAsyncAction",70:"kbarticlepage",71:"kbsearchpage",72:"legacydialogpage",73:"livepersonacard",74:"localdeploymenthandler",75:"loggingdispatcher",76:"lookupdialogpage",77:"mailapp",78:"mds",79:"mobilescrollabletabs",80:"modaldialogpage",81:"modelformcomponent",82:"monitor",83:"multimediadispatcher",84:"multisession",85:"nativeplatform",86:"navbar",87:"navigationdispatcher",88:"networkdispatcher",89:"officeapplauncher",90:"officefabric",91:"officewaffle",92:"officewaffleplaceholder",93:"offlineODataCRUD",94:"offlinestatusdialogpage",95:"performanceinterface",96:"popupnotification",97:"powerbifullscreenpage",98:"previewform",99:"querypage",100:"quickcreateformpage",101:"searchpage",102:"sidepanel",103:"sitemappanel",104:"taskbasedflowmenu",105:"taskbasedflowpage",106:"toastnotificationlist",107:"upgraderunner",108:"webplatform",109:"webresourcepage",110:"welcomepagedialog"}[e]||e)+".js?v=1.4.9962-v91onpremise"}(e),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous");var c=new Error;i=function(t){s.onerror=s.onload=null,clearTimeout(l);var n=a[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+r+": "+i+")",c.name="ChunkLoadError",c.type=r,c.request=i,n[1](c)}a[e]=void 0}};var l=setTimeout((function(){i({type:"timeout",target:s})}),12e4);s.onerror=s.onload=i,document.head.appendChild(s)}return Promise.all(t)},o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o.oe=function(e){throw console.error(e),e};var s=window.__wpJsonpUci=window.__wpJsonpUci||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;i.push(["DPXt",9]),n()}({"+5Bq":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){if(e)switch(e.toLowerCase()){case"false":return!1;case"true":return!0;default:return}}n.d(t,"a",(function(){return r}))},"+7Rg":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Button_Label_Close",a="RecordSetNavigator.button.name",i=[r,a]},"+Ajx":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="form.related.select";function i(e,t,n){const i=Object(r.v)(t);return{type:a,payload:n,meta:{pageId:e,contextKey:i}}}},"+BIz":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("pgSX"),a=n("si7p");function i(e,t,n,i,o,s,c){const l=[{name:"dialogHeight",value:t&&t.height},{name:"dialogWidth",value:t&&t.width},{name:"dialogPosition",value:t&&t.position},{name:"dialogWindowPosition",value:t&&t.windowPosition}];return{type:"form.openConfirmDialog",execute:({dispatch:l,getState:u},d,p)=>l(Object(r.a)(a.c,e,t,s,n,o,c,void 0,void 0,void 0,i)),getFailureParameters:(e,t)=>l}}},"+Kwi":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e,t,n,r,a,i){this._day=0,this._dayOfWeek=0,this._month=0,this._week=0,this._timeOfDay=null,this._isFixedDateRule=!1,this._day=e,this._dayOfWeek=t,this._month=n,this._week=r,this._timeOfDay=a,this._isFixedDateRule=i}get_Day(){return this._day}get_DayOfWeek(){return this._dayOfWeek}get_Month(){return this._month}get_Week(){return this._week}get_TimeOfDay(){return this._timeOfDay.format("s")}get_IsFixedDataRule(){return this._isFixedDateRule}getObjectData(){const e={};return e.day=this._day,e.dayofweek=this._dayOfWeek,e.month=this._month,e.week=this._week,e.timeofday=this.get_TimeOfDay(),e.isfixeddaterule=this._isFixedDateRule,e}static createFromObjectData(e){const t=e.day,n=e.dayofweek,a=e.month,i=e.week,o=new Date(e.timeofday),s=e.isfixeddaterule;return new r(t,n,a,i,o,s)}}},"+Szo":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e){this.length=e.rows.length,this._nativeResult=e}item(e){const t=this._nativeResult.rows[e];if(!t)return null;const n={};for(let e=0;e<this._nativeResult.columnNames.length;++e){n[this._nativeResult.columnNames[e]]=t[e]}return n}}},"+VI0":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("XosO"),a=n("Cfpy"),i=n("IH+v");t._Utf8_GetBytes=function(e){for(var t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?t.push(192|r>>6,128|63&r):r<55296||r>=57344?t.push(224|r>>12,128|r>>6&63,128|63&r):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++n)),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return t},t._Base64_GetString=function(e){for(var t,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[],a=e.length%3,i=0,o=e.length-a;i<o;i+=3){var s=(e[i]<<16)+(e[i+1]<<8)+e[i+2];r.push([n.charAt((t=s)>>18&63),n.charAt(t>>12&63),n.charAt(t>>6&63),n.charAt(63&t)].join(""))}switch(a){case 1:s=e[e.length-1];r.push(n.charAt(s>>2)),r.push(n.charAt(s<<4&63)),r.push("==");break;case 2:var c=(e[e.length-2]<<8)+e[e.length-1];r.push(n.charAt(c>>10)),r.push(n.charAt(c>>4&63)),r.push(n.charAt(c<<2&63)),r.push("=")}return r.join("")},t._Varint_GetBytes=function(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t},t._Varint64_GetBytes=function(e){for(var t=e.low,n=e.high,r=[];n||4294967168&t;)r.push(127&t|128),t=(127&n)<<25|t>>>7,n>>>=7;return r.push(127&t),r},t._Double_GetBytes=function(e){if(i.BrowserChecker._IsDataViewSupport()){var t=new DataView(new ArrayBuffer(8));t.setFloat64(0,e,!0);for(var n=[],r=0;r<8;++r)n.push(t.getUint8(r));return n}return a.FloatUtils._ConvertNumberToArray(e,!0)},t._Zigzag_EncodeZigzag32=function(e){return(e=r.Number._ToInt32(e))<<1^e>>31},t._Zigzag_EncodeZigzag64=function(e){var t=e.low,n=e.high,a=n<<1|t>>>31,i=t<<1;2147483648&n&&(a=~a,i=~i);var o=new r.UInt64("0");return o.low=i,o.high=a,o}},"+XGO":function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("i1f0"),a=n("TYIz"),i=n("eL7I"),o=n("PidC"),s=n("Lyxw"),c=n("3/02"),l=n("SWZ5"),u=n("y60j"),d=n("zmL5"),p=n("jq7Z"),g=n("dHD5"),h=n("64CY");function f(e,t,n){const a=[{name:"controlName",value:n}];return{type:"control.setfocus",execute({dispatch:f,getState:b},_,y){var v,S;const O=b(),C=Object(p.a)(O,e);if(C.parentComponentId){const t=Object(p.a)(O,C.parentComponentId),n=Object(g.j)(b(),C.parentComponentId),i=null===(S=null===(v=t.formInstances)||void 0===v?void 0:v.controlNameByFormInstanceId)||void 0===S?void 0:S[e];if(i){const e=Object(r.C)(O,C.parentComponentId,i,n);m(O,C.parentComponentId,i,n,y,a,f,e.parentSectionName,e.domId)}}let E,{parentSectionName:I,domId:w}=Object(r.C)(O,e,n,t);if(m(O,e,n,t,y,a,f,I,w),I&&(E=Object(r.sc)(O,e,I,t).parentTabId),!E){const a=Object(s.a)(O,c.mb),l=Object(o.g)(O,{id:e},t);if(a&&l){const r=Object(o.j)()(O,{id:e,contextToken:t});for(let e=0;e<r.length;e++)if(r[e].Name===n){document.getElementById(i.b).click();break}}if(!a){Object(r.ub)(O,e,t).has(n)&&document.getElementById(i.b).click()}}const j=Object(h.c)(n);if(j){const n=j[0],a=Object(r.C)(O,e,n,t);w=a.domId,I=a.parentSectionName}if(w){_.AccessibilityManager.setClientAPISetFocusElementId(w);const t=Object(d.b)(O,e),a=Object(u.b)(O,e,t,n);if(a&&a.ParentSectionName&&a.ParentSectionName.startsWith(r.e)){const t={id:a.Id,title:a.Label,type:l.a};f(Object(l.b)(t,!1,e))}E&&_.IntersectionObserverManager.intersectAll(E)}return Promise.resolve()},getFailureParameters:(e,t)=>a}}function m(e,t,n,i,o,s,c,l,u){const d=Object(r.vb)(e,t,n,i);s.push({name:"CorrelationId",value:o.correlationId},{name:"ContextId",value:o.contextId},{name:"ActionStack",value:o.stack},{name:"parentSectionName",value:l},{name:"hiddenTabName",value:d},{name:"domId",value:u}),d&&c(Object(a.b)(t,d,i))}},"+YnR":function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n("dHD5"),a=n("WKRf"),i=n("uWQm"),o=n("SAYH"),s=n("SnEr"),c=n("69Qu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e,t,n,o){const l=e.getState(),u=Object(r.h)(t);e.dispatch(Object(a.b)(o,!0,u)),e.dispatch(Object(i.c)(n,Object(c.b)(l))),e.dispatch(Object(s.b)({etn:t,id:n}))}function u(e,t,n){const s=e.getState(),l=new Set;t.forEach(e=>l.add(e.entityType)),l.forEach(t=>{const i=Object(r.h)(t);e.dispatch(Object(a.b)(n,!0,i))}),e.dispatch(Object(i.d)(t.map(e=>o.a.parse(e.id)),Object(c.b)(s)))}},"+baL":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("OKVy"),a=n("ruPX");function i(e,t,n,i,o,s,c){const l={navPath:e,dashboardId:t,etn:i,type:o,canOverride:s};return Object(a.a)(r.a,l,c,n)}},"+nNZ":function(e,t,n){"use strict";n.d(t,"f",(function(){return g})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"h",(function(){return h})),n.d(t,"g",(function(){return f})),n.d(t,"e",(function(){return l}));var r=n("eXjw"),a=n("SAYH"),i=n("5Oca"),o=n("iZ7K"),s=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e,t){return e&&e.metadata&&e.metadata.businessProcessFlows&&t&&t.guid&&e.metadata.businessProcessFlows.hasOwnProperty(t.guid)?e.metadata.businessProcessFlows[t.guid]:null}function l(e,t){const n=Object(o.h)(e,t);return!!n&&(n.IsBusinessProcessEnabled||n.IsBPFEntity)}function u(e,t){const n=Object(i.b)(t)(e,t.etn);return n&&n.fields?n.fields:null}function d(e,t){const n=c(e,t);return n?n.initialized:r.a.Uninitialized}function p(e,t,n,r){if(e&&!a.a.isNullOrEmpty(t)&&n&&r){const a=c(e,t);if(a&&a.businessProcessFlowStepEntityAttributeControls&&a.businessProcessFlowStepEntityAttributeControls[n])return a.businessProcessFlowStepEntityAttributeControls[n][r]}return null}function g(e,t){const n=Object(i.b)(t)(e,t.etn);return n?n.processInstanceModifiedTimestamp:null}function h(e){return e.businessProcessFlowData&&e.businessProcessFlowData.workflowObjectModelLibraryLoaded}function f(e,t){return!(!e.metadata||!e.metadata.businessProcessFlows)&&(!Object(s.a)(e.metadata.businessProcessFlows[t])&&!Object(s.a)(e.metadata.businessProcessFlows[t].initialized)&&Object(r.b)(e.metadata.businessProcessFlows[t].initialized))}},"+nTZ":function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("zsAz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return e.dialogContexts}function i(e,t){const n=a(e)[t];if(!n)throw Object(r.d)("Dialog context does not exist",2415919107,[{name:"id",value:t}]);return n}function o(e,t){const n=a(e);for(const e in n){if(n[e].contentPageId===t)return n[e];if(n[e].pageStack&&-1!==n[e].pageStack.indexOf(t))return n[e]}return null}},"+pAH":function(e,t,n){"use strict";n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return w})),n.d(t,"c",(function(){return P}));var r=n("SoYb"),a=n("Nb1E"),i=(n("lY/Z"),n("5Oca")),o=n("iZ7K"),s=n("LbMF"),c=n("qpML"),l=n("8nT0"),u=n("WPtp"),d=n("ZPAw"),p=n("SRlt"),g=n("9eA9"),h=n("NvOS"),f=n("bT7G"),m=n("i1f0"),b=n("69Qu"),_=n("37s6"),y=n("sZ+8"),v=n("7NKF"),S=n("h6c1");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const O="File.State";class C{constructor(e,t){this.done=e,this.value=t}}class E{getCurrentIndex(){return this.currentIndex}getNextChunkFromServer(){const e=[],t=j(this.attributeName,this.imageSizeResolution);e.push({name:"RequestUrl",value:t}),e.push({name:"FileSize",value:this.fileSize}),e.push({name:"ChunkSize",value:this.chunkSize}),e.push({name:"CurrentIndex",value:this.currentIndex});let n=null;if(0!==this.currentIndex||this.fileSize>this.chunkSize){let t=this.chunkSize;this.fileSize-this.currentIndex<this.chunkSize&&(t=this.fileSize-this.currentIndex);const r=this.currentIndex+t-1,a="bytes="+this.currentIndex+"-"+r;n={Range:a},e.push({name:"ChunkRange",value:a})}return this.dispatch(Object(a.d)(this.target,t,n,!0)).then(t=>(this.currentIndex=this.currentIndex+t.byteLength,e.push({name:"ChunkValueLengthReadFromFile",value:t.byteLength}),this.applicationContext.EventManager.ReportComponentSuccess("DownloadFile.ReadNextChunkFromServer",e),new Uint8Array(t))).catch(t=>(this.applicationContext.EventManager.ReportComponentFailure("DownloadFile.ReadNextChunkFromServer",t,"",e),Promise.reject(t)))}read(){const e=[];return e.push({name:"FileSize",value:this.fileSize}),e.push({name:"ChunkSize",value:this.chunkSize}),e.push({name:"AttributeName",value:this.attributeName}),e.push({name:"EntityName",value:this.target.etn}),this.getNextChunkFromServer().then(t=>{e.push({name:"CurrentIndex",value:this.currentIndex});let n=!0;this.currentIndex<this.fileSize&&(n=!1),e.push({name:"ChunkValueLengthReadFromFile",value:t.length}),e.push({name:"IsFileReadComplete",value:n}),this.applicationContext.EventManager.ReportComponentSuccess("DownloadFile.ReadNextChunk",e);const r=new C(n,t);return Promise.resolve(r)}).catch(t=>(e.push({name:"CurrentIndex",value:this.currentIndex}),this.applicationContext.EventManager.ReportComponentFailure("DownloadFile.ReadNextChunk",t,"",e),this.tracer.error("downloadFile : Failed to download file in single chunk case "),Promise.reject(t)))}}class I{getBinaryReader(e){0===e&&this.fileSize>16777216||this.fileSize>16777216&&e>4194304?e=4194304:0===e&&this.fileSize<=16777216&&(e=16777216);const t=new E;return t.imageSizeResolution=this.imageSizeResolution,t.fileSize=this.fileSize,t.mimeType=this.mimeType,t.attributeName=this.attributeName,t.dispatch=this.dispatch,t.tracer=this.tracer,t.target=this.target,t.chunkSize=e,t.applicationContext=this.applicationContext,t.currentIndex=0,this.textReader=t,t}}function w(e,t,n,r,a,i){return{type:O,payload:{identifier:e,attributeName:t,fileState:{fileProgress:n,operationType:c.a.Download,fileName:r,mimeType:a,fileSize:i}}}}function j(e,t){let n="";return n="/"+e+"/$value",t&&"full"===t&&(n=n+"?size="+t),n}function P(e,t,n,a,c){return{type:"FileDownload",sync:!0,execute({dispatch:O,getState:C},E){const w=C(),P=Object(m.ac)(w,n,a),T=Object(f.d)(w,P,t,e),N=Object(s.b)(e,t.etn,w);let A=l.h;const D=Object(d.a)(t,e,N);"image"===N&&(A=l.g);const R=Object(i.x)(w,t,D,e);if(R&&T.value){const n=R.fields.hasOwnProperty(A)?Object(u.c)(R.fields[A]):null,a=R.fields.hasOwnProperty(l.p)?Object(u.c)(R.fields[l.p]):null,i=R.fields.hasOwnProperty(l.f)?Object(u.c)(R.fields[l.f]):null,s=new I;s.applicationContext=E,s.dispatch=O,s.tracer=E.TraceManager.getTracer("DownloadFile"),s.fileName=i,s.target=t,s.mimeType=a,s.fileSize=Object(r.b)(n),s.attributeName=e,"image"===N&&c&&"full"===c&&(c=T.value.fullimageurl?"full":""),s.imageSizeResolution=c;const d=p.c.WEB_API_URL_FRAGMENT,f=Object(g.b)(),m=Object(h.a)(w,d);if("image"===N)s.thumbnailUrl=T.value.imageurl?`${f}${T.value.imageurl.value}`:null,s.fileUrl=T.value.fullimageurl?`${f}${T.value.fullimageurl.value}`:s.thumbnailUrl;else if(Object(b.b)(w)){const n=Object(o.o)(w,t.etn),r=j(e);s.fileUrl=`${f}${m}${n}(${t.id.guid})${r}`}else if(Object(_.w)(w)&&Object(y.l)(w,t.etn)){const e=R.fields.hasOwnProperty(l.c)?Object(u.c)(R.fields[l.c]):null,t=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){const t=Object(S.a)(e,v.a);return null==t?void 0:t.BaseUrlForEntityData}(w);if(e&&t){const n=`${t}${e}`;s.fileUrl=n}}else s.fileUrl=null;return s}return null}}}},"+zjj":function(e,t,n){"use strict";n.d(t,"a",(function(){return N})),n.d(t,"b",(function(){return T})),n.d(t,"g",(function(){return A})),n.d(t,"h",(function(){return z})),n.d(t,"e",(function(){return q})),n.d(t,"f",(function(){return x})),n.d(t,"c",(function(){return F})),n.d(t,"d",(function(){return U}));var r=n("iZ7K"),a=n("y60j"),i=n("arV0"),o=n("i1f0"),s=n("niX0"),c=n("NP1x"),l=n("Lyxw"),u=n("uNu9");function d(e,t,n){let r=n.show?N.Displayed_HardcodedEntityAllowedInUCI:N.NotDisplayed_HardcodedEntityDisallowedInUCI;switch(n.entityName){case u.z:t.IsConnectionsEnabled||(r=N.NotDisplayed_ConnectionEntityNotEnabled);break;case u.vb:t.CanTriggerWorkflow||(r=N.NotDisplayed_ProcessionEntityCannotTriggerWorkflow);break;case u.f:t.CanTriggerWorkflow||(r=N.NotDisplayed_AsyncOperationEntityCannotTriggerWorkflow);break;case u.g:t.IsCustomizable||(r=N.NotDisplayed_AuditEntityIsNotCustomizable);break;case u.wb:(a=t).EntityLogicalName!==u.Cb&&a.EntityLogicalName!==u.bb&&a.EntityLogicalName!==u.Kb&&a.EntityLogicalName!==u.ob&&(r=N.NotDisplayed_ProductEntityAndRelatedEntityRelationshipNotValid);break;case u.U:(function(e,t){return t.IsDocumentManagementEnabled&&!Object(l.b)(e,"Feedback")})(e,t)||(r=N.NotDisplayed_FeedbackEntityNotAllowedInUCI)}var a;n.displayStateReason=r}var p,g=n("dHD5"),h=n("3hnk"),f=n("2YQW"),m=n("X3qb"),b=n("YxC/"),_=n("IqkD"),y=n("0l0t"),v=n("p9KN"),S=n("7XzV"),O=n("504W"),C=n("NjDY"),E=n("hK10"),I=n("whN/"),w=n("69Qu"),j=n("zmL5"),P=n("jq7Z");!function(e){e[e.Metadata=0]="Metadata",e[e.Hardcoded=1]="Hardcoded"}(p||(p={}));const T={RelationshipMetadata:"RelatedMenu_LabelSource_RelationshipMetadata",EntityDisplayCollectionName:"RelatedMenu_LabelSource_EntityDisplayCollectionName",EntityDisplayName:"RelatedMenu_LabelSource_EntityDisplayName",ClientAPI:"RelatedMenu_LabelSource_ClientAPI",HardcodedRelationship:"RelatedMenu_LabelSource_HardcodedRelationship",FormDescriptorForCurrentUserLanguage:"RelatedMenu_LabelSource_FormDescriptorForCurrentUserLanguage",FormDescriptorForBaseLanguage:"RelatedMenu_LabelSource_FormDescriptorForBaseLanguage",FormDescriptorForEnglish:"RelatedMenu_LabelSource_FormDescriptorForEnglish"},N={Displayed_SetInFormDescriptor:{reason:"RelatedMenu_Displayed_SetInFormDescriptor",displayed:!0,canBeOverwritten:!0},Displayed_SetInRelationshipMetadata:{reason:"RelatedMenu_Displayed_SetInRelationshipMetadata",displayed:!0,canBeOverwritten:!0},Displayed_HardcodedEntityAllowedInUCI:{reason:"RelatedMenu_Displayed_HardcodedEntityAllowedInUCI",displayed:!0,canBeOverwritten:!1},NotDisplayed_ShowNavigationItemsOptionDisabled:{reason:"RelatedMenu_NotDisplayed_ShowNavigationItemsOptionDisabled",displayed:!1,canBeOverwritten:!1},NotDisplayed_RelatedEntityMetadataNotAvailableInUnifiedClient:{reason:"RelatedMenu_NotDisplayed_RelatedEntityMetadataNotAvailableInUnifiedClient",displayed:!1,canBeOverwritten:!1},NotDisplayed_HardcodedEntityDisallowedInUCI:{reason:"RelatedMenu_NotDisplayed_HardcodedEntityDisallowedInUCI",displayed:!1,canBeOverwritten:!1},NotDisplayed_SetByClientAPI:{reason:"RelatedMenu_NotDisplayed_SetByClientAPI",displayed:!1,canBeOverwritten:!0},NotDisplayed_NotEnabledForUnifiedClient:{reason:"RelatedMenu_NotDisplayed_NotEnabledForUnifiedClient",displayed:!1,canBeOverwritten:!1},NotDisplayed_RelatedEntityNotInOfflineProfile:{reason:"RelatedMenu_NotDisplayed_RelatedEntityNotInOfflineProfile",displayed:!1,canBeOverwritten:!1},NotDisplayed_SetInFormDescriptor:{reason:"RelatedMenu_NotDisplayed_SetInFormDescriptor",displayed:!1,canBeOverwritten:!0},NotDisplayed_SetInRelationshipMetadata:{reason:"RelatedMenu_NotDisplayed_SetInRelationshipMetadata",displayed:!1,canBeOverwritten:!0},NotDisplayed_IsBPFEntity:{reason:"RelatedMenu_NotDisplayed_IsBPFEntity",displayed:!1,canBeOverwritten:!1},NotDisplayed_SPDocumentNotConfigured:{reason:"RelatedMenu_NotDisplayed_SPDocumentNotConfigured",displayed:!1,canBeOverwritten:!1},NotDisplayed_NotCustomOrConfigurableSystemRelationship:{reason:"RelatedMenu_NotDisplayed_NotCustomOrConfigurableSystemRelationship",displayed:!1,canBeOverwritten:!1},NotDisplayed_NoReadPermissionOnRelatedEntity:{reason:"RelatedMenu_NotDisplayed_NoReadPermissionOnRelatedEntity",displayed:!1,canBeOverwritten:!1},NotDisplayed_KnowledgeManagementNotEnabled:{reason:"RelatedMenu_NotDisplayed_KnowledgeManagementNotEnabled",displayed:!1,canBeOverwritten:!1},NotDisplayed_ConnectionEntityNotEnabled:{reason:"RelatedMenu_NotDisplayed_ConnectionEntityNotEnabled",displayed:!1,canBeOverwritten:!1},NotDisplayed_ProcessionEntityCannotTriggerWorkflow:{reason:"RelatedMenu_NotDisplayed_ProcessionEntityCannotTriggerWorkflow",displayed:!1,canBeOverwritten:!1},NotDisplayed_AsyncOperationEntityCannotTriggerWorkflow:{reason:"RelatedMenu_NotDisplayed_AsyncOperationEntityCannotTriggerWorkflow",displayed:!1,canBeOverwritten:!1},NotDisplayed_AuditEntityIsNotCustomizable:{reason:"RelatedMenu_NotDisplayed_AuditEntityIsNotCustomizable",displayed:!1,canBeOverwritten:!1},NotDisplayed_ProductEntityAndRelatedEntityRelationshipNotValid:{reason:"RelatedMenu_NotDisplayed_ProductEntityAndRelatedEntityRelationshipNotValid",displayed:!1,canBeOverwritten:!1},NotDisplayed_FeedbackEntityNotAllowedInUCI:{reason:"RelatedMenu_NotDisplayed_FeedbackEntityNotAllowedInUCI",displayed:!1,canBeOverwritten:!1},NotDisplayed_HardcodedRelationshipNameAndReferencingEntityNotFound:{reason:"RelatedMenu_NotDisplayed_HardcodedRelationshipNameAndReferencingEntityNotFound",displayed:!1,canBeOverwritten:!1}};function A(e){return!e||e.displayed}function D(e,t){!e||e.displayStateReason&&!e.displayStateReason.canBeOverwritten||(e.displayStateReason=t)}function R(e,t){if(e&&t){const n={},r=function(e){const t={};if(t[y.b]=0,t[y.f]=1,t[y.g]=2,t[y.d]=3,t[y.c]=4,t[y.a]=5,t[y.e]=6,e&&e.Navigation&&e.Navigation.navBarAreas&&Object.keys(e.Navigation.navBarAreas).length>0){const n=[];Object.keys(e.Navigation.navBarAreas).filter((e,t,n)=>n.indexOf(e)===t).forEach(e=>{n.push(Object(c.a)(e))});const r=Object.keys(t).filter(e=>n.indexOf(e)<0);n.concat(r).forEach((e,n)=>{t[e]=n})}return t}(e);for(const e of t)n[e]=r[e];return Object.keys(n).sort((e,t)=>n[e]-n[t])}return t}function x(){let e=null,t=null;return function(n,r){const i=r.getAllMenuItemsForFormChecker,s=[],l=!0===r.isFromInitializeAction,u=r.id,d=Object(j.b)(n,u),p=Object(a.j)(n,d),g=p&&p.EntityLogicalName,h=Object(_.w)(n),y=h?h.languageId:null,v=!Object(w.b)(n),S=Object(o.Xb)(n),O=k(n,u,i).concat(F(n,u,i)),C=function(e,t,n,r){const a=[];if(n&&n.Navigation&&n.Navigation.navBarAreas&&n.Navigation.navBarByRelationshipItems){const e=Object.keys(n.Navigation.navBarByRelationshipItems),t=Object.keys(n.Navigation.navBarAreas);for(let i=0;i<e.length;i++){const o=n.Navigation.navBarByRelationshipItems[e[i]];if(o){let e;for(let r=0;r<t.length;r++)n.Navigation.navBarAreas[t[r]].id===o.area&&(e=Object(c.a)(n.Navigation.navBarAreas[t[r]].id));const i=Object(E.b)(o,r),s={areaId:e,id:o.id,title:i?i.Value:null,labelSource:i?T.FormDescriptorForCurrentUserLanguage:null,show:o.show,displayStateReason:o.show?N.Displayed_SetInFormDescriptor:N.NotDisplayed_SetInFormDescriptor,relationshipName:o.relationshipName,sequence:parseInt(o.sequence,10)};a.push(s)}}}return a}(0,0,p,y),I=Object(b.b)(n,m.e),P=Object(b.b)(n,m.d);if(O&&C)for(const e of O){const t=C.filter(t=>t.relationshipName===e.relationshipName||t.id===e.id)[0],r=M(n,u,g,v,S,l,i,e,t);r&&s.push(r)}const A=V(n,u,p,y);if(A&&A.length>0)for(const e of A){const t=M(n,u,g,v,S,l,null,e);t&&s.push(t)}let D=!1;if(null==e||e.length!==s.length)D=!0;else for(let t=0;t<s.length;t++)if(!Object(f.e)(e[t],s[t])){D=!0;break}if(D&&s)if(0===s.length)0!==(null==t?void 0:t.length)&&(t=[]);else{e=s;const r=s.reduce((e,t)=>(-1===e.indexOf(t.areaId)&&e.push(t.areaId),e),[]);t=R(p,r).map(e=>{const t=s.filter(t=>t.areaId===e);return{areaName:String.format(P,I,H(n,e,p,y)),relatedItems:(r=t,r?r.sort((e,t)=>e.sequence-t.sequence):[])};var r})}return t}}function M(e,t,n,a,i,s,c,l,u){if(!l&&!u)throw Error("relatedItemFromRelationship and relatedItemOnForm cannot be both null.");if(l&&!Object(h.b)(e,l.entityName)&&!l.url)return D(l,N.NotDisplayed_NotEnabledForUnifiedClient),c?l:null;if(a&&i&&(u&&u.entityName&&!i.has(u.entityName)||l&&l.entityName&&!i.has(l.entityName))){let e;return u&&u.entityName?(e=u,e.relationshipSource=null==l?void 0:l.relationshipSource):e=l,D(e,N.NotDisplayed_RelatedEntityNotInOfflineProfile),c?e:null}if(l&&1===l.relationshipType&&n===l.entityName)return l;if(u){if(!1===u.show)return D(u,N.NotDisplayed_SetInFormDescriptor),u.relationshipSource=null==l?void 0:l.relationshipSource,c?u:null}else if(!1===l.show)return D(l,N.NotDisplayed_SetInRelationshipMetadata),c?l:null;const d=l||u,p=Object(o.Tb)(e,t,d.id);null!==(null==p?void 0:p.show)&&void 0!==(null==p?void 0:p.show)?((null==p?void 0:p.showSetByClientAPI)&&D(d,(null==p?void 0:p.show)?N.Displayed_SetByClientAPI:N.NotDisplayed_SetByClientAPI),d.show=null==p?void 0:p.show):u?(d.show=!1!==u.show,D(d,d.show?N.Displayed_SetInFormDescriptor:N.NotDisplayed_SetInFormDescriptor)):(d.show=!1!==l.show,D(d,d.show?N.Displayed_SetInRelationshipMetadata:N.NotDisplayed_SetInRelationshipMetadata)),u&&u.areaId&&(d.areaId=u.areaId);const g=d.entityName?Object(r.h)(e,d.entityName):null,f=Object(o.Sb)(e,t,d.id,g&&g.DisplayCollectionName);return!s&&f&&f.label?(d.title=f.label,u&&u.title&&(d.labelSource=f.labelSource)):u&&u.title&&(d.title=u.title,d.labelSource=u.labelSource),(null==p?void 0:p.labelSetByClientAPI)&&(d.labelSource=T.ClientAPI),u&&u.sequence>=0&&(d.sequence=u.sequence),d.ordinal=u&&u.ordinal?u.ordinal:l?l.ordinal:I.a.Referencing,d}function F(e,t,n){let a=[];const i=W(e,t);if(i){const t=Object(c.d)(e,i.EntityLogicalName,n),o=Object(c.c)(e,i.EntityLogicalName,n);a=t.concat(o).map(t=>{const n=Object(r.h)(e,t.entityName);return{areaId:t.areaId,id:t.id,entityName:t.entityName,title:t.title,labelSource:t.labelSource,relationshipName:t.relationshipName,icon:n?n.EntityIcon:"",isCustomEntity:n?n.IsCustomEntity:void 0,sequence:t.order,show:t.show,ordinal:t.ordinal,webResourceIcon:n&&n.IconVectorName?Object(C.t)(e)+n.IconVectorName:void 0,relationshipType:t.relationshipType,displayStateReason:t.displayStateReason,relationshipSource:p.Metadata}})}return a}function k(e,t,n){const a=[],i=Object(s.c)(e),o=W(e,t);if(o){const c=o.IsCustomEntity?u.nb:o.EntityLogicalName,l=Object(s.b)(e,c,o.EntityLogicalName);for(const s of i){if(d(e,o,s),!n&&s.displayStateReason!==N.Displayed_HardcodedEntityAllowedInUCI)continue;if(!L(e,s,n))continue;const i=Object(r.h)(e,s.entityName),c=i&&i.EntityIcon?i.EntityIcon:o.EntityIcon,l=B(e,t,o.EntityLogicalName,s,n,c);l&&a.push(l)}for(const r of l){if(r.displayStateReason=r.show?N.Displayed_HardcodedEntityAllowedInUCI:N.NotDisplayed_HardcodedEntityDisallowedInUCI,!L(e,r,n))continue;const i=e&&e.metadata&&e.metadata.entities;let s=o.EntityIcon;if(i&&!Object(O.a)(i[r.entityName])){const e=i[r.entityName].EntityIcon;e&&(s=e)}const c=B(e,t,o.EntityLogicalName,r,n,s);c&&a.push(c)}}return a}function L(e,t,n){return Object(r.h)(e,t.entityName)?Object(h.g)(e,t.entityName,2,0)||(t.displayStateReason=N.NotDisplayed_NoReadPermissionOnRelatedEntity):t.displayStateReason=N.NotDisplayed_RelatedEntityMetadataNotAvailableInUnifiedClient,n||A(t.displayStateReason)}function B(e,t,n,a,i,o){const c=Object(s.a)(e,n,a.entityName,a.id);if(i||c){const t=a.title?a.title:Object(r.e)(e,a.entityName),n=a.title?T.HardcodedRelationship:T.EntityDisplayCollectionName;return{areaId:a.areaId,id:a.id,entityName:null==c?void 0:c.referencingEntity,title:t,relationshipName:null==c?void 0:c.relationshipName,icon:o,sequence:a.order,show:a.show,relationshipType:a.relationshipType,displayStateReason:a.displayStateReason&&A(a.displayStateReason)&&!c?N.NotDisplayed_HardcodedRelationshipNameAndReferencingEntityNotFound:a.displayStateReason,relationshipSource:p.Hardcoded,labelSource:n}}}function U(e,t,n){let r=F(e,t).find(e=>e.id===n);return r||(r=function(e,t,n){const r=Object(j.b)(e,t),i=Object(a.j)(e,r),o=Object(_.w)(e),s=o?o.languageId:null;return V(e,t,i,s).find(e=>e.id===n)}(e,t,n),r||(r=k(e,t,!1).find(e=>e.id===n),r))}function V(e,t,n,r){const a=[];let i=null;if(n&&n.Navigation&&n.Navigation.navBarAreas&&n.Navigation.navBarItems){const t=Object.keys(n.Navigation.navBarItems);for(let o=0;o<t.length;o++){const s=n.Navigation.navBarItems[t[o]];if(s){const t=s.area?Object(c.a)(s.area):null,n=Object(E.b)(s,r);n&&(i=n.Value);const o=/^\$webresource:/i,l=s.url?s.url.replace(o,""):null;let u=null;s.icon&&s.icon.includes("$webresource")&&(u=Object(C.t)(e)+s.icon.replace(o,""));const d={areaId:t,id:s.id,title:i,url:l,webResourceIcon:u,sequence:parseInt(s.sequence,10),availableOffline:s.availableOffline,show:s.show};a.push(d)}}}return a}function z(e,t){const n=Object(j.b)(e,t.id),r=Object(a.j)(e,n);return r&&r.ShowNavigationBar}function W(e,t){const n=Object(i.g)(e,t);return n?Object(r.h)(e,n.entityTypeName):null}function q(e,t,n){const r=Object(P.a)(e,t.id),a=Object(g.v)(n);if(r&&r.forms&&r.forms[a]){const n=r.forms[a].selectedRelatedEntity;let i=n;if(n){const s=Object(o.Rb)(e,t.id,n.id);s&&i.title!==s&&(i=Object.assign({},r.forms[a].selectedRelatedEntity),i.title=s)}return i}return null}function H(e,t,n,r){switch(t){case y.b:return G(S.c,n,r)||G(S.b,n,r)||Object(b.b)(e,v.d);case y.f:return G(S.h,n,r)||Object(b.b)(e,v.s);case y.g:return G(S.i,n,r)||Object(b.b)(e,v.t);case y.d:return G(S.e,n,r)||Object(b.b)(e,v.h);case y.c:return G(S.d,n,r)||Object(b.b)(e,v.g);case y.e:case y.a:return G(S.f,n,r)||G(S.g,n,r)||G(S.a,n,r)||Object(b.b)(e,v.n);default:return G(S.c,n,r)||G(S.b,n,r)||Object(b.b)(e,v.d)}}function G(e,t,n){if(t&&t.Navigation&&t.Navigation.navBarAreas&&t.Navigation.navBarAreas[e]){const r=t.Navigation.navBarAreas[e].titles;if(r)for(let e=0;e<=Object.keys(r).length;e++){const t=r[e];if(!Object(O.a)(t)&&n&&t.LCID===n)return t.text}}return null}},"/2Q6":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("fA3V"),a=n("pEXn"),i=n("zsAz"),o=n("TBkx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s={getName:()=>r.a,getRequiredAttributes(){throw new Error("Not Implemented")},throwIfInvalidUrl(e){if(!e||!e.webresourceName)throw Object(i.d)("Missing required URL parameter: webresourceName",o.a)},createPageModule:e=>Promise.all([n.e(2),n.e(6),n.e(0),n.e(1),n.e(3),n.e(4),n.e(5),n.e(8),n.e(7),n.e(109)]).then(n.bind(null,"Uhz3")).then(({WebResource:t})=>new t(e)),getTelemetryAttributes:e=>[{name:a.b.WebResourceName,value:e?e.webresourceName:""}]};Object.freeze(s);var c=n("9eA9"),l=n("D+Bz"),u=n("xagu"),d=n("Uv1Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const p={type:l.a.Page,pageType:"webresource",factory:s,urlToInput(e){const t=e.searchParams,n=t.get(u.eb),r=t.get(u.i),a={webresourceName:n};if(r){const e={webresourceData:r};a.webresourceData=e}return a},inputToUrl(e,t){const n=new c.a(e),r=n.searchParams;return r.set(u.eb,t.webresourceName),t.webresourceData&&t.webresourceData[u.db]&&r.append(u.i,t.webresourceData[u.db]),n.href},inputToWebUrl(e,t){throw new d.a("not supported",2147746581)}}},"/BiW":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="ApplyApplicationMetadataChangesNavigationHandler",a="Offline"},"/D1P":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Pending=0]="Pending",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed"}(r||(r={}))},"/GRh":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e){this._headers=e}append(e,t){this._headers[e]=t}get(e){return this._headers[e]}has(e){return this._headers.hasOwnProperty(e)}delete(e){delete this._headers[e]}set(e,t){this._headers[e]=t}forEach(e){for(const t in this._headers)e(this._headers[t],t,this)}}},"/Ikn":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n("MOEv");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){return`${r.a}${e}button${t}`}function i(e,t,n,r){n=n||[];for(const i in n){const n=a(t,i);r.doesOnClickEventExist(e,n)&&r.getOnClickEvents(e,n).forEach(t=>r.removeOnClickEvent(e,n,t))}}},"/J/l":function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"g",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return l}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="execute.updatecurrentsearchtext",a="execute.updatesearchresults",i="execute.searchwidgetactions.openresult",o="execute.searchwidgetactions.selectedresult",s="execute.updatenumberofresults",c="execute.searchwidgetactions.changeselectedmenu",l="execute.updateblockresults"},"/KPo":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("504W");class a{constructor(e,t){this._serverVersion=null,this._databaseVersion=null,this._serverVersion=Object(r.b)(e)?"":e,this._databaseVersion=Object(r.b)(t)?"":t}get_serverVersion(){return this._serverVersion}get_databaseVersion(){return this._databaseVersion}getObjectData(){const e={};return e.serverversion=this._serverVersion,e.databaseversion=this._databaseVersion,e}static createFromObjectData(e){const t=e.serverversion,n=e.databaseversion;return new a(t,n)}}},"/Ndy":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a{constructor(e,t,n){this._request=null,this._error=null,this._request=e,this._error=n}get_request(){return this._request}get_error(){return this._error}get_message(){return this.get_responseMessage()}get_responseMessage(){return Object(r.a)(this._request)||4!==this._request.readyState?"":this._request.responseText}}a.HtmlHeader="<!DOCTYPE html"},"/XAI":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e,t,n){this._bias=0,this._timeZoneCode=0,this._userInterfaceName=null,this._bias=e,this._timeZoneCode=t,this._userInterfaceName=n}get_Bias(){return this._bias}get_TimeZoneCode(){return this._timeZoneCode}get_UserInterfaceName(){return this._userInterfaceName}getObjectData(){const e={};return e.bias=this._bias,e.timezonecode=this._timeZoneCode,e.userinterfacename=this._userInterfaceName,e}static createFromObjectData(e){const t=e.bias,n=e.timezonecode,a=e.userinterfacename;return new r(t,n,a)}}},"/Ypj":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e,t){this._callId=null,this._dispatcher=null,this._callId=e,this._dispatcher=t}get_callId(){return this._callId}get_nativeMethodDispatcher(){return this._dispatcher}logPerfData(e,t){this._dispatcher&&this._dispatcher.logPerfData(this._callId,e,t)}static get_dispatcherCallIdName(){return r._dispatcherCallIdName}static get_shimDispatcherPerfDataPlaceHolderName(){return r._shimDispatcherPerfDataPlaceHolderName}}r._dispatcherCallIdName="dispatcherCallId",r._shimDispatcherPerfDataPlaceHolderName="ShimPerfDataPlaceHolder"},"/Zy9":function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return g}));var r=n("SAYH"),a=n("TFb5"),i=n("KBcj"),o=n("zsAz"),s=n("whN/"),c=n("iZ7K"),l=n("q/4y"),u=n("sZ+8");class d{constructor(e){this._query=e?Object.assign({},e):{},this._query.selects=this._query.selects||[],this._selectsInKey=this._query.selects?this._query.selects.map(e=>!0):[],this._query.linkEntities=this._query.linkEntities||[],this._query.sorts=this._query.sorts||[],this._query.wheres=this._query.wheres||[],this._query.contextFiltersAndIds=this._query.contextFiltersAndIds||[],this._query.searchString=this._query.searchString||"",this._query.isQuickFindSearch=this._query.isQuickFindSearch||!1,this._childCountAttributes=[],this._isFetchXmlParsed=!1,this._isFetchXmlModified=!1,this._resetSort=!1,this._queryStatus=[]}get fetchDocument(){return this._isFetchXmlParsed||this._parseFetchXmlFromString(this._query.fetchXml),this._fetchDocument}_parseFetchXmlFromString(e){e&&(this._fetchDocument=Object(a.q)(e),this._isFetchXmlParsed=!0)}static fromView(e,t){const n=new d;return n._query.viewId=e,n._query.searchString=t||"",n}static fromXml(e,t,n){const r=new d;return r._query.fetchXml=e,r._query.viewId=t,r._query.searchString=n,r}static fromState(e){const t=new d(e);return t._isFetchXmlModified=!(!e.fetchXml||!e.viewId),t}select(...e){const t=[];for(let n=0;n<e.length;n++)-1===this._query.selects.indexOf(e[n])&&t.push(e[n]);return this._query.selects.push(...t),this._selectsInKey.push(...t.map(e=>!0)),this}selectInternal(e,t=!0){return-1===this._query.selects.indexOf(e)&&(this._query.selects.push(e),this._selectsInKey.push(t)),this}addLinkedEntity(e,t){const n=Object(a.g)(e,t);return this._query.linkEntities.push(n),this}orderBy(e,t=!1,n=!0){return e&&(this._query.sorts.push(e+(t?" desc":" asc")),this._resetSort=n),this}addChildCountAttribute(e){return this._childCountAttributes.push(e),this}applyContextFilter(e,t,n,o=s.a.Referencing){var c;return this._query.entityLogicalName||(this._query.entityLogicalName=this._query.viewId&&(null===(c=Object(i.c)(n,this._query.viewId))||void 0===c?void 0:c.entityLogicalName)||Object(a.n)(this.fetchDocument)),this._query.contextFiltersAndIds.push(`${e} ${r.a.toString(t)} ${s.a[o].toLowerCase()}`),this}where(e,t,n){const r=l.a.toLegacyFilterExpression(e,n).toFetchXml();return this._query&&this._query.wheres&&this._query.wheres.push(r),this._query.expression?this._query.expression.terms.push(e):this._query.expression=new l.a(l.b.and,e),this}toFetchXml(e){var t;if(this._isFetchXmlModified&&this.fetchDocument&&this._query.viewId&&(this._fetchDocument=void 0,this._isFetchXmlModified=!1,this._isFetchXmlParsed=!1,this._query.fetchXml=void 0,(null===(t=this._query.sorts)||void 0===t?void 0:t.length)>0&&(this._resetSort=!0)),function(e){e.pageNumber||(e.pageNumber=1);e.pageSize||(e.pageSize=25);e.useModernQueryBuilder=!0}(this._query),!this.fetchDocument){if(!e)throw Object(o.d)("ModernQueryBuilder: getState function not provided");{const t=e();if(!this._query.viewId)throw Object(o.d)("ModernQueryBuilder: view id not provided to retrieve fetch xml for the view");const n=Object(i.c)(t,this._query.viewId);if(!n)throw Object(o.d)("ModernQueryBuilder: view not found in the state");this._parseFetchXmlFromString(n.fetchXML)}}if(!this.fetchDocument)throw Object(o.d)("ModernQueryBuilder: fetch xml not provided");this._applyModificationsToFetchXml(e),Object(a.s)(this.fetchDocument,this._query.pageSize,this._query.pageNumber,this._query.pagingCookie,true,false);return(new XMLSerializer).serializeToString(this.fetchDocument)}getQueryState(e){return this._query.fetchXml=this.toFetchXml(e),this._query.entityLogicalName||(this._query.entityLogicalName=Object(a.n)(this.fetchDocument)),e&&!Object(u.l)(e(),this._query.entityLogicalName)&&this.queryStatus.push({failed:!0,offlineModeSpecific:!0,message:"Error.MainEntity.NotAvailable.Offline",parameter:this._query.entityLogicalName}),this._query.key=this.getKey(),this._query.publicKey=this.getPublicKey(),Object(a.p)(this.fetchDocument)&&(this._query.isAllColumns=!0),this._query.columnNames=Object(a.m)(this.fetchDocument),this._query}get pageSize(){return this._query.pageSize}set pageSize(e){this._query.pageSize=e}set pageNumber(e){this._query.pageNumber=e}get pageNumber(){return this._query.pageNumber}get pagingCookie(){return this._query.pagingCookie}set pagingCookie(e){this._query.pagingCookie=e}getKey(){return`${this._getBaseKey()}: ${this._query.selects.filter((e,t)=>this._selectsInKey[t])}: ${this._query.wheres}: ${this._query.sorts}: ${this._query.contextFiltersAndIds}: ${this._query.linkEntities}: ${this._query.isQuickFindSearch}: ${this._query.searchString}: ${this._query.pageSize}`}getPublicKey(){return`${this._getBaseKey()}: ${this._query.selects.filter((e,t)=>this._selectsInKey[t])}: ${this._query.sorts}: ${this._query.contextFiltersAndIds}: ${this._query.linkEntities}: ${this._query.pageSize}`}_getBaseKey(){return this._query.viewId?`${this._query.entityLogicalName}-${r.a.toString(this._query.viewId)}`:r.a.toString(this._query.viewId)}get queryStatus(){return this._queryStatus}_applyModificationsToFetchXml(e){this._query.selects.length>0&&(Object(a.p)(this.fetchDocument)||Object(a.b)(this.fetchDocument,this._query.selects)),this._query.linkEntities.length>0&&this._query.linkEntities.forEach(e=>Object(a.e)(this.fetchDocument,e)),this._query.wheres&&this._query.wheres.length>0&&this._query.wheres.forEach(e=>Object(a.d)(this.fetchDocument,e)),this._resetSort&&Object(a.r)(this.fetchDocument),this._query.sorts.length>0&&this._query.sorts.forEach(e=>{const t=e.split(" ");Object(a.f)(this.fetchDocument,t[0],"desc"===t[1])}),this._childCountAttributes.length>0&&this._childCountAttributes.forEach(e=>Object(a.a)(this.fetchDocument,e)),this._query.contextFiltersAndIds.length>0&&this._query.contextFiltersAndIds.forEach(t=>{const{relationshipName:n,contextId:r,roleOrdinal:i}=function(e){const t=e.split(" ");if(3===t.length){let e;switch(t[2]){case"referencing":e=s.a.Referencing;break;case"associationentity":e=s.a.AssociationEntity;break;default:throw new Error("Passed contextFilterAndId has invalid format.")}return{relationshipName:t[0],contextId:t[1],roleOrdinal:e}}throw new Error("Passed contextFilterAndId has invalid format.")}(t),o=g(n,this._query.entityLogicalName,i,e());Object(a.c)(this.fetchDocument,o,r)}),this._isFetchXmlModified=!0}validateLinkedEntity(e,t){e&&!Object(u.l)(e,t.name)&&this.queryStatus.push({failed:!0,offlineModeSpecific:!0,message:"Error.LinkedEntity.NotAvailable.Offline",parameter:t.name})}containsError(){return this.queryStatus.some(e=>e.failed)}getErrors(){return this.queryStatus.filter(e=>e.failed)}getFirstError(){return this.queryStatus.find(e=>e.failed)}applyRollupContextFilter(){throw new Error("Not implemented")}addExistingContextFilterToKey(){throw new Error("Not implemented")}get fetchXml(){throw new Error("Not implemented")}}function p(e,t){if(!t)throw new Error("Cannot apply context filter because QueryBuilder's state tree reference is empty");const n=Object(c.h)(t,e);if(!n)throw new Error(`Cannot apply context filter because the state tree has no metadata for the ${e} entity`);const r=n.PrimaryIdAttribute;if(!r)throw new Error(`Cannot apply context filter because the primary key for the ${e} entity is missing from the state tree`);return r}function g(e,t,n,r){let i,o=Object(c.x)(r,t,e);if(o){const e=o;i=Object(a.i)(e.ReferencedEntity,e.ReferencedAttribute,e.ReferencingAttribute,null)}else if(o=Object(c.B)(r,t,e)){const e=o,t=Object(c.h)(r,e.ReferencingEntity);i=Object(a.i)(e.ReferencingEntity,e.ReferencingAttribute,e.ReferencedAttribute,t.PrimaryIdAttribute)}else{if(o=Object(c.u)(r,t,e),!o)throw new Error("Passed in relationship could not be found as any type of relationship");{const e=o,c=e.IntersectEntityName;let l,u,d,g;g=e.Entity1LogicalName===e.Entity2LogicalName?n:e.Entity1LogicalName===t?s.a.AssociationEntity:s.a.Referencing,g===s.a.Referencing?(l=e.Entity1LogicalName,d=e.Entity1IntersectAttribute,u=e.Entity2IntersectAttribute):(l=e.Entity2LogicalName,d=e.Entity2IntersectAttribute,u=e.Entity1IntersectAttribute);const h=p(t,r),f=p(l,r);i=Object(a.h)(c,h,d,l,f,u)}}return i}},"/aHX":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n("nuS9"),a=n("KOTC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(){return Promise.all([n.e(0),n.e(27),n.e(84)]).then(n.bind(null,"y1Ka"))}function o(e){return r.createElement(a.a,{key:"navigatebackbutton",loader:()=>i().then(e=>e.NavigateBackButton),props:e})}},"/bjP":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("HkYq"),a=n("504W"),i=n("cgR4"),o=n("8tWD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class s{constructor(){this._descriptors=null,this._descriptors={}}get_descriptors(){return this._descriptors}tryGetDescriptor(e){return Object(a.a)(this._descriptors[o.a[e]])?"":this._descriptors[o.a[e]].Data}updateDescriptorSet(e,t){o.a[e]in this.get_descriptors()?this._descriptors[o.a[e]].Data=t:this._descriptors[o.a[e]]=new i.a(e,t)}static createFromFetchXml(e){const t=new s;return t._descriptors[o.a[o.a.FetchXml]]=new i.a(o.a.FetchXml,e),t}static createDescriptorSet(e,t,n){const a=new s;if(t===r.a.fetchXml)if(e instanceof Array)for(let t=0;t<e.length;t++){const r=e[t];(r.Format!==o.a.Sql||n)&&(a.get_descriptors()[o.a[r.Format]]=new i.a(r.Format,r.Data))}else"string"==typeof e&&(a.get_descriptors()[o.a[o.a.FetchXml]]=new i.a(o.a.FetchXml,e));else a.get_descriptors()[o.a[0]]=new i.a(0,e);return a}}},"/d6W":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("nxt5");class a extends r.a{constructor(e,t){super("Retrieve"),this._entity=e}get_entity(){return this._entity}}},"/iCT":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("ftQm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){r.a.Instance.cleanUpProcessmanagerByPageId(e)}},"/leX":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r,a;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Loading=1]="Loading",e[e.Completed=2]="Completed"}(r||(r={})),function(e){e[e.IFrame=0]="IFrame",e[e.Page=1]="Page"}(a||(a={}))},"/oKV":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Local=0]="Local",e[e.Remote=1]="Remote",e[e.LocalAndRemote=2]="LocalAndRemote",e[e.Default=3]="Default"}(r||(r={}))},"/t1C":function(e,t,n){"use strict";n.d(t,"a",(function(){return V})),n.d(t,"b",(function(){return U}));var r=n("3/02"),a=n("2yvP"),i=n("Lyxw"),o=n("y60j"),s=n("ghNp"),c=n("3mEc"),l=n("VWP5"),u=n("Wlg7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class d extends u.a{constructor(e,t){super(t),this._tagValue=e}getTagValue(){return this._tagValue}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class p extends u.a{constructor(e,t){super(t),this._saveMode=e}getSaveMode(){return this._saveMode}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class g{constructor(e){if(!e)throw"Required parameter is null or undefined: dataLoadState";this._dataLoadState=e}getDataLoadState(){return this._dataLoadState}}var h=n("7ZMh"),f=n("Uv1Y"),m=n("NjDY"),b=n("jRy5"),_=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class y extends u.a{constructor(e,t,n,r){super(r),this._stage=e,this._direction=n}getStage(){return this._stage}getDirection(){return 0===this._direction?"Next":1===this._direction?"Previous":null}}var v=n("Z/4N"),S=n("aF0N"),O=n("vmcK"),C=n("504W"),E=n("pEXn"),I=n("69Qu"),w=n("V6aM"),j=n("FM/+"),P=n("5d8d"),T=n("P6DH"),N=n("zmL5"),A=n("wL2W"),D=n("KXSk"),R=n("yHAP"),x=n("4aOd"),M=n("hAdb"),F=n("EY5k"),k=n("YxC/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const L=["Custom_Event_Event_Name","Custom_Event_WebResource_Name","Custom_Event_Solution_Name","Custom_Event_Publisher_Name"],B=new Set,U={onXrmReady:"onxrmready",onLoad:"onload",onSave:"onsave",onChange:"onchange",onTabStateChange:"tabstatechange",onReadyStateComplete:"onreadystatecomplete",onClick:"onclick",onKeyPress:"onkeypress",onProcessChange:"onprocesschange",onProcessStatusChange:"onprocessstatuschange",onPreStageChange:"onprestagechange",onPreProcessStatusChange:"onpreprocessstatuschange",onStageChange:"onstagechange",onStageSelected:"onstageselected",preSearchEvent:"presearchevent",onResultOpened:"onresultopened",onSelection:"onselection",onPostSearch:"onpostsearch",onDataLoad:"ondataload",onGridDataLoad:"ongriddataload",onRecordSelect:"onrecordselect",onRecordOpen:"onrecordopen",onLookupTagClick:"onlookuptagclick",setAdditionalParams:"setadditionalparams",pblExecution:"pblExecution"};class V{constructor(e,t,n,r,a,i){this._tracing=n,this._pageId=e,this._container=t,this._telemetryEventManager=r,this._scriptManager=a,this._clientApiManager=i,this._reset()}doesOnClickEventExist(e,t,n){if(this._onClickEvents&&this._onClickEvents.length>0){const r=Object(_.v)(e),a=this._onClickEvents.filter(e=>(!n||String(e.func)===String(n))&&t===e.AttributeName&&e.contextKey===r);return a&&a.length>0}return!1}getOnClickEvents(e,t){let n;if(this._onClickEvents&&this._onClickEvents.length>0){const r=Object(_.v)(e);n=this._onClickEvents.filter(e=>t===e.AttributeName&&e.contextKey===r).map(e=>e.func)}return n}_getLibraryList(e,t){return e?(e.forEach(e=>{e&&e.LibraryName&&t.indexOf(e.LibraryName)<0&&t.push(e.LibraryName)}),t):t}loadWebResources(e,t,n,r,a,i,o,s){const l=a&&0!==a.length,u=i&&0!==i.length,d=/^\$webresource:/i;if(l||u||o){const p=t.ScriptManager.getContainer(n);o&&p.loadJavascriptString(o);const g=Object(m.t)(r());let h=[];if(l&&h.push(...a),u){let e=[];e=this._getLibraryList(i,e),h.push(...e)}h.length>0&&(h=Object(c.e)(r(),h),h.forEach(e=>{e&&e.startsWith&&s.push(e)}));const f=!Object(I.b)(r());return s=s.map(e=>e.replace(g,"").replace(d,"")),p.loadWebResourcesForAllContexts(s,g,3,t=>e(Object(w.a)(t)),f)}return Promise.resolve()}loadScripts(e,t){return{type:"eventManager.loadScriptsAction",execute:({dispatch:n,getState:r},a)=>{let i,s,c,l=[];const u=Object(o.j)(r(),e);if(u&&(i=u.FormLibraries,s=u.EventHandlers,c=u.BusinessLogic,u.TabNames)){const e=u.Tabs;for(let t=0;t<u.TabNames.length;t++)l=this._getLibraryList(e[t].EventHandlers,l)}return this.loadWebResources(n,a,t,r,i,s,c,l)}}}loadGridScripts(e,t){return{type:"eventManager.loadGridScriptsAction",execute:({dispatch:n,getState:r},a)=>{let i,o;if(Object(S.b)(r())){const t=Object(v.d)(r(),e,O.a);t&&(i=t.FormLibraries,o=t.EventHandlers)}let s;if(Object(S.c)(r())){const t=Object(S.a)(r(),e,O.a);t&&(s=t.BusinessLogic)}return this.loadWebResources(n,a,t,r,i,o,s,[])}}}runOnLoad(e,t,n){if(this._scriptManager.containerExists(this._pageId)){n||Object(a.b)("event.source",()=>{const t=this.getClientApiForm(e);t?n=t.ui:this._tracing.error("XrmForm is null or undefined")});const r=new g(t);return this._executeFormEventHandler(e,U.onLoad,n,r)}return this._tracing.error("RunOnLoad was cancelled as the container does not exists"),{type:"eventManager.execute.formEventHandler",sync:!0,execute:(e,t)=>!1}}runOnSave(e,t,n,r){let i=null;n||Object(a.b)("event.source",()=>{var t;i=this._getFormContext(e,r),n=null===(t=null==i?void 0:i.data)||void 0===t?void 0:t.entity});const o=new p(t);return this._executeFormEventHandler(e,U.onSave,n,o,i)}runOnChange(e,t,n){return n||Object(a.b)("event.source",()=>{const r=this._getFormContext(e);if(r)n=r.getAttribute(t);else if(e.relationshipName){const r=this._getFormContext(e.parentContextToken);if(r){const a=r.data.entity.relatedEntities.get(e.relationshipName);a&&(n=a.attributes.get(t))}}}),this._executeControlEventHandler(e,U.onChange,t,n)}runOnKeyPress(e,t,n){return this._executeControlEventHandler(e,U.onKeyPress,t,n)}runOnClick(e,t,n){return n||Object(a.b)("event.source",()=>{n=this.getClientApiForm(e).getControl(t)}),this._executeControlEventHandler(e,U.onClick,t,n)}runOnStageChange(e,t,n){let r;return Object(a.b)("event.source",()=>{const a=this.getClientApiForm(e);a&&a.data&&a.data.process&&(t=a.data.process.getActiveStage(),r=new y(t,null,n))}),this._executeFormEventHandler(e,U.onStageChange,t,r)}runOnProcessStatusChange(e,t,n){let r;return Object(a.b)("event.source",()=>{const a=this.getClientApiForm(e);a&&a.data&&a.data.process&&(n=a.data.process.getActiveProcess(),r=new y(null,t,null))}),this._executeFormEventHandler(e,U.onProcessStatusChange,n,r)}runOnPreStageChange(e,t,n){let r;return Object(a.b)("event.source",()=>{const t=this.getClientApiForm(e);if(t&&t.data&&t.data.process){const e=t.data.process.getActiveStage();r=new y(e,null,n)}}),this._executeFormEventHandler(e,U.onPreStageChange,t,r)}runOnPreProcessStatusChange(e,t,n){let r;const i=this.getClientApiForm(e);return Object(a.b)("event.source",()=>{i&&i.data&&i.data.process&&(r=new y(null,t,null))}),this._executeFormEventHandler(e,U.onPreProcessStatusChange,n,r)}runOnStageSelected(e,t){let n;const r=this.getClientApiForm(e);return Object(a.b)("event.source",()=>{r&&r.data&&r.data.process&&(t=r.data.process.getSelectedStage(),n=new y(t,null,null))}),this._executeFormEventHandler(e,U.onStageSelected,t,n)}runOnTabStateChange(e,t,n){const r=this.getClientApiForm(e);return Object(a.b)("event.source",()=>{!n&&r&&r.ui&&r.ui.tabs&&(n=r.ui.tabs.get(t))}),this._executeControlEventHandler(e,U.onTabStateChange,t,n)}runOnReadyStateComplete(e,t,n){if(!t){const r=this.getClientApiForm(e);r&&Object(a.b)("event.source",()=>{t=r.getControl(n)})}return this._executeControlEventHandler(e,U.onReadyStateComplete,n,t)}runOnProcessChange(e,t){const n=this.getClientApiForm(e);return Object(a.b)("event.source",()=>{n.data.process=null,n.ui.process=null}),this._executeFormEventHandler(e,U.onProcessChange,t)}runPreSearch(e,t,n){return this._executeControlEventHandler(e,U.preSearchEvent,t,n)}runOnResultOpened(e,t,n,r){let i;return Object(a.b)("event.source",()=>{const n=this.getClientApiForm(e);i=null==n?void 0:n.getControl(t)}),this._executeControlEventHandler(e,U.onResultOpened,t,i,null,n,r)}runOnSelection(e,t,n,r){let i;return Object(a.b)("event.source",()=>{const n=this.getClientApiForm(e);i=null==n?void 0:n.getControl(t)}),this._executeControlEventHandler(e,U.onSelection,t,i,null,n,r)}runOnPostSearch(e,t,n,r){let i;return Object(a.b)("event.source",()=>{const n=this.getClientApiForm(e);i=null==n?void 0:n.getControl(t)}),this._executeControlEventHandler(e,U.onPostSearch,t,i,null,n,r)}runOnDataLoad(e,t,n){if(!n){const t=this.getClientApiForm(e);Object(a.b)("event.source",()=>{t&&t.data&&t.data.entity&&(n=t.data.entity)})}const r=new g(t);return this._executeFormEventHandler(e,U.onDataLoad,n,r)}runOnGridDataLoad(e,t,n,r){r||(r=this.getClientApiGrid(e));const a=new g(t);return this._executeControlEventHandler(e,U.onGridDataLoad,n,r,a)}runOnLookupTagClick(e,t,n,r,a){const i=new d(r);return this._executeControlEventHandler(e,U.onLookupTagClick,t,n,i,r,a)}runSetAdditionalParams(e,t,n){return this._scriptManager.containerExists(this._pageId)?(n||Object(a.b)("event.source",()=>{const r=this.getClientApiForm(e);n=null==r?void 0:r.getControl(t)}),this._executeControlEventHandler(e,U.setAdditionalParams,t,n)):(this._tracing.error("runSetAdditionalParams was cancelled as the container does not exists"),{type:"eventManager.execute.formEventHandler",sync:!0,execute:(e,t)=>!1})}runOnRecordSelect(e,t,n){return n||Object(a.b)("event.source",()=>{n=this._getFormContext(e).data.entity}),this._executeControlEventHandler(e,U.onRecordSelect,t,n)}runOnRecordOpen(e,t,n){return n||Object(a.b)("event.source",()=>{n=this._getFormContext(e)}),this._executeControlEventHandler(e,U.onRecordOpen,t,n)}addGridOnRecordSelectHandlers(e){return{type:"eventManager.addGridOnRecordSelectHandlers",sync:!0,execute:(t,n)=>{if(!Object(S.c)(t.getState()))return;const r=Object(_.v)(e),i=e.controlName?e.controlName:O.a,o=this._getRelationship(t.getState(),e);if(0!==this._onRecordSelectEvents.filter(e=>e.AttributeName===i&&e.contextKey===r&&this._isMatchingEventRelationship(e.Relationship,o)).length)return;const s=e.controlName?e.controlName:"crmGrid";let c;Object(a.b)("event.source",()=>{c=this._getFormContext(e).data.entity.getEntityName()});const l=String.format("Mscrm.BusinessRulesScript.addOnRecordSelect_{0}_{1}",s,c);if(!this._getScopedFunction(l))return;const u=this.getClientApiGrid(e),d={EventName:U.onRecordSelect,FunctionName:l,PassExecutionContext:!0,contextKey:r};return this._executeIndividualEvent(n,d,undefined,!0,0,t,e,u,null,null)}}}addGridOnChangeHandlers(e){return{type:"eventManager.addGridOnChangeHandlers",sync:!0,execute:(t,n)=>{if(!Object(S.c)(t.getState()))return;const r=Object(_.v)(e),i=e.controlName?e.controlName:O.a,o=this._getRelationship(t.getState(),e);if(0!==this._onChangeEvents.filter(e=>e.AttributeName===i&&e.contextKey===r&&this._isMatchingEventRelationship(e.Relationship,o)).length)return;const s=e.controlName?e.controlName:"crmGrid";let c,l;Object(a.b)("event.source",()=>{l=this._getFormContext(e).data.entity,c=l.getEntityName()});const u=String.format("Mscrm.BusinessRulesScript.addOnChange_{0}_{1}",s,c);if(!this._getScopedFunction(u))return;const d={EventName:U.onRecordSelect,FunctionName:u,PassExecutionContext:!0,contextKey:r};return this._executeIndividualEvent(n,d,undefined,!0,0,t,e,l,null,null)}}}addOnLoadEvent(e,t,n){this._addEvent(e,this._onLoadEvents,t,U.onLoad,void 0,n)}addOnSaveEvent(e,t){this._addEvent(e,this._onSaveEvents,t,U.onSave)}addOnChangeEvent(e,t,n,r,a){const i=this._getRelationship(e,t);this._addEvent(t,this._onChangeEvents,r,U.onChange,n,a,i)}addOnClickEvent(e,t,n){this._addEvent(e,this._onClickEvents,n,U.onClick,t)}addOnProcessChangeEvent(e,t){this._addEvent(e,this._onProcessChangeEvents,t,U.onProcessChange)}addOnProcessStatusChangeEvent(e,t){this._addEvent(e,this._onProcessStatusChangeEvents,t,U.onProcessStatusChange)}addOnPreProcessStatusChangeEvent(e,t){this._addEvent(e,this._onPreProcessStatusChangeEvents,t,U.onPreProcessStatusChange)}addOnPreStageChangeEvent(e,t){this._addEvent(e,this._onPreStageChangeEvents,t,U.onPreStageChange)}addOnStageChangeEvent(e,t){this._addEvent(e,this._onStageChangeEvents,t,U.onStageChange)}addOnStageSelectedEvent(e,t){this._addEvent(e,this._onStageSelectedEvents,t,U.onStageSelected)}addOnTabStateChangeEvent(e,t,n){this._addEvent(e,this._onTabStateChangeEvents,n,U.onTabStateChange,t)}addOnKeyPressEvent(e,t,n){this._addEvent(e,this._onKeyPressEvents,n,U.onKeyPress,t)}addPreSearchEvent(e,t,n){this._addEvent(e,this._preSearchEvents,n,U.preSearchEvent,t)}addOnResultOpened(e,t,n){this._addEvent(e,this._onResultOpenedEvents,n,U.onResultOpened,t)}addOnSelection(e,t,n){this._addEvent(e,this._onSelectionEvents,n,U.onSelection,t)}addOnPostSearch(e,t,n){this._addEvent(e,this._onPostSearchEvents,n,U.onPostSearch,t)}addOnReadyStateComplete(e,t,n){this._addEvent(e,this._onReadyStateComplete,t,U.onReadyStateComplete,n)}addOnDataLoad(e,t){this._addEvent(e,this._onDataLoadEvents,t,U.onDataLoad)}addOnGridDataLoad(e,t,n){this._addEvent(e,this._onGridDataLoadEvents,t,U.onGridDataLoad,n)}addOnRecordSelect(e,t,n,r){const a=this._getRelationship(e,t);this._addEvent(t,this._onRecordSelectEvents,n,U.onRecordSelect,r,!1,a)}addOnLookupTagClick(e,t,n){this._addEvent(e,this._onLookupTagClickEvents,n,U.onLookupTagClick,t)}removeOnKeyPressEvent(e,t,n){this._removeEvent(e,this._onKeyPressEvents,n,t)}removeOnLoadEvent(e,t){this._removeEvent(e,this._onLoadEvents,t)}removeOnSaveEvent(e,t){this._removeEvent(e,this._onSaveEvents,t)}removeOnChangeEvent(e,t,n){this._removeEvent(e,this._onChangeEvents,n,t)}removePreSearchEvent(e,t,n){this._removeEvent(e,this._preSearchEvents,n,t)}removeOnResultOpened(e,t,n){this._removeEvent(e,this._onResultOpenedEvents,n,t)}removeOnSelection(e,t,n){this._removeEvent(e,this._onSelectionEvents,n,t)}removeOnPostSearch(e,t,n){this._removeEvent(e,this._onPostSearchEvents,n,t)}removeOnClickEvent(e,t,n){this._removeEvent(e,this._onClickEvents,n,t)}removeOnProcessStatusChange(e,t){this._removeEvent(e,this._onProcessStatusChangeEvents,t)}removeOnStageChange(e,t){this._removeEvent(e,this._onStageChangeEvents,t)}removeOnPreStageChange(e,t){this._removeEvent(e,this._onPreStageChangeEvents,t)}removeOnPreProcessStatusChange(e,t){this._removeEvent(e,this._onPreProcessStatusChangeEvents,t)}removeOnStageSelected(e,t){this._removeEvent(e,this._onStageSelectedEvents,t)}removeOnTabStateChange(e,t,n){this._removeEvent(e,this._onTabStateChangeEvents,n,t)}removeOnReadyStateComplete(e,t,n){this._removeEvent(e,this._onReadyStateComplete,t,n)}removeOnDataLoad(e,t){this._removeEvent(e,this._onDataLoadEvents,t)}removeOnGridDataLoad(e,t,n){this._removeEvent(e,this._onGridDataLoadEvents,t,n)}removeOnRecordSelect(e,t,n){this._removeEvent(e,this._onRecordSelectEvents,t,n)}removeOnLookupTagClick(e,t,n){this._removeEvent(e,this._onLookupTagClickEvents,n,t)}disableOnChangeHandlers(e){this._onChangeDisabledFields.indexOf(e)<0&&this._onChangeDisabledFields.push(e)}isOnChangeDisabled(e){return this._onChangeDisabledFields.indexOf(e)>=0}addPblEvent(e){return{type:"eventManager.addPblEventAction",sync:!0,execute:(t,n)=>{const r=this._getScopedFunction("Mscrm.BusinessRulesScript.Initialize");(null==r?void 0:r.apply)&&Object(a.b)("pbl.initialization",()=>{r.apply(this)});const i=this._getScopedFunction("Mscrm.BusinessRulesScript.ReInitialize");i&&this._addEvent(e,this._pblExecutionEvents,i,U.pblExecution)}}}runPBLs(e){return this._executeFormEventHandler(e,U.pblExecution)}_getScopedFunction(e){if(this._container&&this._container.iFrame){const t=e.split(".");let n=this._container.iFrame.contentWindow;for(let e=0;e<t.length&&n;e++)n=n[t[e]];return n}return null}_removeEvent(e,t,n,r){if(t&&t.length>0&&n){const a=Object(_.v)(e),i=t.filter(e=>e.func===n&&(!r||r===e.AttributeName)&&e.contextKey===a);for(let e=0;e<i.length;e++){const n=t.indexOf(i[e]);t[n].isDisabled=!0}}}_addEvent(e,t,n,r,a,i,o){t&&n&&t.push({EventName:r,PassExecutionContext:!0,func:n,AttributeName:a,isDisabled:!1,contextKey:Object(_.v)(e),isHighPriority:i,Relationship:Object(C.a)(o)?null:o})}_executeFormEventHandler(e,t,n,r,a){let i;switch(t){case U.onXrmReady:i=this._onXrmReadyEvents;break;case U.onLoad:i=this._onLoadEvents;break;case U.onSave:i=this._onSaveEvents;break;case U.onProcessChange:i=this._onProcessChangeEvents;break;case U.onProcessStatusChange:i=this._onProcessStatusChangeEvents;break;case U.onPreStageChange:i=this._onPreStageChangeEvents;break;case U.onPreProcessStatusChange:i=this._onPreProcessStatusChangeEvents;break;case U.onStageChange:i=this._onStageChangeEvents;break;case U.onStageSelected:i=this._onStageSelectedEvents;break;case U.onReadyStateComplete:i=this._onReadyStateComplete;break;case U.onDataLoad:i=this._onDataLoadEvents;break;case U.onGridDataLoad:i=this._onGridDataLoadEvents;break;case U.pblExecution:i=this._pblExecutionEvents}return{type:"eventManager.execute.formEventHandler",sync:!0,execute:(o,s)=>{if(this._isHandlerLocked("_form",t))return!1;if(this._lockHandler("_form",t),t===U.onLoad&&!e.parentContextToken)if(s.GlobalCustomEventManager){const t=this.getClientApiForm(e);o.dispatch(s.GlobalCustomEventManager.runBeforeOnLoad(t,this._pageId,t))}else this._telemetryEventManager.ReportComponentFailure("ScriptManager.customEventManager.._executeFormEventHandler",new Error("GlobalCustomEventManager is null or undefined"));let c;try{const l=this._getEventHandlerList(o.getState(),e,t);c=this._executeEventHandler(s,l,i,o,e,n,r,a),this._unlockHandler("_form",t)}catch(e){this._unlockHandler("_form",t),this._handleError(o,e),c=!1}if(Object(A.a)()&&Object(j.a)(t,U.onLoad)){const e=Object(D.b)(o.getState(),this._pageId);e===this._pageId&&Object(R.a)(s,e,U.onLoad)}return c}}}_executeControlEventHandler(e,t,n,r,a,i,o){let s;switch(t){case U.preSearchEvent:s=this._preSearchEvents;break;case U.onChange:s=this._onChangeEvents;break;case U.onKeyPress:s=this._onKeyPressEvents;break;case U.onClick:s=this._onClickEvents;break;case U.onTabStateChange:s=this._onTabStateChangeEvents;break;case U.onDataLoad:s=this._onDataLoadEvents;break;case U.onGridDataLoad:s=this._onGridDataLoadEvents;break;case U.onRecordOpen:this._onRecordOpenEvents||(this._onRecordOpenEvents=[]),s=this._onRecordOpenEvents;break;case U.onResultOpened:s=this._onResultOpenedEvents,Object(P.a)(e,this._pageId,this._clientApiManager,s,i,o);break;case U.onSelection:s=this._onSelectionEvents,Object(P.a)(e,this._pageId,this._clientApiManager,s,i,o);break;case U.onPostSearch:s=this._onPostSearchEvents,Object(P.a)(e,this._pageId,this._clientApiManager,s,i,o);break;case U.onLookupTagClick:s=this._onLookupTagClickEvents;break;case U.setAdditionalParams:s=this._setAdditionalParamsEvents;break;case U.onRecordSelect:s=this._onRecordSelectEvents;break;case U.onReadyStateComplete:s=this._onReadyStateComplete}return{type:"eventManager.execute.controlEventHandler",sync:!0,execute:(i,o)=>{if(!n||Object(j.a)(t,U.onChange)&&this.isOnChangeDisabled(n))return;if(this._isHandlerLocked(n,t))return;const c=Object(_.v)(e),l=this._getRelationship(i.getState(),e);if(s=s.filter(e=>e.AttributeName===n&&e.contextKey===c&&this._isMatchingEventRelationship(e.Relationship,l)),this._lockHandler(n,t),t===U.onGridDataLoad&&!e.parentContextToken)if(o.GlobalCustomEventManager){const t=this.getClientApiGrid(e);i.dispatch(o.GlobalCustomEventManager.runBeforeOnLoad(t,this._pageId))}else this._telemetryEventManager.ReportComponentFailure("ScriptManager.customEventManager.._executeControlEventHandler",new Error("GlobalCustomEventManager is null or undefined"));const u=this._getEventHandlerList(i.getState(),e,t,n);try{if(this._executeEventHandler(o,u,s,i,e,r,a),this._unlockHandler(n,t),t===U.onRecordOpen)return u&&u.length>0||s&&s.length>0;if(t===U.onLookupTagClick){const e=a;return!!e&&e.isDefaultPrevented()}return}catch(e){return this._unlockHandler(n,t),this._handleError(i,e),!1}}}}_executeEventHandler(e,t,n,r,a,i,o,s){let c=!1;if(0!==t.length||0!==n.length){let l,u;for(let t=0;t<n.length;t++)n[t].isHighPriority&&(c=this._executeIndividualEvent(e,n[t],l,c,t,r,a,i,o,s));for(let n=0;n<t.length;n++)c=this._executeIndividualEvent(e,t[n],l,c,n,r,a,i,o,s);let d=0;for(;d<n.length;)u=n[d],u.isHighPriority||(c=this._executeIndividualEvent(e,u,l,c,d+t.length,r,a,i,o,s)),d++}return c}_executeIndividualEvent(e,t,n,o,c,u,d,h,f,m){if(Object(_.v)(d)!==t.contextKey)return o;if(t.isDisabled)return o;const y=this._isCustomEventDisabledByConfigFlag(u.getState(),t.EventName);let v=null,S=null;const O=Object(A.a)()&&(Object(j.a)(t.EventName,U.onLoad)||Object(j.a)(t.EventName,U.onSave));let C="";if(O){const e=u.getState(),n=Object(D.b)(e,this._pageId);v=Object(R.b)(n,t.EventName),S=this._getEventMonitorParameter(t),C=Object(R.c)(e,this._pageId,d),v.push({message:y?t.EventName+" handler is disabled by config flag":`${t.EventName} handler started ${C}.`,event:S})}if(y)return o;Object(j.a)(t.EventName,U.onSave)&&(f=new p(f.getSaveMode(),f.isDefaultPrevented()||o)),(Object(j.a)(t.EventName,U.onLoad)||Object(j.a)(t.EventName,U.onDataLoad))&&(f=new g(f.getDataLoadState()));const I=t.Parameters&&t.Parameters.length>0;let w;if(t.PassExecutionContext){let a;a=m||(Object(j.a)(t.EventName,U.onRecordOpen)?h:Object(j.a)(t.EventName,U.onRecordSelect)||Object(j.a)(t.EventName,U.onChange)||Object(j.a)(t.EventName,U.onSave)?this._getFormContextFromToken(d):d.parentContextToken&&(Object(i.a)(u.getState(),r.Kd,r.h)&&d.contextTokenType===b.a.SubGrid&&Object(j.a)(t.EventName,U.onGridDataLoad)||d.contextTokenType===b.a.SearchWidget&&Object(j.a)(t.EventName,U.onSelection))?Object(s.d)(this._pageId,d.parentContextToken,e.ClientApiManager):Object(s.d)(this._pageId,d,e.ClientApiManager)),n=new l.a(u,this._pageId,h,c,f,a,n),w=I?[n].concat(t.Parameters):[n]}else I&&(w=t.Parameters);try{const e={sourceName:"event.executeHandler"};e.eventParameters=[{name:"eventName",value:t.EventName},{name:"attributeName",value:t.AttributeName}],t.func?(e.eventParameters.push({name:E.b.WebResourceParameterNames.FunctionName,value:t.func.name}),Object(a.b)(e,()=>{this._container.executeFunction(t.func,w)})):t.FunctionName&&(e.eventParameters.push({name:E.b.WebResourceParameterNames.FunctionName,value:t.FunctionName}),e.eventParameters.push({name:E.b.WebResourceParameterNames.WebResourceName,value:t.WebResourceName}),e.eventParameters.push({name:E.b.WebResourceParameterNames.SolutionName,value:t.SolutionName}),e.eventParameters.push({name:E.b.WebResourceParameterNames.PublisherName,value:t.PublisherName}),Object(a.b)(e,()=>{this._container.execute(t.FunctionName,w,!0,{webResourceName:t.WebResourceName,solutionName:t.SolutionName,solutionVersion:t.SolutionVersion,publisherName:t.PublisherName,type:t.EventName})}))}catch(e){this._handleError(u,e,t),S=this._getEventMonitorParameter(t,e)}return f&&"function"==typeof f.isDefaultPrevented&&f.isDefaultPrevented()&&!o&&(o=!0),O&&v.push({message:`${S.eventName} handler ${S.errorMessage?"failed":"completed"} ${C}${o?" (default prevented, save operation will be canceled)":""}.`,event:S}),o}async _handleError(e,t,n){let r;if(n){await e.dispatch(Object(F.e)(L));const t=e.getState(),a=Object(k.e)(t,L),i=Object(k.c)(a,"Custom_Event_Event_Name")||"Event Name:",o=Object(k.c)(a,"Custom_Event_WebResource_Name")||"Web Resource Name:",s=Object(k.c)(a,"Custom_Event_Solution_Name")||"Solution Name:",c=Object(k.c)(a,"Custom_Event_Publisher_Name")||"Publisher Name:";r=`${i} ${n.EventName}\n`+(n.WebResourceName?`${o} ${n.WebResourceName}\n`:"")+(n.SolutionName?`${s} ${n.SolutionName}\n`:"")+(n.PublisherName?`${c} ${n.PublisherName}`:"")}e.dispatch(Object(h.a)(this._pageId,new f.a(void 0,2153976091,void 0,void 0,void 0,t,r)))}_getEventMonitorParameter(e,t){if(!e)return null;const n=t?new x.a(t):null;return Object.assign({eventName:e.EventName,webResource:e.WebResourceName,functionName:(e.func?e.func.name:e.FunctionName)||"<dynamically added>",solutionName:e.SolutionName,publisherName:e.PublisherName},t&&{errorMessage:t.message,callStack:n.getStackTrace()})}_getAttributeEventNameKey(e,t){return e.concat("_",t)}_lockHandler(e,t){const n=this._getAttributeEventNameKey(e,t);this._lockedHandlers[n]=!0}_isHandlerLocked(e,t){const n=this._getAttributeEventNameKey(e,t);return this._lockedHandlers[n]}_unlockHandler(e,t){const n=this._getAttributeEventNameKey(e,t);this._lockedHandlers[n]?this._lockedHandlers[n]=!1:this._tracing.error("Handler was NOT LOCKED as expected ("+n+")")}_getEventHandlerList(e,t,n,l){let u=[],d=null,p=null;const g=Object(S.b)(e);if(Object(a.b)("event.getHandlers",()=>{if(t&&t.contextTokenType&&(t.contextTokenType===b.a.MainGrid||t.contextTokenType===b.a.AssociatedGrid)){if(g){const r=Object(s.d)(this._pageId,t,this._clientApiManager);if(r&&r.getEntityName&&"function"==typeof r.getEntityName){const a=r.getEntityName(),i=Object(v.d)(e,a,O.a);i&&(u=i.EventHandlers,d="Grids",Object(j.a)(n,U.onRecordSelect)&&(l=null),p=this._getRelationship(e,t))}}}else{const r=Object(o.j)(e,Object(N.b)(e,this._pageId));if(r){if(u=r.EventHandlers,Object(j.a)(n,U.onTabStateChange)&&r&&r.TabNames&&r.Tabs)for(let e=0;e<r.TabNames.length;e++){const t=r.Tabs[e].EventHandlers.map(t=>(t.AttributeName=r.TabNames[e],t));u=u.concat(t)}g&&(d=t&&t.controlName?t.controlName:null,Object(j.a)(n,U.onRecordSelect)&&(l=null),p=this._getRelationship(e,t))}}}),u&&0!==u.length){const a=Object(_.v)(t);return u.filter(t=>{if(t.Enabled){if(Object(j.a)(n,U.onRecordOpen))return Object(i.c)(e,r.yb)&&Object(j.a)(t.EventName,n)&&d===t.ControlId;if(!l||!t.AttributeName&&!t.ControlId)return Object(j.a)(t.EventName,n)&&(g&&t.ControlId===d||!g)&&(g&&this._isMatchingEventRelationship(t.Relationship,p)||!g);if(t.AttributeName)return Object(j.a)(t.EventName,n)&&t.AttributeName===l&&(g&&t.ControlId===d||!g)&&(g&&this._isMatchingEventRelationship(t.Relationship,p)||!g);if(t.ControlId)return Object(j.a)(t.EventName,n)&&t.ControlId===l}}).map(t=>{const n=Object(c.j)(e,t.LibraryName);return{EventName:t.EventName,PassExecutionContext:t.PassExecutionContext,AttributeName:t.AttributeName,FunctionName:t.FunctionName,Parameters:Object(j.b)(this._container,t.Parameters),contextKey:a,WebResourceName:n&&n.name,SolutionName:n&&n.solutionName,SolutionVersion:n&&n.solutionVersion,PublisherName:n&&n.publisherName}})}return[]}getClientApiForm(e){const t=Object(s.d)(this._pageId,e,this._clientApiManager);if(!t){const t=[];t.push({name:"contextKey",value:Object(_.v)(e)}),this._telemetryEventManager.ReportComponentFailure("ScriptManager.customEventManager.getClientApiForm",new Error("XrmForm is null or undefined"),null,t)}return t}_getFormContext(e,t){const n=Object(s.d)(this._pageId,e,this._clientApiManager);if(!n){const t=[{name:"contextKey",value:Object(_.v)(e)},{name:"isContainerNull",value:null==this._container}];this._telemetryEventManager.ReportComponentFailure("ScriptManager.customEventManager._getFormContext",new Error("clientApiObject is null or undefined"),null,t)}return this._getFormContextFromClientApiObject(n,t)}_getFormContextFromToken(e){const t=Object(s.d)(this._pageId,e,this._clientApiManager);if(!t){const t=[{name:"contextKey",value:Object(_.v)(e)},{name:"isContainerNull",value:null==this._container}];this._telemetryEventManager.ReportComponentFailure("ScriptManager.customEventManager._getFormContextFromToken",new Error("clientApiObject is null or undefined"),null,t)}return this._getFormContextFromClientApiObject(t)}_getFormContextFromClientApiObject(e,t){return e&&!t&&e.getGrid&&"function"==typeof e.getGrid&&e.getGrid()&&e.getGrid().getSelectedRows()&&1===e.getGrid().getSelectedRows().getLength()?e.getGrid().getSelectedRows().get(0):e&&t&&e.getGrid&&"function"==typeof e.getGrid&&e.getGrid()&&e.getGrid().getRows()&&e.getGrid().getRows().getLength()>0?e.getGrid().getRows().get(t):e}getClientApiGrid(e){const t=Object(s.d)(this._pageId,e,this._clientApiManager);if(!t){const t=[];t.push({name:"contextKey",value:Object(_.v)(e)}),this._telemetryEventManager.ReportComponentFailure("ScriptManager.customEventManager.getClientApiGrid",new Error("grid is null or undefined"),null,t)}return t}_getRelationship(e,t){let n=null;return Object(a.b)("event.source",()=>{const r=Object(s.d)(this._pageId,t,this._clientApiManager);if(r&&r.getEntityName&&"function"==typeof r.getEntityName&&r.getGrid&&"function"==typeof r.getGrid&&r.getGrid()&&r.getGrid().getSelectedRows()&&1===r.getGrid().getSelectedRows().getLength()){const a=!Object(C.a)(Object(T.Q)(e,this._pageId,t)),i=r.getEntityName(),o=r.getGrid().getSelectedRows().get(0).data.entity.getEntityName();a&&i!==o&&(n=o)}}),n}_isMatchingEventRelationship(e,t){return Object(C.a)(e)&&Object(C.a)(t)||!Object(C.a)(e)&&e===t}_isCustomEventDisabledByConfigFlag(e,t){var n;if(0===B.size){const t=null===(n=Object(M.c)(e,"DisableFormHandlers"))||void 0===n?void 0:n.map(e=>e.toLowerCase());null==t||t.map(e=>{"all"===e||"true"===e?(B.add(U.onLoad.toLowerCase()),B.add(U.onSave.toLowerCase()),B.add(U.onChange.toLowerCase()),B.add(U.pblExecution.toLowerCase())):"businessrule"===e?B.add(U.pblExecution.toLowerCase()):B.add(e)})}return t&&B.has(t.toLowerCase())}_reset(){this._onXrmReadyEvents=[],this._onChangeEvents=[],this._onLoadEvents=[],this._onSaveEvents=[],this._onClickEvents=[],this._onKeyPressEvents=[],this._onProcessChangeEvents=[],this._onProcessStatusChangeEvents=[],this._onPreProcessStatusChangeEvents=[],this._onPreStageChangeEvents=[],this._onStageChangeEvents=[],this._onStageSelectedEvents=[],this._onTabStateChangeEvents=[],this._preSearchEvents=[],this._onResultOpenedEvents=[],this._onSelectionEvents=[],this._onPostSearchEvents=[],this._onReadyStateComplete=[],this._onDataLoadEvents=[],this._pblExecutionEvents=[],this._onGridDataLoadEvents=[],this._onRecordSelectEvents=[],this._setAdditionalParamsEvents=[],this._onChangeDisabledFields=[],this._lockedHandlers={},this._onLookupTagClickEvents=[]}}},"01Vp":function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}));var r=n("odYE"),a=n("Hevb"),i=n("iZ7K"),o=n("Rckk"),s=n("g22U"),c=n("Er26");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e,t,n,r){let a=`${Object(i.o)(e,t.etn)}(${t.id.guid})`;r&&(a=a+"/"+r);let l=s.b.Delete;r&&(l=s.b.BinaryDelete);const u={urlParameters:a,method:"DELETE",additionalParameters:{[s.a.TYPE]:s.c.DELETE,[s.a.SUB_TYPE]:l,[c.b]:t.etn}};return r||(void 0!==u.additionalHeaders&&null!==u.additionalHeaders||(u.additionalHeaders={}),u.additionalHeaders[o.c.IF_MATCH]=n||"*"),u}function u(e){return{type:"SERIALIZE_DELETE_REQUEST",execute({dispatch:t,getState:n},i){const o=e.get_target();return Promise.resolve(l(n(),r.a.fromLegacyEntityReference(o),Object(a.b)(e.get_concurrencyBehavior(),o.getValue("versionnumber"))))}}}},"03Hu":function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n("ufH1"),a=n("umme"),i=n("84PK"),o=n("504W"),s=n("NMtn"),c=n("VA/h"),l=n("l3Ef"),u=n("8Mff"),d=n("i8tO"),p=n("FZk4"),g=n("2LZB");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class h{constructor(e){this._syncErrorCount=0,this._syncErrorCount=e}get_syncErrorCount(){return this._syncErrorCount}set_syncErrorCount(e){return this._syncErrorCount=e,e}}var f=n("1nJ/"),m=n("3fL6"),b=n("jZCH"),_=n("EW4s"),y=n("Div0");class v{constructor(e,t,n){this._isOfflineDataSourceInitialized=!1,this._localDataSource=null,this._applicationStatusProvider=null,this._offlineTypescriptInterface=null,this._offlineSyncInfo=new h(0),Object(s.d)(t,"serverUri"),Object(s.d)(e,"loacalDataSource"),this._localDataSource=e,this._applicationStatusProvider=n}get_applicationStatusProvider(){return this._applicationStatusProvider}get_isOfflineDataSourceInitialized(){return this._isOfflineDataSourceInitialized}get_offlineSyncInfo(){if(Object(o.a)(this._offlineSyncInfo))throw Error.invalidOperation("OfflineSyncInfo has not been initialized yet.");return this._offlineSyncInfo}get_syncErrorCount(){return this.get_offlineSyncInfo().get_syncErrorCount()}set_syncErrorCount(e){return this.get_offlineSyncInfo().set_syncErrorCount(e),e}get_offlineTypescriptInterface(){return this._offlineTypescriptInterface}set_offlineTypescriptInterface(e){this._offlineTypescriptInterface=e}get_localDataSource(){return this._localDataSource}initialize(e){const t=new _.a;return this._localDataSource.initializeOfflineComponents(e).then(e=>{this._isOfflineDataSourceInitialized=!0,Object(r.d)("OfflineDataSource.Initialize.Done",y.a.storage,"Offline Data source initialization completed succesfully"),t.resolve(this._isOfflineDataSourceInitialized)},e=>{this._isOfflineDataSourceInitialized=!1,Object(r.b)("OfflineDataSource.Initialize.Fail",y.a.storage,"Offline Data source initialization failed with error: "+e.get_Message()),t.reject(e)}),t}refreshLookupData(e,t,n,r){const a=new _.a,i={},s=t.get_fieldTypes();for(const n in s){const r={key:n,value:s[n]},a=r.value;if(("lookup"===a||"customer"===a||"owner"===a)&&t.hasValue(r.key)){const n=t.getValue(r.key);if(Object(o.a)(n))continue;if(!n.equals(e)&&this._offlineTypescriptInterface.isEntityAvailableForOfflineUsage(n.LogicalName)){const e=n.LogicalName in i?i[n.LogicalName]:{};if(n.Id.toString()in e){const t=e[n.Id.toString()];t[t.length]=r.key,e[n.Id.toString()]=t}else e[n.Id.toString()]=[r.key];i[n.LogicalName]=e}}}const l=[];for(const e in i){const t={key:e,value:i[e]},a=t.value;l.push(this._localDataSource.get_offlineDataStore().retrieveLookupRecords(Object.keys(a),t.key,r,n))}return Object(c.a)(l).then(e=>{for(const n of e){const e=n;for(const n of e.get_entities()){const e=n.get_identifier(),r=i[n.get_identifier().LogicalName][n.get_identifier().Id.toString()];for(let n=0;n<r.length;n++){t.getValue(r[n]).equals(e)||t.setValue(r[n],e)}}}a.resolve(t)},()=>{a.resolve(t)}),a}refreshRetrieveMultipleLookupData(e,t,n){const a=new _.a,i={},s=[],l=e.get_entities();for(let e=0;e<l.length;e++){const t=l[e].get_fieldTypes();for(const n in t){const r={key:n,value:t[n]},a=r.value;if(("lookup"===a||"customer"===a||"owner"===a)&&l[e].hasValue(r.key)){const t=l[e].getValue(r.key);if(Object(o.a)(t))continue;if(this._offlineTypescriptInterface.isEntityAvailableForOfflineUsage(t.LogicalName)){s.indexOf(r.key)<0&&s.push(r.key);const e=t.LogicalName in i?i[t.LogicalName]:[];e.indexOf(t.get_identifier())<0&&(e.push(t.get_identifier().toUpperCase()),i[t.LogicalName]=e)}}}}const u=[];for(const e in i)u.push(this._localDataSource.get_offlineDataStore().retrieveLookupRecords(i[e],e,n,t));return Object(c.a)(u).then(t=>{const n={};for(const e of t){const t=e.get_entities();for(let e=0;e<t.length;e++)n[t[e].get_key()]=t[e]}for(let e=0;e<l.length;e++)for(const t of s)if(l[e].hasValue(t)&&!Object(o.a)(l[e].getValue(t))){const r=l[e].getValue(t),a=r.get_identifier()in n?n[r.get_identifier()].get_identifier():null;Object(o.a)(a)||r.equals(a)||l[e].setValue(t,a)}a.resolve(e)},t=>{Object(r.d)("OfflineDataSource_RefreshRetrieveMultipleLookupData_OfflineError",y.a.storage,t.get_Message()),a.resolve(e)}),a}getExistingActivityParties(e){const t=new _.a;if(Object(o.a)(e.getValue(l.c))||e.getValue(l.c)===i.a.get_empty())return Object(r.d)("OfflineDataSource_GetExistingActivityParties",y.a.storage,"No activityparty data to retrieve for current entity"),t.resolve(new Array(0));const n=new Array(0),a=[new p.a(l.c+l.l+l.y,e.getValue(l.c).toString(),m.a.Or,0)],s=new g.a(a);return this._localDataSource.get_offlineDataStore().retrieveLocalEntities(l.d,s).then(e=>{const a=Object(o.a)(e)||Object(o.a)(e.rows)?0:e.rows.length,i=l.e;for(let t=0;t<a;t++)Object(o.a)(e.rows.item(t))||Object(o.a)(e.rows.item(t)[i])||(n[n.length]=e.rows.item(t)[i].toUpperCase());Object(r.d)("OfflineDataSource_GetExistingActivityParties",y.a.storage,"GetExistingActivityParties completed successfully"),t.resolve(n)},e=>{Object(r.e)("OfflineDataSource_GetExistingActivityParties - Failure",y.a.storage,e.get_Message()),t.reject(e)}),t}startPlayback(){return f.a.get_DefaultInstance().startPlayback()}hasItemsToUpsync(){return f.a.get_DefaultInstance().hasItemsToUpsync()}hasOfflineChanges(e,t){return f.a.get_DefaultInstance().isLocalCopy(e,t)}applyApplicationMetadataChanges(){return this._localDataSource.get_offlineDataStore().applyApplicationMetadataChanges()}createActivityPointerAndAttachmentView(){this._localDataSource.get_offlineDataStore().createActivityPointerAndAttachmentView()}calculateDisabledOfflineEntities(){return Object(r.d)("OfflineDataSource_CalculateDisabledOfflineEntities",y.a.storage,"Calculate disabled offline entities"),Object(o.a)(this._localDataSource.get_offlineDataStore().get_offlineMetadataManager())?(new _.a).reject(a.a.FromMessage("Cannot calculate disabled offline entities as the OfflineMetadataManager object is not available")):this._localDataSource.get_offlineDataStore().get_offlineMetadataManager().calculateDisabledOfflineEntitiesAfterMetadataSync()}isEntityAvailableForOfflineUsage(e){return this._offlineTypescriptInterface.isEntityAvailableForOfflineUsage(e)}isOfflineAvailableForUse(){return this._offlineTypescriptInterface.isOfflineAvailableForUse()}isOfflineFeatureEnabledForOrganization(){return this._offlineTypescriptInterface.getIsMocaOfflineFeatureEnabled()}isAppAvailableOffline(){return this._offlineTypescriptInterface.isAppAvailableOffline()}isOfflineOptedIn(){return this._offlineTypescriptInterface.getOfflineFeatureStatus()===u.a.Enabled}isDssOfflineEnabled(){return this._offlineTypescriptInterface.isDssOfflineEnabled()}static get_DefaultInstance(){return Object(o.a)(b.a.get_DefaultInstance())||Object(o.a)(v._defaultInstance)&&(v._defaultInstance=new v(b.a.get_DefaultInstance().get_LocalDataSource(),b.a.get_DefaultInstance().get_ServerUri(),b.a.get_DefaultInstance().get_ApplicationStatusProvider()),b.a.get_DefaultInstance().get_LocalDataSource().set_offlineDataStore(new d.b)),v._defaultInstance}}v._defaultInstance=null},"09gH":function(e,t,n){"use strict";n.d(t,"k",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"h",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"j",(function(){return p})),n.d(t,"l",(function(){return g})),n.d(t,"n",(function(){return h})),n.d(t,"m",(function(){return f})),n.d(t,"a",(function(){return m})),n.d(t,"o",(function(){return b}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="jqGrid.strings.integer",a="Invalid_Date_Time",i="_common.styles.duration.htc_71",o="D1A3FDEE-DE35-43E0-8D04-629726F19C08",s="2C5BD24E-AF86-4179-9865-52359439BD0E",c="BE995A69-9CC9-4507-80E3-F46BD0797510",l="C9A1167E-2464-4E5C-A0B4-872B05B8F667",u="56796A28-3D03-49E0-8A96-78F796BB0E44",d="826F4F88-FF87-479D-B0CA-4CA19E481E53",p="Field.Email.Error",g="CustomControl_MaxLengthExceeded_Error",h="Field.Required.Error",f="Field.Number.Error",m="Field.Currency.Error",b=[r,"Invalid_Decimal",a,i,o,s,c,l,u,d,p,g,"IW_ExportTemplate_MaxValue","IW_ExportTemplate_MinValue",h,f,m]},"0FMG":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return d}));var r=n("GPkz"),a=n("qu3G"),i=n("WkRo");const o="sitemap.select.subarea",s="sitemap.select.area",c="sitemap.set.expanded.state";function l(e){return{sync:!0,type:"setSelectedSubAreaIdSync",execute({dispatch:t}){t(function(e){return{type:o,payload:{selectedSubAreaId:e}}}(e)),Object(i.a)()}}}function u(e,t=null){const n={selectedAreaId:e};if(e&&r.a.session&&t){let n=-1;if(t&&t.Areas){const r=Object.keys(t.Areas);r&&r.length&&(n=r.indexOf(e))}r.a.session.addEvent(a.a.switchArea,n)}return{type:s,payload:n}}function d(e){return{type:c,payload:{sitemapExpandedState:e}}}},"0GT3":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("N6mg"),a=n("FZDd"),i=n("BR3n"),o=n("EY5k");function s(){return{type:"initializeQuickCreateMenu.async",execute:({dispatch:e,getState:t},n,s)=>(e(Object(o.e)(i.b)),e(Object(r.a)()).then(t=>{if(t&&t.quickCreateMenuItems){const n={};for(const e in t.quickCreateMenuItems)n[e]=[];e(Object(a.e)(n))}}))}}},"0Lym":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("+Kwi");class a{constructor(e,t,n,r,a){this._dateEnd=null,this._dateStart=null,this._delta=0,this._daylightStart=null,this._daylightEnd=null,this._dateEnd=e,this._dateStart=t,this._delta=n,this._daylightStart=r,this._daylightEnd=a}get_DateStart(){return this._dateStart}get_DateEnd(){return this._dateEnd}get_DaylightStart(){return this._daylightStart}get_DaylightEnd(){return this._daylightEnd}get_Delta(){return this._delta}getObjectData(){const e={};return e.dateend=this._dateEnd,e.datestart=this._dateStart,e.delta=this._delta,e.daylightstart=this._daylightStart.getObjectData(),e.daylightend=this._daylightEnd.getObjectData(),e}static createFromObjectData(e){const t=e.datestart,n=e.dateend,i=e.delta,o=r.a.createFromObjectData(e.daylightstart),s=r.a.createFromObjectData(e.daylightend);return new a(n,t,i,o,s)}}},"0buK":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the TaskBasedFlow page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="TaskBasedFlow"},"0cBP":function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n("8nT0"),a=n("iZ7K"),i=n("LbMF"),o=n("504W");function s(e,t,n){const a=Object(i.a)(e,t,r.v);if(!a||!a.OptionSet)return null;const o=a.OptionSet;for(const e of o)if(e.Value===n&&e.TransitionData)return e.TransitionData;return null}function c(e,t,n,c){const l=Object(a.h)(e,t);if(!l||Object(o.a)(l.EnforceStateTransitions))return[];const u=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,n){const a=Object(i.a)(e,t,r.v);if(!a||!a.OptionSet)return[];const o=[],s=a.OptionSet;for(const e of s)e.State===n&&o.push(e.Value);return o}(e,t,n);if(Object(o.a)(u))return[];if(l.EnforceStateTransitions){if(Object(o.a)(c))return[];const n=s(e,t,c);return Object(o.a)(n)?[]:u.filter(e=>e===c||n.indexOf(e)>=0)}return u}function l(e,t){const n=Object(i.a)(e,t,r.u);return n&&n.OptionSet&&null!==n.DefaultValue&&void 0!==n.DefaultValue?n.DefaultValue:null}},"0her":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runAction=t.waitWithTimeout=t.makeCompositeAction=void 0;var r=n("s5g6");function a(e,t){return new Promise((function(n,r){var a=setTimeout((function(){r(t)}),3e4);e().then((function(e){clearTimeout(a),n(e)}),(function(e){clearTimeout(a),r(e)}))}))}function i(e,t,n,i){return e.isBoot&&r.saveAutomationState(),(e.isComposite?e.action(n,null):new Promise((function(t){setTimeout((function(){t(a((function(){return n.preActionCallback&&n.preActionCallback(),(n.preActionCallback&&n.waitForIdle()||Promise.resolve()).then((function(){return e.action(n,i)}))}),"Action "+e.displayName+" timed out after 30000 ms"))}),n.DELAY_BETWEEN_ACTIONS)}))).then((function(e){return t?n.waitForIdle().then((function(){return e})):e}))}t.waitWithTimeout=a,t.runAction=i,t.makeCompositeAction=function(e,t){return{action:function(t){return e.reduce((function(e,n){return e.then((function(e){return i(n,!0,t,e)}))}),Promise.resolve())},displayName:t,isComposite:!0}}},"0iNb":function(e,t,n){"use strict";n.d(t,"a",(function(){return A})),n.d(t,"b",(function(){return D}));var r=n("9eA9"),a=n("w1eR"),i=n("Zvo8"),o=n("ruPX"),s=n("QbIY"),c=n("ZuxC"),l=n("E5IU"),u=n("UZFl"),d=n("69Qu"),p=n("17x/"),g=n("C78e"),h=n("KeJu"),f=n("yRo8"),m=n("+BIz"),b=n("tICD"),_=n("EY5k"),y=n("YxC/"),v=n("69gE"),S=n("iF9X"),O=n("ml6Y"),C=n("RADj"),E=n("pEXn"),I=n("lMS8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const w=["Metadata_Dialog_Button_Update","Metadata_Dialog_Button_Skip","Update_Metadata_Prompt_Title","Metadata_Download_Confirmation"];function j(e,t,n){return{type:"offline.metadata.downlaod.async",async execute({dispatch:r,getState:a},i){let o;const s=Object(l.o)(a());var c,u;s?(await r(Object(I.d)()),o=!0):o=await r((c="Update_Metadata_Prompt_Title",u="Metadata_Download_Confirmation",{type:"offline.metadata.confirm.dialog.async",execute:({dispatch:e,getState:t})=>e(Object(_.e)(w)).then(()=>{const n=Object(y.e)(t(),w),r=Object(y.c)(n,c),a=Object(y.c)(n,u),i=Object(y.c)(n,"Metadata_Dialog_Button_Update"),o=Object(y.c)(n,"Metadata_Dialog_Button_Skip");return e(Object(m.a)(a,{},r,void 0,"",i,o)).then(t=>0===t.status?e(Object(b.a)(t.pageId)).then(e=>e.value.confirmed):Promise.reject(t.error))})}));const d=a(),p=Object(S.e)(d),g=n.TraceManager.getTracer(f.f),h=[];let j=null,P=!1;if(o){const n=s?"Sync started with offline by default app":"Update button is clicked";if(g.warn(`OfflineMetadataDownloadActions.DownloadOfflineMetadataWithUserConfirmation: ${n}.`),!p){const n=new v.a(i,t),a=n.IsExecAvailable();return a&&n.onSyncStart(),r(Object(f.h)(e)).then(()=>{a&&n.onSyncComplete()}).catch(e=>(a&&n.onSyncError(),Promise.reject(e)))}j=C.a.InSyncWithServer,P=!0,r(Object(f.i)({syncStatus:j,metadataAvailable:P}))}else j=C.a.SyncPendingFromServer,r(Object(f.i)({syncStatus:j})),g.warn("OfflineMetadataDownloadActions.DownloadOfflineMetadataWithUserConfirmation: Skip button is clicked.");if(p){Object(f.j)(i,f.c,P),h.push({name:f.c,value:P}),Object(f.j)(i,f.d,j),h.push({name:f.d,value:j});const e=!0;Object(f.j)(i,O.a.IsFirstApplicationMetadataDownloadConfirmationDoneKey,e),h.push({name:E.b.IsFirstDownloadPromptAlreadyTriggered,value:e}),g.warn("OfflineMetadataDownloadActions.DownloadOfflineMetadataWithUserConfirmation: IsFirstDownloadPromptAlreadyTriggered is set to "+e,h)}}}}var P=n("jsc8"),T=n("0kGT"),N=n("wL2W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function A(e){const t=/[?&](pagetype)/i.exec(e.search);return t&&t.length>1?e.searchParams.get(t[1]):null}async function D(e,t){let n=e.getInitialUrl();const i=e.getStore(),s=p.c(i.getState()),d=s?null:A(n),g=e.getClientHost()===a.a.MobileApplication||s;if(await Object(N.c)(i,t.EventManager,n),null!==d)return i.dispatch(Object(o.a)(n.toString(),void 0,void 0,{replaceState:!0}));if(g){const a=Object(l.i)(i.getState());if(!a){const e={webresourceName:void 0};return i.dispatch(Object(o.a)(u.a,e))}return function(e,t,n){return Object(T.b)(t)?Promise.resolve(null):n.DataSource?Promise.resolve(n.DataSource.retrieveSessionState(c.a)).then(t=>t?t[e]:null):Promise.resolve(null)}(a,i.getState(),t).then(a=>a?(n=new r.a(a),e.setInitialUrl(n),R(()=>i.dispatch(Object(o.a)(n.toString(),void 0,void 0,{replaceState:!0})),i,t,g)):R(x.bind(null,i),i,t,g))}return R(x.bind(null,i),i,t,g)}async function R(e,t,n,r){const a=n.DataSource.get_IsLocalDataSourceAvailable();return Object(d.b)(t.getState())&&r&&p.a(t.getState())&&a?(await function(e,t){const n=e.getState(),r=O.a.IsFirstApplicationMetadataDownloadConfirmationDoneKey,a=t.TraceManager.getTracer(f.f),i=[];if(i.push({name:E.b.IsApplicationMetadataDownloadInShimEnabled,value:Object(S.e)(n)}),!Object(S.e)(n))return M(e,t);return e.dispatch(Object(P.a)(r)).then(n=>{const o=function(e,t){if(e&&e[t])return e[t];return!1}(n,r);if(i.push({name:E.b.IsFirstDownloadPromptAlreadyTriggered,value:o}),a.warn("BootNavigationHelper.performOfflineMetadataSync",i),!o)return M(e,t)})}(t,n),e()):e()}function x(e){return e.dispatch(Object(s.a)()).then(()=>{if(navigator.cookieEnabled){const t=Object(l.i)(e.getState());if(null!==t){const n=Object(i.b)("persistentNavTourCookie_"+t);if(null==Object(i.b)("sessionNavTourCookie_"+t)&&(null==n||null!==n&&"false"===n)){Object(i.c)("sessionNavTourCookie_"+t,"true",0);const n=Object(l.n)(e.getState());n&&n.name&&""!==n.name&&e.dispatch(Object(g.a)(null,n.name))}}}})}function M(e,t){return e.dispatch(Object(h.c)()).then(n=>{if(n)return e.dispatch(j(n,e,t))})}},"0kGT":function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d}));var r=n("Lyxw"),a=n("3/02"),i=(n("u+q+"),n("GYEz")),o=n("LzVy"),s=n("sclX"),c=n("w1eR"),l=n("H4dV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const u=e=>{const t=Object(r.a)(e,a.Qc,a.Lc),n=Object(o.a)(e),u=Object(i.a)(e);return!(!t||n!==s.b.Native||u===c.a.MailApp||!l.a.getInstance().get_IsIOS()&&!l.a.getInstance().get_IsAndroid())||Object(r.c)(e,a.uc)},d=e=>Object(r.c)(e,a.tc)},"0l0t":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"f",(function(){return a})),n.d(t,"g",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return l}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="_NA_Info",a="_NA_SFA",i="_NA_CS",o="_NA_MA",s="_NA_IMA",c="_NA_PROC",l="_NA_AO"},"0lM4":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t,n){this._promise=null,this._contextString=null,this._cacheName=null,this._promise=e,this._contextString=t,this._cacheName=n}getPromise(){return this._promise}getContextString(){return this._contextString}getCacheName(){return this._cacheName}}},"0mlq":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("504W");class a{constructor(){this.name=null,this.requestText=null,this.requestSize=0,this.requestOptions=null,this.childRequests=null,this.context=null}static create(e,t,n,i,o){const s=new a;return s.name=e,s.requestText=t,s.requestSize=Object(r.a)(t)?0:t.length,s.requestOptions=n,s.context=i,s.childRequests=o,s}}},"0nOn":function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n("2yvP"),a=n("pEXn"),i=n("IaGr"),o=n("f/sd"),s=n("mL5Q"),c=n("arV0"),l=n("FdB0"),u=n("cfbi"),d=n("EBJu"),p=n("4aOd"),g=n("Lyxw"),h=n("3/02"),f=n("ABCl"),m=n("wL2W"),b=n("zmL5"),_=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const y=new Set;class v{constructor(e,t,n,r,a){this._store=e,this._pageId=n,this._isReportUnsupportedClientApiEnabled=Object(g.c)(null==e?void 0:e.getState(),h.nd),this._isReportUnsupportedClientApiEverythingEnabled=Object(g.c)(null==e?void 0:e.getState(),h.od),this._isInMonitoringSession=Object(m.a)(),this._clientApiExecutor=new f.b(e,t,r,a)}isPageReadyForClientAPIAccess(){return this._getIsPageReadyForClientAPIAccessState().ready}getComponentName(e){return this._clientApiExecutor.getComponentName(e)}reportFailure(e,t,n){return this._clientApiExecutor.reportFailure(e,t,n)}execute(e,t,n,r=!0){return this._clientApiExecutor.execute(e,(n,r,a)=>(this._reportUnsupportedClientApiAccess(e,n,r),t(n,r,a)),n,r)}executeAsync(e,t,n,r=!0){return this._clientApiExecutor.executeAsync(e,(n,r,a)=>(this._reportUnsupportedClientApiAccess(e,n,r),t(n,r,a)),n,r)}addEventParameter(e){this._clientApiExecutor.addEventParameter(e)}_reportUnsupportedClientApiAccess(e,t,n){var r,o;const{ready:s,pageLoadingState:c}=this._getIsPageReadyForClientAPIAccessState();if(!s){let e=this._isInMonitoringSession||this._isReportUnsupportedClientApiEverythingEnabled;if(!e){const t=Object(b.b)(null===(r=this._store)||void 0===r?void 0:r.getState(),this._pageId);e=!_.a.isNullOrEmpty(t)&&y.has(t),e&&y.add(t)}if(e){n.push({name:"pageLoadingState",value:c});const e=new p.a(new Error);n.push({name:"callStack",value:e.getStackTrace()}),null===(o=i.a.getInstance().traceManager.getTracer(`${a.k}${a.i}`))||void 0===o||o.error(a.n,[{name:a.v,value:a.i},{name:a.i,value:JSON.stringify(n)}])}}}_getIsPageReadyForClientAPIAccessState(){var e,t;const n=null===(e=this._store)||void 0===e?void 0:e.getState(),a=null===(t=Object(r.a)())||void 0===t?void 0:t.sourceName;if(!n||null===this._pageId||void 0===this._pageId||!this._isReportUnsupportedClientApiEnabled||"bpf.initialization"===a||"form.initialization"===a||"page.initialization"===a)return{ready:!0,pageLoadingState:void 0};const i=Object(c.l)(n,this._pageId),p=Object(s.a)(n,this._pageId);return{ready:!(i===u.a||i===d.a||i===l.a)||p>=o.a.OnLoadReady&&p!==o.a.Error,pageLoadingState:p}}}},"0rLi":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("iJGp"),a=n("504W");class i{constructor(e,t,n,r,a,i,o,s,c,l){this.MetadataType=null,this.MetadataSubtype=null,this.EntityLogicalName=null,this.MetadataId=null,this.MetadataNames=null,this.GetDefault=!1,this.DependencyDepth=0,this.ChangedAfter=null,this.Exclude=null,this.AppId=null,this.IsPreloadCall=!1,this.MetadataType=e,this.MetadataSubtype=t,this.EntityLogicalName=n,this.MetadataId=r,this.MetadataNames=a,this.GetDefault=i,this.DependencyDepth=o,this.ChangedAfter=s,this.Exclude=c,this.AppId=l}toString(){const e=new Sys.StringBuilder;if(Object(a.b)(this.MetadataType)||e.append(String.format("MT: {0}; ",this.MetadataType)),Object(a.b)(this.MetadataSubtype)||e.append(String.format("MST: {0}; ",this.MetadataSubtype)),Object(a.b)(this.EntityLogicalName)||e.append(String.format("ELN: {0}; ",this.EntityLogicalName)),this.MetadataId&&e.append(String.format("MI: {0}; ",this.MetadataId.toString())),this.MetadataNames&&this.MetadataNames.length>0){e.append(String.format("MNS: "));for(const t of this.MetadataNames)e.append(String.format("{0} ",t));e.append("; ")}if(e.append(String.format("GD: {0}; ",this.GetDefault.toString())),e.append(String.format("DD: {0}; ",r.a[this.DependencyDepth])),Object(a.b)(this.ChangedAfter)||e.append(String.format("CA: {0}; ",this.ChangedAfter)),this.Exclude&&this.Exclude.length>0){e.append(String.format("EX: "));for(const t of this.Exclude)e.append(String.format("{0} ",t));e.append("; ")}return this.AppId&&e.append(String.format("AI: {0}; ",this.AppId.toString())),e.toString()}}},"0uKS":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("fILV"),a=n("ruPX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t,n,i,o,s,c,l,u,d,p){const g={entityTypeName:e,viewId:n,viewType:u,showChart:i,visualizationType:o,visualizationId:s,filterExpression:c,chartDrillDownParameters:d,isQueryMode:p&&p.isQueryMode,isAdvancedFindView:p&&p.isAdvancedFindView};return Object(a.a)(r.a,g,t,l)}},"11K9":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("pEXn");function a(e,t){const{navPath:n,canOverride:a,etn:i,type:o,dashboardId:s}=e||{};return[{name:r.b.DashboardNavPath,value:n},{name:r.b.ShowDefaultDashboard,value:a},{name:r.b.ActionType,value:t},{name:r.b.EntityName,value:i},{name:r.b.DashboardType,value:o},{name:r.b.DashboardId,value:s&&s.guid}]}},"16wZ":function(e,t,n){"use strict";n.d(t,"j",(function(){return g})),n.d(t,"e",(function(){return p})),n.d(t,"a",(function(){return _})),n.d(t,"b",(function(){return y})),n.d(t,"k",(function(){return m})),n.d(t,"h",(function(){return S})),n.d(t,"c",(function(){return O})),n.d(t,"d",(function(){return C})),n.d(t,"l",(function(){return b})),n.d(t,"g",(function(){return h})),n.d(t,"f",(function(){return f})),n.d(t,"i",(function(){return v}));var r=n("zsAz"),a=n("Uv1Y"),i=n("SAYH"),o=n("ngeo"),s=n("EY5k"),c=n("YxC/"),l=n("ZIjf"),u=n("IaGr"),d=n("VIXY");function p(e,t,n,a){throw e&&(n||(n=t),a||(a=[]),a.push({name:"validationError",value:"true"}),u.a.getInstance().traceManager.getTracer(e).error(n,a)),Object(r.d)(t,2415919121)}function g(e,t,n){n||(n=[]),n.push({name:"name",value:t});p(e,"Required parameter is null or undefined: "+t,"Required parameter is null or undefined",n)}function h(e,t,n,r){null==e&&g(t,n,r)}function f(e,t,n,r,a){a||(a=[]),"guid"===r?i.a.validate(n)||(a.push({name:"type",value:typeof n}),m(e,r,t,a)):typeof n!==r&&(a.push({name:"type",value:typeof n}),m(e,r,t,a))}function m(e,t,n,r){r||(r=[]),r.push({name:"expectedType",value:t}),r.push({name:"name",value:n});p(e,`Value should be of type: ${t}: Parameter Name: ${n}`,"Parameter type validation error",r)}function b(e){p(e,"Invalid XML Format")}function _(e){return null==e}function y(e){return!((new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("parsererror").length>0)}function v(e,t,n){const r=`The API ${t} is not supported in the current context`;n||(n=[]),n.push({name:"apiName",value:t}),p(e,r,"API not supported in the current context",n)}function S(e,t,n,r){const a=`Invalid value ${n} for ${t}`;r||(r=[]),r.push({name:"name",value:t}),r.push({name:"value",value:n}),p(e,a,"Invalid value",r)}function O(e,t){return C(e,t,"ClientApi.ErrorValidation.parseError")}function C(e,t,n,i,p=!0,g=!0,h){var f;const m="ClientApi.ErrorValidation.parseErrorToResponse";let b;const _="An error has occurred. Try this action again. If the problem continues, check the Microsoft Dynamics 365 Community for solutions or contact your organization's Microsoft Dynamics 365 Administrator. Finally, you can contact Microsoft Support.";try{if(i||(i=[]),i.push({name:"sourceComponent",value:n}),function(e){
//!error.name to stop UCIError giving false positive
return e&&e.errorCode&&e.errorCode>0&&e.message&&!e.name}(t))return Promise.reject(t);let y,v;const S="Error_Message_Generic",O="Error_Message_Generic_Instruction",C="CRM_Dynamics_Community",I="Microsoft_Support";let w,j,P,T;if(null==t?void 0:t.displayMessage)y=t.message,b=t.errorCode;else if(E(t))v=t.get_organizationServiceFault();else if(t&&t.reason&&E(t.reason))v=t.reason.get_organizationServiceFault();else if(function(e){return e&&e.hasOwnProperty("_errorSource")&&e instanceof Error}(t)){b=t.errorCode,y=t.message;const e=t.innerError;e&&(w={message:e.message,stacktrace:e.stack})}else if(Object(r.f)(t)){b=a.a.fromLegacyErrorStatus(t).errorCode,y=t.get_Message();const e=t.get_InnerError();e&&(w={message:e.get_Message(),stacktrace:""})}else Object(r.g)(t)&&(b=t.errorCode,y=t.message);if(v){b=v.get_errorCode(),y=v.get_message();const e=v.get_innerFault();e&&(w={message:e.get_message(),stacktrace:e.get_callStack()})}if(i.push({name:"errorMessage",value:y}),b){g&&l.a.instance.reportSuccess(n),b<0&&(b=b+4294967295+1),i.push({name:"errorCode",value:b});const e="0x"+o.a.getHexErrorCodeFromInt(b);P="Error_Message_"+e,T="Error_Title_"+e,j=[P,T],p&&u.a.getInstance().traceManager.getTracer(n).error("Error detected with an error code.  See EventContext for more details.",i)}else g&&l.a.instance.reportFailure(n),j=[S,O,C,I],p&&(t||(t=new Error("Received blank error object")),h?h.reportFailure(n,t,i):u.a.getInstance().eventManager.ReportComponentFailure(n,t,null,i));return(null==t?void 0:t.displayMessage)?(b=null!==(f=t.errorCode)&&void 0!==f?f:2147746581,Promise.reject({errorCode:b,message:t.displayMessage})):2148081666===b?Promise.reject({errorCode:b,message:y,code:b,innerror:w}):2147746405===b?(t.innerError&&t.innerError.message?y=t.innerError.message:t.message&&(y=t.message),Promise.reject({errorCode:b,message:y,code:b,innerror:w})):(2415919125===b&&(b=2147746581),e?e.dispatch(Object(s.e)(j)).then(()=>{const n=Object(c.e)(e.getState(),j);let r,a;if(b)if(r=Object(c.c)(n,P),a=Object(c.c)(n,T),r){if(t.param)r=String.format(r,t.param);else if(t.errorParameters){const e=t.errorParameters.map(e=>e.value);r=String.format(r,e)}}else 2147746581!==b&&(t.message&&(r=t.message),u.a.getInstance().eventManager.ReportComponentFailure(m+".localizedErrorMessage",new Error("Error message for the error code is not present in resource file"),"Add the error message in resource file correspond to error code",i));else b=2147746581;if(!r){const e=Object(d.a)(Object(c.c)(n,O),Object(c.c)(n,C),Object(c.c)(n,I));r=Object(d.a)(Object(c.c)(n,S),e,"")}const o={errorCode:b,message:r,code:b,title:a};return w&&(o.innerror=w),Promise.reject(o)}):(u.a.getInstance().eventManager.ReportComponentFailure(m,new Error("Could not retrieve localized error strings, store is null or undefined"),null,i),b||(b=2147746581),Promise.reject({errorCode:b,message:_,code:b})))}catch(e){return u.a.getInstance().eventManager.ReportComponentFailure(m,e,null,i),b||(b=2147746581),Promise.reject({errorCode:b,message:_,code:b})}}function E(e){return null==e?void 0:e.get_organizationServiceFault}},"17x/":function(e,t,n){"use strict";n.d(t,"b",(function(){return _})),n.d(t,"a",(function(){return y})),n.d(t,"e",(function(){return v})),n.d(t,"g",(function(){return S})),n.d(t,"c",(function(){return O})),n.d(t,"h",(function(){return C})),n.d(t,"d",(function(){return E})),n.d(t,"f",(function(){return I}));var r=n("SAYH"),a=n("E5IU"),i=n("IqkD"),o=n("NjDY"),s=n("iF9X"),c=n("Lyxw"),l=n("3/02"),u=n("GYEz"),d=n("w1eR"),p=n("hAdb"),g=n("69Qu"),h=n("37s6");function f(){return-1!==window.navigator.userAgent.indexOf("Chrome")}function m(){return e="openDatabase",void 0!==window.self[e];var e}function b(e,t){const n=r.a.toString(Object(i.e)(e)),o=Object(a.b)(e,161),s=null!==n&&null!==o&&o.indexOf(n)>=0;return t&&t.TraceManager.getTracer("Offline").info("Offline profile "+(s?"found":"NOT found")+" for profile id: "+n+" - app id: "+Object(a.i)(e)+" - app name: "+Object(a.j)(e)),s}function _(e,t){return!(!Object(o.m)(e)&&!O(e))&&b(e,t)}function y(e){return!!Object(s.a)(e)&&b(e)}function v(e,t){let n=Object(c.b)(e,"UnifiedClientCacheModeEnabled");return t&&t.searchParams&&t.searchParams.has("cache")&&(n="true"===t.searchParams.get("cache")),n}function S(e){return Object(a.o)(e)&&Object(g.b)(e)&&Object(h.w)(e)}function O(e){return(Object(c.c)(e,l.p)||Object(c.c)(e,l.nc))&&m()&&Object(u.a)(e)===d.a.Browser&&f()}function C(e){return O(e)&&Object(c.c)(e,l.nc)}function E(e){return(Object(p.d)(e,l.p)||Object(p.d)(e,l.nc))&&m()&&Object(u.a)(e)===d.a.Browser&&f()}function I(e){if(e){if("Completed"===e.totalProgress&&e.totalErrorCount>0||"Error"===e.totalProgress)return{isFileSyncCompleted:!0,isFileSyncCompletedWithError:!0};if("Completed"===e.totalProgress&&0===e.totalErrorCount)return{isFileSyncCompleted:!0,isFileSyncCompletedWithError:!1}}return{isFileSyncCompleted:!1,isFileSyncCompletedWithError:!1}}},"1AYO":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return P}));var r,a=n("nuS9"),i=n("4fxQ");!function(e){e[e.left=0]="left",e[e.right=1]="right",e[e.up=2]="up",e[e.down=3]="down",e[e.leftup=4]="leftup",e[e.rightup=5]="rightup",e[e.upleft=6]="upleft",e[e.downleft=7]="downleft"}(r||(r={}));var o=n("j6Db"),s=n("UR8A");function c(){return{width:document.body.offsetWidth,height:document.body.offsetHeight}}function l(){var e=document.getElementById("topBar-mobile"),t=u(),n=c();return{left:document.body.scrollLeft,top:document.body.scrollTop,right:t.width-n.width-document.body.scrollLeft,bottom:e?e.offsetHeight:t.height-n.height-document.body.scrollTop}}function u(){return{width:document.body.scrollWidth,height:document.body.scrollHeight}}function d(e){return{width:e.offsetWidth-e.clientWidth+e.scrollWidth,height:e.offsetHeight-e.clientHeight+e.scrollHeight}}function p(e,t,n,r){void 0===n&&(n=c()),void 0===r&&(r=l());var a={},i=t.maxWidth&&t.width&&t.maxWidth>0&&t.maxWidth<t.width?t.maxWidth:t.width?t.width:0,o=t.maxHeight&&t.height&&t.maxHeight>0&&t.maxHeight<t.height?t.maxHeight:t.height?t.height:0;return"number"==typeof e.left?(a.width=Math.max(r.left-e.left,0),a.width+=Math.max(e.left+i-n.width-r.left,0)):"number"==typeof e.right&&(a.width=Math.max(r.right-e.right,0),a.width+=Math.max(e.right+i-n.width-r.right,0)),"number"==typeof e.top?(a.height=Math.max(r.top-e.top,0),a.height+=Math.max(e.top+o-n.height-r.top,0)):"number"==typeof e.bottom&&(a.height=Math.max(r.bottom-e.bottom,0),a.height+=Math.max(e.bottom+o-n.height-r.bottom,0)),a}function g(e){switch(e){case r.down:return[r.down,r.downleft,r.up,r.upleft,r.right,r.rightup,r.left,r.leftup];case r.downleft:return[r.downleft,r.down,r.upleft,r.up,r.right,r.rightup,r.left,r.leftup];case r.right:return[r.right,r.rightup,r.left,r.leftup,r.down,r.downleft,r.up,r.upleft];case r.rightup:return[r.rightup,r.right,r.leftup,r.left,r.down,r.downleft,r.up,r.upleft];case r.up:return[r.up,r.upleft,r.down,r.downleft,r.right,r.rightup,r.left,r.leftup];case r.upleft:return[r.upleft,r.up,r.downleft,r.down,r.right,r.rightup,r.left,r.leftup];case r.left:return[r.left,r.leftup,r.right,r.rightup,r.down,r.downleft,r.up,r.upleft];case r.leftup:return[r.leftup,r.left,r.rightup,r.right,r.down,r.downleft,r.up,r.upleft];default:var t="";try{t=JSON.stringify(e)}catch(e){t="Unable to parse initial direction"}var n=new Error("Unexpected initial direction: "+t);throw s.b.Reporting.reportFailure(o.a+".Primitive.Flyout",n),n}}function h(e,t,n){var a=function(e,t){void 0===t&&(t=document.body);var n=t.getBoundingClientRect(),r=e.getBoundingClientRect();return{top:r.top-n.top,left:r.left-n.left}}(n,document.body),i=n.getBoundingClientRect(),o=c(),s={top:a.top,left:a.left,width:i.width,height:i.height,right:a.left+i.width,bottom:a.top+i.height},l=s.top,u=s.right,d=null,p=null;function g(){return e.maxWidth&&e.maxWidth<e.width?e.maxWidth:e.width}function h(){return e.maxHeight&&e.maxHeight<e.height?e.maxHeight:e.height}switch(t){case r.rightup:e&&e.height?l=s.bottom-h():(l=void 0,p=o.height-s.bottom);break;case r.up:e&&e.height?l=s.top-h():(p=o.height-s.top,l=void 0),u=s.left;break;case r.upleft:e&&e.height?l=s.top-h():(p=o.height-s.top,l=void 0),e&&e.width?u=s.right-g():(u=void 0,d=o.width-s.right);break;case r.down:l=s.bottom,u=s.left;break;case r.downleft:l=s.bottom,e&&e.width?u=s.right-g():(u=void 0,d=o.width-s.right);break;case r.left:l=s.top,e&&e.width?u=s.left-g():d=o.width-s.left;break;case r.leftup:e&&e.height?l=s.bottom-h():(l=void 0,p=o.height-s.bottom),e&&e.width?u=s.left-g():d=o.width-s.left}return{left:u,top:l,right:d,bottom:p}}function f(e){var t=window.getComputedStyle(e);return e&&t&&("auto"===t.overflow||"scroll"===t.overflow||"auto"===t.overflowX||"scroll"===t.overflowX||"auto"===t.overflowY||"scroll"===t.overflowY)}var m,b,_=n("YWpA"),y=n("clbQ"),v=function(){function e(){this._parentFlyoutNameToChildRootNameMap={}}return e.getInstance=function(){return m||(m=new e),m},e.prototype.mountChildFlyout=function(e,t){this._parentFlyoutNameToChildRootNameMap.hasOwnProperty(e)||(this._parentFlyoutNameToChildRootNameMap[e]=[]),this._parentFlyoutNameToChildRootNameMap[e].push(t)},e.prototype.unmountChildFlyout=function(e,t){if(this._parentFlyoutNameToChildRootNameMap.hasOwnProperty(e)){var n=this._parentFlyoutNameToChildRootNameMap[e],r=n.indexOf(t);return r>-1&&(n.splice(r,1),n.length<1&&delete this._parentFlyoutNameToChildRootNameMap[e]),!1}return!1},e.prototype.getChildRoots=function(e){return this._parentFlyoutNameToChildRootNameMap.hasOwnProperty(e)?this._parentFlyoutNameToChildRootNameMap[e]:[]},e}(),S=n("QJW6"),O=n("tMKU"),C=n("p4DY"),E=n("OPfb"),I=(b=function(e,t){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}b(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),w=function(){return(w=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},j=o.a+".Primitive.Flyout",P=function(e){function t(t){var n=e.call(this,t)||this;return n._wasInnerFocusRequested=!1,n._seeMorePopupCount=null,n._resizeHandler=n.debouncingFlyoutEvent((function(){n._flyoutElement&&n._flyoutElement.offsetHeight>0&&n.updateDom()})),n._scrollHandler=n.debouncingFlyoutEvent((function(){if(n.getIsRelative()){for(var e in n._isOutOfRange=!1,n._scrollableAncestors)if(t=n._getRelativeElement(),r=n._scrollableAncestors[e],t.getBoundingClientRect().top<r.getBoundingClientRect().top||t.getBoundingClientRect().bottom>r.getBoundingClientRect().bottom){n._isOutOfRange=!0;break}var t,r;n.updateDom()}}),100),n.debouncingFlyoutEvent=n.debouncingFlyoutEvent.bind(n),n.handleMeasuring=n.handleMeasuring.bind(n),n.setFlyoutRef=n.setFlyoutRef.bind(n),n.handlePointerDown=n.handlePointerDown.bind(n),n.handleOnScroll=n.props.enableTrackOnScroll?n.handleOnScroll.bind(n):null,n.handleWindowBlur=n.handleWindowBlur.bind(n),n._isClickInsideFlyout=n._isClickInsideFlyout.bind(n),n._portal=a.createRef(),n}return I(t,e),Object.defineProperty(t.prototype,"flyoutElement",{get:function(){return this._flyoutElement},enumerable:!1,configurable:!0}),t.prototype.getFlyoutRootId=function(){return this.props.isPortalToElement&&this.props.portalContainerId?this.props.portalContainerId:t.generateFlyoutId(this.props.parentCustomControlId,this.props.groupId)},t.prototype.componentDidMount=function(){var e=this;this.props.hasDynamicContent&&(this._measuringSubscriber={onMeasure:this.handleMeasuring,getComponent:function(){return e._flyoutElement}},y.a.getInstance().addMeasuringSubscribers(this._measuringSubscriber)),this.updateDom(),this._subscribeFlyoutPopupManager()},t.generateFlyoutId=function(e,t){return(e?e+"|":"")+(t?"__flyoutRootNode_"+t:"__flyoutRootNode")},t.prototype.componentDidUpdate=function(){this.updateDom()},t.prototype.componentWillUnmount=function(){this.removeFromDom(),this.resetFocus(),this.props.hasDynamicContent&&y.a.getInstance().removeMeasuringSubscribers(this._measuringSubscriber),O.a.getInstance().removeSubscribers(this._managerSubscriber)},t.prototype._getRelativeElement=function(){var e=document.getElementById(this.props.relativeToElementId);return e&&this.props.relativeToElementIdSelector&&(e=this.props.relativeToElementIdSelector(e)),e},t.prototype.calculatePosition=function(){var e,t={position:"absolute",visibility:this._isOutOfRange?"hidden":"visible",overflowX:this.props.disableHorizontalScroll?"hidden":"auto",overflowY:this.props.disableVerticalScroll?"hidden":"auto"},n=Object.assign({},this.props.size);if(this.getIsAbsolute())e=this.props.position;else{if(!this.getIsRelative()){var a=new Error("Cannot recognize positioning approach");throw s.b.Reporting.reportFailure(j,a),a}var i=this._getRelativeElement();if(!i)return t.visibility="hidden",t;this._updateActualSize();var o=this.props.children;if(o&&o.props&&o.props.style){var u=new RegExp("^(\\d+)\\s*px$"),d=o.props.style,f=void 0;!n.maxHeight&&d.maxHeight&&(f=u.exec(d.maxHeight))&&(n.maxHeight=parseInt(f[1],10)),!n.maxWidth&&d.maxWidth&&(f=u.exec(d.maxWidth))&&(n.maxWidth=parseInt(f[1],10))}var m={width:n.width||this._actualSize&&this._actualSize.width,maxWidth:n.maxWidth||this._actualSize&&this._actualSize.maxWidth,height:n.height||this._actualSize&&this._actualSize.height,maxHeight:n.maxHeight||this._actualSize&&this._actualSize.maxHeight},b=null===this.props.flyoutDirection||void 0===this.props.flyoutDirection?r.right:this.props.flyoutDirection,_=null;if(null!==this._lastDirection&&void 0!==this._lastDirection&&(_=b,b=this._lastDirection),this.props.enforceDirection)e=h(m,b,i),this._lastDirection=b;else{var y=function(e,t,n,r){if(e){var a=void 0;null!==r&&r!==t?((a=g(r)).splice(a.indexOf(t),1),a.unshift(t)):a=g(t);for(var i=t,o=void 0,s=void 0,c=0,l=a;c<l.length;c++){var u=l[c],d=h(e,u,n),f=p(d,e);if(0===f.height&&0===f.width){s=d,i=u,o=f;break}if(o){var m=o.width+o.height;f.width+f.height<m&&(s=d,i=u,o=f)}else s=d,i=u,o=f}return{Position:s,Direction:i}}return{Position:h(e,t,n),Direction:t}}(m,b,i,_);e=y.Position,this._lastDirection=y.Direction}e.left=e.left>=0?e.left:0}if(this._actualSize){var v=p(e,this._actualSize),S=l();v.width&&!n.width&&(e.left<S.left&&(e.left=S.left),e.right<S.right&&(e.right=S.right)),!v.height||n.height||e.bottom||0===e.bottom||(e.top<S.top&&(e.top=S.top),e.bottom<S.bottom&&(e.bottom=S.bottom))}var O=function(e,t,n){void 0===t&&(t=c()),void 0===n&&(n=l());var r={};return"number"==typeof e.left?r.maxWidth=t.width+n.left-e.left:"number"==typeof e.right&&(r.maxWidth=t.width+n.right-e.right),"number"!=typeof e.top&&"number"!=typeof e.bottom||(r.maxHeight=t.height+n.top-e.top),r}(e),C=O;return n.maxHeight&&n.maxHeight<O.maxHeight&&(C.maxHeight=n.maxHeight),n.maxWidth&&n.maxWidth<O.maxWidth&&(C.maxWidth=n.maxWidth),Object.assign(t,e,C),n.height&&(t.height=n.height),n.width&&(t.width=n.width),t},t.prototype._updateActualSize=function(){if(this._actualSize){var e=d(this._flyoutElement);0!==e.width&&0!==e.height&&(this._actualSize.width===e.width&&this._actualSize.height===e.height||(this._actualSize=d(this._flyoutElement)))}},t.prototype.ensureRootNode=function(){this.rootNode||(this.rootNode=document.getElementById(this.getFlyoutRootId()),this.rootNode||(this.rootNode=document.createElement("div"),this.rootNode.id=this.getFlyoutRootId(),this.rootNode.setAttribute("data-id",this.rootNode.id),this.rootNode.setAttribute("flyoutRoot",this.props.isPortalToElement&&this.props.portalContainerId?"":"__flyoutRootNode"),document.body.appendChild(this.rootNode)))},t.prototype.debouncingFlyoutEvent=function(e,t){void 0===t&&(t=200);var n=0;return function(){n||(n=window.setTimeout((function(){e(),n=0}),t))}},t.prototype.handleMeasuring=function(e,t){this._actualSize.width===e&&this._actualSize.height===t||(this._actualSize.width=e,this._actualSize.height=t,this.updateDom())},t.prototype.getIsRelative=function(){return"relative"===this.props.positionType||!this.props.positionType&&this.props.relativeToElementId},t.prototype.getIsAbsolute=function(){return"absolute"===this.props.positionType||!this.props.positionType&&this.props.position},t.prototype.setFlyoutRef=function(e){this._flyoutElement=i.findDOMNode(e)},t.prototype.updateDom=function(){var e=this;if(this.props.testhooks&&this.props.testhooks,this.props.children){null===this._seeMorePopupCount&&(this._seeMorePopupCount=S.a.getInstance().getPopupCount());var t=this._seeMorePopupCount>0;this.ensureRootNode(),this.parentFlyoutNode||(this.parentFlyoutNode=document.createElement("div"),this.rootNode.appendChild(this.parentFlyoutNode));var n=Object.assign({},this.props.flyoutStyle,this.calculatePosition(),{boxSizing:"border-box"},this.props.rootZIndex||t?{zIndex:1}:{},(window.navigator.userAgent.match("MSIE")||window.navigator.userAgent.match("Trident"))&&void 0===this._flyoutElement?{left:0}:{}),r=!this._actualSize;if(r){var i=u();Object.assign(n,{bottom:null,right:null,maxWidth:i.width,maxHeight:i.height,visibility:"hidden"})}var o=a.createElement(_.a,w({id:this.props.id,style:n,ref:this.setFlyoutRef,onClick:function(e){return e.stopPropagation()}},this.props),this.props.children);this._portal.current.bindDOMElement(o,this.parentFlyoutNode,"flyout",(function(){if(e.focusInnerElement(r),e._actualSize=d(e._flyoutElement),!e._isFlyoutShown&&(window.addEventListener("blur",e.handleWindowBlur),window.addEventListener("resize",e._resizeHandler),e.getIsRelative())){e._scrollableAncestors=function(e,t){var n=[];for(e=e&&e.parentElement;e&&e!==t;)f(e)&&n.push(e),e=e.parentElement;return n}(e._getRelativeElement(),document.body);for(var t=0,n=e._scrollableAncestors;t<n.length;t++){n[t].addEventListener("scroll",e._scrollHandler)}}e._isFlyoutShown=!0,r&&e.updateDom()}))}else this.removeFromDom(),this.resetFocus()},t.prototype.focusInnerElement=function(e){!e&&this.props.focusCallback&&this.props.focusElementId&&!this._wasInnerFocusRequested&&(this.props.focusCallback(this.props.focusElementId),this._wasInnerFocusRequested=!0)},t.prototype.removeFromDom=function(){if(this.parentFlyoutNode&&(this._portal.current.unbindDOMComponent("flyout"),this.rootNode.removeChild(this.parentFlyoutNode),this.parentFlyoutNode=void 0,0===this.rootNode.childElementCount&&(document.body.removeChild(this.rootNode),this.rootNode=void 0)),this._isFlyoutShown&&(window.removeEventListener("blur",this.handleWindowBlur),this.getIsRelative()&&(window.removeEventListener("resize",this._resizeHandler),this._scrollableAncestors)))for(var e=0,t=this._scrollableAncestors;e<t.length;e++){t[e].removeEventListener("scroll",this._scrollHandler)}this._isFlyoutShown=!1},t.prototype.resetFocus=function(){this.props.focusElementId&&this.props.relativeToElementId&&this.props.focusCallback&&this.props.focusCallback(this.props.relativeToElementId)},t.prototype._isClickInsideFlyout=function(e){if(this._flyoutElement&&this._flyoutElement.contains(e.target)||document.querySelector(".ms-Layer"))return!0;for(var t=v.getInstance().getChildRoots(this.getFlyoutRootId()),n=0;n<t.length;n++){var r=document.getElementById(t[n]);if(r&&r.contains(e.target))return!0}return!1},t.prototype.handleOnScroll=function(e){this.ensureRootNode(),!this._isClickInsideFlyout(e)&&this.props.dismissOnScroll&&this.props.onOutsideClick&&this.props.onOutsideClick(e)},t.prototype.handlePointerDown=function(e){this.ensureRootNode(),!this._isClickInsideFlyout(e)&&this.props.onOutsideClick&&this.props.onOutsideClick(e)},t.prototype.handleWindowBlur=function(e){if(this.ensureRootNode(),this.props.onOutsideClick&&!this.props.keepOpenOnWindowBlur){var t=document.activeElement;if(t&&"IFRAME"===t.tagName.toUpperCase()){var n=Object.create(e,{target:{value:t}});if(this._isClickInsideFlyout(n))return}var r=Object.create(e,{target:{value:this.rootNode}});this.props.onOutsideClick(r)}},t.prototype.render=function(){return a.createElement(E.a,{key:"portal",ref:this._portal,renderReactSubtree:i.createPortal})},t.prototype._subscribeFlyoutPopupManager=function(){var e=this;this._managerSubscriber={type:C.a.Flyout,isClickInsideSubscriber:this._isClickInsideFlyout,onPointerDown:this.handlePointerDown,onScroll:this.props.enableTrackOnScroll?this.handleOnScroll:null,getComponent:function(){return e._flyoutElement}},O.a.getInstance().addSubscribers(this._managerSubscriber)},t.displayName="Flyout",t}(a.Component)},"1Ibc":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("Lyxw"),a=n("3/02"),i=n("NjDY"),o=n("H4dV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e){const t=Object(i.x)(e);return Object(r.c)(e,a.cc)&&!t.globalHelpUrlEnabled&&t.isContextualHelpEnabled&&!o.a.getInstance().get_IsBrowserIE()}},"1OTd":function(e,t,n){"use strict";n.d(t,"m",(function(){return r})),n.d(t,"q",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"n",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"k",(function(){return p})),n.d(t,"l",(function(){return g})),n.d(t,"r",(function(){return h})),n.d(t,"s",(function(){return f})),n.d(t,"o",(function(){return m})),n.d(t,"p",(function(){return b})),n.d(t,"e",(function(){return _})),n.d(t,"d",(function(){return y})),n.d(t,"h",(function(){return v})),n.d(t,"i",(function(){return S}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="router.start",a="router.updatebrowsingcontext",i="router.adddialogcontexttobrowsingcontext",o="router.removedialogcontextfrombrowsingcontext",s="router.closebrowsingcontext",c="router.closebrowsingcontextinternal",l="router.createbrowsingcontext",u="router.createbrowsingcontextinternal",d="router.navigateTo.async",p="router.navigateToNewWindow.async",g="Navigation.Cancelled",h="router.updatedialogcontext",f="router.updatedialogcontextinternal",m="router.removepagefromdialogcontexthistory",b="router.removepagefromdialogcontexthistoryinternal",_="router.closedialogcontexts",y="router.closedialogcontext",v="router.createdialogcontext",S="router.createdialogcontextinternal"},"1S8a":function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}));var r=n("E5IU"),a=n("pF61"),i=n("arV0"),o=n("UZFl"),s=n("4leG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e){const t=Object(r.i)(e);return Object(s.b)(e)||!!t}function l(e){return!Object(s.b)(e)&&!c(e)}function u(e){return!Object(s.b)(e)&&function(e){const t=Object(a.c)(e),n=Object(r.i)(e);let s=!1;return Object(i.l)(e,t)!==o.a||n||(s=!0),s}(e)}function d(e){return!Object(s.b)(e)&&!c(e)}},"1SVz":function(e,t,n){"use strict";n.d(t,"c",(function(){return P})),n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return I}));var r=n("u+q+"),a=n("nuS9"),i=n("YWpA"),o=n("H/hG"),s=n("evW+"),c=n("XIN1"),l=n("znb3"),u=n("1AYO"),d=n("CvZq"),p=n("n2e+"),g=n("3rse"),h=n("FhVi"),f=n("Afz2");class m extends a.Component{_isUiBlocker(){return this.props.type===d.a.BlockingUI}componentDidMount(){this._onKeyDownHandler=this._onKeyDownHandler.bind(this),document.addEventListener("keydown",this._onKeyDownHandler)}componentWillUnmount(){document.removeEventListener("keydown",this._onKeyDownHandler)}_onKeyDownHandler(e){e.keyCode===g.a.Escape&&(this._isUiBlocker()?this.props.reconnect&&this.props.reconnect():this.props.close&&this.props.close())}render(){if(!this.props.isReconnectNotificationShown)return null;let e=this.props.reconnectNotificationHeaderText,t=this.props.reconnectNotificationBodyText,n=this.props.styles.reconnectNotificationBodyStyle;return this._isUiBlocker()&&(e=this.props.reconnectUIBlockerNotificationHeaderText,t=this.props.reconnectUIBlockerNotificationBodyText),this.props.isReconnectSuccessful||(t=this.props.reconnectNotificationReconnectFailBodyText,n=this.props.styles.reconnectNotificationBodyWarningStyle),a.createElement(u.a,{id:"reconnect_notification_Id",key:"reconnect_notification_key",role:f.r,testhooks:{id:"reconnect_notification_Id"},flyoutStyle:this.props.styles.reconnectNotificationRootFlyoutStyle,positionType:"absolute",position:{left:0,top:0,right:0,bottom:0}},a.createElement(i.a,{id:"reconnectNotificationView",style:this.props.styles.reconnectNotificationViewStyle,role:f.e,labelledByElementId:"reconnect_notification_reconnect_title_Id",describedByElementId:"reconnect_notification_reconnect_message_Id"},a.createElement(h.a,{key:"reconnectNotificationViewAccessibility",rootElementId:"reconnectNotificationView",isModal:!0,defaultFocusId:"reconnect_notification_reconnect_button_Id",overrideFocusId:"reconnect_notification_reconnect_button_Id",shouldManageFocus:!0}),a.createElement(i.a,{style:this.props.styles.reconnectNotificationFormHeaderStyle},a.createElement(o.a,{id:"reconnect_notification_reconnect_title_Id",style:this.props.styles.reconnectNotificationHeaderStyle,accessibilityLabel:e,semanticTag:"h1"},e),this._isUiBlocker()?null:this._renderCloseButtonIcon()),a.createElement(i.a,{style:this.props.styles.reconnectNotificationHeaderStyle},this._renderProgressIndicator(),a.createElement(o.a,{id:"reconnect_notification_reconnect_message_Id",style:n,accessibilityLabel:t},t)),a.createElement(i.a,{style:this.props.styles.reconnectNotificationButtonContainerStyle},this._renderReconnectButton(),this._isUiBlocker()?null:this._renderCancelButton())))}_renderProgressIndicator(){return a.createElement(p.b,{key:"reconnectNotificationProgressIndicator"})}_renderReconnectButton(){return a.createElement(s.a,{style:this.props.styles.reconnectNotificationReconnectButtonStyle,id:"reconnect_notification_reconnect_button_Id",onClick:this.props.reconnect,testhooks:{id:"reconnect_notification_reconnect_button_Id"},accessibilityLabel:this.props.reconnectNotificationReconnectButtonText},a.createElement(o.a,{style:this.props.styles.reconnectNotificationReconnectButtonTextStyle,role:f.r},this.props.reconnectNotificationReconnectButtonText))}_renderCancelButton(){return a.createElement(s.a,{style:this.props.styles.reconnectNotificationCancelButtonStyle,id:"reconnect_notification_cancel_button_Id",onClick:this.props.close,testhooks:{id:"reconnect_notification_cancel_button_Id"},accessibilityLabel:this.props.reconnectNotificationCancelButtonText},a.createElement(o.a,{style:this.props.styles.reconnectNotificationCancelButtonTextStyle,role:f.r},this.props.reconnectNotificationCancelButtonText))}_renderCloseButtonIcon(){return a.createElement(s.a,{style:this.props.styles.reconnectNotificationCloseButtonStyle,id:"reconnect_notification_close_button_Id",onClick:this.props.close,testhooks:{id:"reconnect_notification_close_button_Id"},accessibilityLabel:this.props.reconnectNotificationCancelButtonText},a.createElement(c.b,{type:l.a.Close}))}}m.displayName="ReconnectNotificationView";var b=n("unFF"),_=n("b8TU");function y(e){const t=function(e){const t=Object(b.a)(e);return Object(_.c)(e)<=t.sizes.Breakpoints.DimensionS}(e),n=Object(b.a)(e),r={backgroundColor:"white",width:"376px",minHeight:"236px",margin:"auto",flexDirection:"column",display:"flex",border:n.borders.Border01,padding:t?n.sizes.Measures.Measure100:n.sizes.Measures.Measure150,boxShadow:n.shadows.Shadow01,boxSizing:t?"border-box":void 0,alignSelf:"flex-end",justifyContent:t?"space-between":"flex-start"},a={marginTop:"0px",marginBottom:n.sizes.Measures.Measure125,fontFamily:n.fontFamilies.Semilight,fontSize:n.fontSizes.Font125},i={marginTop:"0",marginBottom:n.sizes.Measures.Measure125,alignSelf:"flex-start",fontFamily:n.fontFamilies.Regular,fontSize:n.fontSizes.Font100,flexDirection:t?"column":void 0},o={boxSizing:t?"border-box":void 0,alignSelf:t?"center":"flex-end",flexDirection:t?"column":"row",justifyContent:"flex-end",marginTop:"auto",width:t?"100%":"auto"},s={marginTop:t?n.sizes.Measures.Measure050:0,marginLeft:t?0:n.sizes.Measures.Measure050,alignSelf:"flex-end",width:t?"100%":void 0},c="-"+(t?n.sizes.Measures.Measure075:n.sizes.Measures.Measure050),l={marginTop:c,marginRight:c},u=Object.assign(Object.assign({},s),n.buttons.Button01Primary),d=Object.assign(Object.assign({},s),n.buttons.Button01Secondary),p=n.buttons.ButtonPrimaryText,g=n.buttons.ButtonSecondaryText,h=Object.assign(Object.assign({},l),n.buttons.ActionIconButton01);return{reconnectNotificationRootFlyoutStyle:{backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",positionType:"absolute"},reconnectNotificationViewStyle:r,reconnectNotificationHeaderStyle:a,reconnectNotificationBodyStyle:i,reconnectNotificationBodyWarningStyle:Object.assign(Object.assign({},i),{color:n.colors.BaseColor.Red.Red3}),reconnectNotificationButtonTextStyle:{marginTop:"auto",marginBottom:"5px",marginRight:"5px",alignSelf:"flex-end",color:"white"},reconnectNotificationButtonContainerStyle:o,reconnectNotificationReconnectButtonStyle:u,reconnectNotificationCancelButtonStyle:d,reconnectNotificationCloseButtonStyle:h,reconnectNotificationFormHeaderStyle:{display:"flex",justifyContent:"space-between"},reconnectNotificationReconnectButtonTextStyle:p,reconnectNotificationCancelButtonTextStyle:g}}var v=n("6fj+"),S=n("83Lp"),O=n("JhlA"),C=n("YxC/"),E=n("4leG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const I="The attempt to reconnect failed. Please try again.",w="The connection was successfully restored.",j=function(){let e=null;return function(t){const n=Object(v.a)(t),r=Object(v.b)(t),a=Object(v.e)(t);return e&&e.isReconnectNotificationShown===n&&e.isReconnectSuccessful===r&&e.showReconnectNotificationAfterUpsync===a||(e={styles:y(t),isReconnectNotificationShown:n,showReconnectNotificationAfterUpsync:a,reconnectNotificationHeaderText:Object(C.b)(t,O.h)||"The network connection has been restored.",reconnectNotificationBodyText:Object(C.b)(t,O.g)||"Would you like to reconnect?",reconnectNotificationReconnectFailBodyText:Object(C.b)(t,O.d)||I,reconnectNotificationReconnectButtonText:Object(C.b)(t,O.c)||"Try Again",reconnectNotificationCancelButtonText:Object(C.b)(t,O.a)||"Cancel",reconnectUIBlockerNotificationHeaderText:Object(C.b)(t,O.k)||"Server unreachable.",reconnectUIBlockerNotificationBodyText:Object(C.b)(t,O.j)||"We are having trouble connecting to the server. This may be due to a temporary issue with the server or internet connectivity. Ensure you have internet connectivity and try again. If the problem persists, please contact your administrator.",reconnectNotificationProgressIndicatorText:Object(C.b)(t,O.e)||"Reconnecting...",reconnectNotificationSuccessNotificationText:Object(C.b)(t,O.f)||w,type:Object(v.d)(t),isReconnectSuccessful:r,isPreviewModeEnabled:Object(E.d)(t)}),e}}();const P=Object(r.a)(j,(function(e){return{close(){e(Object(S.e)())},dispatchReconnect(t,n){e(Object(S.g)(t,n,null))}}}),(function(e,t){return Object.assign({reconnect:()=>{t.dispatchReconnect(e.reconnectNotificationProgressIndicatorText,e.reconnectNotificationSuccessNotificationText)},close:t.close},e)}))(m)},"1VTM":function(e,t,n){"use strict";n.r(t);var r=/[A-Z]/g,a=/^ms-/,i={};function o(e){return"-"+e.toLowerCase()}t.default=function(e){if(i.hasOwnProperty(e))return i[e];var t=e.replace(r,o);return i[e]=a.test(t)?"-"+t:t}},"1Xob":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.InvalidSubscription=-2147220969]="InvalidSubscription",e[e.InvalidMetadata=-2147015408]="InvalidMetadata",e[e.AuthenticationError=-2147093995]="AuthenticationError",e[e.InvalidSubscriptionInLoop=-2147015405]="InvalidSubscriptionInLoop",e[e.SyncHandlerNotAvailable=-6]="SyncHandlerNotAvailable"}(r||(r={}))},"1fn7":function(e,t,n){"use strict";n.d(t,"d",(function(){return R})),n.d(t,"n",(function(){return x})),n.d(t,"o",(function(){return M})),n.d(t,"p",(function(){return b})),n.d(t,"t",(function(){return F})),n.d(t,"u",(function(){return k})),n.d(t,"q",(function(){return _})),n.d(t,"j",(function(){return y})),n.d(t,"a",(function(){return v})),n.d(t,"i",(function(){return S})),n.d(t,"s",(function(){return O})),n.d(t,"h",(function(){return C})),n.d(t,"m",(function(){return E})),n.d(t,"k",(function(){return I})),n.d(t,"l",(function(){return w})),n.d(t,"r",(function(){return j})),n.d(t,"e",(function(){return P})),n.d(t,"g",(function(){return T})),n.d(t,"f",(function(){return N})),n.d(t,"c",(function(){return A})),n.d(t,"b",(function(){return D}));var r=n("09gH"),a=n("EDOo"),i=n("sptG"),o=n("qMYv"),s=n("+7Rg"),c=n("CpcI"),l=n("xy1J"),u=n("X3qb"),d=n("p0fx"),p=n("oSQy"),g=n("bJSG"),h=n("FdXt"),f=n("8Jtx"),m=n("LTq1");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const b="L_Create_And_Close_Button_Text",_="SavingInformation",y="ReadOnly",v="Dialog_Label_Active",S="Form_PopOut",O="UnSavedChangesWarning",C="Local_Save_Record_Notification_Status_Message",E="RecordSetNavigator.Button.Open.Tooltip",I="RecordSetNavigator.Button.Close.Tooltip",w="RecordSetNavigator.button.name",j="SharePoint.Form.Saving",P="PageLoadingMessage",T="QuickEditForm_MaxNumberReached_Title",N="Error_Message_0x80071156",A="Button_Label_Save",D="ConfirmSave_DiscardButton",R="DisableWebResouceControlsMessage",x="UCI_Form_SaveAndNew",M="UCI_Form_SaveAndOpen",F=[b,"L_Lookup_New_Text",_,y,v,"Dialog_Label_Inactive",S,O,C,"CRM_System_View_Group_Name","CRM_User_View_Group_Name","ProcessControl.Configurator.Collapse","ProcessControl.Configurator.Expand",E,I,w,j,A,D,R].concat(r.o,a.c,s.c,c.g,l.m,o.e,i.f,u.f,d.a,p.h,g.c,m.e),k=F.concat(h.h,f.b,[T,N,P])},"1kth":function(e,t,n){"use strict";n.d(t,"u",(function(){return u})),n.d(t,"U",(function(){return d})),n.d(t,"V",(function(){return p})),n.d(t,"S",(function(){return g})),n.d(t,"Q",(function(){return h})),n.d(t,"P",(function(){return f})),n.d(t,"R",(function(){return m})),n.d(t,"W",(function(){return b})),n.d(t,"X",(function(){return _})),n.d(t,"T",(function(){return y})),n.d(t,"d",(function(){return v})),n.d(t,"c",(function(){return S})),n.d(t,"f",(function(){return O})),n.d(t,"o",(function(){return C})),n.d(t,"a",(function(){return E})),n.d(t,"e",(function(){return I})),n.d(t,"b",(function(){return w})),n.d(t,"t",(function(){return j})),n.d(t,"k",(function(){return P})),n.d(t,"s",(function(){return T})),n.d(t,"q",(function(){return N})),n.d(t,"i",(function(){return A})),n.d(t,"j",(function(){return D})),n.d(t,"r",(function(){return R})),n.d(t,"n",(function(){return x})),n.d(t,"p",(function(){return M})),n.d(t,"h",(function(){return F})),n.d(t,"m",(function(){return k})),n.d(t,"g",(function(){return L})),n.d(t,"l",(function(){return B})),n.d(t,"v",(function(){return U})),n.d(t,"y",(function(){return V})),n.d(t,"x",(function(){return z})),n.d(t,"A",(function(){return W})),n.d(t,"J",(function(){return q})),n.d(t,"z",(function(){return H})),n.d(t,"w",(function(){return G})),n.d(t,"O",(function(){return K})),n.d(t,"N",(function(){return Q})),n.d(t,"L",(function(){return X})),n.d(t,"M",(function(){return Y})),n.d(t,"F",(function(){return J})),n.d(t,"E",(function(){return $})),n.d(t,"D",(function(){return Z})),n.d(t,"I",(function(){return ee})),n.d(t,"C",(function(){return te})),n.d(t,"K",(function(){return ne})),n.d(t,"H",(function(){return re})),n.d(t,"B",(function(){return ae})),n.d(t,"G",(function(){return ie}));var r=n("0nOn"),a=n("IaGr"),i=n("qshH"),o=n("MIBb"),s=n("1kth");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c="ClientApi.CustomEventManagerWrapper.";let l;function u(e,t,n,r,a){return Object(o.a)(e,t,n,r,a)?n.ScriptManager.getContainer(r).getEventManager():null}function d(e,t,n,r){return{type:"eventManager.runOnResultOpened",sync:!0,execute({dispatch:o,getState:s},l){const d=c+"runOnResultOpened";try{const a=u(d,s(),l,t,r);a&&o(a.runOnResultOpened(e,n,r,s()))}catch(t){const r=i.a.getInstance().getEventParameters(e);throw r.push({name:"fieldName",value:n}),a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,r),t}}}}function p(e,t,n,r){return{type:"eventManager.runOnSelection",sync:!0,execute({dispatch:o,getState:s},l){const d=c+"runOnSelection";try{const a=u(d,s(),l,t,r);a&&o(a.runOnSelection(e,n,r,s()))}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function g(e,t,n,r){return{type:"eventManager.runPostSearch",sync:!0,execute({dispatch:o,getState:s},l){const d=c+"runOnPostSearch";try{const a=u(d,s(),l,t,r);a&&o(a.runOnPostSearch(e,n,r,s()))}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function h(e,t,n,r){return{type:"eventManager.runOnDataLoad",sync:!0,execute({dispatch:o,getState:s},l){const d=c+"runOnDataLoad";try{const a=u(d,s(),l,t);a&&o(a.runOnDataLoad(e,n,r))}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function f(e,t,n){return{type:"eventManager.runOnChange",sync:!0,execute({dispatch:r,getState:o},s){const l=c+"runOnChange";try{const a=u(l,o(),s,t);a&&r(a.runOnChange(e,n))}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(l,t,null,n),t}}}}function m(e,t,n,r){return{type:"eventManager.runOnKeyPress",sync:!0,execute({dispatch:o,getState:s},l){const d=c+"runOnKeyPress";try{const a=u(d,s(),l,t);a&&o(a.runOnKeyPress(e,n,r))}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function b(e,t,n,r){return{type:"eventManager.runPreSearch",sync:!0,execute({dispatch:o,getState:s},l){const d=c+"runPreSearch";try{const a=u(d,s(),l,t);return!!a&&o(a.runPreSearch(e,n,r))}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function _(e,t,n,a){return{type:"eventManager.runSetAdditionalParams",sync:!0,execute:(i,o)=>function(e,t){l||(l=new r.a(e,c,t));return l}(i,t).execute("runSetAdditionalParams",(r,s)=>{const c=u(r,i.getState(),o,t,s);return!!c&&i.dispatch(c.runSetAdditionalParams(e,n,a))},[{name:"contextToken",value:JSON.stringify(e),isEventParam:!0},{name:"controlName",value:n,isEventParam:!0}],!1)}}function y(e,t,n,r){return{type:"eventManager.runOnRecordSelect",sync:!0,execute({dispatch:o,getState:s},l){const d=c+"runOnRecordSelect";try{const a=u(d,s(),l,t);return!!a&&o(a.runOnRecordSelect(e,r,n))}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function v(e,t,n,r){return{type:"eventManager.addOnGridDataLoad",sync:!0,execute({dispatch:o,getState:s},l){const d=c+"addOnGridDataLoadEvent";try{const a=u(d,s(),l,t);a&&a.addOnGridDataLoad(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function S(e,t,n){return{type:"eventManager.addOnDataLoad",sync:!0,execute({dispatch:r,getState:o},s){const l=c+"addOnDataLoadEvent";try{const r=u(l,o(),s,t);r&&r.addOnDataLoad(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(l,t,null,n),t}}}}function O(e,t,n,r){return{type:"eventManager.addOnLoad",sync:!0,execute({dispatch:o,getState:s},l){const d=c+"addOnLoadEvent";try{const a=u(d,s(),l,t);a&&a.addOnLoadEvent(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function C(e,t,n){return{type:"eventManager.addOnSave",sync:!0,execute({dispatch:r,getState:o},s){const l=c+"addOnSaveEvent";try{const r=u(l,o(),s,t);r&&r.addOnSaveEvent(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(l,t,null,n),t}}}}function E(e,t,n,r,o){return{type:"eventManager.addOnChange",sync:!0,execute:({dispatch:s,getState:l},d)=>{const p=c+"addOnChangeEvent";try{const a=u(p,l(),d,t);a&&a.addOnChangeEvent(l(),e,n,r,o)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(p,t,null,n),t}}}}function I(e,t,n,r){return{type:"eventManager.addOnKeyPress",sync:!0,execute:({dispatch:o,getState:s},l)=>{const d=c+"addOnKeyPressEvent";try{const a=u(d,s(),l,t);a&&a.addOnKeyPressEvent(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function w(e,t,n,r){return{type:"eventManager.addOnClick",sync:!0,execute:({dispatch:o,getState:s},l)=>{const d=c+"addOnClickEvent";try{const a=u(d,s(),l,t);a&&a.addOnClickEvent(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function j(e,t,n,r){return{type:"eventManager.addPreSearch",sync:!0,execute:({dispatch:o,getState:s},l)=>{const d=c+"addPreSearchEvent";try{const a=u(d,s(),l,t);a&&a.addPreSearchEvent(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function P(e,t,n){return{type:"eventManager.addOnProcessStatusChange",sync:!0,execute:({dispatch:r,getState:o},l)=>{const u=c+"addOnProcessStatusChange";try{const r=s.u(u,o(),l,t);r&&r.addOnProcessStatusChangeEvent(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function T(e,t,n,r){return{type:"eventManager.addOnTabStateChange",sync:!0,execute:({dispatch:o,getState:s},l)=>{const d=c+"addOnTabStateChange";try{const a=u(d,s(),l,t);a&&a.addOnTabStateChangeEvent(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function N(e,t,n){return{type:"eventManager.addOnStageChange",sync:!0,execute:({dispatch:r,getState:o},l)=>{const u=c+"addOnStageChange";try{const r=s.u(u,o(),l,t);r&&r.addOnStageChangeEvent(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function A(e,t,n){return{type:"eventManager.addOnPreProcessStatusChange",sync:!0,execute:({dispatch:r,getState:o},s)=>{const l=c+"addOnPreProcessStatusChange";try{const r=u(l,o(),s,t);r&&r.addOnPreProcessStatusChangeEvent(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(l,t,null,n),t}}}}function D(e,t,n){return{type:"eventManager.addOnPreStageChange",sync:!0,execute:({dispatch:r,getState:o},s)=>{const l=c+"addOnPreStageChange";try{const r=u(l,o(),s,t);r&&r.addOnPreStageChangeEvent(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(l,t,null,n),t}}}}function R(e,t,n){return{type:"eventManager.addOnStageSelected",sync:!0,execute:({dispatch:r,getState:o},l)=>{const u=c+"addOnStageSelected";try{const r=s.u(u,o(),l,t);r&&r.addOnStageSelectedEvent(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function x(e,t,n,r){return{type:"eventManager.addOnResultOpened",sync:!0,execute({dispatch:o,getState:s},l){const d=c+"addOnResultOpened";try{const a=u(d,s(),l,t);a&&a.addOnResultOpened(e,r,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function M(e,t,n,r){return{type:"eventManager.addOnSelection",sync:!0,execute({dispatch:o,getState:s},l){const d=c+"addOnSelection";try{const a=u(d,s(),l,t);a&&a.addOnSelection(e,r,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function F(e,t,n,r){return{type:"eventManager.addPostSearch",sync:!0,execute({dispatch:o,getState:s},l){const d=c+"addOnPostSearch";try{const a=u(d,s(),l,t);a&&a.addOnPostSearch(e,r,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function k(e,t,n,r){return{type:"eventManager.addOnRecordSelect",sync:!0,execute({dispatch:o,getState:s},l){const d=c+"addOnRecordSelect";try{const a=u(d,s(),l,t);a&&a.addOnRecordSelect(s(),e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function L(e,t,n,r){return{type:"eventManager.addOnLookupTagClick",sync:!0,execute({dispatch:o,getState:s},l){const d=c+"addOnLookupTagClick";try{const a=u(d,s(),l,t);a&&a.addOnLookupTagClick(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function B(e,t,n,r){return{type:"eventManager.addOnReadyStateComplete",sync:!0,execute({dispatch:o,getState:s},l){const d=c+"addOnReadyStateComplete";try{const a=u(d,s(),l,t);a&&a.addOnReadyStateComplete(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function U(e,t,n,r){return{type:"eventManager.removeOnChange",sync:!0,execute:({dispatch:o,getState:s},l)=>{const d=c+"removeOnChangeEvent";try{const a=u(d,s(),l,t);a&&a.removeOnChangeEvent(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function V(e,t,n,r){return{type:"eventManager.removeOnGridDataLoad",sync:!0,execute:({dispatch:o,getState:s},l)=>{const d=c+"removeOnGridDataLoadEvent";try{const a=u(d,s(),l,t);a&&a.removeOnGridDataLoad(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function z(e,t,n){return{type:"eventManager.removeOnDataLoad",sync:!0,execute:({dispatch:r,getState:o},s)=>{const l=c+"removeOnDataLoadEvent";try{const r=u(l,o(),s,t);r&&r.removeOnDataLoad(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(l,t,null,n),t}}}}function W(e,t,n){return{type:"eventManager.removeOnLoad",sync:!0,execute:({dispatch:r,getState:o},s)=>{const l=c+"removeOnLoadEvent";try{const r=u(l,o(),s,t);r&&r.removeOnLoadEvent(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(l,t,null,n),t}}}}function q(e,t,n){return{type:"eventManager.removeOnSave",sync:!0,execute:({dispatch:r,getState:o},s)=>{const l=c+"removeOnSaveEvent";try{const r=u(l,o(),s,t);r&&r.removeOnSaveEvent(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(l,t,null,n),t}}}}function H(e,t,n,r){return{type:"eventManager.removeOnKeyPress",sync:!0,execute:({dispatch:o,getState:s},l)=>{const d=c+"removeOnKeyPressEvent";try{const a=u(d,s(),l,t);a&&a.removeOnKeyPressEvent(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function G(e,t,n,r){return{type:"eventManager.removeOnClick",sync:!0,execute:({dispatch:o,getState:s},l)=>{const d=c+"removeOnClickEvent";try{const a=u(d,s(),l,t);a&&a.removeOnClickEvent(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function K(e,t,n,r){return{type:"eventManager.removePreSearch",sync:!0,execute:({dispatch:o,getState:s},l)=>{const d=c+"removePreSearchEvent";try{const a=u(d,s(),l,t);a&&a.removePreSearchEvent(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function Q(e,t,n,r){return{type:"eventManager.removeOnTabStateChange",sync:!0,execute:({dispatch:o,getState:s},l)=>{const d=c+"removeOnTabStateChangeEvent";try{const a=u(d,s(),l,t);a&&a.removeOnTabStateChange(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function X(e,t,n){return{type:"eventManager.removeOnStageChange",sync:!0,execute:({dispatch:r,getState:o},l)=>{const u=c+"removeOnStageChange";try{const r=s.u(u,o(),l,t);r&&r.removeOnStageChange(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function Y(e,t,n){return{type:"eventManager.removeOnStageSelected",sync:!0,execute:({dispatch:r,getState:o},l)=>{const u=c+"removeOnStageSelected";try{const r=s.u(u,o(),l,t);r&&r.removeOnStageSelected(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function J(e,t,n){return{type:"eventManager.removeOnProcessStatusChange",sync:!0,execute:({dispatch:r,getState:o},l)=>{const u=c+"removeOnProcessStatusChange";try{const r=s.u(u,o(),l,t);r&&r.removeOnProcessStatusChange(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function $(e,t,n){return{type:"eventManager.removeOnPreStageChange",sync:!0,execute:({dispatch:r,getState:o},s)=>{const l=c+"removeOnPreStageChange";try{const r=u(l,o(),s,t);r&&r.removeOnPreStageChange(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(l,t,null,n),t}}}}function Z(e,t,n){return{type:"eventManager.removeOnPreProcessStatusChange",sync:!0,execute:({dispatch:r,getState:o},s)=>{const l=c+"removeOnPreProcessStatusChange";try{const r=u(l,o(),s,t);r&&r.removeOnPreProcessStatusChange(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(l,t,null,n),t}}}}function ee(e,t,n,r){return{type:"eventManager.removeOnResultOpened",sync:!0,execute({dispatch:o,getState:s},l){const d=c+"removeOnResultOpened";try{const a=u(d,s(),l,t);a&&a.removeOnResultOpened(e,r,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function te(e,t,n,r){return{type:"eventManager.removePostSearch",sync:!0,execute({dispatch:o,getState:s},l){const d=c+"removeOnPostSearch";try{const a=u(d,s(),l,t);a&&a.removeOnPostSearch(e,r,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function ne(e,t,n,r){return{type:"eventManager.removeOnSelection",sync:!0,execute({dispatch:o,getState:s},l){const d=c+"removeOnSelection";try{const a=u(d,s(),l,t);a&&a.removeOnSelection(e,r,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function re(e,t,n,r){return{type:"eventManager.removeOnRecordSelect",sync:!0,execute({dispatch:o,getState:s},l){const d=c+"removeOnRecordSelect";try{const a=u(d,s(),l,t);a&&a.removeOnRecordSelect(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function ae(e,t,n,r){return{type:"eventManager.removeOnLookupTagClick",sync:!0,execute({dispatch:o,getState:s},l){const d=c+"removeOnLookupTagClick";try{const a=u(d,s(),l,t);a&&a.removeOnLookupTagClick(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}function ie(e,t,n,r){return{type:"eventManager.removeOnReadyStateComplete",sync:!0,execute({dispatch:o,getState:s},l){const d=c+"removeOnReadyStateComplete";try{const a=u(d,s(),l,t);a&&a.removeOnReadyStateComplete(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(d,t,null,n),t}}}}},"1nJ/":function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var r=n("umme"),a=n("84PK"),i=n("504W"),o=n("VA/h"),s=n("TRNQ"),c=n("FZk4"),l=n("3fL6"),u=n("3ri3"),d=n("jqlv");class p{constructor(e,t){this._CommandType=0,this._AssociatedMainLog=null,this._AssociatedEntityLog=null,this._SQLOperation=0,this._EntityRecord=null,this._AssociatedActivityParties=null,this._set_commandType(0),this.set_sqlOperation(e),this.set_entityRecord(t),this.set_associatedActivityParties([])}get_commandType(){return this._CommandType}_set_commandType(e){return this._CommandType=e,e}get_associatedMainLog(){return this._AssociatedMainLog}set_associatedMainLog(e){return this._AssociatedMainLog=e,e}get_associatedEntityLog(){return this._AssociatedEntityLog}set_associatedEntityLog(e){return this._AssociatedEntityLog=e,e}get_sqlOperation(){return this._SQLOperation}set_sqlOperation(e){return this._SQLOperation=e,e}get_entityRecord(){return this._EntityRecord}set_entityRecord(e){return this._EntityRecord=e,e}get_associatedActivityParties(){return this._AssociatedActivityParties}set_associatedActivityParties(e){return this._AssociatedActivityParties=e,e}}var g=n("DijY");class h{constructor(e,t,n,r,a){this._CommandType=0,this._AssociatedMainLog=null,this._CommandId=null,this._Command=null,this._EntitiesInCommand=null,this._AssociatedCommandMainLogs=null,this._AssociatedCommandEntityLogs=null,this._set_commandType(t.get_name().toLowerCase()===u.c.toLowerCase()?g.a.changeProcessAndStage:g.a.nonCrud),this.set_commandId(e),this.set_command(t),this.set_entitiesInCommand(n),this.set_associatedCommandMainLogs(r),this.set_associatedCommandEntityLogs(a)}get_commandType(){return this._CommandType}_set_commandType(e){return this._CommandType=e,e}get_associatedMainLog(){return this._AssociatedMainLog}set_associatedMainLog(e){return this._AssociatedMainLog=e,e}set_associatedEntityLog(e){}get_commandId(){return this._CommandId}set_commandId(e){return this._CommandId=e,e}get_command(){return this._Command}set_command(e){return this._Command=e,e}get_entitiesInCommand(){return this._EntitiesInCommand}set_entitiesInCommand(e){return this._EntitiesInCommand=e,e}get_associatedCommandMainLogs(){return this._AssociatedCommandMainLogs}set_associatedCommandMainLogs(e){return this._AssociatedCommandMainLogs=e,e}get_associatedCommandEntityLogs(){return this._AssociatedCommandEntityLogs}set_associatedCommandEntityLogs(e){return this._AssociatedCommandEntityLogs=e,e}}class f{constructor(e,t){this._CommandType=0,this._AssociatedMainLog=null,this._set_commandType(g.a.transaction)}get_commandType(){return this._CommandType}_set_commandType(e){return this._CommandType=e,e}get_associatedMainLog(){return this._AssociatedMainLog}set_associatedMainLog(e){return this._AssociatedMainLog=e,e}set_associatedEntityLog(e){}}var m=n("HYaY"),b=n("WRF3"),_=n("sdkC"),y=n("jZCH"),v=n("EW4s");class S{constructor(e,t,n){this._dalWrapper=null,this._BatchLogs=null,this._EntityLogMap=null,this._AssociatedNonCrudMainLogs=null,this._AssociatedNonCrudEntityLogs=null,this._EntitiesInNonCrud=null,this._set_BatchLogs(t),this._set_EntityLogMap(n),this._dalWrapper=new s.a}_get_BatchLogs(){return this._BatchLogs}_set_BatchLogs(e){return this._BatchLogs=e,e}_get_EntityLogMap(){return this._EntityLogMap}_set_EntityLogMap(e){return this._EntityLogMap=e,e}_get_AssociatedNonCrudMainLogs(){return this._AssociatedNonCrudMainLogs}_set_AssociatedNonCrudMainLogs(e){return this._AssociatedNonCrudMainLogs=e,e}_get_AssociatedNonCrudEntityLogs(){return this._AssociatedNonCrudEntityLogs}_set_AssociatedNonCrudEntityLogs(e){return this._AssociatedNonCrudEntityLogs=e,e}_get_EntitiesInNonCrud(){return this._EntitiesInNonCrud}_set_EntitiesInNonCrud(e){return this._EntitiesInNonCrud=e,e}createCommandData(e){const t=new v.a;if(e>=this._get_BatchLogs().length)t.reject(r.a.FromMessage("Invalid index specified for batch logs"));else{const n=[],r=this._get_BatchLogs()[e];r.get_logTableID().toLowerCase()!==u.y.toLowerCase()?r.get_logTableID().toLowerCase()===u.G.toLowerCase()||r.get_logTableID().toLowerCase()===u.H.toLowerCase()?n.push(this._GetTransactionCommandData(e)):n.push(this._GetCrudCommandData(e)):n.push(this._GetNonCrudCommandData(e)),Object(o.a)(n).then(e=>{const n=Object(i.a)(e[0])?null:e[0];Object(i.a)(n)?t.resolve(null):(n.set_associatedMainLog(r),n.set_associatedEntityLog(d.f(r,this._get_EntityLogMap())),t.resolve(n))},e=>{t.reject(e)})}return t}_GetTransactionCommandData(e){const t=new v.a,n=this._get_BatchLogs()[e],r=n.get_operationType(),i=new b.a(d.c(n),a.a.newGuid()),o=new m.a(i,{},{},{},{},new _.a(new Array(0)));return t.resolve(new f(r,o)),t}_GetCrudCommandData(e){const t=new v.a,n=this._get_BatchLogs()[e],r=n.get_operationType();if(k.get_skipTables().indexOf(n.get_logTableID())>=0)t.resolve(new p(r,null));else{const e=d.f(n,this._get_EntityLogMap()),a=d.g(n,this._get_EntityLogMap()),i=d.c(n);this._dalWrapper.convertSQLiteResultsToEntityRecord(e,a,i,r).then(e=>{t.resolve(new p(r,e))},e=>{t.reject(e)})}return t}_GetNonCrudCommandData(e){const t=new v.a,n=this._get_BatchLogs()[e];this._set_EntitiesInNonCrud({}),this._set_AssociatedNonCrudMainLogs([]),this._set_AssociatedNonCrudEntityLogs({});const r=d.f(n,this._get_EntityLogMap()),i=a.a.tryCreate(r[u.g].toString()),o=d.b(r);return this._ProcessEntitiesInNonCrudCommand(e,o).then(()=>{t.resolve(new h(i,o,this._get_EntitiesInNonCrud(),this._get_AssociatedNonCrudMainLogs(),this._get_AssociatedNonCrudEntityLogs()))},e=>{t.reject(e)}),t}_GetCommandOperationsCount(e){let t=0;for(;e<this._get_BatchLogs().length;){if(this._get_BatchLogs()[e].get_logTableID().toLowerCase()!==u.z.toLowerCase())break;t++,e++}return t}_ProcessEntitiesInNonCrudCommand(e,t){const n=new v.a;if(t.get_name().toLowerCase()===u.c.toLowerCase())if(e+1>=this._get_BatchLogs().length)n.resolve(!0);else{const t=this._get_BatchLogs()[e+1];d.i(t)===u.x?(this._get_AssociatedNonCrudMainLogs().push(t),this._get_AssociatedNonCrudEntityLogs()[t.get_SID().toString()]=d.f(t,this._get_EntityLogMap()),n.resolve(!0)):n.resolve(!0)}else{const t=this._GetCommandOperationsCount(e+1),r=[];for(let n=1;n<=2*t;n++)r.push(this._PopulateEntitiesInNonCrud(e+n));Object(o.a)(r).then(()=>{d.j("OfflineUpSync.PlaybackManager.ProcessEntitiesInNonCrud.Success","Processing of Entities in NonCrud Succeeded"),n.resolve(!0)},e=>{d.k("OfflineUpSync.PlaybackManager.ProcessEntitiesInNonCrud.Fail",e.get_Message()),n.reject(e)})}return n}_PopulateEntitiesInNonCrud(e){const t=new v.a;if(d.j("OfflineUpSync.PlaybackManager._PopulateEntitiesInNonCrud.Start","Population of Entities in NonCrud Started"),e>=this._get_BatchLogs().length)d.j("OfflineUpSync.PlaybackManager._PopulateEntitiesInNonCrud.Success","Population of Entities in NonCrud Succeeded"),t.resolve(!1);else{const n=this._get_BatchLogs()[e],r=n.get_logTableID(),a=d.c(n);new Array(0).push(new c.a(u.B,n.get_SID(),l.a.Or,0));const o=d.f(n,this._get_EntityLogMap());this._get_AssociatedNonCrudMainLogs().push(n),this._get_AssociatedNonCrudEntityLogs()[n.get_SID().toString()]=o,k.get_skipTables().indexOf(r)>=0?(d.j("OfflineUpSync.PlaybackManager._PopulateEntitiesInNonCrud.Success","Population of Entities in NonCrud is skipped"),t.resolve(!0)):y.a.get_DefaultInstance().retrieveEntityMetadata(a,null).then(e=>{!Object(i.a)(e)&&e.get_primaryIdAttribute()in o?(d.j("OfflineUpSync.PlaybackManager._PopulateEntitiesInNonCrud.Success","Population of Entities in NonCrud Succeeded"),this._get_EntitiesInNonCrud()[o[e.get_primaryIdAttribute()].toString()]=a,t.resolve(!0)):t.resolve(!0)},e=>{d.k("OfflineUpSync.PlaybackManager._PopulateEntitiesInNonCrud.Fail",e.get_Message()),t.reject(e)})}return t}}var O,C=n("vONk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.failure=0]="failure",e[e.success=1]="success"}(O||(O={}));var E=n("2LZB"),I=n("JUjK"),w=n("pHbk");class j{constructor(e,t,n){this._ErrorCount=0,this._LastSuccessfulSaveOnCrm=null,this._ErrorCount=t,this._LastSuccessfulSaveOnCrm=n}get_errorCount(){return this._ErrorCount}get_lastSuccessfulSaveOnCrm(){return this._LastSuccessfulSaveOnCrm}}var P=n("qCX6"),T=n("Nnen"),N=n("Eua/"),A=n("Q7Xa"),D=n("VJBm");class R extends D.a{constructor(e){super(e),this.set_dataAccessLayer(e)}create(e,t){this.get_dataAccessLayer().create(e,t)}retrieve(e,t){return this.get_dataAccessLayer().retrieve(e,t)}update(e,t){this.get_dataAccessLayer().update(e,t)}Delete(e,t){this.get_dataAccessLayer().Delete(e,t)}begin(e){this.get_dataAccessLayer().begin(e)}Commit(e){return this.get_dataAccessLayer().Commit(e)}}var x=n("thzq");class M{constructor(){this._dalBase=null,this._norSyncDAL=null,this._commandDAL=null,this._wrapper=null,this._dalBase=new N.a,this._norSyncDAL=new R(this._dalBase),this._commandDAL=new T.a(this._dalBase),this._wrapper=new s.a}getNorSyncMainLogs(e){const t=new v.a;return this._norSyncDAL.retrieve(u.D,e).then(e=>{t.resolve(d.a(e))},e=>{t.reject(e)}),t}getNorSyncEntityLogs(e,t){const n=new v.a,r=d.e(t);return this._norSyncDAL.retrieve(r,e).then(e=>{n.resolve(e)},e=>{n.reject(e)}),n}performOperations(e,t,n){const r=new v.a;return this._wrapper.performOperations(e,t,n).then(()=>{d.j("OfflineUpSync.PlaybackManager.UpdateRowVersion.Success","Updation of Row Version Succeeded"),r.resolve(!0)},e=>{d.k("OfflineUpSync.PlaybackManager.UpdateRowVersion.Fail",e.get_Message()),r.reject(e)}),r}clearNorSyncLogs(e,t,n){const r=new v.a;if(e.length){const i=new Array(0);i.push(new c.a(u.M,e,l.a.Or,I.a.In));const o=new E.a(i),s=new Array(0);s.push(new c.a(u.B,e,l.a.Or,I.a.In));const d=new E.a(s);this._norSyncDAL.begin(!0);for(const e of t)this._deleteNorSyncEntityLog(e,d);this._deleteNorSyncMainLogs(o),n.equals(a.a.get_empty())||this._DeleteCommand(n),this._norSyncDAL.Commit(this._dalBase.get_transaction()).then(()=>{r.resolve(!0)},e=>{r.reject(e)})}else r.resolve(!0);return r}updateCommandStatus(e,t){if(Object(i.a)(e))return null;const n=e.toDictionary();return n[u.n]=t,new A.a(n,x.a.Update,u.o)}_DeleteCommand(e){const t=new Array(0);t.push(new c.a(u.g,e.toString(),l.a.Or,0));const n=new E.a(t);new Array(0).push(new c.a(u.i,e.toString(),l.a.Or,0));const r=new E.a(t);this._commandDAL.Delete(u.o,n),this._commandDAL.Delete(u.m,r)}_deleteNorSyncMainLogs(e){this._norSyncDAL.Delete(u.D,e)}_deleteNorSyncEntityLog(e,t){this._norSyncDAL.Delete(e,t)}}var F=n("03Hu");class k{constructor(){this._lastSID=0,this._commandOperationsLength=0,this._hasInCompleteNonCrudCommand=!1,this._hasInCompleteTransaction=!1,this._NorSyncLogHelper=null,this._PlaybackBatchManager=null,this._BatchLogs=null,this._EntityList=null,this._norSyncMainLogs=null,this._EntityLogMap=null,this._set_NorSyncLogHelper(new M)}_get_NorSyncLogHelper(){return this._NorSyncLogHelper}_set_NorSyncLogHelper(e){return this._NorSyncLogHelper=e,e}_get_PlaybackBatchManager(){return this._PlaybackBatchManager}_set_PlaybackBatchManager(e){return this._PlaybackBatchManager=e,e}_get_BatchLogs(){return this._BatchLogs}_set_BatchLogs(e){return this._BatchLogs=e,e}_get_EntityList(){return this._EntityList}_set_EntityList(e){return this._EntityList=e,e}_get_EntityLogMap(){return this._EntityLogMap}_set_EntityLogMap(e){return this._EntityLogMap=e,e}get_maxBatchSize(){return 10}get_norSyncMainLogs(){return this._norSyncMainLogs}startPlayback(){const e=new v.a;return C.a.set_OverallSyncErrorMessage(null),k.set_syncErrorsCount(0),this._lastSID=0,w.a.get_instance().isOfflineDatabaseAvailable()?(Object(d.j)("OfflineUpSync.PlaybackManager.StartPlayback","Started Upsync"),this._InitializeSyncErrorRetryStatus().then(()=>{this._ProcessPlayBack().then(()=>{w.a.get_instance().saveOfflineErrorState(u.cb,k.get_syncErrorRetryCountMap()),F.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentPerformance("Offline: Upsync","Total number of Sync Errors",Object.keys(k.get_syncErrorRetryCountMap()).length),w.a.get_instance().retrieveOfflineErrorState(u.u).then(t=>{Object(d.j)("OfflineUpSync.PlaybackManager.StartPlayback","Upsync successful"),t&&Object.keys(t).length>0&&k.set_lastSuccessfulSaveOnCrm(t[u.u]),P.a.get_instance().get_offlineDataSource().set_syncErrorCount(k.get_syncErrorsCount());const n=!Object(i.a)(this._get_PlaybackBatchManager())&&this._get_PlaybackBatchManager().get_hasNetworkIssueDuringUpsync()?0:O.success;e.resolve(new j(n,k.get_syncErrorsCount(),k.get_lastSuccessfulSaveOnCrm()))},t=>{e.reject(t)})},t=>{Object(d.j)("OfflineUpSync.PlaybackManager.StartPlayback","Upsync failed"),w.a.get_instance().saveOfflineErrorState(u.cb,k.get_syncErrorRetryCountMap()),w.a.get_instance().retrieveOfflineErrorState(u.u).then(n=>{n&&Object.keys(n).length>0&&k.set_lastSuccessfulSaveOnCrm(n[u.u]),e.reject(t)},n=>{e.reject(t)})})},t=>{e.reject(t)}),e):e.reject(r.a.FromMessage("Offline database is not available."))}hasItemsToUpsync(){const e=new v.a,t=new Array(0);t[0]=new c.a(u.M,this._lastSID,l.a.Or,I.a.GreaterThan);const n=new E.a(t);return this._get_NorSyncLogHelper().getNorSyncMainLogs(n).then(t=>{Object(i.a)(t)||!t.length?(Object(d.j)("OfflineUpSync.PlaybackManager.HasPlayBackQueueItems.Success","No Items found for upsync"),e.resolve(!1)):(Object(d.j)("OfflineUpSync.PlaybackManager.HasPlayBackQueueItems.Success","Found items for upsync"),e.resolve(!0))},t=>{Object(d.j)("OfflineUpSync.PlaybackManager.HasPlayBackQueueItems.Failure",t.get_Message()),e.reject(t)}),e}isLocalCopy(e,t){const n=new v.a;return y.a.get_DefaultInstance().retrieveEntityMetadata(e,null).then(r=>{if(Object(i.a)(r))n.resolve(!1);else{const a=r.get_primaryIdAttribute(),o=new Array(0);o[0]=new c.a(a,t.toString(),l.a.Or,0);const s=new E.a(o);this._get_NorSyncLogHelper().getNorSyncEntityLogs(s,e).then(e=>{!Object(i.a)(e)&&e.rows.length>0?n.resolve(!0):n.resolve(!1)},e=>{n.reject(e)})}},e=>{n.reject(e)}),n}_InitializeSyncErrorRetryStatus(){const e=new v.a;return w.a.get_instance().retrieveOfflineErrorState(u.cb).then(t=>{k.set_syncErrorRetryCountMap(Object(i.a)(t)?{}:t),e.resolve(!0)},t=>{e.reject(t)}),e}_ProcessPlayBack(){const e=new v.a;return Object(d.j)("OfflineUpSync.PlaybackManager._ProcessPlayBack","I Pass Started"),this._StartPass().then(t=>{Object(d.j)("OfflineUpSync.PlaybackManager._ProcessPlayBack.Success","I Pass Completed"),t?this._get_PlaybackBatchManager().get_hasNetworkIssueDuringUpsync()?(Object(d.j)("OfflineUpSync.PlaybackManager._ProcessPlayBack.NetworkFailure","II Pass Not Started due to Network Issue"),e.resolve(!1)):(Object(d.j)("OfflineUpSync.PlaybackManager._ProcessPlayBack","II Pass Started"),this._StartPass().then(()=>{Object(d.j)("OfflineUpSync.PlaybackManager._ProcessPlayBack.Success","II Pass Completed"),e.resolve(!0)},t=>{Object(d.j)("OfflineUpSync.PlaybackManager._ProcessPlayBack.Faliure",t.get_Message()),e.reject(t)})):(Object(d.j)("OfflineUpSync.PlaybackManager._ProcessPlayBack.Success","Completed"),e.resolve(!0))},t=>{Object(d.j)("OfflineUpSync.PlaybackManager._ProcessPlayBack.Failure",t.get_Message()),e.reject(t)}),e}_StartPass(){const e=new v.a;return Object(d.j)("OfflineUpSync.PlaybackManager._StartPass","Started"),this.hasItemsToUpsync().then(t=>{t?(this._set_PlaybackBatchManager(new C.a(this._get_NorSyncLogHelper())),this.upSync().then(()=>{this._get_PlaybackBatchManager().get_hasNetworkIssueDuringUpsync()?(Object(d.j)("OfflineUpSync.PlaybackManager._StartPass.NetworkFaliure","Faliure"),e.resolve(!0)):(Object(d.j)("OfflineUpSync.PlaybackManager._StartPass.Success","StartPass Finished"),e.resolve(!0))},t=>{Object(d.j)("OfflineUpSync.PlaybackManager._StartPass.Failure",t.get_Message()),e.reject(t)})):(Object(d.j)("OfflineUpSync.PlaybackManager._StartPass.Success","StartPass Completed"),e.resolve(!1))},t=>{Object(d.j)("OfflineUpSync.PlaybackManager._StartPass.Failure",t.get_Message()),e.reject(t)}),e}upSync(){const e=new v.a;Object(d.j)("OfflineUpSync.PlaybackManager.UpSync","UpSync Started");const t=[];return t.push(this._get_PlaybackBatchManager().processBatchForUpSync()),t.push(this._PrepareNextBatch()),Object(o.a)(t).then(()=>{this._get_PlaybackBatchManager().get_hasNetworkIssueDuringUpsync()&&(Object(d.j)("OfflineUpSync.PlaybackManager.UpSync.Warning","NetWork Issue Encountered while upsync"),e.resolve(!1)),this._get_PlaybackBatchManager().get_playbackQueue().length?this.upSync().then(t=>{Object(d.j)("OfflineUpSync.PlaybackManager.UpSync.Success","ManagePlayBackQueue Finished"),e.resolve(t)},t=>{Object(d.j)("OfflineUpSync.PlaybackManager.UpSync.Failure",t.get_Message()),e.reject(t)}):(Object(d.j)("OfflineUpSync.PlaybackManager.UpSync.Info","ManagePlayBackQueue PlayBack All Remaining Requests Started"),this._get_PlaybackBatchManager().processBatchForUpSync().then(()=>{e.resolve(!0)},t=>{Object(d.j)("OfflineUpSync.PlaybackManager.UpSync.Failure",t.get_Message()),e.reject(t)}))},t=>{Object(d.j)("OfflineUpSync.PlaybackManager.UpSync.Success",t.get_Message()),e.reject(t)}),e}_PrepareNextBatch(){const e=new v.a;return Object(d.j)("OfflineUpSync.PlaybackManager._PrepareNextBatch","ProcessBatch Started"),this._RetrieveBatch(!0).then(()=>{Object(i.a)(this._get_BatchLogs())||!this._get_BatchLogs().length?(Object(d.j)("OfflineUpSync.PlaybackManager._PrepareNextBatch.Success","ProcessBatch Completed"),e.resolve(!1)):this._CreateBatchData().then(t=>{!Object(i.a)(t)&&t.length>0&&(Object(d.j)("OfflineUpSync.PlaybackManager._PrepareNextBatch","Batch Added to PlayBackBatchManager"),this._get_PlaybackBatchManager().get_playbackQueue().push(t)),Object(d.j)("OfflineUpSync.PlaybackManager._PrepareNextBatch.Success","ProcessBatch Finished"),e.resolve(!0)},t=>{Object(d.j)("OfflineUpSync.PlaybackManager._PrepareNextBatch.Failure",t.get_Message()),e.reject(t)})},t=>{Object(d.j)("OfflineUpSync.PlaybackManager._PrepareNextBatch.Failure",t.get_Message()),e.reject(t)}),e}_PrepareBatchAndValidateBatchReadyforUpSync(e){let t=0,n=!e;for(;t<this.get_norSyncMainLogs().length&&(this._get_BatchLogs().length<this.get_maxBatchSize()||n);){const e=Object(d.i)(this.get_norSyncMainLogs()[t]),r=Object(d.d)(e);this._get_BatchLogs().push(this.get_norSyncMainLogs()[t]),this._get_EntityList().indexOf(r)<0&&this._get_EntityList().push(r),n?this._hasInCompleteNonCrudCommand?e.toLowerCase()===u.z.toLowerCase()?this._commandOperationsLength++:(this._commandOperationsLength--,this._commandOperationsLength<=0&&(n=!1,this._hasInCompleteNonCrudCommand=!1,this._commandOperationsLength=0)):this._hasInCompleteTransaction&&e.toLowerCase()===u.H.toLowerCase()&&(n=!1,this._hasInCompleteTransaction=!1):e.toLowerCase()===u.y.toLowerCase()?(n=!0,this._hasInCompleteNonCrudCommand=!0,this._commandOperationsLength=0):e.toLowerCase()===u.G.toLowerCase()&&(n=!0,this._hasInCompleteTransaction=!0),t++}return this._lastSID=this._get_BatchLogs()[this._get_BatchLogs().length-1].get_SID(),this._norSyncMainLogs.splice(0,t),n}_PrepareEntityLogs(){const e=new v.a;Object(d.j)("OfflineUpSync.PlaybackManager.RetrieveEntityLogs","RetrieveEntityLogs Started"),this._set_EntityLogMap({});const t=new Array(0);t.push(new c.a(u.B,this._get_BatchLogs()[0].get_SID(),0,I.a.GreaterThanEqualTo)),t.push(new c.a(u.B,this._lastSID,0,I.a.LessThanEqualTo));const n=new E.a(t),r=[];for(const e of this._get_EntityList())if(e!==Object(d.d)(u.G)&&e!==Object(d.d)(u.H))r.push(this._get_NorSyncLogHelper().getNorSyncEntityLogs(n,e));else{const e=new v.a;e.resolve(),r.push(e)}return Object(o.a)(r).then(t=>{Object(d.j)("OfflineUpSync.PlaybackManager.RetrieveEntityLogs.Success","RetrieveEntityLogs Completed");for(let e=0;e<this._get_EntityList().length;e++){const n=this._get_EntityList()[e];if(Object(i.a)(t[e]))this._get_EntityLogMap()[n]=null;else{const r=t[e],a={};for(let e=0;e<r.rows.length;e++){const t=r.rows.item(e),n=t[u.B].toString()in a?a[t[u.B].toString()]:[];n.push(t),a[t[u.B].toString()]=n}this._get_EntityLogMap()[n]=a}}e.resolve(!0)},t=>{Object(d.j)("OfflineUpSync.PlaybackManager.RetrieveEntityLogs.Failure",t.get_Message()),e.reject(t)}),e}_CreateBatchData(){const e=new v.a;Object(d.j)("OfflineUpSync.PlaybackManager._CreateBatchData","CreateBatchData Started");const t=[];let n=0,r=0,a=!1;for(;n<this._get_BatchLogs().length;){const e=Object(d.i)(this._get_BatchLogs()[n]);a?e.toLowerCase()===u.z.toLowerCase()?(r++,n++):(n+=e.toLowerCase()!==u.x.toLowerCase()||r?r:1,a=!1,r=0):(e.toLowerCase()===u.y.toLowerCase()&&(a=!0,r=0),t.push(new S(this._get_NorSyncLogHelper(),this._get_BatchLogs(),this._get_EntityLogMap()).createCommandData(n)),n++)}return Object(o.a)(t).then(t=>{Object(d.j)("OfflineUpSync.PlaybackManager._CreateBatchData.Success","CreateBatchData Completed"),e.resolve(t)},t=>{Object(d.j)("OfflineUpSync.PlaybackManager._CreateBatchData.Failure",t.get_Message()),e.reject(t)}),e}_GetBatch(e){const t=new v.a,n=new Array(0);n[0]=new c.a(u.M,this._lastSID,l.a.Or,I.a.GreaterThan);const r=new E.a(n,e);return this._get_NorSyncLogHelper().getNorSyncMainLogs(r).then(e=>{Object(d.j)("OfflineUpSync.PlaybackManager._GetBatch.Success","GetBatch Completed."),Object(i.a)(this._norSyncMainLogs)?this._norSyncMainLogs=e:this._norSyncMainLogs.push(...e),t.resolve(!0)},e=>{Object(d.k)("OfflineUpSync.PlaybackManager._GetBatch.Fail",e.get_Message()),t.reject(e)}),t}_RetrieveBatch(e){const t=new v.a;Object(d.j)("OfflineUpSync.PlaybackManager._RetrieveBatch","RetrieveBatch Started."),e&&(this._set_BatchLogs([]),this._set_EntityList([]));let n=this.get_maxBatchSize();return!Object(i.a)(this.get_norSyncMainLogs())&&this.get_norSyncMainLogs().length>0&&(n-=this.get_norSyncMainLogs().length,this._lastSID=this.get_norSyncMainLogs()[this.get_norSyncMainLogs().length-1].get_SID()),this._GetBatch(n).then(()=>{Object(i.a)(this.get_norSyncMainLogs())||!this.get_norSyncMainLogs().length?t.resolve(!0):this._PrepareBatchAndValidateBatchReadyforUpSync(e)?this._RetrieveBatch(!1).then(()=>{Object(d.j)("OfflineUpSync.PlaybackManager._RetrieveBatch.Force.Success","Force RetrieveBatch Completed."),t.resolve(!0)},e=>{Object(d.j)("OfflineUpSync.PlaybackManager._RetrieveBatch.Force.Failure",e.get_Message()),t.reject(e)}):this._PrepareEntityLogs().then(()=>{Object(d.j)("OfflineUpSync.PlaybackManager._RetrieveBatch.Success","RetrieveBatch Completed."),t.resolve(!0)},e=>{Object(d.j)("OfflineUpSync.PlaybackManager._RetrieveBatch.Failure",e.get_Message()),t.reject(e)})},e=>{t.reject(e)}),t}static get_syncErrorsCount(){return k._SyncErrorsCount}static set_syncErrorsCount(e){return k._SyncErrorsCount=e,e}static get_lastSuccessfulSaveOnCrm(){return k._LastSuccessfulSaveOnCrm}static set_lastSuccessfulSaveOnCrm(e){return k._LastSuccessfulSaveOnCrm=e,e}static get_DefaultInstance(){return Object(i.a)(k._defaultInstance)&&(k._defaultInstance=new k),k._defaultInstance}static get_syncErrorRetryCountMap(){return Object(i.a)(k._syncErrorRetryCountMap)&&(k._syncErrorRetryCountMap={}),k._syncErrorRetryCountMap}static set_syncErrorRetryCountMap(e){return k._syncErrorRetryCountMap=e,e}static get_skipTables(){return[u.z,u.x]}static IncrementSyncErrorsCount(){let e;(e=k).set_syncErrorsCount(e.get_syncErrorsCount()+1)}}k._defaultInstance=null,k._SyncErrorsCount=0,k._syncErrorRetryCountMap=null,k._LastSuccessfulSaveOnCrm=null},"1pQz":function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return j}));var r=n("eXjw"),a=n("SAYH"),i=n("fC8v"),o=n("504W"),s=n("SFgX"),c=n("Lyxw"),l=n("3/02");function u(e,t,n,c,l=r.a.Initialized){let u=s.a.defaulticon;e.LogicalName&&s.a[e.LogicalName]&&(u=s.a[e.LogicalName]);const f={Initialized:l,Id:a.a.tryParseOrNull(e.MetadataId),EntityLogicalName:e.LogicalName,EntityIcon:u,DisplayName:Object(i.b)(e.DisplayName),EntitySetName:e.EntitySetName,PrimaryKeyName:e.PrimaryIdAttribute,ObjectTypeCode:e.ObjectTypeCode,PrimaryIdAttribute:e.PrimaryIdAttribute,PrimaryNameAttribute:e.PrimaryNameAttribute,PrimaryImageAttribute:e.PrimaryImageAttribute,EntityColor:e.EntityColor,ActivityTypeMask:e.ActivityTypeMask,AutoRouteToOwnerQueue:e.AutoRouteToOwnerQueue,DisplayCollectionName:Object(i.b)(e.DisplayCollectionName),CanTriggerWorkflow:e.CanTriggerWorkflow,Description:Object(i.b)(e.Description),EntityHelpUrlEnabled:e.EntityHelpUrlEnabled,EntityHelpUrl:e.EntityHelpUrl,IsDocumentManagementEnabled:e.IsDocumentManagementEnabled,IsOneNoteIntegrationEnabled:e.IsOneNoteIntegrationEnabled,IsMSTeamsIntegrationEnabled:e.IsMSTeamsIntegrationEnabled,IsDocumentRecommendationsEnabled:e.IsDocumentRecommendationsEnabled,IsInteractionCentricEnabled:e.IsInteractionCentricEnabled,IsKnowledgeManagementEnabled:e.IsKnowledgeManagementEnabled,IsActivity:e.IsActivity,IsActivityParty:e.IsActivityParty,HasEmailAddresses:e.HasEmailAddresses,IsChildEntity:e.IsChildEntity,IsCollaboration:p(e.IsValidForQueue),IsConnectionsEnabled:p(e.IsConnectionsEnabled),IsCustomEntity:e.IsCustomEntity,IsBusinessProcessEnabled:e.IsBusinessProcessEnabled,IsCustomizable:p(e.IsCustomizable),IsOptimisticConcurrencyEnabled:e.IsOptimisticConcurrencyEnabled,IsImportable:e.IsImportable,IsIntersect:e.IsIntersect,IsMailMergeEnabled:p(e.IsMailMergeEnabled),IsEnabledForCharts:e.IsEnabledForCharts,IsValidForAdvancedFind:e.IsValidForAdvancedFind,IsVisibleInMobileClient:p(e.IsVisibleInMobileClient),IsReadOnlyInMobileClient:p(e.IsReadOnlyInMobileClient),IsOfflineInMobileClient:p(e.IsOfflineInMobileClient),IsQuickCreateEnabled:e.IsQuickCreateEnabled,EntityClientSetting:e.EntityClientSetting,OwnershipType:c?g(e.OwnershipType):e.OwnershipType,HasChanged:e.HasChanged,HasStateCode:w(e),IsStateModelAware:e.IsStateModelAware,EnforceStateTransitions:e.EnforceStateTransitions,Privileges:c?h(e.Privileges):e.Privileges||[],IconVectorName:e.IconVectorName,IsBPFEntity:e.IsBPFEntity,DataProviderId:a.a.tryParseOrNull(e.DataProviderId),IsEnabledInUnifiedInterface:!!Object(o.a)(e.IsVisibleInMobileClient)||(e.IsVisibleInMobileClient.Value||e.IsVisibleInMobileClient.CanBeChanged),VersionNumber:t||e.VersionNumber,OverallVersionNumber:n||e.OverallVersionNumber,AttributeNames:e.AttributeNames,IsAuditEnabled:e.IsAuditEnabled};return e.OneToManyRelationships&&(f.OneToManyRelationships=I(e.OneToManyRelationships,c,C),f.HasActivities=d(e.OneToManyRelationships,"activitypointer","regardingobjectid"),f.HasNotes=d(e.OneToManyRelationships,"annotation","objectid")),e.ManyToOneRelationships&&(f.ManyToOneRelationships=I(e.ManyToOneRelationships,c,C)),e.ManyToManyRelationships&&(f.ManyToManyRelationships=I(e.ManyToManyRelationships,c,E)),f}function d(e,t,n){for(const r of e)if(r.ReferencingEntity===t&&r.ReferencingAttribute===n)return!0;return!1}function p(e){return e?e.Value:null}function g(e){if("string"!=typeof e)return"number"==typeof e?e:null;switch(e){case"None":return 0;case"UserOwned":return 1;case"TeamOwned":return 2;case"BusinessOwned":return 3;case"OrganizationOwned":return 4;case"BusinessParented":return 5;default:return 0}}function h(e){if(null===e)return[];for(const t of e)if(null!==t&&"string"==typeof t.PrivilegeType)switch(t.PrivilegeType){case"None":t.PrivilegeType=0;continue;case"Create":t.PrivilegeType=1;continue;case"Read":t.PrivilegeType=2;continue;case"Write":t.PrivilegeType=3;continue;case"Delete":t.PrivilegeType=4;continue;case"Assign":t.PrivilegeType=5;continue;case"Share":t.PrivilegeType=6;continue;case"Append":t.PrivilegeType=7;continue;case"AppendTo":t.PrivilegeType=8;continue;default:t.PrivilegeType=0;continue}return e}function f(e,t,n,a,o=r.a.Initialized,s){const d=a&&Object(c.b)(a,l.Xb);let p=null,g=null;if(e){p={},g={};for(const r of e){const e=u(r,t,n,d,o);p[e.EntityLogicalName]=e;const a=Object(i.d)(r,s);g[e.EntityLogicalName]=a}}return{entities:p,attributes:g}}function m(e,t){if(Object(o.a)(e))return null;return{Behavior:t?b(e.Behavior):e.Behavior,Group:t?_(e.Group):e.Group,Label:Object(i.b)(e.Label),Order:e.Order,AvailableOffline:e.AvailableOffline,Icon:e.Icon,IsCustomizable:e.IsCustomizable,MenuId:e.MenuId,QueryApi:e.QueryApi,ViewId:a.a.tryParseOrNull(e.ViewId),ExtensionData:e.ExtensionData}}function b(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"UseCollectionName":return 0;case"UseLabel":return 1;case"DoNotDisplay":return 2;default:return 0}}function _(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"Details":return 0;case"Sales":return 1;case"Service":return 2;case"Marketing":return 3;default:return 0}}function y(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"NoCascade":return 0;case"Cascade":return 1;case"Active":return 2;case"UserOwned":return 3;case"RemoveLink":return 4;case"Restrict":return 5;default:return 0}}function v(e,t){return{IsCustomRelationship:e.IsCustomRelationship,IsCustomizable:p(e.IsCustomizable),IsValidForAdvancedFind:e.IsValidForAdvancedFind,SchemaName:e.SchemaName,SecurityTypes:t?S(e.SecurityTypes):e.SecurityTypes,IsManaged:e.IsManaged,RelationshipType:t?O(e.RelationshipType):e.RelationshipType,IntroducedVersion:e.IntroducedVersion}}function S(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"None":return 0;case"Append":return 1;case"ParentChild":return 2;case"Pointer":return 4;case"Inheritance":return 8;default:return 0}}function O(e){if("string"!=typeof e)return"number"==typeof e?e:-1;switch(e){case"OneToManyRelationship":return 0;case"ManyToManyRelationship":return 1;default:return-1}}function C(e,t){const n=m(e.AssociatedMenuConfiguration,t),r=function(e,t){return t?{Assign:y(e.Assign),Delete:y(e.Delete),Merge:y(e.Merge),Reparent:y(e.Reparent),Share:y(e.Share),Unshare:y(e.Unshare),ExtensionData:y(e.ExtensionData)}:{Assign:e.Assign,Delete:e.Delete,Merge:e.Merge,Reparent:e.Reparent,Share:e.Share,Unshare:e.Unshare,ExtensionData:e.ExtensionData}}(e.CascadeConfiguration,t);return Object.assign({AssociatedMenuConfiguration:n,CascadeConfiguration:r,ReferencedAttribute:e.ReferencedAttribute,ReferencedEntity:e.ReferencedEntity,ReferencingAttribute:e.ReferencingAttribute,ReferencingEntity:e.ReferencingEntity,IsHierarchical:e.IsHierarchical,ReferencedEntityNavigationPropertyName:e.ReferencedEntityNavigationPropertyName,ReferencingEntityNavigationPropertyName:e.ReferencingEntityNavigationPropertyName},v(e,t))}function E(e,t){return Object.assign({Entity1AssociatedMenuConfiguration:m(e.Entity1AssociatedMenuConfiguration,t),Entity2AssociatedMenuConfiguration:m(e.Entity2AssociatedMenuConfiguration,t),Entity1LogicalName:e.Entity1LogicalName,Entity2LogicalName:e.Entity2LogicalName,IntersectEntityName:e.IntersectEntityName,Entity1IntersectAttribute:e.Entity1IntersectAttribute,Entity2IntersectAttribute:e.Entity2IntersectAttribute,Entity1NavigationPropertyName:e.Entity1NavigationPropertyName,Entity2NavigationPropertyName:e.Entity2NavigationPropertyName},v(e,t))}function I(e,t,n){if(!e)return null;const r={};for(const a of e){const e=n(a,t);r[a.SchemaName]=e}return r}function w(e){if(!e||!e.AttributeNames)return!1;for(const t of e.AttributeNames)if("statecode"===t.toLowerCase())return!0;return!1}function j(e,t){return{Initialized:P(e.Initialized,t.Initialized),EntityLogicalName:P(e.EntityLogicalName,t.EntityLogicalName),DisplayName:P(e.DisplayName,t.DisplayName),EntitySetName:P(e.EntitySetName,t.EntitySetName),PrimaryKeyName:P(e.PrimaryKeyName,t.PrimaryKeyName),ObjectTypeCode:P(e.ObjectTypeCode,t.ObjectTypeCode),Id:P(e.Id,t.Id),DisplayCollectionName:P(e.DisplayCollectionName,t.DisplayCollectionName),PluralName:P(e.PluralName,t.PluralName),PrimaryIdAttribute:P(e.PrimaryIdAttribute,t.PrimaryIdAttribute),PrimaryNameAttribute:P(e.PrimaryNameAttribute,t.PrimaryNameAttribute),PrimaryImageAttribute:P(e.PrimaryImageAttribute,t.PrimaryImageAttribute),EntityColor:P(e.EntityColor,t.EntityColor),ActivityTypeMask:P(e.ActivityTypeMask,t.ActivityTypeMask),HasChanged:P(e.HasChanged,t.HasChanged),HasNotes:P(e.HasNotes,t.HasNotes),HasActivities:P(e.HasActivities,t.HasActivities),HasStateCode:e.HasStateCode,CanTriggerWorkflow:P(e.CanTriggerWorkflow,t.CanTriggerWorkflow),AutoRouteToOwnerQueue:P(e.AutoRouteToOwnerQueue,t.AutoRouteToOwnerQueue),Description:P(e.Description,t.Description),EntityHelpUrlEnabled:P(e.EntityHelpUrlEnabled,t.EntityHelpUrlEnabled),EntityHelpUrl:P(e.EntityHelpUrl,t.EntityHelpUrl),IsDocumentManagementEnabled:P(e.IsDocumentManagementEnabled,t.IsDocumentManagementEnabled),IsOneNoteIntegrationEnabled:P(e.IsOneNoteIntegrationEnabled,t.IsOneNoteIntegrationEnabled),IsMSTeamsIntegrationEnabled:P(e.IsMSTeamsIntegrationEnabled,t.IsMSTeamsIntegrationEnabled),IsInteractionCentricEnabled:P(e.IsInteractionCentricEnabled,t.IsInteractionCentricEnabled),IsKnowledgeManagementEnabled:P(e.IsKnowledgeManagementEnabled,t.IsKnowledgeManagementEnabled),IsDocumentRecommendationsEnabled:P(e.IsDocumentRecommendationsEnabled,t.IsDocumentRecommendationsEnabled),IsActivity:P(e.IsActivity,t.IsActivity),IsEnabledForCharts:P(e.IsEnabledForCharts,t.IsEnabledForCharts),IsActivityParty:P(e.IsActivityParty,t.IsActivityParty),IsChildEntity:P(e.IsChildEntity,t.IsChildEntity),IsCollaboration:P(e.IsCollaboration,t.IsCollaboration),IsConnectionsEnabled:P(e.IsConnectionsEnabled,t.IsConnectionsEnabled),IsCustomEntity:P(e.IsCustomEntity,t.IsCustomEntity),IsCustomizable:P(e.IsCustomizable,t.IsCustomizable),IsIntersect:P(e.IsIntersect,t.IsIntersect),ParentEntityLogicalName:P(e.ParentEntityLogicalName,t.ParentEntityLogicalName),ParentEntityReferencingAttribute:P(e.ParentEntityReferencingAttribute,t.ParentEntityReferencingAttribute),IsBusinessProcessEnabled:P(e.IsBusinessProcessEnabled,t.IsBusinessProcessEnabled),IsBPFEntity:P(e.IsBPFEntity,t.IsBPFEntity),IsDuplicateDetectionEnabled:P(e.IsDuplicateDetectionEnabled,t.IsDuplicateDetectionEnabled),CanEnableSyncToExternalSearchIndex:P(e.CanEnableSyncToExternalSearchIndex,t.CanEnableSyncToExternalSearchIndex),IsOptimisticConcurrencyEnabled:P(e.IsOptimisticConcurrencyEnabled,t.IsOptimisticConcurrencyEnabled),IsImportable:P(e.IsImportable,t.IsImportable),IsMailMergeEnabled:P(e.IsMailMergeEnabled,t.IsMailMergeEnabled),IsManaged:P(e.IsManaged,t.IsManaged),IsStateModelAware:P(e.IsStateModelAware,t.IsStateModelAware),EnforceStateTransitions:P(e.EnforceStateTransitions,t.EnforceStateTransitions),IsValidForAdvancedFind:P(e.IsValidForAdvancedFind,t.IsValidForAdvancedFind),IsVisibleInMobileClient:P(e.IsVisibleInMobileClient,t.IsVisibleInMobileClient),IsReadOnlyInMobileClient:P(e.IsReadOnlyInMobileClient,t.IsReadOnlyInMobileClient),IsOfflineInMobileClient:P(e.IsOfflineInMobileClient,t.IsOfflineInMobileClient),IsQuickCreateEnabled:P(e.IsQuickCreateEnabled,t.IsQuickCreateEnabled),EntityClientSetting:P(e.EntityClientSetting,t.EntityClientSetting),OwnershipType:P(e.OwnershipType,t.OwnershipType),Privileges:P(e.Privileges,t.Privileges),DataProviderId:P(e.DataProviderId,t.DataProviderId),OneToManyRelationships:Object.assign(Object.assign({},e.OneToManyRelationships),t.OneToManyRelationships),ManyToOneRelationships:Object.assign(Object.assign({},e.ManyToOneRelationships),t.ManyToOneRelationships),ManyToManyRelationships:Object.assign(Object.assign({},e.ManyToManyRelationships),t.ManyToManyRelationships)}}function P(e,t){if(null==e)return t;if(null==t)return e;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)throw new Error("Descriptor field arrays with the same key have conflicting values");return e}if(e instanceof Object&&t instanceof Object){if(Object.keys(e).length!==Object.keys(t).length)throw new Error("Descriptor field objects with the same key have conflicting values");return e}if(e!==t)throw new Error("Descriptor fields with the same key have conflicting values");return e}},"1qQb":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("eXjw"),a=n("SAYH"),i=n("odYE");function o(e){const t={recordPrivileges:e.get_accessRights()},n=e.get_userSharedAttributePrivileges();if(n){const e={};for(const t in n){const r=n[t];e[t]={accessRightsMask:r.get_AccessRightsMask(),attributeId:a.a.fromLegacyGuid(r.get_AttributeId()),canCreate:r.get_CanCreate(),canRead:r.get_CanRead(),canUpdate:r.get_CanUpdate()}}t.attributePrivileges=e}return t}function s(e){if(!e)throw new Error("Legacy entity record is null");const t=e.get_fieldNames(),n=e.get_fieldTypes(),a={},s=new Date;if(t)for(const r of t){const t=n[r],i=e.getValue(r);null!==i?a[r]=c(r,t,i,e,s):a[r]=null}const l=e.get_globalNavigationData();let u=null,d=null;if(l){const e=i.a.fromLegacyEntityReference(l.get_identifier());e&&(d=e.id);const t=l.getValue("processid");if(t){u=i.a.fromLegacyEntityReference(t).id}}return{initialized:r.a.Initialized,identifier:i.a.fromLegacyEntityReference(e.get_identifier()),accessRights:o(e),fields:a,businessProcessFlowId:u,businessProcessFlowInstanceId:d}}function c(e,t,n,r,o){const l={errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1};switch(t){case"boolean":case"picklist":case"state":case"status":const t=n;return{label:t.get_Label(),valueString:t.get_ValueString(),timestamp:o,validationResult:l};case"uniqueidentifier":const u=n;return{id:a.a.fromLegacyGuid(u),timestamp:o,validationResult:l};case"customer":case"lookup":case"owner":const d=n;return{reference:i.a.fromLegacyEntityReference(d),timestamp:o,validationResult:l};case"aliasedvalue":const p=n,g=p.get_entityLogicalName(),h=p.get_attributeLogicalName(),f=p.get_attributeType();return{attributeLogicalName:h,entityLogicalName:g,innerValue:c(e,f,p.get_value(),r,o),timestamp:o,validationResult:l,innerType:f};case"partylist":const m=n,b=[];for(const e of m.get_entities())b.push(s(e));return{list:b,timestamp:o,validationResult:l};case"navigationproperty":const _=n,y=[];for(const e of _)y.push(s(e));return{list:y,timestamp:o,validationResult:l};case"datetime":n=n&&n.toISOString();default:const v=r.get_formattedValues();if(v.hasOwnProperty(e))return{value:n,formatted:v[e],timestamp:o,validationResult:l};const S=r.get_numericFormattedValues();return S.hasOwnProperty(e)?{value:n,formatted:S[e],timestamp:o,validationResult:l}:{value:n,timestamp:o,validationResult:l}}}},"1usl":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t){this.EntityName=e,this.EntityId=t}getMetadata(){return{boundParameter:null,parameterTypes:{EntityName:{typeName:this.EntityName,structuralProperty:5},EntityId:{typeName:this.EntityId,structuralProperty:5}},operationName:"GetCurrentServerDateTimeInUtc",operationType:2}}}var a=n("w72X"),i=n("SAYH");const o="serverTime.retrieve";function s(e){return{type:o,execute({dispatch:t,getState:n},s){const c=t(Object(a.b)(new r(e.etn,i.a.toString(e.id))));return c.then(e=>{Promise.resolve(e.json().then(e=>{const n=e.ServerDateTime;let r=n.indexOf('"',n.indexOf("ServerTime")),a=n.indexOf('"',r+1),i=new Date(n.substring(r+1,a));"NaN"===i.toString()&&(r=n.indexOf('"',n.indexOf("ServerTimeForIE8")),a=n.indexOf('"',r+1),i=new Date(n.substring(r+1,a))),t(function(e){const t=e?Math.floor((Date.parse((new Date).toUTCString())-Date.parse(new Date(e).toUTCString()))/1e3):0;return{type:o,payload:{serverTimeDiffInSeconds:t}}}(i.toString()))}))},e=>{}),Promise.resolve(c)}}}},"23jc":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));function r(e){return{type:"execute.serialized.request.async",execute:({dispatch:t,getState:n},r)=>r.DataSource.get_WebAPIService().sendRequest(e)}}},"2F73":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("XvL5");class a{get_isEmpty(){return!1}getDifference(e){return new r.a(new Array(0))}static get_instance(){return a._instance||(a._instance=new a)}}a._instance=null},"2FbK":function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var r=n("eXjw"),a=n("Lyxw"),i=n("GWSs"),o=n("NjDY"),s=n("3/02"),c=n("IqkD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let l=-1,u={};function d(e){const t=Object(i.k)(e);return t?function(e,t){if(e.metadata.siteMap.hasOwnProperty("Areas")&&e.metadata.siteMap.hasOwnProperty("AreaIds")){const n=Object(a.b)(e,"SalesSettingsOnUCI"),r=Object(a.b)(e,"Playbook"),i=Object(c.w)(e),d=null==i?void 0:i.autoCaptureUserStatus,p=Object(o.x)(e),f=Object(a.b)(e,"ManualForecast"),m=Object(a.b)(e,"TeamsDialerSettings"),b=null==p?void 0:p.isAutoDataCaptureV2Enabled,_=Object(a.a)(e,"FCB.ManualForecast",s.h)||Object(a.b)(e,"ManualForecast")&&p&&p.isManualSalesForecastingEnabled,y=Object(a.b)(e,"SalesPartnerApps");if(y||g(t,"Enterprise_Sales","AppExtensionsGrp"),b&&1===d||(g(t,"Enterprise_Sales","AutoCapture"),h(t,"Enterprise_Sales","My_Work","SuggestedActivty"),h(t,"Enterprise_Sales","Customers","SuggestedContact")),!n)return function(e){const t="Sales_Settings_Area",n=e.VersionNumber;n!==l&&(u=JSON.parse(JSON.stringify(e)),l=n);const r=u.AreaIds.indexOf(t);-1!==r&&(delete u.Areas[t],u.AreaIds.splice(r,1));return u}(t);r||g(t,"Sales_Settings_Area","PlaybookManagementGroup"),y||g(t,"Sales_Settings_Area","AppExtensionsGrp"),_||h(t,"Sales_Settings_Area","GoalManagementGrp","ForecastDefinition"),f||h(t,"Sales_Settings_Area","GoalManagementGrp","ForecastConfiguration"),m||h(t,"Sales_Settings_Area","GeneralSettingsGroup","TeamsCallsIntegration"),_||h(t,"Enterprise_Sales","Goals","ForecastInstance")}return t}(e,function(e,t){var n;const r="Settings",a=t.VersionNumber;a!==l&&(u=JSON.parse(JSON.stringify(t)),l=a);if(!0===(null===(n=e.configuration)||void 0===n?void 0:n.isD365DefaultApp)&&e.metadata.siteMap.hasOwnProperty("Areas")&&e.metadata.siteMap.hasOwnProperty("AreaIds")){const e=u.AreaIds.indexOf(r);-1!==e&&(delete u.Areas[r],u.AreaIds.splice(e,1))}return u}(e,t)):null}function p(e){const t=Object(i.i)(e);return t&&t===r.a.Initialized?d(e):null}function g(e,t,n){const r=e.VersionNumber;r!==l&&(u=JSON.parse(JSON.stringify(e)),l=r);let a=u.AreaIds.indexOf(t);return-1!==a&&(a=-1,a=u.Areas[t].GroupIds.indexOf(n),-1!==a&&(delete u.Areas[t].Groups[n],u.Areas[t].GroupIds.splice(a,1))),u}function h(e,t,n,r){const a=e.VersionNumber;a!==l&&(u=JSON.parse(JSON.stringify(e)),l=a);let i=u.AreaIds.indexOf(t);return-1!==i&&(i=-1,i=u.Areas[t].GroupIds.indexOf(n),-1!==i&&null!==r&&(i=-1,i=u.Areas[t].Groups[n].SubAreaIds.indexOf(r),-1!==i))?(delete u.Areas[t].Groups[n].SubAreas[r],u.Areas[t].Groups[n].SubAreaIds.splice(i,1),u):u}},"2JG5":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("84PK"),a=n("504W"),i=n("NMtn"),o=n("KLhE"),s=n("b6oC");class c{constructor(e,t,n,r,a,o,s,c,l,u,d,p,g,h,f,m,b,_,y,v,S,O,C,E,I,w,j,P,T,N,A,D,R,x,M,F,k,L,B,U,V,z,W,q,H,G,K,Q,X,Y,J,$,Z,ee,te){this._id=null,this._logicalName=null,this._objectTypeCode=0,this._primaryIdAttribute=null,this._primaryNameAttribute=null,this._primaryImageAttribute=null,this._privilegesByType=null,this._hasChanged=!1,this._isActivity=!1,this._isReadOnlyForMobileClient=!1,this._isVisibleInMobileClient=!1,this._isOfflineInMobileClient=!1,this._isOptimisticConcurrencyEnabled=!1,this._isChildEntity=!1,this._parentEntityLogicalName=null,this._parentEntityReferencingAttribute=null,this._displayName=null,this._primaryKeyName=null,this._autoRouteToOwnerQueue=!1,this._canTriggerWorkflow=!1,this._displayCollectionName=null,this._description=null,this._entitySetName=null,this._isValidForAdvancedFind=!1,this._isMailMergeEnabled=!1,this._isConnectionsEnabled=!1,this._isCustomizable=!1,this._isActivityParty=!1,this._isImportable=!1,this._isEnabledForCharts=!1,this._isCustomEntity=!1,this._isStateModelAware=!1,this._enforceStateTransitions=!1,this._activityTypeMask=0,this._ownershipType=0,this._isCollaboration=!1,this._hasSecuredAttributes=!1,this._hasStateCode=!1,this._isBusinessProcessEnabled=!1,this._isDocumentManagementEnabled=!1,this._isOneNoteIntegrationEnabled=!1,this._isMSTeamsIntegrationEnabled=!1,this._isIntersect=!1,this._hasActivities=!1,this._entityColor=null,this._isInteractionCentricEnabled=!1,this._isQuickCreateEnabled=!1,this._entityClientSetting={AllowMainFormDialogForCreate:!1,AllowMainFormDialogForEdit:!1},this._isKnowledgeManagementEnabled=!1,this._isDocumentRecommendationsEnabled=!1,this._hasNotes=!1,this._usesBusinessDataLabelTable=!1,this._isBPFEntity=!1,this._oneToManyRelationships=null,this._manyToOneRelationships=null,this._manyToManyRelationships=null,this._iconVectorName=null,this._dataProviderId=null,this._versionNumber=0,this._overallVersionNumber=0,this._attributeNames=null,this._attributes=null,Object(i.d)(e,"id"),Object(i.d)(t,"logicalName"),this._id=e,this._logicalName=t,this._displayName=n,this._entitySetName=r,this._objectTypeCode=a,this._primaryIdAttribute=o,this._primaryNameAttribute=s,this._primaryImageAttribute=c,this._isReadOnlyForMobileClient=u,this._isVisibleInMobileClient=d,this._isOfflineInMobileClient=p,this._isOptimisticConcurrencyEnabled=g,this._hasChanged=h,this._isActivity=f,this._isChildEntity=m,this._parentEntityLogicalName=b,this._parentEntityReferencingAttribute=_,this._isValidForAdvancedFind=y,this._isMailMergeEnabled=v,this._isConnectionsEnabled=S,this._isCustomizable=O,this._isActivityParty=C,this._isImportable=E,this._isEnabledForCharts=I,this._isCustomEntity=w,this._isStateModelAware=j,this._enforceStateTransitions=P,this._isCollaboration=T,this._activityTypeMask=N,this._ownershipType=A,this._hasSecuredAttributes=D,this._hasStateCode=R,this._isBusinessProcessEnabled=x,this._entityHelpUrlEnabled=M,this._entityHelpUrl=F,this._isDocumentManagementEnabled=k,this._isOneNoteIntegrationEnabled=L,this._isMSTeamsIntegrationEnabled=B,this._hasActivities=U,this._entityColor=V,this._isInteractionCentricEnabled=z,this._isQuickCreateEnabled=W,this._entityClientSetting=q,this._isKnowledgeManagementEnabled=H,this._isDocumentRecommendationsEnabled=G,this._isIntersect=K,this._hasNotes=Q,this._usesBusinessDataLabelTable=X,this._iconVectorName=Y,this._isBPFEntity=J,this._versionNumber=$,this._overallVersionNumber=Z,this._attributeNames=ee,this._privilegesByType={};for(const e of l)this._privilegesByType[e.get_privilegeTypeKey()]=e;this._attributes=te}get_attributeNames(){return this._attributeNames}get_id(){return this._id}get_logicalName(){return this._logicalName}get_displayName(){return this._displayName}set_entitySetName(e){return this._entitySetName=e,e}get_objectTypeCode(){return this._objectTypeCode}get_primaryIdAttribute(){return this._primaryIdAttribute}get_primaryNameAttribute(){return this._primaryNameAttribute}get_isOptimisticConcurrencyEnabled(){return this._isOptimisticConcurrencyEnabled}get_isActivity(){switch(this._logicalName){case"phonecall":case"email":case"task":case"appointment":case"activitypointer":return!0;default:return this._isActivity}}get_isChildEntity(){return this._isChildEntity}get_parentEntityLogicalName(){return this._parentEntityLogicalName}get_parentEntityReferencingAttribute(){return this._parentEntityReferencingAttribute}get_isCustomEntity(){return this._isCustomEntity}get_activityTypeMask(){return this._activityTypeMask}get_ownershipType(){return this._ownershipType}get_hasSecuredAttributes(){return this._hasSecuredAttributes}get_hasStateCode(){return this._hasStateCode}get_isBusinessProcessEnabled(){return this._isBusinessProcessEnabled}get_isIntersect(){return this._isIntersect}get_usesBusinessDataLabelTable(){return this._usesBusinessDataLabelTable}get_isBPFEntity(){return this._isBPFEntity}getEntityCanBeUsedInBusinessProcess(){return this._isBusinessProcessEnabled||this._isBPFEntity}getODataObject(){const e={},t=this._id.toString();e.Id=t,e.MetadataId=t,e.LogicalName=this._logicalName,e.DisplayName=c.convertToLabel(this._displayName),e.EntitySetName=this._entitySetName,e.ObjectTypeCode=this._objectTypeCode,e.PrimaryKeyName=this._primaryKeyName,e.AutoRouteToOwnerQueue=this._autoRouteToOwnerQueue,e.CanTriggerWorkflow=this._canTriggerWorkflow,e.Description=c.convertToLabel(this._description),e.DisplayCollectionName=c.convertToLabel(this._displayCollectionName),e.PrimaryIdAttribute=this._primaryIdAttribute,e.PrimaryNameAttribute=this._primaryNameAttribute,e.PrimaryImageAttribute=this._primaryImageAttribute,e.IsReadOnlyInMobileClient=this._isReadOnlyForMobileClient,e.IsVisibleInMobileClient=this._isVisibleInMobileClient,e.IsOfflineInMobileClient=this._isOfflineInMobileClient,e.IsOptimisticConcurrencyEnabled=this._isOptimisticConcurrencyEnabled,e.HasChanged=this._hasChanged,e.IsActivity=this._isActivity,e.IsChildEntity=this._isChildEntity,e.ParentEntityLogicalName=this._parentEntityLogicalName,e.ParentEntityReferencingAttribute=this._parentEntityReferencingAttribute,e.IsValidForAdvancedFind=this._isValidForAdvancedFind,e.IsMailMergeEnabled=this._isMailMergeEnabled,e.IsConnectionsEnabled=this._isConnectionsEnabled,e.IsCustomizable=this._isCustomizable,e.IsActivityParty=this._isActivityParty,e.IsImportable=this._isImportable,e.IsEnabledForCharts=this._isEnabledForCharts,e.IsCustomEntity=this._isCustomEntity,e.IsStateModelAware=this._isStateModelAware,e.EnforceStateTransitions=this._enforceStateTransitions,e.IsValidForQueue=this._isCollaboration,e.ActivityTypeMask=this._activityTypeMask,e.OwnershipType=this._ownershipType,e.HasStateCode=this._hasStateCode,e.IsBusinessProcessEnabled=this._isBusinessProcessEnabled,e.IsDocumentManagementEnabled=this._isDocumentManagementEnabled,e.EntityColor=this._entityColor,e.IsInteractionCentricEnabled=this._isInteractionCentricEnabled,e.isQuickCreateEnabled=this._isQuickCreateEnabled,e.entityClientSetting=this._entityClientSetting,e.IsKnowledgeManagementEnabled=this._isKnowledgeManagementEnabled,e.OneToManyRelationships=this._oneToManyRelationships,e.ManyToOneRelationships=this._manyToOneRelationships,e.ManyToManyRelationships=this._manyToManyRelationships,e.IconVectorName=this._iconVectorName,e.IsBPFEntity=this._isBPFEntity,e.DataProviderId=this._dataProviderId?this._dataProviderId.toString():"",e.IsDocumentRecommendationsEnabled=this._isDocumentRecommendationsEnabled,e.IsIntersect=this._isIntersect,e.IsMSTeamsIntegrationEnabled=this._isMSTeamsIntegrationEnabled,e.VersionNumber=this._versionNumber,e.OverallVersionNumber=this._overallVersionNumber,e.AttributeNames=this._attributeNames,e.Privileges=[];for(const t in this._privilegesByType)e.Privileges.push(this._privilegesByType[t].getODataObject());return e.Attributes=this._attributes,e}getStorableODataObject(){return Object.assign(Object.assign({},this._getKeyPaths()),this.getODataObject())}getObjectData(){const e={};Object.assign(e,this._getKeyPaths()),e.displayname=this._displayName,e.entitysetname=this._entitySetName,e.objecttypecode=this._objectTypeCode,e.primaryidattribute=this._primaryIdAttribute,e.primarykeyname=this._primaryKeyName,e.displayCollectionName=this._displayCollectionName,e.autoRouteToOwnerQueue=this._autoRouteToOwnerQueue,e.canTriggerWorkflow=this._canTriggerWorkflow,e.primarynameattribute=this._primaryNameAttribute,e.primaryimageattribute=this._primaryImageAttribute,e.description=this._description,e.oneToManyRelationships=this._oneToManyRelationships,e.manyToOneRelationships=this._manyToOneRelationships,e.manyToManyRelationships=this._manyToManyRelationships,e.isreadonlyformobileclient=this._isReadOnlyForMobileClient,e.isvisibleinmobileclient=this._isVisibleInMobileClient,e.isofflineinmobileclient=this._isOfflineInMobileClient,e.isoptimisticconcurrencyenabled=this._isOptimisticConcurrencyEnabled,e.haschanged=this._hasChanged,e.isactivity=this._isActivity,e.ischildentity=this._isChildEntity,e.parententitylogicalname=this._parentEntityLogicalName,e.parententityreferencingattribute=this._parentEntityReferencingAttribute,e.isvalidforadvancedfind=this._isValidForAdvancedFind,e.ismailmergeenabled=this._isMailMergeEnabled,e.isconnectionsenabled=this._isConnectionsEnabled,e.iscustomizable=this._isCustomizable,e.isactivityparty=this._isActivityParty,e.isimportable=this._isImportable,e.isenabledforcharts=this._isEnabledForCharts,e.iscustomentity=this._isCustomEntity,e.isstatemodelaware=this._isStateModelAware,e.enforcestatetransitions=this._enforceStateTransitions,e.iscollaboration=this._isCollaboration,e.activitytypemask=this._activityTypeMask,e.ownershiptype=this._ownershipType,e.hassecuredattributes=this._hasSecuredAttributes,e.hasstatecode=this._hasStateCode,e.isbusinessprocessenabled=this._isBusinessProcessEnabled,e.entityhelpurlenabled=this._entityHelpUrlEnabled,e.entityhelpurl=this._entityHelpUrl,e.isdocumentmanagementenabled=this._isDocumentManagementEnabled,e.isonenoteintegrationenabled=this._isOneNoteIntegrationEnabled,e.ismsteamsintegrationenabled=this._isMSTeamsIntegrationEnabled,e.hasactivities=this._hasActivities,e.entitycolor=this._entityColor,e.isinteractioncentricenabled=this._isInteractionCentricEnabled,e.isQuickCreateEnabled=this._isQuickCreateEnabled,e.entityClientSetting=this._entityClientSetting,e.isKnowledgeManagementEnabled=this._isKnowledgeManagementEnabled,e.isDocumentRecommendationsEnabled=this._isDocumentRecommendationsEnabled,e.isIntersect=this._isIntersect,e.hasnotes=this._hasNotes,e.iconVectorName=this._iconVectorName,e.usesBusinessDataLabelTable=this._usesBusinessDataLabelTable,e.isbpfentity=this._isBPFEntity,e.dataProviderId=this._dataProviderId?this._dataProviderId.toString():"",e.VersionNumber=this._versionNumber,e.OverallVersionNumber=this._overallVersionNumber,e.AttributeNames=this._attributeNames;const t=[],n=this._privilegesByType;for(const e in n){const r={key:e,value:n[e]};t.push(r.value.getObjectData())}return e.privileges=t,e}_getKeyPaths(){return{[c._idPath]:this._id.getObjectData(),[c.logicalNamePath]:this._logicalName}}static hasAccessRights(e,t){let n=t.getEntityMetadata(e);if(Object(a.a)(n))return!1;if(n.get_isCustomEntity())return!!(n._ownershipType&o.a.userOwned);if(n.get_isChildEntity()){const e=t.getEntityMetadata(n.get_parentEntityLogicalName());Object(a.a)(e)||(n=e)}switch(n.get_logicalName()){case"account":case"annotation":case"appointment":case"asyncoperation":case"bulkoperation":case"campaign":case"campaignactivity":case"campaignresponse":case"connection":case"contact":case"contract":case"customeropportunityrole":case"customerrelationship":case"duplicaterule":case"email":case"fax":case"goal":case"goalrollupquery":case"import":case"importfile":case"importmap":case"incident":case"incidentresolution":case"invoice":case"lead":case"letter":case"list":case"mailmergetemplate":case"opportunity":case"opportunityclose":case"orderclose":case"phonecall":case"processsession":case"queue":case"quote":case"quoteclose":case"recurringappointmentmaster":case"salesorder":case"serviceappointment":case"sharepointdocumentlocation":case"sharepointsite":case"task":case"template":case"userform":case"userquery":case"userqueryvisualization":case"workflow":return!0;default:return!1}}static extractKey(e){const t=e[c._idPath];return t?r.a.createFromObjectData(t).toString():e.Id}static createFromObjectData(e){if(!Object(a.b)(e.MetadataId)){e=c.createFromOData(e).getObjectData()}const t=r.a.createFromObjectData(e[c._idPath]),n=e[c.logicalNamePath],i=e.displayname,o=e.entitysetname,l=e.objecttypecode,u=e.primaryidattribute,d=e.primarynameattribute,p=e.primaryimageattribute,g=e.isreadonlyformobileclient,h=e.isvisibleinmobileclient,f=e.isofflineinmobileclient,m=e.isoptimisticconcurrencyenabled,b=e.haschanged,_=e.isactivity,y=e.ischildentity,v=e.parententitylogicalname,S=e.parententityreferencingattribute,O=e.isvalidforadvancedfind,C=e.ismailmergeenabled,E=e.isconnectionsenabled,I=e.iscustomizable,w=e.isactivityparty,j=e.isimportable,P=e.isenabledforcharts,T=e.iscustomentity,N=e.isstatemodelaware,A=e.enforcestatetransitions,D=e.iscollaboration,R=e.activitytypemask,x=e.ownershiptype,M=e.hassecuredattributes,F=e.hasstatecode,k=e.isbusinessprocessenabled,L=e.entityhelpurlenabled,B=e.entityhelpurl,U=e.isdocumentmanagementenabled,V=e.isonenoteintegrationenabled,z=e.ismsteamsintegrationenabled,W=e.hasactivities,q=e.entitycolor,H=e.isinteractioncentricenabled,G=e.isQuickCreateEnabled,K=e.entityClientSetting,Q=e.isKnowledgeManagementEnabled,X=e.IsDocumentRecommendationsEnabled,Y=e.isIntersect,J=e.hasnotes,$=e.usesBusinessDataLabelTable,Z=e.iconVectorName,ee=e.isbpfentity,te=Object(a.b)(e.dataProviderId)?null:r.a.tryCreate(e.dataProviderId),ne=e.primaryKeyName,re=e.autoRouteToOwnerQueue,ae=e.canTriggerWorkflow,ie=e.displayCollectionName,oe=e.description,se=e.oneToManyRelationships,ce=e.manyToOneRelationships,le=e.manyToManyRelationships;let ue=-1,de=-1;e.VersionNumber&&(ue=e.VersionNumber),e.OverallVersionNumber&&(de=e.OverallVersionNumber);const pe=e.AttributeNames,ge=e.privileges.map(e=>s.a.createFromObjectData(e)),he=new c(t,n,i,o,l,u,d,p,ge,g,h,f,m,b,_,y,v,S,O,C,E,I,w,j,P,T,N,A,D,R,x,M,F,k,L,B,U,V,z,W,q,H,G,K,Q,X,Y,J,$,Z,ee,ue,de,pe);return he._primaryKeyName=ne,he._autoRouteToOwnerQueue=re,he._canTriggerWorkflow=ae,he._displayCollectionName=ie,he._description=oe,he._dataProviderId=te,he._oneToManyRelationships=se,he._manyToManyRelationships=le,he._manyToOneRelationships=ce,he}static getLabelString(e){return Object(a.a)(e)||Object(a.a)(e.UserLocalizedLabel)?null:e.UserLocalizedLabel.Label}static convertToLabel(e){const t={UserLocalizedLabel:{}};return t.UserLocalizedLabel.Label=e,t}static createFromOData(e){const t=r.a.tryCreate(e.MetadataId),n=e.LogicalName,i=c.getLabelString(e.DisplayName),o=e.EntitySetName,l=e.ObjectTypeCode,u=e.PrimaryIdAttribute,d=e.IconVectorName,p=e.PrimaryKeyName,g=e.AutoRouteToOwnerQueue,h=e.CanTriggerWorkflow,f=e.PrimaryNameAttribute,m=e.PrimaryImageAttribute,b=e.IsReadOnlyInMobileClient,_=e.IsVisibleInMobileClient,y=e.IsOfflineInMobileClient,v=e.IsOptimisticConcurrencyEnabled,S=e.HasChanged,O=e.IsActivity,C=e.IsChildEntity,E=e.ParentEntityLogicalName,I=e.ParentEntityReferencingAttribute,w=e.IsValidForAdvancedFind,j=e.IsMailMergeEnabled,P=e.IsConnectionsEnabled,T=e.IsCustomizable,N=e.IsActivityParty,A=e.IsImportable,D=e.IsEnabledForCharts,R=e.IsCustomEntity,x=e.IsStateModelAware,M=e.EnforceStateTransitions,F=e.IsValidForQueue,k=e.ActivityTypeMask,L=e.OwnershipType,B=e.IsBusinessProcessEnabled,U=e.EntityHelpUrlEnabled,V=e.EntityHelpUrl,z=e.IsDocumentManagementEnabled,W=e.IsOneNoteIntegrationEnabled,q=e.IsMSTeamsIntegrationEnabled,H=e.EntityColor,G=e.IsInteractionCentricEnabled,K=e.IsQuickCreateEnabled,Q=e.entityClientSetting,X=e.IsKnowledgeManagementEnabled,Y=e.IsDocumentManagementEnabled,J=e.IsBPFEntity,$=e.OneToManyRelationships,Z=e.ManyToOneRelationships,ee=e.ManyToManyRelationships,te=c.getLabelString(e.DisplayCollectionName),ne=c.getLabelString(e.Description),re=Object(a.b)(e.DataProviderId)?null:r.a.tryCreate(e.DataProviderId);let ae=-1,ie=-1;e.VersionNumber&&(ae=e.VersionNumber),e.OverallVersionNumber&&(ie=e.OverallVersionNumber);let oe=!1;const se=e.AttributeNames;for(let e=0;e<se.length;e++)if("statecode"===se[e]){oe=!0;break}const ce=e.IsIntersect,le=e.Privileges.map(e=>s.a.createFromOData(e)),ue=new c(t,n,i,o,l,u,f,m,le,b,_,y,v,S,O,C,E,I,w,j,P,T,N,A,D,R,x,M,F,k,L,!1,oe,B,U,V,z,W,q,!1,H,G,K,Q,X,Y,ce,!1,!1,d,J,ae,ie,se,e.Attributes);return ue._primaryKeyName=p,ue._autoRouteToOwnerQueue=g,ue._canTriggerWorkflow=h,ue._displayCollectionName=te,ue._description=ne,ue._dataProviderId=re,ue._oneToManyRelationships=$,ue._manyToOneRelationships=Z,ue._manyToManyRelationships=ee,ue}}c._idPath="id",c.logicalNamePath="logicalname"},"2LZB":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("504W");class a{constructor(e,t,n){this._batchOffset=0,this._batchSize=0,this._filterCriteria=null,this.set_filterCriteria(e),Object(r.a)(n)||this.set_batchOffset(n),Object(r.a)(t)||this.set_batchSize(t)}get_batchOffset(){return this._batchOffset}set_batchOffset(e){return this._batchOffset=e,e}get_batchSize(){return this._batchSize}set_batchSize(e){return this._batchSize=e,e}get_filterCriteria(){return this._filterCriteria}set_filterCriteria(e){return this._filterCriteria=e,e}}},"2XFH":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("K7RF"),a=n("ZoNW"),i=n("/oKV"),o=n("iJGp");function s(e){return{type:"labels.retrieve.async",execute({dispatch:t,getState:n},s){if(e&&e.length){const s=Object(a.a)(n(),e);if(s&&s.length){return t(Object(r.b)("label",null,null,null,!1,o.a.OnDemandWithoutContext,null,null,s,null,i.a.Local)).catch(e=>{if(-2147093999===e.errorCode)return{};throw e})}}return Promise.resolve({})}}}},"2YQW":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return function(e){return(t,n)=>{const r=void 0===t?{}:t,a={};let i=!1;const o=Object.keys(e);for(const t of o){const o=e[t],s=r[t],c=o(s,n);a[t]=c,i=i||c!==s}const s=i?a:r;return Object.freeze(s)}}(a(e))}function a(e){const t={},n=Object.keys(e);for(const r of n)t[r]=e[r];return t}function i(e,t,n){const r=Object.assign({},t);return Object.freeze(r),function(e,t,n){return(r=t,a)=>{if(-1===e.indexOf(a.type))return r;const i=n?n(a.payload):a.payload,o=i?Object.assign(Object.assign({},r),i):r;return Object.freeze(o)}}(e,r,n)}function o(e,t){return(n=Object.freeze({}),r)=>{const a=r.meta&&r.meta[e];if(a){const e=n[a],i=t(e,r);return i===e?n:Object.freeze(Object.assign(Object.assign({},n),{[a]:i}))}return n}}function s(e,t){const n=a(e);let r=t;return"object"==typeof t&&(r=Object.assign({},t),Object.freeze(r)),function(e,t){return(n=t,r)=>{const a=e[r.type];return a?Object.freeze(a(n,r)):n}}(n,r)}function c(e,t){if(null===e&&null===t||void 0===e&&void 0===t)return!0;if(!e&&t||e&&!t)return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;const a=Object.prototype.hasOwnProperty;for(let r=0;r<n.length;r++)if("function"!=typeof e[n[r]]&&(!a.call(t,n[r])||e[n[r]]!==t[n[r]]))return!1;return!0}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return c}))},"2aJl":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("qDUg"),a=n("4or6"),i=n("4WQe"),o=n("NCQ1"),s=function(){function e(){}return e.getPayloadBlob=function(e,t){var n,s=!1,c=new r.IO.MemoryStream,l=new r.CompactBinaryProtocolWriter(c);for(var u in l._WriteFieldBegin(r._BondDataType._BT_MAP,3,null),l._WriteMapContainerBegin(t,r._BondDataType._BT_STRING,r._BondDataType._BT_LIST),e)if(s)n||(n={}),n[u]=e[u],delete e[u];else if(e.hasOwnProperty(u)){l._WriteString(u);var d=e[u];l._WriteContainerBegin(1,r._BondDataType._BT_STRUCT),l._WriteFieldBegin(r._BondDataType._BT_STRING,2,null),l._WriteString("act_default_source"),l._WriteFieldBegin(r._BondDataType._BT_STRING,5,null),l._WriteString(o.newGuid()),l._WriteFieldBegin(r._BondDataType._BT_INT64,6,null),l._WriteInt64(o.numberToBondInt64(Date.now())),l._WriteFieldBegin(r._BondDataType._BT_LIST,8,null);var p=c._GetBuffer().length+1;l._WriteContainerBegin(e[u].length,r._BondDataType._BT_STRUCT);for(var g=c._GetBuffer().length-p,h=0;h<d.length;++h){var f=c._GetBuffer().length;if(this.writeEvent(d[h],l),c._GetBuffer().length-f>2936012)i.default.eventsRejected([d[h]],a.AWTEventsRejectedReason.SizeLimitExceeded),d.splice(h--,1),c._GetBuffer().splice(f),this._addNewDataPackageSize(d.length,c,g,p);else if(c._GetBuffer().length>2936012){c._GetBuffer().splice(f),n||(n={}),e[u]=d.splice(0,h),n[u]=d,this._addNewDataPackageSize(e[u].length,c,g,p),s=!0;break}}l._WriteStructEnd(!1)}return l._WriteStructEnd(!1),{payloadBlob:c._GetBuffer(),remainingRequest:n}},e._addNewDataPackageSize=function(e,t,n,a){for(var i=r._Encoding._Varint_GetBytes(r.Number._ToUInt32(e)),o=0;o<n;++o){if(!(o<i.length)){t._GetBuffer().slice(a+o,n-o);break}t._GetBuffer()[a+o]=i[o]}},e.writeEvent=function(e,t){t._WriteFieldBegin(r._BondDataType._BT_STRING,1,null),t._WriteString(e.id),t._WriteFieldBegin(r._BondDataType._BT_INT64,3,null),t._WriteInt64(o.numberToBondInt64(e.timestamp)),t._WriteFieldBegin(r._BondDataType._BT_STRING,5,null),t._WriteString(e.type),t._WriteFieldBegin(r._BondDataType._BT_STRING,6,null),t._WriteString(e.name);var n={},i=0,s={},c=0,l={},u=0,d={},p=0,g={},h=0,f={},m=0,b={},_=0;for(var y in e.properties){if(e.properties.hasOwnProperty(y))if((S=e.properties[y]).cc>0)b[y]=S,_++;else if(S.pii>0)f[y]=S,m++;else switch(S.type){case a.AWTPropertyType.String:n[y]=S.value,i++;break;case a.AWTPropertyType.Int64:s[y]=S.value,c++;break;case a.AWTPropertyType.Double:l[y]=S.value,u++;break;case a.AWTPropertyType.Boolean:d[y]=S.value,p++;break;case a.AWTPropertyType.Date:g[y]=S.value,h++}}if(i)for(var y in t._WriteFieldBegin(r._BondDataType._BT_MAP,13,null),t._WriteMapContainerBegin(i,r._BondDataType._BT_STRING,r._BondDataType._BT_STRING),n)if(n.hasOwnProperty(y)){var v=n[y];t._WriteString(y),t._WriteString(v.toString())}if(m)for(var y in t._WriteFieldBegin(r._BondDataType._BT_MAP,30,null),t._WriteMapContainerBegin(m,r._BondDataType._BT_STRING,r._BondDataType._BT_STRUCT),f)if(f.hasOwnProperty(y)){var S=f[y];t._WriteString(y),t._WriteFieldBegin(r._BondDataType._BT_INT32,1,null),t._WriteInt32(1),t._WriteFieldBegin(r._BondDataType._BT_INT32,2,null),t._WriteInt32(S.pii),t._WriteFieldBegin(r._BondDataType._BT_STRING,3,null),t._WriteString(S.value.toString()),t._WriteStructEnd(!1)}if(p)for(var y in t._WriteFieldBegin(r._BondDataType._BT_MAP,31,null),t._WriteMapContainerBegin(p,r._BondDataType._BT_STRING,r._BondDataType._BT_BOOL),d)if(d.hasOwnProperty(y)){v=d[y];t._WriteString(y),t._WriteBool(v)}if(h)for(var y in t._WriteFieldBegin(r._BondDataType._BT_MAP,32,null),t._WriteMapContainerBegin(h,r._BondDataType._BT_STRING,r._BondDataType._BT_INT64),g)if(g.hasOwnProperty(y)){v=g[y];t._WriteString(y),t._WriteInt64(o.numberToBondInt64(v))}if(c)for(var y in t._WriteFieldBegin(r._BondDataType._BT_MAP,33,null),t._WriteMapContainerBegin(c,r._BondDataType._BT_STRING,r._BondDataType._BT_INT64),s)if(s.hasOwnProperty(y)){v=s[y];t._WriteString(y),t._WriteInt64(o.numberToBondInt64(v))}if(u)for(var y in t._WriteFieldBegin(r._BondDataType._BT_MAP,34,null),t._WriteMapContainerBegin(u,r._BondDataType._BT_STRING,r._BondDataType._BT_DOUBLE),l)if(l.hasOwnProperty(y)){v=l[y];t._WriteString(y),t._WriteDouble(v)}if(_)for(var y in t._WriteFieldBegin(r._BondDataType._BT_MAP,36,null),t._WriteMapContainerBegin(_,r._BondDataType._BT_STRING,r._BondDataType._BT_STRUCT),b)if(b.hasOwnProperty(y)){S=b[y];t._WriteString(y),t._WriteFieldBegin(r._BondDataType._BT_INT32,1,null),t._WriteInt32(S.cc),t._WriteFieldBegin(r._BondDataType._BT_STRING,2,null),t._WriteString(S.value.toString()),t._WriteStructEnd(!1)}t._WriteStructEnd(!1)},e.base64Encode=function(e){return r._Encoding._Base64_GetString(e)},e}();t.default=s},"2bwe":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("GPkz"),a=n("qu3G"),i=n("YcFo");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="recentItem.dropdownRecentsDescriptor.toggle";function s(e){return r.a.session&&e&&(e.relativeToEntryId===i.c||e.relativeToEntryId===i.a)&&(e.isOpened?r.a.session.addEvent(e.relativeToEntryId===i.c?a.a.collapseRecent:a.a.collapsePinned):r.a.session.addEvent(e.relativeToEntryId===i.c?a.a.expandRecent:a.a.expandPinned)),{type:o,payload:e||{isOpened:!1,entityTypeName:null,relativeToEntryId:null}}}},"2cSh":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.Low="Low",e.HighWithControls="HighWithControls",e.HighReadOnlyValues="HighReadOnlyValues"}(r||(r={}))},"2gMP":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the WelcomePageDialog page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="WelcomePageDialog"},"2jAf":function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return d})),n.d(t,"b",(function(){return c}));var r=n("eXjw"),a=n("iZ7K"),i=n("Wgxh"),o=n("ddoO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="gc.metadata.remove",c="gc.metadata.update.refcount";function l(e){return{type:"garbage.collect.metadata.sync",sync:!0,execute({dispatch:t,getState:n},s){const c=n(),l={},p={},g={},h=Object(o.f)(c);for(const t in h){const n=h[t]&&h[t].slice(),o=Object(i.b)(n,e);if(o)if(0===o.length){const e=Object(a.h)(c,t);if(e){const n={Initialized:r.a.Uninitialized,EntityLogicalName:e.EntityLogicalName,IsActivity:e.IsActivity};l[t]=n,p[t]=null}}else g[t]=o}const f={},m={},b=Object(o.l)(c);for(const t in b){const n=b[t]&&b[t].slice(),r=Object(i.b)(n,e);r&&(0===r.length?f[t]=null:m[t]=r)}if((Object.keys(m).length>0||Object.keys(g).length>0)&&t(d(g,m)),Object.keys(f).length>0||Object.keys(l).length>0){t(u({ribbons:f,entities:l,attributes:p}))}}}}function u(e){return{type:s,payload:e}}function d(e,t){return{type:c,payload:{entities:e,ribbons:t}}}},"2mBq":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s}));var r=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a=new RegExp("[\n\r]+");function i(e){let t=0;for(let n=0;n<e.length;++n){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t}function o(e,t,n,r,a,i,o){return void 0===t&&void 0===n&&void 0===r&&void 0===a&&void 0===i&&void 0===o?e:String.format(e,t,n,r,a,i,o)}function s(e,t){if(Object(r.b)(e))return"";const n=new Sys.StringBuilder,i=e.split(a);for(let e=0;e<i.length;e++)Object(r.b)(i[e])||(n.append(i[e]),n.append(t));return n.toString()}},"2qKp":function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return p}));var r=n("pulT"),a=n("jhff"),i=n("FoFY"),o=n("QGYZ"),s=n("31Vn"),c=n("oT5e");function l(e,t,n){const s=e.getState(),c=t.slice();return function(e,t,n){t.push({name:"focusedSessionId",value:Object(r.c)(e)}),t.push({name:"focusedTabId",value:Object(a.b)(e)}),n&&t.push({name:"focusedTabIdInSession",value:Object(a.c)(e,n)})}(s,c,n),function(e,t,n){t.push({name:"totalSessions",value:Object(i.d)(e)}),t.push({name:"totalTabs",value:Object(o.e)(e)}),n&&t.push({name:"totalTabsInSession",value:Object(o.f)(e,n)})}(s,c,n),c}function u(e,t,n){const r=e.getState(),a=t.slice();return function(e,t,n){const r=Object(c.a)(e,n),a=Object(i.b)(e,n),o=r.history,l=o.length&&o[o.length-1];t.push({name:"sessionId",value:a.id}),t.push({name:"historyLength",value:o.length}),l&&t.push({name:"currentHistoryState",value:JSON.stringify(l.state)}),l&&t.push({name:"currentHistoryUrl",value:l&&Object(s.a)(l.url)})}(r,a,n),a}function d(e,t){return{getInitialParameters:n=>u(n,t,e),getFailureParameters:(n,r,a,i)=>u(a,t,e),getSuccessParameters:(n,r,a)=>u(r,t,e)}}function p(e){if(!e)return e;const t=e.lastIndexOf(".");if(t<0)return e.replace(/./g,"*");const n=e.substring(0,t),r=e.substring(t+1);return n.replace(/./g,"*")+"."+r}},"2qvm":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e,t,n){this._featureName=null,this._featureControlBitName=null,this._value=!1,this._featureName=e,this._featureControlBitName=t,this._value=n}get_featureName(){return this._featureName}get_featureControlBitName(){return this._featureControlBitName}get_value(){return this._value}getObjectData(){const e={};return e[r._featureNameField]=this.get_featureName(),e[r._featureControlBitNameField]=this.get_featureControlBitName(),e[r._valueField]=this.get_value(),e}static createFromObjectData(e){const t=e[r._featureNameField],n=e[r._featureControlBitNameField],a=e[r._valueField];return new r(t,n,a)}}r._featureNameField="featurename",r._featureControlBitNameField="featurecontrolbitname",r._valueField="value"},"2yvP":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n("IaGr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a=[];function i(e,t){"string"==typeof e&&(e={sourceName:e});try{return a.push(e),t()}catch(e){throw e}finally{const t="ClientApi.ClientApiSourceAttribution.setClientApiAttributionSource",n=[{name:"source",value:e.sourceName}];if(0===a.length)r.a.getInstance().eventManager.ReportComponentFailure(t,new Error("Client API Source stack was unexpectedly empty."),null,n);else{const i=o();i===e?a.pop():(n.push({name:"topSource",value:i.sourceName}),r.a.getInstance().eventManager.ReportComponentFailure(t,new Error("Client API Source stack top item value was unexpected and not removed."),null,n))}}}function o(){return 0===a.length?{sourceName:"unknown"}:a[a.length-1]}},"3/02":function(e,t,n){"use strict";n.d(t,"P",(function(){return r})),n.d(t,"Gd",(function(){return a})),n.d(t,"vd",(function(){return i})),n.d(t,"he",(function(){return o})),n.d(t,"q",(function(){return s})),n.d(t,"Rd",(function(){return c})),n.d(t,"r",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"y",(function(){return d})),n.d(t,"Wc",(function(){return p})),n.d(t,"Vc",(function(){return g})),n.d(t,"Ub",(function(){return h})),n.d(t,"Qb",(function(){return f})),n.d(t,"Sb",(function(){return m})),n.d(t,"Ob",(function(){return b})),n.d(t,"Tb",(function(){return _})),n.d(t,"Rb",(function(){return y})),n.d(t,"Pb",(function(){return v})),n.d(t,"dc",(function(){return S})),n.d(t,"L",(function(){return O})),n.d(t,"V",(function(){return C})),n.d(t,"t",(function(){return E})),n.d(t,"J",(function(){return I})),n.d(t,"O",(function(){return w})),n.d(t,"Ic",(function(){return j})),n.d(t,"mc",(function(){return P})),n.d(t,"kc",(function(){return T})),n.d(t,"hc",(function(){return N})),n.d(t,"Zd",(function(){return A})),n.d(t,"B",(function(){return D})),n.d(t,"be",(function(){return R})),n.d(t,"ae",(function(){return x})),n.d(t,"Ib",(function(){return M})),n.d(t,"Hb",(function(){return F})),n.d(t,"g",(function(){return k})),n.d(t,"fd",(function(){return L})),n.d(t,"Fc",(function(){return B})),n.d(t,"z",(function(){return U})),n.d(t,"Fd",(function(){return V})),n.d(t,"Nb",(function(){return z})),n.d(t,"c",(function(){return W})),n.d(t,"Z",(function(){return q})),n.d(t,"me",(function(){return H})),n.d(t,"ud",(function(){return G})),n.d(t,"pc",(function(){return K})),n.d(t,"Q",(function(){return Q})),n.d(t,"Hd",(function(){return X})),n.d(t,"u",(function(){return Y})),n.d(t,"fe",(function(){return J})),n.d(t,"W",(function(){return $})),n.d(t,"T",(function(){return Z})),n.d(t,"k",(function(){return ee})),n.d(t,"gb",(function(){return te})),n.d(t,"p",(function(){return ne})),n.d(t,"Yc",(function(){return re})),n.d(t,"mb",(function(){return ae})),n.d(t,"Pc",(function(){return ie})),n.d(t,"wd",(function(){return oe})),n.d(t,"Vd",(function(){return se})),n.d(t,"Wd",(function(){return ce})),n.d(t,"cc",(function(){return le})),n.d(t,"F",(function(){return ue})),n.d(t,"bd",(function(){return de})),n.d(t,"Nd",(function(){return pe})),n.d(t,"Sd",(function(){return ge})),n.d(t,"Kc",(function(){return he})),n.d(t,"zb",(function(){return fe})),n.d(t,"dd",(function(){return me})),n.d(t,"Yd",(function(){return be})),n.d(t,"Eb",(function(){return _e})),n.d(t,"yb",(function(){return ye})),n.d(t,"Gb",(function(){return ve})),n.d(t,"Ab",(function(){return Se})),n.d(t,"gc",(function(){return Oe})),n.d(t,"de",(function(){return Ce})),n.d(t,"ac",(function(){return Ee})),n.d(t,"xd",(function(){return Ie})),n.d(t,"yd",(function(){return we})),n.d(t,"Mc",(function(){return je})),n.d(t,"Nc",(function(){return Pe})),n.d(t,"qc",(function(){return Te})),n.d(t,"rd",(function(){return Ne})),n.d(t,"ub",(function(){return Ae})),n.d(t,"ob",(function(){return De})),n.d(t,"H",(function(){return Re})),n.d(t,"cd",(function(){return xe})),n.d(t,"xb",(function(){return Me})),n.d(t,"fb",(function(){return Fe})),n.d(t,"I",(function(){return ke})),n.d(t,"U",(function(){return Le})),n.d(t,"Rc",(function(){return Be})),n.d(t,"uc",(function(){return Ue})),n.d(t,"Cb",(function(){return Ve})),n.d(t,"Bb",(function(){return ze})),n.d(t,"l",(function(){return We})),n.d(t,"Xb",(function(){return qe})),n.d(t,"tb",(function(){return He})),n.d(t,"Wb",(function(){return Ge})),n.d(t,"Yb",(function(){return Ke})),n.d(t,"je",(function(){return Qe})),n.d(t,"E",(function(){return Xe})),n.d(t,"cb",(function(){return Ye})),n.d(t,"sb",(function(){return Je})),n.d(t,"ab",(function(){return $e})),n.d(t,"bb",(function(){return Ze})),n.d(t,"Lb",(function(){return et})),n.d(t,"Kd",(function(){return tt})),n.d(t,"nb",(function(){return nt})),n.d(t,"gd",(function(){return rt})),n.d(t,"ie",(function(){return at})),n.d(t,"wb",(function(){return it})),n.d(t,"jb",(function(){return ot})),n.d(t,"le",(function(){return st})),n.d(t,"Uc",(function(){return ct})),n.d(t,"Ec",(function(){return lt})),n.d(t,"ic",(function(){return ut})),n.d(t,"h",(function(){return dt})),n.d(t,"bc",(function(){return pt})),n.d(t,"Lc",(function(){return gt})),n.d(t,"Sc",(function(){return ht})),n.d(t,"rc",(function(){return ft})),n.d(t,"R",(function(){return mt})),n.d(t,"Fb",(function(){return bt})),n.d(t,"Pd",(function(){return _t})),n.d(t,"Qd",(function(){return yt})),n.d(t,"ke",(function(){return vt})),n.d(t,"j",(function(){return St})),n.d(t,"i",(function(){return Ot})),n.d(t,"ce",(function(){return Ct})),n.d(t,"rb",(function(){return Et})),n.d(t,"o",(function(){return It})),n.d(t,"X",(function(){return wt})),n.d(t,"S",(function(){return jt})),n.d(t,"a",(function(){return Pt})),n.d(t,"Td",(function(){return Tt})),n.d(t,"N",(function(){return Nt})),n.d(t,"M",(function(){return At})),n.d(t,"Od",(function(){return Dt})),n.d(t,"x",(function(){return Rt})),n.d(t,"Db",(function(){return xt})),n.d(t,"Dd",(function(){return Mt})),n.d(t,"Zb",(function(){return Ft})),n.d(t,"ge",(function(){return kt})),n.d(t,"vc",(function(){return Lt})),n.d(t,"Kb",(function(){return Bt})),n.d(t,"Id",(function(){return Ut})),n.d(t,"d",(function(){return Vt})),n.d(t,"sc",(function(){return zt})),n.d(t,"Gc",(function(){return Wt})),n.d(t,"D",(function(){return qt})),n.d(t,"tc",(function(){return Ht})),n.d(t,"Md",(function(){return Gt})),n.d(t,"yc",(function(){return Kt})),n.d(t,"td",(function(){return Qt})),n.d(t,"sd",(function(){return Xt})),n.d(t,"n",(function(){return Yt})),n.d(t,"Hc",(function(){return Jt})),n.d(t,"s",(function(){return $t})),n.d(t,"w",(function(){return Zt})),n.d(t,"A",(function(){return en})),n.d(t,"C",(function(){return tn})),n.d(t,"id",(function(){return nn})),n.d(t,"hd",(function(){return rn})),n.d(t,"Qc",(function(){return an})),n.d(t,"Ud",(function(){return on})),n.d(t,"Xc",(function(){return sn})),n.d(t,"zd",(function(){return cn})),n.d(t,"Jd",(function(){return ln})),n.d(t,"Ld",(function(){return un})),n.d(t,"fc",(function(){return dn})),n.d(t,"vb",(function(){return pn})),n.d(t,"Ad",(function(){return gn})),n.d(t,"v",(function(){return hn})),n.d(t,"wc",(function(){return fn})),n.d(t,"qd",(function(){return mn})),n.d(t,"pd",(function(){return bn})),n.d(t,"m",(function(){return _n})),n.d(t,"kb",(function(){return yn})),n.d(t,"Bc",(function(){return vn})),n.d(t,"oc",(function(){return Sn})),n.d(t,"Ac",(function(){return On})),n.d(t,"xc",(function(){return Cn})),n.d(t,"Xd",(function(){return En})),n.d(t,"zc",(function(){return In})),n.d(t,"ee",(function(){return wn})),n.d(t,"ad",(function(){return jn})),n.d(t,"Jc",(function(){return Pn})),n.d(t,"nd",(function(){return Tn})),n.d(t,"od",(function(){return Nn})),n.d(t,"hb",(function(){return An})),n.d(t,"pb",(function(){return Dn})),n.d(t,"qb",(function(){return Rn})),n.d(t,"lb",(function(){return xn})),n.d(t,"Bd",(function(){return Mn})),n.d(t,"K",(function(){return Fn})),n.d(t,"ne",(function(){return kn})),n.d(t,"Ed",(function(){return Ln})),n.d(t,"ib",(function(){return Bn})),n.d(t,"Y",(function(){return Un})),n.d(t,"eb",(function(){return Vn})),n.d(t,"db",(function(){return zn})),n.d(t,"Tc",(function(){return Wn})),n.d(t,"e",(function(){return qn})),n.d(t,"Zc",(function(){return Hn})),n.d(t,"G",(function(){return Gn})),n.d(t,"Vb",(function(){return Kn})),n.d(t,"Oc",(function(){return Qn})),n.d(t,"nc",(function(){return Xn})),n.d(t,"Cc",(function(){return Yn})),n.d(t,"Mb",(function(){return Jn})),n.d(t,"Dc",(function(){return $n})),n.d(t,"Jb",(function(){return Zn})),n.d(t,"jc",(function(){return er})),n.d(t,"lc",(function(){return tr})),n.d(t,"b",(function(){return nr})),n.d(t,"jd",(function(){return rr})),n.d(t,"kd",(function(){return ar})),n.d(t,"ld",(function(){return ir})),n.d(t,"ec",(function(){return or})),n.d(t,"md",(function(){return sr})),n.d(t,"Cd",(function(){return cr})),n.d(t,"ed",(function(){return lr}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="FCB.DummyUnifiedClientFeatureControlBitName",a="FCB.SocialInsightsMapping",i="FCB.SaveEditableGridPreNav",o="FCB.UseFabricDateTime",s="FCB.Client.CSHSaveFilterUCI",c="FCB.Client.SupportCreatePersonalView",l="FCB.Client.Search.Categorized.Barcode",u="FCB.AllowLegacyDialogsInUci",d="FCB.Client.Chart.ChartOnForm",p="FCB.Client.PowerBI.PowerBIOnForm",g="FCB.PowerBIDialog",h="FCB.HybridDialog.Share",f="FCB.HybridDialog.BulkEdit",m="FCB.HybridDialog.Merge",b="FCB.HybridDialog.AdvancedFind",_="FCB.HybridDialog.PersonalOption",y="FCB.HybridDialog.ListQueryBuild",v="FCB.HybridDialog.AppointmentRecurrence",S="FCB.LetterAndFaxVisibleOnTLW",O="FCB.DependentOptionSetSgFCB",C="FCB.EnableBPFApprovalFlows",E="FCB.Client.Chart.DrillDown",I="FCB.DashboardCustomizableRibbon",w="FCB.DisableEditableGridControlOnPhone",j="FCB.NewSearchExperience",P="FCB.LookupService",T="FCB.LookupQuickFind",N="FCB.LoadHigherJQueryVersion",A="FCB.UCKMControlRelevanceSearch",D="FCB.Client.Chart.ChartViewSelector",R="FCB.UciShellRefresh",x="FCB.UciShell2020Update",M="FCB.HideBrandName",F="FCB.HideAppSwitcher",k="FCB.AppSwitcherShell",L="FCB.ReadOnlyGridColumnFiltering",B="FCB.NavigateToGridFromSubgrid",U="FCB.Client.Chart.ChartOnQuickViewForm",V="FCB.SiteMapTelemetry",z="FCB.HybridDashboardActions",W="FCB.AddUserForAccessTeam",q="FCB.EnableLookupMRU",H="FCB.WijmoSizeCache",G="FCB.RunReportsInUci",K="FCB.MainFormDialog",Q="FCB.EditFormLazyLoadViewport",X="FCB.SortingByRelatedEntityColumn",Y="FCB.Client.Chart.GridCommandBar",J="FCB.UnsetDefaultDashboard",$="FCB.Client.EnableCanvasAppEmbedding",Z="FCB.Client.EnableAppToHostCommunication",ee="FCB.AuditHistory",te="FCB.FontMeasureWholeNumbersV1",ne="FCB.BrowserOfflineEnabledForTest",re="FCB.PreviewApril2019",ae="FCB.FormHeaderV2",ie="FCB.OfflineQVF",oe="FCB.SaveFilterToPersonalView",se="FCB.TimelineWallEmailThread",ce="FCB.TimelineWallUxImprovements",le="FCB.LearningPath",ue="FCB.ConnectionRoleUCI",de="FCB.QuickSearchForSubGrid",pe="FCB.SubgridQuickFindWC",ge="FCB.TextBoxControlExpandButton",he="FCB.October2019Update",fe="FCB.GridPaginationState",me="FCB.QuickViewFormHeader",be="FCB.UCIGridDensity",_e="FCB.GridSubjectColumn",ye="FCB.GridOverrideOpenRecord",ve="FCB.GridVirtualization",Se="FCB.GridProgressIndicator",Oe="FCB.LivePersonaCardAdalVerboseLogging",Ce="FCB.UnSaveDialogV2",Ee="FCB.JumpBarShouldHonorSorting",Ie="FCB.UciServiceWorker",we="FCB.UciServiceWorkerGcm",je="FCB.UciOfficeAppLauncher",Pe="FCB.UciOfficeShellDataEndpoint",Te="FCB.UciMeControl",Ne="FCB.RetrieveChartByStorageKey",Ae="FCB.GridHierarchyIcon",De="FCB.FormNotificationAnchoring",Re="FCB.ContextMenuLookup",xe="FCB.QuickFormFooterSplitButton",Me="FCB.GridNotificationOnServerError",Fe="FCB.ExtendedOfflineClientApiSupport",ke="FCB.CustomOfflineCommands",Le="FCB.EnableAuthFlow",Be="FCB.OpenFormErrorsOnInvalidFormParameters",Ue="FCB.MobileUsabilityOct2019",Ve="FCB.GridRollupForAllEntities",ze="FCB.GridRollupForAllEntitiesApril2020",We="FCB.AutomaticReconnect",qe="FCB.IsGetClientMetadataExEnabled",He="FCB.GridDuplicateDetection",Ge="FCB.FileType",Ke="FCB.MultipleImages",Qe="FCB.UseReactNativeOfflineStatusPage",Xe="FCB.CommandChecker",Ye="FCB.EnableStandaloneConsentService",Je="FCB.GridColumnEditor",$e="FCB.EnableQueryPage",Ze="FCB.EnableQuickFindPagination",et="FCB.HideLegacyAdvancedFindInGlobalCommandBar",tt="FCB.SubGridDataLoadFormContext",nt="FCB.FormLargeImageFile",rt="FCB.RecordSetNavigatorOnQueueItem",at="FCB.UseLegacyFunctionForWeekNumbering",it="FCB.GridNewFilter",ot="FCB.FormComponent",st="FCB.ViewSelectorV2",ct="FCB.ShowPersonalViewFirst",lt="FCB.MultiSelectOptionQuickFind",ut="FCB.LookupAutoselectFirstResult",dt="FCB.April2020Update",pt="FCB.KMSearchUIEnhancements",gt="FCB.October2020Update",ht="FCB.OverrideRecordSetNavigatorOnQueueItem",ft="FCB.MemoFieldOnEditableGrid",mt="FCB.EditableGridLookupRecordCountConfig",bt="FCB.GridTheming",_t="FCB.SuiterDashboard",yt="FCB.SuiterStream",vt="FCB.UseVerticalMoreIcon",St="FCB.AssociatedGridHeight",Ot="FCB.AssociatedGridApril2020Update",Ct="FCB.UnresolvedEmailAddressFeature",Et="FCB.GlobalBarNotification",It="FCB.BpfFlowStepUIRefresh",wt="FCB.EnableConnectorAuthPopup",jt="FCB.EnableAdvancedGridFiltering",Pt="FCB.ActivityMgmtApril2020Update",Tt="FCB.ThemeOct2020Update",Nt="FCB.DesignLanguageTheme",At="FCB.DesignLanguageTeamsTheme",Dt="FCB.SuiterChart",Rt="FCB.ChartOnAssociatedGrid",xt="FCB.GridSearchCanUseCurrentView",Mt="FCB.ShowEntityImageOnFormFlag",Ft="FCB.IsPowerBIEnabledIsJustForUserDashboards",kt="FCB.UseDefaultPowerBIBackground",Lt="FCB.ModernDataLayer",Bt="FCB.HideJumpbarMobile",Ut="FCB.UseOfflineSqlTokens",Vt="FCB.AdvancedFilterNonEnglishSupport",zt="FCB.MobileScrollableTabs",Wt="FCB.NavigateToOpenInNewTabSupport",qt="FCB.CollapseHeaderOnScrollGridRootMobile",Ht="FCB.MobileUsabilityApril2020",Gt="FCB.SubgridImprovements",Kt="FCB.ModernDataLayerDev",Qt="FCB.RetryConnectivityFailuresOnce",Xt="FCB.RetryConnectivityFailuresInfinitely",Yt="FCB.BlockUIForServerConnectivity",Jt="FCB.NavigationManagerNetworkDispatcher",$t="FCB.ChartCustomizationParity",Zt="FCB.ChartOct2020Update",en="FCB.ChartPlugin",tn="FCB.ClickPhoneCallToOpenQuickCreate",nn="FCB.RemoveBreadCrumbs",rn="FCB.RemoveAppSwitcher",an="FCB.OnPremSiteMapRefresh",on="FCB.TimeControlValidateOnKeypress",sn="FCB.PreloadRelatedGridViewMetadata",cn="FCB.SetBlankValueValidation",ln="FCB.SubGridAutoCollapseOctober2020Update",un="FCB.SubGridRemoveMinHeightOctober2020Update",dn="FCB.ListSelectAllOctober2020Update",pn="FCB.GridListViewSortOption",gn="FCB.SharedCanvasAppHost",hn="FCB.ChartNavigateToAssociatedGrid",fn="FCB.ModernDataLayerCUD",mn="FCB.RestoreUciState",bn="FCB.RestoreDialogState",_n="FCB.AzureFootprint",yn="FCB.FormFocusAndScrollState",vn="FCB.ModernDataLayerRMPhase1",Sn="FCB.MDLUsesDependencyInformation",On="FCB.ModernDataLayerGCM",Cn="FCB.ModernDataLayerClientApi",En="FCB.TrustedUCI",In="FCB.ModernDataLayerEM",wn="FCB.UnmountPageForBackNavigation",jn="FCB.QuickFindImprovementsOnGridRootForMobile",Pn="FCB.NoRibbonClientMetadataForUncustomizedEntities",Tn="FCB.ReportUnsupportedClientApi",Nn="FCB.ReportUnsupportedClientApiEverything",An="FCB.ForceDynamicsBrandingForConnectedStore",Dn="FCB.GCMOptimizationBySeparation",Rn="FCB.GCMOptimizationBySeparationForBatchProcessing",xn="FCB.FormGCMOptimizationBySeparation",Mn="FCB.ShowAsButtonFirst",Fn="FCB.DashboardGCMOptimizationBySeparation",kn="FCB.WrapExplicitlyDefinedControls",Ln="FCB.ShowOfflineFileDownloadStatus",Bn="FCB.ForceSyncOfflineData",Un="FCB.EnableEmailEditInMoca",Vn="FCB.EnforceUCIReportToAdmin",zn="FCB.EnforceUCIDeeplink",Wn="FCB.PCF.PreventUnnecessaryRenders",qn="FCB.AdvancedFindGlobalizedFormattingSupport",Hn="FCB.QueueFilterPerfImprovementUCI",Gn="FCB.ConsumeMdlModel",Kn="FCB.ImmediateOfflineDataSync",Qn="FCB.OfflineByDefault",Xn="FCB.MDLBrowserOfflineEnabledForTest",Yn="FCB.ModernDataLayerRMPhase2",Jn="FCB.HideUCISearch",$n="FCB.ModernDataLayerRetrieve",Zn="FCB.HideGridItemEntityImage",er="FCB.LookupCharacterCountBeforeResolveSettable",tr="FCB.LookupResolveDelaySettable",nr="FCB.AddTokenToSvgXhrRequests",rr="ReplaceActivityEditorControlWithRTEControl",ar="ReplaceConfiguredRTEv1WithRTEv2",ir="ReplaceConfiguredRTEv1WithRTEv2ForKbEditor",or="LimitedConfiguredRTEv2",sr="ReplaceLimitedConfiguredEntitiesRTEv1WithRTEv2",cr="ShowConfiguredRTEv2",lr="RTEBase64Uploader"},"31Vn":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var r=n("9eA9"),a=n("xagu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i=[a.i,a.v,a.S.toLocaleLowerCase(),a.db];function o(e,t=!1){let n=null,a="";try{"string"==typeof e&&""!==e?n=new r.a(e):e instanceof r.a&&(n=new r.a(e.toString())),!n||n.protocol===window.location.protocol&&n.host===window.location.host?n&&(a=c(n,t?[]:i).toString()):a=c(n,[]).toString()}finally{return a}}function s(e){let t=e;if(null!==e&&""!==e&&void 0!==e){const n=e.toLocaleLowerCase();t="true"===n||"1"===n||"false"===n||"0"===n?"[Bool]":isNaN(Number(n))?"[String-"+n.length+"]":"[Num]"}return t}function c(e,t){e.clearCredential();const n=e.searchParams.toDictionary();for(const r in n)(0===t.length||t.indexOf(r.toLocaleLowerCase())>-1)&&e.searchParams.set(r,s(e.searchParams.get(r)));return e}},"37s6":function(e,t,n){"use strict";n.d(t,"u",(function(){return j})),n.d(t,"q",(function(){return m})),n.d(t,"r",(function(){return y})),n.d(t,"d",(function(){return C})),n.d(t,"p",(function(){return E})),n.d(t,"n",(function(){return S})),n.d(t,"o",(function(){return O})),n.d(t,"c",(function(){return w})),n.d(t,"w",(function(){return I})),n.d(t,"a",(function(){return P})),n.d(t,"b",(function(){return T})),n.d(t,"k",(function(){return R})),n.d(t,"v",(function(){return D})),n.d(t,"t",(function(){return x})),n.d(t,"s",(function(){return M})),n.d(t,"m",(function(){return A})),n.d(t,"l",(function(){return L})),n.d(t,"h",(function(){return N})),n.d(t,"i",(function(){return B})),n.d(t,"e",(function(){return b})),n.d(t,"f",(function(){return _})),n.d(t,"j",(function(){return U})),n.d(t,"g",(function(){return v}));var r=n("504W"),a=n("eZ32"),i=n("8CLP"),o=n("8Mff"),s=n("smSa"),c=n("69Qu"),l=n("YxC/"),u=n("iF9X"),d=n("RADj"),p=n("ff1s"),g=n("8f6m"),h=n("h6c1"),f=n("7NKF");n("17x/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function m(e){const t=F(e);return t&&!Object(r.a)(t.status)?t.status:null}function b(e){var t;const n=null===(t=Object(h.a)(e,f.b))||void 0===t?void 0:t.filesDownloadStatus;return Object(r.a)(n)?Object(g.g)():n}function _(e){const t=b(e);return!!t&&t.totalFileCount-t.downloadedFileCount>0}function y(e){const t=F(e);return t&&!Object(r.a)(t.statusReason)?t.statusReason:null}function v(e){const t=F(e);return!(!t||Object(r.a)(t.isFileSyncInProgress))&&t.isFileSyncInProgress}function S(e){const t=F(e);return t&&!Object(r.a)(t.errorCode)?t.errorCode:null}function O(e){const t=F(e);return t&&!Object(r.a)(t.errorMessage)?t.errorMessage:null}function C(e){const t=F(e);return t&&t.existingDatabaseName?t.existingDatabaseName:null}function E(e){const t=F(e);return t&&!Object(r.a)(t.offlineFeatureStatus)?t.offlineFeatureStatus:null}function I(e){return E(e)===o.a.Enabled&&m(e)===a.a.Available&&Object(p.d)(e)}function w(e){const t=F(e);return!(!t||Object(r.a)(t.isDbCleanupNeeded))&&t.isDbCleanupNeeded}function j(e){const t=F(e);return!(!t||Object(r.a)(t.reInitializeOffline))&&t.reInitializeOffline}function P(e){const t=F(e);return!(!t||!t.applyApplicationMetadataChanges)&&t.applyApplicationMetadataChanges}function T(e){const t=F(e);return!(!t||!t.applyingApplicationMetadataChanges)&&e.offline.client.applyingApplicationMetadataChanges}function N(e){const t=F(e);return!(!t||!t.isFirstApplyApplicationMetadataChangesDone)&&t.isFirstApplyApplicationMetadataChangesDone}function A(e){const t=F(e);return!(!t||!t.isSyncing)&&e.offline.client.isSyncing}function D(e){const t=F(e);return!(!t||Object(r.a)(t.isUserSelectOffline))&&t.isUserSelectOffline}function R(e){return E(e)!==o.a.Disabled&&Object(u.a)(e)}function x(e){let t="";switch(m(e)){case a.a.NotAvailable:t=Object(l.b)(e,"L_Offline_Not_Available");break;case a.a.Initializing:t=Object(l.b)(e,"L_Initializing");break;case a.a.Available:t=Object(p.d)(e)?B(e)?Object(l.b)(e,"L_Offline_Updating"):Object(l.b)(e,"L_Offline_Available"):Object(p.c)(e)?Object(l.b)(e,"L_Offline_Not_Available"):Object(l.b)(e,"L_Initializing")}return t}function M(e){let t="";if(Object(p.c)(e))return t;const n=y(e);if(n)switch(n){case i.a.ProfileUnavailable:t=Object(l.b)(e,"L_OfflineProfile_Not_Available");break;case i.a.DatabaseUnavailable:t=Object(l.b)(e,"L_Offline_DB_Not_Available");break;case i.a.MetadataChanged:t=k(e);break;case i.a.SyncFailure:t=Object(l.b)(e,"L_Sync_Failure");break;case i.a.UpgradeClient:t=Object(l.b)(e,"L_Upgrade_Client")}return!t&&Object(c.b)(e)&&d.a.SyncPendingFromServer===Object(s.c)(e)&&(t=k(e)),t}function F(e){return e&&e.offline&&e.offline.client?e.offline.client:null}function k(e){let t="";return t=Object(s.c)(e)===d.a.SyncPendingFromServer?Object(l.b)(e,"L_Metadata_Changed_Text"):Object(l.b)(e,"L_Metadata_Changed"),t}function L(e){const t=F(e);return!(!t||!t.isOfflineFirstTimeSyncCompleted)&&t.isOfflineFirstTimeSyncCompleted}function B(e){const t=F(e);return!(!t||!t.isForcedSyncInProgress)&&t.isForcedSyncInProgress}function U(e){const t=F(e);return t&&t.isImmediateOfflineDataSyncInProgress}},"3I29":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Normal=1]="Normal",e[e.Slow=10]="Slow"}(r||(r={}))},"3ZcW":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{MetadataType:{typeName:"Edm.String",structuralProperty:1},MetadataSubtype:{typeName:"Edm.String",structuralProperty:1},EntityLogicalName:{typeName:"Edm.String",structuralProperty:1},MetadataId:{typeName:"Edm.Guid",structuralProperty:1},MetadataName:{typeName:"Edm.String",structuralProperty:1},MetadataNames:{typeName:"Edm.String",structuralProperty:4},GetDefault:{typeName:"Edm.Boolean",structuralProperty:1},DependencyDepth:{typeName:"Microsoft.Dynamics.CRM.DependencyDepth",structuralProperty:3,enumProperties:[,{name:"Unknown",value:0},{name:"OnDemandWithContext",value:1},{name:"OnDemandWithoutContext",value:2},{name:"OnDemandContextOnly",value:3},{name:"Offline",value:4},{name:"Mobile",value:5},{name:"UserContext",value:6}]},ChangedAfter:{typeName:"Edm.String",structuralProperty:1},Exclude:{typeName:"Edm.Guid",structuralProperty:4},AppId:{typeName:"Edm.Guid",structuralProperty:1}}}}}},"3bZx":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(){this._cache={}}setItem(e,t){this._cache[e]=t}getItem(e){return this._cache[e]||null}removeItem(e){delete this._cache[e]}}},"3c60":function(e,t,n){"use strict";n.d(t,"i",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return g})),n.d(t,"f",(function(){return h})),n.d(t,"b",(function(){return f})),n.d(t,"e",(function(){return m})),n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return _}));var r=n("Ae6N"),a=n("2mBq"),i=n("olF5"),o=n("MUIu"),s=n("jZCH"),c=n("MXaZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l=6e4;function u(e,t){switch(t){case r.a.DateOnly:return m(e);case r.a.TimeZoneIndependent:return e;case r.a.UserLocal:return function(e){return Object(c.j)(s.a.get_DefaultInstance().get_UserContext(),e)}(e);default:throw Error.create("The Attribute's DateTime Behavior is Undefined!!")}}function d(e,t,n,r,i){const o=Object(a.a)("rtrim([{0}].[{1}])",e,t),s=Object(c.r)(n),l=Object(c.r)(r);return Object(a.a)(i,o,s,o,l)}function p(e,t,n,r){return d(e,t,n,r," {0} >= {1} and {2} < {3} ")}function g(e,t,n,r){return d(e,t,n,r," {0} >= {1} and {2} <= {3} ")}function h(){return Object(c.A)(s.a.get_DefaultInstance().get_UserContext())}function f(e){if(Object(i.b)(e,"DateTime input Value"),e instanceof Date)return e;let t=e;const n=new RegExp("[-]","ig");return t=t.replace(n,"/"),t=Object(o.d)(t),t=t.lastIndexOf(".")>-1?t.substr(0,t.lastIndexOf(".")):t,new Date(Date.parse(t))}function m(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function b(){return Object(c.H)(s.a.get_DefaultInstance().get_UserContext(),h())}function _(e){switch(e){case"last-x-days":case"next-x-days":case"last-seven-days":case"next-seven-days":case"yesterday":case"today":case"tomorrow":case"on":case"on-or-after":case"on-or-before":case"next-week":case"last-week":case"this-week":case"last-x-weeks":case"next-x-weeks":case"last-x-months":case"next-x-months":case"last-month":case"next-month":case"this-month":case"last-x-years":case"next-x-years":case"last-year":case"next-year":case"this-year":case"not-null":return!0;default:return!1}}},"3c7c":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("Lyxw"),a=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e){return null==e?void 0:e.replace(/"/gi,'\\"')}function o(e){const t=[{Exclude:["entity","ribbon"]},{KeepOnly:["entity"]},{KeepOnly:["ribbon"]}];Object(r.c)(e,a.qb)&&(t[0].Exclude.push("webresource"),t.push({KeepOnly:["webresource"]}));return t.map(e=>[i(JSON.stringify(e))])}},"3cEW":function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l}));var r=n("GPkz"),a=n("0FMG"),i=n("uZvv"),o=n("qu3G"),s=n("d6Hx");function c(){return{sync:!0,type:"togglePanelStateAction",execute({getState:e,dispatch:t}){const n=Object(i.d)(e())?0:1;t(Object(a.f)(n));try{localStorage.setItem("siteMapState",n.toString())}catch(e){}r.a.session&&(1===n?r.a.session.addEvent(o.a.expandSiteMap):r.a.session.addEvent(o.a.collapseSiteMap))}}}function l(e){return{sync:!0,type:"loadPanelStateFromLocalStorage",execute({getState:t,dispatch:n},r){let i=e;try{i=parseInt(localStorage.getItem("siteMapState"),10)}catch(t){i=e,r.TraceManager.getTracer(s.l).warn("error loading value in localStorage for SITE_MAP_STATE_LOCAL_STORAGE_KEY",[{name:"error",value:t.message}])}void 0!==i&&0!==i&&1!==i&&(i=e),n(Object(a.f)(i))}}}},"3fL6":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.And=0]="And",e[e.Or=1]="Or"}(r||(r={}))},"3hnk":function(e,t,n){"use strict";n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return h})),n.d(t,"a",(function(){return b})),n.d(t,"h",(function(){return _})),n.d(t,"i",(function(){return u})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return g})),n.d(t,"e",(function(){return m})),n.d(t,"d",(function(){return f}));var r=n("LbMF"),a=n("IqkD"),i=n("iZ7K"),o=n("SAYH"),s=n("y60j"),c=n("UJfx"),l=n("qLnS");function u(e){if(e)switch(e){case"activitymimeattachment":case"recommendationcache":return!0;default:return!1}return!1}function d(e,t,n,i,s){var u;let d=!0;if(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,n){let a=!1;const i=Object(r.a)(e,t,n);return i&&(a=i.IsSecured),a}(e,t,n)){const p=Object(r.a)(e,t,n);let g=!1;switch(i){case l.a.CanCreate:g=p.CanBeSecuredForCreate;break;case l.a.CanRead:g=p.CanBeSecuredForRead;break;case l.a.CanUpdate:g=p.CanBeSecuredForUpdate}if(g){const r=o.a.toString(p.Id),g=o.a.toString(s),h=null===(u=Object(a.n)(e))||void 0===u?void 0:u[r],f=Object(c.c)(e,t,g,n);if(h||f)switch(i){case l.a.CanCreate:d=(null==h?void 0:h.canCreate)||(null==f?void 0:f.canCreate);break;case l.a.CanRead:d=(null==h?void 0:h.canRead)||(null==f?void 0:f.canRead);break;case l.a.CanUpdate:d=(null==h?void 0:h.canUpdate)||(null==f?void 0:f.canUpdate)}else d=!1}}return d}function p(e,t){const n=Object(i.h)(e,t);return!!n&&n.IsEnabledInUnifiedInterface}function g(e,t){const n=Object(i.h)(e,t);return n?n.IsReadOnlyInMobileClient:null}function h(e,t,n,r){let a=!1;const o=Object(i.h)(e,t);if(o&&0===o.OwnershipType&&2===n)return!0;if(o&&o.Privileges)if(o.IsChildEntity&&0===o.Privileges.length){const t=f(e,o);a=!!t&&h(e,t.EntityLogicalName,n,r)}else for(const t in o.Privileges)if(n===o.Privileges[t].PrivilegeType){a=m(e,o.Privileges[t].PrivilegeId,r);break}return a}function f(e,t){const n=t.ManyToOneRelationships;if(n)for(const t of Object.keys(n)){const r=n[t];if(2===r.SecurityTypes)return Object(i.h)(e,r.ReferencedEntity)}return null}function m(e,t,n){let r=!1;const i=Object(a.u)(e);if(i&&i.hasOwnProperty(t)){const e=i[t];if(void 0!==(null==e?void 0:e.privilegeDepth)&&null!==(null==e?void 0:e.privilegeDepth)){const t=n;e.privilegeDepth>=t&&(r=!0)}}return r}function b(e,t){let n=!1;const r=Object(s.j)(e,t);if(r&&r.FormType)switch(r.FormType){case 2:case 9:n=!0}return n}function _(e,t,n,r){let a=!0;const i=Object(c.b)(e,t,n);return i&&(a=r===(i&r)),a}},"3mEc":function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"j",(function(){return f})),n.d(t,"i",(function(){return g})),n.d(t,"e",(function(){return b})),n.d(t,"d",(function(){return _})),n.d(t,"f",(function(){return y})),n.d(t,"g",(function(){return v})),n.d(t,"l",(function(){return S})),n.d(t,"k",(function(){return h})),n.d(t,"c",(function(){return C})),n.d(t,"b",(function(){return O}));var r=n("SAYH"),a=n("NjDY"),i=n("arV0"),o=n("dHD5"),s=n("iZ7K"),c=n("504W"),l=n("jq7Z"),u=n("fU7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d="WEBERSOURCEROOT";function p(e,t){if(!t.Parameters)return null;const n=t.Parameters.Url,r=f(e,n);let i=r?parseInt(r.type,10):-1;i=n?i:-1;let o=t.Url&&t.Url!==t.Parameters.Url?t.Url:t.Parameters.Url;if(!t.Parameters.isCustomSrc&&!o.toLocaleLowerCase().startsWith("http")&&!o.toLocaleLowerCase().startsWith("https")&&-1===o.indexOf(".aspx")){const t=Object(a.t)(e);o.startsWith(t)||(o=Object(a.t)(e)+o)}return{controlId:t.Id,title:t.Name,url:o,visible:t.Visible,showLabel:t.ShowLabel,label:t.Label,webresourceType:i}}function g(e){return{security:e.Parameters.Security,scrolling:e.Parameters.Scrolling,border:e.Parameters.Border,altText:e.Parameters.AltText,sizeType:e.Parameters.SizeType,horizontalAlignment:e.Parameters.HorizontalAlignment,verticalAlignment:e.Parameters.VerticalAlignment,width:e.Parameters.Width,height:e.Parameters.Height,showOnMobileClient:e.Parameters.hasOwnProperty("ShowOnMobileClient")?e.Parameters.ShowOnMobileClient:"true",passParameters:e.Parameters.PassParameters,data:e.Parameters.isCustomSrc?null:e.Parameters.Data,webResourceId:e.Parameters.WebResourceId}}function h(e){return e&&e.metadata?e.metadata.webResourceDescriptorsByName||{}:null}function f(e,t){const n=h(e);let r=t;if(n[r])return n[r];if(r=r.replace(/^\$webresource:/i,""),n[r])return n[r];const a=t.split("/");return r=a[a.length-1],n[r]?n[r]:{}}function m(e){return e&&e.dependency&&e.dependency.JScripts||[]}function b(e,t){const n=t.map(t=>m(f(e,t)));return t.concat(...n)}function _(e,t,n){if(!t||!n)return null;const r=t.map(t=>function(e,t){const n=e&&e.dependency&&e.dependency.Attributes||{},r=t.map(e=>n[e]||[]);return[].concat(...r)}(f(e,t),n));return[].concat(...r)}function y(e,t){const n=t.map(t=>{const n=f(e,t),r=m(n),a=function(e){return e&&e.dependency&&e.dependency.ResxResources||[]}(n);return[].concat(r,a)});return[].concat(...n)}function v(e,t){if(!t)return null;const n=function(e){return e&&e.metadata&&e.metadata.webResources?e.metadata.webResources:null}(e),a=r.a.toString(t);return n&&n[a]?n[a]:null}function S(e){if(!e||!e.WebResourceId)return null;const t=e.WebResourceId;return new r.a(t)}function O(e,t,n){if(!Object(c.b)(t)&&!Object(c.b)(n)){const r=e.indexOf("?");e=(e+=-1===r?"?":"&")+Object(u.CrmUrlEncode)(t)+"="+Object(u.CrmUrlEncode)(n)}return e}function C(e,t,n,r,a){const c=Object(l.a)(e,t),u=Object(i.g)(e,t),d=Object(o.v)(r),p=c.forms[d].controls[n].parameters,g=e.organization.organizationSettings,h=e.user.userSettings,f=Object(s.h)(e,u.entityTypeName);let m=a;return p&&p.isCustomSrc?p.Url:(null!=p&&null!=p.Data&&(m=O(m,"data",p.Data)),null!=p&&p.PassParameters&&"true"===p.PassParameters.toLocaleLowerCase()&&(m=O(m,"id",u.id?u.id.guid:""),m=O(m,"typename",u.entityTypeName),m=0!==f.ObjectTypeCode?O(m,"type",f.ObjectTypeCode):m,m=O(m,"orgname",g.organizationUniqueName),m=O(m,"OrgLCID",g.orgCultureInfoLCID.toString()),m=O(m,"UserLCID",h.languageId.toString())),m)}},"3ri3":function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"h",(function(){return a})),n.d(t,"n",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"k",(function(){return c})),n.d(t,"i",(function(){return l})),n.d(t,"l",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"o",(function(){return p})),n.d(t,"m",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return f})),n.d(t,"x",(function(){return m})),n.d(t,"y",(function(){return b})),n.d(t,"z",(function(){return _})),n.d(t,"G",(function(){return y})),n.d(t,"H",(function(){return v})),n.d(t,"D",(function(){return S})),n.d(t,"E",(function(){return O})),n.d(t,"B",(function(){return C})),n.d(t,"F",(function(){return E})),n.d(t,"C",(function(){return I})),n.d(t,"A",(function(){return w})),n.d(t,"w",(function(){return j})),n.d(t,"p",(function(){return P})),n.d(t,"eb",(function(){return T})),n.d(t,"u",(function(){return N})),n.d(t,"M",(function(){return A})),n.d(t,"J",(function(){return D})),n.d(t,"K",(function(){return R})),n.d(t,"L",(function(){return x})),n.d(t,"N",(function(){return M})),n.d(t,"q",(function(){return F})),n.d(t,"e",(function(){return k})),n.d(t,"r",(function(){return L})),n.d(t,"ab",(function(){return B})),n.d(t,"U",(function(){return U})),n.d(t,"S",(function(){return V})),n.d(t,"X",(function(){return z})),n.d(t,"Z",(function(){return W})),n.d(t,"Y",(function(){return q})),n.d(t,"V",(function(){return H})),n.d(t,"T",(function(){return G})),n.d(t,"W",(function(){return K})),n.d(t,"bb",(function(){return Q})),n.d(t,"P",(function(){return X})),n.d(t,"R",(function(){return Y})),n.d(t,"Q",(function(){return J})),n.d(t,"db",(function(){return $})),n.d(t,"O",(function(){return Z})),n.d(t,"t",(function(){return ee})),n.d(t,"s",(function(){return te})),n.d(t,"I",(function(){return ne})),n.d(t,"c",(function(){return re})),n.d(t,"v",(function(){return ae})),n.d(t,"cb",(function(){return ie}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Id",a="Name",i="Status",o="ActionData",s="CreatedOn",c="Id",l="CommandId",u="Operation",d="EntityName",p="Command",g="CommandOperation",h="businessprocessflowinstance",f="businessprocessflowinstanceid",m="_NORSYNC_LOG_businessprocessflowinstance",b="_NORSYNC_LOG_Command",_="_NORSYNC_LOG_commandoperation",y="_NORSYNC_LOG__upsynctransaction_begin",v="_NORSYNC_LOG__upsynctransaction_end",S="_NORSYNC_MAIN_LOG_TABLE",O="NORSYNC_SID",C="NORSYNC_LOG_SID",E="NORSYNC_TABLE_ID",I="NORSYNC_LOG_TYPE",w="_NORSYNC_LOG_",j="norsync",P=1,T=3,N="lastsuccessfulsaveoncrm",A="SID",D="DEVICE_ID",R="LOG_TABLE_ID",x="OPERATION_TYPE",M="TIME_STAMP",F="crudCommandActionData",k="commandName",L="data",B="_NORSYNC_LOG_syncerror",U="name",V="action",z="regardingobjectid",W="regardingobjectidname",q="regardingobjecttypecode",H="errormessage",G="actiondata",K="errortime",Q="requestdata",X="errorcode",Y="errortype",J="errordetail",$="traversedpath",Z="stageid",ee="entitylogicalname",te="entityid",ne="processid",re="ChangeProcessAndStage",ae="_MODIFIED_ON",ie="SyncErrorFailureMap"},"3rse":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Shift=16]="Shift",e[e.Ctrl=17]="Ctrl",e[e.Alt=18]="Alt",e[e.PauseBreak=19]="PauseBreak",e[e.Capslock=20]="Capslock",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.LeftArrow=37]="LeftArrow",e[e.UpArrow=38]="UpArrow",e[e.RightArrow=39]="RightArrow",e[e.DownArrow=40]="DownArrow",e[e.Insert=45]="Insert",e[e.Delete=46]="Delete",e[e.Num0=48]="Num0",e[e.Num1=49]="Num1",e[e.Num2=50]="Num2",e[e.Num3=51]="Num3",e[e.Num4=52]="Num4",e[e.Num5=53]="Num5",e[e.Num6=54]="Num6",e[e.Num7=55]="Num7",e[e.Num8=56]="Num8",e[e.Num9=57]="Num9",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.LeftWindowKey=91]="LeftWindowKey",e[e.RightWindowKey=92]="RightWindowKey",e[e.SelectKey=93]="SelectKey",e[e.NumPad0=96]="NumPad0",e[e.NumPad1=97]="NumPad1",e[e.NumPad2=98]="NumPad2",e[e.NumPad3=99]="NumPad3",e[e.NumPad4=100]="NumPad4",e[e.NumPad5=101]="NumPad5",e[e.NumPad6=102]="NumPad6",e[e.NumPad7=103]="NumPad7",e[e.NumPad8=104]="NumPad8",e[e.NumPad9=105]="NumPad9",e[e.Multiply=106]="Multiply",e[e.Add=107]="Add",e[e.Subtract=109]="Subtract",e[e.DecimalPoint=110]="DecimalPoint",e[e.Divide=111]="Divide",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NumLock=144]="NumLock",e[e.ScrollLock=145]="ScrollLock",e[e.SemiColon=186]="SemiColon",e[e.EqualSign=187]="EqualSign",e[e.Comma=188]="Comma",e[e.Dash=189]="Dash",e[e.Period=190]="Period",e[e.ForwardSlash=191]="ForwardSlash",e[e.GraveAccent=192]="GraveAccent",e[e.OpenBracket=219]="OpenBracket",e[e.BackSlash=220]="BackSlash",e[e.CloseBraket=221]="CloseBraket",e[e.SingleQuote=222]="SingleQuote"}(r||(r={}))},"3sOn":function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n("ufH1"),a=n("84PK"),i=n("504W"),o=n("Div0"),s=n("rO1J"),c=n("ngzy"),l=n("j63P"),u=n("P74A"),d=n("gvQo"),p=n("/KPo"),g=n("/XAI"),h=n("xP3K"),f=n("FKgA"),m=n("2qvm");class b{constructor(e,t,n,r,o,s,l,u,d,g,h,f,m,_,y,v,S,O,C,E,I,w,j){this._userId=null,this._userRoles=null,this._parentRootRoles=null,this._roleNames=null,this._organizationSettings=null,this._personalizationSettings=null,this._offlineProfile=null,this._userSettings=null,this._rolePrivileges=null,this._attributePrivileges=null,this._serverContext=null,this._fullServerVersion=null,this._externalContext=null,this._fcbContext=null,this._metadataLastModifiedTime=null,this._userMetadataLastModifiedTime=null,this._transactionCurrencyId=null,this._userName=null,this._userEmail=null,this._isErrorContext=!1,this._errorCode=0,this._isValid=!1,this._isSecured=!1,this._defaultDashboardId=null,this._defaultHomepageId=null,this._defaultInteractionCentricDashboardId=null,this._environmentId=null,this._userId=Object(i.a)(e)?a.a.get_empty():e,this._userName=Object(i.b)(t)?"":t,this._userEmail=Object(i.b)(n)?"":n,this._userRoles=Object(i.a)(r)?new Array(0):r,this._parentRootRoles=Object(i.a)(o)?new Array(0):o,this._organizationSettings=Object(i.a)(s)?b._GetEmptyOrganizationSettings():s,this._userSettings=Object(i.a)(l)?b._GetEmptyUserSettings():l,this._rolePrivileges=Object(i.a)(u)?{}:u,this._attributePrivileges=Object(i.a)(d)?{}:d,this._serverContext=Object(i.a)(g)?new p.a("",""):g,this._roleNames=Object(i.a)(h)?new Array(0):h,this._metadataLastModifiedTime=Object(i.b)(f)?"":f,this._userMetadataLastModifiedTime=Object(i.b)(m)?"":m,this._transactionCurrencyId=Object(i.a)(_)?a.a.get_empty():_,this._defaultDashboardId=Object(i.a)(y)?a.a.get_empty():y,this._defaultHomepageId=Object(i.a)(v)?a.a.get_empty():v,this._defaultInteractionCentricDashboardId=Object(i.a)(S)?a.a.get_empty():S,this._fullServerVersion=Object(i.b)(O)?"":O,this._offlineProfile=Object(i.a)(C)?new c.a(a.a.get_empty(),[],""):C,this._externalContext=Object(i.a)(E)?{}:E,this._fcbContext=Object(i.a)(I)?{}:I,this._environmentId=Object(i.a)(j)?a.a.get_empty():j,this._isValid=this._userRoles.length>0,this._isSecured=!1,this._personalizationSettings=Object(i.a)(w)?b._GetEmptySelectedFormsByEntitySettings():w}get_DefaultSearchExperience(){return this.get_UserSettings().get_defaultSearchExperience()}get_UserId(){return this._userId}get_UserEmail(){return this._userEmail}get_TransactionCurrencyId(){return this._transactionCurrencyId}get_UserName(){return this._userName}get_userRoles(){return this._userRoles}get_parentRootRoles(){return this._parentRootRoles}get_roleNames(){return this._roleNames}get_UserRolesToNames(){if(!Object(i.a)(this.get_userRoles())){const e={};for(let t=0;t<this.get_userRoles().length;t++)e[this.get_userRoles()[t].toString()]=this.get_roleNames()[t];return e}return{}}get_organizationSettings(){return this._organizationSettings}get_personalizationSettings(){return this._personalizationSettings}get_UserSettings(){return this._userSettings}get_rolePrivileges(){return this._rolePrivileges}get_UserRolePrivileges(){return Object(i.a)(this._rolePrivileges)?{}:this._rolePrivileges}get_attributePrivileges(){return this._attributePrivileges}get_UserAttributePrivileges(){return Object(i.a)(this._attributePrivileges)?{}:this._attributePrivileges}get_serverContext(){return this._serverContext}get_externalContext(){return this._externalContext}get_TransactionCurrencyById(){return Object(i.a)(this.get_externalContext())||Object(i.a)(this.get_externalContext()[b.transactionCurrencyByIdExternalContextField])?{}:this.get_externalContext()[b.transactionCurrencyByIdExternalContextField]}get_IsLive(){return this.get_externalContext()[b.isLiveExternalContextField]}get_IsOsdpOrganization(){return this.get_externalContext()[b.isOsdpOrganizationExternalContextField]}get_UsePathBasedUrls(){return this.get_externalContext()[b.usePathBasedUrlsExternalContextField]}get_TimeZoneDefinitionByCode(){return Object(i.a)(this.get_externalContext()[b.timeZoneDefinitionByCodeExternalContextField])?{}:this.get_externalContext()[b.timeZoneDefinitionByCodeExternalContextField]}get_FCBContext(){return this._fcbContext}get_MetadataLastModifiedTime(){return this._metadataLastModifiedTime}set_MetadataLastModifiedTime(e){return this._metadataLastModifiedTime=e,e}get_UserMetadataLastModifiedTime(){return this._userMetadataLastModifiedTime}get_isErrorContext(){return this._isErrorContext}get_ErrorCode(){return this._errorCode}get_DefaultDashboardId(){return this._defaultDashboardId}get_DefaultHomepageId(){return this._defaultHomepageId}get_DefaultInteractionCentricDashboardId(){return this._defaultInteractionCentricDashboardId}get_EnvironmentId(){return this._environmentId}getObjectData(){const e={};if(e.userid=this._userId.getObjectData(),e.username=this._userName,e.iserrorcontext=this._isErrorContext,e.errorcode=this._errorCode,e.isvalid=this._isValid,e.issecured=this._isSecured,!this._isValid)return e;e.rolenames=this._roleNames,e.userroles=this._userRoles.map(e=>e.getObjectData()),e.organizationsettings=this._organizationSettings.getObjectData(),e.personalizationSettings=this._personalizationSettings.getObjectData(),e.offlineprofile=this._offlineProfile.getObjectData(),e.usersettings=this._userSettings.getObjectData(),e.servercontext=this._serverContext.getObjectData(),e.fullserverversion=this._fullServerVersion,e.metadatalastmodifiedtime=this._metadataLastModifiedTime,e.usermetadatalastmodifiedtime=this._userMetadataLastModifiedTime,e.transactioncurrencyid=this._transactionCurrencyId.getObjectData(),e.defaultdashboardid=this._defaultDashboardId.getObjectData(),e.defaulthomepageid=this._defaultHomepageId.getObjectData(),e.defaultinteractioncentricdashboardid=this._defaultInteractionCentricDashboardId.getObjectData();const t=[];if(this._rolePrivileges&&Object.keys(this._rolePrivileges).length>0){const e=this._rolePrivileges;for(const n in e){const r={key:n,value:e[n]};t.push(r.value.getObjectData())}}else Object(r.e)("UserContext.GetObjectData:",o.a.storage,"rolePrivileges is null or empty");e.roleprivileges=t;const n=[];if(this._attributePrivileges&&Object.keys(this._attributePrivileges).length>0){const e=this._attributePrivileges;for(const t in e){const r={key:t,value:e[t]};n.push(r.value.getObjectData())}}else Object(r.e)("UserContext.GetObjectData:",o.a.storage,"attributePrivileges is null or empty");e.attributeprivileges=n;const a={},i={},s=this._externalContext[b.transactionCurrencyByIdExternalContextField];if(s&&Object.keys(s).length>0){const e=s;for(const t in e){const n={key:t,value:e[t]};i[n.key]=n.value.getObjectData()}}else Object(r.e)("UserContext.GetObjectData:",o.a.storage," externalContext Does not have any TransactionCurrency");a[b.transactionCurrencyByIdExternalContextField]=i;const c={},l=this._externalContext[b.timeZoneDefinitionByCodeExternalContextField];if(l&&Object.keys(l).length>0){const e=l;for(const t in e){const n={key:t,value:e[t]};c[n.key]=n.value.getObjectData()}}else Object(r.e)("UserContext.GetObjectData:",o.a.storage," externalContext Does not have any TimeZoneDefinitions");a[b.timeZoneDefinitionByCodeExternalContextField]=c,a[b.isLiveExternalContextField]=this._externalContext[b.isLiveExternalContextField],a[b.isOsdpOrganizationExternalContextField]=this._externalContext[b.isOsdpOrganizationExternalContextField],a[b.usePathBasedUrlsExternalContextField]=this._externalContext[b.usePathBasedUrlsExternalContextField],e.externalcontext=a;const u={},d=this._fcbContext;for(const e in d){const t={key:e,value:d[e]}.value;u[t.get_featureName()]=t.getObjectData()}return e.fcbcontext=u,e}getTransactionCurrency(e){const t=this.get_externalContext()[b.transactionCurrencyByIdExternalContextField],n=Object(i.a)(e)?"":e.toString();return n in t?t[n]:null}get_LanguageId(){return this.get_UserSettings().get_languageId()}get_UserCultureLcid(){return this.get_UserSettings().get_userCultureLcid()}get_userCultureName(){return this.get_UserSettings().get_userCultureName()}get_IsFarEastLanguage(){return this.get_UserSettings().get_isFarEastLanguage()}get_TimeZoneUtcOffsetMinutes(){return this.get_UserSettings().get_timeZoneUtcOffsetMinutes()}get_TimeZoneAdjusters(){return this.get_UserSettings().get_timeZoneAdjusters()}get_UserReportScriptErrors(){return this.get_UserSettings().get_reportScriptErrors()}get_SavedFilters(){return this.get_UserSettings().get_savedfilters()}get_DefaultSavedFilter(){return this.get_UserSettings().get_defaultSavedFilter()}get_NumberFormatInfo(){return this.get_UserSettings().get_numberFormatInfo()}get_DateTimeFormatInfo(){return this.get_UserSettings().get_dateTimeFormatInfo()}get_ShowCalendarWeeks(){return this.get_UserSettings().get_showCalendarWeeks()}get_FormatInfoCultureName(){return this.get_UserSettings().get_formatInfoCultureName()}get_IsRTL(){return this.get_UserSettings().get_isRTL()}get_IsHighContrastEnabled(){return this.get_UserSettings().get_isHighContrastEnabled()}get_IsAdmin(){return this.get_UserSettings().get_isAdmin()}get_IsCustomizer(){return this.get_UserSettings().get_isCustomizer()}get_IsEmailConversationViewEnabled(){return this.get_UserSettings().get_isEmailConversationViewEnabled()}get_WorkDayStartTime(){return this.get_UserSettings().get_workDayStartTime()}get_AutoCaptureUserStatus(){return this.get_UserSettings().get_AutoCaptureUserStatus()}get_IsAutoSaveEnabled(){return this.get_organizationSettings().get_isAutoSaveEnabled()}get_AppointmentRichEditorExperience(){return this.get_organizationSettings().get_appointmentRichEditorExperience()}get_WebServiceCallRetryPolicies(){return this.get_organizationSettings().get_webServiceCallRetryPolicies()}get_FiscalCalendarStart(){return this.get_organizationSettings().get_fiscalCalendarStart()}get_DefaultCountryCode(){return this.get_organizationSettings().get_defaultCountryCode()}get_GeoName(){return this.get_organizationSettings().get_geoName()}get_FullNameConventionCode(){return this.get_organizationSettings().get_fullNameConventionCode()}get_PricingDecimalPrecision(){return this.get_organizationSettings().get_pricingDecimalPrecision()}get_OrganizationUniqueName(){return this.get_organizationSettings().get_organizationUniqueName()}get_SelectedFormsByEntity(){return this.get_personalizationSettings().get_selectedFormsByEntity()}get_NorsyncServerConnectionString(){return this.get_organizationSettings().get_norsyncServerConnectionString()}get_CurrentThemeData(){return this.get_organizationSettings().get_currentThemeData()}get_DelveUrl(){return this.get_organizationSettings().get_delveUrl()}get_KmUseExternalPortal(){return this.get_organizationSettings().get_kmUseExternalPortal()}get_KmExternalPortalUrl(){return this.get_organizationSettings().get_kmExternalPortalUrl()}get_MaxIncidentMergeNumber(){return this.get_organizationSettings().get_maxIncidentMergeNumber()}get_MaxChildIncidentNumber(){return this.get_organizationSettings().get_maxChildIncidentNumber()}get_IsConflictDetectionEnabledForMobileClient(){return this.get_organizationSettings().get_isConflictDetectionEnabledForMobileClient()}get_IsDuplicateDetectionEnabledForOnlineCreateUpdate(){return this.get_organizationSettings().get_isDuplicateDetectionEnabledForOnlineCreateUpdate()}get_IsParature(){return this.get_organizationSettings().get_isParature()}get_IsKMConfigured(){return this.get_organizationSettings().get_isKMConfigured()}get_MobileOfflineSyncInterval(){return this.get_organizationSettings().get_mobileOfflineSyncInterval()}get_OverrideTrackInCrmBehavior(){return this.get_organizationSettings().get_overrideTrackInCrmBehaviour()}get_ShowWeekNumber(){return this.get_organizationSettings().get_showWeekNumber()}get_IsMocaOfflineFeatureEnabled(){return this.get_organizationSettings().get_isMocaOfflineFeatureEnabled()}get_IsSOPIntegrationEnabled(){return this.get_organizationSettings().get_isSOPIntegrationEnabled()}get_IsTelemeteryEnabled(){return this.get_organizationSettings().get_isTelemetryEnabled()}get_UseSkypeProtocol(){return this.get_organizationSettings().get_useSkypeProtocol()}get_FiscalPeriodFormatPeriod(){return this.get_organizationSettings().get_fiscalPeriodFormatPeriod()}get_FiscalPeriodType(){return this.get_organizationSettings().get_fiscalPeriodType()}get_FiscalYearFormatYear(){return this.get_organizationSettings().get_fiscalYearFormatYear()}get_FiscalYearFormatPrefix(){return this.get_organizationSettings().get_fiscalYearFormatPrefix()}get_FiscalYearFormatSuffix(){return this.get_organizationSettings().get_fiscalYearFormatSuffix()}get_FiscalYearDisplayCode(){return this.get_organizationSettings().get_fiscalYearDisplayCode()}get_FiscalPeriodConnector(){return this.get_organizationSettings().get_fiscalPeriodConnector()}get_LanguageCode(){return this.get_organizationSettings().get_languageCode()}get_OrgCultureInfoLcid(){return this.get_organizationSettings().get_orgCultureInfoLcid()}get_OrganizationId(){return this.get_organizationSettings().get_organizationId()}get_OrganizationName(){return this.get_organizationSettings().get_organizationName()}get_BlockedAttachments(){return this.get_organizationSettings().get_blockedAttachments()}get_MaxUploadFileSize(){return this.get_organizationSettings().get_maxUploadFileSize()}get_OrganizationReportScriptErrors(){return this.get_organizationSettings().get_reportScriptErrors()}get_IsDuplicateDetectionEnabled(){return this.get_organizationSettings().get_isDuplicateDetectionEnabled()}get_CurrencyDisplayOption(){return this._organizationSettings.get_currencyDisplayOption()}get_EnabledLanguages(){return this._organizationSettings.get_enabledLanguages()}get_BaseCurrencyId(){return this.get_organizationSettings().get_baseCurrencyId()}get_WebResourceHash(){return this._organizationSettings.get_webResourceHash()}get_IsPowerBIEnabled(){return this._organizationSettings.get_isPowerBIEnabled()}get_FirstPartyIntegrationSiteUrl(){return this._organizationSettings.get_firstPartyIntegrationSiteUrl()}get_IsTrialOrganization(){return this._organizationSettings.get_isTrialOrganization()}get_OfflineProfileId(){return this._offlineProfile.get_profileId()}get_OfflineProfileVersion(){return this._offlineProfile.get_profileVersion()}get_OfflineProfileAvailableEntities(){return this._offlineProfile.get_offlineAvailableEntities()}get_ServerVersion(){return this.get_serverContext().get_serverVersion()}get_ServerDatabaseVersion(){return this.get_serverContext().get_databaseVersion()}get_fullServerVersion(){return this._fullServerVersion}get_EnableLPAuthoring(){return this._organizationSettings.get_enableLPAuthoring()}get_IsContextualHelpEnabled(){return this._organizationSettings.get_isContextualHelpEnabled()}get_IsMicrosoftFlowEnabled(){return this._organizationSettings.get_isMicrosoftFlowEnabled()}get_MicrosoftFlowFirstPartyIntegrationSiteUrl(){return this._organizationSettings.get_microsoftFlowFirstPartyIntegrationSiteUrl()}get_MicrosoftFlowDestinationUrl(){return this._organizationSettings.get_microsoftFlowDestinationUrl()}get_MicrosoftFlowEnvironmentId(){return this._organizationSettings.get_microsoftFlowEnvironmentId()}get_IsExternalSearchIndexEnabled(){return this._organizationSettings.get_isExternalSearchIndexEnabled()}get_SharePointDeploymentType(){return this._organizationSettings.get_sharePointDeploymentType()}get_IsOneDriveEnabled(){return this._organizationSettings.get_isOneDriveEnabled()}get_IsMSTeamsEnabled(){return this._organizationSettings.get_isMSTeamsEnabled()}get_IsContextualEmailEnabled(){return this._organizationSettings.get_isContextualEmailEnabled()}get_IsRichTextNotesEnabled(){return this._organizationSettings.get_isRichTextNotesEnabled()}get_IsAutoDataCaptureV2Enabled(){return this._organizationSettings.get_isAutoDataCaptureV2Enabled()}get_IsManualSalesForecastingEnabled(){return this._organizationSettings.get_isManualSalesForecastingEnabled()}get_IsActionCardEnabled(){return this._organizationSettings.get_isActionCardEnabled()}get_EnableImmersiveSkypeIntegration(){return this._organizationSettings.get_enableImmersiveSkypeIntegration()}get_IsEmailMonitoringAllowed(){return this._organizationSettings.get_isEmailMonitoringAllowed()}get_AllowUnresolvedPartiesOnEmailSend(){return this._organizationSettings.get_allowUnresolvedPartiesOnEmailSend()}get_IsPresenceEnabled(){return this._organizationSettings.get_isPresenceEnabled()}get_DefaultGridViews(){return this.get_UserSettings().get_defaultGridViews()}get_SelectedGlobalFilterId(){return this.get_UserSettings().get_selectedGlobalFilterId()}get_BoundDashboardDefaultCardExpanded(){return this.get_organizationSettings().get_boundDashboardDefaultCardExpanded()}get_IsPreviewOrganization(){return this._organizationSettings.get_isPreviewOrganization()}get_IsSandboxOrganization(){return this.get_organizationSettings().get_isSandboxOrganization()}get_IsSovereignCloud(){return this.get_organizationSettings().get_isSovereignCloud()}get_AdvancedDebuggabilitySettings(){return this.get_organizationSettings().get_advancedDebuggabilitySettings()}get_LogoImagePath(){return this.get_organizationSettings().get_logoImagePath()}get_LogoTooltip(){return this.get_organizationSettings().get_logoTooltip()}get_SessionTimeoutInSeconds(){return this.get_organizationSettings().get_sessionTimeoutInSeconds()}get_SessionTimeoutReminderInSeconds(){return this.get_organizationSettings().get_sessionTimeoutReminderInSeconds()}get_InactivityTimeoutInSeconds(){return this.get_organizationSettings().get_inactivityTimeoutInSeconds()}get_InactivityTimeoutReminderInSeconds(){return this.get_organizationSettings().get_inactivityTimeoutReminderInSeconds()}get_OfficePortalUrl(){return this._organizationSettings.get_officePortalUrl()}get_PpacSettingsUrl(){return this._organizationSettings.get_ppacSettingsUrl()}get_CustomizationUrl(){return this._organizationSettings.get_customizationUrl()}get_IsCrmOrg(){return this._organizationSettings.get_isCrmOrg()}get_YammerGroupId(){return this._organizationSettings.get_yammerGroupId()}get_YammerNetworkName(){return this._organizationSettings.get_yammerNetworkName()}get_YammerOAuthAccessTokenExpired(){return this._organizationSettings.get_yammerOAuthAccessTokenExpired()}get_YammerPostMethod(){return this._organizationSettings.get_yammerPostMethod()}get_EnableBingMapsIntegration(){return this._organizationSettings.get_enableBingMapsIntegration()}get_BingMapsApiKey(){return this._organizationSettings.get_bingMapsApiKey()}get_AvailableBingMapLocales(){return this._organizationSettings.get_availableBingMapLocales()}get_ExcludedCountriesForMaps(){return this._organizationSettings.get_excludedCountriesForMaps()}get_BFDatacenter(){return this._organizationSettings.get_bfDatacenter()}get_AllowLegacyDialogsEmbedding(){return this.get_organizationSettings().get_allowLegacyDialogsEmbedding()}get_AllowLegacyClientExperience(){return this.get_organizationSettings().get_allowLegacyClientExperience()}get_EnableUnifiedInterfaceShellRefresh(){return this.get_organizationSettings().get_enableUnifiedInterfaceShellRefresh()}get_GlobalHelpUrl(){return this.get_organizationSettings().get_globalHelpUrl()}get_GlobalHelpUrlEnabled(){return this.get_organizationSettings().get_globalHelpUrlEnabled()}get_GlobalAppendUrlParametersEnabled(){return this.get_organizationSettings().get_globalAppendUrlParametersEnabled()}get_PrivacyStatementUrl(){return this.get_organizationSettings().get_privacyStatementUrl()}get_OrganizationTenant(){return this.get_organizationSettings().get_organizationTenant()}get_SecuritySettingForEmail(){return this.get_organizationSettings().get_securitySettingForEmail()}get_EnableActivitiesTimeLinePerfImprovement(){return this.get_organizationSettings().get_enableActivitiesTimeLinePerfImprovement()}get_GridTotalRecordCountLimit(){return this._organizationSettings.get_gridTotalRecordCountLimit()}get_EnableLivePersonaCardUCI(){return this.get_organizationSettings().get_enableLivePersonaCardUCI()}get_LivePersonaCardComplianceEnvironment(){return this.get_organizationSettings().get_livePersonaCardComplianceEnvironment()}get_LivePersonaCardCulture(){return this.get_organizationSettings().get_livePersonaCardCulture()}get_LivePersonaCardFirstPartyIntegrationUrl(){return this.get_organizationSettings().get_livePersonaCardFirstPartyIntegrationUrl()}get_LivePersonaCardRegion(){return this.get_organizationSettings().get_livePersonaCardRegion()}get_DefaultCrmCustomName(){return this.get_organizationSettings().get_defaultCrmCustomName()}get_AreJquery3IncompatibleSolutionsInstalled(){return this.get_organizationSettings().get_areJquery3IncompatibleSolutionsInstalled()}get_UseQuickFindViewForGridSearch(){return this.get_organizationSettings().get_useQuickFindViewForGridSearch()}get_NewSearchExperienceEnabled(){return this.get_organizationSettings().get_newSearchExperienceEnabled()}get_ImproveSearchLoggingEnabled(){return this.get_organizationSettings().get_improveSearchLoggingEnabled()}static createErrorContext(e,t){const n=e?new b(e._userId,e._userName,e._userEmail,e._userRoles,e._parentRootRoles,e._organizationSettings,e._userSettings,e._rolePrivileges,e._attributePrivileges,e._serverContext,e._roleNames,e._metadataLastModifiedTime,e._userMetadataLastModifiedTime,e._transactionCurrencyId,e._defaultDashboardId,e._defaultHomepageId,e._defaultInteractionCentricDashboardId,e._fullServerVersion,e._offlineProfile,e.get_externalContext(),e.get_FCBContext(),e._personalizationSettings,e._environmentId):new b(a.a.get_empty(),"","",null,null,null,null,null,null,null,null,"","",a.a.get_empty(),a.a.get_empty(),a.a.get_empty(),a.a.get_empty(),"",null,null,null,null,null);return n._isErrorContext=!0,n._errorCode=t,n}static createSecureContext(e){const t=e?new b(e._userId,e._userName,e._userEmail,e._userRoles,e._parentRootRoles,e._organizationSettings,e._userSettings,e._rolePrivileges,e._attributePrivileges,e._serverContext,e._roleNames,e._metadataLastModifiedTime,e._userMetadataLastModifiedTime,e._transactionCurrencyId,e._defaultDashboardId,e._defaultHomepageId,e._defaultInteractionCentricDashboardId,e._fullServerVersion,e._offlineProfile,e.get_externalContext(),e.get_FCBContext(),e.get_personalizationSettings(),e.get_EnvironmentId()):new b(a.a.get_empty(),"","",null,null,null,null,null,null,null,null,"","",a.a.get_empty(),a.a.get_empty(),a.a.get_empty(),a.a.get_empty(),"",null,null,null,null,null);return t._userName="",t._isSecured=!0,t}static createFromObjectData(e){const t=e.userid?a.a.createFromObjectData(e.userid):a.a.get_empty(),n=e.username,_=e.userEmail,y=e.iserrorcontext,v=e.errorcode,S=e.isvalid,O=e.issecured;if(!S)return b.createErrorContext(null,v);const C=e.rolenames,E=e.userroles.map(e=>a.a.createFromObjectData(e));let I=[];Object(i.a)(e.parentrootroles)||(I=e.parentrootroles.map(e=>a.a.createFromObjectData(e)));const w=l.a.createFromObjectData(e.organizationsettings),j=Object(i.a)(e.personalizationSettings)?b._GetEmptySelectedFormsByEntitySettings():u.a.createFromObjectData(e.personalizationSettings),P=f.a.createFromObjectData(e.usersettings),T=p.a.createFromObjectData(e.servercontext),N=c.a.createFromObjectData(e.offlineprofile),A=e.fullserverversion,D={};for(const t of e.roleprivileges){const e=d.a.createFromObjectData(t);D[e.get_privilegeId().toString()]=e}const R={};for(const t of e.attributeprivileges){const e=s.a.createFromObjectData(t);R[e.get_AttributeId().toString()]=e}const x=e.metadatalastmodifiedtime,M=e.usermetadatalastmodifiedtime,F=e.transactioncurrencyid?a.a.createFromObjectData(e.transactioncurrencyid):a.a.get_empty(),k=e.defaultdashboardid?a.a.createFromObjectData(e.defaultdashboardid):a.a.get_empty(),L=e.defaulthomepageid?a.a.createFromObjectData(e.defaulthomepageid):a.a.get_empty(),B=e.defaultinteractioncentricdashboardid?a.a.createFromObjectData(e.defaultinteractioncentricdashboardid):a.a.get_empty(),U=e.environmentId?a.a.createFromObjectData(e.environmentId):a.a.get_empty(),V=e.externalcontext,z={},W={},q=V[b.transactionCurrencyByIdExternalContextField];for(const e in q){const t={key:e,value:q[e]};W[t.key]=h.a.createFromObjectData(t.value)}z[b.transactionCurrencyByIdExternalContextField]=W;const H={};if(V[b.timeZoneDefinitionByCodeExternalContextField]){const e=V[b.timeZoneDefinitionByCodeExternalContextField];for(const t in e){const n={key:t,value:e[t]};H[n.key]=g.a.createFromObjectData(n.value)}}else Object(r.e)("UserContext.CreateFromObjectData:",o.a.storage," SerializedExternalContext Does not have any TimeZoneDefinitions");z[b.timeZoneDefinitionByCodeExternalContextField]=H,z[b.isLiveExternalContextField]=V[b.isLiveExternalContextField],z[b.isOsdpOrganizationExternalContextField]=V[b.isOsdpOrganizationExternalContextField],z[b.usePathBasedUrlsExternalContextField]=V[b.usePathBasedUrlsExternalContextField];const G=e.fcbcontext,K={};for(const e in G){const t={key:e,value:G[e]},n=m.a.createFromObjectData(t.value);Object(i.a)(n)||(K[n.get_featureName()]=n)}let Q=new b(t,n,_,E,I,w,P,D,R,T,C,x,M,F,k,L,B,A,N,z,K,j,U);return y&&(Q=b.createErrorContext(Q,v)),O&&(Q=b.createSecureContext(Q)),Q}static _GetEmptyOrganizationSettings(){return new l.a(a.a.get_empty(),"",0,null,0,"",0,0,!1,!1,!1,0,0,new Date,0,0,0,0,0,0,"",!1,a.a.get_empty(),"",!1,"","",0,!1,!1,0,"",!1,!1,"","","",0,0,0,0,"",!1,"",!1,!1,0,0,!1,"",!1,"",!1,!1,!1,"",!1,"","",0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,"","",!0,0,"",!0,0,!1,!1,"","","",!1,!1,!0,!1,"","",null,1,0,5e3,!1,"","","","",!1,!1,!1,!1,"",!1,"","",!1,!1)}static _GetEmptySelectedFormsByEntitySettings(){return new u.a(new Array(0))}static _GetEmptyUserSettings(){return new f.a(0,0,"","",null,null,0,null,0,0,!1,!1,!1,0,null,null,!1,!1,null,null,!1,null,0)}}b.transactionCurrencyByIdExternalContextField="transactioncurrencybyid",b.timeZoneDefinitionByCodeExternalContextField="timezonedefinitionbycode",b.isLiveExternalContextField="islive",b.isOsdpOrganizationExternalContextField="isosdporganization",b.usePathBasedUrlsExternalContextField="usepathbasedurls",b.entityMetadataSyncConfigurationExternalContextField="entitymetadatasyncconfiguration"},"3tOH":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.error="ERROR",e.warning="WARNING",e.information="INFO",e.localSave="LOCALSAVE",e.recommendation="RECOMMENDATION"}(r||(r={}))},"3umU":function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var r=n("nfLm"),a=n("HkYq"),i=n("504W"),o=n("NMtn"),s=n("eYZY"),c=n("cgR4"),l=n("8tWD"),u=n("/bjP"),d=n("xAYq"),p=n("jZCH"),g=n("qCX6"),h=n("JPoD"),f=n("UDbe"),m=n("ufH1"),b=n("Div0");class _{constructor(e){this._id=null,this._metadataType=0,this._metadataSubtype=0,this._formFactor=0,this._isDefault=!1,this._associatedEntityLogicalName=null,this._displayName=null,this._sourceId=null,this._isUserRecord=!1,this._descriptorData=null,this._dependencyData=null,this._isDescriptorDataDeserialized=!1,Object(o.d)(e,"fields"),Object(o.d)(e[s.a],'fields["'+s.a+'"]'),Object(o.d)(e[s.j],'fields["'+s.j+'"]'),Object(o.d)(e[s.f],'fields["'+s.f+'"]'),Object(o.d)(e[s.c],'fields["'+s.c+'"]'),this._id=e[s.a],this._metadataType=e[s.j],this._metadataSubtype=e[s.i],this._formFactor=e[s.f],this._sourceId=e[s.k],this._isDescriptorDataDeserialized=!1,this._descriptorData=e[s.c],this._dependencyData=e[s.d],this._isDefault=s.g in e&&e[s.g],this._associatedEntityLogicalName=s.b in e?e[s.b]:null,this._displayName=s.e in e?e[s.e]:null,this._sourceId=s.k in e?e[s.k]:null,this._isUserRecord=s.h in e&&e[s.h],this._metadataType===a.a.savedView&&e[s.c]&&!e[s.c].OfflineSqlQuery&&Object(m.e)("ApplicationMetadata_constructor",b.a.storage,`SavedView application metadata created without offline SQL query for Id: ${this._id}, Entity: ${this._associatedEntityLogicalName}, Subtype: ${this._metadataSubtype}, Source Id: ${this._sourceId}, Display Name: ${this._displayName}}`)}get_metadataType(){return this._metadataType}get_metadataSubtype(){return this._metadataSubtype}get_formFactor(){return this._formFactor}get_isDefault(){return this._isDefault}get_AssociatedEntityLogicalName(){return this._associatedEntityLogicalName}get_DisplayName(){return this._displayName}get_metadata(){if(!Object(i.a)(this._descriptorData)){if(this._metadataType===a.a.fetchXml)return this.get_descriptorSet().tryGetDescriptor(l.a.FetchXml);if(this._metadataType!==a.a.layoutXml&&this._metadataType!==a.a.webResource&&this._metadataType!==a.a.businessLogic&&this._metadataType!==a.a.staticJSFile&&this._metadataType!==a.a.applicationMetadataUserContext)return this.get_descriptorSet().tryGetDescriptor(0)}return this._descriptorData}get_descriptorSet(){if(!this._isDescriptorDataDeserialized){if(this._metadataType!==a.a.layoutXml&&this._metadataType!==a.a.webResource&&this._metadataType!==a.a.businessLogic&&this._metadataType!==a.a.staticJSFile&&this._metadataType!==a.a.applicationMetadataUserContext&&this._metadataType!==a.a.commandXaml){const e=this._metadataType!==a.a.fetchXml||g.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(this.get_AssociatedEntityLogicalName());if(this._descriptorData=u.a.createDescriptorSet(JSON.parse(this._descriptorData),this._metadataType,e),this.get_metadataType()===a.a.fetchXml){let e=this._descriptorData.tryGetDescriptor(l.a.Sql);if(!Object(i.b)(e))if(g.a.get_instance().verifyIfLinkedEntitiesOfflineEnabled(this._descriptorData.tryGetDescriptor(l.a.FetchXml))){if(this.get_metadataSubtype()!==r.a.advancedFind){if(e=e.replace('"!eq-userid!"',"'"+p.a.get_DefaultInstance().get_UserContext().get_UserId().toString()+"' COLLATE NOCASE"),this.get_AssociatedEntityLogicalName()===h.j){const t="6";e=e.replace("@LanguageId0",p.a.get_DefaultInstance().get_UserContext().get_UserSettings().get_languageId().toString()),e=e.replace("@LanguageId1",p.a.get_DefaultInstance().get_UserContext().get_organizationSettings().get_languageCode().toString()),e=e.replace("@ObjectColumnName0",t),e=e.replace("@ObjectColumnName1",t)}this._descriptorData.updateDescriptorSet(l.a.Sql,e)}}else this._descriptorData.updateDescriptorSet(l.a.Sql,null)}}this._isDescriptorDataDeserialized=!0}return this._descriptorData}get_sourceId(){return this._sourceId}get_isUserRecord(){return this._isUserRecord}getObjectData(){const e={};e[s.a]=this._id,e[s.j]=this._metadataType,e[s.i]=this._metadataSubtype,e[s.f]=this._formFactor,e[s.b]=this._associatedEntityLogicalName,e[s.k]=this._sourceId,e[s.g]=this._isDefault,this._isDescriptorDataDeserialized&&this._metadataType!==a.a.layoutXml&&this._metadataType!==a.a.webResource&&this._metadataType!==a.a.businessLogic&&this._metadataType!==a.a.staticJSFile?e[s.c]=JSON.stringify(this._FormatDescriptorSetToSerialize(this.get_descriptorSet())):e[s.c]=this._descriptorData,e[s.d]=this._dependencyData,e[s.e]=this._displayName,e[s.h]=this._isUserRecord,_.metadataTypeKeyPath.get_path()!==s.j&&(e[_.metadataTypeKeyPath.get_path()]=this._metadataType);const t=this._metadataType.toString(),n=this._sourceId;Object(i.a)(n)?e[_.metadataTypeSourceIdKeyPath.get_path()]="":e[_.metadataTypeSourceIdKeyPath.get_path()]=t+d.a+n;const r=this._associatedEntityLogicalName;if(Object(i.a)(r)||Object(i.a)(this.get_metadataSubtype()))e[_.metadataTypeMetadataSubtypeAssociatedEntityLogicalNameKeyPath.get_path()]="";else{const n=this._metadataSubtype.toString();e[_.metadataTypeMetadataSubtypeAssociatedEntityLogicalNameKeyPath.get_path()]=t+d.a+n+d.a+r}Object(i.a)(r)?e[_.metadataTypeAssociatedEntityLogicalNameKeyPath.get_path()]="":e[_.metadataTypeAssociatedEntityLogicalNameKeyPath.get_path()]=t+d.a+r;const o=this._displayName;return Object(i.a)(o)?e[_.metadataTypeNormalizedDisplayNameKeyPath.get_path()]="":e[_.metadataTypeNormalizedDisplayNameKeyPath.get_path()]=t+d.a+o.toUpperCase(),e}getDescriptor(){return this._descriptorData}_FormatDescriptorSetToSerialize(e){if(l.a[0]in e.get_descriptors())return e.get_descriptors()[l.a[0]].Data;const t=[];let n=0;for(const r of Object.keys(e.get_descriptors()))t[n]=new c.a(e.get_descriptors()[r].Format,e.get_descriptors()[r].Data),n++;return t}static extractKey(e){return e[s.a]}static createFromObjectData(e){return new _(e)}}_.metadataTypeKeyPath=new f.a(s.j),_.metadataTypeSourceIdKeyPath=new f.a(s.j+d.a+s.k),_.metadataTypeAssociatedEntityLogicalNameKeyPath=new f.a(s.j+d.a+s.b),_.metadataTypeMetadataSubtypeAssociatedEntityLogicalNameKeyPath=new f.a(s.j+d.a+s.i+d.a+s.b),_.metadataTypeNormalizedDisplayNameKeyPath=new f.a(s.j+d.a+s.e)},"3yqi":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.Dashboard="Dashboard",e.Dialog="Dialog",e.ModalDialog="ModalDialog",e.EditForm="EditForm",e.QuickCreateForm="QuickCreateForm",e.PowerBIFullScreen="PowerBIFullScreen",e.Search="Search",e.TaskBasedFlow="TaskBasedFlow",e.WebResource="WebResource",e.Grid="EntityList",e.CustomControl="Control"}(r||(r={}))},"40hY":function(e,t,n){"use strict";function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}n.d(t,"a",(function(){return r}))},"455M":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.TwoOptions="TwoOptions",e.DateAndTimeDateOnly="DateAndTime.DateOnly",e.DateAndTimeDateAndTime="DateAndTime.DateAndTime",e.Decimal="Decimal",e.FP="FP",e.WholeNone="Whole.None",e.WholeDuration="Whole.Duration",e.WholeTimeZone="Whole.TimeZone",e.WholeLanguage="Whole.Language",e.LookupSimple="Lookup.Simple",e.LookupCustomer="Lookup.Customer",e.LookupOwner="Lookup.Owner",e.LookupPartyList="Lookup.PartyList",e.LookupRegarding="Lookup.Regarding",e.LookupMultiEntity="Lookup.MultiEntity",e.MultiSelectPicklist="MultiSelectPicklist",e.Multiple="Multiple",e.Currency="Currency",e.Object="Object",e.OptionSet="OptionSet",e.StatusOptionSet="StatusOptionSet",e.EntityNameOptionSet="EntityNameOptionSet",e.SingleLineEmail="SingleLine.Email",e.SingleLineText="SingleLine.Text",e.SingleLineTextArea="SingleLine.TextArea",e.SingleLineURL="SingleLine.URL",e.SingleLineTickerSymbol="SingleLine.Ticker",e.SingleLinePhone="SingleLine.Phone",e.Grid="Grid",e.BusinessProcessFlow="BusinessProcessFlow",e.WebResourceHtmlControl="WebResource.HTML",e.TimelineWall="TimelineWall",e.QuickForm="Form.QuickForm",e.Card="Card",e.Dashboard="Dashboard",e.Search="Search",e.SearchWidget="SearchWidget.SearchWidget",e.KbArticle="KbArticle",e.KbContent="KbContent",e.PowerBI="PowerBI",e.MicrosoftFlow="MicrosoftFlow",e.EmailEngagementRecipientActivity="emailrecipientactivitycontrol",e.ReferencePanelSearchWidget="SearchWidget.ReferencePanelSearchWidget",e.Timer="Timer",e.SingleLineAddress="SingleLine.Address",e.GlobalFilter="GlobalFilter",e.AppliedFilters="AppliedFilters",e.ReferencePanel="ReferencePanel",e.EmailEngagementActions="emailengagementactionscontrol",e.SocialInsightsControl="SocialInsightsControl",e.File="File",e.Image="Image",e.ClassIdControlMap={"fd2a7985-3187-444e-908d-6624b21f69c0":"iframe","270bd3db-d9af-4782-9025-509e298dec0a":"lookup","f3015350-44a2-4aa0-97b5-00166532b5e9":"regarding","cbfb742c-14e7-4a17-96bb-1a13f7f64aa2":"partylist","aa987274-ce4e-4271-a803-66164311a958":"duration","c6d124ca-7eda-4a60-aea9-7fb8d318b68f":"integer","0d2c745a-e5a8-4c8f-ba63-c6d3bb604660":"float","533b9e00-756b-4312-95a0-dc888637ac78":"money","c3efe0c3-0ec6-42be-8349-cbd9079dfd8e":"decimal","ada2203e-b4cd-49be-9ddf-234642b43b52":"email","6f3fb987-393b-4d2d-859f-9d0f0349b6ad":"emailbody","4273edbd-ac1d-40d3-9fb2-095c621b552d":"text","e0dece4b-6fc8-4a8f-a065-082708572369":"memo","71716b6c-711e-476c-8ab8-5d11542bfb47":"url","1e1fc551-f7a8-43af-ac34-a8dc35c7b6d4":"tickersymbol","3ef39988-22bb-4f0b-bbbe-64b5a3748aee":"picklist","5d68b988-0661-4db2-bc3e-17598ad3be6c":"status","5b773807-9fb2-42db-97c3-7a91eff8adff":"datetime","67fac785-cd58-4f9f-abb3-4b7ddc6ed5ed":"boolean","b0c6723a-8503-4fd7-bb28-c8a06ac933c2":"boolean","671a9387-ca5a-4d1e-8ab7-06e39ddcf6b5":"language","e7a81278-8635-4d9e-8d4d-59480b391c5b":"subgrid","7c624a0b-f59e-493d-9583-638d34759266":"timezone","3246f906-1f71-45f7-b11f-d7be0f9d04c9":"connection","821acf1a-7e46-4a0c-965d-fe14a57d78c7":"connectionroleojbjecttypecodelist","9fdf5f91-88b1-47f4-ad53-c11efc01a01d":"webResourceHtml","587cdf98-c1d5-4bde-8473-14a0bc7644a7":"webResourceImage","080677db-86ec-4544-ac42-f927e74b491f":"webResourceSilverlight","8c54228c-1b25-4909-a12a-f2b968bb0d62":"powerBITile","06375649-c143-495e-a496-c962e5b4488e":"notes","5c5600e0-1d6e-4205-a272-be80da87fd42":"quickformcollection","b68b05f0-a46d-43f8-843b-917920af806a":"referencepanelquickformcollection","02d4264b-47e2-4b4c-aa95-f439f3f4d458":"referencepanelsubgrid","1f179106-fa28-4495-961e-f6bd93c21974":"interactionwall","62b0df79-0464-470f-8af7-4483cfea0c7d":"bingmap","86b9e25e-695e-4fef-ac69-f05cfa96739c":"socialInsight","76b9e25e-695e-4fef-ac69-f05cfa96739c":"orgInsights","9c5ca0a1-ab4d-4781-be7e-8dfbe867b87e":"timercontrol","e616a57f-20e0-4534-8662-a101b5ddf4e0":"searchwidget","03c5aed6-ee88-404e-b63c-4c53429c8bfb":"kbarticle","1b9fc842-b45e-4fc1-b080-81e96b6d857f":"kbcontent","7ccd1494-1f7a-4e3a-8bde-f32069daeb9f":"referencepanelsearchwidget","ee9078c8-6946-4e2c-b8f8-35e65f4be6a8":"queuecontainer","f130d8ae-ce5b-43c5-bed1-1a6a5856cf3d":"multiplepiechart","6fae836f-fc01-48de-9b63-9b68a8fd86b8":"tagcontrol","f9a8a302-114e-466a-b582-6771b2ae0d92":"customControl","c8bfbbef-6851-4401-a0cc-7450062fe085":"aci","8c10015a-b339-4982-9474-a95fe05631a5":"phone","d2561f53-b292-42d9-b222-478e40ffe29f":"dashboard","7c7059a6-74d9-4b02-80ad-19bc60426393":"search","39354e4a-5015-4d74-8031-ea9eb73a1322":"label","fff0e632-9d7b-4f21-bbc1-05d1567ad144":"globalfilter","9c310a73-a360-42c5-8943-47a06f1b51ea":"appliedfilters"},e}()},"47MF":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a extends r.a{constructor(e,t){super(),this._outerQuery=null,this._subQueries=null,this._outerQuery=e,this._subQueries=t}get_name(){return"RetrieveEntitiesForAggregateQuery"}get_outerQuery(){return this._outerQuery}get_subQueries(){return this._subQueries}}},"4Gtd":function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"k",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"j",(function(){return u})),n.d(t,"l",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"d",(function(){return g})),n.d(t,"m",(function(){return h})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return b}));var r=n("a475"),a=n("UDbe");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="__OBJECTSTORE",o="__VERSIONS",s="StoreName",c="IndexKeyPath",l="IndexName",u="EntityName",d="VersionName",p="db",g="json",h=500,f="Exception occurred on a transaction callback. ",m=a.a.get_id().get_path();function b(){return r.a.get_Instance().get_device().get_DeviceState().get_deviceMemoryRestricted()?10:50}},"4I9M":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!==e||501===e||505===e)},e.getMillisToBackoffForRetry=function(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(4,e)*n,Math.min(t,12e4)},e}();t.default=r},"4N6w":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){if(e&&e.authentication)return e.authentication.token}function a(e){if(e&&e.authentication)return e.authentication.objectid}function i(e){if(e&&e.authentication)return e.authentication.tenantid}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}))},"4Vcb":function(e,t,n){"use strict";function r(e){return e?e.getTimezoneOffset():0}function a(){return""}function i(){return"Web"}function o(){return 1}function s(e){return alert(e.text),Promise.resolve({})}function c(e){return alert((e.message||"")+(e.errorCode?" ("+e.errorCode+")\n\n":"\n\n")+(e.details||"")),Promise.resolve({})}function l(e){var t=confirm((e.title?e.title+"\n"+(e.subtitle?e.subtitle+"\n":"\n"):"")+e.text);return Promise.resolve({confirmed:t})}n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"f",(function(){return l}))},"4WQe":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.addNotificationListener=function(e){this.listeners.push(e)},e.removeNotificationListener=function(e){for(var t=this.listeners.indexOf(e);t>-1;)this.listeners.splice(t,1),t=this.listeners.indexOf(e)},e.eventsSent=function(e){for(var t=this,n=function(n){r.listeners[n].eventsSent&&setTimeout((function(){return t.listeners[n].eventsSent(e)}),0)},r=this,a=0;a<this.listeners.length;++a)n(a)},e.eventsDropped=function(e,t){for(var n=this,r=function(r){a.listeners[r].eventsDropped&&setTimeout((function(){return n.listeners[r].eventsDropped(e,t)}),0)},a=this,i=0;i<this.listeners.length;++i)r(i)},e.eventsRetrying=function(e){for(var t=this,n=function(n){r.listeners[n].eventsRetrying&&setTimeout((function(){return t.listeners[n].eventsRetrying(e)}),0)},r=this,a=0;a<this.listeners.length;++a)n(a)},e.eventsRejected=function(e,t){for(var n=this,r=function(r){a.listeners[r].eventsRejected&&setTimeout((function(){return n.listeners[r].eventsRejected(e,t)}),0)},a=this,i=0;i<this.listeners.length;++i)r(i)},e.listeners=[],e}();t.default=r},"4aOd":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("31Vn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a{constructor(e){const{functionName:t,functionNameNoClassName:n,urlString:a,line:i,column:o}=function(e){let t="anonymous",n="unknown",a=-1,i=-1;const o="   at ";if(e)if(e.startsWith("BrowserErrorHandler.InternalGetStackTrace"))t=e.trim();else if(e.startsWith(o))t=(e=e.slice(o.length)).trim();else{const o=function(e){const t=e.indexOf("("),n=e.indexOf("@");let r;if(-1===t&&-1===n)return-1;r=t>-1?t:n;return r}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e=function(e){const t="    at ";e.startsWith(t)&&(e=e.slice(t.length));const n="Function.";e.startsWith(n)&&(e=e.slice(n.length));return e}(e));o>-1&&(t=e.slice(0,o).trim());const s=function(e){let t,n=-1,a=-1;const i=e.lastIndexOf(":");if(i>-1){const r=e.slice(0,i),o=e.slice(i+1);a=parseInt(o,10);const s=r.lastIndexOf(":");if(s>-1){t=r.slice(0,s);const e=r.slice(s+1);n=parseInt(e,10)}else t=r}else t=e;return{url:Object(r.a)(t),line:n,column:a}}(function(e,t){let n;n=t>-1?e.slice(t+1):e;return n=n.replace(/\)$/,""),n}(e,o));n=s.url,a=s.line,i=s.column}else;const s=t.lastIndexOf("."),c=s>=0&&s<t.length-1?t.substring(s+1):t;return{functionName:t,functionNameNoClassName:c,urlString:n,line:a,column:i}}(e);this.functionName=t,this.functionNameNoClassName=n,this.urlString=a,this.line=i,this.column=o}toString(){const{functionName:e,urlString:t,line:n,column:r}=this;return` at ${e} (${t}${n>-1?`:${n}:${r}`:""})`}}class i{constructor(e){this._stackTrace=this._internalGetStackTrace(e)}getFunctionName(){const e=this._stackTrace.length?this._stackTrace[0].functionName:"anonymous",t=e.indexOf("$",0);if(-1===t)return"anonymous";const n=e.indexOf("$",t+1);if(-1===n)return e;const r=e.indexOf("$",n+1);return-1===r?e:e.slice(n+1,r-t)}getStackTrace(){return this._stackTrace.join("\n")}_removeErrorMessageFromStack(e,t){t.length>0&&t[0].indexOf(e)>-1&&t.shift()}_internalGetStackTrace(e){if(null==e)return[new a("BrowserErrorHandler.InternalGetStackTrace: Error is null or undefined.")];const t=e.stack;if(null==t)return[new a("BrowserErrorHandler.InternalGetStackTrace: Stack trace is null or undefined.")];const n=t.split("\n"),r=e.message;this._removeErrorMessageFromStack(r,n);const i=[];for(const e of n)""!==e&&i.push(new a(e));return i}}},"4ciL":function(e,t,n){"use strict";n.d(t,"c",(function(){return j})),n.d(t,"b",(function(){return P})),n.d(t,"a",(function(){return T})),n.d(t,"d",(function(){return A})),n.d(t,"e",(function(){return N}));var r=n("odYE"),a=n("Uv1Y"),i=n("SRlt"),o=n("f07+"),s=n("eeMP"),c=n("l0Rp"),l=n("w72X"),u=n("sNgR"),d=n("aRLb"),p=n("Hevb"),g=n("O4uv"),h=n("01Vp"),f=n("ATrR"),m=n("9eA9"),b=n("iZ7K"),_=n("NvOS"),y=n("vF3j"),v=n("g22U");function S(e,t,n,r){const a=r.map(r=>function(e,t,n,r){if(!(e&&t&&n&&r))return{serializationFailure:"Cannot serialize associate request. All parameters are mandatory, but some were passed in empty"};const a=Object(b.o)(e,t.etn),o=Object(b.o)(e,r.etn),{navigationProperty:s,method:c,serializationFailure:l}=Object(y.a)(e,t.etn,n);if(l)return{serializationFailure:l};return{urlParameters:`${a}(${t.id.guid})/${s}/$ref`,body:JSON.stringify({"@odata.context":Object(m.b)()+Object(_.a)(e,i.c.WEB_API_URL_FRAGMENT)+"$metadata#$ref","@odata.id":`${o}(${r.id.guid})`}),additionalHeaders:{Accept:i.a},method:c,additionalParameters:{[v.a.TYPE]:v.c.UPDATE,[v.a.SUB_TYPE]:v.b.Associate}}}(e,t,n,r));return 1===a.length?a[0]:Object(c.a)(e,a)}var O=n("iEjf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var C=n("pEXn"),E=n("SAYH"),I=n("4r2D"),w=n("z+5+");function j(e){const t=[];return{type:"executeOData.batch.async",execute({dispatch:n,getState:r},o){const l=new I.a(E.a.newGuid().guid);t.push({name:C.b.ClientRequestId,value:l&&l.RequestId?l.RequestId():null});const u=Object(c.a)(r(),e);return u.serializationFailure?Promise.reject(new a.a("Cannot serialize request: "+u.serializationFailure)):(i.c.AddRequestId(u,l&&l.RequestId?l.RequestId():E.a.newGuid().guid),o.DataSource.get_WebAPIService().sendRequest(u).then(e=>Object(s.b)(e)))},getFailureParameters:(e,n)=>t}}function P(e){return{type:"executeOData.batch.async",execute({dispatch:t,getState:n},r){const i=new o.d(e);return t(Object(d.c)(...e)).then(()=>{if(Object(w.i)(n(),i)){return r.DataSource.executeOData(i,null).nativePromise().then(e=>Object(s.b)(e))}const o=n();let c=null;const l=e.map(e=>{if(N(e)){const t=T(o,e);return t.serializationFailure&&(c=t.serializationFailure),t}if(A(e))return e.map(e=>{const t=T(o,e);return t.serializationFailure&&(c=t.serializationFailure),t});throw Error("value should be of type odatacontract or Changeset")});return c?Promise.reject(new a.a("Cannot serialize request: "+c)):t(j(l))})}}}function T(e,t){if(!t)return{serializationFailure:"Cannot build the serialized request: the request object is empty"};if(!t.getMetadata())return{serializationFailure:"Cannot build the serialized request: the request object does not contain metadata definition"};switch(t.getMetadata().operationType){case 0:return Object(l.a)(e,t);case 1:return Object(u.a)(e,t);case 2:return function(e,t){switch(t.getMetadata().operationName){case"Create":{const n=t;return Object(g.b)(e,n.etn,n.payload,n.suppressDupeDetection)}case"Retrieve":{const n=t,a=r.a.fromExternalEntityReference(n.entityReference);return Object(f.a)(e,a,n.columns)}case"RetrieveWithUrlParams":{const n=t;return Object(f.b)(e,n.etn,n.id,n.urlParams,n.maxPageSize,n.headers,n.isBinary)}case"Update":{const n=t;return Object(p.a)(e,n.etn,n.id,n.payload,n.suppressDupeDetection,null,!1,n.urlParams,n.headers,n.isBinaryPayload)}case"Delete":{const n=t,a=r.a.fromExternalEntityReference(n.entityReference);return Object(h.a)(e,a,null,n.attributeName)}case"Associate":{const n=t,a=r.a.fromExternalEntityReference(n.target),i=n.relatedEntities.map(r.a.fromExternalEntityReference);return S(e,a,n.relationship,i)}case"Disassociate":{const n=t,a=r.a.fromExternalEntityReference(n.target);return Object(O.a)(e,a,n.relationship,n.relatedEntityId)}case"EntityDefinitions":return function(e){return{urlParameters:`EntityDefinitions?$select=${e.columns.join(",")}${e.filter?"&"+e.filter:""}`,additionalHeaders:{Accept:i.a},method:"GET",additionalParameters:{[v.a.TYPE]:v.c.ENTITY_DEFINITION,[v.a.SUB_TYPE]:v.b.EntityDefinition}}}(t);default:return{serializationFailure:`Cannot convert ODataContract with ${t.getMetadata().operationName} operation into a serialized request`}}}(e,t)}}function N(e){return e&&e.getMetadata}function A(e){return e&&Array.isArray(e)&&e.length>0&&e[0].getMetadata}},"4leG":function(e,t,n){"use strict";function r(e){if(e&&e.configuration)return e.configuration.navbar}function a(e){if(e&&e.configuration)return e.configuration.cmdbar}function i(e){return!(!e||!e.configuration)&&e.configuration.isPreviewMode}function o(e){return!(!e||!e.configuration)&&e.configuration.isEmbedded}function s(e){return!(!e||!e.configuration)&&e.configuration.isD365DefaultApp}n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return s}))},"4mtW":function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return g})),n.d(t,"d",(function(){return h})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return m}));var r=n("arV0"),a=n("3/02"),i=n("Lyxw"),o=n("uNu9"),s=n("CYtR"),c=n("E5IU"),l=n("455M"),u=n("jgTV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d=new Set([o.e,o.Gb,o.J,o.M,o.L,o.d]);function p(e,t){const n={value:{Usage:0,Static:!1,Type:l.a.Multiple,Value:"description",Primary:!0}};return t===o.e||t===o.Gb?n.configUrl={Usage:1,Static:!0,Type:l.a.SingleLineURL,Value:"/WebResources/Activities/SystemLibraries/msdyn_AppointmentRTEconfig.js"}:t===o.J&&(n.configUrl={Usage:1,Static:!0,Type:l.a.SingleLineURL,Value:""}),Object.assign(Object.assign({},e),{CustomControlId:"7b45bd00-dc91-414f-9854-802daaf6e5c3",DisplayNameKey:"RichTextEditorControlV2_Name",Name:s.g,Parameters:n})}function g(e,t){const n={value:Object.assign({},e.Parameters.value)};return t===o.eb&&(n.configUrl={Usage:1,Static:!0,Type:l.a.SingleLineURL,Value:"/WebResources/msdyncrm_/RichTextEditorControl/KnowledgeArticleRTEconfig.js"}),Object.assign(Object.assign({},e),{Parameters:n})}function h(e){const t=Object(c.g)("msdyn_RTEv2DefaultConfig",e),n=Object(c.g)("msdyn_RTEv2Email",e),r=Object(c.g)("msdyn_RTEv2KnowledgeManagement",e);return!0===t||!0===n||!0===r}function f(e,t,n,l){const p=Object(r.g)(e,l);return void 0!==t&&(((null==t?void 0:t.Name)===s.f||(null==t?void 0:t.Name)===s.e)&&(!!function(e,t,n,r){return Object(i.c)(e,a.ld)&&(null==r?void 0:r.entityTypeName)===o.eb&&(null==t?void 0:t.Name)===s.e&&("description"===(null==n?void 0:n.DataFieldName)||(null==n?void 0:n.DataFieldName)===u.b)}(e,t,n,p)||(!!function(e,t,n,r){const a=Object(c.g)("msdyn_RTEv2Email",e);return(null==r?void 0:r.entityTypeName)===o.J&&"description"===(null==n?void 0:n.DataFieldName)&&!0===a}(e,0,n,p)||(!!function(e,t){const n=Object(c.g)("msdyn_RTEv2DefaultConfig",e),r=function(e){var t,n;return null===(n=null===(t=null==e?void 0:e.Parameters)||void 0===t?void 0:t.configUrl)||void 0===n?void 0:n.Value}(t);if(!r&&n)return!0;if(r&&Object(i.c)(e,a.Cd)&&n)return!0;return!1}(e,t)||!!function(e,t){const n=Object(c.g)("msdyn_RTEv2DefaultConfig",e);return Object(i.c)(e,a.kd)&&!0===n&&(!d.has(null==t?void 0:t.entityTypeName)||(null==t?void 0:t.entityTypeName)===o.J&&Object(i.c)(e,a.md))}(e,p)))))}function m(e){return Object.assign(Object.assign({},e),{CustomControlId:"7b45bd00-dc91-414f-9854-802daaf6e5c3",DisplayNameKey:"RichTextEditorControlV2_Name",Name:s.g})}},"4or6":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unspecified=0]="Unspecified",e[e.String=1]="String",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Boolean=4]="Boolean",e[e.Date=5]="Date"}(t.AWTPropertyType||(t.AWTPropertyType={})),function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(t.AWTPiiKind||(t.AWTPiiKind={})),function(e){e[e.NotSet=0]="NotSet",e[e.GenericContent=1]="GenericContent"}(t.AWTCustomerContentKind||(t.AWTCustomerContentKind={})),function(e){e[e.Low=1]="Low",e[e.Normal=2]="Normal",e[e.High=3]="High",e[e.Immediate_sync=5]="Immediate_sync"}(t.AWTEventPriority||(t.AWTEventPriority={})),function(e){e[e.NonRetryableStatus=1]="NonRetryableStatus",e[e.QueueFull=3]="QueueFull",e[e.MaxRetryLimit=4]="MaxRetryLimit"}(t.AWTEventsDroppedReason||(t.AWTEventsDroppedReason={})),function(e){e[e.InvalidEvent=1]="InvalidEvent",e[e.SizeLimitExceeded=2]="SizeLimitExceeded",e[e.KillSwitch=3]="KillSwitch"}(t.AWTEventsRejectedReason||(t.AWTEventsRejectedReason={}))},"4r2D":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("rWW8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a extends r.a{constructor(e,t){super(e),this._isPreloadCall=!1,this.requestId=e,this._isPreloadCall=t}RequestId(){return this.requestId}IsPreloadCall(){return this._isPreloadCall}toString(){return"["+this.RequestId()+"]"}}},"504W":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r=/(http|https):\/\/(\w+:{0,1}\w*)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%!\-\/]))?/,a=/(dynamicsxrm):\/\/(\w+:{0,1}\w*)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%!\-\/]))?/,i=/^\/([0-9a-zA-Z_]+\/)?main.aspx/;function o(e){return null==e}function s(e){return!!o(e)||"string"==typeof e&&""===e.trim()}function c(e){return r.test(e)||a.test(e)||i.test(e)}},"5DN6":function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return l}));var r=n("jq7Z"),a=n("y60j"),i=n("zmL5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t){const n=Object(r.a)(e,t);return null==n?void 0:n.referencePanel}function s(e,t,n){const r=o(e,n);if(!r)return"";const s=r.activeTabId,c=l(e,n);if(t<0||t>=c.length)return s;if(c.length>0&&c[t].id!==s)return s;if(0===t){if(1===c.length){if(0===r.controlNames.length)return"";const t=Object(i.b)(e,n),o=Object(a.b)(e,n,t,r.controlNames[0]);return null==o?void 0:o.Id}if(c.length>1)return c[1].id}else if(t>0)return c[t-1].id}function c(e,t){var n;const r=o(e,t),s=Object(i.b)(e,t);return r&&r.controlNames.length>0?null===(n=Object(a.b)(e,t,s,r.controlNames[0]))||void 0===n?void 0:n.Id:""}function l(e,t){var n,r;return null!==(r=null===(n=o(e,t))||void 0===n?void 0:n.sessionTabs)&&void 0!==r?r:[]}},"5KQF":function(e,t,n){"use strict";n.d(t,"a",(function(){return F}));var r=n("vmcK");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){const t={};if(e&&e.length>0){const n=e.split(";");for(const e of n)if(e&&e.length>0){const n=e.split(":");if(n&&n.length>1){const e=n[0];let r,a=!1;switch(n[1].toLowerCase()){case"true":r=!0,a=!0;break;case"false":r=!1,a=!0}if(a)switch(e.toLowerCase()){case"displaycommandbar":t.displayCommandBar=r;break;case"displayviewselector":t.displayViewSelector=r;break;case"displayindex":t.displayIndex=r;break;case"displayquickfind":t.displayQuickFind=r;break;case"displaypaging":t.displayPaging=r}}}}return t}function i(e){const t={},n={},r=[],i=[];if(e){let o=!1;for(const n of e.Properties){const e=n.Usage;0===e&&(o=!0);const r={Required:n.Required,DefaultValue:n.DefaultValue,Usage:e};t[n.Name]=r}if(e.DataSets){let t=!o;for(const r of e.DataSets){const e={};for(const t of r.Columns){const n={Required:t.Required,DefaultValue:t.DefaultValue,Usage:t.Usage};e[t.Name]=n}const i={DisplayName:r.DisplayName,Type:r.Type,Columns:e,Primary:t,InitialDataSetFetch:r.InitialDataSetFetch,CDSDataSetOptions:a(r.CDSDataSetOptions)};n[r.Name]=i,t=!1}}for(const t of e.Resources){const e={Name:t.Name,LoadOrder:t.LoadOrder,Type:t.Type,LibraryName:t.LibraryName};r.push(e)}if(e.FeatureUsage)for(const t of e.FeatureUsage){const e={Name:t.Name,Type:t.Type,IsRequired:t.IsRequired};i.push(e)}}return{Resources:r,GroupDefinitions:{},DataSetDefinitions:n,Properties:t,FeatureUsage:i}}var o=n("1pQz"),s=n("Lr+c");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e){const t={};return t[r.a]={PrimaryEntityLogicalName:e.PrimaryEntityLogicalName,BusinessLogic:e.BusinessLogic},t}var l=n("eXjw"),u=n("fC8v");var d=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var p,g=n("olXY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function h(e,t,n){const r=e&&e.filter(e=>e.Id===t&&e.LabelColumnName===n);if(r&&r.length>0)return r[0].Value}!function(e){e[e.Number=0]="Number",e[e.String=1]="String",e[e.Boolean=2]="Boolean"}(p||(p={}));var f=n("+5Bq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function m(e,t){return e?{appId:e.AppId,appUrl:e.AppUrl,id:e.Id,description:h(t,e.AppId,"description")||e.Description,LastModifiedOn:e.LastModifiedOn,status:e.Status,title:h(t,e.AppId,"name")||e.Title,uniqueName:e.UniqueName,clientType:e.ClientType,navigationType:e.NavigationType,isFeatured:e.IsFeatured,solutionId:e.SolutionId,versionNumber:e.VersionNumber,components:e.Components,appComponents:b(e.AppComponents),appSettings:y(e.AppSettings)}:null}function b(e){return e?{entities:e.Entities}:null}function _(e){return{displayName:e.DisplayName,guid:e.Guid,name:e.Name,webResourceType:e.WebResourceType}}function y(e){const t={};if(e)for(const n of e){const e=v(n);t[e.name]=e}return t}function v(e){const t=function(e,t){switch(e){case p.Number:return parseFloat(t);case p.Boolean:return Object(f.a)(t);case p.String:default:return t}}(e.DataType,e.Value);return{name:e.Name,dataType:e.DataType,value:t}}var S=n("EU8S");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var O=n("g0tL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var C=n("uzi5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function E(e){if(!e)return null;const t={initialized:l.a.Initialized,formId:new d.a(e.FormId),uniqueName:e.UniqueName,displayName:e.DisplayName,imageUrl:e.ImageUrl,primaryModelName:e.PrimaryModelName,properties:e.Properties,workFlowId:e.WorkFlowId,description:e.Description,defaultNextPageByTabName:e.DefaultNextPageByTabName,versionNumber:e.VersionNumber,overallVersionNumber:e.OverallVersionNumber};if(e.Labels){const n=e.Labels.filter(e=>e.Id===t.workFlowId);t.displayName=n&&n.length?n[0].Value:t.displayName}return t}var I=n("d6Hx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function w(e){const t=[],n={};for(const r of e.Groups)t.push(r.Id),n[r.Id]=j(r);return{Titles:T(e.Titles),Descriptions:N(e.Descriptions),GroupIds:t,Groups:n,Id:e.Id,Icon:e.Icon,VectorIcon:e.VectorIcon,Url:e.Url,ShowGroups:e.ShowGroups,ShowGroupsSpecified:e.ShowGroupsSpecified}}function j(e){const t=[],n={};for(const r of e.SubAreas)t.push(r.Id),n[r.Id]=P(r);return{Titles:T(e.Titles),Descriptions:N(e.Descriptions),SubAreaIds:t,SubAreas:n,Id:e.Id,Url:e.Url}}function P(e){return{Titles:T(e.Titles),Descriptions:N(e.Descriptions),Id:e.Id,Icon:e.Icon,VectorIcon:e.VectorIcon,OutlookShortcutIcon:e.OutlookShortcutIcon,Url:e.Url,PassParams:e.PassParams,PassParamsSpecified:e.PassParamsSpecified,AvailableOffline:e.AvailableOffline,AvailableOfflineSpecified:e.AvailableOfflineSpecified,Entity:e.Entity,DynamicPage:e.DynamicPage,Page:e.Page,GetStartedPanePath:e.GetStartedPanePath,GetStartedPanePathOutlook:e.GetStartedPanePathOutlook,GetStartedPanePathAdmin:e.GetStartedPanePathAdmin,DefaultDashboard:e.DefaultDashboard,GetStartedPanePathAdminOutlook:e.GetStartedPanePathAdminOutlook}}function T(e){const t=[];for(const n of e){const e={Title:n.Title,LCID:n.LCID};t.push(e)}return t}function N(e){const t=[];for(const n of e){const e={Description:n.Description,LCID:n.LCID};t.push(e)}return t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var A=n("ILmX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function D(e){const t=new Set;let n=new Array;if(e.Layout.Tabs.Tab&&(n=n.concat(e.Layout.Tabs.Tab)),e.Layout.ContextualTabs.Tab&&(n=n.concat(e.Layout.ContextualTabs.Tab)),n.forEach(e=>{e&&e.Groups&&e.Groups.Group&&e.Groups.Group.forEach(e=>{e&&e.Controls&&e.Controls.Items&&e.Controls.Items.forEach(e=>{t.add(Object(A.i)(e.Command))})})}),e.Commands)for(const n in e.Commands)for(const r in e.Commands[n]){const a=e.Commands[n][r];t.has(a.Id)?a.isFirstLevel=!0:a.isFirstLevel=!1}}var R=n("7HpW");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var x=n("9eA9"),M=n("GEbX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function F(e,t,n,a,p,f,b,y){if(!e)return null;const v=k(e.EntityMetadataVersionStamp),j=k(e.MetadataVersion);let P=null;const T=[];let N=null,A=null,F=null,B=null,U=null;const V=function(e,t){if(!e||!e.length)return null;const n={};for(const r of e){const e=E(r);n[e.uniqueName]=e,t.push(...r.Labels)}return{taskBasedFlows:n}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e.TaskBasedFlows,T),z=function(e,t){if(!e||!e.length)return null;const n={},r=[];if(e.length>1)throw"More than one TBX Menu detected";const a=e[0];for(const e of a.TaskBasedFlows){const a=E(e);n[a.uniqueName]=a,t.push(...e.Labels),r.push(a.uniqueName)}return{taskBasedFlows:n,taskBasedFlowGlobalMenu:{initialized:l.a.Initialized,availableOffline:a.AvailableOffline,commandName:a.CommandName,taskBasedFlowUniqueNames:r,versionNumber:a.VersionNumber,overallVersionNumber:a.OverallVersionNumber}}}(e.TaskBasedFlowGlobalMenu,T);z?(N=z.taskBasedFlowGlobalMenu,A=z.taskBasedFlows):V&&(A=V.taskBasedFlows),P=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){const t={};if(e&&e.length>0)for(const n of e)if(n)if(t[n.Id])t[n.Id][n.LabelColumnName]=n.Value;else{const e={};e[n.LabelColumnName]=n.Value,t[n.Id]=e}return t}(T.concat(e.Labels)),t===O.b.Dashboard&&(F=function(e,t,n,r){const a={},i={},o={};let s=null;if(e){for(const c of e){const e={};e.Initialized=l.a.Initialized,e.FormId=new d.a(c.FormId),e.Name=c.Name,e.Description=c.Description,e.VersionNumber=c.VersionNumber,e.OverallVersionNumber=c.OverallVersionNumber,e.OverallUserVersionNumber=c.OverallUserVersionNumber,a[c.FormId]=e,""!==t&&null!=t?i[t.toLowerCase()]=e:!s&&r&&(s=e),!r&&n&&""!==n&&(o[n]=e)}s&&(a[d.a.fromLegacyGuid(r).guid]=s)}else{if(r||!n||""===n)return null;{const e={};e.Initialized=l.a.Initialized,e.FormId=null,e.Name=null,e.Description=null,o[n]=e}}return{dashboards:a,dashboardsByNavPath:i,dashboardsByEntityName:o}}(e.Dashboards,p,n,f)),n?U=function(e){if(!e)return null;const t={};for(const n of e)if(n.hasOwnProperty("EntityLogicalName")){const e={};for(const t of n.SelectorItems){const n={Id:new d.a(t.Id),DisplayName:t.DisplayName,Description:t.Description,Tooltip:t.Tooltip,Type:t.Type,IsTabledEnabled:t.IsTabletEnabled};e[t.Id]=n}t[n.EntityLogicalName]=e}return t}(e.DashboardSelectors):B=function(e){if(!e)return null;const t={};for(const n of e)for(const e of n.SelectorItems){const n={Id:new d.a(e.Id),DisplayName:e.DisplayName,Description:e.Description,Tooltip:e.Tooltip,Type:e.Type,IsTabledEnabled:e.IsTabletEnabled,OverallVersionNumber:e.OverallVersionNumber,OverallUserVersionNumber:e.OverallUserVersionNumber};t[e.Id]=n}return t}(e.DashboardSelectors);const W=function(e){const t={};if(e)for(const n of e){const e={ConstructorName:n.Name,CustomControlId:n.Name,IsVirtual:n.IsVirtual,Properties:i(n.Properties),ControlMode:n.ControlMode,SolutionName:n.SolutionName,SolutionVersion:n.SolutionVersion,PublisherName:n.PublisherName,ApiVersion:n.ApiVersion,DesignMap:n.DesignMapJson?JSON.parse(n.DesignMapJson):null};t[n.Name]=e,n.CustomControlId&&"00000000-0000-0000-0000-000000000000"!==n.CustomControlId&&(t[n.CustomControlId]=e)}return t}(e.CustomControls),{entities:q,attributes:H}=Object(o.b)(e.Entities,v,j,a,l.a.Initialized,b),G=function(e){if(!e)return null;const t={};for(const n of e){const e={initialized:l.a.Initialized,formId:d.a.tryParseOrNull(n.FormId),description:n.Description,uniqueName:n.UniqueName,isTabletEnabled:n.IsTabletEnabled,versionNumber:n.VersionNumber,overallVersionNumber:n.OverallVersionNumber};t[e.uniqueName.toLowerCase()]=e}return t}(e.Dialogs),K=Object(O.g)(e.Forms,t,a,n,P,H,q);let Q,X,Y,J;K&&(Q=K.forms,X=K.entities,Y=K.attributes,J=K.charts);const{entities:$}=Object(o.b)(e.RelationshipNavigationEntities,v,j,a,l.a.Uninitialized,b),Z=Object(r.c)(e.ViewSelectors,n),ee=Z?Z.viewSelectors:null,te=Z?Z.viewDefaults:null,ne=Z?Z.viewSelectorVersions:null,{formSelectors:re,formDefaults:ae}=Object(O.h)(e.FormSelectors,n),{bpfSelectors:ie,bpfDefaults:oe}=Object(C.c)(e.BPFSelectors),se=L(Object(g.c)(e.SavedQueryVisualizations),Object(g.c)(e.UserQueryVisualizations)),ce=L(se,J),le=Object(g.b)(e.VisualizationSelectors);let ue={},de={};le&&(ue=le.chartDefaults,de=le.chartSelectors);const{views:pe}=Object(r.b)(a,e.Views,b),ge={};if(e.CustomControlConfigurations&&e.CustomControlConfigurations.length>0)for(let t=0;t<e.CustomControlConfigurations.length;t++){const n={},a=Object(s.a)(e.CustomControlConfigurations[t]);n[r.a]=a,ge[a.PrimaryEntityType]=n}ge[n]||(ge[n]={});let he={};if(e&&e.GridBusinessLogics&&e.GridBusinessLogics.length>0)if(t===O.b.View){const t=c(e.GridBusinessLogics[0]);he[t[r.a].PrimaryEntityLogicalName]=t}else t===O.b.Dashboard&&(he=function(e){const t={};for(let n=0;n<e.length;n++){const a=c(e[n]);t[a[r.a].PrimaryEntityLogicalName]=a}return t}(e.GridBusinessLogics));const fe=Object(O.f)(q,X),me=Object.assign(Object.assign({},$),fe),be=Object(O.e)(H,Y),{optionSets:_e}=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){const t={},n={};if(e)for(const r of e){const e={Initialized:l.a.Initialized,OptionSetId:r.MetadataId,OptionSetName:r.Name,OptionSetType:r.OptionSetType,Options:Object(u.c)(r)};e.OptionSetId&&(t[e.OptionSetId]=e.OptionSetName),e.OptionSetName&&(n[e.OptionSetName]=e)}return{optionSets:{optionSetNameById:t,optionSetByName:n}}}(e.OptionSets);e.Dialogs&&e.Dialogs.length>0&&_e&&(function(e,t){for(const n in e){const r=e[n];for(const e in r){const n=r[e];if(n&&n.OptionSetId&&n.OptionSetName){const e={Initialized:l.a.Initialized,OptionSetId:n.OptionSetId,OptionSetName:n.OptionSetName,OptionSetType:n.OptionSetType,Options:n.OptionSet};t.optionSetNameById[e.OptionSetId]=e.OptionSetName,t.optionSetByName[e.OptionSetName]=e}}}}(be,_e),function(e,t){for(const n in e){const r=e[n];for(const e in r){const n=r[e];n.OptionSetId&&!n.OptionSetName&&t&&t.optionSetNameById&&t.optionSetNameById[n.OptionSetId]&&(n.OptionSetName=t.optionSetNameById[n.OptionSetId]),n.OptionSetName&&t.optionSetByName&&t.optionSetByName[n.OptionSetName]&&(n.OptionSetType=t.optionSetByName[n.OptionSetName].OptionSetType,n.OptionSet=t.optionSetByName[n.OptionSetName].Options)}}}(be,_e));const ye=Object(S.b)(e.WebResources),ve=Object(S.c)(e),Se=function(e){if(!e)return null;const t={};let n=-1,r=-1;for(const a of e){const e={formId:new d.a(a.FormId),entityLogicalName:a.EntityLogicalName,entityDisplayName:a.EntityDisplayName,formType:a.FormType,icon:a.Icon,isActivity:a.IsActivity,versionNumber:a.VersionNumber,overallVersionNumber:a.OverallVersionNumber,formDescription:a.FormDescription};a.VersionNumber>n&&(n=a.VersionNumber,-1===r&&(r=a.OverallVersionNumber)),t[e.entityLogicalName]=e}return{initialized:l.a.Initialized,quickCreateMenuItems:t,versionNumber:n,overallVersionNumber:r}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e.QuickCreateMenu),Oe=function(e){return e&&e.length?e[0]:null}(e.Search);let Ce=null;Ce=e.BusinessProcessFlowMetadata;const Ee=Object(C.d)(a,Ce,P,e.ProcessActionOperationMetadata),Ie=Object(R.d)(function(e){if(!e||!e.length)return null;if(e.length>1)throw"More than one SiteMap detected";const t=e[0],n=[],r={};if(t.Areas)for(const e of t.Areas)n.push(e.Id),r[e.Id]=w(e);return n.push(I.d),r[I.d]={Titles:[],Descriptions:[],GroupIds:[],Groups:{},Id:I.d},{initialized:l.a.Initialized,AreaIds:n,Areas:r,Url:t.Url,VersionNumber:t.VersionNumber,OverallVersionNumber:t.OverallVersionNumber}}(e.Sitemap)),we=function(e,t){if(!(e&&e.AppModulePublished&&e.AppModulePublished.length&&t))return null;const n=e.AppModulePublished.find(e=>e.appInfo.AppId===t),r=e.LabelsPublish;return n?{initialized:l.a.Initialized,app:m(n.appInfo,r),webResource:(a=n.webResourceInfo,{displayName:a.DisplayName,guid:a.Guid,name:a.Name,webResourceType:a.WebResourceType}),welcomePage:_(n.welcomePageInfo),eventHandlers:n.eventHandlers}:null;var a}(e,y),je=function(e){if(!e)return null;const t={};for(const n of e)for(let e=0;e<n.length;e++){const r=n[e].Key,a=n[e].Value;t[r]=a}return{initialized:l.a.Initialized,strings:t}}(e.ResourceStrings);let Pe={},Te={};const Ne=function(e){if(!e||!e.length)return null;const t={};let n={};for(const r of e){const e={Commands:r.Commands,Layout:r.Layout,EnableRules:r.EnableRules,DisplayRules:r.DisplayRules,initialized:l.a.Initialized,VersionNumber:Number(r.VersionNumber),OverallVersionNumber:Number(r.OverallVersionNumber)};t[r.Context+":"+r.EntityLogicalName]=e,n=Object.assign(Object.assign({},n),r.ColumnNameToObjectId),D(e)}return{ribbons:t,ribbonsLabelIds:n}}(e.Ribbons);null!=Ne&&(Pe=Ne.ribbons,Te=Ne.ribbonsLabelIds);const Ae=function(e){if(!e||!e.length)return null;if(e.length>1)throw"MetadataVersion response is not correct";const t=Number(e[0]);return{initialized:l.a.Initialized,lastVersion:t,currentVersion:t}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e.MetadataVersion),De=function(e){if(!e||!e.length)return null;if(e.length>1)throw"UserMetadataVersion response is not correct";const t=Number(e[0]);return{initialized:l.a.Initialized,lastVersion:t,currentVersion:t}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e.UserMetadataVersion),Re=function(e){if(!e)return null;const t={};for(let n=0;n<e.length;n++){const r=e[n].Name,a=e[n].Value;t[r]=a}return{initialized:l.a.Initialized,complexControls:t}}(e.ComplexControls),xe={};null!=e.AppModuleSelector&&e.AppModuleSelector.length>0&&(xe.offlineAppDescriptors=function(e){if(!e||!e.length)return null;const t=[];for(let n=0;n<e.length;n++){const r=e[n];if(4===r.ClientType&&r.IsOfflineEnabled){const e={ClientType:r.ClientType,Description:r.Description,Id:r.Id,Image:r.Image,ImageType:r.ImageType,Name:r.Name,IsOfflineEnabled:r.IsOfflineEnabled};t.push(e)}}return t}(e.AppModuleSelector[0].SelectorItems),xe.offlineAppDescriptorsInitialized=l.a.Initialized);return{appModulesList:
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 *
 * Logic in this file is owned by the App Module team.
 */
function(e){const t=window.WEB_RESOURCE_ORG_VERSION_NUMBER?"/"+window.WEB_RESOURCE_ORG_VERSION_NUMBER:"",n=e.LabelsPublish,r=[],a=e.LegacyAppModule;a&&Object.keys(a).length>0&&a.forEach(e=>{r.push({id:e.appInfo.AppId,displayName:e.appInfo.Title,backgroundColor:"#002050",iconUri:Object(x.b)()+t+"/WebResources/"+e.webResourceInfo.Name,appOpenUri:e.appInfo.AppUrl,uniqueName:e.appInfo.UniqueName,clientType:e.appInfo.ClientType})});const i=e.AppModulePublished;return i&&Object.keys(i).length>0&&i.forEach(e=>{r.push({id:e.appInfo.AppId,displayName:h(n,e.appInfo.AppId,"name")||e.appInfo.Title,backgroundColor:"#002050",iconUri:Object(x.b)()+t+"/WebResources/"+e.webResourceInfo.Name,appOpenUri:"{0}/main.aspx?appid={1}".replace("{0}",Object(x.b)()).replace("{1}",e.appInfo.AppId),uniqueName:e.appInfo.UniqueName,clientType:e.appInfo.ClientType,navigationType:Number.isInteger(e.appInfo.NavigationType)?e.appInfo.NavigationType:M.a.SingleSession})}),r.length>0?{appList:r}:null}(e),forms:Q,formSelectors:re,formDefaults:ae,bpfSelectors:ie,bpfDefaults:oe,dialogs:G,taskBasedFlows:A,taskBasedFlowGlobalMenu:N,dashboards:F?F.dashboards:null,dashboardsByNavPath:F?F.dashboardsByNavPath:null,dashboardSelectors:B,dashboardsByEntityName:F?F.dashboardsByEntityName:null,dashboardSelectorsByEntityName:U,entities:me,views:pe,viewSelectors:ee,viewDefaults:te,viewSelectorVersions:ne,attributes:be,labels:P,controlManifests:W,charts:ce,chartDefaults:ue,chartSelectors:de,resourceStrings:je,optionSets:_e,quickCreateMenu:Se,searchConfiguration:Oe,webResources:ye,webResourceDescriptorsByName:ve,homePageConfigurations:ge,homePageBusinessLogics:he,businessProcessFlows:Ee,siteMap:Ie,ribbons:Pe,ribbonsLabelIds:Te,appContext:we,metadataVersion:Ae,userMetadataVersion:De,complexControls:Re,webResourcesContent:e.WebResourcesContent,landingPageOfflineMetadata:xe}}function k(e){return e&&1===e.length?e[0]:null}function L(e,t){const n=Object.assign({},e);for(const e in t)n.hasOwnProperty(e)?Object.assign(n[e],t[e]):n[e]=t[e];return n}},"5NWd":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var r=n("504W"),a=n("2F73"),i=n("XvL5");function o(e){const t=new Sys.StringBuilder;if(t.append('<a:AllColumns i:type="c:boolean" xmlns:c="http://www.w3.org/2001/XMLSchema">'+(e instanceof a.a?"true":"false")+"</a:AllColumns>"),e instanceof a.a)t.append("<a:Columns />");else{if(!(e instanceof i.a))throw Error.argument("columnSet","XML serialization for this type of column set not supported");t.append('<a:Columns xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays">');for(const n of e.get_Columns())t.append("<b:string>"+n+"</b:string>");t.append("</a:Columns>")}return t.toString()}function s(e){const t=e.selectSingleNode("a:AllColumns");if(!Object(r.a)(t)&&Boolean.parse(t.get_innerText()))return a.a.get_instance();e.addNamespace("sa","http://schemas.microsoft.com/2003/10/Serialization/Arrays");const n=e.selectNodes("a:Columns/sa:string"),o=[];for(let e=0;e<n.get_count();e++)o.push(n.get_item(e).get_innerText());return new i.a(o)}},"5Oca":function(e,t,n){"use strict";n.d(t,"i",(function(){return C})),n.d(t,"h",(function(){return E})),n.d(t,"p",(function(){return F})),n.d(t,"b",(function(){return j})),n.d(t,"e",(function(){return A})),n.d(t,"d",(function(){return D})),n.d(t,"f",(function(){return R})),n.d(t,"v",(function(){return P})),n.d(t,"j",(function(){return T})),n.d(t,"q",(function(){return L})),n.d(t,"n",(function(){return x})),n.d(t,"o",(function(){return M})),n.d(t,"u",(function(){return U})),n.d(t,"s",(function(){return B})),n.d(t,"m",(function(){return q})),n.d(t,"y",(function(){return H})),n.d(t,"r",(function(){return G})),n.d(t,"c",(function(){return K})),n.d(t,"w",(function(){return Q})),n.d(t,"t",(function(){return X})),n.d(t,"g",(function(){return I})),n.d(t,"z",(function(){return z})),n.d(t,"x",(function(){return w})),n.d(t,"k",(function(){return Y})),n.d(t,"l",(function(){return N})),n.d(t,"a",(function(){return r}));var r,a=n("SAYH"),i=n("eXjw"),o=n("odYE"),s=n("504W"),c=n("WPtp"),l=n("LbMF"),u=n("bT7G"),d=n("JOgp"),p=n("wMH2"),g=n("HYaY"),h=n("sdkC"),f=n("IvgJ"),m=n("tHaS"),b=n("iZ7K"),_=n("ZPAw"),y=n("Lyxw"),v=n("3/02"),S=n("64CY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function O(e){return e?e.data:null}function C(e,t){const n=O(e);return n&&n.entities&&n.entities.hasOwnProperty(t)?n.entities[t]:null}function E(e,t,n){const r=C(e,t);return r?r[n]:null}function I(e,t){const n=O(e);return n&&n.entityFilters&&n.entityFilters.hasOwnProperty(t)?n.entityFilters[t]:null}function w(e,t,n,r){const i=function(e,t,n){const r=E(e,t.etn,a.a.toString(t.id));if(r&&r.fields&&r.fields.hasOwnProperty(n)){const e=r.fields[n];if(e)return e.list}return null}(e,t,n);if(i){const a=Object(b.H)(e,t.etn,n);if(0===a)for(const e of i){const t=e.fields.hasOwnProperty("regardingfieldname")?e.fields.regardingfieldname:null;if(r===Object(c.c)(t))return e}else if(2===a)return i[0]}return null}function j(e){return function(t){const n=C(t,e.etn);if(n){const t=a.a.toString(e.id);if(n.hasOwnProperty(t))return n[t]}return null}}function P(e,t){const n=j(t)(e,t.etn);return n&&n.hasOwnProperty("initialized")?n.initialized:null}function T(e,t,n){if(t){const r=j(t)(e,t.etn);if(r&&r.fields){const a={file:()=>Object(y.c)(e,v.Wb)&&Object(y.c)(e,v.nb),image:()=>Object(y.c)(e,v.Yb)&&Object(y.c)(e,v.nb)},i=Object(l.b)(n,t.etn,e);if("file"===i||"image"===i){if(!a[i]||!a[i]())return null;{const a=Object(_.a)(t,n,i);if(r.fields.hasOwnProperty(a)){const i=w(e,t,a,n),o=i?N(i.fields,r&&r.fields&&r.fields[a]&&r.fields[a].timestamp?r.fields[a].timestamp:null,r&&r.fields&&r.fields[a]&&r.fields[a].validationResult?r.fields[a].validationResult:null):null;if(o)return o.timestamp=r.fields[a].timestamp,o.validationResult=r.fields[a].validationResult,o}}}else{if(r.fields.hasOwnProperty(n))return r.fields[n];{const e={productidname:{identifier:"productid",entityNames:["opportunityproduct","quotedetail","salesorderdetail","invoicedetail"]},parentcustomeridname:{identifier:"parentcustomerid",entityNames:["contact"]}},a="name";if(e.hasOwnProperty(n)&&-1!==e[n].entityNames.indexOf(t.etn)){const t=r.fields[e[n].identifier];if(t){const e=t.reference;if(e&&e.hasOwnProperty(a))return N(e[a])}}}}}}return null}function N(e,t,n){return{value:e,timestamp:t||new Date,validationResult:n||{isValueValid:!0,errorMessage:null,errorId:null,userInput:""}}}function A(e,t){const n=j(t)(e,t.etn);return n&&n.businessProcessFlowId?n.businessProcessFlowId:null}function D(e,t){return e&&e.metadata&&e.metadata.businessProcessFlowsDefault&&t&&e.metadata.businessProcessFlowsDefault.hasOwnProperty(t)?e.metadata.businessProcessFlowsDefault[t]:null}function R(e,t){const n=j(t)(e,t.etn);return n&&n.businessProcessFlowInstanceId?n.businessProcessFlowInstanceId:null}function x(e,t){const n=O(e);return n&&n.lists&&n.lists.hasOwnProperty(t)?n.lists[t]:null}function M(e,t){const n=x(e,t);return n?n.initialized:i.a.Uninitialized}function F(e,t,n,r){const a=x(e,t);if(a){if(r)return a.records;if(a.pages&&n>0){const e=a.pages[n];if(e)return a.records.slice(e.startIndex,e.startIndex+a.pageSize)}}return null}function k(e,t,n,r){const a={initialized:t.initialized,identifier:n,fields:{}};if(t)if(r&&r.length)for(const e of r)a.fields[e]=t.fields[e];else a.fields=t.fields;return a}function L(e,t,n,r,a){const i=F(e,t,n,a),o=[];if(!i)return null;for(const t of i){const n=j(t)(e,t.etn);if(n){const e=k(0,n,t,r);o.push(e)}}return o}function B(e,t){const n=x(e,t);return n?n.totalRecordCount:null}function U(e,t,n){const r=x(e,t);return r&&r.pages&&r.pages[n]&&r.pages[n].pagingCookie?e.data.lists[t].pages[n].pagingCookie:null}function V(e,t=r.LatestEntered){return t===r.LastValid?e.value:e.validationResult.userInput||e.value}function z(e,t,n,i,o=r.LatestEntered){if(!e)return!0;if(Object(c.f)(e))return z(e.innerValue,t,n,i,o);const u=Object(l.a)(t,n,i);if(!u||!u.Type)return function e(t){return Object(c.i)(t)?!t.valueString:Object(c.g)(t)?a.a.isNullOrEmpty(t.id):Object(c.k)(t)?!t.reference:Object(c.j)(t)?!t.value:Object(c.f)(t)?e(t.innerValue):Object(c.h)(t)?!t.list:void 0}(e);let d=!1;switch(u.Type){case"partylist":const t=e;t&&t.list&&t.list.length>0&&(d=!0);break;case"boolean":const n=e;!n||"1"!==n.valueString&&"0"!==n.valueString||(d=!0);break;case"picklist":case"state":case"status":const r=e;r&&"-1"!==r.valueString&&!Object(s.b)(r.valueString)&&(d=!0);break;case"multiselectpicklist":const a=V(e,o);-1===a||Object(s.b)(a)||(d=!0);break;case"customer":case"lookup":case"owner":const i=e;i&&!Object(s.b)(i.reference)&&(d=!0);break;case"uniqueidentifier":const c=e;c&&!Object(s.b)(c.id)&&(d=!0);break;case"date":case"datetime":case"decimal":case"double":case"integer":case"string":case"bigint":case"unknown":case"memo":case"money":case"calendarrules":case"virtual":default:const l=V(e,o);Object(s.b)(l)||(d=!0)}return!d}function W(e,t,n,i=r.LatestEntered){switch(n){case"partylist":const n=[],r=t;for(const t of r.list){const r={},a={},i={},s={};for(const n in t.fields){const o=t.fields[n],u=q(e,"activityparty",n,o);if(u){r[n]=u;const t=Object(l.a)(e,"activityparty",n);if(t&&(a[n]=t.Type,Object(c.j)(o))){const e=o;i[n]=e.formatted||null,s[n]=e.formatted||null}}}const u=new g.a(o.a.toLegacyEntityReference(t.identifier),r,a,i,s,new h.a([]));n.push(u)}return new p.a(n,!1,n.length,!1,null,null);case"date":case"datetime":const s=V(t,i),u=Date.parse(s);return isNaN(u)?s:new Date(u);case"picklist":case"boolean":case"state":case"status":const d=t,m=d?d.label:null;let b=d?parseInt(d.valueString,10):null;return isNaN(b)&&(b=null),new f.a(m,b,-1,-1,null,null,null);case"customer":case"lookup":case"owner":const _=t;return _&&_.reference?o.a.toLegacyEntityReference(_.reference):null;case"uniqueidentifier":const y=t;return a.a.toLegacyGuid(y.id);case"multiselectpicklist":const v=V(t,i);return-1===v||null===v?null:Array.isArray(v)?v:v.split(",").map(e=>parseInt(e,10));case"decimal":case"double":case"integer":case"string":case"bigint":case"unknown":case"memo":case"money":case"calendarrules":case"virtual":default:return V(t,i)}}function q(e,t,n,a,i=r.LatestEntered){if(Object(c.f)(a)){const t=new m.a(a.entityLogicalName,a.attributeLogicalName,"aliasedvalue");return"integer"===a.innerType?t.set_value(W(e,a.innerValue,"integer",i)):t.set_value(q(e,a.entityLogicalName,a.attributeLogicalName,a.innerValue)),t}const o=Object(l.a)(e,t,n);if(!o||!o.Type)return null;const s=o.Type;return a?W(e,a,s,i):"partylist"===s?new p.a([],!1,0,!1,null,null):null}function H(e,t,n,a,i=r.LatestEntered){if(Object(S.f)(a))return Object(d.c)(a,e,t,n);const o=Object(u.d)(e,t,n,a);let s;if(n&&n.etn)s=n.etn;else{const n=Object(u.b)(e,t);if(!(n&&n.identifier&&n.identifier.etn))return null;s=n.identifier.etn}return q(e,s,a,o,i)}function G(e,t){const n=x(e,t);return n&&n.pageSize?n.pageSize:null}function K(e,t){const n=t.get_identifier(),r=Object(l.d)(e,n.LogicalName);if(!r)return t.get_fieldNames();const a=Object.keys(r);return t.get_fieldNames().filter(e=>a&&-1===a.indexOf(e))}function Q(e,t){const n=t.get_identifier(),r=t.get_fieldNames(),a=Object(l.d)(e,n.LogicalName),i=new Set;for(const e of r){const n=a[e];if(!n)throw new Error(`The metadata for ${e} attribute is missing in the state tree.`);if("partylist"===n.Type){const n=t.getValue(e).get_entities();for(const e of n)i.add(e.get_identifier().LogicalName)}if("lookup"===n.Type||"customer"===n.Type||"owner"===n.Type){const n=t.getValue(e);n&&n.LogicalName&&i.add(n.LogicalName)}}return Array.from(i)}function X(e,t){if(!t)return null;const n=function(e){return e.data.notifications}(e);return n&&n.length?n.filter(e=>e.forRecord&&o.a.equals(e.forRecord,t)):null}function Y(e,t,n){if(!e||!e.data||!e.data.files)return null;const r=O(e);return r&&r.files&&r.files.hasOwnProperty(t.etn)&&r.files[t.etn][a.a.toString(t.id)]&&r.files[t.etn][a.a.toString(t.id)][n]?r.files[t.etn][a.a.toString(t.id)][n].fileProgress:null}!function(e){e[e.LatestEntered=0]="LatestEntered",e[e.LastValid=1]="LastValid"}(r||(r={}))},"5X+N":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(){return Promise.all([n.e(0),n.e(102)]).then(n.bind(null,"gYJt"))}n.d(t,"a",(function(){return r}))},"5ZBI":function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n("Z/4N");let a;function i(e){a=e}function o(e,t){const n=Object(r.e)(e,t);return n&&n.ConstructorName?n.ConstructorName:t}},"5bWN":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("X37l"),a=n("SAYH");function i(e){const t={EntityTypeName:e.EntityTypeName,LastAccessed:e.LastAccessed,ObjectId:e.ObjectId,PinStatus:e.PinStatus,RecordType:e.RecordType,IsUserView:e.IsUserView,IconPath:e.IconPath,HasPrimaryImageField:e.HasPrimaryImageField};return JSON.stringify(t)}function o(e,t,n=!1){const o=[];switch(e.EntityTypeName||o.push({name:"EntityTypeName",value:"Expected to get correct value for EntityTypeName when we create new recent."}),e.Title||o.push({name:"Title",value:"Expected to get correct value for Title when we create new recent."}),e.LastAccessed?e.LastAccessed instanceof Date&&e.LastAccessed.toISOString||o.push({name:"LastAccessed",value:`Expected type Date. Actual type: ${typeof e.LastAccessed}. Value: ${e.LastAccessed}.`}):o.push({name:"LastAccessed",value:"Expected to get correct value for LastAccessed when we create new recent."}),(a.a.isNullOrEmpty(e.ObjectId)||e.ObjectId.guid===a.a.EMPTYSTRING)&&o.push({name:"ObjectId",value:e.ObjectId?"Expected to get a non-empty string for ObjectId.guid when we create new recent.":"Expected to get correct value for ObjectId when we create new recent."}),e.RecordType){case r.a.Entity:case r.a.Grid:case r.a.Isv:break;default:o.push({name:"RecordType",value:"Expected to get correct value for RecordType when we create new recent."})}return!o.length||(o.push({name:"RecentItem",value:i(e)}),o.push({name:"IsDeleted",value:n}),t.EventManager.ReportComponentFailure("MRU.ValidateRecentItem",new Error("Recent item has incorrect data."),null,o),!1)}},"5d8d":function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"i",(function(){return c})),n.d(t,"h",(function(){return l})),n.d(t,"j",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"g",(function(){return h})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return m})),n.d(t,"c",(function(){return b}));var r=n("dHD5"),a=n("T6Zt"),i=n("ghNp");function o(e){return e.organization.organizationSettings.kmUseExternalPortal}function s(e,t){return e.organization.organizationSettings.kmExternalPortalUrl.replace("{kbnum}",t.articlePublicNumber?t.articlePublicNumber:function(e){const t="MscrmControls.KbSearchControl.KbSearchControl:MscrmControls.KbSearchControl.KbSearchControl",n="value",r=e.searchWidget.list[t].relevanceRecords[n],a=e.searchWidget.list[t].selectedResult;for(let e=0;e<r.length;e++)if(r[e].objectId===a)return r[e].relevanceData.articlepublicnumber;return null}(e))}function c(e){return e.user.userSettings&&e.user.userSettings.usePathBasedUrls}function l(e,t){return e.metadata.entities[t].IsKnowledgeManagementEnabled}function u(e,t){return e.metadata.entities[t].DisplayName}function d(e){return e&&void 0!==e.entityTypeName&&null!==e.entityTypeName}function p(e,t,n,r,c,l){if(Object(i.d)(t,e.parentContextToken,n)instanceof a.a&&r&&r.length>0&&c)for(let e=0;e<r.length;e++){const t={articlePost:{articleId:c.articlePublicNumber+"_"+c.knowledgeArticleId,articleUId:c.knowledgeArticleId,question:c.title,answer:c.content,timesViewed:c.knowledgeArticleViews,createdOn:c.createdon,lastModifiedOn:c.modifiedOn,stateCode:c.stateCode,published:3===c.stateCode,publicUrl:o(l)?s(l,c):""}};r[e].Parameters=[t]}}function g(e,t){const n=Object(r.v)(e);return t.searchWidget&&t.searchWidget.list&&t.searchWidget.list[n]&&t.searchWidget.list[n].currentSearchText?t.searchWidget.list[n].currentSearchText:""}function h(e,t){const n=Object(r.v)(e);return t.searchWidget&&t.searchWidget.list&&t.searchWidget.list[n]&&t.searchWidget.list[n].totalCountString?parseInt(t.searchWidget.list[n].totalCountString,10):0}function f(e,t){const n=Object(r.v)(e);if(t.searchWidget&&t.searchWidget.list&&t.searchWidget.list[n]&&t.searchWidget.list[n].records)for(const e of t.searchWidget.list[n].records)if(e.knowledgeArticleId===t.searchWidget.list[n].selectedResult)return e;return null}function m(e,t,n){const a=Object(r.v)(e);return t.searchWidget&&t.searchWidget.list&&t.searchWidget.list[a]&&t.searchWidget.list[a].records?n>=0&&n<t.searchWidget.list[a].records.length?t.searchWidget.list[a].records[n].knowledgeArticleId:-1:0}function b(e,t){return t.searchWidget&&t.searchWidget.list&&t.searchWidget.list[e]&&t.searchWidget.list[e].numberOfResults?t.searchWidget.list[e].numberOfResults:0}},"5hnz":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * Constants for the modal dialog page.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="dialogCloseIconButton",a="confirmButton"},"5oHv":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the CustomControl page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="KbSearch"},"5qiD":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Workspace=0]="Workspace",e[e.Medium=1]="Medium",e[e.NotCached=2]="NotCached"}(r||(r={}))},"5w+f":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="dialog.initialize";function a(e,t,n=!1,a,i){return{type:"dialog.initialize.async",execute({dispatch:o}){const s=e.getId(),c=e.getName();return o(function(e,t,n,a,i){return{type:r,payload:{input:e,dialogOptions:t,__pageName:n,isDialogStatus:i},meta:{pageId:a}}}(t,a,c,s,n)),o(e.getInitializationAction(i)).then(()=>s)}}}},"5yoC":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(){this.offlineData=null}get_name(){return"Request"}get_xmlNamespace(){return"http://schemas.microsoft.com/crm/2011/Contracts"}toString(){return this.get_name()+"Request"}}},"6/BY":function(e,t,n){"use strict";n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return h}));var r=n("83Lp"),a=n("6fj+"),i=n("69Qu"),o=n("17x/"),s=n("CvZq"),c=n("ff1s"),l=n("Lyxw"),u=n("bvqZ"),d=n("3/02"),p=n("37s6");function g(e,t,n){const u=n.getState(),g=Object(i.b)(u),h=Object(a.c)(u),f=Object(o.a)(u),m=Object(c.b)(u),b=Object(o.c)(u),_=Object(l.c)(u,d.l),y=Object(p.v)(u);e||m||f&&t||b?e&&!g&&h?!y&&_?n.dispatch(Object(r.g)(null,null,null,!0)):Object(l.c)(u,d.je)||n.dispatch(Object(r.h)(s.a.NonBlockingUI)):e&&g&&n.dispatch(Object(r.f)()):n.dispatch(Object(r.h)(s.a.BlockingUI))}function h(e,t,n){if(t&&n){const r={id:"reconnect_notification_toast",level:t,message:n,title:null,type:1,onCloseHandler:null};e(Object(u.b)(r))}}},"64CY":function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="_compositionLinkControl_",a=["AddressCompositionLinkControl","FullNameCompositionLinkControl"];function i(e){const t=o(e);return t?t.map(t=>e+r+t):null}function o(e){switch(e){case"fullname":return["firstname","middlename","lastname"];case"yomifullname":return["yomifirstname","yomimiddlename","yomilastname"];case"address1_composite":return["address1_line1","address1_line2","address1_line3","address1_city","address1_stateorprovince","address1_postalcode","address1_country"];case"address2_composite":return["address2_line1","address2_line2","address2_line3","address2_city","address2_stateorprovince","address2_postalcode","address2_country"];case"address3_composite":return["address3_line1","address3_line2","address3_line3","address3_city","address3_stateorprovince","address3_postalcode","address3_country"];case"billto_composite":return["billto_line1","billto_line2","billto_line3","billto_city","billto_stateorprovince","billto_postalcode","billto_country"];case"shipto_composite":return["shipto_line1","shipto_line2","shipto_line3","shipto_city","shipto_stateorprovince","shipto_postalcode","shipto_country"];default:return null}}function s(e){if(!e)return!1;switch(e.toLowerCase()){case"contact":case"lead":case"systemuser":case"externalparty":case"contact":case"account":case"competitor":case"invoice":case"salesorder":case"quote":return!0}return!1}function c(e){return"address1_composite"===e||"address2_composite"===e||"address3_composite"===e||"billto_composite"===e||"shipto_composite"===e}},"67s4":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("8o18");class a extends r.a{constructor(e,t,n){super(n,t.get_identifier()+"_"+e.toString()),this._entity=t,this._relationship=e}get_relationship(){return this._relationship}toString(){return"RelatedEntityQuery: "+this._entity.get_identifier()+","+this._relationship.toString()+","+super.toString()}}},"69Qu":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return e.serverStatus?e.serverStatus.isAvailable:null}function a(e){return e.serverStatus?e.serverStatus.isNetworkAvailable:null}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}))},"69gE":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("IpQH"),a=n("uM6Y"),i=n("VkXQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class o extends r.a{constructor(e,t){super(e,t,a.h)}IsExecAvailable(){return this.isOperationAvailable(i.h.exec.name)}onSyncStart(){return this.execute(i.h.onSyncStart.name)}onSyncComplete(){return this.execute(i.h.onSyncComplete.name)}onSyncError(){return this.execute(i.h.onSyncError.name)}}},"6G9J":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("GD3x");function a(e){const t=Boolean.parse(e.selectSingleNode("c:ContinueOnError").get_innerText()).valueOf(),n=Boolean.parse(e.selectSingleNode("c:ReturnResponses").get_innerText()).valueOf();return new r.a(t,n)}function i(e){return"<c:ContinueOnError>"+e.get_continueOnError()+"</c:ContinueOnError><c:ReturnResponses>"+e.get_returnResponses()+"</c:ReturnResponses>"}},"6K5O":function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return p}));var r,a=n("a475");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.defaultLevel=0]="defaultLevel",e[e.error=1]="error",e[e.warning=2]="warning",e[e.performance=3]="performance",e[e.info=4]="info",e[e.verbose=5]="verbose",e[e.debug=6]="debug"}(r||(r={}));var i=n("XjOj"),o=n("Div0"),s=n("pNM1");function c(e){u(r.error,e)}function l(e){u(r.info,e)}async function u(e,t){if(a.a.get_Instance().get_isReady())if(a.a.get_Instance().willDispatcherBeAvailableFromDevice("Logging")){(await a.a.get_Instance().get_logging()).logMessage(e,t),d(e,t)}else e===r.error?Object(i.d)(o.a.core,t):e===r.performance?Object(i.g)(o.a.core,t):e===r.verbose?Object(i.i)(o.a.core,t):e===r.warning&&Object(i.j)(o.a.core,t),Object(i.f)(o.a.core,t);else d(e,t)}function d(e,t){let n=s.a.Info;e===r.error?n=s.a.Error:e===r.performance?n=s.a.Perf:e===r.verbose?n=s.a.Verbose:e===r.warning&&(n=s.a.Warning),Object(i.h)(n,t)}async function p(e){if(a.a.get_Instance().willDispatcherBeAvailableFromDevice("Logging")){(await a.a.get_Instance().get_logging()).logTelemetryData(e)}}},"6QGX":function(e,t,n){"use strict";n.d(t,"i",(function(){return u})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return g})),n.d(t,"d",(function(){return h})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return m})),n.d(t,"h",(function(){return b})),n.d(t,"j",(function(){return y})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return _}));var r=n("WPtp"),a=n("Xd5/"),i=n("16wZ"),o=n("SAYH"),s=n("MXaZ"),c=n("IaGr"),l=n("Ae6N");function u(e){return Object(r.j)(e)?e.value:null}function d(e){if(Object(r.j)(e)){const t=[],n=e.value?e.value.split(","):null;for(const e in n)Object(i.a)(n[e])||t.push(parseInt(n[e],10));return t.length>0?t:null}return null}function p(e){if(e&&Object(r.i)(e))switch(e.valueString){case"-1":return null;case"0":return!1;case"1":return!0;default:const t=new Error("Unknown boolean value"),n=[];n.push({name:"value",value:e.valueString}),c.a.getInstance().eventManager.ReportComponentFailure("ClientApi.AttributeValueSelector.getBooleanValue",t,null,n)}return null}function g(e,t,n){if(!Object(r.j)(n)||Object(i.a)(n.value))return null;const o=Object(a.z)(e,t,null,new Date(n.value));let c=null;if(o){const e=new Date;if(c=Object(a.a)(n.formatted,o.controlAttributes.Format,o.cultureInfo,o),o.controlAttributes.Behavior===l.a.UserLocal){const t=(o.userSettings.timeZoneUtcOffsetMinutes+Object(s.p)(new Date,o.userSettings.timeZoneAdjusters))*s.b,n=Object(s.o)(new Date(e.getFullYear(),e.getMonth(),e.getDate()),o.userSettings.timeZoneAdjusters)-Object(s.o)(c,o.userSettings.timeZoneAdjusters),r=c.getTimezoneOffset()*s.b;c=new Date(c.getTime()-t-r+n)}c=new Date(c.getTime()+1e3*new Date(n.value).getSeconds())}else c=new Date(n.value);return c}function h(e){if(Object(r.k)(e)&&!Object(i.a)(e.reference)){const t={entityType:e.reference.etn,id:o.a.externalGuid(e.reference.id),name:e.reference.name},n=new Array;return n.push(t),n}return null}function f(e,t,n){if(Object(r.j)(e)&&!Object(i.a)(e.value)&&""!==e.value)switch(t){case"double":case"decimal":case"money":return isNaN(e.value)?0:parseFloat(n?e.value.toFixed(n):e.value);case"integer":return Math.round(e.value);default:return parseInt(e.value,10)}return null}function m(e){return Object(r.i)(e)&&!Object(i.a)(e.valueString)&&"-1"!==e.valueString?parseInt(e.valueString,10):null}function b(e){if(Object(r.h)(e)){const t=new Array;return Object(i.a)(e.list)||e.list.forEach(e=>{let n;if(e&&e.fields)if(e.fields.partyid){const a=e.fields.partyid;if(Object(r.k)(a)&&a.reference){const e=a.reference;n={entityType:e.etn,id:o.a.externalGuid(e.id),name:e.name},t.push(n)}}else if(e.fields.addressused){const a=e.fields.addressused;n={entityType:"unresolvedaddress",id:o.a.externalGuid(o.a.EMPTY),name:Object(r.e)(a)},t.push(n)}}),t}return null}function _(e){return Object(r.j)(e)?e.value:null}function y(e){if(e){if(Object(r.g)(e))return Object(i.a)(e.id)?null:o.a.externalGuid(e.id);Object(i.k)("ClientApi.AttributeValueSelector.getUniqueIdentifierValue","guid","value.id")}return null}},"6b+r":function(e,t,n){"use strict";n.d(t,"a",(function(){return T})),n.d(t,"b",(function(){return P}));var r=n("nuS9"),a=n("olZa"),i=n("FhVi"),o=n("Afz2"),s=n("YWpA"),c=n("H/hG"),l=n("evW+"),u=n("4fxQ");class d extends r.Component{constructor(e){super(e),this._onShowDetailsClicked=this._onShowDetailsClicked.bind(this),this._onDynamicHelpLinkClicked=this._onDynamicHelpLinkClicked.bind(this),this.state={errorDetailsShown:!1}}_onShowDetailsClicked(){this.setState({errorDetailsShown:!0},()=>{this._setFocus("dialogErrorText")})}_getErrorDetails(){const e=[];let t=0;return this.props.errorDetails&&this.props.errorDetails.forEach(n=>{const a="errorDetail_"+t++;e.push(r.createElement(c.a,{id:a,testhooks:{id:a},key:a},n))}),e}render(){return r.createElement(s.a,{id:"dialogErrorView"},r.createElement(l.a,{accessibilityLabel:this.props.showDetailsLabel,id:"dialogErrorViewlink",testhooks:{id:"dialogErrorViewlink"},onClick:this._onShowDetailsClicked,style:this._styleShowDetailsButton(),tabIndex:this.props.tabIndex,hidden:!this.state.errorDetailsShown},r.createElement(c.a,{id:"dialogErrorViewtext",style:this._buttonTextStyle()},this.props.showDetailsLabel)),r.createElement(s.a,{id:"dialogErrorText",ref:"dialogErrorText",style:this._styleDetails(),tabIndex:this.props.tabIndex,hidden:this.state.errorDetailsShown},this._getErrorDetails(),this._getDownloadLogFileButton()),this._getDynamicHelpLinkButton())}_setFocus(e){const t=this.refs[e];t?u.findDOMNode(t).focus():document.getElementById(this.props.errorOkButtonId).focus()}_styleShowDetailsButton(){return Object.assign(Object.assign({},this._buttonAsHyperlinkStyle(!this.state.errorDetailsShown)),{marginTop:0})}_styleDetails(){return Object.assign({},this.state.errorDetailsShown?{flexDirection:"column"}:{display:"none"})}_buttonTextStyle(){return{color:"#069"}}_buttonAsHyperlinkStyle(e){return{display:e?"flex":"none",backgroundColor:"transparent",borderColor:"transparent",padding:"0",cursor:"pointer",marginTop:"1.25rem",":focus":{borderStyle:"dotted",borderColor:"#666666",borderWidth:"2px"}}}_getDynamicHelpLinkButton(){if(this.props.dynamicHelpOptions&&(this.props.dynamicHelpOptions.errorRegion||this.props.dynamicHelpOptions.helpURL))return r.createElement(l.a,{testhooks:{id:"DynamicHelpbutton"},ref:"dialogErrorDownloadLogFile",accessibilityLabel:this.props.dynamicHelpOptions.label,onClick:this._onDynamicHelpLinkClicked,style:this._buttonAsHyperlinkStyle(!0),tabIndex:this.props.tabIndex},r.createElement(c.a,{id:"DynamicHelptext",style:this._buttonTextStyle()},this.props.dynamicHelpOptions.label))}_getDownloadLogFileButton(){if(!this.props.hideDownloadLogLink)return r.createElement(l.a,{testhooks:{id:"dialogErrorTextbutton"},ref:"dialogErrorDownloadLogFile",accessibilityLabel:this.props.downloadLogFileLabel,onClick:this.props.downloadButtonClicked,style:this._buttonAsHyperlinkStyle(!0),tabIndex:this.props.tabIndex},r.createElement(c.a,{id:"dialogErrorTexttext",style:this._buttonTextStyle()},this.props.downloadLogFileLabel))}_onDynamicHelpLinkClicked(){if(this.props.dynamicHelpOptions.helpURL)this.props.openURL(this.props.dynamicHelpOptions.helpURL);else{const e="https://go.microsoft.com/fwlink/?LinkID=398563&",t=this.props.dynamicHelpOptions.errorCode,n=this.props.dynamicHelpOptions.isOnPrem?"onprem":"online",r=e+"client="+encodeURIComponent(this.props.dynamicHelpOptions.errorRegion)+"&Error="+encodeURIComponent(t)+"&sv="+encodeURIComponent(this.props.dynamicHelpOptions.serverVersion)+"&oid="+encodeURIComponent(this.props.dynamicHelpOptions.orgId)+"&de="+encodeURIComponent(n);this.props.openURL(r)}}}var p=n("u+q+"),g=n("d4He"),h=n("pgSX"),f=n("si7p");class m extends r.Component{constructor(e){super(e),this._hyperlinkClickHandler=this._hyperlinkClickHandler.bind(this),this._ShowErrorDetails=this._ShowErrorDetails.bind(this),this._hyperlinkTextStyle={color:"#069"},this._hyperlinkButtonStyle={display:"flex",backgroundColor:"transparent",borderColor:"transparent",padding:"0",cursor:"pointer",margin:"1px"}}_hyperlinkClickHandler(e,t){e.preventDefault(),this.props.openUrl(t)}_ShowErrorDetails(e,t){this.props.openDialog(t)}_getLinks(){const e=[];return e.push(r.createElement(l.a,{accessibilityLabel:this.props.privacyStatementLabel,id:"dialogLinkViewprivacystatementlink",testhooks:{id:"dialogLinkViewprivacystatementlink"},onClick:e=>this._hyperlinkClickHandler(e,this.props.privacyStatementLink),style:this._hyperlinkButtonStyle,tabIndex:this.props.tabIndex},r.createElement(c.a,{id:"dialogLinkViewprivacystatementlinktext",style:this._hyperlinkTextStyle},this.props.privacyStatementLabel))),e.push(r.createElement(l.a,{accessibilityLabel:this.props.viewErorDetailsLabel,id:"dialogLinkViewviewerrorslink",testhooks:{id:"dialogLinkViewviewerrorslink"},onClick:e=>this._ShowErrorDetails(e,this.props.text),style:this._hyperlinkButtonStyle,tabIndex:this.props.tabIndex},r.createElement(c.a,{id:"dialogLinkViewviewerrorslinktext",style:this._hyperlinkTextStyle},this.props.viewErorDetailsLabel))),e.push(r.createElement(l.a,{accessibilityLabel:this.props.howToChangeNotificationSettingsLabel,id:"dialogLinkViewnotificationlink",testhooks:{id:"dialogLinkViewnotificationlink"},onClick:e=>this._hyperlinkClickHandler(e,this.props.howToChangeNotificationSettingslink),style:this._hyperlinkButtonStyle,tabIndex:this.props.tabIndex},r.createElement(c.a,{id:"dialogLinkViewnotificationlinktext",style:this._hyperlinkTextStyle},this.props.howToChangeNotificationSettingsLabel))),e}render(){return r.createElement(s.a,{id:"dialogUnhandledErrorView"},r.createElement(c.a,{accessibilityLabel:this.props.text,id:"dialogMessageName",testhooks:{id:"dialogMessageNametext"}},this.props.text),r.createElement(s.a,{id:"dialogUnhandledErrorViewview"},this._getLinks()))}}const b=Object(p.a)(void 0,(function(e,t){const n={height:"22rem",width:"36rem"};return{openUrl:t=>e(Object(g.a)(t)),openDialog:r=>e(Object(h.a)(f.a,t.errorData,n,void 0,t.showErrorDetailsDialogTitle,t.showErrorDetailsDialogSubTitle,void 0,"",void 0,void 0,t.id))}}))(m);var _=n("3rse"),y=n("znb3"),v=n("XIN1"),S=n("YxC/"),O=n("5hnz"),C=n("H4dV"),E=n("RJiR"),I=n("I6RZ"),w=n("voMr");class j extends r.Component{constructor(e){super(e),this._onCloseHandler=this._onCloseHandler.bind(this),this._onCancelClick=this._onCancelClick.bind(this),this._onConfirmClick=this._onConfirmClick.bind(this),this._confirmAndSignIn=this._confirmAndSignIn.bind(this),this._confirmAndSignOutSignIn=this._confirmAndSignOutSignIn.bind(this)}_onConfirmClick(e){this._isActive()&&this.props.confirmAndClose()}_confirmAndSignIn(e){this._isActive()&&this.props.confirmAndDoSignin()}_confirmAndSignOutSignIn(e){this._isActive()&&this.props.confirmAndDoSignoutSignin()}_onCancelClick(e){this._isActive()&&this.props.close()}_onCloseHandler(e){if(e.keyCode===_.a.Escape){if(!this._isActive())return;e.stopImmediatePropagation(),this.props&&this.props.dismiss()}}_renderContentContainer(){return r.createElement(s.a,{id:"modalDialogContentContainer",key:"modalDialogContentContainer",style:this.props.modalDialogContentContainerStyle},this._renderHeader(),this._renderTextContainer(),this._renderButtonsContainer())}_renderHeader(){return r.createElement(s.a,{id:"modalDialogHeader",key:"modalDialogHeader",style:this.props.modalDialogHeaderStyle},this._renderTitleContainer(),this._renderSubtitleContainer())}_renderIcon(){return this.props.dialogOptions&&this.props.dialogOptions.type&&(f.f||this.props.modalDialogType===f.d||this.props.modalDialogType===f.g)?r.createElement(s.a,{style:this.props.modalDialogIconStyle},this._getMessageIcon(this.props.dialogOptions.type,"")):null}_getMessageIcon(e,t){switch(e.toLowerCase()){case"error":return r.createElement(v.b,{id:"errorIcon",type:y.a.ErrorIcon,testhooks:{id:"errorIcon"},style:this.props.modalDialogIconSymbolStyle});case"abandon":return r.createElement(v.b,{id:"abandonIcon",type:y.a.Abandon,testhooks:{id:"abandonIcon"},style:this.props.modalDialogIconSymbolStyle});case"warning":return r.createElement(v.b,{id:"warningIcon",type:y.a.Warning,testhooks:{id:"warningIcon"},style:this.props.modalDialogIconSymbolStyle});case"information":return r.createElement(v.b,{id:"informationIcon",type:y.a.InformationIcon,testhooks:{id:"informationIcon"},style:this.props.modalDialogIconSymbolStyle});default:return""}}_renderTitleContainer(){return r.createElement(s.a,{id:"dialogTitleContainer",key:"dialogTitleContainer",style:this.props.modalDialogTitleContainerStyle},this._renderIcon(),this._renderTitle(),this._renderCloseIconButton())}_renderCloseIconButton(){const e=Object(S.c)(this.props.resourceStrings,a.b);return r.createElement(l.a,{id:O.a,key:O.a,style:this.props.modalDialogCloseIconButtonStyle,tabIndex:0,onClick:this.props.dismiss,accessibilityLabel:e,testhooks:{id:"dialogCloseIconButton"},title:e},r.createElement(v.b,{id:"dialogCloseIcon",key:"dialogCloseIcon",type:y.a.Cancel,style:this.props.modalDialogCloseIconStyle}))}_renderTitle(){const{modalDialogTitleViewStyle:e}=this.props;return r.createElement(s.a,{id:"dialogTitleView",key:"dialogTitleView",style:e},this._renderTitleText())}_renderTitleText(){const{modalDialogTitleStyle:e,modalDialogType:t}=this.props;let n=this.props.title;return t===f.e&&(n=Object(S.c)(this.props.resourceStrings,a.d)),n?r.createElement(c.a,{id:"dialogTitleText",testhooks:{id:"dialogTitleText"},key:"dialogTitleText",accessibilityLabel:n,semanticTag:"h1",tabIndex:this._isIE()?-1:void 0,style:e},P(n)?this._getMultiLineHtml(n):n):null}_getMultiLineHtml(e){const t=e.split("\n"),n=[t[0]];for(let e=1;e<t.length;e++)n.push(r.createElement("br")),n.push(t[e]);return r.createElement(r.Fragment,null,n)}_renderSubtitleContainer(){const{subtitle:e,modalDialogSubtitleContainerStyle:t}=this.props;if(e)return r.createElement(s.a,{id:"dialogSubtitleContainer",key:"dialogSubtitleContainer",style:t},this._renderSubtitle())}_renderSubtitle(){const{modalDialogType:e,modalDialogSubtitleStyle:t,subtitle:n}=this.props;return e===f.a||e===f.c||f.f||e===f.d||e===f.g?r.createElement(c.a,{style:t,id:"subtitle",semanticTag:"h2",testhooks:{id:"errorDialog_subtitle"},accessibilityLabel:n,tabIndex:this._isIE()?-1:void 0},n):null}_renderTextContainer(){let e;const{modalDialogType:t,text:n,modalDialogTextContainerStyle:i,modalDialogTextStyle:o}=this.props;if(t===f.d)e=this._renderErrorDetails();else if(t===f.e)e=Object(S.c)(this.props.resourceStrings,a.e);else if(t===f.g)e=this._renderUnhandledErrorDetails();else{if(P(n))return this._renderAsMultilineText(n);e=n?n.toString():""}return r.createElement(s.a,{id:"dialogTextContainer",key:"dialogTextContainer",style:i},r.createElement(c.a,{id:"dialogMessageText",key:"dialogMessageText",testhooks:{id:"dialogMessageText"},style:o},e))}_renderAsMultilineText(e){const{modalDialogTextStyle:t,modalDialogTextContainerStyle:n}=this.props,a=e.split("\n").map((e,n)=>{const a="dialogMessageTextLine"+n;return r.createElement(c.a,{accessibilityLabel:e,id:a,key:a,role:o.f,style:t},e)});return r.createElement(s.a,{id:"dialogTextContainer",key:"dialogTextContainer",style:n},a)}_getMultiLineTextIds(e){return e?e.split("\n").map((e,t)=>"dialogMessageTextLine"+t).join(" "):""}_renderErrorDetails(){const{confirmAndClose:e,errorDetails:t,showDetailsLabel:n,hideDownloadLogLink:a,confirmButtonLabel:i,dynamicHelpOptions:o,openURL:s}=this.props;return r.createElement(d,{downloadButtonClicked:e,errorDetails:t,showDetailsLabel:n,hideDownloadLogLink:a,downloadLogFileLabel:i,errorOkButtonId:"cancelButton",tabIndex:0,dynamicHelpOptions:o,openURL:s})}_renderButtonsContainer(){const{modalDialogType:e,modalDialogButtonContainerStyle:t}=this.props;if(e)return r.createElement(s.a,{id:"buttonView",key:"buttonView",style:t,className:"dialogButtons"},this._renderButtons())}_renderUnhandledErrorDetails(){const{errorDetails:e,text:t}=this.props;return r.createElement(b,{id:this.props.id,text:t,privacyStatementLabel:e[0],privacyStatementLink:e[1],howToChangeNotificationSettingsLabel:e[2],howToChangeNotificationSettingslink:e[3],viewErorDetailsLabel:e[4],showErrorDetailsDialogTitle:e[5],showErrorDetailsDialogSubTitle:e[6],errorData:e[7],errorDetails:[t],tabIndex:0})}_renderButtons(){const e=[],t=this.props.confirmButtonLabel?this.props.confirmButtonLabel:Object(S.c)(this.props.resourceStrings,a.f);if(this.props)switch(this.props.modalDialogType){case f.a:e.push(r.createElement(l.a,{style:this.props.modalDialogPrimaryButtonStyle,id:"okButton",key:"okButton",onClick:this._onConfirmClick,tabIndex:0,accessibilityLabel:t,testhooks:{id:"okButton"}},r.createElement(c.a,{id:"okButtonText",key:"okButtonText",style:this.props.modalDialogPrimaryButtonTextStyle},t)));break;case f.c:case f.e:{const n=this.props.cancelButtonLabel?this.props.cancelButtonLabel:Object(S.c)(this.props.resourceStrings,a.a);e.push(r.createElement(l.a,{id:O.b,key:O.b,style:this.props.modalDialogPrimaryButtonStyle,onClick:this._onConfirmClick,tabIndex:0,accessibilityLabel:t,testhooks:{id:"confirmButton"}},r.createElement(c.a,{id:"confirmButtonText",key:"confirmButtonText",style:this.props.modalDialogPrimaryButtonTextStyle},t))),e.push(r.createElement(l.a,{id:"cancelButton",key:"cancelButton",style:this.props.modalDialogDefaultButtonStyle,onClick:this._onCancelClick,tabIndex:0,accessibilityLabel:n,testhooks:{id:"cancelButton"}},r.createElement(c.a,{id:"cancelButtonTextName",key:"cancelButtonTextName",style:this.props.modalDialogDefaultButtonTextStyle},n)));break}case f.d:{const t=this.props.cancelButtonLabel?this.props.cancelButtonLabel:Object(S.c)(this.props.resourceStrings,a.a);e.push(r.createElement(l.a,{id:"cancelButton",key:"cancelButton",style:this.props.modalDialogPrimaryButtonStyle,onClick:this._onCancelClick,tabIndex:0,accessibilityLabel:t,testhooks:{id:"errorOkButton"}},r.createElement(c.a,{id:"okButtonText",key:"okButtonText",style:this.props.modalDialogPrimaryButtonTextStyle},t)));break}case f.f:{const n=this.props.cancelButtonLabel?this.props.cancelButtonLabel:Object(S.c)(this.props.resourceStrings,a.a);e.push(r.createElement(l.a,{id:O.b,key:O.b,style:this.props.modalDialogPrimaryButtonStyle,onClick:this._confirmAndSignIn,tabIndex:0,accessibilityLabel:t,testhooks:{id:"confirmButton"}},r.createElement(c.a,{id:"confirmButtonText",key:"confirmButtonText",style:this.props.modalDialogPrimaryButtonTextStyle},t))),e.push(r.createElement(l.a,{id:"cancelButton",key:"cancelButton",style:this.props.modalDialogDefaultButtonStyle,onClick:this._onCancelClick,tabIndex:0,accessibilityLabel:n,testhooks:{id:"cancelButton"}},r.createElement(c.a,{id:"cancelButtonTextName",key:"cancelButtonTextName",style:this.props.modalDialogDefaultButtonTextStyle},n)));break}case f.b:{const n=this.props.cancelButtonLabel?this.props.cancelButtonLabel:Object(S.c)(this.props.resourceStrings,a.a);e.push(r.createElement(l.a,{id:O.b,key:O.b,style:this.props.modalDialogPrimaryButtonStyle,onClick:this._confirmAndSignOutSignIn,tabIndex:0,accessibilityLabel:t,testhooks:{id:"confirmButton"}},r.createElement(c.a,{id:"confirmButtonText",key:"confirmButtonText",style:this.props.modalDialogPrimaryButtonTextStyle},t))),e.push(r.createElement(l.a,{id:"cancelButton",key:"cancelButton",style:this.props.modalDialogDefaultButtonStyle,onClick:this._onCancelClick,tabIndex:0,accessibilityLabel:n,testhooks:{id:"cancelButton"}},r.createElement(c.a,{id:"cancelButtonTextName",key:"cancelButtonTextName",style:this.props.modalDialogDefaultButtonTextStyle},n)));break}case f.g:{const t=this.props.cancelButtonLabel?this.props.cancelButtonLabel:Object(S.c)(this.props.resourceStrings,a.a),n=this.props.confirmButtonLabel?this.props.confirmButtonLabel:Object(S.c)(this.props.resourceStrings,a.f);e.push(r.createElement(l.a,{id:"sendReportButton",key:"sendReportButton",style:this.props.modalDialogPrimaryButtonStyle,onClick:this._onConfirmClick,tabIndex:0,accessibilityLabel:n,testhooks:{id:"sendReportButton"}},r.createElement(c.a,{id:"sendReportButtonTextName",key:"sendReportButtonTextName",style:this.props.modalDialogPrimaryButtonTextStyle},n)),r.createElement(l.a,{id:"dontSendReportButton",key:"dontSendReportButton",style:this.props.modalDialogDefaultButtonStyle,onClick:this._onCancelClick,tabIndex:0,accessibilityLabel:t,testhooks:{id:"dontSendReportButton"}},r.createElement(c.a,{id:"dontSendReportButtonTextName",key:"dontSendReportButtonTextName",style:this.props.modalDialogDefaultButtonTextStyle},t)));break}}return e}_renderAccessibilityComponent(e){let t;const{modalDialogType:n}=this.props;switch(n){case f.a:t="okButton";break;case f.c:case f.e:case f.f:t=O.b;break;case f.g:t="sendReportButton";break;case f.d:t="cancelButton"}return r.createElement(i.a,{key:"modalDialogAccessibility",rootElementId:e,isModal:!0,shouldManageFocus:!0,defaultFocusId:t,overrideFocusId:t})}_isActive(){return this.props&&this.props.activeDialog}_isIE(){return C.a.getInstance().get_IsBrowserIE()}render(){const{id:e,modalDialogOuterContainerStyle:t,modalDialogStyle:n,modalDialogType:a,text:i,title:c}=this.props,l="modalDialogRoot_"+e,u="modalDialogView_"+e,d=i&&"string"==typeof i&&i.indexOf("\n")>-1?this._getMultiLineTextIds(i):"dialogMessageText";let p=c?"dialogTitleText":void 0,g=i?d:void 0;return p||(p=i?d:void 0,g=void 0),r.createElement(s.a,{id:l,key:l,style:t,tabIndex:-1},this._renderAccessibilityComponent(l),r.createElement(s.a,{id:u,key:u,labelledByElementId:p,describedByElementId:g,style:n,role:o.e,testhooks:{id:a+"dialog"},tabIndex:-1,accessibilityModal:!0},this._renderContentContainer()))}componentDidMount(){document.addEventListener("keydown",this._onCloseHandler),this._elementFocusedBeforeDialogWasOpened=document.activeElement}componentWillUnmount(){document.removeEventListener("keydown",this._onCloseHandler),this.props.dialogOptions&&this.props.dialogOptions.restoreFocus&&this._elementFocusedBeforeDialogWasOpened&&this._elementFocusedBeforeDialogWasOpened.focus()}}function P(e){return e&&"string"==typeof e&&e.indexOf("\n")>-1}function T(e){if(Object(p.d)(t=>Object(I.a)(t,e.id))===w.a.Native){const{activeDialog:t,title:n,text:a,cancelButtonLabel:i,close:o,confirmButtonLabel:s,confirmAndClose:c}=e;return r.createElement(E.a,{title:n,message:a,cancelLabel:i,cancel:()=>t&&o(),confirmLabel:s,confirm:()=>t&&c()})}return r.createElement(j,Object.assign({},e))}j.displayName="ModalDialogRoot"},"6eYz":function(e,t,n){"use strict";function r(e){return e.popupNotifications}function a(e,t){return e.popupNotifications[t]}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},"6fj+":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return l}));var r=n("504W"),a=n("CvZq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e){return!(!e||!e.reconnectNotification||Object(r.a)(e.reconnectNotification.isReconnectNotificationShown))&&e.reconnectNotification.isReconnectNotificationShown}function o(e){return!!e.reconnectNotification.showReconnectNotificationAfterUpsync}function s(e){return!(!e||!e.reconnectNotification||Object(r.a)(e.reconnectNotification.isServerUnavailableNewSession))&&e.reconnectNotification.isServerUnavailableNewSession}function c(e){return!(e&&e.reconnectNotification&&!Object(r.a)(e.reconnectNotification.isReconnectSuccessful))||e.reconnectNotification.isReconnectSuccessful}function l(e){return e&&e.reconnectNotification&&e.reconnectNotification.type?e.reconnectNotification.type:a.a.NonBlockingUI}},"6hHv":function(e,t,n){"use strict";n.d(t,"c",(function(){return ue})),n.d(t,"e",(function(){return le})),n.d(t,"d",(function(){return de})),n.d(t,"a",(function(){return ce})),n.d(t,"b",(function(){return se}));var r=n("M0zh"),a=n("2yvP"),i=n("SAYH"),o=n("iZ7K"),s=n("IKHO"),c=n("omgb"),l=n("w1eR"),u=n("GYEz"),d=n("eXjw"),p=n("NjDY"),g=n("IqkD"),h=n("Lyxw"),f=n("TDVd"),m=n("69Qu"),b=n("LbMF"),_=n("3hnk"),y=n("bT7G"),v=n("WPtp"),S=n("5Oca"),O=n("i1f0"),C=n("dHD5"),E=n("3mEc"),I=n("pEXn"),w=n("kWiz"),j=n("FZDd"),P=n("lY/Z"),T=n("P6DH"),N=n("nlPs"),A=n("eD3A"),D=n("V6aM"),R=n("hAdb"),x=n("sZ+8"),M=n("bwbe"),F=n("xhhr"),k=n("iDqy"),L=n.n(k);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const B={True:{toString:()=>"true"},False:{toString:()=>"false"},Skipped:{toString:()=>"skipped"}};function U(e){return!1===e?B.False:B.True}function V(e,t){return e.some(e=>!1===e||e===B.False)?B.False:t&&e.some(e=>e===B.Skipped)?B.Skipped:B.True}var z=n("UJfx"),W=n("odYE"),q=n("Y2Yg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const H=["XrmCore.Rules.Online.IsEntityAvailableForUserInMocaOffline".toLowerCase(),"XrmCore.Rules.Online.IsCustomActivityAvailableForUserInMocaOffline".toLowerCase()],G=["XrmCore.Rules.HierarchyView.isValidForHierarchyPageInUC".toLowerCase()];class K{constructor(e,t,n,r,a,i){this._pageId=e,this._commandManagerId=t,this._state=n,this._getState=r,this._applicationContext=a,this._dispatch=i,this._ruleCache={},this._evaluateParameters=new f.a}hasOfflineRuleForCommand(e,t,n){return this._searchForSpecificJavaScriptRuleForCommand(e,t,n,H)}hasHierarchyRuleForCommand(e,t,n){return this._searchForSpecificJavaScriptRuleForCommand(e,t,n,G)}hasSelectionCountRuleForCommand(e,t,n){return this._searchForRuleTypeForCommand(e,t,n,5)}isNonCacheableRule(e,t,n){return this._searchForRuleForCommand(e,[t],n,4,e=>f.a.containsCommandPropertiesReference(e.Parameters))}_searchForRuleTypeForCommand(e,t,n,r){return this._searchForRuleForCommand(e,t,n,r,()=>!0)}_searchForSpecificJavaScriptRuleForCommand(e,t,n,r){return this._searchForRuleForCommand(e,t,n,4,e=>e&&e.FunctionName&&-1!==r.indexOf(e.FunctionName.toLowerCase()))}_searchForRuleForCommand(e,t,n,r,a){return t.some(t=>{if(e&&e[n]){const i=e[n];if(i&&i[t]){const e=i[t];return e&&this._searchForRule(e.Rules,r,a)}}return!1})}_searchForRule(e,t,n){return e&&e.some(e=>{switch(e.RuleType){case t:return n(e);case 2:const r=e;return r.OrGroups&&r.OrGroups.some(e=>this._searchForRule(e.Rules,t,n))}return!1})}evaluateSyncRulesForCommand(e,t,n,r,a,i,o,s,c,l,u){const d=[];if(i&&d.push({name:"IndexEntity",value:i}),o&&d.push({name:"ControlId",value:o}),c&&d.push({name:"ContextKey",value:c}),r.length>0&&d.push({name:"CommandRules",value:r.join(",")}),a.EntityLogicalName&&d.push({name:"ContextEntity",value:a.EntityLogicalName}),a.ContextType&&d.push({name:"RibbonContextType",value:a.ContextType}),s&&d.push({name:"CommandManagerId",value:s}),this._trace(w.a.Verbose,"Start evaluate synchronous rules for",d),!e)return this._trace(w.a.Info,"Did not evaluate rules, because rule set array is empty",d),B.False;for(const t in r){const o=r[t];if(e[i]){const t=e[i];if(t[o]){const e=this._getRulePartsResultsForRuleId(o,n,l,u),r=this._evaluateSyncRuleParts(o,t[o].Rules,a,s,c,d,e);switch(n){case se:l[o].ruleIdResult=this._isNullOrUndefined(r)?null:r.toString(),l[o].rulePartsResults=e;break;case ce:default:u[o].ruleIdResult=this._isNullOrUndefined(r)?null:r.toString(),u[o].rulePartsResults=e}if(r===B.False)return B.False}}}return B.True}evaluateAsyncRulesForCommand(e,t,n,r,a,i,o,s,c,l,u){const d=[];if(i&&d.push({name:"IndexEntity",value:i}),o&&d.push({name:"ControlId",value:o}),c&&d.push({name:"ContextKey",value:c}),r.length>0&&d.push({name:"CommandRules",value:r.join(",")}),a.EntityLogicalName&&d.push({name:"ContextEntity",value:a.EntityLogicalName}),a.ContextType&&d.push({name:"RibbonContextType",value:a.ContextType}),this._trace(w.a.Verbose,"Start evaluate asynchronous rules for",d),!e)return this._trace(w.a.Info,"Do not evaluate rules, because rule set array is empty",d),Promise.resolve(B.False);const p=[],g={};for(const h in r){const f=r[h];if(e[i]){const r=e[i][f];if(r){const e=!(t&&t[i]&&t[i][f]),h=this._getRulePartsResultsForRuleId(f,n,l,u),m=h.some(e=>e.rulePartResult===B.Skipped.toString()),b=e&&this._ruleCache[n]&&this._ruleCache[n][f]&&!m?this._ruleCache[n][f]:this._evaluateAsyncRuleParts(f,r.Rules,a,o,s,c,n,d,g,h);!e||this._ruleCache[n]&&this._ruleCache[n][f]&&!m||(this._ruleCache[n]||(this._ruleCache[n]={}),this._ruleCache[n][f]=b),p.push(b)}}}return p.length>0?Promise.all(p).then(e=>{let t=`Results of rule evaluation for indexEntity ${i} commandManagerId ${s}, control ${o}: `;switch(e.forEach((e,n)=>{t+=`${r[n]}: ${e.ruleIdResult} `}),this._trace(w.a.Verbose,t),n){case se:e.forEach(e=>{l[e.ruleId].ruleIdResult=this._isNullOrUndefined(e.ruleIdResult)?null:e.ruleIdResult.toString(),l[e.ruleId].rulePartsResults=e.rulePartsResults});break;case ce:default:e.forEach(e=>{u[e.ruleId].ruleIdResult=this._isNullOrUndefined(e.ruleIdResult)?null:e.ruleIdResult.toString(),u[e.ruleId].rulePartsResults=e.rulePartsResults})}const a=V(e.map(e=>e.ruleIdResult),!0);return d.push({name:"Result",value:a.toString()}),this._trace(w.a.Info,"Finish evaluate all rules for",d),a}).catch(e=>(d.push({name:"Result",value:"false"}),this._applicationContext.EventManager.ReportComponentFailure("Commanding.Components.RuleEvaluator.evaluateAsyncRulesForCommand",e,"Error on rule evaluate",d),B.False)):(d.push({name:"Result",value:"true"}),this._trace(w.a.Info,"Finish evaluate rules as there wasn't any",d),Promise.resolve(B.True))}_getRulePartsResultsForRuleId(e,t,n,r){switch(t){case se:return e in n||(n[e]={ruleIdResult:null,rulePartsResults:[]}),n[e].rulePartsResults;case ce:default:return e in r||(r[e]={ruleIdResult:null,rulePartsResults:[]}),r[e].rulePartsResults}}_evaluateSyncRuleParts(e,t,n,r,a,i,o){if(!t)return B.True;let s=B.True;for(let c=0;c<t.length&&s!==B.False;c++){const l=t[c];if(l){switch(l.RuleType){case 8:s=U(this.TelemetryReport(e,this._EvaluateClientRulePart(l,n),"ClientRule",i,l));break;case 26:s=U(this.TelemetryReport(e,this._EvaluateCommandClientTypeRulePart(l,n),"CommandClientTypeRule",i,l));break;case 23:s=U(this.TelemetryReport(e,this._EvaluateCrmOutlookClientVersionRulePart(l,n),"CrmOutlookClientVersionRule",i,l));break;case 31:s=U(this.TelemetryReport(e,this._EvaluateDeviceTypeRulePart(l,n),"DeviceTypeRule",i,l));break;case 1:s=U(this.TelemetryReport(e,this._EvaluateEntityRulePart(l,n),"EntityRule",i,l));break;case 7:s=U(this.TelemetryReport(e,this._EvaluateFormStateRulePart(l,n,a),"FormStateRule",i,l));break;case 16:s=U(this.TelemetryReport(e,this._EvaluateOfflineAccessStateRulePart(l,n),"OfflineAccessStateRule",i,l));break;case 10:s=U(this.TelemetryReport(e,this._EvaluateOutlookClientRulePart(l,n),"OutlookClientRule",i,l));break;case 19:s=U(this.TelemetryReport(e,this._EvaluateOutlookItemTrackingRulePart(l,n),"OutlookItemTrackingRule",i,l));break;case 17:s=U(this.TelemetryReport(e,this._EvaluateOutlookVersionRulePart(l,n),"OutlookVersionRule",i,l));break;case 12:s=U(this.TelemetryReport(e,this._EvaluatePageRulePart(l,n),"PageRule",i,l));break;case 5:s=U(this.TelemetryReport(e,this._EvaluateSelectionCountRulePart(l,n),"SelectionCountRule",i,l));break;case 11:s=U(this.TelemetryReport(e,this._EvaluateSkuRulePart(l,n),"SkuRule",i,l));break;case 3:s=U(this.TelemetryReport(e,this._EvaluateValueRulePart(l,n),"ValueRule",i,l));break;case 21:s=U(this.TelemetryReport(e,this._EvaluateFormEntityContextRulePart(l,n),"FormEntityContextRule",i,l));break;case 9:s=U(this.TelemetryReport(e,this._EvaluateOrganizationSettingRulePart(l,n),"OrganizationSettingRule",i,l));break;case 18:s=U(this.TelemetryReport(e,this._EvaluateOutlookRenderTypeRulePart(l,n),"OutlookRenderTypeRule",i,l));break;case 13:s=U(this.TelemetryReport(e,this._EvaluateMiscellaneousPrivilegeRulePart(l,n),"MiscellaneousPrivilegeRule",i,l));break;case 20:s=U(this.TelemetryReport(e,this._EvaluateRelationshipTypeRulePart(l,n,r),"RelationshipTypeRule",i,l));break;case 24:s=U(this.TelemetryReport(e,this._EvaluateOptionSetRulePart(l,n),"OptionSetRule",i,l));break;case 35:s=U(this.TelemetryReport(e,this._EvaluateFeatureControlRulePart(l,n),"FeatureControlRule",i,l));break;case 25:s=U(this.TelemetryReport(e,this._EvaluateFormTypeRulePart(l,n),"FormTypeRule",i,l));break;case 27:s=U(this.TelemetryReport(e,this._EvaluateHideForTabletExperienceRulePart(l,n),"HideForTabletExperienceRule",i,l));break;case 42:s=U(this.TelemetryReport(e,this._EvaluateHideIfPowerBITileNotAvailableRulePart(l,n),"HideIfPowerBITileNotAvailable",i,l));break;case 4:case 2:case 15:case 6:case 22:s=B.Skipped;break;default:s=U(this.TelemetryReport(e,!1,"DefaultRule",i,l))}o[c]={rulePartType:l.RuleType.toString(),rulePartResult:s.toString()}}}return s}_evaluateAsyncRuleParts(e,t,n,r,a,i,o,s,c,l){if(!t)return Promise.resolve({ruleId:e,ruleIdResult:B.True,rulePartsResults:l});const u=[];c.rulePartCount=t.length;for(let d=0;d<t.length;d++){const p=t[d],g=d;if(p)switch(p.RuleType){case 4:u.push(this._TelemetryReportWithRulePartIndex(e,this._EvaluateJavaScriptRulePart(p,n,r,i,c),"JavaScriptRule",s,p,g));break;case 2:const t={rulePartType:p.RuleType.toString(),rulePartResult:null,orGroupsResults:[]};l[d]=t,u.push(this._TelemetryReportWithRulePartIndex(e,this._EvaluateOrBlockRulePart(e,p,n,r,a,i,o,s,t),"OrBlockRule",s,p,g));break;case 15:u.push(this._TelemetryReportWithRulePartIndex(e,this._EvaluateEntityPropertyRulePart(p,n),"EntityPropertyRule",s,p,g));break;case 6:switch(o){case se:u.push(this._TelemetryReportWithRulePartIndex(e,this._EvaluateRecordPrivilegeRulePart(p,n,o),"RecordPrivilegeRule",s,p,g));break;case ce:default:u.push(this._TelemetryReportWithRulePartIndex(e,this._EvaluateEntityPrivilegeRulePart(p,n,o),"EntityPrivilegeRule",s,p,g))}break;case 22:u.push(this._TelemetryReportWithRulePartIndex(e,this._EvaluateReferencingAttributeRequiredRulePart(p,n,a),"ReferencingAttributeRequiredRule",s,p,g))}}return u.length>0?Promise.all(u).then(t=>{const n=V(t.map(e=>e.rulePartResult),!0);return t.forEach(e=>{2!==e.rulePartType&&(l[e.rulePartIndex]={rulePartType:this._isNullOrUndefined(e.rulePartType)?null:e.rulePartType.toString(),rulePartResult:this._isNullOrUndefined(e.rulePartResult)?null:e.rulePartResult.toString()})}),{ruleId:e,ruleIdResult:n,rulePartsResults:l}}).catch(()=>({ruleId:e,ruleIdResult:B.False,rulePartsResults:l})):Promise.resolve({ruleId:e,ruleIdResult:B.True,rulePartsResults:l})}_TelemetryReportWithRulePartIndex(e,t,n,r,a,i){return this.TelemetryReport(e,t,n,r,a).then(e=>({rulePartResult:e,rulePartType:a.RuleType,rulePartIndex:i}))}TelemetryReport(e,t,n,r,a){const i=[];for(const e of r)i.push(e);if(e&&i.push({name:"RuleId",value:e}),a.RuleType&&i.push({name:"RuleType",value:a.RuleType}),n&&i.push({name:"RuleEvaluator",value:n}),4===a.RuleType){const e=a;e.FunctionName&&i.push({name:"FunctionName",value:e.FunctionName}),e.Library&&i.push({name:"Library",value:e.Library})}const o=e=>{if(i.push({name:"Result",value:V([e],!1).toString()}),this._trace(w.a.Verbose,"Rule evaluation finished for "+n,i),Object(R.g)(this._state)){let e="Rule Evaluated: ";const t=[];for(const n of i)"CommandRules"!==n.name&&(e+="%c"+n.name+":%c"+n.value+"; ",t.push("color:FireBrick;"),n.value===B.True.toString()?t.push("color:green;"):n.value===B.False.toString()?t.push("color:red;"):n.value===B.Skipped.toString()?t.push("color:gray;"):t.push("color:blue;"));console.log(e,...t)}},s=e=>{i.push({name:"Error",value:e?e.toString():""}),this._trace(w.a.Error,"Rule evaluation failed for "+n,i)};return t&&"function"==typeof t.then?t.then(o,s):"boolean"==typeof t?o(t):s(new Error("Unexpected result of type "+typeof t)),t}static _SharedRuleBehavior(e,t){return null==t&&(t=e.DefaultValue),e.InvertResult?!t:t}_EvaluateClientRulePart(e,t){return!(!e||!t)&&K._SharedRuleBehavior(e,1===e.ClientType)}_EvaluateEntityRulePart(e,t){let n=null;if(!e||!t)return!1;if(t){let r=e.AppliesTo;const a=t.ContextEntityLogicalName?t.ContextEntityLogicalName:t.EntityLogicalName;r||(r=1);let i=null,s=null;switch(t.ContextType){case 1:s="HomePageGrid";break;case 2:s="Form";break;case 3:s="SubGridStandard";break;case 4:s="SubGridRelated";break;case 5:s="CreateForm";break;case 6:s="SubGridAssociated";break;case 7:s="Card";break;case 8:s="Dashboard";break;case 9:s="AppointmentBook"}2===r?i=a:t.EntityLogicalName&&(i=t.EntityLogicalName);const c=null===e.EntityLogicalName||!e.EntityLogicalName.length||("listmember"===e.EntityLogicalName?"account"===i||"contact"===i||"lead"===i:i===e.EntityLogicalName),l=null===e.EntityContextName||!e.EntityContextName.length||s===e.EntityContextName;if(c)n=l;else if("activitypointer"===e.EntityLogicalName&&"HomePageGrid"===s){const e=Object(o.h)(this._state,a);n=e?e.IsActivity&&!e.IsCustomEntity&&l:null}else n=!1}return K._SharedRuleBehavior(e,n)}_EvaluateFormStateRulePart(e,t,n){let r=null;if(!e||!t)return!1;const a=Object(O.pb)(this._state,this._pageId,n);switch(e.FormState){case 2:r=2===a||"email"===t.EntityLogicalName;break;case 4:r=4===a&&"email"!==t.EntityLogicalName;break;case 1:r=1===a;break;case 3:r=3===a;break;case 9:case 7:case 6:case 0:r=!1}return K._SharedRuleBehavior(e,r)}_EvaluateJavaScriptRulePart(e,t,n,r,i){if(!e||!t)return Promise.resolve(!1);const o=/^\$webresource:/i;if(!e.Library||-1===e.Library.search(o))return Promise.resolve(!1);const s=Object(E.e)(this._state,[e.Library]);for(let e=0;e<s.length;++e)s[e]=s[e].replace(o,"");const c=Object(A.c)(this._applicationContext,this._dispatch,this._commandManagerId,this._pageId),l=[];this._evaluateParameters.evaluateParameters(e.Parameters,2,t,this._pageId,n,this._state,this._applicationContext,r,this._commandManagerId).forEach(e=>l.push(e.value));const u=this._dispatch(Object(P.f)(s)),d=c.then(e=>e.loadWebResourcesForAllContexts(s,t.WebResourcePath,3,e=>this._dispatch(Object(D.a)(e)),!t.IsServerAvailable));let p=-1;const g=(e,t)=>{const n=K._SharedRuleBehavior(e,t);return n?i.parallelOr&&(i.trueCount=(i.trueCount||0)+1,i.trueCount===i.rulePartCount&&(i.parallelOr.anyTrue=!0)):i.anyFalse=!0,n};return Promise.all([u,d,c]).then(t=>{if(i.anyFalse||i.parallelOr&&i.parallelOr.anyTrue)return B.Skipped;let o=null;const s=t[2];try{const t=Object(E.j)(this._state,e.Library),r={sourceName:"ribbon.rule"};r.eventParameters=[{name:I.b.CommandingParameters.ControlId,value:n},{name:I.b.WebResourceParameterNames.FunctionName,value:e.FunctionName},{name:I.b.WebResourceParameterNames.WebResourceName,value:null==t?void 0:t.name},{name:I.b.WebResourceParameterNames.SolutionName,value:null==t?void 0:t.solutionName},{name:I.b.WebResourceParameterNames.PublisherName,value:null==t?void 0:t.publisherName}],Object(a.b)(r,()=>{o=s.execute(e.FunctionName,l,!1,{webResourceName:t&&t.name,solutionName:t&&t.solutionName,solutionVersion:t&&t.solutionVersion,publisherName:t&&t.publisherName,type:"RuleEvaluation"})})}catch(t){const a=[];return e.FunctionName&&a.push({name:"RuleErrorFunctionName",value:e.FunctionName}),e.Library&&a.push({name:"Library",value:e.Library}),n&&a.push({name:"ControlId",value:n}),r&&a.push({name:"ContextKey",value:r}),t&&t.message&&a.push({name:"RuleErrorMessage",value:t.message}),this._trace(w.a.Error,`Failed to execute JavaScript rule function "${e.FunctionName}" from library "${e.Library}".`,a),g(e,null)}if(!o||"function"!=typeof o.then)return g(e,o);const c=new Promise((e,t)=>{p=setTimeout(()=>{t({message:"Timed out after 10000ms"})},1e4)}),u=Promise.race([o,c]).then(t=>(clearTimeout(p),g(e,t)));return L.a.trackPendingPromise(u,"RuleEvaluation"),u}).catch(t=>{clearTimeout(p);const a=[];return e.FunctionName&&a.push({name:"RuleErrorFunctionName",value:e.FunctionName}),e.Library&&a.push({name:"Library",value:e.Library}),n&&a.push({name:"ControlId",value:n}),r&&a.push({name:"ContextKey",value:r}),t&&t.message&&a.push({name:"RuleErrorMessage",value:t.message}),this._trace(w.a.Error,`Failed to execute JavaScript rule function "${e.FunctionName}" from library "${e.Library}".`,a),g(e,null)})}_EvaluateOfflineAccessStateRulePart(e,t){if(!e||!t)return!1;let n;return n=Object(m.b)(this._state)?1===e.OfflineAccessState:2===e.OfflineAccessState,K._SharedRuleBehavior(e,n)}_EvaluateOrBlockRulePart(e,t,n,r,a,i,o,s,c){if(!t||!n)return Promise.resolve(B.False);if(!t.OrGroups)return Promise.resolve(U(t.DefaultValue));const l=[],u={},d=[];for(let c=0;c<t.OrGroups.length;c++){const p=[];this._evaluateSyncRuleParts(e,t.OrGroups[c].Rules,n,a,i,s,p)===B.False?l.push(Promise.resolve({ruleId:"",ruleIdResult:B.False,rulePartsResults:p})):l.push(this._evaluateAsyncRuleParts(e,t.OrGroups[c].Rules,n,r,a,i,o,s,{parallelOr:u},p)),d[c]={rulePartsResults:p}}return l.length>0?Promise.all(l).then(e=>{const n=K._SharedRuleBehavior(t,e.some(e=>e.ruleIdResult===B.True));return c.rulePartType=t.RuleType.toString(),c.rulePartResult=U(n).toString(),c.orGroupsResults=d,U(n)}).catch(()=>B.False):Promise.resolve(U(t.DefaultValue))}_EvaluateOutlookClientRulePart(e,t){return!(!e||!t)&&K._SharedRuleBehavior(e,0===e.OutlookClientType)}_EvaluateOutlookVersionRulePart(e,t){return!(!e||!t)&&K._SharedRuleBehavior(e,null)}_EvaluateOutlookItemTrackingRulePart(e,t){return!(!e||!t)&&K._SharedRuleBehavior(e,null)}_EvaluatePageRulePart(e,t){return!(!e||!t)&&K._SharedRuleBehavior(e,e.Address===document.location.href)}_EvaluateRecordPrivilegeRulePart(e,t,n){if(!e||!t)return Promise.resolve(!1);let r;const a=t.EntityLogicalName?t.EntityLogicalName:"";if(!a)return Promise.resolve(K._SharedRuleBehavior(e,!1));if(t&&t.EntityId&&t.EntityId.guid&&(r=t.EntityId.guid),this._isEntityDescriptorInitializedWithMobileCheck(this._getState(),a)&&this._isRecordDescriptorInitialized(this._getState(),a,r)&&this._isNullOrUndefined(Object(j.d)(this._getState(),a,null,null,this._pageId)))return this._privilegeMetadataCallback(e,a,n,r)();if(this._isEntityValidWithCurrentServerStatus(this._getState(),a)){const i=[];return this._isEntityDescriptorInitializedWithMobileCheck(this._getState(),a)||i.push(this._dispatch(Object(j.f)(a,!1,[]))),Promise.all(i).then(()=>{const i=[];if(r&&!this._isRecordDescriptorInitialized(this._getState(),a,r)){const e=new W.a(a,t.EntityId),n=Object(o.E)(this._getState(),a);i.push(this._dispatch(Object(P.d)(e,[n])))}return Promise.all(i).then(this._privilegeMetadataCallback(e,a,n,r)).catch(()=>Promise.resolve(K._SharedRuleBehavior(e,null)))}).catch(()=>Promise.resolve(K._SharedRuleBehavior(e,null)))}return Promise.resolve(K._SharedRuleBehavior(e,null))}_privilegeMetadataCallback(e,t,n,r){return()=>{const a=this._getState(),i=Object(o.h)(a,t),s=Object(z.b)(a,t,r);if(!Object(m.b)(a)&&!this._isEntityValidForMobile(a,t))return Promise.resolve(!1);const c=i?i.Privileges:null,l=!!i&&i.IsEnabledInUnifiedInterface,u=!i||i.IsReadOnlyInMobileClient;if("systemform"!==t&&"savedquery"!==t&&"workflow"!==t&&"documenttemplate"!==t&&"importfile"!==t&&"asyncoperation"!==t&&"processsession"!==t&&t!==M.c){if(!0!==l)return Promise.resolve(K._SharedRuleBehavior(e,!1));if(!0===u&&2!==e.PrivilegeType&&64!==e.PrivilegeType&&128!==e.PrivilegeType&&32!==e.PrivilegeType)return Promise.resolve(K._SharedRuleBehavior(e,!1))}switch(n){case ce:if(c)return Promise.resolve(K._SharedRuleBehavior(e,this._HasEntityPrivilege(a,e,t)));break;case se:if(s)return Promise.resolve(K._SharedRuleBehavior(e,this._HasRecordPrivilege(a,e,t,r)));if(c){const n=this._ConvertPrivilegeType(e.PrivilegeType,!1);return Promise.resolve(Object(_.g)(a,t,n,0))}}return Promise.resolve(K._SharedRuleBehavior(e,e.DefaultValue))}}_EvaluateEntityPrivilegeRulePart(e,t,n){if(!e||!t)return Promise.resolve(!1);let r;if(e.EntityLogicalName)r=e.EntityLogicalName;else if(1===e.AppliesTo?r=t.EntityLogicalName?t.EntityLogicalName:"":2===e.AppliesTo&&(r=t.ContextEntityLogicalName?t.ContextEntityLogicalName:""),!r||0===e.AppliesTo)return Promise.resolve(K._SharedRuleBehavior(e,!1));return this._isEntityDescriptorInitializedWithMobileCheck(this._getState(),r)&&this._isNullOrUndefined(Object(j.d)(this._getState(),r,null,null,this._pageId))?this._privilegeMetadataCallback(e,r,n)():this._isEntityValidWithCurrentServerStatus(this._getState(),r)?this._dispatch(Object(j.f)(r,!1,[])).then(this._privilegeMetadataCallback(e,r,n)).catch(()=>Promise.resolve(K._SharedRuleBehavior(e,null))):Promise.resolve(K._SharedRuleBehavior(e,null))}_HasEntityPrivilege(e,t,n){let r=!1;if(n){const a=this._ConvertPrivilegeType(t.PrivilegeType,!1);r=Object(_.g)(e,n,a,t.PrivilegeDepth)}return r}_ConvertPrivilegeType(e,t){let n;switch(e){case 1:n=t?"Create":1;break;case 2:n=t?"Read":2;break;case 4:n=t?"Write":3;break;case 8:n=t?"Delete":4;break;case 16:n=t?"Assign":5;break;case 32:n=t?"Share":6;break;case 64:n=t?"Append":7;break;case 128:n=t?"AppendTo":8;break;default:n=t?"Read":2}return n}_HasRecordPrivilege(e,t,n,r){let a=!1;if(n&&r){const i=this._ConvertPrivilegeTypeToAccessRight(t.PrivilegeType);a=Object(_.h)(e,n,r,i)}return a}_ConvertPrivilegeTypeToAccessRight(e){let t=q.a.None;switch(e){case 1:t=q.a.CreateAccess;break;case 2:t=q.a.ReadAccess;break;case 4:t=q.a.WriteAccess;break;case 8:t=q.a.DeleteAccess;break;case 16:t=q.a.AssignAccess;break;case 32:t=q.a.ShareAccess;break;case 64:t=q.a.AppendAccess;break;case 128:t=q.a.AppendToAccess;break;default:t=q.a.ReadAccess}return t}_EvaluateSelectionCountRulePart(e,t){if(!e||!t)return!1;let n=null;return t.SelectedItems&&(n=!0,null!==e.Minimum&&void 0!==e.Minimum&&t.SelectedItems.length<e.Minimum&&(n=!1),null!==e.Maximum&&void 0!==e.Maximum&&e.Maximum>=0&&t.SelectedItems.length>e.Maximum&&(n=!1)),K._SharedRuleBehavior(e,n)}_EvaluateSkuRulePart(e,t){return!(!e||!t)&&K._SharedRuleBehavior(e,0!=(2&e.SkuTypes))}_EvaluateValueRulePart(e,t){let n=null;if(!e||!t)return!1;const r=Object(b.d)(this._state,t.EntityLogicalName),a=Object(C.j)(this._state,this._pageId),o=Object(O.ac)(this._state,this._pageId,a);let s=null;if(t.SelectedItems&&t.SelectedItems.length>0)s=t.SelectedItems[0].EntityReference;else if(t.EntityLogicalName&&t.EntityId&&t.EntityId.guid){const e=Object(S.i)(this._state,t.EntityLogicalName);e&&e[t.EntityId.guid]&&(s=e[t.EntityId.guid].identifier)}const c=Object(y.d)(this._state,o,s,e.Field);let l=null;if(c&&Object(v.i)(c)&&c.hasOwnProperty("valueString"))l=c.valueString;else if(c&&Object(v.j)(c)&&c.hasOwnProperty("value"))l=c.value;else if(c&&Object(v.g)(c)&&c.hasOwnProperty("id"))l=i.a.toString(c.id);else if(c&&Object(v.k)(c)&&c.hasOwnProperty("reference")){const e=c.reference&&c.reference.id||null;l=e&&i.a.toString(e)||null}if(r){const t=r[e.Field];if(t&&t.OptionSet){let n;t&&t.OptionSet&&(n=t.OptionSet.filter(e=>e.Value===Number(l))),null!=l&&l!==e.Value&&n.length>0&&(l=n[0].InvariantName,l!==e.Value&&(l=n[0].Label,l!==e.Value&&(l=n[0].Value,l.toString()!==e.Value&&"boolean"===t.Type&&(1===l?l="true":0===l&&(l="false")))))}}return n=null!=l?l.toString()===e.Value:null===l&&""===e.Value||e.DefaultValue,K._SharedRuleBehavior(e,n)}_EvaluateCommandClientTypeRulePart(e,t){return!(!e||!t)&&K._SharedRuleBehavior(e,1===e.ClientType)}_EvaluateDeviceTypeRulePart(e,t){if(!e||!t)return!1;let n=null;return 1===e.Type?n=Object(s.a)()===c.a.Phone:2===e.Type?n=Object(s.a)()===c.a.Slate&&Object(u.a)(this._getState())===l.a.MobileApplication:3===e.Type?n=Object(u.a)(this._getState())===l.a.Browser:4===e.Type&&(n=Object(u.a)(this._getState())===l.a.MailApp),K._SharedRuleBehavior(e,n)}_EvaluateEntityPropertyRulePart(e,t){if(!e||!t)return Promise.resolve(!1);if(t){let n=null;if(n=e.EntityLogicalName?e.EntityLogicalName:2===e.AppliesTo&&t.ContextEntityLogicalName?t.ContextEntityLogicalName:t.EntityLogicalName,null===n&&0===e.AppliesTo)return Promise.resolve(K._SharedRuleBehavior(e,null));const r=()=>{const t=this._getState(),r=Object(o.h)(t,n);if(!Object(m.b)(t)&&!this._isEntityValidForMobile(t,e.EntityLogicalName))return!1;if(null!=r){let t=null;switch(e.PropertyName){case 3:t=r.IsDuplicateDetectionEnabled;break;case 5:t=r.IsValidForAdvancedFind;break;case 4:t=r.HasStateCode;break;case 1:t=r.IsMailMergeEnabled;break;case 2:t=r.IsCollaboration||"activitypointer"===n;break;case 6:t=r.IsConnectionsEnabled;break;case 7:t=r.HasActivities;break;case 8:t="activitypointer"===n||r.IsActivity;break;case 9:t=r.HasNotes;break;case 17:break;case 10:t=r.IsCustomizable;break;case 12:t=r.HasEmailAddresses;break;case 11:t=r.IsActivityParty;break;case 13:t=r.IsChildEntity;break;case 14:t=r.IsImportable;break;case 15:t=r.IsEnabledForCharts;break;case 16:t=r.IsBusinessProcessEnabled;break;case 18:t=r.IsBPFEntity;break;case 19:t=r.IsDocumentManagementEnabled}return K._SharedRuleBehavior(e,e.PropertyValue===t)}return console.log("Unable to retrieve entity metadata for entity "+n),K._SharedRuleBehavior(e,null)};return!n||this._isEntityDescriptorInitializedWithMobileCheck(this._getState(),n)&&this._isNullOrUndefined(Object(j.d)(this._getState(),n,null,null,this._pageId))?Promise.resolve(r()):this._isEntityValidWithCurrentServerStatus(this._getState(),n)?this._dispatch(Object(j.f)(n,!1,[])).then(r).catch(()=>Promise.resolve(K._SharedRuleBehavior(e,null))):Promise.resolve(K._SharedRuleBehavior(e,null))}}_EvaluateFormEntityContextRulePart(e,t){if(!e||!t)return!1;let n=null;return t&&t.EntityLogicalName&&e.EntityLogicalName&&(n=e.EntityLogicalName===t.EntityLogicalName),K._SharedRuleBehavior(e,n)}_EvaluateOrganizationSettingRulePart(e,t){if(!e||!t)return!1;const n=Object(p.x)(this._state);let r=null;switch(e.Setting){case 2:r=n?n.isSOPIntegrationEnabled:null;break;case 3:r=n?n.fiscalYearStartDate!==new Date(0,0,1):null}return K._SharedRuleBehavior(e,r)}_EvaluateOutlookRenderTypeRulePart(e,t){return!(!e||!t)&&K._SharedRuleBehavior(e,1===e.RenderType)}_EvaluateCrmOutlookClientVersionRulePart(e,t){return!(!e||!t)&&K._SharedRuleBehavior(e,null)}_EvaluateMiscellaneousPrivilegeRulePart(e,t){const n=e&&e.PrivilegeName?e.PrivilegeName:"";let r=null;const a=Object(g.w)(this._state);if("osdp"===n.toLowerCase()&&a)r=!!a.isOsdpOrganization&&a.isOsdpOrganization;else{let t=!1,n=null;if(e&&e.PrivilegeId&&this._state.user&&this._state.user.userRolePrivileges)for(const r in this._state.user.userRolePrivileges){const a=this._state.user.userRolePrivileges[r];if(a&&i.a.externalGuid(a.privilegeId)===e.PrivilegeId.toUpperCase()){t=!0,n=a.privilegeDepth;break}}r=!!t&&(-1===e.PrivilegeDepth||n>=e.PrivilegeDepth)}return K._SharedRuleBehavior(e,r)}_EvaluateReferencingAttributeRequiredRulePart(e,t,n){let r=null;if(!e||!t)return Promise.resolve(!1);if(t){const a=Object(N.b)(this._state,n),i=Object(T.v)(this._state,this._pageId,a);if(i&&i.relationshipName){const n=i.relationshipName,a=Object(o.B)(this._state,t.EntityLogicalName,n);if(a&&a.ReferencingAttribute&&a.ReferencingEntity){const t=a.ReferencingAttribute,n=a.ReferencingEntity,i=()=>{const a=Object(b.a)(this._getState(),n,t);return r=a&&(2===a.RequiredLevel||1===a.RequiredLevel),Promise.resolve(K._SharedRuleBehavior(e,r))};return Object(b.a)(this._getState(),n,t)&&this._isNullOrUndefined(Object(j.d)(this._getState(),n,null,null,this._pageId))?i():this._isEntityValidWithCurrentServerStatus(this._getState(),n)?this._dispatch(Object(j.f)(n,!1,[t])).then(i).catch(()=>Promise.resolve(K._SharedRuleBehavior(e,null))):Promise.resolve(K._SharedRuleBehavior(e,null))}}}return Promise.resolve(K._SharedRuleBehavior(e,r))}_EvaluateRelationshipTypeRulePart(e,t,n){let r=null;if(!e||!t)return!1;let a=e.RelationshipType;if(this._isNullOrUndefined(e.AllowCustomRelationship)&&this._isNullOrUndefined(e.AllowSystemRelationship)&&this._isNullOrUndefined(a)&&(a=0),this._isNullOrUndefined(a)||(r=a===t.RelationshipType+1),!this._isNullOrUndefined(e.AllowCustomRelationship)||!this._isNullOrUndefined(e.AllowSystemRelationship)){const a=Object(N.b)(this._state,n),i=Object(T.v)(this._state,this._pageId,a);if(i){const n=i.relationshipName,a=Object(o.B)(this._state,t.EntityLogicalName,n),s=Object(o.u)(this._state,t.EntityLogicalName,n);(a&&this._relationshipIsInvalid(e,a)||s&&this._relationshipIsInvalid(e,s))&&(r=!1)}}return K._SharedRuleBehavior(e,r)}_relationshipIsInvalid(e,t){return!this._isNullOrUndefined(e.AllowCustomRelationship)&&!e.AllowCustomRelationship&&t.IsCustomRelationship||!this._isNullOrUndefined(e.AllowCustomRelationship)&&!e.AllowSystemRelationship&&!t.IsCustomRelationship}_EvaluateOptionSetRulePart(e,t){if(!e||!t)return!1;let n=null,r=0;const a=Object(b.a)(this._state,t.EntityLogicalName,"statuscode");return a&&a.OptionSet&&(a.OptionSet.every(t=>!(t.State===e.StateCode&&(r++,r>1))),n=!(r>1)),K._SharedRuleBehavior(e,n)}_EvaluateFeatureControlRulePart(e,t){if(!e||!t)return!1;let n=null;if(e.FeatureControlBit){n=Object(h.c)(this._state,e.FeatureControlBit)===e.ExpectedValue}return K._SharedRuleBehavior(e,n)}_EvaluateFormTypeRulePart(e,t){if(!e||!t)return!1;let n=!1;return 5!==t.ContextType||9!==e.FormType&&6!==e.FormType?(7===t.ContextType&&11===e.FormType||8===t.ContextType&&5===e.FormType||9===t.ContextType&&0===e.FormType||2===t.ContextType&&2===e.FormType)&&(n=!0):n=!0,K._SharedRuleBehavior(e,n)}_EvaluateHideForTabletExperienceRulePart(e,t){return!(!e||!t)&&K._SharedRuleBehavior(e,null)}_EvaluateHideIfPowerBITileNotAvailableRulePart(e,t){if(!e||!t)return!1;const n=Object(F.a)(this._getState());return K._SharedRuleBehavior(e,n)}_isNullOrUndefined(e){return null==e}_isEntityDescriptorInitializedWithMobileCheck(e,t){const n=Object(o.h)(e,t);return Object(o.l)(this._getState(),t)===d.a.Initialized&&n&&!this._isNullOrUndefined(n.IsVisibleInMobileClient)}_isRecordDescriptorInitialized(e,t,n){const r=Object(S.h)(e,t,n);return!this._isNullOrUndefined(r)}_isEntityValidWithCurrentServerStatus(e,t){return Object(m.b)(e)||Object(x.l)(e,t)}_isEntityValidForMobile(e,t){const n=t?Object(o.h)(e,t):null,r=t&&"postfollow"===t.toLowerCase(),a=n&&n.IsVisibleInMobileClient;return this._isNullOrUndefined(n)||r||a}_trace(e,t,n){const r=this._applicationContext.TraceManager.getTracer("Commanding");switch(e){case w.a.Verbose:r.debug(t,n);break;case w.a.Info:r.info(t,n);break;case w.a.Warning:r.warn(t,n);break;case w.a.Error:r.error(t,n)}}}var Q=n("GT4X"),X=n("wgH2"),Y=n("ILmX");var J=n("I4Rv"),$=n("UIlN");function Z(e,t,n,a){return{type:"commanding.initstate.sync",execute({dispatch:i,getState:s},c){const l=s(),u=new K(t,n,l,s,c,i);if(e){const s=Object($.b)(l,n);let c;c=s?Object(X.a)(s.ribbonId):a.ContextEntityLogicalName;const d=Object(o.f)(l,c),p=Object(o.e)(l,c),g=function(e,t,n,r,a){const i={};let o=new Array;e.Layout.Tabs.Tab&&(o=o.concat(e.Layout.Tabs.Tab));e.Layout.ContextualTabs.Tab&&(o=o.concat(e.Layout.ContextualTabs.Tab));return o.forEach(o=>{o&&o.Groups&&o.Groups.Group&&o.Groups.Group.forEach(o=>{o.Controls.Items.forEach(o=>{ne(o,t,e,i,n,r,a)})})}),i}(e,u,c,d,p),h=function(e,t){const n={EnableRules:{},DisplayRules:{}};e&&e.DisplayRules&&re(e.DisplayRules,t,n.DisplayRules);e&&e.EnableRules&&re(e.EnableRules,t,n.EnableRules);return n}(e,u);ee(i,g,n),i(function(e,t){const n={nonCacheableRules:e};return{type:r.q,payload:n,meta:{commandManagerId:t}}}(h,n)),i(Object(J.b)(t,n))}},sync:!0}}function ee(e,t,n){const a=[];for(const e in t)a.push(te(t[e],e,n));a.length>0&&e(function(e,t){const n={stateUpdates:e};return{type:r.k,payload:n,meta:{commandManagerId:t}}}(a,n))}function te(e,t,n){return{type:r.j,payload:e,meta:{commandManagerId:n,controlId:t}}}function ne(e,t,n,a,i,o,s){const c={hasPopulateQueryCommand:!1,hasSelectionCountRule:!1};if(e&&e.Id&&e.Command){if("Menu"in e&&e.Menu&&e.Menu.MenuSection&&e.Menu.MenuSection.length)for(let r=0;r<e.Menu.MenuSection.length;r++){const l=e.Menu.MenuSection[r];if(l.Item&&l.Item.Items){const e=l.Item.Items;for(let r=0;r<e.length;r++){const l=ne(e[r],t,n,a,i,o,s);c.hasPopulateQueryCommand=c.hasPopulateQueryCommand||l.hasPopulateQueryCommand,c.hasSelectionCountRule=c.hasSelectionCountRule||l.hasSelectionCountRule}}}const l=e.Command.split("|");if(4===l.length){const u=Object(A.d)(e.ToolTipTitle,e.ToolTipDescription,e.LabelText),d=""===l[0]?"null":l[0],p=l[3],g=Object(Y.i)(e.Id,i),h=Object(A.e)(e.LabelText,o,s),f=n.Commands[d]?n.Commands[d][p]:n.Commands[r.c][p];if(f){c.hasPopulateQueryCommand=c.hasPopulateQueryCommand||!!e.PopulateQueryCommand,c.hasSelectionCountRule=c.hasSelectionCountRule||t.hasSelectionCountRuleForCommand(n.EnableRules,f.EnableRules,d);const r={},i={};!function(e,t,n,r){e&&e.EnableRules&&e.EnableRules.length>0&&e.EnableRules.forEach(e=>{n[e]={ruleIdResult:null,rulePartsResults:[]}});e&&e.DisplayRules&&e.DisplayRules.length>0&&e.DisplayRules.forEach(e=>{r[e]={ruleIdResult:null,rulePartsResults:[]}})}(f,0,r,i),a[g]={hasPopulateQueryCommand:c.hasPopulateQueryCommand,hasSelectionCountRule:c.hasSelectionCountRule,canBeVisibleOffline:t.hasOfflineRuleForCommand(n.EnableRules,f.EnableRules,d),canBeVisibleForHierarchy:t.hasHierarchyRuleForCommand(n.EnableRules,f.EnableRules,d),commandId:e.Command,labelText:h,tooltip:u,icon:e.ModernImage,enableRulesResult:r,displayRulesResult:i,commandValueId:!("Menu"in e)&&e.CommandValueId?e.CommandValueId:null}}}}return c}function re(e,t,n){if(e&&n)for(const r in e)for(const a in e[r]){t.isNonCacheableRule(e,a,r)&&(n[r]||(n[r]={}),n[r][a]=!0)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function ae(e,t){const n=Object($.b)(e,t);return n&&n.nonCacheableRules||null}var ie=n("P86a"),oe=n("Me5Q");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const se="EnableRules",ce="DisplayRules";function le(e,t,n,a,i){const o=[{name:"commandManagerId",value:a},{name:"pageId",value:n},{name:"contextKey",value:i},{name:"contextEntity",value:null==t?void 0:t.EntityLogicalName},{name:"ribbonContextType",value:null==t?void 0:t.ContextType}];return{type:"ribbon.evaluterulenostatechange.async",execute({dispatch:o,getState:s},c){const l={},u=[],d=s(),p=!Object(m.b)(d),g=c.TraceManager.getTracer("Commanding.EvaluateRules"),h=Object(Q.d)(d,a),f=new K(n,a,d,s,c,o),b=ae(d,a);g.debug(`Evaluating rules for commandManagerId: ${a}, pageId: ${n}`);for(const n in h){const s=h[n].commandId,c=s.split("|");if(4===c.length){const l=""===c[0]?"null":c[0],d=c[3],g=e.Commands[l]?e.Commands[l][d]:e.Commands[r.c][d];if(g){const r={},c={};u.push(pe(f,g,b,!1,s,n,t,e,l,a,i,p,o,r,c))}}}return Promise.all(u).then(e=>e.reduce((e,t)=>(e[t.meta.controlId]=Object.assign(Object.assign({},h[t.meta.controlId]),t.payload),e),l))},getFailureParameters:(e,t,n)=>o,getSuccessParameters:(e,t)=>o}}function ue(e,t,n,a,i,o){const s=[{name:"commandManagerId",value:a},{name:"pageId",value:n},{name:"contextKey",value:i},{name:"contextEntity",value:null==t?void 0:t.EntityLogicalName},{name:"ribbonContextType",value:null==t?void 0:t.ContextType}];return{type:"ribbon.evaluaterule.async",execute({dispatch:c,getState:l},u){const d=[],p=u.TraceManager.getTracer("Commanding.EvaluateRules");if(e&&a){const g=Object(Q.b)(l(),a);g||c(Z(e,n,a,t));const h=l(),f=!Object(m.b)(h),b=Object(Q.d)(h,a),_=new K(n,a,h,l,u,c),y=ae(h,a);p.debug(`Evaluating rules for commandManagerId: ${a}, pageId: ${n}`);for(const n in b){const s=b[n].commandId,l=s.split("|");if(4===l.length){const u=""===l[0]?"null":l[0],p=l[3],g=e.Commands[u]?e.Commands[u][p]:e.Commands[r.c][p],h=null!==b[n].visible&&void 0!==b[n].visible;if(g&&(null==g?void 0:g.isFirstLevel)){const r={},l={};d.push(pe(_,g,y,h&&!o,s,n,t,e,u,a,i,f,c,r,l))}}}return Promise.all(d).then(e=>(g||c(Object(oe.a)(ie.a.CompletedInitialRuleEvaluation,a)),c(ge(e,a)),s.push({name:"RuleEvaluationResults",value:be(e)}),p.debug(`Finished evaluating rules for commandManagerId: ${a}, pageId: ${n}`),!0))}return p.warn("Rules were not evaluated"),Promise.resolve(!1)},getFailureParameters:(e,t,n)=>s,getSuccessParameters:(e,t)=>s}}function de(e,t,n,a){const i=[{name:"commandManagerId",value:n},{name:"pageId",value:t},{name:"contextKey",value:a}];return{type:"ribbon.evaluaterule.async",execute({dispatch:s,getState:c},l){const u=c(),d=!Object(m.b)(u),p=[],g=Object(Y.k)(u,n),h=Object(X.c)(u,n),f=Object(Q.d)(u,n),b=ae(u,n),_=l.TraceManager.getTracer("Commanding.EvaluateRules");if(g&&n){const m=new K(t,n,u,c,l,s);return e.some(e=>!f[Object(Y.i)(e.Id,null==h?void 0:h.ContextEntityLogicalName)])&&s(function(e,t,n,r,a){return{type:"commanding.initmenustate.sync",execute({dispatch:i,getState:s},c){const l=s(),u=new K(n,r,l,s,c,i);if(e&&e.length>0){const n={},s=Object($.b)(l,r);let c;c=s?Object(X.a)(null==s?void 0:s.ribbonId):null==a?void 0:a.ContextEntityLogicalName;const d=Object(o.f)(l,c),p=Object(o.e)(l,c);e.forEach(e=>{ne(e,u,t,n,c,d,p)}),ee(i,n,r)}},sync:!0}}(e,g,t,n,h)),_.debug(`Evaluating rules of menu items for commandManagerId: ${n}, pageId: ${t}`),e.forEach(e=>{const t=e.Command.split("|");if(4===t.length){const i=""===t[0]?"null":t[0],o=t[3],c=g.Commands,l=c[i]?c[i][o]:c[r.c][o],u=Object(Y.i)(e.Id,null==h?void 0:h.ContextEntityLogicalName);if(l){const t={},r={};p.push(pe(m,l,b,!1,e.Command,u,h,g,i,n,a,d,s,t,r))}}}),Promise.all(p).then(e=>(s(ge(e,n)),i.push({name:"RuleEvaluationResults",value:be(e)}),_.debug(`Finished evaluating rules of menu items for commandManagerId: ${n}, pageId: ${t}`),!0))}return _.warn("Rules were not evaluated"),Promise.resolve(!1)},getFailureParameters:(e,t,n)=>i,getSuccessParameters:(e,t)=>i}}function pe(e,t,n,r,a,i,o,s,c,l,u,d,p,g,h){if(d&&!e.hasOfflineRuleForCommand(s.EnableRules,t.EnableRules,c))return Promise.resolve(fe(B.False,i,l,g,h));const f=e.evaluateSyncRulesForCommand(s.EnableRules,n.EnableRules,se,t.EnableRules,o,c,t.Id,l,u,g,h);if(f===B.False)return Promise.resolve(fe(B.False,i,l,g,h));if(!r){if(e.evaluateSyncRulesForCommand(s.DisplayRules,n.DisplayRules,ce,t.DisplayRules,o,c,t.Id,l,u,g,h)===B.False)return Promise.resolve(he(f,B.False,i,l,g,h))}const m=[],b=e.evaluateAsyncRulesForCommand(s.EnableRules,n.EnableRules,se,t.EnableRules,o,c,t.Id,l,u,g,h);if(m.push(b),!r){const r=e.evaluateAsyncRulesForCommand(s.DisplayRules,n.DisplayRules,ce,t.DisplayRules,o,c,t.Id,l,u,g,h);m.push(r)}return Promise.all(m).then(e=>{const t=e[0];if(!r){return he(t,e[1],i,l,g,h)}return fe(t,i,l,g,h)})}function ge(e,t){const n={evaluatedRules:e};return{type:r.d,payload:n,meta:{commandManagerId:t}}}function he(e,t,n,a,i,o){return me(r.f,e,t,n,a,i,o)}function fe(e,t,n,a,i){return me(r.e,e,B.Skipped,t,n,a,i)}function me(e,t,n,r,a,i,o){const s={};return t!==B.Skipped&&(s.enabled=t===B.True,s.enableRulesResult=i),n!==B.Skipped&&(s.visible=n===B.True,s.displayRulesResult=o),{type:e,payload:s,meta:{commandManagerId:a,controlId:r}}}function be(e){const t=[];return Object.entries(e).forEach(e=>{var n,r,a,i,o,s,c,l;t.push({commandManagerId:e[1]&&(null===(r=null===(n=e[1])||void 0===n?void 0:n.meta)||void 0===r?void 0:r.commandManagerId),controlId:e[1]&&(null===(i=null===(a=e[1])||void 0===a?void 0:a.meta)||void 0===i?void 0:i.controlId),enableRulesResult:e[1]&&(null===(s=null===(o=e[1])||void 0===o?void 0:o.payload)||void 0===s?void 0:s.enabled),displayRulesResult:e[1]&&(null===(l=null===(c=e[1])||void 0===c?void 0:c.payload)||void 0===l?void 0:l.visible)})}),JSON.stringify(t)}},"6kq6":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("KdpX");function a({navPath:e,dashboardId:t,etn:n,type:a,canOverride:i}){return{type:"dashboard.retrieveDashboard",execute:({dispatch:o})=>o(Object(r.d)(e,t,n,a,i)).then(e=>({retrievedId:e})).catch(e=>({error:e}))}}},"6lVV":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return u}));var r=n("a8hT"),a=n("37s6");let i=null;const o="offline.forced.sync",s="offline.immediate.sync";function c(e){return{type:o,payload:{isForcedSyncInProgress:e}}}function l(e){return{type:s,payload:{isImmediateOfflineDataSyncInProgress:e}}}function u(e){return{type:"immediate.sync",execute({dispatch:t,getState:n},o){const s=new Promise((e,r)=>{Object(a.j)(n())||t(l(!0)),i&&(i(),i=null),i=e});return Object(a.w)(n())&&Object(r.a)().then(n=>{t(n.initializeOfflineLifecycleAsyncAction(void 0,e))}),s}}}function d(){i&&(i(),i=null)}},"6zk2":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Default=0]="Default",e[e.IfRowVersionMatches=1]="IfRowVersionMatches",e[e.AlwaysOverwrite=2]="AlwaysOverwrite"}(r||(r={}))},"74Tm":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return e.personalizations.recordSetNavigatorCollapse}n.d(t,"a",(function(){return r}))},"7ANZ":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("XosO"),a=function(){function e(){this._buffer=[]}return e.prototype._WriteByte=function(e){this._buffer.push(r.Number._ToByte(e))},e.prototype._Write=function(e,t,n){for(;n--;)this._WriteByte(e[t++])},e.prototype._GetBuffer=function(){return this._buffer},e}();t.MemoryStream=a},"7F2l":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("Uv1Y"),a=n("Er26"),i=n("i8tO"),o=n("1Xob"),s=n("SRlt");function c(e,t,n){switch(e){case a.e.ModernDataSource:case a.e.ModernDataSourceGCM:case s.b:return function(e){const t=Object(r.e)(e);return!(null!=t&&[-2147217919,-2147220969,-2147220891].indexOf(t)>-1)}(t);case i.a:return function(e,t){const n=Object(r.e)(e),a=[o.a.InvalidSubscription,o.a.InvalidMetadata,o.a.AuthenticationError,o.a.InvalidSubscriptionInLoop,o.a.SyncHandlerNotAvailable,-2147093999],i=["Synchronization interrupted by the user!"];return!(null!=n&&a.indexOf(n)>-1||i.indexOf(t)>-1)}(t,n);default:return!0}}function l(e,t,n){return c(e,t,n)}},"7Gx7":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e){this._dictionary=null,this._dictionary=e}get_dictionary(){return this._dictionary}}},"7HpW":function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("d6Hx");function a(e){if(!e)return[];const t=[];for(const n of e.AreaIds)if(n!==r.d){const r=e.Areas[n];t.push(r)}return t}function i(e){if(!e||!e.GroupIds)return[];const t=[],n=e.GroupIds;for(const r of n)t.push(e.Groups[r]);return t}function o(e){const t=[],n=e.SubAreaIds;for(const r of n)s(r)&&t.push(e.SubAreas[r]);return t}function s(e){let t;switch(e){case"nav_manageflow":case"nav_personalwall":t=!1;break;default:t=!0}return t}function c(e){return e.Entity||e.DefaultDashboard||e.Page||e.DynamicPage||e.Url&&((t=e.Url).startsWith("http")||t.includes("main.aspx")||t.includes("/workplace/home_dashboards.aspx")||t.includes("/WebResources/"));var t}function l(e){if(!e)return null;const t=[],n={};for(const a of e.AreaIds){if(a===r.d)continue;const i=e.Areas[a],o=i.GroupIds,s={},l=[];for(const e of o){const t=i.Groups[e],n=t.SubAreaIds,r={},a=[];for(const e of n){const n=t.SubAreas[e];c(n)&&(a.push(e),r[e]=n)}t.SubAreas=r,t.SubAreaIds=a,t.SubAreaIds.length>0&&(l.push(e),s[e]=t)}i.Groups=s,i.GroupIds=l,i.GroupIds.length>0&&(t.push(a),n[a]=i)}return e.AreaIds=t,e.Areas=n,e}},"7Mzt":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="editform.toggle.command.manager";function a(e){return{type:r,payload:{perfRenderCmdBar:e}}}},"7NKF":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="offline",a="localServer"},"7O3c":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("nxt5");class a extends r.a{constructor(e,t,n){super("RetrieveProcessControlData"),this._entity=e,this._globalNavigationData=t,this._bpfDefinitionVersionNumber=n}get_entity(){return this._entity}get_globalNavigationData(){return this._globalNavigationData}get_bpfDefinitionVersionNumber(){return this._bpfDefinitionVersionNumber}}},"7Sr4":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("pF61"),a=n("zmL5");class i{constructor(){this._forceWorkOutstandingCallbacks=[],this._workOutstanding=[]}addWorkOutstandingPromise(e,t,n,r){const a=t?{callback:t,componentId:n,attributesPendingUpdate:r}:null;a&&this._forceWorkOutstandingCallbacks.push(a),this._workOutstanding.push(e),e.then(()=>{const t=this._forceWorkOutstandingCallbacks.indexOf(a);t>=0&&this._forceWorkOutstandingCallbacks.splice(t,1),this._workOutstanding.splice(this._workOutstanding.indexOf(e),1)})}getAttributesPendingUpdate(){const e=new Set;for(let t=0;t<this._forceWorkOutstandingCallbacks.length;t++)this._forceWorkOutstandingCallbacks[t].attributesPendingUpdate&&this._forceWorkOutstandingCallbacks[t].attributesPendingUpdate.forEach(t=>e.add(t));return e}checkForOutstandingWork(e,t){const n=[];for(let a=0;a<this._forceWorkOutstandingCallbacks.length;a++){const{callback:i,componentId:o}=this._forceWorkOutstandingCallbacks[a],s=null!=t?t:Object(r.c)(e),c=this._getChildComponents(e,s);!o||o===s||c.includes(o)?i():n.push(this._forceWorkOutstandingCallbacks[a])}return this._forceWorkOutstandingCallbacks=n,Promise.all(this._workOutstanding)}static getInstance(){return i._instance||(i._instance=new i),i._instance}_getChildComponents(e,t){let n=[];switch(Object(r.k)(e,t)){case"entityrecord":n=Object(a.c)(e,t)}return n}}i._instance=null},"7XzV":function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"h",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"a",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Info",a="Details",i="Sales",o="Marketing",s="Service",c="InternetMarketing",l="ProcessCenter",u="Processes",d="Async"},"7ZMh":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("pgSX"),a=n("si7p"),i=n("ngeo"),o=n("YxC/"),s=n("EY5k"),c=n("tICD"),l=n("8MGk");function u(e,t){return{type:"form.script.error.dialog",execute(n,u,d){var p;const g=t.errorCode?t.errorCode:2153976091,h=t.errorFault.message,f=t.errorFault.stack,m=null===(p=t.details)||void 0===p?void 0:p.split("\n"),b="0x"+i.a.getHexErrorCodeFromInt(g),_="Error_Title_"+b,y="Error_Message_"+b,v=[_,y,"SolutionWizard.Button.Export.Tooltip","Button_Label_OK","Web.Dialog.ErrorCode_Caption","Error_Title_0x8004b056","Error_Title_0x80700000","L_Show_Details_Text","L_Client_Session_Id","L_Current_Time","L_Correlation_Id"];return n.dispatch(Object(s.e)(v)).then(()=>{const t=Object(o.e)(n.getState(),v),i=Object(o.c)(t,_);let s=Object(o.c)(t,y);const p=Object(o.c)(t,"SolutionWizard.Button.Export.Tooltip"),g=Object(o.c)(t,"Button_Label_OK"),b=Object(o.c)(t,"L_Show_Details_Text"),S=Object(o.c)(t,"L_Client_Session_Id"),O=Object(o.c)(t,"L_Current_Time"),C=Object(o.c)(t,"L_Correlation_Id");s=s.replace("\\r\\n{0}","");const E=S.replace("{0}",u.EventManager.getCurrentSessionId()),I=O.replace("{0}",""+new Date),w=C.replace("{0}",d.correlationId);n.dispatch(Object(r.a)(a.d,h,{type:"error"},p,i,s,g,b,[h,E,w,...m||[],I],void 0,e)).then(e=>0===e.status?n.dispatch(Object(c.a)(e.pageId)).then(e=>{if(e.value.confirmed){const e={mimeType:"text/plain",fileName:"ErrorDetails.txt",fileContent:btoa(unescape(encodeURIComponent(f))),fileSize:f.length},t={openMode:2};new l.a(u,n).openFile(e,t)}}):Promise.reject(e.error))})}}}},"7cfk":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Not_Initialized=0]="Not_Initialized",e[e.Initialized=1]="Initialized",e[e.Initialize_Failed=2]="Initialize_Failed"}(r||(r={}))},"7sMj":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return y})),n.d(t,"a",(function(){return S}));var r,a,i=n("nuS9"),o=n("CGM5"),s=n("YWpA"),c=n("HMYz"),l=n("iDZS"),u=n("tyZ/"),d=n("lxuJ"),p=n("hfLa"),g=n("S6oQ"),h=n("uTTW"),f=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),m=function(){return(m=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},b=/[0-9]*\.?[0-9]+(px|%|em|rem)?/i,_=[{min:1,max:39,color:"#FF0000"},{min:40,max:59,color:"#FFBB00"},{min:60,max:100,color:"#00EE00"}];!function(e){e[e.CustomImage=0]="CustomImage",e[e.Initials=1]="Initials",e[e.CustomEntityIcon=2]="CustomEntityIcon",e[e.DefaultEntityIcon=3]="DefaultEntityIcon"}(a||(a={}));var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return f(t,e),t.getMode=function(e){return e.hasPrimaryImageField&&e.imageSrc?a.CustomImage:e.hasPrimaryImageField&&e.entityPrimaryField?a.Initials:e.customEntityIcon?a.CustomEntityIcon:e.entityReference&&e.entityReference.entityName?a.DefaultEntityIcon:void 0},t.prototype._isCustomImageMode=function(){return t.getMode(this.props)===a.CustomImage},t.prototype._isInitialsMode=function(){return t.getMode(this.props)===a.Initials},t.prototype._isCustomEntityIconMode=function(){return t.getMode(this.props)===a.CustomEntityIcon},t.prototype._isDefaultEntityIconMode=function(){return t.getMode(this.props)===a.DefaultEntityIcon},t.prototype._renderHealthCircle=function(e){var t=this,n=b.exec(this.props.style.width+"")[1],r=parseFloat(this.props.style.width+""),a=360*this.props.entityHealthScore/100,o={width:r+n,height:r+n,position:"relative",display:"block"},c={clip:"rect(0, "+(r+n)+", "+(r+n)+", "+(r/2+n)+")",height:"100%",width:"100%",left:"0",position:"absolute",top:"0"},l={clip:"rect(0, "+(r/2+n)+", "+(r+n)+", 0)",transform:"rotate("+a+"deg)",height:"100%",width:"100%",border:"4px solid transparent",borderRadius:"50%",left:"0",position:"absolute",top:"0",borderColor:"transparent",boxSizing:"border-box"};_.forEach((function(e){t.props.entityHealthScore>=e.min&&t.props.entityHealthScore<=e.max&&(l.borderColor=e.color)}));var u=Object.assign({},l),d=Object.assign({display:"none"},l);return a>180&&(c.clip="rect(auto, auto, auto, auto)",u.transform="rotate(180deg)",d.display="block"),i.createElement(s.a,{style:o},e,i.createElement(s.a,{style:c},i.createElement(s.a,{style:u}),i.createElement(s.a,{style:d})))},t.prototype.getElementName=function(){return"span"},t.prototype.getElementProps=function(){return{alt:this.props.alt?this.props.alt:""}},t.prototype.getElementChildren=function(){return this._isInitialsMode()?function(e){var t="";if(e){for(var n=e.split(" "),r=0;r<n.length&&t.length<2;r++)if(n[r].length>0){var a=n[r].charCodeAt(0);if(!(a>=97&&a<=122||a>=65&&a<=90)){"".codePointAt&&String.fromCodePoint?t+=String.fromCodePoint(n[r].codePointAt(0)):t+=n[r].charAt(0);break}t+=n[r].charAt(0)}if(t.length<=1){t="";for(var i=0;i<e.length&&t.length<2;i++){var o=e.charCodeAt(i);if(!(o>=97&&o<=122||o>=65&&o<=90)){"".codePointAt&&String.fromCodePoint?t+=String.fromCodePoint(e.codePointAt(i)):t+=e.charAt(i);break}t+=e.charAt(i)}}}return t}(this.props.entityPrimaryField):this._isDefaultEntityIconMode()?i.createElement(p.a,{type:this.props.entityReference.entityName,style:this.props.iconStyle}):void 0},t.prototype._renderEntityImageWithPresence=function(e){var t="id_"+Object(d.b)(),n=i.createElement(u.a,{key:t+"_presence",id:t+"_presence",parentControlId:t,style:{right:"0px",bottom:"0px",position:"absolute"},entityReference:this.props.entityReference,sipUrl:this.props.sipUrl,displaySize:this.props.presenceIndicatorSize,accessibilityLabel:this.props.entityPrimaryField});return i.createElement(s.a,{id:t,style:{position:"relative"}},e,n)},t.prototype.render=function(){var e;if(this._isCustomImageMode()||this._isCustomEntityIconMode())if(window.navigator.userAgent.match("MSIE")||window.navigator.userAgent.match("Trident")){var t={source:this._isCustomImageMode()?this.props.imageSrc:this.props.customEntityIcon,style:this.props.style,fallbackToImage:!0,altText:this.props.alt,title:this.props.title};e=i.createElement(g.a,m({},t))}else{var n={source:this._isCustomImageMode()?this.props.imageSrc:this.props.customEntityIcon,style:this.props.style,altText:this.props.alt,title:this.props.title};e=i.createElement(h.a,m({},n))}else{var r=this.getElementPropsInternal(),a=Object.assign({},r,{role:r.role||"img","aria-label":this.props.alt||""});e=i.createElement(this.getElementName(),a,this.getElementChildren())}return this.props.wrapperStyle&&(e=i.createElement(s.a,{style:this.props.wrapperStyle},e)),this.props.entityHealthScore&&(e=this._renderHealthCircle(e)),(this.props.entityReference||this.props.sipUrl)&&(e=this._renderEntityImageWithPresence(e)),e},t.displayName="EntityImage",t.backgroundColors=["#005C62","#358717","#725A0D","#A42B1A","#652F4E","#6A1E7A","#315FA2"],t}(o.a);function v(e){if(e&&e.style){if(!e.style.backgroundColor&&(y.getMode(e)===a.Initials||y.getMode(e)===a.DefaultEntityIcon)){var t=y.backgroundColors[0];if(e.entityPrimaryField){for(var n=0,r=e.entityPrimaryField.length-1;r>=0;r--){var i=e.entityPrimaryField.charCodeAt(r),o=r%8;n^=(i<<o)+(i>>8-o)}t=y.backgroundColors[n%y.backgroundColors.length]}return Object.assign({backgroundColor:t},Object(l.b)(e))}return Object.assign(e.style,Object(l.b)(e))}return{}}var S=c.connect((function(e){return function(t){return t.renderRule(v,e)}}))(y)},"7tM0":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n("IqkD"),a=n("NjDY"),i=n("3mEc");function o(e,t,n){const r=e[t+(n?"."+n:"")+".resx"];return r&&r.contentJson?r.contentJson:null}function s(e,t){const n=Object(i.k)(e);if(!n)return null;let s;if(s=o(n,t,Object(r.w)(e).languageId),s)return s;if(s=o(n,t,Object(a.x)(e).languageCode),s)return s;if(s=o(n,t,null),s)return s;const c=n[t];return c&&c.contentJson?c.contentJson:null}function c(e,t,n){const r=s(e,t);return r?r[n]:null}},"83Lp":function(e,t,n){"use strict";n.d(t,"d",(function(){return p})),n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return f})),n.d(t,"h",(function(){return y})),n.d(t,"e",(function(){return m})),n.d(t,"g",(function(){return b})),n.d(t,"f",(function(){return S}));var r=n("yJdb"),a=n("LMh4"),i=n("Uv1Y"),o=n("WePp");class s extends o.a{constructor(e,t){super("MoCAServerPingTelemetryEvent"),this.addEventParameter("PingResponse",e),this.addEventParameter("ResponseReason",t)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var c=n("pEXn"),l=n("6/BY"),u=n("gy+e"),d=n("xM/W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const p="offline.showreconnectnotification",g="offline.hidereconnectnotification",h="offline.clearreconnectnotification",f="offline.setreconnectstatus";function m(){return{type:"offline.cancelreconnect",execute:({dispatch:e,getState:t},n)=>(n.TraceManager.getTracer("Offline").warn("offlineReconnectNotification: Cancel"),e(v()),Promise.resolve())}}function b(e,t,n,o=!1){return{type:"offline.reconnect",execute(p,g){const h=g.TraceManager.getTracer("Offline");h.warn("offlineReconnectNotification: Reconnect"+(o?" (auto)":""));const f=[];return o||p.dispatch(Object(a.b)(e)),p.dispatch({type:"ping.server.async",execute({dispatch:e,getState:t},n){const r=n.DataSource.get_WebAPIService().get_EventManager();return n.DataSource.ping().nativePromise().then(e=>{const t=new s(e?"PingSuccessful":"Pingfailed",null);return r&&r.ReportEvent(t),e}).catch(e=>{const t=new s("Pingfailed",e.get_Message());return r&&r.ReportEvent(t),Object(i.b)(e)})}}).then(e=>{e?(Object(u.a)(g,p).then(()=>{o?p.dispatch(Object(d.b)(!0)):(Object(l.a)(p.dispatch,1,t),p.dispatch(Object(r.b)())),p.dispatch(O(!0)),g.EventManager.ReportComponentSuccess("Offline.Reconnect")}).catch(e=>{_(p.dispatch,o,n),f.push({name:c.b.ReconnectErrorMessage,value:"Error Happens when refreshing auth token."}),f.push({name:c.b.AutomaticReconnect,value:o}),g.EventManager.ReportComponentFailure("Offline.Reconnect",e,null,f)}),p.dispatch(v())):(_(p.dispatch,o,n),f.push({name:c.b.AutomaticReconnect,value:o}),h.error("Server is not available",f))}).catch(e=>{_(p.dispatch,o,n),f.push({name:c.b.ReconnectErrorMessage,value:"Error Happens when pinging the server."}),f.push({name:c.b.AutomaticReconnect,value:o}),g.EventManager.ReportComponentFailure("Offline.Reconnect",e,null,f)})}}}function _(e,t,n){t||(Object(l.a)(e,2,n),e(Object(r.b)())),e(O(!1))}function y(e){return{type:p,payload:{isReconnectNotificationShown:!0,isServerUnavailableNewSession:!1,type:e}}}function v(){return{type:g,payload:{isReconnectNotificationShown:!1,isServerUnavailableNewSession:!1}}}function S(){return{type:h,payload:{isServerUnavailableNewSession:!0}}}function O(e){return{type:h,payload:{isReconnectSuccessful:e}}}},"84PK":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("504W");class a{constructor(e,t){if(this._rawGuid=null,this._formattedGuid=null,t)this._rawGuid=e;else if(this._rawGuid=a._GetParsedString(e),Object(r.b)(this._rawGuid))throw Error.argumentOutOfRange(String.format(a._InvalidGuidException,e))}getObjectData(){return{rawguid:this._rawGuid}}equals(e){if(e instanceof a)return e._rawGuid===this._rawGuid;if("string"==typeof e)try{return new a(e)._rawGuid===this._rawGuid}catch(e){return!1}return!1}toString(){return this._formattedGuid||(this._formattedGuid=this._rawGuid.substring(0,8)+"-"+this._rawGuid.substring(8,12)+"-"+this._rawGuid.substring(12,16)+"-"+this._rawGuid.substring(16,20)+"-"+this._rawGuid.substring(20,32)),this._formattedGuid}static _GetParsedString(e){return Object(r.b)(e)?null:(e=e.toLowerCase(),a._get_HyphenGuidVerifierPattern().test(e)||a._get_BraceAndHyphenGuidVerifierPattern().test(e)?e.replace(a._get_GuidStripperPattern(),""):a._get_ContiguousGuidVerifierPattern().test(e)?e:null)}static get_empty(){return a._empty||(a._empty=new a("00000000000000000000000000000000",!0))}static _get_GuidStripperPattern(){return a._guidStripperPattern||(a._guidStripperPattern=new RegExp("{|}|-","g"))}static _get_HyphenGuidVerifierPattern(){return a._hyphenGuidVerifierPattern||(a._hyphenGuidVerifierPattern=new RegExp("^(\\d|[a-f]){8}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){12}$"))}static _get_BraceAndHyphenGuidVerifierPattern(){return a._braceAndHyphenGuidVerifierPattern||(a._braceAndHyphenGuidVerifierPattern=new RegExp("^{(\\d|[a-f]){8}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){12}}$"))}static _get_ContiguousGuidVerifierPattern(){return a._contiguousGuidVerifierPattern||(a._contiguousGuidVerifierPattern=new RegExp("^(\\d|[a-f]){32}$"))}static createFromObjectData(e){return new a(e.rawguid)}static tryCreate(e){const t=a._GetParsedString(e);return Object(r.b)(t)?a.get_empty():new a(t)}static createFromFormattedGuidStringAndSkipParsing(e){return new a(e.replace(a._get_GuidStripperPattern(),""),!0)}static isNullOrEmpty(e){return!(!Object(r.a)(e)&&e.length)||!!new a(e).equals(a._empty)}static newGuid(){const e=new Sys.StringBuilder;for(let t=0;t<36;t++)if(14!==t){if(8!==t&&13!==t&&18!==t&&23!==t){if(19===t){const e=Math.floor(16*Math.random());"0123456789abcdef".substr(3&e|8,1)}e.append("0123456789abcdef".substr(Math.floor(16*Math.random()),1))}}else e.append("4");return new a(e.toString(),!0)}}a._InvalidGuidException="'{0}' is not a valid Guid value.",a._empty=null,a._guidStripperPattern=null,a._hyphenGuidVerifierPattern=null,a._braceAndHyphenGuidVerifierPattern=null,a._contiguousGuidVerifierPattern=null,a.__typeName="Microsoft.Crm.Client.Core.Framework.Guid"},"84uC":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.greaterThan=0]="greaterThan",e[e.lessThan=1]="lessThan"}(r||(r={}))},"85o3":function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"e",(function(){return g})),n.d(t,"d",(function(){return h})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return S})),n.d(t,"f",(function(){return m})),n.d(t,"i",(function(){return w})),n.d(t,"j",(function(){return O})),n.d(t,"g",(function(){return I})),n.d(t,"h",(function(){return E}));var r=n("504W"),a=n("SAYH"),i=n("q/7h"),o=n("vNXc"),s=n("EY5k"),c=n("YxC/"),l=n("/oKV"),u=n("5qiD"),d=n("d+dp");const p="2d8d408d-c255-4587-9e34-596d496e6738",g="e611d950-6bab-477c-a5a3-7e9a447b326d",h="436e2293-da8f-4ef9-a1e6-fff25a5beb22",f="c05b417b-708d-4d50-a1e1-6660bb32b9ef",m="gridFilters.retrieve.success",b=["Workplace_Queue_Selector_All","Workplace_Queue_Selector_Public","Workplace_Queue_Selector_Private"],_="0",y="name",v="queueviewtype",S=",";function O({dispatch:e,getState:t},n){return new Promise((p,g)=>{const h=[],m=[],S=[],O=n.DataSource,E=o.a.fromXml("<fetch version= '1.0' mapping='logical' distinct='true' >\n\t\t\t\t\t\t\t<entity name='queue'>\n\t\t\t\t\t\t\t\t<attribute name='name' />\n\t\t\t\t\t\t\t\t<attribute name='queueviewtype' />\n\t\t\t\t\t\t\t\t<attribute name='queueid' />\n\t\t\t\t\t\t\t\t\t<link-entity name='queuemembership' from='queueid' to='queueid' visible='false' link-type='outer' alias='membership' >\n\t\t\t\t\t\t\t\t\t\t<filter type='and'>\n\t\t\t\t\t\t\t\t\t\t\t<condition attribute='systemuserid' operator='eq-userid' />\n\t\t\t\t\t\t\t\t\t\t</filter>\n\t\t\t\t\t\t\t\t\t</link-entity>\n\t\t\t\t\t\t\t\t\t<filter type='or'>\n\t\t\t\t\t\t\t\t\t\t<condition entityname='membership' attribute='systemuserid' operator='eq-userid' />\n\t\t\t\t\t\t\t\t\t\t<condition entityname='queue' attribute='queueviewtype' operator='eq' value='0' />\n\t\t\t\t\t\t\t\t\t</filter>\n\t\t\t\t\t\t\t\t\t<filter type='and'>\n\t\t\t\t\t\t\t\t\t\t<condition attribute='statecode' operator='eq' value='0' />\n\t\t\t\t\t\t\t\t\t</filter>\n\t\t\t\t\t\t\t\t\t<order attribute=\"name\" descending=\"false\" />\n\t\t\t\t\t\t\t</entity>\n\t\t\t\t\t\t</fetch>",new a.a(f));E.pageSize=5e3;const I=E.getKeyQuery(),w=new d.a(u.a.NotCached,l.a.Remote),j=O.retrieveMultiple(I,w,null).nativePromise().then(e=>{const t=Object(i.a)(e),n=h.length;for(let e=0;e<t.length;e++){const i=t[e].fields[v],o=null!=i&&i.valueString===_,s=a.a.toString(t[e].identifier.id);o?S.push(s):m.push(s);const c=`${n+e}:${s}`,l=Object(r.a)(t[e].fields[y])?"":t[e].fields[y].value;h.push({value:c,text:l,isDefault:!1})}}),P=e(Object(s.e)(b));Promise.all([P,j]).then(()=>{const e=Object(c.e)(t(),b);C(h,e),p(h)})})}function C(e=[],t){const n=e.length;return e.push({value:`${n}:${p}`,text:null==t?void 0:t.Workplace_Queue_Selector_All,isDefault:!1}),e.push({value:`${n+1}:${g}`,text:null==t?void 0:t.Workplace_Queue_Selector_Public,isDefault:!1}),e.push({value:`${n+2}:${h}`,text:null==t?void 0:t.Workplace_Queue_Selector_Private,isDefault:!0}),e}function E(){var e,t;const n=null===(t=null===(e=C().filter(e=>e.isDefault))||void 0===e?void 0:e[0])||void 0===t?void 0:t.value,r=null==n?void 0:n.split(":");return(null==r?void 0:r.length)>1?r[1]:n}function I(){return new Promise((e,t)=>{e([])})}function w(e,t,n){return{type:"gridFilters.retrieve.async",execute:(r,a)=>n(r,a,e,t).then(t=>(r.dispatch(function(e,t){return{type:m,payload:{entityFilters:{[e]:t}}}}(e,t)),t))}}},"87CA":function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.PerformanceEvent=void 0;var a=function(){},i=function(){function e(e,t,n){this._eventName=e,this._zone=t,this._getTransports=n}return e.prototype.getName=function(){return this._eventName},e.prototype.getZone=function(){return this._zone},e.prototype.getTransports=function(){return this._getTransports()},e.prototype.createMarker=function(e,t){var n,a;void 0===e&&(e=null),void 0===t&&(t=null);var i=null!=t?t:performance.now();try{for(var o=r(this._getTransports()),s=o.next();!s.done;s=o.next()){var c=s.value;try{c.writeMarker(this,i,e)}catch(e){setTimeout((function(){throw e}),0)}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}},e.prototype.createRetroactiveStopwatch=function(e,t,n){var a,i;void 0===n&&(n=null);try{for(var o=r(this._getTransports()),s=o.next();!s.done;s=o.next()){var c=s.value;try{c.writeRetroactiveTimespan(this,e,t,n)}catch(e){setTimeout((function(){throw e}),0)}}}catch(e){a={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(a)throw a.error}}},e.prototype.startStopwatch=function(e){var t,n,i=performance.now(),o=this._getTransports();if(0===o.length)return a;var s=[];try{for(var c=r(o),l=c.next();!l.done;l=c.next()){var u=l.value;try{s.push(u.startTimespan(this,i,e))}catch(e){setTimeout((function(){throw e}),0)}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return this._endStopwatch.bind(this,s,i)},e.prototype._endStopwatch=function(e,t,n){var a,i,o=performance.now()-t;try{for(var s=r(e),c=s.next();!c.done;c=s.next()){var l=c.value;try{l(o,n)}catch(e){setTimeout((function(){throw e}),0)}}}catch(e){a={error:e}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(a)throw a.error}}},e}();t.PerformanceEvent=i},"8CLP":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.ProfileUnavailable=1]="ProfileUnavailable",e[e.DatabaseUnavailable=2]="DatabaseUnavailable",e[e.MetadataChanged=3]="MetadataChanged",e[e.SyncFailure=-1]="SyncFailure",e[e.UpgradeClient=-2]="UpgradeClient"}(r||(r={}))},"8Jtx":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Button_Label_Close",a=[r]},"8MGk":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("IpQH"),a=n("uM6Y"),i=n("VkXQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class o extends r.a{constructor(e,t){super(e,t,a.d)}openFile(e,t){const n=t||{openMode:1};return this.execute(i.d.openFile.name,e,n)}pickFile(e){return this.execute(i.d.pickFile.name,e)}}},"8Mff":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Default=0]="Default",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(r||(r={}))},"8N/3":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("OwbH"),a=n("kToj"),i=n("504W"),o=n("KJT0");class s extends r.a{constructor(e,t,n,r){super([e]),this._leftBound=null,this._rightBound=null,this._intervalType=0,this._leftBound=t,this._rightBound=n,this._intervalType=r}get_leftBound(){return this._leftBound}get_rightBound(){return this._rightBound}get_intervalType(){return this._intervalType}testCondition(e){let t=!1;if(!Object(i.a)(e))switch(this.get_intervalType()){case 0:t=e>=this.get_leftBound()&&e<=this.get_rightBound();break;case o.a.open:t=e>this.get_leftBound()&&e<this.get_rightBound();break;case o.a.openLeft:t=e>this.get_leftBound()&&e<=this.get_rightBound();break;case o.a.openRight:t=e>=this.get_leftBound()&&e<this.get_rightBound();break;default:Object(a.a)(!1,"unknown range type")}return t}}},"8S1D":function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"8VF0":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="entityMetadata.retrieve";function a(e){return{type:r,payload:e}}},"8aQ2":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("KdpX"),a=n("OtHk"),i=n("K7RF"),o=n("/oKV"),s=n("iJGp");let c=!0;function l(e){return c?{type:"grid.retrieveEntityDashboardSelectors.async",execute:({dispatch:t,getState:n})=>Object(a.g)(n(),e)?Promise.resolve():t(function(e,t){return Object(i.b)("dashboardselector",null,e,null,!0,s.a.OnDemandWithContext,null,null,[],null,t)}(e,o.a.LocalAndRemote)).then(()=>Object(a.g)(n(),e)?Promise.resolve():(c=!1,t(Object(r.d)(null,null,e))))}:Object(r.d)(null,null,e)}},"8f6m":function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"i",(function(){return u})),n.d(t,"h",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="None",a="Completed",i="Downloading",o="Error",s="Suspended",c="Waiting";function l(){return{entities:[{}],totalProgress:r,downloadedFileCount:0,totalFileCount:0,totalErrorCount:0}}function u(e,t){for(const n of e.entities)n.entityName&&t.get(n.entityName)&&(n.entityName=t.get(n.entityName));return e}function d(e){const t=[];for(const n of e.entities)t.push(n.entityName);return t}},"8mbc":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r={EventManager:"EventManager",TraceManager:"TraceManager",EventListeners:"EventListeners",Performance:"Performance",TelemetryArchiver:"TelemetryArchiver",TelemetryQueue:"TelemetryQueue",AriaClient:"AriaClient"},a="*"},"8nT0":function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"u",(function(){return a})),n.d(t,"v",(function(){return i})),n.d(t,"q",(function(){return o})),n.d(t,"w",(function(){return s})),n.d(t,"t",(function(){return c})),n.d(t,"r",(function(){return l})),n.d(t,"x",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"j",(function(){return p})),n.d(t,"h",(function(){return g})),n.d(t,"g",(function(){return h})),n.d(t,"p",(function(){return f})),n.d(t,"f",(function(){return m})),n.d(t,"e",(function(){return b})),n.d(t,"s",(function(){return _})),n.d(t,"i",(function(){return y})),n.d(t,"k",(function(){return v})),n.d(t,"m",(function(){return S})),n.d(t,"l",(function(){return O})),n.d(t,"b",(function(){return C})),n.d(t,"o",(function(){return E})),n.d(t,"n",(function(){return I})),n.d(t,"y",(function(){return w})),n.d(t,"c",(function(){return j}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="entityimage_url",a="statecode",i="statuscode",o="ownerid",s="transactioncurrencyid",c="regardingobjectid",l="processid",u="traversedpath",d="activestageid",p="fullname",g="filesizeinbytes",h="filesizebytes",f="mimetype",m="filename",b="fileattachmentid",_="regardingfieldname",y="fullimageurl",v="imagedata",S="imagepixelwidth",O="imagepixelheight",C="colordepthbits",E="imageurl",I="imagetimestamp",w="versionnumber",j="devicefilepath"},"8o18":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("WF3G"),a=n("84PK"),i=n("504W");class o extends r.a{constructor(e,t){super(e),this._overrideKey=null,this._sourceId=t}get_key(){if(!Object(i.b)(this._overrideKey))return this._overrideKey;let e;const t=a.a.tryCreate(this._sourceId);return e=t.equals(a.a.get_empty())?this._sourceId:t.toString(),this.get_EntityLogicalName()+","+e+","+this.get_returnTotalRecordCount()}get_DataLayerInternalCachingKey(){return`${this.get_key()}::${this.get_PageNumber()}`}get_SourceId(){return this._sourceId}get_OverrideKey(){return this._overrideKey}get_PublicKey(){return this._publicKey}set_OverrideKey(e){return this._overrideKey=e,e}set_PublicKey(e){return this._publicKey=e,this._publicKey}generateNorSyncAttributeName(e,t,n){return t}get_id(){return this.get_key()}}},"8tWD":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Json=0]="Json",e[e.FetchXml=1]="FetchXml",e[e.Sql=2]="Sql",e[e.LayoutXml=3]="LayoutXml"}(r||(r={}))},"8unZ":function(e,t,n){"use strict";function r(e){return e&&e.metadata&&e.metadata.appShellSettings&&e.metadata.appShellSettings.appNavSettings?e.metadata.appShellSettings.appNavSettings:null}function a(e){const t=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return e&&e.metadata&&e.metadata.appShellSettings?e.metadata.appShellSettings:null}(e);return t?t.initialized:null}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}))},"8uvO":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("nA3O"),a=n("kToj"),i=n("7Gx7"),o=n("g73c"),s=n("NMtn");var c=n("M6xi"),l=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(e,t){return Object(l.a)(t)?e===Number||Type.isEnum(e)?0:e!==Boolean&&null:t}class d{constructor(e,t,n,r,i,o,s){this._name=null,this._propertyType=null,this._ownerType=null,this._defaultValue=null,this._propertyChanged=null,this._propertyChanging=null,this._jsonConverter=c.a.defaultConverter,Object(a.a)(!Object(l.b)(e),"Property name must be a valid name."),Object(a.a)(!Object(l.a)(t),"propertyType cannot be null"),Object(a.a)(!Object(l.a)(n),"ownerType cannot be null"),this._name=e,this._propertyType=t,this._ownerType=n,this._defaultValue=s?r:u(t,r),this._propertyChanging=i,this._propertyChanged=o,this.AssertPropertyValue(this.get_defaultValue())}get_name(){return this._name}get_propertyType(){return this._propertyType}get_ownerType(){return this._ownerType}get_defaultValue(){return this._defaultValue}get_fullName(){return this.get_ownerType().getName()+"."+this.get_name()}get_jsonConverter(){return this._jsonConverter}set_jsonConverter(e){if(this._jsonConverter!==c.a.defaultConverter)throw Error.invalidOperation("Cannot set JsonConverter of a property twice.");return this._jsonConverter=e,e}coerceToPropertyType(e){if(void 0===e)return this.get_defaultValue();if(null===e)return u(this.get_propertyType(),e);if(this.get_propertyType().isInstanceOfType&&this.get_propertyType().isInstanceOfType(e)||"number"==typeof e&&this.get_propertyType()[e])return e;if("string"==typeof e){if(Type.isEnum(this.get_propertyType()))return Object(o.b)(this.get_propertyType(),e);if(this.get_propertyType()===Number){const t=Number.parseInvariant(e);if(!isNaN(t)&&isFinite(t))return t}const t=this.get_propertyType().parse;if(!Object(l.a)(t)){let n=null;try{n=t(e)}catch(t){n=JSON.parse(e)}if(void 0!==n)return n}}if("object"==typeof e&&this.get_propertyType()===Error)return function(e){Object(s.d)(e,"errorInformation");const t={};return t.message=e.errorMessage,t.name=e.errorType,t.exceptionString=e.errorString,t.innerException=e.errorCause,Error.create(t.message,t)}(e);let t=this.get_propertyType().create;if(!Object(l.a)(t))return t(e);if("object"==typeof e&&this.get_propertyType().prototype&&this.get_propertyType().prototype.getSchema){const t=new(this.get_propertyType());return t.setValues(e),t}const n=this.get_propertyType().getName()+"Converter";try{const r=Type.parse(n);if(!Object(l.a)(r)&&(t=r.create,!Object(l.a)(t)))return t(e)}catch(e){}throw Error.invalidOperation(this.get_fullName()+" cannot safely coerce "+Object.getType(e).getName()+" to "+this.get_propertyType().getName())}coerceToJsonType(e){return void 0===e?this._coerceToJsonTypeInternal(this.get_defaultValue()):null===e?null:(this.AssertPropertyValue(e),Type.isEnum(this.get_propertyType())?e:this._coerceToJsonTypeInternal(e))}raisePropertyChanged(e){this._propertyChanged&&this._propertyChanged(e)}raisePropertyChanging(e){this._propertyChanging&&this._propertyChanging(e)}AssertPropertyValue(e){if(void 0===e){if(this.get_propertyType()===Boolean)return;Object(a.a)(!1,String.format("{0} cannot be set to an undefined value.",this))}Object(a.a)(null===e||this.get_propertyType().constructor===Object||this.get_propertyType().isInstanceOfType(e)||Type.isEnum(this.get_propertyType())&&("number"==typeof e||"string"==typeof e),String.format("Cannot set an instance of {0} as the value of {1}, which requires values of type {2}.",null!==e?Object.getType(e).getName():null,this,this.get_propertyType().getName&&this.get_propertyType().getName()))}_coerceToJsonTypeInternal(e){if(null===e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e)return e;const t=Object.getType(e);if(e instanceof r.a)return e.getValues();if(e instanceof Array){const t=e,n=[];for(let e=0;e<t.length;e++)n[e]=this._coerceToJsonTypeInternal(t[e]);return n}if(e instanceof i.a){const t=e.get_dictionary(),n={};for(const e in t){const r={key:e,value:t[e]};n[r.key]=this._coerceToJsonTypeInternal(r.value)}return n}let n=t.condense;if(!Object(l.a)(n))return n(e);if(e instanceof Error)return function(e){Object(s.d)(e,"exception");const t=e,n={};return n.errorMessage=t.message,n.errorType=t.name,n.errorString=t.exceptionString,n.errorCause=t.innerException,n}(e);const a=t.getName()+"Converter";try{const t=Type.parse(a);if(!Object(l.a)(t)&&(n=t.condense,!Object(l.a)(n)))return n(e)}catch(e){}throw Error.invalidOperation(this.get_fullName()+" cannot safely coerce "+this.get_propertyType().getName()+" to JSON")}}},"9+gz":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAutomationState=t.clearAutomationState=t.saveAutomationState=void 0;t.saveAutomationState=function(e){sessionStorage.setItem("automationState",JSON.stringify(e))},t.clearAutomationState=function(){sessionStorage.removeItem("automationState")},t.getAutomationState=function(){var e=sessionStorage.getItem("automationState");return e?JSON.parse(e):null}},"91WF":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("5yoC"),a=n("RIwK");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i extends r.a{constructor(e,t,n,r,a,i,o,s,c,l,u,d,p,g){super(),this._originalFunction=null,this._functionRaw=null,this._message=r,this._lineNumber=e,this._url=s,this._exceptionNumber=l,this._clientName=d,this._clientState=p,this._callStack=g}get_name(){return"ScriptError"}requestBody(){return String.format('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><SendScriptErrorReport xmlns="http://schemas.microsoft.com/crm/2009/WebServices"><ReportVersion>1.0</ReportVersion>\r\n<ScriptErrorDetails>\r\n<Message>'+Object(a.b)(this._message)+"</Message>\r\n<ExceptionNumber>"+Object(a.b)(this._exceptionNumber.toString())+"</ExceptionNumber>\r\n<Line>"+this._lineNumber+"</Line>\r\n<URL>"+Object(a.b)(this._url)+"</URL>\r\n<PageURL>"+Object(a.b)(window.location.href)+"</PageURL>\r\n<Function>"+Object(a.b)(this._originalFunction)+"</Function>\r\n<FunctionRaw>"+Object(a.b)(this._functionRaw)+"</FunctionRaw>\r\n<CallStack>\r\n"+Object(a.b)(this._callStack)+"   </CallStack>\r\n</ScriptErrorDetails>\r\n<ClientInformation>\r\n<BrowserUserAgent>"+Object(a.b)(window.navigator.userAgent)+"</BrowserUserAgent>\r\n<BrowserLanguage>"+Object(a.b)(window.navigator.browserLanguage)+"</BrowserLanguage>\r\n<SystemLanguage>"+Object(a.b)(window.navigator.systemLanguage)+"</SystemLanguage>\r\n<UserLanguage>"+Object(a.b)(window.navigator.userLanguage)+"</UserLanguage>\r\n<ScreenResolution>"+window.screen.width+"x"+window.screen.height+"</ScreenResolution>\r\n<ClientName>"+Object(a.b)(this._clientName)+"</ClientName>\r\n<ClienState>"+Object(a.b)(this._clientState)+"</ClienState>\r\n<ClientTime>"+Object(a.b)((new Date).toDateString())+"</ClientTime>\r\n</ClientInformation>\r\n</SendScriptErrorReport></soap:Body></soap:Envelope>")}}i.scriptErrorRelativeWebEndpointUrl="/AppWebServices/ScriptError.asmx",i.scriptErrorSendReportSoapAction="http://schemas.microsoft.com/crm/2009/WebServices/SendScriptErrorReport"},9692:function(e,t,n){"use strict";n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("2YQW"),a=n("Oz8S");const i="gc.data.remove",o="gc.data.update",s={},c=[o,i],l=[o,i],u={};function d(e,t){if(0===Object.keys(t).length)return e;const n=Object.assign({},e);for(const e in t){const r=t[e];for(const a in r)n[e]||(n[e]=t[e]),n[e][a]=t[e][a]}return Object.freeze(n)}function p(e,t){if(0===Object.keys(t).length)return e;const n={};for(const r in e){const a=e[r];if(void 0===t[r])n[r]=e[r];else for(const e in a)void 0===t[r][e]&&(n[r]||(n[r]={}),n[r][e]=t[r][e])}return Object.freeze(n)}const g=[o,i];const h={entities:function(e=u,t){return-1!==c.indexOf(t.type)&&t&&t.payload&&t.payload.entities?t.type===i?p(e,t.payload.entities):d(e,t.payload.entities):e},lists:function(e=s,t){return-1!==g.indexOf(t.type)&&t&&t.payload&&t.payload.lists?t.type===i?Object(a.b)(e,t.payload.lists):Object(a.a)(e,t.payload.lists):e},charts:function(e=u,t){return-1!==l.indexOf(t.type)&&t&&t.payload&&t.payload.charts?t.type===i?p(e,t.payload.charts):d(e,t.payload.charts):e},chartData:function(e=s,t){return-1!==l.indexOf(t.type)&&t&&t.payload&&t.payload.chartData?t.type===i?Object(a.b)(e,t.payload.chartData):Object(a.a)(e,t.payload.chartData):e}},f=Object(r.a)(h)},"969l":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.getControlsResourceKeyList=function(e){if(!e)return null;switch(e){case"MscrmControls.Calendar.CalendarControl":return["CustomControl_Calendar_AllDayItem","CustomControl_Calendar_Today","CustomControl_Calendar_WeekView","CustomControl_Calendar_MonthView","CustomControl_Calendar_DayView","CustomControl_Calendar_ErrorView_DefaultMessage","CustomControl_Calendar_ViewMore"];case"MscrmControls.Containers.FieldSectionItem":return["ProcessControl.RequiredStepTooltip"]}return null},e}()},"99zj":function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return d}));var r=n("K7RF"),a=n("Uv1Y"),i=n("3mEc"),o=n("eXjw"),s=n("/oKV"),c=n("iJGp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l="webresourcedescriptor.stub";function u(e){return d([e])}function d(e){return{type:"webresourcedescriptor.retrieve.async",execute({dispatch:t,getState:n},a){const o=n(),c=Object(i.k)(o),l=new Array,u=new Array;for(let t of e){const e=/^\$webresource:/i;t=t.replace(e,""),c[t]?Object(r.e)(o,c[t].OverallVersionNumber)&&-1===u.indexOf(t)&&u.push(t):-1===l.indexOf(t)&&l.push(t)}return l.length>0||u.length>0?Promise.all([t(p(l,s.a.LocalAndRemote)),t(p(u,s.a.Remote))]):Promise.resolve([null])}}}function p(e,t){return{type:"webresourcedescriptor.retrieve.async",execute({dispatch:n,getState:o},s){if(e.length>0){const s=Object(r.b)("webresourcedescriptor",null,null,null,!1,c.a.OnDemandWithoutContext,null,null,e,null,t);return n(s).then(t=>{const r=o(),a=Object(i.f)(r,e);return n(d(a)).then(e=>Object.assign(Object.assign({},t),e))}).catch(a.b)}return Promise.resolve({})}}}function g(e){const t={webResourceDescriptorsByName:{[e]:{contentJson:null,name:e,state:o.a.Error}}};return{type:l,payload:t}}},"9A3e":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("IpQH"),a=n("uM6Y"),i=n("VkXQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class o extends r.a{constructor(e,t){super(e,t,a.b)}getBarcodeValue(){return this.execute(i.b.getBarcodeValue.name,"ScanBarCode",{})}}},"9L53":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(){this.state={}}composedPath(){return[]}initEvent(e,t,n){}preventDefault(){}stopImmediatePropagation(){}stopPropagation(){}}},"9XdG":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let r=null;function a(e){r=e}function i(){return r}},"9eA9":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("iKQk"),a=n("H4dV");
/**
 * This is a polyfill for the URL standard until it gains support, https://url.spec.whatwg.org/
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i{constructor(e){this._a=document.createElement("a"),this._a.href=e,this._searchParams=new r.a(this._a.search),this._searchParams.urlInternal=this}get searchParams(){return this._searchParams}set searchParams(e){}_updateSearchParams(){this._searchParams.updateFromUrlInternal()}toString(){return this._a.href}clearCredential(){this._a.username="",this._a.password=""}get href(){return this._a.href}set href(e){this._a.href=e,this._updateSearchParams()}get protocol(){return this._a.protocol}set protocol(e){this._a.protocol=e}get host(){return this._a.host}set host(e){this._a.host=e}get hostname(){return this._a.hostname}set hostname(e){this._a.hostname=e}get port(){return this._a.port}set port(e){this._a.port=e}get pathname(){const e=this._a.pathname;return e[0]&&"/"!==e[0]?"/"+e:e}set pathname(e){this._a.pathname=e}get search(){return this._a.search}set search(e){const t=a.a.getInstance();if(t.get_IsBrowserIE()||t.get_IsBrowserEdge()){const t=!e||e.startsWith("?")?"":"?";this._a.href=this._a.protocol+"//"+this._a.host+this.pathname+t+e+this.hash}else this._a.search=e;this._updateSearchParams()}get hash(){return this._a.hash}set hash(e){this._a.hash=e}}function o(){const e=window.location.href,t=e.indexOf(window.location.pathname);return e.substring(0,t)}},"9egp":function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var r=n("fILV"),a=n("pEXn"),i=n("K7RF"),o=n("Uv1Y"),s=n("Z/4N"),c=n("vmcK"),l=n("BDhr"),u=n("/oKV"),d=n("iJGp");function p(e){return{type:"custom.control.configuration.async",execute({dispatch:t,getState:n},r){const a=n();let p=u.a.LocalAndRemote;const g=Object(s.d)(a,e,c.a);if(g&&(g.CustomControls||-1===g.VersionNumber)){if(!Object(i.e)(a,g.OverallVersionNumber))return Promise.resolve();p=u.a.Remote}return t(Object(i.b)("customcontroldefaultconfig",null,e,null,!1,d.a.OnDemandWithoutContext,null,null,[],null,p)).then(n=>{if(n&&n.homePageConfigurations&&n.homePageConfigurations[e]&&null==n.homePageConfigurations[e][c.a]){const r=Object(l.a)(a);n.homePageConfigurations[e][c.a]={UniqueId:null,CustomControls:null,FormLibraries:null,EventHandlers:null,VersionNumber:-1,OverallVersionNumber:r.currentVersion},t(function(e){return{type:i.a,payload:e}}(n))}},o.b)}}}var g=n("FZDd"),h=n("sZ+8"),f=n("69Qu"),m=n("iZ7K"),b=n("BFlg"),_=n("Qjw6"),y=n("M0zh"),v=n("nmJf"),S=n("a72m"),O=n("d0w6"),C=n("IqkD"),E=n("EY5k"),I=n("XvLr"),w=n("8aQ2"),j=n("P6DH"),P=n("w+N3"),T=n("Lyxw"),N=n("eVWz"),A=n("NM3A"),D=n("3/02"),R=n("oOvK");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const x={predictedNextPageFactories:[_.a],getName:()=>r.a,throwIfInvalidUrl(e){},getRequiredAttributes(){throw new Error("Not Implemented")},preInitializePage:e=>({type:"preInitialize.gridAction.async",execute:({dispatch:t,getState:n},r)=>{const{entityTypeName:a,viewId:i,viewType:c}=e,l=r.TraceManager.getTracer(b.z),u=Object(C.w)(n());if(null===a){const e="Cannot load grid page without etn",t=new o.a(e),n=b.x+".preInitializeAction";return r.EventManager.ReportComponentFailure(n,t),Promise.reject(t)}let d,_=!1;const x=n(),M=t(p(a)).then(()=>{l.info("Control configuration retrieved for the main page grid")}).catch(e=>{const t="Control configuration retrieval failed for the main page grid with error : "+e.message;return l.info(t+". Default grid configuration will be used."),Promise.resolve()}),F=Object(f.b)(n());let k;if(i||(d=Object(j.lb)(u,a,l,x),_=d&&d.PinnedEntity&&(F||Object(h.l)(x,d.PinnedEntity))),a===j.a){const e={};e[j.a]=[],_&&d.PinnedEntity!==j.a&&(e[d.PinnedEntity]=null),k=t(Object(g.e)(e))}else k=t(Object(g.f)(a,!1,[]));const L=Object(T.c)(n(),D.wd)&&F,B=Object(T.c)(n(),D.Rd)&&F&&Object(N.b)(n());if((L||B)&&t(Object(g.f)(A.b,!1,null)),F||Object(h.l)(x,a)){if(t(Object(v.a)(y.i+a)),_?(t(Object(S.a)(d.PinnedEntity,O.a.MAIN_APPLICATION_VIEW,d.ViewType,d.ViewId)),a===j.a&&t(Object(S.a)(j.a,O.a.MAIN_APPLICATION_VIEW,void 0,void 0))):t(Object(S.a)(a,O.a.MAIN_APPLICATION_VIEW,c,i)),a===j.a){Object(j.B)(x).forEach(e=>{e===j.a||d&&e===d.PinnedEntity||t(Object(S.b)(e,O.a.MAIN_APPLICATION_VIEW))});const e=Object(m.a)(n()),r=[j.i,j.f,j.h,j.e,j.g,j.b],a={};for(const t in e){const n=e[t].EntityLogicalName;(r.indexOf(n)>-1&&(!d||n!==d.PinnedEntity)&&F||Object(h.l)(x,n))&&(a[n]=[])}t(Object(g.e)(a))}F&&t(Object(w.a)(a));const e="ViewSelectorAllActivities";t(Object(E.e)([...I.labelList,e,...P.c])),Object(s.e)(n(),b.p)||t(Object(R.c)(b.p))}return Promise.all([k,M]).catch(e=>{const t="Entity Metadata retrieve failed due to error: "+e,n=b.x+".preInitializeAction";return r.EventManager.ReportComponentFailure(n,t),Promise.reject(e)})}}),createPageModule:e=>Promise.all([n.e(2),n.e(6),n.e(0),n.e(1),n.e(3),n.e(4),n.e(5),n.e(8),n.e(7),n.e(67)]).then(n.bind(null,"WunZ")).then(({Grid:t})=>new t(e)),getTelemetryAttributes:e=>[{name:a.b.EntityName,value:e&&e.entityTypeName},{name:a.b.ViewId,value:e&&e.viewId&&e.viewId.guid},{name:a.b.VisualizationId,value:e&&e.visualizationId&&e.visualizationId.guid}],getKeyForThawedCheck:e=>e.entityTypeName};Object.freeze(x)},"9fGf":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r,a=n("w1eR"),i=n("eOoD");function o(e){const t=e&&e.clientHost&&e.clientHost.type;if(!t||t!==a.a.MobileApplication)return r.Web;switch(e&&e.clientHost&&e.clientHost.subtype){case i.a.Phone:return r.Phone;case i.a.Tablet:return r.Tablet}}!function(e){e[e.Phone=0]="Phone",e[e.Tablet=1]="Tablet",e[e.Web=2]="Web"}(r||(r={}))},"9gmQ":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="aps.initialize";function a(e){return{type:r,payload:e}}},"9wSR":function(e,t,n){"use strict";n.d(t,"g",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o}));const r="form.updateautosaveinterval",a="form.incrementautosaveinterval",i=3e4,o=20*i,s={};function c(e){return s[e]&&(clearTimeout(s[e]),delete s[e]),{type:r,payload:void 0,meta:{pageId:e}}}function l(e){return{type:a,payload:void 0,meta:{pageId:e}}}},"9z2t":function(e,t,n){"use strict";e.exports=n("bv+i")},A09F:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.QuickCreateForm=1]="QuickCreateForm",e[e.MainFormDialog=2]="MainFormDialog",e[e.EditForm=3]="EditForm"}(r||(r={}))},A2T2:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return d}));var r=n("GPkz"),a=n("qu3G"),i=n("Xi8U"),o=n("fWyz"),s=n("YcFo");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c="recentItem.pin",l="recentItem.unpin";function u(e){return{type:"recentItem.pin.sync",execute(t,n){r.a.session&&r.a.session.addEvent(a.a.pinItem,Object(o.a)(t.getState(),e,!1)),t.dispatch(function(e){return{type:c,payload:e}}(e)),window.setTimeout(()=>n.RecentItemsSyncManager.notifyRecentItemsUpdate())},sync:!0}}function d(e){return{type:"recentItem.unpin.sync",execute(t,n){if(r.a.session){const n=Object(i.c)(t.getState());n&&(n.relativeToEntryId===s.c?r.a.session.addEvent(a.a.unPinItemFromRecent,Object(o.a)(t.getState(),e,!1)):r.a.session.addEvent(a.a.unPinItemFromPinned,Object(o.a)(t.getState(),e,!0)))}t.dispatch(function(e){return{type:l,payload:e}}(e)),window.setTimeout(()=>n.RecentItemsSyncManager.notifyRecentItemsUpdate())},sync:!0}}},AAlD:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="appsettings.updateGroupsState";function a(e){return{type:r,payload:e}}},ABCl:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u}));var r=n("2yvP");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a{constructor(e){this._innerPromise=e}then(e,t){const n=Object(r.a)();let a,i;return e&&(a=t=>Object(r.b)(n,()=>e(t))),t&&(i=e=>Object(r.b)(n,()=>t(e))),this._innerPromise.then(a,i)}catch(e){const t=Object(r.a)();let n;return e&&(n=n=>Object(r.b)(t,()=>e(n))),this._innerPromise.catch(n)}}var i=n("ZIjf"),o=n("IaGr"),s=n("16wZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c="Exception in customer logic";class l{constructor(e,t,n,r){var a;if(this._eventParameters=[],this._failureReports={},this._fileName=null===(a=t.split("."))||void 0===a?void 0:a[1],this._store=e,n&&this.addEventParameter({name:"contextToken",value:JSON.stringify(n),isEventParam:!0}),r){const e=this.getComponentName("constructor");this._validateParamsInternal(e,r);for(const e of r)this.addEventParameter(e)}}getComponentName(e){return`ClientApi.${this._fileName}.${e}`}reportFailure(e,t,n){o.a.getInstance().eventManager.ReportComponentFailure(e,t,null,n),e=i.a.trimComponentName(e),this._failureReports[e]?this._failureReports[e]++:this._failureReports[e]=1}execute(e,t,n,r=!0){return this._executeInternal(e,(n,a,i)=>{const o=t(n,i,{fileName:this._fileName,apiName:e});return this._reportComponentUsage(n,a,r),o},(e,t,n,a)=>this._errorHandlerSync(e,t,n,a,r),n,r)}executeAsync(e,t,n,r=!0){return new a(this._executeInternal(e,(n,a,i)=>t(n,i,{fileName:this._fileName,apiName:e}).then(e=>(this._reportComponentUsage(n,a,r),e)).catch(e=>this._errorHandlerAsync(e,n,a,i,r)),(e,t,n,a)=>this._errorHandlerAsync(e,t,n,a,r),n,r))}_executeInternal(e,t,n,a,s=!0){a||(a=[]);const c=Object(r.a)();a.push({name:"clientApiSource",value:c.sourceName,isEventParam:!0});const l=this.getComponentName(e);let u;this._validateParamsInternal(l,a);try{return u=this._getEventParams(a),s&&(i.a.instance.reportCall(l,c),"unknown"===c.sourceName&&o.a.getInstance().traceManager.getTracer(l).info("Client API was called with unknown source attribution.",u)),t(l,c,u)}catch(e){return n(e,l,c,u)}}addEventParameter(e){e.isEventParam&&this._eventParameters.push(e)}_errorHandlerSync(e,t,n,r,a){throw e.errorCode?2415919125!==e.errorCode&&2415919121!==e.errorCode&&(r.push({name:"errorCode",value:e.errorCode}),r.push({name:"errorMessage",value:e.message}),o.a.getInstance().traceManager.getTracer(t).error("Error detected with an error code.  See EventContext for more details.",r)):this.reportFailure(t,e,r),this._reportComponentUsage(t,n,a),e.errorCode=2415919125,e}_errorHandlerAsync(e,t,n,r,a){if(2415919121===e.errorCode)throw this._reportComponentUsage(t,n,a),e;const i=e;return Object(s.d)(this._store,e,t,r,!0,!1,this).catch(e=>(this._reportComponentUsage(t,n,a),e.raw=JSON.stringify(i),Promise.reject(e)))}_reportComponentUsage(e,t,n){n&&(this._failureReports[e]?i.a.instance.reportFailure(e,t):i.a.instance.reportSuccess(e,t)),this._failureReports[e]=0}_validateParamsInternal(e,t){if(t){const n=this._getEventParams(t);for(const r of t)r.isRequired&&Object(s.g)(r.value,e,r.name,n),r.expectedDataType&&null!==r.value&&void 0!==r.value&&Object(s.f)(e,r.name,r.value,r.expectedDataType,n)}}_getEventParams(e){var t;const n=[];for(const e of this._eventParameters)n.push(e);const a=Object(r.a)();if((null===(t=a.eventParameters)||void 0===t?void 0:t.length)>0)for(const e of a.eventParameters)n.push(e);if(e)for(const t of e)t.isEventParam&&n.push(t);return n}}function u(e,t,n){try{return n()}catch(n){console.error(`${c}: ${n.message}`),t.push({name:"exception",value:n.message}),t.push({name:"exceptionStack",value:n.stack}),o.a.getInstance().traceManager.getTracer(e).error(c,t)}}},"AF/G":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"j",(function(){return g})),n.d(t,"k",(function(){return h})),n.d(t,"l",(function(){return f})),n.d(t,"m",(function(){return m})),n.d(t,"n",(function(){return b})),n.d(t,"p",(function(){return _})),n.d(t,"q",(function(){return y})),n.d(t,"r",(function(){return v})),n.d(t,"s",(function(){return S})),n.d(t,"t",(function(){return O})),n.d(t,"o",(function(){return C})),n.d(t,"u",(function(){return E})),n.d(t,"v",(function(){return I})),n.d(t,"w",(function(){return w})),n.d(t,"x",(function(){return j})),n.d(t,"y",(function(){return P})),n.d(t,"z",(function(){return T})),n.d(t,"A",(function(){return N})),n.d(t,"B",(function(){return A})),n.d(t,"C",(function(){return D})),n.d(t,"D",(function(){return R})),n.d(t,"E",(function(){return x})),n.d(t,"G",(function(){return M})),n.d(t,"H",(function(){return F})),n.d(t,"I",(function(){return k})),n.d(t,"J",(function(){return L})),n.d(t,"K",(function(){return B})),n.d(t,"L",(function(){return U})),n.d(t,"M",(function(){return V})),n.d(t,"N",(function(){return z})),n.d(t,"O",(function(){return W})),n.d(t,"P",(function(){return q})),n.d(t,"Q",(function(){return H})),n.d(t,"R",(function(){return G})),n.d(t,"S",(function(){return K})),n.d(t,"T",(function(){return Q})),n.d(t,"U",(function(){return X})),n.d(t,"V",(function(){return Y})),n.d(t,"W",(function(){return J})),n.d(t,"X",(function(){return $})),n.d(t,"Y",(function(){return Z})),n.d(t,"Z",(function(){return ee})),n.d(t,"ab",(function(){return te})),n.d(t,"bb",(function(){return ne})),n.d(t,"eb",(function(){return re})),n.d(t,"db",(function(){return ae})),n.d(t,"cb",(function(){return ie})),n.d(t,"fb",(function(){return oe})),n.d(t,"gb",(function(){return se})),n.d(t,"hb",(function(){return ce})),n.d(t,"ib",(function(){return le})),n.d(t,"jb",(function(){return ue})),n.d(t,"kb",(function(){return de})),n.d(t,"lb",(function(){return pe})),n.d(t,"mb",(function(){return ge})),n.d(t,"nb",(function(){return he})),n.d(t,"ob",(function(){return fe})),n.d(t,"pb",(function(){return me})),n.d(t,"qb",(function(){return be})),n.d(t,"rb",(function(){return _e})),n.d(t,"sb",(function(){return ye})),n.d(t,"tb",(function(){return ve})),n.d(t,"ub",(function(){return Se})),n.d(t,"vb",(function(){return Oe})),n.d(t,"wb",(function(){return Ce})),n.d(t,"F",(function(){return Ee}));var r=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a=new r.a("f93a31b2-99ac-4084-8ec2-d4027c31369a"),i=new r.a("3f4e2a56-f102-4b4d-ab9c-f1574ca5bfda"),o=new r.a("c8bfbbef-6851-4401-a0cc-7450062fe085"),s=new r.a("c72511ab-84e5-4fb7-a543-25b4fc01e83e"),c=new r.a("6636847d-b74d-4994-b55a-a6faf97ecea2"),l=new r.a("9c310a73-a360-42c5-8943-47a06f1b51ea"),u=new r.a("f02ef977-2564-4b9a-b2f0-df083d8a019b"),d=new r.a("62b0df79-0464-470f-8af7-4483cfea0c7d"),p=new r.a("00ad73da-bd4d-49c6-88a8-2f4f4cad4a20"),g=new r.a("b0c6723a-8503-4fd7-bb28-c8a06ac933c2"),h=new r.a("db1284ef-9ffc-4e99-b382-0cc082fe2364"),f=new r.a("3246f906-1f71-45f7-b11f-d7be0f9d04c9"),m=new r.a("821acf1a-7e46-4a0c-965d-fe14a57d78c7"),b=new r.a("4168a05c-d857-46af-8457-5bb47eb04ea1"),_=new r.a("d2561f53-b292-42d9-b222-478e40ffe29f"),y=new r.a("5b773807-9fb2-42db-97c3-7a91eff8adff"),v=new r.a("c3efe0c3-0ec6-42be-8349-cbd9079dfd8e"),S=new r.a("aa987274-ce4e-4271-a803-66164311a958"),O=new r.a("6896f004-b17a-4202-861e-8b7ea2080e0b"),C=new r.a("f9a8a302-114e-466a-b582-6771b2ae0d92"),E=new r.a("1479835f-f852-4679-b864-c6892a2844c9"),I=new r.a("ada2203e-b4cd-49be-9ddf-234642b43b52"),w=new r.a("6f3fb987-393b-4d2d-859f-9d0f0349b6ad"),j=new r.a("f454228d-1d25-4319-e12f-d27968bc0234"),P=new r.a("26e9760f-7454-40de-bb07-f6dcccb82040"),T=new r.a("00000000-0000-0000-0000-000000000000"),N=new r.a("f4c16eca-ca81-4e39-9448-834b8378721e"),A=new r.a("0d2c745a-e5a8-4c8f-ba63-c6d3bb604660"),D=new r.a("fd2a7985-3187-444e-908d-6624b21f69c0"),R=new r.a("fff0e632-9d7b-4f21-bbc1-05d1567ad144"),x=new r.a("e7a81278-8635-4d9e-8d4d-59480b391c5b"),M=new r.a("5546e6cd-394c-4bee-94a8-4425e17ef6c6"),F=new r.a("c6d124ca-7eda-4a60-aea9-7fb8d318b68f"),k=new r.a("a62b6fa9-169e-406c-b1aa-eab828cb6026"),L=new r.a("39354e4a-5015-4d74-8031-ea9eb73a1322"),B=new r.a("671a9387-ca5a-4d1e-8ab7-06e39ddcf6b5"),U=new r.a("dfdf1cde-837b-4ac9-98cf-ac74361fd89d"),V=new r.a("270bd3db-d9af-4782-9025-509e298dec0a"),z=new r.a("b634828e-c390-444a-afe6-e07315d9d970"),W=new r.a("91dc0675-c8b9-4421-b1e0-261cebf02bac"),q=new r.a("533b9e00-756b-4312-95a0-dc888637ac78"),H=new r.a("4aa28ab7-9c13-4f57-a73d-ad894d048b5f"),G=new r.a("76b9e25e-695e-4fef-ac69-f05cfa96739c"),K=new r.a("cbfb742c-14e7-4a17-96bb-1a13f7f64aa2"),Q=new r.a("8c10015a-b339-4982-9474-a95fe05631a5"),X=new r.a("3ef39988-22bb-4f0b-bbbe-64b5a3748aee"),Y=new r.a("2305e33a-bad3-4022-9e15-1856cf218333"),J=new r.a("5d68b988-0661-4db2-bc3e-17598ad3be6c"),$=new r.a("8c54228c-1b25-4909-a12a-f2b968bb0d62"),Z=new r.a("06e9f7af-1f54-4681-8eec-1e21a1ceb465"),ee=new r.a("69af7dca-2e3b-4ee7-9201-0da731dd2413"),te=new r.a("5c5600e0-1d6e-4205-a272-be80da87fd42"),ne=new r.a("67fac785-cd58-4f9f-abb3-4b7ddc6ed5ed"),re=new r.a("02d4264b-47e2-4b4c-aa95-f439f3f4d458"),ae=new r.a("7ccd1494-1f7a-4e3a-8bde-f32069daeb9f"),ie=new r.a("b68b05f0-a46d-43f8-843b-917920af806a"),oe=new r.a("f3015350-44a2-4aa0-97b5-00166532b5e9"),se=new r.a("163b90a6-eb64-49d2-9df8-3c84a4f0a0f8"),ce=new r.a("5f986642-5961-4d9f-ab5e-643d71e231e9"),le=new r.a("a28f441b-916c-4865-87fd-0c5d53bd59c9"),ue=new r.a("f94db24f-263d-44a7-b38e-a35e9854812b"),de=new r.a("e616a57f-20e0-4534-8662-a101b5ddf4e0"),pe=new r.a("86b9e25e-695e-4fef-ac69-f05cfa96739c"),ge=new r.a("ee9078c8-6946-4e2c-b8f8-35e65f4be6a8"),he=new r.a("e0dece4b-6fc8-4a8f-a065-082708572369"),fe=new r.a("4273edbd-ac1d-40d3-9fb2-095c621b552d"),me=new r.a("1e1fc551-f7a8-43af-ac34-a8dc35c7b6d4"),be=new r.a("06375649-c143-495e-a496-c962e5b4488e"),_e=new r.a("9c5ca0a1-ab4d-4781-be7e-8dfbe867b87e"),ye=new r.a("7c624a0b-f59e-493d-9583-638d34759266"),ve=new r.a("71716b6c-711e-476c-8ab8-5d11542bfb47"),Se=new r.a("9fdf5f91-88b1-47f4-ad53-c11efc01a01d"),Oe=new r.a("587cdf98-c1d5-4bde-8473-14a0bc7644a7"),Ce=new r.a("080677db-86ec-4544-ac42-f927e74b491f");function Ee(e){let t="Unknown";if(!e)return t;switch(e.guid.toLowerCase()){case a.guid:t="AccessPrivilege";break;case i.guid:t="AccessTeamEntityPicker";break;case o.guid:t="ACI";break;case s.guid:t="ActivitiesContainer";break;case c.guid:t="ActivitiesWall";break;case l.guid:t="AppliedFilters";break;case u.guid:t="ArticleContent";break;case d.guid:t="BingMap";break;case p.guid:t="Button";break;case g.guid:t="CheckBox";break;case h.guid:t="CompositionLink";break;case f.guid:t="Connection";break;case m.guid:t="ConnectionRoleObjectTypeList";break;case b.guid:t="CoverPagePickList";break;case _.guid:t="Dashboard";break;case y.guid:t="DateTime";break;case v.guid:t="Decimal";break;case S.guid:t="Duration";break;case O.guid:t="DynamicPropertyList";break;case C.guid:t="EditableGrid";break;case E.guid:t="EditFilter";break;case I.guid:t="EmailAddress";break;case w.guid:t="EmailBody";break;case j.guid:t="EmailEngagementActions";break;case P.guid:t="EmailRecipientActivity";break;case T.guid:t="Empty";break;case N.guid:t="ErrorStatus";break;case A.guid:t="Float";break;case D.guid:t="Frame";break;case R.guid:t="GlobalFilter";break;case x.guid:t="Grid";break;case M.guid:t="HiddenInput";break;case F.guid:t="Integer";break;case k.guid:t="KBViewer";break;case L.guid:t="Label";break;case B.guid:t="LanguagePicker";break;case U.guid:t="Link";break;case V.guid:t="Lookup";break;case z.guid:t="MailMergeLanguagePicker";break;case W.guid:t="MapLink";break;case q.guid:t="Money";break;case H.guid:t="MultiSelectPickList";break;case G.guid:t="OrgInsights";break;case K.guid:t="PartyList";break;case Q.guid:t="PhoneNumber";break;case X.guid:t="PickList";break;case Y.guid:t="PickListLookup";break;case J.guid:t="PickListStatus";break;case $.guid:t="PowerBI";break;case Z.guid:t="Process";break;case ee.guid:t="QuickForm";break;case te.guid:t="QuickFormCollection";break;case ne.guid:t="Radio";break;case re.guid:t="ReferencePanelSubGrid";break;case ae.guid:t="ReferencePanelSearchWidget";break;case ie.guid:t="ReferencePanelQuickFormCollection";break;case oe.guid:t="Regarding";break;case se.guid:t="RelatedInformation";break;case ce.guid:t="RelationshipRolePickList";break;case le.guid:t="Report";break;case ue.guid:t="RichEditor";break;case de.guid:t="SearchWidget";break;case pe.guid:t="SocialInsight";break;case ge.guid:t="Streams";break;case he.guid:t="TextArea";break;case fe.guid:t="TextBox";break;case me.guid:t="Ticker";break;case be.guid:t="Timeline";break;case _e.guid:t="Timer";break;case ye.guid:t="TimeZonePickList";break;case ve.guid:t="Url";break;case Se.guid:t="WebResourceHtml";break;case Oe.guid:t="WebResourceImage";break;case Ce.guid:t="WebResourceSilverlight";break;default:t=e.guid}return t}},AFlp:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("SAYH"),a=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="businessProcessFlow.addIdToRecordData";function o(e,t){const n={entities:{[t.etn]:{[r.a.toString(t.id)]:{initialized:a.a.Initialized,businessProcessFlowId:e}}}};return{type:i,payload:n}}},AKum:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"g",(function(){return l}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="dashboardType",a="etc",i="extraqs",o="id",s="pagetype",c="viewType",l="viewid",u="etn"},ATrR:function(e,t,n){"use strict";n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b}));var r=n("odYE"),a=n("SAYH"),i=n("iZ7K"),o=n("LbMF"),s=n("d7fm"),c=n("FZDd");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l=["owner","customer","lookup"];var u=n("VcAV"),d=n("Rckk"),p=n("g22U"),g=n("Er26"),h=n("16wZ");function f(e){return{type:"SERIALIZE_RETRIEVE_REQUEST",execute({dispatch:t,getState:n},a){const o=e.get_target(),s=r.a.fromLegacyEntityReference(o),l=e.get_columnSet().get_Columns(),u=e.get_navigationProperty(),d={[s.etn]:l};if(u)for(const e of u){const t=e.get_relationShipName(),r=Object(i.F)(n(),s.etn,t);if(r){const a=0===Object(i.H)(n(),s.etn,t)?r.ReferencingEntity:r.ReferencedEntity,o=e.get_columnNames();d[a]=o}}return t(Object(c.e)(d)).then(()=>m(n(),s,l,a,u))}}}function m(e,t,n,r,c){const h=Object(i.o)(e,t.etn);let f,m;const b=[],_=[];for(const r of n){const n=Object(o.a)(e,t.etn,r);if(!n){f=`Cannot serialize a request with no attribute metadata for ${t.etn}.${r}`;break}if("partylist"===n.Type){if(m=Object(i.b)(e,t.etn),!m){f=`The relationship for the partylist attribute ${r} is not found in the state tree or is invalid`;break}{const e=Object(s.a)(t.etn,r);if(void 0===e){f="Unknown participation type mask for attribute "+r;break}_.push(e)}}else n&&-1!==l.indexOf(n.Type)?b.push(`_${r}_value`):b.push(r)}if(f)return{serializationFailure:f};let y="";if(_.length){const e=`$filter=Microsoft.Dynamics.CRM.In(PropertyName='participationtypemask',PropertyValues=[${_.map(e=>`'${e}'`)}])`;y=`&$expand=${m.ReferencedEntityNavigationPropertyName}(${e})`}const v=function(e,t,n,r){let a="";const c=[];let d,p;if(r){let n="";for(const a of r){const r=a.get_relationShipName(),g=a.get_columnNames(),h=[],f=Object(i.F)(e,t.etn,r);if(f){const n=0===Object(i.H)(e,t.etn,r)?f.ReferencingEntity:f.ReferencedEntity;for(const t of g){const r=Object(o.a)(e,n,t);if(!r){p=`Cannot serialize a request with no attribute metadata for ${n}.${t}`;break}if("partylist"===r.Type){if(d=Object(i.b)(e,n),!d){p=`The relationship for the partylist attribute ${t} is not found in the state tree or is invalid`;break}{const e=Object(s.a)(n,t);if(void 0===e){p="Unknown participation type mask for attribute "+t;break}c.push(e)}}else r&&-1!==l.indexOf(r.Type)?h.push(`_${t}_value`):h.push(t)}}h&&h.length>0&&(n=Object(u.b)(n)?`${r}($select=${h.join(",")})`:n+","+`${r}($select=${h.join(",")})`)}a="&$expand="+n}if(p&&n){n.TraceManager.getTracer("RetrieveRequestSerializer").error(p)}return a}(e,t,r,c);return{urlParameters:`${h}(${a.a.toString(t.id)})?$select=${b.join(",")}${y}${v}`,additionalHeaders:{[d.c.PREFER]:d.d.ANNOTATIONS,[d.c.ACCEPT]:d.d.APPLICATION_JSON,[d.c.MSCRM_RETURN_NOTIFICATIONS]:"true"},method:"GET",additionalParameters:{[p.a.TYPE]:p.c.RETRIEVE,[p.a.SUB_TYPE]:p.b.Retrieve,[g.b]:t.etn}}}function b(e,t,n,r,o,s,c=!1){const l=Object(i.o)(e,t),f=Object(h.a)(n)?"":`(${a.a.tryParse(n).guid})`,m=o&&"number"==typeof o?",odata.maxpagesize="+o:"";let b=p.c.RETRIEVE,_=p.b.Retrieve;c&&(_=p.b.BinaryDownload),Object(u.b)(f)&&(b=p.c.RETRIEVE_MULTIPLE,_=p.b.ClientAPI);const y={urlParameters:`${l}${f}${r||""}`,additionalHeaders:{[d.c.PREFER]:`${d.d.ANNOTATIONS}${m}`,[d.c.ACCEPT]:d.d.APPLICATION_JSON,[d.c.MSCRM_RETURN_NOTIFICATIONS]:"true"},method:"GET",additionalParameters:{[p.a.TYPE]:b,[p.a.SUB_TYPE]:_,[g.b]:t}};return s&&"object"==typeof s&&Object.assign(y.additionalHeaders,s),y}},AVDU:function(e,t,n){"use strict";n.d(t,"b",(function(){return b})),n.d(t,"f",(function(){return _})),n.d(t,"c",(function(){return y})),n.d(t,"e",(function(){return v})),n.d(t,"d",(function(){return S})),n.d(t,"a",(function(){return O}));var r=n("Lyxw"),a=n("3/02"),i=n("b8TU"),o=n("unFF"),s=n("uZvv"),c=n("Knfm"),l=n("GEbX"),u=n("GYEz"),d=n("w1eR"),p=n("glAs"),g=n("0kGT"),h=n("4leG"),f=n("h4iz"),m=n("504W");function b(e){return!!Object(r.a)(e,a.Qc,a.Lc)||Object(r.c)(e,a.Qc)&&Object(r.c)(e,a.ae)}function _(e){return!v(e)}function y(e){return b(e)&&v(e)&&Object(u.a)(e)!==d.a.MailApp&&!Object(h.c)(e)}function v(e){if(!b(e))return!1;const t=Object(f.a)(e);if(Object(m.a)(t))return!1;if(Object(u.a)(e)===d.a.MailApp)return!0;const n=Object(p.a)(e);return Object(i.d)(e)||n}function S(e){return Object(c.a)(e)===l.a.MultiSession||!Object(g.b)(e)&&b(e)}function O(e){const t=Object(o.a)(e);if(v(e))return"84%";return 1===Object(s.d)(e)?t.sizes.SiteMap.RefreshedWidth:t.sizes.SiteMap.RefreshedWidthCollapsed}},AWUt:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d}));var r=n("84PK"),a=n("504W"),i=n("WRF3"),o=n("VJwX"),s=n("Jz2d"),c=n("RIwK");function l(e){return u(e.get_domParserElement())}function u(e){let t=r.a.get_empty(),n=null,a=null,c=null;for(let i=0,l=e.childNodes.length;i<l;i++){const l=e.childNodes[i];if(l.namespaceURI===s.a.xrm2011ContractsNamespace&&l.firstChild){switch(Object(o.b)(l.nodeName)){case"Id":t=new r.a(l.textContent);break;case"LogicalName":n=l.firstChild.nodeValue;break;case"Name":a=l.firstChild.nodeValue;break;case"RowVersion":c=l.firstChild.nodeValue}}}return n?new i.a(n,t,a,c):i.a.get_empty()}function d(e){let t="<a:Id>"+Object(c.b)(e.Id.toString())+"</a:Id>";return t+="<a:LogicalName>"+Object(c.b)(e.LogicalName)+"</a:LogicalName>",t+=Object(a.a)(e.getValue("RowVersion"))?"":"<a:RowVersion>"+Object(c.b)(e.getValue("RowVersion").toString())+"</a:RowVersion>",Object(a.b)(e.Name)||(t+="<a:Name>"+Object(c.b)(e.Name)+"</a:Name>"),t}},Ae6N:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.UserLocal=1]="UserLocal",e[e.DateOnly=2]="DateOnly",e[e.TimeZoneIndependent=3]="TimeZoneIndependent"}(r||(r={}))},Afz2:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"n",(function(){return s})),n.d(t,"o",(function(){return c})),n.d(t,"q",(function(){return l})),n.d(t,"s",(function(){return u})),n.d(t,"t",(function(){return d})),n.d(t,"u",(function(){return p})),n.d(t,"v",(function(){return g})),n.d(t,"x",(function(){return h})),n.d(t,"j",(function(){return f})),n.d(t,"l",(function(){return m})),n.d(t,"m",(function(){return b})),n.d(t,"w",(function(){return _})),n.d(t,"f",(function(){return y})),n.d(t,"h",(function(){return v})),n.d(t,"i",(function(){return S})),n.d(t,"r",(function(){return O})),n.d(t,"c",(function(){return C})),n.d(t,"g",(function(){return E})),n.d(t,"k",(function(){return I})),n.d(t,"p",(function(){return w}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="alert",a="alertdialog",i="button",o="dialog",s="menuitem",c="menuitemradio",l="option",u="status",d="tab",p="tablist",g="tabpanel",h="treeitem",f="listbox",m="menu",b="menubar",_="tree",y="document",v="group",S="heading",O="presentation",C="banner",E="form",I="main",w="navigation"},ApeL:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return u}));var r=n("dHD5");const a="dataset.row.property.update",i="dataset.row.property.dummy";function o(e,t,n,i){const o=Object(r.v)(t.parentContextToken);return{type:a,payload:{recordId:t.recordId,attributeName:n,requiredLevel:i},meta:{pageId:e,dataSetContextKey:o}}}function s(e,t,n,i){const o=Object(r.v)(t.parentContextToken);return{type:a,payload:{recordId:t.recordId,attributeName:n,isDisabled:i},meta:{pageId:e,dataSetContextKey:o}}}function c(e,t,n,i){const o=Object(r.v)(t.parentContextToken);let s={};return s=i?i.notificationLevel&&"RECOMMENDATION"===i.notificationLevel?null:{[i.uniqueId]:i}:null,{type:a,payload:{recordId:t.recordId,attributeName:n,notifications:s},meta:{pageId:e,dataSetContextKey:o}}}function l(e,t,n,a){const o=Object(r.v)(t.parentContextToken);return{type:i,payload:{recordId:t.recordId,attributeName:n,isVisible:a},meta:{pageId:e,dataSetContextKey:o}}}function u(e,t,n,a){const o=Object(r.v)(t.parentContextToken);return{type:i,payload:{recordId:t.recordId,attributeName:n,precision:a},meta:{pageId:e,dataSetContextKey:o}}}},Axoi:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n("NjDY"),a=n("SAYH"),i=n("qshH"),o=n("5Oca"),s=n("WPtp"),c=n("6QGX"),l=n("16wZ"),u=n("ZIjf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d="ClientApi.XrmOrganizationSettings.";let p;class g{constructor(e){p=e}get languageId(){const e=d+"languageId";try{u.a.instance.reportCall(e);const t=Object(r.x)(p.getState()),n=t&&t.languageCode?t.languageCode:null;return u.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get isAutoSaveEnabled(){const e=d+"isAutoSaveEnabled";try{u.a.instance.reportCall(e);const t=Object(r.x)(p.getState()),n=!!t&&t.isAutoSaveEnabled;return u.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get appointmentRichEditorExperience(){const e=d+"appointmentRichEditorExperience";try{u.a.instance.reportCall(e);const t=Object(r.x)(p.getState()),n=!!t&&t.appointmentRichEditorExperience;return u.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get uniqueName(){const e=d+"uniqueName";try{u.a.instance.reportCall(e);const t=Object(r.x)(p.getState()),n=t&&t.organizationUniqueName?t.organizationUniqueName:null;return u.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get attributes(){const e=d+"attributes";try{u.a.instance.reportCall(e);const t={},n={id:new a.a(this.organizationId),etn:"organization"},r=Object(o.b)(n)(p.getState());if(r&&r.fields)for(const n in r.fields)r.fields[n]?Object(s.i)(r.fields[n])?t[n]=Object(c.g)(r.fields[n]):Object(s.j)(r.fields[n])?t[n]=Object(c.i)(r.fields[n]):Object(s.k)(r.fields[n])?t[n]=Object(c.d)(r.fields[n]):Object(s.g)(r.fields[n])?t[n]=Object(c.j)(r.fields[n]):Object(s.h)(r.fields[n])?t[n]=Object(c.h)(r.fields[n]):Object(l.h)(e,"organization.attribute",r.fields[n]):t[n]=null;return u.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get organizationId(){let e,t,n=d+"organizationId";try{if(u.a.instance.reportCall(n),e=Object(r.y)(p.getState()),e&&e.organizationId){const t=a.a.toString(e.organizationId);return u.a.instance.reportSuccess(n),t}}catch(e){throw i.a.getInstance().reportFailure(n,e),e}e?e.organizationId||(n=d+"state.organizationId",t="OrganizationId is coming as null"):(n=d+"state",t="State is coming as null");const o=new Error(t);throw i.a.getInstance().reportFailure(n,o),o}get organizationTenant(){const e=d+"organizationTenant";try{u.a.instance.reportCall(e);const t=Object(r.z)(p.getState())||null;return u.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get organizationGeo(){const e=d+"organizationGeo";try{u.a.instance.reportCall(e);const t=Object(r.u)(p.getState())||null;return u.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get isSovereignCloud(){const e=d+"isSovereignCloud";try{u.a.instance.reportCall(e);const t=Object(r.q)(p.getState());return u.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get defaultCountryCode(){const e=d+"defaultCountryCode";try{u.a.instance.reportCall(e);const t=Object(r.x)(p.getState()),n=t&&t.defaultCountryCode?t.defaultCountryCode:null;return u.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get useSkypeProtocol(){const e=d+"useSkypeProtocol";try{u.a.instance.reportCall(e);const t=Object(r.x)(p.getState()),n=!(!t||!t.useSkypeProtocol)&&t.useSkypeProtocol;return u.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get baseCurrencyId(){const e=d+"baseCurrencyId";try{u.a.instance.reportCall(e);const t=this.baseCurrency,n=t?t.id:null;return u.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get baseCurrency(){const e=d+"baseCurrency";try{u.a.instance.reportCall(e);const t=Object(r.x)(p.getState());if(t){const n={id:a.a.toString(t.baseCurrencyId),entityType:"transactioncurrency",name:t.transactionCurrencyById[a.a.toString(t.baseCurrencyId)].currencyName};return u.a.instance.reportSuccess(e),n}return i.a.getInstance().reportFailure(e,new Error("Organization Settings are null")),null}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get isYammerConfigured(){const e=d+"isYammerConfigured";try{u.a.instance.reportCall(e);const t=Object(r.x)(p.getState()),n=!!(t&&t.yammerNetworkName&&t.yammerGroupId>=0&&!1===t.yammerOAuthAccessTokenExpired);return u.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}}},"B+9Q":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a={list:[{name:r.Gb,value:!0},{name:r.Hd,value:!0},{name:r.fd,value:!0},{name:r.Fc,value:!0},{name:r.P,value:!0},{name:r.vd,value:!0},{name:r.Rd,value:!0},{name:r.Gd,value:!0},{name:r.he,value:!0},{name:r.q,value:!0},{name:r.r,value:!0},{name:r.y,value:!0},{name:r.Ub,value:!0},{name:r.Qb,value:!0},{name:r.Sb,value:!0},{name:r.Ob,value:!0},{name:r.Tb,value:!0},{name:r.Rb,value:!0},{name:r.Pb,value:!0},{name:r.dc,value:!0},{name:r.V,value:!1},{name:r.J,value:!1},{name:r.t,value:!0},{name:r.Wc,value:!0},{name:r.B,value:!0},{name:r.Zd,value:!0},{name:r.z,value:!0},{name:r.Fd,value:!0},{name:r.Nb,value:!0},{name:r.c,value:!0},{name:r.Z,value:!0},{name:r.me,value:!1},{name:r.pc,value:!0},{name:r.W,value:!0},{name:r.T,value:!0},{name:r.ud,value:!0},{name:r.u,value:!0},{name:r.k,value:!0},{name:r.gb,value:!0},{name:r.fe,value:!0},{name:r.Wd,value:!1},{name:r.Vd,value:!1},{name:r.wd,value:!0},{name:r.cc,value:!0},{name:r.bd,value:!0},{name:r.Sd,value:!1},{name:r.zb,value:!0},{name:r.F,value:!0},{name:r.dd,value:!1},{name:r.Yd,value:!0},{name:r.Eb,value:!0},{name:r.yb,value:!0},{name:r.Ab,value:!0},{name:r.Nd,value:!0},{name:r.gc,value:!1},{name:r.de,value:!0},{name:r.ac,value:!0},{name:r.ub,value:!0},{name:r.ob,value:!0},{name:r.H,value:!0},{name:r.cd,value:!0},{name:r.rd,value:!0},{name:r.xb,value:!0},{name:r.fb,value:!0},{name:r.I,value:!1},{name:r.U,value:!0},{name:r.Rc,value:!1},{name:r.uc,value:!1},{name:r.Cb,value:!1},{name:r.Bb,value:!0},{name:r.l,value:!0},{name:r.tb,value:!0},{name:r.je,value:!0},{name:r.E,value:!0},{name:r.cb,value:!0},{name:r.ab,value:!1},{name:r.bb,value:!0},{name:r.sb,value:!1},{name:r.Lb,value:!1},{name:r.nb,value:!0},{name:r.gd,value:!0},{name:r.ie,value:!1},{name:r.wb,value:!0},{name:r.jb,value:!1},{name:r.le,value:!0},{name:r.Uc,value:!0},{name:r.Ec,value:!0},{name:r.ic,value:!1},{name:r.rc,value:!0},{name:r.R,value:!0},{name:r.Sc,value:!1},{name:r.rb,value:!0},{name:r.j,value:!0},{name:r.i,value:!1},{name:r.o,value:!0},{name:r.X,value:!1},{name:r.Fb,value:!1},{name:r.S,value:!0},{name:r.N,value:!1},{name:r.M,value:!1},{name:r.Vc,value:!0},{name:r.Pd,value:!0},{name:r.Od,value:!0},{name:r.Qd,value:!0},{name:r.Kd,value:!0},{name:r.ke,value:!0},{name:r.x,value:!0},{name:r.Dd,value:!0},{name:r.Zb,value:!0},{name:r.vc,value:!1},{name:r.Kb,value:!0},{name:r.d,value:!0},{name:r.sc,value:!0},{name:r.ge,value:!0},{name:r.Gc,value:!1},{name:r.D,value:!1},{name:r.tc,value:!1},{name:r.yc,value:!1},{name:r.td,value:!0},{name:r.sd,value:!1},{name:r.n,value:!0},{name:r.Hc,value:!0},{name:r.s,value:!0},{name:r.w,value:!1},{name:r.A,value:!1},{name:r.C,value:!0},{name:r.id,value:!0},{name:r.hd,value:!0},{name:r.Qc,value:!0},{name:r.ae,value:!1},{name:r.Ib,value:!1},{name:r.Hb,value:!1},{name:r.Ud,value:!1},{name:r.Xc,value:!0},{name:r.zd,value:!0},{name:r.vb,value:!1},{name:r.v,value:!0},{name:r.Ad,value:!0},{name:r.oc,value:!1},{name:r.Md,value:!0},{name:r.ad,value:!0},{name:r.qd,value:!0},{name:r.pd,value:!1},{name:r.fc,value:!0},{name:r.K,value:!0},{name:r.ee,value:!0},{name:r.hb,value:!0},{name:r.nd,value:!0},{name:r.od,value:!1},{name:r.lb,value:!0},{name:r.Bd,value:!1},{name:r.Ed,value:!1},{name:r.ib,value:!1},{name:r.kb,value:!1},{name:r.eb,value:!1},{name:r.db,value:!1},{name:r.Tc,value:!0},{name:r.e,value:!0},{name:r.Jc,value:!1},{name:r.Oc,value:!1},{name:r.Mb,value:!1},{name:r.Jb,value:!1},{name:r.jc,value:!1},{name:r.lc,value:!1},{name:r.b,value:!0},{name:r.jd,value:!0},{name:r.kd,value:!0},{name:r.ec,value:!0},{name:r.md,value:!0},{name:r.ed,value:!0}]};var i=n("hAdb");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const o="featureControlManager.clientFCBContextRetrieved";function s(e){return{type:"featureControlManager.clientFCBContextRetrieved.sync",sync:!0,execute({getState:t,dispatch:n}){const r={},i={},o=e.get_FCBContext();for(const e in o){const t=o[e],n={featureName:t.get_featureName(),featureControlBitName:t.get_featureControlBitName(),value:t.get_value()};i[t.get_featureControlBitName()]=n,r[t.get_featureName()]=n}const s=a.list;for(const e in s){const t=s[e].name.trim().substring(4);if(o&&!o[t]){const n=s[e],a={featureName:t,featureControlBitName:n.name,value:n.value};i[n.name]=a,r[t]=a}}l(t(),r,i),n(u(r,i))}}}function c(){return{type:"featureControlManager.URLFCBOverrides",sync:!0,execute({getState:e,dispatch:t}){const n={},r={};l(e(),n,r),t(u(n,r))}}}function l(e,t,n){const r=Object(i.a)(e);if(r)for(const e in r){const a=e.trim().substring(4),i={featureName:a,featureControlBitName:e,value:r[e]};n[e]=i,t[a]=i}}function u(e,t){return{type:o,payload:{clientFCBsByFeatureName:e,clientFCBsByFCBName:t}}}},B3HF:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"k",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"l",(function(){return g})),n.d(t,"d",(function(){return h})),n.d(t,"i",(function(){return f})),n.d(t,"m",(function(){return m})),n.d(t,"e",(function(){return b})),n.d(t,"j",(function(){return _}));var r=n("IaGr"),a=n("mpSO");function i(e,t){if(e+=".getEventManager",t.ScriptManager.containerExists(a.d))return t.GlobalCustomEventManager;const n=[];return n.push({name:"ContainerId",value:a.d}),r.a.getInstance().eventManager.ReportComponentFailure(e,new Error("Container does not exist"),null,n),null}function o(e){return{type:"eventManager.addOnBeforeLoad",sync:!0,execute({dispatch:t,getState:n},r){const a=i("ClientApi.addBeforeOnLoad",r);a&&a.addBeforeOnLoad(e)}}}function s(e){return{type:"eventManager.removeOnBeforeLoad",sync:!0,execute:({dispatch:t,getState:n},r)=>{const a=i("ClientApi.removeBeforeOnLoad",r);a&&a.removeBeforeOnLoad(e)}}}function c(e){return{type:"eventManager.addOnOpenURL",sync:!0,execute({dispatch:t,getState:n},r){const a=i("ClientApi.addOnOpenUrl",r);a&&a.addOnOpenUrl(e)}}}function l(e){return{type:"eventManager.removeOnOpenUrl",sync:!0,execute({dispatch:t,getState:n},r){const a=i("ClientApi.removeOnOpenUrl",r);a&&a.removeOnOpenUrl(e)}}}function u(e,t,n){return{type:"eventManager.runPanelOnMessageReceived",sync:!0,execute({dispatch:r,getState:a},o){const s=i("ClientApi.runPanelOnMessageReceived",o);s&&r(s.runPanelOnMessageReceived(e,t,n))}}}function d(e,t){return{type:"eventManager.addPanelOnMessageReceived",sync:!0,execute({dispatch:n,getState:r},a){const o=i("ClientApi.addPanelOnMessageReceived",a);o&&o.addPanelOnMessageReceived(e,t)}}}function p(e,t){return{type:"eventManager.removePanelOnMessageReceived",sync:!0,execute({dispatch:n,getState:r},a){const o=i("ClientApi.removePanelOnMessageReceived",a);o&&o.removePanelOnMessageReceived(e,t)}}}function g(e,t){return{type:"eventManager.runPanelOnSizeChange",sync:!0,execute({dispatch:n,getState:r},a){const o=i("ClientApi.runPanelOnSizeChange",a);o&&n(o.runPanelOnSizeChange(e,t))}}}function h(e,t){return{type:"eventManager.addPanelOnSizeChange",sync:!0,execute({dispatch:n,getState:r},a){const o=i("ClientApi.addPanelOnSizeChange",a);o&&o.addPanelOnSizeChange(e,t)}}}function f(e,t){return{type:"eventManager.removePanelOnSizeChange",sync:!0,execute({dispatch:n,getState:r},a){const o=i("ClientApi.removePanelOnSizeChange",a);o&&o.removePanelOnSizeChange(e,t)}}}function m(e,t){return{type:"eventManager.runPanelOnStateChange",sync:!0,execute({dispatch:n,getState:r},a){const o=i("ClientApi.runPanelOnStateChange",a);o&&n(o.runPanelOnStateChange(e,t))}}}function b(e,t){return{type:"eventManager.addPanelOnStateChange",sync:!0,execute({dispatch:n,getState:r},a){const o=i("ClientApi.addPanelOnStateChange",a);o&&o.addPanelOnStateChange(e,t)}}}function _(e,t){return{type:"eventManager.removePanelOnStateChange",sync:!0,execute({dispatch:n,getState:r},a){const o=i("ClientApi.removePanelOnStateChange",a);o&&o.removePanelOnStateChange(e,t)}}}},BDhr:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return e&&e.metadata&&e.metadata.metadataVersion?e.metadata.metadataVersion:null}function i(e){const t=a(e);return t?t.initialized:r.a.Uninitialized}},BFlg:function(e,t,n){"use strict";n.d(t,"u",(function(){return r})),n.d(t,"C",(function(){return a})),n.d(t,"o",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"m",(function(){return s})),n.d(t,"q",(function(){return c})),n.d(t,"B",(function(){return l})),n.d(t,"p",(function(){return u})),n.d(t,"l",(function(){return d})),n.d(t,"n",(function(){return p})),n.d(t,"e",(function(){return g})),n.d(t,"k",(function(){return h})),n.d(t,"t",(function(){return f})),n.d(t,"j",(function(){return m})),n.d(t,"i",(function(){return b})),n.d(t,"r",(function(){return _})),n.d(t,"s",(function(){return y})),n.d(t,"c",(function(){return v})),n.d(t,"D",(function(){return S})),n.d(t,"f",(function(){return O})),n.d(t,"g",(function(){return C})),n.d(t,"x",(function(){return E})),n.d(t,"z",(function(){return I})),n.d(t,"y",(function(){return w})),n.d(t,"v",(function(){return j})),n.d(t,"w",(function(){return P})),n.d(t,"a",(function(){return T})),n.d(t,"b",(function(){return N})),n.d(t,"A",(function(){return A})),n.d(t,"h",(function(){return D})),n.d(t,"F",(function(){return R})),n.d(t,"E",(function(){return x})),n.d(t,"G",(function(){return M}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="TargetEntityType",a="ViewId",i="homepageGrid",o="MscrmControls.Chart.ChartControl",s="MscrmControls.Grid.GridControl",c="RecordsPerPage",l="ViewIds",u="MscrmControls.Grid.ReadOnlyGrid",d="fetchXML",p="GridFilterType",g="DataSetContextKey",h="entityLogicalName",f="subgrid",m="EnableViewPicker",b="EnableItemContextualActions",_="RelationshipName",y="RelationshipRoleOrdinal",v="AvailableOnPhone",S="ViewSelector",O="DataSetUIOptions",C="Grid",E="Grid",I="Grid",w="SubGrid",j="AssociatedGrid",P="ExpressionBuilder",T="activitypointer",N="activitytypecode",A="transactioncurrencyidforcurrencyfield",D={GRID:"grid",SUBGRID:"subgrid",ASSOCIATEDGRID:"associatedgrid",CUSTOM:"custom"},R={ENABLE_VIEW_PICKER:m,ENABLE_CONTEXTUALACTIONS:"EnableContextualActions",ENABLE_JUMPBAR:"EnableJumpBar",ENABLE_QUICKFIND:"EnableQuickFind",ENABLE_QUEUEFILTER:"EnableQueueFilter",ENABLE_CHART_PICKER:"EnableChartPicker",RELATIONSHIP_NAME:_,AVAILABLE_ON_PHONE:v,TARGET_ENTITY_TYPE:r},x={CHART_ENABLED:"displayChart",COMMANDBAR_ENABLED:"displayCommandBar",VIEWSELECTOR_ENABLED:"displayViewSelector",JUMPBAR_ENABLED:"displayIndex",QUICKFIND_ENABLED:"displayQuickFind",PAGING_ENABLED:"displayPaging"};function M(e,t){return E+"."+e+"."+t}},BHck:function(e,t,n){"use strict";function r(e){return e&&e.metadata&&e.metadata.landingPageOfflineMetadata&&e.metadata.landingPageOfflineMetadata.offlineAppDescriptors?e.metadata.landingPageOfflineMetadata.offlineAppDescriptors:null}function a(e){return e&&e.metadata&&e.metadata.landingPageOfflineMetadata?e.metadata.landingPageOfflineMetadata:null}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},BJ7u:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){switch(e){case-1:return"None";case 0:return"AppointmentBook";case 1:return"Hardcoded";case 2:return"Main";case 3:return"MiniCampaignBO";case 4:return"Preview";case 5:return"Dashboard";case 6:return"Quick";case 7:return"Mobile";case 8:return"Read";case 9:return"QuickCreate";case 10:return"Dialog";case 11:return"Card";case 12:return"TaskBasedForm";case 13:return"InteractionCentricDashboard"}}n.d(t,"a",(function(){return r}))},BM7Q:function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"i",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"e",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Web.NavBar.Preview_Watermark_Caption",a="Brand_China_Mooncake_English",i="Web.NavBar.Sandbox_Watermark_Caption",o="Navigation_Area_Tooltip",s="ResourceCenter_Area_ToolTip",c="Web.NavBar.BreadCrumbBar_Text",l="Change_App_ToolTip",u="App_Modules_SubArea_Title",d=[r,i,o,s,c,l,u]},BMZr:function(e,t,n){"use strict";n.d(t,"b",(function(){return S})),n.d(t,"a",(function(){return C}));var r=n("SAYH"),a=n("EBJu"),i=n("ruPX");var o=n("zu1I"),s=n("FZDd"),c=n("N6mg"),l=n("GYEz"),u=n("w1eR"),d=n("cfbi"),p=n("Lyxw"),g=n("3/02"),h=n("A09F"),f=n("i1f0"),m=n("YxC/"),b=n("1fn7"),_=n("nzu+"),y=n("E8F2"),v=n("xHmU");function S(e,t,n,p,g,m,b){const _=[{name:"entityTypeName",value:e}];return null!=g&&r.a.isNullOrEmpty(g.id)&&_.push({name:"createFromEntityID",value:g.id.guid}),{type:"form.openCreateFormDialog.async",execute({dispatch:y,getState:v},S,C){let E=v();return y(Object(c.a)()).then(c=>{let I;if(c&&c.quickCreateMenuItems)for(const t in c.quickCreateMenuItems)if(t===e){I=y(Object(s.f)(e,!1,[]));break}const w=()=>{E=v();const s=b?b.relationship:null,c=b?r.a.tryParseOrNull(b.formId):null,I=Object(f.I)(E,e);return I===h.a.QuickCreateForm?(_.push({name:"createType",value:"QuickCreate"}),g&&(_.push({name:"createFromEntity",value:g.etn}),b&&b.isCrossEntityNavigate&&(p&&p.processId&&(p.processId=r.a.EMPTY.guid),p&&p.processInstanceId&&(p.processInstanceId=null))),function(e,t,n,r,s,c,l,u,d,p,g){return O(e,t,!1,c).then(h=>{if(0===h.status){const h=function(e,t,n,r,a,i,s){const c=Object(o.a)(null,e,n,r,t);return c.createFromEntity=a,c.createFromRelationship=i,c.formId=s,c}(t,s,l,u,d,p,g);return e(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){return Object(i.a)(a.a,e,t)}(h,c)).then(e=>{const t=[{name:"CorrelationId",value:r.correlationId},{name:"ContextId",value:r.contextId},{name:"ActionStack",value:r.stack},{name:"entityTypeName",value:s}];return n.EventManager.ReportComponentSuccess("Forms.openCreateFormDialog._openQuickCreate",t),e})}return Promise.resolve(h)})}(y,E,S,C,e,t,n,p,g,s,c)):I===h.a.MainFormDialog?(_.push({name:"createType",value:"MainFormDialog"}),function(e,t,n,r,a,o,s,c,l,u,p){return O(e,t,!0,o).then(t=>{if(0===t.status){const t={entityTypeName:a,data:c,formId:p,initWithEntity:l,dialogOptions:s},u={target:"dialog"};return e(Object(i.a)(d.a,t,o,u)).then(e=>{const t=[{name:"CorrelationId",value:r.correlationId},{name:"ContextId",value:r.contextId},{name:"ActionStack",value:r.stack},{name:"openInNewWindow",value:!1},{name:"entityTypeName",value:a}];return n.EventManager.ReportComponentSuccess("Forms.openCreateFormDialog._openMainFormDialog",t),e})}return Promise.resolve(t)})}(y,E,S,C,e,t,n,p,g,0,c)):(_.push({name:"createType",value:"EditForm"}),function(e,t,n,r,a,o,s,c,p,g,h){const f=s,m={entityTypeName:a,id:null,data:f&&0!==Object.keys(f).length?f:null,initWithEntity:c,createFromRelationship:p},b=Object(l.a)(t);if(g||h&&b!==u.a.MobileApplication){const t=e(Object(i.c)("EditForm",m,g)),o=[{name:"CorrelationId",value:r.correlationId},{name:"ContextId",value:r.contextId},{name:"ActionStack",value:r.stack},{name:"target",value:JSON.stringify(g)},{name:"clientHost",value:JSON.stringify(b)},{name:"openInNewWindow",value:h},{name:"entityTypeName",value:a}];return n.EventManager.ReportComponentSuccess("Forms.openCreateFormDialog._openEditForm",o),Promise.resolve(t)}return function(e,t,n,r,a,o,s,c,l,u){return e(Object(i.a)(a,o,l)).then(e=>{const t=[{name:"CorrelationId",value:r.correlationId},{name:"ContextId",value:r.contextId},{name:"ActionStack",value:r.stack},{name:"target",value:JSON.stringify(u)},{name:"openInNewWindow",value:!1},{name:"clientHost",value:JSON.stringify(s)},{name:"entityTypeName",value:c}];return n.EventManager.ReportComponentSuccess(a===d.a?"Forms.openCreateFormDialog._openEditForm":"Forms.openCreateFormDialog._openMainFormDialog",t),e})}(e,0,n,r,d.a,m,b,a,o,g)}(y,E,S,C,e,t,p,g,s,m,n?n.openInNewWindow:void 0))};return I?(_.push({name:"isPromiseValid",value:!0}),I.then(w)):(_.push({name:"isPromiseValid",value:!1}),w())})},getFailureParameters:(e,t)=>_}}function O(e,t,n,r){const a=Object(v.a)(t),i=a?a.filter(e=>n?Object(f.Ib)(t,e):Object(f.Kb)(t,e)):[];if(n&&i.length>=3||!n&&i.length>=10){const n=Object(m.b)(t,b.g),a=Object(m.b)(t,b.f);return e(Object(_.a)({title:n,text:a},{height:210},r)).then(e=>({status:1,error:Object(y.b)(t,r,2147946838,a)}))}return Promise.resolve({status:0})}function C(e){return Object(p.c)(e,g.pc)&&Object(p.c)(e,g.h)}},BR3n:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="InteractionCentricNavBar_QuickCreate_Activities",a=[r,"Web.NavBar.Back_Caption"]},BSGX:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("OwbH");class a extends r.a{constructor(e,t){super([e]),this._target=null,this._target=t}get_fieldValue(){return this._target}testCondition(e){return e===this.get_fieldValue()}}},BSqk:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("ufH1"),a=n("umme"),i=n("504W"),o=n("2mBq"),s=n("Div0");class c{constructor(){this._promiseCache={}}get_values(){const e=new Array(0),t=this._promiseCache;for(const n in t){const r={key:n,value:t[n]};e.push(r.value)}return e}put(e,t,n){const l="Operation timed out. Cache name : "+t.getCacheName(),u="Operation timed out. Key = "+e+"; ContextString = "+t.getContextString(),d=window.setTimeout(()=>{Object(r.e)("PromiseCache_Put_promiseCacheObject_Always",s.a.storage,Object(o.a)("Get cache object with key={0} timed out. promiseCacheObject.ContextString is={1}",e,t.getContextString()));const c=a.a.FromMessage(l);Object(i.a)(n)||Object(i.a)(n.get_Stack())||c.set_Stack(n.get_Stack()),c.set_InnerError(a.a.FromMessage(u)),t.getPromise().reject(c)},c._PromiseTimeout);this._promiseCache[e]=t,t.getPromise().always(()=>{const t=this.get(e);Object(i.a)(t)?Object(r.c)("PromiseCache_Put_promiseCacheObject_Always",s.a.storage,Object(o.a)("Get cache object with key={0}, value is undefined.",e)):delete this._promiseCache[e],window.clearTimeout(d)})}get(e){return this._promiseCache[e]}containsKey(e){return e in this._promiseCache}}c._PromiseTimeout=3e5},BfRu:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="add.pageNotificationAction";function a(e,t){return{type:"add.pageNotificationAction.async",execute({dispatch:n}){const a={type:r,payload:e,meta:{pageId:t}};return Promise.resolve(n(a))}}}},BgaZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("wRZP"),a=n("EY5k"),i=n("YxC/"),o=n("tICD"),s=n("pgSX"),c=n("si7p");let l=!1;function u(e){const t=["AppModule.AccessDenied_Title","AppModule.AccessDenied_Message"];return e.dispatch(Object(a.e)(t)).then(()=>{if(l)return{status:0};l=!0;const n=Object(i.e)(e.getState(),t),a=Object(i.c)(n,"AppModule.AccessDenied_Message"),u=Object(i.c)(n,"AppModule.AccessDenied_Title");return e.dispatch(Object(s.a)(c.a,a,{height:"16rem",width:"40rem",type:"error"},"",u)).then(t=>0===t.status?e.dispatch(Object(o.a)(t.pageId)).then(()=>(l=!1,e.dispatch(Object(r.a)()))):(l=!1,t)).catch(e=>(l=!1,Promise.reject(e)))})}},BlGn:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("RIJJ"),a=n("ruPX");function i(e,t,n,i){const o=[{name:"url",value:e}];return{type:"form.openLegacyDialog",execute:({dispatch:o,getState:s})=>o(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,n,i){const o={url:e,dialogOptions:t,dialogArguments:n};return Object(a.a)(r.a,o,i)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,t,n,i)),getFailureParameters:(e,t)=>o}}},Bo7t:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="form.tab.select";function i(e,t,n){const i=Object(r.v)(t);return{type:a,payload:n,meta:{pageId:e,contextKey:i}}}},BoVI:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"h",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return u}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="form.registerFormInstance",a="form.unregisterFormInstance",i="control.views.addCustomView",o="control.views.setOfflineQuery",s="form.update.bound.record",c="form.registerParentComponentId",l="control.initializationIntent",u="form.setFormScrollAndFocusState"},Brg7:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("69Qu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a={};function i(e){return{type:"loadimages.async",execute({getState:t},n){const i=n.TraceManager.getTracer("loadimages");if(Object(r.a)(t())){const n=(e(t(),i)||[]).map((function(e){const t=a[e.iconPath];if(t)return t;const n=new Promise((t,n)=>{const r=new Image;r.onload=t,r.onerror=n,r.src=e.iconPath});return n.then(t=>{a[e.iconPath]=n},t=>{i.error("Cannot load image with path "+e.iconPath+" for "+e.type+" "+e.id,[{name:"reason",value:t}])})}));return Promise.all(n)}return i.info("Cannot load images in offline"),Promise.resolve()}}}},BvQu:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Dirty=0]="Dirty",e[e.Always=1]="Always",e[e.Never=2]="Never"}(r||(r={}))},BzGi:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.savedvisualization=0]="savedvisualization",e[e.uservisualization=1]="uservisualization"}(r||(r={}))},BzKn:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var r=n("zVFX"),a=n("ybOb"),i=n("NjDY"),o=n("SocB"),s=n("GYEz"),c=n("w1eR"),l=n("GWSs"),u=n("CXmn");const d="theme.initialize";function p(e){const t=Object(s.a)(e),n=r.a,p=Object(i.d)(e),m=Object(u.b)(e);if(""!==p){const t=Object(a.a)(p);t&&(n.colors.Link.Normal.Text=g(t.globallinkcolor,n.colors.Link.Normal.Text),n.colors.Link.Visited.Text=g(t.selectedlinkeffect,n.colors.Link.Visited.Text),n.colors.Link.Hover.Text=g(t.hoverlinkeffect,n.colors.Link.Hover.Text),n.colors.Title.Text=g(t.headercolor,n.colors.Title.Text),n.colors.ProcessControl=g(t.processcontrolcolor,n.colors.ProcessControl),n.colors.SiteMap.GroupText=f(t.maincolor,n.colors.SiteMap.GroupText,n.colors.SiteMap.Default,n.colors.BaseColor.White),n.colors.SiteMap.AppLauncherBorder=f(t.maincolor,n.colors.SiteMap.AppLauncherBorder,n.colors.SiteMap.Default,n.colors.BaseColor.White),n.colors.SiteMap.AreaItemBorder=f(t.maincolor,n.colors.SiteMap.AreaItemBorder,n.colors.SiteMap.Default,n.colors.BaseColor.White),n.colors.QuickLaunchBarButtonBorderColor=f(t.maincolor,n.colors.QuickLaunchBarButtonBorderColor,n.colors.QuickLaunchBar,n.colors.BaseColor.White),n.colors.SiteMap.NavigationShelf=h(t.navbarshelfcolor,n.colors.SiteMap.NavigationShelf),n.colors.Entity=h(t.defaultentitycolor,n.colors.Entity),n.colors.CustomEntity=h(t.defaultcustomentitycolor,n.colors.CustomEntity),n.colors.PageHeader=h(t.pageheaderbackgroundcolor,n.colors.PageHeader),n.colors.PagePanel=h(t.panelheaderbackgroundcolor,n.colors.PagePanel),n.colors.Control=(C=t.controlshade,E=t.controlborder,I=n.colors.Control,{Fill:C||I.Fill,Text:C?Object(o.e)(C):I.Text,Stroke:E||I.Stroke}),n.colors.MainThemeColor=(S=t.maincolor,O=n.colors.MainThemeColor,S?{MainColor1:Object(o.f)(S),MainColor2:Object(o.g)(S,o.c),MainColor3:Object(o.h)(S)}:O),n.colors.AccentThemeColor=(y=t.accentcolor,v=n.colors.AccentThemeColor,y?{Accent1:Object(o.f)(y),Accent2:Object(o.g)(y,o.a),Accent3:Object(o.h)(y)}:v),Object(l.h)(e)&&"#000000"===t.navbarbackgroundcolor||(n.colors.NavBar=(b=t.navbarbackgroundcolor,_=n.colors.NavBar,b?{NavBar1:Object(o.f)(b),NavBar2:Object(o.g)(b,o.c),NavBar3:Object(o.h)(b)}:_)),n.buttons.Button01Primary.backgroundColor=n.colors.MainThemeColor.MainColor1.Fill,n.buttons.Button01Primary.color=n.colors.MainThemeColor.MainColor1.Text,n.buttons.Button01Primary["> span"].color=n.colors.MainThemeColor.MainColor1.Text,n.buttons.Button01Primary[":hover"].color=n.colors.MainThemeColor.MainColor3.Text,n.buttons.Button01Primary[":hover"].backgroundColor=n.colors.MainThemeColor.MainColor3.Fill,n.buttons.Button01Primary[":active"].color=n.colors.MainThemeColor.MainColor3.Text,n.buttons.Button01Primary[":active"].backgroundColor=n.colors.MainThemeColor.MainColor3.Fill,n.buttons.Button01Primary[":active"].outline="1px solid "+n.colors.MainThemeColor.MainColor3.Fill,n.buttons.Button01Secondary.border="1px solid "+n.colors.MainThemeColor.MainColor1.Fill,n.buttons.Button01Secondary.backgroundColor=n.colors.BaseColor.White,n.buttons.Button01Secondary["> span"].color=n.colors.MainThemeColor.MainColor1.Fill,n.buttons.Button01Secondary[":hover"]["> span"].color=n.colors.MainThemeColor.MainColor3.Text,n.buttons.Button01Secondary[":hover"].backgroundColor=n.colors.MainThemeColor.MainColor3.Fill,n.buttons.Button01Secondary[":active"]["> span"].color=n.colors.MainThemeColor.MainColor3.Text,n.buttons.Button01Secondary[":active"].backgroundColor=n.colors.MainThemeColor.MainColor3.Fill,n.buttons.Button01Secondary[":active"].outline="1px solid "+n.colors.MainThemeColor.MainColor3.Fill,n.buttons.Button02Primary.backgroundColor=n.colors.MainThemeColor.MainColor1.Fill,n.buttons.Button02Primary.color=n.colors.MainThemeColor.MainColor1.Text,n.buttons.Button02Primary[":hover"].color=n.colors.MainThemeColor.MainColor3.Text,n.buttons.Button02Primary[":hover"].backgroundColor=n.colors.MainThemeColor.MainColor3.Fill,n.buttons.Button02Primary[":active"].color=n.colors.MainThemeColor.MainColor3.Text,n.buttons.Button02Primary[":active"].backgroundColor=n.colors.MainThemeColor.MainColor3.Fill,n.buttons.Button02Primary[":active"].outline="1px solid "+n.colors.MainThemeColor.MainColor3.Fill,n.buttons.Button02Secondary.border="1px solid "+n.colors.MainThemeColor.MainColor1.Fill,n.buttons.Button02Secondary.backgroundColor=n.colors.BaseColor.White,n.buttons.Button02Secondary["> span"].color=n.colors.MainThemeColor.MainColor1.Fill,n.buttons.Button02Secondary[":hover"]["> span"].color=n.colors.MainThemeColor.MainColor3.Text,n.buttons.Button02Secondary[":hover"].backgroundColor=n.colors.MainThemeColor.MainColor3.Fill,n.buttons.Button02Secondary[":active"]["> span"].color=n.colors.MainThemeColor.MainColor3.Text,n.buttons.Button02Secondary[":active"].backgroundColor=n.colors.MainThemeColor.MainColor3.Fill,n.buttons.Button02Secondary[":active"].outline="1px solid "+n.colors.MainThemeColor.MainColor3.Fill)}var b,_,y,v,S,O,C,E,I;return t===c.a.MailApp&&(n.colors.NavBar.NavBar1.Fill=n.colors.BaseColor.Blue.Blue3,n.colors.NavBar.NavBar1.Text=n.colors.BaseColor.White,n.colors.NavBar.NavBar2.Fill="#c2c2c2",n.colors.SiteMap.AppLauncherBar=n.colors.BaseColor.Grey.Grey1,n.colors.SiteMap.AppLauncherBorder=n.colors.BaseColor.Blue.Blue6,n.colors.SiteMap.AppLauncherText=n.colors.BaseColor.Grey.Grey7,n.colors.SiteMap.GroupText=n.colors.BaseColor.Blue.Blue3,n.colors.SiteMap.Default=n.colors.BaseColor.White,n.colors.QuickLaunchBarIcon=n.colors.BaseColor.Grey.Grey7,n.colors.QuickLaunchBarHover=n.colors.BaseColor.Grey.Grey3,n.colors.EntityLabel=n.colors.BaseColor.Grey.Grey7,n.colors.EntityIcon=n.colors.BaseColor.Grey.Grey7,n.colors.SiteMap.AreaBar=n.colors.BaseColor.Grey.Grey1,n.colors.SiteMap.AreaBarItemActive=n.colors.BaseColor.Grey.Grey3,n.colors.SiteMap.AreaBarItemIcon=n.colors.BaseColor.Grey.Grey7,n.colors.SiteMap.AreaBarItemText=n.colors.BaseColor.Grey.Grey7,n.colors.SiteMap.AreaItemBorder=n.colors.BaseColor.Blue.Blue6,n.colors.SiteMap.NavigationBarMobileActive.Text=n.colors.BaseColor.White,n.colors.SiteMap.NavigationBarMobile.Text=n.colors.BaseColor.White),m&&(n.colors.NavBar.NavBar1.Fill="#f3f2f1",n.colors.NavBar.NavBar1.Text=n.colors.BaseColor.Black,n.colors.NavBar.NavBar2.Fill=n.colors.BaseColor.White,n.colors.NavBar.NavBar2.Text=n.colors.BaseColor.Black,n.colors.NavBar.NavBar3.Fill="#d8d8d8",n.colors.NavBar.NavBar3.Text=n.colors.BaseColor.Black),{type:d,payload:n}}function g(e,t){return e||t}function h(e,t){return e?{Fill:e,Text:Object(o.e)(e)}:t}function f(e,t,n,r){return e?Object(o.j)(e,r,n):t}},C78e:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("2gMP"),a=n("ruPX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t){const n={dialogOptions:e,welcomePageName:t};return Object(a.a)(r.a,n,void 0)}},CB5L:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r,a,i,o,s,c,l,u,d;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),function(e){e[e.Equal=0]="Equal",e[e.NotEqual=1]="NotEqual",e[e.GreaterThan=2]="GreaterThan",e[e.LessThan=3]="LessThan",e[e.GreaterEqual=4]="GreaterEqual",e[e.LessEqual=5]="LessEqual",e[e.Like=6]="Like",e[e.NotLike=7]="NotLike",e[e.In=8]="In",e[e.NotIn=9]="NotIn",e[e.Between=10]="Between",e[e.NotBetween=11]="NotBetween",e[e.Null=12]="Null",e[e.NotNull=13]="NotNull",e[e.Yesterday=14]="Yesterday",e[e.Today=15]="Today",e[e.Tomorrow=16]="Tomorrow",e[e.Last7Days=17]="Last7Days",e[e.Next7Days=18]="Next7Days",e[e.LastWeek=19]="LastWeek",e[e.ThisWeek=20]="ThisWeek",e[e.NextWeek=21]="NextWeek",e[e.LastMonth=22]="LastMonth",e[e.ThisMonth=23]="ThisMonth",e[e.NextMonth=24]="NextMonth",e[e.On=25]="On",e[e.OnOrBefore=26]="OnOrBefore",e[e.OnOrAfter=27]="OnOrAfter",e[e.LastYear=28]="LastYear",e[e.ThisYear=29]="ThisYear",e[e.NextYear=30]="NextYear",e[e.LastXHours=31]="LastXHours",e[e.NextXHours=32]="NextXHours",e[e.LastXDays=33]="LastXDays",e[e.NextXDays=34]="NextXDays",e[e.LastXWeeks=35]="LastXWeeks",e[e.NextXWeeks=36]="NextXWeeks",e[e.LastXMonths=37]="LastXMonths",e[e.NextXMonths=38]="NextXMonths",e[e.LastXYears=39]="LastXYears",e[e.NextXYears=40]="NextXYears",e[e.EqualUserId=41]="EqualUserId",e[e.NotEqualUserId=42]="NotEqualUserId",e[e.EqualBusinessId=43]="EqualBusinessId",e[e.NotEqualBusinessId=44]="NotEqualBusinessId",e[e.ChildOf=45]="ChildOf",e[e.Mask=46]="Mask",e[e.NotMask=47]="NotMask",e[e.MasksSelect=48]="MasksSelect",e[e.Contains=49]="Contains",e[e.DoesNotContain=50]="DoesNotContain",e[e.EqualUserLanguage=51]="EqualUserLanguage",e[e.NotOn=52]="NotOn",e[e.OlderThanXMonths=53]="OlderThanXMonths",e[e.BeginsWith=54]="BeginsWith",e[e.DoesNotBeginWith=55]="DoesNotBeginWith",e[e.EndsWith=56]="EndsWith",e[e.DoesNotEndWith=57]="DoesNotEndWith",e[e.ThisFiscalYear=58]="ThisFiscalYear",e[e.ThisFiscalPeriod=59]="ThisFiscalPeriod",e[e.NextFiscalYear=60]="NextFiscalYear",e[e.NextFiscalPeriod=61]="NextFiscalPeriod",e[e.LastFiscalYear=62]="LastFiscalYear",e[e.LastFiscalPeriod=63]="LastFiscalPeriod",e[e.LastXFiscalYears=64]="LastXFiscalYears",e[e.LastXFiscalPeriods=65]="LastXFiscalPeriods",e[e.NextXFiscalYears=66]="NextXFiscalYears",e[e.NextXFiscalPeriods=67]="NextXFiscalPeriods",e[e.InFiscalYear=68]="InFiscalYear",e[e.InFiscalPeriod=69]="InFiscalPeriod",e[e.InFiscalPeriodAndYear=70]="InFiscalPeriodAndYear",e[e.InOrBeforeFiscalPeriodAndYear=71]="InOrBeforeFiscalPeriodAndYear",e[e.InOrAfterFiscalPeriodAndYear=72]="InOrAfterFiscalPeriodAndYear",e[e.EqualUserTeams=73]="EqualUserTeams",e[e.EqualUserOrUserTeams=74]="EqualUserOrUserTeams",e[e.Under=75]="Under",e[e.NotUnder=76]="NotUnder",e[e.UnderOrEqual=77]="UnderOrEqual",e[e.Above=78]="Above",e[e.AboveOrEqual=79]="AboveOrEqual",e[e.EqualUserOrUserHierarchy=80]="EqualUserOrUserHierarchy",e[e.EqualUserOrUserHierarchyAndTeams=81]="EqualUserOrUserHierarchyAndTeams",e[e.OlderThanXYears=82]="OlderThanXYears",e[e.OlderThanXWeeks=83]="OlderThanXWeeks",e[e.OlderThanXDays=84]="OlderThanXDays",e[e.OlderThanXHours=85]="OlderThanXHours",e[e.OlderThanXMinutes=86]="OlderThanXMinutes"}(r||(r={})),function(e){e[e.Unknown=0]="Unknown",e[e.OnDemandWithContext=1]="OnDemandWithContext",e[e.OnDemandWithoutContext=2]="OnDemandWithoutContext",e[e.OnDemandContextOnly=3]="OnDemandContextOnly",e[e.Offline=4]="Offline",e[e.Mobile=5]="Mobile",e[e.UserContext=6]="UserContext"}(a||(a={})),function(e){e[e.Inner=0]="Inner",e[e.LeftOuter=1]="LeftOuter",e[e.Natural=2]="Natural",e[e.MatchFirstRowUsingCrossApply=3]="MatchFirstRowUsingCrossApply",e[e.In=4]="In",e[e.Exists=5]="Exists"}(i||(i={})),function(e){e[e.And=0]="And",e[e.Or=1]="Or",e[e.Not=2]="Not"}(o||(o={})),function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending"}(s||(s={})),function(e){e[e.All=0]="All",e[e.ValidForCreate=1]="ValidForCreate",e[e.ValidForUpdate=2]="ValidForUpdate",e[e.ValidForRead=3]="ValidForRead"}(c||(c={})),function(e){e[e.None=0]="None",e[e.Related=1]="Related",e[e.Extended=2]="Extended"}(l||(l={})),function(e){e[e.None=0]="None",e[e.SingleQuotesURL=1]="SingleQuotesURL",e[e.DoubleQuotesURL=2]="DoubleQuotesURL",e[e.NoQuotesURL=3]="NoQuotesURL",e[e.Contract=4]="Contract",e[e.JsonifyURL=5]="JsonifyURL"}(u||(u={})),function(e){e[e.NewData=1]="NewData",e[e.ExistingData=2]="ExistingData"}(d||(d={}))},CEpr:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.DeviceDefault=0]="DeviceDefault",e[e.Res640x480=1]="Res640x480",e[e.Res1024x768=2]="Res1024x768",e[e.Res1600x1200=3]="Res1600x1200",e[e.Res2048x1536=4]="Res2048x1536",e[e.Res2592x1936=5]="Res2592x1936"}(r||(r={}))},CGM5:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r,a=n("nuS9"),i=n("eb03"),o=n("QA8j"),s=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=!!window.navigator.userAgent.match("MSIE")||!!window.navigator.userAgent.match("Trident"),l=!!window.navigator.userAgent.match("Edge"),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.getElementName=function(){return"div"},t.prototype.getElementProps=function(){return null},t.prototype.refCallbackTrigger=function(e){this.props.refCallback(e)},t.prototype.hasAriaProperty=function(){return!!(this.props.accessibilityLabel||this.props.accessibilityChecked||this.props.accessibilityLive||this.props.accessibilityRelevant||this.props.accessibilityAtomic||this.props.labelledByElementId||this.props.describedByElementId||this.props.controlsElementId||this.props.ownsElementId||this.props.accessibilityRequired||"boolean"==typeof this.props.accessibilityExpanded||"boolean"==typeof this.props.accessibilityHasPopup||"string"==typeof this.props.accessibilityHasPopup||"boolean"==typeof this.props.accessibilityPressed||"string"==typeof this.props.accessibilityPressed||"boolean"==typeof this.props.accessibilityReadOnly||"boolean"==typeof this.props.accessibilityDisabled||"number"==typeof this.props.accessibilityLevel||"boolean"==typeof this.props.accessibilityHidden||"boolean"==typeof this.props.isSelected||this.props.activeDescendantId||this.props.accessibilityCurrent||"number"==typeof this.props.accessibilityValueMin||"number"==typeof this.props.accessibilityValueMax||"number"==typeof this.props.accessibilityValueNow||"boolean"==typeof this.props.accessibilityModal||this.props.accessibilityValueText||this.props.role||this.props.accessibilityAriaOrientation)},t.prototype.getElementPropsInternal=function(){var e={};e.id=this.props.id,this.props.hidden&&(e[i.E]=!0),this.props.accessibilityLabel&&(e[i.m]=this.props.accessibilityLabel),this.props.accessibilityChecked&&(e[i.e]=this.props.accessibilityChecked),this.props.accessibilityLive&&(e[i.p]=this.props.accessibilityLive),this.props.accessibilityRelevant&&(e[i.w]=this.props.accessibilityRelevant),this.props.accessibilityAtomic&&(e[i.c]=this.props.accessibilityAtomic),this.props.labelledByElementId&&(e[i.n]=this.props.labelledByElementId),this.props.describedByElementId&&(e[i.h]=this.props.describedByElementId),this.props.controlsElementId&&(e[i.f]=this.props.controlsElementId),this.props.ownsElementId&&(e[i.t]=this.props.ownsElementId),this.props.accessibilityRequired&&(e[i.x]=this.props.accessibilityRequired),"boolean"==typeof this.props.accessibilityExpanded&&(e[i.j]=this.props.accessibilityExpanded),"string"!=typeof this.props.accessibilityHasPopup&&"boolean"!=typeof this.props.accessibilityHasPopup||(e[i.k]=this.props.accessibilityHasPopup),"string"!=typeof this.props.accessibilityPressed&&"boolean"!=typeof this.props.accessibilityPressed||(e[i.u]=this.props.accessibilityPressed),"boolean"==typeof this.props.accessibilityReadOnly&&(e[i.v]=this.props.accessibilityReadOnly),"boolean"==typeof this.props.accessibilityDisabled&&(e[i.i]=this.props.accessibilityDisabled),"number"==typeof this.props.accessibilityLevel&&(e[i.o]=this.props.accessibilityLevel),"boolean"==typeof this.props.accessibilityHidden&&(e[i.l]=this.props.accessibilityHidden),"boolean"==typeof this.props.isSelected&&(e[i.y]=this.props.isSelected),this.props.activeDescendantId&&(e[i.b]=this.props.activeDescendantId),this.props.accessibilityCurrent&&(e[i.g]=this.props.accessibilityCurrent),"number"==typeof this.props.accessibilityValueMin&&(e[i.A]=this.props.accessibilityValueMin),"number"==typeof this.props.accessibilityValueMax&&(e[i.z]=this.props.accessibilityValueMax),"number"==typeof this.props.accessibilityValueNow&&(e[i.B]=this.props.accessibilityValueNow),"boolean"==typeof this.props.accessibilityModal&&(e[i.q]=this.props.accessibilityModal),this.props.accessibilityValueText&&(e[i.C]=this.props.accessibilityValueText),this.props.role&&(e[i.F]=this.props.role),this.props.title&&(e[i.G]=this.props.title),this.props.accessibilityAriaOrientation&&(e[i.s]=this.props.accessibilityAriaOrientation),"number"==typeof this.props.tabIndex&&(e.tabIndex=this.props.tabIndex);var t=this.props[o.a.LearningPathAttributeName];if(t&&(e[o.a.LearningPathAttributeName]=t),this.props.testhooks){var n=this.props.testhooks;for(var r in n)e["data-"+r]=n[r]}null!=this.props.onClick&&(e.onClick=this.props.onClick),null!=this.props.onDoubleClick&&(e.onDoubleClick=this.props.onDoubleClick),null!=this.props.onDrag&&(e.onDrag=this.props.onDrag),null!=this.props.onDragEnd&&(e.onDragEnd=this.props.onDragEnd),null!=this.props.onDragEnter&&(e.onDragEnter=this.props.onDragEnter),null!=this.props.onDragExit&&(e.onDragExit=this.props.onDragExit),null!=this.props.onDragLeave&&(e.onDragLeave=this.props.onDragLeave),null!=this.props.onDragOver&&(e.onDragOver=this.props.onDragOver),null!=this.props.onDragStart&&(e.onDragStart=this.props.onDragStart),null!=this.props.onDrop&&(e.onDrop=this.props.onDrop),null!=this.props.onClickCapture&&(e.onClickCapture=this.props.onClickCapture),null!=this.props.onPointerOver&&(e.onPointerOver=this.props.onPointerOver),null!=this.props.onPointerOut&&(e.onPointerOut=this.props.onPointerOut),null!=this.props.onPointerUp&&(e.onPointerUp=this.props.onPointerUp),null!=this.props.onPointerDown&&(e.onPointerDown=this.props.onPointerDown),null!=this.props.onPointerEnter&&(e.onPointerEnter=this.props.onPointerEnter),null!=this.props.onPointerLeave&&(e.onPointerLeave=this.props.onPointerLeave),null!=this.props.onPointerMove&&(e.onPointerMove=this.props.onPointerMove),null!=this.props.onPointerCancel&&(e.onPointerCancel=this.props.onPointerCancel),null!=this.props.onBlur&&(e.onBlur=this.props.onBlur),null!=this.props.onFocus&&(e.onFocus=this.props.onFocus),null!=this.props.onMouseEnter&&(e.onMouseEnter=this.props.onMouseEnter),null!=this.props.onMouseLeave&&(e.onMouseLeave=this.props.onMouseLeave),null!=this.props.onKeyDown&&(e.onKeyDown=this.props.onKeyDown),null!=this.props.onKeyUp&&(e.onKeyUp=this.props.onKeyUp),null!=this.props.onScroll&&(e.onScroll=this.props.onScroll),Object.assign(e,this.getElementProps()),e.children=null,e.style=this.getElementStyle();var a=this.getElementClassName()+" "+this.getFlexClassName(e.style);return a.length>0&&(e.className=a,e.style={}),e},t.prototype.getElementStyle=function(){return this.props.style},t.prototype.getElementClassName=function(){return(this.props.styles?this.props.styles:"")+(this.props.explicitStyles?" "+this.props.explicitStyles:"")},t.prototype.getFlexClassName=function(e){return""},t.prototype.getElementChildren=function(){var e=this.props.children;if(Array.isArray(e)){if(0===e.length)return null;e.length}return"string"==typeof e&&0===e.length?null:e},t.isElementScrollable=function(e){return"auto"===e.overflow||"auto"===e.overflowX||"auto"===e.overflowY||"scroll"===e.overflow||"scroll"===e.overflowX||"scroll"===e.overflowY},t.prototype.render=function(){return a.createElement(this.getElementName(),this.getElementPropsInternal(),this.getElementChildren())},Object.defineProperty(t.prototype,"isIE",{get:function(){return c},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEdge",{get:function(){return l},enumerable:!1,configurable:!0}),t}(a.Component)},CXmn:function(e,t,n){"use strict";n.d(t,"f",(function(){return y})),n.d(t,"e",(function(){return v})),n.d(t,"d",(function(){return S})),n.d(t,"k",(function(){return O})),n.d(t,"m",(function(){return C})),n.d(t,"j",(function(){return E})),n.d(t,"c",(function(){return I})),n.d(t,"i",(function(){return w})),n.d(t,"b",(function(){return j})),n.d(t,"g",(function(){return P})),n.d(t,"l",(function(){return T})),n.d(t,"n",(function(){return N})),n.d(t,"h",(function(){return A})),n.d(t,"a",(function(){return D}));var r=n("LzVy"),a=n("sclX"),i=n("4leG"),o=n("unFF"),s=n("b8TU"),c=n("GYEz"),l=n("AVDU"),u=n("w1eR"),d=n("NjDY"),p=n("IqkD"),g=n("glAs"),h=n("h4iz"),f=n("504W"),m=n("Lyxw"),b=n("3/02"),_=n("E+Gg");function y(e){return!!Object(m.a)(e,b.qc,b.Lc)||Object(m.c)(e,b.qc)&&Object(m.c)(e,b.ae)}function v(e){return Object(m.c)(e,b.Ib)}function S(e){return Object(m.c)(e,b.Hb)}function O(e){return Object(d.j)(e)}function C(e){return Object(p.c)(e)}function E(e){var t;const n=Object(c.a)(e),r=Object(i.c)(e),a=Object(s.d)(e),o=Object(g.a)(e),l=Object(c.a)(e)===u.a.MailApp;if(!(null===(t=Object(p.w)(e))||void 0===t?void 0:t.isLive)||n===u.a.MobileApplication||l||r)return!1;if(o||a){const t=Object(h.a)(e);return Object(f.a)(t)}return!0}function I(e){return Object(_.b)(e)}function w(e){return Object(l.e)(e)&&Object(l.b)(e)}function j(e){return Object(l.b)(e)&&Object(i.c)(e)}function P(e){return!!Object(l.b)(e)&&(Object(c.a)(e)!==u.a.MailApp&&!Object(i.c)(e))}function T(e){if(Object(l.b)(e))return!1;const t=Object(r.a)(e),n=Object(i.c)(e),o=Object(s.d)(e);return!(t!==a.b.Native&&!n&&!o)}function N(e){const t=Object(r.a)(e),n=Object(i.c)(e);return!(t!==a.b.Native&&!n)||!Object(s.d)(e)&&void 0}function A(e){if(Object(l.b)(e))return!1;const t=Object(r.a)(e),n=Object(c.a)(e),o=Object(i.c)(e);return t===a.b.Native&&n!==u.a.MailApp||o}function D(e){const t=Object(o.a)(e);return T(e)?t.sizes.NavBarHeightMobile:t.sizes.NavbarHeight}},CYtR:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"h",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return u}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="MscrmControls.ModelForm.ModelFormControl",a="MscrmControls.FieldControls.DateTimeControl",i="MscrmControls.FieldControls.DateControl",o="MscrmControls.FieldControls.TimeControl",s="MscrmControls.ActivityControls.ActivityEditorControl",c="MscrmControls.KbEditorControl.KbEditorControl",l="MscrmControls.RichTextEditor.RichTextEditorControl",u="MscrmControls.RichTextEditorV2.RichTextEditorControlV2"},CfSh:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("IpQH"),a=n("DRVD"),i=n.n(a),o=n("uM6Y"),s=n("VkXQ"),c=n("DPfD"),l=n("zwYV");class u extends r.a{constructor(e,t){super(e,t,o.c),this._tracer=e.TraceManager.getTracer("ExternalContext")}getExternalContextProperty(e,t,n=null){const r=s.c.getExternalContextProperty.name,a=o.c+"."+r,u=[{name:"ContextId",value:e},{name:"PropertyId",value:t}],d=i.a.createEvent(r,o.c).startStopwatch({externalContextId:e,externalContextPropertyId:t}),p=this.getAvailableExternalContexts();if(!p||!p[e]){const t=`External context ${e} is not available. Check the availability before calling.`;return d(),this._tracer.info(t),Promise.reject(new Error(t))}if(-1===p[e].properties.indexOf(t)){const n=`External context property ${t} is not available on context ${e}. Check the availability before calling.`;return d(),this._tracer.info(n),Promise.reject(new Error(n))}n&&n.updateListener&&this.applicationStore.dispatch(Object(l.f)(e,t,n.updateListener));const g=Object(c.c)(this.applicationStore.getState(),e,t);return void 0!==g?(d(),this._tracer.info(`External Context property retrieved from state: ${e} ${t}`),Promise.resolve(g)):this.execute(r,e,t,n&&n.args).then(n=>(d(),this._tracer.info(`External Context property retrieved from platform: ${e} ${t}`),n&&n.value),e=>(d(),this.applicationContext.EventManager.ReportComponentFailure(a,e,"Check shim connection to external context",u),e&&e.innerError&&e.innerError.code&&(e.code=e.innerError.code),Promise.reject(e)))}invokeExternalContextAction(e,t,n=null){const r=s.c.invokeExternalContextAction.name,a=o.c+"."+r,c=[{name:"ContextId",value:e},{name:"ActionId",value:t}],l=i.a.createEvent(r,o.c).startStopwatch({externalContextId:e,externalContextActionId:t}),u=this.getAvailableExternalContexts();if(!u||!u[e]){const t=`External context ${e} is not available. Check the availability before calling.`;return l(),this._tracer.info(t),Promise.reject(new Error(t))}if(-1===u[e].actions.indexOf(t)){const n=`External context action ${t} is not available on context ${e}. Check the availability before calling.`;return l(),this._tracer.info(n),Promise.reject(new Error(n))}return this.execute(r,e,t,n&&n.args).then(n=>(l(),this._tracer.info(`External Context action invoked on platform: ${e} ${t}`),n&&n.value),e=>(l(),this.applicationContext.EventManager.ReportComponentFailure(a,e,"Check shim connection to external context",c),e&&e.innerError&&e.innerError.code&&(e.code=e.innerError.code),Promise.reject(e)))}getAvailableExternalContexts(){return Object(c.a)(this.applicationStore.getState())}removeExternalContextPropertyListener(e,t,n){this.applicationStore.dispatch(Object(l.h)(e,t,n))}}},Cfpy:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e._ConvertNumberToArray=function(e,t){if(!e)return t?this._doubleZero:this._floatZero;var n=t?52:23,r=(1<<(t?11:8)-1)-1,a=1-r,i=r,o=e<0?1:0;e=Math.abs(e);for(var s=Math.floor(e),c=e-s,l=2*(r+2)+n,u=new Array(l),d=0;d<l;)u[d++]=0;for(d=r+2;d&&s;)u[--d]=s%2,s=Math.floor(s/2);for(d=r+1;d<l-1&&c>0;)(c*=2)>=1?(u[++d]=1,--c):u[++d]=0;for(var p=0;p<l&&!u[p];)p++;var g=r+1-p,h=p+n;if(u[h+1]){for(d=h;d>p&&(u[d]=1-u[d],!u);--d);d===p&&++g}if(g>i||s)return o?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity;if(g<a)return t?this._doubleZero:this._floatZero;if(t){var f=0;for(d=0;d<20;++d)f=f<<1|u[++p];for(var m=0;d<52;++d)m=m<<1|u[++p];return[255&m,m>>8&255,m>>16&255,m>>>24,255&(f=o<<31|2147483647&(f|=g+r<<20)),f>>8&255,f>>16&255,f>>>24]}var b=0;for(d=0;d<23;++d)b=b<<1|u[++p];return[255&(b=o<<31|2147483647&(b|=g+r<<23)),b>>8&255,b>>16&255,b>>>24]},e._floatZero=[0,0,0,0],e._doubleZero=[0,0,0,0,0,0,0,0],e._floatInifinity=[0,0,128,127],e._floatNegInifinity=[0,0,128,255],e._doubleInifinity=[0,0,0,0,0,0,240,127],e._doubleNegInifinity=[0,0,0,0,0,0,240,255],e}();t.FloatUtils=r},Cjdz:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var r=n("504W"),a=n("wMH2"),i=n("Qwz5"),o=n("VJwX"),s=n("Jz2d"),c=n("DRVD"),l=n.n(c);function u(e,t){return d(e.get_domParserElement(),t)}function d(e,t){const n=l.a.createEvent("LoadFromCrmSoap","EntityCollection").startStopwatch(),c=new Array(0);let u=!1,d=0,p=!1,g=null;for(let t=0,n=e.childNodes.length;t<n;t++){const n=e.childNodes[t];if(n.namespaceURI===s.a.xrm2011ContractsNamespace){switch(Object(o.b)(n.nodeName)){case"Entities":g=n;break;case"MoreRecords":Object(r.a)(n.firstChild)||Object(r.b)(n.firstChild.nodeValue)||(u=Boolean.parse(n.firstChild.nodeValue).valueOf());break;case"TotalRecordCount":Object(r.a)(n.firstChild)||Object(r.b)(n.firstChild.nodeValue)||(d=Number.parseInvariant(n.firstChild.nodeValue));break;case"TotalRecordCountLimitExceeded":Object(r.a)(n.firstChild)||Object(r.b)(n.firstChild.nodeValue)||(p=Boolean.parse(n.firstChild.nodeValue).valueOf())}}}if(g){let e=0;for(let t=0,n=g.childNodes.length;t<n;t++){const n=g.childNodes[t];n.namespaceURI===s.a.xrm2011ContractsNamespace&&"Entity"===Object(o.b)(n.nodeName)&&(c[e]=Object(i.c)(n),e++)}}return n(),new a.a(c,u,d,p,t)}function p(e){const t=new Sys.StringBuilder;t.append("<a:Entities>");for(const n of e.get_entities())t.append("<a:Entity>"),t.append(Object(i.d)(n,!1)),t.append("</a:Entity>");return t.append("</a:Entities>"),t.toString()}},CngE:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return g})),n.d(t,"i",(function(){return h}));var r=n("SAYH"),a=n("eXjw");function i(e,t){const n=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return e&&e.metadata&&e.metadata.charts?e.metadata.charts:null}(e);if(!t||!n)return null;const a=r.a.toString(t);return n.hasOwnProperty(a)?n[a]:null}function o(e,t){const n=i(e,t);return n?n.oDataInitialized:a.a.Uninitialized}function s(e,t){const n=i(e,t);return n?n.initialized:a.a.Uninitialized}function c(e,t,n){return e&&t&&n&&e&&e.data&&e.data.charts&&e.data.charts[t]&&e.data.charts[t][n]?e.data.charts[t][n].initialized:a.a.Uninitialized}function l(e,t){return e&&t&&e&&e.data&&e.data.chartData&&e.data.chartData[t]?e.data.chartData[t].initialized:a.a.Uninitialized}function u(e,t){return e&&t&&e&&e.metadata&&e.metadata.chartSelectors&&e.metadata.chartSelectors[t]?e.metadata.chartSelectors[t].initialized:a.a.Uninitialized}function d(e,t){if(!(e&&e.metadata&&e.metadata.chartDefaults&&t))return null;const n=e.metadata.chartDefaults[t];return n||null}function p(e,t,n){return e&&t&&n&&e&&e.data&&e.data.charts&&e.data.charts[t]&&e.data.charts[t][n]&&e.data.charts[t][n].initialized===a.a.Initialized&&e.data.charts[t][n].chartConfigObject?e.data.charts[t][n].chartConfigObject:null}function g(e,t){return e&&t&&e&&e.data&&e.data.chartData&&e.data.chartData[t]&&e.data.chartData[t].initialized===a.a.Initialized&&e.data.chartData[t].chartConfigObject?e.data.chartData[t].chartConfigObject:null}function h(e,t){return e&&t&&e&&e.metadata&&e.metadata.chartSelectors?e.metadata.chartSelectors[t]:null}},CpcI:function(e,t,n){"use strict";n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return r})),n.d(t,"f",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="CC_Duration_Minute",a="CC_Duration_Minutes",i="CC_Duration_Hour",o="CC_Duration_Hours",s="CC_Duration_Day",c="CC_Duration_Days",l=[r,a,i,o,s,c]},CrQY:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");class a extends r.a{constructor(e,t,n,r){super(),this._searchText=null,this._entityGroupName=null,this._entityNames=null,this._searchText=e,this._entityGroupName=t,this._entityNames=n}get_name(){return"ExecuteQuickFind"}get_searchText(){return this._searchText}get_entityGroupName(){return this._entityGroupName}get_entityNames(){return this._entityNames}}},CvZq:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.NonBlockingUI=0]="NonBlockingUI",e[e.BlockingUI=1]="BlockingUI"}(r||(r={}))},Cxkq:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r,a=n("wo7m");function i(e,t){return{type:"DESERIALIZE_RETRIEVE_PRINCIPAL_ACCESS_RESPONSE_ASYNC",execute:({dispatch:t,getState:n},i)=>e.json().then(e=>{let t=r.None;return e&&"string"==typeof e.AccessRights&&e.AccessRights.split(", ").forEach(e=>{const n=r[e];t|=n}),new a.a(t)})}}!function(e){e[e.None=0]="None",e[e.ReadAccess=1]="ReadAccess",e[e.WriteAccess=2]="WriteAccess",e[e.AppendAccess=4]="AppendAccess",e[e.AppendToAccess=16]="AppendToAccess",e[e.CreateAccess=32]="CreateAccess",e[e.DeleteAccess=65536]="DeleteAccess",e[e.ShareAccess=262144]="ShareAccess",e[e.AssignAccess=524288]="AssignAccess"}(r||(r={}))},"D+Bz":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r,a;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e[e.Page=0]="Page",e[e.Dialog=1]="Dialog"}(r||(r={})),function(e){e.Other="Other",e.SiteMap="SiteMap",e.AdvancedInAppShell="AdvancedInAppShell",e.Redirect="Redirect",e.SwitchApp="SwitchApp",e.SiteMapSubArea="SiteMapSubArea",e.Xrm="Xrm",e.BrowserBack="BrowserBack",e.Unknown="Unknown"}(a||(a={}))},D6Jg:function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return l}));var r=n("ZUus"),a=n("mlvZ"),i=n("xagu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="initialize.configuration.from.url",s=e=>{const t=e.searchParams.get(i.B),n={isPreviewMode:!!c(t)},r=Object(a.f)(),s=e.searchParams.get("cmdbar"),p=e.searchParams.get("ribbondebug"),g=e.searchParams.get("navbar"),h=e.searchParams.get("sitemap"),f=e.searchParams.get("testmode"),m=e.searchParams.get("flags"),b=e.searchParams.get("app"),_=e.searchParams.get("disableLocalStorage");if(!(s||g||r||p||h||f||b||m))return;const y=c(s),v=c(p),S=l(g),O=c(h),C=c(f),E=c(_),I=u(m),w=d(m),j=c(I[i.z]);return void 0!==y&&(n.cmdbar=y),void 0!==v&&(n.ribbonDebug=v),S&&(n.navbar=S),r&&(n.performanceUiEnabled=!0),void 0!==O&&(n.sitemap=O),!0===C||"d365default"===b?n.isD365DefaultApp=!0:!1===C&&(n.isD365DefaultApp=!1),void 0!==I&&(n.flags=I),void 0!==w&&(n.fcbs=w),void 0!==E&&(n.disableLocalStorage=E),void 0!==j&&(n.isEmbedded=j),{type:o,payload:n}},c=e=>{if(e)switch(e.toLowerCase()){case"false":return!1;case"true":return!0;default:return}},l=e=>{if(e)switch(e.toLowerCase()){case r.a[r.a.Off].toLowerCase():return r.a.Off;case r.a[r.a.Entity].toLowerCase():return r.a.Entity;case r.a[r.a.On].toLowerCase():return r.a.On;default:return}},u=e=>{if(!e)return{};const t={},n=e.split(",");for(const e of n){const n=e.split("="),r=n[0].toLowerCase(),a=n[1]&&n[1].toLowerCase();t[r]=a}return t},d=e=>{if(!e)return{};const t={},n=e.split(",");for(const e of n){const n=e.split("="),r=n[0];if(r.startsWith("FCB.")){const e=c(n[1]);t[r]=e}}return t}},D9jM:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n("LbMF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,n,a){const i=function(e,t,n){if(!e||!e.metadata)return null;const a=Object(r.a)(e,t,n);return a?a.OptionSet:[]}(e,t,n);for(const e of i)if(e.Value===a)return e.Label;return""}function i(e,t,n,a){const i=Object(r.a)(e,t,n);if(!i||!i.OptionSet)return null;const o=[];for(const e of i.OptionSet)e.ParentValues&&e.ParentValues.find(e=>e===a)&&o.push(e);return o.length>0?o:null}},"DO7/":function(e,t,n){"use strict";
/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r="function"==typeof Symbol&&Symbol.for,a=r?Symbol.for("react.element"):60103,i=r?Symbol.for("react.portal"):60106,o=r?Symbol.for("react.fragment"):60107,s=r?Symbol.for("react.strict_mode"):60108,c=r?Symbol.for("react.profiler"):60114,l=r?Symbol.for("react.provider"):60109,u=r?Symbol.for("react.context"):60110,d=r?Symbol.for("react.async_mode"):60111,p=r?Symbol.for("react.concurrent_mode"):60111,g=r?Symbol.for("react.forward_ref"):60112,h=r?Symbol.for("react.suspense"):60113,f=r?Symbol.for("react.suspense_list"):60120,m=r?Symbol.for("react.memo"):60115,b=r?Symbol.for("react.lazy"):60116,_=r?Symbol.for("react.block"):60121,y=r?Symbol.for("react.fundamental"):60117,v=r?Symbol.for("react.responder"):60118,S=r?Symbol.for("react.scope"):60119;function O(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case a:switch(e=e.type){case d:case p:case o:case c:case s:case h:return e;default:switch(e=e&&e.$$typeof){case u:case g:case b:case m:case l:return e;default:return t}}case i:return t}}}function C(e){return O(e)===p}t.AsyncMode=d,t.ConcurrentMode=p,t.ContextConsumer=u,t.ContextProvider=l,t.Element=a,t.ForwardRef=g,t.Fragment=o,t.Lazy=b,t.Memo=m,t.Portal=i,t.Profiler=c,t.StrictMode=s,t.Suspense=h,t.isAsyncMode=function(e){return C(e)||O(e)===d},t.isConcurrentMode=C,t.isContextConsumer=function(e){return O(e)===u},t.isContextProvider=function(e){return O(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===a},t.isForwardRef=function(e){return O(e)===g},t.isFragment=function(e){return O(e)===o},t.isLazy=function(e){return O(e)===b},t.isMemo=function(e){return O(e)===m},t.isPortal=function(e){return O(e)===i},t.isProfiler=function(e){return O(e)===c},t.isStrictMode=function(e){return O(e)===s},t.isSuspense=function(e){return O(e)===h},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===o||e===p||e===c||e===s||e===h||e===f||"object"==typeof e&&null!==e&&(e.$$typeof===b||e.$$typeof===m||e.$$typeof===l||e.$$typeof===u||e.$$typeof===g||e.$$typeof===y||e.$$typeof===v||e.$$typeof===S||e.$$typeof===_)},t.typeOf=O},DPXt:function(e,t,n){"use strict";n.r(t);var r={};n.r(r);var a={};n.r(a);var i={};n.r(i),n.d(i,"decorateUrl",(function(){return Ku})),n.d(i,"decorateInput",(function(){return Qu}));var o={};n.r(o),n.d(o,"decorateUrl",(function(){return Yu})),n.d(o,"decorateInput",(function(){return Ju}));var s={};n.r(s),n.d(s,"decorateUrl",(function(){return $u})),n.d(s,"decorateInput",(function(){return Zu}));var c={};n.r(c),n.d(c,"diagnosticName",(function(){return fh})),n.d(c,"boot",(function(){return mh}));n("6Uao"),n("MFtM"),n("TlmJ"),n("8+XZ"),n("Y/CM"),n("jMf1");
/**
 * Loads global polyfills so they are included by webpack
 * and initialize window level variables.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
n.p=__public_path__;var l=n("nuS9"),u=n("4fxQ");
/**
 * Loads global polyfills so they are included by webpack
 * and initialize window level variables.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
window.React=l,window.ReactDOM=u,window.__React=l,window.__ReactDOM=u,window.requirejs=function(e,t){if(1===e.length){if("react"===e[0])return void t(l);if("react-dom"===e[0])return void t(u)}throw new Error("requirejs is not supported")};var d=n("zsAz"),p=n("DRVD"),g=n.n(p),h=n("SZCI");var f=n("iDqy"),m=n.n(f),b=n("zmaG"),_=n.n(b),y=n("Z9sG"),v=n("pEXn"),S=n("mlvZ"),O=n("2YQW");var C=n("mfAb");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var E=n("TBkx"),I=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class w{constructor(e,t,n,r){this._pendingActionCache={},this._store=e,this._dispatch=t,this._applicationContext=n,this._tracer=r}executeAction(e,t){return Object(C.a)(e)?this._executeAsync(e,t):this._executeSync(e,t)}_executeSync(e,t){const n=g.a.createEvent(e.type,h.x).startStopwatch();try{return this._beginExecution(e,this._store,this._applicationContext,t),Object(C.b)(e)?void this._executePlainAction(e,t):this._executeSyncAction(e,t)}catch(n){this._handleFailure(n,e,this._store,this._applicationContext,t,!0)}finally{n()}}_executePlainAction(e,t){this._dispatch(e),this._handleSuccess(e,void 0,this._store,this._applicationContext,t)}_executeSyncAction(e,t){const n=this._store,r=e.execute(n,this._applicationContext,t);return this._handleSuccess(e,r,this._store,this._applicationContext,t),r}_executeAsync(e,t){const n=e.cacheKey;return n&&this._pendingActionCache[n]?this._pendingActionCache[n]:this._executeAsyncAction(e,t)}_executeAsyncAction(e,t){const n=g.a.createEvent(e.type,"Core.Actions.Async"),r=g.a.createEvent(e.type,h.x),a=n.startStopwatch(),i=new Promise(n=>{this._beginExecution(e,this._store,this._applicationContext,t);const a=r.startStopwatch(),i=function(e,t,n){const r={getState:e.getState,dispatch:n=>e.dispatch(n,t)};n&&(r.subscribe=e.subscribe);return r}(this._store,t,function(e){return!!e.shouldReceiveFullStore}(e));try{const r=e.execute(i,this._applicationContext,t);r||this._tracer.warn(`No promise returned from execute method, ActionType: ${e.type}.`),n(r)}finally{a()}}).then(n=>(this._handleSuccess(e,n,this._store,this._applicationContext,t),n)).catch(n=>this._handleFailure(n,e,this._store,this._applicationContext,t)),o=()=>a();i.then(o,o);const s=e.cacheKey;if(s){this._pendingActionCache[s]=i;const e=()=>delete this._pendingActionCache[s];i.then(e,e)}return i}_beginExecution(e,t,n,r){const a=this._getExecutionParameters(e,r);if("function"==typeof e.getInitialParameters){const r=n.EventManager;try{Array.prototype.push.apply(a,e.getInitialParameters(t,n))}catch(e){this._tracer.error("AsyncActionExecutor.getInitialParameters failed, message : "+e.message,a)}r.ReportComponentSuccess("AsyncActionExecutor.BeginExecute",a)}else this._tracer.info("Begin executing action",this._getExecutionParameters(e,r))}_handleSuccess(e,t,n,r,a){const i=this._getExecutionParameters(e,a);if("function"==typeof e.getSuccessParameters){const a=r.EventManager;try{Array.prototype.push.apply(i,e.getSuccessParameters(t,n,r))}catch(e){this._tracer.error("AsyncActionExecutor.getSuccessParameters failed, message : "+e.message,i)}a.ReportComponentSuccess("AsyncActionExecutor.EndExecute",i)}else this._tracer.info("Finished executing action successfully",this._getExecutionParameters(e,a))}_handleFailure(e,t,n,r,a,i=!1){const o=r.EventManager,s={actionType:t.type,actionStack:a.stack,contextId:a.contextId};let c,l;if(e){const t=Object(E.d)(e);if("object"==typeof e){if(Object.isFrozen(e)){const n=Object(d.d)(t.message);n.innerError=e,l=n}else l=e;try{l.message=t.message,l.name=l.name||t.name,l.stack=t.stack}catch(e){e&&e.message&&this._tracer.error("Copying ensuredError properties to error object failed, message : "+e.message),c=JSON.stringify(t,Object.getOwnPropertyNames(t))}}else l=t;(function(e){return"object"==typeof e&&null!==e&&"object"==typeof e.__action})(e)||(l.__action={source:s})}else l=new Error(`Action Executor detected an error, but the action (${t.type}) failed to supply an error object.`),l.__action={source:s};const u=l.__action,p=this._getExecutionFailureParameters(t,u,a);Object(I.b)(c)||p.push({name:"ReadOnlyErrorObjectString",value:c});let g=!a.parentContextId;if("function"==typeof t.getFailureParameters)try{Array.prototype.push.apply(p,t.getFailureParameters(l,u,n,r)),g=!0}catch(e){this._tracer.error("AsyncActionExecutor.getFailureParameters failed, message : "+e.message,p)}if(g){const e=`This is a failure that ${a.parentContextId?"is yet to reach":"reached uncaught to"} the entry level dispatch. For additional information, query for all events with the same CorrelationId.`;o.ReportComponentFailure("AsyncActionExecutor.EndExecute",l,e,p)}if(u.child=s,i)throw l;return Promise.reject(l)}_getExecutionParameters(e,t){const n=[{name:"ActionType",value:e.type},{name:"CorrelationId",value:t.correlationId},{name:"ContextId",value:t.contextId},{name:"EntryStack",value:t.entryStack},{name:"ActionStack",value:t.stack}];return t.parentContextId&&n.push({name:"ParentContextId",value:t.parentContextId}),n}_getExecutionFailureParameters(e,t,n){const r=[{name:"ActionType",value:e.type},{name:"CorrelationId",value:n.correlationId},{name:"ContextId",value:n.contextId},{name:"EntryStack",value:n.entryStack},{name:"ActionStack",value:t.source.actionStack},{name:"SourceContextId",value:t.source.contextId}];return n.parentContextId&&r.push({name:"ParentContextId",value:n.parentContextId}),r}}var j=n("SAYH");function P(e){return t=>(n,r)=>{const a=t(n,r);return function(e,t){const n={subscribe:t.subscribe,getState:t.getState,dispatch:function(e,n){return t.dispatch(e,n)}},r=e.TraceManager.getTracer("ActionLogging"),a=new w(n,t.dispatch,e,r);return t.dispatch=function(e,t){const n=m.a.trackWork(e.type);t=t?{entryStack:t.entryStack,stack:(t.stack||"")+" :"+e.type,correlationId:t.correlationId||j.a.toString(j.a.newGuid()),contextId:j.a.toString(j.a.newGuid()),parentContextId:t.contextId||"",isPreloadCall:t.isPreloadCall}:{entryStack:void 0,stack:e.type,correlationId:j.a.toString(j.a.newGuid()),contextId:j.a.toString(j.a.newGuid()),parentContextId:""};const r=a.executeAction(e,t);return n(),r},t}(e,a)}}function T(e){return(t,n)=>{const r=e(t,n);return r.subscribe=function(e){const t=e.subscribe;return function(n,r){let a;if(void 0===r)return a=n,t(a);const i=n;return a=function(e,t,n){let r;return function(){const a=t(e());a!==r&&(r=a,n(a))}}(e.getState,i,r),t(a)}}(r),r}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var N=n("ZZoC"),A=n("llMO");var D=n("gQ5I"),R=n("2jAf"),x=n("nxXM"),M=n("FdKt");var F=n("K7RF"),k=n("y6/h");var L=n("SeXA");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function B(e,t){switch(t.type){case L.a:return Object.assign({},e);default:return e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function U(e){return{type:"set.server.status",payload:{isAvailable:e}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function V(e){return{type:"set.network.status",payload:{isNetworkAvailable:e}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const z=["set.server.status","set.network.status"],W=Object(O.c)(z,null);const q=[n("1usl").a],H=Object(O.c)(q,null);var G=n("wyQO"),K=n("eXjw"),Q=n("N6Lu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const X=[G.b,G.a],Y=[G.b,Q.a],J={initialized:K.a.Uninitialized},$={initialized:K.a.Uninitialized};function Z(e=J,t){const n=Object.assign({},e);if(Object.freeze(n),-1===X.indexOf(t.type)||!t.payload)return n;let r;if(t.type===G.b){const e=t.payload.userState;r=Object.assign(Object.assign({},n),e)}else if(t.type===G.a){const e=t.payload,a=e.etn,i={};i[a]=e.pinnedView;for(const e in n.userSettings.defaultGridViews)e!==a&&(i[e]=n.userSettings.defaultGridViews[e]);r=Object.assign({},n),r.userSettings.defaultGridViews=i}return Object.freeze(r)}function ee(e=$,t){const n=Object.assign({},e);if(Object.freeze(n),-1===Y.indexOf(t.type)||!t.payload)return n;let r;if(t.type===G.b){const e=t.payload.orgState;r=Object.assign(Object.assign({},n),e)}else if(t.type===Q.a){const e=t.payload;r=Object.assign({},n),r.organizationSettings.webResourceHash=e}return Object.freeze(r)}var te=n("iQAP"),ne=n("B+9Q");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const re={clientFCBsByFeatureName:{},clientFCBsByFCBName:{},nativeFCBContext:{}};function ae(e=re,t){switch(t.type){case ne.a:return Object.freeze(Object.assign(Object.assign({},e),t.payload));case te.a:return Object.freeze(Object.assign(Object.assign({},e),{nativeFCBContext:t.payload}));default:return e}}var ie=n("VX+W"),oe=n("g440"),se=n("KdpX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ce=[F.a,ie.a,oe.a,se.c],le=Object(O.c)(ce,null,e=>e.forms);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ue=[F.a],de=Object(O.c)(ue,null,e=>e.siteMap);var pe=n("M0zh");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const ge=[pe.l,F.a],he=Object(O.c)(ge,null,e=>e.ribbons);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const fe=[F.a],me=Object(O.c)(fe,null,e=>e.searchConfiguration);var be=n("8VF0"),_e=n("FZDd"),ye=n("E3kc"),ve=n("fC8v");function Se(e,t,n){const r={};r[e]=function(e,t){const n={},r="OptionSet";for(const a of e){const e=[{name:v.b.EntityName,value:a.get_entityLogicalName()},{name:v.b.AttributeName,value:a.get_logicalName()}],i={Initialized:K.a.Initialized,Id:j.a.fromLegacyGuid(a.get_id()),LogicalName:a.get_logicalName(),EntityLogicalName:a.get_entityLogicalName(),Type:a.get_type(),SourceType:a.get_sourceType(),DisplayName:a.get_displayName(),RequiredLevel:Object(ve.e)(a.get_requiredLevel(),t,e),IsSecured:a.get_isSecured(),IsValidForCreate:a.get_isValidForCreate(),IsValidForUpdate:a.get_isValidForUpdate(),IsValidForRead:a.get_isValidForRead(),IsValidForGrid:a.get_isValidForGrid(),OptionSet:Oe(a.getODataObject()[r]),Targets:a.get_targets(),DefaultFormValue:a.get_defaultFormValue(),DefaultValue:a.get_defaultValue(),MaxLength:a.get_maxLength(),MinValue:a.get_minValue(),MaxValue:a.get_maxValue(),Precision:a.get_precision(),PrecisionSource:a.get_precisionSource(),Format:Object(ve.a)(a.get_type(),a.get_format(),a.get_formatName()),Behavior:a.get_behavior(),IsBaseCurrency:a.get_isBaseCurrency(),AttributeOf:a.get_attributeOf(),HasChanged:a.get_hasChanged(),IsSortableEnabled:a.get_isSortableEnabled(),ImeMode:Ee(a.get_imeMode()),InheritsFrom:a.get_inheritsFrom(),CanBeSecuredForCreate:a.get_canBeSecuredForCreate(),CanBeSecuredForRead:a.get_canBeSecuredForRead(),CanBeSecuredForUpdate:a.get_canBeSecuredForUpdate()};n[i.LogicalName]=i}return n}(t,n);return{type:"cache.attributemetadata",payload:{attributes:r}}}function Oe(e){let t=null;if(e&&(t=[],e.FalseOption&&t.push(Ce(e.FalseOption)),e.TrueOption&&t.push(Ce(e.TrueOption)),e.Options)){const n=e.Options;for(const e of n)t.push(Ce(e))}return t}function Ce(e){return{Color:e.Color,Label:Object(ve.b)(e.Label),Value:e.Value,DefaultStatus:e.DefaultStatus,State:e.State,InvariantName:e.InvariantName,TransitionData:e.TransitionData}}function Ee(e){if("string"!=typeof e)return"number"==typeof e?e:null;switch(e){case"Auto":return 0;case"Inactive":return 1;case"Active":return 2;case"Disabled":return 3;default:return null}}var Ie=n("thZs");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const we=[ie.a,F.a,be.a,_e.b,se.c,R.a,ye.a,"cache.attributemetadata",Ie.a];var je=n("1pQz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Pe=[F.a,_e.b,be.a,se.c,ie.a,R.a,"cache.entitymetadata",Ie.a],Te={1030:"systemform",1031:"userform"};var Ne=n("EY5k");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Ae=[Ne.a,ie.a,se.c,F.a,Ne.c,Ne.b],De={initialized:K.a.Uninitialized,strings:null,missingStringIds:[]};var Re=n("BoVI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const xe=[F.a,ie.a,oe.a,se.c,Re.a],Me=Object(O.c)(xe,null,e=>e.views);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Fe=[F.a];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ke=[ie.a,F.a],Le=Object(O.c)(ke,null,e=>e.dialogs);var Be=n("oOvK");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Ue=[F.a,ie.a,Be.b,se.c,Be.a];const Ve=[F.a],ze=Object(O.c)(Ve,null,e=>e.taskBasedFlows);var We=n("htFu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const qe=[We.b,F.a],He=Object(O.c)(qe,null,e=>e.taskBasedFlowGlobalMenu),Ge=[F.a,ie.a,We.a,oe.a,pe.l,se.c];var Ke=n("oLL6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Qe=[F.a,Ke.a],Xe=Object(O.c)(Qe,null,e=>e.businessProcessFlows),Ye=Object(O.c)(Qe,null,e=>e.businessProcessFlowsDefault),Je=Object(O.c)(Qe,null,e=>e.bpfDefaults),$e=Object(O.c)(Qe,null,e=>e.bpfSelectors),Ze=[F.a,pe.l];const et=[se.c,F.a],tt=Object(O.c)(et,null,e=>e.dashboards),nt=Object(O.c)(et,null,e=>e.dashboardsByNavPath),rt=Object(O.c)(et,null,e=>e.dashboardsByEntityName),at=Object(O.c)(et,null,e=>e.dashboardSelectorsByEntityName);var it=n("Tezb");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const ot=[se.c,it.b,it.f,it.a,F.a,R.a],st=Object(O.c)(ot,null,e=>e.charts);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ct=[F.a,ie.a],lt={optionSetNameById:{},optionSetByName:{}};var ut=n("99zj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const dt=[F.a,se.c,ut.a],pt=Object(O.c)(dt,null,e=>e.webResources),gt=Object(O.c)(dt,null,e=>e.webResourceDescriptorsByName);var ht=n("KeJu"),ft=n("xmKQ");var mt=n("Yz6o"),bt=n("AAlD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const _t={initialized:K.a.Uninitialized,appNavSettings:{Groups:[]}};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const yt=[F.a],vt=Object(O.c)(yt,null,e=>e.quickCreateMenu);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const St=[n("Py/t").a],Ot=Object(O.c)(St,null);var Ct=n("yRo8"),Et=n("RADj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const It=[Ct.e,ht.a],wt=Object.freeze({});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const jt=[F.a],Pt={initialized:K.a.Uninitialized,lastVersion:null,currentVersion:null};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Tt=[F.a],Nt={initialized:K.a.Uninitialized,lastVersion:null,currentVersion:null};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const At=[F.a],Dt=Object(O.c)(At,{appList:[]},e=>e.appModulesList),Rt=[F.a],xt={initialized:K.a.Uninitialized,complexControls:null};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Mt=[F.a],Ft=Object(O.c)(Mt,null,e=>e.landingPageOfflineMetadata);var kt=n("mASP");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Lt=[Ie.a],Bt=Object(O.c)(Lt,null,e=>e.lookup);var Ut=n("Wiik");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Vt=n("Datm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const zt={forms:le,formDefaults:function(e=null,t){if(-1===ce.indexOf(t.type)||!t.payload||!t.payload.formDefaults)return e;const n=t.payload.formDefaults,r=Object.assign({},e);for(const e in n)r.hasOwnProperty(e)?r[e]=Object.assign(Object.assign({},r[e]),n[e]):r[e]=n[e];return Object.freeze(r)},formSelectors:function(e=null,t){if(-1===ce.indexOf(t.type)||!t.payload||!t.payload.formSelectors)return e;const n=t.payload.formSelectors,r=Object.assign({},e);for(const e in n)r.hasOwnProperty(e)?r[e]=Object.assign(Object.assign({},r[e]),n[e]):r[e]=n[e];return Object.freeze(r)},ribbons:function(e,t){switch(t.type){case R.a:return function(e,t){if(!t.payload.ribbons||0===Object.keys(t.payload.ribbons).length)return e;const n={};for(const r of Object.keys(e)){let a=!1;for(const e of Object.keys(t.payload.ribbons))if(r===e){a=!0;break}a||(n[r]=e[r])}return n}(e,t);default:return he(e,t)}},siteMap:de,attributes:function(e=null,t){if(-1===we.indexOf(t.type)||!t||!t.payload||!t.payload.attributes)return e;if(t.type===R.a)return function(e,t){if(!t.payload.attributes||0===Object.keys(t.payload.attributes).length)return e;const n={};for(const r in e){let a=!1;for(const e in t.payload.attributes)if(r===e){a=!0;break}a||(n[r]=e[r])}return n}(e,t);const n=Object.assign({},e);for(const e in t.payload.attributes)if(n[e])if(t.type===Ie.a){n[e]=Object.assign({},n[e]);for(const r in t.payload.attributes[e])n[e].hasOwnProperty(r)||(n[e][r]=Object.assign({},t.payload.attributes[e][r]))}else n[e]=Object.assign(Object.assign({},n[e]),t.payload.attributes[e]);else n[e]=t.payload.attributes[e];return Object.freeze(n)},entities:function(e=null,t){if(!(t&&t.payload&&t.payload.entities&&0!==Object.keys(t.payload.entities).length&&t.type&&-1!==Pe.indexOf(t.type)))return e;const n=Object.assign({},e);let r=!1;if(t.type===R.a){r=!0;for(const e in t.payload.entities)n[e]=t.payload.entities[e]}else for(const e in t.payload.entities)n.hasOwnProperty(e)&&(!t.payload.entities[e].VersionNumber||n[e].VersionNumber===t.payload.entities[e].VersionNumber)&&(a=n[e],i=t.payload.entities[e],a.Initialized!==K.a.Uninitialized&&a.Initialized!==K.a.Partial||i.Initialized!==K.a.Initialized)||(r=!0,n[e]=Object.assign(Object.assign({},n[e]),t.payload.entities[e]));var a,i;return r?Object.freeze(n):e},entitiesByTypeCode:function(e=Te,t){if(!(t&&t.payload&&t.payload.entities&&t.type&&-1!==Pe.indexOf(t.type)))return e;const n=Object.assign({},e);for(const e in t.payload.entities){const r=t.payload.entities[e].ObjectTypeCode;null!=r&&(n[r]=e)}return Object.freeze(n)},resourceStrings:function(e=De,t){if(-1===Ae.indexOf(t.type)||!t.payload||!t.payload.resourceStrings)return e;let n=[],r=[];t.payload.resourceStrings.strings&&(n=Object.keys(t.payload.resourceStrings.strings)),e&&e.missingStringIds&&(r=e.missingStringIds.filter(e=>-1===n.indexOf(e)));const a=Object.assign(Object.assign({},e.strings),t.payload.resourceStrings.strings),i=Object.assign({},t.payload.resourceStrings);return i.strings=a,t.payload.resourceStrings.missingStringIds?i.missingStringIds=r.concat(t.payload.resourceStrings.missingStringIds):i.missingStringIds=r,Object.freeze(i)},views:Me,viewDefaults:function(e=null,t){if(-1===xe.indexOf(t.type)||!t.payload||!t.payload.viewDefaults)return e;const n=t.payload.viewDefaults,r=Object.assign({},e);for(const e in n)r.hasOwnProperty(e)?Object.assign(r[e],n[e]):r[e]=n[e];return Object.freeze(r)},viewSelectors:function(e=null,t){if(-1===xe.indexOf(t.type)||!t.payload||!t.payload.viewSelectors)return e;const n=t.payload.viewSelectors,r=Object.assign({},e);for(const e in n)for(const t in n[e])r.hasOwnProperty(e)?r[e][t]=n[e][t]:r[e]=n[e];return Object.freeze(r)},viewSelectorVersions:function(e=null,t){if(-1===xe.indexOf(t.type)||!t.payload||!t.payload.viewSelectorVersions)return e;const n=t.payload.viewSelectorVersions,r=Object.assign({},e);for(const e in n)for(const t in n[e])r.hasOwnProperty(e)?r[e][t]=n[e][t]:r[e]=n[e];return Object.freeze(r)},dialogs:Le,canvasapps:
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e={},t){switch(t.type){case"metadata.canvasapp.add":const i=t.payload;return n=e,r=i.name,a=i,void 0!==n[r]?n:Object.assign(Object.assign({},n),{[r]:a});default:return e}var n,r,a},rootCanvasApp:function(e={},t){switch(t.type){case Vt.b:return Object.assign({},t.payload);case Vt.a:const n=Object.assign(Object.assign({},e.dataComponentApp),t.payload.dataComponentApp);return Object.assign(Object.assign({},e),{dataComponentApp:n});default:return e}},controlManifests:function(e=null,t){if(-1===Ue.indexOf(t.type)||!t.payload||!t.payload.controlManifests)return e;const n=t.payload.controlManifests,r=Object.assign({},e);for(const e in n)r[e]=Object.assign(Object.assign({},r[e]),n[e]);return Object.freeze(r)},taskBasedFlows:ze,taskBasedFlowGlobalMenu:He,homePageConfigurations:function(e=null,t){if(-1===xe.indexOf(t.type)||!t.payload||!t.payload.homePageConfigurations)return e;const n=t.payload.homePageConfigurations,r=Object.assign({},e);for(const e in n)r.hasOwnProperty(e)?Object.assign(r[e],n[e]):r[e]=n[e];return Object.freeze(r)},homePageBusinessLogics:function(e=null,t){if(-1===Fe.indexOf(t.type)||!t.payload||!t.payload.homePageBusinessLogics)return e;const n=t.payload.homePageBusinessLogics,r=Object.assign({},e);for(const e in n)r.hasOwnProperty(e)?Object.assign(r[e],n[e]):r[e]=n[e];return Object.freeze(r)},labels:function(e=null,t){if(-1===Ge.indexOf(t.type)||!t||!t.payload||!t.payload.labels)return e;const n=t.payload.labels,r=Object.assign({},e);for(const e in n)if(r.hasOwnProperty(e))for(const t in n[e])r[e].hasOwnProperty(t)&&n[e][t],r[e][t]=n[e][t];else r[e]=n[e];return Object.freeze(r)},ribbonsLabelIds:function(e=null,t){if(-1===Ze.indexOf(t.type)||!t||!t.payload||!t.payload.ribbonsLabelIds)return e;const n=t.payload.ribbonsLabelIds,r=Object.assign(Object.assign({},e),n);return Object.freeze(r)},businessProcessFlows:Xe,businessProcessFlowsDefault:Ye,bpfDefaults:Je,bpfSelectors:$e,searchConfiguration:me,charts:function(e,t){if(!t||!t.payload||!t.payload.charts||0===Object.keys(t.payload.charts).length)return e;switch(t.type){case R.a:return function(e,t){const n={};for(const r in e)void 0===t.payload.charts[r]&&(n[r]=e[r]);return Object.freeze(n)}(e,t);case it.f:const n=t.payload.charts,r=Object.assign({},e);for(const e in n)r[e].oDataInitialized=n[e].oDataInitialized;return Object.freeze(r);default:return st(e,t)}},chartDefaults:function(e=null,t){if(-1===ot.indexOf(t.type)||!t.payload||!t.payload.chartDefaults)return e;const n=t.payload.chartDefaults,r=Object.assign({},e);for(const e in n)r[e]=n[e];return Object.freeze(r)},chartSelectors:function(e=null,t){if(-1===ot.indexOf(t.type)||!t.payload||!t.payload.chartSelectors)return e;const n=t.payload.chartSelectors,r=Object.assign({},e);for(const e in n)r[e]=n[e];return Object.freeze(r)},dashboards:tt,dashboardSelectors:function(e=null,t){if(-1===et.indexOf(t.type)||!t.payload||!t.payload.dashboardSelectors)return e;const n=t.payload.dashboardSelectors,r=Object.assign({},n),a=Object.keys(n);return a&&a.length?Object.freeze(r):e},dashboardsByNavPath:nt,dashboardsByEntityName:rt,dashboardSelectorsByEntityName:at,webResources:pt,webResourceDescriptorsByName:gt,optionSets:function(e=lt,t){if(-1===ct.indexOf(t.type)||!t||!t.payload||!t.payload.optionSets)return e;const n=Object.assign({},e);for(const e in t.payload.optionSets.optionSetNameById)n.optionSetNameById[e]?n.optionSetNameById[e]=Object.assign(Object.assign({},n.optionSetNameById[e]),t.payload.optionSets.optionSetNameById[e]):n.optionSetNameById[e]=t.payload.optionSets.optionSetNameById[e];for(const e in t.payload.optionSets.optionSetByName)n.optionSetByName[e]?n.optionSetByName[e]=Object.assign(Object.assign({},n.optionSetByName[e]),t.payload.optionSets.optionSetByName[e]):n.optionSetByName[e]=t.payload.optionSets.optionSetByName[e];return Object.freeze(n)},appContext:
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){let n=e;return t&&t.payload&&t.type&&t.payload.appContext&&(t.type===ht.b||t.type===F.a||t.type===ft.a)&&(n=Object.assign({},t.payload.appContext)),Object.freeze(n)},appShellSettings:function(e=_t,t){switch(t.type){case mt.a:return Object.freeze(Object.assign(Object.assign({},e),t.payload));case bt.a:if(e&&e.initialized===K.a.Initialized){const n=Object.freeze(Object.assign(Object.assign({},e.appNavSettings),{GroupsCollapsedState:t.payload}));return Object.freeze(Object.assign(Object.assign({},e),{appNavSettings:n}))}return Object.freeze(e);default:return Object.freeze(e)}},appModulesList:Dt,quickCreateMenu:vt,offlineSync:function(e=wt,t){if(-1===It.indexOf(t.type))return e;const n=t&&t.payload&&t.payload.offlineSync||{},r=["downloadSize","downloadTime","parseTime","persistTime","localDBSize"];let a;return a=e&&null!==e.syncStatus&&void 0!==e.syncStatus&&e.syncStatus!==n.syncStatus&&n.syncStatus===Et.a.InProgress?r.reduce((e,t)=>(e[t]=0,e),{}):r.reduce((t,r)=>{const a=n&&n[r],i=e&&e[r];return(a||i)&&(t[r]=(i||0)+(a||0)),t},{}),Object.freeze(Object.assign(Object.assign(Object.assign({},e),n),a))},offlineBPFEntities:Ot,metadataVersion:function(e=Pt,t){if(-1===jt.indexOf(t.type)||!t.payload||!t.payload.metadataVersion)return e;const n=Object.assign({},t.payload.metadataVersion);return e&&e.initialized!==K.a.Uninitialized&&(e.currentVersion!==n.currentVersion?n.lastVersion=e.currentVersion:n.lastVersion=e.lastVersion),Object.freeze(n)},userMetadataVersion:function(e=Nt,t){if(-1===Tt.indexOf(t.type)||!t.payload||!t.payload.userMetadataVersion)return e;const n=Object.assign({},t.payload.userMetadataVersion);return e&&e.initialized!==K.a.Uninitialized&&(e.currentVersion!==n.currentVersion?n.lastVersion=e.currentVersion:n.lastVersion=e.lastVersion),Object.freeze(n)},complexControls:function(e=xt,t){if(-1===Rt.indexOf(t.type)||!t.payload||!t.payload.complexControls)return e;const n=Object.assign(Object.assign({},e.complexControls),t.payload.complexControls.complexControls),r=Object.assign({},t.payload.complexControls);return r.complexControls=n,Object.freeze(r)},landingPageOfflineMetadata:Ft,lookup:Bt,consistencyStrong:function(e,t){switch(t.type){case Ut.a:return t.payload;default:return e}}},Wt=Object(O.a)(zt);function qt(e,t){if(t&&t.type===kt.a){const n=Object.freeze(Object.assign(Object.assign({},e),t.payload));return Wt(n,t)}return Wt(e,t)}var Ht=n("HfZT"),Gt=n("Dea/"),Kt=n("WY/A"),Qt=n("sX6v"),Xt=n("P+kM"),Yt=n("RrRQ"),Jt=n("Pcet"),$t=n("YYhu"),Zt=n("bi9n");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const en={};function tn(e,t,n){const r=Object.assign({},t),a=Object.assign({},n);for(const t of e)a[t]=r[t],delete r[t];return{from:r,to:a}}var nn=n("lY/Z"),rn=n("AFlp"),an=n("k1f1"),on=n("ycdb"),sn=n("c7jw"),cn=n("rodW"),ln=n("quej"),un=n("ijzp"),dn=n("9692"),pn=n("SnEr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const gn=["retrieve.grid.data.action",nn.a,nn.b,Ht.b,rn.a,an.a,sn.a,cn.a,ln.a,un.a,dn.a,pn.a,on.a],hn={};function fn(e,t){const n=Object.assign(Object.assign({},e.fields),t.fields);let r=null;e.accessRights?r=t.accessRights?{recordPrivileges:t.accessRights.recordPrivileges,attributePrivileges:Object.assign(Object.assign({},e.accessRights.attributePrivileges),t.accessRights.attributePrivileges)}:e.accessRights:t.accessRights&&(r=t.accessRights);for(const e in n)(null===n[e]||t.queryColumnNames&&-1!==t.queryColumnNames.indexOf(e)&&!t.fields.hasOwnProperty(e)&&n.hasOwnProperty(e))&&delete n[e];const a={initialized:t.initialized,fields:n};return e.businessProcessFlowId&&(a.businessProcessFlowId=e.businessProcessFlowId),e.businessProcessFlowInstanceId&&(a.businessProcessFlowInstanceId=e.businessProcessFlowInstanceId),e.processInstanceModifiedTimestamp&&(a.processInstanceModifiedTimestamp=e.processInstanceModifiedTimestamp),r&&(a.accessRights=r),t.identifier&&(a.identifier=t.identifier),a}function mn(e,t){let n=e;return t.businessProcessFlowId?n=Object.assign(Object.assign({},e),{businessProcessFlowId:t.businessProcessFlowId}):t.ignoreBpfOnRecord?n=Object.assign(Object.assign({},e),{ignoreBpfOnRecord:t.ignoreBpfOnRecord}):t.businessProcessFlowInstanceId?n=Object.assign(Object.assign({},e),{businessProcessFlowInstanceId:t.businessProcessFlowInstanceId}):t.processInstanceModifiedTimestamp?n=Object.assign(Object.assign({},e),{processInstanceModifiedTimestamp:t.processInstanceModifiedTimestamp}):null!=t.refreshGlobalNavigationData&&(n=Object.assign(Object.assign({},e),{refreshGlobalNavigationData:t.refreshGlobalNavigationData})),n}function bn(e,t,n,r){const a=r.payload.entities[t];if(a)if(n.hasOwnProperty(t)){n[t]=Object.assign({},e[t]);for(const o of Object.keys(a))if(n[t].hasOwnProperty(o)){const s=n[t][o];a[o].initialized!==K.a.Initialized?(n[t][o]=Object.assign({},e[t][o]),n[t][o].initialized=a[o].initialized):(i=r.type)===rn.a||i===an.a||i===cn.a||i===ln.a||i===on.a?n[t][o]=mn(s,a[o]):n[t][o]=fn(s,a[o])}else n[t][o]=a[o]}else n[t]=a;var i}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const _n=[it.e,it.d,it.c,ie.a,dn.a],yn={};var vn=n("odYE"),Sn=n("x0oY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const On=[n("85o3").f],Cn={};var En=n("+pAH");const In=[En.a],wn={};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const jn=["retrieve.grid.data.action",Ht.b,dn.a],Pn={};const Tn={entities:function(e=hn,t){if(-1===gn.indexOf(t.type)||!t.payload||!t.payload.entities||0===Object.keys(t.payload.entities).length)return e;if(t.type===dn.a)return function(e=hn,t){const n={};for(const r in e){const a=e[r],i=t.payload.entities[r];if(i)for(const e in a)void 0===i[e]&&(n[r]||(n[r]={}),n[r][e]=a[e]);else n[r]=a}return Object.freeze(n)}(e,t);if(t.type===pn.a)return function(e=hn,t){const n=e;return Object.keys(t.payload.entities).forEach(e=>{const r=t.payload.entities[e];r&&Object.keys(r).forEach(t=>{n&&n[e]&&n[e][t]&&delete n[e][t]})}),Object.freeze(n)}(e,t);const n=Object.assign({},e);for(const r of Object.keys(t.payload.entities))bn(e,r,n,t);return Object.freeze(n)},lists:function(e=Pn,t){if(-1===jn.indexOf(t.type)||!t||!t.payload||!t.payload.lists)return e;if(t.type===dn.a)return function(e,t){if(0===Object.keys(t.payload.lists).length)return e;const n={};for(const r in e)void 0===t.payload.lists[r]&&(n[r]=e[r]);return Object.freeze(n)}(e,t);let n=null;const r=Object.keys(t.payload.lists);if(!r||!r.length)return e;for(let a=0;a<r.length;a++){const i=r[a];if(e.hasOwnProperty(i)){n=Object.assign({},e);const r=t.payload.lists[i];if(r.initialized===K.a.Initialized&&r.pages){let t=0;const a=Number(Object.keys(r.pages)[0]),o=e[i];o&&o.pages&&o.pages[a]?(t=o.pages[a].startIndex,0!==r.totalRecordCount?n[i].records.splice(t,o.pageSize,...r.records):n[i].records=[]):o&&o.records?(t=o.records.length,n[i].records=o.records.concat(r.records)):n[i].records=r.records;const s=r.pages[a];n[i].pages=Object.assign(Object.assign({},n[i].pages),{[a]:{startIndex:t,startGuid:s.startGuid,pagingCookie:s.pagingCookie,moreRecords:s.moreRecords}})}n[i].initialized=r.initialized,n[i].lastRetrieved=r.lastRetrieved,n[i].totalRecordCount=r.totalRecordCount,n[i].totalRecordCountLimitExceeded=r.totalRecordCountLimitExceeded}else n=Object.assign(Object.assign({},e),t.payload.lists)}return Object.freeze(n)},snapshots:function(e=en,t){switch(t.type){case Xt.a:{const{snapshotId:n,selectedFields:r}=t.meta,a=t.payload,i=e[n],o={snapshotId:n,identifier:i.identifier,mode:i.mode};if(r)if(a){const e=tn(r,i.activeChanges,i.lockedChanges);Object.keys(e.from).length&&(o.activeChanges=e.from),Object.keys(e.to).length&&(o.lockedChanges=e.to)}else{const e=tn(r,i.lockedChanges,i.activeChanges);Object.keys(e.to).length&&(o.activeChanges=e.to),Object.keys(e.from).length&&(o.lockedChanges=e.from)}else a?o.lockedChanges=i.activeChanges:o.activeChanges=Object.assign(Object.assign({},i.lockedChanges),i.activeChanges);const s=Object.assign(Object.assign({},e),{[n]:o});return Object.freeze(s)}case $t.a:{const n=t.meta,r=e[n],a=Object.assign({},r);delete a.lockedChanges;const i=Object.assign(Object.assign({},e),{[n]:a});return Object.freeze(i)}case Yt.a:{const n={};for(const r in e)r!==t.meta&&(n[r]=e[r]);return Object.freeze(n)}case Kt.a:{const n=t.payload,r=Object.assign(Object.assign({},e),{[n.snapshotId]:n});return Object.freeze(r)}case Qt.a:{const n=t.meta.snapshotId,r=t.payload,a=e[n];if(r&&Object.keys(r).length>0||t.meta&&t.meta.newId&&a.mode===Gt.a.Create||t.meta&&1===t.meta.flavor){const i=0===t.meta.flavor?Object.assign(Object.assign({},a.activeChanges),r):r,o=Object.assign(Object.assign({},a),{activeChanges:i,identifier:t.meta.entityReference||a.identifier}),s=Object.assign(Object.assign({},e),{[n]:o});return Object.freeze(s)}return e}case Jt.a:{const n=t.meta,r=t.payload,a=Object.assign(Object.assign({},e[n]),{identifier:r}),i=Object.assign(Object.assign({},e),{[n]:a});return Object.freeze(i)}case Zt.a:{const n=t.meta,r=t.payload,a=Object.assign(Object.assign({},e[n]),{mode:r}),i=Object.assign(Object.assign({},e),{[n]:a});return Object.freeze(i)}default:return e}},lastSnapshotNumber:function(e=null,t){switch(t.type){case Kt.a:return t.meta.nextSnapshotNumber;default:return e}},charts:function(e=yn,t){if(-1===_n.indexOf(t.type)||!t||!t.payload||!t.payload.charts||0===Object.keys(t.payload.charts).length)return Object.freeze(e);if(t.type===dn.a)return function(e,t){const n={};for(const r in e)if(t.payload.charts[r])for(const a in e[r])void 0===t.payload.charts[r][a]&&(n[r]||(n[r]={}),n[r][a]=e[r][a]);else n[r]=e[r];return Object.freeze(n)}(e,t);let n=null;const r=Object.keys(t.payload.charts)[0];if(!r)return Object.freeze(e);if(e.hasOwnProperty(r)){n=Object.assign({},e);const a=Object.keys(t.payload.charts[r])[0];if(!a)return Object.freeze(e);n[r][a]=t.payload.charts[r][a]}else n=Object.assign(Object.assign({},e),t.payload.charts);return Object.freeze(n)},chartData:function(e={},t){if(-1===_n.indexOf(t.type)||!t||!t.payload||!t.payload.chartData||0===Object.keys(t.payload.chartData).length)return Object.freeze(e);if(t.type===dn.a)return function(e,t){const n={};for(const r in e)void 0===t.payload.chartData[r]&&(n[r]=e[r]);return Object.freeze(n)}(e,t);let n=null;const r=Object.keys(t.payload.chartData)[0];return r?(e.hasOwnProperty(r)?(n=Object.assign({},e),n[r]=t.payload.chartData[r]):n=Object.assign(Object.assign({},e),t.payload.chartData),Object.freeze(n)):Object.freeze(e)},notifications:
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e=[],t){let n=e;switch(t.type){case Sn.a:t.payload&&t.payload.notifications&&(n=function(e=[],t){const n=[];return t.forEach(e=>{e.forRecord&&n.push(e.forRecord)}),e.filter(e=>!e.forRecord||!n.find(t=>vn.a.equals(t,e.forRecord))).concat(t)}(e,t.payload.notifications));break;case Sn.c:t.meta&&(n=function(e=[],t){return e.filter(e=>!e.forRecord||!vn.a.equals(e.forRecord,t))}(e,t.meta))}return Object.freeze(n)},entityFilters:function(e=Cn,t){if(!t||-1===On.indexOf(t.type)||!t.payload||!t.payload.entityFilters)return e;const n=Object.assign(Object.assign({},e),t.payload.entityFilters);return Object.freeze(n)},files:function(e=wn,t){if(!t||-1===In.indexOf(t.type)||!t.payload)return e;const n=Object.assign({},e);return t.type===En.a?function(e,t){const n=t.payload.identifier;let r=Object.assign({},e);if(n){const a=n.etn,i=j.a.toString(n.id),o=t.payload.attributeName,s=t.payload.fileState,c={[i]:{[o]:s}},l={[a]:c};let u=Object.assign({},e);if(u)if(u[a])if(u[a][i]){const e=Object.assign(Object.assign({},u[a][i]),{[o]:s}),t=Object.assign(Object.assign({},u[a]),{[i]:e});u=Object.assign(Object.assign({},u),{[a]:t})}else{const e=Object.assign(Object.assign({},u[a]),c);u=Object.assign(Object.assign({},u),{[a]:e})}else{const e=Object.assign(Object.assign({},u[a]),c);u=Object.assign(Object.assign({},u),{[a]:e})}else u=Object.assign(Object.assign({},u),l);r=Object.assign({},u)}return Object.freeze(r)}(n,t):Object.freeze(n)}};Object(O.a)(Tn);var Nn=n("zVFX"),An=n("q0Q1");function Dn(e,t){switch(t.type){case An.a:return t.payload;default:return e}}function Rn(){return{type:"deviceSize.retrieve",payload:{deviceWidth:Math.max(document.documentElement.clientWidth,window.innerWidth||0),deviceHeight:Math.max(document.documentElement.clientHeight,window.innerHeight||0)}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const xn={deviceWidth:1280};function Mn(e=xn,t){switch(t.type){case"deviceSize.retrieve":return Object.freeze(Object.assign(Object.assign({},e),t.payload));default:return e}}var Fn=n("9gmQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const kn={};function Ln(e=kn,t){switch(t.type){case Fn.a:return e=Object.assign(Object.assign({},e),t.payload),Object.freeze(e);default:return e}}var Bn=n("zwYV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Un={};function Vn(e=Un,t){switch(t.type){case Bn.a:return e=zn(e,t,!0),Object.freeze(e);case Bn.c:return e=zn(e,t,!1),Object.freeze(e);case Bn.b:return e=Object.assign(Object.assign({},e),{knownProperties:t.payload}),Object.freeze(e);case Bn.d:return e=Object.assign(Object.assign({},e),{availableContexts:t.payload}),Object.freeze(e);case Bn.e:return e=Object.assign(Object.assign({},e),{knownProperties:Object.assign(Object.assign({},e.knownProperties),{[t.payload.contextId]:Object.assign(Object.assign({},e.knownProperties[t.payload.contextId]),{[t.payload.propertyId]:t.payload.value?t.payload.value.value:void 0})})}),Object.freeze(e);default:return e}}function zn(e=Un,t,n){const r=e.propertyListeners&&e.propertyListeners[t.payload.contextId],a=r&&r[t.payload.propertyId],i=n?function(e=[],t){return-1===e.findIndex(e=>e===t)?[...e,t]:e}(a,t.payload.listener):function(e=[],t){return e.filter(e=>e!==t)}(a,t.payload.listener);return Object.assign(Object.assign({},e),{propertyListeners:Object.assign(Object.assign({},e.propertyListeners),{[t.payload.contextId]:Object.assign(Object.assign({},r),{[t.payload.propertyId]:i})})})}var Wn=n("D6Jg"),qn=n("ZUus");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Hn=Object.freeze({isPreviewMode:!1,navbar:qn.a.On,cmdbar:!0,performanceUiEnabled:!1,sitemap:!0,flags:{}});function Gn(e=Hn,t){switch(t.type){case Wn.a:return Object.freeze(Object.assign(Object.assign({},e),t.payload));case S.a:return Object.freeze(Object.assign(Object.assign({},e),{performanceUiEnabled:t.payload}));default:return e}}var Kn=n("83Lp"),Qn=n("xM/W"),Xn=n("CvZq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Yn=Object.freeze({isReconnectNotificationShown:!1,showReconnectNotificationAfterUpsync:!1,isServerUnavailableNewSession:!0,type:Xn.a.NonBlockingUI,isReconnectSuccessful:!0});function Jn(e=Yn,t){switch(t.type){case Kn.d:case Kn.b:case Kn.a:case Kn.c:case Qn.a:return Object.freeze(Object.assign(Object.assign({},e),t.payload));default:return e}}var $n=n("Tf+h");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Zn=[$n.f,$n.h,$n.e,$n.g,$n.d];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const er=[n("kX6F").a,G.b];var tr=n("JEGW");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const nr={controls:function(e=null,t){if(-1===Zn.indexOf(t.type)||!t.payload)return e;const n=Object.assign({},e),{payload:r,meta:a}=t;return function e(t,n,r,a){t.hasOwnProperty(r)&&r!==a?e(t[r],n[r],Object.keys(n[r])[0],a):t[r]=n[r]}(n,r,Object.keys(r)[0],a.lastPropertyKey),Object.freeze(n)},selectedForms:function(e=null,t){if(!t||!t.payload||!t.payload.selectedForms||-1===er.indexOf(t.type))return e;const n=t.payload.selectedForms;let r=null;r=Object.assign({},e);for(const e of Object.keys(n))r[e]=n[e];return Object.freeze(r)},recordSetNavigatorCollapse:function(e=!0,t){return t.type===tr.a?t.payload.collapsed:e}},rr=Object(O.a)(nr);var ar=n("Kvn0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const ir={dataById:{},workflowObjectModelLibraryLoaded:!1},or=[ar.a,ar.c,ar.b];function sr(e=ir,t){if(-1===or.indexOf(t.type)||!t.payload)return e;const n=Object.assign({},e);if(t.payload.dataById)for(const e of Object.keys(t.payload.dataById))(e!==j.a.EMPTYGUIDSTRING||t.payload.dataById[e])&&n.dataById.hasOwnProperty(e)?n.dataById[e]=Object.assign(Object.assign({},n.dataById[e]),t.payload.dataById[e]):n.dataById[e]=t.payload.dataById[e];else t.payload.displayState?n.displayState=t.payload.displayState:t.payload.workflowObjectModelLibraryLoaded&&(n.workflowObjectModelLibraryLoaded=t.payload.workflowObjectModelLibraryLoaded);return Object.freeze(n)}var cr=n("mpSO"),lr=n("7Mzt"),ur=n("I4Rv"),dr=n("P86a");const pr=Object(O.b)("controlId",(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){switch(t.type){case pe.j:case pe.f:case pe.e:return Object.assign(Object.assign({},e),t.payload);default:return e}}));const gr=Object(O.d)({[cr.i]:(e,t)=>t.payload.initializationState},dr.a.Uninitialized);const hr=Object(O.b)("flyoutControlId",(function(e,t){switch(t.type){case pe.p:return Object.assign(Object.assign({},e),t.payload.injectedXML);default:return e}})),fr=Object(O.a)({controlsMap:function(e,t){let n=Object.assign({},e);switch(t.type){case pe.k:return t.payload.stateUpdates.forEach(e=>{n=Object.assign(Object.assign({},n),pr(n,e))}),n;case pe.d:return t.payload.evaluatedRules.forEach(e=>{n=Object.assign(Object.assign({},n),pr(n,e))}),n;default:return e}},initializationState:gr,ruleContext:function(e,t){switch(t.type){case pe.s:return Object.assign(Object.assign({},e),t.payload.ruleContext);default:return e}},ribbonId:function(e,t){switch(t.type){case pe.r:return t.payload.ribbonId;default:return e}},injectedXML:hr,contextToken:function(e,t){switch(t.type){case pe.n:return Object.assign(Object.assign({},e),t.payload.contextToken);default:return e}},createdScriptContainer:function(e,t){switch(t.type){case pe.o:return t.payload.createdScriptContainer;default:return e}},controlAllowList:function(e,t){switch(t.type){case pe.m:return t.payload.controlAllowList?Object.assign({},t.payload.controlAllowList):null;default:return e}},nonCacheableRules:function(e,t){switch(t.type){case pe.q:return Object.assign(Object.assign({},e),t.payload.nonCacheableRules);default:return e}},pageId:function(e,t){switch(t.type){case ur.a:return t.payload;default:return e}},addedCommandList:function(e,t){switch(t.type){case cr.k:return t.payload;default:return e}},appendedCommandList:function(e,t){switch(t.type){case cr.l:return t.payload;default:return e}},balloonButtonCounts:function(e,t){switch(t.type){case cr.h:return Object.freeze(Object.assign(Object.assign({},e),t.payload));default:return e}}}),mr=Object(O.b)("commandManagerId",fr);function br(e,t){switch(t.type){case pe.a:return function(e,t){switch(t.type){case pe.a:const n=t.payload;if(!n||0===n.length)return e;const r={};for(const t in e)-1===n.indexOf(t)&&(r[t]=e[t]);return r;default:return e}}(e,t);case lr.a:return function(e,t){return Object.freeze(Object.assign(Object.assign({},e),{perfRenderCmdBar:t.payload.perfRenderCmdBar}))}(e,t);default:return mr(e,t)}}var _r=n("/J/l");const yr={records:null,relevanceRecords:null,totalCountString:"",currentSearchText:"",controlStateId:"",isControlDisabled:!1,searchWidgetActionResult:null,selectedResult:"",filterQueryParams:null,numberOfResults:null,blockClick:null},vr={list:{}},Sr=[_r.e,_r.g,_r.a,_r.b,_r.c,_r.f,_r.d];function Or(e=vr,t){if(-1===Sr.indexOf(t.type)||!t||!t.meta.contextKey)return e;const n=t.meta.contextKey;n in e.list||(e.list[n]=Object.freeze(Object.assign({},yr)));const r=j.a.toString(j.a.newGuid());let a;switch(t.type){case _r.e:a=Object.freeze(Object.assign(Object.assign({},e.list[n]),{currentSearchText:t.payload.currentSearchText,controlStateId:t.payload.keyPhrasesString?r:e.list[n].controlStateId}));break;case _r.g:a=Object.freeze(Object.assign(Object.assign({},e.list[n]),{records:t.payload.records,totalCountString:t.payload.records?t.payload.records.length:"0",loading:!1,isInitializing:!1}));break;case _r.a:a=Object.freeze(Object.assign(Object.assign({},e.list[n]),{searchWidgetActionResult:t.payload,isInitializing:!1}));break;case _r.b:a=Object.freeze(Object.assign(Object.assign({},e.list[n]),{selectedResult:t.payload.selectedResult,isInitializing:!1}));break;case _r.c:a=Object.freeze(Object.assign(Object.assign({},e.list[n]),{filterQueryParams:t.payload.filterQueryParams,isInitializing:!1}));break;case _r.f:a=Object.freeze(Object.assign(Object.assign({},e.list[n]),{numberOfResults:t.payload.numberOfResults,controlStateId:r,isInitializing:!1}));break;case _r.d:a=Object.freeze(Object.assign(Object.assign({},e.list[n]),{blockClick:t.payload.blockClick,controlStateId:r,isInitializing:!1}));break;default:a=e.list[n]}const i={};return i[n]=a,Object.freeze({list:Object.assign(Object.assign({},e.list),i)})}var Cr=n("uUCw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Er={type:null,installationId:null,subtype:null,version:null,deviceModel:null,deviceTelemetryParams:null};function Ir(e=Er,t){switch(t.type){case Cr.a:return Object.assign(Object.assign({},e),{type:t.payload});case Cr.d:return Object.assign(Object.assign({},e),{installationId:t.payload});case Cr.e:return Object.assign(Object.assign({},e),{subtype:t.payload});case Cr.f:return Object.assign(Object.assign({},e),{version:t.payload});case Cr.b:return Object.assign(Object.assign({},e),{deviceModel:t.payload});case Cr.c:return Object.assign(Object.assign({},e),{deviceTelemetryParams:t.payload});default:return e}}var wr=n("K9oF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const jr={token:void 0,objectid:void 0,tenantid:void 0};function Pr(e=jr,t){switch(t.type){case wr.c:return Object.assign(Object.assign({},e),{token:t.payload});case wr.a:return Object.assign(Object.assign({},e),{objectid:t.payload});case wr.b:return Object.assign(Object.assign({},e),{tenantid:t.payload});default:return e}}var Tr=n("SX+A"),Nr=n("sclX"),Ar=n("wJNo");function Dr(e){return{type:"deviceSettings.initialize",payload:e}}var Rr=n("db6h");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const xr={};const Mr={features:function(e=xr,t){switch(t.type){case"deviceSettings.initialize":return Object.keys(t.payload).forEach(n=>{e=Object.assign(Object.assign({},e),{[n]:Object.assign(Object.assign({},e[n]),t.payload[n])})}),Object.freeze(e);case Ar.a:return e=Object.assign(Object.assign({},e),t.payload),Object.freeze(e);case Rr.a:return Object.keys(t.payload).forEach(n=>{e=Object.assign(Object.assign({},e),{[n]:Object.assign(Object.assign({},e[n]),t.payload[n])})}),Object.freeze(e);default:return e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */,type:function(e=Nr.b.Web,t){switch(t.type){case Tr.b:return t.payload.type;default:return e}},state:function(e=Nr.a.Active,t){switch(t.type){case Tr.b:return t.payload.state;case Tr.a:return t.payload;default:return e}}},Fr=Object(O.a)(Mr);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var kr;!function(e){e[e.Day=0]="Day",e[e.Week=1]="Week",e[e.Month=2]="Month"}(kr||(kr={}));var Lr=n("omKH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Br={defaultCalendarView:kr.Day,recordsPerPage:50,timeZoneCode:0,workDayStartTime:"",workDayStopTime:""};var Ur=n("ORpD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Vr={toastNotification:null};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const zr={personalSettingsForMobileApp:function(e=Br,t){switch(t.type){case Lr.a:return e=Object.assign(Object.assign({},e),t.payload),Object.freeze(e);default:return e}},userAccessibilitySettings:function(e=Vr,t){switch(t.type){case Ur.a:return e=Object.assign(Object.assign({},e),t.payload),Object.freeze(e);default:return e}}},Wr=Object(O.a)(zr);var qr=n("bwbe"),Hr=n("uCpV"),Gr=n("uWQm"),Kr=n("A2T2");function Qr(e){return{type:"recentItem.lastsynced.update",payload:e}}var Xr=n("mPrU"),Yr=n("2bwe");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Jr={lastSynced:null,recentItems:[],deletedRecentItems:[],flyoutRecentsDescriptor:null,dropdownRecentsDescriptor:null};function $r(e=Jr,t){let n;switch(t.type){case Hr.a:n=function(e,t){const n=e.recentItems,r=t.payload,a=n.findIndex(e=>e.ObjectId.guid===r.ObjectId.guid);let i;if(a>=0){const e=Object.assign(Object.assign({},r),{PinStatus:n[a].PinStatus});s=e,c=a,i=[...(o=n).slice(0,c),s,...o.slice(c+1)]}else i=aa(n,r);var o,s,c;return Object.assign(Object.assign({},e),{recentItems:i})}(e,t);break;case Gr.a:n=Zr(e,[t.payload.id],t.payload.isOnline);break;case Gr.b:n=Zr(e,t.payload.ids,t.payload.isOnline);break;case Kr.a:n=na(e,t.payload,!0);break;case Kr.b:n=na(e,t.payload,!1);break;case Xr.a:n=function(e,t){const{flyoutRecentsDescriptor:n}=e;if(!t.payload.isVisible||n&&n.isVisible&&n.relativeToEntryId===t.payload.relativeToEntryId)return function(e){const{flyoutRecentsDescriptor:t}=e,n=Object.assign({},t);return n.isVisible=!1,Object.assign(Object.assign({},e),{flyoutRecentsDescriptor:n})}(e);return Object.assign(Object.assign({},e),{flyoutRecentsDescriptor:t.payload})}(e,t);break;case Yr.a:n=function(e,t){const{dropdownRecentsDescriptor:n}=e;if(n&&n.isOpened&&n.relativeToEntryId===t.payload.relativeToEntryId)return function(e){const{dropdownRecentsDescriptor:t}=e,n=Object.assign({},t);return n.isOpened=!1,Object.assign(Object.assign({},e),{dropdownRecentsDescriptor:n})}(e);return function(e,t){const n=Object.assign(Object.assign({},t),{isOpened:!0});return Object.assign(Object.assign({},e),{dropdownRecentsDescriptor:n})}(e,t.payload)}(e,t);break;case qr.a:n=function(e,t){const n=e.recentItems,r=ea(t.oldRecents,n),a=ea(n,t.oldRecents),i=[...ea(t.newRecents,r),...a],o=function(e,t){const n={};[...e,...t].reduce((e,t)=>{if(t){const n=e[t.ObjectId.guid];!n||void 0!==n.PinStatus&&null!==n.PinStatus&&void 0!==t.PinStatus&&null!==t.PinStatus||(void 0!==t.PinStatus&&null!==t.PinStatus?n.PinStatus=t.PinStatus:void 0!==n.PinStatus&&null!==n.PinStatus&&(t.PinStatus=n.PinStatus)),e[t.ObjectId.guid]=!n||n.LastAccessed<t.LastAccessed?t:n}return e},n);const r=Object.keys(n).map(e=>n[e]),a=ta(r.filter(e=>!0===e.PinStatus),25),i=ta(r.filter(e=>!e.PinStatus),50);return[...a,...i]}(n,i);return Object.assign(Object.assign({},e),{recentItems:o})}(e,t.payload);break;case"recentItem.removeRecentItemsFromState":n=function(e,t){if(!t||!t.length)return e;const n=ea(e.deletedRecentItems,t),r=ea(e.recentItems,t);return Object.assign(Object.assign({},e),{deletedRecentItems:n,recentItems:r})}(e,t.payload);break;case"recentItem.lastsynced.update":n=function(e,t){const{lastSynced:n}=e,r=t.payload>n?t.payload:n;return Object.assign(Object.assign({},e),{lastSynced:r})}(e,t);break;default:return e}return Object.freeze(n)}function Zr(e,t,n){const r=[],a=[...e.deletedRecentItems],i=e.recentItems;return i&&i.forEach(e=>{t.some(t=>j.a.equals(e.ObjectId,t))?n&&a.push(e):r.push(e)}),Object.assign(Object.assign({},e),{recentItems:r,deletedRecentItems:a})}function ea(e,t){return e.filter(e=>!t.some(t=>j.a.equals(e.ObjectId,t.ObjectId)))}function ta(e,t){if(e.length<=t)return e;return e.sort((e,t)=>+e.LastAccessed-+t.LastAccessed).splice(e.length-t)}function na(e,t,n){const r=e.recentItems,a=r.findIndex(e=>e.ObjectId.guid===t.ObjectId.guid);if(a<0)return console.error("Attempting change pin status for item which is not in state. Item: "+JSON.stringify(t)),e;const i=aa([...r.slice(0,a),...r.slice(a+1)],Object.assign(Object.assign({},t),{PinStatus:n,LastAccessed:new Date}));return Object.assign(Object.assign({},e),{recentItems:i})}function ra(e,t,n){return e.push(t),ta(e,n)}function aa(e,t){let n=e.filter(e=>!0===e.PinStatus),r=e.filter(e=>!e.PinStatus);return t.PinStatus?n=ra(n,t,25):r=ra(r,t,50),[...n,...r]}var ia=n("FETf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const oa={},sa=[ia.d,ia.b,ia.c,ia.e,ia.l,ia.k,ia.f,ia.j,ia.m,ia.i];function ca(e=oa,t){if(-1===sa.indexOf(t.type)||!t||!t.payload||!t.type)return e;const n=Object.assign({},e);switch(t.type){case ia.d:n[t.payload.id]=Object.assign({},t.payload.timlineWallResetDataState);break;case ia.b:n[t.payload.id]=Object.assign({},n[t.payload.id]),n[t.payload.id].dataQueues=Object.assign(Object.assign({},n[t.payload.id].dataQueues),t.payload.timlineWallInitDataState.dataQueues),n[t.payload.id].requestStatusMap=Object.assign(Object.assign({},n[t.payload.id].requestStatusMap),t.payload.timlineWallInitDataState.requestStatusMap);break;case ia.c:n[t.payload.id]=Object.assign({},n[t.payload.id]),n[t.payload.id].dataQueues=Object.assign(Object.assign({},n[t.payload.id].dataQueues),t.payload.dataQueues);break;case ia.e:n[t.payload.id]=Object.assign({},n[t.payload.id]),n[t.payload.id].requestStatusMap=Object.assign(Object.assign({},n[t.payload.id].requestStatusMap),t.payload.timlineWallDataState.requestStatusMap),n[t.payload.id].target=Object.assign(Object.assign({},n[t.payload.id].target),t.payload.timlineWallDataState.target);break;case ia.l:n[t.payload.id]=Object.assign({},n[t.payload.id]),n[t.payload.id].recordLastAccessedTime=t.payload.recordLastAccessedTime;break;case ia.k:n[t.payload.id]=Object.assign({},n[t.payload.id]),n[t.payload.id].entityRecentItems=Object.assign(Object.assign({},n[t.payload.id].entityRecentItems),t.payload.entityRecentItems);break;case ia.f:n[t.payload.id]=Object.assign({},n[t.payload.id]),n[t.payload.id].isMetadataRetrievalError=t.payload.isMetadataRetrievalError;break;case ia.j:n[t.payload.id]=Object.assign({},n[t.payload.id]),n[t.payload.id].isNotesAnalysisEnabled=t.payload.isNotesAnalysisEnabled;break;case ia.m:n[t.payload.id]=Object.assign({},n[t.payload.id]),n[t.payload.id].target=Object.assign(Object.assign({},n[t.payload.id].target),t.payload.target);break;case ia.i:n[t.payload.id]=Object.assign({},n[t.payload.id]),n[t.payload.id].contextualDialogEntityData=Object.assign(Object.assign({},n[t.payload.id].contextualDialogEntityData),t.payload.contextualDialogEntityData)}return Object.freeze(n)}var la=n("c/eZ"),ua=n("bvqZ"),da=n("sHzf"),pa=n("XZPR");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function ga(e={},t){switch(t.type){case ua.a:return function(e,t){return Object.freeze(Object.assign(Object.assign({},e),{[t.payload.props.id]:t.payload}))}(e,t);case da.REMOVE_TOAST_NOTIFICATION_ACTION:return function(e,t){const n=e,r=t.payload,a=(n[r],Object(la.__rest)(n,["symbol"==typeof r?r:r+""]));return Object.freeze(a)}(e,t);case pa.a:return Object.freeze({});default:return e}}var ha=n("XIaj"),fa=n("yGgp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function ma(e={},t){switch(t.type){case ha.a:return function(e,t){const n={[t.payload.props.id]:t.payload};return Object.freeze(Object.assign(Object.assign({},e),n))}(e,t);case fa.a:return function(e,t){const n=e,r=t.payload,a=(n[r],Object(la.__rest)(n,["symbol"==typeof r?r:r+""]));return Object.freeze(a)}(e,t);default:return e}}var ba=n("jCkl"),_a=n("yJdb"),ya=n("LMh4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const va={inProgress:!1,progressMessage:null};function Sa(e=va,t){switch(t.type){case ba.a:case _a.a:case ya.a:return Object.freeze(Object.assign(Object.assign({},e),t.payload));default:return e}}var Oa=n("eL04"),Ca=n("P+p9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Ea(e={},t){switch(t.type){case Oa.a:return function(e,t){const n={[t.payload.props.id]:t.payload};return Object.freeze(Object.assign(Object.assign({},e),n))}(e,t);case Ca.a:return function(e,t){return delete(e=Object.assign({},e))[t.payload],Object.freeze(e)}(e,t);default:return e}}var Ia=n("Oz8S");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const wa={ribbons:Ia.d,entities:Ia.c},ja={metadata:Object(O.a)(wa),data:dn.c},Pa=Object(O.a)(ja);function Ta(e){return{type:"cache.set.codecachestatus",payload:{codeCacheState:e}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Na=Object.freeze({isCacheEnabled:!1,codeCacheState:1});function Aa(e=Na,t){switch(t.type){case"cache.setcachestatus":case"cache.set.codecachestatus":return Object.freeze(Object.assign(Object.assign({},e),t.payload));default:return e}}var Da=n("OpjU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Ra=[Da.a],xa=Object(O.c)(Ra,{isReauthInProgress:!1});function Ma(e,t){return{type:"session.hostData.set",payload:{key:e,value:t}}}const Fa=Object(O.a)({hostData:function(e=[],t){if("session.hostData.set"===t.type&&t.payload){const n=e.slice(0);return n.push({key:t.payload.key,value:t.payload.value}),Object.freeze(n)}return e},hostSubtype:function(e,t){if("session.hostSubtype.set"===t.type&&void 0!==t.payload)return t.payload;return e},hostType:function(e,t){if("session.hostType.set"===t.type&&void 0!==t.payload)return t.payload;return e},hostOptionInitialized:function(e,t){if("session.hostOptionsInitialized.set"===t.type&&void 0!==t.payload)return t.payload;return e}});var ka=n("LqfC"),La=n("/leX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Ba={};function Ua(e=Ba,t){const n=t.payload&&t.payload.sidePanelId;if(!n)return e;const r=e[n];let a=r;if(t.type===ka.d)r&&r.sidePanelLoadState!==La.a.NotStarted||(a=Object.assign(Object.assign({},t.payload),{sidePanelLoadState:La.a.Loading}));else if(t.type===ka.b){if(-1!==Object.keys(e).indexOf(n)){const t=e,r=n,a=(t[r],Object(la.__rest)(t,["symbol"==typeof r?r:r+""]));return Object.freeze(a)}}else a=function(e,t){const n=function(e,t){if(ka.e===t.type)return La.a.Completed;return e}(e.sidePanelLoadState,t),r=function(e,t){if(!t.payload)return e;const n=function(e,t){if(ka.g===t.type&&t.payload.sidePanelWidth)return t.payload.sidePanelWidth;return e}(e.sidePanelWidth,t),r=function(e,t){if(ka.g===t.type&&!Object(I.a)(t.payload.sidePanelState))return t.payload.sidePanelState;return e}(e.sidePanelState,t),a=function(e,t){if(ka.g===t.type&&!Object(I.a)(t.payload.sidePanelPosition))return t.payload.sidePanelPosition;return e}(e.sidePanelPosition,t),i=function(e,t){if(ka.g===t.type&&!Object(I.a)(t.payload.sidePanelTitle))return t.payload.sidePanelTitle;return e}(e.sidePanelTitle,t),o=function(e,t){if(ka.g===t.type&&!Object(I.a)(t.payload.canBeClosed))return t.payload.canBeClosed;return e}(e.canBeClosed,t),s=function(e,t){if(ka.g===t.type&&!Object(I.a)(t.payload.canBeCollapsed))return t.payload.canBeCollapsed;return e}(e.canBeCollapsed,t),c=function(e,t){if(ka.g===t.type&&!Object(I.a)(t.payload.isTitleStatic))return t.payload.isTitleStatic;return e}(e.isTitleStatic,t),l=function(e,t){if(ka.g===t.type&&!Object(I.a)(t.payload.showTitle))return t.payload.showTitle;return e}(e.showTitle,t);if(n!==e.sidePanelWidth||r!==e.sidePanelState||a!==e.sidePanelPosition||i!==e.sidePanelTitle||o!==e.canBeClosed||s!==e.canBeCollapsed||c!==e.isTitleStatic||l!==e.showTitle){const t={sidePanelWidth:n,sidePanelState:r,sidePanelPosition:a,sidePanelTitle:i,canBeClosed:o,canBeCollapsed:s,isTitleStatic:c,showTitle:l};return Object.freeze(Object.assign(Object.assign({},e),t))}return e}(e.option,{type:t.type,payload:t.payload.option});if(n!==e.sidePanelLoadState||r!==e.option)return Object.freeze(Object.assign(Object.assign({},e),{sidePanelLoadState:n,option:r}));return e}(r,t);return r!==a&&(e=Object.freeze(Object.assign(Object.assign({},e),{[n]:a}))),e}var Va=n("0FMG");const za={};function Wa(e=za,t){switch(t.type){case Va.a:const n=t.payload.selectedAreaId;if(n!==e.selectedAreaId)return Object.freeze(Object.assign(Object.assign({},e),{selectedAreaId:n}));break;case Va.b:const r=t.payload.selectedSubAreaId;if(r!==e.selectedSubAreaId)return Object.freeze(Object.assign(Object.assign({},e),{selectedSubAreaId:r}));break;case Va.c:const a=t.payload.sitemapExpandedState;if(a!==e.sitemapExpandedState)return Object.freeze(Object.assign(Object.assign({},e),{sitemapExpandedState:a}))}return e}var qa=n("W1cF"),Ha=n("23jc"),Ga=n("SRlt"),Ka=n("IqkD");function Qa(e){return{type:"relevancesearch.index.ready.set",payload:{indexReady:e}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Xa={lastSearchText:"",suggestions:[],suggestionsRetrievalPending:!1,isExpanded:!1,availableWidth:0,indexReady:!1};function Ya(e=Xa,t){switch(t.type){case qa.a:const{lastSearchText:n}=t.payload;if(n!==e.lastSearchText)return Object.freeze(Object.assign(Object.assign({},e),{lastSearchText:n}));break;case qa.d:const r=t.payload.suggestions.sort((e,t)=>e.document["@search.entityname"].localeCompare(t.document["@search.entityname"])).map(e=>{const t=e.document,{"@search.entityname":n,"@search.objectid":r,"@search.objecttypecode":a,entityimage_url:i}=t,o=Object(la.__rest)(t,["@search.entityname","@search.objectid","@search.objecttypecode","entityimage_url"]);return{suggestionInfo:{crmHitText:e.text,entityImageUrl:i,entityName:n,objectId:new j.a(r),objectTypeCode:a},record:o}});return Object.freeze(Object.assign(Object.assign({},e),{suggestions:r,suggestionsRetrievalPending:!1}));case"relevancesearch.index.ready.set":return Object.freeze(Object.assign(Object.assign({},e),{indexReady:!0}));case qa.e:return Object.freeze(Object.assign(Object.assign({},e),{suggestionsRetrievalPending:!0}));case qa.c:const{isExpanded:a}=t.payload;return Object.freeze(Object.assign(Object.assign({},e),{isExpanded:a}));case qa.b:const{availableWidth:i}=t.payload;return Object.freeze(Object.assign(Object.assign({},e),{availableWidth:i}))}return e}var Ja=n("txA/"),$a=n("FJpk");const Za={[$a.a]:{id:$a.a,focusedTabId:$a.b,anchorTabId:$a.b,title:void 0,icon:"",tabs:[$a.b],canBeClosed:!1,isFocusRequested:!1,iconTitle:""}};function ei(e=Za,t){const n=t.payload?t.payload.sessionId:void 0;if(n){const r=e[n],a=function(e={},t){const n=function(e,t){if(t.type===Ja.j)return t.payload.sessionId;return e}(e.id,t),r=function(e,t){if(t.type===Ja.mb||t.type===Ja.j)return t.payload.title;return e}(e.title,t),a=function(e,t){if(t.type===Ja.gb&&t.payload.isFocusRequested)return t.payload.isFocusRequested;if(t.type===Ja.j&&t.payload.isFocusRequested&&!1===t.payload.isFocused)return t.payload.isFocusRequested;if(t.type===Ja.s)return!1;return e}(e.isFocusRequested,t),i=function(e,t){if(t.type===Ja.eb||t.type===Ja.j)return!1!==t.payload.canBeClosed;return e}(e.canBeClosed,t),o=function(e=[],t){if(t.type===Ja.n||t.type===Ja.j){if(-1===e.indexOf(t.payload.tabId))return Object.freeze(e.concat(t.payload.tabId))}else if(t.type===Ja.g){const n=t.payload.tabId;if(-1!==e.indexOf(n))return e.filter(e=>e!==n)}return e}(e.tabs,t),s=function(e,t){if(t.type===Ja.n&&!1!==t.payload.isFocused&&t.payload.tabId)return t.payload.tabId;if(t.type===Ja.v||t.type===Ja.j){if(t.payload.tabId)return t.payload.tabId}else if(t.type===Ja.g&&t.payload.tabId===e.focusedTabId){const t=e.tabs.indexOf(e.focusedTabId);return e.tabs[(t+1)%e.tabs.length]}return e.focusedTabId}(e,t),c=function(e,t){if(t.type===Ja.j||t.type===Ja.ib)return t.payload.icon;return e}(e.icon,t),l=function(e,t){if(t.type===Ja.j||t.type===Ja.kb)return t.payload.iconTitle;return e}(e.iconTitle,t),u=function(e,t){if(t.type===Ja.j)return t.payload.tabId;return e}(e.anchorTabId,t);if(o!==e.tabs||s!==e.focusedTabId||i!==e.canBeClosed||r!==e.title||a!==e.isFocusRequested||n!==e.id||c!==e.icon||l!==e.iconTitle||u!==e.anchorTabId)return Object.freeze(Object.assign(Object.assign({},e),{id:n,tabs:o,focusedTabId:s,anchorTabId:u,canBeClosed:i,title:r,isFocusRequested:a,icon:c,iconTitle:l}));return e}(r,t);r!==a&&(e=Object.freeze(Object.assign(Object.assign({},e),{[n]:a})))}if(t.type===Ja.e){const t=Object.keys(e);if(t.indexOf(n)>=0){const r={};for(const a of t)a!==n&&(r[a]=e[a]);return Object.freeze(r)}}return e}var ti=n("eagp");const ni={modalComponentsOpenState:{}};function ri(e=ni,t){switch(t.type){case ti.b:{const n=t.payload.modalId;if(n&&!e.modalComponentsOpenState[n]){const t=Object.assign(Object.assign({},e.modalComponentsOpenState),{[n]:!0});return Object.assign(Object.assign({},e),{modalComponentsOpenState:t})}break}case ti.a:{const n=t.payload.modalId;if(n&&e.modalComponentsOpenState[n]){const t=Object.assign(Object.assign({},e.modalComponentsOpenState),{[n]:!1});return Object.assign(Object.assign({},e),{modalComponentsOpenState:t})}break}default:return e}return e}var ai=n("Zn5P");const ii={indicatorNotifications:[]};function oi(e=ii,t){const n=function(e,t){return t.payload?t.type===ai.a?[...e,t.payload]:t.type===ai.b?e.filter(e=>e.id!==t.payload):e:e}(e.indicatorNotifications,t);return n!==e.indicatorNotifications?Object.assign(Object.assign({},e),{indicatorNotifications:n}):e}var si=n("VnTQ");const ci={hideLongPressTooltip:!1,tooltipDismissCount:0};function li(e=ci,t){if(void 0===t.payload)return e;if(t.type===si.b){const n=t.payload;if(n.hideLongPressTooltip!==e.hideLongPressTooltip||n.tooltipDismissCount!==e.tooltipDismissCount){const t={};return void 0!==n.hideLongPressTooltip&&(t.hideLongPressTooltip=n.hideLongPressTooltip),void 0!==n.tooltipDismissCount&&(t.tooltipDismissCount=n.tooltipDismissCount),Object.assign(Object.assign({},e),t)}}if(t.type===si.a&&t.payload!==e.hideLongPressTooltip){return{hideLongPressTooltip:t.payload,tooltipDismissCount:t.payload?e.tooltipDismissCount+1:e.tooltipDismissCount}}return e}var ui=n("IYuw");const di=Object(O.a)({sitemapState:Wa,focusedSessionId:pi,defaultSessionId:gi,modalComponentState:ri,backNavTooltipState:li,indicatorNotificationState:oi,hideAppNameInTopBar:hi,globalSearchState:Ya});function pi(e=$a.a,t){return t.type===Ja.s&&t.payload.sessionId||t.type===Ja.j&&!1!==t.payload.isFocused&&t.payload.sessionId?t.payload.sessionId:e}function gi(e=$a.a,t){return e}function hi(e=!1,t){return t.type!==ui.a||Object(I.a)(t.payload.hideAppNameInTopBar)?e:t.payload.hideAppNameInTopBar}var fi=n("zzhk");const mi={[$a.b]:{id:$a.b,canBeClosed:!1}};function bi(e=mi,t){const n=t.payload&&(t.payload.tabId||t.payload.browsingContext);if(n){const r=e[n],a=function(e={},t){const n=function(e,t){if(t.type===Ja.n||t.type===Ja.j)return t.payload.tabId;return e}(e.id,t),r=function(e,t){if(t.type===Ja.n||t.type===Ja.ob)return!1!==t.payload.canBeClosed;if(t.type===Ja.j)return!1;return e}(e.canBeClosed,t),a=function(e,t){if(t.type===Ja.n||t.type===Ja.qb)return t.payload.title;return e}(e.title,t),i=function(e,t){if(t.type===Ja.n)return!!t.payload.isTitleStatic;return e}(e.isTitleStatic,t);if(n!==e.id||r!==e.canBeClosed||a!==e.title||i!==e.isTitleStatic)return Object.freeze(Object.assign(Object.assign({},e),{id:n,canBeClosed:r,title:a,isTitleStatic:i}));return e}(r,t);r!==a&&(e=Object.freeze(Object.assign(Object.assign({},e),{[n]:a})))}if(t.type===Ja.g){if(-1!==Object.keys(e).indexOf(n)){const t=e,r=n,a=(t[r],Object(la.__rest)(t,["symbol"==typeof r?r:r+""]));return Object.freeze(a)}}return e}var _i=n("1OTd"),yi=n("JHwY");var vi=n("m2nm");const Si={[$a.b]:{id:$a.b,pageId:"",error:void 0,dialogContextIds:[],history:[],pushHistoryToBrowser:!0,disableNavigateBack:!1}};function Oi(e=Si,t){if(t.type===_i.g){const n=t.payload&&t.payload.browsingContextId;if(n){const r={id:n,pageId:"",error:void 0,dialogContextIds:[],history:[],pushHistoryToBrowser:t.payload.pushHistoryToBrowser,disableNavigateBack:!1};return Object.freeze(Object.assign(Object.assign({},e),{[n]:r}))}}if(t.type===_i.c){const n=t.payload&&t.payload.browsingContextId;if(-1!==Object.keys(e).indexOf(n)){const t=e,r=n,a=(t[r],Object(la.__rest)(t,["symbol"==typeof r?r:r+""]));return Object.freeze(a)}}const n=t.payload&&t.payload.browsingContextId;if(n){const r=e[n],a=function(e,t){const n=function(e,t){if(t.type===_i.q)return t.payload.currentPage;return e}(e.pageId,t),r=function(e,t){if(t.type===_i.q)return t.payload.error;return e}(e.error,t),a=function(e=[],t){switch(t.type){case Ja.a:return Object.freeze(e.concat({state:t.payload.state,url:t.payload.url}));case Ja.Y:{const n={state:t.payload.state,url:t.payload.url};return 0===e.length?[n]:Object.freeze(e.map((t,r)=>r===e.length-1?n:t))}case Ja.b:return Object.freeze(e.slice(0,e.length-1));case Ja.d:if(e.length>1)return Object.freeze(e.slice(e.length-1,e.length));case Ja.X:return Object.freeze(t.payload.history);default:return e}}(e.history,t),i=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){if(t.type===yi.a)return Object.freeze(t.payload.dialogContextIds);if(t.type===_i.a){const n=t.payload.dialogContextId,r=e.filter(e=>e!==n);return r.push(n),Object.freeze(r)}return t.type===_i.n?Object.freeze(e.filter(e=>e!==t.payload.dialogContextId)):e}(e.dialogContextIds,t),o=function(e=!1,t){if(t.type===vi.a&&void 0!==t.payload.disableNavigateBack)return t.payload.disableNavigateBack;return e}(e.disableNavigateBack,t);if(a!==e.history||n!==e.pageId||r!==e.error||i!==e.dialogContextIds||o!==e.disableNavigateBack)return Object.freeze(Object.assign(Object.assign({},e),{pageId:n,error:r,history:a,dialogContextIds:i,disableNavigateBack:o}));return e}(r,t);r!==a&&(e=Object.freeze(Object.assign(Object.assign({},e),{[n]:a})))}return e}var Ci=n("bo6D"),Ei=n("xE5/"),Ii=n("d/SG"),wi=n("QT+q"),ji=n("9eA9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Pi=new ji.a(window.location.href),Ti=Pi.searchParams.has(wi.c)&&"true"===Pi.searchParams.get(wi.c).toLowerCase(),Ni=Object.freeze({isOpen:Ti});function Ai(e=Ni,t){switch(t.type){case Ci.a:return Object.freeze({isOpen:!0});case Ei.a:return Object.freeze({isOpen:!1});case Ii.a:return Object.freeze({isOpen:!e.isOpen});default:return e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Di(e={},t){if(t.type===_i.i){const n=t.payload&&t.payload.dialogContextId;if(n){const r={dialogContextId:n,contentPageId:t.payload.pageId,pageStack:[t.payload.pageId]};return Object.freeze(Object.assign(Object.assign({},e),{[n]:r}))}}if(t.type===_i.d){const n=t.payload&&t.payload.dialogContextId;if(-1!==Object.keys(e).indexOf(n)){const t=e,r=n,a=(t[r],Object(la.__rest)(t,["symbol"==typeof r?r:r+""]));return Object.freeze(a)}}const n=t.payload&&t.payload.dialogContextId;if(n&&e[n]){const r=e[n],a=function(e,t){const n=function(e=[],t){if(t.type===_i.p)return Object.freeze(e.filter(e=>e!==t.payload.pageId));if(t.type===_i.s)return[...e,t.payload.pageId];return e}(e.pageStack,t),r=function(e,t,n){if(n.type===_i.s)return n.payload.pageId;if(n.type===_i.p)return t.length>0?t[t.length-1]:void 0;return e}(e.contentPageId,n,t);if(n!==e.pageStack||r!==e.contentPageId)return Object.freeze(Object.assign(Object.assign({},e),{dialogContextId:e.dialogContextId,contentPageId:r,pageStack:n}));return e}(r,t);r!==a&&(e=Object.freeze(Object.assign(Object.assign({},e),{[n]:a})))}return e}var Ri=n("p/Kg");const xi=Object(O.d)({[Ri.a]:function(e,t){if(t.meta&&t.meta.pageToEditedViewMapId&&t.meta.viewId){const n=t.meta.pageToEditedViewMapId,r={fetchXml:t.payload.fetchXml};t.payload.gridDescriptor&&(r.gridDescriptor=t.payload.gridDescriptor);const a=e[n],i=a&&a[t.meta.viewId],o=Object.freeze(Object.assign(Object.assign({},i),r)),s=Object.freeze(Object.assign(Object.assign({},a),{[t.meta.viewId]:o}));return Object.freeze(Object.assign(Object.assign({},e),{[n]:s}))}return e},[Ri.b]:function(e,t){if(t.meta&&t.meta.pageToEditedViewMapId&&t.meta.viewId){const n=t.meta.pageToEditedViewMapId;let r=Object.assign({},e);const a=Object.assign({},r[n]);if(a){Object.keys(a).forEach(e=>{e===t.meta.viewId&&delete a[e]})}if(0===Object.keys(a).length){Object.keys(r).forEach(e=>{e===t.meta.pageToEditedViewMapId&&delete r[e]})}else r=Object.assign(Object.assign({},e),{[n]:a});return Object.freeze(r)}return e}},{});var Mi=n("7cfk"),Fi=n("P4TJ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ki={initialized:Mi.a.Not_Initialized,bundleLoaded:!1};function Li(e=ki,t){switch(t.type){case Fi.b:case Fi.c:return Object.freeze(Object.assign(Object.assign({},e),{initialized:t.payload.initialized,error:t.payload.error}));case Fi.a:return Object.freeze(Object.assign(Object.assign({},e),{bundleLoaded:t.payload}));default:return e}}class Bi{constructor(e){this._context=e,this._key="uci-state-"+(function(){const e=new ji.a(window.location.href).searchParams.get("channelId");if(!e)return null;return e}()||"default")}persistState(e){var t,n;try{if(e){const t=JSON.stringify(e,Ui);window.localStorage.setItem(this._key,t)}else null===(t=this._context.EventManager)||void 0===t||t.ReportComponentFailure("LocalStorageStatePersistence.persistState",Object(d.d)(`Unexpected value of ${e} for input parameter "state"`))}catch(e){null===(n=this._context.EventManager)||void 0===n||n.ReportComponentFailure("LocalStorageStatePersistence.persistState",e)}}retrieveState(){var e;try{const e=window.localStorage.getItem(this._key);if(e){const t=JSON.parse(e,Vi);return Promise.resolve(t)}}catch(t){throw null===(e=this._context.EventManager)||void 0===e||e.ReportComponentFailure("LocalStorageStatePersistence.retrieveState",t),t}}clearState(){return new Promise((e,t)=>{var n,r,a;try{window.localStorage.removeItem(this._key),null===(n=this._context.EventManager)||void 0===n||n.ReportComponentSuccess("LocalStorageStatePersistence.clearState",[{name:"key",value:this._key}]),e()}catch(e){null===(a=null===(r=this._context)||void 0===r?void 0:r.EventManager)||void 0===a||a.ReportComponentFailure("LocalStorageStatePersistence.clearState",e),t(e)}})}}function Ui(e,t){return"[object Date]"===Object.prototype.toString.call(this[e])?"$$IsDate$$"+this[e].toISOString():"object"==typeof this[e]&&this[e]instanceof Set?"$$IsSet$$"+JSON.stringify(Array.from(this[e])):t}function Vi(e,t){return"string"==typeof t&&t.includes("$$IsDate$$")?new Date(t.split("$$IsDate$$")[1]):"string"==typeof t&&t.includes("$$IsSet$$")?new Set(JSON.parse(t.split("$$IsSet$$")[1])):t}var zi=n("pF61");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Wi(){const e=new ji.a(window.location.href),t=e.searchParams.get("flags");if(t){const n=Object(Wn.d)(t),r=Object(Wn.c)(n.restore);if(void 0!==r)return r;const a=Object(Wn.c)(n.embedded),i=e.searchParams.get("channelId");if(a&&i)return!0}return!1}var qi=n("QbIY"),Hi=n("Lyxw"),Gi=n("3/02"),Ki=n("+nTZ");class Qi{constructor(e){this._context=e,this._statePersistence=new Bi(e),this._persistState=this._persistState.bind(this),this._queuePersistStateOnAppIdle=this._queuePersistStateOnAppIdle.bind(this),this._throttledPersistState=$i(this._persistState)}get shouldRestoreState(){return this._restoredState&&Wi()}static getInstance(e){return Qi._instance||(Qi._instance=new Qi(e)),Qi._instance}initialize(e,t){this._store=e,this._restoredState=t}handleBootSuccess(){if(Wi()){Object(Hi.c)(this._store.getState(),Gi.qd)?(this._store.dispatch((e=$i(this._queuePersistStateOnAppIdle),{type:"initialize.state.persistence",execute:(t,n)=>new Promise(n=>{t.subscribe(e=>e.pages,e),t.subscribe(e=>e.router,e),t.subscribe(e=>e.data.snapshots,e),t.subscribe(e=>e.sessions,e),t.subscribe(e=>e.tabs,e),t.subscribe(e=>e.browsingContexts,e),t.subscribe(e=>e.appShellState,e),t.subscribe(e=>e.personalizations,e),t.subscribe(e=>e.editedViews,e),Object(Hi.c)(t.getState(),Gi.pd)&&t.subscribe(e=>e.dialogContexts,e),n()}),shouldReceiveFullStore:!0})),this._persistState(),this._logTelemetry("handleBootSuccess")):this._statePersistence.clearState(),this._restoredState=null}var e}handleBootError(){Wi()&&(this._statePersistence.clearState(),this._logTelemetry("handleBootError"))}retrievePersistedState(){if(Wi())return this._statePersistence.retrieveState()}restoreRouter(){if(this.shouldRestoreState){const e=this._restoredState;this._restoreRouterPromises=this._context.Router.restoreRouter(e)}}async initializePages(){if(this._restoreRouterPromises)for(const e of Object.values(this._restoreRouterPromises).reverse()){const t=await e;await t()}this.shouldRestoreState&&!Object(zi.c)(this._store.getState())&&await this._store.dispatch(Object(qi.b)())}_logTelemetry(e){var t;const n=[];this._restoredState&&n.push({name:"size",value:JSON.stringify(this._restoredState).length}),null===(t=this._context.EventManager)||void 0===t||t.ReportComponentSuccess("RestoreStateManager."+e,n)}_retrieveStateToSerialize(){return function(e){const{snapshots:t,lastSnapshotNumber:n}=e.data;return{router:e.router,pages:Xi(e),data:{snapshots:t,lastSnapshotNumber:n},sessions:e.sessions,tabs:e.tabs,browsingContexts:Yi(e),dialogContexts:Ji(e),appShellState:e.appShellState,personalizations:e.personalizations,editedViews:e.editedViews}}(this._store.getState())}_persistState(){const e=this._retrieveStateToSerialize();this._statePersistence.persistState(e)}_queuePersistStateOnAppIdle(){Object(M.b)(this._throttledPersistState,"persistUciState")}}function Xi(e){const t={};for(const[n,r]of Object.entries(e.pages))Object(zi.n)(e,n)||!Object(Hi.c)(e,Gi.pd)&&Object(Ki.b)(e,n)||(t[n]=Object.assign(Object.assign({},r),{isPageUnmounted:!0}));return t}function Yi(e){if(Object(Hi.c)(e,Gi.pd))return e.browsingContexts;const t={};for(const[n,r]of Object.entries(e.browsingContexts)){const{dialogContextIds:e}=r,a=Object(la.__rest)(r,["dialogContextIds"]);t[n]=Object.assign(Object.assign({},a),{dialogContextIds:[]})}return t}function Ji(e){if(Object(Hi.c)(e,Gi.pd))return e.dialogContexts}function $i(e,t=100){let n=-1;return function(...r){-1===n&&(e.apply(this,r),n=setTimeout(()=>{n=-1},t))}}var Zi=n("Eq/9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const eo={};function to(e=eo,t){switch(t.type){case Zi.a:const n=t.payload.name,r=t.payload.state;return e=Object.assign(Object.assign({},e),{[n]:Object.assign(Object.assign({},e[n]),r)}),Object.freeze(e);default:return e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let no;function ro(e,t){!
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){if(t.type===D.b){const n=t.meta.pageId;n&&Object(M.b)(()=>{e.dispatch(Object(R.c)(n)),e.dispatch(Object(x.a)(n))},"Garbage collection")}}(e,t),
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){t.type===F.a&&Object(k.a)(e.getState())}(e,t),function(e,t){no?no(e,t):Object(fi.b)(e.getState())&&Promise.all([n.e(0),n.e(27),n.e(30),n.e(103)]).then(n.bind(null,"lq5R")).then(({sitemapPanelActionInspector:n})=>{no=n,n(e,t)})}(e,t)}var ao,io=n("YVjE");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.UnhandledError=0]="UnhandledError",e[e.UnhandledRejection=1]="UnhandledRejection"}(ao||(ao={}));var oo=n("4aOd"),so=n("H4dV");class co{constructor(e){this._eventHandlers=[],this._unhandledErrorDebounceTimeout=-1,this._unhandledEventDataList=[],this._catchError=this._catchError.bind(this),this._handleError=this._handleError.bind(this),this._baseHandler=window.onerror,window.onerror=this._catchError,this._applicationContext=e}addEventHandler(e){this._eventHandlers.push(e)}raise(e,t){if(void 0!==e&&(this._eventData=e,this._eventHandlers.forEach(n=>n(t,e)),function(e){if(!e)return!1;if(Object(E.h)(e.errorCode))return!0;return!1}(e)||this._unhandledEventDataList.push(e),-1===this._unhandledErrorDebounceTimeout&&this._unhandledEventDataList.length>0))try{this._unhandledErrorDebounceTimeout=setTimeout(this._handleError,1e4)}catch(e){throw Error(e.message)}}_handleError(){const e=this._unhandledEventDataList.slice();this._unhandledEventDataList=[];const t=this._baseHandler(void 0,void 0,void 0,void 0,void 0,e);t instanceof Promise?t.then(()=>{if(this._unhandledEventDataList.length>0)return window.clearTimeout(this._unhandledErrorDebounceTimeout),void(this._unhandledErrorDebounceTimeout=setTimeout(this._handleError,5e3));this._unhandledErrorDebounceTimeout=-1}):this._unhandledErrorDebounceTimeout=-1}eventData(){return this._eventData}buildCrashData(e,t,n,r,a,i){let o;return this.isOutOfMemoryError(e)?(o={},o.errorMessage="Out of Memory!",o.lineNumber=n,o.columnNumber=r,o.func="",o.fileName="",o.isOutOfMemoryError=!0,o.errorType=i):o=this._collectCrashData(e,t,n,r,a,i),o}buildUnknownCrashData(e,t){let n="";try{n=JSON.stringify(t)}catch(e){n="Received an uncaught Unknown Error Event which failed to be stringified for the following reason: "+e.message}const r=Error("Unknown Error Event");r.stack="No stack available.";return this.buildCrashData(n,e,0,0,r,ao.UnhandledRejection)}isOutOfMemoryError(e){return!!so.a.getInstance().get_IsBrowserIE()&&"143abf4577894d22ae34a054a6dce7fe"===e}_collectCrashData(e,t,n,r,a,i){const o=new oo.a(a),s={isOutOfMemoryError:!1};s.lineNumber=n,s.columnNumber=r,s.func=o.getFunctionName();const c=new ji.a(t);return s.fileName=c.pathname,s.stackTrace=o.getStackTrace(),s.errorMessage=e,s.errorType=i,a&&a.errorCode&&(s.errorCode=a.errorCode),s}_catchError(e,t,n,r,a){const i=this.buildCrashData(e,t,n,r,a,ao.UnhandledError);return this.raise(i,"ErrorLogging"),!0}replaceBaseHandler(e){this._baseHandler=e}ensureErrorObject(e){return Object(E.d)(e,this._applicationContext.TraceManager.getTracer("ErrorHandler"))}}const lo={count:
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return Object.keys(e).length},isEmpty:function(e){if(Object(I.a)(e))throw Error.argumentNull("obj");return 0===Object.keys(e).length},keys:function(e){const t=new Array(0);for(const n in e){const r={key:n,value:e[n]};t[t.length]=r.key}return t}};var uo=n("84PK");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class po{constructor(e){this._items=null,this._items=e||new Array(0)}get_Items(){return this._items}get_Count(){return this._items.length}get_item(e){return this._items[e]}set_item(e,t){this._items[e]=t}add(e){this._items.push(e)}addRange(e){this._items.push(...e)}clear(){this._items=[]}contains(e){return this._items.indexOf(e)>=0}remove(e){const t=this._items.indexOf(e);t>=0&&this._items.splice(t,1)}removeAt(e){this._items.splice(e,1)}toArray(){const e=new Array(this.get_Count());for(let t=0;t<this.get_Count();t++)e[t]=this.get_item(t);return e}}var go=n("fU7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var ho=n("iZ7K"),fo=n("LbMF"),mo=n("hVsf"),bo=n("mDek"),_o=n("IvgJ"),yo=n("jFgV"),vo=n("2JG5"),So=n("b6oC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Oo{constructor(e,t){this._store=null,this._tracer=null,this._store=e,this._tracer=t}getAttributeTypes(e,t){return Object(fo.c)(t,e,this._store.getState())}getMultipleAttributeMetadata(e,t){const n=this._store.getState(),r=Object(fo.d)(n,e);if(!r)return this._tracer&&this._tracer.info("getMultipleAttributeMetadata was called, attributesDescriptor is null. Returning null."),null;const a=Object.keys(r);if(t&&t.some(e=>-1===a.indexOf(e)))return this._tracer&&this._tracer.info("getMultipleAttributeMetadata was called while no attribute metadata is available in the state tree. Returning null."),null;t||(t=a);return t.map(t=>this.getAttributeMetadata(e,t))}getAttributeMetadata(e,t){const n=this._store.getState(),r=Object(fo.a)(n,e,t);if(!r||r.Initialized!==K.a.Initialized)return this._tracer&&this._tracer.info("getAttributeMetadata was called while no attribute metadata is available in the state tree. Returning null."),null;const a={};if(r.OptionSet)for(const e in r.OptionSet){const t=r.OptionSet[e],n=new _o.a(t.Label,t.Value,t.State,t.DefaultStatus,t.TransitionData,t.Color,t.Label);a[e]=n}const i=new yo.a(a);return new bo.a(r.LogicalName,j.a.toLegacyGuid(r.Id),r.EntityLogicalName,r.Type,r.DisplayName,r.IsSecured,r.IsValidForCreate,r.IsValidForRead,r.IsValidForUpdate,r.IsValidForGrid,r.RequiredLevel,r.MaxLength,r.MinValue,r.MaxValue,r.Precision,r.PrecisionSource,r.Format,r.Behavior,r.DefaultFormValue,r.DefaultValue,i,r.IsBaseCurrency,r.Targets,r.AttributeOf,r.HasChanged,r.ImeMode,!0,r.InheritsFrom,r.SourceType,!1,r.IsCustomAttribute,r.ColumnNumber)}getEntityMetadata(e){const t=this._store.getState(),n=Object(ho.h)(t,e);if(!n||n.Initialized!==K.a.Initialized)return null;return new vo.a(j.a.toLegacyGuid(n.Id),e,n.DisplayName,n.PluralName,n.ObjectTypeCode,n.PrimaryIdAttribute,n.PrimaryNameAttribute,n.PrimaryImageAttribute,n.Privileges?n.Privileges.map(this._getLegacySecurityPrivilegeMetadata):null,n.IsReadOnlyInMobileClient,n.IsVisibleInMobileClient,n.IsOfflineInMobileClient,n.IsOptimisticConcurrencyEnabled,n.HasChanged,n.IsActivity,n.IsChildEntity,n.ParentEntityLogicalName,n.ParentEntityReferencingAttribute,n.IsValidForAdvancedFind,n.IsMailMergeEnabled,n.IsConnectionsEnabled,n.IsCustomizable,n.IsActivityParty,n.IsImportable,n.IsEnabledForCharts,n.IsCustomEntity,n.IsStateModelAware,n.EnforceStateTransitions,n.IsCollaboration,n.ActivityTypeMask,n.OwnershipType,!0,n.HasStateCode,n.IsBusinessProcessEnabled,n.EntityHelpUrlEnabled,n.EntityHelpUrl,n.IsDocumentManagementEnabled,n.IsOneNoteIntegrationEnabled,n.IsMSTeamsIntegrationEnabled,!1,n.EntityColor,n.IsInteractionCentricEnabled,n.IsQuickCreateEnabled,n.EntityClientSetting,n.IsKnowledgeManagementEnabled,n.IsDocumentRecommendationsEnabled,n.IsIntersect,n.HasNotes,n.UsesBusinessDataLabelTable,n.IconVectorName,n.IsBPFEntity,n.VersionNumber,n.OverallVersionNumber,n.AttributeNames)}_getLegacySecurityPrivilegeMetadata(e){return new So.a(e.Name,j.a.toLegacyGuid(new j.a(e.PrivilegeId)),e.PrivilegeType,e.CanBeBasic,e.CanBeLocal,e.CanBeDeep,e.CanBeGlobal)}getEntityMetadataByTypeCode(e){return this.getEntityMetadata(Object(ho.m)(this._store.getState(),e))}cacheEntityMetadata(e){const t=[];t.push(e),this._store.dispatch(function(e,t){const n=[];for(const t of e)n.push(t.getODataObject());return{type:"cache.entitymetadata",payload:Object(je.b)(n,n[0].VersionNumber,n[0].OverallVersionNumber,null,K.a.Initialized,t)}}(t))}cacheIsActivityFlags(e){const t=Object(mo.b)(e);this._store.dispatch(Object(be.b)(t))}cacheInitialEntities(e){this._store.dispatch(Object(_e.h)(e,this._tracer))}cacheAttributeMetadata(e,t,n){const r=this._store.getState(),a=Object(fo.d)(r,e);let i=null;a&&(i=n.filter(e=>{const t=e.get_logicalName();return!a.hasOwnProperty(t)||a[t].Initialized!==K.a.Initialized})),i&&i.length>0&&this._store.dispatch(Se(e,i,this._tracer))}}Oo.TRACER_CATEGORY_ID="MetadataCache";var Co=n("ngeo"),Eo=n("EW4s"),Io=n("Uv1Y"),wo=n("VCkP"),jo=n("wO8k");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Po{constructor(e,t){this._authErrorBeingHandled=!1,this._reauthFailed=!1,this._requestsPendingAuth=[],this._applicationContext=e,this._store=t}isConnectivityRetryEnabled(){return Object(Hi.c)(this._store.getState(),Gi.td)||Object(Hi.c)(this._store.getState(),Gi.sd)}shouldRetryConnectivityError(e,t){var n;if(!(t.get_isErrorInOffline&&t.get_isErrorInOffline()))return!1;let r;if(Object(Hi.c)(this._store.getState(),Gi.sd))r=Number.POSITIVE_INFINITY;else{if(!Object(Hi.c)(this._store.getState(),Gi.td))return!1;r=1}const a=null!==(n=e.connectivityRetryCount)&&void 0!==n?n:0;return"GET"===e.method&&a<r}handleAuthError(e){e.retryCount=e.retryCount?e.retryCount+1:1;const t=new Eo.a;if(this._reauthFailed){const e=new Io.a("User credentials invalid, probably expired. Auth error being handled.",-2147093995);return e.blockErrorReporting=!0,t.reject(Io.a.toLegacyErrorStatus(e))}if(this._requestsPendingAuth.push(t),e&&e.retryCount>2){const e=new Io.a("A call failed handleautherror retry more than twice",-2147093995);return this._onReauthFailure(e),t}if(this._authErrorBeingHandled)return t;this._authErrorBeingHandled=!0;return new wo.a(this._applicationContext,this._store).handleAuthError().then(()=>{this._onReauthSuccess()}).catch(e=>{this._onReauthFailure(e)}),t}resetFailures(){this._reauthFailed=!1}_onReauthSuccess(){for(;this._requestsPendingAuth.length>0;){this._requestsPendingAuth.pop().resolve()}this._reauthFailed=!1,this._authErrorBeingHandled=!1,this._requestsPendingAuth=[]}_onReauthFailure(e){for(;this._requestsPendingAuth.length>0;){this._requestsPendingAuth.pop().reject(Io.a.toLegacyErrorStatus(e))}this._reauthFailed=!0,this._authErrorBeingHandled=!1,this._requestsPendingAuth=[],this._store.dispatch(Object(jo.c)())}}var To=n("smSa"),No=n("E5IU"),Ao=n("4N6w"),Do=n("d604");class Ro{constructor(e,t){this._store=e,this._context=t}isOfflineSyncDone(){return Object(To.b)(this._store.getState())}getCurrentAppId(){return Object(No.i)(this._store.getState())}getCurrentAppUniqueNameOrDefault(){return Object(No.m)(this._store.getState())}getAuthToken(){return Object(Ao.a)(this._store.getState())}addAuthorizationHeader(e){return Object(Do.a)(this._store,this._context,e)}}var xo=n("GYEz"),Mo=n("uAlF"),Fo=n("jZCH"),ko=n("fYtF"),Lo=n("17x/");function Bo(e,t,n,r=!1){const a=e.DataSource;return a.initialize(n).nativePromise().then(i=>{i&&Object(G.c)(t.dispatch,i),t.dispatch(Object(ht.g)(a.get_appModuleVersionStamps())),e.EventManager.setDataSource(a),a.set_IsLocalDataSourceAvailable(n);if(e.TraceManager.getTracer("dataSourceLoader").warn("Boot task DataSource completed"),!i&&r&&n&&e.DataSource.isUserContextInitialized()){return e.DataSource.get_LocalDataSource().UpdateUserContext(e.DataSource.get_UserContext()).nativePromise().then(()=>{})}})}var Uo=n("jsc8"),Vo=n("GdzE"),zo=n("w1eR");var Wo=n("gy+e"),qo=n("NjDY");var Ho=n("Eh65"),Go=n("WePp"),Ko=n("kWiz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Qo{constructor(e){this._eventManager=e}write(e,t,n,r,a){const i=new Error(n),o=new oo.a(i).getStackTrace().split("\n"),s=o.splice(0,1).join("\n")+"\n"+o.splice(5,o.length).join("\n"),c=this._createTraceEvent(t,n,r,a,s);this._eventManager.ReportEvent(c)}_createTraceEvent(e,t,n,r,a){const i=new Go.a(v.B.Name);return i.addEventParameter(v.g.ComponentName,n),i.addEventParameter(v.B.TraceLevel,Ko.a.toString(e)),i.addEventParameter(v.B.CommonError.Message,t),i.addEventParameter(v.B.CommonError.CallStack,a),r&&r.forEach(e=>{i.addEventParameter(e.name,e.value)}),i}}var Xo=n("XjOj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Yo=n("gNtT");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Jo{constructor(e){this._platform=e}getPlatform(){return this._platform}}const $o=["camera","video","microphone","geolocation"];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Zo={imageRes:n("CEpr").a.DeviceDefault,savePhoto:!1};function es(e){const t={featureName:e,isEnabled:"camera"===e};return"camera"===e&&Object.keys(Zo).forEach(e=>{t[e]=Zo[e]}),t}var ts=n("UwOy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var ns=n("uC8f"),rs=n("HMYz"),as=n("wipL"),is=n("vIHs");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class os{constructor(e){this._errorLoadingIndicator=document.getElementById("error-app-loading-indicator"),this._loadingIndicator=document.getElementById("app-loading-indicator"),this._basicErrorRoot=document.getElementById("errorPopup-container"),this._basicErrorRoot.innerHTML="",this._felaProviderProps=e}createErrorPopup(e,t,n){return this._loadingIndicator.classList.add("hideProgressBar"),this._basicErrorRoot.classList.remove("hideErrorBlock"),this._errorLoadingIndicator.classList.remove("hideErrorBlock"),this._errorLoadingIndicator.classList.add("centered"),Object(is.a)(e,n?n.dispatch:null,n?n.getState:null,t).then(e=>{const t=e.errorPopupDescriptor,n=l.createElement(as.c,{errorDescriptor:t}),r=l.createElement(rs.Provider,this._felaProviderProps,n);u.render(r,this._basicErrorRoot)})}}var ss=n("8mbc"),cs=n("gn9A");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ls=[{id:"PROD",ariaIngestionKey:"0b14a44360bf4cae8e1e090ac91a04e5-3c17b97e-6b3a-4a9b-8407-6e450ff03cd2-7084",allowedOriginRegex:/.*\.crm([2-8]|11|12|14|15)?\.dynamics\.com$/},{id:"GCCHigh",ariaIngestionKey:"7d390bf951b748828d76e5d3c027faa0-9ef46ec8-2e5e-40ba-9f69-b4a13b9feca1-7148",allowedOriginRegex:/.*\.crm\.microsoftdynamics\.us$/},{id:"USDoD",ariaIngestionKey:"8ed6ca832b3c48d48be9c06fdc376398-e81cde17-794e-4380-852b-d01450e08d5c-7306",allowedOriginRegex:/.*\.crm\.appsplatform\.us$/},{id:"GCCModerate",ariaIngestionKey:"774241b9d70e40efb34ddfb995dbfb92-37f51c02-1551-4d6c-acdd-de4f47ee6a98-7274",allowedOriginRegex:/.*\.crm9\.dynamics\.com$/},{id:"Blackforest",ariaIngestionKey:"1d4b56b9dd4d4ca098d7fa7c7af55ece-55115f9e-4619-474c-9aab-80a9f2027a5b-6876",allowedOriginRegex:/.*\.crm\.microsoftdynamics\.de$/},{id:"Mooncake",ariaIngestionKey:"",allowedOriginRegex:/.*\.crm\.microsoftdynamics\.cn$/},{id:"TIP",ariaIngestionKey:"0b14a44360bf4cae8e1e090ac91a04e5-3c17b97e-6b3a-4a9b-8407-6e450ff03cd2-7084",allowedOriginRegex:/.*\.crm10\.dynamics\.com$/},{id:"TEST",ariaIngestionKey:"2602733e020348908569f871ef40fc4b-ecb43f9d-b1e2-4034-aee3-f38471962c48-7333",allowedOriginRegex:/(.*\.crm\.dynamics-int\.com$|.*\.crm[2]?\.crmlivetie\.com$|.*\.contoso\.com:444$|.*\.microsoft\.com$|.*\.msmecrm\.com$|.*\.crm\.crmlivetoday\.com$|.*\.crm\.1boxtest\.com$|.*\.mocaifd\d*\.com:444$|.*\.crm\.crmifd\.com$|.*\.msmecrm\.com:444$|.*localhost.*)/}];function us(e){let t;const n=ls.find(t=>t.id===e);return void 0!==n&&(t=n.ariaIngestionKey),t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class ds{constructor(e,t){this._telemetryFallback=t,this._AWTInit(e)}getAriaProjectId(){return this._telemetryFallback?this._ariaProjectId=us("TEST"):void 0===this._ariaProjectId&&(this._ariaProjectId=function(e){let t;const n=ls.find(t=>t.allowedOriginRegex.test(e));return void 0!==n&&(t=n.ariaIngestionKey),t}(Object(ji.b)())),this._ariaProjectId}setAWTSemanticContext(e){if(void 0===this._defaultAriaLogger)return;if(this._defaultAriaLogger.getSemanticContext()){for(const t of e.parameters)if(t&&!this._isAriaCommonParameter(t.name)){const e=Object(Go.b)(t.value);this._defaultAriaLogger.setContext(t.name,e,cs.AWTPropertyType.Unspecified)}this._defaultAriaLogger.setContext(v.g.UserAgent,window.navigator.userAgent,cs.AWTPropertyType.String),this._defaultAriaLogger.setContext(v.g.Origin,Object(ji.b)(),cs.AWTPropertyType.String)}}logEvent(e,t){if(void 0===this._defaultAriaLogger)return;const n=e.getEventName().toLowerCase();if(v.h.indexOf(n)<0)return;const r=new cs.AWTEventProperties(n);this._setEventPriority(r,t),r.setProperty("ActivityId",e.getActivityId(),cs.AWTPropertyType.String);const a=e.toAriaEventData().EventValues;for(const e in a)this._isAriaCommonParameter(e)||r.setProperty(e,a[e],cs.AWTPropertyType.Unspecified);this._defaultAriaLogger.logEvent(r)}flushAndTearDown(){cs.AWTLogManager.flushAndTeardown()}_AWTInit(e){const t=this.getAriaProjectId();void 0!==t&&(t===us("Blackforest")?this._defaultAriaLogger=cs.AWTLogManager.initialize(t,{collectorUri:cs.AWT_COLLECTOR_URL_GERMANY}):!function(e){return e===us("GCCHigh")}(t)?!function(e){return e===us("USDoD")}(t)?this._defaultAriaLogger=cs.AWTLogManager.initialize(t):this._defaultAriaLogger=cs.AWTLogManager.initialize(t,{collectorUri:cs.AWT_COLLECTOR_URL_USGOV_DOD}):this._defaultAriaLogger=cs.AWTLogManager.initialize(t,{collectorUri:cs.AWT_COLLECTOR_URL_USGOV_DOJ}),window.addEventListener("beforeunload",this._onBeforeUnload),cs.AWTLogManager.addNotificationListener({eventsSent:e=>{},eventsDropped:(e,t)=>{},eventsRejected:(e,t)=>{},eventsRetrying:e=>{}}))}_setEventPriority(e,t){void 0!==t&&(t===Ho.a.High?e.setEventPriority(cs.AWTEventPriority.High):t===Ho.a.Low?e.setEventPriority(cs.AWTEventPriority.Low):e.setEventPriority(cs.AWTEventPriority.Normal))}_onBeforeUnload(){cs.AWTLogManager.flushAndTeardown()}_isAriaCommonParameter(e){return e===v.f.BrowserLanguage||e===v.f.OSTypeVersion||e===v.g.TimeCreated}}const ps="MaxBrowserQueueSize",gs="MaxMobileQueueSize";class hs{constructor(e,t){this._MAX_QUEUE_SIZE=250,this._clientHost=t,this._clientHost===zo.a.Browser&&(this._MAX_QUEUE_SIZE=2e3),this._queueEvents=[],e.DebugSettingsHandler.registerSettingsHandler(ss.b.TelemetryQueue,this._receiveSettings.bind(this))}length(){return this._queueEvents.length}getSpaceAvailable(){return this._MAX_QUEUE_SIZE-this._queueEvents.length}enqueue(e){this._queueEvents.length<this._MAX_QUEUE_SIZE?this._queueEvents.push(e):this._reportEventsLost(1)}_receiveSettings(e){this._clientHost===zo.a.Browser&&ps in e&&this._loadMaxQueueSize(e,ps),this._clientHost!==zo.a.Browser&&gs in e&&this._loadMaxQueueSize(e,gs)}_loadMaxQueueSize(e,t){const n=Number(e[t]);isNaN(n)||(this._MAX_QUEUE_SIZE=n)}_reportEventsLost(e){if(e>0&&this._queueEvents.length>=this._MAX_QUEUE_SIZE){const t="Telemetry.QueueFull",n="KnownEventsLost",r=this._queueEvents[this._queueEvents.length-1];if(t===r.getEventParameter(v.g.ComponentName).value){const t=Number(r.getEventParameter(n).value);t>0&&(e+=t),r.addEventParameter(n,e),this._queueEvents[this._queueEvents.length-1]=r}else{e++;const r=new Go.a(v.B.Name);r.addEventParameter(v.g.ComponentName,t),r.addEventParameter(v.g.ActivityId,"1238c0de-aaaa-bbbb-cccc-1234567890ab"),r.addEventParameter(v.B.TraceLevel,Ko.a.toString(Ko.a.Warning)),r.addEventParameter(v.B.CommonError.Message,"Queue dropped events"),r.addEventParameter(v.B.CommonError.CallStack,"No callstack"),r.addEventParameter(n,e),this._queueEvents[this._queueEvents.length-1]=r}}}dequeueAll(){const e=this._queueEvents.slice();return this._queueEvents=[],e}}class fs{constructor(e){this._storage=e}saveData(e,t){return this._storage.saveSessionState(e,t,!1).nativePromise().then(()=>{})}readData(e){return this._storage.retrieveSessionState(e).nativePromise()}deleteData(e){return this._storage.deleteSessionState(e).nativePromise()}}const ms="MaxStoredBatches";class bs{constructor(e,t,n){this._storedEventManifest=[],this._MAX_STORED_BATCHES=250,this._storage=t,this._archiveStoreKey=n,this._loadEventManifestFromStorage(),e.DebugSettingsHandler.registerSettingsHandler(ss.b.TelemetryArchiver,this._receiveSettings.bind(this))}archiveEvents(e){return this._receiveEvents(e)}countEvents(){let e=0;for(const t of this._storedEventManifest)e+=t.NumEvents;return e}_receiveSettings(e){if(ms in e){const t=Number(e[ms]);isNaN(t)||(this._MAX_STORED_BATCHES=t)}}getEventBatch(){if(this._storedEventManifest.length>0){const e=this._storedEventManifest.shift();return this._writeEventManifestToStorage().then(()=>this._readEventBatch([],e.Key)).then(t=>{const n={SessionContext:e.SessionContext,Events:t};return this._deleteEventBatch(e.Key).then(()=>n)})}return Promise.resolve()}_receiveEvents(e){const t=e.Events;if(!t||0===t.length)return Promise.resolve();if(this._storedEventManifest.length>=this._MAX_STORED_BATCHES)return Promise.resolve();const n=t.slice(),r=this._archiveStoreKey+"_"+j.a.newGuid().guid,a={Created:Date.now(),Key:r,SessionContext:e.SessionContext,NumEvents:n.length};return this._storedEventManifest.push(a),this._writeEventManifestToStorage().then(()=>this._writeEventBatch(n,r))}_readEventBatch(e,t){return this._storage.readData(t).then(t=>{let n=[];const r=JSON.parse(JSON.stringify(t));r&&r.length>0&&(n=JSON.parse(r[0]));const a=e.slice();for(let e=0;e<n.length;e++){const t=new Go.a("").fromJSON(n[e]);a.push(t)}return a}).catch(e=>(console.error("[Telemetry] failure 'Read DB'"),console.dirxml(e),console.error(e.stack||e),[]))}_writeEventBatch(e,t){const n=e.slice(),r=[];return r.push(JSON.stringify(n)),this._storage.saveData(t,r).then(()=>{}).catch(e=>{throw console.error("[Telemetry] failure 'Save DB'"),console.dirxml(e),console.error(e.stack||e),e})}_deleteEventBatch(e){return this._storage.deleteData(e).then(e=>{}).catch(e=>{throw console.error("[Telemetry] failure 'Delete DB'"),console.dirxml(e),console.error(e.stack||e),e})}_loadEventManifestFromStorage(){return this._storage.readData(this._archiveStoreKey+"_Manifest").then(e=>{let t=[];const n=JSON.parse(JSON.stringify(e));n&&n.length>0&&(t=JSON.parse(n[0])),this._storedEventManifest=t}).catch(e=>{throw console.error("[Telemetry] 'Retrieve Archive Manifest' failure"),console.dirxml(e),console.error(e.stack||e),e})}_writeEventManifestToStorage(){const e=this._storedEventManifest.slice();if(!this._storage)return Promise.resolve();const t=[];return t.push(JSON.stringify(e)),this._storage.saveData(this._archiveStoreKey+"_Manifest",t).then(()=>{}).catch(e=>{throw console.error("[Telemetry] 'Store Save DB' failure"),console.dirxml(e),console.error(e.stack||e),e})}}class _s{constructor(e,t,n){this._reporting=!0,this.ARCHIVING=!0,this._telemetryClient=new ds(e,t),this._queue=new hs(e,n),this._applicationContext=e,e.DebugSettingsHandler.registerSettingsHandler(ss.b.EventListeners,this._receiveSettings.bind(this)),this._flushTimeout=null}handleEvent(e,t){if(!this._reporting)return;if("online"===e.getEventParameter(v.t.NetworkConnectivityState).value){if(this._telemetryClient.logEvent(e,t),this._archiver&&this._archiver.countEvents()>0||this._queue&&this._queue.length()>0){const t=()=>{clearTimeout(this._flushTimeout),this._flushTimeout=null,this._queue&&this._queue.length()>0&&this._flushQueuedEventsToAria(),this._archiver&&this._archiver.countEvents()>0&&this._processArchiver()},n=e.getEventParameter(v.g.ComponentName).value,r=e.getEventName(),a=r===v.A.Name||r===v.s.Name;n.toString().toLowerCase().indexOf("offline")>-1&&a&&t(),null===this._flushTimeout&&(this._flushTimeout=setTimeout(t,6e4))}}else{if(!this.ARCHIVING)return;(this._queue.getSpaceAvailable()<=0?this._flushQueueToArchiver():Promise.resolve()).then(()=>{e.addEventParameter("timestamp",(new Date).getTime()),this._queue.enqueue(e)}).catch(()=>{e.addEventParameter("timestamp",(new Date).getTime()),this._queue.enqueue(e)})}}setSessionContext(e){this._sessionContext=e,this._telemetryClient.setAWTSemanticContext(e)}_receiveSettings(e){"AWTEventListener"in e?"off"===e.AWTEventListener.toLowerCase()?(this._reporting=!1,this._telemetryClient.flushAndTearDown()):this._reporting=!0:this._reporting=true}_flushQueueToArchiver(){if(this._archiver&&this._queue.length()>0){const e={SessionContext:this._sessionContext,Events:this._queue.dequeueAll()};return this._archiver.archiveEvents(e)}return Promise.resolve()}_flushQueuedEventsToAria(){let e=0;if(this._queue&&this._queue.length()>0){const t=this._queue.dequeueAll();e=t.length;for(let e=0;e<t.length;e++){const n=t[e];this._telemetryClient.logEvent(n,Ho.a.High)}}const t=new Go.a(v.B.Name);t.addEventParameter(v.g.ComponentName,"AWTEventListener"),t.addEventParameter(v.g.ActivityId,j.a.toString(j.a.newGuid())),t.addEventParameter(v.B.TraceLevel,Ko.a.toString(Ko.a.Warning)),t.addEventParameter(v.B.CommonError.Message,"Processing events from Queue"),t.addEventParameter(v.B.CommonError.CallStack,"No callstack");const n=this._archiver?this._archiver.countEvents():0;return t.addEventParameter("ArchivedEventsCount",n),t.addEventParameter("QueuedEventsCount",e),this._telemetryClient.logEvent(t,Ho.a.High),Promise.resolve()}_processArchiver(){const e=new Go.a(v.B.Name),t=this._archiver?this._archiver.countEvents():0;return e.addEventParameter(v.g.ComponentName,"AWTEventListener"),e.addEventParameter(v.g.ActivityId,j.a.toString(j.a.newGuid())),e.addEventParameter(v.B.TraceLevel,Ko.a.toString(Ko.a.Warning)),e.addEventParameter(v.B.CommonError.Message,"Processing events from Archiver"),e.addEventParameter(v.B.CommonError.CallStack,"No callstack"),e.addEventParameter("ArchivedEventsCount",t),this._telemetryClient.logEvent(e,Ho.a.High),this._archiver.getEventBatch().then(t=>{const n=this._archiver.countEvents();e.addEventParameter(v.B.CommonError.Message,"Processing batch of events from archiver"),e.addEventParameter("RemainingArchivedEventsCount",n);const r=t&&t.Events?t.Events.length:0;e.addEventParameter("CurrentBatchEventsCount",r),this._telemetryClient.logEvent(e,Ho.a.High),t&&(this._telemetryClient.setAWTSemanticContext(t.SessionContext),t.Events.forEach(e=>{this._telemetryClient.logEvent(e)}),this._archiver.countEvents()>0?this._processArchiver():this._telemetryClient.setAWTSemanticContext(this._sessionContext))})}setStorage(e){this._telemetryStorage=new fs(e),this._setArchiver()}_setArchiver(){this._telemetryStorage?this._archiver||(this._archiver=new bs(this._applicationContext,this._telemetryStorage,"ariaTelemetry")):this._archiver=void 0}}var ys=n("QMfC");class vs{constructor(e,t){this._isConsoleOn=false,e.DebugSettingsHandler.registerSettingsHandler(ss.b.EventListeners,this._setConsoleSettings.bind(this)),this._console=t,this._verboseLog=this._getVerboseLog()}handleEvent(e,t){if(!this._isConsoleOn)return;/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)&&this._verboseLog?this._printWebAPIStructured(e):this._printMessage(this._eventToString(e),Object(ys.a)(e))}_setConsoleSettings(e){"Console"in e?"off"===e.Console.toLowerCase()?this._isConsoleOn=!1:this._isConsoleOn=!0:this._isConsoleOn=false}_getVerboseLog(){return null!==this._verboseLog&&void 0!==this._verboseLog||(this._verboseLog=window.location.search.toLocaleLowerCase().indexOf("verboselog=true")>=0),this._verboseLog}_printWebAPIStructured(e){const t="Event: "+e.getEventName();this._console.group(t);const n=this._getMainInfo(e);this._printMessage(n,Object(ys.a)(e)),this._console.group("Details"),this._console.groupCollapsed("Event Parameters"),this._console.table(this._formatParametersForTable(e)),this._console.groupEnd();const r=e.getEventParameter(v.e.CallStack).value;r&&(this._console.group("Call Stack"),this._console.log(r),this._console.groupEnd()),this._console.groupEnd(),this._console.groupEnd()}_formatParametersForTable(e){const t={};t[v.g.ActivityId]={value:e.getActivityId()};const n=e.toSendJSON().EventValues;for(const e in n){const r=n[e];if(v.g.EventContext!==e||r)if(v.g.TimeCreated===e||v.u.StartTime===e)t[e]={value:JSON.stringify(r).replace(/"/g,"")};else if(v.e.CallStack!==e){const n=null!==r?r.toString():"null";t[e]={value:n}}}return t}_printMessage(e,t){4===t?this._console.error(e):3===t&&this._verboseLog?this._console.warn(e):1===t&&this._verboseLog?this._console.info(e):this._verboseLog&&this._console.log(e)}_getHeaderString(e){let t="["+e.getEventName()+"]";return t+="   "+this._getMainInfo(e)+"\n",t}_getMainInfo(e){const t=e.getEventParameter(v.e.Message).value,n=e.getEventParameter(v.g.ComponentName).value;let r="";return n&&(r="["+n+"]"),v.x.Name===e.getEventName()?(r.length>0&&(r+="\n"),r+=v.x.MetricName+": "+e.getEventParameter(v.x.MetricName).value+"\n",r+=v.x.MetricValue+": "+e.getEventParameter(v.x.MetricValue).value+"\n"):t&&(r.length>0&&(r+="\t"),r+=t),r}_getParameterStringPair(e){let t=e.name,n="";for(n=v.g.TimeCreated===e.name||v.u.StartTime===e.name?JSON.stringify(e.value).replace(/"/g,""):""+e.value;n.length>t.length;)t+=" ";for(;t.length>n.length;)n+=" ";return t+="   ",n+="   ",[t,n]}_getDetailsString(e){let t="",n="",r="",a="",i="",o="";n+="---Details---\n";const s=[],c={name:v.g.ActivityId,value:e.getActivityId()};s.push(c);const l=e.toSendJSON().EventValues;for(const e in l){const t=l[e];if(v.g.EventContext===e&&!t)continue;const n={name:e,value:t};s.push(n)}return s.forEach(e=>{v.e.CallStack!==e.name?([i,o]=this._getParameterStringPair(e),r.length+i.length>160?(n+=r+"\n",r=i,n+=a+"\n\n",a=o):(r+=i,a+=o)):t=""+e.value}),n+=r+"\n",n+=a+"\n",t&&(n+="---Call Stack---\n"+t),n}_eventToString(e){let t=this._getHeaderString(e);return t+=this._getDetailsString(e),t}}var Ss=n("OEUm"),Os=n("J+j6"),Cs=n("OEF1"),Es=n("dj6u");function Is(e,t,n){e.parameters.push({name:t,value:n})}var ws=n("69Qu"),js=n("PV+a");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Ps="Message",Ts="Parameters",Ns="MethodName",As={assert:4,error:4,exception:4,info:1,log:0,trace:2,warn:3};class Ds{constructor(){if(Ds._instance)throw new Error("Only one instance of the Console Wrapper could exist at the application runtime. To log amything into console, please use browser console patched methods.");Ds._instance=this,this._console=console,this._wrapMethods()}_wrapMethods(){const e=this._console,t=this;for(const n in e){const r=e[n];t[n]="function"==typeof r?r.bind(e):r,As.hasOwnProperty(n)&&(e[n]=(...e)=>{this._shouldBeCaptured(n,e)&&this._captureUnknownConsoleOutput(n,e),t[n].apply(null,e)})}}_shouldBeCaptured(e,t){return"assert"!==e||!t[0]}_captureUnknownConsoleOutput(e,t){const n=new Go.a("unknown_console_output");n.addEventParameter(v.b.ApplicationEventLevel,As[e]),n.addEventParameter(Ns,e),n.addEventParameter(Ps,this._exctractMessageFromCallParams(e,t)),n.addEventParameter(Ts,JSON.stringify(t)),Object(Os.e)(n)}_exctractMessageFromCallParams(e,t){const n="assert"===e?t[1]:t[0];return n?`Browser console.${e} was called with message "${n}".`:`Unable to extract message from console.${e} call. Please see arguments ${Ts} for the details.`}}var Rs=n("31Vn"),xs=n("37s6"),Ms=n("ff1s"),Fs=n("eZ32"),ks=n("8Mff");var Ls;!function(e){e[e.true=1]="true",e[e.false=0]="false",e[e.unknown=-1]="unknown"}(Ls||(Ls={}));class Bs{constructor(e,t,n,r,a=[]){this._eventListeners=[],this._componentSettings={},this._wildCardComponentSettings={},this._eventSettings={},this._store=e,this._ariaEventListener=new _s(t,r,n),this._eventListeners.push(this._ariaEventListener),this._eventListeners=this._eventListeners.concat(a),this._telemetryFallback=r,this._tracer=t.TraceManager.getTracer("Telemetry"),this._clientHost=n,this._needContextEvent=!0,this._sessionId=j.a.newGuid().guid,window.CURRENT_SESSION_ID=this._sessionId,t.DebugSettingsHandler.registerSettingsHandler(ss.b.EventManager,this._setEventSettings.bind(this)),this._refreshSessionContext(),this._trackEndPerformanceWorkblock=this._trackEndPerformanceWorkblock.bind(this),this._subscribeToWorkBlockReporting()}getCurrentSessionId(){return this._sessionId}getActivityId(){return this._activityId?this._activityId:window.__preload.initialActivityId}ReportComponentPerformance(e,t,n,r,a){const i=new Go.a(v.x.Name);i.addEventParameter(v.g.ComponentName,e),i.addEventParameter(v.x.MetricName,t),null!=a&&i.addEventParameter(v.x.StartTime,new Date(performance.timing.navigationStart+a).toISOString()),i.addEventParameter(v.x.MetricValue,Math.round(n)),this._addOptionalParameters(i,r),this._dispatch(i)}ReportComponentSuccess(e,t){const n=new Go.a(v.A.Name);n.addEventParameter(v.g.ComponentName,e),this._addOptionalParameters(n,t),this._dispatch(n)}ReportComponentFailure(e,t,n,r){if(t&&t.blockErrorReporting)return;const a=new Go.a(v.s.Name),i=Object(E.d)(t,this._tracer),o=new oo.a(i).getStackTrace()||"No stack available.";if(!i.message){const e=[{name:"ErrorMessage",value:JSON.stringify(t)}];this._tracer.warn("Reporting error with empty string to telemetry.",e)}a.addEventParameter(v.g.ComponentName,e),a.addEventParameter(v.s.CommonError.Message,i.message),a.addEventParameter(v.s.CommonError.CallStack,o),a.addEventParameter(v.s.SuggestedMitigation,n),this._addUciErrorParameters(a,t),this._addOptionalParameters(a,r),this._dispatch(a)}ReportEvent(e){this._dispatch(e)}_addUciErrorParameters(e,t){if(e&&t){if(t.errorParameters)for(const n of t.errorParameters)e.addEventParameter(n.name,n.value);if(t.innerError){let n;n="string"==typeof t.innerError||t.innerError instanceof String?t.innerError.valueOf():JSON.stringify(t.innerError),e.addEventParameter("innerErrorParameter",n)}t.errorCode&&e.addEventParameter("ErrorCode",t.errorCode)}}_addOptionalParameters(e,t){if(t)for(const n of t)e.addEventParameter(n.name,n.value,n.forceOwnColumn)}setTelemetryListeners(){this._telemetryFallback}addTelemetryListener(e){this._eventListeners.push(e)}_trackBeginPerformanceWorkblock(){this._activityId||(this._activityId=j.a.toString(j.a.newGuid()),_.a.onNextPerfData(this._trackEndPerformanceWorkblock))}_trackEndPerformanceWorkblock(){this._activityId=void 0}_handleContextRequest(){this._needContextEvent&&this._store&&Object(K.b)(Object(qo.v)(this._store.getState()))&&Object(K.b)(Object(Ka.r)(this._store.getState()))&&(this._needContextEvent=!1,this.sendContextEvent())}sendContextEvent(){const e=new Go.a(v.f.Name),t={compositeName:"ContextEvent",parameters:[]};!function(e,t){if(Is(e,v.g.ComponentName,"Telemetry.ContextEvent"),Is(e,v.f.BrowserLanguage,window.navigator.language),t){const n=t.getState(),r=Object(xo.c)(n);r&&Is(e,v.f.InstallId,r);const a=Object(xo.b)(n);if(a&&Is(e,v.f.DeviceModel,a),Object(K.b)(Object(qo.v)(n))){const t=Object(qo.y)(n),r=Object(qo.x)(n);Is(e,v.f.OrganizationParameters.Language,r.languageCode),Is(e,v.f.OrganizationParameters.OrgName,t.organizationName)}if(Object(K.b)(Object(Ka.r)(n))){const t=Object(Ka.w)(n);Is(e,v.f.UserParameters.Language,t.languageId)}}Is(e,v.f.OSTypeVersion,so.a.getInstance().getOSString()),Is(e,v.f.WindowResolution,window.innerWidth+"x"+window.innerHeight),Is(e,v.f.ScreenResolution,window.screen.width+"x"+window.screen.height)}(t,this._store);for(const n of t.parameters)e.addEventParameter(n.name,n.value);this._dispatch(e)}setDataSource(e){this._ariaEventListener.setStorage(e),this._refreshSessionContext()}canSendEvent(e,t){if(!this._componentSettings&&!this._wildCardComponentSettings&&!this._eventSettings)return true;let n=this._checkInvalidComponentName(t,e);return Ls.unknown!==n?Ls.true===n:(n=this._checkComponentSetting(t,e),Ls.unknown!==n?Ls.true===n:(n=this._checkPartialComponentSetting(t,e),Ls.unknown!==n?Ls.true===n:(n=this._checkEventSetting(e),Ls.unknown===n||Ls.true===n)))}_refreshSessionContext(){const e=function(e,t,n){const r={compositeName:"SessionContext",parameters:[]};if(Is(r,v.z.SessionId,t),e){const t=e.getState();Is(r,v.z.HostType,Object(ts.b)(t)),Is(r,v.z.HostSubType,Object(xo.g)(t));const n=Object(xo.j)(t);n&&Is(r,v.z.HostVersion,n);const a=Object(K.b)(Object(qo.v)(t))&&Object(qo.y)(t),i=window.__preload&&window.__preload.serverVersion?window.__preload.serverVersion:null,o=window.__preload&&window.__preload.orgId?window.__preload.orgId:null,s=a&&a.serverVersion?a.serverVersion:i,c=a&&a.organizationId?a.organizationId.guid:o;Is(r,v.z.ServerVersion,s),Is(r,v.z.OrganizationId,c);const l=Object(K.b)(Object(Ka.r)(t))&&Object(Ka.x)(t),u=window.__preload&&window.__preload.userId?window.__preload.userId:null,d=l&&l.userId?l.userId.guid:u;Is(r,v.z.UserId,d);const p=Object(Es.b)(t);Is(r,v.z.AadObjectId,p);const g=Object(Es.a)(t);Is(r,v.z.AadTenantId,g);const h=Object(No.m)(t);h&&Is(r,v.z.AppModule,h);const f=Object(No.h)(t);f&&Is(r,v.z.AppModuleClientType,f);const m=Object(No.k)(t);null!==m&&Is(r,v.z.NavigationType,m);const b=Object(Cs.a)(t);for(let e=0;b&&e<b.length;e++)Is(r,b[e].key,b[e].value)}return Is(r,v.z.ClientVersion,window.VERSION_NUMERIC_VALUE),r}(this._store,this.getCurrentSessionId(),this._clientHost);this._ariaEventListener.setSessionContext(e)}_storeComponentSettings(e,t,n){e[t]||(e[t]={});for(const r in n)e[t][r]=this._getSettingValue(n[r])}_setEventSettings(e){let t="";try{t=JSON.stringify(e)}catch(e){t="Unable to be stringified"}this._tracer.info("Event Manager Settings Received.",[{name:"Settings",value:t}]),this._componentSettings={},this._wildCardComponentSettings={},this._eventSettings={};const n=e&&e.Components?e.Components:{},r=e&&e.Events?e.Events:{};for(const e in n){const t=n[e];e.length>0&&("*"===e.charAt(0)||"*"===e.charAt(e.length-1))?this._storeComponentSettings(this._wildCardComponentSettings,e,t):this._storeComponentSettings(this._componentSettings,e,t)}for(const e in r)this._eventSettings[e]=this._getSettingValue(r[e])}_getSettingValue(e){return"off"!==String(e).toLowerCase()}_checkInvalidComponentName(e,t){return e?Ls.unknown:t in this._eventSettings?this._eventSettings[t]?Ls.true:Ls.false:Ls.true}_checkComponentSetting(e,t){if(e in this._componentSettings){if(t in this._componentSettings[e])return this._componentSettings[e][t]?Ls.true:Ls.false;if(ss.a in this._componentSettings[e])return this._componentSettings[e][ss.a]?Ls.true:Ls.false}return Ls.unknown}_checkPartialComponentSetting(e,t){let n=!1,r=!1;for(const a in this._wildCardComponentSettings)if(a.length>0&&("*"===a.charAt(0)||"*"===a.charAt(a.length-1))){const i=a.replace("*","");if(e.indexOf(i)>=0)if(t in this._wildCardComponentSettings[a]){if(r=this._wildCardComponentSettings[a][t],true===r)return r?Ls.true:Ls.false;n=!0}else if(ss.a in this._wildCardComponentSettings[a]){if(r=this._wildCardComponentSettings[a][ss.a],true===r)return r?Ls.true:Ls.false;n=!0}}return n?r?Ls.true:Ls.false:Ls.unknown}_checkEventSetting(e){return e in this._eventSettings?this._eventSettings[e]?Ls.true:Ls.false:ss.a in this._eventSettings?this._eventSettings[ss.a]?Ls.true:Ls.false:Ls.unknown}_addTimeCreatedIfNotPresent(e){if(!e.getEventParameter(v.g.TimeCreated)){const t=new Date;e.addEventParameter(v.g.TimeCreated,t)}}_addNetworkContext(e){let t="unknown";this._store&&null!==Object(ws.b)(this._store.getState())&&(t=Object(ws.b)(this._store.getState())?"online":"offline"),e.addEventParameter(v.t.ServerConnectivityState,t);let n="unknown";this._store&&null!==Object(ws.a)(this._store.getState())&&(n=Object(ws.a)(this._store.getState())?"online":"offline"),e.addEventParameter(v.t.NetworkConnectivityState,n)}_addOfflineContext(e){let t=!1,n=!1;if(this._store&&this._clientHost===zo.a.MobileApplication){const r=Object(No.o)(this._store.getState());if(e.addEventParameter(v.t.IsOfflineByDefaultApp,r),t=Object(xs.w)(this._store.getState()),e.addEventParameter(v.t.OfflineFeatureAvailableForUse,t),n=Object(xs.v)(this._store.getState()),e.addEventParameter(v.t.HasUserForcedOffline,n),!t){const t=Object(xs.p)(this._store.getState()),n=t===ks.a.Default?"Default":t===ks.a.Enabled?"Enabled":"Disabled";if(e.addEventParameter(v.b.MobileOfflineFeatureStatus,n),t===ks.a.Enabled){const t=Object(xs.q)(this._store.getState()),n=t===Fs.a.Available?"Available":t===Fs.a.Initializing?"Initializing":"NotAvailable",r=Object(xs.r)(this._store.getState()),a=Object(Ms.d)(this._store.getState());e.addEventParameter(v.b.OfflineStatus,n),e.addEventParameter(v.b.OfflineStatusReason,r),e.addEventParameter(v.b.IsCodeCacheReady,a)}}}}_addDeviceParameters(e){if(this._store){const t=this._store.getState(),n=Object(xo.h)(t);n&&Object.keys(n).forEach(t=>{e.addEventParameter(t,n[t])})}}_addContext(e){this._clientHost!==zo.a.Browser&&this._addDeviceParameters(e),e.addEventParameter(v.g.ActivityId,this.getActivityId()),e.addEventParameter(v.z.SessionId,this.getCurrentSessionId()),this._addTimeCreatedIfNotPresent(e),this._addNetworkContext(e),this._addOfflineContext(e),this._refreshSessionContext()}_dispatch(e,t){this._handleContextRequest();const n=e.getEventName(),r=String(e.getEventParameter(v.g.ComponentName).value);this.canSendEvent(n,r)&&(this._addContext(e),this._eventListeners.forEach(n=>{n.handleEvent(e,t)}))}_subscribeToWorkBlockReporting(){m.a.subscribeToAppWorking(this._trackBeginPerformanceWorkblock.bind(this))}}class Us{constructor(e,t,n){this._traceManager=e,this._transports=t,this._componentId=n}getLogLevel(){return this._traceManager.getLogLevel(this._componentId)}error(e,t){this._log(Ko.a.Error,e,t)}warn(e,t){this._log(Ko.a.Warning,e,t)}info(e,t){this._log(Ko.a.Info,e,t)}debug(e,t){this._log(Ko.a.Verbose,e,t)}_log(e,t,n){if(e>this.getLogLevel())return;const r=Date.now();this._transports.forEach(a=>a.write(r,e,t,this._componentId,n))}}const Vs=Ko.a.Warning;class zs{constructor(e,t,n,r,a){this._tracerCache=new Map,this._customLogLevels={},this._tracerCtor=t,this._config={defaultTransports:n,transportMappings:[]},e.DebugSettingsHandler.registerSettingsHandler(ss.b.TraceManager,this._setTraceSettings.bind(this)),r&&r.forEach(e=>this.addTransportMapping(e));const i=a?this._getTraceLevelEnumForString(a):Vs;this.setLogLevel(i)}addTransportMapping(e){this._config.transportMappings.push(e)}getTracer(e){let t=this._config.defaultTransports;if(e){if(!this._tracerCache.has(e)){const n=this._config.transportMappings.filter(t=>t.categories.indexOf(e)>-1).map(e=>e.transport);n.length>0&&(t=n),this._tracerCache.set(e,new this._tracerCtor(this,t,e))}return this._tracerCache.get(e)}return new this._tracerCtor(this,t)}getLogLevel(e){let t=this._logLevel;if(e){if(e in this._customLogLevels)return this._customLogLevels[e];for(const n in this._customLogLevels)if(n.length>0&&("*"===n.charAt(0)||"*"===n.charAt(n.length-1))){const r=n.replace("*","");e.indexOf(r)>=0&&this._customLogLevels[n]>t&&(t=this._customLogLevels[n])}}return t}setLogLevel(e,t){t?this._customLogLevels[t]=e:this._logLevel=e}addDefaultTransport(e){this._config&&this._config.defaultTransports.push(e)}setTraceAreas(e){if(null===e)return;e.split(" ").forEach(e=>{const t=e.split(":");if(2===t.length){const e=t[0],n=this._getTraceLevelEnumForString(t[1]);this.setLogLevel(n,e)}})}_setTraceSettings(e){let t="";try{t=JSON.stringify(e)}catch(e){t="Unable to be stringified"}this.getTracer("TraceManager").info("Trace Manager Settings Received.",[{name:"Settings",value:t}]);const n=e&&e.Components?e.Components:{};this._customLogLevels={},this.setLogLevel(Vs);for(const e in n){const t=n[e],r=this._getTraceLevelEnumForString(t);e===ss.a?this.setLogLevel(r):this.setLogLevel(r,e)}}_getTraceLevelEnumForString(e){let t=this._logLevel;switch(e.toLowerCase()){case"off":t=Ko.a.Off;break;case"error":t=Ko.a.Error;break;case"warning":t=Ko.a.Warning;break;case"info":t=Ko.a.Info;break;case"verbose":t=Ko.a.Verbose}return t}}class Ws{constructor(e){this._registeredHandlers={},this._cachedSettings={},this._applicationContext=e,this._loadStoredSettings()}registerSettingsHandler(e,t){e&&(this._registeredHandlers[e]||(this._registeredHandlers[e]=[]),this._registeredHandlers[e].push(t),this._callSettingsHandler(e))}_callSettingsHandler(e){if(e in this._registeredHandlers){const t=this._registeredHandlers[e];this._cachedSettings[e]||(this._cachedSettings[e]={});for(const n of t)n(this._cachedSettings[e])}}updateSettings(e){let t={};try{t=JSON.parse(e)}catch(e){return void this._applicationContext.EventManager.ReportComponentFailure("DebugSettingsHandler",e,"Check the AdvancedDebuggabilitySetting being passed through the UserContext, or the locally saved copy, as it failed to be parsed.")}try{window.localStorage.setItem("UCIAdvancedDebuggabilitySettings",e)}catch(e){}this._cachedSettings=t&&"object"==typeof t?t:{};for(const e in this._registeredHandlers)this._callSettingsHandler(e)}_loadStoredSettings(){let e="";try{e=window.localStorage.getItem("UCIAdvancedDebuggabilitySettings")||""}catch(e){}e&&this.updateSettings(e)}}var qs=n("YPXd");function Hs(e,t,n){const r=so.a.getInstance(),a=!!r&&r.get_IsIOS(),i=e===zo.a.MailApp||a;let o;if(o=!n.getState().configuration.disableLocalStorage&&i?Object(qs.b)(t):Object(qs.a)(t),o){const r=o.externalCorrelationId,a=o.hostName;e===zo.a.Browser&&n.dispatch({type:"session.hostType.set",payload:ts.a}),a&&n.dispatch({type:"session.hostSubtype.set",payload:a}),r&&n.dispatch(Ma("ExternalCorrelationId",r));const i=o.loadHandler,s=i&&i.webResourceName,c=i&&i.initFunctionName;s&&n.dispatch(Ma("WebResourceName",s)),c&&n.dispatch(Ma("InitFunctionName",c)),n.dispatch({type:"session.hostOptionsInitialized.set",payload:{value:!0}});const l=[];l.push({name:"hostOptions",value:JSON.stringify(o)}),t.EventManager.ReportComponentSuccess("PopulateHostOptions.getHostOptions",l)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Gs{constructor(e=new Array,t=-1,n=j.a.newGuid().guid){this.history=e,this.currentHistoryElement=t,this.historyManagerId=n}moveHistory(e){const t=this.currentHistoryElement+e;t>=0&&t<this.history.length?this.currentHistoryElement=t:t<0?(this.currentHistoryElement=0,console.warn("Offset supplied makes index less than zero.")):(this.currentHistoryElement=this.history.length-1,console.warn("Offset supplied makes index greater than maximum history length."))}handlePushInHistory(e,t){this.currentHistoryElement++,this.history[this.currentHistoryElement]={state:e,url:t};const n=this.history.length-1-this.currentHistoryElement;n&&this.history.splice(-n,n)}handleReplace(e,t){this.currentHistoryElement<0&&this.currentHistoryElement++;const n=null==t?this.GetCurrentUrl():t;this.history[this.currentHistoryElement]={state:e,url:n}}getCurrentHistoryElement(){return this.history[this.currentHistoryElement]||{state:void 0,url:void 0}}decorateState(e,t=this.currentHistoryElement){return Object.assign(Object.assign({},e),{[this.historyManagerId]:t})}ClearHistory(){this.history=[],this.currentHistoryElement=-1}HistoryBack(){this.moveHistory(-1);const e=this.getCurrentHistoryElement();this.ExecuteOnHistoryBack(e.state,e.url)}PushState(e,t,n,r){try{const n=this.decorateState(e,this.currentHistoryElement+1);this.handlePushInHistory(n,t),this.ExecuteOnPushState(n,t)}catch(n){r&&r.info(`PushState has error ${JSON.stringify(n)}. state: '${e}', url: '${t}'`)}}ReplaceState(e,t,n,r){try{const n=this.decorateState(e,this.currentHistoryElement>-1?this.currentHistoryElement:0);this.handleReplace(n,t),this.ExecuteOnReplaceState(n,t)}catch(n){r&&r.info(`ReplaceState has error ${JSON.stringify(n)}. state: '${e}', url: '${t}'`)}}GetCurrentUrl(){return this.getCurrentHistoryElement().url}GetHistoryLength(){return this.currentHistoryElement+1}GetState(){return this.getCurrentHistoryElement().state}}var Ks=n("D+Bz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Qs extends Gs{constructor(){const e=function(){let e=null;try{e=window.history.state}catch(e){}if(!e)return null;let t=null;for(const n in e)if(e.hasOwnProperty(n)&&j.a.tryParseOrNull(n)){const r=window.sessionStorage.getItem(n);if(r){t={history:JSON.parse(r),index:e[n],managerId:n};break}}return t}();e?super(e.history,e.index,e.managerId):super(),this._isInAppHistoryChanged=!1,window.addEventListener("popstate",this._handleOnPopState.bind(this))}_handleOnPopState(e){const t={source:Ks.b.BrowserBack};this._updateHistoryOnPopStateChange(e),this._onPopStateEventCb&&this._onPopStateEventCb(e,t)}_updateHistoryOnPopStateChange(e){this._isInAppHistoryChanged?this._isInAppHistoryChanged=!1:this.moveHistory(this._getHistoryOffset(e))}_getHistoryOffset(e){const t=this.getCurrentHistoryElement().state,n=(e.state||{})[this.historyManagerId];return null==n?-1:n-t[this.historyManagerId]}_saveHistoryBackup(){const e=JSON.stringify(this.history);window.sessionStorage.setItem(this.historyManagerId,e)}ExecuteOnHistoryBack(e,t){this._isInAppHistoryChanged=!0,window.history.back()}ExecuteOnPushState(e,t){window.history.pushState(e,"",t),this._saveHistoryBackup()}ExecuteOnReplaceState(e,t=null){window.history.replaceState(e,"",t),this._saveHistoryBackup()}RegisterOnPopState(e){this._onPopStateEventCb=e}RegisterOnBeforeUnload(e){this._onBeforeUnloadCb=e,window.addEventListener("beforeunload",e)}Dispose(){window.removeEventListener("beforeunload",this._onBeforeUnloadCb),this._onPopStateEventCb=void 0,this._onBeforeUnloadCb=void 0}decorateState(e,t=this.currentHistoryElement){return this._decorateWithHistoryLength(super.decorateState(e,t))}_decorateWithHistoryLength(e){let t=null;try{t=window.history.state}catch(e){}return Object.assign(Object.assign({historyLengthOnInitialLoad:window.history.length},t),e)}}var Xs=n("9L53");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Ys extends Gs{ExecuteOnHistoryBack(e,t){const n=new Xs.a;n.state=e,this._onPop(n)}ExecuteOnPushState(e,t){}ExecuteOnReplaceState(e,t){}RegisterOnPopState(e){this._onPop=e}RegisterOnBeforeUnload(e){}Dispose(){this._onPop=void 0}}var Js=n("TEuE"),$s=n("xPbo"),Zs=n("JC5U"),ec=n("ZuxC"),tc=n("QHx/");var nc=n("Lc3p");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function rc(e){return{type:"router.set.prerender.state",payload:{preRendering:e}}}var ac=n("tGNJ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const ic={navigating:!1,navigationsCount:0,baseUrl:void 0};function oc(e=ic,t){const n=function(e,t){if(t.type===_i.m&&void 0!==t.payload.navigating)return Object.freeze(t.payload.navigating);return e}(e.navigating,t),r=function(e,t){if(t.type===_i.m&&!0===t.payload.navigating)return e+1;return e}(e.navigationsCount||0,t),a=function(e,t){if("router.set.baseurl"===t.type&&void 0!==t.payload.baseUrl)return t.payload.baseUrl;return e}(e.baseUrl,t),i=function(e=!1,t){if("router.set.prerender.state"===t.type&&void 0!==t.payload.preRendering)return t.payload.preRendering;return e}(e.preRendering,t);return t.type===ac.a&&t.payload.routerState?t.payload.routerState:n!==e.navigating||r!==e.navigationsCount||a!==e.baseUrl||i!==e.preRendering?Object.freeze({navigating:n,navigationsCount:r,baseUrl:a,preRendering:i}):e}var sc=n("arV0"),cc=n("wF0i"),lc=n("bsQO"),uc=n("oqdd"),dc=n("ruPX"),pc=n("tICD");var gc=n("E7fB");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let hc;class fc{constructor(e,t,n,r,a,i){this._sharedVariables={},this._store=e,this._depth=r,this._eventArgs=a,this._pageId=n,hc=t,i&&(this._sharedVariables=i._sharedVariables)}getContext(){return this._context||(this._context=new gc.a(this._store,this._pageId)),this._context}getDepth(){return this._depth}getEventArgs(){return this._eventArgs}getEventSource(){return hc.TraceManager.getTracer(Wc.ROUTER_TRACER_CATEGORY).error("getEventSource was called on NavigationEventContext"),null}getFormContext(){return hc.TraceManager.getTracer(Wc.ROUTER_TRACER_CATEGORY).error("getFormContext was called on NavigationEventContext"),null}getSharedVariable(e){return this._sharedVariables[e]}setSharedVariable(e,t){this._sharedVariables[e]=t}}var mc=n("4leG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class bc{constructor(e,t,n){this._preventDefault=n||!1,this._pageUrl=t,this._pageParameters=e}get pageUrl(){return this._pageUrl}get pageParameters(){return this._pageParameters}isDefaultPrevented(){return this._preventDefault}preventDefault(){this._preventDefault=!0}}var _c=n("GEbX"),yc=n("Knfm"),vc=n("oT5e"),Sc=n("G4xW"),Oc=n("tFCh"),Cc=n("Fgw8");const Ec=new Set,Ic=new Set,wc=new Set;var jc=n("yHXp"),Pc=n("si7p");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Tc={getName:()=>jc.a,getRequiredAttributes(){throw new Error("Not Implemented")},throwIfInvalidUrl(e){if(!e||!e.modalDialogType||e.modalDialogType!==Pc.a&&e.modalDialogType!==Pc.c&&e.modalDialogType!==Pc.d||!e.text||0===e.text.length)throw Object(d.d)("Missing or invalid URL parameter: type",E.a)},createPageModule:e=>n.e(80).then(n.bind(null,"n8uW")).then(({ModalDialog:t})=>new t(e)),getTelemetryAttributes:e=>[{name:v.b.ModalDialogType,value:e&&e.modalDialogType}]};Object.freeze(Tc);var Nc=n("xagu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Ac=!1,Dc="100%",Rc="100%",xc="rgba(0, 0, 0, 0.5)",Mc={type:Ks.a.Dialog,pageType:"modaldialog",factory:Tc,getDialogOptions:e=>({width:Dc,height:Rc,openInNewWindow:e.dialogOptions&&e.dialogOptions.openInNewWindow?e.dialogOptions.openInNewWindow:Ac,shadowColor:e.dialogOptions&&e.dialogOptions.shadowColor?e.dialogOptions.shadowColor:xc,overflow:"auto"}),urlToInput(e){const t=e.searchParams;let n;switch(t.get(Nc.s)){case Pc.a:n=Pc.a;break;case Pc.c:n=Pc.c;break;case Pc.d:n=Pc.d;break;case Pc.g:n=Pc.g;default:throw Error(Nc.t)}const r=t.get(Nc.q);let a,i,o,s,c,l,u,d;return t.has(Nc.n)&&(a=JSON.parse(t.get(Nc.n))),t.has(Nc.r)&&(i=t.get(Nc.r)),t.has(Nc.p)&&(o=t.get(Nc.p)),t.has(Nc.k)&&(s=t.get(Nc.k)),t.has(Nc.j)&&(c=t.get(Nc.j)),t.has(Nc.o)&&(l=t.get(Nc.o)),t.has(Nc.m)&&(u=JSON.parse(t.get(Nc.m))),t.has(Nc.l)&&(d=JSON.parse(t.get(Nc.l))),{modalDialogType:n,text:r,title:i,subtitle:o,confirmButtonLabel:s,cancelButtonLabel:c,dialogOptions:a,showDetailsLabel:l,errorDetails:d,hideDownloadLogLink:u}},inputToUrl(e,t){const n=new ji.a(e),r=n.searchParams;return r.set(Nc.s,t.modalDialogType),r.set(Nc.q,t.text),t.dialogOptions&&r.set(Nc.n,JSON.stringify(t.dialogOptions)),t.title&&r.set(Nc.r,t.title),t.subtitle&&r.set(Nc.p,t.subtitle),t.confirmButtonLabel&&r.set(Nc.k,t.confirmButtonLabel),t.cancelButtonLabel&&r.set(Nc.j,t.cancelButtonLabel),t.showDetailsLabel&&r.set(Nc.o,t.showDetailsLabel),t.errorDetails&&r.set(Nc.l,JSON.stringify(t.errorDetails)),n.href}};Object.freeze(Mc);var Fc=n("7Sr4"),kc=n("WkRo"),Lc=n("F1Lu"),Bc=n("tlcF"),Uc=n("VgPQ"),Vc=n("Z4sG");const zc=g.a.createEvent("LoadPageModule",h.a);class Wc{constructor(e,t,n){this._onBeforeUnload=this._onBeforeUnload.bind(this),this._onPopState=this._onPopState.bind(this),this._applicationContext=e,this._tracer=this._applicationContext.TraceManager.getTracer(Wc.ROUTER_TRACER_CATEGORY),this._pageMappings=t,this._pagesAction={},this._nextPageId=0,this._nextDialogContext=0,this._pages={},this._inputs={},this._activeDialogs=[],this._livePageIds=[],this._pagesReducer=Object(nc.a)(this._pages),this._preNavigationHandlers={},this._globalPreNavigationHandlers=[],this._navigationMetadataHandlers=[],this._navigationBeginHandlers=[],this._historyManager=n,this._historyManager.RegisterOnPopState(this._onPopState),this._historyManager.RegisterOnBeforeUnload(this._onBeforeUnload)}setHistoryManager(e){this._disposeHistoryManager(),this._historyManager=e,this._historyManager.RegisterOnPopState(this._onPopState),this._historyManager.RegisterOnBeforeUnload(this._onBeforeUnload)}addGlobalOnPreNavigation(e){this._globalPreNavigationHandlers.push(e)}removeGlobalOnPreNavigation(e){for(let t=0;t<this._globalPreNavigationHandlers.length;t++)if(this._globalPreNavigationHandlers[t]===e){this._globalPreNavigationHandlers.splice(t,1);break}}getPageMappings(){return this._pageMappings}removeDialogFromStack(e){this._activeDialogs.splice(this._activeDialogs.findIndex(t=>t.id===e),1)}_navigate(e,t,n,r,a,i,o,s,c){const l=Object(zi.c)(this._store.getState());!r&&this._store.dispatch(Object($s.c)(c.targetBrowsingContext)),Object(Js.e)(Js.b);const u=i||String(this._nextPageId++);document.body.setAttribute("data-loaded","0"),this._applicationContext.AccessibilityManager&&!r&&this._applicationContext.AccessibilityManager.showOutlineState(!1);const d=t.getName(),p=function(e,t,n,r){const a=e.getKeyForThawedCheck&&e.getKeyForThawedCheck(t);let i=0;if(Ec.has(n))i=3;else if(Ec.add(n),Ic.has(r)?i=1:Ic.add(r),a){const e=a+r;wc.has(e)?i=2:wc.add(e)}return i}(t,n,a,d),g=this._pages[l],h=g?g.getName():"none",f=Object(S.c)(t.getTelemetryAttributes(n));f[v.x.PageName]=d,f[v.x.LoadType]=p.toString(),f[v.b.PageLoadParameters.NavigationOrigin]=h,Object(cc.d)(d,f),_.a.onNextIdleProcessing(e=>{this._onAppIdle(d,p)});const b=m.a.trackWork("createPageModule");return this._runNavigationBeginHandlers(t.getName()).then(()=>{const a=zc.startStopwatch(),i=t.createPageModule(u);i.then(()=>{a(),b()},()=>{a(),b()});const l=[i];return this._preInitializePage(t,n,u,l),Promise.all(l).then(([a,i])=>{let l;_.a.addKeyPerformanceIndicator("PageNavigationModuleReady"),this._pages[u]=a,this._inputs[u]={factory:t,input:n};const d=new Promise(e=>{l=e});return this._pagesAction[u]={pageOutputPromise:d,pageOutputPromiseResolvers:l,preClosePageHandlers:[]},r?this._navigateToDialog(e,u,a,n,c,o):(Object(M.b)(()=>{this.garbageCollector()},"Run garbage collection after navigation"),this._livePageIds.push(u)),this._store.dispatch(Object(kc.c)(c.targetBrowsingContext)),this._tracer.info(`PageModule has been created. Page name: '${a.getName()}', PageId: '${a.getId()}'`),this._runMetadataHandlers(),[a,n,r,s,t.getTelemetryAttributes(n),i]})})}_navigateToDialog(e,t,n,r,a,i){if(this._activeDialogs.push({id:t,page:n}),i){const n=Object(Ki.b)(this._store.getState(),i);n?(r.dialogOptions||r.pageType===Mc.pageType||(r.dialogOptions=Object(sc.d)(e.getState(),i)),e.dispatch(Object(Oc.d)(n.dialogContextId,t,a,i))):e.dispatch(Object(Oc.b)(String(++this._nextDialogContext),t,a.targetBrowsingContext))}else e.dispatch(Object(Oc.b)(String(++this._nextDialogContext),t,a.targetBrowsingContext))}_preInitializePage(e,t,n,r){if(e.preInitializePage){const a=m.a.trackWork("preInitializePage"),i=this._store.dispatch(e.preInitializePage(t,n));i.then(a,a),r.push(i)}if(e.predictedNextPageFactories)for(const n of e.predictedNextPageFactories)if(n.preInitializePage&&n.getPredictedPageInput){const r=n.getPredictedPageInput(e.getName(),t);if(r){const e=Object(Sc.a)(n.preInitializePage(r,null));this._store.dispatch(e)}}}garbageCollector(){const e=this._store.getState();if(this._livePageIds.length>=10){let t=-1;for(const n of this._livePageIds){if(t++,void 0===e.pages[n]){const r=[{name:"pageIndex",value:n},{name:"livePageIds",value:JSON.stringify(this._livePageIds)},{name:"pages",value:JSON.stringify(Object.keys(e.pages))}];this._tracer.warn("Trying to access a page which does not exist.",r),this._livePageIds.splice(t,1);break}if(Object(zi.n)(e,n)){this._store.dispatch(Object(D.f)(n)),this._livePageIds.splice(t,1);break}}}}navigateTo(e,t,n,r){return Object(I.c)(e.pageName)?this._navigateToUrl(e,t,n,r):this._navigateToPage(e,t,n,r)}_navigateToPage(e,t,n,r){try{const a=this._historyManager.GetCurrentUrl(t),i=this._pageMappings.getPageFromPageName(e,t),{factory:o,isRedirect:s}=i,{isDialogNavigation:c,dialogOptions:l}=Object(zi.d)(n.getState(),i,t,r),u=s,d=t.source;let p="";u&&(p=this._pageMappings.getUrlForPage(o.getName(),e.input,a,d),e.input.appshellmode=this._pageMappings.getPageFromUrl(p,t).input.appshellmode);const g=String(this._nextPageId++);if(Object(Cc.b)(n.getState(),t)){const n=qc(g,o.getName());!c&&t.replaceState?(p=this._pageMappings.getUrlForPage(o.getName(),e.input,a,d),e.input.appshellmode=this._pageMappings.getPageFromUrl(p,t).input.appshellmode,this._historyManager.ReplaceState(n,p,t,this._tracer)):!c&&n&&(p=this._pageMappings.getUrlForPage(o.getName(),e.input,a,d),e.input.appshellmode=this._pageMappings.getPageFromUrl(p,t).input.appshellmode,this._historyManager.PushState(n,p,t,this._tracer))}return this._navigate(n,o,e.input,c,p,g,r,l,t)}catch(e){return e&&(e.message&&this._tracer.error(e.message),e={name:e.name,errorCode:e.errorCode,message:e.message,stack:e.stack}),Promise.reject(e)}}_navigateToUrl(e,t,n,r){try{const a=this._historyManager.GetCurrentUrl(t),i=this._pageMappings.getPageFromUrl(e.pageName,t),{factory:o,input:s,isRedirect:c}=i,{isDialogNavigation:l,dialogOptions:u}=Object(zi.d)(n.getState(),i,t,r);(c||/^\/([0-9a-zA-Z_]+\/)?main.aspx/.test(e.pageName))&&(e.pageName=this._pageMappings.getUrlForPage(o.getName(),s,a,t.source));const d=String(this._nextPageId++);if(Object(Cc.b)(n.getState(),t)){const n=qc(d,o.getName());!l&&t.replaceState?this._historyManager.ReplaceState(n,e.pageName,t,this._tracer):!l&&n&&this._historyManager.PushState(n,e.pageName,t,this._tracer)}return this._navigate(n,o,s,l,e.pageName,d,r,u,t)}catch(e){return e&&e.message&&this._tracer.error(e.message),Promise.reject(e)}}navigateBack(e){const t=new Promise(e=>this._navigationPromiseResolver=e);return this._historyManager.HistoryBack(e),t}navigateToNewWindow(e){return new Lc.a(this._applicationContext,this._store).openUri(e).then(e=>({status:0,windowProxy:void 0,pageId:void 0})).catch(e=>({status:1}))}navigateBackOutOfApp(){const e=new Lc.a(this._applicationContext,this._store);return e.isOperationAvailableAndEnabled("navigateBackOutOfApp")?e.navigateBackOutOfApp():Promise.resolve({status:1})}navigateToDefault(){return this._store.dispatch(Object(qi.a)())}navigateInternal(e,t){try{let n,r,a,i=!1;const o=this._historyManager.GetCurrentUrl(t),s=Object(zi.c)(this._store.getState()),c=String(this._nextPageId++);if(e&&e.pageId)if(r=Object(sc.g)(this._store.getState(),e.pageId),void 0!==r){a=this._pageMappings.getPageFromPageName({pageName:e.pageName},t),({factory:n,isDialog:i=!1}=a);const r={pageId:c,pageName:e.pageName};this._historyManager.ReplaceState(r,o,t)}else a=this._pageMappings.getPageFromUrl(o),({factory:n,input:r,isDialog:i=!1}=a);else a=this._pageMappings.getPageFromUrl(o),({factory:n,input:r,isDialog:i=!1}=a);const l=Object(zi.d)(this._store.getState(),a,t,s);return i=l.isDialogNavigation,this._navigate(this._store,n,r,i,o,c,s,l.dialogOptions,t)}catch(e){return e&&e.message&&this._tracer.error(e.message),Promise.reject(e)}}cleanUp(e){Object(M.b)(()=>{delete this._pages[e],delete this._pagesAction[e],delete this._inputs[e]},"Clean up router pages")}registerPreNavigationHandler(e,t){t||(t=Object(zi.c)(this._store.getState()),this._tracer.warn("pageId is not provided to registerPreNavigationHandler")),this._preNavigationHandlers[t]||(this._preNavigationHandlers[t]=[]),this._preNavigationHandlers[t].push(e)}registerPostNavigationHandlerHandlers(e){this._navigationMetadataHandlers.push(e)}registerNavigationBeginHandlers(e){this._navigationBeginHandlers.push(e)}_removePreNavigationHandlers(e){e||(e=Object(zi.c)(this._store.getState()),this._tracer.warn("pageId is not provided to registerPreNavigationHandler")),this._preNavigationHandlers[e]=void 0}_removePreCloseHandler(e){this._pagesAction[e].preClosePageHandlers=[]}registerPreCloseHandler(e,t){this._pagesAction[e].preClosePageHandlers.push(t)}getPageOutputPromise(e){if(void 0===this._pagesAction[e]){let t;const n=new Promise(e=>{t=e});this._pagesAction[e]={pageOutputPromise:n,pageOutputPromiseResolvers:t,preClosePageHandlers:[]}}return this._pagesAction[e].pageOutputPromise}_getPageOutputResolver(e){return this._pagesAction[e].pageOutputPromiseResolvers}_runClosePageHandlers(e){return this._pagesAction[e]?Fc.a.getInstance().checkForOutstandingWork(this._store.getState()).then(()=>{const t=this._pagesAction[e].preClosePageHandlers;if(t&&t.length>0){return t.reduce((e,t)=>e.then(()=>t(this._store.getState,this._store.dispatch)),Promise.resolve())}return Promise.resolve()}):Promise.resolve()}_runMetadataHandlers(){this._navigationMetadataHandlers&&this._navigationMetadataHandlers.length>0&&this._navigationMetadataHandlers.forEach(e=>{e(this._store.getState,this._store.dispatch)})}_runNavigationBeginHandlers(e){const t=this._navigationBeginHandlers.map(t=>t(this._store.getState,this._store.dispatch,e));return Promise.all(t).then(()=>{this._tracer.info("runNavigationBeginHandlers completed successfully")}).catch(e=>{this._tracer.error(`runNavigationBeginHandlers completed with failure : '${e.message}'`)})}isPageADialog(e,t,n,r){let a;try{a=Object(I.c)(t.pageName)?this._pageMappings.getPageFromUrl(t.pageName,n):this._pageMappings.getPageFromPageName(t,n)}catch(e){return!1}return Object(zi.d)(e,a,n,r).isDialogNavigation}shouldNavigate(e,t,n,r){n||(this._tracer.warn("A pageId was not provided to shouldNavigate"),n=Object(zi.c)(this._store.getState()));if(this.isPageADialog(this._store.getState(),e,r,n))return Promise.resolve(!0);return Fc.a.getInstance().checkForOutstandingWork(this._store.getState()).then(()=>{const e=this._store.getState(),r=Object(vc.b)(e,n);if(!r)return!0;const a=Object(zi.b)(e,r.id);return!a||!t||"welcomePagedialog"===Object(zi.k)(this._store.getState(),a)||this._store.dispatch((i=n,{type:"router.open.confirm.dialog.async",execute:({dispatch:e},t)=>e(Object(dc.a)("ModalDialog",{modalDialogType:"routerDialog",text:"Unsaved change"},i)).then(t=>0===t.status&&e(Object(pc.a)(t.pageId)).then(e=>e.value.confirmed))}));var i}).then(t=>{if(e&&e.pageName&&e.input&&this._globalPreNavigationHandlers.length){let n,r=0;const a=e.input,i=this._pageMappings.getMappingForPage(e),o=this._pageMappings.getBaseUrl(),s=function(e,t,n,r){if(!e)throw new Error("Page Input is null");if(!n)throw new Error("Base Url is null");if(!r)throw new Error("State is null");const a=new ji.a(n.toLowerCase()),i=a.searchParams.get("navbar")||void 0,o=a.searchParams.get("appid")||"",s="true"===a.searchParams.get("ribbondebug")||!1,c=Object(mc.a)(r);return{etn:e.entityTypeName,formid:e.formid&&e.formid.guid,formParameters:e.data||{},pagetype:t,id:e.id&&e.id.guid||e.dashboardId&&e.dashboardId.guid,viewid:e.viewid&&e.viewid.guid,viewtype:e.viewType,navbar:i,cmdbar:c,ribbonDebug:s,appid:o}}(a,i.pageType,o,this._store.getState()),c=this.createUrlForPage(e.pageName,a);return this._globalPreNavigationHandlers.reduce((e,t)=>e.then(e=>{const a=new bc(s,c,!e);n=new fc(this._store,this._applicationContext,Object(zi.c)(this._store.getState()),r++,a,n);try{t(n)}catch(e){this._applicationContext.TraceManager.getTracer(Wc.ROUTER_TRACER_CATEGORY).error(e,[{name:"baseUrl",value:o},{name:"pageParameters",value:JSON.stringify(s)}])}return e&&!a.isDefaultPrevented()}),Promise.resolve(t))}return t}).then(e=>e&&this._preNavigationHandlers[n]&&this._preNavigationHandlers[n].length?this._preNavigationHandlers[n].reduce((e,t)=>e.then(n=>n?t(this._store.getState()):e),Promise.resolve(e)):e).then(e=>(e&&this._removePreNavigationHandlers(n),e))}shouldDialogClose(e){return Fc.a.getInstance().checkForOutstandingWork(this._store.getState()).then(()=>!this._preNavigationHandlers[e]||!this._preNavigationHandlers[e].length||this._preNavigationHandlers[e].reduce((e,t)=>e.then(n=>n?t(this._store.getState()):e),Promise.resolve(!0))).then(t=>(t&&this._removePreNavigationHandlers(e),t))}keepUrl(){const e=Object(zi.c)(this._store.getState()),t=this._historyManager.GetCurrentUrl(),n=this._inputs[e],r=n.factory.getName(),a=qc(e,r),i=this._pageMappings.getUrlForPage(r,n.input,t);if(a){const t=Object(tc.a)(this._store.getState(),e,Ks.b.Other);this._historyManager.PushState(a,i,t,this._tracer)}}preRenderCheck(e){try{const t=this._pageMappings.getFactoryForPage({pageName:e.pageName});return t&&t.prePageRender?(this._store.dispatch(rc(!0)),t.prePageRender(e.input,this._applicationContext,this._store.dispatch,this._store.getState).then(e=>(this._store.dispatch(rc(!1)),e.resultType===uc.a.Fail&&(e.resultValue=e.resultValue||Object(d.d)("Error occurred during pre-rendering",2415919107)),Promise.resolve(e)))):Promise.resolve({resultType:uc.a.Success})}catch(e){return e=e||Object(d.d)("Error occurred during pre-rendering",2415919107),Promise.reject(e)}}preCloseCheck(e,t){try{const n=this._pages[e];return n&&n.prePageClose?n.prePageClose(e,this._applicationContext,this._store.dispatch,this._store.getState,t).then(e=>Promise.resolve(e)):Promise.resolve({resultType:uc.a.Success})}catch(e){return e=e||Object(d.d)("Error occurred during pre-CloseCheck",2415919107),Promise.reject(e)}}closePage(e,t){return this._runClosePageHandlers(e).then(()=>{const n=Object(sc.f)(this._store.getState(),e),r=this._pages[e];if(!r)return Promise.reject(Object(d.d)("Trying to close the page which was already closed",2415919107,[{name:"PageId",value:e}]));const a=Object(vc.b)(this._store.getState(),e),i=this._getPageOutputResolver(e),o=r&&r.getCloseAction(t);if(!o)return i(null),this._activeDialogs=this._activeDialogs.filter(t=>t.id!==e),Promise.resolve({isDialog:n,output:{reason:t,value:void 0}});return this._store.dispatch(o).then(r=>{const o={reason:t,value:r};return this._activeDialogs=this._activeDialogs.filter(t=>t.id!==e),i(o),this._removePreCloseHandler(e),a&&this._store.dispatch(Object(kc.c)(a.id)),{isDialog:n,output:o}})})}addPopup(e,t,n){const r=String(++this._nextDialogContext);this._store.dispatch(Object(Oc.b)(r,e,t)),this._activeDialogs.push({id:e,page:void 0,closeHandler:n})}getPopup(e){return this._activeDialogs[this._activeDialogs.findIndex(t=>t.id===e)]}_onAppIdle(e,t){document.body.setAttribute("data-loaded","1"),3===t&&Object(lc.b)(),"EditForm"===e&&Object(lc.a)()}_onPopState(e,t){if(e.preventDefault(),!(t=t||{}).targetBrowsingContext){const n=e.state&&e.state.pageId,r=this._store.getState(),a=n&&Object(vc.b)(r,n);t.targetBrowsingContext=a?a.id:Object(vc.e)(r)}this._navigationPromiseResolver?(this._navigationPromiseResolver(this.navigateInternal(e.state,t)),this._navigationPromiseResolver=null):this._store.dispatch(function(e,t){return{type:"router.navigateInternal.async",execute({dispatch:n,getState:r},a){const i=a.Router;if(!t){const n=e&&e.pageId?e.pageId:Object(zi.c)(r());t=Object(tc.a)(r(),n)}return i.shouldNavigate().then(a=>a?n(Object(D.d)(t.targetBrowsingContext)).then(()=>(n(Object(Zs.b)()),i.navigateInternal(e,t).then(([e,a,i,o,s,c])=>{const l=i?Object(zi.c)(r()):e.getId();return n(Object($s.d)(l,e.getId(),t.targetBrowsingContext)),n(Object(ec.c)(e,a,i,c))},e=>(e&&(e={name:e.name,errorCode:e.errorCode,message:e.message,stack:e.stack}),n(Object($s.e)(e,t.targetBrowsingContext)),{status:1,error:e})))).catch(e=>({status:1,error:e={name:e.name,errorCode:e.errorCode,message:e.message,stack:e.stack}})).then(e=>(n(Object(Zs.a)()),e)):(t&&t.source===Ks.b.BrowserBack&&i.keepUrl(),{status:1,error:new Error("Navigation is not allowed")}))}}}(e.state,t))}_onBeforeUnload(e){const t=document.createEvent("HTMLEvents");t.initEvent("blur",!0,!0),document.dispatchEvent(t);const n=this._store.getState(),r=this._pages[Object(zi.c)(n)],a=r&&r.beforePageUnload&&r.beforePageUnload(n),i=Object(yc.a)(this._store.getState());if(a||i===_c.a.MultiSession)return e.returnValue=""}getHistoryManager(){return this._historyManager}getPage(e){const t=this._pages[e];return t?t.getRootComponent():void 0}getPageDefinitions(){return this._pages}getPageModuleInput(e){return this._inputs[e]}getDialogIdStack(){const e=[];for(const t of this._activeDialogs)e.push(t.id);return e}createUrlForPage(e,t,n,r){const a=this._historyManager.GetCurrentUrl();return this._pageMappings.getUrlForPage(e,t,a,n,r)}createWebUrlForPage(e,t,n,r){return this._pageMappings.getWebUrlForPage(t,n,e,r)}createMobileClientUrlForPage(e,t,n){const r=this._historyManager.GetCurrentUrl();return this._pageMappings.getMobileClientUrlForPage(e,t,r,n)}initializeManager(e){this._store=e;const t=this._pageMappings.getBaseUrl();this._store.dispatch({type:"router.set.baseurl",payload:{baseUrl:t}})}restoreRouter(e){const{pages:t,router:n}=e;this._store.dispatch(Object(ac.b)(t,n));const r={};if(!t)return r;const a=Object.keys(t);a&&a.length&&(this._nextPageId=Number.parseInt(a[a.length-1],10)+1);const i=e.dialogContexts&&Object.keys(e.dialogContexts);i&&i.length&&(this._nextDialogContext=Number.parseInt(i[i.length-1],10)+1);for(const n of Object.keys(t)){const a=t[n];r[n]=this._restorePage(n,a,Object(zi.c)(e))}return r}_restorePage(e,t,n){const r=this._pageMappings.getPageFromPageName({pageName:t.__pageName,input:t.input}),{factory:a,input:i,isDialog:o}=r,s=a.preInitializePage&&this._store.dispatch(a.preInitializePage(i,e)),c=a.createPageModule(e);return Promise.all([c,s]).then(([t,r])=>{let s;o?this._activeDialogs.push({id:e,page:t}):this._livePageIds.push(e),this._pages[e]=t,this._inputs[e]={factory:a,input:i};const c=new Promise(e=>{s=e});if(this._pagesAction[e]={pageOutputPromise:c,pageOutputPromiseResolvers:s,preClosePageHandlers:[]},this._store.dispatch(Object(Uc.b)(e,!1)),Object(Vc.a)(this._store,this._applicationContext,e),n===e&&!Object(mc.c)(this._store.getState())){const t={pageId:e,pageName:a.getName()},n=this._historyManager.GetCurrentUrl(),r=this._pageMappings.getUrlForPage(a.getName(),i,n);this._historyManager.ReplaceState(t,r)}return()=>this._store.dispatch(t.getInitializationAction(r))})}getReducers(){return{pages:this._pagesReducer,router:oc}}updateDialogs(e){this._activeDialogs=e.map(e=>({id:e,page:this._pages[e]}))}dispose(){this._disposeHistoryManager()}_disposeHistoryManager(){this._historyManager&&(this._historyManager.Dispose(),this._historyManager=void 0)}}function qc(e,t){if(e)return{pageId:e,pageName:t}}function Hc(e,t,n,r){let a;switch(r){case zo.a.MobileApplication:a=new Ys;break;case zo.a.MailApp:a=function(){if(!window.history)return!1;try{window.history.replaceState(window.history.state,"")}catch(e){return!1}return!0}()?so.a.getInstance().get_IsAndroidPhone()?new Ys:new Qs:new Ys;break;default:a=Object(mc.c)(t.getState())?new Bc.a(t,e.TraceManager):new Qs}return new Wc(e,n,a)}Wc.ROUTER_TRACER_CATEGORY="router";var Gc=n("Lhhr"),Kc=n("rdtZ"),Qc=n("G0by"),Xc=n("SSL+");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Yc=g.a.createEvent("Frame",h.v);class Jc{constructor(){this._timeByTask=null,this._trackerCallbackId=-1,this._debounceTimeoutId=-1,m.a.subscribeToAppWorking(()=>{this._timeByTask={},this._trackFrames(-1)}),m.a.subscribeToAppIdle(()=>{this._timeByTask=null,cancelAnimationFrame(this._trackerCallbackId),clearTimeout(this._debounceTimeoutId),this._debounceTimeoutId=-1}),this._timeByTask={},this._trackFrames(-1)}_trackFrames(e){if(null===this._timeByTask)return;const t=performance.now();if(-1!==e){const n=t-e;n>200&&this._sendSlowFrameInfo(e,n)}this._timeByTask={},this._debounceTimeoutId=setTimeout(()=>{this._trackerCallbackId=requestAnimationFrame(()=>{this._trackFrames(t)})},100)}_sendSlowFrameInfo(e,t){const n=[];for(const e in this._timeByTask){const t=this._timeByTask[e];t>10&&n.push({t:e,d:Math.round(t)})}Yc.createRetroactiveStopwatch(e,t,{tasks:JSON.stringify(n)})}writeMarker(e,t,n){}writeRetroactiveTimespan(e,t,n,r){this._captureEvent(e,n,r)}startTimespan(e,t,n){return(t,r)=>{this._captureEvent(e,t,Object.assign(Object.assign({},n),r))}}_captureEvent(e,t,n){if(null===this._timeByTask)return;let r=null;if(e.getZone()===h.d){const e=n[h.n];e&&(r=e)}else r=e.getName();r&&(this._timeByTask[r]?this._timeByTask[r]+=t:this._timeByTask[r]=t)}}var $c=n("L8Me"),Zc=n("2yvP"),el=n("/t1C"),tl=n.p+"scripts/bluebird.min.js?v=1.4.9962-v91onpremise",nl=n("ABCl");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const rl=so.a.getInstance().get_IsBrowserIE(),al=g.a.createEvent("ExecuteFunction",h.f);class il{constructor(e,t,n,r,a,i,o){this.initialized=!1,this._iframe=e,this._tracing=t,this._telemetryEventManager=n,this._scriptManager=r,this._applicationContext=a,this._clientApiManager=o,this._store=i}initEventManager(e){this._eventManager=new el.a(e,this,this._tracing,this._telemetryEventManager,this._scriptManager,this._clientApiManager)}getEventManager(){return this._eventManager}get id(){return this._iframe.id}set iFrame(e){this._iframe=e}get iFrame(){return this._validateIframeUse(),this._iframe}getIFrame(){return this._iframe}initialize(){return Object(Qc.patchNetworkRequestsOnWindow)(this._iframe.contentWindow,this._iframe.id),this._setupMicrosoftObject(),this.setGlobalVariable("Microsoft",Microsoft),this._assetLoader=new io.a(this._iframe.contentWindow.document,this._applicationContext,this._store),Promise.all([rl?this._assetLoader.loadScript(tl):void 0]).then(()=>(this.initialized=!0,this))}loadWebResourceSync_DO_NOT_USE(e){this._validateIframeUse(),this._assetLoader.loadScriptSync_DO_NOT_USE(e)}loadWebResources(e){return this._validateIframeUse(),this._assetLoader.loadScripts(e)}loadWebResourcesForAllContexts(e,t,n,r,a){return this._validateIframeUse(),Promise.all(e.map(e=>this._assetLoader.loadWebResource(e,t,n,r,a))).then(()=>this._patchOfflineChecks())}_patchOfflineChecks(){var e,t,n,r,a;if(Object(Lo.h)(this._store.getState())){const i=()=>Xrm.Utility.getGlobalContext().client.getClientState()===Xrm.Constants.ClientStates.offline,o=this.iFrame.contentWindow||{};(null===(n=null===(t=null===(e=null==o?void 0:o.XrmCore)||void 0===e?void 0:e.InternalUtilities)||void 0===t?void 0:t.DialogUtilities)||void 0===n?void 0:n.isOffline)&&(o.XrmCore.InternalUtilities.DialogUtilities.isOffline=i),(null===(a=null===(r=null==o?void 0:o.Activities)||void 0===r?void 0:r.ClientApi)||void 0===a?void 0:a.IsMocaOffline)&&(o.Activities.ClientApi.IsMocaOffline=i)}}loadJavascriptString(e){this._validateIframeUse(),this._assetLoader.loadRawJavaScript(il._decodeHex(e))}_setupMicrosoftObject(){window.Microsoft||(window.Microsoft={Crm:{}}),Microsoft.Crm.Application||(Microsoft.Crm.Application={SharedObjects:{ProcessUnificationConstants:{returnRawValueFlag:"ProcessUnification_ReturnRawValue",readOnlyFlagPrefix:"ProcessUnification_ReadOnly_",hiddenFlagPrefix:"ProcessUnification_Hidden_",processActionArgumentsPrefix:"ProcessUnification_Arguments_",mddOkButtonId:"ok_id",mddLastButtonClickedId:"last_button_clicked"}}})}setGlobalVariable(e,t,n=!1){const r=this._iframe.contentWindow,a=n||!r[e];if(a)r[e]=t;else{const t=[];t.push({name:"Container Variable",value:e});const n=new Error("Container.setGlobalVariable can only be set once");this._tracing.info(n.message,t)}return a}getGlobalVariable(e){return this._iframe.contentWindow[e]}execute(e,t,n,r){const[a,i]=function(e,t){const n=e.split(".");let r;t=t[n[0]];for(let e=1;e<n.length&&t;e++)r=t,t=t[n[e]];return[t,r]}(e,this.iFrame.contentWindow||{});if(a&&"function"==typeof a)return this.executeFunction(a,t,i,e,r);{const t="Web resource method does not exist: "+e;if(!n)return this._tracing.info(t),null;throw new ReferenceError(t)}}executeFunction(e,t,n,r,a){const i=al.startStopwatch(Object.assign({method:r},a)),o=[],s=Object(Qc.addNetworkRequestListener)(e=>{e.id=j.a.toString(j.a.newGuid()),o.push({id:e.id,sync:e.sync})});let c;try{c=e.apply(n,t)}catch(e){const t=[];throw t.push({name:"exception",value:e.message}),t.push({name:"exceptionStack",value:e.stack}),a&&t.push(...Object.keys(a).map(e=>({name:e,value:a[e]}))),this._tracing.error(nl.a,t),e.errorCode||(e.errorCode=2153976091),e}return s(),i(o.length>0?{requests:JSON.stringify(o)}:void 0),c}static _decodeHex(e){return e.replace(/\\x([0-9A-Fa-f]{2})/g,(e,t)=>String.fromCharCode(parseInt(t,16)))}_validateIframeUse(){if(!this.initialized){const e=[];e.push({name:"Container Id",value:this.id}),this._telemetryEventManager.ReportComponentFailure("container",new Error("Accessed IFrame before initialized"),null,e)}}}var ol=n("nJrx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class sl{constructor(e){this._index=-1,this._length=e,this._items=[]}enQueue(e){this._index++,this._index>=this._length&&(this._index=0),this._items[this._index]=e}find(e){if(this._index<0)return!1;for(let t=0;t<this._items.length;t++)if(this._items[t]===e)return!0;return!1}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const cl=g.a.createEvent("initializeContainer","ScriptManager.Manager"),ll=g.a.createEvent("removeContainer","ScriptManager.Manager");class ul{constructor(e,t,n,r=document,a,i){this._cache={},this._removedContainers=[],this._containerEntryPool=[],this._tracer=e,this._target=r,this._eventManager=a,this._clientApiManager=i,this._circularQueue=new sl(10),this._applicationContext=t,this._store=n}initializeContainerPool(){this._queueIframeCreation(),this._createIframeWhenWorkEnds()}_createIframeWhenWorkEnds(){for(let e=this._containerEntryPool.length;e<1;e++)Object(M.b)(()=>{this._queueIframeCreation()},"Create iframe")}initializeContainerForClientApi(e,t=!0){const n=Object(sc.f)(this._store.getState(),e);return t&&e!==this._previousPageId&&!n&&(this._previousPageId&&Object(zi.n)(this._store.getState(),this._previousPageId)&&this.removeContainer(this._previousPageId),this._previousPageId=e),this.initializeContainer(e).then(t=>(Object(Zc.b)("page.initialization",()=>{const n=this._clientApiManager.getClientApiEntry(e).xrmInstance;t.setGlobalVariable("Xrm",n)}),t))}initializeContainer(e){const t=this._cache[e];let n,r;if(void 0!==t&&(n=t.container,t.promise))return t.promise;if(this._circularQueue.enQueue(e),n){this._tracer.info(`initializeContainer called with id ${e} corresponding to an existing uninitialized container with no pre-created iframe`);const t=cl.startStopwatch();r={id:e,container:n,promise:this._createScriptFrame(e).then(e=>(n.iFrame=e,n.initialize().then(()=>n))),removed:!1};const a=()=>t();r.promise.then(a,a)}else{const t=this._getScriptContainer();n=t.container,r={id:e,container:n,promise:t.promise.then(()=>(n.initEventManager(e),n.iFrame.id=dl(e),n)),removed:!1}}return this._cache[e]=r,r.promise}_preInitializeContainer(){const e=Object(ol.a)(),t=cl.startStopwatch(),n={container:new il(void 0,this._tracer,this._eventManager,this,this._applicationContext,this._store,this._clientApiManager),promise:this._createScriptFrame(e).then(t=>(this._tracer.info("Created script frame with ID "+e),n.container.iFrame=t,n.container.initialize().then(()=>n.container)))},r=()=>t();return n.promise.then(r,r),n}_queueIframeCreation(){if(this._containerEntryPool.length<1){this._tracer.info("Queuing creation of script container");const e=this._preInitializeContainer();return e.promise.then(()=>{this._containerEntryPool.push(e)}),e.promise}return this._tracer.info("Contianer Pool Full. Failed to queue creation of new script container"),null}_getScriptContainer(){const e=this._popScriptContainerFromPool();return e||(this._tracer.info("Container pool empty: _popScriptContainerFromPool returning promise for creation of new iframe"),this._preInitializeContainer())}_popScriptContainerFromPool(){if(this._containerEntryPool.length){const e=this._containerEntryPool.shift();return this._createIframeWhenWorkEnds(),this._tracer.info("_popScriptContainerFromPool returning a pre-created iframe"),e}return this._tracer.warn("Container Pool is empty, unable to retrieve a pre-initialized container"),null}_createScriptFrame(e){return new Promise((t,n)=>{const r=this._target.createElement("iframe");r.id=dl(e),r.height=r.width=r.frameBorder="0",r.setAttribute("aria-hidden","true"),r.setAttribute("tabindex","-1"),r.setAttribute("src","/uclient/blank.htm"+Object(io.c)()),r.onload=()=>{r.contentWindow.onbeforeunload=()=>{this._tracer.warn("Script container reloaded",[{name:"name",value:r.name},{name:"id",value:r.id}])},t(r)},r.onerror=()=>{n(new Error("Failed to create script container iframe"))},this._target.body.appendChild(r)})}getContainer(e){const t=this._cache[e];if(null==t){const t=new Error("Container does not exist"),n=[];try{n.push({name:"IsRecentPageId",value:this._circularQueue.find(e)}),n.push({name:"ContianerId",value:e})}catch(e){this._eventManager.ReportComponentFailure("ScriptManager.Manager.getContainer.addingParameter",e)}throw this._eventManager.ReportComponentFailure("ScriptManager.Manager.getContainer",t,null,n),t}return t.removed&&this._eventManager.ReportComponentFailure("ScriptManager.Manager.getContainer",new Error("Accessed removed container")),t.container}containerExists(e){const t=this._cache[e];return null!=t&&void 0!==t.container&&null!==t.container&&!t.removed}removeContainer(e,t=!1){const n=this._cache[e];if(t&&void 0!==n){this._removeContainer(n);const e=this._removedContainers.indexOf(n);-1!==e&&this._removedContainers.splice(e,1)}else void 0===n||n.removed||(n.removed=!0,this._removedContainers.push(n),1===this._removedContainers.length&&Object(M.b)(()=>{const e=ll.startStopwatch();this._removedContainers.forEach(this._removeContainer,this),this._removedContainers=[],e()},"Remove stale containers"))}_removeContainer(e){try{const t=e.container.getIFrame();t&&(t.contentWindow.onbeforeunload=void 0,this._target.body.removeChild(t)),this._clientApiManager.removeClientApiEntry(e.id)}catch(t){const n=[{name:"id",value:e.id}];this._eventManager.ReportComponentFailure("ScriptManager.Manager._removeContainer",t,void 0,n)}delete this._cache[e.id]}}function dl(e){return"ClientApiFrame_"+e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class pl{constructor(){this._workTimeByType=null,m.a.subscribeToAppWorking(()=>{this._workTimeByType={},this._syncTime=0,this._customScriptTime=0,_.a.onNextIdleProcessing(this._processWorkBlockData.bind(this))}),m.a.isAppIdle()||(this._workTimeByType={},this._syncTime=0,this._customScriptTime=0,_.a.onNextIdleProcessing(this._processWorkBlockData.bind(this)))}writeMarker(e,t,n){}writeRetroactiveTimespan(e,t,n,r){this._captureEvent(e,n,r)}startTimespan(e,t,n){return(t,r)=>{this._captureEvent(e,t,Object.assign(Object.assign({},n),r))}}_captureEvent(e,t,n){if(null===this._workTimeByType)return;const r=e.getZone();if(r===Kc.NETWORK_REQUEST_EVENT_NAME){n["sync"]&&(this._syncTime+=t)}else{this._customScriptTime+=t;const a=r===h.d,i=a?"CustomControl":n.type,o=n.solutionName,s=n.solutionVersion,c=n.publisherName,l=a?n[h.n]:n.webResourceName,u=a?e.getName():n.method,d=n.requests;i&&c&&o&&s&&l&&u&&(this._workTimeByType[i]||(this._workTimeByType[i]={}),this._workTimeByType[i][c]||(this._workTimeByType[i][c]={}),this._workTimeByType[i][c][o]||(this._workTimeByType[i][c][o]={}),this._workTimeByType[i][c][o][s]||(this._workTimeByType[i][c][o][s]={}),this._workTimeByType[i][c][o][s][l]||(this._workTimeByType[i][c][o][s][l]={}),this._workTimeByType[i][c][o][s][l].hasOwnProperty(u)||(this._workTimeByType[i][c][o][s][l][u]=[]),this._workTimeByType[i][c][o][s][l][u].push({d:Math.round(t),r:d}))}}_processWorkBlockData(){null!==this._workTimeByType&&(_.a.addCommonKpiParameters({[v.b.PageLoadParameters.Attribution]:JSON.stringify(this._workTimeByType),[v.b.PageLoadParameters.CustomScriptTime]:Math.round(this._customScriptTime).toString(),[v.b.PageLoadParameters.SyncRequestTime]:Math.round(this._syncTime).toString()},!0),this._workTimeByType=null)}}var gl=n("Z/4N");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const hl={1:"Latency",8:"Throughput"};var fl=n("Hm+e"),ml=n("t6P7"),bl=n("lKf0"),_l=n("YxC/"),yl=n("JhlA"),vl=n("1SVz");function Sl(e){const t=e.getState();if(Object(ws.b)(t))e.dispatch(Object(Ca.b)("serverUnavailableNotification")),e.dispatch(Object(Kn.f)());else{if(Object(mc.d)(t))return;const n=Object(xo.a)(t)===zo.a.MobileApplication,r=Object(Hi.c)(t,Gi.l),a=Object(xs.v)(t),i=r||a?null:{actionLabel:Object(_l.b)(t,bl.k)||"Reconnect",eventHandler:()=>{e.dispatch(Object(Kn.g)(Object(_l.b)(t,yl.e)||"Reconnecting...",Object(_l.b)(t,yl.f)||vl.b,Object(_l.b)(t,yl.d)||vl.a))}},o=a?Object(_l.b)(t,yl.i)||"You are now working in offline mode.":Object(_l.b)(t,bl.m)||"The application has lost connectivity to the server. You might not see all the records as you are offline.",s={id:"serverUnavailableNotification",level:Object(Lo.a)(e.getState())?4:3,message:o,title:null,action:i,type:1,onCloseHandler:null,showCloseButton:n};e.dispatch(Object(Oa.b)(s)),n||!Object(Hi.c)(t,Gi.n)||Object(Lo.c)(t)||e.dispatch(Object(Kn.h)(Xn.a.BlockingUI))}}var Ol=n("6/BY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Cl(e,t){e.DataSource.saveSessionState("LastAccessedApp",null,!1),t.dispatch(Object(ft.b)(null))}var El=n("0iNb");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Il{constructor(e,t,n,r){this._baseURL=e,this._pageTypeExtractor=n||this._extractPageType,this._registerMappings(t),this._decorator=r}getPageFromUrl(e,t={}){const n=t.source?t.source:Ks.b.Other,r=new ji.a(e),a={pageName:e},i=this.getMappingForPage(a);let o=null,s=null,c=!1,l=!1;try{if(!i)throw Object(d.d)("Unknown page type",2415919105);s=i.urlToInput(r),o=i.factory,this._decorator&&(s=this._decorator.decorateInput(s,e,n)),o.throwIfInvalidUrl&&o.throwIfInvalidUrl(s)}catch(e){throw Object(d.b)(e,[{name:"pageName",value:a.pageName},{name:"source",value:n}]),e}return this._isDialogMapping(i)&&(c=!0),i.isRedirect&&(l=i.isRedirect),{factory:o,input:s,isDialog:c,isRedirect:l,mapping:i}}getPageFromPageName(e,t={}){const n=t.source?t.source:Ks.b.Other;let r=!1;const a=this._pageModulesByName[e.pageName];try{if(!a)throw Object(d.d)("Unknown page type",2415919105);this._isDialogMapping(a)&&(r=!0),e.input&&(e.input.pageType=e.input.pageType?e.input.pageType:a.pageType)}catch(t){throw t.errorCode||(t.errorCode=2415919107),Object(d.b)(t,[{name:"pageName",value:e.pageName},{name:"source",value:n}]),t}return{factory:a.factory,input:e.input,isDialog:r,isRedirect:a.isRedirect,mapping:a}}_isDialogMapping(e){return e.type===Ks.a.Dialog}getUrlForPage(e,t,n,r=Ks.b.Other,a=!1){const i=new ji.a(this._baseURL.toString()),o=i.searchParams,{inputToUrl:s,pageType:c}=this._pageModulesByName[e];o.set("pagetype",c);const l=s(i.href,t,a);return this._decorator?this._decorator.decorateUrl(new ji.a(l),new ji.a(n),r,t,a).href:l}getWebUrlForPage(e,t,n){const{inputToWebUrl:r}=this._pageModulesByName[e];return r?r(n,t):""}getMobileClientUrlForPage(e,t,n,r=Ks.b.Other){const a=new ji.a("ms-dynamicsxrm:///?"),{inputToUrl:i,pageType:o}=this._pageModulesByName[e];if(this._isMobileSupportedPageType(o)){a.searchParams.set("pagetype",o);const e=i(a.href,t,!0);return this._decorator?this._decorator.decorateUrl(new ji.a(e),new ji.a(n),r,t,!1).href:e}const s=[{name:"pageName",value:e},{name:"currentUrl",value:n},{name:"source",value:r}];throw Object(d.d)("UnSupported Page Type",2415919105,s)}getMappingForPage(e){try{if(!Object(I.c)(e.pageName))return this._pageModulesByName[e.pageName];const t=new ji.a(e.pageName),n=this._mapPageType(this._pageTypeExtractor(t));return this._pageModulesByType[n]}catch(t){const n=[{name:"pageName",value:e.pageName}];throw Object(d.d)("Unknown page type",2415919105,n,t.stack)}}getFactoryForPage(e){try{if(!Object(I.c)(e.pageName)){const{factory:t}=this._pageModulesByName[e.pageName];return t}const t=new ji.a(e.pageName),n=this._mapPageType(this._pageTypeExtractor(t)),{factory:r}=this._pageModulesByType[n];return r}catch(t){const n=[{name:"pageName",value:e.pageName}];throw Object(d.d)("Unknown page type",2415919105,n,void 0,void 0,t.stack)}}getBaseUrl(){return this._baseURL.toString()}_registerMappings(e){this._pageModulesByType={},this._pageModulesByName={};for(const t of e)this._pageModulesByType[t.pageType]=t,this._pageModulesByName[t.factory.getName()]=t,t.otherPageTypesSupported&&t.otherPageTypesSupported.forEach(e=>{this._pageModulesByType[e]=t})}_extractPageType(e){return e.searchParams.get("pagetype")}_mapPageType(e){let t=e;return"create"===t?t="quickcreate":"entity"===t?t="entityrecord":"view"===t&&(t="entitylist"),t}_isMobileSupportedPageType(e){switch(e){case"entity":case"entityrecord":case"view":case"entitylist":case"create":case"quickcreate":case"dashboard":return!0;default:return!1}}}var wl=n("IfHN"),jl=n("EBJu"),Pl=n("Lohl"),Tl=n("BJ7u"),Nl=n("sYIp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Al={getName:()=>jl.a,getRequiredAttributes(){throw new Error("Not Implemented")},throwIfInvalidUrl(e){if(!e||!e.entityTypeName)throw Object(d.d)("Missing required URL parameter: etn",E.a)},preInitializePage(e){const{formId:t,entityTypeName:n,id:r,isPreview:a}=e,i=new vn.a(n,r);return{type:"preInitialize.quickCreateFormAction.async",execute:({dispatch:n,getState:r},o,s)=>{const c=o.TraceManager.getTracer("Forms.QuickCreate.QuickCreateFormFactory"),l=this.getTelemetryAttributes(e);return c.info("preInitializePage started.",l),a?Object(Nl.a)().then(({retrievePreviewForm:e})=>n(e()).then(e=>({updatedFormId:e,error:void 0})).catch(e=>({error:e,updatedFormId:void 0}))):n(Object(Pl.b)(i,t,Object(Tl.a)(9))).then(e=>(c&&(l.push({name:"updatedFormId",value:j.a.toString(e)}),c.info("preInitializePage completed.",l)),{updatedFormId:e,error:void 0})).catch(e=>(c&&(l.push({name:"error",value:e&&e.toString()}),c.error("preInitializePage failed.",l)),{updatedFormId:void 0,error:e}))}}},createPageModule:e=>Promise.all([n.e(2),n.e(6),n.e(0),n.e(1),n.e(3),n.e(4),n.e(5),n.e(8),n.e(7),n.e(100)]).then(n.bind(null,"fab1")).then(({QuickCreateForm:t})=>new t(e)),getTelemetryAttributes:e=>[{name:v.b.EntityName,value:e&&e.entityTypeName},{name:"entityId",value:e&&j.a.toString(e.id)},{name:"formId",value:e&&j.a.toString(e.formId)},{name:"isPreview",value:e&&e.isPreview}],getKeyForThawedCheck(e){const t=e.formId?e.formId.guid:"";return e.entityTypeName+t}};Object.freeze(Al);var Dl=n("iKQk"),Rl=n("N6E8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const xl={opacity:1,borderStyle:"solid",width:"100%",height:"100%",right:0,top:0,position:"absolute",openInNewWindow:!0,backgroundColor:"transparent",shadowColor:"rgba(0, 0, 0, 0.5)",overflow:"auto"},Ml={type:Ks.a.Dialog,pageType:"quickcreate",factory:Al,isRedirect:!0,getDialogOptions:e=>xl,urlToInput(e){let t=null;const n=e.searchParams,r=n.get(Nc.u),a=n.get(Nc.H),i=new Dl.a(n.get(Nc.v)),o=n.has(Nc.B)&&"true"===n.get(Nc.B).toLowerCase(),s="create"===a?"quickcreate":a;try{if(n.has(Nc.i)&&n.get(Nc.i)){const e=n.get(Nc.i),r=decodeURIComponent(e);t=JSON.parse(r)}}catch(e){throw Error(e)}if(n.has(Nc.v)){const e=i.toDictionary();t||(t={});for(const n of Object.keys(e))n in t||(t[n]=e[n])}return o?{pageType:s,entityTypeName:r,data:t,isPreview:o}:{pageType:s,entityTypeName:r,data:t}},inputToUrl(e,t){let n=Object.assign({},t.data);const r=new ji.a(e),a=r.searchParams,i=t.createFromEntity;if(a.set(Nc.u,t.entityTypeName),i&&!(n.hasOwnProperty(Rl.d+"id")&&n.hasOwnProperty(Rl.d+"type")&&n.hasOwnProperty(Rl.d+"name"))){const e={[Rl.d+"id"]:i.id.guid,[Rl.d+"type"]:i.etn,[Rl.d+"name"]:i.name};n=Object.assign(Object.assign({},n),e),t.data=n}if(n&&0!==Object.keys(n).length){const e=JSON.stringify(n),t=encodeURIComponent(e);a.set(Nc.i,t)}return r.href}};Object.freeze(Ml);var Fl=n("Qjw6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const kl={type:Ks.a.Dialog,pageType:"mainformdialog",factory:Fl.b,isRedirect:!0,getDialogOptions:e=>xl,urlToInput:e=>wl.a.urlToInput(e),inputToUrl:(e,t)=>wl.a.inputToUrl(e,t,!1)};Object.freeze(kl);var Ll=n("9egp"),Bl=n("d0w6"),Ul=n("BzGi"),Vl=n("AKum");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const zl={type:Ks.a.Page,pageType:"entitylist",factory:Ll.a,otherPageTypesSupported:["grid"],urlToInput(e){const t=e.searchParams,n={entityTypeName:t.get(Nc.u)};let r=j.a.tryParseOrNull(t.get(Nc.Y));if(r||(r=j.a.tryParseOrNull(t.get(Nc.x))),r){const e=t.get(Nc.Z),a=Wl(e);n.viewId=r,n.viewType=a}const a=t.has(Nc.v),i=new Dl.a(t.get(Nc.v)),o=a&&j.a.tryParseOrNull(i.get(Nc.ab));if(o&&(n.visualizationId=o),a&&i.has(Nc.bb)&&"1"===i.get(Nc.bb)&&(n.showChart=!0),a&&i.has(Nc.cb)){const e=i.get(Nc.cb),t=ql(e);n.visualizationType=t}if(t.has(Nc.H)){t.get(Nc.H);n.pageType="entitylist"}return n},inputToUrl(e,t){const n=new ji.a(e),r=n.searchParams;if(r.set(Nc.u,t.entityTypeName),t.viewId){const e=j.a.toString(t.viewId);e&&(r.set(Nc.Y,e),t.viewType&&r.set(Nc.Z,t.viewType.toString()))}const a=new Dl.a;let i=!1;if(t.visualizationId){const e=j.a.toString(t.visualizationId);e&&(a.set(Nc.ab,e),i=!0)}return t.showChart&&(a.set(Nc.bb,"1"),i=!0),t.visualizationType&&(a.set(Nc.cb,t.visualizationType.toString()),i=!0),i&&r.set(Nc.v,a.toString()),n.href},inputToWebUrl(e,t){const n=new ji.a(e),r=n.searchParams,a=t.entityTypeName;a&&r.set(Vl.c,a);const i=t.entityTypeCode;return i&&r.set(Vl.d,encodeURIComponent(`${Vl.b}=${i}`)),r.set(Vl.f,"entitylist"),t.viewType&&r.set(Vl.h,t.viewType.toString()),t.viewId&&r.set(Vl.g,j.a.externalGuid(t.viewId)),n.href}},Wl=e=>e&&parseInt(e,10)===Bl.b.userview?Bl.b.userview:Bl.b.savedview,ql=e=>e&&parseInt(e,10)===Ul.a.uservisualization?Ul.a.uservisualization:Ul.a.savedvisualization;Object.freeze(zl);var Hl=n("FdB0"),Gl=n("hIjC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Kl={getName:()=>Hl.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>Promise.all([n.e(2),n.e(6),n.e(0),n.e(1),n.e(3),n.e(4),n.e(5),n.e(8),n.e(7),n.e(23)]).then(n.bind(null,"Xzpw")).then(({Dialog:t})=>new t(e)),getTelemetryAttributes:e=>[{name:v.b.UniqueName,value:e&&e.uniqueName}],getKeyForThawedCheck:e=>e&&e.uniqueName,prePageRender:function(e,t,n,r){const a=r();if(Object(mc.d)(a))return Promise.resolve({resultType:uc.a.Success});const i=e,o=Object(Gl.c)()+".DialogPreCheck",s=t.TraceManager.getTracer(Object(Gl.d)());if(!i||!i.uniqueName||"string"!=typeof i.uniqueName||""===i.uniqueName.trim()){const e="Invalid unique name from the input";s.error(e);const n=Object.assign(new Error(e),{errorCode:-1});return t.EventManager.ReportComponentFailure(o,n),Promise.resolve({resultType:uc.a.Fail,resultValue:n})}const c=i.uniqueName;return n(Object(ie.b)(c)).then(e=>{if(j.a.isNullOrEmpty(e)){const e="retrieved form id is null or empty for dialog with unique name: "+c,t=Object.assign(new Error(e),{errorCode:-1});return s.error(e),{resultType:uc.a.Fail,resultValue:t}}return{resultType:uc.a.Success}},e=>({resultType:uc.a.Fail,resultValue:e}))}};Object.freeze(Kl);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Ql={type:Ks.a.Dialog,pageType:"dialog",factory:Kl,getDialogOptions:e=>({width:Dc,height:Rc,openInNewWindow:e.dialogOptions&&e.dialogOptions.openInNewWindow?e.dialogOptions.openInNewWindow:Ac,shadowColor:e.dialogOptions&&e.dialogOptions.shadowColor?e.dialogOptions.shadowColor:xc,overflow:"auto"}),urlToInput(e){const t=e.searchParams,n=t.get(Nc.D),r=n;let a,i;return t.has(Nc.n)&&(a=JSON.parse(t.get(Nc.n))),t.has(Nc.i)&&(i=JSON.parse(t.get(Nc.i))),{uniqueName:n,entityTypeName:r,data:i,dialogOptions:a}},inputToUrl(e,t){const n=new ji.a(e),r=n.searchParams;return r.set(Nc.D,t.uniqueName),t.data&&r.set(Nc.i,JSON.stringify(t.data)),t.dialogOptions&&r.set(Nc.n,JSON.stringify(t.dialogOptions)),n.href}};Object.freeze(Ql);var Xl=n("JDi5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Yl={getName:()=>Xl.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>Promise.all([n.e(9),n.e(2),n.e(6),n.e(10),n.e(11),n.e(13),n.e(12),n.e(15),n.e(17),n.e(101)]).then(n.bind(null,"CRmP")).then(({Search:t})=>new t(e)),getTelemetryAttributes:e=>[]};Object.freeze(Yl);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Jl={type:Ks.a.Page,pageType:"search",factory:Yl,urlToInput(e){const t=e.searchParams,n=t.get(Nc.S);let r,a,i=null;return t.has(Nc.T)&&t.get(Nc.T)&&(i=t.get(Nc.T).toLowerCase(),r=function(e){const t=+e;if(t||0===t)return t;return}(i)),t.has(Nc.H)&&t.get(Nc.H)&&(a=t.get(Nc.H)),{searchText:n,searchType:r,pageType:a}},inputToUrl(e,t){const n=new ji.a(e),r=n.searchParams;return r.set(Nc.S,t.searchText),(t.searchType||0===t.searchType)&&r.set(Nc.T,t.searchType.toString()),n.href}};Object.freeze(Jl);var $l=n("r0R4"),Zl=n("OKVy"),eu=n("6kq6"),tu=n("11K9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const nu={},ru={getName:()=>Zl.a,getRequiredAttributes(){throw new Error("Not Implemented")},preInitializePage:(e,t)=>({type:"preInitialize.dashboardAction.async",execute:({dispatch:n})=>{const r=n(Object(eu.a)(e));return nu[t]=e=>r.then(t=>n(e(t))),Promise.resolve()}}),createPageModule:e=>Promise.all([n.e(2),n.e(6),n.e(0),n.e(1),n.e(3),n.e(4),n.e(5),n.e(8),n.e(7),n.e(56)]).then(n.bind(null,"aTYF")).then(({Dashboard:t})=>{const n=nu[e];return delete nu[e],new t(e,n)}),getTelemetryAttributes:e=>Object(tu.a)(e,"PageNavigation"),getKeyForThawedCheck:e=>e.dashboardId&&e.dashboardId.guid};Object.freeze(ru);const au={type:Ks.a.Page,pageType:"dashboard",factory:ru,urlToInput(e){let t,n,r,a,i;const o=e.searchParams;o.has(Nc.G)&&o.get(Nc.G)&&(t=o.get(Nc.G)),o.has(Nc.H)&&(n=o.get(Nc.H)),o.has(Nc.u)&&o.get(Nc.u)&&(r=o.get(Nc.u)),o.has(Nc.W)&&o.get(Nc.W)&&(a=o.get(Nc.W).toLowerCase(),a!==se.a&&a!==se.b&&(a=null)),o.has(Nc.b)&&o.get(Nc.b)&&(i="true"===o.get(Nc.b));let s=j.a.tryParseOrNull(o.get(Nc.x));return j.a.isNullOrEmpty(s)&&(s=j.a.tryParseOrNull(o.get(Nc.h))),{navPath:t,dashboardId:s,pageType:n,etn:r,type:a,canOverride:i}},inputToUrl(e,t){const n=new ji.a(e),r=n.searchParams,a=j.a.toString(t.dashboardId);a&&r.set(Nc.x,a);const i=t.navPath;i&&r.set(Nc.G,i);const o=t.etn;o&&r.set(Nc.u,o);const s=t.type;s&&r.set(Nc.W,s);const c=t.canOverride;return c&&r.set(Nc.b,c.toString()),n.href},inputToWebUrl(e,t){const n=new ji.a(e),r=n.searchParams,a=j.a.toString(t.dashboardId);a&&r.set(Vl.e,a);const i=t.type;return i&&r.set(Vl.a,i),n.href}};Object.freeze(au);var iu=n("TQVK"),ou=n("0buK"),su=n("ZFkP");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const cu={getName:()=>ou.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>Promise.all([n.e(2),n.e(6),n.e(0),n.e(1),n.e(3),n.e(4),n.e(5),n.e(8),n.e(7),n.e(105)]).then(n.bind(null,"QH2d")).then(({TaskBasedFlow:t})=>new t(e)),getTelemetryAttributes:e=>[{name:v.b.UniqueName,value:e&&e.uniqueName},{name:v.b.EntityName,value:e&&e.entityTypeName}],prePageRender:(e,t,n,r)=>Object(su.b)(e,t,n,r)};Object.freeze(cu);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const lu={opacity:1,borderStyle:"solid",width:"100%",height:"100%",top:0,position:"absolute",openInNewWindow:!0,backgroundColor:"transparent",shadowColor:"rgba(0, 0, 0, 0.5)",overflow:"auto",shouldSupportRTL:!0},uu={type:Ks.a.Dialog,pageType:"taskbasedflow",factory:cu,getDialogOptions:e=>lu,urlToInput(e){const t=e.searchParams;return{entityTypeName:t.get(Nc.u),id:j.a.tryParseOrNull(t.get(Nc.x)),uniqueName:t.get(Nc.X)}},inputToUrl(e,t){const n=new ji.a(e),r=n.searchParams;return r.set(Nc.X,t.uniqueName),t.entityTypeName&&r.set(Nc.u,t.entityTypeName),t.id&&r.set(Nc.x,j.a.toString(t.id)),n.href}};Object.freeze(uu);var du=n("RIJJ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const pu={getName:()=>du.a,getRequiredAttributes:()=>[],throwIfInvalidUrl(e){if(!e||!e.url||!e.dialogOptions)throw Object(d.d)("Missing required URL parameters: Dialog Options",E.a)},createPageModule:e=>n.e(72).then(n.bind(null,"a0Rm")).then(({LegacyDialog:t})=>new t(e)),getTelemetryAttributes:e=>[{name:v.b.LegacyDialogUrl,value:e&&e.url}]};Object.freeze(pu);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const gu=!1,hu="100%",fu="100%",mu="rgba(0,0,0,0.5)",bu={type:Ks.a.Dialog,pageType:"legacydialog",factory:pu,getDialogOptions:e=>({width:hu,height:fu,openInNewWindow:gu,shadowColor:mu,overflow:"auto"}),urlToInput:e=>({}),inputToUrl:(e,t)=>e};Object.freeze(bu);var _u=n("2gMP");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const yu={getName:()=>_u.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>n.e(110).then(n.bind(null,"U/xE")).then(({WelcomePageDialog:t})=>new t(e)),getTelemetryAttributes:e=>[{name:v.b.WelcomePageName,value:e&&e.welcomePageName}]};Object.freeze(yu);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const vu=!1,Su="100%",Ou="100%",Cu="rgba(0, 0, 0, 0.5)",Eu={type:Ks.a.Dialog,pageType:"welcomePagedialog",factory:yu,getDialogOptions:e=>({width:Su,height:Ou,openInNewWindow:e.dialogOptions&&e.dialogOptions.openInNewWindow?e.dialogOptions.openInNewWindow:vu,shadowColor:e.dialogOptions&&e.dialogOptions.shadowColor?e.dialogOptions.shadowColor:Cu,overflow:"auto"}),urlToInput(e){const t=e.searchParams;let n,r;if(t.has("dialogOptions"))try{n=JSON.parse(t.get("dialogOptions"))}catch(e){throw Error(e)}return t.has("dialogWelcomePageName")&&(r=t.get("dialogWelcomePageName")),{dialogOptions:n,welcomePageName:r}},inputToUrl(e,t){const n=new ji.a(e),r=n.searchParams;return t.dialogOptions&&r.set("dialogOptions",JSON.stringify(t.dialogOptions)),t.welcomePageName&&r.set("dialogWelcomePageName",t.welcomePageName),n.href}};Object.freeze(Eu);var Iu=n("/2Q6"),wu=n("JTy6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ju={getName:()=>wu.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>Promise.all([n.e(2),n.e(6),n.e(0),n.e(1),n.e(3),n.e(4),n.e(5),n.e(8),n.e(7),n.e(76)]).then(n.bind(null,"RwSO")).then(({LookupDialog:t})=>new t(e)),getTelemetryAttributes:e=>[{name:v.b.LookupDialogParameters.DefaultEntityType,value:e&&e.defaultEntityType},{name:v.b.LookupDialogParameters.DefaultViewId,value:e&&e.defaultViewId},{name:v.b.LookupDialogParameters.EntityTypes,value:e&&e.entityTypes&&e.entityTypes.toString()},{name:v.b.LookupDialogParameters.ViewIds,value:e&&e.viewIds&&e.viewIds.toString()},{name:v.b.LookupDialogParameters.AllowMultiSelect,value:e&&e.allowMultiSelect},{name:v.b.LookupDialogParameters.SearchText,value:e&&e.searchText}]};Object.freeze(ju);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Pu={opacity:1,borderStyle:"solid",height:"100%",top:0,position:"absolute",openInNewWindow:!0,backgroundColor:"transparent",shadowColor:"rgba(0, 0, 0, 0.5)",overflow:"auto",width:"100%",shouldSupportRTL:!0},Tu={type:Ks.a.Dialog,pageType:"lookupdialog",factory:ju,getDialogOptions:e=>Pu,urlToInput(e){const t=e.searchParams,n=t.get("etn");return{lookupType:t.get("type"),defaultEntityType:n,defaultViewId:t.get("viewid")}},inputToUrl(e,t){const n=new ji.a(e),r=n.searchParams;return r.set("etn",t.defaultEntityType),r.set("type",t.lookupType),t.defaultViewId&&r.set("viewid",t.defaultViewId),n.href}};Object.freeze(Tu);var Nu=n("Nk+G");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Au={getName:()=>Nu.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>Promise.all([n.e(2),n.e(6),n.e(0),n.e(1),n.e(3),n.e(4),n.e(5),n.e(8),n.e(7),n.e(54)]).then(n.bind(null,"hHCe")).then(({CustomControl:t})=>new t(e)),getTelemetryAttributes:e=>[{name:v.b.CustomControlId,value:e?e.customControlId:""}]};Object.freeze(Au);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Du={type:Ks.a.Page,pageType:"control",factory:Au,otherPageTypesSupported:["customcontrol"],urlToInput(e){const t=e.searchParams;let n=t.get(Nc.g);const r=t.get(Nc.i)?JSON.parse(t.get(Nc.i)):null;n||(n=t.get(Nc.f));return{customControlId:n,data:r}},inputToUrl(e,t){const n=new ji.a(e),r=n.searchParams;return r.set(Nc.g,t.customControlId),t.data&&r.set(Nc.i,JSON.stringify(t.data)),n.href}};var Ru=n("5oHv");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const xu={getName:()=>Ru.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>Promise.all([n.e(2),n.e(6),n.e(0),n.e(1),n.e(3),n.e(4),n.e(5),n.e(8),n.e(7),n.e(71)]).then(n.bind(null,"QO6+")).then(({KbSearch:t})=>new t(e)),getTelemetryAttributes:e=>[]};Object.freeze(xu);function Mu(e){return null==e}const Fu={type:Ks.a.Page,pageType:"kbsearch",factory:xu,urlToInput(e){const t=e.searchParams,n=t.get("query"),r=t.get("showFilter"),a=t.get("showLang"),i=t.get("lang"),o=t.get("results"),s=t.get("blockClick"),c=t.get("filter"),l=t.get("sort"),u=t.get("enableSelection"),d=t.get("enableContextualActions"),p=t.get("entityName"),g=t.get("autoSuggestionField");return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n&&{query:n}),r&&{showFilter:"0"!==r}),a&&{showLang:"1"===a}),i&&{lang:i}),o&&{results:parseInt(o,10)}),s&&{blockClick:"1"===s}),c&&{filter:c}),l&&{sort:parseInt(l,10)}),u&&{enableSelection:"1"===u}),d&&{enableContextualActions:"1"===d}),p&&{entityName:p}),g&&{autoSuggestionField:g})},inputToUrl(e,t){const n=new ji.a(e),r=n.searchParams;return t.query&&r.set("query",t.query),!Mu(t.showFilter)&&r.set("showFilter",t.showFilter?"1":"0"),!Mu(t.showLang)&&r.set("showLang",t.showLang?"1":"0"),t.lang&&r.set("lang",t.lang),t.results&&r.set("results",t.results.toString()),!Mu(t.blockClick)&&r.set("blockClick",t.blockClick?"1":"0"),t.filter&&r.set("filter",t.filter),t.sort&&r.set("sort",t.sort.toString()),!Mu(t.enableSelection)&&r.set("enableSelection",t.enableSelection?"1":"0"),!Mu(t.enableContextualActions)&&r.set("enableContextualActions",t.enableContextualActions?"1":"0"),t.entityName&&r.set("entityName",t.entityName),t.autoSuggestionField&&r.set("autoSuggestionField",t.autoSuggestionField),n.href}};var ku=n("qk+o");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Lu={getName:()=>ku.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>Promise.all([n.e(2),n.e(6),n.e(0),n.e(1),n.e(3),n.e(4),n.e(5),n.e(8),n.e(7),n.e(70)]).then(n.bind(null,"c3fe")).then(({KbArticle:t})=>new t(e)),getTelemetryAttributes:e=>[]};Object.freeze(Lu);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Bu={type:Ks.a.Page,pageType:"kbarticle",factory:Lu,urlToInput:e=>({articleId:e.searchParams.get("articleId")}),inputToUrl(e,t){const n=new ji.a(e);return n.searchParams.set("articleId",t.articleId),n.href}};var Uu=n("lcRi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Vu={getName:()=>Uu.a,getRequiredAttributes:()=>[],createPageModule:e=>Promise.all([n.e(2),n.e(6),n.e(0),n.e(1),n.e(3),n.e(4),n.e(5),n.e(8),n.e(7),n.e(46)]).then(n.bind(null,"B822")).then(({Benchmark:t})=>new t(e)),getTelemetryAttributes:e=>[{name:v.b.BenchmarkControlName,value:e&&e.controlName},{name:v.b.BenchmarkElementNumber,value:e&&e.elementNumber},{name:v.b.EntityName,value:e&&e.entityTypeName}]};Object.freeze(Vu);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const zu={type:Ks.a.Page,pageType:"benchmark",factory:Vu,isRedirect:!0,urlToInput:e=>({}),inputToUrl:(e,t)=>e,inputToWebUrl:(e,t)=>e};Object.freeze(zu);var Wu=n("TKDo");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const qu={getName:()=>Wu.a,getRequiredAttributes:()=>[],throwIfInvalidUrl(e){if(!e||!e.uniqueName)throw Object(d.d)("Missing required URL parameter: name",E.a)},createPageModule:e=>Promise.all([n.e(2),n.e(6),n.e(0),n.e(1),n.e(3),n.e(4),n.e(5),n.e(8),n.e(7),n.e(23)]).then(n.bind(null,"Xzpw")).then(({Dialog:t})=>new t(e)),getTelemetryAttributes:e=>[{name:v.b.UniqueName,value:e&&e.uniqueName}],getKeyForThawedCheck:e=>e&&e.uniqueName};Object.freeze(qu);const Hu={type:Ks.a.Page,pageType:"inlinedialog",factory:qu,urlToInput(e){const t=e.searchParams,n=t.get(Nc.D),r=n;let a=null,i=null;try{t.has(Nc.n)&&(a=JSON.parse(t.get(Nc.n))),a=Object.assign(Object.assign({},a),{windowPosition:"inline"}),t.has(Nc.i)&&(i=JSON.parse(t.get(Nc.i)))}catch(e){throw{name:"Inline Dialog: Invalid JSON",message:`Invalid JSON in dialogOptions or data. Reason: "${e.message}"`}}return{uniqueName:n,entityTypeName:r,data:i,dialogOptions:a}},inputToUrl(e,t){const n=new ji.a(e),r=n.searchParams;r.set(Nc.D,t.uniqueName),t.data&&r.set(Nc.i,JSON.stringify(t.data));const a=Object.assign(Object.assign({},t.dialogOptions),{windowPosition:"inline"});return r.set(Nc.n,JSON.stringify(a)),n.href}};Object.freeze(Hu);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Gu{constructor(e){if(!e)throw new Error("decoratorList parameter must not be null");this._decoratorList=e}decorateUrl(e,t,n,r,a){return this._decoratorList.reduce((e,i)=>i.decorateUrl(e,t,n,r,a),e)}decorateInput(e,t,n){for(const r of this._decoratorList)r.decorateInput(e,t,n);return e}addDecorator(e){e&&this._decoratorList&&this._decoratorList.push(e)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ku(e,t,n,r){const a=e.searchParams;return void 0!==r.cmdbar&&a.set(Nc.e,r.cmdbar.toString()),void 0!==r.navbar&&a.set(Nc.E,qn.a[r.navbar].toLowerCase()),e}function Qu(e,t,n){return e}var Xu=n("nDua");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Yu(e,t,n,r){const a=e.searchParams;if(r&&r.appId&&n===Ks.b.SwitchApp)a.set("appid",r.appId);else if(r&&r.appshellmode&&r.appshellmode===Xu.a.ADVANCED||n===Ks.b.AdvancedInAppShell)a.set(Xu.a.APP_SHELL_QUERY_PARAM,Xu.a.ADVANCED);else if(n===Ks.b.Other){const e=t.searchParams.get(Xu.a.APP_SHELL_QUERY_PARAM);e&&a.set(Xu.a.APP_SHELL_QUERY_PARAM,e)}return e}function Ju(e,t,n){const r=new ji.a(t).searchParams.get(Xu.a.APP_SHELL_QUERY_PARAM);return r?e.appshellmode=r:n===Ks.b.AdvancedInAppShell&&(e.appshellmode=Xu.a.ADVANCED),e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function $u(e,t,n,r,a){if(a&&"/nga/main.htm"===e.pathname&&e.host===t.host){const t=new ji.a(e.href);t.pathname="/main.aspx";for(const e of["liveid","installid","org"])t.searchParams.delete(e);return t}return e}function Zu(e,t,n){return e}var ed=n("uAcA");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const td={getName:()=>ed.a,getRequiredAttributes(){throw new Error("Not Implemented")},throwIfInvalidUrl(){},preInitializePage:()=>({type:"preInitialize.offlineStatusDialog.async",execute:()=>Promise.resolve({})}),createPageModule:e=>Promise.all([n.e(9),n.e(16),n.e(20),n.e(31),n.e(0),n.e(1),n.e(3),n.e(4),n.e(5),n.e(94)]).then(n.bind(null,"vCHt")).then(({OfflineStatusDialogForm:t})=>new t(e)),getTelemetryAttributes:()=>[]};Object.freeze(td);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const nd={opacity:1,borderStyle:"solid",width:"100%",height:"100%",right:0,top:0,position:"absolute",openInNewWindow:!0,backgroundColor:"transparent",shadowColor:"rgba(0, 0, 0, 0.5)",overflow:"auto"},rd={type:Ks.a.Dialog,pageType:"offlinestatusform",factory:td,isRedirect:!1,getDialogOptions:e=>Object.assign(Object.assign({},nd),e.dialogOptions),urlToInput:e=>({}),inputToUrl:(e,t)=>e};Object.freeze(rd);var ad=n("baQL");const id={getName:()=>ad.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>Promise.all([n.e(2),n.e(10),n.e(11),n.e(13),n.e(117),n.e(0),n.e(4),n.e(8),n.e(7),n.e(99)]).then(n.bind(null,"Hv5K")).then(({Query:t})=>new t(e)),getTelemetryAttributes:e=>[]};Object.freeze(id);const od={type:Ks.a.Page,pageType:"query",factory:id,urlToInput(e){let t;const n=e.searchParams;return n.has(Nc.H)&&(t=n.get(Nc.H)),{pageType:t}},inputToUrl:(e,t)=>new ji.a(e).href,inputToWebUrl:(e,t)=>new ji.a(e).href};Object.freeze(od);var sd=n("q27N");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var cd=n("0kGT"),ld=n("UqMU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class ud{constructor(e){this._store=e}HistoryBack(e){const t=Object(vc.e)(this._store.getState());if(e&&e.backToRoot){const e=Object(vc.a)(this._store.getState(),t).history;this._store.dispatch(Object(ld.d)(t,[e[0]]))}else this._store.dispatch(Object(ld.c)(t));const n=Object(vc.a)(this._store.getState(),t).history,r=n[n.length-1],a=new Xs.a;a.state=r.state,this._onPop(a)}PushState(e,t,n){const r=Object(vc.e)(this._store.getState());n.source!==Ks.b.SiteMap&&n.source!==Ks.b.SiteMapSubArea?this._store.dispatch(Object(ld.a)(r,e,t)):this._store.dispatch(Object(ld.e)(r,e,t))}ClearHistory(){this._store.dispatch(Object(ld.b)(Object(vc.e)(this._store.getState())))}ReplaceState(e,t){const n=Object(vc.e)(this._store.getState());this._store.dispatch(Object(ld.e)(n,e,t))}GetCurrentUrl(){}GetHistoryLength(){return Object(vc.d)(this._store.getState()).history.length}GetState(){const e=Object(vc.d)(this._store.getState());return e.history[e.history.length-1].state}RegisterOnBeforeUnload(e){}RegisterOnPopState(e){this._onPop=e}Dispose(){this._onPop=void 0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var dd=n("q6Ks"),pd=n("5ZBI"),gd=n("oAUI");class hd{constructor(e){this._lastState=null,this._getThemingData=null,this._getClientData=null,this._getFormattingData=null,this._utilsData=null,this._lastReturn=null,this._getClientData=Object(dd.b)(),this._getFormattingData=Object(dd.c)(),this._getThemingData=Object(dd.d)(e),this._utilsData=Object(dd.e)(e)}getCommonPropertyBagData(e){let t=[];if(!this._lastState||this._lastState!==e){this._lastState=e;const n=this._getClientData(e),r=this._getFormattingData(e),a=this._getThemingData(e);this._lastReturn&&this._lastReturn.response.clientData===n.response&&this._lastReturn.response.formattingData===r.response&&this._lastReturn.response.themingData===a.response||(t=t.concat(n.updatedProperties,r.updatedProperties,a.updatedProperties),this._lastReturn={response:{utilsData:this._utilsData,themingData:a.response,formattingData:r.response,clientData:n.response},updatedProperties:t,ancillaryData:n.ancillaryData})}return this._lastReturn}}var fd=n("clbQ");var md=n("SJ2k"),bd=n("a8hT"),_d=n("Er26"),yd=n("z+5+");var vd=n("QARO"),Sd=n("xAwK"),Od=n("a475");var Cd=n("Rj8P"),Ed=n("69gE"),Id=n("Nzmy"),wd=n("rzss"),jd=n("fILV"),Pd=n("cfbi"),Td=n("iF9X"),Nd=n("8CLP"),Ad=n("qCX6"),Dd=n("03Hu"),Rd=n("/BiW"),xd=n("UGwp"),Md=n("UZFl"),Fd=n("JEu3"),kd=n("lMS8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Ld={getOfflineProvider:function(){return Ad.a.get_instance()},getOfflineDataSource:function(){return Dd.a.get_DefaultInstance()}};var Bd=n("ZIjf"),Ud=n("ghNp"),Vd=n("3yqi"),zd=n("IaGr");function Wd(e){return"ClientApiFrame_"+e}var qd=n("qshH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Hd=n("VWP5"),Gd=n("7ZMh"),Kd=n("Wlg7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Qd extends Kd.a{constructor(e,t){super(t),this._url=e}get url(){return this._url}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Xd{constructor(e,t){this._eventNames={beforeOnLoad:"beforeOnload",onOpenUrl:"onOpenURL",panelOnMessageReceived:"panelOnMessageReceived",panelOnSizeChange:"panelOnSizeChange",panelOnStateChange:"panelOnStateChange"},this._tracing=e,this._scriptManager=t,this._scriptManager.initializeContainerForClientApi("crm_header_global",!1),this._container=null,this._reset()}getContainer(){return this._container||(this._container=this._scriptManager.getContainer("crm_header_global")),this._container}_getAttributeEventNameKey(e,t){return e.concat("_",t)}_lockHandler(e,t){const n=this._getAttributeEventNameKey(e,t);this._lockedHandlers[n]=!0}_isHandlerLocked(e,t){const n=this._getAttributeEventNameKey(e,t);return this._lockedHandlers[n]}_unlockHandler(e,t){const n=this._getAttributeEventNameKey(e,t);if(this._lockedHandlers[n])this._lockedHandlers[n]=!1;else{const e=[];e.push({name:"EventKey",value:n}),e.push({name:"EventName",value:t}),this._tracing.error("Event handler was NOT LOCKED as expected")}}_handleError(e,t){e(Object(Gd.a)("crm_header_global",new Io.a(void 0,2153976091,void 0,void 0,void 0,t)))}runBeforeOnLoad(e,t,n){return this._executeGlobalEventHandler(this._eventNames.beforeOnLoad,t,this._beforeOnLoadEvents,e,n)}addBeforeOnLoad(e){this._addEvent(this._beforeOnLoadEvents,e,this._eventNames.beforeOnLoad)}removeBeforeOnLoad(e){this._removeEvent(this._beforeOnLoadEvents,e)}runOnOpenUrl(e,t,n,r){const a=new Qd(t,!1);return{type:"globalEventManager.execute.globalEventHandler",sync:!0,execute:(t,i,o)=>{const s=t.dispatch(Object(Ud.b)(e,n)),c=s?s.getControl(r):null;return t.dispatch(this._executeGlobalEventHandler(this._eventNames.onOpenUrl,e,this._onOpenUrlEvents,c,s,a))}}}addOnOpenUrl(e){this._addEvent(this._onOpenUrlEvents,e,this._eventNames.onOpenUrl)}removeOnOpenUrl(e){this._removeEvent(this._onOpenUrlEvents,e)}runPanelOnMessageReceived(e,t,n){return this._panelOnMessageReceivedEvents[e]||(this._panelOnMessageReceivedEvents[e]=[]),this._executeGlobalEventHandler(this._eventNames.panelOnMessageReceived,"crm_header_global",this._panelOnMessageReceivedEvents[e],t,null,n)}addPanelOnMessageReceived(e,t){this._panelOnMessageReceivedEvents[e]||(this._panelOnMessageReceivedEvents[e]=[]),this._addEvent(this._panelOnMessageReceivedEvents[e],t,this._eventNames.panelOnMessageReceived)}removePanelOnMessageReceived(e,t){this._panelOnMessageReceivedEvents[e]||(this._panelOnMessageReceivedEvents[e]=[]),this._removeEvent(this._panelOnMessageReceivedEvents[e],t)}runPanelOnSizeChange(e,t){return this._panelOnSizeChangeEvents[e]||(this._panelOnSizeChangeEvents[e]=[]),this._executeGlobalEventHandler(this._eventNames.panelOnSizeChange,"crm_header_global",this._panelOnSizeChangeEvents[e],t)}addPanelOnSizeChange(e,t){this._panelOnSizeChangeEvents[e]||(this._panelOnSizeChangeEvents[e]=[]),this._addEvent(this._panelOnSizeChangeEvents[e],t,this._eventNames.panelOnSizeChange)}removePanelOnSizeChange(e,t){this._panelOnSizeChangeEvents[e]||(this._panelOnSizeChangeEvents[e]=[]),this._removeEvent(this._panelOnSizeChangeEvents[e],t)}runPanelOnStateChange(e,t){return this._panelOnStateChangeEvents[e]||(this._panelOnStateChangeEvents[e]=[]),this._executeGlobalEventHandler(this._eventNames.panelOnStateChange,"crm_header_global",this._panelOnStateChangeEvents[e],t)}addPanelOnStateChange(e,t){this._panelOnStateChangeEvents[e]||(this._panelOnStateChangeEvents[e]=[]),this._addEvent(this._panelOnStateChangeEvents[e],t,this._eventNames.panelOnStateChange)}removePanelOnStateChange(e,t){this._panelOnStateChangeEvents[e]||(this._panelOnStateChangeEvents[e]=[]),this._removeEvent(this._panelOnStateChangeEvents[e],t)}_executeGlobalEventHandler(e,t,n,r,a,i){if(!this._scriptManager.containerExists("crm_header_global")){const t=[];return t.push({name:"ContainerId",value:"crm_header_global"}),t.push({name:"EventName",value:e}),this._tracing.error("Global event was cancelled as the container does not exist",t),{type:"globalEventManager.execute.globalEventHandler",sync:!0,execute:(e,t)=>!1}}return{type:"globalEventManager.execute.globalEventHandler",sync:!0,execute:(o,s)=>{if(this._isHandlerLocked("_global",e))return!1;let c;this._lockHandler("_global",e);try{c=this._executeEventHandler(s,n,o,t,r,a,i),this._unlockHandler("_global",e)}catch(t){this._unlockHandler("_global",e),this._handleError(o.dispatch,t),c=!1}return c}}}_executeEventHandler(e,t,n,r,a,i,o){if(0!==t.length)for(let s=0;s<t.length;s++)this._executeIndividualEvent(e,t[s],s,n,r,a,i,o);return!(o&&o instanceof Kd.a)||o.isDefaultPrevented()}_executeIndividualEvent(e,t,n,r,a,i,o,s){let c=t.Parameters;try{if(t.PassExecutionContext){const e=new Hd.a(r,a,i,n,s,o);c=c&&c.length?[e].concat(t.Parameters):[e]}const e={sourceName:"globalEvent.executeHandler"};e.eventParameters=[{name:"eventName",value:t.EventName}],Object(Zc.b)("globalEvent.executeHandler",()=>{t.func?(e.eventParameters.push({name:v.b.WebResourceParameterNames.FunctionName,value:t.func.name}),this.getContainer().executeFunction(t.func,c)):t.FunctionName&&(e.eventParameters.push({name:v.b.WebResourceParameterNames.FunctionName,value:t.FunctionName}),this.getContainer().execute(t.FunctionName,c))})}catch(e){return this._handleError(r.dispatch,e),!1}return!0}_addEvent(e,t,n){e&&t&&e.push({EventName:n,PassExecutionContext:!0,func:t})}_removeEvent(e,t){for(let n=0;n<e.length;n++)if(e[n].func===t){e.splice(n,1);break}}_reset(){this._beforeOnLoadEvents=[],this._onOpenUrlEvents=[],this._panelOnMessageReceivedEvents={},this._panelOnSizeChangeEvents={},this._panelOnStateChangeEvents={},this._lockedHandlers={}}}class Yd{constructor(e,t,n){this._subscriptions=[],this._subscribers=[],this._id=e,this._onMessageReceived=t,this._channelManager=n}sendTo(e,t){this._channelManager.sendMessage(this,e,t)}sendToSubscribers(e){this.sendTo(this.getSubscribers().slice(0),e)}subscribeTo(e){this._channelManager.subscribe(this,e)}unsubscribeFrom(e){this._channelManager.unsubscribe(this,e)}getChannelId(){return this._id}getSubscriptions(){return Object.freeze(this._subscriptions)}setOnMesseageReceivedHandler(e){this._onMessageReceived=e}getSubscribers(){return Object.freeze(this._subscribers)}getOnMessageReceivedHandler(){return this._onMessageReceived}setSubscriptions(e){this._subscriptions=e}setSubscribers(e){this._subscribers=e}}class Jd{constructor(e){this._channels={},this._tracing=e}createChannel(e,t){if(this._channels[e])throw Object(d.d)("Cannot create new channel using existing channel ID",Jd.DUPLICATE_CHANNEL_ERROR_ID,[{name:"ChannelId",value:e}]);return this._channels[e]=new Yd(e,t,this)}getChannel(e){return this._channels[e]}destroyChannel(e){this._assertChannel(e);for(const t of e.getSubscribers()){this._channels[t].unsubscribeFrom([e.getChannelId()])}e.unsubscribeFrom(e.getSubscriptions().slice(0)),delete this._channels[e.getChannelId()]}sendMessage(e,t,n){if(this._assertChannel(e),t){t=this._ensureStringArray(t);for(const r of t)if(this._channels[r]){const t=this._channels[r].getOnMessageReceivedHandler();t&&t(n,e.getChannelId())}else this._tracing.warn("Channel was not found",[{name:"ChannelId",value:r}])}else this._tracing.error("toChannels parameter is null",[{name:"from_channel_id",value:e.getChannelId()}])}subscribe(e,t){if(this._assertChannel(e),t){t=this._ensureStringArray(t);for(const n of t){const t=this._channels[n];if(t){const r=t.getSubscribers().slice(0);-1===r.indexOf(e.getChannelId())&&(r.push(e.getChannelId()),t.setSubscribers(r));const a=e.getSubscriptions().slice(0);-1===a.indexOf(n)&&(a.push(n),e.setSubscriptions(a))}else this._tracing.error("Channel being subscribed to does not exist",[{name:"ChannelId",value:n}])}}else this._tracing.error("toChannels parameter is null",[{name:"subscriber_channel_id",value:e.getChannelId()}])}unsubscribe(e,t){if(this._assertChannel(e),t){t=this._ensureStringArray(t);for(const n of t){const t=this._channels[n];t&&t.setSubscribers(this._removeItemsFromArray(t.getSubscribers(),e.getChannelId())),e.setSubscriptions(this._removeItemsFromArray(e.getSubscriptions(),n))}}else this._tracing.error("toChannels parameter is null",[{name:"subscriber_channel_id",value:e.getChannelId()}])}_assertChannel(e){if(!this._channels[e.getChannelId()])throw Object(d.d)("Unregistered Channel ID",Jd.UNREGISTERED_ERROR_ID,[{name:"ChannelId",value:e.getChannelId()}]);if(this._channels[e.getChannelId()]!==e)throw Object(d.d)("Unauthorized Channel ID",Jd.UNAUTHORIZED_ERROR_ID,[{name:"ChannelId",value:e.getChannelId()}])}_removeItemsFromArray(e,t){return e.filter(e=>e!==t)}_ensureStringArray(e){return"string"==typeof e?[e]:e}}Jd.UNAUTHORIZED_ERROR_ID=1879375873,Jd.UNREGISTERED_ERROR_ID=1879375874,Jd.DUPLICATE_CHANNEL_ERROR_ID=1879375875;var $d=n("N0PS"),Zd=n("dHD5");class ep{constructor(e,t){this._xrmObjectCache={};if(!e){const e=new Error("Required parameter is null or undefined: store");throw zd.a.getInstance().traceManager.getTracer("ClientApi.ClientApiEntry.constructor").error(e.message),e}t===cr.d&&(t=null),this._store=e,this._pageId=t}get primaryContextToken(){return this._primaryContextToken}set primaryContextToken(e){if(this._primaryContextToken){const t=[];t.push({name:"CurrentKey",value:Object(Zd.v)(this._primaryContextToken)}),t.push({name:"NewKey",value:Object(Zd.v)(e)});const n=new Error("ClientApiEntry.primaryContextToken can only be set once");throw zd.a.getInstance().traceManager.getTracer("ClientApi.ClientApiEntry.primaryContextToken.set").error(n.message),n}this._primaryContextToken=e}get xrmObjectCache(){return this._xrmObjectCache}get xrmInstance(){return this._xrmInstance||(this._xrmInstance=this._store.dispatch(Object($d.b)(this._pageId))),this._xrmInstance}}var tp=n("16wZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class np{constructor(e){this._cache={};e||Object(tp.j)("ClientApi.ClientApiManager.constructor","store"),this._store=e}getClientApiEntry(e){e||(e=cr.d,zd.a.getInstance().traceManager.getTracer("ClientApi.ClientApiManager.getClientApiEntry").error("Missing pageId"));let t=this._cache[e];return t||(t=new ep(this._store,e),this._cache[e]=t),t}removeClientApiEntry(e){this._cache[e]&&(delete this._cache[e],Bd.a.instance.sendReportData())}static get usageCounters(){return Bd.a.instance}}var rp=n.p+"scripts/cordovaAndroid.js?v=1.4.9962-v91onpremise",ap=n.p+"scripts/cordovaIOS.js?v=1.4.9962-v91onpremise";var ip=n.p+"resources/styles/LoadingStylesAndroid.css?v=1.4.9962-v91onpremise";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class op{getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{DisplayName:{typeName:"Edm.String",structuralProperty:1},IconPath:{typeName:"Edm.String",structuralProperty:1},LastAccessedStr:{typeName:"Edm.String",structuralProperty:1},EntityTypeName:{typeName:"Edm.String",structuralProperty:1},ObjectId:{typeName:"Edm.String",structuralProperty:1},PinStatus:{typeName:"Edm.Boolean",structuralProperty:1},RecordType:{typeName:"Microsoft.Dynamics.CRM.RecentlyViewedRecordType",structuralProperty:3,enumProperties:[,{name:"Entity",value:0},{name:"Grid",value:1},{name:"Isv",value:2},{name:"Invalid",value:-1}]},IsUserView:{typeName:"Edm.Boolean",structuralProperty:1},Title:{typeName:"Edm.String",structuralProperty:1},IsDeleted:{typeName:"Edm.Boolean",structuralProperty:1}}}}}var sp=n("5bWN");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function cp(e,t){return{type:"recentItems.pushToServer.async",execute:({dispatch:n,getState:r},a)=>function(e,t,n){const r=[];return t.forEach(t=>{if(Object(sp.a)(t,e)){const e=i(t,!1);r.push(e)}}),n.forEach(t=>{if(Object(sp.a)(t,e,!0)){const e=i(t,!0);r.push(e)}}),e.DataSource.UpdateRecentItems(r,null).nativePromise().catch(a);function a(t){return e.TraceManager.getTracer("Recents").error("Pushing recent items to server failed with error: "+t.get_Message()),Promise.reject(t)}function i(e,t){const n=new op;return n.EntityTypeName=e.EntityTypeName,n.LastAccessedStr=e.LastAccessed.toISOString(),n.ObjectId=j.a.externalGuid(e.ObjectId),null!==e.PinStatus&&void 0!==e.PinStatus&&(n.PinStatus=e.PinStatus),n.RecordType=e.RecordType,n.IsUserView=e.IsUserView,n.Title=e.Title,n.IconPath=e.IconPath,n.IsDeleted=t,n}}(a,e,t)}}function lp(){return{type:"retrieve.recentItems.fromLocal.async",execute:({dispatch:e},t)=>function(e,t){return e(Object(Uo.a)("recentItemsInformation")).then(e=>{const n=[];return(e||[]).map(up).forEach(e=>{Object(sp.a)(e,t)&&n.push(e)}),Promise.resolve(n)},e=>(t.TraceManager.getTracer("RecentItems").warn("Error on recent items from local store retrieval:"+e.message),Promise.resolve([])))}(e,t)}}function up(e){return e.LastAccessed instanceof Date||(e.LastAccessed=new Date(e.LastAccessed)),!e.ObjectId||!e.ObjectId.guid||e.ObjectId instanceof j.a||(e.ObjectId=new j.a(e.ObjectId.guid)),e}var dp=n("Xi8U"),pp=n("Brg7");class gp{constructor(e){this._isPushScheduled=!1,this._isFetchScheduled=!1,this._store=e}initialize(e){this._fetchDataFromLocal(e),this._scheduleTheFetchOnAppIdle()}_getFetchRecents(){if(function(e,t){if(t)return!1;if(null==e)return!0;return Date.now()-e.getTime()>6e5}(Object(dp.j)(this._store.getState()),this._isFetchScheduled))return this._scheduleTheFetchOnAppIdle}_scheduleTheFetchOnAppIdle(e=3){0===e||this._isFetchScheduled||(this._isFetchScheduled=!0,this._mruSnapshotBeforeFetch||(this._mruSnapshotBeforeFetch=Object(dp.h)(this._store.getState())),Object(M.b)(()=>{const t=new Date,n=this._store.getState();Object(ws.b)(n)?this._store.dispatch(Object(qr.f)()).then(e=>this._handleSuccessOnFetch(t,e),()=>{this._isFetchScheduled=!1,this._scheduleTheFetchOnAppIdle(e-1)}):this._isFetchScheduled=!1},"Retrieve recent items"))}_fetchDataFromLocal(e){return this._store.dispatch(lp()).then(t=>(this._reportRecentItem(t,e),this._store.dispatch(Object(qr.e)(t))))}_putRecentItemsToLocalStorage(){const e=Object(dp.h)(this._store.getState());this._store.dispatch(function(e){return{type:"save.recentItems.toLocal.async",execute:({dispatch:t})=>t(Object(Vo.a)("recentItemsInformation",e,!1))}}(e))}_handleSuccessOnFetch(e,t){this._isFetchScheduled=!1,this._store.dispatch(Qr(e)),this._store.dispatch(Object(qr.e)(t,this._mruSnapshotBeforeFetch)),this._store.dispatch(Object(pp.a)((e,n)=>Object(dp.i)(e,t))),window.setTimeout(()=>{this._mruSnapshotBeforeFetch=Object(dp.h)(this._store.getState()),this._putRecentItemsToLocalStorage()})}_scheduleThePushOnIdle(e,t){this._isPushScheduled||(this._isPushScheduled=!0,Object(M.b)(()=>{const n=this._store.getState(),r=Object(dp.f)(n),a=Object(dp.b)(n);if(r.length>0||a.length>0){if(!Object(ws.b)(n))return this._putRecentItemsToLocalStorage(),void(this._isPushScheduled=!1);const i=new Date;this._store.dispatch(cp(r,a)).then(()=>this._handleSuccessfulPush(e,i,a),()=>this._handleErrorOnPush(e,t))}else this._isPushScheduled=!1,e&&e()},"Push recent items"))}_handleSuccessfulPush(e,t,n){this._isPushScheduled=!1,this._store.dispatch(Qr(t)),this._store.dispatch({type:"recentItem.removeRecentItemsFromState",payload:n}),this._putRecentItemsToLocalStorage(),e&&e()}_handleErrorOnPush(e,t){this._isPushScheduled=!1,t>0&&this._scheduleThePushOnIdle(e,t-1)}notifyRecentItemsUpdate(){const e=this._getFetchRecents();let t;e&&(t=e.bind(this)),this._scheduleThePushOnIdle(t,3)}_reportRecentItem(e,t){try{if(e&&e.length>0){let n=0;const r=e.length;for(const t in e)e[t].PinStatus&&(n+=1);const a=[];a.push({name:"ri",value:r}),a.push({name:"pi",value:n}),t.ReportComponentSuccess("NPSSitMap.recentAndPinnedItem",a)}}catch(e){t.ReportComponentFailure("NPSsiteMap.RecentItemsLocalStorageManagingActions",e)}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var hp=n("tHOi"),fp=n("3I29");var mp=n("hBJV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var bp=n("lk80"),_p=n("pgSX"),yp=n("JRzo"),vp=n("ErQw");function Sp(e,t,n){!function(){try{const e=window.localStorage,t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(e){return!1}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */()?t.warn("localStorage is not supported by current browser."):(null==n&&(n=Date.now()),localStorage.setItem(e,n),localStorage.removeItem(e))}var Op=n("uufl");class Cp{constructor(e,t){this._store=e,this._context=t,this._tracer=t.TraceManager.getTracer("MaxSessionTimeoutMonitor"),this._lastReload=null,this._timerHandler=null,this._warningShowDate=null,this._signoutShowDate=null,this._isSignoutDialogOpened=!1,this._warningDialogPageId=null,this._isPreviewModeEnabled=Object(mc.d)(this._store.getState()),this._storageEventHandler=this._storageEventHandler.bind(this),this.checkSessionTimeout=this.checkSessionTimeout.bind(this),this._showWarning=this._showWarning.bind(this),this._hideWarning=this._hideWarning.bind(this),this._showSignout=this._showSignout.bind(this),this._doSignout=this._doSignout.bind(this),this._reload=this._reload.bind(this),this._registerAuthExpiryReminder=this._registerAuthExpiryReminder.bind(this)}start(e){const t=Object(qo.x)(this._store.getState()),n=t.sessionTimeoutReminderInSeconds,r=t.sessionTimeoutInSeconds;if(r<=0||-1===n)return void this._tracer.info("Max Session timeout monitor did not start since authexpiration is not enabled or input values are not valid.");this._tracer.info(`Max Session timeout monitor started and monitoring page: ${window.location.href}, newUpdate: ${e}.`);const a=[{name:"page",value:window.location.href},{name:"newUpdate",value:e},{name:"warningInSeconds",value:n},{name:"signoutInSeconds",value:r},{name:"isPreviewModeEnabled",value:Object(mc.d)(this._store.getState())}];this._context.EventManager.ReportComponentSuccess("MaxSessionTimeoutMonitor.Start",a),window.removeEventListener("storage",this._storageEventHandler),window.addEventListener("storage",this._storageEventHandler),window.RegisterAuthExpiryReminder=null,window.RegisterAuthExpiryReminder=this._registerAuthExpiryReminder;const i=this._getCurrentTime();if(this._warningShowDate=n>0?i+1e3*n:null,this._signoutShowDate=r>0?i+1e3*r:null,this._lastReload=e,this.checkSessionTimeout(i),0!==n){const t={now:i,enabled:!0,warning:n,signout:r,lastupdate:e};Sp("oss_reload",this._tracer,JSON.stringify(t))}else 0!==r?(this._showWarning(),Sp("oss_showWarning",this._tracer)):this._doSignout()}getIsSignoutDialogOpened(){return this._isSignoutDialogOpened}_storageEventHandler(e){if(null!==e.newValue&&void 0!==e.newValue&&""!==e.newValue)switch(e.key){case"oss_showWarning":this._showWarning();break;case"oss_hideWarning":this._hideWarning();break;case"oss_showSignOut":this._showSignout();break;case"oss_mustSignOut":this._doSignout();break;case"oss_reload":this._reload(JSON.parse(e.newValue))}}_showWarning(){const e=Object(Op.a)(this._store.getState());if(e||this._isSignoutDialogOpened){const t=[{name:"isSigninDialogOpened",value:this._isSignoutDialogOpened},{name:"isReauthInProgress",value:e}];this._tracer.warn("Session timout warning dialog prevented from opening",t)}else this._isPreviewModeEnabled||(this._store.dispatch(Object(Da.b)(!0)),this._store.dispatch(Object(Ne.e)(yp.o)).then(()=>{this._context.EventManager.ReportComponentSuccess("MaxSessionTimeoutMonitor.Warning",[{name:"info",value:"Max session warning dialog displayed"}]);const e=Object(_l.e)(this._store.getState(),yp.o),t=Object(Ka.w)(this._store.getState()).isLive,n=e[yp.l],r=e[yp.f],a=String.format(e[yp.i],t?n:r),i=e[yp.m],o=e[yp.g],s=e[yp.n];return this._store.dispatch(Object(_p.a)(Pc.f,"",vp.b,i,s,a,o)).then(e=>{if(0===e.status)return this._warningDialogPageId=e.pageId,this._store.dispatch(Object(pc.a)(e.pageId)).then(e=>{e&&e.value&&!e.value.confirmed&&(this._warningDialogPageId=null,this._store.dispatch(Object(Da.b)(!1)),Sp("oss_hideWarning",this._tracer),this._tracer.info("User cancelled/closed max session timeout warning dialog"))});this._store.dispatch(Object(Da.b)(!1)),this._tracer.error("User is forced to cancel/close due to max session timeout dialog error: "+e.error)})}).catch(e=>{this._store.dispatch(Object(Da.b)(!1)),this._tracer.error("Max Session timeout resource string retrieval failed "+e)}))}_hideWarning(){null!==this._warningDialogPageId&&(this._store.dispatch(Object(D.e)(this._warningDialogPageId)),this._store.dispatch(Object(Da.b)(!1)),this._warningDialogPageId=null)}_showSignout(){this._isSignoutDialogOpened||(this._isSignoutDialogOpened=!0,this._store.dispatch(Object(Ne.e)(yp.o)).then(()=>{this._context.EventManager.ReportComponentSuccess("MaxSessionTimeoutMonitor.Signout",[{name:"info",value:"Max session signout dialog displayed"}]);const e=Object(_l.e)(this._store.getState(),yp.o);let t,n,r,a;return this._isPreviewModeEnabled?(t=e[yp.k],n="",r=e[yp.e],a=""):(t=e[yp.j],n=e[yp.h],r=e[yp.e],a=Pc.a),this._store.dispatch(Object(_p.a)(a,"",vp.a,n,r,t)).then(e=>{if(0===e.status)return this._store.dispatch(Object(pc.a)(e.pageId)).then(e=>{this._isSignoutDialogOpened=!1,this._doSignout(),Sp("oss_mustSignOut",this._tracer),this._tracer.info("User confirmed to sign out from max session timeout dialog.")});this._isSignoutDialogOpened=!1,this._doSignout(),Sp("oss_mustSignOut",this._tracer),this._tracer.error("User is forced to sign out due to max session timeout dialog error: "+e.error)}).catch(e=>{this._isSignoutDialogOpened=!1,this._doSignout(),Sp("oss_mustSignOut",this._tracer),this._tracer.error("User is forced to sign out due to max session timeout dialog error: "+e)})},()=>{this._isSignoutDialogOpened=!1,this._tracer.error("Max Session timeout resource string retrieval failed"),this._doSignout(),Sp("oss_mustSignOut",this._tracer)}))}_doSignout(){return this._store.dispatch(Object(jo.c)())}_reload(e){const t=e.enabled,n=e.warning,r=e.signout,a=e.now,i=e.lastupdate;if(t){if(i&&(null===this._lastReload||this._lastReload<i)){const e=n>0?a+1e3*n:null,t=r>0?a+1e3*r:null;this._warningShowDate=e,this._signoutShowDate=t,this._lastReload=i,null!==this._warningShowDate&&this._hideWarning(),this.checkSessionTimeout(a)}}else clearTimeout(this._timerHandler),this._timerHandler=null}checkSessionTimeout(e){clearTimeout(this._timerHandler),this._timerHandler=null;let t=0;void 0===e&&(e=this._getCurrentTime()),null!==this._signoutShowDate&&e>=this._signoutShowDate?(this._hideWarning(),Sp("oss_hideWarning",this._tracer),this._showSignout(),Sp("oss_showSignOut",this._tracer),this._tracer.info(`Max session reminder timeout, showing warning dialog, _signoutShowDate: ${this._signoutShowDate}, currentDate: ${e}.`)):null===this._warningShowDate||e>=this._warningShowDate?(null!==this._warningShowDate&&(this._showWarning(),Sp("oss_showWarning",this._tracer),this._tracer.info("Max session timeout, showing signout dialog")),null!==this._signoutShowDate&&(t=this._signoutShowDate-e)):t=this._warningShowDate-e,t>0&&this._waitFor(this.checkSessionTimeout,t)}_registerAuthExpiryReminder(e,t,n,r){const a={now:this._getCurrentTime(),enabled:e,warning:t,signout:n,lastupdate:r};this._reload(a),Sp("oss_reload",this._tracer,JSON.stringify(a))}_getCurrentTime(){return Date.now()}_waitFor(e,t){clearTimeout(this._timerHandler),this._timerHandler=setTimeout(e,t)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Ep=["Inactivity_Dialog_Warning_Description","Inactivity_Dialog_Error_Description","Inactivity_Dialog_Continue_Button","ErrorIconAltWarning","ErrorIconAltInformation"];var Ip=n("Zvo8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function wp(e){!function(e){window.addEventListener("pointerdown",()=>{e.forEach(e=>e.registerActivity())},!0),window.addEventListener("pointermove",()=>{e.forEach(e=>e.registerActivity())},!0),window.addEventListener("scroll",()=>{e.forEach(e=>e.registerActivity())},!0),window.addEventListener("keydown",()=>{e.forEach(e=>e.registerActivity())},!0)}(e),function(e){window.addEventListener("focus",()=>{e.forEach(e=>e.registerTabState(!0))},!0),window.addEventListener("blur",()=>{e.forEach(e=>e.registerTabState(!1))},!0),window.addEventListener("beforeunload",()=>{e.forEach(e=>e.registerTabClose())},!0)}(e),e.forEach(e=>e.start())}function jp(){return null!==Object(Ip.b)("ost_sessionHasExpired")}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Pp{constructor(e,t){this._store=e,this._context=t,this._tracer=t.TraceManager.getTracer("InactivityTimeoutMonitor");const n=Object(qo.x)(this._store.getState());this._inactivitySignoutInSeconds=n.inactivityTimeoutInSeconds,this._inactivityWarningInSeconds=n.inactivityTimeoutReminderInSeconds,this._isMonitorEnabled=!1,this._timerHandler=null,this._currentLastInactivityTime=0,this._isReminderDialogOpened=!1,this._isSignoutDialogOpened=!1,this._warningDialogPageId=null}start(){if(!this.isEligible())return this._tracer.info("Inactivity Session timeout monitor did not start because it was ineligible."),void(this._isMonitorEnabled=!1);this._isMonitorEnabled=!0;const e=[{name:"signoutInSeconds",value:this._inactivitySignoutInSeconds},{name:"warningInSeconds",value:this._inactivityWarningInSeconds}];this._context.EventManager.ReportComponentSuccess("InactivityTimeoutMonitor.Start",e),jp()?this._tryToSignOut({force:!0}):(window.addEventListener("storage",e=>this._storageEventHandler(e)),this.registerTabState(this._isCurrentTabActive()),Sp("ost_newMonitorInstance",this._tracer,this._currentLastInactivityTime))}isEligible(){return Object(jo.a)(this._context,this._store)&&this._inactivitySignoutInSeconds>0&&this._inactivityWarningInSeconds>0}registerActivity(){this._isMonitorEnabled&&(this._currentLastInactivityTime=this._getCurrentTime())}registerTabState(e){this._isMonitorActive!==e&&(this._isMonitorActive=e,this._isMonitorActive&&jp()?this._tryToSignOut({force:!0}):(this.registerActivity(),this.checkInactivity(),Sp("ost_newTabSelected",this._tracer,this._currentLastInactivityTime)))}registerTabClose(){jp()||(clearTimeout(this._timerHandler),this._timerHandler=null,this.registerActivity(),Sp("ost_newTabSelected",this._tracer,this._currentLastInactivityTime),this._isMonitorActive=!1)}_isCurrentTabActive(){const e=document;return void 0!==e.hidden&&"hidden"!==e.visibilityState||void 0!==e.mozHidden&&"hidden"!==e.mozVisibilityState||void 0!==e.msHidden&&"hidden"!==e.msVisibilityState||void 0!==e.webkitHidden&&"hidden"!==e.webkitVisibilityState}_storageEventHandler(e){if(null!==e.newValue&&void 0!==e.newValue&&""!==e.newValue)switch("ost_SyncLastActivityTime"!==e.key&&"ost_newMonitorInstance"!==e.key&&"ost_newTabSelected"!==e.key&&"ost_showWarning"!==e.key&&"ost_hideWarning"!==e.key&&"ost_signOut"!==e.key||this._tracer.info(`Event received ${e.key}, ${e.newValue}`),e.key){case"ost_newMonitorInstance":jp()?this._tryToSignOut({force:!0}):(this._hideWarning(),this._updateCurrentLastInactivityTimeFromEvent(e.newValue));break;case"ost_SyncLastActivityTime":case"ost_newTabSelected":this._updateCurrentLastInactivityTimeFromEvent(e.newValue);break;case"ost_showWarning":this._showWarning(),this._updateCurrentLastInactivityTimeFromEvent(e.newValue);break;case"ost_hideWarning":this._hideWarning(),this._updateCurrentLastInactivityTimeFromEvent(e.newValue);break;case"ost_signOut":const t="true"===e.newValue;this._tryToSignOut({force:t,mustNotify:!1})}}_updateCurrentLastInactivityTimeFromEvent(e){const t=+e;this._currentLastInactivityTime!==t&&(!this._currentLastInactivityTime||this._currentLastInactivityTime<t?(this._currentLastInactivityTime=t,this.checkInactivity()):Sp("ost_SyncLastActivityTime",this._tracer,this._currentLastInactivityTime))}checkInactivity(){const e=(this._getCurrentTime()-this._currentLastInactivityTime)/1e3;if(e>=this._inactivitySignoutInSeconds&&this._inactivitySignoutInSeconds>0)Object(Ip.c)("ost_sessionHasExpired","1",10),this._tryToSignOut({});else if(e>=this._inactivityWarningInSeconds&&this._inactivityWarningInSeconds>0)this._syncWithOtherWindowsAndCheckWarning();else{const t=1e3*(this._inactivityWarningInSeconds-e);this._waitFor(()=>this.checkInactivity(),t)}}_syncWithOtherWindowsAndCheckWarning(){Sp("ost_SyncLastActivityTime",this._tracer,this._currentLastInactivityTime),this._waitFor(()=>this._checkInactivityWarning(),500)}_checkInactivityWarning(){let e=0;const t=(this._getCurrentTime()-this._currentLastInactivityTime)/1e3;t>=this._inactivityWarningInSeconds?(this._showWarningAndNotify(),e=1e3*(this._inactivitySignoutInSeconds-t)):e=1e3*(this._inactivityWarningInSeconds-t),this._waitFor(()=>this.checkInactivity(),e)}_showWarningAndNotify(){this._showWarning(),Sp("ost_showWarning",this._tracer,this._currentLastInactivityTime)}_showWarning(){this._isReminderDialogOpened||this._isSignoutDialogOpened?this._isSignoutDialogOpened&&this._tracer.warn("inactivity timeout is prevented to open warning dialog when signout dialog is already opened"):(this._isReminderDialogOpened=!0,this._store.dispatch(Object(Ne.e)(Ep)).then(()=>{this._context.EventManager.ReportComponentSuccess("InactivityTimeoutMonitor.Warning",[{name:"info",value:"Inactivity warning dialog displayed"}]);const e=Object(_l.e)(this._store.getState(),Ep),t=e.Inactivity_Dialog_Continue_Button,n=e.ErrorIconAltWarning,r=e.Inactivity_Dialog_Warning_Description;return this._store.dispatch(Object(_p.a)(Pc.a,r,vp.b,t,n)).then(e=>{if(0===e.status)return this._isMonitorEnabled=!1,this._warningDialogPageId=e.pageId,this._store.dispatch(Object(pc.a)(e.pageId)).then(()=>{this._isReminderDialogOpened=!1,this._warningDialogPageId=null,this._hideWarning(),this.registerActivity(),this.checkInactivity(),Sp("ost_hideWarning",this._tracer,this._currentLastInactivityTime),this._tracer.info("User cancelled/closed inactivity timeout warning dialog")});this._isMonitorEnabled=!0,this._isReminderDialogOpened=!1,this._tracer.error("inactivity timeout can't open the warning dialog, navResult: "+e)})},()=>{this._isMonitorEnabled=!0,this._isReminderDialogOpened=!1,this._tracer.error("inactivity timeout resource string retrieval failed")}))}_hideWarning(){this._isReminderDialogOpened&&(null!==this._warningDialogPageId&&this._store.dispatch(Object(D.e)(this._warningDialogPageId)),this._isReminderDialogOpened=!1,this._warningDialogPageId=null),this._isMonitorEnabled=!0}_tryToSignOut(e){(e=e||{}).force=!!e.hasOwnProperty("force")&&e.force,e.mustNotify=!e.hasOwnProperty("mustNotify")||e.mustNotify,this._hideWarning(),this._isMonitorEnabled=!1,this._isSignoutDialogOpened||(this._isSignoutDialogOpened=!0,this._store.dispatch(Object(Ne.e)(Ep)).then(()=>{const t=[{name:"info",value:"Inactivity signout dialog displayed"},{name:"force",value:e.force},{name:"mustNotify",value:e.mustNotify}];this._context.EventManager.ReportComponentSuccess("InactivityTimeoutMonitor.Signout",t);const n=Object(_l.e)(this._store.getState(),Ep),r=n.Inactivity_Dialog_Error_Description,a=n.ErrorIconAltInformation;return this._store.dispatch(Object(_p.a)(Pc.a,r,vp.a,"",a)).then(e=>0===e.status?this._store.dispatch(Object(pc.a)(e.pageId)).then(()=>this._handleSignout("User confirmed to sign out from inactivity timeout dialog.")):this._handleSignout("User is forced to sign out due to max session timeout dialog error: "+e.error)).catch(e=>this._handleSignout("User is forced to sign out due to max session timeout dialog error: "+e))},()=>this._handleSignout("inactivity timeout resource string retrieval failed"))),this._isMonitorActive||e.force?this._handleSignout(""):Sp("ost_signOut",this._tracer,!1)}_handleSignout(e){return this._isSignoutDialogOpened=!1,""!==e&&this._tracer.error(e),Sp("ost_signOut",this._tracer,!0),this._store.dispatch(Object(jo.c)()).then(()=>{Object(Ip.a)("ost_sessionHasExpired")})}_getCurrentTime(){return Date.now()}_waitFor(e,t){clearTimeout(this._timerHandler),this._timerHandler=setTimeout(e,t)}getIsReminderDialogOpened(){return this._isReminderDialogOpened}getIsSignoutDialogOpened(){return this._isSignoutDialogOpened}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Tp=n("3mEc"),Np=n("V6aM"),Ap=(n("NUY7"),n("FM/+"));function Dp(e,t,n,r){const a=r.filter(t=>{const n=Object(Tp.j)(e,t);return!n||!n.Name});return t(Object(ut.d)(a)).then(()=>{const a=Object(qo.t)(e),i=/^\$webresource:/i,o=Object(Tp.e)(e,r).map(e=>e.replace(a,"").replace(i,"")),s=!Object(ws.b)(e);return n.loadWebResourcesForAllContexts(o,a,3,e=>t(Object(Np.a)(e)),s)})}function Rp(e,t,n,r,a,i,o){try{const o=Object(Tp.j)(e,n);t.execute(r,a,!0,{webResourceName:o&&o.name,solutionName:o&&o.solutionName,solutionVersion:o&&o.solutionVersion,publisherName:o&&o.publisherName,type:i})}catch(e){const t=[{name:"IsCustomizationError",value:"true"},{name:"type",value:i},{name:"ScriptAction",value:o}];throw Object(d.b)(e,t),e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class xp{constructor(){this._config={childList:!0,subtree:!0,attributes:!0,characterData:!0},this._observers=[]}addObserverTarget(e,t,n){t||(t=xp.UCLIENT_SHELL);const r=document.getElementById(t);r&&(e.observe(r,n||this._config),this._observers.push(e))}removeObserverTarget(e){this._observers=this._observers.filter(t=>(t===e&&t.disconnect(),t!==e))}}xp.UCLIENT_SHELL="shell-container";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Mp{constructor(){this._stack=[]}push(e){this._stack.push(e)}pop(){return this._stack.pop()}peek(){return this._stack[this._stack.length-1]}get length(){return this._stack.length}}var Fp=n("Gilj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class kp{constructor(){this.emptyQueue()}enqueue(e){this._queue.push(e)}emptyQueue(){this._queue=[]}isItemInQueue(e){return-1!==this._queue.indexOf(e)}getItemAtIndex(e){return e<0||e>=this._queue.length?null:this._queue[e]}length(){return this._queue.length}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Lp{constructor(e){this._shortcutDictionary={},this._keyDownQueue=new kp,this._applicationContext=e,document.addEventListener("keydown",e=>{this._onKeyDownListener(e,this)}),document.addEventListener("keyup",e=>{this._onKeyUpListener(e,this)})}registerShortcut(e){const t=this.getStringKeyFromKeyCombination(e.getKeyCombination());if(null==t)return;let n=this._shortcutDictionary[t];null==n&&(n=new Array),n.push(e),this._shortcutDictionary[t]=n}deregisterShortcut(e){const t=this.getStringKeyFromKeyCombination(e.getKeyCombination());if(null==t)return;const n=this._shortcutDictionary[t],r=[];if(null!=n)for(let t=0;t<n.length;t++)n[t].getSrcElementId()===e.getSrcElementId()&&n[t].getIsGlobal()===e.getIsGlobal()&&n[t].getAreaName()===e.getAreaName()||r.push(n[t]);this._shortcutDictionary[t]=r}getStringKeyFromKeyCombination(e){let t="";for(let n=0;n<e.length-1;n++)t+=e[n]+",";return t+=e[e.length-1],0===t.length?null:t}showShortcutsByCategory(){const e=this._getShortcutsByCategory();for(const t in e){console.log(t);const n=e[t];for(let e=0;e<n.length;e++){const t=n[e];t.getIsHidden()||console.log("Shortcut: "+this.getStringKeyFromKeyCombination(t.getKeyCombination())+" "+t.getShortcutDescription())}}}_getShortcutsByCategory(){const e={};for(const t in this._shortcutDictionary){const n=this._shortcutDictionary[t];for(let t=0;t<n.length;t++){const r=n[t].getAreaName();if(r){if(e[r]){const a=e[r];let i=!1;for(let e=0;e<a.length;e++)if(this.getStringKeyFromKeyCombination(a[e].getKeyCombination())===this.getStringKeyFromKeyCombination(n[t].getKeyCombination())){i=!0;break}i||e[r].push(n[t])}else e[r]=[n[t]]}}}return e}_onKeyDownListener(e,t){const n=e.keyCode||e.which;t._keyDownQueue.isItemInQueue(n)||t._keyDownQueue.enqueue(n),t._tryFireKeyboardShortcut(e,Fp.b.KeyDown)}_onKeyUpListener(e,t){t._tryFireKeyboardShortcut(e,Fp.b.KeyUp),t._keyDownQueue.emptyQueue()}_tryFireKeyboardShortcut(e,t){let n=0,r="";for(;n<this._keyDownQueue.length()-1;n++)r+=this._keyDownQueue.getItemAtIndex(n)+",";r+=this._keyDownQueue.getItemAtIndex(n),this._callShortcutHandler(r,e,t)}_callShortcutHandler(e,t,n){if(null==e)return;const r=this._shortcutDictionary[e];if(null!=r)for(let e=0;e<r.length;e++){const a=t.srcElement||t.target;if((r[e].getSrcElementId()===a.id||r[e].getIsGlobal())&&r[e].getKeyboardShortcutType()===n){const n=new Fp.c;n.EVENT=t,n.APPLICATION_CONTEXT=this._applicationContext,r[e].getShortcutHandler()(n)}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Bp(e){const t=function(e){return{position:"absolute",left:e.element.offsetLeft+e.element.clientWidth/2,top:e.element.offsetTop+e.element.clientHeight-7,background:"dimgrey",color:"white",width:"17px",borderRadius:"2px",textAlign:"center"}}(e);return l.createElement("div",{style:t},l.createElement("span",null," ",e.accessKey," "))}Bp.displayName="KeyTipIndicator";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Up{constructor(e,t,n){this.setAccessKey(e),this.setElement(t),this.setIsDisplayed(n)}getAccessKey(){return this._accessKey}setAccessKey(e){e.length>0?this._accessKey=e:this._accessKey=""}getElement(){return this._element}setElement(e){this._element=e}getIsDisplayed(){return this._isDisplayed}setIsDisplayed(e){this._isDisplayed=e}clone(){return new Up(this.getAccessKey(),this.getElement(),this.getIsDisplayed())}}class Vp extends l.Component{constructor(e){super(e),this.state={keyTips:[]}}render(){const e=[];for(let t=0;t<this.state.keyTips.length;t++)if(this.state.keyTips[t].getIsDisplayed()){const n="keyTip"+[t];e.push(l.createElement(Bp,{key:n,accessKey:this.state.keyTips[t].getAccessKey(),element:this.state.keyTips[t].getElement()}))}return l.createElement("div",null," ",e," ")}}var zp=n("3rse");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Wp{constructor(){this._keyTipPressed="",this._currentKeyTips=[],document.addEventListener("keydown",e=>{this._launchAccessKeyFunction(e)})}toggleKeyTips(){this._keyTipsRootComponent?this._hideKeyTips():this._showKeyTips()}_createRootElement(){this._keyTipRoot||(this._keyTipRoot=document.createElement("div"),this._keyTipRoot.id="keyTipContainer",document.body.appendChild(this._keyTipRoot))}_removeRootElement(){this._keyTipRoot&&(document.body.removeChild(this._keyTipRoot),this._keyTipRoot=null)}_showKeyTips(){this._createRootElement(),this._readAccessKeys(document.body);const e={keyTips:this._currentKeyTips},t=l.createElement(Vp,null);this._keyTipsRootComponent=u.render(t,this._keyTipRoot),this._keyTipsRootComponent.setState(e),document.body.focus()}_hideKeyTips(){u.unmountComponentAtNode(this._keyTipRoot),this._keyTipsRootComponent=null,this._keyTipPressed="",this._currentKeyTips=[],this._removeRootElement()}_launchAccessKeyFunction(e){let t=!1;if(this._keyTipsRootComponent){const n=[];e.keyCode===zp.a.Escape&&this._hideKeyTips();for(let r=0;r<this._currentKeyTips.length;r++){const a=this._currentKeyTips[r].clone();if(a.getIsDisplayed()){const n=this._keyTipPressed+e.key.toUpperCase(),i=a.getAccessKey().toUpperCase();if(n===i)return this._currentKeyTips[r].getElement().click(),void this._hideKeyTips();0===i.indexOf(n)&&i.length>1?t=!0:a.setIsDisplayed(!1)}n.push(a)}if(t){const t={keyTips:n};this._currentKeyTips=n,this._keyTipPressed+=e.key.toUpperCase(),this._keyTipsRootComponent.setState(t)}}}_readAccessKeys(e){if(e)for(let t=0;t<e.children.length;t++){const n=e.children.item(t);if(n.tabIndex>-1&&"hidden"!==n.style.visibility&&"none"!==n.style.display&&null!==n.accessKey&&n.accessKey.length>0){const e=new Up(n.accessKey,n,!0);this._currentKeyTips.push(e)}this._readAccessKeys(n)}}}var qp=n("cz9j");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Hp{constructor(e,t){this._accessibilityContainer=e,this._mutationObserver=t,this._lastFocusedElement=null,this._firstEditableElement=null,this._firstFocusableElement=null,this._lastFocusableElement=null}get mutationObserver(){return this._mutationObserver}popMutationObserver(){const e=this._mutationObserver;return this._mutationObserver=null,e}recalculateFirstAndLastFocusableElement(e){const t=document.getElementById(e);this._firstEditableElement=null,this._firstFocusableElement=null,this._lastFocusableElement=null,t&&(this._determineFirstFocusableAndEditableElementInSubtree(t),this._determineLastFocusableElementInSubTree(t))}_determineFirstFocusableAndEditableElementInSubtree(e){const{focusableElement:t,editableElement:n}=qp.b(e);this._firstEditableElement=n,this._firstFocusableElement=t}_determineLastFocusableElementInSubTree(e){this._lastFocusableElement=qp.c(e)}getAccessibilityContainer(){return this._accessibilityContainer}getLastFocusedElement(){return this._lastFocusedElement}setLastFocusedElement(e){this._lastFocusedElement=e}getLastFocusableElement(){return this._lastFocusableElement}getFirstFocusableElement(){return this._firstFocusableElement}getFirstEditableElement(){return this._firstEditableElement}}var Gp=n("SocB"),Kp=n("ke4y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Qp=g.a.createEvent("OnContextChanged","Accessibility");class Xp{constructor(e,t){this._focusCheckScheduled=!1,this._shortcutManager=new Lp(e),this._keyTipsManager=new Wp,this._accessibilityStack=new Mp,this._applicationContext=e,this._createGlobalShortcuts(t),this._focusHandler=this._elementFocusedHandler.bind(this),this._blurHandler=this._elementBlurredHandler.bind(this),this._keyDownForFirstElement=this._handleModalDialogKeyDownForFirstElement.bind(this),this._keyDownForLastElement=this._handleModalDialogKeyDownForLastElement.bind(this),this._handleKeyDownForOutline=this._handleKeyDownForOutline.bind(this)}updateAccessibilityContext(e){this._updateContext()}createAccessibilityContext(e){if(e.props.shouldManageFocus&&null!=e.props.rootElementId){const t=this._getRootElementId(e),n=this._registerMutationObserver(t),r=new Hp(e,n);this._accessibilityStack.push(r),this._scheduleFocusCheck(r,n)}if(null!=e.props.keyboardShortcuts)for(let t=0;t<e.props.keyboardShortcuts.length;t++)this._shortcutManager.registerShortcut(e.props.keyboardShortcuts[t])}popAccessibilityContext(e){let t=this._accessibilityStack.peek();e.props.shouldManageFocus&&null!=e.props.rootElementId?t&&e===t.getAccessibilityContainer()&&(t=this._accessibilityStack.pop(),this._deregisterMutationObserver(t.popMutationObserver()),this._deregisterKeyboardShortcuts(t.getAccessibilityContainer().props.keyboardShortcuts),this._onContextChanged()):this._deregisterKeyboardShortcuts(e.props.keyboardShortcuts)}showOutlineState(e){const t=document.body;t&&(e?(t.classList.remove("noOutline"),t.classList.add("showOutline"),document.addEventListener("focusin",this._handleKeyDownForOutline),document.removeEventListener("keydown",this._handleKeyDownForOutline)):(t.classList.remove("showOutline"),t.classList.add("noOutline"),document.removeEventListener("focusin",this._handleKeyDownForOutline),document.addEventListener("keydown",this._handleKeyDownForOutline)))}setClientAPISetFocusElementId(e){this._clientAPISetFocusElementId=e,this._scheduleFocusCheck(this._currentAccessibilityContext,this._currentAccessibilityContext&&this._currentAccessibilityContext.mutationObserver)}isClientAPISetFocusScheduled(){return!!this._clientAPISetFocusElementId}_registerMutationObserver(e){const t=new MutationObserver(this._mutationHandler.bind(this));return this._applicationContext.MutationObserverHandler.addObserverTarget(t,e,{childList:!0,subtree:!0,attributes:!1,characterData:!1,attributeOldValue:!1,characterDataOldValue:!1}),t}_scheduleFocusCheck(e,t){this._focusCheckScheduled||(Object(Js.f)(this._checkIfCompletelyRendered.bind(this,e,t),Js.a),this._focusCheckScheduled=!0)}_checkIfCompletelyRendered(e,t){if(this._focusCheckScheduled=!1,e&&t){let n=!1;const r=e.getAccessibilityContainer().props.waitForEditable,a=e.getAccessibilityContainer().props.defaultFocusId;if(this._clientAPISetFocusElementId){const e=this._getElement(this._clientAPISetFocusElementId);if(e){const t=qp.b(e);n=null!=t.editableElement||null!=t.focusableElement}}else if(a){const e=this._getElement(a);if(e){const t=qp.b(e);n=null!=t.editableElement||null!=t.focusableElement}}else{const t=this._getRootElementId(e.getAccessibilityContainer()),a=this._getElement(t);if(null!==a){const e=a,t=qp.b(e);n=r?null!=t.editableElement:null!=t.focusableElement}}n&&(this._deregisterMutationObserver(t),setTimeout(this._onContextChanged.bind(this),100))}}_mutationHandler(e,t){this._currentAccessibilityContext=this._accessibilityStack.peek(),this._currentAccessibilityContext&&this._currentAccessibilityContext.mutationObserver===t&&this._scheduleFocusCheck(this._currentAccessibilityContext,t)}_deregisterMutationObserver(e){e&&this._applicationContext.MutationObserverHandler.removeObserverTarget(e)}_deregisterKeyboardShortcuts(e){if(null!=e)for(let t=0;t<e.length;t++)this._shortcutManager.deregisterShortcut(e[t])}_onContextChanged(){const e=Qp.startStopwatch();this._currentAccessibilityContext=this._accessibilityStack.peek(),this._currentAccessibilityContext&&(this._updateContext(),this.redetermineFocusOnCurrentContext()),e()}_updateContext(){if(this._currentAccessibilityContext=this._accessibilityStack.peek(),this._currentAccessibilityContext){this._removeKeyDownListeners();const e=this._getRootElementId(this._currentAccessibilityContext.getAccessibilityContainer());this._currentAccessibilityContext.recalculateFirstAndLastFocusableElement(e),this._trapFocusForModalDialog();const t=document.getElementById(e);this._applyFocusAndBlurHandlers(t)}}_trapFocusForModalDialog(){if(this._currentAccessibilityContext&&this._currentAccessibilityContext.getAccessibilityContainer().props.isModal){const e=this._currentAccessibilityContext.getFirstFocusableElement(),t=this._currentAccessibilityContext.getLastFocusableElement();e&&e.addEventListener("keydown",this._keyDownForFirstElement),t&&t.addEventListener("keydown",this._keyDownForLastElement)}}_handleKeyDownForOutline(e){if(so.a.getInstance().get_IsBrowserIE()||so.a.getInstance().get_IsBrowserEdge()){let t=e.target;const n=document.getElementById(t.id);if(n&&n.style){let e="";do{e=window.getComputedStyle(t).backgroundColor,t=t.parentElement}while("transparent"===e&&t);const r=Object(Gp.i)(e),a=Object(Gp.k)(r).luminosity;n.style.outlineColor=a<.5?"#666666":"#FFFFFF"}}e.keyCode!==zp.a.Tab&&e.keyCode!==zp.a.UpArrow&&e.keyCode!==zp.a.DownArrow&&e.keyCode!==zp.a.LeftArrow&&e.keyCode!==zp.a.RightArrow||this.showOutlineState(!0)}_handleModalDialogKeyDownForLastElement(e){if(this._currentAccessibilityContext&&e.keyCode===zp.a.Tab&&!e.shiftKey){const t=this._currentAccessibilityContext.getFirstFocusableElement();t&&(e.preventDefault(),t.focus())}}_handleModalDialogKeyDownForFirstElement(e){if(this._currentAccessibilityContext&&e.keyCode===zp.a.Tab&&e.shiftKey){const t=this._currentAccessibilityContext.getLastFocusableElement();t&&(e.preventDefault(),t.focus())}}_removeKeyDownListeners(){if(this._currentAccessibilityContext&&this._currentAccessibilityContext.getAccessibilityContainer().props.isModal){const e=this._currentAccessibilityContext.getFirstFocusableElement(),t=this._currentAccessibilityContext.getLastFocusableElement();e&&e.removeEventListener("keydown",this._keyDownForFirstElement),t&&t.removeEventListener("keydown",this._keyDownForLastElement)}}redetermineFocusOnCurrentContext(){if(!this._currentAccessibilityContext)return;let e=null;if(this._clientAPISetFocusElementId){const t=this._getElement(this._clientAPISetFocusElementId);if(t){const n=qp.b(t);e=n.editableElement||n.focusableElement}this._clientAPISetFocusElementId=null}!e&&this._currentAccessibilityContext.getLastFocusedElement()&&(e=this._currentAccessibilityContext.getLastFocusedElement());const t=qp.b(this._getElement(this._currentAccessibilityContext.getAccessibilityContainer().props.overrideFocusId));if(e||(e=t.editableElement||t.focusableElement),!e&&this._currentAccessibilityContext.getAccessibilityContainer().props.defaultFocusId){const t=this._getElement(this._currentAccessibilityContext.getAccessibilityContainer().props.defaultFocusId);if(t){const n=qp.b(t);e=n.editableElement||n.focusableElement}}e||(e=this._currentAccessibilityContext.getFirstEditableElement()||this._currentAccessibilityContext.getFirstFocusableElement()),e&&(e.focus(),this._changeCurrentFocusedElement(e))}_getElement(e){return null==e?null:document.getElementById(e)}_applyFocusAndBlurHandlers(e){e&&e.children&&(e.removeEventListener("focus",this._focusHandler,!0),e.removeEventListener("blur",this._blurHandler,!0),e.addEventListener("focus",this._focusHandler,!0),e.addEventListener("blur",this._blurHandler,!0))}_elementBlurredHandler(e){const t=e.target;qp.d(t)&&this._changeCurrentFocusedElement(t)}_elementFocusedHandler(e){const t=e.srcElement;this._currentAccessibilityContext&&qp.d(t)&&this._changeCurrentFocusedElement(t)}_changeCurrentFocusedElement(e){this._currentAccessibilityContext&&null!==e&&e!==this._currentFocusedElement&&(this._currentAccessibilityContext.setLastFocusedElement(e),this._currentFocusedElement=e)}_createGlobalShortcuts(e){const t=this._gotoFirstFocusableElement.bind(this),n=new Fp.a([zp.a.Ctrl,zp.a.Num1],t,!0,"Global","Focuses the first element on the current page");this._shortcutManager.registerShortcut(n);const r=this._toggleKeyTips.bind(this),a=new Fp.a([zp.a.Shift,zp.a.Alt],r,!0,"Global","Shows the currently registered shortcuts");this._shortcutManager.registerShortcut(a);const i=this._showUniqueShortcuts.bind(this),o=new Fp.a([zp.a.Ctrl,zp.a.Comma],i,!0,"Global","Shows the access keys as pop-ups");this._shortcutManager.registerShortcut(o);const s=new Fp.a([zp.a.Alt,zp.a.Shift,zp.a.Q],S.e,!0,"Global","",void 0,void 0,!0);this._shortcutManager.registerShortcut(s);const c=new Fp.a([zp.a.Ctrl,zp.a.Shift,zp.a.Alt,zp.a.D],Ss.c,!0,"Global","",void 0,void 0,!0);this._shortcutManager.registerShortcut(c)}_gotoFirstFocusableElement(e){if(this._currentAccessibilityContext&&this._currentAccessibilityContext.getAccessibilityContainer().props.rootElementId){const e=this._currentAccessibilityContext.getFirstEditableElement()||this._currentAccessibilityContext.getFirstFocusableElement();e&&e.focus()}}_toggleKeyTips(){this._keyTipsManager.toggleKeyTips()}_showUniqueShortcuts(e){this._shortcutManager.showShortcutsByCategory()}_getRootElementId(e){return 0===this._accessibilityStack.length||1===this._accessibilityStack.length&&this._accessibilityStack.peek().getAccessibilityContainer().props.rootElementId===e.props.rootElementId?Kp.a:e.props.rootElementId}}var Yp=n("uNu9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Jp=n("i1f0");var $p=n("BgaZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Zp=n("GPkz");var eg=n("uvnT"),tg=n("QXIS");var ng=n("amok"),rg=n("/aHX");var ag=n("lmfa");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var ig=n("LOik");const og={id:"LegacyAppPresentNotification",level:3,messageId:bl.i,buttonLabelId:bl.f,getActionUrl:()=>"https://go.microsoft.com/fwlink/p/?linkid=2008063&clcid=0x",isValid(e,t){const n=t.getState(),r=!Object(qo.x)(n).allowLegacyClientExperience,a=Object(Ka.w)(n).isAdmin||Object(Ka.w)(n).isCustomizer,i=e.getInitialUrl().searchParams.get("pagetype")===bl.c,o=Object(ig.a)(n).some(e=>2===e.clientType);return a&&i&&o&&r}},sg={id:"LegacyAppRunningNotification",level:3,messageId:bl.j,buttonLabelId:bl.f,getActionUrl:()=>"https://go.microsoft.com/fwlink/p/?linkid=2008063&clcid=0x",isValid(e,t){const n=t.getState(),r=Object(Ka.w)(n).isAdmin||Object(Ka.w)(n).isCustomizer,a=2===Object(No.h)(n);return r&&a}},cg={id:"KitchenSinkAppRunningNotification",level:3,messageId:bl.h,buttonLabelId:bl.f,getActionUrl:()=>"https://go.microsoft.com/fwlink/p/?linkid=2086605&clcid=0x",isValid(e,t){const n=t.getState(),r=Object(Ka.w)(n).isAdmin||Object(Ka.w)(n).isCustomizer,a=Object(No.m)(n)===No.a;return r&&a}};var lg=n("AVDU"),ug=n("d4He"),dg=n("wRZP");const pg={id:"AppLessModeNotification",level:4,messageId:bl.e,buttonLabelId:bl.d,allowDismiss:!1,onAction:e=>({type:"AppLessModeNotificationOpenAppDialog",execute:(t,n)=>Object(lg.b)(t.getState())?t.dispatch(Object(dg.b)()):t.dispatch(Object(ug.a)(e.getOrgUrl()+"/apps"))}),isValid(e,t){const n=t.getState();if(Object(mc.c)(n)||Object(mc.d)(n)||Object(mc.e)(n)===qn.a.Off)return!1;const r=e.getInitialUrl(),a=!(r.searchParams.has(bl.a)||r.searchParams.has(bl.b)),i=r.searchParams.get("pagetype")!==bl.c;return a&&i}},gg={id:"UpdateMobileApplicationNotification",level:3,messageId:bl.o,buttonLabelId:bl.n,getActionUrl:()=>"https://apps.apple.com/app/id1003997947",isValid(e,t){const n=Object(xo.i)(t.getState()),r=Object(xo.b)(t.getState());if(!(n&&n.version&&r&&r.includes("iPhone")&&r.includes("iPad")))return!1;const a=Number(n.version.split(".").slice(-2)[0]);return a>=19022&&a<=19081}};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var hg=n("XOSd");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function fg(e,t,n){const r=[{name:"serviceWorkerScriptURL",value:e.scriptURL},{name:"serviceWorkerState",value:e.state},{name:"message",value:t}];n.EventManager.ReportComponentSuccess("ServiceWorkerBootSuccess",r)}function mg(e,t,n){const r=[{name:t,value:n.message}];e.EventManager.ReportComponentFailure("ServiceWorkerBootFailure",n,"",r)}var bg,_g;
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */n("zefI");!function(e){e.AuthFrame="AuthFrame",e.AuthFrameWithCookie="AuthFrameWithCookie",e.Host="Host",e.Proxy="Proxy"}(bg||(bg={})),function(e){e.AdalError="AdalError",e.CookiesBlocked="CookiesBlocked",e.Error="Error",e.PopupError="PopupError",e.StorageBlocked="StorageBlocked",e.TokenRequestError="TokenRequestError",e.UserCancelled="UserCancelled"}(_g||(_g={}));
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var yg,vg=function(){return(vg=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Sg={},Og={},Cg=0,Eg=window.parent;function Ig(e){yg=e}function wg(e,t){Og[e]=t}function jg(e,t){Pg(Eg,e,t)}function Pg(e,t,n){if(e){var r=Dg(t)?t:function(e){return vg({id:Cg++,protocol:"PAAF"},e)}(t);e.postMessage(r,"*"),n&&(Sg[r.id]=n)}else Rg("Failed to send "+t.action+" request. No targetWindow")}function Tg(e,t,n){Ng(e.source,e.origin,t,n)}function Ng(e,t,n,r){if(e){var a=function(e,t){return vg({id:e,protocol:"PAAF"},t)}(n,r);e.postMessage(a,t)}else Rg("Failed to send response. No targetWindow")}function Ag(e){if(e.data&&"PAAF"===e.data.protocol){var t,n,r=e.data;Dg(r)?function(e,t){var n=Og[e.action];n?n(e,t):Rg("Received a "+e.action+" request without a handler")}(r,e):(n=Sg[(t=r).id])?(n(t),delete Sg[t.id]):Rg("Received a response without a callback")}}function Dg(e){return"id"in e&&"action"in e}function Rg(e){var t;null===(t=yg)||void 0===t||t(e)}function xg(e){var t="Unknown error occurred";try{e&&(t=e instanceof Error?JSON.stringify(e,Object.getOwnPropertyNames(e)):JSON.stringify(e))}catch(e){}return{errorCode:_g.Error,errorMessage:t}}function Mg(e){return function(e){return!(!e||"string"!=typeof e.errorCode||"string"!=typeof e.errorMessage)}(e)?e:xg(e)}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var Fg={local:"https://apps.local.powerapps.com:44329",dev:"https://apps.dev.powerapps.com",test:"https://apps.test.powerapps.com",int:"https://apps.int.powerapps.com",preprod:"https://apps.preprod.powerapps.com",preview:"https://apps.preview.powerapps.com",prod:"https://apps.powerapps.com",gccmoderate:"https://apps.gov.powerapps.us",gcchigh:"https://apps.high.powerapps.us",dod:"https://play.apps.appsplatform.us",mooncake:"https://apps.powerapps.cn"},kg=null;function Lg(e,t,n){kg&&kg.trackError(e+"."+t,n)}function Bg(e,t,n){kg&&kg.trackEvent(e+"."+t,n)}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var Ug=function(){function e(e){this._anchor=document.createElement("a"),this._anchor.href=e}return Object.defineProperty(e.prototype,"host",{get:function(){return this._anchor.host},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hostname",{get:function(){return this._anchor.hostname},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"href",{get:function(){return this._anchor.href},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"origin",{get:function(){return this.protocol+"//"+this.host},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"protocol",{get:function(){return this._anchor.protocol},enumerable:!0,configurable:!0}),e}();
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function Vg(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){return function(e,t){var n=(e+16*Math.random())%16|0;return("x"===t?n:3&n|8).toString(16)}(e,t)}))}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var zg,Wg;!function(e){e[e.NotStarted=0]="NotStarted",e[e.Started=1]="Started",e[e.Completed=2]="Completed",e[e.Failed=3]="Failed"}(zg||(zg={}));var qg,Hg=zg.NotStarted,Gg=[];function Kg(e){return e===bg.AuthFrame||e===bg.AuthFrameWithCookie||e===bg.Host}function Qg(){if(Hg===zg.NotStarted){var e=oh(),t=e.loadFrameTimeout,n=e.region;Hg=zg.Started;var r=function(e){return new Ug(Fg[e]+"/authflow/authframe")}(n).href;Bg("AuthenticationFrame","loadAuthFrame",{region:n,url:r}),qg=setTimeout((function(){Hg=zg.Failed,Lg("AuthenticationFrame","loadAuthFrameFailure"),$g((function(e){return Zg(e)}))}),t),Wg=function(e,t,n){var r=document.createElement("iframe");return r.setAttribute("id",t),r.setAttribute("name",t),r.height="0px",r.width="0px",r.style.display="none",n&&r.addEventListener("load",n),r.src=e,document.body.appendChild(r),r}(r,"powerAppsAuthFlowFrame")}}function Xg(){clearTimeout(qg),function(){if(Hg!==zg.Started)return;Hg=zg.Completed,Bg("AuthenticationFrame","loadAuthFrameSuccess"),$g((function(e,t){return Jg(e,t)}))}()}function Yg(e,t){switch(oh(),Hg===zg.NotStarted&&Qg(),Hg){case zg.Completed:Jg(e,t);break;case zg.Failed:Zg(e);break;default:Gg.push([e,t])}}function Jg(e,t){var n=Wg&&Wg.contentWindow;n?Pg(n,e,t):Lg("AuthenticationFrame","sendMessageRequestToAuthFrame",{message:"No frame window"})}function $g(e){for(var t=0,n=Gg;t<n.length;t++){var r=n[t];e(r[0],r[1])}Gg=[]}function Zg(e){"getAccessToken"!==e.action&&"getAccessTokenCookie"!==e.action||function(e,t){var n=oh().hostWindow;Ng(function(e,t){for(var n=t,r=e.length;r>0;r--)n=n.frames[e[r-1]];return n}(e.frameIds,n),e.origin,e.id,t)}(e,{error:xg("Failed to load the auth frame"),token:void 0})}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var eh,th=function(){return(th=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},nh=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,s=i.length;o<s;o++,a++)r[a]=i[o];return r},rh=!1;function ah(e){void 0===e&&(e={}),eh=function(e){var t=th({frameId:window.name,hostFunctions:{},hostWindow:window,loadFrameTimeout:15e3},e),n=t.authenticationMode;switch(n){case bg.AuthFrame:ih(t,"openPopup");break;case bg.AuthFrameWithCookie:ih(t,"getAccessTokenCookie");break;case bg.Host:ih(t,"getAccessToken");break;case bg.Proxy:if(!window.name)throw new Error("Proxy frames must have a name.")}if(Kg(n)&&!t.region)throw new Error("Region must be set when using "+n+" mode.");return t}(e),rh=!0;var t=eh.authenticationMode,n=eh.logger;n&&function(e){kg=e}(n),wg("frameInitialized",sh),t&&(wg("getAccessToken",ch),t===bg.Host&&wg("getAccessTokenFromHost",uh),t===bg.AuthFrameWithCookie&&wg("getAccessTokenCookie",lh)),Kg(t)&&wg("openPopup",dh),Ig((function(e){Lg("PowerAppsAuthFlow","messageError",{message:e})})),window.addEventListener("message",Ag)}function ih(e,t){if(!e.hostFunctions[t])throw new Error("The host must implement "+t+" when using "+e.authenticationMode+" mode.")}function oh(){if(!rh)throw new Error("Auth flow has not been initialized.");return eh}function sh(e,t){var n=oh(),r=n.sessionId,a=n.tenantId,i=n.authenticationMode,o=n.hostType;Tg(t,e.id,{sessionId:r,tenantId:a,authenticationMode:i,hostType:o}),"powerAppsAuthFlowFrame"===e.frameId&&Xg()}function ch(e){var t,n=oh(),r=n.authenticationMode,a=n.frameId,i=e.options;switch(i.correlationId=null!=(t=i.correlationId)?t:Vg(),Bg("PowerAppsAuthFlow","handleGetAccessToken",{authenticationMode:r,correlationId:i.correlationId,resource:i.resource}),r){case bg.Host:case bg.AuthFrame:case bg.AuthFrameWithCookie:Yg(e);break;case bg.Proxy:jg(th(th({},e),{frameIds:nh(e.frameIds,[a])}))}}function lh(e,t){var n=oh().hostFunctions,r=e.options,a=e.origin,i=e.cookieDetails;n.getAccessTokenCookie(r,a,i.name,i.domain,(function(n){Tg(t,e.id,{error:n&&Mg(n)})}))}function uh(e,t){oh().hostFunctions.getAccessToken(e.options,(function(n,r){Tg(t,e.id,{error:n&&Mg(n),token:r})}))}function dh(e,t){var n,r=oh().hostFunctions,a=function(a){clearInterval(n),Tg(t,e.id,{error:a}),a&&r.handlePopupError&&r.handlePopupError(a)};wg("popupComplete",(function(e){var t=e.error;a(t),wg("popupComplete",null)})),r.openPopup(e.url,(function(e,t){var r;!e&&t?(t.focus&&t.focus(),n=window.setInterval((function(){t&&!t.closed||a({errorCode:_g.UserCancelled,errorMessage:"User cancelled the auth flow"})}),500)):a(e?Mg(e):(r="Failed to open the popup",{errorCode:_g.PopupError,errorMessage:r}))}))}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ph{constructor(e){this._componentName="PowerAppsAuthFlow",this._applicationContext=e}trackError(e,t){this._applicationContext.EventManager.ReportComponentFailure(this._componentName,this._addParametersToEvent(e,t))}trackEvent(e,t){this._applicationContext.EventManager.ReportComponentSuccess(this._componentName,this._addParametersToEvent(e,t))}_addParametersToEvent(e,t){const n=[{name:"EventName",value:e}];if(t)for(const e of Object.keys(t))n.push({name:e,value:t[e]});return n}}function gh(e,t){return"test"===t||"local"===t?"":Object(Es.a)(e)}const hh=[{id:"prod",allowedOriginRegex:/.*.crm(10)?.dynamics.com$|.*.crm([2-8]|11).dynamics.com$/},{id:"gcchigh",allowedOriginRegex:/.*crm9.dynamics.com$/},{id:"test",allowedOriginRegex:/.*crmperflab.com$/},{id:"test",allowedOriginRegex:/(.*.crm.dynamics-int.com$|.*.crm[2]?.crmlivetie.com$|.*.contoso.com:444|.*.microsoft.com|.*.msmecrm.com|.*.crm.crmlivetoday.com|.*.crm.1boxtest.com|.*.mocaifd\\d*.com:444|.*.crm.crmifd.com|.*.msmecrm.com:444|.*localhost.*)/},{id:"test",allowedOriginRegex:/.*.crm10.dynamics.com$/}];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const fh="AppCachePreFetch";async function mh(e,t){const n=t.EventManager,r=so.a.getInstance().get_IsIOS(),a=document.documentElement.getAttribute("manifest");if(!r||null===a||!navigator.onLine)return;const i=await fetch(a);if(!i.ok){const e=[{name:"appManifestUrl",value:a},{name:"status",value:i.status},{name:"statusText",value:i.statusText}];return void n.ReportComponentFailure(fh,new Error("Failed to fetch app manifest"),"",e)}const o=function(e){let t=!0;const n=[],r=e.split(/\r|\n/);for(let e=1;e<r.length;e++){const a=r[e].trim();switch(a){case"CACHE:":t=!0;continue;case"FALLBACK:":case"NETWORK:":case"SETTINGS:":t=!1;continue}t&&0!==a.length&&!a.startsWith("#")&&bh(a)&&n.push(a)}return n}(await i.text());Promise.all(o.map(_h)).then(e=>{const t=e.filter(e=>!e.ok);if(t.length>0){const e=[{name:"files",value:JSON.stringify(t)}];n.ReportComponentFailure(fh,new Error("Failed to fetch some assets"),"",e)}else n.ReportComponentSuccess(fh)},e=>{n.ReportComponentFailure(fh,e)})}function bh(e){return 0===e.indexOf("https://")}async function _h(e){try{const t=await fetch(e);return{file:e,ok:t.ok,status:t.statusText}}catch(t){return{file:e,ok:!1,status:t.message}}}var yh=n("9XdG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const vh=[{diagnosticName:"DebugSettingsHandler",boot:(e,t)=>{t.DebugSettingsHandler=new Ws(t)}},{diagnosticName:"TraceManager",boot:(e,t)=>{let n="";e.getInitialUrl().searchParams.has("defaulttracelevel")&&(n=e.getInitialUrl().searchParams.get("defaulttracelevel"));const r=new zs(t,Us,[],void 0,n);if(e.getInitialUrl().searchParams.has("traceareas")){const t=e.getInitialUrl().searchParams.get("traceareas");r.setTraceAreas(t)}t.TraceManager=r}},{diagnosticName:"CreateStore",boot:async(e,t)=>{Tn.timelineWalls=ca;const n={configuration:Gn,user:Z,organization:ee,fcbs:ae,metadata:qt,data:Object(O.a)(Tn),serverStatus:W,currentServerTime:H,theme:Nn.b,designLanguage:Dn,deviceSize:Mn,availablePlatformServices:Ln,pluginState:to,externalContext:Vn,platform:Fr,userSettings:Wr,personalizations:rr,businessProcessFlowData:sr,commands:br,clientHost:Ir,authentication:Pr,searchWidget:Or,toastNotifications:ga,popupNotifications:ma,globalProgressIndicator:Sa,globalNotifications:Ea,recentItems:$r,garbageCollector:Pa,reconnectNotification:Jn,cache:Aa,sessionTimeoutStatus:xa,session:Fa,panelManager:Ua,browsingContexts:Oi,dialogContexts:Di,sessions:ei,tabs:bi,appShellState:di,contextualHelpBrowser:Ai,editedViews:xi,appHostClient:Li};Object(S.f)()&&Object.assign(n,{dummyReducer:B}),t.RestoreStateManager=Qi.getInstance(t);const r=await t.RestoreStateManager.retrievePersistedState(),a=function(e,t,n,r){const a=[];if(n){const e=(i=n,e=>(t,n)=>{const r=e(t,n);return r.dispatch=function(e,t,n){return function(r){return n(e,r),t.apply(void 0,arguments)}}(r,r.dispatch,i),r});a.push(e)}var i;a.push(P(t),T,A.b);const o=Object(N.c)(...a);return Object(N.d)(e,r,o)}(Object(O.a)(n),t,ro,r);a.currentReducerMap=n,t.RestoreStateManager.initialize(a,r);const i=t.RestoreStateManager.shouldRestoreState;i&&(e.addEventParameter({name:"isRestore",value:i}),_.a.addCommonKpiParameters({[v.b.BootPerformanceParameters.IsStateRestore]:i.toString()}));const o=Math.random().toString(36).slice(2);window["__store$"+o]=a,e.setStore(a)}},{diagnosticName:"EventManager",boot:(e,t,n)=>{const r=function(t,n){const r=e.getInitialUrl().searchParams.get(t);if(r)switch(r.toLowerCase()){case"true":case"1":return!0;case"false":case"0":return!1;default:return n}return n}("telemetry",!1),a=e.getClientHost(),i=e.getInitialUrl().toString(),o=document.referrer,s=window.__preload&&window.__preload.serverRequestId?window.__preload.serverRequestId:null,c=[];Object(Ss.a)()?(c.push(Object(Os.b)()),c.push(new vs(t,new Ds))):c.push(new vs(t,console)),t.EventManager=new Bs(n,t,a,r,c);const l=[{name:"initialUrl",value:Object(Rs.a)(i)},{name:"referrerUrl",value:Object(Rs.a)(o)},{name:Ga.c.SERVER_REQUEST_ID,value:s}];t.EventManager.ReportComponentSuccess("EventManager.constructor",l),js.a.setEventManager(t.EventManager)}},{diagnosticName:"HostOptions",boot:(e,t,n)=>{Hs(e.getClientHost(),t,n)}},{diagnosticName:"ApplicationContextDispose",boot:(e,t)=>{t.Dispose=()=>{t.isDisposed?t.TraceManager.getTracer("ApplicationContext").error("The applicationContext has been disposed already"):(t.Router&&t.Router.dispose(),t.isDisposed=!0)}}},{diagnosticName:"ErrorService",boot:(e,t)=>{t.ErrorService=new os({renderer:Object(ns.createRenderer)(),mountNode:document.getElementById("stylesheet")})}},{diagnosticName:"PerformanceTracking",boot:(e,t)=>{try{const e="false"!==localStorage.getItem("_UCI_PERF_IS_FIRST_APP_START");e&&localStorage.setItem("_UCI_PERF_IS_FIRST_APP_START","false"),_.a.addCommonKpiParameters({[v.b.PageLoadParameters.FirstAppStart]:e.toString()})}catch(e){}Object(S.g)(t),g.a.registerTransport(new Jc,[h.d,h.s,h.x,h.f]),g.a.registerTransport(new pl,["CustomScripts",h.d,Kc.NETWORK_REQUEST_EVENT_NAME]),Object(Gc.setAdditionalWindows)("ClientApiFrame_"),Object(Xc.a)(Object(ji.b)(),t.EventManager),_.a.initializeZoneActivityTracking([h.s,h.x,h.z,h.a,Kc.NETWORK_REQUEST_EVENT_NAME,b.PERFORMANCE_OBSERVER_ZONE]),_.a.subscribeToPerformanceIssues(e=>{const n=e.parameters?e.parameters.map((e,t)=>({name:"Param"+t,value:e})):[];t.TraceManager.getTracer("Performance").warn(e.message,n)}),$c.a.setPerformanceHooks((t,n)=>{const r=g.a.createEvent(t,n||"CustomControlFramework");return{createMarker:r.createMarker,startStopwatch(t){if(t&&t[h.n]){const n=Object(gl.e)(e.getStore().getState(),t[h.n]),a=[],i=Object(Qc.addNetworkRequestListener)(e=>{e.id=j.a.toString(j.a.newGuid()),a.push({id:e.id,sync:e.sync})}),o=r.startStopwatch(Object.assign(Object.assign({},t),{solutionName:n&&n.SolutionName,solutionVersion:n&&n.SolutionVersion,publisherName:n&&n.PublisherName}));return e=>{i(),o(Object.assign(Object.assign({},e),a.length>0?{requests:JSON.stringify(a)}:void 0))}}return r.startStopwatch(t)},createRetroactiveStopwatch:r.createRetroactiveStopwatch}},(e,t,n)=>{_.a.addKeyPerformanceIndicator(e,t,n)},(e,t)=>{_.a.addKeyPerformanceIndicatorOnIdle(e,t)},e=>m.a.trackWork(e),A.c),Object(S.b)(e.getInitialUrl()),Object(S.i)(t.EventManager),Object(S.f)()&&Object(S.d)();const n=()=>{const n=Object(qo.y)(e.getStore().getState()).organizationId.guid,r=t.EventManager.getCurrentSessionId();window.Footprint.start("d365",["fpc.msedge.net/conf/v2/d365/fpconfig.min.json"],0,JSON.stringify({oid:n,sid:r}),"",{"placeholder.dynamics.com":e.getBaseUrl().host},e=>{Object(Kc.setNetworkInfo)(e.reduce((e,t)=>(e[`${t.Conn}${hl[t.T]}`]=t.Result.toString(),e),{}))})};Object(M.b)(()=>{Object(Hi.c)(e.getStore().getState(),Gi.m)&&t.AssetLoader.loadScript("/uclient/scripts/fpv2.min.js").then(()=>{n(),setInterval(n,3e5)})},"Azure Footprint")}},{diagnosticName:"Store",boot:(e,t,n)=>{n.subscribe(qo.b,e=>t.DebugSettingsHandler.updateSettings(e)),Object(S.f)()&&(Object(ml.b)(n),Object(fl.b)(n)),Object(S.j)(n),n.dispatch(Object(G.e)(e.getOrg(),e.getIsLiveId()));const r=Object(Wn.b)(e.getInitialUrl());var a;r&&n.dispatch(r),n.dispatch(Object(ne.b)()),Object(mc.d)(n.getState())||((a=n).subscribe(ws.b,()=>Sl(a)),a.subscribe(xs.v,()=>Sl(a)),a.subscribe(()=>Object(_l.b)(a.getState(),bl.m),()=>Sl(a)),n.subscribe(ws.a,e=>Object(Ol.b)(e,t.DataSource.get_ApplicationStatusProvider().isOfflineSyncDone(),n)))}},{diagnosticName:"ErrorHandler",boot:(e,t)=>{const n=new co(t);t.ErrorHandler=n,function(e){window.addEventListener("unhandledrejection",t=>{t.preventDefault&&t.preventDefault();const n=new ji.a(window.location.href),r=t.detail||t;if(void 0!==r&&void 0!==r.reason&&void 0!==r.promise){const t=r.reason.lineNumber||0,a=r.reason.columnNumber||0;r.promise.catch(r=>{const i=e.ensureErrorObject(r),o=e.buildCrashData(i.message,n.pathname,t,a,i,ao.UnhandledRejection);e.raise(o,"UnhandledRejectionLogging")})}else if(void 0!==r.reason&&r.reason.get_organizationServiceFault){const r=e.ensureErrorObject(t),a=e.buildCrashData(r.message,n.pathname,0,0,r,ao.UnhandledRejection);e.raise(a,"UnhandledRejectionLogging")}else{const r=e.buildUnknownCrashData(n.pathname,t);e.raise(r,"UnhandledRejectionLogging")}})}(n),function(e){if(e&&e.EventManager){const t=window.__preloadErrors;t&&(t.forEach(t=>{e.EventManager.ReportComponentFailure("Boot.Preload",t)}),window.__preloadErrors=[])}}(t)}},{diagnosticName:"Telemetry",boot:(e,t)=>{const n=new Qo(t.EventManager);t.TraceManager.addDefaultTransport(n),t.ErrorHandler.addEventHandler((e,n)=>{const r=function(e,t,n,r,a,i,o){const s=new Go.a(v.y.Name);return s.addEventParameter(v.g.ComponentName,e),s.addEventParameter(v.y.FileName,t),s.addEventParameter(v.y.FunctionName,n),s.addEventParameter(v.y.LineNumber,r),s.addEventParameter(v.y.ColumnNumber,a),s.addEventParameter(v.y.CommonError.Message,i),s.addEventParameter(v.y.CommonError.CallStack,o),s}(e,n.fileName,n.func,n.lineNumber,n.columnNumber,n.errorMessage,n.stackTrace);t.EventManager.ReportEvent(r,Ho.a.High)}),Object(Xo.a)(function(e){return(t,n,r)=>{const a=r(),i=a.getValue(a.get_sourceKeyIdentifier()),o=e.TraceManager.getTracer(i).getLogLevel(),s=Ko.a.fromLegacyLogLevel(n);if(o<s)return;const c=new Go.a(v.B.Name),l=a.getValue(a.get_exceptionMessageKeyIdentifier())||a.get_message();c.addEventParameter(v.g.ComponentName,i),c.addEventParameter(v.B.TraceLevel,Ko.a.toString(s)),c.addEventParameter(v.B.CommonError.Message,l),c.addEventParameter(v.B.CommonError.CallStack,a.getValue(a.get_stackTraceKeyIdentifier())),c.addEventParameter(v.b.CommonErrorParameters.ErrorStack,a.getValue(a.get_exceptionStackTraceKeyIdentifier())),e.EventManager.ReportEvent(c)}}(t))}},Object(io.b)(),{diagnosticName:"ScriptSharp",boot:(e,t)=>{window.Microsoft||(window.Microsoft={});const n=Microsoft;n.Crm||(n.Crm={}),n.Crm.Client||(n.Crm.Client={}),n.Crm.Client.Core||(n.Crm.Client.Core={}),n.Crm.Client.Core.Framework||(n.Crm.Client.Core.Framework={}),n.Crm.Client.Core.Framework.UserAgent=so.a,n.Crm.Client.Core.Framework._Dictionary=lo,n.Crm.Client.Core.Framework.Guid=uo.a,n.Crm.Client.Core.Framework.List$1={$$:e=>po},n.Crm.Client.Core.Framework.IList$1={$$:()=>{}},window.CrmEncodeDecode=go}},{diagnosticName:"PalBootstrapper",boot:async(e,t,r)=>{let a;const i=e.getClientHost();let o=null;if(i===zo.a.MobileApplication||i===zo.a.MailApp)o=await n.e(85).then(n.bind(null,"wCe8")),a=new o.NativePlatform(t,r,e.getInAppNavigate());else if(o=await n.e(108).then(n.bind(null,"4QP1")),a=new o.WebPlatform,Object(ts.d)(r.getState())){const{initializeAppHostClient:e,runWindowOverrides:a}=await Promise.all([n.e(19),n.e(68)]).then(n.bind(null,"wge3"));await r.dispatch(e(null)),a(t)}return function(e,t,n,r){t.PlatformContext=new Jo(r);const a=new Promise((e,a)=>{r.addOnPlatformReady(()=>{e()},t,n)});return n.dispatch(Object(Cr.g)(e.getClientHost())),a}(e,t,r,a)}},{diagnosticName:"CheckUnsupportedBrowserBootTask",boot:(e,t)=>{const n=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){const e=[];return"undefined"==typeof MutationObserver&&e.push("MutationObserver"),"undefined"==typeof requestAnimationFrame&&e.push("requestAnimationFrame"),e.join(",")}();if(""!==n)throw Object(d.d)("Unsupported Browser Version",E.b,[{name:"UserAgent",value:navigator.userAgent},{name:"UnsupportedBrowserApi",value:n}])}},{diagnosticName:"DataSource",boot:(e,t,n)=>{const r=new Po(t,n),a=Fo.a.getInstance(e.getOrgUrl(),r,new Ro(n,t),n);if(n){const o=t.TraceManager,s=o.getTracer(Oo.TRACER_CATEGORY_ID);a.set_MetadataCache(new Oo(n,s)),o.getTracer("dataSourceLoader").warn("Boot task DataSource started");const c=o.getTracer(Co.a.TRACER_CATEGORY_ID);Object(Mo.b)(new Co.a(n,c)),ko.b.tracer=o.getTracer(ko.a);const l=o.getTracer(Ga.c.TRACER_CATEGORY_ID),u=Object(xo.a)(n.getState()),d=new Ga.c(n,t,u,r,l);a.set_WebAPIService(d),n.dispatch(U(a.get_IsServerAvailable())),a.get_EventManager().add_serverAvailabilityChanged((i=n,(e,t)=>{i.dispatch(U(t.get_isAvailable())),i.dispatch(V(t.get_isNetworkAvailable()))}));const p=n.getState();Object(Lo.d)(p)&&e.setIsLocalStoreAvailable(!0)}var i;return Fo.a.set_DefaultInstance(a),t.DataSource=Fo.a.get_DefaultInstance(),Bo(t,n,e.getIsLocalStoreAvailable())}},{diagnosticName:"AppLoader",boot:(e,t,n)=>{const r=t.TraceManager.getTracer("AppLoader"),a=e.getShimBootType();let i=e.getBaseUrl().searchParams.get("appid");if(i&&r.info("Getting appid from URL"),i||(i=Object(No.i)(n.getState()),i&&r.info("Getting appid from shim state")),i&&!j.a.isNullOrEmpty(j.a.tryParseOrNull(i))){if(e.getClientHost()===zo.a.MobileApplication){const e={};e.appId=i,n.dispatch(Object(Vo.a)("LastAccessedApp",e,!1))}n.dispatch(Object(ft.b)(i)),a.appIdConfigured=!0,a.inAppNavigation=!0,e.setSharedVariable("IsAppDeepLink",!0)}else if(e.getClientHost()===zo.a.MobileApplication)return n.dispatch(Object(Uo.a)("LastAccessedApp")).then(e=>{if(e&&e.appId)return r.info("Getting appid from sessionstate"),n.dispatch(Object(ft.b)(e.appId)),void(a.appIdConfigured=!0)});return Promise.resolve()}},Object(Wo.b)(),{diagnosticName:"InitializeNavigationHandler",boot:(e,t,n)=>{const r=new ag.a(n,t);t.CustomNavigationHandler=r}},{diagnosticName:"Router",boot:(e,t,r)=>{const a=[wl.a,Ml,kl,zl,Ql,Hu,Jl,uu,Tu,Mc,Eu,bu,$l.a,au,od,Iu.a,Du,Fu,Bu,iu.a,zu,rd,sd.a],c=new Gu([i,o]);e.getClientHost()===zo.a.MailApp?n.e(77).then(n.bind(null,"5WU+")).then(e=>{c.addDecorator(e)}).catch(e=>{t.TraceManager.getTracer("RouterBootTask").error("Failed to load mail app param decorator",[{name:"ErrorMessage",value:e&&e.toString()}])}):e.getClientHost()===zo.a.MobileApplication&&c.addDecorator(s);const l=new Il(e.getBaseUrl(),a,El.a,c),u=Hc(t,r,l,e.getClientHost());t.Router=u;const d=Object.assign(Object.assign({},r.currentReducerMap),u.getReducers());r.replaceReducer(Object(O.a)(d)),r.currentReducerMap=d,u.initializeManager(r),t.RestoreStateManager.restoreRouter()}},{diagnosticName:"InitializeClientApiGlobalStore",boot:(e,t,n)=>{zd.a.getInstance(t.EventManager,t.TraceManager)}},{diagnosticName:"ChannelManager",boot:(e,t,n)=>{t.ChannelManager=new Jd(t.TraceManager.getTracer())}},{diagnosticName:"RetrieveUserContext",boot:(e,t,n)=>function(e,t,n){return function(e){return e.dispatch(Object(Uo.a)("UserId",!0)).then(e=>{let t=j.a.EMPTY;return e&&e.UserId&&(t=j.a.parse(e.UserId)),t})}(n).then(r=>{let a;return n.dispatch(Object(G.d)()).then(()=>(a=Object(Ka.q)(n.getState()),function(e,t,n,r,a){const i=Object(qo.x)(a.getState());if(i&&n.addEventParameter({name:v.c.AllowLegacyClientExperience,value:i.allowLegacyClientExperience}),e===j.a.EMPTY||e.guid!==t.guid)return r.TraceManager.getTracer("UserValidator").info("User has changed"),n.setSharedVariable("HasUserChanged",!0),r.DataSource.clearAllMetadata(!0).nativePromise().then(()=>{})}(r,a,e,t,n))).then(()=>{if(!r||r.guid!==a.guid){const e={UserId:a.guid};return n.dispatch(Object(Vo.a)("UserId",e,!1,!0))}t.EventManager.setTelemetryListeners()}).catch(e=>{throw Object(E.i)(e)&&(e.errorCode=-2147094001),e})})}(e,t,n)},{diagnosticName:"InitializePowerAppsAuthSDK",boot:(e,t,n)=>{const r=e.getStore().getState();if(function(e){return Object(Hi.c)(e,Gi.U)}(r)){const a=function(){const e=window.location.href,t=hh.find(t=>t.allowedOriginRegex.test(e));return t?t.id:"test"}(),i=Object(_l.e)(r,yp.o),o=Object(_l.c)(i,yp.m),s=Object(_l.c)(i,yp.h),c=Object(_l.c)(i,yp.d),l=Object(_l.c)(i,yp.n),u=Object(Ka.w)(r).isLive,d=Object(_l.c)(i,yp.l),p=Object(_l.c)(i,yp.f),g=String.format(Object(_l.c)(i,yp.i),u?d:p);ah({authenticationMode:e.getClientHost()===zo.a.MobileApplication?bg.AuthFrameWithCookie:bg.AuthFrame,hostFunctions:{handlePopupError:e=>{let t="";switch(e.errorCode){case _g.StorageBlocked,_g.CookiesBlocked:t=i[yp.c];break;case _g.PopupError:t=i[yp.b];break;default:return}n.dispatch(Object(_p.a)(Pc.b,t,vp.a,s,l,null,null,null,null,!0))},getAccessTokenCookie:async(e,r,a,i,o)=>{const s=new wo.a(t,n);try{await s.beginSecureSessionForAuthFlow(e,r,a,i),o()}catch(e){o(Mg(e))}},openPopup:async(e,r)=>{const a=await n.dispatch(Object(_p.a)(Pc.a,g,vp.a,o,c,null,null,null,null,!0));0===a.status?(await n.dispatch(Object(pc.a)(a.pageId))).value.confirmed?r(null,window.open(e,"","width=500, height=500")):r(Mg("PowerApps authflow dialog closed")):(r(Mg("Error occurred while opening powerapps auth sdk dialog"),null),t.EventManager.ReportComponentFailure("Error occurred while opening powerapps auth sdk dialog",a.error))}},region:a,tenantId:gh(r,a),logger:new ph(t),sessionId:t.EventManager.getCurrentSessionId(),hostType:"UCI"})}}},{diagnosticName:"AppContextLoader",boot:(e,t,n)=>{const r=e.getSharedVariable("IsAppInvalid"),a=e.getSharedVariable("HasUserChanged"),i=e.getSharedVariable("IsAppDeepLink");if(r||a&&!i)Cl(t,n);else{const r=Object(No.i)(n.getState());if(r)return n.dispatch(Object(ht.d)(new j.a(r))).catch(r=>Object(E.g)(r)?(Cl(t,n),void e.setSharedVariable("IsAppInvalid",!0)):Promise.reject(r))}}},{diagnosticName:"checkUnsupportedBrowserMultiSessionAppBootTask",boot:(e,t,n)=>{const r=n.getState();if(!Object(yc.b)(r)&&Object(No.k)(r)===_c.a.MultiSession)throw Object(d.d)("Unsupported Browser For MultiSession App",E.c,[{name:"UserAgent",value:navigator.userAgent}])}},{diagnosticName:"JQueryDowngradeVersionCheck",boot:(e,t,r)=>{const a=r.getState(),i=Object(Hi.c)(a,Gi.hc),o=Object(qo.x)(a);if(!i||o.areJquery3IncompatibleSolutionsInstalled){const e=[{name:"loadHigherJQueryVersionFcb",value:i},{name:"areJquery3IncompatibleSolutionsInstalled",value:o.areJquery3IncompatibleSolutionsInstalled}];n.e(119).then(n.t.bind(null,"VGgW",7)).then(()=>{t.EventManager.ReportComponentSuccess("JQueryDowngradeVersionCheckLoader",e)}).catch(n=>{t.EventManager.ReportComponentFailure("JQueryDowngradeVersionCheckLoader",n,null,e)})}}},{diagnosticName:"UpdateHistoryManager",boot:(e,t,n)=>{Object(cd.b)(n.getState())&&t.Router.setHistoryManager(new ud(n))}},{diagnosticName:"InitializeNavigationHandler",boot:(e,t,n)=>{if(Object(yc.a)(n.getState())===_c.a.MultiSession)return Object(rg.b)().then(e=>{Object(ng.b)(e.XrmAppSessions);const r=new e.MultiSessionNavigationHandler(n,t);t.CustomNavigationHandler=r,t.SessionTabEventManager=new e.SessionTabEventManager(n)})}},{diagnosticName:"PerfToolsOptional",boot:(e,t)=>{Object(S.f)()&&n.e(25).then(n.bind(null,"6dVr")).then(({initializePerformanceAutomationScenariosOnBoot:n})=>{n(e.getStore(),t.EventManager.getCurrentSessionId())})}},{diagnosticName:"RelevanceSearch",boot:(e,t,n)=>{n.dispatch({type:"relevance.search.Index.Status.retrieve.async",execute:async(e,t)=>{var n;try{const t=Object(Ka.w)(e.getState());if(t&&!t.isLive)return;if(localStorage.getItem("RelevanceSearchIndexStatus"))return void e.dispatch(Qa(!0))}catch(e){}const r={endpoint:"/api/search/v1.0/status",method:"GET",urlParameters:""};try{const a=await e.dispatch(Object(Ha.a)(r)),i=await Object(Ga.g)(a);if(i.code)throw t.EventManager.ReportComponentFailure("GlobalSearchAction.retrieveRelevanceSearchIndexStatus.apiError",i),new Error(i.message);const o="provisioned"===(null===(n=i.value)||void 0===n?void 0:n.status);if(o)try{localStorage.setItem("RelevanceSearchIndexStatus","provisioned")}catch(e){}e.dispatch(Qa(o))}catch(e){t.EventManager.ReportComponentFailure("GlobalSearchAction.retrieveRelevanceSearchIndexStatus.error",e)}}})}},Object(tg.c)(),{diagnosticName:"MeasuringHandler",boot:(e,t)=>{fd.a.getInstance().setSchedulingFunction(A.d)}},{diagnosticName:"MutationObserverHandler",boot:(e,t)=>{const n=new xp;t.MutationObserverHandler=n}},{diagnosticName:"Accessibility",boot:(e,t,n)=>{const r=new Xp(t,n);t.AccessibilityManager=r}},{diagnosticName:"UserSettings",boot:(e,t,n)=>{!function(e,t){const n={toastNotification:{toastNotificationDisplaySpeed:fp.a.Normal}};t.dispatch(Object(hp.b)(Yo.b)).then(e=>{e?t.dispatch(Object(Ur.c)(e.get_personalization())):t.dispatch(Object(Ur.c)(n))},r=>{e.TraceManager.getTracer("UserAccessibilitySettings").error("Error retrieving UserAccessibility session data from SesstionState: "+r.message),t.dispatch(Object(Ur.c)(n))})}(t,n),function(e){const t=Object(Ka.o)(e.getState()),n=t&&t.substr(0,2);document.documentElement.setAttribute("lang",n||"en")}(n)}},{diagnosticName:"Offline",boot:(e,t,n)=>{Object(Id.d)(t.TraceManager.getTracer(Rd.b));const r=new Ed.a(t,n),a=Object(Hi.d)(n.getState(),"MobileClientOfflineAutoOptin"),i=Object(qo.m)(n.getState()),o=r.IsExecAvailable(),s=Object(Lo.b)(n.getState()),c=Object(xo.a)(n.getState());Id.c.warn("offlineLoader:loading offline dependencies : isofflineServiceAvailable :"+o+" mobileClientOfflineAutoOptinFeature: "+a+" isMocaOfflineFeatureEnabledInOrg: "+i+" clientHostType:"+c);const l=o&&a&&i&&c===zo.a.MobileApplication&&s,u=Object(Td.e)(n.getState());if((l&&u||Object(Lo.c)(n.getState()))&&function(e){e.Router.registerNavigationBeginHandlers((e,t,n)=>-1!==[Zl.a,jd.a,Pd.a,Hl.a,ed.a,Md.a].indexOf(n)?t(Object(xd.a)()):Promise.resolve())}(t),l||Object(Lo.c)(n.getState()))return Object(wd.a)().then(e=>{!function(e,t,n,r){const{OfflineTypescriptInterface:a,offlineReducer:i,offlineUpdateStateTreeFromSessionState:o,isOfflineAvailableForUse:s,inOfflineEnabledProfile:c,getOfflineFeatureStatus:l,isOldStateEmpty:u,hasOfflineConfigurationExceptAvailableEntitiesChanged:d,hasOfflineAvailableEntitiesOrProfileVersionHasChanged:p,ConstructOfflineState:g,OfflineUpdateStateTree:h,getReInitializeOffline:f,createReInitializeOfflineAction:m,initializeOfflineLifecycleAsyncAction:b}=e;Ct.g.push(...e.OfflineResourceIds);const _=Ld.getOfflineProvider();window.__UCITestHook={syncNow:()=>{_.schedulePeriodicSyncJob()},syncCompleteFlag:0},_.set_offlineDataSource(Ld.getOfflineDataSource()),_.set_offlineTypescriptInterface(new a(r,n,{})),n.OfflineProvider=_;const y=Object.assign(Object.assign({},r.currentReducerMap),{offline:i});r.replaceReducer(Object(O.a)(y)),r.currentReducerMap=y,r.dispatch(Object(Cd.c)(Fs.a.NotAvailable,Nd.a.None));const v=r.getState(),S=Object(Lo.b)(v,n);let C=Object(ws.b)(v);if(Id.c.warn("offlineLoader:loadingOffline - isServerAvailableStatus:"+C+" isAppAvailableOffline"+S),!S)return C?Promise.resolve(null):Promise.reject(Io.a.fromErrorCode(v,-2147093999));const E=Object(Hi.d)(v,"MobileClientOfflineAutoOptin");(new Ed.a(n,r).IsExecAvailable()&&E||Object(Lo.c)(v))&&(r.subscribe(xs.e,e=>function(e,t){const{isFileSyncCompleted:n,isFileSyncCompletedWithError:r}=Object(Lo.f)(t);Object(xs.g)(e.getState())&&n&&(e.dispatch(Object(Fd.b)(!1)),e.dispatch(Object(kd.a)(r)))}(r,e)),r.dispatch(o()).then(()=>{let e=null,t=null,a=null,i=null,o=null,_=null;const y=r.getState(),v=s(y),S=c(y);if(C=Object(ws.b)(y),Id.c.warn("offlineLoader:loadedOffline - isServerAvailableStatus:"+C+" isOfflineAvailableForUseStatus:"+v+" inOfflineEnabledProfileStatus: "+S),!C&&n.DataSource&&!v&&!S)return Promise.reject(Io.a.fromErrorCode(y,-2147093999));r.subscribeImmediate(()=>{const n=r.getState(),a=Object(To.c)(n),s=Object(ws.b)(n);let c=!1,f=!1;const m=l(n);let b=!1,y=null;if(l(n)!==ks.a.Disabled){const l=function(e){return Object(To.c)(e)===Et.a.InProgress||!1===Object(To.b)(e)}(n);n.user&&n.organization&&n.user.userSettings&&n.organization.organizationSettings&&(n.user.userSettings!==e||n.organization.organizationSettings!==t)&&((u(e,t,n)||d(n,r.dispatch))&&(Id.c.warn("offlineLoader:loadOffline:Offline state change : bisMetdataSyncInProgressOrIsMetataUnavailable:"+l),b=!0,l||(f=!0)),!b&&p(n)&&(b=!0,Id.c.warn("offlineLoader:loadOffline:Offline state change : Available Entities Or Profile Version Has Changed"))),l||f||(function(e,t,n){return!1===e&&!0===t}(i,s)?(c=!0,f=!0,b=!0,Id.c.warn("offlineLoader:loadOffline:Offline state change : upsync required ")):(function(e,t){return e===ks.a.Disabled&&t===ks.a.Enabled}(_,m)||function(e,t,n){return Object(Td.e)(e)?t===Et.a.Init&&n===Et.a.InSyncWithServer||t===Et.a.SyncPendingFromServer&&n===Et.a.InSyncWithServer:(t===Et.a.InProgress||t===Et.a.SyncPendingFromServer)&&n===Et.a.InSyncWithServer}(n,o,a))&&(f=!0,b=!0,Id.c.warn("offlineLoader:loadOffline:Offline state change : Metadata sync has been completed"))),t=n.organization.organizationSettings,e=n.user.userSettings,_!==m&&(_=m),o!==a&&(o=a),i!==s&&(Id.c.warn("offlineLoader:loadOffline:Offline lifecycle - Server State change:oldServerState:"+i+" newServerState:"+s),i=s),b&&(Id.c.warn("offlineLoader:loadOffline:Offline state tree change : change value:"+b),y=g(n,f,c),r.dispatch(h(y)))}else _!==m&&(Id.c.warn("offlineLoader:loadOffline:Offline lifecycle - feature status change:oldOptStatus:"+_+" newOptStatus:"+m),_=m)}),r.subscribeImmediate(()=>{const e=r.getState(),t=f(e);a!==t&&(a=t,t&&(Id.c.warn("offlineLoader:loadOffline:reinitialize: newOfflineState:"+t),r.dispatch(m(!1)),r.dispatch(b())))})},e=>{throw Id.c.error("Offline: offlineUpdateStateTreeFromSessionState: offlineUpdateStateTreeFromSessionState: Failed: Error retrieving session data from session state"),e}))}(e,0,t,n)}).catch(e=>(Id.c.error("Offline: loadOfflineDependencies has Failed :"+Object(E.e)(e)),Promise.reject(e)))}},Object(md.b)(),{diagnosticName:"DataSourceFinalizer",boot:(e,t,n)=>{const r=e.getClientHost()===zo.a.MobileApplication||Lo.c(n.getState());let a=!1;if(Object(Hi.c)(n.getState(),Gi.yc)){let r=e.getOrgUrl()+Ga.c.WEB_API_URL_FRAGMENT;r.startsWith("http")||(r=window.location.origin+r),Object(bd.b)().then(e=>{e.initializeExpressionRuntime(r,n,t.TraceManager.getTracer(_d.e.ExpressionRuntime))})}Object(yd.e)(n.getState())&&Object(bd.b)().then(e=>{e.initializeRetrieveMultipleCache()}),Object(yd.g)(n.getState())&&Object(bd.b)().then(e=>{e.initializeRetrieveCache()}),Lo.e(n.getState(),e.getBaseUrl())?a=!0:r&&(a=Lo.a(n.getState()));const i=r&&Lo.a(n.getState())?t.DataSource.get_IsLocalDataSourceAvailableOffline():t.DataSource.get_IsLocalDataSourceAvailable();navigator.serviceWorker&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({isBrowserOfflineEnabledWithFlag:Lo.d(n.getState())||!1});let o=Promise.resolve();const s=t.TraceManager.getTracer("dataSourceFinalizer"),c=t.DataSource.get_IsNetworkAvailable();return s.warn("Boot task DataSourceFinalizer started.currentLocalStoreState = "+i+" : desiredLocalStoreState = "+a+" : isNetworkAvailable = "+c),window.__UCCacheModeEnabled=a,n.dispatch({type:"cache.setcachestatus",payload:{isCacheEnabled:a}}),n.dispatch(V(c)),a!==i&&(s.info("Re-initializing DataSource with cacheMode : "+a),o=Bo(t,n,a,!0).then(()=>{if(r&&Lo.a(n.getState())&&!t.DataSource.get_IsLocalDataSourceAvailableOffline())return s.warn("dataSourceFinalizer : Failed to reinitialize the database, unable to create valid local data source for offline"),Promise.reject(Io.a.fromErrorCode(n.getState(),-2147015599))})),Object(Hi.c)(n.getState(),Gi.G)&&Object(bd.c)().then(n=>{const r=n.MdlProvider.getInstance(e,t);n.MdlProvider.setDefaultInstance(r)}),o}},{diagnosticName:"DeviceSettingsBootstrapper",boot:(e,t,n)=>{const r={};n.dispatch(Object(Uo.a)(Yo.a)).then(e=>{$o.forEach(t=>{e&&e[t]?r[t]=function(e,t){const n={featureName:e,isEnabled:t.isEnabled};return"camera"===e&&Object.keys(Zo).forEach(e=>{n[e]=t[e]}),n}(t,e[t]):r[t]=es(t)}),n.dispatch(Dr(r))},e=>{t.TraceManager.getTracer("DeviceSettings").error("Error retrieving deviceSettingInformation session data from SesstionState"),$o.forEach(e=>{r[e]=es(e)}),n.dispatch(Dr(r))})}},function(e=1e3){return{diagnosticName:"DeviceSize",boot:(t,n,r)=>{const a=function(e,t,n){let r=0;function a(){n&&(n.EventManager&&n.EventManager.sendContextEvent(),fd.a.getInstance().scheduleMeasuringUpdate()),r=0,t(Rn())}return function(){r||(r=setTimeout(a,e))}}(e,r.dispatch,n);r.dispatch(Rn()),window.addEventListener("resize",a)}}}(),{diagnosticName:"ClientApiManager",boot:(e,t,n)=>{t.ClientApiManager=new np(n)}},{diagnosticName:"ScriptManager",boot:(e,t,n)=>{const r=new ul(t.TraceManager.getTracer("ScriptManager"),t,n,document,t.EventManager,t.ClientApiManager);t.ScriptManager=r,r.initializeContainerPool()}},{diagnosticName:"AddClientApiGlobalFunctions",boot:(e,t,n)=>{const r=window;r.getCurrentXrmStatus=function(){const e="ClientApi.AddClientApiGlobalFunctions.getCurrentXrmStatus";try{Bd.a.instance.reportCall(e);const r=n.getState(),a=Object(zi.b)(r)||Object(zi.c)(r),i=function(e,t,n){const r=e.getState();try{const a=t.ClientApiManager.getClientApiEntry(n),i=a.primaryContextToken;let o,s;const c=Object(sc.l)(r,n);return Vd.a.Grid===c?o=e.dispatch(Object(Ud.c)(n,i)):s=e.dispatch(Object(Ud.b)(n,i)),{mainForm:s,mainGrid:o,pageType:c,xrmInstance:a.xrmInstance,clientApiIFrameId:Wd(n)}}catch(e){throw zd.a.getInstance().eventManager.ReportComponentFailure("ClientApi.InitializeClientApiAction.getXrmStatus",e),e}}(n,t,a);return Bd.a.instance.reportSuccess(e),i}catch(t){throw qd.a.getInstance().reportFailure(e,t),t}},r.getGlobalContextObject=function(){const e="ClientApi.AddClientApiGlobalFunctions.getGlobalContextObject";try{Bd.a.instance.reportCall(e);const t=n.getState(),r=Object(zi.b)(t)||Object(zi.c)(t),a=new gc.a(n,r);return Bd.a.instance.reportSuccess(e),a}catch(t){throw qd.a.getInstance().reportFailure(e,t),t}},r.getCurrentXrm=function(){const e="ClientApi.AddClientApiGlobalFunctions.getCurrentXrm";try{Bd.a.instance.reportCall(e);const r=n.getState(),a=Object(zi.b)(r)||Object(zi.c)(r),i=t.ClientApiManager.getClientApiEntry(a).xrmInstance;return Bd.a.instance.reportSuccess(e),i}catch(t){throw qd.a.getInstance().reportFailure(e,t),t}}}},{diagnosticName:"SetCurrentXrm",boot:(e,t,n)=>{if(window.hasOwnProperty("Xrm"))t.TraceManager.getTracer("ClientApi.SetCurrentXrm.Xrm").warn("Xrm property is already defined on the main UCI Window");else{const e=new nl.b(n,"ClientApi.SetCurrentXrm.");Object.defineProperty(window,"Xrm",{get:()=>e.execute("Xrm",()=>{const e=n.getState(),r=Object(zi.f)(e);return t.ClientApiManager.getClientApiEntry(r).xrmInstance})})}}},{diagnosticName:"RTL",boot:(e,t,n)=>{n.subscribe(Ka.g,e=>{document.body.dir=e?"rtl":"ltr"})}},Object(vd.a)(),{diagnosticName:"ShimPerformanceMetrics",boot:(e,t,n)=>{const r=t.TraceManager.getTracer("ShimPerformanceMetrics"),a=Od.a.get_Instance();a.add_onReadyOrNow(()=>{const t=a.get_application().get_applicationState().get_ShimPerformanceMetrics(),n={},i=e.getShimBootType().getShimBootTypeString();n[v.b.ShimBootParameters.ShimBootType]=i,_.a.addCommonKpiParameters(n),Object(Sd.a)(n,t,r)})}},{diagnosticName:"IncrementalSyncNavigationHandler",boot:(e,t,n)=>{t.Router.registerPostNavigationHandlerHandlers((e,t)=>{Object(M.b)(()=>{Object(ws.b)(n.getState())&&t(Object(mp.a)())},"Retrieve metadata version")})}},{diagnosticName:"GlobalCustomEventManager",boot:(e,t,n)=>{t.GlobalCustomEventManager=new Xd(t.TraceManager.getTracer(),t.ScriptManager)}},{diagnosticName:"StorageLoader",boot:(e,t,n)=>{t.RecentItemsSyncManager=new gp(n),t.RecentItemsSyncManager.initialize(t.EventManager)}},{diagnosticName:"CustomControlHelper",boot:(e,t)=>{const n=new hd(e.getStore().getState);var r;r=e.getStore().getState(),Object(gd.b)({SELECT_TO_ENTER_DATA:Object(_l.b)(r,"InlineEditControls.SelectToEnter")}),t.CustomControlGlobalHelper=n,Object(pd.c)(t.TraceManager.getTracer("CustomControlFramework"))}},{diagnosticName:"LoadingStyles",boot:(e,t,n)=>{e.getClientHost()===zo.a.MobileApplication&&so.a.getInstance().get_IsAndroid()&&t.AssetLoader.loadStylesheet(ip,Object(io.c)())}},{diagnosticName:"AppCustomizationLoader",boot:(e,t,n)=>{const r=e.getClientHost();Object(Cs.c)(n.getState())||(Hs(r,t,n),r===zo.a.Browser)||t.TraceManager.getTracer("HostOptions").warn("Host option is not available during HostOptionsBootTask for clientHost: "+r);const a=Object(Cs.b)(n.getState(),"WebResourceName"),i=a&&a.value,o=Object(No.e)(n.getState()),s=o&&o.eventHandlers?o.eventHandlers.filter(e=>e.Enabled&&Object(Ap.a)(e.EventName,"onload")):[],c=s.length>0,l=s.some(e=>e.IsBlocking);if(!i&&!c)return null;const u=Object(ol.a)(),d=t.ScriptManager.initializeContainerForClientApi(u,!1).then(e=>{const r=[];return r.push(function(e,t,n,r){const a=[];return r.forEach(r=>{const i=Dp(e(),t,n,[r.LibraryName]).then(()=>Rp(e(),n,r.LibraryName,r.FunctionName,Object(Ap.b)(n,r.Parameters),"AppModuleOnLoad",JSON.stringify(r)));r.IsBlocking&&a.push(i)}),Promise.all(a)}(n.getState,n.dispatch,e,s)),r.push(function(e,t,n,r,a){const i=Object(Cs.b)(t(),"WebResourceName"),o=Object(Cs.b)(t(),"InitFunctionName"),s=i&&i.value,c=o&&o.value;return s?Dp(t(),n,r,[s]).then(()=>{if(c){const n=e.ClientApiManager.getClientApiEntry(a).xrmInstance;Rp(t(),r,s,c,[n],"EmbeddedLoader",c)}}).then(qs.d):(Object(qs.d)(),Promise.resolve(null))}(t,n.getState,n.dispatch,e,u)),Promise.all(r)});return i||l?d:null}},{diagnosticName:"BootEmbeddedPreview",boot:(e,t,r)=>{const a=e.getInitialUrl(),i=t.TraceManager.getTracer(Object(Jp.S)(!1,"previewForm"));if(a){const e=a.searchParams;if(e.has(Nc.c)&&e.has(Nc.B)){const a=e.get(Nc.c),o=e.get(Nc.B);if(a&&o)return Promise.all([n.e(1),n.e(4),n.e(5),n.e(26)]).then(n.bind(null,"q5Ef")).then(({PreviewSync:e})=>{const n=new e(r,i);t.PreviewSyncChannel=n.initializeChannel(a)})}}}},{diagnosticName:"ModelFormComponentBootTask",boot:(e,t,r)=>{Object(Hi.c)(r.getState(),Gi.jb)&&(Object(yh.b)(r),window._getModelFormComponent=()=>Promise.all([n.e(2),n.e(6),n.e(0),n.e(1),n.e(3),n.e(4),n.e(5),n.e(8),n.e(7),n.e(81)]).then(n.bind(null,"0N/X")).then(({ModelFormComponent:e})=>(e._store||(e._store=r),e._context||(e._context=t),e)))}},{diagnosticName:"CordovaLoader",boot:(e,t,n)=>{const r=so.a.getInstance().get_IsAndroid()?rp:so.a.getInstance().get_IsIOS()?ap:void 0;e.getClientHost()===zo.a.MobileApplication&&r&&t.AssetLoader.loadScript(r)}},{diagnosticName:"initializeSiteMapTelemetry",boot:(e,t,n)=>{const r=Object(fi.b)(n.getState())&&Object(Hi.c)(n.getState(),Gi.Fd);Zp.a.initialize(t,r)}},c,{diagnosticName:"codeCacheStatusCheck",boot:(e,t,n)=>{if(Object(hg.a)(n.getState(),e.getInitialUrl())&&window.navigator.serviceWorker)return window.navigator.serviceWorker.controller&&"activated"===navigator.serviceWorker.controller.state&&(n.dispatch(Ta(3)),t.EventManager.ReportComponentSuccess("codeCacheStatusCheck.SW.InitialState.Idle",e.getEventParameters())),void navigator.serviceWorker.addEventListener("controllerchange",r=>{n.dispatch(Ta(3)),t.EventManager.ReportComponentSuccess("codeCacheStatusCheck.SW.InitialState.FirstInstallActivate",e.getEventParameters())});if(window.applicationCache&&e.getClientHost()===zo.a.MobileApplication){const r=Object(ws.b)(n.getState());return new Promise((a,i)=>{if(window.applicationCache.status===window.applicationCache.IDLE||window.applicationCache.status===window.applicationCache.UPDATEREADY)return t.EventManager.ReportComponentSuccess("appCacheEventsCheck.Ready.State."+window.applicationCache.status,e.getEventParameters()),n.dispatch(Ta(3)),void a();t.EventManager.ReportComponentSuccess("appCacheEventsCheck.Waiting.State."+window.applicationCache.status,e.getEventParameters()),["noupdate","cached","updateready","error","obsolete"].forEach(o=>window.applicationCache.addEventListener(o,()=>{window.applicationCache.status===window.applicationCache.IDLE||window.applicationCache.status===window.applicationCache.UPDATEREADY?(n.dispatch(Ta(3)),t.EventManager.ReportComponentSuccess("appCacheEventsCheck.Ready.State."+window.applicationCache.status,e.getEventParameters()),r||a()):(t.EventManager.ReportComponentSuccess("appCacheEventsCheck.Waiting.State."+window.applicationCache.status,e.getEventParameters()),r||i(Object(d.d)("Application cache could not initialize for offline usage, go back online and allow the cache to fully initialize before trying again.")))})),r&&a()})}}},Object(bp.b)(),{diagnosticName:"InitializeTimeoutBootTask",boot:(e,t,n)=>{e.getClientHost()!==zo.a.Browser||Object(mc.c)(n.getState())||(function(e,t){if(Object(Hi.b)(e.getStore().getState(),"UCIMaxSessionTimeout")){const n=(new Date).toISOString().replace(/[^0-9]/g,"").slice(0,-3);new Cp(e.getStore(),t).start(Number(n))}}(e,t),Object(mc.d)(e.getStore().getState())||function(e,t){const n=[];if(Object(Hi.b)(e.getStore().getState(),"UCIInactivityTimeout")){const r=new Pp(e.getStore(),t);r.isEligible()&&n.push(r)}n.length&&wp(n)}(e,t))}},{diagnosticName:"LoadImportantMetadataBootTask",boot:(e,t,n)=>{const r={};r[Yp.Wb]=[],r[Yp.Yb]=[],n.dispatch(Object(_e.e)(r)).catch(e=>{const n=[{name:"functionName",value:"retrieveEntities"},{name:"entities",value:JSON.stringify(r)}];t.EventManager.ReportComponentFailure("Boot.Tasks.LoadImportantMetadataBootTask",e,null,n)})}},{diagnosticName:"InvalidAppHandler",boot:(e,t,n)=>{t.TraceManager.getTracer("InvalidAppHandler").debug("InvalidAppHandler started."),e.getSharedVariable("IsAppInvalid")&&(e.removeSharedVariable("IsAppInvalid"),Object($p.a)(n))}},Object(eg.b)(),{diagnosticName:"BootNotificationTask",boot:(e,t,n)=>{!function(e,t,n){const r=[],a=Object(xo.a)(n.getState());a===zo.a.Browser?r.push(og,sg,cg,pg):a===zo.a.MobileApplication&&r.push(gg),n.dispatch(Object(Ne.e)(bl.g)).then(()=>{for(const t of r)if(t.isValid(e,n)){const r={id:t.id,type:1,level:t.level,message:Object(_l.b)(n.getState(),t.messageId),title:null,action:{actionLabel:Object(_l.b)(n.getState(),t.buttonLabelId),eventHandler:()=>{t.onAction?n.dispatch(t.onAction(e)):n.dispatch(Object(ug.a)(t.getActionUrl(e)))}},onCloseHandler:null,showCloseButton:!1!==t.allowDismiss};n.dispatch(Object(Oa.b)(r))}})}(e,0,n)}},{diagnosticName:"cdnEndpointValidation",boot:(e,t)=>{const n=window.__public_path__,r=window.__cdn_public_path__;let a="";if("/uclient/"===n?void 0!==r&&(a=r):a=n,a.length>0){const e=new XMLHttpRequest;e.onreadystatechange=function(){if(4===e.readyState){const n=[],r="ClientCdnEndpointValidation";if(n.push({name:"CdnEndpoint",value:a}),n.push({name:"Status",value:e.status}),e.status>=200&&e.status<304)t.EventManager.ReportComponentSuccess(r,n);else{const e="CDN Endpoint Cannot Be Reached From Current Client";t.TraceManager.getTracer(r).warn(e,n)}}},e.open("GET",a+"uci_cdn_connection_check?version="+window.VERSION_NUMERIC_VALUE,!0),e.timeout=3e4,e.send()}}},{diagnosticName:"ServiceWorker",boot:(e,t,n)=>{const r=n.getState(),a=t.TraceManager.getTracer("ServiceWorker");if(navigator.serviceWorker&&"caches"in self)if(navigator.serviceWorker.controller&&fg(navigator.serviceWorker.controller,"Active serviceWorker already registered",t),Object(hg.a)(r,e.getInitialUrl())){navigator.serviceWorker.getRegistration("/uclient").then(e=>{e&&e.waiting&&fg(e.waiting,"An updated serviceWorker is registered(installed) and waiting to be activated",t)}),_.a.onNextIdleProcessing(()=>{const e=Object(Hi.c)(r,Gi.yd);!function(e,t){navigator.serviceWorker.register("/uclient/sw.js?gcm="+t,{scope:"/"}).then(t=>{!function(e,t){let n;e.onupdatefound=()=>{e.installing&&(n=e.installing,n.onstatechange=()=>{switch(n.state){case"installed":navigator.serviceWorker.controller?fg(n,"ServiceWorker update intalled, new content is available",t):fg(n,"New serviceWorker intalled, content has been precached",t);break;case"redundant":mg(t,"swRegistrationError",new Error("The installing service worker became redundant."))}fg(n,"State change for registered serviceWorker through swRegistration update",t)})}}(t,e)}).catch(t=>{mg(e,"swRegistrationError",t)})}(t,e)});const e=t.EventManager.canSendEvent(v.A.Name,"ServiceWorker.Fetch");navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({logFetchSuccess:e})}else!function(e,t){navigator.serviceWorker.getRegistration("/uclient").then(n=>{if(n){const r=n.active||n.waiting||n.installing;n.unregister().then(n=>{n?r&&fg(r,"Unregister serviceWorker success",e):t.warn("Unregistering wwwroot scope serviceWorker resolve with false")}).catch(t=>{mg(e,"swUnRegistrationError",t)})}})}(t,a),caches.keys().then(e=>{const t=e.filter(e=>e.startsWith("Scripts_")||e.startsWith("gcm_"));for(const e of t)caches.delete(e)});else a.info("ServiceWorkers or webAPI caches are not supported for current useragent.")}}],Sh=[912559,E.b,E.a,2147951393,2147951394,2147951395,2147951396,2147951397,2147951398,2147779907,2147787024,-2147015420,-2147093999,-2147155696];class Oh{constructor(e){this._bcd=e,this._applicationContext={}}boot(){const e=window.ApplicationCodeExecuteStart;e&&_.a.addKeyPerformanceIndicator("ApplicationCodeExecuteStart",{},e),_.a.addKeyPerformanceIndicator("ApplicationBootStart");const t=m.a.trackWork("Boot");try{(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,n){let r=!1;const a=n.TraceManager&&n.TraceManager.getTracer("Boot.Initializer");return a&&a.debug("Initializer boot started."),e.reduce((e,i)=>e.then(()=>{const e=g.a.createEvent(i.diagnosticName,h.b).startStopwatch();let r;return r=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return 3===e.boot.length}(i)?i.boot(t,n,t.getStore()):i.boot(t,n),r instanceof Promise?r.then(()=>{e()},()=>{e()}):e(),r}).then(e=>(a&&a.info(i.diagnosticName+".Initializer - boot completed successfully."),e)).catch(e=>{throw r||(r=!0,a&&a.error(i.diagnosticName+".Initializer - boot failed with error: "+e.message),Object(d.b)(e,[{name:"BootTask",value:i.diagnosticName}])),e}),Promise.resolve())})(vh,this._bcd,this._applicationContext).then(()=>{t()}).then(()=>{this._handleSuccess()}).catch(e=>{t(),this._handleError(0,e,this._bcd.getStore())})}catch(e){this._handleError(0,e,this._bcd.getStore())}}_handleError(e,t,n){if(console.error(t.stack||t),!function(e){if(!e.errorCode)return!1;if(Sh.indexOf(e.errorCode)>-1)return!0;const t=e;return!(!Object(Io.g)(t)||-2147220960===t.getNegativeErrorCode())||2147873354===t.errorCode}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(t)?this._applicationContext&&this._applicationContext.EventManager&&this._applicationContext.EventManager.ReportComponentFailure("Boot.Start",t):(this._bcd.addEventParameter({name:v.c.Error,value:JSON.stringify(t)}),this._handleSuccess()),Object(E.j)(t.errorCode)&&this._bcd.getClientHost()===zo.a.Browser){const e=t.errorCode.toString(16);window.location.assign(`/_common/error/errorhandler.aspx?ErrorCode=${e}&BackUri=${encodeURIComponent(document.location.href)}`)}else{if(this._applicationContext&&n&&!t.suppressErrorDialog){const r=new y.a(this._applicationContext,n);r.isOperationAvailable("bootError")?r.bootError(e,t):this._renderErrorPage(t,n),this._applicationContext.RestoreStateManager.handleBootError()}this._handleApplicationCacheEvents()}}_handleSuccess(){if(this._applicationContext&&this._applicationContext.EventManager){const e=this._bcd.getEventParameters();this._applicationContext.EventManager.ReportComponentSuccess("Boot.Start",e),this._applicationContext.RestoreStateManager.handleBootSuccess()}this._handleApplicationCacheEvents()}_renderErrorPage(e,t){if(!this._applicationContext.ErrorService)throw e;{const n=this._applicationContext.EventManager.getCurrentSessionId();this._applicationContext.ErrorService.createErrorPopup(e,{sessionId:n},t)}}_handleApplicationCacheEvents(){this._bcd.getClientHost()===zo.a.MobileApplication&&(this._logApplicationCacheEvents(),this._subscribeToApplicationCacheEvents())}_subscribeToApplicationCacheEvents(){window.addEventListener("applicationCacheBlock",this._logApplicationCacheEvents.bind(this))}_logApplicationCacheEvents(){const e=window.navigator.onLine;if(localStorage.getItem("AppCacheEvent")&&this._applicationContext.EventManager){const t=this._applicationContext.TraceManager.getTracer("ApplicationCache"),n=JSON.parse(localStorage.getItem("AppCacheEvent"));for(let r=0;r<n.length;r++){const a=JSON.parse(n[r]),i=a[a.length-1].type,o=[{name:"blockType",value:i},{name:"cacheEventBlocks",value:n[r]}];"cached"===i||"updateready"===i||"noupdate"===i?this._applicationContext.EventManager.ReportComponentSuccess("ApplicationCache",o):"error"!==i&&"obsolete"!==i||(e?this._applicationContext.EventManager.ReportComponentFailure("ApplicationCache",o):t.warn("Application cache did not download new changes as network is not available.",o))}localStorage.setItem("AppCacheEvent","")}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Ch{constructor(e,t,n){this._appIdConfigured=e,this._autoSignIn=t,this._inAppNavigation=n}set appIdConfigured(e){this._appIdConfigured=e}set autoSignIn(e){this._autoSignIn=e}set inAppNavigation(e){this._inAppNavigation=e}getShimBootTypeString(){return JSON.stringify({appIdConfigured:this._appIdConfigured,autoSignIn:this._autoSignIn,inAppNavigation:this._inAppNavigation})}}var Eh=n("3bZx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Ih{constructor(e,t,n,r,a,i,o,s,c,l){this._initialUrl=e,this._baseUrl=t,this._setOrgUrl(n),this._org=r,this._setIsLiveId(a),this._setClientHost(s),this.setIsLocalStoreAvailable(o),this._setInAppNavigate(c),this._setIsPreload(l),this._shimBootType=new Ch(!1,!1,!1),this._sharedVariables=new Eh.a,this._eventParameters=[]}getIsLocalStoreAvailable(){return this._isLocalStoreAvailable}setIsLocalStoreAvailable(e){this._isLocalStoreAvailable=e}getBaseUrl(){return this._baseUrl}getInitialUrl(){return this._initialUrl}setInitialUrl(e){this._initialUrl=e}getOrgUrl(){return this._orgUrl}getOrg(){return this._org}getStore(){return this._store}setStore(e){this._store=e}_setOrgUrl(e){this._orgUrl=e}getIsLiveId(){return this._isLiveId}_setIsLiveId(e){this._isLiveId=e}getClientHost(){return this._clientHost}_setClientHost(e){this._clientHost=e}getInAppNavigate(){return this._inAppNavigate}_setInAppNavigate(e){this._inAppNavigate=e}getIsPreload(){return this._isPreload}_setIsPreload(e){this._isPreload=e}getShimBootType(){return this._shimBootType}setSharedVariable(e,t){this._sharedVariables.setItem(e,t)}getSharedVariable(e){return this._sharedVariables.getItem(e)}removeSharedVariable(e){this._sharedVariables.removeItem(e)}addEventParameter(e){this._eventParameters.push(e)}getEventParameters(){return this._eventParameters}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let wh=r;wh=a;const jh=["app","appId","appid","cache","clienthost","cmdbar","channelId","defaulttracelevel","flags","forceUCI","isOverviewAboutTabInExpandedViewEnabled","liveid","LivePersonaCardVersionOverride","lpcstikkontakt","midgardTestEndpoint","midgardTestId","MidgardVersion","monitor","navbar","org",h.p,"ribbondebug","telemetry","testmode","useLocal","verboseLog","forceClientCDN"];function Ph(e){const t=new ji.a(e),n=t.searchParams.get("org")||window.__preload&&window.__preload.org,r=!!t.searchParams.get("liveid")||!(!window.__preload||!window.__preload.isLiveId),a=!!t.searchParams.get("skipSetupCookie"),i=!!t.searchParams.get("inAppNavigate"),o=!!Object(Wn.c)(t.searchParams.get("preload")),s=Th(t);let c=s===zo.a.MobileApplication;const l=function(e,t){const n=new ji.a(e);n.search="";for(const e of jh)t.searchParams.has(e)&&n.searchParams.set(e,t.searchParams.get(e));t.searchParams.has("newWindow")&&n.searchParams.set("newWindow",t.searchParams.get("newWindow"));return n.hash="",n}(e,t),u=function(e,t,n){let r=e.protocol+"//"+e.host;n||(r="/"+t);return r}(t,n,r);return new Ih(t,l,u,n,r,a,c,s,i,o)}function Th(e){let t=zo.a.Browser;const n=parseInt(e.searchParams.get("clienthost"),10);return isNaN(n)?"nga"===e.pathname.split("/")[1]&&(t=zo.a.MobileApplication):t=n,t}!function(){const e=["checking","noupdate","cached","updateready","obsolete","progress","downloading","error"];let t;if(window.applicationCache&&Th(new ji.a(window.location.href))===zo.a.MobileApplication){try{t=JSON.parse(localStorage.getItem("AppCacheEvent"))||[]}catch(e){t=[]}e.forEach((function(e){window.applicationCache.addEventListener(e,r,!1)}))}let n=[];function r(e){let r;if(r="checking"===e.type?{type:e.type,timeStamp:e.timeStamp,currentTimeStamp:Date.now(),url:window.location.href,cacheStatus:window.applicationCache.status}:{type:e.type,timeStamp:e.timeStamp,cacheStatus:window.applicationCache.status},n.push(r),"cached"===e.type||"updateready"===e.type||"noupdate"===e.type||"error"===e.type||"obsolete"===e.type){t.push(JSON.stringify(n)),localStorage.setItem("AppCacheEvent",JSON.stringify(t)),n=[];const e=document.createEvent("HTMLEvents");e.initEvent("applicationCacheBlock",!0,!0),document.dispatchEvent(e)}}}(),Object(qs.c)(),setTimeout(()=>{var e;e=Ph(window.location.href),new Oh(e).boot()},0)},DPfD:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return e&&e.externalContext?e.externalContext.availableContexts:null}function a(e,t,n){if(e&&e.externalContext&&e.externalContext.knownProperties&&e.externalContext.knownProperties[t])return e.externalContext.knownProperties[t][n]}function i(e,t,n){return e&&e.externalContext&&e.externalContext.propertyListeners&&e.externalContext.propertyListeners[t]&&e.externalContext.propertyListeners[t][n]?e.externalContext.propertyListeners[t][n]:null}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i}))},DRVD:function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.PerformanceEventTracker=void 0;var a=n("87CA"),i=function(){function e(){this._transportVersion=0,this._transportFunctionsByZone={},this.resetTransports()}return e.prototype.getTransports=function(e){var t=this._transports[e];return t?this._transports.__all__.concat(t):this._transports.__all__},e.prototype._getTransportFunction=function(e){var t,n,r=this;if(this._transportFunctionsByZone[e])return this._transportFunctionsByZone[e];var a=function(){return(!t||r._transportVersion>n)&&(t=r.getTransports(e),n=r._transportVersion),t};return this._transportFunctionsByZone[e]=a,a},e.prototype.resetTransports=function(){var e;this._transports=((e={}).__all__=[],e),this._transportVersion++},e.prototype.registerTransport=function(e,t){var n,a;if(void 0===t&&(t=null),t&&0!==t.length)try{for(var i=r(t),o=i.next();!o.done;o=i.next()){var s=o.value;this._transports[s]?this._transports[s].push(e):this._transports[s]=[e]}}catch(e){n={error:e}}finally{try{o&&!o.done&&(a=i.return)&&a.call(i)}finally{if(n)throw n.error}}else this._transports.__all__.push(e);this._transportVersion++},e.prototype.removeTransport=function(e){var t,n,a=Object.keys(this._transports);try{for(var i=r(a),o=i.next();!o.done;o=i.next()){var s=o.value,c=this._transports[s],l=c.indexOf(e);l>-1&&c.splice(l,1)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},e.prototype.createEvent=function(e,t){return new a.PerformanceEvent(e,t,this._getTransportFunction(t))},e}();t.PerformanceEventTracker=i;var o=new i;t.default=o},"DS+G":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("uu/V"),a=n("ai6P");class i extends r.a{constructor(e,t,n,r){super(e,t,n,r),this._userContext=null,this.get_success()&&(this._userContext=Object(a.a)(this.get_response()))}get_userContext(){return this._userContext}}},Datm:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o}));const r="metadata.rootCanvasApp.set",a="metadata.rootCanvasApp.dataComponent.update";function i(e){return{type:r,payload:e}}function o(e){return{type:a,payload:e}}},"Dea/":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Create=2]="Create",e[e.Update=3]="Update"}(r||(r={}))},DijY:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.crud=0]="crud",e[e.nonCrud=1]="nonCrud",e[e.changeProcessAndStage=2]="changeProcessAndStage",e[e.transaction=3]="transaction"}(r||(r={}))},Div0:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.actions=1]="actions",e[e.core=30]="core",e[e.framework=51]="framework",e[e.indexedDb=60]="indexedDb",e[e.PAL=81]="PAL",e[e.sql=109]="sql",e[e.sqlBatch=110]="sqlBatch",e[e.sqlDbTransactionAdapter=111]="sqlDbTransactionAdapter",e[e.taskRunner=119]="taskRunner",e[e.authentication=159]="authentication",e[e.telemetry=164]="telemetry",e[e.quickFind=168]="quickFind",e[e.storage=1005]="storage",e[e.xmlNodeFactory=1006]="xmlNodeFactory",e[e.dataSource=1007]="dataSource",e[e.localDataSource=1008]="localDataSource",e[e.crmServerDataSource=1009]="crmServerDataSource",e[e.scheduler=1025]="scheduler",e[e.offlineDataStore=1031]="offlineDataStore",e[e.offlineMetadataSync=1032]="offlineMetadataSync",e[e.offlineUpSync=1035]="offlineUpSync"}(r||(r={}))},"E+Gg":function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n("Lyxw"),a=n("3/02"),i=n("LzVy"),o=n("sclX"),s=n("NjDY"),c=n("ORLm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&(e&&e.every((e,n)=>t[n]&&e===t[n]))}function u(e){return Object(i.a)(e)===o.b.Web&&Object(r.a)(e,a.Ic,a.Lc)&&Object(s.n)(e)&&Object(c.a)(e)}},E3i9:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){return e&&e.metadata&&e.metadata.lookup&&e.metadata.lookup.hasOwnProperty(t)?e.metadata.lookup[t]:null}function a(e,t,n){const a=r(e,t);return a&&a.hasOwnProperty(n)?a[n]:null}function i(e,t,n){const r=a(e,t,n);return r&&r.view?r.view:null}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i}))},E3kc:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("LbMF");const a="dialog.attribute.optionsets.update";function i(e,t,n){const i=Object(r.k)(e,t),o={};i&&n.forEach(e=>{const t=e.AttributeName;t&&i[t]&&(o[t]=Object.assign(Object.assign({},i[t]),{OptionSet:Object.assign([],i[t].OptionSet,e.Options)}))});const s={};return s[t]=o,{type:a,payload:{attributes:s},meta:{dialogIdentifier:t}}}},E5IU:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"i",(function(){return p})),n.d(t,"j",(function(){return g})),n.d(t,"l",(function(){return h})),n.d(t,"m",(function(){return f})),n.d(t,"g",(function(){return _})),n.d(t,"f",(function(){return u})),n.d(t,"n",(function(){return d})),n.d(t,"h",(function(){return m})),n.d(t,"k",(function(){return b})),n.d(t,"a",(function(){return i})),n.d(t,"o",(function(){return y}));var r=n("Lyxw"),a=n("3/02");const i="d365custom";function o(e){return e&&e.metadata&&e.metadata.appContext?e.metadata.appContext:null}function s(e){const t=o(e);return t&&t.app?t.app:null}function c(e){const t=s(e);return t?t.appComponents:null}function l(e,t){const n=s(e),r=n?n.components:null,a=[];if(r&&r.length&&r.length>0)for(const e of r)e.Type===t&&a.push(e.Id);return a}function u(e){const t=o(e);return t&&t.webResource?t.webResource:null}function d(e){const t=o(e);return t&&t.welcomePage?t.welcomePage:null}function p(e){const t=s(e);return t&&t.appId?t.appId:null}function g(e){const t=s(e);return t&&t.title?t.title:null}function h(e){const t=s(e);return t&&t.uniqueName?t.uniqueName:null}function f(e){const t=s(e);return t&&t.uniqueName?t.uniqueName:e&&e.configuration&&e.configuration.isD365DefaultApp?i:"__ unavailable__"}function m(e){const t=s(e);return t&&t.clientType?t.clientType:null}function b(e){const t=s(e);return t&&Number.isInteger(t.navigationType)?t.navigationType:null}function _(e,t){var n,r;const a=s(t);return void 0===(null===(r=null===(n=null==a?void 0:a.appSettings)||void 0===n?void 0:n[e])||void 0===r?void 0:r.value)?null:a.appSettings[e].value}function y(e){return!1===_("ServerMode",e)&&Object(r.c)(e,a.Oc)}},E7fB:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var r=n("ABCl"),a=n("9eA9"),i=n("IqkD"),o=n("SAYH"),s=n("69Qu"),c=n("GYEz"),l=n("eOoD"),u=n("16wZ"),d=n("qshH"),p=n("ZIjf");let g;class h{constructor(e){g=e}getClient(){const e="ClientApi.XrmPageContextClient.getClient";try{let t;p.a.instance.reportCall(e);const n=Object(c.k)(g.getState());switch(n){case"Mobile":t="Mobile";break;case"Outlook":t="Outlook";break;case"Web":t="Web";break;case"UnifiedServiceDesk":t="UnifiedServiceDesk";break;default:const r=[];r.push({name:"clientName",value:n}),d.a.getInstance().reportFailure(e,new Error("Unknown client"),null,r)}return p.a.instance.reportSuccess(e),t}catch(t){throw d.a.getInstance().reportFailure(e,t),t}}getClientState(){const e="ClientApi.XrmPageContextClient.getClientState";try{p.a.instance.reportCall(e);const t=Object(s.b)(g.getState())?"Online":"Offline";return p.a.instance.reportSuccess(e),t}catch(t){throw d.a.getInstance().reportFailure(e,t),t}}getFormFactor(){const e="ClientApi.XrmPageContextClient.getFormFactor";try{p.a.instance.reportCall(e);const t=this.getClient();let n;if("Web"===t||"UnifiedServiceDesk"===t)n=1;else{const t=Object(c.e)(g.getState());switch(t){case l.a.Phone:n=3;break;case l.a.Tablet:n=2;break;default:Object(u.h)(e,"ClientHostSubtype",t)}}return p.a.instance.reportSuccess(e),n}catch(t){throw d.a.getInstance().reportFailure(e,t),t}}isOffline(){const e="ClientApi.XrmPageContextClient.isOffline";try{p.a.instance.reportCall(e);const t=!Object(s.b)(g.getState());return p.a.instance.reportSuccess(e),t}catch(t){throw d.a.getInstance().reportFailure(e,t),t}}}var f=n("arV0"),m=n("NvOS"),b=n("xkcG"),_=n("Axoi"),y=n("NjDY"),v=n("E5IU"),S=n("YxC/"),O=n("EY5k"),C=n("IaGr"),E=n("3yqi"),I=n("i1f0");let w;class j{constructor(e,t){w=e,this._pageId=t,this._clientApiExecutor=new r.b(w,"ClientApi.XrmGlobalContext.")}get client(){const e="ClientApi.XrmGlobalContext.client";try{return p.a.instance.reportCall(e),this._client||(this._client=new h(w)),p.a.instance.reportSuccess(e),this._client}catch(t){throw d.a.getInstance().reportFailure(e,t),t}}get userSettings(){const e="ClientApi.XrmGlobalContext.userSettings";try{return p.a.instance.reportCall(e),this._userSettings||(this._userSettings=new b.a(w)),p.a.instance.reportSuccess(e),this._userSettings}catch(t){throw d.a.getInstance().reportFailure(e,t),t}}get organizationSettings(){const e="ClientApi.XrmGlobalContext.organizationSettings";try{return p.a.instance.reportCall(e),this._organizationSettings||(this._organizationSettings=new _.a(w)),p.a.instance.reportSuccess(e),this._organizationSettings}catch(t){throw d.a.getInstance().reportFailure(e,t),t}}getAdvancedConfigSetting(e){const t="ClientApi.XrmGlobalContext.getAdvancedConfigSetting";try{p.a.instance.reportCall(t);const n=Object(y.x)(w.getState());let r=null;switch(e){case"MaxChildIncidentNumber":r=n.maxChildIncidentNumber;break;case"MaxIncidentMergeNumber":r=n.maxIncidentMergeNumber;break;case"MicrosoftFlowEnvironmentId":r=n.microsoftFlowEnvironmentId;break;case"MicrosoftFlowDestinationUrl":r=n.microsoftFlowDestinationUrl;break;case"MicrosoftFlowFirstPartyIntegrationSiteUrl":r=n.microsoftFlowFirstPartyIntegrationSiteUrl;break;case"IsMicrosoftFlowEnabled":r=n.isMicrosoftFlowEnabled;break;default:const a=[];return a.push({name:"setting",value:e}),d.a.getInstance().reportFailure(t,new Error("Not supported by advanced config settings"),null,a),null}return p.a.instance.reportSuccess(t),r}catch(e){throw d.a.getInstance().reportFailure(t,e),e}}getClientUrl(){const e="ClientApi.XrmGlobalContext.getClientUrl";try{p.a.instance.reportCall(e);const t=Object(a.b)()+Object(m.a)(w.getState(),"");return p.a.instance.reportSuccess(e),t}catch(t){throw d.a.getInstance().reportFailure(e,t),t}}getWebResourceUrl(e){return this._clientApiExecutor.execute("getWebResourceUrl",()=>Object(y.t)(w.getState())+e,[{name:"name",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"}])}getCurrentTheme(){return p.a.instance.reportUsage("ClientApi.XrmGlobalContext.getCurrentTheme"),"default"}getIsAutoSaveEnabled(){const e="ClientApi.XrmGlobalContext.getIsAutoSaveEnabled";try{p.a.instance.reportCall(e);const t=Object(I.Qc)(w.getState());return p.a.instance.reportSuccess(e),t}catch(t){throw d.a.getInstance().reportFailure(e,t),t}}getAppointmentRichEditorExperience(){const e="ClientApi.XrmGlobalContext.getAppointmentRichEditorExperience";try{p.a.instance.reportCall(e);const t=this.organizationSettings.appointmentRichEditorExperience;return p.a.instance.reportSuccess(e),t}catch(t){throw d.a.getInstance().reportFailure(e,t),t}}getOrgLcid(){const e="ClientApi.XrmGlobalContext.getOrgLcid";try{p.a.instance.reportCall(e);const t=this.organizationSettings.languageId;return p.a.instance.reportSuccess(e),t}catch(t){throw d.a.getInstance().reportFailure(e,t),t}}getOrgUniqueName(){const e="ClientApi.XrmGlobalContext.getOrgUniqueName";try{p.a.instance.reportCall(e);const t=this.organizationSettings.uniqueName;return p.a.instance.reportSuccess(e),t}catch(t){throw d.a.getInstance().reportFailure(e,t),t}}getQueryStringParameters(){return this._clientApiExecutor.execute("getQueryStringParameters",(e,t)=>{let n={};if(!this._pageId)return C.a.getInstance().traceManager.getTracer(e+".pageId").error("Missing pageId",t),n;const r=Object(f.l)(w.getState(),this._pageId);t.push({name:"pageType",value:r});const a=Object(f.g)(w.getState(),this._pageId);if(!a)return C.a.getInstance().traceManager.getTracer(e+".pageInput").warn("Page input was not defined",t),n;if(r===E.a.Grid){const e=a;e.viewId&&(n.viewId=e.viewId.toString()),e.viewType&&(n.viewType=e.viewType.toString())}else{const e=a;e.data&&(n=e.data),e.entityTypeName&&(n.entityTypeName=e.entityTypeName),e.id&&(n.id=o.a.externalGuid(e.id)),e.formId&&(n.formId=o.a.externalGuid(e.formId)),e.pageType&&(n.pageType=e.pageType),e.recordSetQueryKey&&(n.recordSetQueryKey=o.a.externalGuid(o.a.fromExternalGuid(e.recordSetQueryKey.split(":",1)[0].substring(e.recordSetQueryKey.split(":",1)[0].indexOf("-")+1)))),e.processId&&(n.process=e.processId),e.processInstanceId&&(n.processinstanceid=e.processInstanceId),e.selectedStageId&&(n.selectedstageid=e.selectedStageId),e.isCrossEntityNavigate&&(n.isCrossEntityNavigate=e.isCrossEntityNavigate.toString())}return n})}getTimeZoneOffsetMinutes(){const e="ClientApi.XrmGlobalContext.getTimeZoneOffsetMinutes";try{p.a.instance.reportCall(e);const t=this.userSettings.getTimeZoneOffsetMinutes();return p.a.instance.reportSuccess(e),t}catch(t){throw d.a.getInstance().reportFailure(e,t),t}}getUserId(){const e="ClientApi.XrmGlobalContext.getUserId";try{p.a.instance.reportCall(e);const t=this.userSettings.userId;return p.a.instance.reportSuccess(e),t}catch(t){throw d.a.getInstance().reportFailure(e,t),t}}getUserLcid(){const e="ClientApi.XrmGlobalContext.getUserLcid";try{p.a.instance.reportCall(e);const t=this.userSettings.languageId;return p.a.instance.reportSuccess(e),t}catch(t){throw d.a.getInstance().reportFailure(e,t),t}}getUserName(){const e="ClientApi.XrmGlobalContext.getUserName";try{p.a.instance.reportCall(e);const t=this.userSettings.userName;return p.a.instance.reportSuccess(e),t}catch(t){throw d.a.getInstance().reportFailure(e,t),t}}getUserRoles(){const e="ClientApi.XrmGlobalContext.getUserRoles";try{p.a.instance.reportCall(e);const t=this.userSettings.securityRoles;return p.a.instance.reportSuccess(e),t}catch(t){throw d.a.getInstance().reportFailure(e,t),t}}getUserRolePrivileges(){const e="ClientApi.XrmGlobalContext.getUserRolePrivileges";try{p.a.instance.reportCall(e);const t=this.userSettings.securityRolePrivileges;return p.a.instance.reportSuccess(e),t}catch(t){throw d.a.getInstance().reportFailure(e,t),t}}prependOrgName(e){const t="ClientApi.XrmGlobalContext.prependOrgName";try{p.a.instance.reportCall(t);const n=Object(m.a)(w.getState(),e);return p.a.instance.reportSuccess(t),n}catch(e){throw d.a.getInstance().reportFailure(t,e),e}}isOnPremises(){const e="ClientApi.XrmGlobalContext.isOnPremises";try{p.a.instance.reportCall(e);const t=Object(i.w)(w.getState()),n=t&&!t.isLive;return p.a.instance.reportSuccess(e),n}catch(t){throw d.a.getInstance().reportFailure(e,t),t}}getVersion(){const e="ClientApi.XrmGlobalContext.getVersion";try{p.a.instance.reportCall(e);const t=Object(y.y)(w.getState()).serverVersion;return p.a.instance.reportSuccess(e),t}catch(t){throw d.a.getInstance().reportFailure(e,t),t}}getCurrentAppUrl(){const e="ClientApi.XrmGlobalContext.getCurrentAppUrl";try{p.a.instance.reportCall(e);let t=null;if("Mobile"!==this.client.getClient()){let e=this.getClientUrl();const n=Object(v.i)(w.getState());null!==n&&(e=e+"/main.aspx?appid="+n),t=e}return p.a.instance.reportSuccess(e),t}catch(t){throw d.a.getInstance().reportFailure(e,t),t}}getCurrentAppName(){return this._clientApiExecutor.executeAsync("getCurrentAppName",(e,t)=>{const n=Object(v.j)(w.getState());if(null!==n)return Promise.resolve(n);const r=Object(y.x)(w.getState());if(null==r?void 0:r.defaultCrmCustomName)return Promise.resolve(r.defaultCrmCustomName);this._clientApiExecutor.reportFailure(e,new Error("App Name is null"),t);const a=["AppModule.APIError"];return w.dispatch(Object(O.e)(a)).then(()=>{const e=Object(S.b)(w.getState(),"AppModule.APIError");return Promise.reject({errorCode:2147746581,message:e,code:2147746581})})})}getCurrentAppProperties(){const e="ClientApi.XrmGlobalContext.getCurrentAppProperties";try{p.a.instance.reportCall(e);const t={};t.appId=Object(v.i)(w.getState()),t.displayName=Object(v.j)(w.getState());const n=Object(v.d)(w.getState());n&&(t.uniqueName=n.uniqueName,t.url=n.appUrl);const r=Object(v.f)(w.getState());r&&(t.webResourceId=r.guid,t.webResourceName=r.name);const a=Object(v.n)(w.getState());return a&&(t.welcomePageId=a.guid,t.welcomePageName=a.name),p.a.instance.reportSuccess(e),Promise.resolve(t)}catch(t){return Object(u.d)(w,t,e)}}}},E8F2:function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return f})),n.d(t,"e",(function(){return m})),n.d(t,"g",(function(){return _})),n.d(t,"f",(function(){return S})),n.d(t,"i",(function(){return b})),n.d(t,"h",(function(){return O})),n.d(t,"b",(function(){return C}));var r=n("ngeo"),a=n("Uv1Y"),i=n("pF61"),o=n("arV0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s={[2147747079..toString()]:"Account loop being created violation encountered.",[2147746611..toString()]:"Duplicate records found violation encountered.",[2147746405..toString()]:"Isv aborted violation encountered.",[2147746340..toString()]:"Isv unexpected violation encountered.",[2147749377..toString()]:"Metadata no mapping violation encountered.",[-2147220969..toString()]:"A record with a provided id does not exist",[2147746327..toString()]:"A record with a provided id does not exist",[2147746353..toString()]:"Principal privilege denied violation encountered.",[2147746342..toString()]:"Read privilege violation encountered.",[2147757834..toString()]:"Team not assigned roles violation encountered.",[2147779334..toString()]:"Not enough privilege to access the Microsoft Dynamics 365 object or perform the requested operation.",[22e8.toString()]:"Create privilege violation encountered.",[2200000001..toString()]:"Non-UCI entity detected.",[2200000002..toString()]:"Read-only entity detected.",[2200000003..toString()]:"Saving in progress violation detected.",[2200000004..toString()]:"Saving a read-only form violation detected.",[2200000005..toString()]:"Cannot save due to PreventDefault encountered.",[2200000006..toString()]:"Cannot save due to no dirty changes.",[2200000007..toString()]:"Cannot save due to invalid form.",[2200000009..toString()]:"Invalid Form parameters",[2200000016..toString()]:"Unsupported action",[2200000017..toString()]:"The record you are trying to access does not have a form to display. Please contact your administrator for assistance."},c=/Could not find a property named '(.*)' on type '.*'/;function l(e,t){if(e&&s[e.toString()]){let n=s[e.toString()];return t&&t.length>0&&(n=String.format(n,t)),n}throw new Error("FormErrorCode: can't return error message for an invalid error code: "+e)}function u(e){const t="0x"+r.a.getHexErrorCodeFromInt(e);return["Error_Title_"+t,"Error_Message_"+t]}function d(e){return e&&null!=e.errorCode&&(2147746405===e.errorCode||2147746340===e.errorCode)}function p(e,t){d(e)&&t.push({name:"IsIsvViolation",value:!0})}function g(e){return e&&null!=e.errorCode&&(2147746342===e.errorCode||22e8===e.errorCode||2147757834===e.errorCode||2147746353===e.errorCode||2147779334===e.errorCode)}function h(e,t){g(e)&&t.push({name:"IsPermissionsError",value:!0})}function f(e,t){p(e,t),h(e,t),function(e,t){2147750146===e.errorCode&&t.push({name:"IsNoEntityError",value:!0})}(e,t)}function m(e){return null!=e&&(null!=e.reason&&2147746611===e.reason.errorCode||null!=e.errorCode&&2147746611===e.errorCode)}function b(e,t){if(e&&"boolean"==typeof e.blockErrorReporting){const n=e.blockErrorReporting;return e.blockErrorReporting=t,n}return null}function _(e){return null!=e&&(2200000004===e.errorCode||2200000005===e.errorCode||2200000006===e.errorCode||2200000007===e.errorCode)}function y(e){return m(e)||_(e)}function v(e,t,n,r){const i=n;return Object(a.g)(i)?{success:!0,message:"Authentication or permissions error occurred"}:2200000003===n.errorCode||2147747079===n.errorCode||2200000001===n.errorCode||2147746327===n.errorCode||-2147220969===n.errorCode||2147750146===n.errorCode||2200000002===n.errorCode&&Object(o.m)(e,t)?{success:!0,message:s[n.errorCode.toString()]}:d(n)?(r&&p(n,r),{success:!0,message:"Isv violation occurred. Check EventContext for errorCode.",componentNamePrefix:"IsvViolation."}):g(n)?(r&&h(n,r),{success:!0,message:"Permissions error occurred. Check EventContext for errorCode."}):S(e,t,n)?{success:!0,message:"Fast navigation error occured."}:function(e){if(!e||!e.message)return!1;return null!=c.exec(e.message)}(n)?(r&&function(e,t){if(!e||!e.message)return;const n=c.exec(e.message);n&&t.push({name:"AttributeName",value:n[1]})}(n,r),{success:!0,message:"Deprecated attribute error occured."}):-2147093999===(null==n?void 0:n.errorCode)?{success:!0,message:"Failed to fetch is caused by unstable network and is not SLA impacting error."}:{success:!1}}function S(e,t,n){return n&&2200000008===n.errorCode||Object(i.n)(e,t)}function O(e,t,n,r,a,i){if(n){if(!y(n)){const o=v(e,t,n,r);o.success?(b(n,!0),a.TraceManager.getTracer(o.componentNamePrefix+i).warn(o.message,r)):a.EventManager.ReportComponentFailure(i,n,"Look at correlated traces via ActivityId or UserId around the TimeCreated",r)}}else a.EventManager.ReportComponentFailure(i,n,"Look at correlated traces via ActivityId or UserId around the TimeCreated",r)}function C(e,t,n,r,i,o){const s={errorCode:n},c=y(s)||v(e,t,s,null).success;return new a.a(null!=r?r:l(n),n,void 0,void 0,void 0,void 0,void 0,void 0,i,o,void 0,c)}},EAYf:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t,n=[]){this._serviceName=e,this._operationName=t,this._parameters=n}getServiceName(){return this._serviceName}getOperationName(){return this._operationName}getParameters(){return this._parameters}}},EBJu:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the QuickCreateForm page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="QuickCreateForm"},EDOo:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="ReadOnly",a="MenuItem_Label_AddObject",i=[r,a]},EDmP:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("KEoC"),a=n("4or6"),i=n("OirV"),o=function(){function e(e,t){this._allowDeviceFields=e,this._properties=t}return e.prototype.setAppId=function(e){this._addContext("AppInfo.Id",e)},e.prototype.setAppVersion=function(e){this._addContext("AppInfo.Version",e)},e.prototype.setAppLanguage=function(e){this._addContext("AppInfo.Language",e)},e.prototype.setDeviceId=function(e){this._allowDeviceFields&&(r.default.checkAndSaveDeviceId(e),this._addContext("DeviceInfo.Id",e))},e.prototype.setDeviceOsName=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.OsName",e)},e.prototype.setDeviceOsVersion=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.OsVersion",e)},e.prototype.setDeviceBrowserName=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserName",e)},e.prototype.setDeviceBrowserVersion=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserVersion",e)},e.prototype.setDeviceMake=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.Make",e)},e.prototype.setDeviceModel=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.Model",e)},e.prototype.setUserId=function(e,t,n){if(!isNaN(n)&&null!==n&&n>=0&&n<=12)this._addContext("UserInfo.IdType",n.toString());else{var r=void 0;switch(t){case a.AWTPiiKind.SipAddress:r=i.AWTUserIdType.SipAddress;break;case a.AWTPiiKind.PhoneNumber:r=i.AWTUserIdType.PhoneNumber;break;case a.AWTPiiKind.SmtpAddress:r=i.AWTUserIdType.EmailAddress;break;default:r=i.AWTUserIdType.Unknown}this._addContext("UserInfo.IdType",r.toString())}if(isNaN(t)||null===t||t===a.AWTPiiKind.NotSet||t>13)switch(n){case i.AWTUserIdType.Skype:t=a.AWTPiiKind.Identity;break;case i.AWTUserIdType.EmailAddress:t=a.AWTPiiKind.SmtpAddress;break;case i.AWTUserIdType.PhoneNumber:t=a.AWTPiiKind.PhoneNumber;break;case i.AWTUserIdType.SipAddress:t=a.AWTPiiKind.SipAddress;break;default:t=a.AWTPiiKind.NotSet}this._addContextWithPii("UserInfo.Id",e,t)},e.prototype.setUserAdvertisingId=function(e){this._addContext("UserInfo.AdvertisingId",e)},e.prototype.setUserTimeZone=function(e){this._addContext("UserInfo.TimeZone",e)},e.prototype.setUserLanguage=function(e){this._addContext("UserInfo.Language",e)},e.prototype._addContext=function(e,t){"string"==typeof t&&this._properties.setProperty(e,t)},e.prototype._addContextWithPii=function(e,t,n){"string"==typeof t&&this._properties.setPropertyWithPii(e,t,n)},e}();t.default=o},EHQq:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");class a extends r.a{constructor(e,t,n,r,a,i,o,s){super(),this._currentEntityId=null,this._currentEntityLogicalName=null,this._nextEntityId=null,this._nextEntityLogicalName=null,this._newActiveStageId=null,this._newTraversedPath=null,this._processId=null,this._processInstanceId=null,this._currentEntityId=e,this._currentEntityLogicalName=t,this._nextEntityId=n,this._nextEntityLogicalName=r,this._newActiveStageId=a,this._newTraversedPath=i,this._processId=o,this._processInstanceId=s}get_name(){return"NavigateToNextEntity"}get_currentEntityId(){return this._currentEntityId}get_currentEntityLogicalName(){return this._currentEntityLogicalName}get_nextEntityId(){return this._nextEntityId}get_nextEntityLogicalName(){return this._nextEntityLogicalName}get_newActiveStageId(){return this._newActiveStageId}get_newTraversedPath(){return this._newTraversedPath}get_processId(){return this._processId}get_processInstanceId(){return this._processInstanceId}}},"ENs/":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("4or6"),a=n("UriP"),i=n("W8lr"),o=n("YQTs"),s=n("4WQe"),c=n("NCQ1"),l=function(){function e(e,t,n,i){this._queueSizeLimit=t,this._isCurrentlyUploadingNow=!1,this._uploadNowQueue=[],this._shouldDropEventsOnPause=!1,this._paused=!1,this._queueSize=0,this._outboundQueue=[],this._inboundQueues={},this._inboundQueues[r.AWTEventPriority.High]=[],this._inboundQueues[r.AWTEventPriority.Normal]=[],this._inboundQueues[r.AWTEventPriority.Low]=[],this._addEmptyQueues(),this._batcher=new o.default(this._outboundQueue,500),this._httpManager=new a.default(this._outboundQueue,e,this,n,i)}return e.prototype.addEvent=function(e){c.isPriority(e.priority)||(e.priority=r.AWTEventPriority.Normal),e.priority===r.AWTEventPriority.Immediate_sync?this._httpManager.sendSynchronousRequest(this._batcher.addEventToBatch(e),e.apiKey):this._queueSize<this._queueSizeLimit||this._dropEventWithPriorityOrLess(e.priority)?this._addEventToProperQueue(e):s.default.eventsDropped([e],r.AWTEventsDroppedReason.QueueFull)},e.prototype.sendEventsForPriorityAndAbove=function(e){this._batchEvents(e),this._httpManager.sendQueuedRequests()},e.prototype.hasEvents=function(){return(this._inboundQueues[r.AWTEventPriority.High][0].length>0||this._inboundQueues[r.AWTEventPriority.Normal][0].length>0||this._inboundQueues[r.AWTEventPriority.Low][0].length>0||this._batcher.hasBatch())&&this._httpManager.hasIdleConnection()},e.prototype.addBackRequest=function(e){if(!this._paused||!this._shouldDropEventsOnPause){for(var t in e)if(e.hasOwnProperty(t))for(var n=0;n<e[t].length;++n)e[t][n].sendAttempt<6?this.addEvent(e[t][n]):s.default.eventsDropped([e[t][n]],r.AWTEventsDroppedReason.MaxRetryLimit);i.default.scheduleTimer()}},e.prototype.teardown=function(){this._paused||(this._batchEvents(r.AWTEventPriority.Low),this._httpManager.teardown())},e.prototype.uploadNow=function(e){var t=this;this._addEmptyQueues(),this._isCurrentlyUploadingNow?this._uploadNowQueue.push(e):(this._isCurrentlyUploadingNow=!0,setTimeout((function(){return t._uploadNow(e)}),0))},e.prototype.pauseTransmission=function(){this._paused=!0,this._httpManager.pause(),this.shouldDropEventsOnPause&&(this._queueSize-=this._inboundQueues[r.AWTEventPriority.High][0].length+this._inboundQueues[r.AWTEventPriority.Normal][0].length+this._inboundQueues[r.AWTEventPriority.Low][0].length,this._inboundQueues[r.AWTEventPriority.High][0]=[],this._inboundQueues[r.AWTEventPriority.Normal][0]=[],this._inboundQueues[r.AWTEventPriority.Low][0]=[],this._httpManager.removeQueuedRequests())},e.prototype.resumeTransmission=function(){this._paused=!1,this._httpManager.resume()},e.prototype.shouldDropEventsOnPause=function(e){this._shouldDropEventsOnPause=e},e.prototype._removeFirstQueues=function(){this._inboundQueues[r.AWTEventPriority.High].shift(),this._inboundQueues[r.AWTEventPriority.Normal].shift(),this._inboundQueues[r.AWTEventPriority.Low].shift()},e.prototype._addEmptyQueues=function(){this._inboundQueues[r.AWTEventPriority.High].push([]),this._inboundQueues[r.AWTEventPriority.Normal].push([]),this._inboundQueues[r.AWTEventPriority.Low].push([])},e.prototype._addEventToProperQueue=function(e){this._paused&&this._shouldDropEventsOnPause||(this._queueSize++,this._inboundQueues[e.priority][this._inboundQueues[e.priority].length-1].push(e))},e.prototype._dropEventWithPriorityOrLess=function(e){for(var t=r.AWTEventPriority.Low;t<=e;){if(this._inboundQueues[t][this._inboundQueues[t].length-1].length>0)return s.default.eventsDropped([this._inboundQueues[t][this._inboundQueues[t].length-1].shift()],r.AWTEventsDroppedReason.QueueFull),!0;t++}return!1},e.prototype._batchEvents=function(e){for(var t=r.AWTEventPriority.High;t>=e;){for(;this._inboundQueues[t][0].length>0;){var n=this._inboundQueues[t][0].pop();this._queueSize--,this._batcher.addEventToBatch(n)}t--}this._batcher.flushBatch()},e.prototype._uploadNow=function(e){var t=this;this.hasEvents()&&this.sendEventsForPriorityAndAbove(r.AWTEventPriority.Low),this._checkOutboundQueueEmptyAndSent((function(){t._removeFirstQueues(),null!=e&&e(),t._uploadNowQueue.length>0?setTimeout((function(){return t._uploadNow(t._uploadNowQueue.shift())}),0):(t._isCurrentlyUploadingNow=!1,t.hasEvents()&&i.default.scheduleTimer())}))},e.prototype._checkOutboundQueueEmptyAndSent=function(e){var t=this;this._httpManager.isCompletelyIdle()?e():setTimeout((function(){return t._checkOutboundQueueEmptyAndSent(e)}),250)},e}();t.default=l},EU8S:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){if(!e||0===e.length)return null;const t={};for(const n of e){const e={id:r.a.tryParse(n.Id),displayName:n.DisplayName,isEnabledForMobileClient:n.IsEnabledForMobileClient,name:n.Name,type:n.Type,content:n.Content,solutionName:n.SolutionName,solutionVersion:n.SolutionVersion,publisherName:n.PublisherName,versionNumber:n.VersionNumber,OverallVersionNumber:n.OverallVersionNumber};t[n.Id]=e}return t}function i(e){if(!e)return null;const t={};return e.CustomControls&&function(e,t){for(const n of e.CustomControls){const e=n.WebResourceStrings;if(e)for(const n in e){const r=e[n];t[n]={name:n,type:12..toString(),contentJson:"string"==typeof r?JSON.parse(r):r}}}}(e,t),e.WebResources&&function(e,t){for(const n in e.WebResources){const a=e.WebResources[n];if(a.Name){const e={id:r.a.tryParse(a.Id),displayName:a.DisplayName,isEnabledForMobileClient:a.IsEnabledForMobileClient,name:a.Name,type:a.Type,content:a.Content,contentJson:"string"==typeof a.ContentJson?JSON.parse(a.ContentJson):a.ContentJson,solutionName:a.SolutionName,solutionVersion:a.SolutionVersion,publisherName:a.PublisherName,dependency:a.Dependency,versionNumber:a.VersionNumber,OverallVersionNumber:a.OverallVersionNumber};t[a.Name]=e}}}(e,t),t}function o(e){let t;switch(e){case"6":t="image/jpeg";break;case"7":t="image/gif";break;case"10":t="image/vnd.microsoft.icon";break;case"11":t="image/svg+xml";break;case"5":default:t="image/png"}return"data:"+t+";base64,"}},EW4s:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e){if(this._resolved=!1,this._rejected=!1,this._nativePromiseRejectionSuppressed=!1,e){this._wrappedPromise=e;const t=this._wrappedPromise;"function"==typeof t.isFulfilled&&t.isFulfilled()?(this._resolved=!0,this._resolvedValue=t.value()):"function"==typeof t.isRejected&&t.isRejected()&&(this._rejected=!0,this._rejectedError=t.reason())}else this._wrappedPromise=new Promise((e,t)=>{this._nativeResolve=e,this._nativeReject=t})}isPending(){return!this._resolved&&!this._rejected}allArray(e){const t=e.map(e=>"function"==typeof e.nativePromise?e.nativePromise():e);return new r(Promise.all(t))}always(e){return this._resolved?(e(this._resolvedValue),this):this._rejected?(e(this._rejectedError),this._suppressNativePromiseRejection(),this):(this._wrappedPromise.then(e,e),this)}done(e){return this._rejected?this:this._resolved?(e(this._resolvedValue),this):(this._wrappedPromise.then(e),this)}catch(e){return this._resolved?this:this._rejected?(e(this._rejectedError),this._suppressNativePromiseRejection(),this):(this._wrappedPromise.then(void 0,e),this)}fail(e){return this.catch(e)}then(e,t){if(this._resolved)return e(this._resolvedValue),this;if(this._rejected)return t&&(t(this._rejectedError),this._suppressNativePromiseRejection()),this;const n=this._wrappedPromise.then(e,t);return new r(n)}nativePromise(){return this._wrappedPromise}reject(e){return this.isPending()?(this._rejected=!0,this._rejectedError=e,this._nativeReject(e),this):this}resolve(e){return this.isPending()?(this._resolved=!0,this._resolvedValue=e,this._nativeResolve(e),this):this}_suppressNativePromiseRejection(){this._nativePromiseRejectionSuppressed||(this._nativePromiseRejectionSuppressed=!0,this._wrappedPromise.catch(e=>{}))}}},EY5k:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"e",(function(){return y})),n.d(t,"g",(function(){return b})),n.d(t,"d",(function(){return _})),n.d(t,"f",(function(){return v}));var r=n("eXjw"),a=n("K7RF"),i=n("Uv1Y"),o=n("YxC/"),s=n("y6/h"),c=n("iJGp"),l=n("eq9I");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const u="resourcestring.retrieve",d="resourcestring.update.missing",p="set.resource.strings";let g=null,h=null,f=null,m=null;function b(){null===g&&(g=[],h=new Promise((e,t)=>{f=e,m=t}))}function _(e){const t=g;g=null,e(y(t)).then(()=>{f(),f=null,h=null},e=>{m(e),m=null,h=null})}function y(e){return{type:"resourcestring.retrieve.async",execute({dispatch:t,getState:n},p){if(null!==g&&null!==h)return g.push(...e),h;let f=e;const m=n(),b=Object(o.f)(m,e);if(b){f=e.filter(e=>{const t=b[e];return null==t});const t=Object(o.a)(m);t&&t.length>0&&(f=f.filter(e=>-1===t.indexOf(e)))}return f.length>0?(t(function(e){const t=Object(o.g)(e)?r.a.Refreshing:r.a.Initializing;return{type:u,payload:{resourceStrings:{initialized:t}}}}(m)),t(function(e){return{type:u,execute({dispatch:t,getState:n},r){const o=Object(a.b)("resourcestring",null,null,null,!1,c.a.OnDemandWithoutContext,null,null,e,null);return t(o).then(r=>{let a=[];if(r&&r.resourceStrings){const e=r.resourceStrings.strings;e&&(a=Object.keys(e))}r.resourceStrings.missingStringIds=e.filter(e=>-1===a.indexOf(e)),t({type:d,payload:r}),Object(s.c)(n())}).catch(t=>{e.filter(e=>void 0===l.d.x).length>0&&Object(i.b)(t)})}}}(f))):Promise.resolve()}}}function v(){const e=Object(s.b)(),t={resourceStrings:{initialized:r.a.Initialized,strings:e&&e.strings,missingStringIds:e&&e.missingStrings}};return{type:p,payload:t}}},EbwQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("Yb4o"),a=n("nA3O");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i extends a.a{}var o=n("XjOj"),s=n("Div0"),c=n("NMtn");class l extends r.a{constructor(e){super(),this._bridge=null,this._available=!1,this._perfData=null,this._perfDataForCompletedCalls=null,this._defaultDispatcherState=new i,this._bridge=e}get_dispatcherPerfDataLoggingEnabled(){return!1}get_perfDataForCompletedCalls(){return this._perfDataForCompletedCalls}set_perfDataForCompletedCalls(e){return this._perfDataForCompletedCalls=e,e}get_IsAvailable(){return this._available}set_IsAvailable(e){return this._available=e,e}get_state(){return this._defaultDispatcherState}get_version(){return this._bridge.get_version()}get_perfData(){return this._perfData}set_perfData(e){return this._perfData=e,e}setState(e){Object(c.b)(e,"state"),this.set_IsAvailable(!0),this.get_state().setValues(e)}changeState(e,t){Object(c.c)(e,"name");const n=this.get_state().getSchema();for(let r=0;r<n.get_count();r++){const a=n.get_item(r);if(a.get_name()===e){const n={};Object(o.f)(s.a.PAL,"Changing state, {0}",e),n[a.get_name()]=t;const r=a.get_jsonConverter().read(n,a),i=a.coerceToPropertyType(r);return this.get_state().setValue(a,i),!0}}return!1}raiseEvent(e,t){Object(c.c)(e,"name"),Object(o.f)(s.a.PAL,"Raising event, {0}",e),this.handleCustomEvent1(e,t)}movePerfDataToCompletedCallsDataset(e){this._perfData&&e in this._perfData&&(this._perfDataForCompletedCalls||(this._perfDataForCompletedCalls={}),this._perfDataForCompletedCalls[e]=this._perfData[e],delete this._perfData[e])}purgeCompletedCallPerfData(){this._perfDataForCompletedCalls=null}getFormattedPerfData(e,t){return String.format(":{0}:{1}",e,t)}logPerfData(e,t,n){if(!(this.get_dispatcherPerfDataLoggingEnabled()&&e&&""!==e&&t&&""!==t&&this._perfData))return;const r=new Sys.StringBuilder;r.append(e in this._perfData?this._perfData[e]:""),r.append(this.getFormattedPerfData(t,n)),this._perfData[e]=r.toString()}callNativeMethod(e,t){if(!this.get_IsAvailable())throw Error.invalidOperation("Trying to call native method "+t.get_methodName()+" before dispatcher is available");this._bridge.callNativeMethod(this,e,t)}}},Eh65:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.High=0]="High",e[e.Low=1]="Low"}(r||(r={}))},"Eq/9":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="plg.updatePluginState";function a(e,t){return{type:r,payload:{name:e,state:t}}}},Er26:function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return l}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="ModernDataLayer",a={ODataBuilder:r+".ODataBuilder",ModernDataSource:r+".ModernDataSource",ExpressionRuntime:r+".ExpressionRuntime",QueryBuilder:r+".QueryBuilder",ModernDataSourceGCM:r+".ModernDataSourceGCM",ModernDataSourceUserContext:r+".ModernDataSourceUserContext",ModernDataSourceRM:r+".ModernDataSourceRM"},i={ODataBuilder:"ODataBuilder",ModernDataSource:"ModernDataSource",ExpressionRuntimeHost:"ExpressionRuntimeHost",ModernQueryBuilder:"ModernQueryBuilder"},o={ERROR_DETAIL:"Error-Detail",CLIENT_TYPE:"Client-Type",OPERATION_TYPE:"Operation-Type",OPERATION_SUB_TYPE:"Operation-SubType",RUNTIME_CONTEXT:"Runtime-Context",ENTITY_NAME:"Entity-Name",IS_OFFLINE_BY_DEFAULT_REQUEST:"Is-Offline-By-Default-Request",EXECUTION_HINT:"Execution_Hint"},s={remote:"remote",local:"local"},c="Entity-Name",l="Is-Offline-By-Default-Request"},ErQw:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r={height:"16rem",width:"40rem",shadowColor:"#666666",type:"warning"},a={height:"16rem",width:"40rem",shadowColor:"#666666",type:"information"}},"Eua/":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("M1jQ"),a=n("WSMw");class i{constructor(){this.tableName=null,this.values=null,this.filter=null,this.operationType=null}}class o{constructor(e){this._suppressTrigger=!1,this._txList=[],this._suppressTrigger=e}get_supppressTrigger(){return this._suppressTrigger}get_txList(){return this._txList}addCreate(e,t){const n=new i;n.tableName=e,n.values=t,n.operationType=a.b,this.get_txList().push(n)}addUpdate(e,t){const n=new i;n.tableName=e,n.values=t,n.operationType=a.d,this.get_txList().push(n)}addDelete(e,t){const n=new i;n.tableName=e,n.filter=t,n.operationType=a.a,this.get_txList().push(n)}}var s=n("jZCH");class c extends r.a{constructor(){super(),this._transaction=null,this._offlineDataStore=null,this._offlineDataStore=s.a.get_DefaultInstance().get_LocalDataSource().get_offlineDataStore()}get_transaction(){return this._transaction}_set_transaction(e){return this._transaction=e,e}create(e,t){this.get_transaction().addCreate(e,t)}retrieve(e,t){return this._offlineDataStore.retrieveLocalEntities(e,t)}update(e,t){this.get_transaction().addUpdate(e,t)}Delete(e,t){this.get_transaction().addDelete(e,t)}begin(e){this._set_transaction(new o(e))}Commit(e){return this._offlineDataStore.executeTransaction(e)}}},Evi3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("NCQ1"),a=n("4WQe"),i=n("4or6"),o=function(){function e(){}return e.initialize=function(e){var t=this;this._sendStats=e,this._isInitalized=!0,a.default.addNotificationListener({eventsSent:function(e){t._addStat("records_sent_count",e.length,e[0].apiKey)},eventsDropped:function(e,n){switch(n){case i.AWTEventsDroppedReason.NonRetryableStatus:t._addStat("d_send_fail",e.length,e[0].apiKey),t._addStat("records_dropped_count",e.length,e[0].apiKey);break;case i.AWTEventsDroppedReason.MaxRetryLimit:t._addStat("d_retry_limit",e.length,e[0].apiKey),t._addStat("records_dropped_count",e.length,e[0].apiKey);break;case i.AWTEventsDroppedReason.QueueFull:t._addStat("d_queue_full",e.length,e[0].apiKey)}},eventsRejected:function(e,n){switch(n){case i.AWTEventsRejectedReason.InvalidEvent:t._addStat("r_inv",e.length,e[0].apiKey);break;case i.AWTEventsRejectedReason.KillSwitch:t._addStat("r_kl",e.length,e[0].apiKey);break;case i.AWTEventsRejectedReason.SizeLimitExceeded:t._addStat("r_size",e.length,e[0].apiKey)}t._addStat("r_count",e.length,e[0].apiKey)},eventsRetrying:null}),setTimeout((function(){return t.flush()}),6e4)},e.teardown=function(){this._isInitalized&&(this.flush(),this._isInitalized=!1)},e.eventReceived=function(t){e._addStat("records_received_count",1,t)},e.flush=function(){var e=this;if(this._isInitalized){for(var t in this._stats)this._stats.hasOwnProperty(t)&&this._sendStats(this._stats[t],t);this._stats={},setTimeout((function(){return e.flush()}),6e4)}},e._addStat=function(e,t,n){if(this._isInitalized&&n!==r.StatsApiKey){var a=r.getTenantId(n);this._stats[a]||(this._stats[a]={}),this._stats[a][e]?this._stats[a][e]=this._stats[a][e]+t:this._stats[a][e]=t}},e._isInitalized=!1,e._stats={},e}();t.default=o},Exmh:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");class a extends r.a{constructor(e,t,n){super(),this._target=null,this._processId=null,this._processInstanceId=null,this._target=e,this._processId=t,this._processInstanceId=n}get_name(){return"RetrieveProcessControlData"}get_target(){return this._target}set_target(e){return this._target=e,e}get_processId(){return this._processId}get_processInstanceId(){return this._processInstanceId}}},F1Lu:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("IpQH"),a=n("uM6Y"),i=n("VkXQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class o extends r.a{constructor(e,t){super(e,t,a.g)}openUri(e,t){return this.execute(i.g.openUri.name,e,t)}updateBackBehavior(e){return this.execute(i.g.updateBackBehavior.name,e)}canOpenUri(e){return this.execute(i.g.canOpenUri.name,e)}switchApp(){return new Promise((e,t)=>{this.execute(i.g.switchApp.name),e({status:0,pageId:null})})}navigateBackOutOfApp(){return this.execute(i.g.navigateBackOutOfApp.name)}}},F3eT:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t,n,r){this.PageNumber=e,this.Count=t,this.ReturnTotalRecordCount=n,this.PagingCookie=r}getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{PageNumber:{typeName:"Edm.Int32",structuralProperty:1},Count:{typeName:"Edm.Int32",structuralProperty:1},ReturnTotalRecordCount:{typeName:"Edm.Boolean",structuralProperty:1},PagingCookie:{typeName:"Edm.String",structuralProperty:1}}}}}},F59S:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("4or6"),a=n("OirV"),i=n("WfN+"),o=n("NCQ1"),s=n("Evi3"),c=n("4WQe"),l=n("W8lr"),u=n("J17A"),d=n("I3lY"),p=n("EDmP"),g=n("KEoC"),h=function(){function e(e){this._apiKey=e,this._contextProperties=new i.default,this._semanticContext=new p.default(!1,this._contextProperties),this._sessionStartTime=0,this._createInitId()}return e.prototype.setContext=function(e,t,n){void 0===n&&(n=r.AWTPropertyType.Unspecified),this._contextProperties.setProperty(e,t,n)},e.prototype.setContextWithPii=function(e,t,n,a){void 0===a&&(a=r.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithPii(e,t,n,a)},e.prototype.setContextWithCustomerContent=function(e,t,n,a){void 0===a&&(a=r.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithCustomerContent(e,t,n,a)},e.prototype.getSemanticContext=function(){return this._semanticContext},e.prototype.logEvent=function(t){if(u.default.loggingEnabled){this._apiKey||(this._apiKey=u.default.defaultTenantToken,this._createInitId());var n=!0;o.isString(t)?t={name:t}:t instanceof i.default&&(t=t.getEvent(),n=!1),s.default.eventReceived(this._apiKey),e._logEvent(e._getInternalEvent(t,this._apiKey,n),this._contextProperties)}},e.prototype.logSession=function(t,n){if(u.default.sessionEnabled){var i={name:"session",type:"session",properties:{}};if(e._addPropertiesToEvent(i,n),i.priority=r.AWTEventPriority.High,t===a.AWTSessionState.Started){if(this._sessionStartTime>0)return;this._sessionStartTime=(new Date).getTime(),this._sessionId=o.newGuid(),this.setContext("Session.Id",this._sessionId),i.properties["Session.State"]="Started"}else{if(t!==a.AWTSessionState.Ended)return;if(0===this._sessionStartTime)return;var s=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);i.properties["Session.Id"]=this._sessionId,i.properties["Session.State"]="Ended",i.properties["Session.Duration"]=s.toString(),i.properties["Session.DurationBucket"]=e._getSessionDurationFromTime(s),this._sessionStartTime=0,this.setContext("Session.Id",null),this._sessionId=void 0}i.properties["Session.FirstLaunchTime"]=g.default.firstLaunchTime,this.logEvent(i)}},e.prototype.getSessionId=function(){return this._sessionId},e.prototype.logFailure=function(t,n,a,i,o){if(t&&n){var s={name:"failure",type:"failure",properties:{}};e._addPropertiesToEvent(s,o),s.properties["Failure.Signature"]=t,s.properties["Failure.Detail"]=n,a&&(s.properties["Failure.Category"]=a),i&&(s.properties["Failure.Id"]=i),s.priority=r.AWTEventPriority.High,this.logEvent(s)}},e.prototype.logPageView=function(t,n,r,a,i,o){if(t&&n){var s={name:"pageview",type:"pageview",properties:{}};e._addPropertiesToEvent(s,o),s.properties["PageView.Id"]=t,s.properties["PageView.Name"]=n,r&&(s.properties["PageView.Category"]=r),a&&(s.properties["PageView.Uri"]=a),i&&(s.properties["PageView.ReferrerUri"]=i),this.logEvent(s)}},e.prototype._createInitId=function(){!e._initIdMap[this._apiKey]&&this._apiKey&&(e._initIdMap[this._apiKey]=o.newGuid())},e._addPropertiesToEvent=function(e,t){if(t)for(var n in t instanceof i.default&&(t=t.getEvent()),t.name&&(e.name=t.name),t.priority&&(e.priority=t.priority),t.properties)t.properties.hasOwnProperty(n)&&(e.properties[n]=t.properties[n])},e._getSessionDurationFromTime=function(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"},e._logEvent=function(e,t){e.name&&o.isString(e.name)?(e.name=e.name.toLowerCase(),e.name=e.name.replace(o.EventNameDotRegex,"_"),e.type&&o.isString(e.type)?e.type=e.type.toLowerCase():e.type="custom",o.EventNameAndTypeRegex.test(e.name)&&o.EventNameAndTypeRegex.test(e.type)?((!o.isNumber(e.timestamp)||e.timestamp<0)&&(e.timestamp=(new Date).getTime()),e.properties||(e.properties={}),this._addContextIfAbsent(e,t.getPropertyMap()),this._addContextIfAbsent(e,u.default.logManagerContext.getPropertyMap()),this._setDefaultProperty(e,"EventInfo.InitId",this._getInitId(e.apiKey)),this._setDefaultProperty(e,"EventInfo.Sequence",this._getSequenceId(e.apiKey)),this._setDefaultProperty(e,"EventInfo.SdkVersion",d.FullVersionString),this._setDefaultProperty(e,"EventInfo.Name",e.name),this._setDefaultProperty(e,"EventInfo.Time",new Date(e.timestamp).toISOString()),o.isPriority(e.priority)||(e.priority=r.AWTEventPriority.Normal),this._sendEvent(e)):c.default.eventsRejected([e],r.AWTEventsRejectedReason.InvalidEvent)):c.default.eventsRejected([e],r.AWTEventsRejectedReason.InvalidEvent)},e._addContextIfAbsent=function(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e.properties[n]||(e.properties[n]=t[n]))},e._setDefaultProperty=function(e,t,n){e.properties[t]={value:n,pii:r.AWTPiiKind.NotSet,type:r.AWTPropertyType.String}},e._sendEvent=function(e){l.default.sendEvent(e)},e._getInternalEvent=function(e,t,n){if(e.properties=e.properties||{},n)for(var r in e.properties)e.properties.hasOwnProperty(r)&&(e.properties[r]=o.sanitizeProperty(r,e.properties[r]),null===e.properties[r]&&delete e.properties[r]);var a=e;return a.id=o.newGuid(),a.apiKey=t,a},e._getInitId=function(t){return e._initIdMap[t]},e._getSequenceId=function(t){return void 0===e._sequenceIdMap[t]&&(e._sequenceIdMap[t]=0),(++e._sequenceIdMap[t]).toString()},e._sequenceIdMap={},e._initIdMap={},e}();t.default=h},FETf:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"l",(function(){return c})),n.d(t,"k",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"m",(function(){return p})),n.d(t,"i",(function(){return g})),n.d(t,"q",(function(){return y})),n.d(t,"n",(function(){return b})),n.d(t,"o",(function(){return v})),n.d(t,"p",(function(){return _})),n.d(t,"s",(function(){return S})),n.d(t,"r",(function(){return O})),n.d(t,"u",(function(){return C})),n.d(t,"v",(function(){return E})),n.d(t,"t",(function(){return I})),n.d(t,"g",(function(){return h})),n.d(t,"h",(function(){return f})),n.d(t,"a",(function(){return m}));var r=n("LE5i");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="timelinewall.data.reset",i="timelinewall.data.init",o="timelinewall.data.notify",s="timelinewall.loading.status.set",c="timelinewall.updateRecordLastAccessedTime",l="timelinewall.updateEntityRecentItems",u="timelinewall.metadataRetrievalError",d="timelinewall.stateUpdateNotesAnalysisEnabled",p="timelinewall.setEntityTarget",g="timelinewall.setContextualDialogEntity",h="Notes",f="Posts",m="Activities";function b(e,t){let n=Object.keys(e.queueTypeToRequestMap);t===r.a.Data&&(n=[h,f,m]);const a={requestStatusMap:{},dataQueues:{},recordLastAccessedTime:null,entityRecentItems:{},isMetadataRetrievalError:!1,isNotesAnalysisEnabled:!1,target:null,contextualDialogEntityData:null};let o=r.a.Data;for(let e=0;e<n.length;e++){const t=n[e];a.dataQueues[t]={isError:!1,errorMessage:null,dataResults:null,errorLocalizedMessage:null,errorCode:null},t!==r.a.Filters&&t!==r.a.WhatsChanged&&t!==r.a.MoreEmails||(o=t)}a.requestStatusMap[o]={status:1,requestId:e.requestId},a.requestStatusMap[r.a.InitiateRefresh]={status:2,requestId:e.requestId};const s={timlineWallInitDataState:a,id:e.controlId};return{type:i,payload:s}}function _(e,t,n){return{type:o,payload:{id:t,dataQueues:{[n]:e}}}}function y(e,t){const n={requestStatusMap:{},dataQueues:{},recordLastAccessedTime:null,entityRecentItems:t,isMetadataRetrievalError:!1,isNotesAnalysisEnabled:!1,target:null,contextualDialogEntityData:null};for(const e in r.a)n.requestStatusMap[r.a[e]]={status:0,requestId:null};return{type:a,payload:{timlineWallResetDataState:n,id:e}}}function v(e,t,n,r){const a={};a[t]={status:n,requestId:r};return{type:s,payload:{stateName:t,timlineWallDataState:{requestStatusMap:a,dataQueues:{},recordLastAccessedTime:null,entityRecentItems:{},isMetadataRetrievalError:!1,isNotesAnalysisEnabled:!1,target:null,contextualDialogEntityData:null},id:e}}}function S(e,t){return{type:c,payload:{recordLastAccessedTime:t,id:e}}}function O(e,t){return{type:l,payload:{entityRecentItems:t,id:e}}}function C(e,t){return{type:u,payload:{isMetadataRetrievalError:t,id:e}}}function E(e,t){return{type:p,payload:{target:t,id:e}}}function I(e,t){return{type:g,payload:{contextualDialogEntityData:t,id:e}}}},FJiw:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r={width:"100%",height:"100%",shadowColor:"rgba(0, 0, 0, 0.5)",backgroundColor:"transparent",windowPosition:"center",openInNewWindow:!1,useDefaultDialogChrome:!0,overflow:"hidden"}},FJpk:function(e,t,n){"use strict";function r(e){if(!e)return"";let t=e.split(":");t.length>2&&(t=t.splice(2));const n=t.join(":");let r=n.lastIndexOf("-");r<0&&(r=void 0);const a=n.substring(0,r).trim();return a.length>0?a:e}n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));let a=0,i=0;const o=c(),s=l();function c(){return"tab-id-"+a++}function l(){return"session-id-"+i++}},FKgA:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("504W"),a=n("0Lym");class i{constructor(e,t,n,a,o,s,c,l,u,d,p,g,h,f,m,b,_,y,v,S,O,C,E){this._isFarEastLanguage=!1,this._userCultureName=null,this._formatInfoCultureName=null,this._numberFormatInfo=null,this._dateTimeFormatInfo=null,this._reportScriptErrors=0,this._savedfilters=null,this._defaultSavedFilter=null,this._timeZoneUtcOffsetMinutes=0,this._isGuidedHelpEnabled=!0,this._showCalendarWeeks=!1,this._isHighContrastEnabled=!1,this._defaultSearchExperience=0,this._defaultGridViews=null,this._selectedGlobalFilterId=null,this._isAdmin=!1,this._isCustomizer=!1,this._homepageArea="<Default>",this._homepageSubArea=null,this._isEmailConversationViewEnabled=!1,this._workDayStartTime="",this._autoCaptureUserStatus=0,this._languageId=-1,this._userCultureLcid=-1,this._recordsPerPage=-1,this._timeZoneAdjusters=[],this._languageId=e,this._userCultureLcid=t,this._isFarEastLanguage=!Object(r.a)(i._farEastLanguageLCIDs)&&i._farEastLanguageLCIDs.indexOf(t)>=0,this._userCultureName=Object(r.b)(n)?"":n,this._formatInfoCultureName=Object(r.b)(a)?"":a,this._numberFormatInfo=Object(r.a)(o)?{}:o,this._dateTimeFormatInfo=Object(r.a)(s)?{}:s,this._timeZoneUtcOffsetMinutes=c,this._timeZoneAdjusters=Object(r.a)(l)?new Array(0):l,this._recordsPerPage=u,this._reportScriptErrors=d,this._isGuidedHelpEnabled=p,this._showCalendarWeeks=g,this._isHighContrastEnabled=h,this._defaultSearchExperience=f,this._defaultGridViews=m,this._selectedGlobalFilterId=b,this._isAdmin=_,this._isCustomizer=y,this._homepageArea=v,this._homepageSubArea=S,this._isEmailConversationViewEnabled=O,this._workDayStartTime=C,this._autoCaptureUserStatus=E}get_languageId(){return this._languageId}get_userCultureLcid(){return this._userCultureLcid}get_defaultSearchExperience(){return this._defaultSearchExperience}get_isFarEastLanguage(){return this._isFarEastLanguage}get_userCultureName(){return this._userCultureName}get_formatInfoCultureName(){return this._formatInfoCultureName}get_numberFormatInfo(){return this._numberFormatInfo}get_dateTimeFormatInfo(){return this._dateTimeFormatInfo}get_timeZoneUtcOffsetMinutes(){return this._timeZoneUtcOffsetMinutes}get_timeZoneAdjusters(){return this._timeZoneAdjusters}get_RecordsPerPage(){return this._recordsPerPage}get_reportScriptErrors(){return this._reportScriptErrors}get_savedfilters(){return this._savedfilters}get_defaultSavedFilter(){return this._defaultSavedFilter}get_IsGuidedHelpEnabled(){return this._isGuidedHelpEnabled}get_showCalendarWeeks(){return this._showCalendarWeeks}get_isRTL(){return i._rtlLangList.indexOf(this.get_languageId())>=0}get_isHighContrastEnabled(){return this._isHighContrastEnabled}get_defaultGridViews(){return this._defaultGridViews}get_selectedGlobalFilterId(){return this._selectedGlobalFilterId}get_isAdmin(){return this._isAdmin}get_isCustomizer(){return this._isCustomizer}get_HomepageArea(){return this._homepageArea}get_HomepageSubArea(){return this._homepageSubArea}get_isEmailConversationViewEnabled(){return this._isEmailConversationViewEnabled}get_workDayStartTime(){return this._workDayStartTime}get_AutoCaptureUserStatus(){return this._autoCaptureUserStatus}getObjectData(){const e={};return e.languageid=this._languageId,e.userculturelcid=this._userCultureLcid,e.userCultureName=this._userCultureName,e.formatinfoculturename=this._formatInfoCultureName,e.numberformatinfo=this._numberFormatInfo,e.datetimeformatinfo=this._dateTimeFormatInfo,e.timezoneutcoffsetminutes=this._timeZoneUtcOffsetMinutes,e.defaultsearchexperience=this._defaultSearchExperience,e.timezoneadjusters=this._timeZoneAdjusters.map(e=>e.getObjectData()),e.recordsperpage=this._recordsPerPage,e.reportscripterrors=this._reportScriptErrors,e.isguidedhelpenabled=this._isGuidedHelpEnabled,e.showcalendarweeks=this._showCalendarWeeks,e.ishighcontrastenabled=this._isHighContrastEnabled,e.selectedglobalfilterid=this.get_selectedGlobalFilterId(),e.isadmin=this._isAdmin,e.iscustomizer=this._isCustomizer,e.homepagearea=this._homepageArea,e.homepagesubarea=this._homepageSubArea,e}static createFromObjectData(e){const t=e.languageid,n=e.userculturelcid,r=e.userCultureName,o=e.formatinfoculturename,s=e.numberformatinfo,c=e.datetimeformatinfo,l=e.timezoneutcoffsetminutes,u=e.defaultsearchexperience,d=e.timezoneadjusters.map(e=>a.a.createFromObjectData(e)),p=e.recordsperpage,g=e.reportscripterrors,h=e.isguidedhelpenabled,f=e.ishighcontrastenabled,m=e.showcalendarweeks,b=e.defaultgridviews,_=e.selectedglobalfilterid,y=e.isadmin,v=e.iscustomizer,S=e.homepagearea,O=e.homepagesubarea,C=e.isEmailConversationViewEnabled,E=e.workDayStartTime,I=e.autoCaptureUserStatus;return new i(t,n,r,o,s,c,l,d,p,g,h,m,f,u,b,_,y,v,S,O,C,E,I)}}i._rtlLangList=[1037,1025],i._farEastLanguageLCIDs=[1041,2052,1028]},"FM/+":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){if(t){const n=[];n.push("["+t+"]");return e.execute("eval",n,!0)}return null}function a(e,t){return e.toLowerCase()===t}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},FZDd:function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return O})),n.d(t,"d",(function(){return C})),n.d(t,"f",(function(){return E})),n.d(t,"h",(function(){return I})),n.d(t,"e",(function(){return w})),n.d(t,"g",(function(){return j})),n.d(t,"c",(function(){return P}));var r=n("eXjw"),a=n("8VF0"),i=n("K7RF"),o=n("5KQF"),s=n("g0tL"),c=n("iZ7K"),l=n("LbMF"),u=n("Wgxh"),d=n("pF61"),p=n("ddoO"),g=n("2jAf"),h=n("iJGp"),f=n("/oKV"),m=n("3c7c");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const b=["activityparty"];function _(e,t,n){const r=t&&Object.keys(t).sort(),a=Object(m.a)(JSON.stringify(t,r));return e(Object(i.b)(S,a,null,null,!1,h.a.OnDemandWithoutContext,null,[],[],s.b.Entity,f.a.LocalAndRemote,null,null))}function y(e,t,n,a,i){const o={},s={};for(const t in n){let u;const d=n[t],p=Object(c.h)(e,t);if(v(t)){const n=C(e,t,a,i);n&&(s[t]=n)}p&&p.Initialized!==r.a.Uninitialized&&p.Initialized!==r.a.Partial?(u=Object(l.g)(e,t,d||p.AttributeNames)).length>0&&(o[t]=u&&u.sort().filter((e,t,n)=>n.indexOf(e)===t)):o[t]=d&&d.sort().filter((e,t,n)=>n.indexOf(e)===t)}return Object.keys(s).length>0&&t(Object(g.e)(s,null)),o}function v(e){return-1===b.indexOf(e)}const S="entity",O="entity.retrieve";function C(e,t,n,r,a){if(!e)return null;if(!a&&(a=Object(d.c)(e),r)){const e=n.TraceManager.getTracer("RetrieveEntity"),t="getUpdatedEntityRefCount() called without pageId, action stack is : "+r.stack;e.info(t);const a=[];a.push({name:"errorString",value:t}),n.EventManager.ReportComponentSuccess("RetrieveEntity",a)}if(a&&""!==a){const n=Object(p.g)(e,t),r=n&&n.slice();return Object(u.a)(r,a)}return null}function E(e,t,n){return{type:"entity.retrieve.async",execute({dispatch:r,getState:a},i,o){const s={[e]:t?null:n},c=y(a(),r,s,i,o);if(0===Object.keys(c).length)return Promise.resolve();i.DataSource;return _(r,c)}}}function I(e,t){const n=Object(o.a)(e,s.b.Entity,null,null,null,null,t);return{type:i.a,payload:n}}function w(e){return{type:"entity.retrieve.async",execute({dispatch:t,getState:n},r,a){if(!e||0===Object.keys(e).length)return Promise.resolve();const i=y(n(),t,e,r,a);if(0===Object.keys(i).length)return Promise.resolve();r.DataSource;return _(t,i)}}}function j(e){const t={};e.forEach(e=>{t[e]={Initialized:r.a.Error}});const n={entities:t};return Object(a.b)(n)}function P(e){const t=JSON.parse(e.replace(/\\\"/gi,'"'));return Object.keys(t)}},FZk4:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("504W"),a=n("mKIe");class i{constructor(e,t,n,i,o){this._name=null,this._value=null,this._logicalOperator=0,this._condition=0,this._parenthesisType=0,this.set_name(e),this.set_value(t),this.set_logicalOperator(n),this.set_condition(i),this.set_parenthesisType(Object(r.a)(o)?a.a.none:o)}get_name(){return this._name}set_name(e){return this._name=e,e}get_value(){return this._value}set_value(e){return this._value=e,e}get_logicalOperator(){return this._logicalOperator}set_logicalOperator(e){return this._logicalOperator=e,e}get_condition(){return this._condition}set_condition(e){return this._condition=e,e}get_parenthesisType(){return this._parenthesisType}set_parenthesisType(e){return this._parenthesisType=e,e}}},FdB0:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the Dialog page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Dialog"},FdKt:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return m}));var r=n("zmaG"),a=n.n(r),i=n("iDqy"),o=n.n(i),s=n("s5g6"),c=n("pEXn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l=[];let u=-1,d=-1,p=!0;function g(e){try{e&&e()}catch(e){setTimeout(()=>{throw e},0)}}function h(){if(y(),l.length>0){a.a.addCommonKpiParameters({[c.b.PageLoadParameters.IdleTasks]:"true"}),a.a.tagWorkBlock("Idle tasks");const e=o.a.trackWork("executeIdleTasks");for(;l.length>0;){const e=l.shift();e&&g(e.callback)}e()}}function f(e,t){l.push({callback:e,diagnosticId:t}),p&&-1===d&&(d=setTimeout(h,2e4)),o.a.isAppIdle()&&b()}function m(){return l}function b(){p&&-1===u&&m()&&(u=setTimeout(h,200))}function _(){clearTimeout(u),u=-1}function y(){_(),clearTimeout(d),d=-1}o.a.subscribeToAppIdle(b),o.a.subscribeToAppWorking(_),Object(s.subscribeToAutomationEvents)((e,t)=>{p=!e,p||y()})},FdXt:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"g",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"h",(function(){return u}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="FormToastNotification_Success_Save_Message",a="Web.NavBar.QC_ViewRecord",i="MenuItem_Label_SaveClose",o="MenuItem_Label_SaveAndNew",s="Button_Label_Cancel",c="Open_More_Flyout",l="FormDesigner.PropertiesTab.Options",u=[i,o,s,"Split_Button",c,"Split_Button_More_Flyout",r,a,l]},Fgw8:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("oT5e");function a(e,t,n){let a;return t&&t.targetBrowsingContext?a=Object(r.a)(e,t.targetBrowsingContext):(a=Object(r.d)(e),n.warn("Navigation options is not provided to MultiSessionHistoryManager GetHistoryLength method, returning history length of active tab")),a}function i(e,t){e.updateDialogs(t)}function o(e,t){if(t.targetBrowsingContext){return!1!==Object(r.a)(e,t.targetBrowsingContext).pushHistoryToBrowser}return!0}},FhVi:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("nuS9"),a=n("QBtP");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i extends r.Component{_getAccessibilityManager(){const e=this.context;if(e){return e.AccessibilityManager}return null}render(){return null}componentDidMount(){const e=this._getAccessibilityManager();e&&e.createAccessibilityContext(this)}componentDidUpdate(){const e=this._getAccessibilityManager();e&&e.updateAccessibilityContext(this)}componentWillUnmount(){const e=this._getAccessibilityManager();e&&e.popAccessibilityContext(this)}}i.displayName="AccessibilityComponent",i.contextType=a.a},FkJY:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("nA3O"),a=n("8uvO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i extends r.a{get_version(){return this.getValue(i.versionProperty)}set_version(e){return this.setValue(i.versionProperty,e),e}}i.versionProperty=new a.a("Version",String,i,"")},Fn5S:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return e&&e.metadata&&e.metadata.taskBasedFlowGlobalMenu&&e.metadata.taskBasedFlowGlobalMenu.initialized?e.metadata.taskBasedFlowGlobalMenu:null}function i(e){const t=a(e);return t?t.initialized:r.a.Uninitialized}function o(e){return e.metadata.taskBasedFlowGlobalMenu.display||!1}},FoFY:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("zsAz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return e.sessions}function i(e){const t=a(e);return Object.keys(t).length}function o(e,t){const n=e.sessions[t];if(!n)throw Object(r.d)("Session does not exist",2415919108,[{name:"SessionId",value:t}]);return n}function s(e,t){const n=a(e);for(const r in n){const n=o(e,r);if(n.tabs.indexOf(t)>=0)return n}return null}},G0by:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.setNetworkRequestTrackingFilter=t.addNetworkResponseListener=t.addNetworkRequestListener=t.getNetworkRequestsForVerification=t.shouldUseNetworkRequest=t.getNetworkRequestTypeFilter=t.setNetworkRequestTypeFilter=t.patchNetworkRequestsOnWindow=t.patchNetworkRequests=t.resetNetworkRequests=t.getNetworkRequests=t.setStopwatchHeadersGetter=t.setAdditionalHeadersGetter=t.SYNC_XHR_MESSAGE=void 0;var a=r(n("iDqy")),i=n("STW0"),o=n("Lhhr"),s=r(n("zmaG")),c=n("rdtZ");t.SYNC_XHR_MESSAGE="Synchronous XHR sent";var l,u,d,p,g="function"==typeof window.fetch&&window.fetch,h=[],f=[],m=[];function b(e){return p&&p(e)||[]}function _(e){return e&&(!u||u(e))&&e.indexOf(window.UCIPerformanceDataCollectionUrl)<0}function y(e,n){!function(e,n){e.XMLHttpRequest&&function(e){var r=e.setRequestHeader;e.setRequestHeader=function(e){this._headers||(this._headers=[]),this._headers.push(e),r.apply(this,arguments)};var o=e.open;e.open=function(e,r,a){if(this._method=e,this._async=a||arguments.length<=2,!this._async){var c={type:i.PerformanceIssueType.SyncXHR,level:i.PerformanceIssueLevel.Warning,message:t.SYNC_XHR_MESSAGE,parameters:[r,n]};s.default.logPerformanceIssue(c)}this._url=r,o.apply(this,arguments)};var c=e.send;e.send=function(){var e=this;if(d){var t=d(this._url);for(var i in t)(!this._headers||this._headers.indexOf(i)<0)&&r.apply(this,[i,t[i]])}var o=!this._async&&a.default.trackWork("XHR"),s={url:this._url,fetch:!1,windowId:n,sync:!this._async,method:this._method};["error","abort","timeout","load"].forEach((function(t){e.addEventListener(t,(function(){null!==e.statusText&&void 0!==e.statusText&&(s.h2=""===e.statusText),e.responseURL&&(s.url=e.responseURL),b(e._url).forEach((function(t){s[t.parameterName]=e.getResponseHeader(t.headerName)})),s.patchDuration=performance.now()-s.patchStartTime,s.status=e.status,S(s),o&&o()}))})),s.patchStartTime=performance.now(),m.push(s),v(s),c.apply(this,arguments)}}(e.XMLHttpRequest.prototype)}(e,n),g&&(e.fetch=function(e,t){!function(e,t){if(d){var n=d(e instanceof Request?e.url:e);"string"!=typeof e&&e.headers||(t||(t={}),t.headers||(t.headers=new Headers));var r=function(r){e instanceof Request&&e.headers?e.headers.has(r)||e.headers.set(r,n[r]):t.headers instanceof Headers?t.headers.has(r)||t.headers.set(r,n[r]):t.headers instanceof Array?t.headers.some((function(e){return e[0]===r}))||t.headers.push([r,n[r]]):t.headers[r]||(t.headers[r]=n[r])};for(var a in n)r(a)}}(e,t);var r="string"==typeof e?e:e.url,a={url:r,patchStartTime:Math.round(performance.now()),fetch:!0,windowId:n,sync:!1,method:e instanceof Request?e.method:"GET"};m.push(a),v(a);var i=g(e,t);return i.then((function(e){return null!==e.statusText&&void 0!==e.statusText&&(a.h2=""===e.statusText),b(r).forEach((function(t){a[t.parameterName]=e.headers.get(t.headerName)})),a.status=e.status,S(a),e.clone().arrayBuffer()})).then((function(){a.patchDuration=Math.round(performance.now()-a.patchStartTime)})),i})}function v(e){h.forEach((function(t){try{t(e)}catch(e){setTimeout((function(){throw e}),0)}}))}function S(e){f.forEach((function(t){try{t(e)}catch(e){setTimeout((function(){throw e}),0)}}))}t.setAdditionalHeadersGetter=function(e){d=e},t.setStopwatchHeadersGetter=function(e){p=e},t.setNetworkRequestTypeFilter=function(e){l=e},t.getNetworkRequestTypeFilter=function(){return l},t.setNetworkRequestTrackingFilter=function(e){u=e},t.shouldUseNetworkRequest=_,t.getNetworkRequestsForVerification=function(e){return e.reduce((function(e,t){return _(t.parameters&&t.parameters[c.RESOURCE_NAME])&&e.push(t),e}),[])},t.getNetworkRequests=function(){return m},t.resetNetworkRequests=function(){m=[]},t.patchNetworkRequests=function(){y(window,"MainWindow"),o.forEachAdditionalWindow((function(e){y(e.contentWindow,e.id)}))},t.patchNetworkRequestsOnWindow=y,t.addNetworkRequestListener=function(e){return h.push(e),function(){h.splice(h.indexOf(e),1)}},t.addNetworkResponseListener=function(e){return f.push(e),function(){f.splice(f.indexOf(e),1)}}},G4xW:function(e,t,n){"use strict";function r(e){return{type:"preload.tag",execute:({dispatch:t},n,r)=>(Object.assign(r,{isPreloadCall:!0}),t(e))}}n.d(t,"a",(function(){return r}))},GD3x:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t){this._continueOnError=!1,this._returnResponses=!1,this._continueOnError=e,this._returnResponses=t}get_continueOnError(){return this._continueOnError}get_returnResponses(){return this._returnResponses}}},GEbX:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.SingleSession=0]="SingleSession",e[e.MultiSession=1]="MultiSession"}(r||(r={}))},GHWt:function(e,t,n){"use strict";var r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.setUCIPerformanceDataCollectionURL=t.getUCIPerformanceDataCollectionURL=t.getPerformanceAutomationConfig=void 0,t.getPerformanceAutomationConfig=function(){var e=window.PerformanceAutomationConfig;return null!=e&&a!==e&&(a=e,r=e),null==r&&(r={scenarioConfigs:[]}),r},t.getUCIPerformanceDataCollectionURL=function(){return window.UCIPerformanceDataCollectionUrl},t.setUCIPerformanceDataCollectionURL=function(e){window.UCIPerformanceDataCollectionUrl=e}},GL3b:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return e&&e.offline&&e.offline.server&&e.offline.server.profileId?e.offline.server.profileId:r.a.EMPTY}function i(e){return e&&e.offline&&e.offline.server&&e.offline.server.profileVersion?e.offline.server.profileVersion:""}function o(e){return e&&e.offline&&e.offline.server&&e.offline.server.profileAvailableEntities?e.offline.server.profileAvailableEntities:null}function s(e){return!!(e&&e.offline&&e.offline.server&&e.offline.server.profileAvailableEntities)&&e.offline.server.profileAvailableEntities.length>1}function c(e){return!!(e&&e.offline&&e.offline.client&&e.offline.client.isProfileChanged)&&e.offline.client.isProfileChanged}},GP49:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o}));var r=n("RymD");function a(e){const t=i(e);return void 0!==t&&t>=r.d}function i(e){return e.appShellState&&e.appShellState.backNavTooltipState&&e.appShellState.backNavTooltipState.tooltipDismissCount}function o(e){return e.appShellState&&e.appShellState.backNavTooltipState&&!e.appShellState.backNavTooltipState.hideLongPressTooltip}},GPkz:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t){this._timestamp=new Date}get timeStamp(){return this._timestamp}}var a=n("qu3G");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class i{constructor(){this._terminalEvents=[a.a.pinItem,a.a.unPinItemFromPinned,a.a.unPinItemFromRecent,a.a.switchArea,a.a.navigateToHome,a.a.navigateToPinnedItem,a.a.navigateToRecentItem,a.a.navigateToSubArea],this._usage=[],this._timeCreated=new Date,this._numberOfNonTerminalEventBefore=0,this._numberOfNonTerminalEvent=0,this._numberOfTerminalEvent=0,this._terminalEventCount=0,this._isTerminalEventFired=!1}addEvent(e,t=-1){this._usage.push(new r(e,t)),this._isTerminalEvent(e)?(this._isTerminalEventFired||(this._isTerminalEventFired=!0,this._timeforFirstTerminalEvent=this.Usage[this.length-1].timeStamp.getTime()-this._timeCreated.getTime()),this._wasLastEventTerminalEvent&&this._terminalEventCount++,this._wasLastEventTerminalEvent=!0,this._numberOfTerminalEvent++):(this._isTerminalEventFired||(this._numberOfNonTerminalEventBefore=this._numberOfNonTerminalEventBefore+1),this._wasLastEventTerminalEvent=!1,this._numberOfNonTerminalEvent++)}get Usage(){return this._usage}get numberOfNonTerminalEventBefore(){return this._isTerminalEventFired?this._numberOfNonTerminalEventBefore:0}get numberOfBackToBackTerminalEvent(){return this._terminalEventCount}get timeForFirstTerminalEvent(){return this._timeforFirstTerminalEvent}get numberOfTerminalEvent(){return this._numberOfTerminalEvent}get numberOfNonTerminalEvent(){return this._numberOfNonTerminalEvent}get length(){return this._usage?this._usage.length:0}_isTerminalEvent(e){return this._terminalEvents.indexOf(e)>-1}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class o{constructor(e,t){this._blankSessionCount=0,this._applicationContext=e,this._isTelemetryEnabled=t}static get session(){return this._session}static initialize(e,t){this._instance||(this._instance=new o(e,t))}static _getInstance(){return this._instance}static flyOutEnter(){this._enteredFlyOut=!0}static exitFlyOut(){this._enteredFlyOut=!1}static SessionStart(){o._getInstance()._isTelemetryEnabled&&(this.session&&this._enteredFlyOut&&this._getInstance()._reportTelemetry(),this._session=new i)}static SessionEnd(){o._getInstance()._isTelemetryEnabled&&(this._enteredFlyOut||this._getInstance()._reportTelemetry())}_reportTelemetry(){if(o.session&&o.session.length){const e=[];this._blankSessionCount>0&&(o.session.addEvent(a.a.blankSession,this._blankSessionCount),this._blankSessionCount=0),e.push({name:"timeForFirstTerminal",value:o.session.timeForFirstTerminalEvent}),e.push({name:"backToBackTerminal",value:o.session.numberOfBackToBackTerminalEvent}),e.push({name:"nonTerminalBefore",value:o.session.numberOfNonTerminalEventBefore}),e.push({name:"totalTerminalEvent",value:o.session.numberOfTerminalEvent}),e.push({name:"totalNonTerminalEvent",value:o.session.numberOfNonTerminalEvent}),e.push({name:"SiteMapUsage",value:JSON.stringify(o.session.Usage)}),this._applicationContext.EventManager.ReportComponentSuccess("SiteMap.UsageMonitor",e)}else this._blankSessionCount=this._blankSessionCount+1;o._session=null}}},GT4X:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return l}));var r=n("P86a"),a=n("UIlN");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t){return c(e,t,[r.a.CompletedInitialRuleEvaluation])}function o(e,t){return c(e,t,[r.a.Initializing])}function s(e,t){return c(e,t,[r.a.CompletedInitialRuleEvaluation,r.a.SkippedRuleEvaluation])}function c(e,t,n){const r=Object(a.b)(e,t);return r&&-1!==n.indexOf(r.initializationState)}function l(e,t){let n=null;const r=Object(a.b)(e,t);return r&&r.controlsMap&&(n=r.controlsMap),n}},GWSs:function(e,t,n){"use strict";n.d(t,"k",(function(){return _})),n.d(t,"i",(function(){return y})),n.d(t,"l",(function(){return S})),n.d(t,"j",(function(){return v})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return h})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b})),n.d(t,"m",(function(){return O})),n.d(t,"h",(function(){return C})),n.d(t,"f",(function(){return E})),n.d(t,"g",(function(){return I}));var r=n("eXjw"),a=n("7HpW"),i=n("Wbnz"),o=n("n/MI"),s=n("Xi8U"),c=n("YxC/"),l=n("2FbK"),u=n("Lyxw"),d=n("3/02"),p=n("d6Hx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const g="SITEMAP_RECENT_PIN",h="SITEMAP_RECENT_UNPIN",f="SITEMAP_SUBACTION_NOTIFIER",m="SITEMAP_GROUP_FAVORITES",b="SITEMAP_GROUP_RECENTLY_USED";function _(e){return e&&e.metadata&&e.metadata.siteMap&&e.metadata.siteMap.initialized?e.metadata.siteMap:null}function y(e){const t=_(e);return t?t.initialized:r.a.Uninitialized}function v(e){const t=_(e);return t?t.OverallVersionNumber:null}function S(e,t){return t===p.d?function(e){const t=Object(s.g)(e),n=Object(s.k)(e),r=t.map(t=>o.e.FromStateItem(t,!0,e)),a=n.map(t=>o.e.FromStateItem(t,!0,e)),i=[],l=Object(c.e)(e,[g,h,f,m,b]),u=Object(c.c)(l,f),d=Object(c.c)(l,g),p=Object(c.c)(l,h),_=Object(c.c)(l,m),y=Object(c.c)(l,b);r.length&&i.push({title:_,entries:r,narratorTitle:String.format(u,p)});a.length&&i.push({title:y,entries:a,narratorTitle:String.format(u,d)});return i.length?i:null}(e):function(e,t){const n=Object(l.b)(e);if(!n)return[];const r=n.Areas[t],o=Object(a.c)(r),s=[];for(let t=0;t<o.length;t++){const n=Object(a.b)(o[t]);s[t]={title:o[t].Titles[0].Title,entries:[]};for(let r=0;r<n.length;r++){const a=i.c.FromStateItem(n[r],e);s[t].entries.push(a)}}return s}(e,t)}function O(e,t){const n=_(e),r=[];if(!n)return[];for(const e of n.AreaIds){const a=n.Areas[e],i=a.VectorIcon;i?r.push({type:"Area",id:a.Id,iconPath:i}):t.warn("Area "+a.Id+" doesn't have a vector icon.");for(const e of a.GroupIds){const n=a.Groups[e];for(const e of n.SubAreaIds){const i=n.SubAreas[e],o=i.VectorIcon;o?r.push({type:"Subarea",id:i.Id,iconPath:o}):t.warn("SubArea "+i.Id+" in Area "+a.Id+" doesn't have a vector icon.")}}}return r}function C(e){return Object(u.c)(e,d.Kc)}function E(e){return Object(u.c)(e,d.Mc)}function I(e){return Object(u.c)(e,d.Nc)}},GYDS:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s}));var r=n("mpSO"),a=n("UIlN");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t){return t||e}function o(e,t){const n=Object(a.c)(e);if(!n)return null;const r=[];for(const i in n){Object(a.b)(e,i).pageId===t&&r.push(i)}return r}function s(e,t=!1){return e&&(t?-1!==e.indexOf(r.d):e===r.d)}},GYEz:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return p})),n.d(t,"d",(function(){return g})),n.d(t,"f",(function(){return h})),n.d(t,"i",(function(){return m})),n.d(t,"j",(function(){return _})),n.d(t,"b",(function(){return d})),n.d(t,"k",(function(){return b})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return u}));var r=n("w1eR"),a=n("eOoD"),i=n("UwOy"),o=n("ZePi"),s=n("OEF1");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e){return e&&e.clientHost?e.clientHost.type:null}function l(e){return e&&e.clientHost?e.clientHost.installationId:null}function u(e){return e&&e.clientHost?e.clientHost.deviceTelemetryParams:null}function d(e){return e&&e.clientHost?e.clientHost.deviceModel:null}function p(e){return e&&e.clientHost?e.clientHost.subtype:null}function g(e){return Object(i.c)(c(e))}function h(e){switch(p(e)){case a.a.Phone:return"Phone";case a.a.Tablet:return"Tablet"}return""}function f(e){const t=Object(s.d)(e);return t||h(e)}function m(e){return e&&e.clientHost?e.clientHost.version:null}function b(e){if(window.IsUSD)return o.a.unifiedServiceDesk;switch(c(e)){case r.a.MobileApplication:return o.a.mobile;default:return o.a.web}}function _(e){const t=m(e);return t&&t.version?t.version+"."+t.build+" ("+t.revision+","+t.nativeRevision+")":""}},GdzE:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("Uv1Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,n,a=!1){return{type:"session.state.save.async",execute:({dispatch:i,getState:o},s)=>function(e,t,n,a,i=!1){return e.saveSessionState(t,n,a,i).nativePromise().catch(r.b)}(s.DataSource,e,t,n,a).then(e=>e)}}},Gilj:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t,n,r,a,o,s,c=!1){this._keyCombination=e,this._shortcutHandler=t,this._isGlobal=n,this._shortcutType=s,this._shortcutType||(this._shortcutType=i.KeyDown),this._srcElementId=o,this._shortcutDescription=a,this._areaName=r}getKeyCombination(){return this._keyCombination}getShortcutHandler(){return this._shortcutHandler}getIsGlobal(){return this._isGlobal}getIsHidden(){return!1}getAreaName(){return this._areaName}getKeyboardShortcutType(){return this._shortcutType}getSrcElementId(){return this._srcElementId}getShortcutDescription(){return this._shortcutDescription}}class a{}var i;!function(e){e[e.KeyUp=0]="KeyUp",e[e.KeyDown=1]="KeyDown"}(i||(i={}))},GvUM:function(e,t,n){"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,"a",(function(){return r}))},"H/hG":function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r,a=n("CGM5"),i=n("eb03"),o=n("f4Xx"),s=n("M6Hl"),c=n("HMYz"),l=n("iDZS"),u=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function d(e){switch(e){case"normal":return"normal";case"bold":return"bold";default:return Number(e)}}var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.getElementName=function(){return this.props.semanticTag||"span"},t.prototype.getElementClassName=function(){var e=this.props.styles?this.props.styles:"";return this.props.className?e+" "+this.props.className:e},t.prototype.getElementProps=function(){var e={};switch(this.props.role){case o.a:e[i.p]=this.props.notificationType||s.a}return e},t.displayName="Text",t}(a.a);function g(e){return e&&e.style?e.style.fontWeight?Object.assign({},{fontWeight:"string"==typeof e.style.fontWeight?d(e.style.fontWeight):e.style.fontWeight},Object(l.b)(e)):Object.assign(e.style,Object(l.b)(e)):{}}var h=c.connect((function(e){return function(t){return t.renderRule(g,e)}}))(p)},H4dV:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("504W"),a=n("a475");class i{constructor(){this._palEnabled=!1,this._isBrowserIE=!1,this._isBrowserEdge=!1,this._isBrowserFirefox=!1,this._isBrowserChrome=!1,this._isBrowserSafari=!1,this._isIPhone=!1,this._isIPad=!1,this._isIPod=!1,this._isOutlookIos=!1,this._isAndroid=!1,this._isAndroidModern=!1,this._isAndroidJellyBean=!1,this._isAndroidPhone=!1,this._isMac=!1,this._isWin=!1,this._isWinDesktop=!1,this._isWinPhone=!1,this._rawValue=null,this._customControlUserAgent=null,this._isMailApp=!1,this._rawValue=window.navigator.userAgent,-1!==document.cookie.indexOf("PALEnabled")?this._palEnabled=!0:this._palEnabled=!1,this._isMailApp=-1!==window.location.search.indexOf("clienthost=3"),this.get_isMailApp()&&window.self!==window.parent&&(this._palEnabled=!0),this._isBrowserEdge=this._rawValue.toLowerCase().indexOf("edge")>-1&&this._rawValue.toLowerCase().indexOf("windows nt")>-1,this._isBrowserIE=!(-1===this._rawValue.indexOf("MSIE")&&-1===this._rawValue.indexOf("Trident")),this._isBrowserChrome=-1!==this._rawValue.indexOf("Chrome"),this._isBrowserFirefox=-1!==this._rawValue.indexOf("Firefox"),-1!==this._rawValue.indexOf("Safari")&&(-1!==this._rawValue.indexOf("Chrome")||-1!==this._rawValue.indexOf("Android")?this._isBrowserSafari=!1:this._isBrowserSafari=!0),this._isIPhone=-1!==this._rawValue.indexOf("iPhone"),this._isIPad=-1!==this._rawValue.indexOf("iPad"),!this._isIPhone||"iPad"!==window.navigator.platform||-1===this._rawValue.indexOf("9_1")&&-1===this._rawValue.indexOf("9_2")||(this._isIPhone=!1,this._isIPad=!0),this._isIPod=-1!==this._rawValue.indexOf("iPod"),this._isOutlookIos=-1!==this._rawValue.toLowerCase().indexOf("outlook-ios"),this._isAndroid=-1!==this._rawValue.indexOf("Android")&&-1===window.navigator.appVersion.indexOf("Win"),this._isAndroid&&(this._isAndroidModern=this._CheckIsModernAndroid(),this._isAndroidJellyBean=this._CheckIsAndroidJellyBean()),this._isAndroidPhone=this._isAndroid&&-1!==this._rawValue.indexOf("Mobile"),this._isMac=-1!==window.navigator.appVersion.indexOf("Mac"),this._isWin=-1!==window.navigator.appVersion.indexOf("Win")||-1!==window.navigator.appVersion.indexOf("NT"),this._isWinDesktop=this._isWin&&-1!==window.navigator.appVersion.indexOf("NT"),this._isWinPhone=this._isWin&&-1!==window.navigator.appVersion.indexOf("Phone"),this._customControlUserAgent=this._GetCustomControlUserAgent()}get_CustomControlUserAgent(){return this._customControlUserAgent}_GetCustomControlUserAgent(){return{isWin:this._isWin,isAndroid:this._isAndroid,isAndroidModern:this._isAndroidModern,isIos:this.get_IsIOS()||this._isOutlookIos,isBrowserIE:this._isBrowserIE,isBrowserChrome:this._isBrowserChrome,isBrowserFirefox:this._isBrowserFirefox,isBrowserSafari:this._isBrowserSafari}}getOSString(){if(this._isWin){const e=this._rawValue.indexOf(i._windows);if(-1!==e){const t=this._rawValue.substring(e+i._windows.length,this._rawValue.length),n=t.indexOf(";");if(-1!==n)return i._windows+t.substring(0,n)}}else if(this.get_IsIOS()){const e=new RegExp("OS (\\d+)_(\\d+)_?(\\d+)?"),t=this._rawValue.match(e);if(t.length>1)return i._IOS+t[0]}else if(this.get_IsAndroid()){const e=this._rawValue.indexOf(i._android);if(-1!==e)return i._android+this._rawValue.substring(e+i._android.length,e+i._android.length+i._AndroidVersionLength)}return""}get_PALEnabled(){return this._palEnabled||a.a.get_Instance().get_application().get_IsAvailable()}get_WebSqlDatabaseEnabled(){return void 0!==window.openDatabase}get_indexedDbFactory(){const e=window.self.indexedDB;return Object(r.a)(e)||Object(r.a)(e.deleteDatabase)?null:e}get_supportsNativeSqlBridge(){return a.a.get_Instance().get_sql().get_IsAvailable()}get_IsBrowser(){return this.get_IsBrowserEdge()||this.get_IsBrowserChrome()||this._isBrowserFirefox||this._isBrowserIE||this.get_isBrowserSafari()}get_IsBrowserIE(){return this._isBrowserIE}get_IsBrowserEdge(){return this._isBrowserEdge}get_IsBrowserFirefox(){return this._isBrowserFirefox}get_IsBrowserChrome(){return this._isBrowserChrome}get_isBrowserSafari(){return this._isBrowserSafari}get_isIPhone(){return this._isIPhone}get_isIPad(){return this._isIPad}get_IsIOS(){return this.get_isIPhone()||this.get_isIPad()||this._isIPod}get_IsAndroid(){return this._isAndroid}get_IsAndroidJellyBean(){return this._isAndroidJellyBean}get_IsAndroidPhone(){return this._isAndroidPhone}get_isWinPhone(){return this._isWinPhone}get_IsMobilePhone(){return this._isWinPhone||this.get_isIPhone()||this.get_IsAndroidPhone()}get_isMailApp(){return this._isMailApp}get_IsMacSafari(){return this.get_isBrowserSafari()&&this._isMac}get_IsMacSafariNotSupportAnchorDownload(){if(this.get_IsMacSafari()){const e=this._rawValue.indexOf(i._version);if(-1!==e){const t=this._rawValue.substring(e+i._version.length+1,e+i._version.length+i._SafariVersionLength);return parseFloat(t)<10.1}}return!1}get_IsWindows(){return this._isWin}get_IsWinDesktop(){return this._isWinDesktop}_CheckIsModernAndroid(){const e=this._rawValue.indexOf(i._android);if(-1!==e){const t=this._rawValue.substring(e+i._android.length+1,e+i._android.length+i._AndroidVersionLength);return parseFloat(t)>=4.4}return!1}_CheckIsAndroidJellyBean(){const e=this._rawValue.indexOf(i._android);if(-1!==e){return"4.3"===this._rawValue.substring(e+i._android.length+1,e+i._android.length+i._AndroidVersionLength)}return!1}static getInstance(){return i._instance||(i._instance=new i),i._instance}}i._android="Android",i._windows="Windows",i._IOS="iOS",i._version="Version",i._AndroidVersionLength=4,i._SafariVersionLength=5,i._instance=null},HYaY:function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var r=n("tHaS"),a=n("wMH2"),i=n("84PK");function o(e,t){return!e&&!t||!(!e&&t||e&&!t)&&(e instanceof i.a&&t instanceof i.a||e.equals&&t.equals?e.equals(t):e.get_ValueString&&e.get_Label&&t.get_ValueString&&t.get_Label?e.get_ValueString()===t.get_ValueString()&&e.get_Label()===t.get_Label():e.get_value&&t.get_value?o(e.get_value(),t.get_value()):(e instanceof Date&&t instanceof Date&&(e=e.valueOf(),t=t.valueOf()),e===t))}var s=n("504W"),c=n("NMtn"),l=n("2F73"),u=n("XvL5"),d=n("rO1J"),p=n("d+dp"),g=n("WRF3"),h=n("IvgJ"),f=n("sdkC"),m=n("nTyX"),b=n("P68g"),_=n("odYE"),y=n("5Oca"),v=n("5qiD"),S=n("/oKV"),O=n("LbMF"),C=n("WePp"),E=n("64CY");class I{constructor(e,t,n,r,a,i,o,l){this._identifier=null,this._actionableIdentifier=null,this._fields=null,this._formattedValues=null,this._numericFormattedValues=null,this._relatedEntities=null,this._changedFieldNames=null,this._cleanFields=null,this._fieldTypes=null,this._columnSet=null,this._clientRetrieveOptions=null,this._accessRights=0,this._userSharedAttributePrivileges=null,this._entityRecordForProcess=null,this._globalNavigationData=null,e instanceof I?(t=e._fields,n=e._fieldTypes,r=e._formattedValues,a=e._numericFormattedValues,i=e._relatedEntities,l=e._clientRetrieveOptions,this._identifier=e._identifier):this._identifier=e,Object(c.d)(this._identifier,"identifier"),Object(c.d)(t,"fields"),Object(c.d)(n,"fieldTypes"),Object(c.d)(r,"formattedValues"),Object(c.d)(a,"numericFormattedValues"),Object(c.d)(i,"relatedEntities"),this._fields=t,this._fieldTypes=n,this._formattedValues=r,this._numericFormattedValues=a,this._relatedEntities=i,this._columnSet=Object(s.a)(o)?new u.a(new Array(0)):o,this.updateColumnSet(this.get_fieldNames()),this._changedFieldNames=[],this._cleanFields={},this._clientRetrieveOptions=l,this._accessRights=0;const d=this.getValue("activitytypecode");"activitypointer"===this._identifier.LogicalName&&d?this._actionableIdentifier=new g.a(d,this._identifier.Id):this._actionableIdentifier=this._identifier,this._userSharedAttributePrivileges={}}get fields(){return this._fields}get_identifier(){return this._identifier}get_actionableIdentifier(){return this._actionableIdentifier}get_fieldTypes(){return this._fieldTypes}get_formattedValues(){return this._formattedValues}get_numericFormattedValues(){return this._numericFormattedValues}get_relatedEntities(){return this._relatedEntities}get_fieldNames(){const e=[],t=this._fields;for(const n in t){const r={key:n,value:t[n]};e.push(r.key)}return e}get_changedFieldNames(){return this._changedFieldNames}get_columnSet(){return this._columnSet}get_key(){return this.get_identifier().get_key()}get_clientRetrieveOptions(){return this._clientRetrieveOptions}set_clientRetrieveOptions(e){this._clientRetrieveOptions=e;for(const t of this._relatedEntities.get_entityCollections())t.get_value().set_clientRetrieveOptions(e)}get_accessRights(){return this._accessRights}set_accessRights(e){this._accessRights=e}get_userSharedAttributePrivileges(){return this._userSharedAttributePrivileges}set_userSharedAttributePrivileges(e){this._userSharedAttributePrivileges=e}get_entityRecordForProcess(){return this._entityRecordForProcess}set_entityRecordForProcess(e){return this._entityRecordForProcess=e,e}get_globalNavigationData(){return this._globalNavigationData}set_globalNavigationData(e){this._globalNavigationData=e}isDirty(){return this.get_changedFieldNames().length>0}clone(){const e=this.getObjectData(),t=e.columnset;Object(s.a)(t)||(t.columns=t.columns.slice());const n=e.formattedfields,r={};for(const e in n){const t={key:e,value:n[e]};r[t.key]=t.value}const a=e.numericformattedfields,i={};for(const e in a){const t={key:e,value:a[e]};i[t.key]=t.value}return e.formattedfields=r,e.numericformattedfields=i,I.createFromObjectData(e)}getObjectData(){const e=this._columnSet instanceof l.a;return{identifier:this._identifier.getObjectData(),fields:this._GetFieldsObjectData(),fieldtypes:Object(m.d)(this._fieldTypes),formattedfields:this._formattedValues,numericformattedfields:this._numericFormattedValues,allcolumns:e,columnset:e?void 0:this._columnSet.getObjectData(),clientretrieveoptions:Object(s.a)(this._clientRetrieveOptions)?void 0:this._clientRetrieveOptions.getObjectData(),accessrights:this._accessRights,sharedattributeprivileges:Object(b.a)(this._userSharedAttributePrivileges,e=>e.getObjectData()),entityrecordforprocess:Object(s.a)(this.get_entityRecordForProcess())?void 0:this.get_entityRecordForProcess().getObjectData(),globalnavigationdata:Object(s.a)(this.get_globalNavigationData())?void 0:this.get_globalNavigationData().getObjectData()}}_GetFieldsObjectData(){return Object.keys(this._fields).reduce((e,t)=>(e[t]=this.getFieldObjectData(t),e),{})}getFieldObjectData(e){return I.InternalGetFieldObjectData(this.getValue(e),this._fieldTypes[e])}getFields(){return this._GetFieldsObjectData()}hasValue(e){return e in this._fields}hasField(e){return e in this._fieldTypes}getValue(e){return this._fields[e]}getFormattedValue(e){return Object(s.a)(this.get_formattedValues()[e])?"aliasedvalue"===this.get_fieldTypes()[e]?this.getValue(e).get_value():this.getValue(e):this.get_formattedValues()[e]}getNumericFormattedValue(e){return this._numericFormattedValues[e]||this.getFormattedValue(e)}setValue(e,t){if(!(e in this.get_fieldTypes()))throw Error.argumentOutOfRange(e);t&&t.get_Label&&t.get_ValueString?this._fields[e]=h.a.createFromPicklistItem(t):this._fields[e]=t,this.updateColumnSet([e])}markFieldChanged(e){if(this.get_changedFieldNames().indexOf(e)<0&&(this._cleanFields[e]=this._fields[e],this.get_changedFieldNames().push(e),this._fields[e]instanceof a.a))for(const t of this._fields[e].get_entities())t._MarkAllFieldsChanged()}_MarkAllFieldsChanged(){for(const e of this.get_fieldNames())this.markFieldChanged(e)}resetChanges(){this._changedFieldNames=[],this._cleanFields={}}mergeChanges(e){Object(s.a)(this._clientRetrieveOptions)?this._clientRetrieveOptions=e._clientRetrieveOptions:this._clientRetrieveOptions.update(e._clientRetrieveOptions),this.set_accessRights(e.get_accessRights()),this.mergeEntityRecordFields(e),this._entityRecordForProcess=e._entityRecordForProcess,this._globalNavigationData=e._globalNavigationData}mergeEntityRecordFields(e){const t=e._fields;for(const e in t){const n={key:e,value:t[e]};n.key in this._fields&&o(this._fields[n.key],n.value)||(this._fields[n.key]=n.value)}const n=e._fieldTypes;for(const t in n){const r={key:t,value:n[t]}.key;r in this._fieldTypes||(this._fieldTypes[r]=e._fieldTypes[r]),r in this._fields&&!(r in e._fields)&&(delete this._fields[r],delete this._formattedValues[r],delete this._numericFormattedValues[r])}const r=e._formattedValues;for(const e in r){const t={key:e,value:r[e]};t.key in this._formattedValues&&o(this._formattedValues[t.key],t.value)||(this._formattedValues[t.key]=t.value)}e.get_columnSet()instanceof l.a?this.updateColumnSet(e.get_columnSet()):this.updateColumnSet(this.get_fieldNames())}initializeValue(e,t,n){this._fields[e]=t,e in this._fieldTypes||(this._fieldTypes[e]=n),this.updateColumnSet([e])}updateColumnSet(e,t){if(e=e,!(this.get_columnSet()instanceof l.a)){if(e instanceof l.a)this._columnSet=l.a.get_instance();else{let t;t=e instanceof u.a?e.get_Columns():e;const n=this._columnSet;for(const e of t)n.get_Columns().indexOf(e)<0&&n.get_Columns().push(e)}if(!Object(s.a)(t))for(const e of t){const t=this.get_relatedEntities().getByRelationship(e.get_relationship());for(const n of t.get_entities())n.updateColumnSet(e.get_ColumnSet())}}}static createFromObjectData(e){const t=Object(m.b)(e.fieldtypes),n=e.identifier&&g.a.createFromObjectData(e.identifier),r=I.createFieldsFromObjectData(e.fields,t);let a;a=e.allcolumns?l.a.get_instance():u.a.createFromObjectData(e.columnset);const i=e.clientretrieveoptions?p.a.createFromObjectData(e.clientretrieveoptions):null,o=new I(n,r,t,e.formattedfields,e.numericformattedfields,new f.a(new Array(0)),a,i);o.set_accessRights(e.accessrights);const c=Object(b.a)(e.sharedattributeprivileges,e=>d.a.createFromObjectData(e));o.set_userSharedAttributePrivileges(c);const h=e.entityrecordforprocess;Object(s.a)(h)||o.set_entityRecordForProcess(I.createFromObjectData(h));const _=e.globalnavigationdata;return Object(s.a)(_)||o.set_globalNavigationData(I.createFromObjectData(_)),o}static createSingleFieldFromObjectData(e,t){return I.InternalCreateFieldFromObjectData(e,t)}static createFieldsFromObjectData(e,t){const n={};for(const r in e){const a={key:r,value:e[r]};n[a.key]=I.InternalCreateFieldFromObjectData(a.value,t[a.key])}return n}static InternalCreateFieldFromObjectData(e,t){if(Object(s.a)(e))return null;switch(t){case"aliasedvalue":return r.a.createFromObjectData(e);case"customer":case"lookup":case"owner":return g.a.createFromObjectData(e);case"uniqueidentifier":return i.a.createFromObjectData(e);case"datetime":return new Date(Date.parse(e));case"status":case"state":case"boolean":case"picklist":return h.a.createFromObjectData(e);case"partylist":return a.a.createFromObjectData(e);default:return e}}static InternalGetFieldObjectData(e,t){if(Object(s.a)(e))return null;switch(t){case"aliasedvalue":return e.getObjectData();case"customer":case"lookup":case"owner":case"uniqueidentifier":return e.getObjectData();case"datetime":return e.toString();case"status":case"state":case"boolean":case"picklist":case"partylist":return e.getObjectData();default:return e}}static recordDataToLegacyEntityRecord(e,t,n,r,a,i=y.a.LatestEntered){const o=_.a.toLegacyEntityReference(t),s=new I(o,{},{},{},{},new f.a([]));s.set_clientRetrieveOptions(new p.a(v.a.Medium,S.a.LocalAndRemote));const c=Object(E.d)("fullname");for(const o in n){let n=Object(O.a)(e,t.etn,o);if(!n){const e=new C.a("uci_info"),n="Attribute "+o+" for entity "+t.etn+" could not be found.";e.addEventParameter("Message",n),a.warn("EntityRecord "+n);continue}const l=Object(y.y)(e,r,t,o,i);s.initializeValue(o,l,n.Type),s.markFieldChanged(o);const u=c.indexOf(o);if(-1!==u){c.splice(u,1);for(const r of c)if(n=Object(O.a)(e,t.etn,r),n){const a=Object(y.j)(e,t,r),o=Object(y.m)(e,t.etn,r,a,i);s.initializeValue(r,o,n.Type)}}}return s}}},HcnX:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("0nOn"),a=n("ghNp"),i=n("ScMg"),o=n("i1f0"),s=n("Zpd/"),c=n("ZMWz"),l=n("e3W2"),u=n("+XGO"),d=n("w92Z"),p=n("16wZ");let g;class h extends i.a{constructor(e,t,n,a,i,o){super(e,t,n,i),g=e,this._formContext=o,this._controlDescriptor=a;const s=[{name:"store",value:e,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"controlName",value:i,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"controlDescriptor",value:a,isRequired:!0}];this._clientApiExecutorControl=new r.a(e,"ClientApi.XrmControl.",n,t,s)}get formContext(){return this.clientApiExecutor.execute("formContext",()=>this._formContext)}get clientApiExecutor(){return this._clientApiExecutorControl}getControlType(){return this.clientApiExecutor.execute("getControlType",()=>{const e=Object(d.a)(g.getState(),this.controlDescriptor,this.pageId,this.contextToken);return e?"customcontrol:"+e.Name:"standard"})}getDisabled(){return this.clientApiExecutor.execute("getDisabled",()=>Object(o.t)(g.getState(),{id:this.pageId,controlName:this.name},this.contextToken))}getLabel(){return this._clientApiExecutorControl.execute("getLabel",()=>{const e=Object(o.w)(g.getState(),this.connectedControlProps,this.contextToken);return Object(p.a)(e)?this.controlDescriptor.Label?this.controlDescriptor.Label:"":e})}getParent(){return this.clientApiExecutor.execute("getParent",(e,t)=>{var n,r,i;if(!this._parent){if(this.getName().startsWith("header_process"))return null;if(this._formContext||(this._formContext=g.dispatch(Object(a.b)(this.pageId,this.contextToken))),this._formContext)if((null===(n=this.controlDescriptor)||void 0===n?void 0:n.ParentTabId)&&(null===(r=this.controlDescriptor)||void 0===r?void 0:r.ParentSectionName)){const e=null===(i=Object(o.Fc)(g.getState(),this.pageId,this.controlDescriptor.ParentTabId,this.contextToken))||void 0===i?void 0:i.Name,n=this._formContext.ui.tabs.get(e);n?this._parent=n.sections.get(this.controlDescriptor.ParentSectionName):t.push({name:"controlTab",value:"not Found"})}else this._formContext.ui.headerSection.controls.get(this.getName())?this._parent=this._formContext.ui.headerSection:this._formContext.ui.footerSection.controls.get(this.getName())&&(this._parent=this._formContext.ui.footerSection);this._parent||(t.push({name:"controlDescriptor",value:this.controlDescriptor?"has value":"null"}),this.controlDescriptor&&(t.push({name:"parentTabId",value:this.controlDescriptor.ParentTabId}),t.push({name:"parentSectionName",value:this.controlDescriptor.ParentSectionName})),this.clientApiExecutor.reportFailure(e,new Error("Control's parent section cannot be retrieved."),t))}return this._parent})}setFocus(){this.clientApiExecutor.executeAsync("setFocus",()=>g.dispatch(Object(u.a)(this.pageId,this.contextToken,this.name)))}getVisible(){return this.clientApiExecutor.execute("getVisible",()=>{const e=Object(o.G)(g.getState(),this.connectedControlProps,this.contextToken);return Object(p.a)(e)?this.controlDescriptor.Visible:e})}setDisabled(e){this.clientApiExecutor.execute("setDisabled",()=>{g.dispatch(Object(s.b)(this.pageId,this.name,this.contextToken,!0===e)),this.controlStateObservable.notifyObservers(this.controlDescriptor)})}setLabel(e){this.clientApiExecutor.execute("setLabel",()=>{g.dispatch(Object(c.b)(this.pageId,this.name,this.contextToken,e)),this.controlStateObservable.notifyObservers(this.controlDescriptor)},[{name:"label",value:e,isRequired:!0}])}setVisible(e){this.clientApiExecutor.execute("setVisible",()=>{g.dispatch(Object(l.b)(this.pageId,this.name,this.contextToken,!0===e)),this.controlStateObservable.notifyObservers(this.controlDescriptor)})}get controlDescriptor(){return this._controlDescriptor}}},Hevb:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return d}));var r=n("O4uv"),a=n("iZ7K"),i=n("uIhY"),o=n("6zk2"),s=n("Rckk"),c=n("g22U"),l=n("Er26");function u(e){return{type:"SERIALIZE_UPDATE_REQUEST",execute({dispatch:t,getState:n},a){const o=e.get_target();return t(Object(r.c)(o)).then(()=>{const t=n(),r=o.get_identifier(),a=r.LogicalName,s=r.get_identifier();let c;try{c=Object(i.b)(t,o)}catch(e){return{serializationFailure:e.message}}return p(t,a,s,c,e.get_suppressDuplicateDetection(),d(e.get_concurrencyBehavior(),o.getValue("versionnumber")),e.get_returnRowVersion())})}}}function d(e,t){return e===o.a.IfRowVersionMatches&&t?'W/"'+t+'"':"*"}function p(e,t,n,i,o=!0,u,d,p,g,h){let f=`${Object(a.o)(e,t)}(${n})`;p&&(f+=p);let m=c.b.Update;h&&(m=c.b.BinaryUpload);const b={urlParameters:f,method:"PATCH",additionalHeaders:{[s.c.MSCRM_SUPPRESS_DUPLICATION_DETECTION]:o.toString(),[s.c.IF_MATCH]:u||"*",[s.c.AUTO_DISASSOCIATE]:"true"},body:h?i:JSON.stringify(i),additionalParameters:{[c.a.TYPE]:c.c.UPDATE,[c.a.SUB_TYPE]:m,[l.b]:t}};return g&&Object.assign(b.additionalHeaders,g),d&&(b.additionalHeaders[r.a]="true"),b}},HfZT:function(e,t,n){"use strict";n.d(t,"b",(function(){return T})),n.d(t,"d",(function(){return A})),n.d(t,"f",(function(){return R})),n.d(t,"a",(function(){return N})),n.d(t,"c",(function(){return k})),n.d(t,"g",(function(){return D})),n.d(t,"e",(function(){return M}));var r=n("eXjw"),a=n("SAYH"),i=n("vNXc"),o=n("Uv1Y"),s=n("5Oca"),c=n("q/7h"),l=n("iZ7K"),u=n("KBcj"),d=n("Wgxh"),p=n("pF61"),g=n("ddoO"),h=n("nxXM"),f=n("69Qu"),m=n("pEXn"),b=n("4r2D"),_=n("8o18"),y=n("5qiD"),v=n("/oKV"),S=n("d+dp"),O=n("a8hT"),C=n("/Zy9"),E=n("fYtF"),I=n("z+5+"),w=n("Lyxw"),j=n("3/02"),P=n("Er26");const T="gridData.retrieve",N="E7A81278-8635-4D9E-8D4D-59480B391C5B";function A(e,t=!1){const n=[];return{type:"gridData.retrieve.async",execute({dispatch:c,getState:d},p,g){const h=d();if(Object(w.c)(h,j.G))return async function(e,t=!1){return(await Object(O.c)()).MdlProvider.getDefaultInstance().retrieveGridData(e,t)}(e,t);const N=p.DataSource,A=new b.a(a.a.newGuid().guid,g&&g.isPreloadCall);n.push({name:m.b.ClientRequestId,value:A&&A.RequestId?A.RequestId():null}),n.push({name:"isRefresh",value:t});const D=e.key,R=Object(u.c)(h,e.viewId);let F,k,L;if(e.viewPrimaryEntityName=R?R.entityLogicalName:void 0,e.entityLogicalName=R?R.entityLogicalName:void 0,Object(I.l)(h,e)){const t=C.a.fromState(e),n=Object(l.D)(h,R.entityLogicalName),r=Object(s.u)(h,D,t.pageNumber-1);Object(l.q)(h,R.entityLogicalName)&&t.selectInternal("statecode",!1),t.selectInternal(n,!1),r&&(t.pagingCookie=r),F=t.getQueryState(d)}else{L=i.a.fromState(e,d),!L.hasColumn("statecode")&&Object(l.q)(h,L.entityLogicalName)&&(L.select("statecode"),L.removeFromSelects("statecode"));const t=Object(l.D)(h,L.entityLogicalName);L.hasColumn(t)||(L.select(t),L.removeFromSelects(t));const n=Object(s.u)(h,D,L.pageNumber-1);if(n&&(L.pagingCookie=n),k=L.getKeyQuery(),Object(l.q)(h,L.entityLogicalName)){const e=k.GetColumnNamesFromFetch();e&&e.length>0&&-1===e.indexOf("statecode")&&k.set_ColumnNames(e.concat("statecode"))}k.set_queryContext(e.queryContext)}c(function(e,t,n=!1){const a=t instanceof _.a?t.get_PageSize():t.pageSize,i={lists:{[e]:{initialized:n?r.a.Refreshing:r.a.Initializing,pageSize:a}}};return{type:T,payload:i}}(D,Object(I.l)(h,e)?F:k,t));const B=p.TraceManager.getTracer(e.useModernQueryBuilder?P.e.QueryBuilder:E.a),U=e.useModernQueryBuilder?P.f.ModernQueryBuilder:E.a;return B.info(U+" RetrieveGridData action started",n),n.push({name:U,value:Object(E.e)(e)}),new Promise((t,r)=>{(async function(e,t,n,r,a,i,s){if(Object(I.l)(e,n)){return t((await Object(O.b)()).retrieveMultiple(n,s)).then(e=>Promise.resolve(e)).catch(o.b)}return new Promise((e,t)=>{const n=Object(f.b)(i())?v.a.Remote:v.a.Local,o=new S.a(y.a.Workspace,n);x(r,a,o,s).then(t=>e(t)).catch(o=>{n!==v.a.Remote||Object(f.b)(i())?t(o):x(r,a,new S.a(y.a.Workspace,v.a.Local),s).then(t=>e(t)).catch(e=>t(e))})})})(h,c,Object(I.l)(h,e)?F:null,N,Object(I.l)(h,e)?null:k,d,A).then(n=>{const r=M(h,c,D,Object(I.l)(h,e)?F:L,n);c(r),t(r.payload)},e=>{B.error(`${U} RetrieveGridData action failed with error: ${Object(o.d)(e)}`,n),r(e)}).catch(e=>r(e))})},getFailureParameters:(e,t)=>n,getSuccessParameters:(e,t,r)=>n}}function D(e,t){return{type:"grid.updateReference.async",sync:!0,execute({dispatch:n,getState:r},i){const o=r(),c={},l=Object(s.p)(o,t,void 0,!0);if(l)for(const e of l){const t=e.etn,n=a.a.toString(e.id),r=k(o,t,n);r&&(c[t]=c[t]||{},c[t][n]=r)}F(o,n,null,null,t,e,c)}}}function R(e,t,n=!1,r){return{type:"gridPage.retrieve.async",execute({dispatch:o,getState:s},c){const l=s(),d=new a.a(e),p=Object(u.c)(l,d);if(!p)return Promise.reject(`Failed to load page: view with id ${e} was not found.`);let g;Object(I.e)(l)?g=C.a.fromView(d):(g=i.a.fromXmlAndSql(p.fetchXML,p.offlineSqlQuery,d,null,null,s),g.setDefaultPageSize());const h=n?g.pageNumber+t:t;return r&&r.length&&g.select(...r),h<1?Promise.resolve(null):(g.pageNumber=h,o(A(g.getQueryState(Object(I.e)(l)?s:void 0))))}}}function x(e,t,n,r){return e.retrieveMultiple(t,n,r).nativePromise().catch(o.b)}function M(e,t,n,i,o){const s=Object(c.a)(o),l={},u=[],d={};for(let t=0;t<s.length;t++){const n=s[t].identifier.etn,r=a.a.toString(s[t].identifier.id);if(l[n]||(l[n]={}),l[n][r]=s[t],u.push(s[t].identifier),e){const t=k(e,n,r);if(t)if(d[n])d[n][r]=t;else{const e={[r]:t};d[n]=e}}}const p={entities:l,lists:{[n]:{initialized:r.a.Initialized,lastRetrieved:new Date,records:u,pages:{[i.pageNumber]:{pagingCookie:o.get_pagingCookie(),startGuid:u&&u.length&&u[0].id,startIndex:0,moreRecords:o.get_moreRecords()}},pageSize:i.pageSize,totalRecordCount:o.get_totalRecordCount(),totalRecordCountLimitExceeded:o.get_totalRecordCountLimitExceeded()}}};return F(e,t,null,null,n,null,d),{type:T,payload:p}}function F(e,t,n,r,a,i,o){const s={},c=k(e,n,r,a,i);if(c&&(s[a]=c),o&&Object.keys(o).length>0||s&&Object.keys(s).length>0){const e={entities:o,lists:s,charts:null};t(Object(h.b)(e))}}function k(e,t,n,r,a){if(!e)return null;if(a||(a=Object(p.c)(e)),a&&""!==a){if(r){const t=Object(g.i)(e,r),n=t&&t.slice();return Object(d.a)(n,a)}const i=Object(g.h)(e,t,n),o=i&&i.slice();return Object(d.a)(o,a)}return null}},HkYq:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.none=0]="none",e[e.workspace=1]="workspace",e[e.form=2]="form",e[e.component=3]="component",e[e.entityCard=4]="entityCard",e[e.quickCreateForm=5]="quickCreateForm",e[e.customization=6]="customization",e[e.listQuery=7]="listQuery",e[e.grid=8]="grid",e[e.command=9]="command",e[e.siteMap=10]="siteMap",e[e.list=11]="list",e[e.dialog=12]="dialog",e[e.gridForm=13]="gridForm",e[e.inlineCreateForm=14]="inlineCreateForm",e[e.processControl=15]="processControl",e[e.fetchXml=16]="fetchXml",e[e.chartDrilldownForm=17]="chartDrilldownForm",e[e.entity=18]="entity",e[e.attribute=19]="attribute",e[e.webResource=20]="webResource",e[e.applicationMetadata=21]="applicationMetadata",e[e.mainFormDialog=22]="mainFormDialog",e[e.chart=23]="chart",e[e.uiStrings=24]="uiStrings",e[e.businessLogic=25]="businessLogic",e[e.searchPage=26]="searchPage",e[e.globalApplicationMetadata=27]="globalApplicationMetadata",e[e.applicationMetadataUserContext=28]="applicationMetadataUserContext",e[e.staticJSFile=29]="staticJSFile",e[e.layoutXml=30]="layoutXml",e[e.draftsPage=31]="draftsPage",e[e.duplicateRecordsPage=32]="duplicateRecordsPage",e[e.applicationMetadataSettings=33]="applicationMetadataSettings",e[e.senderFormPage=34]="senderFormPage",e[e.setRegarding=35]="setRegarding",e[e.senderCreateFormPage=36]="senderCreateFormPage",e[e.interactionCentricWorkspace=37]="interactionCentricWorkspace",e[e.taskBasedFlowGlobalMenu=38]="taskBasedFlowGlobalMenu",e[e.taskBasedFlow=39]="taskBasedFlow",e[e.interactionCentricForm=40]="interactionCentricForm",e[e.cardForm=41]="cardForm",e[e.controlConfiguration=42]="controlConfiguration",e[e.commandXaml=43]="commandXaml",e[e.documentTemplate=44]="documentTemplate",e[e.viewSelector=45]="viewSelector",e[e.customControl=46]="customControl",e[e.formSelector=47]="formSelector",e[e.resourceString=48]="resourceString",e[e.savedQueryVisualization=49]="savedQueryVisualization",e[e.label=50]="label",e[e.userView=51]="userView",e[e.savedView=52]="savedView",e[e.viewDefault=53]="viewDefault",e[e.homePageConfiguration=54]="homePageConfiguration",e[e.optionSet=56]="optionSet",e[e.quickCreateMenu=57]="quickCreateMenu",e[e.userContext=58]="userContext",e[e.businessProcessFlow=59]="businessProcessFlow",e[e.searchConfiguration=60]="searchConfiguration",e[e.userQueryVisualization=61]="userQueryVisualization",e[e.visualizationSelector=62]="visualizationSelector",e[e.dashboardSelector=63]="dashboardSelector",e[e.overallMetadataVersion=64]="overallMetadataVersion",e[e.appModule=65]="appModule",e[e.complexControl=66]="complexControl",e[e.displayString=67]="displayString",e[e.webResourceDescriptor=68]="webResourceDescriptor",e[e.isActivityFlags=69]="isActivityFlags",e[e.appModuleOfflineMetadata=70]="appModuleOfflineMetadata",e[e.appModuleSelector=71]="appModuleSelector",e[e.bpfSelector=72]="bpfSelector"}(r||(r={}))},"Hm+e":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var r=n("NvOS"),a=n("9eA9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let i;function o(e){i=new a.a(Object(a.b)()+Object(r.a)(e.getState(),"/Tools/Diagnostics/diag.aspx/GetMetrics"))}function s(e){if(i){const t=e.getEvents().reduce((e,t)=>(t.parameters&&t.parameters.requestId&&e.push(new Promise(e=>{const n=new XMLHttpRequest;n.open("POST",i.href),n.setRequestHeader("Content-Type","application/json; charset=UTF-8"),n.onload=function(){const r=JSON.parse(n.response).d;for(const e in r)t.parameters[e]=r[e];e()},n.send(JSON.stringify({requestId:t.parameters.requestId}))})),e),[]);return Promise.all(t)}return Promise.resolve()}},Hswk:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
Object.getType=function(e){let t=e.constructor;return null!=t&&!t.__typeName&&e.$$genericConstructor&&(t=e.$$genericConstructor),t&&"function"==typeof t&&"Object"!==t.__typeName?t:Object};const r=function(e,t,n){const r="$$d_"+n;return null==e[r]&&(e[r]=t.bind(e)),e[r]}},I1N9:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("504W"),a=n("yQs0"),i=n("YIt1"),o=n("RIwK");class s{constructor(e,t,n,a){this._FilterExpressionId=null,this._FilterOperator=0,this._IsQuickFindFields=!1,this._Hint=null,this._Conditions=null,this._FilterExpressions=null,this._set_filterOperator(e),this.set_filterExpressionId(t),this._set_filterExpressions([]),Object(r.a)(n)?this._set_isQuickFindFields(!1):this._set_isQuickFindFields(n),Object(r.a)(a)?this._set_hint(null):this._set_hint(a)}get_filterExpressionId(){return this._FilterExpressionId}set_filterExpressionId(e){return this._FilterExpressionId=e,e}get_filterOperator(){return this._FilterOperator}_set_filterOperator(e){return this._FilterOperator=e,e}get_isQuickFindFields(){return this._IsQuickFindFields}_set_isQuickFindFields(e){return this._IsQuickFindFields=e,e}get_hint(){return this._Hint}_set_hint(e){return this._Hint=e,e}get_conditions(){return this._Conditions}_set_conditions(e){return this._Conditions=e,e}get_filterExpressions(){return this._FilterExpressions}_set_filterExpressions(e){return this._FilterExpressions=e,e}addCondition(e,t,n,i,o){n=Object(r.a)(n)?null:n,o=Object(r.a)(o)?"":o;const s=new a.a(e,t,n);return s.set_entityName(i),s.set_conditionName(o),this.get_conditions()||this._set_conditions([]),this.get_conditions().push(s),this}addFilterExpression(e){return e?(this.get_filterExpressions()||this._set_filterExpressions([]),this.get_filterExpressions().push(e),this):this}clone(){const e=new s(this.get_filterOperator(),this.get_filterExpressionId());if(this.get_conditions()){e._set_conditions([]);for(let t=0;t<this.get_conditions().length;t++)e.get_conditions().push(this.get_conditions()[t].clone())}else e._set_conditions(null);if(this.get_filterExpressions()){e._set_filterExpressions([]);for(let t=0;t<this.get_filterExpressions().length;t++)e.get_filterExpressions().push(this.get_filterExpressions()[t].clone())}else e._set_filterExpressions(null);return e}toFetchXml(){return s._CreateXmlFilter(this)}static _CreateXmlFilter(e){let t="";if(!e||!(e.get_filterExpressions()&&e.get_filterExpressions().length||e.get_conditions()&&e.get_conditions().length))return t;if(e.get_conditions()){e.get_conditions().length>0&&(t+='<filter type="'+i.a[e.get_filterOperator()].toLowerCase()+'"',e.get_isQuickFindFields()&&(t+=' isquickfindfields="1"'),t+=">",Object(r.b)(e.get_hint())||(t+=' hint="'+e.get_hint().toLowerCase()+'"'));for(let n=0;n<e.get_conditions().length;n++){const a=e.get_conditions()[n];if(t+="<condition ",Object(r.b)(a.get_entityName())||(t+='entityname="'+a.get_entityName()+'" '),a.get_value())if(Object.getType(a.get_value())===String)t+='attribute="'+a.get_attributeName()+'" operator="'+a.get_operator()+'" value="'+Object(o.a)(a.get_value())+'" />';else{const e=a.get_value();t+='attribute="'+a.get_attributeName()+'" operator="'+a.get_operator()+'">';for(let n=0;n<e.length;n++)t+="<value>"+Object(o.b)(e[n])+"</value>";t+="</condition>"}else t+='attribute="'+a.get_attributeName()+'" operator="'+a.get_operator()+'"/>'}e.get_conditions().length>0&&(t+="</filter>")}else{e.get_filterExpressions().length>1&&(t+='<filter type="'+i.a[e.get_filterOperator()].toLowerCase()+'"',e.get_hint()&&(t+=' hint="'+e.get_hint().toLowerCase()+'"'),t+=">");for(let n=0;n<e.get_filterExpressions().length;n++)t+=s._CreateXmlFilter(e.get_filterExpressions()[n]);e.get_filterExpressions().length>1&&(t+="</filter>")}return t}}},I3lY:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Version="1.8.5",t.FullVersionString="AWT-Web-JS-"+t.Version},I4Rv:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n("GYDS"),a=n("P7gI");var i=n("Knfm"),o=n("GEbX");const s="commanding.registerCommandManagerToPage";function c(e,t){return{type:"commanding.registerCommandManagerToPage.sync",sync:!0,execute:({getState:n,dispatch:c},l)=>{const u=n();if(!(Object(i.a)(u)===o.a.MultiSession)||Object(r.c)(t,!0))return;const d=Object(r.b)(u,e);if(!d||0===d.length){const t=function(e){return(t,n)=>{const i=t(),o=Object(r.b)(i,e);return o&&o.length>0&&n(Object(a.a)(o)),Promise.resolve()}}(e);l.Router.registerPreCloseHandler(e,t)}c(function(e,t){return{type:s,payload:e,meta:{commandManagerId:t}}}(e,t))}}}},I6RZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("0kGT"),a=n("z6CD"),i=n("si7p"),o=n("voMr");function s(e,t){var n;const s=Object(r.b)(e),c=Object(a.a)(e,t);return s&&(null==c?void 0:c.modalDialogType)===i.c&&(null===(n=null==c?void 0:c.dialogOptions)||void 0===n?void 0:n.allowNativeDialog)?o.a.Native:o.a.Web}},I8bZ:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.UserDefined=4]="UserDefined"}(r||(r={}))},"IH+v":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e._IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},e}();t.BrowserChecker=r},IKHO:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("omgb"),a=n("a475"),i=n("H4dV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(){return i.a.getInstance().get_isMailApp()?r.a.MailApp:"phone"===a.a.get_Instance().get_device().get_DeviceState().get_formFactor().toLowerCase()?r.a.Phone:r.a.Slate}function s(){return o()===r.a.MailApp}},ILmX:function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"n",(function(){return S})),n.d(t,"j",(function(){return m})),n.d(t,"f",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"l",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"g",(function(){return f})),n.d(t,"e",(function(){return C})),n.d(t,"m",(function(){return O})),n.d(t,"c",(function(){return I})),n.d(t,"k",(function(){return b})),n.d(t,"i",(function(){return P})),n.d(t,"o",(function(){return E})),n.d(t,"d",(function(){return T}));var r=n("arV0"),a=n("SRl2"),i=n("wgH2"),o=n("M0zh"),s=n("69Qu"),c=n("GT4X"),l=n("UIlN"),u=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function d(e,t){const{entityTypeName:n}=Object(r.g)(e,t.id);return n?o.g+n:null}function p(e){return e?o.i+e:null}function g(e){return e?o.u+e:null}function h(e){return e?o.t+e:null}function f(){return o.h+"null"}function m(e,t){if(t){const n=Object(a.b)(e,t);if(n&&!0===(null==n?void 0:n.IsUncustomized)){const n=Object(i.a)(t),r=Object(i.b)(t);if("null"!==n)return Object(a.b)(e,`${r}:${o.c}`)}return n}return null}function b(e,t){const n=Object(l.b)(e,t);return n&&m(e,n.ribbonId)||null}function _(e,t,n,r){if(null===e||" "===e||void 0===e)return!1;{const a=Object(c.d)(n,t),i=a&&a[e];if(!i)return!1;if("visible"===r)return i.visible;if("enabled"===r)return i.enabled;if("hasSelectionCountRule"===r)return i.hasSelectionCountRule;if("canBeVisibleOffline"===r)return i.canBeVisibleOffline;if("canBeVisibleForHierarchy"===r)return i.canBeVisibleForHierarchy}}function y(e,t){var n,r,a,i,o,s,c;const l=null==e?void 0:e.Layout;if(!l)return[];const u=[...null!==(n=l.Tabs.Tab)&&void 0!==n?n:[],...null!==(r=l.ContextualTabs.Tab)&&void 0!==r?r:[]],d=[];for(const e of u){const t=null!==(i=null===(a=null==e?void 0:e.Groups)||void 0===a?void 0:a.Group)&&void 0!==i?i:[];for(const e of t)Array.prototype.push.apply(d,e.Controls.Items)}if(t)for(let e=0;e<d.length;e++){const t=d[e];if(!("Menu"in t))continue;const n=null!==(s=null===(o=t.Menu)||void 0===o?void 0:o.MenuSection)&&void 0!==s?s:[];for(const e of n)Array.prototype.push.apply(d,null===(c=e.Item)||void 0===c?void 0:c.Items)}return d}function v(e,t){var n;const r=null===(n=null==t?void 0:t.controlsMap)||void 0===n?void 0:n[e];return r&&(!Object(u.a)(r.enabled)||!Object(u.a)(r.visible))}function S(e,t,n,r,a){var i;const o=null===(i=null==t?void 0:t.controlsMap)||void 0===i?void 0:i[e];if(!o)return!1;const{visible:s,enabled:c,hasSelectionCountRule:l,canBeVisibleOffline:u,canBeVisibleForHierarchy:d}=o,p=t.controlAllowList;return s&&c&&(l||!n)&&(u||r)&&(d||!a)&&(!p||p[e])}function O(e,t,n,r,a){return C(e,y(t,!0),n,r,a)}function C(e,t,n,r,a){const o={};t=null!=t?t:[];const c=Object(l.b)(e,r),u=Object(s.b)(e),d=E(e,n);for(const e of t)if(e.Id){const t=P(e.Id,Object(i.a)(null==c?void 0:c.ribbonId));v(t,c)&&(o[t]=S(t,c,a,u,d))}return o}function E(e,t){const n=Object(r.g)(e,t);return n&&n.customControlId&&"mscrmcontrols.hierarchycontrol.hierarchycontrol"===n.customControlId.toLowerCase()}function I(e,t,n,r,a){var i;const o={};for(const c in t){const u=""===t[c].commandId||t[c].commandId?t[c].commandId.split("|"):[],d=u.length>0&&""===u[0]?"null":u[0],p=4===u.length?u[3]:"null",g=Object(s.b)(e),h=w(e,t,c,r),f=j(e,t,c,r),m=Object(l.b)(e,r),b=null===(i=null==m?void 0:m.controlsMap)||void 0===i?void 0:i[c],_=!a||b.hasSelectionCountRule,y=g||b.canBeVisibleOffline,v=!E(e,n)||b.canBeVisibleForHierarchy,S=m.controlAllowList,O=!S||S[c],C={ControlId:c,LabelText:t[c].labelText?t[c].labelText:"null",CommandType:d,CanExecute:h&&f&&y&&v&&O,ShouldBeVisible:h&&f&&y&&v&&_&&O,CommandId:p,Priority:t[c].priority,Icon:t[c].icon,Tooltip:t[c].tooltip};o[c]=C}return o}function w(e,t,n,r){return t[n]&&void 0!==t[n].visible?t[n].visible:function(e,t,n){return _(t,n,e,"visible")}(e,n,r)}function j(e,t,n,r){return t[n]&&void 0!==t[n].enabled?t[n].enabled:function(e,t,n){return _(t,n,e,"enabled")}(e,n,r)}function P(e,t){let n=e;if(n){const e=n.split("|");n=e.length>0?e[e.length-1]:n}return t&&""!==t&&"null"!==t&&(n=n.replace(new RegExp(o.c,"g"),t)),n}function T(e,t,n){const r=function(e,t,n){var r;const a=Object(l.b)(e,t),o=P(n,Object(i.a)(null==a?void 0:a.ribbonId));return null===(r=null==a?void 0:a.controlsMap)||void 0===r?void 0:r[o]}(e,t,n);return null==r?void 0:r.commandValueId}},IVVt:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.All=0]="All",e[e.ValidForCreate=1]="ValidForCreate",e[e.ValidForUpdate=2]="ValidForUpdate",e[e.ValidForRead=3]="ValidForRead"}(r||(r={}))},IYuw:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="appshell.setHideAppNameInTopBar";function a(e){return{type:r,payload:{hideAppNameInTopBar:e}}}},IaGr:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t){this._eventManager=e,this._traceManager=t}static getInstance(e,t){return window[this._globalStoreName]||(window[this._globalStoreName]=new r(e,t)),window[this._globalStoreName]}get eventManager(){return this._eventManager}get traceManager(){return this._traceManager}}r._globalStoreName="clientApiGlobalStoreManager"},IdrN:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var r=n("iLty"),a=n("g73c"),i=n("84PK"),o=n("c7Og"),s=n("504W"),c=n("2JG5"),l=n("NMtn");class u{constructor(e,t,n,r){if(this._entityMetadata=null,this._entityMetadataNodes=null,this._deserialized=!1,this._deserializerCallback=null,Object(l.d)(t,"serverVersionStamp"),!(e.get_count&&e.get_item||e instanceof Array))throw Error.argumentType("data");this._entityMetadata=new Array(0),e.get_count&&e.get_item?(this._entityMetadataNodes=e,this._deserializerCallback=r,this._deserialized=!1):(this._entityMetadata=e,this._deserialized=!0)}get_count(){return this._deserialized?this._entityMetadata.length:this._entityMetadataNodes.get_count()}get_item(e){return Object(s.a)(this._entityMetadata[e])&&!Object(s.a)(this._entityMetadataNodes.get_item(e))&&(this._entityMetadata[e]=this._deserializerCallback(this._entityMetadataNodes.get_item(e).get_domParserElement()),this._entityMetadata[e]=this._entityMetadata[e]),this._entityMetadata[e]}}var d=n("KLhE"),p=n("dFCJ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function g(e){for(let t=0,n=e.childNodes.length;t<n;t++){const n=e.childNodes[t];if("a:value"===n.nodeName.toLowerCase())return Boolean.parse(n.firstChild.nodeValue).valueOf()}return!1}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class h{constructor(e,t){this._hasSecuredAttributes=!1,this._hasStateCode=!1,this._hasSecuredAttributes=e,this._hasStateCode=t}get_hasSecuredAttributes(){return this._hasSecuredAttributes}get_hasStateCode(){return this._hasStateCode}}var f,m=n("OBdv");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.none=0]="none",e[e.create=1]="create",e[e.read=2]="read",e[e.write=3]="write",e[e.Delete=4]="Delete",e[e.assign=5]="assign",e[e.share=6]="share",e[e.append=7]="append",e[e.appendTo=8]="appendTo"}(f||(f={}));var b=n("b6oC"),_=n("VJwX"),y=n("Jz2d");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function v(e){const t=[];for(let n=0,r=e.childNodes.length;n<r;n++){const r=e.childNodes[n];let o=null,s=i.a.get_empty(),c=0,l=!1,u=!1,d=!1,p=!1;for(let e=0,t=r.childNodes.length;e<t;e++){const t=r.childNodes[e];if(t.namespaceURI===y.a.xrm2011MetadataNamespace){switch(Object(_.b)(t.nodeName)){case"Name":o=t.firstChild.nodeValue;break;case"PrivilegeId":s=new i.a(t.firstChild.nodeValue);break;case"PrivilegeType":c=Object(a.a)(f,t.firstChild.nodeValue);break;case"CanBeBasic":l=Boolean.parse(t.firstChild.nodeValue).valueOf();break;case"CanBeLocal":u=Boolean.parse(t.firstChild.nodeValue).valueOf();break;case"CanBeDeep":d=Boolean.parse(t.firstChild.nodeValue).valueOf();break;case"CanBeGlobal":p=Boolean.parse(t.firstChild.nodeValue).valueOf()}}}t.push(new b.a(o,s,c,l,u,d,p))}return t}var S=n("Z6YS"),O=n("DRVD"),C=n.n(O);function E(e){return function(e,t){let n=null,r=null,l=!0,u=!1,p=!1,h=null,f=i.a.get_empty(),b=!1,S=!0,O=!0,C=!1,E=-1,j=null,P=null,T=null,N=new Array(0),A=!1,D=!1,R=!1,x=!1,M=!1,F=!1,k=!1,L=!1,B=!1,U=!1,V=!1,z=!1,W=0,q=0,H=!1,G=null,K=!1,Q=!1,X=!1,Y=!1,J=null,$=!1,Z=!1;const ee={AllowMainFormDialogForCreate:!1,AllowMainFormDialogForEdit:!1};let te=!1,ne=!1,re=!1,ae=!1,ie=!1,oe=null,se=!1,ce=null,le=null,ue=null,de=null;for(let t=0,o=e.childNodes.length;t<o;t++){const o=e.childNodes[t];if(o.namespaceURI===y.a.xrm2011MetadataNamespace){if("true"===o.getAttribute("i:nil")||!o.firstChild)continue;switch(Object(_.b)(o.nodeName)){case"DisplayCollectionName":r=Object(m.a)(o);break;case"DisplayName":n=Object(m.a)(o);break;case"HasChanged":l=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsActivity":u=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsChildEntity":p=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsReadOnlyInMobileClient":b=w(o,b);break;case"IsVisibleInMobileClient":S=w(o,S);break;case"IsOfflineInMobileClient":O=w(o,O);break;case"IsOptimisticConcurrencyEnabled":C=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"LogicalName":h=o.firstChild.nodeValue;break;case"MetadataId":f=new i.a(o.firstChild.nodeValue);break;case"ManyToOneRelationships":ue=o;break;case"OneToManyRelationships":de=o;break;case"ObjectTypeCode":E=Number.parseInvariant(o.firstChild.nodeValue);break;case"PrimaryIdAttribute":j=o.firstChild.nodeValue;break;case"PrimaryNameAttribute":P=o.firstChild.nodeValue;break;case"PrimaryImageAttribute":T=o.firstChild.nodeValue;break;case"Privileges":N=v(o);break;case"IsValidForAdvancedFind":A=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsMailMergeEnabled":D=g(o);break;case"IsConnectionsEnabled":R=g(o);break;case"IsCustomizable":x=g(o);break;case"IsActivityParty":M=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsImportable":F=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsEnabledForCharts":k=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsCustomEntity":L=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsStateModelAware":B=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"EnforceStateTransitions":U=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsValidForQueue":V=w(o,V);break;case"ActivityTypeMask":W=Number.parseInvariant(o.firstChild.nodeValue);break;case"OwnershipType":q=Object(a.a)(d.a,o.firstChild.nodeValue);break;case"IsBusinessProcessEnabled":z=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"EntityHelpUrlEnabled":H=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"EntityHelpUrl":G=o.firstChild.nodeValue;break;case"IsDocumentManagementEnabled":K=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsOneNoteIntegrationEnabled":Q=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsMSTeamsIntegrationEnabled":X=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"EntityColor":J=o.firstChild.nodeValue;break;case"IsInteractionCentricEnabled":$=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsQuickCreateEnabled":Z=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"EntityClientSetting":ee.AllowMainFormDialogForCreate=Boolean.parse(o.firstChild.firstChild.nodeValue).valueOf(),ee.AllowMainFormDialogForEdit=Boolean.parse(o.childNodes[1].firstChild.nodeValue).valueOf();break;case"IsKnowledgeManagementEnabled":te=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsDocumentRecommendationsEnabled":re=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsIntersect":ae=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"UsesBusinessDataLabelTable":ne=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IconVectorName":oe=o.firstChild.nodeValue;break;case"IsBPFEntity":se=Boolean.parse(o.firstChild.nodeValue).valueOf()}}}if(p&&ue){const e=function(e){for(let t=0,n=e.childNodes.length;t<n;t++){const n=e.childNodes[t];if(n.namespaceURI===y.a.xrm2011MetadataNamespace&&"OneToManyRelationshipMetadata"===Object(_.b)(n.nodeName)){let e=!1,t=null,r=null;for(let a=0,i=n.childNodes.length;a<i;a++){const i=n.childNodes[a];if(i.namespaceURI===y.a.xrm2011MetadataNamespace&&i.firstChild){switch(Object(_.b)(i.nodeName)){case"SecurityTypes":e="ParentChild"===i.firstChild.nodeValue;break;case"ReferencedEntity":t=i.firstChild.nodeValue;break;case"ReferencingAttribute":r=i.firstChild.nodeValue}}}if(e)return new o.a(t,r)}}return null}(ue);Object(s.a)(e)||(ce=e.get_key(),le=e.get_value())}de&&(Y=I(de,"activitypointer","regardingobjectid"),ie=I(de,"annotation","objectid"));return new c.a(f,h,n,r,E,j,P,T,N,b,S,O,C,l,u,p,ce,le,A,D,R,x,M,F,k,L,B,U,V,W,q,t.get_hasSecuredAttributes(),t.get_hasStateCode(),z,H,G,K,Q,X,Y,J,$,Z,ee,te,re,ae,ie,ne,oe,se,-1,-1,null)}(e,function(e){let t=null,n=!1,r=!1;const a=[];for(let i=0,o=e.childNodes.length;i<o;i++){const o=e.childNodes[i];if(o.namespaceURI===y.a.xrm2011MetadataNamespace){if("true"===o.getAttribute("i:nil")||!o.firstChild)continue;const e=Object(_.b)(o.nodeName);if("Attributes"===e){for(let e=0,t=o.childNodes.length;e<t;e++){const t=o.childNodes[e];if(t.namespaceURI===y.a.xrm2011MetadataNamespace&&"AttributeMetadata"===Object(_.b)(t.nodeName)){const e=Object(p.a)(t);e&&(e.get_isSecured()&&(n=!0),"statecode"===e.get_logicalName()&&(r=!0),a.push(e))}}if(!Object(s.a)(t))break}else if("LogicalName"===e&&(t=o.firstChild.nodeValue,!Object(s.a)(a)))break}}return new h(n,r)}(e))}function I(e,t,n){for(let r=0,a=e.childNodes.length;r<a;r++){const a=e.childNodes[r];if(a.namespaceURI===y.a.xrm2011MetadataNamespace&&"OneToManyRelationshipMetadata"===Object(_.b)(a.nodeName)){let e=!1,r=!1;for(let i=0,o=a.childNodes.length;i<o;i++){const o=a.childNodes[i];if(o.namespaceURI===y.a.xrm2011MetadataNamespace&&o.firstChild){const a=Object(_.b)(o.nodeName);"ReferencingEntity"===a&&o.firstChild.nodeValue===t?e=!0:"ReferencingAttribute"===a&&o.firstChild.nodeValue===n&&(r=!0)}}if(e&&r)return!0}}return!1}function w(e,t){for(let t=0,n=e.childNodes.length;t<n;t++)if(e.childNodes[t].namespaceURI===y.a.xrm2011ContractsNamespace&&"Value"===Object(_.b)(e.childNodes[t].nodeName))return Boolean.parse(e.childNodes[t].firstChild.nodeValue).valueOf();return t}class j extends r.a{constructor(e){super(e),this._responseResultsNode=null,this._entityMetadataCollection=null,e&&(this._responseResultsNode=e.selectSingleNode(".//d:ExecuteResult/a:Results"))}get_entityMetadataCollection(){return!this._entityMetadataCollection&&this.get_soapResponse()&&this._responseResultsNode&&(this._entityMetadataCollection=function(e){const t=C.a.createEvent("LoadFromCrmSoap","EntityMetadataCollection").startStopwatch(),n=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='ServerVersionStamp']/b:value").get_innerText();e.addNamespace("c",y.a.xrm2011MetadataNamespace);const r=e.selectNodes(".//a:KeyValuePairOfstringanyType[b:key='EntityMetadata']/b:value/a:EntityMetadata");e.addNamespace("c",y.a.xrm2011MetadataQueryNamespace),e.addNamespace("d",S.a.microsoft2003SerializationArraysNamespace);const a=e.selectNodes(".//a:KeyValuePairOfstringanyType[b:key='DeletedMetadata']/b:value/c:KeyValuePairOfDeletedMetadataFiltersArrayOfguidPlUv_PKtF[b:key='Attribute']/b:value/d:guid"),o=new Array(0),s=a.get_count();for(let e=0;e<s;e++)o[e]=new i.a(a.get_item(e).get_innerText());return t(),new u(r,n,o,E)}(this._responseResultsNode)),this._entityMetadataCollection}}},IfHN:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("Qjw6"),a=n("9eA9"),i=n("SAYH"),o=n("D+Bz"),s=n("iKQk"),c=n("N6E8"),l=n("xagu"),u=n("AKum");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d={type:o.a.Page,pageType:"entityrecord",factory:r.a,isRedirect:!0,urlToInput(e){let t=null,n=null,r=null,a=null,o=null,c=null,u=null,d=null,p=null,g=null,h=null,f=null;const m=e.searchParams,b=m.get(l.u),_=i.a.tryParseOrNull(m.get(l.x)),y=new s.a(m.get(l.v)),v=m.get(l.H);m.has(l.B)&&"true"===m.get(l.B).toLowerCase()&&(f=!0);const S="entity"===v?"entityrecord":v;try{if(m.has(l.i)&&m.get(l.i)){const e=m.get(l.i),n=decodeURIComponent(e);t=JSON.parse(n)}}catch(e){throw Error(e)}if(m.has(l.w)?n=i.a.tryParseOrNull(m.get(l.w)):m.has(l.v)&&(n=i.a.tryParseOrNull(y.get(l.w))),m.has(l.v)){const e=y.toDictionary();t||(t={});for(const n of Object.keys(e))n===l.w||n in t||(t[n]=e[n])}return m.has(l.R)&&(r=m.get(l.R)),m.has(l.F)&&(g=m.get(l.F)),m.has(l.P)&&(a=m.get(l.P)),m.has(l.Q)&&(o=m.get(l.Q)),m.has(l.U)&&(c=m.get(l.U)),m.has(l.V)&&(u=m.get(l.V)),m.has(l.y)&&(d="true"===m.get(l.y)),m.has(l.A)&&(p="true"===m.get(l.A)),m.has(l.a)&&(h="true"===m.get(l.a)),{entityTypeName:b,formId:n,id:_,pageType:S,data:t,recordSetQueryKey:r,processId:a,processInstanceId:o,selectedStageId:c,selectedTabId:u,isCrossEntityNavigate:d,isOfflineSyncError:p,navItemId:g,bodyOnly:h,isPreview:f}},inputToUrl(e,t,n){let r=Object.assign({},t.data);const o=new a.a(e),s=o.searchParams,u=t.initWithEntity;if(void 0!==t.entityTypeName?s.set(l.u,t.entityTypeName):s.set(l.u,t.etn),u&&!(r.hasOwnProperty(c.d+"id")&&r.hasOwnProperty(c.d+"type")&&r.hasOwnProperty(c.d+"name"))){const e={[c.d+"id"]:u.id.guid,[c.d+"type"]:u.etn,[c.d+"name"]:u.name};r=Object.assign(Object.assign({},r),e),t.data=r}if(t.id&&!i.a.isNullOrEmpty(t.id)&&s.set(l.x,i.a.toString(t.id)),t.formId&&s.set(l.w,t.formId.guid.toString()),n&&r&&0!==Object.keys(r).length){const e=JSON.stringify(r),t=encodeURIComponent(e);s.set(l.i,t)}return t.processId&&s.set(l.P,t.processId),t.processInstanceId&&s.set(l.Q,t.processInstanceId),t.selectedStageId&&s.set(l.U,t.selectedStageId),t.isCrossEntityNavigate&&s.set(l.y,t.isCrossEntityNavigate.toString()),t.isOfflineSyncError&&s.set(l.A,t.isOfflineSyncError.toString()),t.navItemId&&s.set(l.F,t.navItemId),null!=t.bodyOnly&&s.set(l.a,t.bodyOnly.toString()),o.href},inputToWebUrl(e,t){const n=new a.a(e),r=n.searchParams;t.entityTypeName&&r.set(u.c,t.entityTypeName);const o=i.a.toString(t.id);return o&&r.set(u.e,o),r.set(u.f,"entityrecord"),n.href}};Object.freeze(d)},Ii8m:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("lq82"),a=n("arV0"),i=n("QiMq"),o=n("i1f0"),s=n("Tz6o");function c(e,t){return{type:"tab.remember_selected_tab",sync:!0,execute({dispatch:n,getState:c},l,u){if(!t)return;const d=Object(a.g)(c(),e);let p;"string"==typeof t?(p={selectedTabId:t,selectedRelatedEntity:void 0},d&&d.selectedTabId&&n(Object(i.b)(e,d.selectedTabId))):p={selectedTabId:void 0,selectedRelatedEntity:t};const g=Object.assign(Object.assign({},d),p);Object(a.f)(c(),e)||Object(o.Eb)(c(),e)?n(Object(s.b)(g,e)):n(Object(r.a)(g))}}}},IpQH:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n("zsAz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){return e&&e.availablePlatformServices?e.availablePlatformServices[t]:null}var i=n("d5d1"),o=n("EAYf"),s=n("DRVD"),c=n.n(s),l=n("iDqy"),u=n.n(l),d=n("ngeo"),p=n("Qois");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class g{constructor(e,t,n){this.applicationContext=e,this.applicationStore=t,this.serviceName=n}getServiceName(){return this.serviceName}isOperationAvailable(e){const t=this.applicationStore.getState(),n=a(t,this.getServiceName());if(n){const r=n.operations[e];if(r){const e=r.platformFeatureDependencies;return!e||e.every(e=>Object(i.c)(t,e))}}return!1}isOperationAvailableAndEnabled(e){const t=this.applicationStore.getState(),n=a(t,this.getServiceName());if(n){const r=n.operations[e];if(r){const e=r.platformFeatureDependencies;return!e||e.every(e=>Object(i.d)(t,e))}}return!1}execute(e,...t){if(!this.isOperationAvailable(e))return new Promise((t,n)=>{d.a.retrieveErrorMessage(this.applicationStore,p.a.ServiceAndOperationNotSupported,this.getServiceName()+"."+e).then(e=>{n({errorCode:p.a.ServiceAndOperationNotSupported,message:e})},e=>{n({errorCode:p.a.ServiceAndOperationNotSupported,message:e})})});if(!this.isOperationAvailableAndEnabled(e))return new Promise((e,t)=>{d.a.retrieveErrorMessage(this.applicationStore,p.a.FeatureNotEnabled).then(e=>{t({errorCode:p.a.FeatureNotEnabled,message:e})},e=>{t({errorCode:p.a.FeatureNotEnabled,message:e})})});const n=u.a.trackWork("PlatformComponents"),a=c.a.createEvent(e,"PlatformComponents").startStopwatch(),i=new o.a(this.getServiceName(),e,t);return new Promise((e,t)=>{this.applicationContext.PlatformContext.getPlatform().executeServiceOperation(i,this.applicationContext,this.applicationStore).then(t=>{a(),n(),e(t)},e=>{if(a(),n(),e&&null!==e.errorCode&&void 0!==e.errorCode){const n=Object(r.c)(e);n.innerError=e,d.a.retrieveErrorMessage(this.applicationStore,e.errorCode,e.param).then(e=>{n.displayMessage=e,t(n)},e=>{t(n)})}else t(e)})})}}},IqkD:function(e,t,n){"use strict";n.d(t,"x",(function(){return o})),n.d(t,"r",(function(){return s})),n.d(t,"w",(function(){return c})),n.d(t,"t",(function(){return l})),n.d(t,"q",(function(){return u})),n.d(t,"p",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"n",(function(){return h})),n.d(t,"u",(function(){return f})),n.d(t,"v",(function(){return m})),n.d(t,"e",(function(){return b})),n.d(t,"f",(function(){return _})),n.d(t,"d",(function(){return y})),n.d(t,"l",(function(){return v})),n.d(t,"k",(function(){return S})),n.d(t,"b",(function(){return I})),n.d(t,"h",(function(){return g})),n.d(t,"j",(function(){return O})),n.d(t,"i",(function(){return C})),n.d(t,"a",(function(){return E})),n.d(t,"s",(function(){return w})),n.d(t,"c",(function(){return j})),n.d(t,"m",(function(){return P})),n.d(t,"o",(function(){return T}));var r=n("SAYH"),a=n("NjDY"),i=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e){return e?e.user:null}function s(e){const t=o(e);return t?t.initialized:i.a.Uninitialized}function c(e){const t=o(e);return t?t.userSettings:null}function l(e){const t=o(e);return t?t.userDisplayName:null}function u(e){const t=o(e);return t?t.userId:null}function d(e){const t=o(e);return t?t.userEmail:null}function p(e){const t=c(e);return!!t&&t.isRTL}function g(e){const t=c(e);return t?t.recordsPerPage:null}function h(e){const t=o(e);return t?t.userAttributePrivileges:null}function f(e){const t=o(e);return t?t.userRolePrivileges:null}function m(e){const t=o(e);return t?t.userRolesToNames:null}function b(e){const t=c(e);return t?t.offlineProfileId:r.a.EMPTY}function _(e){const t=c(e);return t?t.offlineProfileVersion:""}function y(e){const t=c(e);return t?t.offlineProfileAvailableEntities:null}function v(e){const t=c(e);return t?t.timeZoneUtcOffsetMinutes:null}function S(e){const t=c(e);return t?t.timeZoneAdjusters:null}function O(e){const t=c(e);return t?t.selectedGlobalFilterId:null}function C(e){const t=c(e);return t?t.savedFilters:null}function E(e){const t=c(e);return t?t.defaultSavedFilter:null}function I(e){let t=null;const n=function(e){const t=c(e);return t?t.transactionCurrencyById:null}(e);if(n&&(t=n[r.a.toString(function(e){const t=c(e);return t?t.transactionCurrencyId:null}(e))],!t)){const i=Object(a.x)(e);if(i&&i.baseCurrencyId&&(t=n[r.a.toString(i.baseCurrencyId)],!t))return null}return t}function w(e){const t=c(e);return t?t.languageId:null}function j(e){return 2052===w(e)}function P(e){const t=c(e);return t?t.timeZoneDefinitionByCode:{}}function T(e){const t=c(e);return t?t.userCultureName||t.formatInfoCultureName:""}},IuCO:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("eeMP"),a=n("SAYH"),i=n("PF3G"),o=n("LtP7"),s=n("WRF3");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e,t){return{type:"DESERIALIZE_UPDATE_RESPONSE_ASYNC",execute({dispatch:n,getState:c},l){const u=Object(r.c)(e),d=a.a.toLegacyGuid(u),p=t instanceof i.a?t.get_target().get_identifier().LogicalName:t.etn,g=new s.a(p,d,null,Object(r.d)(e)),h=new o.a(g);return Promise.resolve(h)}}}},IvgJ:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return d})),function(e){e[e.Raw=0]="Raw",e[e.Numeric=1]="Numeric",e[e.Label=2]="Label",e[e.Value=3]="Value",e[e.State=4]="State",e[e.Id=5]="Id",e[e.Name=6]="Name",e[e.LogicalName=7]="LogicalName",e[e.AllowedStatusTransitions=8]="AllowedStatusTransitions",e[e.DefaultStatus=9]="DefaultStatus",e[e.Color=10]="Color"}(r||(r={}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a=u(r.Label),i=u(r.Value),o=u(r.State),s=u(r.DefaultStatus),c=u(r.AllowedStatusTransitions),l=u(r.Color);function u(e){return"!"+r[e]}class d{constructor(e,t,n,r,a,i,o){this._label=null,this._val=0,this._state=0,this._defaultStatus=0,this._allowedStatusTransitions=null,this._color=null,this._invariantName=null,this._label=e,this._val=t,this._state=n,this._defaultStatus=r,this._allowedStatusTransitions=a,this._color=i,this._invariantName=o}get_Label(){return this._label}set_Label(e){return this._label=e,e}get_ValueString(){return this._val.toString()}get_allowedStatusTransitions(){return this._allowedStatusTransitions}get_color(){return this._color}get_value(){return this._val}get_state(){return this._state}get_defaultStatus(){return this._defaultStatus}get_invariantName(){return this._invariantName}getObjectData(){return{label:this._label,value:this._val,state:this._state,defaultstatus:this._defaultStatus,allowedstatustransitions:this._allowedStatusTransitions,color:this._color,invariantname:this._invariantName}}getODataObject(){return{Value:this._val,Color:this._color,Label:this._label,DefaultStatus:this._defaultStatus,State:this._state,TransitionData:this._allowedStatusTransitions,InvariantName:this._invariantName}}getValue(e){if(e===a||"label"===e)return this.get_Label();if(e===i||"value"===e)return this.get_value();if(e===o||"state"===e)return this.get_state();if(e===s||"defaultstatus"===e)return this._defaultStatus;if(e===c||"allowedstatustransitions"===e)return this.get_allowedStatusTransitions();if(e===l||"color"===e)return this.get_color();throw Error.argumentOutOfRange("fieldName",e)}static createFromPicklistItem(e){if(e instanceof d)return e;const t=e.get_Label(),n=Number.parseInvariant(e.get_ValueString());return new d(t,n,-1,-1,null,null,null)}static createFromObjectData(e){const t=e.label,n=e.value,r="state"in e?e.state:-1,a="defaultstatus"in e?e.defaultstatus:-1,i="allowedstatustransitions"in e?e.allowedstatustransitions:null,o="color"in e?e.color:null,s=e.invariantname;return new d(t,n,r,a,i,o,s)}static createFromOData(e){const t=e.Label,n=e.Value,r="State"in e?e.State:-1,a="DefaultStatus"in e?e.DefaultStatus:-1,i="TransitionData"in e?e.TransitionData:null,o="Color"in e?e.Color:null,s=e.Description;return new d(t,n,r,a,i,o,s)}}d.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.OptionMetadata"},IzVP:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return c})),function(e){e[e.all=0]="all",e[e.systemApplicationMetadata=1]="systemApplicationMetadata",e[e.userApplicationMetadata=2]="userApplicationMetadata"}(r||(r={}));var a=n("HkYq"),i=n("504W"),o=n("3umU"),s=n("xAYq");class c{constructor(e,t,n,a,o,s,c,l){if(this._metadataType=0,this._metadataSubtype=0,this._formFactor=0,this._associatedEntityLogicalName=null,this._isDefault=!1,this._sourceId=null,this._normalizedDisplayName=null,this._applicationMetadataType=0,this._isDefaultSpecified=!1,!e)throw Error.argument("Invalid application metadata type");this._metadataType=e,this._formFactor=t,this._associatedEntityLogicalName=n,this._applicationMetadataType=Object(i.a)(a)?r.systemApplicationMetadata:a,this._isDefaultSpecified=!Object(i.a)(o),this._isDefault=!!this._isDefaultSpecified&&o,this._sourceId=s,this._metadataSubtype=c,this._normalizedDisplayName=l}checkApplicationMetadata(e){return(!this.get_metadataType()||e.get_metadataType()===this.get_metadataType())&&(!(!Object(i.a)(this.get_metadataSubtype())&&e.get_metadataSubtype()!==this.get_metadataSubtype())&&(!(!Object(i.b)(this.get_sourceId())&&e.get_sourceId()!==this.get_sourceId())&&(!(!Object(i.b)(this.get_associatedEntityLogicalName())&&e.get_AssociatedEntityLogicalName()!==this.get_associatedEntityLogicalName())&&(!(this.get_formFactor()>0&&e.get_formFactor()!==this.get_formFactor())&&(!(this._isDefaultSpecified&&this._isDefault&&(Object(i.a)(e.get_isDefault())||!e.get_isDefault()))&&(!(this._applicationMetadataType===r.userApplicationMetadata&&!e.get_isUserRecord())&&!(!Object(i.b)(this.get_normalizedDisplayName())&&this.get_normalizedDisplayName()!==e.get_DisplayName().toUpperCase())))))))}get_keyPath(){return Object(i.b)(this.get_sourceId())?Object(i.b)(this.get_normalizedDisplayName())?Object(i.b)(this.get_associatedEntityLogicalName())||Object(i.a)(this.get_metadataSubtype())?Object(i.b)(this.get_associatedEntityLogicalName())?o.a.metadataTypeKeyPath:o.a.metadataTypeAssociatedEntityLogicalNameKeyPath:o.a.metadataTypeMetadataSubtypeAssociatedEntityLogicalNameKeyPath:o.a.metadataTypeNormalizedDisplayNameKeyPath:o.a.metadataTypeSourceIdKeyPath}get_keyValue(){const e=this.get_metadataType().toString(),t=this.get_keyPath();if(t===o.a.metadataTypeSourceIdKeyPath)return e+s.a+this.get_sourceId();if(t===o.a.metadataTypeAssociatedEntityLogicalNameKeyPath)return e+s.a+this.get_associatedEntityLogicalName();if(t===o.a.metadataTypeMetadataSubtypeAssociatedEntityLogicalNameKeyPath){const t=this.get_metadataSubtype().toString();return e+s.a+t+s.a+this.get_associatedEntityLogicalName()}return t===o.a.metadataTypeNormalizedDisplayNameKeyPath?e+s.a+this.get_normalizedDisplayName():this.get_metadataType()}get_metadataType(){return this._metadataType}get_metadataSubtype(){return this._metadataSubtype}get_formFactor(){return this._formFactor}get_associatedEntityLogicalName(){return this._associatedEntityLogicalName}get_sourceId(){return this._sourceId}get_normalizedDisplayName(){return this._normalizedDisplayName}toString(){const e=new Sys.StringBuilder;return e.append(String.format("MetadataType: {0}; SourceId: {1}",a.a[this.get_metadataType()],this.get_sourceId())),Object(i.b)(this.get_associatedEntityLogicalName())||e.append(String.format("; EntityLogicalName: {0}",this.get_associatedEntityLogicalName())),this._applicationMetadataType===r.userApplicationMetadata&&e.append("; UserData"),e.toString()}}},"J+j6":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"e",(function(){return g}));var r=n("SAYH"),a=n("pEXn"),i=n("WePp");class o{constructor(){this._eventsToStoreCount=250,this._events=[];let e=0;try{e=parseInt(localStorage.getItem("ApplicationEventsHistoryCount"),10)}catch(e){}e&&this.setEventsToStoreLimit(e,!1)}static getInstance(){return this._instance||(this._instance=new o),this._instance}getEvents(){return this._events}clearEvents(){this._events=[]}saveEvents(e){const t=e.map(e=>({uniqueId:r.a.newGuid(),applicationEvent:e}));this._events.push(...t),this._events.sort((e,t)=>{const n=new Date(e.applicationEvent.getEventParameter(a.g.TimeCreated).value).getTime(),r=new Date(t.applicationEvent.getEventParameter(a.g.TimeCreated).value).getTime();return n&&r&&n!==r?n>r?1:-1:0}),this._slice()}setEventsToStoreLimit(e,t=!0){e>1e3&&(e=1e3);const n=this._eventsToStoreCount;if(this._eventsToStoreCount=e,this._eventsToStoreCount<n&&this._slice(),t)try{localStorage.setItem("ApplicationEventsHistoryCount",this._eventsToStoreCount.toString())}catch(e){}}getEventsToStoreLimit(){return this._eventsToStoreCount}handleEvent(e,t){this.saveEvent(e)}saveEvent(e){this._events.push({uniqueId:r.a.newGuid(),applicationEvent:e}),this._slice()}_slice(){this._events.length>this._eventsToStoreCount&&(this._events=this._events.slice(this._events.length-this._eventsToStoreCount,this._events.length))}}function s(){return o.getInstance()}function c(){return o.getInstance().getEvents()}function l(){o.getInstance().clearEvents()}function u(){return o.getInstance().getEventsToStoreLimit()}function d(e){o.getInstance().setEventsToStoreLimit(e)}function p(e){const t=JSON.parse(e).map(e=>new i.a("").fromJSON(e));o.getInstance().saveEvents(t)}function g(e){o.getInstance().saveEvent(e)}},J17A:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("WfN+"),a=n("EDmP"),i=function(){function e(){}return e.logManagerContext=new r.default,e.sessionEnabled=!0,e.loggingEnabled=!1,e.defaultTenantToken="",e.semanticContext=new a.default(!0,e.logManagerContext),e}();t.default=i},J6kk:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AggregationTransport=void 0;var r=function(){function e(){this._events=[]}return e.prototype.getEvents=function(){return this._events},e.prototype.reset=function(){this._events=[]},e.prototype.writeMarker=function(e,t,n){this._events.push({name:e.getName(),zone:e.getZone(),time:t,parameters:n})},e.prototype.writeRetroactiveTimespan=function(e,t,n,r){this._events.push({name:e.getName(),zone:e.getZone(),time:t,timeEnd:t+n,parameters:r})},e.prototype.startTimespan=function(e,t,n){var r=this;return function(a,i){r._events.push({name:e.getName(),zone:e.getZone(),time:t,timeEnd:t+a,parameters:n||i?Object.assign({},n,i):null})}},e}();t.AggregationTransport=r},JC5U:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n("1OTd");function a(){return{type:r.m,payload:{navigating:!0}}}function i(){return{type:r.m,payload:{navigating:!1}}}},JDi5:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the Search page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Search"},JEGW:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="recordSetNav.toggle";function a(e){return{type:r,payload:{collapsed:e}}}},JEu3:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="offline.file.sync";function a(e){return{type:r,payload:{isFileSyncInProgress:e}}}},JHwY:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="router.setstack";function a(e,t){return{type:r,payload:{dialogContextIds:e,navigating:!1,error:!1,currentPage:"",browsingContextId:t}}}},JIgJ:function(e,t,n){"use strict";(function(e,r){var a,i=n("qOTE");a="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:r;var o=Object(i.a)(a);t.a=o}).call(this,n("8S1D"),n("LRcz")(e))},JOgp:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return u}));var r=n("5Oca"),a=n("i1f0"),i=n("504W"),o=n("VcAV"),s=n("64CY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e){const t=[];if(e&&null!=e.Parameters){const n=e.Parameters.AddressField;if(n&&(t.push({attributeName:n}),Object(s.f)(n))){Object(s.d)(n).forEach(e=>{t.push({attributeName:e})})}}return t}function l(e,t,n,a){const i=Object(s.d)(e),c=new Sys.StringBuilder;return i.forEach(e=>{const i=Object(r.y)(t,n,a,e);Object(o.b)(i)||(c.append(i),c.append(" "))}),c.toString()}function u(e,t,n,r,c,l){const u=Object(s.d)(e),d=new Sys.StringBuilder,p=new Sys.StringBuilder;let g=!0,h=null;u.forEach(e=>{const s=Object(a.X)(t,n,r,c,l,e);Object(i.a)(s)||(Object(o.b)(s.value)||(d.append(s.value),d.append(" ")),Object(i.a)(s.validationResult)||(Object(o.b)(s.validationResult.userInput)||(p.append(s.validationResult.userInput.toString()),p.append(" ")),Object(i.a)(s.validationResult.isValueValid)||(g=g&&s.validationResult.isValueValid)),h=Object(i.a)(h)||s.timestamp>h?s.timestamp:h)});return{value:d.toString(),formatted:d.toString(),timestamp:h,validationResult:{isValueValid:g,userInput:p.toString()}}}},JP46:function(e,t,n){"use strict";n.d(t,"a",(function(){return q})),n.d(t,"b",(function(){return V})),n.d(t,"c",(function(){return U}));var r,a=n("WPtp"),i=n("odYE"),o=n("SAYH"),s=n("bT7G"),c=n("Xd5/"),l=n("LbMF"),u=n("uhZ3");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function d(e,t,n,r){return{validate:e,errorCode:t,errorMessage:n,parameters:r}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.Required=0]="Required",e[e.Number=1]="Number",e[e.Integer=2]="Integer",e[e.Email=3]="Email",e[e.MinValue=4]="MinValue",e[e.MaxValue=5]="MaxValue",e[e.Precision=6]="Precision",e[e.MaxLength=7]="MaxLength",e[e.DateTime=8]="DateTime",e[e.Duration=9]="Duration"}(r||(r={}));var p=n("YxC/"),g=n("09gH");function h(e){return"integer"===e.Type&&("duration"===e.Format||"1"===e.Format)}function f(e,t){if(!Object(u.b)(e)&&!b(e)){let n=e.toString().trim();if(!t)return!1;const{regexMinutes:r,regexHours:a,regexDays:i}=t;if(r.test(n))n=n.replace(r,"").trim();else if(a.test(n))n=n.replace(a,"").trim();else{if(!i.test(n))return!1;n=n.replace(i,"").trim()}return b(n)}return!0}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function m(e){if("string"==typeof e||"number"==typeof e){const t=Number(e);return!isNaN(t)}return!1}function b(e){if("string"==typeof e||"number"==typeof e){const t=Number(e);return!isNaN(t)&&t>=0}return!1}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function _(e){if("string"==typeof e||"number"==typeof e){const t=Number(e);return!isNaN(t)&&Number.isInteger(t)}return!1}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const y=/^[^@\s\\"<>)(\[\]:;,.]+(([.]{1}[^@\s\\"<>)(\[\]:;,.]+)+?|)@([^@\s\\"<>)(\[\]+:;,.-]+(([.+-][^@\s\\"<>)(\[\]+:;,.-]+)+?|)([.][^0-9@\s\\"<>)(\[\]+:;,.-]+)+?|(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))$/,v=/["\\"]/;function S(e){return y.test(e)||function(e){if("string"!=typeof e)return!1;const t=e.indexOf('"'),n=e.indexOf('"@',1);if(0===t&&n>1){const t=e.substring(1,n),r=e.replace('"'+t+'"',"abc");if(!v.test(t)&&y.test(r))return!0}return!1}(e)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function O(e){return!Object(u.b)(e)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function C(e){return!isNaN(Date.parse(e))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const E=[function(e,t){const n=Object(p.c)(t,g.n);return 2===e.RequiredLevel||1===e.RequiredLevel?d(O,r[r.Required],n):null},function(e,t){const n=Object(p.c)(t,g.b);return"datetime"===e.Type?d(C,r[r.DateTime],n):null},function(e,t,n){let a=null;const i="money"===e.Type?Object(p.c)(t,g.a):Object(p.c)(t,g.m),o=n?Object(c.x)(e.MinValue,n,t):e.MinValue,s=n?Object(c.x)(e.MaxValue,n,t):e.MaxValue;switch(e.Type){case"integer":case"decimal":case"double":case"money":h(e)||(a=void 0!==e.MinValue&&null!==e.MinValue&&void 0!==e.MaxValue&&null!==e.MaxValue?d(m,r[r.Number],String.format(i,o,s)):null)}return a},function(e,t){const n=Object(p.c)(t,g.k);return"integer"!==e.Type||h(e)?null:d(_,r[r.Integer],n)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */,function(e,t){const n=Object(p.c)(t,g.e),a=new RegExp("^"+Object(p.c)(t,g.h)+"\\s|\\s"+Object(p.c)(t,g.h)+"$|^"+Object(p.c)(t,g.i)+"\\s|\\s"+Object(p.c)(t,g.i)+"$"),i=new RegExp("^"+Object(p.c)(t,g.f)+"\\s|\\s"+Object(p.c)(t,g.f)+"$|^"+Object(p.c)(t,g.g)+"\\s|\\s"+Object(p.c)(t,g.g)+"$"),o=new RegExp("^"+Object(p.c)(t,g.c)+"\\s|\\s"+Object(p.c)(t,g.c)+"$|^"+Object(p.c)(t,g.d)+"\\s|\\s"+Object(p.c)(t,g.d)+"$");return h(e)?d(f,r[r.Duration],n,{regexMinutes:a,regexHours:i,regexDays:o}):null},function(e,t,n){const a="money"===e.Type?Object(p.c)(t,g.a):Object(p.c)(t,g.m),i=n?Object(c.x)(e.MinValue,n,t):e.MinValue,o=n?Object(c.x)(e.MaxValue,n,t):e.MaxValue;return void 0!==e.MinValue&&null!==e.MinValue&&void 0!==e.MaxValue&&null!==e.MaxValue?d((s=e.MaxValue,e=>{if("string"==typeof e||"number"==typeof e){const t=Number(e);return!isNaN(t)&&+t<=s}return!1}),r[r.MaxValue],String.format(a,i,o)):null;var s}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */,function(e,t,n){const a="money"===e.Type?Object(p.c)(t,g.a):Object(p.c)(t,g.m),i=n?Object(c.x)(e.MinValue,n,t):e.MinValue,o=n?Object(c.x)(e.MaxValue,n,t):e.MaxValue;return void 0!==e.MinValue&&null!==e.MinValue&&void 0!==e.MaxValue&&null!==e.MaxValue?d((s=e.MinValue,e=>{if("string"==typeof e||"number"==typeof e){const t=Number(e);return!isNaN(t)&&+t>=s}return!1}),r[r.MinValue],String.format(a,i,o)):null;var s},function(e,t){const n=Object(p.c)(t,g.j);return"email"===("string"==typeof e.Format&&e.Format.toLowerCase())?d(S,r[r.Email],n):null},function(e,t){const n=Object(p.c)(t,g.l);return void 0!==e.MaxLength&&null!==e.MaxLength?d((a=e.MaxLength,e=>"string"==typeof e&&e.length<=a),r[r.MaxLength],String.format(n,e.MaxLength)):null;var a}];function I(e,t,n,r,a,i){const o=function(e,t,n){const r=[];if(e)for(const a of E)a&&r.push(a.call(null,e,t,n));return r}(t,n,a),s={isValueValid:!0,userInput:e,errorMessage:null,errorId:void 0,isOfflineSyncError:i};if(function(e,t,n){return(2===t.RequiredLevel||1===t.RequiredLevel)&&!0!==n||!Object(u.c)(e)}(e,t,r))for(const t of o)if(t&&!t.validate(e,t.parameters)){s.isValueValid=!1,s.errorMessage=t.errorMessage,s.errorId=t.errorCode;break}return s}var w=n("g2Nw"),j=n("i1f0"),P=n("Qn2w"),T=n("nVTU"),N=n("3tOH"),A=n("arV0"),D=n("jTSi"),R=n("dHD5"),x=n("Ae6N"),M=n("Lyxw"),F=n("3/02"),k=n("8nT0"),L=n("5Oca"),B=n("O7zD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const U="processid";function V(e,t,n=!1){const r=Object(a.e)(e),s=Object(a.e)(t);if(!e&&!t)return!1;if(!e&&t&&null!=s)return!0;const c=!e||!e.validationResult||e.validationResult.isValueValid,l=!t||!t.validationResult||t.validationResult.isValueValid;if(!e&&!s&&l)return!1;if(Object(a.j)(t))return r!==s||r===s&&!l||r===s&&!c;if(Object(a.i)(t))return r!==s||r===s&&!l||r===s&&!c;if(Object(a.h)(t)){if(r.length===s.length){for(let e=0;e<r.length;e++){const t=r[e].fields.partyid,n=s[e].fields.partyid;if(t&&!n||!t&&n)return!0;if(t&&n){if(!i.a.equals(t.reference,n.reference))return!0}else if(!t&&!n&&r[e].fields.addressused.value!==s[e].fields.addressused.value)return!0}if(l&&c)return!1}return!0}if(Object(a.g)(t))return!o.a.equals(r,s)||o.a.equals(r,s)&&!l||o.a.equals(r,s)&&!c;if(Object(a.k)(t)){const e=n?i.a.equals:i.a.equalsIgnoreName;return!e(r,s)||e(r,s)&&!l||e(r,s)&&!c}return!!Object(a.f)(t)&&V(r,s)}function z(e){if(e&&e.fields&&e.fields.partyid&&e.identifier)return e;let t=null;return e instanceof i.a?t=e:e&&e.id&&e.entityName&&(t=new i.a(e.entityName,new o.a(e.id),e.name)),{identifier:new i.a("activityparty"),fields:{partyid:{reference:t}}}}function W(e,t,n,r,a,s){if(null==s)throw Error("validationResult is null for fieldName: "+e);switch(t){case"picklist":case"state":case"status":return{label:r,valueString:null!=n?n.toString():null,timestamp:a,validationResult:s};case"boolean":const e=null===n?-1:"1"===n||"true"===n||!0===n||1===n?1:0;return{label:-1===e?"---":r,valueString:e.toString(),timestamp:a,validationResult:s};case"uniqueidentifier":return{id:n,timestamp:a,validationResult:s};case"customer":case"owner":case"lookup":case"regarding":let t=null;return n instanceof i.a?t=n:(n instanceof T.a||n&&n.entityName&&n.id&&n.name)&&(t=new i.a(n.entityName,new o.a(n.id),n.name)),{reference:t,timestamp:a,validationResult:s};case"partylist":let c=[];return c=n&&n.map?n.map(e=>z(e)):[z(n)],{list:c,validationResult:s};case"date":case"datetime":return{value:n?n.toISOString():null,formatted:r,timestamp:a,validationResult:s};case"multiselectpicklist":const l=(e,t)=>e-t;let u;return u=Array.isArray(n)?n.length>0?n.sort(l).join(","):null:n,{value:u,formatted:r,timestamp:a,validationResult:s};default:return{value:n,formatted:r,timestamp:a,validationResult:s}}}function q(e,t,n,r,i,d,g,f,m,b,_){var y;const v={},S=Object(p.e)(e,w.a),O=Object(A.g)(e,f);for(const p in r){const C=r[p];if(!C)continue;let E=null,w=null;if(E=C.value,C.value&&C.value.formatted&&(w=C.value.formatted),p===U){let e=null;e=E&&E instanceof o.a?E:o.a.tryParseOrNull(E);const t={isValueValid:!1,userInput:null,errorMessage:null,errorId:null,isOfflineSyncError:!1},n=W(U,"uniqueidentifier",e,null,new Date,t);v[p]=n;continue}const T=f?Object(j.j)(e,f,d,n.etn,p):Object(l.a)(e,n.etn,p);if(!T&&g){H(e,n,p,f,d,g,r,i);continue}"uniqueidentifier"!==T.Type||!E||E instanceof o.a||(E=o.a.tryParseOrNull(E));let N=null;if("money"===T.Type&&!T.IsBaseCurrency){const r="transactioncurrencyid";N=Object(s.d)(e,t,n,r)}const A=Object(c.z)(e,T,N,E),R=A.controlAttributes.Behavior;A.controlAttributes.Behavior=x.a.None;let k=w||Object(c.x)(E,A,S);A.controlAttributes.Behavior=R;let L=Object(c.D)(k,A,A.cultureInfo,A.controlAttributes.Format,S);J(T)&&L&&L.getTime&&(null==E?void 0:E.getSeconds)&&(L=new Date(L.getTime()+1e3*new Date(E).getSeconds())),(h(T)||K(L)&&!Q(E))&&(L=E);const z=O&&O.isOfflineSyncError,q=Object(j.z)(e,f,d,T.LogicalName),$=null!==(y=null==q?void 0:q.every(t=>Object(j.t)(e,{id:f,controlName:t},d)))&&void 0!==y&&y;let Z=I(L,T,S,$,A,z);const ee=T.Type.toLowerCase(),te=Object(s.d)(e,t,n,p);Z.isValueValid||X(T)||(k=Object(a.c)(te),L=Object(a.e)(te),void 0===E&&(Z=I(L,T,S,$,A,z)),Z.isValueValid||"money"!==ee||(Z.userInput=E));let ne=W(p,T.Type,L,k,new Date,Z);if(_||V(te,ne,!0)){if(J(T)){const e=I(L,T,S,$,A,z);ne=W(p,T.Type,L,k,new Date,e)}else"partylist"===ee&&Object(M.a)(e,F.ce)&&G(e,t,p,O.entityTypeName,O.id,ne);if(v[p]=ne,i&&Z&&!Z.isValueValid&&(!Object(u.a)(Z.userInput)||X(T))||Z&&Z.isValueValid){const t=Object(j.z)(e,f,d,p,b);if(t)for(const n of t){const t=Z.isValueValid&&!Y(e,n,f,d);m(Object(P.b)(f,n,t,d))}Z&&Z.isValueValid&&m(Object(D.b)(d,f,Object(B.d)(f,p)))}}}return v}function H(e,t,n,r,a,i,s,c){const u=[],d=!!Object(l.a)(e,t.etn,n),p=Object(j.ab)(e,r,a),g=p&&p.hasOwnProperty(n),h=Object(R.v)(a),f=Object(j.Zb)(e,r),m=Object(j.fb)(e,{id:r},a);u.push({name:"Page Id",value:r},{name:"formId",value:o.a.toString(null==m?void 0:m.Id)},{name:"formName",value:null==m?void 0:m.Name},{name:"formLabel",value:null==m?void 0:m.Label},{name:"Attribute Name",value:n},{name:"isUpdatingFieldValue",value:c},{name:"attributeValuePairs",value:s?Object.keys(s).toString():"null"},{name:"Is Attribute part of Entity Attributes",value:d},{name:"Is Attribute part of Form Attributes",value:g},{name:"Entity Type Name",value:t?t.etn:"entityReference is null"},{name:"contextKey",value:h},{name:"page",value:f?"not null":"null"},{name:"page.metadata",value:f&&f.metadata?"not null":"null"},{name:"Object.keys(page.metadata)",value:f&&f.metadata?Object.keys(f.metadata).toString():"null"},{name:"page.metadata[contextKey].attributes",value:f&&f.metadata&&f.metadata[h]&&f.metadata[h].attributes?Object.keys(f.metadata[h].attributes).toString():"null"}),i.error("Attribute Descriptor is null in getChanges",u)}function G(e,t,n,r,c,l){var u,d,p,g,h;if("email"!==r||o.a.isNullOrEmpty(c)||!n||!Object(M.a)(e,F.ce))return;const f=new i.a(r,c);let m=null;const b=Object(s.d)(e,t,f,k.v);if((null==b?void 0:b.valueString)&&"1"!==(null==b?void 0:b.valueString)){const t=Object(L.j)(e,f,n);t&&(m=Object(a.e)(t));const r=Object(a.e)(l);if(!r||!m||r.length!==m.length)return;let i=!1;for(let e=0;e<m.length;e++){const t=m[e].fields.partyid,n=r[e].fields.partyid,a=m[e].fields.addressused;if((null===(u=null==t?void 0:t.reference)||void 0===u?void 0:u.etn)&&"unresolvedaddress"!==t.reference.etn&&(null===(d=null==n?void 0:n.reference)||void 0===d?void 0:d.id)&&!o.a.equals(n.reference.id,t.reference.id))return;(!t&&(null==a?void 0:a.value)||"unresolvedaddress"===(null===(p=null==t?void 0:t.reference)||void 0===p?void 0:p.etn))&&(null===(g=null==n?void 0:n.reference)||void 0===g?void 0:g.etn)&&"unresolvedaddress"!==(null===(h=null==n?void 0:n.reference)||void 0===h?void 0:h.etn)&&(i=!0)}if(!i)return;for(let e=0;e<m.length;e++)m[e].fields&&r[e].fields&&(r[e].fields.activitypartyid=m[e].fields.activitypartyid)}}function K(e){return null==e}function Q(e){return K(e)||""===e}function X(e){return 2===e.RequiredLevel||1===e.RequiredLevel}function Y(e,t,n,r){const a=Object(j.A)(e,{controlName:t,id:n},r);return a&&Object.keys(a).some(e=>{if(a[e].notificationLevel===N.a.error)return!0})}function J(e){var t;const n=null===(t=null==e?void 0:e.Type)||void 0===t?void 0:t.toLowerCase();return"date"===n||"dateonly"===n||"datetime"===n||"dateandtime"===n}},JPoD:function(e,t,n){"use strict";n.d(t,"k",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"i",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"l",(function(){return p})),n.d(t,"h",(function(){return g})),n.d(t,"g",(function(){return h}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="syncerror",a="activitymimeattachment",i="activityparty",o="activitypointer",s="annotation",c="attachment",l="businessdatalocalizedlabel",u="postfollow",d="product",p="template",g="offlinecommanddefinition",h="businessprocessflowinstance"},JRzo:function(e,t,n){"use strict";n.d(t,"i",(function(){return r})),n.d(t,"j",(function(){return a})),n.d(t,"k",(function(){return i})),n.d(t,"m",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"l",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return h})),n.d(t,"n",(function(){return f})),n.d(t,"e",(function(){return m})),n.d(t,"o",(function(){return b}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Dialog_Reauthenticate_Dialog_Description",a="Dialog_Reauthenticate_Dialog_Expired_Description",i="Dialog_Reauthenticate_Dialog_Expired_Description_Embedded",o="Dialog_Reauthenticate_Signin_Button",s="Dialog_Reauthenticate_Cancel_Button",c="Dialog_Reauthenticate_Close_Button",l="Brand_CRM_Online",u="Brand_CRM",d="Dialog_AuthError_Dialog_Title",p="Dialog_AuthError_Dialog_Description",g="common.scripts.global.js.PopupBlockerError",h="common.scripts.global.js.PopupBlockerError",f="ErrorIconAltWarning",m="ErrorIconAltInformation",b=[r,a,i,o,s,c,l,u,f,m,d,p,g]},JTy6:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the LookupDialog page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="LookupDialog"},JUjK:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Equals=0]="Equals",e[e.NotEquals=1]="NotEquals",e[e.LessThan=2]="LessThan",e[e.LessThanEqualTo=3]="LessThanEqualTo",e[e.GreaterThan=4]="GreaterThan",e[e.GreaterThanEqualTo=5]="GreaterThanEqualTo",e[e.IsNull=6]="IsNull",e[e.In=7]="In"}(r||(r={}))},JVKK:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="clear.pageNotificationAction";function a(e,t){return{type:"clear.pageNotificationAction.async",execute({dispatch:n}){const a={type:r,payload:{UniqueId:e},meta:{pageId:t}};return Promise.resolve(n(a))}}}},JZmp:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("qK01"),a=n("iLty"),i=n("nxt5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t){return{type:"DESERIALIZE_DELTE_RESPONSE_ASYNC",execute({dispatch:e,getState:n},o){const s=t instanceof r.a?new a.a(null):new i.a(null);return Promise.resolve(s)}}}},JdSN:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("/Ndy"),a=n("504W"),i=n("6K5O"),o=n("eruq"),s=n("RiLc");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class c extends r.a{constructor(e,t,n){if(super(e,t,n),this._organizationServiceFault=null,this._isErrorInOffline=!1,this._contentId=0,this._clientRequestId=null,this._serverResponseId=null,this._retryAfter=null,Object(a.a)(e)||4!==e.readyState)Object(a.b)(n)||(this._organizationServiceFault=s.b.parseFromJson(n));else if("parsererror"===t&&!Object(a.a)(n)&&(n.indexOf(r.a.HtmlHeader)>-1||n.toLowerCase().indexOf(r.a.HtmlHeader.toLowerCase())>-1))this._organizationServiceFault=s.b.parseFromHtml(n.substr(n.indexOf("<")));else{if(this._organizationServiceFault=Object(a.a)(e.responseXML)?null:s.b.parseFromXml(Object(o.a)(e.responseXML)),null===this._organizationServiceFault&&!Object(a.a)(e.responseText)){const t=Object(o.b)(e.responseText);Object(a.a)(t)||(this._organizationServiceFault=s.b.parseFromXml(Object(o.a)(t)))}null!==this._organizationServiceFault||Object(a.a)(e.responseText)||(this._organizationServiceFault=s.b.parseFromJson(e.responseText))}if(this._organizationServiceFault&&this._organizationServiceFault.get_messages()&&this._organizationServiceFault.get_messages().length){const e=new Sys.StringBuilder("Error Messages: \n");for(let t=0;t<this._organizationServiceFault.get_messages().length;t++)e.append(t+1+": "+this._organizationServiceFault.get_messages()[t]+"\n");Object(i.a)(e.toString())}}get_organizationServiceFault(){return this._organizationServiceFault}set_organizationServiceFault(e){return this._organizationServiceFault=e,e}get_isErrorInOffline(){return this._isErrorInOffline}set_isErrorInOffline(e){return this._isErrorInOffline=e,e}get_isRequestTooLong(){return this._isRequestTooLong}set_isRequestTooLong(e){return this._isRequestTooLong=e,e}get_contentId(){return this._contentId}set_contentId(e){return this._contentId=e,e}get_clientRequestId(){return this._clientRequestId}set_clientRequestId(e){return this._clientRequestId=e,e}get_serverResponseId(){return this._serverResponseId}set_serverResponseId(e){return this._serverResponseId=e,e}get_retryAfter(){return this._retryAfter}set_retryAfter(e){return this._retryAfter=e,e}get_responseMessage(){return Object(a.a)(this._organizationServiceFault)?super.get_responseMessage():this._organizationServiceFault.get_messages()[0]}static fromErrorCode(e){const t=new c(null,"","");return t._organizationServiceFault=s.b.fromErrorCode(e),t}static createFromHtml(e,t){let n=null;return n=t?new c(t,t.statusText,e):new c(null,"",""),(e.indexOf(r.a.HtmlHeader)>-1||e.toLowerCase().indexOf(r.a.HtmlHeader.toLowerCase())>-1)&&(n._organizationServiceFault=s.b.parseFromHtml(e.substr(e.indexOf("<"))),n.set_isRequestTooLong(e.indexOf("Bad Request - Request Too Long")>-1)),n}}},JhlA:function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"g",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"k",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return g})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"i",(function(){return p}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="offline_notification_text_header",a="offline_notification_text_body",i="offline_notification_reconnect_fail_text_body",o="offline_ui_blocker_notification_text_header",s="offline_ui_blocker_notification_text_body",c="offline_notification_reconnect_btn_text",l="offline_notification_cancel_btn_text",u="offline_notification_reconnect_success_text",d="offline_notification_reconnect_progress_indicator_text",p="offline_notification_user_offline_mode_text",g=[r,a,i,o,s,c,l,u,d,p]},Jj4w:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");class a extends r.a{constructor(e,t,n){super(),this._entityMoniker=null,this._targetEntityName=null,this._targetFieldType=0,this._entityMoniker=e,this._targetEntityName=t,this._targetFieldType=n}get_name(){return"InitializeFrom"}get_entityMoniker(){return this._entityMoniker}get_targetEntityName(){return this._targetEntityName}get_targetFieldType(){return this._targetFieldType}}},Jsfi:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.String=1]="String",e[e.Attribute=2]="Attribute"}(r||(r={}))},Jz1I:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("nxt5");class a extends r.a{constructor(e){super("ExecuteQuickFind"),this._result=null,this._result=e}get_result(){return this._result}}},Jz2d:function(e,t,n){"use strict";n.d(t,"a",(function(){return _e}));var r=n("Z6YS"),a=n("rWW8"),i=n("fskq"),o=n("IKHO"),s=n("84PK"),c=n("504W"),l=n("NMtn"),u=n("gg/8"),d=n("jPIj"),p=n("2mBq"),g=n("eruq");class h{constructor(e){this._nodes=null,this._nodes=e}get_count(){return this._nodes.length}get_item(e){return this._nodes[e]}}class f extends d.a{constructor(e,t,n){if(super(),this._mainNode=null,this._metadataNodes=null,this._isMetadataValueNode=!1,this._xml=null,this._xml=e,Object(c.a)(t)){let t=e.match(f._contractsAliasRegularExpression);const n=t[1];t=e.match(new RegExp("xmlns:([\\w]+)=[\"']"+f._GenericCollectionsNamespace+"[\"']"));const r=t[1];t=e.match(new RegExp("xmlns:([\\w]+)=[\"']"+f._Xrm2011MetadataNamespace+"[\"']"));const a=t[1];t=e.match(new RegExp("xmlns:([\\w]+)=[\"']"+f._XmlSchemaNamespace+"[\"']"));const i=t[1],o=Object(p.a)("<{0}:EntityMetadata>",n),s=Object(p.a)("</{0}:EntityMetadata>",n),c=e.indexOf(o),l=e.lastIndexOf(s);if(c<0||l<0||c>=l)throw Error.argument("Not a valid RetrieveMetadataChanges response XML");this._mainNode=Object(g.a)(Object(g.b)(e.substring(0,c)+f._PlaceholderNodeXml+e.substring(l+s.length,e.length)));const u=String.format("<{0}:EntityMetadata xmlns:{0}='{1}' xmlns:{2}='{3}' xmlns:{4}='{5}' xmlns:{6}='{7}'>",n,f._Xrm2011ContractsNamespace,r,f._GenericCollectionsNamespace,a,f._Xrm2011MetadataNamespace,i,f._XmlSchemaNamespace);let d=c;const h=[];for(;d>0;){const t=Object(g.b)(u+e.substring(d+o.length,e.indexOf(s,d)+s.length));h.push(Object(g.a)(t).childNodes().get_item(0)),d=e.indexOf(o,d+1)}this._metadataNodes=h}else this._mainNode=t,this._metadataNodes=n;this._isMetadataValueNode=f._IsMetadataValueNode(this._mainNode)}get_domParserElement(){return this._mainNode.get_domParserElement()}get_innerText(){return this._mainNode.get_innerText()}get_outerXml(){if(Object(c.a)(this._xml)&&(this._xml=this._mainNode.get_outerXml(),this._xml.indexOf(f._PlaceholderNodeXml)>=0)){const e=this._xml.match(f._contractsAliasRegularExpression)[1],t=new Sys.StringBuilder;for(const n of this._metadataNodes)t.append(Object(p.a)("<{0}:EntityMetadata>",e)),t.append(n.childNodes().get_item(0).get_outerXml()),t.append(Object(p.a)("</{0}:EntityMetadata>",e));this._xml=this._xml.replace(f._PlaceholderNodeXml,t.toString())}return this._xml}get_tagName(){return this._mainNode.get_tagName()}addNamespace(e,t){this._mainNode.addNamespace(e,t);for(const n of this._metadataNodes)n.addNamespace(e,t)}selectSingleNode(e){if(e.indexOf("a:EntityMetadata")>=0)throw Error.argumentOutOfRange("expression",e,"This XmlNode implementation doesn't support queries for EntityMetadata");return new f(null,this._mainNode.selectSingleNode(e),this._metadataNodes)}selectNodes(e){if(".//a:KeyValuePairOfstringanyType[b:key='EntityMetadata']/b:value/a:EntityMetadata"===e)return new h(this._metadataNodes);if(".//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value[@i:type='a:EntityMetadataCollection']/a:EntityMetadata/c:Attributes/c:AttributeMetadata"===e){const t=e.substring(e.indexOf("a:EntityMetadata/")+17,e.length),n=[];for(const e of this._metadataNodes){const r=e.selectNodes(t);for(let e=0;e<r.get_count();e++)n.push(r.get_item(e))}return new h(n)}if(e.indexOf("a:EntityMetadata")>=0)throw Error.argumentOutOfRange("expression",e,"This XmlNode implementation doesn't support arbitrary queries for EntityMetadata");return this._mainNode.selectNodes(e)}getAttribute(e){return this._mainNode.getAttribute(e)}getElementsByTagName(e){const t=[];let n=this._mainNode.getElementsByTagName(e);for(let e=0;e<n.get_count();e++)t.push(new f(null,n.get_item(e),this._metadataNodes));for(const r of this._metadataNodes){n=r.getElementsByTagName(e);for(let e=0;e<n.get_count();e++)t.push(n.get_item(e))}return new h(t)}childNodes(){if(this._isMetadataValueNode)return new h(this._metadataNodes);const e=this._mainNode.childNodes(),t=[];for(let n=0;n<e.get_count();n++)t.push(new f(null,e.get_item(n),this._metadataNodes));return new h(t)}hasChildNodes(){return this._isMetadataValueNode?this._metadataNodes.length>0:this._mainNode.hasChildNodes()}static _IsMetadataValueNode(e){return!Object(c.a)(e.get_tagName())&&(e.get_tagName().endsWith(":value")||"value"===e.get_tagName())&&e.get_domParserElement().namespaceURI===f._GenericCollectionsNamespace&&e.hasChildNodes()&&"placeholder"===e.childNodes().get_item(0).get_tagName()}}f._PlaceholderNodeXml="<placeholder/>",f._Xrm2011MetadataNamespace="http://schemas.microsoft.com/xrm/2011/Metadata",f._Xrm2011ContractsNamespace="http://schemas.microsoft.com/xrm/2011/Contracts",f._GenericCollectionsNamespace="http://schemas.datacontract.org/2004/07/System.Collections.Generic",f._XmlSchemaNamespace="http://www.w3.org/2001/XMLSchema-instance",f._contractsAliasRegularExpression=new RegExp("xmlns:([\\w]+)=[\"']"+f._Xrm2011ContractsNamespace+"[\"']");var m=n("jYot"),b=n("nxt5"),_=n("AWUt"),y=n("fVHw");function v(e,t){if(!Object(c.a)(e)){ne(e);let t=null;if(t=e.selectSingleNode(".//a:Results"),!Object(c.a)(t)){const e=t.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='id']/b:value"),n=Object(c.a)(e)?null:new s.a(e.get_innerText()),r=t.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='EntityReference']/b:value"),a=Object(c.a)(r)?null:Object(_.a)(r);return new y.a(n,a)}}return null}var S=n("V482"),O=n("RiLc");var C=n("XgcG");function E(e,t){if(!Object(c.a)(e)){ne(e);let n=null;if(n=e.selectSingleNode(".//a:Results"),!Object(c.a)(n)){const e=n.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='IsFaulted']/b:value");let r;if(Object(c.a)(e))throw Error.notImplemented();r=Boolean.parse(e.get_innerText()).valueOf();const a=n.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Responses']/b:value"),i=Object(c.a)(a)?null:function(e,t){const n=t.get_requests(),r=[];e.addNamespace("c","http://schemas.microsoft.com/xrm/2012/Contracts");const a=e.selectNodes("c:ExecuteMultipleResponseItem");for(let e=0;e<a.get_count();e++){let t=null,i=null;const o=a.get_item(e).selectSingleNode("c:Fault");Object(c.a)(o)||"true"===o.getAttribute("i:nil")||(t=O.b.parseFromXml(o));const s=Number.parseInvariant(a.get_item(e).selectSingleNode("c:RequestIndex").get_innerText()),l=a.get_item(e).selectSingleNode("c:Response");Object(c.a)(l)||"true"===l.getAttribute("i:nil")||(i=te(l.selectSingleNode("a:ResponseName").get_innerText(),l,n[s])),r.push(new S.a(t,s,i))}return r}(a,t);return new C.a(r,i)}}return null}var I=n("a1q1"),w=n("kToj"),j=n("c46F"),P=n("Cjdz"),T=n("WF3G");function N(e){if("a:QuickFindResult"===e.get_tagName()){const t=e.selectSingleNode("a:Data");if(t){const n=Object(P.c)(t,new T.a("")),r=Number.parseInvariant(e.selectSingleNode("a:ErrorCode").get_innerText()),a=t.selectSingleNode("a:EntityName").get_innerText();return new j.a(a,n,r)}}return Object(w.a)(!0,"Unknown xml format for QuickFindResult"),null}var A=n("Jz1I");function D(e,t){if(!Object(c.a)(e)){ne(e),e.addNamespace("c","http://schemas.datacontract.org/2004/07/System.Collections.Generic");const t=e.selectSingleNode(".//a:Results");if(!Object(c.a)(t)){const e=t.selectSingleNode(".//a:KeyValuePairOfstringanyType[c:key='Result']/c:value[@i:type='a:QuickFindResultCollection']");if(!Object(c.a)(e)){const t=function(e){if(Object(c.a)(e))return null;const t=new Array(0),n=e.selectNodes("a:QuickFindResult");for(let e=0;e<n.get_count();e++){const r=n.get_item(e);t[t.length]=N(r)}return new I.a(t)}(e);return new A.a(t)}}}return null}var R=n("Qwz5"),x=n("lx8z");function M(e,t){if(!Object(c.a)(e)){ne(e);let t=null;if(t=e.selectSingleNode(".//a:Results"),!Object(c.a)(t)){let e=null,n=t.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Entity']/b:value");if(!Object(c.a)(n)){const t=n.selectSingleNode("entity");Object(c.a)(t)||(n=t),e=Object(R.b)(n)}return new x.a(e)}}return null}class F extends b.a{constructor(e){super("RetrieveEntitiesForAggregateQuery"),this._entityCollection=null,this._entityCollection=e}get_entityCollection(){return this._entityCollection}}function k(e,t){if(!Object(c.a)(e)){ne(e);let t=null;if(t=e.selectSingleNode(".//a:Results"),!Object(c.a)(t)){const e=t.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='EntityCollection']/b:value[@i:type='a:EntityCollection']");let n=null;return Object(c.a)(e)||(n=Object(P.c)(e,T.a.get_empty())),new F(n)}}return null}var L=n("jxo7");function B(e,t){if(!Object(c.a)(e)){ne(e);let n=null;if(n=e.selectSingleNode(".//a:Results"),!Object(c.a)(n)){const e=n.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='EntityCollection']/b:value[@i:type='a:EntityCollection']");let r=null;return Object(c.a)(e)||(r=Object(P.c)(e,new T.a(t.get_query()))),new L.a(r)}}return null}var U=n("g73c"),V=n("Y2Yg"),z=n("wo7m");function W(e,t){if(!Object(c.a)(e)){ne(e);let t=null;if(t=e.selectSingleNode(".//a:Results"),!Object(c.a)(t)){const e=t.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='AccessRights']/b:value");let n=0;if(Object(c.a)(e))throw Error.notImplemented();{const t=e.get_innerText().split(" ");for(const e of t)n|=Object(U.b)(V.a,e)}return new z.a(n)}}return null}var q=n("7O3c");function H(e,t){if(!Object(c.a)(e)){ne(e);let t=null;if(t=e.selectSingleNode(".//a:Results"),!Object(c.a)(t)){let e=null,n=t.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Entity']/b:value");if(!Object(c.a)(n)){const t=n.selectSingleNode("entity");Object(c.a)(t)||(n=t),e=Object(R.b)(n)}let r=null,a=t.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='GlobalNavigationData']/b:value");if(!Object(c.a)(a)){const e=a.selectSingleNode("entity");Object(c.a)(e)||(a=e),r=Object(R.b)(a)}let i=null;const o=t.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='BpfDefinitionVersionNumber']/b:value");return Object(c.a)(o)||(i=o.get_innerText()),new q.a(e,r,i)}}return null}var G=n("S/Br"),K=n("I8bZ");function Q(e){if(Object(c.a)(e))return null;let t=0;const n=e.selectSingleNode("b:Severity");n&&(t=Object(U.a)(K.a,n.get_innerText()));let r="";const a=e.selectSingleNode("b:Message");return a&&(r=a.get_innerText()),new G.a(t,r)}var X=n("/d6W");function Y(e,t){if(!Object(c.a)(e)){ne(e);let n=null;if(n=e.selectSingleNode(".//a:Results"),!Object(c.a)(n)){let e=null,r=n.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Entity']/b:value");if(!Object(c.a)(r)){const n=r.selectSingleNode("entity");Object(c.a)(n)||(r=n),e=Object(R.b)(r,t.get_relatedEntitiesQuery());const a=Object(c.a)(e.get_relatedEntities())?new Array(0):e.get_relatedEntities().get_relatedEntityQueries();e.updateColumnSet(t.get_columnSet(),a)}const a=n.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Notifications']/b:value"),i=Object(c.a)(a)?null:function(e){if(Object(c.a)(e))return null;const t=new Array(0),n=e.selectNodes("b:BusinessNotification");if(n)for(let e=0;e<n.get_count();e++){const r=n.get_item(e);t[t.length]=Q(r)}return t}(a);return new X.a(e,i)}}return null}var J=n("LtP7");function $(e,t){if(!Object(c.a)(e)){ne(e);let t=null;if(t=e.selectSingleNode(".//a:Results"),!Object(c.a)(t)){const e=t.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='EntityReference']/b:value"),n=Object(c.a)(e)?null:Object(_.a)(e);return new J.a(n)}}return null}const Z={};function ee(e,t){Z[e]=t}function te(e,t,n){return e in Z?Z[e](t,n):new b.a(n.get_name())}function ne(e){e.addNamespace("s","http://schemas.xmlsoap.org/soap/envelope"),e.addNamespace("d","http://schemas.microsoft.com/xrm/2011/Contracts/Services"),e.addNamespace("a","http://schemas.microsoft.com/xrm/2011/Contracts"),e.addNamespace("b","http://schemas.datacontract.org/2004/07/System.Collections.Generic"),e.addNamespace("i","http://www.w3.org/2001/XMLSchema-instance")}ee("Create",v),ee("ExecuteMultiple",E),ee("ExecuteQuickFind",D),ee("InitializeFrom",M),ee("RetrieveEntitiesForAggregateQuery",k),ee("RetrieveMultiple",B),ee("RetrievePrincipalAccess",W),ee("RetrieveProcessControlData",H),ee("Retrieve",Y),ee("Update",$);var re=n("RIwK"),ae=n("uu/V"),ie=n("DS+G"),oe=n("JdSN"),se=n("iLty"),ce=n("IdrN"),le=n("sjhR");class ue extends se.a{constructor(e,t){if(super(e),this._entityCollection=null,e){const n=e.selectSingleNode(".//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value[@i:type='a:EntityCollection']");this._set_entityCollection(Object(P.c)(n,t));const r=n.selectSingleNode("a:PagingCookie");r&&!Object(c.b)(r.get_innerText())&&t.set_PagingCookie(r.get_innerText());for(let e=0;e<this.get_entityCollection().get_count();e++)this.get_entityCollection().get_item(e).updateColumnSet(t.get_ColumnSet())}}get_entityCollection(){return this._entityCollection}_set_entityCollection(e){return this._entityCollection=e,e}}var de=n("Xe7f"),pe=n("hirD"),ge=n("91WF"),he=n("PF3G"),fe=n("0mlq"),me=n("EW4s"),be=n("Rckk");class _e extends r.a{constructor(e,t,n,r){super(e,t,n,r),Object(l.d)(e,"serverUri"),Object(l.d)(t,"remoteCallRetryHandler"),this._userLanguageCode=0,this._organizationWebEndPoint=this.get_serverUrl()+_e._OrganizationWebServiceUrl,this._processControlEndPoint=this.get_serverUrl()+_e._ProcessControlServiceUrl,this._customerServiceEndPoint=this.get_serverUrl()+_e._CustomerServiceUrl,this._sdkClientVersion=Object(u.a)()}get_name(){return"CrmSoapService"}get_performanceStopwatch(){return i.a}_get_organizationWebEndPoint(){return this._organizationWebEndPoint}get_clientVersion(){return this._sdkClientVersion}RetrieveUserContext(e,t){throw Error.notImplemented()}GetIsActivityFlags(){throw Error.notImplemented()}Execute(e,t){const n=new me.a;let i,o,l;e instanceof ge.a?(l=this.get_serverUrl()+ge.a.scriptErrorRelativeWebEndpointUrl,i=e.requestBody(),o=ge.a.scriptErrorSendReportSoapAction):(l=this._get_organizationWebEndPoint(),i=this.createCrmExecuteRequestBody(e.get_name(),e.get_name()+"Request",Object(m.d)(e),"b",e.get_xmlNamespace()),o="http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute");let u=null;if(e instanceof pe.a){u=new Array(0);for(const t of e.get_requests())u.push(t.get_name())}const d=this.createSoapRequestOptions(l,o),p=t instanceof a.a&&!Object(c.a)(t.RequestId())?t.RequestId():s.a.newGuid().toString();return r.a.addRequestId(d,p),this.executeSoapRequest(fe.a.create(e.get_name(),i,d,t,u)).then(t=>{n.resolve(te(e.get_name(),t,e))},e=>{n.reject(e)}),n}ExecuteOData(e,t){throw Error.notImplemented()}WhoAmI(){const e=this.createCrmExecuteRequestBody("WhoAmI","WhoAmIRequest",null,"b",_e._crm2011ContractsNamespace),t=new me.a;return this.executeSoapRequest(fe.a.create("WhoAmI",e,this.createSoapRequestOptions(this._get_organizationWebEndPoint(),_e._ExecuteSoapAction))).then(e=>{t.resolve(new b.a("WhoAmI"))},e=>{t.reject(e)}),t}RetrieveMultiple(e,t){const n=this.createCrmExecuteRequestBody("RetrieveMultiple","RetrieveMultipleRequest",'<a:KeyValuePairOfstringanyType><b:key>Query</b:key><b:value i:type="a:FetchExpression"><a:Query>'+Object(re.b)(e.get_FetchXml())+"</a:Query></b:value></a:KeyValuePairOfstringanyType>"),r=new me.a;return this.executeSoapRequest(fe.a.create("RetrieveMultiple",n,this.createSoapRequestOptions(this._get_organizationWebEndPoint(),_e._ExecuteSoapAction),t)).then(t=>{r.resolve(new ue(t,e))},e=>{r.reject(e)}),r}Create(e,t,n){const r=new me.a;return this.Execute(new de.a(e,t)).then(t=>{e.resetChanges(),r.resolve(t)},e=>{r.reject(e)}),r}Update(e,t,n){const r=new me.a;return this.Execute(new he.a(e,t)).then(t=>{e.resetChanges(),r.resolve(t)},e=>{r.reject(e)}),r}DeleteEntity(e,t){const n=this._CreateCrmRequestBody("Delete","<entityName>"+Object(re.b)(e.LogicalName)+"</entityName><id>"+Object(re.b)(e.Id.toString())+"</id>"),r=new me.a;return this.executeSoapRequest(fe.a.create("Delete",n,this.createSoapRequestOptions(this._get_organizationWebEndPoint(),_e._DeleteSoapAction),t)).then(e=>{r.resolve(new se.a(e))},e=>{r.reject(e)}),r}retrieveEntityMetadata(e,t,n){const r=this.createCrmExecuteRequestBody(_e._RetrieveMetadataChangesRequestName,_e._RetrieveMetadataChangesRequestName+"Request",'<a:KeyValuePairOfstringanyType><b:key>Query</b:key><b:value i:type="c:EntityQueryExpression" xmlns:c="http://schemas.microsoft.com/xrm/2011/Metadata/Query"><c:Criteria><c:Conditions><c:MetadataConditionExpression><c:ConditionOperator>Equals</c:ConditionOperator><c:PropertyName>LogicalName</c:PropertyName><c:Value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">'+Object(re.b)(e)+'</c:Value></c:MetadataConditionExpression></c:Conditions><c:FilterOperator>And</c:FilterOperator><c:Filters /></c:Criteria><c:Properties><c:AllProperties>false</c:AllProperties><c:PropertyNames xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/Arrays">'+_e._get_EntityMetadataPropertyNames()+'</c:PropertyNames></c:Properties><c:AttributeQuery i:nil="true" /><c:LabelQuery><c:FilterLanguages xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><d:int>'+t+'</d:int></c:FilterLanguages><c:MissingLabelBehavior>1</c:MissingLabelBehavior></c:LabelQuery><c:RelationshipQuery i:nil="true" /></b:value></a:KeyValuePairOfstringanyType>'),a=new me.a;return this.executeSoapRequest(fe.a.create(_e._RetrieveMetadataChangesRequestName,r,this.createSoapRequestOptions(this._get_organizationWebEndPoint(),_e._ExecuteSoapAction),n)).then(e=>{a.resolve(new ce.a(e))},e=>{a.reject(e)}),a}RetrieveMultipleAttributeMetadata(e,t,n){let r='<a:KeyValuePairOfstringanyType><b:key>Query</b:key><b:value i:type="c:EntityQueryExpression" xmlns:c="http://schemas.microsoft.com/xrm/2011/Metadata/Query"><c:Criteria><c:Conditions><c:MetadataConditionExpression><c:ConditionOperator>Equals</c:ConditionOperator><c:PropertyName>LogicalName</c:PropertyName><c:Value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">'+Object(re.b)(e.get_EntityLogicalName())+'</c:Value></c:MetadataConditionExpression></c:Conditions><c:FilterOperator>And</c:FilterOperator><c:Filters /></c:Criteria><c:Properties><c:AllProperties>false</c:AllProperties><c:PropertyNames xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><d:string>Attributes</d:string></c:PropertyNames></c:Properties><c:AttributeQuery><c:Criteria>';if(Object(c.a)(e.get_AttributeNames()))r+="<c:Conditions />";else{r+="<c:Conditions>";for(const t of e.get_AttributeNames())r+='<c:MetadataConditionExpression><c:ConditionOperator>Equals</c:ConditionOperator><c:PropertyName>LogicalName</c:PropertyName><c:Value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">'+Object(re.b)(t)+"</c:Value></c:MetadataConditionExpression>";r+="</c:Conditions>"}r+='<c:FilterOperator>Or</c:FilterOperator><c:Filters /></c:Criteria><c:Properties><c:AllProperties>false</c:AllProperties><c:PropertyNames xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/Arrays">'+_e._get_AttributeMetadataPropertyNames()+'</c:PropertyNames></c:Properties></c:AttributeQuery><c:LabelQuery><c:FilterLanguages xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><d:int>'+t+'</d:int></c:FilterLanguages><c:MissingLabelBehavior>1</c:MissingLabelBehavior></c:LabelQuery><c:RelationshipQuery i:nil="true" /></b:value></a:KeyValuePairOfstringanyType>',r=this.createCrmExecuteRequestBody(_e._RetrieveMetadataChangesRequestName,_e._RetrieveMetadataChangesRequestName+"Request",r);const a=new me.a;return this.executeSoapRequest(fe.a.create(_e._RetrieveMetadataChangesRequestName,r,this.createSoapRequestOptions(this._get_organizationWebEndPoint(),_e._ExecuteSoapAction),n)).then(e=>{a.resolve(new le.a(e))},e=>{a.reject(e)}),a}retrieveNavigationEntities(e,t,n,r,a){const i=this._processControlEndPoint+"GetForwardNavigationEntities",o=JSON.stringify({currentEntityId:e,referencedEntityLogicalName:t,referencingEntityLogicalName:n,referencingEntityAttributeName:r}),s=new me.a;return this.executeJsonRequest(fe.a.create(i,o,this.createJsonRequestOptions(i),a)).then(e=>{s.resolve(this._CreateJsonResponse(e))},e=>{s.reject(e)}),s}changeProcessAndStage(e,t,n,r,a,i){const o=this._processControlEndPoint+"ChangeProcessAndStageMoca",s=JSON.stringify({currentEntityId:e,currentEntityTypeName:t,newProcessId:n,newStageId:r,traversedPath:a}),c=new me.a;return this.executeJsonRequest(fe.a.create(o,s,this.createJsonRequestOptions(o),i)).then(e=>{c.resolve(this._CreateJsonResponse(e))},e=>{c.reject(e)}),c}createNavigationEntity(e,t,n,r,a){const i=this._processControlEndPoint+"CreateForwardNavigationEntity",o=JSON.stringify({sourceEntityLogicalName:e,sourceEntityId:t.toString(),targetEntityLogicalName:n,targetEntityAttributeName:r}),s=new me.a;return this.executeJsonRequest(fe.a.create(i,o,this.createJsonRequestOptions(i),a)).then(e=>{s.resolve(this._CreateJsonResponse(e))},e=>{s.reject(e)}),s}GetClientMetadata(e,t){throw Error.notImplemented()}SyncClientMetadata(e){throw Error.notImplemented()}GetRecentItems(e,t,n,r,a,i,o){throw Error.notImplemented()}UpdateRecentItems(e,t){throw Error.notImplemented()}RetrieveUserLocalFacets(e,t){const n=new me.a,r=this._customerServiceEndPoint,a=this.createSoapRequestBody('<GetLocalFacets xmlns="http://schemas.microsoft.com/crm/2009/WebServices"><entityName>'+e+"</entityName></GetLocalFacets>"),i=this.createSoapRequestOptions(r,"http://schemas.microsoft.com/crm/2009/WebServices/GetLocalFacets");return this.executeSoapRequest(fe.a.create("GetLocalFacets",a,i,t)).then(e=>{const t=e.childNodes().get_item(0).childNodes().get_item(0).childNodes().get_item(0).childNodes().get_item(0);n.resolve({Value:t.get_innerText()})},e=>{n.reject(e)}),n}createCrmExecuteRequestBody(e,t,n,r,a){Object(l.a)(Object(c.a)(r)&&Object(c.a)(a)||!Object(c.a)(r)&&!Object(c.a)(a),"The namespace alias and namespace need to be set together");let i="";return Object(c.a)(r)&&(r="a"),"RetrieveRecordWall"===e?i='<Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services"><request i:type="a:OrganizationRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">':(i='<Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><request i:type="'+r+":"+t+'" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts"',Object(c.a)(a)||(i+=" xmlns:"+r+'="'+a+'"'),i+=">"),Object(c.b)(n)?i+='<a:Parameters i:nil="true" />':i+='<a:Parameters xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">'+n+"</a:Parameters>",i+='<a:RequestId i:nil="true" /><a:RequestName>'+e+"</a:RequestName></request></Execute>",this.createSoapRequestBody(i)}_CreateCrmRequestBody(e,t){const n="<"+e+' xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services">'+t+"</"+e+">";return this.createSoapRequestBody(n)}getSoapHeaders(){return this._GetLanguagecodeOverride()+this._GetSdkClientVersionSoapHeader()+this._GetCrmMobileClientUniqueIdSoapHeader()}_GetLanguagecodeOverride(){return this._userLanguageCode>0?'<LanguageCodeOverride xmlns="http://schemas.microsoft.com/xrm/2011/Contracts">'+this._userLanguageCode+"</LanguageCodeOverride>":""}_GetSdkClientVersionSoapHeader(){return'<SdkClientVersion xmlns="http://schemas.microsoft.com/xrm/2011/Contracts">'+this.get_clientVersion()+"</SdkClientVersion>"}_GetCrmMobileClientUniqueIdSoapHeader(){const e=Object(c.a)(this.callerOriginProvider)?"":this.callerOriginProvider.get_uniqueId();return Object(c.b)(e)?"":'<CrmMobileClientUniqueId xmlns="http://schemas.microsoft.com/xrm/2011/Contracts">'+Object(re.b)(e)+"</CrmMobileClientUniqueId>"}createErrorResponse(e,t,n){return new oe.a(e,t,n)}createErrorResponseFromHtml(e){return oe.a.createFromHtml(e,null)}hasNilNodes(e){return e===_e._RetrieveMetadataChangesRequestName}handleSpecialCaseSoapResults(e,t,n){if(e.name===_e._RetrieveMetadataChangesRequestName)try{return n.resolve(new f(t)),!0}catch(e){return!1}return!1}canRetryServerError(e){const t=e;if(Object(c.a)(t)||Object(c.a)(t.get_organizationServiceFault()))return!1;switch(t.get_organizationServiceFault().get_errorCode()){case-2147180543:return!0;default:return!1}}addHeaders(e,t){e.ClientAppVersion=this.get_clientVersion();const n=localStorage.getItem("UCISessionID");Object(c.b)(n)||(e.SessionId=n),e.ClientAppName="UCIClient"}createResponseData(e,t){const n=super.createResponseData(e,t),r=e.getResponseHeader(be.c.SERVER_REQUEST_ID);return Object(c.b)(r)||(n.responseTelemetryId=r),n}_CreateJsonResponse(e,t){let n,r=null,a=0,i=null;const o=Object(c.a)(e.d);if(Object(c.a)(e)||o&&Object(c.a)(e.body))n=!1,r=ae.a.invalidResponseMessage;else if(o)n=!0,i=e.body;else{const t=e.d;n=t.Success,n?i=t:(r=t.ErrorMessage,a=t.ErrorCode)}return Object(c.a)(t)||t!==ie.a?new ae.a(n,r,a,i):new ie.a(n,r,a,i)}static _get_RequiredEntityMetadataPropertyNames(){return"<d:string>LogicalName</d:string>"}static _get_EntityMetadataPropertyNames(){return _e._get_RequiredEntityMetadataPropertyNames()+(_e._get_IsMailApp()?"":"<d:string>Attributes</d:string>")+"<d:string>DisplayCollectionName</d:string><d:string>DisplayName</d:string><d:string>IsActivity</d:string><d:string>IsActivityParty</d:string><d:string>IsChildEntity</d:string><d:string>IsConnectionsEnabled</d:string><d:string>IsCustomEntity</d:string><d:string>IsCustomizable</d:string><d:string>IsEnabledForCharts</d:string><d:string>IsImportable</d:string><d:string>IsMailMergeEnabled</d:string><d:string>IsReadOnlyInMobileClient</d:string><d:string>IsVisibleInMobileClient</d:string><d:string>IsOfflineInMobileClient</d:string><d:string>IsOptimisticConcurrencyEnabled</d:string><d:string>IsValidForAdvancedFind</d:string><d:string>ManyToOneRelationships</d:string><d:string>OneToManyRelationships</d:string><d:string>ObjectTypeCode</d:string><d:string>PrimaryIdAttribute</d:string><d:string>IsStateModelAware</d:string><d:string>EnforceStateTransitions</d:string><d:string>PrimaryNameAttribute</d:string><d:string>Privileges</d:string><d:string>IsValidForQueue</d:string><d:string>ActivityTypeMask</d:string><d:string>OwnershipType</d:string><d:string>IsBusinessProcessEnabled</d:string><d:string>EntityHelpUrlEnabled</d:string><d:string>EntityHelpUrl</d:string><d:string>IsDocumentManagementEnabled</d:string><d:string>IsOneNoteIntegrationEnabled</d:string><d:string>IsMSTeamsIntegrationEnabled</d:string><d:string>EntityColor</d:string><d:string>IsInteractionCentricEnabled</d:string><d:string>IsQuickCreateEnabled</d:string><d:string>EntityClientSetting</d:string><d:string>IsKnowledgeManagementEnabled</d:string><d:string>IsIntersect</d:string><d:string>IsBPFEntity</d:string>"}static _get_AttributeMetadataPropertyNames(){return"<d:string>AttributeType</d:string><d:string>DefaultFormValue</d:string><d:string>DefaultValue</d:string><d:string>DisplayName</d:string><d:string>EntityLogicalName</d:string><d:string>Format</d:string><d:string>FormatName</d:string><d:string>DateTimeBehavior</d:string><d:string>ImeMode</d:string><d:string>IsBaseCurrency</d:string><d:string>IsSecured</d:string><d:string>IsValidForCreate</d:string><d:string>IsValidForRead</d:string><d:string>IsValidForUpdate</d:string><d:string>IsSortableEnabled</d:string><d:string>InheritsFrom</d:string><d:string>LogicalName</d:string><d:string>MaxLength</d:string><d:string>MaxValue</d:string><d:string>MinValue</d:string><d:string>OptionSet</d:string><d:string>Precision</d:string><d:string>PrecisionSource</d:string><d:string>RequiredLevel</d:string><d:string>SourceType</d:string><d:string>Targets</d:string><d:string>AttributeOf</d:string>"}static _get_IsMailApp(){return Object(o.b)()}}_e.xrm2011MetadataNamespace="http://schemas.microsoft.com/xrm/2011/Metadata",_e.xrm2011MetadataQueryNamespace="http://schemas.microsoft.com/xrm/2011/Metadata/Query",_e.xrm2011ContractsNamespace="http://schemas.microsoft.com/xrm/2011/Contracts",_e._crm2011ContractsNamespace="http://schemas.microsoft.com/crm/2011/Contracts",_e._OrganizationWebServiceUrl="/XRMServices/2011/Organization.svc/web",_e._ProcessControlServiceUrl="/AppWebServices/ProcessControl.asmx/",_e._CustomerServiceUrl="/AppWebServices/CustomerService.asmx",_e._ExecuteSoapAction="http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute",_e._DeleteSoapAction="http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Delete",_e._RetrieveMetadataChangesRequestName="RetrieveMetadataChanges"},K7RF:function(e,t,n){"use strict";n.d(t,"b",(function(){return w})),n.d(t,"c",(function(){return P})),n.d(t,"e",(function(){return T})),n.d(t,"f",(function(){return N})),n.d(t,"a",(function(){return I})),n.d(t,"d",(function(){return A}));var r=n("g0tL"),a=n("Uv1Y"),i=n("5KQF"),o=n("SAYH"),s=n("E5IU"),c=n("BDhr"),l=n("wCzE"),u=n("x/aW"),d=n("eXjw"),p=n("pEXn"),g=n("69Qu"),h=n("FZDd"),f=n("iZ7K"),m=n("N6Lu"),b=n("iF9X"),_=n("37s6"),y=n("Lyxw"),v=n("SRlt"),S=n("4r2D"),O=n("/oKV"),C=n("0rLi"),E=n("fU7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const I="gcm.retrieve";function w(e,t,n,d,g,y,v,I,w,T,N=O.a.LocalAndRemote,A=null,D=null){const R=[];return{type:"gcm.retrieve.async",execute({dispatch:O,getState:A},D,x){const M=new S.a(o.a.newGuid().guid),F=D.DataSource,k=A(),L=Object(s.i)(k),B=o.a.toLegacyGuid(o.a.tryParseOrNull(L)),U=Object(l.a)(k),V=D.TraceManager.getTracer("GetClientMetadata");!v&&U&&U.currentVersion&&(v=U.currentVersion.toString()),R.push({name:p.b.MetadataTye,value:e},{name:p.b.MetadataSubType,value:t},{name:p.b.MetadataId,value:d?o.a.fromLegacyGuid(d).guid:null},{name:p.b.EntityName,value:n},{name:p.b.MetadataNames,value:w&&w.length>0?w.toString():null},{name:p.b.ServerAvailabilityStatus,value:F.get_IsServerAvailable()},{name:p.b.LocalDataSourceAvailabilityStatus,value:F.get_IsLocalDataSourceAvailable()},{name:p.b.IsMocaOfflineFeatureEnabled,value:Object(b.a)(k)},{name:p.b.MobileOfflineFeatureStatus,value:Object(_.p)(k)},{name:p.b.OfflineStatus,value:Object(_.q)(k)},{name:p.b.ClientRequestId,value:M&&M.RequestId?M.RequestId():null});const z=new C.a(e,t,n,d,w,g,y,v,I,B);return z.IsPreloadCall=x&&x.isPreloadCall,F.getClientMetadata(z,N,M).nativePromise().then(e=>{const t=T===r.b.Dashboard&&w.length>0?w[0]:null,a=Object(i.a)(e,T,n,A(),t,d,V,L);!function(e,t,n,r){const a=Object(c.a)(e);a&&n&&n.metadataVersion&&a.currentVersion!==n.metadataVersion.currentVersion&&j(u.a.MetadataVersion,a.currentVersion,n.metadataVersion.currentVersion,r);const i=Object(l.a)(e);i&&n&&n.userMetadataVersion&&i.currentVersion!==n.userMetadataVersion.currentVersion&&j(u.a.UserMetadataVersion,i.currentVersion,n.userMetadataVersion.currentVersion,r)}(A(),0,a,D);const o=a.webResourcesContent;if(a.webResourcesContent=null,O(P(a)),a.webResourcesContent=o,null!=e.WebResourceHash){const t=A(),n=e.WebResourceHash,r=Object(E.CrmUrlEncode)(n[0].toString());t.organization.organizationSettings.webResourceHash!==r&&O(Object(m.b)(r))}return a},n=>function(e,t,n,r,i){if(t===h.a){const e=Object(h.c)(n),t=[];e.forEach(e=>{Object(f.h)(i,e)||t.push(e)}),r(Object(h.g)(t))}return Object(a.b)(e)}(n,e,t,O,A()))},getFailureParameters:(e,t)=>R}}function j(e,t,n,r){const a=[];a.push({name:p.b.MetadataTye,value:e},{name:p.b.CurrentMetadataVersion,value:t},{name:p.b.ChangedMetadataVersion,value:n});r.TraceManager.getTracer(v.c.TRACER_CATEGORY_ID).warn("MetadataVersion Changed",a)}function P(e){return{type:I,payload:e}}function T(e,t){let n=!1;if(Object(g.b)(e)&&Object(c.b)(e)===d.a.Initialized){Object(c.a)(e).currentVersion>t&&(n=!0)}return n}function N(e,t){let n=!1;if(Object(g.b)(e)&&Object(l.b)(e)===d.a.Initialized){const r=Object(l.a)(e);-1!==t&&r.currentVersion>t&&(n=!0)}return n}function A(e,t,{OverallVersionNumber:n,OverallUserVersionNumber:r},a){const i=Object(y.b)(e,"IncrementalSyncSelectors");if(i&&t){const e=a();if(e&&e.OverallUserVersionNumber){const t=e.OverallUserVersionNumber;r=Math.max(r,t)}}const o=T(e,n),s=N(e,r);return i&&t&&o||(!i||!t)&&(o||s)?1:i&&t&&s?2:0}},K9oF:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return c}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="authentication.set.token",a="authentication.set.objectid",i="authentication.set.tenantid";function o(e){return{type:r,payload:e}}function s(e){return{type:a,payload:e}}function c(e){return{type:i,payload:e}}},K9wp:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n("ABCl"),a=n("Nb1E"),i=n("69Qu"),o=n("odYE"),s=n("SAYH"),c=n("16wZ"),l=n("4ciL"),u=n("aRLb"),d=n("+YnR");let p;class g{constructor(e,t){p=e,this._pageId=t,this._clientApiExecutor=new r.b(e,"ClientApi.XrmWebApiOnline.")}execute(e){return this._clientApiExecutor.executeAsync("execute",t=>(this._verifyWebApiOnlineIsReady(t),p.dispatch(Object(u.b)(e))),[{name:"request",value:e,isRequired:!0,expectedDataType:"object"},{name:"request.getMetadata",value:e&&e.getMetadata,isRequired:!0,expectedDataType:"function"},{name:"operationName",value:e&&e.getMetadata&&e.getMetadata().operationName,isRequired:!0,isEventParam:!0},{name:"operationType",value:e&&e.getMetadata&&e.getMetadata().operationType,isRequired:!0,isEventParam:!0}])}executeMultiple(e){return this._clientApiExecutor.executeAsync("executeMultiple",t=>(this._verifyWebApiOnlineIsReady(t),p.dispatch(Object(l.b)(e)).then(t=>this._postProcessRequestsOnSuccess(t,e))),[{name:"requests",value:e,isRequired:!0}])}_postProcessRequestsOnSuccess(e,t){const n=this._getEntitiesToBeDeletedFromRequests(t);return n.length&&Object(d.b)(p,n,this._pageId),e}_getEntitiesToBeDeletedFromRequests(e){const t=[];return e.forEach((function e(n){const r=n;if(r.getMetadata){if(function(e){const t="Delete"===e.operationName,n=2===e.operationType,r=e.parameterTypes&&e.parameterTypes.entityReference;return t&&n&&!!r}(r.getMetadata())){const e=n.entityReference;t.push(e)}}else n.forEach(e)})),t}retrieveRecord(e,t,n){return this._clientApiExecutor.executeAsync("retrieveRecord",(r,i)=>{this._verifyWebApiOnlineIsReady(r,i),n&&n.length>0&&!n.startsWith("?")&&Object(c.e)(r,'Option Parameter should begin with "?"',null,i);const l=s.a.tryParseOrNull(t);l||Object(c.k)(r,"guid","id",i);const u=new o.a(e,l);return p.dispatch(Object(a.d)(u,n))},[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"id",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"guid"},{name:"options",value:n,isRequired:!1,isEventParam:!1,expectedDataType:"string"}])}createRecord(e,t){return this._clientApiExecutor.executeAsync("createRecord",(n,r)=>(this._verifyWebApiOnlineIsReady(n,r),p.dispatch(Object(a.b)(e,t)).then(t=>({id:s.a.toString(t),entityType:e}))),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"data",value:t,isRequired:!0,expectedDataType:"object"}])}updateRecord(e,t,n){return this._clientApiExecutor.executeAsync("updateRecord",(r,i)=>{this._verifyWebApiOnlineIsReady(r);const l=s.a.tryParseOrNull(t);l||Object(c.k)(r,"guid","id",i);const u=new o.a(e,l);return p.dispatch(Object(a.f)(u,n)).then(()=>({id:t,entityType:e}))},[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"id",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"guid"},{name:"data",value:n,isRequired:!0,expectedDataType:"object"}])}deleteRecord(e,t){return this._clientApiExecutor.executeAsync("deleteRecord",(n,r)=>{this._verifyWebApiOnlineIsReady(n);const i=s.a.tryParseOrNull(t);i||Object(c.k)(n,"guid","id",r);const l=new o.a(e,i);return p.dispatch(Object(a.c)(l)).then(()=>{Object(d.a)(p,e,s.a.tryParse(t),this._pageId);return{id:t,entityType:e}})},[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"id",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"guid"}])}retrieveMultipleRecords(e,t,n){return this._clientApiExecutor.executeAsync("retrieveMultipleRecords",(r,i)=>(t&&t.length>0&&!t.startsWith("?")&&Object(c.e)(r,'Option Parameter should begin with "?"',null,i),null!==n&&n<0&&Object(c.e)(r,"Max Page Size should be a positive integer.",null,i),this._verifyWebApiOnlineIsReady(r),p.dispatch(Object(a.e)(e,t,n)).then(e=>{let t=null;if(e&&e.value){const n="@odata.nextLink";t={entities:e.value,nextLink:e[n]}}return t})),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"options",value:t,isRequired:!1,isEventParam:!1,expectedDataType:"string"},{name:"maxPageSize",value:n,isRequired:!1,isEventParam:!0,expectedDataType:"number"}])}_verifyWebApiOnlineIsReady(e,t){Object(i.b)(p.getState())||Object(c.e)(e,"API can be accessed only when online.",null,t)}}},KBcj:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"i",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return p})),n.d(t,"g",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"h",(function(){return g})),n.d(t,"b",(function(){return h}));var r,a=n("eXjw"),i=n("SAYH"),o=n("d0w6");function s(e,t,n=!1){const r=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return e&&e.metadata&&e.metadata.views?e.metadata.views:null}(e),a=i.a.toString(t);if(!r||!r[a])return null;const o=r[a];return n&&(o.title="New view"),o}function c(e,t){const n=s(e,t);return n?n.initialized:a.a.Uninitialized}function l(e,t,n){if(!(e&&e.metadata&&e.metadata.viewDefaults&&t))return null;const r=e.metadata.viewDefaults[t];return r?r[o.a[n]]:null}function u(e,t,n){const r=g(e);if(!r||!t)return null;const a=r[t];return a?a[o.a[n]]:null}function d(e,t,n){return function(e,t,n,r){if(!(e&&e.metadata&&e.metadata.viewSelectorVersions&&t&&r))return null;const a=e.metadata.viewSelectorVersions[t];if(!a)return null;const i=a[o.a[n]];return i?i[r]:null}(e,t,n,r.OverallUserVersionNumber)}function p(e,t,n,r){const a=g(e);if(!a||!t)return null;const s=a[t];if(!s)return null;const c=s[o.a[n]];return c?c[i.a.toString(r)]:null}function g(e){return e&&e.metadata&&e.metadata.viewSelectors?e.metadata.viewSelectors:null}function h(e){return e&&e.metadata&&e.metadata.viewDefaults?e.metadata.viewDefaults:null}function f(e,t){const n=s(e,t);return n&&n.grid&&n.grid.customControlDescriptions?n.grid.customControlDescriptions:null}!function(e){e.OverallUserVersionNumber="overallUserVersionNumber",e.OverallVersionNumber="overallVersionNumber"}(r||(r={}))},KEoC:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("NCQ1"),a="MicrosoftApplicationsTelemetryDeviceId",i="MicrosoftApplicationsTelemetryFirstLaunchTime",o="MSIE",s="Chrome",c="Firefox",l="Safari",u="Edge",d="Electron",p="SkypeShell",g="PhantomJS",h="Opera",f="Windows",m="Mac OS X",b="Windows Phone",_="Windows RT",y="iOS",v="Android",S="Linux",O="Chrome OS",C=/(windows|win32)/i,E=/ arm;/i,I=/windows\sphone\s\d+\.\d+/i,w=/(macintosh|mac os x)/i,j=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,P=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,T=/android/i,N=/CrOS/i,A={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},D=function(){function e(){}return e.addPropertyStorageOverride=function(e){return!!e&&(this._propertyStorage=e,!0)},e.autoCollect=function(e,t,n){if(this._semanticContext=e,this._disableCookies=t,this._autoCollect(),n||"undefined"==typeof navigator||(n=navigator.userAgent||""),this._autoCollectFromUserAgent(n),this._disableCookies&&!this._propertyStorage)return this._deleteCookie(a),void this._deleteCookie(i);(this._propertyStorage||this._areCookiesAvailable&&!this._disableCookies)&&this._autoCollectDeviceId()},e.checkAndSaveDeviceId=function(e){if(e){var t=this._getData(a),n=this._getData(i);t!==e&&(n=r.getISOString(new Date)),this._saveData(a,e),this._saveData(i,n),this._setFirstLaunchTime(n)}},e._autoCollectDeviceId=function(){var e=this._getData(a);e||(e=r.newGuid()),this._semanticContext.setDeviceId(e)},e._autoCollect=function(){"undefined"!=typeof document&&document.documentElement&&this._semanticContext.setAppLanguage(document.documentElement.lang),"undefined"!=typeof navigator&&this._semanticContext.setUserLanguage(navigator.userLanguage||navigator.language);var e=(new Date).getTimezoneOffset(),t=e%60,n=(e-t)/60,r="+";n>0&&(r="-"),n=Math.abs(n),t=Math.abs(t),this._semanticContext.setUserTimeZone(r+(n<10?"0"+n:n.toString())+":"+(t<10?"0"+t:t.toString()))},e._autoCollectFromUserAgent=function(e){if(e){var t=this._getBrowserName(e);this._semanticContext.setDeviceBrowserName(t),this._semanticContext.setDeviceBrowserVersion(this._getBrowserVersion(e,t));var n=this._getOsName(e);this._semanticContext.setDeviceOsName(n),this._semanticContext.setDeviceOsVersion(this._getOsVersion(e,n))}},e._getBrowserName=function(e){return this._userAgentContainsString("OPR/",e)?h:this._userAgentContainsString(g,e)?g:this._userAgentContainsString(u,e)||this._userAgentContainsString("Edg",e)?u:this._userAgentContainsString(d,e)?d:this._userAgentContainsString(s,e)?s:this._userAgentContainsString("Trident",e)?o:this._userAgentContainsString(c,e)?c:this._userAgentContainsString(l,e)?l:this._userAgentContainsString(p,e)?p:"Unknown"},e._setFirstLaunchTime=function(e){if(!isNaN(e)){var t=new Date;t.setTime(parseInt(e,10)),e=r.getISOString(t)}this.firstLaunchTime=e},e._userAgentContainsString=function(e,t){return t.indexOf(e)>-1},e._getBrowserVersion=function(e,t){return t===o?this._getIeVersion(e):this._getOtherVersion(t,e)},e._getIeVersion=function(e){var t=e.match(new RegExp(o+" ([\\d,.]+)"));if(t)return t[1];var n=e.match(new RegExp("rv:([\\d,.]+)"));return n?n[1]:void 0},e._getOtherVersion=function(e,t){e===l&&(e="Version");var n=t.match(new RegExp(e+"/([\\d,.]+)"));return n?n[1]:"Unknown"},e._getOsName=function(e){return e.match(I)?b:e.match(E)?_:e.match(j)?y:e.match(T)?v:e.match(P)?S:e.match(w)?m:e.match(C)?f:e.match(N)?O:"Unknown"},e._getOsVersion=function(e,t){return t===f?this._getGenericOsVersion(e,"Windows NT"):t===v?this._getGenericOsVersion(e,t):t===m?this._getMacOsxVersion(e):"Unknown"},e._getGenericOsVersion=function(e,t){var n=e.match(new RegExp(t+" ([\\d,.]+)"));return n?A[n[1]]?A[n[1]]:n[1]:"Unknown"},e._getMacOsxVersion=function(e){var t=e.match(new RegExp(m+" ([\\d,_,.]+)"));if(t){var n=t[1].replace(/_/g,".");if(n){var r=this._getDelimiter(n);return r?n.split(r)[0]:n}}return"Unknown"},e._getDelimiter=function(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null},e._saveData=function(e,t){if(this._propertyStorage)this._propertyStorage.setProperty(e,t);else if(this._areCookiesAvailable){var n=new Date;n.setTime(n.getTime()+31536e6);var r="expires="+n.toUTCString();document.cookie=e+"="+t+"; "+r}},e._getData=function(e){if(this._propertyStorage)return this._propertyStorage.getProperty(e)||"";if(this._areCookiesAvailable){e+="=";for(var t=document.cookie.split(";"),n=0;n<t.length;n++){for(var r=t[n],a=0;" "===r.charAt(a);)a++;if(0===(r=r.substring(a)).indexOf(e))return r.substring(e.length,r.length)}}return""},e._deleteCookie=function(e){this._areCookiesAvailable&&(document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},e._disableCookies=!1,e._areCookiesAvailable="undefined"!=typeof document&&void 0!==document.cookie,e}();t.default=D},KJT0:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.closed=0]="closed",e[e.openLeft=1]="openLeft",e[e.openRight=2]="openRight",e[e.open=3]="open"}(r||(r={}))},KLhE:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.none=0]="none",e[e.userOwned=1]="userOwned",e[e.teamOwned=2]="teamOwned",e[e.businessOwned=4]="businessOwned",e[e.organizationOwned=8]="organizationOwned",e[e.businessParented=16]="businessParented"}(r||(r={}))},KOTC:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("nuS9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class a extends r.Component{constructor(e){super(e),this.state={component:null}}componentDidMount(){this.props.loader().then(e=>this.setState({component:e}))}render(){return this.state.component?r.createElement(this.state.component,this.props.props,this.props.children):null}}},KXDI:function(e,t,n){"use strict";n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return b})),n.d(t,"c",(function(){return h}));var r=n("SAYH"),a=n("iZ7K"),i=n("uIhY"),o=n("CB5L"),s=n("3ZcW");const c={COLON:encodeURIComponent(":"),OPEN_BRACKET:encodeURIComponent("{"),CLOSED_BRACKET:encodeURIComponent("}"),COMMA:encodeURIComponent(","),EQUAL:encodeURIComponent("=")};function l(e,t,n,r){switch(e){case"Edm.String":return u(e,t,n,r);case"Edm.Guid":return u(e,t.guid,n,r);case"Edm.DateTimeOffset":if("object"==typeof t&&"function"==typeof t.toISOString)return u(e,t.toISOString(),n,r);default:return u("Edm.UndefinedType",t,n,r)}}function u(e,t,n,r){switch(function(e,t,n){let r=n?t?o.d.DoubleQuotesURL:o.d.NoQuotesURL:o.d.Contract;return r===o.d.Contract?"Edm.UndefinedType"===e?r=o.d.None:"Edm.String"===e&&(r=o.d.JsonifyURL):r===o.d.NoQuotesURL&&"Edm.String"===e?r=o.d.SingleQuotesURL:r===o.d.DoubleQuotesURL&&"Edm.UndefinedType"===e&&(r=o.d.NoQuotesURL),r}(e,n,r)){case o.d.JsonifyURL:return JSON.stringify(t);case o.d.SingleQuotesURL:return`'${Object(i.c)(t)}'`;case o.d.DoubleQuotesURL:return`"${Object(i.c)(t,!0)}"`;case o.d.NoQuotesURL:return Object(i.c)(t);case o.d.Contract:return`"${t}"`;default:return t}}function d(e,t,n,r=!1){if(t){let a="{",i="";const o=r?c.COLON:":";if(n){const e=t.getMetadata().typeName;e&&n.typeName!==e&&(a+=`"@odata.type"${o}"${e}"`,i=",")}for(const n in t)if("function"!=typeof t[n]){const s=h(e,t,n,!0,r);if(p(t,n,s))continue;a+=`${i}"${n}"${o}${s}`,i||(i=",")}return a+"}"}return"null"}function p(e,t,n){if(e instanceof s.a){if([null,"null","[]",""].indexOf(n)>=0)return!0;if("DependencyDepth"===t&&e[t]===o.b.OnDemandWithoutContext)return!0}return!1}function g(e,t,n,r){const a=Object(i.e)(e,t);return null==a?"":n?u(t.typeName,a.name,n,r):`${t.typeName}'${a.name}'`}function h(e,t,n,r=!1,a=!1){const o=t.getMetadata(),s=t[n];if(n&&0===n.indexOf("@odata."))return`"${s}"`;const c=o.parameterTypes[n];if(void 0===c)return null;switch(c.structuralProperty){case 1:return null==s?null:"MetadataSubtype"===n&&"Edm.String"===c.typeName?`"${s}"`:l(c.typeName,s,r,a);case 5:return Object(i.f)(e,s,r,a);case 2:return d(e,s,c,a);case 3:return g(s,c,r,a);case 4:if(!s)return"null";if(!s.length)return"[]";if(s[0].getMetadata){return"["+s.map(t=>d(e,t,void 0,a)).join(",")+"]"}return-1!==i.a.indexOf(c.typeName)?"["+s.map(e=>l(c.typeName,e,r,a)).join(",")+"]":c.enumProperties?"["+s.map(e=>g(e,c,r,a)).join(",")+"]":"number"==typeof s[0]?"["+s.map(e=>l("Edm.String",e,r,a)).join(",")+"]":"["+s.map(t=>Object(i.f)(e,t,r,a)).join(",")+"]"}}function f(e,t,n){if(!t)throw new Error("Cannot generate base URL for the OData call: the routine name is empty.");if(!n)throw new Error("Cannot generate base URL for the OData call: the request is empty.");if(!n.getMetadata())throw new Error("Cannot generate base URL for the OData call: the request metadata is empty.");const i=n.getMetadata().boundParameter;if(i){const o=n.getMetadata();if(!o||!o.parameterTypes||!o.parameterTypes[i])return null;if(4===o.parameterTypes[i].structuralProperty){const n=o.parameterTypes[i].typeName&&o.parameterTypes[i].typeName.split(".").pop();if(!n)return null;const r=Object(a.o)(e,n);return r?`${r}/Microsoft.Dynamics.CRM.${t}`:null}const s=n[i];return`${Object(a.o)(e,s.entityType)}(${r.a.fromExternalGuid(s.id).guid})/Microsoft.Dynamics.CRM.${t}`}return""+t}function m(e,t){return`${f(e,t.getMetadata().operationName,t)}${function(e,t){const n=t.getMetadata().boundParameter,r=[],a=Object.keys(t).filter(e=>e!==n).map(n=>{const a=t.getMetadata().parameterTypes[n],i=h(e,t,n,!1,!0);return void 0!==a&&3===a.structuralProperty?`${n}=${i}`:(r.push(`@${n}=${i}`),`${n}=@${n}`)});return r.length?`(${a.join(",")})?${r.join("&")}`:`(${a.join(",")})`}(e,t)}`}function b(e,t){return f(e,t.getMetadata().operationName,t)}},KXSk:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("jq7Z"),a=n("SDQ8"),i=n("zmL5");function o(e,t,n){return null!=Object(r.a)(e,Object(a.b)(t,n))}function s(e,t){var n;if(null===(n=e.pages)||void 0===n?void 0:n[t])return t;const r=Object.keys(e.pages);for(const n of r){const r=Object(i.c)(e,n);if(null==r?void 0:r.some(e=>e===t))return n}return t}},KdpX:function(e,t,n){"use strict";n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return C})),n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return O}));var r=n("SAYH"),a=n("Uv1Y"),i=n("OtHk"),o=n("pnQK"),s=n("eXjw"),c=n("g0tL"),l=n("IqkD"),u=n("K7RF"),d=n("ueZM"),p=n("pEXn"),g=n("YxC/"),h=n("MQTY"),f=n("/oKV"),m=n("iJGp"),b=n("Lyxw"),_=n("3/02"),y=n("3c7c");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const v="dashboard.retrieve",S="system",O="user";function C(e,t,n,c,p,b=!1){return{type:"dashboard.retrieve.async",execute({dispatch:_,getState:y},O){let C=f.a.LocalAndRemote;const w=y(),A=t,D=c,R=n&&n.length>0;if(p){const e=Object(l.w)(w),a=e&&e.defaultDashboardId;if(!r.a.isNullOrEmpty(a)){const e=Object(i.b)(w,a);if(!e||r.a.isNullOrEmpty(e.FormId)||r.a.equals(a,e.FormId)){t=a;const e=Object(o.a)(w,t,n);c=N(e)}}}const x=Object(i.d)(w,t,e,n);let M;if(x===s.a.Initialized){const r=Object(i.b)(w,t,e,n),a=()=>Object(o.a)(w,t,n),s=c===S;if(b)C=f.a.Remote;else{switch(Object(u.d)(w,s,r,a)){case 1:C=f.a.Remote;break;case 2:R||(M=_(T(n,C)))}}}if(x!==s.a.Initialized||C!==f.a.LocalAndRemote){_(function(e,t,n){const r={};""!==e&&null!=e?r.dashboardsByNavPath={[e]:{Initialized:s.a.Initializing}}:t?r.dashboards={[t.guid]:{Initialized:s.a.Initializing}}:n&&n.length>0&&(r.dashboardsByEntityName={[n]:{Initialized:s.a.Initializing}});return{type:v,payload:r}}(e,t,n));let o=m.a.OnDemandWithContext;if(C!==f.a.Remote){const e=R?Object(i.g)(w,n):Object(i.c)(w);if(e&&Object.keys(e).length>0&&e[t&&t.guid]){if(!b)if(R){const e=Object(g.e)(w,[h.SYSTEM_DASHBOARD_LABEL_ID]);if(e){Object(g.c)(e,h.SYSTEM_DASHBOARD_LABEL_ID)&&(o=m.a.OnDemandWithoutContext)}}else o=m.a.OnDemandWithoutContext;const n=e[t&&t.guid];c=N(n)}}const l=_(P(o,C,e,t,n,c,p));return E(O,e,c,p,t,n,l,a=>{const i=I(a);if(!i||p&&t&&!r.a.equals(i.FormId,t)){if(p&&t&&!r.a.equals(t,A)){const t=_(P(o,C,e,A,n,D));return E(O,e,D,!1,A,n,t,t=>{const r=I(t);return r?r.FormId:_(j(M,o,C,e,n))})}return _(j(M,o,C,e,n))}return t&&r.a.equals(i.FormId,t)||(t=i.FormId),t}).then(e=>e?_(Object(d.a)(e)).then(()=>e,a.b):e)}return Promise.resolve(Object(i.b)(w,t,e,n).FormId)},getFailureParameters:()=>w(e,c,p,t,n)}}function E(e,t,n,r,a,i,o,s){let c=!1;return o.then(e=>(c=!0,s(e))).catch(o=>{const l=o&&-2147093999===o.errorCode;if(c||!l)return Promise.reject(o);return e.TraceManager.getTracer(v).warn(o&&o.message,w(t,n,r,a,i)),s(null)})}function I(e){const t=e&&e.dashboards&&Object.keys(e.dashboards);return t&&t.length>0&&e.dashboards[t[0]]}function w(e,t,n,a,i){return[{name:p.b.DashboardNavPath,value:e},{name:p.b.DashboardType,value:t},{name:p.b.ShowDefaultDashboard,value:n},{name:p.b.DashboardId,value:r.a.toString(a)},{name:p.b.EntityName,value:i}]}function j(e,t,n,r,a){return{type:"dashboardFallback.retrieve.async",execute:({dispatch:o,getState:s},c)=>{let l;if(!e){const t=s();let r=!0;const c=a?Object(i.g)(t,a):Object(i.c)(t),d=c&&Object.keys(c);if(d&&d.length>0){const e=c[d[0]];r=Object(u.e)(t,e.OverallVersionNumber)}r?e=o(T(a,n)):l=Promise.resolve(c)}return e&&(l=e.then(e=>e&&(a?e.dashboardSelectorsByEntityName&&e.dashboardSelectorsByEntityName[a]:e.dashboardSelectors))),E(c,r,S,!1,null,a,l,e=>{if(e){let s=[];for(const t in e){const n=e[t];N(n)!==S||Object(i.i)(n.Id)||s.push(n)}s=s.sort((e,t)=>e.DisplayName>t.DisplayName?1:e.DisplayName<t.DisplayName?-1:0);const l=()=>{if(0===s.length)return null;const e=s.shift(),i=o(P(t,n,r,e.Id,a,S));return E(c,r,S,!1,e.Id,a,i,e=>{const t=I(e);return t?t.FormId:l()})};return l()}return null})}}}function P(e,t,n,i,o,s,l){return{type:"dashboard.retrieve.async",execute({dispatch:l,getState:d},p){const g=r.a.isNullOrEmpty(i),h=r.a.toLegacyGuid(i);let f="workspace";o||s===S?f="systemworkspace":s===O&&(f="userworkspace");const m=n=>l(Object(u.b)(f,null,o,h,g,e,null,null,n,c.b.Dashboard,t));return(!o&&Object(b.c)(d(),_.pb)&&Object(b.c)(d(),_.K)?(()=>{const e=Object(y.b)(d()).map(e=>m(e));return Promise.all(e).then(e=>e[0])})():m(n?[n]:[])).catch(a.b)},getFailureParameters:()=>w(n,s,l,i,o)}}function T(e,t){return Object(u.b)("dashboardselector",null,e,null,!0,m.a.OnDemandWithContext,null,null,[],null,t)}function N(e){switch(e&&+e.Type){case 1032:case 1030:case 1035:return S;case 1031:case 1034:return O}}},KeJu:function(e,t,n){"use strict";n.d(t,"b",(function(){return C})),n.d(t,"a",(function(){return E})),n.d(t,"d",(function(){return I})),n.d(t,"e",(function(){return w})),n.d(t,"f",(function(){return j})),n.d(t,"c",(function(){return P})),n.d(t,"g",(function(){return T}));var r=n("Uv1Y"),a=n("SAYH"),i=n("eXjw"),o=n("E5IU"),s=n("smSa"),c=n("SRlt"),l=n("pEXn"),u=n("rCFy"),d=n("aRLb"),p=n("3ZcW"),g=n("UKgB"),h=n("K7RF"),f=n("g0tL"),m=n("GYEz"),b=n("504W"),_=n("4r2D"),y=n("iJGp"),v=n("/oKV"),S=n("0rLi"),O=n("dH1a");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const C="app.retrieve",E="app.timestamps.retrieve";function I(e){return{type:"app.retrieve.async",execute({dispatch:t,getState:n},s){const c=n(),l=Object(o.e)(c);return Object(o.i)(c)===a.a.toString(e)&&l.initialized===i.a.Initialized?Promise.resolve(Object(o.e)(c)):t(function(e,t){return{type:"app.descriptor.async",execute({dispatch:n,getState:o},s){let c=!0;a.a.isNullOrEmpty(e)||(c=!1,n(function(e){const t={appContext:{initialized:i.a.Initializing,app:{appId:e?e.guid:null,appUrl:null,id:null,description:null,LastModifiedOn:null,status:null,title:null,uniqueName:null,clientType:null,navigationType:0,isFeatured:null,solutionId:null,versionNumber:null,components:null,appComponents:null,appSettings:null}}};return{type:C,payload:t}}(e)));const l=N(e,c,t,v.a.Remote);return n(l).catch(a=>{if(a=Object(r.c)(a),Object(O.a)(a.getNegativeErrorCode())){const i=N(e,c,t,v.a.Local);return n(i).then(e=>e&&e.appContext?e:Promise.reject(a),r.b)}return Promise.reject(a)})}}}(e,y.a.OnDemandWithoutContext)).then(e=>e.appContext)}}}function w(){const e=[];return{type:"app.retrieve.async",execute({dispatch:t,getState:n},i){const o=v.a.Remote,s=i.DataSource,c=new _.a(a.a.newGuid().guid);return e.push({name:l.b.ClientRequestId,value:c&&c.RequestId?c.RequestId():null}),s.getClientMetadata(new S.a("appmodules",null,"appmodules",null,[],!0,y.a.Offline,null,[],null),o,c).nativePromise().then(e=>e&&e.AppModules?e.AppModules:[],r.b)},getFailureParameters:(t,n)=>e}}function j(){const e=[];return{type:"app.retrieve.async",execute({dispatch:t,getState:n},r){const i=v.a.Local,o=r.DataSource,s=new _.a(a.a.newGuid().guid);return e.push({name:l.b.ClientRequestId,value:s&&s.RequestId?s.RequestId():null}),o.getClientMetadata(new S.a("appmoduleofflinemetadata",null,null,null,[],!0,y.a.Offline,null,[],null),i,s).nativePromise().then(e=>e&&e.AppModules?e.AppModules:[],e=>{})},getFailureParameters:(t,n)=>e}}function P(){return{type:"app.timestamps.retrieve.async",execute({dispatch:e,getState:t},n){const r=[],i=n.TraceManager.getTracer(c.c.TRACER_CATEGORY_ID),o=new g.a;o.ClientMetadataQuery=new p.a,o.ClientMetadataQuery.MetadataType="appmodules",o.ClientMetadataQuery.MetadataSubtype="modifiedon",o.ClientMetadataQuery.EntityLogicalName="appmodules",o.ClientMetadataQuery.GetDefault=!0,o.ClientMetadataQuery.DependencyDepth=y.a.Offline;const h=Object(m.c)(t());return Object(b.b)(h)?r.push({name:l.b.IsEmptyInstallationId,value:!0}):o.ClientMetadataQuery.MetadataNames=[h],e(Object(d.b)(o)).then(e=>e.json()).then(e=>JSON.parse(e.Metadata)).then(n=>{const o=!(n&&n.AppModuleModifiedOn&&n.AppModuleModifiedOn.length>0);let c=null,d=!1,p=!1,g=!1;if(!o&&null!=n.AppModuleModifiedOn[0]&&(p=n.AppModuleModifiedOn[0].UpdateInProgress,!p&&(g=!n.AppModuleModifiedOn[0].AppModuleToLastModifiedTimeMap,!g))){c=n.AppModuleModifiedOn[0].AppModuleToLastModifiedTimeMap;const e=t();for(const t in c)if(Object(s.a)(e,new a.a(t))<c[t]){d=!0;break}}if(n&&n.OfflineSubscriptionDetails&&n.OfflineSubscriptionDetails.length){const t=n.OfflineSubscriptionDetails[0],a=t.SubscriptionId;e(Object(u.b)("",t.SubscriptionErrorMessage)),Object(b.b)(a)&&(r.push({name:l.b.IsEmptySubscriptionId,value:!0}),r.push({name:l.b.SubscriptionErrorMessage,value:t.SubscriptionErrorMessage}))}return r.push({name:l.b.IsEmptyPayload,value:o}),r.push({name:l.b.UpdateInProgress,value:p}),r.push({name:l.b.IsAppModuleToLastModifiedTimeMapEmpty,value:g}),r.push({name:l.b.HaveTimestampsChanged,value:d}),i.warn("getUpdatedAppModuleTimestamps response details",r),d?c:null})}}}function T(e){const t={offlineSync:{initialized:i.a.Initialized,appModuleTimestamps:e}};return{type:E,payload:t}}function N(e,t,n,r){return Object(h.b)("appmodules",null,"appmodules",a.a.toLegacyGuid(e),t,n,null,null,["appmodules"],f.b.Other,r)}},Knfm:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u}));var r=n("GEbX"),a=n("E5IU");var i=n("hAdb"),o=n("GYEz"),s=n("w1eR"),c=n("H4dV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e){const t=c.a.getInstance();return Object(o.a)(e)===s.a.Browser&&!t.get_IsBrowserIE()&&!t.get_IsMobilePhone()}function u(e){const t=function(e){if(e)switch(e.toLowerCase()){case r.a[r.a.MultiSession].toLowerCase():return r.a.MultiSession;case r.a[r.a.SingleSession].toLowerCase():return r.a.SingleSession;default:return}}(Object(i.b)(e,"navigationType"));if(void 0!==t)return t;if(!l(e))return r.a.SingleSession;const n=Object(a.k)(e);return null!=n?n:r.a.SingleSession}},Kvn0:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="businessProcessFlow.addBusinessProcessFlowData",a="businessProcessFlow.updateDisplayState",i="businessProcessFlow.setLibraryLoaded"},L4PC:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("dHD5"),a=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="dataset.update.pagenumber";function o(e,t,n){return{type:"dataset.update.pagenumber.async",execute({dispatch:o,getState:s},c){const l=c.TraceManager.getTracer(a.z),u=a.x+".updatePageNumberAction";try{l.info("Updating the page number for the grid."),o(function(e,t,n){const a=Object(r.y)(t),o=Object(r.v)(t);return{type:i,payload:n,meta:{pageId:e,contextKey:a,dataSetContextKey:o}}}(e,t,n));const a=[];return a.push({name:"pageNumber",value:n}),c.EventManager.ReportComponentSuccess(u,a),Promise.resolve()}catch(e){const t="Updation of page number for the grid failed with error : "+e.message;c.EventManager.ReportComponentFailure(u,Error(t))}}}}},L8Me:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r={createMarker:function(){},startStopwatch:function(){return function(){}},createRetroactiveStopwatch:function(){}},a=new(function(){function e(){this._creator=null}return e.prototype.setPerformanceHooks=function(e,t,n,r,a){this._creator=e,this._addKpi=t,this._addKpiOnIdle=n,this._trackWork=r,this._scheduleControlUpdate=a},e.prototype.createPerformanceEvent=function(e,t,n){return void 0===t&&(t=3),void 0===n&&(n="CustomControlsFramework"),this._creator&&t>2?this._creator(e,n):r},e.prototype.startLifecycleStopwatch=function(e,t,n){return this.createPerformanceEvent(e,void 0,"CustomControls").startStopwatch({controlId:t,manifestControlName:n})},e.prototype.addKeyPerformanceIndicator=function(e,t,n){this._addKpi&&this._addKpi(e,t,n)},e.prototype.addKeyPerformanceIndicatorOnIdle=function(e,t){this._addKpiOnIdle&&this._addKpiOnIdle(e,t)},e.prototype.trackWork=function(e){return this._trackWork?this._trackWork(e):function(){}},e.prototype.scheduleControlUpdate=function(e){this._scheduleControlUpdate?this._scheduleControlUpdate(e):e()},e}());t.a=a},LAGg:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c}));var r=n("dHD5"),a=n("L4PC"),i=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="update.grid.refresh.counter";function s(e,t){return{type:"update.grid.refresh.counter.async",execute({dispatch:n,getState:o},s){const l=s.TraceManager.getTracer(i.z),u=i.x+".updateGridRefreshCounterAction";try{const i=Object(r.u)(t);return n(c(e,i)),n(Object(a.b)(e,t,1)),l.info("Updating the grid refresh counter"),s.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){const t="Updating the grid refresh counter failed with error : "+e.message;s.EventManager.ReportComponentFailure(u,Error(t))}}}}function c(e,t){return{type:o,payload:Math.floor(1e3*Math.random()),meta:{pageId:e,dataSetContextKey:t}}}},LE5i:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r={Metadata:"metadata",Data:"data",WhatsChanged:"whatschanged",Filters:"filters",InitiateRefresh:"initiaterefresh",MoreEmails:"moreemails",ContextualDialogEntity:"contextualdialogentity"}},LFDu:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("84PK");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a{constructor(e){this._columnNames=null,this._columnTypeMap=null,this._columnTypeMap=e,this._columnNames=Object.keys(this._columnTypeMap)}get_columnNameTypeMap(){return this._columnTypeMap}get_columnNames(){return this._columnNames}}var i=n("504W"),o=n("nTyX");class s{initialize(){s._attributeMap={},s._attributeMap.aliasedvalue=new a({attributelogicalname:String,entitylogicalname:String,attributetype:o.a}),s._attributeMap.customer=new a({id:r.a,logicalname:String,name:String}),s._attributeMap.lookup=new a({id:r.a,logicalname:String,name:String}),s._attributeMap.owner=new a({id:r.a,logicalname:String,name:String}),s._attributeMap.status=new a({"":String}),s._attributeMap.state=new a({"":String}),s._attributeMap.boolean=new a({"":String}),s._attributeMap.picklist=new a({"":String}),s._attributeMap.datetime=new a({"":Number}),s._attributeMap.string=new a({"":String}),s._attributeMap.uniqueidentifier=new a({"":r.a}),s._attributeMap.decimal=new a({"":String}),s._attributeMap.double=new a({"":String}),s._attributeMap.integer=new a({"":String}),s._attributeMap.memo=new a({"":String}),s._attributeMap.money=new a({"":String}),s._attributeMap.unknown=new a({"":String}),s._attributeMap.partylist=new a({"":String}),s._attributeMap.calendarrules=new a({"":String}),s._attributeMap.virtual=new a({"":String}),s._attributeMap.bigint=new a({"":String}),s._attributeMap.managedproperty=new a({"":String}),s._attributeMap.entityname=new a({"":String})}getAttributeMap(e){return!Object(i.b)(e)&&e in s._attributeMap?s._attributeMap[e]:null}getAttributeColumnNames(e){return!Object(i.b)(e)&&e in s._attributeMap?s._attributeMap[e].get_columnNames():null}getAttributeType(e,t){return s._attributeMap&&e in s._attributeMap?s._attributeMap[e].get_columnNameTypeMap()[t]:null}isComplexAttribute(e){switch(e){case"aliasedvalue":case"customer":case"lookup":case"owner":return!0;default:return!1}}}s._attributeMap=null},LJro:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="page.update.syncerrorstatus";function a(e,t){return{type:r,payload:{__isSyncErrorStatusUpdated:t},meta:{pageId:e}}}},LMh4:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="appprogressindicator.update";function a(e){return{type:r,payload:{inProgress:!!e,progressMessage:e||null}}}},LOik:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return e.metadata.appModulesList.appList}function a(e){const t=r(e);return null==t?void 0:t.find(e=>-1===e.clientType)}function i(e){const t=e.metadata.appModulesList.appList;return t.sort((e,t)=>{if(e&&e.displayName&&t&&t.displayName)return-1===e.clientType?-1:-1===t.clientType?1:e.displayName.toLocaleLowerCase().localeCompare(t.displayName.toLocaleLowerCase())}),t}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}))},LRcz:function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},LSTU:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.clockSkewRefreshDurationInMins=e,this._reset()}return e.prototype.allowRequestSending=function(){return this._isFirstRequest&&!this._clockSkewSet?(this._isFirstRequest=!1,this._allowRequestSending=!1,!0):this._allowRequestSending},e.prototype.shouldAddClockSkewHeaders=function(){return this._shouldAddClockSkewHeaders},e.prototype.getClockSkewHeaderValue=function(){return this._clockSkewHeaderValue},e.prototype.setClockSkew=function(e){this._clockSkewSet||(e?this._clockSkewHeaderValue=e:this._shouldAddClockSkewHeaders=!1,this._clockSkewSet=!0,this._allowRequestSending=!0)},e.prototype._reset=function(){var e=this;this._isFirstRequest=!0,this._clockSkewSet=!1,this._allowRequestSending=!0,this._shouldAddClockSkewHeaders=!0,this._clockSkewHeaderValue="use-collector-delta",this.clockSkewRefreshDurationInMins>0&&setTimeout((function(){return e._reset()}),6e4*this.clockSkewRefreshDurationInMins)},e}();t.default=r},LTmj:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("3ri3");class a{constructor(e,t,n,r){this._Id=null,this._Name=null,this._Status=0,this._ActionData=null,this._CreatedOn=null,this._set_id(e),this.set_name(t),this.set_status(n),this.set_actionData(r),this.set_createdOn(new Date)}_get_id(){return this._Id}_set_id(e){return this._Id=e,e}get_name(){return this._Name}set_name(e){return this._Name=e,e}get_status(){return this._Status}set_status(e){return this._Status=e,e}get_actionData(){return this._ActionData}set_actionData(e){return this._ActionData=e,e}get_createdOn(){return this._CreatedOn}set_createdOn(e){return this._CreatedOn=e,e}toDictionary(){const e={};return e[r.g]=this._get_id(),e[r.h]=this.get_name(),e[r.n]=this.get_status(),e[r.d]=this.get_actionData(),e[r.f]=this.get_createdOn(),e}}},LTq1:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Form_ReadOnly_Status",a="Form_ReadOnly_Permissions_Entity",i="Form_ReadOnly_Permissions_Record",o="Form_ReadOnly_Offline",s=[r,a,i,o,"Dialog_Label_Active"]},LbMF:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"k",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"g",(function(){return i})),n.d(t,"c",(function(){return l})),n.d(t,"j",(function(){return o})),n.d(t,"h",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"f",(function(){return g})),n.d(t,"i",(function(){return h})),n.d(t,"l",(function(){return f})),n.d(t,"b",(function(){return u}));var r=n("iZ7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){return e&&e.metadata&&e.metadata.attributes?e.metadata.attributes[t]:null}function i(e,t,n){if(!n||!n.length)return[];const r=a(e,t);if(!r)return n;const i=[];for(let e=0;e<n.length;e++)r[n[e]]||i.push(n[e]);return i}function o(e,t,n){const r=a(e,t);if(!r)return null;if(0===n.length)return r;const i={};return n.forEach(e=>{r.hasOwnProperty(e)&&(i[e]=r[e])}),i}function s(e,t){return a(e,t)}function c(e,t,n){const r=a(e,t);return r&&r.hasOwnProperty(n)?r[n]:null}function l(e,t,n){const r={},i=a(n,t);return i&&(e&&e.length?e.forEach(e=>{i[e]&&(r[e]=i[e].Type)}):Object.keys(i).forEach(e=>{r[e]=i[e].Type})),r}function u(e,t,n){const r=a(n,t);return r&&r[e]?r[e].Type:null}function d(e,t){const n=Object(r.h)(e,t);return n?n.PrimaryNameAttribute:null}function p(e,t,n){if(!n||0===n.length)return null;const r=o(e,t,n);if(!r)return null;const a={};for(const e in r){const t=r[e];"picklist"!==t.Type&&"multiselectpicklist"!==t.Type||!(t.ParentPicklistLogicalName||t.ChildPicklistLogicalNames&&t.ChildPicklistLogicalNames.length>0)||(a[e]=t)}return a}function g(e,t,n){const r={};if(e.metadata&&e.metadata.attributes){const a=e.metadata.attributes[t];for(const e in a)a[e].Type===n&&(r[e]=a[e])}return r}function h(e,t,n){if(n){const a=Object(r.x)(e,t.entityLogicalName,n);if(a){return a.ReferencingAttribute}}return null}function f(e,t,n){const r=c(e,t,n);return!(!r||!(r.ParentPicklistLogicalName||r.ChildPicklistLogicalNames&&r.ChildPicklistLogicalNames.length>0))}},Lc3p:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b}));var r=n("ZuxC"),a=n("5w+f"),i=n("gQ5I"),o=n("Tz6o"),s=n("2YQW"),c=n("LJro"),l=n("ZFRl"),u=n("lza4");var d=n("BfRu"),p=n("JVKK");const g=Object(s.d)({[d.a]:function(e,t){const n=Object.assign(Object.assign({},e),{[t.payload.UniqueId]:t.payload});return Object.freeze(n)},[p.a]:function(e,t){const n=Object.assign({},e);return delete n[t.payload.UniqueId],Object.freeze(n)}},{});var h=n("tGNJ"),f=n("VgPQ");function m(e){return(t={},n)=>{if(n.type===h.a&&n.payload.pageState)return n.payload.pageState;if(n.meta&&n.meta.pageId){const r=n.meta.pageId,a=e[r];if(a){const e=t[r],i=function(e,t,n){const r=n.getRootReducer()(e,t);void 0===e&&(e={});const a=b(e,t),i=Object.assign(Object.assign({},r),a);if(Object(s.e)(e,i))return e;return Object.freeze(i)}(e,n,a);if(e!==i)return Object.freeze(Object.assign(Object.assign({},t),{[r]:i}))}if(n.type===i.c||n.type===i.b){const e={},n=Object.keys(t);for(const a of n)a!==r&&(e[a]=t[a]);return Object.freeze(e)}}return t}}function b(e,t){const n=function(e={},t){if(t.type===r.b||t.type===a.a||t.type===o.a)return Object.freeze(Object.assign({},t.payload.input));return e}(e.input,t),s=function(e,t){if(t.type===i.a)return Object.freeze(Object.assign({},t.payload.__output));return e}(e.__output,t),u=function(e,t){if(t.type===r.b||t.type===a.a)return t.payload.__pageName;return e}(e.__pageName,t),d=function(e,t){if(t.type===l.a)return t.payload.__pageTitle;return e}(e.__pageTitle,t);return{input:n,__output:s,__pageName:u,dialogOptions:function(e,t){if(t.type===a.a)return Object.freeze(Object.assign({},t.payload.dialogOptions));return e}(e.dialogOptions,t),isDialogStatus:function(e=!1,t){if(t.type===r.b||t.type===a.a)return t.payload.isDialogStatus;return e}(e.isDialogStatus,t),__isSyncErrorStatusUpdated:function(e=!1,t){if(t.type===c.a)return t.payload.__isSyncErrorStatusUpdated;return e}(e.__isSyncErrorStatusUpdated,t),__pageTitle:d,__hiddenCommandManagerIds:function(e,t){if(!("initialize.customControl.command"!==t.type||e&&e[t.payload.contextKey]&&e[t.payload.contextKey][t.payload.controlId]&&-1!==e[t.payload.contextKey][t.payload.controlId].indexOf(t.payload.commandManagerId))){const n=[];e&&e[t.payload.contextKey]&&e[t.payload.contextKey][t.payload.controlId]&&n.push(...e[t.payload.contextKey][t.payload.controlId]),n.push({commandManagerId:t.payload.commandManagerId,ribbonId:t.payload.ribbonId});const r={[t.payload.controlId]:n},a=Object.assign({},e);return a[t.payload.contextKey]=a[t.payload.contextKey]||{},Object.assign(a[t.payload.contextKey],r),Object.freeze(a)}return e}(e.__hiddenCommandManagerIds,t),__pendingCommandManagerIds:function(e,t){if(!("pending.customControl.command"!==t.type||e&&e[t.payload.contextKey]&&e[t.payload.contextKey][t.payload.controlId]&&-1!==e[t.payload.contextKey][t.payload.controlId].indexOf(t.payload.commandManagerId))){const n=[];e&&e[t.payload.contextKey]&&e[t.payload.contextKey][t.payload.controlId]&&n.push(...e[t.payload.contextKey][t.payload.controlId]),n.push(t.payload.commandManagerId);const r={[t.payload.controlId]:n},a=Object.assign({},e);return a[t.payload.contextKey]=a[t.payload.contextKey]||{},Object.assign(a[t.payload.contextKey],r),Object.freeze(a)}return e}(e.__pendingCommandManagerIds,t),commandXrmCache:_(e.commandXrmCache,t),pageViewConfigurations:function(e,t){"update.views.configuration"===t.type&&(e||(e={}),e=Object.assign(Object.assign({},e),t.payload));return e}(e.pageViewConfigurations,t),gridConfigurations:function(e,t){if("update.grid.configuration"!==t.type)return e;const n=t.payload;if(!n)return e;const r=Object.assign({},e);for(const e in n)r.hasOwnProperty(e)?Object.assign(r[e],n[e]):r[e]=n[e];return Object.freeze(r)}(e.gridConfigurations,t),__lookupKeys:function(e,t){if("update.lookupRequestDataKey"!==t.type)return e;let n,r;if(t&&t.payload){let a=Object.assign({},e);for(const i in t.payload){r=e&&e[i]?Object.assign({},e[i]):{};for(const a in t.payload[i]){if(e&&e[i]&&e[i][a]){const r=Object.assign(Object.assign({},e[i][a].dataKeys),t.payload[i][a].dataKeys);n=Object.assign(Object.assign(Object.assign({},e[i][a]),t.payload[i][a]),{dataKeys:r})}else n=t.payload[i][a];r[a]=n}a=Object.assign(a,{[i]:r})}return Object.freeze(a)}return e}(e.__lookupKeys,t),pageNotifications:g(e.pageNotifications,t),isPageUnmounted:function(e=!1,t){if(t.type===f.a)return t.payload.isPageUnmounted;return e}(e.isPageUnmounted,t)}}const _=Object(s.b)("contextKey",(function(e,t){switch(t.type){case u.a:return t.payload;default:return e}}))},Lhhr:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.forEachAdditionalWindow=t.setAdditionalWindows=void 0,t.setAdditionalWindows=function(e){r=e},t.forEachAdditionalWindow=function(e){if(r)for(var t=document.querySelectorAll("[id^="+r+"]"),n=function(n){if(t[n]instanceof HTMLIFrameElement)try{e(t[n])}catch(e){var r=new Error(e.message+", src: "+t[n].src);setTimeout((function(){throw r}),0)}},a=0;a<t.length;a++)n(a)}},Lohl:function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return y}));var r=n("g0tL"),a=n("SAYH"),i=n("eXjw"),o=n("K7RF"),s=n("Uv1Y"),c=n("y60j"),l=n("lEFU"),u=n("ueZM"),d=n("TBkx"),p=n("69Qu"),g=n("iZ7K"),h=n("/oKV"),f=n("iJGp"),m=n("Lyxw"),b=n("3c7c"),_=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const y=new a.a("cad522ac-4af0-4825-befe-417de833ded7");function v(e,t,n){return{type:"form.retrieve.async",execute({dispatch:d,getState:f},v){let C=h.a.LocalAndRemote;const E=v.DataSource,I=f(),w=e.etn;let j=t;const P=n||r.a,T=v.TraceManager.getTracer("RetrieveForm");let N=Object(c.o)(I,j);if(T.warn(`RetrieveForm called: for entity: '${w}', initial form id: '${a.a.toString(j)}', form state: '${N}, retrieval strategy: '${C}'`),P===r.a)if(a.a.isNullOrEmpty(j)&&Object(p.b)(I))j=Object(l.b)(I,w),T.warn(`RetrieveForm called on edit form type, updated form id to selected form: '${a.a.toString(j)}'`);else{const e="Did not retrieve user's personalization form as either the server is not available or a specific form is being retrieved";T.warn(e)}if(a.a.isNullOrEmpty(j)){if(Object(c.i)(I,w,P)===i.a.Error)return T.warn("Current form id is null or empty and form state is error, resolve with empty guid"),Promise.resolve(a.a.EMPTY);j=Object(c.h)(I,w,P),T.warn(`Updated form id is null or empty, getting the default form id: '${a.a.toString(j)}'`)}if(N=Object(c.o)(I,j),N===i.a.Initialized&&Object(o.e)(I,Object(c.j)(I,j).OverallVersionNumber)&&(C=h.a.Remote,T.warn("Form state initialized and metadata version changed, set retrieval strategy to remote")),N!==i.a.Initialized&&N!==i.a.Error||C!==h.a.LocalAndRemote){d(function(e){const t={forms:e?{[a.a.toString(e)]:{initialized:i.a.Initializing}}:null};return{type:o.a,payload:t}}(j));const e=()=>d(O(E,j,w,P,C)),t=()=>{const e=Object(b.b)(I).map(e=>d(O(E,j,w,P,C,e)));return Promise.all(e).then(e=>e[0])};return(Object(p.b)(I)&&Object(m.c)(I,_.pb)&&Object(m.c)(I,_.lb)?t():e()).then(e=>{var t,r;if(a.a.isNullOrEmpty(j))if(e&&e.formDefaults&&e.formDefaults[w])j=e.formDefaults[w][P].formId;else{if(0===(null===(t=null==e?void 0:e.formDefaults)||void 0===t?void 0:t.length)&&0===(null===(r=null==e?void 0:e.formSelectors)||void 0===r?void 0:r.length))return y;j=a.a.EMPTY,d(function(e,t,n){const r={formDefaults:{[e]:{[t]:{formId:n,initialized:i.a.Error}}}};return{type:o.a,payload:r}}(w,n,j))}const l=f(),p=j;if(j=e&&e.forms&&e.forms.hasOwnProperty(a.a.toString(j))?j:Object(c.h)(l,w,P),a.a.equals(p,j)||(T.warn(`Previous form id does not equal updated form id, previous form id: '${a.a.toString(p)}', updated form id: '${a.a.toString(j)}'`),d(function(e){const t={forms:e?{[a.a.toString(e)]:{initialized:i.a.Error}}:null};return{type:o.a,payload:t}}(p))),j&&j!==a.a.EMPTY){const e=Object(c.j)(l,j);return e&&!e.AreLabelsSubstituted?d(Object(u.a)(j)).then(()=>j).catch(s.b):(e||T.warn(`Unbable to get form descriptor from form id: '${a.a.toString(j)}'`),j)}return S(Error("Default or required form id is not found"),v,w,j,P),j},e=>(S(e,v,w,j,P),Promise.reject(e)))}const A=Object(c.s)(I,j,w,P),D=Object(g.h)(I,w);return A&&!A.AreLabelsSubstituted||D&&D.Initialized===i.a.Uninitialized?d(Object(u.a)(A.Id)).then(()=>A.Id).catch(s.b):A?Promise.resolve(A.Id):(T.warn(`RetrieveForm called: form descriptor is null, for formid: '${a.a.toString(j)}'`),Promise.reject(j))}}}function S(e,t,n,r,i){if(t&&t.TraceManager&&t.EventManager){const o=t.TraceManager.getTracer("RetrieveForm"),s=Object(d.d)(e,o);!s.stack&&(s.stack="No stack available.");const c=[];c.push({name:"EntityLogicalName",value:n}),c.push({name:"FormType",value:i}),c.push({name:"FormID",value:r?a.a.toString(r):null}),t.EventManager.ReportComponentFailure("RetrieveForm",s,null,c)}}function O(e,t,n,i,l,u=[]){return{type:"form.retrieve.async",execute({dispatch:e,getState:d},p){const g=d(),m=Object(c.n)(g,n,i);let b=f.a.OnDemandWithoutContext;return m&&0!==Object.keys(m).length&&l!==h.a.Remote||(b=f.a.OnDemandWithContext),e(Object(o.b)("form",i,n,a.a.toLegacyGuid(t),a.a.isNullOrEmpty(t),b,null,null,u,r.b.Form,l)).catch(s.b)}}}},LqfC:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"p",(function(){return l})),n.d(t,"o",(function(){return u})),n.d(t,"m",(function(){return d})),n.d(t,"l",(function(){return p})),n.d(t,"e",(function(){return g})),n.d(t,"j",(function(){return h})),n.d(t,"h",(function(){return f})),n.d(t,"k",(function(){return m})),n.d(t,"q",(function(){return b})),n.d(t,"n",(function(){return _})),n.d(t,"i",(function(){return y}));
/**
 * Constants for the editform.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="sidepanel.loadInternal",a="sidepanel.load",i="panel.setPanelOptions",o="panel.setPanelOptionsInternal",s="panel.closeSidePanel",c="panel.closeSidePanelInternal",l="23%",u=44,d=420,p=300,g="sidepanel.ready",h="SidePanel.Expand",f="SidePanel.Collapse",m="Side_Panel_Accessibility_Label",b="SidePanelWidth",_="SidePanelState",y="Side_Panel"},"Lr+c":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){const t=[];return e.FormLibraries&&t.push(...e.FormLibraries),{UniqueId:e.UniqueId,CustomControls:i(e.CustomControls),FormLibraries:t,EventHandlers:e.EventHandlers,VersionNumber:e.VersionNumber,OverallVersionNumber:e.OverallVersionNumber,PrimaryEntityType:e.PrimaryEntityType}}function i(e){const t={};if(!e)return t;let n=0,a=-1;for(const i of e){if(null==i.FormFactor)continue;let e=i.FormFactor.toString();e||(e="unbound-"+n,n++);const s={};if(i.Parameters)for(const e of i.Parameters)s[e.Name]=e.Value;const c=s;for(const e in c)if(c[e].hasOwnProperty("Usage")){const t=c[e];t.Usage="number"==typeof t.Usage?t.Usage:o(t.Usage)}const l=r.a.isNullOrEmpty(r.a.tryParse(i.CustomControlId))?i.Name:i.CustomControlId;i.FormFactor<0&&(e=a.toString(),a--),t[e]={CustomControlId:l,Name:i.Name,DisplayNameKey:i.DisplayNameKey,FormFactor:i.FormFactor,Version:i.Version,Parameters:s,ShouldOverrideControlVisible:i.ShouldOverrideControlVisible}}return t}function o(e){switch(e){case"Bound":return 0;case"Input":return 1;case"Output":return 2;case"FalseBound":default:return 3}}},LtP7:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("nxt5");class a extends r.a{constructor(e){super("Update"),this._entityReference=null,this._entityReference=e}get_entityReference(){return this._entityReference}}},Lyxw:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){const n=e?e.fcbs:void 0;if(n){const r=n.clientFCBsByFeatureName;if(r){const n=r[t];return!!n&&(n.value||s(e,t))}}return!1}function i(e,t){const n=e?e.fcbs:void 0;if(n){const r=n.clientFCBsByFCBName;if(r){if(t in r){const n=r[t].featureName;return r[t].value||s(e,n)}return!1}}return!1}function o(e,t,n,a){const o=i(e,null==n?r.Kc:n),s=i(e,t),c=null!=a&&i(e,a);return!(!s||!o&&!c)}function s(e,t){const n=e.fcbs;if(n){const e=n.nativeFCBContext;if(e&&e[t])return e[t].value}return!1}},LzVy:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return e&&e.platform?e.platform.type:null}n.d(t,"a",(function(){return r}))},M0zh:function(e,t,n){"use strict";n.d(t,"l",(function(){return y})),n.d(t,"w",(function(){return W})),n.d(t,"g",(function(){return R})),n.d(t,"i",(function(){return x})),n.d(t,"u",(function(){return M})),n.d(t,"t",(function(){return F})),n.d(t,"c",(function(){return L})),n.d(t,"b",(function(){return B})),n.d(t,"e",(function(){return O})),n.d(t,"f",(function(){return C})),n.d(t,"d",(function(){return E})),n.d(t,"h",(function(){return k})),n.d(t,"j",(function(){return v})),n.d(t,"k",(function(){return S})),n.d(t,"s",(function(){return I})),n.d(t,"r",(function(){return w})),n.d(t,"p",(function(){return A})),n.d(t,"n",(function(){return D})),n.d(t,"o",(function(){return j})),n.d(t,"m",(function(){return P})),n.d(t,"q",(function(){return T})),n.d(t,"a",(function(){return N})),n.d(t,"v",(function(){return J}));var r=n("SRl2"),a=n("Lyxw"),i=n("3/02"),o=n("eXjw"),s=n("iZ7K"),c=n("ZoNW"),l=n("Uv1Y"),u=n("FZDd"),d=n("2XFH"),p=n("K7RF"),g=n("EY5k"),h=n("YxC/"),f=n("99zj"),m=n("69Qu"),b=n("/oKV"),_=n("iJGp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const y="ribbon.retrieve",v="ribbon.commandingstate.initial",S="ribbon.commandingstate.batch",O="ribbon.evaluaterule",C="ribbon.evaluaterule.initial",E="ribbon.evaluaterules.batch",I="ribbon.storerulecontext",w="ribbon.storeribbonid",j="ribbon.createdcontainer",P="ribbon.storeallowlistmap",T="ribbon.storenoncacheablerulemap",N="ribbon.destroycommandbar",A="ribbon.storeflyoutxml",D="ribbon.storecontexttoken",R="Form:",x="HomePageGrid:",M="SubGridStandard:",F="SubGridAssociated:",k="Global:",L="EntityLogicalNameMarker",B="EntityLogicalNameCollectionMarker",U=/\{\!EntityDisplayName:([^)]+)\}/i,V=/\$Resources(?:\(([^)]+)\))?:(.+)/i,z=/\$LocLabels(?:\(([^)]+)\))?:(.+)/i;function W(e,t){return{type:"ribbon.retrieve.async",cacheKey:e,execute({dispatch:n,getState:s},c){let l=b.a.LocalAndRemote;const u=s(),d=Object(r.d)(u,e);Object(m.b)(u)&&d===o.a.Initialized&&Object(p.e)(u,Object(r.b)(u,e).OverallVersionNumber)&&(l=b.a.Remote);const g=e&&e.split(":");if(!g||2!==g.length||!g[0]||!g[1])return c.TraceManager.getTracer("Commanding").warn("The ribbonId passed to the retrieveRibbon function is not of the form ContextType:EntityType, it has the following value instead: "+e),Promise.resolve();const f=g[0],_=g[1],v=Object(r.a)(u,e)&&d!==o.a.Initializing&&d!==o.a.Refreshing;if(d===o.a.Uninitialized||d===o.a.Error||v||l!==b.a.LocalAndRemote)return n(function(e,t,n){const a=Object(r.b)(e,t),i=t?{[t]:Object.assign(Object.assign({},a),{initialized:n?o.a.Refreshing:o.a.Initializing})}:null;return{type:y,payload:{ribbons:i}}}(u,e.toString(),v)),ie(n,_,f,l).then(c=>{if(Object(a.c)(u,i.Jc)&&"null"!==_&&_!==L&&(!c.ribbons[e]||!c.ribbons[e].Layout)){const a=f+":"+L,i=Object(r.b)(u,e);if((null==i?void 0:i.initialized)===o.a.Initialized){const t=function(e){const t={initialized:o.a.Initialized,IsUncustomized:!0,Localized:!0},n={ribbons:{}};return n.ribbons[e]=t,n}(e);return n(oe(t)),Promise.resolve()}return ie(n,"RibbonClientMetadataCacheLoaderDummyEntity",f,l).then(r=>function(e,t,n,r,a,i){const s=a.ribbons[r],c={initialized:o.a.Initialized,IsUncustomized:!0};return a.ribbons[n]=c,$(t(),e,s,a.ribbonsLabelIds,L,i).then(()=>{const n=t(),r=n.metadata.labels,i=Object(h.d)(n);e(H(t(),s,a.ribbonsLabelIds,r,i,L)),e(oe(a))})}(n,s,e,a,r,t))}return q(n,s,e,c,_,t)}).catch(t=>{!function(e,t,n,r){const a=[];a.push({name:"RibbonId",value:n}),t.EventManager.ReportComponentFailure("Commanding.Components.CommandManager.loadMetadata",r,"Error loading metadata",a),e(function(e){const t=e?{[e]:{initialized:o.a.Error}}:null;return{type:y,payload:{ribbons:t}}}(n))}(n,c,e,t)});const S=Object(r.b)(u,e);if(S&&S.Commands){const a={ribbons:{[e]:S}};if(!S.Localized)return a.ribbonsLabelIds=Object(r.c)(u),q(n,s,e,a,_,t);n(oe(a))}return Promise.resolve()}}}function q(e,t,n,r,a,i){const o=r.ribbons[n];return $(t(),e,o,r.ribbonsLabelIds,a,i).then(()=>{const n=t(),i=n.metadata.labels,s=Object(h.d)(n);e(H(n,o,r.ribbonsLabelIds,i,s,a)),e(oe(r))})}function H(e,t,n,r,a,i){return{type:"ribbon.localizeribbon",execute({dispatch:o,getState:s},c){if(t&&t.Layout){let s=new Array;t.Layout.Tabs.Tab&&(s=s.concat(t.Layout.Tabs.Tab)),t.Layout.ContextualTabs.Tab&&(s=s.concat(t.Layout.ContextualTabs.Tab)),s.forEach(t=>{t&&t.Groups&&t.Groups.Group&&t.Groups.Group.forEach(t=>{t.Controls.Items.forEach(t=>{const s=K(e,o,n,r,a,i),c=G(e,o,n,r,a,i);c(t),Y(t,c,s)})})}),t.Localized=!0,t.LoadedWhileOffline=!Object(m.b)(e)}return Promise.resolve(t)}}}function G(e,t,n,r,a,i){return o=>(o&&(o.Alt=t(Q(e,n,r,a,i,o.Alt)),o.LabelText=t(Q(e,n,r,a,i,o.LabelText)),o.ToolTipDescription=t(Q(e,n,r,a,i,o.ToolTipDescription)),o.ToolTipTitle=t(Q(e,n,r,a,i,o.ToolTipTitle))),!0)}function K(e,t,n,r,a,i){return o=>(o&&(o.Title=t(Q(e,n,r,a,i,o.Title))),!0)}function Q(e,t,n,r,a,i){return{type:"ribbon.localizestring",sync:!0,execute({dispatch:o,getState:c},l){let u=i;if(i){const o=U.exec(i),c=V.exec(i),l=z.exec(i);if(o&&o.length>1&&o[1]){u=Object(s.f)(e,o[1])||u}else if(c&&c.length>2){let t=r[c[2]];c[1]&&(t=X(e,a,c[1],t)),u=t||u}else if(l&&l.length>2&&l[2]){const r=t&&t[l[2]];r&&n[r]&&n[r][l[2]]&&(u=n[r][l[2]],l[1]&&(u=X(e,a,l[1],u)))}}return u}}}function X(e,t,n,r){if(!r)return null;let a=r;return"EntityDisplayName"===n.trim()?a=String.format(a,Object(s.f)(e,t)):"EntityPluralDisplayName"===n.trim()&&(a=String.format(a,Object(s.e)(e,t))),a}function Y(e,t,n){"Menu"in e&&e&&e.Menu&&e.Menu.MenuSection&&e.Menu.MenuSection.length&&(e.Menu.MenuSection=e.Menu.MenuSection.filter(e=>{const r=e&&n(e);return r&&e.Item&&e.Item.Items&&(e.Item.Items=e.Item.Items.filter(e=>{const r=e&&t(e);return r&&Y(e,t,n),r})),r}))}function J(e,t,n,r,a){const i={},o=[],s=e(),c=e=>{const t=ee(s,e.Title,i,a);return t&&ae(e.Title,o),t},l=e=>{let t=ee(s,e.Alt,i,a);return t=t&&ee(s,e.LabelText,i,a),t=t&&ee(s,e.ToolTipDescription,i,a),t=t&&ee(s,e.ToolTipTitle,i,a),t&&(ae(e.Alt,o),ae(e.LabelText,o),ae(e.ToolTipDescription,o),ae(e.ToolTipTitle,o)),t};return n&&n.MenuSection&&n.MenuSection.length&&(n.MenuSection=n.MenuSection.filter(e=>(c(e),e.Item&&e.Item.Items&&e.Item.Items.length&&(e.Item.Items=e.Item.Items.filter(e=>{const t=e&&l(e);return t&&Y(e,l,c),t})),e.Item&&e.Item.Items&&e.Item.Items.length>0))),Promise.all([t(Object(u.e)(i)),t(Object(g.e)(o))]).then(()=>{const a=e(),i=a.metadata.labels,o=Object(h.d)(a),s=a.metadata.ribbonsLabelIds,c=K(a,t,s,i,o,r),l=G(a,t,s,i,o,r);return n&&n.MenuSection&&n.MenuSection.length&&n.MenuSection.forEach(e=>{c(e),e.Item&&e.Item.Items&&e.Item.Items.length&&e.Item.Items.forEach(e=>{l(e),Y(e,l,c)})}),n})}function $(e,t,n,r,a,i){return Promise.all([ne(e,t,n,r),Z(e,t,n,a,i),re(t,n)])}function Z(e,t,n,r,a){const i={},o=[];if(n&&n.Layout){const t=n.Layout;te(e,i,r);let s=new Array;t.Tabs.Tab&&(s=s.concat(t.Tabs.Tab)),t.ContextualTabs.Tab&&(s=s.concat(t.ContextualTabs.Tab)),s.forEach(t=>{if(t){let n;if(t&&t.Groups&&t.Groups.Group)for(n=0;n<t.Groups.Group.length;n++){const r=t=>{const n=ee(e,t.Title,i,a);return n&&ae(t.Title,o),n},s=t=>{let n=ee(e,t.Alt,i,a);return n=n&&ee(e,t.LabelText,i,a),n=n&&ee(e,t.ToolTipDescription,i,a),n=n&&ee(e,t.ToolTipTitle,i,a),n&&(ae(t.Alt,o),ae(t.LabelText,o),ae(t.ToolTipDescription,o),ae(t.ToolTipTitle,o)),n};t.Groups.Group[n].Controls.Items?t.Groups.Group[n].Controls.Items=t.Groups.Group[n].Controls.Items.filter(e=>{const t=e&&s(e);return t&&Y(e,s,r),t}):t.Groups.Group[n].Controls.Items=[]}}})}return Promise.all([t(Object(u.e)(i)),t(Object(g.e)(o))])}function ee(e,t,n,r){let a=!0;if(t){const i=U.exec(t);if(i&&i.length>1&&i[1]&&i[1].length>0){const t=i[1]&&i[1].toLowerCase();a=function(e,t,n){return Object(m.b)(e)||n(e,t)}(e,t,r),a&&te(e,n,t)}}return a}function te(e,t,n){!n||"undefined"===n.toLowerCase()||"null"===n.toLowerCase()||Object(s.f)(e,n)&&Object(s.e)(e,n)||(t[n]=[])}function ne(e,t,n,r){let a=[];for(const e in r){const t=r[e]+":"+e;a.push(t)}return a=Object(c.a)(e,a),t(Object(d.a)(a))}function re(e,t){if(t){const n=/^\$webresource:/i,r=new Array;if(t.Commands){const e=t.Commands;for(const t in e)for(const a in e[t]){const i=e[t][a];if(i){const e=i.Actions.filter(e=>3===e.ActionType);for(const t of e)if(t.Attributes){const e=t.Attributes;e.Library&&-1!==e.Library.search(n)&&r.push(e.Library)}}}}if(t.EnableRules){const e=t.EnableRules;for(const t in e)for(const a in e[t]){const i=e[t][a];if(i){const e=i.Rules.filter(e=>4===e.RuleType);for(const t of e)t.Library&&-1!==t.Library.search(n)&&r.push(t.Library)}}}if(r.length>0)return e(Object(f.d)(r))}return Promise.resolve([null])}function ae(e,t){const n=V.exec(e);n&&n.length>2&&t.push(n[2])}function ie(e,t,n,r){return e(Object(p.b)("ribbon",null,t,null,!1,_.a.OnDemandWithoutContext,null,null,[n],null,r)).catch(a=>{if("RibbonClientMetadataCacheLoaderDummyEntity"!==t)return function(e,t,n,r,a){return e(Object(p.b)("ribbon",null,t,null,!1,_.a.OnDemandWithoutContext,null,null,[n],null,r)).catch(l.b)}(e,"RibbonClientMetadataCacheLoaderDummyEntity",n,r);Object(l.b)(a)})}function oe(e){return{type:y,payload:e}}},M1jQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{}},M6Hl:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="polite"},M6xi:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{read(e,t){return e[t.get_name()]}write(e,t,n){("number"!=typeof n||isFinite(n))&&(e[t.get_name()]=n)}}r.defaultConverter=new r},M8lA:function(e,t,n){"use strict";function r(e,t){return!!(e.appShellState&&e.appShellState.modalComponentState&&e.appShellState.modalComponentState.modalComponentsOpenState)&&e.appShellState.modalComponentState.modalComponentsOpenState[t]}function a(e){if(e.appShellState&&e.appShellState.modalComponentState&&e.appShellState.modalComponentState.modalComponentsOpenState){return Object.keys(e.appShellState.modalComponentState.modalComponentsOpenState).some(t=>r(e,t))}return!1}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},MIBb:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("arV0"),a=n("pF61"),i=n("IaGr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t,n,o,s){if(n.ScriptManager.containerExists(o))return n.ScriptManager.getContainer(o);s||(s=[]),e+=".safeGetContainer",s.push({name:"pageId",value:o});const c=Object(r.l)(t,o);return s.push({name:"pageType",value:c}),Object(a.n)(t,o)?(n.TraceManager.getTracer(e).warn("The page is dead, canceling the action",s),null):(i.a.getInstance().eventManager.ReportComponentFailure(e,new Error("Container does not exist"),null,s),null)}},MOEv:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="formnotification_"},MQTY:function(e,t,n){"use strict";n.r(t),n.d(t,"SYSTEM_DASHBOARD_LABEL_ID",(function(){return r})),n.d(t,"USER_DASHBOARD_LABEL_ID",(function(){return a})),n.d(t,"DASHBOARD_SELECTOR_TOOLTIP",(function(){return i})),n.d(t,"labelList",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="CRM_System_Dashboards_Group_Name",a="CRM_User_Dashboards_Group_Name",i="DashBoard_Selector_Text_UClient",o=[r,a,i]},MQpb:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("jYot"),a=n("RIwK");function i(e){const t=[];e.addNamespace("c","http://schemas.microsoft.com/xrm/2012/Contracts");const n=e.selectNodes("c:OrganizationRequest");for(let e=0;e<n.get_count();e++)t.push(Object(r.b)(n.get_item(e)));return t}function o(e){const t=new Sys.StringBuilder;for(const n of e)t.append('<c:OrganizationRequest i:type="a:'+n.get_name()+'Request">'),t.append("<a:Parameters>"),t.append(Object(r.d)(n)),null!==n.offlineData&&(t.append('<a:KeyValuePairOfstringanyType><b:key>tag</b:key><b:value i:type="c:string" xmlns:c="http://www.w3.org/2001/XMLSchema">'+Object(a.b)("offlinePlayback")+"</b:value>"),t.append("</a:KeyValuePairOfstringanyType>")),t.append("</a:Parameters>"),t.append("<a:RequestName>"),t.append(n.get_name()),t.append("</a:RequestName>"),t.append("</c:OrganizationRequest>");return t.toString()}},MUIu:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return p}));var r=n("504W"),a=n("qCX6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let i=null,o=null;function s(){return new Date(0)}function c(){return i||(i=new RegExp("[Z,T]","ig"))}function l(e){if(Object(r.a)(e.firstChild)||Object(r.b)(e.firstChild.nodeValue))return s();let t=e.firstChild.nodeValue.replace(c()," ");return t=d(t),new Date(Date.parse(t))}function u(e){return Object(r.a)(e)||e===s()?"":e.toJSON()}function d(e){e=e.lastIndexOf(".")>-1?e.substr(0,e.lastIndexOf(".")):e;return a.a.get_instance().get_offlineDataSource().isDssOfflineEnabled()&&(e=e.replace(c()," ")),e.replace(o||(o=new RegExp("[-]","ig")),"/")+" UTC"}function p(e){return e.replace(c()," ")}},MXaZ:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"n",(function(){return l})),n.d(t,"t",(function(){return u})),n.d(t,"o",(function(){return d})),n.d(t,"p",(function(){return p})),n.d(t,"k",(function(){return g})),n.d(t,"i",(function(){return h})),n.d(t,"h",(function(){return f})),n.d(t,"g",(function(){return m})),n.d(t,"m",(function(){return b})),n.d(t,"F",(function(){return _})),n.d(t,"s",(function(){return v})),n.d(t,"G",(function(){return C})),n.d(t,"l",(function(){return E})),n.d(t,"q",(function(){return I})),n.d(t,"I",(function(){return w})),n.d(t,"z",(function(){return j})),n.d(t,"A",(function(){return P})),n.d(t,"v",(function(){return T})),n.d(t,"u",(function(){return N})),n.d(t,"w",(function(){return A})),n.d(t,"x",(function(){return D})),n.d(t,"B",(function(){return R})),n.d(t,"C",(function(){return x})),n.d(t,"D",(function(){return M})),n.d(t,"E",(function(){return F})),n.d(t,"H",(function(){return k})),n.d(t,"c",(function(){return L})),n.d(t,"e",(function(){return B})),n.d(t,"d",(function(){return U})),n.d(t,"f",(function(){return V})),n.d(t,"j",(function(){return z})),n.d(t,"r",(function(){return W})),n.d(t,"y",(function(){return q}));var r=n("Ae6N");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a=6e4;function i(e,t){return/8|3|5|10/.test(e.toString())?30:1!==e?31:o(t)?29:28}function o(e){return e%4==0&&e%100!=0||e%400==0}var s,c;function l(e,t){if(e.isFixedDateRule)return new Date(t,e.month,e.day,e.timeOfDay.getHours(),e.timeOfDay.getMinutes(),e.timeOfDay.getSeconds());const n=7*e.week-6,r=new Date(t,e.month,1).getDay();let a;return a=r>e.dayOfWeek?n+(7-r+e.dayOfWeek):n+(e.dayOfWeek-r),a>i(e.month,t)&&(a-=7),new Date(t,e.month,a,e.timeOfDay.getHours(),e.timeOfDay.getMinutes(),e.timeOfDay.getSeconds())}function u(e,t){const n=t.getFullYear(),r=l(e.daylightStart,n),a=l(e.daylightEnd,n);if(a<r){if(t>r||t<a)return e.delta}else if(t>r&&t<a)return e.delta;return 0}function d(e,t){if(!t)return 0;let n;const r=new Date(e.getTime());r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0);for(let e=0;e<t.length;e++){const a=t[e].dateStart,i=t[e].dateEnd;if(r>=a&&r<=i){n=t[e];break}}return n?u(n,e):0}function p(e,t){return d(e,t)/a}function g(e){const t=Date.parse(e);return isNaN(t)?void 0:new Date(t)}function h(e,t,n){if(!e)return e;let r=t*a;r+=d(e,n);const i=e.getTimezoneOffset()*a;return new Date(e.getTime()+r+i)}function f(e,t,n){if(!e)return e;let r=t*a;r+=d(e,n);const i=e.getTimezoneOffset()*a;return new Date(e.getTime()-r-i)}function m(e){if(!e)return e;const t=e.getTimezoneOffset()*a;return new Date(e.getTime()-t)}function b(e,t,n,i){switch(n){case r.a.DateOnly:case r.a.TimeZoneIndependent:return function(e){return new Date(e.getTime()+e.getTimezoneOffset()*a)}(e);case r.a.UserLocal:return h(e,t,i);default:return new Date(e.getTime())}}function _(e,t,n,r=!1){return r?function(e,t,n){if(t<s.Sunday||t>s.Saturday)throw new Error("Argument 'firstDayOfWeek' is out of range");const r=y(e.getFullYear()-1,t,n),a=y(e.getFullYear(),t,n),i=y(e.getFullYear()+1,t,n);let o;o=e.valueOf()<a.valueOf()?r:e.valueOf()<i.valueOf()?a:i;const c=(e.valueOf()-o.valueOf()+864e5)/6048e5;return Math.ceil(c)}(e,t,n):function(e,t,n){if(t<s.Sunday||t>s.Saturday)throw new Error("Argument 'firstDayOfWeek' is out of range");return C(e,t,7)}(e,t)}function y(e,t,n){return O(new Date(e,0,S(n)),t)}function v(e,t,n,r){const a=7*(t-1);return O(new Date(e,0,S(r)+a),n)}function S(e){let t;switch(e){case c.FirstFourDayFullWeekOfTheYear:t=4;break;case c.FirstFullWeekOfTheYear:t=7;break;case c.FirstDayOfTheYear:default:t=1}return t}function O(e,t){e.setHours(0,0,0,0);const n=(e.getDay()+7-t)%7,r=new Date(e.getTime()-60*(24*n-2)*60*1e3);return r.setHours(0,0,0,0),r}function C(e,t,n){let r=function(e){let t=0;for(let n=0;n<e.getMonth();n++)t+=i(n,e.getFullYear());return t+=e.getDate(),t}(e)-1,a=e.getDay()-r%7,s=(t-a+14)%7;0!==s&&s>=n&&(s-=7);let c=r-s;if(c<0){r=o(e.getFullYear()-1)?366:365,a-=r%7,s=(t-a+14)%7,0!==s&&s>=n&&(s-=7),c=r-s}return Math.floor(c/7+1)}function E(e,t,n,i){switch(n){case r.a.DateOnly:case r.a.TimeZoneIndependent:return function(e){return new Date(e.getTime()-e.getTimezoneOffset()*a)}(e);case r.a.UserLocal:return f(e,t,i);default:return new Date(e.getTime())}}function I(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function w(e){return e.map(e=>({dateStart:e.get_DateStart(),dateEnd:e.get_DateEnd(),daylightStart:{day:e.get_DaylightStart().get_Day(),month:e.get_DaylightStart().get_Month(),dayOfWeek:e.get_DaylightStart().get_DayOfWeek(),week:e.get_DaylightStart().get_Week(),timeOfDay:new Date(e.get_DaylightStart().get_TimeOfDay()),isFixedDateRule:e.get_DaylightStart().get_IsFixedDataRule()},delta:e.get_Delta(),daylightEnd:{day:e.get_DaylightEnd().get_Day(),month:e.get_DaylightEnd().get_Month(),dayOfWeek:e.get_DaylightEnd().get_DayOfWeek(),week:e.get_DaylightEnd().get_Week(),timeOfDay:new Date(e.get_DaylightEnd().get_TimeOfDay()),isFixedDateRule:e.get_DaylightEnd().get_IsFixedDataRule()}}))}function j(e){const t=new Date(Date.now()),n=t.getTimezoneOffset()*a,r=e.get_UserSettings().get_timeZoneUtcOffsetMinutes()*a;return new Date(t.getTime()+n+r)}function P(e){const t=j(e),n=d(t,w(e.get_TimeZoneAdjusters()));return new Date(t.getTime()+n)}function T(e){return e.setMinutes(0,0,0),e}function N(e){return e.setHours(0,0,0,0),e}function A(e){const t=N(e);return t.setDate(1),t}function D(e){const t=A(e);return t.setMonth(0),t}function R(e){return Math.trunc(e.get_UserSettings().get_timeZoneUtcOffsetMinutes()/60)}function x(e){return e.get_UserSettings().get_timeZoneUtcOffsetMinutes()%60}function M(e){return-1*R(e)}function F(e){return-1*x(e)}function k(e,t){const n=e.get_UserSettings().get_dateTimeFormatInfo().FirstDayOfWeek;return(t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0)).getDay()<n?L(t,n-t.getDay()-7):L(t,n-t.getDay())}function L(e,t){const n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());return n.setDate(e.getDate()+t),n}function B(e,t){return L(e,7*t)}function U(e,t){const n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());return n.setMonth(e.getMonth()+t),n}function V(e,t){const n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());return n.setFullYear(e.getFullYear()+t),n}function z(e,t){let n=e.get_UserSettings().get_timeZoneUtcOffsetMinutes()*a;n+=d(t,w(e.get_TimeZoneAdjusters()));return new Date(t.getTime()-n)}function W(e){return String.format("'{0}-{1:D2}-{2:D2} {3:D2}:{4:D2}:{5:D2}.{6:D3}'",e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function q(e,t){return W(z(e,t))}!function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(s||(s={})),function(e){e[e.FirstDayOfTheYear=0]="FirstDayOfTheYear",e[e.FirstFullWeekOfTheYear=1]="FirstFullWeekOfTheYear",e[e.FirstFourDayFullWeekOfTheYear=2]="FirstFourDayFullWeekOfTheYear"}(c||(c={}))},Me5Q:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("mpSO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){return{type:r.i,payload:{initializationState:e},meta:{commandManagerId:t}}}},MktZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="page.setLoadingState";function a(e,t){return{type:r,payload:t,meta:{pageId:e}}}},MqQG:function(e,t,n){"use strict";n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return p}));var r=n("nuS9"),a=n("4fxQ"),i=n("YWpA"),o=n("e9UD"),s=n("Afz2"),c=n("H/hG"),l=n("n2e+"),u=n("YxC/"),d=n("sTJm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const p="appProgressIndicatorAccessibility";class g extends r.Component{constructor(e){super(e),this._viewKeyboardHandler=this._viewKeyboardHandler.bind(this),this._appProgressIndicatorRootViewRefFocus=this._appProgressIndicatorRootViewRefFocus.bind(this),this.state={hasFocused:!1,currentAnnounceMessage:e.message,reannounce:!1},l.a.some(t=>!Object(u.c)(e.resourceStrings,t))&&e.retrieveResourceStrings(l.a)}componentDidMount(){this._setIsProgressIndicatorVisibile()}componentDidUpdate(){this._setIsProgressIndicatorVisibile()}_appProgressIndicatorRootViewRefFocus(e){if(e){const t=a.findDOMNode(e);requestAnimationFrame(()=>{t.focus(),this.setState({hasFocused:!0})})}}_viewKeyboardHandler(e){e.stopPropagation(),e.preventDefault()}_renderProgressIndicator(){return r.createElement(o.a,{accessibilityHidden:!0,testhooks:{id:"globalAppProgressIndicator"},key:"globalAppProgressIndicator",id:"global-app-progress-indicator",progressType:"ring",active:!0,style:this.props.progressIndicatorIndicatorStyle})}_renderMessages(){const{message:e,progressIndicatorTextStyle:t}=this.props;return e&&e.indexOf("\n")>0?e.split("\n").map((e,n)=>r.createElement(c.a,{accessibilityLabel:e,id:"appProgressIndicatorMessage"+n,key:"appProgressIndicatorMessage"+n,style:t,testhooks:{id:"appProgressIndicatorMessage"+n},tabIndex:-1,accessibilityLive:"assertive",accessibilityHidden:!0},e)):e?r.createElement(c.a,{accessibilityLabel:this.props.message,id:"appProgressIndicatorMessage",key:"appProgressIndicatorMessage",style:t,testhooks:{id:"appProgressIndicatorMessage"},tabIndex:-1,accessibilityLive:"assertive",accessibilityHidden:!0},e):null}_renderAccessibilityAlert(){const{isInProgress:e,progressIndicatorAccessibilityAlertStyle:t}=this.props,{hasFocused:n,reannounce:o,currentAnnounceMessage:c}=this.state;return a.createPortal(r.createElement(i.a,{accessibilityLive:"assertive",role:s.a,style:t,key:p,id:p}," ",e&&n&&c&&!o?c.replace("\n"," "):""),document.body)}_setIsProgressIndicatorVisibile(){this.props&&this.props.setIsProgressIndicatorVisibile&&this.props.setIsProgressIndicatorVisibile(this.props.isInProgress,"appProgressIndicatorView_popupContainer")}render(){const{isInProgress:e,progressIndicatorBackgroundContainerStyle:t,progressIndicatorContentStyle:n,progressIndicatorContainerStyle:a}=this.props;return r.createElement(r.Fragment,null,e?r.createElement(d.b,{id:"appProgressIndicatorView",key:"appProgressIndicatorPopup"},r.createElement(i.a,{tabIndex:-1,accessibilityLabel:" ",onKeyDown:this._viewKeyboardHandler,ref:this._appProgressIndicatorRootViewRefFocus,testhooks:{id:"appProgressIndicatorView"},id:"appProgressIndicatorView",key:"appProgressIndicatorView",style:t},r.createElement(i.a,{testhooks:{id:"appProgressIndicatorContent"},id:"appProgressIndicatorContent",key:"appProgressIndicatorContent",style:n,accessibilityHidden:!0},r.createElement(i.a,{testhooks:{id:"appProgressIndicatorContainer"},id:"appProgressIndicatorContainer",key:"appProgressIndicatorContainer",style:a,accessibilityHidden:!0},this._renderProgressIndicator()),this._renderMessages()))):null,this._renderAccessibilityAlert())}componentWillReceiveProps(e){if(this.props.isInProgress||!0!==e.isInProgress)e.isInProgress||!0!==this.props.isInProgress||clearInterval(this._setTimeIntervalId);else{let t=0;this.setState({currentAnnounceMessage:e.message});const n=()=>{this.setState({reannounce:!1}),this.forceUpdate()},r=()=>{t+=5e3,this.props.message===this.state.currentAnnounceMessage&&3e4!==t||this.setState({currentAnnounceMessage:this.props.message,reannounce:!0},n),3e4===t&&(t=0)};this._setTimeIntervalId=setInterval(r,5e3)}}}g.displayName="AppProgressIndicator"},Mr6u:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a extends r.a{constructor(e){super(),this._query=null,this._query=e}get_name(){return"RetrieveMultiple"}get_xmlNamespace(){return"http://schemas.microsoft.com/xrm/2011/Contracts"}get_query(){return this._query}}},N0PS:function(e,t,n){"use strict";n.d(t,"b",(function(){return gn})),n.d(t,"a",(function(){return hn}));var r=n("ABCl"),a=n("Z4sG"),i=n("E7fB"),o=n("zsAz"),s=n("SAYH"),c=n("YxC/"),l=n("7tM0"),u=n("cUbT"),d=n("EY5k"),p=n("w72X"),g=n("FZDd"),h=n("K7RF"),f=n("g0tL"),m=n("iJGp"),b=n("/oKV"),_=n("y60j"),y=n("16wZ"),v=n("iZ7K"),S=n("LbMF"),O=n("ZIjf"),C=n("qshH");class E{constructor(e){this._attributeType=null;e||Object(y.j)("ClientApi.XrmAttributeMetadata.constructor","attributeDescriptor"),this.attributeDescriptor=e,this._logicalName=e.LogicalName,this._displayName=e.DisplayName,this._entityLogicalName=e.EntityLogicalName}get LogicalName(){return O.a.instance.reportUsage("ClientApi.XrmAttributeMetadata.LogicalName"),this._logicalName}get DisplayName(){return O.a.instance.reportUsage("ClientApi.XrmAttributeMetadata.DisplayName"),this._displayName}get AttributeType(){const e="ClientApi.XrmAttributeMetadata.AttributeType";try{if(O.a.instance.reportCall(e),!this._attributeType)switch(this.attributeDescriptor.Type){case"string":this._attributeType=14;break;case"datetime":this._attributeType=2;break;case"decimal":this._attributeType=3;break;case"double":this._attributeType=4;break;case"integer":this._attributeType=5;break;case"lookup":this._attributeType=6;break;case"memo":this._attributeType=7;break;case"money":this._attributeType=8;break;case"owner":this._attributeType=9;break;case"customer":this._attributeType=1;break;case"partylist":this._attributeType=10;break;case"uniqueidentifier":this._attributeType=15;break;case"bigint":this._attributeType=18;break;case"calendarrules":this._attributeType=16;break;case"virtual":this._attributeType=17;break;case"entityname":this._attributeType=20;break;case"managedproperty":this._attributeType=19;break;case"image":this._attributeType=23;break;case"boolean":this._attributeType=0;break;case"picklist":case"optionset":this._attributeType=11;break;case"state":this._attributeType=12;break;case"status":this._attributeType=13;break;default:Object(y.h)(e,"AttributeType",this.attributeDescriptor.Type)}return O.a.instance.reportSuccess(e),this._attributeType}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}get EntityLogicalName(){return O.a.instance.reportUsage("ClientApi.XrmAttributeMetadata.EntityLogicalName"),this._entityLogicalName}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class I extends E{constructor(e){super(e),this._optionSet=null,this.defaultFormValue=e.DefaultValue}get OptionSet(){const e="ClientApi.XrmEnumAttributeMetadata.OptionSet";try{if(O.a.instance.reportCall(e),null===this._optionSet){this._optionSet={};const e=this.attributeDescriptor.OptionSet;if(e)for(let t=0;t<e.length;t++){const n={text:e[t].Label,value:e[t].Value};this._optionSet[e[t].Value]=n}}return O.a.instance.reportSuccess(e),this._optionSet}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class w extends I{get DefaultFormValue(){return O.a.instance.reportUsage("ClientApi.XrmBooleanAttributeMetadata.DefaultFormValue"),!!this.defaultFormValue}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class j extends E{constructor(e){super(e),this._attributeTargets=e.Targets}get Targets(){return O.a.instance.reportUsage("ClientApi.XrmLookupAttributeMetadata.Targets"),this._attributeTargets}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class P extends I{get DefaultFormValue(){return O.a.instance.reportUsage("ClientApi.XrmPicklistAttributeMetadata.DefaultFormValue"),this.defaultFormValue}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let T;class N extends I{constructor(e,t){super(t),T=e}getDefaultStatus(e){const t="ClientApi.XrmStateAttributeMetadata.getDefaultStatus";(Object(y.a)(e)||isNaN(e))&&Object(y.h)(t,"state",e);try{O.a.instance.reportCall(t);const n=this.attributeDescriptor.OptionSet;if(n)for(let r=0;r<n.length;r++)if(n[r].Value===e)return O.a.instance.reportSuccess(t),n[r].DefaultStatus}catch(n){const r=[];throw r.push({name:"state",value:e}),r.push({name:"AttributeType",value:this.AttributeType}),r.push({name:"DisplayName",value:this.DisplayName}),r.push({name:"EntityLogicalName",value:this.EntityLogicalName}),r.push({name:"LogicalName",value:this.LogicalName}),C.a.getInstance().reportFailure(t,n,"",r),n}O.a.instance.reportSuccess(t),Object(y.h)(t,"state",e)}getStatusValuesForState(e){const t="ClientApi.XrmStateAttributeMetadata.getStatusValuesForState";(Object(y.a)(e)||isNaN(e))&&Object(y.h)(t,"state",e);try{O.a.instance.reportCall(t);const n=[],r=Object(S.a)(T.getState(),this.EntityLogicalName,"statuscode").OptionSet;if(r)for(const t of r)t.State===e&&n.push(t.Value);return O.a.instance.reportSuccess(t),n}catch(n){const r=[];throw r.push({name:"state",value:e}),r.push({name:"AttributeType",value:this.AttributeType}),r.push({name:"DisplayName",value:this.DisplayName}),r.push({name:"EntityLogicalName",value:this.EntityLogicalName}),r.push({name:"LogicalName",value:this.LogicalName}),C.a.getInstance().reportFailure(t,n,"",r),n}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class A extends I{getState(e){const t="ClientApi.XrmStatusAttributeMetadata.getState";(Object(y.a)(e)||isNaN(e))&&Object(y.h)(t,"status",e);try{O.a.instance.reportCall(t);const n=this.attributeDescriptor.OptionSet;if(n)for(let r=0;r<n.length;r++)if(n[r].Value===e)return O.a.instance.reportSuccess(t),n[r].State}catch(n){const r=[];throw r.push({name:"status",value:e}),r.push({name:"AttributeType",value:this.AttributeType}),r.push({name:"DisplayName",value:this.DisplayName}),r.push({name:"EntityLogicalName",value:this.EntityLogicalName}),r.push({name:"LogicalName",value:this.LogicalName}),C.a.getInstance().reportFailure(t,n,"",r),n}O.a.instance.reportSuccess(t),Object(y.h)(t,"status",e)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function D(e,t){t||Object(y.j)("ClientApi.XrmAttributeMetadataFactory.getAttributeMetadataInstance","attributeDescriptor");let n=null;switch(t.Type){case"state":n=new N(e,t);break;case"status":n=new A(t);break;case"optionset":case"picklist":n=new P(t);break;case"boolean":n=new w(t);break;case"lookup":n=new j(t);break;default:n=new E(t)}return n}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class R{constructor(e){this._behavior=null,this._group=null;e||Object(y.j)("ClientApi.XrmAssociatedMenuConfiguration.constructor","associatedMenuConfiguration"),this._associatedMenuConfiguration=e,this._availableOffline=e.AvailableOffline,this._icon=e.Icon,this._isCustomizable=e.IsCustomizable,this._label=e.Label,this._menuId=e.MenuId,this._order=e.Order,this._queryApi=e.QueryApi,this._viewId=e.ViewId?e.ViewId.guid:null}get AvailableOffline(){return O.a.instance.reportUsage("ClientApi.XrmAssociatedMenuConfiguration.AvailableOffline"),this._availableOffline}get Behavior(){const e="ClientApi.XrmAssociatedMenuConfiguration.Behavior";try{if(O.a.instance.reportCall(e),null===this._behavior)switch(this._associatedMenuConfiguration.Behavior){case 2:this._behavior=2;break;case 0:this._behavior=0;break;case 1:this._behavior=1;break;default:Object(y.h)(e,"Behavior",this._associatedMenuConfiguration.Behavior)}return O.a.instance.reportSuccess(e),this._behavior}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}get Group(){const e="ClientApi.XrmAssociatedMenuConfiguration.Group";try{if(O.a.instance.reportCall(e),null===this._group)switch(this._associatedMenuConfiguration.Group){case 0:this._group=0;break;case 3:this._group=3;break;case 1:this._group=1;break;case 2:this._group=2;break;default:Object(y.h)(e,"Group",this._associatedMenuConfiguration.Group)}return O.a.instance.reportSuccess(e),this._group}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}get Icon(){return O.a.instance.reportUsage("ClientApi.XrmAssociatedMenuConfiguration.Icon"),this._icon}get IsCustomizable(){return O.a.instance.reportUsage("ClientApi.XrmAssociatedMenuConfiguration.IsCustomizable"),this._isCustomizable}get Label(){return O.a.instance.reportUsage("ClientApi.XrmAssociatedMenuConfiguration.Label"),this._label}get MenuId(){return O.a.instance.reportUsage("ClientApi.XrmAssociatedMenuConfiguration.MenuId"),this._menuId}get Order(){return O.a.instance.reportUsage("ClientApi.XrmAssociatedMenuConfiguration.Order"),this._order}get QueryApi(){return O.a.instance.reportUsage("ClientApi.XrmAssociatedMenuConfiguration.QueryApi"),this._queryApi}get ViewId(){return O.a.instance.reportUsage("ClientApi.XrmAssociatedMenuConfiguration.ViewId"),this._viewId}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class x{constructor(e){this._securityTypes=null;e||Object(y.j)("ClientApi.XrmRelationshipMetadataBase.constructor","relationshipMetadata"),this.relationshipMetadata=e,this._introducedVersion=e.IntroducedVersion,this._isCustomizable=e.IsCustomizable,this._isCustomRelationship=e.IsCustomRelationship,this._isManaged=e.IsManaged,this._isValidForAdvancedFind=e.IsValidForAdvancedFind,this._schemaName=e.SchemaName}get IntroducedVersion(){return O.a.instance.reportUsage("ClientApi.XrmRelationshipMetadataBase.IntroducedVersion"),this._introducedVersion}get IsCustomizable(){return O.a.instance.reportUsage("ClientApi.XrmRelationshipMetadataBase.IsCustomizable"),this._isCustomizable}get IsCustomRelationship(){return O.a.instance.reportUsage("ClientApi.XrmRelationshipMetadataBase.IsCustomRelationship"),this._isCustomRelationship}get IsManaged(){return O.a.instance.reportUsage("ClientApi.XrmRelationshipMetadataBase.IsManaged"),this._isManaged}get IsValidForAdvancedFind(){return O.a.instance.reportUsage("ClientApi.XrmRelationshipMetadataBase.IsValidForAdvancedFind"),this._isValidForAdvancedFind}get SchemaName(){return O.a.instance.reportUsage("ClientApi.XrmRelationshipMetadataBase.SchemaName"),this._schemaName}get SecurityTypes(){const e="ClientApi.XrmRelationshipMetadataBase.SecurityTypes";try{if(O.a.instance.reportCall(e),null===this._securityTypes)switch(this.relationshipMetadata.SecurityTypes){case 1:this._securityTypes=1;break;case 8:this._securityTypes=8;break;case 0:this._securityTypes=0;break;case 2:this._securityTypes=2;break;case 4:this._securityTypes=4;break;default:Object(y.h)(e,"SecurityTypes",this.relationshipMetadata.SecurityTypes)}return O.a.instance.reportSuccess(e),this._securityTypes}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class M extends x{constructor(e){super(e),this._entity1IntersectAttribute=e.Entity1IntersectAttribute,this._entity1LogicalName=e.Entity1LogicalName,this._entity1NavigationPropertyName=e.Entity1NavigationPropertyName,this._entity2IntersectAttribute=e.Entity2IntersectAttribute,this._entity2LogicalName=e.Entity2LogicalName,this._entity2NavigationPropertyName=e.Entity2NavigationPropertyName,this._intersectEntityName=e.IntersectEntityName}get Entity1AssociatedMenuConfiguration(){const e="ClientApi.XrmManyToManyRelationshipMetadata.Entity1AssociatedMenuConfiguration";try{return O.a.instance.reportCall(e),null===this._entity1AssociatedMenuConfiguration&&(this._entity1AssociatedMenuConfiguration=new R(this._manyToManyRelationshipMetadata.Entity1AssociatedMenuConfiguration)),O.a.instance.reportSuccess(e),this._entity1AssociatedMenuConfiguration}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}get Entity1IntersectAttribute(){return O.a.instance.reportUsage("ClientApi.XrmManyToManyRelationshipMetadata.Entity1IntersectAttribute"),this._entity1IntersectAttribute}get Entity1LogicalName(){return O.a.instance.reportUsage("ClientApi.XrmManyToManyRelationshipMetadata.Entity1LogicalName"),this._entity1LogicalName}get Entity1NavigationPropertyName(){return O.a.instance.reportUsage("ClientApi.XrmManyToManyRelationshipMetadata.Entity1NavigationPropertyName"),this._entity1NavigationPropertyName}get Entity2AssociatedMenuConfiguration(){const e="ClientApi.XrmManyToManyRelationshipMetadata.Entity2AssociatedMenuConfiguration";try{return O.a.instance.reportCall(e),null===this._entity2AssociatedMenuConfiguration&&(this._entity2AssociatedMenuConfiguration=new R(this._manyToManyRelationshipMetadata.Entity2AssociatedMenuConfiguration)),O.a.instance.reportSuccess(e),this._entity2AssociatedMenuConfiguration}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}get Entity2IntersectAttribute(){return O.a.instance.reportUsage("ClientApi.XrmManyToManyRelationshipMetadata.Entity2IntersectAttribute"),this._entity2IntersectAttribute}get Entity2LogicalName(){return O.a.instance.reportUsage("ClientApi.XrmManyToManyRelationshipMetadata.Entity2LogicalName"),this._entity2LogicalName}get Entity2NavigationPropertyName(){return O.a.instance.reportUsage("ClientApi.XrmManyToManyRelationshipMetadata.Entity2NavigationPropertyName"),this._entity2NavigationPropertyName}get IntersectEntityName(){return O.a.instance.reportUsage("ClientApi.XrmManyToManyRelationshipMetadata.IntersectEntityName"),this._intersectEntityName}get RelationshipType(){return O.a.instance.reportUsage("ClientApi.XrmManyToManyRelationshipMetadata.RelationshipType"),1}get _manyToManyRelationshipMetadata(){return this.relationshipMetadata}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class F{constructor(e){this._assign=null,this._delete=null,this._merge=null,this._reparent=null,this._share=null,this._unshare=null;e||Object(y.j)("ClientApi.XrmCascadeConfiguration.constructor","cascadeConfiguration"),this._cascadeConfiguration=e}get Assign(){const e="ClientApi.XrmCascadeConfiguration.Assign";try{return O.a.instance.reportCall(e),null===this._assign&&(this._assign=F._convertCascadeType(e,this._cascadeConfiguration.Assign)),O.a.instance.reportSuccess(e),this._assign}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}get Delete(){const e="ClientApi.XrmCascadeConfiguration.Delete";try{return O.a.instance.reportCall(e),null===this._delete&&(this._delete=F._convertCascadeType(e,this._cascadeConfiguration.Delete)),O.a.instance.reportSuccess(e),this._delete}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}get Merge(){const e="ClientApi.XrmCascadeConfiguration.Merge";try{return O.a.instance.reportCall(e),null===this._merge&&(this._merge=F._convertCascadeType(e,this._cascadeConfiguration.Merge)),O.a.instance.reportSuccess(e),this._merge}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}get Reparent(){const e="ClientApi.XrmCascadeConfiguration.Reparent";try{return O.a.instance.reportCall(e),null===this._reparent&&(this._reparent=F._convertCascadeType(e,this._cascadeConfiguration.Reparent)),O.a.instance.reportSuccess(e),this._reparent}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}get Share(){const e="ClientApi.XrmCascadeConfiguration.Share";try{return O.a.instance.reportCall(e),null===this._share&&(this._share=F._convertCascadeType(e,this._cascadeConfiguration.Share)),O.a.instance.reportSuccess(e),this._share}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}get Unshare(){const e="ClientApi.XrmCascadeConfiguration.Unshare";try{return O.a.instance.reportCall(e),null===this._unshare&&(this._unshare=F._convertCascadeType(e,this._cascadeConfiguration.Unshare)),O.a.instance.reportSuccess(e),this._unshare}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}static _convertCascadeType(e,t){let n;switch(e+="._convertCascadeType",t){case 2:n=2;break;case 1:n=1;break;case 0:n=0;break;case 4:n=4;break;case 5:n=5;break;case 3:n=3;break;default:Object(y.h)(e,"cascadeType",t)}return n}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class k extends x{constructor(e){super(e),this._associatedMenuConfiguration=null,this._cascadeConfiguration=null,this._isHierarchical=e.IsHierarchical,this._referencedAttribute=e.ReferencedAttribute,this._referencedEntity=e.ReferencedEntity,this._referencedEntityNavigationPropertyName=e.ReferencedEntityNavigationPropertyName,this._referencingAttribute=e.ReferencingAttribute,this._referencingEntity=e.ReferencingEntity,this._referencingEntityNavigationPropertyName=e.ReferencingEntityNavigationPropertyName}get AssociatedMenuConfiguration(){const e="ClientApi.XrmOneToManyRelationshipMetadata.AssociatedMenuConfiguration";try{return O.a.instance.reportCall(e),null===this._associatedMenuConfiguration&&(this._associatedMenuConfiguration=new R(this._oneToManyRelationshipMetadata.AssociatedMenuConfiguration)),O.a.instance.reportSuccess(e),this._associatedMenuConfiguration}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}get CascadeConfiguration(){const e="ClientApi.XrmOneToManyRelationshipMetadata.CascadeConfiguration";try{return O.a.instance.reportCall(e),null===this._cascadeConfiguration&&(this._cascadeConfiguration=new F(this._oneToManyRelationshipMetadata.CascadeConfiguration)),O.a.instance.reportSuccess(e),this._cascadeConfiguration}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}get IsHierarchical(){return O.a.instance.reportUsage("ClientApi.XrmOneToManyRelationshipMetadata.IsHierarchical"),this._isHierarchical}get ReferencedAttribute(){return O.a.instance.reportUsage("ClientApi.XrmOneToManyRelationshipMetadata.ReferencedAttribute"),this._referencedAttribute}get ReferencedEntity(){return O.a.instance.reportUsage("ClientApi.XrmOneToManyRelationshipMetadata.ReferencedEntity"),this._referencedEntity}get ReferencedEntityNavigationPropertyName(){return O.a.instance.reportUsage("ClientApi.XrmOneToManyRelationshipMetadata.ReferencedEntityNavigationPropertyName"),this._referencedEntityNavigationPropertyName}get ReferencingAttribute(){return O.a.instance.reportUsage("ClientApi.XrmOneToManyRelationshipMetadata.ReferencingAttribute"),this._referencingAttribute}get ReferencingEntity(){return O.a.instance.reportUsage("ClientApi.XrmOneToManyRelationshipMetadata.ReferencingEntity"),this._referencingEntity}get ReferencingEntityNavigationPropertyName(){return O.a.instance.reportUsage("ClientApi.XrmOneToManyRelationshipMetadata.ReferencingEntityNavigationPropertyName"),this._referencingEntityNavigationPropertyName}get RelationshipType(){return O.a.instance.reportUsage("ClientApi.XrmOneToManyRelationshipMetadata.RelationshipType"),0}get _oneToManyRelationshipMetadata(){return this.relationshipMetadata}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function L(e){const t="ClientApi.XrmRelationshipMetadataFactory.getRelationshipMetadataInstance";e||Object(y.j)(t,"relationshipMetadata");let n=null;switch(e.RelationshipType){case 0:n=new k(e);break;case 1:n=new M(e);break;default:Object(y.h)(t,"RelationshipType",e.RelationshipType)}return n}var B=n("Sbn7"),U=n("IaGr");let V;class z{constructor(e,t,n,r){const a="ClientApi.XrmEntityMetadata.constructor";e||Object(y.j)(a,"store"),t||Object(y.j)(a,"entityDescriptor"),n||Object(y.j)(a,"entityType"),V=e,this._entityDescriptor=t,this._entityType=n,this._attributes=r||[];const i=this._entityDescriptor.OwnershipType;this._activityTypeMask=this._entityDescriptor.ActivityTypeMask,this._autoRouteToOwnerQueue=this._entityDescriptor.AutoRouteToOwnerQueue,this._canEnableSyncToExternalSearchIndex=this._entityDescriptor.CanEnableSyncToExternalSearchIndex,this._canTriggerWorkflow=this._entityDescriptor.CanTriggerWorkflow,this._description=this._entityDescriptor.Description,this._displayCollectionName=this._entityDescriptor.DisplayCollectionName,this._displayName=this._entityDescriptor.DisplayName,this._enforceStateTransitions=this._entityDescriptor.EnforceStateTransitions,this._entityColor=this._entityDescriptor.EntityColor,this._entitySetName=this._entityDescriptor.EntitySetName,this._hasActivities=this._entityDescriptor.HasActivities,this._iconVectorName=this._entityDescriptor.IconVectorName,this._isActivity=this._entityDescriptor.IsActivity,this._isActivityParty=this._entityDescriptor.IsActivityParty,this._isBusinessProcessEnabled=this._entityDescriptor.IsBusinessProcessEnabled,this._isBPFEntity=this._entityDescriptor.IsBPFEntity,this._isChildEntity=this._entityDescriptor.IsChildEntity,this._isConnectionsEnabled=this._entityDescriptor.IsConnectionsEnabled,this._isCustomEntity=this._entityDescriptor.IsCustomEntity,this._isCustomizable=this._entityDescriptor.IsCustomizable,this._isDocumentManagementEnabled=this._entityDescriptor.IsDocumentManagementEnabled,this._isDocumentRecommendationsEnabled=this._entityDescriptor.IsDocumentRecommendationsEnabled,this._isDuplicateDetectionEnabled=this._entityDescriptor.IsDuplicateDetectionEnabled,this._isEnabledForCharts=this._entityDescriptor.IsEnabledForCharts,this._isImportable=this._entityDescriptor.IsImportable,this._isInteractionCentricEnabled=this._entityDescriptor.IsInteractionCentricEnabled,this._isKnowledgeManagementEnabled=this._entityDescriptor.IsKnowledgeManagementEnabled,this._isMailMergeEnabled=this._entityDescriptor.IsMailMergeEnabled,this._isManaged=this._entityDescriptor.IsManaged,this._isOneNoteIntegrationEnabled=this._entityDescriptor.IsOneNoteIntegrationEnabled,this._entityHelpUrlEnabled=this._entityHelpUrlEnabled,this._entityHelpUrl=this._entityDescriptor.EntityHelpUrl,this._isMSTeamsIntegrationEnabled=this._entityDescriptor.IsMSTeamsIntegrationEnabled,this._isOptimisticConcurrencyEnabled=this._entityDescriptor.IsOptimisticConcurrencyEnabled,this._isQuickCreateEnabled=this._entityDescriptor.IsQuickCreateEnabled,this._entityClientSetting=this._entityDescriptor.EntityClientSetting,this._isReadOnlyInMobileClient=this._entityDescriptor.IsReadOnlyInMobileClient,this._isStateModelAware=this._entityDescriptor.IsStateModelAware,this._isValidForAdvancedFind=this._entityDescriptor.IsValidForAdvancedFind,this._isVisibleInMobileClient=this._entityDescriptor.IsVisibleInMobileClient,this._isEnabledInUnifiedInterface=this._entityDescriptor.IsEnabledInUnifiedInterface,this._logicalName=this._entityDescriptor.EntityLogicalName,this._objectTypeCode=this._entityDescriptor.ObjectTypeCode,this._ownershipType=i,this._primaryIdAttribute=this._entityDescriptor.PrimaryIdAttribute,this._primaryImageAttribute=this._entityDescriptor.PrimaryImageAttribute,this._primaryNameAttribute=this._entityDescriptor.PrimaryNameAttribute}static getInstance(e,t,n){e||Object(y.j)("ClientApi.XrmEntityMetadata.getInstance","store"),t||Object(y.j)("ClientApi.XrmEntityMetadata.getInstance","entityType");const r=Object(v.h)(e.getState(),t);return r?new z(e,r,t,n):null}get ActivityTypeMask(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.ActivityTypeMask"),this._activityTypeMask}get AutoRouteToOwnerQueue(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.AutoRouteToOwnerQueue"),this._autoRouteToOwnerQueue}get CanEnableSyncToExternalSearchIndex(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.CanEnableSyncToExternalSearchIndex"),this._canEnableSyncToExternalSearchIndex}get CanTriggerWorkflow(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.CanTriggerWorkflow"),this._canTriggerWorkflow}get Description(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.Description"),this._description}get DisplayCollectionName(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.DisplayCollectionName"),this._displayCollectionName}get DisplayName(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.DisplayName"),this._displayName}get EnforceStateTransitions(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.EnforceStateTransitions"),this._enforceStateTransitions}get EntityColor(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.EntityColor"),this._entityColor}get EntitySetName(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.EntitySetName"),this._entitySetName}get HasActivities(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.HasActivities"),this._hasActivities}get IconVectorName(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IconVectorName"),this._iconVectorName}get IsActivity(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsActivity"),this._isActivity}get IsActivityParty(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsActivityParty"),this._isActivityParty}get IsBusinessProcessEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsBusinessProcessEnabled"),this._isBusinessProcessEnabled}get IsBPFEntity(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsBPFEntity"),this._isBPFEntity}get IsChildEntity(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsChildEntity"),this._isChildEntity}get IsConnectionsEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsConnectionsEnabled"),this._isConnectionsEnabled}get IsCustomEntity(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsCustomEntity"),this._isCustomEntity}get IsCustomizable(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsCustomizable"),this._isCustomizable}get EntityHelpUrlEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.EntityHelpUrlEnabled"),this._entityHelpUrlEnabled}get EntityHelpUrl(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.EntityHelpUrl"),this._entityHelpUrl}get IsDocumentManagementEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsDocumentManagementEnabled"),this._isDocumentManagementEnabled}get IsDocumentRecommendationsEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsDocumentRecommendationsEnabled"),this._isDocumentRecommendationsEnabled}get IsDuplicateDetectionEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsDuplicateDetectionEnabled"),this._isDuplicateDetectionEnabled}get IsEnabledForCharts(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsEnabledForCharts"),this._isEnabledForCharts}get IsImportable(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsImportable"),this._isImportable}get IsInteractionCentricEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsInteractionCentricEnabled"),this._isInteractionCentricEnabled}get IsKnowledgeManagementEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsKnowledgeManagementEnabled"),this._isKnowledgeManagementEnabled}get IsMailMergeEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsMailMergeEnabled"),this._isMailMergeEnabled}get IsManaged(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsManaged"),this._isManaged}get IsOneNoteIntegrationEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsOneNoteIntegrationEnabled"),this._isOneNoteIntegrationEnabled}get IsMSTeamsIntegrationEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsMSTeamsIntegrationEnabled"),this._isMSTeamsIntegrationEnabled}get IsOptimisticConcurrencyEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsOptimisticConcurrencyEnabled"),this._isOptimisticConcurrencyEnabled}get IsQuickCreateEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsQuickCreateEnabled"),this._isQuickCreateEnabled}get EntityClientSetting(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.EntityClientSetting"),this._entityClientSetting}get IsReadOnlyInMobileClient(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsReadOnlyInMobileClient"),this._isReadOnlyInMobileClient}get IsStateModelAware(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsStateModelAware"),this._isStateModelAware}get IsValidForAdvancedFind(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsValidForAdvancedFind"),this._isValidForAdvancedFind}get IsVisibleInMobileClient(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsVisibleInMobileClient"),this._isVisibleInMobileClient}get IsEnabledInUnifiedInterface(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsEnabledInUnifiedInterface"),this._isEnabledInUnifiedInterface}get LogicalCollectionName(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.LogicalCollectionName"),this._logicalCollectionName}get LogicalName(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.LogicalName"),this._logicalName}get ObjectTypeCode(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.ObjectTypeCode"),this._objectTypeCode}get OwnershipType(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.OwnershipType"),this._ownershipType}get PrimaryIdAttribute(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.PrimaryIdAttribute"),this._primaryIdAttribute}get PrimaryImageAttribute(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.PrimaryImageAttribute"),this._primaryImageAttribute}get PrimaryNameAttribute(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.PrimaryNameAttribute"),this._primaryNameAttribute}get Privileges(){const e="ClientApi.XrmEntityMetadata.Privileges";try{if(O.a.instance.reportCall(e),!this._privileges&&this._entityDescriptor.Privileges){this._privileges=[];for(let e=0;e<this._entityDescriptor.Privileges.length;e++){const t={CanBeBasic:this._entityDescriptor.Privileges[e].CanBeBasic,CanBeDeep:this._entityDescriptor.Privileges[e].CanBeDeep,CanBeGlobal:this._entityDescriptor.Privileges[e].CanBeGlobal,CanBeLocal:this._entityDescriptor.Privileges[e].CanBeLocal,CanBeEntityReference:this._entityDescriptor.Privileges[e].CanBeEntityReference,CanBeParentEntityReference:this._entityDescriptor.Privileges[e].CanBeParentEntityReference,Name:this._entityDescriptor.Privileges[e].Name,PrivilegeId:this._entityDescriptor.Privileges[e].PrivilegeId,PrivilegeType:this._entityDescriptor.Privileges[e].PrivilegeType};this._privileges.push(t)}}else if(!this._entityDescriptor.Privileges)return U.a.getInstance().traceManager.getTracer(e).error("this._entityDescriptor.Privileges is null or undefined ",[{name:"entityName",value:this._entityDescriptor.EntityLogicalName}]),[];return O.a.instance.reportSuccess(e),this._privileges}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}get Attributes(){const e="ClientApi.XrmEntityMetadata.Attributes";try{if(O.a.instance.reportCall(e),!this._attributesMetadata&&(this._attributesMetadata=new B.a(e),this._attributes&&this._attributes.length>0)){const e=Object(S.d)(V.getState(),this._entityType);for(let t=0;t<this._attributes.length;t++){const n=e[this._attributes[t]];if(n){const e=D(V,n);this._attributesMetadata.add(this._attributes[t],e)}}}return O.a.instance.reportSuccess(e),this._attributesMetadata}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}get ManyToManyRelationships(){const e="ClientApi.XrmEntityMetadata.ManyToManyRelationships";try{return O.a.instance.reportCall(e),this._manyToManyRelationships||(this._manyToManyRelationships=z._processRelationShips(this._entityDescriptor.ManyToManyRelationships,e)),O.a.instance.reportSuccess(e),this._manyToManyRelationships}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}get ManyToOneRelationships(){const e="ClientApi.XrmEntityMetadata.ManyToOneRelationships";try{return O.a.instance.reportCall(e),this._manyToOneRelationships||(this._manyToOneRelationships=z._processRelationShips(this._entityDescriptor.ManyToOneRelationships,e)),O.a.instance.reportSuccess(e),this._manyToOneRelationships}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}get OneToManyRelationships(){const e="ClientApi.XrmEntityMetadata.OneToManyRelationships";try{return O.a.instance.reportCall(e),this._oneToManyRelationships||(this._oneToManyRelationships=z._processRelationShips(this._entityDescriptor.OneToManyRelationships,e)),O.a.instance.reportSuccess(e),this._oneToManyRelationships}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}static _processRelationShips(e,t){let n;if(e&&Object.keys(e).length>0){n=new B.a(t);for(const t in e){const r=e[t];if(r){const e=L(r);n.add(t,e)}}}return n}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class W{constructor(e){var t;e||Object(y.j)("ClientApi.XrmEntityFormMetadata.constructor","formDescriptor"),this._id=e.Id,this._label=e.Label,this._name=e.Name,this._entityLogicalName=e.EntityLogicalName,this._showLabel=e.ShowLabel,this._visible=e.Visible,this._attributes=e.Attributes;const n={};for(const r in e.Sections){const a=e.Sections[r],i={AvailableForPhone:a.AvailableForPhone,Label:a.Label,Name:a.Name,ShowLabel:a.ShowLabel,Visible:a.Visible,Rows:null===(t=a.Rows)||void 0===t?void 0:t.map(e=>{var t;const n={};return n.Visible=e.Visible,n.Cells=null===(t=e.Cells)||void 0===t?void 0:t.map(e=>({AvailableForPhone:e.AvailableForPhone,ControlName:e.ControlName,ShowLabel:e.ShowLabel,Visible:e.Visible})),n})};n[r]=i}this._sections=n}get Id(){return O.a.instance.reportUsage("ClientApi.XrmEntityFormMetadata.Id"),this._id}get Label(){return O.a.instance.reportUsage("ClientApi.XrmEntityFormMetadata.Label"),this._label}get Name(){return O.a.instance.reportUsage("ClientApi.XrmEntityFormMetadata.Name"),this._name}get EntityLogicalName(){return O.a.instance.reportUsage("ClientApi.XrmEntityFormMetadata.EntityLogicalName"),this._entityLogicalName}get ShowLabel(){return O.a.instance.reportUsage("ClientApi.XrmEntityFormMetadata.ShowLabel"),this._showLabel}get Visible(){return O.a.instance.reportUsage("ClientApi.XrmEntityFormMetadata.Visible"),this._visible}get Attributes(){return O.a.instance.reportUsage("ClientApi.XrmEntityFormMetadata.Attributes"),this._attributes}get Sections(){return O.a.instance.reportUsage("ClientApi.XrmEntityFormMetadata.Sections"),this._sections}}var q=n("VDDv"),H=n("9A3e"),G=n("8MGk"),K=n("IpQH"),Q=n("uM6Y"),X=n("VkXQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Y extends K.a{constructor(e,t){super(e,t,Q.e)}getCurrentPosition(){return this.execute(X.e.getCurrentPosition.name,"GeolocationCode",{})}}var J=n("a475");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let $;class Z{constructor(e,t){$=e,this._context=t}static getInstance(e,t){const n="ClientApi.XrmDevice.getInstance";e||Object(y.j)(n,"store"),t||Object(y.j)(n,"context");try{return Z._instance||(Z._instance=new Z(e,t)),Z._instance}catch(e){throw C.a.getInstance().reportFailure(n,e),e}}captureImage(e){const t="ClientApi.XrmDevice.captureImage";try{O.a.instance.reportCall(t);return new q.a(this._context,$).takePicture(e).then(e=>(O.a.instance.reportSuccess(t),e)).catch(e=>Object(y.d)($,e,t))}catch(e){return Object(y.d)($,e,t)}}captureAudio(e){const t="ClientApi.XrmDevice.captureAudio";try{O.a.instance.reportCall(t);return new q.a(this._context,$).captureAudio(e).then(e=>(O.a.instance.reportSuccess(t),e)).catch(e=>Object(y.d)($,e,t))}catch(e){return Object(y.d)($,e,t)}}captureVideo(e){const t="ClientApi.XrmDevice.captureVideo";try{O.a.instance.reportCall(t);return new q.a(this._context,$).captureVideo(e).then(e=>(O.a.instance.reportSuccess(t),e)).catch(e=>Object(y.d)($,e,t))}catch(e){return Object(y.d)($,e,t)}}pickFile(e){const t="ClientApi.XrmDevice.pickFile";try{O.a.instance.reportCall(t);return new G.a(this._context,$).pickFile(e).then(e=>(O.a.instance.reportSuccess(t),e)).catch(e=>Object(y.d)($,e,t))}catch(e){return Object(y.d)($,e,t)}}getBarcodeValue(){const e="ClientApi.XrmDevice.getBarcodeValue";try{O.a.instance.reportCall(e);return new H.a(this._context,$).getBarcodeValue().then(t=>(O.a.instance.reportSuccess(e),t)).catch(t=>Object(y.d)($,t,e))}catch(t){return Object(y.d)($,t,e)}}getCurrentPosition(){const e="ClientApi.XrmDevice.getCurrentPosition";try{O.a.instance.reportCall(e);return new Y(this._context,$).getCurrentPosition().then(t=>(O.a.instance.reportSuccess(e),t)).catch(t=>Object(y.d)($,t,e))}catch(t){return Object(y.d)($,t,e)}}tryShowRatingPrompt(){const e="ClientApi.XrmDevice.tryShowRatingPrompt";try{O.a.instance.reportCall(e);const t=J.a.get_Instance().get_device();t.get_IsAvailable()&&t.postMessage(JSON.stringify({name:"tryShowRatingPrompt"})),O.a.instance.reportSuccess(e)}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}}var ee=n("VCkP"),te=n("0cBP"),ne=n("nVeB"),re=n("jCkl"),ae=n("yJdb"),ie=n("+nNZ"),oe=n("NjDY"),se=n("RiHV"),ce=n("Uv1Y"),le=n("UwOy"),ue=n("OEF1"),de=n("0nOn"),pe=n("amNf"),ge=n("+nTZ"),he=n("arV0");let fe;class me{constructor(e,t){fe=e,this._pageId=t,this._clientApiExecutor=new de.a(e,"ClientApi.PageContext.",t)}get input(){return this._clientApiExecutor.execute("input",(e,t)=>{const n=Object(he.g)(fe.getState(),this._pageId);return Object(pe.b)(n,e,t)})}get options(){return this._clientApiExecutor.execute("options",()=>Object(ge.b)(fe.getState(),this._pageId)?{target:2}:{target:1})}}var be=n("MIBb"),_e=n("BJ7u"),ye=n("eq+S"),ve=n("eXjw");let Se;class Oe{constructor(e,t,n,a,i){this._cancelButtonID="Button_Cancel",this._okButtonId="A4A4842B-7564-4BCF-B21D-4D6A78F17BE1",this._clientApiExecutor=new r.b(Se,"ClientApi.XrmUtility.");const o=this._clientApiExecutor.getComponentName("constructor");Object(y.g)(e,o,"store"),Object(y.g)(t,o,"globalContext"),Object(y.g)(n,o,"applicationContext"),Object(y.g)(a,o,"navigation"),Se=e,this._xrmDevice=Z.getInstance(e,n),this._globalContext=t,this._applicationContext=n,this._navigation=a,this._pageId=i}getGlobalContext(){return O.a.instance.reportUsage("ClientApi.XrmUtility.getGlobalContext"),this._globalContext}lookupObjects(e){return this._clientApiExecutor.executeAsync("lookupObjects",(t,n)=>(0===e.entityTypes.length&&Object(y.e)(t,"entityTypes cannot be empty."),Object(ne.a)(e,this._pageId,Se.dispatch)),[{name:"lookupOptions",value:e,isRequired:!0},{name:"entityTypes",value:e&&e.entityTypes,isRequired:!0}])}openEntityForm(e,t,n,r){const a="ClientApi.XrmUtility.openEntityForm";t&&!s.a.tryParseOrNull(t)&&Object(y.h)(a,"id",t);try{O.a.instance.reportCall(a);const i={entityName:e,entityId:t,formId:n&&n.formid?n.formid:void 0,navbar:n&&n.navbar?n.navbar:void 0,cmdbar:!(n&&("false"===n.cmdbar||!1===n.cmdbar)),width:r&&r.width?r.width:void 0,height:r&&r.height?r.height:void 0,openInNewWindow:!(!r||!r.openInNewWindow)&&r.openInNewWindow};this._navigation.openForm(i,n),O.a.instance.reportSuccess(a)}catch(e){throw C.a.getInstance().reportFailure(a,e),e}}openQuickCreate(e,t,n){return this._clientApiExecutor.executeAsync("openQuickCreate",(r,a)=>{t&&!s.a.tryParseOrNull(t.id)?Object(y.h)(r,"createFromEntity.id",t.id,a):t&&!t.entityType&&Object(y.h)(r,"createFromEntity.entityType",t.entityType,a);const i={entityName:e,showDialog:!0,createFromEntity:t};return this._navigation.openForm(i,n).then(e=>{var t;let n=null;return(null===(t=null==e?void 0:e.savedEntityReference)||void 0===t?void 0:t[0])&&(n={savedEntityReference:e.savedEntityReference[0]}),n})},[{name:"entityLogicalName",value:e,isEventParam:!0}])}openWebResource(e,t,n,r){const a="ClientApi.XrmUtility.openWebResource";try{O.a.instance.reportCall(a);const i={height:r,width:n};this._navigation.openWebResource(e,i,t),O.a.instance.reportSuccess(a)}catch(e){throw C.a.getInstance().reportFailure(a,e),e}}alertDialog(e,t){this._clientApiExecutor.executeAsync("alertDialog",(n,a)=>{const i={},o={};i.text=e;const s=[this._okButtonId];return Se.dispatch(Object(d.e)(s)).then(()=>(i.confirmButtonLabel=Object(c.b)(Se.getState(),this._okButtonId),this._navigation.openAlertDialog(i,o).then(()=>{t&&Object(r.c)(n,a,()=>{t()})})))},[{name:"message",value:e,isRequired:!0}])}confirmDialog(e,t,n){this._clientApiExecutor.executeAsync("confirmDialog",(a,i)=>{const o={},s={};o.text=e;const l=[this._okButtonId,this._cancelButtonID];return Se.dispatch(Object(d.e)(l)).then(()=>(o.confirmButtonLabel=Object(c.b)(Se.getState(),this._okButtonId),o.cancelButtonLabel=Object(c.b)(Se.getState(),this._cancelButtonID),this._navigation.openConfirmDialog(o,s).then(e=>{e.confirmed?t&&(i.push({name:"button",value:"yes"}),Object(r.c)(a,i,()=>{t()})):n&&(i.push({name:"button",value:"no"}),Object(r.c)(a,i,()=>{n()}))})))},[{name:"message",value:e,isRequired:!0}])}isActivityType(e){const t="ClientApi.XrmUtility.isActivityType";e||Object(y.j)(t,"entityLogicalName");try{O.a.instance.reportCall(t);const n=Object(v.r)(Se.getState(),e);return O.a.instance.reportSuccess(t),n}catch(e){throw C.a.getInstance().reportFailure(t,e),e}}getBarcodeValue(){const e="ClientApi.XrmUtility.getBarcodeValue";try{return O.a.instance.reportCall(e),this._xrmDevice.getBarcodeValue().then(t=>(O.a.instance.reportSuccess(e),t)).catch(t=>Object(y.d)(Se,t,e+".getBarcodeValue"))}catch(t){return Object(y.d)(Se,t,e)}}getCurrentPosition(){const e="ClientApi.XrmUtility.getCurrentPosition";try{return O.a.instance.reportCall(e),this._xrmDevice.getCurrentPosition().then(t=>(O.a.instance.reportSuccess(e),t)).catch(t=>Object(y.d)(Se,t,e+".getCurrentPosition"))}catch(t){return Object(y.d)(Se,t,e)}}getEntityMetadata(e,t){return this._clientApiExecutor.executeAsync("getEntityMetadata",()=>(t||(t=[]),-1!==t.indexOf("statecode")&&-1===t.indexOf("statuscode")&&t.push("statuscode"),Se.dispatch(Object(g.f)(e,!1,t)).then(()=>z.getInstance(Se,e,t))),[{name:"entityType",value:e,isRequired:!0}])}getEntityMainFormDescriptor(e,t){return this._clientApiExecutor.executeAsync("getEntityDefaultMainFormDescriptor",()=>{const n=Object(_e.a)(ye.a.main);let r=s.a.tryParseOrNull(t);return s.a.isNullOrEmpty(r)&&(r=Object(_.h)(Se.getState(),e,n)),s.a.isNullOrEmpty(r)||Object(_.o)(Se.getState(),r)!==ve.a.Initialized?Se.dispatch(Object(h.b)("form",n,e,s.a.toLegacyGuid(r),s.a.isNullOrEmpty(r),m.a.OnDemandWithContext,null,null,[],f.b.Form,b.a.LocalAndRemote)).then(()=>this._getEntityFormDescriptor(e,r,n)):Promise.resolve(Object(this._getEntityFormDescriptor(e,r,n)))},[{name:"entityName",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"}])}_getEntityFormDescriptor(e,t,n){const r=Object(_.s)(Se.getState(),t,e,n);if(r){return new W(r)}return null}getEntitiesMetadata(e){return this._clientApiExecutor.executeAsync("getEntitiesMetadata",(t,n)=>Se.dispatch(Object(g.e)(e)).then(()=>{const r=[];for(const a in e){const i=e[a];-1!==i.indexOf("statecode")&&-1===i.indexOf("statuscode")&&i.push("statuscode");const o=z.getInstance(Se,a,i);if(!o){const e=new ce.a("Entity name doesn't exist",2147750146);return n.push({name:"entityType",value:a}),Object(y.d)(Se,e,t+".getEntitiesMetadata",n,!1)}r.push(o)}return Promise.resolve(r)}),[{name:"entityToAttributes",value:e,isRequired:!0}])}getResourceString(e,t){const n="ClientApi.XrmUtility.getResourceString";e||Object(y.j)(n,"webResourceName"),t||Object(y.j)(n,"key");try{O.a.instance.reportCall(n);const r=Object(l.b)(Se.getState(),e);if(r){const e=r[t];return O.a.instance.reportSuccess(n),e}const a=[];a.push({name:"webResourceName",value:e}),a.push({name:"validationError",value:"true"}),U.a.getInstance().traceManager.getTracer(n).error("Resx web resource could not be found",a),O.a.instance.reportSuccess(n)}catch(r){const a=[];throw a.push({name:"key",value:t}),a.push({name:"webResourceName",value:e}),C.a.getInstance().reportFailure(n,r,null,a),r}throw new Error(`'${e}' does not exist.`)}showHierarchyPage(e,t){O.a.instance.reportUsage("ClientApi.XrmUtility.showHierarchyPage")}showProgressIndicator(e){const t="ClientApi.XrmUtility.showProgressIndicator";try{O.a.instance.reportCall(t),Se.dispatch(Object(re.b)(e)),O.a.instance.reportSuccess(t)}catch(e){throw C.a.getInstance().reportFailure(t,e),e}}closeProgressIndicator(){const e="ClientApi.XrmUtility.closeProgressIndicator";try{O.a.instance.reportCall(e),Se.dispatch(Object(ae.b)()),O.a.instance.reportSuccess(e)}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}beginSecureSessionForResource(e,t,n,r){const a="ClientApi.XrmUtility.beginSecureSessionForResource",i=[{name:"resource",value:e},{name:"cookieName",value:t},{name:"cookieDomain",value:n},{name:"allowPrompt",value:r?"true":"false"}];try{O.a.instance.reportCall(a);const o=new ee.a(this._applicationContext,Se);return r?o.beginSecureSessionForResource(e,t,n).then(e=>(O.a.instance.reportSuccess(a),e)).catch(e=>Object(y.d)(Se,e,a+".beginSecureSessionForResource",i)):o.beginSecureSessionForResourceSilent(e,t,n).then(e=>(O.a.instance.reportSuccess(a),e)).catch(e=>Object(y.d)(Se,e,a+".beginSecureSessionForResourceSilent",i))}catch(e){return Object(y.d)(Se,e,a,i)}}getAllowedStatusTransitions(e,t){const n="ClientApi.XrmUtility.getAllowedStatusTransitions";e||Object(y.j)(n,"entityLogicalName"),Object(y.a)(t)&&Object(y.j)(n,"statusCode");try{O.a.instance.reportCall(n);const r=Object(te.b)(Se.getState(),e,t);return Promise.resolve(r).then(e=>(O.a.instance.reportSuccess(n),e)).catch(r=>{const a=[];return a.push({name:"entityLogicalName",value:e}),a.push({name:"statusCode",value:t}),Object(y.d)(Se,r,n+".getAllowedStatusTransitions",a)})}catch(r){const a=[];return a.push({name:"entityLogicalName",value:e}),a.push({name:"statusCode",value:t}),Object(y.d)(Se,r,n,a)}}invokeProcessAction(e,t){return this._clientApiExecutor.executeAsync("invokeProcessAction",()=>this.invokeProcessActionInternal(e,t,null),[{name:"name",value:e,isEventParam:!0}])}invokeProcessActionInternal(e,t,n=null){return this._clientApiExecutor.executeAsync("invokeProcessActionInternal",(r,a)=>t&&t.Target?this._getCurrentProcessIdValue(t.BusinessProcessFlowId).then(i=>{if(!i)return Object(y.d)(Se,{errorCode:2147746581,code:2147746581},r,a);const o=t.Target,l="Microsoft.Dynamics.CRM."+o.entityType,u=Object(ie.a)(Se.getState(),new s.a(i));let d=n;if(u&&u.businessProcessFlowActions){const t=u.businessProcessFlowActions;for(const n of Object.keys(t))t[n].uniqueName===e&&(d=t[n])}const g=Object.keys(t).length-3;(!d||g>Object.keys(d.inputParameters).length)&&(this._navigation.openErrorDialog({message:Object(c.b)(Se.getState(),"Error_Message_0x80060375"),errorCode:2147877749}),Object(y.e)(r,Object(c.b)(Se.getState(),"Error_Title_0x80060375")));const h={entity:{typeName:l,structuralProperty:5},BusinessProcessFlowId:{typeName:"Edm.String",structuralProperty:1},BusinessProcessFlowInstanceId:{typeName:"Edm.String",structuralProperty:1},ActionStepId:{typeName:"Edm.String",structuralProperty:1}};this._buildParameterDescriptors(h,t,d),this._convertParameterValuesToCompatibleFormat(t,d);const f={boundParameter:"entity",operationName:e,operationType:0,parameterTypes:h},m=Object.assign({getMetadata:()=>f,entity:o},t);return this._setPropertyNonEnumerable(m,"getMetadata"),this._setPropertyNonEnumerable(m,"Target"),Se.dispatch(Object(p.b)(m)).then(e=>e.text().then(e=>this._buildProcessActionResponse(e))).catch(e=>404===e.get_request().status?Object(y.d)(Se,{errorCode:2147766354,code:2147766354},r,a):Object(y.d)(Se,e,r+".executeODataAction",a))}):Object(y.d)(Se,{errorCode:2147746581,code:2147746581},r,a),[{name:"name",value:e,isEventParam:!0}])}_getCurrentProcessIdValue(e){if(e)return Promise.resolve(e);const t=window.parent.getCurrentXrm();return t.Page.data.process&&t.Page.data.process.getActiveProcess()?Promise.resolve(t.Page.data.process.getActiveProcess().getId()):Promise.resolve("")}_buildProcessActionResponse(e){let t={};""!==e&&("string"==typeof e?t=JSON.parse(e):e&&204!==e.status&&(t=e));const n={};Object.keys(t).forEach(e=>{n[e]=t[e]});return{get_outputParameters:()=>n}}_setPropertyNonEnumerable(e,t){const n=Object.getOwnPropertyDescriptor(e,t);n.enumerable=!1,Object.defineProperty(e,t,n)}_buildParameterDescriptors(e,t,n){for(const r of Object.keys(t))if(n&&n.inputParameters&&r in n.inputParameters){const t=n.inputParameters[r];e[r]={typeName:t.parameterType,structuralProperty:t.parameterStructuralProperty}}}_convertParameterValuesToCompatibleFormat(e,t){if(!Object(y.a)(t))for(const n of Object.keys(e))n in t.inputParameters&&"Edm.Boolean"===t.inputParameters[n].parameterType&&(e[n]=Boolean(Number(e[n])))}refreshParentGrid(e){const t="ClientApi.XrmUtility.refreshParentGrid";e&&e.entityType||Object(y.j)(t,"lookupValue or lookupValue.entityType");try{O.a.instance.reportCall(t),Se.dispatch(Object(u.a)(e.entityType)).then(()=>{O.a.instance.reportSuccess(t)}).catch(e=>Object(y.d)(Se,e,t))}catch(e){throw C.a.getInstance().reportFailure(t,e),e}}getLearningPathAttributeName(){const e="ClientApi.XrmUtility.getLearningPathAttributeName";try{O.a.instance.reportCall(e);const t=se.a.LearningPathDOMAttributeName;return O.a.instance.reportSuccess(e),t}catch(t){C.a.getInstance().reportFailure(e,t)}}getPageContext(){return this._clientApiExecutor.execute("getPageContext",()=>(this._pageContext||(this._pageContext=new me(Se,this._pageId)),this._pageContext))}executeFunction(e,t,n,r){const a=[{name:"webResource",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"method",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"runSync",value:r,isEventParam:!0,expectedDataType:"boolean"},{name:"pageId",value:this._pageId,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];return r?this._clientApiExecutor.execute("executeFunction",(r,a)=>{Object(ue.e)(Se.getState())!==le.a&&Object(y.e)(r,"Sync option is only available in USD",null,a);const i=Object(be.a)(r,Se.getState(),this._applicationContext,this._pageId,a);if(!i)throw Object(o.d)("Container does not exist",2415919125);const s=Object(oe.t)(Se.getState());return i.loadWebResourceSync_DO_NOT_USE(s+e),i.execute(t,n,!0)},a):this._clientApiExecutor.executeAsync("executeFunction",(r,a)=>{const i=Object(be.a)(r,Se.getState(),this._applicationContext,this._pageId,a);if(!i)throw Object(o.d)("Container does not exist",2415919125);return i.getEventManager().loadWebResources(Se.dispatch,this._applicationContext,this._pageId,Se.getState,[e],null,null,[]).then(()=>i.execute(t,n,!0))},a)}}var Ce=n("XZPR"),Ee=n("amok");let Ie;class we{constructor(e,t){Ie=e,this._context=t,this._clientApiExecutor=new r.b(e,"ClientApi.XrmApplicationUI.")}static getInstance(e,t){if(!we._instance){const n="ClientApi.XrmApplicationUI.getInstance";Object(y.g)(e,n,"store"),we._instance=new we(e,t)}return we._instance}addGlobalNotification(e,t,n,r,a,i){return this._clientApiExecutor.execute("addGlobalNotification",()=>{let o;return o=e&&"object"==typeof e?e:{type:e,level:t,message:n,title:r,action:a,onCloseHandler:i},Ee.a.getInstance(Ie,this._context).addGlobalNotification(o)})}clearGlobalNotification(e){return this._clientApiExecutor.execute("clearGlobalNotification",()=>Ee.a.getInstance(Ie,this._context).clearGlobalNotification(e))}clearGlobalNotifications(){return this._clientApiExecutor.execute("clearGlobalNotifications",()=>Ie.dispatch(Object(Ce.b)()))}}var je=n("rQHy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let Pe;class Te{constructor(e,t){if(!e){const e="ClientApi.XrmGridPageFormUI.constructor";Object(y.j)(e,"store")}Pe=e,this._pageId=t}get controls(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.controls"),null}get headerSection(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.headerSection"),null}get footerSection(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.footerSection"),null}get formSelector(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.formSelector"),null}get navigation(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.navigation"),null}get process(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.process"),null}get tabs(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.tabs"),null}get quickForms(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.quickForms"),null}clearFormNotification(e){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.clearFormNotification"),null}close(){O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.close")}getFormType(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.getFormType"),null}isDialog(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.isDialog"),null}getViewPortHeight(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.getViewPortHeight"),null}getViewPortWidth(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.getViewPortWidth"),null}refreshRibbon(e=!1){const t="ClientApi.XrmGridPageFormUI.refreshRibbon";try{O.a.instance.reportCall(t),Pe.dispatch(Object(je.a)(this._pageId,null,e)).then(()=>{O.a.instance.reportSuccess(t)}).catch(e=>{const n=C.a.getInstance().getEventParameters(this.contextToken);return Object(y.d)(Pe,e,t+".refreshCommandManager",n)})}catch(e){const n=C.a.getInstance().getEventParameters(this.contextToken);throw C.a.getInstance().reportFailure(t,e,null,n),e}}setFormEntityName(e){O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.setFormEntityName")}setFormNotification(e,t,n){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.setFormNotification"),null}get contextToken(){return null}addOnLoad(e){O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.addOnLoad")}removeOnLoad(e){O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.removeOnLoad")}get formContext(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.formContext"),null}refresh(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.refresh"),null}getControls(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.getControls"),null}}var Ne=n("3yqi"),Ae=n("OQLa"),De=n("deGN");let Re;class xe{constructor(e,t){if(!e){const e="ClientApi.XrmGridPageForm.constructor";Object(y.j)(e,"store")}Re=e,this._pageId=t}get context(){return O.a.instance.reportUsage("ClientApi.XrmGridPageForm.context.get"),this._globalContext}set context(e){this._globalContext=e}get data(){return O.a.instance.reportUsage("ClientApi.XrmGridPageForm.data"),null}get ui(){const e="ClientApi.XrmGridPageForm.ui";try{return O.a.instance.reportCall(e),this._ui||(this._ui=new Te(Re,this._pageId)),O.a.instance.reportSuccess(e),this._ui}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}get entityReference(){return O.a.instance.reportUsage("ClientApi.XrmGridPageForm.entityReference"),null}getControl(e){return O.a.instance.reportUsage("ClientApi.XrmGridPageForm.getControl"),null}getAttribute(e){return O.a.instance.reportUsage("ClientApi.XrmGridPageForm.getAttribute"),null}getUrl(e){const t="ClientApi.XrmGridPageForm.getUrl";if(!this._pageId)throw U.a.getInstance().traceManager.getTracer(t+".pageId").error("Missing pageId"),new Error("getUrl was called on a page where Client API was not initialized properly.");let n=null;try{if(O.a.instance.reportCall(t),n=Object(he.l)(Re.getState(),this._pageId),n===Ne.a.Dashboard||n===Ne.a.Grid){const r=Object(he.g)(Re.getState(),this._pageId);if(1===e){const e=Re.dispatch(Object(Ae.a)(n,r));return O.a.instance.reportSuccess(t),e}const a=Object(De.a)(Re,this._pageId),i=Re.dispatch(Object(Ae.c)(a,n,r));return O.a.instance.reportSuccess(t),i}O.a.instance.reportSuccess(t)}catch(e){throw C.a.getInstance().reportFailure(t,e),e}const r=[];r.push({name:"pageType",value:n});const a="getUrl is not supported for this page type",i=`${a}: ${n}`;Object(y.e)(t,i,a,r)}}var Me=n("nzu+"),Fe=n("tICD"),ke=n("ruPX"),Le=n("cfbi"),Be=n("BMZr"),Ue=n("odYE"),Ve=n("fA3V"),ze=n("zu1I"),We=n("+BIz"),qe=n("tT9w"),He=n("F1Lu"),Ge=n("ZFkP"),Ke=n("1kth"),Qe=n("dHD5"),Xe=n("B3HF"),Ye=n("htFu"),Je=n("5Oca"),$e=n("D+Bz"),Ze=n("i1f0"),et=n("A09F"),tt=n("D6Jg"),nt=n("lY/Z"),rt=n("WPtp"),at=n("dUiZ"),it=n("0GT3"),ot=n("uNu9"),st=n("Lyxw"),ct=n("pF61"),lt=n("ZUus"),ut=n("3/02"),dt=n("d4He"),pt=n("SSc5"),gt=n("wL2W"),ht=n("pEXn"),ft=n("4aOd"),mt=n("QHx/");let bt;class _t{constructor(e,t,n,r){const a="ClientApi.XrmNavigation.constructor";e||Object(y.j)(a,"store"),t||Object(y.j)(a,"context"),n||Object(y.j)(a,"globalContext"),bt=e,this._context=t,this._globalContext=n,this._clientApiExecutor=new de.a(bt,"ClientApi.XrmNavigation.",r),this._pageId=r}addOnPreNavigation(e){const t="ClientApi.XrmNavigation.addOnPreNavigation";try{O.a.instance.reportCall(t),this._context.Router.addGlobalOnPreNavigation(e),O.a.instance.reportSuccess(t)}catch(e){throw C.a.getInstance().reportFailure(t,e),e}}removeOnPreNavigation(e){const t="ClientApi.XrmNavigation.removeOnPreNavigation";try{O.a.instance.reportCall(t),this._context.Router.removeGlobalOnPreNavigation(e),O.a.instance.reportSuccess(t)}catch(e){throw C.a.getInstance().reportFailure(t,e),e}}openAlertDialog(e,t){return this._clientApiExecutor.executeAsync("openAlertDialog",(n,r,a)=>{this._runFormChecker(n,a.apiName,{name:"alertStrings",value:JSON.stringify(e)},{name:"options",value:JSON.stringify(t)});let i={};return t&&(i={width:t.width,height:t.height}),bt.dispatch(Object(Me.a)(e,i,this._pageId)).then(e=>0===e.status?bt.dispatch(Object(Fe.a)(e.pageId)).then(()=>({})):Promise.reject(e.error))},[{name:"alertStrings",value:e,isRequired:!0}])}openConfirmDialog(e,t){return this._clientApiExecutor.executeAsync("openConfirmDialog",(n,r,a)=>{this._runFormChecker(n,a.apiName,{name:"alertStrings",value:JSON.stringify(e)},{name:"options",value:JSON.stringify(t)});let i={};return t&&(i={width:t.width,height:t.height,restoreFocus:t.restoreFocus}),bt.dispatch(Object(We.a)(e.text,i,e.title,this._pageId,e.subtitle,e.confirmButtonLabel,e.cancelButtonLabel)).then(e=>0===e.status?bt.dispatch(Object(Fe.a)(e.pageId)).then(e=>({confirmed:e.value.confirmed})):Promise.reject(e.error))},[{name:"confirmStrings",value:e,isRequired:!0}])}openDialog(e,t,n){return this._clientApiExecutor.executeAsync("openDialog",(r,a,i)=>{this._runFormChecker(r,i.apiName,{name:"name",value:e},{name:"options",value:JSON.stringify(t)},{name:"parameters",value:this._getParametersValue(n)});let o={};if(t){let e=null;switch(t.position){case 1:e="center";break;case 2:e="side";break;case 3:e="inline"}o={width:t.width,height:t.height,windowPosition:e}}return bt.dispatch(Object(ze.b)(e,o,n,this._pageId)).then(e=>0===e.status?bt.dispatch(Object(Fe.a)(e.pageId)).then(e=>({parameters:e.value})):Promise.reject(e.error))},[{name:"name",value:e,isRequired:!0,isEventParam:!0}])}openErrorDialog(e){return this._clientApiExecutor.executeAsync("openErrorDialog",(t,n,r)=>{this._runFormChecker(t,r.apiName,{name:"options",value:JSON.stringify(e)});const a=new ce.a(e.message,e.errorCode,null,null,null,null,e.details);return e.errorRegion&&(a.errorRegion=e.errorRegion),bt.dispatch(Object(qe.b)(a,!0,this._pageId)).then(()=>({}))},[{name:"options",value:e,isRequired:!0}])}openFile(e,t){const n="ClientApi.XrmNavigation.openFile";e||Object(y.j)(n,"file");try{O.a.instance.reportCall(n);return new G.a(this._context,bt).openFile(e,t).then(()=>{O.a.instance.reportSuccess(n)}).catch(e=>Object(y.d)(bt,e,n+".fileManager.openFile"))}catch(e){return Object(y.d)(bt,e,n)}}navigateTo(e,t){const n=this._clientApiExecutor.getComponentName("navigateTo");let r,a,i;return this._runFormChecker(n,"navigateTo",{name:"options",value:JSON.stringify(t)},{name:"input",value:JSON.stringify(e)}),t&&(r=Object(pe.c)(n,t),2===t.target?a=Object(pe.f)(n,t):3===t.target&&(i=Object(pe.g)(n,t))),Object(pe.i)(bt,this._clientApiExecutor,e,"navigateTo",r,a,i,this._pageId)}navigateBack(){return this._clientApiExecutor.executeAsync("navigateBack",()=>{const e=bt.getState(),t=this._pageId||Object(ct.c)(e),n=Object(mt.a)(e,t,$e.b.Xrm);if(!n.targetBrowsingContext){const e=this._clientApiExecutor.getComponentName("navigateBack");Object(y.h)(e,"pageId",t)}return bt.dispatch(Object(pt.a)(n))})}canNavigateBack(){return this._clientApiExecutor.execute("canNavigateBack",()=>{const e=bt.getState(),t=this._pageId||Object(ct.c)(e),n=Object(mt.a)(e,t,$e.b.Xrm);if(!n.targetBrowsingContext){const e=this._clientApiExecutor.getComponentName("navigateBack");Object(y.h)(e,"pageId",t)}return!Object(ct.e)(e,n.targetBrowsingContext)})}openForm(e,t){return this._clientApiExecutor.executeAsync("openForm",(n,r,a)=>{if(this._runFormChecker(n,a.apiName,{name:"options",value:JSON.stringify(e)},{name:"parameters",value:this._getParametersValue(t)}),e.createFromEntity&&(e.createFromEntity.id||Object(y.j)(n,"createFromEntity.id"),e.createFromEntity.entityType||Object(y.j)(n,"createFromEntity.entityType")),e.entityId&&!s.a.tryParseOrNull(e.entityId)&&Object(y.h)(n,"options.entityId",e.entityId),!e.entityId&&(e.showDialog||e.useQuickCreateForm)){return(Object(at.a)(bt.getState())?Promise.resolve():bt.dispatch(Object(it.a)())).then(()=>{const r=Object(Ze.I)(bt.getState(),e.entityName),a=this._openCreateFormDialog(n,e,t);if(r===et.a.QuickCreateForm||r===et.a.MainFormDialog)return a;const i={savedEntityReference:[{entityType:e.entityName,id:e.entityId,name:e.entityName}]};return Promise.resolve(i)})}const i=bt.getState(),o=Object(ct.c)(i),c=Object(he.g)(i,o),l=c&&c.isQueryMode,u=c&&c.isAdvancedFindView;return this._openEntityForm(n,e,t,{isQueryMode:l,isAdvancedFindView:u})},[{name:"options",value:e,isRequired:!0},{name:"options.entityName",value:null==e?void 0:e.entityName,isRequired:!0,isEventParam:!0}])}_openEntityForm(e,t,n,r){let a;e+="._openEntityForm",t.createFromEntity&&(a=new Ue.a(t.createFromEntity.entityType,new s.a(t.createFromEntity.id),t.createFromEntity.name));const i=t.recordSetQueryKey&&t.recordSetQueryKey.split("-")[0];i&&i!==t.entityName&&i!==ot.b&&i!==ot.Bb&&t.entityId&&t.entityName&&(t.recordSetQueryKey=`${t.entityName}-${t.entityId}`);let o={};o={entityTypeName:t.entityName,id:t.entityId?new s.a(t.entityId):void 0,data:n||void 0,formId:t.formId?new s.a(t.formId):void 0,processId:t.processId,processInstanceId:t.processInstanceId,selectedStageId:t.selectedStageId,isCrossEntityNavigate:t.isCrossEntityNavigate,initWithEntity:a,cmdbar:t.cmdbar,recordSetQueryKey:t.recordSetQueryKey,isOfflineSyncError:t.isOfflineSyncError,navbar:Object(tt.e)(t.navbar),isQueryMode:r&&r.isQueryMode,isAdvancedFindView:r&&r.isAdvancedFindView};const c={savedEntityReference:[{entityType:t.entityName,id:t.entityId,name:t.entityName}]};if("report"===o.entityTypeName){const e=new Ue.a("report",o.id),t="reporttypecode",n="filename",r="bodybinary",a="filesize",i="mimetype",l=[t,n,r,a,i],u=s.a.toString(o.id);return bt.dispatch(Object(nt.d)(e,l)).then(()=>{const o=Object(Je.j)(bt.getState(),e,t),s=o?parseInt(o.valueString,10):null;if(2===s){const t=Object(rt.c)(Object(Je.j)(bt.getState(),e,n)),o=Object(rt.c)(Object(Je.j)(bt.getState(),e,r)),s=Object(rt.c)(Object(Je.j)(bt.getState(),e,a)),l={fileName:t,fileContent:o,fileSize:parseInt(s,10),mimeType:Object(rt.c)(Object(Je.j)(bt.getState(),e,i))},u={openMode:2};return this.openFile(l,u),Promise.resolve(c)}if(1===s||3===s){const e=this._globalContext.prependOrgName("/crmreports/viewer/viewer.aspx?id="+encodeURIComponent(u));return this.openUrl(e),Promise.resolve(c)}})}if(t&&t.openInNewWindow&&this._globalContext&&this._globalContext.client&&"Web"===this._globalContext.client.getClient())return o.newWindowOptions=Object(pe.g)(e,t),bt.dispatch(Object(ke.c)(Le.a,o)).then(n=>(this._attachEvent(e,n&&n.pageId,t),Promise.resolve(c)));const l=o&&o.data&&o.data.recurringAppointmentFormData?$e.b.Redirect:{target:"inline"};return bt.dispatch(Object(ke.a)(Le.a,o,this._pageId,l)).then(n=>0===n.status?(this._attachEvent(e,n.pageId,t),Promise.resolve(c)):Promise.reject(n.error))}_openCreateFormDialog(e,t,n){e+="._openCreateFormDialog";const r={height:t.height,width:t.width,openInNewWindow:t.openInNewWindow};let a;return t.createFromEntity&&(a=new Ue.a(t.createFromEntity.entityType,new s.a(t.createFromEntity.id),t.createFromEntity.name)),bt.dispatch(Object(Be.b)(t.entityName,this._pageId,r,n,a,null,t)).then(n=>{if(0===n.status){Object(he.l)(bt.getState(),n.pageId)===Ne.a.EditForm&&this._attachEvent(e,n.pageId,t);const r={pageType:"entityrecord",entityName:t.entityName,createFromEntity:t.createFromEntity,relationship:t.relationship};return Object(pe.h)(bt,n,r)}return Promise.reject(n.error)})}openTaskFlow(e,t,n){return this._clientApiExecutor.executeAsync("openTaskFlow",(r,a,i)=>(this._runFormChecker(r,i.apiName,{name:"name",value:e},{name:"options",value:JSON.stringify(t)},{name:"parameters",value:this._getParametersValue(n)}),bt.dispatch(Object(Ye.c)()).then(()=>bt.dispatch(Object(Ge.a)(t.primaryEntityContext.entityType,e,new s.a(t.primaryEntityContext.id),n,this._pageId)).then(e=>0===e.status?bt.dispatch(Object(Fe.a)(e.pageId)).then(e=>({parameters:e})):Promise.reject(e.error)))),[{name:"name",value:e,isRequired:!0,isEventParam:!0},{name:"options",value:t,isRequired:!0}])}openUrl(e,t){return this._clientApiExecutor.executeAsync("openUrl",async(n,r,a)=>{if(this._runFormChecker(n,a.apiName,{name:"url",value:e},{name:"options",value:JSON.stringify(t)}),Object(st.c)(bt.getState(),ut.Hc))return bt.dispatch(Object(dt.a)(e,t));if(t&&t.isExternal){const t=J.a.get_Instance(),n=t?t.get_document():null;if(t.willDispatcherBeAvailableFromDevice("Document")&&n){return(await n).openExternalUrl(e),Promise.resolve()}}return new He.a(this._context,bt).openUri(e,t)},[{name:"url",value:e,isRequired:!0}])}openWebResource(e,t,n){this._clientApiExecutor.executeAsync("openWebResource",(r,a,i)=>{this._runFormChecker(r,i.apiName,{name:"name",value:e},{name:"options",value:JSON.stringify(t)},{name:"data",value:n});const o={webresourceName:e,webresourceData:{webresourceData:n},navbar:lt.a.Off,cmdbar:!1};return t&&(o.newWindowOptions=Object(pe.g)(e,t)),this._globalContext&&this._globalContext.client&&"Mobile"===this._globalContext.client.getClient()&&!Object(st.d)(bt.getState(),"MobileClientSupportsExternalLinks")?bt.dispatch(Object(ke.a)(Ve.a,o,this._pageId,$e.b.Xrm)):bt.dispatch(Object(ke.c)(Ve.a,o))},[{name:"name",value:e,isRequired:!0}])}addBeforeOnLoad(e){const t="ClientApi.XrmNavigation.addBeforeOnLoad";e||Object(y.j)(t,"handler");try{O.a.instance.reportCall(t),bt.dispatch(Object(Xe.a)(e)),O.a.instance.reportSuccess(t)}catch(e){throw C.a.getInstance().reportFailure(t,e),e}}removeBeforeOnLoad(e){const t="ClientApi.XrmNavigation.removeBeforeOnLoad";e||Object(y.j)(t,"handler");try{O.a.instance.reportCall(t),bt.dispatch(Object(Xe.f)(e)),O.a.instance.reportSuccess(t)}catch(e){throw C.a.getInstance().reportFailure(t,e),e}}_attachEvent(e,t,n){e+="._attachEvent";return new Promise((r,a)=>{try{t?bt.dispatch(Object(Ke.o)(Object(Qe.j)(bt.getState(),t),t,()=>{try{bt.dispatch(Object(Ke.c)(Object(Qe.j)(bt.getState(),t),t,t=>{try{if(t){const a=t.getEventSource();if(a&&a.getId())return Object(pe.a)(bt,a.getEntityReference(),null==n?void 0:n.createFromEntity,null==n?void 0:n.relationship).then(()=>{const e={savedEntityReference:[a.getEntityReference()]};r(e)}).catch(t=>Object(y.d)(bt,t,e+"._associate"))}}catch(t){Object(y.d)(bt,t,e+".dataLoaded").catch(e=>a(e))}}))}catch(t){Object(y.d)(bt,t,e+".onDataLoad").catch(e=>a(e))}})):r()}catch(t){Object(y.d)(bt,t,e).catch(e=>a(e))}})}addOnOpenUrl(e){const t="ClientApi.XrmNavigation.addOnOpenUrl";e||Object(y.j)(t,"handler");try{O.a.instance.reportCall(t),bt.dispatch(Object(Xe.b)(e)),O.a.instance.reportSuccess(t)}catch(e){throw C.a.getInstance().reportFailure(t,e),e}}removeOnOpenUrl(e){const t="ClientApi.XrmNavigation.removeOnOpenUrl";e||Object(y.j)(t,"handler");try{O.a.instance.reportCall(t),bt.dispatch(Object(Xe.g)(e)),O.a.instance.reportSuccess(t)}catch(e){throw C.a.getInstance().reportFailure(t,e),e}}_runFormChecker(e,t,...n){var r;if(!Object(gt.a)())return;const a=new ft.a(new Error),i=n.concat({name:"callStack",value:a.getStackTrace()});null===(r=U.a.getInstance().traceManager.getTracer(`${ht.k}${ht.o}`))||void 0===r||r.warn(ht.n,[{name:ht.v,value:ht.o},{name:ht.o,value:JSON.stringify(i)}])}_getParametersValue(e){let t;try{t=JSON.stringify(e)}catch(e){t="Error logging parameters"}return t}}var yt=n("rcL5"),vt=n("/leX"),St=n("nJrx"),Ot=n("dNvO"),Ct=n("5X+N");let Et,It;class wt{constructor(e,t){this._store=e,this._clientApiExecutor=new r.b(this._store,"ClientApi.XrmPanel.");const n=this._clientApiExecutor.getComponentName("constructor");Object(y.g)(e,n,"store"),Object(y.g)(t,n,"context"),this._onChannelMessageRecieved=this._onChannelMessageRecieved.bind(this),this._channel=t.ChannelManager.createChannel(Object(St.a)(),this._onChannelMessageRecieved)}static getInstance(e,t){return wt._instance||(wt._instance=new wt(e,t)),wt._instance}set position(e){this._clientApiExecutor.execute("position_set",()=>{this._legacyPanelId&&Et&&this._store.dispatch(Et(this._legacyPanelId,{sidePanelPosition:e}))},[{name:"panelPosition",value:e,isRequired:!0,isEventParam:!0}])}get position(){return this._clientApiExecutor.execute("position_get",()=>this._legacyPanelId?Object(yt.d)(this._store.getState(),this._legacyPanelId).option.sidePanelPosition:1)}set state(e){this._clientApiExecutor.execute("state_set",()=>{this._legacyPanelId&&Et&&this._store.dispatch(Et(this._legacyPanelId,{sidePanelState:e}))},[{name:"panelState",value:e,isRequired:!0,isEventParam:!0}])}get state(){return this._clientApiExecutor.execute("state_get",()=>this._legacyPanelId?Object(yt.d)(this._store.getState(),this._legacyPanelId).option.sidePanelState:2)}set title(e){this._clientApiExecutor.execute("title_set",()=>{this._legacyPanelId&&Et&&this._store.dispatch(Et(this._legacyPanelId,{sidePanelTitle:e}))},[{name:"panelTitle",value:e,isRequired:!0,expectedDataType:"string"}])}get title(){return this._clientApiExecutor.execute("title_get",()=>this._legacyPanelId?Object(yt.d)(this._store.getState(),this._legacyPanelId).option.sidePanelTitle:"")}get url(){return this._clientApiExecutor.execute("url_get",()=>{const e=this._legacyPanelId?Object(yt.d)(this._store.getState(),this._legacyPanelId):null;return e&&e.type===vt.b.IFrame?e.sidePanelURL:""})}set width(e){this._clientApiExecutor.execute("width_set",()=>{this._legacyPanelId&&Et&&this._store.dispatch(Et(this._legacyPanelId,{sidePanelWidth:e.toString()+"px"}))},[{name:"panelWidth",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"number"}])}get width(){return this._clientApiExecutor.execute("width_get",()=>this._legacyPanelId?It(this._store.getState(),this._legacyPanelId):0)}loadPanel(e,t="",n){const r=this._clientApiExecutor.getComponentName("loadPanel"),a=[];if(this._legacyPanelId)return Promise.resolve();let i;try{i="string"==typeof e?this._convertOldInterfaceOptions(e,t,n,a):e}catch(e){return O.a.instance.reportCall(r),Object(y.d)(this._store,e,r+".convertOldInterfaceOptions",a)}return this._clientApiExecutor.executeAsync("loadPanel",()=>Object(Ct.a)().then(t=>(Et=t.setPanelOptions,It=t.getPanelWidth,this._store.dispatch(t.loadSidePanelWithUrl(i.url,i.title,i.width,i.position,i.state,i.defaultCollapsedBehavior,true,false,true,false,true)).then(t=>{const r=t.sidePanelId;this._channel.subscribeTo(r),this._legacyPanelId||(this._legacyPanelId=r),"string"==typeof e&&n&&this._addCustomHandersInOldOptions(n,a)}))),[{name:"options",value:i,isRequired:!0},{name:"options.url",value:i&&i.url,isRequired:!0}])}postMessage(e){this._clientApiExecutor.execute("postMessage",()=>{this._legacyPanelId&&this._channel.sendTo(this._legacyPanelId,e)},[{name:"message",value:e,isRequired:!0}])}addOnMessageReceived(e){this._clientApiExecutor.execute("addOnMessageReceived",()=>{this._legacyPanelId&&this._store.dispatch(Object(Xe.c)(this._legacyPanelId,e))},[{name:"handler",value:e,isRequired:!0}])}removeOnMessageReceived(e){this._clientApiExecutor.execute("removeOnMessageReceived",()=>{this._legacyPanelId&&this._store.dispatch(Object(Xe.h)(this._legacyPanelId,e))},[{name:"handler",value:e,isRequired:!0}])}addOnSizeChange(e){this._clientApiExecutor.execute("addOnSizeChange",()=>{this._legacyPanelId&&this._store.dispatch(Object(Xe.d)(this._legacyPanelId,e))},[{name:"handler",value:e,isRequired:!0}])}removeOnSizeChange(e){this._clientApiExecutor.execute("removeOnSizeChange",()=>{this._legacyPanelId&&this._store.dispatch(Object(Xe.i)(this._legacyPanelId,e))},[{name:"handler",value:e,isRequired:!0}])}addOnStateChange(e){this._clientApiExecutor.execute("addOnStateChange",()=>{this._legacyPanelId&&this._store.dispatch(Object(Xe.e)(this._legacyPanelId,e))},[{name:"handler",value:e,isRequired:!0}])}removeOnStateChange(e){this._clientApiExecutor.execute("removeOnStateChange",()=>{this._legacyPanelId&&this._store.dispatch(Object(Xe.j)(this._legacyPanelId,e))},[{name:"handler",value:e,isRequired:!0}])}_onChannelMessageRecieved(e,t){if(this._legacyPanelId===t)switch(e.type){case Ot.a.PostMessage:const t={message:e.data.data,origin:e.data.origin};this._store.dispatch(Object(Xe.k)(this._legacyPanelId,this,t));break;case Ot.a.SizeChange:this._store.dispatch(Object(Xe.l)(this._legacyPanelId,this));break;case Ot.a.StateChange:this._store.dispatch(Object(Xe.m)(this._legacyPanelId,this))}}_convertOldInterfaceOptions(e,t,n,r){const a={url:e,title:t};return n&&(a.width=n.initialWidth,a.defaultCollapsedBehavior=n.defaultCollapsedBehavior,null!==n.defaultCollapsedBehavior&&void 0!==n.defaultCollapsedBehavior&&r.push({name:"defaultCollapsedBehavior",value:""+n.defaultCollapsedBehavior})),a}_addCustomHandersInOldOptions(e,t){e.onSizeChangeHandler&&(t.push({name:"sidePanelOnSizeChangeHandler",value:"true"}),this.addOnSizeChange(e.onSizeChangeHandler)),e.onStateChangeHandler&&(t.push({name:"sidePanelOnStateChangeHandler",value:"true"}),this.addOnStateChange(e.onStateChangeHandler))}}var jt,Pt,Tt,Nt,At,Dt,Rt,xt,Mt=n("bpBl"),Ft=n("errb"),kt=n("SJlc"),Lt=n("ZePi");!function(e){e.online="Online",e.offline="Offline"}(jt||(jt={})),function(e){e.button="button",e.standard="standard",e.iFrame="iframe",e.lookup="lookup",e.optionSet="optionset",e.subGrid="subgrid",e.webResource="webresource",e.notes="notes",e.timer="timercontrol",e.kbsearch="kbsearch",e.customcontrol="customcontrol",e.customsubgrid="customsubgrid",e.quickFormControl="quickform",e.timeline="timeline",e.timelinewall="timelinewall",e.multiSelectOptionSet="multiselectoptionset"}(Pt||(Pt={})),function(e){e.save="save",e.saveAndClose="saveandclose",e.saveAndNew="saveandnew"}(Tt||(Tt={})),function(e){e.none="none",e.recommended="recommended",e.required="required"}(Nt||(Nt={})),function(e){e.dirty="dirty",e.always="always",e.never="never"}(At||(At={})),function(e){e.error="ERROR",e.warning="WARNING",e.information="INFO"}(Dt||(Dt={})),function(e){e.error="ERROR",e.recommendation="RECOMMENDATION"}(Rt||(Rt={})),function(e){e.ActivityParty="activityparty",e.ActivityPointer="activitypointer",e.Annotation="annotation",e.Attachment="attachment",e.Category="category",e.Connection="connection",e.ConnectionRole="connectionrole",e.SystemUser="systemuser",e.Team="team",e.TeamMembership="teammembership",e.WebResource="webresource"}(xt||(xt={}));var Bt,Ut,Vt,zt,Wt=n("cZbt");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e.Next="Next",e.Previous="Previous"}(Bt||(Bt={})),function(e){e.active="active",e.inactive="inactive"}(Ut||(Ut={})),(zt=Vt||(Vt={})).AttributeFormats=Ft.a,zt.AttributeTypes=kt.a,zt.ClientNames=Lt.a,zt.ClientStates=jt,zt.ControlTypes=Pt,zt.FormSaveActions=Tt,zt.AttributeRequiredLevels=Nt,zt.AttributeSubmitModes=At,zt.TabDisplayStates=Mt.a,zt.FormNotificationLevels=Dt,zt.ControlNotificationLevel=Rt,zt.EntityNames=xt,zt.ProcessInstanceStatuses=Wt.a,zt.ProcessNavigationDirections=Bt,zt.ProcessStageStatuses=Ut;var qt=n("n6Qt");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Ht;!function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error"}(Ht||(Ht={}));class Gt{constructor(e,t){this._applicationContext=t,this._clientApiExecutor=new r.b(e,"ClientApi.XrmDiagnostics.")}static getInstance(e,t){return Gt._instance||(Object(y.g)(t,"ClientApi.XrmDiagnostics.getInstance","applicationContext"),Gt._instance=new Gt(e,t)),Gt._instance}traceError(e,t,n){this._trace(Ht.Error,e,t,n)}traceWarning(e,t,n){this._trace(Ht.Warning,e,t,n)}traceInfo(e,t,n){this._trace(Ht.Info,e,t,n)}traceDebug(e,t,n){this._trace(Ht.Debug,e,t,n)}_trace(e,t,n,r){const a=!t.startsWith("ClientApi.");return this._clientApiExecutor.execute("trace"+Ht[e],()=>{const a=this._applicationContext.TraceManager.getTracer(t);switch(e){case Ht.Debug:a.debug(n,r);break;case Ht.Info:a.info(n,r);break;case Ht.Warning:a.warn(n,r);break;case Ht.Error:a.error(n,r)}},[{name:"componentName",value:t,isRequired:!0},{name:"message",value:n,isRequired:!0}],a)}}var Kt=n("sZ+8"),Qt=n("rzss");let Xt;class Yt{constructor(e,t){Xt=e,this._pageId=t}_getXrmWebApiOffline(e,t){return Object(Qt.a)().then(t=>t.getXrmWebApiOfflineInstance(e,this._pageId)).catch(e=>Object(y.d)(Xt,e,t+"._getXrmWebApiOffline"))}isOfflineEnabled(e){const t="ClientApi.XrmOffline.isOfflineEnabled";e||Object(y.j)(t,"entityType");try{O.a.instance.reportCall(t);const n=Object(Kt.l)(Xt.getState(),e);return O.a.instance.reportSuccess(t),n}catch(e){throw C.a.getInstance().reportFailure(t,e),e}}retrieveRecord(e,t,n){const r="ClientApi.XrmOffline.retrieveRecord";e||Object(y.j)(r,"entityType"),t||Object(y.j)(r,"id"),s.a.tryParseOrNull(t)||Object(y.k)(r,"guid","id"),n&&n.length>0&&!n.startsWith("?")&&Object(y.e)(r,'Option Parameter should begin with "?"');try{return O.a.instance.reportCall(r),this._getXrmWebApiOffline(Xt,r).then(a=>a.retrieveRecord(e,t,n).then(e=>(O.a.instance.reportSuccess(r),e)).catch(n=>{const a=[];return a.push({name:"entityName",value:e}),a.push({name:"entityId",value:t}),Object(y.d)(Xt,n,r+".retrieveRecord",a)}))}catch(n){const a=[];return a.push({name:"entityName",value:e}),a.push({name:"entityId",value:t}),Object(y.d)(Xt,n,r,a)}}createRecord(e,t){const n="ClientApi.XrmOffline.createRecord";e||Object(y.j)(n,"entityType"),t&&0!==Object.keys(t).length||Object(y.j)(n,"data");try{return O.a.instance.reportCall(n),this._getXrmWebApiOffline(Xt,n).then(r=>r.createRecord(e,t).then(e=>{const t=this._lookupValueToEntityReference(e);return O.a.instance.reportSuccess(n),t}).catch(t=>{const r=[];return r.push({name:"entityName",value:e}),Object(y.d)(Xt,t,n+".createRecord",r)}))}catch(t){const r=[];return r.push({name:"entityName",value:e}),Object(y.d)(Xt,t,n,r)}}updateRecord(e,t,n){const r="ClientApi.XrmOffline.updateRecord";e||Object(y.j)(r,"entityType"),t||Object(y.j)(r,"id"),s.a.tryParseOrNull(t)||Object(y.e)(r,t+" value is an invalid Guid"),n&&0!==Object.keys(n).length||Object(y.j)(r,"data");try{return O.a.instance.reportCall(r),this._getXrmWebApiOffline(Xt,r).then(a=>a.updateRecord(e,t,n).then(e=>{const t=this._lookupValueToEntityReference(e);return O.a.instance.reportSuccess(r),t}).catch(n=>{const a=[];return a.push({name:"entityName",value:e}),a.push({name:"entityId",value:t}),Object(y.d)(Xt,n,r+".updateRecord",a)}))}catch(n){const a=[];return a.push({name:"entityName",value:e}),a.push({name:"entityId",value:t}),Object(y.d)(Xt,n,r,a)}}deleteRecord(e,t){const n="ClientApi.XrmOffline.deleteRecord";e||Object(y.j)(n,"entityType"),t||Object(y.j)(n,"id"),s.a.tryParseOrNull(t)||Object(y.e)(n,t+" value is an invalid Guid");try{return O.a.instance.reportCall(n),this._getXrmWebApiOffline(Xt,n).then(r=>r.deleteRecord(e,t).then(e=>{const t=this._lookupValueToEntityReference(e);return O.a.instance.reportSuccess(n),t}).catch(r=>{const a=[];return a.push({name:"entityName",value:e}),a.push({name:"entityId",value:t}),Object(y.d)(Xt,r,n+".deleteRecord",a)}))}catch(r){const a=[];return a.push({name:"entityName",value:e}),a.push({name:"entityId",value:t}),Object(y.d)(Xt,r,n,a)}}retrieveMultipleRecords(e,t,n){const r="ClientApi.XrmOffline.retrieveMultipleRecords";e||Object(y.j)(r,"entityType"),t&&t.length>0&&!t.startsWith("?")&&Object(y.e)(r,'Option Parameter should begin with "?"'),null!==n&&n<0&&Object(y.e)(r,"Max Page Size should be a positive integer.");try{return O.a.instance.reportCall(r),this._getXrmWebApiOffline(Xt,r).then(a=>a.retrieveMultipleRecords(e,t,n).then(e=>(O.a.instance.reportSuccess(r),e)).catch(t=>{const n=[];return n.push({name:"entityName",value:e}),Object(y.d)(Xt,t,r+".retrieveMultipleRecords",n)}))}catch(t){const n=[];return n.push({name:"entityName",value:e}),Object(y.d)(Xt,t,r,n)}}_lookupValueToEntityReference(e){return{id:e.id,logicalName:e.entityType}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let Jt;class $t{constructor(e,t){Jt=e,this._pageId=t}get offline(){const e="ClientApi.XrmMobile.offline";try{O.a.instance.reportCall(e);const t=new Yt(Jt,this._pageId);return O.a.instance.reportSuccess(e),t}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}}var Zt=n("69Qu"),en=n("K9wp"),tn=n("17x/");let nn;class rn{constructor(e,t){nn=e,this._pageId=t,this._clientApiExecutor=new r.b(e,"ClientApi.XrmWebApiOfflineAsync.")}retrieveRecord(e,t,n){return this._clientApiExecutor.executeAsync("retrieveRecord",(r,a)=>(n&&n.length>0&&!n.startsWith("?")&&Object(y.e)(r,'Option Parameter should begin with "?"',null,a),this._ensureUnderlyingApi(r).then(r=>r.retrieveRecord(e,t,n))),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"id",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"guid"},{name:"options",value:n,isRequired:!1,isEventParam:!1,expectedDataType:"string"}])}createRecord(e,t){return this._clientApiExecutor.executeAsync("createRecord",n=>this._ensureUnderlyingApi(n).then(n=>n.createRecord(e,t)),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"data",value:t,isRequired:!0,expectedDataType:"object"}])}updateRecord(e,t,n){return this._clientApiExecutor.executeAsync("updateRecord",r=>this._ensureUnderlyingApi(r).then(r=>r.updateRecord(e,t,n)),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"id",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"guid"},{name:"data",value:n,isRequired:!0,expectedDataType:"object"}])}deleteRecord(e,t){return this._clientApiExecutor.executeAsync("deleteRecord",n=>this._ensureUnderlyingApi(n).then(n=>n.deleteRecord(e,t)),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"id",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"guid"}])}retrieveMultipleRecords(e,t,n){return this._clientApiExecutor.executeAsync("retrieveMultipleRecords",(r,a)=>(t&&t.length>0&&!t.startsWith("?")&&Object(y.e)(r,'Option Parameter should begin with "?"',null,a),null!==n&&n<0&&Object(y.e)(r,"Max Page Size should be a positive integer.",null,a),this._ensureUnderlyingApi(r).then(r=>r.retrieveMultipleRecords(e,t,n))),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"options",value:t,isRequired:!1,isEventParam:!1,expectedDataType:"string"},{name:"maxPageSize",value:n,isRequired:!1,isEventParam:!0,expectedDataType:"number"}])}execute(e,t){return this._clientApiExecutor.executeAsync("execute",n=>this._ensureUnderlyingApi(n).then(n=>n.execute(e,t)),[{name:"request",value:e,isRequired:!0,expectedDataType:"object"},{name:"request.getMetadata",value:e&&e.getMetadata,isRequired:!0,expectedDataType:"function"},{name:"operationName",value:e&&e.getMetadata&&e.getMetadata().operationName,isRequired:!0,isEventParam:!0}])}isAvailableOffline(e){return this._clientApiExecutor.execute("isAvailableOffline",()=>Object(Kt.l)(nn.getState(),e),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"}])}_ensureUnderlyingApi(e){return Object(Zt.b)(nn.getState())&&Object(y.e)(e,"API can be accessed only when offline."),Object(tn.a)(nn.getState())||Object(y.e)(e,"API can be accessed only when offline is enabled."),this._actualXrmWebApiOffline?Promise.resolve(this._actualXrmWebApiOffline):Object(Qt.a)().then(e=>(this._actualXrmWebApiOffline=e.getXrmWebApiOfflineInstance(nn,this._pageId),this._actualXrmWebApiOffline))}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let an;class on{constructor(e,t){an=e,this._pageId=t,this._clientApiExecutor=new r.b(e,"ClientApi.XrmWebApi.")}_getWebApiInstance(){return Object(Zt.b)(an.getState())?this.online:this.offline}get online(){return this._clientApiExecutor.execute("online",()=>(this._webApiOnline||(this._webApiOnline=new en.a(an,this._pageId)),this._webApiOnline))}get offline(){return this._clientApiExecutor.execute("offline",()=>(this._webApiOffline||(this._webApiOffline=new rn(an,this._pageId)),this._webApiOffline))}retrieveRecord(e,t,n){return this._clientApiExecutor.executeAsync("retrieveRecord",(r,a)=>(n&&n.length>0&&!n.startsWith("?")&&Object(y.e)(r,'Option Parameter should begin with "?"',null,a),this._getWebApiInstance().retrieveRecord(e,t,n)),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"id",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"guid"},{name:"options",value:n,isRequired:!1,isEventParam:!1,expectedDataType:"string"}])}createRecord(e,t){return this._clientApiExecutor.executeAsync("createRecord",()=>this._getWebApiInstance().createRecord(e,t),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"data",value:t,isRequired:!0,expectedDataType:"object"}])}updateRecord(e,t,n){return this._clientApiExecutor.executeAsync("updateRecord",()=>this._getWebApiInstance().updateRecord(e,t,n),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"id",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"guid"},{name:"data",value:n,isRequired:!0,expectedDataType:"object"}])}deleteRecord(e,t){return this._clientApiExecutor.executeAsync("deleteRecord",()=>this._getWebApiInstance().deleteRecord(e,t),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"id",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"guid"}])}retrieveMultipleRecords(e,t,n){return this._clientApiExecutor.executeAsync("retrieveMultipleRecords",(r,a)=>(t&&t.length>0&&!t.startsWith("?")&&Object(y.e)(r,'Option Parameter should begin with "?"',null,a),null!==n&&n<0&&Object(y.e)(r,"Max Page Size should be a positive integer.",null,a),this._getWebApiInstance().retrieveMultipleRecords(e,t,n)),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"options",value:t,isRequired:!1,isEventParam:!1,expectedDataType:"string"},{name:"maxPageSize",value:n,isRequired:!1,isEventParam:!0,expectedDataType:"number"}])}}var sn=n("CfSh");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let cn;class ln{constructor(e,t){this._externalContextService=new sn.a(t,e),cn=e}getExternalContextProperty(e,t,n){const r="ClientApi.XrmExternalContext.getExternalContextProperty";try{return O.a.instance.reportCall(r),this._externalContextService.getExternalContextProperty(e,t,n).then(e=>(O.a.instance.reportSuccess(r),e)).catch(n=>{const a=[];return a.push({name:"externalContextId",value:e}),a.push({name:"externalContextPropertyId",value:t}),Object(y.d)(cn,n,r,a)})}catch(n){const a=[];return a.push({name:"externalContextId",value:e}),a.push({name:"externalContextPropertyId",value:t}),Object(y.d)(cn,n,r,a)}}invokeExternalContextAction(e,t,n){const r="ClientApi.XrmExternalContext.invokeExternalContextAction";try{return O.a.instance.reportCall(r),this._externalContextService.invokeExternalContextAction(e,t,n).then(e=>(O.a.instance.reportSuccess(r),e)).catch(n=>{const a=[];return a.push({name:"externalContextId",value:e}),a.push({name:"externalContextActionId",value:t}),Object(y.d)(cn,n,r,a),Promise.reject(n)})}catch(n){const a=[];return a.push({name:"externalContextId",value:e}),a.push({name:"externalContextActionId",value:t}),Object(y.d)(cn,n,r,a)}}getAvailableExternalContexts(){const e="ClientApi.XrmExternalContext.getAvailableExternalContexts";try{O.a.instance.reportCall(e);const t=this._externalContextService.getAvailableExternalContexts(),n=new B.a(e);return t&&Object.keys(t).map(n=>({id:n,actions:Array.isArray(t[n].actions)&&t[n].actions.reduce((e,t)=>(e.add(t,t),e),new B.a(e+".actions")),properties:Array.isArray(t[n].properties)&&t[n].properties.reduce((e,t)=>(e.add(t,t),e),new B.a(e+".properties"))})).reduce((e,t)=>(e.add(t.id,t),e),n),O.a.instance.reportSuccess(e),n}catch(t){throw C.a.getInstance().reportFailure(e,t),t}}removeExternalContextPropertyListener(e,t,n){const r="ClientApi.XrmExternalContext.removeExternalContextPropertyListener";try{O.a.instance.reportCall(r);const a=this._externalContextService.removeExternalContextPropertyListener(e,t,n);return O.a.instance.reportSuccess(r),a}catch(e){throw C.a.getInstance().reportFailure(r,e),e}}}var un=n("fU7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class dn{static getInstance(e){e||Object(y.j)("ClientApi.XrmEncoding.getInstance","store");try{return this._instance||(this._instance=new dn),this._instance}catch(e){throw C.a.getInstance().reportFailure("ClientApi.XrmEncoding.getInstance",e),e}}xmlEncode(e){const t="ClientApi.XrmEncoding.xmlEncode";e||Object(y.j)(t,"text");try{O.a.instance.reportCall(t);const n=Object(un.CrmXmlEncode)(e);return O.a.instance.reportSuccess(t),n}catch(e){throw C.a.getInstance().reportFailure(t,e),e}}xmlAttributeEncode(e){const t="ClientApi.XrmEncoding.xmlAttributeEncode";e||Object(y.j)(t,"text");try{O.a.instance.reportCall(t);const n=Object(un.CrmXmlAttributeEncode)(e);return O.a.instance.reportSuccess(t),n}catch(e){throw C.a.getInstance().reportFailure(t,e),e}}htmlEncode(e){const t="ClientApi.XrmEncoding.htmlEncode";try{if(O.a.instance.reportCall(t),!e)return O.a.instance.reportSuccess(t),e;const n=Object(un.CrmHtmlEncode)(e);return O.a.instance.reportSuccess(t),n}catch(e){throw C.a.getInstance().reportFailure(t,e),e}}htmlAttributeEncode(e){const t="ClientApi.XrmEncoding.htmlAttributeEncode";try{if(O.a.instance.reportCall(t),!e)return O.a.instance.reportSuccess(t),e;const n=Object(un.CrmHtmlAttributeEncode)(e);return O.a.instance.reportSuccess(t),n}catch(e){throw C.a.getInstance().reportFailure(t,e),e}}htmlDecode(e){const t="ClientApi.XrmEncoding.htmlDecode";try{if(O.a.instance.reportCall(t),!e)return O.a.instance.reportSuccess(t),e;const n=Object(un.CrmHtmlDecode)(e);return O.a.instance.reportSuccess(t),n}catch(e){throw C.a.getInstance().reportFailure(t,e),e}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let pn;function gn(e){return{type:"clientapi.create.xrm",sync:!0,execute(t,n){try{const r=new hn(t,e,n);return Object(a.a)(t,n,e,r),r}catch(e){throw C.a.getInstance().reportFailure("ClientApi.Xrm.createXrm",e),e}}}}class hn{constructor(e,t,n){pn=e,this._pageId=t,this._applicationContext=n,this._clientApiExecutor=new r.b(pn,"ClientApi.Xrm.",null,[{isEventParam:!0,name:"pageId",value:this._pageId}]),this._clientApiExecutor.execute("constructor",(e,t)=>{const n=Object(he.l)(pn.getState(),this._pageId);if(this._clientApiExecutor.addEventParameter({isEventParam:!0,name:"pageType",value:n}),!pn){const n=new Error("Xrm instance created with null store");this._clientApiExecutor.reportFailure(e,n,t)}})}get Mobile(){return this._clientApiExecutor.execute("Mobile",()=>(this._mobile||(this._mobile=new $t(pn,this._pageId)),this._mobile))}get Utility(){return this._clientApiExecutor.execute("Utility",()=>(this._utility||(this._navigation||(this._navigation=new _t(pn,this._applicationContext,this._globalContext,this._pageId)),this._utility=new Oe(pn,this._globalContext,this._applicationContext,this._navigation,this._pageId)),this._utility))}get Navigation(){return this._clientApiExecutor.execute("Navigation",()=>(this._navigation||(this._navigation=new _t(pn,this._applicationContext,this._globalContext,this._pageId)),this._navigation))}get Panel(){return this._clientApiExecutor.execute("Panel",()=>(this._panel||(this._panel=wt.getInstance(pn,this._applicationContext)),this._panel))}get Device(){return this._clientApiExecutor.execute("Device",()=>(this._device||(this._device=Z.getInstance(pn,this._applicationContext)),this._device))}get Page(){return this._clientApiExecutor.execute("Page_get",(e,t)=>{if(!this._page){this._page=new xe(pn,this._pageId),this._page.context=this._globalContext;const n=Object(he.l)(pn.getState(),this._pageId);if(n!==Ne.a.Dashboard&&n!==Ne.a.Grid&&n!==Ne.a.CustomControl){const n=new Error("Xrm.Page.get is called before or without calling set.");this._clientApiExecutor.reportFailure(e,n,t)}}return this._page})}set Page(e){this._clientApiExecutor.execute("Page_set",(t,n)=>{this._page&&U.a.getInstance().traceManager.getTracer(t).warn("Xrm.Page can only be initialized once.",n),this._page=e,this._page.context=this._globalContext},null,!1)}get Internal(){return this._clientApiExecutor.execute("Internal",()=>(this._internal||(this._internal=new qt.a(pn,this._applicationContext,this._globalContext,this._pageId)),this._internal))}get WebApi(){return this._clientApiExecutor.execute("WebApi",()=>(this._webApi||(this._webApi=new on(pn,this._pageId)),this._webApi))}get ExternalContext(){return this._clientApiExecutor.execute("ExternalContext",()=>(this._externalContext||(this._externalContext=new ln(pn,this._applicationContext)),this._externalContext))}get Constants(){return this._clientApiExecutor.execute("Constants",()=>(this._constants||(this._constants=Vt),this._constants))}get Reporting(){return this._clientApiExecutor.execute("Reporting",()=>(this._reporting||(this._reporting=C.a.getInstance(pn)),this._reporting))}get Diagnostics(){return this._clientApiExecutor.execute("Diagnostics",()=>(this._diagnostics||(this._diagnostics=Gt.getInstance(pn,this._applicationContext)),this._diagnostics))}get UI(){return this._clientApiExecutor.execute("UI",()=>(this._ui||(this._ui=we.getInstance(pn,this._applicationContext)),this._ui))}get NotificationLevel(){return this._clientApiExecutor.execute("NotificationLevel",()=>(this._notificationLevel||(this._notificationLevel=Rt),this._notificationLevel))}get Encoding(){return this._clientApiExecutor.execute("Encoding",()=>(this._encoding||(this._encoding=dn.getInstance(pn)),this._encoding))}get App(){return this._clientApiExecutor.execute("App",()=>(this._app||(this._app=Ee.a.getInstance(pn,this._applicationContext)),this._app))}get _globalContext(){return this._xrmGlobalContext||(this._xrmGlobalContext=new i.a(pn,this._pageId)),this._xrmGlobalContext}}},N6E8:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o}));
/**
 * Constants for the editform.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="editFormRoot",a="mainFormDialogRoot",i="parentrecord",o="tab-section"},N6Lu:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="update.orgwebresourcehash";function a(e){return{type:r,payload:e}}},N6mg:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("eXjw"),a=n("K7RF"),i=n("Uv1Y"),o=n("dUiZ"),s=n("/oKV"),c=n("iJGp");function l(){return{type:"quickCreateMenu.retrieve.async",execute({dispatch:e,getState:t},n){let l=s.a.LocalAndRemote;n.DataSource;const u=t(),d=Object(o.b)(u);return d===r.a.Initialized&&Object(a.e)(u,Object(o.a)(u).overallVersionNumber)&&(l=s.a.Remote),d===r.a.Uninitialized||l!==s.a.LocalAndRemote?(e(function(){const e={quickCreateMenu:{initialized:r.a.Initializing,quickCreateMenuItems:null}};return{type:a.a,payload:e}}()),e(function(e,t){return{type:"quickCreateMenu.retrieve.async",execute:({dispatch:e,getState:n},r)=>e(Object(a.b)("quickcreatemenu",null,null,null,!1,c.a.OnDemandWithoutContext,null,null,[],null,t)).catch(i.b)}}(0,l)).then(()=>Object(o.a)(t()))):Promise.resolve(Object(o.a)(t()))}}}},NA3N:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d}));var r=n("g73c"),a=n("c7Og"),i=n("504W"),o=n("bEud"),s=n("YhOF"),c=n("VJwX"),l=n("RIwK");function u(e){const t=new Sys.StringBuilder;for(const n of e)t.append("<a:KeyValuePairOfRelationshipQueryBaseX_PsK4FkN>"),t.append("<b:key>"),n.get_key().get_primaryEntityRole()!==o.a.unknown&&t.append("<a:PrimaryEntityRole>"+Object(c.a)(o.a,n.get_key().get_primaryEntityRole())+"</a:PrimaryEntityRole>"),t.append("<a:SchemaName>"+Object(l.b)(n.get_key().get_schemaName())+"</a:SchemaName>"),t.append("</b:key>"),t.append('<b:value i:type="a:FetchExpression"><a:Query>'+Object(l.b)(n.get_value())+"</a:Query></b:value>"),t.append("</a:KeyValuePairOfRelationshipQueryBaseX_PsK4FkN>");return t.toString()}function d(e){const t=e.selectNodes("a:KeyValuePairOfRelationshipQueryBaseX_PsK4FkN"),n=new Array(t.get_count());for(let e=0;e<t.get_count();e++){const c=t.get_item(e).selectSingleNode("b:key/a:SchemaName").get_innerText(),l=t.get_item(e).selectSingleNode("b:key/a:PrimaryEntityRole");let u=o.a.unknown;Object(i.a)(l)||(u=Object(r.a)(o.a,l.get_innerText()));const d=t.get_item(e).selectSingleNode("b:value/a:Query").get_innerText();n[e]=new a.a(new s.a(c,u),d)}return n}},NCQ1:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("XosO"),a=n("4or6"),i=/[xy]/g;t.EventNameAndTypeRegex=/^[a-zA-Z]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,t.EventNameDotRegex=/\./g,t.PropertyNameRegex=/^[a-zA-Z](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,t.StatsApiKey="a387cfcf60114a43a7699f9fbb49289e-9bceb9fe-1c06-460f-96c5-6a0b247358bc-7238";var o=null,s=null,c=null;function l(e){return"string"==typeof e}function u(e){return"number"==typeof e}function d(e){return"boolean"==typeof e}function p(e){return e instanceof Date}function g(e){return 1e4*(e+621355968e5)}function h(){return!("undefined"==typeof navigator||!navigator.product)&&"ReactNative"===navigator.product}function f(){return"object"==typeof self&&"ServiceWorkerGlobalScope"===self.constructor.name}function m(e){return e<10?"0"+e:e.toString()}function b(e){return null==e||""===e}t.numberToBondInt64=function(e){var t=new r.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},t.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(i,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},t.isString=l,t.isNumber=u,t.isBoolean=d,t.isDate=p,t.msToTicks=g,t.getTenantId=function(e){var t=e.indexOf("-");return t>-1?e.substring(0,t):""},t.isBeaconsSupported=function(){return null===o&&(o="undefined"!=typeof navigator&&Boolean(navigator.sendBeacon)),o},t.isUint8ArrayAvailable=function(){return null===s&&(s="undefined"!=typeof Uint8Array&&!function(){if("undefined"!=typeof navigator&&navigator.userAgent){var e=navigator.userAgent.toLowerCase();if((e.indexOf("safari")>=0||e.indexOf("firefox")>=0)&&e.indexOf("chrome")<0)return!0}return!1}()&&!h()),s},t.isPriority=function(e){return!(!u(e)||!(e>=1&&e<=3||5===e))},t.sanitizeProperty=function(e,n){return!t.PropertyNameRegex.test(e)||b(n)?null:(b(n.value)&&(n={value:n,type:a.AWTPropertyType.Unspecified}),n.type=function(e,t){switch(t=function(e){if(u(e)&&e>=0&&e<=4)return!0;return!1}(t)?t:a.AWTPropertyType.Unspecified){case a.AWTPropertyType.Unspecified:return function(e){switch(typeof e){case"string":return a.AWTPropertyType.String;case"boolean":return a.AWTPropertyType.Boolean;case"number":return a.AWTPropertyType.Double;case"object":return p(e)?a.AWTPropertyType.Date:null}return null}(e);case a.AWTPropertyType.String:return l(e)?t:null;case a.AWTPropertyType.Boolean:return d(e)?t:null;case a.AWTPropertyType.Date:return p(e)&&NaN!==e.getTime()?t:null;case a.AWTPropertyType.Int64:return u(e)&&e%1==0?t:null;case a.AWTPropertyType.Double:return u(e)?t:null}return null}(n.value,n.type),n.type?(p(n.value)&&(n.value=g(n.value.getTime())),n.pii>0&&n.cc>0?null:n.pii?function(e){if(u(e)&&e>=0&&e<=13)return!0;return!1}(n.pii)?n:null:n.cc?function(e){if(u(e)&&e>=0&&e<=1)return!0;return!1}(n.cc)?n:null:n):null)},t.getISOString=function(e){return e.getUTCFullYear()+"-"+m(e.getUTCMonth()+1)+"-"+m(e.getUTCDate())+"T"+m(e.getUTCHours())+":"+m(e.getUTCMinutes())+":"+m(e.getUTCSeconds())+"."+function(e){if(e<10)return"00"+e;if(e<100)return"0"+e;return e.toString()}(e.getUTCMilliseconds())+"Z"},t.useXDomainRequest=function(){if(null===c){var e=new XMLHttpRequest;c=void 0===e.withCredentials&&"undefined"!=typeof XDomainRequest}return c},t.useFetchRequest=function(){return h()||f()},t.isReactNative=h,t.isServiceWorkerGlobalScope=f},NM3A:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="userquery",a="savedquery"},NMtn:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"a",(function(){return d}));var r=n("504W"),a=n("Div0"),i=n("XjOj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t){if(null===e)throw Object(i.d)(a.a.framework,"ExceptionHelpers.ThrowOnNullArgument({0}, {1})",e,t),Error.argumentNull(t,"Argument can't be null")}function s(e,t){if(Object(r.a)(e))throw Object(i.d)(a.a.framework,"ExceptionHelpers.ThrowOnNullOrUndefinedArgument({0}, {1})",e,t),Error.argumentNull(t,"Argument can't be null or undefined")}function c(e,t){if(void 0===e)throw Object(i.d)(a.a.framework,"ExceptionHelpers.ThrowOnUndefinedArgument({0}, {1})",e,t),Error.argumentNull(t,"Argument can't be undefined")}function l(e,t){if(!e||!e.length)throw Object(i.d)(a.a.framework,"ExceptionHelpers.ThrowOnNullOrEmptyArgument({0}, {1})",e,t),Error.argumentNull(t,"Argument can't be null or empty")}function u(e,t,n,r){if(e<t||e>n)throw Object(i.d)(a.a.framework,"ExceptionHelpers.ThrowOnOutOfRange({0}, {1}, {2}, {3})",e,t,n,r),Error.argumentOutOfRange(r)}function d(e,t){if(!e)throw Object(i.d)(a.a.framework,"ExceptionHelpers.ThrowOnAssert({0})",t),Error.create("ExceptionHelpers.ThrowOnAssert("+t+")")}},NP1x:function(e,t,n){"use strict";n.d(t,"b",(function(){return g})),n.d(t,"d",(function(){return h})),n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return O}));var r=n("uNu9"),a=n("iZ7K"),i=n("NjDY"),o=n("3hnk"),s=n("Lyxw"),c=n("O7zD"),l=n("7XzV"),u=n("0l0t"),d=n("niX0"),p=n("+zjj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function g(e,t){const n=Object(a.h)(e,t),i=Object(d.c)(e).concat(Object(d.b)(e,t)),o={};if(n&&n.OneToManyRelationships){const e=Object.keys(n.OneToManyRelationships);for(let t=0;t<e.length;t++){const a=n.OneToManyRelationships[e[t]];if(a){if(a.ReferencingEntity===r.b&&!a.AssociatedMenuConfiguration.MenuId)continue;(a.IsCustomRelationship||v(a.AssociatedMenuConfiguration))&&(o[a.ReferencingEntity]=[])}}}if(n&&n.ManyToManyRelationships){const e=Object.keys(n.ManyToManyRelationships);for(let r=0;r<e.length;r++){const a=n.ManyToManyRelationships[e[r]];if(a){const{otherEntityLogicalName:e,otherEntityAssociatedMenuConfig:n}=y(a,t);if(!n.AvailableOffline)continue;(a.IsCustomRelationship||v(n))&&(o[e]=[])}}}return i&&i.forEach(e=>{o[e.entityName]=[]}),o}function h(e,t,n){const l=[],u=Object(a.h)(e,t);if(u&&u.OneToManyRelationships){const t=Object.keys(u.OneToManyRelationships);for(let d=0;d<t.length;d++){const g=u.OneToManyRelationships[t[d]];if(g){const t=g.AssociatedMenuConfiguration.Behavior!==c.f.DoNotDisplay;let d=t?p.a.Displayed_SetInRelationshipMetadata:p.a.NotDisplayed_SetInRelationshipMetadata;const h=Object(a.h)(e,g.ReferencingEntity);if(h){if(h.IsBPFEntity&&(d=p.a.NotDisplayed_IsBPFEntity,!n))continue;if(g.ReferencingEntity===r.Vb){const t=Object(i.x)(e),r=Object(s.b)(e,"SharePointS2S")&&u.IsDocumentManagementEnabled;if(!(Object(s.b)(e,"MSTeamsIntegration")&&t.isMSTeamsEnabled&&u.IsMSTeamsIntegrationEnabled)&&!r&&(d=p.a.NotDisplayed_SPDocumentNotConfigured,!n))continue}if(!g.IsCustomRelationship&&!v(g.AssociatedMenuConfiguration)&&(d=p.a.NotDisplayed_NotCustomOrConfigurableSystemRelationship,!n))continue;if(!Object(o.g)(e,h.EntityLogicalName,2,0)&&(d=p.a.NotDisplayed_NoReadPermissionOnRelatedEntity,!n))continue;const a=g.SchemaName;let c="";c=v(g.AssociatedMenuConfiguration)?g.AssociatedMenuConfiguration.MenuId:"nav_"+a;const{label:f,labelSource:m}=_(g.AssociatedMenuConfiguration,h),b=S(g.AssociatedMenuConfiguration.Group);l.push({areaId:b,id:c,entityName:g.ReferencingEntity,relationshipName:g.SchemaName,iconPath:"",title:f,labelSource:m,order:g.AssociatedMenuConfiguration.Order,show:t,relationshipType:0,displayStateReason:d})}}}}return l}function f(e,t,n){const i=[],s=Object(a.h)(e,t);if(s&&s.ManyToManyRelationships){const c=Object.keys(s.ManyToManyRelationships);for(let l=0;l<c.length;l++){const u=s.ManyToManyRelationships[c[l]];if(u){let c;const{otherEntityLogicalName:l,otherEntityAssociatedMenuConfig:d}=y(u,t),g=Object(a.h)(e,l);if(g){if(!s.IsKnowledgeManagementEnabled&&g.EntityLogicalName===r.fb&&(c=p.a.NotDisplayed_KnowledgeManagementNotEnabled,!n))continue;if(!u.IsCustomRelationship&&!v(d)&&(c=p.a.NotDisplayed_NotCustomOrConfigurableSystemRelationship,!n))continue;if(!Object(o.g)(e,g.EntityLogicalName,2,0)&&(c=p.a.NotDisplayed_NoReadPermissionOnRelatedEntity,!n))continue;if(i.push(b(u,g,d,1,c)),u.Entity1LogicalName===u.Entity2LogicalName){const e=u.Entity1AssociatedMenuConfiguration;(u.IsCustomRelationship||v(e))&&i.push(b(u,s,e,2,c))}}else{if(!n)continue;i.push(m(u,d,l))}}}}return i}function m(e,t,n){const r=e.SchemaName;return{areaId:S(t.Group),id:"nav_"+r,entityName:n,show:t.Behavior!==c.f.DoNotDisplay,displayStateReason:p.a.NotDisplayed_RelatedEntityMetadataNotAvailableInUnifiedClient}}function b(e,t,n,r,a){const i=e.SchemaName;let o="";o=v(n)?n.MenuId:"nav_"+i,e.Entity1LogicalName===e.Entity2LogicalName&&(o+=r.toString());const{label:s,labelSource:l}=_(n,t),u=S(n.Group),d=n.Behavior!==c.f.DoNotDisplay;return{areaId:u,id:o,entityName:t.EntityLogicalName,relationshipName:i,iconPath:"",title:s,labelSource:l,order:n.Order,show:d,ordinal:e.Entity1LogicalName===e.Entity2LogicalName?r:void 0,relationshipType:1,displayStateReason:a&&!Object(p.g)(a)?a:d?p.a.Displayed_SetInRelationshipMetadata:p.a.NotDisplayed_SetInRelationshipMetadata}}function _(e,t){const n=e.Behavior===c.f.UseLabel&&e.Label?p.b.RelationshipMetadata:t.DisplayCollectionName?p.b.EntityDisplayCollectionName:p.b.EntityDisplayName;return{label:n===p.b.RelationshipMetadata?e.Label:n===p.b.EntityDisplayCollectionName?t.DisplayCollectionName:t.DisplayName,labelSource:n}}function y(e,t){let n,r;return e.Entity1LogicalName!==t?(n=e.Entity1LogicalName,r=e.Entity1AssociatedMenuConfiguration):(n=e.Entity2LogicalName,r=e.Entity2AssociatedMenuConfiguration),{otherEntityLogicalName:n,otherEntityAssociatedMenuConfig:r}}function v(e){return e.IsCustomizable&&e.MenuId}function S(e){switch(e){case c.e.Details:return u.b;case c.e.Sales:return u.f;case c.e.Service:return u.g;case c.e.Marketing:return u.d;case c.e.InternetMarketing:return u.c;case c.e.Processes:return u.e;case c.e.Async:return u.a;default:return u.b}}function O(e){switch(e){case l.c:case l.b:return u.b;case l.h:return u.f;case l.i:return u.g;case l.e:return u.d;case l.d:return u.c;case l.g:case l.f:return u.e;case l.a:return u.a;default:return u.b}}},NUY7:function(e,t){
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},Nb1E:function(e,t,n){"use strict";n.d(t,"b",(function(){return S})),n.d(t,"d",(function(){return O})),n.d(t,"e",(function(){return C})),n.d(t,"f",(function(){return E})),n.d(t,"c",(function(){return I})),n.d(t,"a",(function(){return w}));var r=n("odYE"),a=n("eeMP"),i=n("FZDd"),o=n("f07+"),s=n("DRVD"),c=n.n(s),l=n("SZCI"),u=n("pEXn"),d=n("SAYH"),p=n("4r2D"),g=n("qAG9"),h=n("vSoM");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const f=c.a.createEvent("oDataCreate",l.w),m=c.a.createEvent("oDataRetrieve",l.w),b=c.a.createEvent("oDataRetrieveMultiple",l.w),_=c.a.createEvent("oDataUpdate",l.w),y=c.a.createEvent("oDataDelete",l.w),v=c.a.createEvent("oDataAssociate",l.w);function S(e,t){const n=[];return{type:"oData.create.async",execute({getState:r,dispatch:s},c){const l=f.startStopwatch(),g=new p.a(d.a.newGuid().guid);n.push({name:u.b.ClientRequestId,value:g&&g.RequestId?g.RequestId():null});const m=s(Object(i.f)(e,!1,[])).then(()=>{const n=Object(h.a)(r(),c,[e],"oData.create.async");if(n)return Promise.reject(n);const i=new o.b(e,t);return c.DataSource.executeOData(i,g).nativePromise().then(e=>Object(a.c)(e))});return m.then(()=>l(),()=>l()),m},getFailureParameters:(e,t)=>n}}function O(e,t,n,r=!1){const a=[],s="oData.retrieve.async";return{type:s,execute({getState:c,dispatch:l},f){const b=m.startStopwatch(),_=new p.a(d.a.newGuid().guid);a.push({name:u.b.ClientRequestId,value:_&&_.RequestId?_.RequestId():null});const y=l(Object(i.f)(e.etn,!1,[])).then(()=>{const a=Object(h.a)(c(),f,[e.etn],s);if(a)return Promise.reject(a);const i=new o.f(e.etn,e.id.guid,t,n,null,r);return f.DataSource.executeOData(i,_).nativePromise().then(e=>{const t=Object(g.a)(e.headers,"Content-Type");return t&&"application/octet-stream"===t?e.arrayBuffer():e.json()})});return y.then(()=>b(),()=>b()),y},getFailureParameters:(e,t)=>a}}function C(e,t,n){const r=[],a="oData.retrieveMultiple.async";return{type:a,execute({getState:s,dispatch:c},l){const g=b.startStopwatch(),f=new p.a(d.a.newGuid().guid);r.push({name:u.b.ClientRequestId,value:f&&f.RequestId?f.RequestId():null});const m=c(Object(i.f)(e,!1,[])).then(()=>{const r=Object(h.a)(s(),l,[e],a);if(r)return Promise.reject(r);const i=new o.f(e,null,t,null,n);return l.DataSource.executeOData(i,f).nativePromise().then(e=>e.json())});return m.then(()=>g(),()=>g()),m},getFailureParameters:(e,t)=>r}}function E(e,t,n,r,a){const s=[];return{type:"oData.update.async",execute({getState:c,dispatch:l},g){const f=_.startStopwatch(),m=new p.a(d.a.newGuid().guid);s.push({name:u.b.ClientRequestId,value:m&&m.RequestId?m.RequestId():null});const b=l(Object(i.f)(e.etn,!1,[])).then(()=>{const i=Object(h.a)(c(),g,[e.etn],"oData.update.async");if(i)return Promise.reject(i);const s=new o.g(e.etn,e.id.guid,t,n,r,a);return g.DataSource.executeOData(s,m).nativePromise().then(e=>e)});return b.then(()=>f(),()=>f()),b},getFailureParameters:(e,t)=>s}}function I(e,t){const n=[];return{type:"oData.delete.async",execute({getState:a,dispatch:s},c){const l=y.startStopwatch(),g=new p.a(d.a.newGuid().guid);n.push({name:u.b.ClientRequestId,value:g&&g.RequestId?g.RequestId():null});const f=s(Object(i.f)(e.etn,!1,[])).then(()=>{const n=Object(h.a)(a(),c,[e.etn],"oData.delete.async");if(n)return Promise.reject(n);const i=r.a.toLegacyEntityReference(e),s=r.a.legacyToExternalEntityReference(i),l=new o.c(s,t);return c.DataSource.executeOData(l,g).nativePromise().then(e=>null)});return f.then(()=>l(),()=>l()),f},getFailureParameters:(e,t)=>n}}function w(e,t,n){const a=[],s="oData.associate.async";return{type:s,execute({getState:c,dispatch:l},g){const f=v.startStopwatch(),m=new p.a(d.a.newGuid().guid);a.push({name:u.b.ClientRequestId,value:m&&m.RequestId?m.RequestId():null});const b={[e.etn]:[]};n.forEach(e=>{b[e.etn]=[]});const _=l(Object(i.e)(b)).then(()=>{const a=Object(h.a)(c(),g,Object.keys(b),s);if(a)return Promise.reject(a);const i=r.a.toLegacyEntityReference(e),l=r.a.legacyToExternalEntityReference(i),u=n.map(e=>{const t=r.a.toLegacyEntityReference(e);return r.a.legacyToExternalEntityReference(t)}),d=new o.a(l,t,u);return g.DataSource.executeOData(d,m).nativePromise().then(e=>null)});return _.then(()=>f(),()=>f()),_},getFailureParameters:(e,t)=>a}}},NjDY:function(e,t,n){"use strict";n.d(t,"d",(function(){return j})),n.d(t,"y",(function(){return l})),n.d(t,"v",(function(){return u})),n.d(t,"w",(function(){return d})),n.d(t,"x",(function(){return p})),n.d(t,"t",(function(){return h})),n.d(t,"a",(function(){return f})),n.d(t,"m",(function(){return m})),n.d(t,"k",(function(){return b})),n.d(t,"g",(function(){return _})),n.d(t,"f",(function(){return y})),n.d(t,"h",(function(){return v})),n.d(t,"s",(function(){return S})),n.d(t,"r",(function(){return O})),n.d(t,"o",(function(){return C})),n.d(t,"p",(function(){return E})),n.d(t,"q",(function(){return I})),n.d(t,"n",(function(){return R})),n.d(t,"l",(function(){return x})),n.d(t,"b",(function(){return w})),n.d(t,"D",(function(){return P})),n.d(t,"A",(function(){return T})),n.d(t,"e",(function(){return N})),n.d(t,"c",(function(){return g})),n.d(t,"i",(function(){return A})),n.d(t,"B",(function(){return D})),n.d(t,"z",(function(){return M})),n.d(t,"u",(function(){return F})),n.d(t,"j",(function(){return k})),n.d(t,"C",(function(){return L}));var r=n("eXjw"),a=n("NvOS"),i=n("YxC/"),o=n("eq9I"),s=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let c;function l(e){return e.organization}function u(e){const t=l(e);return t?t.initialized:r.a.Uninitialized}function d(e){return u(e)!==r.a.Initialized?null:e.organization.organizationName}function p(e){const t=l(e);return null==t?void 0:t.organizationSettings}function g(e){const t=p(e);return!!t&&!!t.allowLegacyDialogsEmbedding}function h(e){const t=p(e);return null!=t&&(c=Object(a.a)(e,"/"+t.webResourceHash+"/webresources/")),c}function f(e,t){const n=/^\$webresource:/i;if(t){let r=t.replace(n,"");return r=(r.startsWith("/")?"":e)+r,r}return""}function m(e){const t=p(e);return null!=t&&t.isMocaOfflineFeatureEnabled}function b(e){const t=p(e);return null!=t&&t.isConflictDetectionEnabledForMobileClient}function _(e){const t={};return e.organization.organizationSettings.enabledLanguages.map(n=>{const r=String.format(o.k,n);t[n]=Object(i.b)(e,r)}),t[0]=Object(i.b)(e,o.a),t[-1]=Object(i.b)(e,o.c),t}function y(e){const t=[],n=p(e);return n&&n.enabledLanguages&&n.enabledLanguages.map(n=>{const r=String.format(o.k,n),a={localeId:n,label:Object(i.b)(e,r)};t.push(a)}),t}function v(e){const t=p(e);return Object(s.a)(t)?null:t.fullNameConventionCode}function S(e){const t=p(e);return null!=t?t.norsyncServerConnectionString:""}function O(e){const t=p(e);return null!=t&&t.isTrialOrganization}function C(e){const t=p(e);return null!=t&&t.isPreviewOrganization}function E(e){const t=p(e);return null!=t&&t.isSandboxOrganization}function I(e){const t=p(e);return null!=t&&t.isSovereignCloud}function w(e){const t=p(e);return null!=t?t.advancedDebuggabilitySettings:""}function j(e){const t=p(e);return t&&t.currentThemeData?t.currentThemeData:""}function P(e){const t=p(e);return t?t.officePortalUrl:""}function T(e){const t=p(e);return t?t.ppacSettingsUrl:""}function N(e){const t=p(e);return t?t.customizationUrl:""}function A(e){const t=p(e);if(t&&t.globalHelpUrlEnabled&&t.globalHelpUrl)return t.globalHelpUrl}function D(e){const t=p(e);return t&&t.privacyStatementUrl?t.privacyStatementUrl:""}function R(e){const t=p(e);if(t)return!!t.newSearchExperienceEnabled}function x(e){const t=p(e);if(t)return!!t.improveSearchLoggingEnabled}function M(e){const t=l(e);return t&&t.organizationTenant}function F(e){const t=p(e);return t&&t.geoName}function k(e){const t=F(e);return"CHN"===(t&&t.toUpperCase())}function L(e){const t=p(e);return t&&t.useQuickFindViewForGridSearch}},"Nk+G":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the CustomControl page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Control"},Nnen:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("VJBm");class a extends r.a{constructor(e){super(e),this.set_dataAccessLayer(e)}create(e,t){this.get_dataAccessLayer().create(e,t)}retrieve(e,t){return this.get_dataAccessLayer().retrieve(e,t)}update(e,t){this.get_dataAccessLayer().update(e,t)}Delete(e,t){this.get_dataAccessLayer().Delete(e,t)}begin(e){this.get_dataAccessLayer().begin(e)}Commit(e){return this.get_dataAccessLayer().Commit(e)}}},NvOS:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("IqkD"),a=n("NjDY");function i(e,t){const n=Object(r.w)(e);let i=!1;n&&(i=n.usePathBasedUrls);const o=Object(a.x)(e);return i&&o&&o.organizationUniqueName?"/"+o.organizationUniqueName+t:t}},NwjZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r,a=n("CGM5"),i=n("UR8A"),o=n("j6Db"),s=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=o.a+".Primitive.FontIcon",l=function(e){function t(t){var n=e.call(this,t)||this;if(t&&void 0===t.type){var r=Error("FontIcon type property cannot be null");i.b.Reporting.reportFailure(c,r)}return n}return s(t,e),t.prototype.getElementName=function(){return"span"},t.prototype.getElementClassName=function(){var e=this.props.styles?" "+this.props.styles:"";return this.getSymbolClassName(this.props.type)+e},t.displayName="FontIcon",t}(a.a)},Nzmy:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("pEXn");let a;function i(e){a=e}function o(e,t){t.get_message()&&e.push({name:r.b.ErrorMessage,value:t.get_message()}),t.get_request()&&t.get_request().status&&e.push({name:r.b.RequestStatus,value:t.get_request().status})}function s(e){return e&&e.length>0&&e[0]&&e[0].urlParameters?e[0].urlParameters:""}},O4uv:function(e,t,n){"use strict";n.d(t,"d",(function(){return g})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return h})),n.d(t,"a",(function(){return d}));var r=n("SAYH"),a=n("FZDd"),i=n("iZ7K"),o=n("uIhY"),s=n("5Oca"),c=n("Rckk"),l=n("g22U"),u=n("Er26");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d="ReturnRowVersion";function p(e,t,n,r=!0,a){const o={urlParameters:""+Object(i.o)(e,t),body:JSON.stringify(n),additionalHeaders:{[c.c.ACCEPT]:c.d.APPLICATION_JSON,[c.c.MSCRM_SUPPRESS_DUPLICATION_DETECTION]:r.toString()},method:"POST",additionalParameters:{[l.a.TYPE]:l.c.CREATE,[l.a.SUB_TYPE]:l.b.Create,[u.b]:t}};return a&&(o.additionalHeaders[d]="true"),o}function g(e){return{type:"SERIALIZE_CREATE_REQUEST_ASYNC",execute({dispatch:t,getState:n},a){const s=e.get_target();return t(h(s)).then(()=>{const t=s.get_identifier(),a=n(),c=t.get_identifier();let l;try{l=Object(o.b)(a,s)}catch(e){return{serializationFailure:e.message}}const u=e.get_suppressDuplicateDetection();if(!r.a.isNullOrEmpty(new r.a(c))){l[Object(i.h)(a,t.get_modelType()).PrimaryKeyName]=c}return p(a,t.LogicalName,l,u,e.get_returnRowVersion())})}}}function h(e){return{type:"REQUEST_ADDITIONAL_METADATA_FOR_ENTITY_RECORD",execute({dispatch:t,getState:n},r){const i=Object(s.c)(n(),e);return t(Object(a.f)(e.get_identifier().LogicalName,!1,i)).then(()=>{let r=0;const i=Object(s.w)(n(),e).reduce((e,t)=>(e[t]=[],r++,e),{});return r?t(Object(a.e)(i)):Promise.resolve()})}}}},O7zD:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return p})),n.d(t,"f",(function(){return f})),n.d(t,"e",(function(){return m})),n.d(t,"g",(function(){return g})),n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return h}));var r=n("i1f0"),a=n("y60j"),i=n("arV0"),o=n("YxC/"),s=n("iZ7K"),c=n("KBcj"),l=n("jq7Z");function u(e,t,n,c){const u=Object(o.b)(n,"MenuItem_Label_AddObject"),d=Object(s.h)(n,t);if(d){const o=Object(r.F)(n,{id:e,controlName:d.PrimaryNameAttribute},c),s=Object(l.b)(n,e,c),p=d.DisplayName,g=Object(a.m)(n,t,s),h=g?g.name+": ":"",f=p&&u?String.format(u,p):"",m=Object(r.Yb)(n,e,c),b=p?p+": "+h:"",{id:_}=Object(i.g)(n,e);return b+Object(r.ob)(_,o,f,m)}}function d(e,t,n){if(e)return e+"_url";if(t&&n){const e=Object(s.h)(t,n);if(e&&e.PrimaryImageAttribute)return e.PrimaryImageAttribute+"_url"}return null}function p(e,t,n,a,i){let o,l="";const u=Object(s.h)(n,t);u&&(l+=u.DisplayName,o=Object(r.F)(n,{id:e,controlName:u.PrimaryNameAttribute},i));const d=Object(c.c)(n,a);return d&&d.title&&(l?l+=": "+d.title:l=d.title),o&&(l?l+=": "+o:l=o),l}function g(e,t){return t?`${e}_${t}`:e}function h(e,t){return`${e}+${t}`}var f,m;!function(e){e[e.UseCollectionName=0]="UseCollectionName",e[e.UseLabel=1]="UseLabel",e[e.DoNotDisplay=2]="DoNotDisplay"}(f||(f={})),function(e){e[e.Details=0]="Details",e[e.Sales=1]="Sales",e[e.Service=2]="Service",e[e.Marketing=3]="Marketing",e[e.InternetMarketing=4]="InternetMarketing",e[e.Processes=5]="Processes",e[e.Async=6]="Async"}(m||(m={}))},OBdv:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("jZCH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){let t=null,n=null;t=r.a.get_DefaultInstance().get_UserContext().get_UserSettings().get_languageId().toString(),n=r.a.get_DefaultInstance().get_UserContext().get_organizationSettings().get_languageCode().toString();const a={};for(let t=0,n=e.childNodes.length;t<n;t++){const n=e.childNodes[t];if("a:UserLocalizedLabel"===n.nodeName&&i(a,n),"a:LocalizedLabels"===n.nodeName)for(let e=0,t=n.childNodes.length;e<t;e++)i(a,n.childNodes[e])}return t in a?a[t]:n in a?a[n]:null}function i(e,t){let n=null,r=null;for(let e=0,a=t.childNodes.length;e<a;e++){const a=t.childNodes[e];"a:LanguageCode"===a.nodeName&&(n=a.firstChild.nodeValue),"a:Label"===a.nodeName&&a.firstChild&&(r=a.firstChild.nodeValue)}return e[n]=r,n}},OEF1:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return e.session.hostSubtype}function a(e){return e.session.hostType}function i(e){return e.session.hostData?e.session.hostData:[]}function o(e,t){const n=e.session.hostData;let r;return n&&(r=n.find(e=>e.key===t)),r}function s(e){return e.session.hostOptionInitialized}n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s}))},OEUm:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s}));class r{constructor(){this._enabledForSession=!1,this._enabledForSession=this._readEnabledFormStorage(),this._enabledForSession&&this.toggleForNextSession(!1)}static getInstance(){return this._instance||(this._instance=new r),this._instance}enabledForCurrentSession(){return this._enabledForSession}enabledForNextSession(){return this._readEnabledFormStorage()}toggleForNextSession(e){try{localStorage.setItem("DeveloperToolsSwitch",e.toString())}catch(e){}}_readEnabledFormStorage(){try{return"true"===localStorage.getItem("DeveloperToolsSwitch")}catch(e){return!1}}}function a(){return r.getInstance().enabledForCurrentSession()}function i(){return r.getInstance().enabledForNextSession()}function o(){r.getInstance().toggleForNextSession(!0)}function s(e){r.getInstance().toggleForNextSession(e)}},OKVy:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the Dashboard page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Dashboard"},OPfb:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r,a=n("nuS9"),i=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=function(e){function t(t){var n=e.call(this,t)||this;return n.state={portals:new Map},n}return i(t,e),t.prototype.bindDOMElement=function(e,t,n,r){if(!t.isRemoveChildPatched){var a=t.removeChild,i=this.props.onError;t.removeChild=function(){try{return a.apply(this,arguments)}catch(e){if(i&&i(e),"NotFoundError"!==e.name&&"HierarchyRequestError"!==e.name)throw e}},t.isRemoveChildPatched=!0}this.setState((function(r){var a=new Map(r.portals);return a.set(t,{element:e,id:n}),{portals:a}}),r)},t.prototype.unbindDOMComponent=function(e,t){this.setState((function(t){var n=new Map(t.portals);return n.forEach((function(t,r){t.id===e&&n.delete(r)})),{portals:n}}),t)},t.prototype.componentDidCatch=function(e){if("Failed to execute 'removeChild' on 'Node': The node to be removed is not a child of this node."!==e.message)throw e},t.prototype.render=function(){var e=this,t=[];return this.state.portals.forEach((function(n,r){t.push(e.props.renderReactSubtree(n.element,r))})),t},t}(a.Component)},OQLa:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return u}));var r=n("pF61"),a=n("arV0"),i=n("9eA9"),o=n("NvOS");function s(e,t){return{type:"clientapi.create.page.url",sync:!0,execute:(n,r)=>r.Router.createUrlForPage(e,t)}}function c(e,t){return{type:"clientapi.create.mobile.page.url",sync:!0,execute:(n,r)=>r.Router.createMobileClientUrlForPage(e,t)}}function l(e,t,n){return{type:"clientapi.create.web.page.url",sync:!0,execute:(r,a)=>a.Router.createWebUrlForPage(e,t,n)}}function u(){return{type:"clientapi.get.current.page.search.params",sync:!0,execute(e,t){const n=e.getState(),s=Object(o.a)(n,""),c=Object(r.c)(n),u=Object(a.l)(n,c),d=Object(a.g)(n,c),p=e.dispatch(l(s,u,d));return new i.a(p).searchParams.toString()}}}},ORLm:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return e.appShellState.globalSearchState}function a(e){return r(e).indexReady}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},ORpD:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return s}));var r=n("gNtT"),a=n("qJCH"),i=n("tHOi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="userAccessibilitySettings.set";function s(e){return{type:o,payload:e}}function c(e){return{type:"userAccessibilitySettings.save",execute({dispatch:t}){t(s(e));const n=a.a.createFromObjectData({key:r.b,personalization:e});return t(Object(i.a)(n))}}}},OcZc:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("FZDd"),a=n("iZ7K"),i=n("LbMF"),o=n("x0oY"),s=n("7O3c");function c(e){return e&&e["@odata.type"]?e["@odata.type"].split(".").pop():null}function l(e,t,n){if(!e||!t||!n)return null;const r=Object(a.h)(e,t),s=Object(i.d)(e,t);return Object(o.d)(e,n,r,s)}function u(e,t){return{type:"DESERIALIZE_RETRIEVE_PROCESS_CONTROL_DATA_RESPONSE_ASYNC",execute:({dispatch:t,getState:n},a)=>e.json().then(e=>{if(!e)throw new Error("Empty response is returned for RetrieveProcessControlData");const a=e.GlobalNavigationData,i=e.Entity,u=e.BpfDefinitionVersionNumber?e.BpfDefinitionVersionNumber.toString():null,d={},p=c(a),g=c(i);return p&&(d[p]=Object(o.h)(a)),g&&(d[g]=Object(o.h)(i)),t(Object(r.e)(d)).then(()=>{const e=n();return new s.a(l(e,g,i),l(e,p,a),u)})})}}},OiiO:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("M0zh");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t=!1){return{type:"commanding.initializescriptcontainer.async",execute:({dispatch:n,getState:r},a)=>a.ScriptManager.initializeContainerForClientApi(e,!t)}}function i(e,t){const n={createdScriptContainer:e};return{type:r.o,payload:n,meta:{commandManagerId:t}}}},OirV:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unknown=0]="Unknown",e[e.MSACID=1]="MSACID",e[e.MSAPUID=2]="MSAPUID",e[e.ANID=3]="ANID",e[e.OrgIdCID=4]="OrgIdCID",e[e.OrgIdPUID=5]="OrgIdPUID",e[e.UserObjectId=6]="UserObjectId",e[e.Skype=7]="Skype",e[e.Yammer=8]="Yammer",e[e.EmailAddress=9]="EmailAddress",e[e.PhoneNumber=10]="PhoneNumber",e[e.SipAddress=11]="SipAddress",e[e.MUID=12]="MUID"}(t.AWTUserIdType||(t.AWTUserIdType={})),function(e){e[e.Started=0]="Started",e[e.Ended=1]="Ended"}(t.AWTSessionState||(t.AWTSessionState={}))},OmkB:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("oT5e"),a=n("zsAz"),i=n("+nTZ"),o=n("tFCh");function s(e,t){return{type:"router.close.popup.async",execute({dispatch:n,getState:s},c){const l=c.Router.getPopup(e);if(l){const c=Object(r.b)(s(),e);if(!c)throw Object(a.d)("Browsingcontext does not exist for pageId",2415919107,[{name:"pageId",value:e}]);const u=Object(i.b)(s(),e);if(!u)throw Object(a.d)("dialogContext does not exist for pageId",2415919107);t&&l.closeHandler&&l.closeHandler(),n(Object(o.c)(u.dialogContextId,e,c.id))}return Promise.resolve()}}}},OpjU:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="isReauthInProgress.set";function a(e){return{type:r,payload:{isReauthInProgress:e}}}},OtHk:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return h})),n.d(t,"a",(function(){return f})),n.d(t,"h",(function(){return m})),n.d(t,"g",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"e",(function(){return g})),n.d(t,"i",(function(){return b}));var r=n("SAYH"),a=n("eXjw"),i=n("y60j"),o=n("AF/G"),s=n("iZ7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c=["95f2e667-95c3-e611-80d6-00155db7dbc8"];function l(e,t,n,r){return e&&e.metadata?n&&e.metadata.dashboardsByNavPath?e.metadata.dashboardsByNavPath[n]:t&&e.metadata.dashboards?e.metadata.dashboards[t.guid]:r&&e.metadata.dashboardsByEntityName?e.metadata.dashboardsByEntityName[r]:null:null}function u(e){return e&&e.metadata&&e.metadata.dashboardSelectors?e.metadata.dashboardSelectors:null}function d(e,t){return e&&e.metadata&&e.metadata.dashboardSelectorsByEntityName&&t?e.metadata.dashboardSelectorsByEntityName[t]:null}function p(e,t){const n=g(e,t),a=d(e,t);return a?a[r.a.toString(n)]:null}function g(e,t){return e&&e.metadata&&e.metadata.dashboardsByEntityName&&e.metadata.dashboardsByEntityName[t]?e.metadata.dashboardsByEntityName[t].FormId:null}function h(e,t,n,r){const i=l(e,t,n,r);return i?i.Initialized:a.a.Uninitialized}function f(e,t){const n=Object(i.j)(e,t);return n&&n.TabAttributes&&n.TabAttributes.PrimaryEntity}function m(e,t){const n=Object(i.j)(e,t),a={};if(n&&n.Controls)for(const t in n.Controls){const i=n.Controls[t];if(i.ClassId&&i.ClassId.guid&&r.a.equals(i.ClassId,o.mb)){const t=i.Parameters&&i.Parameters[0]&&i.Parameters[0].StreamObjects&&i.Parameters[0].StreamObjects.StreamObjectCollection;if(t)for(const n of t)if(0===n.Type||2===n.Type){const t=Object(s.h)(e,n.LogicalEntityName),r=t&&t.ObjectTypeCode;a[n.LogicalEntityName]=null!=r?r.toString():"0"}}}return a}function b(e){return-1!==c.indexOf(r.a.toString(e))}},OwbH:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("UDbe");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a{constructor(e){this._searchFields=null,this._searchFields=e||[]}get_queryFields(){return this._searchFields}get_field(){return this.get_queryFields()[0]}isSatisfiedByRecord(e,t){const n=this.get_field().get_path()===r.a.get_id().get_path()?e:this.get_field().getField(t);return this.testCondition(n)}isSatisfiedBy(e){const t=e[this.get_field().get_path()];return this.testCondition(t)}}},Oz8S:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l}));var r=n("2jAf");const a=[r.b,r.a],i={};function o(e=i,t){return-1!==a.indexOf(t.type)&&t&&t.payload&&t.payload.entities?t.type===r.a?l(e,t.payload.entities):c(e,t.payload.entities):e}function s(e=i,t){return-1!==a.indexOf(t.type)&&t&&t.payload&&t.payload.ribbons?t.type===r.a?l(e,t.payload.ribbons):c(e,t.payload.ribbons):e}function c(e,t){if(0===Object.keys(t).length)return e;const n=Object.assign({},e);for(const e in t)n[e]=Object.freeze(t[e]);return Object.freeze(n)}function l(e,t){if(0===Object.keys(t).length)return e;const n={};for(const r in e)void 0===t[r]&&(n[r]=e[r]);return Object.freeze(n)}},"P+kM":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="dataSnapshot.setLock";function a(e,t,n){return{type:r,payload:t,meta:{snapshotId:e,selectedFields:n}}}},"P+p9":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}));var r=n("Ua4i");const a="clear.globalNotificationAction";function i(e){return{type:"clear.globalNotificationAction.async",execute({dispatch:t,getState:n}){const r={type:a,payload:e};return Promise.resolve(t(r))}}}function o(e){return{type:"clear.clearGlobalNotificationAndExecuteHandler.async",execute({dispatch:t,getState:n}){const a=Object(r.a)(n(),e);return t(i(e)).then(()=>{a.props.onCloseHandler&&a.props.onCloseHandler()})}}}},P4TJ:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="set.apphostclient.initialized",a="set.apphostclient.initialize.error",i="set.apphostclientbundle.loaded"},P68g:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){return e?Object.keys(e).reduce((n,r)=>(n[r]=t(e[r]),n),{}):null}n.d(t,"a",(function(){return r}))},P6DH:function(e,t,n){"use strict";n.d(t,"a",(function(){return W})),n.d(t,"i",(function(){return k})),n.d(t,"f",(function(){return L})),n.d(t,"h",(function(){return B})),n.d(t,"e",(function(){return U})),n.d(t,"g",(function(){return V})),n.d(t,"b",(function(){return z})),n.d(t,"c",(function(){return q})),n.d(t,"d",(function(){return H})),n.d(t,"v",(function(){return G})),n.d(t,"x",(function(){return K})),n.d(t,"X",(function(){return Q})),n.d(t,"S",(function(){return X})),n.d(t,"bb",(function(){return ze})),n.d(t,"D",(function(){return Y})),n.d(t,"H",(function(){return ne})),n.d(t,"T",(function(){return J})),n.d(t,"r",(function(){return Z})),n.d(t,"cb",(function(){return se})),n.d(t,"P",(function(){return le})),n.d(t,"M",(function(){return ue})),n.d(t,"K",(function(){return de})),n.d(t,"L",(function(){return pe})),n.d(t,"J",(function(){return ge})),n.d(t,"fb",(function(){return me})),n.d(t,"Q",(function(){return be})),n.d(t,"N",(function(){return _e})),n.d(t,"I",(function(){return ye})),n.d(t,"j",(function(){return Oe})),n.d(t,"k",(function(){return Ce})),n.d(t,"l",(function(){return Ee})),n.d(t,"U",(function(){return Ie})),n.d(t,"n",(function(){return Pe})),n.d(t,"jb",(function(){return oe})),n.d(t,"ab",(function(){return Te})),n.d(t,"W",(function(){return Ne})),n.d(t,"E",(function(){return fe})),n.d(t,"hb",(function(){return Re})),n.d(t,"mb",(function(){return De})),n.d(t,"F",(function(){return Ae})),n.d(t,"R",(function(){return ke})),n.d(t,"ob",(function(){return Me})),n.d(t,"pb",(function(){return Fe})),n.d(t,"G",(function(){return re})),n.d(t,"C",(function(){return ae})),n.d(t,"kb",(function(){return ie})),n.d(t,"A",(function(){return ce})),n.d(t,"Y",(function(){return ve})),n.d(t,"sb",(function(){return Ue})),n.d(t,"t",(function(){return Le})),n.d(t,"u",(function(){return Be})),n.d(t,"w",(function(){return $})),n.d(t,"gb",(function(){return We})),n.d(t,"vb",(function(){return Ve})),n.d(t,"q",(function(){return qe})),n.d(t,"B",(function(){return Ge})),n.d(t,"m",(function(){return Ke})),n.d(t,"Z",(function(){return Xe})),n.d(t,"ib",(function(){return te})),n.d(t,"s",(function(){return ee})),n.d(t,"p",(function(){return He})),n.d(t,"nb",(function(){return Je})),n.d(t,"db",(function(){return $e})),n.d(t,"lb",(function(){return Ye})),n.d(t,"xb",(function(){return Se})),n.d(t,"z",(function(){return Ze})),n.d(t,"y",(function(){return et})),n.d(t,"O",(function(){return he})),n.d(t,"V",(function(){return we})),n.d(t,"wb",(function(){return je})),n.d(t,"o",(function(){return tt})),n.d(t,"rb",(function(){return nt})),n.d(t,"qb",(function(){return xe})),n.d(t,"eb",(function(){return rt})),n.d(t,"tb",(function(){return at})),n.d(t,"ub",(function(){return Qe}));var r,a=n("SAYH"),i=n("eXjw"),o=n("arV0"),s=n("KBcj"),c=n("Z/4N"),l=n("3hnk"),u=n("CngE"),d=n("5Oca"),p=n("LbMF"),g=n("d0w6"),h=n("vmcK"),f=n("S2mk"),m=n("YxC/"),b=n("dHD5"),_=n("jRy5"),y=n("BFlg"),v=n("iZ7K"),S=n("E5IU"),O=n("IqkD"),C=n("9fGf"),E=n("BzGi"),I=n("69Qu"),w=n("3/02"),j=n("Lyxw"),P=n("jAuy"),T=n("whN/"),N=n("sZ+8"),A=n("NM3A"),D=n("VcAV"),R=n("i1f0");!function(e){e[e.None=0]="None",e[e.CommunicationActivity=1]="CommunicationActivity"}(r||(r={}));var x=n("qLnS"),M=n("zmL5"),F=n("jq7Z");const k="task",L="fax",B="phonecall",U="email",V="letter",z="appointment",W=y.a,q="HierarchyDataChildCount6dcd9e4c001441b09237d51a34853d55",H="CountChildren";function G(e,t,n){const r=Object(F.a)(e,t);if(!(e&&t&&r))return null;const a=Object(b.v)(n),i=r;return i&&i.datasets&&i.datasets[a]?i.datasets[a]:null}function K(e,t,n){const r=G(e,t,n);return r?r.pageNumber:null}function Q(e,t,n){const r=G(e,t,n);return!!r&&r.isNewPageRequested}function X(e,t,n){const r=J(e,t.id,n);return r?xe(e,r,t.id):null}function Y(e,t,n){const r=[],a=be(e,t.id,n);if(a){const t=Object(p.d)(e,a);if(t)for(const e of Object.keys(t)){const n=t[e];r.push(n.LogicalName)}}else{const a=X(e,t,n);a&&a.grid&&a.grid.rows&&a.grid.rows.forEach(e=>{e.cells&&a.grid.rows[0].cells.forEach(e=>{e.name&&r.push(e.name)})})}return r}function J(e,t,n,r){const a=G(e,t,n);return a&&a.viewId}function $(e,t,n){const r=G(e,t,n);return r&&r.commandManagerId}function Z(e,t,n,r){const s=G(e,t,n);let c=s&&s.visualizationId;const l=Object(o.g)(e,t);return!c&&l.visualizationId&&(c=l.visualizationId),c||(c=Object(u.j)(e,r)),c||Object(u.h)(e,r)!==i.a.Initialized||(c=a.a.EMPTY),c}function ee(e,t,n){const r=G(e,t,n);let a=r&&r.chartVisualizationType;return a||(a=E.a.savedvisualization),a}function te(e,t,n){const r=G(e,t,n);return!(!r||!r.showChart)}function ne(e,t,n){const r=J(e,n.id,t);if(r){const a=[],i=xe(e,r,n.id);if(i&&i.grid){const r=i.grid.rows[0].cells;for(const e in r)r.hasOwnProperty(e)&&a.push(r[e].name);const o=G(e,n.id,t);if(o){const t=o.queryKey,n=o.pageNumber;if(t&&n)return Object(d.q)(e,t,n,a)}}}return[]}function re(e,t,n){if(!n){const{entityTypeName:r}=Object(o.g)(e,t.id);n=r}return Object(d.g)(e,n)}function ae(e,t,n){if(t){const r=G(e,t,n);if(r&&r.filters)return r.filters}return null}function ie(e,t,n){if(Object(I.b)(e)&&t){const r=G(e,t,n);if(r&&r.useRollupView)return r.useRollupView}return!1}function oe(e,t,n){const r=se(e,t,n),a=Object(d.n)(e,r);return a?a.totalRecordCountLimitExceeded:null}function se(e,t,n){const r=G(e,n.id,t);return r&&r.queryKey?r.queryKey:null}function ce(e,t,n){const r=G(e,n.id,t);return r&&r.fetchXml?r.fetchXml:null}function le(e,t,n){const r=G(e,n.id,t);return r&&r.rowProperties?r.rowProperties:null}function ue(e,t,n,r){const a=he(e,t,n,r);if(a&&null!==a.requiredLevel)return a.requiredLevel;if(n.entityTypeName){const t=Object(p.d)(e,n.entityTypeName);if(t&&t[r])return t[r].RequiredLevel}return 0}function de(e,t,n,r,a){let i=!1;if(n&&n.entityTypeName){let o=n.entityTypeName;const s=Object(p.d)(e,o);let c=s&&s[r];if(!c&&Object(v.r)(e,o)){o=W;const t=Object(p.d)(e,W);c=t&&t[r]}if(c&&c.IsValidForUpdate){const t=Object(l.f)(e,o,r,x.a.CanUpdate,a),n=Object(l.g)(e,o,3,0);i=t&&n}if(i){const a=he(e,t,n,r);i=!a||!a.isDisabled}}return i}function pe(e,t,n,r){const a=he(e,t,n,r);return a&&a.notifications?a.notifications:null}function ge(e,t,n,r){const a=pe(e,t,n,r);if(a){const e=Object.keys(a);if(e&&e.length&&a[e[0]].messages&&a[e[0]].messages.length)return a[e[0]].messages[0]}return null}function he(e,t,n,r){if(!e||!n||!r)return null;if(t&&n.recordId&&n.parentContextToken){const i=G(e,t,n.parentContextToken);if(i&&i.rowProperties&&i.rowProperties.records){const e=i.rowProperties.records.filter(e=>Object.keys(e)[0]===a.a.toString(n.recordId));if(e&&e.length>0&&e[0][a.a.toString(n.recordId)]){const t=e[0][a.a.toString(n.recordId)].filter(e=>Object.keys(e)[0]===r);if(t&&t.length>0&&t[0][r])return t[0][r]}}}return null}function fe(e,t){return t&&t.entityLogicalName?Object(p.d)(e,t.entityLogicalName):null}function me(e,t,n){const r=G(e,t,n);if(r)return r.selectedRows}function be(e,t,n){const r=G(e,t,n);if(r)return r.selectedRelatedEntity}function _e(e,t,n){const r=G(e,t,n);return r?r.refreshCounter:0}function ye(e,t,n){const r=G(e,t,n);return r?r.pagingRefreshInput:0}function ve(e,t,n){const r=G(e,t,n);if(r)return r.pagingData}function Se(e,t,n){return!(!Object(j.c)(e,w.O)||!Object(P.g)(t,n))}function Oe(e=null){let t=null,n=null,r=null,i=null,s=!1;return(c,l,u)=>{const d=h.a,p=Object(o.g)(c,l),g=null==p?void 0:p.entityTypeName,m=!(!te(c,l,u)&&!(null==p?void 0:p.showChart)),b=e||J(c,l,u),_=Object(C.b)(c);if(!(c&&c.metadata&&g&&d&&b&&b.guid))return null;const y=Object(F.a)(c,l);if(y&&y.pageViewConfigurations&&y.pageViewConfigurations[b.guid]&&y.pageViewConfigurations[b.guid].CustomControls&&y.pageViewConfigurations[b.guid].CustomControls[_])return y.pageViewConfigurations[b.guid];if(y&&y.gridConfigurations&&y.gridConfigurations[g]&&y.gridConfigurations[g][d]&&y.gridConfigurations[g][d].CustomControls&&y.gridConfigurations[g][d].CustomControls[_]){return y.gridConfigurations[g][d]}if(c.metadata.views[b.guid]&&c.metadata.views[b.guid].grid&&c.metadata.views[b.guid].grid.customControlDescriptions){const e=c.metadata.views[b.guid].grid.customControlDescriptions;if(y&&y.pageViewConfigurations&&null===y.pageViewConfigurations[b.guid]);else if(e&&e.CustomControls&&e.CustomControls[_])return e}const v=c.metadata.homePageConfigurations;if(v&&v[g]&&v[g][d]&&v[g][d].CustomControls&&v[g][d].CustomControls[_]&&!Se(c,v[g][d].CustomControls[_],_))return v[g][d];if(n!==d||r!==g||!a.a.equals(i,b)||s!==m){n=d,r=g,i=b,s=m;const e=m?Object(f.v)(d,g,a.a.toString(b)):Object(f.u)(d,g,a.a.toString(b));e.FormFactor=_,t={UniqueId:"00000000-0000-0000-0000-000000000000",CustomControls:{[_]:e}}}return t}}function Ce(e,t,n){const r=h.a,{entityTypeName:a}=Object(o.g)(e,t);return e&&e.metadata&&e.metadata.homePageConfigurations&&e.metadata.homePageConfigurations[a]&&a&&r?e.metadata.homePageConfigurations[a][r]:null}function Ee(e,t){const n=h.a;return e&&e.metadata&&e.metadata.homePageConfigurations&&e.metadata.homePageConfigurations[t]&&t&&n?e.metadata.homePageConfigurations[t][n]:null}function Ie(e,t,n){const r=h.a,{entityTypeName:a}=Object(o.g)(e,t);if(!(e&&e.metadata&&a&&r))return null;const i=e.metadata.homePageBusinessLogics;return i&&i[a]&&i[a][r]?i[a][r]:null}function we(e,t,n,r,a){const i=r.contextTokenType;if(i!==_.a.MainGrid&&i!==_.a.AssociatedGrid&&i!==_.a.SubGrid)return null;if(i===_.a.SubGrid)return je(e,t,r,a);if(i===_.a.AssociatedGrid){const r=function(e,t,n){if(!t)return null;const r=Object(C.b)(e);let a,i=e.metadata.homePageConfigurations;i&&i[t]&&i[t][h.a]&&i[t][h.a].CustomControls&&i[t][h.a].CustomControls[r]&&(a=i[t][h.a].CustomControls[r]);i=Object(F.a)(e,n).gridConfigurations,i&&i[t]&&i[t][h.a]&&i[t][h.a].CustomControls&&i[t][h.a].CustomControls[r]&&(a=i[t][h.a].CustomControls[r]);if(a)return!Se(e,a,r)&&Ve(a.Parameters);return null}(e,n,t);return null===r?null:r}const o=Oe()(e,t,r),s=Object(C.b)(e);return Ve((o&&!Object(D.c)(s)&&o.CustomControls&&o.CustomControls[s]).Parameters)}function je(e,t,n,r){const a=Object(F.a)(e,t),i=Object(C.b)(e);let o;o=n.contextTokenType===_.a.SubGrid?n.parentContextToken:n;const s=Object(R.fb)(e,{id:t},o);if(a&&a.gridConfigurations){const n=Object(M.b)(e,t);if(s&&s.Controls&&i&&n){const t=n.guid,o=s.Controls[r];if(o){const n=o.UniqueId;if(n&&t&&a.gridConfigurations[t]&&a.gridConfigurations[t][n]&&a.gridConfigurations[t][n].CustomControls&&a.gridConfigurations[t][n].CustomControls[i]&&a.gridConfigurations[t][n].CustomControls[i].Parameters){const r=a.gridConfigurations[t][n].CustomControls[i];if(r)return!Se(e,r,i)&&Ve(r.Parameters)}}}}if(s&&s.Controls){const t=s.Controls[r];if(t&&t.UniqueId&&s.ControlConfigurations){const n=s.ControlConfigurations[t.UniqueId];if(n&&n.CustomControls){const t=n.CustomControls[i];if(t)return!Se(e,t,i)&&Ve(t.Parameters)}}}return!1}function Pe(e,t,n,r,a){const i=h.a,o=Object(C.b)(e);if(!n||!t||!t.guid)return null;const s={DefaultViewId:t.guid,RelationshipName:r,TargetEntityType:n,EnableViewPicker:"true"},c=Object(f.x)(i,s,!0);let l;if(c.FormFactor=o,e.metadata.views[t.guid]&&e.metadata.views[t.guid].grid&&e.metadata.views[t.guid].grid.customControlDescriptions){const n=e.metadata.views[t.guid].grid.customControlDescriptions;n&&n.CustomControls&&n.CustomControls[o]&&(l=n.CustomControls[o])}let u=e.metadata.homePageConfigurations;u&&u[n]&&u[n][i]&&u[n][i].CustomControls&&u[n][i].CustomControls[o]&&(l=u[n][i].CustomControls[o]);const d=Object(F.a)(e,a);if(d&&d.pageViewConfigurations&&void 0!==d.pageViewConfigurations[t.guid]&&(l=d.pageViewConfigurations[t.guid].CustomControls[o]),u=d.gridConfigurations,u&&u[n]&&u[n][i]&&u[n][i].CustomControls&&u[n][i].CustomControls[o]&&(l=u[n][i].CustomControls[o]),l&&!Se(e,l,o)){const a=Te(e,l.CustomControlId);return l.Parameters&&l.Parameters[a]&&(l.Parameters[a]=Object.assign(l.Parameters[a],{ViewId:t.guid,RelationshipName:r,TargetEntityType:n,EnableViewPicker:"true"})),l}return c}function Te(e,t){return function(e){if(!e||!e.Properties||!e.Properties.DataSetDefinitions)return null;for(const t in e.Properties.DataSetDefinitions)if(e.Properties.DataSetDefinitions[t].Primary)return t;return null}(Object(c.e)(e,t))}function Ne(e,t){return function(e){if(!e||!e.Properties||!e.Properties.DataSetDefinitions)return null;for(const t in e.Properties.DataSetDefinitions)if(!e.Properties.DataSetDefinitions[t].Primary)return t;return null}(Object(c.e)(e,t))}function Ae(e,t,n,r){r=y.o;const a=G(e,t,n);if(a){const e=a&&a.controls,t=e&&e[r]&&e[r].parameters;for(const e in t)if(t[e].Name===y.u)return t[e].Value}return null}function De(e,t){const n=Object(m.e)(e,t.labelList),r=[{id:g.b.savedview.toString(),name:Object(m.c)(n,t.SYSTEM_VIEWS_LABEL_ID)},{id:g.b.userview.toString(),name:Object(m.c)(n,t.USER_VIEWS_LABEL_ID)}];return Object(j.a)(e,w.Uc,w.h)?r.reverse():r}function Re(e,t,n,r){const i={TargetEntityType:null,ViewId:null,EnableViewPicker:!1};r=y.o;const o=G(e,t,n),s=o&&o.viewId,c=o&&o.controls,l=c&&c[r]&&c[r].parameters;if(l){for(const e in l)l[e].Name===y.C&&(i.ViewId=l[e].Value),l[e].Name===y.u&&(i.TargetEntityType=l[e].Value),l[e].Name===y.j&&(i.EnableViewPicker=l[e].Value);return s&&(i.ViewId=a.a.toString(s)),i}return null}function xe(e,t,n,r=!1){var a;let i=Object(s.c)(e,t,r);if(!i)return null;const c=Object(o.g)(e,n);if(null==c?void 0:c.pageToEditedViewMapId){const n=nt(e,c.pageToEditedViewMapId.guid,t.guid);n&&(i=Object.assign(Object.assign({},i),{fetchXML:n.fetchXml}),Object(j.a)(e,w.Lc)&&(i.grid=null!==(a=n.gridDescriptor)&&void 0!==a?a:i.grid))}return i}function Me(e,t,n){const r=Object(s.c)(e,a.a.tryParse(t));let i=null;return r&&(i=r.isUserView?A.b:A.a),i}function Fe(e,t,n){const r=Object(s.e)(e,t,g.a.MAIN_APPLICATION_VIEW,n);return r?r.isUserView?g.b.userview:g.b.savedview:null}function ke(e,t,n){const r=Object(F.a)(e,t),a=Object(b.x)(n);if(r&&r.records&&r.records[a])return r.records[a].snapshotId}function Le(e,t,n){const r=G(e,t,n);return r&&r.customFilter?r.customFilter:null}function Be(e,t,n){const r=Le(e,t,n);return r&&r.customFilterXml?r.customFilterXml:null}function Ue(e,t){if(!e||!e.metadata||!t)return!1;const n=h.a,r=e.metadata.homePageConfigurations;if(r&&r[t]&&r[t][n]&&r[t][n].CustomControls)for(const e in r[t][n].CustomControls){if(Ve(r[t][n].CustomControls[e].Parameters))return!0}return!1}function Ve(e){return!!(e&&e.EnableEditing&&e.EnableEditing.Value)&&"yes"===e.EnableEditing.Value.toLowerCase()}function ze(e){const t=[];if(e&&""!==e){const n=e.split(",");for(const e of n)t.push(a.a.toString(a.a.tryParse(e)))}return t}function We(e,t,n){const r=Object(F.a)(e,t.id),a=Object(b.v)(n);return r&&r.forms&&r.forms[a]?r.forms[a].selectedRelatedEntity:null}function qe(e,t,n){const r=G(e,t,n),a=r&&r.chartFilterExpression,i=Object(o.g)(e,t);return a||i.filterExpression}function He(e,t,n){const r=G(e,t,n);return r&&r.chartDrillDownParameters}function Ge(e){let t=[W,k,L,B,U,V,z,"serviceappointment","campaignresponse","campaignactivity","recurringappointmentmaster","socialactivity"];const n=[],a=Object(v.a)(e);for(const e in a){const i=(a[e].ActivityTypeMask&r.CommunicationActivity)===r.CommunicationActivity;-1===t.indexOf(e)&&i&&a[e].IsEnabledInUnifiedInterface&&n.push(e)}return t=t.concat(n),function(e,t){const n=Object(S.c)(e),r=(n?n.entities:[]).map(e=>e.LogicalName),a=t.filter(e=>-1!==r.indexOf(e));return a.length?a:t}(e,t).filter(e=>!a[e]||!a[e].hasOwnProperty("IsEnabledInUnifiedInterface")||a[e].IsEnabledInUnifiedInterface)}function Ke(e){const t=Object(v.a)(e),n=[];for(const e in t)t[e].IsEnabledInUnifiedInterface&&n.push(e);return n}function Qe(e,t){return t&&(t.toLowerCase()===W||Object(v.r)(e,t.toLowerCase()))}function Xe(e){const t=Object(O.w)(e);let n={};t&&t.defaultGridViews&&(n=t.defaultGridViews);const r=Object(S.c)(e),a=(r?r.entities:[]).map(e=>e.LogicalName);for(const t in n)if(t===W||Object(v.r)(e,t)){if(a.indexOf(t)<0)break;if(Object(I.b)(e)||Object(N.l)(e,t)){const e=n[t];return{PinnedEntity:t,ViewId:e.ViewId,ViewType:e.ViewType}}}return null}function Ye(e,t,n,r){const i={PinnedEntity:null,ViewId:null,ViewType:null,ExtraQueueFilter:null};if(t&&e&&e.defaultGridViews){const o=t!==W?e.defaultGridViews[t]:Xe(r);o&&o.ViewId&&(n.info("User default view was found"),i.PinnedEntity=t!==W?t:o.PinnedEntity,i.ViewId=a.a.tryParse(o.ViewId),i.ViewType=o.ViewType,i.ExtraQueueFilter=ze(o.QueueId))}return i}function Je(e,t){return y.D+"_"+e+"_"+t}function $e(e,t,n){let r;const a=Object(v.h)(e,t);if(a){const e=Object.assign(Object.assign(Object.assign({},a.ManyToManyRelationships),a.ManyToOneRelationships),a.OneToManyRelationships);if(e){const a=e[n];a&&1===a.RelationshipType&&(r=T.a.AssociationEntity,a.Entity2LogicalName===t&&(r=T.a.Referencing))}}return r}function Ze(e,t,n,r){const a={},i=Object(p.f)(e,n,"picklist"),o=Object(p.f)(e,n,"multiselectpicklist"),s=Object.assign(i,o),c=J(e,r,t);if(c){const t=xe(e,c,r);if(t&&t.grid&&t.grid.rows){const e=[],n=t.grid.rows[0].cells;for(const t in n)n.hasOwnProperty(t)&&e.push(n[t].name);if(!(Object.keys(s).length>0))return null;for(let t=0;t<e.length;t++)if(s[e[t]]){const n=s[e[t]].ParentPicklistLogicalName,r=s[e[t]].ChildPicklistLogicalNames;(null!==n||null!=r&&r.length>0)&&(a[e[t]]=s[e[t]])}return a}}return null}function et(e,t,n){const r=G(e,n,t);return r&&r.dependentOptionSetColumnStatus?r.dependentOptionSetColumnStatus:null}function tt(e,t){if(!Object(j.a)(e,w.ub)||!Object(I.b)(e))return null;if(!Object(l.e)(e,"e3fed6f2-35c3-47a9-9273-9ee58e83489f",3))return null;let n;const r=Object(v.C)(e,t);for(const e in r){const t=r[e];if(t&&t.IsHierarchical){n={primaryAttribute:t.ReferencedAttribute,lookupAttribute:t.ReferencingAttribute};break}}return n}function nt(e,t,n){var r;return null===(r=e.editedViews[t])||void 0===r?void 0:r[n]}function rt(e,t,n){if((null==n?void 0:n.contextTokenType)===_.a.AssociatedGrid){const r=G(e,t,n);if(null==r?void 0:r.useRollupView)return 1}return 0}function at(e){return Object(j.a)(e,w.sb,w.Lc)}},P74A:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("504W");class a{constructor(e){this._selectedFormsByEntity=null,this._selectedFormsByEntity=e}get_selectedFormsByEntity(){return this._selectedFormsByEntity}getObjectData(){const e={};return e.selectedFormsByEntity=this._selectedFormsByEntity,e}static createFromObjectData(e){const t=Object(r.a)(e.selectedFormsByEntity)?new Array(0):e.selectedFormsByEntity;return new a(t)}}},P7gI:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("M0zh");function a(e){return{type:r.a,payload:e,meta:{}}}},P86a:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.CompletedInitialRuleEvaluation=2]="CompletedInitialRuleEvaluation",e[e.SkippedRuleEvaluation=3]="SkippedRuleEvaluation"}(r||(r={}))},PF3G:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");class a extends r.a{constructor(e,t,n,r,a,i,o){super(),this._target=null,this._suppressDuplicateDetection=!1,this._calculateMatchCodeSynchronously=!1,this._solutionUniqueName=null,this._maintainLegacyAppServerBehavior=!1,this._concurrencyBehavior=0,this._returnRowVersion=!1,this._target=e,this._suppressDuplicateDetection=t,this._calculateMatchCodeSynchronously=n,this._solutionUniqueName=r,this._maintainLegacyAppServerBehavior=a,this._concurrencyBehavior=i,this._returnRowVersion=o}get_name(){return"Update"}get_xmlNamespace(){return"http://schemas.microsoft.com/xrm/2011/Contracts"}get_target(){return this._target}get_suppressDuplicateDetection(){return this._suppressDuplicateDetection}get_calculateMatchCodeSynchronously(){return this._calculateMatchCodeSynchronously}get_solutionUniqueName(){return this._solutionUniqueName}get_maintainLegacyAppServerBehavior(){return this._maintainLegacyAppServerBehavior}get_concurrencyBehavior(){return this._concurrencyBehavior}set_concurrencyBehavior(e){return this._concurrencyBehavior=e,e}get_returnRowVersion(){return this._returnRowVersion}set_returnRowVersion(e){return this._returnRowVersion=e,e}}},"PV+a":function(e,t,n){"use strict";n.d(t,"b",(function(){return W})),n.d(t,"d",(function(){return q})),n.d(t,"c",(function(){return H})),n.d(t,"a",(function(){return X}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let r=1;class a{constructor(e,t){this._id=r++,this.schPriority=e,this._name=t}get id(){return this._id}get name(){return this._name}get priority(){return this.schPriority}set priority(e){this.schPriority=e}get nextNode(){return this._nextNode}removeNode(){const e=this._previousNode,t=this._nextNode;t&&(t._previousNode=e),e&&(e._nextNode=t),this._previousNode=null,this._nextNode=null}insertNodeBefore(e){const t=this._previousNode;t&&(t._nextNode=e),e._nextNode=this,e._previousNode=t,this._previousNode=e}insertNodeAfter(e){const t=this._nextNode;this._nextNode=e,e._nextNode=t,e._previousNode=this,t&&(t._previousNode=e)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class i extends a{get nextMarkerNode(){return this._nextMarkerNode}insertMarkerNodeAfter(e){const t=this._nextMarkerNode;this._nextMarkerNode=e,e._nextMarkerNode=t}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class o{constructor(e,t){this._job=t,this._yieldResult=null,this._yieldPolicy=0,this._shouldYield=e,this._publicApiDisabled=!1}get job(){return this._throwIfDisabled(),this._job}get yieldResult(){return this._yieldResult}get yieldPolicy(){return this._yieldPolicy}shouldYield(){return this._throwIfDisabled(),this._shouldYield()}setPromise(e){this._throwIfDisabled(),this._yieldResult=e,this._yieldPolicy=2}setWork(e){this._throwIfDisabled(),this._yieldResult=e,this._yieldPolicy=1}disablePublicApi(){this._publicApiDisabled=!0}_throwIfDisabled(){if(this._publicApiDisabled)throw new Error("Job info is no longer valid")}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const s=!(!window||!window.msWriteProfilerMark);function c(e,t,n){return void 0!==n?`(${e};${t};${n})`:void 0!==t?`(${e};${t})`:void 0!==e?`(${e})`:""}function l(e,t,n,r){const a=`MoCA.Scheduler:${e}${c(n,r)},${t}`;s&&msWriteProfilerMark(a)}function u(e,t,n,r,a){const i=!!e.name||void 0!==r||void 0!==a,o=`MoCA.Scheduler:${t}:${e.id}${i?c(r,a):""},${n}`;s&&msWriteProfilerMark(o)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function d(){return!1}function p(e){throw new Error(`Illegal call by job(${e.id.toString()}) in state: ${this.name}`)}class g{constructor(e){this._name=e,this._completed=!1,this.enter=p,this.execute=p,this.executeDone=p,this.blockedDone=p,this.cancel=p,this.resume=p,this.setPriority=p}get name(){return this._name}get completed(){return this._completed}set completed(e){throw new Error("'completed' is read-only")}set completedInternal(e){this._completed=e}}const h=new g("created"),f=new g("scheduled"),m=new g("paused"),b=new g("canceled"),_=new g("running"),y=new g("running_paused"),v=new g("running_resumed"),S=new g("running_canceled"),O=new g("running_canceled_blocked"),C=new g("cooperative_yield"),E=new g("cooperative_yield_paused"),I=new g("blocked"),w=new g("blocked_waiting"),j=new g("blocked_paused"),P=new g("blocked_paused_waiting"),T=new g("blocked_canceled"),N=new g("complete");function A(e){return function(t,n,r){t.setState(e,n,r)}}function D(e,t){e.setPriority(t)}h.enter=e=>{X.addJobAtTailOfPriority(e,e.priority),e.setState(f)},f.enter=()=>{X.startRunning()},f.execute=A(_),f.cancel=A(b),f.pause=A(m),f.resume=d,f.setPriority=(e,t)=>{e.priority!==t&&(e.setPriority(t),e.pause(),e.resume())},m.enter=e=>{u(e,"job-paused","info"),e.removeNode()},m.cancel=A(b),m.pause=d,m.resume=e=>{u(e,"job-resumed","info"),X.addJobAtTailOfPriority(e,e.priority),e.setState(f)},m.setPriority=D,b.enter=e=>{u(e,"job-canceled","info"),e.removeNode(),e.work=null},b.cancel=d,b.pause=d,b.resume=d,b.setPriority=d,_.enter=(e,t)=>{e.removeNode();const n=e.priority,r=e.work;e.work=null;const a=new o(t,e);try{r&&r(a)}finally{a.disablePublicApi()}const i=e.executeDone(a.yieldPolicy);e.setState(i,a.yieldResult,n)},_.executeDone=(e,t)=>{switch(t){case 0:return N;case 1:return C;case 2:return I}},_.cancel=e=>{X.immediateYield=!0,e.setState(S)},_.pause=e=>{X.immediateYield=!0,e.setState(y)},_.resume=d,_.setPriority=D,y.enter=d,y.executeDone=(e,t)=>{switch(t){case 0:return N;case 1:return E;case 2:return j}},y.cancel=A(S),y.pause=d,y.resume=A(v),y.setPriority=D,v.enter=d,v.executeDone=(e,t)=>{switch(t){case 0:return N;case 1:return C;case 2:return I}},v.cancel=A(S),v.pause=A(y),v.resume=d,v.setPriority=D,S.enter=d,S.executeDone=(e,t)=>{switch(t){case 0:case 1:return b;case 2:return O}},S.cancel=d,S.pause=d,S.resume=d,S.setPriority=d,O.enter=(e,t)=>{t&&t.cancel&&t.cancel(),e.setState(b)},C.enter=(e,t,n)=>{u(e,"job-yielded","info"),n===e.priority?X.addJobAtHeadOfPriority(e,e.priority):X.addJobAtTailOfPriority(e,e.priority),e.work=t,e.setState(f)},E.enter=(e,t)=>{u(e,"job-yielded","info"),e.work=t,e.setState(m)},I.enter=(e,t,n)=>{u(e,"job-blocked","StartTM"),e.setState(w),t.then(t=>{u(e,"job-blocked","StopTM");const r=e.blockedDone(t);e.setState(r,t,n)}).catch(()=>{u(e,"job-blocked","StopTM"),e.setState(b)})},w.enter=d,w.blockedDone=(e,t)=>"function"==typeof t?C:N,w.cancel=A(T),w.pause=A(P),w.resume=d,w.setPriority=D,j.enter=(e,t,n)=>{u(e,"job-blocked","StartTM"),e.setState(P),t.then(t=>{u(e,"job-blocked","StopTM");const r=e.blockedDone(t);e.setState(r,t,n)}).catch(()=>{u(e,"job-blocked","StopTM"),e.setState(b)})},P.enter=d,P.blockedDone=(e,t)=>"function"==typeof t?E:N,P.cancel=A(T),P.pause=d,P.resume=A(w),P.setPriority=D,T.enter=e=>{e.work&&(e.work.cancel&&e.work.cancel(),e.work=null)},T.blockedDone=()=>b,T.cancel=d,T.pause=d,T.resume=d,T.setPriority=d,N.completedInternal=!0,N.enter=e=>{e.work=null,u(e,"job-completed","info")},N.cancel=d,N.pause=d,N.resume=d,N.setPriority=d;function R(e){return e|=0,e=Math.min(e,15),e=Math.max(e,-15)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class x extends a{constructor(e,t,n,r){super(t,n),this._state=r,this._work=e,this._owner=null,this.setPriority(t),this.setState(h),u(this,"job-scheduled","info")}get priority(){return this.schPriority}set priority(e){if(e!==this.schPriority){const t=R(e);this._state.setPriority(this,t)}}get completed(){return this._state.completed}get work(){return this._work}set work(e){this._work=e}get owner(){return this._owner}set owner(e){this._owner!==e&&(this._owner&&this._owner.removeJob(this),this._owner=e,this._owner&&this._owner.addJob(this))}cancel(){this._state.cancel(this)}pause(){this._state.pause(this)}resume(){this._state.resume(this)}setState(e,t,n){this._state=e,this._state.enter(this,t,n)}setPriority(e){this.schPriority!==e&&u(this,"job-priority-changed","info"),this.schPriority=e}execute(e){this._state.execute(this,e)}executeDone(e){return this._state.executeDone(this,e)}blockedDone(e){return this._state.blockedDone(this,e)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class M{constructor(){this._jobs={}}addJob(e){this._jobs[e.id]=e}removeJob(e){delete this._jobs[e.id]}cancelAll(){const e=this._jobs;this._jobs={};for(const t in e)e.hasOwnProperty(t)&&e[t].cancel()}}var F=n("DRVD"),k=n.n(F),L=n("iDqy"),B=n.n(L),U=n("TEuE"),V=n("SZCI");const z=new
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class{constructor(){this._useSetImmediate=window.hasOwnProperty("setImmediate")}immediate(e){return this._useSetImmediate?{yieldId:setImmediate(e)}:{yieldId:setTimeout(e,0)}}},W=13,q=0,H=-13,G=k.a.createEvent("Run",V.s);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function K(){return performance.now()}let Q=0;const X=new class{constructor(e){this._timeSliceDuration=20,this._highWaterMark=-15,this._immediateYield=!1,this._pumping=!1,this._pumpingPriority=-16,this._scheduledVersion=0,this._executedVersion=0,this._runningJob=null,this._drainQueue=[],this._yieldProvider=e;const t=[new i(15,"max"),new i(14,"14"),new i(W,"high"),new i(12,"12"),new i(11,"11"),new i(10,"10"),new i(9,"aboveNormal"),new i(8,"8"),new i(7,"7"),new i(6,"6"),new i(5,"5"),new i(4,"4"),new i(3,"3"),new i(2,"2"),new i(1,"1"),new i(q,"normal"),new i(-1,"-1"),new i(-2,"-2"),new i(-3,"-3"),new i(-4,"-4"),new i(-5,"-5"),new i(-6,"-6"),new i(-7,"-7"),new i(-8,"-8"),new i(-9,"belowNormal"),new i(-10,"-10"),new i(-11,"-11"),new i(-12,"-12"),new i(H,"idle"),new i(-14,"-14"),new i(-15,"min"),new i(-16,"<TAIL>")];t.reduce((e,t)=>(e&&(e.insertNodeAfter(t),e.insertMarkerNodeAfter(t)),t)),this._priorities=t}set immediateYield(e){this._immediateYield=e}protectHighPriorityBrowserAsyncWork(e){Object(U.d)(e)}schedule(e,t,n){return new x(e,R(t),n,h)}createOwnerToken(){return new M}startRunning(){if(this._pumping)return;const e=++this._scheduledVersion;this._yieldProvider.immediate(()=>{this._executedVersion<e&&(this._executedVersion=this._scheduledVersion,this._run())})}_run(){const e=G.startStopwatch(),t=B.a.trackWork("Scheduler.Run");let n;this._pumping=!0,l("timeslice","StartTM");let r,a=!0,i=-16,o=!1;this._immediateYield=!1;try{const s=K()+this._timeSliceDuration,c=()=>(o=!1,!!this._immediateYield||!(this._drainQueue.length>0)&&(K()>s&&(o=!0,!0)));for(;this._highWaterMark>=-15&&!c();){n=!1,r=this._markerFromPriority(this._highWaterMark).nextNode;do{this._pumpingPriority=r.priority,r instanceof x?(i!==r.priority&&(+i===i&&l("priority","StopTM",this._markerFromPriority(i).name),l("priority","StartTM",this._markerFromPriority(r.priority).name),i=r.priority),n=!0,a=!1,this._runningJob=r,u(this._runningJob,"job-running","StartTM",this._markerFromPriority(this._pumpingPriority).name),r.execute(c),u(this._runningJob,"job-running","StopTM",this._markerFromPriority(this._pumpingPriority).name),this._runningJob=null,a=!0):(this._highWaterMark=r.priority,n=this._notifyDrainListeners()),r=r.nextNode}while(r&&!n);this._immediateYield=!1}}catch(e){this._eventManager&&this._eventManager.ReportComponentFailure("Scheduler",e)}finally{this._runningJob=null,a||r&&r instanceof x&&(u(r,"job-error","info"),u(r,"job-running","StopTM",this._markerFromPriority(this._pumpingPriority).name),r.cancel()),+i===i&&l("priority","StopTM",this._markerFromPriority(i).name);let s=!1;for(;this._highWaterMark>=-15&&!s;){n=!1,r=this._markerFromPriority(this._highWaterMark).nextNode;do{r instanceof x?s=!0:(this._highWaterMark=r.priority,n=this._notifyDrainListeners()),r=r.nextNode}while(r&&!n&&!s)}let c="unknown";a?o?c="timeslice exhausted":this._highWaterMark<-15&&(c="jobs exhausted"):c="job error",this._pumping=!1,this._highWaterMark>=-15&&this.startRunning(),l("yielding","info",c),l("timeslice","StopTM"),e({lastLoggedPriority:i.toString()}),t()}}addJobAtHeadOfPriority(e,t){const n=this._markerFromPriority(t);n.priority>this._highWaterMark&&(this._highWaterMark=n.priority,this._immediateYield=!0),n.insertNodeAfter(e)}addJobAtTailOfPriority(e,t){const n=this._markerFromPriority(t);n.priority>this._highWaterMark&&(this._highWaterMark=n.priority,this._immediateYield=!0),n.nextMarkerNode&&n.nextMarkerNode.insertNodeBefore(e)}requestDrain(e=-15,t){return t=t||"Drain request "+ ++Q,new Promise(n=>{this._drainQueue.push({priority:R(e),complete:n,name:t||""}),1===this._drainQueue.length&&(l("drain","StartTM",t,this._markerFromPriority(e).name),e>this._highWaterMark&&(this._highWaterMark=e,this._immediateYield=!0)),this._pumping||this.startRunning()})}_currentDrainPriority(){return this._drainQueue.length>0?this._drainQueue[0].priority:-16}_notifyCurrentDrainListener(){const e=this._drainQueue.shift();e&&(l("drain","StopTM",e.name,this._markerFromPriority(e.priority).name),e.complete())}_notifyDrainListeners(){let e=!1;if(this._drainQueue.length>0){let t=this._currentDrainPriority();for(;-16!==t&&t>this._highWaterMark;)this._pumpingPriority=t,this._notifyCurrentDrainListener(),e=!0,t=this._currentDrainPriority()}return e}setEventManager(e){this._eventManager=e}retrieveState(){let e="Jobs:\n",t=this._markerFromPriority(this._highWaterMark),n=0;for(this._runningJob&&(e+=this._logJob(this._runningJob,!0),n++);t.priority>=-15;)t instanceof x&&(e+=this._logJob(t,!1),n++),t=t.nextNode;0===n&&(e+="     None\n"),e+="Drain requests:\n";const r=this._drainQueue.length;if(r>0)for(let t=0;t<r;t++)e+="     "+(0===t?"*":" ")+"priority: "+this._markerFromPriority(this._drainQueue[t].priority).name+", name: "+this._drainQueue[t].name+"\n";else e+="     None\n";return e}_logJob(e,t){return"    "+(t?"*":" ")+"id: "+e.id+", priority: "+this._markerFromPriority(e.priority).name+(e.name?"":",name: "+e.name)+"\n"}_markerFromPriority(e){return this._priorities[-1*(R(e)-15)]}}(z)},Pcet:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="dataSnapshot.updateIdentifier";function a(e,t){return{type:r,payload:t,meta:e}}},PidC:function(e,t,n){"use strict";n.d(t,"h",(function(){return I})),n.d(t,"c",(function(){return w})),n.d(t,"b",(function(){return A})),n.d(t,"i",(function(){return j})),n.d(t,"j",(function(){return N})),n.d(t,"d",(function(){return D})),n.d(t,"g",(function(){return x})),n.d(t,"k",(function(){return P})),n.d(t,"e",(function(){return R})),n.d(t,"a",(function(){return E})),n.d(t,"l",(function(){return M})),n.d(t,"f",(function(){return F}));var r=n("iZ7K"),a=n("arV0"),i=n("i1f0"),o=n("NjDY"),s=n("unFF"),c=n("IqkD"),l=n("YxC/"),u=n("EDOo"),d=n("odYE"),p=n("WPtp"),g=n("2cSh"),h=n("Lyxw"),f=n("3/02"),m=n("d5d1"),b=n("SAYH"),_=n("AF/G"),y=n("4leG"),v=n("3hnk"),S=n("qLnS"),O=n("qFOq"),C=n("jq7Z");const E=400;function I(){let e=null,t=!1,n=null,l=null,u=null,d=null,p=null;return function(g,h){const f=Object(a.g)(g,h.id),b=f.entityTypeName,_=f.id,y=Object(r.h)(g,b),v=Object(i.V)(g,h),S=Object(i.gb)(g,h),O=y&&!!y.PrimaryImageAttribute,C=Object(r.i)(g,b),E=Object(o.t)(g),I=C?E+C:null,w=Object(i.ec)(g,b,_),j=Object(s.a)(g),P=Object(c.g)(g);return e===j&&t===O&&n===v&&l===S&&u===I&&d===w||(e=j,t=O,n=v,l=S,u=I,d=w,p={hasPrimaryImageAttribute:O,entitySipValue:v,entityImageUrl:S,entityIconUrl:I,primaryNameAttributeValue:w,cameraEnabled:Object(m.e)(g,"camera"),styles:{containerStyle:Object.assign({height:"40px",width:"40px",minWidth:"40px",lineHeight:"40px"},{border:"2px transparent solid",fontSize:j.fontSizes.Font150,marginRight:j.sizes.Measures.Measure100,marginTop:0,marginBottom:0,marginLeft:P?j.sizes.Measures.Measure150:0,backgroundColor:"transparent"}),circleStyle:Object.assign({height:"40px",width:"40px",minWidth:"40px",lineHeight:"40px"},{borderRadius:"50%",textAlign:"center",fontWeight:"bold",textTransform:"uppercase",color:"white",marginRight:0,fontSize:j.fontSizes.Font150}),entityImagePropStyle:Object.assign({height:"40px",width:"40px",minWidth:"40px",lineHeight:"40px"},{borderRadius:"50%",textAlign:"center",fontWeight:"bold",textTransform:"uppercase",color:"white",marginRight:0,fontSize:j.fontSizes.Font115})}}),p}}function w(e,t,n){const o=Object(a.g)(e,t),s=o.entityTypeName,c=o.id,d=Object(i.ec)(e,s,c),p=Object(l.b)(e,u.a),g=Object(r.h)(e,s),h=g?g.DisplayName:"",f=h&&p?String.format(p,h):"",m=Object(i.Yb)(e,t,n);return Object(i.ob)(c,d,f,m)}function j(){let e=null;const t=function(){let e=null;return function(t){let n=!1;if(t){const r=Object.keys(t);e&&r.length===Object.keys(e).length||(n=!0),n||r.some(r=>{if(t[r]&&Object(p.k)(t[r])&&(null==e?void 0:e[r])&&(Object(p.a)(e[r])!==Object(p.a)(t[r])||Object(p.b)(e[r])!==Object(p.b)(t[r])))return n=!0,n})}return n&&(e=t),n}}();return function(n,r){const o=Object(i.tb)(n,r,r.contextToken).filter(e=>P(e)),s=Object(a.m)(n,r.id)&&!x(n,r,r.contextToken)&&!Object(y.d)(n),c=[],l={},u={};if(o&&o.length>0)for(let e=0;e<o.length&&e<4;e++){const t=o[e],g=t.PreviewId,h=t.Name,f=t.DataFieldName,{entityTypeName:m,id:b}=Object(a.g)(n,r.id),_=Object(i.ac)(n,r.id,r.contextToken),y=Object(i.X)(n,r.id,r.contextToken,_,new d.a(m,b),t.DataFieldName);u[h]=y;let O=Object(p.c)(y);if(!O&&s)continue;O=Object(v.f)(n,m,f,S.a.CanRead,b)?O||"---":"***";const C=[];if(Object(p.k)(y)){const e=T(Object(p.a)(y),Object(p.b)(y));C.push({displayValue:O,navigationInput:e})}else C.push({displayValue:O,navigationInput:null});c.push(h),l[h]={label:Object(i.w)(n,{id:r.id,controlName:h},r.contextToken),showLabel:t.ShowLabel,content:C,previewId:g}}let g=!1;e&&e.controlNames.length!==c.length&&(g=!0);if(t(u)&&(g=!0),!g)for(let t=0;t<c.length;t++){const n=c[t];if(e&&e.controlNames&&e.controlNames[t]!==n){g=!0;break}if(!e||!e.controls||!e.controls[n]){g=!0;break}const r=l[n],a=e.controls[n];if(r.label!==a.label){g=!0;break}for(let e=0;e<r.content.length;e++)if(r.content[e].displayValue!==a.content[e].displayValue){g=!0;break}if(g)break}return g&&(e={controlNames:c,controls:l}),e}}function P(e){return b.a.equals(e.ClassId,_.j)||b.a.equals(e.ClassId,_.q)||b.a.equals(e.ClassId,_.r)||b.a.equals(e.ClassId,_.s)||b.a.equals(e.ClassId,_.v)||b.a.equals(e.ClassId,_.B)||b.a.equals(e.ClassId,_.H)||b.a.equals(e.ClassId,_.K)||b.a.equals(e.ClassId,_.M)||b.a.equals(e.ClassId,_.P)||b.a.equals(e.ClassId,_.T)||b.a.equals(e.ClassId,_.U)||b.a.equals(e.ClassId,_.W)||b.a.equals(e.ClassId,_.bb)||b.a.equals(e.ClassId,_.fb)||b.a.equals(e.ClassId,_.ob)||b.a.equals(e.ClassId,_.pb)||b.a.equals(e.ClassId,_.sb)||b.a.equals(e.ClassId,_.tb)}function T(e,t){return e&&t?{entityTypeName:e.etn,id:t}:null}function N(){let e=null;const t=Object(i.ed)();return function(n,r){const a=t(n,r);return a!==e&&(e=a),e}}function A(e,t,n,r){const a=r?500:E;return Object(h.a)(e,f.mb)&&Object(i.rb)(e,t,n)<a}function D(e,t,n,r){const a=Object(C.a)(e,t),o=Object(i.yb)(a,r);let s=!1;if(o&&o.length>0){const e=n&&n.map(e=>e.Name),t=e?new Set(e):new Set;s=o.some(e=>t.has(e))}return s}function R(e,t,n){return Object(i.fb)(e,t,n).Header.PreviewId}function x(e,t,n){const r=Object(i.tb)(e,t,n),a=Object(i.fb)(e,t,n);return a&&(a.HeaderDensity===g.a.HighWithControls||null==a.HeaderDensity)&&r&&r.length>0}function M(e,t,n,r,a){return r&&r.length>0||Object(i.Hb)(e,t,n)&&a!==O.a.NotReadOnly}function F(e,t,n){const r=Object(i.cb)(e,t,n);return r?r.header:null}},PrIm:function(e,t,n){"use strict";n.d(t,"a",(function(){return D}));var r=n("u+q+"),a=n("Ua4i"),i=n("nuS9"),o=n("YWpA"),s=n("H/hG"),c=n("evW+"),l=n("znb3"),u=n("XIN1"),d=n("SDtF");function p(e){return Object.assign({display:"inline-flex",width:16,height:16,backgroundColor:"#3da3ff",borderRadius:"50%",justifyContent:"center",alignItems:"center",cursor:"pointer"},e.style)}function g(e){return Object.assign({},{color:"#fff",fontFamily:"Dyn CRM Symbol, Segoe MDL2 Assets",fontSize:"12px"},e.infoSymbolStyle)}function h(e){return i.createElement(d.a,{text:e.infoMessage,accessibilityHidden:e.accessibilityHidden},i.createElement(o.a,{style:p(e),accessibilityLabel:"Information"},i.createElement(u.b,{type:l.a.InformationIcon,style:g(e)})))}function f(e){return Object.assign({display:"inline-flex",width:16,height:16,backgroundColor:"#ff0000",borderRadius:"50%",justifyContent:"center",alignItems:"center",cursor:"pointer"},e.style)}function m(e){return Object.assign({},{color:"#fff",fontFamily:"Dyn CRM Symbol, Segoe MDL2 Assets",fontSize:"12px"},e.errorSymbolStyle)}function b(e){return i.createElement(d.a,{text:e.errorMessage},i.createElement(o.a,{style:f(e),accessibilityLabel:"Error"},i.createElement(u.b,{type:l.a.ErrorIcon,style:m(e)})))}function _(e){return Object.assign({display:"inline-flex",width:16,height:16,justifyContent:"center",alignItems:"center",cursor:"pointer"},e.style)}function y(e){return Object.assign({},{color:"#b22912",fontFamily:"Dyn CRM Symbol, Segoe MDL2 Assets",fontSize:"16px"},e.warningSymbolStyle)}function v(e){return i.createElement(d.a,{text:e.warningMessage},i.createElement(o.a,{style:_(e),accessibilityLabel:"Warning"},i.createElement(u.b,{type:l.a.Warning,style:y(e)})))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class S extends i.Component{constructor(e){super(e),this._onClose=this._onClose.bind(this)}render(){return i.createElement(o.a,{key:"globalNotificationRoot",style:this.props.styles.globalNotificationRootViewStyle},this._renderComponent())}_renderComponent(){return i.createElement(o.a,{key:"globalNotificationRoot",style:this.props.styles.globalNotificationViewStyle},i.createElement(o.a,{key:"data-action-icon",style:this.props.styles.globalNotificationIconWrapperStyle},this._renderNotificationIcon()),i.createElement(o.a,{key:"data-action-block",style:this.props.styles.globalNotificationDataActionBlockStyle},i.createElement(s.a,{key:"notificationIcon",style:this.props.styles.globalNotificationTextContainerStyle},this.props.title?i.createElement(s.a,{key:"globalnotification-title",style:this.props.styles.globalNotificationTitleStyle},this.props.title):null,i.createElement(s.a,{key:"globalnotification-message",testhooks:{id:"global-notification-message"}},this.props.message)),null!=this.props.action?this._renderActionButtonIcon():null),this.props.showCloseButton?this._renderCloseButtonIcon():null)}_renderNotificationIcon(){switch(this.props.level){case 4:return i.createElement(h,{key:"notificationIcon",style:this.props.styles.globalNotificationIconStyle});case 3:return i.createElement(v,{key:"notificationIcon",style:this.props.styles.globalNotificationIconStyle});case 2:return i.createElement(b,{key:"notificationIcon",style:this.props.styles.globalNotificationIconStyle});default:return null}}_renderCloseButtonIcon(){return i.createElement(c.a,{key:"closeButton",style:this.props.styles.globalNotificationCloseBtnStyle,onClick:this._onClose.bind(this),accessibilityLabel:"Close",testhooks:{id:"global-notification-close-button"}},i.createElement(u.b,{type:l.a.Close}))}_renderActionButtonIcon(){return i.createElement(c.a,{key:"actionButton",style:this.props.styles.globalNotificationActionBtnStyle,onClick:this.props.action.eventHandler,accessibilityLabel:this.props.action.actionLabel,testhooks:{id:"global-notification-action-button"}},i.createElement(s.a,null," ",this.props.action.actionLabel))}_onClose(){this.props&&this.props.close()}}var O=n("unFF"),C=n("GYEz"),E=n("w1eR"),I=n("0kGT");let w;function j(e){const t=Object(O.a)(e),n=Object(I.b)(e),r={globalNotificationsRootViewStyle:{flexShrink:0},globalNotificationsViewStyle:{display:"block",width:"100%",marginTop:t.sizes.Measures.Measure100,marginBottom:t.sizes.Measures.Measure100}};return n&&(r.globalNotificationsRootViewStyle.webkitBackdropFilter="blur(27.1828px)",r.globalNotificationsRootViewStyle.backdropFilter="blur(27.1828px)",r.globalNotificationsViewStyle.marginTop="0",r.globalNotificationsViewStyle.marginBottom="0"),r}function P(e){const t=Object(O.a)(e),n=Object(C.a)(e)===E.a.MobileApplication;if(w)return w;const r={globalNotificationRootViewStyle:{width:"100%",boxShadow:t.shadows.Shadow01},globalNotificationViewStyle:{width:"100%",backgroundColor:t.colors.WhiteBackground,overflowX:"hidden",overflowY:"auto",display:"flex",paddingRight:t.sizes.Measures.Measure050,paddingBottom:t.sizes.Measures.Measure100,paddingTop:t.sizes.Measures.Measure100},globalNotificationIconStyle:{display:"inline-flex",marginLeft:t.sizes.Measures.Measure050},globalNotificationIconWrapperStyle:{fontSize:t.sizes.Measures.Measure025,height:t.sizes.Measures.Measure150},globalNotificationDataActionBlockStyle:{display:"flex",flex:1,flexDirection:n?"column":"row",justifyContent:"space-between"},globalNotificationTitleStyle:{display:"inline-flex",fontFamily:t.fontFamilies.Semibold,paddingRight:t.sizes.Measures.Measure050},globalNotificationTextContainerStyle:{fontSize:t.fontSizes.Font100,fontFamily:t.fontFamilies.Regular,width:"100%",color:t.colors.BaseColor.Grey.Grey7,marginLeft:t.sizes.Measures.Measure050},globalNotificationActionBtnStyle:Object.assign(Object.assign({},t.buttons.Button02Primary),{marginTop:n?t.sizes.Measures.Measure100:void 0,alignSelf:n?"flex-start":void 0,color:t.colors.BaseColor.White,flexShrink:0}),globalNotificationCloseBtnStyle:{backgroundColor:"transparent",borderColor:"transparent",outline:"0",cursor:"pointer",height:"18px",paddingRight:"0px"}};return Object(I.b)(e)&&(r.globalNotificationViewStyle.backgroundColor="#E1E1E1",r.globalNotificationCloseBtnStyle.color="#8E8E93",r.globalNotificationTextContainerStyle.color="#4D4D4D",r.globalNotificationViewStyle.paddingTop=t.sizes.Measures.Measure085,r.globalNotificationViewStyle.paddingBottom=t.sizes.Measures.Measure085,r.globalNotificationViewStyle.alignItems="center",r.globalNotificationIconWrapperStyle.display="none"),w=r}var T=n("P+p9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const N=Object(r.a)((function(e,t){const n=Object(a.a)(e,t.id);return{styles:P(e),level:n.props.level,message:n.props.message||"",title:n.props.title||"",isRtl:!1,action:n.props.action,onCloseHandler:n.props.onCloseHandler,showCloseButton:void 0===n.props.showCloseButton||n.props.showCloseButton}}),(function(e,t){return{close(){e(Object(T.b)(t.id))}}}))(S);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function A(e){return e.globalNotificationIds&&e.globalNotificationIds.length>0?i.createElement(o.a,{key:"globalNotificationsInner",style:Object.assign(Object.assign({},e.styles.globalNotificationsViewStyle),e.globalNotificationsViewStyle)},function(e){return e.globalNotificationIds.map(e=>{return t=e,i.createElement(N,{key:t,id:t});var t})}(e)):null}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const D=Object(r.a)(()=>{let e=null;return t=>{const n=Object(a.c)(t),r=Object(a.b)(t);if(null===e)return e={globalNotificationIds:n?Object.keys(n):[],styles:j(t)},e;if(0===e.globalNotificationIds.length&&0===r.length)return e;if(e.globalNotificationIds.length===r.length){if(!r.some(t=>e.globalNotificationIds.indexOf(t)<0))return e}return e={globalNotificationIds:n?Object.keys(n):[],styles:j(t)},e}})((function(e){return i.createElement(o.a,{key:"globalNotificationsRoot",style:e.styles.globalNotificationsRootViewStyle,testhooks:{id:"global-notification-container"}},A(e))}))},PtYj:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return g}));var r=n("3/02"),a=n("Lyxw"),i=n("w1eR"),o=n("uNu9"),s=n("GYEz"),c=n("69Qu"),l=n("iZ7K"),u=n("3hnk"),d=n("arV0");function p(e,t){if(!t)return!1;const n=Object(u.e)(e,"1cd608fd-160c-45e5-9aee-52e8066e9ef6",3),d=Object(s.a)(e)===i.a.MailApp,p=!Object(c.b)(e),g=Object(s.a)(e)===i.a.MobileApplication,h=Object(l.h)(e,t),f=Object(a.c)(e,r.k),m=h&&h.IsCustomizable&&null!=h.IsAuditEnabled&&h.IsAuditEnabled.CanBeChanged,b=h&&h.IsCustomEntity||function(e){let t=!1;switch(e){case o.a:case o.e:case o.h:case o.i:case o.j:case o.k:case o.l:case o.m:case o.n:case o.o:case o.p:case o.q:case o.r:case o.s:case o.t:case o.u:case o.v:case o.w:case o.x:case o.y:case o.z:case o.B:case o.C:case o.E:case o.D:case o.F:case o.G:case o.H:case o.J:case o.K:case o.P:case o.R:case o.S:case o.T:case o.U:case o.W:case o.X:case o.Y:case o.ab:case o.bb:case o.cb:case o.db:case o.eb:case o.fb:case o.gb:case o.ib:case o.jb:case o.kb:case o.lb:case o.Hb:case o.ob:case o.pb:case o.rb:case o.ub:case o.wb:case o.yb:case o.xb:case o.zb:case o.Bb:case o.Ab:case o.Cb:case o.Db:case o.Eb:case o.Fb:case o.Gb:case o.Jb:case o.Kb:case o.Lb:case o.Mb:case o.Nb:case o.Ob:case o.Pb:case o.Rb:case o.Sb:case o.Tb:case o.Wb:case o.Qb:case o.Xb:case o.Yb:case o.ac:case o.dc:case o.ec:case o.Ib:case o.N:case o.O:case o.Ub:case o.tb:case o.Zb:case o.A:case o.mb:case o.cc:case o.sb:case o.qb:case o.hb:case o.Q:t=!0}return t}(t);return f&&!d&&!p&&!g&&n&&m&&b}function g(e,t,n){let r="";const a=Object(d.g)(e,t);a&&(r=a.entityTypeName);const i=p(e,r);return n&&n.entityName===o.g&&i}},"Py/t":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="update.offline.bpf.entities";function a(e){return{type:r,payload:{offlineBPFEntities:e}}}},Q1Xp:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.default=function e(t){for(var n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];for(var s=0,c=i.length;s<c;++s){var l=i[s];for(var u in l){var d=l[u],p=t[u];if("object"===(void 0===p?"undefined":r(p))){if(Array.isArray(p)){Array.isArray(d)?t[u]=[].concat(a(p),a(d)):t[u]=[].concat(a(p),[d]);continue}if("object"===(void 0===d?"undefined":r(d))&&!Array.isArray(d)){t[u]=e({},p,d);continue}}t[u]=d}}return t},e.exports=t.default},Q7Xa:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t,n){this._entity=null,this._operationPerformed=0,this._entityType=null,this._entity=e,this._operationPerformed=t,this._entityType=n}get_entity(){return this._entity}get_operationPerformed(){return this._operationPerformed}get_entityType(){return this._entityType}}},QA8j:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.LearningPathAttributeSuffix="lp-id",e.LearningPathAttributeName="data-"+e.LearningPathAttributeSuffix,e.CCF="CustomControlFramework",e}()},QARO:function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return p}));var r=n("sclX"),a=n("LzVy"),i=n("zVFX"),o=n("Lyxw"),s=n("3/02"),c=n("0kGT"),l=n("AVDU"),u=n("SV62");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let d=!1;function p(){return d}function g(){return{diagnosticName:"FontSize",boot:(e,t,n)=>{const p=n.getState(),g=Object(a.a)(p),h=Object(o.c)(p,s.gb),f=Object(l.b)(p);if(g===r.b.Native?Object(c.b)(p)?h&&Object(i.f)():(document.documentElement.style.fontSize="initial",h&&Object(i.d)()):h&&Object(i.f)(),g===r.b.Web||f){const e=Object(o.c)(p,s.Kc),t=Object(u.a)(p);e&&Object(i.e)(t)}d=!0}}}},QBtP:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("nuS9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a=r.createContext({}),i=r.createContext({})},QFnk:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");class a extends r.a{constructor(e,t){super(),this._target=null,this._principal=null,this._target=e,this._principal=t}get_name(){return"RetrievePrincipalAccess"}get_target(){return this._target}get_principal(){return this._principal}}},QFtu:function(e,t,n){"use strict";n.d(t,"o",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"n",(function(){return s})),n.d(t,"m",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"l",(function(){return d})),n.d(t,"k",(function(){return p})),n.d(t,"g",(function(){return g})),n.d(t,"f",(function(){return h})),n.d(t,"b",(function(){return f})),n.d(t,"i",(function(){return m})),n.d(t,"j",(function(){return b}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="UCISessionID",a="ErrorMessage",i="ActionName",o="EntityName",s="SyncResultMessageType",c="SyncResultMessage",l="Database",u="IsFirstTimeSync",d="SyncResultErrorCode",p="ModelJson",g="IsDssOfflineEnabled",h="IsApplicationMetadataDownloadInShimEnabled",f="ApplyApplicationMetadataChangeComplete",m="IsForcedSync",b="IsImmediateOfflineDataSync"},QGYZ:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return g})),n.d(t,"f",(function(){return h})),n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return d}));var r=n("FoFY"),a=n("zsAz"),i=n("oT5e"),o=n("arV0"),s=n("FJpk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e){return e.tabs}function l(e){const t=c(e);return Object.keys(t).length}function u(e,t){if(!e.tabs[t])throw Object(a.d)("Tab does not exist",2415919109,[{name:"tabId",value:t}]);return e.tabs[t]}function d(e,t){const n=c(e),r=Object.keys(n).find(e=>e===t);return r?n[r]:null}function p(e,t){if(!t)return null;const n=u(e,t);if(n.isTitleStatic)return n.title;const r=Object(i.a)(e,t),a=Object(o.j)(e,r.pageId);return a?Object(s.c)(a):""}function g(e,t){if(!t)return null;return Object(r.a)(e,t).tabs.map(t=>u(e,t))}function h(e,t){const n=g(e,t);return n&&n.length}},"QHx/":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("oT5e");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,n){const a=Object(r.b)(e,t);return{source:n,targetBrowsingContext:a&&a.id}}},QJW6:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return a}));var a=function(){function e(){this._disablingScrollStyle=!1,this._popupCount=0}return e.getInstance=function(){return r||(r=new e),r},e.prototype.seeMoreOpen=function(){this._popupCount++,this.setDisableScrollStyle(!0)},e.prototype.seeMoreClose=function(){this._popupCount--,this.setDisableScrollStyle(!1)},e.prototype.getPopupCount=function(){return this._popupCount},e.prototype.getDisableScrollStyle=function(){return this._disablingScrollStyle},e.prototype.setDisableScrollStyle=function(e){if(this._disablingScrollStyle!==e){this._disablingScrollStyle=e;for(var t=document.querySelectorAll(e?".webkitScroll":".webkitScrollAuto"),n=0;n<t.length;n++)e?(t[n].classList.add("webkitScrollAuto"),t[n].classList.remove("webkitScroll")):(t[n].classList.add("webkitScroll"),t[n].classList.remove("webkitScrollAuto"));var r=document.querySelectorAll(e?".forceNewStackContext":".forceNewStackContextInert");for(n=0;n<r.length;n++)e?(r[n].classList.add("forceNewStackContextInert"),r[n].classList.remove("forceNewStackContext")):(r[n].classList.add("forceNewStackContext"),r[n].classList.remove("forceNewStackContextInert"))}},e}()},QMfC:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("kWiz"),a=n("pEXn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i={[r.a.Error]:4,[r.a.Warning]:3,[r.a.Info]:1,[r.a.Verbose]:2};function o(e){const t=e.getEventName(),n=e.getEventParameter(a.b.ApplicationEventLevel).value;if(n)return n;switch(t){case a.B.Name:const t=e.getEventParameter(a.B.TraceLevel).value;return i[r.a.fromString(t)]||1;case a.y.Name:case a.s.Name:return 4;case a.x.Name:case a.u.Name:case a.A.Name:default:return 1}}},QRGJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("eeMP"),a=n("SAYH"),i=n("Xe7f"),o=n("WRF3"),s=n("fVHw"),c=n("iZ7K"),l=n("16wZ"),u=n("Uv1Y");function d(e,t){return{type:"DESERIALIZE_CREATE_RESPONSE_ASYNC",async execute({dispatch:n,getState:d},p){const g=t instanceof i.a&&!Object(l.a)(t.get_target())&&!Object(l.a)(t.get_target().get_identifier())?t.get_target().get_identifier().LogicalName:t.etn;if(void 0===g){!function(e,t,n,r){const a=[];a.push({name:"CallStack",value:(new Error).stack}),a.push({name:"RequestObjectKeys",value:JSON.stringify(Object.keys(n))}),a.push({name:"ResponseStatus",value:r.status}),a.push({name:"ResponseStatusText",value:r.statusText});t.TraceManager.getTracer("CreateResponseDeserializer").error(e,a);throw new u.a(e,void 0,void 0,void 0,void 0,void 0,void 0,a)}("Unable to determine logicalname for deserializing response for the Create request.",p,t,e)}const h=Object(c.h)(d(),g).PrimaryIdAttribute,f=await Object(r.a)(h,e),m=a.a.toLegacyGuid(f),b=new o.a(g,m,null,Object(r.d)(e));return new s.a(m,b)}}}},"QT+q":function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="contextualHelp",a=340,i=5},QVDB:function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var r=n("nuS9"),a=n("YWpA"),i=n("H/hG"),o=n("evW+"),s=n("wipL"),c=n("Afz2"),l=n("FhVi"),u=n("3rse"),d=n("nJrx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const p=Object(d.a)(),g=Object(d.a)(),h={margin:"auto"};function f(e,t){return{display:"flex",flexDirection:"column",alignSelf:"flex-end",justifyContent:"flex-end",margin:"auto",boxSizing:"border-box",padding:t?e.sizes.Measures.Measure100:e.sizes.Measures.Measure150,width:"40rem",maxWidth:"100vw",maxHeight:"80vh",border:e.borders.Border01,boxShadow:e.shadows.Shadow01,backgroundColor:e.colors.BaseColor.White}}function m(e){const t={lineHeight:e.sizes.Measures.Measure250,position:"relative"};return Object.assign(Object.assign({},e.buttons.ActionIconButton01),t)}function b(e){return{color:e.colors.BaseColor.Grey.Grey6,fontSize:e.fontSizes.Font100,textAlign:"center"}}class _ extends r.Component{constructor(e){super(e),this._onClickHandler=this._onClickHandler.bind(this),this._onKeyDownHandler=this._onKeyDownHandler.bind(this)}componentDidMount(){document.addEventListener("keydown",this._onKeyDownHandler)}componentWillUnmount(){document.removeEventListener("keydown",this._onKeyDownHandler)}_onKeyDownHandler(e){e.keyCode===u.a.Escape&&(e.stopImmediatePropagation(),this._onClickHandler())}_onClickHandler(){this.props.onOkHandler&&this.props.onOkHandler()}render(){if(!this.props.errorPopupDescriptor)return null;const{theme:e,isViewportSmall:t}=this.props,n=Object.assign(Object.assign({},e.buttons.Button01Primary),function(e,t){return{alignSelf:t?"stretch":"flex-end",flexShrink:0,marginTop:e.sizes.Measures.Measure125}}(e,t));return this._previousTheme!==this.props.theme&&(this._previousTheme=this.props.theme,this._closeButtonDescriptor={closeErrorPopup:this._onClickHandler,errorPopupCloseIconButtonStyle:m(e),errorPopupCloseIconStyle:b(e)}),r.createElement(a.a,{id:p,style:f(e,t),role:c.b,labelledByElementId:s.b,describedByElementId:s.a},r.createElement(l.a,{key:"errorPopupAccessibility",rootElementId:p,isModal:!0,defaultFocusId:g,overrideFocusId:g,shouldManageFocus:!0}),r.createElement(s.c,{errorDescriptor:this.props.errorPopupDescriptor,inlineDisplay:!0,closeButtonDescriptor:this._closeButtonDescriptor}),r.createElement(o.a,{key:"basic-error-okButton",id:g,onClick:this._onClickHandler,style:n,accessibilityLabel:this.props.okButtonLabel},r.createElement(i.a,{style:h},this.props.okButtonLabel)))}}},QXIS:function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return c}));var r=n("Lyxw"),a=n("3/02"),i=n.p+"scripts/intersection-observer.js?v=1.4.9962-v91onpremise";class o{constructor(){this._observerMap=new Map}set(e,t){this._observerMap.set(e,t)}delete(e){this._observerMap.delete(e)}intersectAll(e){const t=this._observerMap.get(e);t&&t.intersectAll()}}class s{constructor(e){this._callback=e}observe(e){setTimeout(()=>{this._callback([{isIntersecting:!0,target:e}])},0)}unobserve(e){}disconnect(){}}class c{constructor(e,t,n){this._observedComponentsMap=new Map,this._observer=n?new IntersectionObserver(this._callback.bind(this),e):new s(this._callback.bind(this)),this._eventManager=t}unobserve(e){const t=e.getDomId();if(t){const e=document.getElementById(t);e&&this._observer.unobserve(e),this._observedComponentsMap&&this._observedComponentsMap.delete(t)}}observe(e){const t=e.getDomId();if(t){const n=document.getElementById(t);n&&(this._observedComponentsMap.set(t,e),this._observer.observe(n))}}cleanup(){this._observedComponentsMap.clear(),this._observer.disconnect()}intersectAll(){this._observedComponentsMap.forEach(this._unobserve.bind(this))}_unobserve(e){return!!e&&(e.intersecting(),this.unobserve(e),!0)}_callback(e){e.forEach(e=>{if(e&&e.target&&e.isIntersecting){const t=this._observedComponentsMap.get(e.target.id);this._unobserve(t)||this._sendTelemetry(e.target,"IntersectionObserver.callback")}})}_sendTelemetry(e,t){if(this._eventManager&&this._eventManager.ReportComponentSuccess){const n=[];if(e){const t=e.attributes?e.attributes.getNamedItem("data-id"):null;n.push({name:"elementDataId",value:t?t.value:null})}"IntersectionObserver.callback"!==t?this._eventManager.ReportComponentSuccess(t,n):this._eventManager.ReportComponentFailure(t,n)}}}const l="IntersectionObserver"in window,u="IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype&&"isIntersecting"in window.IntersectionObserverEntry.prototype,d=!l||u;function p(){return{diagnosticName:"IntersectionObserver.boot",boot:(e,t,n)=>{t.IntersectionObserverManager=new o;Object(r.c)(n.getState(),a.Q)&&!l&&t.AssetLoader.loadScript(i).catch(e=>{t.TraceManager.getTracer("IntersectionObserver.boot").error("Failed to load script: "+i)})}}}},QbIY:function(e,t,n){"use strict";n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return h}));var r=n("RiEM"),a=n("fWyz"),i=n("D+Bz"),o=n("0FMG"),s=n("GPkz"),c=n("qu3G"),l=n("qUtK"),u=n("AVDU"),d=n("uZvv"),p=n("3cEW");function g(){return{type:"sitemap.navgatetohome.async",execute:(e,t)=>(s.a.session&&s.a.session.addEvent(c.a.navigateToHome),e.dispatch(h()))}}function h(e){return{type:"load.default.page",execute:(t,n)=>t.dispatch(Object(l.a)()).then(()=>{const n=t.getState(),s=Object(r.e)(n);s&&t.dispatch(Object(o.d)(s));const c=Object(r.b)(n);return e||(e={source:i.b.SiteMap}),t.dispatch(Object(a.c)(c,!0,()=>{Object(u.e)(n)&&1===Object(d.d)(n)&&t.dispatch(Object(p.b)())},e))})}}},QiMq:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="form.updatevisitedtabnames";function a(e,t){return{type:r,payload:t,meta:{pageId:e}}}},Qjw6:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b}));var r=n("SAYH"),a=n("odYE"),i=n("cfbi"),o=n("pEXn"),s=n("Lohl"),c=n("fILV"),l=n("uNu9"),u=n("sYIp"),d=n("zsAz"),p=n("TBkx"),g=n("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const h=[l.b,l.Ab];function f(e,t){return t?Promise.all([n.e(2),n.e(6),n.e(0),n.e(1),n.e(3),n.e(4),n.e(5),n.e(8),n.e(7),n.e(61)]).then(n.bind(null,"CJeC")).then(({MainFormDialog:t})=>new t(e)):Promise.all([n.e(2),n.e(6),n.e(0),n.e(1),n.e(3),n.e(4),n.e(5),n.e(8),n.e(7),n.e(61)]).then(n.bind(null,"CJeC")).then(({EditForm:t})=>new t(e))}const m={getName:()=>i.a,getRequiredAttributes(){throw new Error("Not Implemented")},throwIfInvalidUrl(e){if(!e||!e.entityTypeName)throw Object(d.d)("Missing required URL parameter: etn",p.a)},preInitializePage(e){const{formId:t,entityTypeName:n,id:i,isPreview:o}=e,c=new a.a(n,i);return{type:"preInitialize.editFormAction.async",execute:({dispatch:n,getState:a},i,l)=>{const d=i.TraceManager.getTracer(g.c),p=this.getTelemetryAttributes(e);return d.info("preInitializePage started.",p),o?Object(u.a)().then(({retrievePreviewForm:e})=>n(e()).then(e=>({updatedFormId:e,error:void 0})).catch(e=>({error:e,updatedFormId:void 0}))):n(Object(s.b)(c,t,void 0)).then(e=>(d&&(p.push({name:"updatedFormId",value:r.a.toString(e)}),d.info("preInitializePage completed.",p)),e===s.a?{updatedFormId:e,error:void 0,noFormsFound:!0}:{updatedFormId:e,error:void 0})).catch(e=>(d&&(p.push({name:"error",value:e&&e.toString()}),d.error("preInitializePage failed.",p)),{error:e,updatedFormId:void 0}))}}},createPageModule:e=>f(e,!1),getTelemetryAttributes:e=>[{name:o.b.EntityName,value:e&&e.entityTypeName},{name:"entityId",value:e&&r.a.toString(e.id)},{name:o.b.FormId,value:e&&r.a.toString(e.formId)},{name:"isPreview",value:e&&e.isPreview}],getKeyForThawedCheck(e){const t=e.formId?e.formId.guid:"";return e.entityTypeName+t},getPredictedPageInput(e,t){if(e===c.a){const e=t;if(-1===h.indexOf(e.entityTypeName))return{entityTypeName:e.entityTypeName,id:r.a.EMPTY}}return null}};Object.freeze(m);const b=Object.assign(Object.assign({},m),{getName:()=>i.b,createPageModule:e=>f(e,!0)});Object.freeze(b)},Qn2w:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="form.invalidControls";function i(e,t,n,i){const o=Object(r.v)(i);return{type:a,payload:{controlName:t,isValid:n},meta:{pageId:e,controlName:t,contextKey:o}}}},Qois:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.GenericError=0]="GenericError",e[e.FilePickerErrorFileSizeBreached=-2147205624]="FilePickerErrorFileSizeBreached",e[e.FilePickerErrorAttachmentTypeBlocked=-2147205623]="FilePickerErrorAttachmentTypeBlocked",e[e.FeatureNotEnabled=-2147094027]="FeatureNotEnabled",e[e.ServiceNotSupported=-2147094026]="ServiceNotSupported",e[e.ServiceAndOperationNotSupported=-2147094025]="ServiceAndOperationNotSupported",e[e.PluginCancelled=-2147094024]="PluginCancelled",e[e.NoApplicableAppFound=-2147094023]="NoApplicableAppFound",e[e.GetGeoLocationFailed=-2147094020]="GetGeoLocationFailed",e[e.BarCodeCaptureFailed=-2147094019]="BarCodeCaptureFailed",e[e.AudioCaptureFailed=-2147094018]="AudioCaptureFailed",e[e.VideoCaptureFailed=-2147094017]="VideoCaptureFailed",e[e.CameraCaptureFailed=-2147094016]="CameraCaptureFailed",e[e.FilePickerErrorFileSizeCannotBeZero=-2147094010]="FilePickerErrorFileSizeCannotBeZero",e[e.FilePickerErrorUnableToOpenFile=-2147094009]="FilePickerErrorUnableToOpenFile",e[e.GetPhotoFromGalleryFailed=-2147094008]="GetPhotoFromGalleryFailed",e[e.SaveDataFileErrorOutOfSpace=-2147094007]="SaveDataFileErrorOutOfSpace",e[e.OpenDocumentErrorCodeUnableToFindTheDataId=-2147094005]="OpenDocumentErrorCodeUnableToFindTheDataId",e[e.OpenDocumentErrorCodeGeneric=-2147094004]="OpenDocumentErrorCodeGeneric",e[e.BeginSecureSessionSilentFailed=-2147094006]="BeginSecureSessionSilentFailed"}(r||(r={}))},Qqgh:function(e,t,n){"use strict";function r(e){if(!e)return null;var t={};return t.display=e.display?e.display:"flex",t}function a(e){return!e||"flex"!==e&&"inlineflexbox"!==e?"":"flex"===e?"flexbox":"inlineflexbox"}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},Qu5s:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("eeMP"),a=n("XgcG"),i=n("RiLc"),o=n("JdSN"),s=n("V482");function c(e,t){return{type:"DESERIALIZE_EXECUTE_MULTIPLE_RESPONSE_ASYNC",execute({dispatch:n,getState:c},l){const u=l.DataSource.get_WebAPIService();return Object(r.b)(e).then(e=>{const r=e.map((e,r)=>{if(!e.ok)return e.json().then(n=>{let a;a=n.error?n.error:{code:e.status+"",message:e.statusText};const c=i.b.parseFromJsonRecord(a);if(t.get_settings().get_continueOnError())return new s.a(c,r,null);{const e=new o.a(null,null,null);throw e.set_organizationServiceFault(c),e}});const a=t.get_requests()[r],c=u.responseDeserializers[a.get_name()];return n(c(e,a)).then(e=>new s.a(null,r,e))});return Promise.all(r).then(e=>new a.a(!1,e))})}}}},Qwz5:function(e,t,n){"use strict";n.d(t,"b",(function(){return F})),n.d(t,"c",(function(){return k})),n.d(t,"d",(function(){return L})),n.d(t,"a",(function(){return B}));var r,a=n("84PK"),i=n("504W"),o=n("tHaS"),s=n("6zk2"),c=n("HYaY"),l=n("WRF3"),u=n("IvgJ"),d=n("sdkC");!function(e){e[e.none=0]="none",e[e.related=1]="related",e[e.extended=2]="extended"}(r||(r={}));var p=n("IVVt"),g=n("5NWd"),h=n("MUIu"),f=n("AWUt");var m=n("6G9J"),b=n("RIwK"),_=n("XjOj"),y=n("Div0");var v=n("MQpb");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var S=n("c7Og"),O=n("wMH2"),C=n("bEud"),E=n("g73c"),I=n("YhOF"),w=n("VJwX"),j=n("Jz2d");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function P(e){let t=null,n=null,r=C.a.unknown;for(let t=0,a=e.childNodes.length;t<a;t++){const a=e.childNodes[t];if(a.namespaceURI===j.a.xrm2011ContractsNamespace&&a.firstChild){switch(Object(w.b)(a.nodeName)){case"SchemaName":n=a.firstChild.nodeValue;break;case"PrimaryEntityRole":"true"!==a.getAttribute("i:nil")&&(r=Object(E.a)(C.a,a.firstChild.nodeValue))}}}return n&&(t=new I.a(n,r)),t}var T=n("jZCH"),N=n("67s4"),A=n("Z6YS"),D=n("Cjdz");function R(e){let t='<a:RelatedEntities xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">';if(function(){const e=T.a.get_DefaultInstance().get_UserContext();if(Object(i.a)(e)||Object(i.a)(e.get_FCBContext())||!("TaskBasedFlow"in e.get_FCBContext()))return!1;return e.get_FCBContext().TaskBasedFlow.get_value()}()){const n=new Sys.StringBuilder;for(const t of e.get_entityCollections()){const e=t.get_value();if(!Object(i.a)(e)&&e.get_count()>0){const r=e.get_entities().filter(e=>e.isDirty());if(r.length>0){n.append("<a:KeyValuePairOfRelationshipEntityCollectionX_PsK4FkN>"),n.append("<b:key>"),t.get_key().get_primaryEntityRole()!==C.a.unknown&&n.append("<a:PrimaryEntityRole>"+Object(w.a)(C.a,t.get_key().get_primaryEntityRole())+"</a:PrimaryEntityRole>"),n.append("<a:SchemaName>"+Object(b.b)(t.get_key().get_schemaName())+"</a:SchemaName>"),n.append("</b:key>");const a=new O.a(r,e.get_moreRecords(),e.get_totalRecordCount(),e.get_totalRecordCountLimitExceeded(),e.get_query(),e.get_clientRetrieveOptions());n.append("<b:value>"+Object(D.b)(a)+"</b:value>"),n.append("</a:KeyValuePairOfRelationshipEntityCollectionX_PsK4FkN>")}}}t+=n.toString()}return t+="</a:RelatedEntities>",t}var x=n("NA3N"),M=n("WF3G");function F(e,t){return k(e.get_domParserElement(),t)}function k(e,t){if(!e.childNodes.length)return null;const n={},r={},s={};let p=null,g=null,m=null;for(let t=0,n=e.childNodes.length;t<n;t++){const n=e.childNodes[t];if(n.namespaceURI===j.a.xrm2011ContractsNamespace){switch(Object(w.b)(n.nodeName)){case"Id":p=n.textContent;break;case"LogicalName":g=n.firstChild.nodeValue;break;case"RelatedEntities":m=n}}}p||(p=a.a.get_empty().toString());const b=new l.a(g,new a.a(p));!function(e,t,n,r){let s=null,c=null;for(let t=0,n=e.childNodes.length;t<n;t++){const n=e.childNodes[t];if(n.namespaceURI===j.a.xrm2011ContractsNamespace){switch(Object(w.b)(n.nodeName)){case"Attributes":s=n;break;case"FormattedValues":c=n}}}(function(e,t,n){for(let r=0,s=e.childNodes.length;r<s;r++){const s=e.childNodes[r];if(s.namespaceURI===j.a.xrm2011ContractsNamespace&&"KeyValuePairOfstringanyType"===Object(w.b)(s.nodeName)){let e=null,r=null;for(let t=0,n=s.childNodes.length;t<n;t++){const n=s.childNodes[t];if(n.namespaceURI===A.a.genericCollectionsNamespace){switch(Object(w.b)(n.nodeName)){case"key":e=n.firstChild.nodeValue;break;case"value":r=n}}}if(!e||!r)continue;let c=r.getAttribute("i:type");if(V(r,c))continue;let l=U(c),d=null;if("aliasedvalue"===l){let e=null,t=null;for(let n=0,a=r.childNodes.length;n<a;n++){const a=r.childNodes[n];if(a.namespaceURI===j.a.xrm2011ContractsNamespace){switch(Object(w.b)(a.nodeName)){case"EntityLogicalName":e=a.firstChild.nodeValue;break;case"AttributeLogicalName":t=a.firstChild.nodeValue;break;case"Value":r=a}}}if(!e||!t||!r)continue;if(c=r.getAttribute("i:type"),V(r,c))continue;l=U(c),d=new o.a(e,t,l)}if("unknown"!==l){let o=null;switch(l){case"lookup":o=Object(f.b)(r);break;case"partylist":o=Object(D.a)(r,M.a.get_empty());break;case"datetime":o=Object(h.a)(r);break;case"uniqueidentifier":o=Object(i.a)(r.firstChild)||Object(i.b)(r.firstChild.nodeValue)?a.a.get_empty():new a.a(r.textContent);break;case"integer":Object(i.a)(r.firstChild)||Object(i.b)(r.firstChild.nodeValue)||(o=parseInt(r.firstChild.nodeValue,10));break;case"boolean":if(!Object(i.a)(r.firstChild)&&!Object(i.b)(r.firstChild.nodeValue)){o=Boolean.parse(r.firstChild.nodeValue)?new u.a(null,1,-1,-1,null,null,null):new u.a(null,0,-1,-1,null,null,null)}break;case"money":o=parseFloat(z(r));break;case"decimal":case"double":Object(i.a)(r.firstChild)||Object(i.b)(r.firstChild.nodeValue)||(o=parseFloat(r.firstChild.nodeValue));break;case"status":case"state":case"picklist":o=new u.a(null,parseInt(z(r),10),-1,-1,null,null,null);break;case"multiselectpicklist":o=W(r);break;default:o=Object(i.a)(r.firstChild)?null:r.firstChild.nodeValue}Object(i.a)(o)||(Object(i.a)(d)?(t[e]=o,n[e]=l):(d.set_value(o),t[e]=d,n[e]="aliasedvalue"))}}}})(s,t,n),Object(i.a)(c)||function(e,t,n,r){for(let a=0,o=e.childNodes.length;a<o;a++){const o=e.childNodes[a];if(o.namespaceURI===j.a.xrm2011ContractsNamespace&&"KeyValuePairOfstringstring"===Object(w.b)(o.nodeName)){let e=null,a=null;for(let t=0,n=o.childNodes.length;t<n;t++){const n=o.childNodes[t];if(n.namespaceURI===A.a.genericCollectionsNamespace){switch(Object(w.b)(n.nodeName)){case"key":e=n;break;case"value":a=n}}}if(!Object(i.a)(e)&&!Object(i.a)(a)){const o=e.firstChild.nodeValue;if(!Object(i.b)(o)&&o in t){if(o in n){let e,r=n[o],s=null;"aliasedvalue"===r&&(s=t[o],r=s.get_attributeType()),"picklist"!==r&&"boolean"!==r&&"state"!==r&&"status"!==r&&r||(e=s?s.get_value():t[o],Object(i.a)(a.firstChild)||e.set_Label(a.firstChild.nodeValue))}Object(i.a)(a.firstChild)||(r[o]=a.firstChild.nodeValue)}}}}}(c,t,n,r)}(e,n,r,s);let _=null;return _=m?function(e,t,n){let r=null;if(!Object(i.a)(n)){r=new Array(n.length);for(let t=0;t<n.length;t++)r[t]=new N.a(n[t].get_key(),e,n[t].get_value())}const a=[];for(let e=0,n=t.childNodes.length;e<n;e++){const n=t.childNodes[e];if(n.nodeName.indexOf("KeyValuePairOfRelationshipEntityCollection")<0)return new d.a(a);let o=null,s=null;for(let e=0,t=n.childNodes.length;e<t;e++){const t=n.childNodes[e];if(t.namespaceURI===A.a.genericCollectionsNamespace)switch(Object(w.b)(t.nodeName)){case"key":o=t;break;case"value":s=t}}if(!o)continue;const c=P(o);if(c&&s){let e=null;if(!Object(i.a)(r))for(const t of r)if(t.get_relationship().toString()===c.toString()){e=t;break}const t=Object(D.a)(s,e);a.push(new S.a(c,t))}}return new d.a(a)}(b,m,t):new d.a(new Array(0)),"email"===b.LogicalName&&"safedescription"in n&&"description"in n&&(n.description=n.safedescription),new c.a(b,n,r,s,{},_)}function L(e,t){Object(i.a)(t)&&(t=!0);const n=e.get_actionableIdentifier();return(t?String.format('<entity xmlns:a="{0}" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">',j.a.xrm2011ContractsNamespace):"")+function(e){let t='<a:Attributes xmlns:b="'+A.a.genericCollectionsNamespace+'">';for(const n of e.get_changedFieldNames())Object(i.b)(n)||(t+=B(n,e.getValue(n),e.get_fieldTypes()[n]));return t+="</a:Attributes>",t}(e)+'<a:EntityState i:nil="true"/>'+String.format('<a:FormattedValues xmlns:b="{0}"/>',A.a.genericCollectionsNamespace)+(n.Id.equals(a.a.get_empty())?"":"<a:Id>"+Object(b.b)(n.Id.toString())+"</a:Id>")+"<a:LogicalName>"+Object(b.b)(n.LogicalName)+"</a:LogicalName>"+(e.hasField("versionnumber")&&!Object(i.a)(e.getValue("versionnumber"))?"<a:RowVersion>"+Object(b.b)(e.getValue("versionnumber").toString())+"</a:RowVersion>":"")+R(e.get_relatedEntities())+(t?"</entity>":"")}function B(e,t,n,a,o){"unknown"!==n?a=function(e){switch(e){case"string":case"memo":case"entityname":return"c:string";case"integer":return"c:int";case"uniqueidentifier":return"c:guid";case"datetime":return"c:dateTime";case"boolean":return"c:boolean";case"customer":case"lookup":case"owner":return"a:EntityReference";case"picklist":case"state":case"status":return"a:OptionSetValue";case"aliasedvalue":return"a:AliasedValue";case"money":return"a:Money";case"decimal":return"c:decimal";case"double":return"c:double";case"partylist":return"a:EntityCollection";case"multiselectpicklist":return"c:OptionSetValueCollection";default:throw Error.create("field type is not supported: "+e)}}(n):n=U(a),Object(i.a)(o)&&(o=function(e){switch(e){case"string":case"datetime":case"decimal":case"double":case"boolean":case"integer":case"memo":case"entityname":return'xmlns:c="http://www.w3.org/2001/XMLSchema"';case"uniqueidentifier":return'xmlns:c="http://schemas.microsoft.com/2003/10/Serialization/"';default:return""}}(n));let c="<a:KeyValuePairOfstringanyType>";if(c+="<b:key>"+Object(b.b)(e)+"</b:key>",Object(i.a)(t))c+='<b:value i:nil="true" />';else{switch(c+='<b:value i:type="'+a+'"'+function(e){if("c:ConcurrencyBehavior"===e)return' xmlns:c="http://schemas.microsoft.com/xrm/7.1/Contracts"';if("c:OptionSetValueCollection"===e)return' xmlns:c="http://schemas.microsoft.com/xrm/9.0/Contracts"';return""}(a),Object(i.b)(o)||(c+=" "+o),c+=">",n){case"customer":case"lookup":case"owner":c+=Object(f.c)(t);break;case"datetime":c+=Object(h.c)(t);break;case"boolean":let e;try{e="boolean"==typeof t?t.toString():(t.get_value()>0).toString()}catch(n){e=("1"===t.toString()).toString()}c+=e;break;case"integer":c+=t.toString();break;case"status":case"state":case"picklist":if("string"==typeof t)c+="<a:Value>"+t+"</a:Value>";else{c+="<a:Value>"+("number"==typeof t?t:t.get_value()).toString()+"</a:Value>"}break;case"multiselectpicklist":if(!Object(i.a)(t)){const e=t.split(",");for(let t=0;t<e.length;t++)c+=`<c:OptionSetValue><a:Value>${e[t].trim()}</a:Value></c:OptionSetValue>`}break;case"uniqueidentifier":c+=Object(b.b)(t.toString());break;case"money":c+="<a:Value>"+t.toString()+"</a:Value>";break;case"partylist":c+=Object(D.b)(t);break;case"unknown":c+=function(e,t){if("a:FetchExpression"===e)return"<a:Query>"+Object(b.b)(t)+"</a:Query>";if("c:QueryByEntityNameDictionary"===e)return function(e){const t=new Sys.StringBuilder;for(const n in e){const r={key:n,value:e[n]};t.append("<c:KeyValuePairOfstringQueryBasegUGIFE1S>"),t.append("<b:key>"+Object(b.b)(r.key)+"</b:key>"),t.append('<b:value i:type="a:FetchExpression"><a:Query>'+Object(b.b)(r.value)+"</a:Query></b:value>"),t.append("</c:KeyValuePairOfstringQueryBasegUGIFE1S>")}return t.toString()}(t);if("c:InputArgumentCollection"===e)
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
return function(e){const t=new Sys.StringBuilder;t.append("<c:Arguments>");for(const n in e){const r={key:n,value:e[n]};let a;r.value instanceof String?a="string":(r.value instanceof Number||Object(_.j)(y.a.storage,"InputArgumentCollectionSerializer supports only integer and string types, need to enable support if any other type is specified"),a="int"),t.append("<b:KeyValuePairOfstringanyType>"),t.append("<b:key>"+Object(b.b)(r.key)+"</b:key>"),t.append('<b:value xmlns:c="http://www.w3.org/2001/XMLSchema" i:type="c:'+a+'">'+Object(b.b)(r.value.toString())+"</b:value>"),t.append("</b:KeyValuePairOfstringanyType>")}return t.append("</c:Arguments>"),t.toString()}(t);if("a:ColumnSet"===e)return Object(g.b)(t);if("a:Entity"===e)return L(t,!1);if("a:OrganizationRequestCollection"===e||"c:OrganizationRequestCollection"===e)return Object(v.b)(t);if("a:ExecuteMultipleSettings"===e||"c:ExecuteMultipleSettings"===e)return Object(m.b)(t);if("a:RelationshipQueryCollection"===e)return Object(x.b)(t);if("a:TargetFieldType"===e)return Object(w.a)(p.a,t);if("a:Relationship"===e)return function(e){let t="";return Object(i.a)(e.get_primaryEntityRole())||e.get_primaryEntityRole()===C.a.unknown||(t+="<a:PrimaryEntityRole>"+Object(w.a)(C.a,e.get_primaryEntityRole())+"</a:PrimaryEntityRole>"),t+="<a:SchemaName>"+Object(b.b)(e.get_schemaName())+"</a:SchemaName>",t}(t);if("a:EntityReferenceCollection"===e)return function(e){const t=new Sys.StringBuilder;for(const n of e)t.append("<a:EntityReference>"),t.append(Object(f.c)(n)),t.append("</a:EntityReference>");return t.toString()}(t);if("sa:ArrayOfstring"===e)return function(e){let t="";for(const n of e)t+="<sa:string>"+Object(b.b)(n)+"</sa:string>";return t}(t);if("a:RollupType"===e)return Object(w.a)(r,t);if("c:ConcurrencyBehavior"===e)return Object(w.a)(s.a,t);return Object(b.b)(t)}(a,t);break;default:c+=Object(b.b)(t)}c+="</b:value>"}return c+="</a:KeyValuePairOfstringanyType>",c}function U(e){switch(e=e.substr(e.indexOf(":")+1)){case"AliasedValue":return"aliasedvalue";case"boolean":return"boolean";case"dateTime":return"datetime";case"decimal":return"decimal";case"double":return"double";case"EntityCollection":return"partylist";case"EntityReference":return"lookup";case"guid":return"uniqueidentifier";case"int":return"integer";case"Money":return"money";case"OptionSetValue":return"picklist";case"OptionSetValueCollection":return"multiselectpicklist";case"string":return"string";default:return"unknown"}}function V(e,t){return!!Object(i.b)(t)&&"true"===e.getAttribute("i:nil")}function z(e){let t=null;return Object(i.a)(e.firstElementChild)||Object(i.a)(e.firstElementChild.firstChild)||Object(i.b)(e.firstElementChild.firstChild.nodeValue)?Object(i.a)(e.firstChild)||Object(i.a)(e.firstChild.firstChild)||Object(i.b)(e.firstChild.firstChild.nodeValue)||(t=e.firstChild.firstChild.nodeValue):t=e.firstElementChild.firstChild.nodeValue,t}function W(e){const t=[];if(!Object(i.a)(e))for(let n=0,r=e.childNodes.length;n<r;n++)Object(i.a)(e.childNodes[n])||t.push(parseInt(e.childNodes[n].firstChild.firstChild.nodeValue,10));return t}},"R+Fp":function(e,t,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,s,c=o(e),l=1;l<arguments.length;l++){for(var u in n=Object(arguments[l]))a.call(n,u)&&(c[u]=n[u]);if(r){s=r(n);for(var d=0;d<s.length;d++)i.call(n,s[d])&&(c[s[d]]=n[s[d]])}}return c}},RADj:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Init=0]="Init",e[e.InSyncWithServer=1]="InSyncWithServer",e[e.SyncPending=2]="SyncPending",e[e.SyncPendingFromServer=3]="SyncPendingFromServer",e[e.SyncPendingFromMiddleware=4]="SyncPendingFromMiddleware",e[e.InProgress=5]="InProgress"}(r||(r={}))},RIJJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the LegacyDialog page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="LegacyDialog"},RIwK:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("504W"),a=n("fU7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e){return Object(r.a)(e)?"":Object(a.CrmXmlAttributeEncode)(e)}function o(e){return Object(r.a)(e)?"":Object(a.CrmXmlEncode)(e)}},RJiR:function(e,t,n){"use strict";n.d(t,"g",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"k",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return g})),n.d(t,"h",(function(){return h})),n.d(t,"e",(function(){return f})),n.d(t,"i",(function(){return m}));var r=n("nuS9"),a=n("KOTC");function i(e){
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
return function(e,t){const n=n=>r.createElement(a.a,{loader:()=>e().then(e=>e[t]),props:n},n.children);return n.displayName=`LoadableComponent(${t})`,n}(()=>Promise.all([n.e(9),n.e(16),n.e(20),n.e(31),n.e(0),n.e(1),n.e(3),n.e(4),n.e(5),n.e(37)]).then(n.bind(null,"0jo4")),e)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 *
 * Use this file to export lazy loaded versions of the UCI react-native components.
 */i("GreetingLabel");const o=i("ProvidePageScrollContext"),s=(i("NavigationBar"),i("StackNavigator")),c=i("ConnectToPageScrollContext"),l=i("NavigationBarPageTitle"),u=i("FillNativeNavigationBar"),d=i("ViewSelector"),p=i("FullScreenModal"),g=i("ConfirmDialog"),h=i("QuickCreateFormWithNativeHeader"),f=i("NativeSubgridCommandbarWrapper"),m=i("QuickFindSearchBar")},RREX:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.attribute=0]="attribute",e[e.organization=1]="organization",e[e.currency=2]="currency"}(r||(r={}))},RVeV:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.DURATION=1]="DURATION",e[e.TIMEZONE=2]="TIMEZONE",e[e.LANGUAGE=3]="LANGUAGE"}(r||(r={}))},RYFF:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("EbwQ"),a=n("sJUk"),i=n("/Ypj"),o=n("ZhaJ"),s=n("504W"),c=n("8uvO");class l extends o.a{constructor(e,t,n){super(),this._batch=null,this._onBatchComplete=null,this._batch=e,this._onBatchComplete=t,this.set_callContext(n)}_get_BatchResult(){return this.getValue(l._BatchResultProperty)}call(){this.get_callContext().logPerfData("SqlDispatcher.OnBatchCompleteCallback.Call.Start",(new Date).getTime());const e=this._get_BatchResult();for(let t=0;t<e.length;++t)if(this._IsErrorResult(e[t])){let n=e[t];Object(s.a)(n.message)&&(n=JSON.parse(e[t].toString())),this._batch.get_ErrorCallbacks()[t](n)}else{let n=e[t];Object(s.a)(n.rows)&&(n=JSON.parse(e[t].toString())),this._batch.get_SuccessCallbacks()[t](n)}this.get_callContext().logPerfData("SqlDispatcher.OnBatchCompleteCallback.Call.End",(new Date).getTime()),this._onBatchComplete(),this._batch=null}_IsErrorResult(e){const t=e;return!Object(s.a)(t.code)}}l._BatchResultProperty=new c.a("sqlBatchResult",Array,l);class u extends a.a{constructor(e,t,n){super(),this._hasBigArgs=!1,this.set_callContext(new i.a(e.get_CallId(),n)),this.get_callContext().logPerfData("SqlDispatcher.CallNativeMethod.Start",(new Date).getTime()),this.setValue(u._StatementBatchProperty,e.get_Statements()),this.setValue(u._ParameterBatchProperty,e.get_Parameters()),this.setValue(u._BatchCompleteCallbackProperty,new l(e,t,this.get_callContext())),this._hasBigArgs=e.get_estimatedSize()>h.bigArgStringLength,this.get_callContext().logPerfData("SqlDispatcher.CallNativeMethod.End",(new Date).getTime())}get_methodName(){return"executeSqlBatch"}get_hasBigArgs(){return this._hasBigArgs}}u._StatementBatchProperty=new c.a("statementBatch",Array,u),u._ParameterBatchProperty=new c.a("parameterBatch",Array,u),u._BatchCompleteCallbackProperty=new c.a("onBatchComplete",l,u);var d=n("m4ji"),p=n("NMtn"),g=n("a475");class h extends r.a{constructor(e){super(e),this.set_perfData({}),this.set_perfDataForCompletedCalls({})}get_namespaceName(){return"CrmSql"}get_dispatcherPerfDataLoggingEnabled(){return g.a.get_Instance().get_application().get_applicationState().get_dispatcherPerfLoggingEnabled()}createBatch(e,t){return new d.a(this,e,t)}getCallIdForSqlBatchExecution(){let e=null;return this.get_dispatcherPerfDataLoggingEnabled()&&(e=(++h._nextSerialNumber).toString(),this.get_perfData()[e]=""),e}ExecuteSqlBatch(e,t){Object(p.b)(e,"batch");const n=new u(e,t,this);n.get_callContext().logPerfData("SqlDispatcher.CallNativeMethod.Start",(new Date).getTime()),this.callNativeMethod(this.get_version().get_currentVersion(),n),n.get_callContext().logPerfData("SqlDispatcher.CallNativeMethod.End",(new Date).getTime())}static CalculateEstimatedSize(e,t){let n=e.length;for(let e=0;e<t.length;++e)t[e]instanceof String&&(n+=t[e].length);return n}}h.bigArgStringLength=256,h._nextSerialNumber=0},Rckk:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r={ACCEPT:"Accept",PREFER:"Prefer",AUTO_DISASSOCIATE:"AutoDisassociate",IF_MATCH:"If-match",MSCRM_SUPPRESS_DUPLICATION_DETECTION:"MSCRM.SuppressDuplicateDetection",MSCRM_RETURN_NOTIFICATIONS:"MSCRM.ReturnNotifications",CLIENT_REQUEST_ID:"x-ms-client-request-id",SERVER_REQUEST_ID:"x-ms-service-request-id",CONTENT_TYPE:"Content-Type",SESSION_ID:"x-ms-client-session-id",ACTIVITY_ID:"x-ms-correlation-id",AUTHORIZATION_HEADER:"Authorization",SOURCE_ID:"x-ms-source-id",USER_AGENT:"x-ms-user-agent",APP_ID:"x-ms-app-id",APP_NAME:"x-ms-app-name",OBJECT_ID:"x-ms-sw-objectid",TENANT_ID:"x-ms-sw-tenantid",VIEW_ID_HINT:"x-ms-mdl-viewId",PAGESIZE_HINT:"x-ms-mdl-pageSize",PAGE_NUMBER_HINT:"x-ms-mdl-pageNumber",SEARCH_HINT:"x-ms-mdl-search",FILTER_HINT:"x-ms-mdl-filter",ORDERBY_HINT:"x-ms-mdl-orderby",SELECT_HINT:"x-ms-mdl-select",LINK_HINT:"x-ms-mdl-link",CONTEXT_FILTER:"x-ms-mdl-contextFilter",EXECUTION_HINT:"x-ms-mdl-execution-hints"},a={APPLICATION_JSON:"application/json",ANNOTATIONS:'odata.include-annotations="*"'},i={OFFLINE:"Offline",ONLINE:"Online",OFFLINE_THEN_ONLINE:"OfflineThenOnline"},o="/api/data/v9.0/",s="appmodules"},RiEM:function(e,t,n){"use strict";n.d(t,"f",(function(){return g})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return h}));var r=n("d6Hx"),a=n("2FbK"),i=n("IqkD"),o=n("GYEz"),s=n("w1eR"),c=n("uZvv");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l="/workplace/home_search_page.aspx";function u(e){const t=Object(a.a)(e);if(t&&t.AreaIds){let n=function(e){const t=Object(a.a)(e);if(t&&t.AreaIds){const n=d(e),r=Object(i.w)(e).homepageSubArea;if(n){const e=t.Areas[n];if(r)for(const t of e.GroupIds){const n=e.Groups[t];if(n.SubAreaIds.indexOf(r)>-1)return n.SubAreas[r]}else for(const t of e.GroupIds){const n=e.Groups[t];for(const e of n.SubAreaIds){const t=n.SubAreas[e];if(!g(t))return t}}}}return}(e);if(n)return n;const o=t.AreaIds.filter(e=>e!==r.d);for(const e of o){const r=t.Areas[e];for(const e of r.GroupIds){const t=r.Groups[e];for(const e of t.SubAreaIds)if(n=t.SubAreas[e],!g(n))return n}}}return{Url:l}}function d(e){const t=Object(a.a)(e),n=Object(i.w)(e).homepageArea;if(Object(o.a)(e)===s.a.Browser&&t&&t.AreaIds&&n&&"<Default>"!==n&&t.AreaIds.indexOf(n)>-1)return n}function p(e,t){if(t||(t=e.AreaIds&&e.AreaIds[0]),!t)return 0===e.AreaIds.length?{Url:l}:null;const n=e.Areas[t];for(const e of n.GroupIds){const t=n.Groups[e];for(const e of t.SubAreaIds){const n=t.SubAreas[e];if(!g(n))return n}}return{Url:l}}function g(e){return!(e.Entity||e.DefaultDashboard||!e.Url.toLowerCase().startsWith("http"))}function h(e){const t=u(e),n=Object(c.c)(e);return t&&t.Id===n}},RiHV:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.LearningPathDOMAttributeSuffix="lp-id",e.LearningPathDOMAttributeName="data-"+e.LearningPathDOMAttributeSuffix,e.LearningPathFeatureName="GuidedHelp"}(r||(r={}))},RiLc:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n("504W");const a="@Microsoft.PowerApps.CDS";class i{constructor(){this._responseXml=null,this._errorCode=0,this._innerFault=null,this._callStack=null,this._responseText=null,this._annotations=null,this._messages=[]}get_annotations(){return this._annotations}get_innerFault(){return this._innerFault}get_errorCode(){return this._errorCode}get_message(){return this._messages&&this._messages.length?this._messages[0]:null}get_messages(){return this._messages}get_responseXml(){return this._responseXml}_get_responseOuterXml(){return this._responseXml.get_outerXml()}get_responseText(){return Object(r.a)(this._responseXml)?this._responseText:this._get_responseOuterXml()}get_callStack(){return this._callStack}static parseFromXml(e){const t=new i;if(Object(r.a)(e))return t;e.addNamespace("d","http://schemas.microsoft.com/xrm/2011/Contracts/Services"),e.addNamespace("a","http://schemas.microsoft.com/xrm/2011/Contracts"),e.addNamespace("b","http://schemas.datacontract.org/2004/07/System.Collections.Generic"),e.addNamespace("c","http://schemas.microsoft.com/xrm/2012/Contracts"),e.addNamespace("i","http://www.w3.org/2001/XMLSchema-instance"),t._responseXml=e;let n=".//a:OrganizationServiceFault";const a=e.selectSingleNode(n);Object(r.a)(a)&&"c:Fault"===e.get_tagName()&&(n="./");const o=e.selectSingleNode(n+"/a:ErrorCode");Object(r.a)(o)||(t._errorCode=Number.parseInvariant(o.get_innerText()));const s=e.selectSingleNode(n+"/a:TraceText");Object(r.a)(s);const c=e.selectSingleNode(n+"/a:InnerFault[not(@i:nil)]");Object(r.a)(c)||(t._innerFault=i._ParseInnerFault(c));const l=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='CallStack']/b:value");Object(r.a)(l)||(t._callStack=l.get_innerText());const u=e.getElementsByTagName("Message");if(!Object(r.a)(u)&&u.get_count())for(let e=0;e<u.get_count();e++)t._messages.push(u.get_item(e).get_innerText());else t._messages.push(e.get_outerXml());return t}static parseFromJson(e){try{const t=JSON.parse(e),n=t.error;let a=null;return a=Object(r.a)(n)?i.parseFromJsonRecord(t):i.parseFromJsonRecord(n),a._responseText=e,a}catch(t){const n=new i;return n._messages.push(e),n}}static parseFromJsonRecord(e){const t=new i;let n=e.code;Object(r.b)(n)?(n=e.ErrorCode,Object(r.b)(n)||(t._errorCode=Number.parseInvariant(n.toString()))):t._errorCode=Number.parseInvariant(n.toString());let o=e.message;Object(r.b)(o)?(o=e.Message,Object(r.b)(o)||t._messages.push(o)):t._messages.push(o);const s=e.tracetext;Object(r.b)(s);let c=e.stacktrace;Object(r.b)(c)?(c=e.StackTrace,Object(r.b)(c)||(t._callStack=c)):t._callStack=c;const l=a+".InnerError.Message";if(Object(r.a)(e[l])||(t._innerFault=i._CreateInnerErrorFromAnnotation(e[l])),!Object(r.a)(e.innererror)){const n=e.innererror;t._innerFault=i.parseFromJsonRecord(n)}return t._annotations=i._CreateErrorAnnotationsHashFromFaultObject(e),t}static _CreateErrorAnnotationsHashFromFaultObject(e){const t={};return Object.keys(e).forEach(n=>{n.startsWith(a)&&(t[n]=e[n])}),t}static _CreateInnerErrorFromAnnotation(e){const t=new i;return t._messages=[e],t}static _GetElementsByTagNameForInnerFault(e,t){const n=e.getElementsByTagName(t);return Object(r.a)(n)||!n.get_count()?e.getElementsByTagName("a:"+t):n}static _ParseInnerFault(e){const t=new i;if(Object(r.a)(e))return t;const n=i._GetElementsByTagNameForInnerFault(e,"ErrorCode").get_item(0).get_innerText();t._errorCode=Number.parseInvariant(n),t._messages.push(i._GetElementsByTagNameForInnerFault(e,"Message").get_item(0).get_innerText());const a=i._GetElementsByTagNameForInnerFault(e,"InnerFault");if(a.get_count()>0){const e=a.get_item(0);e.hasChildNodes()&&(t._innerFault=i._ParseInnerFault(e))}return t}static parseFromHtml(e){const t=new i;if(Object(r.b)(e))return t;const n=$(e);let a=$("#errDescription",n).text();Object(r.b)(a)&&(a=$(".content-container",n).text()),Object(r.b)(a)&&(a=e),t._messages.push(a);let o=$("#errNumber",n).text();Object(r.b)(o)&&(o=$("th:contains('Error Code')",n).next().text());const s=parseInt(o,16),c=2147483648&s?-1:1;return t._errorCode=c*(1+~s),t}static fromErrorCode(e){const t=new i;return t._errorCode=e,t}}},Rj8P:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="offline.status.set",a="offline.issyncing";function i(e,t,n=null,a=null){return{type:r,payload:{status:e,statusReason:t,errorCode:n,errorMessage:a}}}function o(e){return{type:a,payload:{isSyncing:e}}}},RrRQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="dataSnapshot.discard";function i(e,t,n){return{type:"dataSnapshot.discard.async",sync:!0,execute({dispatch:i,getState:s},c){i(function(e,t,n){const i=Object(r.v)(n);return{type:a,payload:t,meta:{pageId:e,contextKey:i}}}(e,t,n)),i(o(t))}}}function o(e){return{type:a,payload:null,meta:e}}},RrRu:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l}));var r=n("SAYH"),a=n("dHD5"),i=n("BFlg"),o=n("P6DH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="dataset.mark.selected.rows";function c(e,t,n){return{type:"mark.selected.rows.async",execute({dispatch:s,getState:c},u){const d=u.TraceManager.getTracer(i.z),p=i.x+".markedSelectedRowsAction";try{const i=Object(a.v)(t),g=c(),h=Object(o.fb)(g,e,t)||[];return(h.length!==n.length||n.some(e=>h.every(t=>!r.a.equals(t,e))))&&(s(l(e,i,n)),d.info("Marking the selected {0} rows"+n.length)),u.EventManager.ReportComponentSuccess(p),Promise.resolve()}catch(e){const t="marking the selected "+n.length+" failed";u.EventManager.ReportComponentFailure(p,Error(t))}}}}function l(e,t,n){return{type:s,payload:n,meta:{pageId:e,dataSetContextKey:t}}}},RymD:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r=2,a="back_nav_session_state_key",i="hide_tooltip_state_data_key",o="dimiss_count_state_data_key"},"S/Br":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t){this.IsBusinessNotification=!1,this.IsBusinessNotification=!0}}},S2mk:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"g",(function(){return R})),n.d(t,"o",(function(){return L})),n.d(t,"m",(function(){return B})),n.d(t,"C",(function(){return U})),n.d(t,"D",(function(){return V})),n.d(t,"y",(function(){return z})),n.d(t,"B",(function(){return W})),n.d(t,"j",(function(){return F})),n.d(t,"r",(function(){return k})),n.d(t,"x",(function(){return q})),n.d(t,"u",(function(){return H})),n.d(t,"v",(function(){return G})),n.d(t,"t",(function(){return J})),n.d(t,"p",(function(){return $})),n.d(t,"w",(function(){return ee})),n.d(t,"s",(function(){return te})),n.d(t,"k",(function(){return Z})),n.d(t,"q",(function(){return ne})),n.d(t,"f",(function(){return M})),n.d(t,"F",(function(){return x})),n.d(t,"n",(function(){return re})),n.d(t,"A",(function(){return ie})),n.d(t,"z",(function(){return oe})),n.d(t,"i",(function(){return se})),n.d(t,"l",(function(){return ae})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return g})),n.d(t,"e",(function(){return h})),n.d(t,"d",(function(){return w})),n.d(t,"E",(function(){return P})),n.d(t,"h",(function(){return T}));var r,a,i,o,s=n("455M"),c=n("lxuJ"),l=n("UR8A"),u="MscrmControls.Containers.FieldSectionItem",d="MscrmControls.Grid.GridControl",p="MscrmControls.Chart.ChartControl",g="{fd2a7985-3187-444e-908d-6624b21f69c0}",h="{9fdf5f91-88b1-47f4-ad53-c11efc01a01d}",f={"3ef39988-22bb-4f0b-bbbe-64b5a3748aee":"picklist","67fac785-cd58-4f9f-abb3-4b7ddc6ed5ed":"radio","b0c6723a-8503-4fd7-bb28-c8a06ac933c2":"checkbox"},m="MscrmControls.WebResource.WebResourceHtmlControl",b="MscrmControls.TimelineWallControl.TimelineWall",_={},y={},v={},S={},O={},C={},E={},I={};!function(e){e[e.Read=0]="Read",e[e.Edit=1]="Edit",e[e.Both=2]="Both"}(r||(r={})),function(e){e[e.Normal=0]="Normal",e[e.Card=1]="Card"}(a||(a={})),function(e){e[e.Text=0]="Text",e[e.Icon=1]="Icon"}(i||(i={})),function(e){e[e.GridContainer=0]="GridContainer",e[e.DashboardContainer=1]="DashboardContainer",e[e.QuickCreateForm=2]="QuickCreateForm",e[e.FieldSectionContainer=3]="FieldSectionContainer",e[e.TimelineContainer=4]="TimelineContainer",e[e.ChartControl=5]="ChartControl",e[e.WebresourceControl=6]="WebresourceControl",e[e.DummyControl=7]="DummyControl",e[e.CalendarControl=8]="CalendarControl"}(o||(o={}));var w={"MscrmControls.MultiSelectPicklist.UpdMSPicklistControl":"MscrmControls.MultiSelectPicklist.MultiSelectPicklistControl"},j={};function P(e,t){j[e]=t}function T(e){return j.hasOwnProperty(e)?j[e]:e}function N(e){for(var t in e.Parameters){var n=e.Parameters[t];if(n.Primary)return n}return null}function A(e){return{Usage:1,Static:!0,Type:s.a.SingleLineText,Value:JSON.stringify(e),Primary:!1}}function D(e){return{Usage:1,Static:!0,Type:s.a.SingleLineText,Value:f[e],Primary:!1}}function R(e,t){if(e.CustomControlId!==u)return null;var n=N(e);return function(e){return e&&"b0c6723a-8503-4fd7-bb28-c8a06ac933c2"===e||"67fac785-cd58-4f9f-abb3-4b7ddc6ed5ed"===e||"3ef39988-22bb-4f0b-bbbe-64b5a3748aee"===e}(t)?{valueSpecification:A(n),twoOptionRenderParam:D(t)}:{valueSpecification:A(n)}}function x(e,t){var n=N(e);return n?{FormFactor:2,CustomControlId:u,Name:name,Version:"1.0.0",Parameters:{value:n,valueSpecification:A(n),controlMode:{Usage:1,Static:!0,Type:"Enum",Value:r[t.ControlMode],Primary:!1},displayMode:{Usage:1,Static:!0,Type:"Enum",Value:a.Normal,Primary:!1},labelMode:{Usage:1,Static:!0,Type:"Enum",Value:i.Text,Primary:!1}},ShouldOverrideControlVisible:e.ShouldOverrideControlVisible,Children:{fieldControl:e}}:e}function M(e,t){switch(e.Type){case s.a.Grid:var n=t.Parameters,r=e;r.EnableViewPicker="true"===n.EnableViewPicker,r.RelationshipName=n.RelationshipName,r.TargetEntityType=n.TargetEntityType,r.ViewId=n.ViewId||n.DefaultViewId||n.defaultviewid;break;case s.a.LookupSimple:n=t.Parameters;(l=e).EnableViewPicker=n.DisableViewPicker&&"true"!==n.DisableViewPicker||!n.DisableViewPicker,l.TargetEntityType=n.TargetEntityType,l.ViewId=n.ViewId||n.DefaultViewId||n.defaultviewid,l.AllowFilterOff="true"===n.AllowFilterOff,l.AvailableViewIds=n.AvailableViewIds,l.DependentAttributeName=n.DependentAttributeName,l.DependentAttributeType=n.DependentAttributeType,l.DisableQuickFind="true"===n.DisableQuickFind,l.ExtraCondition=n.ExtraCondition,l.FilterRelationshipName=n.FilterRelationshipName,l.DisableMru=n.DisableMru;for(var a=0;a<n.length;a++){var i=n[a];if(i&&i.TargetEntities&&i.TargetEntities.length){i.TargetEntities.length>1&&(l.Type=s.a.LookupMultiEntity);var o=i.TargetEntities[0];!l.ViewId&&o.DefaultViewId&&(l.ViewId=o.DefaultViewId),!l.TargetEntityType&&o.EntityLogicalName&&(l.TargetEntityType=o.EntityLogicalName)}}case s.a.LookupCustomer:case s.a.LookupOwner:case s.a.LookupPartyList:case s.a.LookupRegarding:case s.a.LookupMultiEntity:var l;n=t.Parameters;(l=e).UseMainFormDialogForCreate="true"===n.useMainFormDialogForCreate,l.UseMainFormDialogForEdit="true"===n.useMainFormDialogForEdit;break;case s.a.SingleLineText:if(Object(c.a)("{39354E4A-5015-4D74-8031-EA9EB73A1322}",t.ClassId.guid))e.Value=t.Label;break;case s.a.Timer:var u=t.Parameters;e.TimerParameters=function(e){var t={};return t.CancelConditionName=e.CancelConditionName,t.CancelConditionValue=e.CancelConditionValue,t.FailureConditionName=e.FailureConditionName,t.FailureConditionValue=e.FailureConditionValue,t.FailureTimeField=e.FailureTimeField,t.PauseConditionName=e.PauseConditionName,t.PauseConditionValue=e.PauseConditionValue,t.SuccessConditionName=e.SuccessConditionName,t.SuccessConditionValue=e.SuccessConditionValue,t.WarningConditionName=e.WarningConditionName,t.WarningConditionValue=e.WarningConditionValue,t}(u)}return e}function F(e){return null==e}function k(e,t,n,o,d,p,g){if(!t){if("mapcontrol"===e&&Object(c.a)("62b0df79-0464-470f-8af7-4483cfea0c7d",d)){var h=e+"-"+p.Parameters.AddressField;return S[h]||(S[h]={FormFactor:2,CustomControlId:u,Name:e,Version:"1.0.0",Parameters:{value:{Usage:0,Static:!1,Type:s.a.SingleLineAddress,Value:p.Parameters.AddressField,Primary:!0},controlMode:{Usage:2,Static:!0,Type:"Enum",Value:r.Read,Primary:!1}},ShouldOverrideControlVisible:!1}),S[h]}if("MscrmControls.Containers.RelevanceSearchControl"===n)return _[e]||(_[e]={FormFactor:2,CustomControlId:"MscrmControls.Containers.RelevanceSearchControl",Name:e,Version:"1.0.0",Parameters:{value:{Type:s.a.Search,Primary:!0}},ShouldOverrideControlVisible:!1}),_[e];if(d&&(Object(c.a)("{e616a57f-20e0-4534-8662-a101b5ddf4e0}",d)||Object(c.a)("{7CCD1494-1F7A-4E3A-8BDE-F32069DAEB9F}",d))){if(!_[e]){var f=p&&p.Parameters&&"true"===p.Parameters.EnableAutoSuggestions&&"0"===p.Parameters.AutoSuggestionSource?p.Parameters.SearchForAutoSuggestionsUsing:void 0;_[e]={FormFactor:2,CustomControlId:"MscrmControls.KbSearchControl.KbSearchControl",Name:e,Version:"1.0.0",Parameters:{value:{Type:s.a.SearchWidget,Primary:!0},AutoSuggestionField:{Type:"all",Primary:!1,Static:!1,Usage:0,Value:f}},ShouldOverrideControlVisible:!1}}return _[e]}return d&&Object(c.a)(d,"{03c5aed6-ee88-404e-b63c-4c53429c8bfb}")&&(_[e]={FormFactor:2,CustomControlId:"MscrmControls.KbArticleControl.KbArticleControl",Name:e,Version:"1.0.0",Parameters:{value:{Type:s.a.KbArticle,Primary:!0}},ShouldOverrideControlVisible:!1}),d&&Object(c.a)(d,"{1b9fc842-b45e-4fc1-b080-81e96b6d857f}")&&(_[e]={FormFactor:2,CustomControlId:"MscrmControls.KbContentControl.KbContentControl",Name:e,Version:"1.0.0",Parameters:{value:{Type:s.a.KbContent,Primary:!0}},ShouldOverrideControlVisible:!1}),d&&Object(c.a)("{26E9760F-7454-40DE-BB07-F6DCCCB82040}",d)?(_[e]||(_[e]={FormFactor:2,CustomControlId:"MscrmControls.EmailEngagement.EmailView",Name:e,Version:"1.0.0",Parameters:{value:{Type:s.a.EmailEngagementRecipientActivity,Primary:!0}},ShouldOverrideControlVisible:!1}),_[e]):!F(l.b)&&!F(l.b.Utils)&&!F(l.b.Utils.isFeatureEnabled)&&l.b.Utils.isFeatureEnabled("EmailEngagementComposeForUCI")&&d&&Object(c.a)("{F454228D-1D25-4319-E12F-D27968BC0234}",d)?(_[e]||(_[e]={FormFactor:2,CustomControlId:"MscrmControls.EmailEngagement.EmailEngagementActionsControl",Name:e,Version:"1.0.0",Parameters:{value:{Type:s.a.EmailEngagementActions,Primary:!0},toparams:{Usage:0,Static:!1,Type:s.a.LookupPartyList,Value:"to",Primary:!1},ccparams:{Usage:0,Static:!1,Type:s.a.LookupPartyList,Value:"cc",Primary:!1},directioncode:{Usage:0,Static:!1,Type:s.a.TwoOptions,Value:"directioncode",Primary:!1},isemailfollowed:{Usage:0,Static:!1,Type:s.a.TwoOptions,Value:"isemailfollowed",Primary:!1},followemailuserpreference:{Usage:0,Static:!1,Type:s.a.TwoOptions,Value:"followemailuserpreference",Primary:!1},emailreminderstatus:{Usage:0,Static:!1,Type:s.a.OptionSet,Value:"emailreminderstatus",Primary:!1},emailremindertype:{Usage:0,Static:!1,Type:s.a.OptionSet,Value:"emailremindertype",Primary:!1},emailremindertext:{Usage:0,Static:!1,Type:s.a.SingleLineText,Value:"emailremindertext",Primary:!1},emailreminderexpirytime:{Usage:0,Static:!1,Type:s.a.DateAndTimeDateAndTime,Value:"emailreminderexpirytime",Primary:!1},delayedemailsendtime:{Usage:0,Static:!1,Type:s.a.DateAndTimeDateAndTime,Value:"delayedemailsendtime",Primary:!1},statuscode:{Usage:0,Static:!1,Type:s.a.OptionSet,Value:"statuscode",Primary:!1}},ShouldOverrideControlVisible:!1}),_[e]):n===s.a.WebResourceHtmlControl?(E[e]||(E[e]={FormFactor:2,CustomControlId:m,Name:e,Version:"1.0.0",Parameters:{value:{Usage:0,Type:s.a.WebResourceHtmlControl,Value:null,Static:!1,Primary:!0}},ShouldOverrideControlVisible:!1}),E[e]):n===s.a.TimelineWall?{FormFactor:2,CustomControlId:b,Name:e,Version:"1.0.0",Parameters:{value:{Type:s.a.TimelineWall,Primary:!0}},ShouldOverrideControlVisible:!1}:l.b&&l.b.Utils&&l.b.Utils.isFeatureEnabled&&!l.b.Utils.isFeatureEnabled("SocialInsightsMapping")||!d||!Object(c.a)("{86b9e25e-695e-4fef-ac69-f05cfa96739c}",d)?(v[e]||(v[e]={FormFactor:2,CustomControlId:"MscrmControls.FieldControls.DummyControl",Name:e,Version:"1.0.0",Parameters:{value:{Usage:1,Static:!0,Type:d||n,Value:null,Primary:!0},controlMode:{Usage:1,Static:!0,Type:"Enum",Value:r.Both,Primary:!1}},ShouldOverrideControlVisible:!1}),v[e]):(y[e]||(y[e]={FormFactor:2,CustomControlId:"MscrmControls.SocialInsightsControl.SocialInsightsControl",Name:e,Version:"1.0.0",Parameters:{value:{Type:s.a.SocialInsightsControl,Primary:!0}},ShouldOverrideControlVisible:!1}),y[e])}if(d&&(Object(c.a)("{6F3FB987-393B-4d2d-859F-9D0F0349B6AD}",d)||Object(c.a)("{F94DB24F-263D-44A7-B38E-A35E9854812B}",d)))return(n.includes("memo")||n===s.a.SingleLineText||n===s.a.SingleLineTextArea||n===s.a.Multiple)&&(_[e]||(_[e]={FormFactor:2,CustomControlId:"MscrmControls.ActivityControls.ActivityEditorControl",Name:e,Version:"1.0.0",Parameters:{value:{Usage:0,Static:!1,Type:n,Value:t,Primary:!0},isUnsafe:{Usage:1,Static:!1,Type:s.a.WholeNone,Value:"isunsafe",Primary:!1}},ShouldOverrideControlVisible:!1})),_[e];if(d&&Object(c.a)("{39354E4A-5015-4D74-8031-EA9EB73A1322}",d))return I[e]||(I[e]={FormFactor:2,CustomControlId:"MscrmControls.FieldControls.LabelControl",Name:e,Version:"1.0.0",Parameters:{value:{Type:s.a.SingleLineText,Static:!0,Primary:!0}},ShouldOverrideControlVisible:!1}),I[e];if(n===s.a.QuickForm){var w=ce(p,g);return O[e]&&O[e].Parameters.value.Value===w||(O[e]={FormFactor:2,CustomControlId:"MscrmControls.Containers.QuickForm",Name:e,Version:"1.0.0",Parameters:{value:{Usage:0,Type:s.a.QuickForm,Value:w,Static:!1,Primary:!0,FirstDataRequestType:g&&g.chartDataRequestType?g.chartDataRequestType:1}},ShouldOverrideControlVisible:!1}),O[e]}if(n===s.a.Card){w=ce(p,g);return C[e]&&C[e].Parameters.value.Value===w||(C[e]={FormFactor:2,CustomControlId:"MscrmControls.Containers.QuickFormCardControl",Name:e,Version:"1.0.0",Parameters:{value:{Usage:0,Type:s.a.QuickForm,Value:w,Static:!1,Primary:!0}},ShouldOverrideControlVisible:!1}),C[e]}var j=re(n,d),P=function(e){return e===s.a.Timer?r.Read:r.Both}(j),T=function(e){return e===s.a.Timer?2:1}(j),N=(o?o.toLowerCase()+"-":"")+e;return S[N]||(S[N]={FormFactor:2,CustomControlId:u,Name:e,Version:"1.0.0",Parameters:{value:{Usage:0,Static:!1,Type:j,Value:t,Primary:!0},controlMode:{Usage:T,Static:!0,Type:"Enum",Value:P,Primary:!1},displayMode:{Usage:T,Static:!0,Type:"Enum",Value:a.Normal,Primary:!1},labelMode:{Usage:T,Static:!0,Type:"Enum",Value:i.Text,Primary:!1}},ShouldOverrideControlVisible:!1}),S[N]}function L(e){return{FormFactor:2,CustomControlId:e,Name:e,Version:"1.0.0",Parameters:{value:{Type:s.a.BusinessProcessFlow}},ShouldOverrideControlVisible:!1}}function B(e,t,n,r,a,i,o,c,u){var d,p=!F(l.b)&&!F(l.b.Utils)&&!F(l.b.Utils.isFeatureEnabled)&&l.b.Utils.isFeatureEnabled("EditableGridLookupRecordCountConfig");return{FormFactor:t,CustomControlId:e,Name:e,Version:"1.0.0",Parameters:(d={},d[a]={Type:s.a.Grid,ViewId:n,TargetEntityType:r,AllowFilterOff:null!=i&&i,RelationshipName:o,DependentAttributeType:c,DependentAttributeName:u,PagingInput:p?{Static:!0,Value:'{"firstPageNumber":1,"lastPageNumber":1,"pageSize":100}'}:void 0},d),ShouldOverrideControlVisible:!1}}function U(e,t,n,r,a){return{FormFactor:2,CustomControlId:e,Name:e,Version:"1.0.0",Parameters:{value:{Usage:3,Type:s.a.LookupSimple,ViewId:t,Attributes:{LogicalName:"falseBoundLookup",Targets:new Array(n),DisplayName:r},Callback:a}},ShouldOverrideControlVisible:!1}}function V(e,t,n,r,a,i,o,s,c,l,u,d,p){var g;return void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=!1),r&&0!==r.length?g=r:n&&(g=[n]),{FormFactor:2,CustomControlId:e,Name:e,Version:"1.0.0",Parameters:{value:{Usage:3,Type:a,ViewId:t,Attributes:{LogicalName:"falseBoundLookup",Targets:g,SearchText:u},Callback:i,ExtraFilters:o,Value:c,AdditionalTargetExtraFilters:s,DisableMru:l,UseMainFormDialogForCreate:p,UseMainFormDialogForEdit:d},displayMode:{Usage:1,Static:!0,Type:"Enum",Value:1,Primary:!1}},ShouldOverrideControlVisible:!1}}function z(e){return{FormFactor:2,CustomControlId:e,Name:e,Version:"1.0.0",Parameters:{value:{Usage:0,Type:s.a.Dashboard,Value:null,Static:!1,Primary:!0}},ShouldOverrideControlVisible:!1}}function W(e){return{FormFactor:2,CustomControlId:e,Name:e,Version:"1.0.0",Parameters:{value:{Usage:0,Type:s.a.ReferencePanel,Value:null,Static:!1,Primary:!0}},ShouldOverrideControlVisible:!1}}function q(e,t,n){return void 0===n&&(n=!1),{FormFactor:1,DisplayNameKey:"CC_ReadOnlyGrid_Name",CustomControlId:Y(t.TargetEntityType),Name:e,Version:"1.0.0",Parameters:K(t,n),ShouldOverrideControlVisible:!1,isDefaultConfig:!0}}function H(e,t,n){return{FormFactor:1,CustomControlId:"MscrmControls.Grid.ReadOnlyGrid",Name:e,DisplayNameKey:"CC_ReadOnlyGrid_Name",Version:"1.0.0",Parameters:Q(t,n),ShouldOverrideControlVisible:!1,isDefaultConfig:!0}}function G(e,t,n){return{FormFactor:1,CustomControlId:"MscrmControls.Grid.ReadOnlyGrid",DisplayNameKey:"CC_ReadOnlyGrid_Name",Name:e,Version:"1.0.0",Parameters:X(t,n),ShouldOverrideControlVisible:!1,isDefaultConfig:!0}}function K(e,t){if("sharepointdocument"===e.TargetEntityType)return{Grid:{Type:s.a.Grid,ViewId:e.DefaultViewId||e.ViewId,TargetEntityType:e.TargetEntityType,EnableViewPicker:"true"===e.EnableViewPicker,RelationshipName:e.RelationshipName,Columns:[],Primary:!0,DataSetUIOptions:{displayQuickFind:!1,displayIndex:!1,displayCommandBar:!0,displayViewSelector:!0}},EnableEditing:{Usage:1,Static:!0,Type:"Enum",Value:"No",Primary:!1},EnableGroupBy:{Usage:1,Static:!0,Type:"Enum",Value:"No",Primary:!1},EnableFiltering:{Usage:1,Static:!0,Type:"Enum",Value:"No",Primary:!1}};if("connection"===e.TargetEntityType&&e.ViewId&&("{FE4BC089-8901-466C-A41B-1C1090F204D4}"===e.ViewId.toUpperCase()||"{4E3600FA-B9C8-49F4-B69A-51EBA06D9BDF}"===e.ViewId.toUpperCase())&&(F(l.b)||F(l.b.Utils)||F(l.b.Utils.isFeatureEnabled)||!l.b.Utils.isFeatureEnabled("DisableEditableGridControlOnPhone")||F(l.b.Client.getFormFactor)||3!==l.b.Client.getFormFactor()))return{Grid:{Type:s.a.Grid,ViewId:e.DefaultViewId||e.ViewId,TargetEntityType:e.TargetEntityType,EnableViewPicker:"true"===e.EnableViewPicker,RelationshipName:e.RelationshipName,Columns:[],Primary:!0},EnableEditing:{Usage:1,Static:!0,Type:"Enum",Value:"Yes",Primary:!1},EnableGroupBy:{Usage:1,Static:!0,Type:"Enum",Value:"No",Primary:!1},EnableFiltering:{Usage:1,Static:!0,Type:"Enum",Value:"No",Primary:!1}};var n={Grid:{Type:s.a.Grid,ViewId:e.DefaultViewId||e.ViewId,TargetEntityType:e.TargetEntityType,EnableViewPicker:e.EnableViewPicker,RelationshipName:e.RelationshipName,Columns:[],Primary:!0},EnableEditing:{Usage:1,Static:!0,Type:"Enum",Value:"No",Primary:!1},EnableGroupBy:{Usage:1,Static:!0,Type:"Enum",Value:"No",Primary:!1},EnableFiltering:{Usage:1,Static:!0,Type:"Enum",Value:"No",Primary:!1}};return t&&(n.EnableFiltering.Value="Yes"),n}function Q(e,t){return{Grid:{Type:s.a.Grid,EntityName:e,ViewId:t},EnableEditing:{Usage:1,Static:!0,Type:"Enum",Value:"No",Primary:!1},EnableGroupBy:{Usage:1,Static:!0,Type:"Enum",Value:"No",Primary:!1},EnableFiltering:{Usage:1,Static:!0,Type:"Enum",Value:"Yes",Primary:!1}}}function X(e,t){return{Grid:{Type:s.a.Grid,EntityName:e,ViewId:t},EnableEditing:{Usage:1,Static:!0,Type:"Enum",Value:"No",Primary:!1},EnableGroupBy:{Usage:1,Static:!0,Type:"Enum",Value:"No",Primary:!1},EnableFiltering:{Usage:1,Static:!0,Type:"Enum",Value:"Yes",Primary:!1}}}function Y(e){return"sharepointdocument"===e?"MscrmControls.SharepointAssociatedGrid.SharepointControl":"connection"===e?d:"MscrmControls.Grid.ReadOnlyGrid"}function J(e,t,n,r,a,i,o,c,l,u,d,p,g){void 0===p&&(p=!0),void 0===g&&(g=!1);var h=i||null,f=o?"true":"false",m=l?"true":"false";return{FormFactor:1,CustomControlId:e,Name:e,Version:"1.0.0",Parameters:{ChartDataSet:{Type:s.a.Grid,EntityName:t,ViewId:n,VisualizationId:r,ChartGridMode:"Chart",HighchartFilterExpression:h,ExtraFilters:u,IsUserChart:f,ChartDrillDownParameters:c,FirstDataRequestType:2,IsUserView:m,RefreshInput:{Value:a,Static:!0},LinkingInput:{Value:d,Static:!0}},Parent:{Type:"SingleLine.Text",Primary:!1,Static:!0,Usage:1,Value:"DataSetHost"},ChartSelectorMode:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:"ChartSelector"},CommandMode:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:"GridChartCommand"},EnableExpandButton:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:p?"Yes":"No"},EnableCloseButton:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:g?"Yes":"No"}},ShouldOverrideControlVisible:!1,isDefaultConfig:!0}}function $(e,t,n,r,a,i,o,c,l,u,d){void 0===d&&(d=!1);var p=o?"true":"false",g=c?"true":"false";return{FormFactor:1,CustomControlId:e,Name:e,Version:"1.0.0",Parameters:{ChartDataSet:{Type:s.a.Grid,EntityName:t,ViewId:n,VisualizationId:r,ChartGridMode:"Chart",HighchartFilterExpression:null,ExtraFilters:l,IsUserChart:p,FirstDataRequestType:1,IsUserView:g,RelationshipName:a,RefreshInput:{Value:i,Static:!0},LinkingInput:{Value:u,Static:!0}},Parent:{Type:"SingleLine.Text",Primary:!1,Static:!0,Usage:1,Value:"AssociatedGrid"},ChartSelectorMode:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:"ChartSelector"},CommandMode:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:"No"},EnableExpandButton:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:"Yes"},EnableCloseButton:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:d?"Yes":"No"}},ShouldOverrideControlVisible:!1,isDefaultConfig:!0}}function Z(e,t,n){return{FormFactor:t,CustomControlId:n,Name:"MscrmControls.PowerBI.PowerBIControl",Version:"1.0.0",Parameters:{value:{TileUrl:e.TileUrl,PowerBIGroupId:e.PowerBIGroupId,PowerBIDashboardId:e.PowerBIDashboardId,PowerBIType:e.Type,PowerBIReportId:e.PowerBIReportId,PowerBIFilter:e.PowerBIFilter,EnableInMobile:e.EnableInMobile||!1,TileId:e.TileId,IsPowerBIEnabled:e.IsPowerBIEnabled||!0,Type:s.a.PowerBI,Primary:!0,FirstPartyIntegrationSiteUrl:e.FirstPartyIntegrationSiteUrl,Tenant:e.Tenant}},ShouldOverrideControlVisible:!1,isDefaultConfig:!0}}function ee(e,t,n){void 0===t&&(t=1),void 0===n&&(n=!0);var r=te(e,t);return r.Parameters.Parent.Value="QuickViewForm",r.Parameters.CommandMode.Value=n?"FormChartCommand":"No",r}function te(e,t,n){void 0===t&&(t=2);var r=e.EnableChartPicker&&"true"===e.EnableChartPicker?"ChartSelector":"ChartTitle",a=e.EnableViewPicker&&"true"===e.EnableViewPicker?"ViewSelector":"ViewTitle",i={Type:s.a.Grid,EntityName:e.TargetEntityType,ViewId:e.ViewId,VisualizationId:e.VisualizationId,ChartGridMode:"Chart",HighchartFilterExpression:null,IsUserChart:e.IsUserChart,FirstDataRequestType:t,IsUserView:e.IsUserView,ViewIds:e.ViewIds,RelationshipName:e.RelationshipName,EnableViewPicker:"true"===e.EnableViewPicker,EnableChartPicker:"true"===e.EnableChartPicker};return F(n)||(i.RefreshInput={Value:n,Static:!0}),{FormFactor:1,CustomControlId:p,Name:p,Version:"1.0.0",Parameters:{ChartDataSet:i,Parent:{Type:"SingleLine.Text",Primary:!1,Static:!0,Usage:1,Value:"EditForm"},ChartSelectorMode:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:r},ViewSelectorMode:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:a},CommandMode:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:"FormChartCommand"},EnableExpandButton:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:"Yes"}},ShouldOverrideControlVisible:!1,isDefaultConfig:!0}}function ne(e,t,n,r,a,i){var o,s=N(o=i&&(Object(c.a)(i,"{E7A81278-8635-4D9E-8D4D-59480B391C5B}")||Object(c.a)(i,"{02d4264b-47e2-4b4c-aa95-f439f3f4d458}"))?q(e,r.Parameters):k(e,t,n,a,i,r));s&&M(s,r);var l=R(o,i);return null!==l&&Object.assign(o.Parameters,l),o}function re(e,t){var n,r=e?e.split("."):[null,null],a=r[0],i=r[1];switch(a||(a="string"),i&&"null"!==i&&"undefined"!==i||(i=t&&s.a.ClassIdControlMap[t]||"text"),a){case"boolean":n=s.a.TwoOptions;break;case"customer":n=s.a.LookupCustomer;break;case"datetime":switch(i.toLowerCase()){case"date":case"0":n=s.a.DateAndTimeDateOnly;break;case"datetime":case"dateandtime":case"1":n=s.a.DateAndTimeDateAndTime;break;default:n=s.a.DateAndTimeDateOnly}break;case"decimal":n=s.a.Decimal;break;case"file":n=s.a.File;break;case"float":case"double":n=s.a.FP;break;case"image":n=s.a.Image;break;case"integer":switch(i.toLowerCase()){case"duration":case"1":n=s.a.WholeDuration;break;case"timezone":case"2":n=s.a.WholeTimeZone;break;case"language":case"3":n=s.a.WholeLanguage;break;default:n=s.a.WholeNone}break;case"lookup":switch(i.toLowerCase()){case"connection":case"regarding":case"1":case"2":n=s.a.LookupRegarding;break;default:n=s.a.LookupSimple}break;case"memo":n=s.a.Multiple;break;case"money":n=s.a.Currency;break;case"owner":n=s.a.LookupOwner;break;case"partylist":n=s.a.LookupPartyList;break;case"multiselectpicklist":n=s.a.MultiSelectPicklist;break;case"picklist":case"state":n=s.a.OptionSet;break;case"status":n=s.a.StatusOptionSet;break;case"text":case"string":switch(i.toLowerCase()){case"email":case"0":n=s.a.SingleLineEmail;break;case"textarea":case"2":n=s.a.Multiple;break;case"url":case"3":n=s.a.SingleLineURL;break;case"tickersymbol":case"4":n=s.a.SingleLineTickerSymbol;break;case"phone":case"7":n=s.a.SingleLinePhone;break;case"memo":n=s.a.Multiple;break;default:n=s.a.SingleLineText}break;case"Timer":n=s.a.Timer;break;default:n=s.a.SingleLineText}return n}function ae(e){switch(e){case"MscrmControls.Grid.ReadOnlyGrid":case d:return o.GridContainer;case"MscrmControls.Containers.DashboardControl":return o.DashboardContainer;case"MscrmControls.Containers.QuickForm":return o.QuickCreateForm;case u:return o.FieldSectionContainer;case b:return o.TimelineContainer;case p:return o.ChartControl;case m:return o.WebresourceControl;case"MscrmControls.Calendar.CalendarControl":return o.CalendarControl;case"MscrmControls.FieldControls.DummyControl":return o.DummyControl}}function ie(e,t){var n;switch(e){case"TwoOptions":n="MscrmControls.FieldControls.CheckboxControl";break;case"Currency":n="MscrmControls.FieldControls.CurrencyControl";break;case"Decimal":n="MscrmControls.FieldControls.DecimalNumberControl";break;case"SingleLine.Email":n="MscrmControls.FieldControls.EmailAddressControl";break;case"FP":n="MscrmControls.FieldControls.FloatingPointNumberInput";break;case"Whole.Language":n="MscrmControls.FieldControls.LanguagePickerControl";break;case"OptionSet":n="MscrmControls.FieldControls.OptionSet";break;case"StatusOptionSet":n="MscrmControls.FieldControls.PicklistStatusControl";break;case"SingleLine.Phone":n="MscrmControls.FieldControls.PhoneNumberControl";break;case"SingleLine.Text":case"Multiple":n="MscrmControls.FieldControls.TextBoxControl";break;case"SingleLine.Ticker":n="MscrmControls.FieldControls.TickerSymbolControl";break;case"Whole.TimeZone":n="MscrmControls.FieldControls.TimeZonePickListControl";break;case"SingleLine.URL":n="MscrmControls.FieldControls.UrlControl";break;case"Whole.None":n="MscrmControls.FieldControls.WholeNumberControl";break;case"Whole.Duration":n="MscrmControls.FieldControls.DurationControl";break;case"Lookup.PartyList":case"Lookup.Regarding":case"Lookup.Simple":case"Lookup.Owner":case"Lookup.Customer":case"Lookup.MultiEntity":n=function(e,t){return"Lookup.Simple"===e&&t&&t.Targets&&1===t.Targets.length&&"subject"===t.Targets[0]?"MscrmControls.FieldControls.SubjectTreeControl":"MscrmControls.FieldControls.SimpleLookupControl"}(e,t);break;case"MultiSelectPicklist":n="MscrmControls.MultiSelectPicklist.UpdMSPicklistControl";break;case"DateAndTime.DateOnly":case"DateAndTime.DateAndTime":n="MscrmControls.FieldControls.DateTimeControl";break;case"Grid":n="MscrmControls.Grid.ReadOnlyGrid";break;case"SearchWidget":case"SearchWidget.SearchWidget":case"ReferencePanelSearchWidget":n="MscrmControls.KbSearchControl.KbSearchControl";break;case"KbArticle":n="MscrmControls.KbArticleControl.KbArticleControl";break;case"KbContent":n="MscrmControls.KbContentControl.KbContentControl";break;case"Timer":n="MscrmControls.FieldControls.TimerControl";break;case s.a.SingleLineAddress:n="MscrmControls.Map.MapControl";break;case s.a.File:n="MscrmControls.FieldControls.FileControl";break;case s.a.Image:n="MscrmControls.ImageAnnotation.ImageAnnotationControl";break;case"SingleLine.TextArea":default:n="MscrmControls.FieldControls.DummyControl"}return n=T(n)}function oe(e){if(!e)return null;var t=N(e);return t?ie(t.Type):null}function se(e){switch(e.CustomControlId){case"MscrmControls.Calendar.CalendarControl":case d:case"MscrmControls.Grid.ReadOnlyGrid":case"MscrmControls.Timeline.TimelineControl":case"MscrmControls.ActionCard.ActionCardView":return!0;default:return!1}}function ce(e,t){var n=t?t.quickFormId:"00000000-0000-0000-0000-000000000000",r=e?e.DataFieldName:"";return n+(r?"|"+r:"")}},S6oQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("nuS9"),a=n("CGM5");function i(e,t){return new Promise((function(n,r){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(a.readyState===XMLHttpRequest.DONE){var e=a.responseText;/<svg[\s\S]*>/i.test(e)?n(function(e){return(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("svg")[0]}(e)):r(new Error("Provided file isn't a valid SVG"))}},a.open("GET",e,!0),t&&a.setRequestHeader("Authorization","Bearer "+t),a.send()}))}var o,s=n("HMYz"),c=n("iDZS"),l=n("uTTW"),u=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return u(t,e),t.prototype.componentDidMount=function(){this.props.source&&this._inlineSvgImage(this.props.source)},t.prototype._inlineSvgImage=function(e){var t,n,r=this;(t=e,n=this.props.token,i(t,n).then((function(e){var t,n,r=null;return e&&(function(e){for(var t=e.getElementsByTagName("script"),n=t.length-1;n>=0;n--)t[n].parentNode.removeChild(t[n])}(e),(r=function(e){for(var t={},n=0;n<e.attributes.length;n++){var r=e.attributes[n].name,a=e.attributes[n].value;"style"===r&&(a=i(a)),t[r]=a}return t;function i(e){if(!e)return null;for(var t={},n=0,r=e.split(";").filter((function(e){return e&&-1!==e.indexOf(":")}));n<r.length;n++){var a=r[n].split(":"),i=a[0].trim().replace(/-\S/g,(function(e){return e[1].toUpperCase()})),o=a[1].trim();t[i]=o}return t}}(e)).dangerouslySetInnerHTML={__html:(t=e,n=new XMLSerializer,Array.prototype.reduce.call(t.childNodes,(function(e,t){return e+n.serializeToString(t)}),""))},r=Object.freeze(r)),r}))).then((function(e){e?r.setState({parsedSvgProps:e}):r.props.onParsingError&&r.props.onParsingError("File content is empty")}),(function(e){r.props.onParsingError&&r.props.onParsingError(e.message)}))},t.prototype._shouldRenderImg=function(){return this.props.source&&this.props.fallbackToImage&&!this.state.parsedSvgProps},t.prototype.getElementName=function(){return"svg"},t.prototype.getElementProps=function(){return Object.assign({},this.state.parsedSvgProps,this.props)},t.prototype.render=function(){if(this._shouldRenderImg()){var e=void 0;return this.props.source&&(e=this.props.source.replace(/\\/g,"/")),r.createElement(l.a,{source:e,style:this.props.style,altText:this.props.altText,title:this.props.title})}return r.createElement(this.getElementName(),this.getElementPropsInternal(),this.getElementChildren())},t.displayName="Svg",t}(a.a),p=s.connect(c.a)(d)},S70w:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.CurrencySymbol=0]="CurrencySymbol",e[e.CurrencyCode=1]="CurrencyCode"}(r||(r={}))},SAYH:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("84PK");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a=/^({?)((\d|[a-fA-F]){8}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){12})(}?)$/,i=/^([a-fA-F\d]{8})([a-fA-F\d]{4})([a-fA-F\d]{4})([a-fA-F\d]{4})([a-fA-F\d]{12})$/;class o{constructor(e,t=!1){if(t)this.guid=e;else{const t=o._formatGuidString(e);if(!t)throw new Error(e+" is not a valid Guid value.");this.guid=t}Object.freeze(this)}static externalGuid(e){return e&&e.guid?"{"+e.guid.toUpperCase()+"}":o.EMPTYSTRING}static fromExternalGuid(e){return e?new o(e.replace(/[\{\}]/gi,"")):o.EMPTY}static validate(e){return null!=e&&null!==a.exec(e)}static toString(e){return e?e.guid:null}static tryParse(e){return o.tryParseOrNull(e)||o.EMPTY}static tryParseOrNull(e){const t=o._formatGuidString(e);return t?new o(t,!0):null}static parse(e){return new o(e)}static _formatGuidString(e){if(!e||"string"!=typeof e)return null;e=e.toLowerCase();const t=a.exec(e);if(t)return t[1].length!==t[8].length?null:t[2];const n=i.exec(e);return n?n.filter((e,t)=>t>0).join("-"):null}static toLegacyGuid(e){return e?r.a.createFromFormattedGuidStringAndSkipParsing(e.guid):null}static fromLegacyGuid(e){if(e){const t=e.toString();if(t)return new o(t,!0)}return null}static equals(e,t){return null==e||null==t?e===t:o.toString(e)===o.toString(t)}static isNullOrEmpty(e){return!e||o.equals(e,o.EMPTY)}static newGuid(){let e="";for(let t=0;t<36;t++)if(14===t)e+="4";else if(8===t||13===t||18===t||23===t)e+="-";else if(19===t){const t=Math.floor(16*Math.random());e+="0123456789abcdef".substr(3&t|8,1)}else e+="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return new o(e,!0)}}o.EMPTYGUIDSTRING="00000000-0000-0000-0000-000000000000",o.EMPTY=new o(o.EMPTYGUIDSTRING,!0),o.EMPTYSTRING=""},SDQ8:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r={};function a(e,t){return r[e]||(r[e]={}),r[e][t]||(r[e][t]=0),`${t}.modelFormComponent.${r[e][t]}.modelFormComponent.${e}`}function i(e,t){return o(e,t),a(e,t)}function o(e,t){var n;const a=null===(n=r[e])||void 0===n?void 0:n[t];null!=a&&(r[e][t]=a+1)}function s(e){delete r[e]}},SDtF:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r,a=n("nuS9"),i=n("4fxQ"),o=n("H/hG"),s=n("YWpA"),c=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=function(e){function t(t){var n=e.call(this,t)||this;return n.mouseEnterHandler=n.mouseEnterHandler.bind(n),n.mouseLeaveHandler=n.mouseLeaveHandler.bind(n),n.setTargetRef=n.setTargetRef.bind(n),n.state={isOpened:!1},n}return c(t,e),t.prototype.generateTooltipStyle=function(){return Object.assign({},{backgroundColor:"#666666",padding:"5px 10px",position:"relative"},this.props.tooltipStyle)},t.prototype.generateTooltipContentStyle=function(){return Object.assign({},{color:"white"},this.props.tooltipContentStyle)},t.prototype.generatePopup=function(){var e=this._targetElement,t=e.offsetLeft,n=e.offsetHeight,r=e.offsetWidth,i={position:"absolute",width:this.props.width,bottom:n+5,left:t},c={};switch(this.props.direction||"top"){case"left":c={bottom:-5,transform:"translateX(-100%)",left:t};break;case"right":c={bottom:-5,left:r+5};break;case"top":c={bottom:n+5,left:t};break;case"bottom":c={bottom:-5,transform:"translateY(100%)",left:t}}return Object.assign(i,c),a.createElement(s.a,{style:i,role:"alertdialog",key:"tooltipPopup"},a.createElement(s.a,{style:this.generateTooltipStyle(),key:"tooltipWrapper"},a.createElement(o.a,{style:this.generateTooltipContentStyle(),role:"tooltip"},this.props.text),this.generatePopupArrow()))},t.prototype.generatePopupArrow=function(){var e={width:0,height:0,fontSize:0,lineHeight:0,borderColor:"transparent",borderTopColor:"#666666",borderWidth:5,borderStyle:"solid",position:"absolute",margin:"auto"},t={};switch(this.props.direction||"top"){case"left":t={transform:"rotate(-90deg)",top:0,bottom:0,right:-10};break;case"right":t={transform:"rotate(90deg)",top:0,bottom:0,left:-10};break;case"top":t={right:0,left:0,bottom:-10};break;case"bottom":t={transform:"rotate(180deg)",top:-10,left:0,right:0}}return Object.assign(e,t),a.createElement(o.a,{style:e})},t.prototype.mouseEnterHandler=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),this.state.isOpened||this.setState({isOpened:!0})},t.prototype.mouseLeaveHandler=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),this.state.isOpened&&this.setState({isOpened:!1})},t.prototype.setTargetRef=function(e){this._targetElement=Object(i.findDOMNode)(e)},t.prototype.render=function(){return a.createElement(s.a,{style:{position:"relative",display:"inline-flex",alignItems:"center"},accessibilityHidden:this.props.accessibilityHidden},a.createElement(s.a,{ref:this.setTargetRef,onPointerEnter:this.mouseEnterHandler,onPointerLeave:this.mouseLeaveHandler,onFocus:this.mouseEnterHandler,onBlur:this.mouseLeaveHandler},this.props.children),this.state.isOpened?this.generatePopup():null)},t}(a.Component);l.defaultProps={width:300}},SEva:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("nuS9"),a=n("u+q+");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i extends r.Component{constructor(e){super(e),this.state={error:null}}render(){const{fallback:e}=this.props,{error:t}=this.state;return t?e(t):this.props.children}componentDidCatch(e,t){const{onError:n,name:r}=this.props;this.props.reportError(r+".ErrorBoundary",e,[{name:"componentStack",value:t.componentStack}]),n(e,t)}}i.getDerivedStateFromError=e=>({error:e});const o=Object(a.a)(void 0,(function(e){return{reportError(t,n,r){e({type:"react.catch",execute:(e,a)=>(a.EventManager.ReportComponentFailure(t,n,void 0,r),Promise.resolve())})}}}))(i);o.displayName="ErrorBoundary",o.defaultProps={fallback:()=>null,onError:()=>{}}},SFgX:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r={activitypointer:"",account:"",audit:"",contact:"",connection:"",customeraddress:"",lead:"",opportunity:"",position:"",competitor:"",quote:"",salesorder:"",invoice:"",product:"",salesliterature:"",list:"",bulkoperation:"",goal:"",metric:"",goalrollupquery:"",report:"",task:"",appointment:"",email:"",phonecall:"",incident:"",queueitem:"",knowledgearticle:"",opportunityproduct:"",systemform:"",team:"",transactioncurrency:"",userform:"",defaulticon:"",defaultrecenticon:"",sharepointdocument:"",service:"",serviceappointment:"",equipment:"",routingrule:"",routingruleitem:"",msdyn_knowledgearticletemplate:"",msdyn_servicelevelagreement:"",msdyn_servicelevelagreementkpi:"",msdyn_servicelevelagreementinstance:"",site:""};function a(e,t){let n=r[e]||"";return t&&-1!==t.indexOf("/workplace/home_dashboards.aspx")&&(n=""),n}},SJ2k:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t){this.previousClientVersion=e,this.currentClientVersion=t,this._dataStore={}}storeData(e,t){this._dataStore[e]=t}getData(e){return this._dataStore[e]}}var a=n("jsc8"),i=n("GdzE");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="8200000000";function s(){return{diagnosticName:"UpgradeHandler",boot:(e,t,s)=>{let c=!1;return function(e){return new Promise((t,n)=>{e.dispatch(Object(a.a)("clientVersion")).then(n=>{null==n?e.dispatch(Object(a.a)("LastUserContextTime")).then(e=>{(n={}).clientVersion=null!=e?o:window.CLIENT_VERSION_VALUE,t({clientVersion:n,hasClientVersionKey:!1})}):t({clientVersion:n,hasClientVersionKey:!0})})})}(s).then(a=>{const{clientVersion:i,hasClientVersionKey:o}=a;c=o;const l=function(e){const t=e.clientVersion,n=window.CLIENT_VERSION_VALUE;return new r(t,n)}(i);return l.previousClientVersion!==l.currentClientVersion?Promise.all([n.e(22),n.e(107)]).then(n.bind(null,"TUTw")).then(({runUpgradeHandlers:n})=>n(e,t,s,l)):l}).then(e=>{!function(e,t,n){if(t.currentClientVersion!==t.previousClientVersion||!n){const n={clientVersion:t.currentClientVersion};e.dispatch(Object(i.a)("clientVersion",n,!1))}}(s,e,c)})}}}},SJlc:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.booleanType="boolean",e.dateTimeType="datetime",e.decimalType="decimal",e.doubleType="double",e.integerType="integer",e.lookupType="lookup",e.memoType="memo",e.moneyType="money",e.optionSetType="optionset",e.stringType="string",e.partylistType="partyList",e.multiSelectOptionSetType="multiselectoptionset",e.entityTypeOptionSet="entityname"}(r||(r={}))},SRl2:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c}));var r=n("eXjw"),a=n("69Qu");
/**form
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i=(e,t)=>e&&e.metadata&&e.metadata.ribbons?e.metadata.ribbons[t]:null,o=(e,t)=>{const n=i(e,t);return n?n.initialized:r.a.Uninitialized},s=(e,t)=>{const n=i(e,t);return!!n&&(Object(a.b)(e)&&n.LoadedWhileOffline)},c=e=>e&&e.metadata?e.metadata.ribbonsLabelIds:null},SRlt:function(e,t,n){"use strict";n.d(t,"b",(function(){return ct})),n.d(t,"a",(function(){return ut})),n.d(t,"c",(function(){return dt})),n.d(t,"f",(function(){return pt})),n.d(t,"e",(function(){return gt})),n.d(t,"g",(function(){return ht})),n.d(t,"d",(function(){return ft}));var r=n("c/eZ"),a=n("3/02"),i=n("FZDd"),o=n("x/aW"),s=n("SZCI"),c=n("l0Rp"),l=n("tHtE"),u=n("GYEz"),d=n("E5IU"),p=n("w1eR"),g=n("0rLi"),h=n("Xe7f"),f=n("JdSN"),m=n("jxo7"),b=n("jZCH"),_=n("EW4s"),y=n("qK01"),v=n("Uv1Y"),S=n("/GRh"),O=n("c0fp"),C=n("UKgB");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class E{getMetadata(){return{boundParameter:null,operationName:"GetRecentItems",operationType:0,parameterTypes:{entityNames:{typeName:"Edm.String",structuralProperty:4},preferredPinnedItems:{typeName:"Edm.Int32",structuralProperty:1},preferredUnpinnedItems:{typeName:"Edm.Int32",structuralProperty:1},preferredPinnedItemsPerEntity:{typeName:"Edm.Int32",structuralProperty:1},preferredUnpinnedItemsPerEntity:{typeName:"Edm.Int32",structuralProperty:1},appId:{typeName:"Edm.String",structuralProperty:1}}}}}var I=n("SAYH"),w=n("Rckk"),j=n("504W"),P=n("XvL5"),T=n("iJGp"),N=n("nxt5"),A=n("RADj"),D=n("DRVD"),R=n.n(D),x=n("sjhR");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class M{getMetadata(){return{boundParameter:null,operationName:"SyncClientMetadata",operationType:0,parameterTypes:{ClientMetadataQueries:{typeName:"mscrm.MetadataQuery",structuralProperty:4}}}}}var F=n("4r2D");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class k{getMetadata(){return{boundParameter:null,operationName:"UpdateRecentItems",operationType:0,parameterTypes:{items:{typeName:"mscrm.RecentItem",structuralProperty:4}}}}}var L=n("PF3G"),B=n("H4dV"),U=n("DS+G"),V=n("iDqy"),z=n.n(V),W=n("d604"),q=n("G0by"),H=n("w72X"),G=n("sNgR"),K=n("4ciL"),Q=n("QRGJ"),X=n("JZmp"),Y=n("iLty");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function J(e,t){return{type:"DESERIALIZE_DISASSOCIATE_RESPONSE_ASYNC",execute({dispatch:e,getState:t},n){const r=new Y.a(null);return Promise.resolve(r)}}}var $=n("Qu5s"),Z=n("KBcj"),ee=n("x0oY"),te=n("d0w6"),ne=n("LbMF"),re=n("iZ7K"),ae=n("eXjw");function ie(e,t,n,r,a,i){if(t&&n&&Object(re.l)(e,a)===ae.a.Initialized){return Object(ee.d)(e,i,t,n,null,null,null,r)}}function oe(e,t){let n=null;const r=Object(Z.a)(e,t,te.a.QUICKFIND_SEARCH);if(r){const t=Object(Z.c)(e,r);t&&t.fetchXML&&(n=Object(l.d)(t.fetchXML))}return n||(n={aliasedValueDescriptors:{},entity2AttributesMap:{}}),n}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const se=[function(){const e={},t={};return{checkEntity:(e,t)=>"activitypointer"===t||Object(re.r)(e,t),deserialize:(n,r="activitypointer",a,i)=>ie(n,Object(re.h)(n,a),e[r]||(e[r]=Object(ne.d)(n,r)),t[r]||(t[r]=oe(n,r)),a,i)}},function(){const e={},t={},n={};return{checkEntity:(e,t)=>!0,deserialize:(r,a,i,o)=>ie(r,t[i]||(t[i]=Object(re.h)(r,i)),e[i]||(e[i]=Object(ne.d)(r,i)),n[i]||(n[i]=oe(r,i)),i,o)}}];var ce=n("Jz1I"),le=n("c46F"),ue=n("wMH2"),de=n("a1q1"),pe=n("WF3G");const ge=/#Microsoft.Dynamics.CRM./gi;function he(e,t){return{type:"DESERIALIZE_EXECUTEQUICKFIND_ASYNC",execute:({getState:n})=>e.json().then(e=>{const r=n(),a=e.Result,i=function(){const e=[];for(const t of se){const n=t();e.push(n)}return e}(),o=[],s=t&&t.get_entityNames();for(let e=0;e<a.length;e++){const t=a[e];let n=s&&s[e];const c=!!n,l=[],u=t.Data;if(u.length>0){let e;for(const t in u){const a=u[t],o=fe(a);if(c||(n=o),!e)for(const t of i)if(t.checkEntity(r,n)){e=t;break}const s=e.deserialize(r,c?n:null,o,a);s&&l.push(s)}}const d=new le.a(n,new ue.a(l,!1,l.length,!1,new pe.a("")),t.ErrorCode);o.push(d)}return new ce.a(new de.a(o))})}}function fe(e){const t=e["@odata.type"];return t&&t.replace(ge,"")}function me(e,t){return{type:"DESERIALIZE_GET_CLIENT_METADATA_RESPONSE_ASYNC",execute:({dispatch:t,getState:n},r)=>ht(e).then(e=>{if(e.Metadata)return JSON.parse(e.Metadata);if(e instanceof f.a)throw e;return{}})}}var be=n("lx8z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function _e(e,t){return{type:"DESERIALIZE_INITIALIZE_FROM_RESPONSE_ASYNC",execute:({dispatch:n,getState:r},a)=>e.json().then(e=>{const r=t.get_targetEntityName();return n(Object(ee.e)(e,r)).then(e=>new be.a(e))})}}var ye=n("Cxkq"),ve=n("OcZc"),Se=n("IuCO"),Oe=n("a8hT"),Ce=n("4N6w"),Ee=n("UwOy"),Ie=n("K7RF"),we=n("hAdb"),je=n("x/BX"),Pe=n("NvOS"),Te=n("qAG9"),Ne=n("BDhr"),Ae=n("wCzE"),De=n("Lyxw"),Re=n("7F2l"),xe=n("yRo8"),Me=n("eeMP"),Fe=n("jAuy"),ke=n("5KQF"),Le=n("O4uv"),Be=n("01Vp"),Ue=n("iEjf"),Ve=n("aRLb");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class ze{getMetadata(){return{boundParameter:null,operationName:"ExecuteQuickFind",operationType:0,parameterTypes:{SearchText:{typeName:"Edm.String",structuralProperty:1},EntityGroupName:{typeName:"Edm.String",structuralProperty:1},EntityNames:{typeName:"Edm.String",structuralProperty:4},AppModule:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}}}}}function We(e){return{type:"SERIALIZE_EXECUTEQUICKFIND_ASYNC",execute({dispatch:t,getState:n},r){const a=new ze;a.SearchText=e.get_searchText(),a.EntityGroupName=e.get_entityGroupName(),a.EntityNames=e.get_entityNames();const i=Object(d.i)(n());if(i){const e={appmoduleid:i,"@odata.type":"Microsoft.Dynamics.CRM.appmodule"};a.AppModule=e}return t(Object(Ve.c)(a)).then(()=>Object(H.a)(n(),a))}}}function qe(e){return{type:"SERIALIZE_GET_CLIENT_METADATA_ASYNC",execute({dispatch:t,getState:n},r){const a=e.get_clientMetadataQuery(),i=Object(o.b)(a),s=new C.a;return s.ClientMetadataQuery=i,Promise.resolve(Object(G.a)(n(),s))}}}var He=n("odYE");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Ge{getMetadata(){return{boundParameter:null,operationName:"InitializeFrom",operationType:1,parameterTypes:{EntityMoniker:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},TargetEntityName:{typeName:"Edm.String",structuralProperty:1},TargetFieldType:{typeName:"Microsoft.Dynamics.CRM.TargetFieldType",structuralProperty:3,enumProperties:[,{name:"All",value:0},{name:"ValidForCreate",value:1},{name:"ValidForUpdate",value:2},{name:"ValidForRead",value:3}]},RetrieveConsumableRecord:{typeName:"Edm.Boolean",structuralProperty:1}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ke(e){return{type:"SERIALIZE_INITIALIZE_FROM_REQUEST_ASYNC",execute({dispatch:t,getState:n},r){const a=new Ge,i=e.get_entityMoniker();return a.EntityMoniker=He.a.legacyToExternalEntityReference(i),a.TargetEntityName=e.get_targetEntityName(),a.TargetFieldType=e.get_targetFieldType(),a.RetrieveConsumableRecord=!0,t(Object(Ve.c)(a)).then(()=>Object(G.a)(n(),a))}}}var Qe=n("zoUO"),Xe=n("n23X"),Ye=n("V0Yx"),Je=n("ATrR"),$e=n("Hevb"),Ze=n("Wiik"),et=n("/oKV"),tt=n("dj6u"),nt=n("Er26"),rt=n("uIhY"),at=n("g22U");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const it=R.a.createEvent(s.t,s.z),ot=R.a.createEvent("Execute",s.z),st=R.a.createEvent("ParseMetadata",s.z),ct="Storage:WebAPIService",lt=["RetrieveEntitiesForAggregateQuery"],ut="application/json";class dt{constructor(e,t,n,r,a){this._store=null,this._applicationContext=null,this._tracer=null,this._eventManager=null,this._settings=null,this._clientHost=null,this._remoteCallRetryHandler=null,this._requestSerializers={Retrieve:Je.c,RetrievePrincipalAccess:Xe.a,Update:$e.c,Create:Le.d,Delete:Be.b,ExecuteMultiple:c.c,InitializeFrom:Ke,RetrieveProcessControlData:Ye.a,RetrieveMultiple:Qe.a,Disassociate:Ue.b,ExecuteQuickFind:We,GetClientMetadata:qe},this._responseDeserializers={Retrieve:ee.f,RetrievePrincipalAccess:ye.a,Update:Se.a,Create:Q.a,Delete:X.a,ExecuteMultiple:$.a,InitializeFrom:_e,RetrieveProcessControlData:ve.a,RetrieveMultiple:l.c,Disassociate:J,ExecuteQuickFind:he,GetClientMetadata:me},this._noFetchFallback=null,this._noSerializerFallback=null,this._credentials="same-origin",this._store=e,this._tracer=a,this._applicationContext=t,this._eventManager=t.EventManager,this._clientHost=n,this._remoteCallRetryHandler=r}get noFetchFallback(){return this._noFetchFallback}set noFetchFallback(e){this._noFetchFallback=e}get noSerializerFallback(){return this._noSerializerFallback}set noSerializerFallback(e){this._noSerializerFallback=e;const t=this._noSerializerFallback,n=this;Object.getOwnPropertyNames(t).concat(Object.getOwnPropertyNames(t.__proto__)).forEach(e=>{"function"==typeof t[e]&&(n[e]||(n[e]=function(){return t[e].apply(t,arguments)}.bind(this)))});const r=[];r.push({name:"WASvcContext",value:dt.AUTO_IMPLEMENT_SOAP_FALLBACK}),this._tracer&&this._tracer.info("Auto-implemented fallbacks to SOAP.",r)}get_Settings(){return this._settings}set_Settings(e){this._settings=e}get_EventManager(){return this._applicationContext.EventManager}_getFetchHeaders(){const e=new Headers,t=this._store.getState();e.append("Content-Type",ut),e.append("OData-MaxVersion","4.0"),e.append("OData-Version","4.0"),e.append("ClientHost",Object(Ee.c)(this._clientHost));const n=Object(d.i)(t);n&&e.append("x-ms-app-id",n);const r=Object(d.m)(t);r&&e.append("x-ms-app-name",r);const a=this._buildUserAgentHeader(t,r);return e.append("x-ms-user-agent",a),e}_buildUserAgentHeader(e,t){const n=Object(Ee.c)(this._clientHost),r=this._clientHost===p.a.Browser?n:`${n} - ${Object(u.g)(e)} - ${Object(u.j)(e)}`;return`PowerApps-UCI/${window.VERSION_NUMERIC_VALUE} (${r}; AppName=${t})`}_addRequestCorrelationHeaders(e){const t={[w.c.SESSION_ID]:this._eventManager.getCurrentSessionId(),[w.c.ACTIVITY_ID]:this._eventManager.getActivityId()};void 0!==e.additionalHeaders&&null!==e.additionalHeaders||(e.additionalHeaders={}),null==e.additionalHeaders||e.additionalHeaders.hasOwnProperty(w.c.CLIENT_REQUEST_ID)||(e.additionalHeaders[w.c.CLIENT_REQUEST_ID]=I.a.newGuid().guid),Object.assign(e.additionalHeaders,t)}Execute(e,t){this._logAttemptToUseOData("Execute");const n=e.get_name(),r={};r[s.r]=n;const a=ot.startStopwatch(r);if(-1!==lt.indexOf(n)){const n=!(t&&t.IsPreloadCall())&&z.a.trackWork("SOAP"),r=this.noSerializerFallback.Execute(e,t);return r.always(()=>{n&&n(),a()}),r}if(this._requestSerializers.hasOwnProperty(n)&&this._responseDeserializers.hasOwnProperty(n)){const r=new _.a,i=this._requestSerializers[n](e);return this._store.dispatch(i).then(a=>{if(!a.serializationFailure)return dt.AddRequestId(a,t&&t.RequestId?t.RequestId():I.a.newGuid().guid),this.sendRequest(a).then(t=>{const r=this._responseDeserializers[n](t,e);return this._store.dispatch(r)}).then(e=>{r.resolve(e)}).catch(e=>{r.reject(e)});this._logRequestSerializationFailed(a,n,a.serializationFailure),r.reject(new f.a(null,"error",a.serializationFailure))}),r.always(()=>a()),r}this._logRequestSerializationFailed(null,n,"No serializer exists for this type of request");const i=this.noSerializerFallback.Execute(e,t);return i.always(()=>a()),i}ExecuteOData(e,t){const n=new _.a,r=e,a=Object(K.a)(this._store.getState(),r);return dt.AddRequestId(a,t&&t.RequestId?t.RequestId():I.a.newGuid().guid),this.sendRequest(a).then(e=>{n.resolve(e)},e=>{n.reject(e)}),n}RetrieveMultipleAttributeMetadata(e,t){const n={[e.get_EntityLogicalName()]:e.get_AttributeNames()},r=new _.a;return this._store.dispatch(Object(i.e)(n)).then(()=>{const t=this._applicationContext.DataSource.get_MetadataCache().getMultipleAttributeMetadata(e.get_EntityLogicalName(),e.get_AttributeNames()),n=new x.a(null);n.set_AttributeMetadata(t),r.resolve(n)},e=>{r.reject(e)}),r}_noFetch(e,t,n){n&&n.AppendCallStack("WebAPIService._noFetch");const r=[];r.push({name:"Tags",value:dt.WEB_API_FALLBACK_TO_JQUERY_AJAX}),this._tracer&&this._tracer.info("Fetch API is not available. Will now fall back to jQuery.ajax to call Web API.",r);const a=!t&&z.a.trackWork("WebAPI");return this._noFetchFallback.FetchFallback(e).nativePromise().then(t=>{a&&a();return this._createNoFetchResponse(t,e)}).catch(t=>{a&&a();const r=t&&t.get_request?t.get_request():null,i=e.urlParameters;let o=null;r&&r.getAllResponseHeaders&&(o=this._parseHeaders(r.getAllResponseHeaders()));const s=()=>r&&r.responseText?Promise.resolve(r.responseText):Promise.resolve(""),c={ok:!1,status:r&&r.status?r.status:null,statusText:r&&r.statusText?r.statusText:null,json:s,text:s,headers:o,url:i};return this.handleODataResponse(c,e,n)})}_createNoFetchResponse(e,t){let n=null;e&&e.headers&&(n=this._parseHeaders(e.headers));const r=()=>e.body?Promise.resolve(e.body):Promise.resolve(e);return{ok:!0,status:e.status,statusText:e.statusText,headers:n,json:r,text:r}}_parseHeaders(e){const t=e.split("\n"),n={};for(let e=0;e<t.length;e++){const r=t[e];if(r&&r.indexOf(":")){const e=r.indexOf(":");if(-1===e)continue;const t=r.substring(0,e).trim(),a=r.substring(e+1,r.length).trim();n[t]=a}}return new S.a(n)}async _fetch(e,t,n){n&&n.AppendCallStack("WebAPIService._fetch"),Object(W.a)(this._store,this._applicationContext,e);const r=Object(tt.b)(this._store.getState()),a=Object(tt.a)(this._store.getState());e.additionalHeaders["x-ms-sw-objectid"]=null!=r?r:"",e.additionalHeaders["x-ms-sw-tenantid"]=null!=a?a:"";const i=e.additionalHeaders,o=this._getFetchHeaders();if(i)for(const e in i)Object(Te.a)(o,e)&&o.delete(e),o.append(e,i[e]);const s=e.endpoint||dt.WEB_API_URL_FRAGMENT,c=Object(Pe.a)(this._store.getState(),s);Object(j.a)(e.urlParameters)||(e.urlParameters=e.urlParameters.replace(/\t|\r|\n/g,""));const l=new Request(`${c}${e.urlParameters}`,{method:e.method,credentials:this._credentials,headers:o,body:e.body});let u=null;u||(n&&n.AppendCallStack("WebAPIService.fetch"),u=fetch(l),!t&&z.a.trackPendingPromise(u.then(e=>e.clone().arrayBuffer()),"WebAPI"));try{const t=await u;return this.handleODataResponse(t,e,n)}catch(t){const n=[];let r=dt.FETCH_FAIL_DEFAULT_MESSAGE;const a=e&&e.additionalHeaders?e.additionalHeaders[w.c.CLIENT_REQUEST_ID]:"Unknown";n.push({name:dt.CLIENT_REQUEST_ID,value:a}),n.push({name:dt.FETCH_ERROR_COMPLETE_TEXT,value:t.toString()}),n.push({name:dt.FETCH_ERROR_NAME,value:t.name?t.name:dt.UNKNOWN}),n.push({name:dt.FETCH_ERROR_STACK,value:t.stack?t.stack:dt.UNKNOWN}),t.message&&(r=t.message,n.push({name:dt.FETCH_ERROR_MESSAGE,value:t.message?t.message:dt.UNKNOWN}));const i=t instanceof f.a;n.push({name:dt.IS_INSTANCE_OF_CRM_ERROR_RESPONSE,value:i});const o=dt.trimUrl(l.url);return n.push({name:dt.REQUEST_URL,value:o}),this._tracer.error(r,n),i?Promise.reject(t):this._createOfflineErrorResponse(null==t?void 0:t.message,o,a)}}_createOfflineErrorResponse(e,t,n){const r=e?e+" url :"+t:"Fetch failed",a=new f.a(null,r,r);return a.set_isErrorInOffline(!0),a.set_clientRequestId(n),Promise.reject(a)}_retryAsBatch(e,t,n){n&&n.AppendCallStack("WebAPIService.__retryAsBatch");const r=[];return dt.addCommonParametersToEventParameters(e,r),this._tracer.warn(dt.LONG_URL_RETRY,r),this._executeSendRequest(t,r,!1,n,!0)}handleODataResponse(e,t,n){return n&&n.AppendCallStack("WebAPIService.handleODataResponse"),e.ok?(this._remoteCallRetryHandler.resetFailures(),e):401===e.status?this._remoteCallRetryHandler.handleAuthError(t).nativePromise().then(()=>this.sendRequest(t,void 0,n),t=>{if(this._tracer){const t=[],n=dt.ODATA_ERROR_DETAILS_MESSAGE;dt.addCommonParametersToEventParameters(e,t),this._tracer.error(n,t)}return Promise.reject(t)}):414===e.status?this._retryAsBatch(e,t,n):e.url&&-1!==e.url.indexOf("$batch")||t&&t.urlParameters&&-1!==t.urlParameters.indexOf("$batch")?Object(Me.b)(e,n).then(n=>{if(null!=n&&n.length>0){const r=n.find(e=>!e.ok)||e;return dt.throwCrmErrorFromResponse(r,t,this._tracer)}if(this._tracer){const t=[],n=e.url?dt.trimUrl(e.url):null,r=e.headers?Object(Te.a)(e.headers,w.c.SERVER_REQUEST_ID):dt.UNKNOWN;t.push({name:dt.HTTP_STATUS_CODE,value:e.status}),t.push({name:dt.HTTP_RESPONSE_TYPE,value:e.type}),t.push({name:dt.HTTP_RESPONSE_STATUSTEXT,value:e.statusText}),t.push({name:dt.RESPONSE_URL,value:n}),t.push({name:dt.SERVER_REQUEST_ID,value:r}),this._tracer.error(dt.BATCH_REQUEST_PARSING_FAIL,t)}let r=null;throw r=new f.a(e,e.statusText,"Batch request failed with http Status : "+e.status),r}):dt.throwCrmErrorFromResponse(e,t,this._tracer).catch(r=>{if(r.get_isRequestTooLong())return this._retryAsBatch(e,t,n);throw r})}static addCommonParametersToEventParameters(e,t){const n=e.headers?Object(Te.a)(e.headers,w.c.SERVER_REQUEST_ID):dt.UNKNOWN,r=e.status?e.status:null,a=e.type?e.type:null,i=e.statusText?e.statusText:null,o=e.url?dt.trimUrl(e.url):null;t.push({name:dt.HTTP_STATUS_CODE,value:r}),t.push({name:dt.HTTP_RESPONSE_TYPE,value:a}),t.push({name:dt.HTTP_RESPONSE_STATUSTEXT,value:i}),t.push({name:dt.RESPONSE_URL,value:o}),t.push({name:dt.SERVER_REQUEST_ID,value:n})}static canLogDetailsOfRequest(e){return!Object(j.a)(e)&&(-1!==e.indexOf("GetClientMetadata")||-1!==e.indexOf("EntityDefinitions")||-1!==e.indexOf("SyncClientMetadata"))}static isSearchRequest(e){return!Object(j.a)(e)&&"/api/search/indexes/default/Entities?api-version=9.0"===e}static trimUrl(e){if(Object(j.a)(e))return e;if(dt.canLogDetailsOfRequest(e))return e;if(-1!==e.indexOf(dt.FETCH_XML_PREFIX)){const t=e.indexOf(dt.FETCH_XML_PREFIX),n=decodeURIComponent(e.substring(e.indexOf(dt.FETCH_XML_PREFIX)+dt.FETCH_XML_PREFIX.length,e.length));return e.substring(0,t+dt.FETCH_XML_PREFIX.length)+Object(Fe.j)(n)}const t=e.indexOf("?");if(-1===t){const t=e.indexOf("=");return-1===t?e:e.substring(0,t)}return e.substring(0,t)}static throwCrmErrorFromResponse(e,t,n){return e.text().then(r=>{let a=null;const i=r&&r.toLowerCase().indexOf("<!doctype html")>-1;a=i?f.a.createFromHtml(r,e):new f.a(e,e.statusText,r);const o=e.headers?Object(Te.a)(e.headers,"Retry-After"):null;if(a.set_retryAfter(o),n){const t=[],o=dt.ODATA_ERROR_DETAILS_MESSAGE;dt.addCommonParametersToEventParameters(e,t),dt.canLogDetailsOfRequest(e.url)&&(t.push({name:dt.ODATA_ERROR_RESPONSE_COMPLETE_TEXT,value:r}),t.push({name:dt.CRM_ERROR_RESPONSE_COMPLETE_TEXT_FROM_ODATA_RESPONSE,value:JSON.stringify(a)})),t.push({name:dt.ODATA_ERROR_RESPONSE_IS_HTML_TYPE,value:i}),n.error(o,t)}const s=e.headers?Object(Te.a)(e.headers,"Content-ID"):null;if(s){const e=Number.parseInt(s,10);e>-1&&a.set_contentId(e)}const c=e.headers?Object(Te.a)(e.headers,w.c.SERVER_REQUEST_ID):dt.UNKNOWN,l=t&&t.additionalHeaders&&t.additionalHeaders.hasOwnProperty(w.c.CLIENT_REQUEST_ID)?t.additionalHeaders[w.c.CLIENT_REQUEST_ID]:dt.UNKNOWN;throw a.set_serverResponseId(c),a.set_clientRequestId(l),a})}_logRequestSerializationFailed(e,t,n){let r=null,a=null;const i=[];e&&(r="EndPoint : "+e.endpoint+", Method: "+e.method+", UrlParameters: "+dt.trimUrl(e.urlParameters),a=Object(at.e)(e)),i.push({name:"RequestName",value:t}),i.push({name:"RequestDetails",value:r}),i.push({name:"ErrorMessage",value:n}),i.push({name:"Tags",value:dt.WEB_API_SOAP_FALL_BACK+","+dt.WEB_API_REQUEST_SERIALIZATION_FAILED}),a&&(i.push({name:nt.c.OPERATION_TYPE,value:a.type}),i.push({name:nt.c.OPERATION_SUB_TYPE,value:a.subType})),this._tracer&&this._tracer.warn("Request serialization failed, Falling back to SOAP.",i)}_executeSendRequest(e,t,n,r,a=!1){if(r&&r.AppendCallStack("WebAPIService._executeSendRequest"),!e)return Promise.reject(new Error("Specified serialized request is empty"));if(e.serializationFailure)return Promise.reject(new Error("Cannot send the request because of the serializatoin failure: "+e.serializationFailure));this._addRequestCorrelationHeaders(e),ft(e);const i="$batch"===e.urlParameters?e.body:e.urlParameters,o={};o[s.y]=i;const l=it.startStopwatch(o),u=performance.now();let d=a;const p=new Promise((t,i)=>{if(!this._simulateNetworkFailureIfConfigured(e,t)){const o=Object(rt.c)(e.urlParameters);if(a&&"$batch"!==e.urlParameters||"GET"===e.method&&o.length>dt.VERY_LONG_URL){d=!0;const a=Object(c.a)(this._store.getState(),[e]);this._addRequestCorrelationHeaders(a);const o=Object(q.addNetworkRequestListener)(e=>{e.body=a.body}),s=dt.fetchAvailable?this._fetch(a,n,r):this._noFetch(a,n,r);o(),s.then(Me.b).then(n=>{t(this.handleODataResponse(n[0],e,r))}).catch(e=>i(e))}else{let a;e.body&&"$batch"===e.urlParameters&&(a=Object(q.addNetworkRequestListener)(t=>{t.body=e.body})),t(dt.fetchAvailable?this._fetch(e,n,r):this._noFetch(e,n,r)),a&&a()}}});return p.then(n=>{var r;let a=null;const i=performance.now()-u;let o=null,s=null,c=null,d=null;n&&(s=n.url,n.headers&&(a=Object(Te.a)(n.headers,w.c.SERVER_REQUEST_ID),o=Object(Te.a)(n.headers,"Content-Length"))),e&&(c="EndPoint : "+e.endpoint+", Method: "+e.method+", UrlParameters: "+dt.trimUrl(e.urlParameters),d=Object(at.e)(e)),t&&t.push({name:dt.CLIENT_REQUEST_ID,value:e.additionalHeaders[w.c.CLIENT_REQUEST_ID]});const p=[];p.push({name:dt.SERVER_REQUEST_ID,value:a}),p.push({name:dt.CLIENT_REQUEST_ID,value:e.additionalHeaders[w.c.CLIENT_REQUEST_ID]}),p.push({name:dt.RESPONSE_TIME,value:i}),p.push({name:dt.RESPONSE_SIZE_IN_BYTES,value:o}),p.push({name:dt.IS_FETCH_AVAILABLE,value:dt.fetchAvailable}),p.push({name:dt.REQUEST_CONTEXT,value:dt.trimUrl(s)}),c&&p.push({name:dt.REQUEST_DETAILS,value:c}),this._remoteCallRetryHandler.isConnectivityRetryEnabled()&&p.push({name:dt.CONNECTIVITY_RETRY_COUNT,value:null!==(r=e.connectivityRetryCount)&&void 0!==r?r:0}),d&&(p.push({name:nt.c.OPERATION_TYPE,value:d.type}),p.push({name:nt.c.OPERATION_SUB_TYPE,value:d.subType})),this._eventManager.ReportComponentSuccess(ct,p);l(a?{requestId:a}:void 0)},n=>{var r;const a=[];let i=null,o=null;const s=n&&n.get_request?n.get_request():null,c=s?s.status:null;let p=null,g=null,h=n&&n.get_message?n.get_message():null;const f=s&&s.headers?Object(Te.a)(s.headers,w.c.SERVER_REQUEST_ID):null,m=performance.now()-u,b=s?dt.trimUrl(s.url):null,_=!(!n||!n.get_isErrorInOffline)&&n.get_isErrorInOffline();if(n.get_organizationServiceFault&&n.get_organizationServiceFault()){g=n.get_organizationServiceFault().get_errorCode();try{null==h&&(h=n.get_error())}catch(e){a.push({name:dt.CRM_ERROR_RESPONSE_GET_ERROR,value:dt.FAILED})}try{const e=JSON.parse(n.get_error());p=e.error&&e.error.innererror?e.error.innererror.stacktrace:null}catch(e){a.push({name:dt.CRM_ERROR_RESPONSE_GET_ERROR_PARSING,value:dt.FAILED})}}const y=this._getClientRequestId(e);t&&t.push({name:dt.CLIENT_REQUEST_ID,value:y});let S=h||dt.REQUEST_FAILURE;const O=s?s.type:null;a.push({name:dt.HTTP_RESPONSE_TYPE,value:O}),a.push({name:dt.IS_FETCH_AVAILABLE,value:dt.fetchAvailable}),a.push({name:dt.HTTP_STATUS_CODE,value:c}),a.push({name:dt.CRM_ERROR_CODE,value:g}),a.push({name:dt.IS_ERROR_IN_OFFLINE,value:_}),a.push({name:dt.REQUEST_CONTEXT,value:b}),a.push({name:dt.CRM_CALL_STACK,value:p}),a.push({name:dt.SERVER_REQUEST_ID,value:f}),a.push({name:dt.CLIENT_REQUEST_ID,value:y}),a.push({name:dt.RESPONSE_TIME,value:m}),a.push({name:dt.IS_BATCH_REQUEST,value:d}),e&&(i="EndPoint : "+e.endpoint+", Method: "+e.method+", UrlParameters: "+dt.trimUrl(e.urlParameters),dt.isSearchRequest(e.endpoint)&&(S=dt.UCIMONITOR_ERROR_MESSAGE),o=Object(at.e)(e)),a.push({name:dt.CRM_ERROR_MESSAGE,value:S}),i&&a.push({name:dt.REQUEST_DETAILS,value:i}),o&&(a.push({name:nt.c.OPERATION_TYPE,value:o.type}),a.push({name:nt.c.OPERATION_SUB_TYPE,value:o.subType}));const C=Object(Ce.a)(this._store.getState());if(C&&a.push({name:dt.TOKEN_LENGTH,value:C.length}),this._remoteCallRetryHandler.isConnectivityRetryEnabled()){const t=this._remoteCallRetryHandler.shouldRetryConnectivityError(e,n);a.push({name:dt.WILL_RETRY_FOR_CONNECTIVITY,value:t}),a.push({name:dt.CONNECTIVITY_RETRY_COUNT,value:null!==(r=e.connectivityRetryCount)&&void 0!==r?r:0})}if([400,404,500,503].indexOf(c)>-1&&Object(Re.a)(ct,g)){const e=new v.a(S,g,null,null,null,null,null,a,null,null,null,null,null,null,c,y,f);this._eventManager.ReportComponentFailure(ct,e,void 0,a)}else this._tracer&&this._tracer.error(S,a);l()}),p}_simulateNetworkFailureIfConfigured(e,t){let n=!1;const r=Object(we.b)(this._store.getState(),"failurePercent");if(r){const a=Number.parseFloat(r);if(!Number.isNaN(a)&&a>0&&a<=100){if(Math.floor(100*Math.random()+1)<=a){n=!0;const r=Object(we.b)(this._store.getState(),"failureTimeout");let a=r&&Number.parseFloat(r);a&&!Number.isNaN(a)||(a=2e4),setTimeout(()=>{t(this._createOfflineErrorResponse("Simulated network failure",e.urlParameters,this._getClientRequestId(e)))},a)}}}return n}_getClientRequestId(e){var t;return(null===(t=null==e?void 0:e.additionalHeaders)||void 0===t?void 0:t[w.c.CLIENT_REQUEST_ID])||dt.UNKNOWN}sendRequest(e,t,n,r=!1){n&&n.AppendCallStack("WebAPIService.sendRequest");const a=b.a.get_DefaultInstance();return new Promise((i,o)=>{if(a&&a.get_IsWaitingForNetwork()){const s=[];s.push({name:dt.REQUEST_METHOD,value:e.method}),s.push({name:dt.REQUEST_URL,value:e.urlParameters}),e.additionalHeaders&&e.additionalHeaders.hasOwnProperty(w.c.CLIENT_REQUEST_ID)&&s.push({name:dt.CLIENT_REQUEST_ID,value:e.additionalHeaders[w.c.CLIENT_REQUEST_ID]}),this._tracer.warn(dt.WAITING_FOR_NETWORK_MESSAGE,s);a.get_WaitingForNetworkPromise().always(c=>a.get_IsNetworkAvailable()?(s.push({name:dt.WAITING_FOR_NETWORK_RESULT,value:dt.SUCCESS}),this._executeSendRequest(e,t,r,n).then(e=>(this._tracer.warn(dt.WAITING_FOR_NETWORK_SUCCEEDED_SERVER_REQUEST_SUCCEEDED_MESSAGE,s),i(e))).catch(e=>(this._tracer.error(dt.WAITING_FOR_NETWORK_SUCCEEDED_SERVER_REQUEST_FAILED_MESSAGE,s),o(e)))):(s.push({name:dt.WAITING_FOR_NETWORK_RESULT,value:dt.FAILED}),this._tracer.error(dt.WAITING_FOR_NETWORK_FAILED_MESSAGE,s),o(v.a.fromErrorCode(this._store.getState(),-2147093999))))}else this._executeSendRequest(e,t,r,n).then(e=>i(e)).catch(e=>o(e))}).catch(a=>{var i;if(this._remoteCallRetryHandler.shouldRetryConnectivityError(e,a)){e.connectivityRetryCount=(null!==(i=e.connectivityRetryCount)&&void 0!==i?i:0)+1;const a=[];return a.push({name:dt.CLIENT_REQUEST_ID,value:this._getClientRequestId(e)}),this._tracer.warn(dt.RETRYING_ON_CONNECTIVITY_ERROR,a),this.sendRequest(e,t,n,r)}throw a})}RetrieveUserContext(e,t){const n=new _.a,r=Object(d.i)(this._store.getState()),a=e=>{if(Object(j.a)(e)||Object(j.a)(e.UserContext)||Object(j.a)(e.UserContext[0])){const e=[];e.push({name:"ErrorMessage",value:"UserContext was not returned from GetClientMetadata call"});const t=dt.PRELOAD_USERCONTEXT_CALL_DETAILS;this._tracer.error(t,e),n.reject(new f.a(null,"error","UserContext was not returned from GetClientMetadata call"))}else{if(Object.keys(e).length>1){const t=Object(ke.a)(e,null,null,this._store.getState(),null,null,this._tracer,r);t.webResourcesContent=null,this._store.dispatch(Object(Ie.c)(t))}n.resolve(new U.a(!0,null,-1,e.UserContext[0]))}},i=e=>{const t=new g.a(null,null,null,null,[],!1,T.a.UserContext,null,[],I.a.toLegacyGuid(I.a.tryParseOrNull(r))),o=new F.a(I.a.newGuid().guid);e?Object(Oe.b)().then(async e=>{try{const n=await this._store.dispatch(e.getClientMetadata(t,o,et.a.Remote)),r=[];r.push({name:dt.OTHER_DETAILS,value:"UserContext call succeeded in via MDL Remote "}),this._eventManager.ReportComponentSuccess(nt.e.ModernDataSourceUserContext,r),a(n)}catch(e){const t=[];t.push({name:dt.CRM_ERROR_CODE,value:e._errorCode}),t.push({name:dt.CRM_ERROR_MESSAGE,value:e.message}),t.push({name:dt.CRM_CALL_STACK,value:e.stack}),t.push({name:dt.OTHER_DETAILS,value:"UserContext call failed in via MDL Remote, retry in legacy path again "}),this._eventManager.ReportComponentFailure(nt.e.ModernDataSourceUserContext,new Error("UserContext call failed in via MDL Remote, retry in legacy path again "),"",t),i(!1)}}):this.GetClientMetadata(t,o).then(a,e=>{const t=[];t.push({name:dt.CLIENT_REQUEST_ID,value:e.get_clientRequestId()}),t.push({name:dt.OTHER_DETAILS,value:e.get_message()}),t.push({name:dt.CRM_CALL_STACK,value:o.get_Stack()});const r=dt.PRELOAD_USERCONTEXT_CALL_DETAILS;this._tracer.error(r,t),n.reject(e)}).catch(e=>{const t=[];t.push({name:dt.CLIENT_REQUEST_ID,value:e.get_clientRequestId()}),t.push({name:dt.OTHER_DETAILS,value:e.get_message()}),t.push({name:dt.CRM_CALL_STACK,value:o.get_Stack()});const r=dt.PRELOAD_USERCONTEXT_CALL_DETAILS;this._tracer.error(r,t),n.reject(e)})},o=window.__uciServerPreload;return o&&o.userContext?o.userContext.then(async e=>{o.userContext=null;const t=[],r=dt.PRELOAD_USERCONTEXT_CALL_DETAILS;dt.addCommonParametersToEventParameters(e,t),t.push({name:dt.CLIENT_ACTIVITY_ID,value:window.__preload.initialActivityId}),e.ok?ht(e).then(async e=>{e.Metadata?(t.push({name:dt.OTHER_DETAILS,value:"Preload userContext call was successful."}),t.push({name:nt.c.OPERATION_TYPE,value:at.c.GCM}),t.push({name:nt.c.OPERATION_SUB_TYPE,value:at.b.GetClientMetadata}),this._eventManager.ReportComponentSuccess(ct,t),a(JSON.parse(e.Metadata))):(t.push({name:dt.OTHER_DETAILS,value:"Preload userContext call was successful but response does not have any metadata.Request in the usual flow again."}),this._tracer&&this._tracer.error(r,t),await i(b.a.useMDLForUserContextDuringBoot))}).catch(e=>{this._tracer&&this._tracer.error(e.message),n.reject(e)}):(t.push({name:dt.OTHER_DETAILS,value:"Preload userContext call wasn't successful. Request in the usual flow again"}),this._tracer&&this._tracer.error(r,t),await i(b.a.useMDLForUserContextDuringBoot))}):i(b.a.useMDLForUserContextDuringBoot),n}Create(e,t,n){const r=new _.a,a=e.get_fieldTypes(),o=e.get_fieldNames().filter(e=>"lookup"===a[e]||"customer"===a[e]||"owner"===a[e]).map(t=>e.getValue(t).LogicalName).reduce((e,t)=>(e[t]=null,e),{}),s=e.get_identifier().LogicalName;return o.hasOwnProperty(s)||(o[s]=[]),this._store.dispatch(Object(i.e)(o)).then(()=>{const a=new h.a(e,t);return this.Execute(a,n).then(e=>r.resolve(e),e=>r.reject(e))}),r}Update(e,t,n){const r=new _.a;return this._store.dispatch(Object(i.f)(e.get_identifier().LogicalName,!1,[])).then(()=>{const a=new L.a(e,t);return this.Execute(a,n).then(e=>r.resolve(e),e=>r.reject(e))}),r}DeleteEntity(e,t){const n=new _.a;return this._store.dispatch(Object(i.f)(e.LogicalName,!1,[])).then(()=>{const r=new y.a(e);return this.Execute(r,t).then(e=>n.resolve(e),e=>n.reject(e))}),n}WhoAmI(){const e=new _.a,t={urlParameters:"WhoAmI",additionalHeaders:{Accept:ut},method:"GET",additionalParameters:{[at.a.TYPE]:at.c.FUNCTION,[at.a.SUB_TYPE]:at.b.WhoAmI}};return this.sendRequest(t).then(e=>ht(e)).then(t=>{e.resolve(new N.a("WhoAmI"))}).catch(t=>{e.reject(t)}),e}getQueryMetadataAndData(e,t=!1){const n=e.get_EntityLogicalName(),r=pt(e),a=e.get_SourceId();return this._store.dispatch(Object(i.f)(n,r.getAllColumns,r.columnNames)).then(()=>{const r=this._store.getState(),i={urlParameters:`${Object(re.o)(r,n)}?fetchXml=${encodeURIComponent(e.get_FetchXml())}`,additionalHeaders:{Prefer:'odata.include-annotations="*"',Accept:ut,"x-ms-source-id":a},method:"GET",additionalParameters:{[at.a.TYPE]:at.c.RETRIEVE_MULTIPLE,[at.a.SUB_TYPE]:e&&e.get_queryContext()?e.get_queryContext():at.b.RetrieveMultipleOther}};return this.sendRequest(i,void 0,void 0,t).then(ht)})}RetrieveMultiple(e,t){const n=new _.a,r=Object(l.e)(e),a=Object(i.e)(r.entity2AttributesMap),o=this._store.dispatch(a),s=t&&t.IsPreloadCall();return Promise.all([o,this.getQueryMetadataAndData(e,s)]).then(t=>{const a=t.pop();if(a.error)n.reject(a.error);else{const t=this._store.getState(),i=Object(l.a)(t,e,r,a,null,null,this._tracer);n.resolve(new m.a(i))}},e=>{n.reject(e)}),n}_constructBodyParamsByRequest(e){const t=e;return Object.keys(e.getMetadata().parameterTypes).reduce((e,n)=>(e[n]=t[n],e),{})}_prepareSerializedPostFromRequest(e){const t=this._constructBodyParamsByRequest(e);return{urlParameters:e.getMetadata().operationName,additionalHeaders:{Accept:ut,Prefer:'odata.include-annotations="*"'},method:"POST",body:JSON.stringify(t),additionalParameters:{[at.a.TYPE]:at.c.ACTION,[at.a.SUB_TYPE]:e.getMetadata().operationName}}}GetRecentItems(e,t,n,r,a,i){const o=new _.a,s=new E;s.entityNames=t,s.preferredPinnedItems=n,s.preferredPinnedItemsPerEntity=a,s.preferredUnpinnedItems=r,s.preferredUnpinnedItemsPerEntity=i,s.appId=e.toString();const c=this._prepareSerializedPostFromRequest(s);return this.sendRequest(c).then(e=>ht(e)).then(e=>{o.resolve(e.recentItems)}).catch(e=>o.reject(e)),o}UpdateRecentItems(e){const t=new _.a,n=new k;n.items=e;const r=this._prepareSerializedPostFromRequest(n);return this.sendRequest(r).then(e=>{t.resolve(e.status)},e=>{t.reject(e)}),t}GetClientMetadata(e,t){t&&t.AppendCallStack("WebAPIService.GetClientMetadata");const n=new _.a;try{const r=Object(o.b)(e),i=this._store.getState();null===I.a.tryParseOrNull(Object(d.i)(i))&&"appmodules"===e.MetadataType&&(r.AppId=I.a.fromLegacyGuid(e.MetadataId));const s=Object(De.c)(i,a.Xb),c=s?new O.a:new C.a;c.ClientMetadataQuery=r;const l=Object(G.a)(this._store.getState(),c);if(dt.AddRequestId(l,t&&t.RequestId?t.RequestId():I.a.newGuid().guid),l.urlParameters&&e.MetadataType!==o.a.BusinessProcessFlow&&e.MetadataType!==o.a.MetadataVersion&&e.MetadataType!==o.a.UserMetadataVersion&&e.DependencyDepth!==T.a.UserContext){const e=Object(Ae.a)(i),t=Object(Ne.a)(i),n=e.currentVersion?e.currentVersion:-1,r=t.currentVersion?t.currentVersion:-1;l.urlParameters=l.urlParameters+`&umv=${n.toString()}&mv=${r.toString()}`}l.urlParameters=l.urlParameters+dt.API_FRAGMENT_9_1,Object(je.a)(i)&&(l.additionalHeaders.Consistency="Strong",this._store.dispatch(Object(Ze.b)(!1))),this.sendRequest(l,null,t,e.IsPreloadCall).then(e=>ht(e)).then(e=>{if(e.Metadata){const r=st.startStopwatch();t&&t.AppendCallStack("WebAPIService.JSON.parse"),n.resolve(this._parseResponse(e.Metadata,s)),r()}else e instanceof f.a?n.reject(e):n.resolve({})}).catch(e=>{const r=e&&e.message?e.message:"Error happens during GCM call",a=[];a.push({name:dt.CLIENT_REQUEST_ID,value:l.additionalHeaders[w.c.CLIENT_REQUEST_ID]}),a.push({name:dt.CRM_CALL_STACK,value:t.get_Stack()}),this._tracer.error(r,a),n.reject(e)})}catch(e){e instanceof v.a||e instanceof f.a||(this._tracer.error(e.message),e=new f.a(null,"Error",e.message)),n.reject(e)}return n}static AddRequestId(e,t){null!=e&&null!=t&&(null==e.additionalHeaders||e.additionalHeaders.hasOwnProperty(w.c.CLIENT_REQUEST_ID)||(e.additionalHeaders[w.c.CLIENT_REQUEST_ID]=t))}SyncClientMetadata(e){const t=new _.a,n=new M;n.ClientMetadataQueries=e.map(o.b);const r=Object(H.a)(this._store.getState(),n),a=(new Date).getTime();return this.sendRequest(r).then(e=>(this._store.dispatch(Object(xe.i)({syncStatus:A.a.InProgress,downloadTime:(new Date).getTime()-a})),ht(e))).then(e=>{if(e.Metadata){const n=(new Date).getTime(),r=JSON.parse(e.Metadata);this._store.dispatch(Object(xe.i)({syncStatus:A.a.InProgress,downloadSize:e.Metadata.length,parseTime:(new Date).getTime()-n})),t.resolve(r)}else t.resolve({})}).catch(e=>{t.reject(e)}),t}ExecuteExternalSearch(e,t,n){const r=Object(d.i)(this._store.getState());null!=r&&(e+="&appid="+r);const a={endpoint:dt.EXTERNAL_SEARCH_WEBAPI_URL_FRAGMENT,urlParameters:e,method:"GET",additionalParameters:{[at.a.TYPE]:at.c.EXTERNAL_SEARCH,[at.a.SUB_TYPE]:at.b.ExternalSearch}};return this.sendRequest(a,n,t).then(e=>ht(e))}GetIsActivityFlags(){const e=new _.a,t={urlParameters:"EntityDefinitions?$select=IsActivity,IsVisibleInMobileClient,ObjectTypeCode,LogicalName,DisplayName,DisplayCollectionName,ActivityTypeMask&$filter=IsActivity eq true",additionalHeaders:{Accept:ut},method:"GET",additionalParameters:{[at.a.TYPE]:at.c.ENTITY_DEFINITION,[at.a.SUB_TYPE]:at.b.EntityDefinition}},n=()=>{this.sendRequest(t).then(t=>ht(t).then(t=>{e.resolve(t)}).catch(t=>{e.reject(t)}))},r=window.__uciServerPreload;return r&&r.activityFlags?r.activityFlags.then(t=>{r.activityFlags=null;const a=[],i=dt.PRELOAD_ACTIVITY_CALL_DETAILS;dt.addCommonParametersToEventParameters(t,a),a.push({name:dt.CLIENT_ACTIVITY_ID,value:window.__preload.initialActivityId}),t.ok?ht(t).then(t=>{t.value?(a.push({name:dt.OTHER_DETAILS,value:"Preload IsActivity call was successful."}),a.push({name:nt.c.OPERATION_TYPE,value:at.c.ENTITY_DEFINITION}),a.push({name:nt.c.OPERATION_SUB_TYPE,value:at.b.EntityDefinition}),this._eventManager&&this._eventManager.ReportComponentSuccess(ct,a),e.resolve(t)):(a.push({name:dt.OTHER_DETAILS,value:"Preload isActitivty call was successful but response does not have any value. Request in the usual flow again."}),this._tracer&&this._tracer.error(i,a),n())}).catch(t=>{e.reject(t)}):(a.push({name:dt.OTHER_DETAILS,value:"Preload IsActivity call wasn't successful. Request in the usual flow again."}),this._tracer&&this._tracer.error(i,a),n())}):n(),e}_logAttemptToUseOData(e){const t=[];t.push({name:"MethodName",value:e}),t.push({name:"Tags",value:dt.WEB_API_ATTEMPT_TO_USE_ODATA}),this._tracer&&this._tracer.info("Method was called. Will attempt to use OData.",t)}get requestSerializers(){return this._requestSerializers}get responseDeserializers(){return this._responseDeserializers}static get fetchAvailable(){const e=B.a.getInstance();return!(e.get_isIPhone()||e.get_isIPad())&&"function"==typeof window.fetch}_parseResponse(e,t,n){return n&&n.AppendCallStack("WebAPIService.parseResponse"),t?e&&e.OtherMetadata?this._parseGetClientMetadataExResponse(e,n):[]:this._parseGetClientMetadataResponse(e,n)}_parseGetClientMetadataResponse(e,t){return t&&t.AppendCallStack("WebAPIService.parseGetClientMetadataResponse"),JSON.parse(e)}_parseGetClientMetadataExResponse(e,t){t&&t.AppendCallStack("WebAPIService.parseGetClientMetadataExResponse");const{OtherMetadata:n}=e,a=Object(r.__rest)(e,["OtherMetadata"]),i=JSON.parse(e.OtherMetadata);if(Object.assign(a,i),a.Entities){const e=[];a.Entities.forEach(t=>{const n=Object.assign(Object.assign({},t.EntityMetadata),t.AttributeNames);e.push(n)}),a.Entities=e}if(a.RelationshipNavigationEntities){const e=[];a.RelationshipNavigationEntities.forEach(t=>{const n=Object.assign(Object.assign({},t.EntityMetadata),t.AttributeNames);e.push(n)}),a.RelationshipNavigationEntities=e}return a}}function pt(e){return gt(e.get_ColumnSet())}function gt(e){const t=!(e instanceof P.a);let n;return t||(n=e.get_Columns()),{getAllColumns:t,columnNames:n}}function ht(e,t){return t&&t.AppendCallStack("WebAPIService.parseJsonResponse"),Promise.resolve().then(()=>{if(e){const n=Object(Te.a)(e.headers,"Content-Type");return n&&n.indexOf("text/html")>-1?(t&&t.AppendCallStack("WebAPIService.response.text"),e.text().then(t=>{throw f.a.createFromHtml(t,e)})):(t&&t.AppendCallStack("WebAPIService.response.json"),e.json())}throw new v.a("Null response from server")})}function ft(e){void 0!==e.additionalHeaders&&null!==e.additionalHeaders||(e.additionalHeaders={}),e.additionalHeaders.hasOwnProperty(w.c.PREFER)?e.additionalHeaders[w.c.PREFER].indexOf("odata.include-annotations=")<0?e.additionalHeaders[w.c.PREFER]=`${e.additionalHeaders[w.c.PREFER]},${w.d.ANNOTATIONS}`:e.additionalHeaders[w.c.PREFER]=e.additionalHeaders[w.c.PREFER].replace(/odata\.include-annotations="[^"]+"/,w.d.ANNOTATIONS):e.additionalHeaders[w.c.PREFER]=w.d.ANNOTATIONS}dt.TRACER_CATEGORY_ID="WebApiService",dt.WEB_API_FALLBACK_TO_JQUERY_AJAX="web_api_fallback_to_jquery_ajax",dt.WEB_API_SOAP_FALL_BACK="web_api_soap_fall_back",dt.WEB_API_ATTEMPT_TO_USE_ODATA="web_api_attempt_to_use_odata",dt.WEB_API_REQUEST_SERIALIZATION_FAILED="web_api_request_serialization_failed",dt.AUTO_IMPLEMENT_SOAP_FALLBACK="auto_implement_soap_fallback",dt.WEB_API_URL_FRAGMENT="/api/data/v9.0/",dt.EXTERNAL_SEARCH_WEBAPI_URL_FRAGMENT="/api/search/indexes/default/Entities?api-version=9.0",dt.API_FRAGMENT_9_1="&api-version=9.1",dt.HTTP_STATUS_CODE="HTTP-Status-Code",dt.HTTP_RESPONSE_TYPE="HTTP-Response-Type",dt.HTTP_RESPONSE_STATUSTEXT="HTTP-Response-StatusText",dt.RESPONSE_URL="Response-Url",dt.RESPONSE_SIZE_IN_BYTES="Response-Size-In-Bytes",dt.ODATA_ERROR_RESPONSE_COMPLETE_TEXT="Odata-Error-Response-Complete-text",dt.ODATA_ERROR_RESPONSE_IS_HTML_TYPE="Odata-Error-Response-Is-Html-Type",dt.CRM_ERROR_RESPONSE_COMPLETE_TEXT_FROM_ODATA_RESPONSE="Crm-Error-Response-From-OdataResponse",dt.IS_INSTANCE_OF_CRM_ERROR_RESPONSE="IsInstanceOfCrmErrorResponse",dt.FETCH_ERROR_COMPLETE_TEXT="Fetch-Error-Complete-Text",dt.FETCH_ERROR_NAME="Fetch-Error-Name",dt.FETCH_ERROR_STACK="Fetch-Error-Stack",dt.FETCH_ERROR_MESSAGE="Fetch-Error-Message",dt.IS_FETCH_AVAILABLE="IsFetchAvailable",dt.CRM_ERROR_CODE="Crm-Error-Code",dt.IS_ERROR_IN_OFFLINE="ErrorInOffline",dt.CRM_ERROR_MESSAGE="Crm-Error-Message",dt.REQUEST_DETAILS="Request-Details",dt.REQUEST_CONTEXT="Request-Context",dt.CRM_CALL_STACK="Crm-Call-Stack",dt.RESPONSE_TIME="Response-Time",dt.TOKEN_LENGTH="TokenLength",dt.FETCH_FAIL_DEFAULT_MESSAGE="Fetch failed",dt.REQUEST_URL="Request-Url",dt.ODATA_ERROR_DETAILS_MESSAGE="WebAPIService:Odata Error Response Details",dt.UCIMONITOR_ERROR_MESSAGE="WebAPIService:UciMonitor Error Response Details",dt.UNKNOWN="Unknown",dt.FAILED="Failed",dt.SUCCESS="Success",dt.CRM_ERROR_RESPONSE_GET_ERROR="Crm-Error-Response-Get-Error",dt.CRM_ERROR_RESPONSE_GET_ERROR_PARSING="Crm-Error-Response-Get-Error-Parsing",dt.REQUEST_FAILURE="Request Failure",dt.IS_BATCH_REQUEST="Is-Batch-Request",dt.BATCH_REQUEST_PARSING_FAIL="Batch response parsing has failed",dt.OTHER_DETAILS="Other-Details",dt.PRELOAD_USERCONTEXT_CALL_DETAILS="Preload:UserContext Call Details",dt.PRELOAD_ACTIVITY_CALL_DETAILS="Preload:Activity Call Details",dt.REQUEST_METHOD="Method",dt.WAITING_FOR_NETWORK_RESULT="Waiting-For-Network-Result",dt.WAITING_FOR_NETWORK_MESSAGE="Waiting few seconds for network as network is offline",dt.WAITING_FOR_NETWORK_SUCCEEDED_SERVER_REQUEST_SUCCEEDED_MESSAGE="Waiting few seconds for network succeeded and the subsequent request to server also succeeded",dt.WAITING_FOR_NETWORK_SUCCEEDED_SERVER_REQUEST_FAILED_MESSAGE="Waiting few seconds for network succeeded but the request to server failed",dt.WAITING_FOR_NETWORK_FAILED_MESSAGE="Waiting few seconds for network failed as network is still offline",dt.FETCH_XML_PREFIX="fetchXml=",dt.RETRYING_ON_CONNECTIVITY_ERROR="Retrying request for connectivity error",dt.WILL_RETRY_FOR_CONNECTIVITY="Will-Retry-For-Connectivity",dt.CONNECTIVITY_RETRY_COUNT="Connectivity-Retry-Count",dt.LONG_URL_RETRY="Retry-Due-To-Long-Url",dt.CLIENT_REQUEST_ID="Client-Request-Id",dt.SERVER_REQUEST_ID="Server-Request-Id",dt.CLIENT_ACTIVITY_ID="Client-Activity-Id",dt.VERY_LONG_URL=16300},"SSL+":function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return f}));var r=n("DRVD"),a=n.n(r),i=n("zmaG"),o=n.n(i),s=n("iDqy"),c=n.n(s),l=n("pEXn"),u=n("SZCI"),d=n("G0by"),p=n("SAYH"),g=n("Rckk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function h(e){return!!e&&e.indexOf("GetClientMetadata")>=0}function f(e,t){Object(d.setStopwatchHeadersGetter)(t=>{if(t&&(0===t.indexOf(e)||"/"===t[0]))return[{headerName:g.c.SERVER_REQUEST_ID,parameterName:l.x.ServerActivityId}]}),Object(d.setAdditionalHeadersGetter)(n=>!n||0!==n.indexOf(e)&&"/"!==n[0]?{}:{[g.c.SESSION_ID]:t.getCurrentSessionId(),[g.c.ACTIVITY_ID]:t.getActivityId(),[g.c.CLIENT_REQUEST_ID]:p.a.newGuid().guid}),Object(d.setNetworkRequestTrackingFilter)(e=>e&&-1===e.indexOf("dc.services.visualstudio.com")&&-1===e.indexOf("dc.applicationinsights.microsoft.com")&&-1===e.indexOf("uci_cdn_connection_check")&&-1===e.indexOf("pipe.aria.microsoft.com")&&-1===e.indexOf(".ttf?")&&-1===e.indexOf(".woff?"));let n=0,r=0,i=0;const s=()=>{const e={metadata:n,webService:r,assetLoads:i};o.a.addCommonKpiParameters({[l.b.PageLoadParameters.NetworkRequestInfo]:JSON.stringify(e)},!0)};c.a.subscribeToAppWorking(()=>{n=0,r=0,i=0,o.a.onNextIdleProcessing(s)}),c.a.isAppIdle()||o.a.onNextIdleProcessing(s),a.a.registerTransport({writeMarker(e,t,n){},writeRetroactiveTimespan(e,t,a,i){e.getName()===u.t&&(r+=1,h(i[u.y])&&(n+=1))},startTimespan:(e,t,a)=>(e.getName()===u.t&&(r+=1,h(a[u.y])&&(n+=1)),()=>{})},[u.z]),a.a.registerTransport({writeMarker(e,t,n){},writeRetroactiveTimespan(e,t,n,r){},startTimespan:(e,t,n)=>(i++,()=>{})},[u.a])}},SSc5:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("gQ5I"),a=n("OmkB"),i=n("aOhN"),o=n("oT5e");function s(e){return{type:"router.backbutton.async",execute({dispatch:t,getState:n},s){e||(e={}),e.targetBrowsingContext||(e.targetBrowsingContext=Object(o.e)(n()));const l=s.Router.getDialogIdStack(),u=n();if(l.length>0){let n=l[l.length-1];if(c(n))for(let e=l.length-1;e>=0;e--)if(!c(l[e])){n=l[e];break}return c(n)?t(Object(i.b)(e)):isNaN(parseInt(n,10))?t(Object(a.a)(n,!0)):t(Object(r.e)(n))}if(u.pages&&Object.keys(n().pages).length>0)return t(Object(i.b)(e))}}}function c(e){return-1!==e.indexOf("__flyoutRootNode")}},STW0:function(e,t,n){"use strict";var r,a,i;Object.defineProperty(t,"__esModule",{value:!0}),t.writeToConsole=t.getIssueDefinitions=t.PerformanceIssueLevel=t.PerformanceIssueType=void 0,function(e){e[e.Warning=0]="Warning",e[e.Error=1]="Error"}(a||(a={})),t.PerformanceIssueLevel=a,function(e){e[e.WorkBlockTimeout=0]="WorkBlockTimeout",e[e.SyncXHR=1]="SyncXHR",e[e.UnmemoizedSelector=2]="UnmemoizedSelector",e[e.ComponentUpdateDuringIdleTask=3]="ComponentUpdateDuringIdleTask",e[e.IdleTaskAddedFromIdleTask=4]="IdleTaskAddedFromIdleTask",e[e.MaxIdleTimeExceeded=5]="MaxIdleTimeExceeded",e[e.NetworkRequestQuotaIssues=6]="NetworkRequestQuotaIssues",e[e.WorkTimeOutOfBounds=7]="WorkTimeOutOfBounds",e[e.ExternalNetworkRequest=8]="ExternalNetworkRequest",e[e.MetadataCallDuringWarmLoad=9]="MetadataCallDuringWarmLoad",e[e.MismatchedKeyPerformanceIndicators=10]="MismatchedKeyPerformanceIndicators",e[e.ErrorDuringAutomation=11]="ErrorDuringAutomation",e[e.ObjectCountIncrease=12]="ObjectCountIncrease",e[e.ExcessiveRendering=13]="ExcessiveRendering"}(i||(i={})),t.PerformanceIssueType=i,t.writeToConsole=function(e){var t=s()[e.type],n="Performance issue (type: "+(e.level===a.Error?"error":"warning")+"): "+t.name+" | "+e.message+".";t.documentationUrl&&(n+=" Please see "+t.documentationUrl+" for resolution."),console.warn(n,e.parameters)};var o=((r={})[i.WorkBlockTimeout]={name:"Work block action(s) timeout",documentationUrl:null},r[i.SyncXHR]={name:"Synchronous XHR",documentationUrl:null},r[i.UnmemoizedSelector]={name:"Unmemoized selector",documentationUrl:null},r[i.ComponentUpdateDuringIdleTask]={name:"Component update during idle tasks",documentationUrl:null},r[i.IdleTaskAddedFromIdleTask]={name:"Idle task added from idle task",documentationUrl:null},r[i.MaxIdleTimeExceeded]={name:"Max app idle time exceeded",documentationUrl:null},r[i.NetworkRequestQuotaIssues]={name:"Network request quota issues",documentationUrl:null},r[i.WorkTimeOutOfBounds]={name:"Work time out of bounds",documentationUrl:null},r[i.ExternalNetworkRequest]={name:"External network request",documentationUrl:null},r[i.MetadataCallDuringWarmLoad]={name:"Metadata call during warm load",documentationUrl:null},r[i.MismatchedKeyPerformanceIndicators]={name:"Mismatched key performance indicator",documentationUrl:null},r[i.ErrorDuringAutomation]={name:"Error during automation",documentationUrl:null},r[i.ObjectCountIncrease]={name:"Object count increase",documentationUrl:null},r[i.ExcessiveRendering]={name:"Excessive rendering",documentationUrl:null},r);function s(){return o}t.getIssueDefinitions=s},SV62:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("Lyxw"),a=n("3/02"),i=n("E5IU"),o=n("NjDY");function s(e){return!(!Object(r.c)(e,a.hb)||"msdyn_ConnectedStore"!==Object(i.l)(e))||Object(o.x)(e).isCrmOrg}},SWZ5:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s}));var r=n("XlXz"),a=n("y60j"),i=n("zmL5"),o=n("5DN6");const s="staticTab";function c(e,t,n){return{type:"execute.markactivetab.async",execute({dispatch:c,getState:l},u){const d=l(),p=Object(o.c)(d,n),g=Object(i.b)(d,n),h=p.sessionTabs,f=p.controlNames.map(e=>Object(a.b)(d,n,g,e));if(e.type===s){if(t){const t=f.findIndex(t=>t.Id===e.id);if(t>-1){const e=f.splice(t,1);f.unshift(e[0])}}}else if(t){const t=h.findIndex(t=>t.id===e.id);if(t>-1){const e=h.splice(t,1);h.unshift(e[0])}}return c(function(e,t){return{type:r.g,payload:e,meta:{pageId:t}}}({sessionTabs:h,controlNames:f.map(e=>e.Name),activeTabId:e.id},n)),Promise.resolve()}}}},"SX+A":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s}));var r=n("sclX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="platform.initialize",i="platform.state.change";function o(e,t=r.a.Active){return{type:a,payload:{state:t,type:e}}}function s(e){return{type:i,payload:e}}},SZCI:function(e,t,n){"use strict";n.d(t,"u",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"s",(function(){return i})),n.d(t,"x",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"m",(function(){return u})),n.d(t,"o",(function(){return d})),n.d(t,"l",(function(){return p})),n.d(t,"n",(function(){return g})),n.d(t,"v",(function(){return h})),n.d(t,"g",(function(){return f})),n.d(t,"i",(function(){return m})),n.d(t,"q",(function(){return b})),n.d(t,"h",(function(){return _})),n.d(t,"k",(function(){return y})),n.d(t,"p",(function(){return v})),n.d(t,"a",(function(){return S})),n.d(t,"z",(function(){return O})),n.d(t,"t",(function(){return C})),n.d(t,"y",(function(){return E})),n.d(t,"r",(function(){return I})),n.d(t,"w",(function(){return w})),n.d(t,"b",(function(){return j})),n.d(t,"j",(function(){return P}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Shim",a="ClientAPI",i="Core.Scheduler",o="Core.Actions.Sync",s="CustomScripts",c="CustomControlsFramework",l="CustomControls",u="init",d="updateView",p="controlId",g="manifestControlName",h="SlowFrames",f="EditFormLoad",m="FullLoad",b="MscrmControls.Containers.RelevanceSearchControl",_="GlobalSearch",y="RelevanceSearch",v="perf",S="Core.AssetLoader",O="WebService",C="SendRequest",E="urlParameters",I="requestName",w="Storage",j="Core.Boot",P="LivePersonaCard"},Sbn7:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("ABCl"),a=n("16wZ"),i=n("IaGr");class o{constructor(e){this._collection={},this._clientApiExecutor=new r.b(null,"ClientApi.XrmCollection.",null,[{name:"callerComponentName",value:e,isEventParam:!0}])}forEach(e){this._clientApiExecutor.execute("forEach",(t,n)=>{if(!e)return n.push({name:"name",value:"handler"}),void i.a.getInstance().traceManager.getTracer(t).error("Required parameter is null or undefined",n);if("function"!=typeof e)return n.push({name:"expectedType",value:"function"}),n.push({name:"name",value:typeof e}),void i.a.getInstance().traceManager.getTracer(t).error("Parameter type validation error",n);let a=0;for(const i in this._collection){const o=this._collection[i];Object(r.c)(t,n,()=>{e(o,a)}),a++}})}add(e,t){return this._clientApiExecutor.execute("add",(n,r)=>{if(e in this._collection){const a="An element with the same key already exists in the dictionary";r.push({name:"valueIsEqual",value:t===this._collection[e]?"true":"false"}),this._clientApiExecutor.reportFailure(n,new Error(a),r)}this._collection[e]=t},[{name:"key",value:e,isRequired:!0,isEventParam:!0}],!1)}get(e){return this._clientApiExecutor.execute("get",(t,n)=>{let r=null;return null==e?r=this._getAll():"string"==typeof e?r=this._getByName(e.toString()):"number"==typeof e?r=this._getByIndex(Number(e)):"function"==typeof e?r=this._getByFilter(e,t,n):(n.push({name:"type",value:typeof e}),Object(a.k)(t,"string|number|function","parameter",n)),r})}getFirst(e){return this._clientApiExecutor.execute("getFirst",(t,n)=>{if("function"!=typeof e)return n.push({name:"expectedType",value:"function"}),n.push({name:"name",value:typeof e}),i.a.getInstance().traceManager.getTracer(t).error("Parameter type validation error",n),null;let a=0;for(const i in this._collection){const o=this._collection[i];if(Object(r.c)(t,n,()=>{if(e(o,a))return o}))return o;a++}return null},[{name:"filter",value:e,isRequired:!0}])}getLength(){return this._clientApiExecutor.execute("getLength",()=>Object.keys(this._collection).length)}remove(e){const t=Object.keys(this._collection).find(t=>this._collection[t]===e);t&&delete this._collection[t]}getAll(){return this._clientApiExecutor.execute("getAll",()=>this._getAll())}getByName(e){return this._clientApiExecutor.execute("getByName",()=>this._getByName(e),[{name:"name",value:e,isEventParam:!0}])}getByIndex(e){return this._clientApiExecutor.execute("getByIndex",()=>this._getByIndex(e),[{name:"position",value:e,isEventParam:!0}])}getByFilter(e){return this._clientApiExecutor.execute("getByFilter",(t,n)=>e?"function"!=typeof e?(n.push({name:"expectedType",value:"function"}),n.push({name:"name",value:typeof e}),i.a.getInstance().traceManager.getTracer(t).error("Parameter type validation error",n),[]):this._getByFilter(e,t,n):(n.push({name:"name",value:"filter"}),i.a.getInstance().traceManager.getTracer(t).error("Required parameter is null or undefined",n),[]))}_getAll(){return Object.keys(this._collection).map(e=>this._collection[e])}_getByName(e){let t=this._collection[e];return void 0===t&&(t=null),t}_getByIndex(e){let t=null;const n=Object.keys(this._collection);if(n.length>e){const r=n[e];t=this._collection[r]}return t}_getByFilter(e,t,n){const a=[];let i=0;for(const o in this._collection){const s=this._collection[o];Object(r.c)(t,n,()=>{e(s,i)&&a.push(s)}),i++}return a}}},ScMg:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(){this._stateObsrevers=[]}registerObserver(e){e&&-1===this._stateObsrevers.indexOf(e)&&this._stateObsrevers.push(e)}notifyObservers(e){this._stateObsrevers.forEach(t=>{t.update(e)})}}var a=n("ZIjf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class i{constructor(e,t,n,a){this._controlName=a,this._pageId=n,this._contextToken=t,this._controlStateObservable=new r}getName(){return a.a.instance.reportUsage("ClientApi.XrmControlBase.getName"),this._controlName}get name(){return this._controlName}get pageId(){return this._pageId}get contextToken(){return this._contextToken}get connectedControlProps(){return{controlName:this.name,id:this.pageId}}get controlStateObservable(){return this._controlStateObservable}}},SeXA:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="action.dummy";function a(){return{type:r,payload:null}}},Sit7:function(e,t,n){"use strict";var r=n("tXbx"),a={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function c(e){return r.isMemo(e)?o:s[e.$$typeof]||a}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0};var l=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,g=Object.getPrototypeOf,h=Object.prototype;e.exports=function e(t,n,r){if("string"!=typeof n){if(h){var a=g(n);a&&a!==h&&e(t,a,r)}var o=u(n);d&&(o=o.concat(d(n)));for(var s=c(t),f=c(n),m=0;m<o.length;++m){var b=o[m];if(!(i[b]||r&&r[b]||f&&f[b]||s&&s[b])){var _=p(n,b);try{l(t,b,_)}catch(e){}}}return t}return t}},SjFn:function(e,t,n){"use strict";function r(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}n.d(t,"a",(function(){return r}))},Smta:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r,a=n("CGM5"),i=n("eb03"),o=n("HMYz"),s=n("iDZS"),c=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype._handleSelected=function(e){this.props.onSelected&&this.props.onSelected(e)},t.prototype.componentWillReceiveProps=function(e){e.isSelected&&e.isSelected!==this.props.isSelected&&this._handleSelected(this)},t.prototype.getElementName=function(){return"li"},t.prototype.getElementProps=function(){var e;return(e={})[i.y]=this.props.isSelected,e["data-text"]=this.props.dataText,e["data-value"]=this.props.dataValue,e["data-expanded"]=this.props.dataExpanded,e},t.displayName="ListItem",t}(a.a);function u(e){return e&&e.style?e.isSelected&&e.selectedStyle?Object.assign({},Object.assign({},e.style,e.selectedStyle),Object(s.b)(e)):Object.assign(e.style,Object(s.b)(e)):{}}var d=o.connect((function(e){return function(t){return t.renderRule(u,e)}}))(l)},SnEr:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="record.remove";function a(e){const t={entities:{[e.etn]:{[e.id.guid]:null}}};return{type:r,payload:t}}},SoYb:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){if(e)switch(e.toLowerCase()){case"false":case"0":return!1;case"true":case"1":return!0;default:return}}function a(e){const t=parseInt(e,10);if(!isNaN(t))return t}function i(e){const t=parseFloat(e);if(!isNaN(t))return t}function o(e){if(!e)return;let t,n,r,a=-1;const i=new RegExp("([1-9]|1[012]):([0-5][0-9]):([0-5][0-9])(\\s*)([aApP][mM]{0,2})").exec(e);return i&&(t=parseFloat(i[1]),"pm"===i[5]?t+=12:12===t&&(t=0),n=parseFloat(i[2]),r=parseFloat(i[3]),isNaN(t)||isNaN(n)||isNaN(r)||(a=3600*Math.floor(t)+60*Math.floor(n)+r)),a}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o}))},SocB:function(e,t,n){"use strict";n.d(t,"d",(function(){return _})),n.d(t,"k",(function(){return c})),n.d(t,"i",(function(){return b})),n.d(t,"e",(function(){return s})),n.d(t,"j",(function(){return p})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r=.41,a=.5,i=.68;var o;function s(e){return c(e).luminosity<.5?"#000000":"#FFFFFF"}function c(e,t){let n=String(e).replace(/[^0-9a-f]/gi,"");n.length<6&&(n=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]),t||(t=0);let r="#";let a=0;for(let e=0;e<3;e++){let i=parseInt(n.substr(2*e,2),16);i=Math.round(Math.min(Math.max(0,i+255*t),255)),a+=e===o.red?.299*i:e===o.green?.587*i:.114*i;const s=i.toString(16);r+=("00"+s).substring(s.length)}return{rgb:r,luminosity:1-a/255}}function l(e){return{Fill:e,Text:s(e)}}function u(e,t){c(e).luminosity>.8&&(e=c(e,.25).rgb);const n=g("#ffffff",e,t);return{Fill:n,Text:s(n)}}function d(e){if(c(e).luminosity<.2){const t=g("#000000",e,.1);return{Fill:t,Text:s(t)}}const t=function(e,t){const n=function(e){const t=e[0]/255,n=e[1]/255,r=e[2]/255,a=Math.max(t,n,r),i=Math.min(t,n,r),o=(a+i)/2;let s,c;if(a===i)s=c=0;else{const e=a-i;switch(c=o>.5?e/(2-a-i):e/(a+i),a){case t:s=(n-r)/e+(n<r?6:0);break;case n:s=(r-t)/e+2;break;case r:s=(t-n)/e+4}s/=6}return[s,c,o]}(m(e)),r=Math.min(1,Math.max(0,n[2]+t)),a=h(n[0],n[1],Math.max(0,r));return f(a[0],a[1],a[2])}(e,-.1);return{Text:s(t),Fill:t}}function p(e,t,n){return function(e,t){const n=c(e).luminosity,r=c(t).luminosity;return n>r?(n+.05)/(r+.05):(r+.05)/(n+.05)}(e,n)<4.4?t:e}function g(e,t,n){const r=m(e),a=m(t);if(n<0||n>1)return"#000000";return f(Math.round(a[0]*(1-n)+r[0]*n),Math.round(a[1]*(1-n)+r[1]*n),Math.round(a[2]*(1-n)+r[2]*n))}function h(e,t,n){let r,a,i;if(0===t)r=a=i=n;else{const o=function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e},s=n<.5?n*(1+t):n+t-n*t,c=2*n-s;r=o(c,s,e+1/3),a=o(c,s,e),i=o(c,s,e-1/3)}return[Math.round(255*r),Math.round(255*a),Math.round(255*i)]}function f(e,t,n){return"#"+("0"+e.toString(16)).slice(-2)+("0"+t.toString(16)).slice(-2)+("0"+n.toString(16)).slice(-2)}function m(e){return/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(e)?(t=e,[parseInt(t.substring(1,3),16),parseInt(t.substring(3,5),16),parseInt(t.substring(5,7),16)]):[0,128,0];var t}function b(e){if(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(e))return e;const t=e.match(/^\d+|\d+\b|\d+(?=\w)/g);if(/rgb/.test(e))return f(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10));if(/hsl/.test(e)){const e=h(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10));return f(e[0],e[1],e[2])}return"#080"}!function(e){e[e.red=0]="red",e[e.green=1]="green",e[e.blue=2]="blue"}(o||(o={}));const _={Red:{Red1:"#ffa2a2",Red2:"#ff0c00",Red3:"#ea0600",Red4:"#bf0900",Red5:"#800600"},Blue:{Blue1:"#96bee2",Blue2:"#6199d1",Blue3:"#2975b2",Blue4:"#045999",Blue5:"#04437c",Blue6:"#3a96dd",Blue7:"#001433",Blue8:"#0742AB",Blue9:"#2266E3"},Teal:{Teal1:"#99ebed",Teal2:"#00ced3",Teal3:"#00b7c3",Teal4:"#008992",Teal5:"#005c62"},Orange:{Orange1:"#ffd199",Orange2:"#ffaf4d",Orange3:"#ff8c00",Orange4:"#f2670c",Orange5:"#c2530a"},Green:{Green1:"#bdf2a7",Green2:"#91ea6d",Green3:"#47c21d",Green4:"#358717",Green5:"#1c6512"},Yellow:{Yellow1:"#fae8a7",Yellow2:"#f7cf52",Yellow3:"#f2c624",Yellow4:"#bf991f",Yellow5:"#725a0d"},Clay:{Clay1:"#f4c0b9",Clay2:"#e2614f",Clay3:"#db3923",Clay4:"#a42b1a",Clay5:"#6e1d12"},Pink:{Pink1:"#ffddf2",Pink2:"#ffc7ea",Pink3:"#ffa8da",Pink4:"#b26491",Pink5:"#652f4e"},Violet:{Violet1:"#e6bdee",Violet2:"#b860c1",Violet3:"#a638b2",Violet4:"#6a1e7a",Violet5:"#47104c"},Purple:{Purple1:"#e9bbff",Purple2:"#a350c4",Purple3:"#8c2ab5",Purple4:"#691b88",Purple5:"#46125b",Purple6:"#742774",Purple7:"#672367"},Grey:{Grey1:"#efefef",Grey2:"#e2e2e2",Grey3:"#d8d8d8",Grey4:"#b3b3b3",Grey5:"#666666",Grey6:"#444444",Grey7:"#333333",Grey8:"#FAF9F8",Grey9:"#F3F2F1"},White:"#FFFFFF",Black:"#000000",Transparent:"#FFFFFF",CalculateContrast:s}},T544:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("504W"),a=n("2F73"),i=n("XvL5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class o{constructor(e,t){this._entityLogicalName=null,this._attributeNames=null,this._ValidateNames(e,t)}get_EntityLogicalName(){return this._entityLogicalName}get_validAttributeRegExp(){return o._validAttributeRegExp||(o._validAttributeRegExp=new RegExp("^[A-Za-z]+[A-Za-z0-9_]*$")),o._validAttributeRegExp}get_AttributeNames(){return this._attributeNames}toString(){const e=new Sys.StringBuilder;return e.append(this._entityLogicalName),Object(r.a)(this._attributeNames)||(e.append(" : "),e.append(this._attributeNames.join(", "))),e.toString()}_ValidateNames(e,t){if(this._entityLogicalName=e,t instanceof a.a?this._attributeNames=null:t instanceof i.a?this._attributeNames=t.get_Columns():this._attributeNames=t,!Object(r.a)(this._attributeNames))for(let e=0;e<this._attributeNames.length;e++){if(!this.get_validAttributeRegExp().test(this._attributeNames[e]))throw Error.argument(this._attributeNames[e],"Invalid attribute name")}}}o._validAttributeRegExp=null},T6Zt:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("ghNp"),a=n("16wZ"),i=n("ZIjf"),o=n("lJW1"),s=n("qshH");let c;class l{constructor(e,t,n){e||Object(a.j)("ClientApi.XrmKBSearchUI.constructor","store"),t||Object(a.j)("ClientApi.XrmKBSearchUI.constructor","contextToken"),c=e,this._contextToken=t,this._pageId=n}get control(){const e="ClientApi.XrmKBSearchUI.control";try{if(i.a.instance.reportCall(e),!this._xrmSearchWidgetControl){const e={};this._xrmSearchWidgetControl=new o.a(c,this._contextToken,this._pageId,e,"MscrmControls.KbSearchControl.KbSearchControl",null)}return i.a.instance.reportSuccess(e),this._xrmSearchWidgetControl}catch(t){throw s.a.getInstance().reportFailure(e,t),t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let u;class d{constructor(e,t,n){const i="ClientApi.XrmKBSearch.constructor";e||Object(a.j)(i,"store"),n||Object(a.j)(i,"pageId"),t||Object(a.j)(i,"contextToken"),u=e,this._pageId=n,this._contextToken=t,u.dispatch(Object(r.a)(this,n,t))}get context(){return i.a.instance.reportUsage("ClientApi.XrmKBSearch.context_get"),this._globalContext}set context(e){i.a.instance.reportUsage("ClientApi.XrmKBSearch.context_set"),this._globalContext=e}get data(){return i.a.instance.reportUsage("ClientApi.XrmKBSearch.data"),null}get ui(){try{return i.a.instance.reportCall("ClientApi.XrmKBSearch.ui"),this._ui||(this._ui=new l(u,this._contextToken,this._pageId)),i.a.instance.reportSuccess("ClientApi.XrmKBSearch.ui"),this._ui}catch(e){const t=s.a.getInstance().getEventParameters(this._contextToken);throw s.a.getInstance().reportFailure("ClientApi.XrmKBSearch.ui",e,null,t),e}}getControl(){const e="ClientApi.XrmKBSearch.getControl";try{i.a.instance.reportCall(e);const t=this.ui.control;return i.a.instance.reportSuccess(e),t}catch(t){const n=s.a.getInstance().getEventParameters(this._contextToken);throw s.a.getInstance().reportFailure(e,t,null,n),t}}}},TBkx:function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"j",(function(){return p})),n.d(t,"g",(function(){return h})),n.d(t,"f",(function(){return f})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"i",(function(){return g})),n.d(t,"a",(function(){return s}));var r=n("JdSN"),a=n("SAYH");const i=2147500038,o=2147500039,s=-2147098623,c=/\b((\d|[a-fA-F]){8}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){12})\b/;function l(e,t){if(e instanceof Error)return e;if(!e){const e="No error data provided.";return t&&t.info(e),Error(e)}const n=function(e,t){const n=Error("blank");let a="";e.source&&(e.source.actionType&&(a+="\nactionType: "+e.source.actionType),e.source.contextId&&(a+="\ncontextId: "+e.source.contextId));e.reason&&(e=e.reason);if(e.errorFault&&(e.errorFault.get_Message||e.errorFault.get_message)&&e.errorFault.get_responseText)return n.message=(e.errorFault.get_message?e.errorFault.get_message():e.errorFault.get_Message())+a,n.stack=e.errorFault.get_responseText(),t&&t.warn("Unsupported codepath: Error object for telemetry being created from ErrorFault.",[{name:"ErrorMessage",value:n.message}]),n;if(e instanceof r.a)return n.message=e.get_message()+a,n.stack="No stack available.",t&&t.warn("Unsupported codepath: Error object for telemetry being created from OrganizationServiceFault.",[{name:"ErrorMessage",value:n.message}]),n;if(e.get_Message)return n.message=e.get_Message()+a,n.stack="No stack available.",n;if(e.message)return n.message=e.message+a,n.stack=e.stack||"No stack available.",n;return null}(e,t);if(n)return n;const a=Error("blank");if("string"==typeof e||e instanceof String)a.message=e.valueOf();else if(e.message)a.message=e.message;else{let n="";try{n=JSON.stringify(e)}catch(e){n="Error provided failed to be stringified: "+e.message}a.message=n;const r="Error provided lacks error message: "+n;t&&t.info(r)}return e.stack?a.stack=e.stack:a.stack="No stack available.",a}function u(e,t){const n=l(e);let r="Message: "+(n.message?n.message:t);return n.stack&&(r+="\nStack: "+n.stack),r}function d(e){return 2147811606===e}function p(e){return e===i}function g(e){return e&&e.errorCode&&e.getNegativeErrorCode&&-2147220960===e.getNegativeErrorCode()&&e.message&&e.message.includes("prvUseTabletApp")}function h(e){if(!e||!e.errorCode||!e.message||!e.message.includes("appmodule")&&!e.message.includes("App Module"))return!1;const t=e.getNegativeErrorCode();return-2147093987===t||-2147220969===t}function f(e){if(!e)return null;const t=c.exec(e);if(!t||!t.length)return null;const n=t[0].trim();return new a.a(n)}},TDVd:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n("2yvP"),a=n("ghNp"),i=n("NjDY"),o=n("IqkD"),s=n("iZ7K"),c=n("odYE"),l=n("SAYH"),u=n("5Oca"),d=n("M0zh"),p=n("dHD5"),g=n("cUMa"),h=n("Sbn7"),f=n("ILmX");class m{constructor(){this._xrmPrimaryGridCache=null,this._xrmSubGridCache={},this._xrmPrimaryFormCache=null,this._xrmQuickFormCache={}}evaluateParameters(e,t,n,r,a,c,p,g,h){const m=[];let b;if(n){const _=Object(u.i)(c,n.EntityLogicalName);return _&&n.EntityId&&(b=_[n.EntityId.guid]),e.forEach(e=>{var u;switch(e.Name){case"BoolParameter":case"DecimalParameter":case"IntParameter":case"StringParameter":m.push({name:e.ParameterName,value:e.Value});break;case"CrmParameter":default:switch(e.ParameterType){case 18:case 19:case 20:case 21:m.push({name:e.ParameterName,value:e.Value});break;case 14:const _=Object(i.x)(c);_?m.push({name:e.ParameterName,value:_.organizationUniqueName}):m.push({name:e.ParameterName,value:null});break;case 15:const y=Object(i.x)(c);m.push({name:e.ParameterName,value:y.languageCode});break;case 16:const v=Object(o.w)(c);v?m.push({name:e.ParameterName,value:v.languageId}):m.push({name:e.ParameterName,value:null});break;case 1:if(b&&b.identifier){const t=Object(s.h)(c,b.identifier.etn);m.push({name:e.ParameterName,value:t.ObjectTypeCode})}else if(n.EntityLogicalName){const t=Object(s.p)(c,n.EntityLogicalName);m.push({name:e.ParameterName,value:t})}else m.push({name:e.ParameterName,value:null});break;case 2:b&&b.identifier?m.push({name:e.ParameterName,value:b.identifier.etn}):n.EntityLogicalName?m.push({name:e.ParameterName,value:n.EntityLogicalName}):m.push({name:e.ParameterName,value:null});break;case 3:if(n.EntityId){const t=[];t.push(l.a.externalGuid(n.EntityId)),m.push({name:e.ParameterName,value:t})}else m.push({name:e.ParameterName,value:null});break;case 4:n.EntityId?m.push({name:e.ParameterName,value:l.a.externalGuid(n.EntityId)}):m.push({name:e.ParameterName,value:null});break;case 7:case 8:let S=null;if(1===n.ContextType||3===n.ContextType||6===n.ContextType||4===n.ContextType||n.ContextEntityLogicalName?S=n.ContextEntityLogicalName:n.EntityLogicalName&&(S=n.EntityLogicalName),S&&7===e.ParameterType){const t=Object(s.p)(c,S);m.push({name:e.ParameterName,value:t})}else m.push({name:e.ParameterName,value:S});break;case 11:case 22:m.push({name:e.ParameterName,value:n.SelectedItems.length});break;case 25:m.push({name:e.ParameterName,value:n.AllItems.length});break;case 28:m.push({name:e.ParameterName,value:n.AllItems.length-n.SelectedItems.length});break;case 9:case 23:case 29:case 26:case 24:case 30:case 27:let O=!0;9!==e.ParameterType&&23!==e.ParameterType&&29!==e.ParameterType&&26!==e.ParameterType||(O=!1);const C=[],E=[];if(9===e.ParameterType||23===e.ParameterType||24===e.ParameterType)n.SelectedItems.length>0&&n.SelectedItems.forEach(e=>{const t=l.a.toString(e.EntityReference.id);C.push(t);const n=Object(s.h)(c,e.EntityReference.etn),r={Id:t,Name:e.EntityReference.name,TypeName:e.EntityReference.etn,TypeCode:n&&n.ObjectTypeCode};E.push(r)});else if(null!=n.AllItems){const t=[];29===e.ParameterType&&n.SelectedItems.length>0&&n.SelectedItems.forEach(e=>{t.push(l.a.externalGuid(e.EntityReference.id))}),n.AllItems.forEach(e=>{const n=l.a.toString(e.id);if(-1===t.indexOf(n)){C.push(n);const t=Object(s.h)(c,e.etn),r={Id:n,Name:e.name,TypeName:e.etn,TypeCode:t&&t.ObjectTypeCode};E.push(r)}})}1===t?m.push({name:e.ParameterName,value:C.join()}):O?m.push({name:e.ParameterName,value:E}):m.push({name:e.ParameterName,value:C});break;case 10:if(n.SelectedItems.length>0){const t=n.SelectedItems[0].EntityReference;m.push({name:e.ParameterName,value:l.a.externalGuid(t.id)})}else m.push({name:e.ParameterName,value:null});break;case 5:case 12:switch(n.ContextType){case 2:m.push({name:e.ParameterName,value:this.getForm(r,c,p)});break;case 1:g&&""!==g?m.push({name:e.ParameterName,value:this.getSubGrid(g,r,c,p,n)}):m.push({name:e.ParameterName,value:this.getGrid(r,c,p,n)});break;case 8:m.push({name:e.ParameterName,value:this.getDashboard(g,r,c,p)});break;case 3:case 4:case 6:5===e.ParameterType?m.push({name:e.ParameterName,value:this.getForm(r,c,p)}):m.push({name:e.ParameterName,value:this.getSubGrid(g,r,c,p,n)});break;case 7:5===e.ParameterType?m.push({name:e.ParameterName,value:this.getForm(r,c,p)}):m.push({name:e.ParameterName,value:this.getQuickForm(r,g,c,p)});break;default:m.push({name:e.ParameterName,value:null})}break;case 6:case 13:m.push({name:e.ParameterName,value:null});break;case 17:const I=null!==(u=n.ContextEntityLogicalName)&&void 0!==u?u:n.EntityLogicalName,w={SourceControlId:a.replace(new RegExp(d.c,"g"),I),CommandValueId:Object(f.d)(c,h,a)};n&&n.CustomControlType&&(w.CustomControlType=n.CustomControlType),m.push({name:e.ParameterName,value:w});break;case 0:default:m.push({name:e.ParameterName,value:null})}}}),m}}static containsCommandPropertiesReference(e){return e.some(e=>{switch(e.Name){case"BoolParameter":case"DecimalParameter":case"IntParameter":case"StringParameter":return!1;case"CrmParameter":default:return 17===e.ParameterType}})}_generateContextSpecificGridControl(e,t){return Object(r.b)("ribbon.parameters",()=>{let n=e;if(e&&e.getGrid&&e.getGrid()&&t&&t.SelectedItems){const r=e.getGrid(),a=r.getSelectedRows(),i=t.SelectedItems.map(e=>e.EntityReference),o=a.get().map(e=>e&&e.data&&e.data.entity&&e.data.entity.getId()&&e.data.entity.getEntityName()&&new c.a(e.data.entity.getEntityName(),new l.a(e.data.entity.getId())));if(!Object(g.a)(i,o,c.a.equals)){const t=Object.assign(Object.create(Object.getPrototypeOf(r)),r),a=r.getRows().get(),o=a.map(e=>e&&e.data&&e.data.entity&&e.data.entity.getId()&&e.data.entity.getEntityName()&&new c.a(e.data.entity.getEntityName(),new l.a(e.data.entity.getId())));t.getSelectedRows=()=>a.reduce((e,t,n)=>{for(let r=0;r<i.length;r++){const a=i[r];if(c.a.equals(a,o[n])){const n=a.id.guid;return e.add(n,t),e}}return e},new h.a("Commanding.EvaluateParameters._generateContextSpecificGridControl")),n=Object.assign(Object.create(Object.getPrototypeOf(e)),e),n.getGrid=()=>t}}return n})}getGrid(e,t,n,r){if(!this._xrmPrimaryGridCache){const a=this._getObject(t,n,null,e,p.k);this._xrmPrimaryGridCache=this._generateContextSpecificGridControl(a,r)}return this._xrmPrimaryGridCache}getSubGrid(e,t,n,r,a){if(!this._xrmSubGridCache[e]){const i=this._getObject(n,r,e,t,null);this._xrmSubGridCache[e]=this._generateContextSpecificGridControl(i,a)}return this._xrmSubGridCache[e]}getDashboard(e,t,n,r){return this._xrmPrimaryDashboardCache||(this._xrmPrimaryDashboardCache=this._getObject(n,r,e,t,p.j)),this._xrmPrimaryDashboardCache}getForm(e,t,n){return this._xrmPrimaryFormCache||(this._xrmPrimaryFormCache=this._getObject(t,n,null,e,p.j)),this._xrmPrimaryFormCache}getQuickForm(e,t,n,r){return this._xrmQuickFormCache[t]||(this._xrmQuickFormCache[t]=this._getObject(n,r,t,e,null)),this._xrmQuickFormCache[t]}_getObject(e,t,n,r,i){if(!n){if(!i)return null;n=Object(p.v)(i(e,r))}return Object(a.e)(r,n,t.ClientApiManager)}}},TEuE:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return w})),n.d(t,"g",(function(){return A})),n.d(t,"c",(function(){return D})),n.d(t,"f",(function(){return T})),n.d(t,"e",(function(){return N}));var r=n("DRVD"),a=n.n(r),i=n("iDqy"),o=n.n(i),s=n("SZCI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c=a.a.createEvent("TaskSchedulerPause",s.s);let l;const u={priorityIndex:0,name:"Rendering"},d={priorityIndex:1,name:"Accessibility"};let p=-1;const g=[u,d],h=[],f=g.map(e=>({priority:e,perfEvent:a.a.createEvent("TaskScheduler."+e.name,s.s),tasks:[]}));let m=0,b=-1,_=!1,y=-1;const v=window.requestIdleCallback;const S=window.cancelIdleCallback;function O(e){S?S(e):clearTimeout(e)}function C(e){const t=m;m=Math.max(e,0),0===m?E(!1):1===m&&E(!0),m>t&&(b=performance.now())}function E(e){!_&&e&&(l=c.startStopwatch(),-1===y&&(y=setInterval(I,500)),O(p),p=-1),_=e,_||(l&&l(),l=null,P())}function I(){const e=performance.now()-b;_?e>400&&C(0):e>2e3&&(clearInterval(y),y=-1)}function w(e){C(m+1),e.then(()=>{C(m-1)},()=>{C(m-1)})}function j(e=!1){if(_&&!e)return;const t=o.a.trackWork("TaskScheduler",!1);let n;try{const r=g.slice(),a=()=>h.length>0?h.shift():r.shift();for(let t=a();null!=t;t=a()){const r=f[t.priorityIndex],a=r.tasks.slice();r.tasks=[],n=r.perfEvent.startStopwatch();let i=!1;for(;a.length>0;){const e=a.pop();void 0!==e&&(e(),i=!0)}if(n&&n(),n=void 0,0===h.length&&!e&&i)break}}finally{t(),n&&n(),A()&&P()}}function P(){var e;-1!==p||_||(e=()=>{p=-1,j()},p=v?v(e,{timeout:300}):setTimeout(e,1))}function T(e,t){const n=f[t.priorityIndex].tasks;return n.push(e),P(),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}function N(e){-1===h.indexOf(e)&&h.push(e)}function A(){for(const e of f)if(e.tasks.length>0)return!0;return!1}function D(){O(p),p=-1,j(!0)}},TFb5:function(e,t,n){"use strict";n.d(t,"q",(function(){return i})),n.d(t,"o",(function(){return o})),n.d(t,"m",(function(){return u})),n.d(t,"n",(function(){return d})),n.d(t,"p",(function(){return p})),n.d(t,"b",(function(){return g})),n.d(t,"e",(function(){return f})),n.d(t,"g",(function(){return h})),n.d(t,"a",(function(){return m})),n.d(t,"f",(function(){return _})),n.d(t,"k",(function(){return y})),n.d(t,"j",(function(){return v})),n.d(t,"r",(function(){return S})),n.d(t,"i",(function(){return O})),n.d(t,"h",(function(){return C})),n.d(t,"c",(function(){return E})),n.d(t,"s",(function(){return I})),n.d(t,"l",(function(){return l})),n.d(t,"d",(function(){return b}));var r=n("504W"),a=n("eruq");function i(e){return(new DOMParser).parseFromString(e,"text/xml")}function o(e,t){if(!Object(r.a)(e)&&!Object(r.a)(e.attributes)){const n=e.attributes.getNamedItem(t);if(!Object(r.a)(n))return n.nodeValue}return null}function s(e,t,n){const r=e.createAttribute(t);return r.value=n,r}function c(e,t,n){return o(e,n)===o(t,n)}function l(e){var t,n;const i=Object(a.b)(e);if(!i)return{};const o=i.getElementsByTagName("entity")[0].getAttribute("name"),s={[o]:[]},c=i.getElementsByTagName("attribute");for(let e=0;e<c.length;e++){const a=c[e],i=null===(t=a.attributes)||void 0===t?void 0:t.getNamedItem("name").nodeValue;if("link-entity"!==(null===(n=null==a?void 0:a.parentNode)||void 0===n?void 0:n.nodeName)||Object(r.a)(a.parentNode.getAttribute("name")))s[o].push(i);else{const e=a.parentNode.getAttribute("name"),t=a.getAttribute("name");Object(r.a)(s[e])?s[e]=[t]:s[e].push(t)}}return s}function u(e){if(Object(r.a)(e))return null;if(p(e))return null;const t=[],n=e.getElementsByTagName("attribute");for(let e=0;e<n.length;e++){const a=n[e],i=a.attributes.getNamedItem("name").nodeValue;if("link-entity"!==a.parentNode.nodeName||Object(r.a)(a.parentNode.attributes.getNamedItem("alias")))t[e]=i;else{const n=a.parentNode.attributes.getNamedItem("alias").nodeValue;t[e]=n+"."+i}}return t}function d(e){const t=null==e?void 0:e.getElementsByTagName("entity");if(!Object(r.a)(t)&&!Object(r.a)(t[0]))return t[0].getAttribute("name")}function p(e){return!Object(r.a)(e)&&e.getElementsByTagName("all-attributes").length>0}function g(e,t){if(Object(r.a)(t)||!t.length||Object(r.a)(e))return;const n=u(e),a=e.getElementsByTagName("entity");if(a&&a[0]){const r=a[0].firstChild;for(let i=0;i<t.length;i++)if(-1===n.indexOf(t[i])){const n=e.createElement("attribute");n.attributes.setNamedItem(s(e,"name",t[i])),a[0].insertBefore(n,r)}}}function h(e,t){let n='<link-entity name="'+e.name+'" from="'+e.from+'" to="'+e.to+'"';if(n+=e.linkType?' link-type="'+e.linkType+'"':"",n+=e.alias?' alias="'+e.alias+'"':"",0===t.length)return n+=" />",n;n+=">";for(let e=0;e<t.length;e++)n+='<attribute name="'+t[e]+'" />';return n+="</link-entity>",n}function f(e,t){if(!Object(r.b)(t)){const n=e.getElementsByTagName("entity")[0];let a=!1;const o=i(t),s=e.getElementsByTagName("link-entity");if(!Object(r.a)(s)){const e=["alias","name","from","to","link-type"];for(let t=0;t<s.length;t++)if(e.every(e=>c(s[t],o.documentElement,e))){for(let e=0;e<o.documentElement.childNodes.length;e++)s[t].appendChild(o.documentElement.childNodes[e].cloneNode());a=!0}}a||Object(r.a)(n)||n.appendChild(o.documentElement)}}function m(e,t){const n=e.createElement("attribute");n.attributes.setNamedItem(s(e,"name",t)),n.attributes.setNamedItem(s(e,"rowaggregate","CountChildren")),n.attributes.setNamedItem(s(e,"alias","HierarchyDataChildCount6dcd9e4c001441b09237d51a34853d55")),e.getElementsByTagName("entity")[0].appendChild(n)}function b(e,t){if(!e)throw new Error("Invalid fetch xml document is passed");const n=Object(a.b)(t);e.getElementsByTagName("entity")[0].appendChild(n.firstChild)}function _(e,t,n){let r;if(-1===t.indexOf("."))r=e.getElementsByTagName("entity")[0];else{const n=t.split(".");if(2===n.length){r=y(e,n[0],t=n[1])}}if(r){const a=r.getElementsByTagName("order"),i=v(e,t,n);let o=!1;for(let e=0;e<a.length;e++)if(c(a[e],i,"attribute")){o=!0,a[e].setAttribute("descending",n?"true":"false");break}o||r.appendChild(i)}}function y(e,t,n){const r=e.getElementsByTagName("link-entity");for(let e=0;e<r.length;e++){const a=r[e];if(a.attributes.getNamedItem("alias")&&a.attributes.getNamedItem("alias").nodeValue===t){const e=a.childNodes;for(let t=0;t<e.length;t++){const r=e[t];if("attribute"===r.nodeName&&r.attributes.getNamedItem("name").nodeValue===n)return a}}}}function v(e,t,n){const r=e.createElement("order");return r.attributes.setNamedItem(s(e,"attribute",t)),r.attributes.setNamedItem(s(e,"descending",n.toString())),r}function S(e){const t=e.getElementsByTagName("order");for(;t.length;){const e=t[0];e.parentNode.removeChild(e)}}function O(e,t,n,r){return`<link-entity name="${e}" from="${t}" to="${n}" alias="bb">\n\t<filter type="and">\n\t\t<condition attribute="${r||t}" operator="eq" uitype="${e}" />\n\t</filter>\n\t</link-entity>`}function C(e,t,n,r,a,i){return`<link-entity name="${e}" intersect="true" visible="false" to="${t}" from="${i}">\n\t${O(r,a,n)}\n</link-entity>`}function E(e,t,n){if(!Object(r.b)(n)&&!Object(r.b)(t)){const a=e.getElementsByTagName("entity")[0],o=i(t),c=o.getElementsByTagName("condition")[0];Object(r.a)(c)||c.attributes.setNamedItem(s(o,"value",n)),Object(r.a)(a)||a.appendChild(o.firstChild)}}function I(e,t,n,a,i,o){Object(r.a)(e)||Object(r.a)(e.firstChild)||"fetch"!==e.firstChild.nodeName||(Object(r.a)(e.firstChild.attributes.getNamedItem("returntotalrecordcount"))&&e.firstChild.attributes.setNamedItem(s(e,"returntotalrecordcount",i.toString())),e.firstChild.attributes.setNamedItem(s(e,"page",n.toString())),e.firstChild.attributes.setNamedItem(s(e,"count",t.toString())),a&&e.firstChild.attributes.setNamedItem(s(e,"paging-cookie",a)),e.firstChild.attributes.setNamedItem(s(e,"no-lock",o.toString())))}},TKDo:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the Inline Dialog page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="InlineDialog"},TQVK:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("WLAV"),a=n("pEXn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i={getName:()=>r.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>Promise.all([n.e(2),n.e(6),n.e(0),n.e(1),n.e(3),n.e(4),n.e(5),n.e(8),n.e(7),n.e(97)]).then(n.bind(null,"L1d8")).then(({PowerBIFullScreen:t})=>new t(e)),getTelemetryAttributes:e=>[{name:a.b.PowerBIComponentTypeCode,value:e&&e.powerBIComponentTypeCode}]};Object.freeze(i);var o=n("9eA9"),s=n("D+Bz"),c=n("xagu");const l={type:s.a.Page,pageType:"powerbifullscreen",factory:i,urlToInput(e){let t,n,r,a,i,o,s;const l=e.searchParams;return l.has(c.K)&&l.get(c.K)&&(t=l.get(c.K)),l.has(c.L)&&l.get(c.L)&&(n=l.get(c.L)),l.has(c.J)&&l.get(c.J)&&(r=l.get(c.J)),l.has(c.O)&&l.get(c.O)&&(a=l.get(c.O)),l.has(c.M)&&l.get(c.M)&&(i=l.get(c.M)),l.has(c.N)&&l.get(c.N)&&(o=l.get(c.N)),l.has(c.I)&&l.get(c.I)&&(s=l.get(c.I)),{powerBIEmbedUrl:t,powerBIGroupId:n,powerBIDashboardId:r,powerBITileId:a,powerBIReportId:i,powerBIReportUrl:o,powerBIComponentTypeCode:s}},inputToUrl(e,t){const n=new o.a(e),r=n.searchParams,a=t.powerBIEmbedUrl,i=t.powerBIGroupId,s=t.powerBIDashboardId,l=t.powerBITileId,u=t.powerBIReportId,d=t.powerBIReportUrl,p=t.powerBIComponentTypeCode;return a&&r.set(c.K,a),i&&r.set(c.L,i),s&&r.set(c.J,s),l&&r.set(c.O,l),u&&r.set(c.M,u),d&&r.set(c.N,d),p&&r.set(c.I,p),n.href}};Object.freeze(l)},TRNQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n("umme"),a=n("504W"),i=n("bRS5"),o=n("l3Ef"),s=n("Nnen"),c=n("Eua/"),l=n("2LZB"),u=n("thzq"),d=n("3ri3"),p=n("5qiD"),g=n("d+dp"),h=n("jZCH"),f=n("EW4s");class m{performOperations(e,t,n){const r=new f.a,a=new c.a,i=new s.a(a),o=this.prepareTransaction(a,i,e,t,n);return i.Commit(o).then(()=>{r.resolve(!0)},e=>{r.reject(e)}),r}prepareOperations(e,t,n){const r=new f.a,a=new c.a,i=new s.a(a),o=this.prepareTransaction(a,i,e,t,n);return h.a.get_DefaultInstance().get_LocalDataSource().get_offlineDataStore().prepareTransactionQueries(o).then(e=>{r.resolve(e)},e=>{r.reject(e)}),r}prepareTransaction(e,t,n,r,i){return t.begin(i),!Object(a.a)(r)&&r.length>0&&m._PerformOperation(r,t),!Object(a.a)(n)&&n.length>0&&m._PerformOperation(n,t),e.get_transaction()}retrieve(e,t){return(new c.a).retrieve(e,t)}generateUID(){return h.a.get_DefaultInstance().get_LocalDataSource().get_offlineDataStore().generateUID()}convertSQLiteResultsToEntityRecord(e,t,n,r){const a=new f.a;return h.a.get_DefaultInstance().retrieveEntityMetadata(n,null).then(i=>{this._GetEntityRecord(n,i,e,t,r).then(e=>{a.resolve(e)},e=>{a.reject(e)})},e=>{a.reject(e)}),a}_GetEntityRecord(e,t,n,s,c){const l=new f.a;if(Object(a.a)(n)||Object(a.b)(n[t.get_primaryIdAttribute()]))l.resolve(null);else{const f=new Array(0);for(const e in n){const t={key:e,value:n[e]},r=t.key.toLowerCase();if(r.indexOf(d.w)<0&&r.toLowerCase()!==d.v.toLowerCase())if(r.indexOf(o.l)<0)f.push(t.key);else{const e=t.key.split(o.l),n=Object(a.b)(e[0])?"":e[0];Object(a.b)(n)||-1!==f.indexOf(n)||f.push(n)}}h.a.get_DefaultInstance().getAttributeTypes(e,f,null).then(e=>{const r=c!==u.a.Update?n:s,a=new g.a(p.a.NotCached,0);Object(i.a)(r,e,t,a).then(t=>{Object(i.e)(t,e,c,n,s).then(e=>{t=e,l.resolve(t)},e=>{l.reject(e)})},e=>{l.reject(e)})},e=>{l.reject(r.a.FromMessage("Offline DB could not retrieve data"))})}return l}static _PerformOperation(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(r.get_operationPerformed()===u.a.Create){if(r.get_entity()instanceof Object){const e=r.get_entity();t.create(r.get_entityType(),e)}}else if(r.get_operationPerformed()===u.a.Delete){const e=r.get_entity();if(e){const n=new l.a(e);t.Delete(r.get_entityType(),n)}}else if(r.get_operationPerformed()===u.a.Update&&r.get_entity()instanceof Object){const e=r.get_entity();t.update(r.get_entityType(),e)}}}}},TYIz:function(e,t,n){"use strict";n.d(t,"a",(function(){return _})),n.d(t,"b",(function(){return y}));var r=n("dHD5"),a=n("i1f0"),i=n("Bo7t"),o=n("pEXn"),s=n("Ii8m"),c=n("jq7Z"),l=n("y60j"),u=n("zmaG"),d=n.n(u),p=n("arV0"),g=n("SAYH"),h=n("zmL5"),f=n("y+Z1"),m=n("+Ajx"),b=n("+zjj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const _="tab.selectformtab";function y(e,t,n){const u=Object(r.v)(n);return{type:"tab.selectformtab.sync",sync:!0,execute({dispatch:r,getState:y},S,O){const C=Object(a.wc)(y(),{id:e},n),E=Object(a.Kc)(y(),t,e,n);if(C===t||!1===E)return;let I,w;const j=Object(c.b)(y(),e,n);if(j){const e=Object(l.x)(y(),j);if(e)for(const n of e)C===n.Id?I=n.Name:t===n.Id&&(w=n.Name)}!function(e,t,n){const r=Object(p.g)(e,t),a=g.a.toString(Object(h.b)(e,t)),i=null==r?void 0:r.entityTypeName;d.a.addKeyPerformanceIndicatorOnIdle(f.a,{[o.b.FormId]:a,[o.b.EntityName]:i,[o.b.FormTabSwitch.TabName]:n})}(y(),e,w),r({type:_,payload:!1,meta:{pageId:e,contextKey:u,tabId:t}}),r({type:_,payload:!0,meta:{pageId:e,contextKey:u,tabId:C}});const P=S.ScriptManager.getContainer(e).getEventManager();v(r,P,n,I,S,O),v(r,P,n,w,S,O),r(Object(s.a)(e,t)),r(Object(i.b)(e,n,t));const T=Object(b.e)(y(),{id:e},n);if(T&&T.isSelected){const t=Object.assign(Object.assign({},T),{isSelected:!1});r(Object(m.b)(e,n,t))}}}}function v(e,t,n,r,a,i){if(r)e(t.runOnTabStateChange(n,r));else{const e=[{name:"CorrelationId",value:i.correlationId},{name:"ContextId",value:i.contextId},{name:"ActionStack",value:i.stack}];a.TraceManager.getTracer(f.a).warn("Null/undefined tabName encountered.",e)}}},Tezb:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"f",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return c}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="chart.retrieve",a="chart.odata.retrieve",i="chartselector.retrieve",o="chartData.retrieve",s="chartData.retrieve.core",c="chartData.retrieve.drillDown"},"Tf+h":function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"f",(function(){return r})),n.d(t,"h",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"j",(function(){return p})),n.d(t,"m",(function(){return g})),n.d(t,"i",(function(){return h})),n.d(t,"k",(function(){return f})),n.d(t,"l",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="set.field.personalization",a="set.grid.personalization",i="set.dashboard.personalization",o="set.generic.personalization",s="set.control.global.personalization",c="dashboard",l="!allpages",u="!newrecordid";function d(e,t){return{type:s,payload:{[e]:t},meta:{lastPropertyKey:e}}}function p(e,t,n){const{entityTypeName:a,recordGuid:i,formGuid:o,controlUniqueId:s,viewId:c="default"}=e;let d=null;n=n||l;let p=i&&i.guid;return n!==l&&(p=p||u),p&&o&&(d={[a]:{[p]:{[o.guid]:{[s]:{[c]:{[n]:t}}}}}}),{type:r,payload:d,meta:{lastPropertyKey:n}}}function g(e,t,n){const{entityTypeName:r,viewId:i="default"}=e;return{type:a,payload:{[r]:{[i]:{[n=n||l]:t}}},meta:{lastPropertyKey:n}}}function h(e,t,n){const{formGuid:r,controlUniqueId:a,viewId:o="default"}=e;return n=n||l,{type:i,payload:{[c]:{[r.guid]:{[a]:{[o]:{[n]:t}}}}},meta:{lastPropertyKey:n}}}function f(e,t,n){return{type:o,payload:n?{[n]:{[e]:t}}:null,meta:n?{lastPropertyKey:e}:null}}},Tz6o:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="page.updateInput";function a(e,t){return{type:r,payload:{input:e},meta:{pageId:t}}}},UDbe:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("NMtn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a{constructor(e){this._path=null,Object(r.c)(e,"path"),this._path=e}get_path(){return this._path}getField(e){const t=this._path.split(".");let n=e;for(let e=0;e<t.length&&n;++e)n=n[t[e]];return n}static get_id(){return a._id}}a._id=new a("id")},UGwp:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n("37s6"),a=n("o1og"),i=n("pEXn"),o=n("iF9X"),s=n("SZCI"),c=n("jZCH"),l=n("yRo8"),u=n("ml6Y"),d=n("eZ32"),p=n("lMS8"),g=n("/BiW"),h=n("DRVD"),f=n.n(h),m=n("Rj8P"),b=n("E5IU"),_=n("JEu3");function y(){return{type:"apply.application.metadata.changes.async",execute({dispatch:e,getState:t},n){const h=t();if(Object(b.o)(h)?Object(r.l)(h)&&Object(r.a)(h):Object(r.a)(h)){e(Object(a.e)(!0));const h=n.TraceManager.getTracer(g.b),b=[];b.push({name:i.b.IsApplicationMetadataDownloadInShimEnabled,value:Object(o.e)(t())}),b.push({name:i.b.OfflineStatus,value:Object(r.q)(t())}),b.push({name:u.a.IsOfflineFirstTimeSyncCompletedKey,value:Object(r.l)(t())}),h.warn(`'${g.a}}' started applying changes`,b);const y=f.a.createEvent(g.a,s.w).startStopwatch();return c.a.get_DefaultInstance().applyApplicationMetadataChanges().nativePromise().then(s=>{if(e(Object(a.d)(false)),Object(l.j)(n,u.a.OfflineApplyApplicationMetadataChangesKey,false),e(Object(a.e)(!1)),b.push({name:u.a.OfflineApplyApplicationMetadataChangesKey,value:Object(o.e)(t())}),Object(r.m)(t())||c.a.get_DefaultInstance().createActivityPointerAndAttachmentView(),y(),h.warn(`'${g.a}' done applying changes`,b),!Object(r.h)(t())){const o=!0;e(Object(a.f)(o)),Object(l.j)(n,u.a.IsFirstApplyApplicationMetadataChangesDoneKey,o),b.length=0,b.push({name:u.a.IsFirstApplyApplicationMetadataChangesDoneKey,value:o}),h.warn(`'${g.a}' first apply application metadata changes done`,b);const s=Object(r.l)(t());if(s){e(Object(m.c)(d.a.Available,0)),b.push({name:i.b.OfflineStatus,value:d.a.Available}),h.warn(`'${g.a}' offline set status to Available`,b);const n=Object(r.f)(t());n&&e(Object(_.b)(!0)),e(Object(p.c)(n)),b.push({name:u.a.IsOfflineFirstTimeSyncCompletedKey,value:s}),h.warn(g.a+" Offline Sync Completed toast notification triggered",b)}}}).catch(t=>(e(Object(a.e)(!1)),y(),h.error(`'${g.a}}' error: ${t.message}`,b),Promise.reject(t)))}return Promise.resolve()}}}},UIlN:function(e,t,n){"use strict";function r(e){return e&&e.commands}function a(e,t){const n=r(e);return n&&t&&n[t]}function i(e){const t=r(e);return!t||!1!==t.perfRenderCmdBar}function o(e,t,n){const a=r(e)[t],i=a&&a.balloonButtonCounts;return i&&i[n]?i[n]:0}n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o}))},UJfx:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n("SAYH"),a=n("LbMF"),i=n("5Oca"),o=n("IqkD"),s=n("qLnS");function c(e,t,n,r){const i=Object(a.a)(e,t,r);if(!i)return null;const c=(i.IsValidForCreate?s.a.CanCreate:s.a.None)|(i.IsValidForRead?s.a.CanRead:s.a.None)|(i.IsValidForUpdate?s.a.CanUpdate:s.a.None);let u=s.a.None;if(i.IsSecured){const a=Object(o.n)(e);if(!a)return null;const d=a[i.Id.guid];if(d&&(u=d.attributeAccessRights),u&s.a.CanRead&&u&s.a.CanUpdate)u=d.attributeAccessRights;else{const a=l(e,t,n.guid,r);a&&(u|=a.accessRightsMask)}u&=c}else u=c;return{attributeId:i.Id,canCreate:!!((d=u)&s.a.CanCreate),canRead:!!(d&s.a.CanRead),canUpdate:!!(d&s.a.CanUpdate),accessRightsMask:d};var d}function l(e,t,n,o){var s;const c=Object(i.i)(e,t),l=null===(s=Object(a.a)(e,t,o))||void 0===s?void 0:s.Id;return c&&n&&o&&c.hasOwnProperty(n)&&c[n].accessRights&&c[n].accessRights.attributePrivileges&&c[n].accessRights.attributePrivileges[r.a.toString(l)]?e.data.entities[t][n].accessRights.attributePrivileges[r.a.toString(l)]:null}function u(e,t,n){const r=Object(i.i)(e,t);return r&&n&&r.hasOwnProperty(n)&&r[n].accessRights&&r[n].accessRights.recordPrivileges?e.data.entities[t][n].accessRights.recordPrivileges:null}},UKgB:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{getMetadata(){return{boundParameter:null,operationName:"GetClientMetadata",operationType:1,parameterTypes:{ClientMetadataQuery:{typeName:"Microsoft.Dynamics.CRM.MetadataQuery",structuralProperty:2}}}}}},"UMB/":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="processid",a="activestageid",i="traversedpath",o="stageid"},UR8A:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n("4Vcb"),a=new(function(){function e(){this._navigationContext={openAlertDialog:r.e,openErrorDialog:r.g,openConfirmDialog:r.f,openFile:null,openUrl:null,openWebResource:null,navigateTo:null,openDialog:null,openForm:null,openTaskFlow:null},this.UserSettings={userId:"{00000000-0000-0000-0000-000000000000}",getTimeZoneOffsetMinutes:r.d,isHighContrastEnabled:null,isRTL:!1,languageId:1033,userName:"",securityRoles:[],pagingLimit:null,formatInfoCultureName:"en-US"},this.OrgSettings={languageId:null,uniqueName:null,isAutoSaveEnabled:null,attributes:null},this.Utils={beginSecureSessionForResource:null,getEntityMetadata:null,getEntitiesMetadata:null,getResourceString:null,isFeatureEnabled:null,isDisruptiveFeatureEnabled:null,lookupObjects:null,getEntityName:null,getFormId:null,canOpenUrl:null},this.Page={getClientUrl:null},this.Reporting={reportSuccess:null,reportFailure:null,reportEvent:null},this.Diagnostics={traceError:null,traceWarning:null,traceInfo:null,traceDebug:null},this.IntelligenceApi={getPredictionSchemaAsync:null,predictAsync:null,getPreTrainedModelIdAsync:null,getLabelsForObjectDetectionModelAsync:null,invokeAiModelActionAsync:null,invokeGlobalOperationAsync:null},this.Client={getClient:r.a,getClientState:r.b,getFormFactor:r.c},this._applicationUI={addGlobalNotification:null,clearGlobalNotification:null,clearGlobalNotifications:null},this._webApiContext={online:{retrieveRecord:null,retrieveMultipleRecords:null,updateRecord:null,createRecord:null,deleteRecord:null,execute:null,executeMultiple:null},offline:{retrieveRecord:null,retrieveMultipleRecords:null,updateRecord:null,createRecord:null,deleteRecord:null,execute:null,executeMultiple:null}},this._unifiedWebApiContext=null,this.Initialized=!1}return e.prototype.setUserSettings=function(e){this.UserSettings=e},e.prototype.setOrgSettings=function(e){this.OrgSettings=e},e.prototype.setOffline=function(e){this.Offline=e},e.prototype.setUtils=function(e){this.Utils=e},e.prototype.setPage=function(e){this.Page=e},e.prototype.setReporting=function(e){this.Reporting=e},e.prototype.setIntelligenceApi=function(e){this.IntelligenceApi=e},e.prototype.setDiagnostics=function(e){this.Diagnostics=e},e.prototype.setClient=function(e){this.Client=e},e.prototype.setNavigationContext=function(e){this._navigationContext=e},e.prototype.setDeviceContext=function(e){this._deviceContext=e},e.prototype.setExternalContext=function(e){this._externalContext=e},e.prototype.setApplicationUI=function(e){this._applicationUI=e},e.prototype.setWebApi=function(e){this._webApiContext=e},e.prototype.setWebApiUnified=function(e){this._unifiedWebApiContext=e},e.prototype.openForm=function(e,t){return this._navigationContext.openForm(e,t)},e.prototype.openUrl=function(e,t){return this._navigationContext.openUrl(e,t)},e.prototype.openFile=function(e,t){return this._navigationContext.openFile(e,t)},e.prototype.openAlertDialog=function(e,t){return this._navigationContext.openAlertDialog(e,t)},e.prototype.openConfirmDialog=function(e,t){return this._navigationContext.openConfirmDialog(e,t)},e.prototype.openDialog=function(e,t,n){return this._navigationContext.openDialog(e,t,n)},e.prototype.openErrorDialog=function(e){return this._navigationContext.openErrorDialog(e)},e.prototype.openTaskFlow=function(e,t,n){return this._navigationContext.openTaskFlow(e,t,n)},e.prototype.openWebResource=function(e,t,n){return this._navigationContext.openWebResource(e,t,n)},e.prototype.navigateTo=function(e,t){return this._navigationContext.navigateTo(e,t)},e.prototype.captureImage=function(e){return this._deviceContext.captureImage(e)},e.prototype.captureAudio=function(e){return this._deviceContext.captureAudio(e)},e.prototype.captureVideo=function(e){return this._deviceContext.captureVideo(e)},e.prototype.pickFile=function(e){return this._deviceContext.pickFile(e)},e.prototype.getBarcodeValue=function(){return this._deviceContext.getBarcodeValue()},e.prototype.getCurrentPosition=function(){return this._deviceContext.getCurrentPosition()},e.prototype.getAvailableExternalContexts=function(){return this._externalContext.getAvailableExternalContexts()},e.prototype.getExternalContextProperty=function(e,t,n){return this._externalContext.getExternalContextProperty(e,t,n)},e.prototype.invokeExternalContextAction=function(e,t,n){return this._externalContext.invokeExternalContextAction(e,t,n)},e.prototype.removeExternalContextPropertyListener=function(e,t,n){return this._externalContext.removeExternalContextPropertyListener(e,t,n)},e.prototype.addGlobalNotification=function(e,t,n,r,a,i){return this._applicationUI.addGlobalNotification(e,t,n,r,a,i)},e.prototype.clearGlobalNotification=function(e){return this._applicationUI.clearGlobalNotification(e)},e.prototype.clearGlobalNotifications=function(){return this._applicationUI.clearGlobalNotifications()},e.prototype._getWebApiContext=function(){return this._unifiedWebApiContext||("Offline"===this.Client.getClientState()?this._webApiContext.offline:this._webApiContext.online)},e.prototype.retrieveRecord=function(e,t,n){return this._getWebApiContext().retrieveRecord(e,t,n)},e.prototype.createRecord=function(e,t){return this._getWebApiContext().createRecord(e,t)},e.prototype.updateRecord=function(e,t,n){return this._getWebApiContext().updateRecord(e,t,n)},e.prototype.deleteRecord=function(e,t){return this._getWebApiContext().deleteRecord(e,t)},e.prototype.retrieveMultipleRecords=function(e,t,n){return this._getWebApiContext().retrieveMultipleRecords(e,t,n)},e.prototype.execute=function(e){return this._getWebApiContext().execute(e)},e.prototype.executeMultiple=function(e){var t=this._getWebApiContext();return t.executeMultiple?t.executeMultiple(e):Promise.resolve(null)},e.prototype.openARViewer=function(e){return this._deviceContext.openARViewer(e)},e}());t.a=a},UZFl:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the Apps page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Apps"},Ua4i:function(e,t,n){"use strict";function r(e){return e.globalNotifications}function a(e,t){return e.globalNotifications[t]}function i(e){const t=r(e);return t?Object.keys(t):[]}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}))},UgqG:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._killedTokenDictionary={}}return e.prototype.setKillSwitchTenants=function(e,t){if(e&&t)try{var n=e.split(",");if("this-request-only"===t)return n;for(var r=1e3*parseInt(t,10),a=0;a<n.length;++a)this._killedTokenDictionary[n[a]]=Date.now()+r}catch(e){return[]}return[]},e.prototype.isTenantKilled=function(e){return void 0!==this._killedTokenDictionary[e]&&this._killedTokenDictionary[e]>Date.now()||(delete this._killedTokenDictionary[e],!1)},e}();t.default=r},UqMU:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return u}));var r=n("txA/"),a=n("2qKp"),i=n("31Vn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t,n){return Object.assign({type:r.a,payload:{browsingContextId:e,state:t,url:n}},Object(a.a)(e,[{name:"browsingContextId",value:e},{name:"state",value:JSON.stringify(t)},{name:"url",value:Object(i.a)(n)}]))}function s(e,t,n){return Object.assign({type:r.Y,payload:{browsingContextId:e,state:t,url:n}},Object(a.a)(e,[{name:"browsingContextId",value:e},{name:"state",value:JSON.stringify(t)},{name:"url",value:Object(i.a)(n)}]))}function c(e){return Object.assign({type:r.b,payload:{browsingContextId:e}},Object(a.a)(e,[{name:"browsingContextId",value:e}]))}function l(e){return Object.assign({type:r.d,payload:{browsingContextId:e}},Object(a.a)(e,[{name:"browsingContextId",value:e}]))}function u(e,t){return Object.assign({type:r.X,payload:{browsingContextId:e,history:t}},Object(a.a)(e,[{name:"browsingContextId",value:e}]))}},UriP:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("4or6"),a=n("2aJl"),i=n("4I9M"),o=n("UgqG"),s=n("LSTU"),c=n("I3lY"),l=n("NCQ1"),u=n("4WQe"),d=n("W8lr"),p=function(){function e(e,t,n,r,a){var i=this;this._requestQueue=e,this._queueManager=n,this._httpInterface=r,this._urlString="?qsp=true&content-type=application%2Fbond-compact-binary&client-id=NO_AUTH&sdk-version="+c.FullVersionString,this._killSwitch=new o.default,this._paused=!1,this._useBeacons=!1,this._activeConnections=0,this._clockSkewManager=new s.default(a),l.isUint8ArrayAvailable()||(this._urlString+="&content-encoding=base64"),this._urlString=t+this._urlString,this._httpInterface||(this._useBeacons=!l.isReactNative(),this._httpInterface={sendPOST:function(e,t,n,r,a,o){try{if(l.useFetchRequest())fetch(e,{body:t,method:"POST"}).then((function(e){var t={};e.headers&&e.headers.forEach((function(e,n){t[n]=e})),a(e.status,t)})).catch((function(e){r(0,{})}));else if(l.useXDomainRequest()){var s=new XDomainRequest;s.open("POST",e),s.onload=function(){a(200,null)},s.onerror=function(){r(400,null)},s.ontimeout=function(){n(500,null)},s.send(t)}else{var c=new XMLHttpRequest;c.open("POST",e,!o),c.onload=function(){a(c.status,i._convertAllHeadersToMap(c.getAllResponseHeaders()))},c.onerror=function(){r(c.status,i._convertAllHeadersToMap(c.getAllResponseHeaders()))},c.ontimeout=function(){n(c.status,i._convertAllHeadersToMap(c.getAllResponseHeaders()))},c.send(t)}}catch(e){r(400,null)}}})}return e.prototype.hasIdleConnection=function(){return this._activeConnections<2},e.prototype.sendQueuedRequests=function(){for(;this.hasIdleConnection()&&!this._paused&&this._requestQueue.length>0&&this._clockSkewManager.allowRequestSending();)this._activeConnections++,this._sendRequest(this._requestQueue.shift(),0,!1);this.hasIdleConnection()&&d.default.scheduleTimer()},e.prototype.isCompletelyIdle=function(){return 0===this._activeConnections},e.prototype.teardown=function(){for(;this._requestQueue.length>0;)this._sendRequest(this._requestQueue.shift(),0,!0)},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1,this.sendQueuedRequests()},e.prototype.removeQueuedRequests=function(){this._requestQueue.length=0},e.prototype.sendSynchronousRequest=function(e,t){this._paused&&(e[t][0].priority=r.AWTEventPriority.High),this._activeConnections++,this._sendRequest(e,0,!1,!0)},e.prototype._sendRequest=function(e,t,n,i){var o=this;void 0===i&&(i=!1);try{if(this._paused)return this._activeConnections--,void this._queueManager.addBackRequest(e);var s=0,c="";for(var d in e)e.hasOwnProperty(d)&&(this._killSwitch.isTenantKilled(d)?(u.default.eventsRejected(e[d],r.AWTEventsRejectedReason.KillSwitch),delete e[d]):(c.length>0&&(c+=","),c+=d,s++));if(s>0){var p=a.default.getPayloadBlob(e,s);p.remainingRequest&&this._requestQueue.push(p.remainingRequest);var g=this._urlString+"&x-apikey="+c+"&client-time-epoch-millis="+Date.now().toString();this._clockSkewManager.shouldAddClockSkewHeaders()&&(g=g+"&time-delta-to-apply-millis="+this._clockSkewManager.getClockSkewHeaderValue());var h=void 0;for(var d in h=l.isUint8ArrayAvailable()?new Uint8Array(p.payloadBlob):a.default.base64Encode(p.payloadBlob),e)if(e.hasOwnProperty(d))for(var f=0;f<e[d].length;++f)e[d][f].sendAttempt>0?e[d][f].sendAttempt++:e[d][f].sendAttempt=1;if(this._useBeacons&&n&&l.isBeaconsSupported()&&navigator.sendBeacon(g,h))return;this._httpInterface.sendPOST(g,h,(function(r,a){o._retryRequestIfNeeded(r,a,e,s,c,t,n,i)}),(function(r,a){o._retryRequestIfNeeded(r,a,e,s,c,t,n,i)}),(function(r,a){o._retryRequestIfNeeded(r,a,e,s,c,t,n,i)}),n||i)}else n||this._handleRequestFinished(!1,{},n,i)}catch(e){this._handleRequestFinished(!1,{},n,i)}},e.prototype._retryRequestIfNeeded=function(e,t,n,a,o,s,c,l){var p=this,g=!0;if(void 0!==e){if(t){var h=this._killSwitch.setKillSwitchTenants(t["kill-tokens"],t["kill-duration-seconds"]);this._clockSkewManager.setClockSkew(t["time-delta-millis"]);for(var f=0;f<h.length;++f)u.default.eventsRejected(n[h[f]],r.AWTEventsRejectedReason.KillSwitch),delete n[h[f]],a--}else this._clockSkewManager.setClockSkew(null);if(200===e)return void this._handleRequestFinished(!0,n,c,l);(!i.default.shouldRetryForStatus(e)||a<=0)&&(g=!1)}if(g)if(l)this._activeConnections--,n[o][0].priority=r.AWTEventPriority.High,this._queueManager.addBackRequest(n);else if(s<1){for(var m in n)n.hasOwnProperty(m)&&u.default.eventsRetrying(n[m]);setTimeout((function(){return p._sendRequest(n,s+1,!1)}),i.default.getMillisToBackoffForRetry(s))}else this._activeConnections--,d.default.backOffTransmission(),this._queueManager.addBackRequest(n);else this._handleRequestFinished(!1,n,c,l)},e.prototype._handleRequestFinished=function(e,t,n,a){for(var i in e&&d.default.clearBackOff(),t)t.hasOwnProperty(i)&&(e?u.default.eventsSent(t[i]):u.default.eventsDropped(t[i],r.AWTEventsDroppedReason.NonRetryableStatus));this._activeConnections--,a||n||this.sendQueuedRequests()},e.prototype._convertAllHeadersToMap=function(e){var t={};if(e)for(var n=e.split("\n"),r=0;r<n.length;++r){var a=n[r].split(": ");t[a[0]]=a[1]}return t},e}();t.default=p},Uv1Y:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"d",(function(){return b})),n.d(t,"f",(function(){return g})),n.d(t,"g",(function(){return _})),n.d(t,"e",(function(){return p}));var r=n("YxC/"),a=n("zsAz"),i=n("umme"),o=n("7Gx7"),s=n("WWXV"),c=n("JdSN"),l=n("504W"),u=n("E8F2");class d{constructor(e,t,n,r,i,o,s,c,l,g,h,f=!1,m=-1,b=null,_,y,v,S,O={}){const C=t||d.DEFAULT_ERROR_CODE,E=(I=e,(-2147220891===p(C)?I:null)||g);var I;const w=Object(a.d)(e,C,c,l,E,h,f,O);return w.message||(w.message=C.toString()),w.errorParameters||(w.errorParameters=[]),s&&w.errorParameters.push({name:"ErrorDetails",value:s}),o&&(Object(u.e)(w)||w.errorParameters.push({name:"ErrorFault",value:o})),i&&w.errorParameters.push({name:"ErrorSource",value:i}),n&&w.errorParameters.push({name:"Exception",value:n.message}),h&&w.errorParameters.push({name:"ErrorStack",value:h}),w._errorSource=i||d.DEFAULT_ERROR_SOURCE,w._exception=n,w._innerError=r,w._errorFault=o,w._details=s,w.blockErrorReporting=f,w.faultedRequestIndex=m,w.faultedSnapshotId=b,w.httpStatusCode=_,w.clientRequestId=y,w.serverResponseId=v,w.retryAfter=S,w._errorAnnotations=O,d._addErrorStatusProps(w),w}static fromErrorCode(e,t,...n){const r=d._getErrorMessage(e,t,n);return new d(r,t)}static fromExistingError(e){const t=e;return t.name||(t.name=a.a),void 0===t.errorCode&&(t.errorCode=d.DEFAULT_ERROR_CODE),void 0===t.blockErrorReporting&&(t.blockErrorReporting=!1),void 0===t.faultedRequestIndex&&(t.faultedRequestIndex=-1),void 0===t._errorSource&&(t._errorSource=d.DEFAULT_ERROR_SOURCE),d._addErrorStatusProps(t),t}static _addErrorStatusProps(e){const t=Object.getOwnPropertyNames(d.prototype);for(const n of t){const t=Object.getOwnPropertyDescriptor(d.prototype,n);Object.defineProperty(e,n,t)}}static createEmpty(){return new d("ErrorStatus created with no information",this.DEFAULT_ERROR_CODE)}static _getErrorMessageResourceId(e){let t=e;t<0&&(t=t+4294967295+1);return"Error_Message_0x"+t.toString(16)}static _getErrorMessage(e,t,...n){let a=Object(r.b)(e,d._getErrorMessageResourceId(t));return a||(a=Object(r.b)(e,d.DEFAULT_ERROR_MESSAGE_ID)),n?String.format(a,n):a}static toLegacyErrorStatus(e){if(!e)return null;const t=i.a.FromMessage(e.message,null);return t.set_ErrorCode(e.errorCode),t.set_ErrorFault(e.errorFault),t.set_Exception(e.exception),t.set_Stack(e.stack),t.set_InnerError(d.toLegacyErrorStatus(e.innerError)),t.set_BlockErrorReporting(e.blockErrorReporting),t}static fromLegacyErrorStatus(e,t){if(!e)return null;let n=e.get_Stack();if(!n){const t=e.get_ErrorFault();t&&t.get_innerFault()&&(n=t.get_innerFault().get_callStack())}const r=e.get_ErrorCode();let a=e.get_Message();Object(l.b)(a)&&null!=t&&(a=d._getErrorMessage(t,r));let i=-1;return void 0!==e.get_FaultedRequestIndex&&(i=e.get_FaultedRequestIndex()),new d(a,r,e.get_Exception(),d.fromLegacyErrorStatus(e.get_InnerError()),e.get_ErrorSource(),e.get_ErrorFault(),n,null,null,null,n,e.get_BlockErrorReporting(),i,null,e.get_HttpStatusCode(),e.get_ClientRequestId(),e.get_ServerResponseId(),e.get_RetryAfter(),e.get_ErrorFault()?e.get_ErrorFault().get_annotations():null)}static fromCrmErrorResponse(e){if(!e)return null;const t=e.get_organizationServiceFault();return new d(t.get_message(),t.get_errorCode(),null,d.fromOrganizationServiceFault(t.get_innerFault()),null,null,null,null,null,null,t.get_callStack(),null,null,null,null,e.get_clientRequestId(),e.get_serverResponseId(),e.get_retryAfter(),t.get_annotations())}static fromOrganizationServiceFault(e){return e?new d(e.get_message(),e.get_errorCode(),null,d.fromOrganizationServiceFault(e.get_innerFault()),null,null,null,null,null,null,e.get_callStack(),null,null,null,null,null,null,null,e.get_annotations()):null}get errorFault(){return this._errorFault}get details(){return this._details}get exception(){return this._exception}get innerError(){return this._innerError}get errorSource(){return this._errorSource}get errorAnnotations(){return this._errorAnnotations}get localizedMessage(){if(this.message){const e=/, Error details: (.*)$/gi.exec(this.message);if(e&&e.length>1){const t=e[1];return"'"===t[0]&&"'"===t[t.length-1]?t.substring(1,t.length-1):t}}return null}containsErrorCode(e){return this.getNegativeErrorCode()===e||!!this._innerError&&this._innerError.containsErrorCode(e)}getNegativeErrorCode(){return p(this.errorCode)}}function p(e){let t=e;return e>0&&(t=~~e),t}function g(e){const t=function(e){e||(e=d.createEmpty());return{errorcode:e.errorCode,message:e.message}}(e);return e.innerError&&(t.innererror=g(e.innerError),t.details=e.innerError.message),new o.a(t)}function h(e){return void 0!==e.get_Message}function f(e){throw m(e)}function m(e){return e?h(e)?d.fromLegacyErrorStatus(e):function(e){return void 0!==e.get_organizationServiceFault}(e)?d.fromCrmErrorResponse(e):e instanceof Error?d.fromExistingError(e):e:d.createEmpty()}function b(e){if(e){if(h(e))return d.fromLegacyErrorStatus(e).message;if(e instanceof c.a)return e.get_error();if(e instanceof Error)return e.message}return"An error occured while processing the request. Please try again later"}function _(e){return e&&e.containsErrorCode&&(e.containsErrorCode(-2147209463)||e.containsErrorCode(-2147209460)||e.containsErrorCode(-2147220692)||e.containsErrorCode(-2147093995)||e.containsErrorCode(-2147220960)||e.containsErrorCode(-2146088112)||e.containsErrorCode(-2147220955)||e.containsErrorCode(-2147167669)||e.containsErrorCode(-2147015328)||e.containsErrorCode(-2147180284)||e.containsErrorCode(-2147094001)||e.containsErrorCode(-2147180269))}d.DEFAULT_ERROR_MESSAGE_ID="Error_Message_Generic_Mobile_Client",d.DEFAULT_ERROR_CODE=0,d.DEFAULT_ERROR_SOURCE=s.a.Unknown},UwOy:function(e,t,n){"use strict";n.d(t,"e",(function(){return g})),n.d(t,"d",(function(){return h})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return l}));var r=n("w1eR"),a=n("OEF1"),i=n("GYEz"),o=n("4leG"),s=n("Lyxw"),c=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l="Embedded";function u(e){switch(e){case r.a.Browser:return"Browser";case r.a.MobileApplication:return"MobileApplication";case r.a.MailApp:return"MailApp"}return""}function d(e){const t=Object(a.e)(e);if(t)return t;const n=Object(i.a)(e);return function(e){return p()&&e===r.a.Browser}(n)?l:u(n)}function p(){try{return window.top!==window.self}catch(e){return!0}}function g(e){return Object(o.c)(e)||p()}function h(e){return Object(o.c)(e)&&Object(s.c)(e,c.Xd)}},UyLX:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Local=0]="Local",e[e.Remote=1]="Remote"}(r||(r={}))},V0Yx:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("odYE");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a{constructor(e,t,n){this.Target=e,this.ProcessId=t,this.ProcessInstanceId=n}getMetadata(){return{boundParameter:null,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},ProcessId:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},ProcessInstanceId:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}},operationName:"RetrieveProcessControlData",operationType:1}}}var i=n("sNgR"),o=n("aRLb");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e){return{type:"SERIALIZE_RETRIEVE_PROCESS_CONTROL_DATA_REQUEST_ASYNC",execute({dispatch:t,getState:n},s){const c=e.get_processId(),l=e.get_processInstanceId(),u=new a(r.a.legacyToExternalEntityReference(e.get_target()),c?r.a.legacyToExternalEntityReference(c):null,l?r.a.legacyToExternalEntityReference(l):null);return t(Object(o.c)(u)).then(()=>Object(i.a)(n(),u))}}}},V482:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e,t,n){this._fault=null,this._requestIndex=0,this._response=null,this._fault=e,this._requestIndex=t,this._response=n}get_fault(){return this._fault}get_requestIndex(){return this._requestIndex}get_response(){return this._response}}},V6aM:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("K7RF"),a=n("Uv1Y"),i=n("/oKV"),o=n("iJGp");function s(e){return{type:"webresource.retrieve.async",execute:({dispatch:t,getState:n},s)=>t(function(e,t=i.a.Local){return{type:"webresource.retrieve.async",execute:({dispatch:n,getState:i},s)=>n(Object(r.b)("webresource",null,null,null,!1,o.a.OnDemandWithoutContext,null,null,[e],null,t)).catch(a.b)}}(e)).then(e=>{if(e.webResourcesContent&&e.webResourcesContent.length)return e.webResourcesContent[0]})}}},"VA/h":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("EW4s");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return(new r.a).allArray(e)}},VCkP:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("IpQH"),a=n("uM6Y"),i=n("VkXQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class o extends r.a{constructor(e,t){super(e,t,a.i)}authenticate(e){return this.execute(i.i.authenticate.name,e)}beginSecureSessionForAuthFlow(e,t,n,r){return this.execute(i.i.beginSecureSessionForAuthFlow.name,e,t,n,r)}beginSecureSessionForResourceSilent(e,t,n){return this.execute(i.i.beginSecureSessionForResource.name,e,t,n)}beginSecureSessionForResource(e,t,n){return this.execute(i.i.beginSecureSessionForResourceWithPrompt.name,e,t,n)}signOut(){return this.execute(i.i.signOut.name)}reconfigure(){return this.execute(i.i.reconfigure.name)}handleAuthError(){return this.execute(i.i.handleAuthError.name)}}},VDDv:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("IpQH"),a=n("NjDY"),i=n("uM6Y"),o=n("VkXQ"),s=n("d5d1"),c=n("CEpr"),l=n("H4dV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class u extends r.a{constructor(e,t){super(e,t,i.f)}takePicture(e={}){const t=this._checkArgs(e);if(t)return t;const n=this._getTransformedImageOptions(e);return this.execute(o.f.takePicture.name,"TakePicture",n)}captureVideo(e={}){const t=this._getTransformedVideoOptions(e);return this.execute(o.f.captureVideo.name,"CaptureVideo",t)}captureAudio(e={}){const t=this._getTransformedAudioOptions(e);return this.execute(o.f.captureAudio.name,"CaptureAudio",t)}_checkArgs(e){const t=[];return function(){const t=r(e.width),n=r(e.height);return t!==n;function r(e){return null!=e&&e>=0}}()&&t.push("Both width and height should be defined or undefined"),void 0!==e.quality&&(e.quality<=0||e.quality>100)&&t.push("Quality should be in (0, 100]"),t.length>0?Promise.reject(t.join("\n")):null}_getOrgMaxUploadFileSize(){const e=this.applicationStore.getState();return Object(a.x)(e).maxUploadFileSize}_getTransformedVideoOptions(e){return{useBinaryReader:!!(null==e?void 0:e.useBinaryReader),maxUploadFileSize:this._getOrgMaxUploadFileSize()}}_getTransformedAudioOptions(e){return{useBinaryReader:!!(null==e?void 0:e.useBinaryReader),maxUploadFileSize:this._getOrgMaxUploadFileSize()}}_getTransformedImageOptions(e){const t=this.applicationStore.getState(),n=l.a.getInstance(),r=this._getImageResolutionValue(Object(s.b)(t)),a=this.applicationContext.TraceManager.getTracer();let i=e.width,o=e.height,c=e.allowEdit;return void 0===i&&void 0===o&&(i=r.width,o=r.height),void 0===i&&void 0===o||(n.get_IsAndroid()?(c=!0,!1===e.allowEdit&&a.warn("allowEdit overwritten, allowEdit has to be true for android devices to apply given height and width to Cordova Plugin.")):n.get_IsIOS()&&(c=!1,e.allowEdit&&a.warn("allowEdit overwritten, allowEdit has to be false for IOS devices to apply given height and width to Cordova Plugin."))),{targetHeight:o,targetWidth:i,allowEdit:c,quality:e.quality,cameraDirection:e.preferFrontCamera?1:0,saveToPhotoAlbum:Object(s.f)(t),useBinaryReader:!!e.useBinaryReader}}_getImageResolutionValue(e){switch(e){case c.a.Res1024x768:return{height:768,width:1024};case c.a.Res1600x1200:return{height:1200,width:1600};case c.a.Res2048x1536:return{height:1536,width:2048};case c.a.Res2592x1936:return{height:1936,width:2592};case c.a.Res640x480:return{height:480,width:640};case c.a.DeviceDefault:default:return{height:void 0,width:void 0}}}}},VFxh:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={compositionstart:"Composition",compositionupdate:"Composition",compositionend:"Composition",resize:"Resize",scroll:"Scroll",wheel:"Scroll",keydown:"Key",keypress:"Key",mousedown:"Click",auxclick:"Click",click:"Click",dblclick:"Click",contextmenu:"Click",touchstart:"Click",pointerdown:"Click"},a=function(){function e(){var e=this;this._userInteractions={},Object.keys(r).forEach((function(t){return document.addEventListener(t,(function(){var n=r[t];n in e._userInteractions?e._userInteractions[n].push(performance.now()):e._userInteractions[n]=[performance.now()]}))}),!0)}return e.prototype.resetTracking=function(){this._userInteractions={}},e.prototype.userInteractions=function(){return this._userInteractions},e}();t.default=a},VIXY:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t,n,r,a,i){return String.format(e,t,n,r,a,i)}n.d(t,"a",(function(){return r}))},VJBm:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("M1jQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a extends r.a{constructor(e){super(),this._dataAccessLayer=null,this.set_dataAccessLayer(e)}get_dataAccessLayer(){return this._dataAccessLayer}set_dataAccessLayer(e){return this._dataAccessLayer=e,e}}},VJwX:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n("g73c"),a=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e){return Object(a.b)(e)?"":e.indexOf(":")<0?e:e.substr(e.indexOf(":")+1)}function o(e,t){const n=Object(r.c)(e,t);return n.charAt(0).toString().toUpperCase()+n.substr(1)}},VL4U:function(e,t,n){"use strict";n.d(t,"a",(function(){return K})),n.d(t,"b",(function(){return G}));var r=n("nuS9"),a=n("3/02"),i=n("u+q+"),o=n("evW+"),s=n("H/hG"),c=n("YWpA"),l=n("EY5k"),u=n("YxC/"),d=n("m4EA"),p=n("q43A"),g=n("RiEM"),h=n("fWyz"),f=n("unFF"),m=n("RiHV"),b=n("nJrx"),_=n("znb3"),y=n("XIN1"),v=n("IqkD"),S=n("Lyxw"),O=n("eD3A"),C=n("wRZP"),E=n("SocB"),I=n("LOik"),w=n("uTTW"),j=n("NjDY"),P=n("QbIY"),T=n("zzhk"),N=n.p+"scripts/d365shell.js?v=1.4.9962-v91onpremise",A=n("CXmn"),D=n("hAdb"),R=n("BM7Q"),x=n("GWSs"),M=n("QBtP"),F=n("Knfm"),k=n("GEbX"),L=n("SV62"),B=n("tJ+6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const U=Object(b.a)();function V(e,t){const n=e.borders.Border04.replace(E.d.Grey.Grey5,Object(E.k)(e.colors.NavBar.NavBar1.Text,.5).rgb);return{borderTopWidth:0,borderBottomWidth:0,borderRight:t?"none":n,borderLeft:t?n:"none",justifyContent:"center",alignItems:"center",flexShrink:0}}function z(e,t,n,r,a){const i="CALC((3.43 * 14px - 16px)/2)",o=r?0:n?"0.43em":i,s=r?0:n?"1.43em":i;return{display:"flex",alignItems:"center",color:t?t.Components.AppHeader.TextColor:e.colors.NavBar.NavBar1.Text,fontSize:a?"1.143em":"1.43em",whiteSpace:"nowrap",marginRight:a?"0.5em":o,marginLeft:a?"0.5em":s,fontFamily:a?e.fontFamilies.Semibold:e.fontFamilies.Semilight,textOverflow:"ellipsis",overflowX:"hidden",lineHeight:a?"24px":null}}function W(e,t,n){return{color:t?t.Components.AppHeader.TextColor:e.colors.NavBar.NavBar1.Text,fontSize:"12px",marginRight:n?"0.667em":"1.43em",marginLeft:n?"0.333em":"0.43em",marginTop:n?"0.43em":"0.71em",fontFamily:e.fontFamilies.Semilight,textOverflow:"ellipsis",overflowX:"hidden",lineHeight:n?"16px":"32px"}}const q={display:"flex",alignItems:"center"};class H extends r.Component{constructor(e,t){super(e),this._isAppSwitcherSupported=!0,this._initShellAfterDivRenders=this._initShellAfterDivRenders.bind(this),this._onVisibilityToggle=this._onVisibilityToggle.bind(this),this.onClickHandler=this.onClickHandler.bind(this),this.onAppSwitcherClickHandler=this.onAppSwitcherClickHandler.bind(this),this._context=t,this.state={isTaskPanelVisibility:!1},d.f.some(t=>!Object(u.c)(e.resourceStrings,t))&&e.retrieveResourceStrings(d.f),this._isAppSwitcherSupported=this.props.renderAppSwitcher,this._isAppSwitcherSupported&&(this._loadScriptPromise=t.AssetLoader.loadScript(N))}_initShellAfterDivRenders(){this._isAppSwitcherSupported&&this._loadScriptPromise&&this._loadScriptPromise.then(()=>{this._shell=function(e){const t={};t.taskpane={containerId:U,topOffsetInPixel:48},t.locale=e.userCultureName?e.userCultureName.toLowerCase():null,t.rtlMode=e.isRTL,t.highContrastMode=e.isHighContrastEnabled,t.inFocusMode=e.inFocusMode;const n=D365.init(t);n&&e.appModulesList&&e.appModulesList.length&&(n.taskpane.addTransientApps(e.appModulesList),n.taskpane.identifyActiveApps(e.appIds));return n}(this.props),this._shell.taskpane&&this._shell.taskpane.on("visibilityToggle",this._onVisibilityToggle)}).catch(e=>{this.context.EventManager.ReportComponentFailure("D365Launcher",e)})}onClickHandler(){this.props.isRedesignedSitemap?this.props.navigateToHome():this.props.defaultSubArea&&this.props.navigateToSubArea(this.props.defaultSubArea),this._context.EventManager.ReportComponentSuccess("DynamicsBrand.Click")}onAppSwitcherClickHandler(){this._shell&&this._isAppSwitcherSupported?(this._shell.taskpane.toggle(),this._context.EventManager.ReportComponentSuccess("D365Launcher.Toggle")):this._isAppSwitcherSupported||(this.props.openAppLandingPage(),this._context.EventManager.ReportComponentSuccess("D365Launcher.NavigateAppsPage"))}_onVisibilityToggle(e){this.setState({isTaskPanelVisibility:e.newVisibility})}componentDidUpdate(e){this._shell&&this._shell.taskpane&&this.props.appModulesList&&this.props.appModulesList.length&&(this._shell.taskpane.addTransientApps(this.props.appModulesList),this._shell.taskpane.identifyActiveApps(this.props.appIds))}_renderAppSwitcherButton(){const e=Object(u.c)(this.props.resourceStrings,d.a),t=this.props.designLanguage,n=t?t.Components.AppHeader.Hover.BackgroundColor:this.props.theme.colors.NavBar.NavBar2.Fill;return r.createElement(o.a,{style:Object(p.e)(Object.assign(Object.assign({},{cursor:"pointer",backgroundColor:"transparent",padding:0,justifyContent:"center",alignItems:"center",width:"initial",height:"100%",border:"none",overflow:"hidden"}),{":focus":Object(p.d)(this.props.theme,this.props.designLanguage),":active":Object(p.a)()}),n),onClick:this.onAppSwitcherClickHandler,title:e,accessibilityLabel:e,testhooks:{id:"navbar-switch-app"},accessibilityExpanded:this.state.isTaskPanelVisibility},r.createElement(s.a,{key:"down-chevron",style:W(this.props.theme,this.props.designLanguage,this.props.isPowerappsThemeEnabled)},r.createElement(y.b,{type:_.a.DropdownArrow})))}_renderLogo(){const e={verticalAlign:"middle",height:this.props.theme.sizes.NavbarHeight,width:"auto"};return r.createElement(w.a,{source:this.props.logoImagePath,style:e})}_renderAdditionalBrandInfo(){if(!this.props.logoImagePath&&this.props.useMooncakeSvg){const e={verticalAlign:"middle",width:"175px",height:"30px",marginLeft:"8px"};return r.createElement(w.a,{source:"/_imgs/Navbar/Vianet.svg",style:e})}}render(){const e=this.props.brandName,t=Object(u.c)(this.props.resourceStrings,d.c);if(!this.props.logoImagePath&&!e)return null;const n=this.props.designLanguage,a=n?n.Components.AppHeader.Hover.BackgroundColor:this.props.theme.colors.NavBar.NavBar2.Fill,i=this.props.logoImagePath&&this.props.logoTooltip?this.props.logoTooltip:Object(O.d)(this.props.brandTooltip,t,null);return r.createElement(c.a,{style:V(this.props.theme,this.props.isRTL)},r.createElement(o.a,{style:Object(p.e)(Object.assign(Object.assign({},{cursor:"pointer",backgroundColor:"transparent",padding:0,justifyContent:"center",alignItems:"center",width:"initial",height:"100%",border:"none",overflow:"hidden"}),{":focus":Object(p.d)(this.props.theme,this.props.designLanguage),":active":Object(p.a)()}),a),onClick:this.onClickHandler,accessibilityLabel:e,testhooks:{id:"dynamics-button",[m.a.LearningPathDOMAttributeSuffix]:"dynamics365-home-button"},title:i},r.createElement(c.a,{style:q},r.createElement(s.a,{style:z(this.props.theme,this.props.designLanguage,this.props.renderAppSwitcher,!!this.props.logoImagePath,this.props.isPowerappsThemeEnabled)},this.props.logoImagePath?this._renderLogo():e,this._renderAdditionalBrandInfo()))),this.props.renderAppSwitcher&&this._renderAppSwitcherButton(),this.props.renderAppSwitcher&&r.createElement(c.a,{id:U,ref:this._initShellAfterDivRenders}))}}function G(e,t,n=!1){if(!function(e,t){return Object(A.k)(e)&&!(t&&Object(A.m)(e))}(e,n))return t;const r=Object(u.b)(e,R.d);let a="{0}{2}{1}";Object(v.g)(e)&&n&&(a="{1}{2}{0}");const i=n?" ":"\n";return String.format(a,t,r,i)}H.displayName="_DynamicsButton",H.contextType=M.a;const K=Object(i.a)((function(){const e=Object(u.h)(),t=function(){let e=null,t=null;return n=>{let r;if(n!==e){e=n,r=[];for(let e=0;n&&e<n.length;e++)r.push(n[e].id);t=r}else r=t;return r}}(),n=function(){let e=null,t=null;return(n,r)=>{let a;return n!==e?(e=n,a=n,r&&r.forEach(e=>{a=a.filter(e)}),t=a):a=t,a}}();return r=>{const i=e(r,d.f),o=Object(g.b)(r),s=Object(f.a)(r),c=Object(B.b)(r)?Object(B.a)(r):null,l=Object(v.w)(r),p=Object(v.o)(r),h=Object(S.b)(r,"AppSwitcherInFocusMode"),m=[];m.push(e=>!e.uniqueName||e.uniqueName.toUpperCase()!=="AppforOutlookModule".toUpperCase()),Object(F.b)(r)||m.push(e=>e.navigationType!==k.a.MultiSession);const b=n(Object(I.c)(r),m),_=t(b),y=Object(j.x)(r),O=(null==y?void 0:y.logoImagePath)?Object(j.t)(r)+y.logoImagePath:null,C=null==y?void 0:y.logoTooltip,E=Object(u.c)(i,(null==y?void 0:y.isCrmOrg)?d.d:d.e),w=Object(T.b)(r),P=Object(A.k)(r)&&Object(A.m)(r),N=Object(D.d)(r,"appswitcher"),R=Object(j.q)(r),M=Object(S.c)(r,a.g),U=void 0!==N?N:l.isLive&&!R&&M,V=Object(L.a)(r)?d.b:d.e,z=G(r,Object(u.b)(r,V),!0),W=Object(x.h)(r);return{theme:s,designLanguage:c,resourceStrings:i,defaultSubArea:o,isRTL:l.isRTL,isHighContrastEnabled:l.isHighContrastEnabled,userCultureName:p,renderAppSwitcher:U,inFocusMode:h,appModulesList:b,appIds:_,logoImagePath:O,logoTooltip:C,isRedesignedSitemap:w,useMooncakeSvg:P,brandName:z,brandTooltip:E,isPowerappsThemeEnabled:W}}}),(function(e){return{retrieveResourceStrings:t=>e(Object(l.e)(t)),navigateToSubArea:t=>{e(Object(h.c)(t,!1,null))},openAppLandingPage:()=>{e(Object(C.a)())},navigateToHome:()=>{e(Object(P.b)())}}}))(H)},VWP5:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("0nOn"),a=n("ZIjf"),i=n("E7fB");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let o;class s{constructor(e,t,n,a,i,s,c){this._sharedVariables={},o=e,this._clientApiExecutor=new r.a(o,"ClientApi.ExecutionContext.",t),this._eventSource=n,this._depth=a,this._eventArgs=i,this._pageId=t,this._formContext=s,c&&(this._sharedVariables=c._sharedVariables)}getContext(){return this._clientApiExecutor.execute("getContext",()=>(this._context||(this._context=new i.a(o,this._pageId)),this._context))}getDepth(){return a.a.instance.reportUsage("ClientApi.ExecutionContext.getDepth"),this._depth}getEventArgs(){return a.a.instance.reportUsage("ClientApi.ExecutionContext.getEventArgs"),this._eventArgs}getEventSource(){return a.a.instance.reportUsage("ClientApi.ExecutionContext.getEventSource"),this._eventSource}getFormContext(){return a.a.instance.reportUsage("ClientApi.ExecutionContext.getFormContext"),this._formContext}getSharedVariable(e){return a.a.instance.reportUsage("ClientApi.ExecutionContext.getSharedVariable"),this._sharedVariables[e]}setSharedVariable(e,t){a.a.instance.reportUsage("ClientApi.ExecutionContext.setSharedVariable"),this._sharedVariables[e]=t}}},"VX+W":function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return m}));var r=n("g0tL"),a=n("Uv1Y"),i=n("eXjw"),o=n("hIjC"),s=n("K7RF"),c=n("ueZM"),l=n("TBkx"),u=n("y60j"),d=n("/oKV"),p=n("iJGp"),g=n("sYIp"),h=n("4leG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const f="dialog.retrieve";function m(e){return{type:"dialog.retrieve.async",execute({dispatch:t,getState:n},m){let b=d.a.LocalAndRemote;const _=m.TraceManager.getTracer(Object(o.d)()),y=Object(o.c)()+".RetrieveDialog";if(!e){const e="Retrieve Dialog Failed: uniqueName is not provided";return _.error(e),m.EventManager.ReportComponentFailure(y,Error(e)),Promise.reject(new a.a(e))}const v=n(),S=[{name:"UniqueName",value:e}],O=Object(o.b)(v,e);if(O===i.a.Initialized&&Object(s.e)(v,Object(o.a)(v,e).overallVersionNumber)&&(b=d.a.Remote),O===i.a.Uninitialized||O===i.a.Initializing||b!==d.a.LocalAndRemote){_.info(`Dialog ${e} is not in the state, will be fetched from the server.`),t(function(e){const t=e?{[e]:{initialized:i.a.Initializing}}:null;return{type:f,payload:{dialogs:t}}}(e.toLowerCase()));return t(function(e){return{type:"dialog.retrieve.async",execute:({dispatch:t,getState:n},i)=>Object(h.d)(n())?Object(g.a)().then(({retrievePreviewDialogDescriptor:n})=>t(n(e))):t(Object(s.b)("dialog",null,null,null,!1,p.a.OnDemandWithoutContext,null,null,[e],r.b.Dialog,d.a.LocalAndRemote)).catch(a.b)}}(e)).then(n=>{const r=n&&n.dialogs?n.dialogs[e.toLowerCase()]:null;r?(_.info(`Received metadata response for dialog ${e} from server.`),m.EventManager.ReportComponentSuccess(y,S)):_.warn(`Dialog ${e} not found in metadata response.`);const i=r&&r.formId?r.formId:null;return i?t(Object(c.a)(i)).then(()=>i,a.b):i}).catch(t=>{const n=Object(l.d)(t,_);!n.stack&&(n.stack="No stack available.");const r=`Error retrieving dialog ${e}: Name: ${n.name}, Message: ${n.message}, Stack: ${n.stack} `;_.error(r);const a=[];return a.push({name:"DialogName",value:e}),m.EventManager.ReportComponentFailure(y,n,null,a),Promise.reject(t)})}_.info(`Dialog ${e} found in the state.`),m.EventManager.ReportComponentSuccess(y,S);const C=Object(o.a)(v,e).formId,E=Object(u.j)(v,C);if(E&&!E.AreLabelsSubstituted)return t(Object(c.a)(C)).then(()=>C,a.b);if(!E){const e="FormId not found in the state : "+(C?C.guid:null),t=new Error(e);return Promise.reject(t)}return Promise.resolve(C)}}}},VcAV:function(e,t,n){"use strict";function r(e){return null==e}function a(e){return r(e)||!e.length}function i(e){return!r(e)&&e.constructor===Array}n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}))},VgPQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="page.unmounted";function a(e,t){return{type:r,payload:{isPageUnmounted:t},meta:{pageId:e}}}},VkXQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"i",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"h",(function(){return u}));const r={ready:{name:"ready"},initialized:{name:"initialized"},bootError:{name:"bootError"}},a={getBarcodeValue:{name:"getBarcodeValue",platformFeatureDependencies:["camera"]}},i={openFile:{name:"openFile"},pickFile:{name:"pickFile"}},o={getCurrentPosition:{name:"getCurrentPosition",platformFeatureDependencies:["geolocation"]}},s={takePicture:{name:"takePicture",platformFeatureDependencies:["camera"]},captureVideo:{name:"captureVideo",platformFeatureDependencies:["video"]},captureAudio:{name:"captureAudio",platformFeatureDependencies:["microphone"]}},c={openUri:{name:"openUri"},updateBackBehavior:{name:"updateBackBehavior"},canOpenUri:{name:"canOpenUri"},openAuthPopup:{name:"openAuthPopup"},switchApp:{name:"switchApp"},navigateBackOutOfApp:{name:"navigateBackOutOfApp"}},l={authenticate:{name:"authenticate"},beginSecureSessionForAuthFlow:{name:"beginSecureSessionForAuthFlow"},beginSecureSessionForResource:{name:"beginSecureSessionForResource"},beginSecureSessionForResourceWithPrompt:{name:"beginSecureSessionForResourceWithPrompt"},signOut:{name:"signOut"},reconfigure:{name:"reconfigure"},authenticationValidationError:{name:"authenticationValidationError"},handleAuthError:{name:"handleAuthError"}},u={exec:{name:"exec"},onSyncStart:{name:"onSyncStart"},onSyncComplete:{name:"onSyncComplete"},onSyncError:{name:"onSyncError"}},d={getExternalContextProperty:{name:"getExternalContextProperty"},invokeExternalContextAction:{name:"invokeExternalContextAction"}}},VnTQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return u}));var r=n("GP49"),a=n("RymD");const i="Back.Nav.Tooltip.Hide",o="Back.Nav.Tooltip.Init";function s(e,t,n){const r={[a.c]:t};return n&&(r[a.b]=n),Promise.resolve(e.DataSource.saveSessionState(a.a,r,!0))}function c(){return{type:"back.button.init",execute:({dispatch:e},t)=>function(e){return Promise.resolve(e.DataSource.retrieveSessionState(a.a)).then(e=>e&&{hideLongPressTooltip:e[a.c],tooltipDismissCount:e[a.b]})}(t).then(t=>{return t&&e((n=t.hideLongPressTooltip,r=t.tooltipDismissCount,{type:o,payload:{hideLongPressTooltip:n,tooltipDismissCount:r}}));var n,r})}}function l(){return{type:"back.button.tooltip.multiple",execute({dispatch:e,getState:t},n){if(!Object(r.c)(t())&&!Object(r.b)(t()))return e(d(!1)),s(n,!1)}}}function u(){return{type:"disable.back.button.tooltip",execute({dispatch:e,getState:t},n){e(d(!0));return s(n,!0,Object(r.a)(t()))}}}function d(e){return{type:i,payload:e}}},VnpK:function(e,t,n){"use strict";n.d(t,"h",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"l",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"k",(function(){return _})),n.d(t,"u",(function(){return y})),n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return I})),n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"g",(function(){return g})),n.d(t,"p",(function(){return w})),n.d(t,"i",(function(){return j})),n.d(t,"n",(function(){return h})),n.d(t,"j",(function(){return P})),n.d(t,"o",(function(){return R})),n.d(t,"y",(function(){return x})),n.d(t,"x",(function(){return k})),n.d(t,"w",(function(){return M})),n.d(t,"v",(function(){return F})),n.d(t,"s",(function(){return B})),n.d(t,"t",(function(){return V})),n.d(t,"r",(function(){return U})),n.d(t,"m",(function(){return z})),n.d(t,"q",(function(){return W}));var r,a=n("UR8A"),i=n("VcAV"),o=n("455M"),s=n("j6Db"),c=n("S2mk");function l(e,t,n){if(n)return n;if(!t)return t;var r=u(e);return(r?r+"-":"")+t}function u(e){if(e.configuration&&e.configuration.CustomControlId===c.b)return function(e){return e.descriptor.DomId+"-"+e.descriptor.Id}(e);var t="";return e.descriptor&&(t=e.descriptor.DomId?e.descriptor.DomId:""),(t?t+"-":"")+((e.controlId?e.controlId:"")||"")}function d(e,t){var n=e&&e.controlId?e.controlId:"";return t?(n?n+"-":"")+t:n||""}function p(e){return Object(i.c)(e)||Object(i.c)(e.propBagData)||Object(i.c)(e.propBagData.accessibilityData)||Object(i.c)(e.propBagData.accessibilityData.assignedTabIndex)?0:e.propBagData.accessibilityData.assignedTabIndex}function g(e){var t,n,r;return null!==(r=null===(n=null===(t=null==e?void 0:e.propBagData)||void 0===t?void 0:t.accessibilityData)||void 0===n?void 0:n.assignedTooltip)&&void 0!==r?r:null}function h(){if(void 0===r){if(window.matchMedia("(-ms-high-contrast: active)").matches)r=!0;else{var e=document.getElementsByTagName("html");r=null!=e[0].getAttribute("hc")}}return r}function f(e,t,n){var r=b(e,t,n);if(r&&null!==r){var a=document.getElementById(r);a&&null!==a&&a.focus()}}function m(e,t,n){var r=b(e,t,n);if(r&&null!==r){var a=document.getElementById(r);a&&null!==a&&a.blur()}}function b(e,t,n){if(t)return!0===n?t:l(e,t)}function _(e,t){var n=t.organizationUniqueName?t.organizationUniqueName:"";return!!t.usePathBasedUrls&&t.usePathBasedUrls&&n?"/"+n+e:e}function y(e,t,n,r,i,o){if(i){var c=i.entityType||i.entityName||i.LogicalName,l=i.id||i.Id&&i.Id.toString(),u=function(e,t){var n=t&&e.dynamicData?e.dynamicData.parameters[t]:null;return e.actions&&e.actions.getRecordSetQueryKey&&null!==n?e.actions.getRecordSetQueryKey(n):null}(e,n),d=function(){try{var t={entityName:c,entityId:l,recordSetQueryKey:u};if(e.parentDefinedControlProps&&e.parentDefinedControlProps.propertyBagOverrides&&e.parentDefinedControlProps.propertyBagOverrides.openForm)e.parentDefinedControlProps.propertyBagOverrides.openForm(t);else{if(!t.entityName)throw new Error("EntityName was not passed in to method, cannot call openForm");a.b.openForm(t)}}catch(t){var n="";try{n=JSON.stringify(e)}catch(e){n="Unable to parse ownProps"}try{e.propBagMethods.navigation&&e.propBagMethods.navigation.openEditForm&&e.propBagMethods.navigation.openEditForm(i)}catch(e){a.b.Reporting.reportFailure(s.a+".Utilities",t,"propBagMethods.navigation.openEditForm failed",[{name:"ownProps",value:n},{name:"APIName",value:s.a+".Utilities.CustomControlHelper.openDatasetItemAction"}])}a.b.Reporting.reportFailure(s.a+".Utilities",t,"XrmProxyInstance.openForm failed",[{name:"ownProps",value:n},{name:"APIName",value:s.a+"Utilities.CustomControlHelper.openFormAction"}])}};c===t.getTargetEntityType()||"activitypointer"===t.getTargetEntityType()?a.b.Utils.isFeatureEnabled("GridOverrideOpenRecord")&&r?r(e.id,c,l,e.contextToken).then((function(e){e?a.b.Reporting.reportSuccess(s.a+".Utilities",[{name:"hasCustomOpenAction",value:e},{name:"entityName",value:c},{name:"APIName",value:s.a+".Utilities.CustomControlHelper.runCustomOpenRecord"}]):p()}),(function(e){a.b.Reporting.reportFailure(s.a+".Utilities",e,"runCustomOpenRecord failed",[{name:"APIName",value:s.a+".Utilities.CustomControlHelper.runCustomOpenRecord"},{name:"entityName",value:c}])})):p():d()}function p(){if(t.retrieveRecordCommand){var e=o&&o.CommandButtonId?o.CommandButtonId:"Mscrm.OpenRecordItem";t.retrieveRecordCommand([l],[e],!1,!1,!1).then((function(e){e&&e.length>0?e[0].execute():d()}),(function(){d()}))}else d()}}function v(e){return Object(i.c)(e)||0===e.length}function S(e){return Object(i.c)(e)||0===e.length}function O(e){return Object(i.c)(e)||Object(i.c)(e.filterOperator)||S(e.conditions)&&v(e.filters)}function C(e,t){if(Object(i.c)(e)&&Object(i.c)(t))return!0;if(Object(i.c)(e)||Object(i.c)(t))return!1;var n="number"==typeof e?e.toString(10):e,r="number"==typeof t?t.toString(10):t;if(typeof n!=typeof r)return!1;if("string"==typeof n)return e===t;if(!Object(i.a)(n)||!Object(i.a)(r))return!1;if(n.length!==r.length)return!1;for(var a=0;a<n.length;a++){if(!C(n[a],r[a]))return!1}}function E(e,t){if(O(e)&&O(t))return!0;if(O(e)||O(t))return!1;if(e.filterOperator!==t.filterOperator)return!1;var n,r,a=e.conditions,o=t.conditions;if(S(a)&&S(o)){var s=e.filters,c=t.filters;if(v(s)&&v(c))return!0;if(v(s)||v(c))return!1;if(s.length!==c.length)return!1;for(var l=0;l<s.length;l++){if(!E(s[l],c[l]))return!1}}else{if(S(a)||S(o))return!1;if(a.length!==o.length)return!1;for(l=0;l<a.length;l++){var u=a[l],d=o[l];if(!(u.attributeName===d.attributeName&&u.conditionOperator===d.conditionOperator&&(n=u.entityAliasName,r=d.entityAliasName,Object(i.b)(n)&&Object(i.b)(r)||!Object(i.b)(n)&&!Object(i.b)(r)&&n===r)&&C(u.value,d.value)))return!1}}return!0}function I(e,t){if(Object(i.c)(e)&&Object(i.c)(t))return!0;if(Object(i.c)(e)||Object(i.c)(t))return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++){var r=e[n],a=t[n];if(r.name!==a.name||r.sortDirection!==a.sortDirection)return!1}return!0}function w(e){var t,n=u(e).split("-");for(t=0;t<n.length-1;t++)if("id"!==n[t]&&isNaN(Number(n[t])))return n[t];return""}function j(e){try{if(!e)return null;var t=(new DOMParser).parseFromString(e,"text/xml");if(t){var n=t.getElementsByTagName("filter");return n&&0!==n.length?function e(t){if(!t||"string"==typeof t)return null;var n=t,r=function(e){if(!e)return 0;switch(e){case"and":return 0;case"or":return 1}return null}(R(n,"type"));if(null===r||!n.childNodes||0===n.childNodes.length)return null;for(var a=[],i=[],o=0;o<n.childNodes.length;o++){var s=n.childNodes.item(o);if("string"!=typeof s&&("filter"===s.nodeName||"condition"===s.nodeName))if("filter"===s.nodeName){var c=e(s);c&&a.push(c)}else if("condition"===s.nodeName){var l=R(s,"attribute"),u=R(s,"operator"),d=R(s.parentElement&&s.parentElement.parentElement,"name"),p=R(s,"entityname"),g=D(u);if(null!==g&&l){var h=void 0;if(A(u)){if(h=[],s.childNodes)for(var f=0;f<s.childNodes.length;f++){var m=s.childNodes.item(f);if("string"!=typeof m&&"value"===m.nodeName){var b=m.firstChild?m.firstChild.nodeValue:null;if("string"==typeof b){var _=b.toString();h.push(_)}}}}else h=R(s,"value");var y={attributeName:l,conditionOperator:g,entityName:d,entityAliasName:p,value:h};i.push(y)}}}return{filters:a,filterOperator:r,conditions:i}}(n[0]):null}return a.b.Diagnostics.traceInfo(s.a+".convertFetchXmlToFilterExpression","return null"),null}catch(t){a.b.Reporting.reportFailure(s.a+".Utilities",t,"convert xml failed",[{name:"inputFetchXmlSnippet",value:e},{name:"APIName",value:s.a+".Utilities.CustomControlHelper.convertFetchXmlToFilterExpression"}])}}function P(e,t){t||(t=function(e){return e});var n="";if(Object(i.c)(e)||(Object(i.c)(e.filters)||0===e.filters.length)&&(Object(i.c)(e.conditions)||0===e.conditions.length))return n;if(!Object(i.c)(e.conditions)&&e.conditions.length>0){n+='<filter type="'+T(e.filterOperator)+'"',n+=">";for(var r=0;r<e.conditions.length;r++){var a=e.conditions[r];if(n+="<condition ",Object(i.b)(a.entityAliasName)||(n+='entityname="'+a.entityAliasName+'" '),null==a.value)n+='attribute="'+a.attributeName+'" operator="'+N(a.conditionOperator)+'"/>';else if("string"==typeof a.value||"number"==typeof a.value)n+='attribute="'+a.attributeName+'" operator="'+N(a.conditionOperator)+'" value="'+t(a.value)+'" />';else{var o=a.value;n+='attribute="'+a.attributeName+'" operator="'+N(a.conditionOperator)+'">';for(var s=0;s<o.length;s++)n+="<value>"+t(o[s])+"</value>";n+="</condition>"}}n+="</filter>"}else{e.filters.length>0&&(n+='<filter type="'+T(e.filterOperator)+'">');for(r=0;r<e.filters.length;r++)n+=P(e.filters[r],t);e.filters.length>0&&(n+="</filter>")}return n}function T(e){switch(e){case 0:return"and";case 1:return"or"}}function N(e){switch(e){case 0:return"eq";case 1:return"ne";case 2:return"gt";case 3:return"lt";case 4:return"ge";case 5:return"le";case 6:return"like";case 7:return"not-like";case 8:return"in";case 9:return"not-in";case 10:return"between";case 11:return"not-between";case 12:return"null";case 13:return"not-null";case 14:return"yesterday";case 15:return"today";case 16:return"tomorrow";case 17:return"last-seven-days";case 18:return"next-seven-days";case 19:return"last-week";case 20:return"this-week";case 21:return"next-week";case 22:return"last-month";case 23:return"this-month";case 24:return"next-month";case 25:return"on";case 26:return"on-or-before";case 27:return"on-or-after";case 28:return"last-year";case 29:return"this-year";case 30:return"next-year";case 31:return"last-x-hours";case 32:return"next-x-hours";case 33:return"last-x-days";case 34:return"next-x-days";case 35:return"last-x-weeks";case 36:return"next-x-weeks";case 37:return"last-x-months";case 38:return"next-x-months";case 39:return"last-x-years";case 40:return"next-x-years";case 41:return"eq-userid";case 42:return"ne-userid";case 43:return"eq-businessid";case 44:return"ne-businessid";case 49:return"contain-values";case 51:return"eq-userlanguage";case 53:return"olderthan-x-months";case 54:return"begins-with";case 55:return"not-begin-with";case 56:return"ends-with";case 57:return"not-end-with";case 58:return"this-fiscal-year";case 59:return"this-fiscal-period";case 60:return"next-fiscal-year";case 61:return"next-fiscal-period";case 62:return"last-fiscal-year";case 63:return"last-fiscal-period";case 64:return"last-x-fiscal-years";case 65:return"last-x-fiscal-periods";case 66:return"next-x-fiscal-years";case 67:return"next-x-fiscal-periods";case 68:return"in-fiscal-year";case 69:return"in-fiscal-period";case 70:return"in-fiscal-period-and-year";case 71:return"in-or-before-fiscal-period-and-year";case 72:return"in-or-after-fiscal-period-and-year";case 73:return"eq-userteams";case 74:return"eq-useroruserteams";case 75:return"above";case 76:return"under";case 77:return"not-under";case 78:return"eq-or-above";case 79:return"eq-or-under";case 80:return"eq-useroruserhierarchy";case 81:return"eq-useroruserhierarchyandteams";case 82:return"olderthan-x-years";case 83:return"olderthan-x-weeks";case 84:return"olderthan-x-days";case 85:return"olderthan-x-hours";case 86:return"olderthan-x-minutes";case 87:return"contain-values";case 88:return"not-contain-values"}}function A(e){return"in"===e||"not-in"===e||"in-fiscal-period-and-year"===e||"in-or-after-fiscal-period-and-year"===e||"in-or-before-fiscal-period-and-year"===e||"contain-values"===e||"not-contain-values"===e}function D(e){if(!e)return null;switch(e){case"eq":return 0;case"ne":case"neq":return 1;case"ge":return 4;case"gt":return 2;case"le":return 5;case"lt":return 3;case"on":return 25;case"on-or-before":return 26;case"on-or-after":return 27;case"like":return 6;case"not-like":return 7;case"in":return 8;case"not-in":return 9;case"between":return 10;case"not-between":return 11;case"null":return 12;case"not-null":return 13;case"yesterday":return 14;case"today":return 15;case"tomorrow":return 16;case"last-seven-days":return 17;case"next-seven-days":return 18;case"last-week":return 19;case"this-week":return 20;case"next-week":return 21;case"last-month":return 22;case"this-month":return 23;case"next-month":return 24;case"last-year":return 28;case"this-year":return 29;case"next-year":return 30;case"last-x-hours":return 31;case"next-x-hours":return 32;case"last-x-days":return 33;case"next-x-days":return 34;case"last-x-weeks":return 35;case"next-x-weeks":return 36;case"last-x-months":return 37;case"next-x-months":return 38;case"last-x-years":return 39;case"next-x-years":return 40;case"this-fiscal-year":return 58;case"this-fiscal-period":return 59;case"next-fiscal-year":return 60;case"next-fiscal-period":return 61;case"last-fiscal-year":return 62;case"last-fiscal-period":return 63;case"last-x-fiscal-years":return 64;case"last-x-fiscal-periods":return 65;case"next-x-fiscal-years":return 66;case"next-x-fiscal-periods":return 67;case"in-fiscal-year":return 68;case"in-fiscal-period":return 69;case"in-fiscal-period-and-year":return 70;case"in-or-before-fiscal-period-and-year":return 71;case"in-or-after-fiscal-period-and-year":return 72;case"above":return 75;case"under":return 76;case"not-under":return 77;case"eq-or-above":return 78;case"eq-or-under":return 79;case"olderthan-x-months":return 53;case"olderthan-x-years":return 82;case"olderthan-x-weeks":return 83;case"olderthan-x-days":return 84;case"olderthan-x-hours":return 85;case"olderthan-x-minutes":return 86;case"contain-values":return 87;case"not-contain-values":return 88;case"begins-with":return 54;case"ends-with":return 56;case"not-begin-with":return 55;case"not-end-with":return 57;case"eq-businessid":return 43;case"ne-businessid":return 44;case"eq-userlanguage":return 51;case"eq-useroruserhierarchy":return 80;case"eq-useroruserhierarchyandteams":return 81;case"eq-userteams":return 73;case"eq-useroruserteams":return 74;case"eq-userid":return 41;case"ne-userid":return 42}return null}function R(e,t){if(!e)return null;var n=e.attributes.getNamedItem(t);return n?n.value:null}function x(e,t,n,r){return!!L(e,n,t,r)&&(e<n&&t>=r||e<=n&&t>r)}function M(e,t,n,r){return!!L(e,t,n,r)&&(r-n==1&&e<=t)}function F(e,t,n,r,a,i){return!!(e&&t&&e===t&&(n&&r&&n!==r||e>i||a>t))}function k(e,t,n,r){return!!L(e,t,n,r)&&(e-t==1&&n>=r)}function L(e,t,n,r){return!!(e&&t&&n&&r&&e>0&&t>0&&n>0&&r>0)}function B(e){if(e&&e.Properties&&e.Properties.DataSetDefinitions){var t=e.Properties.DataSetDefinitions;for(var n in t)if(e.Properties.DataSetDefinitions[n]&&e.Properties.DataSetDefinitions[n].Primary){for(var r=!1,a=0,i=e.Properties.Properties;a<i.length;a++){if(0===i[a].Usage){r=!0;break}}return!r}}return!1}function U(e){for(var t in e){var n=e[t];if(n&&n.DataProvider)return!0}return!1}function V(e){if(e&&e.Parameters)for(var t in e.Parameters)if(e.Parameters[t]&&e.Parameters[t].Type===o.a.QuickForm)return!0;return!1}function z(e){var t;for(var n in e.Parameters)if(e.Parameters[n]&&e.Parameters[n].Value){var r=e.Parameters[n].Value.split('"');if(r.length>1&&r[0].indexOf("entityname")>-1){t=r[1];break}}return t}function W(e){var t,n,r=function(e){if(e&&e.Parameters)for(var t in e.Parameters)if(e.Parameters[t]&&e.Parameters[t].Type===o.a.QuickForm&&e.Parameters[t].Primary)return t;return"value"}(e.configuration),a=e.dynamicData.parameters[r];if(a&&a.getLatestData){var i=a.getLatestData();t=i?i.entityName:q(e.configuration,1),n=i?i.recordId:function(e){return q(e,2)}(e.configuration)}return{recordId:n,entityTypeName:t}}function q(e,t){var n;if(e&&e.Parameters&&e.Parameters.value){var r=e.Parameters.value,a=r.Value?r.Value.split("|"):null;a&&a.length>t&&(n=a[t])}return n}},VqBP:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return s}));var r=n("455M"),a=n("LbMF"),i=n("Z/4N"),o=n("9fGf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="DisplayAsCustomer360Tile";function c(e,t,n){if(!n)return null;if(n.Parameters&&n.Parameters.QuickForms)return"true"===n.Parameters[s]?r.a.Card:r.a.QuickForm;if(n.Parameters&&n.Parameters.Dashboard)return r.a.Dashboard;if(n.Parameters&&n.Parameters.Url)return r.a.WebResourceHtmlControl;if(n&&"notescontrol"===n.Id)return r.a.TimelineWall;if(n.Parameters&&n.Parameters.TileUrl)return r.a.PowerBI;if(n&&n.Parameters&&n.Parameters.FailureTimeField)return r.a.Timer;const i=Object(a.a)(e,t,n.DataFieldName);if(i){let e=i.Format;return"lookup"===i.Type&&"0"===i.Format&&i.Targets&&i.Targets.length>1&&(e="1"),i.Type+"."+e}return null}function l(e,t,n){const r=t.UniqueId,a=Object(o.b)(e),s=Object(i.b)(e,r,n);if(s&&s.CustomControls&&s.CustomControls[a]&&null!=s.CustomControls[a].CustomControlId){const t=s.CustomControls[a].CustomControlId,n=Object(i.e)(e,t);for(const e in n.Properties){const t=n.Properties[e];for(const e in t)if(t[e].Primary)return t[e].Type}}return null}},"W/Jk":function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.timelineToCsv=t.timelineToFullDataJson=t.timelineToSerializable=t.timelineDataFromJson=t.doTimespansOverlap=t.PerformanceTimeline=void 0;var a=n("zmaG"),i=n("rdtZ"),o=function(){function e(e,t,n){void 0===e&&(e=null),void 0===t&&(t=null),void 0===n&&(n=!1),this._events=e||[],this._metadata=t,!n&&this._finalize()}return e.prototype.getMetadata=function(){return this._metadata},e.prototype.setMetadata=function(e){this._metadata=e},e.prototype.setTags=function(e){this._tags=e},e.prototype.getTags=function(){return this._tags},e.prototype.getName=function(){var e,t;if(this._tags&&this._tags.length>0)return this._tags.join(", ");var n=this.getKeyPerformanceIndicators();if(n.length>0)return n[n.length-1].name;var a=null,i=0,o=0;try{for(var s=r(this._events),c=s.next();!c.done;c=s.next()){var l=c.value;if(l.timeEnd){var u="Core.Actions.Async"===l.zone?3:"Core.Actions.Sync"===l.zone?2:1,d=l.timeEnd-l.time;u>=o&&d>i&&(o=u,i=d,a=l)}}}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}return a?a.name:"Untitled timeline"},e.prototype.getStartTime=function(){return 0===this._events.length?0:this._events[0].time},e.prototype.getDuration=function(){if(0===this._events.length)return 0;var e=this._events[0].time,t=this._events[this._events.length-1];return(t.timeEnd||t.time)-e},e.prototype.getKeyPerformanceIndicators=function(){var e=this._events.find((function(e){return e.name===a.WORK_START_EVENT_NAME})),t=e?e.time:0;return this._events.filter((function(e){return e.zone===a.KPI_ZONE})).map((function(e){var n=e.time;return e.parameters&&e.parameters.value?n=e.parameters.value:n-=t,{name:e.name,value:n}})).sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}))},e.prototype.getEvents=function(){return this._events},e.prototype.filter=function(t){return new e(this._events.filter(t),this._metadata,!0)},e.prototype.getNetworkRequests=function(){return this.getEvents().reduce((function(e,t){return t.zone===i.NETWORK_REQUEST_EVENT_NAME&&e.push(t),e}),[])},e.prototype.getTimelineForTimespan=function(e,t){return this.filter((function(n){return s(n.time,n.timeEnd,e,t)}))},e.prototype._finalize=function(){if(0!==this._events.length){this._events=this._events.sort((function(e,t){return e.time<=t.time?-1:1}));var e=this.getStartTime();this._events=this._events.map((function(t){return Object.assign({},t,{time:t.time-e,timeEnd:null!=t.timeEnd?t.timeEnd-e:void 0})}))}},e}();function s(e,t,n,r){return e>=n&&e<=r||t&&t>=n&&t<=r||e<=n&&t&&t>=r}function c(e){return{events:e.getEvents(),metadata:e.getMetadata(),tags:e.getTags()}}t.PerformanceTimeline=o,t.doTimespansOverlap=s,t.timelineDataFromJson=function(e){var t=JSON.parse(e),n=new o(t.timeline.events,t.timeline.metadata);return n.setTags(t.tags),{timeline:n,keyPerformanceIndicators:t.keyPerformanceIndicators,issues:t.issues}},t.timelineToSerializable=c,t.timelineToFullDataJson=function(e,t){return JSON.stringify({timeline:c(e),keyPerformanceIndicators:e.getKeyPerformanceIndicators(),issues:t})},t.timelineToCsv=function(e){return e.getEvents().reduce((function(e,t){return e+(t.zone+", ")+t.name+", "+t.time+", "+t.timeEnd+", "+JSON.stringify(t.parameters)+"\n"}),"Zone, Name, Start time, End time, Parameters\n")}},W1cF:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"i",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"f",(function(){return g})),n.d(t,"g",(function(){return h})),n.d(t,"c",(function(){return f})),n.d(t,"j",(function(){return m})),n.d(t,"b",(function(){return b})),n.d(t,"h",(function(){return _}));var r=n("23jc"),a=n("SRlt"),i=n("DRVD"),o=n.n(i),s=n("SZCI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c=o.a.createEvent("retrieveSuggestionResults",s.h),l="globalsearch.last.search.text";function u(e){return{type:l,payload:{lastSearchText:e}}}const d="globalsearch.suggestions.pending";const p="globalsearch.suggestions.set";function g(){return{type:p,payload:{suggestions:[]}}}function h(e,t,n=7){return{type:"globalsearch.suggestions.retrieve.async",execute:async(i,o)=>{if(!e)return void i.dispatch(g());i.dispatch({type:d,payload:null});const s={endpoint:"/api/search/V1.0/suggest",method:"POST",urlParameters:"",body:JSON.stringify({search:e,top:n,useFuzzy:!0})},l=e.length.toString(),u=c.startStopwatch({searchSessionId:t,searchTextLength:l});let h;try{const e=await i.dispatch(Object(r.a)(s)),t=await Object(a.g)(e);if(u(),t.code)throw o.EventManager.ReportComponentFailure("GlobalSearchAction.retrieveSuggestionResults.apiError",t),new Error(t.message);h=t.value}catch(e){o.EventManager.ReportComponentFailure("GlobalSearchAction.retrieveSuggestionResults.error",e),h=[]}i.dispatch(function(e){return{type:p,payload:{suggestions:e}}}(h))}}}const f="globalsearch.presentation.isexpanded";function m(e){return{type:f,payload:{isExpanded:e}}}const b="globalsearch.presentation.availablewidth";function _(e){return{type:b,payload:{availableWidth:e}}}},W8lr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("mcT5"),a=n("4or6"),i=n("ENs/"),o=n("Evi3"),s=n("WfN+"),c=n("fdXt"),l=n("NCQ1"),u=function(){function e(){}return e.setEventsHandler=function(e){this._eventHandler=e},e.getEventsHandler=function(){return this._eventHandler},e.scheduleTimer=function(){var e=this,t=this._profiles[this._currentProfile][2];this._timeout<0&&t>=0&&!this._paused&&(this._eventHandler.hasEvents()?(0===t&&this._currentBackoffCount>0&&(t=1),this._timeout=setTimeout((function(){return e._batchAndSendEvents()}),t*(1<<this._currentBackoffCount)*1e3)):this._timerCount=0)},e.initialize=function(e){var t=this;this._newEventsAllowed=!0,this._config=e,this._eventHandler=new i.default(e.collectorUri,e.cacheMemorySizeLimitInNumberOfEvents,e.httpXHROverride,e.clockSkewRefreshDurationInMins),this._initializeProfiles(),o.default.initialize((function(e,n){if(t._config.canSendStatEvent("awt_stats")){var r=new s.default("awt_stats");for(var i in r.setEventPriority(a.AWTEventPriority.High),r.setProperty("TenantId",n),e)e.hasOwnProperty(i)&&r.setProperty(i,e[i].toString());c.default.getLogger(l.StatsApiKey).logEvent(r)}}))},e.setTransmitProfile=function(e){this._currentProfile!==e&&void 0!==this._profiles[e]&&(this.clearTimeout(),this._currentProfile=e,this.scheduleTimer())},e.loadTransmitProfiles=function(e){for(var t in this._resetTransmitProfiles(),e)if(e.hasOwnProperty(t)){if(3!==e[t].length)continue;for(var n=2;n>=0;--n)if(e[t][n]<0){for(var r=n;r>=0;--r)e[t][r]=-1;break}for(n=2;n>0;--n)if(e[t][n]>0&&e[t][n-1]>0){var a=e[t][n-1]/e[t][n];e[t][n-1]=Math.ceil(a)*e[t][n]}this._profiles[t]=e[t]}},e.sendEvent=function(e){this._newEventsAllowed&&(this._currentBackoffCount>0&&e.priority===a.AWTEventPriority.Immediate_sync&&(e.priority=a.AWTEventPriority.High),this._eventHandler.addEvent(e),this.scheduleTimer())},e.flush=function(e){var t=(new Date).getTime();!this._paused&&this._lastUploadNowCall+3e4<t&&(this._lastUploadNowCall=t,this._timeout>-1&&(clearTimeout(this._timeout),this._timeout=-1),this._eventHandler.uploadNow(e))},e.pauseTransmission=function(){this._paused||(this.clearTimeout(),this._eventHandler.pauseTransmission(),this._paused=!0)},e.resumeTransmision=function(){this._paused&&(this._paused=!1,this._eventHandler.resumeTransmission(),this.scheduleTimer())},e.flushAndTeardown=function(){o.default.teardown(),this._newEventsAllowed=!1,this.clearTimeout(),this._eventHandler.teardown()},e.backOffTransmission=function(){this._currentBackoffCount<4&&(this._currentBackoffCount++,this.clearTimeout(),this.scheduleTimer())},e.clearBackOff=function(){this._currentBackoffCount>0&&(this._currentBackoffCount=0,this.clearTimeout(),this.scheduleTimer())},e._resetTransmitProfiles=function(){this.clearTimeout(),this._initializeProfiles(),this._currentProfile=r.AWT_REAL_TIME,this.scheduleTimer()},e.clearTimeout=function(){this._timeout>0&&(clearTimeout(this._timeout),this._timeout=-1,this._timerCount=0)},e._batchAndSendEvents=function(){var e=a.AWTEventPriority.High;this._timerCount++,this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][0]?(e=a.AWTEventPriority.Low,this._timerCount=0):this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][1]&&(e=a.AWTEventPriority.Normal),this._eventHandler.sendEventsForPriorityAndAbove(e),this._timeout=-1,this.scheduleTimer()},e._initializeProfiles=function(){this._profiles={},this._profiles[r.AWT_REAL_TIME]=[4,2,1],this._profiles[r.AWT_NEAR_REAL_TIME]=[12,6,3],this._profiles[r.AWT_BEST_EFFORT]=[36,18,9]},e._newEventsAllowed=!1,e._currentProfile=r.AWT_REAL_TIME,e._timeout=-1,e._currentBackoffCount=0,e._paused=!1,e._timerCount=0,e._lastUploadNowCall=0,e}();t.default=u},WF3G:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("504W"),a=n("Ydwo"),i=n("2F73"),o=n("XvL5"),s=n("cgR4"),c=n("8tWD"),l=n("/bjP"),u=n("eruq"),d=n("TFb5"),p=n("MXaZ"),g=n("s/8p");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class h{constructor(e){this._columnSet=null,this._descriptorSet=null,this._noLock=!1,this._pageNumber=1,this._pageSize=1,this._entityLogicalName=null,this._returnTotalRecordCount=!1,this._queryContext=null,this._status=[],this._pagingCookie="",Object(r.a)(e)||this._CreateQuery(e)}get_ColumnSet(){return this._columnSet}set_ColumnSet(e){return this._columnSet=e,e}set_ColumnNames(e){return this._columnNames=e,e}get_DescriptorSet(){return this._descriptorSet}get queryStatus(){return this._status}_set_DescriptorSet(e){return this._descriptorSet=e,e}get_FetchXml(){const e=this.rawFetchXmlDoc;return Object(r.a)(e)||Object(r.a)(e.firstChild)||e.firstChild.nodeName!==h._FetchXmlNodeName?this.get_rawFetchXml():(Object(d.s)(this.rawFetchXmlDoc,this.get_PageSize(),this.get_PageNumber(),this.get_PagingCookie(),!0,this._get_NoLock()),Object(u.a)(e).get_outerXml())}set_FetchXml(e){if(Object(r.b)(e)||"<"!==e.substr(0,1))this.set_ColumnSet(new o.a(new Array(0)));else{const t=Object(u.b)(e);if(this.rawFetchXmlDoc=t,!Object(r.a)(t)){const e=Object(u.a)(t),n=e.selectSingleNode("/"+h._FetchXmlNodeName);if(!Object(r.a)(n)){let a=n.getAttribute(h._PageNumberXmlAttributeName);Object(r.a)(a)||this.set_PageNumber(Number.parseInvariant(a)),a=n.getAttribute(h._PageSizeXmlAttributeName),Object(r.a)(a)||this.set_PageSize(Number.parseInvariant(a)),a=n.getAttribute(h._PagingCookieXmlAttributeName),Object(r.a)(a)||this.set_PagingCookie(a);const s=e.selectSingleNode("/fetch/entity");if(Object(r.a)(s)||this.set_EntityLogicalName(s.getAttribute("name")),Object(r.a)(e.selectSingleNode("/fetch/entity/all-attributes"))){const t=[],n=e.selectNodes("/fetch/entity/attribute");for(let e=0;e<n.get_count();e++)t.push(n.get_item(e).getAttribute("name"));this.set_ColumnSet(new o.a(t))}else this.set_ColumnSet(i.a.get_instance());const c=t.firstChild.attributes.getNamedItem(h._ReturnTotalRecordCountAttributeName);this._returnTotalRecordCount=Object(r.a)(c)?h._DefaultReturnTotalRecordCountValue:Boolean.parse(c.nodeValue).valueOf()}}}return e}get_sql(e){let t=this.get_DescriptorSet().tryGetDescriptor(c.a.Sql);if(!Object(r.b)(t)){const n=1+this.get_PageSize(),r=this.get_PageSize()*(this.get_PageNumber()-1);t=t+h._SqlQueryLimitName+n+h._SqlQueryOffsetName+r,t=t.replace('"!eq-userid!"',"'"+e.get_UserId().toString()+"' COLLATE NOCASE"),t=this.substituteDateTimePlaceholders(e,t);const a="6";t=t.replace("@LanguageId0",e.get_UserSettings().get_languageId().toString()),t=t.replace("@LanguageId1",e.get_organizationSettings().get_languageCode().toString()),t=t.replace("@ObjectColumnName0",a),t=t.replace("@ObjectColumnName1",a)}return t}get_PageNumber(){return this._pageNumber}set_PageNumber(e){if(e<1)throw Error.argumentOutOfRange("value",e,"PageNumber cannot be less than 1");return this._pageNumber=e,e}_get_NoLock(){return this._noLock}set_NoLock(e){return this._noLock=e,e}get_PageSize(){return this._pageSize}set_PageSize(e){return this._pageSize=e,e}get_PagingCookie(){return this._pagingCookie}set_PagingCookie(e){return Object(r.b)(e)&&(this._pagingCookie=""),this._pagingCookie=e,e}get_EntityLogicalName(){return this._entityLogicalName}set_EntityLogicalName(e){return this._entityLogicalName=e,e}get_returnTotalRecordCount(){return this._returnTotalRecordCount}get_queryContext(){return this._queryContext}set_queryContext(e){this._queryContext=e}get_id(){return this.get_rawFetchXml()}get_RawSql(){return this.get_DescriptorSet().tryGetDescriptor(c.a.Sql)}set_RawSql(e){return Object(r.a)(this._descriptorSet)||this._descriptorSet.updateDescriptorSet(c.a.Sql,e),e}get_rawFetchXml(){return this.rawFetchXmlDoc?Object(u.a)(this.rawFetchXmlDoc).get_outerXml():""}get_FetchXmlForAliasedValues(){return this._fetchXmlForAliasedValues}set_FetchXmlForAliasedValues(e){this._fetchXmlForAliasedValues=e}_CreateQuery(e){if(e instanceof l.a){this._descriptorSet=new l.a;for(const t in e.get_descriptors()){const n=e.get_descriptors()[t];this._descriptorSet.get_descriptors()[c.a[n.Format]]=new s.a(n.Format,n.Data),n.Format===c.a.FetchXml&&this.set_FetchXml(n.Data)}}else this.set_FetchXml(e.toString()),this._set_DescriptorSet(l.a.createFromFetchXml(e.toString()))}toString(){return String.format("Query: {0}",this.get_rawFetchXml())}GetColumnNamesFromFetch(){return Object(r.a)(this._columnNames)?Object(d.m)(this.rawFetchXmlDoc):this._columnNames}updateSqlWithWhereClauseFromQueryFilter(e,t,n,a,i){const o=n.getElementsByTagName("condition");for(let n=0;n<o.length;n++){const s=Object(d.o)(o[n],"attribute");Object(r.b)(s)||a!==s&&i!==s||(t=this._UpdateSqlWithWhereClauseFromCondition(e,t,o[n],"and"))}return t}updateSqlWithWhereClauseFromRelationshipCondition(e,t,n){const r=n.getElementsByTagName("condition")[0],a=n.getElementsByTagName("filter")[0],i=Object(d.o)(a,"type");return this._UpdateSqlWithWhereClauseFromCondition(e,t,r,i)}_UpdateSqlWithWhereClauseFromCondition(e,t,n,i){let o=new Sys.StringBuilder(t);const s='"'+e+'0"',c=new Sys.StringBuilder;for(let e=0;e<n.childNodes.length;e++){const t=n.childNodes[e];if("value"===t.nodeName){const r=t.firstChild.nodeValue;c.append(String.format("'{0}'",r)),e!==n.childNodes.length-1&&c.append(", ")}}const l=c.toString();let u=null;if(0===l.length){const e=Object(d.o)(n,"value");e||this._status.push({failed:!0,offlineModeSpecific:!0,message:h._MissingValueAttribute}),u=String.format(" '{0}' ",e)}else u=String.format(" ({0}) ",l);let p=Object(d.o)(n,"attribute");p=this.generateNorSyncAttributeName(e,p,Object(a.a)(()=>u,e=>u=e));const f=this._GetOperators(Object(d.o)(n,"operator"));Object(r.b)(f)&&this._status.push({failed:!0,offlineModeSpecific:!0,message:h._UnsupportedQueryOperator});let m="WHERE (("+s+"."+p+" "+f+u+")) COLLATE NOCASE ";if(1===t.split(g.h).length)if(t.toUpperCase().indexOf("WHERE")===t.toUpperCase().lastIndexOf("WHERE")&&t.toUpperCase().indexOf("WHERE")>0){m+=i;let e=t.split("WHERE");1===e.length&&(e=t.split("where")),o=new Sys.StringBuilder(e[0]+m+e[1])}else t.toUpperCase().indexOf("WHERE")<=0&&(t.toUpperCase().indexOf("ORDER BY")>0?o=t.indexOf("ORDER BY")>0?new Sys.StringBuilder(t.replace("ORDER BY"," "+m+"ORDER BY")):new Sys.StringBuilder(t.replace("order by"," "+m+"ORDER BY")):o.append(m));else{const e=t.split(g.j);if(2===e.length){m+=i;const t=e[1].replace(/where/i,m);o=new Sys.StringBuilder(`${e[0]} ${g.j} ${t}`)}else if(1===e.length){const e=t.split(g.e);2===e.length?o=new Sys.StringBuilder(`${e[0]} ${g.j} ${m} ${g.i} ${g.e} ${e[1]}`):o.append(` ${g.j} ${m} ${g.i}`)}}return o.toString()}updateSqlWithJoinClauseFromContextFilter(e,t,n,r,a){const i=n.getElementsByTagName("filter")[0];let o=null,s="";const c='"'+e+'0"',l=c+" ";o=n.getElementsByTagName("link-entity")[0];n.getElementsByTagName("link-entity").length>1?(s=this._GenerateJoinClause(e,r,a,i,o,c,!0),e=Object(d.o)(o,"name"),o=n.getElementsByTagName("link-entity")[1],s=s+" "+this._GenerateJoinClause(e,r,a,i,o,e+"2",!1)):s=this._GenerateJoinClause(e,r,a,i,o,c,!1);const u=t.lastIndexOf(l),p=t.lastIndexOf(g.c);if(p>0){const e=t.substring(0,p),n=t.substring(p+g.c.length,t.length);t=`${e} ${s} ${n}`}else if(u>0){const e=t.substring(0,u),n=t.substring(u+l.length,t.length);t=e+c+s+n}else t+=s;return t}_GenerateJoinClause(e,t,n,r,i,o,s){let c=null,l="",u="";const p=Object(d.o)(i,"name");u=s?p+"2":Object(d.o)(i,"alias");const g=p+" AS "+u+" ON ("+o+"."+this.generateNorSyncAttributeName(e,Object(d.o)(i,"to"),Object(a.a)(()=>c,e=>c=e))+" = "+u+"."+this.generateNorSyncAttributeName(p,Object(d.o)(i,"from"),Object(a.a)(()=>c,e=>c=e));if(s)l=" JOIN "+g+" COLLATE NOCASE )";else{const e=u+"."+Object(d.o)(t,"attribute")+" "+this._GetOperators(Object(d.o)(t,"operator"))+" '"+n+"' COLLATE NOCASE ";l=" JOIN "+g+" COLLATE NOCASE "+Object(d.o)(r,"type")+" (( "+e+"))) "}return l}generateNorSyncAttributeName(e,t,n){return t}_GetOperators(e){let t="";switch(e){case"eq":t="=";break;case"not-eq ":case"ne":t="!=";break;case"like":t="like";break;case"in":t="in"}return t}substituteDateTimePlaceholders(e,t){const n=Object(p.A)(e);return t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(h._startOfCurrentHourUTCRegex,Object(p.y)(e,Object(p.v)(n)))).replace(h._startOfTodayUTCRegex,Object(p.y)(e,Object(p.u)(n)))).replace(h._startOfWorkWeekUTCRegex,Object(p.y)(e,Object(p.H)(e,n)))).replace(h._startOfMonthUTCRegex,Object(p.y)(e,Object(p.w)(n)))).replace(h._startOfYearUTCRegex,Object(p.y)(e,Object(p.x)(n)))).replace(h._userTimezoneHourOffsetRegex,Object(p.B)(e).toString())).replace(h._userTimezoneMinuteOffsetRegex,Object(p.C)(e).toString())).replace(h._UTCHourOffsetRegex,Object(p.D)(e).toString())).replace(h._UTCMinuteOffsetRegex,Object(p.E)(e).toString())}static get_empty(){return new h("")}}h._PageNumberXmlAttributeName="page",h._PageSizeXmlAttributeName="count",h._PagingCookieXmlAttributeName="paging-cookie",h._ReturnTotalRecordCountAttributeName="returntotalrecordcount",h._FetchXmlNodeName="fetch",h._SqlQueryLimitName=" LIMIT ",h._SqlQueryOffsetName=" OFFSET ",h._DefaultReturnTotalRecordCountValue=!0,h._UnsupportedQueryOperator="Error.Unsupported.Query.Operator",h._MissingValueAttribute="Error.Missing.Value.Attribute",h._startOfCurrentHourUTCRegex=new RegExp("'!start-of-current-hour-utc!'","g"),h._startOfTodayUTCRegex=new RegExp("'!start-of-today-utc!'","g"),h._startOfWorkWeekUTCRegex=new RegExp("'!start-of-work-week-utc!'","g"),h._startOfMonthUTCRegex=new RegExp("'!start-of-month-utc!'","g"),h._startOfYearUTCRegex=new RegExp("'!start-of-year-utc!'","g"),h._userTimezoneHourOffsetRegex=new RegExp("!user-timezone-hour-offset!","g"),h._userTimezoneMinuteOffsetRegex=new RegExp("!user-timezone-minute-offset!","g"),h._UTCHourOffsetRegex=new RegExp("!utc-hour-offset!","g"),h._UTCMinuteOffsetRegex=new RegExp("!utc-minute-offset!","g")},WIoD:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"h",(function(){return i})),n.d(t,"i",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return p}));var r=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a=new r.a("{e7a81278-8635-4d9e-8d4d-59480b391c5b}"),i=new r.a("{9fdf5f91-88b1-47f4-ad53-c11efc01a01d}"),o=new r.a("{587CDF98-C1D5-4bde-8473-14A0BC7644A7}"),s=new r.a("39354e4a-5015-4d74-8031-ea9eb73a1322"),c=new r.a("F9A8A302-114E-466A-B582-6771B2AE0D92"),l=new r.a("F3015350-44A2-4aa0-97B5-00166532B5E9"),u=new r.a("06375649-C143-495E-A496-C962E5B4488E"),d=new r.a("4aa28ab7-9c13-4f57-a73d-ad894d048b5f"),p=new r.a("fd2a7985-3187-444e-908d-6624b21f69c0")},WKRf:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="form.entityRecordDeleted.set";function i(e,t,n){const i=Object(r.v)(n);return{type:a,payload:t,meta:{pageId:e,contextKey:i}}}},WLAV:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the Search page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="PowerBIFullScreen"},WPtp:function(e,t,n){"use strict";n.d(t,"i",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"k",(function(){return c})),n.d(t,"j",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return f}));var r=n("SAYH");function a(e){if(e){if(l(e)){if(e.validationResult&&!e.validationResult.isValueValid){const t=e.validationResult.userInput;return t&&(null==t?void 0:t.toString())}return e.formatted||e.value&&e.value.toString()}if(o(e))return e.label;if(s(e))return r.a.toString(e.id);if(c(e))return e.reference&&e.reference.name||null;if(u(e))return a(e.innerValue);if(d(e)){let t="";for(const n of e.list){let e=null;n.fields&&(e=n.fields.partyid?n.fields.partyid:n.fields.addressused?n.fields.addressused:null,e&&(t=""!==t?`${t}, ${a(e)}`:a(e)))}return t}return p(e)}return null}function i(e){return e?l(e)?e.value:o(e)?g(e):s(e)?e.id:c(e)?e.reference:u(e)?i(e.innerValue):d(e)?e.list:p(e):null}function o(e){return!!e&&e.hasOwnProperty("label")}function s(e){return!!e&&e.hasOwnProperty("id")}function c(e){return!!e&&e.hasOwnProperty("reference")}function l(e){return!!e&&e.hasOwnProperty("value")}function u(e){return!!e&&e.hasOwnProperty("innerValue")}function d(e){return!!e&&e.hasOwnProperty("list")}function p(e){return e?e.toString():null}function g(e){return e&&o(e)?e.valueString:null}function h(e){return e&&c(e)&&e.reference&&e.reference.id||null}function f(e){return c(e)&&e.reference||null}},WRF3:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("84PK"),a=n("504W"),i=n("NMtn"),o=n("jZCH");class s{constructor(e,t,n,r){this.Id=null,this.LogicalName=null,this.Name=null,this.TypeCode=0,this.TypeDisplayName=null,this.TypeName=null,this.__RowVersion=null,Object(i.d)(e,"logicalName"),Object(i.d)(t,"id"),this.LogicalName=e,this.Id=t,this.Name=n,this.set_rowVersion(r),this.TypeName=e,this.TypeDisplayName=e;try{if(o.a.get_DefaultInstance().get_MetadataCache()){const t=o.a.get_DefaultInstance().get_MetadataCache().getEntityMetadata(e);Object(a.a)(t)||(this.TypeCode=t.get_objectTypeCode())}}catch(e){}}get_key(){return this.Id.toString()}get_identifier(){return this.Id.toString()}get_modelType(){return this.LogicalName}get_rowVersion(){return this.__RowVersion}set_rowVersion(e){return this.__RowVersion=e,e}getObjectData(){return{logicalname:this.LogicalName,id:this.Id.getObjectData(),name:this.Name,rowversion:!Object(a.a)(this.get_rowVersion())&&this.get_rowVersion()}}equals(e){if(e instanceof s){const t=e;return t.LogicalName===this.LogicalName&&this.Id.equals(t.Id)&&this.Name===t.Name}return!1}toString(){return String.format("{0}:{1}",this.LogicalName,this.Id.toString())}getValue(e){return this[s._UppercaseFirstCharacter(e)]}setValue(e,t){this[s._UppercaseFirstCharacter(e)]=t}static get_empty(){return s._empty||(s._empty=new s("",r.a.get_empty(),""))}static createFromObjectData(e){const t=e.logicalname,n=r.a.createFromObjectData(e.id),a=e.name;if(e.rowversion){const r=e.rowversion;return new s(t,n,a,r)}return new s(t,n,a)}static _UppercaseFirstCharacter(e){return e.substr(0,1).toUpperCase()+e.substr(1)}}s._empty=null,s.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference"},WSMw:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Create",a="Update",i="Delete",o="Retrieve"},WTcq:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.GLOBAL_CONTAINER_KEY="crm_header_global"}(r||(r={}))},WWG3:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("504W"),a=n("cfGX"),i=n("MXaZ");class o{constructor(e,t){this._timeZoneOffsetMinutes=0,this._adjusters=[],this._timeZoneOffsetMinutes=e,Object(r.a)(t)||(this._adjusters=Object(i.I)(t))}parseIntegerValue(e){const t=this.parseDecimalValue(e);return Object(r.a)(t)?a.c:Math.floor(t)}parseDecimalValue(e,t){let n=a.b;if(!Object(r.a)(e)){const i=new RegExp("(\\s|"+o._leftToRightMark+"|"+o._rightToLeftMark+")","g");e=e.replace(i,"");const s=!(/^\(.*\)$/.test(e)===!(/^\-/.test(e)===/\-$/.test(e)));s&&(e=e.replace(/[\(\)\-]/g,"")),n=Number.parseLocale(e),isNaN(n)?n=a.b:(s&&(n=-n),Object(r.a)(t)||(n=parseFloat(n.toFixed(t))))}return n}formatShortDateValue(e,t){let n=a.d;if(o.isDateTime(e)){n=Object(i.m)(e,this._timeZoneOffsetMinutes,t,this._adjusters).localeFormat("d")}return n}formatShortDateTimeValue(e,t){let n=a.d;if(o.isDateTime(e)){const r=Sys.CultureInfo.CurrentCulture.dateTimeFormat.ShortDatePattern,a=Sys.CultureInfo.CurrentCulture.dateTimeFormat.ShortTimePattern.replace(":",Sys.CultureInfo.CurrentCulture.dateTimeFormat.TimeSeparator),o=Object(i.m)(e,this._timeZoneOffsetMinutes,t,this._adjusters);n=String.localeFormat("{0:"+r+" "+a+"}",o)}return n}static get_instance(){return o._instance}static set_instance(e){return o._instance=e,e}static isDateTime(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}}o._leftToRightMark="",o._rightToLeftMark="",o._instance=null},WWXV:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.Authentication=1]="Authentication",e[e.LocalStore=2]="LocalStore"}(r||(r={}))},"WY/A":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("Dea/"),a=n("bT7G");const i="dataSnapshot.create";function o(e,t,n,o,s=r.a.Update){if(!t||!n)throw new Error("Cannot create snapshot: invalid parameters specified");const c=Object(a.a)(e),l=t.etn+":"+c;return{type:i,payload:{snapshotId:l,identifier:t,activeChanges:n,mode:s},meta:{contextKey:o,nextSnapshotNumber:c}}}},WZ96:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}));
/**
 * Constants for the grid page.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="puid-",a="subId",i="preview-id",o="z-index"},Wbnz:function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return g})),n.d(t,"c",(function(){return h}));var r=n("uTTW"),a=n("SFgX"),i=n("Xi8U"),o=n("znb3"),s=n("XIN1"),c=n("2bwe"),l=n("YxC/"),u=n("zzhk"),d=n("uZvv");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const p="Mru_Entity_Expand_Tooltip",g="Mru_Entity_Collapse_Tooltip";class h{constructor(e,t,n,r,a,i,o){this._id=e,this._entityTypeName=t,this._title=r,this._icon=i,this._onClickHandler=a,this._subActionDescriptor=o}get id(){return this._id}get entityTypeName(){return this._entityTypeName}get title(){return this._title}get icon(){return this._icon}get subActionDescriptor(){return this._subActionDescriptor}get onClickHandler(){return this._onClickHandler}get isSelected(){return this._isSelected}set isSelected(e){this._isSelected=e}static FromStateItem(e,t){return e.Id?h._fromSubAreaDescriptor(e,t):null}static _fromSubAreaDescriptor(e,t){let n=null;const f=a.a[e.Entity];let m=e.Entity&&f?f:"";e.Url&&-1!==e.Url.indexOf("/workplace/home_dashboards.aspx")&&(m=""),e.VectorIcon&&(n=r.a,m=e.VectorIcon);const b=e.Titles&&e.Titles.length?e.Titles[0].Title:"";let _;if(t&&Object(i.l)(t,e.Entity)&&!Object(u.b)(t)){const n={isOpened:!1,entityTypeName:e.Entity,relativeToEntryId:e.Id},r=Object(i.c)(t);r&&r.entityTypeName===n.entityTypeName&&r.relativeToEntryId===n.relativeToEntryId&&(n.isOpened=r.isOpened);const a=Object(l.e)(t,[g,p]),u=Object(l.c)(a,g),d=Object(l.c)(a,p);_={icon:{type:s.b,value:(n.isOpened?o.a.ChevronUp:o.a.ChevronDown).toString()},onClickHandler:()=>Object(c.b)(n),dropdownInfo:n,toolTip:n.isOpened?String.format(u,b):String.format(d,b)}}const y=new h(e.Id,e.Entity,e.DynamicPage,b,(t,n,r,a)=>a(e,t,n,r),{type:n,value:m},_);if(t&&Object(u.b)(t)){Object(d.c)(t)===y.id&&(y.isSelected=!0)}return y}}},WePp:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var r=n("pEXn"),a=n("mlvZ"),i=n("tWr6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class o{constructor(e){this._activityId="",this._eventname=e,this._eventParameters={},this._eventParameters[r.g.EventContext]={},this._eventParameters[r.d.ActionContext]={},this.addEventParameter(r.g.TimeCreated,new Date)}getActivityId(){return this._activityId}toAriaEventData(){const e={};for(const t in this._eventParameters){let n=this._eventParameters[t];if(!(null!=n&&0===Object.keys(n).length&&n.constructor===Object)){if(r.g.EventContext===t||r.d.ActionContext===t)try{n=Object(a.h)(this._eventname,this._eventParameters,n),n=Object(i.b)(this._eventname,this._eventParameters,n),n=JSON.stringify(n)}catch(e){n="Failed to stringify: "+e.message}e[t]=s(n)}}return{ActivityId:this._activityId,EventName:this._eventname,EventValues:e}}toSendJSON(){const e={};for(const t in this._eventParameters){let n=this._eventParameters[t],a=!0;const i=!(null==n||0!==Object.keys(n).length||n.constructor!==Object);if(r.g.EventContext===t||r.d.ActionContext===t)if(i)a=!1;else try{n=JSON.stringify(n)}catch(e){n="Failed to stringify: "+e.message}a&&(e[t]=n)}return{ActivityId:this._activityId,EventName:this._eventname,EventValues:e}}fromJSON(e){const t=Object.create(o.prototype);return Object.assign(t,e)}getEventName(){return this._eventname}_addContextParameter(e,t,n){this._eventParameters[e][t]=n}_getContextParameter(e,t){return t in this._eventParameters[e]?this._eventParameters[e][t]:""}addEventParameter(e,t,n=!1){void 0===e&&(e="undefined"),void 0===t&&(t="undefined");const a=Object(r.D)(this.getEventName());r.g.ActivityId===e?this._activityId=""+t:!a&&Object(r.C)(e)?this._addContextParameter(r.d.ActionContext,e,t):n?(this._eventParameters[e]=t,this._addContextParameter(r.g.EventContext,e,t)):a||Object(r.E)(this.getEventName(),e)?(null!==this._eventParameters[e]&&void 0!==this._eventParameters[e]&&this._addContextParameter(r.g.EventContext,e,this._eventParameters[e]),this._eventParameters[e]=t):this._addContextParameter(r.g.EventContext,e,t)}getEventParameter(e){let t="";const n=Object(r.D)(this.getEventName());r.g.ActivityId===e?t=this._activityId:!n&&Object(r.C)(e)?t=this._getContextParameter(r.d.ActionContext,e):n||Object(r.E)(this.getEventName(),e)?this._eventParameters[e]&&(t=this._eventParameters[e]):t=this._getContextParameter(r.g.EventContext,e);return{name:e,value:t}}}function s(e){let t;if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)t=e;else if(e instanceof Date)t=e.toISOString();else try{t=JSON.stringify(e)}catch(e){t="Failed to stringify: "+e.message}return t}},"WfN+":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("NCQ1"),a=n("4or6"),i=function(){function e(e){this._event={name:"",properties:{}},e&&this.setName(e)}return e.prototype.setName=function(e){this._event.name=e},e.prototype.getName=function(){return this._event.name},e.prototype.setType=function(e){this._event.type=e},e.prototype.getType=function(){return this._event.type},e.prototype.setTimestamp=function(e){this._event.timestamp=e},e.prototype.getTimestamp=function(){return this._event.timestamp},e.prototype.setEventPriority=function(e){this._event.priority=e},e.prototype.getEventPriority=function(){return this._event.priority},e.prototype.setProperty=function(e,t,n){void 0===n&&(n=a.AWTPropertyType.Unspecified);var i={value:t,type:n,pii:a.AWTPiiKind.NotSet,cc:a.AWTCustomerContentKind.NotSet};null!==(i=r.sanitizeProperty(e,i))?this._event.properties[e]=i:delete this._event.properties[e]},e.prototype.setPropertyWithPii=function(e,t,n,i){void 0===i&&(i=a.AWTPropertyType.Unspecified);var o={value:t,type:i,pii:n,cc:a.AWTCustomerContentKind.NotSet};null!==(o=r.sanitizeProperty(e,o))?this._event.properties[e]=o:delete this._event.properties[e]},e.prototype.setPropertyWithCustomerContent=function(e,t,n,i){void 0===i&&(i=a.AWTPropertyType.Unspecified);var o={value:t,type:i,pii:a.AWTPiiKind.NotSet,cc:n};null!==(o=r.sanitizeProperty(e,o))?this._event.properties[e]=o:delete this._event.properties[e]},e.prototype.getPropertyMap=function(){return this._event.properties},e.prototype.getEvent=function(){return this._event},e}();t.default=i},Wgxh:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){if(e||(e=[]),-1===e.indexOf(t))return e.push(t),e}function a(e,t){if(!e)return;const n=e.indexOf(t);return-1!==n?1===e.length?[]:(e.splice(n,1),e):void 0}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},Wiik:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="preview.form.setConsistencyStrong";function a(e){return{type:r,payload:e}}},WkRo:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n("m2nm"),a=n("pF61"),i=n("0kGT"),o=n("RiEM"),s=n("oT5e");function c(e){return{type:"updateBackButtonBehavior",sync:!0,execute({dispatch:t,getState:n},i){const o=i.Router,s=(0===o.getDialogIdStack().length||1===o.getDialogIdStack().length&&o.getDialogIdStack()[0].includes("__flyoutRootNode"))&&1===o.getHistoryManager().GetHistoryLength({targetBrowsingContext:e});Object(a.e)(n(),e)!==s&&(t(Object(r.b)(s,e)),l())}}}function l(){let e;try{e=new Event("routerBackButtonChanged")}catch(t){e=document.createEvent("Event");const n=!1,r=!1;e.initEvent("routerBackButtonChanged",n,r)}document.dispatchEvent(e)}function u(e){const t=Object(s.e)(e);return Object(i.b)(e)?!Object(a.e)(e,t)||!Object(o.d)(e):!Object(a.e)(e,t)}},Wlg7:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e){this._preventDefault=e||!1}isDefaultPrevented(){return this._preventDefault}preventDefault(){this._preventDefault=!0}}},X37l:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Invalid="Invalid"]="Invalid",e[e.Entity="Entity"]="Entity",e[e.Grid="Grid"]="Grid",e[e.Isv="Isv"]="Isv"}(r||(r={}))},X3qb:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"f",(function(){return c}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Related_Tab_Label",a="Web.Tools.FormEditor.TabName",i="Grid.Search.ViewTitle.Format",o="Web.Tabs.MoreTabs",s="Web.Form.EditForm.Label",c=[r,a,i,o,"Web.SemanticZoom.Button",s]},XIN1:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return a}));var r,a,i=n("NwjZ"),o=n("znb3"),s=n("HMYz"),c=n("iDZS"),l=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.getSymbolClassName=function(e){return Object(o.b)(e)},t}(i.a);!function(e){e[e.None=0]="None",e[e.Left=1]="Left",e[e.Top=2]="Top"}(a||(a={}));var d=s.connect(c.a)(u)},XIaj:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("6eYz"),a=n("zsAz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="add.popupNotificationAction";function o(e){return{type:"add.popupNotificationAction.async",execute({dispatch:t,getState:n},o){const s=e.details,c={};if(s){const e=Object.keys(s),t=e.length<=4?e.length:4;for(let n=0;n<t;n++)c[e[n]]=s[e[n]];if(e.length>4){const t=[];t.push({name:"detailsItemNumber",value:e.length}),t.push({name:"DetailsItemLimit",value:4});o.TraceManager.getTracer("PopupNotification").warn("The number of name/value pair provided as detals to addPopupNotification execeeds the limit",t)}}const l={type:i,payload:{props:Object.assign(Object.assign({},e),{details:c})}},u=Object(r.b)(n());return 1===(u?Object.keys(u):[]).length?Promise.reject(Object(a.d)("A popup notification is already opened",2415919123)):Promise.resolve(t(l))}}}},XOSd:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l}));var r=n("GYEz"),a=n("w1eR"),i=n("Lyxw"),o=n("3/02"),s=n("dj6u");function c(e,t){const n=Object(r.a)(e)===a.a.MailApp,s=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){const t=e.searchParams.get("forceClientCdn");return"true"===t||"1"===t}(t);return!n&&!s&&Object(i.c)(e,o.xd)}function l(e){const t=Object(s.b)(e),n=Object(s.a)(e);t&&n&&navigator.serviceWorker&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({purgeUserContextCache:!0,aadObjectId:t,aadTenantId:n})}},XZPR:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="clear.toastNotificationsAction";function a(){return{type:"clear.toastNotificationsAction.async",execute({dispatch:e}){const t={type:r,payload:""};return Promise.resolve(e(t))}}}},"Xd5/":function(e,t,n){"use strict";n.d(t,"A",(function(){return j})),n.d(t,"x",(function(){return L})),n.d(t,"D",(function(){return B})),n.d(t,"p",(function(){return U})),n.d(t,"l",(function(){return V})),n.d(t,"j",(function(){return z})),n.d(t,"y",(function(){return W})),n.d(t,"v",(function(){return q})),n.d(t,"w",(function(){return H})),n.d(t,"q",(function(){return G})),n.d(t,"n",(function(){return K})),n.d(t,"m",(function(){return Q})),n.d(t,"k",(function(){return X})),n.d(t,"f",(function(){return Y})),n.d(t,"e",(function(){return J})),n.d(t,"s",(function(){return $})),n.d(t,"o",(function(){return Z})),n.d(t,"u",(function(){return ee})),n.d(t,"t",(function(){return te})),n.d(t,"r",(function(){return ne})),n.d(t,"h",(function(){return re})),n.d(t,"i",(function(){return ae})),n.d(t,"z",(function(){return ie})),n.d(t,"c",(function(){return oe})),n.d(t,"a",(function(){return se})),n.d(t,"g",(function(){return le})),n.d(t,"d",(function(){return F})),n.d(t,"C",(function(){return k})),n.d(t,"b",(function(){return L})),n.d(t,"B",(function(){return T}));var r=n("MXaZ"),a=n("lcrw"),i=n("zh0k"),o=n("RVeV"),s=n("NjDY"),c=n("CpcI"),l=n("YxC/"),u=n("IqkD"),d=n("Ae6N"),p=n("RREX"),g=n("Xd5/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const h=String.fromCharCode(41),f=["/","-",".",". "];function m(e){return w(e,"CurrencyDecimalDigits")}function b(e){return w(e,"PricingDecimalPrecision")}function _(e){return w(e,"CurrencySymbol")}function y(e){return w(e,"NumberGroupSeparator")}function v(e){return w(e,"NumberDecimalSeparator")}function S(){return d.a.UserLocal}function O(e){return E(e,"ShortDatePattern","DateSeparator","/")}function C(e){return E(e,"ShortTimePattern","TimeSeparator",":")}function E(e,t,n,r){return e.dateTimeFormat[t].toString().replace(new RegExp(r,"g"),e.dateTimeFormat[n].toString())}function I(e,t){const n=e.dateTimeFormat.DateSeparator;let r=null;r=t.endsWith(n)?t.substring(0,t.length-1):t.concat(n);const a=[t,r],i="\\"+n,o=f.filter(e=>e!==i),s=new RegExp(i,"g");return a.reduce((e,t)=>e.concat(o.map(e=>t.replace(s,e))),[])}function w(e,t){return e.numberFormat[t]}function j(e){switch(e){case 1:return"-{0}";case 2:return"-"+h+"{0}";case 3:return"{0}-";case 4:return"{0}"+h+"-";default:return"({0})"}}function P(e,t,n){return Object(i.b)(e,"N"+(null!=n?n:function(e){return w(e,"NumberDecimalDigits")}(t)),t)}function T(e){const t=e.controlAttributes.Precision,n=e.controlAttributes.PrecisionSource;let r=t;if(n===p.a.organization)r=b(e.cultureInfo);else if(null==r||n===p.a.currency){const t=m(e.cultureInfo);null!=t&&(r=t)}return r}function N(e){return null==e?0:e}function A(e,t){if(null==e||""===e.trim())return null;const n=_(t);return R(e=e.split(n).join(""),function(e){return w(e,"CurrencyGroupSeparator")}(t),function(e){return w(e,"CurrencyDecimalSeparator")}(t))}function D(e,t){return R(e,y(t),v(t))}function R(e,t,n){if(null==e||""===e.trim())return null;const r=e.lastIndexOf(n);let a="";return-1!==r&&(a=e.slice(r),e=e.slice(0,-a.length)),e=e.split(t).join(""),e=(e+=a).split(n).join("."),Number(function(e){const t=e.includes("-")||e.includes("(")&&e.includes(")");e=e.replace(/\(|\)|\-/g,"").trim(),t&&(e="-"+e);return e}(e))}function x(e,t,n,r,a,i){if(null==e||""===e.trim())return null;switch(parseInt(n,10)){case o.a.DURATION:return function(e,t){const n=e.split(" ");if(n.length>=2){const e=Object(l.c)(t,c.c).toLocaleLowerCase(),r=Object(l.c)(t,c.d).toLocaleLowerCase(),a=Object(l.c)(t,c.a).toLocaleLowerCase(),i=Object(l.c)(t,c.b).toLocaleLowerCase();if(!(e&&r&&a&&i))return null;const o=[e,r],s=[a,i],u=n[1].toLocaleLowerCase(),d=parseFloat(n[0].replace(",","."));let p=0;return p=-1!==o.indexOf(u)?60*d:-1!==s.indexOf(u)?60*d*24:d,Math.round(p)}return parseInt(n[0],10)}(e,i);case o.a.TIMEZONE:for(const t in r.timeZoneDefinitionByCode)if(r.timeZoneDefinitionByCode[t].userInterfaceName.toLowerCase()===e.toLowerCase())return r.timeZoneDefinitionByCode[t].timeZoneCode;break;case o.a.LANGUAGE:for(const t in a)if(a[t]&&a[t].toLowerCase()===e.toLowerCase())return parseInt(t,10)}return R(e,y(t),v(t))}function M(e,t){switch(t){case"datetime":case"dateandtime":return O(e)+" "+C(e);case"date":case"dateonly":default:return O(e)}}function F(e){const{formatInfoCultureName:t,numberFormatInfo:n,dateFormatInfo:r}=e;return new Sys.CultureInfo(t,n,r)}function k(e){switch(e.controlAttributes.Type){case"money":case"double":case"decimal":case"float":case"integer":return!0;default:return!1}}function L(e,t,n){let r=null;switch(t.controlAttributes.Type){case"money":r=g.p(e,t);break;case"double":case"decimal":case"float":r=g.l(e,t.controlAttributes.Precision,t.cultureInfo);break;case"datetime":r=g.j(e,t.userSettings,t.cultureInfo,t.controlAttributes.Format,t.controlAttributes.Behavior);break;case"integer":r=g.y(e,t.userSettings,t.cultureInfo,t.controlAttributes.Format,t.languagesByCode,n);break;case"picklist":case"state":case"status":r=g.q(e,t.controlAttributes.OptionSet);break;case"boolean":r=g.e(e,t.controlAttributes.OptionSet);break;case"string":case"lookup":case"memo":r=g.v(e,t.controlAttributes.Format);break;case"multiselectpicklist":r=function(e,t){if(!t)return;if(!e||0===e.length)return;const n=[];for(const r in e){const a=t.filter(t=>null!==t.Value&&void 0!==t.Value&&t.Value===e[r]);a&&a.length>0&&n.push(a[0].Label)}return n.length>0?n.join("; "):void 0}(e,t.controlAttributes.OptionSet);break;default:r=e}return r}function B(e,t,n,a,i){switch(t.controlAttributes.Type){case"money":return A(e,n);case"double":case"decimal":case"float":return D(e,n);case"datetime":return function(e,t,n,a){if(null==e)return null;const i=se(e,t,n,a);switch(a.controlAttributes.Behavior){case d.a.UserLocal:return Object(r.h)(i,a.userSettings.timeZoneUtcOffsetMinutes,a.userSettings.timeZoneAdjusters);case d.a.TimeZoneIndependent:case d.a.DateOnly:return Object(r.g)(i);default:return i}}(e,a,n,t);case"integer":return x(e,n,a,t.userSettings,t.languagesByCode,i);case"string":return null==e?null:e;case"boolean":return function(e,t){if(null==e)return null;if("string"==typeof e){const n=t.filter(t=>t.Label===e);if(1===n.length)return 1===n[0].Value}else{if("number"==typeof e)return 1===e;if("boolean"==typeof e)return e}return null}(e,t.controlAttributes.OptionSet);case"multiselectpicklist":return function(e,t){if(!e||!(null==t?void 0:t.length))return[];const n=e.split("; ");if(!(null==n?void 0:n.length))return[];const r={};return t.forEach(e=>r[e.Label]=e.Value),n.map(e=>r[e])}(e,t.controlAttributes.OptionSet);default:return null}}function U(e,t){if(null!=e){let n=e;if("string"==typeof n&&(n=A(e.toString(),t.cultureInfo)),null!=n&&!isNaN(n))return function(e,t){const n=T(t),r=Object(i.b)(e,"C"+n,t.cultureInfo),a=_(t.cultureInfo);return null!=a?r.replace(_(t.cultureInfo),a):r}(n,t)}}function V(e,t,n){if(null!=e){const r="number"==typeof e?e:D(e.toString(),n);if(null!=r&&!isNaN(r))return X(r,n,t)}}function z(e,t,n,a,i){let o;var s;if("string"==typeof e?o=Object(r.k)(e):e&&(s=e,"[object Date]"===Object.prototype.toString.call(s))&&(o=e),o){const e=null==i?S():i;switch(a&&(a=a.toLowerCase()),a){case"datetime":case"dateandtime":return ne(o,n,e,t.timeZoneUtcOffsetMinutes,t.timeZoneAdjusters);case"date":case"dateonly":default:return $(o,n,e,t.timeZoneUtcOffsetMinutes,t.timeZoneAdjusters)}}}function W(e,t,n,r,a,s){if(null!=e){const u="number"==typeof e?e:x(e.toString(),n,r,t,a,s);if(isNaN(u))return;if(null!=u)switch(parseInt(r,10)){case o.a.DURATION:return function(e,t,n){if(isNaN(e))return null;const r=1e-8;if((e=e>0?e:0)<60){const r=Object(l.c)(n,c.e),a=Object(l.c)(n,c.f);return r&&a?String.format(Object(i.b)(e,"N0",t)+" {0}",1===e?r:a):null}const a=e<1440?e/60:e/1440,o=Math.abs(a%1)<=r||Math.abs(a%1-1)<=r?0:2,s=Object(i.b)(a,"N"+o,t),u=Object(l.c)(n,c.c),d=Object(l.c)(n,c.d),p=Object(l.c)(n,c.a),g=Object(l.c)(n,c.b);if(!(u&&d&&p&&g))return null;return e<1440?String.format(s+" {0}",Math.abs(a-1)<=r?u:d):String.format(s+" {0}",Math.abs(a-1)<=r?p:g)}(u,n,s);case o.a.TIMEZONE:return H(u,t);case o.a.LANGUAGE:return K(u,a);default:return Q(u,n)}}}function q(e,t){if(e&&"string"==typeof e&&e.length)switch(t&&(t=t.toLowerCase()),e=e.trim(),t){case"text":case"textarea":case"email":case"phone":return e;case"url":return new RegExp("^((http|https|ftp|ftps)://)|^(tel:|onenote:)|^/").test(e.toLowerCase())||""===e?e:"https://".concat(e);case"tickersymbol":return e.toLocaleUpperCase();default:return e.toString()}}function H(e,t){const n=t.timeZoneDefinitionByCode[e];return n?n.userInterfaceName:null}function G(e,t){if(!t)return;let n;if("number"!=typeof e){if(n=parseInt(e,10),isNaN(n))return}else n=e;const r=t.filter(e=>null!==e.Value&&void 0!==e.Value&&e.Value===n);return r.length>0?r[0].Label:null}function K(e,t){if(!(isNaN(e)||e<-1))return null===e||t&&t[e]?t[e]:e.toString()}function Q(e,t){return X(e,t,0)}function X(e,t,n){return e<0?function(e,t,n){const r=Math.abs(e);return String.format(j(w(t,"NumberNegativePattern")),P(r,t,n))}(e,t,n):P(e,t,n)}function Y(e,t,n,r,a){const o=function(e,t,n,r){let a=n;if(r===p.a.organization)a=b(t);else if(null==a||r===p.a.currency){const e=m(t);null==a&&(a=e)}return Object(i.b)(e,"C"+a,t)}(e,t,r,a);return null!=n?o.replace(_(t),n):o}function J(e,t){let n=e;if("boolean"==typeof e?n=!0===e?1:0:"number"==typeof e&&(n=e),!t)return;const r=t.filter(e=>e.Value===n);return r.length>0?r[0].Label:void 0}function $(e,t,n,i,o){null==n&&(n=S());const s=Object(r.m)(e,N(i),n,o);return Object(a.a)(s,"d",t)}function Z(e,t,n,i,o){null==n&&(n=S());const s=Object(r.m)(e,N(i),n,o);return Object(a.a)(s,"D",t)}function ee(e,t,n){null==n&&(n=S());return te(e,t,n).split("T")[0]}function te(e,t,n,i,o){const s=Object(r.m)(e,N(i),n,o);return Object(a.a)(s,"s",Sys.CultureInfo.CurrentCulture)}function ne(e,t,n,i,o){null==n&&(n=S());const s=O(t),c=C(t),l=Object(r.m)(e,N(i),n,o);return Object(a.a)(l,s+" "+c,t)}function re(e,t,n,i,o){null==n&&(n=S());const s=Object(r.m)(e,N(i),n,o);let c=function(e){return E(e,"LongDatePattern","DateSeparator","/")}(t);return c=c.replace("MMMM","MMM"),c=c.replace("dddd","ddd"),Object(a.a)(s,c,t)}function ae(e,t,n,i,o){null==n&&(n=S());const s=Object(r.m)(e,N(i),n,o);return Object(a.a)(s,"Y",t)}function ie(e,t,n,r){if(!t)return null;const a=Object(u.w)(e),i=F(a);!function(e,t,n){let r=null;n&&n.reference&&n.reference.id?r=n.reference.id:e&&e.transactionCurrencyId&&(r=e.transactionCurrencyId);if(r&&e&&e.transactionCurrencyById){const n=e.transactionCurrencyById[r.guid];if(n){const e="CurrencySymbol",r="CurrencyDecimalDigits";t.numberFormat[e]=n.currencySymbol,t.numberFormat[r]=n.currencyPrecision}}}(a,i,n);const o={Type:t.Type,Precision:t.Precision,PrecisionSource:t.PrecisionSource,Format:t.Format,Behavior:t.Behavior,OptionSet:t.OptionSet};if(o.PrecisionSource===p.a.organization){const t=Object(s.x)(e),n="PricingDecimalPrecision";i.numberFormat[n]=t.pricingDecimalPrecision}return{controlAttributes:o,userSettings:a,cultureInfo:i,languagesByCode:Object(s.g)(e),fieldValueContext:{rawValue:r}}}function oe(e){return m(F(e))}function se(e,t,n,r){const i=function(e,t){const n=[];let r=t;r&&(r=r.toLowerCase());let a=M(e,r);a=a?a.trim():a;let i=null;"date"===r?i="datetime":"datetime"===r&&(i="date");let o=M(e,i);return o=o?o.trim():o,n.push(a,o),"date"===r?n.push(...I(e,a)):"date"===i&&n.push(...I(e,o)),n}(n,t);for(let t=0;t<i.length;t++){const n=Object(a.b)(e,i[t],r.cultureInfo);if(n)return ce(n,r)}return null}function ce(e,t){var n;let a=e;const i=null===(n=null==t?void 0:t.fieldValueContext)||void 0===n?void 0:n.rawValue;if(null!=i&&i.getFullYear){const t=i.getFullYear()-e.getFullYear();if(Math.abs(t)>1){const n=10*Math.floor(t/10),i=n+10,o=t-n>i-t?i:n;a=Object(r.f)(e,o)}}return a}function le(e,t,n,r,i){const o=O(i),s=C(i),c=Object(a.a)(e,s,i);if(function(e){return ue(e,new Date)}(e))return t.replace("{0}",c);if(function(e){const t=new Date,n=new Date(t.setDate(t.getDate()-1));return ue(e,n)}(e))return n.replace("{0}",c);const l=Object(a.a)(e,o,i);return r.replace("{0}",l).replace("{1}",c)}function ue(e,t){return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}},Xe7f:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");class a extends r.a{constructor(e,t,n,r,a,i){super(),this._target=null,this._suppressDuplicateDetection=!1,this._calculateMatchCodeSynchronously=!1,this._solutionUniqueName=null,this._maintainLegacyAppServerBehavior=!1,this._returnRowVersion=!1,this._target=e,this._suppressDuplicateDetection=t,this._calculateMatchCodeSynchronously=n,this._solutionUniqueName=r,this._maintainLegacyAppServerBehavior=a,this._returnRowVersion=i}get_name(){return"Create"}get_xmlNamespace(){return"http://schemas.microsoft.com/xrm/2011/Contracts"}get_target(){return this._target}get_suppressDuplicateDetection(){return this._suppressDuplicateDetection}get_calculateMatchCodeSynchronously(){return this._calculateMatchCodeSynchronously}get_solutionUniqueName(){return this._solutionUniqueName}get_maintainLegacyAppServerBehavior(){return this._maintainLegacyAppServerBehavior}get_returnRowVersion(){return this._returnRowVersion}set_returnRowVersion(e){return this._returnRowVersion=e,e}}},XgcG:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("nxt5");class a extends r.a{constructor(e,t){super("ExecuteMultiple"),this._isFaulted=!1,this._responses=null,this._isFaulted=e,this._responses=t}get_isFaulted(){return this._isFaulted}get_responses(){return this._responses}}},Xi8U:function(e,t,n){"use strict";n.d(t,"h",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"k",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"j",(function(){return p})),n.d(t,"e",(function(){return g})),n.d(t,"l",(function(){return h})),n.d(t,"d",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return b})),n.d(t,"i",(function(){return l})),n.d(t,"b",(function(){return d}));var r=n("X37l"),a=n("GWSs"),i=n("iZ7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e){return e.recentItems?e.recentItems.recentItems:[]}function s(e){return e.recentItems.recentItems.filter(e=>!0===e.PinStatus).sort((e,t)=>t.LastAccessed-e.LastAccessed)}function c(e){return e.recentItems.recentItems.filter(e=>!e.PinStatus).sort((e,t)=>t.LastAccessed-e.LastAccessed)}function l(e,t=[]){const n=t.filter(e=>e.RecordType===r.a.Entity).map(t=>{const n=Object(i.j)(e,t.EntityTypeName,t.ObjectId);if(null==n)return null;return{type:"Subarea",id:t.ObjectId.toString(),iconPath:n}}).filter(Boolean);return Array.from(new Set(n))}function u(e){const{lastSynced:t,recentItems:n}=e.recentItems;return null==t?n:n.filter(e=>e.LastAccessed>t)}function d(e){return e.recentItems.deletedRecentItems}function p(e){return e.recentItems.lastSynced}function g(e,t){const n=e.recentItems.recentItems.filter(e=>e.EntityTypeName===t&&e.RecordType===r.a.Entity).sort((e,t)=>t.LastAccessed-e.LastAccessed);return n.length>3?n.slice(0,3):n}function h(e,t){return e.recentItems.recentItems.some(e=>e.EntityTypeName===t&&e.RecordType===r.a.Entity)}function f(e){return e.recentItems.flyoutRecentsDescriptor}function m(e){return e.recentItems.dropdownRecentsDescriptor}const b=function(){const e={};return(t,n)=>{if(e[n])return e[n];const r=Object(a.k)(t);if(!r)return null;for(const t of r.AreaIds){const a=r.Areas[t];for(const t of a.GroupIds){const r=a.Groups[t];for(const t of r.SubAreaIds){const a=r.SubAreas[t];if(a.Entity===n)return e[n]=a.VectorIcon,a.VectorIcon}}}return null}}()},XjOj:function(e,t,n){"use strict";n.d(t,"c",(function(){return B})),n.d(t,"m",(function(){return U})),n.d(t,"b",(function(){return V})),n.d(t,"l",(function(){return z})),n.d(t,"e",(function(){return W})),n.d(t,"d",(function(){return q})),n.d(t,"j",(function(){return H})),n.d(t,"f",(function(){return G})),n.d(t,"g",(function(){return K})),n.d(t,"i",(function(){return Q})),n.d(t,"a",(function(){return X})),n.d(t,"k",(function(){return Y})),n.d(t,"h",(function(){return ae}));var r=n("Ydwo");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var a=n("504W"),i=n("Div0"),o=n("2mBq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class s{constructor(e,t,n,r,a,o,c,l,u,d,p,g,h,f,m){this._data={},this._message=null,this._setValue(s._logLevelKey,e);const b=i.a[t];!b&&H(i.a.framework,"TraceComponent not found. Component: "+t),this._setValue(s._sourceKey,b),n&&(this._setValue(s._stackTraceKey,n),this._setValue(s._stackTraceHashKey,r)),a&&this._setValue(s._exceptionMessageKey,a),o&&(this._setValue(s._exceptionStackTraceKey,o),this._setValue(s._exceptionStackTraceHashKey,c)),l&&this._setValue(s._clientInfoKey,l),u&&this._setValue(s._formatKey,u);this._SetTrucatedValue(s._arg0Key,d,2500),this._SetTrucatedValue(s._arg1Key,p,2500),this._SetTrucatedValue(s._arg2Key,g,2500),this._SetTrucatedValue(s._arg3Key,h,2500),this._SetTrucatedValue(s._arg4Key,f,2500),this._SetTrucatedValue(s._arg5Key,m,2500)}getValue(e){return this._data[e]}_setValue(e,t){this._assertKeyValue(t),this._data[e]=t}_assertKeyValue(e){if(Object(a.a)(e))H(i.a.framework,"Cannot set a key value to null/undefined");else{const t=typeof e;"function"===t&&H(i.a.framework,"Cannot set a key to value with type "+t)}}get_sourceKeyIdentifier(){return s._sourceKey}get_exceptionMessageKeyIdentifier(){return s._exceptionMessageKey}get_stackTraceKeyIdentifier(){return s._stackTraceKey}get_exceptionStackTraceKeyIdentifier(){return s._exceptionStackTraceKey}get_message(){if(!this._message){let e=Object(o.a)(this.getValue(s._formatKey),this.getValue(s._arg0Key),this.getValue(s._arg1Key),this.getValue(s._arg2Key),this.getValue(s._arg3Key),this.getValue(s._arg4Key),this.getValue(s._arg5Key));Object(a.a)(this.getValue(s._exceptionMessageKey))||(e+=Object(o.a)("{0}Exception message:{1}{0}Exception stack trace:{0}{2}Exception stack trace hash: {3}","\r\n",this.getValue(s._exceptionMessageKey),this.getValue(s._exceptionStackTraceKey),this.getValue(s._exceptionStackTraceHashKey))),Object(a.a)(this.getValue(s._stackTraceKey))||(e+=Object(o.a)("{0}{1}Call stack hash: {2}","\r\n",this.getValue(s._stackTraceKey),this.getValue(s._stackTraceHashKey)));const t=this.getValue(s._sourceKey);this._message=t?"["+t+"] "+e:e}return this._message}_SetTrucatedValue(e,t,n){let r=null;Object(a.a)(t)||(r=t.toString(),r&&this._setValue(e,r.length>n?r.substr(0,n):r))}}s._logLevelKey="l",s._sourceKey="s",s._formatKey="f",s._arg0Key="0",s._arg1Key="1",s._arg2Key="2",s._arg3Key="3",s._arg4Key="4",s._arg5Key="5",s._stackTraceKey="st",s._stackTraceHashKey="h",s._exceptionMessageKey="em",s._exceptionStackTraceKey="est",s._exceptionStackTraceHashKey="eh",s._clientInfoKey="ci";var c=n("pNM1"),l=n("cxnf");class u{getExceptionStackTrace(e,t){return u.internalGetStackTrace(e,0,t)}getStackTrace(e,t){const n=new Error;return u.internalGetStackTrace(n,e,t)}static get_clientInfo(){return u._clientInfo||(u._clientInfo=u._getClientInfo()),u._clientInfo}static internalGetStackTrace(e,t,n){if(n.val=0,Object(a.a)(e))return"GenericBrowserErrorHandler.InternalGetStackTrace: Extended error information not available from this browser.";const r=e.stack;if(Object(a.a)(r))return"GenericBrowserErrorHandler.InternalGetStackTrace: Exception stack trace not available from this browser.";const i=r.split("\n");"Error"===i[0]&&(t+=1),n.val=0;let s="";for(let e=t;e<i.length;e++){const t=i[e];if(""===t)continue;const r=u._getFunctionName(t),a=Object(o.b)(r);n.val^=a,s+=t+"\r\n"}return s}static _getFunctionName(e){e.startsWith("    at ")&&(e=e.substr("    at ".length));e.startsWith("Function.")&&(e=e.substr("Function.".length));const t=e.indexOf("("),n=e.indexOf(" ");let r;if(-1===t&&-1===n)return u.anonymousFunctionName;r=t>0&&n>0?Math.min(t,n):Math.max(t,n);const a=e.substring(0,r),i=a.indexOf("$",0);if(-1===i)return u.anonymousFunctionName;const o=a.indexOf("$",i+1);if(-1===o)return a;const s=a.indexOf("$",o+1);return-1===s?a:a.substring(o+1,s-i)}static _getClientInfo(){const e=window.navigator;return{"CPU Class":e.cpuClass,Platform:window.navigator.platform,"Browser language":e.browserLanguage||window.navigator.language,"Cookie enabled":window.navigator.cookieEnabled,"User agent":window.navigator.userAgent,"Document.Cookie":window.document.cookie}}}u.anonymousFunctionName="anonymous",u._clientInfo=null;class d extends u{getStackTrace(e,t){try{throw Error.create()}catch(n){return u.internalGetStackTrace(n,e,t)}}}let p=null;function g(){return p||(p=(new Error).stack?new u:new d),p}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let h=c.a.Warning,f=!0,m=null,b=null,_=null,y=null,v=null,S=null,O=null,C=null,E=null,I=null,w=null;const j=[];let P=0,T=0,N=null,A=null,D=null,R=null,x=null,M=null,F=null,k=null,L=null;function B(){return h}function U(e){return h=e,oe(h),e}function V(){return f}function z(e){return f=e,oe(e?h:0),e}let W=function(e,t,n,r,a,i,o,s,l){s=s,ne(e,c.a.Error,t,n,r,a,i,o,s,l)},q=function(e,t,n,r,a,i,o,s){o=o,ne(e,c.a.Error,null,t,n,r,a,i,o,s)},H=function(e,t,n,r,a,i,o,s){ne(e,c.a.Warning,null,t,n,r,a,i,o,s)},G=function(e,t,n,r,a,i,o,s){ne(e,c.a.Info,null,t,n,r,a,i,o,s)},K=function(e,t,n,r,a,i,o,s){ne(e,c.a.Perf,null,t,n,r,a,i,o,s)},Q=function(e,t,n,r,a,i,o,s){ne(e,c.a.Verbose,null,t,n,r,a,i,o,s)};function X(e){j.indexOf(e)<0&&j.push(e)}function Y(e){const t=j.indexOf(e);t>=0&&j.splice(t,1)}function J(){}let $=function(){},Z=function(){},ee=function(){},te=function(){};function ne(e,t,n,r,a,i,o,s,c,l){re(e,t,n,r,a,i,o,s,c,l),V()&&function(e,t,n){for(let r=0;r<j.length;r++){(0,j[r])(e,t,n)}}(e,t,ie)}function re(e,t,n,r,a,i,o,s,c,l){N=null,T=e,P=t,A=n,D=r,R=a,x=i,M=o,F=s,k=c,L=l}function ae(e,t){re(i.a.telemetry,e,null,t)}function ie(){if(!N){const e=new Sys.StringBuilder;let t=-1,n=null,i=-1,o=null,l=null;if(P===c.a.Error){const a=5;n=g().getStackTrace(a,Object(r.a)(()=>t,e=>t=e));const i=u.get_clientInfo();for(const t in i){const n={key:t,value:i[t]};e.append(String.format("{0} = {1}{2}",n.key,n.value,"\r\n"))}}Object(a.a)(A)||(o=g().getExceptionStackTrace(A,Object(r.a)(()=>i,e=>i=e)),l=A.message),N=new s(P,T,n,t,l,o,i,e.toString(),D,R,x,M,F,k,L)}return N}function oe(e){y||(y=q,v=W,m=H,S=K,b=G,_=Q,O=J,C=$,E=Z,I=ee,w=te),e<c.a.Error?(q=O,W=O):(q=y,W=v),H=e<c.a.Warning?O:m,K=e<c.a.Perf?O:S,G=e<c.a.Info?O:b,e<c.a.Verbose?(Q=O,$=O,Z=O,ee=O,te=O):(Q=_,$=C,Z=E,ee=I,te=w)}Object(l.f)(!0)},XlXz:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"h",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return u}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="execute.addsessiontab",a="execute.closesessiontab",i="execute.updatesessiontab",o="execute.closeallsessiontabs",s="execute.dismissmessage",c="execute.markactivetab",l="execute.initializereferencepanelcontrol",u="execute.cleanreferencepanelstate"},XosO:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10),this.low<0&&(this.high=-1)}return e.prototype._Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high},e}();t.Int64=r;var a=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10)}return e.prototype._Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high},e}();t.UInt64=a;var i=function(){function e(){}return e._ToByte=function(e){return this._ToUInt8(e)},e._ToUInt8=function(e){return 255&e},e._ToInt32=function(e){return 2147483647&e|2147483648&e},e._ToUInt32=function(e){return 4294967295&e},e}();t.Number=i},XvL5:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("2F73");class a{constructor(e){this._columns=null,this._columns=e}get_Columns(){return this._columns}get_isEmpty(){return!(this._columns.length>0)}getObjectData(){const e={};return e.columns=this._columns,e}getDifference(e){if(e instanceof r.a)return e;const t=e.get_Columns().filter(e=>this.get_Columns().indexOf(e)<0);return new a(t)}static createFromObjectData(e){return new a(e.columns)}}},XvLr:function(e,t,n){"use strict";n.r(t),n.d(t,"SYSTEM_VIEWS_LABEL_ID",(function(){return a})),n.d(t,"USER_VIEWS_LABEL_ID",(function(){return i})),n.d(t,"SEE_MORE_DETAILS",(function(){return C})),n.d(t,"GRID_LOADING_PLACEHOLDER",(function(){return E})),n.d(t,"JUMPBAR_ALL_TITLE",(function(){return o})),n.d(t,"JUMPBAR_ALL",(function(){return s})),n.d(t,"ACTIVITYTYPE_SELECTALL",(function(){return O})),n.d(t,"JUMPBAR_NUMBER_TOOLTIP",(function(){return c})),n.d(t,"JUMPBAR_NUMBER_INDICATOR",(function(){return l})),n.d(t,"JUMPBAR_ALPHABET",(function(){return u})),n.d(t,"JUMPBAR_LETTER_TITLE",(function(){return d})),n.d(t,"SELECTEDFILTER_TEXT",(function(){return k})),n.d(t,"FILTERBY_ARIALABEL",(function(){return L})),n.d(t,"NUMBER_ARIALABEL",(function(){return B})),n.d(t,"JUMPBAR_ARIALABEL",(function(){return F})),n.d(t,"CLOSE_JUMPBAR_ARIALABEL",(function(){return U})),n.d(t,"QUICK_FIND_VIEWS_LABEL_ID",(function(){return V})),n.d(t,"ROLLUPVIEW_SWITCH_ON",(function(){return b})),n.d(t,"ROLLUPVIEW_SWITCH_OFF",(function(){return _})),n.d(t,"ROLLUPVIEW_SWITCH_LABEL",(function(){return y})),n.d(t,"ACTIVITY_DUE_DATE_FILTER_LABEL",(function(){return g})),n.d(t,"ACTIVITY_MGMT_DUE_DATE_LABEL",(function(){return v})),n.d(t,"ACTIVITY_MGMT_ACTIVITY_TYPE_LABEL",(function(){return S})),n.d(t,"CREATE_VIEW_LABEL",(function(){return Z})),n.d(t,"CREATE_VIEW_TOOLTIP_TITLE",(function(){return ee})),n.d(t,"CREATE_VIEW_TOOLTIP_DESCRIPTION",(function(){return te})),n.d(t,"QUEUE_FILTER_LABEL",(function(){return h})),n.d(t,"QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT",(function(){return q})),n.d(t,"QUICK_FIND_TOOLTIP_CLEAR_BUTTON",(function(){return W})),n.d(t,"QUICK_FIND_TOOLTIP_APPLY_BUTTON",(function(){return z})),n.d(t,"QUICK_FIND_COMMANDBAR_TEXT",(function(){return H})),n.d(t,"QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT_SEARCH_THIS_VIEW",(function(){return G})),n.d(t,"QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT_QUICK_FIND_VIEW",(function(){return K})),n.d(t,"QUICK_FIND_CANCEL_LABEL_ID",(function(){return Q})),n.d(t,"VIEWSELECTOR_TOOLTIP",(function(){return X})),n.d(t,"VIEWSELECTOR_DEFAULTVIEW",(function(){return Y})),n.d(t,"VIEWSELECTOR_SETDEFAULTVIEW",(function(){return J})),n.d(t,"VIEWSELECTOR_NEWVIEW",(function(){return $})),n.d(t,"X_RECORDS_PRESENT",(function(){return se})),n.d(t,"NO_DATA_AVAILABLE",(function(){return ce})),n.d(t,"CHARTS_HIDE_CHART_PANE_LABEL",(function(){return le})),n.d(t,"CHARTS_SHOW_CHART_PANE_LABEL",(function(){return ue})),n.d(t,"UCI_DISABLED_ENTITY_ERROR",(function(){return T})),n.d(t,"VIEW_NOTAVAILABLE_IN_OFFLINE",(function(){return N})),n.d(t,"ENTITY_NOT_AVAILABLE_IN_PROFILE",(function(){return R})),n.d(t,"OFFLINE_NOT_READY_FOR_USE",(function(){return D})),n.d(t,"SQL_QUERY_NOT_AVAILABLE",(function(){return A})),n.d(t,"LINKED_ENTITY_NOT_SUPPORTED",(function(){return x})),n.d(t,"ACTIVITY_ENTITY_NOT_SUPPORTED_OFFLINE",(function(){return M})),n.d(t,"GRID_CONTROL_LOAD_ERROR",(function(){return P})),n.d(t,"READ_PRIVILEGE_VIOLATION_KEY",(function(){return j})),n.d(t,"OPEN_ENTITY_DASHBOARDS",(function(){return de})),n.d(t,"SEE_MORE_TOOL_TIP",(function(){return p})),n.d(t,"SEE_MORE_LABEL",(function(){return m})),n.d(t,"SWITCH_VISUALIZATION_BUTTON_LABEL",(function(){return pe})),n.d(t,"DEFAULT_LABEL",(function(){return ge})),n.d(t,"labelList",(function(){return ye})),n.d(t,"CRM_SAVE_TO_CURRENT_VIEW_TITLE",(function(){return ie})),n.d(t,"CRM_FILTER_SAVED",(function(){return oe})),n.d(t,"CRM_SAVE_TO_CURRENT_VIEW",(function(){return ae})),n.d(t,"CRM_SAVE_AS_NEW_VIEW",(function(){return ne})),n.d(t,"CRM_SAVE_AS_NEW_VIEW_TITLE",(function(){return re})),n.d(t,"GRID_FILTER_LABEL",(function(){return f})),n.d(t,"AdvancedFind_DiscardButton_Title",(function(){return he})),n.d(t,"AdvancedFilter_DiscardButton_AccessibilityLabel",(function(){return fe})),n.d(t,"ColumnEditorButton",(function(){return me})),n.d(t,"SEE_ALL_TOOL_TIP",(function(){return I})),n.d(t,"SEE_ALL_LABEL",(function(){return w})),n.d(t,"COLUMNEDITOR_SAVE_AS_NEW_VIEW",(function(){return be})),n.d(t,"COLUMNEDITOR_SAVE_CHANGES_TO_CURRENT_VIEW",(function(){return _e}));var r=n("kKLx");n.d(t,"errorsLabelList",(function(){return r.c}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="CRM_System_View_Group_Name",i="CRM_User_View_Group_Name",o="Grid_Title_JumpBar_All",s="Grid_Selection_JumpBar_All",c="Grid_JumpBar_Number_ToolTip",l="Grid_JumpBar_Number_Indicator",u="Grid_JumpBar_Alphabet",d="Grid_Title_JumpBar_Letter",p="Grid_See_More_Tool_Tip",g="Web.View_Label_ViewByDate",h="Workplace_Queue_Selector_Title",f="Grid_Filter_Label_Filter",m="Grid_See_More_Label_Text",b="RollupView_Switch_On",_="RollupView_Switch_Off",y="RollupView_Switch_Label",v="ActivityMgmt_Label_ViewByDate",S="ActivityMgmt_Label_ViewByActivityType",O="GridFilters_SelectAll",C="Error_See_More_Details_Grid",E="Grid_Loading_Placeholder",I="Grid_See_All_Tool_Tip",w="Grid_See_All_Label_Text",j="Error_Message_0x80040226",P="Grid_Generic_Unknown_Error",T="Error.NonUCIEntity",N="View_NotAvailable_In_Offline",A="Sql_Query_Not_Available",D="Offline_Not_Ready_For_Usage",R="Entity_Not_Available_In_Profile",x="Linked_Entity_Not_Supported_In_Offline",M="Activity_Entity_Not_Supported_In_Offline",F="Jump Bar",k="Selected filter",L="Filter table by {0}",B="Number 0 to 9",U="Close Jump Bar",V="AdvancedFindSearchResultsViewName",z="Button_ToolTip_Go",W="Button_ToolTip_Clear",q="Field_Label_Find",H="Search_Label_Search",G="Field_Label_Search_This_View",K="Field_Label_Search_Quick_Find_View",Q="Button_Label_Cancel",X="View_Title_Tooltip",Y="OnDefaultViewToolTip",J="SetDefaultViewToolTip",$="NewView",Z="CRM_Create_View",ee="CRM_Create_View_Tooltip_Title",te="CRM_Create_View_Tooltip_Description",ne="CRM_Save_As_New_View",re="CRM_Save_As_New_View",ae="CRM_Save_To_Current_View",ie="CRM_Save_To_Current_View",oe="GridFilters_SaveMessage",se="{0} records found",ce="L_List_No_Records_Text",le="ttv_homepage_button_hideChart",ue="ttv_homepage_button_showChart",de="Display_Entity_dashboard",pe="MobileClient.Commands.ChangeControl",ge="FormEditor_Default_Tab",he="Grid_AdvancedFilter_DiscardButton_Title",fe="Grid_AdvancedFilter_DiscardButton_AccessibilityLabel",me="Grid_AdvancedFilter_ColumnEditor_ColumnEditor",be="Grid_AdvancedFilter_ColumnEditor_SaveAsNewView",_e="Grid_AdvancedFilter_ColumnEditor_SaveChangesToCurrentView",ye=[a,i,o,c,C,E,T,N,A,R,x,M,l,s,O,u,d,V,b,_,y,g,v,S,Z,ee,te,h,q,G,K,W,z,H,Q,X,Y,J,$,ce,le,ue,j,de,P,p,m,pe,ge,ne,ae,oe,f,he,fe,me,w,I,be,_e,...r.c]},Y2Yg:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.ReadAccess=1]="ReadAccess",e[e.WriteAccess=2]="WriteAccess",e[e.AppendAccess=4]="AppendAccess",e[e.AppendToAccess=16]="AppendToAccess",e[e.CreateAccess=32]="CreateAccess",e[e.DeleteAccess=65536]="DeleteAccess",e[e.ShareAccess=262144]="ShareAccess",e[e.AssignAccess=524288]="AssignAccess"}(r||(r={}))},YIt1:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.And=0]="And",e[e.Or=1]="Or",e[e.Not=2]="Not"}(r||(r={}))},YMsD:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t="";for(var n in e){var r=e[n];"string"!=typeof r&&"number"!=typeof r||(t&&(t+=";"),t+=(0,i.default)(n,r))}return t};var r,a=n("YgRo"),i=(r=a)&&r.__esModule?r:{default:r};e.exports=t.default},YPXd:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l}));let r,a=!1;function i(){window.addOnAppLoad=o}function o(e){if(e){if(a)throw new Error("addOnAppLoad should only be called before UCI Boot");if(r)throw new Error("addOnAppLoad should only be called once");if("object"==typeof e)r=e;else{if("string"!=typeof e)throw new Error("Received unexpected input");r={loadHandler:{webResourceName:arguments[0],initFunctionName:arguments[1]}}}}}function s(){a=!0}function c(e){const t=e.TraceManager.getTracer("EmbeddedApi");if(!r)try{r=JSON.parse(window.HOST_CONTEXT.getHostOptions()),t.info(`HostOption accquired from window object, value: '${window.HOST_CONTEXT.getHostOptions()}'`)}catch(e){t.warn(`HostOption not available from window object: '${e.message}'`)}return r}function l(e){r=c(e);const t=e.TraceManager.getTracer("EmbeddedApi");if(!r)try{const e=window.localStorage.getItem("UCISessionID");r=e?{externalCorrelationId:e}:void 0,t.info(`HostOption accquired from localStorage, value: '${JSON.stringify(r)}'`)}catch(e){t.error(`Local storage is not accessible: '${e.message}'`)}return r}},YQTs:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("4or6"),a=function(){function e(e,t){this._outboundQueue=e,this._maxNumberOfEvents=t,this._currentBatch={},this._currentNumEventsInBatch=0}return e.prototype.addEventToBatch=function(e){if(e.priority===r.AWTEventPriority.Immediate_sync){var t={};return t[e.apiKey]=[e],t}return this._currentNumEventsInBatch>=this._maxNumberOfEvents&&this.flushBatch(),void 0===this._currentBatch[e.apiKey]&&(this._currentBatch[e.apiKey]=[]),this._currentBatch[e.apiKey].push(e),this._currentNumEventsInBatch++,null},e.prototype.flushBatch=function(){this._currentNumEventsInBatch>0&&(this._outboundQueue.push(this._currentBatch),this._currentBatch={},this._currentNumEventsInBatch=0)},e.prototype.hasBatch=function(){return this._currentNumEventsInBatch>0},e}();t.default=a},YVjE:function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"d",(function(){return I})),n.d(t,"c",(function(){return C})),n.d(t,"b",(function(){return E}));var r=n("3bZx"),a=n("DRVD"),i=n.n(a),o=n("iDqy"),s=n.n(o),c=n("SZCI"),l=n("4N6w"),u=n("zsAz"),d=n("V6aM"),p=n("UwOy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function g(e){return!!Object(l.a)(e)}const h=/^\/_static\//i,f=i.a.createEvent("LoadScript",c.a),m=i.a.createEvent("LoadStylesheet",c.a),b=i.a.createEvent("LoadRawData",c.a),_=i.a.createEvent("LoadOfflineWebResource",c.a),y=i.a.createEvent("LoadJavaScript",c.a),v=i.a.createEvent("LoadRawStyle",c.a);class S{constructor(e=document,t,n){this._scriptChain=Promise.resolve(),this._jsLoadingPromises={},this._cssLoadingPromises={},this._rawDataPromises={},this._offlineWebResourcePromises={},this._loadedDocuments={},this._targetDocument=e,this._rawDataCache=new r.a,this._scanForLoadedJsFiles(),this._store=n,this._tracer=t&&t.TraceManager.getTracer(S.ASSETLOADER_TRACER_CATEGORY)}loadScriptSync_DO_NOT_USE(e){if(this.isResourceLoaded(e))return;this._jsLoadingPromises[e]&&this._tracer.warn("Sync load of already loading file",[{name:"filename",value:e}]);const t=new XMLHttpRequest;if(t.open("GET",e,!1),t.send(null),200!==t.status){const n="Failed to load script sync";throw this._tracer.error(n,[{name:"status",value:t.status},{name:"file",value:e}]),new Error(n)}{const n=this._targetDocument.createElement("script");n.type="text/javascript",n.innerHTML=t.responseText+"\n//# sourceURL="+e,this._targetDocument.body.appendChild(n),this._jsLoadingPromises[e]=Promise.resolve(),this._loadedDocuments[e]=!0}}loadScript(e,t={}){const n=Object.assign({async:!0,crossOrigin:"anonymous",forceCrossOrigin:!1},t);if(I(e)){const t=[{name:"filePath",value:e}];return this._tracer&&this._tracer.warn("AssetLoader does not support loading static files.",t),Promise.resolve()}if(!this._jsLoadingPromises[e]){const r=s.a.trackWork("loadScript"),a=f.startStopwatch({filename:e,options:JSON.stringify(t)});if(0===e.indexOf("/uclient/scripts/")||!g(this._store.getState())&&!Object(p.d)(this._store.getState())||!/^\/[^\/]/.test(e)&&0!==e.indexOf(window.location.origin)){let t;const r=async a=>{try{if(2===a){const t=await this.loadRawData(e);this.loadRawJavaScript(t,e)}else await function(e,t,n){return new Promise((r,a)=>{const i=e.createElement("script");i.addEventListener("load",()=>r()),i.addEventListener("error",t=>{a(t),e.body.removeChild(i)}),i.type="text/javascript",i.src=t,i.async=n.async,!n.forceCrossOrigin&&i.src.startsWith(e.location.origin+"/")||(i.crossOrigin=n.crossOrigin),e.body.appendChild(i)})}(this._targetDocument,e,n)}catch(n){if(0===a)t=JSON.stringify(n,["type","message","filename","lineno","colno","error"]),this._tracer.warn("LoadScript call failed on attempt 1",[{name:"filename",value:e}]),await r(1);else{if(1!==a){const r=Object(u.d)("The script "+e+" didn't load correctly.");throw Object(u.b)(r,[{name:"ErrorEvent",value:JSON.stringify({Attempt1:t,Attempt2:null==n?void 0:n.message})}]),r}this._tracer.warn("LoadScript call failed on attempt 2",[{name:"filename",value:e}]),await r(2)}}};this._jsLoadingPromises[e]=r(0)}else this._jsLoadingPromises[e]=n.async?O(e,Object(l.a)(this._store.getState())):Promise.all([this._scriptChain,O(e,Object(l.a)(this._store.getState()))]),this._jsLoadingPromises[e]=this._jsLoadingPromises[e].then(t=>{const r=n.async?t:t[1],a=this._targetDocument.createElement("script");a.type="text/javascript",a.innerHTML=r+"\n//# sourceURL="+e,this._targetDocument.body.appendChild(a)}),n.async||(this._scriptChain=this._jsLoadingPromises[e]);const i=t=>{a(),r(),this._loadedDocuments[e]=t};this._jsLoadingPromises[e].then(()=>i(!0),()=>i(!1))}return this._jsLoadingPromises[e]}loadStylesheet(e,t=""){if(!this._cssLoadingPromises[e]){const n=s.a.trackWork("loadStylesheet"),r=m.startStopwatch({filename:e});if(!g(this._store.getState())&&!Object(p.d)(this._store.getState())||!/^\/[^\/]/.test(e)&&0!==e.indexOf(window.location.origin))this._cssLoadingPromises[e]=new Promise((n,r)=>{const a=this._targetDocument.createElement("link");a.onload=()=>{n()},a.onerror&&(a.onerror=function(e){const t=Object(u.d)("The stylesheet "+this.href+" didn't load correctly.");Object(u.b)(t,[{name:"ErrorEvent",value:JSON.stringify(e)}]),r(t)}),a.href=e+t,a.rel="stylesheet",a.type="text/css",this._targetDocument.body.appendChild(a)});else{let t;this._cssLoadingPromises[e]=new Promise(n=>{t=this._targetDocument.createElement("style"),this._targetDocument.body.appendChild(t),n(O(e,Object(l.a)(this._store.getState())))}).then(e=>{t.innerHTML=e}),this._cssLoadingPromises[e].catch(()=>{this._targetDocument.body.removeChild(t)})}const a=()=>{r(),n(),this._loadedDocuments[e]=!0},i=()=>{r(),n(),this._loadedDocuments[e]=!1};this._cssLoadingPromises[e].then(a,i)}return this._cssLoadingPromises[e]}loadScripts(e,t){return Promise.all(e.map(e=>this.loadScript(e,t)))}loadRawData(e){if(!this._rawDataPromises[e]){const t=s.a.trackWork("loadRawData"),n=b.startStopwatch({filepath:e}),r=this._rawDataCache;this._rawDataPromises[e]=new Promise((t,n)=>{const a=r.getItem(e);if(a)t(a);else{const a=new XMLHttpRequest;a.open("GET",e),a.responseType="arraybuffer",a.onload=function(){if(a.status>=200&&a.status<300){r.setItem(e,a.response);const n=function(e){const t=new Uint8Array(e);let n=t.length;const r=new Array(n);for(;n--;)r[n]=String.fromCharCode(t[n]);const a=r.join("");return window.btoa(a)}(a.response);t(n)}else n(new Error(`Failed to load ${e} (${a.statusText})`))},a.onerror=function(t){n(Object(u.d)("Failed to load script",void 0,[{name:"filepath",value:e}]))},a.send()}}),this._rawDataPromises[e].then(()=>{n(),t()},()=>{n(),t()})}return this._rawDataPromises[e]}loadOfflineWebResource(e){if(!this._offlineWebResourcePromises[e]){const t=s.a.trackWork("loadOfflineWebResource"),n=_.startStopwatch({webResourceName:e});this._offlineWebResourcePromises[e]=this._store.dispatch(Object(d.a)(e)),this._offlineWebResourcePromises[e].then(()=>{n(),t()},()=>{n(),t()})}return this._offlineWebResourcePromises[e]}loadRawJavaScript(e,t=""){const n=s.a.trackWork("loadRawJavaScript"),r=y.startStopwatch({name:t}),a=this._targetDocument.createElement("script");a.innerHTML=e,this._targetDocument.body.appendChild(a),r(),n()}loadRawStylesheet(e,t=""){const n=s.a.trackWork("loadRawStylesheet"),r=v.startStopwatch({name:t}),a=this._targetDocument.createElement("style");a.type="text/css",a.innerHTML=e,this._targetDocument.body.appendChild(a),r(),n()}loadWebResource(e,t,n,r,a,i=!0){if(a){if(3===n&&this._jsLoadingPromises[t+e])return this._jsLoadingPromises[t+e];if(2===n&&this._cssLoadingPromises[t+e])return this._cssLoadingPromises[t+e];const a=r(e).then(r=>{if(null==r)throw new Error(`Content of webresource was empty (${e})`);switch(n){case 2:this.loadRawStylesheet(r,e),this._loadedDocuments[t+e]=!0;break;case 3:default:this.loadRawJavaScript(r,e),this._loadedDocuments[t+e]=!0}});return 3===n?this._jsLoadingPromises[t+e]=a:2===n&&(this._cssLoadingPromises[t+e]=a),a}switch(n){case 2:return this.loadStylesheet(t+e);case 3:default:const n=I(e)?e:t+e;return this.loadScript(n,{async:i})}}isResourceLoaded(e){return this._loadedDocuments.hasOwnProperty(e)&&this._loadedDocuments[e]}_scanForLoadedJsFiles(){const e=this._targetDocument.getElementsByTagName("script"),t=Promise.resolve();for(let n=0;n<e.length;n++){const r=e[n];if(r.src){const e=r.src,n=e.substr(e.indexOf("/uclient/scripts/")+"/uclient/scripts/".length).split("?")[0];this._jsLoadingPromises[n]||(this._jsLoadingPromises[n]=t)}}}}function O(e,t){return new Promise((n,r)=>{const a=new XMLHttpRequest;function i(){r(new Error(`Failed to load ${e} (${a.statusText})`))}a.addEventListener("load",(function(){200===a.status?n(a.responseText):i()})),a.addEventListener("error",i),a.open("GET",e,!0),t&&a.setRequestHeader("Authorization","Bearer "+t),a.send()})}function C(){return"?v="+window.VERSION_NUMERIC_VALUE}function E(e){return{diagnosticName:"AssetLoader",boot:(t,n,r)=>{const a=new S(e,n,r);n.AssetLoader=a}}}function I(e){return null!=e.match(h)}S.ASSETLOADER_TRACER_CATEGORY="assetloader"},YWpA:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r,a=n("nuS9"),i=n("4fxQ"),o=n("Qqgh"),s=n("CGM5"),c=n("clbQ"),l=n("HMYz"),u=n("iDZS"),d=n("QJW6"),p=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),g=function(e){function t(t){var n=e.call(this,t)||this;return n._subscriber=null,n._mountedElement=null,n._getReference=n._getReference.bind(n),n.refCallbackTrigger=n.refCallbackTrigger.bind(n),n}return p(t,e),t.prototype.getElementName=function(){return this.props.semanticTag||"div"},t.prototype.getFlexClassName=function(e){return Object(o.b)(e?e.display:null)},t.prototype.componentDidMount=function(){this.props.isRequestedMeasuring&&(this._subscriber={forceMeasure:this.props.forceMeasure,getComponent:this.getComponent.bind(this),onMeasure:this.props.onMeasuring},c.a.getInstance().addMeasuringSubscribers(this._subscriber))},t.prototype.componentDidUpdate=function(){this.props.isRequestedMeasuring&&(this._mountedElement=i.findDOMNode(this))},t.prototype._getReference=function(e){e&&this.props.isRequestedMeasuring&&(this._mountedElement=i.findDOMNode(e))},t.prototype.getComponent=function(){return this._mountedElement},t.prototype.componentWillUnmount=function(){this.props.isRequestedMeasuring&&c.a.getInstance().removeMeasuringSubscribers(this._subscriber)},t.prototype.getElementStyle=function(){if(this.props.style)return Object(o.a)(this.props.style)},t.prototype.getElementClassName=function(){var n=e.prototype.getElementClassName.call(this);return this.props&&this.props.className&&(n+=" "+this.props.className),this.props.style&&t.isElementScrollable(this.props.style)&&(n+=d.a.getInstance().getDisableScrollStyle()&&!this.props.isWithinATopMostSeeMore?" webkitScrollAuto":" webkitScroll"),n},t.prototype.getElementProps=function(){var e={id:this.props.id,accessKey:""===this.props.accessKey?null:this.props.accessKey,ref:this.setRefCallbackAndReference.bind(this)};return"boolean"==typeof this.props.isRTL&&(e.dir=this.props.isRTL?"rtl":"ltr"),this.isIE||this.hasAriaProperty()||"number"==typeof this.props.tabIndex||this.props.semanticTag&&"div"!==this.props.semanticTag&&"span"!==this.props.semanticTag||(e.role="presentation"),e},t.prototype.setRefCallbackAndReference=function(e){return this.props.isRequestedMeasuring&&!0===this.props.isRequestedMeasuring?this._getReference(e):this.props.refCallback?this.refCallbackTrigger(e):void 0},t.prototype.render=function(){return a.createElement(this.getElementName(),this.getElementPropsInternal(),this.getElementChildren())},t.displayName="View",t}(s.a);function h(e){return e&&e.style?Object.assign(e.style,Object(u.b)(e)):{}}var f=l.connect((function(e){return function(t){return t.renderRule(h,e)}}))(g)},YYhu:function(e,t,n){"use strict";n.d(t,"c",(function(){return C})),n.d(t,"d",(function(){return v})),n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return I}));var r=n("WPtp"),a=n("odYE"),i=n("SAYH"),o=n("bT7G"),s=n("lY/Z"),c=n("P+kM"),l=n("Pcet"),u=n("FZDd"),d=n("Uv1Y"),p=n("Dea/"),g=n("bi9n"),h=n("hirD"),f=n("GD3x"),m=n("Xe7f"),b=n("PF3G"),_=n("HYaY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const y="dataSnapshot.removeLockedChanges";function v(e,t,n,r){return{type:"dataSnapshot.saveMultiple.async",execute({dispatch:a,getState:i},s){const l=[],u=new Map,p=s.TraceManager.getTracer("Forms.SaveForm");for(const n of e){const e=S(i(),n,p,s.EventManager,t);if(!e)return Promise.reject(new d.a("Invalid snapshot with id "+n));l.push(...e);const r=u.size;for(let t=r;t<r+e.length;t++)u.set(t,n);a(Object(c.b)(n,!0))}const g=new h.a(l,new f.a(!1,!0));return s.DataSource.execute(g,null).nativePromise().then(e=>{const t=e.get_responses(),s=i(),c=[];for(const e of t){const t=e.get_requestIndex(),i=g.get_requests()[t].get_name();if("Update"===i||"Create"===i){const i=u.get(t),l=Object(o.b)(s,i),d=e.get_response(),p=n&&n[l.identifier.etn];c.push(a(O(l,d,p,r)))}}return Promise.all(c)},d.b).catch(t=>{const n=t.faultedRequestIndex;if(n>-1&&u.size>n){const e=u.get(n);t.FaultedSnapshotId=e}throw e.forEach(e=>a(Object(c.b)(e,!1))),t})}}}function S(e,t,n,r,a){const i=Object(o.b)(e,t);if(i&&i.identifier){const t=I(e,i,n);if(i.mode===p.a.Create)return[new m.a(t,a,null)];return[new b.a(t,a)]}return null}function O(e,t,n,r){return{type:"dataSnapshot.refreshRecordAndUpdateSnapshot.async",execute({dispatch:o,getState:c},u){const d=e.mode===p.a.Create,h=t.get_entityReference();d&&o(Object(g.b)(e.snapshotId,p.a.Update));let f=e.identifier;return i.a.isNullOrEmpty(e.identifier.id)&&(f=a.a.fromLegacyEntityReference(h),o(Object(l.b)(e.snapshotId,f))),n?(d&&null!=r&&i.a.equals(i.a.fromLegacyGuid(r.get_target().Id),i.a.EMPTY)&&r.set_target(h),o(Object(s.c)(f,n,r)).then(()=>(o(E(e.snapshotId)),Promise.resolve(f)))):(o(E(e.snapshotId)),Promise.resolve(f))}}}function C(e,t,n,i){return{type:"dataSnapshot.save.async",execute({dispatch:s,getState:l},p){const g=l(),m=Object(o.b)(g,e);if(m&&m.identifier){const o=a.a.toLegacyEntityReference(m.identifier),g=n?n.slice(0):[],b={[o.LogicalName]:g};for(const e in m.activeChanges){g.push(e);const t=m.activeChanges[e];if(Object(r.h)(t)){const e=t;if(e.list)for(const t of e.list){const e=t.identifier.etn;b[e]?b[e]=Array.from(new Set(b[e].concat(Object.keys(t.fields)))):b[e]=Object.keys(t.fields)}}}return s(Object(u.e)(b)).then(()=>{const r=p.TraceManager.getTracer("Forms.SaveForm"),a=S(l(),e,r,p.EventManager,t);s(Object(c.b)(e,!0));let o=null;o=a.length>1?new h.a(a,new f.a(!1,!0)):a[0];return p.DataSource.execute(o,null).nativePromise().then(e=>{let t=null;if(a.length>1){t=e.get_responses().filter(e=>{const t=a[e.get_requestIndex()].get_name();return"Update"===t||"Create"===t})[0].get_response()}else t=e;return s(O(m,t,n,i))}).catch(t=>(s(Object(c.b)(e,!1)),Object(d.b)(t)))})}return Promise.reject(new d.a("Invalid snapshot with id "+e))}}}function E(e){return{type:y,payload:null,meta:e}}function I(e,t,n){return _.a.recordDataToLegacyEntityRecord(e,t.identifier,t.activeChanges,t.snapshotId,n)}},Yb4o:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("nA3O"),a=n("504W");class i extends r.a{constructor(){super(),this._eventHandlers=null}add_propertyChanged(e){this.apcl("$",e)}apcl(e,t){this._eventHandlers||(this._eventHandlers=new Sys.EventHandlerList),this._eventHandlers.addHandler(e,t)}rpcl(e,t){this._eventHandlers&&this._eventHandlers.removeHandler(e,t)}addCustomEventHandler(e,t){this.apcl("~"+e,t)}removeCustomEventHandler(e,t){this.rpcl("~"+e,t)}getCustomEventHandler(e){return this._eventHandlers?this._eventHandlers.getHandler("~"+e):null}firePropertyChanged(e){if(this._eventHandlers){const t=this._eventHandlers.getHandler("$");this._FirePropertyChangedInternal(e,t)}}handleCustomEvent0(e){const t=this.getCustomEventHandler(e);Object(a.a)(t)||t()}handleCustomEvent1(e,t){const n=this.getCustomEventHandler(e);Object(a.a)(n)||n(t)}onPropertyChanged(e){super.onPropertyChanged(e),this.firePropertyChanged(e.property.get_name())}_FirePropertyChangedInternal(e,t){const n=this._eventHandlers.getHandler(e);n&&n(this,e),t&&t(this,e)}}},YcFo:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Recent_1A318AE1-712D-4D32-9E91-E936327E3256",a="Pinned_25F78F30-46FC-42CC-B7E6-DED04C375F62",i="Query_CD974DD2-2E43-406E-BFD7-A93FF8498E62"},Ydwo:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t){this._use=e,this._assign=t}get val(){return this._use()}set val(e){this._assign(e)}}const a=(e,t)=>new r(e,t)},YgRo:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,i.default)(e)+":"+t};var r,a=n("qK6n"),i=(r=a)&&r.__esModule?r:{default:r};e.exports=t.default},YhOF:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("504W"),a=n("bEud");class i{constructor(e,t){this._schemaName=null,this._primaryEntityRole=0,this._schemaName=e,this._primaryEntityRole=Object(r.a)(t)?a.a.unknown:t}get_schemaName(){return this._schemaName}get_primaryEntityRole(){return this._primaryEntityRole}getObjectData(){const e={};return e.schemaname=this._schemaName,e.role=this._primaryEntityRole,e}toString(){return a.a[this._primaryEntityRole]+","+this._schemaName}equals(e){return!Object(r.a)(e)&&e.toString()===this.toString()}}},YqUY:function(e,t,n){"use strict";e.exports=n("oBA7")},"YxC/":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"f",(function(){return u})),n.d(t,"h",(function(){return p})),n.d(t,"g",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return g}));var r=n("eq9I");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return e&&e.metadata&&e.metadata.resourceStrings?e.metadata.resourceStrings:null}function i(e){const t=a(e);return t?t.missingStringIds:[]}function o(e,t){var n;const a=s(e,t);return null!==(n=null!=a?a:r.d[t])&&void 0!==n?n:a}function s(e,t){const n=a(e);return n&&n.strings?n.strings[t]:null}function c(e){const t=a(e);return t&&t.strings?t.strings:{}}function l(e,t){return d(e,t,o)}function u(e,t){return d(e,t,s)}function d(e,t,n){const r={};for(let a=0;a<t.length;a++){const i=t[a];r[i]=n(e,i)}return r}function p(){let e=null;return function(t,n){const r=l(t,n);if(e){if(r)if(Object.keys(r).length!==Object.keys(e).length)e=r;else for(const t in r)if(e[t]!==r[t]){e=r;break}}else e=r;return e}}function g(e,t){return e&&e[t]?e[t]:""}},Yz6o:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return m})),function(e){e[e.APP_NAV_SETTING_SETUP=0]="APP_NAV_SETTING_SETUP",e[e.BASIC_SETUP=1]="BASIC_SETUP",e[e.APP_NAV_SETTING_SETUP_SUMMARY=2]="APP_NAV_SETTING_SETUP_SUMMARY",e[e.BASIC_SETUP_SUMMARY=3]="BASIC_SETUP_SUMMARY"}(r||(r={}));var a=n("Uv1Y"),i=n("8unZ"),o=n("E5IU"),s=n("Nb1E"),c=n("eXjw"),l=n("DRVD"),u=n.n(l),d=n("odYE"),p=n("SAYH"),g=n("504W"),h=n("Zvo8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const f="appsettings.retrieve";function m(){return{type:"appsettings.retrieve.async",execute({dispatch:e,getState:t},n){const l=Object(i.b)(t()),m=n.TraceManager.getTracer("InAppShell");if(m.info("Action retrieveAppSettings started, appSettingsInitState: "+l),!l||l===c.a.Uninitialized){e(function(){const e={Groups:[],GroupsCollapsedState:[]},t={initialized:c.a.Initializing,appNavSettings:e};return{type:f,payload:t}}());const i=Object(o.i)(t());if(i){const o=u.a.createEvent("retrieveAppShellSettings","InAppShell.Actions.Async").startStopwatch();let l="appconfig",y=`?$filter=_appmoduleid_value eq ${i}&$select=appconfigid`;const v=function(e,t,n){return e(Object(s.e)(t,n))}(e,l,y);return m.info("Retrieving appconfig for appId: "+i),v.then(t=>{if(m.debug("OData AppConfig Retrieve Response: "+JSON.stringify(t)),t&&t.value){const n=new p.a(t.value[0].appconfigid);m.info("AppConfigId retrieved successfully, AppConfigId:"+JSON.stringify(n)+", now retrieving navigation settings for this appConfigId"),l="appconfig",y="?$expand=appconfig_navigationsetting($orderby=advancedsettingorder asc)";const a=Object(s.d)(new d.a(l,n),y,{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0","If-None-Match":""});return e(a).then(n=>{m.debug("Navigation Settings Retrieve Response: "+JSON.stringify(n)),m.info("Navigation Settings Retrieved Successfully"),o(),e(function(e,t,n){const a=[],i=[],o=[],s=[],l=[];let u=null,d=null;const p=new Map,m=t.appconfig_navigationsetting;for(let e=0;e<m.length;e++){const t=m[e],n=Object(h.b)("navigationSettingVisitedCookie_"+t.navigationsettingid);if(t.settingtype===r.APP_NAV_SETTING_SETUP_SUMMARY)u=t;else if(t.settingtype===r.BASIC_SETUP_SUMMARY)t.progressstate=t.progressstate||null!==n,d=t;else if(null==t.parentnavigationsettingid||void 0===t.parentnavigationsettingid){const e={name:t.name,navigationsettingid:t.navigationsettingid,description:t.description,SubAreas:[]};p.set(e.navigationsettingid,e),a.push(e)}else s.push(t),t.settingtype===r.BASIC_SETUP&&(t.progressstate=t.progressstate||null!==n,o.push(t))}for(const e of s){const t=p.get(e.parentnavigationsettingid);t&&t.SubAreas.push(e)}for(let e=0;e<a.length;e++)a[e].SubAreas.length>0&&(l.push(a[e]),i.push(!1));const _=o.sort(b);Object(g.a)(d)||_.push(d);for(let e=0;e<_.length;e++)_[e].quicksettingorder=e;const y={setupSummaryNode:u,Groups:l,GroupsCollapsedState:i},v={initialized:c.a.Initialized,appConfigId:e,appNavSettings:y};return n.debug("Navigation Settings Metadata State:"+v),{type:f,payload:v}}(t.value[0].appconfigid,n,m))})}o()}).catch(e=>{const r=JSON.stringify(e);return m.error("Retrieve Navigation Settings - OData Failure, Error Message: "+r),_(t,n,e,"Retrieve Navigation Settings - OData Failure"),Promise.reject(new a.a("Retrieve Navigation Settings - OData Failure, Error Message: "+r))})}return m.error("Retrieve Navigation Settings - AppContext not available in the metadata store"),_(t,n,new Error("AppContext not available in the metadata store"),"Retrieve Navigation Settings"),Promise.reject(new a.a("Retrieve Navigation Settings - AppContext not available in the metadata store"))}}}}function b(e,t){return Object(g.a)(t.quicksettingorder)?0:Object(g.a)(e.quicksettingorder)?1:e.quicksettingorder-t.quicksettingorder}function _(e,t,n,r){const a=Object(o.d)(e()),i=a?a.uniqueName:"",s=[];s.push({name:"AppUniqueName",value:i}),s.push({name:"ErrorSource",value:r}),t.EventManager.ReportComponentFailure("InAppShell",n,"",s)}},"Z/4N":function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"f",(function(){return u})),n.d(t,"c",(function(){return l}));var r=n("y60j"),a=n("jq7Z"),i=n("9fGf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t){return e&&e.metadata&&e.metadata.controlManifests&&t&&e.metadata.controlManifests.hasOwnProperty(t)?e.metadata.controlManifests[t]:null}function s(e,t,n){if(!(e&&e.metadata&&e.metadata.homePageConfigurations&&t&&n))return null;const r=e.metadata.homePageConfigurations[t];return r?r[n]:null}function c(e,t,n){const a=Object(r.j)(e,n);return a&&a.ControlConfigurations&&a.ControlConfigurations.hasOwnProperty(t)&&a.ControlConfigurations[t]?a.ControlConfigurations[t]:null}function l(e,t,n){var r,a;const o=Object(i.b)(e),s=c(e,t,n);if(null===(a=null===(r=null==s?void 0:s.CustomControls)||void 0===r?void 0:r[o])||void 0===a?void 0:a.CustomControlId)return s.CustomControls[o].Name}function u(e,t,n,r){const i=Object(a.a)(e,t);return i&&i.gridConfigurations&&i.gridConfigurations[r.guid]&&i.gridConfigurations[r.guid][n]?i.gridConfigurations[r.guid][n]:null}function d(e,t,n){if(e&&e.UniqueId&&t.Id&&null!=t.ControlConfigurations){const r=t.ControlConfigurations[e.UniqueId];if(r&&r.CustomControls&&r.CustomControls[n])return r.CustomControls[n]}return null}},Z4sG:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("2yvP"),a=n("UR8A"),i=n("16wZ"),o=n("ABCl"),s=n("69Qu"),c=n("aRLb");class l{constructor(e){this._store=e,this._clientApiExecutor=new o.b(this._store,"ClientApi.XrmIntelligenceApi.")}getPredictionSchemaAsync(){const e=this._clientApiExecutor.getComponentName("getPredictionSchemaAsync");return Object(i.j)(e,"Not Supported"),null}predictAsync(e,t){const n=this._clientApiExecutor.getComponentName("predictAsync");let r,a;if(Xrm.Utility.getGlobalContext().client.isOffline()&&Object(i.j)(n,"No supported in Offline"),"string"==typeof t)try{const e=JSON.parse(t);e&&(r=e.request,a=e.version)}catch(e){}return this._clientApiExecutor.executeAsync("predictAsync",(t,n)=>{const o={boundParameter:"entity",operationName:"Predict",operationType:0,parameterTypes:{entity:{typeName:"Microsoft.Dynamics.CRM.msdyn_aimodel",structuralProperty:5},version:{typeName:"Edm.String",structuralProperty:1},request:{typeName:"Edm.String",structuralProperty:1}}},s={getMetadata:()=>o,entity:{id:e,entityType:"msdyn_aimodel"},version:a,request:r};let c;const l=new Promise(e=>{c=e});return Xrm.WebApi.online.execute(s).then(e=>e.json().then(e=>c({success:!0,body:{response:e.response}}))).catch(e=>{let r;r=2147746327===e.errorCode?2:3;const a={success:!1,error:r,body:{response:JSON.stringify({error:e})}};return Object(i.d)(this._store,e,t,n).then(()=>c(a)).catch(()=>c(a))}),l},[{name:"modelId",value:e,isRequired:!0,isEventParam:!0},{name:"version",value:a,isRequired:!0,isEventParam:!0},{name:"request",value:r,isRequired:!0}])}invokeGlobalOperationAsync(e,t){return this._clientApiExecutor.executeAsync("invokeGlobalOperationAsync",async(n,r)=>{this._verifyWebApiOnlineIsReady(n);const a=this._buildODataContract(e,t);try{const e=await this._executeOnlineRequest(a);return{success:!0,body:await e.json()}}catch(e){try{const t=await Object(i.d)(this._store,e,n,r);throw new Error(`Should never happen ${t}. Using never variable so the compiler is happy :)`)}catch(e){}return{success:!1,error:3,body:{response:JSON.stringify({error:e})}}}})}invokeAiModelActionAsync(e,t){return this._clientApiExecutor.executeAsync("invokeAiModelActionAsync",async(n,r)=>{var a,o;this._verifyWebApiOnlineIsReady(n);const s=Object.assign(Object.assign({},null===(a=t.payload)||void 0===a?void 0:a.parameterTypes),{entity:{typeName:"Microsoft.Dynamics.CRM.msdyn_aimodel",structuralProperty:5}}),c={boundParameter:"entity",operationName:t.operationName,operationType:0,parameterTypes:s},l=Object.assign(Object.assign({},null===(o=t.payload)||void 0===o?void 0:o.request),{getMetadata:()=>c,entity:{id:e,entityType:"msdyn_aimodel"}});try{const e=await this._executeOnlineRequest(l);return{success:!0,body:await e.json()}}catch(e){try{const t=await Object(i.d)(this._store,e,n,r);throw new Error(`Should never happen ${t}. Using never variable so the compiler is happy :)`)}catch(e){}let t;return t=e&&2147746327===e.errorCode?2:3,{success:!1,error:t,body:{response:JSON.stringify({error:e})}}}})}getPreTrainedModelIdAsync(e){const t=this._clientApiExecutor.getComponentName("getPreTrainedModelIdAsync");return Xrm.Utility.getGlobalContext().client.isOffline()&&Object(i.j)(t,"No supported in Offline"),this._clientApiExecutor.executeAsync("getPreTrainedModelIdAsync",(t,n)=>{let r,a;const o=new Promise((e,t)=>{r=e,a=t});return Xrm.WebApi.retrieveMultipleRecords("msdyn_aimodel",`?$filter=msdyn_TemplateId/msdyn_uniquename eq '${e}'&$select=msdyn_aimodelid&$top=1`).then(t=>{t&&t.entities&&t.entities.length>0?r({success:!0,body:t.entities[0].msdyn_aimodelid}):r({success:!1,error:2,body:e+" not found"})}).catch(e=>{Object(i.d)(this._store,e,t,n).catch(e=>{a(e)})}),o},[{name:"templateUniqueName",value:e,isRequired:!0,isEventParam:!0}])}getLabelsForObjectDetectionModelAsync(){const e=this._clientApiExecutor.getComponentName("getLabelsForObjectDetectionModelAsync");return Object(i.j)(e,"Not Supported"),null}_verifyWebApiOnlineIsReady(e){Object(s.b)(this._store.getState())||Object(i.e)(e,"API can be accessed only when online.")}_executeOnlineRequest(e){return this._store.dispatch(Object(c.b)(e))}_buildODataContract(e,t){function n(){}const r={boundParameter:void 0,operationName:t.operationName,operationType:e,parameterTypes:t.payload?t.payload.parameterTypes:{}};n.prototype.getMetadata=function(){return r};const a=Object.create(n.prototype);return t.payload&&Object.assign(a,Object.assign({},t.payload.request)),a}}var u=n("N0PS");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function d(e,t,n,i){const o=a.a;if(!o.Initialized){i||(i=new u.a(e,n,t));const a=i.Utility.getGlobalContext(),s=a.userSettings;let c,d,p,g,h;i.Internal&&(c=i.Internal.isFeatureEnabled.bind(i.Internal),d=i.Internal.isDisruptiveFeatureEnabled.bind(i.Internal),p=i.Internal.getEntityName.bind(i.Internal),g=i.Internal.canOpenUrl.bind(i.Internal),h=i.Internal.getFormId.bind(i.Internal));const f=a.client,m=a.organizationSettings;o.setUserSettings({getTimeZoneOffsetMinutes:()=>Object(r.b)("pcfControl.xrmProxy",()=>s.getTimeZoneOffsetMinutes()),get userId(){return Object(r.b)("pcfControl.xrmProxy",()=>s.userId)},get userName(){return Object(r.b)("pcfControl.xrmProxy",()=>s.userName)},get languageId(){return Object(r.b)("pcfControl.xrmProxy",()=>s.languageId)},get securityRoles(){return Object(r.b)("pcfControl.xrmProxy",()=>s.securityRoles)},get isHighContrastEnabled(){return Object(r.b)("pcfControl.xrmProxy",()=>s.isHighContrastEnabled)},get isRTL(){return Object(r.b)("pcfControl.xrmProxy",()=>s.isRTL)},get pagingLimit(){return Object(r.b)("pcfControl.xrmProxy",()=>s.pagingLimit)},get formatInfoCultureName(){return Object(r.b)("pcfControl.xrmProxy",()=>s.formatInfoCultureName)}}),o.setOrgSettings({get languageId(){return Object(r.b)("pcfControl.xrmProxy",()=>m.languageId)},get uniqueName(){return Object(r.b)("pcfControl.xrmProxy",()=>m.uniqueName)},get isAutoSaveEnabled(){return Object(r.b)("pcfControl.xrmProxy",()=>m.isAutoSaveEnabled)},get attributes(){return Object(r.b)("pcfControl.xrmProxy",()=>m.attributes)}});const b={beginSecureSessionForResource:(e,t,n,a)=>Object(r.b)("pcfControl.xrmProxy",()=>i.Utility.beginSecureSessionForResource(e,t,n,a)),getEntityMetadata:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>i.Utility.getEntityMetadata(e,t)),getEntitiesMetadata:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.Utility.getEntitiesMetadata(e)),getResourceString:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>i.Utility.getResourceString(e,t)),isFeatureEnabled:e=>Object(r.b)("pcfControl.xrmProxy",()=>c(e)),isDisruptiveFeatureEnabled:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>d(e,t,n)),lookupObjects:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.Utility.lookupObjects(e)),getEntityName:e=>Object(r.b)("pcfControl.xrmProxy",()=>p(e)),getFormId:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>h(e,t)),canOpenUrl:e=>Object(r.b)("pcfControl.xrmProxy",()=>g(e))};o.setUtils(b),o.setOffline({isOfflineEnabled:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.Mobile.offline.isOfflineEnabled(e))}),o.setPage({getClientUrl:()=>Object(r.b)("pcfControl.xrmProxy",()=>a.getClientUrl())}),o.setClient({getFormFactor:()=>Object(r.b)("pcfControl.xrmProxy",()=>f.getFormFactor()),getClient:()=>Object(r.b)("pcfControl.xrmProxy",()=>f.getClient()),getClientState:()=>Object(r.b)("pcfControl.xrmProxy",()=>f.getClientState())}),o.setReporting({reportSuccess:(e,t)=>{Object(r.b)("pcfControl.xrmProxy",()=>{i.Reporting.reportSuccess(e,t)})},reportFailure:(e,t,n,a)=>{Object(r.b)("pcfControl.xrmProxy",()=>{i.Reporting.reportFailure(e,t,n,a)})},reportEvent:e=>{Object(r.b)("pcfControl.xrmProxy",()=>{i.Reporting.reportEvent(e)})}}),o.setDiagnostics({traceError:(e,t)=>{Object(r.b)("pcfControl.xrmProxy",()=>{i.Diagnostics.traceError(e,t)})},traceWarning:(e,t)=>{Object(r.b)("pcfControl.xrmProxy",()=>{i.Diagnostics.traceWarning(e,t)})},traceInfo:(e,t)=>{Object(r.b)("pcfControl.xrmProxy",()=>{i.Diagnostics.traceInfo(e,t)})},traceDebug:(e,t)=>{Object(r.b)("pcfControl.xrmProxy",()=>{i.Diagnostics.traceDebug(e,t)})}}),o.setNavigationContext({openAlertDialog:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>i.Navigation.openAlertDialog(e,t)),openConfirmDialog:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>i.Navigation.openConfirmDialog(e,t)),openDialog:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>i.Navigation.openDialog(e,t,n)),openErrorDialog:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.Navigation.openErrorDialog(e)),openFile:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>i.Navigation.openFile(e,t)),openForm:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>i.Navigation.openForm(e,t)),openTaskFlow:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>i.Navigation.openTaskFlow(e,t,n)),openUrl:(e,t)=>{Object(r.b)("pcfControl.xrmProxy",()=>i.Navigation.openUrl(e,t))},openWebResource:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>i.Navigation.openWebResource(e,t)),navigateTo:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>i.Navigation.navigateTo(e,t))}),o.setDeviceContext({captureImage:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.Device.captureImage(e)),captureAudio:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.Device.captureAudio(e)),captureVideo:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.Device.captureVideo(e)),pickFile:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.Device.pickFile(e)),getBarcodeValue:()=>Object(r.b)("pcfControl.xrmProxy",()=>i.Device.getBarcodeValue()),isGetBarcodeValueAvailable:()=>Object(r.b)("pcfControl.xrmProxy",()=>!1),getCurrentPosition:()=>Object(r.b)("pcfControl.xrmProxy",()=>i.Device.getCurrentPosition()),openARViewer:e=>Object(r.b)("pcfControl.xrmProxy",()=>{throw"Not Implemented"}),isOpenARViewerAvailable:()=>Object(r.b)("pcfControl.xrmProxy",()=>!1)}),o.setExternalContext({getExternalContextProperty:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>i.ExternalContext.getExternalContextProperty(e,t,n)),invokeExternalContextAction:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>i.ExternalContext.invokeExternalContextAction(e,t,n)),getAvailableExternalContexts:()=>Object(r.b)("pcfControl.xrmProxy",()=>i.ExternalContext.getAvailableExternalContexts()),removeExternalContextPropertyListener:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>i.ExternalContext.removeExternalContextPropertyListener(e,t,n))}),o.setApplicationUI({addGlobalNotification:(e,t,n,a,o,s)=>Object(r.b)("pcfControl.xrmProxy",()=>i.UI.addGlobalNotification(e,t,n,a,o,s)),clearGlobalNotification:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.App.clearGlobalNotification(e)),clearGlobalNotifications:()=>Object(r.b)("pcfControl.xrmProxy",()=>i.UI.clearGlobalNotifications())}),o.setWebApi({get offline(){return Object(r.b)("pcfControl.xrmProxy",()=>({retrieveRecord:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.offline.retrieveRecord(e,t,n)),createRecord:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.offline.createRecord(e,t)),updateRecord:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.offline.updateRecord(e,t,n)),deleteRecord:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.offline.deleteRecord(e,t)),retrieveMultipleRecords:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.offline.retrieveMultipleRecords(e,t,n)),execute:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.offline.execute(e))}))},get online(){return Object(r.b)("pcfControl.xrmProxy",()=>({retrieveRecord:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.online.retrieveRecord(e,t,n)),createRecord:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.online.createRecord(e,t)),updateRecord:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.online.updateRecord(e,t,n)),deleteRecord:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.online.deleteRecord(e,t)),retrieveMultipleRecords:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.online.retrieveMultipleRecords(e,t,n)),execute:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.online.execute(e)),executeMultiple:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.online.executeMultiple(e))}))}});const _=new l(e);return o.setIntelligenceApi({getPredictionSchemaAsync:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>_.getPredictionSchemaAsync()),predictAsync:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>_.predictAsync(e,t)),getPreTrainedModelIdAsync:e=>Object(r.b)("pcfControl.xrmProxy",()=>_.getPreTrainedModelIdAsync(e)),getLabelsForObjectDetectionModelAsync:e=>Object(r.b)("pcfControl.xrmProxy",()=>_.getLabelsForObjectDetectionModelAsync()),invokeAiModelActionAsync:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>_.invokeAiModelActionAsync(e,t)),invokeGlobalOperationAsync:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>_.invokeGlobalOperationAsync(e,t))}),o.Initialized=!0,i}}},Z6YS:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n("ufH1"),a=n("504W"),i=n("6K5O"),o=n("zW2f"),s=n("H4dV"),c=n("eruq"),l=n("/Ndy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class u{constructor(){this.endPointUrl=null,this.requestType=null,this.contentType=null,this.dataType=null,this.soapAction=null,this.oDataVersion=null,this.oDataMaxVersion=null,this.prefer=null,this.additionalHeaders=null}static create(e,t,n,r,a){const i=new u;return i.endPointUrl=e,i.requestType=t,i.contentType=n,i.dataType=r,i.soapAction=a,i.additionalHeaders={},i}}u.jsonDataType="text",u.soapDataResponseAsText="text",u.soapDataResponseAsXml="xml",u.jsonContentType="application/json; charset=utf-8",u.soapContentType="text/xml; charset=utf-8";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class d{constructor(){this.responseText=null,this.headers=null,this.responseSize=0,this.data=null,this.status=0,this.statusText=null,this.responseTelemetryId=null}}var p=n("EW4s"),g=n("DRVD"),h=n.n(g),f=n("Div0"),m=n("Rckk");class b{constructor(e,t,n,r){this._serverUrl=null,this._remoteCallRetryHandler=null,this.callerOriginProvider=null,this.applicationStatusProvider=null,this._webServiceSettings=null,this._ODataVersionRegex=new RegExp("^odata-version:","im"),this._remoteCallRetryHandler=t,this.callerOriginProvider=n,this.applicationStatusProvider=r,this._serverUrl=b.getNormalizedServerUrl(e)}get_serverUrl(){return this._serverUrl}get_Settings(){return this._webServiceSettings}set_Settings(e){return this._webServiceSettings=e,e}createSoapRequestBody(e){return'<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Header>'+this.getSoapHeaders()+"</s:Header><s:Body>"+e+"</s:Body></s:Envelope>"}getSoapHeaders(){return null}executeJsonRequest(e){const t=new p.a;return this._ExecuteRequest(e).then(e=>{const n=e,i=n.data;let o={};if(o.headers=n.headers,o.status=n.status,o.statusText=n.statusText,Object(a.a)(i))t.resolve(o);else{const e=i;if(e.indexOf("--batchresponse"))if(this._ODataVersionRegex.test(n.headers))o.body=JSON.parse(e),t.resolve(o);else try{o=JSON.parse(e),t.resolve(o)}catch(n){e.indexOf(l.a.HtmlHeader)>-1?(Object(r.b)(this.get_name()+b.executeJsonRequestName,f.a.storage,e),t.reject(this.createErrorResponseFromHtml(e))):(Object(r.b)(this.get_name()+b.executeJsonRequestName,f.a.storage,b.responseTypeUnknown),t.reject(this.createErrorResponse(new XMLHttpRequest,"",this.get_name()+b.responseTypeUnknown)))}else o.body=i,t.resolve(o)}},e=>{Object(r.b)(this.get_name()+b.executeJsonRequestName,f.a.storage,e.get_message()),t.reject(e)}),t}executeSoapRequest(e){const t=new p.a;return this._ExecuteRequest(e).then(n=>{const r=n.data;if(e.requestOptions.dataType===u.soapDataResponseAsText){let n=r;return(n.length>b._MaxLibxmlLength||this.hasNilNodes(e.name))&&(n=b.removeNilNodes(n)),void(this.handleSpecialCaseSoapResults(e,n,t)||(s.a.getInstance().get_IsIOS()&&n.length>b._MaxLibxmlLength?t.reject(this.createErrorResponse(new XMLHttpRequest,"XML Too Large","Error: XML response for "+e.name+" is too large! Max length allowed is "+b._MaxLibxmlLength+", length of input XML is "+n.length)):this._ParseAndResolve(n,t)))}t.resolve(Object(c.a)(r))},e=>{t.reject(e)}),t}_ParseAndResolve(e,t){const n=Object(c.b)(e);Object(a.a)(n)?t.reject(this.createErrorResponse(new XMLHttpRequest,"parsererror","Unable to parse XML response: "+e)):t.resolve(Object(c.a)(n))}_ExecuteRequest(e){$.support.cors=!0;const t={async:!0,cache:!0};t.type=e.requestOptions.requestType,t.data=e.requestText,t.contentType=e.requestOptions.contentType,t.dataType=e.requestOptions.dataType,t.url=e.requestOptions.endPointUrl,t.beforeSend=t=>{if(Object(a.a)(e.requestOptions.soapAction)||t.setRequestHeader("SOAPAction",e.requestOptions.soapAction),Object(a.a)(e.requestOptions.oDataVersion)||(t.setRequestHeader("OData-MaxVersion",e.requestOptions.oDataMaxVersion),t.setRequestHeader("OData-Version",e.requestOptions.oDataVersion)),Object(a.a)(e.requestOptions.prefer)||t.setRequestHeader("Prefer",e.requestOptions.prefer),t.setRequestHeader("ClientHost",b._GetClientHostName()),!Object(a.a)(this.applicationStatusProvider)){const e=this.applicationStatusProvider.getCurrentAppId();Object(a.a)(e)||t.setRequestHeader("x-ms-app-id",e);const n=this.applicationStatusProvider.getCurrentAppUniqueNameOrDefault();Object(a.a)(n)||t.setRequestHeader("x-ms-app-name",n),this.applicationStatusProvider.addAuthorizationHeader(t)}if(!Object(a.a)(e.requestOptions.additionalHeaders)){const n=e.requestOptions.additionalHeaders;for(const e in n){const r={key:e,value:n[e]};t.setRequestHeader(r.key,r.value.toString())}}Object(a.a)(this.callerOriginProvider)||(this.callerOriginProvider.updateRequestForCallerOriginUniqueId(t),this.callerOriginProvider.updateRequestForCallerOriginVersion(t)),t.setRequestHeader("Client-Name","UCI")};const n={};"POST"===e.requestOptions.requestType&&(n["cache-control"]="no-cache"),this.addHeaders(n,e),t.headers=n;const i=new p.a,o=new p.a,s=window.performance.now();b._set_RequestsPending(b._get_RequestsPending()+1),o.always(t=>{this._SetRequestPerformance(e,t,s),b._set_RequestsPending(b._get_RequestsPending()-1)}).then(e=>{i.resolve(e)},e=>{Object(r.b)(this.get_name()+b.executeRequestName,f.a.storage,e.get_message()),i.reject(e)});let c=null;this.get_Settings()&&(c=this.get_Settings().getWebServiceCallRetryPolicy(e.requestOptions.endPointUrl));const l=c?c.TotalRetryCount:0,u=c?c.RetryWaitIntervalMilliseconds:0;return this._ExecuteRequestWithRetry(t,o,l,u,0,0,b._TotalRetryableServerErrorRetryCount),i}_SetRequestPerformance(e,t,n){const r=window.performance.now(),i=h.a.createEvent(this.get_performanceStopwatch(),"WebService"),s={};let c=e.name;const l=new Array(0);if(!Object(a.a)(e.childRequests)){for(const t of e.childRequests)l.push(t);l.length>0&&(c+=","+l.join(","))}s.requestName=c;const u=Object(a.a)(e.context)?o.a.get_instance():e.context;if(s.context=u.toString(),s.requestSize=e.requestSize.toString(),t instanceof d){const e=t;s.responseSize=e.responseSize.toString(),Object(a.b)(e.responseTelemetryId)||(s.requestId=e.responseTelemetryId)}else s.responseSize="0";i.createRetroactiveStopwatch(n,r-n,s)}_ExecuteRequestWithRetry(e,t,n,i,o,c,l){const u=$.ajax(e);u.done(d=>{const p=this.createResponseData(u,d);Object(a.a)(d)?(Object(r.e)(this.get_name()+"_ExecuteRequest",f.a.storage,"Warning: Response data null or undefined"),t.resolve(p)):!p.responseSize&&s.a.getInstance().get_IsAndroidJellyBean()?n>0?(n--,window.setTimeout(()=>{this._ExecuteRequestWithRetry(e,t,n,i,o,c,l)},i)):(Object(r.b)(this.get_name()+b.executeRequestWithRetryName,f.a.storage,String.format("Response: {0}",p.responseText)),t.reject(this.createErrorResponse(new XMLHttpRequest,"",this.get_name()+"Error: Response text empty"))):t.resolve(p)}).fail((s,u,d)=>{if(401!==s.status||Object(a.a)(this._remoteCallRetryHandler))if(400===s.status&&o<5)this._LogRetryRequest(e.url,s.status,d.toString(),5-o),++o,this._ExecuteRequestWithRetry(e,t,n,i,o,c,l);else if(503===s.status&&n>0)this._LogRetryRequest(e.url,s.status,d.toString(),n),--n,window.setTimeout(()=>{this._ExecuteRequestWithRetry(e,t,n,i,o,c,l)},i);else if(!s.status&&c<1)this._LogRetryRequest(e.url,s.status,d.toString(),1-c),++c,this._ExecuteRequestWithRetry(e,t,n,i,o,c,l);else if(500===s.status&&this.canRetryServerError(this.createErrorResponse(s,u,d.toString()))&&l>0)this._LogRetryRequest(e.url,s.status,d.toString(),l-1),--l,window.setTimeout(()=>{this._ExecuteRequestWithRetry(e,t,n,i,o,c,l)},1e3);else{const e=this.createErrorResponse(s,u,d.toString());Object(r.b)(this.get_name()+b.executeRequestWithRetryName,f.a.storage,String.format("Response: {0}",e.get_message())),t.reject(e)}else this._remoteCallRetryHandler.handleAuthError(s).then(r=>{this._ExecuteRequestWithRetry(e,t,n,i,o,c,l)},e=>{Object(r.b)(this.get_name()+b.executeRequestWithRetryName,f.a.storage,b.authorizedError+" "+e.get_Message()),t.reject(this.createErrorResponse(s,u,this.get_name()+b.authorizedError+" "+e.get_Message()))})})}_LogRetryRequest(e,t,n,r){Object(i.a)("Request Failed: "+e+" Status: "+t+" Message: '"+n+"' Retries Remaining: "+r)}hasNilNodes(e){return!1}handleSpecialCaseSoapResults(e,t,n){return!1}addHeaders(e,t){}canRetryServerError(e){return!1}createResponseData(e,t){const n=new d;return n.responseText=Object(a.a)(e.responseText)?"":e.responseText,n.responseSize=n.responseText.length,n.headers=e.getAllResponseHeaders(),n.data=t,n.status=e.status,n.statusText=e.statusText,n}createJsonRequestOptions(e){return u.create(e,"POST",u.jsonContentType,u.jsonDataType,e)}createWebApiRequestOptions(e,t){const n=u.create(e,Object(a.a)(t)?"GET":t,u.jsonContentType,u.jsonDataType,null);return n.oDataVersion="4.0",n.oDataMaxVersion="4.0",n}createSoapRequestOptions(e,t){let n;return n=s.a.getInstance().get_IsIOS()?u.soapDataResponseAsText:u.soapDataResponseAsXml,u.create(e,"POST",u.soapContentType,n,t)}static removeNilNodes(e){return e.replace(new RegExp('\\<[\\w+:]+ i:nil="true"( xmlns:\\w+="[\\w:\\/.]+")?\\ ?/>',"g"),"")}static getNormalizedServerUrl(e){return"/"===e.substring(e.length-1,e.length)?e.substring(0,e.length-1):e}static addRequestId(e,t){Object(a.a)(e)||Object(a.a)(t)||Object(a.a)(e.additionalHeaders)||m.c.CLIENT_REQUEST_ID in e.additionalHeaders||(e.additionalHeaders[m.c.CLIENT_REQUEST_ID]=t,Object(r.d)(b.webServiceBaseName+b.addRequestIdName,f.a.storage,t))}static _get_RequestsPending(){return b._requestsPending}static _set_RequestsPending(e){return b._requestsPending=e,b._requestsPending>0?$(window).triggerHandler(b.remoteRequestPendingEventName):$(window).triggerHandler(b.noRemoteRequestPendingEventName),e}static _GetClientHostName(){const e=s.a.getInstance();return e.get_isMailApp()?"MailApp":e.get_PALEnabled()?"MobileApplication":e.get_IsBrowser()?"Browser":""}}b.microsoft2003SerializationArraysNamespace="http://schemas.microsoft.com/2003/10/Serialization/Arrays",b.genericCollectionsNamespace="http://schemas.datacontract.org/2004/07/System.Collections.Generic",b.remoteRequestPendingEventName="RemoteRequestPending",b.noRemoteRequestPendingEventName="NoRemoteRequestPending",b._MaxLibxmlLength=1e7,b._TotalRetryableServerErrorRetryCount=5,b._requestsPending=0,b.executeJsonRequestName="_ExecuteJsonRequest_Failure",b.executeRequestName="_ExecuteRequest_Failure",b.executeRequestWithRetryName="_ExecuteRequestWithRetry_Failure",b.responseTypeUnknown="Error: Response data type unknown",b.authorizedError="Error: Not Authorized.",b.addRequestIdName="_AddRequestId",b.webServiceBaseName="WebServiceBase"},Z9sG:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("IpQH"),a=n("uM6Y"),i=n("VkXQ"),o=n("FkJY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class s extends r.a{constructor(e,t){super(e,t,a.a)}ready(){return new Promise((e,t)=>{this.execute(i.a.ready.name,new o.a),e()})}initialized(){return new Promise((e,t)=>{this.execute(i.a.initialized.name),e()})}bootError(e,t){return this.execute(i.a.bootError.name,e,t)}}},ZFRl:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return d}));var r=n("pF61"),a=n("arV0"),i=n("NjDY"),o=n("YxC/"),s=n("m4EA");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c="router.set.pagetitle";let l="";function u(e,t){return{type:"router.set.pagetitleSync",sync:!0,execute({getState:n,dispatch:u}){var d;const g=n();l||(l=Object(o.b)(g,(null===(d=Object(i.x)(g))||void 0===d?void 0:d.isCrmOrg)?s.b:s.e));const h=p(t),f=Object(r.c)(g),m=Object(a.f)(g,e);return e!==f||m||(document.title=h),u(function(e,t){return{type:c,payload:{__pageTitle:t},meta:{pageId:e}}}(e,h)),Promise.resolve()}}}function d(e){document.title=p(e)}function p(e){return e?-1!==e.indexOf(l)?e:String.format("{0} - {1}",e,l):l}},ZFkP:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b}));var r=n("0buK"),a=n("SAYH"),i=n("ruPX"),o=n("oqdd"),s=n("onzm"),c=n("g440"),l=n("a72m"),u=n("d0w6"),d=n("Lohl"),p=n("odYE"),g=n("htFu"),h=n("BJ7u"),f=n("zsAz");function m(e,t,n,a,o){const s={entityTypeName:e,uniqueName:t,id:n,data:a};return Object(i.a)(r.a,s,o)}function b(e,t,n,r){const{uniqueName:i,id:m,entityTypeName:b}=e,_=t.TraceManager.getTracer(Object(s.c)()),y=Object(s.b)()+".prePageRenderTaskBasedFlow";_.info(`Executing prePageRenderTaskBasedFlow action. uniqueName: ${i} id: ${a.a.toString(m)} entityTypeName: ${b}`);const v={resultType:o.a.Fail,resultValue:null};if(!i)return t.EventManager.ReportComponentFailure(y,Error(`TBX not opened because uniqueName was falsy uniqueName: ${i} id: ${a.a.toString(m)} entityTypeName: ${b}`)),_.error(`uniqueName: ${i} id: ${m} entityTypeName: ${b}`),Promise.resolve(v);const S=n(Object(c.b)(i));let O=null;const C=S.then(e=>{let r=null;return e?e.primaryModelName!==b&&(r=`Error starting Task Flow. Entity type mismatch between record id '${a.a.toString(m)}' (${e.primaryModelName}) and Task Flow '${i}' (${b})`):r=`Error starting Task Flow. No published Task Flow '${i}' (${b}) could be found.`,null!=r?(t.EventManager.ReportComponentFailure(y,Error(r)),v.resultValue=Object(f.d)(r,2415919107),v):(O=new p.a(e.primaryModelName,m),_.info(`Retrieving default lookup view for entity  ${e.primaryModelName} and form descriptor for formId ${e.formId} uniqueName: ${i} id: ${a.a.toString(m)} entityTypeName: ${b}`),n(Object(l.a)(e.primaryModelName,u.a.LOOKUP_VIEW,u.b.savedview)).catch(n=>(t.EventManager.ReportComponentFailure(y,Error(`No default view for lookup for entity: ${e.primaryModelName} uniqueName: ${i} id: ${a.a.toString(m)} entityTypeName: ${b}`)),v)),n(Object(d.b)(O,e.formId,Object(h.a)(12))).then(e=>a.a.isNullOrEmpty(e)?(t.EventManager.ReportComponentFailure(y,Error(`TBX not opened because retrievedFormId was: ${a.a.toString(e)} uniqueName: ${i} id: ${a.a.toString(m)} entityTypeName: ${b}`)),v):{resultType:o.a.Success}).catch(n=>{n=n&&n.reason?n.reason:n;const r=`TBX not opened because of error during form retrieval. descriptor.formId was: ${a.a.toString(e.formId)}. Old error: ${n} uniqueName: ${i} id: ${a.a.toString(m)} entityTypeName: ${b}`;return t.EventManager.ReportComponentFailure(y,Error(r)),v}))});return n(Object(g.c)()).catch(e=>{_.error("Task Based Flow Global Menu was not retrieved.")}),C.then(e=>(e&&e.resultType!==o.a.Fail||_.error(`TBX not retrieved. uniqueName: ${i} id: ${a.a.toString(m)} entityTypeName: ${b}`),Promise.resolve(e)))}},ZIjf:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("2yvP");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a{constructor(e,t){this.componentName=e,this.source=t.sourceName,this.totalCalls=0,this.success=0,this.failure=0}}var i=n("IaGr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class o{constructor(){this._usage={},this._usageList=[]}static get instance(){return o._instance||(o._instance=new o),o._instance}get usageList(){return this._usageList}reportCall(e,t){try{this._getUsageCounter(e,t).totalCalls++}catch(t){const n=[];n.push({name:"componentName",value:e}),i.a.getInstance().eventManager.ReportComponentFailure("ClientApi.ClientApiUsageCounters.reportCall",t,null,n)}}reportFailure(e,t){try{this._getUsageCounter(e,t).failure++}catch(t){const n=[];n.push({name:"componentName",value:e}),i.a.getInstance().eventManager.ReportComponentFailure("ClientApi.ClientApiUsageCounters.reportFailure",t,null,n)}}reportSuccess(e,t){try{this._getUsageCounter(e,t).success++}catch(t){const n=[];n.push({name:"componentName",value:e}),i.a.getInstance().eventManager.ReportComponentFailure("ClientApi.ClientApiUsageCounters.reportSuccess",t,null,n)}}static trimComponentName(e){const t=e.split(".");if(t.length<3){const t=[];t.push({name:"componentName",value:e});const n=new Error("Client API componentName should contain at least three parts.");i.a.getInstance().eventManager.ReportComponentFailure("ClientApi.ClientApiUsageCounters._trimComponentName.componentName",n,null,t)}else t.length>3&&(e=t[0]+"."+t[1]+"."+t[2]);return e}_getUsageCounter(e,t){t||(t=Object(r.a)()),e=o.trimComponentName(e);const n=`${t.sourceName}-${e}`;let i=this._usage[n];return i||(i=new a(e,t),this._usage[n]=i,this._usageList.push(i)),i}reportUsage(e){try{this.reportCall(e),this.reportSuccess(e)}catch(t){const n=[];n.push({name:"componentName",value:e}),i.a.getInstance().eventManager.ReportComponentFailure("ClientApi.ClientApiUsageCounters.reportUsage",t,null,n)}}sendReportData(){try{if(o.instance.usageList.length>0){const e=[];e.push({name:"clientApiUsage",value:JSON.stringify(o.instance.usageList)}),i.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.UsageMonitor",e),o._instance=null}}catch(e){i.a.getInstance().eventManager.ReportComponentFailure("ClientApi.ClientApiUsageCounters.sendReportData",e)}}}o._instance=new o},ZJD9:function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var r=n("ufH1"),a=n("84PK"),i=n("504W"),o=n("Div0"),s=n("VA/h"),c=n("l3Ef");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var l;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(e,t,n,r){t=d(t).trim(),n=d(n).trim(),r=d(r).trim();let a="";n.length>0&&(a=n.substring(0,1));let i="";switch(e){case 0:i=r.length>0&&t.length>0?r+", "+t:r+" "+t;break;case l.firstLast:i=t+" "+r;break;case l.lastFirstMiddleInitial:i=function(e,t,n){let r="";t.length>0&&(r=t);t.length>0&&(e.length>0||n.length>0)&&(r+=",");e.length>0&&(r=r+" "+e);n.length>0&&(r=r+" "+n+".");return r.toString().trim()}(t,r,a);break;case l.firstMiddleInitialLast:i=t,n.length>0&&(i=i+" "+a+"."),i=i+" "+r;break;case l.lastFirstMiddle:r.length>0&&(i=r),r.length>0&&(t.length>0||n.length>0)&&(i+=","),t.length>0&&(i=i+" "+t),n.length>0&&(i=i+" "+n);break;case l.firstMiddleLast:i=t,n.length>0&&(i=i+" "+n),i=i+" "+r;break;case l.lastSpaceFirst:i=r+" "+t;break;case l.lastNoSpaceFirst:i=r+t;break;default:i=r}return i.toString().trim()}function d(e){return Object(i.a)(e)?"":e}!function(e){e[e.lastFirst=0]="lastFirst",e[e.firstLast=1]="firstLast",e[e.lastFirstMiddleInitial=2]="lastFirstMiddleInitial",e[e.firstMiddleInitialLast=3]="firstMiddleInitialLast",e[e.lastFirstMiddle=4]="lastFirstMiddle",e[e.firstMiddleLast=5]="firstMiddleLast",e[e.lastSpaceFirst=6]="lastSpaceFirst",e[e.lastNoSpaceFirst=7]="lastNoSpaceFirst"}(l||(l={}));var p=n("lR0U"),g=n("ti3l"),h=n("HYaY"),f=n("WRF3"),m=n("IvgJ"),b=n("KLhE"),_=n("sdkC"),y=n("T544"),v=n("jZCH"),S=n("JPoD"),O=n("bRS5"),C=n("03Hu"),E=n("EW4s");class I{constructor(e,t,n,r){this._userContext=null,this._record=null,this._operation=0,this._entityMetadata=null,this._columns=new Array(0),this._values=new Array(0),this._partiesToCreate=new Array(0),this._partiesToRetain=new Array(0),this._existingParties=new Array(0),this._entityMetadata=n,this._userContext=r,this._operation=t,this._record=e}_IntializeQueryWithDefaultValues(e){const t=new E.a;return this._GetDefaultFields().then(n=>{Object(O.b)(this._record,n,e).then(e=>{this._record=e,Object(r.d)("OfflineQueryData._IntializeQueryWithDefaultValues",o.a.offlineDataStore,"IntializeQueryWithDefaultValues completed succesfully"),t.resolve(!0)},e=>{Object(r.b)("OfflineQueryData._IntializeQueryWithDefaultValues.Failed",o.a.offlineDataStore,"IntializeQueryWithDefaultValues failed with error "+e.get_Message()),t.reject(e)})},e=>{Object(r.b)("OfflineQueryData._IntializeQueryWithDefaultValues.Failed",o.a.offlineDataStore,"IntializeQueryWithDefaultValues failed with error "+e.get_Message()),t.reject(e)}),t}get_columns(){return this._columns}get_values(){return this._values}get_partiesToCreate(){return this._partiesToCreate}get_partiesToRetain(){return this._partiesToRetain}set_existingParties(e){return this._existingParties=e,e}setColumnsAndValues(e,t){const n=new E.a,l=this._operation===g.a.update?this._record.get_changedFieldNames().concat(I.get_defaultValues()):this._record.get_fieldNames(),u=[],d=this._record.get_fieldTypes();for(let e=0;e<l.length;e++)if("partylist"===d[l[e]]){const n=new Array(0);if(!Object(i.a)(this._record.getValue(l[e])))for(const r of this._record.getValue(l[e]).get_entities()){const i=r.hasField(c.e)?r.getValue(c.e):a.a.get_empty();this._operation===g.a.update&&r.hasValue(c.e)&&i!==a.a.get_empty()&&this._existingParties.indexOf(i.toString().toUpperCase())>=0?n[n.length]=r.getValue(c.e).toString().toUpperCase():u.push(this._PrepareActivityPartyRecord(l[e],r,t.toString()))}this._operation===g.a.update&&(this._partiesToRetain[this._partiesToRetain.length]=this._PreparePartiesToRetain(t.toString().toUpperCase(),n.length>0?n:[""],l[e]))}else{const t=Object(p.b)(l[e],d[l[e]],this._record.getValue(l[e]));for(const n in t){const r={key:n,value:t[n]};this._columns[this._columns.length]=r.key,"picklist"===d[l[e]]?this._values[this._values.length]=Object(i.a)(r.value)?null:r.value.toString():this._values[this._values.length]=Object(i.a)(r.value)?"":r.value.toString()}}if(this._record.get_identifier().LogicalName===S.d&&this._operation===g.a.create&&this._record.hasValue(c.K)){const e=this._record.getValue(c.K);Object(i.a)(e)||(this._columns[this._columns.length]=c.L,this._values[this._values.length]=e.LogicalName)}if(Object(i.a)(this._record.get_identifier().get_rowVersion())||(this._columns[this._columns.length]=c.bb,this._values[this._values.length]=this._record.get_identifier().get_rowVersion()),this._operation)this._operation===g.a.update&&(this._values[this._values.length]=t.toString().toUpperCase());else if((!(e in this._record.fields)||Object(i.a)(this._record.get_identifier())||Object(i.a)(this._record.get_identifier().Id)||this._record.get_identifier().Id===a.a.get_empty())&&(this._columns[this._columns.length]=e,this._values[this._values.length]=t.toString().toUpperCase()),!Object(i.a)(this._entityMetadata)&&this._entityMetadata.get_isActivity()){const e=new f.a(c.d,a.a.get_empty()),n=new _.a(new Array(0)),r=new h.a(e,{},{},{},{},n);r.initializeValue(c.S,this._record.getValue(c.M),"lookup"),u.push(this._PrepareActivityPartyRecord(c.N,r,t.toString()))}return u.length<=0?n.resolve(!0):Object(s.a)(u).then(e=>{for(const t of e)this._partiesToCreate.push(t);Object(r.e)("OfflineQueryData.setColumnsAndValues",o.a.offlineDataStore,"Set columns and Values succeeded"),n.resolve(!0)},e=>{Object(r.e)("OfflineQueryData.setColumnsAndValues.Failed",o.a.offlineDataStore,e.get_Message()),n.reject(e)}),n}_GetDefaultFields(){const e=[],t=new E.a;if(!this._operation){const t=I.get_createDefaultValues();t.push(...I.get_stateAndStatusFields());const n=t.indexOf(c.M);n>=0&&this._entityMetadata.get_ownershipType()===b.a.organizationOwned&&t.splice(n,1);for(const n of t)this._record.hasValue(n)||e.push(n);if(!Object(i.a)(this._entityMetadata)&&this._entityMetadata.get_isActivity()&&(this._record.hasValue(c.f)||this._record.initializeValue(c.f,this._entityMetadata.get_logicalName(),"string"),!this._record.hasValue(c.C))){const e={};e[c.Z]=this._IsRegularActivity()?"1":"0",this._record.initializeValue(c.C,m.a.createFromObjectData(e),"boolean")}}if(this._operation&&this._operation!==g.a.update)Object(r.e)("OfflineQueryData._GetDefaultFields",o.a.offlineDataStore,"Get default fields succeeded for entity "+this._entityMetadata.get_logicalName()),t.resolve(e);else{for(const t of I.get_defaultValues())e[e.length]=t;v.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(new y.a(this._record.get_identifier().LogicalName),null).then(n=>{if(!Object(i.a)(n)&&this._isAttributeAvailable(n,c.w))for(const e of this._record.get_changedFieldNames())if(c.x.indexOf(e)>=0){this._record.initializeValue(c.w,u(this._userContext.get_organizationSettings().get_fullNameConventionCode(),this._record.getValue(c.v),this._record.getValue(c.G),this._record.getValue(c.E)),"string"),this._record.get_changedFieldNames().push(c.w);break}if(!this._operation)for(const t of n)(!Object(i.a)(t.get_defaultValue())||!Object(i.a)(t.get_defaultFormValue()))&&(this._record.get_fieldNames().indexOf(t.get_logicalName())<0||Object(i.a)(this._record.fields[t.get_logicalName()]))&&e.indexOf(t.get_logicalName())<0&&(e[e.length]=t.get_logicalName());Object(r.e)("OfflineQueryData._GetDefaultFields",o.a.offlineDataStore,"Get default fields succeeded for entity "+this._entityMetadata.get_logicalName()),t.resolve(e)},e=>{Object(r.e)("OfflineQueryData._GetDefaultFields.Failed",o.a.offlineDataStore,"Get default fields failed for entity "+this._entityMetadata.get_logicalName()+" with error "+e.get_Message()),t.reject(e)})}return t}_isAttributeAvailable(e,t){for(const n of e)if(n.get_logicalName().toLowerCase()===t)return!0;return!1}_IsRegularActivity(){switch(this._entityMetadata.get_objectTypeCode()){case 4208:case 4209:case 4211:case 4206:case 4406:case 4251:return!1}return!!this._entityMetadata.get_activityTypeMask()}_PrepareActivityPartyRecord(e,t,n){const s=new E.a,l=t.getFieldObjectData(c.S);return v.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(new y.a(c.d,[c.B]),null).then(u=>{const d=u[0],p=t.hasField(c.e)&&t.getValue(c.e)!==a.a.get_empty()?t.getValue(c.e):a.a.newGuid();v.a.get_DefaultInstance().retrieveEntityMetadata(l[c.F].toString(),null).then(u=>{const g=[p.toString().toUpperCase(),n.toUpperCase(),this._record.get_identifier().Name,this._record.get_identifier().LogicalName,c.O[e].toString(),a.a.createFromObjectData(l[c.y]).toString().toUpperCase(),Object(i.a)(l[c.a])?"":l[c.a].toString(),l[c.F].toString(),!Object(i.a)(d)&&d.get_defaultValue()?"1":"0"];Object(r.e)("OfflineQueryData._PrepareActivityPartyRecord",o.a.offlineDataStore,"PrepareActivityPartyRecord succeeded"),s.resolve({entityreference:t.get_identifier(),columns:I._get_PartyColumns(),values:g})},e=>{Object(r.e)("OfflineQueryData._PrepareActivityPartyRecord.Failed",o.a.offlineDataStore,"PrepareActivityPartyRecord failed with error "+e.get_Message()),s.reject(e)})},e=>{Object(r.e)("OfflineQueryData._PrepareActivityPartyRecord.Failed",o.a.offlineDataStore,"PrepareActivityPartyRecord failed with error "+e.get_Message()),s.reject(e)}),s}_PreparePartiesToRetain(e,t,n){return{activityid:e,participationtypemask:c.O[n].toString(),resolvedparties:t}}static get_createDefaultValues(){return[c.p,c.o,c.M,c.I,c.H]}static get_defaultValues(){return[c.I,c.H]}static get_stateAndStatusFields(){return[c.W,c.X]}static _get_PartyColumns(){return[c.e,c.c+c.l+c.y,c.c+c.l+c.a,c.c+c.l+c.F,c.P,c.S+c.l+c.y,c.S+c.l+c.a,c.S+c.l+c.F,c.B]}static getOfflineQueryDataObject(e,t,n,a,s,c){const l=new E.a,u=new I(e,t,s,c);return u._IntializeQueryWithDefaultValues(s).then(t=>{!Object(i.a)(s)&&s.get_isActivity()?C.a.get_DefaultInstance().getExistingActivityParties(e).then(e=>{u.set_existingParties(e),u.setColumnsAndValues(n,a).then(e=>{Object(r.d)("OfflineQueryData_GetOfflineQueryDataObject",o.a.offlineDataStore,"GetOfflineQueryDataObject completed succesfully"),l.resolve(u)},e=>{Object(r.e)("OfflineQueryData_GetOfflineQueryDataObject.Failed",o.a.offlineDataStore,e.get_Message()),l.reject(e)})},e=>{Object(r.e)("OfflineQueryData_GetOfflineQueryDataObject.Failed",o.a.offlineDataStore,e.get_Message()),l.reject(e)}):(u.setColumnsAndValues(n,a).then(e=>{Object(r.d)("OfflineQueryData_GetOfflineQueryDataObject",o.a.offlineDataStore,"GetOfflineQueryDataObject completed succesfully"),l.resolve(u)},e=>{Object(r.e)("OfflineQueryData_GetOfflineQueryDataObject.Failed",o.a.offlineDataStore,e.get_Message()),l.reject(e)}),Object(r.d)("OfflineQueryData_GetOfflineQueryDataObject",o.a.offlineDataStore,"GetOfflineQueryDataObject completed succesfully"),l.resolve(u))},e=>{Object(r.e)("OfflineQueryData_GetOfflineQueryDataObject.Failed",o.a.offlineDataStore,e.get_Message()),l.reject(e)}),l}}},ZMWz:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="control.setlabel";function i(e,t,n,i){const o=Object(r.v)(n);return{type:a,payload:i,meta:{pageId:e,controlName:t,contextKey:o}}}},ZPAw:function(e,t,n){"use strict";n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return h}));var r=n("Nb1E"),a=n("LbMF"),i=n("qAG9"),o=n("qpML"),s=n("8nT0"),c=n("+pAH"),l=n("lY/Z"),u=n("iZ7K"),d=n("5Oca");function p(e,t,n,r){const a={fileProgress:n,operationType:o.a.Upload};return r&&(a.fileName=r.fileName,a.mimeType=r.mimeType,a.fileSize=r.fileSize),{type:c.a,payload:{identifier:e,attributeName:t,fileState:a}}}function g(e,t){return e.read().then(e=>e?Promise.resolve(e):null).catch(e=>(t.error("Failed to read next chunk"),Promise.reject(e)))}function h(e,t,n){return"file"===n?e.etn+"_FileAttachments":t+"id_imagedescriptor"}function f(e,t,n){const r={"Content-Type":"application/octet-stream"};return t&&(r["x-ms-transfer-mode"]="chunked"),n&&(r["Content-Range"]=n),r}function m(e,t,n){let r=`/${t}?x-ms-file-name=${e.fileName}`;return n&&(r=r+"&"+n),r}async function b(e,t,n,a,s,c,l,u){const h=m(t,n),b=f(0,!0),_=await s(Object(r.f)(a,"",h,b,!0));if(_&&200===_.status){const c=m(t,n,function(e,t){const n=Object(i.a)(e,"Location");if(n){const e=n.indexOf(t);return n.substring(e+t.length+1,n.length)}return null}(_.headers,h)),b=function(e,t){const n=Object(i.a)(e,"x-ms-chunk-size");return n?Number(n):(t.error("Server didn't return x-ms-chunk-size in headers, taking default value of 4 MB"),4194304)}(_.headers,l),O=t.getBinaryReader(b);let C=O.getCurrentIndex(),E=await g(O,l),I=Object(d.k)(e(),a,n),w="";for(u.push({name:"MaximumChunkSizePerUpload",value:b}),u.push({name:"UrlForChunkUploadRequest",value:c});!E.done&&I!==o.b.Cancelled;){const i=E.value;if(!i)return u.push({name:"FailureReason",value:"Next chunk is not present"}),u.push({name:"CurrentChunkIndex",value:C}),l.error("Chunk upload failed ",u),s(p(a,n,o.b.Failed)),Promise.reject(new Error("Next chunk is not present"));{const h=(y=C,v=C+i.length-1,S=t.fileSize,"bytes "+y.toString()+"-"+v.toString()+"/"+S.toString());w=w+"|"+h;const m=f(0,!1,h),b=await s(Object(r.f)(a,i,c,m,!0));if(!b||204!==b.status&&206!==b.status)return u.push({name:"HttpStatus",value:b.status}),u.push({name:"ChunkRange",value:h}),u.push({name:"FailureReason",value:"Chunk upload failed"}),l.error("Chunk upload failed ",u),s(p(a,n,o.b.Failed)),Promise.reject(new Error("chunk upload failed with http status = "+b.status));C=O.getCurrentIndex(),E=await g(O,l),I=Object(d.k)(e(),a,n)}}return u.push({name:"ChunkRange",value:w}),I===o.b.Cancelled?u.push({name:"UploadCancelled",value:!0}):s(p(a,n,o.b.Finished)),Promise.resolve()}var y,v,S;return s(p(a,n,o.b.Failed)),u.push({name:"FailureReason",value:"First call to server failed"}),l.error("Chunk upload failed ",u),Promise.reject(new Error("chunking upload failed"))}function _(e,t,n,a,i,s,c){const l=t.TraceManager.getTracer("UploadFile");e(p(s,i,o.b.InProgress,a));const u=function(e){return e.fileSize>16777216}(a);c.push({name:"IsChunkUpload",value:u});const d=c.slice();return l.warn("Starting upload of new file.",d),u?b(()=>n(),a,i,s,e,0,l,d).then(()=>(t.EventManager.ReportComponentSuccess("UploadFile",d),Promise.resolve())).catch(n=>(t.EventManager.ReportComponentFailure("UploadFile",n,"",d),e(p(s,i,o.b.Failed)),Promise.reject(n))):function(e,t,n,a,i,s){return t.getBinaryReader(t.fileSize).read().then(c=>{const l=f(0,!1),u=m(t,n),d=c.value,g=s.slice();return g.push({name:"UrlForSingleUploadRequest",value:u}),g.push({name:"ChunkValueLengthReadFromFile",value:d.length}),e(Object(r.f)(a,d,u,l,!0)).then(t=>t?204===t.status?(e(p(a,n,o.b.Finished)),Promise.resolve()):(e(p(a,n,o.b.Failed)),g.push({name:"HttpStatus",value:t.status}),g.push({name:"FailureReason",value:"Server returned non 204 response"}),i.error("Single chunk upload failed ",g),Promise.reject(new Error("Server returned non 204 response"))):(g.push({name:"FailureReason",value:"Upload response from server is null"}),i.error("Single chunk upload failed",g),e(p(a,n,o.b.Failed)),Promise.reject(new Error("Upload response from server is null")))).catch(t=>(g.push({name:"FailureReason",value:(null==t?void 0:t.message)||"Upload to server failed"}),g.push({name:"ErrorDetails",value:t}),i.error("Single chunk upload failed ",g),e(p(a,n,o.b.Failed)),Promise.reject(t)))}).catch(t=>{const r=s.slice();return r.push({name:"FailureReason",value:(null==t?void 0:t.message)||"Reading from file failed"}),r.push({name:"ErrorDetails",value:t}),i.error("Single chunk upload failed ",r),e(p(a,n,o.b.Failed)),Promise.reject(t)})}(e,a,i,s,l,d).then(()=>(t.EventManager.ReportComponentSuccess("UploadFile",d),Promise.resolve())).catch(n=>(d.push({name:"ErrorDetails",value:n}),t.EventManager.ReportComponentFailure("UploadFile",n,"",d),e(p(s,i,o.b.Failed)),Promise.reject(n)))}function y(e,t,n){return{type:"upload.file",execute({dispatch:r,getState:i},c){const g=c.TraceManager.getTracer("UploadFile"),f=[];return f.push({name:"FileSize",value:e.fileSize}),f.push({name:"MimeType",value:e.mimeType}),_(r,c,()=>i(),e,t,n,f).then(()=>{if(Object(d.k)(i(),n,t)===o.b.Cancelled)return g.warn("upload request was cancelled ",f),Promise.resolve(null);const e=Object(a.b)(t,n.etn,i()),c=h(n,t,e),p=function(e){let t=s.h;return"file"===e?[t,s.f,s.p,s.e,s.s,s.y]:(t=s.g,[t,s.f,s.p,s.i,s.k,s.m,s.l,s.b,s.o])}(e),m=function(e,t,n){let r=[];const i=Object(u.E)(e,t.etn);return r="file"===Object(a.b)(n,t.etn,e)?[i,n,n+"_name"]:[i],r}(i(),n,t),b=[];return b.push({navigationProperty:c,columnNames:p}),r(Object(l.d)(n,m,null,b)).then(()=>{const e=Object(d.x)(i(),n,c,t);return Promise.resolve(e)}).catch(e=>(f.push({name:"ErrorDetails",value:e}),g.error("upload request succeeded but retrieve record data failed ",f),Promise.resolve(null)))}).catch(e=>(g.error("upload request failed ",f),r(p(n,t,o.b.Failed)),Promise.reject(e)))}}}},ZUus:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.On=1]="On",e[e.Off=2]="Off",e[e.Entity=3]="Entity"}(r||(r={}))},ZePi:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.mobile="Mobile",e.outlook="Outlook",e.web="Web",e.unifiedServiceDesk="UnifiedServiceDesk"}(r||(r={}))},ZhaJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("nA3O"),a=n("/Ypj"),i=n("NMtn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class o extends r.a{constructor(){super(),this._callbackID=null,this._callContext=null,this._serialNumber=o._nextSerialNumber++,this._callbackID=Object.getType(this).getName()+this._serialNumber}get_callbackID(){return this._callbackID}get_callContext(){return this._callContext||(this._callContext=new a.a(null,null)),this._callContext}set_callContext(e){return this._callContext=e,e}callback(e){Object(i.b)(e,"args"),this.verifyArgs(e)&&this.call()}verifyArgs(e){return this.setValues(e),!0}}o._nextSerialNumber=0},Ziun:function(e,t,n){"use strict";n.d(t,"c",(function(){return U})),n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return F}));var r=n("nuS9"),a=n("4fxQ"),i=n("Afz2"),o=n("YWpA"),s=n("vTeb"),c=n("u+q+"),l=n("unFF"),u=n("VL4U"),d=n("wE9H"),p=n("LzVy"),g=n("sclX"),h=n("b8TU"),f=n("nJrx"),m=n("H/hG"),b=n("NjDY"),_=n("EY5k"),y=n("YxC/"),v=n("BM7Q"),S=n("GYEz"),O=n("FhVi"),C=n("Gilj"),E=n("3rse"),I=n("w1eR"),w=n("CXmn"),j=n("KOTC"),P=n("GWSs"),T=n("gxvI"),N=n("AVDU"),A=n("glAs"),D=n("IYuw"),R=n("tJ+6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const x=Object(f.a)(),M=Object(f.a)(),F=Object(f.a)();function k(e){return{backgroundColor:e.colors.SiteMap.NavigationBarMobile.Fill,height:e.sizes.NavBarHeightMobile}}const L={justifyContent:"flex-start",flexShrink:0};class B extends r.Component{constructor(e){super(e),this._appNameWidth=0,this._watermarkWidth=0,this._topBarWidth=0,this._leftWidth=0,this._rightWidth=0,this._onMeasureHandler=this._onMeasureHandler.bind(this),this.state={globalCommandBarSize:0,hideWatermark:!1},this.props.isPreviewOrg&&!Object(y.c)(e.resourceStrings,v.h)?e.retrieveResourceStrings([v.h]):this.props.isSandboxOrg&&!Object(y.c)(e.resourceStrings,v.i)&&e.retrieveResourceStrings([v.i]),this.props.showMooncakeBranding&&e.retrieveResourceStrings([v.d])}_onMeasureHandler(e){e>0&&this.state.globalCommandBarSize!==e&&this.setState({globalCommandBarSize:e})}_calculateElementsToHide(){const e=this._getWatermarkWidth(),t=this._getAppNameWidth();let n=!1,r=!1;if(t&&this._topBarWidth){const a=this._topBarWidth-this._leftWidth-this._rightWidth;a<t+e&&(r=!0,n=a<t),this.props.hideAppName!==n&&this.props.setHideAppNameInTopBar(n),this.state.hideWatermark!==r&&this.setState({hideWatermark:r})}}_getAppNameWidth(){if(!this._appNameWidth&&this._appNameRef){const e=a.findDOMNode(this._appNameRef);this._appNameWidth=e?e.offsetWidth:0}return this._appNameWidth}_getWatermarkWidth(){if(this._topBarWidth<960)return 48;const e=a.findDOMNode(this._watermarkRef);return!this._watermarkWidth&&e&&(this._watermarkWidth=e.offsetWidth),this._watermarkWidth||48}_renderTopBarMobileSize(e){const t=e?d.a.Mobile:d.a.BrowserMobileSize;return r.createElement(o.a,{id:"topBar-mobile",testhooks:{id:"topBar"},role:i.c,style:this.props.platformType===g.b.Native&&this.props.clientHost!==I.a.MailApp?k(this.props.theme):(n=this.props.theme,Object.assign(k(n),{color:n.colors.NavBar.NavBar1.Text,backgroundColor:n.colors.NavBar.NavBar1.Fill}))},r.createElement(s.a,{key:"focusMainPageContent",style:{position:"absolute",left:"-10000px"},accessibilityLabel:"Skip to main content",id:"focusMainPageContent",tabIndex:-1,onKeyDown:this._focusMainPageContentKeyDownHandler,onClick:this._focusMainPageContentClickHandler}),r.createElement(O.a,{key:"focusMainPageContentAccessibility",rootElementId:"focusMainPageContent",isModal:!1,shouldManageFocus:!1,waitForEditable:!1,keyboardShortcuts:this._createKeyboardShortcuts()}),this._renderGlobalCommandBar(t));var n}_renderTopBar(){const e=this.props.clientHost===I.a.MailApp,t=e?(n=this.props.theme,Object.assign(k(n),{color:n.colors.NavBar.NavBar1.Text,backgroundColor:n.colors.NavBar.NavBar1.Fill,justifyContent:"space-between"})):function(e){const{theme:t}=e,n=e.designLanguage,r=n?n.Components.AppHeader.BackgroundColor:t.colors.NavBar.NavBar1.Fill,a=n?n.Components.AppHeader.TextColor:t.colors.NavBar.NavBar1.Text;return{position:"relative",backgroundColor:r,justifyContent:"space-between",height:t.sizes.NavbarHeight,color:a,borderBottom:e.isEmbededTopBar2020Update?"1px solid "+t.colors.NavBar.NavBar3.Fill:void 0,boxSizing:"border-box"}}(this.props);var n;return r.createElement(o.a,{key:"topBar",style:t,testhooks:{id:"topBar"},role:i.c,isRequestedMeasuring:this.props.isSitemapRefresh,onMeasuring:e=>{this._topBarWidth=e,this._calculateElementsToHide()}},r.createElement(o.a,{style:L,key:"navbar-left-wrapper",id:x},r.createElement(o.a,{style:L,key:"navbar-left",isRequestedMeasuring:this.props.isSitemapRefresh,onMeasuring:e=>{this._leftWidth=e,this._calculateElementsToHide()}},this._renderOfficeWaffle(),this._renderSitemapToggleButton(e),this._renderDynamicsButton(),r.createElement(s.a,{key:"focusMainPageContent",style:{position:"absolute",left:"-10000px"},accessibilityLabel:"Skip to main content",id:"focusMainPageContent",tabIndex:-1,onKeyDown:this._focusMainPageContentKeyDownHandler,onClick:this._focusMainPageContentClickHandler}),r.createElement(O.a,{key:"focusMainPageContentAccessibility",rootElementId:"focusMainPageContent",isModal:!1,shouldManageFocus:!1,waitForEditable:!1,keyboardShortcuts:this._createKeyboardShortcuts()})),this._renderBreadCrumbBar()),this._renderGlobalSearchBox(),this._renderWatermark(),r.createElement(o.a,{key:"global-command-bar-wrapper",id:M,isRequestedMeasuring:!0,onMeasuring:this.props.isSitemapRefresh?e=>{this._rightWidth=e,this._calculateElementsToHide()}:this._onMeasureHandler},this._renderGlobalCommandBar(d.a.BrowserNormal)))}_renderGlobalCommandBar(e){return r.createElement(j.a,{key:"global-command-bar",loader:()=>Promise.all([n.e(0),n.e(4),n.e(7),n.e(66)]).then(n.bind(null,"jsLW")).then(e=>e.GlobalCommandBar),props:{cmdbarType:e}})}_renderSitemapToggleButton(e){if(!this.props.renderToggleButton)return null;const t=e?this.props.theme.sizes.NavBarHeightMobile:this.props.theme.sizes.NavbarHeight;return r.createElement(T.a,{hoverBackgroundColor:this.props.theme.colors.NavBar.NavBar2.Fill,iconColor:this.props.theme.colors.NavBar.NavBar1.Text,isHeaderButton:!0,overwriteStyle:{padding:0,height:t,width:t}})}_renderOfficeWaffle(){return this.props.renderWaffle?!this.props.isOfficeAppLauncherEnabled||this.props.isSoverignCloud?r.createElement(j.a,{key:"officeWaffle",loader:()=>n.e(91).then(n.bind(null,"fPgq")).then(e=>e.OfficeWaffle)}):r.createElement(j.a,{key:"officeAppLauncher",loader:()=>Promise.all([n.e(120),n.e(89)]).then(n.bind(null,"Byjr")).then(e=>e.OfficeAppLauncher)}):null}_renderDynamicsButton(){return this.props.isSitemapRefresh?!this.props.hideBrandName&&r.createElement(j.a,{key:"dynamicsOct2020",ref:e=>this._appNameRef=e,loader:()=>n.e(60).then(n.bind(null,"WbbL")).then(e=>e.DynamicsButtonOct2020)}):r.createElement(u.a,{key:"nav-button"})}_renderBreadCrumbBar(){return this.props.isSitemapRefresh?this.props.hideAppName?null:r.createElement(j.a,{key:"appNameBar",ref:e=>this._appNameRef=e,loader:()=>n.e(42).then(n.bind(null,"I53g")).then(e=>e.AppNameBar)}):r.createElement(j.a,{key:"breadCrumbBar",loader:()=>n.e(47).then(n.bind(null,"NLIC")).then(e=>e.BreadCrumbBar),props:{areaId:this.props.areaId,globalCommandBarSize:this.state.globalCommandBarSize}})}_renderGlobalSearchBox(){return this.props.isGlobalSearchEnabled?r.createElement(j.a,{key:"GlobalSearchContainer",loader:()=>Promise.all([n.e(2),n.e(64)]).then(n.bind(null,"SCqX")).then(e=>e.GlobalSearchContainer)}):null}_renderWatermark(){if(this.props.viewportWidth<960||this.state.hideWatermark)return null;let e=null;if(this.props.isPreviewOrg)e=Object(y.c)(this.props.resourceStrings,v.h);else{if(!this.props.isSandboxOrg)return null;e=Object(y.c)(this.props.resourceStrings,v.i)}return r.createElement(o.a,{id:F,key:"navbar-watermark",ref:e=>this._watermarkRef=e},r.createElement(m.a,{style:(t=this.props.theme,n=this.props.designLanguage,{color:n?n.Components.AppHeader.TextColor:t.colors.NavBar.NavBar1.Text,fontFamily:t.fontFamilies.Semilight,fontSize:"40px",lineHeight:"44px",paddingLeft:t.sizes.Measures.Measure100,paddingRight:t.sizes.Measures.Measure100,whiteSpace:"nowrap"})},e));var t,n}render(){return this.props.useMobileHeader?this._renderTopBarMobileSize(this.props.useThemedMobileHeader):this._renderTopBar()}_createKeyboardShortcuts(){const e=this._focusMainPageContentShortcutHandler.bind(this),t=[],n=new C.a([E.a.Ctrl,E.a.OpenBracket],e,!0,"","");return t.push(n),t}_focusMainPageContentShortcutHandler(e){const t=e.EVENT;t.ctrlKey&&t.keyCode===E.a.OpenBracket&&!this.props.getIsDialogOpen()&&(document.getElementById("mainContent").focus(),t.stopPropagation())}_focusMainPageContentKeyDownHandler(e){switch(e.keyCode){case E.a.Enter:case E.a.Space:document.getElementById("mainContent").focus(),e.stopPropagation()}}_focusMainPageContentClickHandler(e){document.getElementById("mainContent").focus(),e.stopPropagation(),e.preventDefault()}}const U=Object(c.a)((function(){const e=Object(y.h)();return function(t,n){const r=Object(l.a)(t),a=Object(R.b)(t)?Object(R.a)(t):null,i=Object(p.a)(t),o=Object(h.c)(t),s=Object(b.o)(t),c=Object(b.p)(t),u=e(t,v.e),d=Object(w.b)(t),g=Object(S.a)(t),f=Object(w.k)(t),m=Object(P.f)(t),_=Object(w.i)(t),y=Object(w.l)(t),O=Object(w.n)(t),C=Object(w.j)(t),E=Object(b.q)(t),I=Object(N.b)(t),j=Object(w.c)(t);return{theme:r,designLanguage:a,platformType:i,viewportWidth:o,isPreviewOrg:s,isSandboxOrg:c,resourceStrings:u,clientHost:g,showMooncakeBranding:f,isOfficeAppLauncherEnabled:m,renderToggleButton:_,useMobileHeader:y,useThemedMobileHeader:O,renderWaffle:C,isSoverignCloud:E,isEmbededTopBar2020Update:d,isSitemapRefresh:I,hideBrandName:Object(w.e)(t),hideAppName:Object(w.d)(t)||Object(A.a)(t),isGlobalSearchEnabled:j}}}),(function(e,t){return{retrieveResourceStrings:t=>e(Object(_.e)(t)),setHideAppNameInTopBar:t=>e(Object(D.b)(t))}}))(B)},Zn5P:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s}));const r="indicator.notification.add",a="indicator.notification.remove";let i=0;function o(e){return{type:r,payload:{id:"indicatorId-"+i++,type:e}}}function s(e){return{type:a,payload:e}}},Znul:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t,n,r,a,i){this.LookupEntityByName=e,this.EntityAndAttribute=t,this.AppId=n,this.RelatedRecordId=r,this.QueryString=a,this.ReturnMetadata=i}getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{LookupEntityByName:{typeName:"mscrm.LookupEntityInfo",structuralProperty:4},EntityAndAttribute:{typeName:"Microsoft.Dynamics.CRM.EntityAndAttribute",structuralProperty:2},AppId:{typeName:"Edm.Guid",structuralProperty:1},RelatedRecordId:{typeName:"Edm.Guid",structuralProperty:1},QueryString:{typeName:"Edm.String",structuralProperty:1},ReturnMetadata:{typeName:"Edm.Boolean",structuralProperty:1}}}}}},ZoNW:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){if(!(t&&t.length&&e&&e.metadata&&e.metadata.labels))return[];const n=e.metadata.labels,r=[];for(let e=0;e<t.length;e++){const a=t[e].split(":",2);n[a[0]]&&n[a[0]][a[1]]||r.push(t[e])}return r}n.d(t,"a",(function(){return r}))},"Zpd/":function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var r=n("jRy5"),a=n("dHD5"),i=n("ApeL"),o=n("i1f0"),s=n("wL2W"),c=n("4aOd"),l=n("pEXn"),u=n("tWr6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d="control.disabled";function p(e,t,n,p){return{type:"control.disabled.sync",sync:!0,execute({dispatch:g,getState:h},f){var m;const b=h();if(n&&n.contextTokenType&&n.contextTokenType===r.a.GridRow)g(Object(i.c)(e,n,t,p));else if(g(function(e,t,n,r,i){if(!Object(o.Xc)(e,t,r)){const e=Object(a.v)(r);return{type:d,payload:i,meta:{pageId:t,controlName:n,contextKey:e}}}return{type:null,payload:null,meta:null}}(b,e,t,n,p)),Object(s.a)()){const r=h(),a={id:e,controlName:t},i=null===(m=null==f?void 0:f.TraceManager)||void 0===m?void 0:m.getTracer(`${l.k}${l.j}`),s=Object(o.t)(b,a,n),d=Object(o.t)(r,a,n),g=Object(u.a)(b,e);g.push({name:"controlName",value:t}),g.push({name:"controlLabel",value:Object(o.w)(r,a,n)}),g.push({name:"disabled state before change",value:null==s?void 0:s.toString()}),g.push({name:"intended disabled state",value:null==p?void 0:p.toString()}),g.push({name:"disabled state after change",value:null==d?void 0:d.toString()}),g.push({name:"callstack",value:new c.a(new Error).getStackTrace()}),null==i||i.warn(l.n,[{name:l.v,value:l.j+".disabled"},{name:l.j,value:JSON.stringify(g)}])}}}}},ZuxC:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return s}));var r=n("MktZ"),a=n("f/sd"),i=n("9eA9"),o=n("D+Bz");const s="LastNavigatedPageKey",c="page.initialize";function l(e,t,n=!1,l=null,u=o.b.Other){return{type:"page.initialize.async",execute({dispatch:d},p){const g=e.getId(),h=e.getName();d(Object(r.b)(g,a.a.Loading)),d(function(e,t,n,r,a=o.b.Other){return{type:c,payload:{input:e,__pageName:t,isDialogStatus:r},meta:{pageId:n,source:a}}}(t,h,g,n,u));const f=d(e.getInitializationAction(l));return f.then(()=>{if(h&&t){const e=p.Router.createUrlForPage(h,t),n=e&&new i.a(e);if(n&&function(e,t){if("EditForm"===e&&t.searchParams.get("id"))return!0;if("Dashboard"===e||"Search"===e||"WebResource"===e||"EntityList"===e||"Control"===e)return!0;return!1}(h,n)){const t=n.searchParams.get("appid"),r=p.DataSource;if(t&&r){const n={};n[t]=e,r.saveSessionState(s,n,!0)}}}else p.TraceManager.getTracer("Router.Actions.InitializePage").error("Failed to save URL",[{name:"pageName",value:h},{name:"input.pageType",value:t?t.pageType||"undefined pageType":"null input"}])},()=>{}),f.then(()=>({status:0,pageId:g}))}}}},Zvo8:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t,n,r,a=2){let i="";if(n){const e=new Date;e.setTime(e.getTime()+24*n*60*60*1e3),i="; expires="+e.toUTCString()}else i="";let o=e+"="+t+i+"; path=/";r&&(o+=" ;domain="+r);const s=window.location.protocol.startsWith("https");0===a?o+=" ;SameSite=None;Secure":2===a?(o+=" ;SameSite=Lax",s&&(o+=";Secure")):1===a&&(o+=" ;SameSite=Strict",s&&(o+=";Secure")),document.cookie=o}function a(e){const t=e+"=",n=document.cookie.split(";");for(let e=0;e<n.length;e++){let r=n[e];for(;" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null}function i(e,t){r(e,"",-1,t)}n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}))},"Zz+h":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"b",(function(){return d}));var r=n("arV0"),a=n("y60j"),i=n("hIjC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t){const n=Object(r.g)(e,t.id),o=Object(i.a)(e,n.uniqueName);return o&&o.formId?Object(a.j)(e,o.formId):null}function s(e,t){const{dialogOptions:n}=Object(r.g)(e,t.id);return n}function c(e,t){const{uniqueName:n}=Object(r.g)(e,t.id);return n}function l(e,t){return"inline"===u(e,t)}function u(e,t){const n=Object(r.g)(e,t);return n&&n.dialogOptions&&n.dialogOptions.windowPosition?n.dialogOptions.windowPosition:n&&"inlinedialog"===n.pageType?"inline":"center"}function d(e,t){const n=Object(i.a)(e,t),r=n&&n.formId,o=Object(a.j)(e,r);return o?o.Label:""}},a1q1:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("NMtn");class a{constructor(e){this._resultsList=null,Object(r.d)(e,"entities"),this._resultsList=e}get_resultsList(){return this._resultsList}static createFromEntities(e){return new a(e)}}},a475:function(e,t,n){"use strict";n.d(t,"a",(function(){return ve}));var r,a,i=n("Yb4o"),o=n("kToj");!function(e){e[e.created=0]="created",e[e.submitted=1]="submitted",e[e.executing=2]="executing",e[e.completed=3]="completed"}(r||(r={})),function(e){e[e.submitted=1]="submitted",e[e.executing=2]="executing",e[e.succeeded=3]="succeeded",e[e.failed=4]="failed"}(a||(a={}));var s,c=n("XjOj"),l=n("Div0"),u=n("8uvO");!function(e){e[e.synchronous=0]="synchronous",e[e.asynchronous=1]="asynchronous"}(s||(s={}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class d extends i.a{constructor(){super(),this._name=null,this._baseName=null,this._completionCallback=null,this._error=null,this._serialNumber=d._nextSerialNumber++,this._baseName=Object.getType(this).getName(),this._name=this._baseName+" "+this.get_serialNumber()}get_name(){return this._name}get_baseName(){return this._baseName}get_serialNumber(){return this._serialNumber}get_state(){return this.getValue(d._stateProperty)}_set_state(e){return this.setValue(d._stateProperty,e),e}get_isUsingExclusiveChannel(){return!1}get_instrumentationContext(){return""}internalSubmit(){Object(o.a)(!this.get_state(),this.get_name()+" can only be submitted once."),this._set_state(r.submitted),this.onSubmitted()}internalExecute(e){Object(o.a)(this.get_state()===r.submitted,this.get_name()+" can only be executed once.");let t=null,n=s.synchronous;try{this._completionCallback=e,this._set_state(r.executing),this.instrument(a.executing),n=this.onExecute()}catch(e){throw Object(c.d)(l.a.actions,"Action execution failed. Error: {0}",e),t=e,e}finally{n===s.synchronous&&this.get_state()!==r.completed&&this.complete(t)}}complete(e){Object(o.a)(this.get_state()===r.submitted&&!!e||this.get_state()===r.executing,this.get_name()+" cannot call complete in the current state.");try{try{this._error=e,this._ReportSuccessOrFailure()}finally{this._ReportCompletion()}}finally{this.instrument(e?a.failed:a.succeeded),this._InvokeCompletionCallback()}}onSubmitted(){}onError(){}instrument(e){Object(c.g)(l.a.actions,"Excuting action,name={0},id={1},state={2},context={3}",this.get_baseName(),this.get_serialNumber(),e,this.get_instrumentationContext())}_InvokeCompletionCallback(){try{this._completionCallback&&this._completionCallback()}finally{this._completionCallback=()=>{d._SentinelCompletionCallback(this.get_name())}}}_ReportSuccessOrFailure(){this._error&&this._ReportFailure()}_ReportFailure(){try{this.onError()}finally{}}_ReportCompletion(){try{this._set_state(r.completed)}finally{}}static _SentinelCompletionCallback(e){throw Error.invalidOperation(e+" cannot try to call the completion callback twice.")}}d._stateProperty=new u.a("State",r,d,0),d._nextSerialNumber=0;var p=n("/Ypj"),g=n("NMtn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class h extends d{constructor(e,t,n,r,a,i,o){super(),Object(g.c)(e,"key"),Object(g.c)(t,"namespaceName"),Object(g.c)(n,"version"),Object(g.c)(r,"method"),Object(g.b)(a,"args"),Object(g.b)(i,"callbacks"),this._key=e,this._namespaceName=t,this._version=n,this._method=r,this._args=a,this._callbacks=i,this._callContext=o}get_key(){return this._key}get_namespaceName(){return this._namespaceName}get_version(){return this._version}get_method(){return this._method}get_args(){return this._args}get_callbacks(){return this._callbacks}get_callContext(){return this._callContext||(this._callContext=new p.a(null,null)),this._callContext}onExecute(){return this.call(),s.synchronous}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class f{constructor(e,t,n){this.source=t,this.action=n,this.traceComponent=e}}var m=n("Hswk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class b{constructor(e,t){this._quantaSize=0,this._timeoutInterval=0,this._callbackHandle=0,this._taskQueue=[],this._quantaSize=e,this._timeoutInterval=t}queueTask(e,t,n,r){const a=new f(e,t,n);this._taskQueue.push(a),r||this._SetQuantaCallback()}_RunForQuanta(){this._callbackHandle=0;const e=new Date;let t=0;for(;this._taskQueue.length>0&&t<this._quantaSize;){const n=this._taskQueue.shift();b._ExecuteTask(n),t=(new Date).getTime()-e.getTime()}this._taskQueue.length>0&&this._SetQuantaCallback()}_SetQuantaCallback(){this._callbackHandle||(this._timeoutInterval<0?this._RunForQuanta():this._callbackHandle=b.queueTimerCallback(l.a.taskRunner,b._RunForQuantaTaskName,Object(m.a)(this,this._RunForQuanta,"RunForQuanta"),this._timeoutInterval))}static get_instance(){return b._instance||(b._instance=new b(50,0)),b._instance}static queueTimerCallback(e,t,n,r){return window.setTimeout(()=>{b._ExecuteTask(new f(e,t,n))},r)}static _ExecuteTask(e){const t=new Date;!function(e,t,n){try{n()}catch(n){Object(c.e)(e,n,"Exception context: {0}",t)}}(e.traceComponent,e.source,e.action);const n=new Date;e.source!==b._RunForQuantaTaskName&&n.getTime()-t.getTime()>50&&Object(c.f)(e.traceComponent,"Task {0} took too long ({1}ms) to complete",e.source,n.getTime()-t.getTime())}}b._RunForQuantaTaskName="TaskRunner._RunForQuanta",b._instance=null;class _{constructor(){this._hasScheduledAction=!1,this._isExecutingActionOnExclusiveChannel=!1,this._name=null,this._actionSubmitted=null,this._nonQueuedActionsPending=0,this._queue=[],this._serialNumber=_._nextSerialNumber++,this._name="Action Manager "+this._serialNumber}get_name(){return this._name}submit(e){const t=e instanceof h?e:null;this.logNativeCallActionPerfData(t,"ActionManager.Submit.Start"),this.logNativeCallActionPerfData(t,"ActionManager.InternalSubmit.Start"),e.internalSubmit(),this.logNativeCallActionPerfData(t,"ActionManager.InternalSubmit.End"),this._actionSubmitted&&(this.logNativeCallActionPerfData(t,"ActionManager.actionSubmitted.Start"),this._actionSubmitted(e),this.logNativeCallActionPerfData(t,"ActionManager.actionSubmitted.End")),this.logNativeCallActionPerfData(t,"ActionManager.ScheduleNextAction.Start"),Object(c.f)(l.a.actions,"{0} enqueued {1}",this.get_name(),e.get_name()),this._queue.push(e),this._ScheduleNextAction(),this.logNativeCallActionPerfData(t,"ActionManager.ScheduleNextAction.End"),this.logNativeCallActionPerfData(t,"ActionManager.Submit.End")}logNativeCallActionPerfData(e,t){e&&e.get_callContext().logPerfData(t,(new Date).getTime())}executeAction(e,t){Object(c.f)(l.a.actions,"{0} is executing {1}",this.get_name(),e.get_name()),t||this._nonQueuedActionsPending++,this._ExecuteActionInternal(e,t)}_ExecuteActionInternal(e,t){e.internalExecute(()=>{Object(c.f)(l.a.actions,"{0} finished executing {1}",this.get_name(),e.get_name()),this._isExecutingActionOnExclusiveChannel=!1,t?this._ScheduleNextAction():(this._nonQueuedActionsPending--,this._CheckAllActionsComplete())})}_ScheduleNextAction(){if(this._hasScheduledAction||this._isExecutingActionOnExclusiveChannel)return;if(!this._queue.length)return void this._CheckAllActionsComplete();const e=this._queue[0];e.get_isUsingExclusiveChannel()?(Object(c.i)(l.a.actions,"{0} scheduled {1} with timeout 0",this.get_name(),e.get_name()),this._hasScheduledAction||b.queueTimerCallback(l.a.actions,"Process"+e.get_name(),Object(m.a)(this,this._ProcessNextAction,"ProcessNextAction"),0)):(Object(c.i)(l.a.actions,"{0} scheduled {1} into action queue",this.get_name(),e.get_name()),this._hasScheduledAction||b.get_instance().queueTask(l.a.actions,"Process"+e.get_name(),Object(m.a)(this,this._ProcessNextAction,"ProcessNextAction"))),this._hasScheduledAction=!0}_ProcessNextAction(){this._hasScheduledAction=!1,Object(o.a)(this._queue.length>0,this.get_name()+" must not try to process an empty queue.");const e=this._queue.shift();this._isExecutingActionOnExclusiveChannel=e.get_isUsingExclusiveChannel(),this.executeAction(e,!0)}_CheckAllActionsComplete(){this._queue.length||this._nonQueuedActionsPending||(Object(c.i)(l.a.actions,"{0} has no more actions to process.",this.get_name()),$(window).triggerHandler(_._allActionsCompleteEventName))}}_._allActionsCompleteEventName="OnActionQueueEmpty",_._nextSerialNumber=0;function y(e,t){let n=null;try{n=JSON.parse(e)}catch(r){Object(c.i)(l.a.framework,"JSON parse failed: {0}",r.message);const a=function(e){const t=new RegExp("[---\u2028--\ufeff-]","g");if(t.test(e))return e.replace(t,v);return e}(e);if(a!==e){Object(c.i)(l.a.framework,"JSON response needed to be encoded due to unescaped Unicode content. Will try to parse again."),e=a;try{n=JSON.parse(e),r=null}catch(e){Object(c.f)(l.a.framework,"JSON parse failed again. Error: {0}.",e.message)}}r&&t(r)}return n}function v(e){const t=e.charCodeAt(0).toString(16);return"\\u0000".substring(0,6-t.length)+t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class S{constructor(e,t){this.deviceStateJson=null,this.nativeCallKey=null,this.nativeCallKey=e,this.deviceStateJson=t}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class O extends h{call(){this.get_callContext().logPerfData("JavaInterfaceNativeCallAction.Call.Start",(new Date).getTime()),this.get_callContext().logPerfData(p.a.get_shimDispatcherPerfDataPlaceHolderName(),""),this.get_callContext().get_callId()&&""!==this.get_callContext().get_callId()&&(this.get_args()[p.a.get_dispatcherCallIdName()]=this.get_callContext().get_callId()),PALJavaScriptInterface.callMethod(this.get_key(),this.get_namespaceName(),this.get_method(),this.get_version(),JSON.stringify(this.get_args()),JSON.stringify(this.get_callbacks())),this.get_callContext().logPerfData("JavaInterfaceNativeCallAction.Call.End",(new Date).getTime())}}var C=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class E extends h{constructor(e,t,n,r,a,i,o){super(e,t,n,r,a,i,o),Object(C.b)(o.get_callId())||(this.get_args()[p.a.get_dispatcherCallIdName()]=o.get_callId())}get_isUsingExclusiveChannel(){return!0}get_instrumentationContext(){return this.get_method()}call(){const e=this.generateUrl();this.get_callContext().logPerfData("WindowLocationNativeCallAction.Call.Start",(new Date).getTime()),this.get_callContext().logPerfData(p.a.get_shimDispatcherPerfDataPlaceHolderName(),""),this.loadUrl(e),this.get_callContext().logPerfData("WindowLocationNativeCallAction.Call.End",(new Date).getTime())}generateUrl(){return String.format(E._urlCallFormat,encodeURIComponent(this.get_key()),encodeURIComponent(this.get_namespaceName()),encodeURIComponent(this.get_method()),encodeURIComponent(this.get_version()),encodeURIComponent(JSON.stringify(this.get_args())),encodeURIComponent(JSON.stringify(this.get_callbacks())))}loadUrl(e){window.location.href=e}}E._urlCallFormat="http://pal/?k={0}&n={1}&m={2}&v={3}&a={4}&c={5}";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class I extends E{constructor(e,t,n,r,a,i,o){super(e,t,n,r,{},i,o),Object(g.b)(a,"args"),this._pullArgsId=this.get_name(),Object(C.b)(o.get_callId())||(a[p.a.get_dispatcherCallIdName()]=o.get_callId()),I._pullArgsMapping[this._pullArgsId]=a}get_pullArgsId(){return this._pullArgsId}generateUrl(){const e=super.generateUrl();return String.format(I._pushToPullUrlCallFormat,e,encodeURIComponent(this._pullArgsId))}static pullArgs(e){const t=I._pullArgsMapping[e];if(!t){const t=String.format("Couldn't find pull args matching id '{0}'",e);throw Object(c.d)(l.a.PAL,t),Error.invalidOperation(t)}return delete I._pullArgsMapping[e],t}}I._pushToPullUrlCallFormat="{0}&p={1}",I._pullArgsMapping={};var w=n("DRVD"),j=n.n(w);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class P{constructor(){this.webViewMessageEventHandler=null,this.webViewMessageEventHandler=Object(m.a)(this,this.webViewMessageHandler,"webViewMessageHandler"),window.addEventListener("message",Object(m.a)(this,this.postMessageHandler,"postMessageHandler"),!1)}_createPerfMarker(e,t,n){let r=e;const a="deviceEvent"===e,i=Object(C.b)(t[0])?"":t[0],o=Object(C.b)(t[1])?"":t[1];if(a&&"Application"===i&&"ReportPerformance"===o)return;"deviceReady"!==e&&(Object(C.b)(i)||(r+="."+i),Object(C.b)(o)||"deviceCallback"===e||(r+="."+o));const s=(new Date).getTime()-n;j.a.createEvent("PostMessage."+r,"PAL").createRetroactiveStopwatch(window.performance.now()-s,s)}webViewMessageHandler(e){this.messageHandlerInternal(e)}postMessageHandler(e){const t=e,n=t.origin.toLowerCase();let r="";if(!Object(C.a)(window.location)){const e=window.location.port;r=window.location.protocol+"//"+window.location.hostname,Object(C.a)(e)||""===e||(r+=":"+e)}if("ms-appx://microsoft.microsoftdynamicscrm"!==n&&"ms-appx://microsoft.microsoftdynamicscrmforwindows8.1"!==n&&"ms-appx://microsoft.microsoftdynamicscrmforwindows10"!==n&&n!==r.toLowerCase())return;if("object"==typeof t.data)return;if(!isNaN(t.data))return;const a=t.data;if(Object(C.a)(a)||""===a||a.startsWith("ms.rx.schedule"))return;try{if("PALNativeBridge"!==JSON.parse(a).target)return}catch(e){return}e.stopImmediatePropagation(),this.messageHandlerInternal(a)}messageHandlerInternal(e){let t;try{t=JSON.parse(e)}catch(e){return void Object(c.e)(l.a.PAL,e,"Failed to parse message")}if("PALNativeBridge"!==t.target)return;const n=t.functionName,r=t.functionArguments,a=t.timestamp;switch(Object(C.a)(a)||this._createPerfMarker(n,Object(C.a)(r)?[]:r,a),n){case"prepareStates":return void PALNativeBridge.prepareStates(e);case"clientReady":return void PALNativeBridge.clientReady(e);case"deviceReady":return void ve.get_Instance().deviceReady(r[0],r[1]);case"deviceActive":return void ve.get_Instance().deviceActive();case"deviceInactive":return void ve.get_Instance().deviceInactive();case"deviceResume":return void ve.get_Instance().deviceResume();case"devicePause":return void ve.get_Instance().devicePause();case"deviceCallback":return void ve.get_Instance().deviceCallback(r[0],r[1],r[2]);case"deviceUnregisterCallback":return void ve.get_Instance().deviceUnregisterCallback(r[0]);case"deviceEvent":return void ve.get_Instance().deviceEvent(r[0],r[1],r[2]);case"devicePullArgs":return void ve.get_Instance().devicePullArgs(r[0]);case"deviceSearch":return void ve.get_Instance().deviceSearch(r[0]);case"voiceCommand":return void ve.get_Instance().voiceCommand(r[0]);case"tileActivation":return void ve.get_Instance().tileActivation(r[0]);case"appLink":return void ve.get_Instance().appLink(r[0]);default:return void Object(c.d)(l.a.PAL,"Attempting to call unknown method: {0}",n)}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class T extends h{constructor(e,t,n,r,a,i,s,c,l){super(e,t,n,r,a,i,l),Object(o.a)(!Object(C.b)(s),"applicationName should not be NullOrEmpty"),Object(o.a)(!Object(C.b)(c),"protocol should not be NullOrEmpty"),this._applicationName=s,this._protocol=c}call(){this.get_callContext().logPerfData("WindowMessageNativeCall.Call.Start",(new Date).getTime()),this.get_callContext().logPerfData(p.a.get_shimDispatcherPerfDataPlaceHolderName(),""),this.get_callContext().get_callId()&&""!==this.get_callContext().get_callId()&&(this.get_args()[p.a.get_dispatcherCallIdName()]=this.get_callContext().get_callId());const e=this.generateMessage();this.callInternal(e),this.get_callContext().logPerfData("WindowMessageNativeCall.Call.End",(new Date).getTime())}callInternal(e){const t=this._protocol+"//"+this._applicationName.toLowerCase(),n=e+"&t="+Date.now();window.parent.postMessage(n,t)}generateMessage(){return String.format(T._urlCallFormat,encodeURIComponent(this.get_key()),encodeURIComponent(this.get_namespaceName()),encodeURIComponent(this.get_method()),encodeURIComponent(this.get_version()),encodeURIComponent(JSON.stringify(this.get_args())),encodeURIComponent(JSON.stringify(this.get_callbacks())))}}T._urlCallFormat="http://pal/?k={0}&n={1}&m={2}&v={3}&a={4}&c={5}";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class N extends T{callInternal(e){window.self.appSharedObject.sendMessageToApp(e)}generateMessage(){return{k:this.get_key(),n:this.get_namespaceName(),m:this.get_method(),v:this.get_version(),a:JSON.stringify(this.get_args()),c:JSON.stringify(this.get_callbacks())}}}var A,D=n("EbwQ"),R=n("sJUk"),x=n("ZhaJ");!function(e){e[e.unexpecteD_ERROR=-1]="unexpecteD_ERROR",e[e.invaliD_CREDENTIALS=1]="invaliD_CREDENTIALS",e[e.invaliD_ENDPOINT=2]="invaliD_ENDPOINT",e[e.credentialS_REJECTED_BY_SERVER=3]="credentialS_REJECTED_BY_SERVER",e[e.unexpecteD_SERVER_RESPONSE=4]="unexpecteD_SERVER_RESPONSE",e[e.missinG_REQUIRED_COOKIES=5]="missinG_REQUIRED_COOKIES",e[e.connectioN_INIT_FAILED=6]="connectioN_INIT_FAILED",e[e.unknowN_AUTH_METHOD=7]="unknowN_AUTH_METHOD",e[e.unsupporteD_AUTH_METHOD=8]="unsupporteD_AUTH_METHOD"}(A||(A={}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class M extends x.a{constructor(e){super(),this._onAuthenticateFailure=null,this._onAuthenticateFailure=e}_get_Error(){return this.getValue(M._errorProperty)}call(){this._onAuthenticateFailure(this._get_Error())}}M._errorProperty=new u.a("error",A,M);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class F extends x.a{constructor(e){super(),this._onAuthenticateSuccess=null,this._onAuthenticateSuccess=e}call(){this._onAuthenticateSuccess()}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class k extends R.a{constructor(e,t){super(),this.setValue(k._onAuthenticateSuccessProperty,new F(e)),this.setValue(k._onAuthenticateFailureProperty,new M(t))}get_methodName(){return"authenticate"}}k._onAuthenticateSuccessProperty=new u.a("onAuthenticateSuccess",F,k),k._onAuthenticateFailureProperty=new u.a("onAuthenticateFailure",M,k);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class L extends x.a{constructor(e){super(),this._onBeginSecureSessionForResourceResponse=null,this._onBeginSecureSessionForResourceResponse=e}get_beginSecureSessionResponseCode(){return this.getValue(L._BeginSecureSessionForResourceResponseCode)}get_beginSecureSessionExpiresOn(){return this.getValue(L._BeginSecureSessionForResourceExpiresOn)}call(){this._onBeginSecureSessionForResourceResponse(this.get_beginSecureSessionResponseCode(),this.get_beginSecureSessionExpiresOn())}}L._BeginSecureSessionForResourceResponseCode=new u.a("responseCode",Number,L),L._BeginSecureSessionForResourceExpiresOn=new u.a("expiresOn",String,L);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class B extends R.a{constructor(e,t,n,r){super(),this.setValue(B._resource,e),this.setValue(B._cookieName,t),this.setValue(B._cookieDomain,n),this.setValue(B._onBeginSecureSessionForResourceResponse,new L(r))}get_methodName(){return"beginSecureSessionForResource"}}B._resource=new u.a("resource",String,B),B._cookieName=new u.a("cookieName",String,B),B._cookieDomain=new u.a("cookieDomain",String,B),B._onBeginSecureSessionForResourceResponse=new u.a("onBeginSecureSessionForResourceResponse",L,B);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class U extends R.a{get_methodName(){return"reconfigure"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class V extends x.a{constructor(e){super(),this._onRequestSecurityTokenResponse=null,this._onRequestSecurityTokenResponse=e}get_requestSecurityTokenResponse(){return this.getValue(V._RequestSecurityTokenResponseProperty)}get_status(){return this.getValue(V._StatusProperty)}get_errorCode(){return this.getValue(V._ErrorCodeProperty)}get_errorDescription(){return this.getValue(V._ErrorDescriptionProperty)}get_isAutoSignInResponse(){return this.getValue(V._IsAutoSignInProperty)}call(){this._onRequestSecurityTokenResponse(this.get_requestSecurityTokenResponse(),this.get_status(),this.get_errorCode(),this.get_errorDescription(),this.get_isAutoSignInResponse())}}V._RequestSecurityTokenResponseProperty=new u.a("requestSecurityTokenResponse",String,V),V._StatusProperty=new u.a("status",Number,V),V._ErrorCodeProperty=new u.a("errorCode",String,V),V._ErrorDescriptionProperty=new u.a("errorDescription",String,V),V._IsAutoSignInProperty=new u.a("isAutoSignIn",Boolean,V);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class z extends R.a{constructor(e,t){super(),this.setValue(z._ExpiredTokenProperty,e),this.setValue(z._onRequestSecurityTokenResponseProperty,new V(t))}get_methodName(){return"requestSecurityToken"}}z._ExpiredTokenProperty=new u.a("refreshToken",Boolean,z),z._onRequestSecurityTokenResponseProperty=new u.a("onRequestSecurityTokenResponse",V,z);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class W extends R.a{get_methodName(){return"signOut"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class q extends R.a{constructor(e,t,n,r){super(),this.setValue(q._resource,e),this.setValue(q._cookieName,t),this.setValue(q._cookieDomain,n),this.setValue(q._onbeginSecureSessionForResourceWithPromptResponse,new L(r))}get_methodName(){return"beginSecureSessionForResourceWithPrompt"}}q._resource=new u.a("resource",String,q),q._cookieName=new u.a("cookieName",String,q),q._cookieDomain=new u.a("cookieDomain",String,q),q._onbeginSecureSessionForResourceWithPromptResponse=new u.a("onBeginSecureSessionForResourceResponse",L,q);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class H extends R.a{constructor(e,t,n,r,a){super(),this.setValue(H._options,e),this.setValue(H._origin,t),this.setValue(H._cookieName,n),this.setValue(H._cookieDomain,r),this.setValue(H._onBeginSecureSessionForAuthFlowResponse,new L(a))}get_methodName(){return"beginSecureSessionForAuthFlow"}}H._options=new u.a("options",Object,H),H._origin=new u.a("origin",String,H),H._cookieName=new u.a("cookieName",String,H),H._cookieDomain=new u.a("cookieDomain",String,H),H._onBeginSecureSessionForAuthFlowResponse=new u.a("onBeginSecureSessionForAuthFlowResponse",L,H);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class G extends D.a{get_namespaceName(){return"Account"}authenticate(e,t){Object(g.b)(e,"onAuthenticateSuccess"),Object(g.b)(t,"onAuthenticateFailure");const n=new k(e,t);this.callNativeMethod(this.get_version().get_currentVersion(),n)}requestSecurityToken(e,t){const n=new z(e,t);this.callNativeMethod(this.get_version().get_currentVersion(),n)}beginSecureSessionForAuthFlow(e,t,n,r,a){const i=new H(e,t,n,r,a);this.callNativeMethod(this.get_version().get_currentVersion(),i)}beginSecureSessionForResource(e,t,n,r){const a=new B(e,t,n,r);this.callNativeMethod(this.get_version().get_currentVersion(),a)}beginSecureSessionForResourceWithPrompt(e,t,n,r){const a=new q(e,t,n,r);this.callNativeMethod(this.get_version().get_currentVersion(),a)}signOut(){const e=new W;this.callNativeMethod(this.get_version().get_currentVersion(),e)}reconfigure(){const e=new U;this.callNativeMethod(this.get_version().get_currentVersion(),e)}}var K=n("cxnf"),Q=n("pNM1");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let X=Q.a.Info;function Y(e){return X=e,e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class J extends R.a{constructor(e,t){super(),this.setValue(J._DeviceErrorActionProperty,e),this.setValue(J._ErrorDetailsProperty,t)}get_methodName(){return"clientBootError"}}J._DeviceErrorActionProperty=new u.a("deviceErrorAction",Number,J),J._ErrorDetailsProperty=new u.a("errorDetails",Object,J);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Z extends R.a{constructor(e,t){super()}get_methodName(){return"clientInitialized"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ee extends x.a{constructor(e){super(),this._onFloatResult=null,this._onFloatResult=e}_get_Value(){return this.getValue(ee._ValueProperty)}call(){this._onFloatResult(this._get_Value())}}ee._ValueProperty=new u.a("value",Number,ee);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class te extends R.a{constructor(e){super(),this.setValue(te._OnFloatResultProperty,new ee(e))}get_methodName(){return"getMemoryUsage"}}te._OnFloatResultProperty=new u.a("onFloatResult",ee,te);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class ne extends R.a{constructor(e,t){super(),this.setValue(ne._ValueNameProperty,e),this.setValue(ne._ValueProperty,t)}get_methodName(){return"setBoolValue"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var re;ne._ValueNameProperty=new u.a("valueName",String,ne),ne._ValueProperty=new u.a("value",Boolean,ne),function(e){e[e.compatible=0]="compatible",e[e.needsToUpgrade=1]="needsToUpgrade",e[e.needsToDowngrade=2]="needsToDowngrade"}(re||(re={}));var ae=n("H4dV");class ie extends i.a{get_currentVersion(){return ie.get_currentVersionName()}get_hasSupportedVersion(){return this.get_version1()}get_versionCompatibility(){return!this.get_hasSupportedVersion()||!this.get_hasSupportedCallMechanism()||this.get_hasLatestPALVersion()&&ie.get_currentRevision()>this.get_revision()||this.get_iOSUpdateRevision()!==ie.iOSUpdateRevisionProperty.get_defaultValue()&&ie.get_serveriOSUpdateRevision()>this.get_iOSUpdateRevision()||this.get_win8UpdateRevision()!==ie.win8UpdateRevisionProperty.get_defaultValue()&&ie.get_serverWin8UpdateRevision()>this.get_win8UpdateRevision()||this.get_androidUpdateRevision()!==ie.androidUpdateRevisionProperty.get_defaultValue()&&ie.get_serverAndroidUpdateRevision()>this.get_androidUpdateRevision()?re.needsToUpgrade:this.get_hasLatestPALVersion()&&ie.get_currentRevision()<this.get_revision()?re.needsToDowngrade:0}get_nativeRevision(){return ae.a.getInstance().get_IsIOS()?this.get_iOSUpdateRevision():ae.a.getInstance().get_IsAndroid()?this.get_androidUpdateRevision():this.get_win8UpdateRevision()}get_hasLatestPALVersion(){const e=this.getValue(ie.lastPALVersion);return this.get_currentVersion()===e}get_version1(){return this.getValue(ie.version1Property)}get_hasSupportedCallMechanism(){return this.get_windowLocation()||this.get_javaInterface()||this.get_pushToPull()||this.get_messageInterface()||this.get_objectShareInterface()}get_windowLocation(){return this.getValue(ie.windowLocationProperty)}get_pushToPull(){return this.getValue(ie.pushToPullProperty)}get_javaInterface(){return this.getValue(ie.javaInterfaceProperty)}get_messageInterface(){return this.getValue(ie.messageInterfaceProperty)}get_messageProtocol(){return this.getValue(ie.messageProtocolProperty)}get_objectShareInterface(){return this.getValue(ie.objectShareInterfaceProperty)}get_osVersion(){return this.getValue(ie.osVersionProperty)}get_language(){return this.getValue(ie.languageProperty)}get_version(){return this.getValue(ie.versionProperty)}get_build(){return this.getValue(ie.buildProperty)}get_revision(){return this.getValue(ie.revisionProperty)}get_iOSUpdateRevision(){return this.getValue(ie.iOSUpdateRevisionProperty)}get_win8UpdateRevision(){return this.getValue(ie.win8UpdateRevisionProperty)}get_androidUpdateRevision(){return this.getValue(ie.androidUpdateRevisionProperty)}get_installationId(){return this.getValue(ie.installationIdProperty)}get_telemetryEventsParams(){return this.getValue(ie.telemetryEventsParamsProperty)}get_applicationName(){return this.getValue(ie.applicationNameProperty)}get_diagnosticsEnabled(){return this.getValue(ie.diagnosticsEnabledProperty)}get_dispatcherPerfLoggingEnabled(){return this.getValue(ie.dispatcherPerfLoggingEnabledProperty)}get_loggingEnabled(){return this.getValue(ie.loggingEnabledProperty)}get_logComponents(){return this.getValue(ie.logComponentsProperty)}get_logMessageMaxLength(){return this.getValue(ie.logMessageMaxLengthProperty)}get_hasReconfigureSupport(){return this.getValue(ie.hasReconfigureSupportProperty)}get_hasOneNoteSupport(){return this.getValue(ie.hasOneNoteSupportProperty)}get_hasOfficeDocumentsSupport(){return this.getValue(ie.hasOfficeDocumentsSupportProperty)}get_shimStartTime(){return this.getValue(ie.shimStartTimeProperty)}get_ShimPerformanceMetrics(){return this.getValue(ie.shimPerformanceMetricsProperty)}get_isManaged(){return this.getValue(ie.isManagedProperty)}get_nativeFCBContext(){return this.getValue(ie.nativeFCBContextProperty)}get_hasMashupSupport(){return this.getValue(ie.hasMashupSupportProperty)}get_hasMashupDiagnoticsSupport(){return this.getValue(ie.hasMashupDiagnosticsSupportProperty)}get_shouldSkipTransfer(){return this.getValue(ie.shouldSkipTransferProperty)}get_hideCommandBar(){return this.getValue(ie.hideCommandBarProperty)}get_proxyMetadataSyncEventsToShim(){return this.getValue(ie.proxyMetadataSyncEventsToShimProperty)}get_appId(){return this.getValue(ie.appIdProperty)}get_hasAppList(){return this.getValue(ie.hasAppListProperty)}get_canNavigateBackToHost(){return this.getValue(ie.canNavigateBackToHostProperty)}static get_currentVersionName(){return ie._currentVersion}static set_currentVersionName(e){return ie._currentVersion=e,e}static get_currentRevision(){return ie._currentRevision}static set_currentRevision(e){return ie._currentRevision=e,e}static get_serveriOSUpdateRevision(){return ie._serveriOSUpdateRevision}static set_serveriOSUpdateRevision(e){return ie._serveriOSUpdateRevision=e,e}static get_serverWin8UpdateRevision(){return ie._serverWin8UpdateRevision}static set_serverWin8UpdateRevision(e){return ie._serverWin8UpdateRevision=e,e}static get_serverAndroidUpdateRevision(){return ie._serverAndroidUpdateRevision}static set_serverAndroidUpdateRevision(e){return ie._serverAndroidUpdateRevision=e,e}}ie.version1Name="Version1",ie.revisionSupported=1,ie.iOSUpdateRevisionSupported=1,ie.win8UpdateRevisionSupported=1,ie.androidUpdateRevisionSupported=1,ie.version1Property=new u.a(ie.version1Name,Boolean,ie,!1),ie.lastPALVersion=new u.a("LastPALVersion",String,ie,""),ie.windowLocationProperty=new u.a("WindowLocation",Boolean,ie,!1),ie.pushToPullProperty=new u.a("PushToPull",Boolean,ie,!1),ie.javaInterfaceProperty=new u.a("JavaInterface",Boolean,ie,!1),ie.messageInterfaceProperty=new u.a("MessageInterface",Boolean,ie,!1),ie.messageProtocolProperty=new u.a("MessageProtocol",String,ie,"ms-appx:"),ie.objectShareInterfaceProperty=new u.a("ObjectShareInterface",Boolean,ie,!1),ie.osVersionProperty=new u.a("OSVersion",String,ie,""),ie.languageProperty=new u.a("Language",String,ie,""),ie.versionProperty=new u.a("Version",String,ie,""),ie.buildProperty=new u.a("Build",Number,ie,-1),ie.revisionProperty=new u.a("Revision",Number,ie,-1),ie.iOSUpdateRevisionProperty=new u.a("iOSUpdateRevision",Number,ie,-1),ie.win8UpdateRevisionProperty=new u.a("Win8UpdateRevision",Number,ie,-1),ie.androidUpdateRevisionProperty=new u.a("AndroidUpdateRevision",Number,ie,-1),ie.installationIdProperty=new u.a("InstallationId",String,ie,""),ie.telemetryEventsParamsProperty=new u.a("TelemetryEventsParams",Object,ie,null),ie.applicationNameProperty=new u.a("ApplicationName",String,ie,"microsoft.microsoftdynamicscrm"),ie.diagnosticsEnabledProperty=new u.a("DiagnosticsEnabled",Boolean,ie,!1),ie.dispatcherPerfLoggingEnabledProperty=new u.a("DispatcherPerfLoggingEnabled",Boolean,ie,!1),ie.loggingEnabledProperty=new u.a("loggingEnabled",Boolean,ie,!1),ie.logComponentsProperty=new u.a("LogComponents",Array,ie,null),ie.logMessageMaxLengthProperty=new u.a("LogMessageMaxLength",Number,ie,0),ie.hasReconfigureSupportProperty=new u.a("HasReconfigureSupport",Boolean,ie,!1),ie.hasOneNoteSupportProperty=new u.a("HasOneNoteSupport",Boolean,ie,!1),ie.hasOfficeDocumentsSupportProperty=new u.a("HasOfficeDocumentsSupport",Boolean,ie,!1),ie.shimStartTimeProperty=new u.a("ShimStartTime",Number,ie,-1),ie.shimPerformanceMetricsProperty=new u.a("ShimPerformanceMetrics",Array,ie,null),ie.isManagedProperty=new u.a("IsManaged",Boolean,ie,!1),ie.hasMashupSupportProperty=new u.a("HasMashupSupport",Boolean,ie,!1),ie.hasMashupDiagnosticsSupportProperty=new u.a("HasMashupDiagnosticsSupport",Boolean,ie,!1),ie.nativeFCBContextProperty=new u.a("NativeFCBContext",Object,ie,null),ie.shouldSkipTransferProperty=new u.a("ShouldSkipTransfer",Boolean,ie,!1),ie.hideCommandBarProperty=new u.a("HideCommandBar",Boolean,ie,!1),ie.proxyMetadataSyncEventsToShimProperty=new u.a("ProxyMetadataSyncEventsToShim",Boolean,ie,!1),ie.appIdProperty=new u.a("AppId",String,ie,null),ie.hasAppListProperty=new u.a("HasAppList",Boolean,ie,!1),ie.canNavigateBackToHostProperty=new u.a("CanNavigateBackToHost",Boolean,ie,!1),ie._currentVersion=ie.version1Name,ie._currentRevision=ie.revisionSupported,ie._serveriOSUpdateRevision=ie.iOSUpdateRevisionSupported,ie._serverWin8UpdateRevision=ie.win8UpdateRevisionSupported,ie._serverAndroidUpdateRevision=ie.androidUpdateRevisionSupported;var oe=n("FkJY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class se extends R.a{constructor(e,t,n){super(),this.setValue(se._ClientStateProperty,e)}get_methodName(){return"clientReady"}}se._ClientStateProperty=new u.a("clientState",oe.a,se);class ce extends D.a{constructor(e,t){super(e),this._clientReadyBridge=null,this._applicationState=new ie,this._clientReadyBridge=t,this.get_applicationState().add_propertyChanged((e,t)=>{if(t===ie.diagnosticsEnabledProperty.get_name())Object(c.f)(l.a.PAL,"DiagnosticsEnabled property has changed to: {0}",this.get_applicationState().get_diagnosticsEnabled()),this.get_applicationState().get_diagnosticsEnabled()?Object(c.m)(Y(Q.a.Verbose)):Object(c.m)(Y(Q.a.Info)),Object(c.l)(!!Object(c.c)()),Object(c.f)(l.a.PAL,"TraceLevel set to: {0}, PALWebScriptLogProcessor.PALWebscriptLogLevel set to {1}",Object(c.c)(),X);else if(t===ie.logComponentsProperty.get_name()){const e=this.get_applicationState().get_logComponents();if(K.e(!!e&&e.length>0),Object(c.i)(l.a.PAL,"ConsoleTraceProcessor.FilterByTraceComponent was set to: {0}",K.c()),K.c()){K.b();for(let t=0;t<e.length;t++){const n=e[t];Object(c.i)(l.a.PAL,"Component Added: {0}",n),K.a(n)}}}else t===ie.logMessageMaxLengthProperty.get_name()&&(K.g(this.get_applicationState().get_logMessageMaxLength()),Object(c.i)(l.a.PAL,"ConsoleTraceProcessor.MaxTraceMessageLength was set to: {0}",K.d()))})}add_reportPerformance(e){this.addCustomEventHandler(ce._ReportPerformanceName,e)}remove_reportPerformance(e){this.removeCustomEventHandler(ce._ReportPerformanceName,e)}get_namespaceName(){return"Application"}get_applicationState(){return this.get_state()}get_state(){return this._applicationState}clientInitialized(e,t){const n=new Z(e,t);this.callNativeMethod(this.get_version().get_currentVersion(),n),e()}clientBootError(e,t){const n=new J(e,t);this.callNativeMethod(this.get_version().get_currentVersion(),n)}setBoolValue(e,t){Object(g.c)(e,"argumentName");const n=new ne(e,t);this.callNativeMethod(this.get_version().get_currentVersion(),n)}getMemoryUsage(e){Object(g.b)(e,"onFloatResult");const t=new te(e);this.callNativeMethod(this.get_version().get_currentVersion(),t)}clientReady(e,t,n){const r=new se(e,t,n);this._callClientReadyNativeMethod(this.get_version().get_currentVersion(),r),t()}_callClientReadyNativeMethod(e,t){if(!this.get_IsAvailable())throw Error.invalidOperation("Trying to call native method "+t.get_methodName()+" before dispatcher is available");this._clientReadyBridge.callClientReadyNativeMethod(this,e,t)}}ce._ReportPerformanceName="ReportPerformance";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class le extends R.a{constructor(e){super(),this.setValue(le._MessageProperty,e)}get_methodName(){return"postMessage"}}le._MessageProperty=new u.a("message",String,le);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class ue extends i.a{get_deviceModel(){return this.getValue(ue.deviceModelProperty)}get_deviceMemoryRestricted(){return(ae.a.getInstance().get_IsAndroidPhone()||ae.a.getInstance().get_isIPhone()||ae.a.getInstance().get_isWinPhone())&&this.getValue(ue.deviceMemoryRestrictedProperty)}get_CameraAvailable(){return this.getValue(ue.cameraAvailableProperty)}get_MicrophoneAvailable(){return this.getValue(ue.microphoneAvailableProperty)}get_GeolocationAvailable(){return this.getValue(ue.geolocationAvailableProperty)}get_IsNarratorActive(){return this.getValue(ue.isNarratorActiveProperty)}get_deviceMaxBatchSize(){return this.getValue(ue.deviceMaxBatchSizeProperty)}get_connectionAvailable(){return this.getValue(ue.connectionAvailableProperty)}get_formFactor(){return this.getValue(ue.formFactorProperty)}}ue.deviceModelProperty=new u.a("DeviceModel",String,ue,""),ue.deviceMemoryRestrictedProperty=new u.a("DeviceMemoryRestricted",Boolean,ue,!1),ue.deviceMaxBatchSizeProperty=new u.a("DeviceMaxBatchSize",Number,ue,25),ue.connectionAvailableProperty=new u.a("ConnectionAvailable",Boolean,ue,!0),ue.formFactorProperty=new u.a("FormFactor",String,ue,"slate"),ue.isNarratorActiveProperty=new u.a("IsNarratorActive",Boolean,ue,!1),ue.cameraAvailableProperty=new u.a("CameraAvailable",Boolean,ue,!1),ue.microphoneAvailableProperty=new u.a("MicrophoneAvailable",Boolean,ue,!1),ue.geolocationAvailableProperty=new u.a("GeolocationAvailable",Boolean,ue,!1);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class de extends D.a{constructor(e){super(e),this._deviceState=new ue}add_onStatusBarPressed(e){this.addCustomEventHandler(de._OnStatusBarPressed,e)}remove_onStatusBarPressed(e){this.removeCustomEventHandler(de._OnStatusBarPressed,e)}get_namespaceName(){return"Device"}get_DeviceState(){return this.get_state()}postMessage(e){const t=new le(e);this.callNativeMethod(this.get_version().get_currentVersion(),t)}get_state(){return this._deviceState}}de._OnStatusBarPressed="OnStatusBarPressed";var pe=n("RYFF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ge extends x.a{constructor(e){super(),this._onResults=null,this._onResults=e}_get_Result(){return this.getValue(ge._ResultProperty)}call(){this._onResults&&this._onResults(this._get_Result())}}ge._ResultProperty=new u.a("result",String,ge);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class he extends R.a{constructor(e,t,n,r,a){super(),this.setValue(he._OnSuccessCallbackProperty,new ge(e)),this.setValue(he._OnFailureCallbackProperty,new ge(t)),this.setValue(he._ServiceName,n),this.setValue(he._ActionName,r),this.setValue(he._Args,a)}get_methodName(){return he._Name}}he._Name="exec",he._OnSuccessCallbackProperty=new u.a("onSuccess",ge,he),he._OnFailureCallbackProperty=new u.a("onFailure",ge,he),he._ServiceName=new u.a("serviceName",String,he),he._ActionName=new u.a("actionName",String,he),he._Args=new u.a("args",Array,he);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class fe extends R.a{get_methodName(){return"onSyncComplete"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class me extends R.a{get_methodName(){return"onSyncError"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class be extends R.a{get_methodName(){return"onSyncStart"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class _e extends i.a{get_filesDownloadStatus(){const e=this.get_filesDownloadStatusJson();return null==e||""===e?null:JSON.parse(e)}get_filesDownloadStatusJson(){return this.getValue(_e.FilesDownloadStatusProperty)}testHook_set_filesDownloadStatusJson(e){return this.setValue(_e.FilesDownloadStatusProperty,e)}}_e.FilesDownloadStatusProperty=new u.a("FilesDownloadStatus",String,_e,"");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class ye extends D.a{constructor(e){super(e),this._cordovaState=new _e}get_namespaceName(){return"Cordova"}get_CordovaState(){return this.get_state()}get_state(){return this._cordovaState}exec(e,t,n,r,a){Object(g.c)(n,"serviceName"),Object(g.c)(r,"actionName");const i=new he(e,t,n,r,a);this.callNativeMethod(this.get_version().get_currentVersion(),i)}onSyncStart(){const e=new be;this.callNativeMethod(this.get_version().get_currentVersion(),e)}onSyncComplete(){const e=new fe;this.callNativeMethod(this.get_version().get_currentVersion(),e)}onSyncError(){const e=new me;this.callNativeMethod(this.get_version().get_currentVersion(),e)}}class ve extends i.a{constructor(e){super(),this._ready=!1,this._paused=!1,this._key=null,this._actionSubmitter=null,this._preReadyCalls=null,this._accountDispatcher=null,this._multimediaDispatcher=null,this._applicationDispatcher=null,this._deviceDispatcher=null,this._navigationDispatcher=null,this._networkDispatcher=null,this._documentDispatcher=null,this._sqlDispatcher=null,this._dataDispatcher=null,this._loggingDispatcher=null,this._windows8Message=null,this._cordovaDispatcher=null,this._externalContextDispatcher=null,this._cordovaMediaDispatcher=null,this._callbacks={},this.dispatchers={},this._actionSubmitter=e,this._preReadyCalls=new Array(0),this.set_application(new ce(this,this)),this._windows8Message=new P,this.registerDispatchers()}async add_onReadyOrNow(e){this.get_isReady()?await e():this.addCustomEventHandler(ve._readyEventName,e)}remove_onReadyOrNow(e){this.removeCustomEventHandler(ve._readyEventName,e)}add_onActive(e){this.addCustomEventHandler(ve._activeEventName,e)}remove_onActive(e){this.removeCustomEventHandler(ve._activeEventName,e)}add_onInactive(e){this.addCustomEventHandler(ve._inactiveEventName,e)}remove_onInactive(e){this.removeCustomEventHandler(ve._inactiveEventName,e)}add_onAppLink(e){this.addCustomEventHandler(ve._appLinkEventName,e)}remove_onAppLink(e){this.removeCustomEventHandler(ve._appLinkEventName,e)}add_onShellApiRequest(e){this.addCustomEventHandler(ve._shellApiRequestEventName,e)}get_isReady(){return this._ready}set_isReady(e){return this._ready=e,e}get_isPaused(){return this._paused}set_isPaused(e){return this._paused=e,e}get_key(){return this._key}_set_key(e){return this._key=e,e}get_version(){return this.get_application().get_applicationState()}get_callMechanism(){return this.get_application().get_applicationState()}get_account(){return this._accountDispatcher}set_account(e){return this._accountDispatcher=e,e}async get_multimedia(){if(!this._multimediaDispatcher){const e=new((await n.e(83).then(n.bind(null,"XLOu"))).MultimediaDispatcher)(this);this.registerAndSetStateOnDispatcher(e),this._multimediaDispatcher=e}return this._multimediaDispatcher}set_multimedia(e){return this._multimediaDispatcher=e,e}get_application(){return this._applicationDispatcher}set_application(e){return this._applicationDispatcher=e,e}get_device(){return this._deviceDispatcher}set_device(e){return this._deviceDispatcher=e,e}async get_navigation(){if(!this._navigationDispatcher){const e=new((await n.e(87).then(n.bind(null,"lBpF"))).NavigationDispatcher)(this);this.registerAndSetStateOnDispatcher(e),this._navigationDispatcher=e}return this._navigationDispatcher}set_navigation(e){return this._navigationDispatcher=e,e}async get_network(){if(!this._networkDispatcher){const e=new((await n.e(88).then(n.bind(null,"N39u"))).NetworkDispatcher)(this);this.registerAndSetStateOnDispatcher(e),this._networkDispatcher=e}return this._networkDispatcher}set_network(e){return this._networkDispatcher=e,e}async get_document(){if(!this._documentDispatcher){const e=new((await n.e(59).then(n.bind(null,"4ell"))).DocumentDispatcher)(this);this.registerAndSetStateOnDispatcher(e),this._documentDispatcher=e}return this._documentDispatcher}set_document(e){return this._documentDispatcher=e,e}get_sql(){return this._sqlDispatcher}set_sql(e){return this._sqlDispatcher=e,e}async get_data(){if(!this._dataDispatcher){const e=new((await n.e(57).then(n.bind(null,"B5IK"))).DataDispatcher)(this);this.registerAndSetStateOnDispatcher(e),this._dataDispatcher=e}return this._dataDispatcher}set_data(e){return this._dataDispatcher=e,e}async get_logging(){if(null===this._loggingDispatcher){const e=new((await n.e(75).then(n.bind(null,"USS4"))).LoggingDispatcher)(this);this.registerAndSetStateOnDispatcher(e),this._loggingDispatcher=e}return this._loggingDispatcher}set_logging(e){return this._loggingDispatcher=e,e}get_Cordova(){return this._cordovaDispatcher}set_Cordova(e){return this._cordovaDispatcher=e,e}async get_externalContext(){if(!this._externalContextDispatcher){const e=new((await n.e(62).then(n.bind(null,"U9za"))).ExternalContextDispatcher)(this);this.registerAndSetStateOnDispatcher(e),this._externalContextDispatcher=e}return this._externalContextDispatcher}set_externalContext(e){return this._externalContextDispatcher=e,e}async get_CordovaMedia(){if(!this._cordovaMediaDispatcher){const e=new((await n.e(53).then(n.bind(null,"XkVh"))).CordovaMediaDispatcher)(this);this.registerAndSetStateOnDispatcher(e),this._cordovaMediaDispatcher=e}return this._cordovaMediaDispatcher}set_CordovaMedia(e){return this._cordovaMediaDispatcher=e,e}deviceReady(e,t){Object(g.c)(e,"key"),Object(g.c)(t,"jsonStates"),Object(c.f)(l.a.PAL,"Ready, key {0} states {1}",e,t);const n=JSON.parse(t);if("object"!=typeof n){const e="Invalid JSON for ready states, "+t;throw Object(c.d)(l.a.PAL,e),Error.invalidOperation(e)}localStorage.setItem(ve._deviceReadyCachedStateStoreKey,JSON.stringify(new S(e,t))),this.deviceReadyInternal(e,n)}deviceActive(){this.verifyReady(),Object(c.f)(l.a.PAL,"Device going to Active state"),this.deviceActiveInternal()}deviceInactive(){this.verifyReady(),Object(c.j)(l.a.PAL,"Device going to Inactive state"),this.handleCustomEvent0(ve._inactiveEventName)}deviceResume(){this.verifyReady(),Object(c.f)(l.a.PAL,"Resume"),this.deviceResumeInternal()}devicePause(){this.verifyReady(),Object(c.j)(l.a.PAL,"Device going to Pause state"),this.set_isPaused(!0),this.handleCustomEvent0(ve._pauseEventName)}deviceCallback(e,t,n){Object(g.c)(e,"callbackID"),Object(g.c)(t,"jsonArgs"),this.verifyReady(),Object(c.i)(l.a.PAL,"Callback, Callback Id: {0}, Unregister: {1}",e,n),Object(c.i)(l.a.PAL,"Callback, JSONArgs: {0}",t);const r=e in this._callbacks?this._callbacks[e]:null;r&&r.get_callContext().logPerfData("NativeBridge.DeviceCallback.Deserialize.Start",(new Date).getTime());const a=y(t,null);if(r&&r.get_callContext().logPerfData("NativeBridge.DeviceCallback.Deserialize.End",(new Date).getTime()),"object"==typeof a)return this.deviceCallbackInternal(e,a,n),"";const i="Invalid JSON for callback args, "+t;throw Object(c.j)(l.a.PAL,i),Error.invalidOperation(i)}deviceUnregisterCallback(e){if(Object(g.c)(e,"callbackID"),this.verifyReady(),Object(c.i)(l.a.PAL,"Unregister, {0}",e),!(e in this._callbacks)){const t="Attempting to unregister unknown callback, "+e;throw Object(c.j)(l.a.PAL,t),Error.invalidOperation(t)}delete this._callbacks[e]}deviceEvent(e,t,n){if(Object(g.c)(e,"namespaceName"),Object(g.c)(t,"name"),Object(g.c)(n,"value"),this.verifyReady(),Object(c.f)(l.a.PAL,"Event, {0}, {1}, {2}",e,t,n),!(e in this.dispatchers)){const t="Attempting to raise event in unknown namespace, "+e;throw Object(c.j)(l.a.PAL,t),Error.invalidOperation(t)}const r=this.dispatchers[e],a=JSON.parse(n);if(!(a instanceof Array)){const e="Event value is not an Array";throw Object(c.j)(l.a.PAL,e),Error.invalidOperation(e)}const i=a;if(1!==i.length){const e="Event value array should contain exactly one element. Actual length = "+i.length;throw Object(c.j)(l.a.PAL,e),Error.invalidOperation(e)}const o=i[0];if(void 0===o){const e="Invalid or missing event value";throw Object(c.j)(l.a.PAL,e),Error.invalidOperation(e)}r.changeState(t,o)||r.raiseEvent(t,o)}devicePullArgs(e){Object(g.c)(e,"pullArgsId"),Object(c.i)(l.a.PAL,"DevicePullArgs, {0}",e);const t=I.pullArgs(e);return JSON.stringify(t)}deviceSearch(e){Object(g.c)(e,"searchText"),Object(c.i)(l.a.PAL,"DeviceSearch, {0}",e),this.handleCustomEvent1(ve._searchEventName,e)}voiceCommand(e){Object(g.c)(e,"command"),Object(c.i)(l.a.PAL,"VoiceCommand, {0}",e),this.handleCustomEvent1(ve._voiceCommandEventName,e)}tileActivation(e){Object(g.c)(e,"urlArguments"),Object(c.i)(l.a.PAL,"Tile Activation, {0}",e),this.handleCustomEvent1(ve._tileActivationEventName,e)}appLink(e){Object(g.b)(e,"urlArguments"),Object(c.i)(l.a.PAL,"App Link, {0}",e),this.handleCustomEvent1(ve._appLinkEventName,e)}shellApiRequest(e){Object(g.c)(e,"jsonArguments should not be null or empty"),Object(c.i)(l.a.PAL,"Shell API request, {0}",e),this.handleCustomEvent1(ve._shellApiRequestEventName,e)}callNativeMethod(e,t,n){Object(c.i)(l.a.PAL,"Calling native method, {0}, {1}",t,n.get_methodName()),n.get_callContext().logPerfData("NativeBridge.CreateNativeCall.Start",(new Date).getTime());const r=this.createNativeCall(e,t,n);n.get_callContext().logPerfData("NativeBridge.CreateNativeCall.End",(new Date).getTime()),r&&(this.get_isReady()?(n.get_callContext().logPerfData("NativeBridge.SubmitNativeCallAction.Start",(new Date).getTime()),this._actionSubmitter.submit(r),n.get_callContext().logPerfData("NativeBridge.SubmitNativeCallAction.End",(new Date).getTime())):this._preReadyCalls.push(r))}callClientReadyNativeMethod(e,t,n){Object(c.i)(l.a.PAL,"Calling native method, {0}, {1}",t,n.get_methodName());const r=this.createNativeCall(e,t,n);this._actionSubmitter.submit(r)}registerNativeCallback(e,t){Object(g.b)(e,"call"),Object(g.b)(t,"callback");const n=e.get_methodName()+t.get_callbackID();return Object(c.i)(l.a.PAL,"Registering callback, {0}",n),this._callbacks[n]=t,n}forceDeviceReady(){const e=localStorage.getItem(ve._deviceReadyCachedStateStoreKey);if(Object(C.a)(e))Object(c.d)(l.a.PAL,"ForceDeviceReady: No cached device state data found to force DeviceReady");else{const t=JSON.parse(e);Object(C.a)(t.deviceStateJson)?Object(c.d)(l.a.PAL,"ForceDeviceReady: DeviceStateJsonNull. deviceReadyCachedStateString: "+e):this.deviceReadyInternal(t.nativeCallKey,JSON.parse(t.deviceStateJson))}}registerAndSetStateOnDispatcher(e){this.registerDispatcher(e);const t=this.getDeviceReadyCachedState()[e.get_namespaceName()];if(t instanceof Object)e.setState(t);else{const e="Invalid state JSON or device not ready yet."+t;Object(c.j)(l.a.PAL,e)}}getDeviceReadyCachedState(){const e=localStorage.getItem(ve._deviceReadyCachedStateStoreKey);if(Object(C.a)(e))Object(c.j)(l.a.PAL,"getDeviceReadyCachedState: No cached device state data found.");else{const t=JSON.parse(e);if(!Object(C.a)(t.deviceStateJson))return JSON.parse(t.deviceStateJson);Object(c.j)(l.a.PAL,"getDeviceReadyCachedState: DeviceStateJsonNull. deviceReadyCachedStateString: "+e)}return{}}registerDispatchers(){this.registerDispatcher(this.get_application()),this.set_account(new G(this)),this.registerDispatcher(this.get_account()),this.set_device(new de(this)),this.registerDispatcher(this.get_device()),this.set_sql(new pe.a(this)),this.registerDispatcher(this.get_sql()),this.set_Cordova(new ye(this)),this.registerDispatcher(this.get_Cordova())}registerDispatcher(e){this.dispatchers[e.get_namespaceName()]=e}deviceReadyInternal(e,t){if(this.get_isReady()){const e="Ready may happen only once";Object(c.j)(l.a.PAL,e)}if(this._set_key(e),this._setDispatcherStates(t),!this.get_version().get_hasSupportedVersion()){const e="No supported version available";throw Object(c.d)(l.a.PAL,e),Error.invalidOperation(e)}if(!this.get_callMechanism().get_hasSupportedCallMechanism()){const e="No native call mechanism available";throw Object(c.d)(l.a.PAL,e),Error.invalidOperation(e)}if(this.set_isReady(!0),this.handleCustomEvent0(ve._readyEventName),this.deviceActiveInternal(),this.deviceResumeInternal(),this._preReadyCalls){Object(c.f)(l.a.PAL,"Ready with {0} pre-ready calls",l.a.PAL,this._preReadyCalls.length);for(const e of this._preReadyCalls)this._actionSubmitter.submit(e);this._preReadyCalls=null}}verifyReady(){if(!this.get_isReady())throw Error.invalidOperation("Trying to call native method before device is ready")}deviceActiveInternal(){this.handleCustomEvent0(ve._activeEventName),Object(c.f)(l.a.PAL,"Active")}deviceResumeInternal(){this.set_isPaused(!1),this.handleCustomEvent0(ve._resumeEventName),Object(c.j)(l.a.PAL,"Device going to Resume state")}deviceCallbackInternal(e,t,n){if(!(e in this._callbacks)){const t="Attempting to call unknown callback, "+e;throw Object(c.j)(l.a.PAL,t),Error.invalidOperation(t)}{const r=this._callbacks[e];n&&this.deviceUnregisterCallback(e),Object(c.i)(l.a.PAL,"Calling callback, {0}",e),r.callback(t)}}createNativeCall(e,t,n){const r=n.get_methodName(),a=n.getValues(),i=n.getCallbacks(this);return this.get_callMechanism().get_pushToPull()&&n.get_hasBigArgs()?new I(this.get_key(),e.get_namespaceName(),t,r,a,i,n.get_callContext()):this.get_callMechanism().get_windowLocation()?new E(this.get_key(),e.get_namespaceName(),t,r,a,i,n.get_callContext()):this.get_callMechanism().get_javaInterface()?new O(this.get_key(),e.get_namespaceName(),t,r,a,i,n.get_callContext()):this.get_callMechanism().get_objectShareInterface()?new N(this.get_key(),e.get_namespaceName(),t,r,a,i,ve.get_Instance().get_application().get_applicationState().get_applicationName(),this.get_callMechanism().get_messageProtocol(),n.get_callContext()):this.get_callMechanism().get_messageInterface()?new T(this.get_key(),e.get_namespaceName(),t,r,a,i,ve.get_Instance().get_application().get_applicationState().get_applicationName(),this.get_callMechanism().get_messageProtocol(),n.get_callContext()):(Object(c.j)(l.a.PAL,"No native call mechanism available"),null)}_setDispatcherStates(e){for(const t in e){const n={key:t,value:e[t]};if(n.key in this.dispatchers){const e=this.dispatchers[n.key];if(Object(c.f)(l.a.PAL,"Setting state, {0}",n.key),!(n.value instanceof Object)){const e="Invalid state JSON, "+n.value;throw Object(c.j)(l.a.PAL,e),Error.invalidOperation(e)}e.setState(n.value)}else Object(c.j)(l.a.PAL,"Unknown dispatcher state, {0}",n.key)}}willDispatcherBeAvailableFromDevice(e){const t=this.getDeviceReadyCachedState();for(const n in t){if({key:n,value:t[n]}.key===e)return!0}return!1}static get_Instance(){return ve._instance||(ve._instance=new ve(new _)),ve._instance}static set_Instance(e){return ve._instance=e,e}static initializeDOMBridge(){window.PALNativeBridge=ve.get_Instance(),window.PALWebViewMessageHandler=ve.get_Instance()._windows8Message.webViewMessageEventHandler}}ve.palIncompatibleCookieName="PALIncompatible",ve._activeEventName="OnActive",ve._inactiveEventName="OnInactive",ve._resumeEventName="OnResume",ve._pauseEventName="OnPause",ve._searchEventName="OnSearch",ve._voiceCommandEventName="OnVoiceCommand",ve._tileActivationEventName="OnTileActivation",ve._appLinkEventName="OnAppLink",ve._shellApiRequestEventName="OnShellApiRequest",ve._deviceReadyCachedStateStoreKey="DeviceReadyCachedState",ve._readyEventName="OnReady",ve._instance=null,ve.initializeDOMBridge()},a72m:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b}));var r=n("K7RF"),a=n("Uv1Y"),i=n("d0w6"),o=n("SAYH"),s=n("eXjw"),c=n("KBcj"),l=n("g0tL"),u=n("504W"),d=n("2XFH"),p=n("sZ+8"),g=n("iJGp"),h=n("/oKV");function f(e,t,n,l,d,f=!1){return{type:"view.retrieve.async",execute({dispatch:b,getState:_},y,v){const S=[{name:"entityTypeName",value:e},{name:"viewQueryType",value:t},{name:"viewType",value:n},{name:"viewId",value:o.a.toString(l)},{name:"isViewSelectorItemsNeeded",value:d},{name:"allowCheckForUserView",value:f}];let O=!0;n||(n=i.b.savedview,O=!1);let C=h.a.LocalAndRemote;const E=_();let I=l,w=g.a.OnDemandWithContext,j=!1;if((Object(c.f)(E,e,t)||null==t||void 0!==d&&!d)&&(w=g.a.OnDemandWithoutContext),o.a.isNullOrEmpty(I)&&(I=Object(c.a)(E,e,t)),o.a.isNullOrEmpty(I)){if(n===i.b.userview)return y.EventManager.ReportComponentSuccess("RetrieveView.retrieveView",S),Promise.reject(new a.a("Cannot fetch a user view without specifying id"))}else{const t=Object(c.i)(E,I),a=Object(c.c)(E,I);if(t===s.a.Initialized&&((Object(r.e)(E,a.OverallVersionNumber)||n===i.b.userview&&Object(r.f)(E,a.OverallUserVersionNumber))&&!Object(p.l)(E,e)?(C=h.a.Remote,w=g.a.OnDemandWithContext,j=!0):Object(p.l)(E,e)&&!a.offlineSqlQuery&&(j=!0),!j))return S.push({name:"isRefresh",value:j}),y.EventManager.ReportComponentSuccess("RetrieveView.retrieveView",S),Promise.resolve(I)}return S.push({name:"retrievalStrategy",value:C},{name:"isRefresh",value:j}),b(m(e,I,n,t,w,C,j,S)).then(r=>{if(Object(u.a)(l)){const r=Object(c.a)(_(),e,t);return Object(c.i)(_(),r)===s.a.Initialized?(S.push({name:"defaultViewId",value:o.a.toString(r)}),y.EventManager.ReportComponentSuccess("RetrieveView.retrieveView",S),r):b(m(e,r,n,t,w,C,j,S)).then(e=>e)}if(f&&!O&&!o.a.isNullOrEmpty(I)&&!o.a.equals(I,r)){return b(m(e,I,i.b.userview,t,w,C,j,S)).then(e=>o.a.isNullOrEmpty(e)?r:e,a.b)}return r}).catch(e=>{if(!o.a.isNullOrEmpty(I))return b(function(e){const t=o.a.isNullOrEmpty(e)?{}:{views:{[o.a.toString(e)]:{initialized:s.a.Error}}};return{type:r.a,payload:t}}(I)),Object(a.b)(e)})}}}function m(e,t,n,u,p,g,h,f){return{type:"view.default.descriptor.async",execute({dispatch:m,getState:b},_){let y=!0;return o.a.isNullOrEmpty(t)||(y=!1,h||m(function(e){const t=o.a.isNullOrEmpty(e)?null:{views:{[o.a.toString(e)]:{initialized:s.a.Initializing}}};return{type:r.a,payload:t}}(t))),m(Object(r.b)(i.b[n],i.a[u],e,o.a.toLegacyGuid(t),y,p,null,null,[],l.b.View,g)).then(e=>{var n;if(e&&e.queryId)return e.queryId;const r=[];for(const t in e.views)f.push({name:"offlineSqlQuery_viewId_"+t,value:!!(null===(n=e.views[t])||void 0===n?void 0:n.offlineSqlQuery)}),r.push(t);let i=null;return o.a.isNullOrEmpty(t)?i=r.length>0?new o.a(r[0]):null:e.views.hasOwnProperty(o.a.toString(t))&&(i=t),_.EventManager.ReportComponentSuccess("RetrieveView._retrieveViewDescriptor",f),m(function(e){return{type:"view.dependencies.update.async",execute({dispatch:t,getState:n},r){const i="name",s=[];for(const t in e)s.push(e[t]+":"+i);if(s.length>0){return t(Object(d.a)(s)).then(()=>{const r=[],a=n();for(const t in e){const n=e[t],s=Object(c.c)(a,new o.a(n));s&&n&&a.metadata.labels&&a.metadata.labels[n]&&a.metadata.labels[n][i]&&(s.title=a.metadata.labels[n][i],r.push(s))}r.length>0&&t(function(e){const t={};for(const n in e)t[o.a.toString(e[n].viewId)]=e[n];return{type:"view.descriptors.update",payload:{views:t}}}(r))},a.b)}return Promise.resolve()}}}(r)).then(()=>i,a.b)},a.b)}}}function b(e,t,n=!1){return{type:"view.selectors.async",execute({dispatch:a,getState:o},s){const l=o();let u=h.a.LocalAndRemote;const d=g.a.OnDemandWithoutContext,p=Object(c.g)(l,e,t);return n||p&&t===i.a.MAIN_APPLICATION_VIEW&&Object(r.f)(l,p)?(u=h.a.Remote,a(_(e,"viewselector",t,d,u))):Object(c.f)(l,e,t)?Promise.resolve(l.metadata):a(_(e,"viewselector",t,d,u))}}}function _(e,t,n,o,s){return{type:"view.selectors.descriptor.async",execute:({dispatch:c},l)=>c(Object(r.b)(t,i.a[n],e,null,!0,o,null,null,[],null,s)).catch(a.b)}}},a8hT:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(){return Promise.all([n.e(19),n.e(114),n.e(1),n.e(3),n.e(22),n.e(24),n.e(78)]).then(n.bind(null,"CsVN"))}function a(){return Promise.all([n.e(3),n.e(93)]).then(n.bind(null,"jRuK"))}function i(){return Promise.all([n.e(113),n.e(36)]).then(n.bind(null,"vUNb"))}function o(){return n.e(35).then(n.bind(null,"WTtv"))}n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}))},aF0N:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n("Lyxw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="EditableGridControlJsEvents",i="EditableGridControlPbl";function o(e,t,n){if(!(e&&e.metadata&&e.metadata.homePageBusinessLogics&&t&&n))return null;const r=e.metadata.homePageBusinessLogics[t];return r?r[n]:null}function s(e){return Object(r.b)(e,i)}function c(e){return Object(r.b)(e,a)}},aOBz:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("OwbH"),a=n("504W"),i=n("uTcl");class o extends r.a{constructor(e,t,n,r){super([e]),this._borderValue=null,this._borderType=0,this._operatorType=0,this._borderValue=t,this._borderType=n,this._operatorType=r}get_borderValue(){return this._borderValue}get_borderType(){return this._borderType}get_operatorType(){return this._operatorType}testCondition(e){let t=!1;return Object(a.a)(e)||(t=this.get_operatorType()?this.get_borderType()===i.a.closed?e<=this.get_borderValue():e<this.get_borderValue():this.get_borderType()===i.a.closed?e>=this.get_borderValue():e>this.get_borderValue()),t}}},aOhN:function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return h}));var r=n("JC5U"),a=n("xPbo"),i=n("ZuxC"),o=n("gQ5I"),s=n("pF61"),c=n("QHx/"),l=n("VgPQ"),u=n("oT5e"),d=n("llMO");function p(e){return{type:"router.canNavigateBack",execute:({dispatch:t,getState:n},r)=>r.Router.shouldNavigate(void 0,!1).then(r=>{if(r){if(!e){const t=Object(s.c)(n());e=Object(c.a)(n(),t)}return t(Object(o.d)(e.targetBrowsingContext)).then(e=>e)}return r})}}function g(e){return{type:"router.forceNavigateBack",execute(t,n){var o;const{dispatch:p,getState:g}=t,h=n.Router;if(!e){const t=Object(s.c)(g());e=Object(c.a)(g(),t)}if(Object(s.o)(g())){const t=null===(o=Object(u.a)(g(),e.targetBrowsingContext))||void 0===o?void 0:o.pageId;p(Object(l.b)(t,!0)),Object(d.a)()}if(h.getHistoryManager().GetHistoryLength(e)<=1)return h.navigateBackOutOfApp().then(e=>1===e.status?h.navigateToDefault():e);p(Object(r.b)());return h.navigateBack(e).then(([t,n,r,o,s,c])=>{const l=t.getId();return p(Object(a.d)(l,l,e.targetBrowsingContext)),p(Object(i.c)(t,n,r,c))},t=>(t&&(t={name:t.name,errorCode:t.errorCode,message:t.message,stack:t.stack}),p(Object(a.e)(t,e.targetBrowsingContext)),{status:1,error:t})).then(e=>(p(Object(r.a)()),e))}}}function h(e){return{type:"router.navigateBack.async",execute:({dispatch:t,getState:n},r)=>t(p(e)).then(n=>n?t(g(e)):{status:1,error:new Error("Navigation is not allowed")})}}},aRLb:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return g}));var r=n("FZDd"),a=n("4ciL"),i=n("SRlt"),o=n("x0oY"),s=n("uIhY"),c=n("pEXn"),l=n("SAYH"),u=n("4r2D");function d(e){const t=[];return{type:"executeOData.execute",execute({dispatch:n,getState:r},o){const s=new u.a(l.a.newGuid().guid);return t.push({name:c.b.ClientRequestId,value:s&&s.RequestId?s.RequestId():null}),n(p(e)).then(()=>{const t=r(),n=Object(a.a)(t,e);return i.c.AddRequestId(n,s&&s.RequestId?s.RequestId():l.a.newGuid().guid),o.DataSource.get_WebAPIService().sendRequest(n)})},getFailureParameters:(e,n)=>t}}function p(...e){return{type:"executeOData.requestAdditionalMetadata.async",execute({dispatch:t,getState:n},a){if(!e)return Promise.resolve();const i=e.reduce(h,{});return t(Object(r.e)(i))}}}function g(e,t,n){e.hasOwnProperty(t)?e[t]=Array.from(new Set(e[t].concat(n))):e[t]=n}function h(e,t){if(Object(a.d)(t))return t.reduce(h,{});if(Object(a.e)(t)){let n=null;if(!t||"function"!=typeof t.getMetadata||!(n=t.getMetadata()))return e;if("Create"===n.operationName){const n=t,r=Object(o.h)(n.payload);g(e,n.etn,r)}else if("Update"===n.operationName){const n=t,r=Object(o.h)(n.payload);g(e,n.etn,r)}else if("Retrieve"===n.operationName){const n=t;g(e,n.entityReference.entityType,n.columns)}else if("Delete"===n.operationName){g(e,t.entityReference.entityType,[])}else{const n=function e(t){let n=null,r=null;if(!t||"function"!=typeof t.getMetadata||!(n=t.getMetadata())||!(r=n.parameterTypes))return[];const a=new Set;for(const i of Object.keys(t)){const o=t[i];if(null!=o)if(n.boundParameter===i)4===r[i].structuralProperty?a.add(o):a.add(o.entityType);else if(r[i])switch(r[i].structuralProperty){case 4:if(o&&o.length)if(o[0].getMetadata){const t=o;for(const n of t)e(n).forEach(e=>a.add(e))}else if(-1===s.a.indexOf(r[i].typeName)){const e=o;for(const t of e)"object"==typeof t&&"entityType"in t&&"id"in t&&a.add(t.entityType)}break;case 5:"object"==typeof o&&"entityType"in o&&"id"in o&&a.add(o.entityType);break;case 2:e(o).forEach(e=>a.add(e))}}return Array.from(a)}(t);for(const t of n)g(e,t,[])}return e}}},ai6P:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var r=n("ufH1"),a=n("84PK"),i=n("504W"),o=n("Div0"),s=n("gg/8"),c=n("rO1J");function l(e){const t=e;return new c.a(new a.a(t.AttributeId),t.CanCreate,t.CanRead,t.CanUpdate)}var u=n("2qvm");function d(e){const t=e;return new u.a(t.FeatureName,t.FeatureControlBitName,t.Value)}var p=n("ngzy");var g=n("j63P");var h=n("gvQo");function f(e){const t=e;return new h.a(new a.a(t.PrivilegeId),new a.a(t.BusinessUnitId),t.Depth)}var m=n("P74A");var b=n("/KPo");var _=n("/XAI");function y(e){const t=e;return new _.a(t.Bias,t.TimeZoneCode,t.UserInterfaceName)}var v=n("xP3K");function S(e){const t=e;return new v.a(new a.a(t.CurrencyId),t.CurrencyName,t.CurrencySymbol,t.CurrencyCode,t.CurrencyPrecision)}var O=n("FKgA"),C=n("0Lym"),E=n("+Kwi");function I(e){const t=e,n=new Date(t.DateStart),r=new Date(t.DateEnd),a=function(e){const t=e.toString().split(":"),n=36e5,r=6e4,a=1e3;return Number.parseInvariant(t[0])*n+Number.parseInvariant(t[1])*r+Number.parseInvariant(t[2])*a}(t.DaylightDelta),i=new E.a(t.DaylightTransitionStart.Day,t.DaylightTransitionStart.DayOfWeek,t.DaylightTransitionStart.Month-1,t.DaylightTransitionStart.Week,new Date(t.DaylightTransitionStart.TimeOfDay),t.DaylightTransitionStart.IsFixedDateRule),o=new E.a(t.DaylightTransitionEnd.Day,t.DaylightTransitionEnd.DayOfWeek,t.DaylightTransitionEnd.Month-1,t.DaylightTransitionEnd.Week,new Date(t.DaylightTransitionEnd.TimeOfDay),t.DaylightTransitionEnd.IsFixedDateRule);return new C.a(r,n,a,i,o)}var w=n("3sOn");function j(e){const t=e,n=new a.a(t.UserId),c=t.UserName,u=t.UserEmail,h=t.MetadataLastModifiedTime,_=t.UserMetadataLastModifiedTime,v=t.UserRoles.map(e=>new a.a(e)),C=t.ParentRootRoles?t.ParentRootRoles.map(e=>new a.a(e)):[],E=t.RoleNames,j=function(e){const t=e,n=new g.a(new a.a(t.OrganizationId),t.OrganizationName,t.LanguageCode,t.EnabledLanguages,t.CurrencyDisplayOption,t.BlockedAttachmentExtensions,t.MaxUploadFileSize,t.ReportScriptErrors,t.IsAutoSaveEnabled,t.IsDuplicateDetectionEnabled,t.IsDuplicateDetectionEnabledForOnlineCreateUpdate,t.OrgCultureInfoLcid,t.FullNameConventionCode,t.FiscalCalendarStart,t.FiscalPeriodFormatPeriod,t.FiscalYearFormatPrefix,t.FiscalYearFormatYear,t.FiscalYearFormatSuffix,t.FiscalPeriodType,t.FiscalYearDisplayCode,t.FiscalPeriodConnector,t.IsSOPIntegrationEnabled,new a.a(t.BaseCurrencyId),t.OrganizationUniqueName,t.UseSkypeProtocol,t.DefaultCountryCode,t.GeoName,t.PricingDecimalPrecision,t.IsTelemetryEnabled,t.IsMocaOfflineFeatureEnabled,t.MobileOfflineSyncInterval,t.NorsyncServerConnectionString,t.OverrideTrackInCrmBehaviour,t.ShowWeekNumber,t.DefaultThemeData,t.LogoImagePath,t.LogoTooltip,t.SessionTimeoutInSeconds,t.SessionTimeoutReminderInSeconds,t.InactivityTimeoutInSeconds,t.InactivityTimeoutReminderInSeconds,t.DelveUrl,t.KmUseExternalPortal,t.KmExternalPortalUrl,t.IsParature,t.IsKMConfigured,t.MaxIncidentMergeNumber,t.MaxChildIncidentNumber,t.IsConflictDetectionEnabledForMobileClient,t.WebResourceHash,t.IsPowerBIEnabled,t.FirstPartyIntegrationSiteUrl,t.EnableLPAuthoring,t.IsContextualHelpEnabled,t.IsMicrosoftFlowEnabled,t.MicrosoftFlowFirstPartyIntegrationSiteUrl,t.IsExternalSearchIndexEnabled,t.MicrosoftFlowDestinationUrl,t.MicrosoftFlowEnvironmentId,t.SharePointDeploymentType,t.IsOneDriveEnabled,t.IsMSTeamsEnabled,t.IsContextualEmailEnabled,t.IsAutoDataCaptureV2Enabled,t.IsManualSalesForecastingEnabled,t.IsActionCardEnabled,t.EnableImmersiveSkypeIntegration,t.IsEmailMonitoringAllowed,t.AllowUnresolvedPartiesOnEmailSend,t.IsPresenceEnabled,t.BoundDashboardDefaultCardExpanded,t.IsPreviewOrganization,t.IsSandboxOrganization,t.IsSovereignCloud,t.AdvancedDebuggabilitySettings,t.OfficePortalUrl,t.IsCrmOrg,t.YammerGroupId,t.YammerNetworkName,t.YammerOAuthAccessTokenExpired,t.YammerPostMethod,t.AppointmentRichEditorExperience,t.EnableBingMapsIntegration,t.BingMapsApiKey,t.AvailableBingMapLocales,t.ExcludedCountriesForMaps,t.BFDatacenter,t.AllowLegacyDialogsEmbedding,t.AllowLegacyClientExperience,t.EnableUnifiedInterfaceShellRefresh,t.GlobalHelpUrl,t.PrivacyStatementUrl,t.OrganizationTenant,t.SecuritySettingForEmail,t.EnableActivitiesTimeLinePerfImprovement,t.GridTotalRecordCountLimit,t.EnableLivePersonaCardUCI,t.LivePersonaCardComplianceEnvironment,t.LivePersonaCardCulture,t.LivePersonaCardFirstPartyIntegrationUrl,t.LivePersonaCardRegion,t.GlobalHelpUrlEnabled,t.GlobalAppendUrlParametersEnabled,t.AreJquery3IncompatibleSolutionsInstalled,t.UseQuickFindViewForGridSearch,t.PpacSettingsUrl,t.IsRichTextNotesEnabled,t.DefaultCrmCustomName,t.CustomizationUrl,t.NewSearchExperienceEnabled,t.ImproveSearchLoggingEnabled);return n.set_webServiceCallRetryPolicies(t.WebServiceCallRetryPolicies),n}(t.OrganizationSettings),P=Object(i.a)(t.SelectedForms)?null:function(e){const t=e;return Object(i.a)(t.SelectedFormsByEntity)?null:new m.a(t.SelectedFormsByEntity)}(t.SelectedForms),T=function(e){const t=e,n=JSON.parse(t.ClientCultureInfo),a=n.dateTimeFormat;a.eras=n.eras;const s=[];if(Object(i.a)(t.TimeZoneAdjustmentRules))Object(r.e)("UserContextSerializer.LoadFromJson:",o.a.storage," User context retrieved from server Does not have any TimeZoneAdjustmentRules");else for(const e of t.TimeZoneAdjustmentRules){const t=I(e);s.push(t)}return new O.a(t.LanguageId,t.UserCultureLcid,t.userCultureName,n.name,n.numberFormat,a,t.TimeZoneUtcOffsetMinutes,s,t.RecordsPerPage,t.ReportScriptErrors,t.IsGuidedHelpEnabled,t.ShowCalendarWeeks,t.IsHighContrastEnabled,t.DefaultSearchExperience,t.DefaultGridViews,t.SelectedGlobalFilterId,t.IsAdmin,t.IsCustomizer,t.HomepageArea,t.HomepageSubArea,t.IsEmailConversationViewEnabled,t.WorkDayStartTime,t.AutoCaptureUserStatus)}(t.UserSettings),N=function(e){const t=e;return new p.a(new a.a(t.ProfileId),t.OfflineAvailableEntities,t.ProfileVersion)}(t.OfflineProfile),A={};for(const e of t.RolePrivileges){const t=f(e);A[t.get_privilegeId().toString()]=t}const D={};for(const e of t.AttributePrivileges){const t=l(e);D[t.get_AttributeId().toString()]=t}const R=function(e){const t=e;return new b.a(t.ServerVersion,t.DatabaseVersion)}(t.ServerContext),x=Object(i.a)(t.FullServerVersion)?Object(s.a)():t.FullServerVersion,M=new a.a(t.TransactionCurrencyId),F=new a.a(t.DefaultDashboardId),k=new a.a(t.DefaultHomepageId),L=new a.a(t.DefaultInteractionCentricDashboardId),B={},U=Object(i.a)(t.EnvironmentId)?a.a.get_empty():new a.a(t.EnvironmentId);for(const e of t.TransactionCurrencies){const t=S(e);B[t.get_TransactionCurrencyId().toString()]=t}const V={};if(!Object(i.a)(t.TimeZoneDefinitions)&&t.TimeZoneDefinitions.length>0)for(const e of t.TimeZoneDefinitions){const t=y(e);V[t.get_TimeZoneCode().toString()]=t}else Object(r.e)("UserContextSerializer.LoadFromJson:",o.a.storage," User context Does not have any TimeZoneDefinitions");const z={};z[w.a.transactionCurrencyByIdExternalContextField]=B,z[w.a.timeZoneDefinitionByCodeExternalContextField]=V,z[w.a.isLiveExternalContextField]=t.IsLive,z[w.a.isOsdpOrganizationExternalContextField]=t.IsOsdpOrganization,z[w.a.usePathBasedUrlsExternalContextField]=t.UsePathBasedUrls,z[w.a.entityMetadataSyncConfigurationExternalContextField]=t.EntityMetadataSyncConfiguration;const W={},q=t.FCBContext;for(const e in q){const t=d({key:e,value:q[e]}.value);Object(i.a)(t)||(W[t.get_featureName()]=t)}return new w.a(n,c,u,v,C,j,T,A,D,R,E,h,_,M,F,k,L,x,N,z,W,P,U)}},amNf:function(e,t,n){"use strict";n.d(t,"i",(function(){return w})),n.d(t,"d",(function(){return A})),n.d(t,"e",(function(){return N})),n.d(t,"f",(function(){return R})),n.d(t,"g",(function(){return x})),n.d(t,"b",(function(){return T})),n.d(t,"c",(function(){return D})),n.d(t,"h",(function(){return j})),n.d(t,"a",(function(){return P}));var r=n("arV0"),a=n("zsAz"),i=n("fU4N"),o=n("TKDo"),s=n("cfbi"),c=n("JDi5"),l=n("fILV"),u=n("Nk+G"),d=n("OKVy"),p=n("gw2m"),g=n("fA3V"),h=n("16wZ"),f=n("ruPX"),m=n("tICD"),b=n("SAYH");var _=n("qshH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var y=n("odYE");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var v=n("d0w6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function S(e){return"savedview"===e||"savedquery"===e?v.b.savedview:"userview"===e||"userquery"===e?v.b.userview:null}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var O=n("EBJu"),C=n("6QGX"),E=n("5Oca"),I=n("Nb1E");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function w(e,t,n,a,i,o,s,c){"recordlist"===(null==n?void 0:n.pageType)&&(n.pageType="entitylist");const l=function(e,t){const n=[{name:"pageInput",value:e,isRequired:!0},{name:"pageType",value:null==e?void 0:e.pageType,isRequired:!0,isEventParam:!0}];if(!e)return n;switch(e.pageType){case"dashboard":n.push({name:"dashboardId",value:e.dashboardId,isEventParam:!0,expectedDataType:"guid"}),n.push({name:"entityType",value:e.entityType,isEventParam:!0,expectedDataType:"string"}),n.push({name:"navPath",value:e.navigationPath,isEventParam:!0,expectedDataType:"string"}),n.push({name:"type",value:e.type,isEventParam:!0});break;case"control":n.push({name:"controlName",value:e.controlName,isRequired:!0,isEventParam:!0,expectedDataType:"string"});break;case"inlinedialog":n.push({name:"uniqueName",value:e.uniqueName,isRequired:!0,isEventParam:!0,expectedDataType:"string"});break;case"entityrecord":n.push({name:"entityName",value:e.entityName,isRequired:!0,isEventParam:!0,expectedDataType:"string"}),n.push({name:"entityId",value:e.entityId,isEventParam:!0,expectedDataType:"guid"}),n.push({name:"formId",value:e.formId,isEventParam:!0,expectedDataType:"guid"}),n.push({name:"processId",value:e.processId,isEventParam:!0,expectedDataType:"string"}),n.push({name:"selectedStageId",value:e.selectedStageId,isEventParam:!0,expectedDataType:"string"});break;case"entitylist":n.push({name:"viewId",value:e.viewId,isEventParam:!0,expectedDataType:"guid"}),n.push({name:"viewType",value:e.viewType,isEventParam:!0,expectedDataType:"string"}),n.push({name:"entityName",value:e.entityName,isRequired:!0,isEventParam:!0,expectedDataType:"string"});break;case"search":n.push({name:"searchType",value:e.searchType,isEventParam:!0}),n.push({name:"EntityGroupName",value:e.EntityGroupName,isEventParam:!0}),n.push({name:"EntityNames",value:Array.isArray(e.EntityNames)?e.EntityNames.join(","):"",isEventParam:!0,expectedDataType:"string"});break;case"webresource":n.push({name:"webresourceName",value:e.webresourceName,isRequired:!0,isEventParam:!0});break;case"custom":n.push({name:"appname",value:e.name,isEventParam:!0});break;default:throw Object(h.e)(t,"Unexpected xrm page input",null,n)}return n}(n,t.getComponentName(a));return t.executeAsync(a,()=>{const t=N(n,i),a=A(n);return a.dialogOptions=o,a.newWindowOptions=s,e.dispatch(Object(f.a)(t,a,c,i)).then(t=>{if(0===t.status&&Object(r.f)(e.getState(),t.pageId))return j(e,t,n)})},l)}function j(e,t,n){return e.dispatch(Object(m.a)(t.pageId)).then(t=>{switch(null==n?void 0:n.pageType){case"entityrecord":return function(e,t,n){if(!(null==n?void 0:n.entityId)&&t.length>0){const r=t.map((e,t,n)=>({id:b.a.externalGuid(b.a.fromExternalGuid(e.id.guid)),entityType:e.etn,name:e.name})),a=r.map(t=>P(e,t,n.createFromEntity,n.relationship));return Promise.all(a).then(()=>({savedEntityReference:r}))}return{savedEntityReference:null}}(e,null==t?void 0:t.value,n);case"webresource":return{returnValue:null==t?void 0:t.value};default:return null}})}function P(e,t,n,r){if(r&&r.attributeName&&n&&t&&t.id&&t.entityType){if(!Object(C.d)(Object(E.j)(e.getState(),new y.a(t.entityType,new b.a(t.id)),r.attributeName))){if(r.roleType&&2===r.roleType){const e=t;t=n,n=e}const a=[new y.a(t.entityType,b.a.tryParseOrNull(t.id),t.name)],i=new y.a(n.entityType,b.a.tryParseOrNull(n.id),n.name);return e.dispatch(Object(I.a)(i,r.name,a))}}return Promise.resolve()}function T(e,t,n){if(n||(n=[]),e)switch(n.push({name:"pageType",value:e.pageType}),e.pageType){case"dashboard":
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
return function(e,t){const n={pageType:"dashboard",canOverride:e.canOverride,entityName:e.etn,dashboardId:e.dashboardId?b.a.externalGuid(e.dashboardId):void 0,entityType:e.etn,navigationPath:e.navPath};return e.type?n.type="system"===e.type?"system":"user":n.type=null,n}(e);case"entitylist":case"view":return function(e,t){const n={entityName:e.entityTypeName,pageType:"entitylist",viewId:e.viewId?b.a.externalGuid(e.viewId):void 0};return e.viewType?n.viewType=e.viewType===v.b.savedview?"savedquery":"userquery":n.viewType=null,n}(e);case"entityrecord":case"entity":case"mainformdialog":case"quickcreate":return function(e,t){const n={entityName:e.entityTypeName,data:e.data,entityId:e.id?b.a.externalGuid(e.id):void 0,formId:e.formId?b.a.externalGuid(e.formId):void 0,isCrossEntityNavigate:e.isCrossEntityNavigate,isOfflineSyncError:e.isOfflineSyncError,processId:e.processId,processInstanceId:e.processInstanceId,selectedStageId:e.selectedStageId,relationship:e.createFromRelationship,pageType:"entityrecord",formType:e.formType};return e.initWithEntity?n.createFromEntity={id:e.initWithEntity.id?b.a.externalGuid(e.initWithEntity.id):void 0,name:e.initWithEntity.name,entityType:e.initWithEntity.etn}:e.createFromEntity?n.createFromEntity={id:e.createFromEntity.id?b.a.externalGuid(e.createFromEntity.id):void 0,name:e.createFromEntity.name,entityType:e.createFromEntity.etn}:n.createFromEntity=null,n}(e);case"inlinedialog":case"dialog":return function(e,t,n){const r={data:e.data,uniqueName:e.uniqueName,pageType:null};switch(e.pageType){case"inlinedialog":r.pageType="inlinedialog";break;case"dialog":r.pageType="dialog";break;default:return _.a.getInstance().reportFailure(t,new Error("Invalid page type"),null,n),null}return r}(e,t,n);case"taskbasedflow":return{entityName:(r=e).entityTypeName,pageType:"taskbasedflow",uniqueName:r.uniqueName,entityId:r.id?b.a.externalGuid(r.id):void 0};case"custom":return e;default:return _.a.getInstance().reportFailure(t,new Error("UnSupported PageType"),null,n),null}var r;return _.a.getInstance().reportFailure(t,new Error("PageInput is null")),null}function N(e,t){switch(e.pageType){case"dashboard":return d.a;case"control":return u.a;case"inlinedialog":return o.a;case"entityrecord":if(null===e.formType||void 0===e.formType||2===e.formType)return s.a;if(9===e.formType){if(t&&"dialog"!==t.target)throw Object(a.d)("Unexpected target of navigationOptions for formType QuickCreate: "+t.target);return O.a}throw Object(a.d)("Unexpected formType of xrm page input: "+e.formType);case"entitylist":return l.a;case"search":return c.a;case"webresource":return g.a;case"custom":return p.a;default:throw Object(a.d)("Unexpected xrm page type")}}function A(e){switch(e.pageType){case"dashboard":return{navPath:(t=e).navigationPath,dashboardId:t.dashboardId&&new b.a(t.dashboardId),etn:t.entityName||t.entityType,type:t.type,canOverride:t.canOverride};case"control":return function(e){return{customControlId:e.controlName,data:e.data}}(e);case"inlinedialog":return function(e){return{uniqueName:e.uniqueName,entityTypeName:e.uniqueName,data:e.data}}(e);case"entityrecord":return function(e){let t;return e.createFromEntity&&(t=new y.a(e.createFromEntity.entityType,b.a.tryParseOrNull(e.createFromEntity.id),e.createFromEntity.name)),{entityTypeName:e.entityName,id:e.entityId?new b.a(e.entityId):void 0,data:e.data?e.data:void 0,formId:e.formId?new b.a(e.formId):void 0,processId:e.processId,processInstanceId:e.processInstanceId,selectedStageId:e.selectedStageId,isCrossEntityNavigate:e.isCrossEntityNavigate,initWithEntity:t,isOfflineSyncError:e.isOfflineSyncError,recordSetQueryKey:e.recordSetQueryKey,formType:e.formType}}(e);case"entitylist":return function(e){return{viewId:e.viewId&&new b.a(e.viewId),viewType:S(e.viewType),entityTypeName:e.entityName}}(e);case"search":return function(e){let t=null;if(e&&e.searchType)switch(+e.searchType){case 1:t=i.a.CategorizedSearch;break;case 0:t=i.a.RelevanceSearch;break;case 2:t=i.a.CustomSearch}return{pageType:e.pageType,searchType:t,searchText:e.searchText,EntityGroupName:e.EntityGroupName,SearchFilters:e.EntityNames}}(e);case"webresource":return function(e){return{webresourceName:e.webresourceName,webresourceData:{webresourceData:e.data}}}(e);case"custom":return function(e){return{name:e.name,entityName:e.entityName,recordId:e.recordId}}(e);default:throw Object(a.d)("Unexpected xrm page input")}var t}function D(e,t){switch(t.target){case 1:return{target:"inline"};case 2:return{target:"dialog"};case 3:return{target:"newWindow"};default:Object(h.j)(e+".convertXrmNavigationOptionsToRouter","navigationOptions.target")}}function R(e,t){let n,r,a,i,o=!1;t.position&&(n=1===t.position?"center":"side"),!t.width||"number"!=typeof t.width&&isNaN(+t.width)&&!M(t.width)?t.width&&Object(h.j)(e+".createDialogOptionsForRouter","DialogNavigationOptions.width"):r=F(e,t.width),!t.height||"number"!=typeof t.height&&isNaN(+t.width)&&!M(t.height)?t.height&&Object(h.j)(e+".createDialogOptionsForRouter","DialogNavigationOptions.height"):a=F(e,t.height),t.hideDialogHeader&&(o="boolean"==typeof t.hideDialogHeader&&t.hideDialogHeader),t.title&&"string"==typeof t.title?i=t.title:t.title&&Object(h.k)(e,"string","DialogNavigationOptions.title");return{width:r,height:a,windowPosition:n,hideDialogHeader:o,title:i}}function x(e,t){let n,r,a;return t&&(!t.width||"number"!=typeof t.width&&isNaN(+t.width)&&!M(t.width)?t.width&&Object(h.j)(e+".createNewWindowOptionsForRouter","NewWindowNavigationOptions.width"):n=F(e,t.width),!t.height||"number"!=typeof t.height&&isNaN(+t.width)&&!M(t.height)?t.height&&Object(h.j)(e+".createNewWindowOptionsForRouter","NewWindowNavigationOptions.height"):r=F(e,t.height),t.toolbar&&"boolean"==typeof t.toolbar&&(a=t.toolbar)),{width:n,height:r,toolbar:a}}function M(e){return"object"==typeof e&&"unit"in e&&"value"in e}function F(e,t){if(!M(t))return+t;switch(t.unit){case"px":return t.value;case"%":return t.value+"%";default:Object(h.j)(e+"._getLengthFromSizeValue","DialogNavigationOptions.SizeValue")}}},amok:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return f}));var r=n("eL04"),a=n("bvqZ"),i=n("P+p9"),o=n("ABCl"),s=n("SAYH"),c=n("sHzf"),l=n("16wZ"),u=n("amNf"),d=n("5X+N");class p{constructor(e,t){this._sidePanels={};Object(l.g)(e,"ClientApi.XrmAppPanels.constructor","store"),Object(l.g)(t,"ClientApi.XrmAppPanels.constructor","context"),this._applicationContext=t,this._store=e,this._clientApiExecutor=new o.b(e,"ClientApi.XrmAppPanels.")}loadPanel(e){return this._clientApiExecutor.executeAsync("loadPanel",()=>Object(d.a)().then(t=>{const n=e.pageInput?t.loadSidePanelWithPageInput(Object(u.e)(e.pageInput),Object(u.d)(e.pageInput),e.title,e.width,e.position,e.state,e.defaultCollapsedBehavior,e.replaceIfExisted,e.canBeClosed,e.canBeCollapsed,e.isTitleStatic,e.showTitle):t.loadSidePanelWithUrl(e.url,e.title,e.width,e.position,e.state,e.defaultCollapsedBehavior,!1,e.canBeClosed,e.canBeCollapsed,e.isTitleStatic,e.showTitle);return this._store.dispatch(n).then(e=>{const n=e.sidePanelId;return this._sidePanels[n]=new t.XrmAppPanel(this._store,this._applicationContext,n),n})}),[{name:"options",value:e,isRequired:!0},{name:"options.url_pageInput",value:e&&(e.url||e.pageInput),isRequired:!0}])}getPanel(e){return this._clientApiExecutor.execute("getPanel",()=>this._sidePanels[e],[{name:"id",value:e,isRequired:!0}])}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let g,h;function f(e){h=e}class m{constructor(e,t){Object(l.g)(e,"ClientApi.XrmApp.constructor","store"),Object(l.g)(t,"ClientApi.XrmApp.constructor","context"),this._context=t,g=e,this._clientApiExecutor=new o.b(e,"ClientApi.XrmApp.")}static getInstance(e,t){return Object(l.g)(e,"ClientApi.XrmApp.getInstance","store"),Object(l.g)(t,"ClientApi.XrmApp.getInstance","context"),m._instance||(m._instance=new m(e,t)),m._instance}addGlobalNotification(e){return this._clientApiExecutor.execute("addGlobalNotification",()=>{const t=Object.assign({id:s.a.newGuid().guid},e);switch(e.type){case 1:return g.dispatch(Object(a.b)(t)).then(()=>t.id);case 2:return g.dispatch(Object(r.b)(t)).then(()=>t.id);default:return Promise.reject("Notification type is not supported")}},[{name:"options",value:e,isRequired:!0},{name:"options.type",value:null==e?void 0:e.type,isRequired:!0}])}clearGlobalNotification(e){return this._clientApiExecutor.execute("clearGlobalNotification",()=>Promise.all([g.dispatch(Object(c.removeToastNotification)(e)),g.dispatch(Object(i.b)(e))]).then(()=>{}),[{name:"id",value:e,isRequired:!0,expectedDataType:"string"}])}get sessions(){return this._clientApiExecutor.execute("sessions_get",()=>(!this._sessions&&h&&(this._sessions=new h(g,this._context)),this._sessions))}get panels(){return this._clientApiExecutor.execute("panels_get",()=>(this._panels||(this._panels=new p(g,this._context)),this._panels))}}},arV0:function(e,t,n){"use strict";n.d(t,"n",(function(){return S})),n.d(t,"g",(function(){return c})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return h})),n.d(t,"f",(function(){return m})),n.d(t,"i",(function(){return d})),n.d(t,"m",(function(){return u})),n.d(t,"k",(function(){return _})),n.d(t,"l",(function(){return y})),n.d(t,"j",(function(){return v})),n.d(t,"e",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"h",(function(){return l}));var r=n("SAYH"),a=(n("oT5e"),n("+nTZ"),n("jq7Z")),i=n("9fGf"),o=n("dHD5"),s=n("P6DH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e,t){var n;return null===(n=Object(a.a)(e,t))||void 0===n?void 0:n.input}function l(e,t){var n;return null===(n=Object(a.a)(e,t))||void 0===n?void 0:n.pageNotifications}function u(e,t){let n=!1;const a=c(e,t);return a&&r.a.isNullOrEmpty(a.id)&&(n=!0),n}function d(e,t){const n=Object(a.a)(e,t);if(n)return n.output}function p(e,t){return c(e,t.id)}function g(e,t){var n;return null===(n=Object(a.a)(e,t))||void 0===n?void 0:n.dialogOptions}function h(e,t){var n;return null===(n=c(e,t))||void 0===n?void 0:n.dialogOptions}function f(e,t){var n;return(null===(n=h(e,t))||void 0===n?void 0:n.title)||v(e,t)}function m(e,t){const n=Object(a.a)(e,t);return!(!n||!n.isDialogStatus)&&n.isDialogStatus}function b(e,t){var n,r;const a=Object(o.k)(e,t),c=Object(s.j)()(e,t,a),l=Object(i.b)(e);return null===(r=null===(n=null==c?void 0:c.CustomControls)||void 0===n?void 0:n[l.toString()])||void 0===r?void 0:r.CustomControlId}function _(e,t){var n,r;return null!==(r=null===(n=c(e,t.id))||void 0===n?void 0:n.pageType)&&void 0!==r?r:null}function y(e,t){var n;return null===(n=Object(a.a)(e,t))||void 0===n?void 0:n.__pageName}function v(e,t){var n;return null===(n=Object(a.a)(e,t))||void 0===n?void 0:n.__pageTitle}function S(e,t){const n=Object(a.a)(e,t);return null==n?void 0:n.isPageUnmounted}},b2mI:function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return h}));var r=n("Ydwo"),a=n("504W"),i=n("UDbe"),o=n("VA/h"),s=n("jPIj"),c=n("jZCH"),l=n("qCX6"),u=n("EW4s"),d=n("bATk"),p=n("TFb5");function g(e,t,n,r){if(!Object(a.a)(e)){const i=e.getAttributeMetadata(t,n);if(Object(a.a)(i))n="!attr-"+t+"-"+n+"!";else if("lookup"===i.get_type()||"customer"===i.get_type()||"owner"===i.get_type())n="["+n+"!id]";else if(!Object(a.a)(i.get_attributeOf())){const o=e.getAttributeMetadata(t,i.get_attributeOf());Object(a.a)(o)||"lookup"!==o.get_type()&&"customer"!==o.get_type()&&"owner"!==o.get_type()||("entityname"===i.get_type()?(n="["+i.get_attributeOf()+"!logicalname]",Object(a.a)(r.val)||(r.val=e.getEntityMetadataByTypeCode(Number.parseInvariant(r.val)).get_logicalName())):n="["+i.get_attributeOf()+"!name]")}}return n}function h(e,t){const n=new u.a;return function(e){const t=new u.a,n=[];for(const t of e){const e=Sys.Net.XMLDOM(t.get_value()).getElementsByTagName("entity")[0].attributes.getNamedItem("name").nodeValue;l.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e)&&n.push(c.a.get_DefaultInstance().retrieveEntityMetadata(e,null))}return Object(o.a)(n).then(e=>{const n={};for(const t of e)n[t.get_logicalName()]=t;t.resolve(n)},e=>{t.reject(e)}),t}(e).then(o=>{const u={};for(const h of e){const e=[];let f=null;const m=h.get_value(),b="BaseEntityAlias",_=Sys.Net.XMLDOM(m),y=_.getElementsByTagName("entity")[0].attributes.getNamedItem("name").nodeValue;if(l.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(y)){const n=_.getElementsByTagName("attribute"),l=_.getElementsByTagName("link-entity")[0],m=_.getElementsByTagName("filter")[0],v=_.getElementsByTagName("condition")[0];Object(a.a)(v)||v.attributes.setNamedItem(s.a.createAttribute(_,"value",t.get_identifier()));for(let t=0;t<n.length;t++){const a=n[t].attributes.getNamedItem("name").nodeValue;let o=g(c.a.get_DefaultInstance().get_MetadataCache(),y,a,Object(r.a)(()=>f,e=>f=e));o=o.replace(new RegExp("[\\[\\]]","g"),""),o===a+"!id"&&e.push(new i.a(b+"."+a+"!logicalname")),o=b+"."+o,e.push(new i.a(o))}e.push(new i.a(b+"."+o[y].get_primaryIdAttribute()));let S=null;const O=Object(d.a)(null,y,!0);S=Object(a.a)(e)?O.selectAllColumns():O.selectIndexedColumnsStatement(e);const C=S.replace(new RegExp(" \\[BaseEntityAlias\\.","g")," [BaseEntityAlias].[");S=C+" as "+b;const E=Object(p.o)(l,"name"),I=Object(p.o)(l,"alias"),w="["+E+"] AS "+I+" ON (["+b+"]."+g(c.a.get_DefaultInstance().get_MetadataCache(),y,Object(p.o)(l,"to"),Object(r.a)(()=>f,e=>f=e))+" = ["+I+"]."+g(c.a.get_DefaultInstance().get_MetadataCache(),E,Object(p.o)(l,"from"),Object(r.a)(()=>f,e=>f=e)),j="["+I+"].["+Object(p.o)(v,"attribute")+"] = '"+v.attributes.getNamedItem("value").nodeValue+"' COLLATE NOCASE ",P=" JOIN "+w+" COLLATE NOCASE "+Object(p.o)(m,"type")+" (( "+j+"))) ";u[h.get_key().get_schemaName()]=S+P}n.resolve(u)}},e=>{n.reject(e)}),n}},b6oC:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("84PK"),a=n("NMtn");class i{constructor(e,t,n,r,i,o,s){this._name=null,this._privilegeId=null,this._privilegeType=0,this._canBeBasic=!1,this._canBeLocal=!1,this._canBeDeep=!1,this._canBeGlobal=!1,Object(a.d)(e,"name"),Object(a.d)(t,"privilegeId"),this._name=e,this._privilegeId=t,this._privilegeType=n,this._canBeBasic=r,this._canBeLocal=i,this._canBeDeep=o,this._canBeGlobal=s}get_privilegeId(){return this._privilegeId}get_privilegeType(){return this._privilegeType}get_privilegeTypeKey(){return i.getPrivilegeTypeKey(this.get_privilegeType())}get_canBeGlobal(){return this._canBeGlobal}getObjectData(){const e={};return e.name=this._name,e.privilegeid=this._privilegeId.getObjectData(),e.privilegetype=this._privilegeType,e.canbebasic=this._canBeBasic,e.canbelocal=this._canBeLocal,e.canbedeep=this._canBeDeep,e.canbeglobal=this.get_canBeGlobal(),e}getODataObject(){const e={};return e.Name=this._name,e.PrivilegeId=this._privilegeId.toString(),e.PrivilegeType=this._privilegeType,e.CanBeBasic=this._canBeBasic,e.CanBeLocal=this._canBeLocal,e.CanBeDeep=this._canBeDeep,e.CanBeGlobal=this.get_canBeGlobal(),e}static getPrivilegeTypeKey(e){return e.toString()}static createFromObjectData(e){const t=e.name,n=r.a.createFromObjectData(e.privilegeid),a=e.privilegetype,o=e.canbebasic,s=e.canbelocal,c=e.canbedeep,l=e.canbeglobal;return new i(t,n,a,o,s,c,l)}static createFromOData(e){const t=e.Name,n=r.a.tryCreate(e.PrivilegeId),a=e.PrivilegeType,o=e.CanBeBasic,s=e.CanBeLocal,c=e.CanBeDeep,l=e.CanBeGlobal;return new i(t,n,a,o,s,c,l)}}},b8TU:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s}));var r=n("unFF");function a(e){return e.deviceSize}function i(e){const t=a(e),{deviceHeight:n}=t;return n}function o(e){const t=a(e),{deviceWidth:n}=t;return n}function s(e){const t=Object(r.a)(e);return o(e)<=t.sizes.Breakpoints.DimensionS}},b8dX:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return h}));var r,a,i=n("nuS9"),o=n("4fxQ"),s=n("YWpA"),c=n("sTJm"),l=n("tMKU"),u=n("p4DY"),d=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),p=function(){return(p=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function g(e,t){return{display:e?t.display?t.display:"flex":"none"}}!function(e){e[e.Root=1]="Root",e[e.Nested=2]="Nested"}(a||(a={}));var h=function(e){function t(t){var n=e.call(this,t)||this;return n._rootElement=null,n._popupElement=null,n._stopPropagation=function(e){e.stopPropagation()},n._forceClosePopup=function(e){n._stopPropagation(e),n.props.closeOnOutsideClick&&(n.setState({forceClose:!0}),n.props.onPopupForcedClosed&&n.props.onPopupForcedClosed())},n.state={forceClose:!1},n._rootElement=document.getElementById(t.rootPopupId),n._accessibilityComponent=n._createAccessibilityComponentIfNeeded(),n}return d(t,e),t.prototype._getId=function(){return this.props.rootPopupId+"_"+(this.props.id||"innerPopup")},t.prototype._getCurrentPopupToOpen=function(e,t){var n="";!e&&t&&(n=t.split(".")[0]);return n},t.prototype._getNextPopupToOpen=function(e,t){var n="";if(!e&&t){var r=t.split(".");r.splice(0,1),n=r.join(".")}return n},t.prototype._getChildrenProps=function(){return{type:a.Nested,parent:this._popupElement,popupToOpen:this._getNextPopupToOpen(this.state.forceClose,this.props.popupToOpen),rootPopupId:this.props.rootPopupId}},t.prototype._getChildrenWithProps=function(e){var n=this;return e?e.map?e.map((function(e){return e.type===t?i.cloneElement(e,n._getChildrenProps()):e})):e===t?i.cloneElement(e,this._getChildrenProps()):e:null},t.prototype._isVisible=function(){return this._getCurrentPopupToOpen(this.state.forceClose,this.props.popupToOpen)===this.props.name},t.prototype._applyRootNodeStyle=function(){Object.assign(this._rootElement.style,this.props.rootStyle),this._toggleRootElementVisibility()},t.prototype._toggleRootElementVisibility=function(){this.props.isDialogPopup||(this._rootElement.getAttribute(c.a)?"none"===this._rootElement.style.display&&(this._rootElement.style.display="flex"):this._rootElement.style.display="none")},t.prototype._getStaticContent=function(){var e=null;return this.props.content&&(e=i.createElement(s.a,{ref:"staticContent"})),e},t.prototype._createAccessibilityComponentIfNeeded=function(){var e=this.props,t=e.createAccessibilityComponent,n=e.rootPopupId;return t&&n?t({id:this._getId(),rootElementId:n,shouldManageFocus:!0}):null},t.prototype._registerPopup=function(e,t){var n=e.name,r=e.popupToOpen,a=t.forceClose,i=this._rootElement.getAttribute(c.a),o=(i=i||"").indexOf(n);a||n!==this._getCurrentPopupToOpen(a,r)?~o&&this._rootElement.setAttribute(c.a,i.replace("."+n,"")):~o||this._rootElement.setAttribute(c.a,i.concat("."+n))},t.prototype._subscribeFlyoutPopupManager=function(){var e=this;this._managerSubscriber={type:u.a.Popup,onPointerDown:function(t){t.target===document.getElementById(e._getId())&&e._forceClosePopup(t)},getComponent:function(){return e._popupElement}},l.a.getInstance().addSubscribers(this._managerSubscriber)},t.prototype.componentWillMount=function(){this.props.isDialogPopup||this._registerPopup(this.props,this.state)},t.prototype.componentDidMount=function(){var e=this;this._popupElement=o.findDOMNode(this.refs.popup),this.forceUpdate((function(){var t=e.refs.staticContent;t&&o.findDOMNode(t).appendChild(e.props.content)})),this._subscribeFlyoutPopupManager()},t.prototype.componentWillReceiveProps=function(){this.setState({forceClose:!1})},t.prototype.componentWillUpdate=function(e,t){this._registerPopup(e,t);var n=this.refs.staticContent;if(n){for(var r=o.findDOMNode(n);r.firstChild;)r.removeChild(r.firstChild);r.appendChild(e.content)}},t.prototype.componentDidUpdate=function(e){this.props.createAccessibilityComponent&&e.rootPopupId!==this.props.rootPopupId&&console.warn("rootPopupId changed for "+this._getId()+". Focus will not be managed for this popup.")},t.prototype.componentWillUnmount=function(){l.a.getInstance().removeSubscribers(this._managerSubscriber)},t.prototype._adjustPixelValue=function(e,t){if(!e||"number"==typeof e||-1===e.indexOf("px"))return e;e=e.substring(0,e.indexOf("px"));var n=t?this.props.rootBodyElement.getBoundingClientRect().width:this.props.rootBodyElement.getBoundingClientRect().height,r=t?this.props.rootBodyElement.offsetWidth:this.props.rootBodyElement.offsetHeight;return(Number.parseFloat(e)-(t?this.props.rootBodyElement.getBoundingClientRect().left:this.props.rootBodyElement.getBoundingClientRect().top))/(n/r)+"px"},t.prototype._generatePopupStyle=function(){var e=Object.assign({},this.props.popupStyle);return!e.position||"absolute"!==e.position.toLowerCase()&&"fixed"!==e.position.toLowerCase()||this.props.rootBodyElement&&this.props.rootBodyElement!==document.body&&(e.left=this._adjustPixelValue(e.left,!0),e.right=this._adjustPixelValue(e.right,!0),e.top=this._adjustPixelValue(e.top,!1),e.bottom=this._adjustPixelValue(e.bottom,!1)),Object.assign({},e,this.props.isDialogPopup?{}:g(this._isVisible(),this.props.popupStyle))},t.prototype.render=function(){var e,t,n=this.props,r=n.children,a=n.isDialogPopup,o=n.parent,c=n.shadowStyle,u=n.style,d=a?u:Object.assign({},u,function(e,t){var n=Object.assign({},e),r=t&&t.getBoundingClientRect();return r&&(n.top=parseInt(n.top,10)-r.top+"px",n.left=parseInt(n.left,10)-r.left+"px"),n}(c,o),g(this._isVisible(),c)),h=this._generatePopupStyle();this._applyRootNodeStyle();var f=((e={})[l.a.pointerDownEvent]=this._forceClosePopup,e),m=((t={})[l.a.pointerDownEvent]=this._stopPropagation,t);return i.createElement(s.a,p({id:this._getId(),style:d},f),i.createElement(s.a,p({style:h},m,{ref:"popup"}),this._getStaticContent(),this._getChildrenWithProps(r)),this._accessibilityComponent)},t}(i.Component);h.defaultProps={shadowStyle:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.3)"},isDialogPopup:!1,type:a.Root,closeOnOutsideClick:!1}},bATk:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n("504W"),a=n("hgKT"),i=n("BSGX"),o=n("8N/3"),s=n("aOBz"),c=n("4Gtd");class l{constructor(e,t){this._query=null,this._storeName=null,this.collateNoCase=!1,this._doPaging=!1,this._offset=0,this._limit=0,this._query=e,this._storeName=t}get_selectJsonStatement(){return this.buildSelect(c.c+", "+c.d)+(this.get_doPaging()?" LIMIT "+this.get_limit()+" OFFSET "+this.get_offset():"")}get_selectIdStatement(){return this.buildSelect(c.c)+(this.get_doPaging()?" LIMIT "+this.get_limit()+" OFFSET "+this.get_offset():"")}get_selectCountStatement(){return this.buildSelect("COUNT(*)")}get_sqlArguments(){return this.get_whereArgs()}get_doPaging(){return this._doPaging}set_doPaging(e){return this._doPaging=e,e}get_offset(){return this._offset}set_offset(e){return this._offset=e,e}get_limit(){return this._limit}set_limit(e){return this._limit=e,e}get_whereSql(){return""}get_whereArgs(){return[]}_get_OrderBySql(){let e="";if(this._HasSortBy()){e="ORDER BY";for(let t=0;t<this._query.get_sortBy().length;++t){const n=this._query.get_sortBy()[t];e+=" ["+n.get_sortField().get_path()+"] "+l._GetSortOp(n.get_sortOrder())+(t<this._query.get_sortBy().length-1?",":"")}}return e}selectAllColumns(){return this.buildSelect("*")}selectIndexedColumnsStatement(e){let t="";for(let n=0;n<e.length;++n)t+="["+e[n].get_path()+"]",n+1<e.length&&(t+=", ");return this.buildSelect(t)+(this.get_doPaging()?" LIMIT "+this.get_limit()+" OFFSET "+this.get_offset():"")}_HasSortBy(){return!!this._query&&!!this._query.get_sortBy()&&this._query.get_sortBy().length>0}buildSelect(e){let t="SELECT "+e+" FROM ["+this._storeName+"]";const n=this.get_whereSql();n&&(t+=" "+n),this.collateNoCase&&(t+=" COLLATE NOCASE");const r=this._get_OrderBySql();return r&&(t+=" "+r),t}static _GetSortOp(e){return e?"DESC":"ASC"}}class u extends l{constructor(e,t){super(e,t),this._filter=null,this._filter=e.get_filter()}get_whereSql(){return"WHERE ["+this._filter.get_field().get_path()+"] = ?"}get_whereArgs(){return[this._filter.get_fieldValue()]}}var d=n("KJT0");class p extends l{constructor(e,t){super(e,t),this._filter=null,this._filter=e.get_filter()}get_whereSql(){const e=" ["+this._filter.get_field().get_path()+"] ";return"WHERE"+e+this._get_LeftOp()+" ? AND"+e+this._get_RightOp()+" ?"}get_whereArgs(){return[this._filter.get_leftBound(),this._filter.get_rightBound()]}_get_LeftOp(){let e=">";return this._filter.get_intervalType()&&this._filter.get_intervalType()!==d.a.openRight||(e+="="),e}_get_RightOp(){let e="<";return this._filter.get_intervalType()&&this._filter.get_intervalType()!==d.a.openLeft||(e+="="),e}}var g=n("uTcl"),h=n("84uC");class f extends l{constructor(e,t){super(e,t),this._filter=null,this._filter=e.get_filter()}get_whereSql(){let e;switch(this._filter.get_operatorType()){case 0:e=this._filter.get_borderType()===g.a.closed?">=":">";break;case h.a.lessThan:e=this._filter.get_borderType()===g.a.closed?"<=":"<";break;default:throw Error.invalidOperation("OperatorType is not supported.")}return"WHERE ["+this._filter.get_field().get_path()+"] "+e+" ?"}get_whereArgs(){return[this._filter.get_borderValue()]}}class m extends l{constructor(e,t){super(e,t),this._filter=null,this._filter=e.get_filter()}get_selectJsonStatement(){return this.buildSelect(c.c+", "+c.d)}get_selectIdStatement(){return this.buildSelect(c.c)}selectIndexedColumnsStatement(e){let t="";for(let n=0;n<e.length;++n)t+="["+e[n].get_path()+"]",n+1<e.length&&(t+=", ");return this.buildSelect(t)}get_whereSql(){let e="WHERE ["+this._filter.get_field().get_path()+"] "+this._get_InOp()+" (",t="";for(let n=this._get_InStartIndex();n<this._get_InEndIndex();n++)e+=t+this._get_InPlaceholder(),t=",";return e+=")",e}get_whereArgs(){const e=[];for(let t=this._get_InStartIndex();t<this._get_InEndIndex();t++)e.push(this._filter.get_inValues()[t]);return e}_get_InStartIndex(){return this.get_doPaging()?this.get_offset():0}_get_InEndIndex(){return this.get_doPaging()&&this.get_offset()+this.get_limit()<this._filter.get_inValues().length?this.get_offset()+this.get_limit():this._filter.get_inValues().length}_get_InPlaceholder(){return"?"}_get_InOp(){return"IN"}}function b(e,t,n){let c=null;return e&&e.get_filter()?e.get_filter()instanceof i.a?c=new u(e,t):e.get_filter()instanceof o.a?c=new p(e,t):e.get_filter()instanceof s.a?c=new f(e,t):e.get_filter()instanceof a.a&&(c=new m(e,t)):c=new l(e,t),Object(r.a)(n)||n||(c.collateNoCase=n),c}},bEud:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.unknown=-1]="unknown",e[e.referencing=0]="referencing",e[e.referenced=1]="referenced"}(r||(r={}))},bJSG:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Field.Information.SelectParent",a="Field.Information.IncompleteChain",i=[r,a]},bK23:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var r,a=n("504W"),i=n("NMtn"),o=n("zsAz");!function(e){e[e.Svg=0]="Svg"}(r||(r={}));class s{constructor(e){if(this._originalString=null,this._scheme=null,this._authority=null,this._host=null,this._port=null,Object(i.c)(e,"uri"),!s._uriRegex.test(e))throw Error.format("Input string is not a valid URI: "+e);const t=s._uriRegex.exec(e);if(this._originalString=e,this._scheme=t[1],this._authority=t[2],!Object(a.b)(this._authority)){if(!s._authorityRegex.test(this._authority))throw Error.format("Input string is not a valid URI: "+e);const t=s._authorityRegex.exec(this._authority);this._host=t[2],this._port=t[3]}}get_originalString(){return this._originalString}get_scheme(){return this._scheme}get_host(){return this._host}get_port(){return this._port}toString(){return this.get_originalString()}static createDataUri(e,t){let n;switch(e){case r.Svg:n="image/svg+xml";break;default:throw Object(o.d)("Unexpected URI Mime Type")}return new s(`data:${n};base64,${t}`)}}s.uriSchemeHttps="https",s._uriSegmentationPattern="^(?:([^:/?#]+):)?(?://([^/?#]*))?([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$",s._decOctetPattern="(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])",s._pctEncodedPattern="%[A-Fa-f0-9][A-Fa-f0-9]",s._unreservedPattern="[A-Za-z0-9-\\._~]",s._subDelimsPattern="[!\\$&'\\(\\)\\*\\+,;=]",s._iPv4AddressPattern=String.format("{0}.{0}.{0}.{0}",s._decOctetPattern),s._regNamePattern=String.format("(?:{0}|{1}|{2})*",s._unreservedPattern,s._pctEncodedPattern,s._subDelimsPattern),s._hostPattern=String.format("({0}|{1})",s._iPv4AddressPattern,s._regNamePattern),s._userinfoPattern=String.format("((?:{0}|{1}|{2}|:)*)",s._unreservedPattern,s._pctEncodedPattern,s._subDelimsPattern),s._authorityPattern=String.format("^(?:{0}@)?{1}(?::([0-9]*))?$",s._userinfoPattern,s._hostPattern),s._uriRegex=new RegExp(s._uriSegmentationPattern),s._authorityRegex=new RegExp(s._authorityPattern)},bRS5:function(e,t,n){"use strict";n.d(t,"c",(function(){return j})),n.d(t,"b",(function(){return P})),n.d(t,"a",(function(){return T})),n.d(t,"d",(function(){return R})),n.d(t,"e",(function(){return x}));var r=n("Ae6N"),a=n("umme"),i=n("84PK"),o=n("504W"),s=n("Div0"),c=n("VA/h"),l=n("LFDu"),u=n("l3Ef"),d=n("03Hu"),p=n("ZJD9"),g=n("thzq"),h=n("WWG3"),f=n("HYaY"),m=n("WRF3"),b=n("IvgJ"),_=n("KLhE"),y=n("sdkC"),v=n("MUIu"),S=n("T544"),O=n("jZCH"),C=n("EW4s"),E=n("lR0U"),I=n("ufH1");let w=null;function j(){w=new l.a,w.initialize(),Object(E.d)(w)}function P(e,t,n){const r=new C.a;return O.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(new S.a(e.get_identifier().LogicalName,t),null).then(a=>{for(const r of a){const a={};switch(r.get_logicalName()){case u.W:if(n.get_hasStateCode()&&(a[u.Z]=Object(o.a)(r.get_defaultFormValue())?0:r.get_defaultFormValue(),e.initializeValue(r.get_logicalName(),b.a.createFromObjectData(a),"state")),-1!==t.indexOf(u.X)&&!Object(o.a)(e.getFieldObjectData(u.W))){const t=e.getFieldObjectData(u.W)[u.Z],n=r.get_optionSet().get_options()[t.toString()].get_defaultStatus();a[u.Z]=n,e.initializeValue(u.X,b.a.createFromObjectData(a),"status")}break;case u.X:break;case u.p:case u.I:a[r.get_logicalName()]=new Date(Date.now()),e.initializeValue(r.get_logicalName(),a[r.get_logicalName()],"datetime");break;case u.o:case u.H:case u.M:r.get_logicalName()===u.M&&n.get_ownershipType()!==_.a.userOwned||(a[u.y]=d.a.get_DefaultInstance().get_offlineTypescriptInterface().getUserId().getObjectData(),a[u.F]=u.Y,a[u.a]=d.a.get_DefaultInstance().get_offlineTypescriptInterface().getUserName(),e.initializeValue(r.get_logicalName(),m.a.createFromObjectData(a),"lookup"));break;default:"picklist"!==r.get_type()||Object(o.a)(r.get_defaultFormValue())||(a[u.Z]=r.get_defaultFormValue(),e.initializeValue(r.get_logicalName(),b.a.createFromObjectData(a),r.get_type())),r.get_type()||(a[u.Z]=Object(o.a)(r.get_defaultFormValue())?r.get_defaultValue()?1:0:r.get_defaultFormValue(),e.initializeValue(r.get_logicalName(),b.a.createFromObjectData(a),r.get_type()))}}r.resolve(e)},e=>{r.reject(e)}),r}function T(e,t,n,r,a){let s={};const l={},d=new C.a,p=new y.a(new Array(0));let g,h=i.a.get_empty();const b=[];for(const r in e){const c={key:r,value:e[r]};c.key===n.get_primaryIdAttribute()?h=i.a.tryCreate(c.value.toString().toUpperCase()):c.key===n.get_primaryNameAttribute()&&(g=c.value);const d=c.key.split(u.l),p=Object(o.a)(d[0])?"":d[0],f=2!==d.length||Object(o.a)(d[1])?"":d[1];b.push(N(s,l,t[p],p,f.toLowerCase(),c.value,n.get_logicalName(),a,null))}return Object(c.a)(b).then(()=>{const e=new m.a(n.get_logicalName(),h,g);n.get_isOptimisticConcurrencyEnabled()&&u.bb in s&&!Object(o.a)(s[u.bb])&&e.setValue(u.V,s[u.bb].toString()),s=function(e,t){const n={};for(const r in e){const a={key:r,value:e[r]};switch(t[a.key]){case"owner":case"customer":case"lookup":Object(o.a)(a.value[u.y])?n[a.key]=null:n[a.key]=f.a.createSingleFieldFromObjectData(a.value,t[a.key]);break;default:n[a.key]=f.a.createSingleFieldFromObjectData(a.value,t[a.key])}}return n}(s,t);const a=new f.a(e,s,t,l,{},p);a.set_clientRetrieveOptions(r),d.resolve(a)},e=>{d.reject(e)}),d}function N(e,t,n,c,l,d,p,g,f){const m=new C.a;if(!R(n))return m.resolve();if(p===u.d&&c===u.M)return m.resolve();const b=w.isComplexAttribute(n),_=w.getAttributeType(n,l);if(b)switch(c in e||(e[c]={}),_===i.a?e[c][l]=Object(o.a)(d)||i.a.isNullOrEmpty(d.toString())?null:{rawguid:d.toString()}:Object(o.b)(l)||(e[c][l]=d),n){case"owner":case"lookup":case"customer":O.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(new S.a(p,[c]),null).then(t=>{if(t&&t.length>0){const n=t[0];Object(o.a)(n)||Object(o.a)(n.get_targets())||1!==n.get_targets().length||(e[c][u.F]=n.get_targets()[0]),m.resolve()}else m.reject(a.a.FromMessage("AttributeMetadata not found for "+c))},e=>{m.reject(e)});break;case"aliasedvalue":if(Object(o.a)(d))m.resolve();else if(!Object(o.a)(g))if(c in g){const n=g[c],r=n[u.h],a=n[u.i],i=[a];e[c][u.r]=r,e[c][u.j]=a,O.a.get_DefaultInstance().getAttributeTypes(r,i,null).then(n=>{a in n&&(e[c][u.k]=n[a],N(e,t,n[a],a,l,d,r,null,c).then(()=>{m.resolve()},e=>{m.reject(e)}))},e=>{m.reject(e)})}else m.reject(a.a.FromMessage("AttributeMetadata not found for "+c));break;default:m.resolve()}else switch(n){case"picklist":case"state":case"status":case"boolean":case"datetime":Object(o.a)(d)?(Object(I.e)("Entitybuilder.FillColumnValue",s.a.offlineDataStore,"Value is null for entitylogicalname = "+p+", attributeType = "+n),A(e,c,null,f),m.resolve()):O.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(new S.a(p,[c]),null).then(i=>{if(i&&i.length>0){const a=i[0];if("datetime"===n)D(t,c,null,f),A(e,c,d.toString().length>0?Object(v.b)(d.toString()):null,f),Object(o.a)(a)||Object(o.a)(e[c])||(a.get_behavior()===r.a.UserLocal||a.get_behavior()===r.a.TimeZoneIndependent?D(t,c,h.a.get_instance().formatShortDateTimeValue(new Date(Date.parse(e[c])),a.get_behavior()),f):a.get_behavior()===r.a.DateOnly&&D(t,c,h.a.get_instance().formatShortDateValue(new Date(Date.parse(e[c])),r.a.DateOnly),f));else{let t="";if(Object(o.a)(a)||Object(o.a)(a.get_optionSet())||Object(o.a)(a.get_optionSet().get_options())||!(d.toString()in a.get_optionSet().get_options())){const e=Object(o.a)(a)?"attributemetadata is null ":Object(o.a)(a.get_optionSet())?"attributemetadata.OptionSet is null ":Object(o.a)(a.get_optionSet().get_options())?"attributemetadata.OptionSet.Options is null ":"attributemetadata.OptionSet.Options does not contain option for given value : "+d;Object(I.e)("Entitybuilder.FillColumnValue",s.a.offlineDataStore,e+", entitylogicalname = "+p+", attributeType = "+n)}else t=a.get_optionSet().get_options()[d.toString()].get_Label();A(e,c,{value:Number.parseInvariant(d.toString()),label:t},f)}m.resolve()}else m.reject(a.a.FromMessage("AttributeMetadata not found for "+c))},e=>{m.reject(e)});break;case"uniqueidentifier":A(e,c,Object(o.a)(d)||Object(o.b)(d.toString())?null:{rawguid:d.toString()},f),m.resolve();break;case"entityname":Object(o.a)(d)?(A(e,c,null,f),m.resolve()):O.a.get_DefaultInstance().retrieveEntityMetadata(d.toString(),null).then(n=>{Object(o.a)(n)||(A(e,c,n.get_logicalName(),f),D(t,c,n.get_displayName(),f)),m.resolve()},e=>{m.reject(e)});break;default:Object(o.a)(d)||Object(o.b)(d.toString())?A(e,c,null,f):A(e,c,d,f),m.resolve()}return m}function A(e,t,n,r){Object(o.a)(r)||Object(o.a)(e[r])?e[t]=n:e[r][u.Z]=n}function D(e,t,n,r){Object(o.a)(r)?e[t]=n:e[r]=n}function R(e){switch(e){case"unknown":case"decimal":case"double":case"integer":case"memo":case"money":case"string":case"uniqueidentifier":case"bigint":case"owner":case"customer":case"lookup":case"datetime":case"picklist":case"state":case"status":case"boolean":case"entityname":case"aliasedvalue":case"multiselectpicklist":return!0;default:return!1}}function x(e,t,n,r,a){const i=new C.a,s=p.a.get_createDefaultValues();s.push(u.bb);const l=s.indexOf(u.M);if(l>=0&&s.splice(l,1),n===g.a.Create){const n=[];for(const a of e.get_fieldNames())s.indexOf(a)<0&&n.push(M(e,t[a],r,a));n.length<=0?i.resolve(e):Object(c.a)(n).then(()=>{i.resolve(e)},e=>{i.reject(e)})}else if(n===g.a.Update){for(const n of e.get_fieldNames())if(s.indexOf(n)<0){const i=t[n];if(Object(o.a)(i)||"lookup"!==i&&"customer"!==i&&"owner"!==i)r[n]!==a[n]&&e.get_changedFieldNames().push(n);else{const t=n+"!id";r[t]!==a[t]&&e.get_changedFieldNames().push(n)}}i.resolve(e)}else i.resolve(e);return i}function M(e,t,n,r){const i=new C.a;if(Object(o.a)(t)||"lookup"!==t&&"customer"!==t&&"owner"!==t)if(Object(o.a)(n[r]))i.resolve(!0);else{const n="status"===t?u.W:r;O.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(new S.a(e.get_identifier().LogicalName,[n]),null).then(n=>{if(n&&n.length>0){const a=n[0];if("boolean"===t||"picklist"===t||"state"===t){const t=e.getValue(r).get_value();if(!(Object(o.a)(a)||Object(o.a)(a.get_defaultValue())&&Object(o.a)(a.get_defaultFormValue()))){if((Object(o.a)(a.get_defaultFormValue())?a.get_defaultValue()?1:0:a.get_defaultFormValue())===t)return void i.resolve(!0)}}else if("status"===t&&!Object(o.a)(a)){const t=e.getValue(u.W).get_value(),n=a.get_optionSet().get_options()[t.toString()].get_defaultStatus();if(e.getValue(r).get_value()===n)return void i.resolve(!0)}e.get_changedFieldNames().push(r),i.resolve(!0)}else i.reject(a.a.FromMessage("AttributeMetadata not found for "+r+" in  entity "+e.get_identifier().get_identifier()))},e=>{i.reject(e)})}else{const t=function(e,t){const n=t[e+"!id"],r=t[e+"!logicalname"],a=t[e+"!name"];if(!Object(o.a)(n)&&!Object(o.a)(r))return Object(o.a)(a)?new m.a(r.toString(),n):new m.a(r.toString(),n,a.toString());return null}(r,n);Object(o.a)(t)||e.get_changedFieldNames().push(r),i.resolve(!0)}return i}},bT7G:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"f",(function(){return l}));var r=n("odYE"),a=n("5Oca");function i(e){const t=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return e&&e.data&&void 0!==e.data.lastSnapshotNumber?e.data.lastSnapshotNumber:null}(e);return null===t?0:t+1}function o(e,t){return e&&e.data&&e.data.snapshots&&t&&e.data.snapshots.hasOwnProperty(t)?e.data.snapshots[t]:null}function s(e,t){if(!e||!e.data||!e.data.snapshots)return null;const n=Object.keys(e.data.snapshots).filter(n=>r.a.equals(e.data.snapshots[n].identifier,t));return n&&n.length>0?e.data.snapshots[n[n.length-1]]:null}function c(e,t,n,r){const i=o(e,t);if(i){const e=i.activeChanges?i.activeChanges[r]:i.lockedChanges?i.lockedChanges[r]:null;if(e)return e}return Object(a.j)(e,n,r)}function l(e,t,n){const r=o(e,t);return!!r&&(r.activeChanges&&null!=r.activeChanges[n])}function u(e,t,n){const r=o(e,t);return!(!r||!r.activeChanges)&&r.activeChanges.hasOwnProperty(n)}function d(e,t){const n=o(e,t);return!(!n||!n.activeChanges)}function p(e,t,n,r,a){const i={initialized:n.initialized,identifier:r,fields:{}};if(n)for(const n of a)i.fields[n]=c(e,t,r,n);return i}},bUa6:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n("nuS9"),a=n("u+q+"),i=n("pF61"),o=n("YWpA"),s=n("QVDB"),c=n("vIHs"),l=n("unFF"),u=n("4fxQ"),d=n("b8TU"),p=n("QBtP"),g=n("gQ5I"),h=n("aOhN"),f=n("Knfm"),m=n("GEbX"),b=n("QbIY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const _={display:"flex",flexDirection:"column",height:"100%",flexGrow:1};class y extends r.Component{constructor(e){super(e),this.state={errorPopupData:null}}componentDidMount(){this._getErrorPopupDescriptor(this.props);const e=u.findDOMNode(this);if(e){const t=e.style.opacity;e.style.opacity="1",e.style.opacity=t}}_getErrorPopupDescriptor(e){const t=this.context.EventManager.getActivityId(),n=this.context.EventManager.getCurrentSessionId();this.props.getErrorPopupData(e.error,t,n).then(e=>{this.setState({errorPopupData:e})})}render(){const e=this.state.errorPopupData;return e?r.createElement(o.a,{style:_},r.createElement(s.a,{errorPopupDescriptor:e.errorPopupDescriptor,theme:this.props.theme,isViewportSmall:this.props.isViewportSmall,okButtonLabel:e.okButtonLabel,onOkHandler:this.props.closePage})):null}}y.contextType=p.a;const v=Object(a.a)((function(e,t){const n=t.error||Object(i.i)(e),r=Object(l.a)(e);return{error:n,theme:r,isViewportSmall:Object(d.c)(e)<=r.sizes.Breakpoints.DimensionS}}),(function(e,t){return{closePage:()=>{var n;e((n=t.pageId,{type:"error.page.okay.action",execute:({dispatch:e,getState:t},r)=>Object(f.a)(t())===m.a.SingleSession&&r.Router.getHistoryManager().GetHistoryLength()<=1&&n===Object(i.c)(t())?e(Object(b.a)({replaceState:!0})):e(n?Object(g.e)(n):Object(h.b)())}))},getErrorPopupData:(t,n,r)=>e({type:"GET_ERROR_POPUP_DATA",execute:({getState:a})=>Object(c.a)(t,e,a,{activityId:n,sessionId:r})})}}))(y)},baQL:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the Query page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Query"},bfoP:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("J6kk"),a=n("W/Jk"),i=n("TEuE"),o=n("DRVD"),s=n.n(o);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c=["PerformanceInterface","PerformanceWidget","PerformanceWidgetTab","PerformanceTimelineControl","TimelinePicker","Draggable","PerformanceTimelineScrubber","PerformanceTimelineView","TinyTimelineView","TimelineEventInformation","PerformanceTooltip","TimelineExportButton"];function l(){for(;Object(i.g)();)Object(i.c)();const e=new r.AggregationTransport;return s.a.registerTransport(e),()=>{const t=new a.PerformanceTimeline(e.getEvents()),n=[];return t.getEvents().forEach(e=>{if(e.name.indexOf("[update]")>-1){const t=e.name.split(" ")[0];-1===c.indexOf(t)&&-1===n.indexOf(t)&&n.push(t)}}),s.a.removeTransport(e),n.sort()}}},bi9n:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="dataSnapshot.updateMode";function a(e,t){return{type:r,payload:t,meta:e}}},bo6D:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="contextualHelpBrowser.open";function a(){return{type:r,payload:{}}}},bpBl:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.expanded="expanded",e.collapsed="collapsed",e.floating="floating"}(r||(r={}))},bsQO:function(e,t,n){"use strict";n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return f}));var r=n("rdtZ"),a=n("SZCI"),i=n("STW0"),o=n("SSL+"),s=n("zmaG"),c=n.n(s),l=n("iDqy"),u=n.n(l);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let d=!1,p=!1;function g(){d=!0}function h(){p=!0}function f(e){u.a.subscribeToAppWorking(()=>{c.a.onNextIdleProcessing(()=>{e&&c.a.addMetadataToTimeline({telemetryActivityId:e.getActivityId()})})}),u.a.isAppIdle()||c.a.onNextIdleProcessing(()=>{e&&c.a.addMetadataToTimeline({telemetryActivityId:e.getActivityId()})}),c.a.addTimelineProcessor(e=>{p&&function(e){const t={"MscrmControls.FieldControls.SimpleLookupControl":2,"MscrmControls.FieldControls.DateTimeControl":2,"MscrmControls.FieldControls.EmailAddressControl":2,"MscrmControls.Containers.QuickForm":2,"MscrmControls.WebResource.WebResourceHtmlControl":2,"MscrmControls.TimelineWallControl.TimelineWall":-1,"MscrmControls.CardFeedContainer.CardFeedContainer":-1,"MscrmControls.Grid.ReadOnlyGrid":-1},n=e.getEvents().filter(e=>e.zone===a.d&&e.name===a.m),r={};for(const e of n){const t=e.parameters[a.l];t in r?c.a.logPerformanceIssue({type:i.PerformanceIssueType.ExcessiveRendering,level:i.PerformanceIssueLevel.Warning,message:"Control initialized more than once during form load",parameters:[t,e.parameters[a.n]]}):r[t]=1}const o=e.getEvents().filter(e=>e.zone===a.d&&e.name===a.o).reduce((e,t)=>{const n=t.parameters[a.l];return e[n]?e[n].updateCount++:e[n]={manifestControlName:t.parameters[a.n],updateCount:1},e},{});for(const e in o){const n=o[e];let r=t[n.manifestControlName]||1;const a=o[e+".fieldControl"];a&&(r=a.updateCount),-1!==r&&n.updateCount!==r&&c.a.logPerformanceIssue({type:i.PerformanceIssueType.ExcessiveRendering,level:i.PerformanceIssueLevel.Warning,message:"Excessive rendering during form load",parameters:[e,n.manifestControlName,n.updateCount.toString()]})}}(e),function(e){const t=e.getNetworkRequests(),n=e.filter(e=>e.zone===a.z&&("CrmSoapServiceCall"===e.name||e.name===a.t)).getEvents();t.forEach(e=>{const t=e.parameters[r.RESOURCE_NAME],a=n.findIndex(e=>-1!==t.indexOf(e.parameters.requestName));void 0!==a?n.splice(a,1):c.a.logPerformanceIssue({type:i.PerformanceIssueType.ExternalNetworkRequest,level:i.PerformanceIssueLevel.Warning,message:"External request detected",parameters:[t]})})}(e),d&&(!function(e){const t=e.getNetworkRequests().reduce((e,t)=>(Object(o.b)(t.parameters[r.RESOURCE_NAME])&&e.push(t.parameters[r.RESOURCE_NAME]),e),[]);t.length>0&&c.a.logPerformanceIssue({type:i.PerformanceIssueType.MetadataCallDuringWarmLoad,level:i.PerformanceIssueLevel.Warning,message:"Metadata calls during warm load",parameters:t.sort()})}(e),d=!1)})}},"bv+i":function(e,t,n){"use strict";
/** @license React v0.15.0
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Object.defineProperty(t,"__esModule",{value:!0});var r=void 0,a=void 0,i=void 0,o=void 0,s=void 0;if(t.unstable_now=void 0,t.unstable_forceFrameRate=void 0,"undefined"==typeof window||"function"!=typeof MessageChannel){var c=null,l=null,u=function(){if(null!==c)try{var e=t.unstable_now();c(!0,e),c=null}catch(e){throw setTimeout(u,0),e}};t.unstable_now=function(){return Date.now()},r=function(e){null!==c?setTimeout(r,0,e):(c=e,setTimeout(u,0))},a=function(e,t){l=setTimeout(e,t)},i=function(){clearTimeout(l)},o=function(){return!1},s=t.unstable_forceFrameRate=function(){}}else{var d=window.performance,p=window.Date,g=window.setTimeout,h=window.clearTimeout,f=window.requestAnimationFrame,m=window.cancelAnimationFrame;"undefined"!=typeof console&&("function"!=typeof f&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!=typeof m&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")),t.unstable_now="object"==typeof d&&"function"==typeof d.now?function(){return d.now()}:function(){return p.now()};var b=!1,_=null,y=-1,v=-1,S=33.33,O=-1,C=-1,E=0,I=!1;o=function(){return t.unstable_now()>=E},s=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):0<e?(S=Math.floor(1e3/e),I=!0):(S=33.33,I=!1)};var w=function(){if(null!==_){var e=t.unstable_now(),n=0<E-e;try{_(n,e)||(_=null)}catch(e){throw P.postMessage(null),e}}},j=new MessageChannel,P=j.port2;j.port1.onmessage=w;var T=function(e){if(null===_)C=O=-1,b=!1;else{b=!0,f((function(e){h(y),T(e)}));var n=function(){E=t.unstable_now()+S/2,w(),y=g(n,3*S)};if(y=g(n,3*S),-1!==O&&.1<e-O){var r=e-O;!I&&-1!==C&&r<S&&C<S&&(8.33>(S=r<C?C:r)&&(S=8.33)),C=r}O=e,E=e+S,P.postMessage(null)}};r=function(e){_=e,b||(b=!0,f((function(e){T(e)})))},a=function(e,n){v=g((function(){e(t.unstable_now())}),n)},i=function(){h(v),v=-1}}var N=null,A=null,D=null,R=3,x=!1,M=!1,F=!1;function k(e,t){var n=e.next;if(n===e)N=null;else{e===N&&(N=n);var r=e.previous;r.next=n,n.previous=r}e.next=e.previous=null,n=e.callback,r=R;var a=D;R=e.priorityLevel,D=e;try{var i=e.expirationTime<=t;switch(R){case 1:var o=n(i);break;case 2:case 3:case 4:o=n(i);break;case 5:o=n(i)}}catch(e){throw e}finally{R=r,D=a}if("function"==typeof o)if(t=e.expirationTime,e.callback=o,null===N)N=e.next=e.previous=e;else{o=null,i=N;do{if(t<=i.expirationTime){o=i;break}i=i.next}while(i!==N);null===o?o=N:o===N&&(N=e),(t=o.previous).next=o.previous=e,e.next=o,e.previous=t}}function L(e){if(null!==A&&A.startTime<=e)do{var t=A,n=t.next;if(t===n)A=null;else{A=n;var r=t.previous;r.next=n,n.previous=r}t.next=t.previous=null,z(t,t.expirationTime)}while(null!==A&&A.startTime<=e)}function B(e){F=!1,L(e),M||(null!==N?(M=!0,r(U)):null!==A&&a(B,A.startTime-e))}function U(e,n){M=!1,F&&(F=!1,i()),L(n),x=!0;try{if(e){if(null!==N)do{k(N,n),L(n=t.unstable_now())}while(null!==N&&!o())}else for(;null!==N&&N.expirationTime<=n;)k(N,n),L(n=t.unstable_now());return null!==N||(null!==A&&a(B,A.startTime-n),!1)}finally{x=!1}}function V(e){switch(e){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}function z(e,t){if(null===N)N=e.next=e.previous=e;else{var n=null,r=N;do{if(t<r.expirationTime){n=r;break}r=r.next}while(r!==N);null===n?n=N:n===N&&(N=e),(t=n.previous).next=n.previous=e,e.next=n,e.previous=t}}var W=s;t.unstable_ImmediatePriority=1,t.unstable_UserBlockingPriority=2,t.unstable_NormalPriority=3,t.unstable_IdlePriority=5,t.unstable_LowPriority=4,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=R;R=e;try{return t()}finally{R=n}},t.unstable_next=function(e){switch(R){case 1:case 2:case 3:var t=3;break;default:t=R}var n=R;R=t;try{return e()}finally{R=n}},t.unstable_scheduleCallback=function(e,n,o){var s=t.unstable_now();if("object"==typeof o&&null!==o){var c=o.delay;c="number"==typeof c&&0<c?s+c:s,o="number"==typeof o.timeout?o.timeout:V(e)}else o=V(e),c=s;if(e={callback:n,priorityLevel:e,startTime:c,expirationTime:o=c+o,next:null,previous:null},c>s){if(o=c,null===A)A=e.next=e.previous=e;else{n=null;var l=A;do{if(o<l.startTime){n=l;break}l=l.next}while(l!==A);null===n?n=A:n===A&&(A=e),(o=n.previous).next=n.previous=e,e.next=n,e.previous=o}null===N&&A===e&&(F?i():F=!0,a(B,c-s))}else z(e,o),M||x||(M=!0,r(U));return e},t.unstable_cancelCallback=function(e){var t=e.next;if(null!==t){if(e===t)e===N?N=null:e===A&&(A=null);else{e===N?N=t:e===A&&(A=t);var n=e.previous;n.next=t,t.previous=n}e.next=e.previous=null}},t.unstable_wrapCallback=function(e){var t=R;return function(){var n=R;R=t;try{return e.apply(this,arguments)}finally{R=n}}},t.unstable_getCurrentPriorityLevel=function(){return R},t.unstable_shouldYield=function(){var e=t.unstable_now();return L(e),null!==D&&null!==N&&N.startTime<=e&&N.expirationTime<D.expirationTime||o()},t.unstable_requestPaint=W,t.unstable_continueExecution=function(){M||x||(M=!0,r(U))},t.unstable_pauseExecution=function(){},t.unstable_getFirstCallbackNode=function(){return N}},bvqZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="add.toastNotificationAction";function a(e){return{type:"add.toastNotificationAction.async",execute({dispatch:t}){const n={type:r,payload:{props:e}};switch(e.level){case 1:case 2:case 3:case 4:break;default:return Promise.reject(new Error(`Notification Level ${e.level} is not supported`))}return Promise.resolve(t(n))}}}},bwbe:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return p})),n.d(t,"d",(function(){return d}));var r=n("E5IU"),a=n("SAYH"),i=n("5bWN"),o=n("84PK");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="recentItems.populateState",c="systemform",l="userform";function u(){return{type:"recentItems.retrieve.async",execute:({dispatch:e,getState:t},n)=>function(e,t,n,a,s,u,p,g){const h=Object(r.d)(a),f=h&&h.components?h.components:null,m=v(h),b=o.a.tryCreate(Object(r.i)(a));return e.getRecentItems(b,m,s,u,p,g,null).nativePromise().then(_,y);function _(e){const t=[];e.forEach(e=>{const r=d(e);Object(i.a)(r,n)&&t.push(r)});return function(e,t){const n=a(t),r=0!==Object.keys(n).length;return i();function a(e){const t={};return e&&e.length&&e.forEach(e=>{60===e.Type&&(t[e.Id.toLowerCase()]=e.Id)}),t}function i(){const t=[];return e.forEach(e=>{r&&e.EntityTypeName===c&&!n[e.ObjectId.guid.toLowerCase()]||t.push(e)}),t}}(t,f)}function y(e){return n.TraceManager.getTracer("Recents").error("Retrieving recent items from data source failed with error: "+e.get_Message()),Promise.reject(e)}function v(e){const t=[];return e&&e.appComponents&&e.appComponents.entities&&(e.appComponents.entities.forEach(e=>{t.push(e.LogicalName)}),t.push(c,l)),t}}(n.DataSource,0,n,t())}}function d(e){var t;return{LastAccessed:(t=e.LastAccessedStr,t?new Date(t+" UTC"):null),ObjectId:function(e){return e?new a.a(e):null}(e.ObjectId),EntityTypeName:e.EntityTypeName,PinStatus:e.PinStatus,RecordType:e.RecordType,IsUserView:e.IsUserView,Title:e.Title,IconPath:e.IconPath}}function p(e,t=[]){return{type:s,payload:{newRecents:e,oldRecents:t}}}},"c/eZ":function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",(function(){return a})),n.d(t,"__assign",(function(){return i})),n.d(t,"__rest",(function(){return o})),n.d(t,"__decorate",(function(){return s})),n.d(t,"__param",(function(){return c})),n.d(t,"__metadata",(function(){return l})),n.d(t,"__awaiter",(function(){return u})),n.d(t,"__generator",(function(){return d})),n.d(t,"__exportStar",(function(){return p})),n.d(t,"__values",(function(){return g})),n.d(t,"__read",(function(){return h})),n.d(t,"__spread",(function(){return f})),n.d(t,"__spreadArrays",(function(){return m})),n.d(t,"__await",(function(){return b})),n.d(t,"__asyncGenerator",(function(){return _})),n.d(t,"__asyncDelegator",(function(){return y})),n.d(t,"__asyncValues",(function(){return v})),n.d(t,"__makeTemplateObject",(function(){return S})),n.d(t,"__importStar",(function(){return O})),n.d(t,"__importDefault",(function(){return C}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function a(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function o(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}function s(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o}function c(e,t){return function(n,r){t(n,r,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function u(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,s)}c((r=r.apply(e,t||[])).next())}))}function d(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function p(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function g(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function h(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o}function f(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function m(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,s=i.length;o<s;o++,a++)r[a]=i[o];return r}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function _(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,a=n.apply(e,t||[]),i=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){a[e]&&(r[e]=function(t){return new Promise((function(n,r){i.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=a[e](t)).value instanceof b?Promise.resolve(n.value.v).then(c,l):u(i[0][2],n)}catch(e){u(i[0][3],e)}var n}function c(e){s("next",e)}function l(e){s("throw",e)}function u(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function y(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,a){t[r]=e[r]?function(t){return(n=!n)?{value:b(e[r](t)),done:"return"===r}:a?a(t):t}:a}}function v(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=g(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,a){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,a,(t=e[n](t)).done,t.value)}))}}}function S(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function O(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function C(e){return e&&e.__esModule?e:{default:e}}},c0fp:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{getMetadata(){return{boundParameter:null,operationName:"GetClientMetadataEx",operationType:1,parameterTypes:{ClientMetadataQuery:{typeName:"Microsoft.Dynamics.CRM.MetadataQuery",structuralProperty:2}}}}}},c46F:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e,t,n){this._data=null,this._entityLogicalName=null,this._errorCode=0,this._entityLogicalName=e,this._data=t,this._errorCode=n}get_entityLogicalName(){return this._entityLogicalName}get_errorCode(){return this._errorCode}get_data(){return this._data}}},c77n:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return!(!e||!e.globalProgressIndicator)&&(null!==e.globalProgressIndicator.inProgress&&void 0!==e.globalProgressIndicator.inProgress&&e.globalProgressIndicator.inProgress)}function a(e){return e&&e.globalProgressIndicator&&e.globalProgressIndicator.progressMessage?e.globalProgressIndicator.progressMessage:null}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},c7Og:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t){this._key=e,this._value=t}get_key(){return this._key}get_value(){return this._value}}},c7jw:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="businessProcessFlow.addInstanceToRecordData";function i(e,t){const n={entities:{[e.etn]:{[r.a.toString(e.id)]:t}}};return{type:a,payload:n}}},cUMa:function(e,t,n){"use strict";n.d(t,"f",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return m})),n.d(t,"g",(function(){return h})),n.d(t,"e",(function(){return f}));var r=n("ILmX"),a=n("i1f0"),i=n("odYE"),o=n("P6DH"),s=n("SAYH"),c=n("5Oca");function l(e,t){const n=Object(a.kc)(e,t);return n?n.valueString:null}function u(e,t){const n=Object(a.lc)(e,t);return n?n.valueString:null}function d(){let e=null;return function(t,n,r,a){if(null!=n)e=n;else{let n=null;if(a){const l=Object(o.fb)(t,r,a);if(l&&l.length){const e=Object(o.v)(t,r,a),i=(e&&e.queryKey&&Object(c.q)(t,e.queryKey,null,null,!0)||[]).filter(e=>l.some(t=>e.identifier&&s.a.equals(t,e.identifier.id)));n=[];for(let e=0;e<i.length;e++){const r=g(t,i[e]);n.push(r)}}e&&n&&m(e,n,i.a.equals)||(e=n)}}return e}}function p(){let e=[];return function(t,n,r,a){if(null!=n)e=n;else{let n=null;if(a){const s=Object(o.v)(t,r,a),l=s&&s.queryKey&&Object(c.q)(t,s.queryKey,null,null,!0)||[];if(l.length){n=[];for(let e=0;e<l.length;e++)if(l[e]&&l[e].identifier&&l[e].identifier.id){const r=g(t,l[e]);n.push(r)}}e&&n&&m(e,n,i.a.equals)||(e=n)}}return e}}function g(e,t){const n=t.identifier.id;let r=t.identifier.etn,o=t.identifier.name||Object(a.ec)(e,r,n);if("activitypointer"===r){r=t.fields.activitytypecode.value}else if("connection"===r&&null==o){const t=new i.a(r,n,o),a=Object(c.j)(e,t,"record2id");o=a&&a.reference&&a.reference.name||""}return new i.a(r,n,o)}function h(){let e;return function(t,n){const a=Object(r.m)(t,n.ribbonDescriptor,n.pageId,n.commandManagerId,n.selectedRecords&&n.selectedRecords.length>0);if(e&&Object.keys(e).length===Object.keys(a).length){Object.keys(e).every(t=>a[t]===e[t])||(e=a)}else e=a;return e}}function f(){let e;return function(t,n){const a=n.menuItems?n.menuItems.reduce((e,t)=>e.concat(t.Item.Items),[]):[],i=Object(r.e)(t,a,n.pageId,n.commandManagerId,n.areRecordsSelected);if(e&&Object.keys(e).length===Object.keys(i).length){Object.keys(e).every(t=>i[t]===e[t])||(e=i)}else e=i;return e}}function m(e,t,n){let r=!0;return r=e&&t?e.length===t.length&&e.every((r,a)=>n?n(e[a],t[a]):e[a]===t[a]):e===t,r}},cUbT:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("LAGg"),a=n("RrRu"),i=n("jRHm"),o=n("BFlg"),s=n("iZ7K"),c=n("jq7Z");function l(e){return{type:"grids.etn.refresh.async",execute({dispatch:t,getState:n},r){const a=r.TraceManager.getTracer(o.z),i=o.x+".refreshGridforEntityTypeNameAction";try{let c=[];const l=n();return Object(s.r)(l,e)&&(a.info("Refreshing all the grids for the entity type - "+o.a),u(l,o.a,t),c.push({name:"entityName",value:o.a}),r.EventManager.ReportComponentSuccess(i,c)),a.info("Refreshing all the grids for the entity type - "+e),u(l,e,t),c=[],c.push({name:"entityName",value:e}),r.EventManager.ReportComponentSuccess(i,c),Promise.resolve()}catch(t){let n="Refresh action for grid of entity type "+e+"failed";t&&t.message&&(n+="with the error message as : "+t.message),r.EventManager.ReportComponentFailure(i,Error(n))}}}}function u(e,t,n){for(const r in e.pages)d(e,t,n,r);for(const r in e.formInstances)d(e,t,n,r)}function d(e,t,n,s){const l=Object(c.a)(e,s);if(l.datasets)for(const e in l.datasets){const c=l.datasets[e];if(c.controls&&c.controls[o.o]&&c.controls[o.o].parameters){const l=c.controls[o.o].parameters;for(const o in l)"TargetEntityType"===l[o].Name&&l[o].Value===t&&(n(Object(r.c)(s,e)),n(Object(a.c)(s,e,[])),n(Object(i.c)(s,e,null)))}}}},cZbt:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.active="active",e.finished="finished",e.aborted="aborted"}(r||(r={}))},cfGX:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r=void 0,a=void 0,i=void 0,o=void 0},cfbi:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * The unique name of the edit form page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="EditForm",a="MainFormDialog"},cgR4:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t){this.Format=0,this.Data=null,this.Format=e,this.Data=t}}},clbQ:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return a}));var a=function(){function e(){var e=this;this._previousDimensions=new Map,this._subscribers=[],this._pendingSubscribers=[],this._pendingUpdates=[],this._schedule=function(){e.takeMeasurements(),e.flushPendingMeasuringNotifications()}}return e.getInstance=function(){return r||(r=new e),r},e.prototype.setSchedulingFunction=function(e){this._schedule=e},Object.defineProperty(e.prototype,"subscribers",{get:function(){return this._subscribers},enumerable:!1,configurable:!0}),e.prototype.addMeasuringSubscribers=function(e){this._subscribers.push(e),this.scheduleMeasuringUpdate()},e.prototype.removeMeasuringSubscribers=function(e){var t=this._subscribers.indexOf(e);t>-1&&(this._subscribers.splice(t,1),this._previousDimensions.delete(e))},e.prototype.scheduleMeasuringUpdate=function(){this._schedule()},e.prototype.flushPendingMeasuringNotifications=function(){for(var e=this._pendingUpdates.length,t=0;t<e;t++)this._pendingUpdates[t]();return this._pendingUpdates=[],this._pendingSubscribers=[],e},e.prototype.takeMeasurements=function(){if(this._subscribers)for(var e=0;e<this._subscribers.length;e++){var t=this._subscribers[e],n=t.getComponent();if(n){var r=this._previousDimensions.get(t),a=n.getBoundingClientRect(),i=a.width,o=a.height;if(!r||r.Width!==i||r.Height!==o||this._subscribers[e].forceMeasure){var s=this._pendingSubscribers.indexOf(t);s>-1&&(this._pendingSubscribers.splice(s,1),this._pendingUpdates.splice(s,1)),this._previousDimensions.set(t,{Width:i,Height:o}),this._pendingUpdates.push(t.onMeasure.bind(t,i,o)),this._pendingSubscribers.push(t)}}}},e}()},cxnf:function(e,t,n){"use strict";n.d(t,"d",(function(){return p})),n.d(t,"g",(function(){return g})),n.d(t,"c",(function(){return h})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return m})),n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return _}));var r=n("504W"),a=n("XjOj"),i=n("Div0"),o=n("pNM1"),s=n("NMtn");let c=0,l=!1,u={},d=!1;function p(){return c}function g(e){return c=e,e}function h(){return d}function f(e){return d=e,e}function m(e){return e!==l&&(e?Object(a.a)(y):Object(a.k)(y),l=e),e}function b(){u={}}function _(e){Object(s.c)(e,"componentName"),u[e]=!0}function y(e,t,n){if(function(e,t){if("undefined"==typeof console)return!1;if(Object(a.c)()<t)return!1;if(h()&&(n=i.a[e],Object(r.a)(u[n])))return!1;var n;return!0}(e,t)){let e=n().get_message();switch(e=function(e){return p()>0&&e.length>p()&&(e=e.substr(0,p())+"..."),e}(e),t){case o.a.Warning:console.warn(e);break;case o.a.Error:console.error(e);break;case o.a.Perf:case o.a.Info:case o.a.Verbose:console.info(e)}}}},cz9j:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"g",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"f",(function(){return g})),n.d(t,"a",(function(){return i})),function(e){e.DownArrow="UIKeyInputDownArrow",e.UpArrow="UIKeyInputUpArrow",e.LeftArrow="UIKeyInputLeftArrow",e.RightArrow="UIKeyInputRightArrow",e.Escape="UIKeyInputEscape"}(r||(r={}));var a=n("3rse");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i=250;function o(e){return function e(t,n=null,r=null){if(t&&(l(t)&&(function(e){const t=e.tagName?e.tagName.toLowerCase():null;return"input"===t||"textarea"===t||"true"===e.contentEditable}(t)&&!n&&(n=t),r||(r=t)),t.children))for(let a=0;a<t.children.length&&(!n||!r);a++){const i=t.children.item(a),{focusableElement:o,editableElement:s}=e(i,n,r);n||(n=s),r||(r=o)}return{focusableElement:r,editableElement:n}}(e)}function s(e){if(e){if(e.children)for(let t=e.children.length-1;t>-1;t--){const n=s(e.children.item(t));if(n)return n}if(l(e))return e}return null}function c(e){return u(e)}function l(e){return u(e,!0)}function u(e,t=!1){let n=!1;if(e){const r=e.getAttribute("tabindex"),a=t?0:-1;(["input","iframe","button","select","textarea"].indexOf(e.tagName.toLowerCase())>=0||["a","area"].indexOf(e.tagName.toLowerCase())>=0&&e.getAttribute("href")||"true"===e.contentEditable||null!=r&&!isNaN(+r)&&Number(r)>=a)&&(n=!0,function(e){return!e.hidden&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&(!e.style||"hidden"!==e.style.visibility&&"collapse"!==e.style.visibility)}(e)&&!function(e){return e.hasAttribute("disabled")}(e)||(n=!1))}return n}function d(e){const t=document.querySelector("[id='ApplicationShell']");t&&t.setAttribute("aria-hidden",e.toString());const n=document.querySelectorAll("section[id^=DialogContainer]");for(let t=0;t<n.length;t++)n.item(t).setAttribute("aria-hidden",e.toString())}function p(e){let t=e.keyCode;if(!t)switch(e.key){case r.DownArrow:t=a.a.DownArrow;break;case r.UpArrow:t=a.a.UpArrow;break;case r.LeftArrow:t=a.a.LeftArrow;break;case r.RightArrow:t=a.a.RightArrow;break;case r.Escape:t=a.a.Escape}return t}function g(e){return Math.round(100*window.devicePixelRatio)>=e}},"d+dp":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("504W"),a=n("5qiD"),i=n("/oKV");class o{constructor(e,t,n){this._timestamp=null,this._cachePriority=0,this._retrievalStrategy=0,this._cachePriority=e,this._retrievalStrategy=t,this._timestamp=Object(r.a)(n)?new Date:n}get_timestamp(){return this._timestamp}get_cachePriority(){return this._cachePriority}set_cachePriority(e){return this._cachePriority=e,e}get_retrievalStrategy(){return this._retrievalStrategy}set_retrievalStrategy(e){return this._retrievalStrategy=e,e}get_sortableTimestamp(){return o.getSortableString(this._timestamp)}getObjectData(){const e={};return e[o.timestampPath]=this.get_sortableTimestamp(),e.priority_timestamp=o.priorityTimestampKey(this._cachePriority,this._timestamp),e}update(e){Object(r.a)(e)||(this._timestamp=e._timestamp,e._cachePriority<this._cachePriority&&(this._cachePriority=e._cachePriority))}static shouldBeCached(e){return!Object(r.a)(e)&&e.get_cachePriority()!==a.a.NotCached}static getSortableString(e){return e.format("s")}static priorityTimestampKey(e,t){return e+"|"+o.getSortableString(t)}static createFromObjectData(e){const t=Date.parseInvariant(e[o.timestampPath]),n=e.priority_timestamp,r=Number.parseInvariant(n.substr(0,1));return new o(r,i.a.LocalAndRemote,t)}}o.timestampPath="timestamp",o.embeddedPriorityTimestampPath="clientretrieveoptions.priority_timestamp"},"d/SG":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="contextualHelpBrowser.toggle";function a(){return{type:r,payload:{}}}},d0w6:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r,a;function i(e){return e===a.savedview?"SystemView":"UserView"}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),function(e){e[e.MAIN_APPLICATION_VIEW=0]="MAIN_APPLICATION_VIEW",e[e.ADVANCED_SEARCH=1]="ADVANCED_SEARCH",e[e.SUB_GRID=2]="SUB_GRID",e[e.QUICKFIND_SEARCH=4]="QUICKFIND_SEARCH",e[e.REPORTING=8]="REPORTING",e[e.OFFLINE_FILTERS=16]="OFFLINE_FILTERS",e[e.MA_SEARCH=32]="MA_SEARCH",e[e.LOOKUP_VIEW=64]="LOOKUP_VIEW",e[e.SM_APPOINTMENTBOOK_VIEW=128]="SM_APPOINTMENTBOOK_VIEW",e[e.OUTLOOK_FILTERS=256]="OUTLOOK_FILTERS",e[e.ADDRESSBOOK_FILTERS=512]="ADDRESSBOOK_FILTERS",e[e.SAVEDQUERYTYPE_OTHER=2048]="SAVEDQUERYTYPE_OTHER",e[e.INTERACTIVE_WORKFLOW_VIEW=4096]="INTERACTIVE_WORKFLOW_VIEW",e[e.OFFLINE_TEMPLATE=8192]="OFFLINE_TEMPLATE",e[e.OUTLOOK_TEMPLATE=131072]="OUTLOOK_TEMPLATE",e[e.CUSTOM_DEFINED_VIEW=16384]="CUSTOM_DEFINED_VIEW"}(r||(r={})),function(e){e[e.savedview=1039]="savedview",e[e.userview=4230]="userview"}(a||(a={}))},d4He:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("F1Lu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){return{type:"external.url.open",execute:(n,a)=>new r.a(a,n).openUri(e,t),shouldReceiveFullStore:!0}}},d5N6:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"f",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"a",(function(){return l}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="InlineDialog",a=r+"_Iframe",i="Close",o="close",s="CloseCancel",c="butBegin",l="cmdDialogCancel"},d5d1:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return e&&e.platform?e.platform.features:{}}function a(e,t){return!!(e&&e.platform&&e.platform.features&&e.platform.features[t])&&e.platform.features[t].isEnabled}function i(e,t){return!!(e&&e.platform&&e.platform.features&&e.platform.features[t])&&e.platform.features[t].isAvailable}function o(e,t){return i(e,t)&&a(e,t)}function s(e){return e&&e.platform&&e.platform.features&&e.platform.features.camera&&e.platform.features.camera.imageRes}function c(e){return e&&e.platform&&e.platform.features&&e.platform.features.camera&&e.platform.features.camera.savePhoto}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"f",(function(){return c}))},d604:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("4N6w"),a=n("GYEz"),i=n("w1eR");function o(e,t,n){const o=t.TraceManager.getTracer("AuthHeader");if(!n)return o.error("Attempt to set auth header on null or undefined request"),n;const s=Object(a.a)(e.getState()),c=Object(r.a)(e.getState());if(c){s===i.a.Browser&&o.warn("Setting bearer header on request from browser");const e="Bearer "+c;if("function"==typeof n.setRequestHeader)n.setRequestHeader("Authorization",e);else{const t=n;t.additionalHeaders||(t.additionalHeaders={}),t.additionalHeaders.Authorization=e}}else s!==i.a.Browser&&o.warn("Requset being made with null/empty token in embedded scenario");return n}},d6Hx:function(e,t,n){"use strict";n.d(t,"g",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"k",(function(){return c})),n.d(t,"j",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"l",(function(){return g})),n.d(t,"c",(function(){return h})),n.d(t,"a",(function(){return f}));var r=n("nJrx");
/**
 * Constants for the editform.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a=Object(r.a)(),i=Object(r.a)(),o=Object(r.a)(),s="$most-recently-used",c=Object(r.a)(),l="searchLauncher",u="quickCreateLauncher",d="quickCreateMenuButton",p="areaBreadCrumbText",g="SiteMap",h="backButton",f="advancedFindLauncher"},d7fm:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;function a(e){switch(e){case"campaignactivity":return["partners","from"];case"fax":return["from","to"];case"email":case"letter":return["from","to","cc","bcc"];case"phonecall":return["from","to"];case"appointment":return["optionalattendees","organizer","requiredattendees"];case"campaignresponse":return["customer","partner","from"];case"recurringappointmentmaster":return["optionalattendees","organizer","requiredattendees"];case"serviceappointment":return["customers","resources"];default:return["bcc","cc","customers","optionalattendees","organizer","requiredattendees","resources","sendermailboxid","to","from"]}}function i(e,t){switch(`${e}.${t}`.toLowerCase()){case"campaignactivity.from":case"campaignresponse.from":case"fax.from":case"email.from":case"letter.from":case"phonecall.from":return r.Sender;case"email.to":case"fax.to":case"letter.to":case"phonecall.to":return r.ToRecipient;case"email.cc":return r.CCRecipient;case"email.bcc":case"letter.bcc":return r.BccRecipient;case"appointment.optionalattendees":case"recurringappointmentmaster.optionalattendees":return r.OptionalAttendee;case"appointment.organizer":case"recurringappointmentmaster.organizer":return r.Organizer;case"appointment.requiredattendees":case"recurringappointmentmaster.requiredattendees":return r.RequiredAttendee;case"campaignresponse.customer":case"serviceappointment.customer":return r.Customer;case"serviceappointment.resources":return r.Resource;case"campaignactivity.partners":case"campaignresponse.partner":return r.Partner;default:return function(e){switch(e){case"bcc":return r.BccRecipient;case"cc":return r.CCRecipient;case"customers":return r.Customer;case"partners":return r.Partner;case"optionalattendees":return r.OptionalAttendee;case"organizer":return r.Organizer;case"requiredattendees":return r.RequiredAttendee;case"resources":return r.Resource;case"sendermailboxid":case"from":return r.Sender;case"to":return r.ToRecipient;case"regarding":return r.Regarding;case"owner":return r.Owner;default:return}}(t)}}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),function(e){e[e.Sender=1]="Sender",e[e.ToRecipient=2]="ToRecipient",e[e.CCRecipient=3]="CCRecipient",e[e.BccRecipient=4]="BccRecipient",e[e.RequiredAttendee=5]="RequiredAttendee",e[e.OptionalAttendee=6]="OptionalAttendee",e[e.Organizer=7]="Organizer",e[e.Regarding=8]="Regarding",e[e.Owner=9]="Owner",e[e.Resource=10]="Resource",e[e.Customer=11]="Customer",e[e.Partner=12]="Partner"}(r||(r={}))},dFCJ:function(e,t,n){"use strict";n.d(t,"b",(function(){return C})),n.d(t,"a",(function(){return E})),n.d(t,"e",(function(){return w})),n.d(t,"d",(function(){return j})),n.d(t,"c",(function(){return P}));var r,a=n("mDek");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.Auto=0]="Auto",e[e.Inactive=1]="Inactive",e[e.Active=2]="Active",e[e.Disabled=3]="Disabled"}(r||(r={}));var i,o=n("Ae6N"),s=n("ufH1"),c=n("g73c"),l=n("84PK"),u=n("504W"),d=n("Div0"),p=n("cfGX"),g=n("RREX");!function(e){e[e.unknown=-1]="unknown",e[e.none=0]="none",e[e.systemRequired=1]="systemRequired",e[e.applicationRequired=2]="applicationRequired",e[e.recommended=3]="recommended"}(i||(i={}));var h=n("OBdv"),f=n("XjOj"),m=n("IvgJ"),b=n("jFgV"),_=n("eruq"),y=n("VJwX"),v=n("Jz2d");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function S(e){let t={};for(let n=0,r=e.childNodes.length;n<r;n++){const r=e.childNodes[n];if(r.namespaceURI===v.a.xrm2011MetadataNamespace&&"Options"===Object(y.b)(r.nodeName))for(let e=0,n=r.childNodes.length;e<n;e++)t=O(t,r,r.childNodes[e],e);else r.namespaceURI!==v.a.xrm2011MetadataNamespace||"FalseOption"!==Object(y.b)(r.nodeName)&&"TrueOption"!==Object(y.b)(r.nodeName)||(t=O(t,r,r,n))}return new b.a(t)}function O(e,t,n,r){let a=-1,i=null,o=-1,s=-1,c=null,l=null,u=null;for(let e=0,r=n.childNodes.length;e<r;e++){const r=n.childNodes[e];if(t.namespaceURI===v.a.xrm2011MetadataNamespace){switch(Object(y.b)(r.nodeName)){case"Value":a=Number.parseInvariant(r.firstChild.nodeValue);break;case"Label":i=Object(h.a)(r);break;case"State":o=Number.parseInvariant(r.firstChild.nodeValue);break;case"DefaultStatus":s=Number.parseInvariant(r.firstChild.nodeValue);break;case"TransitionData":if(r.childNodes.length>0&&null!==r.firstChild.nodeValue){c=new Array(0);const e=Object(_.b)(r.firstChild.nodeValue);let t=Object(_.a)(e).childNodes();if(t.get_count()>0){t=t.get_item(0).childNodes();let e=0;for(let n=0;n<t.get_count();n++)if(t.get_item(n).getAttribute("tostatusid")){const r=Number.parseInvariant(t.get_item(n).getAttribute("tostatusid").toString());c[e]=r,e++}}}break;case"Color":l=r.firstChild?r.firstChild.nodeValue:null;break;case"InvariantName":u=r.firstChild.nodeValue}}}return-1===a&&Object(f.d)(d.a.storage,"OptionSetMetadata with unexpected value: {0}",i),e[r.toString()]=new m.a(i,a,o,s,c,l,u),e}function C(e){const t=[];if(!Object(u.a)(e))for(let n=0;n<e.get_count();n++){const r=E(e.get_item(n).get_domParserElement());r&&t.push(r)}return t}function E(e){try{let t=null,n=null,s=null,d=null,f="unknown",m=i.unknown,b=!1,_=!1,O=!1,C=!1,E=!1,P=0,T=0,N=0,A=0,D=g.a.currency,R="",x="",M=o.a.UserLocal,F=p.c,k=p.a,L=!1,B=null,U=null,V=null,z=null,W=!0,q=!1,H=0,G=0,K=!1;for(let a=0,i=e.childNodes.length;a<i;a++){const i=e.childNodes[a];if("true"!==i.getAttribute("i:nil")&&i.firstChild&&i.namespaceURI===v.a.xrm2011MetadataNamespace){switch(Object(y.b)(i.nodeName)){case"MetadataId":t=new l.a(i.firstChild.nodeValue);break;case"LogicalName":n=i.firstChild.nodeValue;break;case"EntityLogicalName":s=i.firstChild.nodeValue;break;case"DisplayName":d=Object(h.a)(i);break;case"AttributeType":f=I(i.firstChild.nodeValue);break;case"RequiredLevel":m=w(i.childNodes[2].firstChild.nodeValue);break;case"IsSecured":b=Boolean.parse(i.firstChild.nodeValue).valueOf();break;case"IsValidForCreate":_=Boolean.parse(i.firstChild.nodeValue).valueOf();break;case"IsValidForRead":O=Boolean.parse(i.firstChild.nodeValue).valueOf();break;case"IsValidForUpdate":C=Boolean.parse(i.firstChild.nodeValue).valueOf();break;case"IsValidForGrid":E=Boolean.parse(i.firstChild.nodeValue).valueOf();break;case"MaxLength":P=parseInt(i.firstChild.nodeValue,10);break;case"MinValue":T=parseFloat(i.firstChild.nodeValue);break;case"MaxValue":N=parseFloat(i.firstChild.nodeValue);break;case"Precision":A=parseInt(i.firstChild.nodeValue,10);break;case"PrecisionSource":D=parseInt(i.firstChild.nodeValue,10);break;case"Format":R=i.firstChild.nodeValue;break;case"FormatName":if(!i.firstChild.firstChild)continue;x=i.firstChild.firstChild.nodeValue;break;case"DateTimeBehavior":if(!i.firstChild.firstChild)continue;M=j(i.firstChild.firstChild.nodeValue);break;case"DefaultFormValue":F=parseInt(i.firstChild.nodeValue,10);break;case"DefaultValue":k=Boolean.parse(i.firstChild.nodeValue).valueOf();break;case"OptionSet":B=S(i);break;case"IsBaseCurrency":L=Boolean.parse(i.firstChild.nodeValue).valueOf();break;case"ImeMode":G=Object(c.a)(r,i.firstChild.nodeValue);break;case"Targets":const e=i.childNodes,a=e.length;if(a>0){const t=[];for(let n=0;n<a;n++)t.push(e[n].firstChild.nodeValue);U=t}break;case"AttributeOf":V=i.firstChild.nodeValue;break;case"HasChanged":W=Boolean.parse(i.firstChild.nodeValue).valueOf();break;case"IsSortableEnabled":const o=i.childNodes;q=!!(o.length>=2&&"a:Value"===o[2].nodeName&&o[2].firstChild&&o[2].firstChild.nodeValue)&&Boolean.parse(o[2].firstChild.nodeValue).valueOf();break;case"InheritsFrom":z=i.firstChild.nodeValue;break;case"SourceType":H=parseInt(i.firstChild.nodeValue,10);break;case"IsLocalizable":K=Boolean.parse(i.firstChild.nodeValue).valueOf()}}}const Q=Object(u.b)(x)?R:x;return new a.a(n,t,s,f,d,b,_,O,C,E,m,P,T,N,A,D,Q,M,F,k,B,L,U,V,W,G,q,z,H,K)}catch(e){return Object(s.c)("AttributeMetadataSerializer",d.a.storage,String.format("Error extracting attribute metadata from SOAP response. Exception: {0}",e.toString())),null}}function I(e){switch(e){case"Boolean":return"boolean";case"Customer":return"customer";case"DateTime":return"datetime";case"Integer":return"integer";case"Lookup":return"lookup";case"Memo":return"memo";case"Money":return"money";case"Owner":return"owner";case"Picklist":return"picklist";case"String":return"string";case"Status":return"status";case"Uniqueidentifier":return"uniqueidentifier";case"BigInt":return"bigint";case"Virtual":return"virtual";case"State":return"state";case"Double":return"double";case"ManagedProperty":return"managedproperty";case"Decimal":return"decimal";case"PartyList":return"partylist";case"EntityName":return"entityname";default:return"unknown"}}function w(e){switch(e){case"None":return 0;case"ApplicationRequired":return i.applicationRequired;case"Recommended":return i.recommended;case"SystemRequired":return i.systemRequired;default:return i.unknown}}function j(e){switch(e){case"None":return 0;case"UserLocal":return o.a.UserLocal;case"DateOnly":return o.a.DateOnly;case"TimeZoneIndependent":return o.a.TimeZoneIndependent;default:return o.a.UserLocal}}function P(e){switch(e){case 0:return"None";case o.a.UserLocal:return"UserLocal";case o.a.DateOnly:return"DateOnly";case o.a.TimeZoneIndependent:return"TimeZoneIndependent";default:return"UserLocal"}}},dGG5:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n("MOEv");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){return`${r.a}${e}placeholder${t}`}function i(e,t,n,r){n=n||[];for(const i in n){const n=a(t,i);r.doesOnClickEventExist(e,n)&&r.getOnClickEvents(e,n).forEach(t=>r.removeOnClickEvent(e,n,t))}}},dH1a:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return-2147093997===e||-2147093999===e}n.d(t,"a",(function(){return r}))},dHD5:function(e,t,n){"use strict";n.d(t,"c",(function(){return h})),n.d(t,"h",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"i",(function(){return c})),n.d(t,"n",(function(){return d})),n.d(t,"v",(function(){return O})),n.d(t,"x",(function(){return C})),n.d(t,"p",(function(){return g})),n.d(t,"e",(function(){return v})),n.d(t,"o",(function(){return S})),n.d(t,"f",(function(){return p})),n.d(t,"k",(function(){return w})),n.d(t,"u",(function(){return j})),n.d(t,"y",(function(){return P})),n.d(t,"q",(function(){return m})),n.d(t,"l",(function(){return b})),n.d(t,"m",(function(){return _})),n.d(t,"a",(function(){return y})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"g",(function(){return f})),n.d(t,"s",(function(){return E})),n.d(t,"t",(function(){return T})),n.d(t,"r",(function(){return N})),n.d(t,"w",(function(){return A}));var r=n("jRy5"),a=n("arV0"),i=n("SAYH");function o(e){return e?{contextTokenType:r.a.MainForm,entityTypeName:e}:null}function s(e,t){return c(Object(a.g)(e,t))}function c(e){return e?e.uniqueName?e.formId?o(i.a.toString(e.formId)):o(e.entityTypeName):e.dashboardId?m(void 0,e.dashboardId):e.pageType&&"entitylist"===e.pageType?(t=e.entityTypeName)?{contextTokenType:r.a.MainGrid,entityTypeName:t}:null:o(e.entityTypeName):null;var t}function l(e,t){return t?m(void 0,t):null}function u(e,t){const{customControlId:n}=Object(a.g)(e,t);return n?v(void 0,n):null}function d(e,t){return{contextTokenType:r.a.SearchWidget,parentContextToken:e,controlName:t}}function p(e,t,n){return{contextTokenType:r.a.GridRow,parentContextToken:e,recordId:t,entityTypeName:n}}function g(e,t){return{contextTokenType:r.a.SubGrid,parentContextToken:e,controlName:t}}function h(e,t){return{contextTokenType:r.a.CustomGrid,parentContextToken:e,controlName:t}}function f(e,t,n){return{contextTokenType:r.a.LookupDialog,parentContextToken:e,entityTypeName:t+"_"+n}}function m(e,t){return{contextTokenType:r.a.UnboundForm,parentContextToken:e,formId:t}}function b(e,t,n){return{contextTokenType:r.a.QuickViewForm,parentContextToken:e,controlName:t,entityTypeName:n}}function _(e,t){return{contextTokenType:r.a.RelatedEntity,parentContextToken:e,relationshipName:t}}function y(e,t,n){return{contextTokenType:r.a.AssociatedGrid,parentContextToken:e,relationshipName:t,roleOrd:n}}function v(e,t){return{contextTokenType:r.a.FormControl,parentContextToken:e,controlName:t}}function S(e,t,n,r){return g(e,t+n+r)}function O(e){const t=function e(t,n){return t?(t.parentContextToken?e(t.parentContextToken,n):t.entityTypeName?n.push(t.entityTypeName):t.formId&&n.push(t.formId.guid),t.recordId&&!t.controlName?(n.push(t.recordId.guid),t.relationshipName&&n.push(t.relationshipName)):t.controlName?(n.push(t.controlName),t.entityTypeName&&n.push(t.entityTypeName),t.recordId&&(n.push(t.recordId.guid),t.relationshipName&&n.push(t.relationshipName))):t.relationshipName&&(n.push(t.relationshipName),t.roleOrd&&n.push(t.roleOrd)),n):n}(e,[]);return 0===t.length?"_":t.join(":")}function C(e){return O(I(e))}function E(e){return I(e)}function I(e){if(null!=e&&null!=e.relationshipName){const t=Object.assign({},e);return t.relationshipName=null,t}return e}function w(e,t){return s(e,t)}function j(e){return O(e)}function P(e){return e?e.parentContextToken?P(e.parentContextToken):e.entityTypeName?e.entityTypeName:e.formId?e.formId.guid:e.controlName?e.controlName:void 0:""}function T(e){return e.contextTokenType&&e.contextTokenType===r.a.GridRow?e.parentContextToken&&e.parentContextToken.controlName?e.parentContextToken.controlName:"entity_control":null}function N(e){return e.contextTokenType&&e.contextTokenType===r.a.GridRow?e.parentContextToken:e}function A(e){return e&&e.contextTokenType===r.a.RelatedEntity?e.parentContextToken:e}},dNvO:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.PostMessage=0]="PostMessage",e[e.SizeChange=1]="SizeChange",e[e.StateChange=2]="StateChange",e[e.LoadCompleted=3]="LoadCompleted"}(r||(r={}))},dUiZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return e&&e.metadata&&e.metadata.quickCreateMenu&&e.metadata.quickCreateMenu.initialized?e.metadata.quickCreateMenu:null}function i(e){const t=a(e);return t?t.initialized:r.a.Uninitialized}},db6h:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));const r="deviceSettings.featureAvailable.change",a={CameraAvailable:["camera","video"],MicrophoneAvailable:["microphone"],GeolocationAvailable:["geolocation"]};function i(e,t){const n={};return a[e].forEach(e=>{n[e]={featureName:e,isAvailable:t}}),{type:r,payload:n}}},ddoO:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return e&&e.garbageCollector?e.garbageCollector.metadata:null}function a(e){const t=r(e);return t?t.ribbons:null}function i(e,t){const n=r(e);return n&&n.ribbons?n.ribbons[t]:null}function o(e){const t=r(e);return t?t.entities:null}function s(e,t){const n=r(e);return n&&n.entities?n.entities[t]:null}function c(e){return e&&e.garbageCollector?e.garbageCollector.data:null}function l(e){const t=c(e);return t&&t.entities?t.entities:null}function u(e,t,n){const r=c(e);return r&&r.entities&&r.entities[t]?r.entities[t][n]:null}function d(e){const t=c(e);return t&&t.charts?t.charts:null}function p(e){const t=c(e);return t&&t.chartData?t.chartData:null}function g(e,t,n){const r=c(e);return r&&r.charts&&r.charts[t]?r.charts[t][n]:null}function h(e,t){const n=c(e);return n&&n.chartData&&n.chartData[t]?n.chartData[t]:null}function f(e){const t=c(e);return t&&t.lists?t.lists:null}function m(e,t){const n=c(e);return n&&n.lists&&n.lists[t]?n.lists[t]:null}n.d(t,"l",(function(){return a})),n.d(t,"k",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"j",(function(){return f})),n.d(t,"i",(function(){return m}))},deGN:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("E7fB"),a=n("E5IU"),i=n("IaGr");function o(e,t){try{const n=new r.a(e,t),i=Object(a.i)(e.getState()),o="Mobile"===n.client.getClient()?"/main.aspx?":`/main.aspx?appid=${encodeURIComponent(i)}&`;return n.getClientUrl()+o}catch(e){throw i.a.getInstance().eventManager.ReportComponentFailure("ClientApi.RetrieveDeviceApplicationUrl.getDeviceApplicationUrl",e),e}}},dj6u:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n("4N6w");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return Object(r.b)(e)||window.__preload&&window.__preload.aadObjectId}function i(e){return Object(r.c)(e)||window.__preload&&window.__preload.aadTenantId}},dzep:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));class r{constructor(e,t){this._parameterName=null,this._value=null,this._parameterName=e,this._value=t}getObjectData(){const e={};return e.name=this._parameterName,e.value=this._value,e}}function a(e,t,n){null!==t&&null!==n&&i(e,new r(t,n))}function i(e,t){e.push(t.getObjectData())}},e3W2:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return g}));var r=n("jRy5"),a=n("dHD5"),i=n("ApeL"),o=n("i1f0"),s=n("vlcQ"),c=n("wL2W"),l=n("pEXn"),u=n("4aOd"),d=n("tWr6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const p="control.visible";function g(e,t,n,g){return{type:"control.visible.sync",sync:!0,execute({dispatch:h,getState:f},m){var b;const _=f(),y=Object(o.C)(_,e,t,n);y&&y.parentSectionName&&g&&h(Object(s.b)(e,n,y.parentSectionName,!0)),h(function(e,t,n,o){if(n&&n.contextTokenType&&n.contextTokenType===r.a.GridRow)return Object(i.g)(e,n,t,o);const s=Object(a.v)(n);return{type:p,payload:o,meta:{pageId:e,controlName:t,contextKey:s}}}(e,t,n,g));const v=f();if(Object(c.a)()){const r=null===(b=null==m?void 0:m.TraceManager)||void 0===b?void 0:b.getTracer(`${l.k}${l.j}`),a={id:e,controlName:t},i=Object(o.G)(_,a,n),s=Object(o.G)(v,a,n),c=Object(d.a)(_,e);c.push({name:"controlName",value:t}),c.push({name:"controlLabel",value:Object(o.w)(v,a,n)}),c.push({name:"visible state before change",value:null==i?void 0:i.toString()}),c.push({name:"visible state after change",value:null==s?void 0:s.toString()}),c.push({name:"callstack",value:new u.a(new Error).getStackTrace()}),null==r||r.warn(l.n,[{name:l.v,value:l.j+".visible"},{name:l.j,value:JSON.stringify(c)}])}}}}},e9UD:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r,a=n("nuS9"),i=n("Qqgh"),o=n("CGM5"),s=n("HMYz"),c=n("iDZS"),l=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});var u=function(e){function t(t){var n=e.call(this,t)||this;n._delayTimeoutId=void 0;var r=t.displayDelay>0;return n.state={renderIndicator:!r},r&&(n._delayTimeoutId=setTimeout((function(){return n.setState({renderIndicator:!0})}),t.displayDelay)),n}return l(t,e),t.prototype.componentWillUnmount=function(){void 0!==this._delayTimeoutId&&(clearTimeout(this._delayTimeoutId),this._delayTimeoutId=void 0)},t.prototype.shouldComponentUpdate=function(e,t){return this.props.active!==e.active||this.props.progressType!==e.progressType||this.state.renderIndicator!==t.renderIndicator},t.prototype.getElementName=function(){return"div"},t.prototype.getFlexClassName=function(e){var t,n="";return e?(t=Object.assign(Object(i.a)(e)),this.props.progressType&&"bar"!==this.props.progressType?"ring"===this.props.progressType&&(n+="indeterminateProgressRing"):n+="indeterminateProgressBar",!0!==this.props.active&&!0!==this.props.animating&&(n+=" hideProgressBar"),n+=" "+Object(i.b)(t?t.display:null)):null},t.prototype.getElementChildren=function(){if("ring"===this.props.progressType&&this.state.renderIndicator)return this.isIE?a.createElement("div",null,"......"):a.createElement("div",null,a.createElement("div",{className:"progressDot"}),a.createElement("div",{className:"progressDot"}),a.createElement("div",{className:"progressDot"}),a.createElement("div",{className:"progressDot"}),a.createElement("div",{className:"progressDot"}))},t.displayName="ProgressIndicator",t}(o.a),d=s.connect(c.a)(u)},eD3A:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return p}));var r=n("WTcq"),a=n("OiiO"),i=n("GYDS"),o=n("M0zh");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s=/<[/]*br\s*[\/]?>/gi;function c(e,t,n){return e?t&&t!==e?e.replace(s,"\n")+"\n\n"+t.replace(s,"\n"):e.replace(s,"\n"):t?t.replace(s,"\n"):n||""}function l(e){return e?e.replace(s,"\n"):""}function u(e,t,n,o){const s=Object(i.c)(n)||Object(i.c)(o)?r.a.GLOBAL_CONTAINER_KEY:o;return e.ScriptManager.containerExists(s)?Promise.resolve(e.ScriptManager.getContainer(s)):s===r.a.GLOBAL_CONTAINER_KEY?t(Object(a.a)(s,!0)):t(Object(a.a)(s,!1))}function d(e){return null==e?"":-1===e.indexOf(":")?e:e.substring(e.lastIndexOf(-1!==e.indexOf(".")?".":-1!==e.indexOf("_")?"_":"!")+1)}function p(e,t,n){return null==e?"":(e&&t&&(e=(e=e.replace("{0}",t)).replace(new RegExp(o.c,"g"),t)),e&&n&&(e=e.replace(new RegExp(o.b,"g"),n)),e)}},eIlw:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("nuS9"),a=n("SEva"),i=n("bUa6"),o=n("QBtP");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s({children:e,pageId:t,pageType:n}){const s=r.useContext(o.a).EventManager;return r.createElement(a.a,{name:"Page",fallback:e=>r.createElement(i.a,{error:e,pageId:t}),onError:(e,r)=>s.ReportComponentFailure("Page.Render",e,void 0,[{name:"componentStack",value:r.componentStack},{name:"pageId",value:t},{name:"pageType",value:n}])},e)}},eL04:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="add.globalNotificationAction";function a(e){return{type:"add.globalNotificationAction.async",execute({dispatch:t,getState:n},a){const i={type:r,payload:{props:e}};return Promise.resolve(t(i))}}}},eL7I:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="notificationExpandIcon",a="headerFieldsExpandButton"},eOoD:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Phone=1]="Phone",e[e.Tablet=2]="Tablet"}(r||(r={}))},eVWz:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var r=n("GYEz"),a=n("w1eR"),i=n("H4dV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e){return!function(e){const t=Object(r.a)(e);return t===a.a.MobileApplication||t===a.a.MailApp||i.a.getInstance().get_IsAndroid()||i.a.getInstance().get_isWinPhone()||i.a.getInstance().get_IsIOS()}(e)}function s(e){return Object(r.a)(e)===a.a.Browser}},eXjw:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;function a(e){return e===r.Initialized||e===r.Refreshing}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized",e[e.Refreshing=3]="Refreshing",e[e.Error=4]="Error",e[e.Partial=5]="Partial"}(r||(r={}))},eYZY:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"j",(function(){return a})),n.d(t,"i",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"k",(function(){return p})),n.d(t,"h",(function(){return g}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="id",a="metadatatype",i="metadatasubtype",o="formfactor",s="displayname",c="associatedentitylogicalname",l="isdefault",u="data",d="dependency",p="sourceid",g="isuserrecord"},eZ32:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.NotAvailable=0]="NotAvailable",e[e.Initializing=1]="Initializing",e[e.Available=2]="Available"}(r||(r={}))},eagp:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return l}));var r=n("OmkB"),a=n("M8lA"),i=n("tOh6");const o="show.modal.component",s="dismiss.modal.component";function c(e,t){return{type:"show.modal.async",sync:!0,execute({dispatch:n,getState:r},s){Object(a.b)(r(),e)||(n(function(e){return{type:o,payload:{modalId:e}}}(e)),n(Object(i.a)(e,()=>{n(u(e)),t&&t()})))}}}function l(e){return{type:"dismiss.modal.async",sync:!0,execute({dispatch:t,getState:n},i){Object(a.b)(n(),e)&&(t(u(e)),t(Object(r.a)(e)))}}}function u(e){return{type:s,payload:{modalId:e}}}},eb03:function(e,t,n){"use strict";n.d(t,"F",(function(){return r})),n.d(t,"G",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"E",(function(){return o})),n.d(t,"D",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"h",(function(){return g})),n.d(t,"i",(function(){return h})),n.d(t,"j",(function(){return f})),n.d(t,"k",(function(){return m})),n.d(t,"l",(function(){return b})),n.d(t,"m",(function(){return _})),n.d(t,"n",(function(){return y})),n.d(t,"o",(function(){return v})),n.d(t,"p",(function(){return S})),n.d(t,"q",(function(){return O})),n.d(t,"r",(function(){return C})),n.d(t,"t",(function(){return E})),n.d(t,"u",(function(){return I})),n.d(t,"w",(function(){return w})),n.d(t,"v",(function(){return j})),n.d(t,"x",(function(){return P})),n.d(t,"y",(function(){return T})),n.d(t,"g",(function(){return N})),n.d(t,"z",(function(){return A})),n.d(t,"A",(function(){return D})),n.d(t,"B",(function(){return R})),n.d(t,"C",(function(){return x})),n.d(t,"s",(function(){return M}));var r="role",a="title",i="accessKey",o="hidden",s="disabled",c="aria-activedescendant",l="aria-atomic",u="aria-autocomplete",d="aria-controls",p="aria-checked",g="aria-describedby",h="aria-disabled",f="aria-expanded",m="aria-haspopup",b="aria-hidden",_="aria-label",y="aria-labelledby",v="aria-level",S="aria-live",O="aria-modal",C="aria-multiline",E="aria-owns",I="aria-pressed",w="aria-relevant",j="aria-readonly",P="aria-required",T="aria-selected",N="aria-current",A="aria-valuemax",D="aria-valuemin",R="aria-valuenow",x="aria-valuetext",M="aria-orientation"},eeMP:function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return f})),n.d(t,"d",(function(){return m}));var r=n("SAYH"),a=n("/GRh"),i=n("DRVD"),o=n.n(i),s=n("qAG9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c=o.a.createEvent("parseBatchResponse","Storage");function l(e){const t=Object(s.a)(e.headers,"OData-EntityId");if(t){const e=t.indexOf("(")+1,n=t.substring(e,t.length-1);return r.a.tryParse(n)}return null}async function u(e,t){const n=l(t);if(!n){const n=await t.json();return r.a.tryParse(n[e])}return n}function d(e,t){if(!t)return[];let n="--"+e+"\r\n";0===t.indexOf(n)||(n="--"+e+"\n");const r=t.split(n);if(r.splice(0,1),r.length>0){const t=r[r.length-1],n=t.indexOf("--"+e);r[r.length-1]=t.substring(0,n)}return r}function p(e,t){const n=t.indexOf(":");if(n>=0){const r=t.substring(0,n),a=t.substring(n+1).trim();e[r]=a}return e}function g(e){const t=-1!==e.indexOf("\r\n\r\n"),n=e.trim().split(t?"\r\n\r\n":"\n\n");let r=null,i=null,o=null,s=null,c=null;if(n.length>0){let e=null;n.length>1&&(e=n[1].split(t?"\r\n":"\n"));let l=null;null!=e&&(l=e.slice(1),o=/(HTTP\/\d\.\d) (\d+) (.*)/gi.exec(e[0]));const u=n[0].split(t?"\r\n":"\n");if(null!=u)for(const e of u)0===e.toLowerCase().indexOf("content-id:")&&l.push(e);r=o&&o.length>=3?Number(o[2]):0,i=new a.a(l.reduce(p,{})),n.length>1&&(c=n[2]),null!=o&&o.length>2&&(s=o[3])}return h(r,s,i,c)}function h(e,t,n,r){return{status:e,ok:e>=200&&e<=299,statusText:t,headers:n,clone(){return Object.assign({},this)},json:()=>Promise.resolve(r?JSON.parse(r):null),text:()=>Promise.resolve(r)}}function f(e,t){t&&t.AppendCallStack("Parsers.parseBatchResponse");const n=c.startStopwatch();return e.text().then(t=>{const r=[];let a;if(e.headers){const t=/boundary=(.*)/,n=Object(s.a)(e.headers,"Content-Type");a=t.test(n)?n.match(t)[1]:""}else a=t.substr(t.indexOf("batchresponse"),t.indexOf("\r\n")-2);const i=d(a,t);for(const e of i){const t=/^\s*Content-Type: .*boundary=(.*)\r?\n/gi.exec(e);if(t){const n=t[1],a=e.indexOf("--"+n),i=d(n,e.slice(a)).map(g);r.push(...i)}else{const t=g(e);r.push(t)}}if(0===r.length){const n=h(e.status,e.statusText,e.headers,t);r.push(n)}return n(),r})}function m(e){const t=Object(s.a)(e.headers,"ETag");if(!t)return null;const n=t.indexOf('"')+1;return t.substring(n,t.length-1)}},"eq+S":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.none=-1]="none",e[e.appointmentBook=0]="appointmentBook",e[e.hardcoded=1]="hardcoded",e[e.main=2]="main",e[e.miniCampaignBO=3]="miniCampaignBO",e[e.preview=4]="preview",e[e.dashboard=5]="dashboard",e[e.quick=6]="quick",e[e.mobile=7]="mobile",e[e.read=8]="read",e[e.quickCreate=9]="quickCreate",e[e.dialog=10]="dialog",e[e.card=11]="card",e[e.taskBasedForm=12]="taskBasedForm",e[e.interactionCentricDashboard=13]="interactionCentricDashboard",e[e.powerbiDashboard=14]="powerbiDashboard"}(r||(r={}))},eq9I:function(e,t,n){"use strict";n.d(t,"k",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"i",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"n",(function(){return c})),n.d(t,"l",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"m",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"f",(function(){return g})),n.d(t,"g",(function(){return h})),n.d(t,"e",(function(){return f})),n.d(t,"d",(function(){return m}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Language_{0}",a="PickList_Language_All",i="PickList_Language_Empty",o="First_Sync_Complete_Notification",s="First_Sync_Complete_Notification_Offline_By_Default",c="Request_Apply_Metadata_Notification",l="Metadata_Download_Notification",u="Download_Progress",d="Offline_Date_Update_Completed",p="D365_UCI_OfflineStatus_Offline_Data_Ready_To_Use_Syncing_Now_Text",g="D365_UCI_OfflineStatus_Offline_File_Ready_To_Use_Text",h="D365_UCI_OfflineStatus_Offline_File_Synced_With_Errors_Text",f=["Error_Message_0x8005f211","Error_Message_0x8005F249","Error_Message_0x8005F24A","Error_Message_0x8005F24B","Error_Message_0x80042F09","Error_Message_0x80042f0c","Error_Message_0x80040225","Error_Message_0x8004032c","Error_Message_0x80040226","Error_Message_0x8005f215","Error_Message_0x80154b50","Error_Message_0x8004D24B","Error_Message_0x80072560","Error_Message_0x8004A104","Error_Message_0x8004A113","Error_Message_0x8005f21d","Error_Message_Generic_Mobile_Client","Button_Label_Close","Button_Label_OK","Button_Label_Cancel","DIALOG_LABELS_LIST","Leave_This_Page","Leave_Page_Text","Dialog_AuthError_Dialog_Title","Dialog_AuthError_Dialog_Description","Dialog_Reauthenticate_Signin_Button","Dialog_Reauthenticate_Cancel_Button","Updating_Offline_Data",o,s,c,"MailtoLink_ReportToAdmin",d,"L_Offline_Updating",p,g,h],m={Error_Message_0x8005f211:"This operation failed because you're offline. Reconnect and try again.",Error_Message_0x8005F249:"Authentication failed",Error_Message_0x8005F20A:"Authentication failed - user cancelled",Error_Message_0x8005F20B:"Authentication failed - cookie setup failed",Error_Message_0x80042F09:"Access has not yet been fully configured for this user. The user needs at least one security role before you can continue.",Error_Message_0x80042f0c:"Your access has not yet been fully configured. Contact your administrator so that they can assign you a security role before proceeding.",Error_Message_0x80040225:"The system could not log you on. This could be because your user record or the business unit you belong to has been disabled",Error_Message_0x8004032c:"The system could not log you on. This could be because your user record or the business unit you belong to has been disabled in {#Brand_CRM}. For more information, contact your system administrator.",Error_Message_0x80040226:"You do not have permission to access these records. Contact your administrator for help.",Error_Message_0x8005f215:"You can't view this type of record on your device. Contact your system administrator.",Error_Message_0x80154b50:"You do not have sufficient permissions.",Error_Message_0x8004D24B:"Your user account has not been assigned a license. Contact your administrator.",Error_Message_0x80072560:"Your user account is not a member of this organization. Please contact your administrator.",Error_Message_0x8004A104:"Your user account is part of a disabled organization. Please contact your administrator",Error_Message_0x8004A113:"Sign-in is currently disabled. Only system administrators or system customizers can sign in at this time. Please contact your administrator",Error_Message_0x8005f21d:"Not in local store with key '{0}'",Error_Message_Generic_Mobile_Client:"Sorry, something went wrong. Please try again, or restart the app.",Button_Label_Close:"Close",Button_Label_OK:"OK",Button_Label_Cancel:"Cancel",Leave_This_Page:"Leave this page?",Leave_Page_Text:"You wont be able to return to this page. To stay here and continue working, select Cancel.",Dialog_AuthError_Dialog_Title:"Please sign in again",Dialog_AuthError_Dialog_Description:"To continue working, please sign in again.",Dialog_Reauthenticate_Signin_Button:"Sign In",Dialog_Reauthenticate_Cancel_Button:"Cancel",Updating_Offline_Data:"Updating offline data",First_Sync_Complete_Notification:"Offline data is ready to use. You can now work offline.",First_Sync_Complete_Notification_Offline_By_Default:"Offline data download completed. You can now work without network connectivity.",Request_Apply_Metadata_Notification:"Offline data will be ready to use after you navigate.",Metadata_Download_Notification:"Downloading offline data, this may take some time.",Download_Progress:"See download progress.",MailtoLink_ReportToAdmin:"{0} Click here {1} to share the information about this error screen with your Microsoft administrator.",Offline_Date_Update_Completed:"Offline data update completed",L_Offline_Updating:"Updating",First_Sync_Complete_File_Sync_Starting_Notification:"Your data is ready to be used offline. Syncing your files now...",File_Sync_Completed_Notification:"Offline files are ready to use. You can now work offline.",File_Sync_Completed_Notification_With_Error:"Error downloading the offline files. Check out the offline status page."}},errb:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.date="date",e.dateTime="datetime",e.duration="duration",e.email="email",e.language="language",e.none="none",e.phone="phone",e.text="text",e.textArea="textarea",e.tickerSymbol="tickersymbol",e.timeZone="timezone",e.url="url",e.regarding="regarding"}(r||(r={}))},eruq:function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return S}));var r,a=n("504W"),i=n("XjOj"),o=n("Div0"),s=n("H4dV"),c=n("NMtn"),l=n("jPIj"),u=n("kToj");class d{constructor(e){this._list=null,Object(u.a)(!Object(a.a)(e),"Node list obj should not be null"),this._list=e}get_count(){return this._list.length}get_item(e){return this._list[e]}}class p extends l.a{constructor(e,t){super(),this._element=null,this._namespaces=null,Object(u.a)(!Object(a.a)(e),"The element should not be null"),this._element=e,this._namespaces=Object(a.a)(t)?{}:t}get_innerText(){return this._element.hasChildNodes()?this._element.firstChild.nodeValue:null}get_outerXml(){return(new XMLSerializer).serializeToString(this._element)}get_tagName(){return this._element.nodeName}get_domParserElement(){return this._element}getAttribute(e){return this._element.getAttribute(e)}addNamespace(e,t){this._namespaces[e]=t}selectSingleNode(e){const t=this._SelectDOMParserElements(e,!0);return t.get_count()?t.get_item(0):null}selectNodes(e){return this._SelectDOMParserElements(e,!1)}getElementsByTagName(e){let t;t=Object(a.a)(this._element.ownerDocument)?this._element.getElementsByTagName(e):this._element.ownerDocument.getElementsByTagName(e);const n=[];for(let e=0;e<t.length;e++)n.push(t[e]);const r=this._GetElementsByTagNameWithDefaultNamespace(e);n.push(...r);const i=n.map(e=>new p(e,this._namespaces));return new d(i)}childNodes(){const e=[];for(let t=0,n=this._element.childNodes.length;t<n;t++)e.push(new p(this._element.childNodes[t],this._namespaces));return new d(e)}hasChildNodes(){return this._element.hasChildNodes()}_SelectDOMParserElements(e,t){let n=[];if(e.startsWith("//")||e.startsWith(".//")){let r=2,i=!1;e.startsWith(".")&&(r++,i=!0);let o,s,c,l,u,d=(e=e.substr(r)).indexOf("/");d<0?(o=e,s=null):(o=e.substr(0,d),s=e.substr(d+1)),d=o.indexOf("["),d<0?(c=o,l=null):(c=o.substr(0,d),l=o.substr(d+1),d=l.indexOf("]"),l=l.substr(0,d)),u=i||Object(a.a)(this._element.ownerDocument)?this._element.getElementsByTagName(c):this._element.ownerDocument.getElementsByTagName(c);const p=[];for(let e=0;e<u.length;e++)p.push(u[e]);const g=this._GetElementsByTagNameWithDefaultNamespace(c);p.push(...g);let h=p;p.length>0&&null!==l&&(h=this._FilterDOMParserElementList(p,l)),n=h.length&&null!==s?this._SearchDOMParserElementList(h,s,t):h}else e.startsWith("/")?(Object(a.a)(this._element.ownerDocument)?n.push(this._element):n.push(this._element.ownerDocument),n=this._SearchDOMParserElementList(n,e.substr(1),t)):(n.push(this._element),n=this._SearchDOMParserElementList(n,e,t));const r=n.map(e=>new p(e,this._namespaces));return new d(r)}_SearchDOMParserElementList(e,t,n){return n?this._SearchSingleNodeDOMParserElementList(e,t):this._SearchNodesDOMParserElementList(e,t)}_SearchSingleNodeDOMParserElementList(e,t){if(Object(a.a)(t)||t.length<1)return e;const n=[];for(let r=0;r<e.length;r++){const i=this._SearchSingleNodeDOMParserElement(e[r],t);if(!Object(a.a)(i)){n.push(i);break}}return n}_SearchSingleNodeDOMParserElement(e,t){if(Object(a.a)(t)||t.length<1)return e;let n,r,i,o,s=t.indexOf("/");s<0?(n=t,r=null):(n=t.substr(0,s),r=t.substr(s+1)),s=n.indexOf("["),s<0?(i=n,o=null):(i=n.substr(0,s),o=n.substr(s+1),s=o.indexOf("]"),o=o.substr(0,s));let c=null;for(let t=0,n=e.childNodes.length;t<n;t++)if(this._IsNodeNameEqual(e.childNodes[t],i)){const n=[e.childNodes[t]];let a=n;if(null!==o&&(a=this._FilterDOMParserElementList(n,o)),a.length>0){if(null===r){c=a[0];break}if(c=this._SearchSingleNodeDOMParserElement(a[0],r),c)break}}return c}_SearchNodesDOMParserElementList(e,t){if(Object(a.a)(t)||t.length<1)return e;const n=t.indexOf("/");let r,i;n<0?(r=t,i=null):(r=t.substr(0,n),i=t.substr(n+1));const o=[];let s;for(let t=0;t<e.length;t++)s=this._SearchDOMParserElement(e[t],r),s.length>0&&o.push(...s);return o.length&&null!==i?this._SearchNodesDOMParserElementList(o,i):o}_SearchDOMParserElement(e,t){let n,r,a=t.indexOf("[");a<0?(n=t,r=null):(n=t.substr(0,a),r=t.substr(a+1),a=r.indexOf("]"),r=r.substr(0,a));const i=[];for(let t=0,r=e.childNodes.length;t<r;t++)this._IsNodeNameEqual(e.childNodes[t],n)&&i.push(e.childNodes[t]);let o=i;return i.length>0&&null!==r&&(o=this._FilterDOMParserElementList(i,r)),o}_FilterDOMParserElementList(e,t){const n=t.startsWith("@");n&&(t=t.substr(1));const r=t.indexOf("=");let a,i;r<0?(a=t,i=null):(a=t.substr(0,r),i=t.substr(r+1),i=i.substr(1),i=i.substr(0,i.length-1));const o=[];for(let t=0;t<e.length;t++){const r=e[t];(n&&this._FilterDOMParserElementAttribute(r,a,i)||this._FilterDOMParserElementChildElement(r,a,i))&&o.push(r)}return o}_FilterDOMParserElementAttribute(e,t,n){return null===n?e.hasAttribute(t):n===e.getAttribute(t)}_FilterDOMParserElementChildElement(e,t,n){for(let r=0,a=e.childNodes.length;r<a;r++)if(this._IsNodeNameEqual(e.childNodes[r],t)){if(null===n)return!0;if(e.childNodes[r].firstChild.nodeValue===n)return!0}return!1}_GetElementsByTagNameWithDefaultNamespace(e){const t=[],n=this._GetNamespaceForFullName(e);if(Object(a.a)(n)||n.length<1)return t;const r=this._GetLocalNameForFullName(e);let i;i=Object(a.a)(this._element.ownerDocument)?this._element.getElementsByTagName(r):this._element.ownerDocument.getElementsByTagName(r);for(let e=0;e<i.length;e++)i[e].namespaceURI===n&&t.push(i[e]);return t}_GetNamespaceForFullName(e){const t=e.indexOf(":");if(t<0)return"";const n=e.substr(0,t);return this._namespaces[n]}_GetLocalNameForFullName(e){const t=e.indexOf(":");return t<0?e:e.substr(t+1)}_IsNodeNameEqual(e,t){if(e.nodeName===t||"*"===t)return!0;const n=this._GetNamespaceForFullName(t);if(Object(a.a)(n)||n.length<1)return!1;const r=this._GetLocalNameForFullName(t);return e.namespaceURI===n&&e.localName===r}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.ANY_TYPE=0]="ANY_TYPE",e[e.NUMBER_TYPE=1]="NUMBER_TYPE",e[e.STRING_TYPE=2]="STRING_TYPE",e[e.BOOLEAN_TYPE=3]="BOOLEAN_TYPE",e[e.UNORDERED_NODE_ITERATOR_TYPE=4]="UNORDERED_NODE_ITERATOR_TYPE",e[e.ORDERED_NODE_ITERATOR_TYPE=5]="ORDERED_NODE_ITERATOR_TYPE",e[e.UNORDERED_NODE_SNAPSHOT_TYPE=6]="UNORDERED_NODE_SNAPSHOT_TYPE",e[e.ORDERED_NODE_SNAPSHOT_TYPE=7]="ORDERED_NODE_SNAPSHOT_TYPE",e[e.ANY_UNORDERED_NODE_TYPE=8]="ANY_UNORDERED_NODE_TYPE",e[e.FIRST_ORDERED_NODE_TYPE=9]="FIRST_ORDERED_NODE_TYPE"}(r||(r={}));class g{constructor(e,t,n){if(this._list=null,Object(u.a)(!Object(a.a)(e),"XPathEvaluator should not be null"),Object(u.a)(!Object(a.a)(t),"Node list obj should not be null"),this._list=[],t instanceof XPathResult){const r=t;for(let t=0;t<r.snapshotLength;t++)this._list.push(new m(e,r.snapshotItem(t),n))}else{const r=t;for(let t=0;t<r.length;t++)this._list.push(new m(e,r[t],n))}}get_count(){return this._list.length}get_item(e){return this._list[e]}}var h,f=n("Hswk");class m extends l.a{constructor(e,t,n){super(),this._namespaces=null,this._evaluator=null,this._element=null,Object(u.a)(!Object(a.a)(e),"The XPathEvaluator should not be null"),this._evaluator=e,this._element=Object(a.a)(t)?e:t,this._namespaces=Object(a.a)(n)?{}:n}get_innerText(){return this._element.hasChildNodes()?this._element.firstChild.nodeValue:null}get_outerXml(){return(new XMLSerializer).serializeToString(this._element)}get_tagName(){return this._element.tagName}get_domParserElement(){return this._element}addNamespace(e,t){this._namespaces[e]=t}selectSingleNode(e){const t=this._evaluator.evaluate(e,this._element,Object(f.a)(this,this._ResolveNamespaces,"ResolveNamespaces"),r.FIRST_ORDERED_NODE_TYPE,null);return Object(a.a)(t.singleNodeValue)?null:new m(this._evaluator,t.singleNodeValue,this._namespaces)}selectNodes(e){return new g(this._evaluator,this._evaluator.evaluate(e,this._element,Object(f.a)(this,this._ResolveNamespaces,"ResolveNamespaces"),r.ORDERED_NODE_SNAPSHOT_TYPE,null),this._namespaces)}getAttribute(e){return this._element.getAttribute(e)}getElementsByTagName(e){return new g(this._evaluator,this._element.getElementsByTagName(e),this._namespaces)}childNodes(){return new g(this._evaluator,this._element.childNodes,this._namespaces)}hasChildNodes(){return this._element.hasChildNodes()}_ResolveNamespaces(e){return e in this._namespaces?this._namespaces[e]:null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e[void 0]=-1]="undefined",e[e.xPath=0]="xPath",e[e.domParser=1]="domParser"}(h||(h={}));let b=h.undefined;function _(){return b}function y(e){return b=e,e}function v(e){return Object(a.a)(e)?null:(_()===h.undefined&&function(e){if(function(e){const t=document.evaluate,n=document.createNSResolver&&document.createNSResolver(e),r=s.a.getInstance().get_IsBrowserIE();return!Object(a.a)(t)&&n&&!r}(e)){const t=new m(e);try{t.selectSingleNode("/root"),y(0)}catch(e){Object(i.f)(o.a.xmlNodeFactory,"XPathEvaluator doesn't work on this browser.")}}_()===h.undefined&&function(){const e=window.DOMParser;return!Object(a.a)(e)}()&&y(h.domParser);_()===h.undefined&&Object(c.d)(_(),"PreferredXmlEvaluator")}(e),_()?new p(e):new m(e))}function S(e){let t=null;if(Object(a.a)(t)&&(t=Sys.Net.XMLDOM(e)),!Object(a.a)(t)){const e=t.getElementsByTagName("parsererror");!Object(a.a)(e)&&e.length>0&&(Object(i.j)(o.a.xmlNodeFactory,"XML Parsing failure in ParseXmlDocument"),t=null)}return t}},"evW+":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r,a=n("Qqgh"),i=n("CGM5"),o=n("eb03"),s=n("HMYz"),c=n("iDZS"),l=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.getElementName=function(){return"button"},t.prototype.getElementProps=function(){var e={type:"button",ref:this.props.refCallback?this.refCallbackTrigger.bind(this):null};return e[o.a]=this.props.accessKey,this.props.disabled&&(e[o.D]=!0),e},t.prototype.getElementClassName=function(){var t=e.prototype.getElementClassName.call(this);return this.props&&this.props.className&&(t+=" "+this.props.className),t},t.prototype.getFlexClassName=function(e){return Object(a.b)(e?e.display:null)},t.prototype.getElementStyle=function(){if(this.props.style)return Object.assign({},Object(a.a)(this.props.style))},t.displayName="Button",t}(i.a),d=s.connect(c.a)(u)},"f/sd":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Initial=0]="Initial",e[e.Loading=1]="Loading",e[e.MetadataRetrieved=2]="MetadataRetrieved",e[e.OnLoadReady=3]="OnLoadReady",e[e.EditReady=4]="EditReady",e[e.FullLoad=5]="FullLoad",e[e.Error=6]="Error"}(r||(r={}))},"f07+":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"g",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return l}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t,n=!0){this.etn=e,this.payload=t,this.suppressDupeDetection=n}getMetadata(){return{boundParameter:void 0,parameterTypes:{},operationName:"Create",operationType:2}}}class a{constructor(e,t,n,r,a,i,o){this.etn=e,this.id=t,this.payload=n,this.urlParams=r,this.headers=a,this.isBinaryPayload=i,this.suppressDupeDetection=o}getMetadata(){return{boundParameter:void 0,parameterTypes:{},operationName:"Update",operationType:2}}}class i{constructor(e,t){this.entityReference=e,this.attributeName=t}getMetadata(){return{boundParameter:void 0,parameterTypes:{entityReference:{typeName:"mscrm.crmbaseentity",structuralProperty:5}},operationName:"Delete",operationType:2}}}class o{constructor(e){this.requests=e}getMetadata(){return{boundParameter:void 0,parameterTypes:{},operationName:"ExecuteMultiple",operationType:3}}}class s{constructor(e,t,n,r,a,i=!1){this.etn=e,this.id=t,this.urlParams=n,this.headers=r,this.maxPageSize=a,this.isBinary=i}getMetadata(){return{boundParameter:void 0,parameterTypes:{},operationName:"RetrieveWithUrlParams",operationType:2}}}class c{constructor(e,t,n){this.target=e,this.relationship=t,this.relatedEntities=n}getMetadata(){return{boundParameter:"target",parameterTypes:{target:{typeName:"mscrm.crmbaseentity",structuralProperty:5},relationship:{typeName:"Edm.String",structuralProperty:1},relatedEntities:{typeName:"mscrm.crmbaseentity",structuralProperty:4}},operationName:"Associate",operationType:2}}}class l{constructor(e,t){this.filter=e,this.columns=t}getMetadata(){return{boundParameter:void 0,parameterTypes:{},operationName:"EntityDefinitions",operationType:2}}}},f4Xx:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"k",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"j",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"i",(function(){return g}));var r="alert",a="button",i="checkbox",o="switch",s="link",c="option",l="radio",u="combobox",d="listbox",p="group",g="presentation"},fA3V:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the WebResource page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="WebResource"},fC8v:function(e,t,n){"use strict";n.d(t,"e",(function(){return p})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return _}));var r=n("eXjw"),a=n("SAYH"),i=n("504W"),o=n("pEXn"),s=n("Ae6N"),c=n("nTyX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e){if(!e)return null;let t;return"AttributeTypeName"in e&&e.AttributeTypeName.Value?t=e.AttributeTypeName.Value.replace(/Type/g,""):"AttributeType"in e&&e.AttributeType&&"string"==typeof e.AttributeType&&(t=e.AttributeType),t?"Float"===t?"double":t.toLowerCase():null}function u(e,t){const n=e.Attributes,r={};if(n)for(const e of n){const n=g(e,t);r[n.LogicalName]=n}return r}function d(e){if("string"!=typeof e)return"number"==typeof e?e:null;switch(e){case"Auto":return 0;case"Inactive":return 1;case"Active":return 2;case"Disabled":return 3;default:return null}}function p(e,t,n){if(Object(i.a)(e))t&&t.warn("RequiredLevel is set to Unknown with null or undefined value",n);else{let r;if(r=Object(i.a)(e.Value)?e:e.Value,"string"==typeof r)switch(e){case"None":return 0;case"SystemRequired":return 1;case"ApplicationRequired":return 2;case"Recommended":return 3;default:return t&&t.warn("RequiredLevel is set to Unknown with value "+e,n),-1}if("number"==typeof r)return r}return-1}function g(e,t){const n=e;let i=null;if(n.DateTimeBehavior)for(const e in n.DateTimeBehavior)switch(n.DateTimeBehavior[e]){case"None":i=s.a.None;break;case"DateOnly":i=s.a.DateOnly;break;case"TimeZoneIndependent":i=s.a.TimeZoneIndependent;break;case"UserLocal":i=s.a.UserLocal;break;default:i=s.a.None}const c=[{name:o.b.EntityName,value:e.EntityLogicalName},{name:o.b.AttributeName,value:e.LogicalName}];return{Initialized:r.a.Initialized,LogicalName:e.LogicalName,Id:a.a.tryParseOrNull(e.MetadataId),EntityLogicalName:n.EntityLogicalName,Type:l(e),DisplayName:m(n.DisplayName),Description:m(n.Description),IsGlobalFilterEnabled:!!n.IsGlobalFilterEnabled&&n.IsGlobalFilterEnabled.Value,IsSecured:n.IsSecured,IsSortableEnabled:!!n.IsSortableEnabled&&n.IsSortableEnabled.Value,IsEntityReferenceStored:n.IsEntityReferenceStored,IsValidForAdvancedFind:!!n.IsValidForAdvancedFind&&n.IsValidForAdvancedFind.Value,IsValidForGrid:n.IsValidForGrid,IsValidForCreate:n.IsValidForCreate,IsValidForRead:n.IsValidForRead,IsValidForUpdate:n.IsValidForUpdate,IsRetrievable:n.IsRetrievable,IsCustomAttribute:n.IsCustomAttribute,ColumnNumber:n.ColumnNumber,MaxLength:n.MaxLength,MinValue:n.MinValue,MaxValue:n.MaxValue,Precision:n.Precision,PrecisionSource:n.PrecisionSource,Format:b(n),Behavior:i,DefaultFormValue:n.DefaultFormValue,DefaultValue:"boolean"==typeof n.DefaultValue?n.DefaultValue:n.DefaultFormValue,IsBaseCurrency:n.IsBaseCurrency,Targets:n.Targets,AttributeOf:n.AttributeOf,HasChanged:n.HasChanged,ImeMode:d(n.ImeMode),OptionSetId:n.OptionSet&&n.OptionSet.MetadataId?n.OptionSet.MetadataId:null,OptionSetName:n.OptionSet&&n.OptionSet.Name?n.OptionSet.Name:null,OptionSetType:n.OptionSet?n.OptionSet.OptionSetType:null,OptionSet:h(n.OptionSet),ParentPicklistLogicalName:n.OptionSet&&n.ParentPicklistLogicalName?n.ParentPicklistLogicalName:null,ChildPicklistLogicalNames:n.OptionSet&&n.ChildPicklistLogicalNames?n.ChildPicklistLogicalNames:null,RequiredLevel:p(n.RequiredLevel,t,c),SourceType:n.SourceType,SourceTypeMask:n.SourceTypeMask,InheritsFrom:n.InheritsFrom,CanBeSecuredForCreate:n.CanBeSecuredForCreate,CanBeSecuredForRead:n.CanBeSecuredForRead,CanBeSecuredForUpdate:n.CanBeSecuredForUpdate}}function h(e){let t=null;if(e&&(t=[],e.FalseOption&&t.push(f(e.FalseOption)),e.TrueOption&&t.push(f(e.TrueOption)),e.Options)){const n=e.Options;for(const e of n)t.push(f(e))}return t}function f(e){const t=[],n=e.TransitionData;if(n){const e=(new DOMParser).parseFromString(n,"text/xml");if("parsererror"!==e.documentElement.nodeName)for(let n=0;n<e.documentElement.childNodes.length;n++){const r=e.documentElement.childNodes[n];if("allowedtransition"===r.nodeName)for(const e in r.attributes){"tostatusid"===r.attributes[e].name&&t.push(Number(r.attributes[e].value))}}}return{Color:e.Color,Label:m(e.Label),Value:e.Value,DefaultStatus:e.DefaultStatus,State:e.State,TransitionData:n?t:null,InvariantName:e.InvariantName,ParentValues:e.ParentValues}}function m(e){return e&&e.UserLocalizedLabel?e.UserLocalizedLabel.Label:null}function b(e){const t=e,n=t.FormatName?t.FormatName.Value:null;return _(Object(c.c)(t.AttributeType),n,t.Format)}function _(e,t,n){if(t)return t;let r="";if(null==n)r=n;else if(e&&"datetime"===e)switch(n){case 0:r="date";break;case 1:r="datetime";break;default:r=n.toString()}else r=n.toString();return r}},fILV:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the Grid page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="EntityList"},fU4N:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=-1]="Unknown",e[e.RelevanceSearch=0]="RelevanceSearch",e[e.CategorizedSearch=1]="CategorizedSearch",e[e.CustomSearch=2]="CustomSearch",e[e.Default=1]="Default"}(r||(r={}))},fU7K:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return null==e}function a(e){return r(e)?e:("string"!=typeof e&&(e=e.toString()),e=e.replace(/%u[a-fA-F0-9]{4}/g,e=>String.fromCharCode(parseInt(e.substr(2,e.length-2),16))),decodeURIComponent(e))}function i(e){return r(e)?e:("string"!=typeof e&&(e=e.toString()),e=(e=(e=function(e){let t,n="";if(null===e)return null;if(""===e)return"";for(let r=0;r<e.length;r++)t=e.charCodeAt(r),t>96&&t<123||t>64&&t<91||t>47&&t<58||46===t||45===t||95===t?n+=String.fromCharCode(t):n=t>127?n+"%u"+O(t):n+"%"+S(t);return n}(e)).replace(/%u[dD][89aAbB][a-fA-F0-9]{2}%u[dD][cCdDeEfF][a-fA-F0-9]{2}/g,e=>encodeURIComponent(String.fromCharCode(parseInt(e.substring(2,6),16))+String.fromCharCode(parseInt(e.substring(8),16))))).replace(/%u[a-fA-F0-9]{4}/g,e=>encodeURIComponent(String.fromCharCode(parseInt(e.substr(2,e.length-2),16)))))}function o(e){return r(e)?e:("string"!=typeof e&&(e=e.toString()),i(e))}function s(e){return r(e)?e:("string"!=typeof e&&(e=e.toString()),a(e))}function c(e){return r(e)?e:e=e.replace(/&[^;]+;/g,e=>{switch(e){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&quot;":return'"';case"&apos;":return"'";case"&nbsp;":return" "}return e.match(/&#[0-9]+;/g)?l(e.substr(2,e.length-3)):e.match(/&#x[a-fA-F0-9]+;/g)?l(parseInt(e.substr(3,e.length-4),16)):e})}function l(e){return e>65535&&e<1114112?(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e))):String.fromCharCode(e)}function u(e){return r(e)?e:("string"!=typeof e&&(e=e.toString()),m(e,y))}function d(e){return c(e)}function p(e){return r(e)?e:("string"!=typeof e&&(e=e.toString()),m(e,b))}function g(e){return r(e)?e:("string"!=typeof e&&(e=e.toString()),m(e,_))}function h(e){return r(e)?e:("string"!=typeof e&&(e=e.toString()),m(e,v))}function f(e){return r(e)?e:("string"!=typeof e&&(e=e.toString()),function(e){let t,n="";if(null==e)return null;if(""===e)return"";for(let r=0;r<e.length;r++)t=e.charCodeAt(r),t>96&&t<123||t>64&&t<91||32===t||t>47&&t<58||46===t||44===t||45===t||95===t?n+=String.fromCharCode(t):n=t>127?n+"\\u"+O(t):n+"\\x"+S(t);return"'"+n+"'"}(e))}function m(e,t){return e=(e=(e=t(e=(e=e.replace(new RegExp("([\\uD800-\\uDBFF][\\uDC00-\\uDFFF])","g"),e=>"CRMEntityReferenceOpen"+(1024*(e.charCodeAt(0)-55296)+(1023&e.charCodeAt(1))+65536).toString(16)+"CRMEntityReferenceClose")).replace(new RegExp("[\\uD800-\\uDFFF]","g"),""))).replace(/CRMEntityReferenceOpen/g,"&#x")).replace(/CRMEntityReferenceClose/g,";")}function b(e){let t,n="",r="";let a=0;if(null===e)return null;if(""===e)return"";for(let i=0;i<e.length;i++)t=e.charCodeAt(i),r+=t>96&&t<123||t>64&&t<91||32===t||t>47&&t<58||46===t||44===t||45===t||95===t?String.fromCharCode(t):"&#"+t+";",500==++a&&(n+=r,r="",a=0);return r.length&&(n+=r),n}function _(e){let t,n="";if(null===e)return null;if(""===e)return"";for(let r=0;r<e.length;r++)t=e.charCodeAt(r),t>96&&t<123||t>64&&t<91||t>47&&t<58||46===t||44===t||45===t||95===t?n+=String.fromCharCode(t):n=n+"&#"+t+";";return n}function y(e){return b(e)}function v(e){return _(e)}function S(e){if(null===e)return"";let t=e.toString(16);for(let e=t.length;e<2;e++)t="0"+t;return t}function O(e){if(null===e)return"";let t=e.toString(16);for(let e=t.length;e<4;e++)t="0"+t;return t}n.r(t),n.d(t,"CrmUrlDecode",(function(){return a})),n.d(t,"CrmUrlEncode",(function(){return i})),n.d(t,"CrmNameValueEncode",(function(){return o})),n.d(t,"CrmNameValueDecode",(function(){return s})),n.d(t,"CrmXmlDecode",(function(){return c})),n.d(t,"CrmXmlEncode",(function(){return u})),n.d(t,"CrmHtmlDecode",(function(){return d})),n.d(t,"CrmHtmlEncode",(function(){return p})),n.d(t,"CrmHtmlAttributeEncode",(function(){return g})),n.d(t,"CrmXmlAttributeEncode",(function(){return h})),n.d(t,"CrmJavaScriptEncode",(function(){return f}))},fVHw:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("nxt5");class a extends r.a{constructor(e,t){super("Create"),this._id=null,this._entityReference=null,this._id=e,this._entityReference=t}get_id(){return this._id}get_entityReference(){return this._entityReference}set_entityReference(e){return this._entityReference=e,e}}},fWyz:function(e,t,n){"use strict";n.d(t,"c",(function(){return q})),n.d(t,"d",(function(){return H})),n.d(t,"b",(function(){return K})),n.d(t,"a",(function(){return G}));var r=n("w1eR"),a=n("0uKS"),i=n("fA3V"),o=n("ruPX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t,n,r,a){const s={webresourceName:e,webresourceData:t,passParams:n};return Object(o.a)(i.a,s,a,r)}var c=n("+baL"),l=n("wRZP"),u=n("zu1I"),d=n("NjDY"),p=n("SAYH"),g=n("D+Bz"),h=n("X37l"),f=n("cfbi"),m=n("gw2m"),b=n("GYEz"),_=n("d4He"),y=n("d0w6");function v(e){const t=[];return e?(t.push({name:"Entity",value:e.Entity}),t.push({name:"DefaultDashboard",value:e.DefaultDashboard}),t.push({name:"Id",value:e.Id}),t.push({name:"Url",value:e.Url}),t):t}var S=n("d6Hx"),O=n("RiEM"),C=n("lYcl"),E=n("pgSX"),I=n("si7p"),w=n("YxC/"),j=n("EY5k"),P=n("ngeo");var T=n("Uv1Y"),N=n("KdpX"),A=n("bwbe"),D=n("zzhk"),R=n("0FMG"),x=n("GPkz"),M=n("qu3G"),F=n("Xi8U"),k=n("2FbK"),L=n("uZvv"),B=n("YcFo"),U=n("qn5m"),V=n("9eA9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const z=[A.b,A.c],W=/(http|https):\/\/(\w+:{0,1}\w*)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%!\-\/]))?/;function q(e,t,n,i,h){return i=i||g.b.Other,{type:"Navigate to sitemap SitemapAreaEntry",execute(f,y){const{dispatch:A,getState:F}=f;let B=null,V=null;const z=Object(d.t)(F()),q=z&&z.split("/"),H=q&&(q.length>1?q[q.length-2]+"/":void 0);if(z&&e.Url&&e.Url.toLowerCase().startsWith(z.toLowerCase())){const t=e.Url.substring(z.length);B=A("msdyn_appmanagementcontrol"===t?Object(l.a)(t,i):s(t,void 0,!!e.PassParams,i))}else if(e.Entity)B=A(Object(a.a)(e.Entity,void 0,void 0,void 0,void 0,void 0,void 0,i,void 0,void 0,h));else if(K(e,y.TraceManager.getTracer(S.l))){const t=e.DefaultDashboard?new p.a(e.DefaultDashboard):null,n=Object(b.a)(F())!==r.a.MailApp;B=A(Object(c.a)(null,t,i,null,N.a,n))}else if(e.Url&&/^\/([0-9a-zA-Z_-]+\/)?main.aspx/.test(e.Url))B=A(Object(o.a)(e.Url,null,void 0,i));else if(e.Url&&e.Url===O.a)B=A(Object(C.a)(""));else if(e.Url&&e.Url.startsWith("http"))if(W.test(e.Url)){let t=e.Url;e.PassParams&&(t=Object(U.a)(F(),t)),A(Object(_.a)(t)),B=Promise.resolve({status:0,pageId:null})}else V=new T.a("Sub area "+e.Id+" with Url "+e.Url+" has an unsupported Url scheme");else if(H&&e.Url){const t=e.Url.toLowerCase().indexOf(H.toLowerCase());if(t>=0){y.TraceManager.getTracer(S.l).info("Opening SubArea web resource relative path: "+e.Url,v(e));const n=e.Url.substring(t+H.length);B=A(s(n,void 0,!!e.PassParams,i))}else V=new T.a("Sub area "+e.Id+" with relative Url "+e.Url+" was expected to map to a webresource, but doesnt contain web resource path "+H)}else if(e.DynamicPage){const t={windowPosition:"inline"};B=A(Object(u.b)(e.DynamicPage,t,null))}else if(e.Page){const t={name:e.Page};B=A(Object(o.a)(m.a,t,void 0,i))}else V=z?new T.a("Sub area with ID "+e.Id+" could not be mapped to a supported navigation route"):new T.a("Webresource path was null when trying to open SubArea",-2147220970);if(V){y.TraceManager.getTracer(S.l).error(V.message,v(e));const t=e.Titles&&e.Titles.length&&e.Titles[0].Title;A(function(e,t){return{type:"sitemap.subarea.error.dialog",execute(n,r,a){let i="SubArea_InvalidSitemapConfig_Error_Title",o="SubArea_InvalidSitemapConfig_Error_Message";if(t.errorCode){const e="0x"+P.a.getHexErrorCodeFromInt(t.errorCode);i="Error_Title_"+e,o="Error_Message_"+e}const s=[i,o,"Button_Label_OK","L_Show_Details_Text"];return n.dispatch(Object(j.e)(s)).then(()=>{const r=Object(w.e)(n.getState(),s),a=Object(w.c)(r,i),c=Object(w.c)(r,o),l=Object(w.c)(r,"Button_Label_OK"),u=Object(w.c)(r,"L_Show_Details_Text"),d=c.replace("{0}",e);n.dispatch(Object(E.a)(I.d,"",{type:"error"},"",a,d,l,u,[t.message]))})}}}(t,V)),B=Promise.resolve({status:1,error:V})}return t&&n&&n(),Object(D.b)(F())&&x.a.session&&x.a.session.addEvent(M.a.navigateToSubArea,function(e,t){let n=-1;if(e){const r=Object(k.a)(e),a=Object(L.a)(e);if(r&&r.Areas&&a){const e=r.Areas[a];for(const r of e.GroupIds)for(const a of e.Groups[r].SubAreaIds)if(n++,e.Groups[r].SubAreas[a].Id===t.Id)return n}}return n}(F(),e)),B?(B.then(t=>{0===t.status&&t.pageId&&Object(D.b)(f.getState())&&i===g.b.SiteMapSubArea&&A(Object(R.e)(e.Id))}),B):Promise.resolve(void 0)}}}function H(e,t,n,r){return r=r||g.b.Other,{type:"Navigate to sitemap SitemapAreaEntry",execute(i,s){const{dispatch:l,getState:u}=i;let d=null;if(e.RecordType===h.a.Grid)d=e.IsUserView?l(Object(a.a)(e.EntityTypeName,void 0,e.ObjectId,void 0,void 0,void 0,void 0,r,y.b.userview)):l(Object(a.a)(e.EntityTypeName,void 0,e.ObjectId,void 0,void 0,void 0,void 0,r));else if(e.RecordType===h.a.Isv||z.indexOf(e.EntityTypeName)>-1){const t=e.EntityTypeName===A.b?N.a:e.EntityTypeName===A.c?N.b:null;d=l(Object(c.a)(null,e.ObjectId,r,null,t))}else if(e.RecordType===h.a.Entity)if("report"===e.EntityTypeName){const t={};t.entityName=e.EntityTypeName,t.entityId=e.ObjectId.guid?e.ObjectId.guid:void 0,Xrm.Navigation.openForm(t).then(e=>Promise.resolve(void 0),e=>Promise.resolve(void 0))}else{let t={};t={entityTypeName:e.EntityTypeName,id:e.ObjectId.guid?new p.a(e.ObjectId.guid):void 0},d=l(Object(o.a)(f.a,t,void 0,r))}else{s.TraceManager.getTracer(S.l).error("Unsupported SubArea of type "+e.RecordType,function(e){const t=[];return e&&(t.push({name:"EntityTypeName",value:e.EntityTypeName}),t.push({name:"IsUserView",value:e.IsUserView}),t.push({name:"LastAccessed",value:e.LastAccessed}),t.push({name:"IsUserView",value:e.Title}),t.push({name:"PinStatus",value:e.PinStatus}),e.ObjectId&&t.push({name:"ObjectId",value:e.ObjectId.guid}),e.RecordType&&t.push({name:"RecordType",value:e.RecordType.toString()})),t}(e))}if(t&&n&&n(),Object(D.b)(u())&&x.a.session){const t=Object(F.c)(u());t&&(t.relativeToEntryId===B.c?x.a.session.addEvent(M.a.navigateToRecentItem,G(u(),e,!1)):x.a.session.addEvent(M.a.navigateToPinnedItem,G(u(),e,!0)))}return d||Promise.resolve(void 0)}}}function G(e,t,n){let r=-1;if(e&&e.recentItems&&e.recentItems.recentItems&&t)if(n){r=e.recentItems.recentItems.filter(e=>e.PinStatus).findIndex(e=>e.ObjectId===t.ObjectId)}else r=e.recentItems.recentItems.findIndex(e=>e.ObjectId===t.ObjectId);return r}function K(e,t){return!!e.DefaultDashboard||!(!e.Url||!new V.a(e.Url).pathname.endsWith("workplace/home_dashboards.aspx"))&&(t&&!e.Url.endsWith("workplace/home_dashboards.aspx")&&t.warn("Unexpected Dashboard URL",v(e)),!0)}},fYtF:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return s}));var r=n("SAYH"),a=n("jRy5"),i=n("g22U"),o=n("Rckk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="QueryBuilder";class c{constructor(){this._telemetryMessage="",this._telemetryParameters=[],this._operations=[]}addOperation(e,t){this._telemetryMessage="to"===e||"from"===e?this._telemetryMessage?`${this._telemetryMessage}, ${t}`:t:this._telemetryMessage?`${this._telemetryMessage}, ${e}`:e,t&&this._operations.push({name:e,value:t})}addQueryInfoAndSendLog(e,t){c.tracer&&(this._addTelemetryParameter("viewId",e),this._addTelemetryParameter("entityLogicalName",t),this._addTelemetryParameter("operations",this._operations),c.tracer.info(`[${s}] ${t}-${e}: `+this._telemetryMessage,this._telemetryParameters))}_addTelemetryParameter(e,t){t&&this._telemetryParameters.push({name:e,value:t})}}function l(e,t){e&&(e.additionalHeaders[o.c.VIEW_ID_HINT]&&t.push({name:"viewId",value:e.additionalHeaders[o.c.VIEW_ID_HINT]}),e.additionalHeaders[o.c.PAGESIZE_HINT]&&t.push({name:"pageSize",value:e.additionalHeaders[o.c.PAGESIZE_HINT]}),e.additionalHeaders[o.c.PAGE_NUMBER_HINT]&&t.push({name:"pageNumber",value:e.additionalHeaders[o.c.PAGE_NUMBER_HINT]}),e.additionalHeaders[o.c.ORDERBY_HINT]&&t.push({name:"orderBy",value:e.additionalHeaders[o.c.ORDERBY_HINT]}),e.additionalHeaders[o.c.SELECT_HINT]&&t.push({name:"select",value:e.additionalHeaders[o.c.SELECT_HINT]}),e.additionalHeaders[o.c.LINK_HINT]&&t.push({name:"addLinkedEntity",value:!0}),e.additionalHeaders[o.c.SEARCH_HINT]&&t.push({name:"isQuickFindSearch",value:!0}),e.additionalHeaders[o.c.FILTER_HINT]&&t.push({name:"filter",value:!0}),e.additionalHeaders[o.c.CONTEXT_FILTER]&&t.push({name:"contextfilter",value:!0}))}function u(e){const t=[];return e&&(e.viewId&&t.push({name:"viewId",value:r.a.toString(e.viewId)}),e.entityLogicalName&&t.push({name:"entityLogicalName",value:e.entityLogicalName}),e.pageSize&&t.push({name:"pageSize",value:e.pageSize}),e.pageNumber&&t.push({name:"pageNumber",value:e.pageNumber}),t.push({name:"useModernQueryBuilder",value:e.useModernQueryBuilder||!1}),t.push({name:"isQuickFindSearch",value:e.isQuickFindSearch||!1}),e.selects&&e.selects.length>0&&t.push({name:"select",value:e.selects.toString()}),e.sorts&&e.sorts.length>0&&t.push({name:"orderBy",value:e.sorts.toString()}),e.rollupType&&t.push({name:"rollupContextFilter",value:e.rollupType.toString()}),e.wheres&&e.wheres.length>0&&t.push({name:"filter",value:e.wheres.length}),e.linkEntities&&e.linkEntities.length>0&&t.push({name:"linkentity",value:e.linkEntities.length}),e.contextFiltersAndIds&&e.contextFiltersAndIds.length>0&&t.push({name:"contextfilter",value:e.contextFiltersAndIds.length})),t}function d(e,t,n){return e&&(e.searchString?e.queryContext=i.b.Quickfind:"MscrmControls.FieldControls.SimpleLookupControl"===n?e.queryContext=i.b.Lookup:!t||t!==a.a.SubGrid&&t!==a.a.AssociatedGrid?e.queryContext="MscrmControls.Grid.ReadOnlyGrid"===n?i.b.Grid:i.b.RetrieveMultipleOther:e.queryContext=i.b.Subgrid),e}},fdXt:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("4or6"),a=n("OirV"),i=n("J17A"),o=n("F59S"),s=n("W8lr"),c=n("4WQe"),l=n("KEoC"),u=function(){function e(){}return e.initialize=function(e,t){if(void 0===t&&(t={}),!this._isInitialized)return this._isInitialized=!0,i.default.defaultTenantToken=e,this._overrideValuesFromConfig(t),this._config.disableCookiesUsage&&!this._config.propertyStorageOverride&&(i.default.sessionEnabled=!1),l.default.addPropertyStorageOverride(this._config.propertyStorageOverride),l.default.autoCollect(i.default.semanticContext,this._config.disableCookiesUsage,this._config.userAgent),s.default.initialize(this._config),i.default.loggingEnabled=!0,this._config.enableAutoUserSession&&(this.getLogger().logSession(a.AWTSessionState.Started),window.addEventListener("beforeunload",this.flushAndTeardown)),this.getLogger()},e.getSemanticContext=function(){return i.default.semanticContext},e.flush=function(e){this._isInitialized&&!this._isDestroyed&&s.default.flush(e)},e.flushAndTeardown=function(){this._isInitialized&&!this._isDestroyed&&(this._config.enableAutoUserSession&&this.getLogger().logSession(a.AWTSessionState.Ended),s.default.flushAndTeardown(),i.default.loggingEnabled=!1,this._isDestroyed=!0)},e.pauseTransmission=function(){this._isInitialized&&!this._isDestroyed&&s.default.pauseTransmission()},e.resumeTransmision=function(){this._isInitialized&&!this._isDestroyed&&s.default.resumeTransmision()},e.setTransmitProfile=function(e){this._isInitialized&&!this._isDestroyed&&s.default.setTransmitProfile(e)},e.loadTransmitProfiles=function(e){this._isInitialized&&!this._isDestroyed&&s.default.loadTransmitProfiles(e)},e.setContext=function(e,t,n){void 0===n&&(n=r.AWTPropertyType.Unspecified),i.default.logManagerContext.setProperty(e,t,n)},e.setContextWithPii=function(e,t,n,a){void 0===a&&(a=r.AWTPropertyType.Unspecified),i.default.logManagerContext.setPropertyWithPii(e,t,n,a)},e.setContextWithCustomerContent=function(e,t,n,a){void 0===a&&(a=r.AWTPropertyType.Unspecified),i.default.logManagerContext.setPropertyWithCustomerContent(e,t,n,a)},e.getLogger=function(e){var t=e;return t&&t!==i.default.defaultTenantToken||(t=""),this._loggers[t]||(this._loggers[t]=new o.default(t)),this._loggers[t]},e.addNotificationListener=function(e){c.default.addNotificationListener(e)},e.removeNotificationListener=function(e){c.default.removeNotificationListener(e)},e._overrideValuesFromConfig=function(e){e.collectorUri&&(this._config.collectorUri=e.collectorUri),e.cacheMemorySizeLimitInNumberOfEvents>0&&(this._config.cacheMemorySizeLimitInNumberOfEvents=e.cacheMemorySizeLimitInNumberOfEvents),e.httpXHROverride&&e.httpXHROverride.sendPOST&&(this._config.httpXHROverride=e.httpXHROverride),e.propertyStorageOverride&&e.propertyStorageOverride.getProperty&&e.propertyStorageOverride.setProperty&&(this._config.propertyStorageOverride=e.propertyStorageOverride),e.userAgent&&(this._config.userAgent=e.userAgent),e.disableCookiesUsage&&(this._config.disableCookiesUsage=e.disableCookiesUsage),e.canSendStatEvent&&(this._config.canSendStatEvent=e.canSendStatEvent),e.enableAutoUserSession&&"undefined"!=typeof window&&window.addEventListener&&(this._config.enableAutoUserSession=e.enableAutoUserSession),e.clockSkewRefreshDurationInMins>0&&(this._config.clockSkewRefreshDurationInMins=e.clockSkewRefreshDurationInMins)},e._loggers={},e._isInitialized=!1,e._isDestroyed=!1,e._config={collectorUri:"https://browser.pipe.aria.microsoft.com/Collector/3.0/",cacheMemorySizeLimitInNumberOfEvents:1e4,disableCookiesUsage:!1,canSendStatEvent:function(e){return!0},clockSkewRefreshDurationInMins:0},e}();t.default=u},ff1s:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s}));var r=n("17x/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return e.cache.isCacheEnabled}function i(e){return r.c(e)?3:e.cache.codeCacheState}function o(e){return!!r.c(e)||3===e.cache.codeCacheState}function s(e){return!r.c(e)&&4===e.cache.codeCacheState}},fh2P:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("arV0"),a=n("5Oca");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t,n){if(e&&t&&n){if(Object(r.m)(e,n)){const n=Object(a.b)(t)(e,t.etn);if(n&&n.ignoreBpfOnRecord)return!0}}return!1}function o(e){return!!(e&&e.data&&e.data.nextStageId)}},fskq:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="CrmSoapServiceCall",a="CrmWebAPIServiceCall",i="DataSource_OfflineSync"},ftQm:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a{constructor(){this._processManagerCollection={}}setProcessManagerByPageId(e,t){Object(r.a)(t)||Object(r.b)(e)||(this._processManagerCollection[e]=t)}getProcessManagerByPageId(e){return this._processManagerCollection&&this._processManagerCollection[e]}cleanUpProcessmanagerByPageId(e){this._processManagerCollection&&this._processManagerCollection[e]&&delete this._processManagerCollection[e]}static get Instance(){return a._instance||(a._instance=new a),a._instance}}},g0tL:function(e,t,n){"use strict";n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return C})),n.d(t,"h",(function(){return w})),n.d(t,"g",(function(){return k})),n.d(t,"e",(function(){return Q})),n.d(t,"f",(function(){return K})),n.d(t,"c",(function(){return j})),n.d(t,"d",(function(){return P}));var r=n("eXjw"),a=n("SAYH"),i=n("nJrx"),o=n("2cSh"),s=n("1pQz"),c=n("olXY"),l=n("Lr+c"),u=n("AF/G");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class d{constructor(){this._names={}}getUniqueName(e){if(null==e)return null;let t=e;for(;null!=this._names[t];){t=e+ ++this._names[e]}return this._names[t]=0,t}}var p=n("BJ7u");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var g=n("JOgp"),h=n("504W"),f=n("WZ96"),m=n("unFF"),b=n("Ae6N"),_=n("nTyX"),y=n("64CY"),v=n("NjDY"),S=n("lju1");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const O="Main";var C,E,I;function w(e,t){if(!e)return{formSelectors:null,formDefaults:null};const n={},i={};for(const t of e)if(t.hasOwnProperty("EntityLogicalName")){for(const e of t.SelectorItems){const r=Object(p.a)(e.FormType);n[t.EntityLogicalName]||(n[t.EntityLogicalName]={}),n[t.EntityLogicalName][r]||(n[t.EntityLogicalName][r]={}),n[t.EntityLogicalName][r][e.Id]={name:e.Name,description:e.Description}}if(t.SelectorItems.length){const e=t.SelectorItems[0],n=Object(p.a)(e.FormType),o=new a.a(e.Id);if(i[t.EntityLogicalName]||(i[t.EntityLogicalName]={}),!i[t.EntityLogicalName][n]){const e={formId:o,initialized:r.a.Initialized};i[t.EntityLogicalName][n]=e}}else if(0===t.SelectorItems.length&&0===t.UnfilteredIdsCount)return{formSelectors:[],formDefaults:[]}}return{formSelectors:n,formDefaults:i}}function j(e,t,n,r,a,i,o,s,c="displayname"){return P(e,t,n,r,a,i,o,s,c).label}function P(e,t,n,r,a,i,o,s,c="displayname"){var l;let u,d;if(t&&c&&i&&i[t]&&i[t][c])u=i[t][c],d=S.a.ControlLablelInFormDescriptorForUserLanguage;else if(r&&n&&o&&o[r]&&o[r][n])u=o[r][n].DisplayName,d=S.a.AttributeName;else if(a&&s&&s[a]&&s[a].DisplayCollectionName)u=s[a].DisplayCollectionName,d=S.a.TargetEntityPluralName;else if(c&&(null==i?void 0:i[t])){const n=Object(v.x)(e),r=`${c}_${null===(l=null==n?void 0:n.languageCode)||void 0===l?void 0:l.toString()}`;i[t][r]&&(u=i[t][r],d=S.a.ControlLabelInBaseLanguage)}return{label:u,labelSource:d}}function T(e){const t=[],n={};for(const r of e)if(r.relationship){const e=r.relationship,t=r.attributeName;e in n?n[e].push(t):n[e]=[t]}else t.push(r.attributeName);return{attributes:t,relatedEntityAttributes:n}}function N(e,t){return{attributeName:e,relationship:t}}function A(e){const t=[];for(const n in e.Parameters){const r=e.Parameters[n];!1===r.Static&&t.push(r.Value)}return t}function D(e,t){t.CustomControls[E.Desktop]=null,t.CustomControls[E.Tablet]=null,t.CustomControls[E.Phone]=null;for(const n in e.CustomControls)switch(n){case I.Desktop.toString():t.CustomControls[E.Desktop]=e.CustomControls[n];break;case I.Tablet.toString():t.CustomControls[E.Tablet]=e.CustomControls[n];break;case I.Phone.toString():t.CustomControls[E.Phone]=e.CustomControls[n]}return t}function R(e){return Array.isArray(e)?e:e&&e.Controls?e.Controls:null}function x(e){return e?(e.forEach(e=>{!e||e.hasOwnProperty("Enabled")&&!Object(h.a)(e.Enabled)||(e.Enabled=!0)}),e):[]}function M(e=null){switch(e){case"expandAvailableSpace":case"singleComponent":return"singleComponent";default:return"cardSections"}}function F(e){if(e){const t=e.PreviewId;if(t)return`${f.a}${t}`}}function k(e,t,n,s,u,g,f){if(!e)return null;const m={},b={},_={},v={};let S;for(const O of e){const e=new a.a(O.Id);let E;S=O.EntityLogicalName||s;const I=[],w=[],j={},P=new d,k={},K=new d,Q=[],Y={},J={},Z={},ee={},te={},ne={},re={},ae=O.FormType,ie=!!(f&&f[S]&&f[S].IsBPFEntity);if(O.Charts){const e=O.Charts;for(const t in e){const n=Object(c.a)(e[t]);v[t]=n}}if(O.TabAttributes&&(E={DashboardCategory:O.TabAttributes.dashboardCategory,PrimaryEntity:O.TabAttributes.primaryentitylogicalname,FilterBy:O.TabAttributes.filterby,TimeFrame:O.TabAttributes.timeframe}),O.Tabs){let e=0;const r="tab";for(const o of O.Tabs){const s=[];for(const c of o.Columns){const o=[];for(const s of c.Sections){const c=P.getUniqueName(s.Name||s.Id),l=[];for(const i of s.Rows){const o=[];let s=0;const u=[];for(const l of i.Cells){const d=l.Control;if(d){const p=H(d,S);let g=0;for(const h of p){const m=L(l),_=q(h,O.Id,ae,l.RowSpan,n);if(1===p.length?_.LabelId=a.a.toString(new a.a(_.LabelId||l.Id)):_.LabelId=null,U(_,h,t,Q,b,Y,re,ae,ie),_.Name=K.getUniqueName(_.Name),!_.Label){const e="TargetEntityType";_.Parameters&&_.Parameters[e],_.Relationship&&f&&f[S]&&f[S].ManyToOneRelationships&&f[S].ManyToOneRelationships[_.Relationship]&&f[S].ManyToOneRelationships[_.Relationship].ReferencedEntity}if(_.ParentSectionName=c,_.ParentTabId=r+e,_.ParentCellId=m.Id,_.IsRequired=d.IsRequired,k[_.Name]=_,m.ControlName=_.Name,0===g){1===p.length&&(_.ShowLabel=l.ShowLabel);let e=!1;for(const t of o)t&&t.ControlName&&t.ControlName.indexOf(y.a)>-1&&m.ControlName&&m.ControlName.indexOf(y.a)>-1&&(e=!0);if(e){const e=[];for(let t=0;t<s;t++)e.push(L(l));e.push(m);for(let t=s+1;t<i.Cells.length;t++)e.push(L(l));const t={Visible:i.Visible,Height:i.Height,Cells:e};u.push(t),g=u.length}else o.push(m)}else if(m.Id=a.a.toString(a.a.newGuid()),u.length>=g)u[g-1].Cells.push(m);else{const e=[];for(let t=0;t<s;t++)e.push(L(l));e.push(m);for(let t=s+1;t<i.Cells.length;t++)e.push(L(l));const t={Visible:i.Visible,Height:i.Height,Cells:e};u.push(t)}g++}}else{const e=L(l);o.push(e)}s++}const d={Visible:i.Visible,Height:i.Height,Cells:o};l.push(d);for(const e of u)l.push(e)}const u=new a.a(s.Id),d=new a.a(s.LabelId||s.Id);o.push(c);const p={Id:u,Label:s.Label,Name:c,Columns:s.Columns,ShowLabel:s.ShowLabel,Visible:s.Visible,Rows:l,CellLabel:s.CellLabel,DomId:Object(i.a)(),PreviewId:F(s),SemanticZoomDomId:Object(i.a)(),AvailableForPhone:s.AvailableForPhone,Height:s.Height,LabelId:a.a.toString(d)};p.Label,j[c]=p}const l={Width:c.Width,SectionNames:o};s.push(l)}const c=o?B(o.TabFooter,t,Q,b,Y,re,u,g,f,k,K,O.Id,S,ae):null,l=o?B(o.TabHeader,t,Q,b,Y,re,u,g,f,k,K,O.Id,S,ae):null,d=o.Name||o.Id,p=o.LabelId||o.Id;I.push(d);const m={Id:r+e++,Label:o.Label,Name:d,ShowLabel:o.ShowLabel,Visible:o.Visible,EventHandlers:x(o.EventHandlers),Expanded:!!Object(h.a)(o.Expanded)||o.Expanded,Columns:s,LabelId:a.a.toString(new a.a(p)),DomId:Object(i.a)(),PreviewId:F(o),Header:l,Footer:c,AvailableForPhone:o.AvailableForPhone,RawTabId:Object(h.a)(o.Id)?o.Id:o.Id.toLowerCase(),ContentType:M(o.ContentType)};m.Label,w.push(m)}}const oe=[],se=R(O.Header);if(se)for(const e of se){const n=H(e,S);for(const e of n){const n=q(e,O.Id,null,null,null);U(n,e,t,Q,b,Y,re,ae,ie),n.Name=K.getUniqueName(n.Name),n.Label||(n.LabelId=n.LabelId?a.a.toString(new a.a(n.LabelId)):null),k[n.Name]=n,oe.push(n)}}const ce={DomId:Object(i.a)(),PreviewId:F(O.Header),AvailableForPhone:O.Header?O.Header.AvailableForPhone:null,Controls:oe,CommandBarVisible:O.Header?O.Header.ShowCommandBar:null,BodyVisible:O.Header?O.Header.ShowBody:null,TabNavigatorVisible:O.Header?O.Header.ShowTabNavigator:null},le=[],ue=R(O.Footer);if(ue)for(const e of ue){const n=H(e,S);for(const e of n){const n=q(e,O.Id,null,null,null);U(n,e,t,Q,b,Y,re,ae,ie),n.Name=K.getUniqueName(n.Name),n.Label||(n.LabelId=n.LabelId?a.a.toString(new a.a(n.LabelId)):null),k[n.Name]=n,le.push(n)}}const de={DomId:Object(i.a)(),PreviewId:F(O.Footer),AvailableForPhone:O.Footer?O.Footer.AvailableForPhone:null,Controls:le,Visible:O.Footer?O.Footer.Visible:null},pe=[];if(10!==ae&&O.HiddenFields)for(const e of O.HiddenFields){(t===C.Form||12===ae)&&G(e)&&e.DataFieldName&&(e.relationship?Q.push(N(e.Id,e.relationship)):Q.push(N(e.DataFieldName,e.relationship)));const n=q(e,O.Id,null,null,null);n.Name=K.getUniqueName(n.Name),U(n,e,t,Q,b,Y,re,ae,ie),k[n.Name]=n,V(n,re),pe.push(n)}const ge=W(O.FormParameters);if(ge)for(const e of ge){Q.push(N(e.Name)),Y[e.Name]=X(e);const t=$(e);t.Name=K.getUniqueName(t.Name),k[t.Name]=t}const he=[];if(O.InlineEditGridRow)for(const e of O.InlineEditGridRow){const n=q(e,O.Id,null,null,null);U(n,e,t,Q,b,Y,re,ae,ie),n.Name=K.getUniqueName(n.Name),k[n.Name]=n,he.push(n)}const{attributes:fe,relatedEntityAttributes:me}=T(Q);Object.keys(Y).length>0&&(_[O.Id]=Y);let be=!1;const _e=Object(p.a)(O.FormType);O.FormType&&_e&&"dashboard"===_e.toLowerCase()&&(be=!0);const ye=[];if(O.CustomControlConfigurations)for(const e of O.CustomControlConfigurations){const t=Object(l.a)(e);let n=null;be&&(n=JSON.parse(JSON.stringify(t)),D(t,n));const r=null==n?t:n;for(const e in r.CustomControls)if(r.CustomControls[e]){const t=A(r.CustomControls[e]);for(const e of t)-1===fe.indexOf(e)&&-1===ye.indexOf(e)&&ye.push(e)}J[t.UniqueId]=r}const ve=new a.a("e7a81278-8635-4d9e-8d4d-59480b391c5b"),Se=new a.a("f9a8a302-114e-466a-b582-6771b2ae0d92"),Oe="ViewId",Ce=[];for(const e in k){const t=k[e];(a.a.equals(t.ClassId,ve)||a.a.equals(t.ClassId,Se)&&t.UniqueId&&!t.DataFieldName)&&t.Parameters&&t.Parameters[Oe]&&(t.HasContext=!0,Ce.push(new a.a(t.Parameters[Oe])))}if(O.Navigation){if(O.Navigation.NavBarAreas.NavBarAreas&&O.Navigation.NavBarAreas.NavBarAreas)for(const e of O.Navigation.NavBarAreas.NavBarAreas){const t={id:e.Id,titles:z(e.Titles)};Z[e.Id]=t}if(O.Navigation.NavPaneIsvItems.NavBarIsvItems)for(const e of O.Navigation.NavPaneIsvItems.NavBarIsvItems){const t={id:e.Id,titles:z(e.Titles),icon:e.Icon,url:e.Url,passParams:e.PassParams,sequence:e.Sequence,area:e.Area,client:e.Client,availableOffline:e.AvailableOffline};ee[e.Id]=t}if(O.Navigation.NavBarByRelationshipItems)for(const e of O.Navigation.NavBarByRelationshipItems){const t=[];if(e.Privileges)for(const n of e.Privileges)t.push({entity:n.Entity,privilege:n.Privilege});const n={titles:e.Titles,tooltipTitles:e.TooltipTitles,privileges:t,relationshipName:e.RelationshipName,id:e.Id,area:e.Area,titleResourceId:e.TitleResourceId,client:e.Client,availableOffline:e.AvailableOffline,icon:e.Icon,sequence:e.Sequence,show:e.Show,viewId:e.ViewId};te[e.Id]=n}if(O.Navigation.NavBarItems)for(const e of O.Navigation.NavBarItems){const t={titles:e.Titles,icon:e.Icon,url:e.Url,id:e.Id,passparams:e.PassParams,sequence:e.Sequence,area:e.Area,client:e.Client,availableOffline:e.AvailableOffline};ne[e.Id]=t}}const Ee={navBarAreas:Z,navPaneIsvItems:ee,navBarByRelationshipItems:te,navBarItems:ne},Ie=[];Ie.push(...O.FormLibraries),Ie.push(...O.ClientResources);const we={initialized:r.a.Initialized,SubGrids:O.SubGrids,TabAttributes:E,TabNames:I,Tabs:w,ControlConfigurations:J,Sections:j,Controls:k,Id:e,Label:O.Label,Name:O.Name,EntityLogicalName:S,ShowLabel:O.ShowLabel,Visible:O.Visible,FormType:O.FormType,EventHandlers:x(O.EventHandlers),FormLibraries:Ie,Header:Array.isArray(O.Header)?oe:ce,Footer:Array.isArray(O.Footer)?le:de,HiddenFields:pe,InlineEditGridRow:he,InlineQuickForms:re,LinkControlSections:O.LinkControlSections,Attributes:fe,ControlConfigAttributes:ye,RelatedEntityAttributes:me,BusinessLogic:O.BusinessLogic,Charts:O.Charts,SubgridViewIds:Ce,Navigation:Ee,FormParameters:ge,ShowNavigationBar:O.ShowNavigationBar,ShowEntityImage:O.ShowEntityImage,HeaderDensity:o.a[O.HeaderDensity],VersionNumber:O.VersionNumber,OverallVersionNumber:O.OverallVersionNumber};m[a.a.toString(e)]=we}return{forms:m,attributes:_,entities:{},charts:v}}function L(e){return{Id:e.Id,ColSpan:e.ColSpan,RowSpan:e.RowSpan,AutoExpand:e.AutoExpand,IsInFirstColumnOfSection:e.IsInFirstColumnOfSection,IsInLastColumnOfSection:e.IsInLastColumnOfSection,ShowLabel:e.ShowLabel,Visible:e.Visible,Locklevel:e.Locklevel,AvailableForPhone:e.AvailableForPhone,UserSpacer:e.UserSpacer,IsPreviewCell:e.IsPreviewCell,IsStreamCell:e.IsStreamCell,IsChartCell:e.IsChartCell,IsTileCell:e.IsTileCell,DomId:Object(i.a)(),PreviewId:F(e)}}function B(e,t,n,r,i,o,s,c,l,u,d,p,g,h){const f=[];if(!e)return null;for(const s of e){const e=H(s,g);for(const s of e){s.LabelId=s.LabelId?a.a.toString(new a.a(s.LabelId)):s.Id;const e=q(s,p,null);U(e,s,t,n,r,i,o,h,!1),u[e.Name]=e,f.push(e)}}return f}function U(e,t,n,r,i,o,s,c,l){if(a.a.equals(e.ClassId,u.rb)){t.DataFieldName=function(e){return e.Parameters&&e.Parameters.FailureTimeField?e.Parameters.FailureTimeField:""}(t);const e=function(e){const t=[];return e&&null!=e.Parameters&&(e.Parameters.CancelConditionName&&t.push({attributeName:e.Parameters.CancelConditionName}),e.Parameters.FailureConditionName&&t.push({attributeName:e.Parameters.FailureConditionName}),e.Parameters.FailureTimeField&&t.push({attributeName:e.Parameters.FailureTimeField}),e.Parameters.PauseConditionName&&t.push({attributeName:e.Parameters.PauseConditionName}),e.Parameters.SuccessConditionName&&t.push({attributeName:e.Parameters.SuccessConditionName}),e.Parameters.WarningConditionName&&t.push({attributeName:e.Parameters.WarningConditionName})),t}(t);e&&r.push(...e)}if(a.a.equals(e.ClassId,u.h)){const e=Object(g.b)(t);e&&r.push(...e)}if(l&&!t.IsUnbound&&G(t)&&t.DataFieldName&&(e.DataFieldName=t.DataFieldName),10===c&&function(e){const t=[u.C];for(let n=0;n<t.length;n++)if(a.a.equals(e,t[n]))return!1;return!0}(e.ClassId)||(n===C.Form||12===c)&&t.IsUnbound&&!t.DataFieldName?(a.a.equals(e.ClassId,u.Q)&&10===c&&(t.Type=24),a.a.equals(e.ClassId,u.J)||r.push(N(e.Name,e.Relationship)),e.DataFieldName=e.Name,o[e.Name]=function(e){const t=Y(e.Id,Object(_.c)(e.Type),e.RequiredLevel);return function(e,t){if(!e||!t)return;e.ClassId&&a.a.equals(u.fb,new a.a(e.ClassId))&&(t.Type="lookup",t.Format="regarding");e.IsRequired&&(t.RequiredLevel=1);const n=e.ClassId&&a.a.equals(u.q,new a.a(e.ClassId)),r="Date";if(!e.Parameters||!e.Parameters.length)return void(n&&(t.Format=r,t.Behavior=b.a.DateOnly));for(const n of e.Parameters){const e=n.Name,r=n.Value,i=n.TargetEntities;if("OptionSetId"===e)t.OptionSetId=a.a.toString(a.a.fromExternalGuid(r));else if(i&&Array.isArray(i))for(const e of i)t.Targets.push(e.EntityLogicalName);else if(-1!==["LogicalName","Id","Type","EntityLogicalName","DisplayName","IsSecured","IsValidForCreate","IsValidForRead","IsValidForUpdate","RequiredLevel","PrecisionSource","Format","Behavior","DefaultFormValue","IsBaseCurrency","Targets","OptionSetName","AttributeOf","HasChanged","ImeMode"].indexOf(e))t[e]=r;else if(-1!==["MaxLength","MinValue","MaxValue","Precision","DefaultValue"].indexOf(e)){const n=parseInt(r,10);t[e]=isNaN(n)?r:n}}n&&(t.Format||(t.Format=r),t.Behavior=t.Format===r?b.a.DateOnly:b.a.UserLocal)}(e,t),t}(t)):(n===C.Form||12===c||11===c||l&&2===c)&&!t.IsUnbound&&G(t)&&t.DataFieldName&&(r.push(N(t.DataFieldName,t.relationship)),e.DataFieldName=t.DataFieldName,V(e,s)),function(e){const t=new a.a("7ccd1494-1f7a-4e3a-8bde-f32069daeb9f"),n=new a.a("e616a57f-20e0-4534-8662-a101b5ddf4e0");return a.a.equals(e.ClassId,t)||a.a.equals(e.ClassId,n)}(e)){const t="SearchForAutoSuggestionsUsing",n="EnableAutoSuggestions",a="AutoSuggestionSource";"true"===e.Parameters[n]&&"0"===e.Parameters[a]&&e.Parameters[t]&&r.push(N(e.Parameters[t]))}}function V(e,t){if(e.Parameters&&e.Parameters.QuickForms){if(!e.DataFieldName)return;const n={},r=e.Parameters.QuickForms.match(/(?!entityname=")[A-Za-z0-9_]+(?=".*<\/QuickFormId>)/g),i=e.Parameters.QuickForms.match(/[A-Za-z0-9]+-[A-Za-z0-9]+-[A-Za-z0-9]+-[A-Za-z0-9]+-[A-Za-z0-9]+(?=<\/QuickFormId>)/g);for(let e=0;e<r.length;e++)n[r[e]]=a.a.tryParseOrNull(i[e]);t[e.Id]=n}}function z(e){const t=[];for(const n of e)t.push({LCID:n.LCID,text:n.Text});return t}function W(e){const t=[];if(e)for(const n of e){const e={Name:n.Name,Type:n.Value};t.push(e)}return t}function q(e,t,n,r,o){let s=e.Parameters;if(e.Parameters)for(const t of e.Parameters)s[t.Name]=t.Value;return o&&(s=function(e,t,n,r,a){if(5===r&&a&&n&&n.ChartGridMode&&"Chart"!==n.ChartGridMode){const r="true"===n.EnableViewPicker,o="true"===n.EnableQuickFind,s=t.ShowLabel,c="true"===n.EnableJumpBar,l=26,u=26,d=22,p=40,g=Object(m.a)(e),h=(i=g.sizes.Section.cellHeightInRem,parseFloat(window.getComputedStyle(document.documentElement).fontSize)*parseFloat(i));let f=0,b=0;r||o||s||c?(f=r||s?f+l:f+0,f=o?f+u:f+0,f=c?f+d:f+0):f=2,b=f>a?a-Math.ceil((f+26+20)/30):a-f;let _=0;o||_++,n.RecordsPerPage===b.toString()&&(n.RecordsPerPage=parseInt(b*(h/p)+_,10).toString())}var i;return n}(o,e,s,n,r)),{Id:e.Id,Label:e.Label,Name:e.Id,ShowLabel:e.ShowLabel,Visible:e.Visible,ClassId:new a.a(e.ClassId),Disabled:e.Disabled,Parameters:s,ControlLayout:e.ControlLayout,UniqueId:e.UniqueId,LabelId:e.LabelId,Relationship:e.relationship,DomId:Object(i.b)(t),PreviewId:F(e),IsUnbound:e.IsUnbound}}function H(e,t){const n=e.DataFieldName;if(n){if(Object(y.e)(t)){const t=Object(y.d)(n),r=[];if(t){for(const n in t){const a=t[n];a&&r.push({ClassId:e.ClassId,ControlLayout:e.ControlLayout,Disabled:e.Disabled,IsRequired:e.IsRequired,Id:e.Id+y.a+a,Label:null,Name:a,Parameters:e.Parameters,relationship:e.relationship,RequiredLevel:e.RequiredLevel,ShowLabel:e.ShowLabel,Type:e.Type,Visible:e.Visible,DataFieldName:a})}return Object(y.f)(n)&&r.push(e),r}}}return[e]}function G(e){return e.hasOwnProperty("DataFieldName")}function K(e,t){const n=[],r={};if(null!=e&&null!=t){for(const r in e)for(const e in t)r===e&&n.push(r);for(const a in n){const i=n[a],o=e[i],c=t[i];if(o===c)continue;const l=Object(s.a)(o,c);r[l.EntityLogicalName]=l}}if(null!=e)for(const t in e)-1===n.indexOf(t)&&(r[t]=e[t]);if(null!=t)for(const e in t)-1===n.indexOf(e)&&(r[e]=t[e]);return r}function Q(e,t){const n=Object.assign({},e);for(const e in t)n.hasOwnProperty(e)?Object.assign(n[e],t[e]):n[e]=t[e];return n}function X(e){const t=function(e){switch(e){case"SafeString":return"string";case"UniqueId":return"uniqueidentifier";case"Boolean":return"boolean";case"DateTime":return"datetime";case"Double":return"double";case"EntityType":case"PositiveInteger":case"UnsignedInt":case"Integer":return"integer";case"Long":return"bigint";default:return"unknown"}}(e.Type);switch(e.Type){case"EntityType":case"UnsignedInt":case"PositiveInteger":return Y(e.Name,t,0,0,!0);case"Double":return Y(e.Name,t,0,null,!0,10);default:return Y(e.Name,t,0,null,!0)}}function Y(e,t,n,a,i,o){return{Initialized:r.a.Initialized,LogicalName:e,Id:null,Type:t,EntityLogicalName:null,DisplayName:null,IsSecured:!1,IsValidForCreate:!0,IsValidForRead:!0,IsValidForUpdate:!0,RequiredLevel:n,MinValue:null!=a?a:null,Precision:null!=o?o:0,PrecisionSource:0,Format:J(t),Behavior:null,DefaultValue:null,IsBaseCurrency:!1,Targets:[],AttributeOf:null,HasChanged:!1,ImeMode:null,OptionSetName:null,OptionSetType:null,OptionSet:[],OptionSetId:null,IsFormParameter:!(!i||!0!==i)&&i}}function J(e){switch(e){case"datetime":return"datetime";default:return null}}function $(e){return{Id:e.Name,Label:null,Name:e.Name,ShowLabel:!1,Visible:!1,ClassId:a.a.EMPTY,Disabled:!1,Parameters:{formParameter:!0},ControlLayout:0,UniqueId:null,LabelId:null}}!function(e){e[e.Other=0]="Other",e[e.Form=1]="Form",e[e.Dialog=2]="Dialog",e[e.Dashboard=3]="Dashboard",e[e.Entity=4]="Entity",e[e.View=5]="View"}(C||(C={})),function(e){e[e.Unknown=0]="Unknown",e[e.Desktop=1]="Desktop",e[e.Tablet=2]="Tablet",e[e.Phone=3]="Phone"}(E||(E={})),function(e){e[e.Phone=0]="Phone",e[e.Tablet=1]="Tablet",e[e.Desktop=2]="Desktop"}(I||(I={}))},g22U:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r={UPDATE:"Update",CREATE:"Create",DELETE:"Delete",RETRIEVE:"Retrieve",RETRIEVE_MULTIPLE:"RetrieveMultiple",Execution_Multiple:"ExecutionMultiple",ACTION:"Action",FUNCTION:"Function",GCM:"GetClientMetadata",SCM:"SyncClientMetadata",ENTITY_DEFINITION:"EntityDefinition",EXTERNAL_SEARCH:"ExternalSearch"},a={Update:"Update",Associate:"Associate",BinaryUpload:"BinaryUpload",Create:"Create",Delete:"Delete",Disassociate:"Disassociate",BinaryDelete:"BinaryDelete",Retrieve:"Retrieve",BinaryDownload:"BinaryDownload",RetrieveMultipleOther:"RetrieveMultipleOther",Grid:"Grid",Subgrid:"Subgrid",Lookup:"Lookup",Quickfind:"Quickfind",ClientAPI:"ClientAPI",GetClientMetadata:"GetClientMetadata",SyncClientMetadata:"SyncClientMetadata",ExecutionMultiple:"ExecutionMultiple",SetProcessRequest:"SetProcess",SetProcessInstanceRequest:"SetProcessInstance",ExecuteWorkflowRequest:"ExecuteWorkflow",RetrieveServerTime:"RetrieveServerTime",ExecuteQuickFindRequest:"ExecuteQuickFind",InvokeProcessActionInternal:"InvokeProcessActionInternal",RetrieveProcessInstances:"RetrieveProcessInstances",RetrieveFilteredProcesses:"RetrieveFilteredProcesses",RollupRequest:"Rollup",RetrieveLookupData:"RetrieveLookupData",InitializeFromRequest:"InitializeFrom",RetrieveProcessControlDataRequest:"RetrieveProcessControlData",WhoAmI:"WhoAmI",EntityDefinition:"EntityDefinition",ExternalSearch:"ExternalSearch"},i="Unknown",o={TYPE:"Operation-Type",SUB_TYPE:"Operation-SubType"};function s(e){var t,n;return{type:(null===(t=e.additionalParameters)||void 0===t?void 0:t[o.TYPE])||i,subType:(null===(n=e.additionalParameters)||void 0===n?void 0:n[o.SUB_TYPE])||i}}},g2Nw:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("09gH"),a=n("CpcI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i=r.o.concat(a.g)},g440:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return h}));var r=n("Uv1Y"),a=n("eXjw"),i=n("K7RF"),o=n("sw/s"),s=n("Fn5S"),c=n("g0tL"),l=n("ueZM"),u=n("/oKV"),d=n("iJGp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const p="taskBasedFlow.retrieve",g="TaskBasedFlow.retrieveTaskBasedFlow";function h(e){return{type:"taskBasedFlow.retrieve.async",execute({dispatch:t,getState:n},h){let f=u.a.LocalAndRemote;h.DataSource;const m=n(),b=h.TraceManager.getTracer("TaskBasedFlow"),_=Object(s.a)(m);if(!(_&&_.taskBasedFlowUniqueNames&&_.taskBasedFlowUniqueNames.indexOf(e)>=0)){const t=`Task ${e} was deactivated, deleted or its role privileges were changed.`;return b.warn(t),h.EventManager.ReportComponentFailure(p,Error(t)),Promise.resolve(null)}const y=Object(o.b)(m,e);if(y===a.a.Initialized&&Object(i.e)(m,Object(o.a)(m,e).overallVersionNumber)&&(f=u.a.Remote),y===a.a.Uninitialized||f!==u.a.LocalAndRemote)return b.info("Task flow with name:"+e+" is not in state. Fetching from server..."),t(function(e){const t=e?{[e]:{initialized:a.a.Initializing}}:null;return{type:p,payload:{taskBasedFlows:t}}}(e)),t(function(e,t,n){return{type:"taskBasedFlow.retrieve.async",execute:({dispatch:e,getState:a},o)=>e(Object(i.b)("taskbasedflow",null,null,null,!0,d.a.OnDemandWithoutContext,null,null,[t],c.b.Form,n)).catch(r.b)}}(0,e,f)).then(n=>{t(function(e){return{type:p,payload:e}}(n)),b.info("Task flow server fetch for name:"+e+" completed.");const a=n&&n.taskBasedFlows&&n.taskBasedFlows[e];return a?(h.EventManager.ReportComponentSuccess(g),t(Object(l.a)(a.formId)).then(()=>a,r.b)):(h.EventManager.ReportComponentFailure(g,Error("No taskbasedflow found in metadata response for uniquename:"+e)),null)});const v=Object(o.a)(m,e);return v?h.EventManager.ReportComponentSuccess(g):h.EventManager.ReportComponentFailure(g,Error("Task based flow not found in state. getTaskBasedFlow returned null for:"+e)),Promise.resolve(v)}}}},g73c:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){return a(e,t)}function a(e,t){const n=t.charCodeAt(0);if(n<=57&&n>=0){const e=parseInt(t,10);if(isFinite(e)&&e>=0)return e}try{const n=e[t];return null!=n?n:null}catch(e){const n=parseInt(t,10);if(isFinite(n)&&n>=0)return n;throw e}}function i(e,t){const n=e;return n[t]&&n[t].toString()||null}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}))},gNtT:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="deviceSettingInformation",a="userAccessibilitySetting"},gPGs:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){var e=this;this._hidden="hidden",this._visibilityChange="visibilitychange",this._firstGoneIntoBackgroundTimeSinceLastIdle=-1;void 0!==document.webkitHidden&&(this._hidden="webkitHidden",this._visibilityChange="webkitvisibilitychange"),document.addEventListener(this._visibilityChange,(function(){-1===e._firstGoneIntoBackgroundTimeSinceLastIdle&&document[e._hidden]&&(e._firstGoneIntoBackgroundTimeSinceLastIdle=performance.now())}))}return e.prototype.resetTracking=function(){this._firstGoneIntoBackgroundTimeSinceLastIdle=-1},e.prototype.firstGoneIntoBackgroundTimeSinceLastIdle=function(){return this._firstGoneIntoBackgroundTimeSinceLastIdle},e}();t.default=r},gQ5I:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return b})),n.d(t,"e",(function(){return y})),n.d(t,"d",(function(){return v})),n.d(t,"f",(function(){return O})),n.d(t,"b",(function(){return _}));var r=n("aOhN"),a=n("pCLb"),i=n("oqdd"),o=n("arV0"),s=n("xPbo"),c=n("QHx/"),l=n("/iCT"),u=n("xHmU"),d=n("tFCh"),p=n("+nTZ"),g=n("zsAz"),h=n("1OTd"),f=n("pF61");const m="router.close",b="router.remove_closed_page",_="router.garbage_collect_page";function y(e,t="close",n=!0){return{type:"router.close.async",execute({dispatch:a,getState:l},u){if(Object(f.n)(l(),e))return Promise.reject(Object(g.d)("Trying to close the page which was already closed",2415919107,[{name:"PageId",value:e}]));const d=Object(c.a)(l(),e);return u.Router.preCloseCheck(e,t).then(s=>{if(s.resultType===i.a.Fail)return Promise.resolve(s.resultValue);if(s.resultType===i.a.Success){if(!Object(o.f)(l(),e)){return u.Router.closePage(e,t).then(()=>{if(n)return u.CustomNavigationHandler.handleClosePage(d)?Promise.resolve({status:0,pageId:void 0}):a(Object(r.b)(d))})}return u.Router.shouldDialogClose(e).then(n=>{if(n){return u.Router.closePage(e,t).then(t=>{S(a,l(),e,d.targetBrowsingContext,t.output)})}const r=[{name:"PageId",value:e}];return Promise.reject(Object(g.d)("Couldn't close page ",2415919107,r))})}},e=>(d.targetBrowsingContext&&a(Object(s.e)(e,d.targetBrowsingContext)),Promise.reject(e)))}}}function v(e){return{type:"router.close_all_dialogs",execute({dispatch:t,getState:n},r){let a=Object(u.a)(n(),e);let o=Promise.resolve(!0);return a=[].concat(a).reverse(),a.forEach(a=>{o=o.then(()=>r.Router.preCloseCheck(a,"close").then(o=>o.resultType===i.a.Fail?Promise.reject(o.resultValue):o.resultType===i.a.Success?r.Router.shouldDialogClose(a).then(i=>{if(i){return r.Router.closePage(a,"close").then(r=>(S(t,n(),a,e,r.output),!0))}return Promise.reject(Object(g.d)(h.l,2415919106))}):void 0,n=>(t(Object(s.e)(n,e)),Promise.reject(n))))}),o}}}function S(e,t,n,r,i){const o=Object(p.b)(t,n);if(!o){const e=[{name:"PageId",value:n},{name:"BrowsingContextId",value:r}];throw Object(g.d)("dialogContext does not exist for pageId",2415919107,e)}e(function(e,t,n){return{type:m,payload:{__output:e,pageId:t,browsingContextId:n},meta:{pageId:t}}}(i,n,r)),e(Object(d.c)(o.dialogContextId,n,r)),Object(l.a)(n),e({type:b,payload:{},meta:{pageId:n}}),e(Object(a.a)(n))}function O(e,t="garbage collection"){return{type:"router.close.async",execute:({dispatch:n},r)=>r.Router.closePage(e,t).then(()=>{Object(l.a)(e),n(Object(a.a)(e)),n(function(e){return{type:_,payload:{},meta:{pageId:e}}}(e)),r.Router.cleanUp(e)})}}},"gg/8":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(){const e=window.SERVER_VERSION_VALUE||"8.0.0000.0000";return String.format("{0}.{1}.{2}.{3}",e.substr(0,1),e.substr(1,1),e.substr(2,4),e.substr(6))}n.d(t,"a",(function(){return r}))},ghNp:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"h",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return g}));var r=n("dHD5"),a=n("lza4");function i(e,t,n){return{type:"clientapi.add.to.contextdictionary",sync:!0,execute(i,o){const s=o.ClientApiManager.getClientApiEntry(t),c=Object(r.v)(n);if(s.xrmObjectCache[c]){const e=[{name:"ContextKey",value:c}],t="Verify that the context token used to add the item to the cache is correct.",n="XrmObjectCache already contains an item with ContextKey";throw o.EventManager.ReportComponentFailure("ClientApi.XrmObjectCache.addXrmObjectToCache",new Error(n),t,e),new Error(`${n} ${c}`)}s.xrmObjectCache[c]=e,i.dispatch(Object(a.b)(t,c,!0))}}}function o(e,t){return{type:"clientapi.remove.from.contextdictionary",sync:!0,execute(n,a){const i=a.ClientApiManager.getClientApiEntry(e),o=Object(r.v)(t);delete i.xrmObjectCache[o]}}}function s(e,t){return d(e,t)}function c(e,t){return d(e,t)}function l(e,t){return d(e,t)}function u(e,t){return d(e,t)}function d(e,t){return{type:"clientapi.get.from.contextdictionary",sync:!0,execute:(n,r)=>p(e,t,r.ClientApiManager)}}function p(e,t,n){if(n){const a=Object(r.v)(t);return n.getClientApiEntry(e).xrmObjectCache[a]}return null}function g(e,t,n){return n?n.getClientApiEntry(e).xrmObjectCache[t]:null}},glAs:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return e&&e.appShellState?e.appShellState.hideAppNameInTopBar:null}n.d(t,"a",(function(){return r}))},gn9A:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("4or6");t.AWTPropertyType=r.AWTPropertyType,t.AWTPiiKind=r.AWTPiiKind,t.AWTEventPriority=r.AWTEventPriority,t.AWTEventsDroppedReason=r.AWTEventsDroppedReason,t.AWTEventsRejectedReason=r.AWTEventsRejectedReason,t.AWTCustomerContentKind=r.AWTCustomerContentKind;var a=n("OirV");t.AWTUserIdType=a.AWTUserIdType,t.AWTSessionState=a.AWTSessionState;var i=n("mcT5");t.AWT_BEST_EFFORT=i.AWT_BEST_EFFORT,t.AWT_NEAR_REAL_TIME=i.AWT_NEAR_REAL_TIME,t.AWT_REAL_TIME=i.AWT_REAL_TIME;var o=n("WfN+");t.AWTEventProperties=o.default;var s=n("F59S");t.AWTLogger=s.default;var c=n("fdXt");t.AWTLogManager=c.default;var l=n("xWUA");t.AWTTransmissionManager=l.default;var u=n("2aJl");t.AWTSerializer=u.default;var d=n("EDmP");t.AWTSemanticContext=d.default,t.AWT_COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_USGOV_DOD="https://pf.pipe.aria.microsoft.com/Collector/3.0",t.AWT_COLLECTOR_URL_USGOV_DOJ="https://tb.pipe.aria.microsoft.com/Collector/3.0"},go4y:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.SkypeChannelFeatureName="SkypeForBusiness",e.SkypeChannelIframeSuffix="SkypeChannelIFrame",e.ConversationManagerContainerId="ConversationManagerContainer",e.WebResourcePath="msdyn_/Scripts/SkypeChannelLoader.js"}(r||(r={}))},gvL4:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r,a=n("Qqgh"),i=n("CGM5"),o=n("eb03"),s=n("M6Hl"),c=n("HMYz"),l=n("iDZS"),u=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(e){function t(t){var n=e.call(this,t)||this;return n.refCallbackTrigger=n.refCallbackTrigger.bind(n),n}return u(t,e),t.prototype.getElementName=function(){return"ul"},t.prototype.getFlexClassName=function(e){return Object(a.b)(e?e.display:null)},t.prototype.getElementProps=function(){var e={ref:this.props.refCallback?this.refCallbackTrigger:null};return!0===this.props.announceAccessibilityNotification&&(e[o.p]=this.props.notificationType||s.a),e},t.prototype.getElementStyle=function(){if(this.props.style)return Object.assign({},Object(a.a)(this.props.style))},t.displayName="List",t}(i.a),p=c.connect(l.a)(d)},gvQo:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("84PK");class a{constructor(e,t,n){this._depth=0,this._privilegeId=null,this._businessUnitId=null,this._depth=n,this._privilegeId=e,this._businessUnitId=t}get_depth(){return this._depth}get_privilegeId(){return this._privilegeId}get_businessUnitId(){return this._businessUnitId}getObjectData(){return{depth:this._depth,privilegeid:this._privilegeId.getObjectData(),businessunitid:this._businessUnitId.getObjectData()}}static createFromObjectData(e){const t=r.a.createFromObjectData(e.privilegeid),n=r.a.createFromObjectData(e.businessunitid);return new a(t,n,e.depth)}}},gw2m:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="custom"},gxvI:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var r=n("nuS9"),a=n("evW+"),i=n("H/hG"),o=n("YWpA"),s=n("RiHV"),c=n("znb3"),l=n("XIN1"),u=n("hoir"),d=n("d6Hx"),p=n("QBtP"),g=n("uZvv"),h=n("u+q+"),f=n("3cEW"),m=n("unFF"),b=n("YxC/"),_=n("eD3A"),y=n("EY5k"),v=n("ws6F"),S=n("Knfm"),O=n("GEbX"),C=n("4leG"),E=n("0FMG"),I=n("GYEz"),w=n("w1eR"),j=n("SocB"),P=n("LzVy"),T=n("sclX"),N=n("3rse"),A=n("tJ+6"),D=n("q43A");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class R extends r.Component{constructor(e,t){super(e),this._hoverBackgroundColr="",this._onClickHandler=this._onClickHandler.bind(this),this._onKeyDownHandler=this._onKeyDownHandler.bind(this),t.hiddenAction&&(this._hiddenActionTriggerCallback=Object(u.a)(t.hiddenAction)),this.props.isHeaderButton?this.props.setSitemapExpandedState(0):this.props.loadPanelStateFromLocalStorage(this.props.needCollapsedByDefault?0:1),v.w.some(t=>!Object(b.c)(e.resourceStrings,t))&&e.retrieveResourceStrings(v.w);const n=this.props.designLanguage,r=n?n.Components.Navigation.Rest.Hover.BackgroundColor:this.props.theme.colors.BaseColor.White;this._hoverBackgroundColr=this.props.isMailApp?Object(j.g)(j.d.Blue.Blue6,j.b).Fill:this.props.hoverBackgroundColor||r}_onClickHandler(){this.props.toggleSiteMap(),this._hiddenActionTriggerCallback&&this._hiddenActionTriggerCallback()}_getIconStyle(){return{fontFamily:"Dyn CRM Symbol",fontSize:"16px"}}_getButtonStyle(){return Object.assign({display:"block",cursor:"pointer",backgroundColor:"transparent",height:42,width:44,borderStyle:"none",flexShrink:0,color:this.props.iconColor,":hover":{"> div":{backgroundColor:this._hoverBackgroundColr,boxShadow:"0px 4px 8px rgba(0,0,0,0.1)",borderRadius:"2px"}},":focus":this.props.isHeaderButton?Object(D.d)(this.props.theme,this.props.designLanguage):void 0,padding:6},this.props.overwriteStyle)}_getButtonContainerStyle(){return{width:"100%",height:"100%",justifyContent:"center",alignItems:"center",margin:"auto"}}_getPanelStatusString(){return Object(b.c)(this.props.resourceStrings,1===this.props.panelState?v.c:v.d)}_getTitle(){if(this.props.navigationType===O.a.MultiSession){const e=Object(b.c)(this.props.resourceStrings,v.f);return e&&String.format(e,this._getPanelStatusString())}const e=this._getAccessibilityLabel();return e&&Object(_.d)(e,e,void 0)}_getAccessibilityLabel(){if(this.props.navigationType===O.a.MultiSession){const e=Object(b.c)(this.props.resourceStrings,v.e);return e&&String.format(e,this._getPanelStatusString())}return Object(b.c)(this.props.resourceStrings,v.A)}_onKeyDownHandler(e){e.keyCode===N.a.Enter&&e.stopPropagation()}render(){const e=1===this.props.panelState;return r.createElement(a.a,{id:d.g,style:this._getButtonStyle(),onClick:this._onClickHandler,accessibilityLabel:this._getAccessibilityLabel(),title:this._getTitle(),accessibilityExpanded:e,onKeyDown:this._onKeyDownHandler,testhooks:{id:"navbutton",[s.a.LearningPathDOMAttributeSuffix]:"sitemap-launcher"}},r.createElement(o.a,{style:this._getButtonContainerStyle()},r.createElement(i.a,{style:this._getIconStyle()},r.createElement(l.b,{type:c.a.SiteMap}))))}}R.contextType=p.b;const x=Object(h.a)((function(){const e=Object(b.h)();return t=>{const n=e(t,v.w),r=Object(g.d)(t),a=Object(m.a)(t),i=Object(A.b)(t)?Object(A.a)(t):null,o=Object(S.a)(t),s=Object(C.c)(t),c=Object(P.a)(t)===T.b.Native;return{panelState:r,theme:a,designLanguage:i,resourceStrings:n,navigationType:o,needCollapsedByDefault:s||c,isMailApp:Object(I.a)(t)===w.a.MailApp}}}),(function(e){return{retrieveResourceStrings:t=>e(Object(y.e)(t)),loadPanelStateFromLocalStorage:t=>{e(Object(f.a)(t))},toggleSiteMap:()=>{e(Object(f.b)())},setSitemapExpandedState:t=>{e(Object(E.f)(t))}}}))(R)},"gy+e":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n("VCkP"),a=n("Z9sG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(){return{diagnosticName:"AuthenticateUser",boot:(e,t,n)=>o(t,n).then(r=>{e.getShimBootType()&&(e.getShimBootType().autoSignIn=r);const i=new a.a(t,n),o=[];return i.isOperationAvailable("ready")&&o.push(i.ready()),i.isOperationAvailable("initialized")&&o.push(i.initialized()),Promise.all(o)})}}function o(e,t){const n=new r.a(e,t);return n.isOperationAvailable("authenticate")?n.authenticate(!1):Promise.resolve(!0)}},h4iz:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return c}));var r=n("arV0"),a=n("E5IU"),i=n("Zvo8"),o=n("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e){return Object(a.i)(e)}function c(e){const t=s(e),n=Object(i.b)("persistentNavTourCookie_"+t);return null!==n&&"true"===n}function l(e,t){const{welcomePageName:n}=Object(r.g)(e,t.id);return n}function u(e,t){const n=Object(o.a)(e,t);return n?n.output:null}function d(e,t){const{dialogOptions:n}=Object(r.g)(e,t.id);return n}},h6c1:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){return e.pluginState[t]}n.d(t,"a",(function(){return r}))},hAdb:function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return p}));var r=n("D6Jg"),a=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e){return e.configuration&&e.configuration.performanceUiEnabled}function o(e){return e.configuration&&e.configuration.ribbonDebug}function s(e){return e.configuration&&e.configuration.fcbs}function c(e,t){return e.configuration.flags[null==t?void 0:t.toLowerCase()]}function l(e,t){const n=c(e,t);if(a.a.validate(n))return n}function u(e,t){const n=c(e,t);if(n&&/[\W]/.test(n))throw new Error(`The value of the flag '${t}' contains characters that are not supported.`);return n}function d(e,t){return Object(r.c)(u(e,t))}function p(e,t){var n,r;return null===(r=null===(n=u(e,t))||void 0===n?void 0:n.split("_"))||void 0===r?void 0:r.filter(e=>e.length)}},hBJV:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("K7RF"),a=n("Uv1Y"),i=n("x/aW"),o=n("iJGp"),s=n("/oKV");function c(){return{type:"metadataversion.retrieve.async",execute:({dispatch:e,getState:t},n)=>e(Object(r.b)(i.a.MetadataVersion,null,null,null,!1,o.a.OnDemandWithoutContext,null,null,[],null,s.a.Remote)).catch(e=>{null!=e&&null!=e.message?-2147093999!==e.errorCode&&Object(a.b)(e):Object(a.b)(e)})}}},hBbW:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),function(e){e.QUICK_SETUP_LABEL_ID="Quick_Setup_Text",e.QUICK_SETUP_VISITED_LABEL_ID="Quick_Setup_Visited_Text",e.QUICK_SETUP_NOT_VISITED_LABEL_ID="Quick_Setup_Not_Visited_Text",e.QUICK_SETUP_SELECTED_LABEL_ID="Quick_Setup_Selected_Text",e.CLOSE_BUTTON_LABEL_ID="Close_Text",e.PREVIOUS_BUTTON_LABEL_ID="Previous_Text",e.NEXT_BUTTON_LABEL_ID="Next_Text",e.SETTINGS_SETUP_LABEL_ID="Settings_Setup_Text",e.MENU_LABEL_ID="Menu_Text",e.SETTINGS_GROUP_LABEL_ID="Settings_Group_Text",e.APP_SHELL_BREAK_POINT_LABEL_ID="App_Shell_Break_Point_Text",e.GROUP_COLLAPSE_TOOLTIP_ID="Collapse_Group_Text",e.GROUP_EXPAND_TOOLTIP_ID="Expand_Group_Text",e.CHEVRON_COLLAPSE_TOOLTIP_ID="Hide_Settings_Text",e.CHEVRON_EXPAND_TOOLTIP_ID="Show_Settings_Text",e.QUICK_SETUP_CLOSE_BUTTON_TOOLTIP_ID="Quick_Setup_Close_Tooltip",e.PROGRESS_BAR_LOADING="PageLoadingMessage"}(r||(r={}));const a=[r.QUICK_SETUP_LABEL_ID,r.QUICK_SETUP_VISITED_LABEL_ID,r.QUICK_SETUP_NOT_VISITED_LABEL_ID,r.QUICK_SETUP_SELECTED_LABEL_ID,r.CLOSE_BUTTON_LABEL_ID,r.PREVIOUS_BUTTON_LABEL_ID,r.NEXT_BUTTON_LABEL_ID,r.SETTINGS_SETUP_LABEL_ID,r.MENU_LABEL_ID,r.SETTINGS_GROUP_LABEL_ID,r.APP_SHELL_BREAK_POINT_LABEL_ID,r.GROUP_COLLAPSE_TOOLTIP_ID,r.GROUP_EXPAND_TOOLTIP_ID,r.CHEVRON_COLLAPSE_TOOLTIP_ID,r.CHEVRON_EXPAND_TOOLTIP_ID,r.QUICK_SETUP_CLOSE_BUTTON_TOOLTIP_ID,r.PROGRESS_BAR_LOADING]},hIjC:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s}));var r=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){return e&&e.metadata&&e.metadata.dialogs&&t?e.metadata.dialogs[t.toLowerCase()]:null}function i(e,t){const n=a(e,t);return n?n.initialized:r.a.Uninitialized}function o(){return"Dialog"}function s(){return"Dialog"}},hK10:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){if(!e||!e.titles||0===e.titles.length)return null;const n=t?t.toString():"",r=Object.keys(e.titles);for(let t=0;t<r.length;t++){const a=r[t];if(!e.titles[a])continue;const i=e.titles[a];if(i.Name===n)return i}return null}function a(e,t){if(!e)return null;const n=Object.assign({},e);if(e.titles){const a={},i=r(e,t);i&&(a[""]=Object.assign({},i)),n.titles=a}return n}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},hVsf:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l}));var r=n("eXjw"),a=n("fC8v"),i=n("504W"),o=n("8VF0"),s=n("Uv1Y");function c(){return{type:"executeOData.getIsActivity",execute:({dispatch:e,getState:t},n)=>new Promise((t,r)=>{n.DataSource.getIsActivityFlags().then(n=>{const r=l(n);e(Object(o.b)(r)),t()},s.b)})}}function l(e){return{entities:e.value.reduce((e,t)=>{const n={Initialized:r.a.Uninitialized,IsActivity:t.IsActivity,ObjectTypeCode:t.ObjectTypeCode,IsEnabledInUnifiedInterface:!!Object(i.a)(t.IsVisibleInMobileClient)||(t.IsVisibleInMobileClient.Value||t.IsVisibleInMobileClient.CanBeChanged),DisplayName:Object(a.b)(t.DisplayName),DisplayCollectionName:Object(a.b)(t.DisplayCollectionName),ActivityTypeMask:t.ActivityTypeMask,EntityLogicalName:t.LogicalName,Id:t.MetadataId};return e[t.LogicalName]=n,e},{})}}},hfLa:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("NwjZ"),a={account:"crmSymbolFont entity-symbol Account",activitypointer:"crmSymbolFont entity-symbol Activitypointer",appointment:"crmSymbolFont entity-symbol Appointment",article:"symbolFont Article-symbol",businessunit:"crmSymbolFont entity-symbol BusinessUnit",campaign:"crmSymbolFont entity-symbol Campaign",campaignresolution:"symbolFont CampaignResolution-symbol",case:"symbolFont Case-symbol",caseresolution:"symbolFont CaseResolution-symbol",chat:"symbolFont Chat-symbol",competitor:"crmSymbolFont entity-symbol Competitor",connection:"crmSymbolFont entity-symbol Connection",contact:"crmSymbolFont entity-symbol Contact",contract:"crmSymbolFont entity-symbol Contract",createquote:"symbolFont CreateQuote-symbol",customactivity:"symbolFont CustomActivity-symbol",customeraddress:"crmSymbolFont entity-symbol CustomerAddress",dashboard:"crmSymbolFont entity-symbol Dashboard",distributionList:"symbolFont DistributionList-symbol",documenttemplates:"symbolFont DocumentTemplates-symbol",email:"crmSymbolFont entity-symbol Email",externalUser:"symbolFont GuestUser-symbol",fax:"crmSymbolFont entity-symbol Fax",goal:"crmSymbolFont entity-symbol Goal",guestUser:"symbolFont GuestUser-symbol",incident:"crmSymbolFont entity-symbol Incident",invoice:"crmSymbolFont entity-symbol Invoice",knowledgearticle:"crmSymbolFont entity-symbol Knowledgearticle",lead:"crmSymbolFont entity-symbol Lead",letter:"crmSymbolFont entity-symbol Letter",mail:"symbolFont Mail-symbol",membersicon:"symbolFont MembersIcon-symbol",metric:"crmSymbolFont entity-symbol Metric",opportunity:"crmSymbolFont entity-symbol Opportunity",opportunityproduct:"crmSymbolFont entity-symbol Opportunityproduct",phone:"symbolFont Phone-symbol",phonecall:"crmSymbolFont entity-symbol Phonecall",position:"crmSymbolFont entity-symbol Position",product:"crmSymbolFont entity-symbol Product",queueicon:"symbolFont QueueIcon-symbol",queueitem:"crmSymbolFont entity-symbol Queueitem",queueitemroute:"symbolFont QueueItemRoute-symbol",quote:"crmSymbolFont entity-symbol Quote",report:"crmSymbolFont entity-symbol Report",resolvecase:"symbolFont ResolveCase-symbol",salesliterature:"crmSymbolFont entity-symbol SalesLiterature",salesorder:"crmSymbolFont entity-symbol Salesorder",serviceactivity:"symbolFont ServiceActivity-symbol",sharepointdocument:"crmSymbolFont entity-symbol Sharepointdocument",socialprofile:"crmSymbolFont entity-symbol Socialprofile",systemuser:"crmSymbolFont entity-symbol Systemuser",task:"crmSymbolFont entity-symbol Task",team:"crmSymbolFont entity-symbol Team",transactioncurrency:"crmSymbolFont entity-symbol TransactionCurrency",user:"symbolFont GuestUser-symbol",wordtemplates:"symbolFont WordTemplates-symbol",msdyusd_task:"crmSymbolFont entity-symbol msdyusd_task-symbol",msdyusd_configuration:"crmSymbolFont entity-symbol msdyusd_configuration-symbol",msdyusd_customizationfiles:"crmSymbolFont entity-symbol msdyusd_customizationfiles-symbol",msdyusd_entitysearch:"crmSymbolFont entity-symbol msdyusd_entitysearch-symbol",msdyusd_uiievent:"crmSymbolFont entity-symbol msdyusd_uiievent-symbol",msdyusd_form:"crmSymbolFont entity-symbol msdyusd_form-symbol",uii_option:"crmSymbolFont entity-symbol uii_option-symbol",uii_hostedapplication:"crmSymbolFont entity-symbol uii_hostedapplication-symbol",msdyusd_scriptlet:"crmSymbolFont entity-symbol msdyusd_scriptlet-symbol",msdyusd_toolbarstrip:"crmSymbolFont entity-symbol msdyusd_toolbarstrip-symbol",msdyusd_usersettings:"crmSymbolFont entity-symbol msdyusd_usersettings-symbol",msdyusd_agentscriptaction:"crmSymbolFont entity-symbol msdyusd_agentscriptaction-symbol",msdyusd_auditanddiagnosticssetting:"crmSymbolFont entity-symbol msdyusd_auditanddiagnosticssetting-symbol",msdyusd_sessioninformation:"crmSymbolFont entity-symbol msdyusd_sessioninformation-symbol",msdyusd_windowroute:"crmSymbolFont entity-symbol msdyusd_windowroute-symbol",customentity:"symbolFont CustomEntity-symbol",default:"symbolFont CustomEntity-symbol",unresolvedaddress:"symbolFont InformationIcon-symbol",recurringappointmentmaster:"symbolFont NewRecurringAppointment-symbol",service:"crmSymbolFont entity-symbol Service",serviceappointment:"crmSymbolFont entity-symbol ServiceAppointment",equipment:"crmSymbolFont entity-symbol Equipment",pricelevel:"crmSymbolFont entity-symbol PriceLevel",goalrollupquery:"crmSymbolFont entity-symbol GoalRollUpQuery",uomschedule:"crmSymbolFont entity-symbol UoMSchedule",discounttype:"crmSymbolFont entity-symbol DiscountType",territory:"crmSymbolFont entity-symbol Territory",socialactivity:"crmSymbolFont entity-symbol Socialactivity",calendar:"crmSymbolFont entity-symbol Calendar",category:"crmSymbolFont entity-symbol Category",entitlement:"crmSymbolFont entity-symbol Entitlement",queue:"crmSymbolFont entity-symbol Queue",routingrule:"crmSymbolFont entity-symbol RoutingRule",routingruleitem:"crmSymbolFont entity-symbol RoutingRuleItem",msdyn_knowledgearticletemplate:"crmSymbolFont entity-symbol msdyn_knowledgearticletemplate",msdyn_servicelevelagreement:"crmSymbolFont entity-symbol msdyn_servicelevelagreement",msdyn_servicelevelagreementkpi:"crmSymbolFont entity-symbol msdyn_servicelevelagreementkpi",msdyn_servicelevelagreementinstance:"crmSymbolFont entity-symbol msdyn_servicelevelagreementinstance",Code:"crmSymbolFont entity-symbol Code",GroupList:"crmSymbolFont entity-symbol GroupList",CompletedSolid:"crmSymbolFont entity-symbol CompletedSolid",WarningSolid:"crmSymbolFont entity-symbol WarningSolid",site:"crmSymbolFont entity-symbol Site"};var i,o=n("HMYz"),s=n("iDZS"),c=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.getSymbolClassName=function(e){return function(e){return a[e]?a[e]:a.default}(e)},t}(r.a),u=o.connect(s.a)(l)},hgKT:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("OwbH");class a extends r.a{constructor(e,t){super([e]),this._inValues=null,this._inValues=t}get_inValues(){return this._inValues}testCondition(e){return this.get_inValues().indexOf(e)>=0}}},hirD:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");class a extends r.a{constructor(e,t){super(),this._requests=null,this._settings=null,this._requests=e,this._settings=t}get_name(){return"ExecuteMultiple"}get_xmlNamespace(){return"http://schemas.microsoft.com/xrm/2011/Contracts"}get_requests(){return this._requests}get_settings(){return this._settings}}},hoir:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));function r(e,t=10,n=2500){let r=0,a=0;return()=>{if(clearTimeout(r),a++,a===t)return a=0,void e();r=setTimeout(()=>{a=0},n)}}},hs84:function(e,t,n){"use strict";n.d(t,"a",(function(){return H}));var r=n("IKHO"),a=n("ufH1"),i=n("umme"),o=n("c7Og"),s=n("a475"),c=n("504W"),l=n("6K5O"),u=n("Div0"),d=n("H4dV"),p=n("XvL5"),g=n("rO1J"),h=n("2JG5"),f=n("WRF3"),m=n("GD3x"),b=n("UMB/"),_=n("eruq"),y=n("fU7K");class v{get_uniqueId(){return d.a.getInstance().get_PALEnabled()?s.a.get_Instance().get_application().get_applicationState().get_installationId():""}updateRequestForCallerOriginVersion(e){if(d.a.getInstance().get_PALEnabled()){const t=s.a.get_Instance().get_version().get_currentVersion()+"; Revision "+s.a.get_Instance().get_application().get_applicationState().get_revision()+(s.a.get_Instance().get_application().get_applicationState().get_iOSUpdateRevision()>0?" (iOS: "+s.a.get_Instance().get_application().get_applicationState().get_iOSUpdateRevision()+")":"")+(s.a.get_Instance().get_application().get_applicationState().get_win8UpdateRevision()>0?" (Win8: "+s.a.get_Instance().get_application().get_applicationState().get_win8UpdateRevision()+")":"")+(s.a.get_Instance().get_application().get_applicationState().get_androidUpdateRevision()>0?" (Android: "+s.a.get_Instance().get_application().get_applicationState().get_androidUpdateRevision()+")":"");e.setRequestHeader("CrmMobileClientShimVersion",t)}}updateRequestForCallerOriginUniqueId(e){d.a.getInstance().get_PALEnabled()&&e.setRequestHeader("CrmMobileClientUniqueId",Object(y.CrmUrlEncode)(this.get_uniqueId()))}}var S=n("Jz2d"),O=n("JdSN"),C=n("IdrN"),E=n("xiom"),I=n("T544"),w=n("Z6YS"),j=n("fskq"),P=n("0mlq"),T=n("EW4s");class N extends w.a{get_name(){return"CrmWebAPIService"}get_performanceStopwatch(){return j.b}createErrorResponse(e,t,n){return new O.a(e,t,n)}createErrorResponseFromHtml(e){return O.a.createFromHtml(e,null)}FetchFallback(e){let t=N._WebApiServiceUrl;"endpoint"in e&&(t=e.endpoint);const n=this.get_serverUrl()+t+e.urlParameters,r=e.body,a=e.method,i=this.createWebApiRequestOptions(n,a);this._AppendAdditionalHeaders(e,i);const o=new T.a;return this.executeJsonRequest(P.a.create(n,r,i)).then(e=>{o.resolve(e)},e=>{o.reject(e)}),o}_AppendAdditionalHeaders(e,t){const n=e.additionalHeaders;if(!Object(c.a)(n))for(const e in n){const r={key:e,value:n[e]};"Prefer"===r.key?t.prefer=r.value:"Content-Type"===r.key?t.contentType=r.value:t.additionalHeaders[r.key]=r.value}}}N._WebApiServiceUrl="/api/data/v9.0/";var A=n("jZCH"),D=n("WF3G"),R=n("hirD"),x=n("47MF"),M=n("Mr6u"),F=n("QFnk"),k=n("v3UX"),L=n("jxo7"),B=n("wo7m"),U=n("7O3c"),V=n("/d6W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class z extends Sys.EventArgs{constructor(e,t){super(),this._isAvailable=!1,this._isNetworkAvailable=!1,this._isAvailable=e,this._isNetworkAvailable=t}get_isAvailable(){return this._isAvailable}get_isNetworkAvailable(){return this._isNetworkAvailable}}var W=n("Hswk"),q=n("S2mk");class H{constructor(e,t,n){this._serverUri=null,this._proxy=null,this._eventManager=null,this._parentDataSource=null,this._isAvailable=!1,this._isNetworkAvailable=!1,this._isWaitingForNetwork=!1,this.waitingForNetworkPromise=null,this._remoteCallRetryHandler=null,this._networkWaitTimeOutCallbackId=0,this._WaitTimeToCheckNetworkStatus=5e3,this._serverUri=e,this._remoteCallRetryHandler=n,this._proxy=new S.a(this._serverUri,n,new v,t.get_ApplicationStatusProvider()),d.a.getInstance().get_IsAndroid()?(s.a.get_Instance().get_device().get_DeviceState().apcl("ConnectionAvailable",Object(W.a)(this,this._ConnectivityHandler,"ConnectivityHandler")),window.addEventListener("deviceready",Object(W.a)(this,this._oneTimeDeviceReadyEventListener,"oneTimeDeviceReadyEventListener"),!1)):this._addNetworkEventListeners(),this._eventManager=t.get_EventManager(),this._parentDataSource=t;const r=H._GetNetworkAvailablility();Object(a.e)("CrmServerDataSource:",u.a.crmServerDataSource,H._SettingServerAvailabilityString+r),this.set_isAvailable(r),this._isWaitingForNetwork=!1,this.waitingForNetworkPromise=new T.a}_addNetworkEventListeners(){window.addEventListener("offline",Object(W.a)(this,this._OfflineEvent,"OfflineEvent"),!1),window.addEventListener("online",Object(W.a)(this,this._OnlineEvent,"OnlineEvent"),!1)}_oneTimeDeviceReadyEventListener(e){this._addNetworkEventListeners(),window.removeEventListener("deviceready",Object(W.a)(this,this._oneTimeDeviceReadyEventListener,"oneTimeDeviceReadyEventListener"),!1)}get_isNetworkAvailable(){return H._GetNetworkAvailablility()}get_isAvailable(){return this._isAvailable&&(this.get_isNetworkAvailable()||this._isWaitingForNetwork)}set_isAvailable(e,t){return this._isAvailable===e&&this._isNetworkAvailable===e||(d.a.getInstance().get_PALEnabled()&&s.a.get_Instance().get_application().get_IsAvailable()&&!Object(c.a)(s.a.get_Instance().get_application().get_applicationState().get_nativeFCBContext())&&H._MobileClientOfflineWebResources in s.a.get_Instance().get_application().get_applicationState().get_nativeFCBContext()&&s.a.get_Instance().get_application().get_applicationState().get_nativeFCBContext()[H._MobileClientOfflineWebResources]&&s.a.get_Instance().get_application().setBoolValue("IsClientOffline",!e),Object(a.e)("IsAvailable:",u.a.crmServerDataSource,H._SettingServerAvailabilityString+e+":Network status = "+this.get_isNetworkAvailable()+": Navigator value = "+window.navigator.onLine+": previous network available value = "+this._isNetworkAvailable+":passed network status value = "+t),this._isAvailable=e,this._isNetworkAvailable=this.get_isNetworkAvailable(),Object(q.j)(t)||(this._isNetworkAvailable=t),this._eventManager.OnServerAvailabilityChange(this,new z(this._isAvailable,this._isNetworkAvailable))),e}get_isWaitingForNetwork(){return this._isWaitingForNetwork}get_waitingForNetworkPromise(){return this.waitingForNetworkPromise}set_settings(e){return Object(c.a)(this._proxy)||this._proxy.set_Settings(e),e}get_proxy(){return this._proxy}setWebAPIService(e){const t=new N(this._serverUri,this._remoteCallRetryHandler,new v,this._parentDataSource.get_ApplicationStatusProvider()),n=e;n.noFetchFallback=t,n.parentDataSource=this._parentDataSource,n.noSerializerFallback=this._proxy,this._proxy=e}get_parentDataSource(){return this._parentDataSource}initialize(e){const t=new T.a;return t.resolve(),t}getClientMetadata(e,t,n){const r=new T.a;return this.get_proxy().GetClientMetadata(e,n).then(e=>{r.resolve(e)},this._OperationFailure(r)),r}syncClientMetadata(e){const t=new T.a;return this.get_proxy().SyncClientMetadata(e).then(e=>{t.resolve(e)},this._OperationFailure(t)),t}getRecentItems(e,t,n,r,a,o,s){const c=new T.a;return this.get_proxy().GetRecentItems(e,t,n,r,a,o,s).then(e=>{c.resolve(e)},e=>{c.reject(i.a.FromMessage(e.get_message()))}),c}UpdateRecentItems(e,t){const n=new T.a;return this.get_proxy().UpdateRecentItems(e,t).then(e=>{n.resolve(e)},e=>{n.reject(i.a.FromMessage(e.get_message()))}),n}getIsActivityFlags(){const e=new T.a;return this.get_proxy().GetIsActivityFlags().then(t=>{e.resolve(t)},t=>{e.reject(i.a.FromMessage(t.get_message()))}),e}retrieveUserContext(e,t){const n=new T.a;return this.get_proxy().RetrieveUserContext(e,t).then(e=>{e.get_success()?n.resolve(e.get_userContext()):(Object(l.a)("Error Message:"+e.get_errorMessage()),n.reject(i.a.fromErrorCode(e.get_errorCode())))},this._OperationFailure(n)),n}create(e,t,n){const r=new T.a;return this.get_proxy().Create(e,t,n).then(t=>{r.resolve(new f.a(e.get_identifier().LogicalName,t.get_id()))},this._OperationFailure(r)),r}retrieveRelatedEntities(e,t,n,r,a,s,l,u){const d=new T.a;let g=new Array(0);if(this.get_parentDataSource().get_UserContext().get_organizationSettings().get_isMocaOfflineFeatureEnabled()&&!Object(c.a)(r))for(const e of r){const t=Sys.Net.XMLDOM(e.get_value()),n=t.getElementsByTagName("link-entity")[0];Object(c.a)(n)||Object(c.a)(n.attributes.getNamedItem("mobileClientOffline"))||"true"!==n.attributes.getNamedItem("mobileClientOffline").nodeValue||t.getElementsByTagName("entity")[0].removeChild(n),g.push(new o.a(e.get_key(),Object(_.a)(t).get_outerXml()))}else g=r;if(h.a.hasAccessRights(e.LogicalName,this.get_parentDataSource().get_MetadataCache())){const n=this.get_parentDataSource().get_MetadataCache().getEntityMetadata(e.LogicalName);if(Object(c.a)(n))d.reject(i.a.FromMessage("Retrieve - Entity metadata not found."));else if(n.get_isChildEntity()){if(t instanceof p.a){const e=t.get_Columns();e.indexOf(n.get_parentEntityReferencingAttribute())<0&&(e.push(n.get_parentEntityReferencingAttribute()),t=new p.a(e))}this.get_proxy().Execute(new k.a(e,t,g,!1,null,u),s).then(e=>{const r=e.get_entity(),o=r.getValue(n.get_parentEntityReferencingAttribute()),l=[new F.a(o,new f.a("systemuser",this.get_parentDataSource().get_UserContext().get_UserId()))];this._CheckHasAllSecuredAttributePrivileges(n,t,s).then(e=>{e||l.push(new M.a(this._GetUserSharedAttributePermissionsQuery(o))),this.get_proxy().Execute(new R.a(l,new m.a(!1,!0)),s).then(e=>{const t=e;if(t.get_isFaulted()){const e=t.get_responses()[0];Object(c.a)(e)||Object(c.a)(e.get_fault())?d.reject(i.a.FromMessage("Retrieve - ExecuteMultiple faulted")):d.reject(i.a.fromErrorCode(e.get_fault().get_errorCode()))}else{let e=null,n=null;for(const r of t.get_responses())r.get_response()instanceof B.a?e=r.get_response():r.get_response()instanceof L.a&&(n=r.get_response());r.set_accessRights(e.get_accessRights()),r.set_clientRetrieveOptions(a),Object(c.a)(n)||r.set_userSharedAttributePrivileges(this._GetUserSharedAttributePermissionsFromCollection(n.get_entityCollection())),d.resolve(r)}},this._OperationFailure(d))})},this._OperationFailure(d))}else{const r=[new k.a(e,t,g,!1,null,u),new F.a(e,new f.a("systemuser",this.get_parentDataSource().get_UserContext().get_UserId()))];n.getEntityCanBeUsedInBusinessProcess()&&l&&r.push(l),this._CheckHasAllSecuredAttributePrivileges(n,t,s).then(t=>{t||r.push(new M.a(this._GetUserSharedAttributePermissionsQuery(e))),this.get_proxy().Execute(new R.a(r,new m.a(!1,!0)),s).then(e=>{const t=e;if(t.get_isFaulted()){const e=t.get_responses()[0];Object(c.a)(e)||Object(c.a)(e.get_fault())?d.reject(i.a.FromMessage("Retrieve - ExecuteMultiple faulted")):d.reject(i.a.fromErrorCode(e.get_fault().get_errorCode()))}else{let e=null,n=null,r=null,i=null;for(const a of t.get_responses())a.get_response()instanceof B.a?e=a.get_response():a.get_response()instanceof V.a?n=a.get_response():a.get_response()instanceof U.a?r=a.get_response():a.get_response()instanceof L.a&&(i=a.get_response());const o=n.get_entity();o.set_accessRights(e.get_accessRights()),o.set_clientRetrieveOptions(a),Object(c.a)(r)||(o.set_entityRecordForProcess(r.get_entity()),Object(c.a)(o.get_entityRecordForProcess())||(o.get_entityRecordForProcess().mergeEntityRecordFields(o),o.mergeEntityRecordFields(o.get_entityRecordForProcess())),Object(c.a)(r.get_globalNavigationData())||Object(c.a)(r.get_globalNavigationData().fields)||(o.set_globalNavigationData(r.get_globalNavigationData()),this.get_isAvailable()&&(o.get_globalNavigationData().fields.bpfDefinitionVersionNumber=r.get_bpfDefinitionVersionNumber()))),Object(c.a)(i)||o.set_userSharedAttributePrivileges(this._GetUserSharedAttributePermissionsFromCollection(i.get_entityCollection())),d.resolve(o)}},this._OperationFailure(d))})}}else this._RetrieveRecordWithProcessData(e,l,t,g,a,u,s,d);return d}retrieveMultiple(e,t,n){const r=new T.a;return this.get_proxy().RetrieveMultiple(e,n).then(e=>{e.get_entityCollection().set_clientRetrieveOptions(t),r.resolve(e.get_entityCollection())},this._OperationFailure(r)),r}retrieveEntitiesForAggregateQuery(e,t,n){const r=new T.a,a={};for(const e in t){const n={key:e,value:t[e]};a[n.key]=n.value instanceof D.a?n.value.get_FetchXml():n.value.toString()}return this.get_proxy().Execute(new x.a(e.get_FetchXml(),a),n).then(n=>{if(n){const a=n;a.get_entityCollection().set_query(new E.a(e,t)),r.resolve(a.get_entityCollection())}else r.reject(i.a.FromMessage("Response from server is null"))},this._OperationFailure(r)),r}update(e,t,n,r){const a=new T.a;return this.get_proxy().Update(t,n,r).then(t=>{a.resolve(e)},this._OperationFailure(a)),a}Delete(e,t){const n=new T.a;return this.get_proxy().DeleteEntity(e,t).then(t=>{n.resolve(e)},this._OperationFailure(n)),n}execute(e,t){const n=new T.a;return this.get_proxy().Execute(e,t).then(e=>{n.resolve(e)},this._OperationFailure(n)),n}executeOData(e,t){const n=new T.a;return this.get_proxy().ExecuteOData(e,t).then(e=>{n.resolve(e)},this._OperationFailure(n)),n}retrieveEntityMetadata(e,t){const n=new T.a;if(Object(r.b)()&&!Object(c.a)(Mscrm.MailAppInlineData.entityMetadata)){const t=Mscrm.MailAppInlineData.entityMetadata.Metadata;if(e in t)return n.resolve(new C.a(Object(_.a)(t[e])).get_entityMetadataCollection().get_item(0)),delete t[e],n}return this.get_proxy().retrieveEntityMetadata(e,this.get_parentDataSource().get_UserContext().get_UserSettings().get_languageId(),t).then(e=>{e.get_entityMetadataCollection().get_count()>0?n.resolve(e.get_entityMetadataCollection().get_item(0)):n.reject(i.a.fromErrorCode(-2147220969))},this._OperationFailure(n)),n}retrieveMultipleAttributeMetadata(e,t){const n=new T.a;return this.get_proxy().RetrieveMultipleAttributeMetadata(e,this.get_parentDataSource().get_UserContext().get_UserSettings().get_languageId(),t).then(t=>{if(t&&t.get_AttributeMetadata()&&t.get_AttributeMetadata().length>0){const e=t.get_AttributeMetadata();n.resolve(e)}else n.reject(i.a.FromMessage("Entity {0} has no AttributeMetadata of {1}",e.get_EntityLogicalName(),e.get_AttributeNames()))},this._OperationFailure(n)),n}ping(){const e=new T.a;return this.get_isNetworkAvailable()?this.get_proxy().WhoAmI().then(()=>{this.set_isAvailable(!0),Object(a.e)("Ping:",u.a.crmServerDataSource,H._SettingServerAvailabilityString+this.get_isAvailable()+". Ping server was successfull."),e.resolve(!0)},t=>{if(H._IsStatusOffline(t))Object(a.e)("Ping:",u.a.crmServerDataSource,H._SettingServerAvailabilityString+"Unchanged. Ping server failed."),e.reject(H.GetErrorStatusFromErrorResponse(t));else{const n=Object(c.a)(t.get_request())?-1:t.get_request().status;this.set_isAvailable(!0),Object(a.e)("Ping:",u.a.crmServerDataSource,H._SettingServerAvailabilityString+this.get_isAvailable()+". Ping server failed but this is not an offline error. IsErrorInOffline = "+t.get_isErrorInOffline()+", httpStatus = "+n),e.resolve(!0)}}):(Object(a.e)("Ping:",u.a.crmServerDataSource,H._SettingServerAvailabilityString+"Unchanged. Network is not available."),e.resolve(!1)),e}changeProcessAndStage(e,t,n,r,a,o){const s=new T.a;return this.get_proxy().changeProcessAndStage(e,t,n,r,a,o).then(e=>{e.get_success()?s.resolve(e.get_response()):s.reject(i.a.FromMessage(e.get_errorMessage()))},this._OperationFailure(s)),s}createNavigationEntity(e,t,n,r,a){const o=new T.a;return this.get_proxy().createNavigationEntity(e,t,n,r,a).then(e=>{e.get_success()?o.resolve(e.get_response()):o.reject(i.a.FromMessage(e.get_errorMessage()))},this._OperationFailure(o)),o}retrieveNavigationEntities(e,t,n,r,a){const o=new T.a;return Object(c.b)(t)||Object(c.b)(n)?o.resolve():(this.get_proxy().retrieveNavigationEntities(e,t,n,r,a).then(e=>{e.get_success()?o.resolve(e.get_response()):o.reject(i.a.FromMessage(e.get_errorMessage()))},this._OperationFailure(o)),o)}retrieveUserLocalFacets(e,t){const n=new T.a;return this.get_proxy().RetrieveUserLocalFacets(e,t).then(e=>{e&&n.resolve(e)},this._OperationFailure(n)),n}_OperationFailure(e){return t=>{try{const n=this.get_isAvailable();this._HandleOfflineError(t),n!==this.get_isAvailable()&&Object(a.e)("OperationFailure:",u.a.crmServerDataSource,H._SettingServerAvailabilityString+this.get_isAvailable()+". Previous server availability was "+n);const r=H.GetErrorStatusFromErrorResponse(t);this.get_isAvailable()||(r.set_ErrorCode(-2147093999),Object(c.b)(r.get_Message())&&r.set_Message(i.a.fromErrorCode(r.get_ErrorCode()).get_Message())),e.reject(r)}catch(t){e.reject(t)}}}_HandleOfflineError(e){if(this._isAvailable&&this.get_isNetworkAvailable()&&H._IsStatusOffline(e)){const t=Object(c.a)(e.get_request())?-1:e.get_request().status;this.set_isAvailable(!1),Object(a.e)("HandleOfflineError:",u.a.crmServerDataSource,H._SettingServerAvailabilityString+this.get_isAvailable()+". IsErrorOffline = "+e.get_isErrorInOffline()+", httpStatus= "+t)}}_OfflineEvent(e){this.get_isNetworkAvailable()||this._isWaitingForNetwork?(Object(a.e)("OfflineEvent:",u.a.crmServerDataSource,H._SettingServerAvailabilityString+"false.: isWaitingForNetwork = "+this._isWaitingForNetwork+":window.navigator.onLine = "+window.navigator.onLine+":this.get_isNetworkAvailable() = "+this.get_isNetworkAvailable()),this.set_isAvailable(!1,!1)):(this._isWaitingForNetwork=!0,this.waitingForNetworkPromise=new T.a,Object(a.e)("OfflineEvent:",u.a.crmServerDataSource,"Waiting for network to comeback with SetTimeout of 5 seconds"),this._networkWaitTimeOutCallbackId=window.setTimeout(()=>{this.get_isNetworkAvailable()?Object(a.e)("OfflineEvent:",u.a.crmServerDataSource,String.format("{0} unchanged after waiting for {1} seconds. Earlier Server availability status = {2}.",H._SettingServerAvailabilityString,this._WaitTimeToCheckNetworkStatus,this.get_isAvailable())):(this.set_isAvailable(!1,!1),Object(a.e)("OfflineEvent:",u.a.crmServerDataSource,H._SettingServerAvailabilityString+this.get_isAvailable())),this._isWaitingForNetwork=!1,this.waitingForNetworkPromise.resolve()},this._WaitTimeToCheckNetworkStatus))}_OnlineEvent(e){Object(a.e)("OnlineEvent:",u.a.crmServerDataSource,H._SettingServerAvailabilityString+". IsNetworkAvailable = "+this.get_isNetworkAvailable()),this._isWaitingForNetwork&&(this._isWaitingForNetwork=!1,this.waitingForNetworkPromise.resolve(),window.clearTimeout(this._networkWaitTimeOutCallbackId)),this._eventManager.OnServerAvailabilityChange(this,new z(this._isAvailable,!0))}_SetNativeConnectivityOffline(){d.a.getInstance().get_PALEnabled()&&s.a.get_Instance().get_application().get_IsAvailable()&&!Object(c.a)(s.a.get_Instance().get_application().get_applicationState().get_nativeFCBContext())&&H._MobileClientOfflineWebResources in s.a.get_Instance().get_application().get_applicationState().get_nativeFCBContext()&&s.a.get_Instance().get_application().get_applicationState().get_nativeFCBContext()[H._MobileClientOfflineWebResources]&&s.a.get_Instance().get_application().setBoolValue("IsClientOffline",!0),this._isAvailable=this._isNetworkAvailable=s.a.get_Instance().get_device().get_DeviceState().get_connectionAvailable(),Object(a.e)("_SetNativeConnectivityOffline:",u.a.crmServerDataSource,H._SettingServerAvailabilityString+this._isAvailable+". NetWork Status = "+this._isNetworkAvailable),this._eventManager.OnServerAvailabilityChange(this,new z(this._isAvailable,this._isNetworkAvailable))}_ConnectivityHandler(e,t){if(s.a.get_Instance().get_device().get_DeviceState().get_connectionAvailable()||this._isWaitingForNetwork)Object(a.e)("ConnectivityHandler:",u.a.crmServerDataSource,H._SettingServerAvailabilityString+"Unchanged. ConnectionAvailable = "+s.a.get_Instance().get_device().get_DeviceState().get_connectionAvailable()),this._isWaitingForNetwork&&(this._isWaitingForNetwork=!1,this.waitingForNetworkPromise.resolve(),window.clearTimeout(this._networkWaitTimeOutCallbackId)),this._eventManager.OnServerAvailabilityChange(this,new z(this._isAvailable,!0));else{const e=s.a.get_Instance().get_device().get_DeviceState().get_connectionAvailable();this._isAvailable===e&&this._isNetworkAvailable===e||(this._isWaitingForNetwork=!0,this.waitingForNetworkPromise=new T.a,Object(a.e)("ConnectivityHandler:",u.a.crmServerDataSource,"Waiting for network to comeback with SetTimeout of 5 seconds"),this._networkWaitTimeOutCallbackId=window.setTimeout(()=>{s.a.get_Instance().get_device().get_DeviceState().get_connectionAvailable()?Object(a.e)("ConnectivityHandler:",u.a.crmServerDataSource,H._SettingServerAvailabilityString+"Unchanged(After waiting for few seconds). ConnectionAvailable = "+s.a.get_Instance().get_device().get_DeviceState().get_connectionAvailable()):(this._SetNativeConnectivityOffline(),Object(a.e)("ConnectivityHandler:",u.a.crmServerDataSource,H._SettingServerAvailabilityString+this._isAvailable+". ConnectionAvailable = "+s.a.get_Instance().get_device().get_DeviceState().get_connectionAvailable())),this._isWaitingForNetwork=!1,this.waitingForNetworkPromise.resolve()},this._WaitTimeToCheckNetworkStatus))}}_GetUserSharedAttributePermissionsQuery(e){return'<fetch distinct="false" no-lock="false" mapping="logical"><entity name="principalobjectattributeaccess"><attribute name="attributeid" /><attribute name="readaccess" /><attribute name="updateaccess" /><filter type="and"><condition attribute="objectid" operator="eq" value="'+e.Id+'" /><condition attribute="principalid" operator="eq-useroruserteams" /></filter></entity></fetch>'}_GetUserSharedAttributePermissionsFromCollection(e){const t={};for(let n=0;n<e.get_count();n++){const r=e.get_item(n).getValue("attributeid"),a=1===e.get_item(n).getValue("readaccess").get_value(),i=1===e.get_item(n).getValue("updateaccess").get_value();if(r.toString()in t&&(a||i)){const e=new g.a(r,!1,a||t[r.toString()].get_CanRead(),i||t[r.toString()].get_CanUpdate());t[r.toString()]=e}else r.toString()in t||(t[r.toString()]=new g.a(r,!1,a,i))}return t}_CheckHasAllSecuredAttributePrivileges(e,t,n){const r=new T.a;if(e.get_hasSecuredAttributes()){let a=null;t instanceof p.a&&(a=t.get_Columns()),A.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(new I.a(e.get_logicalName(),a),n).then(e=>{let t=!0;for(let n=0;n<e.length;n++)if(e[n].get_isSecured()){const r=A.a.get_DefaultInstance().get_UserContext().get_attributePrivileges()[e[n].get_id().toString()];if(Object(c.a)(r)||!r.get_CanRead()||!r.get_CanUpdate()){t=!1;break}}r.resolve(t)},e=>{r.resolve(!1)})}else r.resolve(!0);return r}_RetrieveRecordWithProcessData(e,t,n,r,a,o,s,l){const u=this.get_parentDataSource().get_MetadataCache().getEntityMetadata(e.LogicalName);if(Object(c.a)(u)||!u.get_isBusinessProcessEnabled()||Object(c.a)(t))this.get_proxy().Execute(new k.a(e,n,r,!1,null,o),s).then(e=>{const t=e;Object(c.a)(t.get_entity())?l.reject(i.a.FromMessage("Entity record not found.")):(t.get_entity().set_clientRetrieveOptions(a),l.resolve(t.get_entity()))},this._OperationFailure(l));else{const u=[new k.a(e,n,r,!1,null,o),t];this.get_proxy().Execute(new R.a(u,new m.a(!1,!0)),s).then(e=>{const t=e;if(t.get_isFaulted()){const e=t.get_responses()[0];Object(c.a)(e)||Object(c.a)(e.get_fault())?l.reject(i.a.FromMessage("Retrieve - ExecuteMultiple faulted")):l.reject(i.a.fromErrorCode(e.get_fault().get_errorCode()))}else{let e=null,n=null;for(const r of t.get_responses())r.get_response()instanceof V.a?e=r.get_response():r.get_response()instanceof U.a&&(n=r.get_response());const r=e.get_entity();r.set_clientRetrieveOptions(a),r.set_entityRecordForProcess(n.get_entity()),Object(c.a)(r.get_entityRecordForProcess())||(r.get_entityRecordForProcess().mergeEntityRecordFields(r),r.mergeEntityRecordFields(r.get_entityRecordForProcess())),r.set_globalNavigationData(n.get_globalNavigationData()),r.get_globalNavigationData()&&(r.fields[b.a]=r.get_globalNavigationData().fields[b.a].Id,r.fields[b.c]=r.get_globalNavigationData().fields[b.b],r.fields[b.d]=r.get_globalNavigationData().fields[b.d]),l.resolve(r)}},this._OperationFailure(l))}}static _GetNetworkAvailablility(){let e=!1;return e=window.navigator.onLine,d.a.getInstance().get_IsAndroid()&&(e=s.a.get_Instance().get_device().get_DeviceState().get_connectionAvailable()),e}static GetErrorStatusFromErrorResponse(e){const t=H._ErrorStatusFactory(e);return e instanceof O.a&&(Object(c.a)(e.get_organizationServiceFault())||(t.set_ErrorCode(e.get_organizationServiceFault().get_errorCode()),t.set_ErrorFault(e.get_organizationServiceFault())),e.get_request()&&401===e.get_request().status&&t.set_ErrorCode(-2147093995),!t.get_ErrorCode()&&e.get_request()&&(t.set_ErrorCode(H._GetGenericCrmErrorCode(e,t)),Object(a.e)("GetErrorStatusFromErrorResponse:",u.a.crmServerDataSource,"HTTP Status : "+e.get_request().status+": Map CrmErrorCode : 0 : to ErrorCode: "+t.get_ErrorCode())),Object(c.a)(e.get_request())||Object(c.a)(e.get_request().status)||t.set_HttpStatusCode(e.get_request().status),Object(c.a)(e.get_clientRequestId())||t.set_ClientRequestId(e.get_clientRequestId()),Object(c.a)(e.get_serverResponseId())||t.set_ServerResponseId(e.get_serverResponseId()),Object(c.a)(e.get_retryAfter())||t.set_RetryAfter(e.get_retryAfter()),!Object(c.a)(e.get_contentId())&&e.get_contentId()>0?t.set_FaultedRequestIndex(e.get_contentId()-1):t.set_FaultedRequestIndex(-1)),t}static _GetGenericCrmErrorCode(e,t){if(!t.get_ErrorCode()){let t=0;return t=400===e.get_request().status?-2147015424:401===e.get_request().status?-2147015423:403===e.get_request().status?-2147015422:404===e.get_request().status?-2147015421:429===e.get_request().status?-2147015420:500===e.get_request().status?-2147015419:501===e.get_request().status?-2147015418:502===e.get_request().status?-2147015417:503===e.get_request().status?-2147015416:504===e.get_request().status?-2147015415:-2147015414,t}return t.get_ErrorCode()}static _ErrorStatusFactory(e){if(e instanceof i.a)return e;if(!(e instanceof O.a))return i.a.fromGenericError(e);const t=e;return i.a.FromMessage(t.get_message())}static _IsStatusOffline(e){return e instanceof O.a&&(!!e.get_isErrorInOffline()||!Object(c.a)(e.get_request())&&(!e.get_request().status||502===e.get_request().status))}}H._MobileClientOfflineWebResources="MobileClientOfflineWebResources",H._SettingServerAvailabilityString="Setting server availability to "},htFu:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return g}));var r=n("Uv1Y"),a=n("eXjw"),i=n("K7RF"),o=n("Fn5S"),s=n("/oKV"),c=n("iJGp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l="taskBasedFlowGlobalMenu.retrieve",u="taskBasedFlowGlobalMenu.display",d="TaskBasedFlow.RetrieveTaskBasedFlowGlobalMenu";function p(){return{type:"taskBasedFlowGlobalMenu.retrieve.async",execute({dispatch:e,getState:t},n){n.DataSource;const u=t();let p=s.a.LocalAndRemote;const g=Object(o.c)(u);if(g===a.a.Initialized&&Object(i.e)(u,Object(o.a)(u).overallVersionNumber)&&(p=s.a.Remote),g===a.a.Uninitialized||p===s.a.Remote)return e(function(){const e={initialized:a.a.Initializing};return{type:l,payload:{taskBasedFlowGlobalMenu:e}}}()),e(function(e,t){return{type:"taskBasedFlowGlobalMenu.retrieve.async",execute:({dispatch:e,getState:n},a)=>e(Object(i.b)("taskbasedflowglobalmenu",null,null,null,!0,c.a.OnDemandWithContext,null,null,[],null,t)).catch(r.b)}}(0,p)).then(t=>(t?n.EventManager.ReportComponentSuccess(d):n.EventManager.ReportComponentFailure(d,Error("Global menu metadata descriptor is null")),e(function(e){return{type:l,payload:e}}(t)),Promise.resolve()));return Object(o.a)(u)?n.EventManager.ReportComponentSuccess(d):n.EventManager.ReportComponentFailure(d,Error("Task based flow global menu not found in state")),Promise.resolve()}}}function g(e){return{type:u,payload:{taskBasedFlowGlobalMenu:{display:e}}}}},i1f0:function(e,t,n){"use strict";n.d(t,"c",(function(){return Te})),n.d(t,"Qc",(function(){return Br})),n.d(t,"Eb",(function(){return Ur})),n.d(t,"a",(function(){return Ne})),n.d(t,"d",(function(){return De})),n.d(t,"f",(function(){return Ae})),n.d(t,"Zb",(function(){return nn})),n.d(t,"fb",(function(){return Fe})),n.d(t,"Y",(function(){return qe})),n.d(t,"Fc",(function(){return He})),n.d(t,"Gc",(function(){return Ge})),n.d(t,"p",(function(){return Ye})),n.d(t,"qc",(function(){return Je})),n.d(t,"A",(function(){return un})),n.d(t,"Dc",(function(){return at})),n.d(t,"F",(function(){return Tt})),n.d(t,"hb",(function(){return Nt})),n.d(t,"Kc",(function(){return it})),n.d(t,"Jc",(function(){return Xn})),n.d(t,"tc",(function(){return gt})),n.d(t,"rc",(function(){return ht})),n.d(t,"s",(function(){return Rt})),n.d(t,"Mc",(function(){return ft})),n.d(t,"G",(function(){return mt})),n.d(t,"w",(function(){return It})),n.d(t,"wc",(function(){return Mt})),n.d(t,"m",(function(){return dt})),n.d(t,"ad",(function(){return pt})),n.d(t,"Db",(function(){return st})),n.d(t,"U",(function(){return ct})),n.d(t,"nc",(function(){return ut})),n.d(t,"Hc",(function(){return nt})),n.d(t,"Ic",(function(){return rt})),n.d(t,"r",(function(){return Qt})),n.d(t,"J",(function(){return en})),n.d(t,"H",(function(){return tn})),n.d(t,"ed",(function(){return $e})),n.d(t,"tb",(function(){return Ze})),n.d(t,"dd",(function(){return et})),n.d(t,"Z",(function(){return tt})),n.d(t,"Qb",(function(){return Be})),n.d(t,"jc",(function(){return Zt})),n.d(t,"pc",(function(){return rn})),n.d(t,"zc",(function(){return an})),n.d(t,"g",(function(){return Ut})),n.d(t,"Gb",(function(){return Vt})),n.d(t,"O",(function(){return on})),n.d(t,"Yc",(function(){return sn})),n.d(t,"Zc",(function(){return cn})),n.d(t,"i",(function(){return ln})),n.d(t,"sb",(function(){return dn})),n.d(t,"xb",(function(){return er})),n.d(t,"t",(function(){return gn})),n.d(t,"v",(function(){return hn})),n.d(t,"u",(function(){return pn})),n.d(t,"b",(function(){return Me})),n.d(t,"wb",(function(){return _n})),n.d(t,"Rb",(function(){return On})),n.d(t,"Sb",(function(){return Cn})),n.d(t,"Ub",(function(){return In})),n.d(t,"Tb",(function(){return En})),n.d(t,"Ac",(function(){return wn})),n.d(t,"kc",(function(){return jn})),n.d(t,"mb",(function(){return An})),n.d(t,"jb",(function(){return Dn})),n.d(t,"C",(function(){return Kn})),n.d(t,"y",(function(){return qt})),n.d(t,"sc",(function(){return Qn})),n.d(t,"vb",(function(){return Yn})),n.d(t,"k",(function(){return Jn})),n.d(t,"Lb",(function(){return Tn})),n.d(t,"Mb",(function(){return Xe})),n.d(t,"kb",(function(){return zn})),n.d(t,"Wc",(function(){return qn})),n.d(t,"Uc",(function(){return Ue})),n.d(t,"pb",(function(){return Hn})),n.d(t,"B",(function(){return rr})),n.d(t,"Ob",(function(){return ir})),n.d(t,"Pb",(function(){return or})),n.d(t,"gb",(function(){return $n})),n.d(t,"cb",(function(){return yn})),n.d(t,"ab",(function(){return vn})),n.d(t,"Oc",(function(){return sr})),n.d(t,"M",(function(){return Bt})),n.d(t,"ac",(function(){return ur})),n.d(t,"Nc",(function(){return cr})),n.d(t,"Yb",(function(){return pr})),n.d(t,"ob",(function(){return gr})),n.d(t,"fc",(function(){return hr})),n.d(t,"Bc",(function(){return Gn})),n.d(t,"ic",(function(){return fr})),n.d(t,"ec",(function(){return At})),n.d(t,"dc",(function(){return tr})),n.d(t,"lc",(function(){return Pn})),n.d(t,"R",(function(){return _r})),n.d(t,"S",(function(){return yr})),n.d(t,"Lc",(function(){return Sr})),n.d(t,"K",(function(){return $t})),n.d(t,"V",(function(){return Zn})),n.d(t,"j",(function(){return Xt})),n.d(t,"Vb",(function(){return Vn})),n.d(t,"oc",(function(){return lt})),n.d(t,"vc",(function(){return Lt})),n.d(t,"yb",(function(){return zt})),n.d(t,"uc",(function(){return Ft})),n.d(t,"bc",(function(){return Gt})),n.d(t,"cc",(function(){return Kt})),n.d(t,"Nb",(function(){return ze})),n.d(t,"Jb",(function(){return We})),n.d(t,"zb",(function(){return Ht})),n.d(t,"Cc",(function(){return ke})),n.d(t,"z",(function(){return nr})),n.d(t,"rb",(function(){return Mn})),n.d(t,"qb",(function(){return Fn})),n.d(t,"xc",(function(){return kn})),n.d(t,"ub",(function(){return Ln})),n.d(t,"W",(function(){return Bn})),n.d(t,"bd",(function(){return Ct})),n.d(t,"Sc",(function(){return Or})),n.d(t,"gd",(function(){return ot})),n.d(t,"L",(function(){return Yt})),n.d(t,"D",(function(){return wt})),n.d(t,"E",(function(){return jt})),n.d(t,"X",(function(){return Dt})),n.d(t,"db",(function(){return Cr})),n.d(t,"h",(function(){return Er})),n.d(t,"gc",(function(){return Ar})),n.d(t,"Ab",(function(){return Rn})),n.d(t,"ib",(function(){return xn})),n.d(t,"eb",(function(){return wr})),n.d(t,"T",(function(){return jr})),n.d(t,"Ec",(function(){return Ke})),n.d(t,"Vc",(function(){return Pr})),n.d(t,"N",(function(){return Tr})),n.d(t,"Rc",(function(){return Nr})),n.d(t,"P",(function(){return Dr})),n.d(t,"x",(function(){return Pt})),n.d(t,"o",(function(){return Ot})),n.d(t,"Ib",(function(){return bt})),n.d(t,"Kb",(function(){return yt})),n.d(t,"Cb",(function(){return vt})),n.d(t,"I",(function(){return Rr})),n.d(t,"Bb",(function(){return St})),n.d(t,"cd",(function(){return xr})),n.d(t,"Hb",(function(){return Lr})),n.d(t,"fd",(function(){return Mr})),n.d(t,"lb",(function(){return Wn})),n.d(t,"mc",(function(){return Nn})),n.d(t,"Pc",(function(){return dr})),n.d(t,"Tc",(function(){return Ir})),n.d(t,"bb",(function(){return Sn})),n.d(t,"hc",(function(){return br})),n.d(t,"Xb",(function(){return Fr})),n.d(t,"Wb",(function(){return kr})),n.d(t,"l",(function(){return Vr})),n.d(t,"Xc",(function(){return fn})),n.d(t,"e",(function(){return Re})),n.d(t,"yc",(function(){return mr})),n.d(t,"Fb",(function(){return kt})),n.d(t,"Q",(function(){return _t})),n.d(t,"nb",(function(){return xt})),n.d(t,"q",(function(){return Wr})),n.d(t,"n",(function(){return qr}));var r,a=n("SAYH"),i=n("2cSh"),o=n("arV0"),s=n("y60j"),c=n("LbMF"),l=n("odYE"),u=n("bT7G"),d=n("WPtp"),p=n("5Oca"),g=n("iZ7K"),h=n("BvQu"),f=n("IqkD");!function(e){e[e.Active=0]="Active",e[e.Inactive=1]="Inactive"}(r||(r={}));var m=n("8nT0"),b=n("NjDY"),_=n("uNu9"),y=n("jRy5"),v=n("uzi5"),S=n("+nNZ"),O=n("dHD5"),C=n("eXjw"),E=n("r/9v"),I=n("Xd5/"),w=n("3hnk"),j=n("JP46"),P=n("sw/s"),T=n("2YQW"),N=n("P6DH"),A=n("YxC/"),D=n("X3qb"),R=n("3tOH"),x=n("504W"),M=n("g2Nw"),F=n("Z/4N"),k=n("9fGf"),L=n("455M"),B=n("BFlg"),U=n("WIoD"),V=n("S2mk"),z=n("VqBP"),W=n("JOgp"),q=n("3/02"),H=n("Lyxw"),G=n("hK10"),K=n("cfbi"),Q=n("dUiZ"),X=n("A09F"),Y=n("BMZr"),J=n("4leG"),$=n("eOoD"),Z=n("GYEz"),ee=n("EBJu"),te=n("69Qu"),ne=n("sZ+8"),re=n("iF9X"),ae=n("unFF"),ie=n("b8TU"),oe=n("PidC"),se=n("qFOq"),ce=n("0cBP"),le=n("D9jM"),ue=n("1fn7"),de=n("Y2Yg"),pe=n("qLnS"),ge=n("0kGT"),he=n("GL3b"),fe=n("+pAH"),me=n("9wSR"),be=n("O7zD"),_e=n("zmL5"),ye=n("jq7Z"),ve=n("CYtR"),Se=n("RVeV"),Oe=n("xHmU"),Ce=n("+zjj"),Ee=n("64CY"),Ie=n("hAdb"),we=n("fh2P"),je=n("4mtW"),Pe=n("lxuJ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Te="Forms.EditForm",Ne="activitypointer",Ae="regardingobjectid",De="QuickForms",Re="ref_pan",xe=[U.c,U.h],Me={Enabled_ContextTokenIsNull:{reason:"Control_Enabled_ContextTokenIsNull",disabled:!1},Enabled_GridRecordIsEditable:{reason:"Control_Enabled_GridRecordIsEditable",disabled:!1},Enabled_ClientAPI:{reason:"Control_Enabled_ClientAPI",disabled:!1},Enabled_FormDescriptor:{reason:"Control_Enabled_FormDescriptor",disabled:!1},Enabled_RecordIsActive:{reason:"Control_Enabled_RecordIsActive",disabled:!1},Disabled_ConfigFlag:{reason:"Control_Disabled_ConfigFlag",disabled:!0},Disabled_ClientAPI:{reason:"Control_Disabled_ClientAPI",disabled:!0},Disabled_GridRecordIsNotEditable:{reason:"Control_Disabled_GridRecordIsNotEditable",disabled:!0},Disabled_QuickViewFormAlwaysDisabled:{reason:"Control_Disabled_QuickViewFormAlwaysDisabled",disabled:!0},Disabled_IsUCIReadOnlyEntity:{reason:"Control_Disabled_IsUCIReadOnlyEntity",disabled:!0},Disabled_EntityNotAvailableInOffline:{reason:"Control_Disabled_EntityNotAvailableInOffline",disabled:!0},Disabled_NoRecordWritePermissions:{reason:"Control_Disabled_NoRecordWritePermissions",disabled:!0},Disabled_AttributeNotValidForCreate:{reason:"Control_Disabled_AttributeNotValidForCreate",disabled:!0},Disabled_AttributeNotValidForUpdate:{reason:"Control_Disabled_AttributeNotValidForUpdate",disabled:!0},Disabled_NoAssignPermissionsForOwnerField:{reason:"Control_Disabled_NoAssignPermissionsForOwnerField",disabled:!0},Disabled_NoWritePermissionsByFieldLevelSecurity:{reason:"Control_Disabled_NoWritePermissionsByFieldLevelSecurity",disabled:!0},Disabled_FormDescriptor:{reason:"Control_Disabled_FormDescriptor",disabled:!0},Disabled_RecordIsInactive:{reason:"Control_Disabled_RecordIsInactive",disabled:!0}};function Fe(e,t,n){const r=Object(ye.b)(e,t.id,n);return r?Object(s.j)(e,r):null}function ke(e,t,n){if(t&&t.id&&n&&n.parentContextToken){const r=Object(u.b)(e,ur(e,t.id,n.parentContextToken));if(r){const a=Rt(e,t,n.parentContextToken);if(a){const n=r.activeChanges?r.activeChanges[a.DataFieldName]:null;if(n){const r=Object(o.g)(e,t.id);if(r&&r.isOfflineSyncError&&n.validationResult&&n.validationResult.isOfflineSyncError)return!0}}}}return!1}function Le(e,t,n,r){const a=Object(O.v)(n),i=Object(ye.a)(e,t.id);return!!(i&&i.forms[a]&&i.forms[a].controls&&i.forms[a].controls[r]&&i.forms[a].controls[r].parameters&&i.forms[a].controls[r].parameters.QuickForms)}function Be(e,t,n){const r=[],a=Object(ye.a)(e,t.id),i=Object(o.g)(e,t.id);if(!a||!i)return r;const{formId:c}=a,{entityTypeName:d,id:h}=i,f=function(e,t,n,r){const a=Object(O.v)(r),i=Object(ye.a)(e,t);if(i&&i.metadata&&i.metadata[a]&&i.metadata[a].attributes){const t=i.metadata[a].attributes,r=Object(g.h)(e,n);if(t){const e={};for(const n of Object.keys(t)){const a=t[n];n===r.PrimaryIdAttribute||2!==a.RequiredLevel&&1!==a.RequiredLevel||(e[n]=a)}return e}}return null}(e,t.id,d,n),m=new l.a(d,h),b=m?m.etn:null;let _,y;const v=m?Object(p.e)(e,m):null;if(f){const a=Fe(e,t,n);if(a){const i=a.Controls;for(const o of Object.keys(f)){let l=!1;const d=[];if(i)for(const e in i)i[e].DataFieldName===o&&(l=!0,_=i[e].Name,d.push(i[e].Name));!l&&Ve(e,v,b,o)&&(l=!0),_||(_=o);const p=d.some(r=>!gn(e,{id:t.id,controlName:r},n)&&!Le(e,t,n,r));y=Object(s.b)(e,t.id,c,_);let g=!1;y&&a.HiddenFields&&(g=a.HiddenFields.findIndex(e=>e.Id===y.Id)>=0);const h=ur(e,t.id,n),f=Object(u.d)(e,h,m,o);l&&p&&!g&&Ue(f)&&r.push(o)}}}return r}function Ue(e){if(!e)return!0;if(Object(d.k)(e)){const t=e;return!t.reference||!t.reference.id}if(Object(d.h)(e))return!e.list||0===e.list.length;const t=Object(d.c)(e);return!t||""===t}function Ve(e,t,n,r){const a=v.b.concat(r);return null!=Object(S.d)(e,t,n,a)}function ze(e,t,n){var r,a;let i=[t];const o=null===(a=null===(r=Object(ye.a)(e,t))||void 0===r?void 0:r.formInstances)||void 0===a?void 0:a.list;o&&(i=i.concat(o));for(const t of i){Ur(e,t)&&(n=Object(O.j)(e,t));const r=lr(e,t,n);if(!r||!r.updatedFields)continue;const a=Object.keys(r.updatedFields),i=ur(e,t,n);if(0!==a.length&&i)for(const r in a){if(We(e,t,n,a[r]))return!0}}return!1}function We(e,t,n,r){const a=lr(e,t,n);if(!a||!a.updatedFields)return!1;if(an(e,t,n,r)===h.a.Never)return!1;const i=Object(_e.b)(e,t),o=Object(s.j)(e,i);if(null!=cr(e,t,r)&&o&&10!==o.FormType)return!1;const c=ur(e,t,n);if(!c)return!1;const l=Object(u.b)(e,c),p=l?l.activeChanges:null;let g;if(p&&p[r]&&(g=p[r]),!g)return!1;const f=a.updatedFields[r];if(Object(j.b)(f,g)){const e=Object(d.e)(g);if(null!==f||null!==e&&""!==e)return!0}}function qe(e,t,n){const r=Object(ye.b)(e,t.id,n);if(r){const t=Object(s.x)(e,r);if(t)for(const e of t)if(e&&e.Visible)return e}return null}function He(e,t,n,r){const a=Object(ye.b)(e,t,r);return a?Object(s.v)(e,a,n):null}function Ge(e,t,n,r){var a;const i=Object(ye.b)(e,t,r);if(i){const t=null===(a=Object(s.x)(e,i).find(e=>e.Name===n))||void 0===a?void 0:a.Id;return Object(s.v)(e,i,t)}return null}function Ke(e,t,n){const r=Object(ye.b)(e,t,n);return r?Object(s.w)(e,r):null}function Qe(e,t,n){if(n&&n.Id){const r=Object(s.v)(e,n.Id,t);return r?null===r.AvailableForPhone||void 0===r.AvailableForPhone||r.AvailableForPhone:null}return null}function Xe(e,t){return t&&t.startsWith(Re)}function Ye(e,t,n){const r=Object(ye.b)(e,t.id,n);return r?Object(s.a)(e,r,t.tabName,t.columnIndex):null}function Je(e,t,n){const r=Object(ye.b)(e,t.id,n);return r?Object(s.t)(e,r,t.sectionName):null}function $e(){let e=null;return function(t,n){const r=Ze(t,n,n.contextToken);return r&&e&&r.length===e.length&&e.every((e,t)=>r[t]&&e.Id===r[t].Id)||(e=r),e}}function Ze(e,t,n){const r=Object(ye.b)(e,t.id,n);if(r){const i=Object(s.e)(e,r,t.id);if(i){const r=new a.a("06e9f7af-1f54-4681-8eec-1e21a1ceb465");return i.filter(i=>{const o={controlName:i.Name,id:t.id},s=mt(e,o,n);return!a.a.equals(i.ClassId,r)&&!a.a.equals(i.ClassId,a.a.EMPTY)&&s})}}return null}function et(){let e=null;return function(t,n){const r=tt(t,n,n.contextToken);return r&&e&&r.length===e.length&&e.every((e,t)=>r[t]&&e.Id===r[t].Id)||(e=r),e}}function tt(e,t,n){const r=Object(ye.b)(e,t.id,n);if(r){const a=Object(s.c)(e,r,t.id);if(a)return a.filter(r=>{const a={controlName:r.Name,id:t.id};return mt(e,a,n)})}return null}function nt(e,t,n,r){const a=Xn(e,n,t,r);return a?a.label?a.label:Object(A.b)(e,D.a):null}function rt(e,t,n,r){var a;const i=Object(ye.b)(e,n,r);if(i){return null===(a=Object(s.x)(e,i).find(e=>e.Id===t))||void 0===a?void 0:a.Name}}function at(e,t,n,r){const a=Xn(e,n,t,r);return a?a.collapsed:null}function it(e,t,n,r){const a=Xn(e,n,t,r);return a?a.visible:null}function ot(e,t,n){if(Object(J.d)(e))return!0;let r=!1;const a=Et(e,t,n),i=Je(e,t,n);if(i&&i.Rows&&i.Rows.length>0)for(const e of i.Rows){if(e.Cells&&e.Cells.length>0)for(const t of e.Cells)if(t.ControlName&&a&&a[t.ControlName]){r=!0;break}if(r)break}return r}function st(e,t,n){const r=Object(ye.a)(e,t.id),a=Object(O.v)(n);return r&&r.records[a]?r.records[a].isDeleted:null}function ct(e,t,n){const r=Object(ye.a)(e,t.id);return r&&r.entityReferenceByRelationship&&r.entityReferenceByRelationship[n]?r.entityReferenceByRelationship[n]:null}function lt(e,t,n){const r=Object(ye.a)(e,t.id);return r&&r.entityReferenceByRelationship?r.entityReferenceByRelationship:null}function ut(e,t){const n=Object(ye.a)(e,t.id);return n&&n.referenceInformationByRelationship?n.referenceInformationByRelationship:null}function dt(e,t){const n=[],r=t.Tabs,a=Object(Z.e)(e);if(r)for(const i of r){(Qe(e,i.Id,t)||a!==$.a.Phone)&&n.push(i)}return n}function pt(){let e=[],t=[];return function(n,r){const a=r.Tabs;if(a!==t){const i=dt(n,r);e=i,t=a}return e}}function gt(e,t,n){const r=Object(ye.a)(e,t.id),a=Object(O.v)(n);return r&&r.forms&&r.forms[a]&&r.forms[a].sections&&r.forms[a].sections[t.sectionName]?r.forms[a].sections[t.sectionName].visible:null}function ht(e,t,n){const r=Object(ye.a)(e,t.id),a=Object(O.v)(n);return r&&r.forms&&r.forms[a]&&r.forms[a].sections&&r.forms[a].sections[t.sectionName]?r.forms[a].sections[t.sectionName].label:null}function ft(e,t,n){const r=Object(ye.a)(e,t.id),a=Object(O.v)(n);return r&&r.forms&&r.forms[a]&&r.forms[a].controls[t.controlName]?r.forms[a].controls[t.controlName]:null}function mt(e,t,n){if(n&&n.contextTokenType&&n.contextTokenType===y.a.GridRow)return!0;const r=ft(e,t,n);return r?r.visible:null}function bt(e,t){return vt(e,t)&&Object(o.f)(e,t)}function _t(e){const t=Object(Oe.b)(e);return t?t[t.length-1]:void 0}function yt(e,t){return Object(o.l)(e,t)===ee.a}function vt(e,t){return Object(o.l)(e,t)===K.a}function St(e,t,n){const r=Wr(e);if(!Object(J.a)(e)||r)return!1;let a=!1;const i=Object(ae.a)(e);if(i){const t=i.sizes.Breakpoints.DimensionS;a=window.innerWidth<=t||Object(ie.c)(e)<=t}const o=Lr(e,t,n);return!a||o}function Ot(e,t,n){const r=Object(o.g)(e,t);if(!r)return!1;const{entityTypeName:i,id:s}=r,c=new l.a(i,s),u=Object(p.e)(e,c);return!(!Object(we.b)(r)&&Object(we.a)(e,c,t))&&(!(a.a.isNullOrEmpty(u)||!Object(S.g)(e,a.a.toString(u)))&&mt(e,{id:t,controlName:"header_process"},n))}function Ct(){let e={};return function(t,n,r){const a=Et(t,n,r);return Object(T.e)(e,a)||(e=a),e}}function Et(e,t,n){const r={},i=new a.a("5c5600e0-1d6e-4205-a272-be80da87fd42"),s=tn(e,t,n);if(s){const c=Object.keys(s);for(const g of c){const c=s[g];if(c)if(a.a.equals(c.ClassId,i)){const a=mt(e,{controlName:g,id:t.id},n);if(null===a||a)if(Object(J.d)(e))r[g]=!0;else{const{entityTypeName:i,id:s}=Object(o.g)(e,t.id),h=c.DataFieldName?c.DataFieldName:null;if(h){const a=Object(u.d)(e,ur(e,t.id,n),new l.a(i),h);if(a){const e=!!Object(d.b)(a);r[g]=e}else{const t=!!Object(p.j)(e,new l.a(i,s),h);r[g]=t}}else r[g]=a}else r[g]=a}else{const a=mt(e,{controlName:g,id:t.id},n);null!=a&&(r[g]=a)}}}return r}function It(e,t,n){const r=ft(e,t,n);return r?r.label:null}function wt(e,t,n){const r=ft(e,t,n);return r&&r.parameters?r.parameters.Url:null}function jt(e,t,n){const r=ft(e,t,n);return!(!r||!r.parameters)&&r.parameters.isCustomSrc}function Pt(e,t,n){const r=ft(e,t,n);return r&&r.parameters?r.parameters.DisableMru:null}function Tt(e,t,n){const{entityTypeName:r,id:a}=Object(o.g)(e,t.id),i=ur(e,t.id,n),s=a?new l.a(r,a):new l.a(r),c=Object(u.d)(e,i,s,t.controlName);return Object(d.c)(c)}function Nt(e,t){const{entityTypeName:n,id:r}=Object(o.g)(e,t.id);return At(e,n,r)}function At(e,t,n){const r=Object(g.h)(e,t);if(r){const a=new l.a(t,n);let i=Object(p.j)(e,a,r.PrimaryNameAttribute);if(null==i){const n=Object(c.a)(e,t,r.PrimaryNameAttribute);if(null==n?void 0:n.AttributeOf){const r=n.AttributeOf,o=Object(c.a)(e,t,r);"lookup"===(null==o?void 0:o.Type)&&(i=Object(p.j)(e,a,r))}}return Object(d.c)(i)}return null}function Dt(e,t,n,r,a,i,o){if(Object(Ee.f)(i))return Object(W.a)(i,e,t,n,r,a);let s=Object(u.d)(e,r,a,i);if((function(e,t,n){const r=Object(c.f)(e,t.etn,"file");return Object(H.c)(e,q.Wb)&&Object(H.c)(e,q.nb)&&r&&r.hasOwnProperty(n)}(e,a,i)||function(e,t,n){const r=Object(c.f)(e,t.etn,"image");return Object(H.c)(e,q.Yb)&&Object(H.c)(e,q.nb)&&r&&r.hasOwnProperty(n)}(e,a,i))&&o){const e=o(Object(fe.c)(i,a,t,n));e&&(s=Object(p.l)(e,null==s?void 0:s.timestamp,null==s?void 0:s.validationResult))}if(Object(d.j)(s)){const r=t?Xt(e,t,n,a.etn,i):Object(c.a)(e,a.etn,i);if(!s.formatted||function(e){if("integer"===e.Type){const t=parseInt(e.Format,10);return t===Se.a.DURATION||t===Se.a.TIMEZONE||t===Se.a.LANGUAGE}return!1}(r)){const t=Object(I.z)(e,r),n=Object(A.e)(e,M.a);s.formatted=Object(I.x)(s.value,t,n)}}return s}function Rt(e,t,n){if(e&&t&&t.controlName){if(t.controlName.startsWith(v.b)){const n=Object(o.g)(e,t.id),r=n?new l.a(n.entityTypeName,n.id):null,a=r?r.etn:null,i=r?Object(p.e)(e,r):null;return Object(S.d)(e,i,a,t.controlName)}const r=Object(ye.b)(e,t.id,n);if(r)return Object(s.b)(e,t.id,r,t.controlName)}return null}function xt(e,t,n){var r,a,i,o;const s=Object(O.v)(n);return null===(o=null===(i=null===(a=null===(r=null==e?void 0:e.pages)||void 0===r?void 0:r[t])||void 0===a?void 0:a.forms)||void 0===i?void 0:i[s])||void 0===o?void 0:o.formScrollAndFocusState}function Mt(e,t,n){return Ft(e,t.id,n)}function Ft(e,t,n){const r=Object(ye.a)(e,t),a=Object(O.v)(n);return r&&r.forms&&r.forms[a]&&r.forms[a].selectedTab?r.forms[a].selectedTab.tabId:""}function kt(e,t,n,r){const a=Object(_e.b)(e,t),i=Object(s.b)(e,t,a,r),o=Ft(e,t,n);return!o||!(null==i?void 0:i.ParentTabId)||(null==i?void 0:i.ParentTabId)===o}function Lt(e,t,n){const r=Object(ye.a)(e,t),a=Object(O.v)(n);return r&&r.forms&&r.forms[a]&&r.forms[a].selectedTab?r.forms[a].selectedTab.navigationStack:null}function Bt(e,t,n){const r=yn(e,t,n);if(r&&r.selectedTab&&r.selectedTab.tabId){if("TaskBasedFlow"===Object(o.l)(e,t)){const a=Object(o.g)(e,t);if(a&&a.uniqueName){const i=Object(P.a)(e,a.uniqueName),o=rt(e,r.selectedTab.tabId,t,n);if(i&&i.defaultNextPageByTabName&&i.defaultNextPageByTabName.hasOwnProperty(o))return i.defaultNextPageByTabName[o]}}if(r.tabs){let a=!1;for(const i in r.tabs){if(a)return rt(e,i,t,n);a=i===r.selectedTab.tabId}}}return""}function Ut(e,t,n,r){return Vt(e,t,n.id,r)}function Vt(e,t,n,r){return!function(e,t){const n=zt(e,t);return n&&n.length>0}(e,r)&&!function(e,t){const n=Wt(e,t);return n&&n.length>0}(e,r)&&0===Object.keys(Be(t,{id:n},r)).length}function zt(e,t){const n=Object(O.v)(t);return e&&e.forms&&e.forms[n]&&e.forms[n]&&e.forms[n].invalidControls?Object.keys(e.forms[n].invalidControls):null}function Wt(e,t){const n=Object(O.v)(t);return e&&e.forms&&e.forms[n]&&e.forms[n]&&e.forms[n].invalidAttributes?Object.keys(e.forms[n].invalidAttributes):null}function qt(e,t,n){const r=Wt(Object(ye.a)(e,t),n),a=[];if(r){for(let i=0;i<r.length;i++){const o=nr(e,t,n,r[i]);for(let e=0;e<o.length;e++)a.push(o[e])}return a}return null}function Ht(e,t,n){const r=Object(ye.a)(e,t),a=ur(e,t,n),i=Object(u.b)(e,a),s=zt(r,n),l=qt(e,t,n),d=(null!=s?s:[]).concat(l),p={};return d.map(r=>{var a,s,l,u,d,g;const h=zr(Rt(e,{id:t,controlName:r},n),r);let f=It(e,{id:t,controlName:r},n);if(!f){const n=null===(a=Object(o.g)(e,t))||void 0===a?void 0:a.entityTypeName;f=(null===(s=Object(c.a)(e,n,h))||void 0===s?void 0:s.DisplayName)||r}if(h){let a;i&&(a=i.activeChanges?i.activeChanges[h]:i.lockedChanges?i.lockedChanges[h]:null);const o=mt(e,{controlName:r,id:t},n);if(a&&a.validationResult&&!a.validationResult.isValueValid){const e={label:f,errorMessage:a.validationResult.errorMessage};p.hasOwnProperty(h)&&!o||(p[h]=e)}else{const a=Kn(e,t,r,n),i=function(e,t,n,r){const a=yn(e,t,r).controls[n].dataFieldName,i=function(e,t,n){const r=Object(ye.a)(e,t);if(r&&r.metadata){const e=Object(O.v)(n);return r.metadata[e]}return null}(e,t,r);if(i&&i.attributes&&i.attributes[a])return i.attributes[a];return null}(e,t,r,n);if(null==a?void 0:a.notifications)for(const e in a.notifications)if(null===(u=null===(l=a.notifications[e])||void 0===l?void 0:l.messages)||void 0===u?void 0:u.length){const t={label:f,errorMessage:a.notifications[e].messages[0]};p.hasOwnProperty(h)&&!o||(p[h]=t)}if(null===(g=null===(d=null==i?void 0:i.notifications)||void 0===d?void 0:d.messages)||void 0===g?void 0:g.length){const e={label:f,errorMessage:i.notifications.messages[0]};p.hasOwnProperty(h)&&!o||(p[h]=e)}}}}),p}function Gt(e,t,n){const r=Object(O.v)(n);return e&&e.forms&&e.forms[r]&&e.forms[r].controls&&e.forms[r].controls[t]?e.forms[r].controls[t].parentSectionName:null}function Kt(e,t,n){const r=Object(O.v)(n);return e&&e.forms&&e.forms[r]&&e.forms[r].sections&&e.forms[r].sections[t]?e.forms[r].sections[t].parentTabId:null}function Qt(e,t,n,r,a){const i=Rt(e,{id:r,controlName:n},a);if(!i)return null;const o=i.DataFieldName;let s;if(t)s=Object(c.a)(e,t,o);else{const t=sr(e,r);t&&(s=t[o])}const l=Object(ye.a)(e,r),u=Object(O.v)(a);if(l&&l.metadata&&l.metadata[u]&&l.metadata[u].attributes){const e=l.metadata[u].attributes[o];if(!s)return Object.assign({},e);if(s.OptionSet){const t=[...s.OptionSet];return Object.assign(Object.assign({},s),Object.assign(Object.assign({},e),{OptionSet:t}))}return Object.assign(Object.assign({},s),e)}return s}function Xt(e,t,n,r,i){if(n&&n.contextTokenType&&n.contextTokenType===y.a.GridRow)return function(e,t,n,r,a){const i=Object(c.a)(e,r,a),o=Yt(e,r,a);if(!o)return i;return o.RequiredLevel=Object(N.M)(e,t,n,a),Object.assign(Object.assign({},i),o)}(e,t,n,r,i);let o;o=n&&n.contextTokenType===y.a.RelatedEntity?Object(O.v)(n):Object(O.x)(n);const s=Object(ye.a)(e,t);let l=null;s&&s.metadata&&s.metadata[o]&&s.metadata[o].attributes&&s.metadata[o].attributes[i]&&(l=s.metadata[o].attributes[i]);let u=Object(c.a)(e,r,i);if(!u){const n=Object(_e.b)(e,t);if(!a.a.isNullOrEmpty(n)){const t=Object(c.k)(e,n.guid);t&&(u=t[i])}}return l?Object.assign(Object.assign({},u),l):u}function Yt(e,t,n){let r=null;const i=Object(c.a)(e,t,n);if(i){const n="regarding"===i.Format;let o=i.Targets;if(n&&(!o||0===o.length)&&a.a.validate(t)){o=function(e){const t=Object(c.d)(e,Ne);if(!t)return null;if(t.hasOwnProperty(Ae)&&t[Ae]&&t[Ae].Targets)return t[Ae].Targets;return null}(e)||o}r={Precision:Jt(e,i),PrecisionSource:i.PrecisionSource,RequiredLevel:i.RequiredLevel,Format:i.Format,OptionSet:i.OptionSet,IsValidForCreate:i.IsValidForCreate,IsValidForUpdate:i.IsValidForUpdate,Targets:o}}return r}function Jt(e,t){if(!t)return 2;if("integer"===t.Type)return 0;let n;switch(t.PrecisionSource){case void 0:case 0:n=t.Precision;break;case 1:const r=Object(b.x)(e);r&&(n=r.pricingDecimalPrecision);break;case 2:n=Object(I.c)(Object(f.w)(e))}return(null==n||n<0)&&(n=2),n}function $t(e,t,n,r){const a=Kn(e,t,n,r);return a&&a.parameters&&a.parameters.ViewId?a.parameters.ViewId:null}function Zt(e,t){const n=Object(o.g)(e,t.id);return n?n.recordSetQueryKey:null}function en(e,t){const n=Object(o.g)(e,t.id);return n&&n.id?n.id:null}function tn(e,t,n){const r=t.id,a=Object(ye.b)(e,r,n);return a?Object(s.f)(e,r,a,t.sectionName):null}function nn(e,t){return Object(ye.a)(e,t)}function rn(e,t,n,r){if(n&&n.contextTokenType&&n.contextTokenType===y.a.GridRow)return Object(N.M)(e,t,n,r);const a=nn(e,t),i=Object(O.v)(n);let o;return a&&a.metadata[i]&&a.metadata[i].attributes[r]&&(o=a.metadata[i].attributes[r].RequiredLevel),null!=o?o:0}function an(e,t,n,r){const a=nn(e,t),i=Object(O.x)(n);let o;return a&&a.metadata[i]&&a.metadata[i].submitModes[r]&&(o=a.metadata[i].submitModes[r]),null!=o?o:h.a.Dirty}function on(e,t,n,r){const a=Object(ye.a)(e,t),i=Object(O.v)(r);if(a&&a.forms&&a.forms[i]&&a.forms[i].controls[n]&&a.forms[i].controls[n].parameters&&a.forms[i].controls[n].parameters.hasOwnProperty("defaultviewid"))return a.forms[i].controls[n].parameters.defaultviewid}function sn(){let e=null,t=null;const n=cn();return function(r,a){const i=n(r,a);return i&&e!==i&&(e=i,t=Object.keys(i)),t}}function cn(){let e=null;const t=new Map;return function(n,r){var a,i;const o=Object(ye.a)(n,r),s=null===(i=null===(a=Object(ye.a)(n,r))||void 0===a?void 0:a.formInstances)||void 0===i?void 0:i.list;let c=!1;if((null==o?void 0:o.notifications)!==t.get(r)&&(t.set(r,null==o?void 0:o.notifications),c=!0),!c&&s)for(const e of s){const r=Object(ye.a)(n,e);(null==r?void 0:r.notifications)!==t.get(e)&&(t.set(e,null==r?void 0:r.notifications),c=!0)}if(c){e={},(null==o?void 0:o.notifications)&&(e=Object.assign(Object.assign({},e),o.notifications));for(const t of s){const r=Object(ye.a)(n,t);(null==r?void 0:r.notifications)&&(e=Object.assign(Object.assign({},e),null==r?void 0:r.notifications))}}return e}}function ln(e,t){var n,r;const a=Object(ye.a)(e,t),i=null===(r=null===(n=Object(ye.a)(e,t))||void 0===n?void 0:n.formInstances)||void 0===r?void 0:r.list;let o={};if((null==a?void 0:a.notifications)&&(o=Object.assign(Object.assign({},o),a.notifications)),i)for(const t of i){const n=Object(ye.a)(e,t);(null==n?void 0:n.notifications)&&(o=Object.assign(Object.assign({},o),null==n?void 0:n.notifications))}return o}function un(e,t,n){if(n&&n.contextTokenType&&n.contextTokenType===y.a.GridRow)return Object(N.L)(e,t.id,n,t.controlName);const r=Object(ye.a)(e,t.id);let a;if(a=n&&n.contextTokenType===y.a.RelatedEntity?Object(O.v)(n.parentContextToken):Object(O.v)(n),r&&r.forms&&r.forms[a]&&r.forms[a].controls){const e=r.forms[a].controls[t.controlName];return e?e.notifications:null}return null}function dn(e,t,n){const r=Object(ye.b)(e,t.id,n),a=Object(s.b)(e,t.id,r,t.controlName);if(a&&a.Url)return a.Url;if(a&&a.Parameters){const e="Url";return a.Parameters[e]}}function pn(e,t,n){if(!n)return!1;if(!Object(Ie.d)(e,"DisableWebResourceControls"))return!1;const r=Rt(e,t,n);return xe.some(e=>a.a.equals(e,null==r?void 0:r.ClassId))}function gn(e,t,n){const r=hn(e,t,n);return null==r?void 0:r.disabled}function hn(e,t,n){if(!n)return Me.Enabled_ContextTokenIsNull;if(n&&n.contextTokenType&&n.contextTokenType===y.a.GridRow)return Object(N.K)(e,t.id,n,t.controlName)?Me.Enabled_GridRecordIsEditable:Me.Disabled_GridRecordIsNotEditable;if(pn(e,t,n))return Me.Disabled_ConfigFlag;if(fn(e,t.id,n))return Me.Disabled_QuickViewFormAlwaysDisabled;if(Object(w.c)(e,n.entityTypeName))return Me.Disabled_IsUCIReadOnlyEntity;const r=Object(o.k)(e,t);if(!Object(te.b)(e)&&(!Object(re.a)(e)||"dialog"!==r&&!Object(ne.l)(e,n.entityTypeName)))return Me.Disabled_EntityNotAvailableInOffline;if(!bn(e,n.entityTypeName,t.id))return Me.Disabled_NoRecordWritePermissions;const a=yn(e,t.id,n),i=a&&a.controls&&a.controls[t.controlName]?a.controls[t.controlName]:null;if(!i)return;if(i.dataFieldName){const r=Object(c.a)(e,n.entityTypeName,i.dataFieldName);if(r){const a=Object(o.m)(e,t.id);if(a&&!r.IsValidForCreate)return Me.Disabled_AttributeNotValidForCreate;if(!a&&!r.IsValidForUpdate)return Me.Disabled_AttributeNotValidForUpdate;if("owner"===r.Type&&!function(e,t,n){return mn(e,t,n,5)}(e,n.entityTypeName,t.id))return Me.Disabled_NoAssignPermissionsForOwnerField}}const l=Object(o.g)(e,t.id);if(!(!i.dataFieldName||Pr(e,n.entityTypeName,null==l?void 0:l.id,t.id,i.dataFieldName)))return Me.Disabled_NoWritePermissionsByFieldLevelSecurity;if(void 0!==i.disabledByClientApi&&null!==i.disabledByClientApi)return i.disabledByClientApi?Me.Disabled_ClientAPI:Me.Enabled_ClientAPI;const u=Object(_e.b)(e,t.id),d=Object(s.b)(e,t.id,u,t.controlName),p=d&&d.Disabled,g=Object(s.j)(e,u);if(g&&10===g.FormType)return p?Me.Disabled_FormDescriptor:Me.Enabled_FormDescriptor;if(p)return Me.Disabled_FormDescriptor;return!!l&&Tn(e,n.entityTypeName,l.id)?Me.Disabled_RecordIsInactive:Me.Enabled_RecordIsActive}function fn(e,t,n){const r=n&&n.controlName?n.controlName:null;if(r){const a=Object(ye.b)(e,t,n),i=yn(e,t,n.parentContextToken),o=i?i.inlineQuickForms[r]:null;return a===(o?o[n.entityTypeName]:"")}return!1}function mn(e,t,n,r){let a=!0;return Object(o.m)(e,n)||(a=Object(w.g)(e,t,r,0)),a}function bn(e,t,n){let r=!0;const i=Object(o.g)(e,n);i&&(r=Object(w.h)(e,t,a.a.toString(i.id),de.a.WriteAccess));return mn(e,t,n,3)&&r}function _n(e,t,n){const r=Object(ye.a)(e,t.id),a=Object(O.v)(n);if(r&&r.forms&&r.forms[a]&&r.forms[a].controls[t.controlName]){const e="Url";return r.forms[a].controls[t.controlName].parameters[e]}}function yn(e,t,n){const r=Object(ye.a)(e,t);if(r&&r.forms){const e=Object(O.v)(n);return r.forms[e]}return null}function vn(e,t,n){const r=nn(e,t),a=Object(O.v)(n);return r&&r.metadata&&r.metadata[a]&&r.metadata[a].attributes?r.metadata[a].attributes:null}function Sn(e,t,n){const r=vn(e,t,n);if(!r)return[];const a=Object(ye.b)(e,t,n),i=Object(s.e)(e,a,t),o=new Set(i?i.map(e=>e.Name):[]),c=[],l=Object.keys(r);for(const r of l){const a=nr(e,t,n,r);a&&0!==a.length?a.some(r=>{if(!o.has(r))return!0;const a=Rt(e,{controlName:r,id:t},n);return!!Mr(e,t,a,n)})&&c.push(r):c.push(r)}return c}function On(e,t,n,r){var a;return null===(a=Cn(e,t,n,r))||void 0===a?void 0:a.label}function Cn(e,t,n,r){const a=Object(ye.a)(e,t);if(a&&a.navigation&&a.navigation.navBarByRelationshipItems[n]&&a.navigation.navBarByRelationshipItems[n].titles){const t=Object(f.s)(e),i=Object(b.x)(e),o=i&&i.languageCode,s=Object(G.b)(a.navigation.navBarByRelationshipItems[n],t);if(s)return{label:s.Value,labelSource:Ce.b.FormDescriptorForCurrentUserLanguage};if(r)return{label:r,labelSource:Ce.b.EntityDisplayCollectionName};const c=Object(G.b)(a.navigation.navBarByRelationshipItems[n],o);if(c)return{label:c.Value,labelSource:Ce.b.FormDescriptorForBaseLanguage};const l=Object(G.b)(a.navigation.navBarByRelationshipItems[n],1033);if(l)return{label:l.Value,labelSource:Ce.b.FormDescriptorForEnglish}}return null}function En(e,t,n){var r,a;const i=Object(ye.a)(e,t);return null===(a=null===(r=null==i?void 0:i.navigation)||void 0===r?void 0:r.navBarByRelationshipItems)||void 0===a?void 0:a[n]}function In(e,t,n){const r=En(e,t,n);return null==r?void 0:r.show}function wn(e,t,n){const r=nn(e,t),a=Object(O.x)(n);return r&&r.metadata[a]&&r.metadata[a].submitModes?r.metadata[a].submitModes:null}function jn(e,t){if(t.id){const n="statecode",r=Object(o.g)(e,t.id);if(r){const t=r.id?new l.a(r.entityTypeName,r.id):new l.a(r.entityTypeName);return Object(p.j)(e,t,n)}}return null}function Pn(e,t){if(t.id){const n="statuscode",r=Object(o.g)(e,t.id);if(r){const t=r.id?new l.a(r.entityTypeName,r.id):new l.a(r.entityTypeName);return Object(p.j)(e,t,n)}}return null}function Tn(e,t,n){const a=n?new l.a(t,n):new l.a(t),i=Object(p.j)(e,a,"statecode"),o=Object(d.d)(i);if(t===_.Wb){const t=Object(p.j)(e,a,"isdisabled");return!!(!Object(x.a)(t)&&"1"===t.valueString)&&"1"===Object(d.d)(t)}if(i){let n=function(e,t,n,r){switch(t){case _.eb:const a=Object(p.j)(e,n,"majorversionnumber"),i=Object(p.j)(e,n,"minorversionnumber");if(null!=a&&null!=i&&0===a.value&&0===i.value)return!0;if("2"===r||"3"===r){const t="7c538e3d-8e82-4f73-922e-471472954c52",n=Object(f.u)(e)[t];return null==n}return"5"===r||"6"===r;case _.e:case _.Gb:return!("0"===r||"3"===r);case _.wb:return"1"===r;case _.xb:return!("2"===r);case _.I:return"0"===r||"2"===r;case _.Nb:return!("0"===r||"3"===r);case _.c:return"0"===r;case _.Kb:const o=Object(b.x)(e);if(!Object(x.a)(o)&&!Object(x.a)(o.isSOPIntegrationEnabled)&&!o.isSOPIntegrationEnabled&&"1"===r)return!1;default:if(e&&e.metadata&&t&&e.metadata.entities&&e.metadata.entities[t]&&e.metadata.entities[t].hasOwnProperty("IsActivity")&&e.metadata.entities[t].IsActivity)return!("0"===r||"3"===r)}return}(e,t,a,o);return void 0===n&&(n=o!==String(r.Active)),n}return!1}function Nn(e,t,n){const r=jn(e,{id:t});if(r)return Object(d.c)(r);let a="";const i=Object(o.g)(e,t),s=i&&i.entityTypeName,c=Object(ce.c)(e,s);return s&&null!=c&&c>-1&&(a=Object(le.b)(e,s,m.u,c)),a||(a=Object(A.c)(n,ue.a)),a}function An(e,t,n){const r=Object(ye.a)(e,t.id),a=Object(O.v)(n);return!!(r&&r.forms&&r.forms[a])&&r.forms[a].isSaving}function Dn(e,t){return Object(_e.a)(e,t).some(t=>{const n=Object(O.j)(e,t);return An(e,{id:t},n)})}function Rn(e,t,n){const r=Object(ye.a)(e,t.id),a=Object(O.v)(n);return!!(r&&r.forms&&r.forms[a])&&r.forms[a].isAutoSaving}function xn(e,t){return Object(_e.a)(e,t).some(t=>{const n=Object(O.j)(e,t);return Rn(e,{id:t},n)})}function Mn(e,t,n){const r=Object(ye.a)(e,t.id),a=Object(O.v)(n);return r&&r.forms&&r.forms[a]?r.forms[a].viewportWidth:null}function Fn(e,t,n){const r=Object(ye.a)(e,t.id),a=Object(O.v)(n);return r&&r.forms&&r.forms[a]?r.forms[a].viewportHeight:null}function kn(e,t,n){const r=Object(ye.a)(e,t.id),a=Object(O.v)(n);return r&&r.forms&&r.forms[a]?r.forms[a].showHeaderFieldsInSection:null}function Ln(e,t,n){const r=Object(ye.a)(e,t),a=Object(O.v)(n);if(r&&r.forms&&r.forms[a]){return r.forms[a].headerFieldsInFlyout}return null}function Bn(e,t,n,r,a){for(const i of a){const a=Rt(e,{id:n,controlName:i},t),o=gn(e,{id:n,controlName:i},t),s=mt(e,{controlName:i,id:n},t),c=Un(e,{controlName:i,id:n},t),l=s&&c,u=Le(e,{id:n},t,i);if(zr(a,i)===r&&!o&&l&&!u)return i}}function Un(e,t,n){const{parentSectionName:r}=Kn(e,t.id,t.controlName,n);let a;const i=Qn(e,t.id,r,n);let o=!1,s=!1;return i&&(a=i.parentTabId,s=it(e,a,t.id,n),o=i.visible),o&&s}function Vn(e,t,n){const r=Object(ye.a)(e,t.id),a=Object(O.v)(n);return!!(r&&r.forms&&r.forms[a])&&r.forms[a].hasOfflineChanges}function zn(e,t,n){const r=t.id;return!!Object(o.g)(e,r)&&Wn(e,t,n)!==se.a.NotReadOnly}function Wn(e,t,n){const r=t.id,a=Object(o.g)(e,r);if(!a||!n)return se.a.NotReadOnly;const i=n.entityTypeName,s=a.id;return Object(w.c)(e,i)?se.a.EntityPermissions:bn(e,i,r)?Tn(e,i,s)?se.a.RecordStatus:Object(te.b)(e)||Object(re.a)(e)&&Object(ne.l)(e,i)?se.a.NotReadOnly:se.a.Offline:se.a.RecordPermissions}function qn(e,t,n){if(n){const r=Wn(e,{id:t},n);return r!==se.a.NotReadOnly&&r!==se.a.RecordStatus}return!1}function Hn(e,t,n){const r=Object(o.g)(e,t);if(r&&Tn(e,r.entityTypeName,r.id))return 4;if(r&&r.entityTypeName&&!Object(w.g)(e,r.entityTypeName,a.a.isNullOrEmpty(r.id)?1:3,0))return 3;switch(Object(o.l)(e,t)){case K.a:case K.b:return a.a.isNullOrEmpty(r&&r.id)?1:2;case"QuickCreateForm":return 1;case"Dialog":return 12;case"TaskBasedFlow":return 5;default:return 0}}function Gn(e,t){const n=Object(ye.a)(e,t);return!(!n||!n.suppressDuplicateDetection)&&n.suppressDuplicateDetection}function Kn(e,t,n,r){const a=yn(e,t,r);return a&&a.controls&&a.controls[n]?a.controls[n]:null}function Qn(e,t,n,r){const a=yn(e,t,r);return a&&a.sections&&a.sections[n]?a.sections[n]:null}function Xn(e,t,n,r){const a=yn(e,t,r);return a&&a.tabs&&n?a.tabs[n]:null}function Yn(e,t,n,r){const a=Kn(e,t,n,r);if(a){const n=Qn(e,t,a.parentSectionName,r);if(n){const a=Xn(e,t,n.parentTabId,r),i={id:t};return a&&n.parentTabId===Mt(e,i,r)&&!1===a.collapsed?null:n.parentTabId}}return null}function Jn(e,t,n,r){if(n&&n.contextTokenType&&n.contextTokenType===y.a.GridRow){const t=Object(c.a)(e,n.entityTypeName,r);return t?t.Precision:null}const a=ur(e,t,n),i=Object(o.g)(e,t),s=new l.a(i.entityTypeName,i.id),d=Object(u.d)(e,a,s,"transactioncurrencyid"),p=Object(I.z)(e,Xt(e,t,n,s.etn,r),d);return Object(I.B)(p)}function $n(e,t){const{entityTypeName:n,id:r}=Object(o.g)(e,t.id),a=r?new l.a(n,r):new l.a(n),i=Object(p.j)(e,a,Object(be.a)(null,e,n));return i?Object(d.c)(i):null}function Zn(e,t){const{entityTypeName:n,id:r}=Object(o.g)(e,t.id);if(!n)return null;const a=Object(E.a)(n);if(a){const t=r?new l.a(n,r):new l.a(n),i=Object(p.j)(e,t,a);if(i)return Object(d.c)(i)}return null}function er(e,t,n){return t&&n?document.getElementById(n):null}function tr(e,t,n,r){const a=Object(g.h)(e,null==t?void 0:t.entityTypeName);if(a){const t=Rt(e,{id:n,controlName:a.PrimaryNameAttribute},r);if(t)return t.DomId}return null}function nr(e,t,n,r,a){const i=yn(e,t,n);if(i&&i.controls){const e=e=>!a&&!e||a===e,t=[];for(const n in i.controls)i.controls[n].dataFieldName===r&&e(i.controls[n].relationship)&&t.push(n);return t}return null}function rr(e,t,n,r){const a=Rt(e,{id:t,controlName:r},n);if(!a)return null;const i=a.DataFieldName,o=nn(e,t),s=Object(O.x)(n);if(o&&o.metadata[s]&&o.metadata[s].attributes[i]){if(o.metadata[s].attributes[i].OptionSet)return o.metadata[s].attributes[i].OptionSet;if(n&&n.entityTypeName){const t=Object(c.a)(e,n.entityTypeName,i);if(t&&"integer"===t.Type&&t.Format===3..toString()){const t=[],n=Object(b.g)(e);if(n)return Object.keys(n).forEach(e=>{const r=parseInt(e,10);r>0&&t.push({Value:r,Label:n[r]})}),t}}}return null}function ar(e,t,n,r,a){var i;let s;if(n&&n.contextTokenType===y.a.RelatedEntity){const r=ut(e,{id:t}),a=r[n.relationshipName]&&r[n.relationshipName].referencedEntity;a&&(s=a)}else s=n?n.entityTypeName:void 0;r=function(e,t,n,r){if(!Object(x.a)(r)&&"email"===r&&"from"===n){const a=Object(o.g)(e,t),i=null==a?void 0:a.id;if(!Object(x.a)(i)){const t=new l.a(r,i),a=Object(p.j)(e,t,m.v);(null==a?void 0:a.valueString)&&"4"===(null==a?void 0:a.valueString)&&(n="to")}}return n}(e,t,r,s);const u=a?Object(c.a)(e,s,r):Xt(e,t,n,s,r);if(!u)return null;const d=u.Targets.filter(t=>{const n=Object(g.h)(e,t);return(null==n?void 0:n.Initialized)!==C.a.Initialized||Object(w.g)(e,t,2,0)});return"partylist"===u.Type&&(null===(i=Object(b.x)(e))||void 0===i?void 0:i.allowUnresolvedPartiesOnEmailSend)&&d.push("unresolvedaddress"),d}function ir(e,t,n,r){return ar(e,t,n,r,!1)}function or(e,t,n,r){return ar(e,t,n,r,!0)}function sr(e,t){const n=Object(_e.b)(e,t);return Object(c.k)(e,a.a.toString(n))}function cr(e,t,n){const r=sr(e,t);if(r){const e=r[n];if(e)return e}return null}function lr(e,t,n){const r=Object(ye.a)(e,t),a=Object(O.v)(n);if(r&&r.records)return r.records[a]}function ur(e,t,n){const r=lr(e,t,n);if(r)return r.snapshotId}function dr(e,t,n){const r=lr(e,t,n);return r&&null!=r.updatedFields?Object.keys(r.updatedFields):[]}function pr(e,t,n){const r=yn(e,t,n);return r?r.label:""}function gr(e,t,n,r){return r.length>0?r+(e?t?": "+t:"":n.length>0?": "+n:""):e&&t||n}function hr(e,t,n){const r=yn(e,t,n);return r?r.inlineQuickForms:null}function fr(e,t,n){const r=Object(o.g)(e,t);if(!(r&&n&&n.controlName&&n.entityTypeName&&n.parentContextToken))return!1;const a=new l.a(r.entityTypeName,r.id),i=ur(e,t,n.parentContextToken),c=Kn(e,t,n.controlName,n.parentContextToken),d=c?c.dataFieldName:null,g=Object(u.d)(e,i,a,d);if(!g||!g.reference)return!1;const h=Object(p.b)(g.reference)(e),f=yn(e,t,n),m=Object(_e.b)(e,t),b=Object(s.j)(e,m);return f&&h&&h.initialized===C.a.Initialized&&br(n.controlName,b,g.reference.etn)}function mr(e,t,n){const r=Object(o.g)(e,t);if(!r)return!1;const a=new l.a(r.entityTypeName,r.id),i=Object(p.b)(a)(e);return yn(e,t,n)&&i&&i.initialized===C.a.Initialized}function br(e,t,n){return t&&t.InlineQuickForms&&t.InlineQuickForms[e]&&t.InlineQuickForms[e][n]&&t.InlineQuickForms[e][n]!==a.a.EMPTY}function _r(e,...t){return vr(e?"Forms.MainFormDialog":"Forms.EditForm",t)}function yr(e,...t){return vr(e?"Forms.MainFormDialog":Te,t)}function vr(e,t){return t&&0!==t.length?e.concat(".",t.join(".")):e}function Sr(e,t){const n=function(e,t){const n=Object(o.g)(e,t.id);return n?Object(p.n)(e,n.recordSetQueryKey):null}(e,t);return n&&n.records?n.records.length:null}function Or(e,t,n,r){const a=Object(o.g)(e,t),i=ur(e,t,n),s=Object(u.d)(e,i,{etn:a.entityTypeName,id:a.id},name);if(s&&s.validationResult&&!s.validationResult.isValueValid)return!0;const c=un(e,{controlName:r,id:t},n);return c&&Object.keys(c).some(e=>{if(c[e].notificationLevel===R.a.error)return!0})}function Cr(e,t,n,r=!1,a=s.d){const i={},o=a(e,n,t);if(o)for(const a in o){const i=o[a],l=Er(),u=Object(s.j)(e,n);if(u){const a=l(e,i,t,n,u.EntityLogicalName,r);if(a&&(c(a),a.Children))for(const e in a.Children){c(a.Children[e])}}}return i;function c(t){let n=t.CustomControlId,r=n&&Object(F.e)(e,n);r&&(i[r.CustomControlId]=r),n=Object(V.z)(t),r=n&&Object(F.e)(e,n),r&&(i[r.CustomControlId]=r,function(t,n){if(t===ve.c){if(!n[ve.b]){const t=Object(F.e)(e,ve.b);t&&(n[ve.b]=t)}if(!n[ve.h]){const t=Object(F.e)(e,ve.h);t&&(n[ve.h]=t)}}}(r.CustomControlId,i))}}function Er(){let e=null,t=null,n=null,r=0,i=!1;const s=function(){let e,t;return(n,r)=>(n!==e&&(e=n,t=Object(V.F)(n,r)),t)}();return(c,d,p,g,h,f=!1,m)=>{var y,v,S,C;const E=Object(k.b)(c);let I=null,w=null,j=null;d&&d.UniqueId&&g&&(I=Object(F.f)(c,p,d.UniqueId,g),w=I||Object(F.b)(c,d.UniqueId,g),j=null===(y=null==w?void 0:w.CustomControls)||void 0===y?void 0:y[E]);let P=d&&d.ClassId&&d.ClassId.guid?d.ClassId.guid:null;(function(e,t,n){const r=Object(o.g)(e,n);if(Object(x.a)(r))return!1;return("appointment"===r.entityTypeName||"recurringappointmentmaster"===r.entityTypeName)&&"description"===t.Name&&Object(b.x)(e).appointmentRichEditorExperience})(c,d,p)&&(P="6f3fb987-393b-4d2d-859f-9d0f0349b6ad"),Object(H.c)(c,q.jd)&&(null==j?void 0:j.Name)===ve.a&&(j=Object(je.a)(j,h||(null===(v=Object(o.g)(c,p))||void 0===v?void 0:v.entityTypeName))),Object(H.c)(c,q.ld)&&(null==j?void 0:j.Name)===ve.e&&(j=Object(je.b)(j,h||(null===(S=Object(o.g)(c,p))||void 0===S?void 0:S.entityTypeName)));const T=Object(o.g)(c,p),A=h||(T?T.entityTypeName:null);if(Object(je.e)(c,j,d,p)&&(null==j?void 0:j.Name)!==ve.e&&(j=Object(je.c)(j)),Object(H.c)(c,q.y)){const t=d.Parameters;if(g&&P&&t&&t.VisualizationId&&t.ChartGridMode){const s=a.a.tryParse(t.VisualizationId);if(!a.a.isNullOrEmpty(s)&&"Chart"===t.ChartGridMode){if(!m){const e=Object(O.j)(c,p);m=Object(O.p)(e,d.Name)}const a=Object(N.N)(c,p,m);if(!e||r!==a||n&&(n.TargetEntityType!==t.TargetEntityType||n.ViewId!==t.ViewId||n.RelationshipName!==t.RelationshipName||n.EnableViewPicker!==t.EnableViewPicker||n.ViewIds!==t.ViewIds||n.EnableChartPicker!==t.EnableChartPicker||n.IsUserView!==t.IsUserView||n.IsUserChart!==t.IsUserChart||n.VisualizationId!==t.VisualizationId)){const s=Ir(c,p,d),l=Object(o.m)(c,p),u=t.RelationshipName,g=!s||(l||i)&&u?1:2;e=Object(V.s)(t,g,a),e.FormFactor=E,n=t,r=a,i=l}return e}}}if(P&&d&&d.Parameters&&"powerBITile"===L.a.ClassIdControlMap[P.toLowerCase()]&&Object(H.c)(c,q.Wc)){const e=d.Parameters;return Object(V.k)(e,E,d.Name)}let D=!1;if(d&&d.UniqueId&&g){if(I=Object(F.f)(c,p,d.UniqueId,g),w=I||Object(F.b)(c,d.UniqueId,g),j=null===(C=null==w?void 0:w.CustomControls)||void 0===C?void 0:C[E],j&&!Object(N.xb)(c,j,E)){const t=[ve.d];if(d.DataFieldName&&-1===t.indexOf(j.Name)){const t=Object(F.e)(c,j.Name);return t&&(e=s(j,t)),e}return w.CustomControls[E]}D=!0}const R=d.Parameters;if(g&&P&&(L.a.ClassIdControlMap[P.toLowerCase()]===B.t||"referencepanelsubgrid"===L.a.ClassIdControlMap[P.toLowerCase()]||D&&P.toLowerCase()===U.a.guid.toLowerCase()&&null!=R.ViewId&&null!=R.TargetEntityType)){let n=null;if(c&&e){const t=Object(N.ab)(c,e.CustomControlId);if(t){const r=e.Parameters[t];n=r&&r.ViewId}}if(!e||t&&(t.ViewId!==R.ViewId||t.TargetEntityType!==R.TargetEntityType||t.EnableViewPicker!==R.EnableViewPicker||t.RelationshipName!==R.RelationshipName||n&&n.replace(/[\{\}]/gi,"")!==R.ViewId.replace(/[\{\}]/gi,""))){if(f){const e=a.a.tryParse(d.Parameters.VisualizationId);if(!a.a.isNullOrEmpty(e)&&"Chart"===d.Parameters.ChartGridMode)return{CustomControlId:"MscrmControls.Chart.ChartControl"}}if(e=Object(V.x)(d.Id,R),e.FormFactor=E,t=R,L.a.ClassIdControlMap[P.toLowerCase()]===B.t){const t=Object(N.ab)(c,e.CustomControlId);if(t){const n=Ir(c,p,d);e=Object.assign(Object.assign({},e),{Parameters:Object.assign(Object.assign({},e.Parameters),{[t]:Object.assign(Object.assign({},e.Parameters[t]),n?{FirstDataRequestType:1}:null)})})}}}return e}const M=Object(z.b)(c,A,d),W={};if(M===L.a.QuickForm||M===L.a.Card){W.quickFormId=function(e,t,n,r,i){if(t.Parameters.hasOwnProperty(De)&&r){const o=new l.a(r.entityTypeName,a.a.isNullOrEmpty(r.id)?a.a.EMPTY:r.id),s=ur(e,n,i),c=Object(u.d)(e,s,o,t.DataFieldName),d=c?c.reference:null;if(Object(J.d)(e)){const r=hr(e,n,i);if(r){const e=r[t.Id];if(e){const t=Object.keys(e);if(t&&t.length>0){const n=t[0];return a.a.toString(e[n])}}}return a.a.toString(a.a.EMPTY)}if(d){const r=hr(e,n,i);if(r){const e=d.etn,n=r[t.Id][e];return a.a.isNullOrEmpty(n)?a.a.toString(a.a.EMPTY):a.a.toString(n)}}}return a.a.toString(a.a.EMPTY)}(c,d,p,T,Object(O.j)(c,p));const e=Ir(c,p,d),t=Object(o.m)(c,p),n=e&&!t?2:1;W.chartDataRequestType=n}if(f&&d.Parameters&&d.Parameters[0]&&d.Parameters[0].StreamObjects)return{Children:{stream:{CustomControlId:"MscrmControls.Grid.ReadOnlyGrid"},tile:{CustomControlId:"MscrmControls.KPICard.KPICardControl"}}};const G=Object(V.r)(d.Name,d.DataFieldName,M,A,P,d,W)||Object(V.r)(d.Id,d.DataFieldName,M,A,P,d,W);if(G!==e){if(G.Parameters&&G.Parameters.value){const e=G.Parameters.value;G.Parameters.value=Object(V.f)(e,d)}const t=Object(V.g)(G,P);null!==t&&Object.assign(G.Parameters,t),e=G,P&&(Object(Pe.a)("{6F3FB987-393B-4d2d-859F-9D0F0349B6AD}",P)||Object(Pe.a)("{F94DB24F-263D-44A7-B38E-A35E9854812B}",P))&&(M&&-1!==M.indexOf("memo")||M===L.a.SingleLineText||M===L.a.SingleLineTextArea||M===L.a.Multiple)&&Object(H.c)(c,q.jd)&&(e={FormFactor:2,CustomControlId:"MscrmControls.RichTextEditorV2.RichTextEditorControlV2",Name:d.Name,Version:"1.0.0",Parameters:{value:{Usage:0,Static:!1,Type:M,Value:d.DataFieldName,Primary:!0}},ShouldOverrideControlVisible:!1},A===_.e||A===_.Gb?e.Parameters.configUrl={Usage:1,Static:!0,Type:L.a.SingleLineURL,Value:"/WebResources/Activities/SystemLibraries/msdyn_AppointmentRTEconfig.js"}:"email"===A&&(e.Parameters.configUrl={Usage:1,Static:!0,Type:L.a.SingleLineURL,Value:""}))}return e}}function Ir(e,t,n){const r=n,a=Object(ye.a)(e,t);return a&&a.visitedTabNames&&r&&r.ParentTabId&&a.visitedTabNames.has(r.ParentTabId)}function wr(e,t,n){const r=nn(e,t),a=Object(O.v)(n);return r&&r.forms&&r.forms[a]&&r.forms[a].controls?r.forms[a].controls:null}function jr(e,t,n){const r=nn(e,t);if(r&&r.referenceInformationByRelationship)for(const e in r.referenceInformationByRelationship)if(e===n)return r.referenceInformationByRelationship[e].referencedEntity;return null}function Pr(e,t,n,r,a){const i=Object(o.m)(e,r)?pe.a.CanCreate:pe.a.CanUpdate;return Object(w.f)(e,t,a,i,n)}function Tr(e,t){let n=null;const r=dt(e,Object(s.j)(e,t));if(r)for(const e of r)if(e.Visible){if(e.Expanded)return e.Id;n||(n=e.Id)}return n}function Nr(e,t,n){const r=sr(e,t);return n&&n.DataFieldName&&(!r||!r[n.DataFieldName])&&!n.Relationship&&!a.a.equals(n.ClassId,U.d)}function Ar(e,t,n){const r=Object(s.j)(e,t),a=r.InlineQuickForms,i=[];if(a)for(const e in a){const t=a[e];if(t){if(n){const t=r.Controls[e];if(t&&t.ParentTabId!==n)continue}for(const e in t){const n=t[e];i.push(n)}}}return i}function Dr(e,t,n,r){const a={},i=Object(c.f)(e,n,"picklist"),o=Object(c.f)(e,n,"multiselectpicklist"),s=Object.assign(i,o),l=wr(e,r,t);if(!(Object.keys(s).length>0))return null;for(const e in l)if(l.hasOwnProperty(e)){const t=l[e].dataFieldName;if(s[t]){const e=s[t].ParentPicklistLogicalName,n=s[t].ChildPicklistLogicalNames;(e||n&&n.length>0)&&(a[t]=s[t])}}return a}function Rr(e,t,n){if(Object(Y.a)(e)&&n)return X.a.MainFormDialog;const r=Object(Q.a)(e),a=r?r.quickCreateMenuItems:null,i=a?a[t]:null;return i&&9===i.formType?X.a.QuickCreateForm:X.a.EditForm}function xr(){let e=new Set,t=!1,n=null,r=!1,a=!1;return function(o,s,c){const l=Object(H.a)(o,q.mb),u=Fe(o,s,c),d=u&&u.HeaderDensity,p=Object(H.a)(o,q.le,q.h),g=Object(H.a)(o,q.sc,q.h),h=Object(H.a)(o,q.kb,q.Lc);return t===l&&n===d&&r===p&&a===g||(e=new Set,t=l,n=d,r=p,a=g,l&&d!==i.a.Low&&e.add(q.mb),p&&e.add(q.le),g&&e.add(q.sc),h&&e.add(q.kb)),e}}function Mr(e,t,n,r){if(!Object(H.a)(e,q.mb))return!0;const a=Fe(e,{id:t},r);if(a&&a.HeaderDensity===i.a.Low)return!0;if(!n)return!1;const o=Object(_e.b)(e,t);return!0!==Object(s.e)(e,o,t).some(e=>e&&e.Name===n.Name)||(!!Object(oe.g)(e,{id:t},r)||Object(oe.k)(n))}function Fr(e){const t=new Set,n=Object(he.b)(e);return n&&n.length>0&&n.forEach(e=>{t.add(e)}),t}function kr(e,t){const n=Fr(e);if(!n||!t||0===t.length)return t;return t.filter(e=>n.has(e))}function Lr(e,t,n){const r=Object(H.a)(e,q.mb),a=Fe(e,{id:t},n);return r&&a&&a.HeaderDensity!==i.a.Low}function Br(e){return!Object(ge.b)(e)&&Object(b.x)(e).isAutoSaveEnabled}function Ur(e,t){return e&&!!e.formInstances&&void 0!==e.formInstances[t]}function Vr(e,t){const n=Object(ye.a)(e,t);return n?n.autoSaveInterval:me.a}function zr(e,t){let n=null==e?void 0:e.DataFieldName;return n||Object(Ee.f)(t)&&(n=t),n}function Wr(e){return Object(Ie.d)(e,"DisableFormCommandbar")}function qr(e){return Object(Ie.d)(e,"DisableBusinessProcessFlow")}},i8tO:function(e,t,n){"use strict";n.d(t,"a",(function(){return $e})),n.d(t,"b",(function(){return Ze}));var r=n("QFtu"),a=n("fskq"),i=n("ufH1"),o=n("umme"),s=n("omgb"),c=n("84PK"),l=n("nfLm"),u=n("HkYq"),d=n("PV+a"),p=n("504W"),g=n("UDbe"),h=n("2mBq"),f=n("dzep"),m=n("Div0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const b="offlineDataStore";var _,y,v,S=n("VA/h"),O=n("l3Ef");!function(e){e[e.pending=0]="pending",e[e.completed=1]="completed",e[e.notTracked=2]="notTracked",e[e.inProgress=3]="inProgress",e[e.failed=4]="failed"}(_||(_={})),function(e){e[e.sqlSyncUnsupportedNorsyncVersion=-35]="sqlSyncUnsupportedNorsyncVersion"}(y||(y={})),function(e){e[e.none=0]="none",e[e.metadataVersion=1]="metadataVersion",e[e.offlineProfile=2]="offlineProfile"}(v||(v={}));var C=n("lR0U");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var E;!function(e){e[e.none=0]="none",e[e.profileUnavailable=1]="profileUnavailable",e[e.databaseUnavailable=2]="databaseUnavailable",e[e.metadataChanged=3]="metadataChanged",e[e.syncFailure=-1]="syncFailure",e[e.upgradeClient=-2]="upgradeClient"}(E||(E={}));class I{constructor(e,t){this._metadataVersionUsed=null,this._offlineDisabledEntities=null,this._metadataVersionUsed=e,this._offlineDisabledEntities=t}get_metadataVersionUsed(){return this._metadataVersionUsed}getObjectData(){const e={};return e[I._MetadataVersionUsedKey]=this._metadataVersionUsed,e[I._OfflineDisabledEntitiesKey]=this._offlineDisabledEntities,e}static createFromObjectData(e){let t="";return Object(p.a)(e)||Object(p.b)(e[I._MetadataVersionUsedKey].toString())||(t=e[I._MetadataVersionUsedKey].toString()),new I(t,[])}}I._MetadataVersionUsedKey="metadataversionused",I._OfflineDisabledEntitiesKey="offlinedisabledentities";var w=n("RADj"),j=n("2LZB");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function P(e){switch(e){case"customer":case"lookup":case"memo":case"owner":case"string":case"uniqueidentifier":case"entityname":return"text";case"double":return"real";case"money":case"decimal":return"fixed";case"datetime":return"datetime";case"bigint":case"integer":case"boolean":case"picklist":case"state":case"status":case"managedproperty":return"integer";default:return""}}var T=n("03Hu"),N=n("T544"),A=n("JPoD"),D=n("EW4s");const R=["virtual","partylist"];class x{constructor(e,t){this._parentDataSource=null,this._offlineDisabledEntities=null,this._localContext=null,this._entitySkipList=[A.c.toLowerCase()],this._parentDataSource=e,this._localContext=t}calculateAndSetOfflineDisabledEntities(e,t){const n=new D.a,r=[];let a=w.a.InSyncWithServer;return this._CalculateMetadataMismatchEntities(e,t).then(()=>{null!==this._offlineDisabledEntities&&this._offlineDisabledEntities.length>0&&Object(i.e)("OfflineMetadataManager_CalculateAndSetOfflineDisabledEntities",m.a.offlineMetadataSync,"List of offline disabled entities, entities are present in offline profile but not in schema : "+this._offlineDisabledEntities.toString()),T.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineDisableInformation(this._offlineDisabledEntities,t.toString()),T.a.get_DefaultInstance().get_offlineTypescriptInterface().setCalculationOfDisabledOfflineEntitiesPending(!1),null!==this._offlineDisabledEntities&&this._offlineDisabledEntities.length>0?(a=w.a.SyncPending,T.a.get_DefaultInstance().get_offlineTypescriptInterface().setMetadataSyncStatus(w.a.SyncPending)):a=w.a.InSyncWithServer,T.a.get_DefaultInstance().get_offlineTypescriptInterface().setMetadataSyncStatus(a);const e=new I(t.toString(),this._offlineDisabledEntities),o={};o[x._OfflineMetatdataSyncStatus]=a,r.push(this._parentDataSource.saveSessionState(x._OfflineDisabledInfoKey,e.getObjectData(),!1)),r.push(this._parentDataSource.saveSessionState(x._OfflineMetatdataSyncStatus,o,!1)),Object(S.a)(r).then(()=>{Object(i.c)("OfflineMetadataManager_CalculateAndSetOfflineDisabledEntities",m.a.offlineMetadataSync,"Successfully saved the offline disabled info and metadata status in the session state."),n.resolve(!0)},e=>{Object(i.e)("OfflineMetadataManager_CalculateAndSetOfflineDisabledEntities_Error",m.a.offlineMetadataSync,"Saving offline disabled info and metadata sync status in session state failed with error : "+e.get_Message()),n.reject(e)}),n.resolve(!0)},e=>{Object(i.e)("OfflineMetadataManager_CalculateAndSetOfflineDisabledEntities_Error",m.a.offlineMetadataSync,"Calculation of offline disabled entities failed with error : "+e.get_Message()),n.reject(e)}),n}_CalculateMetadataMismatchEntities(e,t){const n=new D.a;if(this._offlineDisabledEntities=[],null!==e&&!Object(p.b)(e.userData)&&e.userData.split("#").length>1){const t=e.userData.split("#");if(t[0]===T.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineProfileVersion()&&t[1]===T.a.get_DefaultInstance().get_offlineTypescriptInterface().getLastMetadataVersionUsedForValidation())n.resolve(!0);else{const t=[],r={};for(const t of e.tables)r[t.name]=t;for(const e of T.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineProfileAvailableEntities())e in r?t.push(this._CompareMetadata(r[e])):this._entitySkipList.indexOf(e)<0&&this._offlineDisabledEntities.push(e);Object(S.a)(t).then(()=>{n.resolve(!0)},e=>{n.reject(e)})}}else n.reject(o.a.FromMessage("Retrieved client model is corrupt or empty."));return n}_CompareMetadata(e){const t=new D.a,n=T.a.get_DefaultInstance().get_offlineTypescriptInterface().isApplicationMetadataDownloadInShimEnabled();return this._parentDataSource.retrieveMultipleAttributeMetadata(new N.a(e.name),this._localContext).then(r=>{const a={};for(const t of e.column)a[t.name]=t.type;for(const t of r){const r="lookup"===t.get_type()||"owner"===t.get_type()||"customer"===t.get_type()?t.get_logicalName()+O.l+O.y:t.get_logicalName();let o=!1;if(T.a.get_DefaultInstance().get_offlineTypescriptInterface().isDssOfflineEnabled()||(o=a[r]!==P(t.get_type())),R.indexOf(t.get_type())<0&&(!(r in a)||o)){n||(this._offlineDisabledEntities.push(e.name),Object(i.e)("OfflineMetadataManager_CalculateAndSetOfflineDisabledEntities",m.a.offlineMetadataSync,"Offline disable entities due to lookup metadata mismatch : "+r+" "+e.name));break}}t.resolve()},r=>{n||(this._offlineDisabledEntities.push(e.name),Object(i.e)("OfflineMetadataManager_MetadataSchemaValidator_Error:RetrieveMultipleAttributeMetadata failed for Entity "+e.name,m.a.offlineMetadataSync,r.get_Message())),t.resolve()}),t}}x._OfflineDisabledInfoKey="offlinedisabledinfo",x._OfflineMetatdataSyncStatus="offlinemetadatasyncstatus";var M=n("yRo8");class F{constructor(){this._middlewareProfileVersion=0,this._middlewareMetadataVersion=0,this._clientMetadataVersion=0,this._parentDataSource=null,this._localContext=null,this._clientModelTables=null}get_clientModelTables(){return this._clientModelTables}_get_ClientProfileVersion(){return Number.parseInvariant(T.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineProfileVersion())}initialize(e,t,n){this._parentDataSource=t,this._localContext=n}isServerMetadataSyncRequired(){let e=!1;if(T.a.get_DefaultInstance().get_offlineTypescriptInterface().isDssOfflineEnabled()){const t=T.a.get_DefaultInstance().get_offlineTypescriptInterface().getIsProfileChanged(),n=[];T.a.get_DefaultInstance().get_offlineTypescriptInterface().getMetadataSyncStatus()===w.a.SyncPending&&(t||this._middlewareMetadataVersion>this._clientMetadataVersion?(T.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(null,E.metadataChanged),T.a.get_DefaultInstance().get_offlineTypescriptInterface().setMetadataSyncStatus(w.a.SyncPendingFromServer),Object(f.a)(n,"OfflineMetadtaSyncStatus",w.a.SyncPendingFromServer.toString()),e=!0,T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(M.f,"[offlineMetadataManager] isServerMetadataSyncRequired: Profile is changed",n)):this._middlewareMetadataVersion!==this._clientMetadataVersion&&T.a.get_DefaultInstance().get_offlineTypescriptInterface().setMetadataSyncStatus(w.a.SyncPendingFromMiddleware))}else T.a.get_DefaultInstance().get_offlineTypescriptInterface().getMetadataSyncStatus()!==w.a.SyncPending||T.a.get_DefaultInstance().get_offlineTypescriptInterface().getIsProfileChanged()||(this._middlewareProfileVersion>this._get_ClientProfileVersion()||this._middlewareMetadataVersion>this._clientMetadataVersion?(T.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(null,E.metadataChanged),T.a.get_DefaultInstance().get_offlineTypescriptInterface().setMetadataSyncStatus(w.a.SyncPendingFromServer),e=!0):this._middlewareProfileVersion===this._get_ClientProfileVersion()&&this._middlewareMetadataVersion===this._clientMetadataVersion||T.a.get_DefaultInstance().get_offlineTypescriptInterface().setMetadataSyncStatus(w.a.SyncPendingFromMiddleware));return e}calculateDisabledOfflineEntitiesAfterMetadataSync(){const e=new D.a;return this._SetClientMetadataVersion().always(()=>{this._ShouldRecalculateAfterMetadataSync().then(t=>{t?this.calculateDisabledOfflineEntities().always(()=>{this.isServerMetadataSyncRequired(),e.resolve()}):e.resolve()},t=>{e.reject(t)})}),e}_ShouldRecalculateAfterMetadataSync(){const e=new D.a;return Object(p.a)(this._parentDataSource)?e.resolve(!1):(this._parentDataSource.retrieveSessionState(F._offlineDisabledInfoKey).then(t=>{if(Object(p.a)(t))e.resolve(!0);else{const n=I.createFromObjectData(t);Object(p.b)(n.get_metadataVersionUsed())?e.resolve(!0):n.get_metadataVersionUsed()===this._clientMetadataVersion.toString()?e.resolve(!1):e.resolve(!0)}},t=>{Object(i.e)("OfflineMetadataManager_ShouldReCalculateAfterMetadataSync_Error",m.a.offlineMetadataSync,"Retrieval of offline disabled info failed. Error: "+t.get_Message()),e.reject(t)}),e)}calculateDisabledOfflineEntities(){const e=new D.a;return Object(i.e)("OfflineMetadataManager_CalculateDisabledOfflineEntities",m.a.offlineMetadataSync,"Calculation of disabled offline entities started"),this._GetClientSyncModel().then(t=>{if(null!==t&&!Object(p.b)(t.userData)&&t.userData.split("#").length>1){const n=t.userData.split("#");this._middlewareProfileVersion=Number.parseInvariant(n[0]),this._middlewareMetadataVersion=Number.parseInvariant(n[1]);const r=new x(this._parentDataSource,this._localContext);this._SetClientMetadataVersion().then(()=>{r.calculateAndSetOfflineDisabledEntities(t,this._clientMetadataVersion).then(t=>{Object(i.e)("OfflineMetadataManager_CalculateDisabledOfflineEntities",m.a.offlineMetadataSync,"Successfully calculated and saved the offline disabled info as session state."),e.resolve(t)},t=>{Object(i.e)("OfflineMetadataSync_CalculateDisabledOfflineEntities_Error",m.a.offlineMetadataSync,t.get_Message()),e.reject(t)})},t=>{Object(i.e)("OfflineMetadataManager_CalculateDisabledOfflineEntities",m.a.offlineMetadataSync,t.get_Message()),e.reject(t)})}else e.reject(o.a.FromMessage("Retrieved client model is corrupt or empty."))},t=>{e.reject(t)}),e}isDataModelChanged(e){const t=new D.a;return Object(i.e)("OfflineMetadataManager_IsDataModelChanged",m.a.offlineMetadataSync,"Checking if data model change started"),this._GetClientSyncModel().then(n=>{let r=this._clientMetadataVersion;null!==n&&!Object(p.b)(n.userData)&&n.userData.split("#").length>1&&(r=Number.parseInvariant(n.userData.split("#")[1]));let a=0;if(r!==this._clientMetadataVersion)a=v.metadataVersion;else if(!Object(p.a)(e)){const t=this._GetClientModelTables(n);if(t.length!==e.length)a=v.offlineProfile;else{t.sort(),e.sort();for(let n=0;n<t.length;n++)if(t[n]!==e[n]){a=v.offlineProfile;break}}}Object(i.e)("OfflineMetadataManager_IsDataModelChanged",m.a.offlineMetadataSync,"Data model change check completed, data model change type is "+a),t.resolve(a)},e=>{Object(i.e)("OfflineMetadataManager_IsDataModelChanged_Error",m.a.offlineMetadataSync,e.get_Message()),t.resolve(0)}),t}_SetClientMetadataVersion(){const e=new D.a;return this._GetClientMetadataVersion().then(t=>{this._clientMetadataVersion=Number.parseInvariant(t),e.resolve(!0)},t=>{Object(i.e)("OfflineMetadataManager_SetClientMetadataVersion_Error",m.a.offlineMetadataSync,t.get_Message()),e.reject(t)}),e}retrieveClientModelTables(){const e=new D.a;return Object(i.e)("OfflineMetadataManager_RetrieveClientModelTables",m.a.offlineMetadataSync,"Retrieval of client model tables started"),this._GetClientSyncModel().then(t=>{this._clientModelTables=this._GetClientModelTables(t),e.resolve(this._clientModelTables)},t=>{e.reject(t)}),e}_GetClientModelTables(e){const t=[];if(!Object(p.a)(e)&&!Object(p.a)(e.tables))for(const n of e.tables)t[t.length]=n.name;return t}_GetDeserializedClientModel(e){try{return JSON.parse(e)}catch(e){Object(i.e)("OfflineMetadataManager_GetDeserializedClientModel_Error",m.a.offlineMetadataSync,e.message)}return null}_GetClientSyncModel(){const e=new D.a,t=new j.a(new Array(0));return this._parentDataSource.get_offlineDataStore().retrieveLocalEntities(F._NorsyncSystemTable,t).then(t=>{if(!Object(p.a)(t)&&t.rows.length>0&&!Object(p.a)(t.rows.item(0)[F._NorsyncDataModel])){const n=t.rows.item(0)[F._NorsyncDataModel].toString(),r=this._GetDeserializedClientModel(n);e.resolve(r)}else e.reject(o.a.FromMessage("Error in the retrieved client model from offline db."))},t=>{Object(i.e)("OfflineMetadataManager_GetClientSyncModel_Error",m.a.offlineMetadataSync,t.get_Message()),e.reject(t)}),e}_GetClientMetadataVersion(){const e=new D.a;return Object(p.a)(this._parentDataSource)?e.reject(o.a.FromMessage("parent datasource is null.")):(this._parentDataSource.retrieveEntityMetadataVersionStamp().then(t=>{t.length>0?e.resolve(t.split("!")[0]):e.reject(o.a.FromMessage("Retrieved entity metadata version stamp is null or empty."))},t=>{Object(i.e)("OfflineMetadataManager_GetClientMetadataVersion_Error",m.a.offlineMetadataSync,t.get_Message()),e.reject(t)}),e)}}F._offlineDisabledInfoKey="offlinedisabledinfo",F._NorsyncSystemTable="_NORSYNC_SYSTEM_TABLE",F._NorsyncDataModel="DATA_MODEL";var k=n("ZJD9"),L=n("BSGX"),B=n("iJxC"),U=n("LFDu"),V=n("JUjK"),z=n("3fL6"),W=n("mKIe"),q=n("3ri3"),H=n("jZCH"),G=n("bATk");class K{generateInsertQuery(e,t){let n="",r="";for(let e=0;e<t.length;e++){const a=e>0?",":"";n+=a+"["+t[e]+"]",r+=a+"?"}return"INSERT INTO ["+e.LogicalName+"] ("+n+") VALUES ("+r+")"}generateRetrieveQuery(e,t,n){const r=e.LogicalName,a=new L.a(new g.a(n),e.get_key()),i=new B.a(a,null),o=Object(G.a)(i,r,!0);return(Object(p.a)(t)?o.selectAllColumns():o.selectIndexedColumnsStatement(t))+K._CollateNoCase}generateUpdateQuery(e,t,n){let r="UPDATE "+e.LogicalName+" SET ";for(let e=0;e<t.length;e++)r+=(e>0?",":"")+"["+t[e]+"] = ?";return r+=" WHERE ["+n+"] = ?",r+K._CollateNoCase}generateDeleteQuery(e,t){const n=t.get_filterCriteria();let r="DELETE FROM ["+e.LogicalName+"] ";return n&&n.length>0&&(r=r+"WHERE "+this._CreateWhereClause(n)+K._CollateNoCase),r}generateExistsQuery(e,t){return"SELECT EXISTS(SELECT 1 FROM "+e.LogicalName+" WHERE ["+t+"] = ? LIMIT 1)"}generateRetreiveLookupQuery(e,t,n){let r="",a="";for(let e=0;e<t.length;e++){r+=(e>0?",":"")+"["+t[e]+"]"}for(let t=0;t<e;t++){a+=(t>0?" OR":"")+"["+n.get_primaryIdAttribute()+"] = ? "+K._CollateNoCase}return"SELECT "+r+" FROM "+n.get_logicalName()+" WHERE "+a}generateRetrieveQueryWithConditions(e,t,n,r){const a=t.get_filterCriteria();let i="SELECT * FROM "+e;return a&&a.length>0&&(i=i+" WHERE "+this._CreateWhereClause(a)+this._CreateOrderClause(n,r)+this._CreateLimitClause(t)+K._CollateNoCase),i}_CreateOrderClause(e,t){let n="";return Object(p.b)(e)||(n=" ORDER BY "+e+(t?" ASC ":" DESC ")),n}_CreateLimitClause(e){let t="";if(!Object(p.a)(e.get_batchSize())&&e.get_batchSize()>0){const n=Object(p.a)(e.get_batchOffset())?"":" OFFSET "+e.get_batchOffset().toString();t+=" LIMIT "+e.get_batchSize().toString()+n}return t}_CreateWhereClause(e){let t="";for(let n=0;n<e.length;n++){const r=e[n].get_parenthesisType()?"":" (",a=e[n].get_parenthesisType()===W.a.end?" )":"";if(t+=n?" "+K._ConvertOperatorType(e[n].get_logicalOperator())+r+" ["+e[n].get_name()+"] "+K._ConvertConditionType(e[n].get_condition()):r+" ["+e[n].get_name()+"] "+K._ConvertConditionType(e[n].get_condition()),e[n].get_condition()===V.a.In){const r=e[n].get_value().length;t+=r>0?"(?":"(";for(let e=1;e<r;e++)t+=", ?";t+=")"}else e[n].get_condition()!==V.a.IsNull&&(t+=" ?");t+=a}return t}generateRetrievePartyListQuery(e,t,n){let r="",a="",i="";for(let t=0;t<e.length;t++)r+="["+e[t].get_path()+"],";r=""!==r?r.substr(0,r.length-1):r,a="["+O.c+O.l+O.y+"] = ?";for(let e=0;e<Object.keys(t).length;e++)i+="?,";""!==i&&(i=i.substr(0,i.length-1),a+=" AND ["+O.P+"] in ("+i+")");return"SELECT "+r+" FROM "+n+" WHERE "+a+K._CollateNoCase+" ORDER BY ["+O.P+"]"}generateDeleteAllActivityPartiesQuery(){return"DELETE FROM ["+O.d+"] WHERE ["+O.c+O.l+O.y+"] = ?"+K._CollateNoCase}generateDeleteFilteredActivityPartiesQuery(e){let t="";for(let n=e;n>0;n--)t+=n>1?"?,":"?";return"DELETE FROM ["+O.d+"] WHERE ["+O.c+O.l+O.y+"] = ? AND ["+O.P+"] = ?  AND ["+O.e+"] NOT IN ("+t+")"+K._CollateNoCase}updateActivityPartiesQuery(e){let t="";for(let n=e;n>0;n--)t+="?,";t.length>1&&(t=t.substring(0,t.length-1));return"UPDATE ["+O.d+"] SET ["+O.c+O.l+O.y+"] = ? WHERE ["+O.c+O.l+O.y+"] = ? AND ["+O.P+"] = ?  AND ["+O.e+"] IN ("+t+")"+K._CollateNoCase}generateCreateActiviyPointerViewQuery(e,t,n){let r="CREATE VIEW "+A.c+" AS ";const a=new D.a;return this.getActivityEntities(e,t,n).then(t=>{this._GenerateSelectForActivityEntity(t,e).then(e=>{r+=e,a.resolve(r)},()=>{a.reject(o.a.FromMessage("Offline DB could not create view query."))})},e=>{Object(i.e)("Offline.OfflineSqlQueryBuilder.GenerateCreateActiviyPointerViewQuery.Fail",m.a.offlineDataStore,e.get_Message()),a.reject(e)}),a}generateCreateActiviyAttachmentViewQuery(e){let t="CREATE VIEW "+O.b+" AS ";const n=e.indexOf(A.l)>-1,r=new D.a;return t+=this._GenerateSelectForActivityAttachment(n),r.resolve(t),r}generateDropViewQuery(e){return"DROP VIEW IF EXISTS "+e}_GenerateSelectForActivityEntity(e,t){const n=new D.a;let r="",a="",i="",s="",c=0;const l=new U.a,u=[],d=new N.a(A.c.toLocaleLowerCase());u.push(H.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(d,t));for(let n=0;n<e.length;n++){const r=new N.a(e[n].toString());u.push(H.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(r,t))}return Object(S.a)(u).then(e=>{if(e&&e.length>0){const t=e[0];for(let n=1;n<e.length;n++){const o=e[n];r="SELECT ",c=0;for(let e=0;e<t.length;e++){const n=t[e];if("virtual"!==n.get_type()){for(let e=0;e<o.length;e++){a="";const t=o[e];if(!Object(p.a)(t.get_inheritsFrom())&&t.get_inheritsFrom()===n.get_logicalName()){if(l.isComplexAttribute(t.get_type())){const e=l.getAttributeMap(t.get_type()).get_columnNameTypeMap();for(let r=0;r<Object.keys(e).length;r++){const i=Object.keys(e)[r],o="["+t.get_logicalName()+O.l+i+"] AS ["+n.get_logicalName()+O.l+i+"]";a+=r!==Object.keys(e).length-1?o+", ":o}}else a+=t.get_logicalName()+" AS "+n.get_logicalName();s=t.get_entityLogicalName();break}}if(!a.length&&l.isComplexAttribute(n.get_type())){const e=l.getAttributeMap(n.get_type()).get_columnNameTypeMap();for(let t=0;t<Object.keys(e).length;t++){const r=Object.keys(e)[t],i="NULL AS ["+n.get_logicalName()+O.l+r+"]";a+=t!==Object.keys(e).length-1?i+", ":i}}else a.length||(a+="NULL AS "+n.get_logicalName());r+=c>0?", "+a:a,c++}}i+=(i.length>0?" UNION ALL ":"")+r+" FROM "+s}n.resolve(i)}else n.reject(o.a.FromMessage("GenerateSelectForActivityEntity: No results when trying to retrieve attribute metadata for activities."))},()=>{n.reject(o.a.FromMessage("Offline DB could not create view query."))}),n}_GenerateSelectForActivityAttachment(e){return Object(h.a)(K._AttachmentViewQuery,"case when coalesce(xxemail.owneridtype, "+(e?"xxtemplate.owneridtype":K._EmptyString)+") = 8 then coalesce(xxemail.["+O.M+O.l+O.y+"],"+(e?"xxtemplate.["+O.M+O.l+O.y+"]":K._EmptyString)+") else null end as 'owninguser'","coalesce(xxemail.["+O.M+O.l+O.y+"], "+(e?"xxtemplate.["+O.M+O.l+O.y+"]":K._EmptyString)+") as '"+O.M+O.l+O.y+"',coalesce(xxemail.["+O.M+O.l+O.F+"], "+(e?"xxtemplate.["+O.M+O.l+O.F+"]":K._EmptyString)+") as '"+O.M+O.l+O.F+"',coalesce(xxemail.["+O.M+O.l+"name], "+(e?"xxtemplate.["+O.M+O.l+"name]":K._EmptyString)+") as '"+O.M+O.l+O.a+"'","coalesce(xxemail.owneridtype, "+(e?"xxtemplate.owneridtype":K._EmptyString)+") as 'owneridtype'","coalesce(xxemail.[owningbusinessunit"+O.l+O.y+"], "+(e?"xxtemplate.[owningbusinessunit"+O.l+O.y+"]":K._EmptyString)+") as 'owningbusinessunit"+O.l+O.y+"',coalesce(xxemail.[owningbusinessunit"+O.l+O.F+"], "+(e?"xxtemplate.[owningbusinessunit"+O.l+O.F+"]":K._EmptyString)+") as 'owningbusinessunit"+O.l+O.F+"',coalesce(xxemail.[owningbusinessunit"+O.l+O.a+"], "+(e?"xxtemplate.[owningbusinessunit"+O.l+O.a+"]":K._EmptyString)+") as 'owningbusinessunit"+O.l+O.a+"'",e?" left join template xxtemplate on xxactivitymimeattachment.[objectid"+O.l+O.y+"] = xxtemplate.templateid":"")}generateInsertForUpSyncTransactionLog(){const e=q.N+","+q.K+","+q.J+","+q.L;return"INSERT INTO ["+q.D+"] ("+e+") VALUES ( DATETIME('NOW'), ? , sqlite_source_id(), ?)"}getActivityEntities(e,t,n){const r=new D.a,a=[],o=[];for(const t of n)o.push(H.a.get_DefaultInstance().retrieveEntityMetadata(t,e));return Object(S.a)(o).then(e=>{for(const r of e)if(!Object(p.a)(r)){const e=r;e.get_isActivity()&&e.get_logicalName().toLowerCase()!==A.c.toLowerCase()&&n.indexOf(e.get_logicalName().toLowerCase())>=0&&(Object(p.a)(t)||t.indexOf(e.get_logicalName().toLowerCase())>=0)&&(a.push(e.get_logicalName().toLowerCase()),Object(i.d)("Offline.OfflineSqlQueryBuilder.GetActivityEntities",m.a.offlineDataStore,e.get_logicalName().toLowerCase()+"added to acitivity list"))}r.resolve(a)},e=>{Object(i.e)("Offline.OfflineSqlQueryBuilder.GetActivityEntities.Fail",m.a.offlineDataStore,e.get_Message()),r.reject(e)}),r}retrieveDataSyncStatusQuery(e){let t="";for(let n=e;n>0;n--)t+="?,";return""!==t&&(t=t.substr(0,t.length-1)),Object(h.a)("SELECT * FROM {0} WHERE {1} IN ({2}){3}",O.u,O.q,t,K._CollateNoCase)}generateSuppressTriggerQuery(){return K._suppressTriggersInsert}generateUnsuppressTriggerQuery(){return K._suppressTriggersDelete}static get_instance(){return K._instance||(K._instance=new K),K._instance}static _ConvertConditionType(e){let t="";switch(e){case 0:t="=";break;case V.a.NotEquals:t="<>";break;case V.a.LessThan:t="<";break;case V.a.LessThanEqualTo:t="<=";break;case V.a.GreaterThan:t=">";break;case V.a.GreaterThanEqualTo:t=">=";break;case V.a.IsNull:t="ISNULL";break;case V.a.In:t="IN"}return t}static _ConvertOperatorType(e){let t="";switch(e){case z.a.Or:t="OR";break;case 0:t="AND"}return t}}K._CollateNoCase=" COLLATE NOCASE",K._EmptyString='""',K._AttachmentViewQuery="select xxemail.activityid, xxattachment.body, xxattachment.filename, xxattachment.filesize, xxattachment.mimetype, xxattachment.subject,{0},{1},{2},{3},[xxactivitymimeattachment].[attachmentnumber],[xxactivitymimeattachment].[activitymimeattachmentid],[xxactivitymimeattachment].[versionnumber],[xxactivitymimeattachment].[attachmentid!id],[xxactivitymimeattachment].[attachmentid!name],[xxactivitymimeattachment].[attachmentid!logicalname],[xxactivitymimeattachment].[objectid!id],[xxactivitymimeattachment].[objectid!name],[xxactivitymimeattachment].[objectid!logicalname],[xxactivitymimeattachment].[objecttypecode],[xxactivitymimeattachment].[componentstate],[xxactivitymimeattachment].[overwritetime],[xxactivitymimeattachment].[solutionid],[xxactivitymimeattachment].[supportingsolutionid],[xxactivitymimeattachment].[activitymimeattachmentidunique],[xxactivitymimeattachment].[ismanaged],[xxactivitymimeattachment].[attachmentcontentid], [xxactivitymimeattachment].[isfollowed], [xxactivitymimeattachment].[anonymouslink] from[activitymimeattachment][xxactivitymimeattachment] left join activitypointer xxemail on xxactivitymimeattachment.[objectid!id] = xxemail.activityid and xxemail.activitytypecode='email' {4} left join attachment xxattachment on xxactivitymimeattachment.[attachmentid!id] = xxattachment.attachmentid where (datetime(xxactivitymimeattachment.overwritetime) = datetime('1900-01-01') or xxactivitymimeattachment.overwritetime is null) and xxactivitymimeattachment.componentstate = 0",K._instance=null,K._suppressTriggersInsert="INSERT INTO _NORSYNC_SUPPRESS_TRIGGERS(value) VALUES(1)",K._suppressTriggersDelete="DELETE FROM _NORSYNC_SUPPRESS_TRIGGERS";var Q=n("eZ32"),X=n("8CLP"),Y=n("FZk4"),J=n("WSMw");class Z{constructor(e,t){if(this._fields=[],this._fieldValue=[],Object(p.a)(t)){let t=0;for(const n in e){const r={key:n,value:e[n]};this.get_fields()[t]=r.key,this.get_fieldValue()[t]=this._GetFormattedValue(r.value),t++}}else for(let e=0;e<t.length;e++)if(t[e].get_condition()===V.a.In){const n=t[e].get_value();for(let e=0;e<n.length;e++)this.get_fieldValue().push(this._GetFormattedValue(n[e]))}else this.get_fieldValue().push(this._GetFormattedValue(t[e].get_value()))}get_fields(){return this._fields}get_fieldValue(){return this._fieldValue}_GetFormattedValue(e){return e instanceof c.a?e.toString():e}}var ee=n("MUIu"),te=n("TRNQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class ne{_StoreMaxDate(e){const t={};t[ne._MaxTimeColumnName]=e,H.a.get_DefaultInstance().get_LocalDataSource().saveSessionState(ne._MaxTimeColumnName,t,!1).then(t=>{Object(i.d)("SecurityUtil",m.a.storage,"StoreMaxDate: New Date is "+e)},e=>{Object(i.e)("SecurityUtilFailureErrors",m.a.storage,"StoreMaxDate Error: "+e.get_Message())})}_RetrieveMaxDate(){const e=new D.a;return H.a.get_DefaultInstance().get_LocalDataSource().retrieveSessionState(ne._MaxTimeColumnName).then(t=>{let n="";Object(p.a)(t)||!(ne._MaxTimeColumnName in t)||Object(p.a)(t[ne._MaxTimeColumnName])||(n=t[ne._MaxTimeColumnName].toString()),Object(i.d)("SecurityUtil",m.a.storage,"RetrieveMaxDate: "+n),e.resolve(n)},t=>{Object(i.e)("SecurityUtilFailureErrors",m.a.storage,"RetrieveMaxDate Error: "+t.get_Message()),e.reject(t)}),e}isFullSyncRequired(){const e=new D.a;return this._RetrieveMaxDate().then(t=>{Object(p.b)(t)&&(t=null),this.calculateAndStoreMaxDate(t).then(n=>{Object(p.b)(t)||(t=Object(ee.b)(t)),!Object(p.a)(n)&&n>new Date(t)?e.resolve(!0):e.resolve(!1)},t=>{Object(i.e)("SecurityUtilFailureErrors",m.a.storage,"IsFullSyncRequired: CalculateAndStoreMaxDate Error: "+t.get_Message()),e.reject(t)})},t=>{Object(i.e)("SecurityUtilFailureErrors",m.a.storage,"IsFullSyncRequired: RetrieveMaxDate Error: "+t.get_Message()),e.reject(t)}),e}calculateAndStoreMaxDate(e){const t=new D.a,n=new Array(0);let r=e;Object(p.a)(e)||(e=Object(ee.b)(e),n[0]=new Y.a(ne._CreatedOnColumnName,r,z.a.Or,V.a.GreaterThan));let a=new j.a(n);const o=new te.a;return o.retrieve(ne._UserEntityAttributeMapTableName,a).then(n=>{let a=new Date(e);if(n.rows.length>0)for(let e=0;e<n.rows.length;e++)if(!Object(p.a)(n.rows.item(e))){const t=n.rows.item(e)[ne._CreatedOnColumnName];if(Object(p.b)(t))Object(i.e)("SecurityUtil",m.a.storage,"CalculateAndStoreMaxDate date is not stored for row: "+e);else{const e=new Date(Object(ee.b)(t));a<e&&(a=e,r=t)}}this._StoreMaxDate(r),t.resolve(a)},n=>{if(Object(p.a)(e))Object(i.e)("SecurityUtilFailureErrors",m.a.storage,"CalculateAndStoreMaxDate retrieve data was null Error: "+n.get_Message()),t.reject(n);else{const e=new Array(0);a=new j.a(e),o.retrieve(ne._UserEntityAttributeMapTableName,a).then(e=>{Object(i.e)("SecurityUtil",m.a.storage,"CalculateAndStoreMaxDate retrieve data Error: "+n.get_Message()),t.reject(n)},()=>{t.resolve(new Date),this._StoreMaxDate(ne._MinTime)})}}),t}static get_defaultInstance(){return Object(p.a)(ne._defaultInstance)&&(ne._defaultInstance=new ne),ne._defaultInstance}}ne._MaxTimeColumnName="MaxTime",ne._MinTime="1970-01-01 00:00:00.000",ne._CreatedOnColumnName="CreatedOn",ne._UserEntityAttributeMapTableName="UserEntityAttributeMap",ne._defaultInstance=null;var re,ae=n("ti3l");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.trace=1]="trace",e[e.debug=2]="debug",e[e.perf=3]="perf",e[e.info=4]="info",e[e.warning=5]="warning",e[e.error=6]="error",e[e.fatal=7]="fatal"}(re||(re={}));var ie=n("/D1P"),oe=n("XvL5"),se=n("3c60"),ce=n("5qiD"),le=n("d+dp"),ue=n("8tWD"),de=n("/bjP"),pe=n("wMH2"),ge=n("WRF3"),he=n("V482"),fe=n("ngzy"),me=n("c46F"),be=n("a1q1"),_e=n("IzVP"),ye=n("qCX6"),ve=n("pah4"),Se=n("Xe7f"),Oe=n("kGsI"),Ce=n("hirD"),Ee=n("CrQY"),Ie=n("PF3G"),we=n("fVHw"),je=n("XgcG"),Pe=n("Jz1I"),Te=n("LtP7"),Ne=n("3sOn"),Ae=n("1Xob"),De=n("bRS5"),Re=n("bK23");class xe{constructor(e,t,n){this._dataBaseName=null,this._userContext=null,this._profileId=null,this._authToken=null,this._norsyncServerEndpoint=null,this._sessionId=null,this._subscriptionId=null,this._isApplicationMetadataDownloadInShimEnabled=!1,this._appId=null,this._offlineResourceSrings=null,this._dataBaseName=e,this._userContext=t,this._norsyncServerEndpoint=new Re.a(T.a.get_DefaultInstance().get_offlineTypescriptInterface().getNorsyncServerConnectionString()),this._authToken=n;const a=T.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineProfileId();""===this._dataBaseName||c.a.tryCreate(this._dataBaseName).equals(c.a.get_empty())||this._dataBaseName===a?this._profileId=a:this._profileId=this._dataBaseName,this._sessionId=localStorage.getItem(r.o),this._subscriptionId=T.a.get_DefaultInstance().get_offlineTypescriptInterface().getSubscriptionId(),this._isApplicationMetadataDownloadInShimEnabled=T.a.get_DefaultInstance().get_offlineTypescriptInterface().isApplicationMetadataDownloadInShimEnabled(),this._appId=T.a.get_DefaultInstance().get_offlineTypescriptInterface().getCurrentAppId();const i=T.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineResourceStrings();this._offlineResourceSrings=this._isApplicationMetadataDownloadInShimEnabled?JSON.stringify(i):JSON.stringify([])}checkWhetherLoginParametersChanged(e){if(Object(p.a)(e))return Object(i.e)("CheckWhetherLoginParametersChanged",m.a.offlineDataStore,"Login Parameters are empty"),!0;const t=e.getObjectData(),n=this.getObjectData();for(const e in t){const r={key:e,value:t[e]};if(n[r.key]!==r.value)return Object(i.e)("CheckWhetherLoginParametersChanged",m.a.offlineDataStore,"Login Parameter"+r.key+"Changed"),!0}return Object(i.e)("CheckWhetherLoginParametersChanged",m.a.offlineDataStore,"Login Parameteres Didn't change"),!1}get_dataBaseName(){return this._dataBaseName}get_userId(){return this._userContext.get_UserId().toString()}get_port(){const e=this._norsyncServerEndpoint.get_port();return Object(p.b)(e)?0:Number.parseInvariant(e)}get_host(){return this._norsyncServerEndpoint.get_host()}get_serverDataBaseName(){return this._userContext.get_OrganizationId().toString()}get_isSSL(){return this._norsyncServerEndpoint.get_scheme()===Re.a.uriSchemeHttps}get_authToken(){return this._authToken}get_sessionId(){return this._sessionId}get_subscriptionId(){return this._subscriptionId}get_profileId(){return this._profileId}get_isApplicationMetadataDownloadInShimEnabled(){return this._isApplicationMetadataDownloadInShimEnabled}get_appId(){return this._appId}get_offlineResourceSrings(){return this._offlineResourceSrings}getObjectData(){const e={};return e.DataBaseName=this.get_dataBaseName(),e.UserId=this.get_userId(),e.Host=this.get_host(),e.Port=this.get_port().toString(),e.IsSSL=this.get_isSSL().toString(),e.ServerDataBaseName=this.get_serverDataBaseName(),e.ProfileId=this.get_profileId(),e.AuthToken=this.get_authToken(),e.SessionId=this.get_sessionId(),e}}xe.modelVersion=-1,xe.offlineDatabasePath="/data/data/no.norsync.cordova/databases";var Me=n("Hswk"),Fe=n("DRVD"),ke=n.n(Fe),Le=n("MXaZ"),Be=n("0rLi"),Ue=n("iJGp"),Ve=n("/oKV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class ze{constructor(e,t,n){this.Query=e,this.FieldValues=t,this.ErrorMessage=n}}var We=n("b2mI"),qe=n("Ydwo"),He=n("FZDd"),Ge=n("7F2l"),Ke=n("6lVV"),Qe=n("37s6"),Xe=n("lMS8"),Ye=n("E5IU"),Je=n("JEu3");const $e="OfflineDataSync";class Ze{constructor(){this._syncIntervalInMilliseconds=0,this._plugin=null,this._offlineMetadataManager=null,this._regenerateViews=!0,this._localContext=null,this._syncJobNode=null,this._timerId=0,this._retryWaitTime=0,this._minRetryWaitTime=3e4,this._offlineByDefaultSyncInterval=3e5,this._retryMultiplier=2,this._isRetried=!1,this._parentDataSource=null,this._userContext=null,this._entitySkipList=[A.c.toLowerCase(),A.k.toLowerCase(),A.b.toLowerCase(),A.i.toLowerCase(),A.f.toLowerCase(),A.h.toLocaleLowerCase(),A.g.toLocaleLowerCase(),A.a.toLocaleLowerCase()],this._offlineMetadataManager=new F}get_offlineMetadataManager(){return this._offlineMetadataManager}_get_Plugin(){return Object(p.a)(this._plugin)&&(this._plugin=T.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineSyncPlugin("OfflineDataSource")),this._plugin}_set_Plugin(e){return this._plugin=e,e}initialize(e,t,n,r){Ze._LogVerbose("OfflineDataStore.Initialize","Offline DataStore Initialize started");const a=new D.a,i=H.a.get_DefaultInstance().get_Store(),o=Object(Ye.o)(i.getState());this._syncIntervalInMilliseconds=o?this._offlineByDefaultSyncInterval:e.get_organizationSettings().get_mobileOfflineSyncInterval(),this._userContext=e,Object(De.c)(),this._parentDataSource=n,this._localContext=r,this._regenerateViews=!0;let s=T.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineDatabaseName();return s=Object(p.a)(s)?T.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineProfileId():s,this._offlineMetadataManager.initialize(t,n,r),this._InitAndLogin(s,e).then(()=>{Ze._LogVerbose("OfflineDataStore.Initialize","Offline data store Initialize completed succesfully"),a.resolve(!0)},e=>{Ze._LogWarning("OfflineDataStore.Initialize","Offline data store Initialize failed with error "+e.get_Message()),a.reject(e)}),a}cleanUpDatabases(e){Ze._LogVerbose("OfflineDataStore.CleanUpDatabases","Offline DataStore CleanUpDatabases started");const t=new D.a,n=c.a.tryCreate(e),r=new fe.a(n,[],""),a=new Ne.a(this._userContext.get_UserId(),this._userContext.get_UserName(),this._userContext.get_UserEmail(),this._userContext.get_userRoles(),this._userContext.get_parentRootRoles(),this._userContext.get_organizationSettings(),this._userContext.get_UserSettings(),this._userContext.get_rolePrivileges(),this._userContext.get_attributePrivileges(),this._userContext.get_serverContext(),this._userContext.get_roleNames(),this._userContext.get_MetadataLastModifiedTime(),this._userContext.get_UserMetadataLastModifiedTime(),this._userContext.get_TransactionCurrencyId(),this._userContext.get_DefaultDashboardId(),this._userContext.get_DefaultHomepageId(),this._userContext.get_DefaultInteractionCentricDashboardId(),this._userContext.get_fullServerVersion(),r,this._userContext.get_externalContext(),this._userContext.get_FCBContext(),this._userContext.get_personalizationSettings(),this._userContext.get_EnvironmentId());return this._clearStore(e,a).then(e=>{Ze._LogVerbose("OfflineDataStore.CleanUpDatabases","Offline DataStore ClearStore succeeded. Status - "+e),t.resolve(!0)},()=>{Ze._LogWarning("CleanUpDatabases.CleanUpDatabases","cleanup database failed for database : "+e),t.reject(o.a.FromMessage("Could not delete database"))}),t}schedulePeriodicSyncJob(e,t){Ze._LogVerbose("OfflineDataStore.SchedulePeriodicSyncJob","Offline DataStore SchedulePeriodicSyncJob started"),window.__UCITestHook.syncCompleteFlag=0;const n=new D.a;return this._StopSync().always(()=>{const r=!T.a.get_DefaultInstance().get_offlineTypescriptInterface().getServerStatus();this._OfflineSync(e,t).always(()=>{n.resolve(!0)}).catch(e=>{Ze._LogWarning("SchedulePeriodicSyncJob.SyncFailed",e.get_Message())}).then(()=>{Ze._LogVerbose("OfflineDataStore.SchedulePeriodicSyncJob","Offline DataStore Immediate sync finished")}),r||T.a.get_DefaultInstance().get_offlineTypescriptInterface().getUpSyncStatus()!==ie.a.Completed||n.resolve(!1)}),n}cancelSync(){Ze._LogVerbose("OfflineDataStore.CancelSync","Offline DataStore CancelSync started");const e=new D.a;return this._StopSync().then(()=>{Ze._LogVerbose("OfflineDataStore.CancelSync","Succesfully cancel all running sync calls"),e.resolve(!0)},t=>{Ze._LogVerbose("OfflineDataStore.CancelSync","Failed to cancel all running sync calls with error "+t.get_Message().toString()),e.reject(t)}),e}_StopSync(){Ze._LogVerbose("OfflineDataStore._StopSync","Offline DataStore StopSync started");const e=new D.a;return Object(p.a)(this._syncJobNode)||this._syncJobNode.completed||this._syncJobNode.cancel(),Object(p.a)(this._timerId)||(window.clearTimeout(this._timerId),this._timerId=Ze._DefaultTimerId),this._get_Plugin().abort(()=>{Ze._LogVerbose("OfflineDataStore._StopSync","Succesfully stopped the all running sync calls"),e.resolve(!0)},()=>{Ze._LogWarning("OfflineDataStore._StopSync","Couldnt stop the running sync call"),e.resolve(!1)},!0),Ze._LogVerbose("OfflineDataStore._StopSync","Offline DataStore StopSync finished"),this._syncJobNode=null,e}applyApplicationMetadataChanges(){Ze._LogVerbose("OfflineDataStore.ApplyApplicationMetadataChanges","Offline DataStore ApplyApplicationMetadataChanges started");const e=new D.a;return this._get_Plugin().applyApplicationMetadataChanges(()=>{Ze._LogVerbose("OfflineDataStore.ApplyApplicationMetadataChanges","Succesfully applied application metadata changes"),e.resolve(!0)},t=>{Ze._LogWarning("OfflineDataStore.ApplyApplicationMetadataChanges","Could not apply application metadata changes"),e.reject(o.a.FromMessage("Failed to Apply Application Metadata changes. Error: "+t))}),Ze._LogVerbose("OfflineDataStore.ApplyApplicationMetadataChanges","Offline DataStore ApplyApplicationMetadataChanges finished"),e}_InitAndLogin(e,t){Ze._LogVerbose("OfflineDataStore._InitAndLogin","Offline DataStore InitAndLogin started");const n=new D.a,r=T.a.get_DefaultInstance().get_applicationStatusProvider().getAuthToken(),a=new xe(e,t,r);return a.checkWhetherLoginParametersChanged(Ze._loginParameters)?(Ze._LogVerbose("InitAndLogin.LoginParameters","UserId:- "+a.get_userId()+" NorsyncServerEndpointHost:- "+a.get_host()+" NorsyncServerPort:- "+a.get_port()+" OfflineDatabasePath:- "+xe.offlineDatabasePath+" ServerDatabaseName :- "+a.get_serverDataBaseName()+" ProfileId:- "+a.get_profileId()+" ModelVersion:- "+xe.modelVersion+" UCISessionId:- "+a.get_sessionId()+" isApplicationMetadataDownloadInShimEnabled:- "+a.get_isApplicationMetadataDownloadInShimEnabled()+" AppId:- "+a.get_appId()+" OfflineResourceStrings:- "+a.get_offlineResourceSrings()),this._set_Plugin(T.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineSyncPlugin(a.get_dataBaseName())),this._get_Plugin().login(a.get_dataBaseName(),a.get_userId(),"",a.get_host(),a.get_port(),xe.offlineDatabasePath,a.get_isSSL(),()=>{Ze._loginParameters=a,Object(p.b)(e)&&T.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(0,X.a.DatabaseUnavailable),Ze._LogVerbose("InitAndLogin.LoginSuccess",a.get_dataBaseName()),n.resolve(!0)},()=>{Ze._LogWarning("InitAndLogin.LoginFailure",a.get_dataBaseName()),n.reject(o.a.FromMessage("Offline Store Initialize Failed"))},a.get_serverDataBaseName(),a.get_profileId(),xe.modelVersion,a.get_authToken(),a.get_subscriptionId(),a.get_sessionId(),a.get_isApplicationMetadataDownloadInShimEnabled(),a.get_appId(),a.get_offlineResourceSrings())):(Ze._LogVerbose("InitAndLogin.LoginSuccess","Already Logged In"),n.resolve(!0)),n}_ScheduleSync(){Ze._LogVerbose("OfflineDataStore._ScheduleSync","Offline DataStore ScheduleSync started"),Object(p.a)(this._syncJobNode)?this._syncJobNode=d.a.schedule(()=>{this._OfflineSync()},d.d,"Norsync Sync"):this._syncJobNode.completed||(Ze._LogVerbose("OfflineDataStore._ScheduleSync","Offline DataStore ScheduleSync priority increased"),this._syncJobNode.priority=d.b)}_initializeUpsyncIfNeeded(e){const t=H.a.get_DefaultInstance().get_Store();return Object(Ye.o)(t.getState())&&!e?this._importDependenciesAndInitializeUpsync():Promise.resolve(!0)}async _importDependenciesAndInitializeUpsync(){const e=H.a.get_DefaultInstance().get_Store();if(!T.a.get_DefaultInstance().get_offlineTypescriptInterface().getServerStatus())return Ze._LogVerbose("Sync.SkipUpsync","Skip upsync due to no network connectivity"),Promise.resolve(!1);const{initializeOfflineUpsyncProcessAsyncAction:t}=await n.e(69).then(n.bind(null,"zmAS"));return Ze._LogVerbose("OfflineDataStore.Sync","Upsync Start"),await e.dispatch(t(!0)),!0}_OfflineSync(e,t){Ze._LogWarning("OfflineDataStore.Sync","Offline DataStore Sync started");const n=ke.a.createEvent(a.c,"DataSource").startStopwatch(),i=H.a.get_DefaultInstance().get_Store(),s=new D.a;this._updateIsForcedSyncState("Forced Sync started",e),T.a.get_DefaultInstance().get_offlineTypescriptInterface().setIsSyncing(!0);const c=T.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineDatabaseName(),l=T.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineProfileId(),u=!!Object(p.b)(c),d=u?l:c;return this._initializeUpsyncIfNeeded(u).then(a=>{this._InitAndLogin(d,this._userContext).then(()=>{if(!a||!this._ShouldStartSyncJob())return s.resolve(!1),this._syncJobNode=null,void T.a.get_DefaultInstance().get_offlineTypescriptInterface().setIsSyncing(!1);const c=[];u&&T.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(Q.a.Initializing,null);const l=T.a.get_DefaultInstance().get_offlineTypescriptInterface().isDssOfflineEnabled();Object(f.a)(c,r.g,l.toString()),Object(f.a)(c,r.h,u.toString()),Object(f.a)(c,r.i,!Object(p.a)(e)),Object(f.a)(c,r.j,Object(Qe.j)(i.getState())),T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Offline Sync Started",c);const g=new Date,h=l?this._GetClientSyncProperties(e):this._GetSyncProperties(),m=T.a.get_DefaultInstance().get_offlineTypescriptInterface().isApplicationMetadataDownloadInShimEnabled(),_=this._offlineMetadataManager.get_clientModelTables();this._get_Plugin().synchronize(Ze._LogSyncProgressMessage,a=>{if(Object(f.a)(c,r.n,a.type),Object(f.a)(c,r.m,a.message),T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Offline DataStore Plugin Synchronize progress",c),m&&"on-application-metadata-download-complete"===a.type){Object(f.a)(c,r.f,m.toString());const e=!0;T.a.get_DefaultInstance().get_offlineTypescriptInterface().setApplyApplicationMetadataChanges(e),Object(f.a)(c,r.b,e.toString()),this._saveBooleanInformationToSessionState(c,Ze._OfflineApplyApplicationMetadataChangesKey,e,"[offlineDataStore] OfflineSync: SaveApplyApplicationMetadataChangesInformationToSessionState.Success","[offlineDataStore] OfflineSync: saveApplyApplicationMetadataChangesInformationToSessionState.Failed"),T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentSuccess("Offline: Application Metadata Download",c),T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentPerformance("Offline: Application Metadata Download","Time Taken in ms",(new Date).getTime()-g.getTime())}else if("on-sync-complete"===a.type){if(this._UpdateOfflineAvailablePrimaryEntities(),T.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineEntityPluralNamesAction(),Object(f.a)(c,r.c,a.dbname),T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Offline DataStore Plugin Synchronize completed",c),this._isRetried=!1,this._retryWaitTime=this._minRetryWaitTime,this._syncJobNode=null,n(),$(window).trigger(Ze._onSyncCompletedEventName),u){T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Initial Sync",c),T.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineDatabaseName(d);const e={};e[Ze._OfflineDatabaseKey]=d,this._parentDataSource.saveSessionState(Ze._OfflineDatabaseKey,e,!1).then(()=>{T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: SaveOfflineDatabaseInformation.Success",c)},e=>{Object(f.a)(c,r.e,e.get_Message()),T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: SaveOfflineDatabaseInformation.Failed",c)}),l||ne.get_defaultInstance().calculateAndStoreMaxDate(null),T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Success",c)}else T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Success",c);l?this._offlineMetadataManager.isDataModelChanged(_).then(n=>{n&&this._HandleDataModelChanged(c),this._CompleteOfflineSync(s,u,n,$e,g,c,e,t)}):this._CompleteOfflineSync(s,u,0,$e,g,c,e,t),T.a.get_DefaultInstance().get_offlineTypescriptInterface().setIsSyncing(!1),window.__UCITestHook.syncCompleteFlag=1,this._ScheduleNextSync()}},n=>{this._syncJobNode=null;let a=0,i="";if(Object(p.a)(n.errorcode)||(a=n.errorcode,Object(p.a)(n.errormessage)||(i=n.errormessage)),Object(f.a)(c,r.m,n.message),Object(f.a)(c,r.n,n.type),Object(f.a)(c,r.l,a.toString()),Object(f.a)(c,r.e,i),T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Received sync failure callback",c),m&&"on-application-metadata-download-complete"===n.type){Object(f.a)(c,r.f,m.toString()),T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Application Metadata Download Complete with Failure",c);const e=!1;T.a.get_DefaultInstance().get_offlineTypescriptInterface().setApplyApplicationMetadataChanges(e),Object(f.a)(c,r.b,e.toString()),this._saveBooleanInformationToSessionState(c,Ze._OfflineApplyApplicationMetadataChangesKey,e,"[offlineDataStore] OfflineSync: SaveApplyApplicationMetadataChangesInformationToSessionState.Success","[offlineDataStore] OfflineSync: saveApplyApplicationMetadataChangesInformationToSessionState.Failed"),T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentFailure("Offline: Application Metadata Download",o.a.FromMessage(n.message)),T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentPerformance("Offline: Application Metadata Download","Time Taken in ms",(new Date).getTime()-g.getTime())}else if("on-sync-complete"===n.type){Object(f.a)(c,r.c,T.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineDatabaseName()),T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Failure",c),n.code===y.sqlSyncUnsupportedNorsyncVersion?T.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(null,X.a.UpgradeClient,a,i):a===Ae.a.InvalidSubscription?T.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(null,X.a.ProfileUnavailable,a,i):T.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineStatusReason()!==X.a.MetadataChanged&&(a===Ae.a.InvalidMetadata?T.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(null,X.a.MetadataChanged,a,i):T.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(null,X.a.SyncFailure,a,i)),this._updateIsForcedSyncState("Forced Sync failed",e),this._updateImmediateOfflineDataSyncState("Immediate offline data sync failed",t),T.a.get_DefaultInstance().get_offlineTypescriptInterface().setIsSyncing(!1),this._RetrySyncAfterFailure();const l=o.a.fromErrorCodeAndMessage(a,i);Object(Ge.a)($e,a,i)?T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentFailure($e,l,"",c):T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentError($e,"[offlineDataStore] OfflineSync: Failure (known allowed error)",c),T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentPerformance($e,"Time Taken in ms",(new Date).getTime()-g.getTime()),s.reject(o.a.FromMessage(n.message)),window.__UCITestHook.syncCompleteFlag=a}},xe.modelVersion,e=>T.a.get_DefaultInstance().get_offlineTypescriptInterface().getMetadataSyncStatus()===w.a.InProgress?(T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Aborting - Returning false for syncing data model changes as metadata sync is in progress",c),!1):(Object(f.a)(c,r.k,e.toString()),this._HandleDataModelChanged(c),!0),h)})},e=>{T.a.get_DefaultInstance().get_offlineTypescriptInterface().setIsSyncing(!1),Ze._LogVerbose("OfflineDataStore._ScheduleSync",Object(h.a)("Offline DataStore ScheduleSync failed with upsync error {0}",e.get_Message())),s.reject(e)}),s}_ScheduleNextSync(){Ze._LogVerbose("Sync.ScheduleNextSync",Object(h.a)("Scheduling next sync to happen in {0} milliseconds.",this._syncIntervalInMilliseconds)),this._timerId=setTimeout(this._ScheduleSync.bind(this),this._syncIntervalInMilliseconds)}_HandleDataModelChanged(e){this._regenerateViews=!0,T.a.get_DefaultInstance().get_offlineTypescriptInterface().setCalculationOfDisabledOfflineEntitiesPending(!0),T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: ModelChanged",e)}createActivityPointerAndAttachmentView(){this._regenerateViews&&this._offlineMetadataManager.retrieveClientModelTables().then(e=>{this._CreateActivityPointerView(e)})}_CompleteOfflineSync(e,t,n,r,a,i,o,s){this._regenerateViews?this._offlineMetadataManager.retrieveClientModelTables().then(e=>{this._CreateActivityPointerView(e)}).always(()=>{T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentSuccess(r,i),T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentPerformance(r,"Time Taken in ms",(new Date).getTime()-a.getTime()),this._OfflineValidations(e,t,n,o,s)}):(T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentSuccess(r,i),T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentPerformance(r,"Time Taken in ms",(new Date).getTime()-a.getTime()),this._OfflineValidations(e,t,n,o,s))}_OfflineValidations(e,t,n,a,i){const o=[];if(t||T.a.get_DefaultInstance().get_offlineTypescriptInterface().getCalculationOfDisabledOfflineEntitiesPending()){const e=this._offlineMetadataManager.calculateDisabledOfflineEntities();o.push(e),e.then(()=>{const e=[];Object(f.a)(e,r.h,t);const n=T.a.get_DefaultInstance().get_offlineTypescriptInterface().isApplicationMetadataDownloadInShimEnabled();Object(f.a)(e,r.f,n);const a=T.a.get_DefaultInstance().get_offlineTypescriptInterface().getApplyApplicationMetadataChanges();Object(f.a)(e,Ze._OfflineApplyApplicationMetadataChangesKey,a),t&&(T.a.get_DefaultInstance().get_offlineTypescriptInterface().setIsOfflineFirstTimeSyncCompleted(t),this._saveBooleanInformationToSessionState(e,Ze._IsOfflineFirstTimeSyncCompletedKey,t,"[offlineDataStore] OfflineSync: SaveIsOfflineFirstTimeSyncCompletedInformation.Success","[offlineDataStore] OfflineSync: SaveIsOfflineFirstTimeSyncCompletedInformation.Failed")),Object(f.a)(e,Ze._IsOfflineFirstTimeSyncCompletedKey,!0),T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Offline Sync.MetadataValidation is completed",e),t&&n?a?(Object(f.a)(e,Ze._OfflineStatus,T.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineStatus()),T.a.get_DefaultInstance().get_offlineTypescriptInterface().triggerFirstTimeRequestToApplyApplicationMetadataChangeNotification(),T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Offline First Time Data Sync is Completed, but application metadata change is not applying or is not successfully applied yet.",e)):(T.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(Q.a.Available,X.a.None),Object(f.a)(e,Ze._OfflineStatus,Q.a.Available),T.a.get_DefaultInstance().get_offlineTypescriptInterface().triggerDisplayForFirstTimeSyncCompleteNotification(),T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Offline Sync Completed toast notification triggered",e)):(T.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(Q.a.Available,X.a.None),Object(f.a)(e,Ze._OfflineStatus,Q.a.Available),T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Foreground application metadata sync - Offline Sync Cycle is completed",e))},e=>{Ze._LogWarning("Sync.MetadataValidation","Error: "+e.get_Message())})}else T.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(Q.a.Available,0);if(T.a.get_DefaultInstance().get_offlineTypescriptInterface().isDssOfflineEnabled())n===v.offlineProfile&&T.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineProfileChanged(!0);else{const e=this._CheckForOfflineProfileChange();if(o.push(e),e.then(e=>{e&&T.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineProfileChanged(!0)}),!t){const e=ne.get_defaultInstance().isFullSyncRequired();o.push(e),e.then(e=>{e&&T.a.get_DefaultInstance().get_offlineTypescriptInterface().setDatabaseCleanUpFlag(!0)},e=>{Ze._LogWarning("Sync.IsFullSyncRequired","Error: "+e.get_Message())})}}return Object(S.a)(o).then(()=>{const t=this._offlineMetadataManager.isServerMetadataSyncRequired();T.a.get_DefaultInstance().get_offlineTypescriptInterface().processOfflineValidationsComplete(),Ze._LogWarning("Sync.OfflineValidation","OfflineSync validation succeeded, sync required is "+t),this._updateIsForcedSyncState("Forced sync completed",Object(p.a)(a)?a:!a,!0),this._updateImmediateOfflineDataSyncState("Immediate offline data sync completed",i),e.resolve(t)},t=>{Ze._LogWarning("Sync.OfflineValidation","OfflineSync validation failed"),this._updateIsForcedSyncState("Forced sync completed",Object(p.a)(a)?a:!a),this._updateImmediateOfflineDataSyncState("Immediate offline data sync completed",i),e.reject(t)}),e}_RetrySyncAfterFailure(){this._isRetried||(this._isRetried=!0,this._retryWaitTime=this._minRetryWaitTime),this._retryWaitTime<this._syncIntervalInMilliseconds&&(window.setTimeout(()=>{Ze._LogVerbose("Sync.Retry","Retrying after failure"),this._ScheduleSync()},this._retryWaitTime),this._retryWaitTime=this._retryMultiplier*this._retryWaitTime)}_CheckForOfflineProfileChange(){Ze._LogVerbose("OfflineDataStore._CheckForOfflineProfileChange","Offline DataStore CheckForOfflineProfileChange started");const e=new D.a,t=[new Y.a(Ze._SystemUserId,T.a.get_DefaultInstance().get_offlineTypescriptInterface().getUserId().toString(),0,0)],n=new j.a(t);return this.retrieveLocalEntities(Ze._SystemUserTableNameInOfflineDB,n).then(t=>{Object(p.a)(t)||!t.rows.length?(Ze._LogWarning("CheckForOfflineProfileChange.NosystemUser","No system user records found in offline db."),e.reject(o.a.FromMessage("No system user records found in offline db."))):!(Ze._MobileOfflineProfileId+O.l+O.y in t.rows.item(0))||Object(p.a)(t.rows.item(0)[Ze._MobileOfflineProfileId+O.l+O.y])||t.rows.item(0)[Ze._MobileOfflineProfileId+O.l+O.y].toString().toLowerCase()!==T.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineProfileId().toLowerCase()?(Ze._LogVerbose("CheckForOfflineProfileChange.Detected","Offline Profile Change detected on offline sync completion"),e.resolve(!0)):e.resolve(!1)},t=>{Ze._LogWarning("CheckForOfflineProfileChange.RetrieveSystemUserFailed",t.get_Message()),e.reject(t)}),e}_ShouldStartSyncJob(){if(T.a.get_DefaultInstance().get_offlineTypescriptInterface().getServerStatus())if(T.a.get_DefaultInstance().get_offlineTypescriptInterface().getMetadataSyncStatus()===w.a.InProgress)Ze._LogVerbose("Sync.NotStarted","Sync not started because metadata sync is in progress.");else{if(T.a.get_DefaultInstance().get_offlineTypescriptInterface().getUpSyncStatus()===ie.a.Completed)return!0;Ze._LogVerbose("Sync.NotStarted","Sync not started because upsync is not yet completed.")}else Ze._LogVerbose("Sync.NotStarted","Sync not started due to no network connectivity");return!1}_updateIsForcedSyncState(e,t,n){if(!Object(p.a)(t)){const r=H.a.get_DefaultInstance().get_Store();if(!Object(Qe.i)(r.getState())&&t)Ze._LogWarning("OfflineDataStore.Sync","Offline DataStore Sync "+e),r.dispatch(Object(Ke.e)(t));else if(Object(Qe.i)(r.getState())&&!t&&(Ze._LogWarning("OfflineDataStore.Sync","Offline DataStore Sync "+e),r.dispatch(Object(Ke.e)(t)),n)){const e=Object(Qe.f)(r.getState());e&&r.dispatch(Object(Je.b)(!0)),r.dispatch(Object(Xe.e)(e))}}}_updateImmediateOfflineDataSyncState(e,t){const n=H.a.get_DefaultInstance().get_Store();t&&t.length>0&&(Ze._LogWarning("OfflineDataStore.Sync","Offline DataStore Sync "+e),Object(Qe.j)(n.getState())&&(n.dispatch(Object(Ke.f)(!1)),Object(Ke.d)()))}_GetSyncProperties(){const e=Object(Le.z)(H.a.get_DefaultInstance().get_UserContext()),t=H.a.get_DefaultInstance().get_UserContext().get_TimeZoneAdjusters(),n=Object(Le.o)(e,Object(Le.I)(t)),r=new Date(e.getTime()+n),a=this._userContext.get_TimeZoneUtcOffsetMinutes()*se.i,i={};return i.$_NORSYNC_CURRENT_TIME=String.format("'{0}-{1:D2}-{2:D2} {3:D2}:{4:D2}:{5:D2}.{6:D3}'",r.getFullYear(),r.getMonth()+1,r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),i.$_NORSYNC_TIMEZONE_OFFSET=a.toString(),i.$_NORSYNC_DST_ADJUSTMENT=n.toString(),i}_GetClientSyncProperties(e,t){const n=T.a.get_DefaultInstance().get_offlineTypescriptInterface().isUCIOfflineSyncAdaptivePagingEnabled(),r={};return r.IsUCIOfflineSyncAdaptivePagingEnabled=n.toString(),r.IsForcedSync=e?"true":"false",r.ImmediateOfflineDataSyncEntities=t&&t.length>0?JSON.stringify(t):JSON.stringify([]),r}_GetNonCrmTables(){const e={};return e[q.m]=q.i,e[q.o]=q.g,e[q.b]=q.a,e}cache(e,t){if(T.a.get_DefaultInstance().get_offlineTypescriptInterface().getUpSyncStatus()!==ie.a.Completed)return;const n=[];n.push(this._CacheCreateOrUpdateQueryIfExists(e,t));const r=e.get_globalNavigationData();!Object(p.a)(r)&&"bpfDefinitionVersionNumber"in r.fields&&delete r.fields.bpfDefinitionVersionNumber,!Object(p.a)(r)&&ye.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(r.get_identifier().LogicalName)&&n.push(this._CacheCreateOrUpdateQueryIfExists(r,t)),Object(S.a)(n).then(t=>{this._ExecuteQueriesInTransaction(t).then(()=>{Ze._LogVerbose("OfflineDataStore.Cache.Success",e.get_identifier().toString())})},t=>{Ze._LogWarning("OfflineDataStore.Cache.SqlPreparationFailure",e.get_identifier().toString()+" - "+t.get_Message())})}_CacheCreateOrUpdateQueryIfExists(e,t){const n=new D.a;return H.a.get_DefaultInstance().retrieveEntityMetadata(e.get_identifier().LogicalName,null).then(r=>{Object(p.a)(e.get_identifier().Id)||H.a.get_DefaultInstance().getAttributeTypes(e.get_identifier().LogicalName,null,t).then(a=>{const i=e.get_fieldTypes();for(const e in i)"unknown"===i[e]&&(i[e]=a[e]);this._DoesRecordExistsInOffline(e.get_identifier(),r.get_primaryIdAttribute()).then(a=>{let i;if(a){const n=e.fields;for(const t in n){const r={key:t,value:n[t]};e.get_changedFieldNames().push(r.key)}i=this._UpdateInternal(e.get_identifier(),e,!0,t,!0)}else i=this._CreateInternal(e,!0,r,e.get_identifier().Id);i.then(e=>{n.resolve(e)},e=>{n.reject(e)})},t=>{Ze._LogWarning("OfflineDataStore.Cache.CheckForRecordFailure",e.get_identifier().toString()+" - "+t)})},t=>{Ze._LogWarning("OfflineDataStore.Cache.GetAttributeTypes.Failure",e.get_identifier().toString()+" - "+t.get_Message())})},t=>{Ze._LogWarning("OfflineDataStore.Cache.RetrieveEntityMetadata.Failure",e.get_identifier().toString()+" - "+t.get_Message())}),n}_DoesRecordExistsInOffline(e,t){const n=new D.a,r=K.get_instance().generateExistsQuery(e,t),a=[e.Id.toString()];return this._plugin.transaction(t=>{t.executeSql(r,a,(e,t)=>{if(Object(p.a)(t.rows)||1!==t.rows.length)return void n.reject("OfflineDataStore.Cache._DoesRecordExistsInOffline Only one record should be returned");const r=t.rows.item(0);let a=!1;for(const e in r){a={key:e,value:r[e]}.value}n.resolve(a)},(t,r)=>{Ze._LogWarning("OfflineDataStore.Cache._SqlExecutionFailure",`${e.toString()} - ${t}`),n.reject(t)})},(t,r)=>{Ze._LogWarning("OfflineDataStore.Cache._TransactionFailure",`${e.toString()} - ${r}`),n.reject(r)},null),n}_RemoveDisassociateRequests(e){const t=e.get_requests();for(let e=t.length-1;e>=0;e--)t[e]instanceof Oe.a&&t.splice(e,1);return 1===t.length?t[0]:e}execute(e,t){const n=new D.a;Ze._LogVerbose("OfflineDataStore.Execute","Offline DataStore Execute started");const r=e instanceof Ce.a?this._RemoveDisassociateRequests(e):e;return r instanceof Se.a?(Ze._LogVerbose("OfflineDataStore.Execute","This looks like a create request. Calling Offline.Create"),this.create(r.get_target(),r.get_suppressDuplicateDetection(),t).then(e=>{const t=new we.a(e.Id);t.set_entityReference(e),Ze._LogVerbose("OfflineDataStore.Execute","Create completed succesfully: "+e.toString()),n.resolve(t)},e=>{Ze._LogWarning("OfflineDataStore.Execute.Fail","Create request failed with error "+e.get_Message()),n.reject(e)})):r instanceof Ie.a?(Ze._LogVerbose("OfflineDataStore.Execute","This looks like a update request. Calling Offline.Update"),this.update(r.get_target().get_actionableIdentifier(),r.get_target(),r.get_suppressDuplicateDetection(),t).then(e=>{const t=new Te.a(e);Ze._LogVerbose("OfflineDataStore.Execute","Update completed succesfully: "+e.toString()),n.resolve(t)},e=>{Ze._LogWarning("OfflineDataStore.Execute.Fail","Update request failed with error "+e.get_Message()),n.reject(e)})):r instanceof Ce.a?(Ze._LogVerbose("OfflineDataStore.Execute","This looks like a ExecuteMultipleRequest request. Calling Offline._ExecuteMultipleRequest"),this._ExecuteMultiple(r,t).then(e=>{const t=new Array(0);for(let n=0;n<e.length;n++){Ze._LogVerbose("OfflineDataStore.Execute",`ExecuteMultipleRequest adding ${e[n].toString()} to ExecuteMultiple request`);const r=new Te.a(e[n]);t.push(new he.a(null,n,r))}Ze._LogVerbose("OfflineDataStore.Execute","ExecuteMultipleRequest completed succesfully");const r=new je.a(!1,t);n.resolve(r)},e=>{Ze._LogWarning("OfflineDataStore.Execute.Fail","ExecuteMultipleRequest request failed with error "+e.get_Message()),n.reject(e)})):r instanceof Ee.a?(Ze._LogVerbose("OfflineDataStore.Execute","This looks like a quick find request. Calling Offline.QuickFind"),this.quickFind(r.get_searchText(),r.get_entityNames()[0],t).then(e=>{Ze._LogVerbose("OfflineDataStore.Execute","Quick find completed succesfully");const t=[e];n.resolve(new Pe.a(be.a.createFromEntities(t)))},e=>{Ze._LogWarning("OfflineDataStore.Execute.Fail","Quick find request failed with error "+e.get_Message()),n.reject(e)})):(Ze._LogWarning("OfflineDataStore.Execute.Fail","This request is not supported in offline."),n.reject(o.a.FromMessage("The provided request is not supported in offline"))),n}quickFind(e,t,n){const r=new D.a,a=new _e.a(u.a.savedView,s.a.Desktop,t,0,!1,null,l.a.quickFindSearch);return H.a.get_DefaultInstance().retrieveMultipleApplicationMetadata(a,n).then(a=>{if(a.length){const i=a[0].getDescriptor();let s=null,c=null,l=null;i&&"OfflineSqlQuery"in i&&(s="string"==typeof i.OfflineSqlQuery?i.OfflineSqlQuery:null),i&&"ViewId"in i&&(c="string"==typeof i.ViewId?i.ViewId:null),i&&"FetchXml"in i&&(l="string"==typeof i.FetchXml?i.FetchXml:null);const u=new de.a;u.updateDescriptorSet(ue.a.Sql,s);const d=new ve.a(u,e,[t],c);s=d.get_sql(H.a.get_DefaultInstance().get_UserContext()),d.set_FetchXml(l),Object(p.b)(s)?(Ze._LogWarning("OfflineDataStore.QuickFind.Fail","Quick find sql not available for offline"),r.reject(o.a.fromErrorCode(-2147093989))):(Ze._LogVerbose("OfflineDataStore.QuickFind","Updated sql query: "+s),H.a.get_DefaultInstance().retrieveMultiple(d,new le.a(ce.a.NotCached,0),n).then(e=>{Ze._LogVerbose("OfflineDataStore.QuickFind","QuickFind succeeded"),r.resolve(new me.a(t,e,0))},e=>{Ze._LogWarning("OfflineDataStore.QuickFind.Fail",e.get_Message()),r.reject(e)}))}else Ze._LogWarning("OfflineDataStore.QuickFind.Fail","Quick find view not available for offline"),r.reject(o.a.fromErrorCode(-2147093989))},e=>{Ze._LogWarning("OfflineDataStore.QuickFind.Fail",e.get_Message()),r.reject(e)}),r}create(e,t,n,r){Ze._LogVerboseWithEntityName("OfflineDataStore.Create","Create started","Create",e.get_identifier());const a=new D.a;return r=!Object(p.a)(r)&&r,H.a.get_DefaultInstance().retrieveEntityMetadata(e.get_identifier().LogicalName,null).then(t=>{const n=t,i=Object(p.a)(e.get_identifier().Id)||e.get_identifier().Id.equals(c.a.get_empty())?Object(p.a)(e.fields[n.get_primaryIdAttribute()])?c.a.newGuid():e.fields[n.get_primaryIdAttribute()]:e.get_identifier().Id;this._CreateInternal(e,r,n,i,!0).then(t=>{this._get_Plugin().transaction(n=>{const r=[];this._UpdateAndExecuteQueries(n,r,t),Object(S.a)(r).then(t=>{e.get_identifier().Id=i,Ze._LogVerboseWithEntityName("OfflineDataStore.Create","Create succeeded","Create",e.get_identifier()),a.resolve(e.get_identifier())},t=>{Ze._LogVerboseWithEntityName("OfflineDataStore.Create.Fail",t.get_Message(),"Create",e.get_identifier()),a.reject(t)})},Ze._TransactionFailure(a,"Create"),null)},t=>{Ze._LogVerboseWithEntityName("OfflineDataStore.Create.Fail",t.get_Message(),"Create",e.get_identifier()),a.reject(t)})},t=>{Ze._LogVerboseWithEntityName("OfflineDataStore._Create.Fail, Cannot retrieve entity metadata",t.get_Message(),"Create",e.get_identifier()),a.reject(t)}),a}_CreateUpSyncTransactionLog(e,t){const n=new D.a;if(t)n.resolve();else{const t=[],r=e?q.G:q.H;t.push(new ze(K.get_instance().generateInsertForUpSyncTransactionLog(),[r,q.p],"Transaction.Create")),n.resolve(t)}return n}_ExecuteQueriesInTransaction(e){const t=new D.a;return this._get_Plugin().transaction(n=>{const r=[];e.forEach(e=>{this._UpdateAndExecuteQueries(n,r,e)}),Object(S.a)(r).then(e=>{t.resolve(e)},e=>{Ze._LogWarning("OfflineDataStore._ExecuteQueriesInTransaction.Fail",e.get_Message()),t.reject(e)})},Ze._TransactionFailure(t,"ExecuteQueriesInTransaction"),null),t}_UpdateAndExecuteQueries(e,t,n){for(let r=0;r<n.length;r++){const a=n[r],i=a.Query.replace(new RegExp(Ze._activityPartyMarkerRegex),"");t.push(this._ExecuteInternal(e,i,a.FieldValues))}}_GetEntityIdAttributeFromBpfEntity(e,t){const n=new D.a;return H.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(new N.a(e),null).then(e=>{let r=null;const a=[];a.push("createdby"),a.push("modifiedby"),a.push("createdonbehalfbyname"),a.push("modifiedonbehalfbyname");for(const n of e){const e=n;if(!(a.indexOf(e.get_logicalName())>=0)&&("lookup"===e.get_type()&&!Object(p.a)(e.get_targets())&&1===e.get_targets().length&&e.get_targets()[0]===t)){if(!e.get_isCustomAttribute()){r=e;break}e.get_logicalName().startsWith("bpf_")&&(Object(p.a)(r)||r.get_columnNumber()>e.get_columnNumber())&&(r=e)}}Object(p.a)(r)?n.reject(o.a.FromMessage("OfflineDataStore.getEntityIdAttributeFromBpfEntity.Fail : Cannot find an attribute that matches the lookup target in the entity ")):n.resolve(r.get_logicalName())},t=>{Ze._LogVerbose("OfflineDataStore.getEntityIdAttributeFromBpfEntity.Fail"," Cannot fetch attribute metadata for "+e),n.reject(t)}),n}_CreateInternal(e,t,n,r,a){const i=new D.a;if(Object(p.a)(e.get_identifier())&&(Ze._LogWarning("OfflineDataStore.Create.Fail","Entity Record Identifier cannot be null"),i.reject(o.a.FromMessage("Entity Record Identifier cannot be null"))),a=!Object(p.a)(a)&&a){const a=new Se.a(e);T.a.get_DefaultInstance().get_offlineTypescriptInterface().createCustomOfflineCommandQueries(a,e.get_identifier().LogicalName,r).then(a=>{Object(p.a)(a)?this._DoCreateInternal(i,e,t,n,r):i.resolve(this._PrepareFinalQueryList(a,t))},e=>{Ze._LogWarning("OfflineDataStore.Create.CreateCustomOfflineCommandQueries.Fail",e.get_Message()),i.reject(e)})}else this._DoCreateInternal(i,e,t,n,r);return i}_DoCreateInternal(e,t,n,r,a){const i=[];k.a.getOfflineQueryDataObject(t,ae.a.create,r.get_primaryIdAttribute(),a,r,this._userContext).then(o=>{if(i.push(new ze(K.get_instance().generateInsertQuery(t.get_identifier(),o.get_columns()),o.get_values(),"Transaction.Create")),r.get_isActivity()&&!Object(p.a)(o.get_partiesToCreate())){t.get_identifier().Id=a;let e=0;for(const t of o.get_partiesToCreate()){const n=Ze._activityPartyMarker+e+K.get_instance().generateInsertQuery(t[O.t],t[O.m]);i.push(new ze(n,t[O.ab],"Transaction.Create")),e++}}e.resolve(this._PrepareFinalQueryList(i,n))},t=>{Ze._LogWarning("OfflineDataStore.Create.GetOfflineQueryDataObject.Fail",t.get_Message()),e.reject(t)})}_PrepareFinalQueryList(e,t,n){const r=[];if(t&&(Ze._LogVerbose("OfflineDataStore.PrepareFinalQuerySet","called with triggers suppressed"),r.push(new ze(K.get_instance().generateSuppressTriggerQuery(),null,"Transaction.SuppressTrigger.Failed"))),!Object(p.a)(n))for(let e=0;e<n.length;e++)r.push(n[e]);for(let t=0;t<e.length;t++)r.push(e[t]);return t&&r.push(new ze(K.get_instance().generateUnsuppressTriggerQuery(),null,"Transaction.UnSuppressTrigger.Failed")),r}executeTransaction(e){Ze._LogVerbose("OfflineDataStore.ExecuteTransaction","Offline DataStore ExecuteTransaction started");const t=new D.a,n=e.get_txList(),r=e.get_supppressTrigger();return this.prepareTransactionQueries(e).then(e=>{this._ExecuteTransactionInternal(r,e,n,t)},e=>{Ze._LogWarning("OfflineDataStore.ExecuteTransaction.Fail",e.get_Message()),t.reject(e)}),t}prepareTransactionQueries(e){const t=new D.a,n=e.get_txList(),r=e.get_supppressTrigger();return this.generateUID().then(e=>{const a=[];r&&a.push(new ze(K.get_instance().generateSuppressTriggerQuery(),null,"Transaction.SuppressTrigger.Failed"));const i=[];for(let t=0;t<n.length;t++){const r=Object(p.a)(n[t].filter)?null:n[t].filter.get_filterCriteria(),o=new Z(n[t].values,r);let s="";if(o.get_fields().length>0||n[t].operationType===J.a)switch(n[t].operationType){case J.b:s=K.get_instance().generateInsertQuery(new ge.a(n[t].tableName,e),o.get_fields()),a.push(new ze(s,o.get_fieldValue(),"Transaction.Create"));break;case J.a:s=K.get_instance().generateDeleteQuery(new ge.a(n[t].tableName,e),n[t].filter),a.push(new ze(s,o.get_fieldValue(),"Transaction.Delete"));break;case J.d:let r="";const c=this._GetNonCrmTables();if(n[t].tableName in c&&!Object(p.a)(c[n[t].tableName])){r=c[n[t].tableName].toString();const i=this._GenerateUpdateQuery(n[t],o,e,r);a.push(new ze(i.query,i.fieldValue,"Transaction.Update"))}else{const r=n[t].tableName.startsWith(q.A)?n[t].tableName.replace(q.A,""):n[t].tableName;i.push(this._GetUpdateQueryFromMetadata(n[t],o,e,r))}}}i.length<=0?t.resolve(a):Object(S.a)(i).then(e=>{for(const t of e)a.push(new ze(t.query,t.fieldValue,"Transaction.Update"));t.resolve(a)},e=>{Ze._LogWarning("OfflineDataStore.ExecuteTransaction.Fail",e.get_Message()),t.reject(e)})},e=>{Ze._LogWarning("OfflineDataStore.ExecuteTransaction._plugin.Transaction",e.get_Message()),t.reject(e)}),t}_GetUpdateQueryFromMetadata(e,t,n,r){const a=new D.a;return H.a.get_DefaultInstance().retrieveEntityMetadata(r,null).then(r=>{a.resolve(this._GenerateUpdateQuery(e,t,n,r.get_primaryIdAttribute()))},e=>{a.reject(e)}),a}_GenerateUpdateQuery(e,t,n,r){const a=[];let i=null;const o=new Array(0);let s=-1;for(let e=0;e<t.get_fields().length;e++)t.get_fields()[e].toString()!==r?(o[o.length]=t.get_fields()[e].toString(),a.push(t.get_fieldValue()[e])):s=e;-1!==s&&a.push(t.get_fieldValue()[s]),i=K.get_instance().generateUpdateQuery(new ge.a(e.tableName,n),o,r);const c={};return c.query=i,c.fieldValue=a,c}_ExecuteTransactionInternal(e,t,n,r){const a=new D.a;e&&t.push(new ze(K.get_instance().generateUnsuppressTriggerQuery(),null,"Transaction.UnSuppressTrigger.Failed")),this._plugin.transaction(r=>{Ze._LogVerbose("OfflineDataStore.ExecuteTransaction._plugin.Transaction","Succeeded");const i=e?n.length+2:n.length;for(let e=0;e<i;e++){const n=t[e];r.executeSql(n.Query,n.FieldValues,null,Ze._SqlExecutionFailure(a,n.ErrorMessage))}},Ze._TransactionFailure(r,"Transaction failed!"),()=>{r.resolve(!0)})}generateUID(){Ze._LogVerbose("OfflineDataStore.GenerateUID","Offline DataStore GenerateUID started");const e=new D.a;return this._get_Plugin().generateUUID(t=>{const n=c.a.tryCreate(t);n.equals(c.a.get_empty())?(Ze._LogWarning("OfflineDataStore.GenerateUID","Invalid GUID returned from generateUUID: "+t),e.reject(o.a.FromMessage("Invalid GUID generated"))):(Ze._LogVerbose("OfflineDataStore.GenerateUID","Generated GUID - "+n),e.resolve(n))},()=>{Ze._LogWarning("OfflineDataStore.GenerateUID","Unknown error generating the UUID"),e.reject()}),e}retrieveLocalEntities(e,t){return this._retrieveLocalEntitiesWithOrder(e,t,null,!1)}_retrieveLocalEntitiesWithOrder(e,t,n,r){const a=t,i=Object(p.a)(a)?null:a.get_filterCriteria();Ze._LogVerbose("OfflineDataStore.RetrieveLocalEntitiesWithOrder","Offline DataStore RetrieveLocalEntitiesWithOrder started");const s=new D.a,c=[];if(!Object(p.a)(i))for(let e=0;e<i.length;e++)if(i[e].get_condition()===V.a.In){const t=i[e].get_value();for(let e=0;e<t.length;e++)c.push(t[e])}else i[e].get_condition()!==V.a.IsNull&&c.push(i[e].get_value());const l=K.get_instance().generateRetrieveQueryWithConditions(e,a,n,r);return this._get_Plugin().transaction(e=>{e.executeSql(l,c,(e,t)=>{Ze._LogVerbose("OfflineDataStore.RetrieveLocalEntitiesWithOrder.Plugin.Transaction","RetrieveLocalEntitiesWithOrder succeeded"),s.resolve(t)},Ze._SqlExecutionFailure(s,"Retrieve_DAL"))},Ze._TransactionFailure(s,"Retrieve_Dal"),()=>{s.reject(o.a.FromMessage("No records found"))}),s}_RetrieveBPFUniqueNames(e,t){const n=new D.a;if(Object(p.a)(e))return n.resolve(null),n;if(null!==e.get_processId()&&!e.get_processId().Id.equals(c.a.get_empty()))return this._RetrieveBPFUniqueNameByProcessId(e.get_processId().Id,t).then(t=>{Object(p.b)(t)?(Ze._LogWarning("OfflineDataStore.RetrieveBPFUniqueNames.Success","Not found uniquename for BPF "+e.get_processId().toString()),n.resolve(null)):(Ze._LogVerbose("OfflineDataStore.RetrieveBPFUniqueNames.Success","Successfully retrieve uniquename for BPF "+e.get_processId().toString()),n.resolve([t]))},t=>{Ze._LogWarning("OfflineDataStore.RetrieveBPFUniqueNames.Fail","Error to RetrieveBPFUniqueNameByProcessId for BPF "+e.get_processId().toString()+". "+t.get_Message()),n.reject(t)}),n;if(Object(p.a)(e.get_target())||Object(p.b)(e.get_target().LogicalName))return Ze._LogWarning("OfflineDataStore.RetrieveBPFUniqueNames.Fail","Assert: Target must participating entity logical name. "+this._GetLogStringForRetrieveProcessControlRequest(e)),n.resolve(null),n;const r=T.a.get_DefaultInstance().get_offlineTypescriptInterface().getCurrentAppId(),a=new Be.a("bpfselector",null,e.get_target().LogicalName,null,[],!1,Ue.a.OnDemandWithContext,null,null,new c.a(r));return H.a.get_DefaultInstance().getClientMetadata(a,Ve.a.Local,t).then(t=>{if("BPFSelectors"in t){const r=t.BPFSelectors[0];if(!Object(p.a)(r)&&"SelectorItems"in r){const t=r.SelectorItems;if(!Object(p.a)(t)&&t.length>0){const r=t.map(e=>e.UniqueName);Ze._LogVerbose("OfflineDataStore.RetrieveBPFUniqueNames.Success","Successfully retrieve all BPF uniquenames for participating entity "+e.get_target().LogicalName),n.resolve(r)}}}n.resolve(null)},t=>{Ze._LogWarning("OfflineDataStore.RetrieveBPFUniqueNames.Warn","Error to GetClientMetadata for participating entity "+e.get_target().LogicalName+". "+t.get_Message()),n.resolve(null)}),n}_RetrieveBPFUniqueNameByProcessId(e,t){const n=new D.a,r=new Be.a("businessprocessflow",null,"workflow",e,[],!1,Ue.a.OnDemandWithContext,null,null,null);return H.a.get_DefaultInstance().getClientMetadata(r,Ve.a.Local,t).then(t=>{let r=null;if("BusinessProcessFlowMetadata"in t){const e=t.BusinessProcessFlowMetadata[0];!Object(p.a)(e)&&"BusinessProcessFlowUniqueName"in e&&(r=e.BusinessProcessFlowUniqueName)}Ze._LogVerbose("OfflineDataStore.RetrieveBPFUniqueNameByProcessId.Success","Successfully retrieve uniquename for BPF "+e.toString()),n.resolve(r)},t=>{Ze._LogWarning("OfflineDataStore.RetrieveBPFUniqueNameByProcessId.Warn","Error to GetClientMetadata for process "+e.toString()+". "+t.get_Message()),n.resolve(null)}),n}_ConstructBpfRecord(e,t,n,r){const a=new D.a;return H.a.get_DefaultInstance().retrieveEntityMetadata(t,r).then(i=>{H.a.get_DefaultInstance().getAttributeTypes(t,null,r).then(r=>{Object(De.a)(e,r,i,n).then(e=>{Ze._LogVerbose("OfflineDataStore._ConstructBpfRecord.Success","Successfully constructed Bpf record for "+t),a.resolve(e)},e=>{Ze._LogWarning("OfflineDataStore._ConstructBpfRecord.Fail","Error to CreateEntityRecord for "+t+". "+e.get_Message()),a.reject(e)})},e=>{Ze._LogWarning("OfflineDataStore._ConstructBpfRecord.Fail","Error to GetAttributeTypes for "+t+". "+e.get_Message()),a.reject(e)})},e=>{Ze._LogWarning("OfflineDataStore._ConstructBpfRecord.Fail","Error to RetrieveEntityMetadata for "+t+". "+e.get_Message()),a.reject(e)}),a}_RetrieveBpfInstanceRecordByProcess(e,t,n,r){const a=new D.a;return this._GetEntityIdAttributeFromBpfEntity(t,e.LogicalName).then(i=>{const o=new j.a([new Y.a(i+"!id",e.Id.toString(),z.a.Or,0)],1);this._retrieveLocalEntitiesWithOrder(t,o,"modifiedon",!1).then(i=>{!Object(p.a)(i.rows)&&i.rows.length>0?(Ze._LogVerbose("OfflineDataStore._RetrieveBpfInstanceRecordByProcess.Success","Data present for "+t),this._ConstructBpfRecord(i.rows.item(0),t,n,r).then(e=>{Ze._LogVerbose("OfflineDataStore._RetrieveBpfInstanceRecordByProcess.Success","Record created for "+t),a.resolve(e)},n=>{Ze._LogWarning("OfflineDataStore._RetrieveBpfInstanceRecordByProcess.Fail","Error to ConstructBpfRecord for BPF entity "+t+" and participating entity "+e.LogicalName+". "+n.get_Message()),a.resolve(null)})):(Ze._LogVerbose("OfflineDataStore._RetrieveBpfInstanceRecordByProcess.Success","No BPF instance found for "+t),a.resolve(null))},n=>{Ze._LogWarning("OfflineDataStore._RetrieveBpfInstanceRecordByProcess.Fail","Error to RetrieveLocalEntitiesWithOrder for BPF entity "+t+" and participating entity "+e.LogicalName+". "+n.get_Message()),a.resolve(null)})},n=>{Ze._LogWarning("OfflineDataStore.RetrieveBpfInstanceRecordByProcess.Fail","Error to GetEntityIdAttributeFromBpfEntity for BPF entity "+t+" and participating entity "+e.LogicalName+". "+n.get_Message()),a.resolve(null)}),a}_RetrieveBpfInstanceRecordById(e,t,n,r){const a=new D.a,i=new j.a([new Y.a("businessprocessflowinstanceid",e.toString(),z.a.Or,V.a.Equals)]);return this.retrieveLocalEntities(t,i).then(i=>{!Object(p.a)(i.rows)&&i.rows.length>0?(Ze._LogVerbose("OfflineDataStore.RetrieveBpfInstanceRecordById.Success","Data present for "+t),this._ConstructBpfRecord(i.rows.item(0),t,n,r).then(e=>{Ze._LogVerbose("OfflineDataStore.RetrieveBpfInstanceRecordById.Success","Record created for "+t),a.resolve(e)},e=>{Ze._LogWarning("OfflineDataStore.RetrieveBpfInstanceRecordById.Fail","Error to ConstructBpfRecord for BPF entity "+t+". "+e.get_Message()),a.resolve(null)})):(Ze._LogVerbose("OfflineDataStore.RetrieveBpfInstanceRecordById.Success","No BPF instance found for "+t+" with instance id "+e.toString()),a.resolve(null))},e=>{Ze._LogWarning("OfflineDataStore._RetrieveBpfInstanceRecordById.Fail","Error to RetrieveLocalEntities for BPF entity "+t+". "+e.get_Message()),a.resolve(null)}),a}_GetLogStringForRetrieveProcessControlRequest(e){let t="";return Object(p.a)(e)||(Object(p.a)(e.get_target())?Object(p.a)(e.get_processId())?Object(p.a)(e.get_processInstanceId())||(t+=", BPF Instance "+e.get_processInstanceId().Id.toString()):t+=", BPF Process "+e.get_processId().Id.toString():t="Participating entity "+e.get_target().LogicalName),t}_RetrieveGlobalNavigationDataRecord(e,t,n,r){const a=new D.a,i=this._userContext.get_FCBContext().EnableBPFOffline;return Object(p.a)(i)||!i.get_value()||!t||Object(p.a)(e)?(a.resolve(null),a):(this._RetrieveBPFUniqueNames(e,r).then(t=>{if(Object(p.a)(t)||!t.length)return void a.resolve(null);const i=[];null===e.get_processId()||e.get_processId().Id.equals(c.a.get_empty())||null===e.get_processInstanceId()||e.get_processInstanceId().Id.equals(c.a.get_empty())?t.forEach(t=>{i.push(this._RetrieveBpfInstanceRecordByProcess(e.get_target(),t,n,r)),Ze._LogVerbose("OfflineDataStore.RetrieveGlobalNavigationDataRecord.Info","Retrieve multiple BPF instances. "+this._GetLogStringForRetrieveProcessControlRequest(e))}):(i.push(this._RetrieveBpfInstanceRecordById(e.get_processInstanceId().Id,t[0],n,r)),Ze._LogVerbose("OfflineDataStore.RetrieveGlobalNavigationDataRecord.Info","Retrieve BPF instance from "+t[0]+". "+this._GetLogStringForRetrieveProcessControlRequest(e))),Object(S.a)(i).then(t=>{let n=null,r=null;t.forEach(e=>{if(null!==e){const t=e.getValue("modifiedon");(null===r||t>r)&&(n=e,r=t)}}),Ze._LogVerbose("OfflineDataStore.RetrieveGlobalNavigationDataRecord.Success","Retrieve multiple BPF instances. "+this._GetLogStringForRetrieveProcessControlRequest(e)),a.resolve(n)},t=>{Ze._LogWarning("OfflineDataStore.RetrieveGlobalNavigationDataRecord.Fail","Errot to RetrieveBpfInstanceRecord. "+this._GetLogStringForRetrieveProcessControlRequest(e)+". "+t.Message),a.resolve(null)})},t=>{Ze._LogWarning("OfflineDataStore.RetrieveGlobalNavigationDataRecord.Fail","Errot to RetrieveBPFUniqueNames. "+this._GetLogStringForRetrieveProcessControlRequest(e)+". "+t.get_Message()),a.resolve(null)}),a)}retrieve(e,t,n,r,a){const i=new D.a;return Ze._LogVerboseWithEntityName("OfflineDataStore.Retrieve",e.get_key()+".Retrieve Started","Retrieve",e),H.a.get_DefaultInstance().retrieveEntityMetadata(e.LogicalName,r).then(s=>{const l=s;let u=t instanceof oe.a?t.get_Columns():null;u=this._AddRequiredAttributes(l,u),this._RetrieveGlobalNavigationDataRecord(a,l.get_isBusinessProcessEnabled(),n,r).then(a=>{const s=Object(p.a)(a)?null:a.getValue("processid"),d=Object(p.a)(s)||!Object(p.a)(s)&&s.Id.equals(c.a.get_empty())?null:s.Id;T.a.get_DefaultInstance().get_offlineTypescriptInterface().getBusinessProcessFlowControlData(d,e.LogicalName).then(s=>{if(!Object(p.a)(s)&&s.length)for(const e of s)-1===u.indexOf(e)&&u.push(e);H.a.get_DefaultInstance().getAttributeTypes(e.LogicalName,u,r).then(s=>{Ze._LogVerbose("OfflineDataStore.Retrieve.GetAttributeTypes","GetAttributeTypes succeeded");const c=this._GetPhysicalFieldsForQuery(s,r),u=K.get_instance().generateRetrieveQuery(e,c,l.get_primaryIdAttribute()),d=[e.Id.toString().toUpperCase()];this._get_Plugin().transaction(c=>{c.executeSql(u,d,(c,u)=>{Object(p.a)(u.rows)||!u.rows.length?(Ze._LogVerboseWithEntityName("OfflineDataStore.Retrieve.NoRecordsFound",e.get_key(),"Retrieve",e),i.reject(o.a.FromMessage("No records found"))):this._getEntityRecordFromSQLResult(e,t,u.rows.item(0),l,s,n).then(t=>{l.get_isBusinessProcessEnabled()&&!Object(p.a)(a)&&t.set_globalNavigationData(a),l.get_isActivity()?(Ze._LogVerbose("OfflineDataStore.Retrieve","Entity metadata is activity"),this._FillActivityParty(t,s,n,r).then(t=>{Ze._LogVerbose("OfflineDataStore.Retrieve._FillActivityParty","Succeeded"),Ze._LogVerboseWithEntityName("OfflineDataStore.Retrieve","Retrieve Succeeded","Retrieve",e),i.resolve(t)},e=>{Ze._LogWarning("OfflineDataStore.Retrieve._FillActivityParty",e.get_Message()),i.reject(e)})):(Ze._LogVerbose("OfflineDataStore.Retrieve","Entity metadata is not activity"),Ze._LogVerboseWithEntityName("OfflineDataStore.Retrieve","Retrieve Succeeded","Retrieve",e),i.resolve(t))},t=>{Ze._LogVerboseWithEntityName("OfflineDataStore.Retrieve.CreateEntityRecord.Failure",t.get_Message(),"Retrieve",e),i.reject(t)})},Ze._SqlExecutionFailure(i,"Retrieve"+e.get_key()))},Ze._TransactionFailure(i,"Retrieve"+e.get_key()),null)},t=>{Ze._LogVerboseWithEntityName("OfflineDataStore.Retrieve.GetAttributeTypes.Failure",t.get_Message(),"Retrieve",e),i.reject(t)})},t=>{Ze._LogVerboseWithEntityName("OfflineDataStore.Retrieve.getBusinessProcessFlowContolData.Failure",t.get_Message(),"Retrieve",e),i.reject(t)})},t=>{Ze._LogVerboseWithEntityName("OfflineDataStore.Retrieve._RetrieveGlobalNavigationDataRecord.Failure",t.get_Message(),"Retrieve",e),i.reject(t)})},t=>{Ze._LogVerboseWithEntityName("OfflineDataStore.Retrieve.RetrieveEntityMetadata.Failure",t.get_Message(),"Retrieve",e),i.reject(t)}),i}retrieveLookupRecords(e,t,n,r){const a=t+": "+e.join();Ze._LogVerbose("OfflineDataStore.RetrieveLookupRecords","RetrieveLookupRecords started for "+a);const i=new D.a;return H.a.get_DefaultInstance().retrieveEntityMetadata(t,n).then(a=>{const o=[a.get_primaryIdAttribute(),a.get_primaryNameAttribute()];H.a.get_DefaultInstance().getAttributeTypes(t,o,n).then(t=>{const n=K.get_instance().generateRetreiveLookupQuery(e.length,o,a);this._plugin.transaction(o=>{o.executeSql(n,e,(e,n)=>{Ze._LogVerbose("OfflineDataStore.RetrieveLookupRecords","RetrieveLookupRecords succeeded");this._GenerateEntityArray(n,t,a,r).then(e=>{i.resolve(new pe.a(e,false,n.rows.length,!1))},e=>{Ze._LogVerbose("OfflineDataStore.RetrieveLookupRecords",e.get_Message()),i.reject(e)})},()=>{Ze._LogVerbose("OfflineDataStore.RetrieveLookupRecords","No records found"),i.resolve(new pe.a(new Array(0),!1,0,!1))})},Ze._TransactionFailure(i,"RetrieveLookupRecords"+a.get_id().toString()),null)},e=>{Ze._LogVerbose("OfflineDataStore.RetrieveLookupRecords.GetAttributeTypes","RetrieveLookupRecords failed"),i.reject(e)})},e=>{Ze._LogVerbose("OfflineDataStore.RetrieveLookupRecords.RetrieveEntityMetadata","RetrieveLookupRecords failed"),i.reject(e)}),i}retrieveMultiple(e,t,n){const r=new D.a;Ze._LogVerbose("OfflineDataStore.RetrieveMultiple.Start",e.get_PublicKey());let a=!1;const i=e.get_sql(H.a.get_DefaultInstance().get_UserContext());return Object(p.b)(i)?(Ze._LogWarning("OfflineDataStore.RetrieveMultiple.SqlQueryNotFound",e.get_PublicKey()),r.resolve(new pe.a(new Array(0),!1,0,!1,e))):(this._replaceMissingMetadataTokens(i).then(i=>{i=unescape(i),this._get_Plugin().transaction(o=>{o.executeSql(i,null,(i,o)=>{a=!0,Ze._LogVerbose("OfflineDataStore.RetrieveMultiple.SqlSuccess",e.get_PublicKey());let s=!1;const c=o.rows.length;let l=!1;o.rows.length>e.get_PageSize()&&(o.rows.length=e.get_PageSize(),s=!0,l=!0),Ze._LogVerbose("OfflineDataStore.RetrieveMultiple.SqlSuccess",`Results count: ${c} - more Records: ${s}`),this._getEntityCollectionFromSQLResults(e,o,s,c,l,t,n).then(e=>{r.resolve(e)},e=>{Ze._LogWarning("OfflineDataStore.RetrieveMultiple.GetEntityCollectionFromSQLResultsFailed",e.get_Message()),r.reject(e)})},Ze._SqlExecutionFailure(r,"OfflineDataStore.RetrieveMultiple.QueryId"+e.get_PublicKey()))},Ze._TransactionFailure(r,"OfflineDataStore.RetrieveMultiple.QueryId"+e.get_PublicKey()),()=>{a||(Ze._LogWarning("OfflineDataStore.RetrieveMultiple.TransactionSuccessWithExecuteSqlNotCompleted","QueryId"+e.get_PublicKey()),r.resolve(new pe.a(new Array(0),!1,0,!1,e,t))),Ze._LogWarning("OfflineDataStore.RetrieveMultiple.TransactionSuccess","QueryId"+e.get_PublicKey())})}),r)}_replaceMissingMetadataTokens(e){if(e.includes("!attr-")){let t={};const n=e.split("!attr-");n.shift(),n.forEach(e=>{const n=e.split("-"),r=n[0],a=n[1].substring(0,n[1].indexOf("!"));t=this._addMissingInfo(t,r,a)});return H.a.get_DefaultInstance().get_Store().dispatch(Object(He.e)(t)).then(()=>{for(const n in t)t[n].forEach(t=>{e=this._finalTokenReplace(n,t,e)});return e})}return new Promise(t=>{t(e)})}_addMissingInfo(e,t,n){return null!=e[t]?e[t].includes(n)||e[t].push(n):e[t]=[n],e}_finalTokenReplace(e,t,n){let r=null;const a=H.a.get_DefaultInstance().get_MetadataCache(),i=Object(We.a)(a,e,t,Object(qe.a)(()=>r,e=>r=e)),o="!attr-"+e+"-"+t+"!";return n.replace(o,i)}_getEntityCollectionFromSQLResults(e,t,n,r,a,i,o){if(T.a.get_DefaultInstance().get_offlineTypescriptInterface().isExtendedOfflineClientApiSupportEnabled())return T.a.get_DefaultInstance().get_offlineTypescriptInterface().getEntityCollectionFromSQLResults(e,t,n,r,a);const s=new D.a,c=e.get_ColumnSet()instanceof oe.a&&!e.get_ColumnSet().get_isEmpty()?e.get_ColumnSet().get_Columns():null,l=e.GetColumnNamesFromFetch(),u=T.a.get_DefaultInstance().get_offlineTypescriptInterface().parseFetchXmlForAliasedValues(e.get_FetchXml()),d=Object(p.a)(u[O.g])?null:u[O.g];return H.a.get_DefaultInstance().getAttributeTypesForEntities(e.get_EntityLogicalName(),l,c,d,o).then(c=>{H.a.get_DefaultInstance().retrieveEntityMetadata(e.get_EntityLogicalName(),o).then(o=>{this._GenerateEntityArray(t,c,o,i,d).then(t=>{s.resolve(new pe.a(t,n,r,a,e))},e=>{Ze._LogWarning("OfflineDataStore.GetEntityCollectionFromSQLResults._GenerateEntityArrayFailed",e.get_Message()),s.reject(e)})},t=>{Ze._LogWarning("OfflineDataStore.GetEntityCollectionFromSQLResults.EntityMetadataRetrieveFailed",t.get_Message()+".QueryId"+e.get_id()),s.reject(t)})},t=>{Ze._LogWarning("OfflineDataStore.GetEntityCollectionFromSQLResults.AttributeTypeRetrieveFailed",t.get_Message()+".QueryId"+e.get_id()),s.reject(t)}),s}_getEntityRecordFromSQLResult(e,t,n,r,a,i){return T.a.get_DefaultInstance().get_offlineTypescriptInterface().isExtendedOfflineClientApiSupportEnabled()?T.a.get_DefaultInstance().get_offlineTypescriptInterface().getEntityRecordFromSQLResult(e,t,n,i):Object(De.a)(n,a,r,i)}_retrieveLastSyncTime(e){const t=new D.a;return Object.keys(e).length||t.resolve(null),this._get_Plugin().transaction(n=>{this._ExecuteInternal(n,K.get_instance().retrieveDataSyncStatusQuery(Object.keys(e).length),Object.keys(e)).then(e=>{const n={},r=Object(p.a)(e)||Object(p.a)(e.rows)?0:e.rows.length,a=r>0&&O.A in e.rows.item(0);for(let t=0;t<r;t++){const r=e.rows.item(t);if(!Object(p.a)(r)){const e={};a?(e[O.A.toLowerCase()]=Object(p.a)(r[O.A])?_[_.completed]:r[O.A].toString(),e[O.z.toLowerCase()]=Object(p.a)(r[O.z])?"0":r[O.z].toString()):(e[O.A.toLowerCase()]=_[_.completed],e[O.z.toLowerCase()]="0"),e[O.D.toLowerCase()]=Object(p.a)(r[O.D])?"00:00:00":r[O.D].toString(),n[r[O.q].toString()]=e,Ze._LogVerbose("OfflineDataStore.RetrieveLastSyncTime",String.format("Data Sync Status is added to  offline Entities list For The Entity-{0} - lastSync: {1}",r[O.q].toString(),e[O.D.toLowerCase()]))}}t.resolve(n)},e=>{Ze._LogWarning("OfflineDataStore.RetrieveLastSyncTime",e.get_Message()),t.reject(e)})},Ze._TransactionFailure(t,"RetrieveLastSyncTime"),null),t}_ExecuteMultiple(e,t){const n=new D.a,r=this._retrieveEntityMetadataForExecuteMultipleRequest(e);return r?(Object(S.a)(r).then(r=>{let a=!e.get_settings().get_continueOnError();const i=this._userContext.get_FCBContext().BPFUpSyncUsingOData;if((Object(p.a)(i)||!i.get_value())&&a)for(const e of r)if(e){const t=e;if(t&&t.get_isBPFEntity()){a=!1;break}}const s=[];a&&s.push(this._CreateUpSyncTransactionLog(!0,!1));let c=0;for(const n of e.get_requests())c++,Ze._LogVerbose("OfflineDataStore._ExecuteMultiple",`Adding query ${n} to ExecuteMultiple list`),this._AddRequest(n,s,r,t);Ze._LogVerbose("OfflineDataStore._ExecuteMultiple",`A Total of ${c} requests added to ExecuteMultiple`),a&&s.push(this._CreateUpSyncTransactionLog(!1,!1)),Object(S.a)(s).then(t=>{this._ExecuteQueriesInTransaction(t).then(t=>{Ze._LogVerbose("OfflineDataStore._ExecuteMultiple","ExecuteMultiple succeeded");const r=new Array(0),i=e.get_requests();for(let e=0;e<i.length;e++)if(i[e]instanceof Ie.a){const s=2*e+(a?1:0);if(Object(p.a)(t[s])||!t[s].rows.length)return Ze._LogWarning("OfflineStore._ExecuteMultiple.Failure","You cant update this record because it doesnt exist in the offline mode"),void n.reject(o.a.fromErrorCode(-2147093980));r.push(i[e].get_target().get_identifier())}else if(i[e]instanceof Se.a){const t=this._userContext.get_FCBContext().SplitBPFEntityAndParticipatingEntityCreates;if(Object(p.a)(t)||!t.get_value())continue;r.push(i[e].get_target().get_identifier())}n.resolve(r)},e=>{Ze._LogWarning("OfflineStore._ExecuteMultiple.Failure","Failed on _ExecuteQueriesInTransaction "+e.get_Message()),n.reject(e)})},e=>{Ze._LogWarning("OfflineStore._ExecuteMultiple.Failure",e.get_Message()),n.reject(e)})},e=>{Ze._LogWarning("OfflineStore._ExecuteMultiple.Failure","Failed on _shouldBeInTransaction "+e.get_Message()),n.reject(e)}),n):n.resolve(null)}_retrieveEntityMetadataForExecuteMultipleRequest(e){if(!(e instanceof Ce.a))return null;const t=[],n=e.get_requests();for(let e=0;e<n.length;e++){let r=null;(n[e]instanceof Se.a||n[e]instanceof Ie.a)&&(r=n[e].get_target()),r&&r.get_identifier()&&r.get_identifier().LogicalName&&t.push(H.a.get_DefaultInstance().retrieveEntityMetadata(r.get_identifier().LogicalName,null))}return t}_AddRequest(e,t,n,r){if(e&&t&&n)if(e instanceof Ie.a){const n=e;t.push(this._UpdateInternal(n.get_target().get_actionableIdentifier(),n.get_target(),n.get_suppressDuplicateDetection(),r,!1))}else if(e instanceof Se.a){const r=this._userContext.get_FCBContext().SplitBPFEntityAndParticipatingEntityCreates;if(Object(p.a)(r)||!r.get_value())return;const a=e,i=a.get_target();let o=null;for(const e of n)if(e&&e.get_logicalName()===i.get_identifier().LogicalName){o=e;break}if(!o)return;const s=Object(p.a)(i.get_identifier().Id)||i.get_identifier().Id.equals(c.a.get_empty())?Object(p.a)(i.getFields()[o.get_primaryIdAttribute()])?c.a.newGuid():i.getFields()[o.get_primaryIdAttribute()]:i.get_identifier().Id;t.push(this._CreateInternal(i,a.get_suppressDuplicateDetection(),o,s))}}update(e,t,n,r,a){Ze._LogVerboseWithEntityName("OfflineDataStore.Update","Update started","Update",e);const i=new D.a;return this._UpdateInternal(e,t,n,r,a,!0).then(n=>{this._get_Plugin().transaction(r=>{const a=[];this._UpdateAndExecuteQueries(r,a,n),Object(S.a)(a).then(n=>{Object(p.a)(n[0])||!n[0].rows.length?(Ze._LogVerboseWithEntityName("OfflineDataStore.Update.Failure","You cant update this record because it doesnt exist in the offline mode","Update",e),i.reject(o.a.fromErrorCode(-2147093980))):(Ze._LogVerboseWithEntityName("OfflineDataStore.Update","Update succeeded","Update",e),i.resolve(t.get_identifier()))},t=>{Ze._LogVerboseWithEntityName("OfflineDataStore.Update.Failure",t.get_Message(),"Update",e),i.reject(t)})},Ze._TransactionFailure(i,"Update"),null)},t=>{Ze._LogVerboseWithEntityName("OfflineDataStore._UpdateInternal.Failure",t.get_Message(),"Update",e),i.reject(t)}),i}_UpdateInternal(e,t,n,r,a,i){Ze._LogVerbose("OfflineDataStore._UpdateInternal","Update Internal started");const o=new D.a;return a=!Object(p.a)(a)&&a,H.a.get_DefaultInstance().retrieveEntityMetadata(e.LogicalName,null).then(s=>{const l=s;if(i=!Object(p.a)(i)&&i){const i=new Ie.a(t);T.a.get_DefaultInstance().get_offlineTypescriptInterface().createCustomOfflineCommandQueries(i,e.LogicalName,c.a.get_empty()).then(i=>{if(Object(p.a)(i))this._DoUpdateInternal(o,e,t,n,r,a,l);else{const t=[];t.push(new ze(K.get_instance().generateRetrieveQuery(e,[new g.a(l.get_primaryIdAttribute())],l.get_primaryIdAttribute()),[e.Id.toString()],"Transaction.Retrieve")),o.resolve(this._PrepareFinalQueryList(i,a,t))}},e=>{Ze._LogWarning("OfflineDataStore.Create.CreateCustomOfflineCommandQueries.Fail",e.get_Message()),o.reject(e)})}else this._DoUpdateInternal(o,e,t,n,r,a,l)},e=>{Ze._LogWarning("OfflineDataStore.UpdateInternal.Fail",e.get_Message()),o.reject(e)}),o}_DoUpdateInternal(e,t,n,r,a,i,o){const s=[];k.a.getOfflineQueryDataObject(n,ae.a.update,o.get_primaryIdAttribute(),t.Id,o,this._userContext).then(n=>{if(s.push(new ze(K.get_instance().generateRetrieveQuery(t,[new g.a(o.get_primaryIdAttribute())],o.get_primaryIdAttribute()),[t.Id.toString()],"Transaction.Retrieve")),s.push(new ze(K.get_instance().generateUpdateQuery(t,n.get_columns(),o.get_primaryIdAttribute()),n.get_values(),"Transaction.Update")),o.get_isActivity()){Ze._LogVerbose("OfflineDataStore._UpdateInternal","Entity metadata is activity");let e=0;for(const t of n.get_partiesToRetain()){const n=t[O.U].length,r=Ze._activityPartyMarker+e+K.get_instance().generateDeleteFilteredActivityPartiesQuery(n);s.push(new ze(r,Ze._GetParametersForDeleteFilteredActivityPartyQuery(t),"Transaction.Delete")),e++}e=0;for(const t of n.get_partiesToCreate()){const n=Ze._activityPartyMarker+e+K.get_instance().generateInsertQuery(t[O.t],t[O.m]);s.push(new ze(n,t[O.ab],"Transaction.Create")),e++}e=0;for(const t of n.get_partiesToRetain()){const n=t[O.U].length,r=Ze._activityPartyMarker+e+K.get_instance().updateActivityPartiesQuery(n);s.push(new ze(r,Ze._GetParametersForUpdateActivityPartyQuery(t),"Transaction.Update")),e++}}e.resolve(this._PrepareFinalQueryList(s,i))},t=>{Ze._LogWarning("OfflineStore._UpdateInternal.GetOfflineQueryDataObject.Failure",t.get_Message()),e.reject(t)})}_ExecuteInternal(e,t,n){const r=t.indexOf(" "),a=t.substring(0,r);Ze._LogVerbose("OfflineDataStore._ExecuteInternal",a+" ExecuteInternal started");const i=new D.a;return e.executeSql(t,n,(e,t)=>{Ze._LogVerbose("OfflineDataStore._ExecuteInternal",a+" ExecuteInternal succeeded"),i.resolve(t)},Ze._SqlExecutionFailure(i,"ExecuteInternal")),i}Delete(e,t,n){Ze._LogVerboseWithEntityName("OfflineDataStore.Delete","Delete started","Delete",e);const r=new D.a;return n=!Object(p.a)(n)&&n,H.a.get_DefaultInstance().retrieveEntityMetadata(e.LogicalName,t).then(t=>{this._get_Plugin().transaction(a=>{const i=[new Y.a(t.get_primaryIdAttribute(),null,z.a.Or,0)],s=new j.a(i),c=K.get_instance().generateDeleteQuery(e,s),l=[e.Id.toString()],u=[];u.push(this._ExecuteInternal(a,K.get_instance().generateRetrieveQuery(e,[new g.a(t.get_primaryIdAttribute())],t.get_primaryIdAttribute()),[e.Id.toString()])),n&&(Ze._LogVerbose("OfflineDataStore.Delete","Delete called with triggers suppressed"),u.push(this._ExecuteInternal(a,K.get_instance().generateSuppressTriggerQuery(),null))),u.push(this._ExecuteInternal(a,c,l)),t.get_isActivity()&&(Ze._LogVerbose("OfflineDataStore.Delete","Entity metadata is activity"),u.push(this._ExecuteInternal(a,K.get_instance().generateDeleteAllActivityPartiesQuery(),l))),n&&u.push(this._ExecuteInternal(a,K.get_instance().generateUnsuppressTriggerQuery(),null)),Object(S.a)(u).then(t=>{Object(p.a)(t[0])||!t[0].rows.length?(Ze._LogVerboseWithEntityName("OfflineDataStore.Delete.Failure","You cant delete this record because it doesnt exist in the offline mode","Update",e),r.reject(o.a.fromErrorCode(-2147093944))):(Ze._LogVerboseWithEntityName("OfflineDataStore.Delete","Delete succeeded","Delete",e),r.resolve(e))},t=>{Ze._LogVerboseWithEntityName("OfflineDataStore.Delete.Failure",t.get_Message(),"Delete",e),r.reject(t)})},Ze._TransactionFailure(r,"Delete"),null)},t=>{Ze._LogVerboseWithEntityName("OfflineDataStore.Delete.Failure",t.get_Message(),"Delete",e),r.reject(t)}),r}_GenerateEntityArray(e,t,n,r,a){const i=Object(p.a)(e)||Object(p.a)(e.rows)?0:e.rows.length,o=new D.a,s=[];for(let o=0;o<i;o++){const i=e.rows.item(o);Object(p.a)(i)||Object(p.b)(i[n.get_primaryIdAttribute()])||s.push(Object(De.a)(i,t,n,r,a))}return Object(S.a)(s).then(e=>{o.resolve(e)},e=>{Ze._LogWarning("OfflineStore._GenerateEntityArray.Failure",e.get_Message()),o.reject(e)}),o}flushAll(e){const t=new D.a;return this._parentDataSource.retrieveSessionState(Ze._OfflineDatabaseKey).then(n=>{if(Object(p.a)(n)||!(Ze._OfflineDatabaseKey in n)||Object(p.a)(n[Ze._OfflineDatabaseKey]))Ze._LogVerbose("OfflineDataStore.FlushAll","Offline store not available. So nothing to be deleted"),t.resolve(!0);else{const r=n[Ze._OfflineDatabaseKey].toString();this._clearStore(r,e).then(()=>{Ze._LogVerbose("OfflineDataStore.FlushAll","Offline store delete successful"),this._ClearOfflineSessionState().then(()=>{Ze._LogVerbose("OfflineDataStore.FlushAll","Offline store session state cleanup successful."),t.resolve(!0)},e=>{Ze._LogWarning("OfflineDataStore.FlushAll","Offline store session state cleanup failed. Error Message: "+e.get_Message()),t.reject(e)})},e=>{Ze._LogWarning("OfflineDataStore.FlushAll","Offline store delete failed. Error Message: "+e.get_Message()),t.reject(e)})}},e=>{Ze._LogWarning("OfflineDataStore.FlushAll","Clear data store failed as database name was not retrieved. Error Message: "+e.get_Message()),t.reject(e)}),t}_clearStore(e,t){Ze._LogVerbose("OfflineDataStore.ClearStore","ClearStore started");const n=new D.a;return Object(p.b)(e)?(Ze._LogVerbose("OfflineStore.ClearStore","Database name is empty"),n.resolve(!1)):(this._StopSync().always(()=>{T.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineStatus()!==Q.a.Available?this._InitAndLogin(e,t).then(()=>{Ze._LogVerbose("OfflineStore.ClearStore","InitAndLogin succeeded"),this._DeleteDatabase(e,n)},e=>{Ze._LogWarning("OfflineStore.ClearStore._InitAndLogin.Failure",e.get_Message()),n.reject(e)}):this._DeleteDatabase(e,n)}),n)}_DeleteDatabase(e,t){this._get_Plugin().deleteDatabase(e,()=>{Ze._LogVerbose("OfflineStore._DeleteDatabase","Database delete successful for database : "+e),T.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(0,X.a.DatabaseUnavailable),this._regenerateViews=!0,Ze._loginParameters=null,t.resolve(!0)},()=>{Ze._LogWarning("OfflineStore._DeleteDatabase.Failure",e),t.reject(o.a.FromMessage("Could not delete database"))})}_RetrievePartyRecords(e,t,n,r){Ze._LogVerbose("OfflineDataStore._RetrievePartyRecords","RetrievePartyRecords started");const a=new D.a;return H.a.get_DefaultInstance().getAttributeTypes(O.d,O.R,r).then(i=>{Ze._LogVerbose("OfflineDataStore._RetrievePartyRecords.GetAttributeTypes","GetAttributeTypes succeded");const o=this._GetPhysicalFieldsForQuery(i,r);let s=!1;H.a.get_DefaultInstance().retrieveEntityMetadata(O.d,r).then(r=>{const c=K.get_instance().generateRetrievePartyListQuery(o,t,r.get_logicalName()),l=[e.Id.toString().toUpperCase()];for(const e in t){const n={key:e,value:t[e]};l[l.length]=n.key}this._plugin.transaction(e=>{e.executeSql(c,l,(e,t)=>{const o=t.rows.length,c=[];s=!0;for(let e=0;e<o;e++)Object(p.a)(t.rows.item(e))||c.push(Object(De.a)(t.rows.item(e),i,r,n));Object(S.a)(c).then(e=>{Ze._LogVerbose("OfflineDataStore._RetrievePartyRecords","Executesql succeded"),a.resolve(new pe.a(e,!1,t.rows.length,!1))},e=>{Ze._LogWarning("OfflineStore._RetrievePartyRecords.Failure",e.get_Message()),a.reject(e)})},Ze._SqlExecutionFailure(a,"RetrievePartyRecords"))},Ze._TransactionFailure(a,"RetrievePartyRecords"),()=>{Ze._LogWarning("RetreivePartyRecords.TransactionSuccess","Identifier"+e.get_key()),s||a.resolve(new pe.a(new Array(0),!1,0,!1))})},t=>{Ze._LogWarning("Retrieve.RetrieveEntityMetadata.Failure",e.LogicalName+"."+t.get_Message()),a.reject(t)})},t=>{Ze._LogWarning("Retrieve.GetAttributeTypes.Failure",e.LogicalName+"."+t.get_Message()),a.reject(t)}),a}_FillActivityParty(e,t,n,r){Ze._LogVerbose("OfflineDataStore._FillActivityParty","FillActivityParty started");const a=new D.a;let i=!1;const o={};for(const e in t)if("partylist"===t[e]){const t=O.O[e];o[t]=e,i=!0}return i?(this._RetrievePartyRecords(e.get_identifier(),o,n,r).then(t=>{if(Ze._LogVerbose("OfflineDataStore._FillActivityParty","RetrievePartyRecords succeeded"),!Object(p.a)(t.get_entities())&&t.get_entities().length>0){let n=new Array(0),r="";for(const a of t.get_entities())r!==a.getValue(O.P).get_ValueString()&&(n.length>0&&(e.initializeValue(o[r].toString(),new pe.a(n,!1,n.length,!1),"partylist"),n=new Array(0)),r=a.getValue(O.P).get_ValueString()),n[n.length]=a;e.initializeValue(o[r].toString(),new pe.a(n,!1,n.length,!1),"partylist")}Ze._LogVerbose("OfflineDataStore._FillActivityParty","FillActivityparty succeeded"),a.resolve(e)},e=>{Ze._LogWarning("Retrieve._RetrievePartyRecords.Failure",e.get_Message()),a.reject(e)}),a):(a.resolve(e),a)}_GetPhysicalFieldsForQuery(e,t){const n=Object(C.c)(e,t),r=new Array(0);for(const e in n){const t=n[{key:e,value:n[e]}.key];for(let e=0;e<t.length;e++)r.push(new g.a(t[e].toString()))}return r}_AddRequiredAttributes(e,t){const n=new Array(0);if(Object(p.a)(e.get_primaryIdAttribute())||(n[n.length]=e.get_primaryIdAttribute()),Object(p.a)(e.get_primaryNameAttribute())||(n[n.length]=e.get_primaryNameAttribute()),n.length>0){for(const e of t){const t=n.indexOf(e);if(t>=0&&(n.splice(t,1),!n.length))break}for(const e of n)t[t.length]=e}return t}_CreateActivityPointerView(e){Ze._LogVerbose("OfflineDataStore._CreateActivityPointerView","CreateActivityPointerView started");const t=[];!Object(p.a)(e)&&e.length>0&&(t.push(this._DropView(A.c)),t.push(this._DropView(O.b)));const n=T.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineEnabledEntities();-1===n.indexOf(A.c.toLowerCase())?Ze._LogVerbose("CreateActivityPointerView","View not created as ActivityPointer is not offline available"):Object(S.a)(t).always(()=>{this._CreateActivityPointerViewInternal(e,n)})}_CreateActivityPointerViewInternal(e,t){K.get_instance().generateCreateActiviyPointerViewQuery(this._localContext,e,t).then(e=>{Ze._LogVerbose("OfflineDataStore._CreateActivityPointerView","CreateActivityPointerView query :"+e),this._plugin.transaction(t=>{t.executeSql(e,null,()=>{Ze._LogVerbose("OfflineDataStore.CreateActivityPointerView creation successful","CreateActivityPointerView"),this._IsActivityAttachmentEnabled()?this._CreateActivityAttachmentView():this._regenerateViews=!1},Object(Me.a)(this,this._ActivityPointerChangeFailedCallback,"ActivityPointerChangeFailedCallback"))},()=>{Ze._LogWarning("transaction failed while creating the view","CreateActivityPointerView")},null)},null)}_IsActivityAttachmentEnabled(){const e=T.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineEnabledEntities();return-1!==e.indexOf(A.a)&&-1!==e.indexOf(A.e)&&-1!==e.indexOf(A.c)||(Ze._LogVerbose("CreateActivityAttachmentView","View not created as ActivityAttachment or Attachment or ActivityPointer is not offline available"),!1)}_CreateActivityAttachmentView(){Ze._LogVerbose("OfflineDataStore._CreateActivityAttachmentView","CreateActivityAttachmentView started"),K.get_instance().generateCreateActiviyAttachmentViewQuery(T.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineEnabledEntities()).then(e=>{Ze._LogVerbose("OfflineDataStore._CreateActivityAttachmentView","CreateActivityAttachmentView query :"+e),this._plugin.transaction(t=>{t.executeSql(e,null,()=>{Ze._LogVerbose("OfflineDataStore.CreateActivityPointerView creation successful","CreateActivityAttachmentView"),this._regenerateViews=!1},Object(Me.a)(this,this._ActivityAttachmentFailedCallback,"ActivityAttachmentFailedCallback"))},()=>{Ze._LogWarning("transaction failed while creating the view","CreateActivityAttachmentView")},null)},null)}_ActivityPointerChangeFailedCallback(e,t){Ze._LogWarning("view creation/removal failed","ActivityPointerChangeFailed with error message : "+e)}_ActivityAttachmentFailedCallback(e,t){Ze._LogWarning("view creation/removal failed","ActivityAttachmentView creation failed with error message : "+e)}_DropView(e){const t=new D.a;return this._plugin.transaction(n=>{const r=K.get_instance().generateDropViewQuery(e);n.executeSql(r,null,()=>{Ze._LogVerbose("DropView: "+e,"success"),t.resolve(!0)},(e,n)=>{this._ActivityPointerChangeFailedCallback(e,n),t.resolve(!1)})},()=>{Ze._LogWarning("DropView: "+e,"transaction failed"),t.resolve(!1)},null),t}_UpdateOfflineAvailablePrimaryEntities(){let e=T.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineAvailablePrimaryEntities()||{};const t={},n=[];for(const e of T.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineProfileAvailableEntities())n.push(H.a.get_DefaultInstance().retrieveEntityMetadata(e,null));Object(S.a)(n).then(n=>{for(const e of n){const n=e;!n.get_isBPFEntity()&&!n.get_isIntersect()&&this._entitySkipList.indexOf(n.get_logicalName())<0&&(t[n.get_logicalName()]=e.get_displayName())}for(const n of Object.keys(e)){let r=!1;for(const e in t)if(e===n){r=!0;break}r||delete e[n]}Object.keys(t).length>0&&this._retrieveLastSyncTime(t).then(n=>{for(const r of Object.keys(t))r in n?(n[r][Ze._DisplayNameKey]=t[r],e[r]=n[r]):e[r]={initialdatadownloadstatus:"1",displayname:t[r]}},t=>{e={},Ze._LogWarning("OfflineDataStore._UpdateOfflineAvailablePrimaryEntities.Fail ",t.get_Message())}).always(()=>{T.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineAvailablePrimaryEntities(e),this._parentDataSource.saveSessionState(Ze._OfflinePrimaryAvailableEntitiesKey,e,!1)}),Ze._LogVerbose("OfflineDataStore._UpdateOfflineAvailablePrimaryEntities","completed succesfully")},e=>{Ze._LogWarning("OfflineDataStore: UpdateOfflineAvailablePrimaryEntities","Failed to get the entity metadata"+e.get_Message())})}_saveBooleanInformationToSessionState(e,t,n,a,i){const o={};o[t]=n,this._parentDataSource.saveSessionState(t,o,!1).then(()=>{T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,a,e)},t=>{Object(f.a)(e,r.e,t.get_Message()),T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,i,e)})}_ClearOfflineSessionState(){const e=new D.a,t=[];return t.push(this._parentDataSource.deleteSessionState(Ze._OfflineDatabaseKey)),t.push(this._parentDataSource.deleteSessionState(Ze._MaxTimeColumnName)),Object(S.a)(t).then(()=>{e.resolve(!0)},t=>{e.reject(t)}),e}static _LogSyncProgressMessage(e){switch(e.code){case re.warning:case re.error:case re.fatal:Ze._LogWarning("Sync.Progress",e.message);break;default:Ze._LogVerbose("Sync.Progress",e.message)}}static _TransactionFailure(e,t){return(n,r)=>{Ze._LogWarning(t+".TxFailure",r),e.reject(o.a.FromMessage(r))}}static _SqlExecutionFailure(e,t){return(n,r)=>{Ze._LogWarning(t+".SqlFailure",n),e.reject(o.a.FromMessage(n))}}static _LogWarning(e,t){Object(i.e)(e,m.a.offlineDataStore,t)}static _LogVerbose(e,t){Object(i.e)(e,m.a.offlineDataStore,t)}static _LogVerboseWithEntityName(e,t,n,a){const o=new Date;let s=String.format("{0} -- {1} -- {2}",e,t,Object(i.a)(o));s=String.format("[{0}]{1}",b,s);const c=[];Object(f.a)(c,r.a,n),Object(p.a)(a)||Object(p.a)(a.LogicalName)?Object(f.a)(c,r.d,"unknown"):Object(f.a)(c,r.d,a.LogicalName),T.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,s,c)}static _GetParametersForDeleteFilteredActivityPartyQuery(e){const t=[];t[t.length]=e[O.c].toString(),t[t.length]=e[O.P].toString();for(const n of e[O.U])t[t.length]=n;return t}static _GetParametersForUpdateActivityPartyQuery(e){const t=[];t[t.length]=e[O.c].toString(),t[t.length]=e[O.c].toString(),t[t.length]=e[O.P].toString();for(const n of e[O.U])t[t.length]=n;return t}ExecuteSqlStatements(e){const t=new D.a,n=[];for(let t=0;t<e.sqlStatements.length;t++)n.push(new ze(e.sqlStatements[t],e.sqlParameters[t],"Transaction.ExecuteSqlStatements"));return this._get_Plugin().transaction(e=>{const r=[];this._UpdateAndExecuteQueries(e,r,n),Object(S.a)(r).then(e=>(Ze._LogVerbose("OfflineDataStore.ExecuteSqlStatements","ExecuteSqlStatements succeeded"),t.resolve(e)),e=>(Ze._LogVerbose("OfflineDataStore.ExecuteSqlStatements.Fail",e.get_Message()),t.reject(e)))},Ze._TransactionFailure(t,"ExecuteSqlStatements"),null),new Promise((e,n)=>{t.then(t=>e(t)).catch(e=>n(e))})}}Ze._onSyncCompletedEventName="offlineSyncComplete",Ze._OfflineDatabaseKey="offlinedatabasekey",Ze._OfflineApplyApplicationMetadataChangesKey="offlineapplyapplicationmetadatachangeskey",Ze._IsOfflineFirstTimeSyncCompletedKey="isofflinefirsttimesynccompletedkey",Ze._OfflinePrimaryAvailableEntitiesKey="offlineprimaryavailableentitieskey",Ze._OfflineStatus="offlinestatus",Ze._MaxTimeColumnName="MaxTime",Ze._SystemUserId="systemuserid",Ze._MobileOfflineProfileId="mobileofflineprofileid",Ze._SystemUserTableNameInOfflineDB="_systemuser",Ze._DisplayNameKey="displayname",Ze._DefaultTimerId=0,Ze._loginParameters=null,Ze._activityPartyMarker="@ActivityParty@",Ze._activityPartyMarkerRegex="^@ActivityParty@[0-9]+"},iDZS:function(e,t,n){"use strict";function r(e){return e.style?(Object.assign(e.style,function(e){if(!e)return{};var t={};null!=e.borderBottomWidth&&(t.borderBottomWidth=a(e.borderBottomWidth));null!=e.borderLeftWidth&&(t.borderLeftWidth=a(e.borderLeftWidth));null!=e.borderRightWidth&&(t.borderRightWidth=a(e.borderRightWidth));null!=e.borderTopWidth&&(t.borderTopWidth=a(e.borderTopWidth));null!=e.borderWidth&&(t.borderWidth=a(e.borderWidth));null!=e.height&&(t.height=a(e.height));null!=e.width&&(t.width=a(e.width));null!=e.minWidth&&(t.minWidth=a(e.minWidth));null!=e.minHeight&&(t.minHeight=a(e.minHeight));null!=e.maxWidth&&(t.maxWidth=a(e.maxWidth));null!=e.maxHeight&&(t.maxHeight=a(e.maxHeight));null!=e.margin&&(t.margin=a(e.margin));null!=e.marginBottom&&(t.marginBottom=a(e.marginBottom));null!=e.marginLeft&&(t.marginLeft=a(e.marginLeft));null!=e.marginRight&&(t.marginRight=a(e.marginRight));null!=e.marginTop&&(t.marginTop=a(e.marginTop));null!=e.padding&&(t.padding=a(e.padding));null!=e.paddingBottom&&(t.paddingBottom=a(e.paddingBottom));null!=e.paddingLeft&&(t.paddingLeft=a(e.paddingLeft));null!=e.paddingRight&&(t.paddingRight=a(e.paddingRight));null!=e.paddingTop&&(t.paddingTop=a(e.paddingTop));null!=e.position&&(t.position=a(e.position));null!=e.bottom&&(t.bottom=a(e.bottom));null!=e.right&&(t.right=a(e.right));null!=e.top&&(t.top=a(e.top));null!=e.left&&(t.left=a(e.left));null!=e.flex&&(t.flex=(n=e.flex,r=Number(n),isNaN(r)?n:r));var n,r;null!=e.animationDirection&&(t.animationDirection=e.animationDirection);null!=e.animationDuration&&(t.animationDuration=e.animationDuration);null!=e.animationFillMode&&(t.animationFillMode=e.animationFillMode);null!=e.animationIterationCount&&(t.animationIterationCount=e.animationIterationCount);null!=e.animationName&&(t.animationName=e.animationName);null!=e.backgroundColor&&(t.backgroundColor=e.backgroundColor);return t}(e.style)),e.style):{}}function a(e){return"number"==typeof e?e.toString()+"px":e}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var i=function(e){return function(t){return t.renderRule(r,e)}}},iDqy:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.WorkBlockTracker=void 0;var i,o=n("STW0");!function(e){e[e.Working=0]="Working",e[e.WorkComplete=1]="WorkComplete",e[e.Idle=2]="Idle"}(i||(i={}));var s=function(){function e(e,t,n){void 0===n&&(n=!1),this._appWorkingCallbacks=[],this._appIdleCallbacks=[],this._isBoot=!0,this._pendingWorkItems=[],this._workEndTimeoutId=-1,this._appIdleTimeoutId=-1,this._workIntervalId=-1,this._appBusyTime=0,this._appIdleTime=0,this._lastWorkUpdateTime=0,this._state=i.Idle,this._runningIdleCallbacks=!1,this._appIdleTimeoutLength=e,this._workCompleteTimeout=t,this._rethrowErrors=n,this._checkIfWorkTimedOut=this._checkIfWorkTimedOut.bind(this),this._onWorkDoneConfirmation=this._onWorkDoneConfirmation.bind(this),this._checkIfAppIdle=this._checkIfAppIdle.bind(this)}return e.prototype.getLastWorkBlockStartTime=function(){return this._appBusyTime},e.prototype.overrideWorkBlockStartTime=function(e){this._appBusyTime=e},e.prototype.isAppIdle=function(){return this._state===i.Idle},e.prototype.setPerformanceIssueHook=function(e){this._logPerformanceIssue=e},e.prototype.subscribeToAppWorking=function(e){this._appWorkingCallbacks.push(e)},e.prototype.subscribeToAppIdle=function(e){this._appIdleCallbacks.push(e)},e.prototype.unsubscribeFromAppWorking=function(e){var t=this._appWorkingCallbacks.indexOf(e);t>-1&&this._appWorkingCallbacks.splice(t,1)},e.prototype.unsubscribeFromAppIdle=function(e){var t=this._appIdleCallbacks.indexOf(e);t>-1&&this._appIdleCallbacks.splice(t,1)},e.prototype.trackPendingPromise=function(e,t){var n=this.trackWork(t);e.then(n,n)},e.prototype.trackWork=function(e,t){var n,r=this;return void 0===t&&(t=!0),!t&&this.isAppIdle()?function(){}:this._runningIdleCallbacks?(console.log("WorkBlockTracker: work block started during synchronous idle callbacks. This behavior is not supported"),function(){}):(this._pendingWorkItems.push(e),this._state!==i.Working&&this._onNewWork(),n=!1,function(){n||(n=!0,r._onItemCompleted(e))})},e.prototype._onItemCompleted=function(e){var t=this._pendingWorkItems.indexOf(e);t>=0&&(this._pendingWorkItems.splice(t,1),0===this._pendingWorkItems.length?this._onWorkDone():this._resetWorkTimeoutTracking())},e.prototype._onNewWork=function(){var e=this;if(this._state!==i.Working&&1===this._pendingWorkItems.length){var t=!1;if(this._state===i.Idle&&(this._workIntervalId=setInterval(this._checkIfWorkTimedOut,this._workCompleteTimeout),this._isBoot||(performance.mark&&performance.mark("WorkBlockStart"),this._appBusyTime=window.performance.now()),t=!0),this._state=i.Working,this._resetWorkTimeoutTracking(),clearTimeout(this._workEndTimeoutId),this._workEndTimeoutId=-1,clearTimeout(this._appIdleTimeoutId),this._appIdleTimeoutId=-1,t){var n={isBoot:this._isBoot};this._appWorkingCallbacks.slice().forEach((function(t){return e._safelyCallCallback(t,n)}))}}else console.error("WorkBlockTracker: invalid state in _onNewWork")},e.prototype._resetWorkTimeoutTracking=function(){this._lastWorkUpdateTime=performance.now()},e.prototype._checkIfWorkTimedOut=function(){if(this._state===i.Working&&performance.now()-this._lastWorkUpdateTime>this._workCompleteTimeout){var e={type:o.PerformanceIssueType.WorkBlockTimeout,level:o.PerformanceIssueLevel.Warning,message:"Work timed out with no activity",parameters:a([this._workCompleteTimeout.toString()],this._pendingWorkItems)};this._logPerformanceIssue&&this._logPerformanceIssue(e),this._pendingWorkItems=[],this._onWorkDone()}},e.prototype._onWorkDone=function(){this._state===i.Working&&0===this._pendingWorkItems.length?(this._state=i.WorkComplete,clearTimeout(this._workEndTimeoutId),this._workEndTimeoutId=setTimeout(this._onWorkDoneConfirmation,0)):console.error("Invalid WorkBlockTracker state: _onWorkDone should not be called with pending work")},e.prototype._onWorkDoneConfirmation=function(){this._state===i.WorkComplete&&0===this._pendingWorkItems.length||console.error("Invalid WorkBlockTracker state: _onWorkDoneConfirmation should not be called with pending work"),this._appIdleTime=window.performance.now(),clearTimeout(this._appIdleTimeoutId),this._appIdleTimeoutId=setTimeout(this._checkIfAppIdle,this._appIdleTimeoutLength)},e.prototype._checkIfAppIdle=function(){var e=this;if(this._state===i.WorkComplete)if(this._state===i.WorkComplete){this._state=i.Idle,clearInterval(this._workIntervalId),this._workIntervalId=-1,performance.mark&&performance.mark("WorkBlockEnd");var t={appWorkingTime:this._appBusyTime,appIdleTime:this._appIdleTime,isBoot:this._isBoot};this._isBoot=!1,this._appIdleTimeoutId=-1,this._runningIdleCallbacks=!0,this._appIdleCallbacks.slice().forEach((function(n){return e._safelyCallCallback(n,t)})),this._runningIdleCallbacks=!1}else this._appIdleTimeoutId=-1;else console.error("Invalid WorkBlockTracker state: shouldn't be in working state when transitioning to idle")},e.prototype._safelyCallCallback=function(e,t){try{e.call(null,t)}catch(e){this._rethrowErrors&&setTimeout((function(){throw e}),0)}},e}();t.WorkBlockTracker=s;var c=new s(100,6e4,!0);t.default=c,window.UCWorkBlockTracker=c},iEjf:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n("odYE"),a=n("SRlt"),i=n("vF3j"),o=n("FZDd"),s=n("iZ7K"),c=n("g22U");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e,t,n,r){if(!e||!t||!n)return{serializationFailure:"Cannot serialize disassociate request. All required parameters are mandatory, but some were passed in empty"};const o=Object(s.o)(e,t.etn),{navigationProperty:l,serializationFailure:u}=Object(i.a)(e,t.etn,n);if(u)return{serializationFailure:u};return{urlParameters:`${o}(${t.id.guid})/${l}`+(r?`(${r})`:"")+"/$ref",additionalHeaders:{Accept:a.a},method:"DELETE",additionalParameters:{[c.a.TYPE]:c.c.DELETE,[c.a.SUB_TYPE]:c.b.Disassociate}}}function u(e){return{type:"SERIALIZE_DISASSOCIATE_REQUEST_ASYNC",execute({dispatch:t,getState:n},a){const i=e.get_target();return t(Object(o.f)(i.LogicalName,!1,[])).then(()=>l(n(),r.a.fromLegacyEntityReference(i),e.get_relationship().get_schemaName()))}}}},iF9X:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"h",(function(){return g}));var r=n("504W"),a=n("17x/"),i=n("Lyxw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e){return e&&e.offline&&e.offline.server&&!Object(r.a)(e.offline.server.isMocaOfflineFeatureEnabled)?e.offline.server.isMocaOfflineFeatureEnabled||Object(a.c)(e):!!Object(a.c)(e)}function s(e){return e&&e.offline&&e.offline.server&&e.offline.server.norsyncServerConnectionString?e.offline.server.norsyncServerConnectionString:""}function c(e){return!(!(e&&e.offline&&e.offline.server)||Object(r.a)(e.offline.server.isTrialOrganization))&&e.offline.server.isTrialOrganization}function l(e){return e&&e.offline&&e.offline.server&&e.offline.server.subscriptionId?e.offline.server.subscriptionId:""}function u(e){return Object(i.b)(e,"EnableDataSyncService")&&(Object(i.d)(e,"MobileClientDssSync")||Object(a.c)(e))}function d(e){return Object(a.c)(e)&&Object(i.b)(e,"EnableDataSyncService")}function p(e){return Object(i.b)(e,"UCIEnableApplicationMetadataDownloadInShim")&&Object(i.d)(e,"MobileClientApplicationMetadataSync")}function g(e){return Object(i.b)(e,"EnableUCIOfflineSyncAdaptivePaging")}},iJGp:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.OnDemandWithContext=1]="OnDemandWithContext",e[e.OnDemandWithoutContext=2]="OnDemandWithoutContext",e[e.OnDemandContextOnly=3]="OnDemandContextOnly",e[e.Offline=4]="Offline",e[e.Mobile=5]="Mobile",e[e.UserContext=6]="UserContext"}(r||(r={}))},iJxC:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("504W"),a=n("BSGX"),i=n("2mBq");class o{constructor(e,t,n,a,i){if(this._filter=null,this._sortBy=null,this._offset=0,this._pageSize=0,this._getIdOnly=!1,this._allowPartialResults=!1,t&&t.length>2)throw Error.invalidOperation("SortBy can have at most 2 sort fields.");this._getIdOnly=!1,this._filter=e,this._sortBy=t,this._offset=Object(r.a)(n)?0:n,this._pageSize=Object(r.a)(n)?-1:a,this._allowPartialResults=i}get_filter(){return this._filter}get_sortBy(){return this._sortBy}get_offset(){return this._offset}get_pageSize(){return this._pageSize}get_allowPartialResults(){return this._allowPartialResults}get_getIdOnly(){return this._getIdOnly}toString(){if(!this.get_filter())return"";let e="";return this.get_filter()instanceof a.a&&(e=this.get_filter().get_fieldValue().toString()),Object(i.a)("Query: '{0}'='{1}'",this.get_filter().get_field().get_path(),e)}}},iKQk:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e=""){this._params=[],"string"==typeof e?this._initFromString(e):e instanceof r&&this._initFromUrlParameters(e)}append(e,t){this._params.push({name:e,value:t}),this._update()}delete(e){for(let t=this._params.length-1;t>=0;t--){e===this._params[t].name&&this._params.splice(t,1)}this._update()}get(e){let t=null;for(let n=0;n<this._params.length;n++){const r=this._params[n];if(e===r.name){t=r.value;break}}return t}has(e){let t=!1;for(let n=0;n<this._params.length;n++){if(e===this._params[n].name){t=!0;break}}return t}set(e,t){let n;for(n=0;n<this._params.length;n++){const r=this._params[n];if(e===r.name){r.value=t;break}}if(n===this._params.length)this._params.push({name:e,value:t});else for(let t=this._params.length-1;t>n;t--){e===this._params[t].name&&this._params.splice(t,1)}this._update()}toString(){return this._params.map(({name:e,value:t})=>`${e=(e=encodeURIComponent(e)).replace(/%20/g,"+")}=${t=(t=encodeURIComponent(t)).replace(/%20/g,"+")}`).join("&")}toDictionary(){return this._params.reduce((e,t)=>(e[t.name]=t.value,e),{})}_initFromString(e){"?"===e.charAt(0)&&(e=e.slice(1));const t=e.split("&");for(let e=0;e<t.length;e++){const n=t[e];if(""===n)continue;let r,a;const i=n.indexOf("=");-1!==i?(r=n.substring(0,i),a=n.substring(i+1)):(r=n,a=""),r=r.replace(/\+/g," "),a=a.replace(/\+/g," "),r=decodeURIComponent(r),a=decodeURIComponent(a),this._params.push({name:r,value:a})}}_initFromUrlParameters(e){for(let t=0;t<e._params.length;t++){const n=e._params[t],r={name:n.name,value:n.value};this._params.push(r)}}_update(){this.urlInternal&&(this.urlInternal.search=this.toString())}updateFromUrlInternal(){this.urlInternal&&(this._params=[],this._initFromString(this.urlInternal.search))}}},iLty:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e){this._soapResponse=null,this._soapResponse=e,e&&(this._soapResponse.addNamespace("s","http://schemas.xmlsoap.org/soap/envelope/"),this._soapResponse.addNamespace("d","http://schemas.microsoft.com/xrm/2011/Contracts/Services"),this._soapResponse.addNamespace("a","http://schemas.microsoft.com/xrm/2011/Contracts"),this._soapResponse.addNamespace("b","http://schemas.datacontract.org/2004/07/System.Collections.Generic"),this._soapResponse.addNamespace("i","http://www.w3.org/2001/XMLSchema-instance"))}get_soapResponse(){return this._soapResponse}}},iQAP:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="featureControlManager.nativeFCBContextRetrieved";function a(e){const t={};for(const n in e)t[n]={featureName:n,featureControlBitName:n,value:e[n]};return{type:r,payload:t}}},iZ7K:function(e,t,n){"use strict";n.d(t,"n",(function(){return _})),n.d(t,"l",(function(){return m})),n.d(t,"m",(function(){return b})),n.d(t,"p",(function(){return y})),n.d(t,"h",(function(){return f})),n.d(t,"g",(function(){return I})),n.d(t,"o",(function(){return v})),n.d(t,"a",(function(){return S})),n.d(t,"r",(function(){return O})),n.d(t,"s",(function(){return E})),n.d(t,"e",(function(){return w})),n.d(t,"f",(function(){return j})),n.d(t,"C",(function(){return T})),n.d(t,"A",(function(){return N})),n.d(t,"q",(function(){return C})),n.d(t,"B",(function(){return A})),n.d(t,"b",(function(){return F})),n.d(t,"w",(function(){return V})),n.d(t,"c",(function(){return D})),n.d(t,"z",(function(){return M})),n.d(t,"y",(function(){return k})),n.d(t,"x",(function(){return R})),n.d(t,"u",(function(){return L})),n.d(t,"G",(function(){return B})),n.d(t,"D",(function(){return q})),n.d(t,"d",(function(){return H})),n.d(t,"E",(function(){return G})),n.d(t,"v",(function(){return K})),n.d(t,"j",(function(){return Q})),n.d(t,"k",(function(){return X})),n.d(t,"i",(function(){return Y})),n.d(t,"H",(function(){return W})),n.d(t,"F",(function(){return z})),n.d(t,"t",(function(){return P}));var r=n("eXjw"),a=n("odYE"),i=n("5Oca"),o=n("M0zh"),s=n("WPtp"),c=n("w1eR"),l=n("sZ+8"),u=n("69Qu"),d=n("O7zD"),p=n("3/02"),g=n("Lyxw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const h={systemuser:"systemusers",team:"teams"};function f(e,t){if(!e||!e.metadata||!e.metadata.entities)return null;const n=["connectionrole","team","systemuser"],r=["connection"];Object(g.a)(e,p.Y,p.Lc)?r.push("email"):n.push("email");const a=e.metadata.entities[t];if(a&&!a.IsReadOnlyInMobileClient&&(n.find(e=>e===t)&&e.clientHost&&e.clientHost.type===c.a.MobileApplication||r.find(e=>e===t)&&!Object(u.b)(e)&&Object(l.l)(e,t))){const e=Object.assign({},a);return e.IsReadOnlyInMobileClient=!0,e}return a}function m(e,t){const n=f(e,t);return n?n.Initialized:r.a.Uninitialized}function b(e,t){return e.metadata.entitiesByTypeCode[t]}function _(e,t){if(!e||!e.metadata||!e.metadata.entities)return null;const n=e.metadata.entities;for(const e in n)if(n[e].EntitySetName===t)return n[e].EntityLogicalName;return null}function y(e,t){return null==f(e,t)?null:f(e,t).ObjectTypeCode}function v(e,t){const n=f(e,t);if(n&&n.EntitySetName)return n.EntitySetName;const r=h[t];return r||null}function S(e){const t=I(e),n={};for(const r in t)O(e,r)&&(n[r]=t[r]);return n}function O(e,t){const n=f(e,t);return!(!n||!n.hasOwnProperty("IsActivity"))&&n.IsActivity}function C(e,t){const n=f(e,t);return!(!n||!n.hasOwnProperty("HasStateCode"))&&n.HasStateCode}function E(e,t){const n=f(e,t);return!(!n||!n.hasOwnProperty("IsIntersect"))&&n.IsIntersect}function I(e){return e&&e.metadata?e.metadata.entities:null}function w(e,t){if(t===o.c)return o.b;const n=f(e,t);return n&&n.DisplayCollectionName?n.DisplayCollectionName:null}function j(e,t){if(t===o.c)return o.c;const n=f(e,t);return n&&n.DisplayName?n.DisplayName:null}function P(e,t){const n=new Map;for(const r of t)n.set(r,j(e,r));return n}function T(e,t){const n=f(e,t);return n&&n.OneToManyRelationships?n.OneToManyRelationships:null}function N(e,t){const n=f(e,t);return n?n.ManyToOneRelationships:null}function A(e,t,n){const r=T(e,t);return r&&r.hasOwnProperty(n)?r[n]:null}function D(e,t,n){const r=T(e,t);if(!r)return null;const a=[];for(const e in r){const i=r[e];i.ReferencedEntity===t&&i.ReferencingEntity===n&&a.push(i)}return a}function R(e,t,n){const r=f(e,t);return r&&r.ManyToOneRelationships&&r.ManyToOneRelationships.hasOwnProperty(n)?r.ManyToOneRelationships[n]:null}function x(e,t,n,r){const a=f(e,t);if(a&&a.ManyToOneRelationships)for(const e in a.ManyToOneRelationships){const t=a.ManyToOneRelationships[e];if(t.ReferencedEntity===n&&t.ReferencingAttribute===r)return t}return null}function M(e,t,n,r){let a=x(e,t,n,r);if(!a){const i=f(e,t);i&&i.ManyToOneRelationships&&i.IsActivity&&(a=x(e,"activitypointer",n,r))}return a}function F(e,t){const n=T(e,t);if(!n)return null;const r=[];for(const e in n){const a=n[e];if(a.ReferencedEntity===t&&"activityparty"===a.ReferencingEntity){if("campaignactivity"===t&&"campaignactivity_activity_parties"!==e||"bulkoperation"===t&&"bulkoperation_activity_parties"!==e)continue;r.push(a)}}return 1===r.length?r[0]:null}function k(e,t,n){const r=f(e,t);if(r&&r.ManyToOneRelationships)for(const e in r.ManyToOneRelationships){const t=r.ManyToOneRelationships[e];if(t.ReferencingEntityNavigationPropertyName===n)return t}return null}function L(e,t,n){const r=f(e,t);return r&&r.ManyToManyRelationships&&r.ManyToManyRelationships.hasOwnProperty(n)?r.ManyToManyRelationships[n]:null}function B(e,t,n){return A(e,t,n)?0:L(e,t,n)?1:R(e,t,n)?-1:null}function U(e,t,n){const r=T(e,t);if(r)for(const e of Object.keys(r)){const t=r[e];if(t.ReferencedEntityNavigationPropertyName===n)return t}return null}function V(e,t,n){const r=N(e,t);if(r)for(const e of Object.keys(r)){const t=r[e];if(t.ReferencingEntityNavigationPropertyName===n)return t}return null}function z(e,t,n){const r=V(e,t,n);return r||U(e,t,n)}function W(e,t,n){return U(e,t,n)?0:V(e,t,n)?2:-1}function q(e,t){return e&&e.metadata&&e.metadata.entities&&t&&e.metadata.entities[t]?e.metadata.entities[t].PrimaryIdAttribute:null}function H(e,t){const n=f(e,t);return n?new Set(n.AttributeNames):null}function G(e,t){const n=t?f(e,t):null;return n?n.PrimaryNameAttribute:null}function K(e,t){const n=f(e,t);return n&&n.ManyToManyRelationships?n.ManyToManyRelationships:null}function Q(e,t,n){return X(e,new a.a(t,n))}function X(e,t){const n=Object(d.a)(null,e,t.etn),r=Object(i.j)(e,t,n);return r?Object(s.c)(r):null}function Y(e,t){const n=f(e,t);return n&&n.IconVectorName?n.IconVectorName:null}},ijzp:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("SAYH"),a=n("eXjw"),i=n("LbMF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="businessProcessflow.instance.update.navigationentities";function s(e,t){return{type:"businessProcessflow.instance.update.navigationentities.sync",sync:!0,execute({dispatch:n,getState:s},c,l){const u=e.etn+"id",d="bpf_"+u,p=null!=Object(i.a)(s(),t.etn,d)?d:u;null!=Object(i.a)(s(),t.etn,p)||c.TraceManager.getTracer("BusinessProcessFlow.UpdateBusinessProcessNavigationEntities").error("Attribute does not exist",[{name:"attribute",value:p},{name:"entity",value:e.etn}]),n(function(e,t,n){const i={entities:{[t.etn]:{[r.a.toString(t.id)]:{initialized:a.a.Initialized,fields:{[n]:{reference:e,timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:""}}}}}}};return{type:o,payload:i}}(e,t,p))}}}},j63P:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("84PK"),a=n("504W");class i{constructor(e,t,n,o,s,c,l,u,d,p,g,h,f,m,b,_,y,v,S,O,C,E,I,w,j,P,T,N,A,D,R,x,M,F,k,L,B,U,V,z,W,q,H,G,K,Q,X,Y,J,$,Z,ee,te,ne,re,ae,ie,oe,se,ce,le,ue,de,pe,ge,he,fe,me,be,_e,ye,ve,Se,Oe,Ce,Ee,Ie,we,je,Pe,Te,Ne,Ae,De,Re,xe,Me,Fe,ke,Le,Be,Ue,Ve,ze,We,qe,He,Ge,Ke,Qe,Xe,Ye,Je,$e,Ze,et,tt,nt,rt,at,it){this._organizationId=null,this._organizationName=null,this._organizationUniqueName=null,this._languageCode=0,this._enabledLanguages=null,this._currencyDisplayOption=0,this._blockedAttachments=null,this._reportScriptErrors=0,this._orgCultureInfoLcid=0,this._fullNameConventionCode=0,this._fiscalPeriodFormatPeriod=0,this._fiscalYearFormatPrefix=0,this._fiscalYearFormatYear=0,this._fiscalYearFormatSuffix=0,this._fiscalPeriodType=0,this._fiscalYearDisplayCode=0,this._fiscalPeriodConnector=null,this._isAutoSaveEnabled=!0,this._appointmentRichEditorExperience=!1,this._allowLegacyDialogsEmbedding=!1,this._allowLegacyClientExperience=!1,this._enableUnifiedInterfaceShellRefresh=!1,this._isDuplicateDetectionEnabled=!1,this._isDuplicateDetectionEnabledForOnlineCreateUpdate=!1,this._isTelemetryEnabled=!1,this._isTrialOrganization=!1,this._isPreviewOrganization=!1,this._isSandboxOrganization=!1,this._isSovereignCloud=!1,this._advancedDebuggabilitySettings="",this._showWeekNumber=!1,this._isSOPIntegrationEnabled=!1,this._baseCurrencyId=null,this._useSkypeProtocol=!1,this._defaultCountryCode=null,this._geoName=null,this._pricingDecimalPrecision=0,this._isMocaOfflineFeatureEnabled=!1,this._mobileOfflineSyncInterval=0,this._norsyncServerConnectionString=null,this._overrideTrackInCrmBehaviour=!1,this._currentThemeData=null,this._logoTooltip=null,this._logoImagePath=null,this._sessionTimeoutInSeconds=0,this._sessionTimeoutReminderInSeconds=0,this._inactivityTimeoutInSeconds=0,this._inactivityTimeoutReminderInSeconds=0,this._webServiceCallRetryPolicies=null,this._delveUrl=null,this._kmUseExternalPortal=!1,this._kmExternalPortalUrl=null,this._isParature=!1,this._isKMConfigured=!1,this._maxIncidentMergeNumber=0,this._maxChildIncidentNumber=0,this._isConflictDetectionEnabledForMobileClient=!1,this._webResourceHash=null,this._isPowerBIEnabled=!1,this._firstPartyIntegrationSiteUrl=null,this._isMicrosoftFlowEnabled=!1,this._microsoftFlowEnvironmentId=null,this._microsoftFlowFirstPartyIntegrationSiteUrl=null,this._microsoftFlowDestinationUrl=null,this._enableLPAuthoring=!1,this._isContextualHelpEnabled=!1,this._isExternalSearchIndexEnabled=!1,this._sharePointDeploymentType=0,this._isOneDriveEnabled=!1,this._isMSTeamsEnabled=!1,this._isContextualEmailEnabled=!1,this._isRichTextNotesEnabled=!1,this._isAutoDataCaptureV2Enabled=!1,this._isManualSalesForecastingEnabled=!1,this._isActionCardEnabled=!1,this._enableImmersiveSkypeIntegration=!1,this._isEmailMonitoringAllowed=!1,this._allowUnresolvedPartiesOnEmailSend=!1,this._isPresenceEnabled=!1,this._boundDashboardDefaultCardExpanded=!1,this._officePortalUrl="",this._ppacSettingsUrl="",this._customizationUrl="",this._isCrmOrg=!0,this._yammerGroupId=0,this._yammerNetworkName=null,this._yammerOAuthAccessTokenExpired=!1,this._yammerPostMethod=0,this._enableBingMapsIntegration=!1,this._bingMapsApiKey=null,this._availableBingMapLocales=null,this._excludedCountriesForMaps=null,this._bFDatacenter=!1,this._globalHelpUrl=null,this._globalHelpUrlEnabled=!1,this._globalAppendUrlParametersEnabled=!1,this._privacyStatementUrl=null,this._organizationTenant=null,this._securitySettingForEmail=0,this._enableActivitiesTimeLinePerfImprovement=0,this._gridTotalRecordCountLimit=0,this._enableLivePersonaCardUCI=!1,this._livePersonaCardComplianceEnvironment=null,this._livePersonaCardCulture=null,this._livePersonaCardFirstPartyIntegrationUrl=null,this._livePersonaCardRegion=null,this._areJquery3IncompatibleSolutionsInstalled=!1,this._useQuickFindViewForGridSearch=!1,this._newSearchExperienceEnabled=!1,this._improveSearchLoggingEnabled=!1,this._defaultCrmCustomName=null,this._maxUploadFileSize=i.defaultMaxUploadFileSize,this._fiscalCalendarStart=new Date(0,0,1),this._organizationId=Object(a.a)(e)?r.a.get_empty():e,this._organizationName=Object(a.b)(t)?"":t,this._languageCode=n,this._enabledLanguages=Object(a.a)(o)?new Array(0):o,this._currencyDisplayOption=s,this._blockedAttachments=Object(a.b)(c)?"":c,this._maxUploadFileSize=l,this._reportScriptErrors=u,this._orgCultureInfoLcid=h,this._fullNameConventionCode=f,this._fiscalCalendarStart=Object(a.a)(m)?new Date:m,this._fiscalPeriodFormatPeriod=b,this._fiscalYearFormatYear=y,this._fiscalYearFormatPrefix=_,this._fiscalYearFormatSuffix=v,this._fiscalPeriodType=S,this._fiscalYearDisplayCode=O,this._fiscalPeriodConnector=Object(a.b)(C)?"":C,this._isAutoSaveEnabled=d,this._appointmentRichEditorExperience=Ne,this._isDuplicateDetectionEnabled=p,this._isDuplicateDetectionEnabledForOnlineCreateUpdate=g,this._isSOPIntegrationEnabled=E,this._baseCurrencyId=Object(a.a)(I)?r.a.get_empty():I,this._organizationUniqueName=Object(a.b)(w)?"":w,this._useSkypeProtocol=j,this._defaultCountryCode=Object(a.b)(P)?"":P,this._geoName=Object(a.b)(T)?"":T,this._pricingDecimalPrecision=N,this._isTelemetryEnabled=A,this._isMocaOfflineFeatureEnabled=D,this._mobileOfflineSyncInterval=R,this._norsyncServerConnectionString=Object(a.b)(x)?"":x,this._overrideTrackInCrmBehaviour=M,this._showWeekNumber=F,this._currentThemeData=Object(a.b)(k)?"":k,this._logoImagePath=L,this._logoTooltip=B,this._sessionTimeoutInSeconds=U,this._sessionTimeoutReminderInSeconds=V,this._inactivityTimeoutInSeconds=z,this._inactivityTimeoutReminderInSeconds=W,this._delveUrl=Object(a.b)(q)?"":q,this._kmUseExternalPortal=H,this._kmExternalPortalUrl=Object(a.b)(G)?"":G,this._isParature=K,this._isKMConfigured=Q,this._maxIncidentMergeNumber=X,this._maxChildIncidentNumber=Y,this._isConflictDetectionEnabledForMobileClient=J,this._webResourceHash=$,this._isPowerBIEnabled=Z,this._firstPartyIntegrationSiteUrl=ee,this._enableLPAuthoring=te,this._isContextualHelpEnabled=ne,this._isMicrosoftFlowEnabled=re,this._microsoftFlowFirstPartyIntegrationSiteUrl=ae,this._isExternalSearchIndexEnabled=ie,this._microsoftFlowDestinationUrl=oe,this._microsoftFlowEnvironmentId=se,this._sharePointDeploymentType=ce,this._isOneDriveEnabled=le,this._isMSTeamsEnabled=ue,this._isContextualEmailEnabled=de,this._isRichTextNotesEnabled=tt,this._isAutoDataCaptureV2Enabled=pe,this._isManualSalesForecastingEnabled=ge,this._isActionCardEnabled=he,this._enableImmersiveSkypeIntegration=fe,this._isEmailMonitoringAllowed=me,this._allowUnresolvedPartiesOnEmailSend=be,this._isPresenceEnabled=_e,this._boundDashboardDefaultCardExpanded=ye,this._isPreviewOrganization=ve,this._isSandboxOrganization=Se,this._isSovereignCloud=Oe,this._advancedDebuggabilitySettings=Ce,this._officePortalUrl=Ee,this._ppacSettingsUrl=Object(a.b)(et)?"":et,this._customizationUrl=Object(a.b)(rt)?"":rt,this._isCrmOrg=Ie,this._yammerGroupId=we,this._yammerNetworkName=je,this._yammerOAuthAccessTokenExpired=Pe,this._yammerPostMethod=Te,this._enableBingMapsIntegration=Ae,this._bingMapsApiKey=De,this._availableBingMapLocales=Re,this._excludedCountriesForMaps=xe,this._bFDatacenter=Me,this._allowLegacyDialogsEmbedding=Fe,this._allowLegacyClientExperience=ke,this._enableUnifiedInterfaceShellRefresh=Le,this._globalHelpUrl=Be,this._privacyStatementUrl=Ue,this._organizationTenant=Ve,this._securitySettingForEmail=ze,this._enableActivitiesTimeLinePerfImprovement=We,this._gridTotalRecordCountLimit=qe,this._enableLivePersonaCardUCI=He,this._livePersonaCardComplianceEnvironment=Ge,this._livePersonaCardCulture=Ke,this._livePersonaCardFirstPartyIntegrationUrl=Qe,this._livePersonaCardRegion=Xe,this._globalHelpUrlEnabled=Ye,this._globalAppendUrlParametersEnabled=Je,this._areJquery3IncompatibleSolutionsInstalled=$e,this._useQuickFindViewForGridSearch=Ze,this._newSearchExperienceEnabled=at,this._improveSearchLoggingEnabled=it,this._defaultCrmCustomName=nt}get_organizationId(){return this._organizationId}get_organizationName(){return this._organizationName}get_delveUrl(){return this._delveUrl}get_kmUseExternalPortal(){return this._kmUseExternalPortal}get_kmExternalPortalUrl(){return this._kmExternalPortalUrl}get_organizationUniqueName(){return this._organizationUniqueName}get_languageCode(){return this._languageCode}get_enabledLanguages(){return this._enabledLanguages}get_currencyDisplayOption(){return this._currencyDisplayOption}get_blockedAttachments(){return this._blockedAttachments}get_maxUploadFileSize(){return this._maxUploadFileSize}get_reportScriptErrors(){return this._reportScriptErrors}get_orgCultureInfoLcid(){return this._orgCultureInfoLcid}get_fullNameConventionCode(){return this._fullNameConventionCode}get_fiscalCalendarStart(){return this._fiscalCalendarStart}get_fiscalPeriodFormatPeriod(){return this._fiscalPeriodFormatPeriod}get_fiscalPeriodType(){return this._fiscalPeriodType}get_fiscalYearFormatYear(){return this._fiscalYearFormatYear}get_fiscalYearFormatPrefix(){return this._fiscalYearFormatPrefix}get_fiscalYearFormatSuffix(){return this._fiscalYearFormatSuffix}get_fiscalYearDisplayCode(){return this._fiscalYearDisplayCode}get_fiscalPeriodConnector(){return this._fiscalPeriodConnector}get_isAutoSaveEnabled(){return this._isAutoSaveEnabled}get_appointmentRichEditorExperience(){return this._appointmentRichEditorExperience}get_allowLegacyDialogsEmbedding(){return this._allowLegacyDialogsEmbedding}get_allowLegacyClientExperience(){return this._allowLegacyClientExperience}get_enableUnifiedInterfaceShellRefresh(){return this._enableUnifiedInterfaceShellRefresh}get_isDuplicateDetectionEnabled(){return this._isDuplicateDetectionEnabled}get_isDuplicateDetectionEnabledForOnlineCreateUpdate(){return this._isDuplicateDetectionEnabledForOnlineCreateUpdate}get_isTelemetryEnabled(){return this._isTelemetryEnabled}get_isTrialOrganization(){return this._isTrialOrganization}get_isPreviewOrganization(){return this._isPreviewOrganization}get_isSandboxOrganization(){return this._isSandboxOrganization}get_isSovereignCloud(){return this._isSovereignCloud}get_advancedDebuggabilitySettings(){return this._advancedDebuggabilitySettings}get_isMocaOfflineFeatureEnabled(){return this._isMocaOfflineFeatureEnabled}get_mobileOfflineSyncInterval(){return this._mobileOfflineSyncInterval}get_norsyncServerConnectionString(){return this._norsyncServerConnectionString}get_isSOPIntegrationEnabled(){return this._isSOPIntegrationEnabled}get_baseCurrencyId(){return this._baseCurrencyId}get_defaultCountryCode(){return this._defaultCountryCode}get_geoName(){return this._geoName}get_useSkypeProtocol(){return this._useSkypeProtocol}get_overrideTrackInCrmBehaviour(){return this._overrideTrackInCrmBehaviour}get_currentThemeData(){return this._currentThemeData}get_logoImagePath(){return this._logoImagePath}get_logoTooltip(){return this._logoTooltip}get_sessionTimeoutInSeconds(){return this._sessionTimeoutInSeconds}get_sessionTimeoutReminderInSeconds(){return this._sessionTimeoutReminderInSeconds}get_inactivityTimeoutInSeconds(){return this._inactivityTimeoutInSeconds}get_inactivityTimeoutReminderInSeconds(){return this._inactivityTimeoutReminderInSeconds}get_pricingDecimalPrecision(){return this._pricingDecimalPrecision}get_showWeekNumber(){return this._showWeekNumber}get_isParature(){return this._isParature}get_isKMConfigured(){return this._isKMConfigured}get_maxIncidentMergeNumber(){return this._maxIncidentMergeNumber}get_maxChildIncidentNumber(){return this._maxChildIncidentNumber}get_isConflictDetectionEnabledForMobileClient(){return this._isConflictDetectionEnabledForMobileClient}get_webResourceHash(){return this._webResourceHash}get_isPowerBIEnabled(){return this._isPowerBIEnabled}get_firstPartyIntegrationSiteUrl(){return this._firstPartyIntegrationSiteUrl}get_isMicrosoftFlowEnabled(){return this._isMicrosoftFlowEnabled}get_microsoftFlowEnvironmentId(){return this._microsoftFlowEnvironmentId}get_microsoftFlowFirstPartyIntegrationSiteUrl(){return this._microsoftFlowFirstPartyIntegrationSiteUrl}get_microsoftFlowDestinationUrl(){return this._microsoftFlowDestinationUrl}get_enableLPAuthoring(){return this._enableLPAuthoring}get_isContextualHelpEnabled(){return this._isContextualHelpEnabled}get_isExternalSearchIndexEnabled(){return this._isExternalSearchIndexEnabled}get_sharePointDeploymentType(){return this._sharePointDeploymentType}get_isOneDriveEnabled(){return this._isOneDriveEnabled}get_isMSTeamsEnabled(){return this._isMSTeamsEnabled}get_isContextualEmailEnabled(){return this._isContextualEmailEnabled}get_isRichTextNotesEnabled(){return this._isRichTextNotesEnabled}get_isAutoDataCaptureV2Enabled(){return this._isAutoDataCaptureV2Enabled}get_isManualSalesForecastingEnabled(){return this._isManualSalesForecastingEnabled}get_isActionCardEnabled(){return this._isActionCardEnabled}get_enableImmersiveSkypeIntegration(){return this._enableImmersiveSkypeIntegration}get_isEmailMonitoringAllowed(){return this._isEmailMonitoringAllowed}get_allowUnresolvedPartiesOnEmailSend(){return this._allowUnresolvedPartiesOnEmailSend}get_isPresenceEnabled(){return this._isPresenceEnabled}get_boundDashboardDefaultCardExpanded(){return this._boundDashboardDefaultCardExpanded}get_officePortalUrl(){return this._officePortalUrl}get_ppacSettingsUrl(){return this._ppacSettingsUrl}get_customizationUrl(){return this._customizationUrl}get_isCrmOrg(){return this._isCrmOrg}get_yammerGroupId(){return this._yammerGroupId}get_yammerNetworkName(){return this._yammerNetworkName}get_yammerOAuthAccessTokenExpired(){return this._yammerOAuthAccessTokenExpired}get_yammerPostMethod(){return this._yammerPostMethod}get_enableBingMapsIntegration(){return this._enableBingMapsIntegration}get_bingMapsApiKey(){return this._bingMapsApiKey}get_availableBingMapLocales(){return this._availableBingMapLocales}get_excludedCountriesForMaps(){return this._excludedCountriesForMaps}get_bfDatacenter(){return this._bFDatacenter}get_globalHelpUrl(){return this._globalHelpUrl}get_globalHelpUrlEnabled(){return this._globalHelpUrlEnabled}get_globalAppendUrlParametersEnabled(){return this._globalAppendUrlParametersEnabled}get_privacyStatementUrl(){return this._privacyStatementUrl}get_organizationTenant(){return this._organizationTenant}get_securitySettingForEmail(){return this._securitySettingForEmail}get_enableActivitiesTimeLinePerfImprovement(){return this._enableActivitiesTimeLinePerfImprovement}get_gridTotalRecordCountLimit(){return this._gridTotalRecordCountLimit}get_enableLivePersonaCardUCI(){return this._enableLivePersonaCardUCI}get_livePersonaCardComplianceEnvironment(){return this._livePersonaCardComplianceEnvironment}get_livePersonaCardCulture(){return this._livePersonaCardCulture}get_livePersonaCardFirstPartyIntegrationUrl(){return this._livePersonaCardFirstPartyIntegrationUrl}get_defaultCrmCustomName(){return this._defaultCrmCustomName}get_livePersonaCardRegion(){return this._livePersonaCardRegion}get_areJquery3IncompatibleSolutionsInstalled(){return this._areJquery3IncompatibleSolutionsInstalled}get_useQuickFindViewForGridSearch(){return this._useQuickFindViewForGridSearch}get_newSearchExperienceEnabled(){return this._newSearchExperienceEnabled}get_improveSearchLoggingEnabled(){return this._improveSearchLoggingEnabled}get_webServiceCallRetryPolicies(){return this._webServiceCallRetryPolicies}set_webServiceCallRetryPolicies(e){return this._webServiceCallRetryPolicies=e,e}getObjectData(){const e={};return e.organizationid=this._organizationId.getObjectData(),e.organizationname=this._organizationName,e.languagecode=this._languageCode,e.enabledlanguages=this._enabledLanguages,e.currencydisplayoption=this._currencyDisplayOption,e.blockedattachments=this._blockedAttachments,e.maxuploadfilesize=this._maxUploadFileSize,e.reportscripterrors=this._reportScriptErrors,e.orgcultureinfolcid=this._orgCultureInfoLcid,e.fullnameconventioncode=this._fullNameConventionCode,e.fiscalcalendarstart=this._fiscalCalendarStart,e.issopintegrationenabled=this._isSOPIntegrationEnabled,e.basecurrencyid=this._baseCurrencyId.getObjectData(),e.webservicecallretrypolicies=this._webServiceCallRetryPolicies,e.isAutoSaveEnabled=this._isAutoSaveEnabled,e.appointmentRichEditorExperience=this._appointmentRichEditorExperience,e.allowLegacyDialogsEmbedding=this._allowLegacyDialogsEmbedding,e.allowLegacyClientExperience=this._allowLegacyClientExperience,e.enableUnifiedInterfaceShellRefresh=this._enableUnifiedInterfaceShellRefresh,e.isDuplicateDetectionEnabled=this._isDuplicateDetectionEnabled,e.isDuplicateDetectionEnabledForOnlineCreateUpdate=this._isDuplicateDetectionEnabledForOnlineCreateUpdate,e.organizationuniquename=this._organizationUniqueName,e.useskypeprotocol=this.get_useSkypeProtocol(),e.defaultcountrycode=this.get_defaultCountryCode(),e.geoName=this.get_geoName(),e.pricingdecimalprecision=this.get_pricingDecimalPrecision(),e.istelemetryenabled=this._isTelemetryEnabled,e.ismocaofflinefeatureenabled=this._isMocaOfflineFeatureEnabled,e.mobileOfflineSyncInterval=this._mobileOfflineSyncInterval,e.norsyncServerConnectionString=this._norsyncServerConnectionString,e.overridetrackincrmbehaviour=this.get_overrideTrackInCrmBehaviour(),e.defaultthemedata=this.get_currentThemeData(),e.logoImagePath=this._logoImagePath,e.logoTooltip=this._logoTooltip,e.fiscalperiodformatperiod=this._fiscalPeriodFormatPeriod,e.fiscalyearformatprefix=this._fiscalYearFormatPrefix,e.fiscalyearformatyear=this._fiscalYearFormatYear,e.fiscalyearformatsuffix=this._fiscalYearFormatYear,e.fiscalperiodtype=this._fiscalPeriodType,e.fiscalyeardisplaycode=this._fiscalYearDisplayCode,e.fiscalperiodconnector=this._fiscalPeriodConnector,e.showweeknumber=this._showWeekNumber,e.kmuseexternalportal=this._kmUseExternalPortal,e.kmuseexternalportalurl=this._kmExternalPortalUrl,e.isParature=this._isParature,e.iskmconfigured=this._isKMConfigured,e.webresourcehash=this._webResourceHash,e.maxincidentmergenumber=this._maxIncidentMergeNumber,e.maxchildincidentnumber=this._maxChildIncidentNumber,e.isconflictdetectionenabledformobileclient=this._isConflictDetectionEnabledForMobileClient,e.enablelpauthoring=this._enableLPAuthoring,e.isContextualHelpEnabled=this._isContextualHelpEnabled,e.isMicrosoftFlowEnabled=this._isMicrosoftFlowEnabled,e.microsoftFlowEnvironmentId=this._microsoftFlowEnvironmentId,e.isExternalSearchIndexEnabled=this._isExternalSearchIndexEnabled,e.microsoftFlowFirstPartyIntegrationSiteUrl=this._microsoftFlowFirstPartyIntegrationSiteUrl,e.microsoftFlowDestinationUrl=this._microsoftFlowDestinationUrl,e.sharepointdeploymenttype=this._sharePointDeploymentType,e.isonedriveenabled=this._isOneDriveEnabled,e.ismsteamsenabled=this._isMSTeamsEnabled,e.isRichTextNotesEnabled=this._isRichTextNotesEnabled,e.iscontextualemailenabled=this._isContextualEmailEnabled,e.isAutoDataCaptureV2Enabled=this._isAutoDataCaptureV2Enabled,e.ismanualsalesforecastingenabled=this._isManualSalesForecastingEnabled,e.isActionCardEnabled=this._isActionCardEnabled,e.enableImmersiveSkypeIntegration=this._enableImmersiveSkypeIntegration,e.isEmailMonitoringAllowed=this.get_isEmailMonitoringAllowed(),e.allowUnresolvedPartiesOnEmailSend=this.get_allowUnresolvedPartiesOnEmailSend(),e.isPresenceEnabled=this.get_isPresenceEnabled(),e.boundDashboardDefaultCardExpanded=this.get_boundDashboardDefaultCardExpanded(),e.organizationTenant=this.get_organizationTenant(),e.securitySettingForEmail=this._securitySettingForEmail,e.enableActivitiesTimeLinePerfImprovement=this._enableActivitiesTimeLinePerfImprovement,e.gridTotalRecordCountLimit=this._gridTotalRecordCountLimit,e.enableLivePersonaCardUCI=this._enableLivePersonaCardUCI,e.livePersonaCardComplianceEnvironment=this._livePersonaCardComplianceEnvironment,e.livePersonaCardCulture=this._livePersonaCardCulture,e.livePersonaCardFirstPartyIntegrationUrl=this._livePersonaCardFirstPartyIntegrationUrl,e.livePersonaCardRegion=this._livePersonaCardRegion,e.areJquery3IncompatibleSolutionsInstalled=this._areJquery3IncompatibleSolutionsInstalled,e.useQuickFindViewForGridSearch=this._useQuickFindViewForGridSearch,e.newSearchExperienceEnabled=this._newSearchExperienceEnabled,e.improveSearchLoggingEnabled=this._improveSearchLoggingEnabled,e}getWebServiceCallRetryPolicy(e){if(!this._webServiceCallRetryPolicies)return null;for(let t=0;t<this._webServiceCallRetryPolicies.length;t++){const n=this._webServiceCallRetryPolicies[t];if(e.toLowerCase().indexOf(n.WebServiceUrl.toLowerCase())>=0)return n}return null}static createFromObjectData(e){const t=r.a.createFromObjectData(e.organizationid),n=e.organizationname,a=e.fiscalcalendarstart,o=e.fiscalperiodformatperiod,s=e.fiscalyearformatprefix,c=e.fiscalyearformatyear,l=e.fiscalyearformatsuffix,u=e.fiscalperiodtype,d=e.fiscalyeardisplaycode,p=e.fiscalperiodconnector,g=e.issopintegrationenabled,h=e.languagecode,f=e.enabledlanguages,m=e.currencydisplayoption,b=e.blockedattachments,_=e.maxuploadfilesize,y=e.reportscripterrors,v=e.isAutoSaveEnabled,S=e.appointmentRichEditorExperience,O=e.isDuplicateDetectionEnabled,C=e.isDuplicateDetectionEnabledForOnlineCreateUpdate,E=e.orgcultureinfolcid,I=e.fullnameconventioncode,w=r.a.createFromObjectData(e.basecurrencyid),j=e.organizationuniquename,P=e.useskypeprotocol,T=e.defaultcountrycode,N=e.geoName,A=e.pricingdecimalprecision,D=e.istelemetryenabled,R=e.ismocaofflinefeatureenabled,x=e.mobileOfflineSyncInterval,M=e.norsyncServerConnectionString,F=e.overridetrackincrmbehaviour,k=e.showweeknumber,L=e.defaultthemedata,B=e.delveurl,U=e.kmUseExternalPortal,V=e.kmExternalPortalUrl,z=e.isParature,W=e.iskmconfigured,q=e.maxincidentmergenumber,H=e.maxchildincidentnumber,G=e.webresourcehash,K=e.isconflictdetectionenabledformobileclient,Q=e.enablelpauthoring,X=e.iscontextualhelpenabled,Y=e.ispowerbienabled,J=e.firstpartyintegrationsiteurl,$=e.isMicrosoftFlowEnabled,Z=e.microsoftFlowFirstPartyIntegrationSiteUrl,ee=e.isExternalSearchIndexEnabled,te=e.microsoftFlowDestinationUrl,ne=e.microsoftFlowEnvironmentId,re=e.sharepointdeploymenttype,ae=e.isonedriveenabled,ie=e.ismsteamsenabled,oe=e.iscontextualemailenabled,se=e.isRichTextNotesEnabled,ce=e.isautodatacapturev2enabled,le=e.ismanualsalesforecastingenabled,ue=e.isActionCardEnabled,de=e.enableImmersiveSkypeIntegration,pe=e.isEmailMonitoringAllowed,ge=e.allowUnresolvedPartiesOnEmailSend,he=e.isPresenceEnabled,fe=e.boundDashboardDefaultCardExpanded,me=e.isPreviewOrganization,be=e.isSandboxOrganization,_e=e.isSovereignCloud,ye=e.advancedDebuggabilitySettings,ve=e.logoImagePath,Se=e.logoTooltip,Oe=e.sessionTimeoutInSeconds,Ce=e.sessionTimeoutReminderInSeconds,Ee=e.inactivityTimeoutInSeconds,Ie=e.inactivityTimeoutReminderInSeconds,we=e.officePortalUrl,je=e.ppacSettingsUrl,Pe=e.customizationUrl,Te=e.isCrmOrg,Ne=e.yammerGroupId,Ae=e.yammerNetworkName,De=e.yammerOAuthAccessTokenExpired,Re=e.yammerPostMethod,xe=e.enableBingMapsIntegration,Me=e.bingMapApiKey,Fe=e.availableBingMapLocales,ke=e.excludedCountriesForMaps,Le=e.bFDatacenter,Be=e.allowLegacyDialogsEmbedding,Ue=e.allowLegacyClientExperience,Ve=e.enableUnifiedInterfaceShellRefresh,ze=e.globalHelpUrl,We=e.privacyStatementUrl,qe=e.organizationTenant,He=e.securitySettingForEmail,Ge=e.enableActivitiesTimeLinePerfImprovement,Ke=e.gridTotalRecordCountLimit,Qe=e.enableLivePersonaCardUCI,Xe=e.livePersonaCardComplianceEnvironment,Ye=e.livePersonaCardCulture,Je=e.livePersonaCardFirstPartyIntegrationUrl,$e=e.livePersonaCardRegion,Ze=e.globalHelpUrlEnabled,et=e.globalAppendUrlParametersEnabled,tt=e.areJquery3IncompatibleSolutionsInstalled,nt=e.useQuickFindViewForGridSearch,rt=e.defaultCrmCustomName,at=e.newSearchExperienceEnabled,it=e.improveSearchLoggingEnabled,ot=new i(t,n,h,f,m,b,_,y,v,O,C,E,I,a,o,s,c,l,u,d,p,g,w,j,P,T,N,A,D,R,x,M,F,k,L,ve,Se,Oe,Ce,Ee,Ie,B,U,V,z,W,q,H,K,G,Y,J,Q,X,$,Z,ee,te,ne,re,ae,ie,oe,ce,le,ue,de,pe,ge,he,fe,me,be,_e,ye,we,Te,Ne,Ae,De,Re,S,xe,Me,Fe,ke,Le,Be,Ue,Ve,ze,We,qe,He,Ge,Ke,Qe,Xe,Ye,Je,$e,Ze,et,tt,nt,je,se,rt,Pe,at,it);return ot.set_webServiceCallRetryPolicies(e.webservicecallretrypolicies),ot}}i.defaultMaxUploadFileSize=5242880},j6Db:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n("UR8A"),a="CustomControlFramework",i=new(function(){function e(){}return e.prototype.reportUsage=function(e,t){var n={eventName:"uci_controlframework_usage",eventParameters:this.generateEventParams(e,null,null,t)};r.b&&r.b.Reporting&&r.b.Reporting.reportEvent&&r.b.Reporting.reportEvent(n)},e.prototype.reportEventFailure=function(e,t,n,i,o,s){var c,l,u=(null===(c=null==e?void 0:e.manifest)||void 0===c?void 0:c.ConstructorName)||(null===(l=null==e?void 0:e.configuration)||void 0===l?void 0:l.CustomControlId)||"Unknown";s&&"ControlFramework"===s&&(u=a+"."+u),r.b&&r.b.Reporting&&r.b.Reporting.reportFailure&&r.b.Reporting.reportFailure(u,t,o,this.generateEventParams(e,n,i))},e.prototype.reportEventSuccess=function(e,t){var n=e.manifest?e.manifest.ConstructorName:e.configuration.CustomControlId;n=a+"."+n,r.b&&r.b.Reporting&&r.b.Reporting.reportSuccess&&r.b.Reporting.reportSuccess(n,this.generateEventParams(e,t))},e.prototype.generateEventParams=function(e,t,n,r){var a=[],i={name:"ControlName",value:e?e.controlId:""},o={name:"ControlId",value:e&&e.manifest?e.manifest.CustomControlId:""},s={name:"APIName",value:t},c={name:"HostPage",value:e?e.pageType:""},l={name:"ResourceArrayLength",value:e&&e.manifest?e.manifest.Properties.Resources.length:""};if(a.push(i),a.push(o),a.push(c),a.push(l),r){var u={name:"ControlLoadStatus",value:r};a.push(u)}if(t&&a.push(s),n){var d={name:"ParentCCContext",value:n};a.push(d)}if(e.propBagData){var p={name:"Entity",value:e.propBagData&&e.propBagData.modeData?e.propBagData.modeData.entityTypeName:null};a.push(p)}return a},e}())},jAuy:function(e,t,n){"use strict";n.d(t,"h",(function(){return p})),n.d(t,"g",(function(){return g})),n.d(t,"j",(function(){return h})),n.d(t,"k",(function(){return _})),n.d(t,"f",(function(){return y})),n.d(t,"d",(function(){return S})),n.d(t,"c",(function(){return O})),n.d(t,"m",(function(){return C})),n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return b})),n.d(t,"e",(function(){return E})),n.d(t,"l",(function(){return I})),n.d(t,"i",(function(){return f}));var r=n("9fGf"),a=n("BFlg"),i=n("jRy5"),o=n("nJrx"),s=n("Lyxw"),c=n("3/02"),l=n("P6DH"),u=n("NjDY"),d=n("69Qu");function p(e,t,n){if(!n)return!1;const r=Object(s.a)(e,c.Bb,c.h),a=Object(s.c)(e,c.Bb),i=Object(s.c)(e,c.Cb);switch(t){case"Account_ActivityPointers":case"Contact_ActivityPointers":case"Opportunity_ActivityPointers":return!0;case"opportunity_customer_accounts":case"quote_customer_accounts":case"order_customer_accounts":case"invoice_customer_accounts":case"incident_customer_accounts":case"account_contracts_as_customer":case"opportunity_customer_contacts":case"quote_customer_contacts":case"order_customer_contacts":case"invoice_customer_contacts":case"incident_customer_contacts":case"contact_contracts_as_customer":return r||a&&i}return!1}function g(e,t){return!!(t===r.a.Phone&&e&&e.Name===a.m&&e.Parameters&&e.Parameters.EnableEditing&&e.Parameters.EnableEditing.Value&&"yes"===e.Parameters.EnableEditing.Value.toLowerCase())}function h(e){const t=new DOMParser,n=new XMLSerializer;if(e){const r=t.parseFromString(e,"text/xml");if(r){const e=Array.prototype.slice.call(r.getElementsByTagName("condition"));return e&&e.forEach(e=>{e.getAttribute("value")&&e.setAttribute("value","X"),e.getAttribute("uiname")&&e.setAttribute("uiname","X");const t=Array.prototype.slice.call(e.getElementsByTagName("value"));t&&t.forEach(e=>{e.getAttribute("uiname")&&e.setAttribute("uiname","X"),e.textContent="X"})}),n.serializeToString(r)}return null}return null}function f(e){const t=new DOMParser;if(e){const n=t.parseFromString(e,"text/xml");if(n){const e=Array.prototype.slice.call(n.getElementsByTagName("condition")),t=Array.prototype.slice.call(n.getElementsByTagName("link-entity"));if(t&&e)for(const n of t)if("outer"===n.getAttribute("link-type"))for(const t of e)if(t.getAttribute("entityname")===n.getAttribute("alias"))return!0;if(e)for(const t of e)if(t.getAttribute("entityname"))return!1}}return!0}function m(e){if(e){const t=Array.prototype.slice.call(e.getElementsByTagName("attribute"));if(t)for(const e of t)if(e.getAttribute("alias")===l.c&&e.getAttribute("rowaggregate")===l.d)return e}return null}function b(e){if(e){if(m((new DOMParser).parseFromString(e,"text/xml")))return!0}return!1}function _(e){if(e){const t=new DOMParser,n=new XMLSerializer,r=t.parseFromString(e,"text/xml"),a=m(r);return a?(a.parentNode.removeChild(a),n.serializeToString(r)):e}return null}function y(e,t){for(const n of e)if(n.value===t)return n.text;return null}function v(e){return e?e+"_url":null}function S(e,t){return t.contextTokenType===i.a.MainGrid&&e}function O(e,t){return S(e,t)||Object(o.a)()}function C(e){e&&e.Name===a.p&&e.Parameters&&e.Parameters.EnableFiltering&&(e.Parameters.EnableFiltering.Value="yes")}function E(e){return Object(s.a)(e,c.j,c.h,c.i)}function I(e){return Object(s.a)(e,c.Db,c.h)&&Object(d.b)(e)&&!Object(u.C)(e)}},jCkl:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="appprogressindicator.create";function a(e){return{type:r,payload:{inProgress:!0,progressMessage:e}}}},jFgV:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("504W"),a=n("NMtn"),i=n("IvgJ"),o=n("P68g");class s{constructor(e){this._options=null,this._optionsInDisplayOrder=null,Object(a.d)(e,"options"),this._optionsInDisplayOrder=e,this._options=s._CreateDictionaryFromOptionsInDisplayOrder(e)}get_options(){return this._options}get_optionsInDisplayOrder(){return this._optionsInDisplayOrder}getObjectData(){return Object(r.a)(this._optionsInDisplayOrder)?{}:{optionsindisplayorder:Object(o.a)(this._optionsInDisplayOrder,e=>e.getObjectData())}}getODataObject(){if(Object(r.a)(this.get_optionsInDisplayOrder()))return null;const e={},t=[],n=this.get_optionsInDisplayOrder();for(const e in n){const r={key:e,value:n[e]};t.push(r.value.getODataObject())}return e.Options=t,e}static createFromObjectData(e){const t=e.optionsindisplayorder?e.optionsindisplayorder:{};return new s(Object(o.a)(t,e=>i.a.createFromObjectData(e)))}static createFromOData(e){const t={};for(let n=0;n<e.length;++n){const r=i.a.createFromOData(e[n]);t[n.toString()]=r}return new s(t)}static _CreateDictionaryFromOptionsInDisplayOrder(e){const t={};for(const n in e){const r={key:n,value:e[n]}.value;t[r.get_ValueString()]=r}return t}}},jMf1:function(e,t){
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},jPIj:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{static createAttribute(e,t,n){const r=e.createAttribute(t);return r.value=n,r}}},jRHm:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c}));var r=n("dHD5"),a=n("BFlg"),i=n("P6DH");const o="dataset.mark.selected.entity";function s(e,t,n){return{type:"mark.selected.entity.async",execute({dispatch:o,getState:s},l){const u=l.TraceManager.getTracer(a.z),d=a.x+".markedSelectedRelatedEntityAction";try{const a=Object(r.v)(t),p=s();return Object(i.Q)(p,e,t)!==n&&o(c(e,a,n)),u.info("Marking "+n+" as the selected entity"),l.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){const t="Marking "+n+" as selected entity failed";l.EventManager.ReportComponentFailure(d,Error(t))}}}}function c(e,t,n){return{type:o,payload:n,meta:{pageId:e,dataSetContextKey:t}}}},jRy5:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.MainForm=1]="MainForm",e[e.MainGrid=2]="MainGrid",e[e.SearchWidget=3]="SearchWidget",e[e.GridRow=4]="GridRow",e[e.SubGrid=5]="SubGrid",e[e.UnboundForm=6]="UnboundForm",e[e.QuickViewForm=7]="QuickViewForm",e[e.RelatedEntity=8]="RelatedEntity",e[e.AssociatedGrid=9]="AssociatedGrid",e[e.FormControl=10]="FormControl",e[e.LookupDialog=11]="LookupDialog",e[e.CustomGrid=12]="CustomGrid"}(r||(r={}))},jS4H:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){var n;return null===(n=null==e?void 0:e.pages)||void 0===n?void 0:n[t]}n.d(t,"a",(function(){return r}))},jTSi:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("i1f0"),a=n("dGG5"),i=n("/Ikn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="form.notification.clear";function s(e,t,n){const s=[{name:"uniqueId",value:n}];return{type:o,sync:!0,execute({dispatch:o,getState:l},u,d){try{const d=Object(r.i)(l(),t),p=d?Object.keys(d):[];if(s.push({name:"objectKeys.length",value:p.length}),d&&p.length>0){if(n){if(!!p.find(e=>e===n)){const r=u.ScriptManager.getContainer(t).getEventManager();return Object(i.a)(e,n,d[n].Buttons,r),Object(a.a)(e,n,d[n].MessagePlaceholders,r),o(c(t,n)),!0}return!1}return p.forEach(n=>{const r=u.ScriptManager.getContainer(t).getEventManager();Object(i.a)(e,n,d[n].Buttons,r),Object(a.a)(e,n,d[n].MessagePlaceholders,r)}),o(c(t,n)),!0}return!1}catch(e){return s.push({name:"CorrelationId",value:d.correlationId},{name:"ContextId",value:d.contextId},{name:"ActionStack",value:d.stack}),u.EventManager.ReportComponentFailure("Forms.ClearFormNotification",Error(JSON.stringify(e)),void 0,s),!1}},getFailureParameters:(e,t)=>s}}function c(e,t){return{type:o,payload:{uniqueId:t},meta:{pageId:e}}}},jYot:function(e,t,n){"use strict";n.d(t,"d",(function(){return $})),n.d(t,"b",(function(){return Z})),n.d(t,"c",(function(){return ee})),n.d(t,"a",(function(){return te})),n.d(t,"f",(function(){return ne})),n.d(t,"e",(function(){return re}));var r=n("504W"),a=n("Qwz5"),i=n("Xe7f");function o(e){const t=e;return Object(a.a)("Target",t.get_target(),"unknown","a:Entity")+Object(a.a)("SuppressDuplicateDetection",t.get_suppressDuplicateDetection(),"boolean")+Object(a.a)("CalculateMatchCodeSynchronously",t.get_calculateMatchCodeSynchronously(),"boolean")+Object(a.a)("SolutionUniqueName",t.get_solutionUniqueName(),"string")+Object(a.a)("MaintainLegacyAppServerBehavior",t.get_maintainLegacyAppServerBehavior(),"boolean")+Object(a.a)("ReturnRowVersion",t.get_returnRowVersion(),"boolean")}function s(e){if(Object(r.a)(e))return null;let t=null,n=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Target']/b:value");if(!Object(r.a)(n)){const e=n.selectSingleNode("entity");Object(r.a)(e)||(n=e),t=Object(a.b)(n)}const o=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='SuppressDuplicateDetection']/b:value");let s;if(Object(r.a)(o))throw Error.notImplemented();s=Boolean.parse(o.get_innerText()).valueOf();const c=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='CalculateMatchCodeSynchronously']/b:value");let l;if(Object(r.a)(c))throw Error.notImplemented();l=Boolean.parse(c.get_innerText()).valueOf();const u=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='SolutionUniqueName']/b:value"),d=Object(r.a)(u)?null:u.get_innerText(),p=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='MaintainLegacyAppServerBehavior']/b:value");let g;if(Object(r.a)(p))throw Error.notImplemented();g=Boolean.parse(p.get_innerText()).valueOf();const h=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='ReturnRowVersion']/b:value");let f;if(Object(r.a)(h))throw Error.notImplemented();return f=Boolean.parse(h.get_innerText()).valueOf(),new i.a(t,s,l,d,g,f)}var c=n("g73c"),l=n("6zk2"),u=n("AWUt"),d=n("qK01");function p(e){return Object(a.a)("Target",e.get_target(),"lookup")+Object(a.a)("SolutionUniqueName",e.get_solutionUniqueName(),"string")+Object(a.a)("ConcurrencyBehavior",e.get_concurrencyBehavior(),"unknown","c:ConcurrencyBehavior")}function g(e){if(Object(r.a)(e))return null;const t=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Target']/b:value"),n=Object(r.a)(t)?null:Object(u.a)(t),a=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='SolutionUniqueName']/b:value"),i=Object(r.a)(a)?null:a.get_innerText(),o=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='ConcurrencyBehavior']/b:value");let s;if(Object(r.a)(o))throw Error.notImplemented();return s=Object(c.b)(l.a,Object(r.a)(o)?null:o.get_innerText()),new d.a(n,i,s)}var h=n("6G9J"),f=n("MQpb"),m=n("hirD");function b(e){const t=e;return Object(a.a)("Requests",t.get_requests(),"unknown","c:OrganizationRequestCollection",'xmlns:c="http://schemas.microsoft.com/xrm/2012/Contracts"')+Object(a.a)("Settings",t.get_settings(),"unknown","c:ExecuteMultipleSettings",'xmlns:c="http://schemas.microsoft.com/xrm/2012/Contracts"')}function _(e){if(Object(r.a)(e))return null;const t=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Requests']/b:value"),n=Object(r.a)(t)?null:Object(f.a)(t),a=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Settings']/b:value"),i=Object(r.a)(a)?null:Object(h.a)(a);return new m.a(n,i)}var y=n("CrQY");function v(e){const t=e;return Object(a.a)("SearchText",t.get_searchText(),"string")+Object(a.a)("EntityGroupName",t.get_entityGroupName(),"string")+Object(a.a)("EntityNames",t.get_entityNames(),"unknown","sa:ArrayOfstring",'xmlns:sa="http://schemas.microsoft.com/2003/10/Serialization/Arrays"')}function S(e){if(Object(r.a)(e))return null;const t=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='SearchText']/b:value"),n=Object(r.a)(t)?null:t.get_innerText(),a=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='EntityGroupName']/b:value"),i=Object(r.a)(a)?null:a.get_innerText(),o=e.selectNodes(".//a:KeyValuePairOfstringanyType[b:key='EntityNames']/b:value/sa:string");let s=null;if(!Object(r.a)(o)){s=new Array(o.get_count());for(let e=0;e<o.get_count();e++)s[e]=o.get_item(e).get_innerText()}return new y.a(n,i,s)}var O=n("IVVt"),C=n("Jj4w");function E(e){const t=e;return Object(a.a)("EntityMoniker",t.get_entityMoniker(),"lookup")+Object(a.a)("TargetEntityName",t.get_targetEntityName(),"string")+Object(a.a)("TargetFieldType",t.get_targetFieldType(),"unknown","a:TargetFieldType")}function I(e){if(Object(r.a)(e))return null;const t=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='EntityMoniker']/b:value"),n=Object(r.a)(t)?null:Object(u.a)(t),a=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='TargetEntityName']/b:value"),i=Object(r.a)(a)?null:a.get_innerText(),o=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='TargetFieldType']/b:value"),s=Object(c.b)(O.a,Object(r.a)(o)?null:o.get_innerText());return new C.a(n,i,s)}var w=n("84PK"),j=n("EHQq");function P(e){const t=e;return Object(a.a)("CurrentEntityId",t.get_currentEntityId(),"uniqueidentifier")+Object(a.a)("CurrentEntityLogicalName",t.get_currentEntityLogicalName(),"string")+Object(a.a)("NextEntityId",t.get_nextEntityId(),"uniqueidentifier")+Object(a.a)("NextEntityLogicalName",t.get_nextEntityLogicalName(),"string")+Object(a.a)("NewActiveStageId",t.get_newActiveStageId(),"uniqueidentifier")+Object(a.a)("NewTraversedPath",t.get_newTraversedPath(),"string")+Object(a.a)("ProcessId",t.get_processId(),"uniqueidentifier")+Object(a.a)("ProcessInstanceId",t.get_processInstanceId(),"uniqueidentifier")}function T(e){if(Object(r.a)(e))return null;const t=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='CurrentEntityId']/b:value"),n=Object(r.a)(t)?null:new w.a(t.get_innerText()),a=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='CurrentEntityLogicalName']/b:value"),i=Object(r.a)(a)?null:a.get_innerText(),o=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='NextEntityId']/b:value"),s=Object(r.a)(o)?null:new w.a(o.get_innerText()),c=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='NextEntityLogicalName']/b:value"),l=Object(r.a)(c)?null:c.get_innerText(),u=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='NewActiveStageId']/b:value"),d=Object(r.a)(u)?null:new w.a(u.get_innerText()),p=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='NewTraversedPath']/b:value"),g=Object(r.a)(p)?null:p.get_innerText(),h=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='ProcessId']/b:value"),f=Object(r.a)(h)?null:new w.a(h.get_innerText()),m=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='ProcessInstanceId']/b:value"),b=Object(r.a)(m)?null:new w.a(m.get_innerText());return new j.a(n,i,s,l,d,g,f,b)}var N=n("47MF");function A(e){const t=e;return Object(a.a)("OuterQuery",t.get_outerQuery(),"unknown","a:FetchExpression")+Object(a.a)("SubQueries",t.get_subQueries(),"unknown","c:QueryByEntityNameDictionary",'xmlns:c="http://schemas.microsoft.com/crm/2011/Contracts"')}function D(e){if(Object(r.a)(e))return null;const t=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='OuterQuery']/b:value/a:Query"),n=Object(r.a)(t)?null:t.get_innerText();e.addNamespace("c","http://schemas.microsoft.com/crm/2011/Contracts");let a=null;const i=e.selectNodes(".//a:KeyValuePairOfstringanyType[b:key='SubQueries']/b:value[@i:type='c:QueryByEntityNameDictionary']/c:KeyValuePairOfstringQueryBasegUGIFE1S");if(!Object(r.a)(i)){a={};for(let e=0;e<i.get_count();e++){const t=i.get_item(e).selectSingleNode("b:key");if(!Object(r.a)(t)){const n=i.get_item(e).selectSingleNode("b:value/a:Query");Object(r.a)(n)||(a[t.get_innerText()]=Object(r.a)(n)?null:n.get_innerText())}}}return new N.a(n,a)}var R=n("Mr6u");function x(e){const t=e;return Object(a.a)("Query",t.get_query(),"unknown","a:FetchExpression")}function M(e){if(Object(r.a)(e))return null;const t=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Query']/b:value/a:Query"),n=Object(r.a)(t)?null:t.get_innerText();return new R.a(n)}var F=n("QFnk");function k(e){const t=e;return Object(a.a)("Target",t.get_target(),"lookup")+Object(a.a)("Principal",t.get_principal(),"lookup")}function L(e){if(Object(r.a)(e))return null;const t=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Target']/b:value"),n=Object(r.a)(t)?null:Object(u.a)(t),a=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Principal']/b:value"),i=Object(r.a)(a)?null:Object(u.a)(a);return new F.a(n,i)}var B=n("Exmh");function U(e){const t=e;return Object(a.a)("Target",t.get_target(),"lookup")+Object(a.a)("ProcessId",t.get_processId(),"lookup")+Object(a.a)("ProcessInstanceId",t.get_processInstanceId(),"lookup")}function V(e){if(Object(r.a)(e))return null;const t=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Target']/b:value"),n=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='ProcessId']/b:value"),a=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='ProcessInstanceId']/b:value"),i=Object(r.a)(t)?null:Object(u.a)(t),o=Object(r.a)(n)?null:Object(u.a)(n),s=Object(r.a)(a)?null:Object(u.a)(a);return new B.a(i,o,s)}var z=n("5NWd"),W=n("NA3N"),q=n("v3UX");function H(e){const t=e;return Object(a.a)("Target",t.get_target(),"lookup")+Object(a.a)("ColumnSet",t.get_columnSet(),"unknown","a:ColumnSet")+Object(a.a)("RelatedEntitiesQuery",t.get_relatedEntitiesQuery(),"unknown","a:RelationshipQueryCollection")+Object(a.a)("ReturnNotifications",t.get_returnNotifications(),"boolean")}function G(e){if(Object(r.a)(e))return null;const t=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Target']/b:value"),n=Object(r.a)(t)?null:Object(u.a)(t),a=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='ColumnSet']/b:value"),i=Object(r.a)(a)?null:Object(z.a)(a),o=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='RelatedEntitiesQuery']/b:value"),s=Object(r.a)(o)?null:Object(W.a)(o),c=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='ReturnNotifications']/b:value");let l;if(Object(r.a)(c))throw Error.notImplemented();return l=Boolean.parse(c.get_innerText()).valueOf(),new q.a(n,i,s,l)}var K=n("PF3G");function Q(e){const t=e;return Object(a.a)("Target",t.get_target(),"unknown","a:Entity")+Object(a.a)("SuppressDuplicateDetection",t.get_suppressDuplicateDetection(),"boolean")+Object(a.a)("CalculateMatchCodeSynchronously",t.get_calculateMatchCodeSynchronously(),"boolean")+Object(a.a)("SolutionUniqueName",t.get_solutionUniqueName(),"string")+Object(a.a)("MaintainLegacyAppServerBehavior",t.get_maintainLegacyAppServerBehavior(),"boolean")+Object(a.a)("ConcurrencyBehavior",t.get_concurrencyBehavior(),"unknown","c:ConcurrencyBehavior")+Object(a.a)("ReturnRowVersion",t.get_returnRowVersion(),"boolean")}function X(e){if(Object(r.a)(e))return null;let t=null,n=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Target']/b:value");if(!Object(r.a)(n)){const e=n.selectSingleNode("entity");Object(r.a)(e)||(n=e),t=Object(a.b)(n)}const i=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='SuppressDuplicateDetection']/b:value");let o;if(Object(r.a)(i))throw Error.notImplemented();o=Boolean.parse(i.get_innerText()).valueOf();const s=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='CalculateMatchCodeSynchronously']/b:value");let u;if(Object(r.a)(s))throw Error.notImplemented();u=Boolean.parse(s.get_innerText()).valueOf();const d=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='SolutionUniqueName']/b:value"),p=Object(r.a)(d)?null:d.get_innerText(),g=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='MaintainLegacyAppServerBehavior']/b:value");let h;if(Object(r.a)(g))throw Error.notImplemented();h=Boolean.parse(g.get_innerText()).valueOf();const f=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='ConcurrencyBehavior']/b:value");let m;if(Object(r.a)(f))throw Error.notImplemented();m=Object(c.b)(l.a,Object(r.a)(f)?null:f.get_innerText());const b=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='ReturnRowVersion']/b:value");let _;if(Object(r.a)(b))throw Error.notImplemented();return _=Boolean.parse(b.get_innerText()).valueOf(),new K.a(t,o,u,p,h,m,_)}const Y={},J={};function $(e){return e.get_name()in Y?Y[e.get_name()](e):""}function Z(e){return null in J?J.null(e):null}function ee(e,t){return t in J?J[t](e):null}function te(e){e.addNamespace("s","http://schemas.xmlsoap.org/soap/envelope"),e.addNamespace("d","http://schemas.microsoft.com/xrm/2011/Contracts/Services"),e.addNamespace("a","http://schemas.microsoft.com/xrm/2011/Contracts"),e.addNamespace("b","http://schemas.datacontract.org/2004/07/System.Collections.Generic"),e.addNamespace("i","http://www.w3.org/2001/XMLSchema-instance")}function ne(e,t){Y[e]=t}function re(e,t){J[e]=t}ne("Create",o),re("Create",s),ne("Delete",p),re("Delete",g),ne("ExecuteMultiple",b),re("ExecuteMultiple",_),ne("ExecuteQuickFind",v),re("ExecuteQuickFind",S),ne("InitializeFrom",E),re("InitializeFrom",I),ne("NavigateToNextEntity",P),re("NavigateToNextEntity",T),ne("RetrieveEntitiesForAggregateQuery",A),re("RetrieveEntitiesForAggregateQuery",D),ne("RetrieveMultiple",x),re("RetrieveMultiple",M),ne("RetrievePrincipalAccess",k),re("RetrievePrincipalAccess",L),ne("RetrieveProcessControlData",U),re("RetrieveProcessControlData",V),ne("Retrieve",H),re("Retrieve",G),ne("Update",Q),re("Update",X)},jZCH:function(e,t,n){"use strict";n.d(t,"a",(function(){return qn}));var r=n("HYaY"),a=n("hs84"),i=n("WRF3"),o=n("IzVP"),s=n("uAlF"),c=n("dH1a"),l=n("IKHO"),u=n("ufH1"),d=n("umme"),p=n("84PK"),g=n("HkYq"),h=n("a475"),f=n("504W"),m=n("H4dV"),b=n("NMtn"),_=n("VA/h"),y=n("XvL5"),v=n("WWG3"),S=n("5qiD"),O=n("d+dp"),C=n("iJGp"),E=n("2JG5"),I=n("IvgJ"),w=n("sdkC"),j=n("/oKV");class P{constructor(e){this._organizationSettings=null,this._organizationSettings=e}getWebServiceCallRetryPolicy(e){return this._organizationSettings.getWebServiceCallRetryPolicy(e)}}var T=n("xiom"),N=n("T544"),A=n("0rLi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class D extends Sys.EventArgs{constructor(e,t){super(),this._eventName=null,this._key=null,this._eventName=e,this._key=t}get_eventName(){return this._eventName}get_key(){return this._key}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class R extends D{constructor(e,t,n,r,a,i){super("retrieved",e),this._retrieveState=0,this._sourceStore=0,this._data=t,this._retrieveState=n,this._sourceStore=r}get_data(){return this._data}get_retrieveState(){return this._retrieveState}get_sourceStore(){return this._sourceStore}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class x extends D{constructor(e){super("retrieving",e)}}var M=n("PV+a"),F=n("XjOj"),k=n("Div0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let L=0,B=0;!function(){let e=M.b;e--,L=e,e--;const t=e;e<=M.c&&Object(F.d)(k.a.scheduler,"Too many scheduler priority buckets specified."),e=M.c,B=e}();var U=n("6K5O");class V{constructor(){this._entityEvents={},this._dataSourceEventHandlers=new Sys.EventHandlerList}add_serverAvailabilityChanged(e){this._dataSourceEventHandlers.addHandler(V._ServerAvailabilityEventName,e)}addRetrievedHandlerRecord(e,t){this.addRetrievedHandler(e,t)}deleteRetrievedHandlerRecord(e,t){this.removeRetrievedHandler(e,t)}addRetrievedHandler(e,t){Object(f.a)(this._entityEvents[e])&&(this._entityEvents[e]=new Sys.EventHandlerList),this._entityEvents[e].addHandler("retrieved",t)}removeRetrievedHandler(e,t){Object(f.a)(this._entityEvents[e])||(this._entityEvents[e].removeHandler("retrieved",t),this._ClearFromEntityEvents(e))}_ClearFromEntityEvents(e){const t=this._entityEvents[e];if(!Object(f.a)(this._entityEvents[e])){let n=!0;const r=t._list;if(!Object(f.a)(r))for(const e in r){if({key:e,value:r[e]}.value.length>0){n=!1;break}}n&&delete this._entityEvents[e]}}OnRetrieving(e,t,n){const r=t.get_key();M.a.schedule(()=>{if(Object(f.a)(this._entityEvents[r]))return;const n=this._entityEvents[r].getHandler(t.get_eventName());n&&(Object(u.d)("DataSource_OnRetrieving",k.a.storage,r),n(e,t))},V._CalculatePriority(n),"DataSourceEventManager.OnRetrieving")}OnRetrieved(e,t,n){const r=t.get_key();M.a.schedule(()=>{if(Object(f.a)(this._entityEvents[r]))return;const n=this._entityEvents[r].getHandler(t.get_eventName());n&&(Object(u.d)("DataSource_OnRetrieved",k.a.storage,r),n(e,t))},V._CalculatePriority(n),"DataSourceEventManager.OnRetrieved")}OnDeleted(e,t,n){const r=t.get_key();M.a.schedule(()=>{if(Object(f.a)(this._entityEvents[r]))return;const n=this._entityEvents[r].getHandler(t.get_eventName());n&&(Object(u.d)("DataSource_OnDeleted",k.a.storage,r),n(e,t))},V._CalculatePriority(n),"DataSourceEventManager.OnDeleted")}OnServerAvailabilityChange(e,t){const n=this._dataSourceEventHandlers.getHandler(V._ServerAvailabilityEventName);n&&(Object(u.e)("DataSource_OnServerAvailabilityChange",k.a.storage,"Server available = "+t.get_isAvailable().toString()+". Network available = "+t.get_isNetworkAvailable().toString()),Object(U.c)(t.get_isAvailable()?V._OnServerAvailabilityOnline:V._OnServerAvailabilityOffline),n(e,t))}static _CalculatePriority(e){return Object(f.a)(e)||Object(f.a)(e.get_callerPriority())?L:e.get_callerPriority()}}V._ServerAvailabilityEventName="serveravailability",V._OnServerAvailabilityOnline="DataSource_OnServerAvailability = online",V._OnServerAvailabilityOffline="DataSource_OnServerAvailability = offline";var z=n("BSqk"),W=n("0lM4"),q=n("2F73");class H extends W.a{constructor(e,t,n,r){super(e,n,r),this._columnSet=null,this._columnSet=Object(f.a)(t)?q.a.get_instance():t}getColumnSet(){return this._columnSet}}class G{constructor(){this._localRetrievePromises={},this._remoteRetrievePromises={},this._localAndRemoteRetrievePromises={}}put(e,t,n,r,a){let i="Key: "+t+"; ColumnSet: "+JSON.stringify(n)+"; RetrievalStrategy: "+j.a[r];if(a){i=i+", ClientRequestId: "+a.RequestId(),a.AppendCallStack("DataSource._PutInternal")}switch(r){case j.a.Remote:this._PutInternal(this._remoteRetrievePromises,e,t,n,i,a);break;case 0:this._PutInternal(this._localRetrievePromises,e,t,n,i,a);break;case j.a.LocalAndRemote:this._PutInternal(this._localAndRemoteRetrievePromises,e,t,n,i,a);break;default:throw Error.argumentOutOfRange("retrievalStrategy",r,"Unknown retrieve strategy")}}_PutInternal(e,t,n,r,a,i){const o=JSON.stringify(r);let s=null;n in e?s=e[n]:(s=new z.a,e[n]=s),s.put(o,new H(t,r,a,"PutInternal"),i)}get(e,t,n){switch(n){case j.a.Remote:return this._GetInternal(this._remoteRetrievePromises,e,t);case 0:return this._GetInternal(this._localRetrievePromises,e,t);case j.a.LocalAndRemote:return this._GetInternal(this._localAndRemoteRetrievePromises,e,t);default:throw Error.argumentOutOfRange("retrievalStrategy",n,"Unknown retrieve strategy")}}_GetInternal(e,t,n){const r=JSON.stringify(n);if(!(t in e))return null;const a=e[t];if(a.containsKey(r))return a.get(r).getPromise();const i=a.get_values();for(const e of i)if(e.getColumnSet().getDifference(n).get_isEmpty())return e.getPromise();return null}}var K=n("qCX6"),Q=n("hirD"),X=n("5yoC");class Y extends X.a{constructor(e,t){super(),this._request=null,this._offlineCallback=null,this._request=e,this._offlineCallback=t}get_request(){return this._request}get_offlineCallback(){return this._offlineCallback}executeCallback(e){return this._offlineCallback()}}var J=n("v3UX"),$=n("XgcG"),Z=n("/d6W"),ee=n("tZZc"),te=n("UyLX"),ne=n("3sOn"),re=n("EW4s"),ae=n("Ydwo"),ie=n("Hswk");class oe{constructor(e,t){this._queueName=null,this._priorityAdjustmentFactor=0,this._callbackQueue=null,this._queuePumpJobNode=null,this._queueName=e,this._priorityAdjustmentFactor=t,this._callbackQueue=[],this._queuePumpJobNode=null}queueCallback(e,t){this._callbackQueue.push(e);let n=M.d;Object(f.a)(t)||Object(f.a)(t.get_callerPriority())||(n=Math.max(t.get_callerPriority()+this._priorityAdjustmentFactor,M.c)),Object(f.a)(this._queuePumpJobNode)?this._queuePumpJobNode=M.a.schedule(Object(ie.a)(this,this._PumpCallbackQueue,"PumpCallbackQueue"),n,this._queueName):this._queuePumpJobNode.priority<n&&(this._queuePumpJobNode.priority=n)}_PumpCallbackQueue(){this._queuePumpJobNode=null;const e=this._callbackQueue.length,t=new Array(e);for(let n=0;n<e;n++)t[n]=this._callbackQueue.shift();for(let n=0;n<e;n++)t[n]()}}var se,ce,le=n("WWXV"),ue=n("omgb"),de=n("eq+S"),pe=n("nfLm");!function(e){e[e.maiN_APPLICATION_VIEW=0]="maiN_APPLICATION_VIEW",e[e.advanceD_SEARCH=1]="advanceD_SEARCH",e[e.suB_GRID=2]="suB_GRID",e[e.quickfinD_SEARCH=4]="quickfinD_SEARCH",e[e.REPORTING=8]="REPORTING",e[e.offlinE_FILTERS=16]="offlinE_FILTERS",e[e.mA_SEARCH=32]="mA_SEARCH",e[e.lookuP_VIEW=64]="lookuP_VIEW",e[e.sM_APPOINTMENTBOOK_VIEW=128]="sM_APPOINTMENTBOOK_VIEW",e[e.outlooK_FILTERS=256]="outlooK_FILTERS",e[e.addressbooK_FILTERS=512]="addressbooK_FILTERS",e[e.savedquerytypE_OTHER=2048]="savedquerytypE_OTHER",e[e.interactivE_WORKFLOW_VIEW=4096]="interactivE_WORKFLOW_VIEW",e[e.offlinE_TEMPLATE=8192]="offlinE_TEMPLATE",e[e.outlooK_TEMPLATE=131072]="outlooK_TEMPLATE",e[e.custoM_DEFINED_VIEW=16384]="custoM_DEFINED_VIEW"}(se||(se={})),function(e){e[e.unknownError=0]="unknownError",e[e.constraintError=1]="constraintError",e[e.notFoundError=2]="notFoundError",e[e.quotaError=3]="quotaError",e[e.timeoutError=4]="timeoutError",e[e.aborted=5]="aborted",e[e.databaseError=6]="databaseError",e[e.syntaxError=7]="syntaxError",e[e.tooLargeError=8]="tooLargeError",e[e.versionError=8]="versionError",e[e.dataError=9]="dataError",e[e.invalidAccessError=10]="invalidAccessError",e[e.invalidStateError=11]="invalidStateError",e[e.transactionInactiveError=12]="transactionInactiveError"}(ce||(ce={}));var ge=n("UDbe"),he=n("hgKT"),fe=n("BSGX"),me=n("8N/3"),be=n("aOBz"),_e=n("iJxC");class ye{constructor(e,t){this._sortField=null,this._sortOrder=0,Object(b.b)(e,"sortField"),this._sortField=e,this._sortOrder=t}get_sortField(){return this._sortField}get_sortOrder(){return this._sortOrder}}var ve,Se=n("uTcl"),Oe=n("KJT0"),Ce=n("84uC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Ee{constructor(){this._handlers=[],this._isResolved=!1}resolve(e){if(!this._isResolved){this._value=e,this._isResolved=!0;for(let e=0;e<this._handlers.length;e++)this._handlers[e](this._value)}}done(e){this._isResolved?e(this._value):this._handlers.push(e)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Ie{constructor(){this._results=null,this._awaiting=0,this._batchPromise=null}waitForArray(e){this._batchPromise=new Ee,this._awaiting=e.length,this._results=new Array(this._awaiting);for(let t=0;t<this._awaiting;t++)this._TrackPromise(e[t],t);return this._batchPromise}_TrackPromise(e,t){e.done(e=>{this._results[t]=e,this._awaiting--,this._awaiting||this._batchPromise.resolve(this._results)})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.none=0]="none",e[e.html=1]="html",e[e.css=2]="css",e[e.jScript=3]="jScript",e[e.xml=4]="xml",e[e.png=5]="png",e[e.jpg=6]="jpg",e[e.gif=7]="gif",e[e.silverlight=8]="silverlight",e[e.xsl=9]="xsl",e[e.ico=10]="ico",e[e.resx=12]="resx"}(ve||(ve={}));var we=n("3umU"),je=n("eYZY"),Pe=n("mDek"),Te=n("8tWD"),Ne=n("wMH2"),Ae=n("V482");class De{constructor(e,t){this._key=null,this._stateData=null,this._key=e,this._stateData=t}get_stateData(){return this._stateData}get_key(){return this._key}getObjectData(){const e={};return e[De.keyPath]=this._key,e.statedata=this._stateData,e}Merge(e){for(const t in e){const n={key:t,value:e[t]};this.get_stateData()[n.key]=n.value}}static createFromObjectData(e){const t=e[De.keyPath],n=e.statedata;return new De(t,n)}}De.keyPath="statekey";var Re,xe=n("qJCH"),Me=n("b2mI"),Fe=n("xAYq");!function(e){e[e.local=1]="local",e[e.session=2]="session",e[e.both=3]="both"}(Re||(Re={}));var ke=n("8o18");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Le{constructor(e,t,n){this._MetadataType=0,this._PayloadKey=null,this._UniqueKey=null,this._set_metadataType(e),this._set_uniqueKey(t),this._set_payloadKey(n)}get_metadataType(){return this._MetadataType}_set_metadataType(e){return this._MetadataType=e,e}get_payloadKey(){return this._PayloadKey}_set_payloadKey(e){return this._PayloadKey=e,e}get_uniqueKey(){return this._UniqueKey}_set_uniqueKey(e){return this._UniqueKey=e,e}}var Be=n("67s4"),Ue=n("Xe7f"),Ve=n("kGsI"),ze=n("CrQY");class We extends X.a{constructor(e){super(),this._clientMetadataQuery=null,this._clientMetadataQuery=e}get_name(){return"GetClientMetadata"}get_xmlNamespace(){return"http://schemas.microsoft.com/xrm/2011/Contracts"}get_clientMetadataQuery(){return this._clientMetadataQuery}}var qe,He,Ge=n("PF3G"),Ke=n("nxt5"),Qe=n("c7Og");class Xe{constructor(e,t){this._path=null,this._type=0,this._path=e,this._type=t}get_keyPath(){return this._path}get_dataType(){return this._type}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.text=0]="text",e[e.integer=1]="integer"}(qe||(qe={}));class Ye{constructor(e,t){this._name=null,this._fields=null,Object(b.c)(e,"name"),Object(b.b)(t,"fields"),Object(b.e)(t.length,1,2,"fields must be a 1 or 2 length array"),this._name=e,this._fields=t}get_name(){return this._name}get_fields(){return this._fields}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.explicitString=0]="explicitString",e[e.autoIncrementedInteger=1]="autoIncrementedInteger"}(He||(He={}));class Je{constructor(e,t,n,r,a){this._name=null,this._version=null,this._indexes=null,this._idType=0,this._isMetadataStore=!1,this._name=e.toLowerCase(),this._version=t,this._indexes=n||[],this._idType=r,this._isMetadataStore=a}get_name(){return this._name}get_version(){return this._version}get_indexes(){return this._indexes}get_idType(){return this._idType}get_isMetadataStore(){return this._isMetadataStore}}class $e{constructor(){this._objectStores=null,this._version="";const e=$e._CreateMetadataVersionStampStoreSchema($e.metadataVersionStampStore),t=$e._CreateMetadataVersionStampStoreSchema($e._tempMetadataVersionStampStore),n=$e._CreateApplicationMetadataStoreSchema($e.applicationMetadataStore),r=$e._CreateApplicationMetadataStoreSchema($e._tempApplicationMetadataStore),a=$e._CreateEntityMetadataStoreSchema($e.entityMetadataStore),i=$e._CreateEntityMetadataStoreSchema($e._tempEntityMetadataStore),o=$e._CreateAttributeMetadataStoreSchema($e.attributeMetadataStore),s=$e._CreateAttributeMetadataStoreSchema($e._tempAttributeMetadataStore),c=$e._CreateUserContextStoreSchema($e.userContextStore),l=$e._CreateSessionStateStoreSchema($e.sessionStateStore),u=$e._CreateEntityRecordStoreSchema($e.entityRecordStore),d=$e._CreateListStoreSchema($e.listStore),p=$e._CreateUserPersonalizationStoreSchema($e.userPersonalizationStore),g=$e._CreateNavigationDataStoreSchema($e.navigationDataStore),h=$e._CreateOfflineDatabaseInformationSchema($e.offlineDatabaseInformationStore);this._objectStores=[n,r,a,i,o,s,u,d,e,t,c,p,l,g,h];for(const e of this._objectStores)this._version+="_"+e.get_version()}get_version(){return this._version}get_objectStores(){return this._objectStores}get_metadataStoreNames(){return this._objectStores.filter(e=>e.get_isMetadataStore()).map(e=>e.get_name())}get_dataStoreNames(){return this._objectStores.filter(e=>!e.get_isMetadataStore()).map(e=>e.get_name())}getSchemaFromObjectStoreName(e){if(Object(f.a)(e))return null;for(let t=0;t<this._objectStores.length;++t)if(this._objectStores[t].get_name().toLowerCase()===e.toLowerCase())return this._objectStores[t];return null}static _CreateMetadataVersionStampStoreSchema(e){return new Je(e,e+"#1",new Array(0),0,!0)}static _CreateApplicationMetadataStoreSchema(e){const t=e+"#2",n=[new Xe(we.a.metadataTypeKeyPath,qe.integer)],r=[new Xe(we.a.metadataTypeSourceIdKeyPath,0)],a=[new Xe(we.a.metadataTypeAssociatedEntityLogicalNameKeyPath,0)],i=[new Xe(we.a.metadataTypeMetadataSubtypeAssociatedEntityLogicalNameKeyPath,0)],o=[new Xe(we.a.metadataTypeNormalizedDisplayNameKeyPath,0)],s=[new Ye(we.a.metadataTypeKeyPath.get_path(),n),new Ye(we.a.metadataTypeSourceIdKeyPath.get_path(),r),new Ye(we.a.metadataTypeAssociatedEntityLogicalNameKeyPath.get_path(),a),new Ye(we.a.metadataTypeMetadataSubtypeAssociatedEntityLogicalNameKeyPath.get_path(),i),new Ye(we.a.metadataTypeNormalizedDisplayNameKeyPath.get_path(),o)];return new Je(e,t,s,0,!0)}static _CreateEntityMetadataStoreSchema(e){const t=e+"#1",n=new ge.a("logicalname"),r=[new Xe(n,0)],a=[new Ye("logicalname",r)];return new Je(e,t,a,0,!0)}static _CreateAttributeMetadataStoreSchema(e){const t=e+"#1",n=new ge.a(Pe.a.logicalNamePath),r=new ge.a(Pe.a.entityLogicalNamePath),a=new ge.a(Pe.a.entityAttributeLogicalNamesPath),i=[new Xe(n,0)],o=[new Xe(r,0)],s=[new Xe(a,0)],c=[new Ye(Pe.a.logicalNamePath,i),new Ye(Pe.a.entityLogicalNamePath,o),new Ye(Pe.a.entityAttributeLogicalNamesPath,s)];return new Je(e,t,c,0,!0)}static _CreateUserContextStoreSchema(e){return new Je(e,e+"#1",new Array(0),0,!0)}static _CreateSessionStateStoreSchema(e){return new Je(e,e+"#1",new Array(0),0,!0)}static _CreateEntityRecordStoreSchema(e){const t=e+"#1",n=new ge.a(O.a.embeddedPriorityTimestampPath),r=[new Xe(n,0)],a=[new Ye("priority_timestamp",r)];return new Je(e,t,a,0,!1)}static _CreateListStoreSchema(e){const t=e+"#1",n=new ge.a("query"),r=new ge.a(O.a.embeddedPriorityTimestampPath),a=[new Xe(r,0)],i=[new Xe(n,0)],o=[new Ye("query",i),new Ye("priority_timestamp",a)];return new Je(e,t,o,He.autoIncrementedInteger,!1)}static _CreateUserPersonalizationStoreSchema(e){return new Je(e,e+"#1",new Array(0),0,!1)}static _CreateNavigationDataStoreSchema(e){const t=e+"#1",n=new ge.a(O.a.timestampPath),r=[new Xe(n,0)],a=[new Ye(O.a.timestampPath,r)];return new Je(e,t,a,He.autoIncrementedInteger,!1)}static _CreateOfflineDatabaseInformationSchema(e){return new Je(e,e+"#1",new Array(0),0,!1)}}$e.applicationMetadataStore="ApplicationMetadata",$e._tempApplicationMetadataStore="TempApplicationMetadata",$e.entityMetadataStore="EntityMetadata",$e._tempEntityMetadataStore="TempEntityMetadata",$e.attributeMetadataStore="AttributeMetadata",$e._tempAttributeMetadataStore="TempAttributeMetadata",$e.entityRecordStore="EntityRecord",$e.listStore="List",$e.metadataVersionStampStore="MetadataVersionStamp",$e._tempMetadataVersionStampStore="TempMetadataVersionStamp",$e.offlineDatabaseInformationStore="OfflineDatabaseInformation",$e.userContextStore="UserContext",$e.userPersonalizationStore="UserPersonalization",$e.sessionStateStore="SessionState",$e.navigationDataStore="NavigationData";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Ze{constructor(e){if(this._keyValue=null,e){const t=Object.getType(e);if(t!==String&&t!==Number&&t!==Number&&t!==Date)throw Error.argumentType("keyValue",t,null,"keyValue must be a javascript primitive (string, int, float, Datetime (or null))")}this._keyValue=e}toString(){return this._keyValue?""+this.toKeyValue():null}toKeyValue(){return this._keyValue}}var et=n("zW2f");class tt{constructor(e,t){this._results=null,this._results=Object(f.a)(e)?[]:e}get_results(){return this._results}}var nt=n("4Gtd"),rt=n("iDqy"),at=n.n(rt),it=n("DRVD"),ot=n.n(it);class st{constructor(e,t){this._innerTransaction=null,this._databaseName=null,this._openedStores=null,this._result=null,this._transactionEvent=null,this._transactionEvent=ot.a.createEvent("ClientBrowserStoreTransaction","LocalStore"),this._innerTransaction=e,this._databaseName=t,this._openedStores={}}get_result(){return this._result}set_result(e){return this._result=e,e}add(e,t,n,r){Object(u.d)("ClientBrowserStoreTransaction_Add",k.a.storage,this._databaseName);const a=new Ee;this._InitPerformanceStopWatch(a,"Add",n,r,{key:e,data:t});return this._OpenObjectStore(n).putItem(new Ze(e),t,e=>{a.resolve(e.toKeyValue())},null),a}addMultiple(e,t,n,r){Object(u.d)("ClientBrowserStoreTransaction_AddMultiple",k.a.storage,this._databaseName);const a=new Ee;this._InitPerformanceStopWatch(a,"AddMultiple",n,r,{extractKey:e,dataSet:t});const i=this._OpenObjectStore(n);return this._AddMultipleRecursive(0,e,i,t,[],a),a}_AddMultipleRecursive(e,t,n,r,a,i){this._AddMultipleByBatch(e,t,n,r,o=>{a.push(...o),e+o.length<r.length?this._AddMultipleRecursive(e+o.length,t,n,r,a,i):i.resolve(a)})}_AddMultipleByBatch(e,t,n,r,a){const i=h.a.get_Instance().get_device().get_DeviceState().get_deviceMaxBatchSize(),o=[],s=Math.min(e+i,r.length);let c=s-e;if(c)for(let i=e;i<s;i++){Object(b.d)(r[i],"dataSet["+i+"]");const e=r[i],s=t?t(e):null,l=new Ze(s);n.putItem(l,e,e=>{o.push(e.toKeyValue()),c--,c||a(o)},null)}else a([])}addMultipleByKey(e,t,n,r){Object(u.d)("ClientBrowserStoreTransaction_AddMultipleByKey",k.a.storage,this._databaseName);const a=new Ee;this._InitPerformanceStopWatch(a,"AddMultipleByKey",n,r,{keys:e,dataSet:t});const i=this._OpenObjectStore(n);let o=t.length;if(!o)return a.resolve([]),a;for(let n=0;n<t.length;n++){Object(b.d)(t[n],"dataSet["+n+"]");const r=t[n],s=e[n],c=new Ze(s);i.putItem(c,r,e=>{o--,o||a.resolve([e.toKeyValue()])},null)}return a}flush(e,t,n){Object(u.d)("ClientBrowserStoreTransaction_Flush",k.a.storage,this._databaseName);const r=new Ee;this._InitPerformanceStopWatch(r,"Flush",t,n,{key:e});return this._OpenObjectStore(t).deleteItem(new Ze(e),()=>{r.resolve(null)},null),r}flushMultiple(e,t,n){Object(u.d)("ClientBrowserStoreTransaction_FlushMultiple",k.a.storage,this._databaseName);const r=new Ee;this._InitPerformanceStopWatch(r,"FlushMultiple",t,n,{keys:e});const a=this._OpenObjectStore(t);let i=e.length;if(!i)return r.resolve(0),r;for(let t=0;t<e.length;t++)a.deleteItem(new Ze(e[t]),()=>{i--,i||r.resolve(e.length)},null);return r}flushAll(e,t){Object(u.d)("ClientBrowserStore_FlushAll_Transaction",k.a.storage,this._databaseName);const n=new Ee;this._InitPerformanceStopWatch(n,"FlushAll",e,t,{});return this._OpenObjectStore(e).clear(()=>{n.resolve(null)},null),n}flushByQuery(e,t,n){Object(u.d)("ClientBrowserStoreTransaction_FlushByQuery",k.a.storage,this._databaseName);const r=new Ee;return this._InitPerformanceStopWatch(r,"FlushByQuery",t,n,{query:e}),this.retrieveMultipleByQuery(e,t,n).done(e=>{const a=e.get_results();if(!Object(f.a)(a)&&a.length>0){const e=new Array(a.length);for(let t=0;t<a.length;t++)e[t]=a[t].get_key();this.flushMultiple(e,t,n).done(()=>{r.resolve(a.length)})}else r.resolve(0)}),r}retrieve(e,t,n){Object(u.d)("ClientBrowserStoreTransaction_Retrieve_Transaction",k.a.storage,this._databaseName);const r=new Ee;this._InitPerformanceStopWatch(r,"Retrieve",t,n,{key:e});return this._OpenObjectStore(t).getItem(new Ze(e),e=>{r.resolve(e)},null),r}retrieveMultipleByQuery(e,t,n){Object(u.d)("ClientBrowserStore_RetrieveMultipleByQuery_Transaction",k.a.storage,this._databaseName);const r=new Ee;this._InitPerformanceStopWatch(r,"RetrieveMultipleByQuery",t,n,{query:e});return this._OpenObjectStore(t).objectQuery(e,t=>{const n=e.get_pageSize()<0,a=n?Object(nt.b)():e.get_pageSize(),i=e.get_offset(),o=e.get_getIdOnly(),s=e.get_allowPartialResults();t.skip(i,()=>{this._IterateOverResults(n,o,s,a,0,0,t,[],r)},null)},null),r}_IterateOverResults(e,t,n,r,a,i,o,s,c){const l=Math.min(r,Object(nt.b)());o.next(l,t,(u,d)=>{const p=d.length;for(let e=0;e<p;++e)s.push(new Qe.a(d[e].get_id().toKeyValue(),d[e].get_json()));if(a+=p,i+=l,e)if(p<l){const e=new tt(s,a);o.dispose(),c.resolve(e)}else this._IterateOverResults(e,t,n,r,a,i,o,s,c);else n&&i<r||a<r&&p===l?this._IterateOverResults(e,t,n,r,a,i,o,s,c):o.approximateCount(e=>{const t=new tt(s,e);o.dispose(),c.resolve(t)},null)},null)}_OpenObjectStore(e){return e in this._openedStores||(this._openedStores[e]=this._innerTransaction.openObjectStore(e)),this._openedStores[e]}_InitPerformanceStopWatch(e,t,n,r,a){const i={};i.action=t;const o=Object(f.a)(r)?et.a.get_instance():r;i.context=o.toString(),i.storeName=n,i.transactionType=this._innerTransaction.get_isReadOnly()?"(read)":"(read/write)";for(const e in a){const t={key:e,value:a[e]};t.value&&(i[t.key]="keys"===t.key||"extractKey"===t.key||"dataSet"===t.key?"["+t.key+"]":t.value.toString())}const s=this._transactionEvent.startStopwatch(i);if(e.done(()=>{s()}),n!==$e.sessionStateStore){const t=at.a.trackWork("ClientBrowserStoreTransaction");e.done(()=>{t()})}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class ct extends class{constructor(){this.code=0,this.message=null}}{constructor(e,t){super(),this.code=e,this.message=t}}class lt{constructor(){this._transactionList=null,this._transactionList=[]}peek(){return this._transactionList.length>0?this._transactionList[0]:null}enqueue(e){this._transactionList.push(e)}dequeue(){const e=this.peek();return e&&this._transactionList.splice(0,1),e}}var ut,dt=n("2mBq");class pt{constructor(e,t,n,r){this._sql=null,this._args=null,this._successCallback=null,this._errorCallback=null,Object(b.c)(e,"sql"),Object(b.b)(t,"args"),Object(b.b)(n,"successCallback"),Object(b.b)(r,"errorCallback"),this._sql=e,this._args=t,this._successCallback=n,this._errorCallback=r}addToBatch(e){const t="Sql query to be executed over the bridge: "+this._sql;Object(U.b)(t),e.addRequest(this._sql,this._args,e=>{this._successCallback(e)},e=>{const t=Object(dt.a)("Sql error: ErrorCode = {0}, ErrorMessage = {1}",e.code,e.message);Object(U.a)(t),this._errorCallback(e)})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.pending=0]="pending",e[e.active=1]="active",e[e.done=2]="done"}(ut||(ut={}));var gt=n("+Szo");class ht{constructor(e,t,n,r,a,i){this._jsQueue=null,this._onSuccess=null,this._onError=null,this._sqlDispatcher=null,this._onDone=null,this._state=0,this._queuedStatements=null,this._isDispatcherBusy=!1,this._executeSqlCalled=!1,this._isPendingDispatch=!1,this._readTransaction=!1,this._transactionId=0,this._sqlDispatcher=e,this._jsQueue=t,this._onSuccess=n,this._onError=r,this._readTransaction=a,this._transactionId=i,this._state=0,this._queuedStatements=[],this._readTransaction||this._EnqueueBeginTransactionStatement(r)}get_ReadTransaction(){return this._readTransaction}executeSql(e,t,n,r){if(this._executeSqlCalled=!0,this._state===ut.done)throw Error.invalidOperation("ExecuteSql cannot be invoked on a completed transaction.");const a=new pt(e,t,this._CreateExecuteSqlSuccessCallback(n),this._CreateExecuteSqlErrorCallback(r));this._queuedStatements.push(a),this._state&&!this._isPendingDispatch&&(this._isPendingDispatch=!0,this._jsQueue.setTimeout(()=>{this._isPendingDispatch=!1,this._DispatchNextBatch()},0))}startExecution(e){this._AssertTransactionState(0),this._onDone=e,this._executeSqlCalled?(Object(F.f)(k.a.sqlDbTransactionAdapter,"Starting execution of the transaction"),this._state=ut.active,this._DispatchNextBatch()):(Object(F.f)(k.a.sqlDbTransactionAdapter,"Completing transaction because no statements were queued."),this._state=ut.done,this._jsQueue.setTimeout(this._CompleteTransactionSuccess.bind(this),0))}_Commit(){if(Object(F.f)(k.a.sqlDbTransactionAdapter,"Committing transaction"),this._AssertTransactionState(ut.active),this._state=ut.done,this._readTransaction)Object(F.f)(k.a.sqlDbTransactionAdapter,"Complete transaction success."),this._CompleteTransactionSuccess();else{const e=new pt("COMMIT TRANSACTION",[],()=>{Object(F.f)(k.a.sqlDbTransactionAdapter,"Commit success."),this._CompleteTransactionSuccess()},e=>{Object(F.d)(k.a.sqlDbTransactionAdapter,"Commit error: {0}",e.message),this._CompleteTransactionError(e)});this._queuedStatements.push(e),this._DispatchNextBatch()}}_CompleteTransactionSuccess(){this._CompleteTransaction(),this._onSuccess&&this._onSuccess()}_CompleteTransactionError(e){this._CompleteTransaction(),this._onError&&this._onError(e)}_CompleteTransaction(){this._sqlDispatcher=null,this._onDone&&this._onDone()}_RollbackWithException(e){const t=new ct(0,nt.a+e.message);this._RollbackWithError(t)}_RollbackWithError(e){if(Object(F.f)(k.a.sqlDbTransactionAdapter,"Rolling back transaction"),this._AssertTransactionState(ut.active),this._state=ut.done,this._queuedStatements=[],this._readTransaction)Object(F.d)(k.a.sqlDbTransactionAdapter,"RollbackWithError:Complete Transaction Error."),this._CompleteTransactionError(e);else{const t=new pt("ROLLBACK TRANSACTION",[],()=>{Object(F.f)(k.a.sqlDbTransactionAdapter,"Rollback success."),this._CompleteTransactionError(e)},t=>{Object(F.d)(k.a.sqlDbTransactionAdapter,"RollbackWithError:Rollback error: {0}",t.message),this._CompleteTransactionError(e)});this._queuedStatements.push(t),this._DispatchNextBatch()}}_Rollback(){if(Object(F.f)(k.a.sqlDbTransactionAdapter,"Rolling back transaction"),this._AssertTransactionState(ut.active),this._state=ut.done,this._queuedStatements=[],this._readTransaction)Object(F.f)(k.a.sqlDbTransactionAdapter,"Rollback:Complete Transaction Error."),this._CompleteTransaction();else{const e=new pt("ROLLBACK TRANSACTION",[],()=>{Object(F.f)(k.a.sqlDbTransactionAdapter,"Rollback success."),this._CompleteTransaction()},e=>{Object(F.d)(k.a.sqlDbTransactionAdapter,"Rollback:Rollback error: {0}",e.message),this._CompleteTransaction()});this._queuedStatements.push(e),this._DispatchNextBatch()}}_CreateExecuteSqlSuccessCallback(e){return t=>{this._state!==ut.done&&(Object(F.i)(k.a.sqlDbTransactionAdapter,"ExecuteSql success"),e&&this._InvokeSuccessCallbackAndRollbackOnExecption(e,t))}}_CreateExecuteSqlErrorCallback(e){return t=>{Object(F.d)(k.a.sqlDbTransactionAdapter,"ExecuteSql error :Code = "+t.code+":Message = "+t.message),this._state!==ut.done&&this._RollbackWithError(t),e&&e(this,t)}}_InvokeSuccessCallbackAndRollbackOnExecption(e,t){try{e(this,{insertId:t.insertId,rowsAffected:t.rowsAffected,columnNames:t.columnNames,rows:new gt.a(t)})}catch(e){Object(F.e)(k.a.sqlDbTransactionAdapter,e,"Exception during transaction callback."),this._RollbackWithException(e)}}_CommitIfThereAreNoQueuedStatements(){this._queuedStatements.length||this._Commit()}_EnqueueBeginTransactionStatement(e){const t=new pt("BEGIN TRANSACTION",[],()=>{},t=>{t&&"cannot start a transaction within a transaction"===t.message?(Object(F.j)(k.a.sqlDbTransactionAdapter,"Rolling back uncommitted transaction and starting new transaction : {0}",t.message),this._Rollback(),this._EnqueueBeginTransactionStatement(e),Object(F.j)(k.a.sqlDbTransactionAdapter,"{0}","Rollback of uncommitted transaction completed and new transaction started")):(Object(F.d)(k.a.sqlDbTransactionAdapter,"BEGIN error: Message = {0}",t.message+":Code = "+t.code),e&&e(t))});this._queuedStatements.push(t)}_DispatchNextBatch(){if(!this._isDispatcherBusy&&this._queuedStatements.length>0){const e=this._sqlDispatcher.createBatch(this._transactionId.toString(),this._readTransaction);for(;this._queuedStatements.length>0&&e.get_estimatedSize()<ft.maximumBatchSize;){this._queuedStatements.shift().addToBatch(e)}this._isDispatcherBusy=!0,e.execute(()=>{this._isDispatcherBusy=!1,this._state!==ut.done&&this._CommitIfThereAreNoQueuedStatements(),this._DispatchNextBatch()})}}_AssertTransactionState(e){if(this._state!==e)throw Error.invalidOperation(String.format("transaction state expected {0}.  Actual {1}.",e,this._state))}}class ft{constructor(e,t){this._sqlDispatcher=null,this._jsQueue=null,this._runningTransactionCount=0,this._isRunningTransactionRead=!1,this._transactionQueue=null,this._sqlDispatcher=e,this._jsQueue=t,this._transactionQueue=new lt,this._runningTransactionCount=0,this._isRunningTransactionRead=!1}transactionWithType(e,t,n,r){Object(b.b)(e,"transaction");const a=new ht(this._sqlDispatcher,this._jsQueue,n,t,r,++ft._nextSerialNumber);try{e(a),this._transactionQueue.enqueue(a),this._ExecuteNextTransaction()}catch(e){if(Object(F.e)(k.a.sql,e,"Exception caught in transaction callback."),t){const n=String.format("Exception caught in transaction callback. {0}",e.message);t(new ct(0,n))}}}transaction(e,t,n){this.transactionWithType(e,t,n,!1)}readTransaction(e,t,n){this.transactionWithType(e,t,n,!0)}_ExecuteNextTransaction(){const e=this._transactionQueue.peek();if(e&&(!this._runningTransactionCount||this._isRunningTransactionRead&&e.get_ReadTransaction())){this._runningTransactionCount++;const e=this._transactionQueue.dequeue();this._isRunningTransactionRead=e.get_ReadTransaction(),this._jsQueue.setTimeout(()=>{e.startExecution(()=>{this._runningTransactionCount--,this._ExecuteNextTransaction()})},0)}}}ft.maximumBatchSize=4194304,ft._nextSerialNumber=0;class mt{constructor(e,t){this._sqlDispatcher=null,this._workQueue=null,this._sqlDispatcher=e,this._workQueue=t}openDatabase(e,t,n,r,a){return new ft(this._sqlDispatcher,this._workQueue)}}class bt{}var _t,yt,vt,St=n("kToj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Ot(){return IDBKeyRange.lowerBound(-Number.MAX_VALUE,!0)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.IndexSizeError=1]="IndexSizeError",e[e.DomStringSizeError=2]="DomStringSizeError",e[e.HierarchyRequestError=3]="HierarchyRequestError",e[e.WrongDocumentError=4]="WrongDocumentError",e[e.InvalidCharacterError=5]="InvalidCharacterError",e[e.NoDataAllowedError=6]="NoDataAllowedError",e[e.NoModificationAllowedError=7]="NoModificationAllowedError",e[e.NotFoundError=8]="NotFoundError",e[e.NotSupportedError=9]="NotSupportedError",e[e.InUseAttributeError=10]="InUseAttributeError",e[e.InvalidStateError=11]="InvalidStateError",e[e.SyntaxError=12]="SyntaxError",e[e.InvalidModificationError=13]="InvalidModificationError",e[e.NamespaceError=14]="NamespaceError",e[e.InvalidAccessError=15]="InvalidAccessError",e[e.ValidationError=16]="ValidationError",e[e.TypeMismatchError=17]="TypeMismatchError",e[e.SecurityError=18]="SecurityError",e[e.NetworkError=19]="NetworkError",e[e.AbortError=20]="AbortError",e[e.URLMismatchError=21]="URLMismatchError",e[e.QuotaExceededError=22]="QuotaExceededError",e[e.TimeoutError=23]="TimeoutError",e[e.InvalidNodeTypeError=24]="InvalidNodeTypeError",e[e.DataCloneError=25]="DataCloneError",e[e.EncodingError=26]="EncodingError",e[e.NotReadableError=27]="NotReadableError",e[e.UnknownError=28]="UnknownError",e[e.ConstraintError=29]="ConstraintError",e[e.DataError=30]="DataError",e[e.TransactionInactiveError=31]="TransactionInactiveError",e[e.ReadOnlyError=32]="ReadOnlyError",e[e.VersionError=33]="VersionError",e[e.OperationError=34]="OperationError"}(_t||(_t={}));class Ct{constructor(e,t){this.keypath=null,this.autoIncrement=!1,Object(f.b)(e)&&(this.keypath=e),this.autoIncrement=t}static forAutoIncrementedKey(){return new Ct(null,!0)}static forExternalKey(){return new Ct(null,!1)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Et{constructor(e,t){this._message=null,this._code=0,this._code=e,this._message=Et._GenerateMessage(e,t)}get_message(){return this._message}get_code(){return this._code}static throwException(e,t){const n=new Et(e,t);throw Error.create(n.get_message())}static _GenerateMessage(e,t){let n="BrowserDbError: ";switch(e){case ce.constraintError:n+="ConstraintError. ";break;case ce.notFoundError:n+="NotFoundError. ";break;case ce.quotaError:n+="QuotaError. ";break;case ce.timeoutError:n+="TimeoutError. ";break;case ce.aborted:n+="AbortError. ";break;case ce.databaseError:n+="DatabaseError. ";break;case ce.syntaxError:n+="SyntaxError. ";break;default:ce[e]?n+=ce[e]+". ":n+="UnknownError. "}return n+t}}class It{constructor(e){this._subscriptionEntries=null,this._subscriptionEntries={}}get_subscriptionEntries(){return this._subscriptionEntries}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class wt extends Et{static reportIdbError(e,t){const n=_t[e],r=wt._TranslateIdbError(e);Object(F.d)(k.a.indexedDb,"IndexedDb Error: Message : {0} : Code : {1}",n,e),wt.reportError(r,n,t)}static reportError(e,t,n){n&&n(new wt(e,t))}static reportSuccess(e){e&&e()}static _TranslateIdbError(e){let t=0;switch(e){case _t.UnknownError:t=0;break;case _t.ConstraintError:t=ce.constraintError;break;case _t.DataError:t=ce.dataError;break;case _t.TransactionInactiveError:t=ce.transactionInactiveError;break;case _t.ReadOnlyError:t=ce.constraintError;break;case _t.VersionError:t=ce.versionError;break;case _t.NotFoundError:t=ce.notFoundError;break;case _t.InvalidStateError:t=ce.invalidStateError;break;case _t.InvalidAccessError:t=ce.invalidAccessError;break;case _t.TimeoutError:t=ce.timeoutError;break;case _t.AbortError:t=ce.aborted;break;case _t.QuotaExceededError:t=ce.quotaError;break;case _t.SyntaxError:t=ce.syntaxError;break;case _t.DataCloneError:t=ce.constraintError}return t}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.addItem=0]="addItem",e[e.changeItem=1]="changeItem",e[e.deleteItem=2]="deleteItem"}(yt||(yt={}));class jt{constructor(){this._events={}}get_Events(){const e=[],t=this._events;for(const n in t){const r={key:n,value:t[n]};e.push(r.value)}return e}AddEvent(e){this._events[e.get_id().toString()]=e}}class Pt{constructor(){this._adds=null,this._changes=null,this._deletes=null,this._adds=new jt,this._changes=new jt,this._deletes=new jt}get_hasWriteEvents(){return this.get_addEvents().length>0||this.get_changeEvents().length>0||this.get_deleteEvents().length>0}get_addEvents(){return this._adds.get_Events()}get_changeEvents(){return this._changes.get_Events()}get_deleteEvents(){return this._deletes.get_Events()}recordEvent(e,t){switch(t){case 0:Object(St.a)(!!e.get_json(),"json value cannot be null"),this._adds.AddEvent(e);break;case yt.changeItem:Object(St.a)(!!e.get_json(),"json value cannot be null"),this._changes.AddEvent(e);break;case yt.deleteItem:Object(St.a)(!e.get_json(),"We don't support returning data values for deletes"),this._deletes.AddEvent(e);break;default:Object(St.a)(!1,"Invalid notification event type")}}}class Tt{constructor(e,t){this._id=null,this._json=null,Object(b.b)(e,"id"),this._id=e,this._json=t}get_id(){return this._id}get_json(){return this._json}}class Nt{constructor(e){this._subscriptionsPerDb=null,this._notificationDataPerTransaction=null,this._subscriptionsPerDb=e,this._notificationDataPerTransaction={};const t=this._subscriptionsPerDb.get_subscriptionEntries();for(const e in t){const n={key:e,value:t[e]};this._notificationDataPerTransaction[n.key]=new Pt}}queueNotificationEvents(e,t,n,r){Object(St.a)(!!e,"objectStore name cannot be null since it is called from an object store"),Object(St.a)(!!n,"id cannot be null - it is the key to add to the notification list");const a=e.toLowerCase();if(a in this._notificationDataPerTransaction){this._notificationDataPerTransaction[a].recordEvent(new Tt(n,r),t)}}publishNotificationEvents(){const e=this._notificationDataPerTransaction;for(const t in e){const n={key:t,value:e[t]},r=this._subscriptionsPerDb.get_subscriptionEntries()[n.key];if(r){const e=n.value;e.get_hasWriteEvents()&&r(n.key,e)}}}}class At{constructor(){this._observationsPerId=null,this._observationsPerId={}}onBeforePut(e,t,n){this._CheckForLoop(t.toKeyValue())}onBeforeDelete(e,t){this._CheckForLoop(t.toKeyValue())}onBeforeClear(e){this._CheckForLoop(e.get_name())}_CheckForLoop(e){if(e){const t=e.toString(),n=this._observationsPerId[t];let r=1;if(Object(f.a)(n)||(r=n+1),r>At._MaximumObservationsPerId)throw Error.invalidOperation("loop detected in transaction observer for id "+e);this._observationsPerId[t]=r}}}At._MaximumObservationsPerId=64;class Dt{constructor(e,t){this._id=null,this._json=null,this._id=e,this._json=t}get_id(){return this._id}get_json(){return this._json}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.before=0]="before",e[e.during=1]="during",e[e.after=2]="after"}(vt||(vt={}));class Rt{constructor(e,t){this._tx=null,this._strategy=null,this._tx=e,this._strategy=t}approximateCount(e,t){this._strategy.approximateCount(e,t)}next(e,t,n,r){Object(b.b)(n,"successCallback"),this._strategy.get_position()===vt.after?n(this._tx,[]):this._AdvanceStrategyAndAddToResults(e,[],n,r)}skip(e,t,n){this._strategy.skip(e,t,n)}_AdvanceStrategyAndAddToResults(e,t,n,r){Object(St.a)(this._strategy.get_position()!==vt.after,"can't be called after content"),this._strategy.next(()=>{if(Object(St.a)(!!this._strategy.get_position(),"must be on or after content"),this._strategy.get_position()===vt.after)n(this._tx,t);else{const a=this._strategy.get_currentRecord(),i=this._strategy.get_currentKey(),o=new Dt(new Ze(i),a.data);t.push(o),--e>0?this._AdvanceStrategyAndAddToResults(e,t,n,r):n(this._tx,t)}},e=>{wt.reportIdbError(e,r),this.dispose()})}dispose(){Object(f.a)(this._strategy)||this._strategy.dispose()}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class xt{constructor(e,t){this.data=null,this.metadata=null,this.data=e,this.metadata=t}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Mt(e,t){return Ft(e)+""+Ft(t)}function Ft(e){return"string"==typeof e?"S"+function(e){if(e.indexOf("")>=0)return Object(F.j)(k.a.indexedDb,"A composite key is being constructed with the composite key meta-character and will be stripped of the character.  Consequently, sorts and filters, will ignore that character in any comparisons. {0}",e),e.replace("","");return e}(e):"number"==typeof e?"N"+function(e){e>0xfffffffffffff&&(e=0xfffffffffffff);e<-0xffffffffffff&&(e=-0xffffffffffff);if(e>=0){const t=e.toString(16),n=13-t.length,r=new Sys.StringBuilder;r.append("P");for(let e=0;e<n;++e)r.append("0");return r.append(t),r.toString()}const t=(0xfffffffffffff+e+1).toString(16);return Object(St.a)(13===t.length,"negative key must be 13 digits!"),"N"+t}(e):(Object(St.a)(!1,"unknown type: "+Object.getType(e)),null)}class kt{constructor(e){this._innerStrategy=null,this._position=0,this._innerStrategy=e,this._position=0}get_innerStrategy(){return this._innerStrategy}get_currentRecord(){return this._AssertInitialized(),this.get_internalCurrentRecord()}get_currentKey(){return this._AssertInitialized(),this.get_internalCurrentKey()}get_currentGroupId(){return this._AssertInitialized(),this.get_internalCurrentGroupId()}get_position(){return this._position}approximateCount(e,t){this.get_innerStrategy().approximateCount(e,t)}next(e,t){switch(this._position){case 0:this.initialize(()=>{this._SetCurrentPosition(),e()},t);break;case vt.during:this.internalNext(()=>{this._SetCurrentPosition(),e()},t);break;case vt.after:throw Error.invalidOperation("The end of the content was reached by the previous call to next!")}}skip(e,t,n){if(e&&this.get_position()!==vt.after)switch(this._position){case 0:this.initialize(()=>{this._SetCurrentPosition(),this.skip(e-1,t,n)},e=>{wt.reportIdbError(e,n)});break;case vt.during:this.internalSkip(e,()=>{this._SetCurrentPosition(),wt.reportSuccess(t)},e=>{wt.reportIdbError(e,n)});break;case vt.after:throw Error.invalidOperation("The end of the content was reached by the previous call to next!")}else wt.reportSuccess(t)}dispose(){Object(f.a)(this.get_innerStrategy())||this.get_innerStrategy().dispose(),this.internalDispose()}internalDispose(){}initialize(e,t){this.internalNext(e,t)}internalSkip(e,t,n){e&&this.get_position()!==vt.after?(Object(St.a)(e>0,"number to skip must be positive"),this.next(()=>{this.internalSkip(e-1,t,n)},n)):t()}_InternalSeekTo(e,t,n){this.next(()=>{this.get_position()===vt.after?t(!1):e.isSatisfiedByRecord(this.get_currentKey(),this.get_currentRecord())?(this._position=0,t(!0)):this._InternalSeekTo(e,t,n)},e=>{wt.reportIdbError(e,n)})}_AssertInitialized(){if(!this._position)throw Error.invalidOperation("cannot ask for value before calling next")}_SetCurrentPosition(){this._position=this.get_internalCurrentRecord()?vt.during:vt.after}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Lt{constructor(e,t){this._success=null,this._error=null,this._success=e,this._error=t}get_success(){return this._success}get_error(){return this._error}}class Bt extends kt{constructor(e,t){super(null),Object(b.b)(e,"idbCursorRequest"),this._pendingCallback=null,this._idbCursorRequest=e,this._range=t,this._idbCursorRequest.onsuccess=Object(ie.a)(this,this._HandleNextSuccess,"HandleNextSuccess"),this._idbCursorRequest.onerror=Object(ie.a)(this,this._HandleNextError,"HandleNextError")}get_internalCurrentRecord(){let e=null;return this._idbCursorRequest.result&&(e=this._idbCursorRequest.result.value),e}get_internalCurrentKey(){let e=null;return this._idbCursorRequest.result&&(e=this._idbCursorRequest.result.primaryKey),e}get_internalCurrentGroupId(){return""}approximateCount(e,t){const n=this._range?this._idbCursorRequest.source.count(this._range):this._idbCursorRequest.source.count();n.onsuccess=t=>{e(t.target.result)},n.onerror=e=>{wt.reportIdbError(e.target.errorCode,t)}}internalDispose(){Object(f.a)(this._idbCursorRequest)||(this._idbCursorRequest.onsuccess=null,this._idbCursorRequest.onerror=null,this._idbCursorRequest=null)}internalSkip(e,t,n){Object(St.a)(!this._pendingCallback,"Skip cannot be called until the previous request completed"),this._pendingCallback=new Lt(t,n),this._idbCursorRequest.result.advance(e)}internalNext(e,t){Object(St.a)(!this._pendingCallback,"Next cannot be called until the previous request completed"),this._pendingCallback=new Lt(e,t),this._idbCursorRequest.result.continue()}initialize(e,t){e()}_HandleNextSuccess(e){Object(St.a)(!!this._pendingCallback,"There must be a pending callback");const t=this._pendingCallback;this._pendingCallback=null,t.get_success()()}_HandleNextError(e){Object(St.a)(!!this._pendingCallback,"There must be a pending callback");const t=this._pendingCallback;this._pendingCallback=null,t.get_error()(e.target.errorCode)}}class Ut extends kt{constructor(e,t){super(t),this._groupBy=null,this._groupBy=e}get_internalCurrentRecord(){return this.get_innerStrategy().get_currentRecord()}get_internalCurrentKey(){return this.get_innerStrategy().get_currentKey()}get_internalCurrentGroupId(){let e="";for(let t=0;t<this._groupBy.length;++t){const n=this._groupBy[t].get_path()===ge.a.get_id().get_path()?this.get_innerStrategy().get_currentKey():this._groupBy[t].getField(this.get_innerStrategy().get_currentRecord().data);Object(f.a)(n)||(e+=n.toString())}return e}internalNext(e,t){this.get_innerStrategy().next(e,t)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Vt{constructor(e,t){this._key=null,this._sortFieldValue=null,this._key=e,this._sortFieldValue=t}get_key(){return this._key}get_sortFieldValue(){return this._sortFieldValue}compareTo(e){return"number"==typeof this.get_sortFieldValue()&&"number"==typeof e.get_sortFieldValue()?this.get_sortFieldValue()-e.get_sortFieldValue():"string"==typeof this.get_sortFieldValue()&&"string"==typeof e.get_sortFieldValue()?this.get_sortFieldValue()===e.get_sortFieldValue()?0:this.get_sortFieldValue()>e.get_sortFieldValue()?1:-1:(Object(St.a)(!1,"unknown sort types"),0)}}class zt extends Ut{constructor(e,t,n,r){super([t],r),this._objectStore=null,this._sortField=null,this._sortOrder=0,this._currentRecord=null,this._currentKey=null,this._currentGroupId=null,this._groupBatch=null,this._groupBatchPosition=0,this._objectStore=e,this._sortField=t,this._sortOrder=n,this._groupBatchPosition=0,this._groupBatch=new Array(0)}get_internalCurrentRecord(){return this._currentRecord}get_internalCurrentKey(){return this._currentKey}get_internalCurrentGroupId(){return this._currentGroupId.toString()}internalNext(e,t){this._SetCurrentRecord(null,null),this._groupBatchPosition<this._groupBatch.length?this._ReadNextItemInBatchFromObjectStore(e,t):this.get_innerStrategy().get_position()===vt.after?e():this._PopulateNextBatchFromInnerStrategy(()=>{this.internalNext(e,t)},t)}initialize(e,t){this.get_innerStrategy().next(()=>{this.internalNext(e,t)},t)}_PopulateNextBatchFromInnerStrategy(e,t){this._groupBatch=new Array(0),this._groupBatchPosition=0;let n="";this.get_innerStrategy().get_position()===vt.after?e():(n=this.get_innerStrategy().get_currentGroupId(),this._AddToBatchWhileGroupIdMatches(n,e,t))}_AddToBatchWhileGroupIdMatches(e,t,n){if(this.get_innerStrategy().get_position()===vt.during&&this.get_innerStrategy().get_currentGroupId()===e){const r=this._sortField.get_path()===ge.a.get_id().get_path()?this.get_innerStrategy().get_currentKey():this._sortField.getField(this.get_innerStrategy().get_currentRecord().data);this._groupBatch.push(new Vt(this.get_innerStrategy().get_currentKey(),r)),this.get_innerStrategy().next(()=>{this._AddToBatchWhileGroupIdMatches(e,t,n)},n)}else this._SortBatch(),t()}_SortBatch(){this._groupBatch.length>0&&this._groupBatch.sort(Object(ie.a)(this,this._CompareSortRecords,"CompareSortRecords"))}_CompareSortRecords(e,t){const n=e,r=t;return this._sortOrder?r.compareTo(n):n.compareTo(r)}_ReadNextItemInBatchFromObjectStore(e,t){const n=this._groupBatch[this._groupBatchPosition].get_key(),r=this._objectStore.get(n);this._groupBatch[this._groupBatchPosition]=null,this._groupBatchPosition++,r.onsuccess=t=>{this._SetCurrentRecord(n,t.target.result),e()},r.onerror=()=>{t(r.errorCode)}}_SetCurrentRecord(e,t){this._currentKey=e,this._currentRecord=t,this._currentGroupId=t?this._sortField.getField(t.data):null}}class Wt extends kt{constructor(e,t){super(t),this._filter=null,this._filter=e}get_internalCurrentRecord(){return this.get_innerStrategy().get_currentRecord()}get_internalCurrentKey(){return this.get_innerStrategy().get_currentKey()}get_internalCurrentGroupId(){return this.get_innerStrategy().get_currentGroupId()}approximateCount(e,t){Object(F.j)(k.a.indexedDb,"Asking for ApproximateCount on a filtered strategy will not provide an accurate count!"),super.approximateCount(e,t)}internalNext(e,t){this.get_innerStrategy().next(()=>{this.get_innerStrategy().get_position()===vt.after||this._filter.isSatisfiedByRecord(this.get_innerStrategy().get_currentKey(),this.get_innerStrategy().get_currentRecord().data)?e():this.internalNext(e,t)},e=>{t(e)})}}function qt(e,t,n,r,a,i){Object(b.b)(t,"object store"),Object(b.b)(a,"success"),a=function(e,t,n){const r=e.onerror;e.onerror=t=>{e.onerror=r,wt.reportIdbError(t.target.errorCode,n),r&&r.apply(e,t)};const a=t;return t=t=>{e.onerror=r,a(t)}}(e,a,i),function(e){return!e}(r)?Ht(t,a):function(e){return!!e&&!e.get_filter()}(r)?function(e,t,n,r){switch($t(n)){case 0:Ht(e,r);break;case 1:!function(e,t,n,r){const a=n.get_sortBy()[0].get_sortField(),i=n.get_sortBy()[0].get_sortOrder(),o=t.getCursorFactory(e,a);o?Jt(o,i,null,r):function(e,t,n,r){Object(F.f)(k.a.indexedDb,"Creating Sort(Cursor) strategy.");const a=Ot();e.openCursor(a,Zt(r)).onsuccess=i=>{const o=new Bt(i.target,a),s=new zt(e,n,r,o);t(s)}}(e,r,a,i)}(e,t,n,r);break;case 2:!function(e,t,n,r){const a=t.getCursorFactoryForComposite(e,n.get_sortBy()[0].get_sortField(),n.get_sortBy()[1].get_sortField()),i=n.get_sortBy()[0].get_sortOrder(),o=n.get_sortBy()[1].get_sortOrder();i===o&&a?Jt(a,i,null,r):function(e,t,n,r){Object(F.f)(k.a.indexedDb,"Creating Sort(Sort(Cursor)) strategy.");const a=Ot();e.openCursor(a,"next").onsuccess=i=>{const o=new Bt(i.target,a),s=new zt(e,t.get_sortField(),t.get_sortOrder(),o),c=new zt(e,n.get_sortField(),n.get_sortOrder(),s);r(c)}}(e,n.get_sortBy()[0],n.get_sortBy()[1],r)}(e,t,n,r)}}(t,n,r,a):function(e){return!!e&&!!e.get_filter()&&e.get_filter()instanceof fe.a}(r)?function(e,t,n,r){switch($t(n)){case 0:!function(e,t,n,r){Gt(e,t,n,r)}(e,t,n,r);break;case 1:!function(e,t,n,r){const a=n.get_filter(),i=n.get_sortBy()[0];if(a.get_field().get_path()===i.get_sortField().get_path()){const n=t.getCursorFactory(e,a.get_field());if(n){const e=en(a);Jt(n,i.get_sortOrder(),e,r)}else Object(F.j)(k.a.indexedDb,"This query would run faster with an index on {0}",a.get_field().get_path()),Qt(e,a,i,r)}else{const n=t.getCursorFactoryForComposite(e,a.get_field(),i.get_sortField());if(n){const e=IDBKeyRange.bound(Mt(a.get_fieldValue(),""),Mt(a.get_fieldValue(),""),!0,!0);Jt(n,i.get_sortOrder(),e,r)}else Object(F.j)(k.a.indexedDb,"This query would run faster with an index on {0}:{1}",a.get_field().get_path(),i.get_sortField().get_path()),Qt(e,a,i,r)}}(e,t,n,r);break;case 2:!function(e,t,n,r){const a=n.get_filter(),i=n.get_sortBy()[0],o=n.get_sortBy()[1];let s=t.getCursorFactoryForComposite(e,a.get_field(),i.get_sortField());if(s){!function(e,t,n,r,a,i,o){Object(F.f)(k.a.indexedDb,"Creating Sort(Group((Index)) strategy.");t.openCursor(n,r).onsuccess=t=>{const r=new Bt(t.target,n),s=new Ut(a,r),c=new zt(e,i.get_sortField(),i.get_sortOrder(),s);o(c)}}(e,s,IDBKeyRange.bound(Mt(a.get_fieldValue(),""),Mt(a.get_fieldValue(),""),!0,!0),Zt(i.get_sortOrder()),[a.get_field(),i.get_sortField()],o,r)}else i.get_sortOrder()===o.get_sortOrder()?(s=t.getCursorFactoryForComposite(e,i.get_sortField(),o.get_sortField()),s?Kt(s,null,a,r):(Object(F.j)(k.a.indexedDb,"This query would run faster with an index on {0}:{1}",i.get_sortField().get_path(),o.get_sortField().get_path()),Xt(e,a,i,o,r))):(Object(F.j)(k.a.indexedDb,"This query would run faster with an index on {0}:{1}",a.get_field().get_path(),i.get_sortField().get_path()),Xt(e,a,i,o,r))}(e,t,n,r)}}(t,n,r,a):function(e){return!!e&&!!e.get_filter()&&(e.get_filter()instanceof me.a||e.get_filter()instanceof be.a)}(r)?function(e,t,n,r){switch($t(n)){case 0:!function(e,t,n,r){Gt(e,t,n,r)}(e,t,n,r);break;case 1:!function(e,t,n,r){const a=n.get_filter(),i=n.get_sortBy()[0],o=t.getCursorFactory(e,a.get_field());if(o){const t=en(a);a.get_field().get_path()===i.get_sortField().get_path()?Jt(o,i.get_sortOrder(),t,r):function(e,t,n,r,a){Object(F.f)(k.a.indexedDb,"Creating Sort(Index) strategy.");t.openCursor(n,"next").onsuccess=t=>{const i=new Bt(t.target,n),o=new zt(e,r.get_sortField(),r.get_sortOrder(),i);a(o)}}(e,o,t,i,r)}else Object(F.j)(k.a.indexedDb,"This query would run faster with an index on {0}",a.get_field().get_path()),Qt(e,a,i,r)}(e,t,n,r);break;case 2:!function(e,t,n,r){const a=n.get_filter(),i=n.get_sortBy()[0],o=n.get_sortBy()[1],s=t.getCursorFactory(e,a.get_field());if(s){!function(e,t,n,r,a,i){Object(F.f)(k.a.indexedDb,"Creating Sort(Sort(Index)) strategy.");t.openCursor(n,"next").onsuccess=t=>{const o=new Bt(t.target,n),s=new zt(e,r.get_sortField(),r.get_sortOrder(),o),c=new zt(e,a.get_sortField(),a.get_sortOrder(),s);i(c)}}(e,s,en(a),i,o,r)}else Object(F.j)(k.a.indexedDb,"This query would run faster with an index on {0}",a.get_field().get_path()),Xt(e,a,i,o,r)}(e,t,n,r)}}(t,n,r,a):function(e){return!!e&&!!e.get_filter()&&e.get_filter()instanceof he.a}(r)?function(e,t,n,r){switch($t(n)){case 0:!function(e,t,n,r){const a=t.getCursorFactory(e,n.get_filter().get_queryFields()[0]);if(a){Kt(a,en(n.get_filter()),n.get_filter(),r)}else Object(F.j)(k.a.indexedDb,"This query would run faster with an index on {0}",n.get_filter().get_queryFields()[0].get_path()),Yt(e,n.get_filter(),r)}(e,t,n,r);break;case 1:!function(e,t,n,r){const a=n.get_filter(),i=n.get_sortBy()[0],o=t.getCursorFactory(e,a.get_field());if(o){const t=en(a);a.get_field().get_path()===i.get_sortField().get_path()?Kt(o,t,n.get_filter(),r):function(e,t,n,r,a,i){Object(F.f)(k.a.indexedDb,"Creating Sort(Filter(Index)) strategy.");t.openCursor(n,"next").onsuccess=t=>{const o=new Bt(t.target,n),s=new Wt(r,o),c=new zt(e,a.get_sortField(),a.get_sortOrder(),s);i(c)}}(e,o,t,n.get_filter(),i,r)}else Object(F.j)(k.a.indexedDb,"This query would run faster with an index on {0}",a.get_field().get_path()),Qt(e,a,i,r)}(e,t,n,r);break;case 2:!function(e,t,n,r){const a=n.get_filter(),i=n.get_sortBy()[0],o=n.get_sortBy()[1],s=t.getCursorFactory(e,a.get_field());if(s){!function(e,t,n,r,a,i,o){Object(F.f)(k.a.indexedDb,"Creating Sort(Sort(Filter(Index))) strategy.");t.openCursor(n,"next").onsuccess=t=>{const s=new Bt(t.target,n),c=new Wt(r,s),l=new zt(e,a.get_sortField(),a.get_sortOrder(),c),u=new zt(e,i.get_sortField(),i.get_sortOrder(),l);o(u)}}(e,s,en(a),n.get_filter(),i,o,r)}else Object(F.j)(k.a.indexedDb,"This query would run faster with an index on {0}",a.get_field().get_path()),Xt(e,a,i,o,r)}(e,t,n,r)}}(t,n,r,a):Object(St.a)(!1,"unknown query type")}function Ht(e,t){!function(e,t){Object(F.f)(k.a.indexedDb,"Creating Cursor strategy.");const n=Ot();e.openCursor(n,"next").onsuccess=e=>{t(new Bt(e.target,n))}}(e,t)}function Gt(e,t,n,r){const a=t.getCursorFactory(e,n.get_filter().get_queryFields()[0]);if(a){Jt(a,0,en(n.get_filter()),r)}else Object(F.j)(k.a.indexedDb,"This query would run faster with an index on {0}",n.get_filter().get_queryFields()[0].get_path()),Yt(e,n.get_filter(),r)}function Kt(e,t,n,r){Object(F.f)(k.a.indexedDb,"Creating Filter(Index) strategy.");e.openCursor(t,"next").onsuccess=e=>{const a=new Bt(e.target,t),i=new Wt(n,a);r(i)}}function Qt(e,t,n,r){Object(F.f)(k.a.indexedDb,"Creating Sort(Filter((Cursor)) strategy.");const a=Ot();e.openCursor(a,"next").onsuccess=i=>{const o=new Bt(i.target,a),s=new Wt(t,o),c=new zt(e,n.get_sortField(),n.get_sortOrder(),s);r(c)}}function Xt(e,t,n,r,a){Object(F.f)(k.a.indexedDb,"Creating Sort(Sort(Filter((Cursor))) strategy.");const i=Ot();e.openCursor(i,"next").onsuccess=o=>{const s=new Bt(o.target,i),c=new Wt(t,s),l=new zt(e,n.get_sortField(),n.get_sortOrder(),c),u=new zt(e,r.get_sortField(),r.get_sortOrder(),l);a(u)}}function Yt(e,t,n){Object(F.f)(k.a.indexedDb,"Creating Filter(Cursor) strategy.");const r=Ot();e.openCursor(r,"next").onsuccess=e=>{const a=new Bt(e.target,r),i=new Wt(t,a);n(i)}}function Jt(e,t,n,r){Object(F.f)(k.a.indexedDb,"Creating Index strategy.");e.openCursor(n,Zt(t)).onsuccess=e=>{r(new Bt(e.target,n))}}function $t(e){return e.get_sortBy()&&e.get_sortBy().length?1===e.get_sortBy().length?1:2===e.get_sortBy().length?2:(Object(St.a)(!1,"invalid number of sorts: "+e.get_sortBy().length),0):0}function Zt(e){return e?"prev":"next"}function en(e){let t=null;if(e instanceof me.a){const n=e;switch(n.get_intervalType()){case 0:t=IDBKeyRange.bound(n.get_leftBound(),n.get_rightBound(),!1,!1);break;case Oe.a.open:t=IDBKeyRange.bound(n.get_leftBound(),n.get_rightBound(),!0,!0);break;case Oe.a.openLeft:t=IDBKeyRange.bound(n.get_leftBound(),n.get_rightBound(),!0,!1);break;case Oe.a.openRight:t=IDBKeyRange.bound(n.get_leftBound(),n.get_rightBound(),!1,!0);break;default:Object(St.a)(!1,"unknown range interval in CreateRangeFromQueryFilter")}}else if(e instanceof be.a){const n=e,r=!n.get_borderType();t=n.get_operatorType()?IDBKeyRange.upperBound(n.get_borderValue(),r):IDBKeyRange.lowerBound(n.get_borderValue(),r)}else if(e instanceof fe.a){const n=e;t=IDBKeyRange.only(n.get_fieldValue())}else if(e instanceof he.a){const n=e;n.get_inValues().sort(),t=IDBKeyRange.bound(n.get_inValues()[0],n.get_inValues()[n.get_inValues().length-1],!1,!1)}else Object(St.a)(!1,"unknown filter type in CreateRangeFromQueryFilter");return t}class tn{constructor(e,t,n,r){this._tx=null,this._os=null,this._metadata=null,this._observations=null,this._tx=e,this._os=t,this._metadata=n,this._observations=r}get_name(){return this._metadata.get_name()}getItem(e,t,n){const r=tn._ValidateAndExtractKeyValue(e);Object(b.b)(t,"successCallback");const a=this._os.get(r);a.onerror=e=>{Object(F.d)(k.a.indexedDb,"Error getting object from store:{0} with id:{1}. Error:{2}",this.get_name(),r,e.target.errorCode),wt.reportIdbError(e.target.errorCode,n)},a.onsuccess=e=>{let n=null;const a=e.target.result;a&&(Object(St.a)(void 0!==a.data,"the record for id:"+r+" in store "+this.get_name()+" does not have a data segment!"),Object(St.a)(void 0!==a.metadata,"the record for id:"+r+" in store "+this.get_name()+" does not have a metadata segment!"),n=a.data),t(n)}}deleteItem(e,t,n){this._observations.onBeforeDelete(this,e),this._tx.get_notificationCallback()(this.get_name(),yt.deleteItem,e,null);const r=tn._ValidateAndExtractKeyValue(e),a=this._os.delete(r);a.onerror=t=>{Object(F.d)(k.a.indexedDb,"Error deleting from object store:{0} the id:{1}. ErrorCode:{2}",this.get_name(),e.toKeyValue(),t.target.errorCode),wt.reportIdbError(t.target.errorCode,n)},a.onsuccess=()=>{wt.reportSuccess(t)}}clear(e,t){this._observations.onBeforeClear(this);const n=this._os.clear();n.onerror=e=>{Object(F.d)(k.a.indexedDb,"Error clearing from object store:{0}. ErrorCode:{1}",this.get_name(),e.target.errorCode),wt.reportIdbError(e.target.errorCode,t)},n.onsuccess=()=>{wt.reportSuccess(e)}}putItem(e,t,n,r){Object(b.b)(t,"json"),this._observations.onBeforePut(this,e,t),this._tx.get_notificationCallback()(this.get_name(),yt.changeItem,e,t);const a=new xt(t,{});for(let t=0;t<this._metadata.get_indexes().length;++t)this._metadata.get_indexes()[t].applyTo(a,e,this.get_name());const i=e.toKeyValue(),o=null===i?this._os.put(a):this._os.put(a,i);o.onerror=e=>{Object(F.d)(k.a.indexedDb,"PutItem: putRequest error"),wt.reportIdbError(e.target.errorCode,r)},o.onsuccess=e=>{n&&n(new Ze(e.target.result))}}objectQuery(e,t,n){Object(b.b)(t,"successCallback"),e&&this._CheckIfIndexedFieldsExist(e),qt(this._tx.get_idbTransaction(),this._os,this._metadata,e,e=>{t(new Rt(this._tx,e))},n)}_CheckIfIndexedFieldsExist(e){this._CheckIfQueryFieldsExist(e),this._CheckIfSortFieldsExist(e)}_CheckIfSortFieldsExist(e){if(e.get_sortBy())for(let t=0;t<e.get_sortBy().length;++t)if(!this._metadata.hasIndexedField(e.get_sortBy()[t].get_sortField().get_path())){const n=String.format("KeyPath {0} is being sorted but it is not an indexed field",e.get_sortBy()[t].get_sortField().get_path());Et.throwException(ce.constraintError,n)}}_CheckIfQueryFieldsExist(e){if(e.get_filter()){const t=e.get_filter().get_queryFields();for(let e=0;e<t.length;++e)if(!this._metadata.hasIndexedField(t[e].get_path())){const n=String.format("KeyPath {0} is being queried but it is not an indexed field",t[e].get_path());Et.throwException(ce.constraintError,n)}}}static _ValidateAndExtractKeyValue(e){Object(b.b)(e,"id");const t=e.toKeyValue();return Object(b.b)(t,"id must be provided"),Object(b.c)(t.toString(),"id must be provided"),t}}class nn{constructor(e,t,n,r){this._idbTransaction=null,this._metadata=null,this._observations=null,this._notificationEvents=null,this._isReadOnly=!1,this._publishNotifications=!1,this._aborted=!1,this._idbTransaction=e,this._observations=new At,this._metadata=t,this._publishNotifications=!0,this._isReadOnly=r,this._notificationEvents=new Nt(n)}get_isReadOnly(){return this._isReadOnly}get_idbTransaction(){return this._idbTransaction}get_aborted(){return this._aborted}get_notificationCallback(){return Object(ie.a)(this._notificationEvents,this._notificationEvents.queueNotificationEvents,"queueNotificationEvents")}publishNotificationEvents(){this._publishNotifications&&this._notificationEvents.publishNotificationEvents()}openObjectStore(e){if(e=e.toLowerCase(),!this._metadata.storeExists(e))throw Error.invalidOperation("storeName "+e+" does not exist.");const t=this._idbTransaction.objectStore(e),n=this._publishNotifications?this._observations:new At;return new tn(this,t,this._metadata.getStore(e),n)}}class rn{constructor(e,t){this._version=null,this._name=null,this._indexNamesToMetadataMap=null,this._singleIndexFieldsToMetadataMap=null,this._compositeIndexFieldsToMetadataMap=null,this._allIndexedFields=null,this._indexMetadata=null,this._name=e,this._version=t,this._indexNamesToMetadataMap={},this._singleIndexFieldsToMetadataMap={},this._compositeIndexFieldsToMetadataMap={},this._allIndexedFields=[],this._indexMetadata=[]}get_name(){return this._name}get_indexes(){return this._indexMetadata}addIndex(e){this._indexNamesToMetadataMap[e.get_indexName()]=e;for(let t=0;t<e.get_sourceFields().length;++t)this._allIndexedFields.indexOf(e.get_sourceFields()[t].get_path())<0&&this._allIndexedFields.push(e.get_sourceFields()[t].get_path());1===e.get_sourceFields().length?this._singleIndexFieldsToMetadataMap[e.get_sourceFields()[0].get_path()]=e:this._compositeIndexFieldsToMetadataMap[e.get_sourceFields()[0].get_path()+e.get_sourceFields()[1].get_path()]=e,this._indexMetadata.push(e)}indexExists(e){return e in this._indexNamesToMetadataMap}hasIndexedField(e){if(e===ge.a.get_id().get_path())return!0;for(let t=0;t<this._allIndexedFields.length;++t)if(this._allIndexedFields[t]===e)return!0;return!1}getCursorFactory(e,t){let n=null;if(t.get_path()===ge.a.get_id().get_path())n=e;else{const r=this._singleIndexFieldsToMetadataMap[t.get_path()];r&&(n=e.index(r.get_indexName()))}return n}getCursorFactoryForComposite(e,t,n){let r=null;if(t===n)r=this.getCursorFactory(e,t);else{const a=this._compositeIndexFieldsToMetadataMap[t.get_path()+n.get_path()];a&&(r=e.index(a.get_indexName()))}return r}clone(){const e=new rn(this._name,this._version);for(const t of this.get_indexes())e.addIndex(t);return e}}class an{constructor(){this._objectStores=null,this._objectStores={}}get_objectStores(){return Object.keys(this._objectStores)}getStore(e){return Object(St.a)(this.storeExists(e),"the store doesn't exist"+e),this._objectStores[e]}add(e,t){Object(St.a)(!this.storeExists(e),"the object store: "+e+" already exists."),this._objectStores[e]=new rn(e,t)}storeExists(e){return e in this._objectStores}clone(){const e=new an;e._objectStores={};const t=this._objectStores;for(const n in t){const r={key:n,value:t[n]},a=r.value;e._objectStores[r.key]=a.clone()}return e}remove(e){delete this._objectStores[e]}addIndex(e,t){const n=this._objectStores[e];Object(St.a)(!!n,"cannot add index unless object store exists"),n.addIndex(t)}indexExists(e,t){const n=this._objectStores[e];return Object(St.a)(!!n,"cannot query index information unless object store exists"),n.indexExists(t)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class on{constructor(e,t){this.unique=!1,this.multirow=!1,this.unique=e,this.multirow=t}static get_defaultOptions(){return on._defaultOptions}}on._defaultOptions=new on(!1,!1);class sn{constructor(e,t,n){this.storeName=null,this.indexName=null,this.keyPaths=null,this.storeName=e,this.indexName=t,this.keyPaths=new Array(n.length);for(let e=0;e<n.length;++e)this.keyPaths[e]=n[e].get_keyPath().get_path()}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class cn{constructor(e,t){this.name=null,this.version=null,this.name=e.toLowerCase(),this.version=t}}class ln{constructor(e,t,n){this._indexName=null,this._sourceFields=null,this._keyPathInIdbRecord=null,this._indexName=e,this._sourceFields=new Array(0),this._keyPathInIdbRecord=n;for(let e=0;e<t.length;++e)this._sourceFields.push(new ge.a(t[e]))}get_keyPathInIdbRecord(){return this._keyPathInIdbRecord}get_sourceFields(){return this._sourceFields}get_indexName(){return this._indexName}static validateSourceField(e,t,n,r){const a=e.getField(t.data);if(Object(f.a)(a)){const t=String.format("KeyPath {0} is a declared index on store {1} but does not exist in object with id {2}",e.get_path(),r,n.toKeyValue());throw Object(F.d)(k.a.indexedDb,t),Error.invalidOperation(t)}if("string"!=typeof a&&"number"!=typeof a){const t=String.format("KeyPath {0} is a declared index on store {1} but the object with id {2} is attempting to store the non-primitive type {3}.",e.get_path(),r,n.toKeyValue(),Object.getType(a).getName());throw Error.invalidOperation(t)}}}class un extends ln{constructor(e,t){super(e,t,new ge.a("data."+t[0]))}applyTo(e,t,n){ln.validateSourceField(this.get_sourceFields()[0],e,t,n)}}class dn extends ln{constructor(e,t){super(e,t,new ge.a("metadata."+e))}applyTo(e,t,n){ln.validateSourceField(this.get_sourceFields()[0],e,t,n),ln.validateSourceField(this.get_sourceFields()[1],e,t,n);const r=this.get_sourceFields()[0].getField(e.data),a=this.get_sourceFields()[1].getField(e.data);e.metadata[this.get_indexName()]=Mt(r,a)}}function pn(e){if(1===e.keyPaths.length)return new un(e.indexName,e.keyPaths);if(2===e.keyPaths.length)return new dn(e.indexName,e.keyPaths);throw Error.argument("fields","composite keys can only have two columns")}class gn{constructor(e,t,n){this._db=null,this._tx=null,this._versionObjectStore=null,this._indexObjectStore=null,this._metadata=null,this._db=e,this._tx=t,this._metadata=n,this._versionObjectStore=t.objectStore("__versions"),this._indexObjectStore=t.objectStore("__indexes")}createObjectStore(e,t,n){if(this._metadata.storeExists(e))throw Error.invalidOperation("the object store: "+e+" already exists.");if(e.startsWith("__"))throw Error.invalidOperation("the object store: "+e+" begins with the reserved prefix __.");this._db.createObjectStore(e,new Ct(null,n)),this._metadata.add(e,t),this._versionObjectStore.put(new cn(e,t),e)}removeObjectStore(e){if(!this._metadata.storeExists(e))throw Error.invalidOperation("the object store: "+e+" does not exist.");this._db.deleteObjectStore(e),this._metadata.remove(e),this._versionObjectStore.delete(e);this._indexObjectStore.openCursor(Ot(),"next").onsuccess=t=>{const n=t.target.result;if(n){n.value.storeName===e&&n.delete(),n.continue()}}}createIndex(e,t,n){if(!this._metadata.storeExists(t))throw Error.invalidOperation("the object store: "+t+" does not exist.");if(this._metadata.indexExists(t,e))throw Error.invalidOperation("the object store: "+t+" already has index "+e+" declared.");const r=new sn(t,e,n);this._indexObjectStore.put(r);const a=this._tx.objectStore(t),i=pn(r);a.createIndex(e,i.get_keyPathInIdbRecord().get_path(),on.get_defaultOptions()),this._metadata.addIndex(r.storeName,i)}}var hn,fn,mn=n("g73c");function bn(e,t,n){Object(St.a)(Object(f.a)(e.onabort),"onabort should not be subscribed yet"),Object(St.a)(Object(f.a)(e.oncomplete),"onsuccess should not be subscribed yet"),Object(St.a)(Object(f.a)(e.onerror),"onerror should not be subscribed yet"),e.oncomplete=()=>{Object(F.f)(k.a.indexedDb,"idb transaction successfully completed"),wt.reportSuccess(t),e.onabort=null,e.oncomplete=null},e.onabort=t=>{Object(F.j)(k.a.indexedDb,"idb transaction aborted!");let r=_t.AbortError;const a=t.target.error;a&&(r=Object(mn.a)(_t,a.name),Object(F.d)(k.a.indexedDb,"aborted due to error: "+r+":Error name = "+a.name+":Mode = "+e.mode)),wt.reportIdbError(r,n),e.onabort=null,e.oncomplete=null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e.readonly="readonly",e.readwrite="readwrite",e.versionchange="versionchange"}(hn||(hn={}));class _n{constructor(e,t){this._factory=null,this._name=null,this._subscriptions=null,this._version=null,this._db=null,this._metadata=null,this._factory=e,this._name=t,this._SetUninitialized()}get_version(){return this._version}get_objectStores(){return this._metadata.get_objectStores()}changeSchema(e,t,n,r){this._EnsureInitialized(()=>{this._InternalChangeSchema(e,t,n,r)},r)}transaction(e,t,n,r){this._TransactionInternal(e,t,n,r,!1)}readOnlyTransaction(e,t,n,r){this._TransactionInternal(e,t,n,r,!0)}_TransactionInternal(e,t,n,r,a){if(this._IsInitialized()){const i=this._db.transaction(e||this.get_objectStores(),a?hn.readonly:hn.readwrite),o=new nn(i,this._metadata,this._subscriptions,a);bn(i,()=>{o.publishNotificationEvents(),wt.reportSuccess(n),n=null,r=null},t=>{r&&(Object(F.d)(k.a.indexedDb,"TransactionInternal.Subscribe: Error. Transaction type - readOnly = "+a+" :objectStores = "+e.toString()),t=o.get_aborted()?new Et(ce.aborted,"Transaction manually aborted."):t,r(t)),n=null,r=null});try{t(o)}catch(t){Object(F.e)(k.a.indexedDb,t,"TransactionInternal:IDB caught an exception on the transaction callback and will abort.Transaction type - readOnly = "+a+" :objectStores = "+e.toString()),i.abort()}}else Object(F.d)(k.a.indexedDb,"TransactionInternal: Trying to acesss database when database is not initialized. Transaction type - readOnly = "+a+" :objectStores = "+e.toString())}wipe(e,t){Object(F.j)(k.a.indexedDb,"Wipe: Wipe/Uninitialize the database, IsInitialized = "+this._IsInitialized()),this._IsInitialized()&&this._db.close();const n=this._factory.deleteDatabase(this._name);n.onsuccess=()=>{Object(F.j)(k.a.indexedDb,"Wipe: DeleteDatabase success"),this._SetUninitialized(),wt.reportSuccess(e)},n.onerror=e=>{Object(F.d)(k.a.indexedDb,"Wipe: DeleteDatabase error"),wt.reportIdbError(e.target.errorCode,t)}}Initialize(e,t){Object(St.a)(!this._db,"Initialize cannot be called with an active database");const n=this._factory.open(this._name);n.onsuccess=n=>{if(this._db=n.target.result,this._InternalObjectStoresExist()){const n=this._db.transaction(Array.from(this._db.objectStoreNames),hn.readwrite);bn(n,e,t),this._PopulateMetadataFromInternalStores(n),Object(F.j)(k.a.indexedDb,"Initialize: Initialized the db, PopulateMetadataFromInternalStore")}else Object(F.j)(k.a.indexedDb,"Initialize: Initialized the db"),e()},n.onerror=e=>{Object(F.d)(k.a.indexedDb,"Initialize: factory.Open failed , errorcode = "+e.target.errorCode),wt.reportIdbError(e.target.errorCode,t)}}_InternalObjectStoresExist(){return this._VersionStoreExists()&&this._IndexStoreExists()}_IndexStoreExists(){return this._db.objectStoreNames.contains("__indexes")}_VersionStoreExists(){return this._db.objectStoreNames.contains("__versions")}_EnsureInternalObjectStores(){this._VersionStoreExists()||this._db.createObjectStore("__versions",Ct.forExternalKey()),this._IndexStoreExists()||this._db.createObjectStore("__indexes",Ct.forAutoIncrementedKey())}_PopulateMetadataFromInternalStores(e){this._PopulateVersionInformation(e),this._PopulateIndexInformation(e)}_PopulateIndexInformation(e){e.objectStore("__indexes").openCursor(Ot(),"next").onsuccess=e=>{const t=e.target.result;if(t){const e=t.value,n=pn(e);this._metadata.addIndex(e.storeName,n),t.continue()}}}_PopulateVersionInformation(e){const t=e.objectStore("__versions");this._PopulateDatabaseVersion(t),this._PopulateObjectStoreVersions(t)}_PopulateObjectStoreVersions(e){for(let t=0;t<this._db.objectStoreNames.length;++t)if(!this._db.objectStoreNames[t].startsWith("__")){e.get(this._db.objectStoreNames[t]).onsuccess=e=>{const t=e.target.result;this._metadata.add(t.name,t.version)}}}_PopulateDatabaseVersion(e){e.get("__db").onsuccess=e=>{const t=e.target.result;this._version=t.version}}_CreateAndReportOnSchemaUpdater(e,t,n){const r=new gn(this._db,n,t);try{e(r)}catch(e){Object(F.d)(k.a.indexedDb,"aborting transaction due to exception during schema update: "+e.message),n.abort()}}_SetDatabaseVersion(e,t){t.objectStore("__versions").put(new cn("__db",e),"__db")}_InternalChangeSchema(e,t,n,r){const a=this._metadata.clone(),i=this._db.version+1;Object(F.j)(k.a.indexedDb,"InternalChangeSchema: newIdbVersion = "+i+" :uninitialize the old db and upgrade"),this._db.close();const o=this._factory.deleteDatabase(this._name);o.onsuccess=()=>{this._SetUninitialized(),Object(F.j)(k.a.indexedDb,"InternalChangeSchema:Deleted old database now open new database");const o=this._factory.open(this._name,i);o.onupgradeneeded=n=>{const i=n.target;this._db=i.result,Object(F.j)(k.a.indexedDb,"InternalChangeSchema: Initialized the db : this._db exists ?  "+this._IsInitialized()),this._UpgradeDatabaseVersion(e,a,i.transaction,t,r)},o.onsuccess=()=>{this._IsInitialized()?(Object(F.j)(k.a.indexedDb,"InternalChangeSchema:open new database : Success "),wt.reportSuccess(n)):(Object(F.j)(k.a.indexedDb,"InternalChangeSchema:Failed because open new database was Success but Onupgradeneeded event was not fired "),wt.reportIdbError(_t.InvalidStateError,r))},o.onerror=e=>{Object(F.d)(k.a.indexedDb,"InternalChangeSchema: factory.Open error , errorcode = "+e.target.errorCode),wt.reportIdbError(e.target.errorCode,r)}},o.onerror=e=>{Object(F.d)(k.a.indexedDb,"InternalChangeSchema: factory.DeleteDatabase error , errorcode = "+e.target.errorCode),wt.reportIdbError(e.target.errorCode,r)}}_UpgradeDatabaseVersion(e,t,n,r,a){Object(F.j)(k.a.indexedDb,"UpgradeDatabaseVersion:open new database : newVersion = "+e),bn(n,()=>{this._metadata=t,this._version=e},a),this._EnsureInternalObjectStores(),this._SetDatabaseVersion(e,n),this._CreateAndReportOnSchemaUpdater(r,t,n)}_IsInitialized(){return!Object(f.a)(this._db)}_SetUninitialized(){this._db=null,this._version="",this._metadata=new an,this._subscriptions=new It(this),Object(F.j)(k.a.indexedDb,"SetUninitialized: Uninitialized the db")}_EnsureInitialized(e,t){this._IsInitialized()?e():this.Initialize(e,t)}}class yn extends bt{constructor(e){super(),this._factory=null,this._factory=e}openDatabase(e,t,n,r){Object(b.b)(n,"successCallback"),Object(b.c)(e,"name");const a=new _n(this._factory,e);a.Initialize(()=>{n(a)},r)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.unknownErr=0]="unknownErr",e[e.databaseErr=1]="databaseErr",e[e.versionErr=2]="versionErr",e[e.tooLargeErr=3]="tooLargeErr",e[e.quotaErr=4]="quotaErr",e[e.syntaxErr=5]="syntaxErr",e[e.constraintErr=6]="constraintErr",e[e.timeoutErr=7]="timeoutErr"}(fn||(fn={}));class vn extends Et{static reportSqlError(e,t){const n=e.message,r=vn._TranslateSqlError(e);Object(F.d)(k.a.sql,"SQL Error - code "+r+": {0}",n+":original sql error.code = "+e.code),vn.reportError(r,n,t)}static reportError(e,t,n){n&&n(new vn(e,t))}static _TranslateSqlError(e){let t=0;switch(e.code){case fn.constraintErr:t=ce.constraintError;break;case fn.databaseErr:t=ce.databaseError;break;case fn.quotaErr:t=ce.quotaError;break;case fn.syntaxErr:t=ce.syntaxError;break;case fn.timeoutErr:t=ce.timeoutError;break;case fn.tooLargeErr:t=ce.tooLargeError;break;case 0:t=0;break;case fn.versionErr:t=ce.versionError}return t}}class Sn{constructor(e,t){this._sqlQueryBuilder=null,this._tx=null,this._offset=0,this._seeking=!1,this._tx=e,this._sqlQueryBuilder=t}_set_offset(e){return this._offset=e,e}approximateCount(e,t){En.ExecuteSql(this._tx.get_SqlTransaction(),this._sqlQueryBuilder.get_selectCountStatement(),this._sqlQueryBuilder.get_sqlArguments(),(t,n)=>{const r=n.rows.item(0)["COUNT(*)"];e(r)},t)}next(e,t,n,r){this._ThrowIfSeeking(),this._sqlQueryBuilder.set_doPaging(!0),this._sqlQueryBuilder.set_offset(this._offset),this._sqlQueryBuilder.set_limit(e);const a=t?this._sqlQueryBuilder.get_selectIdStatement():this._sqlQueryBuilder.get_selectJsonStatement();this._set_offset(this._offset+e),En.ExecuteSql(this._tx.get_SqlTransaction(),a,this._sqlQueryBuilder.get_sqlArguments(),(e,r)=>{if(n){const e=[];for(let n=0;n<r.rows.length;++n){const a=Sn.getEntry(n,r,t);e.push(a)}n(this._tx,e)}},r)}skip(e,t,n){this._offset+=e,t()}internalSeekTo(e,t,n,r){this._sqlQueryBuilder.set_doPaging(!0),this._sqlQueryBuilder.set_offset(t),this._sqlQueryBuilder.set_limit(nt.m);const a=this._sqlQueryBuilder.selectIndexedColumnsStatement(e.get_queryFields());En.ExecuteSql(this._tx.get_SqlTransaction(),a,this._sqlQueryBuilder.get_sqlArguments(),(a,i)=>{const o=Sn._FindFirstIndex(i,e),s=-1!==o,c=i.rows.length>0;s||!c?(this._seeking=!1,this._set_offset(t+o),n(s)):this.internalSeekTo(e,t+i.rows.length,n,r)},e=>{this._seeking=!1,r&&r(e)})}dispose(){}_ThrowIfSeeking(){if(this._seeking)throw Error.invalidOperation("A seek operation is currently in progress")}static getEntry(e,t,n){const r=t.rows.item(e),a=r[nt.c];if(Object(St.a)(!Object(f.a)(a),"id cannot be null because put would have failed"),n)return new Dt(new Ze(a),null);const i=r[nt.d];Object(St.a)(!!i,"serialized json cannot be null because put would have failed");const o=JSON.parse(i);return Object(St.a)(!Object(f.a)(o),"JSON cannot be null or undefined because put would have failed.  Serialized JSON: "+i),new Dt(new Ze(a),o)}static _FindFirstIndex(e,t){for(let n=0;n<e.rows.length;++n)if(t.isSatisfiedBy(e.rows.item(n)))return n;return-1}}var On=n("bATk");class Cn{constructor(e,t,n,r){this._tx=null,this._metadata=null,this._queueEventsCallback=null,this._observations=null,this._tx=e,this._metadata=t,this._queueEventsCallback=n,this._observations=r}get_name(){return this._metadata.get_objectStore()}_get_indexedFields(){return this._metadata.get_indexedFields()}getItem(e,t,n){Object(b.b)(e,"id must be provided"),Object(b.b)(e.toKeyValue(),"id must be provided"),Object(b.b)(t,"success callback must be provided");const r=e.toKeyValue();Object(b.b)(r,"id must be provided"),Object(b.c)(r.toString(),"id must be provided");const a=String.format("SELECT * FROM [{0}] WHERE {1} = ?",this._metadata.get_objectStore(),nt.c),i=[r];En.ExecuteSql(this._tx.get_SqlTransaction(),a,i,(e,n)=>{const r=Cn._GenerateGetResult(n);t(r)},n)}deleteItem(e,t,n){Object(b.b)(e,"id must be provided");const r=e.toKeyValue();Object(b.b)(r,"id must be provided"),Object(b.c)(r.toString(),"id must be provided");const a=String.format("DELETE FROM [{0}] WHERE {1} = ?",this._metadata.get_objectStore(),nt.c),i=[r];this._observations.onBeforeDelete(this,e),En.ExecuteSql(this._tx.get_SqlTransaction(),a,i,()=>{this._queueEventsCallback&&this._queueEventsCallback(this.get_name(),yt.deleteItem,e,null),t&&t()},n)}clear(e,t){const n=String.format("DELETE FROM [{0}]",this._metadata.get_objectStore());this._observations.onBeforeClear(this),En.ExecuteSql(this._tx.get_SqlTransaction(),n,[],()=>{e&&e()},t)}putItem(e,t,n,r){Object(b.b)(e,"id must be provided"),Object(b.b)(t,"json must be provided");const a=String.format("INSERT OR REPLACE INTO [{0}] {1} VALUES {2}",this._metadata.get_objectStore(),this._BuildColumnNamesForPut(),this._BuildValuePlaceHoldersForPut()),i=this._BuildValueArgumentsForPut(e.toKeyValue(),t);this._observations.onBeforePut(this,e,t),En.ExecuteSql(this._tx.get_SqlTransaction(),a,i,(r,a)=>{this._queueEventsCallback&&this._queueEventsCallback(this.get_name(),yt.changeItem,e,t),e.toKeyValue()||(Object(St.a)(!!a.insertId,"sqlite begins ids at 1"),e=new Ze(a.insertId)),n&&n(e)},r)}objectQuery(e,t,n){Object(b.b)(t,"success"),this._CheckRequiredFieldsAreIndexed(e);const r=Object(On.a)(e,this._metadata.get_objectStore());t(new Sn(this._tx,r))}_CheckRequiredFieldsAreIndexed(e){e&&(this._CheckQueryFieldsAreIndexed(e),this._CheckSortFieldsAreIndexed(e))}_CheckSortFieldsAreIndexed(e){if(e.get_sortBy())for(let t=0;t<e.get_sortBy().length;++t)if(!this._metadata.hasIndexedField(e.get_sortBy()[t].get_sortField().get_path())){const n=String.format("KeyPath {0} is being sorted but it is not an indexed field",e.get_sortBy()[t].get_sortField().get_path());Et.throwException(ce.constraintError,n)}}_CheckQueryFieldsAreIndexed(e){if(e.get_filter()){const t=e.get_filter().get_queryFields();for(let e=0;e<t.length;++e)if(!this._metadata.hasIndexedField(t[e].get_path())){const n=String.format("KeyPath {0} is being queried but it is not an indexed field",t[e].get_path());Et.throwException(ce.constraintError,n)}}}_BuildValueArgumentsForPut(e,t){const n=[e,JSON.stringify(t)];for(let r=0;r<this._get_indexedFields().length;++r){const a=new ge.a(this._get_indexedFields()[r]).getField(t);this._ThrowIfKeyPathValueIsMissing(e,this._get_indexedFields()[r],a),this._ThrowIfKeyPathValueIsNonPrimitive(e,this._get_indexedFields()[r],a),n.push(a)}return n}_ThrowIfKeyPathValueIsMissing(e,t,n){if(Object(f.a)(n)){const n=String.format("KeyPath {0} is a declared index on store {1} but does not exist in object with id {2}",t,this._metadata.get_objectStore(),e);Et.throwException(ce.constraintError,n)}}_ThrowIfKeyPathValueIsNonPrimitive(e,t,n){if("string"!=typeof n&&"number"!=typeof n){const r=String.format("KeyPath {0} is a declared index on store {1} but the object with id {2} is attempting to store the non-primitive type {3}.",t,this._metadata.get_objectStore(),e,Object.getType(n).getName());Et.throwException(ce.constraintError,r)}}_BuildValuePlaceHoldersForPut(){let e="(?, ?";for(let t=0;t<this._get_indexedFields().length;++t)e+=", ?";return e+")"}_BuildColumnNamesForPut(){let e=String.format("({0}, {1}",nt.c,nt.d);for(let t=0;t<this._get_indexedFields().length;++t)e+=String.format(", [{0}]",this._get_indexedFields()[t]);return e+")"}static _GenerateGetResult(e){let t=null;return e.rows.length&&(Object(St.a)(1===e.rows.length,"if row length is not 0 it must be 1 for primary key query"),t=Sn.getEntry(0,e,!1).get_json()),t}}class En{constructor(e,t,n,r){this._tx=null,this._metadata=null,this._isReadOnly=!1,this._notificationEvents=null,this._observations=null,this._publishNotifications=!1,this._aborted=!1,this._tx=e,this._metadata=t,this._observations=new At,this._notificationEvents=null,this._publishNotifications=!0,this._isReadOnly=r,n&&(this._notificationEvents=new Nt(n))}get_isReadOnly(){return this._isReadOnly}get_aborted(){return this._aborted}get_eventCallback(){let e=null;return this._notificationEvents&&(e=Object(ie.a)(this._notificationEvents,this._notificationEvents.queueNotificationEvents,"queueNotificationEvents")),e}get_SqlTransaction(){return this._tx}openObjectStore(e){const t=this._metadata.getObjectStoreMetadata(e);if(!t)throw Error.invalidOperation(String.format("Object store {0} does not exist",e));const n=this._publishNotifications?this._observations:new At;return new Cn(this,t,this.get_eventCallback(),n)}publishNotificationEvents(){this._publishNotifications&&this._notificationEvents&&this._notificationEvents.publishNotificationEvents()}static ExecuteSql(e,t,n,r,a){let i="";Object(F.b)()&&(i=String.format("ExecuteSql => {0}",t)),e.executeSql(t,n,(e,t)=>{Object(F.b)()&&Object(F.f)(k.a.sql,"SUCCESS!: {0}",i),r&&r(e,t)},(e,t)=>(Object(F.b)()&&Object(F.d)(k.a.sql,"ERROR! error Message ='{0}': {1} :error Code = {2}",t.message,i,t.code),vn.reportSqlError(t,a),!0))}}class In{constructor(e,t){this._storeName=null,this._version=null,this._indexNames=null,this._indexedFields=null,this._storeName=e,this._version=t,this._indexNames={},this._indexedFields={}}get_objectStore(){return this._storeName}get_version(){return this._version}get_indexedFields(){return Object.keys(this._indexedFields).map(e=>this._indexedFields[e])}isEqual(e){return this._storeName.toLowerCase()===e.toLowerCase()}clone(){const e=new In(this.get_objectStore(),this.get_version());return e._indexNames=Object.assign({},this._indexNames),e._indexedFields=Object.assign({},this._indexedFields),e}addIndex(e){this._indexNames[e.toLowerCase()]=e}addIndexedField(e){this._indexedFields[e.toLowerCase()]=e}hasIndex(e){return e.toLowerCase()in this._indexNames}hasIndexedField(e){return e.toLowerCase()in this._indexedFields||e.toLowerCase()===nt.c}}class wn{constructor(){this._entries=[]}get_objectStores(){const e=[];for(let t=0;t<this._entries.length;++t){const n=this._GetEntryAt(t);e.push(n.get_objectStore())}return e}add(e,t){this._FindOrCreateEntry(e,t)}remove(e){for(let t=0;t<this._entries.length;++t){if(this._GetEntryAt(t).isEqual(e.get_objectStore())){this._entries.splice(t,1);break}}}clone(){const e=new wn;for(let t=0;t<this._entries.length;++t){const n=this._GetEntryAt(t);e._entries.push(n.clone())}return e}exists(e){return!!this.findEntry(e)}findEntry(e){let t=null;for(let n=0;n<this._entries.length;++n){const r=this._GetEntryAt(n);if(r.isEqual(e)){t=r;break}}return t}getObjectStoreMetadata(e){return this.findEntry(e)}_GetEntryAt(e){return this._entries[e]}_FindOrCreateEntry(e,t){let n=this.findEntry(e);return n||(n=new In(e,t),this._entries.push(n)),n}static createEmpty(){return new wn}static createFromResultSets(e,t){const n=new wn,r={};for(let e=0;e<t.rows.length;++e){const n=t.rows.item(e);r[n[nt.j].toLowerCase()]=n[nt.l]}const a=e.rows;for(let e=0;e<a.length;++e){const t=a.item(e),i=t[nt.h],o=t[nt.e],s=t[nt.f],c=n._FindOrCreateEntry(i,r[i.toLowerCase()]);Object(f.b)(o)||c.addIndex(o),Object(f.b)(s)||c.addIndexedField(s)}return n}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function jn(e){if(!new RegExp("^[@\\#\\$\\w]+(\\.[@\\#\\$\\w]+)?$").test(e))throw Error.invalidOperation("'"+e+"' is not a valid SQL identifier name.");return e}class Pn{constructor(e,t){this._objectStoreMetadata=null,this._transaction=null,this._transaction=e,this._objectStoreMetadata=t}createObjectStore(e,t,n){this._EnsureExistingTableDoesNotExist(e),Pn._CheckForReservedName(e),this._RemoveUnderlyingObjectStoreTable(e),this._CreateUnderlyingObjectStoreTable(e,n),this._AddStoreVersionToVersionsTable(e,t),this._AddStoreNameToObjectStoreMetadata(e,t)}removeObjectStore(e){const t=this._EnsureExistingTableExistsAndReturnMetadata(e);this._RemoveUnderlyingObjectStoreTable(t.get_objectStore()),this._RemoveStoreNameFromObjectStoreMetadata(t)}createIndex(e,t,n){Pn._CheckNoMoreThanTwoMultiColumnFields(n);const r=this._EnsureExistingTableExistsAndReturnMetadata(t);Pn._CheckIndexDoesNotExist(r,e),this._CreateColumnsForIndexedFields(e,n,r),this._CreateSqlIndexOnColumns(e,r,n),r.addIndex(e)}purgeObjectStoreMetadata(){const e=String.format("DELETE FROM {0}",nt.g),t=new Array(0);En.ExecuteSql(this._transaction,e,t,null,null)}purgeVersionMetadata(){const e=String.format("DELETE FROM {0}",nt.k),t=new Array(0);En.ExecuteSql(this._transaction,e,t,null,null)}_CreateColumnsForIndexedFields(e,t,n){for(let r=0;r<t.length;++r){const a=t[r];n.hasIndexedField(a.get_keyPath().get_path())||(this._AlterTableToAddColumnForIndex(n,a),this._AddIndexInformationToMetaTable(n,e,a))}}_CreateUnderlyingObjectStoreTable(e,t){const n=t?"INTEGER PRIMARY KEY AUTOINCREMENT":"TEXT PRIMARY KEY",r=String.format("CREATE TABLE [{0}]({1} {3}, {2} BLOB)",jn(e),nt.c,nt.d,n),a=new Array(0);En.ExecuteSql(this._transaction,r,a,null,null)}_AddStoreVersionToVersionsTable(e,t){const n=String.format("INSERT OR REPLACE INTO {0} ({1}, {2}) VALUES (?, ?)",nt.k,nt.j,nt.l),r=[jn(e),jn(t)];En.ExecuteSql(this._transaction,n,r,null,null)}_AddStoreNameToObjectStoreMetadata(e,t){const n=String.format("INSERT INTO {0} VALUES(?,?,?)",nt.g),r=[e,"",""];En.ExecuteSql(this._transaction,n,r,null,null),this._objectStoreMetadata.add(e,t)}_RemoveStoreNameFromObjectStoreMetadata(e){const t=String.format("DELETE FROM {0} WHERE {1} = ?",nt.g,nt.h),n=[e.get_objectStore()];En.ExecuteSql(this._transaction,t,n,null,null),this._objectStoreMetadata.remove(e)}_RemoveUnderlyingObjectStoreTable(e){const t=String.format("DROP TABLE IF EXISTS [{0}]",jn(e)),n=new Array(0);En.ExecuteSql(this._transaction,t,n,null,null)}_EnsureExistingTableDoesNotExist(e){if(this._objectStoreMetadata.exists(e)){const t=new vn(ce.constraintError,String.format("The object store {0} already exists.",e));throw Error.create(t.get_message(),t)}}_EnsureExistingTableExistsAndReturnMetadata(e){const t=this._objectStoreMetadata.findEntry(e);if(!t){const t=new vn(ce.constraintError,String.format("The object store {0} was not found.",jn(e)));throw Error.create(t.get_message(),t)}return t}_CreateSqlIndexOnColumns(e,t,n){const r=Pn._BuildColumnDefinitions(n),a=String.format("CREATE INDEX [{0}] ON [{1}] {2}",e,t.get_objectStore(),r),i=new Array(0);En.ExecuteSql(this._transaction,a,i,null,null)}_AddIndexInformationToMetaTable(e,t,n){const r=String.format("INSERT INTO {0} VALUES(?,?,?)",nt.g),a=[e.get_objectStore(),t,n.get_keyPath().get_path()];En.ExecuteSql(this._transaction,r,a,null,null),e.addIndexedField(n.get_keyPath().get_path())}_AlterTableToAddColumnForIndex(e,t){const n=String.format("ALTER TABLE [{0}] ADD COLUMN [{1}] {2}",e.get_objectStore(),t.get_keyPath().get_path(),function(e){let t="";if(!Object(f.a)(e)){switch(e){case 0:t="TEXT";break;case qe.integer:t="INTEGER"}Object(St.a)(!Object(f.b)(t),"Unknown KeyPathDataType: "+e)}return t}(t.get_dataType())),r=new Array(0);En.ExecuteSql(this._transaction,n,r,null,null)}static _CheckForReservedName(e){if(e.startsWith("__"))throw Error.create("An object store cannot be created with a name beginning with __")}static _BuildColumnDefinitions(e){let t="(";for(let n=0;n<e.length;++n)n>0&&(t+=", "),t+=String.format("[{0}]",e[n].get_keyPath().get_path());return t+=")",t}static _CheckNoMoreThanTwoMultiColumnFields(e){if(e.length>2)throw Error.invalidOperation("Cannot create a multi-column index with more than two fields")}static _CheckIndexDoesNotExist(e,t){if(e.hasIndex(t))throw Error.invalidOperation(String.format("The index {0} already exists",t))}}class Tn{constructor(e){this._db=null,this._metadata=null,this._subscriptions=null,this._version=null,this._db=e,this._metadata=wn.createEmpty(),this._subscriptions=new It(this),this._version=""}get_version(){return this._version}get_objectStores(){return this._metadata.get_objectStores()}changeSchema(e,t,n,r){const a=this._metadata.clone();this._db.transaction(n=>{Tn._CreateAndReportSingleUseUpdater(t,n,a),Tn._UpdateVersionMetaTable(n,e)},e=>{Object(F.d)(k.a.sql,"ChangeSchema:Error - code "+e.code+": {0}",e.message),vn.reportSqlError(e,r)},()=>{this._metadata=a.clone(),this._version=e,n&&n()})}transaction(e,t,n,r){this._TransactionInternal(t,n,r,!1)}readOnlyTransaction(e,t,n,r){this._TransactionInternal(t,n,r,!0)}_TransactionInternal(e,t,n,r){let a=null,i=Object(ie.a)(this._db,this._db.transaction,"transaction");r&&(i=Object(ie.a)(this._db,this._db.readTransaction,"readTransaction")),i(t=>{a=new En(t,this._metadata,this._subscriptions,r),e(a)},e=>{a&&a.get_aborted()&&n?(Object(F.d)(k.a.sql,"TransactionInternal:SQL Error, transaction aborted - code "+e.code+": {0}",e.message),n(new Et(ce.aborted,"transaction aborted."))):(Object(F.d)(k.a.sql,"TransactionInternal:SQL Error - code "+e.code+": {0}",e.message),vn.reportSqlError(e,n))},()=>{a&&a.publishNotificationEvents(),t&&t()})}wipe(e,t){const n=()=>{e&&e()},r=e=>{Object(F.d)(k.a.sql,"Wipe:Error - code "+e.get_code()+": {0}",e.get_message()),t&&t(e)};m.a.getInstance().get_IsAndroid()||m.a.getInstance().get_IsWindows()?this._WipeMultipleTransactions(n,r):this.changeSchema("",Object(ie.a)(this,this._InternalWipe,"InternalWipe"),n,r)}_WipeMultipleTransactions(e,t){const n=this.get_objectStores()[0],r=e=>{Object(f.a)(n)||e.removeObjectStore(n)},a=this._metadata.clone();this._db.transaction(e=>{Tn._CreateAndReportSingleUseUpdater(r,e,a)},e=>{Object(F.d)(k.a.sql,"WipeMultipleTransactions:Error - code :"+e.code+":Message : {0}",e.message),vn.reportSqlError(e,t)},()=>{this._metadata=a.clone(),this.get_objectStores().length>0?this._WipeMultipleTransactions(e,t):this.changeSchema("",Object(ie.a)(this,this._InternalWipe,"InternalWipe"),e,t)})}initialize(e,t){Object(b.b)(e,"success"),this._db.transaction(e=>{Tn._CreateObjectStoreMetaTable(e),Tn._CreateVersionMetaTable(e),this._PopulateMetadataFromDatabase(e)},e=>{Object(F.d)(k.a.sql,"Initialize:Error - code :"+e.code+":Message :"+e.message),vn.reportSqlError(e,t)},()=>{e()})}_InternalWipe(e){const t=e,n=this.get_objectStores();for(let e=0;e<n.length;++e)t.removeObjectStore(n[e]);t.purgeObjectStoreMetadata(),t.purgeVersionMetadata()}_PopulateMetadataFromDatabase(e){let t=String.format("SELECT * FROM {0}",nt.g);const n=new Array(0);En.ExecuteSql(e,t,n,(r,a)=>{t=String.format("SELECT * FROM {0}",nt.k),En.ExecuteSql(e,t,n,(e,t)=>{this._metadata=wn.createFromResultSets(a,t),this._SetDatabaseVersion(t)},null)},null)}_SetDatabaseVersion(e){for(let t=0;t<e.rows.length;++t){const n=e.rows.item(t);if(n[nt.j]===nt.i){this._version=n[nt.l];break}}}static _CreateAndReportSingleUseUpdater(e,t,n){let r=null;try{r=new Pn(t,n),e(r)}finally{}}static _CreateObjectStoreMetaTable(e){const t=String.format("CREATE TABLE IF NOT EXISTS {0}({1} TEXT, {2} TEXT, {3} TEXT)",nt.g,nt.h,nt.e,nt.f),n=new Array(0);En.ExecuteSql(e,t,n,null,null)}static _CreateVersionMetaTable(e){const t=String.format("CREATE TABLE IF NOT EXISTS {0}({1} TEXT PRIMARY KEY, {2} TEXT)",nt.k,nt.j,nt.l),n=new Array(0);En.ExecuteSql(e,t,n,null,null)}static _UpdateVersionMetaTable(e,t){const n=String.format("INSERT OR REPLACE INTO {0} ({1}, {2}) VALUES(?, ?)",nt.k,nt.j,nt.l),r=[nt.i,t];En.ExecuteSql(e,n,r,null,null)}}class Nn extends bt{constructor(e){super(),this._windowDb=null,this._windowDb=e}openDatabase(e,t,n,r){let a,i;if(Object(b.b)(n,"success"),this._TryGetDatabase(e,t,Object(ae.a)(()=>a,e=>a=e),Object(ae.a)(()=>i,e=>i=e))){const e=new Tn(a);e.initialize(()=>{n(e)},e=>{r&&r(e)})}else r&&r(new Et(0,i))}_TryGetDatabase(e,t,n,r){Object(b.c)(e,"name"),n.val=null,r.val="";try{n.val=this._windowDb.openDatabase(e,"","",t*Nn._oneMegaBytes,null)}catch(e){r.val=e.message,n.val=null}return!!n.val}}function An(e){let t=null;return!function(e){return e.get_supportsNativeSqlBridge()}(e)?!function(e){if(Object(l.b)()&&m.a.getInstance().get_isBrowserSafari())return!1;const t=m.a.getInstance().get_IsIOS()||m.a.getInstance().get_IsAndroid()||m.a.getInstance().get_isBrowserSafari();return!!e.get_indexedDbFactory()&&(!t||t&&!e.get_WebSqlDatabaseEnabled())}(e)?function(e){return e.get_WebSqlDatabaseEnabled()}(e)&&(t=function(e){const t=window.self;return new Nn(t)}()):t=new yn(e.get_indexedDbFactory()):t=function(e){const t=h.a.get_Instance().get_sql(),n=window.self,r=new mt(t,n);return new Nn(r)}(),t}Nn._oneMegaBytes=1048576;class Dn{constructor(e){this._databaseName=null,this._preferredDatabaseSizeMb=0,this._database=null,this._localStoreSchema=null,this._installDeferred=null,this._personalizationDatabases=[$e.userPersonalizationStore,$e.entityRecordStore],Object(b.c)(e,"databaseName"),this._databaseName=e.toLowerCase(),this._preferredDatabaseSizeMb=50,Object(u.e)("ClientBrowserStore_ClientBrowserStore",k.a.storage,this._databaseName),this._installDeferred=null}get_localStoreSchema(){return this._localStoreSchema}get_installPromise(){return this._installDeferred?this._installDeferred:null}get_isAvailable(){return!!this._database}get_dbFactory(){return An(m.a.getInstance())}install(e){if(Object(u.c)("ClientBrowserStore_Install_Start",k.a.storage,this._databaseName),Object(b.b)(e,"schema"),this._installDeferred)return this.get_installPromise();this._installDeferred=new re.a;const t=this.get_dbFactory();return t?this._InternalInstall(t,e,this._installDeferred):this._HandleInstallError("Unable to create Database Factory. User agent must support Web SQL Database Indexed Database or native SQL bridge.",this._installDeferred),this.get_installPromise()}upgrade(){return Object(u.e)("ClientBrowserStore_Upgrade_Start",k.a.storage,this._databaseName),this._installDeferred=new re.a,this._database.get_version()===this._localStoreSchema.get_version()?(this._HandleInstallSuccess(this._database,this._localStoreSchema,this._installDeferred),this.get_installPromise()):(this._RebuildDatabase(this._database,this._localStoreSchema,this._installDeferred),this.get_installPromise())}add(e,t,n,r){Object(u.d)("ClientBrowserStore_Add_Start",k.a.storage,this._databaseName),Object(b.d)(t,"data"),Object(b.c)(n,"storeName");const a=new re.a;if(this.get_isAvailable()){this.get_localStoreSchema().getSchemaFromObjectStoreName(n).get_idType()||Object(b.d)(e,"key"),this._TrackPendingOperation(a);let i=null;this._database.transaction(this._NormalizeObjectStoresNames([n]),a=>{this.createTransaction(a).add(e,t,n,r).done(e=>{i=e})},()=>{Object(u.d)("ClientBrowserStore_Add_End",k.a.storage,this._databaseName),a.resolve(i)},t=>{const r=d.a.fromLocalStoreError(-2147015599,Dn._ErrorFormat,this._databaseName,"Add",t.get_message());Object(u.b)("ClientBrowserStore_Add_End",k.a.storage,"Browser error code = "+t.get_code()+" : Error message = "+r.get_Message()+": storeName : "+n+" : Key :"+e.toString()),a.reject(r)})}else{const e=d.a.FromMessage(Dn._ErrorFormat,this._databaseName,"Add",Dn._NotAvailableError);Object(u.b)("ClientBrowserStore_Add_End",k.a.storage,e.get_Message()+": storeName : "+n),a.reject(e)}return a}addMultiple(e,t,n,r){Object(u.d)("ClientBrowserStore_AddMultiple_Start",k.a.storage,this._databaseName),Object(b.c)(n,"storeName"),Object(b.b)(t,"dataSet");const a=new re.a;if(this.get_isAvailable()){this._localStoreSchema.getSchemaFromObjectStoreName(n).get_idType()||Object(b.b)(e,"extractKey"),this._TrackPendingOperation(a);let i=null;this._database.transaction(this._NormalizeObjectStoresNames([n]),a=>{this.createTransaction(a).addMultiple(e,t,n,r).done(e=>{i=e})},()=>{Object(u.d)("ClientBrowserStore_AddMultiple_End",k.a.storage,this._databaseName),a.resolve(i)},t=>{const n=d.a.fromLocalStoreError(-2147015599,Dn._ErrorFormat,this._databaseName,"AddMultiple",t.get_message());Object(u.b)("ClientBrowserStore_AddMultiple_End",k.a.storage,"Browser error code = "+t.get_code()+" : Error message = "+n.get_Message()+" : extractKey = "+e.toString()),a.reject(n)})}else{const e=d.a.FromMessage(Dn._ErrorFormat,this._databaseName,"AddMultiple",Dn._NotAvailableError);Object(u.b)("ClientBrowserStore_AddMultiple_End",k.a.storage,e.get_Message()),a.reject(e)}return a}addMultipleByKey(e,t,n,r){Object(u.d)("ClientBrowserStore_AddMultipleByKey_Start",k.a.storage,this._databaseName),Object(b.c)(n,"storeName"),Object(b.b)(t,"dataSet");const a=new re.a;if(this.get_isAvailable()){this._TrackPendingOperation(a);let i=null;this._database.transaction(this._NormalizeObjectStoresNames([n]),a=>{this.createTransaction(a).addMultipleByKey(e,t,n,r).done(e=>{i=e})},()=>{Object(u.d)("ClientBrowserStore_AddMultipleByKey_End",k.a.storage,this._databaseName),a.resolve(i)},t=>{const n=d.a.fromLocalStoreError(-2147015599,Dn._ErrorFormat,this._databaseName,"AddMultiple",t.get_message());Object(u.b)("ClientBrowserStore_AddMultipleByKey_End",k.a.storage,"Browser error code = "+t.get_code()+" : Error message = "+n.get_Message()+" : keySet= "+e.join()),a.reject(n)})}else{const e=d.a.FromMessage(Dn._ErrorFormat,this._databaseName,"AddMultipleByKey",Dn._NotAvailableError);Object(u.b)("ClientBrowserStore_AddMultipleByKey_End",k.a.storage,e.get_Message()),a.reject(e)}return a}flush(e,t,n){Object(u.d)("ClientBrowserStore_Flush_Start",k.a.storage,this._databaseName),Object(b.f)(e,"key"),Object(b.c)(t,"storeName");const r=new re.a;if(this.get_isAvailable())this._TrackPendingOperation(r),this._database.transaction(this._NormalizeObjectStoresNames([t]),r=>{this.createTransaction(r).flush(e,t,n)},()=>{Object(u.d)("ClientBrowserStore_Flush_End",k.a.storage,this._databaseName),r.resolve()},t=>{const n=d.a.fromLocalStoreError(-2147015599,Dn._ErrorFormat,this._databaseName,"Flush",t.get_message());Object(u.b)("ClientBrowserStore_Flush_End",k.a.storage,"Browser error code = "+t.get_code()+" : Error message = "+n.get_Message()+" : Key :"+e.toString()),r.reject(n)});else{const e=d.a.FromMessage(Dn._ErrorFormat,this._databaseName,"Flush",Dn._NotAvailableError);Object(u.b)("ClientBrowserStore_Flush_End",k.a.storage,e.get_Message()),r.reject(e)}return r}flushAll(e,t){Object(u.d)("ClientBrowserStore_FlushAll_Start",k.a.storage,this._databaseName),Object(b.c)(e,"storeName");const n=new re.a;if(this.get_isAvailable())this._TrackPendingOperation(n),this._database.transaction(this._NormalizeObjectStoresNames([e]),n=>{this.createTransaction(n).flushAll(e,t)},()=>{Object(u.d)("ClientBrowserStore_FlushAll_End",k.a.storage,this._databaseName),n.resolve()},t=>{const r=d.a.fromLocalStoreError(-2147015599,Dn._ErrorFormat,this._databaseName,"FlushAll",t.get_message());Object(u.b)("ClientBrowserStore_FlushAll_End",k.a.storage,"Browser error code = "+t.get_code()+" : Error message = "+r.get_Message()+" : storeName :"+e),n.reject(r)});else{const e=d.a.FromMessage(Dn._ErrorFormat,this._databaseName,"FlushAll",Dn._NotAvailableError);Object(u.b)("ClientBrowserStore_FlushAll_End",k.a.storage,e.get_Message()),n.reject(e)}return n}retrieve(e,t,n){Object(u.d)("ClientBrowserStore_Retrieve_Start",k.a.storage,this._databaseName),Object(b.f)(e,"key"),Object(b.c)(t,"storeName");const r=new re.a;if(this.get_isAvailable()){this._TrackPendingOperation(r);let a=null;this._database.readOnlyTransaction(this._NormalizeObjectStoresNames([t]),r=>{this.createTransaction(r).retrieve(e,t,n).done(e=>{a=e})},()=>{Object(u.d)("ClientBrowserStore_Retrieve_End",k.a.storage,this._databaseName),r.resolve(a)},t=>{const n=d.a.fromLocalStoreError(-2147015599,Dn._ErrorFormat,this._databaseName,"Retrieve",t.get_message());Object(u.b)("ClientBrowserStore_Retrieve_End",k.a.storage,"Browser error code = "+t.get_code()+" : Error message = "+n.get_Message()+" : Key :"+e.toString()),r.reject(n)})}else{const n=d.a.FromMessage(Dn._ErrorFormat,this._databaseName,"Retrieve",Dn._NotAvailableError);Object(u.b)("ClientBrowserStore_Retrieve_End",k.a.storage,n.get_Message()+":databaseName = "+this._databaseName+":storeName = "+t+" :Key :"+e.toString()),r.reject(n)}return r}retrieveMultiple(e,t,n,r){Object(u.d)("ClientBrowserStore_RetrieveMultiple_Start",k.a.storage,this._databaseName),Object(b.c)(e,"keyPath"),"string"==typeof t?Object(b.c)(t,"keyValue"):Object(b.d)(t,"keyValue"),Object(b.c)(n,"storeName");const a=new fe.a(new ge.a(e),t),i=new _e.a(a,null);return this._ExtractResults(this.retrieveMultipleByQuery(i,n,r))}retrieveAll(e,t){return this._ExtractResults(this.retrieveMultipleByQuery(new _e.a(null,new Array(0)),e,t))}retrieveMultipleByQuery(e,t,n){Object(u.d)("ClientBrowserStore_RetrieveMultipleByQuery_Start",k.a.storage,this._databaseName),Object(b.d)(e,"query"),Object(b.c)(t,"storeName");const r=new re.a;if(this.get_isAvailable()){this._TrackPendingOperation(r);let a=new tt;this._database.readOnlyTransaction(this._NormalizeObjectStoresNames([t]),r=>{this.createTransaction(r).retrieveMultipleByQuery(e,t,n).done(e=>{a=e})},()=>{Object(u.d)("ClientBrowserStore_RetrieveMultipleByQuery_End",k.a.storage,this._databaseName),r.resolve(a)},t=>{const n=d.a.fromLocalStoreError(-2147015599,Dn._ErrorFormat,this._databaseName,"RetrieveMultipleByQuery",t.get_message());Object(u.b)("ClientBrowserStore_RetrieveMultipleByQuery_End",k.a.storage,"Browser error code = "+t.get_code()+" : Error message = "+n.get_Message()+" : query = "+e.toString()),r.reject(n)})}else{const e=d.a.FromMessage(Dn._ErrorFormat,this._databaseName,"RetrieveMultipleByQuery",Dn._NotAvailableError);Object(u.b)("ClientBrowserStore_RetrieveMultipleByQuery_End",k.a.storage,e.get_Message()),r.reject(e)}return r}transaction(e,t){return this._TransactionInternal(e,t,!1)}readOnlyTransaction(e,t){return this._TransactionInternal(e,t,!0)}_TransactionInternal(e,t,n){Object(u.d)("ClientBrowserStore_Transaction_Start",k.a.storage,this._databaseName);const r=new re.a;if(this.get_isAvailable()){this._TrackPendingOperation(r);let a=Object(ie.a)(this._database,this._database.transaction,"transaction");n&&(a=Object(ie.a)(this._database,this._database.readOnlyTransaction,"readOnlyTransaction"));let i=null;a(this._NormalizeObjectStoresNames(e),e=>{Object(u.d)("ClientBrowserStore_Transaction_Transaction",k.a.storage,this._databaseName),i=this.createTransaction(e),t(i)},()=>{Object(u.d)("ClientBrowserStore_Transaction_End",k.a.storage,this._databaseName),r.resolve(i.get_result())},e=>{const t=d.a.fromLocalStoreError(-2147015599,Dn._ErrorFormat,this._databaseName,"Transaction",e.get_message());Object(u.b)("ClientBrowserStore_Transaction_End",k.a.storage,"Browser error code = "+e.get_code()+" : Error message = "+t.get_Message()),r.reject(t)})}else{const e=d.a.FromMessage(Dn._ErrorFormat,this._databaseName,"Transaction",Dn._NotAvailableError);Object(u.b)("ClientBrowserStore_Transaction_End",k.a.storage,e.get_Message()),r.reject(e)}return r}createTransaction(e){return new st(e,this._databaseName)}_InternalInstall(e,t,n){Object(u.e)("ClientBrowserStore_Install_InternalInstall_Start",k.a.storage,this._databaseName),e.openDatabase(this._databaseName,this._preferredDatabaseSizeMb,e=>{Object(u.e)("ClientBrowserStore_Install_InternalInstall_OpenDatabase",k.a.storage,this._databaseName),Object(f.b)(e.get_version())?this._RebuildDatabase(e,t,n):this._HandleInstallSuccess(e,t,n)},e=>{Object(u.e)("ClientBrowserStore_Install_InternalInstall_End",k.a.storage,String.format(Dn._ErrorFormat,this._databaseName,"InternalInstall",e.get_message())),this._HandleInstallError(e.get_message(),n)})}pullPersonalizations(){const e=new re.a;if(!this._database.get_objectStores().length)return e.resolve(null),e;const t=new Array(this._personalizationDatabases.length);for(let e=0;e<this._personalizationDatabases.length;e++)t[e]=this.pullPersonalizationsInternal(this._personalizationDatabases[e].toLowerCase());return Object(_.a)(t).then(t=>{const n={};for(let e=0;e<this._personalizationDatabases.length;e++)n[this._personalizationDatabases[e].toLowerCase()]=t[e];e.resolve(n)},t=>{e.reject(t)}),e}pullPersonalizationsInternal(e){const t=new re.a;return this.retrieveAll(e,null).then(e=>{const n=[],r=[];for(let t=0;t<e.length;t++)n.push(e[t].get_key()),r.push(e[t].get_value());const a=new Qe.a(n,r);t.resolve(a)},e=>{t.reject(e)}),t}pushPersonalizations(e){const t=new re.a;if(Object.keys(e.count).length<1)return t.resolve(!1),t;const n=new Array(this._personalizationDatabases.length);for(let t=0;t<this._personalizationDatabases.length;t++){const r=this._personalizationDatabases[t].toLowerCase();n[t]=this.addMultipleByKey(e[r].get_key(),e[r].get_value(),r,null)}return Object(_.a)(n).then(()=>{t.resolve(!0)},e=>{t.reject(e)}),t}_RebuildDatabase(e,t,n){Object(u.e)("ClientBrowserStore_Install_RebuildDatabase_Start",k.a.storage,this._databaseName),e.wipe(()=>{Object(u.e)("ClientBrowserStore_Install_RebuildDatabase_Wipe",k.a.storage,this._databaseName),this._BuildDatabase(e,t,n)},e=>{Object(u.b)("ClientBrowserStore_Install_RebuildDatabase_End",k.a.storage,String.format(Dn._ErrorFormat,this._databaseName,"RebuildDatabase",e.get_message())),this._HandleInstallError(e.get_message(),n)})}_BuildDatabase(e,t,n){Object(u.e)("ClientBrowserStore_Install_BuildDatabase_Start",k.a.storage,this._databaseName),e.changeSchema(t.get_version(),e=>{Object(u.e)("ClientBrowserStore_Install_BuildDatabase_ChangeSchema",k.a.storage,this._databaseName);for(let n=0;n<t.get_objectStores().length;n++){const r=t.get_objectStores()[n],a=r.get_idType()===He.autoIncrementedInteger;e.createObjectStore(r.get_name(),r.get_version(),a);for(let t=0;t<r.get_indexes().length;++t)e.createIndex(r.get_name()+"_"+r.get_indexes()[t].get_name(),r.get_name(),r.get_indexes()[t].get_fields())}},()=>{Object(u.e)("ClientBrowserStore_Install_BuildDatabase_End",k.a.storage,this._databaseName),this._HandleInstallSuccess(e,t,n)},e=>{Object(u.b)("ClientBrowserStore_Install_BuildDatabase_End",k.a.storage,String.format(Dn._ErrorFormat,this._databaseName,"BuildDatabase",e.get_message())),this._HandleInstallError(e.get_message(),n)})}_HandleInstallSuccess(e,t,n){Object(u.e)("ClientBrowserStore_HandleInstallSuccess_Start",k.a.storage,this._databaseName),this._database=e,this._localStoreSchema=t,n.resolve(this._databaseName),Object(u.e)("ClientBrowserStore_HandleInstallSuccess_End",k.a.storage,":DatabaseName = "+this._databaseName+" :database.Version = "+this._database.get_version()+":localStoreSchema.Version = "+this._localStoreSchema.get_version())}_HandleInstallError(e,t){const n=d.a.FromMessage(Dn._ErrorFormat,this._databaseName,"Install",e);Object(u.e)("ClientBrowserStore_Install_End",k.a.storage,n.get_Message()),this._Cleanup(),t.reject(n)}_NormalizeObjectStoresNames(e){const t=e.length,n=new Array(t);for(let r=0;r<t;r++)n[r]=e[r].toLowerCase();return n}_TrackPendingOperation(e){window.__UCCacheModeEnabled&&M.a.protectHighPriorityBrowserAsyncWork(e)}_Cleanup(){Object(u.e)("ClientBrowserStore_Cleanup",k.a.storage,"cleaning up database and localStoreSchema"),this._database=null,this._localStoreSchema=null}_ExtractResults(e){const t=new re.a;return e.then(e=>{t.resolve(e.get_results())},e=>{t.reject(e)}),t}}Dn._ErrorFormat="{0} -- {1} ERROR -- {2}",Dn._NotAvailableError="Local store is not available. Make sure the local store is installed.";class Rn{constructor(e,t,n,r,a,i){if(this._query=null,this._indexId=0,this._logicalName=null,this._totalRecordCount=0,this._clientRetrieveOptions=null,this._entityIndex=null,"string"==typeof e)this._query=e,this._indexId=t,this._logicalName=n,this._totalRecordCount=r,this._clientRetrieveOptions=a,this._entityIndex=i;else{const t=e;t.get_query()instanceof ke.a&&(this._query=t.get_query().get_key(),this._indexId=0,this._logicalName=t.get_query().get_EntityLogicalName(),this.update(t))}}get_indexId(){return this._indexId}get_logicalName(){return this._logicalName}get_totalRecordCount(){return this._totalRecordCount}get_clientRetrieveOptions(){return this._clientRetrieveOptions}get_entityIndex(){return this._entityIndex}get_moreRecords(){return this._totalRecordCount>this._entityIndex.length}getObjectData(){return{indexid:this._indexId,[Rn.queryPath]:this._query,logicalname:this._logicalName,totalrecordcount:this._totalRecordCount,clientretrieveoptions:!Object(f.a)(this._clientRetrieveOptions)&&this._clientRetrieveOptions.getObjectData(),entityindex:this._entityIndex.map(e=>e.getObjectData())}}update(e){this._totalRecordCount=e.get_totalRecordCount(),Object(f.a)(this._clientRetrieveOptions)?this._clientRetrieveOptions=e.get_clientRetrieveOptions():this._clientRetrieveOptions.update(e.get_clientRetrieveOptions()),this._entityIndex=e.get_entities().map(e=>e.get_identifier().Id)}static createFromObjectData(e,t){const n="clientretrieveoptions"in t?O.a.createFromObjectData(t.clientretrieveoptions):null;return new Rn(t.query,e,t.logicalname,t.totalrecordcount,n,t.entityindex.map(e=>p.a.createFromObjectData(e)))}}Rn.queryPath="query";class xn{approximateCount(e,t){e(0)}next(e,t,n,r){n(new Fn(!1),[])}skip(e,t,n){t()}dispose(){}}class Mn{constructor(e){this._name=null,this._name=e}get_name(){return this._name}getItem(e,t,n){Object(u.d)(this._name+" :NoDb_GetItem",k.a.storage,JSON.stringify(e)),t(null)}deleteItem(e,t,n){Object(u.d)(this._name+" :NoDb_DeleteItem",k.a.storage,JSON.stringify(e)),t()}clear(e,t){Object(u.d)(this._name+" :NoDb_Clear",k.a.storage,null),e()}putItem(e,t,n,r){Object(u.d)(this._name+" :NoDb_PutItem",k.a.storage,e+": "+t),n(e)}objectQuery(e,t,n){Object(u.d)(this._name+" :NoDb_ObjectQuery",k.a.storage,JSON.stringify(e)),t(new xn)}}class Fn{constructor(e){this._isReadonly=!1,this._isReadonly=e}get_isReadOnly(){return this._isReadonly}openObjectStore(e){return new Mn(e)}}class kn{constructor(){this._databaseName=null,this._schema=null}get_isAvailable(){return!0}get_localStoreSchema(){return this._schema}install(e){const t=new re.a;return this._schema=e,t.resolve(this._databaseName),t}upgrade(){const e=new re.a;return e.resolve(this._databaseName),e}pullPersonalizations(){const e=new re.a;return e.resolve(null),e}pushPersonalizations(e){const t=new re.a;return t.resolve(!0),t}add(e,t,n,r){const a=new re.a;return a.resolve(new Ze(e).toKeyValue()),a}addMultiple(e,t,n,r){const a=new re.a;return a.resolve(t.map(t=>e(t))),a}flush(e,t,n){const r=new re.a;return r.resolve(new Ze(e).toKeyValue()),r}flushAll(e,t){const n=new re.a;return n.resolve(),n}retrieve(e,t,n){const r=new re.a;return r.resolve(null),r}retrieveMultiple(e,t,n,r){const a=new re.a;return a.resolve([]),a}retrieveMultipleByQuery(e,t,n){const r=new re.a;return r.resolve(new tt([])),r}transaction(e,t){const n=new re.a;return t(new st(new Fn(!0),this._databaseName)),n.resolve(null),n}readOnlyTransaction(e,t){const n=new re.a;return t(new st(new Fn(!0),this._databaseName)),n.resolve(null),n}}var Ln=n("37s6"),Bn=n("z+5+");class Un{constructor(e,t){this._serverUri=null,this._offlineDataStore=null,this._batchedCallbackRunner=null,this._localStore=null,this._sessionStateStore=null,this._isAvailable=!1,this._wasInitializedWithLocalStore=!1,this._purgingDeferred=null,this._addingNavigationDataDeferred=null,this._retrieveAttributeMetadataPromiseCache=null,this._parentDataSource=null,this._metadataTypeToKeys=null,this._payloadKeyToMetadataTypeMap=null,Object(u.e)("ClientBrowserStore_ClientBrowserDataSource",k.a.storage,":serverUri:"+e),this._serverUri=e,this._isAvailable=!1,this._localStore=new Dn(this._serverUri),this._sessionStateStore=this._localStore,this._batchedCallbackRunner=new oe("ClientBrowserDataSource.BatchedCallbackRunner",-2),this._retrieveAttributeMetadataPromiseCache=new z.a,this._parentDataSource=t,this._metadataTypeToKeys={},this._metadataTypeToKeys.form=[new Le(g.a.formSelector,"Id","FormSelectors"),new Le(g.a.form,"FormId","Forms")],this._metadataTypeToKeys.savedview=[new Le(g.a.viewSelector,"ViewId","ViewSelectors"),new Le(g.a.savedView,"ViewId","Views")],this._metadataTypeToKeys.workspace=[new Le(g.a.dashboardSelector,"Id","DashboardSelectors"),new Le(g.a.form,"FormId","Forms"),new Le(g.a.workspace,"FormId","Dashboards"),new Le(g.a.interactionCentricWorkspace,"FormId","Dashboards")],this._metadataTypeToKeys.systemworkspace=[new Le(g.a.dashboardSelector,"Id","DashboardSelectors"),new Le(g.a.form,"FormId","Forms"),new Le(g.a.workspace,"FormId","Dashboards"),new Le(g.a.interactionCentricWorkspace,"FormId","Dashboards")],this._metadataTypeToKeys.userworkspace=[new Le(g.a.dashboardSelector,"Id","DashboardSelectors"),new Le(g.a.form,"FormId","Forms"),new Le(g.a.workspace,"FormId","Dashboards"),new Le(g.a.interactionCentricWorkspace,"FormId","Dashboards")],this._metadataTypeToKeys.savedvisualization=[new Le(g.a.visualizationSelector,"Id","VisualizationSelectors"),new Le(g.a.savedQueryVisualization,"Id","SavedQueryVisualizations")],this._payloadKeyToMetadataTypeMap={},this._payloadKeyToMetadataTypeMap.AppModuleSelectors="appmoduleselector",this._payloadKeyToMetadataTypeMap.ViewSelectors="viewselector",this._payloadKeyToMetadataTypeMap.FormSelectors="formselector",this._payloadKeyToMetadataTypeMap.DashboardSelectors="dashboardselector",this._payloadKeyToMetadataTypeMap.VisualizationSelectors="visualizationselector",this._payloadKeyToMetadataTypeMap.BPFSelectors="bpfselector"}get_isAvailable(){return this._isAvailable&&this.get_localStore().get_isAvailable()}set_isAvailable(e){return this._isAvailable=e,e}get_IsAvailableOffline(){return this.get_isAvailable()&&!(this.get_localStore instanceof kn)}getClientMetadata(e){const t=new re.a;let n,r=null;const a=this._GetLegacyMetadataTypeForQuery(e.MetadataType,e.MetadataSubtype,Object(ae.a)(()=>n,e=>n=e));if(e.MetadataId&&(r=e.MetadataId.toString()),"entity"===e.MetadataType){const n=e.MetadataSubtype.replace(/\\\"/g,'"'),r=JSON.parse(n),a=[];for(const e in r){const t={key:e,value:r[e]};this._AddSingleEntityRetrievalPromise(a,t.key,t.value)}Object(_.a)(a).then(e=>{const n={};n.Entities=e,t.resolve(n)},e=>{Object(u.e)("ClientBrowserDataSource:GetClientMetadata:Entity_Failure",k.a.storage,e.get_Message()),t.reject(e)})}else if("savedview"===e.MetadataType||"form"===e.MetadataType||"workspace"===e.MetadataType||"systemworkspace"===e.MetadataType||"userworkspace"===e.MetadataType||"savedvisualization"===e.MetadataType)this._RetrieveSelectableMetadata(e,t);else if("dialog"===e.MetadataType||"taskbasedflow"===e.MetadataType)this._RetrieveMetadataWithHardDependency(e,t);else if((a===g.a.resourceString||a===g.a.label)&&e.MetadataNames&&e.MetadataNames.length>0){e.MetadataNames=this._RemoveDuplicates(e.MetadataNames);const n=[];for(const t of e.MetadataNames)if(a===g.a.label){const e=t.split(":");e&&2===e.length?n.push(this._CreateLocalStoreId(null,a,e[0],e[1])):Object(u.e)("ClientBrowserDataSource:GetClientMetadata:InvalidLabelName",k.a.storage,t)}else n.push(this._CreateLocalStoreId(null,a,null,t));const r=a===g.a.resourceString;0===n.length?t.resolve(this._WrapInOData(a,[],null)):this._RetrieveMultipleApplicationMetadataByKeys(ge.a.get_id(),n,!0).then(i=>{if(r&&i.length!==n.length){const r=this._GetMissingResourceStringKeys(e,i),o=d.a.fromLocalStoreError(-2147093987,"GetClientMetadata: Not able to find {0} keys out of {1} of type {2}. Missing keys: {3}.",n.length-i.length,n.length,g.a[a],r);Object(u.e)("ClientBrowserDataSource:GetClientMetadata:MissingResourceStrings",k.a.storage,o.get_Message());const s=this._parentDataSource.get_Store().getState();Object(Ln.h)(s)||t.reject(o)}t.resolve(this._WrapInOData(a,i,null))},e=>{t.reject(e)})}else if((a===g.a.optionSet||a===g.a.webResource||a===g.a.webResourceDescriptor||a===g.a.complexControl)&&e.MetadataNames&&e.MetadataNames.length>0){const n=[];for(const t of e.MetadataNames)r=this._CreateLocalStoreId(e.EntityLogicalName,a,null,t),n.push(this.retrieveApplicationMetadata(r,null));Object(_.a)(n).then(n=>{n?t.resolve(this._WrapInOData(a,n,e.MetadataNames)):t.reject(d.a.fromLocalStoreError(-2147093987,"GetClientMetadata: Not able to find some of the keys for type '{0}'",g.a[a]))},e=>{t.reject(e)})}else if(a===g.a.command&&e.MetadataNames&&e.MetadataNames.length>0)r=this._CreateLocalStoreId(e.EntityLogicalName,a,null,e.MetadataNames[0]),this.retrieveApplicationMetadata(r,null).then(e=>{if(e){const n=[e];t.resolve(this._WrapInOData(a,n,null))}else t.reject(d.a.fromLocalStoreError(-2147093987,"GetClientMetadata: Not able to find the key '{0}' for type '{1}'",r,g.a[a]))},e=>{t.reject(e)});else if(a!==g.a.appModule||Object(f.b)(r))if(a===g.a.appModuleOfflineMetadata)r=this._CreateLocalStoreId(null,a,null,null,0,null),this.retrieveApplicationMetadata(r,null).then(e=>{if(e){const n=[e];t.resolve(this._WrapInOData(a,n,null))}else t.resolve(null)},e=>{t.reject(e)});else if(!Object(f.b)(r)||a!==g.a.resourceString&&e.MetadataNames&&e.MetadataNames.length>0||a===g.a.taskBasedFlowGlobalMenu||a===g.a.quickCreateMenu||a===g.a.searchConfiguration||a===g.a.siteMap){const n=!e.AppId||e.AppId.equals(p.a.get_empty())?null:e.AppId.toString();r=this._CreateLocalStoreId(e.EntityLogicalName,a,r,e.MetadataNames[0],0,n),this.retrieveApplicationMetadata(r,null).then(e=>{if(e){const n=[e];t.resolve(this._WrapInOData(a,n,null))}else t.reject(d.a.fromLocalStoreError(-2147093987,"GetClientMetadata: Not able to find the key '{0}' for type '{1}'",r,g.a[a]))},e=>{t.reject(e)})}else if(a===g.a.isActivityFlags)r=this._CreateLocalStoreId(null,a,null,Un._EntityDefinitionsType),this.retrieveApplicationMetadata(r,null).then(e=>{if(e){const n=[e];t.resolve(this._WrapInOData(a,n,null))}else t.reject(d.a.fromLocalStoreError(-2147093987,"GetClientMetadata: Not able to find the key '{0}' for type '{1}'",r,g.a[a]))},e=>{t.reject(e)});else if(a===g.a.viewSelector){const i=!e.AppId||e.AppId.equals(p.a.get_empty())?e.MetadataId?e.MetadataId.toString():null:e.AppId.toString();r=this._CreateLocalStoreId(e.EntityLogicalName,g.a.viewSelector,null,null,n,i),this.retrieveApplicationMetadata(r,null).then(e=>{if(e){const n=[e];t.resolve(this._WrapInOData(a,n,null))}else t.reject(d.a.fromLocalStoreError(-2147093987,"GetClientMetadata: Not able to find the key '{0}' for type '{1}'",r,g.a[a]))},e=>{t.reject(e)})}else if(a===g.a.homePageConfiguration)r=this._CreateLocalStoreId(e.EntityLogicalName,g.a.homePageConfiguration,null,null,0,null),this.retrieveApplicationMetadata(r,null).then(e=>{if(Object(f.a)(e))t.reject(d.a.fromLocalStoreError(-2147093987,"GetClientMetadata: Not able to find the key '{0}' for type '{1}'",r,g.a[a]));else{const n=[e];t.resolve(this._WrapInOData(a,n,null))}},e=>{t.reject(e)});else{const i=new o.a(a,ue.a.Desktop,e.EntityLogicalName,0,e.GetDefault,r,n,null);this.retrieveMultipleApplicationMetadata(i,null).then(e=>{e.length?t.resolve(this._WrapInOData(a,e,null)):t.reject(d.a.fromLocalStoreError(-2147093987,"GetClientMetadata: Not able to find the key '{0}' for type '{1}'",r,g.a[a]))},e=>{t.reject(e)})}else{const n=!e.AppId||e.AppId.equals(p.a.get_empty())?e.MetadataId.toString():e.AppId.toString();r=this._CreateLocalStoreId(e.EntityLogicalName,a,r,e.MetadataNames[0],0,n),this.retrieveApplicationMetadata(r,null).then(e=>{if(e){const n=[e];t.resolve(this._WrapInOData(a,n,null))}else t.reject(d.a.fromLocalStoreError(-2147093987,"GetClientMetadata: Not able to find the key '{0}' for type '{1}'",r,g.a[a]))},e=>{t.reject(e)})}return t}_GetMissingResourceStringKeys(e,t){const n=t.filter(e=>e).map(e=>e.getDescriptor().Key);let r="";for(const t of e.MetadataNames){let e=!1;for(const r of n)if(t===r){e=!0;break}e||(r=Object(f.b)(r)?t:r+", "+t)}return r}_RemoveDuplicates(e){e.sort();const t=[];let n="";for(const r of e)r!==n&&(n=r,t.push(r));return t}getIsActivityFlags(){const e=new re.a,t=new A.a("isactivityflags",null,null,null,null,!1,C.a.Offline,null,null,null);return this.getClientMetadata(t).then(t=>{e.resolve(t)},t=>{Object(u.e)("ClientBrowserStore_ClientBrowserDataSource:GetIsActivityFlags",k.a.storage,t.get_Message()),e.resolve(null)}),e}getInitialEntities(){const e=new re.a,t=new A.a("entity",'{\\"activityparty\\":null}',null,null,null,!1,C.a.Offline,null,null,null);return this.getClientMetadata(t).then(t=>{e.resolve(t)},t=>{Object(u.e)("ClientBrowserStore_ClientBrowserDataSource:GetInitialEntities",k.a.storage,t.get_Message()),e.resolve(null)}),e}_AddSingleEntityRetrievalPromise(e,t,n){const r=new re.a;e.push(r),this.retrieveEntityMetadata(t,null).then(e=>{const a=e.getODataObject();let i=null;if(!Object(f.a)(n)){const e=a.AttributeNames,t=n;e.indexOf("statecode")>=0&&t.indexOf("statecode")<0&&t.push("statecode"),e.indexOf("statuscode")>=0&&t.indexOf("statuscode")<0&&t.push("statuscode"),i=t}try{Object(f.a)(i)||i.length>0?this.retrieveMultipleAttributeMetadata(new N.a(t,i),null).then(e=>{const i=[],o={};let s=!1;for(let t=0;t<e.length;t++)i.push(e[t].getODataObject()),o[e[t].get_logicalName()]=!0;n||(n=a.AttributeNames||new Array(0));const c=n.filter(e=>!o[e]);c.length>0&&(s=!0),s?r.reject(d.a.fromLocalStoreError(-2147093987,"Local store does not contain all requested attributes for {0}. Missing attributes are: {1}.",t,c.toString())):(a.Attributes=i,r.resolve(a))},e=>{r.reject(e)}):r.resolve(a)}catch(e){r.reject(d.a.fromGenericError(e))}},e=>{r.reject(e)})}_RetrieveMetadataWithHardDependency(e,t){if(!Object(f.a)(e.MetadataNames)&&e.MetadataNames.length>0){let n;const r=this._GetLegacyMetadataTypeForQuery(e.MetadataType,e.MetadataSubtype,Object(ae.a)(()=>n,e=>n=e)),a=[],i=[],o=[],s=e.MetadataNames;for(let e=0;e<s.length;++e){const n=new re.a,c=this._CreateLocalStoreId(null,r,null,s[e]);this.retrieveApplicationMetadata(c,null).then(e=>{if(e){i.push(e);const a=e.getDescriptor().FormId,s=this._CreateLocalStoreId(null,g.a.form,a,null);this.retrieveApplicationMetadata(s,null).then(e=>{e?(o.push(e),n.resolve()):n.reject(d.a.fromLocalStoreError(-2147093987,"GetClientMetadata: Not able to find the key '{0}' for type '{1}'",s,g.a[r]))},e=>{t.reject(e)})}else t.reject(d.a.fromLocalStoreError(-2147093987,"GetClientMetadata: Not able to find the key '{0}' for type '{1}'",c,g.a[r]))},e=>{t.reject(e)}),a.push(n)}Object(_.a)(a).then(e=>{const n=this._WrapInOData(r,i,null);n.Forms=this._WrapInOData(g.a.form,o,null).Forms,t.resolve(n)},e=>{t.reject(e)})}else t.reject(d.a.fromLocalStoreError(-2147093987,"Specified dialog wasn't found in the local store"))}_RetrieveNonSelectorKeychainMetadata(e,t,n){Object(f.a)(n)&&(n=[]);const r=this._GetLegacySubtype(e.MetadataType,e.MetadataSubtype);for(let a=0;a<t.length;++a){const i=t[a].get_metadataType(),s=e.MetadataId?new o.a(i,ue.a.Desktop,e.EntityLogicalName,0,!1,e.MetadataId.toString()):new o.a(i,ue.a.Desktop,e.EntityLogicalName,0,!1,null,r);n.push(this.retrieveMultipleApplicationMetadata(s,null))}return n}_GetLegacySubtype(e,t){let n;switch(e){case"form":case"formselector":case"dashboardselector":n=this._GetLegacyFormSubtype(t);break;case"viewselector":case"savedview":case"userview":n=this._GetLegacyViewSubtype(t);break;case"workspace":case"systemworkspace":case"userworkspace":n=pe.a.dashboard;break;default:n=0}return n}_RetrieveKeychainMetadata(e,t){let n=[];const r=this._GetLegacySubtype(e.MetadataType,e.MetadataSubtype),a=t[0];if(Object(f.a)(e.EntityLogicalName)&&"workspace"!==e.MetadataType&&"systemworkspace"!==e.MetadataType&&"userworkspace"!==e.MetadataType){const e=new o.a(a.get_metadataType(),ue.a.Desktop,null,0,!1,null,r),t=new re.a;this.retrieveMultipleApplicationMetadata(e,null).then(e=>{!Object(f.a)(e)&&e.length>0?t.resolve(e):t.reject(d.a.fromLocalStoreError(-2147093987,"The selector with the specified parameters wasn't found in the local store."))},e=>{t.reject(e)}),n.push(t)}else{const t=this._CreateLocalStoreId(e.EntityLogicalName,a.get_metadataType(),null,null,r,!e.AppId||e.AppId.equals(p.a.get_empty())?null:e.AppId.toString()),i=new re.a;this.retrieveApplicationMetadata(t,null).then(e=>{i.resolve([e])},e=>{i.reject(e)}),n.push(i)}return n=this._RetrieveNonSelectorKeychainMetadata(e,t.slice(1,t.length),n),Object(_.a)(n)}_RetrieveSelectableMetadata(e,t){const n=this._metadataTypeToKeys[e.MetadataType];if(!Object(f.a)(e.MetadataId)||e.MetadataNames&&e.MetadataNames.length)if(e.DependencyDepth===C.a.OnDemandWithContext)this._RetrieveKeychainMetadata(e,n).then(e=>{this._BuildPayload(t,e,n)},e=>{t.reject(e)});else{const r=n.slice(1,n.length),a=this._RetrieveNonSelectorKeychainMetadata(e,r);Object(_.a)(a).then(e=>{this._BuildPayload(t,e,r)},e=>{t.reject(e)})}else Object(f.a)(e.GetDefault)||!e.GetDefault?t.reject(d.a.fromLocalStoreError(-2147093987,"A query with empty MetadataId and non-true GetDefault parameters is considered invalid.")):Object(f.a)(e.EntityLogicalName)&&"workspace"!==e.MetadataType&&"systemworkspace"!==e.MetadataType&&"userworkspace"!==e.MetadataType?t.reject(d.a.fromLocalStoreError(-2147093987,"This query requests defaults and/or selectors, but does not specify the context. This query is considered invalid.")):this._RetrieveKeychainMetadata(e,n).then(r=>{if(Object(f.a)(r)||r.length<2)return void t.reject(d.a.fromLocalStoreError(-2147093987,"The local store does not contain metadata fragments or selectors for the specified query."));const a=r[0][0],i=n[0],o=this._FindDefaultSelectorItem(a);if(Object(f.a)(o))return void t.reject(d.a.fromLocalStoreError(-2147093987,"The default selector item cannot be found."));const s={};for(let e=1;e<r.length;++e){const t=r[e],a=n[e];for(let e=0;e<t.length;e++){const n=t[e];if(o[i.get_uniqueKey()]===n.getDescriptor()[a.get_uniqueKey()]){s[a.get_payloadKey()]=this._WrapInOData(a.get_metadataType(),[n],null)[a.get_payloadKey()];break}}}e.DependencyDepth===C.a.OnDemandWithContext&&(s[i.get_payloadKey()]=this._WrapInOData(i.get_metadataType(),[a],null)[i.get_payloadKey()]),t.resolve(s)},e=>{t.reject(e)})}_BuildPayload(e,t,n){if(Object(f.a)(t)||!t.length)return void e.reject(d.a.fromLocalStoreError(-2147093987,"The local store does not contain metadata fragments or selectors for the specified query."));const r={};for(let e=0;e<t.length;++e){const a=t[e],i=n[e];for(let e=0;e<a.length;e++){const t=a[e];r[i.get_payloadKey()]=this._WrapInOData(i.get_metadataType(),[t],null)[i.get_payloadKey()]}}for(let t=0;t<n.length;++t){const a=n[t];if(!(a.get_payloadKey()in r)||!r[a.get_payloadKey()].length)return void e.reject(d.a.fromLocalStoreError(-2147093987,"The local store does not contain {0} requested metadata.",a.get_payloadKey()))}e.resolve(r)}_FindDefaultSelectorItem(e){const t=e.getDescriptor().SelectorItems;if(!Object(f.a)(t)&&t.length>0){for(let e=0;e<t.length;e++){const n=t[e];if(n.IsDefault)return n}return t[0]}return null}filterClientMetadata(e){const t=new re.a;return t.resolve(e),t}_CreateLocalStoreId(e,t,n,r,a,i){let o="";switch(t){case g.a.overallMetadataVersion:o=String.format("{0}",Un.applicationMetadataVersionStampKey);break;case g.a.quickCreateMenu:o=String.format("{0}_quickcreatemenu_{1}",t,i);break;case g.a.searchConfiguration:o=String.format("{0}_searchconfiguration",t);break;case g.a.taskBasedFlowGlobalMenu:o=String.format("{0}_taskbasedflowglobalmenu",t);break;case g.a.siteMap:o=String.format("{0}_sitemap_{1}",t,i);break;case g.a.appModule:o=String.format("{0}_appmodules_{1}",t,i);break;case g.a.appModuleOfflineMetadata:o=String.format("{0}_appmoduleofflinemetadata",t);break;case g.a.taskBasedFlow:case g.a.customControl:case g.a.resourceString:case g.a.complexControl:o=String.format("{0}_{1}",t,r);break;case g.a.dialog:o=String.format("{0}_{1}",t,r.toLowerCase());break;case g.a.label:o=String.format("{0}_{1}_{2}",t,n,r);break;case g.a.homePageConfiguration:o=String.format("{0}_{1}",t,e);break;case g.a.optionSet:o=String.format("{0}_{1}",t,Object(f.b)(n)?r:n);break;case g.a.appModuleSelector:o=String.format("{0}_{1}",t,a);break;case g.a.viewSelector:case g.a.formSelector:case g.a.dashboardSelector:case g.a.visualizationSelector:o=String.format("{0}_{1}_{2}_{3}",t,e,a,i);break;case g.a.bpfSelector:o=String.format("{0}_{1}_{2}",t,e,i);break;case g.a.command:o=String.format("{0}_{1}_{2}",t,r,e);break;case g.a.isActivityFlags:case g.a.webResource:case g.a.webResourceDescriptor:o=String.format("{0}_{1}",t,r);break;case g.a.businessProcessFlow:case g.a.form:case g.a.savedQueryVisualization:case g.a.displayString:default:o=String.format("{0}_{1}",t,n)}return o}_WrapInOData(e,t,n){const r=t.filter(e=>e).map(e=>e.getDescriptor()),a=r,i={};switch(e){case g.a.userView:case g.a.savedView:return i.Views=a,i;case g.a.form:return i.Forms=a,i;case g.a.appModuleSelector:return i.AppModuleSelector=a,i;case g.a.viewSelector:return i.ViewSelectors=a,i;case g.a.dashboardSelector:return i.DashboardSelectors=a,i;case g.a.visualizationSelector:return i.VisualizationSelectors=a,i;case g.a.interactionCentricWorkspace:case g.a.workspace:return i.Dashboards=a,i;case g.a.quickCreateMenu:case g.a.taskBasedFlowGlobalMenu:case g.a.searchConfiguration:case g.a.isActivityFlags:return r[0];case g.a.formSelector:return i.FormSelectors=a,i;case g.a.bpfSelector:i.BPFSelectors=a;case g.a.label:return i.Labels=a,i;case g.a.resourceString:const e=[];return e.push(a),i.ResourceStrings=e,i;case g.a.displayString:const t=[];return t.push(a),i.DisplayStrings=t,i;case g.a.webResourceDescriptor:return i.WebResources=a,i;case g.a.webResource:return i.WebResourcesContent=a,i;case g.a.customControl:return i.CustomControls=a,i;case g.a.savedQueryVisualization:return i.SavedQueryVisualizations=a,i;case g.a.optionSet:return i.OptionSets=a,i;case g.a.homePageConfiguration:return i.CustomControlConfigurations=a,i;case g.a.businessProcessFlow:return i.BusinessProcessFlowMetadata=a,i;case g.a.dialog:return i.Dialogs=a,i;case g.a.taskBasedFlow:return i.TaskBasedFlows=a,i;case g.a.userQueryVisualization:return i.UserQueryVisualizations=a,i;case g.a.command:return i.Ribbons=a,i;case g.a.siteMap:return i.Sitemap=a,i;case g.a.appModule:return i.AppModulePublished=a,i;case g.a.appModuleOfflineMetadata:return i.AppModules=a,i;case g.a.overallMetadataVersion:return i.MetadataVersion=a,i;case g.a.complexControl:return i.ComplexControls=a,i;default:return null}}StoreApplicationMetadata(e){const t=new re.a,n=[],r=[],a=[];let i=null,o=-1,s=-1;e.EntityMetadataVersionStamp&&(o=e.EntityMetadataVersionStamp[0]),e.MetadataVersion&&(s=e.MetadataVersion[0]);for(const t in e){const c={key:t,value:e[t]};let l,u,d,p=null;switch(c.key){case"Forms":for(const e of c.value)u=this._GetLegacyMetadataTypeForQuery("form",de.a[e.FormType].toLowerCase(),Object(ae.a)(()=>l,e=>l=e)),p=this._CreateLocalStoreId(null,u,e.Id,null),n.push(this._ConvertMetadataToApplicationMetadata(e,u,l,e.EntityLogicalName,p,e.IsDefault,e.Id));break;case"Dashboards":u=this._GetLegacyMetadataTypeForQuery("workspace",null,Object(ae.a)(()=>l,e=>l=e));for(const e of c.value)p=this._CreateLocalStoreId(null,u,e.FormId,null),n.push(this._ConvertMetadataToApplicationMetadata(e,u,l,null,p,!1,e.FormId));break;case"Views":for(const e of c.value)u=e.IsUserView?this._GetLegacyMetadataTypeForQuery("userview",se[e.QueryType].toUpperCase(),Object(ae.a)(()=>l,e=>l=e)):this._GetLegacyMetadataTypeForQuery("savedview",se[e.QueryType].toUpperCase(),Object(ae.a)(()=>l,e=>l=e)),p=this._CreateLocalStoreId(null,u,e.ViewId,null),n.push(this._ConvertMetadataToApplicationMetadata(e,u,l,e.EntityLogicalName,p,e.IsDefault,e.ViewId));break;case"Entities":for(const e of c.value)e.VersionNumber=o,e.OverallVersionNumber=s,r.push(E.a.createFromOData(e)),e.Attributes&&a.push(...this._ConvertToAttributeMetadata(e.Attributes));break;case"AppModuleSelectors":case"ViewSelectors":case"FormSelectors":case"DashboardSelectors":case"VisualizationSelectors":d=this._payloadKeyToMetadataTypeMap[c.key];for(const e of c.value)u=this._GetLegacyMetadataTypeForQuery(d,e.MetadataSubtype,Object(ae.a)(()=>l,e=>l=e)),p=this._CreateLocalStoreId(e.EntityLogicalName,u,null,null,l,e.AppId),n.push(this._ConvertMetadataToApplicationMetadata(e,u,l,e.EntityLogicalName,p,!1));break;case"BPFSelectors":d=this._payloadKeyToMetadataTypeMap[c.key],u=this._GetLegacyMetadataTypeForQuery(d,null,Object(ae.a)(()=>l,e=>l=e));for(const e of c.value)p=this._CreateLocalStoreId(e.EntityLogicalName,u,null,null,l,e.AppId),n.push(this._ConvertMetadataToApplicationMetadata(e,u,l,e.EntityLogicalName,p,!1));break;case"SavedQueryVisualizations":for(const e of c.value)u=e.IsUserQueryVisualization?this._GetLegacyMetadataTypeForQuery("uservisualization",null,Object(ae.a)(()=>l,e=>l=e)):this._GetLegacyMetadataTypeForQuery("savedvisualization",null,Object(ae.a)(()=>l,e=>l=e)),p=this._CreateLocalStoreId(null,u,e.Id,null),n.push(this._ConvertMetadataToApplicationMetadata(e,u,l,e.PrimaryEntityTypeCode,p,e.IsDefault,e.Id));break;case"CustomControls":u=this._GetLegacyMetadataTypeForQuery("customcontrol",null,Object(ae.a)(()=>l,e=>l=e));for(const e of c.value)p=this._CreateLocalStoreId(null,u,null,e.Name),n.push(this._ConvertMetadataToApplicationMetadata(e,u,l,null,p,!1));break;case"Labels":u=this._GetLegacyMetadataTypeForQuery("label",null,Object(ae.a)(()=>l,e=>l=e));for(const e of c.value)p=this._CreateLocalStoreId(null,u,e.Id,e.LabelColumnName),n.push(this._ConvertMetadataToApplicationMetadata(e,u,l,null,p,!1));break;case"ResourceStrings":u=this._GetLegacyMetadataTypeForQuery("resourcestring",null,Object(ae.a)(()=>l,e=>l=e));for(const e of c.value)for(const t of e)p=this._CreateLocalStoreId(null,u,null,t.Key),n.push(this._ConvertMetadataToApplicationMetadata(t,u,l,null,p,!1));break;case"DisplayStrings":u=this._GetLegacyMetadataTypeForQuery("displaystring",null,Object(ae.a)(()=>l,e=>l=e));for(const e of c.value)for(const t of e)p=this._CreateLocalStoreId(null,u,t.Key,null),n.push(this._ConvertMetadataToApplicationMetadata(t,u,l,null,p,!1));break;case"WebResources":for(const e of c.value)Object(f.a)(e.Content)||Object(f.a)(e.Type)||(u=this._GetLegacyMetadataTypeForQuery("webresource",ve[parseInt(e.Type.toString(),10)],Object(ae.a)(()=>l,e=>l=e)),p=this._CreateLocalStoreId(null,u,null,e.Name),n.push(this._ConvertMetadataToApplicationMetadata(e.Content,u,l,null,p,!1,e.Name)),e.Content=null),u=this._GetLegacyMetadataTypeForQuery("webresourcedescriptor",null,Object(ae.a)(()=>l,e=>l=e)),p=this._CreateLocalStoreId(null,u,null,e.Name),n.push(this._ConvertMetadataToApplicationMetadata(e,u,l,null,p,!1,e.Id));break;case"Ribbons":u=this._GetLegacyMetadataTypeForQuery("ribbon",null,Object(ae.a)(()=>l,e=>l=e));for(const e of c.value)p=this._CreateLocalStoreId(e.EntityLogicalName,u,null,e.Context),n.push(this._ConvertMetadataToApplicationMetadata(e,u,l,null,p,!1));break;case"QuickCreateMenu":u=this._GetLegacyMetadataTypeForQuery("quickcreatemenu",null,Object(ae.a)(()=>l,e=>l=e));const e={};for(const t of c.value)p=this._CreateLocalStoreId(null,u,null,null,0,t.AppId),p in e||(Object.keys(e).push(p),e[p]=[]),e[p].push(t);for(const t of Object.keys(e)){const r={};r.QuickCreateMenu=e[t],n.push(this._ConvertMetadataToApplicationMetadata(r,u,l,null,t,!1))}break;case"OptionSets":u=this._GetLegacyMetadataTypeForQuery("optionset",null,Object(ae.a)(()=>l,e=>l=e));for(const e of c.value)p=this._CreateLocalStoreId(null,u,e.MetadataId,e.OptionSetName),e.VersionNumber=o,e.OverallVersionNumber=s,n.push(this._ConvertMetadataToApplicationMetadata(e,u,l,null,p,!1));break;case"CustomControlConfigurations":u=this._GetLegacyMetadataTypeForQuery("customcontroldefaultconfig",null,Object(ae.a)(()=>l,e=>l=e));for(const e of c.value)p=this._CreateLocalStoreId(e.PrimaryEntityType,u,e.CustomControlId,e.Name),n.push(this._ConvertMetadataToApplicationMetadata(e,u,l,null,p,!0));break;case"BusinessProcessFlowMetadata":u=this._GetLegacyMetadataTypeForQuery("businessprocessflow",null,Object(ae.a)(()=>l,e=>l=e));for(const e of c.value)p=this._CreateLocalStoreId(null,u,e.BusinessProcessFlowId,null),n.push(this._ConvertMetadataToApplicationMetadata(e,u,l,null,p,!0));break;case"Dialogs":u=this._GetLegacyMetadataTypeForQuery("dialog",null,Object(ae.a)(()=>l,e=>l=e));for(const e of c.value)p=this._CreateLocalStoreId(null,u,null,e.UniqueName),n.push(this._ConvertMetadataToApplicationMetadata(e,u,l,null,p,!0));break;case"TaskBasedFlows":u=this._GetLegacyMetadataTypeForQuery("taskbasedflow",null,Object(ae.a)(()=>l,e=>l=e));for(const e of c.value)p=this._CreateLocalStoreId(null,u,null,e.UniqueName),n.push(this._ConvertMetadataToApplicationMetadata(e,u,l,null,p,!0));break;case"TaskBasedFlowGlobalMenu":const t={};t.TaskBasedFlowGlobalMenu=c.value,u=this._GetLegacyMetadataTypeForQuery("taskbasedflowglobalmenu",null,Object(ae.a)(()=>l,e=>l=e)),p=this._CreateLocalStoreId(null,u,null,null),n.push(this._ConvertMetadataToApplicationMetadata(t,u,l,null,p,!0));break;case"Search":const g={};g.Search=c.value,u=this._GetLegacyMetadataTypeForQuery("search",null,Object(ae.a)(()=>l,e=>l=e)),p=this._CreateLocalStoreId(null,u,null,null),n.push(this._ConvertMetadataToApplicationMetadata(g,u,l,null,p,!0));break;case"Sitemap":u=this._GetLegacyMetadataTypeForQuery("sitemap",null,Object(ae.a)(()=>l,e=>l=e));for(const e of c.value)p=this._CreateLocalStoreId(null,u,null,null,0,e.AppId),n.push(this._ConvertMetadataToApplicationMetadata(e,u,l,null,p,!0));break;case"AppModulePublished":u=this._GetLegacyMetadataTypeForQuery("appmodules",null,Object(ae.a)(()=>l,e=>l=e));for(const e of c.value)p=this._CreateLocalStoreId(null,u,null,null,0,e.appInfo.AppId),n.push(this._ConvertMetadataToApplicationMetadata(e,u,l,null,p,!0));break;case"AppModules":u=this._GetLegacyMetadataTypeForQuery("appmoduleofflinemetadata",null,Object(ae.a)(()=>l,e=>l=e)),p=this._CreateLocalStoreId(null,u,null,null,0,null),n.push(this._ConvertMetadataToApplicationMetadata(c.value[0],u,l,null,p,!0));break;case"ComplexControls":u=this._GetLegacyMetadataTypeForQuery("complexcontrol",null,Object(ae.a)(()=>l,e=>l=e));for(const e of c.value)p=this._CreateLocalStoreId(null,u,null,e.Name),n.push(this._ConvertMetadataToApplicationMetadata(e,u,l,null,p,!1));break;case"EntityMetadataVersionStamp":i=c.value[0];break;case"IsActivityFlags":u=this._GetLegacyMetadataTypeForQuery("isactivityflags",null,Object(ae.a)(()=>l,e=>l=e)),p=this._CreateLocalStoreId(null,u,null,Un._EntityDefinitionsType),n.push(this._ConvertMetadataToApplicationMetadata(c.value,u,l,null,p,!1))}}const c=[this._createMultipleApplicationMetadata(n),this._CreateMultipleEntityMetadata(r),this.createMultipleAttributeMetadata(a)];return i&&c.push(this._updateEntityMetadataVersionStamp(i)),-1!==s&&this.updateApplicationMetadataVersionStamps({"":s}),Object(_.a)(c).then(e=>{const n=e[0];t.resolve(n)},e=>{t.reject(e)}),t}_GetLegacyFormSubtype(e){let t=0;if(!Object(f.a)(e))switch(e.toLowerCase()){case"appointmentbook":t=pe.a.appointment;break;case"hardcoded":t=pe.a.hardcoded;break;case"main":t=pe.a.main;break;case"minicampaignbo":t=pe.a.miniCampaignBO;break;case"preview":t=pe.a.preview;break;case"dashboard":t=pe.a.dashboard;break;case"quick":t=pe.a.quick;break;case"mobile":t=pe.a.mobile;break;case"read":t=pe.a.read;break;case"quickcreate":t=pe.a.quickCreate;break;case"dialog":t=pe.a.dialog;break;case"card":t=pe.a.card;break;case"taskbasedform":t=pe.a.taskBased;break;case"interactioncentricdashboard":t=pe.a.interactionCentricDashboard;break;default:t=0}return t}_GetLegacyMetadataTypeForQuery(e,t,n){switch(e){case"form":return n.val=this._GetLegacyFormSubtype(t),g.a.form;case"workspace":case"systemworkspace":case"userworkspace":return n.val=pe.a.dashboard,g.a.workspace;case"formselector":return n.val=this._GetLegacyFormSubtype(t),g.a.formSelector;case"bpfselector":return n.val=pe.a.none,g.a.bpfSelector;case"dashboardselector":return n.val=pe.a.dashboard,g.a.dashboardSelector;case"search":return n.val=0,g.a.searchConfiguration;case"customcontrol":return n.val=0,g.a.customControl;case"resourcestring":return n.val=0,g.a.resourceString;case"visualizationselector":return n.val=0,g.a.visualizationSelector;case"savedvisualization":return n.val=0,g.a.savedQueryVisualization;case"uservisualization":return n.val=0,g.a.userQueryVisualization;case"label":return n.val=0,g.a.label;case"displaystring":return n.val=0,g.a.displayString;case"webresource":return n.val=this._GetLegacyWebResourceSubtype(t),g.a.webResource;case"webresourcedescriptor":return n.val=0,g.a.webResourceDescriptor;case"customcontroldefaultconfig":return n.val=0,g.a.homePageConfiguration;case"optionset":return n.val=0,g.a.optionSet;case"quickcreatemenu":return n.val=0,g.a.quickCreateMenu;case"businessprocessflow":return n.val=0,g.a.businessProcessFlow;case"dialog":return n.val=0,g.a.dialog;case"taskbasedflow":return n.val=0,g.a.taskBasedFlow;case"taskbasedflowglobalmenu":return n.val=0,g.a.taskBasedFlowGlobalMenu;case"sitemap":return n.val=0,g.a.siteMap;case"viewselector":return n.val=this._GetLegacyViewSubtype(t),g.a.viewSelector;case"savedview":return n.val=this._GetLegacyViewSubtype(t),g.a.savedView;case"userview":return n.val=this._GetLegacyViewSubtype(t),g.a.userView;case"ribbon":return n.val=0,g.a.command;case"appmodules":return n.val=0,g.a.appModule;case"appmoduleselector":return n.val=0,g.a.appModuleSelector;case"metadataversion":return n.val=0,g.a.overallMetadataVersion;case"complexcontrol":return n.val=0,g.a.complexControl;case"isactivityflags":return n.val=0,g.a.isActivityFlags;case"appmoduleofflinemetadata":return n.val=0,g.a.appModuleOfflineMetadata;default:return n.val=0,0}}_GetLegacyViewSubtype(e){let t=0;if(!Object(f.a)(e))switch(e.toUpperCase()){case"MAIN_APPLICATION_VIEW":t=pe.a.main;break;case"ADVANCED_SEARCH":t=pe.a.advancedSearch;break;case"SUB_GRID":t=pe.a.subGrid;break;case"QUICKFIND_SEARCH":t=pe.a.quickFindSearch;break;case"REPORTING":t=pe.a.reporting;break;case"OFFLINE_FILTERS":t=pe.a.offlineFilters;break;case"MA_SEARCH":t=pe.a.maSearch;break;case"LOOKUP_VIEW":t=pe.a.lookup;break;case"SM_APPOINTMENTBOOK_VIEW":t=pe.a.smAppointmentBook;break;case"OUTLOOK_FILTERS":t=pe.a.outlookFilters;break;case"ADDRESSBOOK_FILTERS":t=pe.a.addressbookFilters;break;case"SAVEDQUERYTYPE_OTHER":t=pe.a.savedQueryTypeOther;break;case"INTERACTIVE_WORKFLOW_VIEW":t=pe.a.interactiveWorkFlow;break;case"OFFLINE_TEMPLATE":t=pe.a.offlineTemplate;break;case"OUTLOOK_TEMPLATE":t=pe.a.outlookTemplate;break;case"CUSTOM_DEFINED_VIEW":t=pe.a.customDefined;break;default:t=0}return t}_GetLegacyWebResourceSubtype(e){let t=0;if(!Object(f.a)(e))switch(e.toUpperCase()){case"HTML":t=10;break;case"CSS":t=6;break;case"JSCRIPT":t=5;break;case"XML":t=11;break;case"PNG":t=7;break;case"JPG":t=8;break;case"RESX":t=12;break;case"GIF":case"SILVERLIGHT":case"XSL":case"ICO":default:t=0}return t}_ConvertMetadataToApplicationMetadata(e,t,n,r,a,i,o){const s={};return s[je.a]=a,s[je.k]=o,s[je.j]=t,s[je.i]=n,s[je.f]=ue.a.Desktop,s[je.c]=e,s[je.g]=i,s[je.b]=r,s[je.h]=!1,new we.a(s)}_ConvertToAttributeMetadata(e){const t=[];for(const n of e)t.push(Pe.a.createFromODataResponse(n));return t}getRecentItems(e,t,n,r,a,i,o){return(new re.a).reject(d.a.fromErrorCode(-2147093999))}get_localStore(){return this._localStore}get_offlineDataStore(){return this._offlineDataStore}set_offlineDataStore(e){return this._offlineDataStore=e,e}nullifyStores(){const e=new re.a;let t;return this._localStore instanceof kn&&this._sessionStateStore instanceof kn?e.resolve():(t=this._NullifyLocalStore(),t.then(t=>{this._sessionStateStore=this.get_localStore(),e.resolve()},t=>{Object(u.e)("ClientBrowserDataSource_NullifyStores",k.a.storage,"Nullify Store failed"),e.reject(t)})),e}initialize(e){const t=new re.a,n=new $e;if(e)this._localStore instanceof kn&&(Object(f.a)(this._sessionStateStore)||this._sessionStateStore instanceof kn?(Object(u.e)("ClientBrowserStore_Initialize",k.a.storage,"init localStore and sessionStateStore"),this._localStore=new Dn(this._serverUri),this._sessionStateStore=this._localStore):(Object(u.e)("ClientBrowserStore_Initialize",k.a.storage,"init localStore"),this._localStore=this._sessionStateStore)),this._InstallOrNullify(this.get_localStore(),n,Re.both,t);else{let e=(new re.a).resolve(null);this._wasInitializedWithLocalStore&&!m.a.getInstance().get_PALEnabled()&&(Object(u.e)("ClientBrowserStore_Initialize:cleanupMetadatataPromise",k.a.storage,"create promise for ClearAllMetadataStores"+this._serverUri),e=this.clearAllMetadataStores(!1,!0)),e.then(e=>{Object(f.a)(this._localStore)||this._localStore instanceof kn?(this._sessionStateStore=new Dn(this._serverUri),Object(u.e)("ClientBrowserStore_Initialize:cleanupMetadatataPromise",k.a.storage,"init sessionStateStore this._serverUri = "+this._serverUri)):(this._sessionStateStore=this._localStore,Object(u.e)("ClientBrowserStore_Initialize:cleanupMetadatataPromise",k.a.storage,"init sessionStateStore with localStore"));const r=[this._InstallOrNullify(this._sessionStateStore,n,Re.session),this._NullifyLocalStore()];Object(_.a)(r).then(e=>{t.resolve()},e=>{t.reject(e)})},e=>{Object(u.b)("ClientBrowserStore_Initialize:cleanupMetadatataPromise",k.a.storage,"cleanup metadata failed with error: "+e.get_Message()),t.reject(e)})}return t}_InstallOrNullify(e,t,n,r){let a=!0;return Object(f.a)(r)&&(a=!1,r=new re.a),e.install(t).then(e=>{this._wasInitializedWithLocalStore=a,r.resolve()},e=>{Object(u.e)("ClientBrowserStore_InstallOrNullify:store.Install",k.a.storage,"failed :nullifyStore storetype = "+Re[n]);let t=(new re.a).resolve(null);t=n===Re.session?this._NullifySessionStore():this._NullifyLocalStore(),t.then(e=>{n===Re.both&&(this._sessionStateStore=this.get_localStore()),r.resolve()},e=>{Object(u.e)("ClientBrowserStore_InstallOrNullify:store.Install",k.a.storage,"Nullify Store failed : storetype = "+Re[n]),r.reject(e)})}),r}upgrade(){const e=new re.a;return this.get_localStore().upgrade().then(t=>{e.resolve(t)},t=>{e.reject(t)}),e}pullPersonalizations(){const e=new re.a;return this.get_localStore().pullPersonalizations().then(t=>{e.resolve(t)},t=>{e.reject(t)}),e}pushPersonalizations(e){const t=new re.a;return this.get_localStore().pushPersonalizations(e).then(e=>{t.resolve(e)},e=>{t.reject(e)}),t}initializeOfflineComponents(e){return this.get_offlineDataStore().initialize(e,this._parentDataSource.get_EventManager(),this,null)}_getNetworkAvailability(){return this._parentDataSource.get_IsServerAvailable()}retrieveDataFromOfflineStore(e){const t=new re.a;return this.get_localStore().retrieve(e,$e.offlineDatabaseInformationStore,null).then(e=>{t.resolve(e)},e=>{t.reject(e)}),t}clearAllMetadataStores(e,t){return this._WriteOperation(n=>{const r=this.get_localStore().get_localStoreSchema().get_metadataStoreNames(),a=[];for(const n of r)n===$e.sessionStateStore.toLowerCase()?!Object(f.a)(t)&&t||a.push(this._sessionStateStore.flushAll(n,null)):!Object(f.a)(e)&&e&&n===$e.userContextStore.toLowerCase()||a.push(this.get_localStore().flushAll(n,null));return Object(_.a)(a).then(()=>{n.resolve(r)},e=>{e.get_Message().indexOf("does not exist")>0?n.resolve(r):n.reject(e)}),n})}clearEntityAttributeApplicationMetadataStores(){return this._WriteOperation(e=>{const t=[$e.entityMetadataStore,$e.attributeMetadataStore,$e.applicationMetadataStore],n=t.map(e=>this.get_localStore().flushAll(e,null));return Object(_.a)(n).then(()=>{e.resolve(t)},t=>{e.reject(t)}),e})}clearAllDataStores(){return this._WriteOperation(e=>{const t=this.get_localStore().get_localStoreSchema().get_dataStoreNames(),n=[];K.a.get_instance().isOfflineDataSourceInitialized()&&!Object(f.a)(this.get_offlineDataStore())&&n.push(this.get_offlineDataStore().flushAll(this._parentDataSource.get_UserContext()));for(const e of t)n.push(this.get_localStore().flushAll(e,null));return Object(_.a)(n).then(()=>{e.resolve(t)},t=>{e.reject(t)}),e})}UpdateUserContext(e){return this._WriteOperation(t=>(e?this.get_localStore().add(Un._UserContextKey,e.getObjectData(),$e.userContextStore,null).then(()=>{t.resolve(!0)},e=>{Object(u.b)("ClientBrowserDataSource:UpdateUserContext",k.a.storage,e.get_Message()),t.reject(e)}):this.get_localStore().flush(Un._UserContextKey,$e.userContextStore,null).then(()=>{t.resolve(!0)},e=>{t.reject(e)}),t))}retrieveUserContext(){const e=new re.a;return this.get_localStore().retrieve(Un._UserContextKey,$e.userContextStore,null).then(Un._RetrieveSuccessForUserContext(e,ne.a.createFromObjectData),Un._RetrieveFailure(e,Un._UserContextKey)),e}cache(e,t){K.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.get_identifier().LogicalName)?M.a.schedule(()=>{this.get_offlineDataStore().cache(e,t)},B,"ClientBrowserDataSource.Cache.WriteToOfflineDataStore"):M.a.schedule(()=>{this._CreateInternal(e,t)},B,"ClientBrowserDataSource.Cache.WriteToCache")}cacheMultiple(e,t,n){K.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.get_EntityLogicalName())||M.a.schedule(()=>{this._createMultiple(e,t,n)},B,"ClientBrowserDataSource.CacheMultiple.WriteToCache")}uncache(e,t){K.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.LogicalName)||M.a.schedule(()=>{this.Delete(e,t)},B,"ClientBrowserDataSource.Uncache.DeleteFromCache")}create(e,t,n){const r=new re.a;return K.a.get_instance().get_offlineDataSource().isOfflineOptedIn()?K.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.get_identifier().LogicalName)?(this.get_offlineDataStore().create(e,t,n).then(e=>{r.resolve(e)},e=>{r.reject(e)}),r):r.reject(d.a.fromErrorCode(-2147093996)):(this._CreateInternal(e,n).then(e=>{r.resolve(e)},e=>{r.reject(e)}),r)}_createMultiple(e,t,n){return this._WriteOperation(r=>{const a=e.get_key();return this.get_localStore().transaction([$e.entityRecordStore,$e.listStore],e=>{e.set_result(a),e.retrieveMultipleByQuery(new _e.a(new fe.a(new ge.a(Rn.queryPath),a),null),$e.listStore,n).done(a=>{if(Object(f.a)(a)||!a.get_results().length){const a=new Rn(t);e.add(null,a.getObjectData(),$e.listStore,n).done(a=>{const i=[];for(let r=0;r<t.get_count();r++)i.push(this._MergeAndSaveEntity(e,t.get_item(r),n));Object(_.a)(i).then(e=>{},e=>{r.reject(e)})})}else{const i=Rn.createFromObjectData(a.get_results()[0].get_key(),a.get_results()[0].get_value());i.update(t),e.add(i.get_indexId(),i.getObjectData(),$e.listStore,n).done(()=>{const a=[];for(let r=0;r<t.get_count();r++)a.push(this._MergeAndSaveEntity(e,t.get_item(r),n));Object(_.a)(a).then(()=>{},e=>{r.reject(e)})})}})}).then(e=>{r.resolve(e)},e=>{r.reject(e)}),r},t.get_clientRetrieveOptions(),n)}retrieveRelatedEntities(e,t,n,a,i,o,s,c){const l=e.toString(),u=new re.a;return K.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.LogicalName)?(this.get_offlineDataStore().retrieve(e,t,i,o,s).then(t=>{t?Object(f.a)(a)?K.a.get_instance().get_offlineDataSource().refreshLookupData(e,t,i,o).then(e=>{u.resolve(e)},()=>{u.resolve(t)}):this._RetrieveRelatedEntitiesForRecord(t,a,i,o).then(t=>{K.a.get_instance().get_offlineDataSource().refreshLookupData(e,t,i,o).then(e=>{u.resolve(e)},()=>{u.resolve(t)})},e=>{u.reject(e)}):u.reject(d.a.FromMessage("Not in offline store with key '{0}'",l))},Un._OfflineRetrieveFailure(u,l)),u):(this._batchedCallbackRunner.queueCallback(()=>{this.get_localStore().retrieve(l,$e.entityRecordStore,o).then(e=>{if(e){const t=r.a.createFromObjectData(e);Object(f.a)(a)?u.resolve(t):this._RetrieveRelatedEntitiesForRecord(t,a,i,o).then(e=>{u.resolve(t)},e=>{u.reject(e)})}else K.a.get_instance().get_offlineDataSource().isOfflineFeatureEnabledForOrganization()?u.reject(d.a.fromErrorCode(-2147093987,l)):u.reject(d.a.FromMessage("Not in local store with key '{0}'",l))},Un._RetrieveFailure(u,l))},o),u)}retrieveMultiple(e,t,n){const a=new re.a;if(K.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.get_EntityLogicalName()))return this._batchedCallbackRunner.queueCallback(()=>{this.get_offlineDataStore().retrieveMultiple(e,t,n).then(r=>{r?K.a.get_instance().get_offlineDataSource().refreshRetrieveMultipleLookupData(r,t,n).always(e=>{a.resolve(e)}):a.reject(d.a.FromMessage("Not in offline store with key '{0}'",e.get_PublicKey()))},Un._OfflineRetrieveFailure(a,e.get_key()))},n),a;const o=e.get_key();return this._batchedCallbackRunner.queueCallback(()=>{this.get_localStore().readOnlyTransaction([$e.listStore,$e.entityRecordStore],t=>{t.retrieveMultipleByQuery(new _e.a(new fe.a(new ge.a(Rn.queryPath),o),null),$e.listStore,n).done(a=>{if(!Object(f.a)(a)&&a.get_results().length>0){const o=Rn.createFromObjectData(a.get_results()[0].get_key(),a.get_results()[0].get_value());if(o.get_entityIndex().length>0){const a=[];for(const e of o.get_entityIndex()){const r=new i.a(o.get_logicalName(),e);a.push(t.retrieve(r.toString(),$e.entityRecordStore,n))}(new Ie).waitForArray(a).done(n=>{const a=[];for(let e=0;e<n.length;e++)Object(f.a)(n[e])||a.push(r.a.createFromObjectData(n[e]));const i=new Ne.a(a,o.get_moreRecords(),o.get_totalRecordCount(),!1,e,o.get_clientRetrieveOptions());t.set_result(i)})}else{const n=new Ne.a(new Array(0),!1,0,!1,e,o.get_clientRetrieveOptions());t.set_result(n)}}})}).then(e=>{e?a.resolve(e):K.a.get_instance().get_offlineDataSource().isOfflineFeatureEnabledForOrganization()?a.reject(d.a.fromErrorCode(-2147093987,o)):a.reject(d.a.FromMessage("Not in local store with key '{0}'",o))},e=>{a.reject(d.a.fromErrorCodeAndMessage(-2147015599,String.format("Local store failed with error: '{0}' while trying to retrieve with key '{1}'",e.get_Message(),o)))})},n),a}retrieveEntitiesForAggregateQuery(e,t,n){throw Error.notImplemented("RetrieveEntitiesForAggregateQuery")}update(e,t,n,r){if(K.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.LogicalName))return this.get_offlineDataStore().update(e,t,n,r).catch(e=>{Object(u.d)("DataSource_Update_LocalError",k.a.storage,e.get_Message())});return(new re.a).reject(d.a.fromErrorCode(-2147093999))}Delete(e,t){if(e.get_identifier()===p.a.get_empty().toString())throw Error.argumentType("Record has an empty identifier. Cannot be deleted from Delete implementation in Local Store");if(K.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.LogicalName))return this._WriteOperation(n=>(this.get_offlineDataStore().Delete(e,t,this._getNetworkAvailability()).then(t=>{n.resolve(e)},t=>{n.reject(d.a.FromMessage("Offline store failed with error: '{0}' while trying to delete with key '{1}'",t.get_Message(),e.toString()))}),n));if(K.a.get_instance().get_offlineDataSource().isOfflineOptedIn()&&!this._getNetworkAvailability()){return(new re.a).reject(d.a.fromErrorCode(-2147093999))}return this._WriteOperation(n=>{const r=e.toString();return this.get_localStore().flush(r,$e.entityRecordStore,t).then(()=>{n.resolve(e)},e=>{n.reject(d.a.FromMessage("Local store failed with error: '{0}' while trying to delete with key '{1}'",e.get_Message(),r))}),n})}_OfflineExecuteMultipleRequestValidation(e){for(const t of e.get_requests()){if(t instanceof Ve.a)continue;const e=t instanceof Ue.a||t instanceof Ge.a?t.get_target():null;if(Object(f.a)(e)||!K.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.get_identifier().LogicalName))return!1}return!0}_OfflineGetClientMetadataExecuteMultipleRequestValidation(e){for(const t of e.get_requests())if(!(t instanceof We))return!1;return!0}_OfflineExecuteQuickFindValidation(e){const t=e;return!!(t&&t.get_entityNames()&&t.get_entityNames().length>0)&&K.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(t.get_entityNames()[0])}execute(e,t){const n=new re.a;if(e instanceof Q.a&&this._OfflineExecuteMultipleRequestValidation(e)||e instanceof Ue.a&&K.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.get_target().get_identifier().LogicalName)||e instanceof Ge.a&&K.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.get_target().get_identifier().LogicalName)||e instanceof ze.a&&this._OfflineExecuteQuickFindValidation(e))return this.get_offlineDataStore().execute(e,t);if(e instanceof Q.a&&this._OfflineGetClientMetadataExecuteMultipleRequestValidation(e)){const t=[];for(const n of e.get_requests())if(n instanceof We){const e=n;t.push(this.getClientMetadata(e.get_clientMetadataQuery()))}return Object(_.a)(t).then(e=>{const t=new Array(0);for(let n=0;n<e.length;n++){const e=new Ke.a("GetClientMetadata");t.push(new Ae.a(null,n,e))}const r=new $.a(!1,t);n.resolve(r)},e=>{n.reject(e)}),n}let r;return r=K.a.get_instance().get_offlineDataSource().isOfflineOptedIn()?"You have opted in for offline mode, but either offline database is not available, or the entity is not available for offline. Therefore, the request is unable to be sent.":"You have not opted in for offline mode and the connection to the remote server has been lost. Therefore, the request is unable to be sent.",Object(u.d)("ClientBrowserDataSource.Execute",k.a.storage,r),n.reject(d.a.fromErrorCode(-2147093999))}executeOData(e,t){return(new re.a).reject(d.a.fromErrorCode(-2147093999))}_CreateMultipleEntityMetadata(e){return this._WriteOperation(t=>{const n=new Array(e.length),r=Object(Bn.d)(this._parentDataSource.get_Store().getState());for(let t=0;t<n.length;t++)n[t]=r?e[t].getStorableODataObject():e[t].getObjectData();return this.get_localStore().addMultiple(E.a.extractKey,n,$e.entityMetadataStore,null).then(e=>{t.resolve(e)},e=>{Object(u.b)("ClientBrowserDataSource:CreateMultipleEntityMetadata",k.a.storage,e.get_Message()),Un._CreateFailure(t)}),t})}retrieveEntityMetadata(e,t){const n=new re.a,r=e;return this.get_localStore().retrieveMultiple(E.a.logicalNamePath,r,$e.entityMetadataStore,t).then(e=>{e.length>0?n.resolve(E.a.createFromObjectData(e[0].get_value())):n.reject(d.a.fromLocalStoreError(-2147093987,"Not able to retrieve in local store with logicalname '{0}'",r))},Un._RetrieveFailure(n,r)),n}createMultipleAttributeMetadata(e){return this._WriteOperation(t=>{const n=[],r=Object(Bn.d)(this._parentDataSource.get_Store().getState());for(let t=0;t<e.length;t++)r?n.push(e[t].getStorableODataObject()):n.push(e[t].getObjectData());return this.get_localStore().addMultiple(Pe.a.extractKey,n,$e.attributeMetadataStore,null).then(e=>{t.resolve(e)},e=>{Object(u.b)("ClientBrowserDataSource:CreateMultipleAttributeMetadata",k.a.storage,e.get_Message()),t.reject(e)}),t})}retrieveMultipleAttributeMetadata(e,t){const n=new re.a;if(Object(f.a)(e.get_AttributeNames()))Object(F.j)(k.a.localDataSource,"Attempting to retrieve all attribute metadata for an entity from local store"),this.get_localStore().retrieveMultiple(Pe.a.entityLogicalNamePath,e.get_EntityLogicalName(),$e.attributeMetadataStore,t).then(t=>{if(t.length>0){const e=[];for(let n=0;n<t.length;n++)e.push(Pe.a.createFromObjectData(t[n].get_value()));n.resolve(e)}else n.reject(d.a.fromLocalStoreError(-2147093987,"Not in local store with key '{0}'",e.get_EntityLogicalName()))},Un._RetrieveFailure(n,e.get_EntityLogicalName()));else{const r=[],a=new Array(0);for(const t of e.get_AttributeNames()){const n=e.get_EntityLogicalName()+Fe.a+t,i=this._retrieveAttributeMetadataPromiseCache.get(n);i?r.push(i.getPromise()):a.push(t)}const i=new re.a;this.get_localStore().readOnlyTransaction([$e.attributeMetadataStore],n=>{for(const i of a){const a=e.get_EntityLogicalName()+Fe.a+i,o=this._RetrieveLocalAttributeMetadata(e.get_EntityLogicalName(),a,n,t);this._retrieveAttributeMetadataPromiseCache.put(a,new W.a(o,a,"RetrieveAttributeMetadata")),r.push(o)}}).then(()=>{i.resolve()},e=>{i.reject(e)}),i.then(()=>{Object(_.a)(r).then(e=>{const t=[];for(const n of e)n&&t.push(n);n.resolve(t)},t=>{const r=t instanceof d.a?t.get_Message():"[Unknown Error]";n.reject(d.a.fromLocalStoreError(-2147093987,"Local store failed with error: '{0}' while trying to retrieve with key '{1}'",r,e.toString()))})},t=>{n.reject(d.a.fromLocalStoreError(-2147093987,"Local store failed with error: '{0}' while trying to retrieve with key '{1}'",t.get_Message(),e.toString()))})}return n}_createMultipleApplicationMetadata(e){return this._WriteOperation(t=>{const n=new Array(e.length);for(let t=0;t<n.length;t++)n[t]=e[t].getObjectData();return this.get_localStore().addMultiple(we.a.extractKey,n,$e.applicationMetadataStore,null).then(e=>{t.resolve(e)},e=>{Object(u.b)("ClientBrowserDataSource:CreateMultipleApplicationMetadata",k.a.storage,e.get_Message()),Un._CreateFailure(t)}),t})}retrieveApplicationMetadata(e,t){const n=new re.a,r=e.toString();return this.get_localStore().retrieve(r,$e.applicationMetadataStore,t).then(Un._RetrieveSuccess(n,r,we.a.createFromObjectData),Un._RetrieveFailure(n,r)),n}retrieveMultipleApplicationMetadata(e,t){const n=new re.a;return this.get_localStore().retrieveMultiple(e.get_keyPath().get_path(),e.get_keyValue(),$e.applicationMetadataStore,t).then(t=>{const r=[];for(let n=0;n<t.length;n++){const a=we.a.createFromObjectData(t[n].get_value());e.checkApplicationMetadata(a)&&r.push(a)}n.resolve(r)},Un._RetrieveFailure(n,e.get_keyValue().toString())),n}_RetrieveMultipleApplicationMetadataByKeys(e,t,n){const r=new re.a,a=new he.a(e,t),i=new _e.a(a,[new ye(new ge.a(je.j),0)],0,t.length,n);return this.get_localStore().retrieveMultipleByQuery(i,$e.applicationMetadataStore,null).then(e=>{const t=[];for(let n=0;n<e.get_results().length;n++)t.push(we.a.createFromObjectData(e.get_results()[n].get_value()));r.resolve(t)},e=>{r.reject(e)}),r}createUserPersonalization(e){return this._WriteOperation(t=>(this.get_localStore().add(e.get_key(),e.getObjectData(),$e.userPersonalizationStore,null).then(e=>{t.resolve(e)},e=>{Object(u.b)("ClientBrowserDataSource:CreateUserPersonalization",k.a.storage,e.get_Message()),t.reject(e)}),t))}deleteUserPersonalization(e){return this._WriteOperation(t=>(this.get_localStore().flush(e,$e.userPersonalizationStore,null).then(e=>{t.resolve(e)},e=>{t.reject(e)}),t))}retrieveUserPersonalization(e){const t=new re.a;return this.get_localStore().retrieve(e,$e.userPersonalizationStore,null).then(Un._RetrieveSuccess(t,e,xe.a.createFromObjectData),Un._RetrieveFailure(t,e)),t}_updateEntityMetadataVersionStamp(e){return this._WriteOperation(t=>(this.get_localStore().add(Un.entityMetadataVersionStampKey,e,$e.metadataVersionStampStore,null).then(e=>{t.resolve(e)},e=>{Object(u.b)("ClientBrowserDataSource:UpdateEntityMetadataVersionStamp",k.a.storage,e.get_Message()),t.reject(e)}),t))}retrieveEntityMetadataVersionStamp(){const e=new re.a;return this.get_localStore().retrieve(Un.entityMetadataVersionStampKey,$e.metadataVersionStampStore,null).then(t=>{t?e.resolve(t.toString()):e.reject(d.a.FromMessage("Not able to retrieve in local store with key '{0}'",Un.entityMetadataVersionStampKey))},t=>{e.reject(d.a.FromMessage("Local store failed with error: '{0}' while trying to retrieve with key '{1}'",t.get_Message(),Un.entityMetadataVersionStampKey))}),e}updateApplicationMetadataVersionStamps(e){return this._WriteOperation(t=>{const n=[];for(const t in e){const r={key:t,value:e[t]},a=r.value;Object(f.b)(r.key)?n.push(this.get_localStore().add(Un.applicationMetadataVersionStampKey,a,$e.metadataVersionStampStore,null)):n.push(this.get_localStore().add(String.format(Un._appModuleVersionStampKey,r.key),a,$e.metadataVersionStampStore,null))}return Object(_.a)(n).then(e=>{t.resolve(e)},e=>{Object(u.b)("ClientBrowserDataSource:UpdateApplicationMetadataVersionStamps",k.a.storage,e.get_Message()),t.reject(e)}),t})}retrieveApplicationMetadataVersionStamps(){const e=new re.a,t=new _e.a(new be.a(ge.a.get_id(),Un.entityMetadataVersionStampKey,0,Ce.a.lessThan),null);return this.get_localStore().retrieveMultipleByQuery(t,$e.metadataVersionStampStore,null).then(t=>{const n={},r=t.get_results();if(!Object(f.a)(r)&&r.length>0)for(const e of r){let t="";const r=e.get_key();if(r!==Un.applicationMetadataVersionStampKey){const n=r.split("_");!Object(f.a)(n)&&n.length>1?t=n[1]:Object(F.d)(k.a.localDataSource,"Can't parse AppMetadataVersionStampKey: "+e.get_key())}n[t]=e.get_value()}e.resolve(n)},t=>{e.reject(d.a.FromMessage("Local store failed with error: '{0}' while trying to retrieve with key '{1}'",t.get_Message(),Un.applicationMetadataVersionStampKey))}),e}_GetLocalStoreKey(e){return e.get_identifier().toString()}_MergeAndSaveEntity(e,t,n){const a=new re.a,i=this._GetLocalStoreKey(t),o=$e.entityRecordStore;return e.retrieve(i,o,n).done(s=>{let c=t;Object(f.a)(s)||(c=r.a.createFromObjectData(s),c.mergeChanges(t)),e.add(i,c.getObjectData(),o,n).done(e=>{a.resolve(e)})}),a}_WriteOperation(e,t,n){const r=new re.a;return this._AddNavigationData(t,n).then(()=>{const a=new re.a;e(a).then(e=>{r.resolve(e)},a=>{Un._IsQuotaError(a)?this._PurgeData(n).then(()=>{this._WriteOperation(e,t,n).then(e=>{r.resolve(e)},a=>{Object(l.b)()&&Un._IsQuotaError(a)?this._FallbackToNullifyOnWrite(e,t,n,r):r.reject(a)})},i=>{Object(l.b)()?this._FallbackToNullifyOnWrite(e,t,n,r):(i.chainError(a),r.reject(i))}):r.reject(a)})}),r}_AddNavigationData(e,t){const n=new re.a;return Object(f.a)(e)?n.resolve(null):Object(f.a)(this._addingNavigationDataDeferred)?(this._addingNavigationDataDeferred=n.then(e=>(this._addingNavigationDataDeferred=null,e),e=>(this._addingNavigationDataDeferred=null,e)),this.get_localStore().retrieveMultiple(O.a.timestampPath,e.get_sortableTimestamp(),$e.navigationDataStore,t).then(r=>{Object(f.a)(r)||!r.length?this.get_localStore().add(null,e.getObjectData(),$e.navigationDataStore,t).then(()=>{n.resolve(e)},r=>{Un._IsQuotaError(r)?this._PurgeData(t).then(()=>{this.get_localStore().add(null,e.getObjectData(),$e.navigationDataStore,t).then(()=>{n.resolve(e)},e=>{Object(u.b)("ClientBrowserDataSource:AddNavigationData:retryError",k.a.storage,e.get_Message()),n.reject(e)})},e=>{Object(u.b)("ClientBrowserDataSource:AddNavigationData:purgeError",k.a.storage,e.get_Message()),n.reject(e)}):(Object(u.b)("ClientBrowserDataSource:AddNavigationData:QuotaError",k.a.storage,r.get_Message()),n.reject(r))}):n.resolve(e)},e=>{Object(u.b)("ClientBrowserDataSource:AddNavigationData:RetrieveMultiple error",k.a.storage,e.get_Message()),n.reject(e)})):this._addingNavigationDataDeferred.then(r=>{e.get_sortableTimestamp()!==r.get_sortableTimestamp()?this._AddNavigationData(e,t).then(()=>{n.resolve(e)},e=>{Object(u.b)("ClientBrowserDataSource:AddNavigationData:addingNavigationDataDeferred:AddNavigationData error",k.a.storage,e.get_Message()),n.reject(e)}):n.resolve(r)},e=>{Object(u.b)("ClientBrowserDataSource:AddNavigationData:addingNavigationDataDeferred error",k.a.storage,e.get_Message()),n.reject(e)}),n}_PurgeData(e){return Object(f.a)(this._purgingDeferred)?(this._purgingDeferred=new re.a,this._purgingDeferred.always(()=>{this._purgingDeferred=null}),this.get_localStore().transaction([$e.navigationDataStore,$e.entityRecordStore,$e.listStore],t=>{t.retrieveMultipleByQuery(new _e.a(null,[new ye(new ge.a(O.a.timestampPath),0)]),$e.navigationDataStore,e).done(n=>{const r=n.get_results();if(!Object(f.a)(r)&&r.length>0){const n=r.length>5?4:r.length-1,a=O.a.createFromObjectData(r[n].get_value()),i=new _e.a(new me.a(new ge.a(O.a.embeddedPriorityTimestampPath),"0|9","1|"+a.get_sortableTimestamp(),Oe.a.openLeft),null),o=[t.flushByQuery(i,$e.entityRecordStore,e),t.flushByQuery(i,$e.listStore,e)];(new Ie).waitForArray(o).done(i=>{if(Object(f.a)(i)||i.length<2||!(i[0]instanceof Number)||!(i[1]instanceof Number)||i[0]+i[1]<=0){let i=a.get_timestamp(),o=-1,s=!1;for(let e=0;e<r.length;e++){const t=O.a.createFromObjectData(r[e].get_value());if(!t.get_cachePriority()){if(!(e<n)){s=!0;break}i=t.get_timestamp(),o=e}}const c=[];if(!s&&!o&&r.length>0){const a=new Array(n-1);for(let e=1;e<n;e++)a[e-1]=r[e].get_key();c.push(t.flushMultiple(a,$e.navigationDataStore,e))}else{let l,u,d;s||-1===o?(u=a.get_timestamp(),l=0,d=n):(u=i,l=Se.a.closed,d=o-1);const p=new _e.a(new be.a(new ge.a(O.a.embeddedPriorityTimestampPath),O.a.priorityTimestampKey(0,u),l,Ce.a.lessThan),null),g=new Array(d);for(let e=0;e<d;e++)g[e]=r[e].get_key();c.push(t.flushByQuery(p,$e.entityRecordStore,e)),c.push(t.flushByQuery(p,$e.listStore,e)),c.push(t.flushMultiple(g,$e.navigationDataStore,e))}(new Ie).waitForArray(c).done(e=>{let n=!0;for(const t of e)if("number"==typeof t&&t>0){n=!1;break}n&&t.set_result(d.a.FromMessage("At default frame, no more frames to purge"))})}})}else t.set_result(d.a.FromMessage("No frames to purge"))})}).then(e=>{e instanceof d.a?this._purgingDeferred.reject(d.a.fromErrorCodeAndMessage(-2147015599,String.format("Local store failed with error: '{0}' while trying to purge data",e.get_Message()))):this._purgingDeferred.resolve(null)},e=>{this._purgingDeferred.reject(d.a.fromErrorCodeAndMessage(-2147015599,String.format("Local store failed with error: '{0}' while trying to purge data",e.get_Message())))}),this._purgingDeferred):this._purgingDeferred}_NullifyLocalStore(){return Object(F.j)(k.a.localDataSource,"NullifyLocalStore: Nullifying local store..."),this._localStore=new kn,this.get_localStore().install(new $e)}_NullifySessionStore(){return Object(F.j)(k.a.localDataSource,"NullifySessionStore:Nullifying session State Store"),this._sessionStateStore=new kn,this._sessionStateStore.install(new $e)}_FallbackToNullifyOnWrite(e,t,n,r){Object(F.f)(k.a.localDataSource,"Quota Error Handled after purging and retry. Nullifying database..."),this._NullifyLocalStore().then(()=>{e(r)},e=>{r.reject(e)})}_RetrieveLocalAttributeMetadata(e,t,n,r){const a=new re.a,i=new _e.a(new fe.a(new ge.a(Pe.a.entityAttributeLogicalNamesPath),t),null);return n.retrieveMultipleByQuery(i,$e.attributeMetadataStore,r).done(t=>{const n=t.get_results();let r=null;if(n.length>0)for(let t=0;t<n.length;t++){const a=Pe.a.createFromObjectData(n[t].get_value());if(a.get_entityLogicalName()===e){r=a;break}}a.resolve(r)}),a}_RetrieveMultipleRelatedEntitiesForRecord(e,t,n,r){if(K.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.get_identifier().LogicalName)){const e=new re.a;return this.retrieveMultiple(t,n,r).then(t=>{e.resolve(t)},r=>{-2147093987===r.get_ErrorCode()?e.resolve(new Ne.a(new Array(0),!1,0,!1,t,n)):e.reject(r)}),e}return this.retrieveMultiple(t,n,r)}_CreateInternal(e,t){return this._WriteOperation(n=>(this.get_localStore().transaction([$e.entityRecordStore],r=>{if(this._MergeAndSaveEntity(r,e,t),e.get_relatedEntities().get_entityCollections().length>0){const r=[];for(const n of e.get_relatedEntities().get_entityCollections())n.get_value().get_query()instanceof ke.a&&r.push(this._createMultiple(n.get_value().get_query(),n.get_value(),t));Object(_.a)(r).then(e=>{},e=>{n.reject(e)})}}).then(()=>{n.resolve(e.get_identifier())},e=>{n.reject(e)}),n),e.get_clientRetrieveOptions(),t)}_RetrieveRelatedEntitiesForRecord(e,t,n,r){const a=new re.a,i=[],o=[];return Object(f.a)(t)||(!this._getNetworkAvailability()&&K.a.get_instance().get_offlineDataSource().isOfflineAvailableForUse()&&o.push(Object(Me.b)(t,e.get_identifier())),Object(_.a)(o).then(o=>{let s=null;o.length&&(s=o[0]);for(const a of t){const t=new Be.a(a.get_key(),e.get_identifier(),a.get_value());Object(f.a)(s)||Object(f.a)(s[a.get_key().get_schemaName()])||t.get_DescriptorSet().updateDescriptorSet(Te.a.Sql,s[a.get_key().get_schemaName()]),i.push(this._RetrieveMultipleRelatedEntitiesForRecord(e,t,n,r))}Object(_.a)(i).then(t=>{for(const n of t){const t=n,r=t.get_query().get_relationship();e.get_relatedEntities().addRelationship(r,t)}a.resolve(e)},e=>{a.reject(e)})},e=>{a.reject(e)})),a}saveSessionState(e,t,n){return this._WriteOperation(r=>{if(n)this._sessionStateStore.retrieve(e,$e.sessionStateStore,null).then(a=>{let i;Object(f.a)(a)?i=new De(e,t):(i=De.createFromObjectData(a),i.Merge(t)),this._sessionStateStore.add(i.get_key(),i.getObjectData(),$e.sessionStateStore,null).then(e=>{r.resolve(e)},t=>{Object(u.b)("ClientBrowserDataSource:SaveSessionState - Add, mergeState = "+n+" key = "+e,k.a.storage,t.get_Message()),r.reject(t)})},t=>{Object(u.b)("ClientBrowserDataSource:SaveSessionState - Retrieve, mergeState = "+n+" key = "+e,k.a.storage,t.get_Message()),r.reject(t)});else{const a=new De(e,t);this._sessionStateStore.add(a.get_key(),a.getObjectData(),$e.sessionStateStore,null).then(e=>{r.resolve(e)},t=>{Object(u.b)("ClientBrowserDataSource:SaveSessionState - Add, mergeState = "+n+" key = "+e,k.a.storage,t.get_Message()),r.reject(t)})}return r})}retrieveSessionState(e){const t=new re.a;return this._sessionStateStore.retrieve(e,$e.sessionStateStore,null).then(e=>{if(Object(f.a)(e))Object(u.e)("ClientBrowserDataSource:RetrieveSessionState - Retrieve",k.a.storage,"Resolve the result"),t.resolve(null);else{const n=De.createFromObjectData(e);t.resolve(n.get_stateData())}},n=>{Object(u.b)("ClientBrowserDataSource:RetrieveSessionState - Retrieve",k.a.storage,n.get_Message()+":key = "+e),t.reject(n)}),t}deleteSessionState(e){const t=new re.a;return this._sessionStateStore.flush(e,$e.sessionStateStore,null).then(e=>{t.resolve(e)},e=>{t.reject(e)}),t}static _CreateFailure(e){return t=>{e.reject(t)}}static _RetrieveSuccess(e,t,n){return r=>{r?e.resolve(n(r)):e.reject(d.a.fromLocalStoreError(-2147093987,"Not in local store with key '{0}'",t))}}static _RetrieveSuccessForUserContext(e,t){return n=>{if(n)try{e.resolve(t(n))}catch(t){Object(u.e)("RetrieveSuccessForUserContext",k.a.dataSource,"RetrieveUserContext threw exception trying to create the object data, resolving with null. Message:"+t.message),e.resolve(null)}else e.resolve(null)}}static _OfflineRetrieveFailure(e,t){return n=>{e.reject(d.a.FromMessage("Offline store failed with error: '{0}' while trying to retrieve with key '{1}'",n.get_Message(),t))}}static _RetrieveFailure(e,t){return n=>{e.reject(d.a.fromLocalStoreError(-2147093987,"Local store failed with error: '{0}' while trying to retrieve with key '{1}'",n.get_Message(),t))}}static _IsQuotaError(e){return e.get_ErrorSource()===le.a.LocalStore&&e.get_ErrorCode()===ce.quotaError}}Un.entityMetadataVersionStampKey="entitymetadataversionstamp",Un.applicationMetadataVersionStampKey="applicationmetadataversionstamp",Un._appModuleVersionStampKey="appmodule_{0}_versionstamp",Un._UserContextKey="contextkey",Un._EntityDefinitionsType="entitydefinitionstype";var Vn=n("a8hT"),zn=n("f07+"),Wn=n("odYE");class qn{constructor(e,t,n){this._serverUri=null,this._remoteCallRetryHandler=null,this._eventManager=null,this._localDataSource=null,this._remoteDataSource=null,this._webAPIService=null,this._metadataCache=null,this._store=null,this._applicationStatusProvider=null,this._getClientMetadataQueryPromiseCache=null,this._retrievePromiseCache=null,this._retrieveMultiplePromiseCache=null,this._retrieveApplicationMetadataPromiseCache=null,this._userContext=null,this._versionStampFromLocalStore=null,this._appModuleVersionStamps=null,Object(b.d)(e,"serverUri"),this._serverUri=e,this._remoteCallRetryHandler=t,this._retrievePromiseCache=new G,this._retrieveMultiplePromiseCache=new G,this._getClientMetadataQueryPromiseCache=new z.a,this._retrieveApplicationMetadataPromiseCache=new z.a,this._eventManager=new V,this._store=n}get_isAvailable(){return this.get_remoteDataSource().get_isAvailable()||this.get_LocalDataSource().get_isAvailable()}set_isAvailable(e){return e}get_IsLocalDataSourceAvailable(){return this.get_LocalDataSource().get_isAvailable()}set_IsLocalDataSourceAvailable(e){return this.get_LocalDataSource().set_isAvailable(e),e}get_IsLocalDataSourceAvailableOffline(){return this.get_LocalDataSource().get_IsAvailableOffline()}get_Store(){return this._store}get_IsNetworkAvailable(){return this.get_remoteDataSource().get_isNetworkAvailable()}get_IsWaitingForNetwork(){return this.get_remoteDataSource().get_isWaitingForNetwork()}get_WaitingForNetworkPromise(){return this.get_remoteDataSource().get_waitingForNetworkPromise()}get_EventManager(){return this._eventManager}get_UserContext(){if(!this.isUserContextInitialized())throw Error.invalidOperation("UserContext is not initialized");return this._userContext}set_UserContext(e){return this._userContext=e,e}get_MetadataCache(){return this._metadataCache}set_MetadataCache(e){this._metadataCache=e}get_ApplicationStatusProvider(){return this._applicationStatusProvider}set_ApplicationStatusProvider(e){this._applicationStatusProvider=e}get_ServerUri(){return this._serverUri}get_RemoteCallRetryHandler(){return this._remoteCallRetryHandler}get_IsServerAvailable(){return this.get_remoteDataSource().get_isAvailable()}set_IsServerAvailable(e){return this.get_remoteDataSource().set_isAvailable(e),e}get_LocalDataSource(){return this._localDataSource}_set_LocalDataSource(e){this._localDataSource=e}get_appModuleVersionStamps(){return Object(f.a)(this._appModuleVersionStamps)?{}:this._appModuleVersionStamps}get_remoteDataSource(){return this._remoteDataSource}_set_remoteDataSource(e){return this._remoteDataSource=e,e}get_WebAPIService(){return this._webAPIService}set_WebAPIService(e){this.get_remoteDataSource().setWebAPIService(e),this._webAPIService=e}initialize(e){const t=ot.a.createEvent("Init","DataSource").startStopwatch();Object(u.c)("DataSource_Initialize_Start",k.a.storage,this.get_ServerUri());const n=new re.a;return n.always(()=>{t()}),m.a.getInstance().get_PALEnabled()?h.a.get_Instance().add_onReadyOrNow(()=>{this._InitializeLocalDataSource(e,n)}):this._InitializeLocalDataSource(e,n),n}_GetLocalDataSourceInitializationTimeOut(){return m.a.getInstance().get_isMailApp()?2e4:12e4}_CanNullifyStores(){return!!m.a.getInstance().get_isMailApp()||(!m.a.getInstance().get_PALEnabled()||!(m.a.getInstance().get_PALEnabled()&&K.a.get_instance().get_offlineDataSource().isOfflineFeatureEnabledForOrganization()&&K.a.get_instance().get_offlineDataSource().isAppAvailableOffline()))}_HandleLocalDataSourceInitializeError(e,t){this._CanNullifyStores()?this.get_LocalDataSource().nullifyStores().then(()=>{t.resolve(null)},n=>{Object(u.b)("DataSource_HandleLocalDataSourceInitializeError",k.a.storage,"Nullify store failed with message - "+n.get_Message());const r=d.a.fromErrorCodeAndMessage(-2147094e3,e);r.chainError(n),t.reject(r)}):(Object(u.b)("DataSource_HandleLocalDataSourceInitializeError",k.a.storage,e+" : Nullify store is not possible , fail with DataSourceInitializeFailedErrorCode"),t.reject(d.a.fromErrorCodeAndMessage(-2147094e3,e)))}_InitializeLocalDataSource(e,t){const n=this._GetLocalDataSourceInitializationTimeOut();let r=!1;const a=window.setTimeout(()=>{const e="LocalDataSource initialize timeout after "+n+" milliseconds.";Object(u.e)("DataSource_InitializeLocalDataSource_Initialize",k.a.storage,e),r=!0,this._HandleLocalDataSourceInitializeError(e,t)},n);this.get_LocalDataSource().initialize(e).then(()=>{if(r){window.clearTimeout(a);const r="LocalDataSource Initialize completed even after timeout of "+n+" milliseconds,  reinitialize the stores to null stores. cache mode = "+e;Object(u.e)("DataSource_InitializeLocalDataSource_Initialize",k.a.storage,r),this._HandleLocalDataSourceInitializeError(r,t)}else this.syncInitialData().then(e=>{window.clearTimeout(a),t.resolve(e)},e=>{if(window.clearTimeout(a),!r){Object(u.e)("DataSource_InitializeLocalDataSource_Initialize_SyncInitialData_Error",k.a.storage,e.get_Message());const n="LocalDataSource Initialize succeded but SyncInitialData failed with error message - "+e.get_Message();this._HandleLocalDataSourceInitializeError(n,t)}})},e=>{Object(u.e)("DataSource_InitializeLocalDataSource_Initialize_Error",k.a.storage,e.get_Message()),window.clearTimeout(a),this._HandleLocalDataSourceInitializeError("Local data source initialization failed with "+e.get_Message(),t)})}upgrade(){return this.get_LocalDataSource().upgrade()}pullPersonalizations(){return this.get_LocalDataSource().pullPersonalizations()}pushPersonalizations(e){return this.get_LocalDataSource().pushPersonalizations(e)}syncInitialData(){const e=new re.a;return this.get_LocalDataSource().retrieveUserContext().then(t=>{Object(f.a)(t)?e.resolve(null):Object(_.a)([this.initializeUIStrings(!0),this.get_LocalDataSource().retrieveApplicationMetadataVersionStamps(),this.get_LocalDataSource().getIsActivityFlags(),this.get_LocalDataSource().getInitialEntities()]).then(n=>{if(n.length>0){const[,r,a,i]=n,o=t;this.set_UserContext(o),this._UserContextLoaded(o),Object(f.a)(r)||(Object(f.a)(r[""])||(this._versionStampFromLocalStore=r[""],o.set_MetadataLastModifiedTime(this._versionStampFromLocalStore)),delete r[""],this._appModuleVersionStamps=r),e.resolve(o),Object(f.a)(a)||this.get_MetadataCache().cacheIsActivityFlags(a),Object(f.a)(i)||this.get_MetadataCache().cacheInitialEntities(i)}else e.resolve(null)},t=>{Object(u.e)("DataSource_SyncInitialData_Error",k.a.storage,"RetrieveUserContext failed in DeferredPromiseHelper bulk call"),e.reject(t)})},t=>{Object(u.e)("DataSource_SyncInitialData_Error",k.a.storage,"RetrieveUserContext failed"),e.reject(t)}),e}updateApplicationMetadataVersionStamps(e){return this.get_LocalDataSource().updateApplicationMetadataVersionStamps(e)}getClientMetadata(e,t,n){const r=new re.a,a=e.toString();let i=a;if(n){const e=n.RequestId();i=i+", ClientRequestId: "+e+", IsLocalStoreAvailable: "+(!!this.get_LocalDataSource()&&this.get_LocalDataSource().get_isAvailable()).toString(),n.AppendCallStack("DataSource.GetClientMetadata")}const o=this._getClientMetadataQueryPromiseCache.get(a);if(!Object(f.a)(o))return o.getPromise();if(this._getClientMetadataQueryPromiseCache.put(a,new W.a(r,i,"GetClientMetadata"),n),Object(Bn.d)(this._store.getState(),t,e))Object(Vn.b)().then(a=>{this._store.dispatch(a.getClientMetadata(e,n,t)).then(e=>{this.get_ApplicationStatusProvider().isOfflineSyncDone()?r.resolve(e):this.get_LocalDataSource().StoreApplicationMetadata(e).then(()=>{Object(u.e)("DataSource_GetClientMetadata_StoreApplicationMetadataSuccess",k.a.storage,"Offline sync not complete, updated application metadata stored locally in MDL GetClientMetadata, Query: "+i),r.resolve(e)},this._GetClientMetadataFailure(r,"DataSource_GetClientMetadata_StoreApplicationMetadataError",i))},e=>{Object(u.e)("DataSource_GetClientMetadata_Error",k.a.storage,"Error in MDL GetClientMetadata = "+e.get_Message()),r.reject(e)})});else if(t===j.a.LocalAndRemote)this.get_LocalDataSource().get_isAvailable()?this.get_LocalDataSource().getClientMetadata(e).then(a=>{this.get_remoteDataSource().get_isAvailable()&&this._HasMetadataVersionChanged(a)?this.get_remoteDataSource().getClientMetadata(e,t,n).then(e=>{this.get_ApplicationStatusProvider().isOfflineSyncDone()?r.resolve(e):this.get_LocalDataSource().StoreApplicationMetadata(e).then(()=>{Object(u.e)("DataSource_GetClientMetadata_StoreApplicationMetadataSuccess",k.a.storage,"Offline sync not complete, updated application metadata stored locally, Query: "+i),r.resolve(e)},this._GetClientMetadataFailure(r,"DataSource_GetClientMetadata_StoreApplicationMetadataError",i))},this._GetClientMetadataFailure(r,"DataSource_GetClientMetadata_RemoteError",i)):r.resolve(a)},a=>{if(this.get_remoteDataSource().get_isAvailable())Object(u.e)("DataSource_GetClientMetadata_Error",k.a.storage,"RemoteDataSource is available and error in LocalDataSource.GetClientMetadata, retrying with RemoteDataSource. LocalDataSource failure error message = "+a.get_Message()),this.get_remoteDataSource().getClientMetadata(e,t,n).then(e=>{this.get_ApplicationStatusProvider().isOfflineSyncDone()?r.resolve(e):this.get_LocalDataSource().StoreApplicationMetadata(e).then(()=>{Object(u.e)("DataSource_GetClientMetadata_StoreApplicationMetadataSuccess",k.a.storage,"Offline sync not complete, remote retrieved application metadata stored locally after local error, Query: "+i),r.resolve(e)},this._GetClientMetadataFailure(r,"DataSource_GetClientMetadata_StoreApplicationMetadataError",i))},this._GetClientMetadataFailure(r,"DataSource_GetClientMetadata_RemoteError",i));else{Object(u.e)("DataSource_GetClientMetadata_Error",k.a.storage,"RemoteDataSource is not available and error in LocalDataSource.GetClientMetadata, LocalDataSource failure error message = "+a.get_Message());const e=d.a.fromErrorCode(-2147093999);e.chainError(a),r.reject(e)}}):this.get_remoteDataSource().get_isAvailable()?this.get_remoteDataSource().getClientMetadata(e,t,n).then(this._RetrieveSuccess(r,"DataSource_GetClientMetadata_RemoteEnd",null),this._GetClientMetadataFailure(r,"DataSource_GetClientMetadata_RemoteError",i)):(Object(u.e)("DataSource_GetClientMetadata_Error",k.a.storage,"RemoteDataSource and LocalDataSource are not available so error in GetClientMetadata"),r.reject(d.a.fromErrorCode(-2147093999)));else if(t)this.get_remoteDataSource().get_isAvailable()&&t===j.a.Remote?this.get_remoteDataSource().getClientMetadata(e,t,n).then(e=>{this.get_LocalDataSource().get_isAvailable()&&!this.get_ApplicationStatusProvider().isOfflineSyncDone()?this.get_LocalDataSource().StoreApplicationMetadata(e).then(()=>{Object(u.e)("DataSource_GetClientMetadata_StoreApplicationMetadataSuccess",k.a.storage,"Offline sync not complete, remote retrieved application metadata stored locally, Query: "+i),r.resolve(e)},this._GetClientMetadataFailure(r,"DataSource_GetClientMetadata_StoreApplicationMetadataError",i)):r.resolve(e)},this._GetClientMetadataFailure(r,"DataSource_GetClientMetadata_RemoteError",i)):(Object(u.e)("DataSource_GetClientMetadata_Error",k.a.storage,"RemoteDataSource is not available and retrievalStrategy is remote, so error in GetClientMetadata"),r.reject(d.a.fromErrorCode(-2147093999)));else if(this.get_LocalDataSource().get_isAvailable())this.get_LocalDataSource().getClientMetadata(e).then(e=>{r.resolve(e)},this._GetClientMetadataFailure(r,"DataSource_GetClientMetadata_LocalError",i));else{const t=String.format("LocalDataSource is not available and retrievalStrategy is Local and  GCM Query = {0}",e.toString());Object(u.e)("DataSource_GetClientMetadata_Warning",k.a.storage,t),r.resolve({})}return r}_GetClientMetadataFailure(e,t,n){return r=>{Object(u.e)(t,k.a.storage,`${r.get_Message()}, Query: ${n}`),e.reject(r)}}_HasMetadataVersionChanged(e){if(e&&!this.get_ApplicationStatusProvider().isOfflineSyncDone())for(const t in e){const n={key:t,value:e[t]};for(const e of n.value){if(e.OverallVersionNumber&&this.get_UserContext()&&this.get_UserContext().get_MetadataLastModifiedTime()&&e.OverallVersionNumber<parseInt(this.get_UserContext().get_MetadataLastModifiedTime(),10))return!0;if(e.OverallUserVersionNumber&&this.get_UserContext()&&this.get_UserContext().get_UserMetadataLastModifiedTime()&&e.OverallUserVersionNumber<parseInt(this.get_UserContext().get_UserMetadataLastModifiedTime(),10))return!0}}return!1}syncClientMetadata(e){const t=new re.a;return this.get_LocalDataSource().get_isAvailable()?this.get_LocalDataSource().filterClientMetadata(e).then(e=>{this.get_remoteDataSource().syncClientMetadata(e).then(e=>{this.get_LocalDataSource().StoreApplicationMetadata(e).then(()=>{t.resolve(e)},this._RetrieveFailure(t,"DataSource_SyncClientMetadata_StoreApplicationMetadataError"))},this._RetrieveFailure(t,"DataSource_SyncClientMetadata_RemoteError"))},this._RetrieveFailure(t,"DataSource_SyncClientMetadata_FilterLocalError")):(Object(u.e)("DataSource_SyncClientMetadata_Error",k.a.storage,"Cannot sync, local store is not available"),t.reject(d.a.FromMessage("Cannot sync, local store is not available"))),t}getIsActivityFlags(){const e=new re.a;if(this.get_remoteDataSource().get_isAvailable())this.get_remoteDataSource().getIsActivityFlags().then(t=>{if(this.get_LocalDataSource().get_isAvailable()&&!this.get_ApplicationStatusProvider().isOfflineSyncDone()){const n={};n.IsActivityFlags=t,this.get_LocalDataSource().StoreApplicationMetadata(n).then(()=>{e.resolve(t)},this._RetrieveFailure(e,"DataSource_RetrieveEntityDefinitions_StoreApplicationMetadataError"))}else e.resolve(t)},t=>{if(this.get_LocalDataSource().get_isAvailable()){const t=new A.a("isactivityflags",null,null,null,null,!1,C.a.Offline,null,null,null);this.get_LocalDataSource().getClientMetadata(t).then(t=>{e.resolve(t)},this._RetrieveFailure(e,"DataSource_GetClientMetadata_LocalError"))}else Object(u.e)("DataSource_RetrieveEntityDefinitions_LocalError",k.a.storage,t.get_Message()),e.reject(t)});else if(this.get_LocalDataSource().get_isAvailable()){const t=new A.a("isactivityflags",null,null,null,null,!1,C.a.Offline,null,null,null);this.get_LocalDataSource().getClientMetadata(t).then(t=>{e.resolve(t)},this._RetrieveFailure(e,"DataSource_GetClientMetadata_LocalError"))}else{Object(u.e)("DataSource_GetIsActivityFlags",k.a.storage,"Data source not available");const t=d.a.fromErrorCode(-2147093999);e.reject(t)}return e}getRecentItems(e,t,n,r,a,i,o){const s=new re.a;return this.get_remoteDataSource().get_isAvailable()?this.get_remoteDataSource().getRecentItems(e,t,n,r,a,i,o).then(this._RetrieveSuccess(s,"DataSource_GetRecentItems_RemoteEnd",null),this._RetrieveFailure(s,"DataSource_GetRecentItems_RemoteError")):this.get_LocalDataSource().getRecentItems(e,t,n,r,a,i,o).then(this._RetrieveSuccess(s,"DataSource_GetRecentItems_LocalEnd",null),this._RetrieveFailure(s,"DataSource_GetRecentItems_LocalError")),s}UpdateRecentItems(e,t){const n=new re.a;if(this.get_remoteDataSource().get_isAvailable())this.get_remoteDataSource().UpdateRecentItems(e,t).then(this._RetrieveSuccess(n,"DataSource_UpdateRecentItems_RemoteEnd",null),this._RetrieveFailure(n,"DataSource_UpdateRecentItems_RemoteError"));else{this._RetrieveFailure(n,"DataSource_UpdateRecentItems_LocalError");const e="Method is not supported by local store";Object(u.b)("DataSource_UpdateRecentItems_LocalError",k.a.storage,e);const t=d.a.FromMessage(e);t.set_ErrorCode(-2147093999),n.reject(t)}return n}applyApplicationMetadataChanges(){return K.a.get_instance().applyApplicationMetadataChanges()}createActivityPointerAndAttachmentView(){K.a.get_instance().createActivityPointerAndAttachmentView()}isUserContextInitialized(){return!Object(f.a)(this._userContext)}updateSecureContext(){const e=new re.a,t=ne.a.createSecureContext(this._userContext);return this.get_LocalDataSource().UpdateUserContext(t).then(n=>{this.set_UserContext(t),e.resolve(n)},t=>{e.reject(t)}),e}ping(){return this.get_remoteDataSource().ping()}retrieveUserContext(){Object(u.d)("DataSource_RetrieveUserContext_Start",k.a.storage,"?");const e=new re.a;if(this.get_remoteDataSource().get_isAvailable())this.get_remoteDataSource().retrieveUserContext().then(t=>{this._UserContextLoaded(t),this.get_LocalDataSource().UpdateUserContext(t).catch(e=>{Object(u.e)("DataSource_UpdateUserContext_Error",k.a.storage,e.get_Message())}),e.resolve(t)},t=>{!Object(f.a)(t)&&d.a.isAuthenticationErrorCode(t.get_ErrorCode())?(Object(u.e)("DataSource_RetrieveUserContext_Error",k.a.storage,"Authentication ErrorCode:"+t.get_ErrorCode()),e.reject(t)):(Object(u.e)("DataSource_RetrieveUserContext_Error",k.a.storage,"Non Authentication ErrorCode"),e.reject(t))});else{Object(u.e)("DataSource_RetrieveUserContext_Error",k.a.storage,"RemoteDataSource not available");const t=d.a.fromErrorCode(-2147093999);e.reject(t)}return e}retrieveLocalDataSourceUserContext(){if(Object(u.d)("DataSource_RetrieveLocalDataSourceUserContext_Start",k.a.storage,"?"),!qn.useMDLForUserContextDuringBoot||m.a.getInstance().get_IsBrowser())return this._localDataSource.retrieveUserContext();try{const e=new re.a;return this.get_LocalDataSource().get_isAvailable()?(Object(u.d)("DataSource_RetrieveLocalDataSourceUserContext_Start",k.a.storage,"get from mdl"),this._getUserContextFromMDS(j.a.Local,e)):(Object(u.e)("DataSource_RetrieveLocalDataSourceUserContext_MDL",k.a.storage,"Offline data source not initialized"),e.resolve(null)),e}catch(e){return Object(u.b)("DataSource_RetrieveLocalDataSourceUserContext_MDL",k.a.storage,"Error in mdl code path try in legacy way to get user context"),this._localDataSource.retrieveUserContext()}}_getUserContextFromMDS(e,t){Object(Vn.b)().then(n=>{this._store.dispatch(n.getUserContext(e)).then(n=>{Object(u.d)("DataSource_RetrieveUserContext_MDL",k.a.storage,"?"),e===j.a.Remote&&(this._UserContextLoaded(n),this.get_LocalDataSource().UpdateUserContext(n).catch(e=>{Object(u.e)("DataSource_UpdateUserContext_Error",k.a.storage,e.get_Message())})),t.resolve(n)},e=>(Object(u.b)("DataSource_RetrieveUserContextError_MDL",k.a.storage,"Error in MDL GetClientMetadata = "+e.get_Message()+e.stack),this._localDataSource.retrieveUserContext()))})}_UserContextLoaded(e){if(e.get_isErrorContext())return;v.a.set_instance(new v.a(e.get_TimeZoneUtcOffsetMinutes(),e.get_TimeZoneAdjusters()));const t=e.get_UserSettings().get_formatInfoCultureName(),n=e.get_UserSettings().get_numberFormatInfo(),r=e.get_UserSettings().get_dateTimeFormatInfo();this.setCurrentCultureInfo(t,n,r),Object(f.a)(e)||Object(f.a)(this.get_remoteDataSource())||this.get_remoteDataSource().set_settings(new P(e.get_organizationSettings()))}setCurrentCultureInfo(e,t,n){Sys.CultureInfo.CurrentCulture.name=e,Sys.CultureInfo.CurrentCulture.numberFormat=t,Sys.CultureInfo.CurrentCulture.dateTimeFormat=n}createEmptyEntityRecord(e,t){Object(u.d)("DataSource_CreateEmptyEntityRecord_Start",k.a.storage,e);const n=new re.a,a=t instanceof y.a?t.get_Columns():null;return this.getAttributeTypes(e,a,null).then(t=>{Object(u.d)("DataSource_CreateEmptyEntityRecord_End",k.a.storage,e),this._GetFieldsWithDefaultValue(e,a).then(a=>{const o=new r.a(new i.a(e,p.a.get_empty()),a,t,{},{},new w.a(new Array(0)));for(const e in a){const t={key:e,value:a[e]};o.markFieldChanged(t.key)}n.resolve(o)})},t=>{Object(u.e)("DataSource_CreateEmptyEntityRecord_Error",k.a.storage,e),n.reject(t)}),n}_GetFieldsWithDefaultValue(e,t){const n=new re.a,r={};return this.retrieveMultipleAttributeMetadata(new N.a(e,t),null).then(e=>{for(const t of e)if(t.get_type()||Object(f.a)(t.get_defaultValue())){if("picklist"===t.get_type()&&!Object(f.a)(t.get_defaultFormValue())){const e=t.get_defaultFormValue();-1!==e&&(r[t.get_logicalName()]=new I.a(t.get_optionSet().get_options()[e.toString()].get_Label(),e,-1,-1,t.get_optionSet().get_options()[e.toString()].get_allowedStatusTransitions(),t.get_optionSet().get_options()[e.toString()].get_color(),t.get_optionSet().get_options()[e.toString()].get_invariantName()))}}else t.get_defaultValue()?r[t.get_logicalName()]=new I.a(t.get_optionSet().get_options()[1].get_Label(),1,-1,-1,null,null,null):r[t.get_logicalName()]=new I.a(t.get_optionSet().get_options()[0].get_Label(),0,-1,-1,null,null,null);n.resolve(r)},()=>{n.resolve(r)}),n}clearAllMetadata(e){const t=new re.a;return this.get_LocalDataSource().clearAllMetadataStores(e).then(()=>{t.resolve(!0)},e=>{t.reject(e)}),t}clearEntityAttributeApplicationMetadata(){const e=new re.a;return this.get_LocalDataSource().clearEntityAttributeApplicationMetadataStores().then(()=>{e.resolve(!0)},t=>{e.reject(t)}),e}clearAllData(){const e=new re.a;return this.get_LocalDataSource().clearAllDataStores().then(()=>{e.resolve(!0)},t=>{e.reject(t)}),e}create(e,t,n){Object(u.d)("DataSource_Create_Start",k.a.storage,e.get_identifier().toString());const r=new re.a;let a;return this.get_remoteDataSource().get_isAvailable()?a=this.get_remoteDataSource().create(e,t,n):(e.set_clientRetrieveOptions(new O.a(S.a.NotCached,0)),a=this.get_LocalDataSource().create(e,t,n)),a.then(t=>{Object(u.d)("DataSource_Create_Success",k.a.storage,e.get_identifier().toString()),r.resolve(t)},e=>{Object(u.e)("DataSource_Create_Error",k.a.storage,e.get_Message()),r.reject(e)}),r}retrieve(e,t,n,r,a,i){return this.retrieveRelatedEntities(e,t,t,null,n,r,a,i)}retrieveRelatedEntities(e,t,n,r,a,i,o,s){if(Object(u.d)("DataSource_RetrieveRelatedEntities_Start",k.a.storage,e.toString()),Object(Bn.g)(this._store.getState(),a.get_retrievalStrategy())&&!r){const n=new re.a;return Object(Vn.b)().then(r=>{this._store.dispatch(r.retrieve(e,t,i,o,s)).then(this._RetrieveEntityRecordSuccess(e,n,"DataSource_Retrieve_End",e.toString(),i),e=>{this._RetrieveFailure(n,"DataSource_Retrieve_RemoteError"),n.reject(e)})}),n}return a=this._AdjustClientRetrieveOptions(a),this._RetrieveWithStrategy(a.get_retrievalStrategy(),this._retrievePromiseCache,e.get_key(),t,i,(c,l)=>{switch(c){case 0:this.get_LocalDataSource().retrieveRelatedEntities(e,t,n,r,a,i,o,s).then(this._RetrieveEntityRecordSuccess(e,l,"DataSource_Retrieve_LocalEnd",e.toString(),i),c=>{if(Object(u.d)("DataSource_Retrieve_LocalError",k.a.storage,c.get_Message()),this.get_remoteDataSource().get_isAvailable())this.get_remoteDataSource().retrieveRelatedEntities(e,t,n,r,a,i,o,s).then(t=>{Object(u.d)("DataSource_Retrieve_RemoteEnd",k.a.storage,e.toString()),O.a.shouldBeCached(a)&&this.get_LocalDataSource().cache(t,i),this.get_EventManager().OnRetrieved(this,new R(e.get_key(),null,ee.a.Success,te.a.Remote),i),l.resolve(t)},t=>{Object(u.d)("DataSource_Retrieve_RemoteError",k.a.storage,t.get_Message()),this.get_EventManager().OnRetrieved(this,new R(e.get_key(),null,ee.a.Error,te.a.Remote,t),i),l.reject(t)});else{const t=d.a.fromErrorCode(K.a.get_instance().get_offlineDataSource().isOfflineAvailableForUse()?-2147220969:-2147093999);this.get_EventManager().OnRetrieved(this,new R(e.get_key(),null,ee.a.Error,0,t),i),l.reject(t)}});break;case j.a.Remote:this.get_remoteDataSource().retrieveRelatedEntities(e,t,n,r,a,i,o,s).then(this._RetrieveRemoteSuccess(e,l,a,i),this._RetrieveRemoteFailure(e,l,"DataSource_Retrieve_RemoteError",i));break;case j.a.LocalAndRemote:this.get_LocalDataSource().retrieveRelatedEntities(e,t,n,r,a,i,o,s).then(this._RetrieveEntityRecordSuccess(e,l,"DataSource_Retrieve_LocalEnd",e.toString(),i),e=>{Object(u.b)("DataSource_Retrieve_LocalError",k.a.storage,e.get_Message())}),this.get_remoteDataSource().retrieveRelatedEntities(e,t,n,r,a,i,o,s).then(this._RetrieveRemoteSuccess(e,l,a,i),this._RetrieveRemoteFailureWhenOnline(e,l,"DataSource_Retrieve_RemoteError",i))}return l})}_AdjustClientRetrieveOptions(e){return Object(f.a)(e)&&(e=new O.a(S.a.NotCached,j.a.Remote)),this.get_remoteDataSource().get_isAvailable()?this.get_IsLocalDataSourceAvailable()||e.get_retrievalStrategy()!==j.a.LocalAndRemote||e.set_retrievalStrategy(j.a.Remote):e.set_retrievalStrategy(0),Object(l.b)()&&(e.set_retrievalStrategy(j.a.Remote),e.set_cachePriority(S.a.NotCached)),e}retrieveMultiple(e,t,n){return Object(u.d)("DataSource_RetrieveMultiple_Start",k.a.storage,e.toString()),t=this._AdjustClientRetrieveOptions(t),this._RetrieveWithStrategy(t.get_retrievalStrategy(),this._retrieveMultiplePromiseCache,e.get_DataLayerInternalCachingKey(),e.get_ColumnSet(),n,(r,a)=>{switch(r){case 0:this.get_LocalDataSource().retrieveMultiple(e,t,n).then(this._RetrieveSuccess(a,"DataSource_RetrieveMultiple_End",e.toString()),r=>{if(Object(u.d)("DataSource_RetrieveMultiple_LocalError",k.a.storage,r.get_Message()),this.get_remoteDataSource().get_isAvailable())this.get_remoteDataSource().retrieveMultiple(e,t,n).then(r=>{Object(u.d)("DataSource_RetrieveMultiple_RemoteEnd",k.a.storage,e.toString()),O.a.shouldBeCached(t)&&this.get_LocalDataSource().cacheMultiple(e,r,n),a.resolve(r)},this._RetrieveFailure(a,"DataSource_RetrieveMultiple_RemoteError"));else{const e=d.a.fromErrorCode(-2147093999);e.set_InnerError(r),a.reject(e)}});break;case j.a.Remote:this.get_remoteDataSource().retrieveMultiple(e,t,n).then(this._RetrieveMultipleRemoteSuccess(e,a,t,n),this._RetrieveMultipleFailure(e,a,"DataSource_RetrieveMultiple_RemoteError",n));break;case j.a.LocalAndRemote:this.get_LocalDataSource().retrieveMultiple(e,t,n).then(this._RetrieveSuccess(a,"DataSource_RetrieveMultiple_LocalEnd",e.toString()),e=>{Object(u.b)("DataSource_RetrieveMultiple_LocalError",k.a.storage,e.get_Message())}),this.get_remoteDataSource().retrieveMultiple(e,t,n).then(this._RetrieveMultipleRemoteSuccess(e,a,t,n),this._RetrieveMultipleFailure(e,a,"DataSource_RetrieveMultiple_RemoteError",n))}return a})}retrieveEntitiesForAggregateQuery(e,t,n){const r=new T.a(e,t);Object(u.d)("DataSource_RetrieveEntitiesForAggregateQuery_Start",k.a.storage,r.toString());const a=new re.a;return this.get_remoteDataSource().get_isAvailable()?this.get_remoteDataSource().retrieveEntitiesForAggregateQuery(e,t,n).then(e=>{Object(u.d)("DataSource_RetrieveEntitiesForAggregateQuery_End",k.a.storage,r.toString()),a.resolve(e)},e=>{Object(u.d)("DataSource_RetrieveEntitiesForAggregateQuery_Error",k.a.storage,e.get_Message()),a.reject(e)}):a.reject(d.a.fromErrorCode(-2147093999)),a}update(e,t,n,r){Object(u.d)("DataSource_Update_Start",k.a.storage,e.toString());const a=new re.a;return this.get_remoteDataSource().get_isAvailable()?(this.get_remoteDataSource().update(e,t,n,r).then(n=>{Object(u.d)("DataSource_Update_RemoteCreateEnd",k.a.storage,e.toString()),this.get_LocalDataSource().cache(t,r),a.resolve(n)},e=>{Object(u.d)("DataSource_Update_RemoteError",k.a.storage,e.get_Message()),a.reject(e)}),a):this.get_LocalDataSource().update(e,t,n,r)}Delete(e,t){Object(u.d)("DataSource_Delete_Start",k.a.storage,e.toString());const n=new re.a;return this.get_remoteDataSource().get_isAvailable()?this.get_remoteDataSource().Delete(e,t).then(r=>{this._DeleteFromLocalStore(r,t).then(e=>{n.resolve(e)},e=>{Object(u.d)("DataSource_Delete_LocalDeleteError",k.a.storage,e.get_Message()),n.reject(e)}).always(()=>{this.get_EventManager().OnDeleted(this,new D("deleted",e.get_key()),t)})},e=>{Object(u.d)("DataSource_Delete_RemoteError",k.a.storage,e.get_Message()),n.reject(e)}):K.a.get_instance().get_offlineDataSource().isOfflineAvailableForUse()?this._DeleteFromLocalStore(e,t).then(r=>{this.get_EventManager().OnDeleted(this,new D("deleted",e.get_key()),t),n.resolve(r)},e=>{Object(u.d)("DataSource_Delete_LocalDeleteError",k.a.storage,e.get_Message()),n.reject(e)}):n.reject(d.a.fromErrorCode(-2147093999)),n}_DeleteFromLocalStore(e,t){const n=new re.a;if(Object(Bn.k)(this._store.getState(),"Delete")){const r=Wn.a.legacyToExternalEntityReference(e),a=new zn.c(r);this.executeOData(a,t).then(()=>{n.resolve(e)}).catch(t=>{Object(u.d)("DataSource_Delete_LocalDeleteEnd : Unable to delete from local store",k.a.storage,e.toString()),n.reject(t)})}else this.get_LocalDataSource().Delete(e,t).then(()=>{Object(u.d)("DataSource_Delete_LocalDeleteEnd",k.a.storage,e.toString()),n.resolve(e)},e=>{n.reject(e)});return n}execute(e,t){if(Object(u.d)("DataSource_Execute_Start",k.a.storage,e.toString()),Object(Bn.h)(this._store.getState(),e))return new re.a(this._executeViaMDL(e));if(this.get_remoteDataSource().get_isAvailable()){if(e instanceof Y&&(e=e.get_request()),e instanceof J.a)this.get_EventManager().OnRetrieving(this,new x(e.get_target().get_key()),t);else if(e instanceof Q.a)for(const n of e.get_requests())n instanceof J.a&&this.get_EventManager().OnRetrieving(this,new x(n.get_target().get_key()),t);const n=new re.a;return this.get_remoteDataSource().execute(e,t).then(r=>{if(r instanceof Z.a)this._HandleRetrieveResponse(e,r,null,t);else if(r instanceof $.a){const n=r;for(const r of n.get_responses())r.get_response()instanceof Z.a&&this._HandleRetrieveResponse(e.get_requests()[r.get_requestIndex()],r.get_response(),r.get_fault(),t)}n.resolve(r)},e=>{n.reject(e)}),n}return e instanceof Y&&!Object(f.a)(e.get_offlineCallback())?e.executeCallback():this.get_LocalDataSource().execute(e,t)}async _executeViaMDL(e){const t=await Object(Vn.b)();return this._store.dispatch(t.execute(e,this._store))}executeOData(e,t){if(Object(Bn.j)(this._store.getState(),e))return new re.a(this._executeODataViaMDL(e));if(Object(u.d)("DataSource_ExecuteOData_Start",k.a.storage,e.toString()),this.get_remoteDataSource().get_isAvailable()){const n=new re.a;return this.get_remoteDataSource().executeOData(e,t).then(r=>{if(2===e.getMetadata().operationType&&"delete"===e.getMetadata().operationName.toLowerCase()){const n="entityType",r="id",a="entityreference";for(const o in e){const s={key:o,value:e[o]};if(s.key.toLowerCase()===a&&!Object(f.a)(s.value[n])&&!Object(f.a)(s.value[r])){const e=new i.a(s.value[n],p.a.tryCreate(s.value[r]));this.get_LocalDataSource().Delete(e,t);break}}}n.resolve(r)},e=>{n.reject(e)}),n}return this.get_LocalDataSource().executeOData(e,t)}async _executeODataViaMDL(e){const t=await Object(Vn.b)();return this._store.dispatch(t.executeOData(e))}retrieveEntityMetadata(e,t){Object(u.d)("DataSource_RetrieveEntityMetadata_Start",k.a.storage,e);const n=new re.a,r=this.get_MetadataCache().getEntityMetadata(e);if(r)return n.resolve(r),n;let a=null;Object(f.b)(e)||(a='{\\"'+e+'\\":[]}');const i=new A.a("entity",a,null,null,new Array(0),!1,C.a.OnDemandWithContext,null,null,null);return this.getClientMetadata(i,j.a.LocalAndRemote,t).then(e=>{let t=null;e.Entities&&(t=E.a.createFromOData(e.Entities[0]),Object(f.a)(t)||this.get_MetadataCache().cacheEntityMetadata(t)),n.resolve(t)},e=>{n.reject(e)}),n}retrieveMultipleAttributeMetadata(e,t){Object(u.d)("DataSource_RetrieveMultipleAttributeMetadata_Start",k.a.storage,e.toString());const n=new re.a;if(Object(f.a)(e.get_AttributeNames()))this.retrieveEntityMetadata(e.get_EntityLogicalName(),t).then(r=>{const a=r,i=this._metadataCache.getMultipleAttributeMetadata(e.get_EntityLogicalName(),e.get_AttributeNames());Object(f.a)(i)||!Object(f.a)(a.get_attributeNames())&&a.get_attributeNames().length!==i.length?this.get_LocalDataSource().retrieveMultipleAttributeMetadata(e,t).then(t=>{Object(u.d)("DataSource_RetrieveMultipleAttributeMetadata_LocalEnd",k.a.storage,e.toString()),n.resolve(t)},this._RetrieveFailure(n,"DataSource_RetrieveMultipleAttributeMetadata_LocalError")):(Object(u.d)("DataSource_RetrieveMultipleAttributeMetadata_CacheEnd",k.a.storage,e.toString()),n.resolve(i))},e=>{Object(u.d)("DataSource_RetrieveMultipleAttributeMetadata_LocalError",k.a.storage,e.get_Message()),n.reject(e)});else if(e.get_AttributeNames().length){let r=this.get_MetadataCache().getMultipleAttributeMetadata(e.get_EntityLogicalName(),e.get_AttributeNames());if(Object(f.a)(r)&&(r=new Array(0)),r.length===e.get_AttributeNames().length)n.resolve(r);else{let a=this._GetMissingAttributes(e.get_AttributeNames(),r);const i=new N.a(e.get_EntityLogicalName(),a);this.get_LocalDataSource().retrieveMultipleAttributeMetadata(i,t).then(o=>{if(this.get_MetadataCache().cacheAttributeMetadata(i.get_EntityLogicalName(),!1,o),o.push(...r),o.length===e.get_AttributeNames().length)Object(u.d)("DataSource_RetrieveMultipleAttributeMetadata_LocalEnd",k.a.storage,e.toString()),n.resolve(o);else if(this.get_IsServerAvailable()){a=this._GetMissingAttributes(a,o);const r=new N.a(e.get_EntityLogicalName(),a);this._GetRemoteAttributeMetadata(r,t,o,n)}else n.resolve(o)},()=>{this.get_IsServerAvailable()?this._GetRemoteAttributeMetadata(i,t,r,n):n.reject(d.a.fromErrorCode(-2147093999))})}}else Object(u.d)("DataSource_RetrieveMultipleAttributeMetadata_End",k.a.storage,e.toString()),n.resolve([]);return n}getAttributeTypesForEntities(e,t,n,r,a){const i=new re.a;return this.getAttributeTypes(e,n,a).then(e=>{if(!Object(f.a)(r)&&!Object(f.a)(t))for(const n of t)n in r&&(e[n]="aliasedvalue");i.resolve(e)},e=>{Object(u.d)("DataSource_GetAttributeTypesForEntities_Error.",k.a.storage,e.get_Message()),i.reject(e)}),i}getAttributeTypes(e,t,n){const r=new re.a,a=this.get_MetadataCache().getAttributeTypes(e,t);let i=[];const o=Object(f.a)(t)||!t.length;if(o||(i=t.filter(e=>!(e in a))),i.length>0||o){const t=o?null:i;this.retrieveMultipleAttributeMetadata(new N.a(e,t),n).then(t=>{for(let e=0;e<t.length;e++){const n=t[e];a[n.get_logicalName()]=n.get_type()}this.get_MetadataCache().cacheAttributeMetadata(e,o,t),Object(u.d)("Successfully returning attribute types dictionary",k.a.storage,""),r.resolve(a)},e=>{Object(u.b)("DataSource_GetAttributeTypes_Error",k.a.storage,e.get_Message()),r.reject(e)})}else Object(u.d)("Successfully returning attribute types dictionary",k.a.storage,""),r.resolve(a);return r}_GetMissingAttributes(e,t){const n={};for(let e=0;e<t.length;e++)n[t[e].get_logicalName()]=null;const r=new Array(0);for(const t of e)t in n||r.push(t);return r}_GetRemoteAttributeMetadata(e,t,n,r){this.get_remoteDataSource().retrieveMultipleAttributeMetadata(e,t).then(t=>{this.get_MetadataCache().cacheAttributeMetadata(e.get_EntityLogicalName(),!1,t),t.push(...n),Object(l.b)()&&this.get_LocalDataSource().createMultipleAttributeMetadata(t),Object(u.d)("DataSource_RetrieveMultipleAttributeMetadata_RemoteEnd",k.a.storage,e.toString()),r.resolve(t)},this._RetrieveFailure(r,"DataSource_RetrieveMultipleAttributeMetadata_RemoteError"))}retrieveApplicationMetadata(e,t){Object(u.d)("DataSource_RetrieveApplicationMetadata_Start",k.a.storage,e.toString());const n=new re.a;return this.get_LocalDataSource().retrieveApplicationMetadata(e,t).then(this._RetrieveSuccess(n,"DataSource_RetrieveApplicationMetadata_LocalEnd",e.toString()),e=>{n.reject(e)}),n}retrieveMultipleApplicationMetadata(e,t){return this._RetrieveMultipleApplicationMetadataInternal(e,!1,t,!1)}_RetrieveMultipleApplicationMetadataInternal(e,t,n,r){const a=e.toString();Object(u.d)("DataSource_RetrieveMultipleApplicationMetadata_Start",k.a.storage,a);const i=new re.a,o=this._retrieveApplicationMetadataPromiseCache.get(a);return Object(f.a)(o)||t?(this._retrieveApplicationMetadataPromiseCache.put(a,new W.a(i,a,"RetrieveMultipleApplicationMetadata")),this.get_LocalDataSource().retrieveMultipleApplicationMetadata(e,n).then(e=>{Object(u.d)("DataSource_RetrieveMultipleApplicationMetadata",k.a.storage,"From database - Query : "+a+" callbacksafeArrayLength : "+e.length.toString()),i.resolve(e)},e=>{Object(u.b)("DataSource_RetrieveMultipleApplicationMetadata:Failed in LocalDataSource.RetrieveMultipleApplicationMetadata",k.a.storage,e.get_Message()),i.reject(e)})):(Object(u.d)("DataSource_RetrieveMultipleApplicationMetadata",k.a.storage,"Waiting for pending retrieve to finish - Query : "+a),o.getPromise().always(()=>{this._RetrieveMultipleApplicationMetadataInternal(e,!0,n,r).then(e=>{i.resolve(e)},e=>{Object(u.b)("DataSource_RetrieveMultipleApplicationMetadata:Failed in RetrieveMultipleApplicationMetadataInternal",k.a.storage,e.get_Message()),i.reject(e)})})),i}createUserPersonalization(e){return this.get_LocalDataSource().createUserPersonalization(e)}deleteUserPersonalization(e){return this.get_LocalDataSource().deleteUserPersonalization(e)}retrieveUserPersonalization(e){return this.get_IsLocalDataSourceAvailable()?this.get_LocalDataSource().retrieveUserPersonalization(e):(new re.a).resolve(null)}changeProcessAndStage(e,t,n,r,a,i){const o=new re.a;return this.get_remoteDataSource().get_isAvailable()?this.get_remoteDataSource().changeProcessAndStage(e,t,n,r,a,i).then(this._RetrieveSuccess(o,"DataSource_ChangeProcessAndStage_RemoteEnd",t),this._RetrieveFailure(o,"DataSource_ChangeProcessAndStage_RemoteError")):o.reject(d.a.fromErrorCode(-2147093999)),o}createNavigationEntity(e,t,n,r,a){const i=new re.a;return this.get_remoteDataSource().get_isAvailable()?this.get_remoteDataSource().createNavigationEntity(e,t,n,r,a).then(this._RetrieveSuccess(i,"DataSource_CreateNavigationEntity_RemoteEnd",t.toString()),this._RetrieveFailure(i,"DataSource_CreateNavigationEntity_RemoteError")):i.reject(d.a.fromErrorCode(-2147093999)),i}retrieveNavigationEntities(e,t,n,r,a){const i=new re.a;return this.get_remoteDataSource().get_isAvailable()?this.get_remoteDataSource().retrieveNavigationEntities(e,t,n,r,a).then(this._RetrieveSuccess(i,"DataSource_RetrieveNavigationEntities_RemoteEnd",e),this._RetrieveFailure(i,"DataSource_RetrieveNavigationEntities_RemoteError")):i.reject(d.a.fromErrorCode(-2147093999)),i}retrieveUserLocalFacets(e,t){const n=new re.a;return this.get_remoteDataSource().get_isAvailable()?this.get_remoteDataSource().retrieveUserLocalFacets(e,t).then(this._RetrieveSuccess(n,"DataSource_RetrieveUserLocalFacets_RemoteEnd",e.toString()),this._RetrieveFailure(n,"DataSource_RetrieveUserLocalFacets_RemoteError")):n.reject(d.a.fromErrorCode(-2147093999)),n}saveSessionState(e,t,n,r){const a=new re.a;return this.get_LocalDataSource().saveSessionState(e,t,n).then(e=>{a.resolve(e)},e=>{r?this.get_LocalDataSource().nullifyStores().then(()=>{a.resolve(null)},t=>{Object(u.b)("DataSource_SaveSessionState",k.a.storage,"SaveSessionState failed and then nullify store failed with message - "+e.get_Message()),e.chainError(t),a.reject(e)}):a.reject(e)}),a}retrieveSessionState(e,t){const n=new re.a;return this.get_LocalDataSource().retrieveSessionState(e).then(e=>{n.resolve(e)},r=>{t?this.get_LocalDataSource().nullifyStores().then(()=>{n.resolve(null)},t=>{Object(u.b)("DataSource_RetrieveSessionState",k.a.storage,"RetrieveSessionState failed and then nullify store failed with message - "+r.get_Message()+" :key = "+e),r.chainError(t),n.reject(r)}):(Object(u.b)("DataSource_RetrieveSessionState",k.a.storage,"RetrieveSessionState failed with message - "+r.get_Message()+" :key = "+e),n.reject(r))}),n}deleteSessionState(e){return this.get_LocalDataSource().deleteSessionState(e)}retrieveDataFromOfflineStore(e){return this.get_LocalDataSource().retrieveDataFromOfflineStore(e)}initializeUIStrings(e){const t=new o.a(g.a.uiStrings,Object(l.a)(),"uistrings");Object(u.d)("DataSource_InitializeUIStrings_Start",k.a.storage,t.toString());const n=new re.a;return this._RetrieveMultipleApplicationMetadataInternal(t,!1,null,e).then(e=>{e.length>0?(Object(s.c)(e[0].get_metadata()),n.resolve(!0)):n.resolve(!1)},e=>{Object(l.b)()?n.resolve(!1):(Object(u.b)("DataSource_InitializeUIStrings_LocalError",k.a.storage,e.get_Message()),n.reject(e))}),n}_RetrieveWithStrategy(e,t,n,r,a,i){const o=t.get(n,r,e);if(!Object(f.a)(o))return e&&this.get_EventManager().OnRetrieving(this,new x(n),a),o;const s=new re.a;return t.put(s,n,r,e,a),Object(f.a)(e)?(this._RetrieveFailure(s,"DataSource_RetrieveMultiple_RetrievalStrategyError"),s):(this.get_EventManager().OnRetrieving(this,new x(n),a),i(e,s))}_RetrieveSuccess(e,t,n){return r=>{Object(u.d)(t,k.a.storage,n),e.resolve(r)}}_RetrieveFailure(e,t){return n=>{Object(u.e)(t,k.a.storage,n.get_Message()),e.reject(n)}}_RetrieveEntityRecordSuccess(e,t,n,r,a){return i=>{Object(u.d)(n,k.a.storage,r),t.resolve(i);const o=!this.get_IsServerAvailable()&&K.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(i.get_actionableIdentifier().LogicalName);this.get_EventManager().OnRetrieved(this,new R(e.get_key(),i,ee.a.Success,0,null,o),a)}}_RetrieveRemoteSuccess(e,t,n,r){return a=>{Object(u.d)("DataSource_Retrieve_RemoteEnd",k.a.storage,e.toString()),O.a.shouldBeCached(n)&&this.get_LocalDataSource().cache(a,r),t.resolve(a),this.get_EventManager().OnRetrieved(this,new R(e.get_key(),a,ee.a.Success,te.a.Remote),r)}}_RetrieveMultipleRemoteSuccess(e,t,n,r){return a=>{Object(u.d)("DataSource_RetrieveMultiple_RemoteEnd",k.a.storage,e.toString()),O.a.shouldBeCached(n)&&this.get_LocalDataSource().cacheMultiple(e,a,r),t.resolve(a),this.get_EventManager().OnRetrieved(this,new R(e.get_DataLayerInternalCachingKey(),a,ee.a.Success,te.a.Remote),r)}}_RetrieveMultipleFailure(e,t,n,r){return a=>{Object(u.d)(n,k.a.storage,a.get_Message()),t.reject(a),this.get_EventManager().OnRetrieved(this,new R(e.get_DataLayerInternalCachingKey(),null,ee.a.Error,te.a.Remote,a),r)}}_RetrieveRemoteFailure(e,t,n,r){return a=>{Object(u.d)(n,k.a.storage,a.get_Message()),Object(c.a)(a.get_ErrorCode())||this.get_LocalDataSource().uncache(e,r),t.reject(a),this.get_EventManager().OnRetrieved(this,new R(e.get_key(),null,ee.a.Deleted,te.a.Remote,a),r)}}_RetrieveRemoteFailureWhenOnline(e,t,n,r){return a=>{Object(u.d)(n,k.a.storage,a.get_Message()),-2147093999!==a.get_ErrorCode()&&this._RetrieveRemoteFailure(e,t,n,r)(a)}}_HandleRetrieveResponse(e,t,n,r){const a=e.get_clientRetrieveOptions(),i=t.get_entity();if(Object(f.a)(n)||Object(f.a)(i)){if(!Object(f.a)(i)){i.set_clientRetrieveOptions(a);const t=Object(f.a)(i.get_relatedEntities())?new Array(0):i.get_relatedEntities().get_relatedEntityQueries();i.updateColumnSet(e.get_columnSet(),t),O.a.shouldBeCached(a)&&this.get_LocalDataSource().cache(i,r),qn.get_DefaultInstance().get_EventManager().OnRetrieved(this,new R(i.get_identifier().get_key(),i,ee.a.Success,te.a.Remote),r)}}else qn.get_DefaultInstance().get_EventManager().OnRetrieved(this,new R(i.get_identifier().get_key(),i,ee.a.Error,te.a.Remote,d.a.fromErrorCode(n.get_errorCode())),r)}static get_DefaultInstance(){return qn._defaultInstance}static set_DefaultInstance(e){return qn._defaultInstance=e,e}static getInstance(e,t,n,r){if(Object(u.c)("DataSource_GetInstance_Start",k.a.storage,e),Object(f.a)(qn._Instances[e])){const i=new qn(e,t,r);i.set_ApplicationStatusProvider(n),i._set_remoteDataSource(new a.a(e,i,t)),i._set_LocalDataSource(new Un(e,i)),qn._Instances[e]=i}return Object(u.c)("DataSource_GetInstance_End",k.a.storage,e),qn._Instances[e]}}qn.useMDLForUserContextDuringBoot=!0,qn._Instances={},qn._defaultInstance=null},jgTV:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"j",(function(){return l})),n.d(t,"m",(function(){return u})),n.d(t,"l",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return h})),n.d(t,"k",(function(){return f}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="MscrmControls.KbArticleControl.KbArticleControl",a="MscrmControls.KbContentControl.KbContentControl",i="kbarticlecontrol",o="kbcontentcontrol",s="1.0.0",c="knowledgearticle",l="rating",u="knowledgearticleviews",d="title",p="modifiedon",g="content",h="articlepublicnumber",f="statecode"},jhff:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return o}));var r=n("FoFY"),a=n("pulT"),i=n("QGYZ");function o(e,t){
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
return function(e,t){const n=Object(r.a)(e,t);return Object(i.b)(e,n.focusedTabId)}(e,t).id}function s(e){const t=Object(a.b)(e);return Object(i.b)(e,t.focusedTabId)}function c(e){return s(e).id}},jq7Z:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("jS4H"),a=n("dHD5");function i(e,t){var n;const a=Object(r.a)(e,t);return null!=a?a:null===(n=null==e?void 0:e.formInstances)||void 0===n?void 0:n[t]}function o(e,t,n){var r,o,s;const c=Object(a.v)(n);return null===(s=null===(o=null===(r=i(e,t))||void 0===r?void 0:r.forms)||void 0===o?void 0:o[c])||void 0===s?void 0:s.formId}},jqlv:function(e,t,n){"use strict";n.d(t,"e",(function(){return g})),n.d(t,"a",(function(){return h})),n.d(t,"k",(function(){return f})),n.d(t,"j",(function(){return m})),n.d(t,"i",(function(){return b})),n.d(t,"d",(function(){return _})),n.d(t,"f",(function(){return y})),n.d(t,"g",(function(){return v})),n.d(t,"c",(function(){return S})),n.d(t,"b",(function(){return O})),n.d(t,"h",(function(){return C}));var r=n("ufH1"),a=n("84PK"),i=n("504W"),o=n("Div0"),s=n("WSMw"),c=n("zAhX"),l=n("thzq"),u=n("3ri3"),d=n("LTmj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class p{constructor(){this._SID=0,this._LogTableID=null,this._OperationType=0}get_SID(){return this._SID}set_SID(e){return this._SID=e,e}get_logTableID(){return this._LogTableID}set_logTableID(e){return this._LogTableID=e,e}get_operationType(){return this._OperationType}set_operationType(e){return this._OperationType=e,e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function g(e){return u.A+e}function h(e){const t=new Array(e.rows.length);for(let n=0;n<e.rows.length;n++){const r=e.rows.item(n),a=new p;a.set_SID(r[u.M]),a.set_logTableID(r[u.K].toString()),a.set_operationType(r[u.L]),t[n]=a}return t}function f(e,t){Object(r.e)(e,o.a.offlineUpSync,t)}function m(e,t){Object(r.e)(e,o.a.offlineUpSync,t)}function b(e){return e.get_logTableID()}function _(e){return e.replace(u.A,"")}function y(e,t){if(Object(i.a)(e))return null;const n=S(e),r=e.get_SID();if(Object(i.a)(n)||Object(i.a)(t)||!(n in t))return null;const a=t[n];if(Object(i.a)(a)||Object(i.a)(a[r.toString()]))return null;return a[r.toString()][0]}function v(e,t){if(Object(i.a)(e))return null;const n=S(e),r=e.get_SID(),a=e.get_operationType();if(a===l.a.Create||a===l.a.Delete||Object(i.a)(n)||Object(i.a)(t)||!(n in t))return null;const o=t[n][r.toString()];return Object(i.a)(o)?null:o[1]}function S(e){return b(e).replace(u.A,"")}function O(e){if(!Object(i.a)(e)){const t=e[u.g],n=e[u.h].toString(),r=e[u.n],a=e[u.d].toString();return new d.a(t,n,r,a)}return new d.a(a.a.get_empty(),null,c.a.InProgress,null)}function C(e){let t="";switch(e){case l.a.Create:t=s.b;break;case l.a.Delete:t=s.a;break;case l.a.Update:t=s.d;break;case l.a.Retrieve:t=s.c}return t}},jsc8:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("Uv1Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t=!1){return{type:"session.state.retrieve.async",execute:({getState:n},a)=>function(e,t,n=!1){return e.retrieveSessionState(t,n).nativePromise().catch(r.b)}(a.DataSource,e,t).then(e=>e)}}},jxo7:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("nxt5");class a extends r.a{constructor(e){super("RetrieveMultiple"),this._entityCollection=e}get_entityCollection(){return this._entityCollection}}},jzeE:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("nJrx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a=Object(r.a)()},k1f1:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("SAYH"),a=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="businessProcessFlow.addInstanceIdToRecordData";function o(e,t){const n={entities:{[t.etn]:{[r.a.toString(t.id)]:{initialized:a.a.Initialized,businessProcessFlowInstanceId:e}}}};return{type:i,payload:n}}},kGA3:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("nuS9"),a=r.createContext({})},kGsI:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");class a extends r.a{constructor(e,t,n){super(),this._target=null,this._relationship=null,this._target=e,this._relationship=t}get_name(){return"Disassociate"}get_xmlNamespace(){return"http://schemas.microsoft.com/xrm/2011/Contracts"}get_target(){return this._target}get_relationship(){return this._relationship}}},kKLx:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Error_Entity_NotAvailable",a="Error_View_NotAvailable",i=[r,a]},kToj:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n("XjOj"),n("Div0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){0}},kWiz:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r,a=n("pNM1");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.Off=0]="Off",e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Info=3]="Info",e[e.Verbose=4]="Verbose"}(r||(r={})),function(e){e.toString=function(t){switch(t){case e.Off:return"Off";case e.Error:return"Error";case e.Warning:return"Warning";case e.Info:return"Info";case e.Verbose:return"Verbose";default:return`Unknown TracerLogLevel: ${t}. Please update TracerLogLevel`}},e.fromString=function(t){switch(t){case"Off":return e.Off;case"Error":return e.Error;case"Warning":return e.Warning;case"Info":return e.Info;case"Verbose":return e.Verbose;default:return e.Info}},e.fromLegacyLogLevel=function(t){switch(t){case a.a.Error:return e.Error;case a.a.Info:return e.Info;case a.a.Off:return e.Off;case a.a.Perf:return e.Info;case a.a.Verbose:return e.Verbose;case a.a.Warning:return e.Warning;default:return e.Info}}}(r||(r={}))},kX6F:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="selectedForm.update";function a(e,t,n){return{type:r,payload:{selectedForms:{[e]:{formId:t,userEntityUISettingsId:n}}}}}},ke4y:function(e,t,n){"use strict";n.d(t,"b",(function(){return Wt})),n.d(t,"a",(function(){return Rt}));var r=n("nuS9"),a=n("4fxQ"),i=n("wul+"),o=n("jzeE"),s=n("u+q+"),c=n("QBtP"),l=n("pF61"),u=n("hAdb"),d=n("unFF"),p=n("arV0"),g=n("xHmU"),h=n("b8dX"),f=n("sTJm"),m=n("QJW6"),b=n("clbQ"),_=n("YWpA"),y=n("H/hG"),v=n("evW+"),S=n("gQ5I"),O=n("XIN1"),C=n("znb3"),E=n("Zz+h"),I=n("b8TU"),w=n("IqkD"),j=n("FJiw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function P(){let e,t,n,r=!1,a=!1,i=!1,o=!1,s=!1;return function(c,l){const u=Object(d.a)(c),p=Object(E.c)(c,l),g=Object(I.a)(c),h=Object(w.g)(c),f=function(e,t){return t&&e&&e.sizes.Breakpoints&&e.sizes.Breakpoints.DimensionS&&t.deviceWidth<e.sizes.Breakpoints.DimensionS}(u,g),m=Object(E.d)(c,l.id),b=!(!p||!p.windowPosition||"side"!==p.windowPosition),_=p&&p.hideDialogHeader;if(e!==u||r!==f||i!==b||o!==h||n!==p||a!==m||s!==_){e=u,r=f,a=m,i=b,o=h,n=p,s=_;const c={height:"32px",width:"32px",flexShrink:0},l=Object.assign(Object.assign({},u.buttons.ActionIconButton01),c);t={dialogOuterContainerStyle:{height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:b?"flex-end":"center"},dialogStyle:{backgroundColor:u.colors.BaseColor.White,minHeight:b||m?"100%":"0px",maxHeight:b||m||f?"100%":"90%",height:b||m?"100%":"auto",minWidth:f||m?"100%":u.sizes.Dialog.Width,maxWidth:f||m?"100%":"90%",flexDirection:"column",borderRadius:u.sizes.Measures.Measure015,borderStyle:u.display.SolidBorderStyle,borderWidth:u.sizes.Dialog.BorderWidth,borderColor:u.colors.BaseColor.Grey.Grey1},dialogCloseIconButtonStyle:l,dialogCloseIconStyle:{color:u.colors.BaseColor.Grey.Grey6,fontSize:u.fontSizes.Font1143,textAlign:"center"},dialogResizeIconButtonStyle:h?Object.assign(Object.assign({},l),{marginRight:"auto"}):Object.assign(Object.assign({},l),{marginLeft:"auto"}),dialogResizeIconStyle:{color:u.colors.BaseColor.Grey.Grey6,fontSize:u.fontSizes.Font1143,textAlign:"center"},dialogHeaderStyle:{display:_?"none":"flex",flexDirection:"row",backgroundColor:"white",borderBottom:u.borders.Border01,borderColor:"#E5E5E5",alignItems:"center",padding:"10px",paddingRight:h?void 0:"8px",paddingLeft:h?"8px":void 0,minHeight:"32px"},dialogTitleViewStyle:{flexGrow:0,overflow:"hidden",maxWidth:"75%"},dialogTitleTextStyle:{fontFamily:u.fontFamilies.Semibold,fontSize:u.fontSizes.Font16px,lineHeight:"26px",color:"#323130",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},dialogPageContainerStyle:{left:0,right:0,top:0,flexDirection:"column",flexGrow:1,overflow:"hidden",borderBottomLeftRadius:u.sizes.Measures.Measure015,borderBottomRightRadius:u.sizes.Measures.Measure015,height:"100%"}},t.dialogStyle=function(e,t,n,r){const a=Object.assign({},t);n&&n.height?a.height=n.height:a.height=r?"65%":j.a.height;n&&n.width?a.width=n.width:a.width=j.a.width;return a}(0,t.dialogStyle,n,f)}return t}}var T=n("FJpk"),N=n("FhVi"),A=n("6b+r"),D=n("H4dV");var R=n("YxC/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class x extends r.Component{constructor(e){super(e),this._toggleExpandMode=this._toggleExpandMode.bind(this),this.state={inExpandMode:!!this.props.dialogOptions&&this.props.dialogOptions.inExpandMode}}_renderHeader(){return r.createElement(_.a,{id:"defaultDialogChromeHeader",key:"defaultDialogChromeHeader",style:this.props.dialogHeaderStyle},this._renderTitleView(),this._renderResizeButtons(),this._renderCloseButton())}_renderTitleView(){return r.createElement(_.a,{id:"defaultDialogChromeTitleView",key:"defaultDialogChromeTitleView",style:this.props.dialogTitleViewStyle},this._renderTitleText())}_renderTitleText(){const e=this.props.title?this.props.title:"";return r.createElement(y.a,{style:this.props.dialogTitleTextStyle,tabIndex:this._isIE()?-1:void 0,id:"defaultDialogChromeTitle",testhooks:{id:"defaultDialogChromeTitle"},accessibilityLabel:e,semanticTag:"h1",key:"defaultDialogChromeTitle"},Object(A.b)(e)?this._getMultiLineHtml(e):e)}_renderResizeButtons(){const e=this.state.inExpandMode?this.props.contractDialogText:this.props.expandDialogText;return r.createElement(v.a,{key:"dialogResizeIconButton",style:this.props.dialogResizeIconButtonStyle,tabIndex:0,onClick:this._toggleExpandMode,accessibilityLabel:e,testhooks:{id:"dialogResizeIconButton"},title:e},r.createElement(O.b,{key:"dialogResizeIcon",type:this.state.inExpandMode?C.a.MiniContract:C.a.MiniExpand,style:this.props.dialogResizeIconStyle}))}_renderCloseButton(){return r.createElement(v.a,{id:"defaultDialogChromeCloseIconButton",key:"defaultDialogChromeCloseIconButton",style:this.props.dialogCloseIconButtonStyle,tabIndex:0,onClick:this.props.handleClose,accessibilityLabel:this.props.dialogCloseText,testhooks:{id:"dialogCloseIconButton"},title:this.props.dialogCloseText},r.createElement(O.b,{key:"defaultDialogChromeCloseIcon",type:C.a.Cancel,style:this.props.dialogCloseIconStyle}))}_renderPageContainer(){return r.createElement(_.a,{id:"dialogPageContainer",style:this.props.dialogPageContainerStyle},r.Children.only(this.props.children))}render(){let e=this.props.dialogStyle;return this.state.inExpandMode&&(e=Object.assign(Object.assign({},e),{width:"100%",height:"100%",maxWidth:"100%",maxHeight:"100%"})),r.createElement(_.a,{id:"defaultDialogChromeOuterContainer",key:"defaultDialogChromeOuterContainer",style:this.props.dialogOuterContainerStyle,labelledByElementId:"defaultDialogChromeTitle"},r.createElement(_.a,{id:"defaultDialogChromeView",key:"defaultDialogChromeView",style:e},this._renderHeader(),this._renderPageContainer(),this._renderAccessibilityComponent("defaultDialogChromeView")))}_renderAccessibilityComponent(e){return r.createElement(N.a,{key:"dialogAccessibility",rootElementId:e,isModal:!0,shouldManageFocus:!0,defaultFocusId:"defaultDialogChromeCloseIconButton"})}_toggleExpandMode(){this.setState({inExpandMode:!this.state.inExpandMode})}_isIE(){return D.a.getInstance().get_IsBrowserIE()}_getMultiLineHtml(e){const t=e.split("\n"),n=[t[0]];for(let e=1;e<t.length;e++)n.push(r.createElement("br")),n.push(t[e]);return r.createElement(r.Fragment,null,n)}}const M=Object(s.a)((function(){const e=P();return function(t,n){const r=e(t,{id:n.dialogId}),a=n.title&&Object(T.c)(n.title);return Object.assign(Object.assign({name:n.name,dialogId:n.dialogId,dialogOptions:n.dialogOptions,title:a},r),{dialogCloseText:Object(R.b)(t,"Button_Label_Close")||"Close",expandDialogText:Object(R.b)(t,"MainFormDialog_Expand_Button_Label")||"Enter full screen mode",contractDialogText:Object(R.b)(t,"MainFormDialog_Contract_Button_Label")||"Exit full screen mode"})}}),(function(e,t){return{handleClose:()=>{e(Object(S.e)(t.dialogId))}}}))(x);var F=n("voMr"),k=n("bUa6"),L=n("oT5e"),B=n("eIlw"),U=n("e9UD"),V=n("KOTC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function z({pageId:e,isProgressIndicatorActive:t,isMainPage:n}){var a;const i=!Object(s.d)(t=>Object(p.n)(t,e)),o=r.useContext(c.a).Router,l=Object(s.d)(t=>Object(L.b)(t,e));if(l.error)return r.createElement(k.a,{pageId:l.pageId});const u=o.getPage(e);if(u&&i){const t=o.getPageModuleInput(e),i=n&&null!=t&&null!=t.input&&null!=t.input.appshellmode?r.createElement(W,{pageId:e,router:o}):r.createElement(u,{key:e,id:e});return r.createElement(B.a,{key:e,pageId:e,pageType:null===(a=null==t?void 0:t.input)||void 0===a?void 0:a.pageType},i)}return r.createElement(U.a,{key:"progressIndicator",id:"boot-loading-indicator",progressType:"ring",active:null==t||t,displayDelay:1e3,style:{display:"flex"}})}function W({pageId:e,router:t}){return r.createElement(V.a,{loader:()=>n.e(43).then(n.bind(null,"eKGD")).then(e=>e.AppShellPage),props:{pageModuleInput:t.getPageModuleInput(e),page:t.getPage(e),router:t,currentPage:e}})}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class q extends r.Component{constructor(){super(...arguments),this._seeMoreStackRank=null}_getContainerStyle(){const e=this.props.isDialog?{position:"absolute",left:0,top:0,width:"100%",height:"100%",backgroundColor:this.props.dialogOptions.shadowColor?this.props.dialogOptions.shadowColor:"transparent"}:{position:"absolute",left:0,top:0};return this._seeMoreStackRank>0&&(e.zIndex=this._seeMoreStackRank),e}componentDidMount(){if(this.context&&this.context.MutationObserverHandler){const e=this.context.MutationObserverHandler,t=b.a.getInstance();this._observerTarget=new MutationObserver(()=>{t.scheduleMeasuringUpdate()});const n="DialogContainer__"+this.props.dialogId+"_popupContainer";e.addObserverTarget(this._observerTarget,n),t.scheduleMeasuringUpdate()}}componentWillUnmount(){this.context&&this.context.MutationObserverHandler&&this.context.MutationObserverHandler.removeObserverTarget(this._observerTarget)}_renderPageInstance(){const e={width:this.props.dialogOptions.width,height:this.props.dialogOptions.height,left:this.props.dialogOptions.left,right:this.props.dialogOptions.right,top:this.props.dialogOptions.top,bottom:this.props.dialogOptions.bottom,position:this.props.dialogOptions.position,opacity:this.props.dialogOptions.opacity,overflow:this.props.dialogOptions.overflow,backgroundColor:this.props.dialogOptions.backgroundColor,justifyContent:this.props.dialogOptions.shouldSupportRTL?"flex-end":void 0},t=this._getContainerStyle();return this.props.dialogOptions.useDefaultDialogChrome?r.createElement(h.a,{popupStyle:e,style:t,isDialogPopup:!0},r.createElement(M,{name:"MainPageDialogWrapper",dialogId:this.props.dialogId,dialogOptions:this.props.dialogOptions,title:this.props.title},r.createElement(z,{pageId:this.props.dialogId,key:this.props.dialogId}))):r.createElement(h.a,{popupStyle:e,style:t,isDialogPopup:!0},r.createElement(z,{pageId:this.props.dialogId,key:this.props.dialogId}))}render(){if(null===this._seeMoreStackRank&&(this._seeMoreStackRank=m.a.getInstance().getPopupCount()),this.props.dialogType===F.a.Native)return r.createElement(z,{pageId:this.props.dialogId,key:this.props.dialogId});const e="DialogContainer__"+this.props.dialogId,t=this.props.isDialog?this._renderPageInstance():null;return r.createElement(f.b,{id:e,tabIndex:-1},t)}}q.contextType=c.a;var H=n("I6RZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const G={opacity:.5,borderStyle:"solid",width:"100%",height:"100%",right:0,top:0,position:"absolute",openInNewWindow:!0};class K extends r.Component{componentDidMount(){this._toggleScrollOnIOS(),this._setAppShellAriaVisibility()}componentDidUpdate(){this._toggleScrollOnIOS(),this._setAppShellAriaVisibility()}_toggleScrollOnIOS(){this.props.stack.length>0?document.getElementById("shell-container").classList.add("modalDialogBackgroundScrollBlock"):document.getElementById("shell-container").classList.remove("modalDialogBackgroundScrollBlock")}_setAppShellAriaVisibility(){this.props.setAppShellAriaVisibility(this._topNodeId)}render(){const e=[];let t=!1;this._topNodeId=void 0;for(let n=this.props.stack.length-1;n>=0;n--){const a=this.props.stack[n],i=this.props.router.getPage(a),o=null!=i;i&&(e.unshift(r.createElement(q,{isDialog:o,dialogOptions:this.props.dialogOptions[a],dialogId:a,title:this.props.dialogTitles[a],key:a,dialogType:this.props.dialogFlags[a]})),t||(t=!0,this._topNodeId="DialogContainer__"+a+"_popupContainer"))}return 0===this.props.stack.length?null:r.createElement(_.a,null,e)}}K.displayName="DialogConductor";const Q=Object(s.a)((function(){let e=[],t={},n={},r={};return function(a){const i=Object(g.b)(a),o={},s={},c={};let l=!1;for(let e=0;e<i.length;e++){const t=i[e];n[t]&&n[t]===Object(p.c)(a,t)||(l=!0),o[t]=Object(p.c)(a,t)||G,s[t]=Object(p.e)(a,t),c[t]=Object(H.a)(a,t)}return(e!==i||l)&&(e=i,n=o,r=s,t=c),{stack:e,dialogOptions:n,dialogTitles:r,dialogFlags:t}}}))(K);var X=n("qUtK"),Y=n("Ziun"),J=n("3rse"),$=n("d6Hx"),Z=n("ZUus"),ee=n("4leG"),te=n("2bwe"),ne=n("ngeo"),re=n("tT9w");var ae=n("zzhk"),ie=n("uZvv"),oe=n("0FMG"),se=n("Knfm"),ce=n("GEbX"),le=n("wE9H"),ue=n("3cEW");class de extends r.Component{constructor(e){super(e),this.toggleSiteMap=this.toggleSiteMap.bind(this),this.closeSiteMap=this.closeSiteMap.bind(this),this.selectArea=this.selectArea.bind(this),this.keyDownHandler=this.keyDownHandler.bind(this),this._childContext={toggleSiteMap:this.toggleSiteMap,hiddenAction:this.props.hiddenAction,isInMobileModeForOct2019:this.props.isInMobileModeForOct2019}}_fetchSiteMapDescriptor(){this.props.fetchSiteMapDescriptor().catch(e=>{this.props.handleFetchError(e)})}componentDidMount(){this._fetchSiteMapDescriptor()}componentDidUpdate(e){if(e.isSiteMapOpened!==this.props.isSiteMapOpened){if(this.props.isSiteMapOpened)this._fetchSiteMapDescriptor();else{const e=document.getElementById($.g);e&&e.focus(),this.props.closeRecentItemsDropdown()}this.props.onToggle&&this.props.onToggle(this.props.isSiteMapOpened)}}toggleSiteMap(){this.props.togglePanelStateAction()}closeSiteMap(){this.props.isSiteMapOpened&&this.toggleSiteMap()}selectArea(e){this.props.setSelectedAreaId(e),this.props.isSiteMapOpened&&this.props.closeRecentItemsDropdown()}keyDownHandler(e){const t=e.target;switch(e.keyCode){case J.a.Enter:if(t.id===$.g)if(this.props.isSiteMapOpened){const e=document.getElementById($.f);e&&e.firstChild&&e.firstChild.focus()}else this.toggleSiteMap();break;case J.a.Escape:this.closeSiteMap()}}_renderSitemapPanel(){return this.props.navigationType===ce.a.MultiSession?r.createElement(V.a,{key:"sessionpanel",loader:()=>Promise.all([n.e(0),n.e(27),n.e(30),n.e(103)]).then(n.bind(null,"lq5R")).then(e=>e.SessionPanel),props:{}}):this.props.useRedesignedSitemap?r.createElement(V.a,{key:"sitemappanel",loader:()=>Promise.all([n.e(0),n.e(27),n.e(30),n.e(103)]).then(n.bind(null,"lq5R")).then(e=>e.SitemapPanel),props:{}}):r.createElement(V.a,{key:"navbar",loader:()=>Promise.all([n.e(30),n.e(86)]).then(n.bind(null,"nidR")).then(e=>e.ConnectedNavBar),props:{isOpened:this.props.isSiteMapOpened,toggleSiteMap:this.toggleSiteMap,areaId:this.props.selectedAreaId,selectArea:this.selectArea}})}render(){return this.props.navbarParam===Z.a.On?this.props.isInMobileModeForOct2019?r.createElement(c.b.Provider,{value:this._childContext},r.createElement(V.a,{key:"global-command-bar",loader:()=>Promise.all([n.e(0),n.e(4),n.e(7),n.e(66)]).then(n.bind(null,"jsLW")).then(e=>e.GlobalCommandBar),props:{cmdbarType:le.a.BrowserMobileSize}})):r.createElement(c.b.Provider,{value:this._childContext},r.createElement(_.a,{key:"siteMapView",onKeyDown:this.keyDownHandler},r.createElement(Y.c,{key:"top-bar-id",getIsDialogOpen:this.props.getIsDialogOpen,areaId:this.props.selectedAreaId}),this._renderSitemapPanel(),r.createElement(V.a,{key:"sitemap-recents-flyout-id",loader:()=>Promise.all([n.e(0),n.e(27),n.e(30),n.e(103)]).then(n.bind(null,"lq5R")).then(e=>e.SitemapRecentsFlyout),props:{isOpened:this.props.isSiteMapOpened,toggleSiteMap:this.toggleSiteMap}}))):null}}const pe=Object(s.a)((function(){return function(e){const t=Object(ee.e)(e),n=Object(ae.b)(e),r=Object(se.a)(e);return{navbarParam:t,useRedesignedSitemap:n,selectedAreaId:Object(ie.a)(e),navigationType:r,isSiteMapOpened:1===Object(ie.d)(e)}}}),(function(e){return{fetchSiteMapDescriptor:()=>e(Object(X.a)()),closeRecentItemsDropdown:()=>e(Object(te.b)()),setSelectedAreaId:t=>e(Object(oe.d)(t)),handleFetchError:t=>{e(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return{type:"Handle SiteMapDescriptor fetch error",sync:!0,execute({dispatch:t,getState:n},r){"0x"+ne.a.getHexErrorCodeFromInt(e.errorCode)===re.a?(r.TraceManager.getTracer($.l).warn("Failed to retrieve Site Map metadata: "+e.message),t(Object(re.b)(e,!0))):r.EventManager.ReportComponentFailure($.l,e,"Failed to retrieve Site Map metadata")}}}(t))},togglePanelStateAction:()=>e(Object(ue.b)())}}))(de);var ge=n("1S8a"),he=n("rwix");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function fe(){return r.createElement(he.a,null,r.createElement(V.a,{loader:()=>Promise.all([n.e(116),n.e(25),n.e(95)]).then(n.bind(null,"Aoj4")).then(e=>e.PerformanceInterfaceRoot)}))}fe.displayName="PerformanceInterfaceHook";var me=n("yRo8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function be(e){return r.createElement(he.a,null,r.createElement("button",{key:"offlineSyncButton",onClick:e.offlineSync,title:"Run offline sync",style:{float:"right",position:"absolute","z-index":9999,display:"flex","flex-direction":"row","text-align":"center"}},""))}be.displayName="OfflineSyncInterfaceHook";const _e=Object(s.a)(void 0,(function(e){return{offlineSync:()=>{e(Object(me.h)())}}}))(be);var ye=n("LzVy"),ve=n("sclX"),Se=n("lGbA"),Oe=n("Afz2");function Ce(e){const t=e.toastNotifications?Object.keys(e.toastNotifications):[];return a.createPortal(r.createElement(_.a,{key:"toastNotificationListRoot",id:"toastNotificationListRoot"},t.length>0?r.createElement(V.a,{key:"toastNotificationContainer",loader:()=>n.e(106).then(n.bind(null,"VWQk")).then(e=>e.ToastNotificationList)}):null,function(e){const t=e?Object.keys(e):[];return r.createElement(_.a,{key:"toastNotification_Accessibility",accessibilityLive:"assertive",role:Oe.a,style:{width:0,height:0,overflow:"hidden"}},t.length>0&&e[t[0]].props.message)}(e.toastNotifications)),document.body)}Ce.displayName="ToastNotificationContainer";const Ee=Object(s.a)(e=>({toastNotifications:Object(Se.c)(e)}))(Ce);var Ie=n("6eYz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function we(e){const t=e.popupNotifications?Object.keys(e.popupNotifications):[];return a.createPortal(r.createElement(_.a,{key:"popupNotificationListRoot",id:"popupNotificationListRoot",testhooks:{id:"popup-notification"}},t.length>0&&(i=t[0],r.createElement(V.a,{key:i,loader:()=>n.e(96).then(n.bind(null,"bmL+")).then(e=>e.PopupNotification),props:{id:i}})),function(e){const t=e?Object.keys(e):[];return r.createElement(_.a,{key:"popupNotificationListRoot_Accessibility",id:"popupNotificationListRoot_Accessibility",accessibilityLive:"assertive",style:{width:0,height:0,overflow:"hidden"}},t.length>0&&r.createElement(y.a,{id:t[0]},e[t[0]].props.title))}(e.popupNotifications)),document.body);var i}we.displayName="PopupNotificationList";const je=Object(s.a)(e=>({popupNotifications:Object(Ie.b)(e)}))(we);var Pe=n("n2e+"),Te=n("PrIm"),Ne=n("1SVz"),Ae=n("go4y"),De=n("Lyxw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Re={ContainerStyle:{display:"none"}};const xe=Object(s.a)((function(){return function(e,t){return{isSkypeFeatureEnabled:Object(De.b)(e,Ae.a.SkypeChannelFeatureName)}}}))((function(e){return e.isSkypeFeatureEnabled?r.createElement(_.a,{style:Re.ContainerStyle,id:Ae.a.ConversationManagerContainerId}):null}));var Me=n("SAYH"),Fe=n("i1f0"),ke=n("O7zD"),Le=n("74Tm"),Be=n("HfZT"),Ue=n("5Oca"),Ve=n("gvL4"),ze=n("Smta"),We=n("tJ+6");var qe=n("WPtp"),He=n("iZ7K"),Ge=n("KBcj"),Ke=n("7sMj"),Qe=n("+7Rg"),Xe=n("nJrx"),Ye=n("JEGW"),Je=n("ruPX"),$e=n("aOhN"),Ze=n("2YQW"),et=n("dHD5"),tt=n("P6DH"),nt=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const rt="record-set-navigator-list",at=Object(Xe.a)(),it=Object(Xe.a)();class ot extends r.Component{constructor(e){super(e),this._nextPageNumberOffset=0,this._navigateToGridClick=this._navigateToGridClick.bind(this),this._onCloseButtonClick=this._onCloseButtonClick.bind(this),this._onScrollList=this._onScrollList.bind(this)}componentDidUpdate(e){if(this._shouldDisplayNavigator()){const t=a.findDOMNode(this.refs[rt]);t&&t.addEventListener("scroll",this._onScrollList);const n=Math.floor(this.props.totalRecordCount/this.props.pageSize);this._nextPageNumberOffset=this.props.totalRecordCount%this.props.pageSize==0?n:n+1;const{id:r}=this.props.inputs;if(this.props.availableEntityRecords&&this.props.availableEntityRecords.length>0&&r)for(const e of Object.keys(this.props.availableEntityRecords)){const t=parseInt(e,10),n=lt(this.props.availableEntityRecords[t]);Me.a.equals(n,r)&&(this._currentRecordIndex=t,this._previousRecordIndex=t-1,this._nextRecordIndex=t>=this.props.availableEntityRecords.length?-1:t+1)}if(0!==this.props.navigatorOpenState&&t&&this._currentRecordIndex>-1&&0===e.navigatorOpenState){const e="__recordListItem"+this.props.availableEntityRecords[this._currentRecordIndex].identifier.id.guid,t=this.refs[e],n=a.findDOMNode(t),r=D.a.getInstance();n&&(r.get_isIPad()?n.parentElement.scrollTop=n.offsetTop-n.parentElement.offsetTop:n.scrollIntoView(),n.tabIndex=0,n.focus())}}const t=document.getElementById("collapseExpandBtn");0===this.props.navigatorOpenState&&t&&t.focus()}componentWillUnmount(){const e=a.findDOMNode(this.refs[rt]);e&&e.removeEventListener("scroll",this._onScrollList)}_shouldDisplayNavigator(){const e=this.props.entityDetails&&this.props.entityDetails.EntityLogicalName;return("queueitem"!==e||"queueitem"===e&&this.props.isRecordSetNavigatorEnabledForQueueItem)&&0!==this.props.navigatorOpenState&&this.props.availableEntityRecords&&Object.keys(this.props.availableEntityRecords).length>1&&!(!this.props.inputs||!this.props.inputs.recordSetQueryKey)}_onScrollList(){const e=a.findDOMNode(this.refs[rt]);e.clientHeight+e.scrollTop+30>=e.scrollHeight&&this._retrieveGridPage(!0)}_getEntityImageKey(e){return e+"_image"}_renderRecordListItems(){const e=this.props.entityDetails.PrimaryNameAttribute,t=this.props.entityDetails.PrimaryImageAttribute?Object(ke.a)(this.props.entityDetails.PrimaryImageAttribute,null,null):null,n=this.props.inputs,a=[];for(const i of this.props.availableEntityRecords){const o={entityTypeName:ct(i),id:lt(i),formId:n.formId,recordSetQueryKey:n.recordSetQueryKey},s=Me.a.equals(n.id,lt(i)),c=s?Object.assign(Object.assign({},this.props.recordListItemStyle),this.props.recordListItemSelectedStyle):this.props.recordListItemStyle,l=i.fields[e],u=l?l.value:"---",d="__recordListItem"+i.identifier.id.guid,p=t&&i.fields[t]?i.fields[t].value:void 0,g=Object.assign(Object.assign(Object.assign({},this.props.recordImageStyle),{textAlign:"center",fontWeight:"bold",textTransform:"uppercase"}),s?this.props.entityImageHoveredStyle:{}),h=i.fields[e]?i.fields[e].value:null,f=this.props.hasPrimaryImageField?r.createElement(Ke.a,{key:this._getEntityImageKey(d),ref:this._getEntityImageKey(d),alt:u,imageSrc:p,entityPrimaryField:h,style:g,hasPrimaryImageField:this.props.hasPrimaryImageField}):null,m=Object.assign(Object.assign({},this.props.recordPrimaryNameStyle),this.props.hasPrimaryImageField?{}:{maxWidth:"185px"});a.push(r.createElement(ze.a,{ref:d,id:d,key:"record"+i.identifier.id.guid,style:c,hoveredStyle:this.props.recordListItemHoverStyle,onKeyDown:this._onListItemKeyDown.bind(this,i.identifier.id,o),role:Oe.q,describedByElementId:s?d+"_link":"",accessibilityLabel:u,tabIndex:s?0:-1,onClick:this._onClick.bind(this,o)},r.createElement(_.a,{id:d+"_link",ref:d+"link",key:d+"link",style:this.props.recordListItemLinkStyle},f,r.createElement(_.a,{key:d+"_name_and_attributes",style:this.props.recordNameAttributeWrapperStyle},r.createElement(y.a,{key:d+"_name",style:m},u),this.renderFirstFieldForRecord(i)))))}return a}renderFirstFieldForRecord(e){const t=[],n=Object.assign(Object.assign({},this.props.recordFirstAttributeStyle),this.props.hasPrimaryImageField?{}:{maxWidth:"185px"});for(const a of this.props.firstField){const i=Object(qe.c)(e.fields[a])||"---";t.push(r.createElement(y.a,{key:e.identifier.id.guid+a,style:n},i))}return t}_onListItemKeyDown(e,t,n){n.keyCode===J.a.Enter?(n.preventDefault(),this.props.navigateTo(this.props.pageName,Object.assign(Object.assign({},t),this._getSelectedEntityInfo(t))),-1!==this.props.recordSetQueryKey.indexOf("activitypointer")&&this._retrieveGridPage(!1)):this._onContentInExpandStateKeyDown(n)}_escapeKeyDown(e){e.keyCode===J.a.Escape&&2===this.props.navigatorOpenState&&this.props.toggleRecordSetNavigatorCollapsedState(!0)}_onCloseButtonClick(e){this.props.toggleRecordSetNavigatorCollapsedState(0!==this.props.navigatorOpenState)}_onClick(e,t){t.preventDefault(),this.props.navigateTo(this.props.pageName,Object.assign(Object.assign({},e),this._getSelectedEntityInfo(e))),-1!==this.props.recordSetQueryKey.indexOf("activitypointer")&&this._retrieveGridPage(!1)}_retrieveGridPage(e){const t=[];let{entityTypeName:n}=this.props.inputs;if(this.props.hasPrimaryImageField&&this.props.entityDetails&&this.props.entityDetails.PrimaryImageAttribute){const e=Object(ke.a)(this.props.entityDetails.PrimaryImageAttribute,null,null);t.push(e)}const r=this.props.recordSetQueryKey&&this.props.recordSetQueryKey.split("-")[0];r&&("activitypointer"===r?n="activitypointer":"queueitem"===r&&(n="queueitem"));const a=this.props.recordSetQueryKey.replace(n,"").substring(1,37);this.props.retrieveGridPage(a,this._nextPageNumberOffset,e,t).then(t=>{e&&t&&t.lists&&t.lists[this.props.recordSetQueryKey]&&t.lists[this.props.recordSetQueryKey].records&&0!==t.lists[this.props.recordSetQueryKey].records.length&&this._nextPageNumberOffset++})}_getSelectedEntityInfo(e){return this.props.selectedEntityMap.find(t=>t.selectedEntityName===e.entityTypeName)}_renderViewTitle(){var e,t,n;const a=0===this.props.navigatorOpenState,i=null!==(n=null===(t=null===(e=this.props)||void 0===e?void 0:e.view)||void 0===t?void 0:t.title)&&void 0!==n?n:"",o=Object(R.c)(this.props.resourceStrings,Qe.a)+" "+Object(R.c)(this.props.resourceStrings,Qe.b),s=Object.assign(Object.assign({},this.props.closeButtonStyle),a?{display:"none"}:{}),c=Object(R.c)(this.props.resourceStrings,Qe.a);return r.createElement(_.a,{style:Object.assign(Object.assign({},this.props.viewTitleContainerStyle),a?{paddingLeft:0,paddingRight:0}:{}),key:"view-title-section"},r.createElement(v.a,{id:at,tabIndex:0,onClick:this._navigateToGridClick,style:this.props.viewTitleButtonStyle,accessibilityLabel:i,disabled:a},r.createElement(y.a,{style:this.props.viewTitleStyle,testhooks:{id:"headerTitle"}},i.toUpperCase())),r.createElement(v.a,{id:"rsnCloseButton",key:"rsnCloseButton",title:c,accessibilityLabel:o,onClick:this._onCloseButtonClick,style:s,disabled:a},r.createElement(O.b,{style:this.props.closeButtonSymbolStyle,id:it,type:C.a.Cancel,testhooks:{id:"recordSetNavCollapseIcon"}})))}_navigateToGridClick(e){this.props.navigateBack()}_renderContent(){const{entityTypeName:e}=this.props.inputs,t=e+" "+Object(R.c)(this.props.resourceStrings,Qe.b);return r.createElement(_.a,{id:"content-in-expand-state",style:Object.assign(Object.assign({},this.props.expandContentStyle),0===this.props.navigatorOpenState?{display:"none"}:{}),key:"content-in-expand-state"},r.createElement(Ve.a,{accessibilityLabel:t,key:"recordlist",style:this._transformRecordListStyle(),ref:rt,testhooks:{id:"recordSetNavList"},role:Oe.j},this._renderRecordListItems()))}_transformRecordSetContainerStyle(){return Object.assign(Object.assign(Object.assign({},this.props.recordSetNavContainer),2===this.props.navigatorOpenState?this.props.overlayStyle:{}),0===this.props.navigatorOpenState?{display:"none"}:{})}_transformRecordListContainerStyle(){return Object.assign(Object.assign({},this.props.recordListContainerStyle),0===this.props.navigatorOpenState?this.props.recordListContainerCollapseStyle:this.props.recordListContainerExpandStyle)}_transformRecordListStyle(){return Object.assign(Object.assign(Object.assign({},this.props.recordListStyle),{listStyleType:"none"}),0===this.props.navigatorOpenState?{display:"none"}:{})}_onContentInExpandStateKeyDown(e){if(0!==this.props.navigatorOpenState){const t=this.props.availableEntityRecords.length;if(e.keyCode===J.a.DownArrow){if(e.preventDefault(),this._nextRecordIndex>-1){const e="__recordListItem"+this.props.availableEntityRecords[this._nextRecordIndex].identifier.id.guid,n=this.refs[e],r=a.findDOMNode(n);r&&(r.scrollIntoView(),r.focus(),this._nextRecordIndex=this._nextRecordIndex+1>=this.props.availableEntityRecords.length?-1:this._nextRecordIndex+1,this._previousRecordIndex=-1===this._nextRecordIndex?t-2:this._nextRecordIndex-2)}}else if(e.keyCode===J.a.UpArrow&&(e.preventDefault(),this._previousRecordIndex>-1)){const e="__recordListItem"+this.props.availableEntityRecords[this._previousRecordIndex].identifier.id.guid,t=this.refs[e],n=a.findDOMNode(t);n&&(n.scrollIntoView(),n.focus(),this._nextRecordIndex=-1===this._nextRecordIndex?this.props.availableEntityRecords.length-1:this._nextRecordIndex-1,this._previousRecordIndex=this._nextRecordIndex-2)}}}_renderInternal(){if(!this._shouldDisplayNavigator())return null;const e=Object(R.c)(this.props.resourceStrings,Qe.b);return r.createElement(_.a,{id:"recordSetNavContainer",key:"recordSetNavContainer",style:this._transformRecordSetContainerStyle(),onKeyDown:this._escapeKeyDown.bind(this)},r.createElement(_.a,{accessKey:this.props.accessKey,id:"recordSetNav",key:"recordSetNav",style:this._transformRecordListContainerStyle(),role:Oe.p,accessibilityLabel:e,testhooks:{id:"recordSetNav"}},r.createElement(N.a,{key:"recordSetNavigatorAccessibility",rootElementId:"recordSetNav",shouldManageFocus:!1}),this._renderViewTitle(),this._renderContent()))}render(){const e=r.Children.only(this.props.children);if("entityrecord"===this.props.pageType){const t=2===this.props.navigatorOpenState?[e,this._renderInternal()]:[this._renderInternal(),e];return r.createElement(_.a,{style:this.props.rootStyle},t)}return e}}function st(e,t){const n=[];if(e&&e.grid&&e.grid.rows&&e.grid.rows.length>0){const r=e.grid.rows[0];if(r.cells){const e=r.cells;for(const r of e){if(n.length>=1)break;const e=r.name;e===t.PrimaryNameAttribute||r.isHidden||n.push(e)}}}return n}function ct(e){if("activitypointer"===e.identifier.etn)return e.fields.activitytypecode.value;if("queueitem"===e.identifier.etn){const t=e.fields&&e.fields.objectid,n=t&&t.reference;if(n)return n.etn}return e.identifier.etn}function lt(e){if("queueitem"===e.identifier.etn){const t=e.fields&&e.fields.objectid,n=t&&t.reference;if(n)return n.id}return e.identifier.id}ot.displayName="RecordSetNavigator";const ut=Object(s.a)((function(){let e=[],t=[],n=[],r=null,a=null,i=null;const o=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e=null,t=null,n=null,r=null;return function(a,i){var o;const s=Object(d.a)(a),c=Object(w.g)(a),l=Object(We.c)(a),u=Object(We.a)(a),p=null==u?void 0:u.Colors;return t===s&&r===l&&n===p||(t=s,r=l,n=p,e={rootStyle:{display:"flex",flexGrow:1,position:"relative",height:"inherit",width:"inherit"},recordSetNavContainer:{display:"flex",borderRightWidth:c?void 0:"1px",borderLeftWidth:c?"1px":void 0,borderStyle:"solid",borderRightColor:c?void 0:s.colors.BaseColor.Grey.Grey4,borderLeftColor:c?s.colors.BaseColor.Grey.Grey4:void 0,transition:"0.1s ease-in-out all","-webkit-overflow-scrolling":"touch"},recordListContainerStyle:{width:s.sizes.RecordSetNavigator.width,backgroundColor:l?null===(o=null==p?void 0:p.Palette)||void 0===o?void 0:o.Primary01:s.colors.BaseColor.White,flexGrow:1,display:"flex",flexDirection:"column",flexWrap:"nowrap",borderStyle:"none",boxShadow:"",transition:"0.1s ease-in-out all"},recordListContainerExpandStyle:{width:s.sizes.RecordSetNavigator.width,opacity:1},recordListContainerCollapseStyle:{width:0,opacity:0},expandContentStyle:{flex:"1 0 0px",flexDirection:"column",overflow:"hidden"},recordListStyle:{display:"block",overflow:"auto",flex:"1 0 0px",marginRight:c?void 0:s.sizes.Measures.Measure025,marginLeft:c?s.sizes.Measures.Measure025:void 0,paddingRight:c?void 0:"2px",paddingLeft:c?"2px":void 0},recordListItemStyle:{display:"flex",flexDirection:"row",cursor:"pointer",height:s.sizes.RecordSetNavigator.listItemHeight,minHeight:s.sizes.RecordSetNavigator.listItemHeight,borderBottom:s.borders.Border02},recordListItemHoverStyle:{backgroundColor:s.colors.BaseColor.Grey.Grey3||"#000080"},recordListItemSelectedStyle:{backgroundColor:s.colors.MainThemeColor.MainColor2.Fill||"#000080"},recordListItemLinkStyle:{display:"flex",width:"100%",height:"100%",color:s.colors.BaseColor.Black,textDecoration:"none",padding:"0",boxSizing:"border-box"},viewTitleContainerStyle:{height:s.sizes.Measures.Measure300,lineHeight:s.sizes.Measures.Measure300,verticalAlign:"middle",flexDirection:"row",justifyContent:"space-between",paddingRight:c?s.sizes.Measures.Measure150:s.sizes.Measures.Measure125,paddingTop:s.sizes.Measures.Measure100,paddingBottom:s.sizes.Measures.Measure100,paddingLeft:c?s.sizes.Measures.Measure125:s.sizes.Measures.Measure150},viewTitleButtonStyle:{color:s.colors.BaseColor.Grey.Grey7,height:s.sizes.Measures.Measure300,lineHeight:s.sizes.Measures.Measure300,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",borderStyle:"none",backgroundColor:"transparent",paddingLeft:0,padding:0},viewTitleStyle:{fontSize:s.fontSizes.Font100,color:s.colors.BaseColor.Grey.Grey7,textOverflow:"ellipsis",overflow:"hidden"},recordImageStyle:{height:s.sizes.Measures.Measure300,width:s.sizes.Measures.Measure300,color:s.colors.BaseColor.White,lineHeight:s.sizes.Measures.Measure300,borderRadius:s.sizes.Measures.Measure150,marginLeft:c?0:s.sizes.Measures.Measure150,marginTop:s.sizes.RecordSetNavigator.entityImageMarginTop,marginRight:c?s.sizes.Measures.Measure150:0},recordNameAttributeWrapperStyle:{display:"block",flexGrow:1,maxWidth:s.sizes.RecordSetNavigator.recordNameAttributeWrapperMaxWidth,marginLeft:c?void 0:s.sizes.Measures.Measure100,marginRight:c?s.sizes.Measures.Measure100:void 0,paddingTop:s.sizes.Measures.Measure100,paddingBottom:s.sizes.Measures.Measure100,paddingRight:c?void 0:s.sizes.Measures.Measure150,paddingLeft:c?s.sizes.Measures.Measure150:void 0,height:s.sizes.RecordSetNavigator.listItemHeight,lineHeight:s.sizes.RecordSetNavigator.listItemLineHeight,boxSizing:"border-box"},recordPrimaryNameStyle:{display:"block",color:s.colors.BaseColor.Black,fontFamily:s.fontFamilies.Regular,maxWidth:s.sizes.RecordSetNavigator.listItemTextMaxWidth,maxHeight:s.sizes.RecordSetNavigator.recordPrimaryNameMaxHeight,whiteSpace:"normal",overflow:"hidden",textOverflow:"ellipsis",height:"auto",lineHeight:s.sizes.RecordSetNavigator.listItemLineHeight},recordFirstAttributeStyle:{display:"block",color:s.colors.BaseColor.Black,maxWidth:s.sizes.RecordSetNavigator.listItemTextMaxWidth,lineHeight:s.sizes.RecordSetNavigator.listItemLineHeight,height:s.sizes.RecordSetNavigator.listItemLineHeight,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},navigateToGridTextStyle:{fontSize:s.fontSizes.Font100,color:s.colors.BaseColor.Blue.Blue3,fontFamily:s.fontFamilies.Semilight},closeButtonStyle:{cursor:"pointer",color:s.colors.BaseColor.Grey.Grey7,borderStyle:"none",backgroundColor:"transparent",height:s.sizes.Measures.Measure300,width:s.sizes.Measures.Measure300,lineHeight:s.sizes.Measures.Measure300,paddingRight:0,paddingLeft:0},closeButtonSymbolStyle:{height:"100%",width:"100%",textAlign:"center"},ariaDescribedByStyle:{display:"flex",width:"0px"},overlayStyle:{position:"absolute",height:"100%",boxShadow:s.shadows.Shadow01,borderWidth:0,left:c?void 0:0,right:c?0:void 0},entityImageHoveredStyle:{color:s.colors.BaseColor.White}}),e}}(),s=Object(R.h)();return function(c,l){const u=Object(d.a)(c).sizes.Breakpoints.DimensionXL,g=Object(Fe.jc)(c,l),h=Object(Fe.Lc)(c,l),f=Object(p.a)(c,l),m=Object(I.c)(c),b=o(c,l),_=f,y=g?Object(Ge.c)(c,new Me.a(g.replace(g.split("-")[0],"").substring(1,37)),_.isQueryMode&&_.isAdvancedFindView):null,v=y?y.entityLogicalName:"",S=Object(Ue.r)(c,g),O=s(c,Qe.c),C=Object(He.h)(c,v),E=f?f.pageType:a,w=Object(De.c)(c,nt.h),j=Object(De.c)(c,nt.Sc),P=Object(De.c)(c,nt.gd),T=j||P&&w;let N=0;if(Object(Le.a)(c)||(N=m&&m<u?2:1),E!==a&&(a=E),C!==r?(e=st(y,C),r=C):0===e.length&&null!=y?e=st(y,C):null!=g&&i!==g&&(e=st(y,C),i=g),0!==N){const a=function(e,t,n,r,a,i){const o=[],s=[];if(n){const c=[n.PrimaryNameAttribute];a&&"activitypointer"===a?c.push("activitytypecode"):a&&"queueitem"===a&&c.push("objectid");const l=Object(Ue.q)(e,t,1,c,!0);if(l&&l.length)for(const t of l){if(n&&n.PrimaryImageAttribute){const r=Object(ke.a)(n.PrimaryImageAttribute,null,null);t.fields[r]=Object(Ue.j)(e,t.identifier,r)}for(const n of r)t.fields[n]=Object(Ue.j)(e,t.identifier,n);const a=ct(t);if(!s.find(e=>e.selectedEntityName===a)){const t=Object(et.h)(a);s.push({selectedEntityName:a,selectedTabId:Object(Fe.wc)(e,i,t),selectedRelatedEntity:Object(tt.gb)(e,i,t)})}o.push(t)}}return{entries:o,map:s}}(c,g,r,e,v,l),i=a.entries;let o=!1;if(i.length!==t.length)o=!0;else for(let e=0;e<i.length;e++)if(!Object(Ze.e)(i[e].fields,t[e].fields)){o=!0;break}o&&(t=i),function(e,t){if(e.length!==t.length)return!0;for(const n in t){const r=t[n],a=e.find(e=>e.selectedEntityName===r.selectedEntityName);if(!a||r.selectedTabId!==a.selectedTabId||r.selectedRelatedEntity!==a.selectedRelatedEntity)return!0}return!1}(n,a.map)&&(n=a.map)}return{recordSetQueryKey:g,totalRecordCount:h,rootStyle:b.rootStyle,recordSetNavContainer:b.recordSetNavContainer,recordListContainerStyle:b.recordListContainerStyle,recordListContainerExpandStyle:b.recordListContainerExpandStyle,recordListContainerCollapseStyle:b.recordListContainerCollapseStyle,expandContentStyle:b.expandContentStyle,recordListStyle:b.recordListStyle,recordListItemStyle:b.recordListItemStyle,recordListItemHoverStyle:b.recordListItemHoverStyle,recordListItemSelectedStyle:b.recordListItemSelectedStyle,recordListItemLinkStyle:b.recordListItemLinkStyle,viewTitleContainerStyle:b.viewTitleContainerStyle,viewTitleButtonStyle:b.viewTitleButtonStyle,viewTitleStyle:b.viewTitleStyle,recordImageStyle:b.recordImageStyle,recordNameAttributeWrapperStyle:b.recordNameAttributeWrapperStyle,recordPrimaryNameStyle:b.recordPrimaryNameStyle,recordFirstAttributeStyle:b.recordFirstAttributeStyle,navigateToGridTextStyle:b.navigateToGridTextStyle,closeButtonStyle:b.closeButtonStyle,closeButtonSymbolStyle:b.closeButtonSymbolStyle,overlayStyle:b.overlayStyle,entityImageHoveredStyle:b.entityImageHoveredStyle,availableEntityRecords:t,inputs:f,entityDetails:C,view:y,pageSize:S,hasPrimaryImageField:C&&!!C.PrimaryImageAttribute,resourceStrings:O,firstField:e,navigatorOpenState:N,pageType:a,selectedEntityMap:n,isRecordSetNavigatorEnabledForQueueItem:T}}}),(function(e,t){return{retrieveGridPage:(t,n,r,a)=>e(Object(Be.f)(t,n,r,a)),toggleRecordSetNavigatorCollapsedState:t=>{e(Object(Ye.b)(t))},navigateBack:()=>{e(Object($e.b)())},navigateTo:(n,r)=>{e(Object(Je.a)(n,r,t.id))}}}))(ot);var dt=n("Qjw6"),pt=n("mlvZ"),gt=n("OEUm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function ht(){return r.createElement(he.a,null,r.createElement(V.a,{loader:()=>Promise.all([n.e(118),n.e(58)]).then(n.bind(null,"Pg0t")).then(e=>e.DeveloperConsole)}))}ht.displayName="DeveloperConsoleHook";var ft=n("rcL5"),mt=n("EY5k"),bt=n("LqfC"),_t=n("hBbW");var yt=n("5X+N");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class vt extends r.Component{constructor(e){super(e),this.onMeasuringMainPanel=this.onMeasuringMainPanel.bind(this),this.state={forcedSidePanelFlyout:!1}}componentDidMount(){this.props.sidePanelExpandButtonLabel&&this.props.sidePanelCollapseButtonLabel&&this.props.sidePanelLabel&&this.props.closeButtonLabel||this.props.retrieveResourceStrings([bt.j,bt.h,bt.k,_t.b.CLOSE_BUTTON_LABEL_ID])}render(){return r.createElement(_.a,{key:"panelManager",style:{display:"flex",height:"100%"},onMeasuring:this.onMeasuringMainPanel,isRequestedMeasuring:!0},this._renderMainPanel(),this._renderSidePanel())}onMeasuringMainPanel(e){const t=e<this.props.theme.sizes.Breakpoints.DimensionM;if(t!==this.state.forcedSidePanelFlyout&&(this.setState({forcedSidePanelFlyout:t}),t)){Object.keys(this.props.sidePanels).forEach(e=>{1===this.props.sidePanels[e].option.sidePanelState&&this.props.setPanelState(e,0)})}}_renderMainPanel(){return r.createElement(_.a,{key:"MainPanel",shouldReflow:!0,style:{position:"relative",display:"flex",height:"100%",flex:1,"max-width":"100%","flex-direction":"column",overflow:"hidden",order:0}},this.props.children)}_renderSidePanel(){const e=Object.keys(this.props.sidePanels);let t=-1;return e.map(e=>{const n=this.props.sidePanels[e],a=1===n.option.sidePanelPosition?-1:1;let i=!1;return 1===n.option.sidePanelPosition&&0===n.option.sidePanelState&&(t++,i=!0),r.createElement(V.a,{loader:()=>Object(yt.a)().then(e=>e.SidePanel),props:{router:this.props.router,flexOrder:a,forcedFlyout:this.state.forcedSidePanelFlyout,sidePanelId:e,sidePanelLabel:this.props.sidePanelLabel,sidePanelExpandButtonLabel:this.props.sidePanelExpandButtonLabel,sidePanelCollapseButtonLabel:this.props.sidePanelCollapseButtonLabel,closeButtonLabel:this.props.closeButtonLabel,leftCollapsedOrder:i?t:void 0},key:"sidePanelloader-"+n.sidePanelId})})}}const St=Object(s.a)((function(){return e=>({sidePanels:Object(ft.b)(e),sidePanelLabel:Object(R.b)(e,bt.k),sidePanelCollapseButtonLabel:Object(R.b)(e,bt.h),sidePanelExpandButtonLabel:Object(R.b)(e,bt.j),closeButtonLabel:Object(R.b)(e,_t.b.CLOSE_BUTTON_LABEL_ID),isRTL:Object(w.g)(e),theme:Object(d.a)(e)})}),(function(e,t){return{setPanelState:(t,n)=>{Object(yt.a)().then(r=>{e(r.setPanelOptions(t,{sidePanelState:n}))})},retrieveResourceStrings:t=>e(Object(mt.e)(t))}}))(vt);var Ot=n("/aHX"),Ct=n("RJiR"),Et=n("0kGT"),It=n("w1eR"),wt=n("GYEz"),jt=n("9eA9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Pt=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){try{const e=new jt.a(window.location.href).searchParams.get("useLocal");return e&&"false"!==e?"true"===e?"https://localfile.crm.dynamics.com/":`https://ucilocaldeployment.servicebus.windows.net/ucilcdp/${e}/`:null}catch(e){return null}}(),Tt=r.memo(()=>Object(s.d)(wt.a)===It.a.Browser?null:Pt?r.createElement(he.a,null,r.createElement(V.a,{loader:()=>n.e(74).then(n.bind(null,"XFb3")).then(e=>e.LocalDeploymentHandlerRoot),props:{localFileOrigin:Pt}})):void 0);var Nt=n("SEva"),At=n("MqQG"),Dt=n("CXmn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Rt="ApplicationShell",xt={display:"flex",flexDirection:"column",flex:"1",maxWidth:"100%",overflow:"hidden",height:"100%"},Mt={display:"flex",flexDirection:"row",height:"100%",maxWidth:"100%",flex:"1",overflow:"hidden"};function Ft(e){return e.platformType===ve.b.Native||e.viewportWidth<=e.smallBreakPoint}function kt(e){const t=e.isRTL,n=e.useRedesignedSitemap||e.isEmbedded||e.navbarParam!==Z.a.On||e.shouldHideSideBar?0:e.quickLaunchBarWidth,r=Ft(e);return Object.assign(Object.assign({},xt),{marginLeft:r||t?0:n,marginRight:!r&&t?n:0,overflow:"hidden",height:"100%",position:"relative"})}function Lt(e){return e===ve.b.Native?Object.assign(Object.assign({},xt),{flexDirection:"column"}):xt}const Bt=[];function Ut(e){if(!e)return!1;const t=e.tagName.toUpperCase();if("SCRIPT"===t||"LINK"===t)return!1;const n=e.getAttribute("aria-hidden");return!n||"true"!==n.toLowerCase()}function Vt(e,t){const n=["toastNotificationListRoot","popupNotificationListRoot",At.a];if(e){const e=[],r=document.getElementsByTagName("BODY")[0].children;for(let a=0;a<r.length;a++){const i=r.item(a);Ut(i)&&(!t||i.id!==t)&&n.indexOf(i.id)<0&&(i.setAttribute("aria-hidden","true"),e.push(i))}Bt.push(e)}else{const e=Bt&&Bt.pop();for(let t=0;e&&t<e.length;t++)e[t].removeAttribute("aria-hidden")}}class zt extends r.Component{constructor(e){super(e),this._childrenHiddenInAccessibilityTree=!1,this._dialogState={},this._setAppShellAriaVisibility=this._setAppShellAriaVisibility.bind(this),this._setAppShellContainerRef=this._setAppShellContainerRef.bind(this),this._toggleChildrenVisibilityInAccessibilityTree=this._toggleChildrenVisibilityInAccessibilityTree.bind(this),this._updateAppShellChildrenContainerRef=this._updateAppShellChildrenContainerRef.bind(this),this._setProgressIndicatorVisibility=this._setProgressIndicatorVisibility.bind(this),this._getIsDialogOpen=this._getIsDialogOpen.bind(this),this.state={isProgressIndicatorVisible:!1}}componentDidMount(){const e=this.context.MutationObserverHandler,t=b.a.getInstance();this._observerTarget=new MutationObserver(()=>{t.scheduleMeasuringUpdate()}),e.addObserverTarget(this._observerTarget)}componentWillUnmount(){this.context.MutationObserverHandler.removeObserverTarget(this._observerTarget)}_setAppShellAriaVisibility(e){this._topDialogId!==e&&(!e||this._dialogState[e]?Vt(!1,null):(Vt(!0,e),this._dialogState[e]=!0),this._topDialogId=e)}_setProgressIndicatorVisibility(e,t){e!==this.state.isProgressIndicatorVisible&&(Vt(e,t),this.setState({isProgressIndicatorVisible:e}),e||this.context.AccessibilityManager.redetermineFocusOnCurrentContext())}_toggleChildrenVisibilityInAccessibilityTree(e){if((e&&Ft(this.props))!==this._childrenHiddenInAccessibilityTree){this._childrenHiddenInAccessibilityTree=e;a.findDOMNode(this._applicationShellChildrenContainer).setAttribute("aria-hidden",e.toString())}}_getIsDialogOpen(){return null!=this._topDialogId}_setAppShellContainerRef(e){}_updateAppShellChildrenContainerRef(e){this._applicationShellChildrenContainer=e}_renderNavigationBar(){return r.createElement(pe,{key:"siteMap",hiddenAction:this._enableDevAndPerfTools,getIsDialogOpen:this._getIsDialogOpen,onToggle:this._toggleChildrenVisibilityInAccessibilityTree,isInMobileModeForOct2019:this.props.isInMobileModeForOct2019})}_enableDevAndPerfTools(){Object(pt.e)(),Object(gt.c)()}_renderDialogConductor(){if(this.props.router)return r.createElement(Q,{key:"dialogConductor",router:this.props.router,setAppShellAriaVisibility:this._setAppShellAriaVisibility})}_renderNotification(){return[r.createElement(Ee,{key:"ToastNotificationContainer"}),r.createElement(je,{key:"PopupNotificationContainer"})]}_renderAppProgressIndicator(){return r.createElement(Pe.b,{key:"globalAppProgressIndicatorRoot",setIsProgressIndicatorVisibile:this._setProgressIndicatorVisibility})}_renderConversationManagerContainer(){return r.createElement(xe,null)}_renderReconnectNotification(){return r.createElement(Ne.c,{key:"reconnect_notification_key"})}_renderPanelManager(){return r.createElement(St,{router:this.props.router},this._renderTabList(),this._renderRecordSet())}_renderTabList(){if(this.props.navigationType===ce.a.MultiSession)return r.createElement(V.a,{loader:()=>Object(Ot.b)().then(({TabList:e})=>e)})}_renderRecordSet(){const e=r.createElement(ut,{id:this.props.currentPage,key:"recordSetNav",pageName:dt.a.getName(),accessKey:"R",arialControls:"tab-section"},r.createElement(z,{pageId:this.props.currentPage,isProgressIndicatorActive:!this.state.isProgressIndicatorVisible,isMainPage:!0}));return this.props.navigationType===ce.a.MultiSession?r.createElement(_.a,{role:Oe.v,id:"tabcontent",style:{position:"relative",display:"flex",height:"100%",flex:1,"max-width":"100%","flex-direction":"column",overflow:"hidden",order:0}},e):e}_renderStackNavigator(){return r.createElement(Ct.j,{pageDefinitions:this.props.router.getPageDefinitions()})}_renderMainContent(){return r.createElement(_.a,{tabIndex:-1,key:"applicationShellChild",id:"mainContent",role:Oe.k,style:kt(this.props),accessibilityHidden:this._childrenHiddenInAccessibilityTree,ref:this._updateAppShellChildrenContainerRef},this._renderGlobalNotification(),this.props.isInMobileModeForOct2019?this._renderStackNavigator():this._renderPanelManager(),this.props.performanceUiEnabled&&r.createElement(fe,null),this.props.cacheEnabled&&r.createElement(_e,null),r.createElement(Tt,null),Object(gt.a)()&&r.createElement(ht,null))}_renderGlobalNotification(){return this.props.isBarNotificationEnabled||this.props.isInMobileModeForOct2019?null:r.createElement(Te.a,{key:"globalNotificationList"})}_renderGlobalBarNotification(){return this.props.isBarNotificationEnabled&&!this.props.isInMobileModeForOct2019?r.createElement(Nt.a,{name:"GlobalBarNotification",key:"globalbarnotification"},r.createElement(V.a,{key:"globalbarnotification",loader:()=>Promise.all([n.e(29),n.e(65)]).then(n.bind(null,"1dcX")).then(e=>e.GlobalBarNotification)})):null}_isEdge(){return D.a.getInstance().get_IsBrowserEdge()}render(){if(this.props.isInMobileModeForOct2019)return r.createElement(i.b,null,r.createElement(_.a,{key:"applicationShell",id:zt.displayName,style:Lt(this.props.platformType),ref:this._setAppShellContainerRef},r.createElement(Ct.g,null,this._renderReconnectNotification(),this._renderConversationManagerContainer(),this._renderMainContent(),this._renderDialogConductor(),this._renderNotification(),this._renderAppProgressIndicator(),this._renderNavigationBar())));if(this.props.renderHeaderAtBottom)return r.createElement(_.a,{key:"applicationShell",id:zt.displayName,style:Lt(this.props.platformType),ref:this._setAppShellContainerRef},this._renderGlobalBarNotification(),this._renderReconnectNotification(),this._renderConversationManagerContainer(),this._renderMainContent(),this._renderDialogConductor(),this._renderNotification(),this._renderAppProgressIndicator(),this._renderNavigationBar());const e=m.a.getInstance().getDisableScrollStyle()||!this._isEdge()?"forceNewStackContextInert":"forceNewStackContext";return r.createElement(_.a,{key:"applicationShell",id:zt.displayName,style:Lt(this.props.platformType),ref:this._setAppShellContainerRef,explicitStyles:e},this._renderNavigationBar(),this._renderGlobalBarNotification(),this._renderReconnectNotification(),this._renderConversationManagerContainer(),this.props.useRedesignedSitemap?r.createElement(_.a,{style:Mt},r.createElement(_.a,{id:o.a}),this._renderMainContent()):this._renderMainContent(),this._renderDialogConductor(),this._renderNotification(),this._renderAppProgressIndicator())}}zt.displayName=Rt;const Wt=Object(s.a)((function(e){const t=Object(se.a)(e),n=Object(l.c)(e),r=Object(l.h)(e),a=Object(d.a)(e),i=Object(u.f)(e),o=Object(ye.a)(e),s=Object(w.g)(e),c=Object(I.c)(e),p=a.sizes.Breakpoints.DimensionS,g=Object(ee.e)(e),h=Object(ge.b)(e),f=Object(ae.b)(e),m=Object(ee.c)(e),b=Object(Et.b)(e),_=Object(De.a)(e,nt.rb,nt.h),y=Object(Dt.h)(e);return{currentPage:n,error:r,performanceUiEnabled:i,quickLaunchBarWidth:a.sizes.NavbarHeight,platformType:o,isRTL:s,viewportWidth:c,smallBreakPoint:p,navbarParam:g,shouldHideSideBar:h,useRedesignedSitemap:f,navigationType:t,isEmbedded:m,isInMobileModeForOct2019:b,isBarNotificationEnabled:_,renderHeaderAtBottom:y}}))(zt);zt.contextType=c.a},l0Rp:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var r=n("SRlt"),a=n("NvOS"),i=n("Rckk"),o=n("VcAV"),s=n("g22U");function c(e,t,n){let r="",a=1;for(const i of n){if(i.serializationFailure)throw i.serializationFailure;r+="--"+t+"\n",r+="Content-Type: application/http\nContent-Transfer-Encoding: binary\n",r+="Content-ID: "+a+++"\n",r+="\n",r+=l(e,i),r+="\n"}return r+="--"+t+"--\n",r}function l(e,t){var n,a;let s=`${e}${r.c.WEB_API_URL_FRAGMENT}`;(!Object(o.b)(e)&&(null===(n=t.urlParameters)||void 0===n?void 0:n.startsWith(e))||(null===(a=t.urlParameters)||void 0===a?void 0:a.startsWith(r.c.WEB_API_URL_FRAGMENT)))&&(s="");let c=`${t.method} ${s}${t.urlParameters} HTTP/1.1\n`;for(const e in t.additionalHeaders)c+=`${e}: ${t.additionalHeaders[e]}\n`;return"GET"===t.method||t.additionalHeaders.hasOwnProperty(i.c.CONTENT_TYPE)||(c+="Content-Type: application/json;type=entry\n"),t.body&&(c+="\n"+t.body),c}function u(e,t){return{type:"SERIALIZE_EXECUTE_MULTIPLE_REQUEST",execute({dispatch:n,getState:r},a){t||(t="batch_"+(new Date).getTime());const i=a.DataSource.get_WebAPIService(),o=e.get_requests().map(e=>{const r=e.get_name(),a=i.requestSerializers[r];if(!a)return Promise.resolve({serializationFailure:`Current ExecuteMultiple request cannot be serialized, because inner ${r} request has no serializer associated with it`});return n(a(e,t))});return Promise.all(o).then(n=>{const a=n.filter(e=>e.serializationFailure);if(a.length)return{serializationFailure:"Failed to serialize some inner requests with the following errors: "+a.map(e=>e.serializationFailure).join("; ")};if(e.get_settings().get_continueOnError())return d(r(),n,t);let i=0,o=0;for(const e of n)"GET"===e.method?i++:o++;if(i>0)return o>0?{serializationFailure:"Failed to serialize some inner requests with the following errors: A mixture of GETs and POSTs cannot be run in an OData changeset"}:d(r(),n,t);const s=n;return d(r(),[s],t)})}}}function d(e,t,n){if(!t||!t.length)return{serializationFailure:"Attempted to create an OData batch with empty list of requests"};let r="";n||(n="batch_"+(new Date).getTime());const i=Object(a.a)(e,"");for(const e of t){r+="--"+n+"\n";let t="";if(Array.isArray(e)){const n=e,a="changeset_"+(new Date).getTime();t=c(i,a,n),r+=`Content-Type: multipart/mixed;boundary=${a}\n`}else{const n=e;if(n.serializationFailure)return n;t=l(i,n),r+="Content-Type: application/http\nContent-Transfer-Encoding: binary\n"}r+="\n",r+=t,r+="\n"}const o=`--${n}--\r\n\0`;r.endsWith(o+"\n")?r=r.substr(0,r.length-1):r+=o;return p(r,n)}function p(e,t){return{urlParameters:"$batch",additionalHeaders:{"Content-Type":"multipart/mixed;boundary="+(t=t||"batch_"+(new Date).getTime()),Accept:r.a},body:e,method:"POST",additionalParameters:{[s.a.TYPE]:s.c.Execution_Multiple,[s.a.SUB_TYPE]:s.b.ExecutionMultiple}}}},l3Ef:function(e,t,n){"use strict";n.d(t,"l",(function(){return r})),n.d(t,"Y",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"T",(function(){return o})),n.d(t,"n",(function(){return s})),n.d(t,"I",(function(){return c})),n.d(t,"H",(function(){return l})),n.d(t,"bb",(function(){return u})),n.d(t,"V",(function(){return d})),n.d(t,"W",(function(){return p})),n.d(t,"X",(function(){return g})),n.d(t,"p",(function(){return h})),n.d(t,"o",(function(){return f})),n.d(t,"M",(function(){return m})),n.d(t,"v",(function(){return b})),n.d(t,"E",(function(){return _})),n.d(t,"G",(function(){return y})),n.d(t,"w",(function(){return v})),n.d(t,"x",(function(){return S})),n.d(t,"j",(function(){return O})),n.d(t,"q",(function(){return C})),n.d(t,"s",(function(){return E})),n.d(t,"r",(function(){return I})),n.d(t,"g",(function(){return w})),n.d(t,"h",(function(){return j})),n.d(t,"i",(function(){return P})),n.d(t,"D",(function(){return T})),n.d(t,"z",(function(){return N})),n.d(t,"A",(function(){return A})),n.d(t,"u",(function(){return D})),n.d(t,"k",(function(){return R})),n.d(t,"J",(function(){return x})),n.d(t,"y",(function(){return M})),n.d(t,"F",(function(){return F})),n.d(t,"a",(function(){return k})),n.d(t,"K",(function(){return L})),n.d(t,"L",(function(){return B})),n.d(t,"Z",(function(){return U})),n.d(t,"d",(function(){return V})),n.d(t,"e",(function(){return z})),n.d(t,"c",(function(){return W})),n.d(t,"P",(function(){return q})),n.d(t,"S",(function(){return H})),n.d(t,"N",(function(){return G})),n.d(t,"B",(function(){return K})),n.d(t,"t",(function(){return Q})),n.d(t,"m",(function(){return X})),n.d(t,"ab",(function(){return Y})),n.d(t,"U",(function(){return J})),n.d(t,"f",(function(){return $})),n.d(t,"C",(function(){return Z})),n.d(t,"R",(function(){return ee})),n.d(t,"O",(function(){return te})),n.d(t,"Q",(function(){return ne}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="!",a="systemuser",i="activityattachment",o="syncerror__regardingentityid",s="create",c="modifiedon",l="modifiedby",u="versionnumber",d="RowVersion",p="statecode",g="statuscode",h="createdon",f="createdby",m="ownerid",b="firstname",_="lastname",y="middlename",v="fullname",S=[b,y,_],O="attributeLogicalname",C="EntityLogicalName",E="entitylogicalname",I="entityLogicalName",w="aliasedValueDescriptors",j="aliasedValueEtn",P="aliasedValueFieldName",T="LastDataSyncTime",N="InitialDataDownloadETAInMinutes",A="InitialDataDownloadStatus",D="entitysettings",R="attributeType",x="@odata.context",M="id",F="logicalname",k="name",L="objectid",B="objecttypecode",U="value",V="activityparty",z="activitypartyid",W="activityid",q="participationtypemask",H="partyid",G="owner",K="ispartydeleted",Q="entityreference",X="columns",Y="values",J="resolvedparties",$="activitytypecode",Z="isregularactivity",ee=[q,W,z,H,K,"partyobjecttypecode","addressused"],te={from:"1",to:"2",cc:"3",bcc:"4",requiredattendees:"5",optionalattendees:"6",organizer:"7",regarding:"8",owner:"9",resources:"10",customer:"11",partner:"12"},ne={1:"from",2:"to",3:"cc",4:"bcc",5:"requiredattendees",6:"optionalattendees",7:"organizer",8:"regarding",9:"owner",10:"resources",11:"customer",12:"partner"}},l48Q:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZoneActivitySummaryTransport=void 0;var r=function(){function e(){this._status={},this._retroactiveStopwatches={}}return e.prototype.reset=function(){this._status={}},e.prototype.getSummary=function(){var e=this,t=Object.keys(this._status),n=function(n){if(t.indexOf(n)<0){var a=r._retroactiveStopwatches[n];a.sort((function(e,t){return e.startTime<t.startTime?-1:e.startTime>t.startTime?1:0})),a.forEach((function(t){return e._trackActivity(n,t.startTime,t.duration)}))}},r=this;for(var a in this._retroactiveStopwatches)n(a);return this._retroactiveStopwatches={},Object.keys(this._status).reduce((function(t,n){return t[n]=Math.round(e._status[n].duration),t}),{})},e.prototype.writeMarker=function(){},e.prototype.writeRetroactiveTimespan=function(e,t,n){e.getZone()in this._status||(e.getZone()in this._retroactiveStopwatches||(this._retroactiveStopwatches[e.getZone()]=[]),this._retroactiveStopwatches[e.getZone()].push({startTime:t,duration:n}))},e.prototype.startTimespan=function(e,t){return this._trackActivity.bind(this,e.getZone(),t)},e.prototype._trackActivity=function(e,t,n){var r=t+n;if(e in this._status){var a=this._status[e];r>a.endTime&&(a.duration+=r-Math.max(t,a.endTime),a.endTime=r)}else this._status[e]={endTime:r,duration:n}},e}();t.ZoneActivitySummaryTransport=r},lEFU:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s}));var r=n("Tf+h");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,n,a){const i=function(e){return e&&e.personalizations?e.personalizations.controls:null}(e);if(!i)return null;const o=function(e,t){if(!t||!e[t])return null;return e[t]}(i,n);if(!t)return o;const{areaType:s}=t;return"form"===s?function(e,t,n){const{entityTypeName:a,recordGuid:i,formGuid:o,viewId:s="default",controlUniqueId:c}=t,l=i&&i.guid||r.c;if(!(a&&e[a]&&l&&e[a][l]&&o&&e[a][l][o.guid]&&c&&e[a][l][o.guid][c]&&s&&e[a][l][o.guid][c][s]))return null;const u=e[a][l][o.guid][c][s];if(u.hasOwnProperty(n))return u[n];return u[r.a]}(i,t,a)||o:"grid"===s?function(e,t,n){const{entityTypeName:a,viewId:i="default"}=t;if(!("grid"!==t.areaType||a&&e[a]&&i&&e[a][i]))return null;const o=e[a][i];if(o.hasOwnProperty(n))return o[n];return o[r.a]}(i,t,a)||o:"dashboard"===s?function(e,t,n){const{formGuid:a,viewId:i="default",controlUniqueId:o}=t;if(!(e[r.b]&&a&&e[r.b][a.guid]&&o&&e[r.b][a.guid][o]&&i&&e[r.b][a.guid][o][i]))return null;const s=e[r.b][a.guid][o][i];if(s.hasOwnProperty(n))return s[n];return s[r.a]}(i,t,a)||o:function(e,t,n){if(!e[n])return null;const a=e[n];if(a.hasOwnProperty(t))return a[t];return a[r.a]}(i,n,a)||o}function i(e,t){if(!(e&&e.personalizations&&e.personalizations.selectedForms&&t&&e.personalizations.selectedForms[t]))return null;return e.personalizations.selectedForms[t]||null}function o(e,t){const n=i(e,t);if(!n||!n.formId)return null;return n.formId||null}function s(e,t){const n=i(e,t);if(!n||!n.userEntityUISettingsId)return null;return n.userEntityUISettingsId||null}},lGbA:function(e,t,n){"use strict";function r(e){return e.toastNotifications}function a(e,t){return e.toastNotifications[t]}function i(e){const t=r(e);return t?Object.keys(t):[]}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}))},lJW1:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("HcnX"),a=n("1kth"),i=n("16wZ"),o=n("dHD5"),s=n("uxy2"),c=n("5d8d"),l=n("qshH"),u=n("NjDY"),d=n("ZIjf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const p="ClientApi.XrmControlSearchWidget.";let g;class h extends r.a{constructor(e,t,n,r,a,s){const c=p+"constructor";super(e,t,n,r,a,s),t||Object(i.j)(c,"contextToken"),e||Object(i.j)(c,"store"),g=e,this._searchWidgetToken=Object(o.n)(t,a)}setSearchQuery(e){const t=p+"setSearchQuery";try{d.a.instance.reportCall(t),g.dispatch(Object(s.d)(this._searchWidgetToken,e)),d.a.instance.reportSuccess(t)}catch(e){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}}getSearchQuery(){const e=p+"getSearchQuery";try{d.a.instance.reportCall(e);const t=Object(c.d)(this._searchWidgetToken,g.getState());return d.a.instance.reportSuccess(e),t}catch(t){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(e,t,null,n),t}}getSelectedResults(){const e=p+"getSelectedResults";try{d.a.instance.reportCall(e);const t=Object(c.e)(this._searchWidgetToken,g.getState()),n=this._kbrecordToKBSearchResult(t);return d.a.instance.reportSuccess(e),n}catch(t){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(e,t,null,n),t}}openSearchResult(e,t){const n=p+"openSearchResult";try{d.a.instance.reportCall(n);const t=Object(c.f)(this._searchWidgetToken,g.getState(),e-1);return 0===t||-1===t?(d.a.instance.reportSuccess(n),t):(g.dispatch(Object(s.b)(this.pageId,t,this._searchWidgetToken)),d.a.instance.reportSuccess(n),1)}catch(e){const t=l.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(n,e,null,t),e}}getTotalResultCount(){const e=p+"getTotalResultCount";try{d.a.instance.reportCall(e);const t=Object(c.g)(this._searchWidgetToken,g.getState());return d.a.instance.reportSuccess(e),t}catch(t){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(e,t,null,n),t}}changeSelectedMenuItem(e,t){const n=p+"changeSelectedMenuItem";Object(i.a)(e)&&Object(i.j)(n,"command"),Object(i.a)(t)&&Object(i.j)(n,"value");try{d.a.instance.reportCall(n),g.dispatch(Object(s.a)(this._searchWidgetToken,e,t)),d.a.instance.reportSuccess(n)}catch(e){const t=l.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(n,e,null,t),e}}getUseNativeCrm(){const e=p+"getUseNativeCrm";try{d.a.instance.reportCall(e);const t=!Object(u.x)(g.getState()).isParature;return d.a.instance.reportSuccess(e),t}catch(t){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(e,t,null,n),t}}setNumberOfResults(e){const t=p+"setNumberOfResults";try{d.a.instance.reportCall(t),g.dispatch(Object(s.e)(this._searchWidgetToken,e)),d.a.instance.reportSuccess(t)}catch(e){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}}setBlockResult(e){const t=p+"setBlockResult";try{d.a.instance.reportCall(t),g.dispatch(Object(s.c)(this._searchWidgetToken,e)),d.a.instance.reportSuccess(t)}catch(e){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}}addOnSelection(e){const t=p+"addOnSelection";e||Object(i.j)(t,"handler");try{d.a.instance.reportCall(t),g.dispatch(Object(a.p)(this._searchWidgetToken,this.pageId,e,this.name)),d.a.instance.reportSuccess(t)}catch(e){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}}removeOnSelection(e){const t=p+"removeOnSelection";e||Object(i.j)(t,"handler");try{d.a.instance.reportCall(t),g.dispatch(Object(a.K)(this._searchWidgetToken,this.pageId,e,this.name)),d.a.instance.reportSuccess(t)}catch(e){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}}addOnResultOpened(e){const t=p+"addOnResultOpened";e||Object(i.j)(t,"handler");try{d.a.instance.reportCall(t),g.dispatch(Object(a.n)(this._searchWidgetToken,this.pageId,e,this.name)),d.a.instance.reportSuccess(t)}catch(e){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}}removeOnResultOpened(e){const t=p+"removeOnResultOpened";e||Object(i.j)(t,"handler");try{d.a.instance.reportCall(t),g.dispatch(Object(a.I)(this._searchWidgetToken,this.pageId,e,this.name)),d.a.instance.reportSuccess(t)}catch(e){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}}addOnPostSearch(e){const t=p+"addOnPostSearch";e||Object(i.j)(t,"handler");try{d.a.instance.reportCall(t),g.dispatch(Object(a.h)(this._searchWidgetToken,this.pageId,e,this.name)),d.a.instance.reportSuccess(t)}catch(e){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}}removeOnPostSearch(e){const t=p+"removeOnPostSearch";e||Object(i.j)(t,"handler");try{d.a.instance.reportCall(t),g.dispatch(Object(a.C)(this._searchWidgetToken,this.pageId,e,this.name)),d.a.instance.reportSuccess(t)}catch(e){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}}getControlType(){return d.a.instance.reportUsage(p+"getControlType"),"kbsearch"}_kbrecordToKBSearchResult(e){if(!e)return null;try{return{answer:e.content,articleId:e.articlePublicNumber+"_"+e.knowledgeArticleId,articleUid:e.knowledgeArticleId,attachmentCount:0,createdOn:e.createdon,expiredDate:e.expirationdate,folderHref:"",href:"",isAssociated:e.hasOwnProperty("articleActions")?!e.articleActions.find(e=>0===e):e.isAssociated,lastModifiedOn:e.modifiedOn,publicUrl:this._getKmExternalPortalUrl(e.articlePublicNumber),published:3===e.stateCode,question:e.title,rating:e.rating,searchBlurb:e.content,serviceDeskUri:"",timesViewed:e.knowledgeArticleViews}}catch(e){const t=l.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure("ClientApi.XrmControlSearchWidget._kbrecordToKBSearchResult",e,null,t),e}}_getKmExternalPortalUrl(e){try{const t=g.getState().organization.organizationSettings.kmExternalPortalUrl;return t.replace("{kbnum}",e)}catch(e){const t=l.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure("ClientApi.XrmControlSearchWidget._getKmExternalPortalUrl",e,null,t),e}}}},lKf0:function(e,t,n){"use strict";n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return f})),n.d(t,"m",(function(){return r})),n.d(t,"k",(function(){return a})),n.d(t,"l",(function(){return m})),n.d(t,"g",(function(){return b})),n.d(t,"f",(function(){return i})),n.d(t,"i",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"h",(function(){return u})),n.d(t,"o",(function(){return c})),n.d(t,"n",(function(){return l}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="ServerUnavailableNotification_Message",a="L_Reconnect_Text",i="Boot_Notification_Button_Text",o="Legacy_App_Present_Notification_Text",s="Legacy_App_Running_Notification_Text",c="Update_Mobile_Application_Notification_Text",l="Update_Mobile_Application_Button_Text",u="Kitchen_Sink_App_Running_Notification_Text",d="App_Less_Mode_Notification_Text",p="App_Less_Mode_Notification_Button_Text",g="appid",h="app",f="apps",m=["ServerUnavailableNotification_Title",r,a],b=[i,l,o,s,c,u,d,p]},lMS8:function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return p}));var r=n("bvqZ"),a=n("YxC/"),i=n("EY5k"),o=n("eq9I"),s=n("E5IU");function c(e=!1){return{type:"offline.date.update.completed.notification",sync:!0,execute({dispatch:t,getState:n},r){t(Object(i.e)([o.m,o.h])).then(()=>{const r=e?Object(a.b)(n(),o.h):Object(a.b)(n(),o.m);g(t,1,r,e?o.h:o.m)})}}}function l(e=!1){return{type:"offline.trigger.first.time.sync.complete.notification",sync:!0,async execute({dispatch:t,getState:n},r){const c=Object(s.o)(n()),l=e?o.h:c?o.j:o.i;await t(Object(i.e)([l]));g(t,1,Object(a.b)(n(),l),l)}}}function u(){return{type:"offline.trigger.first.time.request.apply.application.metadata.change.notification",sync:!0,execute({dispatch:e,getState:t},n){e(Object(i.e)([o.n])).then(()=>{const n=Object(a.b)(t(),o.n);g(e,3,n,o.n)})}}}function d(e){return{type:"offline.trigger.file.sync.completed.notification",sync:!0,execute({dispatch:t,getState:n},r){t(Object(i.e)([o.f,o.g])).then(()=>{const r=e?Object(a.b)(n(),o.g):Object(a.b)(n(),o.f);g(t,e?2:1,r,e?o.g:o.f)})}}}function p(){return{type:"offline.metadata.download.notification.async",async execute({dispatch:e,getState:t}){const r=[o.l,o.b];await e(Object(i.e)(r));const s=Object(a.b)(t(),o.l),c=Object(a.b)(t(),o.b),{openOfflineStatusDialogAction:l}=await n.e(39).then(n.bind(null,"rrts")),{removeToastNotification:u}=await n.e(39).then(n.bind(null,"sHzf")),d={actionLabel:c,eventHandler:()=>{e(l()),e(u(o.l))}};g(e,4,s,o.l,d)}}}function g(e,t,n,a,i){if(t&&n){const o={id:a,level:t,message:n,title:null,type:1,onCloseHandler:null,action:i};e(Object(r.b)(o))}}},lPW2:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e._BT_STOP=0]="_BT_STOP",e[e._BT_STOP_BASE=1]="_BT_STOP_BASE",e[e._BT_BOOL=2]="_BT_BOOL",e[e._BT_DOUBLE=8]="_BT_DOUBLE",e[e._BT_STRING=9]="_BT_STRING",e[e._BT_STRUCT=10]="_BT_STRUCT",e[e._BT_LIST=11]="_BT_LIST",e[e._BT_MAP=13]="_BT_MAP",e[e._BT_INT32=16]="_BT_INT32",e[e._BT_INT64=17]="_BT_INT64"}(t._BondDataType||(t._BondDataType={}))},lR0U:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return d}));var r=n("84PK"),a=n("504W"),i=n("l3Ef"),o=n("bRS5");let s=null;function c(e){s=e}function l(e,t){if(!s)return new Array(0);const n=[];if(Object(o.d)(t))if(s.isComplexAttribute(t)){const r=s.getAttributeColumnNames(t),a=e+i.l;for(const e of r)n[n.length]=a+e}else n[n.length]=e;return n}function u(e,t){const n={};for(const t in e)n[t]=l(t,e[t]);return n}function d(e,t,n){if(!s)return{};const o={},c=function(e,t){let n={};if(Object(a.a)(t))return n;switch(e){case"owner":case"lookup":case"customer":n=t.getObjectData();break;case"picklist":case"boolean":case"state":case"status":case"aliasedvalue":case"partylist":case"uniqueidentifier":n=t.getObjectData()}return n}(t,n);if(s.isComplexAttribute(t)){const n=s.getAttributeMap(t).get_columnNameTypeMap();for(const t of Object.keys(n))n[t]===r.a?o[e+i.l+t]=t in c?r.a.createFromObjectData(c[t]).toString().toUpperCase():"":o[e+i.l+t]=t in c?c[t]:""}else switch(t){case"status":case"state":case"boolean":o[e]=Object(a.a)(c[i.Z])?-1:c[i.Z];break;case"uniqueidentifier":o[e]=Object(a.a)(n)||Object(a.b)(n.toString())?"":n.toString().toUpperCase();break;case"datetime":o[e]=Object(a.a)(n)?"":n.toISOString();break;case"partylist":break;case"picklist":o[e]=Object(a.a)(c[i.Z])?null:c[i.Z];break;default:o[e]=n}return o}},"lY/Z":function(e,t,n){"use strict";n.d(t,"b",(function(){return F})),n.d(t,"a",(function(){return k})),n.d(t,"d",(function(){return L})),n.d(t,"g",(function(){return W})),n.d(t,"e",(function(){return B})),n.d(t,"c",(function(){return V})),n.d(t,"f",(function(){return U}));var r=n("SAYH"),a=n("odYE"),i=n("eXjw"),o=n("Uv1Y"),s=n("1qQb"),c=n("y60j"),l=n("5Oca"),u=n("k1f1"),d=n("rodW"),p=n("AFlp"),g=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function h(e,t){if(Object(g.a)(t))return!1;if(Object(g.a)(e)||Object(g.a)(e.fields))return!0;const n=function(e,t){const n="activestageid",r=t.getValue(n),a=e.fields[n]&&e.fields[n].reference&&e.fields[n].reference.id?e.fields[n].reference.id.guid:null;if(r.Id.toString()!==a)return!0;return!1}(e,t),r=function(e,t){const n="traversedpath",r=t.getValue(n),a=e.fields[n]?e.fields[n].value:null;if(r!==a)return!0;return!1}(e,t),a=function(e,t){const n="businessprocessflowinstanceid",r=t.getValue(n),a=e.fields[n]&&e.fields[n].id?e.fields[n].id.guid:null;if(r.toString()!==a)return!0;return!1}(e,t),i=function(e,t){const n="processid",r=t.getValue(n),a=e.fields[n]&&e.fields[n].reference&&e.fields[n].reference.id?e.fields[n].reference.id.guid:null;if(r.Id.toString()!==a)return!0;return!1}(e,t),o=function(e,t){const n="statecode",r=t.getValue(n)?t.getValue(n).get_ValueString():null,a=e.fields[n]?e.fields[n].valueString:null;if(r!==a)return!0;return!1}(e,t),s=function(e,t){const n="statuscode",r=t.getValue(n),a=e.fields[n];if(r)return!a||a.valueString!==r.get_ValueString();return!1}(e,t),c=function(e,t){const n=t.get_fieldNames(),r=[];for(const t in e.fields)e.fields.hasOwnProperty(t)&&r.push(t);if(n.length!==r.length)return!0;for(let n=0;n<r.length;n++){const a=r[n];if(a&&0===a.indexOf("bpf_")){const n=e.fields[a],r=t.getValue(a);if(null!=n)if(null!=n.value){if(n.value!==r)return!0}else if(null!=n.reference&&null!=r){if(n.reference.id.guid!==r.Id.toString())return!0}}}return!1}(e,t);return n||r||a||i||o||s||c}var f=n("3mEc"),m=n("LbMF"),b=n("nxXM"),_=n("NjDY"),y=n("quej"),v=n("pEXn"),S=n("w1eR"),O=n("4r2D"),C=n("tZZc"),E=n("XvL5"),I=n("UyLX"),w=n("/oKV"),j=n("d+dp"),P=n("5qiD"),T=n("iZ7K"),N=n("ZPAw"),A=n("8nT0"),D=n("Lyxw"),R=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class x{constructor(e,t){this._relationShipName=null,this._columnNames=null,this._relationShipName=e,this._columnNames=t}get_relationShipName(){return this._relationShipName}get_columnNames(){return this._columnNames}}var M=n("69Qu");const F="recordData.retrieve",k="recordData.refresh";function L(e,t,n,s,c){const u=[];return{type:"recordData.retrieve.async",execute({dispatch:d,getState:p},g){const h=p(),f=new O.a(r.a.newGuid().guid);u.push({name:v.b.ClientRequestId,value:f&&f.RequestId?f.RequestId():null});const m=Object(l.b)(e)(h,e.etn),_=Object(l.v)(h,e),y=m&&Object(i.b)(_);if(s)for(const t of s){const n=t.navigationProperty,r=Object(T.w)(h,e.etn,n);if(r&&"imagedescriptor"===r.ReferencedEntity){const e=["imagedescription","fullimageurl","imagepixelwidth","imagepixelheight","filesizebytes","fullimagedata","mimetype","filename"];t.columnNames=t.columnNames.concat(e),t.columnNames=t.columnNames.filter((e,t,n)=>t===n.indexOf(e))}}if(!t||!t.length)return Promise.resolve();d(function(e,t){const n={entities:{[e.etn]:{[r.a.toString(e.id)]:{initialized:t?i.a.Refreshing:i.a.Initializing}}}};return{type:F,payload:n}}(e,y));const S=g.DataSource,E=S.get_EventManager();return new Promise((i,l)=>{E.addRetrievedHandlerRecord(r.a.toString(e.id),function(e,t,n,r,i,s,c){const l=(u,d)=>{if(d.get_retrieveState()===C.a.Success){const u=d.get_data();if(u){const n=u.get_columnSet();if(n&&!function(e,t){const n=e.get_Columns();return t.filter(e=>-1===n.indexOf(e)).length<=0}(n,s))return;const o=u.get_identifier(),p=a.a.fromLegacyEntityReference(o),g=u.get_globalNavigationData();let h=null;if(null!=g){const t=g.get_identifier();null!=e&&null!=e.data&&null!=e.data.entities&&null!=e.data.entities[t.LogicalName]&&null!=e.data.entities[t.LogicalName][t.Id.toString()]&&(h=e.data.entities[t.LogicalName][t.Id.toString()])}r(W(p,u)),q(h,p,u,r,d.get_sourceStore()===I.a.Remote&&c),r(Object(b.c)([p])),d.get_sourceStore()===I.a.Remote&&i.deleteRetrievedHandlerRecord(o.get_identifier(),l),t(null)}else n(new o.a("DataSource retrieval completed with empty data."))}};return l}(h,i,l,d,E,t,!!n)),z(S,e,t,n,s,f,c).catch(e=>{l(e)})})},getFailureParameters:(e,t)=>u}}function B(e,t,n,a,i){return{type:"recordRecordData.forForm.async",execute({dispatch:o,getState:s},l){if(!r.a.isNullOrEmpty(e.id)&&!r.a.isNullOrEmpty(t)){const r=s(),u=Object(c.y)(r,t),d=new Set(u),p=Object(c.j)(r,t);if(i){const t=Object(m.h)(r,e.etn);if(t){const n=Object(m.a)(r,e.etn,t);(n&&n.IsRetrievable||r.clientHost&&r.clientHost.type===S.a.MailApp&&p&&6===p.FormType)&&d.add(t)}}if(a)for(const e of a)d.add(e);const g=Object(f.d)(r,p.FormLibraries,[e.etn]);if(g)for(const e of g)d.has(e)||d.add(e);const h=Array.from(d),b=l.TraceManager.getTracer("Forms.LargeImageFileAttribute"),_=function(e,t,n,r){let a=null;const i=Object(D.c)(e,R.Wb)&&Object(D.c)(e,R.nb),o=Object(D.c)(e,R.Yb)&&Object(D.c)(e,R.nb);if(i||o){const s=Object(m.f)(e,t.etn,"file"),c=Object(m.f)(e,t.etn,"image"),l={file:e=>i&&s&&s.hasOwnProperty(e),image:e=>o&&c&&c.hasOwnProperty(e)};for(let e=0;e<n.length;e++){const i=["file","image"].find(t=>l[t](n[e]));if(i){const o=Object(N.a)(t,n[e],i);null===a&&(a=[]);const s="Attribute type file/image attribute was added to the form.";r&&r.info(s),"file"===i?a.push({navigationProperty:o,columnNames:[A.h,A.f,A.p,A.s]}):a.push({navigationProperty:o,columnNames:[A.g,A.f,A.p,A.i,A.k,A.m,A.l,A.b,A.o,A.n]})}}}return a}(r,e,h,b),y=Object(M.b)(r)?w.a.Remote:void 0;return o(L(e,h,n,_,y))}return Promise.resolve()}}}function U(e){return{type:"recordRecordData.forOrg.async",execute({dispatch:t,getState:n},a){const i=Object(_.y)(n()),o={etn:"organization",id:i.organizationId};let s=Object(f.d)(n(),e,[o.etn]);s=Array.from(new Set(s));const c=Object(l.h)(n(),"organization",r.a.toString(i.organizationId));if(s&&s.length>0){const e=[];for(let t=0;t<s.length;t++)c&&c.fields&&c.fields.hasOwnProperty(s[t])||e.push(s[t]);if(e.length>0)return t(L(o,e)).catch(e=>{if(-2147093999===e.errorCode)return Promise.resolve();Promise.reject(e)});t(Object(b.c)([c.identifier]))}return Promise.resolve()}}}function V(e,t,n,a){const o=[];return{type:"recordData.refresh.async",execute({dispatch:c,getState:l},u){if(t&&t.length){const d=new O.a(r.a.newGuid().guid);o.push({name:v.b.ClientRequestId,value:d&&d.RequestId?d.RequestId():null}),c(function(e){const t={entities:{[e.etn]:{[r.a.toString(e.id)]:{initialized:i.a.Refreshing}}}};return{type:k,payload:t}}(e));return function(e,t,n,r,a,i){return z(e,t,n,i,r,a,w.a.Remote)}(u.DataSource,e,t,a,d,n).then(t=>{let n=null;const a=t.get_globalNavigationData();if(null!=a){const e=a.get_identifier(),t=l();null!=t.data.entities[e.LogicalName]&&null!=t.data.entities[e.LogicalName][e.Id.toString()]&&(n=t.data.entities[e.LogicalName][e.Id.toString()])}c(function(e,t){const n={entities:{[e.etn]:{[r.a.toString(e.id)]:Object(s.a)(t)}}};return{type:k,payload:n}}(e,t));const i=[];i.push(e),c(Object(b.c)(i)),q(n,e,t,c,!1)})}return Promise.resolve()},getFailureParameters:(e,t)=>o}}function z(e,t,n,r,i,s,c){const l=a.a.toLegacyEntityReference(t),u=new E.a(n),d=i?i.map(e=>new x(e.navigationProperty,e.columnNames)):null,p=new j.a(P.a.Workspace,null!=c?c:w.a.LocalAndRemote);return e.retrieveRelatedEntities(l,u,u,null,p,s,r,d).then(e=>{const t=e.get_fieldNames(),r=n.filter(e=>-1===t.indexOf(e));return r.length&&r.forEach(t=>e.initializeValue(t,null,"unknown")),e}).nativePromise().catch(o.b)}function W(e,t){const n={entities:{[e.etn]:{[r.a.toString(e.id)]:Object(s.a)(t)}}};return{type:F,payload:n}}function q(e,t,n,i,o){const s=n.get_globalNavigationData();if(s){const n=a.a.fromLegacyEntityReference(s.get_identifier());i(W(n,s)),i(Object(u.b)(n.id,t)),h(e,s)&&(i(Object(d.b)(!0,t)),i(Object(y.b)(t)));const r=[],o=new a.a(n.etn,n.id);r.push(o),i(Object(b.c)(r));const c=s.getValue("processid");if(c){const e=a.a.fromLegacyEntityReference(c);i(Object(p.b)(e.id,t))}}else o&&(i(Object(u.b)(r.a.EMPTY,t)),i(Object(p.b)(r.a.EMPTY,t)),h(e,s)&&i(Object(d.b)(!0,t)))}},lYcl:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("JDi5"),a=n("ruPX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t,n){const i={searchText:e,searchType:t};return Object(a.a)(r.a,i,n)}},lcRi:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the Benchmark page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Benchmark"},lcrw:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){return e[t]}function a(e,t){let n=0,r=!1;for(let a=0,i=e.length;a<i;a++){const i=e.charAt(a);switch(i){case"'":r?t.append("'"):n++,r=!1;break;case"\\":r&&t.append("\\"),r=!r;break;default:t.append(i),r=!1}}return n}function i(e,t){t||(t="F");const n=t.length;if(1===n)switch(t){case"d":return r(e,"ShortDatePattern");case"D":return r(e,"LongDatePattern");case"t":return r(e,"ShortTimePattern");case"T":return r(e,"LongTimePattern");case"f":return`${r(e,"LongDatePattern")} ${r(e,"ShortTimePattern")}`;case"F":return r(e,"FullDateTimePattern");case"M":case"m":return r(e,"MonthDayPattern");case"s":return r(e,"SortableDateTimePattern");case"Y":case"y":return r(e,"YearMonthPattern");default:throw Error("Sys.Res.formatInvalidString")}else 2===n&&"%"===t.charAt(0)&&(t=t.charAt(1));return t}function o(e,t){if(!t)return 0;let n;const r=e.getTime();for(let e=0;t[e];e+=4)if(n=t[e+2],null===n||r>=n)return e;return 0}function s(e,t,n,a){let i=e.getFullYear();return!a&&r(t,"eras")&&(i-=r(t,"eras")[n+3]),i}function c(e){return e.split("").join(" ").toUpperCase()}function l(e){const t=[];for(let n=0,r=e.length;n<r;n++)t[n]=c(e[n]);return t}function u(e,t,n){const r=c(e);let a=t.indexOf(r);return-1===a&&(a=n.indexOf(r)),a}function d(e,t){return u(t,l(e.dateTimeFormat.MonthNames),l(e.dateTimeFormat.MonthGenitiveNames))}function p(e,t){return u(t,l(r(e.dateTimeFormat,"AbbreviatedMonthNames")),l(r(e.dateTimeFormat,"AbbreviatedMonthGenitiveNames")))}function g(e,t){return l(r(e.dateTimeFormat,"DayNames")).indexOf(c(t))}function h(e,t){return l(r(e.dateTimeFormat,"AbbreviatedDayNames")).indexOf(c(t))}function f(e,t){const n=new Date,a=o(n,r(e,"eras"));if(t<100){const i=s(n,e,a);(t+=i-i%100)>r(r(e,"Calendar"),"TwoDigitYearMax")&&(t-=100)}return t}function m(e,t,n){return function e(t,n,c){const l=c.dateTimeFormat,u=r(l,"Calendar").convert;if(!n||!n.length||"i"===n){if(c&&c.name.length){if(u)return e(t,r(l,"FullDateTimePattern"),c);const n=new Date(t.getTime()),a=o(t,r(l,"eras"));return n.setFullYear(s(t,l,a)),n.toLocaleString()}return t.toString()}const d=r(l,"eras"),p="s"===n;n=i(l,n);const g=new Sys.StringBuilder;let h,f,m;function b(e){return e<10?"0"+e:e.toString()}function _(e){return e<10?"00"+e:e<100?"0"+e:e.toString()}const y=/([^d]|^)(d|dd)([^d]|$)/g;function v(){return f||m||(f=y.test(n),m=!0),f}let S=0;const O=/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g;let C;function E(e,t){if(C)return C[t];switch(t){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate()}}for(!p&&u&&(C=u.fromGregorian(t));;){const e=O.lastIndex,i=O.exec(n);if(S+=a(n.slice(e,i?i.index:n.length),g),!i)break;if(S%2!=1)switch(i[0]){case"dddd":g.append(r(l,"DayNames")[t.getDay()]);break;case"ddd":g.append(r(l,"AbbreviatedDayNames")[t.getDay()]);break;case"dd":f=!0,g.append(b(E(t,2)));break;case"d":f=!0,g.append(E(t,2).toString());break;case"MMMM":g.append(r(l,"MonthGenitiveNames")&&v()?r(l,"MonthGenitiveNames")[E(t,1)]:r(l,"MonthNames")[E(t,1)]);break;case"MMM":g.append(r(l,"AbbreviatedMonthGenitiveNames")&&v()?r(l,"AbbreviatedMonthGenitiveNames")[E(t,1)]:r(l,"AbbreviatedMonthNames")[E(t,1)]);break;case"MM":g.append(b(E(t,1)+1));break;case"M":g.append((E(t,1)+1).toString());break;case"yyyy":g.append((I=C?C[0]:s(t,l,o(t,d),p))<10?"000"+I:I<100?"00"+I:I<1e3?"0"+I:I.toString());break;case"yy":g.append(b((C?C[0]:s(t,l,o(t,d),p))%100));break;case"y":g.append(C?C[0].toString():(s(t,l,o(t,d),p)%100).toString());break;case"hh":h=t.getHours()%12,0===h&&(h=12),g.append(b(h));break;case"h":h=t.getHours()%12,0===h&&(h=12),g.append(h.toString());break;case"HH":g.append(b(t.getHours()));break;case"H":g.append(t.getHours().toString());break;case"mm":g.append(b(t.getMinutes()));break;case"m":g.append(t.getMinutes().toString());break;case"ss":g.append(b(t.getSeconds()));break;case"s":g.append(t.getSeconds().toString());break;case"tt":g.append(t.getHours()<12?r(l,"AMDesignator"):r(l,"PMDesignator"));break;case"t":g.append((t.getHours()<12?r(l,"AMDesignator"):r(l,"PMDesignator")).charAt(0));break;case"f":g.append(_(t.getMilliseconds()).charAt(0));break;case"ff":g.append(_(t.getMilliseconds()).substr(0,2));break;case"fff":g.append(_(t.getMilliseconds()));break;case"z":h=t.getTimezoneOffset()/60,g.append((h<=0?"+":"-")+Math.floor(Math.abs(h)));break;case"zz":h=t.getTimezoneOffset()/60,g.append((h<=0?"+":"-")+b(Math.floor(Math.abs(h))));break;case"zzz":h=t.getTimezoneOffset()/60,g.append(`${(h<=0?"+":"-")+b(Math.floor(Math.abs(h)))}:${b(Math.abs(t.getTimezoneOffset()%60))}`);break;case"g":case"gg":r(l,"eras")&&g.append(r(l,"eras")[o(t,d)+1]);break;case"/":g.append(r(l,"DateSeparator"));break;default:throw Error("Invalid date format pattern")}else g.append(i[0])}var I;return g.toString()}(e,t,n)}function b(e,t,n){e=e.trim();const o=n.dateTimeFormat,s=function(e,t){let n=i(e,t);n=n.replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1");const r=new Sys.StringBuilder("^"),o=[];let s=0,c=0;const l=/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g;let u;for(;null!==(u=l.exec(n));){const e=n.slice(s,u.index);if(s=l.lastIndex,c+=a(e,r),c%2!=1){switch(u[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gg":case"g":r.append("(\\D+)");break;case"tt":case"t":r.append("(\\D*)");break;case"yyyy":r.append("(\\d{4})");break;case"fff":r.append("(\\d{3})");break;case"ff":r.append("(\\d{2})");break;case"f":r.append("(\\d)");break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":r.append("(\\d\\d?)");break;case"zzz":r.append("([+-]?\\d\\d?:\\d{2})");break;case"zz":case"z":r.append("([+-]?\\d\\d?)");break;case"/":r.append("(\\/)");break;case".":r.append("(\\.)");break;case"-":r.append("(\\-)");break;default:throw Error("Invalid date format pattern")}o.push(u[0])}else r.append(u[0])}return a(n.slice(s),r),r.append("$"),{regExp:r.toString().replace(/\s+/g,"\\s+"),groups:o}}(o,t),c=new RegExp(s.regExp).exec(e);if(null===c)return null;const l=s.groups;let u,m=null,b=null,_=null,y=null,v=null,S=0,O=0,C=0,E=0,I=null,w=!1;for(let e=0,t=l.length;e<t;e++){const t=c[e+1];if(t)switch(l[e]){case"dd":case"d":if(y=parseInt(t,10),y<1||y>31)return null;break;case"MMMM":if(_=d(n,t),_<0||_>11)return null;break;case"MMM":if(_=p(n,t),_<0||_>11)return null;break;case"M":case"MM":if(_=parseInt(t,10)-1,_<0||_>11)return null;break;case"y":case"yy":if(b=f(o,parseInt(t,10)),b<0||b>9999)return null;break;case"yyyy":if(b=parseInt(t,10),b<0||b>9999)return null;break;case"h":case"hh":if(S=parseInt(t,10),12===S&&(S=0),S<0||S>11)return null;break;case"H":case"HH":if(S=parseInt(t,10),S<0||S>23)return null;break;case"m":case"mm":if(O=parseInt(t,10),O<0||O>59)return null;break;case"s":case"ss":if(C=parseInt(t,10),C<0||C>59)return null;break;case"tt":case"t":const e=t.toUpperCase();if(w=e===r(o,"PMDesignator").toUpperCase(),!w&&e!==r(o,"AMDesignator").toUpperCase())return null;break;case"f":if(E=100*parseInt(t,10),E<0||E>999)return null;break;case"ff":if(E=10*parseInt(t,10),E<0||E>999)return null;break;case"fff":if(E=parseInt(t,10),E<0||E>999)return null;break;case"dddd":if(v=g(n,t),v<0||v>6)return null;break;case"ddd":if(v=h(n,t),v<0||v>6)return null;break;case"zzz":const a=t.split(/:/);if(2!==a.length)return null;if(u=parseInt(a[0],10),u<-12||u>13)return null;const i=parseInt(a[1],10);if(i<0||i>59)return null;I=60*u+(t.startsWith("-")?-i:i);break;case"z":case"zz":if(u=parseInt(t,10),u<-12||u>13)return null;I=60*u;break;case"g":case"gg":let s=t;const c=r(o,"eras");if(!s||!c)return null;s=s.toLowerCase().trim();for(let e=0,t=Object.keys(c).length;e<t;e+=4)if(s===c[e+1].toLowerCase()){m=e;break}if(null===m)return null}}let j,P=new Date;const T=r(o,"Calendar").convert;if(j=T?T.fromGregorian(P)[0]:P.getFullYear(),null===b?b=j:r(o,"eras")&&(b+=r(o,"eras")[(m||0)+3]),null===_&&(_=0),null===y&&(y=1),T){if(P=T.toGregorian(b,_,y),null===P)return null}else{if(P.setFullYear(b,_,y),P.getDate()!==y)return null;if(null!==v&&P.getDay()!==v)return null}if(w&&S<12&&(S+=12),P.setHours(S,O,C,E),null!==I){const e=P.getMinutes()-(I+P.getTimezoneOffset());P.setHours(P.getHours()+e/60,e%60)}return P}n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b}))},lju1:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r={ControlLablelInFormDescriptorForUserLanguage:"Control_LabelSource_ControlLablelInFormDescriptorInUserLanguage",AttributeName:"Control_LabelSource_ControlLabelNotAvailable_Fallback_To_AttributeName",TargetEntityPluralName:"Control_LabelSource_AttributeNotAvailable_Fallback_To_TargetEntityPluralName",ControlLabelInBaseLanguage:"Control_LabelSource_AttributeNotAvailable_Fallback_To_ControlLabelInBaseLanguage",ClientAPI:"Control_LabelSource_ClientAPI"}},lk80:function(e,t,n){"use strict";n.d(t,"a",(function(){return J})),n.d(t,"b",(function(){return $}));var r=n("nuS9"),a=n("4fxQ"),i=n("XOQQ"),o=n("w1eR"),s=n("HMYz"),c=n("uC8f"),l=n("ke4y"),u=n("QBtP"),d=n("b8TU"),p=n("eq9I"),g=n("lKf0"),h=n("olZa"),f=n("JhlA"),m=n("JRzo"),b=n("EY5k"),_=n("NjDY"),y=n("BzKn"),v=n("LOik"),S=n("K7RF");var O=n("Lyxw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var C=n("go4y"),E=n("K9wp"),I=n("Axoi"),w=n("xkcG"),j=n("qshH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class P{constructor(){this._orgSettings=new I.a(P._store),this._userSettings=new w.a(P._store),this._reporting=j.a.getInstance()}static getInstance(e,t){if(!P._instance){if(!e)throw new Error("store is null or undefined");if(P._store=e,!t)throw new Error("context is null or undefined");P._context=t,P._instance=new P}return P._instance}get orgSettings(){return this._orgSettings}get firstPartyIntegrationSiteUrl(){const e=Object(_.x)(P._store.getState());return e?e.firstPartyIntegrationSiteUrl:null}get userSettings(){return this._userSettings}get OnlineSdk(){return new E.a(P._store,"")}get reporting(){return this._reporting}set skypeChannel(e){P._context.SkypeChannel.SkypeChannelClient=e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var T=n("r/9v"),N=n("FdKt");function A(){return{type:"skypeChannel.initialize.async",execute(e,t){const n=e.getState();return Object(_.x)(n).isPresenceEnabled&&Object(O.b)(n,C.a.SkypeChannelFeatureName)&&(Object(T.c)(!0,t),e.dispatch({type:"skypeContext.initialize.async",execute:(e,t)=>t.ScriptManager.initializeContainer(C.a.SkypeChannelIframeSuffix).then(n=>{t.SkypeChannel={SkypeChannelClient:{}};let r={Context:P.getInstance(e,t)};r=Object.freeze(r),n.setGlobalVariable("SkypeContext",r)}),shouldReceiveFullStore:!0}).then(()=>{const e=t.ScriptManager.getContainer(C.a.SkypeChannelIframeSuffix);Object(N.b)(()=>e.loadWebResources([Xrm.Utility.getGlobalContext().getWebResourceUrl(C.a.WebResourcePath)]),"Load Skype Webresources")})),Promise.resolve()}}}n("pgSX"),n("si7p"),n("GYEz"),n("YxC/"),n("tICD");var D=n("IqkD");n("Uv1Y"),n("91WF");var R;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */n("SAYH");!function(e){e[e.None=0]="None",e[e.PromptBeforeReport=1]="PromptBeforeReport",e[e.AutoReport=2]="AutoReport",e[e.NeverReport=3]="NeverReport"}(R||(R={}));n("fU7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var x=n("0iNb"),M=n("E5IU"),F=n("BgaZ"),k=n("TBkx"),L=n("zmaG"),B=n.n(L),U=n("Knfm"),V=n("GEbX"),z=n("txA/"),W=n("H4dV"),q=n("0kGT"),H=n("VnTQ"),G=n("q0Q1"),K=n("kGA3"),Q=n("tJ+6"),X=n("zVFX"),Y=n("/aHX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const J=function(){const e=Object(c.createRenderer)(),t=document.getElementById("stylesheet");return{renderer:e,mountNode:t}}();function $(){return{diagnosticName:"RenderApplicationShell",boot:async(e,t,c)=>{const C=t.TraceManager.getTracer("RenderApplicationShell");C.debug("MainClient renderUI started.");const E=Object(M.i)(c.getState());E&&e.getBaseUrl().searchParams.set("appid",E),B.a.addKeyPerformanceIndicator("ApplicationShellInit"),Object(b.g)();const I=Object(_.x)(c.getState());if(I&&!I.enabledLanguages){const e=[];e.push({name:"organization.initialized",value:Object(_.v)(c.getState())}),e.push({name:"organization.organizationSettings.languageCode",value:I.languageCode}),t.TraceManager.getTracer("RenderApplicationShell").error("organizationSettings.enabledLanguages not defined",e)}const w=I.enabledLanguages.map(e=>String.format(p.k,e));w.push(...m.o),w.push(...h.c),w.push(...g.l),w.push(...f.b),w.push(...p.e);const j=Object(U.a)(c.getState());let P;j===V.a.MultiSession&&w.push(...z.Q),w.push(p.a),c.dispatch(Object(b.e)(w)).then(()=>{j===V.a.MultiSession&&Object(Y.b)().then(e=>c.dispatch(e.updateHomeSessionTitleAction()))}),c.dispatch(Object(G.b)(c.getState())),Object(Q.b)(c.getState())&&Object(X.c)(c.getState().designLanguage),c.dispatch(Object(y.b)(c.getState())),e.getClientHost()!==o.a.MobileApplication&&c.dispatch({type:"retrieve.published.appmodule.list",execute({dispatch:e,getState:t},n){const r=Object(v.a)(t());if(!(r&&r.length>0))return e(Object(S.b)("appmodules",null,"AppModule",null,!1,1,null,[],[],null))}}),await function(e,t){const c=document.getElementById("error-app-loading-indicator");c?c.classList.add("hideErrorBlock"):t.TraceManager.getTracer("RenderApplicationShell").error("DOM element with id 'error-app-loading-indicator' was not found"),e.getClientHost()===o.a.Browser&&(document.body.style.overflow="hidden");const p={router:t.Router,cacheEnabled:"true"===e.getInitialUrl().searchParams.get("cache")},g=r.createElement(l.b,p),h=r.createElement(K.a.Provider,{value:t},g),f=r.createElement(u.a.Provider,{value:t},h),m=e.getStore(),b=r.createElement(i.a,{store:m},f),_=r.createElement(s.Provider,J,b),y=document.getElementById("shell-container");let v;if(Object(q.b)(m.getState())){const e=document.createElement("style");document.head.appendChild(e),e.sheet.insertRule("body { -webkit-font-smoothing: antialiased; -webkit-user-select: none; user-select: none; }"),v=Promise.all([n.e(9),n.e(16),n.e(20)]).then(n.bind(null,"TsZs")).then(e=>{e.AppRegistry.registerComponent("App",()=>()=>_),e.I18nManager.forceRTL(Object(D.g)(m.getState())),e.AppRegistry.runApplication("App",{initialProps:{},rootTag:y})}),m.dispatch(Object(H.d)())}else a.render(_,y),v=Promise.resolve();var S;if((S=y).addEventListener("pointerdown",()=>{}),S.addEventListener("mousedown",()=>{}),W.a.getInstance().get_IsAndroid()){const t=document.getElementById("viewport-meta"),n=Object(d.b)(e.getStore().getState());t.content+=`, height=${n}px`}return t.AccessibilityManager.showOutlineState(!1),v}(e,t),C.debug("MainClient renderUI completed successfully."),Object(b.d)(c.dispatch),P=t.RestoreStateManager.shouldRestoreState?t.RestoreStateManager.initializePages():e.getIsPreload()?Promise.resolve(null):Object(x.b)(e,t);const T=e.getClientHost();return T!==o.a.MailApp&&(c.dispatch({type:"npssurvey.initialize.async",execute:(e,t)=>Object(O.b)(e.getState(),"NPSSurvey")?t.AssetLoader.loadScript("/WebResources/msdyn_LoadNPSSurvey.js"):Promise.resolve()}),function(e,t){e!==o.a.MobileApplication&&t.dispatch(A())}(T,c)),I.enableLivePersonaCardUCI&&e.getClientHost()===o.a.Browser&&n.e(73).then(n.bind(null,"FVrQ")).then(({initializeLivePersonaCard:e})=>{c.dispatch(e())}),t.ErrorHandler.addEventHandler((e,t)=>{if(t&&Object(k.h)(t.errorCode))return Object(F.a)(c)}),t.ErrorHandler.replaceBaseHandler((e,t,n,r,a,i)=>c.dispatch({type:"form.unhandled.error.dialog",execute(e,t,n){const r=Object(D.w)(e.getState());return null==r||r.userReportScriptErrors,Promise.resolve()}})),P}}}},llMO:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"c",(function(){return S})),n.d(t,"d",(function(){return O})),n.d(t,"b",(function(){return I}));var r=n("4fxQ"),a=n("TEuE"),i=n("clbQ"),o=n("mfAb"),s=n("SZCI"),c=n("DRVD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l=n.n(c).a.createEvent("RenderingUpdate",s.s);let u=[],d=!1,p=[],g=p,h=[],f=!1,m=!1;function b(){C()}function _(){d||(d=!0,Object(a.f)(C,a.b))}function y(){g===p&&(g=p.slice())}function v(e){if("function"!=typeof e)throw new Error("Expected listener to be a function.");let t=!0;return y(),g.push(e),function(){if(!t)return;t=!1,y();const n=g.indexOf(e);g.splice(n,1)}}function S(e){f?e():(h.push(e),_())}function O(){m=!0,_()}function C(){d=!1;const e=u.length>0,t=l.startStopwatch({actions:u,controlUpdates:h.length});u=[];let n=0;f=!0;try{r.unstable_batchedUpdates(()=>{const t=i.a.getInstance();if(m&&(t.takeMeasurements(),m=!1),n=t.flushPendingMeasuringNotifications(),function(){const e=h.slice();h=[],e.forEach(e=>e())}(),e){const e=p=g;for(let t=0;t<e.length;t++)e[t]()}})}finally{f=!1}t({measuringUpdates:n.toString()})}function E(e,t){const n=e(t);return Object(o.b)(t)&&(u.push(t.type),_()),n}function I(e){return(t,n)=>{const r=e(t,n),a=E.bind(null,r.dispatch);return r.dispatch=a,r.subscribeImmediate=r.subscribe,r.subscribe=v,r}}},lmfa:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("ruPX"),a=n("3rse"),i=n("H4dV"),o=n("oT5e"),s=n("w1eR"),c=n("GYEz"),l=n("UwOy");class u{constructor(e,t){this.store=e,this.context=t,this._setClickEvent=this._setClickEvent.bind(this),this._setKeyboardEvent=this._setKeyboardEvent.bind(this),this._clearClickEvent=this._clearClickEvent.bind(this),this._clearKeyboardEvent=this._clearKeyboardEvent.bind(this),this._registerGlobalEventHandler(e.getState(),"click",this._setClickEvent,this._clearClickEvent),this._registerGlobalEventHandler(e.getState(),"keydown",this._setKeyboardEvent,this._clearKeyboardEvent)}handleClosePage(e){if(this.context.Router.getHistoryManager().GetHistoryLength(e)<=1)return this.handleClosePageInternal(e)}handleClosePageInternal(e){const t=this.store.getState();return Object(c.a)(t)===s.a.Browser&&!Object(l.e)(t)&&this.context.Router.getHistoryManager().GetState().historyLengthOnInitialLoad<=1&&(setTimeout(()=>window.close(),0),!0)}handleNavigation(e,t,n,r){const a=t&&t.targetBrowsingContext;if(a)return Promise.resolve(void 0);if(a||(t.targetBrowsingContext=Object(o.e)(this.store.getState())),this.context.Router.isPageADialog(n.getState(),e,t,r))return Promise.resolve(void 0);const i=window.event&&"click"===window.event.type?window.event:this._clickEvent,s=this._keydownEvent;return this._clearClickEvent(),this._clearKeyboardEvent(),this.handleNavigationInternal(e,t,i,s,n,this.context)}handleNavigationInternal(e,t,n,a,i,o){return this.shouldPerformCtrlKeyAction(n,a)?Promise.resolve(Object(r.b)(o,e.pageName,e.input)):this.shouldPerformShiftKeyAction(n,a)?i.dispatch(Object(r.c)(e.pageName,e.input)):Promise.resolve(void 0)}shouldPerformCtrlKeyAction(e,t){return e&&this.wasCmdOrCtrlKeyPressed(e)||t&&t.keyCode===a.a.Enter&&this.wasCmdOrCtrlKeyPressed(t)}shouldPerformShiftKeyAction(e,t){return e&&e.shiftKey||t&&t.keyCode===a.a.Enter&&t.shiftKey}wasCmdOrCtrlKeyPressed(e){return e.ctrlKey||this._wasMacCmdKeyPressed(e)}_wasMacCmdKeyPressed(e){const t=i.a.getInstance();return t&&!t.get_IsWinDesktop()&&e.metaKey}_clearClickEvent(){this._clickEvent=void 0}_clearKeyboardEvent(){this._keydownEvent=void 0}_setClickEvent(e){this._clickEvent=e}_setKeyboardEvent(e){this._keydownEvent=e}_registerGlobalEventHandler(e,t,n,r){window.addEventListener(t,e=>{n(e),setTimeout(()=>setTimeout(()=>setTimeout(()=>setTimeout(()=>setTimeout(()=>setTimeout(r,0),0),0),0),0),0)},!0)}}},lq82:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("Tz6o"),a=n("QHx/");function i(e,t){return{type:"update.navigation.history.async",sync:!0,execute({dispatch:n,getState:i},o){const s=o.Router.getHistoryManager(),c=s.GetState();if(n(Object(r.b)(e,t||c.pageId)),!t||c.pageId===t){const t=o.Router.createUrlForPage(c.pageName,e),n=Object(a.a)(i(),c.pageId);s.ReplaceState(c,t,n)}}}}},lx8z:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("nxt5");class a extends r.a{constructor(e){super("InitializeFrom"),this._entity=null,this._entity=e}get_entity(){return this._entity}}},lxuJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=/^\{?([0-9a-f]{8}(-?)[0-9a-f]{4}\2[a-f\d]{4}\2[0-9a-f]{4}\2[0-9a-f]{12})}?$/;function a(e,t){var n=r.exec(e.toLocaleLowerCase()),a=r.exec(t.toLocaleLowerCase());return n[1]===a[1]}function i(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}},lza4:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="commanding.set.xmrobjectready";function a(e,t,n){return{type:r,payload:n,meta:{pageId:e,contextKey:t}}}},m1E4:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.logMessage=t.logIssue=t.clearLog=t.getLog=t.PerformanceEventLogLevel=void 0;var a,i=r(n("zmaG")),o=n("STW0");!function(e){e[e.General=0]="General",e[e.Warning=1]="Warning",e[e.Error=2]="Error"}(a||(a={})),t.PerformanceEventLogLevel=a;var s=[];function c(e){s.push({level:e.level===o.PerformanceIssueLevel.Error?a.Error:a.Warning,message:e})}i.default.subscribeToPerformanceIssues((function(e){c(e)})),t.getLog=function(){return s},t.logMessage=function(e){s.push({level:a.General,message:e})},t.logIssue=c,t.clearLog=function(){s=[]}},m2nm:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="router.set.disable.navigateback";function a(e,t){return{type:r,payload:{disableNavigateBack:e,browsingContextId:t}}}},m4EA:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return c}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Brand_CRM_Short",a="Brand_CRM",i="Brand_CRM_Desc",o="Web.NavBar.HomeArrow_Caption",s="Brand_PowerApps",c=[r,a,i,o,s]},m4ji:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("RYFF"),a=n("XjOj"),i=n("Div0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class o{constructor(e,t,n){this._callId=null,this._dispatcher=null,this._size=0,this._sqlStatements=null,this._sqlParameters=null,this._successCallbacks=null,this._errorCallbacks=null,this._dispatcher=e,this._sqlStatements=new Array(0),this._sqlParameters=new Array(0),this._successCallbacks=new Array(0),this._errorCallbacks=new Array(0),this._size=0,this._callId=this._dispatcher.getCallIdForSqlBatchExecution(),this._dispatcher.logPerfData(this._callId,String.format("{0}-{1}-{2}",this._dispatcher.get_namespaceName(),t,n?"R":"W"),""),this._dispatcher.logPerfData(this._callId,"CallId",this._callId),this._dispatcher.logPerfData(this._callId,"SqlBatch.Start",(new Date).getTime())}get_estimatedSize(){return this._size}get_Statements(){return this._sqlStatements}get_Parameters(){return this._sqlParameters}get_SuccessCallbacks(){return this._successCallbacks}get_ErrorCallbacks(){return this._errorCallbacks}get_CallId(){return this._callId}addRequest(e,t,n,a){this._sqlStatements.push(e),this._sqlParameters.push(t),this._successCallbacks.push(n),this._errorCallbacks.push(a),this._size+=r.a.CalculateEstimatedSize(e,t)}execute(e){this._dispatcher.logPerfData(this._callId,"SqlBatch.Execute.Start",(new Date).getTime());for(let e=0;e<this.get_Statements().length;e++){const t=this.get_Statements()[e];Object(a.g)(i.a.sqlBatch,"ExecuteSqlBatch start, statement{0} = {1}",e,t)}this._dispatcher.ExecuteSqlBatch(this,()=>{Object(a.g)(i.a.sqlBatch,"ExecuteSqlBatch end"),this._dispatcher.logPerfData(this._callId,"SqlBatch.Execute.End",(new Date).getTime()),this._dispatcher.logPerfData(this._callId,"SqlBatch.batchCompleteCallback.Start",(new Date).getTime()),e(),this._dispatcher.logPerfData(this._callId,"SqlBatch.batchCompleteCallback.End",(new Date).getTime()),this._dispatcher.logPerfData(this._callId,"SqlBatch.End",(new Date).getTime()),this._dispatcher.movePerfDataToCompletedCallsDataset(this._callId)})}}},mASP:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return s}));var r=n("K7RF"),a=n("eXjw"),i=n("BHck"),o=n("iJGp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="purgeAppRelatedMetadata.sync";function c(){return{type:"retrieveOfflineAppDescriptors.async",execute({dispatch:e,getState:t},n){const s=t(),c=Object(i.a)(s);if(c.offlineAppDescriptorsInitialized===a.a.Initialized)return Promise.resolve(c);e(function(){const e={landingPageOfflineMetadata:{offlineAppDescriptorsInitialized:a.a.Initializing}};return{type:r.a,payload:e}}());return e(Object(r.b)("appmoduleselector",null,null,null,!1,o.a.OnDemandWithoutContext,null,null,[],null))}}}function l(){return{type:s,payload:{views:undefined,viewDefaults:undefined,viewSelectors:undefined,forms:undefined,formDefaults:undefined,formSelectors:undefined,charts:undefined,chartDefaults:undefined,chartSelectors:undefined,dashboards:undefined,dashboardSelectors:undefined,dashboardsByNavPath:undefined,dashboardsByEntityName:undefined,dashboardSelectorsByEntityName:undefined,dialogs:undefined,businessProcessFlows:undefined,businessProcessFlowsDefault:undefined,quickCreateMenu:undefined,appShellSettings:undefined,offlineSync:undefined,siteMap:undefined,appContext:undefined}}}},mDek:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("84PK"),a=n("504W"),i=n("NMtn"),o=n("2JG5"),s=n("jFgV"),c=n("xAYq"),l=n("dFCJ"),u=n("nTyX");class d{constructor(e,t,n,r,a,o,s,c,l,u,d,p,g,h,f,m,b,_,y,v,S,O,C,E,I,w,j,P,T,N,A,D,R,x,M){this._id=null,this._logicalName=null,this._type="boolean",this._sourceType=0,this._entityLogicalName=null,this._displayName=null,this._formatName=null,this._attributeTypeName=null,this._description=null,this._columnNumber=0,this._sourceTypeMask=0,this._isSecured=!1,this._isValidForCreate=!1,this._isValidForRead=!1,this._isValidForUpdate=!1,this._isValidForGrid=!1,this._requiredLevel=0,this._maxLength=0,this._minValue=0,this._maxValue=0,this._precision=0,this._precisionSource=0,this._format=null,this._behavior=0,this._defaultFormValue=0,this._defaultValue=!1,this._isBaseCurrency=!1,this._optionSet=null,this._targets=null,this._attributeOf=null,this._hasChanged=!1,this._isSortableEnabled=!1,this._imeMode=0,this._inheritsFrom=null,this._isLocalizable=!1,this._isCustomAttribute=!1,this._canBeSecuredForCreate=!1,this._canBeSecuredForRead=!1,this._canBeSecuredForUpdate=!1,Object(i.d)(e,"logicalName"),Object(i.d)(t,"id"),Object(i.d)(r,"type"),Object(i.d)(d,"requiredLevel"),Object(i.d)(o,"isSecured"),Object(i.d)(s,"isValidForCreate"),Object(i.d)(c,"isValidForRead"),Object(i.d)(l,"isValidForUpdate"),this._logicalName=e,this._id=t,this._entityLogicalName=n,this._type=r,this._sourceType=T,this._displayName=a,this._isSecured=o,this._isValidForCreate=s,this._isValidForRead=c,this._isValidForUpdate=l,this._isValidForGrid=u,this._requiredLevel=d,this._maxLength=p,this._minValue=g,this._maxValue=h,this._precision=f,this._precisionSource=m,this._format=b,this._behavior=_,this._defaultFormValue=y,this._defaultValue=v,this._optionSet=S,this._targets=C,this._isBaseCurrency=O,this._attributeOf=E,this._hasChanged=I,this._isSortableEnabled=j,this._imeMode=w,this._inheritsFrom=P,this._isLocalizable=N,this._isCustomAttribute=A,this._columnNumber=D,this._canBeSecuredForCreate=R,this._canBeSecuredForRead=x,this._canBeSecuredForUpdate=M}get_id(){return this._id}get_logicalName(){return this._logicalName}get_entityLogicalName(){return this._entityLogicalName}get_type(){return this._type}get_sourceType(){return this._sourceType}get_displayName(){return this._displayName}get_isValidForCreate(){return this._isValidForCreate}get_isSecured(){return this._isSecured}get_isValidForUpdate(){return this._isValidForUpdate}get_isValidForGrid(){return this._isValidForGrid}get_isValidForRead(){return this._isValidForRead}get_requiredLevel(){return this._requiredLevel}get_maxLength(){return this._maxLength}get_minValue(){return this._minValue}get_maxValue(){return this._maxValue}get_precision(){return this._precision}get_precisionSource(){return this._precisionSource}get_format(){return this._format}get_formatName(){return this._formatName}get_behavior(){return this._behavior}get_isBaseCurrency(){return this._isBaseCurrency}get_defaultFormValue(){return this._defaultFormValue}get_defaultValue(){return this._defaultValue}get_optionSet(){return this._optionSet}get_targets(){return this._targets}get_attributeOf(){return this._attributeOf}get_hasChanged(){return this._hasChanged}get_isSortableEnabled(){return this._isSortableEnabled}get_imeMode(){return this._imeMode}get_inheritsFrom(){return this._inheritsFrom}get_isLocalizable(){return this._isLocalizable}get_isCustomAttribute(){return this._isCustomAttribute}get_columnNumber(){return this._columnNumber}get_canBeSecuredForCreate(){return this._canBeSecuredForCreate}get_canBeSecuredForRead(){return this._canBeSecuredForRead}get_canBeSecuredForUpdate(){return this._canBeSecuredForUpdate}getObjectData(){const e=this._getKeyPaths();return Object.assign(Object.assign({},e),{type:Object(u.e)(this._type),sourcetype:this._sourceType,displayname:this._displayName,issecured:this._isSecured,issortableenabled:this._isSortableEnabled,isvalidforcreate:this._isValidForCreate,isvalidforupdate:this._isValidForUpdate,isvalidforread:this._isValidForRead,isvalidforgrid:this._isValidForGrid,requiredlevel:this._requiredLevel,maxlength:this._maxLength,minvalue:this._minValue,maxvalue:this._maxValue,precision:this._precision,precisionsource:this._precisionSource,defaultformvalue:this._defaultFormValue,defaultvalue:this._defaultValue,format:this._format,behavior:this._behavior,isbasecurrency:this._isBaseCurrency,attributeof:this._attributeOf,haschanged:this._hasChanged,imemode:this._imeMode,inheritsfrom:this._inheritsFrom,islocalizable:this._isLocalizable,formatName:this._formatName,description:this._description,columnNumber:this._columnNumber,sourceTypeMask:this._sourceTypeMask,attributeTypeName:this._attributeTypeName,IsCustomAttribute:this._isCustomAttribute,optionset:Object(a.a)(this._optionSet)?void 0:this._optionSet.getObjectData(),targets:Object(a.a)(this._targets)?void 0:this._targets,canBeSecuredForCreate:this._canBeSecuredForCreate,canBeSecuredForRead:this._canBeSecuredForRead,canBeSecuredForUpdate:this._canBeSecuredForUpdate})}getODataObject(){return{LogicalName:this._logicalName,MetadataId:this._id.toString(),EntityLogicalName:this._entityLogicalName,EntityAttributeLogicalNames:this._entityLogicalName+c.a+this._logicalName,AttributeType:Object(u.e)(this._type),AttributeTypeName:d.addValueWrapper(("double"===this._attributeTypeName?"Float":this._attributeTypeName)+"Type"),Description:o.a.convertToLabel(this._description),ColumnNumber:this._columnNumber,FormatName:d.addValueWrapper(this._formatName),SourceTypeMask:this._sourceTypeMask,OptionSet:Object(a.a)(this._optionSet)?void 0:this._optionSet.getODataObject(),SourceType:this._sourceType,DisplayName:o.a.convertToLabel(this._displayName),IsSecured:this._isSecured,IsSortableEnabled:d.addValueWrapper(this._isSortableEnabled),IsValidForCreate:this._isValidForCreate,IsValidForUpdate:this._isValidForUpdate,IsValidForRead:this._isValidForRead,IsValidForGrid:this._isValidForGrid,RequiredLevel:d.addValueWrapper(this._requiredLevel),MaxLength:this._maxLength,MinValue:this._minValue,MaxValue:this._maxValue,Precision:this._precision,PrecisionSource:this._precisionSource,DefaultFormValue:this._defaultFormValue,DefaultValue:this._defaultValue,Format:Object(a.a)(this._format)?void 0:parseInt(this._format,10),DateTimeBehavior:d.addValueWrapper(Object(l.c)(this._behavior)),IsBaseCurrency:this._isBaseCurrency,AttributeOf:this._attributeOf,HasChanged:this._hasChanged,ImeMode:this._imeMode,InheritsFrom:this._inheritsFrom,IsLocalizable:this._isLocalizable,IsCustomAttribute:this._isCustomAttribute,Targets:Object(a.a)(this._targets)?void 0:this._targets,CanBeSecuredForCreate:this._canBeSecuredForCreate,CanBeSecuredForRead:this._canBeSecuredForRead,CanBeSecuredForUpdate:this._canBeSecuredForUpdate}}getStorableODataObject(){return Object.assign(Object.assign({},this._getKeyPaths()),this.getODataObject())}_getKeyPaths(){return{id:this._id.getObjectData(),[d.logicalNamePath]:this._logicalName,[d.entityLogicalNamePath]:this._entityLogicalName,[d.entityAttributeLogicalNamesPath]:this._entityLogicalName+c.a+this._logicalName}}static extractKey(e){const t=e.id;return t?r.a.createFromObjectData(t).toString():e.Id}static addValueWrapper(e){const t={};return t.Value=e,t}static removeValueWrapper(e){return e?e.Value:null}static createFromObjectData(e){if(!Object(a.b)(e.MetadataId)){e=d.createFromODataResponse(e).getObjectData()}const t=new d(e.logicalname,r.a.createFromObjectData(e.id),e.entitylogicalname,Object(u.c)(e.type),e.displayname,e.issecured,e.isvalidforcreate,e.isvalidforread,e.isvalidforupdate,e.isvalidforgrid,e.requiredlevel,e.maxlength,e.minvalue,e.maxvalue,e.precision,e.precisionsource,e.format,e.behavior,e.defaultformvalue,e.defaultvalue,e.optionset&&s.a.createFromObjectData(e.optionset),e.isbasecurrency,e.targets,e.attributeof,e.haschanged,e.imemode,e.issortableenabled,e.inheritsfrom,e.sourcetype,e.islocalizable,e.IsCustomAttribute,e.columnNumber,e.canBeSecuredForCreate,e.canBeSecuredForRead,e.canBeSecuredForUpdate);return t._formatName=e.formatName,t._description=e.description,t._sourceTypeMask=e.sourceTypeMask,t._attributeTypeName=e.attributeTypeName,t}static createFromODataResponse(e){const t=e.LogicalName,n=r.a.tryCreate(e.MetadataId),i=e.EntityLogicalName,c=Object(u.c)(e.AttributeType);let p=d.removeValueWrapper(e.AttributeTypeName);const g=new RegExp("Type","g");p=p.replace(g,"").toLowerCase(),"float"===p&&(p="double");const h=e.SourceType,f=o.a.getLabelString(e.Description),m=o.a.getLabelString(e.DisplayName),b=d.removeValueWrapper(e.RequiredLevel);let _;_="string"==typeof b?Object(l.e)(b):b;const y=e.IsSecured,v=e.IsValidForCreate,S=e.IsValidForUpdate,O=e.IsValidForGrid,C=e.IsValidForRead,E=e.ColumnNumber,I=e.SourceTypeMask,w=e.MaxLength,j=e.MinValue,P=e.MaxValue,T=e.Precision,N=e.PrecisionSource,A=e.Format;let D=null;Object(a.a)(A)||(D=A.toString());const R=d.removeValueWrapper(e.FormatName),x=d.removeValueWrapper(e.DateTimeBehavior);let M=0;Object(a.a)(x)||(M=Object(l.d)(x));const F=e.DefaultFormValue,k=e.DefaultValue,L=e.IsBaseCurrency,B=e.AttributeOf,U=e.HasChanged,V=d.removeValueWrapper(e.IsSortableEnabled),z=e.ImeMode,W=e.InheritsFrom,q=e.IsLocalizable,H=e.IsCustomAttribute;let G=null;const K=e.OptionSet;if(!Object(a.a)(K)&&"object"==typeof K){const e=K.Options;if(Object(a.a)(e)){const e=K.TrueOption,t=K.FalseOption;if(e&&t){const n=[t,e];G=s.a.createFromOData(n)}}else G=s.a.createFromOData(e)}const Q=e.Targets,X=e.CanBeSecuredForCreate,Y=e.CanBeSecuredForRead,J=e.CanBeSecuredForUpdate,$=new d(t,n,i,c,m,y,v,C,S,O,_,w,j,P,T,N,D,M,F,k,G,L,Q,B,U,z,V,W,h,q,H,E,X,Y,J);return $._formatName=R,$._description=f,$._sourceTypeMask=I,$._attributeTypeName=p,$}}d.entityLogicalNamePath="entitylogicalname",d.logicalNamePath="logicalname",d.entityAttributeLogicalNamesPath="entitylogicalname_logicalname"},mKIe:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.start=0]="start",e[e.end=1]="end",e[e.none=2]="none"}(r||(r={}))},mL5Q:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){var n;return null===(n=Object(r.a)(e,t))||void 0===n?void 0:n.loadingState}},mPrU:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="recentItem.flyoutRecentsDescriptor.toggle";function a(e){return{type:r,payload:e||{isVisible:!1,entityTypeName:null,relativeToEntryId:null}}}},mcT5:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AWT_REAL_TIME="REAL_TIME",t.AWT_NEAR_REAL_TIME="NEAR_REAL_TIME",t.AWT_BEST_EFFORT="BEST_EFFORT"},mfAb:function(e,t,n){"use strict";function r(e){return void 0===e.execute}function a(e){return!r(e)&&!e.sync}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}))},mibx:function(e,t,n){"use strict";function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}n.d(t,"a",(function(){return r}))},ml6Y:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.offlineDatabaseInformationKey="offlinedatabaseinformation",e.isMobileOfflineOptedInKey="ismobileofflineoptedin",e.isMobileOfflineOptedOutKey="ismobileofflineoptedout",e.norsyncServerConnectionStringKey="norsyncserverconnectionstring",e.isTrialOrganizationKey="offlineistrialdeployment",e.isMocaOfflineFCBEnabledKey="isMocaOfflineFeatureEnabled",e.OfflineProfileIdKey="profileid",e.OfflineProfileVersionKey="profileversion",e.OfflineProfileAvailableEntitiesKey="offlineavailableentities",e.OfflineEntityPluralNamesKey="offlineentitypluralnames",e.OfflineProfileDataKey="LastRetrievedOfflineProfileData",e.OfflineDatabaseKey="offlinedatabasekey",e.OfflineDisabledInfoKey="offlinedisabledinfo",e.MetadataVersionUsedKey="metadataversionused",e.OfflineDisabledEntitiesKey="offlinedisabledentities",e.LastSuccessfulSaveOnCrmKey="lastsuccessfulsaveoncrm",e.SyncErrorFailureMapKey="SyncErrorFailureMap",e.MaxTimeKey="MaxTime",e.OfflinePrimaryAvailableEntitiesKey="offlineprimaryavailableentitieskey",e.IsOfflineUpgradeDoneKey="isofflineupgradedone",e.OfflineApplyApplicationMetadataChangesKey="offlineapplyapplicationmetadatachangeskey",e.IsFirstApplyApplicationMetadataChangesDoneKey="isfirstapplyapplicationmetadatachangesdonekey",e.IsFirstApplicationMetadataDownloadConfirmationDoneKey="isfirstapplicationmetadatadownloadconfirmationdonekey",e.IsOfflineFirstTimeSyncCompletedKey="isofflinefirsttimesynccompletedkey",e.ClientVersionKey="clientversion",e.IsUserSelectOffline="isuserselectofflinevalue"}(r||(r={}))},mlvZ:function(e,t,n){"use strict";n.d(t,"b",(function(){return L})),n.d(t,"f",(function(){return B})),n.d(t,"e",(function(){return V})),n.d(t,"j",(function(){return z})),n.d(t,"i",(function(){return W})),n.d(t,"d",(function(){return U})),n.d(t,"g",(function(){return q})),n.d(t,"c",(function(){return H})),n.d(t,"h",(function(){return K})),n.d(t,"a",(function(){return F}));var r=n("8mbc"),a=n("iDqy"),i=n.n(a),o=n("pEXn"),s=n("zmaG"),c=n.n(s),l=n("rdtZ"),u=n("SZCI"),d=n("wF0i"),p=n("uvnT"),g=n("y+Z1");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const h={};h[s.KPI_ZONE]={[u.i]:[o.b.LookupDialogParameters.DefaultEntityType,o.b.LookupDialogParameters.DefaultViewId,o.b.LookupDialogParameters.EntityTypes,o.b.LookupDialogParameters.ViewIds,o.b.LookupDialogParameters.AllowMultiSelect,o.b.EntityName,o.b.WebResourceName,o.b.ModalDialogType,o.b.UniqueName,o.b.PowerBIComponentTypeCode,o.b.ViewId,o.b.VisualizationId,o.b.DesignerType,o.b.SolutionId,o.b.ComponentId,o.b.CustomControlId,o.b.DashboardNavPath,o.b.DashboardId,o.b.DashboardType,o.b.ShowDefaultDashboard,o.b.DashboardTypeFlags,o.b.BoundDashboardEntity,o.b.RetrievedDashboardId,o.b.BenchmarkControlName,o.b.BenchmarkElementNumber,o.b.ModelFormComponent.IsPreInitialized,o.b.FormId],[d.a]:[o.b.PageLoadParameters.NumberOfControls],[d.b]:[o.b.PageLoadParameters.NumberOfRibbons],PageInfraReady:[o.b.PageInfraReadyParameters.RenderedControls,o.b.EntityName,o.b.DashboardId,o.b.DashboardType,o.b.ShowDefaultDashboard,o.b.DashboardTypeFlags,o.b.BoundDashboardEntity,o.b.RetrievedDashboardId],SaveForm:[o.b.SaveFormParameters.CorrelationId,o.b.SaveFormParameters.SaveMode],CategorizedSearch:[o.b.SearchParameters.SearchFilter,o.b.SearchParameters.IsBarcodeScan],RelevanceSearch:[o.b.SearchParameters.SearchWithoutFilters,o.b.SearchParameters.SearchSessionId],GlobalSearchFlyout:[o.b.SearchParameters.SearchSessionId,o.b.SearchParameters.UsingSuggestion],"TaskBasedFlow.loadDataAndInitializeComponentsAction":[o.b.TaskBasedFlowParameters.PrimaryModelName,o.b.TaskBasedFlowParameters.RecordId],"Commanding.Actions.ExecuteCommand":[o.b.CommandingParameters.CommandType,o.b.CommandingParameters.CommandId,o.b.CommandingParameters.ControlId,o.b.CommandingParameters.CommandManagerId,o.b.CommandingParameters.PageId,o.b.CommandingParameters.ExecuteWarningEntityName,o.b.CommandingParameters.SelectedItemsCount,o.b.CommandingParameters.UrlActionCount,o.b.CommandingParameters.JavascriptActionCount,o.b.CommandingParameters.LibraryCount],"MDD.Performance.DialogButtonClick":[o.b.DialogButtonClickParameters.ControlId,o.b.DialogButtonClickParameters.DialogUniqueName],"MDD.Performance.DialogXClick":[o.b.DialogXClickParameters.DialogUniqueName,o.b.DialogXClickParameters.SourceType],"Forms.QuickFormCardControl.UpdateView":[o.b.QuickFormCardControlUpdateViewParameters.HasParametersValue,o.b.QuickFormCardControlUpdateViewParameters.PageType,o.b.QuickFormCardControlUpdateViewParameters.PageEntityType,o.b.QuickFormCardControlUpdateViewParameters.EntityType,o.b.QuickFormCardControlUpdateViewParameters.ControlId,o.b.QuickFormCardControlUpdateViewParameters.TraceLocation],"BPF.StageButtonClick":[o.b.BpfStageButtonClickParameters.StageButtonName,o.b.BpfStageButtonClickParameters.StageId],"BPF.RenderProcessControl":[o.b.BpfProcessControlRenderParameters.ProcessId,o.b.BpfProcessControlRenderParameters.BusinessProcessFlowInstanceId,o.b.BpfProcessControlRenderParameters.PageId,o.b.BpfProcessControlRenderParameters.EntityTypeCode,o.b.BpfProcessControlRenderParameters.EntityId,o.b.BpfProcessControlRenderParameters.CorrelationId],"BPF.ActionStepButtonClick":[o.b.BpfActionStepButtonClickParameters.ActionStepIdKey],[g.a]:[o.b.FormTabSwitch.TabName]},h[u.b]={[p.a]:[o.b.BootPerformanceParameters.BundleName]};const f={};f[s.KPI_ZONE]=[o.x.CleanLoad,o.b.PageLoadParameters.LoadQuality,o.b.PageLoadParameters.FirstInteractionName,o.b.PageLoadParameters.FirstInteractionTime,o.b.PageLoadParameters.Interactions,o.x.IsBoot,o.b.PageLoadParameters.NetworkRequestInfo,o.b.PageLoadParameters.NetworkRequests,o.b.PageLoadParameters.FirstAppStart,o.b.BootPerformanceParameters.IsStateRestore,o.x.PageName,o.x.LoadType,o.b.PageLoadParameters.NavigationOrigin,o.b.PageLoadParameters.TimeSinceIdle,o.b.PageLoadParameters.ColdLatency,o.b.PageLoadParameters.WarmLatency,o.b.PageLoadParameters.WarmThroughput,o.b.PageLoadParameters.Automation,o.b.PageLoadParameters.IdleTasks,o.b.ShimBootParameters.ShimBootType,o.b.PageLoadParameters.Attribution,o.b.PageLoadParameters.CustomScriptTime,o.b.PageLoadParameters.SyncRequestTime,o.b.WorkBlockKpi,o.b.MultipleWorkBlockKpi,o.b.PageLoadParameters.ZoneActivity,o.b.FormId],f[l.NETWORK_REQUEST_EVENT_NAME]=[],f.Shim=[],f["MscrmControls.FieldControls.SimpleLookupControl"]=[],f[u.v]=[],f[u.j]=[],f[u.q]=[],f[u.h]=[],f[u.k]=[];const m=[],b=["Fetch","XMLHttpRequest","RequestPatch"];class _{constructor(e){this._eventManager=e}writeMarker(e,t,n){const r=i.a.getLastWorkBlockStartTime();n||(n={}),this._sendToTelemetry(e,t-r,n,r)}writeRetroactiveTimespan(e,t,n,r){this._sendToTelemetry(e,n,r,t)}startTimespan(e,t,n){return(r,a)=>{this._sendToTelemetry(e,r,Object.assign(Object.assign({},n),a),t)}}_sendToTelemetry(e,t,n,r){let a=[];const i=e.getZone();if(i===u.e)e.getName().startsWith("msdyn.")&&(n&&(a=Object.keys(n).map(e=>({name:e,value:n[e]}))),this._reportEvent(e,t,a,r));else{if((i===l.NETWORK_REQUEST_EVENT_NAME&&-1===b.indexOf(e.getName())||i===u.b)&&t<50)return;if(n){const r="name",c="url";if(n[r]&&n[r].indexOf("crminsightseventdata")>=0||n[c]&&n[c].indexOf("crminsightseventdata")>=0||n[r]&&n[r].indexOf("pipe.aria.microsoft.com")>=0||n[c]&&n[c].indexOf("pipe.aria.microsoft.com")>=0)return;i===s.KPI_ZONE&&void 0!==n[o.b.PageLoadParameters.TimeSinceIdle]&&(n[o.x.CleanLoad]=function(e,t,n){if(t<0)return 0;const r=n[o.b.PageLoadParameters.LoadQuality];if(r&&0!=(7&Number(r)))return 0;const a=n[o.b.PageLoadParameters.IdleTasks];if(e===u.i&&"true"===a)return 0;const i=n[o.b.MultipleWorkBlockKpi];if(i&&"true"===i.toString())return 0;const s="true"===n[o.x.IsBoot].toString(),c=n[o.b.PageLoadParameters.TimeSinceIdle];if(!s&&c&&Number(c)>=600)return-1;const l=n[o.b.PageLoadParameters.FirstInteractionTime];return l&&Number(l)>300?-2:1}(e.getName(),t,n).toString());const l=f[i],d=h[i]&&h[i][e.getName()]||[];for(const e in n)(l&&(0===l.length||l.indexOf(e)>=0)||d.indexOf(e)>=0)&&a.push({name:e,value:n[e],forceOwnColumn:m.indexOf(e)>-1})}this._reportEvent(e,t,a,r)}}_reportEvent(e,t,n,r){this._eventManager.ReportComponentPerformance(e.getZone(),e.getName(),t,n,r)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class y{constructor(){this._workBlockKPIs=[];const e=localStorage.getItem("WorkBlockKPI");e?this._workBlockKPIs=JSON.parse(e):localStorage.setItem("WorkBlockKPI",JSON.stringify([]))}writeMarker(e,t,n){const r=n[o.b.WorkBlockKpi];if(r&&"true"===r.toString()){const r=i.a.getLastWorkBlockStartTime();this._workBlockKPIs.push({name:e.getName(),duration:t-r,parameters:n}),localStorage.setItem("WorkBlockKPI",JSON.stringify(this._workBlockKPIs))}}writeRetroactiveTimespan(e,t,n,r){}startTimespan(e,t,n){return(e,t)=>{}}getWorkBlockKPIs(){return this._workBlockKPIs}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class v{constructor(e,t){this._traceManager=e,this._durationThresholds=t}writeMarker(e,t,n){this._checkThreshold(e,t-i.a.getLastWorkBlockStartTime(),n)}writeRetroactiveTimespan(e,t,n,r){this._checkThreshold(e,n,r)}startTimespan(e,t,n){return(t,r)=>{this._checkThreshold(e,t,Object.assign(Object.assign({},n),r))}}_checkThreshold(e,t,n){const r=this._durationThresholds[e.getZone()];if(r&&t>r){const a=[];a.push({name:"Zone",value:e.getZone()}),a.push({name:"Name",value:e.getName()}),a.push({name:"Duration",value:t}),a.push({name:"Threshold",value:r});for(const e in n)a.push({name:e,value:n[e]});this._traceManager.getTracer("Performance").warn("Duration for stopwatch exceeded threshold.",a)}}}var S=n("pfY7"),O=n("DRVD"),C=n.n(O),E=n("bsQO"),I=n("z4z4"),w=n("G0by"),j=n("SSL+"),P=n("a475"),T=n("31Vn"),N=n("SRlt");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let A,D,R,x,M=!1;const F="enable.performance.ui",k={};function L(e){const t=e.searchParams.get(u.p),n=window.UCIPerformanceToolsEnabled;M=(!0===n||"true"===t)&&!(!1===n||"false"===t),M&&e.searchParams.set(u.p,"true")}function B(){return M}function U(){c.a.enableOptionalComponents(),-1!==navigator.userAgent.indexOf("Chrome")&&"Google Inc."===navigator.vendor&&C.a.registerTransport(new S.BrowserTimelineTransport,[u.s,u.x,"Core.Boot"]),Object(E.c)(x);const e=P.a.get_Instance();e.add_onReadyOrNow(()=>{Object(I.setMemoryCollector)(()=>new Promise(t=>{e.get_application().getMemoryUsage(e=>{t(e)})}))}),Object(w.setNetworkRequestTypeFilter)({metadata:j.b})}function V(){if(R){if(B())return;M=!0,U(),R.dispatch({type:F,payload:!0})}}function z(e){R=e}function W(e){x=e}function q(e){e.DebugSettingsHandler.registerSettingsHandler(r.b.Performance,t=>function(e,t,n){const r=[s.KPI_ZONE,"Core.Boot",u.u,u.g,"InAppShell",l.NETWORK_REQUEST_EVENT_NAME,u.e,u.v,u.j];t&&r.push(...t),r.push("MscrmControls.EstimatesGridControls.EstimatesGridControl","MscrmControls.ProjectTaskControls.ProjectTaskControl","MscrmControls.ReconciliationControls.ReconciliationControl",u.q,"MscrmControls.FieldControls.SimpleLookupControl",u.h,u.k),A&&C.a.removeTransport(A),A=new _(e.EventManager),C.a.registerTransport(A,r);const a=Object.assign(Object.assign({},k),n);D&&C.a.removeTransport(D),D=new v(e.TraceManager,a),C.a.registerTransport(D,Object.keys(a));try{localStorage.getItem("WorkBlockKPI")&&window.CollectKPI()}catch(e){}}(e,t.Zones,t.Thresholds))}function H(e){return e.reduce((e,t)=>(e[t.name]=t.value&&t.value.toString()||"",e),{})}function G(e){return N.c.canLogDetailsOfRequest(e)?e:Object(T.a)(e,!0)}function K(e,t,n){var r;try{const a=Object.assign({},n);if(e===o.B.Name){const e=t[o.B.CommonError.Message];e===w.SYNC_XHR_MESSAGE?a.Param0&&(a.Param0=G(a.Param0)):"Duration for stopwatch exceeded threshold."===e&&(a[u.y]&&(a[u.y]=G(a[u.y])),a[u.r]&&(a[u.r]=G(a[u.r])))}else if(e===o.x.Name&&t[o.x.CommonAction.Common.ComponentName]===l.NETWORK_REQUEST_EVENT_NAME&&(a.name&&(a.name=G(a.name)),a.url&&(a.url=G(a.url)),a.body)){const e=null===(r=a.body.split("GET "))||void 0===r?void 0:r.slice(1);e&&(a.body=JSON.stringify(e.map(G)))}return a}catch(e){return n}}k.WebService=5e3;let Q=null;window.CollectKPI=()=>{Q||(Q=new y,C.a.registerTransport(Q,[s.KPI_ZONE]))},window.StopCollectingKPI=()=>{if(Q){C.a.removeTransport(Q);const e=Q.getWorkBlockKPIs();return Q=null,localStorage.removeItem("WorkBlockKPI"),e}}},mpSO:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"g",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"i",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"k",(function(){return p})),n.d(t,"l",(function(){return g})),n.d(t,"h",(function(){return h}));
/**
 * Constants for the editform.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="OverflowButton",a="OverflowFlyout",i="CommandBar",o="crm_header_global",s="Commanding",c="CreateCommandManager",l="ribbon.setCmdInitState",u=960,d=768,p="ribbon.storeaddedcommands",g="ribbon.storeappendedcommands",h="commanding.setballoonbuttoncount"},"n/MI":function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return _})),n.d(t,"c",(function(){return y})),n.d(t,"d",(function(){return v})),n.d(t,"e",(function(){return S}));var r=n("X37l"),a=n("SFgX"),i=n("A2T2"),o=n("69Qu"),s=n("iZ7K"),c=n("Xi8U"),l=n("YxC/"),u=n("nVTU"),d=n("7sMj"),p=n("zzhk"),g=n("ws6F"),h=n("znb3"),f=n("XIN1");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const m=["systemform","userform"],b="SITEMAP_RECENT_ENTRY_PINNED",_="SITEMAP_RECENT_ENTRY_UNPINNED",y="SITEMAP_RECENT_PIN_BUTTON_LABEL",v="SITEMAP_RECENT_UNPIN_BUTTON_LABEL";class S{constructor(e,t,n,r,a,i,o){this._id=e,this._entityTypeName=t,this._title=n,this._icon=a,this._onClickHandler=r,this._subActionDescriptor=i,this._pinStatus=o}get pinStatus(){return this._pinStatus}get id(){return this._id}get entityTypeName(){return this._entityTypeName}get title(){return this._title}get icon(){return this._icon}get subActionDescriptor(){return this._subActionDescriptor}get onClickHandler(){return this._onClickHandler}static FromStateItem(e,t,n){return e.ObjectId?S._fromRecentItem(e,t,n):null}static _getEntityReferenceByTypeName(e){return m.indexOf(e)>-1?new u.a(S._DASHBOARD_ETN):new u.a(e)}static _getRedesignedSubAction(e,t){const n={opacity:t&&Object(o.b)(t)?1:.5},r=Object(l.e)(t,[g.r,g.z,g.q,g.y,g.l]),a=Object(l.c)(r,g.q),s=Object(l.c)(r,g.y),c=e.PinStatus?s:a,u=Object(l.c)(r,g.l),d=e.PinStatus?Object(l.c)(r,g.z):Object(l.c)(r,g.r);return{icon:{type:f.b,value:e.PinStatus?h.a.Unpin.toString():h.a.Pin.toString(),dynamicStyles:n},onClickHandler:()=>e.PinStatus?Object(i.d)(e):Object(i.c)(e),narratorTitle:String.format(d,u),subactionAccessibilityLabel:c,toolTip:c}}static _getSubAction(e,t){const n={opacity:t&&Object(o.b)(t)?1:.5},r={fontFamily:"Dyn CRM Symbol","::before":{content:e.PinStatus?'""':'""'},":hover":{"::before":{content:e.PinStatus?'""':'""'}}},a=Object(l.e)(t,[b,_,y,v]),s=Object(l.c)(a,y),c=Object(l.c)(a,v),u=e.PinStatus?String.format(c,e.Title):String.format(s,e.Title);return{icon:{type:"CssIcon",value:r,dynamicStyles:n},onClickHandler:()=>e.PinStatus?Object(i.d)(e):Object(i.c)(e),narratorTitle:e.PinStatus?Object(l.c)(a,b):Object(l.c)(a,_),subactionAccessibilityLabel:u,toolTip:u}}static _fromRecentItem(e,t,n){const i=d.a,o=this._getEntityReferenceByTypeName(e.EntityTypeName),l=e.HasPrimaryImageField,u=e.Title;let g,h,f;if(e.RecordType===r.a.Grid){const t=a.a[e.EntityTypeName];t?g=t:h=Object(c.a)(n,e.EntityTypeName)}else e.RecordType===r.a.Entity&&(g=Object(s.j)(n,e.EntityTypeName,e.ObjectId));return t&&(f=Object(p.b)(n)?this._getRedesignedSubAction(e,n):this._getSubAction(e,n)),new S(e.ObjectId.guid,e.EntityTypeName,e.Title,(t,n,r,a)=>a(e,t,n,r),{type:i,value:g,entityReference:o,hasPrimaryImageField:l,imageSrc:g,customEntityIcon:h,entityPrimaryField:u},f,e.PinStatus)}}S._DASHBOARD_ETN="dashboard"},n23X:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("iZ7K"),a=n("SRlt"),i=n("uIhY");function o(e){return{type:"SERIALIZE_RETRIEVE_PRINCIPAL_ACCESS_REQUEST",execute({dispatch:t,getState:n},o){const s=n(),c=e.get_principal(),l=c.LogicalName,u=c.Id,d=Object(r.o)(s,l);if(!d)return Promise.resolve({serializationFailure:"Cannot find entity set name for the principal entity "+l});const p=e.get_target(),g=p.LogicalName,h=p.Id,f=Object(r.o)(s,g);if(!f)return Promise.resolve({serializationFailure:"Cannot find entity set name for the target entity "+f});const m=JSON.stringify({"@odata.id":`${f}(${h})`}),b={urlParameters:`${d}(${u})/Microsoft.Dynamics.CRM.RetrievePrincipalAccess(Target=@tid)?@tid=${Object(i.c)(m)}`,body:"",method:"GET",additionalHeaders:{Accept:a.a}};return Promise.resolve(b)}}}},"n2e+":function(e,t,n){"use strict";n.d(t,"b",(function(){return S})),n.d(t,"a",(function(){return v}));var r=n("u+q+"),a=n("unFF"),i=n("b8TU");var o=n("MqQG"),s=n("c77n"),c=n("pF61"),l=n("smSa"),u=n("ybGo"),d=n("YxC/"),p=n("yRo8"),g=n("EY5k"),h=n("RADj"),f=n("/D1P"),m=n("Lyxw"),b=n("3/02"),_=n("iF9X"),y=n("37s6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const v=[p.b,"SitemapDesigner.Processing"];const S=Object(r.a)((function(){const e=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e=null,t=null,n=null;return function(r,o){const s=Object(a.a)(r),c=Object(i.a)(r);return t===s&&n&&n.deviceHeight===c.deviceHeight&&n.deviceWidth===c.deviceWidth||(t=s,n=c,e={progressIndicatorBackgroundContainerStyle:{top:0,left:0,opacity:.8,backgroundColor:s.colors.BaseColor.White,position:"absolute",width:c.deviceWidth+"px",height:c.deviceHeight+"px",alignContent:"center",justifyContent:"center",flexDirection:"column",alignItems:"center"},progressIndicatorContentStyle:{width:"inherit",height:"inherit",alignContent:"center",justifyContent:"center",margin:"auto",flexDirection:"column"},progressIndicatorContainerStyle:{alignSelf:"center",height:"64px",width:"64px"},progressIndicatorIndicatorStyle:{height:"inherit",width:"inherit"},progressIndicatorTextStyle:{color:s.colors.BaseColor.Black,fontSize:s.fontSizes.Font225,textAlign:"center",position:"absolute",top:"calc(50% + 32px)",width:"100%"},progressIndicatorAccessibilityAlertStyle:{opacity:0}}),e}}(),t=Object(d.h)();return function(n,r){let a=Object(s.b)(n),i=Object(s.a)(n)||Object(c.l)(n);const o=e(n,r),g=Object(l.c)(n),v=t(n,[p.b,"SitemapDesigner.Processing","Updating_Offline_Data"]),S=Object(u.b)(n),O=Object(m.c)(n,b.l),C=Object(_.e)(n),E=Object(y.a)(n),I=Object(y.b)(n);if(g===h.a.InProgress){const e=Object(l.d)(n);e&&e.itemsToSync>0&&"number"==typeof e.itemsSynced&&(a=String.format(Object(d.c)(v,p.b),Math.floor(100*e.itemsSynced/e.itemsToSync))),i=!0}else S!==f.a.InProgress||O?C&&E&&I&&(a=Object(d.c)(v,"Updating_Offline_Data"),i=!0):(a=Object(d.c)(v,"SitemapDesigner.Processing"),i=!0);return{message:a,isInProgress:i,progressIndicatorBackgroundContainerStyle:o.progressIndicatorBackgroundContainerStyle,progressIndicatorContentStyle:o.progressIndicatorContentStyle,progressIndicatorContainerStyle:o.progressIndicatorContainerStyle,progressIndicatorIndicatorStyle:o.progressIndicatorIndicatorStyle,progressIndicatorTextStyle:o.progressIndicatorTextStyle,progressIndicatorAccessibilityAlertStyle:o.progressIndicatorAccessibilityAlertStyle}}}),(function(e,t){return{retrieveResourceStrings:t=>e(Object(g.e)(t))}}))(o.b)},n6Qt:function(e,t,n){"use strict";n.d(t,"a",(function(){return H}));var r,a=n("ABCl"),i=n("OQLa"),o=n("Lyxw"),s=n("16wZ"),c=n("iZ7K"),l=n("DRVD"),u=n.n(l),d=n("3yqi");!function(e){e.entityTypeName="entityTypeName",e.id="id",e.pageType="pageType",e.entityrecord="entityrecord",e.viewid="viewid",e.viewType="viewType"}(r||(r={}));var p=n("SAYH"),g=n("F1Lu"),h=n("4N6w"),f=n("f07+"),m=n("aRLb"),b=n("Lohl"),_=n("odYE"),y=n("y60j"),v=n("E5IU"),S=n("BlGn"),O=n("tICD"),C=n("NjDY"),E=n("d5N6"),I=n("SZCI"),w=n("a72m"),j=n("d0w6"),P=n("hBJV"),T=n("uCpV"),N=n("X37l"),A=n("IaGr"),D=n("XIaj"),R=n("yGgp"),x=n("1Ibc"),M=n("bo6D"),F=n("xE5/"),k=n("d/SG"),L=n("arV0"),B=n("zmL5"),U=n("6lVV"),V=n("3/02"),z=n("37s6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const W={};let q;class H{constructor(e,t,n,r){this._clientApiExecutor=new a.b(e,"ClientApi.XrmInternal.");const i=this._clientApiExecutor.getComponentName("constructor");Object(s.g)(e,i,"store"),Object(s.g)(t,i,"context"),Object(s.g)(n,i,"globalContext"),q=e,this._context=t,this._globalContextInstance=n,this._pageId=r,window.addEventListener("message",this._xmlInternalMessageHandler)}_xmlInternalMessageHandler(e){e&&e.data&&"userViewChanged"===e.data.eventName&&e.data.viewData&&e.data.viewData.entityName&&(q.dispatch(Object(w.b)(e.data.viewData.entityName,j.a.MAIN_APPLICATION_VIEW,!0)),q.dispatch(Object(P.a)()))}initiateOfflineDataSync(e){return this._clientApiExecutor.executeAsync("initiateOfflineDataSync",()=>Object(o.c)(q.getState(),V.Vb)&&Object(z.w)(q.getState())?q.dispatch(Object(U.c)(e)):Promise.resolve(),[{name:"entities",value:e,isRequired:!0}])}getEntityName(e){return this._clientApiExecutor.execute("getEntityName",()=>Object(c.m)(q.getState(),e)||"",[{name:"entityTypeCode",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"number"}])}openLegacyWebDialog(e,t,n,r,i){this._clientApiExecutor.execute("openLegacyWebDialog",(r,o)=>{let s={};t&&(s={width:t.width,height:t.height}),s.windowPosition="center",q.dispatch(Object(S.a)(e,s,n,this._pageId)).then(e=>{0===e.status&&q.dispatch(Object(O.a)(e.pageId)).then(e=>{e.reason!==E.b&&e.reason!==E.d||!i||Object(a.c)(r,o,()=>{i({inboundArgs:n,outboundArgs:e.value})})})})},[{name:"url",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"options",value:t,isRequired:!0}])}getEntityNameAsync(e){return this._clientApiExecutor.executeAsync("getEntityNameAsync",()=>{const t=this.getEntityName(e);if(t)return Promise.resolve(t);const n="$filter=ObjectTypeCode eq "+e,r=new f.e(n,["LogicalName"]);q.dispatch(Object(m.b)(r)).then(e=>{e.json().then(e=>{if(e&&e.value&&e.value[0]&&e.value[0].LogicalName)return Promise.resolve(e.value[0].LogicalName);Promise.reject(new Error("Entity name is null"))})})},[{name:"entityTypeCode",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"number"}])}isFeatureEnabled(e){return this._clientApiExecutor.execute("isFeatureEnabled",()=>Object(o.b)(q.getState(),e),[{name:"featureName",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"}])}isNativeFeatureEnabled(e){return this._clientApiExecutor.execute("isNativeFeatureEnabled",()=>Object(o.d)(q.getState(),e),[{name:"featureName",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"}])}isUci(){return this._clientApiExecutor.execute("isUci",()=>!0)}createPerformanceStopwatch(e,t){return this._clientApiExecutor.execute("createPerformanceStopwatch",()=>(W[e]||(W[e]=u.a.createEvent(e,I.e)),W[e].startStopwatch(t)),[{name:"name",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"}])}reportToWatson(e,t,n,r,a,i,o){return this._clientApiExecutor.executeAsync("reportToWatson",(e,t)=>(A.a.getInstance().traceManager.getTracer(e).error("Watson error report",t),Promise.resolve()),[{name:"message",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"url",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"lineNumber",value:n,isRequired:!0,isEventParam:!0,expectedDataType:"number"},{name:"sendReportToWatson",value:r,isRequired:!0,isEventParam:!0,expectedDataType:"boolean"},{name:"callerFunction",value:a,isRequired:!0},{name:"exceptionNumber",value:i,isRequired:!0,isEventParam:!0,expectedDataType:"number"},{name:"reportFunctionBody",value:o,isRequired:!0,isEventParam:!0,expectedDataType:"boolean"}])}getEntityCode(e){return this._clientApiExecutor.execute("getEntityCode",()=>Object(c.p)(q.getState(),e),[{name:"entityTypeName",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"}])}getCurrentPageUrl(e,t){return this._clientApiExecutor.execute("getCurrentPageUrl",()=>{const n={entityTypeName:e.entityType,etn:e.name,id:p.a.fromExternalGuid(e.id)},r=q.getState(),a=Object(L.g)(r,this._pageId);Object(L.l)(r,this._pageId)===d.a.EditForm&&a.entityTypeName===n.entityTypeName&&p.a.equals(a.id,n.id)&&(n.formId=Object(B.b)(r,this._pageId));let o=null;return o=1===t?q.dispatch(Object(i.a)(d.a.EditForm,n)):q.dispatch(Object(i.b)(d.a.EditForm,n)),o},[{name:"entityRef",value:e,isRequired:!0}])}getEmailLink(e){return this._clientApiExecutor.execute("getEmailLink",()=>{const t=this._globalContextInstance.getQueryStringParameters(),n=e?e.entityType:t&&t[r.entityTypeName]?t[r.entityTypeName]:"",a=r.entityrecord,i=e?e.id:t&&t[r.id]?t[r.id].substring(1,t[r.id].length-1):"",o=this._globalContextInstance.getClientUrl(),s=Object(v.i)(q.getState());let c="";if("report"===n){c=`${o}${`/crmreports/viewer/viewer.aspx?${s?`appid=${encodeURIComponent(s)}&`:""}id=`}${encodeURIComponent(i)}`}else{c=`${o}${`/main.aspx?appid=${encodeURIComponent(s)}&`}etn=${encodeURIComponent(n)}&id=${encodeURIComponent(i)}&pagetype=${a}`}return c})}getActivityId(){return this._context.EventManager.getActivityId()}canOpenUrl(e){return this._clientApiExecutor.executeAsync("canOpenUrl",()=>new g.a(this._context,q).canOpenUri(e),[{name:"url",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"}])}getAuthToken(){return this._clientApiExecutor.execute("getAuthToken",()=>Object(h.a)(q.getState())||null)}getFormId(e,t){return this._clientApiExecutor.executeAsync("getFormId",()=>{const n=new _.a(e);return q.dispatch(Object(b.b)(n,null,t)).then(()=>{const n=Object(y.h)(q.getState(),e,t);let r=null;return n&&(r=n.guid),r})},[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"formType",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"string"}])}getAllowLegacyDialogsEmbedding(){return this._clientApiExecutor.execute("getAllowLegacyDialogsEmbedding",()=>{let e=!1;const t=Object(C.x)(q.getState());return t&&(e=!!t.allowLegacyDialogsEmbedding),e})}addRecentItem(e){this._clientApiExecutor.execute("addRecentItem",()=>{const t={RecordType:e.recordType?e.recordType:N.a.Invalid,ObjectId:e.objectId?p.a.fromExternalGuid(e.objectId):p.a.EMPTY,EntityTypeName:e.entityTypeName?e.entityTypeName:"",Title:e.title?e.title:"",LastAccessed:new Date,PinStatus:e.pinStatus,IsUserView:e.isUserView?e.isUserView:null,IconPath:e.iconPath?e.iconPath:null,HasPrimaryImageField:e.hasPrimaryImageField?e.hasPrimaryImageField:null};q.dispatch(Object(T.b)(t))},[{name:"recent",value:e,isRequired:!0}])}addPopupNotification(e){const t=e.entityLookUpValue;return this._clientApiExecutor.execute("addPopupNotification",()=>{let n;t&&(n=new _.a(t.entityType,new p.a(t.id),t.name));const r={id:p.a.newGuid().guid,title:e.title,entityReference:n,imageUrl:e.imageUrl,details:e.details,type:e.type,acceptAction:e.acceptAction,declineAction:e.declineAction,timeoutAction:e.timeoutAction,themeType:e.themeType||"dark"};return q.dispatch(Object(D.b)(r)).then(()=>r.id)},[{name:"popupNotification",value:e,isRequired:!0}])}clearPopupNotification(e){return this._clientApiExecutor.execute("clearPopupNotification",()=>q.dispatch(Object(R.b)(e)),[{name:"id",value:e,isRequired:!0}])}isDisruptiveFeatureEnabled(e,t,n){return this._clientApiExecutor.execute("isDisruptiveFeatureEnabled",()=>Object(o.a)(q.getState(),e,t,n),[{name:"featureFCBName",value:e,isRequired:!0,expectedDataType:"string"},{name:"serverSidePreviewFCB",value:t,isRequired:!1,expectedDataType:"string"},{name:"groupFeatureOverrideFCB",value:n,isRequired:!1,expectedDataType:"string"}])}isContextualHelpBrowserEnabled(){return Object(x.a)(q.getState())}openContextualHelpBrowser(){Object(x.a)(q.getState())&&q.dispatch(Object(M.b)())}closeContextualHelpBrowser(){Object(x.a)(q.getState())&&q.dispatch(Object(F.b)())}toggleContextualHelpBrowser(){Object(x.a)(q.getState())&&q.dispatch(Object(k.b)())}}},nA3O:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("kToj"),a=n("8uvO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i{constructor(e){this._properties=[];for(const t in e)e[t]instanceof a.a&&this._properties.push(e[t]);for(const t in e.constructor)e.constructor[t]instanceof a.a&&this._properties.push(e.constructor[t])}get_count(){return this._properties.length}get_item(e){return this._properties[e]}}class o{constructor(e,t,n,r){this.instance=e,this.property=t,this.oldValue=n,this.newValue=r}}var s=n("504W");class c{constructor(){this._dirtyPropertyMap=null}getSchema(){return new i(this)}getValue(e){this._AssertPropertyOwnerType(e);const t=this[e.get_name()];return void 0===t?e.get_defaultValue():t}setValue(e,t){this._AssertPropertyOwnerType(e),e.AssertPropertyValue(t);const n=this.getValue(e);if(n!==t){const r=new o(this,e,n,t);e.raisePropertyChanging(r),this[e.get_name()]=t,this._dirtyPropertyMap||(this._dirtyPropertyMap={}),this._dirtyPropertyMap[e.get_name()]=!0,e.raisePropertyChanged(r),this.onPropertyChanged(r)}}setValues(e){e=e;const t=this.getSchema();for(let n=0;n<t.get_count();n++)this.setSinglePropertyFromDictionary(e,t.get_item(n))}getValues(){const e={},t=this.getSchema();for(let n=0;n<t.get_count();n++)this.putSinglePropertyIntoDictionary(e,t.get_item(n));return e}setSinglePropertyFromDictionary(e,t){const n=t.get_jsonConverter().read(e,t),r=t.coerceToPropertyType(n);this.setValue(t,r)}putSinglePropertyIntoDictionary(e,t){const n=this.getValue(t),r=t.coerceToJsonType(n);t.get_jsonConverter().write(e,t,r)}onPropertyChanged(e){}_AssertPropertyOwnerType(e){Object(r.a)(!Object(s.a)(e),"Property of "+Object.getType(this).getName()+" cannot be null or undefined."),Object(r.a)(this instanceof e.get_ownerType(),String.format("{0} is not intended to be used with {1}.",e.get_name(),Object.getType(this).getName()))}}},nDua:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r,a;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e.ADVANCED="advanced",e.APP_SHELL_BREAK_POINT=768,e.APP_SHELL_QUERY_PARAM="appshellmode",e.APP_SHELL_TRACER_CATEGORY="InAppShell",e.SUB_AREA_ID_PREFIX="appShellSubArea_",e.GROUP_BUTTON_ID_PREFIX="appShellGroupCollapseExpandButton_",e.GROUP_ID_PREFIX="appShellGroup_",e.SETUP_SUMMARY_LIST_ITEM_ID="appShellSetupSummaryListItem",e.APP_SHELL_TELEMETRY_ZONE="InAppShell"}(r||(r={})),function(e){e.QUICKSHELLID="QuickShellId",e.ADVANCEDSHELLID="AdvancedShellId",e.APPID="AppId",e.SUBAREAURL="SubAreaUrl",e.NAVSETTINGSID="NavigationSettingsId",e.GROUPID="GroupId",e.ERRORSOURCE="ErrorSource",e.APP_SHELL_COMPONENT_NAME="InAppShell"}(a||(a={}))},nJrx:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r=function(){let e=0;return()=>"id-"+ ++e}(),a=function(){const e={};return t=>(e[t]||(e[t]=0),`id-${t}-${++e[t]}`)}()},nTyX:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return c}));var r,a=n("P68g");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e){return Object(a.a)(e,e=>c(e))}function o(e){return Object(a.a)(e,e=>s(e))}function s(e){switch(e){case r.Boolean:return"boolean";case r.Customer:return"customer";case r.DateTime:return"datetime";case r.Decimal:return"decimal";case r.Double:return"double";case r.Integer:return"integer";case r.Lookup:return"lookup";case r.Memo:return"memo";case r.Money:return"money";case r.Owner:return"owner";case r.PartyList:return"partylist";case r.Picklist:return"picklist";case r.State:return"state";case r.Status:return"status";case r.String:return"string";case r.UniqueIdentifier:return"uniqueidentifier";case r.CalendarRules:return"calendarrules";case r.Virtual:return"virtual";case r.BigInt:return"bigint";case r.ManagedProperty:return"managedproperty";case r.EntityName:return"entityname";case r.AliasedValue:return"aliasedvalue";case r.EntityImage:return"entityimage";case r.MultiSelectPicklist:return"multiselectpicklist";case r.File:return"file";case r.NavigationProperty:return"navigationproperty";default:return"unknown"}}function c(e){switch(e){case"boolean":return r.Boolean;case"customer":return r.Customer;case"datetime":return r.DateTime;case"decimal":return r.Decimal;case"double":return r.Double;case"integer":return r.Integer;case"lookup":return r.Lookup;case"memo":return r.Memo;case"money":return r.Money;case"owner":return r.Owner;case"partylist":return r.PartyList;case"picklist":return r.Picklist;case"state":return r.State;case"status":return r.Status;case"string":return r.String;case"uniqueidentifier":return r.UniqueIdentifier;case"calendarrules":return r.CalendarRules;case"virtual":return r.Virtual;case"bigint":return r.BigInt;case"managedproperty":return r.ManagedProperty;case"entityname":return r.EntityName;case"aliasedvalue":return r.AliasedValue;case"entityimage":return r.EntityImage;case"multiselectpicklist":return r.MultiSelectPicklist;case"file":return r.File;case"navigationproperty":return r.NavigationProperty;default:return r.Unknown}}!function(e){e[e.Unknown=-1]="Unknown",e[e.Boolean=0]="Boolean",e[e.Customer=1]="Customer",e[e.DateTime=2]="DateTime",e[e.Decimal=3]="Decimal",e[e.Double=4]="Double",e[e.Integer=5]="Integer",e[e.Lookup=6]="Lookup",e[e.Memo=7]="Memo",e[e.Money=8]="Money",e[e.Owner=9]="Owner",e[e.PartyList=10]="PartyList",e[e.Picklist=11]="Picklist",e[e.State=12]="State",e[e.Status=13]="Status",e[e.String=14]="String",e[e.UniqueIdentifier=15]="UniqueIdentifier",e[e.CalendarRules=16]="CalendarRules",e[e.Virtual=17]="Virtual",e[e.BigInt=18]="BigInt",e[e.ManagedProperty=19]="ManagedProperty",e[e.EntityName=20]="EntityName",e[e.AliasedValue=21]="AliasedValue",e[e.EntityImage=23]="EntityImage",e[e.MultiSelectPicklist=24]="MultiSelectPicklist",e[e.File=25]="File",e[e.NavigationProperty=26]="NavigationProperty"}(r||(r={}))},nVTU:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(e,t,n){this._etn=e,this._id=t||"",this._name=n,Object.freeze(this)}return Object.defineProperty(e.prototype,"entityName",{get:function(){return this._etn},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"entityType",{get:function(){return this._etn},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logicalName",{get:function(){return this._etn},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"LogicalName",{get:function(){return this._etn},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Id",{get:function(){return this._Id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Name",{get:function(){return this._name},enumerable:!1,configurable:!0}),e.toString=function(e){return e.entityName+":"+e.id},e.equals=function(e,t){return!e&&!t||!(!e||!t)&&(e.entityName===t.entityName&&e.id===t.id&&e.name===t.name)},e.EMPTY=new e(""),e}()},nVeB:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("JTy6"),a=n("ruPX"),i=n("tICD"),o=n("VnpK"),s=n("SAYH");function c(e,t,n,i,c,l,u,d,p,g,h,f,m){const b=d?function(e){if(!e)return null;const t={};for(let n=0;n<e.length;n++){const r=e[n];if(r&&r.filterXml){let e="GENERAL_FILTER_NAME";r.entityLogicalName&&(e=r.entityLogicalName),t[e]||(t[e]=[]);const n=Object(o.i)(r.filterXml);n&&(n.conditions&&n.conditions.length>0||n.filters&&n.filters.length>0)&&t[e].push(JSON.stringify(n))}}return t}(d):null;let _=null;b&&(_=b.GENERAL_FILTER_NAME,delete b.GENERAL_FILTER_NAME);const y={defaultEntityType:t,defaultViewId:n,entityTypes:i,viewIds:c,allowMultiSelect:l,lookupType:e,data:u,extraFilters:_,additionalTargetExtraFilters:b,disableMru:p,entityTypeName:h,id:s.a.tryParse(f),searchText:m};return Object(a.a)(r.a,y,g)}function l(e,t,n){const{allowMultiSelect:r,createFromEntity:a,defaultViewId:o,disableMru:l,entityTypes:u,filters:d,searchText:p,viewIds:g}=e;return n(c(r?"Lookup.PartyList":u.length>1?"Lookup.MultiEntity":"Lookup.Simple",u[0],o,u,g,r,null,d,l,t,null==a?void 0:a.entityType,null==a?void 0:a.id,p)).then(e=>1===e.status?Promise.reject(e.error):n(Object(i.a)(e.pageId)).then(e=>{var t;let n=[];const r=null===(t=null==e?void 0:e.value)||void 0===t?void 0:t.length,a=1===r&&!e.value[0];return r&&!a&&(n=e.value.map(e=>({id:s.a.externalGuid(s.a.fromExternalGuid(e.id)),entityType:e.entityName,name:e.name}))),n}))}},nfLm:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.none=0]="none",e[e.main=1]="main",e[e.appointment=2]="appointment",e[e.hardcoded=3]="hardcoded",e[e.miniCampaignBO=4]="miniCampaignBO",e[e.preview=5]="preview",e[e.dashboard=6]="dashboard",e[e.quick=7]="quick",e[e.quickCreate=8]="quickCreate",e[e.mobile=9]="mobile",e[e.read=10]="read",e[e.card=11]="card",e[e.dialog=12]="dialog",e[e.taskBased=14]="taskBased",e[e.interactionCentricDashboard=15]="interactionCentricDashboard",e[e.advancedSearch=16]="advancedSearch",e[e.subGrid=17]="subGrid",e[e.quickFindSearch=18]="quickFindSearch",e[e.reporting=19]="reporting",e[e.offlineFilters=20]="offlineFilters",e[e.maSearch=21]="maSearch",e[e.lookup=22]="lookup",e[e.smAppointmentBook=23]="smAppointmentBook",e[e.outlookFilters=24]="outlookFilters",e[e.addressbookFilters=25]="addressbookFilters",e[e.savedQueryTypeOther=26]="savedQueryTypeOther",e[e.interactiveWorkFlow=27]="interactiveWorkFlow",e[e.offlineTemplate=28]="offlineTemplate",e[e.outlookTemplate=29]="outlookTemplate",e[e.customDefined=30]="customDefined",e[e.jScript=31]="jScript",e[e.css=32]="css",e[e.png=33]="png",e[e.jpg=34]="jpg",e[e.gif=35]="gif",e[e.advancedFind=36]="advancedFind"}(r||(r={}))},ngeo:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("YxC/"),a=n("EY5k"),i=n("Uv1Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class o{constructor(e,t){this._store=null,this._tracer=null,this._store=e,this._tracer=t}updateResources(e){this._tracer&&this._tracer.info("updateResources stub was called.")}getLocalizedString(e){return Object(r.b)(this._store.getState(),e)}getErrorMessage(e,t){if(t){const n=this.getLocalizedString(e)||e;return String.format(n,t)}return this.getLocalizedString(e)}static getHexErrorCodeFromInt(e){let t=e;return t<0&&(t=t+4294967295+1),t.toString(16)}static retrieveErrorMessage(e,t,...n){return new Promise((s,c)=>{const l=0===t?i.a.DEFAULT_ERROR_MESSAGE_ID:"Error_Message_0x"+o.getHexErrorCodeFromInt(t);e.dispatch(Object(a.e)([l])).then(()=>{const t=Object(r.b)(e.getState(),l);t&&n&&n.length>0?s(String.format(t,n)):s(t)},()=>{c(Object(r.b)(e.getState(),i.a.DEFAULT_ERROR_MESSAGE_ID))})})}}o.TRACER_CATEGORY_ID="ResourceManager"},ngzy:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("84PK"),a=n("504W");class i{constructor(e,t,n){this._profileId=null,this._profileVersion=null,this._offlineAvailableEntities=null,this._profileId=Object(a.a)(e)?r.a.get_empty():e,this._offlineAvailableEntities=t,this._profileVersion=Object(a.b)(n)?"":n}get_profileId(){return this._profileId}get_profileVersion(){return this._profileVersion}get_offlineAvailableEntities(){return this._offlineAvailableEntities}getObjectData(){const e={};return e.profileid=this._profileId.getObjectData(),e.offlineavailableentities=this._offlineAvailableEntities,e.profileversion=this._profileVersion,e}static createFromObjectData(e){let t=r.a.get_empty(),n="",o=[];if(e){if(e.profileid.toString()!==r.a.get_empty().toString()&&(t=r.a.createFromObjectData(e.profileid)),Object.getType(e.offlineavailableentities)===Object){const t=e.offlineavailableentities;for(const e in t){const n={key:e,value:t[e]};o.push(n.value.toString())}}else o=e.offlineavailableentities;Object(a.b)(e.profileversion.toString())||(n=e.profileversion.toString())}return new i(t,o,n)}}},niX0:function(e,t,n){"use strict";n.d(t,"c",(function(){return g})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return m}));var r=n("uNu9"),a=n("iZ7K"),i=n("YxC/"),o=n("p9KN"),s=n("37s6"),c=n("w1eR"),l=n("GYEz"),u=n("0l0t"),d=n("PtYj"),p=n("eZ32");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function g(e){const t=[];return t.push({areaId:u.e,id:"navAsyncOperations",entityName:r.f,title:Object(i.b)(e,o.b),order:9500,show:!0}),t.push({areaId:u.b,id:"navConnections",entityName:r.z,title:Object(i.b)(e,o.c),order:8500,show:!0}),t.push({areaId:u.b,id:"navFeedback",entityName:r.U,title:Object(i.b)(e,o.e),order:9958,show:!0}),t.push({areaId:u.e,id:"navProcessSessions",entityName:r.vb,title:Object(i.b)(e,o.p),order:9700,show:!0}),t.push({areaId:u.b,id:"navTraces",entityName:r.bc,iconPath:"/_imgs/area/18_alerts.png",title:null,order:8050,show:!0}),t}const h={[r.f]:"regardingobjectid",[r.z]:"record1id",[r.U]:"regardingobjectid",[r.vb]:"regardingobjectid",[r.Vb]:"regardingobjectid",[r.xb]:"associatedproduct",[r.B]:"contactid"};function f(e,t,n){const a=[];if(Object(d.a)(e,n||t)){const t="Audit.Incontext.AreaTitle",n=Object(i.b)(e,t);a.push({areaId:u.b,id:"navAudit",entityName:r.g,title:n,order:9600,show:!0})}switch(t){case r.wb:a.push({areaId:u.b,id:"navProductBundles",entityName:r.xb,iconPath:"/_imgs/ico_18_1024.gif",title:Object(i.b)(e,o.o),order:0,show:!0}),a.push({areaId:u.b,id:"navPrices",entityName:r.yb,order:0,show:!0});break;case r.Cb:a.push({areaId:u.b,id:"navOrders",entityName:r.Kb,order:0,show:!0});break;case r.q:a.push({areaId:u.b,id:"navActivities",entityName:r.b,iconPath:"/_imgs/ico_18_camptask.gif",title:Object(i.b)(e,o.m),order:0,show:!0}),a.push({areaId:u.b,id:"navCampaignActivities",entityName:r.r,order:0,show:!0}),a.push({areaId:u.b,id:"navCampaignResponses",entityName:r.s,order:0,show:!0}),a.push({areaId:u.f,id:"navTargetProducts",entityName:r.wb,title:Object(i.b)(e,o.w),order:0,show:!0}),a.push({areaId:u.f,id:"navCollaterals",entityName:r.Jb,order:0,show:!0}),a.push({areaId:u.c,id:"navWebLeads",entityName:r.nb,title:Object(i.b)(e,o.x),order:0,show:!0}),a.push({areaId:u.d,id:"navTargetLists",entityName:r.jb,title:Object(i.b)(e,o.v),order:0,show:!0}),a.push({areaId:u.d,id:"navCampaigns",entityName:r.q,iconPath:"/_imgs/ico_18_camp.gif",title:Object(i.b)(e,o.q),order:0,show:!0});break;case r.y:a.push({areaId:u.f,id:"navOpportunities",entityName:r.ob,order:0,show:!0}),a.push({areaId:u.b,id:"navProducts",entityName:r.wb,order:0,show:!0}),a.push({areaId:u.f,id:"navSalesLit",entityName:r.Jb,order:0,show:!0});break;case r.D:a.push({areaId:u.g,id:"navCases",entityName:r.ab,iconPath:"/_imgs/ico_18_112.gif",order:0,show:!0});break;case r.C:a.push({areaId:u.b,id:"navContractLines",entityName:r.D,iconPath:"/_imgs/ico_18_1011.gif",order:0,show:!0}),a.push({areaId:u.g,id:"navCases",entityName:r.ab,iconPath:"/_imgs/ico_18_112.gif",order:0,show:!0}),a.push({areaId:u.b,id:"navActivities",entityName:r.b,iconPath:"/_imgs/ico_18_act.gif",order:0,show:!0});break;case r.gb:a.push({areaId:u.d,id:"navCampaignsInSFA",entityName:r.q,order:0,show:!0});break;case r.jb:a.push({areaId:u.b,id:"navListMember",entityName:r.nb,iconPath:"/_imgs/ico_18_4301.gif",title:Object(i.b)(e,o.i),order:0,show:!0}),a.push({areaId:u.d,id:"navCampaignsInList",entityName:r.q,order:0,show:!0}),a.push({areaId:u.d,id:"navMiniCampaignsForList",entityName:r.p,iconPath:"/_imgs/ico_18_minicamps.gif",order:0,show:!0});break;case r.Jb:a.push({areaId:u.b,id:"navDoc",entityName:r.Jb,order:0,show:!0}),a.push({areaId:u.f,id:"navComp",entityName:r.y,order:0,show:!0}),a.push({areaId:u.b,id:"navProducts",entityName:r.wb,order:0,show:!0});break;case r.Wb:a.push({areaId:u.b,id:"navTeams",entityName:r.Yb,order:0,show:!0}),Object(s.q)(e)===p.a.Available&&Object(l.a)(e)!==c.a.MailApp&&a.push({areaId:u.b,id:"navFieldSecurityProfiles",entityName:r.V,order:0,show:!0}),Object(s.q)(e)===p.a.NotAvailable&&(a.push({areaId:u.g,id:"navServices",entityName:r.Mb,title:Object(i.b)(e,o.u),order:0,show:!0}),a.push({areaId:u.g,id:"navResourceGroups",entityName:r.A,title:Object(i.b)(e,o.r),order:0,show:!0}),a.push({areaId:u.b,id:"navMonthlyCalendar",entityName:r.nb,iconPath:"/_imgs/area/18_calendar.gif",title:Object(i.b)(e,o.y),order:0,show:!0}));break;case r.Yb:Object(s.q)(e)===p.a.Available&&Object(l.a)(e)!==c.a.MailApp&&a.push({areaId:u.b,id:"navFieldSecurityProfiles",entityName:r.V,order:0,show:!0});break;case r.ac:a.push({areaId:u.b,id:"navMembers",entityName:r.Wb,iconPath:"/_imgs/ico_18_team_inc.gif",title:Object(i.b)(e,o.j),order:0,show:!0});break;case r.Y:a.push({areaId:u.b,id:"navSuccesses",entityName:r.nb,order:0,show:!0}),a.push({areaId:u.b,id:"navPartialFailures",entityName:r.nb,order:0,show:!0}),a.push({areaId:u.b,id:"navFailures",entityName:r.Z,title:Object(i.b)(e,o.f),order:0,show:!0}),a.push({areaId:u.e,id:"navAsyncOperations",entityName:r.f,title:Object(i.b)(e,o.a),order:0,show:!0});break;case r.bb:a.push({areaId:u.b,id:"navContacts",entityName:r.B,title:Object(i.b)(e,o.l),order:0,show:!0}),a.push({areaId:u.b,id:"navActivities",entityName:r.b,iconPath:"/_imgs/ico_18_act.gif",order:0,show:!0}),a.push({areaId:u.b,id:"navActivityHistory",entityName:r.nb,iconPath:"/_imgs/ico_18_history.gif",title:Object(i.b)(e,o.k),order:0,show:!0});break;case r.H:a.push({areaId:u.b,id:"navDiscounts",entityName:r.G,iconPath:"/_imgs/ico_16_1013.gif",order:0,show:!0});break;case r.ub:a.push({areaId:u.b,id:"navItems",entityName:r.yb,iconPath:"/_imgs/ico_18_1026.gif",order:0,show:!0});break;case r.ec:a.push({areaId:u.b,id:"navUnits",entityName:r.dc,order:0,show:!0});break;case r.nb:a.push({areaId:u.b,id:"navActivities",entityName:r.b,iconPath:"/_imgs/ico_18_act.gif",order:0,show:!0})}return a}function m(e,t,n,i){if("navTeams"===i)return{relationshipName:"teammembership_association",referencingEntity:"team"};const o=Object(a.C)(e,t);if(!o)return;const s=Object.keys(o),c=h[n];for(const e of s){const t=o[e];if(!(t.ReferencingEntity!==n||c&&t.ReferencingAttribute!==c))return{relationshipName:e,referencingEntity:t.ReferencingEntity};if(i){if("navAudit"===i)return{relationshipName:"audit",referencingEntity:r.g};if(i&&t.AssociatedMenuConfiguration.MenuId===i)return{relationshipName:e,referencingEntity:t.ReferencingEntity}}}const l=Object(a.v)(e,t);if(!l)return;const u=Object.keys(l);for(const e of u){const r=l[e],a=r.Entity1LogicalName!==t?r.Entity1IntersectAttribute:r.Entity2IntersectAttribute,o=r.Entity1LogicalName===n?r.Entity1LogicalName:r.Entity2LogicalName;if(t===n){if(r.Entity1LogicalName===r.Entity2LogicalName&&r.Entity1IntersectAttribute&&r.Entity2IntersectAttribute)return{relationshipName:e,referencingEntity:n}}else{if(o===n&&a)return{relationshipName:e,referencingEntity:o};if(i&&(r.Entity1AssociatedMenuConfiguration.MenuId===i||r.Entity2AssociatedMenuConfiguration.MenuId===i)){return{relationshipName:e,referencingEntity:r.Entity1AssociatedMenuConfiguration.MenuId===i?r.Entity1LogicalName:r.Entity2LogicalName}}}}}},nlPs:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u}));var r=n("arV0"),a=n("dHD5"),i=n("OtHk"),o=n("cfbi"),s=n("UIlN"),c=n("pnQK"),l=n("zmL5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(e,t){const n=Object(s.b)(e,t);return n&&n.contextToken}function d(e,t){const n=Object(r.l)(e,t);if("EditForm"===n||"QuickCreateForm"===n||"ModalDialog"===n||"Dialog"===n||n===o.b)return Object(a.j)(e,t);if("Grid"===n)return Object(a.k)(e,t);if("Dashboard"===n){const n=Object(r.g)(e,t);let o=n.dashboardId;const s=n.etn;return!o&&s?o=Object(i.e)(e,s):o||(o=Object(l.b)(e,t)),o||(o=Object(c.b)(e,s)),Object(a.d)(e,o)}return"Control"===n?Object(a.b)(e,t):null}},nmJf:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("M0zh"),a=n("sZ+8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e){return Object(r.w)(e,a.l)}},nxXM:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return u}));var r=n("Wgxh"),a=n("9692"),i=n("ddoO"),o=n("SAYH"),s=n("HfZT"),c=n("2jAf");function l(e){return{type:"garbage.collect.data.sync",sync:!0,execute({dispatch:t,getState:n},o){const s=n(),l={},u={},p=Object(i.e)(s);for(const t in p){const n=p[t];for(const a in n){const i=n[a]&&n[a].slice(),o=Object(r.b)(i,e);if(o)if(0===o.length)if(u[t])u[t][a]=null;else{const e={[a]:null};u[t]=e}else l[t]||(l[t]={}),l[t][a]=o}}const g={},h={},f=Object(i.j)(s);for(const t in f){const n=f[t]&&f[t].slice(),a=Object(r.b)(n,e);a&&(0===a.length?h[t]=null:g[t]=a)}const m={},b={},_={},y=Object(i.d)(s);for(const t in y){const n=y[t];for(const a in n){const i=n[a]&&n[a].slice(),o=Object(r.b)(i,e);if(o)if(0===o.length)if(b[t])b[t][a]=null;else{const e={[a]:null};b[t]=e}else m[t]||(m[t]={}),m[t][a]=o}b[t]&&n&&Object.keys(n).length===Object.keys(b[t]).length&&(_[t]=null)}const v={},S={},O=Object(i.a)(s);for(const t in O){const n=O[t]&&O[t].slice(),a=Object(r.b)(n,e);a&&(0===a.length?S[t]=null:v[t]=a)}if(Object.keys(l).length>0||Object.keys(g).length>0||Object.keys(m).length>0||Object.keys(v).length>0){t(d({entities:l,lists:g,charts:m,chartData:v}))}if(Object.keys(u).length>0||Object.keys(h).length>0||Object.keys(b).length>0||Object.keys(S).length>0){t((C={entities:u,lists:h,charts:b,chartData:S},{type:a.a,payload:C}))}var C;if(Object.keys(_).length>0){const e={charts:_};t(Object(c.d)(e))}}}}function u(e){return{type:"garbage.collector.update.data.entities.sync",sync:!0,execute({dispatch:t,getState:n},r){const a={};for(let t=0;t<e.length;t++){const r=o.a.toString(e[t].id),i=e[t].etn,c=Object(s.c)(n(),i,r);if(c)if(a[i])a[i][r]=c;else{const e={[r]:c};a[i]=e}}if(Object.keys(a).length>0){t(d({entities:a,lists:null,charts:null}))}}}}function d(e){return{type:a.b,payload:e}}},nxt5:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e){this._name=null,this._name=e}get_name(){return this._name}}},"nzu+":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("pgSX"),a=n("si7p");function i(e,t,n){"string"==typeof e&&(e={text:e});const{text:i,title:o,confirmButtonLabel:s}=e;return{type:"form.openAlertDialog",execute:({dispatch:e})=>e(Object(r.a)(a.a,i,t,s,o,void 0,void 0,void 0,void 0,void 0,n)),getFailureParameters:(e,n)=>[{name:"dialogHeight",value:t&&t.height},{name:"dialogWidth",value:t&&t.width},{name:"dialogPosition",value:t&&t.position},{name:"dialogWindowPosition",value:t&&t.windowPosition}]}}},o1og:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return c}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="offline.apply.application.metadata.changes",a="offline.applying.application.metadata.changes",i="offline.first.apply.application.metadata.changes";function o(e){return{type:r,payload:{applyApplicationMetadataChanges:e}}}function s(e){return{type:a,payload:{applyingApplicationMetadataChanges:e}}}function c(e){return{type:i,payload:{isFirstApplyApplicationMetadataChangesDone:e}}}},oAUI:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r={ERROR_LOADING_CONTROL:"Error loading control",VALIDATION_FAILED_EMAIL:"Value is not a valid email",VALIDATION_FAILED_BOOL:"Value is not a valid boolean",VALIDATION_FAILED_DATE:"Value is not a valid Date object",VALIDATION_FAILED_NUM:"Value is not a valid number",VALIDATION_FAILED_INT:"Number is not a valid integer",VALIDATION_FAILED_RANGE:"Value is not within the defined range for this property. Range is {0} to {1}",SELECT_TO_ENTER_DATA:"Select to enter data."},a=r;function i(e){return a[e]}function o(e){a=Object.assign(a,e)}},oBA7:function(e,t,n){"use strict";
/** @license React v16.10.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&Symbol.for,a=r?Symbol.for("react.element"):60103,i=r?Symbol.for("react.portal"):60106,o=r?Symbol.for("react.fragment"):60107,s=r?Symbol.for("react.strict_mode"):60108,c=r?Symbol.for("react.profiler"):60114,l=r?Symbol.for("react.provider"):60109,u=r?Symbol.for("react.context"):60110,d=r?Symbol.for("react.async_mode"):60111,p=r?Symbol.for("react.concurrent_mode"):60111,g=r?Symbol.for("react.forward_ref"):60112,h=r?Symbol.for("react.suspense"):60113,f=r?Symbol.for("react.suspense_list"):60120,m=r?Symbol.for("react.memo"):60115,b=r?Symbol.for("react.lazy"):60116,_=r?Symbol.for("react.fundamental"):60117,y=r?Symbol.for("react.responder"):60118,v=r?Symbol.for("react.scope"):60119;function S(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case a:switch(e=e.type){case d:case p:case o:case c:case s:case h:return e;default:switch(e=e&&e.$$typeof){case u:case g:case l:return e;default:return t}}case b:case m:case i:return t}}}function O(e){return S(e)===p}t.typeOf=S,t.AsyncMode=d,t.ConcurrentMode=p,t.ContextConsumer=u,t.ContextProvider=l,t.Element=a,t.ForwardRef=g,t.Fragment=o,t.Lazy=b,t.Memo=m,t.Portal=i,t.Profiler=c,t.StrictMode=s,t.Suspense=h,t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===o||e===p||e===c||e===s||e===h||e===f||"object"==typeof e&&null!==e&&(e.$$typeof===b||e.$$typeof===m||e.$$typeof===l||e.$$typeof===u||e.$$typeof===g||e.$$typeof===_||e.$$typeof===y||e.$$typeof===v)},t.isAsyncMode=function(e){return O(e)||S(e)===d},t.isConcurrentMode=O,t.isContextConsumer=function(e){return S(e)===u},t.isContextProvider=function(e){return S(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===a},t.isForwardRef=function(e){return S(e)===g},t.isFragment=function(e){return S(e)===o},t.isLazy=function(e){return S(e)===b},t.isMemo=function(e){return S(e)===m},t.isPortal=function(e){return S(e)===i},t.isProfiler=function(e){return S(e)===c},t.isStrictMode=function(e){return S(e)===s},t.isSuspense=function(e){return S(e)===h}},oLL6:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="businessProcessFlow.instance.businessprocessflowsbyid.update";function a(e){return{type:r,payload:e}}},oOvK:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l}));var r=n("Uv1Y"),a=n("Z/4N"),i=n("K7RF"),o=n("/oKV"),s=n("iJGp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c="retrieve.customcontrol.manifest",l="dummy.customcontrol.manifest.async";function u(e,t,n=!0){return{type:"retrieve.customcontrol.manifest.async",execute({dispatch:c,getState:l},u){const p=o.a.LocalAndRemote,g=(u.DataSource,l());return Object(a.e)(g,e)&&p===o.a.LocalAndRemote?Promise.resolve():c(function(e,t,n,a,o){return{type:"retrieve.customcontrol.manifest.async",execute({dispatch:e,getState:c},l){const u=Object(i.b)("customcontrol",null,null,null,!1,s.a.OnDemandWithContext,null,null,[t],null,a);return e(u).then(c=>!c||!c.controlManifests||Object.keys(c.controlManifests).length<1?(n&&n!==t||d(e,t,o),e(Object(i.b)("customcontrol",null,null,null,!1,s.a.OnDemandWithContext,null,null,[n],null,a)).then(n=>((!n||!n.controlManifests||Object.keys(n.controlManifests).length<1)&&d(e,t,o),n)).catch(r.b)):c).catch(c=>{if(n&&n!==t)return e(Object(i.b)("customcontrol",null,null,null,!1,s.a.OnDemandWithContext,null,null,[n],null,a)).then(n=>((!n||!n.controlManifests||Object.keys(n.controlManifests).length<1)&&d(e,t,o),n)).catch(r.b);d(e,t,o)})}}}(0,e,t,p,n))}}}function d(e,t,n){if(e(function(e){return{type:l,payload:{controlManifests:{[e]:null}}}}(t)),n)throw new r.a("No manifest found")}},oSQy:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return u}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="TabFlyout.KeyboardShortCut.Area",a="Flyout.KeyboardShortCut.Tab.NotAllowed",i="TabFlyout.KeyboardShortCut.Down",o="TabFlyout.KeyboardShortCut.Up",s="TabFlyout.KeyboardShortCut.Enter",c="TabFlyout.KeyboardShortCut.Escape",l="L_List_No_Records_Text",u=[r,a,i,o,s,c,l]},oT5e:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n("jhff"),a=n("zsAz"),i=n("+nTZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e){return Object(r.b)(e)}function s(e){return l(e,o(e))}function c(e){return null==e?void 0:e.browsingContexts}function l(e,t){var n;const r=null===(n=c(e))||void 0===n?void 0:n[t];if(!r)throw Object(a.d)("Browsingcontext does not exist",2415919107,[{name:"id",value:t}]);return r}function u(e,t){const n=c(e);for(const r in n){if(n[r].pageId===t)return n[r];if(n[r].dialogContextIds)for(const a of n[r].dialogContextIds){const o=Object(i.a)(e,a);if(o.dialogContextId===t||o.contentPageId===t||o.pageStack&&o.pageStack.indexOf(t)>=0)return n[r]}}return null}},odYE:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("SAYH"),a=n("WRF3");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i{constructor(e,t,n){this.etn=e,this.id=t||r.a.EMPTY,this.name=n,Object.freeze(this)}static toString(e){return`${e.etn}:${r.a.toString(e.id)}`}static equals(e,t){let n=i.equalsIgnoreName(e,t);return e&&t?(e.name&&t.name&&(n=n&&e.name===t.name),n):n}static equalsIgnoreName(e,t){return!e&&!t||!(!e||!t)&&(e.etn===t.etn&&r.a.equals(e.id,t.id))}static toLegacyEntityReference(e){return new a.a(e.etn,r.a.toLegacyGuid(e.id),e.name)}static fromLegacyEntityReference(e){return new i(e.LogicalName,r.a.fromLegacyGuid(e.Id),e.Name)}static fromExternalEntityReference(e){return new i(e.entityType,r.a.fromExternalGuid(e.id))}static legacyToExternalEntityReference(e){return{id:r.a.externalGuid(r.a.fromLegacyGuid(e.Id)),entityType:e.LogicalName}}static toExternalEntityReference(e){return{id:r.a.externalGuid(e.id),entityType:e.etn}}}i.EMPTY=new i("")},olF5:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){if(Object(r.a)(e))throw Error.argumentNull(t)}function i(e,t){if(e<1)throw Error.create(t)}},olXY:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n("eXjw"),a=n("SAYH"),i=n("BzGi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e){return{initialized:r.a.Initialized,oDataInitialized:r.a.Uninitialized,Name:e.Name,PresentationDescription:e.PresentationDescription,DataDescription:e.DataDescription,PrimaryEntityTypeCode:e.PrimaryEntityTypeCode,IsDefault:e.IsDefault,ModifiedOn:e.ModifiedOn,WebResourceId:a.a.tryParseOrNull(e.WebResourceId),VersionNumber:e.VersionNumber,OverallVersionNumber:e.OverallVersionNumber,OverallUserVersionNumber:e.OverallUserVersionNumber}}function s(e){if(!e||0===e.length)return null;const t={};for(const n in e){const r=e[n];t[r.Id]=o(r)}return t}function c(e){if(!e||0===e.length)return null;const t={};let n={},o={};const s={};for(const c of e)if(c.hasOwnProperty("EntityLogicalName")){for(const e of c.SelectorItems){const r={Id:new a.a(e.Id),Name:e.Name,IsDefault:e.IsDefault,IsUserChart:e.IsUserChart,OverallVersionNumber:e.OverallVersionNumber,OverallUserVersionNumber:e.OverallUserVersionNumber};t.hasOwnProperty(c.EntityLogicalName)||(t[c.EntityLogicalName]=new a.a(e.Id)),e.IsUserChart?o[e.Id]=r:n[e.Id]=r}s[c.EntityLogicalName]={initialized:r.a.Initialized,chartTypes:{[i.a[i.a.savedvisualization]]:n,[i.a[i.a.uservisualization]]:o}},o={},n={}}return{chartDefaults:t,chartSelectors:s}}},olZa:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"f",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Button_Label_Close",a="Button_Label_OK",i="Button_Label_Cancel",o="Leave_This_Page",s="Leave_Page_Text",c=[r,a,i,o,s]},omKH:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return o}));var r=n("odYE"),a=n("Nb1E"),i=n("IqkD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="userSettingsMobileApp.set";function s(){return{type:"userSettingsMobileApp.retrieve",execute({dispatch:e,getState:t}){const n=t(),o=Object(i.q)(n);if(!o)return Promise.reject("Cannot fetch personal settings because there is no user id.");const s=new r.a("usersettings",o);return e(Object(a.d)(s,"?$select=paginglimit,defaultcalendarview,workdaystarttime,workdaystoptime,timezonecode")).then(t=>{const n={defaultCalendarView:(r=t).defaultcalendarview,recordsPerPage:r.paginglimit,timeZoneCode:r.timezonecode,workDayStartTime:r.workdaystarttime,workDayStopTime:r.workdaystoptime};var r;return e(l(n)),n})}}}function c(e){return{type:"userSettingsMobileApp.save",execute({dispatch:t,getState:n}){t(l(e));const o=n(),s=Object(i.q)(o);if(!s)return Promise.reject("Cannot save personal settings because there is no user id.");const c=new r.a("usersettings",s),d=function(e){const t={};return Object.keys(e).forEach(n=>{const r=u[n];if(!r)throw new Error("Unrecognized setting "+r);t[r]=e[n]}),t}(e);return Object.keys(d).length?t(Object(a.f)(c,d)).then(e=>{}):Promise.resolve()}}}function l(e){return{type:o,payload:e}}const u={defaultCalendarView:"defaultcalendarview",recordsPerPage:"paginglimit",timeZoneCode:"timezonecode",workDayStartTime:"workdaystarttime",workDayStopTime:"workdaystoptime"}},omgb:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Slate=1]="Slate",e[e.Phone=2]="Phone",e[e.Desktop=3]="Desktop",e[e.MailApp=4]="MailApp"}(r||(r={}))},onzm:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s}));var r=n("sw/s"),a=n("arV0");function i(e,t){const n=Object(a.a)(e,t);return n&&n.uniqueName?Object(r.a)(e,n.uniqueName):null}function o(){return"TaskBasedFlow"}function s(){return"TaskBasedFlow"}},oqdd:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Success=0]="Success",e[e.Redirect=1]="Redirect",e[e.Fail=2]="Fail"}(r||(r={}))},"p/Kg":function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="editedview.update.pagemap",a="editedview.remove.pagemap";function i(e,t,n,a){return{type:r,payload:{gridDescriptor:a,fetchXml:n},meta:{pageToEditedViewMapId:e,viewId:t}}}function o(e,t){return{type:a,payload:{},meta:{pageToEditedViewMapId:e,viewId:t}}}},p0fx:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r=["Header_Fields_Label"]},p4DY:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Flyout=1]="Flyout",e[e.Popup=2]="Popup"}(r||(r={}))},p9KN:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"s",(function(){return a})),n.d(t,"t",(function(){return i})),n.d(t,"h",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"n",(function(){return c})),n.d(t,"o",(function(){return l})),n.d(t,"l",(function(){return u})),n.d(t,"m",(function(){return d})),n.d(t,"v",(function(){return p})),n.d(t,"q",(function(){return g})),n.d(t,"w",(function(){return h})),n.d(t,"x",(function(){return f})),n.d(t,"i",(function(){return m})),n.d(t,"f",(function(){return b})),n.d(t,"a",(function(){return _})),n.d(t,"k",(function(){return y})),n.d(t,"b",(function(){return v})),n.d(t,"p",(function(){return S})),n.d(t,"u",(function(){return O})),n.d(t,"r",(function(){return C})),n.d(t,"y",(function(){return E})),n.d(t,"e",(function(){return I})),n.d(t,"c",(function(){return w})),n.d(t,"j",(function(){return j}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="NavBar_DetailedPage_Area_Info",a="NavBar_DetailedPage_Area_SFA",i="NavBar_DetailedPage_Area_CS_SM",o="NavBar_DetailedPage_Area_MA",s="NavBar_DetailedPage_Area_IMA",c="NavBar_DetailedPage_Area_PROCESS",l="Area_Label_ProductBundles",u="Area_Label_OtherContacts",d="Tab_Label_PlanningTasks",p="Tab_Label_TargetLists",g="Tab_Label_RelatedCampaigns",h="Tab_Label_TargetProducts",f="Tab_Label_WebLeads",m="MA.List.ListMember.Details.MarketingList",b="ImportFailures_View",_="AsyncOperationAreaTitle",y="Tab_Label_History",v="FormEditor_Nav_Workflows_Label",S="FormEditor_Nav_ProcessSessions_Label",O="Tab_Label_Services",C="Tab_Label_ResourceGroups",E="Tab_Label_Working_Hours",I="Tab_Label_FeedBack",w="Tab_Label_Connections",j="Object_Plural_Member"},pCLb:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));function r(e){return{type:"clientapi.recycle.async",execute:(t,n)=>(n.ScriptManager.removeContainer(e),Promise.resolve())}}},pEXn:function(e,t,n){"use strict";n.d(t,"g",(function(){return g})),n.d(t,"z",(function(){return h})),n.d(t,"t",(function(){return f})),n.d(t,"f",(function(){return m})),n.d(t,"c",(function(){return b})),n.d(t,"d",(function(){return v})),n.d(t,"e",(function(){return y})),n.d(t,"b",(function(){return I})),n.d(t,"u",(function(){return _})),n.d(t,"x",(function(){return j})),n.d(t,"A",(function(){return S})),n.d(t,"s",(function(){return O})),n.d(t,"B",(function(){return C})),n.d(t,"y",(function(){return E})),n.d(t,"a",(function(){return w})),n.d(t,"E",(function(){return D})),n.d(t,"D",(function(){return A})),n.d(t,"C",(function(){return x})),n.d(t,"w",(function(){return M})),n.d(t,"v",(function(){return r})),n.d(t,"k",(function(){return a})),n.d(t,"p",(function(){return i})),n.d(t,"l",(function(){return o})),n.d(t,"m",(function(){return s})),n.d(t,"o",(function(){return c})),n.d(t,"i",(function(){return l})),n.d(t,"r",(function(){return u})),n.d(t,"q",(function(){return d})),n.d(t,"j",(function(){return p})),n.d(t,"n",(function(){return F})),n.d(t,"h",(function(){return k}));const r="operation",a="Forms.FormChecker.",i="RelatedMenu",o="FormControls",s="FormEvents",c="XrmNavigation",l="UnsupportedClientApi",u="TabStateChange",d="SectionStateChange",p="ControlStateChange",g={ActivityId:"ActivityId",SessionId:"SessionId",ComponentName:"ComponentName",TimeCreated:"TimeCreated",SessionContext:"SessionContext",EventContext:"EventContext",UserAgent:"UserAgent",Origin:"Origin"},h={SessionId:"SessionId",ServerVersion:"ServerVersion",HostVersion:"AppVersion",ClientVersion:"ClientVersion",OrganizationId:"OrgId",UserId:"UserId",AadObjectId:"AadObjectId",AadTenantId:"AadTenantId",HostType:"HostType",HostSubType:"HostSubType",NavigationType:"NavigationType",AppModule:"AppModule",AppModuleClientType:"AppModuleClientType",StateRestoreEnabled:"StateRestoreEnabled"},f={ServerConnectivityState:"ServerConnectivityState",NetworkConnectivityState:"NetworkConnectivityState",OfflineFeatureAvailableForUse:"OfflineFeatureAvailableForUse",HasUserForcedOffline:"HasUserForcedOffline",IsOfflineByDefaultApp:"IsOfflineByDefaultApp"},m={Name:"uci_context",Common:g,WindowResolution:"WindowResolution",ScreenResolution:"ScreenResolution",BrowserLanguage:"BrowserLanguage",InstallId:"InstallId",DeviceModel:"DeviceModel",OSTypeVersion:"OSTypeVersion",OrganizationParameters:{Language:"OrgLanguage",OrgName:"OrgName"},UserParameters:{Language:"UserLanguage"}},b={AllowLegacyClientExperience:"AllowLegacyClientExperience",Error:"Error"},_={Name:"uci_init",StartTime:"StartTime",Common:g},y={Message:"Message",CallStack:"CallStack"},v={Common:g,ActionContext:"ActionContext"},S={Name:"uci_monitor_success",CommonAction:v},O={Name:"uci_monitor_failure",CommonAction:v,CommonError:y,SuggestedMitigation:"SuggestedMitigation"},C={Name:"uci_trace",CommonAction:v,CommonError:y,TraceLevel:"TraceLevel"},E={Name:"uci_script_error",CommonAction:v,CommonError:y,FunctionName:"FunctionName",FileName:"FileName",LineNumber:"LineNumber",ColumnNumber:"ColumnNumber"},I={PageLoadParameters:{LoadQuality:"LoadQuality",FirstInteractionName:"FirstInteractionName",FirstInteractionTime:"FirstInteractionTime",Interactions:"Interactions",NavigationOrigin:"NavigationOrigin",TimeSinceIdle:"TimeSinceIdle",NetworkRequestInfo:"NetworkRequestInfo",NetworkRequests:"NetworkRequests",FirstAppStart:"FirstAppStart",ZoneActivity:"ZoneActivity",ColdLatency:"coldLatency",WarmLatency:"warmLatency",WarmThroughput:"warmThroughput",Automation:"Automation",IdleTasks:"IdleTasks",Attribution:"Attribution",CustomScriptTime:"CustomScriptTime",SyncRequestTime:"SyncRequestTime",NumberOfRibbons:"NumberOfRibbons",NumberOfControls:"NumberOfControls"},CommandingParameters:{CommandManagerId:"CommandManagerId",EntityName:"EntityName",ContextKey:"ContextKey",RibbonId:"RibbonId",CommandType:"CommandType",CommandId:"CommandId",ControlId:"ControlId",PageId:"PageId",ExecuteWarningEntityName:"ExecuteWarningEntityName",SelectedItemsCount:"SelectedItemsCount",UrlActionCount:"UrlActionCount",JavascriptActionCount:"JavascriptActionCount",LibraryCount:"LibraryCount"},LookupDialogParameters:{DefaultEntityType:"DefaultEntityType",DefaultViewId:"DefaultViewId",EntityTypes:"EntityTypes",ViewIds:"ViewIds",AllowMultiSelect:"AllowMultiSelect",SearchText:"SearchText"},OfflineStatusPageParameters:{CodeCacheState:"OfflineStatusPage.CodeCacheState",OfflineStatus:"OfflineStatusPage.Status",OfflineStatusReason:"OfflineStatusPage.StatusReason",OfflineEnabledEntities:"OfflineStatusPage.EnabledEntities",OfflineDisabledEntities:"OfflineStatusPage.DisabledEntities",OfflineMetadataDownloadRequired:"OfflineStatusPage.MetadataDownloadRequired"},SaveFormParameters:{CorrelationId:"CorrelationId",SaveMode:"SaveMode"},DialogButtonClickParameters:{ControlId:"ControlId",DialogUniqueName:"DialogUniqueName"},DialogXClickParameters:{DialogUniqueName:"DialogUniqueName",SourceType:"SourceType"},QuickFormCardControlUpdateViewParameters:{HasParametersValue:"HasParametersValue",PageType:"PageType",PageEntityType:"PageEntityType",EntityType:"EntityType",ControlId:"ControlId",TraceLocation:"TraceLocation"},BpfStageButtonClickParameters:{StageButtonName:"StageButtonName",StageId:"StageId"},BpfProcessControlRenderParameters:{ProcessId:"ProcessId",BusinessProcessFlowInstanceId:"BusinessProcessFlowInstanceId",PageId:"PageId",EntityTypeCode:"EntityTypeCode",EntityId:"EntityId",CorrelationId:"CorrelationId"},BpfActionStepButtonClickParameters:{ActionStepIdKey:"ActionStepIdKey"},SearchParameters:{SearchSessionId:"SearchSessionId",SearchWithoutFilters:"SearchWithoutFilters",SearchFilter:"SearchFilter",IsBarcodeScan:"IsBarcodeScan",UsingSuggestion:"UsingSuggestion"},CommonErrorParameters:{ErrorStack:"ErrorStack"},TaskBasedFlowParameters:{PrimaryModelName:"PrimaryModelName",RecordId:"RecordId"},PageInfraReadyParameters:{RenderedControls:"RenderedControls"},ShimBootParameters:{ShimBootType:"ShimBootType"},DashboardCommandsParameters:{Error:"Error",Failure:"Failure",IsPowerBIDashboard:"isPowerBIDashboard",PowerBIDashboardId:"PowerBIDashboardId",PowerBIGroupId:"PowerBIGroupId",CrmDashboardId:"CrmDashboardId"},BootPerformanceParameters:{BundleName:"bundleName",IsStateRestore:"IsStateRestore"},AdvancedFindLookupResolverParameters:{Name:"RetrieveRecordsForAdvancedFindLookup",PrimaryEntity:"PrimaryEntityName",Targets:"LookupTargets",SearchString:"SearchString",EntityMetadataUnavailable:"MissingEntityMetadata",RetrieveRequestSuccess:"RetrieveAFLookupDataSuccess",RetrieveRequestFail:"RetrieveAFLookupDataFail"},ModelFormComponent:{IsPreInitialized:"IsPreInitialized"},WebResourceParameterNames:{FunctionName:"FunctionName",WebResourceName:"WebResourceName",SolutionName:"SolutionName",PublisherName:"PublisherName"},FormTabSwitch:{TabName:"TabName"},EntityKind:"EntityKind",EntityName:"EntityName",AttributeName:"AttributeName",Id:"Id",ActionType:"ActionType",ActionList:"ActionList",WebResourceName:"WebResourceName",CustomControlId:"CustomControlId",PowerBIComponentTypeCode:"PowerBIComponentTypeCode",ViewId:"ViewId",VisualizationId:"VisualizationId",DesignerType:"DesignerType",ModalDialogType:"ModalDialogType",UniqueName:"UniqueName",SolutionId:"SolutionId",ComponentId:"ComponentId",DashboardId:"DashboardId",RetrievedDashboardId:"RetrievedDashboardId",DashboardNavPath:"DashboardNavPath",DashboardType:"DashboardType",DashboardTypeFlags:"DashboardTypeFlags",BoundDashboardEntity:"BoundDashboardEntity",ShowDefaultDashboard:"ShowDefaultDashboard",WelcomePageName:"WelcomePageName",MetadataTye:"MetadataType",MetadataSubType:"MetadataSubType",MetadataId:"MetadataId",MetadataNames:"MetadataNames",ApplicationEventLevel:"ApplicationEventLevel",ServerAvailabilityStatus:"ServerAvailabilityStatus",BenchmarkControlName:"BenchmarkControlName",BenchmarkElementNumber:"BenchmarkElementNumber",LegacyDialogUrl:"LegacyDialogUrl",LegacyDialogOptions:"LegacyDialogOptions",LocalDataSourceAvailabilityStatus:"LocalDataSourceAvailabilityStatus",IsMocaOfflineFeatureEnabled:"IsMocaOfflineFeatureEnabled",MobileOfflineFeatureStatus:"MobileOfflineFeatureStatus",OfflineStatus:"OfflineStatus",IsEmptyPayload:"IsEmptyPayload",UpdateInProgress:"UpdateInProgress",IsAppModuleToLastModifiedTimeMapEmpty:"IsAppModuleToLastModifiedTimeMapEmpty",HaveTimestampsChanged:"HaveTimestampsChanged",ClientRequestId:"ClientRequestId",CurrentMetadataVersion:"CurrentMetadataVersion",ChangedMetadataVersion:"ChangedMetadataVersion",WorkBlockKpi:"WorkBlockKpi",MultipleWorkBlockKpi:"MultipleWorkBlockKpi",IsGridRoot:"IsGridRoot",IsAssociatedGrid:"IsAssociatedGrid",IsSubGrid:"IsSubGrid",IsEmptyFetch:"IsEmptyFetch",IsEmptyOfflineSqlQuery:"IsEmptyOfflineSqlQuery",IsEntityAvailableForOfflineUsage:"IsEntityAvailableForOfflineUsage",IsValidFetchXmlForOfflineUsage:"IsValidFetchXmlForOfflineUsage",OfflineConfigurationErrorCode:"OfflineConfigurationErrorCode",RelatedEntityUnavailableOffline:"RelatedEntityUnavailableOffline",ViewName:"ViewName",IsEmptyInstallationId:"IsEmptyInstallationId",IsEmptySubscriptionId:"IsEmptySubscriptionId",ErrorMessage:"ErrorMessage",RequestStatus:"RequestStatus",SubscriptionErrorMessage:"SubscriptionErrorMessage",ReconnectErrorMessage:"ReconnectErrorMessage",ComponentType:"ComponentType",IsApplicationMetadataDownloadInShimEnabled:"IsApplicationMetadataDownloadInShimEnabled",AutomaticReconnect:"AutomaticReconnect",QueryNavPath:"QueryNavPath",IsFirstDownloadPromptAlreadyTriggered:"IsFirstDownloadPromptAlreadyTriggered",FormId:"FormId",IsCodeCacheReady:"IsCodeCacheReady",OfflineStatusReason:"OfflineStatusReason",IsForcedSync:"IsForcedSync"},w={CorrelationId:"CorrelationId",ContextId:"ContextId",ActionType:"ActionType",ActionStack:"ActionStack",EntryStack:"EntryStack",SourceContextId:"SourceContextId",ParentContextId:"ParentContextId"},j={Name:"uci_monitor_performance",CommonAction:v,MetricName:"MetricName",StartTime:"StartTime",MetricValue:"MetricValue",PageName:"PageName",LoadType:"LoadType",IsBoot:"IsBoot",CleanLoad:"CleanLoad",[I.EntityName]:I.EntityName,ServerActivityId:"ServerActivityId"},P=[m,_,j,S,O,C,E];let T;function N(e){let t=[];for(const n in e)"Name"!==n&&("string"==typeof e[n]||e[n]instanceof String?t.push(e[n]):t=t.concat(N(e[n])));return t}function A(e){return!T[e]}function D(e,t){if(T[e]){const n=T[e];for(let e=0;e<n.length;e++)if(t===n[e])return!0}return!1}!function(){if(!T){T={};for(let e=0;e<P.length;e++)T[P[e].Name]=N(P[e])}}();const R=N(w);function x(e){for(const t in R)if(e===R[t])return!0;return!1}const M="uci_powerbi_events",F="FormChecker",k=[m.Name,_.Name,S.Name,j.Name,O.Name,C.Name,E.Name,"uci_bounddashboard_load","uci_dashboard_load","uci_dashboard_time","uci_daterangefilter","uci_globalfilter_apply",M,`${a}${i}`,`${a}${o}`,`${a}${s}`,`${a}${c}`,`${a}${l}`,`${a}${u}`,`${a}${d}`,`${a}${p}`,"uci_chart_usage_monitor","uci_controlframework_usage","uciknowledgearticleribbonactions","ucikbsearchcontrol","kbsearchcontrolusage","kbsearchcontrolperformance","kbsearchcontrolerror","mdfsearchevent","servicewebresources","service_opendialogaction","documenttemplates","doctemplatedownloadcontrolinit","exporttoexcelonline","excelonlinecontrolinit","excelonlinefilecreated","excelcontrolinit","exporttoexcelfailure","excelonlinecontrolfailure","salesproeventinfo","salesprofailureeventinfo","sitraceevent","sitracecievent","sitracebievent","createfeedbackrecord","updatefeedbackrecord","leadscore360cardcontrolloadevent","salesintelligencetelemetry","leadscorefeedbackevent","leadscorefailureevent","leadscoreperfmarkers","leadscorereasonparsefailureevent","leadscoremodeloperationevent","leadscoreinfocontrolloadevent","leadscoreloadercontrolloadevent","closedleadrecordsevent","leadscoreconfigcontrolloadevent","actiononemailengagementactions","emailengagementactionentrypoint","notesanalysispopupactioninvoked","notesanalysispopuperror","notesanalysispopupinit","notesanalysispopupcloseclick","notesanalysispopupclick","notesanalysispopupkeydown","notesanalysiscontrolinsightretrievesuccess","notesanalysiscontrolinsightretrievefailure","talkingpointscount","talkingpointsviewswitched","talkingpointsmarkedasfavourite","talkingpointsexpanded","talkingpointscategoryiconclicked","relationshipassistantentrypoint","actiononrelationshipassistantcard","assistantstudioerror","assistantstudioinformation","assistantstudioparenterror","uci_commanding_command_execution","actiononrelationshipassistantcard","relationshipassistantentrypoint","actioncardfeedback","actioncarddisplay","relationshipcardactiontaken","unifiedconfigucitelemetry","salesinsightsadminconfiguration","processdesignersaved","processdesigneractivated","processdesignerdeactivated","processdesignerlaunched","kmratingevent","autocaptureeventinfo","autocapturefailureeventinfo","ucikbarticlecontrol","skypechannelinitialpresencereceivedevent","skypechannelcontactcardloadevent","skypechannelmakecallevent","skypechannelsendimevent"]},pF61:function(e,t,n){"use strict";n.d(t,"j",(function(){return y})),n.d(t,"h",(function(){return v})),n.d(t,"c",(function(){return S})),n.d(t,"b",(function(){return E})),n.d(t,"i",(function(){return O})),n.d(t,"a",(function(){return N})),n.d(t,"l",(function(){return A})),n.d(t,"e",(function(){return D})),n.d(t,"k",(function(){return T})),n.d(t,"n",(function(){return C})),n.d(t,"f",(function(){return j})),n.d(t,"m",(function(){return P})),n.d(t,"d",(function(){return w})),n.d(t,"g",(function(){return R})),n.d(t,"o",(function(){return x}));var r=n("oT5e"),a=n("xHmU"),i=n("D+Bz"),o=n("/2Q6"),s=n("FJiw"),c=n("IfHN"),l=n("q27N"),u=n("BMZr"),d=n("0kGT"),p=n("TQVK"),g=n("Lyxw"),h=n("3/02"),f=n("arV0"),m=n("504W"),b=n("H4dV"),_=n("r0R4");function y(e){return e.router.navigationsCount||0}function v(e){return!!Object(r.d)(e).error}function S(e,t){return t?Object(r.a)(e,t).pageId:Object(r.d)(e).pageId}function O(e,t){return t?Object(r.a)(e,t).error||void 0:Object(r.d)(e).error||void 0}function C(e,t){if(Object(d.b)(e)){const n=Object(r.d)(e).history;if(n&&n.some(e=>e.state&&e.state.pageId===t))return!1}const n=Object(r.b)(e,t);return null==n}function E(e,t){const n=Object(a.a)(e,t);return n.length>0?n[n.length-1]:null}function I(e,t){if(!t||!t.mapping)return!1;if(t.mapping.pageType===o.a.pageType||t.mapping.pageType===l.a.pageType||t.mapping.pageType===_.a.pageType)return!0;if(t.mapping.pageType===c.a.pageType){const n=t.input;return Object(u.a)(e)&&t.input&&n.entityTypeName&&(null===n.formType||void 0===n.formType||2===n.formType)}return t.mapping.pageType===p.a.pageType&&Object(g.a)(e,h.Vc,h.h)}function w(e,t,n,r){var o;let c,l=!1;return t.isDialog||t.mapping&&t.mapping.type===i.a.Dialog?(c=t.mapping.getDialogOptions(t.input),l=!0):n&&"dialog"===n.target&&t.mapping&&I(e,t)?(t.mapping.getDialogOptions&&(c=t.mapping.getDialogOptions(t.input)),c=c||s.a,c.useDefaultDialogChrome=!0,l=!0,(null===(o=t.input)||void 0===o?void 0:o.dialogOptions)&&(c.inExpandMode=t.input.dialogOptions.inExpandMode)):!Object(m.b)(r)&&-1!==Object(a.a)(e).indexOf(r)&&n.replaceState&&t.mapping&&I(e,t)&&(l=!0,t.mapping.getDialogOptions?c=t.mapping.getDialogOptions(t.input):Object(f.c)(e,r)&&(c=Object(f.c)(e,r)),c=c||s.a),{isDialogNavigation:l,dialogOptions:c}}function j(e){return E(e)||S(e)}function P(e,t){return j(e)===t}function T(e,t){if(e&&t&&e.pages){const n=e.pages[t];if(n)return n.input&&n.input.pageType}return null}function N(e){return e.router.baseUrl}function A(e){return e.router.preRendering}function D(e,t){return Object(r.a)(e,t).disableNavigateBack}function R(e){return e.router.navigating}function x(e){return Object(g.c)(e,h.ee)&&!b.a.getInstance().get_IsBrowserChrome()&&!b.a.getInstance().get_IsBrowserEdge()}},pHbk:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("ufH1"),a=n("504W"),i=n("Div0"),o=n("03Hu"),s=n("EW4s"),c=n("8Mff"),l=n("eZ32");class u{constructor(e){this._localDataSource=null,this._localDataSource=e}createOfflineSyncErrorLog(e,t){const n=new s.a;return this._localDataSource.get_offlineDataStore().create(e,!0,t).then(e=>{Object(r.e)("MOCADataSyncFailureErrors",i.a.storage,"CreateOfflineSyncErrorLog Success"),n.resolve(e)},e=>{Object(r.e)("MOCADataSyncFailureErrors",i.a.storage,"CreateOfflineSyncErrorLog Error: "+e.get_Message()),n.reject(e)}),n}saveOfflineErrorState(e,t){const n=new s.a;return this._localDataSource.saveSessionState(e,t,!0).then(e=>{n.resolve(e)},e=>{n.reject(e)}),n}retrieveSessionState(e){return this._localDataSource.retrieveSessionState(e)}isOfflineDatabaseAvailable(){return!Object(a.a)(this._localDataSource)&&!Object(a.a)(this._localDataSource.get_offlineDataStore())&&o.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineFeatureStatus()===c.a.Enabled&&o.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineStatus()===l.a.Available}}var d=n("jZCH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class p{constructor(e){this.offlineSyncErrorLogProvider=null,this.offlineSyncErrorLogProvider=new u(e)}createSyncErrorLog(e,t){return p._instance.offlineSyncErrorLogProvider.createOfflineSyncErrorLog(e,t)}saveOfflineErrorState(e,t){p._instance.offlineSyncErrorLogProvider.saveOfflineErrorState(e,t)}retrieveOfflineErrorState(e){return p._instance.offlineSyncErrorLogProvider.retrieveSessionState(e)}isOfflineDatabaseAvailable(){return this.offlineSyncErrorLogProvider.isOfflineDatabaseAvailable()}static get_instance(){return Object(a.a)(p._instance)&&(p._instance=new p(d.a.get_DefaultInstance().get_LocalDataSource())),p._instance}}p._instance=null},pNM1:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Off=0]="Off",e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Perf=3]="Perf",e[e.Info=4]="Info",e[e.Verbose=5]="Verbose"}(r||(r={}))},pah4:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r,a=n("Ydwo"),i=n("8o18"),o=n("ufH1"),s=n("504W"),c=n("Div0"),l=n("WWG3"),u=n("8tWD"),d=n("eruq"),p=n("jZCH");!function(e){e[e.string=0]="string",e[e.integer=1]="integer",e[e.currency=2]="currency",e[e.dateTime=3]="dateTime",e[e.float=4]="float"}(r||(r={}));var g=n("LbMF"),h=n("Lyxw"),f=n("3/02"),m=n("s/8p"),b=n("x8sc"),_=n("IqkD");class y extends i.a{constructor(e,t,n,r,a){if(super(e,r),this._searchText=t,this._searchEntities=n,this._getState=a,this._getState&&Object(h.c)(this._getState(),f.bb)){const e=Object(_.h)(this._getState());this.set_PageSize(e||y._defaultPageSize)}else this.set_PageSize(y._defaultPageSize);this._UpdateDescriptorSetWithQuickFindSql(),this._UpdateRawFetchXmlWithQuickFindFetchXml()}get_searchText(){return this._searchText}static getInternalQuickFindQuery(e){const t=Object(b.a)(m.g,["/","*"])+"([\\S\\s]*)"+Object(b.a)(m.f,["/","*"]),n=new RegExp(t,"i"),r=e.match(n);return r&&r.length>0?r[1]:(Object(o.b)("Could not locate the QuickFind tokens in SQL query",c.a.quickFind,null),null)}static getInternalQuickFindQueryBwCompat(e){const t=new RegExp("WITH __QuickFind__ AS \\(SELECT \\[[\\S\\s]*\\] from \\(([\\s\\S]*)\\) AS \\[__QuickFindInternal__\\]\\)","i"),n=e.match(t);return n&&n.length>0?n[1]:null}static formatSql(e,t,n){if(0===t.length)return Object(o.b)("Could not locate the QuickFInd tokens in SQL query",c.a.quickFind,null),null;y._RemoveEmptyValues(t),y._RemoveEmptyValues(n);const r=t[t.length-1].split("where");if(0===r.length)return Object(o.b)("The QuickFind query does not contain 'WHERE' clause",c.a.quickFind,null),null;const a=r[0]+(n.length>0?" where "+n.join(" OR "):"");return e.replace(t[t.length-1],a)}static formatSqlBwCompat(e,t,n){this._RemoveEmptyValues(t),this._RemoveEmptyValues(n);const r=t[t.length-1].split("where")[0];t[t.length-1]=r+(n.length>0?" where "+n.join(" OR "):"");const a=e.split(") as [__QuickFindInternal__]");return a[0].match(new RegExp("(WITH __QuickFind__ as \\(select \\[[\\S\\s]*\\] from \\()"))[0]+t.join("UNION")+") as [__QuickFindInternal__]"+a[1]}static findQuickFindFilter(e){const t=new RegExp("SELECT [\\S\\s]* FROM [\\S\\s]* WHERE [\\S\\s]* IN \\(SELECT [\\S\\s]* FROM [\\S\\s]* WHERE ([\\S\\s]*)\\)","i"),n=new RegExp("SELECT [\\S\\s]* FROM [\\S\\s]* WHERE ([\\S\\s]*)","i"),r=[],a=[],i={};let o=e[e.length-1].match(n);o&&a.push(...o[1].split("OR"));for(let a=0;a<e.length-1;a++)o=e[a].match(t),o||(o=e[a].match(n))?r.push(o[1]):r.push("");return i.lookup=r,i.other=a,i}static _RemoveEmptyValues(e){for(let t=0;t<e.length;t++)Object(s.b)(e[t])&&(e.splice(t,1),t--)}static modifyFilterBasedOnPlaceholder(e,t,n,r,a,i,o){if(i){const i=a?a.replace("}","\\}").replace("{","\\{"):a,s=new RegExp(i,"g"),c=t[r].replace(s,o);e&&(n[r]=n[r].replace(t[r],c)),t[r]=c}else t[r]="",e&&(n[r]="")}_PopulateQuickFindSql(e,t){let n=!0,r=y.getInternalQuickFindQuery(e);if(!r&&(r=y.getInternalQuickFindQueryBwCompat(e),n=!1,!r))return Object(o.b)("QuickFindQuery._ModifyFilterBasedOnPlaceholder",c.a.quickFind,"No internal QuickFind query found:\n"+e),null;const a=this._searchEntities[0],i=p.a.get_DefaultInstance().get_MetadataCache().getEntityMetadata(a),s=r.split("UNION"),l=y.findQuickFindFilter(s),u=l.lookup,d=l.other;if(!l.lookup.length&&!l.other.length){if(!i.get_primaryNameAttribute())return Object(o.b)("QuickFindQuery._ModifyFilterBasedOnPlaceholder",c.a.quickFind,"Could not extract search conditions from the QuickFind query:\n"+e),null;r=String.format("SELECT {0} FROM {1} WHERE {0} LIKE ",i.get_primaryNameAttribute(),a)+"{0}"}return"*"===t?(s.splice(0,u.length),u.length=0,d.length=0,n?y.formatSql(e,s,d):y.formatSqlBwCompat(e,s,d)):(this._UpdateConditionsAndSearchFields(t,s,u,d),n?y.formatSql(e,s,d):y.formatSqlBwCompat(e,s,d))}_UpdateConditionsAndSearchFields(e,t,n,a){const i=y.trimWildCards(e);e=y.convertUserFindToLike(e),e=y._handleEscapeCharacters(e);const o={};o[r[0]]=String.format("'{0}'",e);const s=l.a.get_instance().parseIntegerValue(i);!isNaN(s)&&isFinite(s)&&s.toString()===i&&(o[r[r.integer]]=s.toString());const c=l.a.get_instance().parseDecimalValue(i);!isNaN(c)&&isFinite(c)&&(o[r[r.float]]=o[r[r.currency]]=c.toString());const u=Date.parseInvariant(i);u&&(o[r[r.dateTime]]=String.format("'{0}'",u.toString())),this._UpdateFilters(t,!0,n,o),this._UpdateFilters(t,!1,a,o)}_UpdateFilters(e,t,n,r){for(let a=0;a<n.length;a++){const i=n[a].match(new RegExp("({\\d})"));if(!i)continue;const o=this._FindPlaceHolderMatch(i[1]);y.modifyFilterBasedOnPlaceholder(t,n,e,a,i[1],o in r,o in r?r[o].toString():null)}}_FindPlaceHolderMatch(e){let t="";switch(e){case"{4}":t=r[r.float];break;case"{3}":t=r[r.dateTime];break;case"{2}":t=r[r.currency];break;case"{1}":t=r[r.integer];break;case"{0}":t=r[0]}return t}static trimWildCards(e){let t=e;if(!t)return t;"*"===t[0]&&(t=t.substring(1));return"*"===t[t.length-1]&&(t=t.substring(0,t.length-1)),t}_UpdateDescriptorSetWithQuickFindSql(){let e=null;const t=this.get_DescriptorSet().tryGetDescriptor(u.a.Sql);Object(s.b)(t)||(e=this._PopulateQuickFindSql(t,this.get_searchText()),e||Object(o.b)("The QuickFind SQL for this entity is malformed",c.a.quickFind,t)),this.get_DescriptorSet().updateDescriptorSet(u.a.Sql,e),this._updatedQuickFindSQL=e}_UpdateRawFetchXmlWithQuickFindFetchXml(){if(!Object(s.a)(this.rawFetchXmlDoc)){let e;const t=this._searchEntities[0];y._ProcessQuickFindSearchCriteria(this.get_searchText(),Object(a.a)(()=>e,t=>e=t),this.rawFetchXmlDoc,t,this._getState)}}getUpdatedSql(){return this._updatedQuickFindSQL}getUpdatedFetchXml(){return this.get_FetchXml()}static convertUserFindToLike(e){const t=new Sys.StringBuilder;for(let n=0;n<e.length;n++)switch(e.charAt(n)){case"[":t.append("[[]");break;case"_":t.append("[_]");break;case"%":t.append("[%]");break;case"*":t.append("%");break;default:t.append(e.charAt(n))}return e.length&&e.endsWith("*")||t.append("%"),t.toString()}static _handleEscapeCharacters(e){return e.replace("'","''")}static _GetXmlAttributeValue(e,t){return e&&e.attributes.getNamedItem(t)?e.attributes.getNamedItem(t).nodeValue:null}static _FindQuickFindFilter(e){const t=e.getElementsByTagName("filter");if(!Object(s.a)(t))for(let e=0;e<t.length;e++)if(!Object(s.a)(y._GetXmlAttributeValue(t[e],"isquickfindfields")))return t[e];return null}static _ProcessQuickFindSearchStar(e){const t=e.childNodes;for(let e=0;e<t.length;e++){const n=t[e];"condition"===n.nodeName&&((n.hasChildNodes()||!Object(s.a)(n.attributes.getNamedItem("value"))&&n.attributes.getNamedItem("value").nodeValue.match(y._regex).length>0)&&(n.parentNode.removeChild(n),e--))}e.childNodes.length||e.parentNode.removeChild(e)}static _ProcessQuickFindSearchCriteria(e,t,n,r,a){t.val=!1;let i=y._FindQuickFindFilter(n);const o=p.a.get_DefaultInstance().get_MetadataCache().getEntityMetadata(r);if(!e||"*"===e||"%"===e)return t.val=!0,void(i&&y._ProcessQuickFindSearchStar(i));if(!i){if(!o.get_primaryNameAttribute())return void(t.val=!1);const e=o.get_logicalName(),r=o.get_primaryNameAttribute(),a=new Sys.StringBuilder;a.append('<fetch version="1.0" output-format="xml-platform" mapping="logical" page="1" count="50">'),a.append('<entity name="'),a.append(e),a.append('">'),a.append('<attribute name="'+r+'"/>'),a.append('<filter type="or" isquickfindfields="1">'),a.append('<condition attribute="'),a.append(r),a.append('"'),a.append(' operator="like" value="{0}" />'),a.append("</filter>"),a.append("</entity>"),a.append("</fetch>"),n=Object(d.b)(a.toString()),i=y._FindQuickFindFilter(n)}const s=y.trimWildCards(e);e=y.convertUserFindToLike(e);let c="",u="",g=!1,h=!1,f=!1;const m=l.a.get_instance().parseDecimalValue(s);if(!isNaN(m)&&isFinite(m)){u=c=m.toString(),f=h=g=!0;const e=l.a.get_instance().parseIntegerValue(s);!isNaN(e)&&isFinite(e)&&e>=this._intMin&&e<=this._intMax&&e.toString()===s||(h=!1,u="")}let b="",_=!1;const v=Date.parseLocale(s);v&&(b=y._IsDisruptiveFeatureEnabled("GridColumnFilterParityPhase1")?v.getFullYear()+"-"+(v.getMonth()<9?"0":"")+(v.getMonth()+1)+"-"+(v.getDate()<10?"0":"")+v.getDate():v.toDateString(),_=!0),y._UpdateConditionsAndSearchFields(e,i,c,u,g,h,f,b,_,o,n,a),i.hasChildNodes()?t.val=!0:t.val=!1}static _IsDisruptiveFeatureEnabled(e){const t=p.a.get_DefaultInstance().get_UserContext();if(Object(s.a)(t)||Object(s.a)(t.get_FCBContext())||!("October2019Update"in t.get_FCBContext())||!(e in t.get_FCBContext()))return!1;const n=t.get_FCBContext().October2019Update,r=t.get_FCBContext()[e];return n.get_value()&&r.get_value()}static _UpdateConditionsAndSearchFields(e,t,n,r,a,i,o,s,c,l,u,d){const p=t.childNodes;for(let m=0;m<p.length;m++){const b=p[m];if("condition"===b.nodeName)if(b.hasChildNodes()){if(e&&""!==e){const n=d();if(Object(h.a)(n,f.Ec,f.h)){const r=e.substring(0,e.length-1),a=b.attributes&&b.attributes.getNamedItem("attribute"),i=a&&a.value;if("multiselectpicklist"===Object(g.b)(i,l.get_logicalName(),n)){const e=Object(g.a)(n,l.get_logicalName(),i),a=e&&e.OptionSet,o=a&&a.filter(e=>e.Label&&e.Label.match(new RegExp(r,"i"))).map(e=>e.Value);o&&o.length>0?o.forEach((e,t)=>{if(0===t)b.firstElementChild.textContent=e&&e.toString();else{const t=u.createElement("value");t.textContent=e&&e.toString(),b.appendChild(t)}}):(t.removeChild(b),m--)}}else t.removeChild(b),m--}}else switch(b.attributes.getNamedItem("value").nodeValue){case"{4}":a?b.attributes.getNamedItem("value").nodeValue=n:(t.removeChild(b),m--);break;case"{3}":c?b.attributes.getNamedItem("value").nodeValue=s:(t.removeChild(b),m--);break;case"{2}":o?b.attributes.getNamedItem("value").nodeValue=n:(t.removeChild(b),m--);break;case"{1}":i?b.attributes.getNamedItem("value").nodeValue=r:(t.removeChild(b),m--);break;case"{0}":b.attributes.getNamedItem("value").nodeValue=e}}}}y._digitRegex="{\\d}",y._ParseStringGlobally="g",y._intMin=-2147483648,y._intMax=2147483647,y._regex=new RegExp(y._digitRegex,y._ParseStringGlobally),y._defaultPageSize=25},pfY7:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserTimelineTransport=void 0;var r=function(){function e(){this._nextMarkId=0}return e.prototype.writeMarker=function(e){if(performance.mark&&"function"==typeof performance.mark){var t=this._formatEvent(e),n=this._nextMarkId.toString();this._nextMarkId++,performance.mark(n),performance.measure(t,n,n),performance.clearMarks(n),performance.clearMeasures(t)}},e.prototype.writeRetroactiveTimespan=function(){},e.prototype.startTimespan=function(e){if(performance.mark&&"function"==typeof performance.mark){var t=this._formatEvent(e),n=this._nextMarkId.toString();return this._nextMarkId++,performance.mark(n),this._endTimespan.bind(this,t,n)}return function(){}},e.prototype._endTimespan=function(e,t){performance.measure(e,t),performance.clearMarks(t),performance.clearMeasures(e)},e.prototype._formatEvent=function(e){return e.getZone()+" "+e.getName()},e}();t.BrowserTimelineTransport=r},pgSX:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("yHXp"),a=n("ruPX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t,n,i,o,s,c,l,u,d,p,g){const h={modalDialogType:e,text:t,dialogOptions:n,title:o,subtitle:s,confirmButtonLabel:i,cancelButtonLabel:c,showDetailsLabel:l,errorDetails:u,hideDownloadLogLink:d,dynamicHelpOptions:g};return Object(a.a)(r.a,h,p)}},pnQK:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("SAYH"),a=n("OtHk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t,n){if(n&&t){const r=Object(a.g)(e,n),i=r&&r[t.guid];if(i)return i}else if(n)return Object(a.f)(e,n);if(t){const n=Object(a.c)(e);return n&&n[t.guid]}}function o(e){switch(e&&+e.Type){case 1031:case 1034:return!0}return!1}function s(e,t){const n=t?Object(a.g)(e,t):Object(a.c)(e),i=n&&Object.keys(n).filter(e=>!Object(a.i)(new r.a(e))).sort((e,t)=>{const r=n[e],a=n[t],i=r.DisplayName.toUpperCase(),s=a.DisplayName.toUpperCase(),c=o(r),l=o(a),u=c===l;return!c&&l||u&&i<s?-1:c&&!l||u&&i>s?1:0});return r.a.tryParseOrNull(i&&i[0])}},pulT:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n("FoFY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return e.appShellState.focusedSessionId}function i(e){return Object(r.a)(e,a(e))}function o(e){return e.appShellState.defaultSessionId}},"q/4y":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return u}));var r=n("SAYH");function a(e){return!!e.attributeName}function i(e){return!!e.value}function o(e){return!!e.entityName}var s,c=n("YIt1"),l=n("I1N9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class u{constructor(e,...t){this._operator=null,this._terms=null,this._hint=null,this._operator=e,this._terms=t}get operator(){return this._operator}set operator(e){this._operator=e}get hint(){return this._hint}set hint(e){this._hint=e}get terms(){return this._terms}set terms(e){this._terms=e}static _toLegacyConditionParameters(e){let t=null,n=null,r=null;for(const s of e.terms)a(s)?t=s.attributeName:i(s)?n=s.value:o(s)&&(r=s.entityName);return{attributeName:t,operator:e.operator,value:n,entityName:r}}static toLegacyFilterExpression(e,t){const n="or"===e.operator?c.a.Or:c.a.And,a=r.a.newGuid().guid,i=new l.a(n,a,null,t?null:e.hint);if(d(e)){const{attributeName:t,operator:n,value:r,entityName:a}=u._toLegacyConditionParameters(e);i.addCondition(t,n,r,a)}else{let n=t;for(const t of e.terms)i.addFilterExpression(u.toLegacyFilterExpression(t,n)),n=n||!!t.hint}return i}}function d(e){return e.terms.every(e=>!e.terms)}function p(e){var t;let n="";if(!(null==e?void 0:e.terms)||0===e.terms.length)return"";if(d(e)){const t=e.terms.find(e=>a(e)),n=e.terms.find(e=>i(e));return`${t.attributeName} ${e.operator} '${null==n?void 0:n.value}'`}if(1===e.terms.length){const r=null===(t=e.operator)||void 0===t?void 0:t.toLowerCase();switch(r){case s.and:return p(e.terms[0]);case s.not:return n=""+p(e.terms[0]),d(e.terms[0])||(n=`(${n})`),n;case s.or:throw new Error("An 'or' logical operation with one term is invalid.");default:throw new Error(`Invalid logical operator ${r}.`)}}else{n=p(e.terms[0]),d(e.terms[0])||(n=`(${n})`);for(let t=1;t<e.terms.length;t++){let r=p(e.terms[t]);d(e.terms[t])||(r=`(${r})`),n=`${n} ${e.operator} ${r}`}}return n}!function(e){e.and="and",e.or="or",e.not="not"}(s||(s={}))},"q/7h":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("1qQb");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){var t;const n=e.get_entities(),a=e.get_query();let i=[];i=a&&a.GetColumnNamesFromFetch?a.GetColumnNamesFromFetch():null===(t=e.get_queryState())||void 0===t?void 0:t.columnNames;const o=[];for(let e=0;e<n.length;e++){const t=Object(r.a)(n[e]);t.queryColumnNames=i,delete t.accessRights,o.push(t)}return o}},q0Q1:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var r=n("tg1f"),a=n("tJ+6");const i="#f3f2f1",o="#6264a7";function s(e,t){const n=Object(r.c)(t),s=n.Patterns;return t=n.Palette,Object(a.c)(e)&&(t.Primary01=i,t.Primary02=o),{Palette:t,Patterns:s}}var c=n("ybOb"),l=n("NjDY");const u="designlanguage.initialize";function d(e){let t=r.b;const n=Object(l.d)(e);if(""!==n){const i=Object(c.a)(n);if(i){const n=s(e,{Primary01:i.maincolor||r.a.Primary01,Primary05:i.accentcolor||r.a.Primary05});n.Patterns.Text01=i.textColor||n.Patterns.Text01,t=function(e,t,n){const i=Object.assign(Object.assign({},s(e,r.a)),t),o=Object.assign(Object.assign({},Object(r.d)(i)),n),c=Object(r.e)(i,o);return{Colors:i,Components:o,DesignLanguageId:Object(a.c)(e)?"TeamsFluent":c.DesignLanguageId,ThemeId:Object(a.c)(e)?"teamsdefault":c.ThemeId}}(e,n,{}),t.Components.Link.Enabled.TextColor=i.linkcolor||t.Components.Link.Enabled.TextColor,t.Components.AppHeader.BackgroundColor=i.navbarbackgroundcolor||t.Components.AppHeader.BackgroundColor,t.Components.Link.Enabled.Hover.TextColor=i.controlborder||t.Components.Link.Enabled.Hover.TextColor,t.ThemeId=i.themeId}}return{type:u,payload:t}}},q27N:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("gw2m");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a={getName:()=>r.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>Promise.all([n.e(19),n.e(55)]).then(n.bind(null,"i+Mw")).then(({CustomPage:t})=>new t(e)),getTelemetryAttributes:e=>[{name:"pageName",value:e.name}]};var i=n("9eA9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o={type:n("D+Bz").a.Page,pageType:"custom",factory:a,isRedirect:!1,urlToInput(e){const t=e.searchParams;if(!t.has("name"))throw new Error("Missing required parameter 'name'");return{name:t.get("name"),entityName:t.get("entityName"),recordId:t.get("recordId")}},inputToUrl(e,t){const n=new i.a(e);return n.searchParams.set("name",t.name),t.entityName&&n.searchParams.set("entityName",t.entityName),t.recordId&&n.searchParams.set("recordId",t.recordId),n.href},inputToWebUrl(e,t){return this.inputToUrl(e,t,!1)}}},q43A:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return u}));var r=n("H4dV"),a=n("SocB");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i=r.a.getInstance().get_IsBrowserIE();function o(e,t){const n={":hover":{backgroundColor:t,color:Object(a.e)(t.toString())}};return Object.assign(Object.assign({},e),n)}function s(e,t,n){const r=Object(a.e)(t),o="#000000"===r?"invert(0%)":"invert(100%)",s=i?{fill:r}:{"-webkit-filter":o,filter:o},c=n?{":hover .svgIcon":s}:s;return Object.assign(Object.assign({},e),c)}function c(e,t,n,r){const o=Object(a.e)(t),s="#000000"===o?"invert(20%)":"invert(100%)";let c=o;"#000000"===o&&(c=r);const l=i?{fill:c}:{"-webkit-filter":s,filter:s},u=n?{":hover .svgIcon":l}:l;return Object.assign(Object.assign({},e),u)}function l(e,t){return{backgroundColor:t?t.Components.AppHeader.Hover.BackgroundColor:e.colors.NavBar.NavBar2.Fill,outline:"1px solid !important",outlineColor:(t?t.Components.AppHeader.Focus.BorderColor:e.colors.NavBar.NavBar3.Text)+" !important",outlineOffset:"-2px !important"}}function u(){return{backgroundColor:a.d.Black+" !important",filter:"invert(100%)"}}},q6Ks:function(e,t,n){"use strict";n.d(t,"e",(function(){return T})),n.d(t,"b",(function(){return w})),n.d(t,"c",(function(){return I})),n.d(t,"d",(function(){return P})),n.d(t,"a",(function(){return N}));var r=n("SAYH"),a=n("eXjw"),i=n("Xd5/"),o=n("MXaZ"),s=n("IqkD"),c=n("5Oca"),l=n("iZ7K"),u=n("3hnk"),d=n("NjDY"),p=n("69Qu"),g=n("unFF"),h=n("YxC/"),f=n("3mEc"),m=n("969l"),b=n("GYEz"),_=n("w1eR"),y=n("5ZBI"),v=n("H4dV"),S=n("4leG"),O=n("tJ+6"),C=n("fU7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const E="CustomControlFramework.Selectors.CustomControlHostPropertyBagSelectors";function I(){let e={},t={};return n=>{y.a.info(E+": createRetrieveFormattingSettingsInfo started");const r=Object(s.w)(n),a=Object(d.g)(n),o=[];return r!==e&&(t.dateTimeFormatInfo!==r.dateFormatInfo&&o.push("dateTimeFormatInfo"),t.numberFormatInfo!==r.numberFormatInfo&&o.push("numberFormatInfo"),t.timeZoneUtcOffsetMinutes!==r.timeZoneUtcOffsetMinutes&&o.push("userTimeZoneUtcOffsetMinutes"),e=r,t={timeZoneUtcOffsetMinutes:r.timeZoneUtcOffsetMinutes,dateTimeFormatInfo:{AMDesignator:r.dateFormatInfo.AMDesignator,AbbreviatedDayNames:r.dateFormatInfo.AbbreviatedDayNames,AbbreviatedMonthGenitiveNames:r.dateFormatInfo.AbbreviatedMonthGenitiveNames,AbbreviatedMonthNames:r.dateFormatInfo.AbbreviatedMonthNames,CalendarWeekRule:r.dateFormatInfo.CalendarWeekRule,Calendar:r.dateFormatInfo.Calendar,DateSeparator:r.dateFormatInfo.DateSeparator,DayNames:r.dateFormatInfo.DayNames,Eras:r.dateFormatInfo.eras,FirstDayOfWeek:r.dateFormatInfo.FirstDayOfWeek,FullDateTimePattern:r.dateFormatInfo.FullDateTimePattern,LongDatePattern:r.dateFormatInfo.LongDatePattern,LongTimePattern:r.dateFormatInfo.LongTimePattern,MonthDayPattern:r.dateFormatInfo.MonthDayPattern,MonthGenitiveNames:r.dateFormatInfo.MonthGenitiveNames,MonthNames:r.dateFormatInfo.MonthNames,PMDesignator:r.dateFormatInfo.PMDesignator,ShortDatePattern:r.dateFormatInfo.ShortDatePattern,ShortTimePattern:r.dateFormatInfo.ShortTimePattern,ShortestDayNames:r.dateFormatInfo.ShortestDayNames,SortableDateTimePattern:r.dateFormatInfo.SortableDateTimePattern,TimeSeparator:r.dateFormatInfo.TimeSeparator,UniversalSortableDateTimePattern:r.dateFormatInfo.UniversalSortableDateTimePattern,YearMonthPattern:r.dateFormatInfo.YearMonthPattern,amDesignator:r.dateFormatInfo.AMDesignator,abbreviatedDayNames:r.dateFormatInfo.AbbreviatedDayNames,abbreviatedMonthGenitiveNames:r.dateFormatInfo.AbbreviatedMonthGenitiveNames,abbreviatedMonthNames:r.dateFormatInfo.AbbreviatedMonthNames,calendarWeekRule:r.dateFormatInfo.CalendarWeekRule,calendar:r.dateFormatInfo.Calendar,dateSeparator:r.dateFormatInfo.DateSeparator,dayNames:r.dateFormatInfo.DayNames,eras:r.dateFormatInfo.eras,firstDayOfWeek:r.dateFormatInfo.FirstDayOfWeek,fullDateTimePattern:r.dateFormatInfo.FullDateTimePattern,longDatePattern:r.dateFormatInfo.LongDatePattern,longTimePattern:r.dateFormatInfo.LongTimePattern,monthDayPattern:r.dateFormatInfo.MonthDayPattern,monthGenitiveNames:r.dateFormatInfo.MonthGenitiveNames,monthNames:r.dateFormatInfo.MonthNames,pmDesignator:r.dateFormatInfo.PMDesignator,shortDatePattern:r.dateFormatInfo.ShortDatePattern,shortTimePattern:r.dateFormatInfo.ShortTimePattern,shortestDayNames:r.dateFormatInfo.ShortestDayNames,sortableDateTimePattern:r.dateFormatInfo.SortableDateTimePattern,timeSeparator:r.dateFormatInfo.TimeSeparator,universalSortableDateTimePattern:r.dateFormatInfo.UniversalSortableDateTimePattern,yearMonthPattern:r.dateFormatInfo.YearMonthPattern},numberFormatInfo:{CurrencyDecimalDigits:r.numberFormatInfo.CurrencyDecimalDigits,CurrencyDecimalSeparator:r.numberFormatInfo.CurrencyDecimalSeparator,CurrencyGroupSeparator:r.numberFormatInfo.CurrencyGroupSeparator,CurrencyGroupSizes:r.numberFormatInfo.CurrencyGroupSizes,CurrencyNegativePattern:r.numberFormatInfo.CurrencyNegativePattern,CurrencyPositivePattern:r.numberFormatInfo.CurrencyPositivePattern,CurrencySymbol:r.numberFormatInfo.CurrencySymbol,NANSymbol:r.numberFormatInfo.NANSymbol,NativeDigits:r.numberFormatInfo.NativeDigits,NegativeInfinitySymbol:r.numberFormatInfo.NegativeInfinitySymbol,NegativeSign:r.numberFormatInfo.NegativeSign,NumberDecimalDigits:r.numberFormatInfo.NumberDecimalDigits,NumberDecimalSeparator:r.numberFormatInfo.NumberDecimalSeparator,NumberGroupSeparator:r.numberFormatInfo.NumberGroupSeparator,NumberGroupSizes:r.numberFormatInfo.NumberGroupSizes,NumberNegativePattern:r.numberFormatInfo.NumberNegativePattern,PerMilleSymbol:r.numberFormatInfo.PerMilleSymbol,PercentDecimalDigits:r.numberFormatInfo.PercentDecimalDigits,PercentDecimalSeparator:r.numberFormatInfo.PercentDecimalSeparator,PercentGroupSeparator:r.numberFormatInfo.PercentGroupSeparator,PercentGroupSizes:r.numberFormatInfo.PercentGroupSizes,PercentNegativePattern:r.numberFormatInfo.PercentNegativePattern,PercentPositivePattern:r.numberFormatInfo.PercentPositivePattern,PercentSymbol:r.numberFormatInfo.PercentSymbol,PositiveInfinitySymbol:r.numberFormatInfo.PositiveInfinitySymbol,PositiveSign:r.numberFormatInfo.PositiveSign,currencyDecimalDigits:r.numberFormatInfo.CurrencyDecimalDigits,currencyDecimalSeparator:r.numberFormatInfo.CurrencyDecimalSeparator,currencyGroupSeparator:r.numberFormatInfo.CurrencyGroupSeparator,currencyGroupSizes:r.numberFormatInfo.CurrencyGroupSizes,currencyNegativePattern:r.numberFormatInfo.CurrencyNegativePattern,currencyPositivePattern:r.numberFormatInfo.CurrencyPositivePattern,currencySymbol:r.numberFormatInfo.CurrencySymbol,nanSymbol:r.numberFormatInfo.NANSymbol,nativeDigits:r.numberFormatInfo.NativeDigits,negativeInfinitySymbol:r.numberFormatInfo.NegativeInfinitySymbol,negativeSign:r.numberFormatInfo.NegativeSign,numberDecimalDigits:r.numberFormatInfo.NumberDecimalDigits,numberDecimalSeparator:r.numberFormatInfo.NumberDecimalSeparator,numberGroupSeparator:r.numberFormatInfo.NumberGroupSeparator,numberGroupSizes:r.numberFormatInfo.NumberGroupSizes,numberNegativePattern:r.numberFormatInfo.NumberNegativePattern,perMilleSymbol:r.numberFormatInfo.PerMilleSymbol,percentDecimalDigits:r.numberFormatInfo.PercentDecimalDigits,percentDecimalSeparator:r.numberFormatInfo.PercentDecimalSeparator,percentGroupSeparator:r.numberFormatInfo.PercentGroupSeparator,percentGroupSizes:r.numberFormatInfo.PercentGroupSizes,percentNegativePattern:r.numberFormatInfo.PercentNegativePattern,percentPositivePattern:r.numberFormatInfo.PercentPositivePattern,percentSymbol:r.numberFormatInfo.PercentSymbol,positiveInfinitySymbol:r.numberFormatInfo.PositiveInfinitySymbol,positiveSign:r.numberFormatInfo.PositiveSign},timeZoneAdjusters:r.timeZoneAdjusters,formatInfoCultureName:r.formatInfoCultureName,workDayStartTime:r.workDayStartTime,formatter:{ParseDateFromString:i.a,formatIntegerValue:i.m,formatCurrencyValue:i.f,formatShortDateValue:i.s,formatLongDateValue:i.o,formatSortableDateValue:i.u,formatSortableDateTimeValue:i.t,formatShortDateTimeValue:i.r,formatDateLongAbbreviated:i.h,formatDateYearMonthValue:i.i,formatDecimalValue:i.k,formatLanguageValue:i.n,parseFormatted:i.D},languagesByCode:a}),y.a.info(E+": createRetrieveFormattingSettingsInfo finished"),{response:t,updatedProperties:o}}}function w(){let e={},t={},n={},a={};return i=>{y.a.info(E+": createRetrieveClientSettingsInfo started");const o=[],c=Object(s.w)(i),l=Object(d.x)(i),u=Object(d.y)(i),p=Object(b.a)(i)===_.a.MobileApplication;if(l!==e){o.push("orgSettings"),e=l;const t={isRTL:!1,fiscalYearStartDate:l.fiscalYearStartDate,fiscalPeriodFormat:l.fiscalPeriodFormat,fiscalPeriodType:l.fiscalPeriodType,fiscalYearFormatYear:l.fiscalYearFormatYear,fiscalYearFormatPrefix:l.fiscalYearFormatPrefix,fiscalYearFormatSuffix:l.fiscalYearFormatSuffix,fiscalYearDisplayCode:l.fiscalYearDisplayCode,fiscalPeriodConnector:l.fiscalPeriodConnector,showWeekNumber:l.showWeekNumber,boundDashboardDefaultCardExpanded:l.boundDashboardDefaultCardExpanded,organizationId:r.a.externalGuid(u.organizationId),isActionCardEnabled:l.isActionCardEnabled,isEmailMonitoringAllowed:l.isEmailMonitoringAllowed,allowUnresolvedPartiesOnEmailSend:null,webResourceHash:l.webResourceHash,enableBingMapsIntegration:l.enableBingMapsIntegration,bingMapsApiKey:l.bingMapsApiKey,availableBingMapLocales:l.availableBingMapLocales,excludedCountriesForMaps:l.excludedCountriesForMaps,bFDatacenter:l.bFDatacenter,securitySettingForEmail:l.securitySettingForEmail,appointmentRichEditorExperience:l.appointmentRichEditorExperience,gridTotalRecordCountLimit:l.gridTotalRecordCountLimit};n=Object.assign(Object.assign({},n),{orgSettingsData:t}),a={allowUnresolvedPartiesOnEmailSend:l.allowUnresolvedPartiesOnEmailSend}}return c===t&&p===n.disableScroll||(t.languageId!==c.languageId&&o.push("languageCode"),t.formatInfoCultureName!==c.formatInfoCultureName&&o.push("locale"),t.isRTL!==c.isRTL&&o.push("isRTL"),n.disableScroll!==p&&o.push("disableScroll"),t=c,n=Object.assign(Object.assign({},n),{languageCode:c.languageId,isRTL:c.isRTL,showWeekNumber:c.showWeekNumber,locale:c.formatInfoCultureName,userAgent:v.a.getInstance().get_CustomControlUserAgent(),usePathBasedUrls:c.usePathBasedUrls,organizationUniqueName:l.organizationUniqueName,disableScroll:p})),y.a.info(E+": createRetrieveClientSettingsInfo finished"),{updatedProperties:o,response:n,ancillaryData:a}}}function j(e,t,n){switch(n){case"email":case"appointment":case"recurringappointmentmaster":return void 0===t||t;default:return!1}}function P(e){let t={},n={};const r=function(e){return t=>{const n=Object(l.h)(e(),t);return n?n.EntityColor:null}}(e);return e=>{y.a.info(E+": createRetrieveThemingData started");const a=Object(g.a)(e),i=Object(O.b)(e),o=[];let s=!1;return a===n&&i===t.shouldUseDesignSystem||(n=a,s=!0,t=Object.assign(Object.assign({},t),{getEntityColor:r,shouldUseDesignSystem:i,defaultThemingData:{defaultthemingcolor:a.colors.MainThemeColor.MainColor1.Fill,mainthemecolor:a.colors.MainThemeColor.MainColor1.Fill,accentthemecolor:a.colors.AccentThemeColor.Accent1.Fill,navbarshelfcolor:a.colors.SiteMap.NavigationShelf,headercolor:a.colors.HeaderText,globallinkcolor:a.colors.Link.Normal.Text,selectedlinkeffect:a.colors.FocusHighlight,selectedlinkeffectcolor:a.colors.FocusHighlight,hoverlinkeffectcolor:a.colors.Link.Hover.Text,processcontrolcolor:a.colors.ProcessControl,defaultentitycolor:a.colors.MainThemeColor.MainColor1.Fill,defaultcustomentitycolor:a.colors.MainThemeColor.MainColor1.Fill,controlshadecolor:a.colors.MainThemeColor.MainColor1.Fill,controlbordercolor:a.colors.MainThemeColor.MainColor1.Fill,textboxfonticonsize:a.fontSizes.TextBox.FontIcon,textboxfontweight:a.fontSizes.TextBox.FontWeight,textboxcontentfontweight:a.fontSizes.TextBox.ContentFontWeight,textboxfontsize:a.fontSizes.TextBox.Font,textboxerrorfontsize:a.fontSizes.TextBox.ErrorFont,textboxspacing:a.sizes.TextBox.Spacing,textboxnotificationiconcontainerheight:a.sizes.TextBox.NotificationIconContainerHeight,textboxcontainerspacing:a.sizes.TextBox.ContainerSpacing,textboxrightmargin:a.sizes.TextBox.RightMargin,textboxlineheight:a.sizes.TextBox.LineHeight,textboxlinethickness:a.sizes.TextBox.LineThickness,textboxhorizontalpadding:a.sizes.TextBox.HorizontalPadding,textboxverticalpadding:a.sizes.TextBox.VerticalPadding,lookuptagpadding:a.sizes.LookupControl.TagPadding,lookuptagmargin:a.sizes.LookupControl.TagMargin,textboxmaxlength:a.sizes.TextBox.MaxLength,normalfontfamily:a.fontFamilies.Normal,normalfontcolor:a.colors.NormalText,normalfontsize:a.fontSizes.Normal,solidborderstyle:a.display.SolidBorderStyle,noneborderstyle:a.display.NoneBorderStyle,colors:{whitebackground:a.colors.BaseColor.White,defaulttheming:a.colors.MainThemeColor.MainColor1.Fill,navbarshelf:a.colors.SiteMap.NavigationShelf,header:a.colors.HeaderText,globallink:a.colors.Link.Normal.Text,selectedlinkeffect:a.colors.FocusHighlight,selectedlinkeffectcolor:a.colors.FocusHighlight,hoverlinkeffect:a.colors.Link.Hover.Text,processcontrol:a.colors.ProcessControl,defaultentity:a.colors.Entity.Fill,defaultcustomentity:a.colors.CustomEntity.Fill,controlshade:a.colors.Control.Fill,controlborder:a.colors.Control.Stroke,control:{text:a.colors.Control.Text,fill:a.colors.Control.Fill,stroke:a.colors.Control.Stroke},navbar:{navbar1:{text:a.colors.NavBar.NavBar1.Text,fill:a.colors.NavBar.NavBar1.Fill},navbar2:{text:a.colors.NavBar.NavBar2.Text,fill:a.colors.NavBar.NavBar2.Fill},navbar3:{text:a.colors.NavBar.NavBar3.Text,fill:a.colors.NavBar.NavBar3.Fill}},pageheader:{text:a.colors.PageHeader.Text,fill:a.colors.PageHeader.Fill},pagepanel:{text:a.colors.PagePanel.Text,fill:a.colors.PagePanel.Text},defaultsurface:{text:a.colors.DefaultSurface.Text,fill:a.colors.DefaultSurface.Fill},customentity:{text:a.colors.CustomEntity.Text,fill:a.colors.CustomEntity.Fill},entity:{text:a.colors.Entity.Text,fill:a.colors.Entity.Fill},title:{text:a.colors.Title.Text,fill:a.colors.Title.Fill},status:{neutral:a.colors.Status.Positive1.Text,error:a.colors.Status.Priority3.Text,warning:a.colors.Status.Priority2.Text,success:a.colors.Status.Positive2.Text,info:a.colors.Status.Positive1.Text},statuscolor:{alert1:{text:a.colors.Status.Alert1.Text,fill:a.colors.Status.Alert1.Fill},alert2:{text:a.colors.Status.Alert2.Text,fill:a.colors.Status.Alert2.Fill},priority1:{text:a.colors.Status.Priority1.Text,fill:a.colors.Status.Priority1.Fill},priority2:{text:a.colors.Status.Priority2.Text,fill:a.colors.Status.Priority2.Fill},priority3:{text:a.colors.Status.Priority3.Text,fill:a.colors.Status.Priority3.Fill},positive1:{text:a.colors.Status.Positive1.Text,fill:a.colors.Status.Positive1.Fill},positive2:{text:a.colors.Status.Positive2.Text,fill:a.colors.Status.Positive2.Fill},info1:{text:a.colors.Status.Info1.Text,fill:a.colors.Status.Info1.Fill},neutral1:{text:a.colors.Status.Neutral1.Text,fill:a.colors.Status.Neutral1.Fill}},accent:{accent1:{text:a.colors.AccentThemeColor.Accent1.Text,fill:a.colors.AccentThemeColor.Accent1.Fill},accent2:{text:a.colors.AccentThemeColor.Accent2.Text,fill:a.colors.AccentThemeColor.Accent2.Fill},accent3:{text:a.colors.AccentThemeColor.Accent3.Text,fill:a.colors.AccentThemeColor.Accent3.Fill}},maintheme:{maincolor1:{fill:a.colors.MainThemeColor.MainColor1.Fill,text:a.colors.MainThemeColor.MainColor1.Text},maincolor2:{fill:a.colors.MainThemeColor.MainColor2.Fill,text:a.colors.MainThemeColor.MainColor2.Text},maincolor3:{fill:a.colors.MainThemeColor.MainColor3.Fill,text:a.colors.MainThemeColor.MainColor3.Text}},base:{white:a.colors.BaseColor.White,black:a.colors.BaseColor.Black,red:a.colors.BaseColor.Red.Red1,orange:a.colors.BaseColor.Orange.Orange1,yellow:a.colors.BaseColor.Yellow.Yellow1,green:a.colors.BaseColor.Green.Green1,blue:a.colors.BaseColor.Blue.Blue1,teal:a.colors.BaseColor.Violet.Voilet1,purple:a.colors.BaseColor.Purple.Purple1},basecolor:{red:{red1:a.colors.BaseColor.Red.Red1,red2:a.colors.BaseColor.Red.Red2,red3:a.colors.BaseColor.Red.Red3,red4:a.colors.BaseColor.Red.Red4,red5:a.colors.BaseColor.Red.Red5},orange:{orange1:a.colors.BaseColor.Orange.Orange1,orange2:a.colors.BaseColor.Orange.Orange2,orange3:a.colors.BaseColor.Orange.Orange3,orange4:a.colors.BaseColor.Orange.Orange4,orange5:a.colors.BaseColor.Orange.Orange5},blue:{blue1:a.colors.BaseColor.Blue.Blue1,blue2:a.colors.BaseColor.Blue.Blue2,blue3:a.colors.BaseColor.Blue.Blue3,blue4:a.colors.BaseColor.Blue.Blue4,blue5:a.colors.BaseColor.Blue.Blue5},green:{green1:a.colors.BaseColor.Green.Green1,green2:a.colors.BaseColor.Green.Green2,green3:a.colors.BaseColor.Green.Green3,green4:a.colors.BaseColor.Green.Green4,green5:a.colors.BaseColor.Green.Green5},teal:{teal1:a.colors.BaseColor.Teal.Teal1,teal2:a.colors.BaseColor.Teal.Teal2,teal3:a.colors.BaseColor.Teal.Teal3,teal4:a.colors.BaseColor.Teal.Teal4,teal5:a.colors.BaseColor.Teal.Teal5},yellow:{yellow1:a.colors.BaseColor.Yellow.Yellow1,yellow2:a.colors.BaseColor.Yellow.Yellow2,yellow3:a.colors.BaseColor.Yellow.Yellow3,yellow4:a.colors.BaseColor.Yellow.Yellow4,yellow5:a.colors.BaseColor.Yellow.Yellow5},clay:{clay1:a.colors.BaseColor.Clay.Clay1,clay2:a.colors.BaseColor.Clay.Clay2,clay3:a.colors.BaseColor.Clay.Clay3,clay4:a.colors.BaseColor.Clay.Clay4,clay5:a.colors.BaseColor.Clay.Clay5},pink:{pink1:a.colors.BaseColor.Pink.Pink1,pink2:a.colors.BaseColor.Pink.Pink2,pink3:a.colors.BaseColor.Pink.Pink3,pink4:a.colors.BaseColor.Pink.Pink4,pink5:a.colors.BaseColor.Pink.Pink5},violet:{violet1:a.colors.BaseColor.Violet.Violet1,violet2:a.colors.BaseColor.Violet.Violet2,violet3:a.colors.BaseColor.Violet.Violet3,violet4:a.colors.BaseColor.Violet.Violet4,violet5:a.colors.BaseColor.Violet.Violet5},purple:{purple1:a.colors.BaseColor.Purple.Purple1,purple2:a.colors.BaseColor.Purple.Purple2,purple3:a.colors.BaseColor.Purple.Purple3,purple4:a.colors.BaseColor.Purple.Purple4,purple5:a.colors.BaseColor.Purple.Purple5},grey:{grey1:a.colors.BaseColor.Grey.Grey1,grey2:a.colors.BaseColor.Grey.Grey2,grey3:a.colors.BaseColor.Grey.Grey3,grey4:a.colors.BaseColor.Grey.Grey4,grey5:a.colors.BaseColor.Grey.Grey5,grey6:a.colors.BaseColor.Grey.Grey6,grey7:a.colors.BaseColor.Grey.Grey7},white:a.colors.BaseColor.White,black:a.colors.BaseColor.Black,transparent:a.colors.BaseColor.Transparent},links:{default:a.colors.Link.Normal.Text,visited:a.colors.Link.Visited.Text,disabled:a.colors.Link.Disabled.Text},linkcolor:{normal:{text:a.colors.Link.Normal.Text,fill:a.colors.Link.Normal.Fill},hover:{text:a.colors.Link.Hover.Text,fill:a.colors.Link.Hover.Fill},visited:{text:a.colors.Link.Visited.Text,fill:a.colors.Link.Visited.Fill},pressed:{text:a.colors.Link.Pressed.Text,fill:a.colors.Link.Pressed.Fill},disabled:{text:a.colors.Link.Disabled.Text,fill:a.colors.Link.Disabled.Text}},grays:{gray01:a.colors.BaseColor.Grey.Grey1,gray02:a.colors.BaseColor.Grey.Grey2,gray03:a.colors.BaseColor.Grey.Grey3,gray04:a.colors.BaseColor.Grey.Grey4,gray05:a.colors.BaseColor.Grey.Grey5,gray06:a.colors.BaseColor.Grey.Grey6,gray07:a.colors.BaseColor.Grey.Grey7,gray08:a.colors.BaseColor.Grey.Grey8,gray09:void 0},statustheme:void 0,baseColor:void 0,linkstheme:void 0},textbox:{fonticonsize:a.fontSizes.TextBox.FontIcon,fontweight:a.fontSizes.TextBox.FontWeight,contentfontweight:a.fontSizes.TextBox.ContentFontWeight,fontsize:a.fontSizes.TextBox.Font,errorfontsize:a.fontSizes.TextBox.ErrorFont,spacing:a.sizes.TextBox.Spacing,notificationiconcontainerheight:a.sizes.TextBox.NotificationIconContainerHeight,containerspacing:a.sizes.TextBox.ContainerSpacing,rightmargin:a.sizes.TextBox.RightMargin,lineheight:a.sizes.TextBox.LineHeight,linethickness:a.sizes.TextBox.LineThickness,errorlinethickness:a.sizes.TextBox.ErrorLineThickness,horizontalpadding:a.sizes.TextBox.HorizontalPadding,verticalpadding:a.sizes.TextBox.VerticalPadding,maxlength:a.sizes.TextBox.MaxLength,labelcolor:a.colors.TextBox.Label,contentcolor:a.colors.TextBox.Content,linecolor:a.colors.TextBox.Line,hoverboxcolor:a.colors.TextBox.HoverBox,backgroundcolor:a.colors.TextBox.Background,errorbackgroundcolor:a.colors.TextBox.ErrorBackground,redcolor:a.colors.TextBox.Red,bluecolor:a.colors.TextBox.Blue,restmodecolor:a.colors.TextBox.RestMode,cellheightinrem:a.sizes.Section.cellHeightInRem},spacings:{xshorizontal:a.spacings.HorizXs,shorizontal:a.spacings.HorizS,bhorizontal:a.spacings.HorizB,mhorizontal:a.spacings.HorizM,lhorizontal:a.spacings.HorizL,xlhorizontal:a.spacings.HorizXl,xxlhorizontal:a.spacings.HorizXxl,xsvertical:a.spacings.VertXs,svertical:a.spacings.VertS,bvertical:a.spacings.VertB,mvertical:a.spacings.VertM,lvertical:a.spacings.VertL,xlvertical:a.spacings.VertXl,xxlvertical:a.spacings.VertXxl},fontfamilies:{semilight:a.fontFamilies.Semilight,semibold:a.fontFamilies.Semibold,regular:a.fontFamilies.Regular,bold:a.fontFamilies.Bold},fontsizes:{xsfontsize:a.fontSizes.FontXS,sfontsize:a.fontSizes.FontS,bfontsize:a.fontSizes.FontB,mfontsize:a.fontSizes.FontM,lfontsize:a.fontSizes.FontL,xlfontsize:a.fontSizes.FontXL,font225:a.fontSizes.Font225,font200:a.fontSizes.Font200,font175:a.fontSizes.Font175,font150:a.fontSizes.Font150,font125:a.fontSizes.Font125,font115:a.fontSizes.Font115,font100:a.fontSizes.Font100,font085:a.fontSizes.Font085,font075:a.fontSizes.Font075,font1143:a.fontSizes.Font1143,font10px:a.fontSizes.Font10px,font12px:a.fontSizes.Font12px,font14px:a.fontSizes.Font14px,font16px:a.fontSizes.Font16px,font18px:a.fontSizes.Font18px,font20px:a.fontSizes.Font20px,font21px:a.fontSizes.Font21px,font24px:a.fontSizes.Font24px,font28px:a.fontSizes.Font28px,font32px:a.fontSizes.Font32px},breakpoints:{dimensionxs:a.sizes.Breakpoints.DimensionXS,dimensions:a.sizes.Breakpoints.DimensionS,dimensionm:a.sizes.Breakpoints.DimensionM,dimensionl:a.sizes.Breakpoints.DimensionL,dimensionxl:a.sizes.Breakpoints.DimensionXL},measures:{measure015:a.sizes.Measures.Measure015,measure025:a.sizes.Measures.Measure025,measure050:a.sizes.Measures.Measure050,measure075:a.sizes.Measures.Measure075,measure100:a.sizes.Measures.Measure100,measure125:a.sizes.Measures.Measure125,measure150:a.sizes.Measures.Measure150,measure175:a.sizes.Measures.Measure175,measure200:a.sizes.Measures.Measure200,measure225:a.sizes.Measures.Measure225,measure250:a.sizes.Measures.Measure250,measure275:a.sizes.Measures.Measure275,measure300:a.sizes.Measures.Measure300,measure325:a.sizes.Measures.Measure325,measure350:a.sizes.Measures.Measure350,measure400:a.sizes.Measures.Measure400,measure450:a.sizes.Measures.Measure450,measure500:a.sizes.Measures.Measure500,measure550:a.sizes.Measures.Measure550,measure600:a.sizes.Measures.Measure600,measure700:a.sizes.Measures.Measure700,measure750:a.sizes.Measures.Measure750,measure775:a.sizes.Measures.Measure775,measure900:a.sizes.Measures.Measure900,measure1075:a.sizes.Measures.Measure1075,measure1143:a.sizes.Measures.Measure1143,measure2875:a.sizes.Measures.Measure2875},lookup:{tagpadding:a.sizes.LookupControl.TagPadding,tagmargin:a.sizes.LookupControl.TagMargin,tagbackgroundcolor:a.colors.LookupTagBackground},borders:{border01:a.borders.Border01,border02:a.borders.Border02,border03:a.borders.Border03,border04:a.borders.Border04,border05:a.borders.Border05},shadows:{shadow01:a.shadows.Shadow01},buttons:{button01primary:a.buttons.Button01Primary,button01secondary:a.buttons.Button01Secondary,buttonprimarytext:a.buttons.ButtonPrimaryText,buttonsecondarytext:a.buttons.ButtonSecondaryText,actioniconbutton01:a.buttons.ActionIconButton01,button02primary:a.buttons.Button02Primary,button02secondary:a.buttons.Button02Secondary},links:{TouchTarget:a.links.TouchTarget,Reset:a.links.Reset,Focus:a.links.Focus,Hover:a.links.Hover,Pressed:a.links.Pressed,Visited:a.links.Visited}}})),s&&o.push("theming"),y.a.info(E+": createRetrieveThemingData finished"),{response:t,updatedProperties:o}}}function T(e){return{encoder:{CrmUrlEncode:C.CrmUrlEncode,CrmHtmlEncode:C.CrmHtmlEncode},dateTimeUtils:{getConstraintByYear:o.n,getLocalAdjustmentFromDate:o.t,getDSTAdjustment:o.o,getDSTAdjustmentMinutes:o.p,convertStringToDate:o.k,convertDateTimeFromUtcToUserDisplay:o.i,convertDateTimeFromUserDisplayToUTC:o.h,convertDateTimeFromUserDisplayToTimezoneIndependent:o.g,convertTimeToBehaviorDisplay:o.m,getWeekOfYear:o.F,getWeekOfYearFullDays:o.G,convertTimeFromBehaviorDisplay:o.l,getDatePart:o.q},hasEntityPrivilege:(t,n,r)=>Object(u.g)(e(),t,n,r)}}function N(){const e=function(){let e={strings:{},stringsLoaded:!0};const t={};return(n,r)=>{const i=r?r.ConstructorName+"."+E:E;y.a.info(i+": createRetrieveResourcesData started");const o=r?m.a.getControlsResourceKeyList(r.CustomControlId):null,s=Object(h.d)(n);if(s&&o){let t=!1;const n={};for(const r of o)s[r]&&null!==s[r]&&(n[r]=s[r],e.strings[r]&&e.strings[r]===n[r]||(t=!0));if(t){const t=Object.assign(Object.assign({},e.strings),n);e={strings:t,stringsLoaded:!0}}}const c=Object(f.k)(n);if(!c)return e;if(r)for(const n of r.Properties.Resources)if(5===n.Type){const r=c[n.Name];if(!r||r&&!r.contentJson&&r.state!==a.a.Error){e=Object.assign(Object.assign({},e),{stringsLoaded:!1});break}if(r.contentJson!==t[n.Name]){t[n.Name]=r.contentJson;const a=Object.assign(Object.assign({},e.strings),r.contentJson);e={strings:a,stringsLoaded:!0}}}return y.a.info(i+"."+E+": createRetrieveResourcesData finished"),e}}(),t=function(){let e={};return(t,n)=>{y.a.info(E+": createRetrievePageInfo started");const r=function(e,t){return{appId:e.metadata.appContext&&e.metadata.appContext.app?e.metadata.appContext.app.appId:null,isPageReadOnly:t}}(t,n),a=[],i=r.isPageReadOnly!==e.isPageReadOnly,o=r.appId!==e.appId;return(i||o)&&(o&&a.push("appId"),i&&a.push("isPageReadOnly"),e=r),y.a.info(E+": createRetrievePageInfo finished"),{response:e,updatedProperties:a}}}();let n={},i={},o={},s={},u="",d={};return(a,g,h,f,m)=>{let b=[];const _=m.getCommonPropertyBagData(a),y=_.ancillaryData;if(_.response!==s&&(d={},b=b.concat(_.updatedProperties),o=Object.assign(Object.assign({},o),_.response),s=_.response),y!==d||u!==h.entityTypeName){const e=Object.assign(Object.assign({},o.clientData),{orgSettingsData:Object.assign(Object.assign({},o.clientData.orgSettingsData),{allowUnresolvedPartiesOnEmailSend:j(0,y.allowUnresolvedPartiesOnEmailSend,h.entityTypeName)})});o=Object.assign(Object.assign({},o),{clientData:e}),d=y,u=h.entityTypeName}const v=t(a,f);v.response!==i&&(b=b.concat(v.updatedProperties),o=Object.assign(Object.assign({},o),{pageData:v.response}),i=v.response);const O=e(a,g);O!==n&&(o=Object.assign(Object.assign({},o),{resourcesData:O}),n=O);const C="quickcreate"===h.pageType?r.a.EMPTY.guid:h&&h.id&&h.id.guid,E=h.entityTypeName,I=!Object(p.b)(a),w=Object(S.d)(a),P=C!==(o.modeData?o.modeData.entityId:null),T=E!==(o.modeData?o.modeData.entityTypeName:null),N=I!==(o.modeData?o.modeData.isOffline:null);if(P||T||N){let e=null;const t=Object(c.i)(a,E),n=Object(l.h)(a,E);if(t&&n&&C){const r=t[C],a=n.PrimaryNameAttribute;r&&a&&r.fields&&r.fields[a]&&null!=r.fields[a].value&&(e=r.fields[a].value)}P&&b.push("entityId"),T&&b.push("entityName"),N&&b.push("isOffline"),o=Object.assign(Object.assign({},o),{modeData:{entityTypeName:E,entityId:C,entityRecordName:e,isOffline:I,isAuthoringMode:w}})}return{response:o,updatedProperties:b}}}},qAG9:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){if(!e)return null;let n=e.get(t);return n||(n=e.get(t.toLowerCase())),n}n.d(t,"a",(function(){return r}))},qCX6:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("umme"),a=n("504W"),i=n("EW4s");class o{get_isOfflineDataSourceInitialized(){return!0}get_applicationStatusProvider(){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.get_ApplicationStatusProvider is not supported")}get_offlineTypescriptInterface(){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.get_OfflineTypescriptInterface is not supported")}set_offlineTypescriptInterface(e){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.set_OfflineTypescriptInterface is not supported")}initialize(e){const t=new i.a;return t.resolve(!0),t}calculateDisabledOfflineEntities(){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.CalculateDisabledOfflineEntities is not supported")}refreshLookupData(e,t,n,r){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.RefreshLookupData is not supported")}refreshRetrieveMultipleLookupData(e,t,n){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.RefreshRetrieveMultipleLookupData is not supported")}getExistingActivityParties(e){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.GetExistingActivityParties is not supported")}startPlayback(){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.StartPlayback is not supported")}hasItemsToUpsync(){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.HasItemsToUpsync is not supported")}hasOfflineChanges(e,t){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.hasOfflineChanges is not supported")}get_localDataSource(){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.get_LocalDataSource is not supported")}isEntityAvailableForOfflineUsage(e){return!1}isOfflineAvailableForUse(){return!1}isOfflineFeatureEnabledForOrganization(){return!1}isAppAvailableOffline(){return!1}isOfflineOptedIn(){return!1}isDssOfflineEnabled(){return!1}get_syncErrorCount(){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.get_SyncErrorCount is not supported")}set_syncErrorCount(e){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.set_SyncErrorCount is not supported")}applyApplicationMetadataChanges(){const e=new i.a;return e.resolve(!0),e}createActivityPointerAndAttachmentView(){}}class s{constructor(){this._OfflineDataSource=null}get_offlineDataSource(){return this._OfflineDataSource}set_offlineDataSource(e){return this._OfflineDataSource=e,e}isOfflineDataSourceInitialized(){return!!this.get_offlineDataSource()&&this.get_offlineDataSource().get_isOfflineDataSourceInitialized()}initializeOfflineDataSource(e){return this.get_offlineDataSource()?this.get_offlineDataSource().initialize(e):(new i.a).reject(r.a.FromMessage("Cannot Initialize Offline data source as the object is not available"))}calculateDisabledOfflineEntities(){return this.get_offlineDataSource()?this.get_offlineDataSource().calculateDisabledOfflineEntities():(new i.a).reject(r.a.FromMessage("Cannot calculate disabled offline entities as the OfflineDataSource object is not available"))}applyApplicationMetadataChanges(){return this.get_offlineDataSource().applyApplicationMetadataChanges()}createActivityPointerAndAttachmentView(){this._OfflineDataSource.createActivityPointerAndAttachmentView()}startPlayback(){return this.get_offlineDataSource().startPlayback()}hasItemsToUpsync(){return this.get_offlineDataSource().hasItemsToUpsync()}hasOfflineChanges(e,t){return this.get_offlineDataSource().hasOfflineChanges(e,t)}cleanUpDatabases(e){return this.get_offlineDataSource().get_localDataSource().get_offlineDataStore().cleanUpDatabases(e)}schedulePeriodicSyncJob(e,t){return this.get_offlineDataSource().get_localDataSource().get_offlineDataStore().schedulePeriodicSyncJob(e,t)}cancelSync(){return this.get_offlineDataSource().get_localDataSource().get_offlineDataStore().cancelSync()}set_offlineTypescriptInterface(e){this.get_offlineDataSource().set_offlineTypescriptInterface(e)}get_syncErrorCount(){return this.get_offlineDataSource().get_syncErrorCount()}verifyIfLinkedEntitiesOfflineEnabled(e){const t=Sys.Net.XMLDOM(e);if(t.getElementsByTagName("link-entity").length>0){const e=t.getElementsByTagName("link-entity");for(let n=0;n<e.length;n++)if(!Object(a.a)(t.getElementsByTagName("link-entity")[n].attributes.getNamedItem("name"))){const e=t.getElementsByTagName("link-entity")[n].attributes.getNamedItem("name").nodeValue;if(!this.isOfflineDataSourceInitialized()||!this.get_offlineDataSource().isEntityAvailableForOfflineUsage(e))return!1}}return!0}static get_instance(){return Object(a.a)(s._instance)&&(s._instance=new s,s._instance.set_offlineDataSource(new o)),s._instance}}s._instance=null},qDUg:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("lPW2");t._BondDataType=r._BondDataType;var a=n("+VI0");t._Encoding=a;var i=n("7ANZ");t.IO=i;var o=n("XosO");t.Int64=o.Int64,t.UInt64=o.UInt64,t.Number=o.Number;var s=function(){function e(e){this._stream=e}return e.prototype._WriteBlob=function(e){this._stream._Write(e,0,e.length)},e.prototype._WriteBool=function(e){this._stream._WriteByte(e?1:0)},e.prototype._WriteContainerBegin=function(e,t){this._WriteUInt8(t),this._WriteUInt32(e)},e.prototype._WriteMapContainerBegin=function(e,t,n){this._WriteUInt8(t),this._WriteUInt8(n),this._WriteUInt32(e)},e.prototype._WriteDouble=function(e){var t=a._Double_GetBytes(e);this._stream._Write(t,0,t.length)},e.prototype._WriteFieldBegin=function(e,t,n){t<=5?this._stream._WriteByte(e|t<<5):t<=255?(this._stream._WriteByte(192|e),this._stream._WriteByte(t)):(this._stream._WriteByte(224|e),this._stream._WriteByte(t),this._stream._WriteByte(t>>8))},e.prototype._WriteInt32=function(e){e=a._Zigzag_EncodeZigzag32(e),this._WriteUInt32(e)},e.prototype._WriteInt64=function(e){this._WriteUInt64(a._Zigzag_EncodeZigzag64(e))},e.prototype._WriteString=function(e){if(""===e)this._WriteUInt32(0);else{var t=a._Utf8_GetBytes(e);this._WriteUInt32(t.length),this._stream._Write(t,0,t.length)}},e.prototype._WriteStructEnd=function(e){this._WriteUInt8(e?r._BondDataType._BT_STOP_BASE:r._BondDataType._BT_STOP)},e.prototype._WriteUInt32=function(e){var t=a._Varint_GetBytes(o.Number._ToUInt32(e));this._stream._Write(t,0,t.length)},e.prototype._WriteUInt64=function(e){var t=a._Varint64_GetBytes(e);this._stream._Write(t,0,t.length)},e.prototype._WriteUInt8=function(e){this._stream._WriteByte(o.Number._ToUInt8(e))},e}();t.CompactBinaryProtocolWriter=s},qFOq:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.NotReadOnly=0]="NotReadOnly",e[e.RecordStatus=1]="RecordStatus",e[e.RecordPermissions=2]="RecordPermissions",e[e.EntityPermissions=3]="EntityPermissions",e[e.Offline=4]="Offline"}(r||(r={}))},qJCH:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e,t){this._key=null,this._personalization=null,this._key=e,this._personalization=t}get_personalization(){return this._personalization}get_key(){return this._key}getObjectData(){const e={};return e[r.KeyPath]=this._key,e.personalization=this._personalization,e}static createFromObjectData(e){const t=e[r.KeyPath],n=e.personalization;return new r(t,n)}}r.KeyPath="key"},qK01:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");class a extends r.a{constructor(e,t,n){super(),this._target=null,this._solutionUniqueName=null,this._concurrencyBehavior=0,this._target=e,this._solutionUniqueName=t,this._concurrencyBehavior=n}get_name(){return"Delete"}get_xmlNamespace(){return"http://schemas.microsoft.com/xrm/2011/Contracts"}get_target(){return this._target}get_solutionUniqueName(){return this._solutionUniqueName}get_concurrencyBehavior(){return this._concurrencyBehavior}set_concurrencyBehavior(e){return this._concurrencyBehavior=e,e}}},qK6n:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,i.default)(e)};var r,a=n("1VTM"),i=(r=a)&&r.__esModule?r:{default:r};e.exports=t.default},qLnS:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.CanCreate=1]="CanCreate",e[e.CanRead=2]="CanRead",e[e.CanUpdate=4]="CanUpdate"}(r||(r={}))},qMYv:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Button_Label_Save_Footer",a="Web.Form.RecordSave.Success",i="Footer_Caption",o="Footer_StatusControl_Save_ToolTip",s=[r,a,i,o,"Dialog_Label_Active"]},qOTE:function(e,t,n){"use strict";function r(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}n.d(t,"a",(function(){return r}))},qUtK:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("K7RF"),a=n("FdKt"),i=n("eXjw"),o=n("GWSs"),s=n("wyQO"),c=n("Brg7"),l=n("zzhk"),u=n("2FbK"),d=n("/oKV"),p=n("iJGp");let g=!0;function h(){return{type:"sitemap.retrieve.async",execute({dispatch:e,getState:t},n){let l=d.a.LocalAndRemote;const u=t(),g=Object(o.i)(u);if(g===i.a.Initialized&&Object(r.e)(u,Object(o.k)(u).OverallVersionNumber)&&(l=d.a.Remote),g===i.a.Initializing||g===i.a.Uninitialized||l!==d.a.LocalAndRemote){let u=Promise.resolve();e(function(){const e={siteMap:{initialized:i.a.Initializing}};return{type:r.a,payload:e}}()),l===d.a.Remote&&(u=e(Object(s.d)(!0)));const g=e(function(e){return{type:"sitemap.retrieve.async",execute({dispatch:t,getState:n},i){const s=t(Object(r.b)("sitemap",null,null,null,!0,p.a.OnDemandWithoutContext,null,null,[],null,e));return s.then(()=>{Object(a.b)(()=>t(Object(c.a)(o.m)),"SiteMapLoadImages")}),s}}}(l));return g.then(()=>{f(t(),n)}),Promise.all([u,g])}return f(t(),n),Promise.resolve()}}}function f(e,t){try{if(g&&Object(l.b)(e)){const n=Object(u.a)(e);if(n&&n.Areas){g=!1;const e=n.Areas;let r=0;const a=Object.keys(e).length,i=[],o=[];for(const t in e){const n=e[t];if(n&&n.Groups){const e=Object.keys(n.Groups).length;r+=e,i.push(e);for(const e in n.Groups)if(n.Groups[e].SubAreas){const t=Object.keys(n.Groups[e].SubAreas).length;o.push(t),r+=t}}}const s=[];s.push({name:"ic",value:r}),s.push({name:"ac",value:a}),s.push({name:"ars",value:JSON.stringify(i)}),s.push({name:"gs",value:JSON.stringify(o)}),t.EventManager.ReportComponentSuccess("NPSSitMap.structure",s)}else t.EventManager.ReportComponentFailure("retrieveSiteMap.siteMapTelemetry",new Error("site map is null or undefined"))}}catch(e){t.EventManager.ReportComponentFailure("retrieveSiteMap.siteMapTelemetry",e)}}},"qk+o":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the KbArticle page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="KbArticle"},qn5m:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("NjDY"),a=n("IqkD"),i=n("3mEc");function o(e,t){const n=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){const t=Object(r.x)(e),n=Object(a.w)(e);return{orgname:t.organizationUniqueName,orglcid:t.orgCultureInfoLCID&&t.orgCultureInfoLCID.toString(),userlcid:n.languageId&&n.languageId.toString()}}(e);return n&&t?Object.keys(n).reduce((e,t)=>Object(i.b)(e,t,n[t]),t):t}},qpML:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r,a;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),function(e){e[e.InProgress=0]="InProgress",e[e.Finished=1]="Finished",e[e.Failed=2]="Failed",e[e.Cancelled=3]="Cancelled"}(r||(r={})),function(e){e[e.Upload=0]="Upload",e[e.Download=1]="Download",e[e.Delete=2]="Delete"}(a||(a={}))},qshH:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("16wZ"),a=n("WePp"),i=n("IaGr"),o=n("ZIjf"),s=n("dHD5");let c;class l{static getInstance(e){try{return!c&&e&&(c=e),l._instance||(l._instance=new l),l._instance}catch(e){throw l.getInstance().reportFailure("ClientApi.XrmReporting.getInstance",e),e}}reportSuccess(e,t){const n="ClientApi.XrmReporting.reportSuccess";e||Object(r.j)(n,"componentName");try{e.startsWith("ClientApi.")||o.a.instance.reportCall(n),i.a.getInstance().eventManager.ReportComponentSuccess(e,t),e.startsWith("ClientApi.")||o.a.instance.reportSuccess(n)}catch(e){throw this.reportFailure(n,e),e}}reportFailure(e,t,n,a){const s="ClientApi.XrmReporting.reportFailure";e||Object(r.j)(s,"componentName"),t||Object(r.j)(s,"failureError");try{e.startsWith("ClientApi.")||o.a.instance.reportCall(s),e.startsWith("ClientApi.")&&o.a.instance.reportFailure(e)}catch(e){i.a.getInstance().eventManager.ReportComponentFailure(s+".reportClientApiFailure",e)}i.a.getInstance().eventManager.ReportComponentFailure(e,t,n,a);try{e.startsWith("ClientApi.")||o.a.instance.reportSuccess(s)}catch(e){i.a.getInstance().eventManager.ReportComponentFailure(s+".reportClientApiSuccess",e)}}reportEvent(e){e||Object(r.j)("ClientApi.XrmReporting.reportEvent","event");try{o.a.instance.reportCall("ClientApi.XrmReporting.reportEvent");const t=new a.a(e.eventName);for(const n of e.eventParameters)t.addEventParameter(n.name,n.value);i.a.getInstance().eventManager.ReportEvent(t),o.a.instance.reportSuccess("ClientApi.XrmReporting.reportEvent")}catch(e){throw this.reportFailure("ClientApi.XrmReporting.reportEvent",e),e}}getEventParameters(e){const t=[];return t.push({name:"contextKey",value:Object(s.v)(e)}),t}}},qu3G:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.navigateToHome="navigateToHome",e.switchArea="switchArea",e.collapseAreaSwitcher="collapseAreaSwitcher",e.expandAreaSwitcher="expandAreaSwitcher",e.expandSiteMap="expandSiteMap",e.collapseSiteMap="collapseSiteMap",e.blankSession="blankSession",e.navigateToSubArea="navigateToSubArea",e.navigateToRecentItem="navigateToRecentItem",e.navigateToPinnedItem="navigateToPinnedItem",e.pinItem="pinItem",e.unPinItemFromRecent="unPinItemFromRecent",e.unPinItemFromPinned="unPinItemFromPinned",e.expandRecent="expandRecent",e.expandPinned="expandPinned",e.collapseRecent="collapseRecent",e.collapsePinned="collapsePinned",e.navigateToQuery="navigateToQuery"}(r||(r={}))},quej:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("SAYH"),a=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="businessProcessFlow.instance.update.timestamp";function o(e){const t=(new Date).getTime(),n={entities:{[e.etn]:{[r.a.toString(e.id)]:{initialized:a.a.Initialized,processInstanceModifiedTimestamp:t}}}};return{type:i,payload:n}}},"r/9v":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let r,a=!1;function i(e){return r&&r.SkypeChannel&&r.SkypeChannel.SkypeChannelClient&&r.SkypeChannel.SkypeChannelClient.PresenceInformation?r.SkypeChannel.SkypeChannelClient.PresenceInformation.getPresenceMappedField(e):null}function o(e){return!!(r&&r.SkypeChannel&&r.SkypeChannel.SkypeChannelClient&&r.SkypeChannel.SkypeChannelClient.PresenceInformation&&a)&&r.SkypeChannel.SkypeChannelClient.PresenceInformation.isPresenceEnabledEntity(e)}function s(e,t){a=e,r=t}},r0R4:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("UZFl"),a=n("pEXn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i={getName:()=>r.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>n.e(44).then(n.bind(null,"TQrM")).then(({Apps:t})=>new t(e)),getTelemetryAttributes:e=>[{name:a.b.WebResourceName,value:e&&e.webresourceName}]};Object.freeze(i);var o=n("9eA9"),s=n("D+Bz"),c=n("xagu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l={type:s.a.Page,pageType:"apps",factory:i,urlToInput:e=>({webresourceName:e.searchParams.get(c.C)}),inputToUrl(e,t){const n=new o.a(e);return n.searchParams.set(c.C,t.webresourceName),n.href}}},rCFy:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="offline.subscription.set";function a(e,t){return{type:r,payload:{subscriptionId:e,subscriptionErrorMessage:t}}}},rO1J:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("84PK"),a=n("qLnS");class i{constructor(e,t,n,r){this._attributeId=null,this._canCreate=!1,this._canRead=!1,this._canUpdate=!1,this._accessRightsMask=0,this._attributeId=e,this._canCreate=t,this._canRead=n,this._canUpdate=r,this._accessRightsMask=0,this._accessRightsMask=this._canCreate?this.get_AccessRightsMask()|a.a.CanCreate:this._accessRightsMask,this._accessRightsMask=this._canRead?this.get_AccessRightsMask()|a.a.CanRead:this._accessRightsMask,this._accessRightsMask=this._canUpdate?this.get_AccessRightsMask()|a.a.CanUpdate:this._accessRightsMask}get_AttributeId(){return this._attributeId}get_CanCreate(){return this._canCreate}get_CanRead(){return this._canRead}get_CanUpdate(){return this._canUpdate}get_AccessRightsMask(){return this._accessRightsMask}getObjectData(){return{attributeid:this._attributeId.getObjectData(),cancreate:this._canCreate,canread:this._canRead,canupdate:this._canUpdate}}static createFromObjectData(e){const t=r.a.createFromObjectData(e.attributeid);return new i(t,e.cancreate,e.canread,e.canupdate)}}},rQHy:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("6hHv"),a=n("ILmX"),i=n("wgH2"),o=n("GYDS"),s=n("nlPs"),c=n("dHD5");function l(e,t,n){return{type:"commandbar.refresh.async",execute({dispatch:l,getState:u},d){const p=u(),g=p&&p.commands,h=[];if(g)if(n)for(const e in g)h.push(e);else{const n=Object(o.a)(e,t);h.push(n)}return Promise.all(h.map(t=>{const n=Object(s.b)(u(),t),o=Object(c.v)(n),d=Object(a.k)(u(),t),p=Object(i.c)(u(),t);return l(Object(r.c)(d,p,e,t,o,!0))})).then(e=>!0)}}}},rWW8:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a{constructor(e,t,n){this.requestId=null,this._callerName=null,this._callerPriority=0,this._stack=null,this._callerName=Object(r.b)(t)?a.unknown:t,this._callerPriority=n}get_callerName(){return this._callerName}get_Stack(){return this._stack}AppendCallStack(e){Object(r.a)(e)||(Object(r.a)(this._stack)?this._stack=e:this._stack=this._stack+":"+e)}get_callerPriority(){return this._callerPriority}IsPreloadCall(){return!1}}a.unknown="unknown"},rcL5:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return s}));var r=n("/leX"),a=n("zsAz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e){return e.panelManager}function o(e,t){const n=i(e)[t];if(!n)throw Object(a.d)("SidePanel does not exist",2415919126,[{name:"sidePanelId",value:t}]);return n}function s(e,t){const n=i(e),a=Object.keys(n);for(let e=0;e<a.length;e++){const i=n[a[e]];if(i.type===r.b.Page&&i.option.sidePanelPosition===t)return i}return null}function c(e,t){const n=i(e),r=Object.keys(n);for(let e=0;e<r.length;e++){const a=n[r[e]];if(a.option.sidePanelPosition===t)return a}return null}},rdtZ:function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.setNetworkInfo=t.processBrowserResourceTimings=t.clearBrowserResourceTimings=t.CACHED_NAME=t.RESOURCE_NAME=t.NETWORK_REQUEST_EVENT_NAME=void 0;var i=a(n("DRVD")),o=a(n("zmaG")),s=n("Lhhr"),c=n("G0by");t.NETWORK_REQUEST_EVENT_NAME="BrowserResourceTimings";t.RESOURCE_NAME="name";t.CACHED_NAME="cached";var l,u=i.default.createEvent("Fetch","BrowserResourceTimings"),d={xmlhttprequest:i.default.createEvent("XMLHttpRequest","BrowserResourceTimings"),script:i.default.createEvent("AssetLoad.Script","BrowserResourceTimings"),link:i.default.createEvent("AssetLoad.Link","BrowserResourceTimings"),iframe:i.default.createEvent("AssetLoad.IFrame","BrowserResourceTimings"),fetch:u,"":u},p=i.default.createEvent("RequestPatch","BrowserResourceTimings");function g(e){try{return e&&e.performance&&"function"==typeof e.performance.clearResourceTimings&&!!e.performance.clearResourceTimings}catch(e){return!1}}t.processBrowserResourceTimings=function(){var e=c.getNetworkRequests(),t=[],n=function(e,n){var a,i;if(g(e)){var o=e.performance,s=o.getEntriesByType("resource");try{for(var c=r(s),l=c.next();!l.done;l=c.next()){var u=l.value;t.push({resource:u,performanceObject:o,identifier:n})}}catch(e){a={error:e}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(a)throw a.error}}}};n(window,"MainWindow"),s.forEachAdditionalWindow((function(e){n(e.contentWindow,e.id)})),l&&o.default.addCommonKpiParameters(l);var a=0;t.sort((function(e,t){return e.performanceObject.timing.navigationStart+e.resource.startTime-(t.performanceObject.timing.navigationStart+t.resource.startTime)})).forEach((function(t){for(var n,r=a;r<e.length;r++){var i=t.resource.initiatorType;if(t.resource.name.endsWith(e[r].url)&&(("fetch"===i||""===i)&&e[r].fetch||"xmlhttprequest"===i&&!e[r].fetch)){n=e.splice(r,1)[0],a=r;break}}!function(e,t){var n=e.performanceObject,r=e.resource,a=n.timing.navigationStart-window.performance.timing.navigationStart;if(d[r.initiatorType]){var i=r.startTime+a,o=r.responseEnd+a-i,s=d[r.initiatorType],c={};r.connectEnd&&(c.connectEnd=Math.round(r.connectEnd+a).toString()),r.connectStart&&(c.connectStart=Math.round(r.connectStart+a).toString()),r.domainLookupEnd&&(c.domainLookupEnd=Math.round(r.domainLookupEnd+a).toString()),r.domainLookupStart&&(c.domainLookupStart=Math.round(r.domainLookupStart+a).toString()),c.duration=Math.round(r.duration).toString(),c.fetchStart=Math.round(r.fetchStart+a).toString(),c.name=r.name.toString(),r.redirectEnd&&(c.redirectEnd=Math.round(r.redirectEnd+a).toString()),r.redirectStart&&(c.redirectStart=Math.round(r.redirectStart+a).toString()),r.requestStart&&(c.requestStart=Math.round(r.requestStart+a).toString()),c.responseEnd=Math.round(r.responseEnd+a).toString(),r.responseStart&&(c.responseStart=Math.round(r.responseStart+a).toString()),c.startTime=Math.round(r.startTime+a).toString(),r.workerStart&&(c.workerStart=Math.round(r.workerStart+a).toString()),r.decodedBodySize&&(c.decodedBodySize=r.decodedBodySize.toString()),r.encodedBodySize&&(c.encodedBodySize=r.encodedBodySize.toString()),r.nextHopProtocol&&(c.nextHopProtocol=r.nextHopProtocol.toString()),r.secureConnectionStart&&(c.secureConnectionStart=Math.round(r.secureConnectionStart+a).toString()),r.transferSize&&(c.transferSize=r.transferSize.toString()),r.responseStart&&void 0!==r.transferSize&&(c.cached=(0===r.transferSize).toString()),c.window=e.identifier,l&&Object.assign(c,l),Object.assign(c,t),s.createRetroactiveStopwatch(i,o,c)}}(t,n)})),e.forEach((function(e){p.createRetroactiveStopwatch(e.patchStartTime,e.patchDuration,JSON.parse(JSON.stringify(e)))}))},t.clearBrowserResourceTimings=function(){g(window)&&(window.performance.clearResourceTimings(),s.forEachAdditionalWindow((function(e){g(e.contentWindow)&&e.contentWindow.performance.clearResourceTimings()}))),c.resetNetworkRequests()},t.setNetworkInfo=function(e){l=e}},rodW:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("SAYH"),a=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="businessProcessFlow.addRefreshGlobalNavigationDataFlagToRecordData";function o(e,t){const n={entities:{[t.etn]:{[r.a.toString(t.id)]:{initialized:a.a.Initialized,refreshGlobalNavigationData:e}}}};return{type:i,payload:n}}},ruPX:function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"c",(function(){return E})),n.d(t,"b",(function(){return I}));var r=n("9eA9"),a=n("JC5U"),i=n("xPbo"),o=n("gQ5I"),s=n("ZuxC"),c=n("5w+f"),l=n("JHwY"),u=n("pF61"),d=n("D+Bz"),p=n("oqdd"),g=n("zsAz"),h=n("31Vn"),f=n("1OTd"),m=n("oT5e"),b=n("3/02"),_=n("Lyxw"),y=n("GYEz"),v=n("w1eR");function S(e,t,n,r){return{type:f.j,execute(b,_){const S={pageName:e,input:t};let I;if("object"==typeof r)I=Object.assign({},r);else{I={source:r}}const j=I.source===d.b.Redirect;return j&&(I.replaceState=j),_.CustomNavigationHandler.handleNavigation(S,I,b,n).then(e=>e||function(e,t,n,r,b){if(t.source===d.b.SwitchApp){const t=n.getState(),r=t&&t.metadata&&t.metadata.appContext&&t.metadata.appContext.app&&t.metadata.appContext.app.appId;e.input=Object.assign(Object.assign({},e.input),{appId:r})}const _=r.Router;return _.preRenderCheck(e).then(d=>{if(d.resultType===p.a.Redirect)e=d.resultValue;else if(d.resultType===p.a.Fail){const n=e&&e.input&&e.input.uniqueName,a=e&&e.input&&e.input.entityTypeName,i=[{name:"Options",value:w(t)},{name:"PageName",value:e&&e.pageName},{name:"EntityTypeName",value:a},{name:"UniqueName",value:n},{name:"PreRenderStatusResultType",value:p.a[d.resultType]}];return r.EventManager.ReportComponentFailure("Navigation.Page",d.resultValue,"Analyze event parameters to understand why prePageRender failed.",i),Promise.resolve({status:1,error:d.resultValue})}return function(e,t,n,r,d,p){let b=Promise.resolve(!0);const _=p||Object(u.c)(r.getState(),n.targetBrowsingContext);_&&(b=e.shouldNavigate(t,!0,_,n));return b.then(b=>{if(b)return function(e,t,n,r,d,p){const f=e.isPageADialog(r.getState(),t,n,p);if(!f){if("newWindow"===(null==n?void 0:n.target)&&Object(y.a)(r.getState())===v.a.Browser){const e=r.dispatch(E(t.pageName,t.input)),a=[];return a.unshift({name:"Options",value:""+w(n)}),a.unshift({name:"Url",value:Object(h.a)(t.pageName)}),a.unshift({name:"IsDialog",value:""+f}),a.unshift({name:"PageName",value:t.pageName}),e}return r.dispatch(Object(o.d)(n.targetBrowsingContext)).then(()=>{r.dispatch(Object(a.b)());return e.navigateTo(t,n,r,p).then(([e,a,o,c,l,p])=>{const g=r.getState(),f=e.getId(),m=o?Object(u.c)(g):f;l.unshift({name:"Options",value:w(n)}),l.unshift({name:"Url",value:Object(h.a)(t.pageName)}),l.unshift({name:"IsDialog",value:""+o}),l.unshift({name:"PageName",value:e.getName()}),l.unshift({name:"PageId",value:f}),Object(u.c)(g)&&l.unshift({name:"CurrentPageId",value:Object(u.c)(g)}),r.dispatch(Object(i.d)(m,f,n.targetBrowsingContext));return r.dispatch(Object(s.c)(e,a,o,p,n.source)).then(e=>(d.EventManager.ReportComponentSuccess("Navigation.Page",l),e),e=>(e=O(e),d.EventManager.ReportComponentFailure("Navigation.Page",e,"Check error details to know why navigation failed.",l),r.dispatch(Object(i.e)(e,n.targetBrowsingContext)),Promise.resolve({status:1,error:e})))},e=>{const a=[{name:"Url",value:Object(h.a)(t.pageName)},{name:"Options",value:w(n)}];return d.EventManager.ReportComponentFailure("Navigation.Page",e,"Check error details to know why navigation failed.",a),C(e,r,n.targetBrowsingContext)}).then(e=>(r.dispatch(Object(a.a)()),e))},e=>{if(e&&2415919106===e.errorCode){const r=[{name:"PageName",value:t.pageName},{name:"Options",value:w(n)}];Object(g.b)(e,r),d.EventManager.ReportComponentSuccess("Navigation.Page.Cancel",r)}throw e}).catch(e=>Promise.resolve({status:1,error:e}))}r.dispatch(Object(a.b)());return e.navigateTo(t,n,r,p).then(([e,a,i,s,p,g])=>{const f=r.getState(),b=e.getId();p.unshift({name:"Options",value:w(n)}),p.unshift({name:"Url",value:Object(h.a)(t.pageName)}),p.unshift({name:"IsDialog",value:""+i}),p.unshift({name:"PageName",value:e.getName()}),p.unshift({name:"PageId",value:b}),Object(u.c)(f)&&p.unshift({name:"CurrentPageId",value:Object(u.c)(f)});const _=Object(m.a)(f,n.targetBrowsingContext);r.dispatch(Object(l.b)(_.dialogContextIds,n.targetBrowsingContext));return r.dispatch(Object(c.b)(e,a,i,s,g)).then(e=>(d.EventManager.ReportComponentSuccess("Navigation.Page",p),Promise.resolve({status:0,pageId:e})),t=>(t=O(t),d.EventManager.ReportComponentFailure("Navigation.Page",t,"Check error details to know why navigation failed.",p),r.dispatch(Object(o.e)(e.getId(),"dismiss")),Promise.resolve({status:1,error:t})))},e=>{const a=[{name:"Url",value:Object(h.a)(t.pageName)},{name:"Options",value:w(n)}];return d.EventManager.ReportComponentFailure("Navigation.Page",e,"Check error details to know why navigation failed.",a),C(e,r,n.targetBrowsingContext)}).then(e=>(r.dispatch(Object(a.a)()),e))}(e,t,n,r,d,p);const _=[{name:"PageName",value:t.pageName},{name:"Options",value:w(n)}];d.EventManager.ReportComponentSuccess("Navigation.Page.Cancel",_);const S=Object(g.d)(f.l,2415919106,_);return Promise.resolve({status:1,error:S})})}(_,e,t,n,r,b)}).catch(e=>C(e,n,t.targetBrowsingContext))}(S,I,b,_,n))}}}function O(e){return e||Object(g.d)("Navigate Error",2415919107)}function C(e,t,n){return e=O(e),t.dispatch(Object(i.e)(e,n)),Promise.resolve({status:1,error:e})}function E(e,t,n){return{type:f.k,execute({dispatch:a,getState:i},o){var s,c,l,u,d,p,h;const f=Object(_.c)(i(),b.Lc)||Object(_.c)(i(),b.Gc);if(f&&(!t.newWindowOptions||!(null===(s=t.newWindowOptions)||void 0===s?void 0:s.height)&&!(null===(c=t.newWindowOptions)||void 0===c?void 0:c.width)&&!(null===(l=t.newWindowOptions)||void 0===l?void 0:l.toolbar)))return Promise.resolve(I(o,e,t));n||(n="_blank");const m=new r.a(o.Router.createUrlForPage(e,t,void 0,!0));if(m.searchParams.set("newWindow","true"),Object(y.a)(i())===v.a.MobileApplication)return o.Router.navigateToNewWindow(m.toString());const S=f||(null===(u=t.newWindowOptions)||void 0===u?void 0:u.toolbar)?null===(d=t.newWindowOptions)||void 0===d?void 0:d.toolbar:t.cmdbar,O=window.open(m.toString(),n,"width="+(null===(p=t.newWindowOptions)||void 0===p?void 0:p.width)+",height="+(null===(h=t.newWindowOptions)||void 0===h?void 0:h.height)+",toolbar="+S+",resizable=1");if(null==O){const e=Object(g.d)("The window could not be opened.",2147873356);return Promise.resolve({status:1,error:e})}return Promise.resolve({status:0,pageId:void 0,windowProxy:O})}}}function I(e,t,n){const a=new r.a(e.Router.createUrlForPage(t,n,void 0,!0));a.searchParams.set("newWindow","true");const i=window.open(a.toString());if(null==i){return{status:1,error:Object(g.d)("The window could not be opened.",2147873356)}}return{status:0,pageId:void 0,windowProxy:i}}function w(e){return[{name:"source",value:e.source},{name:"sourceBrowsingContext",value:e.sourceBrowsingContext},{name:"targetBrowsingContext",value:e.targetBrowsingContext},{name:"replaceState",value:e.replaceState}]}},rwix:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("4fxQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function a(e){return r.createPortal(e.children,document.getElementById("PortalRoot"))}a.displayName="PortalToBody"},rzss:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let r=null;async function a(){return r||(r=await Promise.all([n.e(1),n.e(3),n.e(22),n.e(24)]).then(n.bind(null,"TwA0"))),r}},"s/8p":function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"f",(function(){return a})),n.d(t,"h",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"j",(function(){return l})),n.d(t,"i",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return p}));
/**
 * OfflineSqlConstants for the data api.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="/*QuickFindStart*/",a="/*QuickFindEnd*/",i="/*SelectStart*/",o="/*FromEnd*/",s="/*CTEStart*/",c="/*CTEEnd*/",l="/*WhereStart*/",u="/*WhereEnd*/",d="/*OrderByStart*/",p="/*OrderByEnd*/"},s5g6:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.saveAutomationState=t.setShouldCollectMemory=t.checkForContinuingPerformanceAutomation=t.continuePerformanceAutomation=t.subscribeToAutomationEvents=t.cancelPerformanceAutomation=t.runPerformanceAutomation=void 0;var s,c,l=n("0her"),u=n("GHWt"),d=n("W/Jk"),p=o(n("zmaG")),g=n("m1E4"),h=n("STW0"),f=n("xKzl"),m=n("9+gz"),b=n("G0by"),_=n("z4z4"),y=n("rdtZ"),v=[],S=null,O=null,C=!1;function E(e){s=e}function I(e,t,n,r,i){r.addMetadataToTimeline({automationScenario:t.displayName}),p.default.addCommonKpiParameters({Automation:"true"});var o={keyPerformanceIndicators:[],issues:null},l=null;return r.processNextWorkBlock((function(){i(),e<=1&&t.validation&&!t.validation()&&r.logPerformanceIssue({type:h.PerformanceIssueType.ErrorDuringAutomation,level:h.PerformanceIssueLevel.Error,message:"Scenario failed validation",parameters:[t.displayName,e.toString()]})}),(function(a){if(l=a.timeline,n&&(e>0||t.isBoot)){var i=a.workBlockEndTime-a.workBlockStartTime,o=n.expectedNetworkRequests,s=n.expectedKeyPerformanceIndicators,u=n.minimumWorkTime,d=n.maximumWorkTime,p=b.getNetworkRequestsForVerification(a.timeline.getNetworkRequests()),f=p.map((function(e){return e.parameters[y.RESOURCE_NAME]}));if(function(e,t,n){if(null!=t){var r=e.slice();if(t.restrictions){var a=function(e){var a=t.restrictions[e],i=r.filter((function(t){return t.parameters[y.RESOURCE_NAME].indexOf(e)>=0})),o=i.length;if(g.logMessage("Request restriction: "+e+", Expected: "+JSON.stringify(a)+", Actual: "+o),o<a.min||o>a.max)n.logPerformanceIssue({type:h.PerformanceIssueType.NetworkRequestQuotaIssues,level:h.PerformanceIssueLevel.Warning,message:"Restricted requests not met",parameters:[e,JSON.stringify(a),o.toString()]});else if(o>a.min)for(var s=0;s<o-a.min;s++)r.splice(r.indexOf(i[s]),1)};for(var i in t.restrictions)a(i)}r.length!==t.total&&n.logPerformanceIssue({type:h.PerformanceIssueType.NetworkRequestQuotaIssues,level:h.PerformanceIssueLevel.Warning,message:"Scenario did not match expected count of network requests",parameters:["total",t.total.toString(),r.length.toString()]});var o=b.getNetworkRequestTypeFilter();if(t.types&&o){var s=function(e){var a=t.types[e],i=r.filter((function(t){return"cached"===e?"true"===t.parameters[y.CACHED_NAME]:e in o?o[e](t.parameters[y.RESOURCE_NAME]):void 0})).length;i!==a&&n.logPerformanceIssue({type:h.PerformanceIssueType.NetworkRequestQuotaIssues,level:h.PerformanceIssueLevel.Warning,message:"Scenario did not match expected count of network requests",parameters:[e,a.toString(),i.toString()]})};for(var c in t.types)s(c)}}}(p,o,r),!t.isBoot)if(1===e)c=f;else{var m=[],_=c.slice();f.forEach((function(e){var t=_.indexOf(e);t<0?m.push(e):delete _[t]}));var v=_.filter((function(e){return void 0!==e})),S=[];m.length>0&&S.push("(+) "+m.join(", ")),v.length>0&&S.push("(-) "+v.join(", ")),S.length>0&&(S.unshift(t.displayName),r.logPerformanceIssue({type:h.PerformanceIssueType.NetworkRequestQuotaIssues,level:h.PerformanceIssueLevel.Warning,message:"Scenario has inconsistent network requests",parameters:S}))}if(null!=u&&i<u&&r.logPerformanceIssue({type:h.PerformanceIssueType.WorkTimeOutOfBounds,level:h.PerformanceIssueLevel.Warning,message:"Work time is below minimum",parameters:[u.toString(),i.toString()]}),null!=d&&i>d&&r.logPerformanceIssue({type:h.PerformanceIssueType.WorkTimeOutOfBounds,level:h.PerformanceIssueLevel.Warning,message:"Work time exceeded maximum",parameters:[d.toString(),i.toString()]}),null!=s){var O=a.timeline.getKeyPerformanceIndicators().map((function(e){return e.name}));JSON.stringify(s.sort())!==JSON.stringify(O.sort())&&r.logPerformanceIssue({type:h.PerformanceIssueType.MismatchedKeyPerformanceIndicators,level:h.PerformanceIssueLevel.Error,message:"Mismatched key performance indicator(s)",parameters:O})}}}),(function(e){o.issues=e.issues.concat(e.issuesFromTimelineProcessing);var t=e.timeline.getKeyPerformanceIndicators();0===t.filter((function(t){return t.value===e.workBlockEndTime-e.workBlockStartTime})).length&&t.push({name:"WorkComplete",value:e.workBlockEndTime-e.workBlockStartTime}),o.keyPerformanceIndicators=t})).then((function(e){var t;if(e.forEach(r.logPerformanceIssue),(t=o.issues).push.apply(t,a(e)),s)return _.collectMemory().then((function(e){e>=0&&(o.memory=e)}))})).then((function(){if(o.issues.length>0&&o.issues.some((function(e){return e.level===h.PerformanceIssueLevel.Error})))throw new Error("Critical issues found during scenario");var n={timeline:d.timelineToSerializable(l),keyPerformanceIndicators:o.keyPerformanceIndicators,issues:o.issues};return o.memory>=0&&(n.memory=o.memory),f.uploadIterationResult(t.displayName,e,n)})).then((function(){return o}))}function w(e,t,n,r,a){if(void 0===a&&(a=null),g.logMessage("Running scenario: "+t.displayName),t.action.isComposite)return Promise.reject("Scenario "+t.displayName+" is invalid: main action is composite");var i=a;i||(i={scenarioConfig:e,iterationResults:[],setupExecuted:!1},S.scenarios.push(i));var o,s=t.setupAction,c=t.cleanupAction,u=!i.setupExecuted&&null!=s;return i.setupExecuted=!0,u?(g.logMessage("Running setup step for "+t.displayName),o=l.runAction(s,!0,n)):o=n.waitForIdle(),o.then((function(){for(var a=Promise.resolve(),o=function(o){a=a.then((function(){return n.executeIdleTasks()})).then((function(){return function(e,t,n,r,a){return g.logMessage("Running scenario "+t.displayName+" iteration "+e),l.runAction(t.action,!1,r).then((function(){return I(e,t,n,r,a)}))}(o,t,e.verification,n,r)})).then((function(r){return i.iterationResults.push(r),C?Promise.reject("Automation cancelled"):t.postIterationAction&&o<e.iterations-1?(g.logMessage("Running post-iteration step for scenario "+t.displayName+" iteration "+o),l.runAction(t.postIterationAction,!0,n)):void 0}))},s=i.iterationResults.length;s<e.iterations;s++)o(s);return a})).then((function(){if(c)return g.logMessage("Running cleanup step for "+t.displayName),l.runAction(c,!0,n)})).then((function(){return i}))}function j(e,t,n,r,a){return void 0===r&&(r=null),void 0===a&&(a=null),void 0!==e.collectMemory&&E(e.collectMemory),O=e,v.forEach((function(e){return e(!0)})),n.waitForIdle().then((function(){if(!r)return f.startCollectionSession();f.setSessionId(r)})).then((function(){return function(e,t,n,r){return void 0===r&&(r=null),S=r||{scenarios:[]},e.scenarioConfigs.reduce((function(e,r,a){var i=t.getScenario(r.scenarioName),o=S.scenarios.length>a&&S.scenarios[a];return o&&(r.iterations===o.iterationResults.length||o.failed)?e:i?e.then((function(){return w(r,i,n,t.validate,o)})).catch((function(e){if(C)throw e;S.scenarios[S.scenarios.length-1].failed=!0,n.logPerformanceIssue({type:h.PerformanceIssueType.ErrorDuringAutomation,level:h.PerformanceIssueLevel.Error,message:"Scenario failed. Skipping to next scenario.",parameters:[i.displayName,e.message]})})):e.then((function(){n.logPerformanceIssue({type:h.PerformanceIssueType.ErrorDuringAutomation,level:h.PerformanceIssueLevel.Error,message:"Scenario not found. Skipping to next scenario.",parameters:[r.scenarioName]}),S.scenarios.push({scenarioConfig:r,iterationResults:[],setupExecuted:!1,failed:!0})}))}),Promise.resolve()).then((function(){return S}),(function(e){return C=!1,S.error=e,n.logPerformanceIssue({type:h.PerformanceIssueType.ErrorDuringAutomation,level:h.PerformanceIssueLevel.Error,message:"Error during automation",parameters:[e]}),S}))}(e,t,n,a)})).then((function(e){return window.UCIPerformanceRunResult=JSON.stringify(e),f.uploadResultSummary(e).then((function(){return e}))})).then((function(e){return m.clearAutomationState(),v.forEach((function(t){return t(!1,e)})),e}),(function(e){return m.clearAutomationState(),v.forEach((function(e){return e(!1,null)})),n.logPerformanceIssue({type:h.PerformanceIssueType.ErrorDuringAutomation,level:h.PerformanceIssueLevel.Error,message:"Automation result upload failed. Please check that the data collector is running and is reachable.",parameters:[e]}),S}))}function P(e,t,n){var r,i=e.config,o=e.results,s=e.log,c=e.collectorUrl,l=e.collectorSessionId;try{var d=i.scenarioConfigs[o.scenarios.length-1],p=o.scenarios[o.scenarios.length-1],m=p.iterationResults.length;if(e)return c&&u.setUCIPerformanceDataCollectionURL(c),l&&f.setSessionId(l),(r=g.getLog()).push.apply(r,a(s)),t.getScenario(d.scenarioName).isBoot?I(m,t.getScenario(d.scenarioName),d.verification,n,t.validate).then((function(e){return p.iterationResults.push(e),j(i,t,n,l,o)}),(function(e){return p.failed=!0,n.logPerformanceIssue({type:h.PerformanceIssueType.ErrorDuringAutomation,level:h.PerformanceIssueLevel.Error,message:"Scenario failed. Skipping to next scenario.",parameters:[d.scenarioName,e.message]}),j(i,t,n,l,o)})):j(i,t,n,l,o)}catch(e){return o.error=e,n.logPerformanceIssue({type:h.PerformanceIssueType.ErrorDuringAutomation,level:h.PerformanceIssueLevel.Error,message:"Error during automation",parameters:[e]}),Promise.resolve(o)}}function T(e){v.push(e)}t.setShouldCollectMemory=E,t.saveAutomationState=function(){m.saveAutomationState({config:O,results:S,log:g.getLog(),collectorUrl:u.getUCIPerformanceDataCollectionURL(),collectorSessionId:f.getSessionId()})},t.runPerformanceAutomation=j,t.continuePerformanceAutomation=P,t.checkForContinuingPerformanceAutomation=function(e,t){var n=m.getAutomationState();if(n)return P(n,e,t);var r=u.getPerformanceAutomationConfig();return r&&r.autoStart&&j(r,e,t),Promise.resolve(null)},t.cancelPerformanceAutomation=function(){C=!0},t.subscribeToAutomationEvents=T,T((function(e,t){var n,r;if(window.PerformanceAutomationRunning=e,e&&g.logMessage("Automation run start"),t){g.logMessage("Full automation run results:");try{for(var a=i(t.scenarios),o=a.next();!o.done;o=a.next())for(var s=o.value,c=0;c<s.iterationResults.length;c++){var l=s.iterationResults[c],u=l.keyPerformanceIndicators.reduce((function(e,t){return e+", "+t.name+": "+t.value.toFixed()}),""),d=s.scenarioConfig.scenarioName+" "+c+u;l.memory>=0&&(d+=", Memory: "+l.memory+" bytes"),g.logMessage(d)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}t.error&&g.logMessage("Run terminated with error: "+t.error)}e||g.logMessage("Automation run end")}))},sHzf:function(e,t,n){"use strict";n.r(t),n.d(t,"REMOVE_TOAST_NOTIFICATION_ACTION",(function(){return r})),n.d(t,"removeToastNotification",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="remove.toastNotificationAction";function a(e){return{type:"remove.toastNotificationAction.async",execute({dispatch:t}){const n={type:r,payload:e};return Promise.resolve(t(n))}}}},sJUk:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("nA3O"),a=n("/Ypj"),i=n("XjOj"),o=n("Div0"),s=n("NMtn");class c extends r.a{constructor(){super(),this._callContext=null}get_hasBigArgs(){return!1}get_callContext(){return this._callContext||(this._callContext=new a.a(null,null)),this._callContext}set_callContext(e){return this._callContext=e,e}getValues(){const e={},t=this.getSchema();for(let n=0;n<t.get_count();n++){const r=t.get_item(n);r.get_propertyType().prototype&&r.get_propertyType().prototype.get_callbackID||this.putSinglePropertyIntoDictionary(e,r)}return e}getCallbacks(e){Object(s.b)(e,"bridge");const t={},n=this.getSchema();for(let r=0;r<n.get_count();r++){const a=n.get_item(r);if(a.get_propertyType().prototype&&a.get_propertyType().prototype.get_callbackID){Object(i.i)(o.a.PAL,"Registering callback object for callback, {0}",a.get_name());const n=this.getValue(a),r=e.registerNativeCallback(this,n);a.get_jsonConverter().write(t,a,r)}}return t}}},sNgR:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p}));var r=n("Uv1Y"),a=n("aRLb"),i=n("KXDI"),o=n("SRlt"),s=n("pEXn"),c=n("SAYH"),l=n("4r2D"),u=n("g22U");function d(e){const t=[];return{type:"executeOData.function.async",execute({dispatch:n,getState:i},u){const d=new l.a(c.a.newGuid().guid);return t.push({name:s.b.ClientRequestId,value:d&&d.RequestId?d.RequestId():null}),n(Object(a.c)(e)).then(()=>{const t=p(i(),e);return t.serializationFailure?Promise.reject(new r.a("Cannot serialize request: "+t.serializationFailure)):(o.c.AddRequestId(t,d&&d.RequestId?d.RequestId():c.a.newGuid().guid),u.DataSource.get_WebAPIService().sendRequest(t))})},getFailureParameters:(e,n)=>t}}function p(e,t){try{const n=Object(i.b)(e,t);let r=u.c.FUNCTION;const a=t.getMetadata().operationName||u.d;a===u.c.GCM&&(r=u.c.GCM);return{urlParameters:n,additionalHeaders:{Accept:o.a,Prefer:'odata.include-annotations="*"'},method:"GET",additionalParameters:{[u.a.TYPE]:r,[u.a.SUB_TYPE]:a}}}catch(e){return{serializationFailure:e.message}}}},sTJm:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return d}));var r,a=n("nuS9"),i=n("4fxQ"),o=n("YWpA"),s=n("QJW6"),c=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l="openedPopups",u={position:"absolute",top:0,left:0,width:"100%",height:"100%"},d=function(e){function t(t){var n=e.call(this,t)||this;return n._rootBodyElement=null,n._seeMorePopupCount=null,n._rootBodyElement=t.rootBodyElement||document.body,n}return c(t,e),t.prototype._getPopupId=function(){return(this.props.parentCustomControlId?this.props.parentCustomControlId+"|":"")+this.props.id+"_popupContainer"},t.prototype._initializeRootNode=function(){this._rootNode||(this._rootNode=document.createElement("section"),this._rootNode.id=this._getPopupId(),Object.assign(this._rootNode.style,{position:"absolute",top:"0",left:"0",width:"100%",height:"100%"}),this._rootNode.setAttribute(l,""),this._rootBodyElement.appendChild(this._rootNode))},t.prototype._getChildrenWithProps=function(e){var t=this;return e?e.map?e.map((function(e){return a.cloneElement(e,{rootPopupId:t._getPopupId(),rootBodyElement:t._rootBodyElement})})):a.cloneElement(e,{rootPopupId:this._getPopupId(),rootBodyElement:this._rootBodyElement}):null},t.prototype._renderToBody=function(){null===this._seeMorePopupCount&&(this._seeMorePopupCount=s.a.getInstance().getPopupCount());var e=this.props.customZIndex||1,t=this.props.customZIndex||this._seeMorePopupCount>0,n=this.props.style?this.props.style:u;this._style||(this._style=t?Object.assign({zIndex:e},n):n),this._initializeRootNode()},t.prototype.componentWillReceiveProps=function(e){e.style!==this.props.style&&(this._style=null)},t.prototype.componentDidMount=function(){this.props.openPopup&&this.props.openPopup(this._getPopupId())},t.prototype.componentWillUnmount=function(){document.getElementById(this._rootNode.id)&&this._rootBodyElement.removeChild(this._rootNode),this.props.closePopup&&this.props.closePopup(this._getPopupId()),this._rootNode=null},t.prototype.render=function(){return this._renderToBody(),this.props.children?i.createPortal(a.createElement(o.a,{style:this._style,tabIndex:this.props.tabIndex},this._getChildrenWithProps(this.props.children)),this._rootNode):null},t}(a.Component)},sX6v:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("iZ7K"),a=n("bT7G"),i=n("504W");const o="dataSnapshot.update";function s(e,t,n,s){if(!t||!n)throw new Error("Cannot update snapshot: invalid parameters specified");let c=null;if(!(c=Object(a.b)(e,t)))throw new Error("Cannot update snapshot: a snapshot with specified id does not exist");const l=[];s&&l.push({id:s});let u=null,d=null;(u=Object(r.h)(e,c.identifier.etn))&&(d=u.PrimaryNameAttribute)&&n.hasOwnProperty(d)&&(Object(i.a)(n[d])||l.push({name:n[d].value}));const p=l.length?Object.assign({},c.identifier,...l):null;return{type:o,payload:n,meta:{snapshotId:t,flavor:0,entityReference:p}}}},sYIp:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(){return Promise.all([n.e(1),n.e(4),n.e(5),n.e(26),n.e(98)]).then(n.bind(null,"u+sw"))}n.d(t,"a",(function(){return r}))},"sZ+8":function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"h",(function(){return l})),n.d(t,"j",(function(){return h})),n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return g})),n.d(t,"l",(function(){return u})),n.d(t,"b",(function(){return p})),n.d(t,"i",(function(){return f})),n.d(t,"k",(function(){return d})),n.d(t,"g",(function(){return m})),n.d(t,"d",(function(){return b})),n.d(t,"f",(function(){return _}));var r,a=n("GL3b"),i=n("504W"),o=n("37s6");!function(e){e[e.NotAvailable=0]="NotAvailable",e[e.Disabled=1]="Disabled",e[e.Enabled=2]="Enabled"}(r||(r={}));const s=["fax","letter","serviceappointment","campaignresponse","campaignactivity","recurringappointmentmaster","socialactivity"];function c(e){return!!(e&&e.offline&&e.offline.client&&e.offline.client.isCalculationOfDisabledEntitiesPending)&&e.offline.client.isCalculationOfDisabledEntitiesPending}function l(e){return e&&e.offline&&e.offline.client&&e.offline.client.offlineDisabledEntities?e.offline.client.offlineDisabledEntities:null}function u(e,t){return Object(o.w)(e)&&-1!==h(e).indexOf(t)}function d(e){return!e||-1===s.indexOf(e)}function p(e,t){if(t){const n=(new DOMParser).parseFromString(t,"text/xml"),r=n?n.getElementsByTagName("link-entity"):null;if(r&&r.length>0)for(let t=0;t<r.length;t++){const n=r[t];if(n&&n.attributes){const t=n.attributes.getNamedItem("name"),r=t?t.value:null;if(r&&!u(e,r))return{error:!0,relatedEntityUnavailableOffline:r}}}}return{error:!1}}function g(e,t){if(Object(o.w)(e)){if((Object(a.b)(e)||[]).indexOf(t)>=0){return(l(e)||[]).indexOf(t)<0?r.Enabled:r.Disabled}}return r.NotAvailable}function h(e){const t=Object(a.b)(e)||[],n=l(e)||[];return t.filter(e=>-1===n.indexOf(e))}function f(e){return e&&e.offline&&e.offline.client&&e.offline.client.offlineDisabledPrimaryEntities?e.offline.client.offlineDisabledPrimaryEntities:null}function m(e){return e&&e.offline&&e.offline.client&&e.offline.client.offlineAvailablePrimaryEntities?e.offline.client.offlineAvailablePrimaryEntities:null}function b(e,t){return e&&e.offline&&e.offline.client&&!Object(i.a)(e.offline.client.entityPluralName)&&!Object(i.a)(e.offline.client.entityPluralName[t])?e.offline.client.entityPluralName[t]:null}function _(e){return e&&e.offline&&e.offline.client&&!Object(i.a)(e.offline.client.entityPluralName)?e.offline.client.entityPluralName:null}},sclX:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r,a;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e[e.Active=1]="Active",e[e.Inactive=2]="Inactive"}(r||(r={})),function(e){e[e.Web=1]="Web",e[e.Native=2]="Native"}(a||(a={}))},sdkC:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("c7Og"),a=n("NMtn");class i{constructor(e){this._entityCollections=null,this._relatedEntityQueries=null,Object(a.d)(e,"entityCollections"),this._entityCollections=e,this._relatedEntityQueries=this._entityCollections.map(e=>e.get_value().get_query())}get_entityCollections(){return this._entityCollections}get_relatedEntityQueries(){return this._relatedEntityQueries}getObjectData(){const e={},t=[];for(const e of this._entityCollections){const n={};n.key=e.get_key().getObjectData(),n.value=e.get_value().getObjectData(),t.push(n)}return e.entitycollections=t,e}getByRelationship(e){for(const t of this._entityCollections)if(t.get_key().equals(e))return t.get_value();return null}addRelationship(e,t){for(let n=0;n<this._entityCollections.length;n++)if(this._entityCollections[n].get_key().equals(e))return void(this._entityCollections[n]=new r.a(e,t));this._entityCollections.push(new r.a(e,t))}}},si7p:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"g",(function(){return l}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="alert",a="confirm",i="errorDialog",o="routerDialog",s="sessionTimeout",c="authError",l="unhandledErrorDialog"},sjhR:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("iLty"),a=n("Jz2d"),i=n("dFCJ");class o extends r.a{constructor(e){if(super(e),this._attributeMetadata=null,e){e.addNamespace("c",a.a.xrm2011MetadataNamespace);const t=e.selectNodes(".//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value[@i:type='a:EntityMetadataCollection']/a:EntityMetadata/c:Attributes/c:AttributeMetadata");this.set_AttributeMetadata(Object(i.b)(t))}}get_AttributeMetadata(){return this._attributeMetadata}set_AttributeMetadata(e){return this._attributeMetadata=e,e}}},smSa:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l}));var r=n("504W"),a=n("SAYH"),i=n("RADj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e){return e&&e.metadata&&e.metadata.offlineSync?e.metadata.offlineSync:null}function s(e){return e&&e.metadata&&e.metadata.offlineSync&&!Object(r.a)(e.metadata.offlineSync.syncStatus)?e.metadata.offlineSync.syncStatus:i.a.Init}function c(e){return!(!(e&&e.metadata&&e.metadata.offlineSync)||Object(r.a)(e.metadata.offlineSync.metadataAvailable))&&e.metadata.offlineSync.metadataAvailable}function l(e,t){return e&&e.metadata&&e.metadata.offlineSync&&e.metadata.offlineSync.appModuleTimestamps&&e.metadata.offlineSync.appModuleTimestamps[a.a.toString(t)]||0}},sptG:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return c}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Form_ReadOnly_Notification_Message",a="Form_Notification_LongMessage_Truncate_Text",i="Form_Notification_LongMessage_Expand_Text",o="NOTIFICATIONS_COUNT_MESSAGE_BAR",s="RecordClosed.SyncError.Notification.Error.Text",c=["ProcessControl.Notification","ProcessControl.Configurator.Expand","ToastNotification_Error","ToastNotification_Warning","ToastNotification_Information",o,s,r,a,i]},"sw/s":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){return e&&e.metadata&&e.metadata.taskBasedFlows?e.metadata.taskBasedFlows[t]:null}function i(e,t){const n=a(e,t);return n?n.initialized:r.a.Uninitialized}},t6P7:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l}));var r=n("STW0"),a=n("TEuE"),i=n("SeXA"),o=n("bfoP");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let s;function c(e){s=e}function l(){if(!s)return Promise.resolve([]);const e=[],t=Object(o.a)();return s.dispatch(Object(i.b)()),Object(a.c)(),Promise.resolve().then(()=>{const n=t();return n.length>0&&e.push({type:r.PerformanceIssueType.UnmemoizedSelector,level:r.PerformanceIssueLevel.Warning,message:"Unmemoized component(s)",parameters:n}),e})}},tFCh:function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return d}));var r=n("zsAz"),a=n("1OTd"),i=n("+nTZ"),o=n("oT5e");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t,n,r){return{type:a.r,sync:!0,execute({dispatch:i,getState:o},s){i(function(e,t){return{type:a.s,payload:{pageId:t,dialogContextId:e}}}(e,t)),n.replaceState&&i(c(e,r,n.targetBrowsingContext))}}}function c(e,t,n){return{type:a.o,sync:!0,execute({dispatch:r,getState:o},s){r(function(e,t){return{type:a.p,payload:{dialogContextId:e,pageId:t}}}(e,t)),s.Router.removeDialogFromStack(t);const c=Object(i.a)(o(),e);c&&0===c.pageStack.length&&(r(u(e)),r(p(e,n)))}}}function l(e){return{type:a.e,sync:!0,execute({dispatch:t,getState:n},r){const a=Object(o.a)(n(),e);for(const n in a.dialogContextIds)t(u(n)),t(p(n,e))}}}function u(e){return{type:a.d,payload:{dialogContextId:e}}}function d(e,t,n){return{type:a.h,sync:!0,execute({dispatch:s,getState:c},l){if(Object(i.c)(c())[e])throw Object(r.d)("Dialog context id already been used",2415919107,[{name:"id",value:e}]);n||(n=Object(o.e)(c())),s(function(e,t){return{type:a.a,payload:{dialogContextId:e,browsingContextId:t}}}(e,n)),s(function(e,t,n){return{type:a.i,payload:{dialogContextId:t,pageId:n}}}(c(),e,t))}}}function p(e,t){return{type:a.n,payload:{dialogContextId:e,browsingContextId:t}}}},tGNJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="reinitialize.router.state";function a(e,t){return{type:r,payload:{pageState:e,routerState:t}}}},tHOi:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("Uv1Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return{type:"create.user.personalization",execute:({dispatch:t,getState:n},a)=>function(e,t){return e.createUserPersonalization(t).nativePromise().catch(r.b)}(a.DataSource,e).then(e=>e)}}function i(e){return{type:"retrieve.user.personalization",execute:({dispatch:t,getState:n},a)=>function(e,t){return e.retrieveUserPersonalization(t).nativePromise().catch(r.b)}(a.DataSource,e).then(e=>e,e=>null)}}},tHaS:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("HYaY"),a=n("nTyX");class i{constructor(e,t,n){this._entityLogicalName=null,this._attributeLogicalName=null,this._innerValue=null,this._entityLogicalName=e,this._attributeLogicalName=t,this._attributeType=n,this._innerValue=null}get_entityLogicalName(){return this._entityLogicalName}get_attributeLogicalName(){return this._attributeLogicalName}get_attributeType(){return this._attributeType}get_value(){return this._innerValue}set_value(e){return this._innerValue=e,e}getObjectData(){return{entityLogicalName:this._entityLogicalName,attributeLogicalName:this._attributeLogicalName,attributeType:Object(a.e)(this._attributeType),value:r.a.InternalGetFieldObjectData(this._innerValue,this._attributeType)}}static createFromObjectData({attributeLogicalName:e,entityLogicalName:t,attributeType:n,value:o}){const s=Object(a.c)(n),c=new i(t,e,s);return c.set_value(r.a.InternalCreateFieldFromObjectData(o,s)),c}}i.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.AliasedValue"},tHtE:function(e,t,n){"use strict";n.d(t,"e",(function(){return y})),n.d(t,"c",(function(){return h})),n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return m})),n.d(t,"d",(function(){return v}));var r=n("x0oY"),a=n("vNXc"),i=n("LbMF"),o=n("iZ7K"),s=n("WF3G"),c=n("wMH2"),l=n("jxo7"),u=n("504W"),d=n("eruq"),p=n("XvL5"),g=n("2F73");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function h(e,t){return{type:"DESERIALIZE_FETCHXML_WEB_RESPONSE_ASYNC",execute:({dispatch:n,getState:r},i)=>e.json().then(e=>{const r=a.a.fromXml(t.get_query()).getKeyQuery();if(e&&e.value&&0===e.value.length){const t=_(e,r,[]);return new l.a(t)}return(t=>n(m(r,t,e)).then(e=>new l.a(e)))(y(r))})}}function f(e,t,n,a,c,l,u,d=r.b.OData,p,g){const h=t instanceof s.a?t.get_EntityLogicalName():t.entityLogicalName,f=Object(o.h)(e,h),m=Object(i.d)(e,h),y=t instanceof s.a?t.GetColumnNamesFromFetch():t.columnNames,v=t instanceof s.a?t.get_ColumnSet():S(t);return _(a,t,b(a,d).map(t=>Object(r.d)(e,t,f,m,y,v,null,n,u,d)),c,l,p,g)}function m(e,t,n,a,i,o,c=r.b.OData,l,u){return{type:"DESERIALIZE_ENTITY_COLLECTION_ASYNC",execute({dispatch:d,getState:p},g){const h=e instanceof s.a?e.get_EntityLogicalName():e.entityLogicalName,f=e instanceof s.a?e.GetColumnNamesFromFetch():e.columnNames,m=e instanceof s.a?e.get_ColumnSet():S(e),y=b(n,c).map(e=>d(Object(r.e)(e,h,f,m,null,t,o,c)));return Promise.all(y).then(t=>_(n,e,t,a,i,l,u))}}}function b(e,t){let n=null;if(t===r.b.SQL&&e.rows&&e.rows.length){n=[];for(let t=0;t<e.rows.length;t++)n.push(e.rows.item(t))}else n=t===r.b.OData&&e&&e.value&&e.value.length?e.value:[];return n}function _(e,t,n,r,a,i,o){if(Object(u.a)(o)&&(o=e["@Microsoft.Dynamics.CRM.totalrecordcountlimitexceeded"]||!1),o?r=-1:Object(u.a)(r)&&(r=e["@Microsoft.Dynamics.CRM.totalrecordcount"]||n.length),Object(u.a)(i)&&(i=e["@Microsoft.Dynamics.CRM.morerecords"]),!a){const t=e["@Microsoft.Dynamics.CRM.fetchxmlpagingcookie"];if(t){const e=Object(d.b)(t);(a=null==e?void 0:e.documentElement.getAttribute("pagingcookie"))&&(a=decodeURIComponent(decodeURIComponent(a)))}}return new c.a(n,i,r,o,t,null,a)}function y(e){return v(e.get_FetchXml())}function v(e){const t={},n={},r=(new DOMParser).parseFromString(e,"text/xml"),a=r.getElementsByTagName("link-entity");for(let e=0;e<a.length;++e){const r=a[e],i=r.getAttribute("alias"),o=r.getAttribute("name"),s=r.getElementsByTagName("attribute");if(s.length)for(let e=0;e<s.length;++e){const r=s.item(e).getAttribute("name"),a=".",c="_x002e_",l=`${i}${a}${r}`,u=`${i}${c}${r}`;t[l]={alias:i,aliasedValueEtn:o,aliasedValueFieldName:r,oDataAlias:[l,u],oDataSeparator:[a,c]},t[u]={alias:i,aliasedValueEtn:o,aliasedValueFieldName:r,oDataAlias:[u,l],oDataSeparator:[c,a]},n.hasOwnProperty(o)?n[o].push(r):n[o]=[r]}}const i=r.querySelectorAll("entity > attribute[alias]"),o=r.getElementsByTagName("entity"),s=o&&o[0]?o[0].getAttribute("name"):"";for(let e=0;e<i.length;++e){const n=i[e],r=n.getAttribute("alias"),a=n.getAttribute("name"),o=n.getAttribute("rowaggregate"),c=!0;t[""+a]={alias:r,aliasedValueEtn:s,aliasedValueFieldName:a,oDataAlias:[""+r],oDataSeparator:[""],isAttributeAlias:c,rowaggregate:o}}return{aliasedValueDescriptors:t,entity2AttributesMap:n}}function S(e){return e.isAllColumns?g.a.get_instance():new p.a(e.columnNames)}},tICD:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));function r(e){return{type:"router.retrieve_page_output.async",execute:({dispatch:t},n)=>n.Router.getPageOutputPromise(e)}}},"tJ+6":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s}));var r=n("Lyxw"),a=n("3/02");function i(e){return e?e.designLanguage:null}function o(e){return Object(r.a)(e,a.N,a.Lc,a.Td)}function s(e){return Object(r.c)(e,a.M)}},tMKU:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r,a=n("p4DY"),i=n("VcAV"),o=function(){function e(){this._subscribers=[],this.fireEvent=this.fireEvent.bind(this)}return Object.defineProperty(e,"pointerDownEvent",{get:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream?"touchstart":"pointerdown"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"scrollEvent",{get:function(){return"scroll"},enumerable:!1,configurable:!0}),e.getInstance=function(){return r||(r=new e),r},Object.defineProperty(e.prototype,"subscribers",{get:function(){return this._subscribers},enumerable:!1,configurable:!0}),e.prototype.addSubscribers=function(t){var n=this;setTimeout((function(){(Object(i.c)(n.subscribers)||n.subscribers.length<=0)&&(document.addEventListener(e.pointerDownEvent,n.fireEvent),t.onScroll&&document.addEventListener(e.scrollEvent,n.fireEvent,!0)),n._subscribers.push(t)}),100)},e.prototype.removeSubscribers=function(t){this._subscribers=this._subscribers.filter((function(e){return e!==t})),(Object(i.c)(this.subscribers)||this.subscribers.length<=0)&&(document.removeEventListener(e.pointerDownEvent,this.fireEvent),document.removeEventListener(e.scrollEvent,this.fireEvent))},e.prototype.fireEvent=function(t){if(this.subscribers)for(var n=this._subscribers.length-1;n>=0;n--){var r=this.subscribers[n];if(r&&r.getComponent()&&(r.onPointerDown||r.onScroll)&&r.getComponent().offsetHeight>0){var i=r.isClickInsideSubscriber&&r.isClickInsideSubscriber(t);if(r.onPointerDown&&t.type===e.pointerDownEvent&&r.onPointerDown.bind(r,t)(),r.onScroll&&t.type===e.scrollEvent&&r.onScroll.bind(r,t)(),i)break}if(r&&r.type===a.a.Popup)break}},e}()},tOh6:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("oT5e");function a(e,t){return{type:"create.popup.async",execute({dispatch:n,getState:a},i){const o=i.Router,s=Object(r.d)(a());return o.addPopup(e,s.id,t),Promise.resolve()}}}},tT9w:function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return h}));var r=n("pgSX"),a=n("si7p"),i=n("Uv1Y"),o=n("ngeo"),s=n("YxC/"),c=n("EY5k"),l=n("tICD"),u=n("8MGk"),d=n("E8F2"),p=n("zsAz"),g=n("RiLc");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const h="0x80050110",f={type:"error"};function m(e,t=!1,n){const m=[],y=e.errorRegion;return{type:"form.server.error.dialog",execute(v,S,O){e=new i.a(e.message,e.errorCode,e.exception,e.innerError,e.errorSource,e.errorFault,e.details,null,null,null,null,null,null,null,null,null,null,null,e.errorAnnotations);const C="0x"+o.a.getHexErrorCodeFromInt(e.errorCode),E="Error_Title_"+C,I="Error_Message_"+C,w=[E,I,"SolutionWizard.Button.Export.Tooltip","Button_Label_OK","Web.Dialog.ErrorCode_Caption","Error_Title_0x8004b056","Error_Title_0x80700000","L_Show_Details_Text","L_Client_Session_Id","L_Server_Activity_Id","L_Current_Time","Error_Title_Generic","Error_Message_Incorrect_Error_Code","L_Help_Label_Text"],j=["Error_Title_Generic","Error_Message_Incorrect_Error_Code"],P=S.TraceManager.getTracer("Forms.ServerErrorDialog");return v.dispatch(Object(c.e)(w)).then(()=>{const i=Object(s.e)(v.getState(),w);let c=Object(s.c)(i,E);const d=Object(s.c)(i,"Error_Title_Generic");c=c||d;const O=Object(s.c)(i,I),j=Object(s.c)(i,"Error_Message_Incorrect_Error_Code"),T=function(e,t,n,r,a,i){let o;const s=Object(p.h)(n||r,t);"0x80040265"===e?t.innerError&&t.innerError.message?o=""+t.innerError.message:t.message&&(o=""+t.message):"0x80043e08"===e&&t.message||"0x8003f454"===e&&t.message?o=t.message:"0x80044331"===e?o=(n||r).replace("{0}",2020..toString()):e===h?o=n||r:t.message&&a?o=""+t.message:s&&!s.includes("{0}")?o=s:t.message&&(s&&s.includes("{0}")||!n)?(o=""+t.message,i.info("Failed to localized server error as the message contains params, for error code: "+t.errorCode+" errorMessage: "+t.message)):o=n;return o}(C,e,O,j,t||!1,P),N=Object(s.c)(i,"SolutionWizard.Button.Export.Tooltip"),A=Object(s.c)(i,"Button_Label_OK"),D=Object(s.c)(i,"Web.Dialog.ErrorCode_Caption"),R=Object(s.c)(i,"L_Show_Details_Text"),x=Object(s.c)(i,"L_Client_Session_Id"),M=Object(s.c)(i,"L_Current_Time"),F=Object(s.c)(i,"L_Server_Activity_Id"),k=Object(s.c)(i,"L_Help_Label_Text"),L=D+" "+C,B=x.replace("{0}",S.EventManager.getCurrentSessionId()),U=F.replace("{0}",S.EventManager.getActivityId()),V=M.replace("{0}",""+new Date),z=[L,B,U,V];m.push({name:"errorTitle",value:c},{name:"errorMessage",value:T},{name:"errorCodeContainer",value:L});const W={errorCode:o.a.getHexErrorCodeFromInt(e.errorCode),errorRegion:y,dynamicHelpLabel:k};return v.dispatch(Object(r.a)(a.d,L,f,N,c,T,A,R,z,!e.errorFault&&!e.details,n,W)).then(t=>0===t.status?v.dispatch(Object(l.a)(t.pageId)).then(t=>{if(t.value.confirmed){const t=function(e,t,n,r){const a=n.TraceManager.getTracer("Forms.ServerErrorDialog.DownloadLog");let i="";if(e){e.message&&e.errorCode&&e.getNegativeErrorCode?(i+="Exception Message: "+e.message,i+="\n\nErrorCode: "+e.getNegativeErrorCode(),i+="\nHexErrorCode: 0x"+o.a.getHexErrorCodeFromInt(e.errorCode)):a.warn("Unable to get error.message or error.errorCode",r);const t=Object(p.e)(e);if(e.details)e.errorFault?i+="\nCall Stack: "+e.errorFault.get_innerFault().get_callStack():i+="\nError Details: "+e.details;else if(t){const e={},n=new Map([[g.a,e]]);for(const[e,r]of Object.entries(t))_(e,r,n);for(const[t,n]of Object.entries(e))"InnerError"!==t&&(i+="\n\n"+t+": ",i+="TraceText"===t?"\n\t"+n.replace(/\n/g,"\n\t").trim():"object"==typeof n?b(n,"",0):n)}else a.warn("No annotations were retrieved",r)}else a.warn("The error object is null or undefined",r);t&&(i+="\n\n"+t.join("\n"));return n.EventManager.ReportComponentSuccess("Forms.ServerErrorDialog.DownloadLog",r),i}(e,[U],S,m),n={mimeType:"text/plain",fileName:"ErrorDetails.txt",fileContent:btoa(unescape(encodeURIComponent(t))),fileSize:t?t.length:0},r={openMode:2};new u.a(S,v).openFile(n,r)}}):Promise.reject(t.error))},e=>{if(!Object(d.e)(e)){const t=JSON.stringify(e);m.push({name:"originalError",value:t})}v.dispatch(Object(c.e)(j)).then(()=>{const e=Object(s.e)(v.getState(),j),t=Object(s.c)(e,"Error_Title_Generic"),i=Object(s.c)(e,"Error_Message_Incorrect_Error_Code");m.push({name:"titleLabel",value:t},{name:"messageLabel",value:i}),v.dispatch(Object(r.a)(a.d,"",f,"",t,i,void 0,void 0,void 0,void 0,n)).then(e=>e)})})},getFailureParameters:(e,t)=>m}}function b(e,t,n){n++;for(const[r,a]of Object.entries(e))"object"==typeof a?t=b(a,t+"\n"+"\t".repeat(n)+r+": ",n):t+="\n"+"\t".repeat(n)+r+": "+a;return t}function _(e,t,n){const r=e.lastIndexOf("."),a=e.substring(0,r),i=e.substring(r+1);if(n.has(a))n.get(a)[i]=t;else{const e={[i]:t};n.set(a,e),_(a,e,n)}}},tWr6:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n("pEXn"),a=n("arV0"),i=n("SAYH"),o=n("zmL5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t,n){var a;try{const i=Object.assign({},n);if(e===r.B.Name){const e=null===(a=t[r.B.CommonError.Message])||void 0===a?void 0:a.toString();(null==e?void 0:e.indexOf(`${r.k}${r.m}`))>=0?i[r.m]&&(i[r.m]=function(e){const t=e&&JSON.parse(e);let n=!1;return null==t||t.forEach(e=>{var t;(null===(t=e.event)||void 0===t?void 0:t.errorMessage)&&(n=!0,e.event=Object.assign(Object.assign({},e.event),{errorMessage:"Error message is sanitized as it could be thrown from custom scripts."}))}),n?JSON.stringify(t):e}(i[r.m])):e===`${r.k}${r.o}`&&i[r.o]&&(i[r.o]=function(e){const t=e&&JSON.parse(e),n=[];for(const e of t)if("callStack"===e.name){n.push(e);break}return JSON.stringify(n)}(i[r.o]))}return i}catch(e){return n}}function c(e,t){const n=Object(a.g)(e,t),r=Object(o.b)(e,t);return[{name:"entityTypeName",value:null==n?void 0:n.entityTypeName},{name:"formId",value:i.a.toString(r)}]}},tXbx:function(e,t,n){"use strict";e.exports=n("DO7/")},tZZc:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Success=1]="Success",e[e.Deleted=2]="Deleted",e[e.Error=3]="Error"}(r||(r={}))},tg1f:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return s}));var r={Primary01:"#0078D4",Primary02:"#006cbe",Primary03:"#005ba1",Primary04:"#004377",Primary05:"#a9d3f2",Primary06:"#5ca9e5",Error01:"#a4262c",Error02:"#fde7e9",Error03:"#d83b01",Error04:"#fed9cc",Neutral01:"#ffffff",Neutral02:"#Faf9f8",Neutral03:"#f3f2f1",Neutral04:"#edebe9",Neutral05:"#e1dfdd",Neutral06:"#d2d0ce",Neutral07:"#c8c6c4",Neutral08:"#bebbb8",Neutral09:"#b3b0ad",Neutral10:"#a19f9d",Neutral11:"#8a8886",Neutral12:"#605e5c",Neutral13:"#323130",Neutral14:"#201f1e",Data01:"#3e8ef7",Data02:"#132898",Data03:"#d77245",Data04:"#611676",Data05:"#cf52a4",Data06:"#6e53bb",DataEmpty:"#e6e6e6"};function a(e){e=Object.assign({},r,e);var t={};return t.Contrast=e.Neutral01,t.Text01=e.Neutral13,t.Text02=e.Neutral14,t.Background=t.Contrast,t.DisabledBackground=e.Neutral03,t.DisabledForeground=e.Neutral10,t.InputBorder=e.Neutral12,t.InputFocusBorder=e.Primary01,t.KeyboardFocusBorder=e.Neutral12,t.PivotColor=e.Primary01,{Palette:e,Patterns:t}}a({});function i(e){return{TextInput:{PrefixBackgroundColor:e.Palette.Neutral03,PrefixForegroundColor:e.Palette.Neutral12,SuffixBackgroundColor:e.Palette.Neutral03,SuffixForegroundColor:e.Palette.Neutral12,Disabled:{TextColor:e.Patterns.DisabledForeground,BackgroundColor:e.Patterns.DisabledBackground,BorderColor:e.Palette.Neutral03,LinkColor:e.Patterns.DisabledForeground},View:{TextColor:e.Patterns.Text01,BackgroundColor:e.Patterns.Background,BorderColor:e.Patterns.InputBorder,LinkColor:e.Patterns.Text01},Edit:{TextColor:e.Patterns.Text01,BackgroundColor:e.Patterns.Background,BorderColor:e.Patterns.InputBorder,LinkColor:e.Palette.Primary01,Valid:{Hover:{BorderColor:e.Palette.Neutral13},Focus:{BorderColor:e.Patterns.InputFocusBorder},Open:{BorderColor:e.Palette.Neutral09}},Invalid:{BorderColor:e.Palette.Error01,ErrortextColor:e.Palette.Error01}}},Link:{Enabled:{TextColor:e.Palette.Primary01,Hover:{TextColor:e.Palette.Primary04}},Disabled:{TextColor:e.Patterns.DisabledForeground}},ButtonPrimary:{BackgroundColor:e.Palette.Primary01,TextColor:e.Patterns.Contrast,Disabled:{BackgroundColor:e.Patterns.DisabledBackground,TextColor:e.Patterns.DisabledForeground},Enabled:{Hover:{BackgroundColor:e.Palette.Primary02,TextColor:e.Patterns.Contrast},Pressed:{BackgroundColor:e.Palette.Primary03,TextColor:e.Patterns.Text01}}},ButtonSecondary:{BackgroundColor:e.Patterns.Background,TextColor:e.Patterns.Text01,BorderColor:e.Palette.Neutral11,Disabled:{BackgroundColor:e.Patterns.DisabledBackground,TextColor:e.Patterns.DisabledForeground},Enabled:{Hover:{BackgroundColor:e.Palette.Neutral03,TextColor:e.Patterns.Text01},Pressed:{BackgroundColor:e.Palette.Neutral04,TextColor:e.Patterns.Text02}}},Label:{TextColor:e.Patterns.Text01,Disabled:{TextColor:e.Patterns.DisabledForeground}},Dropdown:{TextColor:e.Patterns.Text01,BorderColor:e.Patterns.InputBorder,Disabled:{TextColor:e.Patterns.DisabledForeground,BackgroundColor:e.Patterns.DisabledBackground,BorderColor:e.Palette.Neutral03},Enabled:{TextColor:e.Patterns.Text01,BackgroundColor:e.Patterns.Background,Valid:{Hover:{BorderColor:e.Palette.Neutral13},Focus:{BorderColor:e.Patterns.InputFocusBorder},Open:{BorderColor:e.Palette.Neutral09}},Invalid:{BorderColor:e.Palette.Error01}}},DropdownMenu:{BackgroundColor:e.Patterns.Background,Menuitem:{BackgroundColor:e.Patterns.Background,BorderColor:e.Patterns.Background,Disabled:{TextColor:e.Patterns.DisabledForeground},Enabled:{Hover:{TextColor:e.Patterns.Text02,BackgroundColor:e.Palette.Neutral03,BorderColor:e.Palette.Neutral03},Focus:{TextColor:e.Patterns.Text01,BackgroundColor:e.Patterns.Background,BorderColor:e.Patterns.KeyboardFocusBorder},Selected:{TextColor:e.Patterns.Text02,BackgroundColor:e.Palette.Neutral04,BorderColor:e.Palette.Neutral04}}}},Gauge:{TextColor:e.Patterns.Text01,BackgroundColor:e.Patterns.Background,FullArcColor:e.Palette.Primary01,EmptyArcColor:e.Palette.DataEmpty},CommandBar:{BackgroundColor:e.Patterns.Background,Command:{TextColor:e.Patterns.Text01,IconColor:e.Palette.Primary01,Hover:{BackgroundColor:e.Palette.Neutral03},Pressed:{BackgroundColor:e.Palette.Neutral04},Focus:{BorderColor:e.Patterns.KeyboardFocusBorder}}},Form:{PivotColor:e.Patterns.PivotColor,FooterCommand:{TextColor:e.Patterns.Text01,BackgroundColor:e.Palette.Neutral06,IconColor:e.Palette.Neutral13,DividerColor:e.Palette.Neutral08,Hover:{BackgroundColor:e.Palette.Neutral07},Press:{BackgroundColor:e.Palette.Neutral08},Focus:{BorderColor:e.Patterns.KeyboardFocusBorder}}},MessageBar:{Info:{TextColor:e.Patterns.Text01,BackgroundColor:e.Palette.Neutral03,IconColor:e.Palette.Neutral12},SevereWarning:{TextColor:e.Patterns.Text01,BackgroundColor:e.Palette.Error04,IconColor:e.Palette.Error03},Blocked:{TextColor:e.Patterns.Text01,BackgroundColor:e.Palette.Error02,IconColor:e.Palette.Error01},Locked:{TextColor:e.Patterns.Text01,BackgroundColor:e.Palette.Neutral05,IconColor:e.Palette.Neutral12}},Grid:{ColumnHeader:{TextColor:e.Patterns.Text01,BackgroundColor:e.Patterns.Background,CheckmarkIconColor:e.Palette.Neutral07,SortFilterIconColor:e.Palette.Neutral12,DividerColor:e.Palette.Neutral04,Focus:{BorderColor:e.Patterns.KeyboardFocusBorder}},Cell:{TextColor:e.Patterns.Text01,BackgroundColor:e.Patterns.Background,LinkColor:e.Palette.Primary01,Hover:{TextColor:e.Patterns.Text02,BackgroundColor:e.Palette.Neutral03},Selected:{TextColor:e.Patterns.Text02,BackgroundColor:e.Palette.Neutral04,CheckmarkIconColor:e.Palette.Neutral13},Focus:{BorderColor:e.Patterns.KeyboardFocusBorder}},Footer:{TextColor:e.Patterns.Text01,BackgroundColor:e.Patterns.Background,IconColor:e.Palette.Primary01,Focus:{BorderColor:e.Patterns.KeyboardFocusBorder},Disabled:{IconColor:e.Patterns.DisabledForeground}}},AppHeader:{TextColor:e.Patterns.Contrast,BackgroundColor:e.Palette.Primary01,IconColor:e.Palette.Neutral01,Hover:{BackgroundColor:e.Palette.Primary03},Pressed:{BackgroundColor:e.Patterns.Background,IconColor:e.Palette.Neutral13},Focus:{BorderColor:e.Patterns.Background}},Navigation:{Rest:{TextColor:"#323130",IconColor:"#605e5c",BackgroundColor:"#f3f2f1",DividerColor:"edebe9",Hover:{TextColor:"#201f1e",IconColor:"#605e5c",BackgroundColor:"#fffff"},Focus:{BorderColor:e.Patterns.KeyboardFocusBorder}},Selected:{TextColor:"#201f1e",IconColor:"#605e5c",BackgroundColor:"#ffffff",PivotColor:e.Patterns.PivotColor,Focus:{BorderColor:e.Patterns.KeyboardFocusBorder}}},Dashboard:{TextColor:e.Patterns.Text01,BackgroundColor:e.Palette.Neutral02,ViewSelector:{TextColor:e.Patterns.Text01,ChevronColor:e.Palette.Neutral13,ChevronBackgroundColor:e.Palette.Neutral02,Hover:{ChevronBackgroundColor:e.Palette.Neutral04},Pressed:{ChevronBackgroundColor:e.Palette.Neutral04},Open:{ChevronBackgroundColor:e.Palette.Neutral04}},Card:{TextColor:e.Patterns.Text01,BackgroundColor:e.Patterns.Background,DividerColor:e.Palette.Neutral04,ActionButton:{Rest:{TextColor:e.Patterns.Text01,IconColor:e.Palette.Primary01,BackgroundColor:e.Patterns.Background,BorderColor:e.Patterns.Background,Focus:{BorderColor:e.Patterns.KeyboardFocusBorder},Hover:{TextColor:e.Patterns.Text02,IconColor:e.Palette.Primary03,BackgroundColor:e.Palette.Neutral03}},Selected:{TextColor:e.Patterns.Text02,IconColor:e.Palette.Primary03,BackgroundColor:e.Palette.Neutral04,BorderColor:e.Palette.Neutral04,Focus:{BorderColor:e.Patterns.KeyboardFocusBorder},Hover:{BackgroundColor:e.Palette.Neutral05}},Disabled:{TextColor:e.Patterns.DisabledForeground,IconColor:e.Patterns.DisabledForeground,BackgroundColor:e.Patterns.Background}}}}}}function o(e,t){return{Colors:e=Object.assign({},a(r),e),Components:t=Object.assign({},i(e),t),DesignLanguageId:"Fluent",ThemeId:"default"}}var s=o({},{})},thZs:function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"d",(function(){return v})),n.d(t,"c",(function(){return S})),n.d(t,"b",(function(){return O}));var r=n("Uv1Y"),a=n("Znul");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i{constructor(e){this.LookupDataRequest=e}getMetadata(){return{boundParameter:null,operationName:"RetrieveLookupData",operationType:1,parameterTypes:{LookupDataRequest:{typeName:"Microsoft.Dynamics.CRM.LookupDataRequest",structuralProperty:2}}}}}var o=n("sNgR"),s=n("SRlt"),c=n("u2Wk"),l=n("eXjw"),u=n("SAYH");function d(e){if(!(e&&e.Metadata&&e.Metadata.Entity&&e.Metadata.View))return null;const t={Initialized:l.a.Partial,IsReadOnlyInMobileClient:e.Metadata.Entity.IsReadOnlyInMobileClient,IsEnabledInUnifiedInterface:e.Metadata.Entity.IsEnabledInUnifiedInterface,DisplayName:e.Metadata.Entity.DisplayName,PrimaryNameAttribute:e.Metadata.Entity.PrimaryNameAttribute,EntityLogicalName:e.Metadata.Entity.LogicalName,DisplayCollectionName:e.Metadata.Entity.DisplayCollectionName,IconVectorName:e.Metadata.Entity.IconVectorName,PrimaryKeyName:e.Metadata.Entity.PrimaryIdAttribute,PrimaryIdAttribute:e.Metadata.Entity.PrimaryIdAttribute},{viewColumns:n,attributesByName:r}=function(e){const t=[],n={};for(const r of e){const e={alias:r.Alias,format:r.Format,dataType:r.DataType,logicalName:r.AttributeLogicalName,entityLogicalName:r.EntityLogicalName};t.push(e);const a={Initialized:l.a.Partial,LogicalName:r.AttributeLogicalName,EntityLogicalName:r.EntityLogicalName,Type:r.DataType,Format:r.Format};n[a.LogicalName]=a}return{viewColumns:t,attributesByName:n}}(e.Metadata.View.Columns),a={viewId:p(e.Metadata.View.ViewId),viewName:e.Metadata.View.ViewName,columns:n,fetchXml:e.Metadata.View.FetchXml,layoutJson:e.Metadata.View.LayoutJson};t.AttributeNames=Object.keys(r);return{lookupMetadata:{initialized:l.a.Initialized,entity:t,view:a},entity:t,attributesByName:r}}function p(e){return"string"==typeof e?new u.a(e):e}var g=n("tHtE"),h=n("vNXc"),f=n("E3i9"),m=n("HfZT");function b(e,t){if(e.LookupEntityByName){const n=e.LookupEntityByName.find(e=>e.EntityLogicalName===t);if(n)return n.PagingInfo}return null}var _=n("KXDI");const y="retrieve.lookup";function v(e,t=!1){return{type:"retrieve.lookup.async",execute({dispatch:t,getState:n},a){const c=n(),l=e.ReturnMetadata&&S(c,e);return t(function(e){const t={router:null};e&&(t.metadata={lookup:{[e]:{}}});return{type:y,payload:t}}(l)),function(e,t,n){const a=new i(n);return t(Object(o.b)(a)).then(e=>Object(s.g)(e).then(e=>{if(e.Result)return e.Result;throw e})).catch(r.b)}(0,t,e).then(r=>{r&&e.ReturnMetadata&&t(function(e,t,n,r){const a=S(e(),n),i=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){const n={},r={},a={},i={};if(e&&e.length)for(const t of e){const{lookupMetadata:e,entity:a,attributesByName:o}=d(t);i[e.entity.EntityLogicalName]=e,n[e.entity.EntityLogicalName]=a,r[e.entity.EntityLogicalName]=o}return a[t]=i,{lookup:a,entities:n,attributes:r}}(r.EntityResponses,a);return{type:y,payload:i}}(n,0,e,r)),r&&t(function(e,t,n,r){let a=null;r&&r.EntityResponses&&(a=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,n,r){const a={},i={},o=S(e,r);if(n&&n.length)for(const s of n){const n=Object(f.c)(e,o,s.EntityLogicalName),c=n&&n.fetchXml,l=n&&n.viewId,u=O(e,s.EntityLogicalName,r),d=h.a.fromXml(c,l),p=b(r,s.EntityLogicalName);d.pageSize=p?p.Count:h.a.defaultPageSize,d.pageNumber=p?p.PageNumber:1;const _=Object(g.e)(d.getKeyQuery()),y=Object(g.a)(e,d.getKeyQuery(),_,{value:s.Data},s.TotalRecordCount,s.PagingCookie),v=Object(m.e)(e,t,u,d,y);if(v&&v.payload){if(v.payload.entities)for(const e in v.payload.entities)a[e]=v.payload.entities[e];if(v.payload.lists)for(const e in v.payload.lists)i[e]=v.payload.lists[e]}}return{entities:a,lists:i}}(e(),t,r.EntityResponses,n));return{type:m.b,payload:a}}(n,t,e,r))}).catch(e=>{Object(r.b)(e)})}}}function S(e,t){const n=new a.a([],t.EntityAndAttribute,t.AppId,null,null,t.ReturnMetadata);if(null!=t.LookupEntityByName)for(const e of t.LookupEntityByName){const t=new c.a(e.EntityLogicalName,e.ViewId,e.CustomFilter,e.RelationshipName,e.FetchXml,e.LayoutJson,null);n.LookupEntityByName.push(t)}return Object.keys(n).filter(e=>"ReturnMetadata"!==e).map(t=>Object(_.c)(e,n,t)).join(":")}function O(e,t,n){const r=S(e,n);return`${t}:${n.QueryString||""}:${r}`}},thzq:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Create=1]="Create",e[e.Delete=2]="Delete",e[e.Update=3]="Update",e[e.Retrieve=4]="Retrieve"}(r||(r={}))},ti3l:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.create=0]="create",e[e.update=1]="update",e[e.Delete=3]="Delete"}(r||(r={}))},tlcF:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("9L53"),a=n("jhff"),i=n("UqMU"),o=n("zsAz"),s=n("oT5e"),c=n("Fgw8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class l{constructor(e,t){this._store=e,this._tracer=t.getTracer("InternalHistoryManager")}HistoryBack(e){if(!e||!e.targetBrowsingContext)throw Object(o.d)("InternalHistoryManager tried to invoke historyback for invalid tab",2415919109);{if(this.GetHistoryLength(e)<=1)throw Object(o.d)("InternalHistoryManager: there are no more pages in history stack to go back to",2415919117);this._store.dispatch(Object(i.c)(e.targetBrowsingContext));const t=Object(s.a)(this._store.getState(),e.targetBrowsingContext).history,n=t[t.length-1],a=new r.a;a.state=n.state,this._onPop(a,e)}}ClearHistory(e){let t;e&&e.targetBrowsingContext?t=e.targetBrowsingContext:(t=Object(a.a)(this._store.getState()).id,this._tracer.warn("Navigation options is not provided to InternalHistoryManager ClearHistory method, clearing history of active tab")),this._store.dispatch(Object(i.b)(t))}PushState(e,t,n){if(!n||!n.targetBrowsingContext)throw Object(o.d)("InternalHistoryManager tried to push state to invalid tab",2415919109);this._store.dispatch(Object(i.a)(n.targetBrowsingContext,e,t))}ReplaceState(e,t,n){if(!n||!n.targetBrowsingContext)throw Object(o.d)("InternalHistoryManager tried to replace state of invalid tab",2415919109);this._store.dispatch(Object(i.e)(n.targetBrowsingContext,e,t))}RegisterOnPopState(e){this._onPop=e}RegisterOnBeforeUnload(e){this._onBeforeUnload=e,window.addEventListener("beforeunload",e)}Dispose(){window.removeEventListener("beforeunload",this._onBeforeUnload),this._onPop=void 0,this._onBeforeUnload=void 0}GetHistoryLength(e){return Object(c.a)(this._store.getState(),e,this._tracer).history.length}GetState(e){return this._getCurrentHistoryEntry(e=>e.state,e)}GetCurrentUrl(e){return this._getCurrentHistoryEntry(e=>e.url,e)}_getCurrentHistoryEntry(e,t){const n=Object(c.a)(this._store.getState(),t,this._tracer);if(n.history){const t=n.history[n.history.length-1];if(t)return e(t)}}}},"txA/":function(e,t,n){"use strict";n.d(t,"db",(function(){return a})),n.d(t,"k",(function(){return i})),n.d(t,"l",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"v",(function(){return c})),n.d(t,"x",(function(){return l})),n.d(t,"w",(function(){return u})),n.d(t,"fb",(function(){return d})),n.d(t,"eb",(function(){return p})),n.d(t,"mb",(function(){return g})),n.d(t,"ib",(function(){return h})),n.d(t,"kb",(function(){return f})),n.d(t,"nb",(function(){return m})),n.d(t,"jb",(function(){return b})),n.d(t,"lb",(function(){return _})),n.d(t,"hb",(function(){return y})),n.d(t,"gb",(function(){return v})),n.d(t,"e",(function(){return S})),n.d(t,"f",(function(){return O})),n.d(t,"t",(function(){return C})),n.d(t,"u",(function(){return E})),n.d(t,"s",(function(){return I})),n.d(t,"ab",(function(){return w})),n.d(t,"q",(function(){return j})),n.d(t,"Z",(function(){return P})),n.d(t,"n",(function(){return T})),n.d(t,"o",(function(){return N})),n.d(t,"p",(function(){return A})),n.d(t,"m",(function(){return D})),n.d(t,"g",(function(){return R})),n.d(t,"h",(function(){return x})),n.d(t,"qb",(function(){return M})),n.d(t,"rb",(function(){return F})),n.d(t,"ob",(function(){return k})),n.d(t,"pb",(function(){return L})),n.d(t,"r",(function(){return B})),n.d(t,"V",(function(){return U})),n.d(t,"i",(function(){return V})),n.d(t,"c",(function(){return z})),n.d(t,"a",(function(){return W})),n.d(t,"Y",(function(){return q})),n.d(t,"b",(function(){return H})),n.d(t,"d",(function(){return G})),n.d(t,"X",(function(){return K})),n.d(t,"A",(function(){return Q})),n.d(t,"B",(function(){return X})),n.d(t,"z",(function(){return Y})),n.d(t,"cb",(function(){return J})),n.d(t,"bb",(function(){return $})),n.d(t,"W",(function(){return Z})),n.d(t,"y",(function(){return ee})),n.d(t,"N",(function(){return te})),n.d(t,"O",(function(){return ne})),n.d(t,"P",(function(){return re})),n.d(t,"I",(function(){return ae})),n.d(t,"G",(function(){return ie})),n.d(t,"H",(function(){return oe})),n.d(t,"F",(function(){return se})),n.d(t,"D",(function(){return ce})),n.d(t,"E",(function(){return le})),n.d(t,"C",(function(){return ue})),n.d(t,"M",(function(){return de})),n.d(t,"L",(function(){return pe})),n.d(t,"R",(function(){return ge})),n.d(t,"S",(function(){return he})),n.d(t,"T",(function(){return fe})),n.d(t,"U",(function(){return me})),n.d(t,"K",(function(){return be})),n.d(t,"J",(function(){return _e})),n.d(t,"Q",(function(){return ye}));var r=n("nJrx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="Session.UpdateHomeSessionTitleSync",i="session.CreateSessionAsync",o="session.CreateSessionInternalAsync",s="session.CreateSession",c="session.FocusTab",l="session.FocusTabSync",u="session.FocusTabInternal",d="session.UpdateSessionCloseableSync",p="session.UpdateSessionCloseableInternal",g="session.UpdateSessionTitle",h="session.UpdateSessionIcon",f="session.UpdateSessionIconTitle",m="session.UpdateSessionTitleSync",b="session.UpdateSessionIconSync",_="session.UpdateSessionIconTitleSync",y="session.UpdateSessionFocusRequestedSync",v="session.UpdateSessionFocusRequestedInternal",S="session.CloseSession",O="session.CloseSessionAsync",C="session.FocusSessionSync",E="session.FocusSessionInternalSync",I="session.FocusSession",w="session.CloseSessionConfirmationDialog",j="session.ExecuteCreateHandlersAsync",P="session.NavigateInternal",T="session.CreateTabStateInternal",N="session.CreateTabWithPageInputAsync",A="session.CreateTabWithSitemapDescriptorAsync",D="session.CreateTabAndNavigateInternal",R="session.CloseTab",x="session.CloseTabAsync",M="session.updateTabTitle",F="session.updateTabTitleSync",k="session.tabCanClose",L="session.tabCanCloseAsync",B="session.ExecuteTabHandlers",U="session.NavigateBackInTab",V="session.CloseTabInternal",z="session.cleanupSession",W="session.addHistory",q="session.replaceTopHistory",H="session.backNavigationHistory",G="session.clearHistory",K="browsing.replaceHistory",Q=10,X=10,Y=7,J=148,$=225,Z=Object(r.a)(),ee="Menu_Label_Home",te="MultiSession.NewTabInformationLabel",ne="MultiSession.NewTabMenuAriaLabel",re="MultiSession.NewTabMenuTooltip",ae="MultiSession.CloseTabTooltip",ie="MultiSession.CloseTabAriaLabel",oe="MultiSession.CloseTabDescribedBy",se="MultiSession.CloseSessionTooltip",ce="MultiSession.CloseSessionAriaLabel",le="MultiSession.CloseSessionDescribedBy",ue="MultiSession.ActivityIndicatorDescribedBy",de="MultiSession.NavigateBackButtonTooltip",pe="MultiSession.NavigateBackButtonAriaLabel",ge="MultiSession.ScrollLeft",he="MultiSession.ScrollRight",fe="MultiSession.NewSessionLoadingTitle",me="MultiSession.NewTabLoadingTitle",be="MultiSession.CloseSessionDialogTitle",_e="MultiSession.CloseSessionDialogDescription",ye=[ee,me,fe,se,ce,le,ae,ie,oe,ue,te,ne,re,de,pe,ge,he]},"tyZ/":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return u}));var r,a,i,o=n("nuS9"),s=n("YWpA"),c=n("kGA3"),l=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});!function(e){e[e.Default=0]="Default",e[e.Small=1]="Small",e[e.Medium=2]="Medium",e[e.Large=3]="Large"}(a||(a={})),function(e){e[e.None=0]="None",e[e.Lookup=1]="Lookup",e[e.Grid=2]="Grid"}(i||(i={}));var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._renderPresence=!1,t}return l(t,e),t.prototype._addPresenceInformation=function(){var e=this.props.displaySize?this.props.displaySize:a.Default,t=this.props.presenceTarget?this.props.presenceTarget:i.None;this._presenceInstance=new this._skypeChannelContext.SkypeChannelClient.Presence(this._presenceId,this.props.sipUrl,this.props.entityReference,e,this.props.parentControlId,this.props.accessibilityLabel,t),this._presenceInstance.buildPresence()},t.prototype.componentDidMount=function(){this._renderPresence&&this._addPresenceInformation()},t.prototype.componentWillUnmount=function(){this._presenceInstance&&(this._presenceInstance.close(),this._presenceInstance=null)},t.prototype._isSkypeChannelAvailable=function(){return this._skypeChannelContext=this.context?this.context.SkypeChannel:void 0,void 0!==this._skypeChannelContext},t.prototype._isPropsAvailable=function(){return!!this.props.sipUrl||this.props.entityReference&&this._skypeChannelContext.SkypeChannelClient.PresenceInformation&&this._skypeChannelContext.SkypeChannelClient.PresenceInformation.isPresenceEnabledEntity(this.props.entityReference.entityName)},t.prototype.render=function(){return this._presenceId=this.props.id?this.props.id:this.props.parentControlId+"_presence",this._renderPresence=this._isSkypeChannelAvailable()&&this._isPropsAvailable(),this._renderPresence?o.createElement(s.a,{id:this._presenceId,style:this.props.style}):null},t.displayName="PresenceIndicator",t}(o.Component);u.contextType=c.a},"u+q+":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n("XOQQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a=r.c,i=r.e,o=r.f,s=r.d,c=r.b},u2Wk:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t,n,r,a,i,o){this.EntityLogicalName=e,this.ViewId=t,this.CustomFilter=n,this.RelationshipName=r,this.FetchXml=a,this.LayoutJson=i,this.PagingInfo=o}getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{EntityLogicalName:{typeName:"Edm.String",structuralProperty:1},ViewId:{typeName:"Edm.Guid",structuralProperty:1},CustomFilter:{typeName:"Edm.String",structuralProperty:1},RelationshipName:{typeName:"Edm.String",structuralProperty:1},FetchXml:{typeName:"Edm.String",structuralProperty:1},LayoutJson:{typeName:"Edm.String",structuralProperty:1},PagingInfo:{typeName:"Microsoft.Dynamics.CRM.PagingInfo",structuralProperty:2}}}}}},uAcA:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the OfflineStatusDialog page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="OfflineStatusDialog"},uAlF:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s}));var r=n("504W");let a=null;function i(e){Object(r.a)(a)&&(a=e)}function o(e){a.updateResources(e)}function s(e,t){const n=function(e){let t=e;t<0&&(t=t+4294967295+1);const n=t.toString(16);return"Error_Message_0x"+n}(e);return a.getErrorMessage(n,t)}},uCpV:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("5bWN");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="recentItem.add";function i(e){return{type:"recentItem.add.sync",sync:!0,execute(t,n){Object(r.a)(e,n)&&(t.dispatch(function(e){return{type:a,payload:e}}(e)),n.RecentItemsSyncManager.notifyRecentItemsUpdate())}}}},uIhY:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return v})),n.d(t,"g",(function(){return O})),n.d(t,"f",(function(){return b})),n.d(t,"e",(function(){return y})),n.d(t,"c",(function(){return _})),n.d(t,"d",(function(){return C}));var r=n("odYE"),a=n("504W"),i=n("SAYH"),o=n("d7fm"),s=n("iZ7K"),c=n("5Oca"),l=n("LbMF"),u=n("Ae6N"),d=n("x0oY"),p=n("S2mk"),g=n("Lyxw"),h=n("3/02"),f=n("z+5+");const m=["Edm.Boolean","Edm.String","Edm.Byte","Edm.Decimal","Edm.Double","Edm.Int16","Edm.Int32","Edm.Int64","Edm.SByte","Edm.Single","Edm.Date","Edm.Guid","Edm.DateTimeOffset","Edm.Duration","Edm.Stream","Edm.Binary","Edm.TimeOfDay","Edm.Geography","Edm.GeographyPoint","Edm.GeographyLineString","Edm.GeographyPolygon","Edm.GeographyMultiPoint","Edm.GeographyMultiLineString","Edm.GeographyMultiPolygon","Edm.GeographyCollection","Edm.Geometry","Edm.GeometryPoint","Edm.GeometryLineString","Edm.GeometryPolygon","Edm.GeometryMultiPoint","Edm.GeometryMultiLineString","Edm.GeometryMultiPolygon","Edm.GeometryCollection"];function b(e,t,n=!1,r=!1){if(Object(a.a)(t))return"null";if("object"==typeof t&&"entityType"in t&&"id"in t){const a=function(e,t,n){if(n){const n=Object(s.h)(e,t.entityType);return{"@odata.type":"Microsoft.Dynamics.CRM."+t.entityType,[n.PrimaryKeyName]:i.a.fromExternalGuid(t.id).guid}}return{"@odata.id":`${Object(s.o)(e,t.entityType)}(${i.a.fromExternalGuid(t.id).guid})`}}(e,t,n),o=JSON.stringify(a);return r?_(o):o}const o=JSON.stringify(t);return r?_(o):o}function _(e,t=!1){let n=e;if(t&&"string"==typeof n&&-1!==n.indexOf('"')&&(n=n.replace(/^"/,'\\"'),n=n.replace(/([^\\])"/g,'$1\\"')),n=encodeURIComponent(n),-1!==n.indexOf("'")){const e=/\'/g;return n.replace(e,"''")}return n}function y(e,t){if(null==e||!t||!t.enumProperties||!t.enumProperties.length)return null;return t.enumProperties.filter(t=>t.value===e)[0]}function v(e,t,n=0){const a=t.get_identifier(),l=a.LogicalName;let u=[];if(t)if(0===n){const e=t.get_changedFieldNames();e&&(u=e)}else u=t.get_fieldNames();const d=u.reduce((r,a)=>{const i=O(e,l,a,t,n),o=Object.keys(r),s=Object.keys(i)[0];return o&&-1!==o.indexOf(s)&&i[s]&&i[s].length?(r[s]=r[s].concat(i[s]),r):Object.assign(i,r)},{}),p=Object(s.h)(e,l);if(p&&p.IsActivity){const t=Object(o.b)(l),n=u.filter(e=>t.indexOf(e)>-1),s=t.filter(e=>-1===n.indexOf(e));if(n.length&&s.length){const t=[],n=Object(c.b)(r.a.fromLegacyEntityReference(a))(e,l);if(n&&n.fields){const a="participationtypemask",o="partyid",c="addressused",l="activitypartyid";for(const u of s)if(u in n.fields){const s=n.fields[u].list.map(t=>{const n=t.fields[a]?Number(t.fields[a].valueString):0,s=t.fields[o];let u=null;if(Object(g.a)(e,h.ce)){const e=t.fields[l];u=e&&!i.a.isNullOrEmpty(e.id)?i.a.toString(e.id):null}const d=s?s.reference:new r.a("unresolvedaddress",i.a.EMPTY,t.fields[c].value);return E(e,n,d,u)});t.push(...s)}}const o=S(e,l);o&&(d[o]?d[o].push(...t):0!==t.length&&(d[o]=t))}}const f=t.get_relatedEntities();return 1===n&&f&&f.get_entityCollections()&&f.get_entityCollections().forEach(t=>{const r=t.get_value().get_entities().map(t=>v(e,t,n)),a=r&&1===r.length&&Object(s.y)(e,l,t.get_key().get_schemaName())?r[0]:r;d[t.get_key().get_schemaName()]=a}),d}function S(e,t){const n=Object(s.b)(e,t);if(!n||!n.ReferencedEntityNavigationPropertyName)return null;return n.ReferencedEntityNavigationPropertyName}function O(e,t,n,c,p=0){let m=c.getValue(n);if(!e||!t||!n||void 0===m||1===p&&null===m)return{};let b=null;const _={},y=c.get_fieldTypes();let v=null;if("aliasedvalue"===y[n]){const t=m;b=t.get_attributeType(),_[n+"@OData.Community.Display.V1.AttributeName"]=t.get_attributeLogicalName(),v=Object(l.a)(e,t.get_entityLogicalName(),t.get_attributeLogicalName()),m=t.get_value()}else{if(v=Object(l.a)(e,t,n),!v)return{};b=v.Type}switch(b){case"multiselectpicklist":{if(Object(a.a)(m))return{};const e=m.length>0?m.join(","):null;if(e&&1===p){const e=v.OptionSet?v.OptionSet.length:0;_[Object(d.j)(n)]=m.map(t=>{for(let n=0;n<e;n++)if(t===v.OptionSet[n].Value)return v.OptionSet[n].Label;return""}).join(";")}return _[n]=e,_}case"partylist":{if(Object(a.a)(m))return{};const i=m.get_entities(),s=S(e,t);if(!s)return{};const c=Object(o.a)(t,n),l=i.map(t=>{const n=t.getValue("partyid");let a=null;if(Object(g.a)(e,h.ce)){const e=t.getValue("activitypartyid");a=e?e.toString():null}const i=r.a.fromLegacyEntityReference(n);return E(e,c,i,a)});return _[s]=l,_}case"boolean":{if(Object(a.a)(m))return{};const e=m.get_ValueString();return 1===p&&(_[Object(d.j)(n)]=m.get_Label()),_[n]="0"===e||"1"===e?"1"===e:null,_}case"picklist":case"state":case"status":return Object(a.a)(m)?{}:(1===p&&(_[Object(d.j)(n)]=m.get_Label()),_[n]=m.getValue("value"),_);case"customer":case"lookup":case"owner":{const r=Object(d.l)(n);if(Object(a.a)(m))return{[r]:null};const o=m,c=Object(s.o)(e,o.LogicalName),l=i.a.fromLegacyGuid(o.Id).guid;let u,g=null;if("owner"===b&&(g=Object(s.z)(e,t,"owner",n)),Object(a.a)(g)&&(g=Object(s.z)(e,t,o.LogicalName,n)),"owner"===b&&Object(a.a)(g))return{};if(Object(a.a)(g))throw new Error(`Unable to find many-to-one relationship, entity: ${t}, referenced entity: ${u}, field: ${n}`);return 0===p?(_[C(g.ReferencingEntityNavigationPropertyName)]=`/${c}(${l})`,Object(f.b)(e)&&(_[Object(d.j)(g.ReferencingEntityNavigationPropertyName)]=o.Name)):(_[Object(d.j)(r)]=o.Name,_[Object(d.k)(r)]=o.LogicalName,_[r]=l),_}case"uniqueidentifier":return Object(a.a)(m)?{}:(_[n]=i.a.fromLegacyGuid(m).guid,_);case"date":case"datetime":if(Object(a.a)(m))return{[n]:null};if(v.Behavior===u.a.DateOnly&&"function"==typeof m.toISOString){const e=m.toISOString().match(/(\d{4}-\d{2}-\d{2})T\d{2}\:\d{2}\:\d{2}\.\d{3}[+-Z]/i);e[1]&&(1===p&&(_[Object(d.j)(n)]=c.getFormattedValue(n)),_[n]=e[1])}else 1===p?(_[Object(d.j)(n)]=c.getFormattedValue(n),_[n]=m.toISOString().replace(/.\d{3}Z/,"Z")):_[n]=m;return _;case"money":case"decimal":case"double":case"integer":case"bigint":if(1===p){if(Object(a.a)(m))return{};_[Object(d.j)(n)]=c.getNumericFormattedValue(n)}return _[n]=m,_;default:return _[n]=m,_}}function C(e){return e+"@odata.bind"}function E(e,t,n,r){const i=n.id.guid,o=n.etn;if("unresolvedaddress"===o){const e={addressused:n.name,participationtypemask:t};return Object(p.j)(r)||(e.activitypartyid=r),e}const c=Object(s.o)(e,o),l=Object(s.b)(e,o);if(Object(a.a)(l))throw new Error(`Unable to find one-to-many relationship, entity: ${o}, referencing entity: activityparty`);const u={[l.ReferencingEntityNavigationPropertyName+"@odata.bind"]:`/${c}(${i})`,participationtypemask:t};return Object(a.a)(r)||(u.activitypartyid=r),u}},uM6Y:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"i",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"h",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Application",a="BarcodeManager",i="FileManager",o="GeoLocationManager",s="MediaContentManager",c="NavigationManager",l="Account",u="ExternalContext",d="Cordova"},uNu9:function(e,t,n){"use strict";n.d(t,"nb",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"z",(function(){return i})),n.d(t,"U",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"bc",(function(){return c})),n.d(t,"wb",(function(){return l})),n.d(t,"Vb",(function(){return u})),n.d(t,"Cb",(function(){return d})),n.d(t,"bb",(function(){return p})),n.d(t,"Kb",(function(){return g})),n.d(t,"ob",(function(){return h})),n.d(t,"eb",(function(){return f})),n.d(t,"e",(function(){return m})),n.d(t,"Gb",(function(){return b})),n.d(t,"fc",(function(){return _})),n.d(t,"f",(function(){return y})),n.d(t,"vb",(function(){return v})),n.d(t,"b",(function(){return S})),n.d(t,"fb",(function(){return O})),n.d(t,"zb",(function(){return C})),n.d(t,"yb",(function(){return E})),n.d(t,"Jb",(function(){return I})),n.d(t,"xb",(function(){return w})),n.d(t,"y",(function(){return j})),n.d(t,"B",(function(){return P})),n.d(t,"q",(function(){return T})),n.d(t,"r",(function(){return N})),n.d(t,"dc",(function(){return A})),n.d(t,"s",(function(){return D})),n.d(t,"jb",(function(){return R})),n.d(t,"D",(function(){return x})),n.d(t,"ab",(function(){return M})),n.d(t,"C",(function(){return F})),n.d(t,"gb",(function(){return k})),n.d(t,"p",(function(){return L})),n.d(t,"tb",(function(){return B})),n.d(t,"Wb",(function(){return U})),n.d(t,"Yb",(function(){return V})),n.d(t,"Y",(function(){return z})),n.d(t,"Z",(function(){return W})),n.d(t,"V",(function(){return q})),n.d(t,"Mb",(function(){return H})),n.d(t,"A",(function(){return G})),n.d(t,"Qb",(function(){return K})),n.d(t,"H",(function(){return Q})),n.d(t,"G",(function(){return X})),n.d(t,"ub",(function(){return Y})),n.d(t,"ec",(function(){return J})),n.d(t,"Ob",(function(){return $})),n.d(t,"I",(function(){return Z})),n.d(t,"Nb",(function(){return ee})),n.d(t,"ac",(function(){return te})),n.d(t,"c",(function(){return ne})),n.d(t,"Ab",(function(){return re})),n.d(t,"h",(function(){return ae})),n.d(t,"i",(function(){return ie})),n.d(t,"j",(function(){return oe})),n.d(t,"k",(function(){return se})),n.d(t,"l",(function(){return ce})),n.d(t,"m",(function(){return le})),n.d(t,"n",(function(){return ue})),n.d(t,"o",(function(){return de})),n.d(t,"t",(function(){return pe})),n.d(t,"u",(function(){return ge})),n.d(t,"v",(function(){return he})),n.d(t,"w",(function(){return fe})),n.d(t,"x",(function(){return me})),n.d(t,"E",(function(){return be})),n.d(t,"F",(function(){return _e})),n.d(t,"J",(function(){return ye})),n.d(t,"M",(function(){return ve})),n.d(t,"L",(function(){return Se})),n.d(t,"K",(function(){return Oe})),n.d(t,"P",(function(){return Ce})),n.d(t,"R",(function(){return Ee})),n.d(t,"S",(function(){return Ie})),n.d(t,"T",(function(){return we})),n.d(t,"W",(function(){return je})),n.d(t,"X",(function(){return Pe})),n.d(t,"cb",(function(){return Te})),n.d(t,"db",(function(){return Ne})),n.d(t,"ib",(function(){return Ae})),n.d(t,"kb",(function(){return De})),n.d(t,"lb",(function(){return Re})),n.d(t,"Hb",(function(){return xe})),n.d(t,"pb",(function(){return Me})),n.d(t,"rb",(function(){return Fe})),n.d(t,"Bb",(function(){return ke})),n.d(t,"Db",(function(){return Le})),n.d(t,"Eb",(function(){return Be})),n.d(t,"Fb",(function(){return Ue})),n.d(t,"Lb",(function(){return Ve})),n.d(t,"Pb",(function(){return ze})),n.d(t,"Rb",(function(){return We})),n.d(t,"Sb",(function(){return qe})),n.d(t,"Tb",(function(){return He})),n.d(t,"Xb",(function(){return Ge})),n.d(t,"Ib",(function(){return Ke})),n.d(t,"N",(function(){return Qe})),n.d(t,"O",(function(){return Xe})),n.d(t,"Ub",(function(){return Ye})),n.d(t,"Zb",(function(){return Je})),n.d(t,"mb",(function(){return $e})),n.d(t,"cc",(function(){return Ze})),n.d(t,"sb",(function(){return et})),n.d(t,"qb",(function(){return tt})),n.d(t,"hb",(function(){return nt})),n.d(t,"Q",(function(){return rt})),n.d(t,"d",(function(){return at}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="none",a="account",i="connection",o="feedback",s="audit",c="tracelog",l="product",u="sharepointdocument",d="quote",p="invoice",g="salesorder",h="opportunity",f="knowledgearticle",m="appointment",b="recurringappointmentmaster",_="workflow",y="asyncoperation",v="processsession",S="activitypointer",O="knowledgebaserecord",C="productsubstitute",E="productpricelevel",I="salesliterature",w="productassociation",j="competitor",P="contact",T="campaign",N="campaignactivity",A="uom",D="campaignresponse",R="list",x="contractdetail",M="incident",F="contract",k="lead",L="bulkoperation",B="position",U="systemuser",V="team",z="importfile",W="importlog",q="fieldsecurityprofile",H="service",G="constraintbasedgroup",K="site",Q="discounttype",X="discount",Y="pricelevel",J="uomschedule",$="sharepointdocumentlocation",Z="dynamicproperty",ee="serviceappointment",te="territory",ne="advancedsimilarityrule",re="queue",ae="bookableresource",ie="bookableresourcebooking",oe="bookableresourcebookingheader",se="bookableresourcecategory",ce="bookableresourcecategoryassn",le="bookableresourcecharacteristic",ue="bookableresourcegroup",de="bookingstatus",pe="category",ge="channelaccessprofile",he="channelaccessprofilerule",fe="channelaccessprofileruleitem",me="characteristic",be="contracttemplate",_e="customeraddress",ye="email",ve="template",Se="emailsignature",Oe="emailserverprofile",Ce="equipment",Ee="externalparty",Ie="externalpartyitem",we="fax",je="goal",Pe="goalrollupquery",Te="invoicedetail",Ne="kbarticle",Ae="letter",De="mailbox",Re="metric",xe="rollupfield",Me="opportunityproduct",Fe="phonecall",ke="queueitem",Le="quotedetail",Be="ratingmodel",Ue="ratingvalue",Ve="salesorderdetail",ze="sharepointsite",We="sla",qe="slakpiinstance",He="socialactivity",Ge="task",Ke="routingruleitem",Qe="entitlement",Xe="entitlementtemplate",Ye="socialprofile",Je="teamtemplate",$e="newprocess",Ze="translationprocess",et="phonetocaseprocess",tt="opportunitysalesprocess",nt="leadtoopportunitysalesprocess",rt="expiredprocess",at="annotation"},uTTW:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r,a=n("CGM5"),i=n("HMYz"),o=n("iDZS"),s=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=function(e){function t(t){var n=e.call(this,t)||this;return n._onLoad=n._onLoad.bind(n),n}return s(t,e),t.prototype._onLoad=function(){this.props.onLoad&&this.props.onLoad()},t.prototype.getElementName=function(){return"img"},t.prototype.getElementProps=function(){return{src:this.props.source,onLoad:this._onLoad,alt:this.props.altText?this.props.altText:"",title:this.props.title?this.props.title:this.props.altText?this.props.altText:"",onError:this.props.onError}},t.displayName="Image",t}(a.a),l=i.connect(o.a)(c)},uTcl:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.open=0]="open",e[e.closed=1]="closed"}(r||(r={}))},uUCw:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"i",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"l",(function(){return p})),n.d(t,"h",(function(){return g})),n.d(t,"k",(function(){return h}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="clientHost.initialize",a="clientHost.changeInstallationId",i="clientHost.changeSubtype",o="clientHost.changeVersion",s="clientHost.changeDeviceModel",c="clientHost.changeTelemetryEventsParams";function l(e){return{type:r,payload:e}}function u(e){return{type:a,payload:e}}function d(e){return{type:i,payload:e}}function p(e,t,n,r,a){return{type:o,payload:{version:e,build:t,revision:n,nativeRevision:r,osVersion:a}}}function g(e){return{type:s,payload:e}}function h(e){return{type:c,payload:e}}},uWQm:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="recentItem.delete.FromState",a="recentItem.delete.multiple";function i(e,t){return{type:"recentItem.delete",sync:!0,execute(n,a){n.dispatch(function(e,t){return{type:r,payload:{id:e,isOnline:t}}}(e,t)),a.RecentItemsSyncManager.notifyRecentItemsUpdate()}}}function o(e,t){return{type:a,payload:{ids:e,isOnline:t}}}},uZvv:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return l}));var r=n("2FbK"),a=n("d6Hx");function i(e){return e&&e.appShellState&&e.appShellState.sitemapState?e.appShellState.sitemapState:null}function o(e){const t=i(e);if(t)return t.selectedSubAreaId}function s(e){const t=i(e);return t&&t.selectedAreaId?t.selectedAreaId:null}function c(e){const t=s(e);if(t)return t;const n=Object(r.b)(e);return n&&(n.AreaIds[0]!==a.d?n.AreaIds[0]:n.AreaIds[1])}function l(e){const t=i(e);if(t)return t.sitemapExpandedState}},udEW:function(e,t,n){"use strict";e.exports=function(e,t,n,r,a,i,o,s){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,r,a,i,o,s],u=0;(c=new Error(t.replace(/%s/g,(function(){return l[u++]})))).name="Invariant Violation"}throw c.framesToPop=1,c}}},ueZM:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n("SAYH"),a=n("eXjw"),i=n("K7RF"),o=n("2XFH"),s=n("Uv1Y"),c=n("y60j"),l=n("g0tL"),u=n("FZDd"),d=n("AF/G"),p=n("99zj");var g=n("/oKV"),h=n("iJGp");function f(e){return{type:"complexcontrol.retrieve.async",execute({dispatch:t,getState:n},r){const a=g.a.Local;return function(e,t){var n;const r=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){var t;return null===(t=null==e?void 0:e.metadata)||void 0===t?void 0:t.complexControls}(e);return null===(n=null==r?void 0:r.complexControls)||void 0===n?void 0:n[t]}(n(),e)?Promise.resolve():t(function(e,t){return{type:"complexcontrol.retrieve.async",execute:({dispatch:n,getState:r},a)=>n(Object(i.b)("complexcontrol",null,null,null,!1,h.a.OnDemandWithoutContext,null,null,[e],null,t)).catch(s.b)}}(e,a))}}}var m=n("YVjE"),b=n("64CY"),_=n("wL2W");function y(e){return{type:"form.dependencies.update.async",execute({dispatch:t,getState:n},g){let h=n();const y=Object(c.j)(h,e);if(y&&y.initialized===a.a.Initialized){const a=function(e){if(!e)return null;const t=e.EntityLogicalName,n={},a={},i=[];i.push(r.a.toString(e.Id)+":name"),t&&(a[t]=[]);const o=e.Tabs;for(const e of o)e.LabelId&&i.push(e.LabelId+":displayname");const s=e.Sections;for(const e in s){const t=s[e];t.LabelId&&i.push(t.LabelId+":displayname")}const c=e.Controls;for(const e in c){const o=c[e];!o.DataFieldName||!t||o.Relationship||r.a.equals(o.ClassId,d.J)||r.a.equals(o.ClassId,d.i)||o.IsUnbound||a[t].push(o.DataFieldName),o.LabelId&&i.push(o.LabelId+":displayname"),o.Relationship&&(n[o.Relationship]||(n[o.Relationship]=[]),n[o.Relationship].push(o.DataFieldName))}return{labelIdsAndColumnNames:i,entityAndAttributes:a,relationshipAndAttributes:n}}(y),g=[],C=y.FormLibraries?y.FormLibraries.filter(e=>!Object(m.d)(e)):null;if(C&&C.length>0&&g.push(t(Object(p.d)(C))),a&&a.labelIdsAndColumnNames&&a.labelIdsAndColumnNames.length){const e=t(Object(o.a)(a.labelIdsAndColumnNames));g.push(e)}if(a&&a.entityAndAttributes&&Object.keys(a.entityAndAttributes).length)for(const e in a.entityAndAttributes)g.push(t(Object(u.f)(e,!1,a.entityAndAttributes[e])));return Promise.all(g).then(()=>{const o=[],d={},p=y.EntityLogicalName;if(h=n(),p&&a&&a.relationshipAndAttributes&&Object.keys(a.relationshipAndAttributes).length&&h&&h.metadata&&h.metadata.entities){const e=h.metadata.entities;for(const t in a.relationshipAndAttributes)if(e[p]&&e[p].ManyToOneRelationships&&e[p].ManyToOneRelationships[t]&&e[p].ManyToOneRelationships[t].ReferencedEntity){const n=e[p].ManyToOneRelationships[t].ReferencedEntity;n&&(d[n]||(d[n]=[]),d[n].push(...a.relationshipAndAttributes[t]))}}if(d&&Object.keys(d).length)for(const e in d)o.push(t(Object(u.f)(e,!1,d[e])));const g=t(function(e){return{type:"compositeControls.loadMetaData.async",execute({dispatch:t,getState:n},r,a){const i=n(),o=Object(c.j)(i,e),s=Object(c.k)(i),l=[];if(o){const e=[];Object.keys(o.Controls).map(e=>o.Controls[e]).filter(e=>e.Name&&e.Name.indexOf("compositionLinkControl")>0).forEach(t=>{if(!t.Name)return;const n=function(e){const t=["header","footer"],n=e.split("_"),r=t.indexOf(n[0])<0?n[0]:n[1];if(!r)return null;let a=r.replace(/[0-9]/g,"").toLowerCase().replace(/^yomi/,"");a="shipto"===a||"billto"===a?"address":a;const i=b.b.filter(e=>e.toLowerCase().indexOf(a)>-1);return i.length>0?i[0]:null}(t.Name);n&&e.indexOf(n)<0&&e.push(n),s&&Object.keys(s).filter(e=>e===n.toLowerCase()).length>0&&e.pop()}),e.forEach(e=>{l.push(t(f(e)))})}return Promise.all(l)}}}(e));return Promise.all([o,g]).then(e=>{const a=function(e,t){if(!t||!e||!e.metadata)return null;const n={},a=r.a.toString(t.Id);if(t.Name=Object(l.c)(e,a,null,null,null,e.metadata.labels,e.metadata.attributes,e.metadata.entities,"name"),t.Label=t.Name,t.Tabs)for(const n of t.Tabs)n&&!n.Label&&(n.Label=Object(l.c)(e,n.LabelId,null,null,null,e.metadata.labels,e.metadata.attributes,e.metadata.entities));if(t.Sections)for(const n in t.Sections)t.Sections[n]&&!t.Sections[n].Label&&(t.Sections[n].Label=Object(l.c)(e,t.Sections[n].LabelId,n.toLowerCase(),t.EntityLogicalName,null,e.metadata.labels,e.metadata.attributes,e.metadata.entities));if(t.Controls){const n=Object(_.a)();for(const r in t.Controls)if(t.Controls[r]&&!t.Controls[r].Label){let a;const i="TargetEntityType";if(t.Controls[r].Parameters&&t.Controls[r].Parameters[i]&&(a=t.Controls[r].Parameters[i]),t.Controls[r].Relationship&&e.metadata.entities&&e.metadata.entities[t.EntityLogicalName]&&e.metadata.entities[t.EntityLogicalName].ManyToOneRelationships&&e.metadata.entities[t.EntityLogicalName].ManyToOneRelationships[t.Controls[r].Relationship]&&e.metadata.entities[t.EntityLogicalName].ManyToOneRelationships[t.Controls[r].Relationship].ReferencedEntity){const a=e.metadata.entities[t.EntityLogicalName].ManyToOneRelationships[t.Controls[r].Relationship].ReferencedEntity,{label:i,labelSource:o}=Object(l.d)(e,t.Controls[r].LabelId,t.Controls[r].DataFieldName,a,t.EntityLogicalName,e.metadata.labels,e.metadata.attributes,e.metadata.entities);t.Controls[r].Label=i,n&&(t.Controls[r].LabelSource=o)}else{const{label:i,labelSource:o}=Object(l.d)(e,t.Controls[r].LabelId,t.Controls[r].DataFieldName,t.EntityLogicalName,a,e.metadata.labels,e.metadata.attributes,e.metadata.entities);t.Controls[r].Label=i,n&&(t.Controls[r].LabelSource=o)}}}const i=Object(b.e)(t.EntityLogicalName),o=Object(c.k)(e);i&&o&&(!function(e,t){for(const n in e.Sections)if(e.Sections[n]){const r=[],a=[];let i=0,o=0;for(let s=0;s<e.Sections[n].Rows.length;s++){const c=e.Sections[n].Rows[s];let l=0;for(const e of c.Cells)if(e.ControlName&&e.ControlName.indexOf("compositionLinkControl")>0){const n=c.Cells.indexOf(e),s=c.Cells[n].ControlName.split("_"),l=s[0];if(!l){S(c,o,r),o++;break}a.indexOf(l)<0&&(i=o,a.push(l));const u=O(l,s[s.length-1],t),d=i+u;if(u>-1){S(c,d,r),o++;break}}else l++;l===c.Cells.length&&(S(c,o,r),o++)}e.Sections[n].Rows=r}}(t,o),t.Header.Controls=v(t.Header.Controls,o),t.Footer.Controls=v(t.Footer.Controls,o));return t.AreLabelsSubstituted=!0,n[a]=t,{forms:n}}(n(),y);var o;t((o=a,{type:i.a,payload:o}))}).catch(s.b)}).catch(s.b)}return Promise.resolve()}}}function v(e,t){const n=[],r=[];let a=0;return e.forEach((e,i)=>{if(e.Name&&e.Name.indexOf("compositionLinkControl")>0){const o=e.Name.split("_"),s=o[1];if(!s)return void S(e,i,n);r.indexOf(s)<0&&(a=i,r.push(s));const c=O(s,o[o.length-1],t),l=i,u=a+c;if(c>-1&&l!==u)return void S(e,u,n)}S(e,i,n)}),n}function S(e,t,n){n[t]?n.push(e):n[t]=e}function O(e,t,n){let r=e.replace(/[0-9]/g,"").toLowerCase().replace(/^yomi/,"");r="shipto"===r||"billto"===r?"address":r;const a=n[r+"compositionLinkControl".toLowerCase()];if(a){t=t.replace(/^yomi/,"");const e=a.indexOf(t);if(e>-1)return e;const n=a.indexOf(t.slice(0,t.length-1));return n>-1?n:-1}}},ufH1:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n("XjOj"),a=n("Div0"),i=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e){const t=e.getMilliseconds();return e.format("HH:mm:ss.")+(t<100?"0":"")+(t<10?"0":"")+t.toString()}function s(e,t,n){const s=new Date;Object(i.b)(n)?Object(r.f)(t,"{0} -- {1}",e,o(s)):Object(r.f)(t,"{0} -- {1} -- {2}",e,n,o(s)),window[a.a[t]+"_"+e]=s.getTime()}function c(e,t,n){const s=new Date;Object(i.b)(n)?Object(r.j)(t,"{0} -- {1}",e,o(s)):Object(r.j)(t,"{0} -- {1} -- {2}",e,n,o(s)),window[a.a[t]+"_"+e]=s.getTime()}function l(e,t,n){const s=new Date;Object(i.b)(n)?Object(r.i)(t,"{0} -- {1}",e,o(s)):Object(r.i)(t,"{0} -- {1} -- {2}",e,n,o(s)),window[a.a[t]+"_"+e]=s.getTime()}function u(e,t,n){const s=new Date;Object(i.b)(n)?Object(r.d)(t,"{0} -- {1}",e,o(s)):Object(r.d)(t,"{0} -- {1} -- {2}",e,n,o(s)),window[a.a[t]+"_"+e]=s.getTime()}},uhZ3:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return null==e||""===e}function a(e){return r(e)||""===e.toString().trim()}function i(e){return null==e}n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}))},umme:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("uAlF"),a=n("7Gx7"),i=n("WWXV"),o=n("504W");class s{constructor(e){this._errorCode=0,this._errorFault=null,this._message=null,this._exception=null,this._innerError=null,this._errorSource=0,this._blockErrorReporting=!1,this._stack=null,this._faultedRequestIndex=0,this._clientRequestId=null,this._serverResponseId=null,this._httpStatusCode=0,this._retryAfter=null,this._message=e,this._errorSource=0,this._blockErrorReporting=!1}get_ErrorCode(){return this._errorCode}set_ErrorCode(e){return this._errorCode=e,e}get_Message(){return this._message}set_Message(e){return this._message=e,e}get_Exception(){return this._exception}set_Exception(e){return this._exception=e,e}get_InnerError(){return this._innerError}set_InnerError(e){return this._innerError=e,e}get_ErrorFault(){return this._errorFault}set_ErrorFault(e){return this._errorFault=e,e}get_ErrorSource(){return this._errorSource}get_BlockErrorReporting(){return this._blockErrorReporting}set_BlockErrorReporting(e){return this._blockErrorReporting=e,e}get_Stack(){return this._stack}set_Stack(e){return this._stack=e,e}get_FaultedRequestIndex(){return this._faultedRequestIndex}set_FaultedRequestIndex(e){return this._faultedRequestIndex=e,e}get_ServerResponseId(){return this._serverResponseId}set_ServerResponseId(e){return this._serverResponseId=e,e}get_ClientRequestId(){return this._clientRequestId}set_ClientRequestId(e){return this._clientRequestId=e,e}get_HttpStatusCode(){return this._httpStatusCode}set_HttpStatusCode(e){return this._httpStatusCode=e,e}get_RetryAfter(){return this._retryAfter}set_RetryAfter(e){return this._retryAfter=e,e}chainError(e){this.set_Message(this.get_Message()+"\nInner Error Message:\n"+e.get_Message()),this.set_InnerError(e)}getObjectDataForApplicationDispatcher(){const e=this.getObjectData();return"innererror"in e&&(e.innererror=e.innererror.getObjectDataForApplicationDispatcher()),new a.a(e)}getObjectData(){const e={};return e.errorcode=this.get_ErrorCode(),e.message=this.get_Message(),Object(o.a)(this.get_InnerError())||(e.innererror=this.get_InnerError().getObjectData()),e}static FromMessage(e,...t){let n="";return Object(o.b)(e)||(n=!Object(o.a)(t)&&t.length>0?String.format(e,...t):e),new s(n)}static fromGenericError(e){const t=Object(o.a)(e)?s.fromErrorCode(1):s.FromMessage(e.message);return t._blockErrorReporting=e.blockErrorReporting,Object(o.a)(e.errorCode)||(t._errorCode=e.errorCode),Object(o.a)(e.stack)||(t._stack=e.stack),t}static fromErrorCode(e,...t){const n=new s(Object(r.a)(e,t));return n.set_ErrorCode(e),n}static fromErrorCodeAndMessage(e,t){const n=new s("");return n.set_ErrorCode(e),n.set_Message(t),n}static fromLocalStoreError(e,t,...n){const r=new s(String.format(t,...n));return r._errorSource=i.a.LocalStore,r._errorCode=e,r}static isAuthenticationErrorCode(e){return-2147209463===e||-2147209460===e||-2147220692===e||-2147093995===e||-2147220960===e||-2146088112===e||-2147220955===e}}},unFF:function(e,t,n){"use strict";function r(e){return e?e.theme:null}n.d(t,"a",(function(){return r}))},"uu/V":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t,n,r){this.response=null,this.success=!1,this.errorMessage=null,this.errorCode=0,this.success=e,this.errorMessage=t,this.errorCode=n,this.response=r}get_response(){return this.response}get_errorMessage(){return this.errorMessage}get_errorCode(){return this.errorCode}get_success(){return this.success}}r.invalidResponseMessage="JSON response is null or undefined."},uufl:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return e.sessionTimeoutStatus?e.sessionTimeoutStatus.isReauthInProgress:null}n.d(t,"a",(function(){return r}))},uvnT:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s}));var r=n("DRVD"),a=n.n(r),i=n("SZCI"),o=n("pEXn");const s="scriptEvaluation";function c(){return{diagnosticName:s,boot:(e,t,n)=>{const r=()=>{const e=window.bundleExecutionMarkers;for(const t in e){const n=e[t].begin,r=e[t].end,c={[o.b.BootPerformanceParameters.BundleName]:t};a.a.createEvent(s,i.b).createRetroactiveStopwatch(n,r-n,c)}window.bundleExecutionMarkers={}};r(),window.reportBundleExecutionTimes=r}}}},uxy2:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return p})),n.d(t,"d",(function(){return d})),n.d(t,"g",(function(){return s})),n.d(t,"f",(function(){return c}));var r=n("dHD5"),a=n("SAYH"),i=n("/J/l");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t){const n=Object(r.v)(e);return{type:i.f,payload:{numberOfResults:t},meta:{contextKey:n}}}function s(e,t){const n=Object(r.v)(e);return{type:i.b,payload:{selectedResult:t},meta:{contextKey:n}}}function c(e,t){const n=Object(r.v)(e);return{type:i.g,payload:{records:t},meta:{contextKey:n}}}function l(e,t,n){const a={command:t,value:n},o=Object(r.v)(e);return{type:i.c,payload:{filterQueryParams:a},meta:{contextKey:o}}}function u(e,t){const n=Object(r.v)(e);return{type:i.d,payload:{blockClick:t},meta:{contextKey:n}}}function d(e,t){const n=Object(r.v)(e);return{type:i.e,payload:{currentSearchText:t},meta:{contextKey:n}}}function p(e,t,n){const o={articleId:t},s=Object(r.v)(n),c={action:{Id:6,ActionExecutionId:a.a.toString(a.a.newGuid()),Name:"OpenResult",TitleResourceName:null,TooltipResourceName:null,Title:()=>null,Tooltip:()=>null},payload:o};return{type:i.a,payload:c,meta:{contextKey:s}}}},uzi5:function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return O}));var r=n("SAYH"),a=n("eXjw"),i=n("g0tL"),o=n("VcAV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="header_process",c=s+"_";function l(e,t,n,o){if(!(t&&t.length&&t[0]&&t[0].BusinessProcessFlowEntities))return null;const s={};for(const c of t){const t={labelIdsAndColumnNames:[],entitiesAndAttributes:{}};t.labelIdsAndColumnNames.push(c.LabelId+":name");const l=c,d={},p=u(e,l.BusinessProcessFlowEntities,n,d,t),g=r.a.tryParse(l.BusinessProcessFlowId);let h=Object(i.c)(e,l.LabelId,null,null,null,n,null,null,"name");h||(h=l.BusinessProcessFlowName);const f=c.BusinessProcessFlowState||{BusinessProcessFlowId:l.BusinessProcessFlowId,Version:0,State:1,CanUpdate:!0},b=c.Version||f.Version,y={initialized:a.a.Initialized,businessProcessFlowId:g,businessProcessFlowName:h,businessProcessFlowUniqueName:l.BusinessProcessFlowUniqueName,businessProcessFlowEntities:p,businessProcessFlowBusinessRules:m(l.BusinessProcessFlowBusinessRules),businessProcessFlowStepEntityAttributeControls:d,businessProcessFlowActions:_(l.BusinessProcessFlowActions,o),businessProcessFlowFlows:S(l.BusinessProcessFlowFlows),businessProcessFlowProcessVersion:b,VersionNumber:b,OverallVersionNumber:c.OverallVersionNumber,businessProcessFlowProcessState:f.State,businessProcessFlowCanUpdate:f.CanUpdate,dependencies:t};s[l.BusinessProcessFlowId]=y}return s}function u(e,t,n,a,i){if(!t)return null;const o=[],s=function(e){let t=null;for(const n of e)if(n.Relationships){return t={relationships:p(n.Relationships)},t}if(!t&&e.length>=2&&e[0].EntityLogicalName&&e[1].EntityLogicalName){const n=e[0],a=e[1];if(n.EntityLogicalName!==a.EntityLogicalName&&n.RelationshipName&&n.ReferencingAttributeName&&n.Stage&&a.Stage){const e={sourceStageId:r.a.tryParse(n.Stage.StageId),targetStageId:r.a.tryParse(a.Stage.StageId),attributeName:n.ReferencingAttributeName,relationshipName:n.RelationshipName},i=[];i.push(e),t={relationships:i}}}return t}(t);s&&o.push(s);for(const r of t)if(r.EntityDisplayName){const t=r;let c=[];a[t.EntityLogicalName]||(a[t.EntityLogicalName]={},i.entitiesAndAttributes[t.EntityLogicalName]||(i.entitiesAndAttributes[t.EntityLogicalName]=[]),c=i.entitiesAndAttributes[t.EntityLogicalName]);const l={entityDisplayName:t.EntityDisplayName,entityLogicalName:t.EntityLogicalName,relationshipName:t.RelationshipName,referencingAttributeName:t.ReferencingAttributeName,isClosedLoop:t.IsClosedLoop,attributeFieldNames:t.AttributeFieldNames,stage:g(e,t.Stage,n,a[t.EntityLogicalName],i.labelIdsAndColumnNames,c)},u=d(t.Stage,s);u&&l&&(l.relationshipName||(l.relationshipName=u.relationshipName),l.referencingAttributeName||(l.referencingAttributeName=u.attributeName)),o.push(l)}return o}function d(e,t){if(!e||!t)return null;for(const n of t.relationships)if(r.a.equals(r.a.parse(e.StageId),n.targetStageId))return n;return null}function p(e){if(!e)return null;const t=[];for(const n of e){const e={sourceStageId:r.a.tryParse(n.SourceStageId),targetStageId:r.a.tryParse(n.TargetStageId),attributeName:n.AttributeName,relationshipName:n.RelationshipName};t.push(e)}return t}function g(e,t,n,a,o,s){if(!t)return null;let c=Object(i.c)(e,t.LabelId,null,null,null,n,null,null,"description");c||(c=t.StageDisplayName),o.push(t.LabelId+":description");return{stageId:r.a.tryParse(t.StageId),name:t.Name,stageLogicalName:t.StageLogicalName,stageDisplayName:c,stageCategory:t.StageCategory,nextStageId:t.NextStageId?r.a.tryParse(t.NextStageId):null,conditionJson:t.ConditionJson,data:t.Data,steps:h(e,t.Steps,n,a,o,s)}}function h(e,t,n,a,s,c){if(!t)return null;const l=[];for(const u of t){if(!u.Name)continue;let t=Object(i.c)(e,u.LabelId,null,null,null,n,null,null,"description");t||(t=u.Label),s.push(u.LabelId+":description");let d=u.StepType;Object(o.b)(d)||(d=d.toLowerCase(),"action"!==d&&"modernflow"!==d&&c.push(u.Name));const p={stepId:r.a.tryParse(u.StepId),name:u.Name,enabled:u.Enabled,required:u.Required,label:t,controlName:f(u,t,a),viewId:u.ViewId,stepType:u.StepType};l.push(p)}return l}function f(e,t,n){const a=function(e,t){if(!e)return null;t||(t={});const n=c+e.Name;let r=n,a=1;for(;t[r];)r=n+"_"+a++;return r}(e,n);if(a){const i={defaultviewid:e.ViewId},o={Id:e.StepId,Label:t,Name:a,ShowLabel:!0,Visible:!0,Disabled:!e.Enabled,DataFieldName:e.Name,UniqueId:e.StepId,ClassId:r.a.tryParse(e.ClassId),DomId:a,Parameters:i};n[o.Name]=o}return a}function m(e){if(!e)return null;const t={};for(const n of e){const e={entityName:n.EntityName,businessRuleAttributes:b(n.BusinessRuleAttributes)};t[e.entityName]=e}return t}function b(e){if(!e)return null;const t={};for(const n of e){const e={attributeName:n.AttributeName,customJavascriptFunctions:n.CustomJavascriptFunctions};t[e.attributeName]=e}return t}function _(e,t){if(!e)return null;const n={};for(const r of e){let e,a;if(0===r.ActionType){if(!t)return null;for(const n of t)if(!Object(o.b)(r.UniqueName)){const t=r.UniqueName.indexOf("_");if((t>0?r.UniqueName.substring(t+1):r.UniqueName)===n.CustomOperationUniqueName){e=y(n.InputParameters),a=y(n.OutputParameters);break}}}const i=r.InputParameterBindings.map(e=>({parameterName:e.ParameterName,boundAttributeName:e.BoundAttributeName,parameterType:e.ParameterType,parameterStructuralProperty:v(e.ParameterStructuralProperty)})),s=r.OutputParameterBindings.map(e=>({parameterName:e.ParameterName,boundAttributeName:e.BoundAttributeName,parameterType:e.ParameterType,parameterStructuralProperty:v(e.ParameterStructuralProperty)})),l={processActionMessageName:c+r.ProcessActionMessageName,inputParameters:e,outputParameters:a,inputBindings:i,outputBindings:s,workflowId:r.WorkflowId,actionType:r.ActionType,uniqueName:r.UniqueName,actionId:r.ActionId};n[l.processActionMessageName]=l}return n}function y(e){if(!e)return null;const t={};for(const n in e){const r={parameterName:e[n].ParameterName,parameterStructuralProperty:v(e[n].ParameterStructuralProperty),parameterType:e[n].ParameterType};t[r.parameterName]=r}return t}function v(e){switch(e){case"Primitive":return 1;case"Complex":return 2;case"Enumeration":return 3;case"Collection":return 4;case"Entity":return 5;default:return 0}}function S(e){if(!e)return null;const t={};for(const n of e){const e={workflowId:n.WorkflowId,uniqueName:n.UniqueName,actionId:n.ActionId};t[n.ActionId]=e}return t}function O(e){if(!e)return{bpfSelectors:null,bpfDefaults:null};const t={},n={};for(const a of e)if(a.hasOwnProperty("EntityLogicalName")&&a.SelectorItems.length>0){t[a.EntityLogicalName]||(t[a.EntityLogicalName]=[]);let e=null;for(const n of a.SelectorItems){const r={id:n.Id,primaryEntity:n.PrimaryEntity,processOrder:n.ProcessOrder,uniqueName:n.UniqueName};t[a.EntityLogicalName].push(r),(!e&&n.PrimaryEntity===a.EntityLogicalName||e&&e.ProcessOrder>n.ProcessOrder)&&(e=n)}e&&(n[a.EntityLogicalName]=new r.a(e.Id))}return{bpfSelectors:t,bpfDefaults:n}}},v3UX:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");class a extends r.a{constructor(e,t,n,r,a,i){super(),this._target=e,this._columnSet=t,this._relatedEntitiesQuery=n,this._returnNotifications=r,this._clientRetrieveOptions=a,this._navigationProperty=i}get_name(){return"Retrieve"}get_xmlNamespace(){return"http://schemas.microsoft.com/xrm/2011/Contracts"}get_target(){return this._target}get_columnSet(){return this._columnSet}get_relatedEntitiesQuery(){return this._relatedEntitiesQuery}get_returnNotifications(){return this._returnNotifications}get_clientRetrieveOptions(){return this._clientRetrieveOptions}get_navigationProperty(){return this._navigationProperty}}},vF3j:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("iZ7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,n){let a,i,o;if(o=Object(r.B)(e,t,n))a="POST",i=o.ReferencedEntityNavigationPropertyName;else if(o=Object(r.u)(e,t,n))if(a="POST",t===o.Entity1LogicalName)i=o.Entity1NavigationPropertyName;else{if(t!==o.Entity2LogicalName)return{serializationFailure:`No navigation property found for the N:N relationship with the name ${n} and target entity ${t}`};i=o.Entity2NavigationPropertyName}else{if(!(o=Object(r.x)(e,t,n)))return{serializationFailure:`No metadata is available for the relationship with the name ${n} and target entity ${t}`};a="PUT",i=o.ReferencingEntityNavigationPropertyName}return{navigationProperty:i,method:a}}},vIHs:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("EY5k"),a=n("ngeo"),i=n("YxC/"),o=n("qAG9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s={errorCode:{labelId:"ErrorPopup.ErrorCode",defaultValue:"Error Code"},sessionId:{labelId:"ErrorPopup.SessionId",defaultValue:"Session Id"},activityId:{labelId:"ErrorPopup.ActivityId",defaultValue:"Activity Id"},requestId:{labelId:"ErrorPopup.RequestId",defaultValue:"Request Id"},timestamp:{labelId:"ErrorPopup.Timestamp",defaultValue:"Timestamp"},errorDetailsLabel:{labelId:"ErrorPopup.ErrorDetailsLabel",defaultValue:"Technical Details"},Button_Label_OK:{labelId:"Button_Label_OK",defaultValue:"OK"},Button_Label_Close:{labelId:"Button_Label_Close",defaultValue:"Close"},Error_Title_Generic:{labelId:"Error_Title_Generic",defaultValue:"Error"}};n("NUY7");var c=n("Rckk");function l(e,t,n,l){const d=window.__preload&&window.__preload.localizedStrings,p=window.__preload&&window.__preload.isRTL,g=d&&d.errors,h=d&&d.labels,f=e&&e.get_request&&e.get_request(),m=e&&e.errorCode,b=e&&e.errorParameters;let _=e&&e.displayTitle,y=e&&e.displayMessage;const v=[],S={};let O=null,C=null,E=null,I=null,w=null;if(m&&(C="0x"+a.a.getHexErrorCodeFromInt(m)),f&&(w=f.status,O=f&&f.headers?Object(o.a)(f.headers,c.c.SERVER_REQUEST_ID):null),t&&n){const e=[];for(const t in s)e.push(s[t].labelId);m&&(_||(E="Error_Title_"+C,e.push(E)),y||(I="Error_Message_"+C,e.push(I))),v.push(t(Object(r.e)(e)).then(()=>{const t=Object(i.e)(n(),e);for(const e in s)S[e]=Object(i.c)(t,s[e].labelId);if(m&&(_=_||Object(i.c)(t,E),!y&&(y=Object(i.c)(t,I),y&&b&&b.length))){const e=b.map(e=>e.value);y=String.format(y,...e)}}).catch(()=>Promise.resolve()))}else if(g&&(w||C)){const e=w?"Status"+w:"Error_"+C;g&&g[e]&&(_=_||g[e].errorTitle,y=y||g[e].errorMessage)}return Promise.all(v).then(()=>{_=_||g&&g.UnknownError.errorTitle||"Error",y=y||g&&g.UnknownError.errorMessage||"Something went wrong";const t=S.errorDetailsLabel||h&&h.errorDetailsLabel||s.errorDetailsLabel.defaultValue,n=S.Button_Label_OK||h&&h.Button_Label_OK||s.Button_Label_OK.defaultValue,r=S.Button_Label_Close||h&&h.Button_Label_Close||s.Button_Label_Close.defaultValue,a=S.Error_Title_Generic||g&&g.UnknownError.errorTitle||s.Error_Title_Generic.defaultValue,i={errorCode:m,sessionId:l&&l.sessionId,activityId:l&&l.activityId,requestId:O,timestamp:new Date},o={detailsLabel:t,errorMessage:e&&e.message,stack:e&&e.stack};return{errorPopupDescriptor:{title:_,message:y,closeButtonLabel:r,accessibilityLabelPrefix:a,errorInformation:u(i,S,h,p),errorTechnicalDetails:o,isRTL:p},okButtonLabel:n}})}function u(e,t,n,r){const a={};for(const i in e)if(e[i]){const o=t[i]||n&&n[i]||s[i].defaultValue;a[i]=r?e[i]+" :"+o:o+": "+e[i]}return a}},"vJ3+":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Lhhr"),a=function(){function e(){var e=this;this._hasAlertedSinceLastIdle=!1,this._patchAlert(window),r.forEachAdditionalWindow((function(t){e._patchAlert(t.contentWindow)}))}return e.prototype.resetTracking=function(){var e=this;this._hasAlertedSinceLastIdle=!1,r.forEachAdditionalWindow((function(t){e._patchAlert(t.contentWindow)}))},e.prototype.hasAlertedSinceLastIdle=function(){return this._hasAlertedSinceLastIdle},e.prototype._patchAlert=function(e){var t=this;if(!e.alertPatched){var n=e.alert;e.alert=function(e){t._hasAlertedSinceLastIdle=!0,n(e)};var r=e.confirm;e.confirm=function(e){return t._hasAlertedSinceLastIdle=!0,r(e)},e.alertPatched=!0}},e}();t.default=a},vNXc:function(e,t,n){"use strict";n.d(t,"a",(function(){return G}));var r=n("q/4y"),a=n("SAYH"),i=n("odYE"),o=n("+5Bq"),s=n("zsAz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class c extends
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class{getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{}}}}{constructor(e,t,n,r,a,i,o,s,c){super(),this.Distinct=e,this.NoLock=t,this.PageInfo=n,this.LinkEntities=r,this.Criteria=a,this.Orders=i,this.EntityName=o,this.ColumnSet=s,this.TopCount=c}getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Distinct:{typeName:"Edm.Boolean",structuralProperty:1},NoLock:{typeName:"Edm.Boolean",structuralProperty:1},PageInfo:{typeName:"Microsoft.Dynamics.CRM.PagingInfo",structuralProperty:2},LinkEntities:{typeName:"mscrm.LinkEntity",structuralProperty:4},Criteria:{typeName:"Microsoft.Dynamics.CRM.FilterExpression",structuralProperty:2},Orders:{typeName:"mscrm.OrderExpression",structuralProperty:4},EntityName:{typeName:"Edm.String",structuralProperty:1},ColumnSet:{typeName:"Microsoft.Dynamics.CRM.ColumnSet",structuralProperty:2},TopCount:{typeName:"Edm.Int32",structuralProperty:1}},typeName:"Microsoft.Dynamics.CRM.QueryExpression"}}}var l=n("F3eT");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class u{constructor(e,t){this.AllColumns=e,this.Columns=t}getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{AllColumns:{typeName:"Edm.Boolean",structuralProperty:1},Columns:{typeName:"Edm.String",structuralProperty:4}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class d{constructor(e,t){this.AttributeName=e,this.OrderType=t}getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{AttributeName:{typeName:"Edm.String",structuralProperty:1},OrderType:{typeName:"Microsoft.Dynamics.CRM.OrderType",structuralProperty:3,enumProperties:[,{name:"Ascending",value:0},{name:"Descending",value:1}]}}}}}var p=n("CB5L");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class g{constructor(e,t,n,r,a,i,o,s,c,l){this.LinkFromAttributeName=e,this.LinkFromEntityName=t,this.LinkToEntityName=n,this.LinkToAttributeName=r,this.JoinOperator=a,this.LinkCriteria=i,this.LinkEntities=o,this.Columns=s,this.EntityAlias=c,this.Orders=l}getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{LinkFromAttributeName:{typeName:"Edm.String",structuralProperty:1},LinkFromEntityName:{typeName:"Edm.String",structuralProperty:1},LinkToEntityName:{typeName:"Edm.String",structuralProperty:1},LinkToAttributeName:{typeName:"Edm.String",structuralProperty:1},JoinOperator:{typeName:"Microsoft.Dynamics.CRM.JoinOperator",structuralProperty:3,enumProperties:[{name:"Inner",value:0},{name:"LeftOuter",value:1},{name:"Natural",value:2},{name:"MatchFirstRowUsingCrossApply",value:3},{name:"In",value:4},{name:"Exists",value:5}]},LinkCriteria:{typeName:"Microsoft.Dynamics.CRM.FilterExpression",structuralProperty:2},LinkEntities:{typeName:"mscrm.LinkEntity",structuralProperty:4},Columns:{typeName:"Microsoft.Dynamics.CRM.ColumnSet",structuralProperty:2},EntityAlias:{typeName:"Edm.String",structuralProperty:1},Orders:{typeName:"mscrm.OrderExpression",structuralProperty:4}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class h{constructor(e,t,n,r,a){this.FilterOperator=e,this.FilterHint=t,this.Conditions=n,this.Filters=r,this.IsQuickFindFilter=a}getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{FilterOperator:{typeName:"Microsoft.Dynamics.CRM.LogicalOperator",structuralProperty:3,enumProperties:[,{name:"And",value:0},{name:"Or",value:1}]},FilterHint:{typeName:"Edm.String",structuralProperty:1},Conditions:{typeName:"mscrm.ConditionExpression",structuralProperty:4},Filters:{typeName:"mscrm.FilterExpression",structuralProperty:4},IsQuickFindFilter:{typeName:"Edm.Boolean",structuralProperty:1}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class f{constructor(e,t,n,r){this.EntityName=e,this.AttributeName=t,this.Operator=n,this.Values=r}getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{EntityName:{typeName:"Edm.String",structuralProperty:1},AttributeName:{typeName:"Edm.String",structuralProperty:1},Operator:{typeName:"Microsoft.Dynamics.CRM.ConditionOperator",structuralProperty:3,enumProperties:[,{name:"Equal",value:0},{name:"NotEqual",value:1},{name:"GreaterThan",value:2},{name:"LessThan",value:3},{name:"GreaterEqual",value:4},{name:"LessEqual",value:5},{name:"Like",value:6},{name:"NotLike",value:7},{name:"In",value:8},{name:"NotIn",value:9},{name:"Between",value:10},{name:"NotBetween",value:11},{name:"Null",value:12},{name:"NotNull",value:13},{name:"Yesterday",value:14},{name:"Today",value:15},{name:"Tomorrow",value:16},{name:"Last7Days",value:17},{name:"Next7Days",value:18},{name:"LastWeek",value:19},{name:"ThisWeek",value:20},{name:"NextWeek",value:21},{name:"LastMonth",value:22},{name:"ThisMonth",value:23},{name:"NextMonth",value:24},{name:"On",value:25},{name:"OnOrBefore",value:26},{name:"OnOrAfter",value:27},{name:"LastYear",value:28},{name:"ThisYear",value:29},{name:"NextYear",value:30},{name:"LastXHours",value:31},{name:"NextXHours",value:32},{name:"LastXDays",value:33},{name:"NextXDays",value:34},{name:"LastXWeeks",value:35},{name:"NextXWeeks",value:36},{name:"LastXMonths",value:37},{name:"NextXMonths",value:38},{name:"LastXYears",value:39},{name:"NextXYears",value:40},{name:"EqualUserId",value:41},{name:"NotEqualUserId",value:42},{name:"EqualBusinessId",value:43},{name:"NotEqualBusinessId",value:44},{name:"ChildOf",value:45},{name:"Mask",value:46},{name:"NotMask",value:47},{name:"MasksSelect",value:48},{name:"Contains",value:49},{name:"DoesNotContain",value:50},{name:"EqualUserLanguage",value:51},{name:"NotOn",value:52},{name:"OlderThanXMonths",value:53},{name:"BeginsWith",value:54},{name:"DoesNotBeginWith",value:55},{name:"EndsWith",value:56},{name:"DoesNotEndWith",value:57},{name:"ThisFiscalYear",value:58},{name:"ThisFiscalPeriod",value:59},{name:"NextFiscalYear",value:60},{name:"NextFiscalPeriod",value:61},{name:"LastFiscalYear",value:62},{name:"LastFiscalPeriod",value:63},{name:"LastXFiscalYears",value:64},{name:"LastXFiscalPeriods",value:65},{name:"NextXFiscalYears",value:66},{name:"NextXFiscalPeriods",value:67},{name:"InFiscalYear",value:68},{name:"InFiscalPeriod",value:69},{name:"InFiscalPeriodAndYear",value:70},{name:"InOrBeforeFiscalPeriodAndYear",value:71},{name:"InOrAfterFiscalPeriodAndYear",value:72},{name:"EqualUserTeams",value:73},{name:"EqualUserOrUserTeams",value:74},{name:"Under",value:75},{name:"NotUnder",value:76},{name:"UnderOrEqual",value:77},{name:"Above",value:78},{name:"AboveOrEqual",value:79},{name:"EqualUserOrUserHierarchy",value:80},{name:"EqualUserOrUserHierarchyAndTeams",value:81},{name:"OlderThanXYears",value:82},{name:"OlderThanXWeeks",value:83},{name:"OlderThanXDays",value:84},{name:"OlderThanXHours",value:85},{name:"OlderThanXMinutes",value:86},{name:"ContainValues",value:87},{name:"DoesNotContainValues",value:88}]},Values:{typeName:"mscrm.Object",structuralProperty:4}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class m{constructor(e,t){this.Type=e,this.Value=t}getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Type:{typeName:"Edm.String",structuralProperty:1},Value:{typeName:"Edm.String",structuralProperty:1}}}}}var b=n("FZDd"),_=n("LbMF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function y(e,t,n){const r=function(e){const t={},n=(new DOMParser).parseFromString(e,"text/xml"),r=n.getElementsByTagName("entity");r&&r.length;const a=n.getElementsByTagName("condition");for(let e=0;e<a.length;++e){const n=a[e],r=O(n,"entityName"),i=O(n,"attribute"),o=r||N(n);t.hasOwnProperty(o)?-1===t[o].indexOf(i)&&t[o].push(i):t[o]=[i]}return t}(e);return n(Object(b.e)(r)).then(()=>{const n=t(),r=(new DOMParser).parseFromString(e,"text/xml").documentElement,a=v(r,"returntotalrecordcount"),i=S(r,"page"),o=S(r,"count"),s=v(r,"no-lock"),u=O(r,"paging-cookie"),d=S(r,"top"),g=v(r,"distinct");let f=null;const m=[],b=[];let _=null,y=null;const w=r&&r.getElementsByTagName("entity");if(w&&w.length){const e=w[0];f=O(e,"name"),y=C(e),_=E(e);const t=e.childNodes;for(let e=0;e<t.length;e++){const r=t[e].nodeName;"filter"===r?b.push(I(t[e],f,n)):"link-entity"===r&&m.push(T(t[e],f,n))}}let j=null;return 1===b.length?j=b[0]:b.length>1&&(j=new h(p.f.And,null,[],b,!1)),new c(g,s,new l.a(i,o,a,u),m,j,_,f,y,d)})}function v(e,t){return Object(o.a)(O(e,t))}function S(e,t,n){const r=O(e,t);return r?parseInt(r,10):n}function O(e,t){const n=e;return n&&n.attributes&&n.attributes.getNamedItem(t)&&n.attributes.getNamedItem(t).value}function C(e){const t=e.childNodes,n=new u(!1,[]);for(let e=0;e<t.length;e++){const r=t[e].nodeName;"all-attributes"===r?n.AllColumns=!0:"attribute"===r&&n.Columns.push(O(t[e],"name"))}return n}function E(e){const t=e.childNodes,n=[];for(let e=0;e<t.length;e++){if("order"===t[e].nodeName){const r=O(t[e],"attribute");let a=v(t[e],"descending");null==a&&(a=!0),n.push(new d(r,a?p.g.Descending:p.g.Ascending))}}return n}function I(e,t,n){const r=v(e,"isquickfindfields"),a="or"===O(e,"type")?p.f.Or:p.f.And,i=[],o=[],s=e.childNodes;for(let e=0;e<s.length;e++){const r=s[e].nodeName;"filter"===r?i.push(I(s[e],t,n)):"condition"===r&&o.push(w(s[e],t,n))}return new h(a,null,o,i,r)}function w(e,t,n){const r=O(e,"entityname"),a=O(e,"attribute"),i=function(e){switch(O(e,"operator")){case"eq":return p.a.Equal;case"neq":case"ne":return p.a.NotEqual;case"gt":return p.a.GreaterThan;case"ge":return p.a.GreaterEqual;case"le":return p.a.LessEqual;case"lt":return p.a.LessThan;case"like":return p.a.Like;case"not-like":return p.a.NotLike;case"in":return p.a.In;case"not-in":return p.a.NotIn;case"between":return p.a.Between;case"not-between":return p.a.NotBetween;case"null":return p.a.Null;case"not-null":return p.a.NotNull;case"yesterday":return p.a.Yesterday;case"today":return p.a.Today;case"tomorrow":return p.a.Tomorrow;case"last-seven-days":return p.a.Last7Days;case"next-seven-days":return p.a.Next7Days;case"last-week":return p.a.LastWeek;case"this-week":return p.a.ThisWeek;case"next-week":return p.a.NextWeek;case"last-month":return p.a.LastMonth;case"this-month":return p.a.ThisMonth;case"next-month":return p.a.NextMonth;case"on":return p.a.On;case"on-or-before":return p.a.OnOrBefore;case"on-or-after":return p.a.OnOrAfter;case"last-year":return p.a.LastYear;case"this-year":return p.a.ThisYear;case"next-year":return p.a.NextYear;case"last-x-hours":return p.a.LastXHours;case"next-x-hours":return p.a.NextXHours;case"last-x-days":return p.a.LastXDays;case"next-x-days":return p.a.NextXDays;case"last-x-weeks":return p.a.LastXWeeks;case"next-x-weeks":return p.a.NextXWeeks;case"last-x-months":return p.a.LastXMonths;case"next-x-months":return p.a.NextXMonths;case"olderthan-x-months":return p.a.OlderThanXMonths;case"olderthan-x-years":return p.a.OlderThanXYears;case"olderthan-x-weeks":return p.a.OlderThanXWeeks;case"olderthan-x-days":return p.a.OlderThanXDays;case"olderthan-x-hours":return p.a.OlderThanXHours;case"olderthan-x-minutes":return p.a.OlderThanXMinutes;case"last-x-years":return p.a.LastXYears;case"next-x-years":return p.a.NextXYears;case"eq-userid":return p.a.EqualUserId;case"ne-userid":return p.a.NotEqualUserId;case"eq-userteams":return p.a.EqualUserTeams;case"eq-useroruserteams":return p.a.EqualUserOrUserTeams;case"eq-useroruserhierarchy":return p.a.EqualUserOrUserHierarchy;case"eq-useroruserhierarchyandteams":return p.a.EqualUserOrUserHierarchyAndTeams;case"eq-businessid":return p.a.EqualBusinessId;case"ne-businessid":return p.a.NotEqualBusinessId;case"eq-userlanguage":return p.a.EqualUserLanguage;case"this-fiscal-year":return p.a.ThisFiscalYear;case"this-fiscal-period":return p.a.ThisFiscalPeriod;case"next-fiscal-year":return p.a.NextFiscalYear;case"next-fiscal-period":return p.a.NextFiscalPeriod;case"last-fiscal-year":return p.a.LastFiscalYear;case"last-fiscal-period":return p.a.LastFiscalPeriod;case"last-x-fiscal-years":return p.a.LastXFiscalYears;case"last-x-fiscal-periods":return p.a.LastXFiscalPeriods;case"next-x-fiscal-years":return p.a.NextXFiscalYears;case"next-x-fiscal-periods":return p.a.NextXFiscalPeriods;case"in-fiscal-year":return p.a.InFiscalYear;case"in-fiscal-period":return p.a.InFiscalPeriod;case"in-fiscal-period-and-year":return p.a.InFiscalPeriodAndYear;case"in-or-before-fiscal-period-and-year":return p.a.InOrBeforeFiscalPeriodAndYear;case"in-or-after-fiscal-period-and-year":return p.a.InOrAfterFiscalPeriodAndYear;case"begins-with":return p.a.BeginsWith;case"not-begin-with":return p.a.DoesNotBeginWith;case"ends-with":return p.a.EndsWith;case"not-end-with":return p.a.DoesNotEndWith;case"under":return p.a.Under;case"eq-or-under":return p.a.UnderOrEqual;case"not-under":return p.a.NotUnder;case"above":return p.a.Above;case"eq-or-above":return p.a.AboveOrEqual;default:throw Object(s.d)("Unable to parse operator from fetchXml Node: "+(new XMLSerializer).serializeToString(e))}}(e),o=function(e,t,n,r,a){const i=O(e,"value"),o=Object(_.a)(a,t,n);if(o){if(i){const e=j(o.Type,i),t=P(o.Type,r,e);return[new m(t,e)]}const t=[],n=e.childNodes;for(let e=0;e<n.length;e++)if("value"===n[e].nodeName){const a=j(o.Type,n[e].textContent),i=P(o.Type,r,a);t.push(new m(i,a))}return t}throw Object(s.d)("Unable to parse values from fetchXml Node: "+(new XMLSerializer).serializeToString(e))}(e,r||t,a,i,n);return new f(t,a,i,o)}function j(e,t){switch(e){case"boolean":let e=Object(o.a)(t);return void 0===e&&(e=1===parseInt(t,10)),e.toString();case"datetime":case"money":case"decimal":case"double":case"integer":case"picklist":case"state":case"status":case"entityname":case"string":case"memo":case"uniqueidentifier":case"bigint":case"calendarrules":case"virtual":case"managedproperty":case"entityname":case"customer":case"aliasedvalue":case"lookup":case"owner":case"partylist":default:return t}}function P(e,t,n){switch(e){case"boolean":return"System.Boolean";case"datetime":switch(t){case p.a.LastXHours:case p.a.NextXHours:case p.a.LastXDays:case p.a.NextXDays:case p.a.LastXWeeks:case p.a.NextXWeeks:case p.a.LastXMonths:case p.a.NextXMonths:case p.a.OlderThanXMonths:case p.a.OlderThanXYears:case p.a.OlderThanXWeeks:case p.a.OlderThanXDays:case p.a.OlderThanXHours:case p.a.OlderThanXMinutes:case p.a.LastXYears:case p.a.NextXYears:case p.a.InFiscalYear:case p.a.InFiscalPeriod:case p.a.InFiscalPeriodAndYear:case p.a.InOrBeforeFiscalPeriodAndYear:case p.a.InOrAfterFiscalPeriodAndYear:return"System.Int32";default:return"System.DateTime"}case"money":case"decimal":return"System.Decimal";case"double":return"System.Double";case"integer":return"System.Int32";case"picklist":case"state":case"status":case"entityname":return function(e){return Number.isInteger(Number(e))}(n)?"System.Int32":"System.String";case"string":case"memo":return"System.String";case"uniqueidentifier":return"System.Guid";case"bigint":return"System.Int64";case"calendarrules":case"virtual":case"managedproperty":case"entityname":case"customer":case"aliasedvalue":case"lookup":case"owner":case"partylist":default:return"System.Object"}}function T(e,t,n){const r=C(e),a=E(e);let i=null;const o=[],s=t,c=O(e,"name"),l=O(e,"from"),u=O(e,"to"),d=function(e){switch(O(e,"link-type")){case"outer":return p.e.LeftOuter;case"inner":return p.e.Inner;case"natural":return p.e.Natural;case"exists":return p.e.Exists;case"in":return p.e.In;case"matchfirstrowusingcrossapply":return p.e.MatchFirstRowUsingCrossApply;default:return p.e.Natural}}(e),h=O(e,"alias"),f=e.childNodes;for(let e=0;e<f.length;e++){const t=f[e].nodeName;"filter"===t?i=I(f[e],c,n):"link-entity"===t&&o.push(T(f[e],c,n))}return new g(u,s,c,l,d,i,o,r,h,a)}function N(e){let t=e.parentNode;for(;t;){if("link-entity"===t.nodeName||"entity"===t.nodeName)return O(t,"name");t=t.parentNode}}var A,D=n("whN/"),R=n("zjrO"),x=n("jZCH"),M=n("XvL5"),F=n("pah4"),k=n("/bjP"),L=n("504W");class B{constructor(e,t,n,r,a){this._Name=null,this._From=null,this._To=null,this._LinkType=null,this._Alias=null,this._RetrieveAllAttributes=!1,this._Attributes=null,this._Order=null,this._LinkEntity=null,this._Filters=null,this._set_name(e),this._set_from(t),this._set_to(n),this._set_linkType(Object(L.a)(r)?"":r),this._set_alias(Object(L.a)(a)?"":a),this._set_retrieveAllAttributes(!1),this.set_attributes([]),this._set_order(null),this._set_linkEntity(null),this._set_filters([])}_get_name(){return this._Name}_set_name(e){return this._Name=e,e}_get_from(){return this._From}_set_from(e){return this._From=e,e}_get_to(){return this._To}_set_to(e){return this._To=e,e}_get_linkType(){return this._LinkType}_set_linkType(e){return this._LinkType=e,e}_get_alias(){return this._Alias}_set_alias(e){return this._Alias=e,e}_get_retrieveAllAttributes(){return this._RetrieveAllAttributes}_set_retrieveAllAttributes(e){return this._RetrieveAllAttributes=e,e}get_attributes(){return this._Attributes}set_attributes(e){return this._Attributes=e,e}_get_order(){return this._Order}_set_order(e){return this._Order=e,e}_get_linkEntity(){return this._LinkEntity}_set_linkEntity(e){return this._LinkEntity=e,e}_get_filters(){return this._Filters}_set_filters(e){return this._Filters=e,e}getFetchXMLString(){let e='<link-entity name="'+this._get_name()+'" from="'+this._get_from()+'" to="'+this._get_to()+'"';if(e+=Object(L.a)(this._get_linkType())||Object(L.b)(this._get_linkType())?"":' link-type="'+this._get_linkType()+'"',e+=Object(L.a)(this._get_alias())||Object(L.b)(this._get_alias())?"":' alias="'+this._get_alias()+'"',e+=">",this._get_retrieveAllAttributes())e+="<all-attributes />";else for(let t=0;t<this.get_attributes().length;t++)e+=this.get_attributes()[t].toString();Object(L.a)(this._get_order())||(e+=this._get_order().toString());for(let t=0;t<this._get_filters().length;t++)e+=this._get_filters()[t].toFetchXml();return Object(L.a)(this._get_linkEntity())||(e+=this._get_linkEntity().getFetchXMLString()),e+="</link-entity>",e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.count=0]="count",e[e.countcolumn=1]="countcolumn",e[e.sum=2]="sum",e[e.avg=3]="avg",e[e.min=4]="min",e[e.max=5]="max"}(A||(A={}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class U{constructor(e,t,n,r){this._Name=null,this._Alias=null,this._Aggregate=null,this._GroupBy=null,this._set_name(e),this.set_alias(Object(L.a)(t)?"":t),this.set_aggregate(n),this.set_groupBy(r)}_get_name(){return this._Name}_set_name(e){return this._Name=e,e}get_alias(){return this._Alias}set_alias(e){return this._Alias=e,e}get_aggregate(){return this._Aggregate}set_aggregate(e){return this._Aggregate=e,e}get_groupBy(){return this._GroupBy}set_groupBy(e){return this._GroupBy=e,e}toString(){let e='<attribute name="'+this._get_name()+'"';return e+=Object(L.a)(this.get_alias())||Object(L.b)(this.get_alias())?"":' alias="'+this.get_alias()+'"',e+=null!=this.get_aggregate()?' aggregate="'+A[this.get_aggregate()]+'"':"",e+=null!=this.get_groupBy()?' groupby="'+this.get_groupBy().toString()+'"':"",e+=" />",e}}var V=n("SRlt"),z=n("8tWD"),W=n("fYtF"),q=n("sZ+8"),H=n("/Zy9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class G{constructor(){this._wheres=[],this._sorts=[],this._selects=[],this._contextFiltersAndIds=[],this._linkEntities=[],this._isWheresDirty=!1,this._isContextFiltersAndIdsDirty=!1,this._isSortsDirty=!1,this._isSelectsDirty=!1,this._searchString="",this._isQuickFindSearch=!1,this._queryBuilderTelemetryHelper=new W.b}getQueryState(){return this._queryBuilderTelemetryHelper.addOperation("to","getQueryState"),this._queryBuilderTelemetryHelper.addQueryInfoAndSendLog(a.a.toString(this._sourceId),this.entityLogicalName),{expression:null,fetchXml:this.fetchXml,key:this.getKey(),viewId:this._sourceId,wheres:this._wheres,sorts:this._sorts,selects:this._selects,contextFiltersAndIds:this._contextFiltersAndIds,linkEntities:this._linkEntities,offlineSql:this.offlineSql,searchString:this._searchString,isQuickFindSearch:this._isQuickFindSearch,rollupType:this._rollupType,target:this._target}}get pageSize(){return this._query.get_PageSize()}get entityLogicalName(){return this._query.get_EntityLogicalName()}get fetchXml(){return this._query.get_FetchXml()}get offlineSql(){return this._query.get_RawSql()}get queryStatus(){return this._query.queryStatus}set pageSize(e){e&&this._queryBuilderTelemetryHelper.addOperation("setPageSize",e.toString()),this._query.set_PageSize(e)}get pageNumber(){return this._query.get_PageNumber()}set pageNumber(e){e&&this._queryBuilderTelemetryHelper.addOperation("setPageNumber",e.toString()),this._query.set_PageNumber(e)}get pagingCookie(){return this._query.get_PagingCookie()}set pagingCookie(e){this._query.set_PagingCookie(e)}get target(){return this._target}get rollupType(){return this._rollupType}setQuickFindSearch(e){this._searchString=e,this._isQuickFindSearch=!1,this._searchString?(this._isQuickFindSearch=!0,this._queryBuilderTelemetryHelper.addOperation("searchString")):this._searchString=""}_getBaseKey(){return this._sourceId?`${this._query.get_EntityLogicalName()}-${a.a.toString(this._sourceId)}`:this._query.get_EntityLogicalName()}removeFromSelects(e){let t;this._queryBuilderTelemetryHelper.addOperation("removeFromSelects",e),-1!==(t=this._selects.indexOf(e))&&this._selects.splice(t)}hasColumn(e){return-1!==this._selects.indexOf(e)}_sortIfRequired(){this._isWheresDirty&&(this._wheres.sort(),this._isWheresDirty=!1),this._isSortsDirty&&(this._sorts.sort(),this._isSortsDirty=!1),this._isContextFiltersAndIdsDirty&&(this._contextFiltersAndIds.sort(),this._isContextFiltersAndIdsDirty=!1),this._isSelectsDirty&&(this._selects.sort(),this._isSelectsDirty=!1)}getKey(){return this._sortIfRequired(),`${this._getBaseKey()}: ${this._selects}: ${this._wheres}: ${this._sorts}: ${this._contextFiltersAndIds}: ${this._linkEntities}: ${this._isQuickFindSearch}: ${this._searchString}: ${this.pageSize}${this._getRollupKey()}`}getPublicKey(){return this._sortIfRequired(),`${this._getBaseKey()}: ${this._selects}: ${this._sorts}: ${this._contextFiltersAndIds}: ${this._linkEntities}: ${this._isQuickFindSearch}: ${this.pageSize}${this._getRollupKey()}`}getKeyQuery(){return this._queryBuilderTelemetryHelper.addOperation("to","getKeyQuery"),this._queryBuilderTelemetryHelper.addQueryInfoAndSendLog(a.a.toString(this._sourceId),this.entityLogicalName),this._query}orderBy(e,t=!1){const n=this._query.get_SortingInfo();n.addSorter(e,t),this._sorts=[];for(const e of n.get_Sorters())this._sorts.push(e.toString()),this._queryBuilderTelemetryHelper.addOperation("orderBy",e.toString());return this._query.setSortingInfo(n,x.a.get_DefaultInstance().get_MetadataCache()),this._isSortsDirty=!0,this}where(e,t,n){const a=r.a.toLegacyFilterExpression(e,n).toFetchXml();return this._query.setContextFilterAndExtraConditions(null,null,a,null,null,x.a.get_DefaultInstance().get_MetadataCache()),t?this._wheres=[a]:this._wheres.push(a),this._isWheresDirty=!0,this._queryBuilderTelemetryHelper.addOperation("where"),this}select(...e){if(!Object(V.f)(this._query).getAllColumns){const t=this._query.get_ColumnSet().get_Columns().concat(e),n=new M.a(t);this._query.set_ColumnSet(n);const r=[];for(let t=0;t<e.length;t++)-1===this._selects.indexOf(e[t])&&r.push(e[t]);this._query.setExtraAttributes(r),this._selects.push(...r)}return this._isSelectsDirty=!0,this._queryBuilderTelemetryHelper.addOperation("select",e.toString()),this}addChildCountAttribute(e){return this._query.addChildCountAttribute(e),this._queryBuilderTelemetryHelper.addOperation("addChildCountAttribute",e),this}validateLinkedEntity(e,t){e&&!Object(q.l)(e,t.name)&&this.queryStatus.push({failed:!0,offlineModeSpecific:!0,message:G._LinkedEntityNotAvailableOffline,parameter:t.name})}addLinkedEntity(e,t){const n=new B(e.name,e.from,e.to,e.linkType,e.alias),r=n.get_attributes();for(const e of t){const t=new U(e);r.push(t)}n.set_attributes(r);const a=n.getFetchXMLString();return-1===this._linkEntities.indexOf(a)&&(this._query.setContextFilterAndExtraConditions(null,null,null,null,a,x.a.get_DefaultInstance().get_MetadataCache()),this._linkEntities.push(a)),this._queryBuilderTelemetryHelper.addOperation("addLinkedEntity",a),this}applyContextFilter(e,t,n,r=D.a.Referencing){const i=this._query.get_EntityLogicalName(),o=Object(H.b)(e,i,r,n),s=a.a.toString(t);return this._query.setContextFilterAndExtraConditions(s,o,null,null,null,x.a.get_DefaultInstance().get_MetadataCache()),this.addExistingContextFilterToKey(s,o),this._queryBuilderTelemetryHelper.addOperation("applyContextFilter",`${s}=${o}`),this}addExistingContextFilterToKey(e,t){this._contextFiltersAndIds.push(`${e}=${t}`),this._isContextFiltersAndIdsDirty=!0}static fromState(e,t){const n=G.fromXmlAndSql(e.fetchXml,e.offlineSql,e.viewId,e.searchString,e.viewPrimaryEntityName,t);n._queryBuilderTelemetryHelper.addOperation("from","fromState"),n._wheres=e.wheres,n._sorts=e.sorts,n._contextFiltersAndIds=e.contextFiltersAndIds,n._selects=e.selects,n._linkEntities=e.linkEntities,n._rollupType=e.rollupType,n._target=e.target,n._searchString=e.searchString,n._isQuickFindSearch=e.isQuickFindSearch;const r=n._query.get_SortingInfo();for(const t of e.sorts){const e=t.split("="),n=e[0].trim(),a=e[1].trim();r.addSorter(n,"true"===a)}return n._query.set_OverrideKey(n.getKey()),n._query.set_PublicKey(n.getPublicKey()),n}static fromXmlAndSql(e,t,n,r,i,o){const s=n&&a.a.toString(n),c=new k.a;if(c.updateDescriptorSet(z.a.FetchXml,e),t&&c.updateDescriptorSet(z.a.Sql,t),r){const e=new F.a(c,r,[i],s,o),n=e.getUpdatedSql(),a=e.getUpdatedFetchXml();c.updateDescriptorSet(z.a.FetchXml,a),t&&c.updateDescriptorSet(z.a.Sql,n)}const l=new G;return l._sourceId=n,l._query=new R.a(c,s),l._query.get_ColumnSet()||l._query.set_ColumnSet(new M.a([])),l._query.get_PageSize()||l._query.set_PageSize(G.defaultPageSize),l._query.get_PageNumber()||l._query.set_PageNumber(1),t&&i&&o&&"function"==typeof o&&(Object(q.l)(o(),i)||l.queryStatus.push({failed:!0,offlineModeSpecific:!0,message:G._MainEntityNotAvailableOffline,parameter:i}),c.updateDescriptorSet(z.a.Sql,t)),l._queryBuilderTelemetryHelper.addOperation("from","fromXmlAndSql"),r&&l._queryBuilderTelemetryHelper.addOperation("searchString"),l}static fromXml(e,t){const n=t&&a.a.toString(t),r=new G;return r._sourceId=t,r._query=new R.a(e,n),r._query.get_PageSize()||r._query.set_PageSize(G.defaultPageSize),r._query.get_PageNumber()||r._query.set_PageNumber(1),r._queryBuilderTelemetryHelper.addOperation("from","fromXml"),r}static getSortsFromXml(e,t){if(e){const n=G.fromXml(e,t);if(n){n._query.setSortingInfo(null);const e=n._query.get_SortingInfo();if(e){n._sorts||(n._sorts=[]);for(const t of e.get_Sorters())t&&n._sorts.push(t.toString());n._sorts.sort()}const t=n.getQueryState();if(t)return t.sorts}}return[]}static get defaultPageSize(){return 25}setDefaultPageSize(){this.pageSize=G.defaultPageSize}applyRollupContextFilter(e,t){this._target=e,this._rollupType=t,this._query.set_OverrideKey(this.getKey()),e&&this._queryBuilderTelemetryHelper.addOperation("applyRollupContextFilter",`${i.a.toString(e)}=${t}`)}toQueryExpression(e,t){return this._queryBuilderTelemetryHelper.addOperation("to","toQueryExpression"),this._queryBuilderTelemetryHelper.addQueryInfoAndSendLog(a.a.toString(this._sourceId),this.entityLogicalName),y(this.fetchXml,e,t)}containsError(){return this.queryStatus.some(e=>e.failed)}getErrors(){return this.queryStatus.filter(e=>e.failed)}getFirstError(){return this.queryStatus.find(e=>e.failed)}_getRollupKey(){return null!==this._rollupType&&void 0!==this._rollupType&&this._target?`: ${this._rollupType}: ${i.a.toString(this._target)}`:""}}G._LinkedEntityNotAvailableOffline="Error.LinkedEntity.NotAvailable.Offline",G._MainEntityNotAvailableOffline="Error.MainEntity.NotAvailable.Offline"},vONk:function(e,t,n){"use strict";n.d(t,"a",(function(){return se}));var r=n("umme"),a=n("84PK"),i=n("504W"),o=n("dzep");var s,c=n("VA/h"),l=n("l3Ef"),u=n("03Hu"),d=n("Q7Xa"),p=n("FZk4");!function(e){e[e.conflict=0]="conflict",e[e.recordNotFound=1]="recordNotFound",e[e.recordAlreadyExists=2]="recordAlreadyExists",e[e.others=3]="others"}(s||(s={}));var g=n("3ri3"),h=n("HYaY"),f=n("WRF3"),m=n("IvgJ"),b=n("sdkC"),_=n("T544"),y=n("jZCH"),v=n("JPoD"),S=n("EW4s");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function O(e,t,n,r,o,c,u,d,p,O,C,E){const I=new S.a,w=function(e){let t;switch(e){case-2147220969:t=s.recordNotFound;break;case-2147220685:case-2147220937:t=s.recordAlreadyExists;break;case-2147088254:case-2147088253:t=0;break;default:t=s.others}return t}(O),j=w!==s.recordNotFound&&t.toLowerCase()!==l.n?new f.a(e,n,r):null,P={},T={},N=new Array(0);N.push(g.U),P[g.U]="string",T[g.U]=e,N.push(g.S),P[g.S]="string",T[g.S]=t,Object(i.a)(j)||(N.push(g.X),P[g.X]="lookup",T[g.X]=j,N.push(g.Z),P[g.Z]="string",T[g.Z]=r,N.push(g.Y),P[g.Y]="entityname",T[g.Y]=o),N.push(g.T),P[g.T]="string",T[g.T]=u,N.push(g.W),P[g.W]="datetime",T[g.W]=d,N.push(g.bb),P[g.bb]="string",T[g.bb]=p,N.push(g.P),P[g.P]="string",T[g.P]=O.toString();const A={};A[l.Z]=w,N.push(g.R),P[g.R]="picklist",T[g.R]=m.a.createFromObjectData(A),N.push(g.V),P[g.V]="string",N.push(g.Q),P[g.Q]="string";const D={};return D[g.V]=c,D[g.Q]=C,function(e){const t=new S.a,n=new _.a(v.k,Object.keys(e));return y.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(n,null).then(n=>{for(const t of n){const n=e[t.get_logicalName()];!Object(i.a)(t)&&!Object(i.a)(n)&&n.length>t.get_maxLength()&&(e[t.get_logicalName()]=n.substring(0,t.get_maxLength()))}t.resolve(e)},e=>{t.reject(e)}),t}(D).then(e=>{for(const t in e)T[t]=e[t];let t=E;Object(i.a)(t)&&(t=new f.a(v.k,a.a.newGuid())),I.resolve(new h.a(t,T,P,{},{},new b.a(new Array(0))))},e=>{T[g.Q]="Empty Error details as RetreiveAttributeMetadata failed for UpSyncConstants.SyncErrorErrorDetail",T[g.V]="Empty Error message as RetreiveAttributeMetadata failed for UpSyncConstants.SyncErrorLogErrorMessage";let t=E;Object(i.a)(t)&&(t=new f.a(v.k,a.a.newGuid())),I.resolve(new h.a(t,T,P,{},{},new b.a(new Array(0))))}),I}var C,E=n("1nJ/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.draft=0]="draft",e[e.inProgress=1]="inProgress",e[e.completed=2]="completed",e[e.failed=3]="failed"}(C||(C={}));var I=n("DijY"),w=n("pHbk"),j=n("3fL6"),P=n("thzq"),T=n("jqlv"),N=n("MUIu"),A=n("31Vn");class D{constructor(e){this._NorSyncLogHelper=null,this._set_NorSyncLogHelper(e)}_get_NorSyncLogHelper(){return this._NorSyncLogHelper}_set_NorSyncLogHelper(e){return this._NorSyncLogHelper=e,e}handle(e,t){Object(T.j)("OfflineUpSync.RollBackHandler.Handle.Start","Rollback of failed command started");const n=new S.a;return e.get_commandType()?this._RollbackNonCRUDCommand(e).always(()=>{this._AddRecordSyncErrorLog(e,t).then(e=>{Object(T.j)("OfflineUpSync.RollBackHandler.Handle.Success","Rollback of failed Non-CRUD command succeeded"),E.a.IncrementSyncErrorsCount(),n.resolve(e)},e=>{Object(T.k)("OfflineUpSync.RollBackHandler.Handle.Failure",e.get_Message()),n.reject(e)})}):this._RollbackCRUDCommand(e).always(()=>{this._AddRecordSyncErrorLog(e,t).then(e=>{Object(T.j)("OfflineUpSync.RollBackHandler.Handle.Success","Rollback of failed CUD command succeeded"),E.a.IncrementSyncErrorsCount(),n.resolve(e)},e=>{Object(T.k)("OfflineUpSync.RollBackHandler.Handle.Failure",e.get_Message()),n.reject(e)})}),n}_RollbackCRUDCommand(e){const t=new S.a,n=[],r=[];if(r.push(this._RollbackOperation(e.get_associatedEntityLog(),e.get_entityRecord().get_identifier().LogicalName,e.get_sqlOperation())),!Object(i.a)(e.get_associatedActivityParties())&&e.get_associatedActivityParties().length>0)for(const t of e.get_associatedActivityParties())r.push(this._RollbackOperation(t.get_associatedEntityLog(),l.d,t.get_sqlOperation()));return Object(c.a)(r).then(e=>{Object(i.a)(e)||(n.push(...e),this._get_NorSyncLogHelper().performOperations(n,null,!0).then(()=>{t.resolve(!0)},e=>{t.reject(e)}))},e=>{t.reject(e)}),t}_RollbackNonCRUDCommand(e){const t=new S.a,n=e.get_command(),r=e.get_associatedCommandMainLogs(),a=e.get_associatedCommandEntityLogs(),o=[],s=[],l=[];for(let e=r.length-1;e>=0;e--){const t=r[e],n=a[t.get_SID().toString()],i=Object(T.c)(t);l.push(this._RollbackOperation(n,i,t.get_operationType()))}return Object(c.a)(l).then(e=>{for(const t of e)Object(i.a)(t)||o.push(t);const r=this._get_NorSyncLogHelper().updateCommandStatus(n,C.failed);Object(i.a)(r)||s.push(r),this._get_NorSyncLogHelper().performOperations(o,s,!0).then(()=>{t.resolve(!0)},e=>{t.reject(e)})},e=>{t.reject(e)}),t}_AddRecordSyncErrorLog(e,t){Object(T.j)("OfflineUpSync.RollBackHandler._AddRecordSyncErrorLog.Start","Sync Error Creation Started");const n=new S.a;if(!e.get_commandType())return this._CreateSyncErrorLog(e,t);const r=e,i=r.get_command();let o="",s=a.a.get_empty();if(e.get_commandType()===I.a.changeProcessAndStage){const e=JSON.parse(i.get_actionData());o=e[g.t].toString(),s=a.a.tryCreate(e[g.s].toString()),y.a.get_DefaultInstance().retrieveEntityMetadata(o,null).then(e=>{this._CreateSyncErrorRecordAndLog(o,i.get_name(),s,o,e.get_logicalName(),t.get_message(),"",t.get_errorTime(),"",t.get_errorCode(),t.get_errorDetail()).then(()=>{Object(T.j)("OfflineUpSync.RollBackHandler._AddRecordSyncErrorLog.Success","Sync Error Creation Succeeded"),n.resolve(!0)},e=>{Object(T.k)("OfflineUpSync.RollBackHandler._AddRecordSyncErrorLog.Fail",e.get_Message()),n.reject(e)})},e=>{Object(T.k)("OfflineUpSync.RollBackHandler._AddRecordSyncErrorLog.Fail: RetrieveEntityMetadata Fail",e.get_Message()),n.reject(e)})}else{const e=r.get_associatedCommandMainLogs()[r.get_associatedCommandMainLogs().length-1],c=r.get_associatedCommandEntityLogs()[e.get_SID().toString()];o=Object(T.c)(e),y.a.get_DefaultInstance().retrieveEntityMetadata(o,null).then(e=>{s=a.a.tryCreate(c[e.get_primaryIdAttribute()].toString()),this._CreateSyncErrorRecordAndLog(o,i.get_name(),s,o,e.get_logicalName(),t.get_message(),"",t.get_errorTime(),"",t.get_errorCode(),t.get_errorDetail()).then(()=>{Object(T.j)("OfflineUpSync.RollBackHandler._AddRecordSyncErrorLog.Success","Sync Error Creation Succeeded"),n.resolve(!0)},e=>{Object(T.k)("OfflineUpSync.RollBackHandler._AddRecordSyncErrorLog.Fail",e.get_Message()),n.reject(e)})},e=>{Object(T.k)("OfflineUpSync.RollBackHandler._AddRecordSyncErrorLog.Fail: RetrieveEntityMetadata Fail",e.get_Message()),n.reject(e)})}return n}_CreateSyncErrorRecordAndLog(e,t,n,r,a,i,o,s,c,l,u){const d=new S.a;return O(e,t,n,r,a,i,o,s,"",l,u).then(e=>{w.a.get_instance().createSyncErrorLog(e,null).then(()=>{Object(T.j)("OfflineUpSync.RollBackHandler._AddRecordSyncErrorLog.Success","Sync Error Creation Succeeded"),d.resolve(!0)},e=>{Object(T.k)("OfflineUpSync.RollBackHandler._AddRecordSyncErrorLog.Fail: CreateSyncErrorLog Fail",e.get_Message()),d.reject(e)})},e=>{d.reject(e)}),d}_CreateSyncErrorLog(e,t){const n=new S.a,r=Object(T.i)(e.get_associatedMainLog()),a=Object(T.d)(r);return y.a.get_DefaultInstance().retrieveEntityMetadata(a,null).then(r=>{const o=e.get_entityRecord(),s=o.get_identifier().Id;if(Object(i.a)(o))n.resolve(!1);else{const c=!!r&&(r.get_isActivity()||a===l.d),u=e.get_sqlOperation();D._CreateActionData(o,a,P.a[u]).then(l=>{this._CreateRequestData(o,r,s.toString(),u).then(d=>{if(d=this._IsRequestDataRequired(u)?d:null,c){const t=this._GetActivityPartySyncErrorDetails(e,u,r);if(Object(i.a)(t.ActivityPartyActionData)||(l+=t.ActivityPartyActionData),this._IsRequestDataRequired(u)&&!Object(i.a)(t.ActivityPartyCollection)){const e=JSON.parse(d),n=t.ActivityPartyCollection;for(const t in n){const r={key:t,value:n[t]};e[r.key]=r.value}d=this._ConvertDictionaryToJsonString(e)}}O(a,P.a[u],s,Object(i.a)(o.getValue(r.get_primaryNameAttribute()))?"":o.getValue(r.get_primaryNameAttribute()).toString(),r.get_logicalName(),t.get_message(),l,t.get_errorTime(),d,t.get_errorCode(),t.get_errorDetail()).then(e=>{w.a.get_instance().createSyncErrorLog(e,null).then(()=>{Object(T.k)("OfflineUpSync.RollBackHandler._CreateSyncErrorLog.Success","Sync Error Creation Succeeded"),n.resolve(!0)},e=>{Object(T.k)("OfflineUpSync.RollBackHandler._CreateSyncErrorLog.Fail",e.get_Message()),n.reject(e)})},e=>{n.reject(e)})},e=>{n.reject(e)})},e=>{n.reject(e)})}},e=>{n.reject(e)}),n}_GetActivityPartySyncErrorDetails(e,t,n){const r=e.get_associatedActivityParties(),a=new Sys.StringBuilder,o={},s={},c=e.get_entityRecord();for(const e of r){const r=e.get_associatedMainLog(),o=e.get_entityRecord();if(!n.get_isActivity()||t!==P.a.Create||!this._IsOwnerActivityParty(o)){if(c.hasField(l.c)){const e=o.getValue(l.c),t=c.getValue(l.c);e.Id.toString()===t.toString()&&a.appendLine(this._GetActivityPartyData(o))}if(this._IsRequestDataRequired(t)&&r.get_operationType()!==P.a.Delete){const e=o.getValue(l.P);if(!Object(i.a)(e)){const t=l.Q[e.get_value().toString()],n=o.getValue(D._PartyIdAttributeName);if(!Object(i.a)(n)){const e=n.getObjectData();Object(i.a)(s[t])&&(s[t]=[]),s[t].push(e)}}}}}return o.ActivityPartyCollection=s,o.ActivityPartyActionData=a.toString(),o}_IsOwnerActivityParty(e){const t=e.getValue(l.P);if(!Object(i.a)(t)){if(l.Q[t.get_value().toString()]===l.N)return!0}return!1}_GetActivityPartyData(e){const t=e.getValue(l.P);if(!Object(i.a)(t)){const n=l.Q[t.get_value().toString()],r=e.getValue(D._PartyIdAttributeName);if(!Object(i.a)(r)){const e=r;return n+D._ActionDataDelimiter+e.Name}}return""}_RollbackOperation(e,t,n){let r=null;const a=new S.a;return n===P.a.Create?this._RollBackCreateOperation(e,t):(n===P.a.Delete?(r=this._RollBackDeleteOperation(e,t),a.resolve(r)):n===P.a.Update&&(r=this._RollBackUpdateOperation(e,t),a.resolve(r)),a)}_RollBackCreateOperation(e,t){const n=new S.a;let r=null;const a=new Array(0);return t===g.m.toLowerCase()?(a[0]=new p.a(g.g,e[g.g].toString(),j.a.Or,0),n.resolve(new d.a(a,P.a.Delete,t))):t===g.b.toLowerCase()?(a[0]=new p.a(g.a,e[g.a].toString(),j.a.Or,0),n.resolve(new d.a(a,P.a.Delete,t))):y.a.get_DefaultInstance().retrieveEntityMetadata(t,null).then(o=>{Object(i.a)(e)||Object(i.a)(o)||(a[0]=new p.a(o.get_primaryIdAttribute(),e[o.get_primaryIdAttribute()].toString(),j.a.Or,0)),r=new d.a(a,P.a.Delete,t),n.resolve(r)},e=>{n.reject(e)}),n}_RollBackUpdateOperation(e,t){let n=null;return Object(i.a)(e)||(e=this._RemoveUnwantedEntityLog(e),n=new d.a(e,P.a.Update,t)),n}_RollBackDeleteOperation(e,t){let n=null;return Object(i.a)(e)||(e=this._RemoveUnwantedEntityLog(e),n=new d.a(e,P.a.Create,t)),n}_RemoveUnwantedEntityLog(e){return delete e[g.E],delete e[g.B],delete e[g.F],delete e[g.C],e}_CreateRequestData(e,t,n,r){const a=new S.a;Object(T.j)("RollbackHandler:CreateRequestData","Started");const o=e.get_changedFieldNames(),s={},c=D._skipColumns,d=t.get_isBPFEntity();r===P.a.Create&&(c.push(t.get_primaryIdAttribute()),s[t.get_primaryIdAttribute()]=n),t.get_isActivity()&&c.push(l.Q[9]),s[l.T]=n,s[l.s]=t.get_logicalName();for(let e=0;e<o.length;e++){const t=o[e];c.indexOf(t)>=0&&o.splice(e,1)}const p=new _.a(t.get_logicalName(),o);return y.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(p,null).then(n=>{for(const a of n)if(!Object(i.a)(a))if(d){const n=JSON.parse(u.a.get_DefaultInstance().get_offlineTypescriptInterface().transformToODataValue(t.get_logicalName(),a.get_logicalName(),e)),r=Object.keys(n)[0];s[r]=n[r].toString()}else if(Object(i.a)(e.getValue(a.get_logicalName())))s[a.get_logicalName()]="";else if("lookup"===a.get_type()||"customer"===a.get_type()||"owner"===a.get_type()){const t=e.getValue(a.get_logicalName()),n=t.getObjectData();n.id=t.get_key(),n.entityType=t.getValue("LogicalName");const r=[];r.push(n),s[a.get_logicalName()]=r}else if("state"!==a.get_type()&&"status"!==a.get_type()&&"picklist"!==a.get_type()&&a.get_type()){if("entityname"===a.get_type()&&r===P.a.Create)continue;"datetime"===a.get_type()?s[a.get_logicalName()]=Object(i.a)(e.getValue(a.get_logicalName()))?"":Object(N.c)(e.getValue(a.get_logicalName())):s[a.get_logicalName()]=e.getValue(a.get_logicalName()).toString()}else{const n=Object(T.h)(r);if(D._ShouldSkipAttribute(t,n,a.get_logicalName()))continue;const i=e.getValue(a.get_logicalName()).get_ValueString();s[a.get_logicalName()]="-1"!==i?i:""}Object(T.j)("RollbackHandler:CreateRequestData","Completed"+s.toString()),a.resolve(this._ConvertDictionaryToJsonString(s))},e=>{a.reject(e)}),a}_ConvertDictionaryToJsonString(e){return JSON.stringify(e)}_IsRequestDataRequired(e){return e===P.a.Create||e===P.a.Update}static _CreateActionData(e,t,n,r){Object(T.j)("RollbackHandler:CreateActionData","Started");let a=r;!Object(i.a)(a)&&a.length||(a=e.get_changedFieldNames());const o=new S.a;return y.a.get_DefaultInstance().retrieveEntityMetadata(e.get_identifier().LogicalName,null).then(t=>{const r=new _.a(t.get_logicalName(),a);y.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(r,null).then(r=>{let a="",s="";for(const o of r)if(!Object(i.a)(o)&&"uniqueidentifier"!==o.get_type()){const r=o.get_displayName(),c=o.get_logicalName(),u=e.getValue(c);if(Object(i.a)(u))a+=`${r}${D._ActionDataDelimiter}/n`,s+=`${c}${D._ActionDataDelimiter}/n`;else if("lookup"===o.get_type()||"customer"===o.get_type()||"owner"===o.get_type()){const e=u.Name,t=Object(A.b)(e);a+=`${r}${D._ActionDataDelimiter}${e}/n`,s+=`${c}${D._ActionDataDelimiter}${t}/n`}else if("state"!==o.get_type()&&"status"!==o.get_type()&&"picklist"!==o.get_type()&&o.get_type()){if("entityname"===o.get_type()&&n===l.n)continue;if("datetime"===o.get_type()){const e=Object(i.a)(u)?"":Object(N.c)(u);a+=`${r}${D._ActionDataDelimiter}${e}/n`,s+=`${c}${D._ActionDataDelimiter}${e}/n`}else{const e=u.toString(),t=Object(A.b)(e);a+=`${r}${D._ActionDataDelimiter}${e}/n`,s+=`${c}${D._ActionDataDelimiter}${t}/n`}}else{if(D._ShouldSkipAttribute(t,n,c))continue;const e=u.get_ValueString(),l="-1"===e||Object(i.a)(o.get_optionSet().get_options()[e])?"":o.get_optionSet().get_options()[e].get_Label();a+=`${r}${D._ActionDataDelimiter}${l}/n`,s+=`${c}${D._ActionDataDelimiter}${l}/n`}}Object(T.j)("RollbackHandler:CreateActionData","Completed"+s),o.resolve(a)},e=>{Object(T.j)("RollbackHandler:CreateActionData","Failure"),Object(T.k)("RollbackHandler: CreateActionData Failure",e.get_Message()),o.resolve("")})},e=>{o.reject(e)}),o}static _ShouldSkipAttribute(e,t,n){return!(Object(i.a)(e)||t.toLowerCase()!==l.n||!(e.get_isActivity()&&n===l.C||e.get_isCustomEntity()&&n===l.W))}}D._skipColumns=[g.db,g.O,g.I],D._PartyIdAttributeName="partyid",D._ActionDataDelimiter=" - ";var R=n("WWG3");class x{constructor(e){this._norSyncLogHelper=null,this._norSyncLogHelper=e}handle(e,t){const n=new S.a;if(e.get_commandType()){const t=e.get_command();if(Object(i.a)(t))n.resolve(!1);else{const e=[],r=this._norSyncLogHelper.updateCommandStatus(t,C.completed);e.push(r),this._norSyncLogHelper.performOperations(null,e,!0).then(e=>{this._SetLastSuccessfulSaveOnCrmKey(),n.resolve(!0)},e=>{n.reject(e)})}}else this._SetLastSuccessfulSaveOnCrmKey(),n.resolve(!0);return n}_SetLastSuccessfulSaveOnCrmKey(){const e=new Date,t={};t[g.u]=R.a.get_instance().formatShortDateTimeValue(e,0),w.a.get_instance().saveOfflineErrorState(g.u,t)}}class M{constructor(e,t,n){this._entityName=null,this._id=null,this._actionType=null,this._entityName=e,this._id=t,this._actionType=Object(T.h)(n)}getObjectData(){const e={};return e.EntityName=this._entityName,e.Id=this._id,e.ActionType=this._actionType,e}}class F{constructor(e,t,n){this._errorMessage=null,this._errorCode=0,this._isFaulted=!1,this._requestIndex=0,this._errorMessage=e,this._errorCode=t,this._requestIndex=n,this._isFaulted=!0}getObjectData(){const e={};return e.IsFaulted=this._isFaulted,e.RequestIndex=this._requestIndex,e.ErrorMessage=this._errorMessage,e.ErrorCode=this._errorCode,e}}var k=n("QFtu"),L=n("rWW8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class B extends L.a{constructor(e,t,n){super(e,t),this.requestId=n}RequestId(){return this.requestId}toString(){return"["+this.get_callerName()+"]"}}var U=n("NMtn"),V=n("6zk2"),z=n("GD3x"),W=n("Xe7f"),q=n("qK01"),H=n("hirD"),G=n("PF3G");function K(e,t){const n=new S.a;let r=null;return y.a.get_DefaultInstance().retrieveEntityMetadata(e.get_identifier().LogicalName,null).then(a=>{const o=a;switch(t){case P.a.Update:r=new G.a(e),!Object(i.a)(o)&&o.get_isOptimisticConcurrencyEnabled()&&u.a.get_DefaultInstance().get_offlineTypescriptInterface().getIsConflictDetectionEnabledForMobileClient()&&r.set_concurrencyBehavior(V.a.IfRowVersionMatches),r.set_returnRowVersion(!0),r.offlineData={[a.get_primaryIdAttribute()]:e.get_identifier().Id.toString()};break;case P.a.Delete:r=new q.a(e.get_identifier()),!Object(i.a)(o)&&o.get_isOptimisticConcurrencyEnabled()&&y.a.get_DefaultInstance().get_UserContext().get_organizationSettings().get_isConflictDetectionEnabledForMobileClient()&&r.set_concurrencyBehavior(V.a.IfRowVersionMatches),r.offlineData={[a.get_primaryIdAttribute()]:e.get_identifier().Id.toString()};break;case P.a.Create:r=new W.a(e),r.offlineData={[a.get_primaryIdAttribute()]:e.get_identifier().Id.toString()},r.set_returnRowVersion(!0)}n.resolve(r)},e=>{n.reject(e)}),n}var Q=n("XvL5"),X=n("eruq"),Y=n("jYot"),J=n("Jz2d"),$=n("v3UX");function Z(e,t,n){const r=new S.a;let a=null;const o=new Q.a([t]),s=new _.a(e,[t]);return y.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(s,null).then(t=>{Object(i.a)(t)||(a=new $.a(new f.a(e,n),o)),r.resolve(a)},e=>{Object(T.j)("OfflineUpSync.NonCRUDRequestBuilder.RetrieveRequestFailed","No Retrieve request"),r.resolve(null)}),r}function ee(e,t,n){const r=new S.a;switch(e){case 0:return function(e,t){Object(U.b)(e,g.q);const n=new S.a,r=[];let a=null;const i=[];for(const t of e){const e=t;i.push(K(e.get_entityRecord(),e.get_sqlOperation()))}return Object(c.a)(i).then(e=>{r.push(...e),a=new H.a(r,new z.a(t,!0)),n.resolve(a)},e=>{n.reject(e)}),n}(t,n);case I.a.nonCrud:return function(e){const t=new S.a,n=e.get_command().get_actionData(),r=e.get_command().get_name(),o=[];Object(U.b)(r,g.e),Object(U.b)(n,g.r);const s=e.get_entitiesInCommand(),u=y.a.get_DefaultInstance().get_ServerUri(),d=new J.a(u,y.a.get_DefaultInstance().get_RemoteCallRetryHandler()),p=[],h=Object(X.b)(d.createCrmExecuteRequestBody(r,r,n)),f=Object(X.a)(h);Object(Y.a)(f);const m=Object(Y.c)(f,r),b=f.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='OfflineData']/b:value");if(!Object(i.a)(b)){const e={},t=b.get_domParserElement();if(!Object(i.a)(t)){for(let n=0,r=t.childNodes.length;n<r;n++)e[t.childNodes[n].childNodes[0].textContent]=t.childNodes[n].childNodes[1].textContent;m.offlineData=e}}p.push(m);let _=null;for(const e of Object.keys(s))o.push(Z(s[e],l.bb,new a.a(e)));return Object(c.a)(o).then(e=>{for(const t of e)Object(i.a)(t)||p.push(t);_=new H.a(p,new z.a(!0,!0)),t.resolve(_)},e=>{t.reject(e)}),t}(t[0]);default:r.resolve(null)}return r}var te=n("JdSN"),ne=n("SRlt");class re{constructor(){this._proxy=null}get_proxy(){if(!this._proxy){const e=y.a.get_DefaultInstance().get_ServerUri();this._proxy=new J.a(e,y.a.get_DefaultInstance().get_RemoteCallRetryHandler())}return this._proxy}upSync(e,t,n,r){const i=new S.a;return ee(e,t,!n).then(e=>{const t=a.a.newGuid().toString();Object(o.a)(r,ne.c.CLIENT_REQUEST_ID,t),n?y.a.get_DefaultInstance().execute(e,new B("","MobileClient-OfflineSync",t)).then(e=>{i.resolve(e)},e=>{Object(o.a)(r,k.e,e.get_Message()),u.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentError("Offline.Upsync","Upsync.Failure.Cud",r);const t=new te.a(null,"",e.get_Message());i.reject(t)}):this.get_proxy().Execute(e,new B("","MobileClient-OfflineSync",t)).then(e=>{i.resolve(e)},e=>{Object(o.a)(r,k.e,e.get_message()),u.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn("Offline.Upsync","Upsync.Failure.Cud",r),i.reject(e)})},e=>{i.reject(te.a.fromErrorCode(e.get_ErrorCode()))}),i}upSyncJson(e){const t=JSON.parse(e[0].get_command().get_actionData());return Object(i.a)(t)?null:this.get_proxy().changeProcessAndStage(t[g.s].toString(),t[g.t].toString(),t[g.I].toString(),t[g.O].toString(),t[g.db].toString())}static get_instance(){return re._defaultInstance||(re._defaultInstance=new re),re._defaultInstance}}re._defaultInstance=null;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class ae{constructor(){this._Message=null,this._ErrorDetail=null,this._ErrorCode=0,this._ErrorTime=null}get_message(){return this._Message}set_message(e){return this._Message=e,e}get_errorDetail(){return this._ErrorDetail}set_errorDetail(e){return this._ErrorDetail=e,e}get_errorCode(){return this._ErrorCode}set_errorCode(e){return this._ErrorCode=e,e}get_errorTime(){return this._ErrorTime}set_errorTime(e){return this._ErrorTime=e,e}}var ie=n("wMH2"),oe=n("RiLc");class se{constructor(e){this._NorSyncLogHelper=null,this._ActionDataList=null,this._RowVersionMap=null,this._syncErrorRetryLimit=3,this._SidToDelete=null,this._CommandId=null,this._StartTransaction=!1,this._EndTransaction=!1,this._SyncErrorSid=null,this._EntityLogTables=null,this._PlaybackQueue=null,this._HasNetworkIssueDuringUpsync=!1,this._entityReferenceMap={},this._set_NorSyncLogHelper(e),this._set_hasNetworkIssueDuringUpsync(!1),this._set_ActionDataList([]),this.set_playbackQueue([]),this._set_RowVersionMap({}),this._set_SidToDelete([]),this._set_SyncErrorSid([]),this._set_EntityLogTables([]),this._set_CommandId(a.a.get_empty()),this._set_StartTransaction(!1),this._set_EndTransaction(!1)}static get_OverallSyncErrorMessage(){return this._overallSyncErrorMessage}static set_OverallSyncErrorMessage(e){this._overallSyncErrorMessage=e}_get_NorSyncLogHelper(){return this._NorSyncLogHelper}_set_NorSyncLogHelper(e){return this._NorSyncLogHelper=e,e}_get_ActionDataList(){return this._ActionDataList}_set_ActionDataList(e){return this._ActionDataList=e,e}_get_RowVersionMap(){return this._RowVersionMap}_set_RowVersionMap(e){return this._RowVersionMap=e,e}_get_SidToDelete(){return this._SidToDelete}_set_SidToDelete(e){return this._SidToDelete=e,e}_get_CommandId(){return this._CommandId}_set_CommandId(e){return this._CommandId=e,e}_get_StartTransaction(){return this._StartTransaction}_set_StartTransaction(e){return this._StartTransaction=e,e}_get_EndTransaction(){return this._EndTransaction}_set_EndTransaction(e){return this._EndTransaction=e,e}_get_SyncErrorSid(){return this._SyncErrorSid}_set_SyncErrorSid(e){return this._SyncErrorSid=e,e}_get_EntityLogTables(){return this._EntityLogTables}_set_EntityLogTables(e){return this._EntityLogTables=e,e}get_playbackQueue(){return this._PlaybackQueue}set_playbackQueue(e){return this._PlaybackQueue=e,e}get_hasNetworkIssueDuringUpsync(){return this._HasNetworkIssueDuringUpsync}_set_hasNetworkIssueDuringUpsync(e){return this._HasNetworkIssueDuringUpsync=e,e}processBatchForUpSync(){const e=new S.a;if(this.get_hasNetworkIssueDuringUpsync())Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessBatchForUpSync.NetworkFailure","ProcessPlaybackQueue Stopped"),this.set_playbackQueue([]),e.resolve(!1);else if(this.get_playbackQueue().length){const t=this.get_playbackQueue().shift();this._ProcessUpSyncDataList(t,0).then(()=>{t.length>1?u.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentPerformance("Offline: Upsync","Total Number of CRUD Commands for current batch",t.length):1===t.length&&(t[0].get_commandType()?u.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentPerformance("Offline: Upsync","Total Number of Non CRUD Commands for current batch",1):u.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentPerformance("Offline: Upsync","Total Number of CRUD Commands for current batch",1)),Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessBatchForUpSync.Success","BatchItem Processed"),e.resolve(!0)},t=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessBatchForUpSync.Failure",t.get_Message()),e.reject(t)})}else this._get_SidToDelete().length>0&&this._get_NorSyncLogHelper().clearNorSyncLogs(this._get_SidToDelete(),this._get_EntityLogTables(),this._get_CommandId()),this._ProcessActionDataList(!0).then(()=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessBatchForUpSync.Success","ProcessPlaybackQueue Completed"),e.resolve(!0)},t=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessBatchForUpSync.Failure",t.get_Message()),e.reject(t)});return e}_ProcessUpSyncDataList(e,t){const n=new S.a;return Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataList","ProcessUpSyncDataList Started"),Object(i.a)(e)||e.length===t||this.get_hasNetworkIssueDuringUpsync()?(Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataList.Success","ProcessUpSyncDataList Completed"),n.resolve(!0)):this._ProcessUpSyncDataItem(e[t]).then(()=>{this._ProcessUpSyncDataList(e,++t).then(()=>{n.resolve(!0)},e=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataList.Failure",e.get_Message()),n.reject(e)})},e=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataList.Failure",e.get_Message()),n.reject(e)}),n}_ProcessUpSyncDataItem(e){const t=new S.a;return Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Started","ProcessUpSyncDataList Started"),Object(i.a)(e)?(Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Success","ProcessUpSyncDataList Completed"),t.resolve(!0)):this._ExecuteActionDataListIfRequired(e).then(n=>{if(n&&!this.get_hasNetworkIssueDuringUpsync())if(e.get_commandType())if(e.get_commandType()===I.a.transaction){const n=r.a.FromMessage("Invalid Transaction");this._get_StartTransaction()||e.get_associatedMainLog().get_logTableID().toLowerCase()!==g.G.toLowerCase()?this._get_StartTransaction()===this._get_EndTransaction()?(Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Success","ProcessUpSyncDataList Completed"),t.resolve(!0)):(Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Failure",n.get_Message()),t.reject(n)):(this._set_StartTransaction(!0),Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Success","ProcessUpSyncDataList Completed"),t.resolve(!0))}else this._ProcessNonCRUDItem(e).then(()=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Success","ProcessUpSyncDataList Completed"),t.resolve(!0)},e=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Failure",e.get_Message()),t.reject(e)});else this._ProcessCRUDItem(e).then(()=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Success","ProcessUpSyncDataList Completed"),t.resolve(!0)},e=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Failure",e.get_Message()),t.reject(e)});else Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Success","ProcessUpSyncDataList Completed"),t.resolve(!0)},e=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Failure",e.get_Message()),t.reject(e)}),t}_ExecuteActionDataListIfRequired(e){const t=new S.a;Object(T.j)("OfflineUpSync.PlaybackBatchManager._ExecuteActionDataListIfRequired","ExecuteActionDataListIfRequired Started");const n=e.get_associatedMainLog().get_logTableID();if(E.a.get_skipTables().indexOf(n)>=0)Object(T.j)("OfflineUpSync.PlaybackBatchManager._ExecuteActionDataListIfRequired.Success","ExecuteActionDataListIfRequired Completed"),this._AddNorSyncLogtoDelete(e.get_associatedMainLog()),t.resolve(!1);else{if(e.get_commandType()===I.a.transaction)return n===g.H&&this._set_EndTransaction(!0),this._AddNorSyncLogtoDelete(e.get_associatedMainLog()),this._ProcessActionDataList(!0);if(e.get_commandType())return Object(T.j)("OfflineUpSync.PlaybackBatchManager._ExecuteActionDataListIfRequired.Non-CRUDActionEncountered","ExecuteActionDataListIfRequired Completed"),this._ProcessActionDataList(!0);if(Object(T.c)(e.get_associatedMainLog())!==l.d&&this._get_ActionDataList().length===E.a.get_DefaultInstance().get_maxBatchSize()&&!this._get_StartTransaction())return Object(T.j)("OfflineUpSync.PlaybackBatchManager._ExecuteActionDataListIfRequired.Success","ExecuteActionDataListIfRequired Completed"),this._ProcessActionDataList(!0);Object(T.j)("OfflineUpSync.PlaybackBatchManager.CheckActionDataListForExecution.Success","CheckActionDataListForExecution Completed"),t.resolve(!0)}return t}_ProcessCRUDItem(e){Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessCRUDItem","ProcessCRUDItem Started");return e.get_entityRecord().get_identifier().LogicalName===l.d?(Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessCRUDItem.Success","ProcessCRUDItem Completed"),this._HandleActivityParty(e)):(Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessCRUDItem.Success","ProcessCRUDItem Completed"),this._get_ActionDataList().push(e),this._ProcessActionDataList(!1))}_ProcessActionDataList(e){const t=new S.a;return Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessActionDataList","ProcessActionDataList Started"),this._get_ActionDataList().length>0?e&&this._get_StartTransaction()===this._get_EndTransaction()?(Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessActionDataList.Success","CRUD Criteria satisfied for Execution"),this._ExecuteCUDBatch().then(e=>{t.resolve(!0)},e=>{t.reject(e)})):this._get_ActionDataList().length!==E.a.get_DefaultInstance().get_maxBatchSize()||this._get_StartTransaction()?(Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessActionDataList.Success","ProcessActionDataList Completed"),t.resolve(!0)):this._IsLastLogActivity().then(e=>{e?(Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessActionDataList.Success","ProcessActionDataList Completed"),t.resolve(!0)):(Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessActionDataList.Success","CRUD Criteria satisfied for Execution"),this._ExecuteCUDBatch().then(e=>{t.resolve(!0)},e=>{t.reject(e)}))},e=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessActionDataList.Failure","Last Log Activity Fetch Failure"),t.reject(e)}):(Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessActionDataList.Success","ProcessActionDataList Completed"),t.resolve(!0)),t}_ExecuteCUDBatch(){Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessActionDataList.Success","Execution Started");const e=[];return this._ProcessCrudCommandAction(e),this._CommandExecutor(0,e).always(this._HandleCommandAfterExecution())}_ProcessCrudCommandAction(e){const t=[];Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessCrudCommandAction","ProcessCrudCommandAction Started");const n=[];for(let e=0;e<this._get_ActionDataList().length;e++){const r=this._get_ActionDataList()[e];if(!Object(i.a)(r))if(Object(o.b)(n,new M(r.get_entityRecord().get_identifier().LogicalName,r.get_entityRecord().get_key(),r.get_sqlOperation())),t.indexOf(r.get_entityRecord().get_key())>=0)l.bb in r.get_entityRecord().fields&&(delete r.get_entityRecord().fields[l.bb],r.get_sqlOperation()===P.a.Delete&&r.get_entityRecord().get_identifier().set_rowVersion(""));else{const e=r.get_entityRecord().get_key();if(t.push(e),e in this._get_RowVersionMap()){r.get_entityRecord().initializeValue(l.bb,this._get_RowVersionMap()[e].toString(),"string"),r.get_entityRecord().get_identifier().set_rowVersion(this._get_RowVersionMap()[e].toString());const t=r.get_entityRecord().get_changedFieldNames().indexOf(l.bb);t>=0&&r.get_entityRecord().get_changedFieldNames().splice(t,1)}}}Object(o.a)(e,"ActionList",JSON.stringify(n)),Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessCrudCommandAction.Success","ProcessCrudCommandAction Completed")}_IsLastLogActivity(){const e=new S.a,t=this._get_ActionDataList()[this._get_ActionDataList().length-1];if(Object(i.a)(t))e.resolve(!1);else{const n=t.get_entityRecord().get_identifier().LogicalName;y.a.get_DefaultInstance().retrieveEntityMetadata(n,null).then(t=>{!Object(i.a)(t)&&t.get_isActivity()?e.resolve(!0):e.resolve(!1)},t=>{e.reject(t)})}return e}_HandleActivityParty(e){const t=new S.a;if(Object(T.j)("OfflineUpSync.PlaybackBatchManager._HandleActivityParty","HandleActivityParty Started"),this._get_ActionDataList().length)if(e.get_sqlOperation()!==P.a.Delete){const n=this._get_ActionDataList().length-1;if(n>=0&&!Object(i.a)(this._get_ActionDataList()[n])){const r=this._get_ActionDataList()[n];if(!Object(i.a)(r)){const n=r.get_entityRecord(),a=e.get_entityRecord();y.a.get_DefaultInstance().retrieveEntityMetadata(n.get_identifier().LogicalName,null).then(o=>{if(!Object(i.a)(o)&&o.get_isActivity()&&(r.get_associatedActivityParties().push(e),n.hasField(l.c))){const e=a.getValue(l.c),t=n.getValue(l.c);e.Id.toString()===t.toString()&&this._AddActivityPartyToActivity(a,n)}Object(T.j)("OfflineUpSync.PlaybackBatchManager._HandleActivityParty","HandleActivityParty Completed"),t.resolve(!0)},e=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager._HandleActivityParty","HandleActivityParty Failure"),t.reject(e)})}}}else e.get_sqlOperation()===P.a.Delete&&(Object(T.j)("OfflineUpSync.PlaybackBatchManager._HandleActivityParty","HandleActivityParty(Delete) Completed"),t.resolve(!0));else Object(T.j)("OfflineUpSync.PlaybackBatchManager._HandleActivityParty","HandleActivityParty Completed as there are no ActionDataList"),t.resolve(!0);return t}_AddActivityPartyToActivity(e,t){const n=e.getValue(l.P),r=l.Q[n.get_value().toString()];if(!Object(i.b)(r))if(t.hasField(r)&&!Object(i.a)(t.getValue(r))){Object(T.j)("OfflineUpSync.PlaybackBatchManager._AddActivityPartyToActivity","Adding activity part to activity "+t.getValue(l.f));t.getValue(r).add(e)}else t.initializeValue(r,new ie.a([e],!1,1,!1),"partylist"),t.get_changedFieldNames().push(r)}_ProcessNonCRUDItem(e){return Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessNonCRUDItem","ProcessNonCRUDItem Started"),this._get_ActionDataList().push(e),this._CommandExecutor(e.get_commandType(),[]).always(this._HandleCommandAfterExecution())}_CommandExecutor(e,t){const n=new S.a;switch(Object(T.j)("OfflineUpSync.PlaybackBatchManager._CommandExecutor.Success","CommandExecutor Started"),e){case I.a.changeProcessAndStage:re.get_instance().upSyncJson(this._get_ActionDataList()).then(this._HandleSuccssJSonResponse(n),this._HandleCrmErrorResponse(e,n));break;case 0:re.get_instance().upSync(e,this._get_ActionDataList(),this._get_StartTransaction()&&this._get_EndTransaction(),t).then(this._HandleSuccessResponse(e,t,n),this._HandleCrmErrorResponse(e,n));break;case I.a.nonCrud:const r=this._get_ActionDataList()[0];u.a.get_DefaultInstance().get_offlineTypescriptInterface().executeNonCUDODataRequest(r.get_command().get_actionData(),r.get_entitiesInCommand()).then(this.handleSuccessResponseForNonCUD(n),this._HandleCrmErrorResponse(e,n))}return n}_HandleCommandAfterExecution(){return()=>{this._set_CommandId(a.a.get_empty()),this._set_ActionDataList([]),this._set_SidToDelete([]),this._set_EntityLogTables([]),this._set_SyncErrorSid([]),this._get_StartTransaction()&&this._get_EndTransaction()&&(this._set_StartTransaction(!1),this._set_EndTransaction(!1))}}handleSuccessResponseForNonCUD(e){return t=>{this._processSuccessResponseForNonCUD(t).then(t=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager._HandleSuccessResponseForNonCUD.Success","Command Execution succeeded"),t?this._ProcessActionDataListToDelete().then(()=>{e.resolve(!0)},t=>{e.reject(t)}):e.resolve(!1)},t=>{Object(T.k)("OfflineUpSync.PlaybackBatchManager._HandleSuccessResponseForNonCUD.Fail",t.get_Message()),e.reject(t)})}}_processSuccessResponseForNonCUD(e){const t=new S.a;Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponseForNonCUD","ProcessSuccessResponseForNonCUD Started"),this._entityReferenceMap={};const n=[];e.length||(Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponseForNonCUD.Success","Command Execution Succeeded At Server"),t.resolve(!0));let r=!1;for(const t of e)t.ok||(r=!0);if(r){Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponseForNonCUD.ServerFailure","Few Command Execution failed At Server");for(let t=e.length-1;t>=0;t--)Object(i.a)(e[t].ok)||e[t].ok?n.push(this._processSuccessMultipleResponseItemForNonCUD(this._get_ActionDataList(),e[t],t)):n.push(this._HandleErrorResponses(e,n,t))}else{Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponseForNonCUD.Success","Command Execution Succeeded At Server");for(let t=0;t<e.length;t++)n.push(this._processSuccessMultipleResponseItemForNonCUD(this._get_ActionDataList(),e[t],t))}return n.length?Object(c.a)(n).then(()=>{this._ProcessReturnedRowVersions().then(()=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponseForNonCUD.Success","Processing Success Response succeeded"),t.resolve(!0)},e=>{Object(T.k)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponseForNonCUD.Fail",e.get_Message()),t.reject(e)})},e=>{Object(T.k)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponseForNonCUD.Fail",e.get_Message()),t.reject(e)}):t.resolve(!0),t}_HandleErrorResponses(e,t,n){const r=new S.a;return e[n].text().then(e=>{const a=this._BuildUpsyncResponseForNonCUD(oe.b.parseFromJson(e));if(!Object(i.a)(this._get_ActionDataList()[n]))if(this._IsSyncError(this._get_ActionDataList()[n]))this._ManageSyncError(this._get_ActionDataList()[n].get_associatedMainLog().get_SID());else{const e=new D(this._get_NorSyncLogHelper());t.push(e.handle(this._get_ActionDataList()[n],a))}r.resolve(!0)},e=>{Object(T.k)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponseForNonCUD.Fail","Fail while parsing retrieve response "+e),r.resolve(!0)}),r}_processSuccessMultipleResponseItemForNonCUD(e,t,n){const r=new S.a;if(Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItemForNonCUD","ProcessSuccessMultipleResponseItemForNonCUD Started"),n)Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItemForNonCUD.Success","ProcessSuccessMultipleResponseItemForNonCUD Completed"),t.json().then(e=>{if(!Object(i.a)(e)){const t=e[l.J].split(new RegExp("\\#(.*?)\\("))[1],n=u.a.get_DefaultInstance().get_offlineTypescriptInterface().getEntityDictionaryFromPluralName(t)[l.s];y.a.get_DefaultInstance().retrieveEntityMetadata(n,null).then(t=>{const a=e[l.bb],o=e[t.get_primaryIdAttribute()],s=new f.a(n,o,null,a);Object(i.a)(a)||Object(i.a)(o)||(this._entityReferenceMap[o.toString()]=s),r.resolve(!0)},e=>{Object(T.k)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItemForNonCUD.Fail",e.get_Message()),r.reject(e)})}},e=>{r.reject(e)});else{const t=new ae;if(Object(i.a)(e[n])||Object(i.a)(e[n].get_associatedMainLog()))Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItemForNonCUD.Success","Empty Data"),r.resolve(!1);else{const a=e[n].get_associatedMainLog().get_SID();a.toString()in E.a.get_syncErrorRetryCountMap()&&delete E.a.get_syncErrorRetryCountMap()[a.toString()];new x(this._get_NorSyncLogHelper()).handle(e[n],t).then(e=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItemForNonCUD.Success","ProcessSuccessMultipleResponseItem Completed"),r.resolve(!0)},e=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItemForNonCUD.Failure",e.get_Message()),r.reject(e)})}}return r}_ProcessFailureResponseForNonCUD(e){Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessFailureResponseForNonCUD.Start","Processing Failure Response Started");const t=new S.a;if(Object(i.a)(e))Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessFailureResponseForNonCUD.Success","Processing Failure Response succeeded with no response"),t.resolve(!0);else{let n=new ae;n=this._BuildUpsyncResponseForNonCUD(e.get_organizationServiceFault()),Object(i.a)(e.get_error())||(n.set_errorDetail(Object(i.a)(n.get_errorDetail())||Object(i.b)(n.get_errorDetail())?e.get_error():n.get_errorDetail()),n.set_message(Object(i.a)(n.get_message())||Object(i.b)(n.get_message())?e.get_error():n.get_message()));const r=[];for(let e=this._get_ActionDataList().length-1;e>=0;e--)if(this._IsSyncError(this._get_ActionDataList()[e]))this._ManageSyncError(this._get_ActionDataList()[e].get_associatedMainLog().get_SID()),Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessFailureResponse.Warning","One Sync Error Entity Failed to Upsync");else{const t=new D(this._get_NorSyncLogHelper());r.push(t.handle(this._get_ActionDataList()[e],n))}Object(c.a)(r).then(()=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessFailureResponseForNonCUD.Success","Processing Failure Response succeeded"),t.resolve(!0)},e=>{Object(T.k)("OfflineUpSync.PlaybackBatchManager._ProcessFailureResponseForNonCUD.Fail",e.get_Message()),t.reject(e)})}return t}_HandleSuccessResponse(e,t,n){return r=>{this._processSuccessResponse(e,r,t).then(e=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager._HandleSuccessResponse.Success","Command Execution succeeded"),e?this._ProcessActionDataListToDelete().then(()=>{n.resolve(!0)},e=>{n.reject(e)}):n.resolve(!1)},e=>{Object(T.k)("OfflineUpSync.PlaybackBatchManager._HandleSuccessResponse.Fail",e.get_Message()),n.reject(e)})}}_HandleSuccssJSonResponse(e){return t=>{this._processSuccessJsonResponse(t).then(t=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager._HandleSuccssJSonResponse.Success","Command Execution succeeded"),t?this._ProcessActionDataListToDelete().then(()=>{e.resolve(!0)},t=>{e.reject(t)}):e.resolve(!1)},t=>{Object(T.k)("OfflineUpSync.PlaybackBatchManager._HandleSuccssJSonResponse.Fail",t.get_Message()),e.reject(t)})}}_HandleCrmErrorResponse(e,t){return n=>{let a;a=e===I.a.nonCrud?this._ProcessFailureResponseForNonCUD(n):this._processFailureResponse(n),a.then(e=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager._HandleCrmErrorResponse.Success","Command Execution succeeded"),e?this._ProcessActionDataListToDelete().then(()=>{t.resolve(!0)},e=>{t.reject(e)}):t.resolve(!1)},()=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager._HandleCrmErrorResponse.Failure",n.get_message()),t.reject(r.a.FromMessage(n.get_message()))})}}_processFailureResponse(e){Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessFailureResponse.Start","Processing Failure Response Started");const t=new S.a;if(Object(i.a)(e))Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessFailureResponse.Success","Processing Failure Response succeeded with no response"),t.resolve(!0);else if(Object(i.a)(e.get_request())||e.get_request().status&&503!==e.get_request().status){let n=new ae;!Object(i.a)(e.get_request())&&!Object(i.a)(e.get_organizationServiceFault())&&!Object(i.a)(e.get_organizationServiceFault().get_message())&&e.get_organizationServiceFault().get_messages().length>0&&(e.get_organizationServiceFault().get_messages()[0]=e.get_request().responseText),n=this._BuildUpsyncResponse(e.get_organizationServiceFault()),Object(i.a)(e.get_error())||(n.set_errorDetail(Object(i.a)(n.get_errorDetail())||Object(i.b)(n.get_errorDetail())?e.get_error():n.get_errorDetail()),n.set_message(Object(i.a)(n.get_message())||Object(i.b)(n.get_message())?e.get_error():n.get_message()));const r=[];for(let e=this._get_ActionDataList().length-1;e>=0;e--)if(this._IsSyncError(this._get_ActionDataList()[e]))this._ManageSyncError(this._get_ActionDataList()[e].get_associatedMainLog().get_SID()),Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessFailureResponse.Warning","One Sync Error Entity Failed to Upsync");else{const t=new D(this._get_NorSyncLogHelper());r.push(t.handle(this._get_ActionDataList()[e],n))}Object(c.a)(r).then(()=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessFailureResponse.Success","Processing Failure Response succeeded"),t.resolve(!0)},e=>{Object(T.k)("OfflineUpSync.PlaybackBatchManager.ProcessFailureResponse.Fail",e.get_Message()),t.reject(e)})}else Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessFailureResponse.Success","Processing Failure Response succeeded with unknown status"),this._set_hasNetworkIssueDuringUpsync(!0),t.resolve(!1);return t}_processSuccessResponse(e,t,n){const a=new S.a;Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponse","ProcessSuccessResponse Started"),this._entityReferenceMap={};const s=[],l=t,d=l.get_responses().length;Object(o.a)(n,"ResponsesLength",d);const p=[];d||(Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponse.Success","Command Execution Succeeded At Server"),a.resolve(!0));let g=!1;for(const e of l.get_responses())if(!Object(i.a)(e.get_fault())){g=!0;break}if(Object(o.a)(n,"IsFaulted",g),Object(o.a)(n,"IsTransactionBatch",this._get_StartTransaction()&&this._get_EndTransaction()),g||this._get_StartTransaction()&&this._get_EndTransaction()){Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponse.ServerFailure","Few Command Execution failed At Server");for(let t=l.get_responses().length-1;t>=0;t--){const n=l.get_responses()[t];if(!Object(i.a)(n.get_fault())&&!Object(i.a)(n.get_fault().get_messages())&&n.get_fault().get_messages().length>0){const e=this._BuildUpsyncResponse(n.get_fault());if(!Object(i.a)(this._get_ActionDataList()[n.get_requestIndex()])){if(Object(o.b)(p,new F(e.get_message(),e.get_errorCode(),n.get_requestIndex())),this._get_StartTransaction()&&this._get_EndTransaction()){for(let t=0;t<this._get_ActionDataList().length;t++)if(!Object(i.a)(this._get_ActionDataList()[t])){const n=new D(this._get_NorSyncLogHelper());s.push(n.handle(this._get_ActionDataList()[t],e))}break}if(this._IsSyncError(this._get_ActionDataList()[n.get_requestIndex()])){const e=n.get_fault();if(-2147220960===e.get_errorCode()){const t=r.a.fromErrorCodeAndMessage(e.get_errorCode(),e.get_innerFault()?e.get_innerFault().get_message():e.get_message());Object(T.k)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponse.ServerFailure",t.get_Message()),se.set_OverallSyncErrorMessage(t.get_Message())}this._ManageSyncError(this._get_ActionDataList()[n.get_requestIndex()].get_associatedMainLog().get_SID())}else{const t=new D(this._get_NorSyncLogHelper());s.push(t.handle(this._get_ActionDataList()[n.get_requestIndex()],e))}}}else s.push(this._processSuccessMultipleResponseItem(e,this._get_ActionDataList()[n.get_requestIndex()],n))}}else{Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponse.Success","Command Execution Succeeded At Server");for(const t of l.get_responses())s.push(this._processSuccessMultipleResponseItem(e,this._get_ActionDataList()[t.get_requestIndex()],t))}return g&&Object(o.a)(n,"ResponseList",JSON.stringify(p)),u.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn("Offline.Upsync","Upsync.Success.Cud",n),s.length?Object(c.a)(s).then(()=>{this._ProcessReturnedRowVersions().then(()=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponse.Success","Processing Success Response succeeded"),a.resolve(!0)},e=>{Object(T.k)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponse.Fail",e.get_Message()),a.reject(e)})},e=>{Object(T.k)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponse.Fail",e.get_Message()),a.reject(e)}):a.resolve(!0),a}_processSuccessMultipleResponseItem(e,t,n){const r=new S.a;if(Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItem","ProcessSuccessMultipleResponseItem Started"),e===I.a.nonCrud&&"Retrieve"===n.get_response().get_name()){Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItem.Success","ProcessSuccessMultipleResponseItem Completed");const e=n.get_response().get_entity();Object(i.a)(e.get_identifier().get_rowVersion())||(this._entityReferenceMap[e.get_key()]=e.get_identifier()),r.resolve(!0)}else{const a=new ae;if(Object(i.a)(t)||Object(i.a)(t.get_associatedMainLog()))Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItem.Success","Empty Data"),r.resolve(!1);else{const i=t.get_associatedMainLog().get_SID();i.toString()in E.a.get_syncErrorRetryCountMap()&&delete E.a.get_syncErrorRetryCountMap()[i.toString()];new x(this._get_NorSyncLogHelper()).handle(t,a).then(a=>{if(Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItem.Success","ProcessSuccessMultipleResponseItem Completed"),!e&&(t.get_associatedMainLog().get_operationType()===g.p||t.get_associatedMainLog().get_operationType()===g.eb)){if("Create"===n.get_response().get_name()){const e=n.get_response().get_entityReference();this._entityReferenceMap[e.Id.toString()]=e}if("Update"===n.get_response().get_name()){const e=n.get_response().get_entityReference();this._entityReferenceMap[e.Id.toString()]=e}}r.resolve(!0)},e=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItem.Failure",e.get_Message()),r.reject(e)})}}return r}_processSuccessJsonResponse(e){const t=new S.a;Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessJsonResponse","ProcessSuccessJsonResponse Started");const n=this._get_ActionDataList()[0];if(e.get_success())Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessJsonResponse.Success ","Command Execution Succeeded At Server Processed Sucessfully"),t.resolve(!0);else if(Object(i.a)(n.get_associatedMainLog()))Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessJsonResponse.Success ","Command Execution Succeeded At Server Processed Sucessfully"),t.resolve(!1);else{Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessJsonResponse.ServerFailure.Start ","Command Execution Failed At Server Processing Started");const e=new ae;new x(this._get_NorSyncLogHelper()).handle(n,e).then(e=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessJsonResponse.ServerFailure.Success ","Command Execution Failed At Server Processed Sucessfully"),t.resolve(!0)},e=>{Object(T.k)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessJsonResponse.ServerFailure.Fail ",e.get_Message()),t.reject(e)})}return t}_ProcessReturnedRowVersions(){Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessReturnedRowVersions.Start","Process Returned Row Versions Started");const e=[],t=new S.a;Object.keys(this._entityReferenceMap).length||(Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessReturnedRowVersions.Success","Process Returned Row Versions succeeded"),t.resolve(!0));for(const t in this._entityReferenceMap)e.push(this._UpdateRowVersion(t));const n=[];return Object(c.a)(e).then(e=>{for(const t of e)if(!Object(i.a)(t)){const e=t;n.push(...e)}this._get_NorSyncLogHelper().performOperations(n,null,!0).then(()=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessReturnedRowVersions.Success","Updation of Row Version Succeeded"),t.resolve(!0)},e=>{Object(T.k)("OfflineUpSync.PlaybackBatchManager._ProcessReturnedRowVersions.Fail",e.get_Message()),t.reject(e)})},e=>{Object(T.k)("OfflineUpSync.PlaybackBatchManager._ProcessReturnedRowVersions.Fail",e.get_Message()),t.reject(e)}),t}_UpdateRowVersion(e){Object(T.j)("OfflineUpSync.PlaybackBatchManager._UpdateRowVersion.Start","Updation of Row Version started");const t=new S.a,n=this._entityReferenceMap[e];return Object(i.a)(n)||Object(i.a)(n.get_rowVersion())?(Object(T.j)("OfflineUpSync.PlaybackBatchManager._UpdateRowVersion.Success","Updation of Row Version Succeeded"),t.resolve(null)):y.a.get_DefaultInstance().retrieveEntityMetadata(n.LogicalName,null).then(e=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager._UpdateRowVersion.Success","Updation of Row Version Succeeded");const r={};r[l.bb]=n.get_rowVersion(),r[e.get_primaryIdAttribute()]=n.get_identifier(),this._get_RowVersionMap()[n.get_key()]=n.get_rowVersion();const a=[new d.a(r,P.a.Update,n.LogicalName),new d.a(r,P.a.Update,g.A+n.LogicalName)];t.resolve(a)},e=>{Object(T.k)("OfflineUpSync.PlaybackBatchManager._UpdateRowVersion.Fail",e.get_Message()),t.reject(e)}),t}_BuildUpsyncResponse(e){const t=new ae;if(t.set_errorDetail(Object(i.a)(e)||Object(i.a)(e.get_responseXml())?"":e.get_responseXml().get_outerXml()),Object(i.a)(e)||Object(i.a)(e.get_messages()))t.set_message(""),t.set_errorTime(new Date);else{const n=Sys.Net.XMLDOM(e.get_messages()[0]);if(n){const r=Object(X.a)(n);r.addNamespace("d","http://schemas.microsoft.com/xrm/2011/Contracts/Services"),r.addNamespace("a","http://schemas.microsoft.com/xrm/2011/Contracts"),r.addNamespace("b","http://schemas.datacontract.org/2004/07/System.Collections.Generic"),r.addNamespace("c","http://schemas.microsoft.com/xrm/2012/Contracts"),r.addNamespace("i","http://www.w3.org/2001/XMLSchema-instance"),t.set_errorCode(Object(i.a)(r.selectSingleNode(".//a:ErrorCode"))?Object(i.a)(e.get_errorCode())?-1:e.get_errorCode():Number.parseInvariant(r.selectSingleNode(".//a:ErrorCode").get_innerText())),t.set_message(Object(i.a)(r.selectSingleNode(".//a:Message"))?Object(i.b)(e.get_message())?"":e.get_message():r.selectSingleNode(".//a:Message").get_innerText());const a=Object(i.a)(r.selectSingleNode(".//a:Timestamp"))?"":r.selectSingleNode(".//a:Timestamp").get_innerText(),o=Object(i.b)(a)?new Date:new Date(Date.parse(a.toString()));t.set_errorTime(o)}else t.set_message(e.get_message()),t.set_errorTime(new Date)}return t}_BuildUpsyncResponseForNonCUD(e){const t=new ae;return t.set_errorDetail(Object(i.a)(e)||Object(i.a)(e.get_responseText())?"":e.get_responseText()),Object(i.a)(e)||Object(i.a)(e.get_messages())?(t.set_message(""),t.set_errorTime(new Date)):(t.set_errorCode(Object(i.a)(e.get_errorCode())?-1:e.get_errorCode()),t.set_message(Object(i.b)(e.get_message())?"":e.get_message()),t.set_errorTime(new Date)),t}_ProcessActionDataListToDelete(){const e=new S.a;Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessActionDataListToDelete","ProcessActionDataListToDelete Started");for(const e of this._get_ActionDataList())switch(e.get_commandType()){case 0:this._ProcessCRUDItemForDelete(e);break;case I.a.changeProcessAndStage:case I.a.nonCrud:this._ProcessNonCRUDItemForDelete(e);break;case I.a.transaction:this._AddNorSyncLogtoDelete(e.get_associatedMainLog())}return this._get_NorSyncLogHelper().clearNorSyncLogs(this._get_SidToDelete(),this._get_EntityLogTables(),this._get_CommandId()).then(()=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessActionDataListToDelete.Success","ProcessActionDataListToDelete Completed"),e.resolve(!0)},t=>{Object(T.j)("OfflineUpSync.PlaybackBatchManager._ProcessActionDataListToDelete.Failure","ProcessActionDataListToDelete Failed"),e.reject(t)}),e}_ProcessCRUDItemForDelete(e){if(this._AddNorSyncLogtoDelete(e.get_associatedMainLog()),!Object(i.a)(e.get_associatedActivityParties()))for(const t of e.get_associatedActivityParties())Object(i.a)(t)||this._AddNorSyncLogtoDelete(t.get_associatedMainLog())}_ProcessNonCRUDItemForDelete(e){if(this._AddNorSyncLogtoDelete(e.get_associatedMainLog()),!Object(i.a)(e.get_associatedCommandMainLogs())){this._set_CommandId(e.get_commandId());for(const t of e.get_associatedCommandMainLogs())this._AddNorSyncLogtoDelete(t)}}_AddNorSyncLogtoDelete(e){if(!Object(i.a)(e)&&this._get_SyncErrorSid().indexOf(e.get_SID())<0){this._get_SidToDelete().push(e.get_SID());const t=e.get_logTableID().toLowerCase()===g.G.toLowerCase()||e.get_logTableID().toLowerCase()===g.H.toLowerCase();this._get_EntityLogTables().indexOf(e.get_logTableID())<0&&!t&&this._get_EntityLogTables().push(e.get_logTableID())}}_IsSyncError(e){return!Object(i.a)(e)&&!Object(i.a)(e.get_associatedMainLog())&&Object(T.i)(e.get_associatedMainLog())===g.ab}_ManageSyncError(e){let t=e.toString()in E.a.get_syncErrorRetryCountMap()?E.a.get_syncErrorRetryCountMap()[e.toString()]:this._syncErrorRetryLimit;t>0?(E.a.get_syncErrorRetryCountMap()[e.toString()]=--t,this._get_SyncErrorSid().push(e)):delete E.a.get_syncErrorRetryCountMap()[e.toString()]}}se._overallSyncErrorMessage=null},vSoM:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("Uv1Y"),a=n("iZ7K"),i=n("SRlt");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t,n,o){if(n&&e&&t&&n.length){for(const s of n){if(!Object(a.o)(e,s)){const e=t.TraceManager.getTracer(i.c.TRACER_CATEGORY_ID),n=new r.a(o+": Entity "+s+" metadata does not exist on the server",-2147098612,null,null,null,null,null,[{name:"EntityLogicalName",value:s}]);return e.warn(n.message),n}}return null}return null}},vTeb:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r,a=n("CGM5"),i=n("HMYz"),o=n("iDZS"),s=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.getElementName=function(){return"a"},t.prototype.getElementProps=function(){var e={href:this.props.href||"#",target:this.props.target};return this.props.download&&Object.assign(e,{download:this.props.download}),e},t}(a.a),l=i.connect(o.a)(c)},vlcQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n("dHD5"),a=n("wL2W"),i=n("pEXn"),o=n("4aOd"),s=n("tWr6"),c=n("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l="section.visible";function u(e,t,n,u){return{type:"section.visible.sync",sync:!0,execute({dispatch:d,getState:p},g){var h;const f=p();if(d(function(e,t,n,a){const i=Object(r.v)(t);return{type:l,payload:a,meta:{pageId:e,contextKey:i,sectionName:n}}}(e,t,n,u)),Object(a.a)()){const r=null===(h=null==g?void 0:g.TraceManager)||void 0===h?void 0:h.getTracer(`${i.k}${i.q}`),a=Object(c.tc)(f,{id:e,sectionName:n},t),l=Object(c.tc)(p(),{id:e,sectionName:n},t),u=Object(s.a)(f,e);u.push({name:"sectionName",value:n}),u.push({name:"visible state before change",value:null==a?void 0:a.toString()}),u.push({name:"visible state after change",value:null==l?void 0:l.toString()}),u.push({name:"callstack",value:new o.a(new Error).getStackTrace()}),null==r||r.warn(i.n,[{name:i.v,value:i.q+".visible"},{name:i.q,value:JSON.stringify(u)}])}}}}},vmcK:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return c}));var r=n("SAYH"),a=n("eXjw"),i=n("d0w6"),o=n("Lr+c"),s=n("pEXn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c="entity_control";function l(e,t,n){let r={};if(t)for(const a in t){const{views:i}=u(e,t[a],n);r=Object.assign(Object.assign({},i),r)}return{views:r}}function u(e,t,n){const i=t.Entities,o={initialized:a.a.Initialized,viewId:new r.a(t.ViewId),fetchXML:t.FetchXml,entityLogicalName:i?i[0].LogicalName:t.EntityLogicalName,queryApi:t.QueryApi,columnXML:t.ColumnXml,title:t.Title,idColumName:t.IdColumnName,queryType:t.QueryType,layoutXML:t.LayoutXml,grid:d(t.Grid),offlineSqlQuery:t.OfflineSqlQuery?t.OfflineSqlQuery:null,versionNumber:t.VersionNumber,OverallVersionNumber:t.OverallVersionNumber,OverallUserVersionNumber:t.OverallUserVersionNumber,isUserView:t.IsUserView};if(n){const r=[];if(r.push({name:s.b.ViewId,value:t.ViewId},{name:s.b.EntityName,value:o.entityLogicalName},{name:s.b.ViewName,value:o.title},{name:s.b.IsEmptyOfflineSqlQuery,value:!o.offlineSqlQuery}),e&&e.metadata&&e.metadata.views&&e.metadata.views[t.ViewId]&&e.metadata.views[t.ViewId].initialized===a.a.Initialized){if(e.metadata.views[t.ViewId].initialized===a.a.Initialized&&!e.metadata.views[t.ViewId].offlineSqlQuery&&t.OfflineSqlQuery){const e="OfflineSqlQuery value changed from NULL to non-NULL in state";n.warn(e,r)}else if(e.metadata.views[t.ViewId].initialized===a.a.Initialized&&e.metadata.views[t.ViewId].offlineSqlQuery&&!t.OfflineSqlQuery){const e="OfflineSqlQuery value changed from non-NULL to NULL in state";n.warn(e,r)}}else{const e=t.OfflineSqlQuery?"OfflineSqlQuery initial value set to non-NULL in state":"OfflineSqlQuery initial value set to NULL in state";n.warn(e,r)}}return{views:{[r.a.toString(o.viewId)]:o}}}function d(e){if(!e)return null;const t=e.Rows&&e.Rows.map(p),n=function(e){if(e.CustomControlDescriptions&&e.CustomControlDescriptions[0]&&e.CustomControlDescriptions[0].CustomControls){return Object(o.a)(e.CustomControlDescriptions[0])}}(e);return{name:e.Name,object:e.Object,rows:t,customControlDescriptions:n,jump:e.Jump,select:e.Select,icon:e.Icon,preview:e.Preview,iconRenderer:e.IconRenderer}}function p(e){const t=e.Cells.map(g);return{name:e.Name,id:e.Id,cells:t,multiObjectIdField:e.MultiObjectIdField,layoutStyle:e.LayoutStyle}}function g(e){return{name:e.Name,width:e.Width,relatedEntityName:e.RelatedEntityName,disableMetaDataBinding:e.DisableMetaDataBinding,labelId:e.LabelId,isHidden:e.IsHidden,disableSorting:e.DisableSorting,addedBy:e.AddedBy,desc:e.Desc,cellType:e.CellType,imageProviderWebresource:e.ImageProviderWebresource,imageProviderFunctionName:e.ImageProviderFunctionName}}function h(e){return e&&e.length?e.reduce((e,t)=>(e[t.ViewId]=b(t),e),{}):null}function f(e){if(!e||!e.length)return null;let t=e.filter(e=>e.IsDefault)[0];return t||(t=e[0]),new r.a(t.ViewId)}function m(e,t){if(!e||0===e.length)return null;const n={},a={},o={};for(const s of e)if(s.hasOwnProperty("EntityLogicalName")){const e=s.MetadataSubtype;n.hasOwnProperty(s.EntityLogicalName)?(n[s.EntityLogicalName][e]=h(s.SelectorItems),a[s.EntityLogicalName][e]=f(s.SelectorItems)):(n[s.EntityLogicalName]={[e]:h(s.SelectorItems)},a[s.EntityLogicalName]={[e]:f(s.SelectorItems)}),o[s.EntityLogicalName]||(o[s.EntityLogicalName]={}),o[s.EntityLogicalName][e]={overallVersionNumber:s.OverallVersionNumber,overallUserVersionNumber:s.OverallUserVersionNumber}}else{if(!t)return null;{const e=i.a[s.QueryType];n.hasOwnProperty(t)?n[t].hasOwnProperty(e)?n[t][e][s.ViewId]=b(s):n[t][e]={[s.ViewId]:b(s)}:n[t]={[e]:{[s.ViewId]:b(s)}},s.IsDefault&&(a.hasOwnProperty(t)?a[t].hasOwnProperty(e)||(a[t][e]=new r.a(s.ViewId)):a[t]={[e]:new r.a(s.ViewId)})}}return{viewSelectors:n,viewDefaults:a,viewSelectorVersions:o}}function b(e){return{name:e.Name,queryType:e.QueryType,isDefault:e.IsDefault,isQuickFindQuery:e.IsQuickFindQuery,isUserView:e.IsUserView||!1,isPinned:e.IsPinned||!1,relatedEntityName:e.RelatedEntityName,isAvailableInOffline:e.IsAvailableInOffline||!1}}},voMr:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Web=0]="Web",e[e.Native=1]="Native"}(r||(r={}))},"w+N3":function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="PickList_DateFilter_Overdue",a="PickList_DateFilter_Today",i="PickList_DateFilter_Tomorrow",o="PickList_DateFilter_All",s=[r,a,i,"PickList_DateFilter_Next7Days","PickList_DateFilter_Next30Days","PickList_DateFilter_Next90Days","PickList_DateFilter_Next6Months","PickList_DateFilter_Next12Months",o],c={overdue:{filterLabel:r,filterValue:"Overdue"},today:{filterLabel:a,filterValue:"Today"},tomorrow:{filterLabel:i,filterValue:"Tomorrow"},next7days:{filterLabel:"PickList_DateFilter_Next7Days",filterValue:"NextXDays;7"},next30days:{filterLabel:"PickList_DateFilter_Next30Days",filterValue:"NextXDays;30"},next90days:{filterLabel:"PickList_DateFilter_Next90Days",filterValue:"NextXDays;90"},next6months:{filterLabel:"PickList_DateFilter_Next6Months",filterValue:"NextXMonths;6"},next12months:{filterLabel:"PickList_DateFilter_Next12Months",filterValue:"NextXMonths;12"},all:{filterLabel:o,filterValue:"All"}}},w1eR:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Browser=1]="Browser",e[e.MobileApplication=2]="MobileApplication",e[e.MailApp=3]="MailApp"}(r||(r={}))},w72X:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l}));var r=n("Uv1Y"),a=n("aRLb"),i=n("KXDI"),o=n("SRlt"),s=n("g22U");function c(e){return{type:"executeOData.action.async",execute:({dispatch:t,getState:n},i)=>t(Object(a.c)(e)).then(()=>{const t=l(n(),e);return t.serializationFailure?Promise.reject(new r.a("Cannot serialize request: "+t.serializationFailure)):i.DataSource.get_WebAPIService().sendRequest(t)})}}function l(e,t){try{const n=Object(i.a)(e,t);let r=s.c.ACTION;const a=t.getMetadata().operationName||s.d;a===s.c.SCM&&(r=s.c.SCM);return{urlParameters:n,additionalHeaders:{Accept:o.a,Prefer:'odata.include-annotations="*"'},body:Object(i.d)(e,t),method:"POST",additionalParameters:{[s.a.TYPE]:r,[s.a.SUB_TYPE]:a}}}catch(e){return{serializationFailure:e.message}}}},w92Z:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("y60j"),a=n("Z/4N"),i=n("9fGf"),o=n("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t,n,s){const c=Object(o.b)(e,n,s),l=Object(r.j)(e,c),u=Object(i.b)(e);return Object(a.a)(t,l,u)}},wCzE:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return e&&e.metadata&&e.metadata.userMetadataVersion?e.metadata.userMetadataVersion:null}function i(e){const t=a(e);return t?t.initialized:r.a.Uninitialized}},wE9H:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Mobile=1]="Mobile",e[e.BrowserNormal=2]="BrowserNormal",e[e.BrowserMobileSize=3]="BrowserMobileSize"}(r||(r={}))},wF0i:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return g})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return b}));var r=n("DRVD"),a=n.n(r),i=n("mpSO"),o=n("zmaG"),s=n.n(o),c=n("pEXn"),l=n("iDqy"),u=n.n(l),d=n("SZCI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const p="AllControlsInitialized",g="AllRibbonsInitialized";let h=!1;class f{constructor(e){this._callbackCalled=!1,this._allRibbonsInitTime=0,this._numberOfRibbons=0,this._allControlsInitTime=0,this._numberOfControls=0,this._controlsToRender=[],this._callback=e,h=!1}writeMarker(e,t,n){this._receivedEvent(e,t,n)}writeRetroactiveTimespan(e,t,n,r){this._receivedEvent(e,t+n,r)}startTimespan(e,t,n){return(r,a)=>{this._receivedEvent(e,t+r,n)}}_receivedEvent(e,t,n){if(this._callbackCalled)return;const r=e.getName();if(r===d.m)this._controlsToRender.push(n[d.l]),this._numberOfControls=this._numberOfControls+1;else if(h&&r===d.o){const e=this._controlsToRender.indexOf(n[d.l]);e>-1&&(this._allControlsInitTime<t&&(this._allControlsInitTime=t),this._controlsToRender.splice(e,1))}else r===i.b?(this._allRibbonsInitTime<t&&(this._allRibbonsInitTime=t),this._numberOfRibbons=this._numberOfRibbons+1):r===d.i&&(this._callbackCalled=!0,this._callback(this._allRibbonsInitTime,this._numberOfRibbons,this._allControlsInitTime,this._numberOfControls))}}function m(e,t){s.a.addKeyPerformanceIndicator("PageNavigationStart"),s.a.tagWorkBlock(e+" page"),s.a.addCommonKpiParameters({[c.b.PageLoadParameters.TimeSinceIdle]:(performance.now()-u.a.getLastWorkBlockStartTime()).toFixed().toString()}),s.a.addKeyPerformanceIndicatorOnIdle(d.i,t);const n=new f((e,t,r,i)=>{a.a.removeTransport(n),e>0&&s.a.addKeyPerformanceIndicator(g,{[c.b.PageLoadParameters.NumberOfRibbons]:t.toString()},e),r>0&&s.a.addKeyPerformanceIndicator(p,{[c.b.PageLoadParameters.NumberOfControls]:i.toString()},r)});a.a.registerTransport(n,[o.KPI_ZONE,i.a,d.d])}function b(){s.a.addKeyPerformanceIndicator("PageDataReady"),h=!0}},wJNo:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="deviceSettings.change";function a(e){return{type:r,payload:e}}},wL2W:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return d}));var r=n("EY5k");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a=["Monitor_Dialog_Button_Allow","Monitor_Dialog_Button_Deny","Monitor_Prompt_Title","Monitor_Prompt_Message","Monitor_Notification_Message"];var i=n("YxC/"),o=n("+BIz"),s=n("tICD"),c=n("eL04");function l(){const e=sessionStorage.getItem("monitorData");return e?JSON.parse(e):{}}function u(){const e=l();return e&&Object.keys(e).length>0}async function d(e,t,n){const{u:c,s:u}=l(),d=n.searchParams,g=d.get("u"),h=d.get("s");if(g&&h&&(g!==c||h!==u)){const n=e.dispatch;await n(Object(r.e)(a));const c=Object(i.e)(e.getState(),a),l=Object(i.c)(c,"Monitor_Prompt_Title"),u=Object(i.c)(c,"Monitor_Prompt_Message"),d=Object(i.c)(c,"Monitor_Dialog_Button_Allow"),f=Object(i.c)(c,"Monitor_Dialog_Button_Deny"),m=await n(Object(o.a)(u,{},l,void 0,"",d,f));if(0===m.status){(await n(Object(s.a)(m.pageId))).value.confirmed?(sessionStorage.setItem("monitorData",JSON.stringify({u:g,s:h})),await p(n,c,t,g,h)):sessionStorage.removeItem("monitorData")}}else if(c&&u){const n=e.dispatch;await n(Object(r.e)(["Monitor_Notification_Message"]));const a=Object(i.e)(e.getState(),["Monitor_Notification_Message"]);await p(n,a,t,c,u)}}async function p(e,t,r,a,o){try{Error.stackTraceLimit=200}catch(e){}const s=Object(i.c)(t,"Monitor_Notification_Message");e(Object(c.b)({id:"monitorNotification",level:4,message:s,type:2}));const l=await n.e(82).then(n.bind(null,"j0Kh"));r.addTelemetryListener(new l.MonitorManager(a,o,e=>{r.ReportComponentFailure("Monitor",new Error(e))})),r.ReportComponentSuccess("Monitor",[{name:"endpoint",value:a},{name:"sessionState",value:o}])}},wMH2:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("WF3G"),a=n("504W"),i=n("NMtn"),o=n("d+dp"),s=n("HYaY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class c{constructor(e,t,n,o,s,c,l){var u;this._entities=null,this._moreRecords=!1,this._totalRecordCount=0,this._totalRecordCountLimitExceeded=!1,this._query=null,this._queryState=null,this._clientRetrieveOptions=null,Object(i.d)(e,"entities"),this._moreRecords=t,this._totalRecordCount=n,this._totalRecordCountLimitExceeded=o,this._entities=e,s instanceof r.a?(this._query=s,this._pagingCookie=null!==(u=null!=l?l:null==s?void 0:s.get_PagingCookie())&&void 0!==u?u:""):(this._queryState=s,this._pagingCookie=null!=l?l:""),this.set_clientRetrieveOptions(Object(a.a)(c)?this._entities.length>0?this._entities[0].get_clientRetrieveOptions():null:c)}get_entities(){return this._entities}get_moreRecords(){return this._moreRecords}get_totalRecordCountLimitExceeded(){return this._totalRecordCountLimitExceeded}get_totalRecordCount(){return this._totalRecordCount}get_count(){return this.get_entities().length}get_query(){return this._query}set_query(e){this._query=e}get_queryState(){return this._queryState}get_key(){return!Object(a.a)(this._query)&&this._query.get_key?this._query.get_key():""}get_pagingCookie(){return this._pagingCookie}get_clientRetrieveOptions(){return this._clientRetrieveOptions}set_clientRetrieveOptions(e){if(this._clientRetrieveOptions=e,!Object(a.a)(this._clientRetrieveOptions))for(let e=0;e<this._entities.length;e++)Object(a.a)(this._entities[e].get_clientRetrieveOptions())&&this._entities[e].set_clientRetrieveOptions(this._clientRetrieveOptions)}get_item(e){return this.get_entities()[e]}getObjectData(){const e={},t=new Array(this.get_entities().length);for(let e=0;e<this.get_entities().length;e++)t[e]=this.get_entities()[e].getObjectData();return e.entities=t,e.morerecords=this._moreRecords,e.totalrecordcount=this._totalRecordCount,e.totalRecordCountLimitExceeded=this._totalRecordCountLimitExceeded,Object(a.a)(this._clientRetrieveOptions)||(e.clientretrieveoptions=this._clientRetrieveOptions.getObjectData()),e}add(e){this._entities.push(e)}static createFromObjectData(e){const t=new Array(0),n=e.entities;for(let e=0;e<n.length;e++)t[e]=s.a.createFromObjectData(n[e]);const r=e.morerecords,a=e.totalrecordcount,i="totalRecordCountLimitExceeded"in e&&e.totalRecordCountLimitExceeded,l="clientretrieveoptions"in e?o.a.createFromObjectData(e.clientretrieveoptions):null;return new c(t,r,a,i,null,l)}}c.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityCollection"},wO8k:function(e,t,n){"use strict";n.d(t,"a",(function(){return _})),n.d(t,"c",(function(){return y})),n.d(t,"b",(function(){return v}));var r=n("pgSX"),a=n("tICD"),i=n("EY5k"),o=n("YxC/"),s=n("si7p");const c=["DialogTitle_UnSyncedRecords","Offline_Records_Warning_Message"];function l(e){return{type:"check.for.offline.record.changes.async.action",execute:({dispatch:t,getState:n},l)=>l.OfflineProvider.hasItemsToUpsync().nativePromise().then(n=>n?t(function(e){return{type:"offline.record.changes.dialog.async.action",execute({dispatch:t,getState:n}){const l=e?"ButtonText_Signout":"ButtonText_Reconfigure";return c.push(l),t(Object(i.e)(c)).then(()=>{const e=Object(o.e)(n(),c),i=Object(o.c)(e,l),u=Object(o.c)(e,"DialogTitle_UnSyncedRecords"),d=String.format(Object(o.c)(e,"Offline_Records_Warning_Message"),i);return t(Object(r.a)(s.c,d,{},i,u,"")).then(e=>0===e.status?t(Object(a.a)(e.pageId)).then(e=>Promise.resolve(e.value.confirmed)):Promise.reject(e.error))}).catch(e=>Promise.reject(e))}}}(e)):Promise.resolve(!0)).catch(e=>Promise.reject(e))}}var u=n("37s6"),d=n("SAYH"),p=n("0uKS"),g=n("8Mff");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const h=["ButtonText_ViewSyncErrors","DialogTitle_UnResolvedSyncErrors","Offline_SyncError_Records_Warning_Message"];function f(e){return{type:"check.for.sync.error.records",execute({dispatch:t,getState:n},c){const f=Object(u.d)(n());return Object(u.p)(n())===g.a.Disabled||null===f||""===f||d.a.equals(d.a.parse(f),d.a.EMPTY)?Promise.resolve(!0):t(l(e)).then(n=>n&&c.OfflineProvider.get_syncErrorCount()>0?t(function(e){return{type:"offline.sync.error.record.async.action",execute({dispatch:t,getState:n}){const c=e?"ButtonText_Signout":"ButtonText_Reconfigure";return h.push(c),t(Object(i.e)(h)).then(()=>{const e=Object(o.e)(n(),h),i=Object(o.c)(e,"ButtonText_ViewSyncErrors"),l=Object(o.c)(e,c),u=Object(o.c)(e,"DialogTitle_UnResolvedSyncErrors"),d=String.format(Object(o.c)(e,"Offline_SyncError_Records_Warning_Message"),l);return t(Object(r.a)(s.c,d,{},i,u,"",l)).then(e=>0===e.status?t(Object(a.a)(e.pageId)).then(n=>void 0!==n.value.confirmed&&null!==n.value.confirmed&&(!n.value.confirmed||(t(Object(p.a)("syncerror",e.pageId,null,null,null,null,null)),!1))):Promise.reject(e.error))}).catch(e=>Promise.reject(e))}}}(e)):Promise.resolve(n)).catch(e=>Promise.reject(e))}}}var m=n("VCkP"),b=n("XOSd");function _(e,t){return new m.a(e,t).isOperationAvailable("signOut")}function y(){return{type:"user.signout",execute(e,t){if(_(t,e))return Object(b.b)(e.getState()),e.dispatch(f(!0)).then(n=>{if(n){return t.Router.shouldNavigate().then(n=>{if(n){return new m.a(t,e).signOut()}})}return Promise.resolve()})}}}function v(){return{type:"user.reconfigure",execute(e,t){const n=new m.a(t,e);if(n.isOperationAvailable("reconfigure"))return Object(b.b)(e.getState()),e.dispatch(f(!1)).then(e=>{if(e){return t.Router.shouldNavigate().then(e=>{if(e)return n.reconfigure()})}return Promise.resolve()})}}}},wRZP:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n("UZFl"),a=n("ruPX"),i=n("F1Lu"),o=n("b8TU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t){return{type:"OPEN_APP_LANDING_PAGE",execute(n,o){const s=new i.a(o,n);if(s.isOperationAvailable("switchApp"))return s.switchApp();const c={webresourceName:e};return n.dispatch(Object(a.a)(r.a,c,void 0,t))}}}function c(){return{type:"OPEN_APP_DIALOGS",execute(e,t){const n=new i.a(t,e);if(n.isOperationAvailable("switchApp"))return n.switchApp();const s=e.getState(),c={webresourceName:"",dialogOptions:{hideDialogHeader:!1,inExpandMode:Object(o.d)(s)}};return e.dispatch(Object(a.a)(r.a,c,void 0,{target:"dialog"}))}}}},wgH2:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l}));var r=n("arV0"),a=n("NjDY"),i=n("cUMa"),o=n("UIlN");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t){const n=Object(o.b)(e,t);return n&&n.ruleContext||null}function c(){const e=Object(i.f)(),t=Object(i.d)();let n,o,s,c,d,p,g,h,f;return function(i,m,b,_,y,v,S,O){const C=Object(r.g)(i,m),E=i.serverStatus.isAvailable,I=Object(a.t)(i),w=e(i,S,m,y),j=t(i,O,m,y);null==_&&y&&(_=y.relationshipType),null==_&&(_=-1);const P=c!==w;if(h!==C.id||f!==C.entityTypeName||n!==E||o!==I||s!==b||P||d!==j){let e;if(h=C.id,f=null==C?void 0:C.entityTypeName,n=E,o=I,s=b,c=w,d=j,b){const t=function(e){let t=0;switch(e){case"Form":t=2;break;case"HomePageGrid":t=1;break;case"SubGridRelated":t=4;break;case"SubGridStandard":t=3;break;case"SubGridAssociated":t=6;break;case"QuickForm":t=7;break;case"Dashboard":t=8;break;case"Global":t=10}return t}(l(b)),{id:n}=C,r=C&&C.entityTypeName,a=function(e){let t=e&&e.parentContextToken;for(;t;){if(t.entityTypeName)return t.entityTypeName;t=t.parentContextToken}return null}(y)||r,i=u(b);P&&(g=w?w.map(e=>({EntityReference:e})):[]),e={IsServerAvailable:E,EntityLogicalName:a||i,EntityId:n,ContextType:t,WebResourcePath:I,SelectedItems:g,AllItems:j||[],IsReferencingAttributeRequired:!1,RelationshipType:_,ContextEntityLogicalName:i,CustomControlType:v}}p=e}return p}}function l(e){if(e){const t=e.split(":");return 2===t.length?t[0]:""}return""}function u(e){if(e){const t=e.split(":");return 2===t.length?t[1]:""}return""}},"whN/":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Referencing=1]="Referencing",e[e.AssociationEntity=2]="AssociationEntity"}(r||(r={}))},wipL:function(e,t,n){"use strict";n.d(t,"c",(function(){return F})),n.d(t,"b",(function(){return I})),n.d(t,"a",(function(){return w}));var r=n("nuS9"),a=n("YWpA"),i=n("H/hG"),o=n("evW+"),s=n("gvL4"),c=n("Smta"),l=n("3/02"),u=n("QBtP"),d=n("u+q+"),p=n("YxC/"),g=n("9eA9"),h=n("dj6u"),f=n("SAYH"),m=n("vTeb"),b=n("Lyxw"),_=n("z0a7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function y(e){const t=Object(_.a)(["TechnicalDetails.OrganizationUrlLabel","TechnicalDetails.OrganizationIdLabel","TechnicalDetails.UserObjectIdLabel","TechnicalDetails.SystemUserIdLabel","TechnicalDetails.UserTenantIdLabel","TechnicalDetails.EnvironmentFriendlyNameLabel","TechnicalDetails.EnvironmentIdLabel","MailtoLink_ReportToAdmin","ErrorPopup.ErrorDetailsLabel"]),n=r.useContext(u.a),i=Object(d.d)(e=>Object(b.c)(e,l.eb)),o=Object(p.c)(t,"TechnicalDetails.EnvironmentFriendlyNameLabel"),s=Object(p.c)(t,"TechnicalDetails.OrganizationUrlLabel"),c=Object(p.c)(t,"TechnicalDetails.OrganizationIdLabel"),y=Object(p.c)(t,"TechnicalDetails.UserObjectIdLabel"),S=Object(p.c)(t,"TechnicalDetails.SystemUserIdLabel"),O=Object(p.c)(t,"TechnicalDetails.UserTenantIdLabel"),C=Object(p.c)(t,"TechnicalDetails.EnvironmentIdLabel"),E=Object(p.c)(t,"ErrorPopup.ErrorDetailsLabel"),I=Object(p.c)(t,"MailtoLink_ReportToAdmin"),w=Object(d.d)(e=>e&&e.organization&&e.organization.organizationName),j=Object(g.b)(),P=Object(d.d)(e=>e.organization.organizationId.guid),T=Object(d.d)(e=>e&&e.user&&e.user.userId&&e.user.userId.guid),N=Object(d.d)(e=>Object(h.b)(e)),A=Object(d.d)(e=>Object(h.a)(e)),D=Object(d.d)(e=>f.a.isNullOrEmpty(e&&e.organization&&e.organization.environmentId)?"":e.organization.environmentId.guid);if(!i)return null;const R=E+"\n\t"+Object.values(e.errorDescriptor.errorInformation).join("\n\t"),x=encodeURIComponent(R+("\n\t"+o+" "+(w||"N/A")+"\n\t"+s+" "+(j||"N/A")+"\n\t"+c+" "+(P||"N/A")+"\n\t"+y+" "+(N||"N/A")+"\n\t"+S+" "+(T||"N/A")+"\n\t"+O+" "+(A||"N/A")+"\n\t"+C+" "+(D||"N/A"))),M=x.length>2e3-"mailto:?body=".length?"mailto:?body="+encodeURIComponent(R):"mailto:?body="+x,F=String.format(I,"",",").split(" ,");return r.createElement(a.a,null,r.createElement(m.a,{key:"report-to-admin-mailtolink",href:M,onClick:()=>v(n),accessibilityLabel:M},F[0]),F[1])}const v=e=>{e.EventManager.ReportComponentSuccess("MailtoLink")};var S=n("znb3"),O=n("XIN1"),C=n("Afz2"),E=n("nJrx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const I=Object(E.a)(),w=Object(E.a)();const j={backgroundColor:"#ffffff",boxSizing:"border-box",padding:"1.5rem",width:"40rem",border:"1px solid #efefef",boxShadow:"0px 2px 4px 0px rgba(0, 0, 0, 0.5)",maxHeight:"80vh",maxWidth:"100vw",margin:"auto"},P={flexDirection:"column",flexShrink:0,marginBottom:"1.25rem"},T={listStyleType:"none",flexDirection:"column",flexShrink:0},N={flexDirection:"column",alignItems:"flex-start",marginTop:"1.25rem",overflow:"auto"},A={flexDirection:"column",wordBreak:"break-all",marginTop:"1.25rem"},D={border:"none",backgroundColor:"transparent",padding:"5px 0",cursor:"pointer",flexShrink:0,color:"#006699"},R={fontSize:"1.25rem",marginBottom:"1.25rem",alignItems:"center",justifyContent:"space-between"},x={fontSize:"inherit",fontWeight:"normal",flexGrow:1},M={width:"24px",height:"24px",fontSize:"24px",marginRight:"0.5rem",color:"#EA0600"};class F extends r.Component{constructor(e){super(e),this._onExpandDetailsHandler=this._onExpandDetailsHandler.bind(this),this.state={isExpanded:!1}}_onExpandDetailsHandler(){this.setState({isExpanded:!this.state.isExpanded})}_renderTechnicalInformation(e){if(!e.errorMessage&&!e.stack)return null;const t=e.errorMessage?r.createElement(a.a,{key:"basic-error-errorMessage"},e.errorMessage):null,n=e.stack?r.createElement(a.a,{key:"basic-error-stack"},e.stack):null;return r.createElement(a.a,{key:"basic-error-technicalDetails",style:A},t,n)}_renderErrorInformation(e){const t=[];for(const n in e)t.push(r.createElement(c.a,{key:n+"_key",accessibilityLabel:e[n]},e[n]));return t}_renderTechnicalDetails(e,t){return this.state.isExpanded?r.createElement(a.a,{key:"basic-error-technicalDetailsBlock",style:N},r.createElement(s.a,{key:"basic-error-details",style:T},this._renderErrorInformation(t)),this._renderTechnicalInformation(e)):null}_renderCloseIconButton(e,t){return e?r.createElement(o.a,{key:"basic-error-closeButton",onClick:e.closeErrorPopup,style:e.errorPopupCloseIconButtonStyle,accessibilityLabel:t,title:t},r.createElement(O.b,{type:S.a.Cancel,style:e.errorPopupCloseIconStyle})):null}render(){const e=this.props.errorDescriptor;let t={flexDirection:"column",textAlign:e.isRTL?"right":"left",overflow:"hidden",color:"#000"};this.props.inlineDisplay||(t=Object.assign(Object.assign({},t),j));const n=e.isRTL?e.title+" :"+e.accessibilityLabelPrefix:e.accessibilityLabelPrefix+": "+e.title;return r.createElement(a.a,{key:"basic-error-popup",style:t},r.createElement(a.a,{key:"basic-error-header",style:P},r.createElement(a.a,{key:"basic-error-title",style:R},r.createElement(O.b,{key:"basic-error-titleIcon",type:S.a.Abandon,role:C.r,style:M}),r.createElement(i.a,{key:I,id:I,accessibilityLabel:n,semanticTag:"h1",style:x},e.title),this._renderCloseIconButton(this.props.closeButtonDescriptor,e.closeButtonLabel)),r.createElement(a.a,{key:w,id:w,accessibilityLabel:e.message},e.message)),r.createElement(y,{key:"mailtoLink-class-component",errorDescriptor:this.props.errorDescriptor}),r.createElement(o.a,{key:"basic-error-technicalDetailsButton",onClick:this._onExpandDetailsHandler,style:D,accessibilityExpanded:this.state.isExpanded,accessibilityLabel:e.errorTechnicalDetails.detailsLabel},e.errorTechnicalDetails.detailsLabel),this._renderTechnicalDetails(e.errorTechnicalDetails,e.errorInformation))}}},wo7m:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("nxt5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a extends r.a{constructor(e){super("RetrievePrincipalAccess"),this._accessRights=e}get_accessRights(){return this._accessRights}}},ws6F:function(e,t,n){"use strict";n.d(t,"g",(function(){return a})),n.d(t,"A",(function(){return i})),n.d(t,"s",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"l",(function(){return l})),n.d(t,"m",(function(){return u})),n.d(t,"x",(function(){return d})),n.d(t,"k",(function(){return p})),n.d(t,"j",(function(){return g})),n.d(t,"r",(function(){return h})),n.d(t,"z",(function(){return f})),n.d(t,"q",(function(){return m})),n.d(t,"y",(function(){return b})),n.d(t,"v",(function(){return _})),n.d(t,"p",(function(){return y})),n.d(t,"u",(function(){return v})),n.d(t,"t",(function(){return S})),n.d(t,"o",(function(){return O})),n.d(t,"n",(function(){return C})),n.d(t,"e",(function(){return E})),n.d(t,"f",(function(){return I})),n.d(t,"d",(function(){return w})),n.d(t,"c",(function(){return j})),n.d(t,"h",(function(){return P})),n.d(t,"i",(function(){return T})),n.d(t,"w",(function(){return N}));var r=n("txA/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="Web.NavBar.Navigate_Dynamics365",i="Web.NavBar.SiteMap",o="Web.SitemapPanel.Recent",s="SITEMAP_APPS_BUTTON",c="Change_App_ToolTip",l="Web.SitemapPanel.Pinned",u="Web.SitemapPanel.PinnedStatus",d="Web.SitemapPanel.UnPinnedStatus",p="Web.SitemapPanel.NoRecentMessage",g="Web.SitemapPanel.NoPinnedMessage",h="Web.SitemapPanel.PinAriaLabel",f="Web.SitemapPanel.UnpinAriaLabel",m="Web.SitemapPanel.PinnedItemTooltip",b="Web.SitemapPanel.UnpinnedItemTooltip",_="Web.SitemapPanel.RecentItems",y="Web.SitemapPanel.PinnedItems",v="Web.SitemapPanel.Recent.ExpandTooltip",S="Web.SitemapPanel.Recent.CollapseTooltip",O="Web.SitemapPanel.Pinned.ExpandTooltip",C="Web.SitemapPanel.Pinned.CollapseTooltip",E="MultiSession.NavAriaLabel",I="MultiSession.NavTooltip",w="MultiSession.Expand",j="MultiSession.Collapse",P="Web.SitemapPanel.ChangeAreaLabel",T="Web.SitemapPanel.AreaSwitcherTooltip",N=["Web.NavBar.Switch_App_Text",a,"Web.NavBar.Close_Site_Map","Web.NavBar.Favorites_And_Recent","Web.NavBar.All_Areas","Web.NavBar.NavigationTip","Available_Offline","Not_Available_Offline",i,s,c,"App_Modules_SubArea_ToolTip",r.M,r.L,o,l,u,d,p,g,h,f,m,b,_,y,P,T,v,S,O,C,w,j,I,E]},"wul+":function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return g})),n.d(t,"a",(function(){return u}));var r=n("nuS9"),a=n("D9ys"),i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};function o(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},c=Object(a.shape)({onComponentsChange:a.func.isRequired,removeOnComponentsChange:a.func.isRequired}),l=Object(a.shape)({emit:a.func.isRequired,on:a.func.isRequired,off:a.func.isRequired}),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.componentWillMount=function(){this.context.manager.onFillMount(this)},t.prototype.componentDidUpdate=function(){this.context.manager.onFillUpdated(this)},t.prototype.componentWillUnmount=function(){this.context.manager.onFillUnmount(this)},t.prototype.render=function(){return null},t.contextTypes={manager:c},t}(r.Component),d=function(){function e(){this._events=[],this._db={byName:new Map,byFill:new Map}}return e.prototype.onFillMount=function(e){var t=r.Children.toArray(e.props.children),n=e.props.name,a={fill:e,children:t,name:n},i=this._db.byName.get(n);i?(i.components.push(a),i.listeners.forEach((function(e){return e(i.components)}))):this._db.byName.set(n,{listeners:[],components:[a]}),this._db.byFill.set(e,a)},e.prototype.onFillUpdated=function(e){var t=this._db.byFill.get(e),n=r.Children.toArray(e.props.children);if(!t)throw new Error("component was expected to be defined");t.children=n;var a=t.name,i=this._db.byName.get(a);if(!i)throw new Error("registration was expected to be defined");i.listeners.forEach((function(e){return e(i.components)}))},e.prototype.onFillUnmount=function(e){var t=this._db.byFill.get(e);if(!t)throw new Error("component was expected to be defined");var n=t.name,r=this._db.byName.get(n);if(!r)throw new Error("registration was expected to be defined");var a=r.components;a.splice(a.indexOf(t),1),this._db.byFill.delete(e),0===r.listeners.length&&0===r.components.length?this._db.byName.delete(n):r.listeners.forEach((function(e){return e(r.components)}))},e.prototype.onComponentsChange=function(e,t){var n=this._db.byName.get(e);n?(n.listeners.push(t),t(n.components)):(this._db.byName.set(e,{listeners:[t],components:[]}),t([]))},e.prototype.getFillsByName=function(e){var t=this._db.byName.get(e);return t?t.components.map((function(e){return e.fill})):[]},e.prototype.getChildrenByName=function(e){var t=this._db.byName.get(e);return t?t.components.map((function(e){return e.children})).reduce((function(e,t){return e.concat(t)}),[]):[]},e.prototype.removeOnComponentsChange=function(e,t){var n=this._db.byName.get(e);if(!n)throw new Error("expected registration to be defined");var r=n.listeners;r.splice(r.indexOf(t),1)},e}(),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._manager=new d,t}return o(t,e),t.prototype.getChildContext=function(){return{manager:this._manager}},t.prototype.render=function(){return this.props.children},t.prototype.getFillsByName=function(e){return this._manager.getFillsByName(e)},t.prototype.getChildrenByName=function(e){return this._manager.getChildrenByName(e)},t.childContextTypes={manager:c,bus:l},t}(r.Component),g=function(e){function t(t){var n=e.call(this,t)||this;return n.state={components:[]},n.handleComponentChange=n.handleComponentChange.bind(n),n}return o(t,e),t.prototype.componentWillMount=function(){this.context.manager.onComponentsChange(this.props.name,this.handleComponentChange)},t.prototype.handleComponentChange=function(e){this.setState({components:e})},Object.defineProperty(t.prototype,"fills",{get:function(){return this.state.components.map((function(e){return e.fill}))},enumerable:!0,configurable:!0}),t.prototype.componentWillReceiveProps=function(e){if(e.name!==this.props.name){this.context.manager.removeOnComponentsChange(this.props.name,this.handleComponentChange);var t=e.name;this.context.manager.onComponentsChange(t,this.handleComponentChange)}},t.prototype.componentWillUnmount=function(){var e=this.props.name;this.context.manager.removeOnComponentsChange(e,this.handleComponentChange)},t.prototype.render=function(){var e=this,t=[];if(this.state.components.forEach((function(n,a){var i=n.fill,o=n.children,c=e.props.fillChildProps;if(c){var l=Object.keys(c).reduce((function(t,n){var r=c[n];return t[n]="function"==typeof r?function(){return r(i,e.fills)}:r,t}),{});o.forEach((function(e,n){if("number"==typeof e||"string"==typeof e)throw new Error("Only element children will work here");t.push(Object(r.cloneElement)(e,s({key:a.toString()+n.toString()},l)))}))}else o.forEach((function(e,n){if("number"==typeof e||"string"==typeof e)throw new Error("Only element children will work here");t.push(Object(r.cloneElement)(e,{key:a.toString()+n.toString()}))}))})),"function"==typeof this.props.children){var n=this.props.children(t);if(Object(r.isValidElement)(n)||null===n)return n;var a=this._reactInternalInstance._currentElement._owner._instance.constructor,i=a.displayName||a.name;throw new Error("Slot rendered with function must return a valid React Element. Check the "+i+" render function.")}return t},t.contextTypes={manager:c},t}(r.Component)},wyQO:function(e,t,n){"use strict";n.d(t,"b",(function(){return S})),n.d(t,"a",(function(){return O})),n.d(t,"f",(function(){return P})),n.d(t,"d",(function(){return I})),n.d(t,"e",(function(){return A})),n.d(t,"c",(function(){return T}));var r=n("hVsf"),a=n("Uv1Y"),i=n("TBkx"),o=n("eXjw"),s=n("SAYH"),c=n("FZDd"),l=n("B+9Q"),u=n("K7RF"),d=n("69Qu"),p=n("MXaZ"),g=n("D6Jg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function h(e,t){const n=e.configuration&&e.configuration.flags;if(n&&Object.keys(n).length&&t){const e=Object.assign({},t);for(const r in t){const t=n[r.toLowerCase()];if(void 0!==t)if(void 0!==Object(g.c)(t))e[r]=Object(g.c)(t);else if(Number.isNaN(Number.parseInt(t,10))){if(/[\W]/.test(t))throw new Error(`The value of the flag '${r}' contains characters that are not supported.`);e[r]=t}else e[r]=Number.parseInt(t,10)}return e}return t}var f=n("y6/h"),m=n("BDhr"),b=n("wCzE"),_=n("EY5k"),y=n("dH1a"),v=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const S="user.retrieve",O="modify.pinned.view";function C(e){return e(Object(r.a)())}function E(e){return e(Object(c.f)("activityparty",!0,[]))}function I(e=!1){return{type:"user.retrieve.async",execute({dispatch:t,getState:n},r){const a=r.DataSource,s=a.get_IsLocalDataSourceAvailable();t(function(){const e={initialized:o.a.Initializing},t={initialized:o.a.Initializing};return{type:S,payload:{userState:e,orgState:t,selectedForms:{}}}}());const c=r.TraceManager&&r.TraceManager.getTracer("retrieveUserContext");let l=null;const u=a.retrieveLocalDataSourceUserContext().nativePromise();l=Object(d.b)(n())?a.retrieveUserContext().nativePromise():u;let p=Promise.all([l,u]);return s&&!e?p.then(e=>{const r=e[0],o=e[1];if(null==o||r.MetadataLastModifiedTime!==o.MetadataLastModifiedTime&&r.UserMetadataLastModifiedTime!==o.UserMetadataLastModifiedTime)return Promise.all([C(t),E(t)]).catch(async e=>{if(!Object(i.g)(e))try{await w(e,u,a,{dispatch:t,getState:n},c)}catch(e){throw e}})}).catch(async e=>{try{await w(e,u,a,{dispatch:t,getState:n},c)}catch(e){throw e}}):e||(p=Promise.all([p,C(t)])),Promise.all([p,l]).then(e=>E(t).then(()=>e[1]).catch(async r=>{if(Object(i.g)(r))return e[1];try{await w(r,u,a,{dispatch:t,getState:n},c)}catch(e){throw e}})).then(e=>{j(e,a,{dispatch:t,getState:n},c)}).catch(async e=>{try{await w(e,u,a,{dispatch:t,getState:n},c)}catch(e){throw e}})}}}async function w(e,t,n,{dispatch:r,getState:i},o){const s=(e=Object(a.c)(e)).getNegativeErrorCode();if(!Object(y.a)(s)||!n.get_IsLocalDataSourceAvailable())throw o.error("handleRetrieveUserContextError:Non offline error or local data source is not available. ErrorCode = "+s),e;try{o.warn("handleRetrieveUserContextError:Retrying the request from local store, as this is an offline error. ErrorCode = "+s);j(await t,n,{dispatch:r,getState:i},o)}catch(t){o.error("handleRetrieveUserContextError:Exception during handling offline error, ErrorCode = "+s),Object(a.b)(e)}}function j(e,t,{dispatch:n,getState:r},i){if(Object(v.a)(e)){i.error("handleRetrieveUserContextSuccess: User context is null or empty");const e=r();throw Object(d.b)(e)?a.a.fromErrorCode(e,-2147015414):a.a.fromErrorCode(e,-2147093999)}{t.set_UserContext(e),T(n,e);const a=Object(f.b)();a&&a.metadataVersion===Object(m.a)(r()).currentVersion&&a.userMetadataVersion===Object(b.a)(r()).currentVersion&&n(Object(_.f)())}}function P(e,t){return{type:O,payload:{etn:t,pinnedView:e}}}function T(e,t){e(function(e){return{sync:!0,type:"Retrieve.User.Context.Sync",execute({dispatch:t,getState:n}){const r=e.get_TimeZoneDefinitionByCode(),a={};for(const e in r){const t=r[e];a[e]={bias:t.get_Bias(),timeZoneCode:t.get_TimeZoneCode(),userInterfaceName:t.get_UserInterfaceName()}}const i=e.get_TransactionCurrencyById(),c={};for(const e in i){const t=i[e];c[e]={transactionCurrencyId:s.a.fromLegacyGuid(t.get_TransactionCurrencyId()),currencyCode:t.get_CurrencyCode(),currencyName:t.get_CurrencyName(),currencyPrecision:t.get_CurrencyPrecision(),currencySymbol:t.get_CurrencySymbol()}}const l=e.get_UserRolesToNames(),u={};for(const e in l)u[e]=l[e];const d=e.get_UserRolePrivileges(),g={};for(const e in d){const t=d[e];g[e]={privilegeId:s.a.fromLegacyGuid(t.get_privilegeId()),privilegeDepth:t.get_depth(),businessUnitId:s.a.fromLegacyGuid(t.get_businessUnitId())}}const f=e.get_UserAttributePrivileges(),m={};for(const e in f){const t=f[e];m[e]={attributeId:s.a.fromLegacyGuid(t.get_AttributeId()),canCreate:t.get_CanCreate(),canRead:t.get_CanRead(),canUpdate:t.get_CanUpdate(),attributeAccessRights:t.get_AccessRightsMask()}}const b={languageId:e.get_LanguageId(),isRTL:e.get_IsRTL(),isHighContrastEnabled:e.get_IsHighContrastEnabled(),userCultureLCID:e.get_UserCultureLcid(),timeZoneUtcOffsetMinutes:e.get_TimeZoneUtcOffsetMinutes(),userReportScriptErrors:e.get_UserReportScriptErrors(),savedFilters:e.get_SavedFilters(),defaultSavedFilter:e.get_DefaultSavedFilter(),timeZoneAdjusters:Object(p.I)(e.get_TimeZoneAdjusters()),offlineProfileId:s.a.fromLegacyGuid(e.get_OfflineProfileId()),offlineProfileVersion:e.get_OfflineProfileVersion(),offlineProfileAvailableEntities:e.get_OfflineProfileAvailableEntities(),defaultSearchExperience:e.get_DefaultSearchExperience(),defaultDashboardId:s.a.fromLegacyGuid(e.get_DefaultDashboardId()),transactionCurrencyId:s.a.fromLegacyGuid(e.get_TransactionCurrencyId()),defaultHomepageId:s.a.fromLegacyGuid(e.get_DefaultHomepageId()),defaultInteractionCentricDashboardId:s.a.fromLegacyGuid(e.get_DefaultInteractionCentricDashboardId()),isLive:e.get_IsLive(),isFarEastLanguage:e.get_IsFarEastLanguage(),usePathBasedUrls:e.get_UsePathBasedUrls(),timeZoneDefinitionByCode:a,transactionCurrencyById:c,numberFormatInfo:e.get_NumberFormatInfo(),dateFormatInfo:e.get_DateTimeFormatInfo(),showWeekNumber:e.get_ShowCalendarWeeks(),userCultureName:e.get_userCultureName(),formatInfoCultureName:e.get_FormatInfoCultureName(),isGuidedHelpEnabled:e.get_UserSettings().get_IsGuidedHelpEnabled(),recordsPerPage:e.get_UserSettings().get_RecordsPerPage(),defaultGridViews:e.get_DefaultGridViews(),selectedGlobalFilterId:s.a.fromLegacyGuid(e.get_SelectedGlobalFilterId()),isAdmin:e.get_IsAdmin(),isCustomizer:e.get_IsCustomizer(),homepageArea:e.get_UserSettings().get_HomepageArea(),homepageSubArea:e.get_UserSettings().get_HomepageSubArea(),isEmailConversationViewEnabled:e.get_IsEmailConversationViewEnabled(),workDayStartTime:e.get_WorkDayStartTime(),autoCaptureUserStatus:e.get_AutoCaptureUserStatus()},_={initialized:o.a.Initialized,userDisplayName:e.get_UserName(),userId:s.a.fromLegacyGuid(e.get_UserId()),userEmail:e.get_UserEmail(),userRolePrivileges:g,userAttributePrivileges:m,userRolesToNames:u,userSettings:h(n(),b)},y=e.get_SelectedFormsByEntity().reduce((e,t)=>(e[t.EntityName.toLowerCase()]={formId:s.a.fromLegacyGuid(t.FormId),userEntityUISettingsId:s.a.fromLegacyGuid(t.UserEntityUISettingId)},e),{}),v={languageCode:e.get_LanguageCode(),baseCurrencyId:s.a.fromLegacyGuid(e.get_BaseCurrencyId()),defaultCountryCode:e.get_DefaultCountryCode(),geoName:e.get_GeoName(),fullNameConventionCode:e.get_FullNameConventionCode(),pricingDecimalPrecision:e.get_PricingDecimalPrecision(),organizationUniqueName:e.get_OrganizationUniqueName(),norsyncServerConnectionString:e.get_NorsyncServerConnectionString(),currentThemeData:e.get_CurrentThemeData(),delveUrl:e.get_DelveUrl(),isAutoSaveEnabled:e.get_IsAutoSaveEnabled(),appointmentRichEditorExperience:e.get_AppointmentRichEditorExperience(),allowLegacyDialogsEmbedding:e.get_AllowLegacyDialogsEmbedding(),allowLegacyClientExperience:e.get_AllowLegacyClientExperience(),enableUnifiedInterfaceShellRefresh:e.get_EnableUnifiedInterfaceShellRefresh(),webServiceCallRetryPolicies:e.get_WebServiceCallRetryPolicies(),kmUseExternalPortal:e.get_KmUseExternalPortal(),kmExternalPortalUrl:e.get_KmExternalPortalUrl(),maxIncidentMergeNumber:e.get_MaxIncidentMergeNumber(),maxChildIncidentNumber:e.get_MaxChildIncidentNumber(),isConflictDetectionEnabledForMobileClient:e.get_IsConflictDetectionEnabledForMobileClient(),isParature:e.get_IsParature(),isKMConfigured:e.get_IsKMConfigured(),mobileOfflineSyncInterval:e.get_MobileOfflineSyncInterval(),overrideTrackInCrmBehaviour:e.get_OverrideTrackInCrmBehavior(),showWeekNumber:e.get_ShowWeekNumber(),isMocaOfflineFeatureEnabled:e.get_IsMocaOfflineFeatureEnabled(),isSOPIntegrationEnabled:e.get_IsSOPIntegrationEnabled(),isTelemeteryEnabled:e.get_IsTelemeteryEnabled(),useSkypeProtocol:e.get_UseSkypeProtocol(),currencyDisplayOption:e.get_CurrencyDisplayOption(),orgCultureInfoLCID:e.get_OrgCultureInfoLcid(),enabledLanguages:e.get_EnabledLanguages(),blockedAttachments:e.get_BlockedAttachments(),maxUploadFileSize:e.get_MaxUploadFileSize(),orgReportScriptErrors:e.get_OrganizationReportScriptErrors(),isDuplicateDetectionEnabled:e.get_IsDuplicateDetectionEnabled(),isDuplicateDetectionEnabledForOnlineCreateUpdate:e.get_IsDuplicateDetectionEnabledForOnlineCreateUpdate(),isOsdpOrganization:e.get_IsOsdpOrganization(),fiscalYearStartDate:new Date(e.get_FiscalCalendarStart()),fiscalPeriodFormat:e.get_FiscalPeriodFormatPeriod(),fiscalPeriodType:e.get_FiscalPeriodType(),fiscalYearFormatYear:e.get_FiscalYearFormatYear(),fiscalYearDisplayCode:e.get_FiscalYearDisplayCode(),fiscalYearFormatPrefix:e.get_FiscalYearFormatPrefix(),fiscalYearFormatSuffix:e.get_FiscalYearFormatSuffix(),fiscalPeriodConnector:e.get_FiscalPeriodConnector(),webResourceHash:N(e.get_WebResourceHash()),isPowerBIEnabled:e.get_IsPowerBIEnabled(),firstPartyIntegrationSiteUrl:e.get_FirstPartyIntegrationSiteUrl(),isTrialOrganization:e.get_IsTrialOrganization(),isPreviewOrganization:e.get_IsPreviewOrganization(),isSandboxOrganization:e.get_IsSandboxOrganization(),isSovereignCloud:e.get_IsSovereignCloud(),advancedDebuggabilitySettings:e.get_AdvancedDebuggabilitySettings(),enableLPAuthoring:e.get_EnableLPAuthoring(),isContextualHelpEnabled:e.get_IsContextualHelpEnabled(),isMicrosoftFlowEnabled:e.get_IsMicrosoftFlowEnabled(),microsoftFlowFirstPartyIntegrationSiteUrl:e.get_MicrosoftFlowFirstPartyIntegrationSiteUrl(),isExternalSearchIndexEnabled:e.get_IsExternalSearchIndexEnabled(),microsoftFlowDestinationUrl:e.get_MicrosoftFlowDestinationUrl(),microsoftFlowEnvironmentId:e.get_MicrosoftFlowEnvironmentId(),sharePointDeploymentType:e.get_SharePointDeploymentType(),isOneDriveEnabled:e.get_IsOneDriveEnabled(),isMSTeamsEnabled:e.get_IsMSTeamsEnabled(),isContextualEmailEnabled:e.get_IsContextualEmailEnabled(),isRichTextNotesEnabled:e.get_IsRichTextNotesEnabled(),isAutoDataCaptureV2Enabled:e.get_IsAutoDataCaptureV2Enabled(),isManualSalesForecastingEnabled:e.get_IsManualSalesForecastingEnabled(),isActionCardEnabled:e.get_IsActionCardEnabled(),enableImmersiveSkypeIntegration:e.get_EnableImmersiveSkypeIntegration(),isEmailMonitoringAllowed:e.get_IsEmailMonitoringAllowed(),allowUnresolvedPartiesOnEmailSend:e.get_AllowUnresolvedPartiesOnEmailSend(),isPresenceEnabled:e.get_IsPresenceEnabled(),boundDashboardDefaultCardExpanded:e.get_BoundDashboardDefaultCardExpanded(),logoImagePath:e.get_LogoImagePath(),logoTooltip:e.get_LogoTooltip(),sessionTimeoutInSeconds:e.get_SessionTimeoutInSeconds(),sessionTimeoutReminderInSeconds:e.get_SessionTimeoutReminderInSeconds(),inactivityTimeoutInSeconds:e.get_InactivityTimeoutInSeconds(),inactivityTimeoutReminderInSeconds:e.get_InactivityTimeoutReminderInSeconds(),transactionCurrencyById:c,officePortalUrl:e.get_OfficePortalUrl(),ppacSettingsUrl:e.get_PpacSettingsUrl(),customizationUrl:e.get_CustomizationUrl(),isCrmOrg:e.get_IsCrmOrg(),yammerGroupId:e.get_YammerGroupId(),yammerNetworkName:e.get_YammerNetworkName(),yammerOAuthAccessTokenExpired:e.get_YammerOAuthAccessTokenExpired(),yammerPostMethod:e.get_YammerPostMethod(),globalHelpUrl:e.get_GlobalHelpUrl(),privacyStatementUrl:e.get_PrivacyStatementUrl(),enableBingMapsIntegration:e.get_EnableBingMapsIntegration(),bingMapsApiKey:e.get_BingMapsApiKey(),availableBingMapLocales:e.get_AvailableBingMapLocales(),excludedCountriesForMaps:e.get_ExcludedCountriesForMaps(),bFDatacenter:e.get_BFDatacenter(),securitySettingForEmail:e.get_SecuritySettingForEmail(),enableActivitiesTimeLinePerfImprovement:e.get_EnableActivitiesTimeLinePerfImprovement(),gridTotalRecordCountLimit:e.get_GridTotalRecordCountLimit(),enableLivePersonaCardUCI:e.get_EnableLivePersonaCardUCI(),livePersonaCardComplianceEnvironment:e.get_LivePersonaCardComplianceEnvironment(),livePersonaCardCulture:e.get_LivePersonaCardCulture(),livePersonaCardFirstPartyIntegrationUrl:e.get_LivePersonaCardFirstPartyIntegrationUrl(),livePersonaCardRegion:e.get_LivePersonaCardRegion(),globalHelpUrlEnabled:e.get_GlobalHelpUrlEnabled(),globalAppendUrlParametersEnabled:e.get_GlobalAppendUrlParametersEnabled(),areJquery3IncompatibleSolutionsInstalled:e.get_AreJquery3IncompatibleSolutionsInstalled(),useQuickFindViewForGridSearch:e.get_UseQuickFindViewForGridSearch(),defaultCrmCustomName:e.get_DefaultCrmCustomName(),newSearchExperienceEnabled:e.get_NewSearchExperienceEnabled(),improveSearchLoggingEnabled:e.get_ImproveSearchLoggingEnabled()};t(function(e){return{type:S,payload:e}}({userState:_,orgState:{initialized:o.a.Initialized,organizationName:e.get_OrganizationName(),organizationId:s.a.fromLegacyGuid(e.get_OrganizationId()),serverVersion:e.get_ServerVersion(),serverDatabaseVersion:e.get_ServerDatabaseVersion(),organizationSettings:h(n(),v),overallVersionNumber:Number(e.get_MetadataLastModifiedTime()),organizationTenant:e.get_OrganizationTenant(),environmentId:s.a.fromLegacyGuid(e.get_EnvironmentId())},selectedForms:y}))}}}(t)),e(Object(l.c)(t)),e(function(e){if(!e)return null;const t=Number(e.get_MetadataLastModifiedTime()),n=Number(e.get_UserMetadataLastModifiedTime()),r={initialized:o.a.Initialized,lastVersion:t,currentVersion:t},a={initialized:o.a.Initialized,lastVersion:n,currentVersion:n};return{type:u.a,payload:{metadataVersion:r,userMetadataVersion:a}}}(t))}function N(e){for(;e&&-1!==e.indexOf("\\x");)e=e.replace("\\x","%");for(;e&&-1!==e.indexOf("'");)e=e.replace("'","");return e}function A(e,t){return{type:S,payload:{userState:{initialized:o.a.Uninitialized,userSettings:{usePathBasedUrls:!t}},orgState:{initialized:o.a.Uninitialized,organizationSettings:{organizationUniqueName:e}},selectedForms:{}}}}},"x/BX":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return!!(e&&e.metadata&&e.metadata.consistencyStrong)&&e.metadata.consistencyStrong}n.d(t,"a",(function(){return r}))},"x/aW":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r,a=n("SAYH"),i=n("3ZcW");function o(e){const t=e&&Array.isArray(e.Exclude)&&e.Exclude.map(a.a.fromLegacyGuid)||[],n=new i.a;var r;return n.MetadataType=(r=e.MetadataType)&&s[r]?s[r]:r,n.MetadataSubtype=e.MetadataSubtype,n.EntityLogicalName=e.EntityLogicalName,n.MetadataId=a.a.fromLegacyGuid(e.MetadataId),n.MetadataNames=e.MetadataNames,n.GetDefault=e.GetDefault,n.DependencyDepth=e.DependencyDepth,n.ChangedAfter=e.ChangedAfter,n.Exclude=t,n.AppId=e.AppId&&a.a.fromLegacyGuid(e.AppId)||null,n}!function(e){e.BusinessProcessFlow="businessprocessflow",e.MetadataVersion="metadataversion",e.UserMetadataVersion="usermetadataversion",e.BPFSelector="bpfselector"}(r||(r={}));const s={webresourcedescriptor:"webresource"}},x0oY:function(e,t,n){"use strict";n.d(t,"a",(function(){return N})),n.d(t,"c",(function(){return A})),n.d(t,"f",(function(){return T})),n.d(t,"d",(function(){return E})),n.d(t,"e",(function(){return I})),n.d(t,"h",(function(){return j})),n.d(t,"g",(function(){return P})),n.d(t,"l",(function(){return F})),n.d(t,"k",(function(){return k})),n.d(t,"j",(function(){return L})),n.d(t,"i",(function(){return M})),n.d(t,"b",(function(){return C}));var r=n("odYE"),a=n("SAYH"),i=n("504W"),o=n("d7fm"),s=n("LbMF"),c=n("iZ7K"),l=n("FZDd"),u=n("HYaY"),d=n("sdkC"),p=n("S/Br"),g=n("/d6W"),h=n("Jsfi"),f=n("tHaS"),m=n("Ae6N"),b=n("IvgJ"),_=n("wMH2"),y=n("Xd5/"),v=n("SRlt"),S=n("MUIu"),O=n("8nT0");var C;function E(e,t,n,s,c,l,p,g,h,f=C.OData,m){const b=p||n.PrimaryKeyName;c||(c=j(t,f)),-1===c.indexOf("versionnumber")&&t.hasOwnProperty("@odata.etag")&&c.push("versionnumber");const _="string"==typeof t[b]?new a.a(t[b]):a.a.EMPTY,y=new r.a(n.EntityLogicalName,_),v=r.a.toLegacyEntityReference(y);let S=null;Object(i.a)(g)||(S=g.aliasedValueDescriptors);const O=function(e,t,n,r,a,s,c,l,u=C.OData){const d={fieldTypes:{},formattedValues:{},numericFormattedValues:{},fields:{}};for(const p of t)if(Object(i.b)(p)){const e=[{name:"EntityLogicalName",value:null!=n?n.EntityLogicalName:"null"}];c.warn("Empty field name encountered while trying to construct entity record",e)}else if("versionnumber"===p){const t="bigint";d.fields[p]=B(e,a,p,t,n,r,!1,s,c,u),d.fieldTypes[p]=t}else if(l&&a&&a.hasOwnProperty(p)&&a[p]&&l.filter(e=>e.get_relationShipName()===p).length>0)R(e,p,n,a,d,c,l);else{let t=!1;const i=s&&s.hasOwnProperty(p);if(!i&&null==r[p])continue;let l=a.hasOwnProperty(U(p,a,s,i));if(l||(l=a.hasOwnProperty(z(p,u,i))),!l){const r=V(e,p,n,a,s,i);l=a.hasOwnProperty(r)&&a[r].filter(e=>e.participationtypemask===Object(o.a)(i?s[p].aliasedValueEtn:n.EntityLogicalName,i?s[p].aliasedValueFieldName:p)).length>0,t=l}if(l){const o=i?"aliasedvalue":r[p].Type,l=U(p,a,s,i&&s[p].isAttributeAlias),g=U(p,a,s,i&&s[p].oDataAlias.length>1);d.fields[l]=B(e,a,g,o,n,r,t,i?s:null,c,u),d.fieldTypes[l]=o,x(e,g,d,a,u,r,o)}}return d}(e,c,n,s,t,S,h,m,f);return new u.a(v,O.fields,O.fieldTypes,O.formattedValues,O.numericFormattedValues,new d.a([]),l)}function I(e,t,n,r,a,i,o,u=C.OData,d){return{type:"CREATE_ENTITY_RECORD_FROM_RESPONSE_ASYNC",execute({dispatch:p,getState:g},h){const f=j(e,u),m=function(e,t,n,r,a,i){const o=w(n,r).filter(e=>-1===e.indexOf("."));let s;if(o&&o.length>0)if(a){s=a.entity2AttributesMap?a.entity2AttributesMap:{};const e=w(s[t],o);s[t]=e}else s={[t]:o};else s={};if(i)for(const n of i){const r=n.get_relationShipName(),a=Object(c.F)(e,t,r);if(a){const i=0===Object(c.H)(e,t,r)?a.ReferencingEntity:a.ReferencedEntity,o=n.get_columnNames();s[i]=w(s[i],o)}}return s}(g(),t,n,f,i,d);return p(Object(l.e)(m)).then(()=>{const l=Object(s.d)(g(),t),p=Object(c.h)(g(),t),h=(n||[]).concat(m[t].filter(e=>l.hasOwnProperty(e)));return E(g(),e,p,l,h,r,a,i,o,u,d)})}}}function w(e,t){const n=new Set(e||[]),r=e&&e.slice(0)?e.slice(0):[];if(t)for(const e of t)n.has(e)||r.push(e);return r}function j(e,t=C.OData){const n=Object.keys(e).reduce((e,n)=>(-1===n.indexOf("@")&&e.add(P(n,t)),e),new Set);return Array.from(n)}function P(e,t=C.OData){let n=null;return n=t===C.OData?e.match(/_(\w+)_value/i):e.match(/(\w+\.?\w+)!(id|name|logicalname)$/i),n&&n[1]?n[1]:e}function T(e,t){return{type:"DESERIALIZE_RETRIEVE_RESPONSE_ASYNC",execute({dispatch:n,getState:a},i){const o=a(),s=t.get_target(),u=s.LogicalName,d=Object(c.h)(o,u),p=t.get_columnSet();let{columnNames:g}=Object(v.e)(p);const f=t.get_navigationProperty();if(f){const e=[];for(const t of f){const n=t.get_relationShipName();e.push(n)}g=g.concat(e)}const m=[];return e.json().then(e=>{const t=function(e){let t=null;const n=e["@Microsoft.Dynamics.CRM.servernotifications"];if(n)try{t=JSON.parse(n)}catch(e){}return t}(e),a=r.a.fromLegacyEntityReference(s);return t&&t.length?(t.forEach(e=>{e.forRecord=a,e.Parameters.forEach(e=>{if(e.ParameterType===h.a.Attribute){const t=e.Data;g.indexOf(t)<0&&(g.push(t),m.push(t))}})}),n({type:N,payload:{notifications:t}}),n(Object(l.f)(u,!1,m)).then(()=>n(D(u,d,p,g,t,e,f)))):(n(function(e){return{type:A,payload:null,meta:e}}(a)),n(D(u,d,p,g,t,e,f)))})}}}!function(e){e[e.OData=0]="OData",e[e.SQL=1]="SQL"}(C||(C={}));const N="notifications.add",A="notification.remove";function D(e,t,n,r,a,i,o,s=C.OData){return{type:"CREATE_RETRIEVE_RESPONSE_ASYNC",execute({dispatch:t,getState:c},l){const u=(d=a)?d.map(e=>new p.a(e.Severity,e.Message)):null;var d;return t(I(i,e,r,n,null,null,null,s,o)).then(e=>new g.a(e,u))}}}function R(e,t,n,i,o,l,p){for(const g of p){let p=null;const h=g.get_relationShipName();if(h===t){const f=Object(c.F)(e,n.EntityLogicalName,h);if(f){const m=Object(c.H)(e,n.EntityLogicalName,h),b=0===m?f.ReferencingEntity:f.ReferencedEntity,_=g.get_columnNames(),y=Object(s.d)(e,b);if(y){const n=[],s=Object(c.h)(e,b),g=s.PrimaryKeyName;if(0===m){const t=i[h];for(const i of t){const t={fieldTypes:{},formattedValues:{},numericFormattedValues:{},fields:{}},o=new a.a(i[g]),c=new r.a(s.EntityLogicalName,o),h=r.a.toLegacyEntityReference(c);for(const n of _)if(y.hasOwnProperty(n)){p=y[n].Type;const r=B(e,i,n,p,s,y,!1,null,l);t.fields[n]=r,t.fieldTypes[n]=p}if(i.hasOwnProperty(O.c)){p="string";const n=B(e,i,O.c,p,s,y,!1,null,l);t.fields.devicefilepath=n,t.fieldTypes.devicefilepath=p}const f=new u.a(h,t.fields,t.fieldTypes,t.formattedValues,t.numericFormattedValues,new d.a([]));n.push(f)}}else if(2===m){const o=i[h],c={fieldTypes:{},formattedValues:{},numericFormattedValues:{},fields:{}},f=new a.a(o[g]),m=new r.a(s.EntityLogicalName,f),b=r.a.toLegacyEntityReference(m);for(const n of _)if(y.hasOwnProperty(n)){p=y[n].Type;const r=B(e,i[t],n,p,s,y,!1,null,l);c.fields[n]=r,c.fieldTypes[n]=p}const v=new u.a(b,c.fields,c.fieldTypes,c.formattedValues,c.numericFormattedValues,new d.a([]));n.push(v)}o.fields[h]=n,o.fieldTypes[h]="navigationproperty"}}}}}function x(e,t,n,r,a,o,s){if(a===C.OData){const e=L(t);r.hasOwnProperty(e)&&(n.formattedValues[t]=r[e])}else switch(s){case"multiselectpicklist":n.formattedValues[t]=function(e,t){if(!Object(i.a)(e)){const n=e.split(","),r=[];return n.forEach(e=>{const n=t.find(t=>String(t.Value)===e.trim());r.push(n.Label)}),r.join("; ")}return null}(n.fields[t],o[t].OptionSet);break;case"picklist":case"boolean":case"state":case"status":{const e=n.fields[t];e instanceof b.a&&(n.formattedValues[t]=e.get_Label());break}case"customer":case"owner":case"lookup":case"datetime":case"double":case"decimal":case"integer":case"bigint":case"money":{const r=n.fields[t];if(!Object(i.a)(r)){const a=M(e,o,t,s,r,"money"===s&&n.fields[O.w]?n.fields[O.w]:null);Object(i.a)(a)||(n.formattedValues[t]=a)}break}}}function M(e,t,n,a,o,s){let c=null;switch(a){case"customer":case"owner":case"lookup":case"datetime":case"double":case"decimal":case"integer":case"bigint":case"money":if(!Object(i.a)(o)){const i=t[n];let l=null;if("money"===a&&s){const e=r.a.fromLegacyEntityReference(s);l=e?{reference:e}:void 0}const u=Object(y.z)(e,i,l);c="integer"===u.controlAttributes.Type?Object(y.m)(o,u.cultureInfo):Object(y.b)(o,u)}}return c}function F(e){return`_${e}_value`}function k(e){return e+"@Microsoft.Dynamics.CRM.lookuplogicalname"}function L(e){return e+"@OData.Community.Display.V1.FormattedValue"}function B(e,t,n,l,u,d,p,g,h,y=C.OData){let v,O,I=z(n,y);if("versionnumber"===n&&y===C.OData&&t["@odata.etag"]){const e=t["@odata.etag"].match(/W\/\"([0-9a-zA-Z]+)\"/);if(e&&e[1])return e[1]}if(!(p||t.hasOwnProperty(n)||t.hasOwnProperty(I)||g))return null;if(d&&d[n]&&-1!==["lookup","customer","owner"].indexOf(d[n].Type))g&&g.hasOwnProperty(n)&&(I=z(n,y,!0)),v=t[I];else if(d&&d[n]){const e=W(g,t,n),r=g&&g[n]&&g[n].oDataAlias&&g[n].oDataAlias[e]||n;if(O=g&&g[n]&&g[n].rowaggregate||null,v=t[r],g&&g[n]&&g[n].isAttributeAlias&&Object(i.a)(O))return v}else v=t[n];if(!p&&null===v)return null;switch(l){case"aliasedvalue":const{aliasedValueEtn:l,aliasedValueFieldName:w}=g[n],j=Object(c.h)(e,l),P=Object(s.a)(e,l,w);let T;T="CountChildren"===O?"integer":P.Type;const N=new f.a(l,w,T);return v=B(e,t,n,T,j,{[n]:P},p,g,h,y),null==v?null:(N.set_value(v),N);case"customer":case"lookup":case"owner":const A=t[function(e,t,n=C.OData){return n===C.OData?k(t):e+"!logicalname"}(n,I,y)],D=t[function(e,t,n=C.OData){return n===C.OData?L(t):e+"!name"}(n,I,y)];if(A&&v)return r.a.toLegacyEntityReference(new r.a(A,new a.a(v),D));const R=[];return R.push({name:"EntityLogicalName",value:null==d[n]?"null":d[n].EntityLogicalName}),R.push({name:"Attribute Name",value:null==d[n]?"null":d[n].LogicalName}),R.push({name:"Lookup Field EntityLogicalName",value:null==A?"null":A}),R.push({name:"FieldValue",value:null==v?"null":v}),R.push({name:"lookupFormattedValue",value:null==D?"null":D}),function(e,t,n){n&&n.error(e,t)}("_constructFieldValue: Lookup Field EntityLogicalName or FieldValue is null",R),null;case"uniqueidentifier":const x=a.a.tryParseOrNull(v);return x?a.a.toLegacyGuid(x):null;case"datetime":let M;return M=y===C.OData?d&&d[n]&&d[n].Behavior===m.a.TimeZoneIndependent?v.replace(/-\d{2}:\d{2}$/,"Z"):v:Object(S.b)(v),Object(i.b)(v)?null:new Date(Date.parse(M));case"status":case"state":case"boolean":case"picklist":const F=t[L(n)];let U;const z=d[n].OptionSet;return z&&(null==v&&z.DefaultValue&&-1!==z.DefaultValue&&(v=z.DefaultValue),null!=v&&(U=z.find(e=>Number(e.Value)===Number(v)))),U?new b.a(F||U.Label,U.Value,null,null,null,U.Color,null):new b.a(F,v,null,null,null,null,null);case"partylist":return function(e,t,n,r,a,i=!1){if(r&&r.OneToManyRelationships){const l=V(e,t,r,n,a,i);if(!l)return null;const u=n[l];if(!u)return null;const d=Object(c.h)(e,"activityparty"),p=Object(s.d)(e,"activityparty"),g=Object.keys(p),h=u.filter(e=>e.participationtypemask===Object(o.a)(i?a[t].aliasedValueEtn:r.EntityLogicalName,i?a[t].aliasedValueFieldName:t)).map(t=>E(e,t,d,p,g));return new _.a(h,!1,h.length,!1,null,null)}return new _.a([],!1,0,!1,null,null)}(e,n,t,u,g,null!=g&&null!=g[n]);default:return v}}function U(e,t,n,r=!1){if(r&&n&&n[e]){const r=W(n,t,e);return n[e].oDataAlias[r]}return e}function V(e,t,n,r,a,i=!1){const o=i?a[t].aliasedValueEtn:n.EntityLogicalName,s=Object(c.b)(e,o);if(!s)return null;if(i){const e=W(a,r,t);return`${a[t].alias}${a[t].oDataSeparator[e]}${s.ReferencedEntityNavigationPropertyName}`}return""+s.ReferencedEntityNavigationPropertyName}function z(e,t=C.OData,n=!1){return t===C.OData?n?e:F(e):e+"!id"}function W(e,t,n){if(e&&e.hasOwnProperty(n)&&e[n].oDataAlias.length>0)for(let r=0;r<e[n].oDataAlias.length;r++)if(t.hasOwnProperty(e[n].oDataAlias[r]))return r;return 0}},x8sc:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r=(e,t)=>{if(!t||0===t.length)return e;let n=e;return t.forEach(e=>{const t=new RegExp("\\"+e,"g");n=n.replace(t,"\\"+e)}),n}},xAYq:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="_"},xAwK:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("DRVD"),a=n.n(r),i=n("iDqy"),o=n.n(i),s=n("SZCI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let c=!0;function l(e,t,n){if(t&&Array.isArray(t)){if(!performance||!performance.timing||null==performance.timing.navigationStart){if(n){const e=[];e.push({name:"window.performance exists?",value:!!performance}),e.push({name:"window.performance.timing exists?",value:!!performance.timing}),e.push({name:"window.performance.timing.navigationStart exists?",value:null!=performance.timing.navigationStart}),n.warn("Shim metrics have been supplied, but window.performance.timing.navigationStart is not available, preventing any metric comparison",e)}return}c&&(c=!1,function(e){let t=null;try{t=window.parent&&window.parent.performance&&window.parent.performance.timing&&window.parent.performance.timing.navigationStart}catch(t){e&&e.warn("Could not zero performance timeline - failed to get parent NavigationStart")}if(null!==t){const n=t-performance.timing.navigationStart;if(n<0)o.a.overrideWorkBlockStartTime(n);else if(e){const t=[{name:"Difference",value:n}];e.warn("Could not zero performance timeline - bad difference",t)}}}(n)),t.map(t=>{if(!t)return;const r=t.Name,i=t.StartTime,o=t.StopTime,c=t.Parameters;if(!r||"string"!=typeof r||!i||"number"!=typeof i||!o||"number"!=typeof o){if(n){const e=[];e.push({name:"Name",value:r}),e.push({name:"StartTime",value:i}),e.push({name:"StopTime",value:o}),n.warn("Malformed shim performance metric",e)}return}const l=i-performance.timing.navigationStart,u=o-performance.timing.navigationStart,d=Object.assign(Object.assign({},e),c),p=a.a.createEvent(r,s.u);-1===o?p.createMarker(d,l):p.createRetroactiveStopwatch(l,u-l,d)})}}},"xE5/":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="contextualHelpBrowser.close";function a(){return{type:r,payload:{}}}},xHmU:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n("oT5e"),a=n("+nTZ");function i(e,t){let n;const i=[];n=t?Object(r.a)(e,t):Object(r.d)(e);for(const t of n.dialogContextIds){const n=Object(a.a)(e,t);if(n)for(const e of n.pageStack)i.push(e)}return i}function o(e,t){const n=[],r=i(e,t);for(let e=0;e<r.length;e++)-1!==r[e].indexOf("_")&&isNaN(parseInt(r[e],10))||n.push(r[e]);return n}},xKzl:function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.getSessionId=t.setSessionId=t.uploadResultSummary=t.uploadIterationResult=t.startCollectionSession=t.isCollectorActive=void 0;var a=n("GHWt"),i=null;function o(e,t){var n=a.getUCIPerformanceDataCollectionURL();return n?new Promise((function(r,a){var i=new XMLHttpRequest;i.open("POST",n+e,!0),i.onload=function(){r(i.responseText)},i.onerror=a,i.setRequestHeader("Content-type","application/json; charset=utf-8"),i.send(t)})):Promise.resolve()}t.isCollectorActive=function(){var e=a.getUCIPerformanceDataCollectionURL();return null!=e&&e.length>0},t.startCollectionSession=function(){return o("/startsession/","").then((function(e){i=e}))},t.uploadIterationResult=function(e,t,n){return o("/saveiterationresult/",JSON.stringify({sessionId:i,scenarioName:e,iteration:t,json:JSON.stringify(n)}))},t.uploadResultSummary=function(e){var t,n,a,s,c,l,u="";e.error&&(u="Error, "+e.error+"\n");try{for(var d=r(e.scenarios),p=d.next();!p.done;p=d.next()){var g=p.value;if(0!==g.iterationResults.length){u+="Scenario, Iteration, Issues";var h=g.iterationResults[0];try{for(var f=(a=void 0,r(h.keyPerformanceIndicators)),m=f.next();!m.done;m=f.next()){u+=", "+m.value.name}}catch(e){a={error:e}}finally{try{m&&!m.done&&(s=f.return)&&s.call(f)}finally{if(a)throw a.error}}u+="\n";for(var b=0;b<g.iterationResults.length;b++){var _=g.iterationResults[b];u+=g.scenarioConfig.scenarioName+", "+b.toString()+", ",_.issues&&_.issues.length>0&&(u+=_.issues.map((function(e){return e.message})).join(" "));try{for(var y=(c=void 0,r(_.keyPerformanceIndicators)),v=y.next();!v.done;v=y.next()){u+=", "+v.value.value.toFixed()}}catch(e){c={error:e}}finally{try{v&&!v.done&&(l=y.return)&&l.call(y)}finally{if(c)throw c.error}}u+="\n"}}}}catch(e){t={error:e}}finally{try{p&&!p.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}return o("/saverunresults/",JSON.stringify({sessionId:i,result:u}))},t.setSessionId=function(e){i=e},t.getSessionId=function(){return i}},"xM/W":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="offline.setshowreconnectnotificationafterupsync";function a(e){return{type:r,payload:{showReconnectNotificationAfterUpsync:e}}}},xP3K:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("84PK"),a=n("S70w");class i{constructor(e,t,n,r,a){this._transactionCurrencyId=null,this._currencyName=null,this._currencySymbol=null,this._currencyCode=null,this._currencyPrecision=0,this._transactionCurrencyId=e,this._currencyName=t,this._currencySymbol=n,this._currencyCode=r,this._currencyPrecision=a}get_TransactionCurrencyId(){return this._transactionCurrencyId}get_CurrencyName(){return this._currencyName}get_CurrencySymbol(){return this._currencySymbol}get_CurrencyCode(){return this._currencyCode}get_CurrencyPrecision(){return this._currencyPrecision}getObjectData(){const e={};return e.transactioncurrencyid=this._transactionCurrencyId.getObjectData(),e.currencyname=this._currencyName,e.currencysymbol=this._currencySymbol,e.currencycode=this._currencyCode,e.currencyprecision=this._currencyPrecision,e}getCurrencyDisplaySymbol(e){return e===a.a.CurrencyCode?this.get_CurrencyCode():this.get_CurrencySymbol()}static createFromObjectData(e){const t=r.a.createFromObjectData(e.transactioncurrencyid),n=e.currencyname,a=e.currencysymbol,o=e.currencycode,s=e.currencyprecision;return new i(t,n,a,o,s)}}},xPbo:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var r=n("zsAz"),a=n("1OTd"),i=n("oT5e"),o=n("gQ5I"),s=n("tFCh");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e,t,n){return{type:a.q,payload:{currentPage:e,error:null,browsingContextId:n},meta:{pageId:t}}}function l(e,t){return{type:a.q,payload:{currentPage:null,error:e,browsingContextId:t},meta:{pageId:null}}}function u(e){return{type:a.q,payload:{currentPage:null,error:null,browsingContextId:e}}}function d(e){return{type:a.b,execute({dispatch:t,getState:n},r){const c=Object(i.a)(n(),e);return t(Object(o.d)(e)).then(()=>c.pageId&&t(Object(o.f)(c.pageId))).then(()=>t(Object(s.a)(e))).then(()=>t(function(e){return{type:a.c,payload:{browsingContextId:e}}}(e)))}}}function p(e,t=!0){return{type:a.f,sync:!0,execute({dispatch:n,getState:o},s){if(Object(i.c)(o())[e])throw Object(r.d)("Browsingcontext id already been used",2415919107,[{name:"id",value:e}]);n(function(e,t){return{type:a.g,payload:{browsingContextId:e,pushHistoryToBrowser:t}}}(e,t))}}}},xWUA:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("W8lr"),a=function(){function e(){}return e.setEventsHandler=function(e){r.default.setEventsHandler(e)},e.getEventsHandler=function(){return r.default.getEventsHandler()},e.scheduleTimer=function(){r.default.scheduleTimer()},e}();t.default=a},xagu:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return r})),n.d(t,"g",(function(){return a})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return c})),n.d(t,"j",(function(){return l})),n.d(t,"k",(function(){return u})),n.d(t,"l",(function(){return p})),n.d(t,"m",(function(){return d})),n.d(t,"n",(function(){return g})),n.d(t,"o",(function(){return h})),n.d(t,"p",(function(){return f})),n.d(t,"q",(function(){return m})),n.d(t,"r",(function(){return b})),n.d(t,"s",(function(){return _})),n.d(t,"t",(function(){return y})),n.d(t,"u",(function(){return v})),n.d(t,"v",(function(){return S})),n.d(t,"w",(function(){return O})),n.d(t,"a",(function(){return T})),n.d(t,"x",(function(){return C})),n.d(t,"y",(function(){return E})),n.d(t,"D",(function(){return I})),n.d(t,"F",(function(){return w})),n.d(t,"G",(function(){return j})),n.d(t,"E",(function(){return P})),n.d(t,"H",(function(){return N})),n.d(t,"P",(function(){return A})),n.d(t,"Q",(function(){return D})),n.d(t,"K",(function(){return R})),n.d(t,"L",(function(){return x})),n.d(t,"J",(function(){return M})),n.d(t,"O",(function(){return F})),n.d(t,"M",(function(){return k})),n.d(t,"N",(function(){return L})),n.d(t,"I",(function(){return B})),n.d(t,"R",(function(){return U})),n.d(t,"b",(function(){return i})),n.d(t,"S",(function(){return V})),n.d(t,"T",(function(){return z})),n.d(t,"U",(function(){return W})),n.d(t,"V",(function(){return q})),n.d(t,"W",(function(){return H})),n.d(t,"X",(function(){return G})),n.d(t,"Y",(function(){return K})),n.d(t,"Z",(function(){return Q})),n.d(t,"ab",(function(){return X})),n.d(t,"bb",(function(){return Y})),n.d(t,"cb",(function(){return J})),n.d(t,"eb",(function(){return $})),n.d(t,"db",(function(){return Z})),n.d(t,"C",(function(){return ee})),n.d(t,"A",(function(){return te})),n.d(t,"B",(function(){return ne})),n.d(t,"c",(function(){return re})),n.d(t,"z",(function(){return ae})),n.d(t,"d",(function(){return ie}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="customControlId",a="controlName",i="_canOverride",o="cmdbar",s="dashboardid",c="data",l="dialogCancelLabel",u="dialogConfirmLabel",d="dialogHideDownloadLogLink",p="dialogErrorText",g="dialogOptions",h="dialogShowDetailsLabel",f="dialogSubtitle",m="messageText",b="dialogTitle",_="dialogType",y="Unknown ModalDialog Type",v="etn",S="extraqs",O="formid",C="id",E="isCrossEntityNavigate",I="name",w="navitemid",j="navpath",P="navbar",T="bodyOnly",N="pagetype",A="process",D="processinstanceid",R="powerbiembedurl",x="powerbigroupid",M="powerbidashboardid",F="powerbitileid",k="powerbireportid",L="powerbireporturl",B="powerbicomponenttype",U="recordSetQueryKey",V="searchText",z="searchType",W="selectedstageid",q="selectedTabId",H="type",G="uniquename",K="viewid",Q="viewType",X="visualizationid",Y="visualizationPaneMode",J="visualizationType",$="webresourceName",Z="webresourceData",ee="landingPage",te="isOfflineSyncError",ne="preview",re="channelId",ae="embedded",ie="clienthost"},xhhr:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n("NjDY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){const t=Object(r.x)(e);return{isPowerBIEnabled:i(e),firstPartyIntegrationSiteUrl:t&&t.firstPartyIntegrationSiteUrl}}function i(e){const t=Object(r.x)(e);return t&&t.isPowerBIEnabled}},xiom:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("WF3G");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a extends r.a{constructor(e,t){super(e.get_FetchXml()),this._subQueries=t}get_id(){let e=super.get_id();const t=this._subQueries;for(const n in t){const r={key:n,value:t[n]};e+=","+r.key+":"+r.value.get_id()}return e}toString(){let e=super.toString();const t=this._subQueries;for(const n in t){const r={key:n,value:t[n]};e+=","+r.key+":"+r.value.toString()}return e}}},xkcG:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("ABCl"),a=n("IqkD"),i=n("qshH"),o=n("SAYH"),s=n("MXaZ"),c=n("ZIjf"),l=n("Sbn7");let u;class d{constructor(e){u=e,this._clientApiExecutor=new r.b(e,"ClientApi.XrmUserSettings.")}getTimeZoneOffsetMinutes(){const e="ClientApi.XrmUserSettings.getTimeZoneOffsetMinutes";try{c.a.instance.reportCall(e);const t=Object(a.w)(u.getState()),n=t?t.timeZoneUtcOffsetMinutes+Object(s.p)(new Date,t.timeZoneAdjusters):null;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get userId(){const e="ClientApi.XrmUserSettings.userId";try{c.a.instance.reportCall(e);const t=Object(a.x)(u.getState()),n=t?o.a.externalGuid(t.userId):null;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get languageId(){const e="ClientApi.XrmUserSettings.languageId";try{c.a.instance.reportCall(e);const t=Object(a.w)(u.getState()),n=t?t.languageId:null;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get pagingLimit(){const e="ClientApi.XrmUserSettings.pagingLimit";try{c.a.instance.reportCall(e);const t=Object(a.w)(u.getState()),n=t?t.recordsPerPage:null;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get roles(){return this._clientApiExecutor.execute("roles_get",e=>{const t=new l.a(e),n=Object(a.v)(u.getState());for(const e in n){const r={id:e,name:n[e]};t.add(e,r)}return t})}get securityRoles(){const e="ClientApi.XrmUserSettings.securityRoles";try{c.a.instance.reportCall(e);const t=new Array,n=Object(a.v)(u.getState());for(const e in n)t.push(e);return c.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get securityRolePrivileges(){const e="ClientApi.XrmUserSettings.securityRolePrivileges";try{c.a.instance.reportCall(e);const t=new Array,n=Object(a.u)(u.getState());for(const e in n)t.push(n[e].privilegeId.guid);return c.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get userName(){const e="ClientApi.XrmUserSettings.userName";try{c.a.instance.reportCall(e);const t=Object(a.t)(u.getState());return c.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get isGuidedHelpEnabled(){const e="ClientApi.XrmUserSettings.isGuidedHelpEnabled";try{c.a.instance.reportCall(e);const t=Object(a.w)(u.getState()),n=t?t.isGuidedHelpEnabled:null;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get isHighContrastEnabled(){const e="ClientApi.XrmUserSettings.isHighContrastEnabled";try{c.a.instance.reportCall(e);const t=Object(a.w)(u.getState()),n=t?t.isHighContrastEnabled:null;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get isRTL(){const e="ClientApi.XrmUserSettings.isRTL";try{c.a.instance.reportCall(e);const t=Object(a.w)(u.getState()),n=t?t.isRTL:null;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get isEmailConversationViewEnabled(){const e="ClientApi.XrmUserSettings.isEmailConversationViewEnabled";try{c.a.instance.reportCall(e);const t=Object(a.w)(u.getState()),n=t&&!0===t.isEmailConversationViewEnabled;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get autoCaptureUserStatus(){return this._clientApiExecutor.execute("autoCaptureUserStatus_get",()=>{const e=Object(a.w)(u.getState());return e?e.autoCaptureUserStatus:0})}get formatInfoCultureName(){const e="ClientApi.XrmUserSettings.formatInfoCultureName";try{c.a.instance.reportCall(e);const t=Object(a.w)(u.getState()),n=t?t.formatInfoCultureName:null;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get transactionCurrencyId(){const e="ClientApi.XrmUserSettings.transactionCurrencyId";try{c.a.instance.reportCall(e);const t=this.transactionCurrency,n=t?t.id:null;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get dateFormattingInfo(){const e="ClientApi.XrmUserSettings.dateFormattingInfo";try{c.a.instance.reportCall(e);const t=Object(a.w)(u.getState()),n=t?t.dateFormatInfo:null;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get defaultDashboardId(){const e="ClientApi.XrmUserSettings.defaultDashboardId";try{c.a.instance.reportCall(e);const t=Object(a.w)(u.getState()),n=t?o.a.toString(t.defaultDashboardId):null;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get transactionCurrency(){const e="ClientApi.XrmUserSettings.transactionCurrency";try{c.a.instance.reportCall(e);const t=Object(a.w)(u.getState());if(t){const n={id:o.a.toString(t.transactionCurrencyId),entityType:"transactioncurrency",name:t.transactionCurrencyById[o.a.toString(t.transactionCurrencyId)].currencyName};return c.a.instance.reportSuccess(e),n}return i.a.getInstance().reportFailure(e,new Error("User Settings are null")),null}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}}},xmKQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="update.appid";function a(e){return{type:r,payload:{appContext:{app:{appId:e}}}}}},xy1J:function(e,t,n){"use strict";n.d(t,"m",(function(){return f})),n.d(t,"e",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"l",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"k",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"g",(function(){return g})),n.d(t,"j",(function(){return h}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Error_Text_FormToastNotification",a="Duplicates_Detected_Notification_Message",i="Duplicates_Ignore_And_Save",o="Duplicates_View_Duplicates",s="Error_Title_0x8004b056",c="Error_Message_Double_Save",l="Form_NotificationLabel_NameValuePair",u="Form_File_Uploading_Message",d="Form_Image_Uploading_Message",p="Form_Image_File_Upload_Fail_Message",g="Form_File_Upload_Cancelled_Message",h="Form_Image_Upload_Cancelled_Message",f=[r,a,i,o,"Crm.GenericErrorMessage",s,"Error_Title_0x80040220",c,l,"L_InteractionWall_Title",u,d,p,g,h]},"y+Z1":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Forms.SelectFormTab"},"y6/h":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return l}));var r=n("YxC/"),a=n("BDhr"),i=n("wCzE");let o=null;function s(){try{if(null==o){const e=localStorage.getItem("UCI_RESOURCE_STRINGS");o=JSON.parse(e)}return o}catch(e){return null}}function c(e){try{o={strings:Object(r.d)(e),missingStrings:Object(r.a)(e),metadataVersion:Object(a.a)(e).currentVersion,userMetadataVersion:Object(i.a)(e).currentVersion},localStorage.setItem("UCI_RESOURCE_STRINGS",JSON.stringify(o))}catch(e){}}function l(e){try{const t=s();t&&(t.metadataVersion<Object(a.a)(e).currentVersion||t.userMetadataVersion<Object(i.a)(e).currentVersion)&&(localStorage.removeItem("UCI_RESOURCE_STRINGS"),o=null)}catch(e){}}},y60j:function(e,t,n){"use strict";n.d(t,"j",(function(){return _})),n.d(t,"o",(function(){return y})),n.d(t,"x",(function(){return v})),n.d(t,"w",(function(){return S})),n.d(t,"v",(function(){return O})),n.d(t,"a",(function(){return C})),n.d(t,"t",(function(){return E})),n.d(t,"b",(function(){return I})),n.d(t,"f",(function(){return P})),n.d(t,"d",(function(){return N})),n.d(t,"e",(function(){return A})),n.d(t,"c",(function(){return R})),n.d(t,"g",(function(){return T})),n.d(t,"h",(function(){return L})),n.d(t,"i",(function(){return U})),n.d(t,"n",(function(){return V})),n.d(t,"m",(function(){return z})),n.d(t,"r",(function(){return W})),n.d(t,"p",(function(){return x})),n.d(t,"q",(function(){return D})),n.d(t,"k",(function(){return q})),n.d(t,"u",(function(){return H})),n.d(t,"y",(function(){return M})),n.d(t,"l",(function(){return F})),n.d(t,"s",(function(){return B}));var r=n("SAYH"),a=n("AF/G");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i=[new r.a("DFDF1CDE-837B-4AC9-98CF-AC74361FD89D")];var o=n("eXjw"),s=n("3hnk"),c=n("arV0"),l=n("5Oca"),u=n("odYE"),d=n("bT7G"),p=n("BJ7u"),g=n("NjDY"),h=n("iZ7K"),f=n("i1f0"),m=n("LbMF"),b=n("64CY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function _(e,t){return e&&e.metadata&&e.metadata.forms&&t?e.metadata.forms[r.a.toString(t)]:null}function y(e,t){const n=_(e,t);return n?n.initialized:o.a.Uninitialized}function v(e,t){const n=_(e,t);return n&&n.Tabs?n.Tabs:null}function S(e,t){const n=_(e,t);return n&&n.TabNames?Object.keys(n.TabNames).length:null}function O(e,t,n){const r=_(e,t);return r&&r.Tabs?r.Tabs.find(e=>e.Id===n):null}function C(e,t,n,r){const a=O(e,t,n);return a&&a.Columns?a.Columns[r]:null}function E(e,t,n){const r=_(e,t);return r&&r.Sections?r.Sections[n]:null}function I(e,t,n,r){const a=_(e,n);return a&&a.Controls?2===a.FormType||9===a.FormType?w(e,a.Controls[r],a,t):a.Controls[r]:null}function w(e,t,n,r){const o=t&&t.ClassId&&t.ClassId.guid?t.ClassId.guid.toLowerCase():null;if(o){if(i.filter(e=>e.guid===o).length>0)return null}if(t&&t.DataFieldName&&Object(b.f)(t.DataFieldName))return null;if(o&&(o===a.Z.guid||o===a.E.guid||o===a.ab.guid)){let i=!0;if(o===a.Z.guid||o===a.ab.guid){const a=Object(c.g)(e,r);if(a&&a.entityTypeName&&a.id){const r=new u.a(a.entityTypeName,a.id),o=Object(d.c)(e,r);let c="";if(o){const n=Object(d.d)(e,o.snapshotId,r,t.DataFieldName);c=n&&n.reference?n.reference.etn:null}else{const n=Object(l.j)(e,r,t.DataFieldName);c=n&&n.reference?n.reference.etn:null}if(!Object(f.hc)(t.Id,n,c))return t;i=c?Object(s.b)(e,c):i}}else if(o===a.E.guid){let n=null;if(t.Parameters&&Object.keys(t.Parameters).length>0)for(const e of Object.keys(t.Parameters)){const r=t.Parameters[e];r&&"TargetEntityType"===r.Name&&(n=r.Value)}n&&(i=Object(s.b)(e,n))}return i?t:null}return t}function j(e,t,n,r,a){return null==n?void 0:n.filter(t=>t.Name&&w(e,t,r,a))}function P(e,t,n,r){const a=E(e,n,r);return a&&a.Rows?function(e,t,n,r){const a={};for(const i of t.Rows)for(const t of i.Cells){const i=t.ControlName;if(i){const t=I(e,n,r,i);t&&(a[i]=t)}}return a}(e,a,t,n):null}function T(e,t,n,r){const a=O(e,n,r),i={};if(!a)return null;if(a.Columns){let r=0;for(;a.Columns[r];){const o=a.Columns[r];o&&o.SectionNames&&o.SectionNames.forEach(r=>{const a=P(e,t,n,r);a&&Object.assign(i,a)}),r++}}return i}function N(e,t,n){const r=_(e,t);return r&&r.Controls?2===r.FormType||9===r.FormType?function(e,t,n){const r={};return Object.keys(t.Controls).forEach(a=>{if(a){const i=w(e,t.Controls[a],t,n);i&&(r[a]=i)}}),r}(e,r,n):r.Controls:null}function A(e,t,n){const r=_(e,t);if(!r||!r.Header)return null;const a=r.Header.Controls;return a?2===r.FormType||9===r.FormType?j(e,0,a,r,n):a:null}function D(e,t){const n=_(e,t);return n&&n.Header?!!Array.isArray(n.Header)||n.Header.AvailableForPhone:null}function R(e,t,n){const r=_(e,t);if(!r||!r.Footer)return null;const a=r.Footer.Controls;return a?2===r.FormType||9===r.FormType?j(e,0,a,r,n):a:null}function x(e,t){const n=_(e,t);return n&&n.Footer?!!Array.isArray(n.Footer)||n.Footer.AvailableForPhone:null}function M(e,t){let n=null;const r=_(e,t);if(r){const t=Object(h.d)(e,r.EntityLogicalName);if(t&&r.Attributes&&(n=r.Attributes.filter(e=>t.has(e))),t&&r.ControlConfigAttributes)for(let a of r.ControlConfigAttributes){const i=Object(m.a)(e,r.EntityLogicalName,a);i&&(a=i.AttributeOf||a),-1===n.indexOf(a)&&t.has(a)&&n.push(a)}}return n}function F(e,t){const n=_(e,t);return n&&n.FormParameters&&n.FormParameters.length>0?n.FormParameters.map(e=>e.Name):null}function k(e,t,n){if(e&&t&&n){if(!e.metadata.formDefaults)return null;const r=e.metadata.formDefaults[t];if(!r)return null;const a=r[n];return a||null}return null}function L(e,t,n){const r=k(e,t,n);return r?r.formId:null}function B(e,t,n,r){if(null!==t){const n=_(e,t);if(n.initialized!==o.a.Error)return n}const a=L(e,n,r);return null!==a?_(e,a):null}function U(e,t,n){const r=k(e,t,n);return r?r.initialized:o.a.Uninitialized}function V(e,t,n){if(e){const r=e.metadata.formSelectors;if(r&&r[t])return n||(n=Object(p.a)(2)),r[t][n]}return null}function z(e,t,n){if(e){const r=V(e,t);if(r&&n)return r[n.guid]}return null}function W(e,t){const n=_(e,t);return n?n.InlineQuickForms:null}function q(e){if(e.metadata.complexControls&&e.metadata.complexControls.initialized&&e.metadata.complexControls.complexControls&&Object.keys(e.metadata.complexControls.complexControls).length>0){const t={};if(Object.keys(e.metadata.complexControls.complexControls).forEach(n=>t[n.toLowerCase()]=e.metadata.complexControls.complexControls[n]),e.metadata.complexControls.complexControls.FullNameCompositionLinkControl){const n="firstname",r="middlename",a="lastname",i=e.metadata.complexControls.complexControls.FullNameCompositionLinkControl,o=Object(g.h)(e),s=i.indexOf(n),c=i.indexOf(r),l=i.indexOf(a);-1===function(e,t,n,r){t=t||"",n=n||"",r=r||"";let a,i="";i.length>0&&(i=n.substring(0,1));switch(e){case 0:r.length>0&&t.length>0&&(a=[r,t]);break;case 1:t.length>0&&r.length>0&&(a=[t,r]);break;case 2:r.length>0&&(a=[r]),t.length>0&&(a=[r,t]),i.length>0&&(a=[r,t,i]);break;case 3:t.length>0&&(a=[t]),i.length>0&&(a=[t,i]),r.length>0&&(a=[t,i,r]);break;case 4:r.length>0&&(a=[r]),t.length>0&&(a=[r,t]),n.length>0&&(a=[r,t,n]);break;case 5:t.length>0&&(a=[t]),n.length>0&&(a=[t,n]),r.length>0&&(a=[t,n,r]);break;case 6:case 7:a=[r,t];break;default:a=[r]}return a}(o,i[s],i[c],i[l]).indexOf(r)?t.fullnamecompositionlinkcontrol=[n,a]:t.fullnamecompositionlinkcontrol=[n,r,a]}return t}return null}function H(e,t){const n=_(e,t);return n&&n.Sections?Object.keys(n.Sections).length:null}},yGgp:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="clear.popupNotificationAction";function a(e){return{type:r,payload:e}}},yHAP:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c}));var r=n("pEXn"),a=n("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i={};function o(e,t){if(!i[e]){const n={[t]:[]};i[e]=n}return i[e][t]||(i[e][t]=[]),i[e][t]}function s(e,t,n,a){var o,s,c,l;const u=null===(o=i[t])||void 0===o?void 0:o[n];u&&(u.length>0&&(a&&u.push(a),null===(c=null===(s=null==e?void 0:e.TraceManager)||void 0===s?void 0:s.getTracer(`${r.k}${r.m}`))||void 0===c||c.warn(r.n,[{name:r.v,value:`${r.m}.${n}`},{name:r.m,value:JSON.stringify(u)}])),null===(l=i[t])||void 0===l||delete l[n],0===Object.keys(i[t]).length&&delete i[t])}function c(e,t,n){let r="";const i=Object(a.fb)(e,{id:t},n);return Object(a.Eb)(e,t)&&(r=`for subform ${null==i?void 0:i.Name} `),`${r}for entity ${null==i?void 0:i.EntityLogicalName}`}},yHXp:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the ModalDialog page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="ModalDialog"},yJdb:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="appprogressindicator.remove";function a(){return{type:r,payload:{inProgress:!1,progressMessage:null}}}},yQs0:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("504W");class a{constructor(e,t,n){this._entityName=null,this._AttributeName=null,this._Operator=null,this._Value=null,this._ConditionName=null,this._set_attributeName(e),this.set_operator(t),this.set_value(n)}get_entityName(){return Object(r.a)(this._entityName)&&(this._entityName=""),this._entityName}set_entityName(e){return this._entityName=e,e}get_attributeName(){return this._AttributeName}_set_attributeName(e){return this._AttributeName=e,e}get_operator(){return this._Operator}set_operator(e){return this._Operator=e,e}get_value(){return this._Value}set_value(e){return this._Value=e,e}_get_conditionName(){return this._ConditionName}set_conditionName(e){return this._ConditionName=e,e}clone(){const e=new a(this.get_attributeName(),this.get_operator(),this.get_value());return e.set_entityName(this.get_entityName()),e.set_conditionName(this._get_conditionName()),e}}},yRo8:function(e,t,n){"use strict";n.d(t,"h",(function(){return I})),n.d(t,"i",(function(){return j})),n.d(t,"e",(function(){return m})),n.d(t,"a",(function(){return _})),n.d(t,"d",(function(){return v})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return y})),n.d(t,"g",(function(){return S})),n.d(t,"j",(function(){return w})),n.d(t,"f",(function(){return O}));var r=n("eXjw"),a=n("SAYH"),i=n("Uv1Y"),o=n("pEXn"),s=n("KeJu"),c=n("smSa"),l=n("EY5k"),u=n("Py/t"),d=n("wCzE"),p=n("0rLi"),g=n("iJGp"),h=n("RADj"),f=n("iF9X");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const m="offline.sync",b="UC_Download_Metadata_Message",_="offlinebpfentities",y="metadataavailable",v="offlinemetadatasyncstatus",S=[],O="Offline";function C(e,t,n){return e&&e.Metadata?e.Metadata.reduce((r,i)=>{const s=new p.a(null,null,null,a.a.toLegacyGuid(new a.a(i.Id)),[],!1,g.a.Offline,t,[],null);switch(i.Type){case-1:s.MetadataType="ribbon",r.push(s);break;case 1:s.MetadataType="entity",r.push(s);break;case 2:s.MetadataType="attribute",r.push(s);break;case 3:break;case 7:s.MetadataType="label",r.push(s);break;case 9:s.MetadataType="optionset",r.push(s);break;case 10:case 20:break;case 22:s.MetadataType="displaystring",r.push(s);break;case 26:s.MetadataType="savedview",r.push(s);break;case 29:s.MetadataType="businessprocessflow",r.push(s);break;case 59:s.MetadataType="savedvisualization",r.push(s);break;case 60:s.MetadataType="form",r.push(s);break;case 61:s.MetadataType="webresource",r.push(s);break;case 62:s.MetadataType="sitemap";const t=e.AppSpecificMetadata;if(t.SiteMapSelectors&&t.SiteMapSelectors.length){const e=t.SiteMapSelectors.filter(e=>e&&e.SelectorItems&&e.SelectorItems.length&&e.SelectorItems[0].Id===i.Id);e&&e.length&&(s.AppId=e[0].AppId)}r.push(s);break;case 64:s.MetadataType="complexcontrol",r.push(s);break;case 66:s.MetadataType="customcontrol",r.push(s);break;case 68:s.MetadataType="customcontroldefaultconfig",r.push(s);break;case 80:s.MetadataType="appmodules",r.push(s);break;case 161:break;default:const a=[],c="Unknown metadata component type in offline sync";a.push({name:o.b.ComponentType,value:i.Type}),n.error(c,a)}return r},[]):null}function E(e,t,n=g.a.Offline,r=null){return new p.a(e,null,null,null,[],!1,n,t,[],r)}function I(e=null){return{type:"offline.sync.async",execute({dispatch:t,getState:n},r){const i=n(),o=r.TraceManager.getTracer(O),p=[];if(e||o.warn("OfflineSync: Download the offline Data via Download button on the status page."),!Object(f.e)(i))return t(j({syncStatus:h.a.InProgress})),t(Object(l.e)([b])).then(()=>{const e=r.DataSource;return e.get_ApplicationStatusProvider().isOfflineSyncDone()?Promise.resolve(null):e.clearEntityAttributeApplicationMetadata().nativePromise()}).then(()=>{if(!e)return t(Object(s.c)()).then(t=>{t&&(e=t)})}).then(()=>t(Object(s.f)())).then(i=>t(Object(s.e)()).then(o=>{const c=n(),l=Object(d.a)(c);let p="";!p&&l&&l.currentVersion&&(p=l.currentVersion.toString());const f=function(e,t,n,r){let i=[];const o={metadataQueries:[],selectorPromises:[]},s=t.TraceManager.getTracer(O);for(const n of e){o.metadataQueries.push(...C(n,r,s)),i=i.concat(n.BPFEntities);const e=t.DataSource.get_LocalDataSource().StoreApplicationMetadata(n.AppSpecificMetadata).nativePromise();if(o.selectorPromises.push(e),n.ResourceStrings&&n.ResourceStrings.length||S&&S.length){const e=E("resourcestring",r);n.ResourceStrings&&n.ResourceStrings.length&&(e.MetadataNames=n.ResourceStrings),S&&S.length&&e.MetadataNames.push(...S),o.metadataQueries.push(e)}const c=n.AppSpecificMetadata;c&&c.AppModuleSelectors&&c.AppModuleSelectors.length&&c.AppModuleSelectors.forEach(e=>{e.SelectorItems&&e.SelectorItems.length&&e.SelectorItems.forEach(e=>{e.IsOfflineEnabled&&o.metadataQueries.push(E("quickcreatemenu",r,g.a.Offline,a.a.toLegacyGuid(a.a.tryParseOrNull(e.Id))))})})}n(Object(u.b)(i)),t.DataSource.saveSessionState(_,i,!1);const c=["userworkspace","userview","uservisualization"].map(e=>E(e,r,g.a.OnDemandWithoutContext));o.metadataQueries.push(...c);const l=["search"].map(e=>E(e,r));return o.metadataQueries.push(...l),o}(function(e,t){if(!t||!t.length||!e.length)return e;const n=e[0],r=t[0],a=n.ResourceStrings.filter(e=>-1===r.ResourceStrings.indexOf(e));n.ResourceStrings=a;const i={};r.Metadata.forEach(e=>{i[e.Id]=e});const o=n.Metadata.filter(e=>{if(!i[e.Id])return!0;const t=i[e.Id];return e.Version!==t.Version||!e.Version||!t.Version});return n.Metadata=o,[n]}(o,i),r,t,p),m=function(e,t,n=750){const r=e.length;let a=null,i=0,o=0;for(;i<r;){const s=e.slice(i,i+n);if(s.length>0){i+=s.length;const e=()=>t(P(s,r,o)).then(e=>o+=e);a=a?a.then(e):e()}}a||(t(j({syncStatus:h.a.InSyncWithServer,itemsToSync:r,itemsSynced:0,metadataAvailable:!0})),a=Promise.resolve());return a}(f.metadataQueries,t);return Promise.all(f.selectorPromises.concat(m)).then(()=>{e&&(t(Object(s.g)(e)),r.DataSource.updateApplicationMetadataVersionStamps(e))})})).then(()=>{w(r,y,!0),w(r,v,h.a.InSyncWithServer),r.EventManager.ReportComponentSuccess("OfflineSync");const e=Object(c.d)(n());r.EventManager.ReportComponentPerformance("OfflineSync","downloadSize",e.downloadSize),r.EventManager.ReportComponentPerformance("OfflineSync","downloadTime",e.downloadTime),r.EventManager.ReportComponentPerformance("OfflineSync","parseTime",e.parseTime),r.EventManager.ReportComponentPerformance("OfflineSync","persistTime",e.persistTime)},e=>{throw w(r,v,h.a.SyncPendingFromServer),r.EventManager.ReportComponentFailure("OfflineSync",e),e});{const e=!0;t(j({syncStatus:h.a.InSyncWithServer,metadataAvailable:e})),w(r,y,e),p.push({name:y,value:e}),w(r,v,h.a.InSyncWithServer),p.push({name:v,value:h.a.InSyncWithServer}),o.warn("OfflineSync: Application Metadata is downloading in the background.",p)}}}}function w(e,t,n){if(e&&e.DataSource&&"function"==typeof e.DataSource.saveSessionState&&"string"==typeof t){const r={};r[t]=n,e.DataSource.saveSessionState(t,r,!1)}}function j(e){const t={offlineSync:Object.assign({initialized:r.a.Initialized},e)};return{type:m,payload:t}}function P(e,t,n){return{type:"offline.sync.batch.async",execute({dispatch:r,getState:a},o){const s=o.DataSource;return r(j({syncStatus:h.a.InProgress,itemsToSync:t,itemsSynced:n})),s.syncClientMetadata(e).nativePromise().then(()=>{const a=n+e.length,i=t!==a?h.a.InProgress:h.a.InSyncWithServer;return i===h.a.InSyncWithServer?(r(j({syncStatus:i,itemsToSync:t,itemsSynced:a,metadataAvailable:!0})),w(o,y,!0),w(o,v,h.a.InSyncWithServer)):r(j({syncStatus:i,itemsToSync:t,itemsSynced:a})),e.length},e=>(r(j({syncStatus:h.a.SyncPendingFromServer})),Object(i.b)(e),null))}}}},ybGo:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n("504W"),a=n("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e){return e&&e.offline&&e.offline.client&&!Object(r.a)(e.offline.client.upSyncStatus)?e.offline.client.upSyncStatus:null}function o(e,t){let n=!1;const r=Object(a.a)(e,t);return r&&(n=!!r.__isSyncErrorStatusUpdated),n}},ybOb:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){const t=(new DOMParser).parseFromString(e,"text/xml"),n=t.getElementsByTagName("theme")[0].childNodes,r={};for(let e=0;e<n.length;e++)r[n[e].nodeName]=n[e].childNodes[0]?n[e].childNodes[0].nodeValue:"";return r.themeId=t.getElementsByTagName("theme")[0].getAttribute("themeId"),r}n.d(t,"a",(function(){return r}))},ycdb:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("SAYH"),a=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="businessProcessFlow.addIgnoreBpfCheckToRecordData";function o(e,t){if(r.a.equals(t.id,r.a.EMPTY)){const n={entities:{[t.etn]:{[r.a.toString(t.id)]:{initialized:a.a.Initialized,ignoreBpfOnRecord:e}}}};return{type:i,payload:n}}return null}},"z+5+":function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"f",(function(){return _})),n.d(t,"l",(function(){return y})),n.d(t,"d",(function(){return v})),n.d(t,"g",(function(){return S})),n.d(t,"h",(function(){return E})),n.d(t,"b",(function(){return I})),n.d(t,"c",(function(){return w})),n.d(t,"i",(function(){return j})),n.d(t,"k",(function(){return P})),n.d(t,"j",(function(){return T}));var r=n("3/02"),a=n("Lyxw"),i=n("504W"),o=n("hirD"),s=n("69Qu"),c=n("GYEz"),l=n("w1eR"),u=n("17x/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d=["Create","Update"],p=["Create","Update","Delete"],g=[],h=[],f=["Create","Update"];function m(e){return!!Object(i.a)(e)||(Object(c.a)(e)===l.a.Browser?Object(s.b)(e)||Object(u.h)(e):Object(c.a)(e)!==l.a.MailApp)}function b(e){return C(e,r.Bc)}function _(e){return C(e,r.Cc)}function y(e,t){return b(e)&&t&&t.useModernQueryBuilder}function v(e,t,n){return C(e,r.Ac)&&function(e){if(!Object(i.a)(e)&&!Object(i.a)(e.MetadataType))switch(e.MetadataType.toLowerCase()){case"webresource":case"webresourcedescriptor":return!1}return!0}(n)}function S(e,t){return C(e,r.Dc)}function O(e){return Object(a.c)(e,r.yc)&&m(e)}function C(e,t){return Object(a.c)(e,t)&&m(e)}function E(e,t){return O(e)&&g.includes(t.get_name())||function(e,t){return I(e)&&d.includes(t)}(e,t.get_name())||function(e,t){return C(e,r.zc)&&t instanceof o.a&&Object(s.b)(e)&&0===t.get_requests().filter(e=>!d.includes(e.get_name())).length}(e,t)}function I(e){return C(e,r.wc)}function w(e){return C(e,r.xc)}function j(e,t){return C(e,r.zc)&&Object(s.b)(e)&&"ExecuteMultiple"===t.getMetadata().operationName&&0===[].concat(...t.requests).filter(e=>!p.includes(e.getMetadata().operationName)).length}function P(e,t){return O(e)&&h.includes(t)||function(e,t){return I(e)&&p.includes(t)}(e,t)}function T(e,t){return P(e,t.getMetadata().operationName)||j(e,t)}},z0a7:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("nuS9"),a=n("u+q+"),i=n("EY5k"),o=n("YxC/"),s=n("2YQW");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e){const t=Object(a.c)(),n=Object(a.d)(t=>Object(o.e)(t,e),s.e);return r.useEffect(()=>{t(Object(i.e)(e))},[t,e]),n}},z4z4:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.collectMemory=t.setMemoryCollector=void 0,t.setMemoryCollector=function(e){r=e},t.collectMemory=function(){return r?r():Promise.resolve(-1)}},z6CD:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("arV0"),a=n("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t){return Object(r.g)(e,t)}function o(e,t){const n=Object(a.a)(e,t);return n?n.output:null}},zAhX:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Draft=0]="Draft",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed",e[e.Failed=3]="Failed",e[e.NetworkError=4]="NetworkError"}(r||(r={}))},zVFX:function(e,t,n){"use strict";n.d(t,"b",(function(){return F})),n.d(t,"a",(function(){return M})),n.d(t,"d",(function(){return N})),n.d(t,"f",(function(){return A})),n.d(t,"e",(function(){return D})),n.d(t,"c",(function(){return R}));var r=n("BzKn"),a=n("SocB");const i="'Segoe UI Regular', 'SegoeUI', 'Segoe UI'",o="1px dashed black",s=a.d.Blue.Blue3,c=a.d.Clay.Clay3,l=a.d.Black,u=a.d.Blue.Blue7,d=a.d.Blue.Blue8,p=a.d.Purple.Purple6,g=a.d.Purple.Purple7,h=a.d.Blue.Blue3,f={MEASURE015:"0.125rem",MEASURE025:"0.25rem",MEASURE050:"0.5rem",MEASURE075:"0.75rem",MEASURE085:"0.875rem",MEASURE100:"1.00rem",MEASURE115:"1.125rem",MEASURE1143:"1.125rem",MEASURE125:"1.25rem",MEASURE150:"1.50rem",MEASURE175:"1.75rem",MEASURE200:"2.00rem",MEASURE225:"2.25rem",MEASURE250:"2.50rem",MEASURE275:"2.75rem",MEASURE285:"2.875rem",MEASURE300:"3.00rem",MEASURE325:"3.25rem",MEASURE350:"3.50rem",MEASURE375:"3.75rem",MEASURE400:"4.00rem",MEASURE450:"4.50rem",MEASURE500:"5.00rem",MEASURE550:"5.50rem",MEASURE600:"6.00rem",MEASURE675:"6.75rem",MEASURE700:"7.00rem",MEASURE750:"7.50rem",MEASURE775:"7.75rem",MEASURE900:"9.00rem",MEASURE1075:"10.75rem",MEASURE2875:"28.75rem"},m={MEASURE015:"0.142857rem",MEASURE025:"0.285714rem",MEASURE050:"0.5rem",MEASURE075:"0.714286rem",MEASURE085:"0.857142rem",MEASURE100:"1.00rem",MEASURE115:"1.143rem",MEASURE1143:"1.143rem",MEASURE125:"1.285714rem",MEASURE150:"1.50rem",MEASURE175:"1.714286rem",MEASURE200:"2.00rem",MEASURE225:"2.285714rem",MEASURE250:"2.50rem",MEASURE275:"2.714286rem",MEASURE285:"2.857142rem",MEASURE300:"3.00rem",MEASURE325:"3.285714rem",MEASURE350:"3.50rem",MEASURE375:"3.714286rem",MEASURE400:"4.00rem",MEASURE450:"4.50rem",MEASURE500:"5.00rem",MEASURE550:"5.50rem",MEASURE600:"6.00rem",MEASURE675:"6.714286rem",MEASURE700:"7.00rem",MEASURE750:"7.50rem",MEASURE775:"7.714286rem",MEASURE900:"9.00rem",MEASURE1075:"10.714286rem",MEASURE2875:"28.714286rem"};let b={MEASURE015:"0.15rem",MEASURE025:"0.25rem",MEASURE050:"0.5rem",MEASURE075:"0.75rem",MEASURE085:"0.85rem",MEASURE100:"1.00rem",MEASURE115:"1.15rem",MEASURE1143:"1.143rem",MEASURE125:"1.25rem",MEASURE150:"1.50rem",MEASURE175:"1.75rem",MEASURE200:"2.00rem",MEASURE225:"2.25rem",MEASURE250:"2.50rem",MEASURE275:"2.75rem",MEASURE285:"2.85rem",MEASURE300:"3.00rem",MEASURE325:"3.25rem",MEASURE350:"3.50rem",MEASURE375:"3.75rem",MEASURE400:"4.00rem",MEASURE450:"4.50rem",MEASURE500:"5.00rem",MEASURE550:"5.50rem",MEASURE600:"6.00rem",MEASURE675:"6.75rem",MEASURE700:"7.00rem",MEASURE750:"7.50rem",MEASURE775:"7.75rem",MEASURE900:"9.00rem",MEASURE1075:"10.75rem",MEASURE2875:"28.75rem"};const _=200,y=300,v=400,S=600,O=700,C={FontXS:"0.7142857rem",FontS:"0.8571428rem",FontB:"1rem",FontM:"1rem",FontL:"1.2142857rem",FontXL:"1.5rem",Font065:"0.642857rem",Font075:"0.7142857rem",Font085:"0.8571428rem",Font100:"1.00rem",Font1143:"1.143rem",Font115:"1.143rem",Font125:"1.2142857rem",Font150:"1.50rem",Font175:"1.785714rem",Font200:"2.00rem",Font225:"2.2857143rem",Font10px:"0.7142857rem",Font12px:"0.8571428rem",Font14px:"1rem",Font16px:"1.143rem",Font18px:"1.2857143rem",Font20px:"1.4285714rem",Font21px:"1.5rem",Font24px:"1.7142857rem",Font28px:"2.00rem",Font32px:"2.2857143rem",SiteMapOfflineStatusIcon:"1.00rem",TextBox:{FontIcon:"1.00rem",Font:"1.00rem",ErrorFont:"0.92857rem",FontWeight:400,ContentFontWeight:600}},E={FontXS:"0.750rem",FontS:"0.875rem",FontB:"1rem",FontM:"1rem",FontL:"1.25rem",FontXL:"1.5rem",Font065:"0.625rem",Font075:"0.75rem",Font085:"0.875rem",Font100:"1.00rem",Font1143:"1.125rem",Font115:"1.125rem",Font125:"1.25rem",Font150:"1.50rem",Font175:"1.75rem",Font200:"2.00rem",Font225:"2.25rem",Font10px:"0.625rem",Font12px:"0.75rem",Font14px:"0.875rem",Font16px:"1.00rem",Font18px:"1.124rem",Font20px:"1.25rem",Font21px:"1.3125rem",Font24px:"1.5rem",Font28px:"1.75rem",Font32px:"2.00rem",SiteMapOfflineStatusIcon:"1.00rem",TextBox:{FontIcon:"1.00rem",Font:"1.00rem",ErrorFont:"0.875rem",FontWeight:400,ContentFontWeight:600}};let I={FontXS:"0.750rem",FontS:"0.875rem",FontB:"1rem",FontM:"1rem",FontL:"1.25rem",FontXL:"1.5rem",Font065:"0.65rem",Font075:"0.75rem",Font085:"0.85rem",Font100:"1.00rem",Font1143:"1.143rem",Font115:"1.15rem",Font125:"1.25rem",Font150:"1.50rem",Font175:"1.75rem",Font200:"2.00rem",Font225:"2.25rem",Font10px:"0.7142857rem",Font12px:"0.8571428rem",Font14px:"1rem",Font16px:"1.143rem",Font18px:"1.2857143rem",Font20px:"1.4285714rem",Font21px:"1.5rem",Font24px:"1.7142857rem",Font28px:"2.00rem",Font32px:"2.2857143rem",SiteMapOfflineStatusIcon:"1.00rem",TextBox:{FontIcon:"1.00rem",Font:"1.00rem",ErrorFont:"0.9rem",FontWeight:400,ContentFontWeight:600}},w=l,j=Object(a.g)(l,a.c),P="1px solid "+a.d.Grey.Grey5,T="0.857em";function N(){b=f,I=E,M=x()}function A(){b=m,I=C,M=x()}function D(e){w=e?u:p,j=e?Object(a.f)(d):Object(a.f)(g),P="none",T=0,M=x()}function R(e){const t=e.Colors;a.d.Blue.Blue3=t.Palette.Primary01,a.d.Blue.Blue5=t.Palette.Primary04,a.d.Grey.Grey1=t.Palette.Neutral03,a.d.Grey.Grey3=t.Palette.Neutral06,a.d.Grey.Grey5=t.Palette.Neutral12,a.d.Grey.Grey6="#484644",a.d.Grey.Grey7=t.Palette.Neutral13,a.d.Clay.Clay3=t.Palette.Primary01,M=x(),M.colors.TextBox.Red=t.Palette.Error01}function x(){return{fontSizes:{Normal:"13px",Small:"10px",RecordSetNavigatorItem:"1.2em",QuickLaunchBarIcon:"16px",FontXS:I.FontXS,FontS:I.FontS,FontB:I.FontB,FontM:I.FontM,FontL:I.FontL,FontXL:I.FontXL,Font065:I.Font065,Font075:I.Font075,Font085:I.Font085,Font100:I.Font100,Font1143:I.Font1143,Font115:I.Font115,Font125:I.Font125,Font150:I.Font150,Font175:I.Font175,Font200:I.Font200,Font225:I.Font225,Font10px:I.Font10px,Font12px:I.Font12px,Font14px:I.Font14px,Font16px:I.Font16px,Font18px:I.Font18px,Font20px:I.Font20px,Font21px:I.Font21px,Font24px:I.Font24px,Font28px:I.Font28px,Font32px:I.Font32px,SiteMapOfflineStatusIcon:I.SiteMapOfflineStatusIcon,TextBox:I.TextBox,Header:{Header1:"2.5em",Header2:"1.875em",Header3:"1.0em",Header4:"0.587em",Header5:"0.354em"},Dialog:{TitleFontSize:"21px",SubtitleFontSize:"14px",TextFontSize:"14px"}},colors:{Highlight:"#F7EE7F",FocusHighlight:"#F26158",NormalText:"#F26197",HeaderText:"#F26151",Section:"#F26157",Column:"#D26057",Page:"#F20057",QuickLaunchBar:a.d.Grey.Grey7,QuickLaunchBarHover:a.d.Grey.Grey5,EntityIcon:a.d.White,EntityLabel:a.d.White,QuickLaunchBarIcon:a.d.White,QuickLaunchBarButtonBorderColor:a.d.Teal.Teal2,ProcessControl:"#D24726",SectionBorder:"#CFCDCC",LookupTagBackground:"#ECF4FA",WhiteBackground:a.d.White,SemanticZoomOverlayBackground:"rgba(0,0,0,0.2)",SemanticZoomTileBackground:"grey",QuickCreateFormButtonBackgroundColor:"transparent",QuickCreateFormButtonWidth:"40%",FormHeaderBackgroundColor:"#ffffff",SemanticZoomHighlightedItemColor:"orange",SiteMap:{Default:a.d.Grey.Grey7,RefreshedDefault:a.d.Grey.Grey1,GroupText:a.d.Teal.Teal2,RefreshedGroupText:a.d.Grey.Grey7,RefreshedPinUnpinFill:a.d.Grey.Grey3,CollapsedGroupSeparator:a.d.Grey.Grey3,AreaBar:a.d.Grey.Grey6,AreaBarItemText:a.d.White,AreaBarItemIcon:a.d.White,RefreshedBarItemIcon:a.d.Grey.Grey7,AreaBarItemActive:a.d.Grey.Grey5,SubAreaItemActive:a.d.Grey.Grey5,AppLauncherBar:a.d.Grey.Grey6,AppLauncherBorder:a.d.Teal.Teal2,AreaItemBorder:a.d.Teal.Teal2,AppLauncherText:a.d.White,EntityOfflineStatusIcon:{Disabled:a.d.Red.Red2,Enabled:a.d.Green.Green2},DWaffle:{Text:a.d.White,Fill:a.d.Teal.Teal2},NavigationBarMobile:{Text:a.d.Grey.Grey6,Fill:a.d.Grey.Grey3},NavigationBarMobileActive:{Text:a.d.White,Fill:a.d.Grey.Grey5},NavigationItem:{Text:a.d.White,Fill:a.d.Grey.Grey6},NavigationTitle:{Text:a.d.Teal.Teal2,Fill:a.d.Transparent},NavigationShelf:{Text:a.d.White,Fill:a.d.Grey.Grey6,Stroke:a.d.Teal.Teal2},NavBarAppButton:{Text:Object(a.e)("#1ab7c2"),Fill:"#1ab7c2"},NavBarAreaIcon:{Text:Object(a.e)("#EEEEEE"),Fill:"#EEEEEE"},RefreshedRow:{Text:a.d.Grey.Grey7,Fill:a.d.White}},BaseColor:a.d,FormFooter:{PrimaryButtonBackground:"rgba(22, 155, 213, 1)"},TextBox:{Label:"#444444",Content:"#000000",Line:"#DDDDDD",HoverBox:a.d.Grey.Grey5,Background:a.d.White,ErrorBackground:a.d.White,Red:"#EA0600",Blue:"#0000FF",RestMode:"#FFFFFF"},Dialog:{Border:"#EAEAEA",CloseIconBackground:"transparent",HeaderFont:"#333333",PrimaryButtonBackground:"rgba(22, 155, 213, 1)",DefaultButtonBackground:"rgba(255, 255, 255, 1)",DefaultButtonBorder:"rgba(204, 204, 204, 1)",PrimaryButtonText:"white",BackgroundShadow:"rgba(0, 0, 0, 0.5)"},AppShell:{Selected:"#0063B1",NotSelected:"#616161",SetupButtonContainerBorder:"#BDC3C7",SetupName:"#F1F1F1",AdvancedSetupSummaryStyle:"#4A4A4A",AdvancedSettingBackgroundColor:"#696969",AdvancedSettingScrollbarColor:"#555555",NotificationIconError:"#C3574B",NotificationIconSuccess:"#4BDA11",NotificationIconInformation:"#2BB2F5",NotificationIconAttention:"#616161",NotificationViewError:"#F2DEDE",NotificationViewSuccess:"#DFF0D8",NotificationViewInformation:"#D9EDF7",NotificationViewAttention:"#FCF8E3"},Title:{Text:"#F26151",Fill:a.d.Transparent},Entity:{Text:Object(a.e)("#006551"),Fill:"#001CA5"},CustomEntity:{Text:Object(a.e)("#006551"),Fill:"#006551"},Control:{Text:Object(a.e)("#F3F1F1"),Fill:"#F3F1F1",Stroke:"#CCCCCC"},Link:{Normal:{Text:a.d.Blue.Blue3,Fill:a.d.Transparent},Hover:{Text:a.d.Blue.Blue5,Fill:a.d.Transparent},Visited:{Text:a.d.Purple.Purple4,Fill:a.d.Transparent},Pressed:{Text:a.d.Blue.Blue5,Fill:a.d.Transparent},Disabled:{Text:a.d.Grey.Grey5,Fill:a.d.Transparent}},Status:{Alert1:{Fill:a.d.Red.Red4,Text:a.d.White},Alert2:{Fill:a.d.Red.Red2,Text:a.d.Black},Priority1:{Fill:a.d.Orange.Orange4,Text:a.d.White},Priority2:{Fill:a.d.Orange.Orange3,Text:a.d.Black},Priority3:{Fill:a.d.Yellow.Yellow3,Text:a.d.Black},Positive1:{Fill:a.d.Green.Green4,Text:a.d.White},Positive2:{Fill:a.d.Green.Green3,Text:a.d.Black},Info1:{Fill:a.d.Blue.Blue3,Text:a.d.White},Neutral1:{Fill:a.d.Grey.Grey5,Text:a.d.White}},AccentThemeColor:{Accent1:Object(a.f)(c),Accent2:Object(a.g)(c,a.a),Accent3:Object(a.h)(c)},MainThemeColor:{MainColor1:Object(a.f)(s),MainColor2:Object(a.g)(s,a.c),MainColor3:Object(a.h)(s)},PageHeader:{Text:"",Fill:""},PagePanel:{Text:"",Fill:""},DefaultSurface:{Text:a.d.Black,Fill:a.d.White},NavBar:{NavBar1:Object(a.f)(w),NavBar2:j,NavBar3:Object(a.h)(w)}},sizes:{NavbarHeight:"3.43rem",NavButtonHeight:b.MEASURE300,NavBarHeightMobile:b.MEASURE300,EntityLabelMarginLeft:"15px",ControlPadding:"5px",SectionBorderWidth:"2px",TabBorderWidth:"3px",SmallMargin:"7px",SmallPadding:"5px",RecordSetNavigator:{listItemHeight:"6.00rem",listItemLineHeight:"1.40rem",listItemTextMaxWidth:"9.375rem",entityImageMarginTop:"1.50rem",recordNameAttributeWrapperMaxWidth:"14.79rem",recordPrimaryNameMaxHeight:"2.80rem",width:"19.29rem"},EditForm:{MainSectionPadding:"15px",TabHeaderBodyContainerMargin:"0.5%",TabPlaceholdRowHeightEm:3,TabListItemMaxWidth:"30ch",ScrollableTabListItemMaxWidth:"66vw",TabListItemMargin:"20px",ScrollableTabListItemPadding:"16px"},QuickCreateForm:{CancelButtonPadding:"0.625rem",ButtonMinWidth:"6em",ButtonMaxWidth:"25em"},LookupControl:{TagPadding:"6px",TagMargin:"-5px"},Dialog:{Width:"30rem",Height:"20rem",AlertHeight:"14rem",MobileModeSize:480,GeneralMargin:"30px",ContentContainerMargin:"30px 30px 0 30px",BorderWidth:"1px",CloseIconSize:"32px",ButtonHeight:"32px",ButtonWidth:"75px",ButtonMargin:"26px",DefaultButtonBorderWidth:"1px",TitleLineHeight:"28px",SubtitleLineHeight:"19px",TextLineHeight:"19px",ButtonViewWidth:"160px",CloseIconPositionOffsetSmallScreen:"-0.75rem",CloseIconPositionOffsetLargeScreen:"-0.5rem"},TextBox:{Spacing:"0.25em",NotificationIconContainerHeight:"calc(100% - 0.5em)",ContainerSpacing:"0.75em",RightMargin:"2em",LineHeight:"1.5em",LineThickness:"1px",ErrorLineThickness:"2px",HorizontalPadding:"0.5em",VerticalPadding:"0.5em",MaxLength:200},Section:{SectionWidth:340,cellHeightInRem:3.5,CellBreakPointWidth:340},SiteMap:{Width:"19.29em",AreaItemBorder:b.MEASURE025,AppLauncherBorder:"1px",EntityOfflineStatusIconWidth:"2.5rem",RefreshedWidth:"14.286em",RefreshedWidthCollapsed:"3.143em"},QuickLaunchBar:{ButtonBorderSize:b.MEASURE025},HeaderFields:{MinimumCellWidthEm:17,HeaderFieldMarginEm:3,MaximumCellWidth:"17em",ExpandButtonWidthPx:42,ExpandButtonMarginTop:"0.695rem",ExpandButtonMarginTopHeaderCollapsed:"0.3rem",CellContainerSpacerWidthPx:42},FooterFields:{MinimumCellWidthEm:22,MaximumCellWidth:"17em",CellContainerSpacerWidthPx:70},FormHeader:{Height:"9.28rem"},FormFooter:{},Icon:{MinWidth:"16px",MinHeight:"16px",MaxWidth:"32px",MaxHeight:"32px"},Breakpoints:{DimensionXS:340,DimensionS:480,DimensionM:768,DimensionL:1024,DimensionXL:1200},TabNavigator:{SemanticZoomTabListItemWidthInEm:3,OverflowtItemWidthInEm:3},GlobalCommandBarMargin:T,Measures:{Measure015:b.MEASURE015,Measure025:b.MEASURE025,Measure050:b.MEASURE050,Measure075:b.MEASURE075,Measure085:b.MEASURE085,Measure100:b.MEASURE100,Measure115:b.MEASURE115,Measure125:b.MEASURE125,Measure150:b.MEASURE150,Measure175:b.MEASURE175,Measure200:b.MEASURE200,Measure225:b.MEASURE225,Measure250:b.MEASURE250,Measure275:b.MEASURE275,Measure285:b.MEASURE285,Measure300:b.MEASURE300,Measure325:b.MEASURE325,Measure350:b.MEASURE350,Measure400:b.MEASURE400,Measure450:b.MEASURE450,Measure500:b.MEASURE500,Measure550:b.MEASURE550,Measure600:b.MEASURE600,Measure675:b.MEASURE675,Measure700:b.MEASURE700,Measure750:b.MEASURE750,Measure775:b.MEASURE775,Measure900:b.MEASURE900,Measure1075:b.MEASURE1075,Measure1143:b.MEASURE1143,Measure2875:b.MEASURE2875},FontWeights:{Light:_,Semilight:y,Normal:v,Semibold:S,Bold:O},DockablePanel:{PanelWidthS:"3.00rem",PanelWidthM:"16.875rem",PanelWidthL:"20.00rem",PanelWidthXL:"33.75rem"},Flyout:{MaxHeight:"23.75rem"}},fontFamilies:{Normal:"'SegoeUI', 'Segoe UI'",Semilight:"'SegoeUI-Light', 'Segoe UI Semilight', 'Segoe UI Regular', 'Segoe UI'",Semibold:"'SegoeUI-Semibold', 'Segoe UI Semibold', 'Segoe UI Regular', 'Segoe UI'",Weighted:"'Segoe UI'",Regular:i,Bold:"'SegoeUI-Bold', 'Segoe UI Bold', 'Segoe UI'"},display:{SolidBorderStyle:"solid",NoneBorderStyle:"none",PointerCursorStyle:"pointer",DottedBorderStyle:"dotted"},spacings:{HorizXs:"0.5em",HorizS:"0.5em",HorizB:"1em",HorizM:"2em",HorizL:"2.5em",HorizXl:"3.5em",HorizXxl:"4.5em",VertXs:"0.5em",VertS:"0.5em",VertB:"1em",VertM:"2em",VertL:"2.5em",VertXl:"3.5em",VertXxl:"4.5em"},shadows:{Shadow01:"0px 2px 4px 0px rgba(0, 0, 0, 0.5);",Shadow01Height:"4px",Shadow02:"0px 4px 8px rgba(0,0,0,0.1);"},borders:{Border01:"1px solid "+a.d.Grey.Grey1,Border02:"1px solid "+a.d.Grey.Grey3,Border03:o,Border04:P,Border05:"1px dashed "+Object(a.e)(h),Border06:"2px solid #0066FF",Border06Radius:"22px"},buttons:{Button01Primary:{borderColor:"transparent",backgroundColor:Object(a.f)(s).Fill,color:Object(a.f)(s).Text,height:b.MEASURE250,minWidth:b.MEASURE600,cursor:"pointer",justifyContent:"center",alignItems:"center",paddingLeft:b.MEASURE100,paddingRight:b.MEASURE100,"> span":{color:Object(a.f)(s).Text},":focus":{outline:o},":hover":{backgroundColor:Object(a.h)(s).Fill,color:Object(a.h)(s).Text,"-webkit-transition":"background 200ms linear",transition:"background 200ms linear"},":active":{color:Object(a.h)(s).Text,backgroundColor:Object(a.h)(s).Fill,outline:"1px solid "+Object(a.h)(s).Fill,border:"1px solid white",":disabled":{outline:0,border:"1px solid transparent"}},":disabled":{backgroundColor:a.d.Grey.Grey1,cursor:"not-allowed","> span":{color:a.d.Grey.Grey5}}},Button01Secondary:{border:"1px solid "+Object(a.f)(s).Fill,backgroundColor:a.d.White,height:b.MEASURE250,minWidth:b.MEASURE600,cursor:"pointer",justifyContent:"center",alignItems:"center",paddingLeft:b.MEASURE100,paddingRight:b.MEASURE100,"> span":{color:Object(a.f)(s).Fill},":focus":{outline:o},":hover":{backgroundColor:Object(a.h)(s).Fill,borderColor:"transparent","> span":{color:Object(a.h)(s).Text},":disabled":{"> span":{color:a.d.Grey.Grey1}},"-webkit-transition":"background 200ms linear",transition:"background 200ms linear"},":active":{backgroundColor:Object(a.h)(s).Fill,outline:"1px solid "+Object(a.h)(s).Fill,border:"1px solid white",borderColor:"transparent","> span":{color:Object(a.h)(s).Text},":disabled":{outline:0,border:"1px solid transparent"}},":disabled":{backgroundColor:a.d.Grey.Grey1,cursor:"not-allowed",borderColor:"transparent","> span":{color:a.d.Grey.Grey5}}},ButtonPrimaryText:{fontSize:b.MEASURE100,fontFamily:i,color:a.d.White,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},ButtonSecondaryText:{fontSize:b.MEASURE100,fontFamily:i,color:Object(a.f)(s).Fill,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},ActionIconButton01:{height:b.MEASURE250,width:b.MEASURE250,borderStyle:"none",backgroundColor:"transparent",justifyContent:"center",alignItems:"center",cursor:"pointer","> span":{fontSize:b.MEASURE100,color:a.d.Grey.Grey7},":focus":{outline:o},":hover":{backgroundColor:a.d.Grey.Grey1},":disabled":{cursor:"not-allowed","> span":{color:a.d.Grey.Grey4}}},Button02Primary:{borderWidth:0,borderColor:"transparent",backgroundColor:Object(a.f)(s).Fill,color:Object(a.f)(s).Text,height:b.MEASURE150,minWidth:b.MEASURE400,cursor:"pointer",justifyContent:"center",alignItems:"center",paddingLeft:b.MEASURE050,paddingRight:b.MEASURE050,paddingTop:0,paddingBottom:0,":focus":{outline:o},":hover":{backgroundColor:Object(a.h)(s).Fill,color:Object(a.h)(s).Text,"-webkit-transition":"background 200ms linear",transition:"background 200ms linear"},":active":{color:Object(a.h)(s).Text,backgroundColor:Object(a.h)(s).Fill,outline:"1px solid "+Object(a.h)(s).Fill,border:"1px solid white",":disabled":{outline:0,border:"1px solid transparent"}},":disabled":{backgroundColor:a.d.Grey.Grey1,cursor:"not-allowed","> span":{color:a.d.Grey.Grey5}}},Button02Secondary:{border:"1px solid "+Object(a.f)(s).Fill,backgroundColor:a.d.White,height:b.MEASURE150,minWidth:b.MEASURE400,cursor:"pointer",justifyContent:"center",alignItems:"center",paddingLeft:b.MEASURE050,paddingRight:b.MEASURE050,paddingTop:0,paddingBottom:0,"> span":{color:Object(a.f)(s).Fill},":focus":{outline:o},":hover":{backgroundColor:Object(a.h)(s).Fill,borderColor:"transparent","> span":{color:Object(a.h)(s).Text},":disabled":{"> span":{color:a.d.Grey.Grey1}},"-webkit-transition":"background 200ms linear",transition:"background 200ms linear"},":active":{backgroundColor:Object(a.h)(s).Fill,outline:"1px solid "+Object(a.h)(s).Fill,border:"1px solid white",borderColor:"transparent","> span":{color:Object(a.h)(s).Text},":disabled":{outline:0,border:"1px solid transparent"}},":disabled":{backgroundColor:a.d.Grey.Grey1,cursor:"not-allowed",borderColor:"transparent","> span":{color:a.d.Grey.Grey5}}},Button03Primary:{borderWidth:0,borderColor:"transparent",height:b.MEASURE200,minWidth:"9.93em",justifyContent:"center",alignItems:"center",paddingTop:0,paddingBottom:0,borderRadius:"3px","> span":{color:"#F2F2F2",fontSize:b.MEASURE100,lineHeight:"1.21rem",fontFamily:i,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}},links:{TouchTarget:{height:b.MEASURE200,fontSize:b.MEASURE100,fontFamily:i,color:a.d.Blue.Blue3},Reset:{height:b.MEASURE200,fontSize:b.MEASURE100,fontFamily:i,color:a.d.Blue.Blue3},Focus:{height:b.MEASURE200,fontSize:b.MEASURE100,fontFamily:i,color:a.d.Blue.Blue3,border:o},Hover:{height:b.MEASURE200,fontSize:b.MEASURE100,fontFamily:i,color:a.d.Blue.Blue3,cursor:"pointer",textDecoration:"underline"},Pressed:{height:b.MEASURE200,fontSize:b.MEASURE100,fontFamily:i,color:a.d.Blue.Blue5,cursor:"pointer",textDecoration:"underline"},Visited:{height:b.MEASURE200,fontSize:b.MEASURE100,fontFamily:i,color:a.d.Blue.Blue5}}}}let M=x();function F(e=M,t){switch(t.type){case r.a:return function e(t,n=null){if(null===t||"object"!=typeof t)return t;if(t.constructor!==Object&&t.constructor!==Array)return t;if(t.constructor===Date||t.constructor===RegExp||t.constructor===Function||t.constructor===String||t.constructor===Number||t.constructor===Boolean)return new t.constructor(t);n=n||new t.constructor;for(const r in t)n[r]=void 0===n[r]?e(t[r],null):n[r];return n}(e,t.payload);default:return e}}},zW2f:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("rWW8"),a=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i extends r.a{constructor(){super(r.a.unknown,r.a.unknown)}RequestId(){return this.requestId}toString(){return"["+r.a.unknown+"]"}static get_instance(){return Object(a.a)(i._instance)&&(i._instance=new i),i._instance}}i._instance=null},zefI:function(e,t){
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */},zh0k:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){return e[t]}function a(e,t,n){return function(e,t,n){if(!t||0===t.length||"i"===t)return n&&n.name.length>0?e.toLocaleString():e.toString();const a=["n %","n%","%n"],s=["-n %","-n%","-%n"],c=["(n)","-n","- n","n-","n -"],l=["$n","n$","$ n","n $"],u=["($n)","-$n","$-n","$n-","(n$)","-n$","n-$","n$-","-n $","-$ n","n $-","$ n-","$ -n","n- $","($ n)","(n $)"],d=n.numberFormat;let p=Math.abs(e).toString();t||(t="D");let g,h=-1;switch(t.length>1&&(h=parseInt(t.slice(1),10)),t.charAt(0)){case"d":case"D":g="n",p=Math.abs(Math.floor(e)).toString(),-1!==h&&(p=i(""+p,h,!0)),e<0&&(p=(-p).toString());break;case"f":case"F":g=e<0?c[r(d,"NumberNegativePattern")]:"n",-1===h&&(h=r(d,"NumberDecimalDigits")),p=o(+Math.abs(e).toFixed(h),h,r(d,"NumberGroupSizes"),r(d,"NumberGroupSeparator"),r(d,"NumberDecimalSeparator"));break;case"c":case"C":g=e<0?u[r(d,"CurrencyNegativePattern")]:l[r(d,"CurrencyPositivePattern")],-1===h&&(h=r(d,"CurrencyDecimalDigits")),p=o(Math.abs(e),h,r(d,"CurrencyGroupSizes"),r(d,"CurrencyGroupSeparator"),r(d,"CurrencyDecimalSeparator"));break;case"n":case"N":g=e<0?c[r(d,"NumberNegativePattern")]:"n",-1===h&&(h=r(d,"NumberDecimalDigits")),p=o(Math.abs(e),h,r(d,"NumberGroupSizes"),r(d,"NumberGroupSeparator"),r(d,"NumberDecimalSeparator"));break;case"p":case"P":g=e<0?s[r(d,"PercentNegativePattern")]:a[r(d,"PercentPositivePattern")],-1===h&&(h=r(d,"PercentDecimalDigits")),p=o(100*Math.abs(e),h,r(d,"PercentGroupSizes"),r(d,"PercentGroupSeparator"),r(d,"PercentDecimalSeparator"));break;default:throw Error("Sys.Res.formatBadFormatSpecifier")}const f=/n|\$|-|%/g;let m="";for(;;){const e=f.lastIndex,t=f.exec(g);if(m+=g.slice(e,t?t.index:g.length),!t)break;switch(t[0]){case"n":m+=p;break;case"$":m+=r(d,"CurrencySymbol");break;case"-":/[1-9]/.test(p)&&(m+=r(d,"NegativeSign"));break;case"%":m+=r(d,"PercentSymbol");break;default:throw Error("Invalid number format pattern")}}return m}(e,t,n)}function i(e,t,n){for(let r=e.length;r<t;r++)e=n?"0"+e:e+"0";return e}function o(e,t,n,r,a){let o=n[0],s=1;const c=Math.pow(10,t);let l=Math.round(e*c)/c;isFinite(l)||(l=e);let u,d=(e=l).toString(),p="",g=d.split(/e/i);d=g[0],u=g.length>1?parseInt(g[1],10):0,g=d.split("."),d=g[0],p=g.length>1?g[1]:"",u>0?(p=i(p,u,!1),d+=p.slice(0,u),p=p.substr(u)):u<0&&(u=-u,d=i(d,u+1,!0),p=d.slice(-u,d.length)+p,d=d.slice(0,-u)),t>0?(p=p.length>t?p.slice(0,t):i(p,t,!1),p=a+p):p="";let h=d.length-1,f="";for(;h>=0;){if(0===o||o>h)return f.length>0?d.slice(0,h+1)+r+f+p:d.slice(0,h+1)+p;f=f.length>0?d.slice(h-o+1,h+1)+r+f:d.slice(h-o+1,h+1),h-=o,s<n.length&&(o=n[s],s++)}return d.slice(0,h+1)+r+f+p}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i}))},zjrO:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("8o18"),a=n("504W");class i{constructor(e,t){this._sortByField=null,this._sortDescending=!1,this._sortByField=e,this._sortDescending=!Object(a.a)(t)&&t}get_sortByField(){return this._sortByField}get_sortDescending(){return this._sortDescending}set_sortDescending(e){return this._sortDescending=e,e}toString(){return this._sortByField+"="+this._sortDescending}getObjectData(){const e={};return e.sortbyfield=this._sortByField,e.sortdescending=this._sortDescending,e}static createFromObjectData(e){const t=e.sortbyfield,n=e.sortdescending;return new i(t,n)}}class o{constructor(e){if(this._sorters=null,this._sorters=[],!Object(a.a)(e))for(let t=0;t<e.length;t++)this.addSorterItem(i.createFromObjectData(e[t]))}get_Sorters(){return this._sorters}updateSorter(e,t){const n=new i(e,t);for(const e of this._sorters)if(e.get_sortByField()===n.get_sortByField())return e.get_sortDescending()!==n.get_sortDescending()&&e.set_sortDescending(n.get_sortDescending()),!0;return!1}addSorter(e,t){Object(a.b)(e)||this.addSorterItem(new i(e,t))}addSorterItem(e){this.updateSorter(e.get_sortByField(),e.get_sortDescending())||this._sorters.push(e)}getObjectData(){const e={};return e.sorters=this._sorters,e}static createFromFetchXml(e){var t,n,r;const i=new o,s=e.getElementsByTagName("order");for(let e=0;e<s.length;e++){const o=s[e].attributes.getNamedItem("attribute");if(!Object(a.a)(o)){let c=o.nodeValue;if("link-entity"===(null===(n=null===(t=s[e])||void 0===t?void 0:t.parentElement)||void 0===n?void 0:n.nodeName)){const t=null===(r=s[e].parentElement.attributes.getNamedItem("alias"))||void 0===r?void 0:r.nodeValue;c=t?t+"."+c:void 0}const l=s[e].attributes.getNamedItem("descending"),u=!Object(a.a)(l)&&"true"===l.nodeValue;i.addSorter(c,u)}}return i.get_Sorters().length?i:null}}var s=n("8tWD"),c=n("b2mI"),l=n("jPIj"),u=n("eruq"),d=n("qCX6"),p=n("TFb5"),g=n("s/8p");class h extends r.a{constructor(e,t){super(e,t),this._sortingInfo=null,this._metadataCache=null,this._relationshipCondition="",this._contextFilter="",this._filter=""}get_SortingInfo(){return Object(a.a)(this._sortingInfo)&&(this._sortingInfo=new o),this._sortingInfo}get_key(){return Object(a.b)(this.get_OverrideKey())?super.get_key()+","+this._relationshipCondition+","+this._contextId+","+this._contextFilter+","+this._filter:this.get_OverrideKey()}setContextFilterAndExtraConditions(e,t,n,r,i,o){const c=this.rawFetchXmlDoc.getElementsByTagName("entity")[0],g=c.attributes.getNamedItem("name").nodeValue;let h=this.get_DescriptorSet().tryGetDescriptor(s.a.Sql);if(this._metadataCache=o,!Object(a.b)(e)&&!Object(a.b)(t)){const n=Object(u.b)(t),r=n.getElementsByTagName("condition")[0];Object(a.a)(r)||(r.attributes.setNamedItem(l.a.createAttribute(n,"value",e)),!Object(a.b)(h)&&d.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(n.getElementsByTagName("link-entity")[0].attributes.getNamedItem("name").nodeValue)&&(h=this.updateSqlWithJoinClauseFromContextFilter(g,h,n,r,e))),Object(a.a)(c)||c.appendChild(n.firstChild),this._contextFilter=t,this._contextId=e}if(!Object(a.b)(n)){const e=Object(u.b)(n);Object(a.a)(c)||(h=this.getSqlForQueryFilters(e,h,o,g),c.appendChild(e.firstChild)),this._filter=n}if(!Object(a.b)(r)){const e=Object(u.b)(r);Object(a.a)(c)||(Object(a.b)(h)||(h=this.updateSqlWithWhereClauseFromRelationshipCondition(g,h,e)),c.appendChild(e.firstChild)),this._relationshipCondition=r}Object(a.b)(i)||Object(p.e)(this.rawFetchXmlDoc,i),Object(a.b)(h)||this.get_DescriptorSet().updateDescriptorSet(s.a.Sql,h)}setExtraAttributes(e){Object(p.b)(this.rawFetchXmlDoc,e)}setSortingInfo(e,t){const n=this.rawFetchXmlDoc,r=n.getElementsByTagName("order"),i=[];let s=null;if(!Object(a.a)(e)&&e.get_Sorters().length>0){for(;r.length;){const e=r[0];e.parentNode.removeChild(e)}for(const t of e.get_Sorters())Object(a.a)(e)||Object(a.b)(t.get_sortByField())||(t.get_sortByField().indexOf(".")>-1?this._SortLinkEntityAttribute(n,t)&&i.push(t):n.getElementsByTagName("entity")[0].appendChild(Object(p.j)(n,t.get_sortByField(),t.get_sortDescending())));this._sortingInfo=e}else{const e=o.createFromFetchXml(n);this._sortingInfo=e}if(s=this.get_RawSql(),!Object(a.b)(s)){const e=s.toUpperCase().lastIndexOf("ORDER BY"),n=s.lastIndexOf(g.e);let r=s;-1!==n&&s.length>n+g.e.length?r=s.substr(0,n+g.e.length):-1!==e&&(r=s.substr(0,e));let a="";for(const e of this._sortingInfo.get_Sorters()){a.length>0&&(a+=', "');let n=this.get_EntityLogicalName()+"0",r=this._GetSortByPhysicalAttributeForOffline(t,this.get_EntityLogicalName(),e.get_sortByField());if(i.indexOf(e)>=0){const t=e.get_sortByField().split(".");n=t[0],r=t[1]}a+=n+'".'+r+(e.get_sortDescending()?" DESC":" ASC")}s=`${r} ORDER BY "${a}`,-1!==n&&(s+=" "+g.d)}Object(a.b)(s)||this.set_RawSql(s)}_SortLinkEntityAttribute(e,t){const n=t.get_sortByField().split(".");if(2===n.length){const r=n[0],a=n[1],i=Object(p.k)(e,r,a);if(i)return i.appendChild(Object(p.j)(e,a,t.get_sortDescending())),!0}return!1}addChildCountAttribute(e){Object(p.a)(this.rawFetchXmlDoc,e)}generateNorSyncAttributeName(e,t,n){return Object(c.a)(this._metadataCache,e,t,n)}_GetSortByPhysicalAttributeForOffline(e,t,n){let r=n;if(!Object(a.a)(e)){const i=e.getAttributeMetadata(t,n);Object(a.a)(i)||"lookup"!==i.get_type()&&"customer"!==i.get_type()&&"owner"!==i.get_type()||(r="["+n+"!name]")}return r}getSqlForQueryFilters(e,t,n,r){if(!Object(a.a)(e)&&!Object(a.b)(t)){const a=n.getEntityMetadata(r).get_primaryNameAttribute(),i=n.getEntityMetadata(r).get_primaryIdAttribute();t=this.updateSqlWithWhereClauseFromQueryFilter(r,t,e,a,i)}return t}}},zmL5:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s}));var r=n("SAYH"),a=n("jq7Z");function i(e,t){const n=Object(a.a)(e,t);return n?n.formId:r.a.EMPTY}function o(e,t){let n=[t];const r=s(e,t);return r&&(n=n.concat(r)),n}function s(e,t){var n,r;return(null===(r=null===(n=Object(a.a)(e,t))||void 0===n?void 0:n.formInstances)||void 0===r?void 0:r.list)||[]}},zmaG:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.PerformanceTracker=t.WORK_START_EVENT_NAME=t.KPI_ZONE=t.PERFORMANCE_OBSERVER_ZONE=void 0;var s=o(n("DRVD")),c=n("J6kk"),l=n("G0by"),u=n("rdtZ"),d=o(n("gPGs")),p=o(n("VFxh")),g=o(n("vJ3+")),h=n("l48Q"),f=n("W/Jk"),m=n("STW0"),b=o(n("iDqy"));t.WORK_START_EVENT_NAME="WorkStart";t.KPI_ZONE="Core.KPI";t.PERFORMANCE_OBSERVER_ZONE="PerformanceObserver";var _=s.default.createEvent("WorkStart","Core.Performance"),y=s.default.createEvent("WorkEnd","Core.Performance"),v=["element","first-input","largest-contentful-paint","layout-shift","longtask","navigation","paint"],S={};v.forEach((function(e){S[e]=s.default.createEvent(e,t.PERFORMANCE_OBSERVER_ZONE)}));var O=function(){function e(e,t){var n=this;void 0===t&&(t=!1),this._visibilityTracker=new d.default,this._userInteractionTracker=new p.default,this._alertTracker=new g.default,this._workBlockIssues=[],this._issueListeners=[],this._metadata={},this._commonMetadata={},this._commonKpiParameters=null,this._workBlockKpiParameters=null,this._aggregationTransport=null,this._zoneActivityTracker=null,this._timelineProcessors=[],this._idleProcessingCallbacks=[],this._timelineDataCallbacks=[],this._perfDataCallbacks=[],this._queuedKPIs=[],this._workBlockKPICount=0,this._tags=[],this._bootInitializers=[],this._rethrowErrors=t,l.patchNetworkRequests(),e.setPerformanceIssueHook(this.logPerformanceIssue.bind(this)),e.subscribeToAppWorking(this._handleAppWorkingEvent.bind(this)),e.subscribeToAppIdle(this._handleAppIdleEvent.bind(this)),this._performanceObserver=window.PerformanceObserver&&new PerformanceObserver((function(e){n._handlePerformanceObserverEvents(e.getEntries())}))}return e.prototype.initializeOnBoot=function(e){this._bootInitializers.push(e)},e.prototype.initializeZoneActivityTracking=function(e){this._zoneActivityTracker||(this._zoneActivityTracker=new h.ZoneActivitySummaryTransport,s.default.registerTransport(this._zoneActivityTracker,e))},e.prototype.tagWorkBlock=function(e){-1===this._tags.indexOf(e)&&(this._tags=a([e],this._tags))},e.prototype.addKeyPerformanceIndicator=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this._queuedKPIs.push({name:e,parameters:t,retroactiveTimestamp:null!=n?n:performance.now()})},e.prototype.addKeyPerformanceIndicatorOnIdle=function(e,t){var n=this;void 0===t&&(t=null);var r=performance.now();this.onNextIdleProcessing((function(a){t||(t={}),t.TimeSinceIdle=(r-a.workBlockStartTime).toFixed().toString(),n.addKeyPerformanceIndicator(e,t,a.workBlockEndTime),n._queuedKPIs[n._queuedKPIs.length-1].workBlockKpi=!0,n._workBlockKPICount++}))},e.prototype.enableOptionalComponents=function(){null===this._aggregationTransport&&(this._aggregationTransport=new c.AggregationTransport,s.default.registerTransport(this._aggregationTransport))},e.prototype.addCommonKpiParameters=function(e,t){!0===t?this._workBlockKpiParameters=Object.assign({},this._workBlockKpiParameters,e):this._commonKpiParameters=Object.assign({},this._commonKpiParameters,e)},e.prototype.setCommonTimelineMetadata=function(e){this._commonMetadata=e},e.prototype.addMetadataToTimeline=function(e){this._metadata=Object.assign({},this._metadata,e)},e.prototype.logPerformanceIssue=function(e){e.timestamp=performance.now(),this._workBlockIssues.push(e),m.writeToConsole(e);for(var t=0;t<this._issueListeners.length;t++)this._safelyCallCallback(this._issueListeners[t],e)},e.prototype.subscribeToPerformanceIssues=function(e){this._issueListeners.push(e)},e.prototype._handleAppWorkingEvent=function(e){e.isBoot||(this._visibilityTracker.resetTracking(),this._userInteractionTracker.resetTracking(),this._alertTracker.resetTracking(),this._workBlockIssues=[],this._tags=[],u.clearBrowserResourceTimings(),null!==this._zoneActivityTracker&&this._zoneActivityTracker.reset(),null!==this._aggregationTransport&&this._aggregationTransport.reset()),this._attachPerformanceObserver()},e.prototype._handleAppIdleEvent=function(e){var t,n,r=this;if(_.createMarker(null,e.appWorkingTime),y.createMarker(null,e.appIdleTime),e.isBoot){var a=this._bootInitializers;this._bootInitializers=[],a.forEach((function(e){return r._safelyCallCallback(e)}))}var o=this._visibilityTracker.firstGoneIntoBackgroundTimeSinceLastIdle(),c=this._userInteractionTracker.userInteractions(),l=this._alertTracker.hasAlertedSinceLastIdle(),d={isBoot:e.isBoot,workBlockStartTime:e.appWorkingTime,workBlockEndTime:e.appIdleTime,hasGoneIntoBackground:o>0,hasUserInteracted:Object.keys(c).length>0,hasAlerted:l,issues:this._workBlockIssues};this._workBlockIssues=[],u.processBrowserResourceTimings(),this._processPerformanceObserverEvents();var p=this._idleProcessingCallbacks.slice();this._idleProcessingCallbacks=[],p.forEach((function(e){return r._safelyCallCallback(e,d)}));var g=Object.assign({IsBoot:e.isBoot},this._commonKpiParameters);this._commonKpiParameters=null,null!==this._zoneActivityTracker&&(this._workBlockKpiParameters.ZoneActivity=JSON.stringify(this._zoneActivityTracker.getSummary()));try{for(var h=i(this._queuedKPIs),m=h.next();!m.done;m=h.next()){var b=m.value,v=s.default.createEvent(b.name,"Core.KPI"),S=this._determineLoadQuality(b,o,l,d.issues),O=this._summarizeInteractions(b,c,d.workBlockStartTime),C=Object.assign({LoadQuality:S},b.parameters,g,O);!0===b.workBlockKpi&&Object.assign(C,this._workBlockKpiParameters,{WorkBlockKpi:!0}),this._workBlockKPICount>1&&Object.assign(C,{MultipleWorkBlockKpi:!0}),v.createMarker(C,b.retroactiveTimestamp)}}catch(e){t={error:e}}finally{try{m&&!m.done&&(n=h.return)&&n.call(h)}finally{if(t)throw t.error}}this._workBlockKpiParameters=null,this._queuedKPIs=[],this._workBlockKPICount=0;var E=null;if(null!==this._aggregationTransport){(E=new f.PerformanceTimeline(this._aggregationTransport.getEvents(),Object.assign({},this._commonMetadata,this._metadata,g,{timestamp:(new Date).toString(),windowWidth:window.innerWidth,windowHeight:window.innerHeight}))).setTags(this._tags),this._aggregationTransport.reset(),this._timelineProcessors.forEach((function(e){return r._safelyCallCallback(e,E)}));var I=Object.assign({},d,{timeline:E}),w=this._timelineDataCallbacks.slice();this._timelineDataCallbacks=[],w.forEach((function(e){return r._safelyCallCallback(e,I)}))}var j=Object.assign({},d,{tags:this._tags,timeline:E,issuesFromTimelineProcessing:this._workBlockIssues}),P=this._perfDataCallbacks.slice();this._perfDataCallbacks=[],P.forEach((function(e){return r._safelyCallCallback(e,j)}))},e.prototype.onNextIdleProcessing=function(e){this._idleProcessingCallbacks.push(e)},e.prototype.addTimelineProcessor=function(e){this._timelineProcessors.push(e)},e.prototype.onNextTimelineData=function(e){this._timelineDataCallbacks.push(e)},e.prototype.onNextPerfData=function(e){this._perfDataCallbacks.push(e)},e.prototype.processNextWorkBlock=function(e,t,n){var r=this;return new Promise((function(a){r.onNextIdleProcessing(e),r.onNextTimelineData(t),r.onNextPerfData(n),r.onNextPerfData((function(){return a()}))}))},e.prototype._determineLoadQuality=function(e,t,n,r){var a=0;return t>=0&&t<e.retroactiveTimestamp&&(a|=1),n&&(a|=2),r&&r.forEach((function(t){if(t.timestamp&&t.timestamp<e.retroactiveTimestamp){var n=4<<t.type;a|=n}})),a},e.prototype._summarizeInteractions=function(e,t,n){var r=n+300,a={},i="",o=Number.MAX_VALUE,s=function(n){t[n].forEach((function(t){r<t&&t<e.retroactiveTimestamp&&(t<o&&(i=n,o=t),a[n]=a[n]?a[n]+1:1)}))};for(var c in t)s(c);return i?{FirstInteractionName:i,FirstInteractionTime:o-n,Interactions:a}:{}},e.prototype._safelyCallCallback=function(e,t){void 0===t&&(t=void 0);try{e.call(null,t)}catch(e){this._rethrowErrors&&setTimeout((function(){throw e}),0)}},e.prototype._handlePerformanceObserverEvents=function(e){e.forEach((function(e){var t;null===(t=S[e.entryType])||void 0===t||t.createRetroactiveStopwatch(e.startTime,e.duration,{name:e.name})}))},e.prototype._attachPerformanceObserver=function(){this._performanceObserver&&this._performanceObserver.observe({entryTypes:v})},e.prototype._processPerformanceObserverEvents=function(){this._performanceObserver&&(this._performanceObserver.takeRecords&&this._handlePerformanceObserverEvents(this._performanceObserver.takeRecords()),this._performanceObserver.disconnect())},e}();t.PerformanceTracker=O;var C=new O(b.default);t.default=C},znb3:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),function(e){e[e.Expanded=0]="Expanded",e[e.UpArrowHead=1]="UpArrowHead",e[e.LeftArrowHead=2]="LeftArrowHead",e[e.Collapsed=3]="Collapsed",e[e.Edit=4]="Edit",e[e.Save=5]="Save",e[e.Delete=6]="Delete",e[e.Remove=7]="Remove",e[e.Add=8]="Add",e[e.Cancel=9]="Cancel",e[e.HandClick=10]="HandClick",e[e.Accept=11]="Accept",e[e.More=12]="More",e[e.Forward=13]="Forward",e[e.Favorite=14]="Favorite",e[e.Placeholder=15]="Placeholder",e[e.RatingFull=16]="RatingFull",e[e.RatingEmpty=17]="RatingEmpty",e[e.Options=18]="Options",e[e.Manage=19]="Manage",e[e.Settings=20]="Settings",e[e.Find=21]="Find",e[e.Help=22]="Help",e[e.ViewNotifications=23]="ViewNotifications",e[e.StageAdvance=24]="StageAdvance",e[e.CheckMark=25]="CheckMark",e[e.Locked=26]="Locked",e[e.Lock=27]="Lock",e[e.MoreOptions=28]="MoreOptions",e[e.ContactInfo=29]="ContactInfo",e[e.Pin=30]="Pin",e[e.Unpin=31]="Unpin",e[e.Refresh=32]="Refresh",e[e.Details=33]="Details",e[e.VisualFilter=34]="VisualFilter",e[e.GlobalFilter=35]="GlobalFilter",e[e.Diamond=36]="Diamond",e[e.ApplyFilter=37]="ApplyFilter",e[e.CancelFilter=38]="CancelFilter",e[e.StreamView=39]="StreamView",e[e.TileView=40]="TileView",e[e.Import=41]="Import",e[e.Tools=42]="Tools",e[e.Attach=43]="Attach",e[e.Filter=44]="Filter",e[e.Copy=45]="Copy",e[e.HighPriority=46]="HighPriority",e[e.ReduceTile=47]="ReduceTile",e[e.ExpandTile=48]="ExpandTile",e[e.GlobalFilterExpand=49]="GlobalFilterExpand",e[e.GlobalFilterCollapse=50]="GlobalFilterCollapse",e[e.Clear=51]="Clear",e[e.Post=52]="Post",e[e.OneNote=53]="OneNote",e[e.Home=54]="Home",e[e.SetAsHome=55]="SetAsHome",e[e.BackButton=56]="BackButton",e[e.BackButtonWithoutBorder=57]="BackButtonWithoutBorder",e[e.UpArrow=58]="UpArrow",e[e.DownArrow=59]="DownArrow",e[e.SetActiveButton=60]="SetActiveButton",e[e.SearchButton=61]="SearchButton",e[e.ForwardButton=62]="ForwardButton",e[e.Mail=63]="Mail",e[e.CheckedMail=64]="CheckedMail",e[e.FailedMail=65]="FailedMail",e[e.Phone=66]="Phone",e[e.Chat=67]="Chat",e[e.OpenPane=68]="OpenPane",e[e.ClosePane=69]="ClosePane",e[e.AddFriend=70]="AddFriend",e[e.Arrow=71]="Arrow",e[e.DropdownArrow=72]="DropdownArrow",e[e.FlsLocked=73]="FlsLocked",e[e.LinkArticle=74]="LinkArticle",e[e.UnlinkArticle=75]="UnlinkArticle",e[e.CopyLink=76]="CopyLink",e[e.EmailLink=77]="EmailLink",e[e.Share=78]="Share",e[e.Assign=79]="Assign",e[e.Connect=80]="Connect",e[e.Opportunity=81]="Opportunity",e[e.Appointment=82]="Appointment",e[e.Task=83]="Task",e[e.Case=84]="Case",e[e.PhoneCallIncoming=85]="PhoneCallIncoming",e[e.PhoneCallOutgoing=86]="PhoneCallOutgoing",e[e.EmailIncoming=87]="EmailIncoming",e[e.EmailOutgoing=88]="EmailOutgoing",e[e.SendEmail=89]="SendEmail",e[e.ApplyTemplate=90]="ApplyTemplate",e[e.InsertKbArticle=91]="InsertKbArticle",e[e.SendSelected=92]="SendSelected",e[e.SaveAndClose=93]="SaveAndClose",e[e.ReplyEmail=94]="ReplyEmail",e[e.ReplyAllEmail=95]="ReplyAllEmail",e[e.ForwardEmail=96]="ForwardEmail",e[e.Close=97]="Close",e[e.Activate=98]="Activate",e[e.DeActivate=99]="DeActivate",e[e.DeleteBulk=100]="DeleteBulk",e[e.SocialActivityIncoming=101]="SocialActivityIncoming",e[e.SocialActivityOutgoing=102]="SocialActivityOutgoing",e[e.CustomActivity=103]="CustomActivity",e[e.SystemPost=104]="SystemPost",e[e.Convert=105]="Convert",e[e.MarkAsWon=106]="MarkAsWon",e[e.MarkAsLost=107]="MarkAsLost",e[e.SetRegarding=108]="SetRegarding",e[e.SaveAsComplete=109]="SaveAsComplete",e[e.SwitchProcess=110]="SwitchProcess",e[e.Recalculate=111]="Recalculate",e[e.SendDirectEmail=112]="SendDirectEmail",e[e.OpenMailbox=113]="OpenMailbox",e[e.ReOpenOpportunity=114]="ReOpenOpportunity",e[e.ReactivateLead=115]="ReactivateLead",e[e.Disqualify=116]="Disqualify",e[e.Qualify=117]="Qualify",e[e.SelectView=118]="SelectView",e[e.SelectChart=119]="SelectChart",e[e.OpenInBrowser=120]="OpenInBrowser",e[e.NewAppointment=121]="NewAppointment",e[e.NewRecurringAppointment=122]="NewRecurringAppointment",e[e.NewPhoneCall=123]="NewPhoneCall",e[e.NewTask=124]="NewTask",e[e.NewEmail=125]="NewEmail",e[e.AddExisting=126]="AddExisting",e[e.SaveAndEdit=127]="SaveAndEdit",e[e.Default=128]="Default",e[e.ScrollRight=129]="ScrollRight",e[e.ScrollLeft=130]="ScrollLeft",e[e.SaveAndRunRoutingRule=131]="SaveAndRunRoutingRule",e[e.RunRoutingRule=132]="RunRoutingRule",e[e.ResolveCase=133]="ResolveCase",e[e.CancelCase=134]="CancelCase",e[e.ReactivateCase=135]="ReactivateCase",e[e.AddToQueue=136]="AddToQueue",e[e.CreateChildCase=137]="CreateChildCase",e[e.QueueItemRoute=138]="QueueItemRoute",e[e.QueueItemRelease=139]="QueueItemRelease",e[e.QueueItemRemove=140]="QueueItemRemove",e[e.QueueItemPick=141]="QueueItemPick",e[e.Drilldown=142]="Drilldown",e[e.PopOverButton=143]="PopOverButton",e[e.ExitButton=144]="ExitButton",e[e.ExportToExcel=145]="ExportToExcel",e[e.WordTemplates=146]="WordTemplates",e[e.DocumentTemplates=147]="DocumentTemplates",e[e.OpenInPowerBI=148]="OpenInPowerBI",e[e.OpenPowerBIReport=149]="OpenPowerBIReport",e[e.OpenDelve=150]="OpenDelve",e[e.ArticleLink=151]="ArticleLink",e[e.ArchiveArticle=152]="ArchiveArticle",e[e.ApproveArticle=153]="ApproveArticle",e[e.DiscardArticle=154]="DiscardArticle",e[e.Minor=155]="Minor",e[e.Major=156]="Major",e[e.PublishKnowledgeArticle=157]="PublishKnowledgeArticle",e[e.RelateArticle=158]="RelateArticle",e[e.RelateProduct=159]="RelateProduct",e[e.RestoreArticle=160]="RestoreArticle",e[e.RevertToDraftArticle=161]="RevertToDraftArticle",e[e.Translate=162]="Translate",e[e.UpdateArticle=163]="UpdateArticle",e[e.RemoveFilter=164]="RemoveFilter",e[e.Article=165]="Article",e[e.Graph=166]="Graph",e[e.CSR=167]="CSR",e[e.MembersIcon=168]="MembersIcon",e[e.QueueIcon=169]="QueueIcon",e[e.SiteMap=170]="SiteMap",e[e.NormalPriority=171]="NormalPriority",e[e.LowPriority=172]="LowPriority",e[e.ViewIcon=173]="ViewIcon",e[e.RecentCases=174]="RecentCases",e[e.KBRecords=175]="KBRecords",e[e.NumberOfViews=176]="NumberOfViews",e[e.ResizeHandle=177]="ResizeHandle",e[e.TaskBasedFlow=178]="TaskBasedFlow",e[e.InformationIcon=179]="InformationIcon",e[e.PencilIcon=180]="PencilIcon",e[e.ErrorIcon=181]="ErrorIcon",e[e.SuccessIcon=182]="SuccessIcon",e[e.OptionsetIcon=183]="OptionsetIcon",e[e.NotificationIcon=184]="NotificationIcon",e[e.PanelHeaderImportDataIcon=185]="PanelHeaderImportDataIcon",e[e.SidePanelUpload=186]="SidePanelUpload",e[e.New=187]="New",e[e.DetailsPageClose=188]="DetailsPageClose",e[e.SettingsListIcon=189]="SettingsListIcon",e[e.ListIcon=190]="ListIcon",e[e.ForwardDisable=191]="ForwardDisable",e[e.PdfIconFile=192]="PdfIconFile",e[e.PresentationFile=193]="PresentationFile",e[e.OneNoteFile=194]="OneNoteFile",e[e.AccessFile=195]="AccessFile",e[e.VisioFile=196]="VisioFile",e[e.ProjectFile=197]="ProjectFile",e[e.Plus=198]="Plus",e[e.ChevronUp=199]="ChevronUp",e[e.ChevronDown=200]="ChevronDown",e[e.HappySmiley=201]="HappySmiley",e[e.SadSmiley=202]="SadSmiley",e[e.CaseResolution=203]="CaseResolution",e[e.CampaignResolution=204]="CampaignResolution",e[e.ServiceActivity=205]="ServiceActivity",e[e.Notes=206]="Notes",e[e.Audio=207]="Audio",e[e.Camera=208]="Camera",e[e.Video=209]="Video",e[e.Image=210]="Image",e[e.Html=211]="Html",e[e.SharePointEditDocument=212]="SharePointEditDocument",e[e.SharePointDeleteDocument=213]="SharePointDeleteDocument",e[e.SharePointCheckoutDocument=214]="SharePointCheckoutDocument",e[e.SharePointCheckinDocument=215]="SharePointCheckinDocument",e[e.SharePointEditDocumentProperties=216]="SharePointEditDocumentProperties",e[e.SharePointDiscardCheckoutDocument=217]="SharePointDiscardCheckoutDocument",e[e.SharePointNewDocument=218]="SharePointNewDocument",e[e.SharePointNewWordDocument=219]="SharePointNewWordDocument",e[e.SharePointNewExcelDocument=220]="SharePointNewExcelDocument",e[e.SharePointNewPowerPointDocument=221]="SharePointNewPowerPointDocument",e[e.SharePointNewOneNoteDocument=222]="SharePointNewOneNoteDocument",e[e.SharePointUploadDocument=223]="SharePointUploadDocument",e[e.SharePointChangeLocation=224]="SharePointChangeLocation",e[e.SharePointAddDocumentLocation=225]="SharePointAddDocumentLocation",e[e.SharePointEditLocation=226]="SharePointEditLocation",e[e.SharePointOpenLocation=227]="SharePointOpenLocation",e[e.SharePointOpenDocument=228]="SharePointOpenDocument",e[e.SendByEmail=229]="SendByEmail",e[e.CreateQuote=230]="CreateQuote",e[e.Reply=231]="Reply",e[e.Warning=232]="Warning",e[e.Play=233]="Play",e[e.ExpandButton=234]="ExpandButton",e[e.AssociatedArticle=235]="AssociatedArticle",e[e.DisassociatedArticle=236]="DisassociatedArticle",e[e.FormDesign=237]="FormDesign",e[e.GlobalFilterClearAll=238]="GlobalFilterClearAll",e[e.GlobalFilterExpandedRow=239]="GlobalFilterExpandedRow",e[e.GlobalFilterCollapsedRow=240]="GlobalFilterCollapsedRow",e[e.RelationshipAssistant=241]="RelationshipAssistant",e[e.AutomaticSuggestions=242]="AutomaticSuggestions",e[e.SemanticZoom=243]="SemanticZoom",e[e.SemanticZoomMirrored=244]="SemanticZoomMirrored",e[e.BackwardButton=245]="BackwardButton",e[e.MultiSelect=246]="MultiSelect",e[e.MultiSelectMirrored=247]="MultiSelectMirrored",e[e.Spinning=248]="Spinning",e[e.RetireProduct=249]="RetireProduct",e[e.AddProduct=250]="AddProduct",e[e.OfflineStatus=251]="OfflineStatus",e[e.Abandon=252]="Abandon",e[e.Reactivate=253]="Reactivate",e[e.FinishStage=254]="FinishStage",e[e.SortButton=255]="SortButton",e[e.Flows=256]="Flows",e[e.OpenEntityRecord=257]="OpenEntityRecord",e[e.View=258]="View",e[e.CreateView=259]="CreateView",e[e.EditView=260]="EditView",e[e.GuestUser=261]="GuestUser",e[e.History=262]="History",e[e.ReassignRecords=263]="ReassignRecords",e[e.ManageRoles=264]="ManageRoles",e[e.JoinTeams=265]="JoinTeams",e[e.ChangeManager=266]="ChangeManager",e[e.AddMembers=267]="AddMembers",e[e.RemoveMembers=268]="RemoveMembers",e[e.Download=269]="Download",e[e.SetAsDefaultView=270]="SetAsDefaultView",e[e.Pinned=271]="Pinned",e[e.DistributionList=272]="DistributionList",e[e.MergeRecords=273]="MergeRecords",e[e.AssociateChildCase=274]="AssociateChildCase",e[e.SetAsDefault=275]="SetAsDefault",e[e.ConvertKnowledgeArticle=276]="ConvertKnowledgeArticle",e[e.Messenger=277]="Messenger",e[e.AssociateCategory=278]="AssociateCategory",e[e.OfficeWaffle=279]="OfficeWaffle",e[e.TripleColumn=280]="TripleColumn",e[e.Tiles=281]="Tiles",e[e.HideVisualFilter=282]="HideVisualFilter",e[e.InteractiveDashboard=283]="InteractiveDashboard",e[e.Dynamics365=284]="Dynamics365",e[e.SalesLiterature=285]="SalesLiterature",e[e.SelectButton=286]="SelectButton",e[e.SelectButtonRTL=287]="SelectButtonRTL",e[e.LockPricing=288]="LockPricing",e[e.CreateInvoice=289]="CreateInvoice",e[e.FulfillOrder=290]="FulfillOrder",e[e.CancelInvoice=291]="CancelInvoice",e[e.ActivateQuote=292]="ActivateQuote",e[e.InvoicePaid=293]="InvoicePaid",e[e.GetProducts=294]="GetProducts",e[e.UnlockPricing=295]="UnlockPricing",e[e.Checkbox=296]="Checkbox",e[e.CheckboxComposite=297]="CheckboxComposite",e[e.RightChevron=298]="RightChevron",e[e.LeftChevron=299]="LeftChevron",e[e.UntrackedEmail=300]="UntrackedEmail",e[e.OpenEmail=301]="OpenEmail",e[e.GlobalFilterCollapsedRowRTL=302]="GlobalFilterCollapsedRowRTL",e[e.CancelOrder=303]="CancelOrder",e[e.URL=304]="URL",e[e.Ticker=305]="Ticker",e[e.UseCurrentPricing=306]="UseCurrentPricing",e[e.Process=307]="Process",e[e.FirstPageButton=308]="FirstPageButton",e[e.LinkedInLogo=309]="LinkedInLogo",e[e.Health=310]="Health",e[e.Family=311]="Family",e[e.Sports=312]="Sports",e[e.Entertainment=313]="Entertainment",e[e.OOF=314]="OOF",e[e.CarouselView=315]="CarouselView",e[e.HeartEmpty=316]="HeartEmpty",e[e.HeartFilled=317]="HeartFilled",e[e.Follow=318]="Follow",e[e.RunQuery=319]="RunQuery",e[e.GroupAnd=320]="GroupAnd",e[e.GroupOr=321]="GroupOr",e[e.Ungroup=322]="Ungroup",e[e.HideInSimpleMode=323]="HideInSimpleMode",e[e.ShowInSimpleMode=324]="ShowInSimpleMode",e[e.PinnedSolid=325]="PinnedSolid",e[e.FilterSolid=326]="FilterSolid",e[e.Bot=327]="Bot",e[e.SystemDocumentTemplates=328]="SystemDocumentTemplates",e[e.MyDocumentTemplates=329]="MyDocumentTemplates",e[e.ViewAllMyDocumentTemplates=330]="ViewAllMyDocumentTemplates",e[e.EnableSecurityRoles=331]="EnableSecurityRoles",e[e.DocumentTemplateUpload=332]="DocumentTemplateUpload",e[e.DocumentTemplateEdit=333]="DocumentTemplateEdit",e[e.DocumentTemplateActivate=334]="DocumentTemplateActivate",e[e.DocumentTemplateDeactivate=335]="DocumentTemplateDeactivate",e[e.YammerIcon=336]="YammerIcon",e[e.StopIcon=337]="StopIcon",e[e.ReplaceContentIcon=338]="ReplaceContentIcon",e[e.CloseDateComingSoon=339]="CloseDateComingSoon",e[e.NearbyCustomers=340]="NearbyCustomers",e[e.RelevantNews=341]="RelevantNews",e[e.UpcomingMeeting=342]="UpcomingMeeting",e[e.RecentMeeting=343]="RecentMeeting",e[e.ReminderWithCall=344]="ReminderWithCall",e[e.CardsTask=345]="CardsTask",e[e.CardsQuote=346]="CardsQuote",e[e.CardsOpportunity=347]="CardsOpportunity",e[e.CardsInvoice=348]="CardsInvoice",e[e.CardsDashboard=349]="CardsDashboard",e[e.CardsLeads=350]="CardsLeads",e[e.OpportunityNoActivity=351]="OpportunityNoActivity",e[e.CaseNoActivity=352]="CaseNoActivity",e[e.CompetitorMentioned=353]="CompetitorMentioned",e[e.MeetingRequest=354]="MeetingRequest",e[e.MissedCloseDate=355]="MissedCloseDate",e[e.IssueDetection=356]="IssueDetection",e[e.NoActivityWithAccount=357]="NoActivityWithAccount",e[e.YesNo=358]="YesNo",e[e.AgendaActivityServiceAppointment=359]="AgendaActivityServiceAppointment",e[e.AgendaActivityFax=360]="AgendaActivityFax",e[e.UpcomingFlight=361]="UpcomingFlight",e[e.OpportunityAtRiskSentiment=362]="OpportunityAtRiskSentiment",e[e.IconDue=363]="IconDue",e[e.AddProductFamily=364]="AddProductFamily",e[e.AddProductBundle=365]="AddProductBundle",e[e.ProductPublish=366]="ProductPublish",e[e.CloneProduct=367]="CloneProduct",e[e.CloseGoal=368]="CloseGoal",e[e.AlignWithFiscalPeriod=369]="AlignWithFiscalPeriod",e[e.Connection=370]="Connection",e[e.ConnectionToMe=371]="ConnectionToMe",e[e.ConnectionToOther=372]="ConnectionToOther",e[e.ProductUpsell=373]="ProductUpsell",e[e.SubscriptionAdd=374]="SubscriptionAdd",e[e.RefreshDevice=375]="RefreshDevice",e[e.BulletListRemove=376]="BulletListRemove",e[e.BulletListAdd=377]="BulletListAdd",e[e.ScatterChart=378]="ScatterChart",e[e.BarChartHorizontal=379]="BarChartHorizontal",e[e.BarChartVertical=380]="BarChartVertical",e[e.FunnelChart=381]="FunnelChart",e[e.PieDouble=382]="PieDouble",e[e.AALinkedInLogo=383]="AALinkedInLogo",e[e.SendAndClose=384]="SendAndClose",e[e.AdvFind=385]="AdvFind",e[e.DoubleChevronLeft=386]="DoubleChevronLeft",e[e.DoubleChevronRight=387]="DoubleChevronRight",e[e.AreaChart=388]="AreaChart",e[e.DonutChart=389]="DonutChart",e[e.TagChart=390]="TagChart",e[e.Teaser=391]="Teaser",e[e.Clone=392]="Clone",e[e.AreaChartMirrored=393]="AreaChartMirrored",e[e.BarChartHorizontalMirrored=394]="BarChartHorizontalMirrored",e[e.BarChartVerticalMirrored=395]="BarChartVerticalMirrored",e[e.People=396]="People",e[e.PeopleBlock=397]="PeopleBlock",e[e.BulletListDownArrow=398]="BulletListDownArrow",e[e.Recent=399]="Recent",e[e.SharePointIcon=400]="SharePointIcon",e[e.OneDriveIcon=401]="OneDriveIcon",e[e.FolderSharedIcon=402]="FolderSharedIcon",e[e.MSTeamsIcon=403]="MSTeamsIcon",e[e.ScrollUpDown=404]="ScrollUpDown",e[e.SendToCTI=405]="SendToCTI",e[e.CreateQuickCampaign=406]="CreateQuickCampaign",e[e.PageSolid=407]="PageSolid",e[e.Page=408]="Page",e[e.OpportunitiesList=409]="OpportunitiesList",e[e.BrowseCards=410]="BrowseCards",e[e.Letter=411]="Letter",e[e.Fax=412]="Fax",e[e.NewLetter=413]="NewLetter",e[e.NewFax=414]="NewFax",e[e.LetterIncoming=415]="LetterIncoming",e[e.LetterOutgoing=416]="LetterOutgoing",e[e.FaxIncoming=417]="FaxIncoming",e[e.FaxOutgoing=418]="FaxOutgoing",e[e.CreatePersonalView=419]="CreatePersonalView",e[e.ViewHierarchy=420]="ViewHierarchy",e[e.ProductPreview=421]="ProductPreview",e[e.AddTerritoryMember=422]="AddTerritoryMember",e[e.RemoveTerritoryMember=423]="RemoveTerritoryMember",e[e.Report=424]="Report",e[e.NewServiceActivity=425]="NewServiceActivity",e[e.Recurrence=426]="Recurrence",e[e.EditSeries=427]="EditSeries",e[e.EndSeries=428]="EndSeries",e[e.EditDefaultFilter=429]="EditDefaultFilter",e[e.QueueItemDetail=430]="QueueItemDetail",e[e.ThumbsUp=431]="ThumbsUp",e[e.ThumbsDown=432]="ThumbsDown",e[e.Lead=433]="Lead",e[e.TableLink=434]="TableLink",e[e.TableGroup=435]="TableGroup",e[e.ClearDefault=436]="ClearDefault",e[e.SetDefault=437]="SetDefault",e[e.SaveFilterToNewPersonalView=438]="SaveFilterToNewPersonalView",e[e.SaveFilterToCurrentPersonalView=439]="SaveFilterToCurrentPersonalView",e[e.Expand=440]="Expand",e[e.ChromeMinimize=441]="ChromeMinimize",e[e.ChromeMaximize=442]="ChromeMaximize",e[e.ConnectionRoleManageRecordType=443]="ConnectionRoleManageRecordType",e[e.Sync=444]="Sync",e[e.ThumbsUpSolid=445]="ThumbsUpSolid",e[e.ThumbsDownSolid=446]="ThumbsDownSolid",e[e.msdyn_enhancedsla=447]="msdyn_enhancedsla",e[e.msdyn_enhancedslakpi=448]="msdyn_enhancedslakpi",e[e.msdyn_enhancedslakpiinstance=449]="msdyn_enhancedslakpiinstance",e[e.CreateOrder=450]="CreateOrder",e[e.Revise=451]="Revise",e[e.CloseQuote=452]="CloseQuote",e[e.CommandChecker=453]="CommandChecker",e[e.MiniContract=454]="MiniContract",e[e.MiniExpand=455]="MiniExpand",e[e.Print=456]="Print",e[e.NoDataAvailable=457]="NoDataAvailable",e[e.MoreVertical=458]="MoreVertical",e[e.OpenInNewWindow=459]="OpenInNewWindow",e[e.EditEvent=460]="EditEvent",e[e.LinkToRecord=461]="LinkToRecord",e[e.UnlinkFromRecord=462]="UnlinkFromRecord",e[e.KnowledgeSearch=463]="KnowledgeSearch",e[e.ChevronDownMed=464]="ChevronDownMed",e[e.OpenFolderHorizontal=465]="OpenFolderHorizontal",e[e.TaskClipboard=466]="TaskClipboard",e[e.CustomList=467]="CustomList",e[e.ExpandAllRecords=468]="ExpandAllRecords",e[e.CollapseAllRecords=469]="CollapseAllRecords",e[e.SelectAll=470]="SelectAll",e[e.Embed=471]="Embed",e[e.MailTemplate=472]="MailTemplate",e[e.Monitor=473]="Monitor",e[e.Error=474]="Error",e[e.CustomEntity=475]="CustomEntity"}(r||(r={}));var a={Expanded:"symbolFont Expanded-symbol",UpArrowHead:"symbolFont UpArrowHead-symbol",LeftArrowHead:"symbolFont LeftArrowHead-symbol",Collapsed:"symbolFont Collapsed-symbol",Edit:"symbolFont Edit-symbol",Save:"symbolFont Save-symbol",Delete:"symbolFont Delete-symbol",Remove:"symbolFont Remove-symbol",Add:"symbolFont Add-symbol",Cancel:"symbolFont Cancel-symbol",HandClick:"symbolFont HandClick-symbol",Accept:"symbolFont Accept-symbol",More:"symbolFont More-symbol",Forward:"symbolFont Forward-symbol",Favorite:"symbolFont Favorite-symbol",Placeholder:"symbolFont Placeholder-symbol",RatingFull:"symbolFont RatingFull-symbol",RatingEmpty:"symbolFont RatingEmpty-symbol",Options:"symbolFont Options-symbol",Manage:"symbolFont Manage-symbol",Settings:"symbolFont Settings-symbol",Find:"symbolFont Find-symbol",Help:"symbolFont Help-symbol",ViewNotifications:"symbolFont ViewNotifications-symbol",StageAdvance:"symbolFont StageAdvance-symbol",CheckMark:"symbolFont CheckMark-symbol",Locked:"symbolFont Locked-symbol",Lock:"symbolFont Lock-symbol",MoreOptions:"symbolFont MoreOptions-symbol",ContactInfo:"symbolFont ContactInfo-symbol",Pin:"symbolFont Pin-symbol",Unpin:"symbolFont Unpin-symbol",Refresh:"symbolFont Refresh-symbol",Details:"symbolFont Details-symbol",VisualFilter:"symbolFont VisualFilter-symbol",GlobalFilter:"symbolFont GlobalFilter-symbol",Diamond:"symbolFont Diamond-symbol",ApplyFilter:"symbolFont ApplyFilter-symbol",CancelFilter:"symbolFont CancelFilter-symbol",StreamView:"symbolFont StreamView-symbol",TileView:"symbolFont TileView-symbol",Import:"symbolFont Import-symbol",Tools:"symbolFont Tools-symbol",Attach:"symbolFont Attach-symbol",Filter:"symbolFont Filter-symbol",Copy:"symbolFont Copy-symbol",HighPriority:"symbolFont HighPriority-symbol",ReduceTile:"symbolFont ReduceTile-symbol",ExpandTile:"symbolFont ExpandTile-symbol",GlobalFilterExpand:"symbolFont GlobalFilterExpand-symbol",GlobalFilterCollapse:"symbolFont GlobalFilterCollapse-symbol",Clear:"symbolFont Clear-symbol",Post:"symbolFont Post-symbol",OneNote:"symbolFont OneNote-symbol",Home:"symbolFont Home-symbol",SetAsHome:"symbolFont SetAsHome-symbol",BackButton:"symbolFont BackButton-symbol",BackButtonWithoutBorder:"symbolFont BackButtonWithoutBorder-symbol",UpArrow:"symbolFont UpArrow-symbol",DownArrow:"symbolFont DownArrow-symbol",SetActiveButton:"symbolFont SetActiveButton-symbol",SearchButton:"symbolFont SearchButton-symbol",ForwardButton:"symbolFont ForwardButton-symbol",Mail:"symbolFont Mail-symbol",CheckedMail:"symbolFont CheckedMail-symbol",FailedMail:"symbolFont FailedMail-symbol",Phone:"symbolFont Phone-symbol",Chat:"symbolFont Chat-symbol",OpenPane:"symbolFont OpenPane-symbol",ClosePane:"symbolFont ClosePane-symbol",AddFriend:"symbolFont AddFriend-symbol",Arrow:"symbolFont Arrow-symbol",DropdownArrow:"symbolFont DropdownArrow-symbol",FlsLocked:"symbolFont FlsLocked-symbol",LinkArticle:"symbolFont LinkArticle-symbol",UnlinkArticle:"symbolFont UnlinkArticle-symbol",CopyLink:"symbolFont CopyLink-symbol",EmailLink:"symbolFont EmailLink-symbol",Share:"symbolFont Share-symbol",Assign:"symbolFont Assign-symbol",Connect:"symbolFont Connect-symbol",Opportunity:"symbolFont Opportunity-symbol",Appointment:"symbolFont Appointment-symbol",Task:"symbolFont Task-symbol",Case:"symbolFont Case-symbol",PhoneCallIncoming:"symbolFont PhoneCallIncoming-symbol",PhoneCallOutgoing:"symbolFont PhoneCallOutgoing-symbol",EmailIncoming:"symbolFont EmailIncoming-symbol",EmailOutgoing:"symbolFont EmailOutgoing-symbol",SendEmail:"symbolFont SendEmail-symbol",ApplyTemplate:"symbolFont ApplyTemplate-symbol",InsertKbArticle:"symbolFont InsertKbArticle-symbol",SendSelected:"symbolFont SendSelected-symbol",SaveAndClose:"symbolFont SaveAndClose-symbol",ReplyEmail:"symbolFont ReplyEmail-symbol",ReplyAllEmail:"symbolFont ReplyAllEmail-symbol",ForwardEmail:"symbolFont ForwardEmail-symbol",Close:"symbolFont Close-symbol",Activate:"symbolFont Activate-symbol",DeActivate:"symbolFont DeActivate-symbol",DeleteBulk:"symbolFont DeleteBulk-symbol",SocialActivityIncoming:"symbolFont SocialActivityIncoming-symbol",SocialActivityOutgoing:"symbolFont SocialActivityOutgoing-symbol",CustomActivity:"symbolFont CustomActivity-symbol",SystemPost:"symbolFont SystemPost-symbol",Convert:"symbolFont Convert-symbol",MarkAsWon:"symbolFont MarkAsWon-symbol",MarkAsLost:"symbolFont MarkAsLost-symbol",SetRegarding:"symbolFont SetRegarding-symbol",SaveAsComplete:"symbolFont SaveAsComplete-symbol",SwitchProcess:"symbolFont SwitchProcess-symbol",Recalculate:"symbolFont Recalculate-symbol",SendDirectEmail:"symbolFont SendDirectEmail-symbol",OpenMailbox:"symbolFont OpenMailbox-symbol",ReOpenOpportunity:"symbolFont ReOpenOpportunity-symbol",ReactivateLead:"symbolFont ReactivateLead-symbol",Disqualify:"symbolFont Disqualify-symbol",Qualify:"symbolFont Qualify-symbol",SelectView:"symbolFont SelectView-symbol",SelectChart:"symbolFont SelectChart-symbol",OpenInBrowser:"symbolFont OpenInBrowser-symbol",NewAppointment:"symbolFont NewAppointment-symbol",NewRecurringAppointment:"symbolFont NewRecurringAppointment-symbol",NewPhoneCall:"symbolFont NewPhoneCall-symbol",NewTask:"symbolFont NewTask-symbol",NewEmail:"symbolFont NewEmail-symbol",AddExisting:"symbolFont AddExisting-symbol",SaveAndEdit:"symbolFont SaveAndEdit-symbol",Default:"symbolFont Default-symbol",ScrollRight:"symbolFont ScrollRight-symbol",ScrollLeft:"symbolFont ScrollLeft-symbol",SaveAndRunRoutingRule:"symbolFont SaveAndRunRoutingRule-symbol",RunRoutingRule:"symbolFont RunRoutingRule-symbol",ResolveCase:"symbolFont ResolveCase-symbol",CancelCase:"symbolFont CancelCase-symbol",ReactivateCase:"symbolFont ReactivateCase-symbol",AddToQueue:"symbolFont AddToQueue-symbol",CreateChildCase:"symbolFont CreateChildCase-symbol",QueueItemRoute:"symbolFont QueueItemRoute-symbol",QueueItemRelease:"symbolFont QueueItemRelease-symbol",QueueItemRemove:"symbolFont QueueItemRemove-symbol",QueueItemPick:"symbolFont QueueItemPick-symbol",Drilldown:"symbolFont Drilldown-symbol",PopOverButton:"symbolFont PopOverButton-symbol",ExitButton:"symbolFont ExitButton-symbol",ExportToExcel:"symbolFont ExportToExcel-symbol",WordTemplates:"symbolFont WordTemplates-symbol",DocumentTemplates:"symbolFont DocumentTemplates-symbol",OpenInPowerBI:"symbolFont OpenInPowerBI-symbol",OpenPowerBIReport:"symbolFont OpenPowerBIReport-symbol",OpenDelve:"symbolFont OpenDelve-symbol",ArticleLink:"symbolFont ArticleLink-symbol",ArchiveArticle:"symbolFont ArchiveArticle-symbol",ApproveArticle:"symbolFont ApproveArticle-symbol",DiscardArticle:"symbolFont DiscardArticle-symbol",Minor:"symbolFont Minor-symbol",Major:"symbolFont Major-symbol",PublishKnowledgeArticle:"symbolFont PublishKnowledgeArticle-symbol",RelateArticle:"symbolFont RelateArticle-symbol",RelateProduct:"symbolFont RelateProduct-symbol",RestoreArticle:"symbolFont RestoreArticle-symbol",RevertToDraftArticle:"symbolFont RevertToDraftArticle-symbol",Translate:"symbolFont Translate-symbol",UpdateArticle:"symbolFont UpdateArticle-symbol",RemoveFilter:"symbolFont RemoveFilter-symbol",Article:"symbolFont Article-symbol",Graph:"symbolFont Graph-symbol",CSR:"symbolFont CSR-symbol",MembersIcon:"symbolFont MembersIcon-symbol",QueueIcon:"symbolFont QueueIcon-symbol",SiteMap:"symbolFont SiteMap-symbol",NormalPriority:"symbolFont NormalPriority-symbol",LowPriority:"symbolFont LowPriority-symbol",ViewIcon:"symbolFont ViewIcon-symbol",RecentCases:"symbolFont RecentCases-symbol",KBRecords:"symbolFont KBRecords-symbol",NumberOfViews:"symbolFont NumberOfViews-symbol",ResizeHandle:"symbolFont ResizeHandle-symbol",TaskBasedFlow:"symbolFont TaskBasedFlow-symbol",InformationIcon:"symbolFont InformationIcon-symbol",PencilIcon:"symbolFont PencilIcon-symbol",ErrorIcon:"symbolFont ErrorIcon-symbol",SuccessIcon:"symbolFont SuccessIcon-symbol",OptionsetIcon:"symbolFont OptionsetIcon-symbol",NotificationIcon:"symbolFont NotificationIcon-symbol",PanelHeaderImportDataIcon:"symbolFont PanelHeaderImportDataIcon-symbol",SidePanelUpload:"symbolFont SidePanelUpload-symbol",New:"symbolFont New-symbol",DetailsPageClose:"symbolFont DetailsPageClose-symbol",SettingsListIcon:"symbolFont SettingsListIcon-symbol",ListIcon:"symbolFont ListIcon-symbol",ForwardDisable:"symbolFont ForwardDisable-symbol",PdfIconFile:"symbolFont PdfIconFile-symbol",PresentationFile:"symbolFont PresentationFile-symbol",OneNoteFile:"symbolFont OneNoteFile-symbol",AccessFile:"symbolFont AccessFile-symbol",VisioFile:"symbolFont VisioFile-symbol",ProjectFile:"symbolFont ProjectFile-symbol",Plus:"symbolFont Plus-symbol",ChevronUp:"symbolFont ChevronUp-symbol",ChevronDown:"symbolFont ChevronDown-symbol",HappySmiley:"symbolFont HappySmiley-symbol",SadSmiley:"symbolFont SadSmiley-symbol",CaseResolution:"symbolFont CaseResolution-symbol",CampaignResolution:"symbolFont CampaignResolution-symbol",ServiceActivity:"symbolFont ServiceActivity-symbol",Notes:"symbolFont Notes-symbol",Audio:"symbolFont Audio-symbol",Camera:"symbolFont Camera-symbol",Video:"symbolFont Video-symbol",Image:"symbolFont Image-symbol",Html:"symbolFont Html-symbol",SharePointEditDocument:"symbolFont SharePointEditDocument-symbol",SharePointDeleteDocument:"symbolFont SharePointDeleteDocument-symbol",SharePointCheckoutDocument:"symbolFont SharePointCheckoutDocument-symbol",SharePointCheckinDocument:"symbolFont SharePointCheckinDocument-symbol",SharePointEditDocumentProperties:"symbolFont SharePointEditDocumentProperties-symbol",SharePointDiscardCheckoutDocument:"symbolFont SharePointDiscardCheckoutDocument-symbol",SharePointNewDocument:"symbolFont SharePointNewDocument-symbol",SharePointNewWordDocument:"symbolFont SharePointNewWordDocument-symbol",SharePointNewExcelDocument:"symbolFont SharePointNewExcelDocument-symbol",SharePointNewPowerPointDocument:"symbolFont SharePointNewPowerPointDocument-symbol",SharePointNewOneNoteDocument:"symbolFont SharePointNewOneNoteDocument-symbol",SharePointUploadDocument:"symbolFont SharePointUploadDocument-symbol",SharePointChangeLocation:"symbolFont SharePointChangeLocation-symbol",SharePointAddDocumentLocation:"symbolFont SharePointAddDocumentLocation-symbol",SharePointEditLocation:"symbolFont SharePointEditLocation-symbol",SharePointOpenLocation:"symbolFont SharePointOpenLocation-symbol",SharePointOpenDocument:"symbolFont SharePointOpenDocument-symbol",SendByEmail:"symbolFont SendByEmail-symbol",CreateQuote:"symbolFont CreateQuote-symbol",Reply:"symbolFont Reply-symbol",Warning:"symbolFont Warning-symbol",Play:"symbolFont Play-symbol",ExpandButton:"symbolFont ExpandButton-symbol",AssociatedArticle:"symbolFont AssociatedArticle-symbol",DisassociatedArticle:"symbolFont DisassociatedArticle-symbol",FormDesign:"symbolFont FormDesign-symbol",GlobalFilterClearAll:"symbolFont GlobalFilterClearAll-symbol",GlobalFilterExpandedRow:"symbolFont GlobalFilterExpandedRow-symbol",GlobalFilterCollapsedRow:"symbolFont GlobalFilterCollapsedRow-symbol",RelationshipAssistant:"symbolFont RelationshipAssistant-symbol",AutomaticSuggestions:"symbolFont AutomaticSuggestions-symbol",SemanticZoom:"symbolFont SemanticZoom-symbol",SemanticZoomMirrored:"symbolFont SemanticZoomMirrored-symbol",BackwardButton:"symbolFont BackwardButton-symbol",MultiSelect:"symbolFont MultiSelect-symbol",MultiSelectMirrored:"symbolFont MultiSelectMirrored-symbol",Spinning:"symbolFont Spinning-symbol",RetireProduct:"symbolFont RetireProduct-symbol",AddProduct:"symbolFont AddProduct-symbol",OfflineStatus:"symbolFont OfflineStatus-symbol",Abandon:"symbolFont Abandon-symbol",Reactivate:"symbolFont Reactivate-symbol",FinishStage:"symbolFont FinishStage-symbol",SortButton:"symbolFont SortButton-symbol",View:"symbolFont View-symbol",CreateView:"symbolFont CreateView-symbol",EditView:"symbolFont EditView-symbol",Flows:"symbolFont Flows-symbol",OpenEntityRecord:"symbolFont OpenEntityRecord-symbol",GuestUser:"symbolFont GuestUser-symbol",History:"symbolFont History-symbol",ReassignRecords:"symbolFont ReassignRecords-symbol",ManageRoles:"symbolFont ManageRoles-symbol",JoinTeams:"symbolFont JoinTeams-symbol",ChangeManager:"symbolFont ChangeManager-symbol",AddMembers:"symbolFont AddMembers-symbol",RemoveMembers:"symbolFont RemoveMembers-symbol",Download:"symbolFont Download-symbol",SetAsDefaultView:"symbolFont SetAsDefaultView-symbol",Pinned:"symbolFont Pinned-symbol",DistributionList:"symbolFont DistributionList-symbol",MergeRecords:"symbolFont MergeRecords-symbol",AssociateChildCase:"symbolFont AssociateChildCase-symbol",SetAsDefault:"symbolFont SetAsDefault-symbol",ConvertKnowledgeArticle:"symbolFont ConvertKnowledgeArticle-symbol",Messenger:"symbolFont Messenger-symbol",AssociateCategory:"symbolFont AssociateCategory-symbol",OfficeWaffle:"d365Shell OfficeWaffle-symbol",TripleColumn:"symbolFont TripleColumn-symbol",Tiles:"symbolFont Tiles-symbol",HideVisualFilter:"symbolFont HideVisualFilter-symbol",InteractiveDashboard:"symbolFont InteractiveDashboard-symbol",Dynamics365:"symbolFont Dynamics365-symbol",SalesLiterature:"symbolFont SalesLiterature-symbol",SelectButton:"symbolFont SelectButton-symbol",SelectButtonRTL:"symbolFont SelectButtonRTL-symbol",LockPricing:"symbolFont LockPricing-symbol",CreateInvoice:"symbolFont CreateInvoice-symbol",FulfillOrder:"symbolFont FulfillOrder-symbol",CancelInvoice:"symbolFont CancelInvoice-symbol",ActivateQuote:"symbolFont ActivateQuote-symbol",InvoicePaid:"symbolFont InvoicePaid-symbol",GetProducts:"symbolFont GetProducts-symbol",UnlockPricing:"symbolFont UnlockPricing-symbol",Checkbox:"symbolFont Checkbox-symbol",CheckboxComposite:"symbolFont CheckboxComposite-symbol",RightChevron:"symbolFont RightChevron-symbol",LeftChevron:"symbolFont LeftChevron-symbol",BackToStart:"symbolFont BackToStart-symbol",UntrackedEmail:"symbolFont UntrackedEmail-symbol",OpenEmail:"symbolFont OpenEmail-symbol",GlobalFilterCollapsedRowRTL:"symbolFont GlobalFilterCollapsedRowRTL-symbol",CancelOrder:"symbolFont CancelOrder-symbol",URL:"symbolFont URL-symbol",Ticker:"symbolFont Ticker-symbol",UseCurrentPricing:"symbolFont UseCurrentPricing-symbol",Process:"symbolFont Process-symbol",FirstPageButton:"symbolFont FirstPageButton-symbol",LinkedInLogo:"symbolFont LinkedInLogo-symbol",Health:"symbolFont Health-symbol",Family:"symbolFont Family-symbol",Sports:"symbolFont Sports-symbol",Entertainment:"symbolFont Entertainment-symbol",OOF:"symbolFont OOF-symbol",CarouselView:"symbolFont CarouselView-symbol",HeartEmpty:"symbolFont HeartEmpty-symbol",HeartFilled:"symbolFont HeartFilled-symbol",Follow:"symbolFont Follow-symbol",RunQuery:"symbolFont RunQuery-symbol",GroupAnd:"symbolFont GroupAnd-symbol",GroupOr:"symbolFont GroupOr-symbol",Ungroup:"symbolFont Ungroup-symbol",HideInSimpleMode:"symbolFont HideInSimpleMode-symbol",ShowInSimpleMode:"symbolFont ShowInSimpleMode-symbol",PinnedSolid:"symbolFont PinnedSolid-symbol",FilterSolid:"symbolFont FilterSolid-symbol",Bot:"symbolFont Bot-symbol",SystemDocumentTemplates:"symbolFont SystemDocumentTemplates-symbol",MyDocumentTemplates:"symbolFont MyDocumentTemplates-symbol",ViewAllMyDocumentTemplates:"symbolFont ViewAllMyDocumentTemplates-symbol",EnableSecurityRoles:"symbolFont EnableSecurityRoles-symbol",DocumentTemplateUpload:"symbolFont DocumentTemplateUpload-symbol",DocumentTemplateEdit:"symbolFont DocumentTemplateEdit-symbol",DocumentTemplateActivate:"symbolFont DocumentTemplateActivate-symbol",DocumentTemplateDeactivate:"symbolFont DocumentTemplateDeactivate-symbol",YammerIcon:"symbolFont YammerIcon-symbol",StopIcon:"symbolFont StopIcon-symbol",ReplaceContentIcon:"symbolFont ReplaceContentIcon-symbol",CloseDateComingSoon:"symbolFont CloseDateComingSoon-symbol",NearbyCustomers:"symbolFont NearbyCustomers-symbol",RelevantNews:"symbolFont RelevantNews-symbol",UpcomingMeeting:"symbolFont UpcomingMeeting-symbol",RecentMeeting:"symbolFont RecentMeeting-symbol",ReminderWithCall:"symbolFont ReminderWithCall-symbol",CardsTask:"symbolFont CardsTask-symbol",CardsQuote:"symbolFont CardsQuote-symbol",CardsOpportunity:"symbolFont CardsOpportunity-symbol",CardsInvoice:"symbolFont CardsInvoice-symbol",CardsDashboard:"symbolFont CardsDashboard-symbol",CardsLeads:"symbolFont CardsLeads-symbol",OpportunityNoActivity:"symbolFont OpportunityNoActivity-symbol",CaseNoActivity:"symbolFont CaseNoActivity-symbol",CompetitorMentioned:"symbolFont CompetitorMentioned-symbol",MeetingRequest:"symbolFont MeetingRequest-symbol",MissedCloseDate:"symbolFont MissedCloseDate-symbol",IssueDetection:"symbolFont IssueDetection-symbol",NoActivityWithAccount:"symbolFont NoActivityWithAccount-symbol",YesNo:"symbolFont YesNo-symbol",AgendaActivityServiceAppointment:"symbolFont AgendaActivityServiceAppointment-symbol",AgendaActivityFax:"symbolFont AgendaActivityFax-symbol",UpcomingFlight:"symbolFont UpcomingFlight-symbol",OpportunityAtRiskSentiment:"symbolFont OpportunityAtRiskSentiment-symbol",IconDue:"symbolFont IconDue-symbol",AddProductFamily:"symbolFont AddProductFamily-symbol",AddProductBundle:"symbolFont AddProductBundle-symbol",ProductPublish:"symbolFont ProductPublish-symbol",CloneProduct:"symbolFont CloneProduct-symbol",CloseGoal:"symbolFont CloseGoal-symbol",AlignWithFiscalPeriod:"symbolFont AlignWithFiscalPeriod-symbol",Connection:"symbolFont Connection-symbol",ConnectionToMe:"symbolFont ConnectionToMe-symbol",ConnectionToOther:"symbolFont ConnectionToOther-symbol",ProductUpsell:"symbolFont ProductUpsell-symbol",SubscriptionAdd:"symbolFont SubscriptionAdd-symbol",RefreshDevice:"symbolFont RefreshDevice-symbol",BulletListRemove:"symbolFont BulletListRemove-symbol",BulletListAdd:"symbolFont BulletListAdd-symbol",BulletListDownArrow:"symbolFont BulletListDownArrow-symbol",ScatterChart:"symbolFont ScatterChart-symbol",BarChartHorizontal:"symbolFont BarChartHorizontal-symbol",BarChartVertical:"symbolFont BarChartVertical-symbol",FunnelChart:"symbolFont FunnelChart-symbol",PieDouble:"symbolFont PieDouble-symbol",People:"symbolFont People-symbol",PeopleBlock:"symbolFont PeopleBlock-symbol",CreateQuickCampaign:"symbolFont CreateQuickCampaign-symbol",PageSolid:"symbolFont PageSolid-symbol",Page:"symbolFont Page-symbol",OpportunitiesList:"symbolFont OpportunitiesList-symbol",BrowseCards:"symbolFont BrowseCards-symbol",AALinkedInLogo:"symbolFont AALinkedInLogo-symbol",SendAndClose:"symbolFont SendAndClose-symbol",AdvFind:"symbolFont AdvFind-symbol",DoubleChevronLeft:"symbolFont DoubleChevronLeft-symbol",DoubleChevronRight:"symbolFont DoubleChevronRight-symbol",AreaChart:"symbolFont AreaChart-symbol",DonutChart:"symbolFont DonutChart-symbol",TagChart:"symbolFont TagChart-symbol",Teaser:"symbolFont Teaser-symbol",Clone:"symbolFont Clone-symbol",AreaChartMirrored:"symbolFont AreaChartMirrored-symbol",BarChartHorizontalMirrored:"symbolFont BarChartHorizontalMirrored-symbol",BarChartVerticalMirrored:"symbolFont BarChartVerticalMirrored-symbol",Recent:"symbolFont Recent-symbol",SharePointIcon:"symbolFont SharePointIcon-symbol",OneDriveIcon:"symbolFont OneDriveIcon-symbol",FolderSharedIcon:"symbolFont FolderSharedIcon-symbol",MSTeamsIcon:"symbolFont MSTeamsIcon-symbol",ScrollUpDown:"symbolFont AreaSwitcher-symbol",SendToCTI:"symbolFont SendToCTI-symbol",Letter:"symbolFont Letter-symbol",Fax:"symbolFont Fax-symbol",NewLetter:"symbolFont NewLetter-symbol",NewFax:"symbolFont NewFax-symbol",LetterIncoming:"symbolFont LetterIncoming-symbol",LetterOutgoing:"symbolFont LetterOutgoing-symbol",FaxIncoming:"symbolFont FaxIncoming-symbol",FaxOutgoing:"symbolFont FaxOutgoing-symbol",CreatePersonalView:"symbolFont CreatePersonalView-symbol",ViewHierarchy:"symbolFont ViewHierarchy-symbol",ProductPreview:"symbolFont ProductPreview-symbol",AddTerritoryMember:"symbolFont AddTerritoryMember-symbol",RemoveTerritoryMember:"symbolFont RemoveTerritoryMember-symbol",Report:"symbolFont Report-symbol",NewServiceActivity:"symbolFont NewServiceActivity-symbol",Recurrence:"symbolFont Recurrence-symbol",EditSeries:"symbolFont EditSeries-symbol",EndSeries:"symbolFont EndSeries-symbol",EditDefaultFilter:"symbolFont EditDefaultFilter-symbol",QueueItemDetail:"symbolFont QueueItemPick-symbol",ThumbsUp:"symbolFont ThumbsUp-symbol",ThumbsDown:"symbolFont ThumbsDown-symbol",Lead:"symbolFont Lead-symbol",TableLink:"symbolFont TableLink-symbol",TableGroup:"symbolFont TableGroup-symbol",ClearDefault:"symbolFont ClearDefault-symbol",SetDefault:"symbolFont SetDefault-symbol",SaveFilterToCurrentPersonalView:"symbolFont SaveFilterToCurrentPersonalView-symbol",SaveFilterToNewPersonalView:"symbolFont SaveFilterToNewPersonalView-symbol",Expand:"symbolFont Expand-symbol",ChromeMinimize:"symbolFont ChromeMinimize-symbol",ChromeMaximize:"symbolFont ChromeMaximize-symbol",ConnectionRoleManageRecordType:"symbolFont ConnectionRoleManageRecordType-symbol",Sync:"symbolFont Sync-symbol",ThumbsUpSolid:"symbolFont ThumbsUpSolid-symbol",ThumbsDownSolid:"symbolFont ThumbsDownSolid-symbol",msdyn_enhancedsla:"symbolFont msdyn_enhancedsla-symbol",msdyn_enhancedslakpi:"symbolFont msdyn_enhancedslakpi-symbol",msdyn_enhancedslakpiinstance:"symbolFont msdyn_enhancedslakpiinstance-symbol",CreateOrder:"symbolFont CreateOrder-symbol",Revise:"symbolFont Revise-symbol",CloseQuote:"symbolFont CloseQuote-symbol",CommandChecker:"symbolFont CommandChecker-symbol",MiniContract:"symbolFont MiniContract-symbol",MiniExpand:"symbolFont MiniExpand-symbol",Print:"symbolFont Print-symbol",NoDataAvailable:"symbolFont NoDataAvailable-symbol",MoreVertical:"symbolFont MoreVertical-symbol",OpenInNewWindow:"symbolFont OpenInNewWindow-symbol",EditEvent:"symbolFont EditEvent-symbol",LinkToRecord:"symbolFont LinkToRecord-symbol",UnlinkFromRecord:"symbolFont UnlinkFromRecord-symbol",KnowledgeSearch:"symbolFont KnowledgeSearch-symbol",ChevronDownMed:"symbolFont ChevronDownMed-symbol",OpenFolderHorizontal:"symbolFont OpenFolderHorizontal-symbol",TaskClipboard:"symbolFont TaskClipboard-symbol",CustomList:"symbolFont CustomList-symbol",ExpandAllRecords:"symbolFont ExpandAllRecords-symbol",CollapseAllRecords:"symbolFont CollapseAllRecords-symbol",SelectAll:"symbolFont SelectAll-symbol",Embed:"symbolFont Embed-symbol",MailTemplate:"symbolFont MailTemplate-symbol",Monitor:"symbolFont Monitor-symbol",Error:"symbolFont Error-symbol",CustomEntity:"symbolFont CustomEntity-symbol"};function i(e){return a[r[e]]||a.Default}},zoUO:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("FZDd"),a=n("iZ7K"),i=n("SRlt"),o=n("vNXc"),s=n("fU7K"),c=n("g22U");function l(e){return{type:"SERIALIZE_FETCHXML_WEB_REQUEST_ASYNC",execute({dispatch:t,getState:n},l){const u=e.get_query(),d=o.a.fromXml(u,null).getKeyQuery(),p=d.get_EntityLogicalName(),g=d.get_ColumnSet();return t(Object(r.f)(p,!1,g.get_Columns())).then(()=>function(e,t,n){return{urlParameters:Object(a.o)(e,t)+"?fetchXml="+Object(s.CrmUrlEncode)(n),method:"GET",additionalHeaders:{Accept:i.a,Prefer:"odata.include-annotations=*"},additionalParameters:{[c.a.TYPE]:c.c.RETRIEVE_MULTIPLE,[c.a.SUB_TYPE]:c.b.RetrieveMultipleOther}}}(n(),p,u))}}}},zsAz:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"h",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="UciError",a=/\{(\d+)\}/g;function i(e,t,n,a,i,o,s=!1,c={}){const l=new Error(e);return l.name=r,l.errorCode=t,l.errorParameters=n,l.displayTitle=a,l.displayMessage=i,l.blockErrorReporting=s,l.errorAnnotations=c,o&&(l.stack=o),l}function o(e){if(!e){const e=new Error("Received blank error object");return e.name=r,e.errorCode=2147746581,e}const t=new Error(e.message);return t.name=r,t.errorCode=e.errorCode||2147746581,t.errorParameters=e.errorParameters,t.displayTitle=e.displayTitle,t.displayMessage=e.displayMessage,t.blockErrorReporting=e.blockErrorReporting,t.innerError=e.innerError,t.errorAnnotations=e.errorAnnotations,e.stack&&(t.stack=e.stack),t}function s(e,t){e&&t&&(e.errorParameters?e.errorParameters=e.errorParameters.concat(t):e.errorParameters=t)}function c(e){return e&&e.errorCode}function l(e){return null==e?void 0:e.get_ErrorCode}function u(e){let t;return l(e)&&(t=e.get_ErrorFault()),t?t.get_annotations():e.errorAnnotations}function d(e,t){if((null==e?void 0:e.match(a))&&t){const n=u(t);return n?e.replace(a,(e,t)=>{var r;return null!==(r=n["@Microsoft.PowerApps.CDS.ErrorDetails."+t])&&void 0!==r?r:e}):e}return e}},zu1I:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("FdB0"),a=n("TKDo"),i=n("ruPX");function o(e,t,n,r,a){return{uniqueName:e,entityTypeName:a,data:r,dialogOptions:n}}function s(e,t,n,s){const c=[{name:"dialogName",value:e},{name:"dialogHeight",value:t.height},{name:"dialogWidth",value:t.width},{name:"dialogPosition",value:t.position},{name:"dialogWindowPosition",value:t.windowPosition}];return{type:"form.openDialog",execute:({dispatch:c,getState:l},u,d)=>c(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){if(e&&e.dialogOptions&&"inline"===e.dialogOptions.windowPosition)return Object(i.a)(a.a,e,t);return Object(i.a)(r.a,e,t)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(o(e,l(),t,n),s)),getFailureParameters:(e,t)=>c}}},zwYV:function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"j",(function(){return p})),n.d(t,"i",(function(){return d})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"h",(function(){return l}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="externalcontext.property.listener.add",a="externalcontext.property.listener.remove",i="externalcontext.properties.intialize",o="externalcontext.descriptors.update",s="externalcontext.property.update";function c(e,t,n){return{type:r,payload:{contextId:e,propertyId:t,listener:n}}}function l(e,t,n){return{type:a,payload:{contextId:e,propertyId:t,listener:n}}}function u(e){return{type:i,payload:e}}function d(e){return{type:o,payload:e}}function p(e){return{type:s,payload:e}}},zzhk:function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return f}));var r=n("3/02"),a=n("Lyxw"),i=n("GYEz"),o=n("w1eR"),s=n("b8TU"),c=n("Knfm"),l=n("GEbX"),u=n("NjDY"),d=n("0kGT"),p=n("4leG"),g=n("AVDU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function h(e){if(!e)return!1;if(Object(g.b)(e))return!0;if(Object(p.c)(e))return!1;if(Object(c.a)(e)===l.a.MultiSession)return!0;if(Object(d.b)(e))return!0;const t=Object(s.c)(e)>e.theme.sizes.Breakpoints.DimensionS;return f(e)&&t}function f(e){const t=Object(g.b)(e),n=Object(a.c)(e,r.Yc),s=Object(a.c)(e,r.be),c=Object(u.x)(e),l=!!c&&c.enableUnifiedInterfaceShellRefresh;return(Object(i.a)(e)===o.a.Browser||t)&&(n||s&&l)}}}),window.bundleExecutionMarkers["scripts/app.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();