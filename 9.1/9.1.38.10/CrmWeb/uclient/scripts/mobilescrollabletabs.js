(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/mobilescrollabletabs.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[79],{gJPS:function(e,t,s){"use strict";s.r(t),s.d(t,"MobileScrollableTabs",(function(){return x}));var i=s("nuS9"),o=s("4fxQ"),l=s("/2of"),r=s("OA2N"),a=s("u+q+"),n=s("2YQW"),d=s("i1f0"),c=s("+zjj"),p=s("TYIz"),h=s("gvL4"),b=s("3rse"),y=s("io1E"),u=s("arV0"),m=s("b8TU"),g=s("dHD5"),f=s("tjBT"),v=s("unFF"),I=s("meVR"),S=s("YxC/"),O=s("X3qb"),T=s("89vK"),_=s("e1AF"),j=s("iZ7K"),E=s("PtYj"),F=s("QiMq"),w=s("zmL5"),R=s("YWpA"),L=s("+Ajx"),C=s("O7zD"),N=s("hXGe"),k=s("jrkH"),M=s("H4dV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class H extends i.Component{constructor(e){super(e),this._dataId="tablist-",this._keyDownHandler=this._keyDownHandler.bind(this),this._selectRelatedEntityHandler=this._selectRelatedEntityHandler.bind(this),this._flyoutKeyDownHandler=this._flyoutKeyDownHandler.bind(this),this._ulRef=this._ulRef.bind(this),this._toggleFlyout=this._toggleFlyout.bind(this),this._closeFlyout=this._closeFlyout.bind(this),this.state={isFlyoutOpened:!1,retrieveMissingRelatedEntitiesFinished:!1},this._previousHeaderCollapsed=e.headerCollapsed}componentDidMount(){this._previousHeaderCollapsed=this.props.headerCollapsed}componentDidUpdate(){var e,t;if(this._tabNavigatorList)if(null===(e=this.props.selectedRelatedEntity)||void 0===e?void 0:e.isSelected){const e=o.findDOMNode(this._tabNavigatorList),t=null==e?void 0:e.childNodes;let s;for(let e=0;e<this.props.tabItems.length;e++)this.props.tabItems[e].name===this.props.selectedRelatedEntity.id&&this.props.tabItems[e].id===N.a&&(s=this.props.tabItems[e].id);if(s){let i;for(let e=0;e<t.length;e++)if(Object(N.g)(t[e].id,this.props.id)===s){i=e;break}if(t[i]&&this._previousFocusedItem!==t[i]){const o=t[i],l=o.getBoundingClientRect(),r=M.a.getInstance().get_IsAndroid();r&&(e.style.scrollBehavior="auto");let a=e.scrollWidth-e.clientWidth;this.props.isRTL&&(a=r?0:-1*a),e.scrollLeft=a,this.props.isRTL&&l.right>e.clientWidth?e.scrollLeft=e.scrollLeft+(l.right-e.clientWidth):l.left<0&&(e.scrollLeft=e.scrollLeft+l.left),this._previousScrolledTab=s,o.focus(),r&&(e.style.scrollBehavior="smooth"),this._previousFocusedItem=t[i],this.props.selectedTabId&&this.props.selectRelatedTab(this.props.selectedRelatedEntity,this.props.contextToken)}}}else{const e=null===(t=o.findDOMNode(this._tabNavigatorList))||void 0===t?void 0:t.childNodes;let s;for(let t=0;t<e.length;t++)if(Object(N.g)(e[t].id,this.props.id)===this.props.selectedTabId){s=t;break}this._previousScrolledTab!==this.props.selectedTabId&&this._previousScrolledTab!==N.b&&this._updateScrollPosition(this.props.selectedTabId,this._previousScrolledTab),e[s]&&this._previousFocusedItem!==e[s]&&(e[s].focus(),this._previousFocusedItem=e[s])}this._previousHeaderCollapsed=this.props.headerCollapsed}componentWillReceiveProps(e){e.headerCollapsed!==this._previousHeaderCollapsed&&this.state.isFlyoutOpened&&this._toggleFlyout()}componentWillUnmount(){this.props.updateVisitedTabNames(this.props.selectedTabId)}_renderAssociativeOrGanttGrid(){return i.createElement(k.a,{id:this.props.id,selectedRelatedEntity:this.props.selectedRelatedEntity,isAuditFeatureEnabled:this.props.isAuditFeatureEnabled,contextToken:this.props.contextToken,formId:this.props.formId.guid,entityName:this.props.entityTypeName,recordId:this.props.entityId.guid,style:this.props.associatedGridContainerStyle})}_updateScrollPosition(e,t){const s=this.props.tabItems.findIndex(e=>e.id===(null!=t?t:this.props.selectedTabId)),i=this.props.tabItems.findIndex(t=>t.id===e),l=o.findDOMNode(this._tabNavigatorList);let r;if((null==l?void 0:l.childNodes)&&(null==l?void 0:l.childNodes.length)>0)for(let t=0;t<l.childNodes.length;t++)if(Object(N.g)(l.childNodes[t].id,this.props.id)===e){r=t;break}const a=l?l.scrollWidth-l.clientWidth:0;if(r||0===r){const t=null==l?void 0:l.childNodes[r],o=t.getBoundingClientRect();let n,d=!1;if((this.props.isRTL?i>s:i<s)&&(o.left<.33*l.clientWidth||o.right>l.clientWidth)?(n=t.offsetLeft-(l.clientWidth-t.offsetWidth-40),d=!0):(this.props.isRTL?i<s:i>s)&&(o.right>.67*l.clientWidth||o.left<40)&&(n=t.offsetLeft-40),this.props.isRTL&&M.a.getInstance().get_IsAndroid()&&(n+=a),(n||0===n)&&M.a.getInstance().get_IsIOS()){let e;const t=l.scrollLeft,s=n-t,i=300,o=r=>{e||(e=r);const a=r-e,c=t+a/i*s;l.scrollLeft=d?Math.max(c,n):Math.min(c,n),a<i&&window.requestAnimationFrame(o)};window.requestAnimationFrame(o)}else(n||0===n)&&(l.scrollLeft=n);this._previousScrolledTab=e}}_createOnClick(e){return()=>{this._updateScrollPosition(e),e===N.b?(this.props.retrieveMissingRelatedEntities(this.props.entityTypeName).then(e=>{e&&this.setState({retrieveMissingRelatedEntitiesFinished:!0})}),this._toggleFlyout()):this.props.selectTab(e,this.props.contextToken,this.props.selectedRelatedEntity)}}_keyDownHandler(e){var t,s;const i=null===(t=e.target)||void 0===t?void 0:t.id;if(this._tabNavigatorList){const t=null===(s=o.findDOMNode(this._tabNavigatorList))||void 0===s?void 0:s.childNodes;if(t&&t.length>0){let s,o;for(let e=0;e<t.length;e++)if(t[e].id===i){s=e;break}if(e.keyCode===b.a.LeftArrow)o=(s-1+t.length)%t.length,t[o].focus();else if(e.keyCode===b.a.RightArrow)o=(s+1+t.length)%t.length,t[o].focus();else if(e.keyCode===b.a.Enter||e.keyCode===b.a.Space)if(Object(N.g)(i,this.props.id)===N.b)this.props.retrieveMissingRelatedEntities(this.props.entityTypeName).then(e=>{e&&this.setState({retrieveMissingRelatedEntitiesFinished:!0})}),this._toggleFlyout();else{const e=this.props.tabItems.find(e=>e.id===Object(N.g)(i,this.props.id)),t=null==e?void 0:e.id;this.props.selectTab(t,this.props.contextToken,this.props.selectedRelatedEntity)}}}}_flyoutKeyDownHandler(e){var t,s;const i=Object(N.g)(null===(t=e.target)||void 0===t?void 0:t.id,this.props.id);if(e.keyCode===b.a.Enter||e.keyCode===b.a.Space){const e=null===(s=this.props.tabItems.find(e=>e.id===i))||void 0===s?void 0:s.id;this.props.selectTab(e,this.props.contextToken,this.props.selectedRelatedEntity),this._toggleFlyout()}}_toggleFlyout(){this.setState({isFlyoutOpened:!this.state.isFlyoutOpened})}_renderTabFlyout(){const e=N.b,t=this.props.headerCollapsed===this._previousHeaderCollapsed&&this.state.isFlyoutOpened;return i.createElement(y.a,{key:Object(C.g)(N.a,this.props.id),id:this.props.id,relativeElementId:Object(C.g)(e,this.props.id),isFlyoutOpened:t,selectTab:this._flyoutKeyDownHandler,selectRelatedEntity:this._selectRelatedEntityHandler,closeFlyout:e=>this._closeFlyout(e),retrieveMissingRelatedEntitiesFinished:this.state.retrieveMissingRelatedEntitiesFinished,isInCreateMode:this.props.isInCreateMode,tabNavigatorList:this._tabNavigatorList})}_renderTabList(e){const t=Object(S.c)(this.props.resourceStrings,O.b),s=t?String.format(t,this.props.entityDisplayName):"";return i.createElement(h.a,{id:Object(C.g)(N.c,this.props.id),key:N.c+(e&&e.length),role:"tablist",ref:this._ulRef,style:this.props.scrollableTabListStyle,onKeyDown:this._keyDownHandler,accessibilityLabel:s},e)}_renderTabContent(){if(this.props.selectedTabId){const e=[];for(const t of this.props.tabItems){const s=this.props.selectedTabId===t.id;e.push(i.createElement(l.a,{renderHeaderFields:this.props.renderHeaderFields,renderFooterFields:this.props.renderFooterFields,key:"tab_"+t.id,id:this.props.id,tabId:t.id,tabName:t.name,showTab:s,labelledBy:t.id,columnStyle:this.props.columnStyle,sectionStyle:this.props.sectionStyle,cellStyle:this.props.cellStyle,cellContainerStyle:this.props.cellContainerStyle,style:Object.assign(Object.assign({},this.props.tabBasicStyle),s?this.props.selectedTabStyle:this.props.tabStyle),showFooterFieldsRenderInSection:this.props.showFooterFieldsRenderInSection,viewportElementId:this.props.viewportElementId}))}return i.createElement(R.a,{style:this.props.tabsContainerStyle},e)}return this.props.selectedRelatedEntity&&this.props.selectedRelatedEntity.isSelected?i.createElement(R.a,{style:this.props.containerStyle},this._renderAssociativeOrGanttGrid()):null}render(){const e=[];for(let t=0;t<this.props.tabItems.length;t++){const s=this.props.tabItems[t].visible;if(this.props.tabItems[t].id===N.b||!s)continue;const o=this.props.tabItems[t].name,l=this.props.tabItems[t].label,a=this.props.tabItems[t].id,n=this.props.tabItems[t].previewId,d=this._createOnClick(a),c=this.props.selectedRelatedEntity&&this.props.selectedRelatedEntity.isSelected?N.a===a:this.props.selectedTabId===a;e.push(i.createElement(r.a,{key:o,tabName:o,label:l,isSelected:c,isScrollable:!0,relatedTabId:Object(C.g)(N.b,this.props.id),isFlyoutOpened:this.state.isFlyoutOpened,testhooks:Object(N.e)({id:this._dataId+o},n),id:Object(C.g)(a,this.props.id),tabLength:this.props.tabItems.length,onClick:d}))}if(Object(N.d)(this.props.tabItems)){const t=Object(N.d)(this.props.tabItems),s=t.name,o=t.label,l=this.props.selectedTabId===N.b,a=t.previewId,n=this._createOnClick(N.b);e.push(i.createElement(r.a,{key:s,tabName:s,label:o,isSelected:l,isScrollable:!0,relatedTabId:Object(C.g)(N.b,this.props.id),isFlyoutOpened:this.state.isFlyoutOpened,testhooks:Object(N.e)({id:this._dataId+s},a),id:Object(C.g)(N.b,this.props.id),tabLength:this.props.tabItems.length,onClick:n}))}let t;return t=this.props.returnTabsBody?this._renderTabContent():i.createElement(R.a,{style:this.props.headerStyle},this._renderTabList(e),this._renderTabFlyout()),t}_closeFlyout(e){e&&e.target&&e.target.id!==N.b&&this._toggleFlyout()}_ulRef(e){this._tabNavigatorList=e}_selectRelatedEntityHandler(e){this._toggleFlyout(),this.props.selectRelatedTab(e,this.props.contextToken)}}H.displayName="TabNavigator";const x=Object(a.a)((function(){const e=Object(N.f)(),t=Object(c.f)(),s=Object(f.a)(),i=Object(T.a)(),o=Object(S.h)();let l=null;return function(r,a){const p=o(r,O.f),h=Object(g.j)(r,a.id);Object(n.e)(l,h)||(l=h);const b=Object(u.g)(r,a.id),y=Object(m.c)(r),f=b,I=Object(u.m)(r,a.id),S=I?null:t(r,a),T=Object(c.e)(r,a,l),_=e(r,{props:a,resourceStrings:p,selectedRelatedEntity:T,isInCreateMode:I});let F=Object(d.wc)(r,a,l),R=!0;for(const e of _)F!==e.id||e.visible||(R=!1);if(!R)for(const e of _)if(e.visible){F=e.id;break}const L=s(r,Object.assign(Object.assign({},a),{viewPortWidth:y}),a.headerCollapsed,a.enabledFormFCBs),C=Object(v.a)(r),N=Object(w.b)(r,a.id),k=i(r);let M="",H=null,x=!0;f&&(M=f.entityTypeName,H=f.id,x=!f.bodyOnly);const D=Object(E.a)(r,M),W=Object(j.h)(r,M);return{selectedTabId:F,relatedEntities:S,tabItems:_,selectedRelatedEntity:T,entityTypeName:M,entityId:H,tabListStyle:L.tabListStyle,scrollableTabListStyle:L.scrollableTabListStyle,tabBasicStyle:L.tabBasicStyle,containerStyle:L.containerStyle,tabsContainerStyle:L.tabsContainerStyle,headerStyle:L.headerStyle,cellContainerStyle:L.cellContainerStyle,selectedTabStyle:L.selectedTabStyle,semanticZoomListItemStyle:L.semanticZoomListItemStyle,customSemanticZoomButtonStyle:L.customSemanticZoomButtonStyle,overflowTabListItemStyle:L.overflowTabListItemStyle,contextToken:l,associatedGridContainerStyle:L.associatedGridContainerStyle,semanticZoomTabListItemWidthInEm:C.sizes.TabNavigator.SemanticZoomTabListItemWidthInEm,overflowtItemWidthInEm:C.sizes.TabNavigator.OverflowtItemWidthInEm,tabListItemStyles:k,formId:N,resourceStrings:p,isInCreateMode:I,entityDisplayName:W.DisplayName,showTabNavigator:x,viewportElementId:a.viewportElementId,isAuditFeatureEnabled:D}}}),(function(e,t){return{selectTab:(s,i,o)=>{if(s===N.a){if(o){const s=Object(g.a)(i,o.relationshipName,o.ordinal),l=Object.assign(Object.assign({},o),{isSelected:!0});e(Object(p.b)(t.id,void 0,i)),e(Object(I.a)(t.id,s,l)),t.afterSelectTab()}}else{if(o&&o.isSelected){const s=Object.assign(Object.assign({},o),{isSelected:!1});e(Object(L.b)(t.id,i,s))}e(Object(p.b)(t.id,s,i)),t.afterSelectTab()}},selectRelatedTab:(s,i)=>{if(s){const o=Object(g.a)(i,s.relationshipName,s.ordinal),l=Object.assign(Object.assign({},s),{isSelected:!0});e(Object(p.b)(t.id,void 0,i)),e(Object(I.a)(t.id,o,l)),t.afterSelectTab()}else e(Object(p.b)(t.id,void 0,i)),t.afterSelectTab()},updateVisitedTabNames:s=>{e(Object(F.b)(t.id,s))},retrieveMissingRelatedEntities:t=>e(Object(_.a)(t))}}))(H)}}]),window.bundleExecutionMarkers["scripts/mobilescrollabletabs.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();