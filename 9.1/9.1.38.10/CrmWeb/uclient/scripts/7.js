(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/7.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[7],{"Es1/":function(t,e,o){"use strict";o.d(e,"a",(function(){return a}));var n=o("M0zh");function a(t,e){const o={ruleContext:t};return{type:n.s,payload:o,meta:{commandManagerId:e}}}},GpAH:function(t,e,o){"use strict";o.d(e,"a",(function(){return a}));var n=o("M0zh");function a(t,e){const o={ribbonId:t};return{type:n.r,payload:o,meta:{commandManagerId:e}}}},Ki7F:function(t,e,o){"use strict";o.d(e,"a",(function(){return ot}));var n=o("c/eZ"),a=o("nuS9"),i=o("9eA9"),r=o("u+q+"),s=o("hAdb"),d=o("3/02"),l=o("Lyxw"),m=o("NvOS"),c=o("z0a7"),u=o("YxC/"),p=o("H/hG"),h=o("YWpA"),b=o("odYE"),y=o("SAYH"),C=o("eXjw"),I=o("4leG"),f=o("P7gI"),S=o("6hHv"),g=o("ZdjS"),_=o("wNQP"),B=o("vZzn"),M=o("WTcq"),O=o("mpSO"),x=o("OiiO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let L=!1;var j=o("nmJf"),v=o("Me5Q"),T=o("s308"),R=o("nUyF");var w=o("GpAH"),E=o("Es1/"),D=o("XA60"),k=o("o0iw"),P=o("VZXL"),z=o("GYDS"),F=o("cUMa"),A=o("ILmX"),N=o("wgH2"),G=o("GT4X"),H=o("P86a"),W=o("jRy5"),q=o("dHD5"),X=o("0kGT"),Z=o("GEbX"),K=o("Knfm"),U=o("zzhk"),V=o("IqkD"),Y=o("tJ+6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Q extends a.Component{constructor(){super(...arguments),this._startedInitializing=!1}componentWillUnmount(){this.props.destroyCommandBar(this.props.commandManagerId||this.props.id)}componentDidMount(){this._handleProps(this.props)}componentDidUpdate(t){this._handleProps(t)}render(){if(this._isNativeCommandManager())return null;const t=this.props.customCommandManagerStyle?this.props.customCommandManagerStyle:{float:"right"};if(this.props.isRTL?t.paddingRight=0:t.paddingLeft=0,!this.props.commandBarEnabled&&(this.props.isDashboardCommandBar||this.props.ruleContext&&(this.props.contextToken&&this.props.contextToken.contextTokenType===W.a.MainGrid&&1===this.props.ruleContext.ContextType||2===this.props.ruleContext.ContextType||5===this.props.ruleContext.ContextType)))return null;if(!Object(z.c)(this.props.commandManagerId,!0)){if(this.props.initializeMetadataFailed){if(this._isLoadingStringDisabled())return null;const e=Object(u.c)(this.props.resourceStrings,P.a);return a.createElement(h.a,{style:t},a.createElement(p.a,{style:Object(k.l)()},e))}if(!this.props.initializationCompleted)return this._isLoadingStringDisabled()?null:a.createElement(h.a,{style:t})}const e=this.props.contextToken?Object(q.v)(this.props.contextToken):null;let o=null;return null!==this.props.selectedRecords&&void 0!==this.props.selectedRecords?o=this.props.selectedRecords:this.props.ruleContext&&null!==this.props.ruleContext.SelectedItems&&void 0!==this.props.ruleContext.SelectedItems&&(o=this.props.ruleContext.SelectedItems.map(t=>t.EntityReference)),a.createElement(h.a,{style:t},this.props.isHidden?null:a.createElement(D.b,{commandbarDisplayMode:this.props.commandbarDisplayMode,addedCommandList:this.props.addedCommandList,appendedCommandList:this.props.appendedCommandList,width:this.props.width,mainMenuLength:this.props.mainMenuLength,iconPosition:this.props.iconPosition,commandManagerId:this.props.commandManagerId?this.props.commandManagerId:this.props.id,pageId:this.props.id,ribbonDescriptor:this.props.ribbonDescriptor,selectedRecords:o,executeCommand:this._executeCommand(this.props.ribbonDescriptor,this.props.ruleContext,this.props.id,this.props.commandManagerId?this.props.commandManagerId:this.props.id,e),commandBarStyle:this._autoPopulateCommandBarStyle(),ribbonId:this.props.ribbonId,height:this.props.height,hideFlyoutButtonChevron:this.props.hideFlyoutButtonChevron,isCommandBarRefresh:this.props.isCommandBarRefreshForceEnabled||this.props.isCommandBarRefresh,contextKey:e,rootZIndex:this.props.rootZIndex}))}_isLoadingStringDisabled(){return this.props.width<170}_handleProps(t){if(this.props.initializeMetadataFailed)return;Object(z.c)(this.props.commandManagerId)&&this.props.initializeGlobalScriptContainer();const e=this.props;if(this._isNativeCommandManager()&&(this._didCommandListChange(e.addedCommandList,t.addedCommandList)&&e.storeAddedCommandList(e.commandManagerId,e.addedCommandList),this._didCommandListChange(e.appendedCommandList,t.appendedCommandList)&&e.storeAppendedCommandList(e.commandManagerId,e.appendedCommandList)),this.props.initializationCompleted){if(t.ruleContext&&e.ruleContext&&!t.ruleContext.IsServerAvailable&&e.ruleContext.IsServerAvailable&&e.retrieveRibbon(e.ribbonId),Object(F.a)(e.allowedControls,t.allowedControls,(t,e)=>t===e)||e.storeAllowListInState(e.allowedControls,e.commandManagerId),e.metaDataLoadedResolve&&e.metaDataLoadedResolve(!0),e.contextToken!==t.contextToken&&e.storeContextTokenInState(),e.ribbonId&&""!==e.ribbonId&&e.xrmInitialized&&e.ribbonDescriptor&&e.ribbonDescriptor.initialized===C.a.Initialized){const o=this._didFormChange(e,t),n=this._didRuleContextChange(e,t),a=this._didServerStatusChange(e,t),i=t.ribbonDescriptor!==e.ribbonDescriptor;if(o||n||a||i){const t=o||a||i;i&&e.setCommandManagerInitializationState(H.a.Uninitialized,e.commandManagerId),e.storeRuleContextInState(e.ruleContext,e.commandManagerId||e.id),e.evaluateRules(e.ribbonDescriptor,e.ruleContext,t)}}this._isNativeCommandManager(!1)&&(this.props.storeAddedCommandList(this.props.commandManagerId,this.props.addedCommandList),this.props.storeAppendedCommandList(this.props.commandManagerId,this.props.appendedCommandList)),t.ribbonId!==e.ribbonId&&e.storeRibbonIdInState(e.ribbonId,e.commandManagerId||e.id)}else{const t=Object(N.a)(e.ribbonId);!this.props.xrmInitialized&&e.ribbonId&&t&&"undefined"!==t||this._startedInitializing||(this._startedInitializing=!0,this._isNativeCommandManager()&&(this.props.storeAddedCommandList(this.props.commandManagerId,this.props.addedCommandList),this.props.storeAppendedCommandList(this.props.commandManagerId,this.props.appendedCommandList)),this.props.initializeCommandBar())}}_isNativeCommandManager(t=!0){return t?this.props.isInMobileModeForOct2019&&!this.props.isMainFormDialog&&(this.props.isNativeMode||(e=this.props.id,o=this.props.commandManagerId,Object(z.c)(o)||o===e)):this.props.isInMobileModeForOct2019&&this.props.isNativeMode;var e,o}_didCommandListChange(t,e){return!Object(F.a)(t,e,(t,e)=>t.Id===e.Id&&t.DisplayText===e.DisplayText)}_didRuleContextChange(t,e){return e.ruleContext&&t.ruleContext&&!Object(F.a)(t.ruleContext.SelectedItems,e.ruleContext.SelectedItems,(t,e)=>b.a.equals(t.EntityReference,e.EntityReference))||!(e.ruleContext||!t.ruleContext)}_didServerStatusChange(t,e){return e.ruleContext&&t.ruleContext&&e.ruleContext.IsServerAvailable!==t.ruleContext.IsServerAvailable}_didFormChange(t,e){if(t.isMultiSessionMode&&Object(z.c)(t.commandManagerId,!0))return!1;if(t.recordStateCode!==e.recordStateCode&&null!=t.recordStateCode||t.recordStatusCode!==e.recordStatusCode&&null!=t.recordStatusCode)return!0;const o=t.ruleContext.EntityId||y.a.EMPTY,n=e.ruleContext.EntityId||y.a.EMPTY;return!y.a.equals(o,n)}_autoPopulateCommandBarStyle(){const t=this.props.designLanguage;this._defaultCommandBarStyle||(this._defaultCommandBarStyle=Object(k.n)(this.props.isRTL,t)),this._memoizedCommandBarStyle||(this._memoizedCommandBarStyle=this._defaultCommandBarStyle);const e=this.props.commandBarStyle?Object(k.n)(this.props.isRTL,t):this._defaultCommandBarStyle;return this.props.commandBarStyle&&(this.props.commandBarStyle.container&&(e.container=this._autoPopulateContainerStyles(this.props.commandBarStyle.container,this._defaultCommandBarStyle.container,this._memoizedCommandBarStyle.container)),this.props.commandBarStyle.flyoutStyles&&(e.flyoutStyles=this._autoPopulateFlyoutStyles(this.props.commandBarStyle.flyoutStyles,this._defaultCommandBarStyle.flyoutStyles,this._memoizedCommandBarStyle.flyoutStyles)),this.props.commandBarStyle.list&&(e.list=this._autoPopulateListStyles(this.props.commandBarStyle.list,this._defaultCommandBarStyle.list,this._memoizedCommandBarStyle.list)),this.props.commandBarStyle.listItem&&(e.listItem=this._autoPopulateListStyles(this.props.commandBarStyle.listItem,this._defaultCommandBarStyle.listItem,this._memoizedCommandBarStyle.listItem)),this.props.commandBarStyle.listItemBody&&(e.listItemBody=this._autoPopulateButtonStyle(this.props.commandBarStyle.listItemBody,this._defaultCommandBarStyle.listItemBody,this._memoizedCommandBarStyle.listItemBody)),this.props.commandBarStyle.primaryOfSplitButton&&(e.primaryOfSplitButton=this._autoPopulateIButtonStyles(this.props.commandBarStyle.primaryOfSplitButton,this._defaultCommandBarStyle.primaryOfSplitButton,this._memoizedCommandBarStyle.primaryOfSplitButton)),this.props.commandBarStyle.moreIcon&&(e.moreIcon=this._autoPopulateIButtonStyles(this.props.commandBarStyle.moreIcon,this._defaultCommandBarStyle.moreIcon,this._memoizedCommandBarStyle.moreIcon)),this.props.commandBarStyle.splitbuttonicon&&(e.splitbuttonicon=this._autoPopulateIButtonStyles(this.props.commandBarStyle.splitbuttonicon,this._defaultCommandBarStyle.splitbuttonicon,this._memoizedCommandBarStyle.splitbuttonicon)),this.props.commandBarStyle.splitbuttonOverflowButton&&(e.splitbuttonOverflowButton=this._autoPopulateIButtonStyles(this.props.commandBarStyle.splitbuttonOverflowButton,this._defaultCommandBarStyle.splitbuttonOverflowButton,this._memoizedCommandBarStyle.splitbuttonOverflowButton)),this.props.commandBarStyle.list&&(e.list=this._autoPopulateListStyle(this.props.commandBarStyle.list,this._memoizedCommandBarStyle.list)),this.props.commandBarStyle.overflowFlyoutMoreButton&&(e.overflowFlyoutMoreButton=this._autoPopulateListStyle(this.props.commandBarStyle.overflowFlyoutMoreButton,this._memoizedCommandBarStyle.overflowFlyoutMoreButton)),this.props.commandBarStyle.commandBarRefreshProps&&(e.commandBarRefreshProps=this.props.commandBarStyle.commandBarRefreshProps)),this._isCommandBarStyleEqual(e,this._memoizedCommandBarStyle)||(this._memoizedCommandBarStyle=e),this._memoizedCommandBarStyle}_autoPopulateContainerStyles(t,e,o){const n=t||e;return n===o?o:n}_autoPopulateListStyles(t,e,o){const n=t||e;return n===o?o:n}_autoPopulateIButtonStyles(t,e,o){const n=t||e;return n===o?o:n}_autoPopulateFlyoutStyles(t,e,o){const n={flyoutContainerStyles:t.flyoutContainerStyles||e.flyoutContainerStyles,flyoutListItemBody:t.flyoutListItemBody||e.flyoutListItemBody,flyoutListItemStyles:t.flyoutListItemStyles||e.flyoutListItemStyles,flyoutListStyles:t.flyoutListStyles||e.flyoutListStyles,flyoutChevronStyle:t.flyoutChevronStyle||e.flyoutChevronStyle,flyoutPrimaryOfSplitButton:t.flyoutPrimaryOfSplitButton||e.flyoutPrimaryOfSplitButton,flyoutBackButtonStyle:t.flyoutBackButtonStyle||e.flyoutBackButtonStyle,flyoutBackButtonTextStyle:t.flyoutBackButtonTextStyle||e.flyoutBackButtonTextStyle};return this._isFlyoutButtonStyleEqual(n,o)?o:n}_autoPopulateButtonStyle(t,e,o){const n={button:t.button||e.button,icon:t.icon||e.icon,text:t.text||e.text,iconWrapperStyles:t.iconWrapperStyles||e.iconWrapperStyles,splitButtonChevronIconWrapper:t.splitButtonChevronIconWrapper||e.splitButtonChevronIconWrapper,flyoutButtonChevronIconWrapper:t.flyoutButtonChevronIconWrapper||e.flyoutButtonChevronIconWrapper,buttonContentWrapperStyle:t.buttonContentWrapperStyle||e.buttonContentWrapperStyle};return this._isButtonStyleEqual(n,o)?o:n}_autoPopulateListStyle(t,e){return e===t?e:t}_isCommandBarStyleEqual(t,e){return t.container===e.container&&t.flyoutStyles==t.flyoutStyles&&t.list===e.list&&t.listItem===e.listItem&&t.listItemBody===e.listItemBody&&t.moreIcon===e.moreIcon&&t.splitbuttonicon===e.splitbuttonicon}_isButtonStyleEqual(t,e){return t.button===e.button&&t.icon===e.icon&&t.text===e.text}_isFlyoutButtonStyleEqual(t,e){return t.flyoutContainerStyles===e.flyoutContainerStyles&&this._isButtonStyleEqual(t.flyoutListItemBody,e.flyoutListItemBody)&&t.flyoutListItemStyles===e.flyoutListItemStyles&&t.flyoutListStyles===e.flyoutListStyles&&t.flyoutPrimaryOfSplitButton===e.flyoutPrimaryOfSplitButton}_executeCommand(t,e,o,n,a){return function(i,r,s,d,l){return Object(g.a)(t,e,i,r,s,o,n,a,d,l)}}}Q.displayName="CommandManager";const J=Object(r.a)((function(){const t=Object(N.d)(),e=Object(u.h)();return function(o,n){const a=Object(A.j)(o,n.ribbonId),i=a&&a.initialized===C.a.Error,r=Object(F.b)(o,n),s=Object(F.c)(o,n),d=Object(B.b)(o,n.commandManagerId,n.id,n.contextToken),l=t(o,n.id,n.ribbonId,n.relationshipType,n.contextToken,n.customControlType,n.selectedRecords,n.allRecords),m=Object(I.a)(o),c=e(o,P.e),u=Object(V.g)(o),p=Object(Y.b)(o)?Object(Y.a)(o):null,h=Object(G.a)(o,n.commandManagerId),b=Object(U.a)(o),y=Object(K.a)(o)===Z.a.MultiSession;return{commandBarEnabled:m,ribbonDescriptor:a,initializeMetadataFailed:i,ruleContext:l,xrmInitialized:d,recordStateCode:r,recordStatusCode:s,resourceStrings:c,isRTL:u,designLanguage:p,initializationCompleted:h,isCommandBarRefresh:b,isMultiSessionMode:y,isInitialRuleEvaluationComplete:y&&Object(G.b)(o,n.commandManagerId),isInMobileModeForOct2019:Object(X.b)(o)}}}),(function(t,e){const o=e.contextToken?Object(q.v)(e.contextToken):null;return{storeRuleContextInState:(e,o)=>t(Object(E.a)(e,o)),initializeCommandBar:()=>t(Object(_.a)(e.ribbonId,e.commandManagerId,e.id,e.contextToken,e.relationshipType,e.selectedRecords,e.allRecords,e.customControlType,e.allowedControls,e.metaDataLoadedResolve)),initializeGlobalScriptContainer:()=>{return t((o=e.commandManagerId,{type:"commanding.initGlobalScriptContainer",execute:({dispatch:t,getState:e},n)=>o!==O.d||Object(B.a)(e(),o)||L?Promise.resolve():(L=!0,t(Object(x.a)(M.a.GLOBAL_CONTAINER_KEY,!0)).then(()=>{t(Object(x.b)(!0,o)),L=!1}))}));var o},evaluateRules:(n,a,i)=>t(Object(S.c)(n,a,e.id,e.commandManagerId||e.id,o,i)),storeRibbonIdInState:(e,o)=>t(Object(w.a)(e,o)),storeContextTokenInState:()=>t(Object(R.a)(e.contextToken,e.commandManagerId)),storeAllowListInState:(e,o)=>t(Object(T.a)(e,o)),destroyCommandBar:e=>t(Object(f.a)([e])),retrieveRibbon:e=>t(Object(j.a)(e)),setCommandManagerInitializationState:(e,o)=>t(Object(v.a)(e,o)),storeAppendedCommandList:(e,o)=>t(function(t,e){return{type:O.l,payload:e,meta:{commandManagerId:t}}}(e,o)),storeAddedCommandList:(e,o)=>t(function(t,e){return{type:O.k,payload:e,meta:{commandManagerId:t}}}(e,o))}}))(Q);var $=o("KOTC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function tt(t){return a.createElement($.a,{loader:()=>Promise.all([o.e(18),o.e(2),o.e(10),o.e(11),o.e(13),o.e(12),o.e(14),o.e(15),o.e(17),o.e(50)]).then(o.bind(null,"ry8h")).then(t=>t.CommandCheckerInterfaceRoot),props:t})}tt.displayName="CommandCheckerInterfaceHook";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const et=["CommandChecker.CommandChecker.Label"];const ot=a.memo((function(t){const[e,o]=a.useState(!1),{ribbonId:p,appendedCommandList:h}=t,b=Object(n.__rest)(t,["ribbonId","appendedCommandList"]),y=Object(r.d)(s.g),C=Object(r.d)(t=>Object(l.c)(t,d.E)),I=Object(r.d)(t=>Object(A.j)(t,p)),f=Object(c.a)(et),S=f&&Object(u.c)(f,"CommandChecker.CommandChecker.Label")||"Command checker",g=Object(r.d)(e=>Object(A.m)(e,I,t.id,t.commandManagerId,t.selectedRecords&&t.selectedRecords.length>0)),_=Object(r.d)(e=>Object(G.d)(e,t.commandManagerId)),B=Object(i.b)()+Object(r.d)(t=>Object(m.a)(t,""));if(y&&C&&I){const t=[];return h&&t.push(...h),t.push({Icon:"CommandChecker",DisplayText:S,Id:"CommandChecker",execute:()=>{o(!0)}}),a.createElement(a.Fragment,null,a.createElement(J,Object.assign({ribbonId:p,appendedCommandList:t},b)),e&&a.createElement(tt,{ribbonDescriptor:I,context:Object(N.b)(p),entityLogicalName:Object(N.a)(p),closeCommandCheckerHandler:()=>{o(!1)},buttonVisibleMap:g,ribbonRuleEvaluationResults:_,orgUrl:B}))}return a.createElement(J,Object.assign({},t))}))},VZXL:function(t,e,o){"use strict";o.d(e,"a",(function(){return n})),o.d(e,"c",(function(){return a})),o.d(e,"b",(function(){return i})),o.d(e,"d",(function(){return r})),o.d(e,"e",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n="Web.CommandBar.ErrorLoading_Message",a="Web.CommandBar.MoreCommands_ToolTip",i="Web.CommandBar.MoreCommandsForEntity_ToolTip",r="Command_Bar_Label",s=["Web.CommandBar.Loading_Message",n,a,i,r]},XA60:function(t,e,o){"use strict";o.d(e,"a",(function(){return O})),o.d(e,"b",(function(){return v}));var n=o("nuS9"),a=o("Ij+U"),i=o("YWpA"),r=o("u+q+"),s=o("gvL4"),d=o("Afz2"),l=o("3rse"),m=o("4fxQ"),c=o("o0iw"),u=o("RiHV"),p=o("iZ7K"),h=o("cUMa"),b=o("ILmX"),y=o("wgH2"),C=o("YxC/"),I=o("VZXL"),f=o("GAI+"),S=o("mpSO"),g=o("CfXY"),_=o("IqkD"),B=o("Lyxw"),M=o("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const O="Commands";let x=!1;class L extends n.Component{constructor(t){super(t),this._isGlobalComandBar=!1,this._allCommandButtonsTabable=!1,this._selectedIndex=-1,this._selectedId="",this._allControls=[],this._allRenderingMenuItems=[],this._keyboardHandler=this._keyboardHandler.bind(this),this._keyboardFocusHandler=this._keyboardFocusHandler.bind(this),this._isGlobalComandBar=t.commandManagerId.startsWith(S.d),this._allCommandButtonsTabable=this._isGlobalComandBar,this._onCommandBarMeasure=this._onCommandBarMeasure.bind(this)}_init(){this._initialized||(this._initialized=!0,this._extractButtons(this.props))}_needResetIndex(){if(this._allCommandButtonsTabable)return!1;return!!m.findDOMNode(this._commandBarItems)&&(!this._selectedId||!document.getElementById(this._selectedId))}_moveIndex(t,e=!1,o=!0){const n=m.findDOMNode(this._commandBarItems);if(!n)return;!this._allCommandButtonsTabable&&n.querySelectorAll("[tabindex='0']").forEach(t=>t.setAttribute("tabindex","-1"));let a=n.childNodes[t];if(a){if(e&&this._isSplitButton(t)){const t=a.querySelector("[aria-haspopup='true']");a=t||a}this._selectedIndex=t,this._selectedId=a.id,(o||n.contains(document.activeElement))&&a.focus(),!this._allCommandButtonsTabable&&a.setAttribute("tabindex","0")}}_isSplitButton(t){return this._allRenderingMenuItems.length>t&&this._allControls[t].ControlType===f.c}_generateControl(t){let e=f.a,o=null;return t.Children&&t.Children.length>0&&(e=t.execute?f.c:f.b,o=t.Children.map(t=>this._generateControl(t))),{Command:t.Id,Id:t.Id,DataId:t.DataId,ControlType:e,DisplayText:t.DisplayText,execute:t.execute,executeInjectedPopulationQueryCommand:t.executeInjectedPopulationQueryCommand,Icon:t.Icon,isInjectedCommand:!0,WillOpenFlyout:t.WillOpenFlyout,IsInFlyout:t.IsInFlyout,ToolTipTitle:void 0!==t.Tooltip?t.Tooltip.title:"",ToolTipDescription:void 0!==t.Tooltip?t.Tooltip.description:"",ChildInjectedControls:o,dataLPId:t.dataLPId,accessibilityExpanded:t.accessibilityExpanded,controlsElementId:t.controlsElementId,ownsElementId:t.ownsElementId}}_getLearningPathId(t){let e="commandbar-";if(t.ribbonId)e+=t.ribbonId;else if(t.commandManagerId){e+=t.commandManagerId;const o=e.indexOf(":");o>-1&&(e=e.substring(o+1))}return e}componentWillReceiveProps(t){var e,o,n;if(!0===(null===(o=null===(e=this.props)||void 0===e?void 0:e.ribbonDescriptor)||void 0===o?void 0:o.Localized)&&!0!==(null===(n=null==t?void 0:t.ribbonDescriptor)||void 0===n?void 0:n.Localized))return;const a=this._areMenuLengthPropsChanged(t,this.props)||!this._areButtonsEqualInProps(t,this.props);this._extractButtons(t,a)}_areButtonsEqualInProps(t,e){return t.menuControlMapping===e.menuControlMapping&&this._areControlListsEqual(t.addedCommandList,e.addedCommandList)&&this._areControlListsEqual(t.appendedCommandList,e.appendedCommandList)}_areControlListsEqual(t,e){return null==t||null==e?null==t&&null==e:t.length===e.length&&t.every((t,o)=>t.Id===e[o].Id&&t.DisplayText===e[o].DisplayText)}_areMenuLengthPropsChanged(t,e){return t.width!==e.width||t.iconPosition!==e.iconPosition||t.commandbarDisplayMode!==e.commandbarDisplayMode||t.mainMenuLength!==e.mainMenuLength}_extractButtons(t,e=!0){this._updateAllControls(t),this._updateRenderingMenuItems(t),e&&(this._mainMenuLength=Object(g.c)(t.width,t.commandBarStyle,this._allControls,t.iconPosition,t.isRTL,t.commandbarDisplayMode,t.mainMenuLength,t.forceUseOfMainMenuLength,x),this._allCommandButtonsTabable||(this._selectedId=void 0))}_updateAllControls(t){if(this._allControls=[],t.addedCommandList&&t.addedCommandList.forEach(t=>{this._allControls.push(this._generateControl(t))}),t.ribbonDescriptor&&t.ribbonDescriptor.Layout){let e=new Array;t.ribbonDescriptor.Layout.Tabs.Tab&&(e=e.concat(t.ribbonDescriptor.Layout.Tabs.Tab)),t.ribbonDescriptor.Layout.ContextualTabs.Tab&&(e=e.concat(t.ribbonDescriptor.Layout.ContextualTabs.Tab)),e.forEach(e=>{e&&e.Groups&&e.Groups.Group&&e.Groups.Group.forEach(e=>{e.Controls.Items.forEach(e=>{const o=e?Object(b.i)(e.Id,Object(y.a)(t.ribbonId)):null;e&&o&&t.menuControlMapping[o]&&this._allControls.push(e)})})})}t.appendedCommandList&&t.appendedCommandList.forEach(t=>{this._allControls.push(this._generateControl(t))})}_updateRenderingMenuItems(t){this._allRenderingMenuItems=[];const e=t.selectedRecords&&t.selectedRecords.length>0;this._allControls.forEach((o,n)=>{const a={RootButtonId:null,contextKey:t.contextKey,areRecordsSelected:e,isFlyoutControl:!1,commandManagerId:t.commandManagerId,control:o,iconPosition:t.iconPosition,flyoutDepth:0,commandBarStyle:t.commandBarStyle,isMainView:!0,executeCommand:t.executeCommand,ribbonId:t.ribbonId,pageId:t.pageId,commandbarDisplayMode:t.commandbarDisplayMode,updateMainViewKeyboardIndex:this._updateSelectedIndex(n),hideFlyoutButtonChevron:t.hideFlyoutButtonChevron,isCommandBarRefresh:t.isCommandBarRefresh,rootZIndex:t.rootZIndex},i=Object(c.f)(o,a,this._allRenderingMenuItems.length,this._allCommandButtonsTabable,t.entityDisplayName,t.entityDisplayCollectionName);this._allRenderingMenuItems.push(i)})}render(){this._init(),this._numberMainMenuControls=0,this._numberOverflowControls=0;const t=[],e=[];if(this._allRenderingMenuItems.forEach(t=>{e.length<this._mainMenuLength&&(e.push(t),this._numberMainMenuControls++)}),this._allControls.length>this._mainMenuLength)for(let e=this._mainMenuLength;e<this._allControls.length;e++)this._addControlToMoreMenu(this._allControls[e],t);const o=this.props.selectedRecords&&this.props.selectedRecords.length>0;if(this._numberOverflowControls>0){const i=Object(C.c)(this.props.resourceStrings,I.c),r=Object(C.c)(this.props.resourceStrings,I.b),s=this.props.entityDisplayName?String.format(r,this.props.entityDisplayName):i,d=Object(c.i)({ToolTipTitle:s,OverflowIcon:this.props.useVerticalMoreIcon?"MoreVertical":"More"},S.f),l=Object(c.e)(d,this.props.commandManagerId,this.props.contextKey),m=Object.assign({},this.props.commandBarStyle);m.listItemBody=Object.assign({},m.listItemBody),m.listItemBody.button=Object.assign(Object.assign({},m.listItemBody.button),{paddingLeft:0,paddingRight:0}),e.push(n.createElement(a.a,{contextKey:this.props.contextKey,areRecordsSelected:o,isOverflowFlyoutMoreButton:!0,commandbarDisplayMode:this.props.commandbarDisplayMode,isFlyoutControl:!1,flyoutDepth:0,commandManagerId:this.props.commandManagerId,pageId:this.props.pageId,accessibilityLabel:s,key:l,id:l,tabIndex:this._allCommandButtonsTabable?0:-1,ariaOwnsElementId:l+"_flyout",RootButtonId:l,menuItems:t,control:d,iconPosition:this.props.iconPosition,commandBarStyle:m,isMainView:!0,executeCommand:this.props.executeCommand,ribbonId:this.props.ribbonId,updateMainViewKeyboardIndex:this._updateSelectedIndex(this._numberMainMenuControls),isCommandBarRefresh:this.props.isCommandBarRefresh,rootZIndex:this.props.rootZIndex})),this._numberMainMenuControls++}return this._getMarkupOfCommandBar(e,this.props)}_onCommandBarMeasure(){const t=m.findDOMNode(this._commandBarItems);if(t){const e=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(t){if(t){const e=getComputedStyle(t),o=parseInt(e.fontSize,10),n=parseFloat(e.letterSpacing),a=parseFloat(e.wordSpacing);return n>=.12*o&&a>=.16*o}}(t);x!==e&&(x=e,this._extractButtons(this.props),this.forceUpdate())}}_getMarkupOfCommandBar(t,e){const o="$commandBarInfo"+e.commandManagerId,a="$commandBarItemsList"+e.commandManagerId;return t.length>0?n.createElement(i.a,{style:this._transformContainerStyle(e),key:o,isRequestedMeasuring:!0,onMeasuring:this._onCommandBarMeasure},n.createElement(s.a,{ref:t=>{this._commandBarItems=t,this._needResetIndex()&&this._moveIndex(0,!1,!1)},testhooks:{id:"CommandBar",[u.a.LearningPathDOMAttributeSuffix]:this._getLearningPathId(e)},accessibilityLabel:O,key:a,role:d.m,style:Object.assign(Object.assign({},e.commandBarStyle.list),{listStyleType:"none",flexShrink:"0"}),onKeyDown:this._keyboardHandler,onFocus:this._keyboardFocusHandler},t)):null}_transformContainerStyle(t){let e=t.commandBarStyle.container;return t.height&&(e=Object.assign(Object.assign({},e),{maxHeight:t.height+"px",overflowY:"auto"})),e}_addControlToMoreMenu(t,e){e.push(t),this._numberOverflowControls++}_updateSelectedIndex(t){return()=>{this._selectedIndex=t;!this._isGlobalComandBar&&this._moveIndex(t,!1,!1)}}_getBrightnessFromRGB(t,e,o){return Math.round((299*t+587*e+114*o)/1e3)}_keyboardFocusHandler(t){let e=t.target;const o=document.getElementById(e.id);if(o&&o.style){let t="";do{t=window.getComputedStyle(e).backgroundColor,e=e.parentElement}while(("rgba(0, 0, 0, 0)"===t||"transparent"===t)&&e);if(-1!==t.indexOf("rgb")){const e=t.split(/[()]+/)[1].split(",");o.style.outlineColor=this._getBrightnessFromRGB(parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10))>125?"#666666":"#FFFFFF"}}if(!this._isGlobalComandBar){const e=m.findDOMNode(this._commandBarItems),o=e&&e.children;if(o)for(let e=0;e<o.length;e++)""!==o[e].id&&o[e].id===t.target.id&&e!==this._selectedIndex&&this._moveIndex(e)}}_keyboardHandler(t){if(t.keyCode===l.a.Enter)return t.stopPropagation(),t.preventDefault(),void t.target.click();if(this._isGlobalComandBar)return;const e=!this.props.isRTL&&t.keyCode===l.a.RightArrow||this.props.isRTL&&t.keyCode===l.a.LeftArrow;!this.props.isRTL&&t.keyCode===l.a.LeftArrow||this.props.isRTL&&t.keyCode===l.a.RightArrow?this._moveIndex(j(this._selectedIndex-1,this._numberMainMenuControls),!0):e&&this._moveIndex(j(this._selectedIndex+1,this._numberMainMenuControls),!1)}}function j(t,e){return(t%e+e)%e}L.displayName="CommandBar";const v=Object(r.a)((function(){const t=Object(h.g)(),e=Object(C.h)();return function(o,n){const a=t(o,n),i=n.ribbonId?n.ribbonId.split(":"):null,r=i&&i.length>1?i[i.length-1]:null,s=Object(p.h)(o,r);return{menuControlMapping:a,entityDisplayName:s&&s.DisplayName?s.DisplayName:"",entityDisplayCollectionName:s&&s.DisplayCollectionName?s.DisplayCollectionName:"",resourceStrings:e(o,I.e),isRTL:Object(_.g)(o),useVerticalMoreIcon:Object(B.a)(o,M.ke,M.h)&&Object(c.r)("MoreVertical")}}}))(L)},nUyF:function(t,e,o){"use strict";o.d(e,"a",(function(){return a}));var n=o("M0zh");function a(t,e){const o={contextToken:t};return{type:n.n,payload:o,meta:{commandManagerId:e}}}},s308:function(t,e,o){"use strict";o.d(e,"a",(function(){return a}));var n=o("M0zh");function a(t,e){let o=null;t&&(o={},t.forEach(t=>{o[t]=!0}));const a={controlAllowList:o};return{type:n.m,payload:a,meta:{commandManagerId:e}}}},vZzn:function(t,e,o){"use strict";o.d(e,"c",(function(){return m})),o.d(e,"b",(function(){return p})),o.d(e,"a",(function(){return c}));var n=o("dHD5"),a=o("arV0"),i=o("nlPs"),r=o("mpSO"),s=o("cfbi"),d=o("UIlN"),l=o("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function m(t,e,o){const i=Object(l.a)(t,e);if(i){const r=Object(a.l)(t,e);if(r!==s.a&&"QuickCreateForm"!==r&&"ModalDialog"!==r&&"Dialog"!==r&&"Dashboard"!==r&&"Control"!==r&&"TaskBasedFlow"!==r&&r!==s.b)return i.xrmReady;{const t=Object(n.v)(o);if(i.forms&&i.forms[t])return i.forms[t].xrmReady}}return!1}function c(t,e){const o=Object(d.b)(t,e);return o&&o.createdScriptContainer}function u(t,e,o,a){const i=m(t,e,a),r=function(t,e,o){if(o){const a=Object(n.v)(o),i=Object(l.a)(t,e);return i&&i.commandXrmCache&&i.commandXrmCache[a]}return!1}(t,e,o);return o?r&&i:i}function p(t,e,o,n){if(e===r.d)return!!c(t,e);return!!u(t,o,n,Object(i.a)(t,o))}},wNQP:function(t,e,o){"use strict";o.d(e,"a",(function(){return x}));var n=o("eXjw"),a=o("DRVD"),i=o.n(a),r=o("pEXn"),s=o("dHD5"),d=o("6hHv"),l=o("nmJf"),m=o("ILmX"),c=o("Wgxh"),u=o("ddoO"),p=o("2jAf");function h(t,e){return{type:"ribbon.initialize.async",execute({dispatch:o,getState:n},a){if(t){const a=n();!function(t,e,o,n){const a=Object(m.g)();if(t!==a){const a={},i=function(t,e,o){if(!t)return null;if(o){const n=Object(u.k)(t,e),a=n&&n.slice();return Object(c.a)(a,o)}return null}(o,t,e);i&&(a[t]=i,n(Object(p.e)(null,a)))}}(t,e,a,o)}return Promise.resolve()}}}var b=o("s308"),y=o("Es1/"),C=o("nUyF"),I=o("GpAH"),f=o("GT4X"),S=o("wgH2"),g=o("mpSO"),_=o("P86a"),B=o("Me5Q"),M=o("vZzn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const O=i.a.createEvent(g.b,g.a);function x(t,e,o,a,i,c,u,p,g,x){return{type:"commanding.initCmdBar",execute({dispatch:L,getState:j},v){if(Object(f.c)(j(),e))return;if(Object(f.b)(j(),e))return void(x&&x(!0));L(Object(B.a)(_.a.Initializing,e));const T=Object(S.a)(t);if(t&&""!==t&&T&&"undefined"!==T){const f={};f[r.b.CommandingParameters.CommandManagerId]=e||o||"null",f[r.b.CommandingParameters.RibbonId]=t||"null",f[r.b.CommandingParameters.ContextKey]=a?Object(s.v)(a):"null";const _=O.startStopwatch(f);return function(t,e,o){const n=Object(m.j)(e,o);if(o&&(!n||!n.initialized||!n.Localized))return t(Object(l.a)(o));return Promise.resolve()}(L,j(),t).then(()=>{const r=Object(M.b)(j(),e,o,a),l=Object(S.d)()(j(),o,t,i,a,p,c,u),f=Object(m.j)(j(),t);if(r&&l&&f&&f.initialized!==n.a.Error&&f.Commands&&f.Localized){const n=a?Object(s.v)(a):null;return L(h(t,o)),L(Object(b.a)(g,e)),L(Object(y.a)(l,e||o)),L(Object(I.a)(t,e||o)),L(Object(C.a)(a,e)),L(Object(d.c)(f,l,o,e||o,n,!1)).then(()=>{x&&x(!0),_()})}})}L(Object(B.a)(_.a.SkippedRuleEvaluation,e))}}}}}]),window.bundleExecutionMarkers["scripts/7.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();