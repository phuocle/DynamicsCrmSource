(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/taskbasedflowmenu.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[104],{uGSb:function(e,t,s){"use strict";s.r(t),s.d(t,"TaskBasedFlowMenu",(function(){return R}));var n=s("nuS9"),o=s("1AYO"),i=s("eXjw"),r=s("YWpA"),a=s("evW+"),l=s("Afz2"),d=s("u+q+"),u=s("sw/s"),p=s("uTTW"),c=s("H/hG"),m=s("ZFkP"),h=s("RiHV"),y=s("Smta");class b extends n.Component{constructor(e){super(e),this._wasClicked=!1,this._onMenuItemClick=this._onMenuItemClick.bind(this)}_onMenuItemClick(e){this._wasClicked||(this._wasClicked=!0,this.props.toggleMenu(),this.props.openTaskBasedFlowPage(this.props.primaryModelName,this.props.uniqueName))}render(){const e=this.props.id+"_displayImage";let t=null;this.props.imageUrl&&(t=n.createElement(p.a,{style:this.props.style.imageStyle,testhooks:{id:e},id:e,key:e,source:this.props.imageUrl,altText:this.props.displayName,role:l.r}));const s=this.props.id+"_body",o=this.props.id+"_displayName",i=this.props.id+"_description",d="tbxmenuitem|"+this.props.uniqueName,u=this.props.id+"tbxMenuItemContainer",m=this.props.id+"tbxMenuItemBlackBackground",b=(this.props.headerLabelId?this.props.headerLabelId+" ":"")+i;return n.createElement(y.a,{id:u,key:u,style:this.props.itemContainerStyle,onClick:this._onMenuItemClick,tabIndex:-1,role:l.n,accessibilityLabel:this.props.displayName,describedByElementId:b},n.createElement(a.a,{testhooks:{id:this.props.id,[h.a.LearningPathDOMAttributeSuffix]:d},id:this.props.id,key:this.props.id,role:l.r,style:this.props.style.buttonStyle,tabIndex:-1},n.createElement(r.a,{testhooks:{id:s},id:s,key:s,role:l.r,style:this.props.style.itemBodyStyle,tabIndex:-1},t,n.createElement(r.a,{id:m,key:m,style:this.props.style.blackBackgroundStyle,role:l.r}),n.createElement(c.a,{testhooks:{id:o},id:o,key:o,style:this.props.style.titleStyle},this.props.displayName),n.createElement(c.a,{testhooks:{id:i},id:i,key:i,style:this.props.style.descriptionStyle,tabIndex:-1},this.props.description))))}}const g=Object(d.a)((function(e,t){const{displayName:s,imageUrl:n,primaryModelName:o,description:i}=Object(u.a)(e,t.uniqueName);return{displayName:s,imageUrl:n,primaryModelName:o,description:i}}),(function(e){return{openTaskBasedFlowPage:(t,s,n)=>{e(Object(m.a)(t,s,n,null,void 0))}}}))(b);var M=s("QBtP"),f=s("Fn5S"),C=s("YxC/"),k=s("WePp");class w extends k.a{constructor(e){super("uci_taskflow_menu_opened"),this.addEventParameter("EventTime",new Date),this.addEventParameter("NumberOfTaskFlows",e)}}var _=s("znb3"),x=s("XIN1"),S=s("IqkD"),B=s("b8TU"),I=s("unFF");var v=s("4fxQ"),F=s("gvL4"),T=s("3rse");var E=s("69Qu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const O=["TaskBasedFlow_Menu_Loading_Text","TaskBasedFlow_Menu_Empty_Text","Button_Cancel","TaskBasedFlow_Menu_Header_Text","Mobile_TaskBasedFlow_AppLauncher_Offline","TaskBasedFlow_Lookup_Label","TaskBasedFlow_Button_Next"];class j extends n.Component{constructor(e){super(e),this._onCloseHandler=this._onCloseHandler.bind(this),this._onKeyboardPress=this._onKeyboardPress.bind(this),this._onCancelButtonKeyDown=this._onCancelButtonKeyDown.bind(this),this._setInitialFocus=this._setInitialFocus.bind(this),this._setInitialFocusCancelButton=this._setInitialFocusCancelButton.bind(this),this._selectedMenuItemIndex=-1}_renderCancelButton(){let e=null;return this.props.isMobileMode&&(e=n.createElement(a.a,{id:"tbxMenuCancel",testhooks:{id:"tbxMenuCancel"},ref:this._setInitialFocusCancelButton,key:"tbxMenuCancel",onClick:()=>this.props.toggleMenu(),accessibilityLabel:Object(C.c)(this.props.resourceStrings,"Button_Cancel"),style:this.props.cancelButtonStyle,onKeyDown:this._onCancelButtonKeyDown},n.createElement(x.b,{type:_.a.Cancel,style:this.props.cancelButtonIconStyle}))),e}componentDidMount(){if(this.props.isMenuOpened){const e=this.context;if(e){const t=this.props.taskBasedFlowNames?this.props.taskBasedFlowNames.length:0,s=new w(t);e.EventManager.ReportEvent(s)}document.addEventListener("keydown",this._onCloseHandler)}}_moveIndex(e){const t=v.findDOMNode(this._menuItems);if(t&&t.childNodes){const s=t.childNodes[e];s.tabIndex=0,s.focus()}}_setInitialFocus(e){this._menuItems=e;let t=null;if(e){const e=v.findDOMNode(this._menuItems);e&&requestAnimationFrame(()=>{t=e.firstChild,t&&(t.focus(),this._selectedMenuItemIndex=0)})}}_setInitialFocusCancelButton(){this._taskBasedFlowsAvailable()||requestAnimationFrame(()=>{const e=document.getElementById("tbxMenuCancel");e&&e.focus()})}_onKeyboardPress(e){if(e.keyCode===T.a.Enter)e.stopPropagation(),e.preventDefault(),e.target&&e.target.click();else if(e.keyCode===T.a.UpArrow){e.stopPropagation(),e.preventDefault();const t=0===this._selectedMenuItemIndex?this.props.taskBasedFlowNames.length-1:this._selectedMenuItemIndex-1;this._selectedMenuItemIndex=t,this._moveIndex(t)}else if(e.keyCode===T.a.DownArrow){e.stopPropagation(),e.preventDefault();const t=this._selectedMenuItemIndex===this.props.taskBasedFlowNames.length-1?0:this._selectedMenuItemIndex+1;this._selectedMenuItemIndex=t,this._moveIndex(t)}else if(e.keyCode===T.a.Tab){e.stopPropagation(),e.preventDefault();const t=document.getElementById("tbxMenuCancel");t&&t.focus()}}_onCancelButtonKeyDown(e){if(e)if(e.keyCode===T.a.Tab){if(e.stopPropagation(),e.preventDefault(),!this._taskBasedFlowsAvailable())return;this._moveIndex(this._selectedMenuItemIndex)}else e.keyCode===T.a.Enter&&(e.stopPropagation(),e.preventDefault(),e.target&&e.target.click(),this._focusParentButton())}_onCloseHandler(e){if(e.keyCode===T.a.Escape||e.keyCode===T.a.LeftArrow||e.keyCode===T.a.RightArrow){if(!this.props.isMenuOpened)return;e.stopImmediatePropagation(),this.props.toggleMenu(),this._focusParentButton()}}_focusParentButton(){const e=document.getElementById(this.props.parentElementId);null!=e&&e.focus()}_addAriaAttributesForParentElement(){const e=document.getElementById(this.props.parentElementId);null!=e&&(e.setAttribute("aria-owns","taskBasedMenuContainer"),e.setAttribute("aria-controls","taskBasedMenuContainer"))}_removeAriaAttributesForParentElement(){const e=document.getElementById(this.props.parentElementId);null!=e&&(e.hasAttribute("aria-owns")&&e.removeAttribute("aria-owns"),e.hasAttribute("aria-controls")&&e.removeAttribute("aria-controls"))}_taskBasedFlowsAvailable(){return!this.props.isOffline&&this.props.taskBasedFlowNames&&this.props.taskBasedFlowNames.length>0}_getMenuList(){const e=[];for(let t=0;t<this.props.taskBasedFlowNames.length;t++){const s=this.props.taskBasedFlowNames[t],o="taskBasedFlowMenuItem-"+s;let i=this.props.itemStyle.itemContainer;0===t?i=this.props.itemStyle.firstItemContainer:t===this.props.taskBasedFlowNames.length-1&&(i=this.props.itemStyle.lastItemContainer),e.push(n.createElement(g,{id:o,key:s,uniqueName:s,toggleMenu:this.props.toggleMenu,style:this.props.itemStyle,itemContainerStyle:i,headerLabelId:"tbxMenuHeader"}))}return n.createElement(F.a,{id:"tbxMenuContentContainer",key:"tbxMenuContentContainer",ref:this._setInitialFocus,style:this.props.menuContentContainerStyle,role:l.l,onKeyDown:this._onKeyboardPress,accessibilityLabel:Object(C.c)(this.props.resourceStrings,"TaskBasedFlow_Menu_Header_Text")},e)}render(){let e;if(this._taskBasedFlowsAvailable())e=this._getMenuList();else{let t;t=this.props.isOffline?Object(C.c)(this.props.resourceStrings,"Mobile_TaskBasedFlow_AppLauncher_Offline"):this.props.taskBasedFlowMenuStatus===i.a.Initialized?Object(C.c)(this.props.resourceStrings,"TaskBasedFlow_Menu_Empty_Text"):Object(C.c)(this.props.resourceStrings,"TaskBasedFlow_Menu_Loading_Text"),e=n.createElement(r.a,{id:"tbxMenuContentContainer",key:"tbxMenuContentContainer",role:l.r,style:this.props.messageContainerStyle},n.createElement(c.a,{testhooks:{id:"tbx-menu-status"},key:"tbx-menu-status",id:"tbx-menu-status",accessibilityLive:"assertive",role:l.a,semanticTag:"p",onKeyDown:this._onKeyboardPress,style:this.props.messageTextStyle},t))}this._addAriaAttributesForParentElement();const t=Object(C.c)(this.props.resourceStrings,"TaskBasedFlow_Menu_Header_Text");return n.createElement(r.a,{testhooks:{id:"taskBasedMenuContainer"},key:"taskBasedMenuContainer",id:"taskBasedMenuContainer",style:this.props.menuContainerStyle,labelledByElementId:"tbxMenuHeader",role:l.r},n.createElement(r.a,{id:"tbxMenuHeaderContainer",key:"tbxMenuHeaderContainer",style:this.props.menuHeaderContainerStyle,role:l.r},n.createElement(r.a,{id:"tbxMenuHeaderContentContainer",key:"tbxMenuHeaderContentContainer",style:this.props.menuHeaderContentContainerStyle,role:l.r},n.createElement(c.a,{id:"tbxMenuHeader",key:"tbxMenuHeader",style:this.props.headerStyle,role:l.i},t),this._renderCancelButton())),e)}componentWillUnmount(){document.removeEventListener("keydown",this._onCloseHandler),this._removeAriaAttributesForParentElement()}}j.contextType=M.a;const D=Object(d.a)((function(){const e=Object(C.h)(),t=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e=null,t=null,s=!1,n=null,o=!1;const i={":focus":{outlineOffset:"1px !important"}};return function(r,a){const l=Object(I.a)(r),d=Object(S.g)(r),u=Object(B.b)(r);if(t!==l||s!==d||n!==u||o!==a.isMobileMode){t=l,s=d,n=u,o=a.isMobileMode;const r={marginBottom:l.sizes.Measures.Measure025,minHeight:"6.3em",marginLeft:l.sizes.Measures.Measure100,marginRight:l.sizes.Measures.Measure100},p=Object.assign(Object.assign({},r),i),c=Object.assign(Object.assign({},p),{marginTop:"2px"}),m=Object.assign(Object.assign({},p),{marginBottom:"0px"});e={menuContainerStyle:{flexDirection:"column",backgroundColor:l.colors.WhiteBackground,width:a.isMobileMode?"100%":"28.6rem",height:a.isMobileMode?"100%":void 0,maxHeight:a.isMobileMode?void 0:.8*u+"px",justifyContent:"flex-start",borderStyle:l.display.SolidBorderStyle,borderWidth:"1px",borderColor:"transparent"},menuContentContainerStyle:{listStyleType:"none",flexDirection:"column",overflowY:"auto",marginTop:l.sizes.Measures.Measure100,marginBottom:l.sizes.Measures.Measure100},menuHeaderContainerStyle:{display:"flex",flexDirection:"column",minHeight:l.sizes.Measures.Measure225,backgroundColor:"white",paddingTop:l.sizes.Measures.Measure050,paddingBottom:l.sizes.Measures.Measure050,justifyContent:"center"},menuHeaderContentContainerStyle:{display:"flex",flexDirection:"row",justifyContent:"space-between"},headerStyle:{textOverflow:"ellipsis",overflow:"hidden",color:l.colors.BaseColor.Grey.Grey7,fontSize:l.fontSizes.Font100,fontFamily:l.fontFamilies.Semibold,marginLeft:d?void 0:l.sizes.Measures.Measure150,marginRight:d?l.sizes.Measures.Measure150:void 0,alignSelf:"center"},cancelButtonStyle:{borderStyle:"none",backgroundColor:"transparent",cursor:"pointer",minWidth:"2em",height:"2em",opacity:1,marginRight:d?void 0:l.sizes.Measures.Measure100,marginLeft:d?l.sizes.Measures.Measure100:void 0},cancelButtonIconStyle:{color:l.colors.BaseColor.Grey.Grey6,backgroundColor:"transparent",fontSize:l.fontSizes.TextBox.FontIcon},messageTextStyle:{textAlign:"center",fontSize:l.fontSizes.Font100,fontFamily:l.fontFamilies.Regular,color:l.colors.BaseColor.Grey.Grey7},messageContainerStyle:{display:"flex",justifyContent:"center",flexDirection:"column",marginTop:l.sizes.Measures.Measure100,marginBottom:l.sizes.Measures.Measure100},itemStyle:{itemContainer:p,firstItemContainer:c,lastItemContainer:m,buttonStyle:{padding:"1rem",width:"100%",borderStyle:l.display.SolidBorderStyle,borderColor:"transparent",borderWidth:"1px",justifyContent:"center",position:"relative",overflow:"hidden",cursor:"pointer"},itemBodyStyle:{display:"flex",flexDirection:"column",width:"100%"},imageStyle:{position:"absolute",top:0,left:0,width:"100%",height:"auto",marginTop:"-28%",filter:"blur(6px)"},blackBackgroundStyle:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"black",opacity:.65},titleStyle:{position:"relative",width:"100%",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",fontSize:l.fontSizes.Font100,fontFamily:l.fontFamilies.Semibold,lineHeight:"1.4rem",color:"white",textAlign:d?"right":"left"},descriptionStyle:{position:"relative",textOverflow:"ellipsis",overflow:"hidden",fontSize:l.fontSizes.Font100,fontFamily:l.fontFamilies.Regular,color:"white",height:"2.8rem",lineHeight:"1.4rem",textAlign:d?"right":"left"}}}}return e}}();return function(s,n){const o=t(s,n),i=e(s,O),r=Object(f.a)(s),a=!Object(E.b)(s);return{taskBasedFlowNames:r?r.taskBasedFlowUniqueNames:[],taskBasedFlowMenuStatus:r?r.initialized:null,resourceStrings:i,menuContainerStyle:o.menuContainerStyle,menuContentContainerStyle:o.menuContentContainerStyle,menuHeaderContainerStyle:o.menuHeaderContainerStyle,menuHeaderContentContainerStyle:o.menuHeaderContentContainerStyle,headerStyle:o.headerStyle,cancelButtonStyle:o.cancelButtonStyle,cancelButtonIconStyle:o.cancelButtonIconStyle,messageTextStyle:o.messageTextStyle,messageContainerStyle:o.messageContainerStyle,itemStyle:o.itemStyle,isOffline:a}}}))(j);var H=s("htFu"),A=s("LzVy"),N=s("sclX"),z=s("EY5k");class P extends n.Component{componentDidMount(){this.props.retrieveTbxMenuResourceStrings(),this.props.retrieveTaskBasedFlowGlobalMenu()}toggleFlyout(e){this._isTBXMenuButtonClick(e)||this.props.toggleFlyoutDisplay(!1)}_isTBXMenuButtonClick(e){if(e){let t=e.target;do{if(t.id===this.props.relativeToDomId)return!0;t=t.parentElement}while(t)}return!1}render(){return n.createElement(o.a,{id:"tbxMenu",key:"tbxMenu",groupId:"tbxMenu",relativeToElementId:this.props.isMobileMode?void 0:this.props.relativeToDomId,positionType:this.props.isMobileMode?"absolute":"relative",position:this.props.isMobileMode?{left:0,top:0}:void 0,size:this.props.isMobileMode?{width:this.props.flyoutWidth,height:this.props.flyoutHeight}:void 0,flyoutDirection:this.props.platformType===N.b.Native?o.b.down:this.props.isMobileMode?void 0:this.props.isRTL?o.b.down:o.b.downleft,onOutsideClick:e=>this.toggleFlyout(e),parentFlyoutRoot:"__flyoutRootNode",flyoutStyle:{boxShadow:this.props.theme.shadows.Shadow01}},n.createElement(D,{isMobileMode:this.props.isMobileMode,isMenuOpened:!0,toggleMenu:this.toggleFlyout.bind(this),parentElementId:this.props.relativeToDomId}))}}function L(e,t){return t&&e&&e.sizes.Breakpoints.DimensionS&&t.deviceWidth<e.sizes.Breakpoints.DimensionS}const R=Object(d.a)((function(e){const t=Object(I.a)(e),s=Object(B.a)(e);return{isMobileMode:L(t,s),flyoutHeight:s.deviceHeight,flyoutWidth:s.deviceWidth,platformType:Object(A.a)(e),isRTL:Object(S.g)(e),theme:t}}),(function(e){return{toggleFlyoutDisplay:t=>{e(Object(H.d)(t))},retrieveTbxMenuResourceStrings:()=>{e(Object(z.e)(O))},retrieveTaskBasedFlowGlobalMenu:()=>{e(Object(H.c)())}}}))(P)}}]),window.bundleExecutionMarkers["scripts/taskbasedflowmenu.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();