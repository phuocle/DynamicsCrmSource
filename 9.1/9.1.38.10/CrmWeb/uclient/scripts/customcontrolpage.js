(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/customcontrolpage.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[54],{"+Ljw":function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return l}));var r=n("SAYH"),a=n("jq7Z"),i=n("arV0"),s=n("y60j");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(t,e,n=!1){var r;const{entityTypeName:o}=Object(i.g)(t,e),c=Object(s.n)(t,o);if(!n)return c;const l=Object(a.a)(t,e),u=null===(r=null==l?void 0:l.formSelector)||void 0===r?void 0:r.forms;let d=c;if(u&&Object.keys(u).length>0){d=new Object;for(const t in c)u[t]&&!u[t].visible||(d[t]=c[t])}return d}function c(t,e,n){var o,c;const l=Object(a.a)(t,e),u=r.a.toString(n);if(null===(c=null===(o=null==l?void 0:l.formSelector)||void 0===o?void 0:o.forms)||void 0===c?void 0:c[u])return l.formSelector.forms[u].visible;const{entityTypeName:d}=Object(i.g)(t,e);return!!Object(s.m)(t,d,n)||null}function l(t,e){var n;const r=Object(a.a)(t,e);return null===(n=null==r?void 0:r.formSelector)||void 0===n?void 0:n.selectedFormId}},"+Vem":function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="form.referenceinformationbyrelationship";function a(t,e){return{type:r,payload:e,meta:{pageId:t}}}},"+aj2":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return a}));var r=n("bq0x");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="quickCreateForm.output";function i(t,e){return{type:"quickCreateForm.output.async",execute({dispatch:n,getState:i}){const s=Object(r.a)(i(),t)||[];return s.push(e),n(function(t,e){return{type:a,payload:{reason:"close",value:e},meta:{pageId:t}}}(t,s)),Promise.resolve(t)}}}},"/5se":function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="controls.DefaultView";function i(t,e,n,i){const s=Object(r.v)(n);return{type:a,payload:i.guid,meta:{pageId:t,controlName:e,contextKey:s}}}},"/q/W":function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var r=n("SoKF"),a=n("RrRQ"),i=n("i1f0"),s=n("4UCL"),o=n("zmL5"),c=n("dHD5"),l=n("bT7G"),u=n("jTSi"),d=n("O7zD");function p(t){return{type:"handle.unsaved.changes.async",execute:({dispatch:e,getState:n},p,h)=>e(Object(r.a)(t)).then(r=>{if(r){const r=Object(o.a)(n(),t),p=r.map(t=>Object(c.j)(n(),t));for(let t=0;t<r.length;t++){const o=r[t],c=p[t],h=Object(i.ac)(n(),o,c),g=Object(l.b)(n(),h),m=(null==g?void 0:g.activeChanges)?Object.keys(g.activeChanges):[];for(const t of m)e(Object(u.b)(c,o,Object(d.d)(o,t)));e(Object(a.c)(o,h,c)),e(Object(s.d)(o,c))}return!0}return!1})}}},"/q65":function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="attribute.targets.set";function i(t,e,n,i){const s=Object(r.x)(e);return{type:a,payload:i,meta:{pageId:t,contextKey:s,dataFieldName:n}}}},"0L4T":function(t,e,n){"use strict";n.d(e,"c",(function(){return d})),n.d(e,"a",(function(){return p})),n.d(e,"b",(function(){return h}));var r=n("j2fa"),a=n("YxC/"),i=n("GEBM"),s=n("z8iZ"),o=n("DAWX"),c=n("3/02"),l=n("Lyxw"),u=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function d(t,e,n,r,s){let o=null;if(o=Object(a.b)(t,i.q),"function"==typeof n.get_ErrorCode)switch(n.get_ErrorCode()){case-2147093999:o=Object(a.b)(t,i.r);break;case-2147220960:o=Object(a.b)(t,i.o);break;case-2147164125:o=Object(a.b)(t,i.a);break;case-2147164130:case-2147164126:o=Object(a.b)(t,i.j);break;case-2147217149:o=Object(a.b)(t,i.i);break;case-2147217098:o=Object(a.b)(t,i.x);break;case-2147220969:case-2147187962:o=Object(a.b)(t,i.p);break;default:n.get_Message()&&(o=o+" "+n.get_Message())}p(t,e,o,r,s)}function p(t,e,n,a,i){let d=null;d=function(t){const e=Object(s.a)();return e.ErrorInformation=new o.a,e.ErrorInformation.set_ErrorDescription(t),e}(n),Object(l.c)(t,c.rd)?(e(Object(r.a)(a.getStorageKey(),d)),Object(r.e)(t,e,a.getStorageKey(),i)):(e(Object(r.c)(u.a.toString(a.visualizationId)||u.a.EMPTYGUIDSTRING,u.a.toString(a.viewId)||u.a.EMPTYGUIDSTRING,d)),Object(r.d)(t,e,u.a.toString(a.visualizationId)||u.a.EMPTYGUIDSTRING,u.a.toString(a.viewId)||u.a.EMPTYGUIDSTRING,i))}function h(t,e,n,r,s,o){p(e,n,-2147220960===t?Object(a.b)(e,i.o):r,s,o)}},"0PSL":function(t,e,n){"use strict";n.d(e,"a",(function(){return O}));var r,a=n("SAYH"),i=n("hvSt");!function(t){t[t.Active=0]="Active",t[t.Inactive=1]="Inactive",t[t.Completed=2]="Completed"}(r||(r={}));var s=n("CPoS"),o=n("xMtD"),c=n("odYE"),l=n("VnpK"),u=n("S2mk"),d=n("LbMF"),p=n("+nNZ"),h=n("i1f0"),g=n("dHD5"),m=n("iZ7K"),b=n("504W"),f=n("Lyxw"),y=n("9fGf"),v=n("arV0"),_=n("WRF3"),S=n("fU7K");class O{constructor(t,e,n){this._memorizedExtraFilters=[],this._getState=t,this._businessProcessFlowWrapperIdentifierFactory=e,this._context=n}generate(t,e){return e?this._getBusinessProcessFlowWrapper(t,e):null}_getBusinessProcessFlowWrapper(t,e){const n=this._getState(),r=this._businessProcessFlowWrapperIdentifierFactory.generate(t,e);if(!r||!e||!e.getProcessId())return null;const i=e.getCurrentFormEntity(),c=Object(v.g)(n,t);this._navigationEntities=e.getNavigationEntities();const l=Object(p.f)(n,i);return{id:e.getProcessId(),instanceId:e.getProcessInstanceId(),name:Object(s.c)(n,e.getProcessId()),bpfEntityLogicalName:e.getBpfEntityLogicalName(),stages:this._getStages(r.data.activePath,r.activeStageId,r.data.selectedStageId,t,e),relationships:Object(o.e)(this._getState(),e.getProcessId()),activeStageId:r.activeStageId,selectedStageId:r.data.selectedStageId,activePath:r.data.activePath,displayState:r.displayState,currentEntity:new _.a(i.etn,a.a.toLegacyGuid(i.id)),processState:e.getProcessState(),state:e.getState(),status:e.getStatus(),statusName:e.getStatusName(),isFormInactive:Object(h.Lb)(n,c.entityTypeName,c.id),delegates:this._getActions(e),isVisible:e.isVisible(),actionLogs:r.data.actionLogCollection,instanceModifiedTimestamp:l,instanceName:e.getProcessInstanceName(),isCustomControlsPresent:e.getCustomControlIndicator(),isRenderedFromFormXml:e.getFormXmlRenderingIndicator(),isImmersiveBPF:e.isImmersiveBPF()}}_getStages(t,e,n,r,i){if(!t||0===t.length)return null;const s={},o=[];return t.forEach((t,c)=>{s[t.guid]=c;const l=a.a.equals(t,n),u=this._getStageWrapper(t,l,e,s,r,i);u&&o.push(u)}),o}_getStageWrapper(t,e,n,r,i,s){const c=Object(o.c)(this._getState(),s.getProcessId(),t);if(!c)return null;let l=e&&this._getSteps(c,i,s)||[];if(Object(f.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){const t="BusinessProcessFlow.CustomControlConfiguration",e=this._context.TraceManager.getTracer(t),n=Object(o.a)(this._getState(),s.getProcessId(),e);if(!Object(b.a)(n)&&!Object(b.a)(n.ControlConfigurations)){const r=s.getTelemetryParams();if(r.push({name:"BPFEntityFormId",value:n.Id.guid},{name:"BPFEntityFormType",value:n.FormType}),Object(b.a)(n.ControlConfigurations)||r.push({name:"CustomControls",value:Object.keys(n.ControlConfigurations).length}),s.isBpfFormDescriptorValid(this._getState(),s.getProcessId(),n,e))try{if(!Object(b.a)(n.ControlConfigurations)){const u=Object(o.b)(n,e),d=n.ControlConfigurations,p=this._getNonDefaultControlConfiguration(d);if(Object(f.c)(this._getState(),"FCB.EnableBPFCCPhase3")){const e=this._buildStepsFromFormXml(c,n,p,r,i,s);e&&e.length>0&&(l=e,s.setFormXmlRenderingIndicator(!0),this._context.EventManager.ReportComponentSuccess(t,r))}else Object(b.a)(u)||Object.keys(u).forEach(n=>{if(u[n].ParentCellId){const i=new a.a(u[n].ParentCellId);if((c&&c.stage&&c.stage.steps?c.stage.steps.map(t=>t.stepId.guid).indexOf(i.guid):-1)>=0&&i){const o=[];o.push({name:"StepId",value:i.guid},{name:"NonDefaultControlUniqueId",value:u[n].UniqueId}),e.info("Non-default control found for step",o);let d=null;p&&u[n].UniqueId&&(s.setFormXmlRenderingIndicator(!0),d=p[u[n].UniqueId]?p[u[n].UniqueId]:null);const h={attributeName:u[n].DataFieldName,isRequired:this._getIsStepRequired(i.guid,c),name:u[n].Label,stepId:new a.a(i.guid),stepType:"field",attributeType:this._getMetadataTypeByAttribute(c.entityLogicalName,u[n].DataFieldName),controlName:"header_process_"+u[n].Label,isVisible:u[n].Visible,isControlDisabled:u[n].Disabled,nonDefaultConfiguration:d};l.push(h),Object(b.a)(h.stepId.guid)||h.stepId.guid===a.a.EMPTY.guid||r.push({name:"StepId",value:h.stepId.guid}),r.push({name:"AttributeName",value:h.attributeName},{name:"AttributeType",value:h.attributeType},{name:"IsRequired",value:h.isRequired},{name:"NonDefaultControlUniqueId",value:u[n].UniqueId}),Object(b.a)(d)?this._context.EventManager.ReportComponentFailure(t,new Error("CustomControlConfiguration is null or undefined even though the BPF entity form XML is valid and contains non-default custom control descriptors"),null,r):(s.setCustomControlIndicator(!0),r.push({name:"CustomControlId",value:d.CustomControlId}),!Object(b.a)(d.Name)&&d.Name.indexOf("MscrmControls")>=0&&r.push({name:"CustomControlName",value:d.Name}),this._context.EventManager.ReportComponentSuccess(t,r))}}})}}catch(n){e.error(`Message: ${n.message}, Stack: ${n.stack}`,r),this._context.EventManager.ReportComponentFailure(t,n,null,r)}else this._context.EventManager.ReportComponentFailure(t,new Error("Invalid FormXML - Fallback invoked"),null,r)}}return{id:c.stage.stageId,name:c.stage.stageDisplayName,entityName:c.entityLogicalName,entityDisplayName:Object(m.f)(this._getState(),c.entityLogicalName)||c.entityDisplayName,relatedEntityReference:this._getRelatedEntityReference(c.entityLogicalName),referencingAttributeName:c.referencingAttributeName,status:this._getStageStatus(r[t.guid],r[n.guid],s),steps:l}}_buildStepsFromFormXml(t,e,n,r,i,s){const o=[],c=e.Controls;return!Object(b.a)(c)&&this._areStepsValid(t,e,r)&&Object.keys(c).forEach(l=>{if(!Object(b.a)(c[l])&&c[l].ParentCellId){const u=new a.a(c[l].ParentCellId),d=e.Tabs.find(t=>t.Id===c[l].ParentTabId);if(d&&!Object(b.a)(d.RawTabId)&&t.stage.stageId.guid===new a.a(d.RawTabId).guid){let d=null;n&&c[l].UniqueId!==a.a.EMPTY.guid&&(d=n[c[l].UniqueId]?n[c[l].UniqueId]:null);const p=this._retrieveControlName(c[l],t.stage.steps),g=this._getUIControl(i,p),m={attributeName:c[l].DataFieldName,isRequired:c[l].IsRequired,name:this._retrieveStepLabel(c[l],g,t.stage.steps),stepId:new a.a(u.guid),stepType:this._getStepTypeFromControlKey(l),attributeType:this._getMetadataTypeByAttribute(t.entityLogicalName,c[l].DataFieldName),controlName:p,isVisible:g&&!Object(b.a)(g.visible)?g.visible:c[l].Visible,isControlDisabled:c[l].Disabled||Object(h.t)(this._getState(),{id:i,controlName:p},s.getContextToken()),viewId:g&&g.parameters&&g.parameters.defaultviewid?g.parameters.defaultviewid:null,nonDefaultConfiguration:Object(b.a)(d)?null:d};m.config=this._getConfig(e,s,c[l],i,r),m.viewId&&m.config&&m.config.Parameters&&m.config.Parameters.value&&(m.config.Parameters.value.ViewId=m.viewId,g&&g.customFilter&&g.customFilter.length>0&&(this._applyLookupFilter(m,g),m.config.Parameters.value.ExtraFilters=m.extraFilters)),o.push(m),r.push({name:"StepId",value:m.stepId.guid},{name:"AttributeName",value:m.attributeName},{name:"AttributeType",value:m.attributeType},{name:"IsRequired",value:m.isRequired},{name:"NonDefaultControlUniqueId",value:c[l].UniqueId}),Object(b.a)(d)||c[l].UniqueId===a.a.EMPTY.guid||(s.setCustomControlIndicator(!0),r.push({name:"CustomControlId",value:d.CustomControlId}),!Object(b.a)(d.Name)&&d.Name.indexOf("MscrmControls")>=0&&r.push({name:"CustomControlName",value:d.Name}))}}}),o}_areStepsValid(t,e,n){if(!(Object(b.a)(e)||Object(b.a)(t)||Object(b.a)(t.stage)||Object(b.a)(t.stage.stageId))){const r=e.Controls,i=t.stage.stageId.guid.toLowerCase(),s=t.stage.steps,o=[];if(!Object(b.a)(r)){if(Object.keys(r).forEach(t=>{if(!Object(b.a)(r[t].ParentCellId)){const n=new a.a(r[t].ParentCellId).guid.toLowerCase(),s=e.Tabs.find(e=>e.Id===r[t].ParentTabId);if(!Object(b.a)(s)&&!Object(b.a)(s.RawTabId)){const t=new a.a(s.RawTabId).guid.toLowerCase();i===t&&o.indexOf(n)<0&&o.push(n)}}}),s.length!==o.length)return n.push({name:"StepFallback",value:"No. of steps in BPF stage don't match no. of cells in corresponding tab"},{name:"BPFStageStepCount",value:s.length},{name:"TabCellCount",value:o.length}),!1;for(let t=0;t<s.length;t++)if(o.indexOf(s[t].stepId.guid.toLowerCase())<0)return n.push({name:"StepFallback",value:"BPF stage stepId does not match corresponding tab's cellId"},{name:"MissingBPFStepId",value:s[t].stepId.guid.toLowerCase()}),!1;return!0}}return!1}_retrieveStepLabel(t,e,n){if(!Object(b.a)(e)&&!Object(b.a)(e.label)&&""!==e.label)return e.label;if(!Object(b.a)(t.Label)&&""!==t.Label)return t.Label;if(!Object(b.a)(n)&&n.length>0)for(const e of n)if(e.stepId.guid===new a.a(t.ParentCellId).guid&&!Object(b.a)(e.label)&&""!==e.label)return e.label;return""}_retrieveControlName(t,e){if(!Object(b.a)(e)&&e.length>0)for(const n of e)if(n.stepId.guid===new a.a(t.ParentCellId).guid&&!Object(b.b)(n.controlName))return n.controlName;return Object(b.a)(t.DataFieldName)||""===t.DataFieldName?"":"header_process_"+t.DataFieldName}_getConfig(t,e,n,r,a){try{const i=Object(h.h)(),s=t&&t.Id,o=e.getCurrentFormEntity();a.push({name:"ControlDescriptorName",value:n&&n.Name});const c=i(this._getState(),n,r,s,o&&o.name,!1);return a.push({name:"CCFControlConfigID",value:c&&c.CustomControlId},{name:"CCFControlConfigName",value:c&&c.Name},{name:"CCFControlConfigParams",value:c&&c.Parameters&&Object.keys(c.Parameters).join(",")}),c}catch(t){a.push({name:"CCFControlConfigError",value:t})}return null}_getStageStatus(t,e,n){if(null==e||t<e)return r.Completed;if(t===e){return n.getStatus()===i.a.Finished?r.Completed:r.Active}return r.Inactive}_getSteps(t,e,n){const r=[];if(!t.stage||!t.stage.steps||0===t.stage.steps.length)return null;for(const a of t.stage.steps){const i=this._getUIControl(e,a.controlName);let s=null;if(a.name&&a.stepType&&"field"===a.stepType.toLowerCase()){if(s=this._getMetadataTypeByAttribute(t.entityLogicalName,a.name),!s)continue;if(Object(f.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){const t="BpfCustomControlSupport",e=this._context.TraceManager.getTracer(t),r=Object(o.a)(this._getState(),n.getProcessId(),e);if(!Object(b.a)(r)&&!Object(b.a)(r.ControlConfigurations)&&n.isBpfFormDescriptorValid(this._getState(),n.getProcessId(),r,e)){const t=Object(o.b)(r,e),n=this._getNonDefaultControlStepIds(t);if(!Object(b.a)(n)&&n.map(t=>t.guid).indexOf(a.stepId.guid)>=0)continue}}}const c=this._getState(),l={attributeName:a.name,controlName:a.controlName,isRequired:a.required,isVisible:!i||i.visible,name:i?i.label:a.label,stepId:a.stepId,stepType:a.stepType,attributeType:s,viewId:i&&i.parameters&&i.parameters.defaultviewid?i.parameters.defaultviewid:a.viewId,isControlDisabled:Object(h.t)(c,{id:e,controlName:a.controlName},n.getContextToken())};l.viewId&&i&&i.customFilter&&i.customFilter&&i.customFilter.length>0&&this._applyLookupFilter(l,i),r.push(l)}return r}_applyLookupFilter(t,e){let n;n=!1;const r=[];if(t&&e){for(let t=0;t<e.customFilter.length;t++){if("END_FLAG"===e.customFilter[t].customFilter){n=!0;break}if("START_FLAG"!==e.customFilter[t].customFilter){const n=Object(l.i)(Object(S.CrmHtmlDecode)(e.customFilter[t].customFilter));n&&(n.conditions&&n.conditions.length>0||n.filters&&n.filters.length>0)&&r.push(JSON.stringify(n))}}n?(this._memorizedExtraFilters=r,t.extraFilters=this._memorizedExtraFilters):t.extraFilters=this._memorizedExtraFilters?this._memorizedExtraFilters:[]}}_getMetadataTypeByAttribute(t,e){const n=this._getState(),r=Object(d.a)(n,t,e);if(!r)return null;const a=`${r.Type}.${r.Format}`;return Object(u.n)(a)}_getActions(t){return{completeProcess:()=>t.completeProcess(),moveNext:()=>t.moveToNextStage(),movePrevious:()=>t.moveToPreviousStage(),setActiveStage:e=>t.setActiveStage(e.guid),setSelectedStage:(e,n=!1)=>{t.setSelectedStage(e?e.guid:null,n)},triggerActionStepClick:e=>{t.triggerActionStepClick(e)},triggerFlowStepClick:(e,n)=>{t.triggerFlowStepClick(e,n)},refreshFlowStepClick:e=>{t.refreshFlowStepClick(e)},setDisplayState:e=>{t.setDisplayState(e)},getForwardNavigationEntities:(e,n,r,a)=>t.getForwardNavigationEntities(e,n,r,a),navigateToNextEntity:(e,n,r,a)=>t.navigateToNextEntity(c.a.fromLegacyEntityReference(e),c.a.fromLegacyEntityReference(n),r,a),executePreEvent:(e,n,r,a)=>t.executePreEvent(e,n,r,a),validateRequiredFieldsForNavigation:()=>t.ValidateRequiredFieldsForNavigation(),waitForOngoingWork:()=>t.waitForOngoingWork(),getActiveStageActiveFor:()=>t.getActiveStageActiveFor(),getBpfInstanceActiveFor:()=>t.getBpfInstanceActiveFor(),getBpfInstanceCompletedIn:()=>t.getBpfInstanceCompletedIn(),getBpfNavigationBehavior:()=>t.getBpfNavigationBehavior(),setBpfNavigationBehavior:e=>{t.setBpfNavigationBehavior(e)},getBpfNavigationBehaviorAllowCreateNew:e=>t.getBpfNavigationBehaviorAllowCreateNew(e),getActiveStage:()=>{const e=t.getContextToken(),n=t.getScriptContainer().getEventManager().getClientApiForm(e);return n?n.data.process.getActiveStage():null}}}_getRelatedEntityReference(t){if(!this._navigationEntities)return null;const e=this._navigationEntities.find(e=>e.entityLogicalName===t);return e?new _.a(e.entityLogicalName,a.a.toLegacyGuid(a.a.parse(e.id))):null}_getUIControl(t,e){if(e){const n=this._getState(),r=Object(g.j)(n,t),a={controlName:e,id:t};return Object(h.Mc)(this._getState(),a,r)}return null}_getNonDefaultControlConfiguration(t){const e={};if(t){const n=Object.keys(t);for(let r=0;r<n.length;r++){let a=null;const i=Object(y.b)(this._getState());a=t[n[r]].CustomControls[i],a&&(e[n[r]]={FormFactor:a.FormFactor,CustomControlId:a.CustomControlId,Name:a.Name,Version:a.Version,Parameters:a.Parameters,ShouldOverrideControlVisible:a.ShouldOverrideControlVisible,DisplayNameKey:a.DisplayNameKey})}}return e}_getNonDefaultControlStepIds(t){const e=[];return t&&Object.keys(t).forEach(n=>{t[n].ParentCellId&&e.push(new a.a(t[n].ParentCellId))}),e}_getIsStepRequired(t,e){const n=e.stage.steps,r=n?n.map(t=>t.stepId.guid).indexOf(t):-1;return r>=0&&!Object(b.a)(n[r].required)&&n[r].required}_getStepTypeFromControlKey(t){return t.endsWith("_actionstep")?"action":t.endsWith("_flowstep")?"modernflow":"field"}}},"0bz+":function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n("WY/A"),a=n("RrRQ"),i=n("qTme");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(t=null,e){if(e.type===r.a){return e.payload.snapshotId}return e.type===i.a?e.payload:e.type===a.a?null:t}},"223Y":function(t,e,n){"use strict";n.d(e,"b",(function(){return un})),n.d(e,"a",(function(){return dn})),n.d(e,"d",(function(){return hn})),n.d(e,"c",(function(){return ln}));var r=n("u+q+"),a=n("QBtP"),i=n("nuS9"),s=n("93Ls"),o=n("kGA3"),c=n("VnpK"),l=n("S2mk"),u=n("DRVD"),d=n.n(u),p=n("SZCI"),h=n("SAYH"),g=n("504W"),m=n("arV0"),b=n("xHmU"),f=n("i1f0"),y=n("lEFU"),v=n("Z/4N"),_=n("5ZBI"),S=n("dHD5"),O=n("jRy5"),C=n("odYE"),I=n("bT7G"),P=n("pnQK"),j=n("OtHk"),T=n("3/02"),E=n("Lyxw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const F="CustomControlFramework.Selectors.CustomControlHostContextTokenSelectors";function w(){let t=null,e=null,n=null;return(r,a)=>{_.a.info(a.controlId+"."+F+": createGetContextTokenSelector started");const i=a.parentContextToken,s=a.contextString,o=function(t,e){const n=e.parentContextToken,r=e.contextString;let a;const i=e.configuration,s=Object(v.e)(t,e.configuration.CustomControlId);if(Object(E.c)(t,T.J)&&Object(c.s)(s)&&function t(e,n){if(!n)return!1;if(n.contextTokenType===O.a.UnboundForm&&n.formId)return!(!Object(P.a)(e,n.formId)&&!Object(j.a)(e,n.formId));return t(e,n.parentContextToken)}(t,n))return a=S.p(n.parentContextToken,e.controlId),a;if("default"===r&&Object(c.s)(s)&&!Object(c.r)(e.configuration.Parameters)||Object(c.r)(e.configuration.Parameters)&&function(t){if(t.indexOf("ClientContextGridControl")>-1||t.indexOf("activeProcessGridControlContainer")>-1||t.indexOf("ManageDuplicatesGrid")>-1||t.indexOf("archivedProcessGridControlContainer")>-1)return!0;return!1}(e.controlId))return a=S.e(n,e.controlId),a;if(!e.formInfo&&i&&i.Parameters&&i.Parameters.value&&"TimelineWall"===i.Parameters.value.Type)return a=S.p(n,e.controlId),a;if(!e.formInfo&&Object(c.t)(e.configuration)){const r=function(t,e){const n=Object(m.g)(t,e.id),r=new C.a(n.entityTypeName,n.id||h.a.EMPTY),a=Object(f.ac)(t,e.id,e.parentContextToken),i=Object(I.d)(t,a,r,e.descriptor.DataFieldName),s=i?i.reference:null;return s?s.etn:Object(c.m)(e.descriptor)}(t,e);return a=S.l(n,e.controlId,r),a}a=n;const o=e.descriptor&&e.descriptor.Relationship;o&&(a=S.m(a,o));return a}(r,a);return(n!==s||x(t,o)||x(e,i))&&(t=o,e=i,n=s),_.a.info(a.controlId+"."+F+": createGetContextTokenSelector finished"),t}}function x(t,e){return t&&e?t.entityTypeName!==e.entityTypeName||t.controlName!==e.controlName||(t.formId&&t.formId.guid)!==(e.formId&&e.formId.guid)||(t.recordId&&t.recordId.guid)!==(e.recordId&&e.recordId.guid)||t.relationshipName!==e.relationshipName:t!==e}var A=n("p8cR"),N=n("P6DH"),k=n("zmL5"),D=n("OKVy"),M=n("FdB0"),R=n("fILV");function L(){let t={},e=!1;return(n,r,a,i,s,o)=>{_.a.info(r.controlId+".CustomControlFramework.Selectors.CustomControlHostPersonalizationInfoSelectors: createGetPersonalizationConfiguration started");const c=Object(m.a)(n,r),l=c&&c.id,u=t&&l&&l.guid&&(!t.recordGuid||t.recordGuid&&l.guid!==t.recordGuid.guid);if(!e||u){const c=Object(k.b)(n,r.id),l=h.a.equals(h.a.tryParse(a.UniqueId),h.a.EMPTY)?r.controlId:a.UniqueId;t=c&&o===D.a?function(t,e,n,r){return{areaType:"dashboard",entityTypeName:null,recordGuid:null,formGuid:n,controlUniqueId:r,viewId:void 0}}(0,0,c,l):c&&o===M.a?function(t,e,n,r){const{entityTypeName:a,recordSetQueryKey:i}=Object(m.a)(t,e);return{areaType:"dialog",entityTypeName:a,formGuid:n,controlUniqueId:r,viewId:i?i.split(",")[1]:void 0}}(n,r,c,l):c?function(t,e,n,r){const{entityTypeName:a,recordSetQueryKey:i,id:s}=Object(m.a)(t,e);return{areaType:"form",entityTypeName:a,recordGuid:s,formGuid:n,controlUniqueId:r,viewId:i?i.split(",")[1]:void 0}}(n,r,c,l):o===R.a?function(t,e,n,r){const a=Object(N.cb)(t,r,e);return{areaType:"grid",entityTypeName:n,viewId:a?a.split(",")[1]:void 0}}(n,r,i.entityTypeName,s):{areaType:null,entityTypeName:null,controlUniqueId:l,viewId:void 0},e=!0}return _.a.info(r.controlId+".CustomControlFramework.Selectors.CustomControlHostPersonalizationInfoSelectors: createGetPersonalizationConfiguration finished"),t}}var V=n("q6Ks"),B=n("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function G(t,e,n,r,a){const i=Object(B.a)(t,e),s=a?"__hiddenCommandManagerIds":"__pendingCommandManagerIds",o=Object(S.v)(r);return i&&i[s]&&i[s][o]&&i[s][o][n]?i[s][o][n]:null}var X=n("GT4X"),U=n("tJ+6"),q=n("cfbi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const z=d.a.createEvent("CustomControlHostSelectors.mapStateToProps",p.c);var H=n("r/9v"),W=n("OmkB"),Y=n("tOh6"),K=n("BJ7u"),Q=n("5DN6"),J=n("iZ7K"),Z=n("lY/Z"),$=n("Lohl"),tt=n("y60j"),et=n("XlXz");function nt(t,e){return{type:et.a,payload:t,meta:{pageId:e}}}function rt(t){return{type:"execute.cleanreferencepanelstate.async",execute:({dispatch:e,getState:n},r)=>(e(function(t){return{type:et.b,payload:{},meta:{pageId:t}}}(t)),Promise.resolve())}}function at(t){return{type:"execute.closeallsessiontabs.async",execute({dispatch:e,getState:n},r){const a=n();return e(function(t,e){return{type:et.c,payload:t,meta:{pageId:e}}}({sessionTabs:[],activeTabId:Object(Q.b)(a,t)},t)),Promise.resolve()}}}function it(t,e){return{type:"execute.closesessiontab.async",execute({dispatch:n,getState:r},a){const i=r(),s=Object(Q.d)(i,e),o=Object(Q.a)(i,t,e);return s.splice(t,1),n(function(t,e){return{type:et.d,payload:t,meta:{pageId:e}}}({sessionTabs:s,activeTabId:o},e)),Promise.resolve()}}}function st(t){return{type:"execute.dismissmessage.async",execute:({dispatch:e,getState:n},r)=>(e(function(t,e){return{type:et.e,payload:{referencePanelState:e},meta:{pageId:t}}}(t,{messageId:""})),Promise.resolve())}}function ot(t,e){return{type:"execute.initializereferencepanelcontrol.async",execute({dispatch:n,getState:r},a){const i=Object(Q.c)(r(),e);if(t&&!(i.activeTabId&&i.controlNames.length>0))return n(function(t,e){return{type:et.f,payload:t,meta:{pageId:e}}}({controlNames:t.map(t=>t.Name),activeTabId:t[0].Id},e)),Promise.resolve()}}}var ct=n("SWZ5");function lt(t,e){return{type:"execute.addsessiontab.async",execute({dispatch:n,getState:r},a){const i=Object(Q.d)(r(),e),s=[];for(let e=0;e<i.length;e++)i[e].id===t.id?s.push(t):s.push(i[e]);return n(function(t,e){return{type:et.h,payload:t,meta:{pageId:e}}}({sessionTabs:s},e)),Promise.resolve()}}}var ut=n("IaGr"),dt=n("1kth");var pt=n("Or4W"),ht=n("BMZr"),gt=n("uPT+"),mt=n("mIxf"),bt=n("sX6v"),ft=n("WY/A"),yt=n("JP46"),vt=n("Dea/");var _t=n("ghNp"),St=n("yRo8"),Ot=n("oOvK"),Ct=n("FZDd"),It=n("HfZT"),Pt=n("6Qf/"),jt=n("a72m"),Tt=n("YYhu"),Et=n("Tf+h"),Ft=n("ZUzm"),wt=n("0uKS"),xt=n("lIi+"),At=n("lYcl"),Nt=n("4fxQ"),kt=n("VCkP");var Dt=n("DU8S");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Mt{constructor(t,e){this.Target=t,this.FieldName=e}getMetadata(){return{boundParameter:null,operationName:"CalculateRollupField",operationType:1,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},FieldName:{typeName:"Edm.String",structuralProperty:1}}}}}var Rt=n("srnJ"),Lt=n("UR8A"),Vt=n("j6Db");var Bt=n("NjDY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Gt=n("969l"),Xt=n("EY5k"),Ut=n("YxC/");var qt=n("VpHT");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function zt(t,e){return{type:"customcontrol.loadresources.async",execute:({dispatch:n,getState:r},a)=>function(t,e,n,r){const a=Object(Bt.t)(e);return n.initializeContainerForClientApi(r).then(e=>e.loadWebResources([Object(Bt.a)(a,t)]).then(()=>({container:e,webResourcePath:a})))}(t,r(),a.ScriptManager,e)}}var Ht=n("kWiz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Wt=n("Khp3"),Yt=n("3tOH"),Kt=n("Qn2w"),Qt=n("LbMF");var Jt=n("dQnL"),Zt=n("d0Pd"),$t=n("0L4T"),te=n("NbYl"),ee=n("NYBK"),ne=n("7fV9"),re=n("Z+6x"),ae=n("Nse0"),ie=n("WK+4"),se=n("qwRa"),oe=n("s+OO"),ce=n("7k+e"),le=n("eXjw"),ue=n("Uv1Y"),de=n("vNXc"),pe=n("5Oca");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class he{constructor(t,e,n){this.Target=t,this.Query=e,this.RollupType=n}getMetadata(){return{boundParameter:null,operationName:"Rollup",operationType:1,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},Query:{typeName:"Microsoft.Dynamics.CRM.QueryBase",structuralProperty:2},RollupType:{typeName:"Microsoft.Dynamics.CRM.RollupType",structuralProperty:3,enumProperties:[,{name:"None",value:0},{name:"Related",value:1},{name:"Extended",value:2}]}}}}}var ge=n("sNgR"),me=n("tHtE"),be=n("SRlt"),fe=n("fYtF");function ye(t,e=!1){const n=[];return{type:"gridData.retrieve.rollup.async",execute({dispatch:r,getState:a},i){let s=a();const o=t.key,c=de.a.fromState(t,a),l=Object(pe.u)(s,o,c.pageNumber-1);return l&&(c.pagingCookie=l),n.push({name:fe.a,value:Object(fe.e)(t)}),n.push({name:"isRefresh",value:e}),r(function(t,e,n=!1){const r={lists:{[t]:{initialized:n?le.a.Refreshing:le.a.Initializing,pageSize:e}}};return{type:"gridData.retrieve.rollup",payload:r}}(o,c.pageSize,e)),function(t,e,n){return n.toQueryExpression(t,e).then(r=>e(Object(ge.b)(new he(C.a.toExternalEntityReference(n.target),r,n.rollupType))).then(r=>Object(be.g)(r).then(r=>function(t,e,n,r){const a=n.getKeyQuery(),i=Object(me.e)(a),s=Object(Ct.e)(i.entity2AttributesMap);return e(s).then(()=>{const e=t();return Object(me.a)(e,a,i,r)})}(t,e,n,r))))}(a,r,c).then(t=>{s=a(),r(Object(It.e)(s,r,o,c,t))}).catch(t=>{Object(ue.b)(t)})},getFailureParameters:(t,e)=>n,getSuccessParameters:(t,e,r)=>n}}var ve=n("fREn"),_e=n("ngeo"),Se=n("xorU");function Oe(t,e,n,r,a){let i="",s="";if(r&&r.message&&(i=r.message),r&&r.errorCode){const o=a||Vt.a,c=t=>(n.EventManager.ReportComponentFailure(o,t,null,[{name:"hexErrorCode",value:s},{name:"errorStatus",value:JSON.stringify(r)},{name:"customControlId",value:a},{name:"APIName",value:Vt.a+".Actions.RefreshDataSetParameter.getErrorMessage"}]),Promise.resolve(`${s} ${i}`));try{s="0x"+_e.a.getHexErrorCodeFromInt(r.errorCode);const n="Error_Title_"+s,a="Error_Message_"+s,i=`Localized resource strings not found for neither ${n} nor ${a}.  Please add error resources for error code ${s}`,o=t(Object(Xt.e)([n])).catch(()=>{}),l=t(Object(Xt.e)([a])).catch(()=>{});return Promise.all([o,l]).then(()=>{const t=Object(Ut.e)(e(),[n,a]),r=Object(Ut.c)(t,n),o=Object(Ut.c)(t,a);let l="";return l=function(t){return"0x8005f211"===(null==t?void 0:t.toLowerCase())}(s)?`${r}${r&&o?": ":""}${o}`:r||o,l?Promise.resolve(`${s} ${l}`):c(i)})}catch(t){return c(t)}}return Promise.resolve(`${s} ${i}`)}function Ce(t,e){if(t instanceof ne.a){t.getLatestData().loading=!0,t.setRefreshingStart()}else if(t instanceof re.a||t instanceof ee.a){const e=t.getLatestData();e&&(e.working=!0,re.a,t.setWrapperLoadingFlag(!0))}return{type:"customcontrol.refreshDataSetParameter.async",execute({dispatch:n,getState:r},a){if(t instanceof te.a){const i={retrieveGridDataAction:t=>n(Object(It.d)(t)),retrieveViewAction:(t,e,r,a)=>n(Object(jt.a)(t,e,r,a)),retrieveViewSelectorAction:(t,e)=>n(Object(jt.b)(t,e)),runPreSearch:(t,r,a)=>n(Object(dt.W)(e,t,r,a)),runSetAdditionalParams:(t,r,a)=>n(Object(dt.X)(e,t,r,a)),refreshCustomDataProviderAction:(t,e,r,a)=>n(Object(ae.b)(t,e,r,a)),retreiveChartAction:(t,e,r)=>n(Object(Jt.a)(t,e,r)),retreiveChartDataAction:(t,e,r,a=!0)=>n(Object(Zt.a)(t,e,r,a)),updateDataSetChartVisualizationId:(t,e,r)=>n(Object(ie.b)(t,e,r)),updateDataSetChartVisualizationType:(t,e,r)=>n(Object(se.b)(t,e,r)),getEntityMetadataAction:(t,e)=>n(Object(Ct.f)(t,!1,e)),getLocalizedErrorMessage:(t,e)=>Oe(n,r,a,t,e),updateChartFilterExpression:(t,e,r)=>n(Object(oe.c)(t,e,r)),updateChartDrillDownParameters:(t,e,r)=>n(Object(ce.c)(t,e,r)),updateChartErrorInformation:(t,e,r,a)=>{Object($t.a)(t,n,e,r,a)}};return t.refreshDataSet(r,i,a)}const i={retrieveGridDataAction:t=>Object(g.a)(t.rollupType)?n(Object(It.d)(t)):n(ye(t)),retrieveViewAction:(t,e,r,a)=>n(Object(jt.a)(t,e,r,a)),retrieveViewSelectorAction:(t,e)=>n(Object(jt.b)(t,e)),runPreSearch:(t,r,a)=>n(Object(dt.W)(e,t,r,a)),runSetAdditionalParams:(t,r,a)=>n(Object(dt.X)(e,t,r,a)),startCustomFilter:(t,e,r)=>n(Object(Se.f)(t,e,r)),endCustomFilter:(t,e,r)=>n(Object(Se.e)(t,e,r)),refreshCustomDataProviderAction:(t,e,r,a)=>n(Object(ae.b)(t,e,r,a)),getEntityMetadataAction:(t,e)=>n(Object(Ct.f)(t,!1,e)),getLocalizedErrorMessage:t=>Oe(n,r,a,t),getAdditionalResourceStrings:t=>n(Object(Xt.e)(t)),addCustomViewAction:(t,e,r,a,i,s,o,c)=>n(Object(ve.a)(t,e,r,a,i,s,o,c)),setOfflineQueryAction:t=>n(Object(ve.b)(t))};return t.refreshDataSet(r,i,a)}}}var Ie=n("7Sr4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Pe=n("sn0j"),je=n("KVHF");var Te=n("mFPv"),Ee=n("AE7n"),Fe=n("pp6D"),we=n("9i5P");var xe=n("Q1Tc"),Ae=n("jsFU"),Ne=n("455M");var ke=n("BFlg"),De=n("7p56");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Me(t,e,n){if(n.dataSetUIOptions){const r=t+e.id;let a=e.contextString;switch(e.contextString){case ke.h.ASSOCIATEDGRID:case ke.h.SUBGRID:case ke.h.GRID:break;case ke.h.CUSTOM:default:a=ke.h.CUSTOM}return i.createElement(De.a,{key:r,id:e.id,systemDefinedProperties:e.systemDefinedProperties,controlId:e.controlId,configuration:e.configuration,descriptor:e.descriptor,formInfo:e.formInfo,themingData:e.themingData,parentDefinedControlProps:e.parentDefinedControlProps,children:e.children,rowSpan:e.rowSpan,contextString:a,parentContextToken:e.parentContextToken,dataSetUIOptions:n.dataSetUIOptions})}return i.createElement(ln,{key:t,id:e.id,systemDefinedProperties:e.systemDefinedProperties,controlId:e.controlId,configuration:e.configuration,descriptor:e.descriptor,formInfo:e.formInfo,themingData:e.themingData,parentDefinedControlProps:e.parentDefinedControlProps,children:e.children,rowSpan:e.rowSpan,contextString:e.contextString,parentContextToken:e.parentContextToken})}var Re=n("iWfp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Le(t){if(!t)return;if(t instanceof C.a)return t;const e=t.entityName||t.LogicalName;let n;return n=h.a.fromLegacyGuid(t.Id),h.a.isNullOrEmpty(n)&&(n=new h.a(t.id||t.Id)),new C.a(e,n,Object(g.a)(t.name)?t.Name:t.name)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ve(t,e,n,r){return r&&r.DisplayName&&"partylist"!==r.Type&&Object(Pe.b)(t,e,n,r)&&r.IsValidForAdvancedFind}var Be=n("thZs"),Ge=n("R5Qn"),Xe=n("E3i9"),Ue=n("KBcj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class qe{convert(t,e,n){const r=(new DOMParser).parseFromString(t,"text/xml"),a=this._firstElementChild(r),i=this._childElements(a);if(!i)return null;const s=[];for(const t of i){const e=[],n=this._childElements(t);for(const t of n)e.push(this._getGridCellDescriptor(t));s.push(this._getGridRowDescriptor(t,e))}const o=this._getGridDescriptor(a,s,n);return this._populateRelationshipInformation(o,e),o}_attributeValueBoolean(t,e){return"1"===this._attributeValueString(t,e,"")}_attributeValueString(t,e,n){const r=t.attributes.getNamedItem(e);return r&&r.value||n}_attributeValueInt(t,e,n){const r=this._attributeValueString(t,e,n+"");return parseInt(r,10)}_childElements(t){if(!t)return null;if(t.children)return Array.from(t.children);if(t.childNodes){return Array.from(t.childNodes).filter(t=>t.nodeType===Node.ELEMENT_NODE).map(t=>t)}return null}_getGridCellDescriptor(t){return{name:this._attributeValueString(t,"name",""),width:this._attributeValueInt(t,"width",0),relatedEntityName:this._attributeValueString(t,"relatedentityname",""),disableMetaDataBinding:this._attributeValueBoolean(t,"disableMetaDataBinding"),labelId:this._attributeValueString(t,"LabelId",""),isHidden:this._attributeValueBoolean(t,"ishidden"),disableSorting:this._attributeValueBoolean(t,"disableSorting"),addedBy:this._attributeValueString(t,"addedby",""),desc:this._attributeValueString(t,"desc",""),cellType:this._attributeValueString(t,"cellType",""),imageProviderWebresource:this._attributeValueString(t,"imageproviderwebresource",""),imageProviderFunctionName:this._attributeValueString(t,"imageproviderfunctionname","")}}_getGridRowDescriptor(t,e){return{name:this._attributeValueString(t,"name",""),id:this._attributeValueString(t,"id",""),cells:e,multiObjectIdField:this._attributeValueString(t,"multiobjectidfield",""),layoutStyle:this._attributeValueString(t,"layoutstyle","")}}_getGridDescriptor(t,e,n){return{name:this._attributeValueString(t,"name",""),object:n,rows:e,customControlDescriptions:null,jump:this._attributeValueString(t,"jump",""),select:this._attributeValueBoolean(t,"select"),icon:this._attributeValueBoolean(t,"icon"),preview:this._attributeValueBoolean(t,"preview"),iconrenderer:this._attributeValueString(t,"iconrenderer","")}}_firstElementChild(t){if(!t)return null;if(t.firstElementChild)return t.firstElementChild;const e=this._childElements(t);return e&&e[0]}_populateRelationshipInformation(t,e){const n=(new DOMParser).parseFromString(e,"text/xml"),r=this._firstElementChild(n),a=this._firstElementChild(r),i=this._childElements(a);if(i)for(const e of i)"link-entity"===e.nodeName&&this._attributeValueString(e,"alias","")&&this._attributeValueString(e,"name","")&&this._setRelatedEntityName(t,this._attributeValueString(e,"alias",""),this._attributeValueString(e,"name",""))}_setRelatedEntityName(t,e,n){for(let r=0;r<t.rows.length;r++)for(let a=0;a<t.rows[r].cells.length;a++){const i=t.rows[r].cells[a].name;(i?i.substring(0,i.indexOf(".")):void 0)===e&&(t.rows[r].cells[a].relatedEntityName=n)}}}var ze=n("DU5H"),He=n("fU7K");function We(t,e=!1,n,r,a,i,s,o){return{type:"populateAndSend.LookupData.Action",sync:!0,execute({dispatch:c,getState:l},u){const d=l(),p=a||t.LookupEntityByName[0].EntityLogicalName,g=Object(Ge.f)(d,p,s,r),b=[];if(o){const e=o.split("."),a=Object(m.g)(d,r);let i;const s=Object(f.ac)(d,r,n),c=Object(I.b)(d,s);i=c&&c.activeChanges&&c.activeChanges[e[1]]?c.activeChanges[e[1]]:Object(pe.j)(d,new C.a(e[0],a.id),e[1]),t.RelatedRecordId=i&&i.reference&&i.reference.id}if(t.LookupEntityByName&&t.LookupEntityByName.length){const e=Object(f.eb)(d,r,n),a=e&&e[i];for(const e of t.LookupEntityByName){const t=Object(ze.b)(d,r,n,i,e.EntityLogicalName);if(t&&(e.CustomFilter=Object(He.CrmHtmlDecode)(t).replace(/"/g,"'")),g){const t=Object(Xe.a)(d,g,e.EntityLogicalName);t&&t.view&&(h.a.equals(t.view.viewId,e.ViewId)||Object(Ue.c)(d,e.ViewId))||b.push(c(Object(jt.a)(e.EntityLogicalName,null,null,e.ViewId)))}const s=a&&a.parameters&&a.parameters.defaultviewid;if(a&&a.views&&a.views[s]&&a.views[s].entityLogicalName===e.EntityLogicalName){e.ViewId=null,e.FetchXml=a.views[s].fetchXML.replace(/"/g,"'");const t=Object(J.h)(d,e.EntityLogicalName),n=new qe;e.LayoutJson=JSON.stringify(n.convert(a.views[s].layoutXML,a.views[s].fetchXML,t.ObjectTypeCode)).replace(/"/g,"'")}}}const y=Object(Be.b)(d,p,t),v=Object(pe.o)(d,y);e=e||v===le.a.Initialized,b.push(c(Object(Be.d)(t,e)));const _=function(t,e,n,r,a){const i={};let s=r||n.EntityAndAttribute&&n.EntityAndAttribute.EntityName;const o=a||n.EntityAndAttribute&&n.EntityAndAttribute.AttributeName;if(!s&&!o)return null;s||(s="placeholderEtn");if(n.LookupEntityByName)for(const e of n.LookupEntityByName)i[e.EntityLogicalName]=Object(Be.b)(t,e.EntityLogicalName,n);const c=Object(Be.c)(t,n);return{type:"update.lookupRequestDataKey",payload:{[s]:{[o]:{metadataKey:c,dataKeys:i}}},meta:{pageId:e}}}(d,r,t,a,s);return _&&c(_),Promise.all(b)}}}var Ye=n("mpSO"),Ke=n("F1Lu");var Qe=n("+pAH"),Je=n("wZxB");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let Ze,$e,tn,en;function nn(t,e){return{openEditForm:(n,r,a,i,s)=>{const o=Le(n);t(r?Object(Ft.a)(o,e.id,void 0,void 0,r,a,i,s):Object(Ft.a)(o,e.id))},openGridPage:(n,r,a,i,s,o,c,l)=>{t(Object(wt.a)(n,e.id,h.a.tryParseOrNull(r),a,i,h.a.tryParseOrNull(s),o,null,l,c))},openCreateForm:(n,r,a)=>{t(Object($.b)(new C.a(n),null,"QuickCreate")).then(i=>{t(Object(ht.b)(n,e.id,null,r,Le(a)))}).catch(a=>{t(Object(Ft.a)(new C.a(n),e.id,void 0,r))})},openSearch:n=>{t(Object(At.a)(n,null,e.id))},openPowerBIFullScreenPage:(n,r,a,i,s,o,c)=>{t(Object(xt.a)(e.id,n,r,a,i,s,o,c))},openDashboard:t=>{},openUrl:(t,e)=>{},openUrlWithProtocol:(t,e)=>{},openPhoneNumber:(n,r,a,i,s,o,c,l,u,d=!1,p=!0)=>t(function(t,e,n,r,a,i,s,o,c,l,u=!1,d=!0){return{type:"customcontrol.openphonecall",execute(p,g){let m=t.trim();const b=Object(Bt.x)(p.getState()).defaultCountryCode;0!==m.indexOf("tel:")?(b&&(m=b+m),m="tel:"+m):b&&(m=m.slice(0,4)+b+m.slice(4));const f=new Ke.a(g,p);let y;g.ScriptManager.containerExists(Ye.d)&&(y=g.GlobalCustomEventManager);const v=()=>{if(u){let c=null;const l={};if(e){c=new C.a(n,new h.a(e));const a={id:e,entityType:n,name:r};let u=a;i&&(u={id:i,entityType:s,name:o}),l.contactinfo=t,l.to=[a],l.regardingobjectid=u}return p.dispatch(Object(ht.b)("phonecall",a,null,l,c,null,{entityName:"phonecall",showDialog:!0}))}};return f.canOpenUri(m).then(t=>{if(d&&y&&p.dispatch(y.runOnOpenUrl(a,m,l,c)))return null;const e=Object(E.c)(p.getState(),T.C);t?(f.openUri(m),e&&v()):u&&e&&v()},()=>null)},shouldReceiveFullStore:!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(n,a,r,i,e.id,o,s,c,l,u,d,p)),openMaps:t=>{},openMap:t=>{}}}var rn=n("Ki7F"),an=n("nJrx"),sn=n("o0iw"),on=n("llMO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const cn=Object(r.a)(()=>{let t,e={},n=null,r={},a={},i={},s=!1,o="",u=null,d={},p=!1,S="",O=!1,C={stateToPropsMappingError:!1,dynamicData:null,manifest:null,personalizationState:null,propBagData:null,pageType:null,popupStack:null,contextToken:null,portalFlyoutToDialogId:null,designLanguage:null,inactive:!1},I=-1,P=-1;const j=Object(A.a)(),T=Object(V.a)(),E=L(),F=w();return(w,x)=>{_.a.info(x.configuration.CustomControlId+".CustomControlFramework.Selectors.CustomControlHostSelectors: makeMapStateToProps started");const A=z.startStopwatch({controlId:x.controlId,parentId:Object(c.p)(x),level:(0).toString()});let N,k,D,M,R,L=[],V=!1,B=null,H=null,W=null,Y=null,K=null,Q=null,J=null,Z=null,$=null,tt=null,et=!1,nt=null,rt=null,at=null,it=!1;try{let t=null;x.formInfo?(u&&d.EntityName===x.formInfo.EntityName&&d.RecordId===x.formInfo.RecordId&&d.FormId===x.formInfo.FormId||(u={id:x.formInfo.RecordId?new h.a(x.formInfo.RecordId):null,formId:x.formInfo.FormId?new h.a(x.formInfo.FormId):null,entityTypeName:x.formInfo.EntityName},d=x.formInfo),t=u):t=Object(m.g)(w,x.id),H=x.descriptor,W=x.configuration,D=Object(b.b)(w),N=Object(m.l)(w,x.id),Object(m.f)(w,x.id)&&(R="DialogContainer__"+x.id),!R&&x.parentDefinedControlProps&&x.parentDefinedControlProps.parentFlyoutId&&(R=x.parentDefinedControlProps.parentFlyoutId),N&&(k=F(w,x));const e=Object(f.kb)(w,x,k);let n=W;if(null!==x.systemDefinedProperties){const t=Object.assign(Object.assign({},W.Parameters),x.systemDefinedProperties);n=Object.assign(Object.assign({},W),{Parameters:t})}if(Y=Object(v.e)(w,W.CustomControlId)||Object(v.e)(w,W.Name),!Y||!Y.ConstructorName){Y=null;const t=Object(l.h)(W.CustomControlId);t!==W.CustomControlId&&(Y=Object(v.e)(w,t))}Y&&(Z=T(w,Y,t,e,x.contextHelper),J=Z.response,Q=j(n,H,x,w,t,k),K=Q.response,tt=K&&K.dataReady?E(w,x,H,t,k,N):null,$=Object(y.a)(w,tt,Y.CustomControlId,x.id));const r=G(w,x.id,x.controlId,k);r&&(et=r.every(t=>Object(X.b)(w,t))),M=G(w,x.id,x.controlId,k,!0),rt=x.parentDefinedControlProps&&!Object(g.a)(x.parentDefinedControlProps.height)?x.parentDefinedControlProps.height:-1,nt=x.parentDefinedControlProps&&!Object(g.a)(x.parentDefinedControlProps.width)?x.parentDefinedControlProps.width:-1,at=Object(U.b)(w)?Object(U.a)(w):null,it=((t,e,n,r)=>Object(m.l)(t,e)===q.a&&!Object(f.Fb)(t,e,n,r))(w,x.id,k,x.descriptor.Name)}catch(t){const e=Y.ConstructorName;_.a.error(e+": makeMapStateToProps encountered error, err "+t,[{name:"ApiName",value:"CustomControlFramework.Selectors.CustomControlHostSelectors"},{name:"controlId",value:x.controlId},{name:"customControlId",value:Y.CustomControlId},{name:"manifest",value:JSON.stringify(Y)},{name:"descriptor",value:JSON.stringify(H)},{name:"configuration",value:JSON.stringify(W)},{name:"error.Stack",value:JSON.stringify(t.stack)}]),V=!0,B=t.toString()+". Stack: "+t.Stack}return n&&(L=L.concat(((t,e)=>{const n=[];return t.Disabled!==e.Disabled&&n.push("IsControlDisabled"),t.Label!==e.Label&&n.push("Label"),n})(H,n))),n=x.descriptor,K!==r||Y!==e||J!==a||tt!==i||V!==s||N!==o||et!==p||M!==t||rt!==P||nt!==I||R!==S||at!==C.designLanguage||it!==O?(rt===P&&nt===I||L.push("layout"),Q&&(L=L.concat(Q.updatedProperties)),Z&&(L=L.concat(Z.updatedProperties)),at!==C.designLanguage&&L.push("design"),C={stateToPropsMappingError:V,stateToPropsMappingErrorMessage:B,dynamicData:K,manifest:Y,personalizationState:$,propBagData:J,children:W&&W.Children,personalizationConfiguration:tt,pageType:N,popupStack:D,contextToken:k,updatedProperties:L,globalCommandManagerInitialized:et,internalCommandManagerIds:M,portalFlyoutToDialogId:R,designLanguage:at,inactive:it},p=et,t=M,S=R,s=V,a=J,e=Y,r=K,i=tt,o=N,P=rt,I=nt,O=it):C.updatedProperties=L,A({updatedProperties:JSON.stringify(L)}),_.a.info(x.configuration.CustomControlId+".CustomControlFramework.Selectors.CustomControlHostSelectors: makeMapStateToProps finished"),C}},(function(){let t;return function(e,n){if(t)return t;const r=nn(e,n);return Ze={setNotification:(t,n,r,a,i,s,o)=>e(function(t,e,n,r,a,i,s){return{type:"customcontrol.propertybag.mode.setnotification",execute({dispatch:o,getState:c},l){const u={uniqueId:e||"",messages:[t],priority:0,notificationLevel:Yt.a.error,actions:[{actions:[function(){}],message:""}]};o(Object(Wt.b)(n,r,u,a));const d=c(),p=new C.a(i,h.a.fromExternalGuid(s)),g=Object(Qt.a)(d,p.etn,r);return p&&g&&(2===g.RequiredLevel||1===g.RequiredLevel)&&o(Object(Kt.b)(n,r,!1,a)),!0},sync:!0}}(t,n,r,a,i,s,o)),clearNotification:(t,n,r,a,i,s)=>e(function(t,e,n,r,a,i){return{type:"customcontrol.propertybag.mode.clearnotification",execute({dispatch:r,getState:a},s){const o=Object(f.A)(a(),{controlName:e,id:t},n);if(o){i=i||"";const a=Object.keys(o);let s=null;for(let c=a.length-1;c>-1;--c)a[c]===i&&(s=o[a[c]],s.actions=null,s.messages=null,s.notificationLevel=null,r(Object(Wt.b)(t,e,s,n)))}return!0},sync:!0}}(t,n,r,0,0,s))},tn={setState:t=>!0,logMessage:(t,n,r)=>{e(function(t,e,n){return{type:"customcontrol.log",execute({dispatch:r,getState:a},i){const s=i.TraceManager.getTracer("customcontrol"),o=t+": "+e;switch(n){case Ht.a.Error:s.error(o);break;case Ht.a.Info:s.info(o);break;case Ht.a.Warning:s.warn(o);break;case Ht.a.Verbose:s.debug(o)}},sync:!0}}(t,n,r))}},$e={isGetBarcodeValueOperationAvailable:()=>e(Object(Dt.c)()),isTakePictureOperationAvailable:()=>e(Object(Dt.e)()),isCaptureVideoOperationAvailable:()=>e(Object(Dt.b)()),isCaptureAudioOperationAvailable:()=>e(Object(Dt.a)()),isOpenARViewerAvailable:()=>e(Object(Dt.d)())},en={clearNestedChild:t=>!0,createAccessibilityComponent:Re.a,createCommandManagerUXComponent:()=>{let t=null;return e=>{const n=dn(e);return hn(t,e.selectedRecords)?n.selectedRecords=t:t=n.selectedRecords,un(n)}},createKeyboardShortcut:Re.b,createXrmForm:(t,n,r,a)=>function(t,e,n,r,a){return!!t(Object(Fe.b)(e,n,r,new h.a(a)))}(e,t,n,r,a),createXrmGrid:(t,n,r,a)=>{const i=[O.a.AssociatedGrid,O.a.CustomGrid,O.a.SubGrid,O.a.MainGrid];if(t&&-1===i.indexOf(t.contextTokenType))for(const a in r)if("Grid"===r[a].Type){const i=r[a];e(Object(Pt.c)(i.TargetEntityType||i.EntityName,i.ViewId,n,t));break}return function(t,e,n,r,a){const i=Object(N.vb)(r);if(e){let r;switch(e.contextTokenType){case O.a.SubGrid:r=3;break;case O.a.AssociatedGrid:r=2;break;case O.a.MainGrid:case O.a.CustomGrid:r=1;break;default:const t=[{name:"contextToken",value:JSON.stringify(e)},{name:"controlName",value:a},{name:"isEditableGrid",value:i}];ut.a.getInstance().eventManager.ReportComponentFailure("ClientApi.XrmCommandObjectWrapper.createXrmGridWrapper",new Error("Unknown context token type for grid"),null,t),r=1}return!!t(Object(Fe.c)(e,n,i,r,a))}return!0}(e,t,n,r,a)},registerNewControl:(t,n,r,a)=>function(t,e,n,r,a){return!!t(Object(Fe.e)(e,n,r,a))}(e,t,n,r,a),executeAddOnLoad:(t,n)=>{e(function(t,e){return{type:"customcontrol.executeAddOnLoad.async",sync:!0,execute({dispatch:n,getState:r},a){t.gridRunOnLoad((t,r,i)=>{if(a.ScriptManager.containerExists(t)){const s=a.ScriptManager.getContainer(t).getEventManager();n(s.runOnGridDataLoad(e,1,i,r))}})}}}(t,n))},addSessionTab:(t,n)=>e(function(t,e){return{type:"execute.addsessiontab.async",execute({dispatch:n,getState:r},a){const i=r(),s=Object(Q.d)(i,e);let o=!0;if(t){if(s.forEach(e=>{t.id===e.id&&(o=!1)}),o){if("quickViewFormTab"===t.type){let r=!1;const a=t,o=Object(K.a)(6),c=Object(J.E)(i,a.entityFormOptions.entityName),l="activitypointer";let u;u=i.data.entities[l]&&i.data.entities[l].hasOwnProperty(a.entityFormOptions.entityId)?Object(f.ec)(i,l,new h.a(a.entityFormOptions.entityId)):Object(f.ec)(i,a.entityFormOptions.entityName,new h.a(a.entityFormOptions.entityId));const d=new C.a(a.entityFormOptions.entityName,new h.a(a.entityFormOptions.entityId)),p=[];if(!u){const t=n(Object(Z.d)(d,[c]));p.push(t)}let g=Object(tt.h)(i,a.entityFormOptions.entityName,o);if(h.a.isNullOrEmpty(g)){const t=n(Object($.b)(d,null,o)).then(t=>{g=t,h.a.isNullOrEmpty(g)||g===$.a||(r=!0)});p.push(t)}else r=!0,a.entityFormOptions.formId=g.guid;Promise.all(p).then(()=>{a.entityFormOptions.formId=r?g.guid:"",a.entityMetadata={DisplayName:i.metadata.entities[a.entityFormOptions.entityName].DisplayName},i.data.entities[l]&&i.data.entities[l].hasOwnProperty(a.entityFormOptions.entityId)?a.title=Object(f.ec)(i,l,new h.a(a.entityFormOptions.entityId)):a.title=Object(f.ec)(i,a.entityFormOptions.entityName,new h.a(a.entityFormOptions.entityId)),s.unshift(a),n(nt({sessionTabs:s,activeTabId:a.id,messageId:r?"":"quick_view_form_not_exist_message"},e))})}else s.unshift(t),n(nt({sessionTabs:s,activeTabId:t.id},e));return Promise.resolve()}n(nt({sessionTabs:s,activeTabId:t.id},e))}}}}(t,n)),closeSessionTab:(t,n)=>e(it(t,n)),updateSessionTab:(t,n)=>e(lt(t,n)),closeAllSessionTabs:t=>e(at(t)),dismissMessage:t=>e(st(t)),markActiveTab:(t,n,r)=>e(Object(ct.b)(t,n,r)),initializeReferencePanelControl:(t,n)=>e(ot(t,n)),cleanReferencePanelState:t=>e(rt(t)),executeNotifyHandlersThatEventOccurred:t=>e(function(t){return{type:"execute.notifyhandlersthatevenoccurred.async",execute({dispatch:e,getState:n},r){let a=null;try{switch(t.eventName){case"onresultopened":e(Object(dt.U)(t.contextToken,t.pageId,t.fieldName,t.record));break;case"onselection":e(Object(dt.V)(t.contextToken,t.pageId,t.fieldName,t.record));break;case"onpostsearch":e(Object(dt.S)(t.contextToken,t.pageId,t.fieldName,t.record));break;case"onlookuptagclick":const i="ClientApi.ExecuteNotifyHandlersThatEventOccurred.runOnLookupTagClick",s=t.contextToken,o=t.fieldName,c=t.record;let l=!1;const u=Object(dt.u)(i,n(),r,t.pageId,c);u&&(l=e(u.runOnLookupTagClick(s,o,null,c,n()))),a=l}return Promise.resolve(a)}catch(t){throw ut.a.getInstance().eventManager.ReportComponentFailure("ClientApi.ExecuteNotifyHandlersThatEventOccurred.executeNotifyHandlersThatEventOccurred",t),t}}}}(t)),getConnectorsApi:t=>null,executeRollupRequest:(t,n,r)=>e(function(t,e,n){return{type:"customcontrol.executeRollupRequest.async",execute({dispatch:r,getState:a},i){if(t&&e){const a=new Mt(t,e),s=Lt.a.execute(a).then(t=>t.json()).then(a=>{if(a){const s=[];for(const t in a)-1!==t.indexOf("@")||t.startsWith("_")||s.push(t);const o=new C.a(t.entityType,h.a.fromExternalGuid(t.id));return r(Object(Rt.a)(n,o,s)).then(()=>{i.EventManager.ReportComponentSuccess(Vt.a+".Action",[{name:"APIName",value:Vt.a+".Action.ExecuteRollupRequest"},{name:"target.entityType",value:t.entityType}])},n=>{i.EventManager.ReportComponentFailure(Vt.a+".Actions",n,"refreshRecordData failure error message",[{name:"APIName",value:Vt.a+".Actions.ExecuteRollupRequest"},{name:"target.entityType",value:t.entityType},{name:"target.id",value:t.id},{name:"fieldName",value:e},{name:"jsonResponse",value:a}])})}});return Lt.a.Diagnostics.traceInfo(Vt.a+".refreshRecordData","refresh record data return promise"),s}return Promise.resolve()}}}(t,n,r)),getResource:t=>e(function(t){return{type:"customcontrol.getresources.async",execute({dispatch:e,getState:n},r){const a=r.AssetLoader,i=n(),s=Object(Bt.t)(i);if(3===t.Type||2===t.Type)return a.loadRawData(s+t.Name)}}}(t)),getRecordSetQueryKey:t=>t?t.getPreviousQueryKey():null,loadResources:t=>e(Object(qt.a)(t)),triggerOfflineMetadataSync:()=>e(Object(St.h)()),retrieveFormWithAttributes:(t,n,r)=>e(Object(Pe.c)(new C.a(t),h.a.tryParse(n),r)),loadManifest:(t,n)=>e(Object(Ot.c)(t,n)),updateOutputs:(t,n,r,a,i,s,o)=>e(function(t,e,n,r,a,i,s){return{type:"outputs.update",execute({dispatch:o,getState:c},l){try{const l={},u={};if(i)for(const t of Object.keys(i)){const e=i[t];let n=t;switch(e.fieldName&&(n=e.fieldName),(e.paramType===Ne.a.LookupSimple||e.paramType===Ne.a.LookupCustomer||e.paramType===Ne.a.LookupOwner||e.paramType===Ne.a.LookupRegarding||e.paramType===Ne.a.LookupMultiEntity)&&e.value&&e.value instanceof Array&&(e.value.length>0?e.value=e.value[0]:e.value=null),e.type){case 0:l[n]=i[t];break;case 2:u[n]=i[t]}}const d=new Array,p=o(Object(mt.a)(t,l,!1,!1,e,n,a,s));if(d.push(p),Object(B.a)(c(),t).forms){const e=o(Object(xe.b)(t,r,s,u));d.push(e)}else{const e=o(Object(Ae.b)(t,r,u));d.push(e)}return Promise.all(d)}catch(a){const s=r+" failed at updating its outputs",o=Object(_.b)(c(),r);return l.EventManager.ReportComponentFailure(o+".CustomControl.updateOutputs",a,s,[{name:"APIName",value:Vt.a+".Actions.UpdateOutputs"},{name:"customControlId",value:r},{name:"pageId",value:t},{name:"entityTypeName",value:e},{name:"recordId",value:n},{name:"outputs",value:JSON.stringify(i)}]),l.TraceManager.getTracer("customcontrol").warn(o+" failed at updating its outputs"),null}},sync:!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(t,n,r,a,i,s,o)),updateFieldValue:(t,n,r,a,i,s,o)=>e(Object(mt.a)(t,n,!1,r,a,i,s,o)),runCustomOpenRecord:(t,n,r,a)=>e(function(t,e,n,r){return{type:"record.open",execute(a,i){const s=i.ScriptManager.getContainer(t).getEventManager(),o=new h.a(n),c=Object(S.f)(r,o,e);let l=a.dispatch(Object(Fe.b)(c,t,e,o));return l=new we.a(a,i,c,t,e,o),a.dispatch(s.runOnRecordOpen(r,n,l))}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(t,n,r,a)),getBoundFileObject:(t,n,r,a)=>{if(null==t||null==n||null==n.id||null==r)return null;const i={id:new h.a(n.id),etn:n.entityType};return e(Object(Qe.c)(t,i,r,a,"full"))},saveEmbeddedEntity:(t,n,r,a,i,s,o=!1,c)=>e(Object(Ee.a)(t,n,r,a,i,s,o,c)),renderNestedCustomControl:Me,renderReactSubtree:Nt.createPortal,retrieveView:(t,n,r,a)=>e(Object(jt.a)(t,n,r,a)),retrieveViewSelector:(t,n)=>e(Object(jt.b)(t,n)),retrieveGridData:t=>e(Object(It.d)(t)),retrieveRecordDataForForm:(t,n,r,a,i)=>e(Object(Z.e)(Le(t),h.a.tryParse(n),r,a,i)),retrieveForm:(t,n,r)=>{const a=h.a.tryParse(n),i=Le(t);return e(Object($.b)(i,a,r)).then(t=>e(Object(pt.c)(a,i.etn)).then(()=>t))},retrieveEntityData:t=>e(Object(Ct.f)(t,!1,[])),retrieveChartDrilldownAttributes:t=>{return e((n=t,{type:"customcontrol.charts.attributes.retrieve.async",execute:({dispatch:t,getState:e},r)=>t(Object(Ct.f)(n,!0,[])).then(()=>{const t=e(),r=Object(Qt.d)(t,n);if(r&&Object.keys(r).length>0){const e={};for(const a in r){const i=r[a];Ve(t,n,a,i)&&(e[a]=i)}return e}return null},t=>{const e=t.get_message();return r.EventManager.ReportComponentFailure(Vt.a+".CustomControl.retrieveChartDrilldownAttributes",new Error(e),e,[{name:"APIName",value:Vt.a+".Actions.RetrieveChartDrilldownAttributes"},{name:"Entity",value:n}]),null})}));var n},refreshDataSetParameter:(t,n)=>e(Ce(t,n)),retrieveLookupMetadataAction:t=>{return e((n=t,{type:"customcontrol.retrieveLookupMetaData.async",execute({dispatch:t,getState:e},r){if(n instanceof je.a){const r={retrieveGridDataAction:e=>t(Object(It.d)(e)),retrieveViewAction:(e,n,r,a)=>t(Object(jt.a)(e,n,r,a)),retrieveViewSelectorAction:(e,n)=>t(Object(jt.b)(e,n)),runPreSearch:(n,r,a)=>t(Object(dt.W)(Object(S.j)(e(),n),n,r,a)),runSetAdditionalParams:(n,r,a)=>t(Object(dt.X)(Object(S.j)(e(),n),n,r,a)),refreshCustomDataProviderAction:(e,n,r,a)=>t(Object(ae.b)(e,n,r,a)),getEntityMetadataAction:(e,n)=>t(Object(Ct.f)(e,!1,n))};return n.retrieveLookupMetadata(e,r)}}}));var n},retrieveDataSetLookupCellParameter:(t,n,r)=>e(function(t,e,n){return{type:"customcontrol.retrieveDataSetLookupCellParameter.async",execute:({dispatch:r,getState:a},i)=>r(Ce(e,n)).then(()=>{const n=e.retrieveDataSetObject(a(),t,i);return Promise.resolve(n)}).catch(t=>{i.EventManager.ReportComponentFailure(Vt.a+".Actions",{name:"error",message:t.get_message()},null,[{name:"APIName",value:Vt.a+".Actions.RetrieveDataSetLookupCellParameter"}])})}}(t,n,r)),updateControlMemoizedDataSet:(t,n,r)=>e(function(t,e,n){return{type:"customcontrol.updateControlMemoizedDataSet",sync:!0,execute({dispatch:r,getState:a},i){const s=a(),o=t.retrieveDataSetObject(s,null,null,null,i);t.linkToParameter(o,e),t.updateControlMemoizedParameter(s,o,!0,n)}}}(t,n,r)),loadResourceStrings:t=>{return e((n=t,{type:"customcontrol.loadresourcestrings.async",execute({dispatch:t,getState:e},r){const a=n.CustomControlId;if(!a)return Promise.resolve();const i=e(),s=Gt.a.getControlsResourceKeyList(a);if(!s)return Promise.resolve();const o=Object(Ut.d)(i);if(!o)return t(Object(Xt.e)(s));const c=[];for(const t of s)o.hasOwnProperty(t)||c.push(t);return 0===c.length?Promise.resolve():t(Object(Xt.e)(c))}}));var n},retrieveLookupData:t=>e(Object(It.d)(t)),setFieldControlPersonalization:(t,n,r)=>e(Object(Et.j)(t,n,r)),setGridControlPersonalization:(t,n,r)=>e(Object(Et.m)(t,n,r)),setDashboardControlPersonalization:(t,n,r)=>e(Object(Et.i)(t,n,r)),setGenericControlPersonalization:(t,n,r)=>e(Object(Et.k)(t,n,r)),setGlobalControlPersonalization:(t,n)=>e(Object(Et.l)(t,n)),setPowerBISignedInState:(t,n)=>e(Object(gt.b)(t,n)),beginSecureSessionForResource:(t,n,r,a)=>e(function(t,e,n,r){return{type:"customcontrol.beginsecuresessionforresource",execute(a,i){const s=new kt.a(i,a);return r?s.beginSecureSessionForResource(t,e,n):s.beginSecureSessionForResourceSilent(t,e,n)},shouldReceiveFullStore:!0}}(t,n,r,a)),setXrmObject:t=>{},addPendingCommandManagerId:(t,n,r,a)=>{let i;e(Object(Te.a)(t,n,r,a));return{promise:new Promise(t=>{i=t}),resolve:i}},initializeCommandManager:(t,n,r,a,i)=>{let s;e(Object(Te.b)(t,n,r,a,i));return{promise:new Promise(t=>{s=t}),resolve:s}},retrieveRecordCommand:(t,n,r,a,i,s,o,c,l,u)=>e(Object(Te.c)(u,t,n,r,a,i,s,o,c,l)),setValue:(t,n,r,a)=>t&&n?e(function(t,e,n,r){const a=[{name:"snapshotId",value:r},{name:"entityTypeName",value:e.etn},{name:"attributeNameValuePairs.length",value:n?Object.keys(n).length:null}];return{type:"control.update.value.by.snapshot.async",execute({dispatch:i,getState:s},o,c){const l=s(),u=Object(S.j)(l,t),d=Object(S.x)(u),p=Object(yt.a)(l,r,e,n,!1,u,o.TraceManager.getTracer("Forms.UpdateValue")),g=h.a.isNullOrEmpty(e.id)?vt.a.Create:vt.a.Update;if(a.push({name:"CorrelationId",value:c.correlationId},{name:"ContextId",value:c.contextId},{name:"ActionStack",value:c.stack},{name:"mode",value:g}),r)return i(Object(bt.b)(l,r,p)),o.EventManager.ReportComponentSuccess("Forms.UpdateValue.updateDataSnapshot",a),Promise.resolve();const m=Object(ft.b)(l,e,p,d,g),b=m.payload.snapshotId;return i(m),a.push({name:"newSnapshotId",value:b}),o.EventManager.ReportComponentSuccess("Forms.UpdateValue.createDataSnapshotAction",a),Promise.resolve(b)},getFailureParameters:(t,e)=>a}}(a,t,n,r)).then(t=>Promise.resolve(t||r)):Promise.reject("setValue: entityReference and controlKeyValuePairs parameters are required"),save:(t,n=[])=>e(Object(Tt.c)(t,!1,n)),openPopup:t=>e(Object(Y.a)(t)),closePopup:t=>e(Object(W.a)(t)),loadWebResource:(t,n)=>e(zt(t,n)),registerOngoingWork:(t,n,r,a)=>e(function(t,e,n,r){return{type:"customcontrol.registerworkoutstanding",execute:({dispatch:a,getState:i},s)=>(Ie.a.getInstance().addWorkOutstandingPromise(t,e,n,r),Promise.resolve())}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(t,n,r,a)),isPresenceEnabledEntity:t=>Object(H.b)(t),getPresenceMappedField:t=>Object(H.a)(t),fireXrmEvent:(t,n,r,a,i)=>{const s=e(Object(_t.b)(n,r));let o=null;if(s&&s.ui&&s.ui.controls&&(o=s.ui.controls.get(t)),o)switch(a){case 0:o.fireOnKeyPress&&o.fireOnKeyPress()}},sendLookupRequest:(t,n,r,a,i,s,o)=>e(We(t,!0,n,r,a,i,s,o)),runPreSearch:(t,n,r)=>{e(function(t,e,n){return{type:"CCF.RunPreSearch",execute({dispatch:r,getState:a}){r(Object(Se.f)(n,e,t)),r(Object(dt.W)(t,n,e)),r(Object(dt.X)(t,n,e)),r(Object(Se.e)(n,e,t))},sync:!0}}(t,n,r))},runOnReadyStateComplete:(t,n,r)=>{e(function(t,e,n){return{type:"CCF.RunOnReadyStateComplete",execute({dispatch:r,getState:a},i){i.ScriptManager.containerExists(e)&&r(i.ScriptManager.getContainer(e).getEventManager().runOnReadyStateComplete(t,null,n))},sync:!0}}(t,n,r))},retrieveLookupRecordsBySearchString:(t,n,r)=>e(Object(Je.a)(t,n,r)),retrieveLookupRecordsByIds:(t,n,r)=>e(Object(Je.b)(t,n,r))},t={actions:en,propBagMethods:{utils:tn,navigation:r,device:$e,mode:Ze}},t}}))(s.a);class ln extends i.Component{constructor(t,e){super(t),this._updateCounter=0,this._isUpdateScheduled=!1,this._reRunMapStateToProps=()=>{this._isUpdateScheduled||(this._isUpdateScheduled=!0,Object(on.c)(()=>{this._isUpdateScheduled=!1,this._updateCounter++,this.forceUpdate()}))},this._reRunMapStateToProps=this._reRunMapStateToProps.bind(this)}render(){let t=null,e=null;return this.context&&this.context.CustomControlGlobalHelper&&(t=this.context.CustomControlGlobalHelper,e=this.context.TraceManager.getLogLevel()),i.createElement(o.a.Provider,{value:this.context},i.createElement(cn,Object.assign({},this.props,{contextHelper:t,logLevel:e,updateCounter:this._updateCounter,reRunMapStateMainProps:this._reRunMapStateToProps})))}}function un(t){const e="cm"+Object(an.a)();return i.createElement(rn.a,{commandbarDisplayMode:t.commandbarDisplayMode,addedCommandList:t.addedCommandList,key:t.key,iconPosition:t.iconPosition,id:t.id,commandManagerId:t.commandManagerId||e,ribbonId:t.ribbonId,selectedRecords:t.selectedRecords,width:t.width,metaDataLoadedResolve:t.metaDataLoadedResolve,isHidden:t.isHidden,commandBarStyle:t.commandBarStyle,customCommandManagerStyle:t.customCommandManagerStyle,contextToken:t.contextToken,rootZIndex:t.rootZIndex,customControlType:t.customControlType})}function dn(t){return{commandbarDisplayMode:void 0!==t.commandbarDisplayMode&&null!==t.commandbarDisplayMode?t.commandbarDisplayMode:sn.a.IconLabel,id:t.id,commandManagerId:t.commandManagerId,ribbonId:t.ribbonId,mainMenuLength:t.mainMenuLength,iconPosition:t.iconPosition,selectedRecords:pn(t.selectedRecords),key:t.key,commandBarStyle:t.commandBarStyle,customCommandManagerStyle:t.customCommandManagerStyle,isHidden:t.isHidden,width:t.width,metaDataLoadedResolve:t.metaDataLoadedResolve,addedCommandList:t.addedCommandList,contextToken:t.contextToken,rootZIndex:t.rootZIndex,customControlType:t.customControlType}}function pn(t){const e=[];if(t)for(const n of t)e.push(Le(n));return e}function hn(t,e){if(t===e)return!0;if(t&&e&&t.length===e.length){const n=t.length;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}ln.contextType=a.a},"23K5":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a{generate(t,e){if(!e||!e.getProcessId())return null;return{businessProcessFlowInstanceId:e.getProcessInstanceId(),activeStageId:r.a.tryParseOrNull(e.getActiveStageId()),displayState:e.getDisplayState(),processState:e.getProcessState(),state:e.getState(),status:e.getStatus(),isVisible:e.isVisible(),data:{activePath:e.getActivePath(),selectedStageId:r.a.tryParseOrNull(e.getSelectedStageId()),businessProcessFlowId:e.getProcessId(),actionLogCollection:e.getActionLogCollection(),processNavigationBehavior:{navigationBehavior:e.getBpfNavigationBehavior()}}}}}},"3MuQ":function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="section.label";function i(t,e,n,i){const s=Object(r.v)(e);return{type:a,payload:i,meta:{pageId:t,contextKey:s,sectionName:n}}}},"3c9R":function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return d}));var r=n("jRy5"),a=n("dHD5"),i=n("i1f0"),s=n("mIxf"),o=n("bT7G"),c=n("arV0"),l=n("ApeL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const u="attribute.precision";function d(t,e,n,d){return{type:"attribute.precision.update",sync:!0,execute({dispatch:p,getState:h},g){let m=h();p(function(t,e,n,i){if(e&&e.contextTokenType&&e.contextTokenType===r.a.GridRow)return Object(l.e)(t,e,n,i);const s=Object(a.x)(e);return{type:u,payload:i,meta:{pageId:t,contextKey:s,dataFieldName:n}}}(t,e,n,d)),m=h();let b=null,f=null,y=null,v=null;if(e&&e.contextTokenType&&e.contextTokenType===r.a.GridRow)b=e.entityTypeName?e.entityTypeName:null,f=e.recordId?e.recordId:null,y=Object(a.t)(e),v=Object(a.r)(e);else{const n=Object(c.g)(m,t);b=n&&n.entityTypeName?n.entityTypeName:null,f=n&&n.id?n.id:null,y=null,v=e}const _=Object(i.ac)(m,t,e),S=Object(o.d)(m,_,{etn:b,id:f},n),O={[n]:S};p(Object(s.a)(t,O,!0,!0,b,f?f.guid:null,y,v))}}}},"49Nd":function(t,e,n){"use strict";n.d(e,"g",(function(){return r})),n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return o})),n.d(e,"f",(function(){return c})),n.d(e,"e",(function(){return l})),n.d(e,"j",(function(){return u})),n.d(e,"h",(function(){return d})),n.d(e,"i",(function(){return p})),n.d(e,"k",(function(){return h}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Grid_Paging_Mask",a="Grid_StatusMessage_Mask",i="Grid_ItemsSelected_Mask",s="Grid_TotalCount_Mask",o="Grid_ToolTip_FirstPage",c="Grid_ToolTip_PreviousPage",l="Grid_ToolTip_NextPage",u="Grid_TotalCount_SpaceMask",d="Grid_TotalCount_Approximate",p="Grid_TotalCount_Exact",h=[r,a,i,s,o,c,l,u,d,p]},"4U8P":function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="header.commandbarvisible";function i(t,e,n){const i=Object(r.v)(e);return{type:a,payload:n,meta:{pageId:t,contextKey:i}}}},"4XwW":function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="form.setSelectedFormId";function a(t,e){return{type:r,payload:{formId:e},meta:{pageId:t}}}},"4rWj":function(t,e,n){"use strict";n.d(e,"a",(function(){return le}));var r=n("c/eZ"),a=n("OWbt"),i=n("SAYH"),s=n("dMZy"),o=n("TYIz"),c=n("mhYf"),l=n("PbI6"),u=n("FHmp"),d=n("2YQW");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const p=Object(d.d)({[o.a]:function(t,e){return Object.assign(Object.assign({},t),{collapsed:e.payload})},[c.a]:function(t,e){return Object.assign(Object.assign({},t),{visible:e.payload})},[l.a]:function(t,e){return Object.assign(Object.assign({},t),{contentType:e.payload})},[u.a]:function(t,e){return Object.assign(Object.assign({},t),{label:e.payload})}},{collapsed:!1,visible:!0,label:"",sectionNames:[],domId:null,showLabel:!0,contentType:"cardSections"});var h=n("vlcQ"),g=n("3MuQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const m=Object(d.d)({[h.a]:function(t,e){return Object.assign(Object.assign({},t),{visible:e.payload})},[g.a]:function(t,e){return Object.assign(Object.assign({},t),{label:e.payload})}},{parentTabId:null,visible:!0,label:"",controlNames:[],domId:null,semanticZoomDomId:null});var b=n("lju1"),f=n("e3W2"),y=n("ZMWz"),v=n("Zpd/"),_=n("hA8P"),S=n("yl9a"),O=n("/5se"),C=n("Khp3"),I=n("xorU"),P=n("BoVI"),j=n("TsER");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const T=Object(d.d)({[f.a]:function(t,e){return Object.assign(Object.assign({},t),{visible:e.payload})},[y.a]:function(t,e){return Object.assign(Object.assign({},t),{label:e.payload,labelSource:b.a.ClientAPI})},[v.a]:function(t,e){return null!==e.payload?Object.assign(Object.assign({},t),{disabledByClientApi:e.payload}):t},[S.a]:function(t,e){const n=Object.assign(Object.assign({},t.parameters),e.payload);return Object.assign(Object.assign({},t),{parameters:n})},[O.a]:function(t,e){const n=Object.assign(Object.assign({},t.parameters),{defaultviewid:e.payload});return Object.assign(Object.assign({},t),{parameters:n})},[P.a]:function(t,e){const n=Object.assign(Object.assign({},t.views),e.payload.views);return Object.assign(Object.assign({},t),{views:n})},[I.a]:function(t,e){const n=t.customFilter?t.customFilter:[];for(let r=n.length-1;r>=0;r--)if(n[r].entityLogicalName===e.payload.entityLogicalName){if(n[r].customFilter===e.payload.customFilter)return t;break}return n.push(e.payload),Object.assign(Object.assign({},t),{customFilter:n})},[I.c]:function(t,e){const n=[];return n.push({customFilter:"START_FLAG",entityLogicalName:""}),Object.assign(Object.assign({},t),{customFilter:n})},[I.b]:function(t,e){const n=t.customFilter?t.customFilter:[];if(n.length>0&&"END_FLAG"===n[n.length-1].customFilter)return t;return n.push({customFilter:"END_FLAG",entityLogicalName:""}),Object.assign(Object.assign({},t),{customFilter:n})},[C.a]:function(t,e){if(e.payload)return Object.assign(Object.assign({},t),{notifications:Object.assign(Object.assign({},t.notifications),e.payload)});return Object.assign(Object.assign({},t),{notifications:e.payload})},[_.a]:function(t,e){const n=[].concat(t.parameters);let r=t;null!==e.payload&&(n.DisableMru=e.payload?"true":"false",r=Object.assign(Object.assign({},r),{parameters:n}));return r},[j.a]:
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(t,e){return Object.assign({},t)},[P.d]:function(t,e){return Object.assign(Object.assign({},t),{initializationIntent:e.payload})}},{parentSectionName:null,visible:!0,label:"",valid:!0,domId:null,notifications:null,dataFieldName:null});var E=n("Qn2w");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function F(t,e,n){const r=Object.assign({},t),a=Object.keys(r).length,i={};return n?(r.hasOwnProperty(e)&&delete r[e],Object.assign({},r)):a>0?r.hasOwnProperty(e)?r:(i[e]=!0,Object.assign(Object.assign({},t),i)):(i[e]=!0,i)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const w=Object(d.d)({[E.a]:function(t,e){return Object.assign({},F(t,e.meta.controlName,e.payload.isValid))}},{});var x=n("Bo7t"),A=n("Tg1Y"),N=n("+Ajx"),k=n("ofgb"),D=n("1HWW"),M=n("9NSo"),R=n("+hq9"),L=n("Q1Tc");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const V=Object(d.d)({[L.a]:function(t,e){return Object.assign({},e.payload.controlUnboundOutputs)}},{});var B=n("lxh6"),G=n("Y5AI"),X=n("MgYC"),U=n("3HPu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const q=Object(d.d)({[U.a]:function(t,e){return Object.assign({},F(t,e.meta.attributeName,e.payload.isValid))}},{});var z=n("FhIR"),H=n("NtHU"),W=n("4U8P"),Y=n("m+2h");const K={tabs:Object(d.b)("tabId",p),sections:Object(d.b)("sectionName",m),controls:Object(d.b)("controlName",T),selectedTab:function(t=Object(s.a)(),e){if(e.type===A.a){if(t.navigationStack&&t.navigationStack.length>0)return Object.assign(Object.assign({},t),{tabId:t.navigationStack[t.navigationStack.length-1],navigationStack:t.navigationStack.slice(0,t.navigationStack.length-1)})}else if(e.type===x.a){const n=(t.navigationStack||[]).slice(0);return t.tabId&&t.tabId!==e.payload&&n.push(t.tabId),Object.assign(Object.assign({},t),{tabId:e.payload,navigationStack:n})}return t},selectedRelatedEntity:function(t=null,e){return e.type===N.a?e.payload:t},xrmReady:function(t=!1,e){return e.type===a.b?e.payload.xrmReady:t},isSaving:function(t=!1,e){return e.type===k.a?e.payload.savingState:t},controlUnboundOutputs:V,inlineQuickForms:function(t=null,e){return e.type===a.a?e.payload.formUIState.inlineQuickForms:t},invalidControls:w,invalidAttributes:q,label:function(t="",e){return e.type===M.a?e.payload.label:t},hasOfflineChanges:function(t=!1,e){return e.type===D.a?e.payload.hasOfflineChanges:t},viewportWidth:function(t=0,e){return e.type===B.a?e.payload.viewportWidth:t},viewportHeight:function(t=0,e){return e.type===B.a?e.payload.viewportHeight:t},formId:function(t=i.a.EMPTY,e){return t},showHeaderFieldsInSection:function(t=!1,e){return e.type===G.a?e.payload.showHeaderFieldsInSection:t},headerFieldsInFlyout:function(t,e){if(e.type===X.a){const t=new Set,n=e.payload.headerFieldsInFlyout;for(let e=0;e<n.length;e++)t.add(n[e].Name);return t}return t},isAutoSaving:function(t=!1,e){return e.type===R.a?e.payload.isAutoSaving:t},header:function(t=null,e){switch(null==t&&(t={bodyVisible:!0,commandBarVisible:!0,tabNavigatorVisible:!0}),e.type){case H.a:return Object.assign(Object.assign({},t),{bodyVisible:e.payload});case W.a:return Object.assign(Object.assign({},t),{commandBarVisible:e.payload});case z.a:return Object.assign(Object.assign({},t),{tabNavigatorVisible:e.payload})}return t},footer:function(t=null,e){switch(null==t&&(t={visible:!0}),e.type){case Y.a:return Object.assign(Object.assign({},t),{visible:e.payload})}return t},formScrollAndFocusState:function(t,e){return e.type===P.e?e.payload:t}},Q=Object(d.a)(K),J=Object(d.b)("contextKey",Q);var Z=n("0bz+"),$=n("4UCL"),tt=n("WKRf");const et={snapshotId:Z.a,updatedFields:
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(t,e){if(e.type===$.a){const n={},r=e.payload.fieldValues;if(!r)return t;for(const e in r)t&&t.hasOwnProperty(e)||(n[e]=r[e]);return Object.keys(n).length>0?Object.assign(Object.assign({},t),n):t}if(e.type===$.b){const n={};if(e.payload.keepFields)for(const r of e.payload.keepFields)t[r]&&(n[r]=t[r]);return n}return t},isDeleted:function(t=!1,e){return e.type===tt.a?e.payload:t}},nt=Object(d.a)(et),rt=Object(d.b)("contextKey",nt);var at=n("3c9R"),it=n("mlKL"),st=n("cf3Y"),ot=n("/q65"),ct=n("91Ew"),lt=n("KnyI"),ut=n("tvJg"),dt=n("TAgK"),pt=n("RREX"),ht=n("z5LE");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const gt=Object(d.d)({[at.a]:function(t,e){return Object.assign(Object.assign({},t),{Precision:e.payload,PrecisionSource:pt.a.attribute})},[it.a]:function(t,e){return Object.assign(Object.assign({},t),{RequiredLevel:e.payload})},[st.a]:function(t,e){return Object.assign(Object.assign({},t),{Format:e.payload})},[ot.a]:function(t,e){return Object.assign(Object.assign({},t),{Targets:e.payload})},[ct.a]:function(t,e){let n=t.OptionSet;const r=e.payload.option;if(!n||!r)return t;const a=e.payload.index;n=n.slice(0),a>=0&&a<n.length?n.splice(a,0,r):n.push(r);return Object.assign(Object.assign({},t),{OptionSet:n})},[lt.a]:function(t,e){let n=t.OptionSet;if(!n)return t;const r=e.payload;let a;n=n.slice(0);for(let e=0;e<n.length;e++)if(a=n[e],a.Value===r)return n.splice(e,1),Object.assign(Object.assign({},t),{OptionSet:n});return t},[ut.a]:function(t,e){if(!t.OptionSet)return t;return Object.assign(Object.assign({},t),{OptionSet:[]})},[dt.a]:function(t,e){if(!t.OptionSet)return t;const n=e.payload;return Object.assign(Object.assign({},t),{OptionSet:n||[]})},[ht.a]:function(t,e){if(e.payload)return Object.assign(Object.assign({},t),{notifications:Object.assign(Object.assign({},t.notifications),e.payload)});return Object.assign(Object.assign({},t),{notifications:e.payload})}},{Precision:null,PrecisionSource:null,RequiredLevel:null,Format:null,OptionSet:null,IsValidForCreate:null,IsValidForUpdate:null,notifications:null,Targets:null});var mt=n("BvQu"),bt=n("LLfG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ft=Object(d.d)({[bt.a]:function(t,e){if(e.payload===mt.a.Dirty){const n={};if(e.meta.dataFieldName&&Object.keys(t).lastIndexOf(e.meta.dataFieldName)>-1){for(const r of Object.keys(t))r!==e.meta.dataFieldName&&(n[r]=t[r]);return Object.freeze(n)}return t}return Object.assign(Object.assign({},t),{[e.meta.dataFieldName]:e.payload})}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},{});const yt={attributes:Object(d.b)("dataFieldName",gt),submitModes:ft},vt=Object(d.a)(yt),_t=Object(d.b)("contextKey",vt);var St=n("+aj2"),Ot=n("NDmk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Ct=Object(d.d)({[St.a]:function(t,e){return Object.assign(Object.assign({},t),{value:e.payload.value})},[Ot.a]:function(t,e){return Object.assign(Object.assign({},t),{value:e.payload.value})}},{reason:"",value:""});var It=n("f/sd"),Pt=n("SVnG"),jt=n("GodX"),Tt=n("N+Ya"),Et=n("dIqG"),Ft=n("hK10");const wt=Object(d.d)({[Tt.a]:function(t,e){const n=Object.assign({},t);return xt(n,e.payload.label,e.payload.currentLanguageId),n.labelSetByClientAPI=!0,Object.freeze(n)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */,[Et.a]:function(t,e){const n=e.payload;return Object.freeze(Object.assign(Object.assign(Object.assign({},t),n),{showSetByClientAPI:!0}))}},{titles:{},tooltipTitles:{},privileges:[],relationshipName:"",id:"",area:"",titleResourceId:"",client:"",availableOffline:!1,icon:"",sequence:"",show:!0,viewId:""});function xt(t,e,n){const r=Object(Ft.b)(t,n);if(r)r.Value=e;else{const r=null===n?"":n.toString();t.titles[""]={Name:r,Value:e}}return t}const At=Object(d.d)({},{}),Nt=Object(d.d)({},{}),kt=Object(d.d)({},{});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Dt=n("dtbk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Mt=Object(d.b)("navigationItemId",wt);const Rt={navBarAreas:At,navPaneIsvItems:Nt,navBarByRelationshipItems:function(t,e){if(e.type===Dt.a){if(e.payload.allNavBarByRelationshipItems&&e.payload.allNavBarByRelationshipItems.length>0){const n=Object.assign({},t);return e.payload.allNavBarByRelationshipItems.forEach(t=>{t&&t.id&&(n[t.id]||(n[t.id]=Object.assign(Object.assign({},{titles:{},tooltipTitles:{},privileges:[],relationshipName:"",id:"",area:"",titleResourceId:"",client:"",availableOffline:!1,icon:"",sequence:"",show:!0,viewId:""}),{id:t.id})),xt(n[t.id],t.title,e.payload.currentLanguageId))}),Object.freeze(n)}return t}return Mt(t,e)},navBarItems:kt},Lt=Object(d.a)(Rt);var Vt=n("Bj/n"),Bt=n("jTSi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Gt=Object(d.d)({[Vt.a]:function(t,e){const n={Message:e.payload.message,Level:e.payload.level,UniqueId:e.payload.uniqueId,Buttons:e.payload.buttons,MessagePlaceholders:e.payload.placeholders,ControlName:e.payload.controlName,ComponentId:e.payload.componentId};return Object.assign(Object.assign({},t),{[e.payload.uniqueId]:n})},[Bt.a]:function(t,e){if(Object.keys(t).length<1)return t;const n={};if(e.payload.uniqueId)for(const r of Object.keys(t))r!==e.payload.uniqueId&&(n[r]=t[r]);return n}},{});var Xt=n("jR7L"),Ut=n("TD3W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const qt=Object(d.d)({[Xt.a]:function(t,e){if(e.type===Xt.a)return Object.assign(Object.assign({},t),e.payload);return t},[Ut.a]:function(t,e){const n=Object.assign({},t);return delete n[e.payload.relationship],Object.freeze(n)}},{});var zt=n("MktZ"),Ht=n("uPT+"),Wt=n("LAcd"),Yt=n("rdSB"),Kt=n("+Vem"),Qt=n("iHOm"),Jt=n("6Qf/"),Zt=n("jRy5"),$t=n("dHD5"),te=n("59++"),ee=n("QiMq"),ne=n("9wSR"),re=n("7TDv");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ae={selectedFormId:null,forms:{}};var ie=n("gDO8"),se=n("XlXz");var oe=n("4XwW");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const ce=Object(d.a)({loadingState:function(t=It.a.Initial,e){return e.type===zt.a?e.payload:t},formId:function(t=null,e){return e.type===a.a?e.payload.formId:t},navigation:Lt,notifications:Gt,powerBISignedInState:function(t="NotSignedIn",e){return e.type===Ht.a?e.payload:t},suppressDuplicateDetection:function(t=!1,e){return e.type===Wt.a?e.payload.suppressDuplicateDetection:t},customDataProviderOutputs:Pt.a,formlessControlOutputs:jt.a,output:Ct,datasets:Qt.a,metadata:_t,records:rt,forms:J,entityReferenceByRelationship:qt,referenceInformationByRelationship:function(t={},e){return e.type===Kt.a?e.payload:t},primaryEntity:function(t="",e){return"set.primary.entity"===e.type?e.payload:t},visitedTabNames:function(t=null,e){if(e.type===ee.a){const n=e.payload;if(!t)return n?new Set([n]):null;if(!n||t.has(n))return new Set(t);const r=new Set(t);return r.add(n),r}return t},autoSaveInterval:function(t=ne.a,e){return e.type===ne.d?t=ne.a:e.type===ne.b&&t<ne.c&&(t+=ne.a),t},formInstances:function(t={list:[],formInstanceIdByControlName:{},controlNameByFormInstanceId:{}},e){if(e.type===P.b){const n=e.payload.formInstanceId,r=e.payload.controlName,a=[...t.list,n],i=Object.assign(Object.assign({},t.formInstanceIdByControlName),{[r]:n}),s=Object.assign(Object.assign({},t.controlNameByFormInstanceId),{[n]:r});t=Object.assign(Object.assign({},t),{list:a,formInstanceIdByControlName:i,controlNameByFormInstanceId:s})}else if(e.type===P.g){const n=e.payload.formInstanceId,a=e.payload.controlName,i=t.list.filter(t=>t!==n);if(t.formInstanceIdByControlName[a]&&t.controlNameByFormInstanceId[n]){const e=a,s=t.formInstanceIdByControlName,o=e,c=(s[o],Object(r.__rest)(s,["symbol"==typeof o?o:o+""])),l=n,u=t.controlNameByFormInstanceId,d=l,p=(u[d],Object(r.__rest)(u,["symbol"==typeof d?d:d+""]));t=Object.assign(Object.assign({},t),{list:i,formInstanceIdByControlName:c,controlNameByFormInstanceId:p})}}return t},formSelector:function(t=ae,e){return e.type===re.a?Object.assign(Object.assign({},t),{forms:Object.assign(Object.assign({},t.forms),{[e.meta.formId]:{visible:e.payload.visible}})}):e.type===oe.a?Object.assign(Object.assign({},t),{selectedFormId:e.payload.formId}):t},parentComponentId:function(t="",e){return e.type===P.c?e.payload.parentComponentId:t},referencePanel:function(t={sessionTabs:[],controlNames:[],activeTabId:"",messageId:""},e){switch(e.type){case se.a:return e.payload.messageId?Object.freeze(Object.assign(Object.assign({},t),{sessionTabs:e.payload.sessionTabs,activeTabId:e.payload.activeTabId,messageId:e.payload.messageId})):Object.freeze(Object.assign(Object.assign({},t),{sessionTabs:e.payload.sessionTabs,activeTabId:e.payload.activeTabId}));case se.d:case se.c:return Object.freeze(Object.assign(Object.assign({},t),{sessionTabs:e.payload.sessionTabs,activeTabId:e.payload.activeTabId}));case se.e:return Object.freeze(Object.assign(Object.assign({},t),{messageId:e.payload.messageId}));case se.g:return Object.freeze(Object.assign(Object.assign({},t),{sessionTabs:e.payload.sessionTabs,controlNames:e.payload.controlNames,activeTabId:e.payload.activeTabId}));case se.f:return Object.freeze(Object.assign(Object.assign({},t),{controlNames:e.payload.controlNames,activeTabId:e.payload.activeTabId}));case se.b:return Object.freeze({sessionTabs:[],controlNames:[],activeTabId:"",messageId:""});case se.h:return Object.freeze(Object.assign(Object.assign({},t),{sessionTabs:e.payload.sessionTabs}));default:return t}},formLoadError:function(t=null,e){return e.type===ie.a?e.payload.error:t}});function le(t,e){if(void 0===t){const n=ce(t,e);return Object.freeze(n)}let n;if(e.type===a.a){const r=e.meta.contextToken,a=Object($t.v)(r),i=ue(a),s="NotSignedIn",o=!1,c=t.forms[a];let l=t.metadata;e.payload.relatedEntityMetadataState&&(l=Object.assign({},l,e.payload.relatedEntityMetadataState));const u=Object.assign(Object.assign({},t.forms),{[a]:Object.assign(Object.assign({},c),e.payload.formUIState)});l=Object.assign(Object.assign({},l),{[a]:Object.assign(Object.assign({},l[a]),e.payload.formMetadataState)});const d=Object.assign(Object.assign({},t.navigation),u&&r.contextTokenType===Zt.a.MainForm?u[a].navigation:t.navigation);if(d.navBarByRelationshipItems){const t=d.navBarByRelationshipItems;d.navBarByRelationshipItems={};const n=Object.keys(t);for(let r=0;r<n.length;r++){const a=n[r];d.navBarByRelationshipItems[a]=Object(Ft.a)(t[a],e.payload.currentLanguageId)}}n=Object.assign(Object.assign({},t),{formId:e.payload.formId,forms:u,metadata:l,records:i,powerBISignedInState:s,suppressDuplicateDetection:o,navigation:d})}else if(e.type===Yt.a&&t.metadata[e.meta.contextKey]){const r=t.metadata[e.meta.contextKey];n=Object.assign(Object.assign({},t),{metadata:Object.assign(Object.assign({},t.metadata),{[e.meta.contextKey]:Object.assign(Object.assign({},r),{attributes:Object.assign(Object.assign({},null==r?void 0:r.attributes),e.payload.attributes)})})})}else if(e.type===Yt.b){const r=t.forms[e.meta.contextKey];n=Object.assign(Object.assign({},t),{forms:Object.assign(Object.assign({},t.forms),{[e.meta.contextKey]:Object.assign(Object.assign({},r),{controls:Object.assign(Object.assign({},t.forms[e.meta.contextKey].controls),e.payload.controls)})})})}else if(e.type===Jt.a){const r=e.payload,a=Object.assign(Object.assign({},t.datasets),{[r.contextKey]:r.initialDataSetState});n=Object.assign(Object.assign({},t),{datasets:a})}else if(e.type===te.a){const r=e.meta.contextToken,a=Object($t.v)(r),i=t.forms[a],s=Object.assign({},i),o=i.selectedTab.tabId;if(!e.payload.formUIState.tabs[o]){const t=i.tabs[o];if(t){const n=t.domId;let r;for(const t in e.payload.formUIState.tabs){if(e.payload.formUIState.tabs[t].domId===n){r=t;break}}i.selectedTab.tabId=r||""}}s.controls=e.payload.formUIState.controls,s.sections=e.payload.formUIState.sections,s.tabs=e.payload.formUIState.tabs,s.label=e.payload.formUIState.label,s.inlineQuickForms=e.payload.formUIState.inlineQuickForms,n=Object.assign(Object.assign({},t),{forms:Object.assign(Object.assign({},t.forms),{[a]:s})})}else if(e.type===P.h){const r=e.meta.contextToken,a=ue(Object($t.v)(r));n=Object.assign(Object.assign({},t),{records:a})}else n=ce(t,e);return Object.freeze(n)}function ue(t){return{[t]:{snapshotId:"",isDeleted:!1}}}},"53SR":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("SAYH"),a=n("Kvn0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(t,e){const n={dataById:{[r.a.toString(e.id)]:t}};return{type:a.a,payload:n}}},"59++":function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return i}));var r=n("y60j"),a=n("OWbt");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="form.ui.metadata.update";function s(t,e,n){return{type:"form.ui.metadata.update.async",execute({dispatch:s,getState:o},c,l){const u=o(),d=Object(r.j)(u,t),p=Object(a.g)(u,d,t);return s(function(t,e,n,r){return{type:i,payload:{formId:t,formUIState:e},meta:{pageId:n,contextToken:r}}}(t,p,e,n)),Promise.resolve()}}}},"5UPV":function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="dataset.set.newPageRequested";function i(t,e,n){const i=Object(r.y)(e),s=Object(r.v)(e);return{type:a,payload:n,meta:{pageId:t,contextKey:i,dataSetContextKey:s}}}},"5iTp":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(t,e,n){const a=Object(r.cb)(t,e,n);return a?a.footer:null}},"6Qf/":function(t,e,n){"use strict";n.d(e,"f",(function(){return g})),n.d(e,"d",(function(){return m})),n.d(e,"e",(function(){return y})),n.d(e,"a",(function(){return p})),n.d(e,"b",(function(){return h})),n.d(e,"c",(function(){return f}));var r=n("SAYH"),a=n("dHD5"),i=n("BFlg"),s=n("ZJsz"),o=n("P6DH"),c=n("3/02"),l=n("Lyxw"),u=n("ujVH"),d=n("jAuy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const p="grid.initialize",h="grid.initialize.xrmready";function g(t,e,n){return{type:"grid.preinitialize.sync",sync:!0,execute({dispatch:r,getState:a},s){const o=i.x+".gridPreInitializedAction";try{r(b(null,t,e,n,void 0,void 0,void 0,void 0,null));const a=[{name:"entityTypeName",value:t}];return s.EventManager.ReportComponentSuccess(o,a),Promise.resolve(void 0)}catch(e){const n="Failed for "+t+" with error "+e.message;return s.EventManager.ReportComponentFailure(o,Error(n)),Promise.resolve(void 0)}}}}function m(t,e,n,r,a,d,p,h,g){return t?{type:"grid.initialize.async",execute({dispatch:m,getState:f},y){const v=i.x+".gridInitializedAction";try{let i=null;Object(l.c)(f(),c.zb)&&(i=function(t,e,n){const r=Object(o.v)(t,e,n),a=Object.assign({},s.a);return r&&(r.filters&&(a.filters=r.filters),r.customFilter&&(a.customFilter=r.customFilter),r.pageNumber&&(a.pageNumber=r.pageNumber),r.pagingRefreshInput&&(a.pagingRefreshInput=r.pagingRefreshInput)),a}(f(),n,r)),m(b(t,e,n,r,a,d,p,h,i,g));const _=[];_.push({name:"entityTypeName",value:e}),y.EventManager.ReportComponentSuccess(v,_);return Object(l.c)(f(),c.L)&&m(Object(u.b)(n,r)),Promise.resolve(void 0)}catch(t){const n="Grid initialized failed for entity type "+e;return y.EventManager.ReportComponentFailure(v,Error(n)),Promise.reject(void 0)}}}:null}function b(t,e,n,o,c,l,u,h,g,m){const b=c&&c.Parameters?c.Parameters[i.j]:null;try{let c=!0;b&&(c="true"===b);const f=Object(a.u)(o),y={contextKey:f,initialDataSetState:Object.assign(Object.assign(Object.assign({},s.a),g),{viewId:t?t.viewId:null,fetchXml:t?t.fetchXml:null,relationshipName:l,relationshipRoleOrdinal:u,useRollupView:h||!1,commandManagerId:m||Object(d.d)(n,o),controls:{homepageGrid:{parameters:{0:{Name:i.C,Value:t&&t.viewId?r.a.toString(t.viewId):null},1:{Name:i.j,Value:c},2:{Name:i.u,Value:e}}}}})};return{type:p,payload:y,meta:{pageId:n,contextKey:f}}}catch(t){throw Error(t)}}function f(t,e,n,o){const c=Object(a.u)(o),l=r.a.tryParseOrNull(e),u={contextKey:c,initialDataSetState:Object.assign(Object.assign({},s.a),{viewId:l||null,fetchXml:null,commandManagerId:Object(d.d)(n,o),controls:{homepageGrid:{parameters:{0:{Name:i.C,Value:e||null},1:{Name:i.j,Value:!1},2:{Name:i.u,Value:t}}}}})};return{type:p,payload:u,meta:{pageId:n,contextKey:c}}}function y(t,e,n,r){return e(t.ScriptManager.getContainer(r).getEventManager().loadGridScripts(n,r))}},"7+p5":function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n("Lyxw"),a=n("3/02"),i=n("IqkD");function s(t){if(Object(r.a)(t,a.S,a.h)){return!!Object(r.a)(t,a.d,a.Lc)||1033===Object(i.s)(t)}return!1}},"7TDv":function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="formSelector.visible";function a(t,e,n){return{type:r,payload:{visible:n},meta:{pageId:t,formId:e}}}},"7k+e":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return o}));var r=n("dHD5"),a=n("BFlg");const i="chart.drilldownparameters.update",s="ChartDrillDownParameters";function o(t,e,n){return{type:"chart.drilldownparameters.update.async",execute({dispatch:o,getState:c},l){const u=l.TraceManager.getTracer(a.z),d=a.x+".updateChartDrillDownParametersAction";try{u.info("Updating the chart drilldown parameters"),e||(e=Object(r.k)(c(),t));const a=Object(r.v)(e);return o(function(t,e,n){return{type:i,payload:{name:s,value:n},meta:{pageId:t,dataSetContextKey:e}}}(t,a,n)),l.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(t){const e="Updatation of the chart drilldown parameters failed with error : "+t.message;l.EventManager.ReportComponentFailure(d,Error(e))}}}}},"7p56":function(t,e,n){"use strict";n.d(e,"a",(function(){return ze}));var r=n("nuS9"),a=n("4fxQ"),i=n("D9ys"),s=n("u+q+"),o=n("YWpA"),c=n("hPFj"),l=n("H/hG"),u=n("e9UD"),d=n("znb3"),p=n("223Y"),h=n("VnpK"),g=n("POU9"),m=n("vP/5"),b=n("sclX"),f=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const y=2/(1+Math.sqrt(5));class v extends r.Component{constructor(t){super(t),this._memorizedDescriptor=null,this.onMeasuring=this.onMeasuring.bind(this),this.state={width:0,height:0}}_getGoldenRatioHeight(t){return y*t}onMeasuring(t,e){let n=!1;const r={};t!==this.state.width&&(r.width=t,n=!0),e!==this.state.height&&(r.height=e,n=!0),n&&this.setState(r)}render(){const t=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(f.z):null;if(!this.props||!this.props.showChart||!this.props.configuration)return t&&t.info("Chart not rendered because the configuration is missing or show chart is set to false"),null;this._memorizedDescriptor&&this.props.chartId===this._memorizedDescriptor.Id||(this._memorizedDescriptor={Id:this.props.chartId,Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1});const e=parseFloat(getComputedStyle(document.documentElement).fontSize),n=this._getTopAndBottomAdjustment(e),a=this._getLeftAndRightAdjustment(e);let i,s;this.props.isLayoutVertical?(i=this.state.width-a,s=this._getGoldenRatioHeight(i),this.props.style.minHeight=s+n):(i=Math.max(this.state.width,320)-a,s=this.state.height-n);const c={minWidth:i.toString()+"px",minHeight:s.toString()+"px"},l={width:i>0?i:-1,height:s>0?s:-1,eventListeners:[{eventname:"onChartPaneClose",eventhandler:[this._closeChartPane.bind(this)]}]};return r.createElement(o.a,{key:"pageChart_"+this.props.id,testhooks:{id:"pageChart_"+this.props.id},style:this.props.style,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0},r.createElement(o.a,{key:"pageChart_"+this.props.id+"_container",style:c},r.createElement(p.c,{key:this.props.chartId,controlId:this.props.chartId,id:this.props.id,configuration:this.props.configuration,descriptor:this._memorizedDescriptor,parentDefinedControlProps:l,parentContextToken:this.props.contextToken})))}_closeChartPane(){this.props.closeChartPaneHandler(this.props.id,this.props.contextToken,!1)}_getTopAndBottomAdjustment(t){let e=0;return this.props.style.borderTopWidth&&(e+=t*("string"==typeof this.props.style.borderTopWidth?parseFloat(this.props.style.borderTopWidth||"0px"):this.props.style.borderTopWidth)),this.props.style.paddingTop&&(e+=t*("string"==typeof this.props.style.paddingTop?parseFloat(this.props.style.paddingTop||"0px"):this.props.style.paddingTop)),this.props.style.borderTop&&(e+=1),this.props.style.borderBottom&&(e+=1),e}_getLeftAndRightAdjustment(t){let e=0;return this.props.style.paddingLeft&&(e+=t*("string"==typeof this.props.style.paddingLeft?parseFloat(this.props.style.paddingLeft||"0px"):this.props.style.paddingLeft)),this.props.style.paddingRight&&(e+=t*("string"==typeof this.props.style.paddingRight?parseFloat(this.props.style.paddingRight||"0px"):this.props.style.paddingRight)),this.props.style.borderLeft&&(e+=1),this.props.style.borderRight&&(e+=1),e}}var _=n("SAYH"),S=n("ah4O"),O=n("KBcj"),C=n("d0w6"),I=n("iWfp"),P=n("XvLr"),j=n("P6DH"),T=n("b6Tl"),E=n("a72m"),F=n("EY5k"),w=n("YxC/"),x=n("FZDd"),A=n("iZ7K"),N=n("eXjw"),k=n("OmkB"),D=n("tOh6"),M=n("sZ+8"),R=n("69Qu"),L=n("RJiR"),V=n("0kGT"),B=n("3/02"),G=n("Lyxw"),X=n("PMTb");let U=[];class q extends r.Component{constructor(t){super(t),this._onItemIconPointerDown=this._onItemIconPointerDown.bind(this),this._onChange=this._onChange.bind(this),this.props.entityTypeName.toLowerCase()===j.a&&(this.props.loadAllActivityTypes(t.activities),this.props.loadAllActivityResourceString())}_getEntityTypeNameFromViewId(t){return t&&this.props.gridViewSelectorItems&&this.props.gridViewSelectorItems[t]&&this.props.gridViewSelectorItems[t].relatedEntityName?this.props.gridViewSelectorItems[t].relatedEntityName:null}_onChange(t){var e;this.props.isGridRoot&&this.props.pageToEditedViewMapId&&this.props.selectedViewId!==t&&this.props.removeEditedViewPageMap(null===(e=this.props.pageToEditedViewMapId)||void 0===e?void 0:e.guid,new _.a(this.props.selectedViewId)),this.props.onChange(t,this.props.entityTypeName===j.a?this._getEntityTypeNameFromViewId(t):this.props.entityTypeName)}_isViewSelectorHidden(){return!(this.props.gridViewSelectorItems&&this.props.viewCategories&&this.props.selectedViewId)}render(){const t=Object(w.c)(this.props.resourceStrings,P.VIEWSELECTOR_TOOLTIP),e=this.props.contextString===f.h.GRID,n=e?this._onItemIconPointerDown:null,a=this.props.useViewSelectorV2?this.props.isPhone:this.props.isTablet,i=a?this.props.styleProps.textStyleMobile:this.props.styleProps.textStyle,s=a?this.props.styleProps.viewSelectorMobileStyle:this.props.styleProps.viewSelectorStyle,o=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(f.z):null;if(this._isViewSelectorHidden())return o&&o.info("View Selector not rendered because view selector items or view categories or selected view is not available."),null;const c=[];let l=!1;for(const t in this.props.gridViewSelectorItems){const n=this.props.gridViewSelectorItems[t];if(!n)continue;const r=n.isUserView;let a;if(r&&(l=!0),this.props.entityTypeName===j.a&&this.props.pinnedActivityView){const t=n;a=t.isPinned&&this.props.pinnedActivityView.PinnedEntity===t.relatedEntityName}else a=n.isPinned;const i=e?a?d.a.Pinned:d.a.Pin:null,s='""',o='""',u={":hover":{"::before":{content:a?s:o}}};this.props.useViewSelectorV2&&Object.assign(u,{marginLeft:"8px",marginRight:"8px"});const p=e?u:null,h=Object(w.c)(this.props.resourceStrings,P.VIEWSELECTOR_DEFAULTVIEW),g=Object(w.c)(this.props.resourceStrings,P.VIEWSELECTOR_SETDEFAULTVIEW),m=e?a?h:g:null;let b="";b=this.props.entityTypeName===j.a&&this.props.allActivitiesString&&this.props.shouldDisplayNestedViewSelector?(U.indexOf(n.relatedEntityName)+1).toString():r?C.b.userview.toString():C.b.savedview.toString();let f=n.name;t===this.props.selectedViewId&&this.props.isEdited&&(this.props.isRTL?f="*"+f:f+="*"),c.push({value:t,text:f,categoryId:b,iconType:i,iconTitle:m,iconStyle:p})}if(this.props.selectedViewId&&this.props.quickFindViewId&&this.props.quickFindViewId===this.props.selectedViewId){const t=Object(w.c)(this.props.resourceStrings,P.QUICK_FIND_VIEWS_LABEL_ID);c.push({value:this.props.selectedViewId,text:t,categoryId:C.b.savedview.toString()})}const u=l?this.props.viewCategories:this.props.viewCategories.filter(t=>t.id!==C.b.userview.toString());return this.props.isGridRoot&&this.props.isInMobileModeForOct2019?r.createElement(L.c,{pageId:this.props.pageId},this.props.isAdvancedFindView?r.createElement(X.a,null,"New view"):r.createElement(L.k,{items:c,selectedItemId:this.props.selectedViewId,onChange:this._onChange})):this.props.isAdvancedFindView?r.createElement(X.a,{style:i},"New view"):r.createElement(S.a,{id:this.props.id,testhooks:{id:"ViewSelector_"+this.props.selectedViewId},value:this.props.selectedViewId,role:"presentation",title:t,categories:u,options:c,style:this.props.style,caretType:d.a.ChevronDownMed,caretStyle:this.props.styleProps.caretStyle,textStyle:i,viewSelectorStyle:s,onChange:this._onChange,onItemIconPointerDown:n,createAccessibilityComponent:I.a,createKeyboardShortcut:I.b,parentCustomControlId:this.props.id,rootZIndex:this.props.rootZIndex,isRTL:this.props.isRTL,useViewSelectorV2:this.props.useViewSelectorV2,placeItemIconOnRight:!0,useHeader:this.props.isGridRoot})}componentDidMount(){if(this.props.viewIds?this.props.loadGridViewsByViewId(this.props.viewIds,this.props.entityTypeName):this.props.loadViewsByType(this.props.queryViewSelectorTypes,this.props.entityTypeName,this.props.gridViewSelectorItems),this._isViewSelectorHidden())return;let t=!1;if(this.props.selectedViewId&&""!==this.props.selectedViewId&&(this.props.gridViewSelectorItems&&this.props.gridViewSelectorItems[this.props.selectedViewId]||this.props.quickFindViewId&&this.props.quickFindViewId===this.props.selectedViewId)&&(t=!0),!t){if(this.props.viewIds){this.props.viewIds.find(t=>t.guid===this.props.selectedViewId)&&(t=!0)}this.props.defaultViewId&&this.props.defaultViewId.guid!==_.a.EMPTYSTRING&&this.props.onChange(this.props.defaultViewId.guid,this.props.entityTypeName)}}_onItemIconPointerDown(t){const e=t,n=t.iconType===d.a.Pinned,r=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(f.z):null;let a=t.categoryId,i=this.props.entityTypeName;if(this.props.entityTypeName===j.a){const e=this.props.gridViewSelectorItems;i=e&&e[t.value]?e[t.value].relatedEntityName:i;a=!(!e||!e[t.value])&&e[t.value].isUserView?C.b.userview.toString():C.b.savedview.toString()}r&&r.info(`Toggle the the pin status for ${t.value} for ${i} entity`),this.props.onItemIconPointerDown(i,t.value,a,"",n).then(()=>{if(r&&r.info("Resetting the pin status of all the options and toggle the pin status of the recently selected item"),!n&&this.props.entityTypeName===j.a){const n=this.props.gridViewSelectorItems[e.value];this.props.pinnedActivityView.PinnedEntity=n.relatedEntityName,this.props.pinnedActivityView.ViewId=new _.a(t.value),this.props.pinnedActivityView.ViewType=n.isUserView?C.b.userview:C.b.savedview}for(const t in this.props.gridViewSelectorItems)this.props.gridViewSelectorItems[t].isPinned=t===e.value&&!n;this.forceUpdate()},t=>{r&&r.error("Could not pin the selected view, pinning action failed with error "+t)})}}function z(t,e,n,r){let a=[];if(e===j.a&&r){let e=1;U.forEach(n=>{a.push({id:e.toString(),name:Object(A.f)(t,n)}),e++})}else a=Object(j.mb)(t,n);return a}function H(t,e,n){let r;return e.forEach((e,a)=>{const i=function(t,e,n){let r=Object(O.f)(t,e,n);r&&!Object(R.b)(t)&&Object(M.l)(t,e)&&(r=Object.keys(r).reduce((a,i)=>((r[i].isAvailableInOffline||i===_.a.toString(Object(O.a)(t,e,n)))&&(a[i]=r[i]),a),{}));return r}(t,n,e);i&&(r=Object.assign(Object.assign({},r),i))}),r}q.displayName="DataSetViewSelector";const W=Object(s.a)((function(){let t=null,e=null,n=null,r={gridViewSelectorItems:null,viewCategories:null,allActivitiesString:null,activities:null,activityOptions:null,resourceStrings:null,quickFindViewId:null,styleProps:null};const a=Object(T.a)(),i=Object(w.h)();return(s,o)=>{const c=i(s,P.labelList),l=_.a.toString(Object(O.a)(s,o.entityTypeName,C.a.QUICKFIND_SEARCH));let u=null;let d=null;const p=a(s,o.contextString);U=Object(j.B)(s);let h=!1;if(o.queryViewSelectorTypes&&o.queryViewSelectorTypes.length>0&&!o.viewIds){if(o.entityTypeName===j.a&&o.shouldDisplayNestedViewSelector?(U.forEach(t=>{const e=H(s,o.queryViewSelectorTypes,t);e&&(u=Object.assign(Object.assign({},u),e))}),d=Object(w.e)(s,["ViewSelectorAllActivities"])):u=H(s,o.queryViewSelectorTypes,o.entityTypeName),t)for(const e in u)if(!t[e]||t[e]!==u[e]){h=!0;break}}else if(o.viewIds){const e={};for(let n=0;n<o.viewIds.length;n++){const r=Object(j.qb)(s,o.viewIds[n],o.id);if(r&&r.grid&&r.grid.rows){const n=t?t[r.viewId.guid]:void 0,a=!n||n.name!==r.title||n.queryType!==r.queryType,i=a?{name:r.title,queryType:r.queryType,isDefault:!1,isQuickFindQuery:!1,isUserView:r.isUserView}:n;Object.assign(e,{[r.viewId.guid]:i}),h=h||a}}e&&(u=e)}return!u||t&&Object.keys(t).length===Object.keys(u).length||(h=!0),d&&r.allActivitiesString!==d.ViewSelectorAllActivities&&(h=!0),e!==l&&(h=!0),n!==p&&(h=!0),h&&(t=u,e=l,n=p,r={gridViewSelectorItems:t,viewCategories:z(s,o.entityTypeName,P,o.shouldDisplayNestedViewSelector),allActivitiesString:d&&d.ViewSelectorAllActivities,activities:null,activityOptions:null,resourceStrings:c,quickFindViewId:e,styleProps:n,isInMobileModeForOct2019:Object(V.b)(s),useViewSelectorV2:Object(G.a)(s,B.le,B.h)}),r}}),(function(t){return{loadViewsByType:(e,n,r)=>{const a=[];return e.forEach((e,i)=>{e===C.a.MAIN_APPLICATION_VIEW&&r&&0!==Object.keys(r).length||a.push(t(Object(E.a)(n,e,void 0,void 0)))}),Promise.all(a)},loadAllActivityResourceString:()=>t(Object(F.e)(["ViewSelectorAllActivities"])),loadAllActivityTypes:e=>{let n=null;for(const t in e)e[t].Initialized!==N.a.Initialized&&(n||(n={}),n[t]=["DisplayName","ActivityTypeMask","IsVisibleInMobileClient"]);return n?t(Object(x.e)(n)):Promise.resolve()},loadGridViewsByViewId:(e,n)=>{const r=[];return e.forEach((e,a)=>{r.push(t(Object(E.a)(n,void 0,void 0,e)))}),Promise.all(r)},openPopup:e=>t(Object(D.a)(e)),closePopup:e=>t(Object(k.a)(e))}}))(q);var Y=n("Ki7F"),K=n("o0iw"),Q=n("XIN1"),J=n("Wdaq"),Z=n("/aHX"),$=n("ZGH+"),tt=n("AVDU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const et=42;class nt extends r.Component{constructor(t){super(t),this.onMeasuring=this.onMeasuring.bind(this),this.state={commandbarWidth:0},this._lastCommandManagerId=t.commandManagerId}onMeasuring(t){const e=t-((this.props.style.paddingLeft?"string"==typeof this.props.style.paddingLeft?Object($.e)(this.props.style.paddingLeft):this.props.style.paddingLeft:0)+(this.props.style.paddingRight?"string"==typeof this.props.style.paddingRight?Object($.e)(this.props.style.paddingRight):this.props.style.paddingRight:0))-(this.props.backButtonEnabled?et:0);e!==this.state.commandbarWidth&&this.setState({commandbarWidth:e})}componentDidUpdate(){this.props.commandManagerId!==this._lastCommandManagerId&&(this._lastCommandManagerId=this.props.commandManagerId,this.props.setCommandManagerId(this.props.pageId,this.props.commandManagerId,this.props.contextToken))}_renderConsoleAppBackButton(){return this.props.backButtonEnabled?r.createElement(Z.a,{pageId:this.props.pageId}):null}_renderNativeSubgridCommandBar(){return this.props.isNativeMode?r.createElement(L.e,{commandManagerId:this.props.commandManagerId,pageId:this.props.pageId}):null}render(){if(!this.props.pageId||!this.props.ribbonId||!this.props.commandManagerId)return null;const t=!this.state.commandbarWidth,e=r.createElement(Y.a,{commandBarStyle:this.props.commandbarStyles,width:this.state.commandbarWidth,commandbarDisplayMode:K.a.IconLabel,key:this.props.pageId,iconPosition:Q.a.Left,commandManagerId:this.props.commandManagerId,id:this.props.pageId,ribbonId:this.props.ribbonId,relationshipType:this.props.relationshipType,addedCommandList:this.props.addedCommandList,appendedCommandList:this.props.appendedCommandList,contextToken:this.props.contextToken,metaDataLoadedResolve:this.props.metaDataLoadedResolve,isHidden:t,rootZIndex:this.props.rootZIndex,customControlType:this.props.customControlType,isNativeMode:this.props.isNativeMode});return this.props.isInMobileModeForOct2019&&this.props.isGridRoot?e:r.createElement(o.a,{key:"commandBar_"+this.props.pageId,testhooks:{id:"commandBar_"+this.props.pageId},style:this.props.style,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0},this._renderConsoleAppBackButton(),e,this._renderNativeSubgridCommandBar())}}nt.displayName="DataSetCommandBar";const rt=Object(s.a)((function(){return(t,e)=>{const n=Object(V.b)(t);return{commandManagerId:Object(j.w)(t,e.pageId,e.contextToken)||e.commandManagerId,backButtonEnabled:Object(tt.d)(t)&&e.isGridRoot&&!e.collapsed,isInMobileModeForOct2019:n}}}),(function(t){return{setCommandManagerId:(e,n,r)=>{e&&n&&r&&t(Object(J.b)(e,n,r))}}}))(nt);var at=n("A6np"),it=n("jAuy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function st(t){if(t){const e=t.split(":");if(2===e.length){return e[1].split(",")}}return[]}function ot(t){if(t&&t.filterOptions&&t.filterOptions.length>0){let e=t.filterOptions.filter(t=>t.isDefault);const n=t.userSetting,a=n&&n.defaultGridViews&&n.defaultGridViews[t.entityTypeName];let i,s;a&&""!==a.QueueId&&(e=t.filterOptions.filter(t=>Object(j.bb)(a.QueueId).sort().join(",")===st(t.value).sort().join(","))),t.isGridPaginationStateFeatureEnabled&&null!=t.previousValue&&(i=Object(it.f)(t.filterOptions,t.previousValue),s=t.previousValue),i||(e.length>0?(i=e[0].text,s=e[0].value):(i=t.filterOptions[0].text,s=t.filterOptions[0].value)),t.updateFilterValue(s);const c=Object(w.c)(t.resourceStrings,P.QUEUE_FILTER_LABEL),l=r.createElement(at.a,{key:"gridFilter",testhooks:{id:"gridFilter_"+t},title:c,accessibilityLabel:c,defaultValue:i,options:t.filterOptions,onChange:t.onFilterChange,createAccessibilityComponent:I.a,style:t.comboBoxStyle,createKeyboardShortcut:I.b,freeTextMode:!0,suppressFreeTextChangeCallback:!0});return r.createElement(o.a,{key:"GridFilterView",style:t.style},l)}const e=t.TraceManager&&t.TraceManager.getTracer?t.TraceManager.getTracer(f.z):null;return e&&e.info("Queue Filter not rendered because there are no filter options available"),null}var ct=n("KOTC"),lt=n("CbNq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ut={Id:"toggleButtonControl",Label:null,Name:"toggleButtonControl",ShowLabel:!1,Visible:!0,Disabled:!1},dt={FormFactor:2,CustomControlId:"MscrmControls.FlipSwitch.FlipSwitchControl",Name:"MscrmControls.FlipSwitch.FlipSwitchControl",Version:"1.0.0",Parameters:{value:{Usage:3,Static:!1,Value:0,Type:"TwoOptions",Attributes:{DefaultValue:0,Options:null},Callback:null}},ShouldOverrideControlVisible:!1};function pt(t,e){if(!t.isRollupViewSupported)return null;const n=function(t){const e=[];if(!Array.isArray(t))return e;for(let n=0;n<t.length;++n)e.push({Label:t[n],Value:n});return e}([Object(w.c)(t.resourceStrings,P.ROLLUPVIEW_SWITCH_OFF),Object(w.c)(t.resourceStrings,P.ROLLUPVIEW_SWITCH_ON)]),a=t.isOffline,i=(s=t.toggleValue,o=e,c=t.onToggleChange,l=n,Object.assign(Object.assign({},dt),{Parameters:{value:{Usage:3,Static:!1,Type:"TwoOptions",Value:s?1:0,Attributes:{DefaultValue:0,Options:l,DisplayName:o},Callback:c}}}));var s,o,c,l;const u=function(t,e){return Object.assign(Object.assign({},ut),{Label:t,Disabled:e})}(e,a),d="rollup_view_switch_"+t.id;return r.createElement(p.c,{key:d,controlId:d,id:t.id,systemDefinedProperties:null,descriptor:u,configuration:i,formInfo:void 0,shouldRender:!0,parentContextToken:null,parentDefinedControlProps:void 0})}function ht(t,e,n,a,i){const s=t.theme,c=t.isRTL,l=t.isActivityManagementFeatureEnabled&&t.entityIsActivityType;return r.createElement(o.a,{key:"ActivityViewContainer",role:"presentation",style:t.activityViewContainerStyle},r.createElement(o.a,{key:"ActivityDueDateFilterView",style:l?t.activityTypeContainerStyle:t.containerStyle},[e,n]),i?r.createElement(o.a,{key:"ActivityTypeFilterView",style:t.activityTypeContainerStyle},[a,i]):null,function(t,e,n,a){if(!e)return;const i=Object(w.c)(t.resourceStrings,P.ROLLUPVIEW_SWITCH_LABEL),s={flex:"1 1 auto",marginLeft:n.sizes.Measures.Measure200,marginRight:n.sizes.Measures.Measure200,marginTop:n.sizes.Measures.Measure050,minWidth:"15rem"},c={whiteSpace:"nowrap",flex:"1 0 auto",marginRight:a?0:n.sizes.Measures.Measure100,marginLeft:a?n.sizes.Measures.Measure100:0};return r.createElement(o.a,{key:"RollupViewControlContainer",style:s},r.createElement(o.a,{key:"rollupViewFilterLabelView",style:c},i),pt(t,i))}(t,t.isRollupViewSupported,s,c))}const gt=Object(s.a)(void 0,(function(t){return{openPopup:e=>t(Object(D.a)(e)),closePopup:e=>t(Object(k.a)(e))}}))((function(t){const e=t.TraceManager&&t.TraceManager.getTracer?t.TraceManager.getTracer(f.z):null;let a,i="";const s=t.isActivityManagementFeatureEnabled&&t.entityIsActivityType;if(t&&t.filterOptions&&t.filterOptions.length>0){const e=t.filterOptions.filter(t=>t.isDefault);s&&(a=Object(lt.d)(t.filterOptions)),t.isGridPaginationStateFeatureEnabled&&null!=t.previousValue&&(i=s?t.previousValue:Object(it.f)(t.filterOptions,t.previousValue)),i||(i=e.length>0?s?e[0].value:e[0].text:s?t.filterOptions[0].value:t.filterOptions[0].text)}const[c,u]=r.useState(i);if(t&&t.filterOptions&&t.filterOptions.length>0){const d={flex:"1 0 auto",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",width:"0px"},p=s?Object(w.c)(t.resourceStrings,t.dueDateFilterLabelResourceString):Object(w.c)(t.resourceStrings,t.entityFilterLabelResourceString);let h=null;p&&(h=r.createElement(l.a,{key:"activityDueDateFilterLabel",style:s?t.activityMgmtLabelStyle:t.labelStyle}," ",p," "));const g=r.createElement(o.a,{key:"activityDueDateFilterLabelView",style:{alignItems:"center",justifyContent:"center"}},h);let m=r.createElement(at.a,{key:"activityDueDateFilterComboBox",testhooks:{id:"activityDueDateFilterComboBox_"+t.id},id:"activityDueDateFilterComboBox",defaultValue:i,options:t.filterOptions,onChange:t.onFilterChange,createAccessibilityComponent:I.a,style:t.comboBoxStyle,textStyle:d,createKeyboardShortcut:I.b,openPopup:t.openPopup,closePopup:t.closePopup,parentCustomControlId:"activityDueDateFilterComboBox",rootZIndex:t.rootZIndex,accessibilityLabel:p,freeTextMode:!0,suppressFreeTextChangeCallback:!0});s&&(m=r.createElement(ct.a,{key:"activityDueDateFilterComboBox",loader:()=>Promise.all([n.e(10),n.e(11),n.e(13),n.e(12),n.e(14),n.e(15),n.e(17),n.e(21),n.e(28),n.e(90)]).then(n.bind(null,"YDph")).then(t=>t.ComboBox),props:{selectedKey:c,key:"activityDueDateFilterComboBox",id:"activityDueDateFilterComboBox",options:a,onChange:(e,n)=>{u(n.key),t.onFilterChange(n.key)},style:t.dueDatecomboBoxStyle,ariaLabel:p,useComboBoxAsMenuWidth:!0,allowFreeform:!0}}));if(t.isActivityManagementFeatureEnabled&&!t.isOffline&&!t.isMobile&&t.gridEntityName===f.a){let a=null;const i=Object(w.c)(t.resourceStrings,t.activityTypeFilterLabelResourceString);i&&(a=r.createElement(l.a,{key:"activityTypeFilterLabel",style:t.activityMgmtLabelStyle}," ",i," "));const s=r.createElement(o.a,{key:"activityTypeFilterLabelView",style:{alignItems:"center",justifyContent:"center"}},a);let c;if(t.filterOptionsForActivityType&&t.filterOptionsForActivityType.length>0){e&&e.info("Activity Management Filter - Activity Type Filter Rendered with no. of options "+t.filterOptionsForActivityType.length);let a=Object(lt.c)(t.filterOptionsForActivityType);if(t.isActivityFilterSelectAllEnabled){const e=Object(w.c)(t.resourceStrings,P.ACTIVITYTYPE_SELECTALL),n=[];n.push({key:"selectAllKey",text:e}),a=n.concat(a)}let s=[];t.isGridPaginationStateFeatureEnabled&&null!=t.activityTypePreviousValues&&(s=Object(lt.b)(t.activityTypePreviousValues)),c=r.createElement(ct.a,{key:"activityTypeFilterBox",loader:()=>Promise.all([n.e(10),n.e(28),n.e(40)]).then(n.bind(null,"yiyP")).then(t=>t.ActivityTypeCombobox),props:{key:"activityTypeFilterBox",id:"activityTypeFilterBox",selectedOptionKeys:s,onActivityTypeFilterClear:()=>{t.onActivityTypeFilterClear()},onActivityTypeMenuDismissed:e=>{t.onActivityTypeChange(e)},options:a,ariaLabel:i,isRTL:t.isRTL,style:t.activityTypeContainerStyle,resourceStrings:t.resourceStrings,selectAllEnabled:t.isActivityFilterSelectAllEnabled}})}return ht(t,g,m,s,c)}return ht(t,g,m,null,null)}return e&&e.info("Activity Filter not rendered because there are no filter options available"),null}));var mt=n("nJrx"),bt=n("gvL4"),ft=n("Smta"),yt=n("vTeb"),vt=n("evW+"),_t=n("1AYO"),St=n("hSDL"),Ot=n("unFF"),Ct=n("tJ+6");var It=n("kC0I"),Pt=n("3rse"),jt=n("00VO"),Tt=n("FhVi"),Et=n("Afz2"),Ft=n("Gilj"),wt=n("cz9j"),xt=n("L4PC"),At=n("H4dV");class Nt extends r.Component{constructor(t){super(t),this._cachedSelectedFilter="",this._onFilterChange=this._onFilterChange.bind(this),this._toggleJumpBarFlyout=this._toggleJumpBarFlyout.bind(this),this._closeJumpBarDomId="close-jumpbar-"+Object(mt.a)(),this._selectedFilterDomId="selected-filter-"+Object(mt.a)(),this.state={isFlyoutOpened:!1}}_onOutsideClickHandler(t,e){const n=e.target,r=document.getElementById(t);n&&!r.contains(n)&&r!==n&&this._toggleJumpBarFlyout()}keyDownHandler(t){switch(t.EVENT.keyCode){case Pt.a.Escape:this._setIsFlyoutOpenedState(!1)}}_toggleJumpBarFlyout(){this._setIsFlyoutOpenedState(!this.state.isFlyoutOpened)}_setIsFlyoutOpenedState(t){this.setState({isFlyoutOpened:t}),Object(wt.g)(t)}_filterGrid(t){let e,n=t.getAttribute("data-value");if(n!==this._cachedSelectedFilter&&(this.props.updateDataSetLoadingState(1),this._cachedSelectedFilter=n),1033===this.props.languageId&&n){const e=t.getAttribute("data-value").toUpperCase();e!==n&&(n=`${n}|${e}`)}e=this.props.dataSetFetchXml?Object(jt.c)(this.props.dataSetFetchXml,this.props.entityAttributeMetadata,this.props.primaryNameAttribute):this.props.primaryNameAttribute,this.props.applyGridFilter(Object(jt.b)(n,e),this.props.isGridRoot,this.props.contextToken),this._setIsFlyoutOpenedState(this.props.renderMobile&&!this.state.isFlyoutOpened)}_onFilterChange(t){let e=t.target;const n=t;("click"===t.type||n&&n.keyCode===Pt.a.Enter)&&(t.preventDefault(),e&&"a"===e.tagName.toLowerCase()&&(e=e.parentElement),this._filterGrid(e))}_renderListItem(t,e,n){let a=Object.assign({},this.props.renderMobile?this.props.styles.listItemStyleMobile:this.props.styles.listItemStyle),i=Object.assign(Object.assign({},this.props.styles.hyperlinkStyle),this.props.renderMobile?this.props.styles.hyperlinkStyleMobile:null);return n.describedByElementId&&(a=Object.assign(a,this.props.renderMobile?this.props.styles.listItemSelectedStyleMobile:this.props.styles.listItemSelectedStyle),i=Object.assign(i,this.props.renderMobile?this.props.styles.hyperlinkSelectedStyleMobile:null)),r.createElement(ft.a,Object.assign({},n,{style:a}),r.createElement(yt.a,Object.assign({},t,{style:i}),e))}_createKeyboardShortcuts(){const t=Object(w.c)(this.props.resourceStrings,P.CLOSE_JUMPBAR_ARIALABEL),e=this.keyDownHandler.bind(this),n=[],r=new Ft.a([Pt.a.Escape],e,!0,"",t);return n.push(r),n}_renderJumpBarAlphabet(){const t=[],e=Object(w.c)(this.props.resourceStrings,P.JUMPBAR_ALPHABET),n=Object(w.c)(this.props.resourceStrings,P.JUMPBAR_NUMBER_INDICATOR),r=Object(w.c)(this.props.resourceStrings,P.JUMPBAR_NUMBER_TOOLTIP),a=At.a.getInstance(),i=!!a&&a.get_IsIOS();return e.split(",").forEach(e=>{const a=Object(It.h)(e),s=a[0],o=a[1],c=s+"_listItem",l=s+"_link",u={id:c,key:c,accessibilityLabel:String.format(P.FILTERBY_ARIALABEL,o),role:Et.q,onClick:this._onFilterChange,onKeyDown:this._onFilterChange,tabIndex:-1},d={id:l,key:l,testhooks:{id:l},tabIndex:-1,role:Et.r,accessibilityHidden:!i,accessibilityLabel:i?String.format(P.FILTERBY_ARIALABEL,o):void 0};s===n&&(d.title=r,d.accessibilityLabel=P.NUMBER_ARIALABEL),this.props.selectedFilter!==s&&this.props.selectedFilter!==o||(u.describedByElementId=this._selectedFilterDomId,u.isSelected=!0,u.tabIndex=0),o&&(u.dataValue=o),t.push(this._renderListItem(d,s,u))}),t}_renderJumpBarAll(){const t=Object(w.c)(this.props.resourceStrings,P.JUMPBAR_ALL),e=Object(w.c)(this.props.resourceStrings,P.JUMPBAR_ALL_TITLE);this._allListItemDomId=t+"_listItem";const n=t+"_link",r=At.a.getInstance(),a=!!r&&r.get_IsIOS(),i={id:this._allListItemDomId,key:this._allListItemDomId,onClick:this._onFilterChange,onKeyDown:this._onFilterChange,role:Et.q,tabIndex:-1,accessibilityLabel:String.format(P.FILTERBY_ARIALABEL,t)},s={id:n,key:n,testhooks:{id:n},tabIndex:-1,role:Et.r,accessibilityHidden:!a,accessibilityLabel:a?String.format(P.FILTERBY_ARIALABEL,t):void 0,title:e};return this.props.selectedFilter&&this.props.selectedFilter!==t||(i.describedByElementId=this._selectedFilterDomId,i.isSelected=!0,i.tabIndex=0),this._renderListItem(s,t,i)}_renderList(){const t=Object(w.c)(this.props.resourceStrings,P.JUMPBAR_LETTER_TITLE);return r.createElement(bt.a,{id:"JumpBarItemsList",key:"JumpBarItemsList",testhooks:{id:"JumpBarItemsList"},title:t,role:Et.j,onKeyDown:this._onJumpbarKeyDown.bind(this),style:Object.assign(Object.assign({},this.props.styles.jumpBarStyle),this.props.renderMobile?this.props.styles.jumpBarStyleMobile:null),accessibilityLabel:P.JUMPBAR_ARIALABEL},this._renderJumpBarAll(),this._renderJumpBarAlphabet())}_onJumpbarKeyDown(t){const e=t.target;if(this.state.isFlyoutOpened){const n=9===t.keyCode,r=t.shiftKey;if(n){if(t.stopPropagation(),t.preventDefault(),r){if(e.id===this._closeJumpBarDomId)return void document.querySelector("#JumpBarItemsList").lastElementChild.focus();const t=e.previousElementSibling;t?t.focus():e.id===this._allListItemDomId&&document.getElementById(this._closeJumpBarDomId).focus()}else{if(e.id===this._closeJumpBarDomId)return void document.getElementById(this._allListItemDomId).focus();if(e.parentElement&&e.parentElement.lastElementChild&&e.id===e.parentElement.lastElementChild.getAttribute("id"))return void document.getElementById(this._closeJumpBarDomId).focus();const t=e.nextElementSibling;t&&t.focus()}return}}if(t.keyCode===Pt.a.UpArrow||t.keyCode===Pt.a.DownArrow||t.keyCode===Pt.a.LeftArrow||t.keyCode===Pt.a.RightArrow){t.stopPropagation(),t.preventDefault();const n=t.keyCode===Pt.a.DownArrow||t.keyCode===Pt.a.RightArrow,r=t.keyCode===Pt.a.UpArrow||t.keyCode===Pt.a.LeftArrow;if(n){const t=e.nextElementSibling;return void(t&&t.focus())}if(r){const t=e.previousElementSibling;return void(t&&t.focus())}}}_renderJumpBarFlyout(t,e){const n="jumpbar-flyout_"+this.props.id,a=n+"Accessibility",i=[];return i.push(r.createElement(Tt.a,{key:a,rootElementId:n,shouldManageFocus:!0,isModal:!0,keyboardShortcuts:this._createKeyboardShortcuts(),defaultFocusId:this._closeJumpBarDomId})),r.createElement(o.a,{role:Et.e},r.createElement(_t.a,{id:n,testhooks:{id:n},key:n,rootZIndex:this.props.rootZIndex,positionType:"relative",relativeToElementId:e,flyoutStyle:this.props.styles.jumpBarFlyoutStyle,flyoutDirection:this.props.isRTL?_t.b.upleft:_t.b.rightup,onOutsideClick:this._onOutsideClickHandler.bind(this,t)},r.createElement(vt.a,{key:"cancel",style:this.props.styles.closeButtonStyle,id:this._closeJumpBarDomId,onClick:this._toggleJumpBarFlyout,onKeyDown:this._onJumpbarKeyDown.bind(this),accessibilityLabel:P.CLOSE_JUMPBAR_ARIALABEL},r.createElement(l.a,{style:this.props.styles.closeButtonTextStyle},r.createElement(Q.b,{type:d.a.Close}))),this._renderList()),i)}_renderFlyoutButton(t){const e=Object(w.c)(this.props.resourceStrings,P.JUMPBAR_LETTER_TITLE),n=Object(w.c)(this.props.resourceStrings,P.JUMPBAR_ALPHABET).split(",");let a="";for(let t=0;t<3;t++){a+=Object(It.h)(n[t+1])[0]}return r.createElement(vt.a,{id:t,accessibilityLabel:e,title:e,style:this.props.isMobile?this.props.styles.jumpBarButtonMobileStyle:this.props.styles.jumpBarButtonStyle,onClick:this._toggleJumpBarFlyout,testhooks:{id:t}},r.createElement(l.a,{style:this.props.styles.jumpBarButtonTextStyle},a))}render(){try{if(this.props.resourceStrings){const t="jumpBarRoot_"+this.props.id,e=`${t}_${this.props.uniqueId}`,n="jumpbarBtn_"+(this.props.uniqueId||this.props.id),a={position:"relative"};this.props.renderMobile&&Object.assign(a,{maxWidth:"100%"});const i={height:"0",width:"0"},s="flyoutRelativeElement"+this.props.controlKey;return r.createElement(o.a,{id:e,key:e,testhooks:{id:t},style:a},this.props.isRTL?null:r.createElement(o.a,{id:s,style:i,role:"presentation","aria-hidden":"true"}),this.props.renderMobile?this._renderFlyoutButton(n):this._renderList(),this.state.isFlyoutOpened?this._renderJumpBarFlyout(n,s):null,r.createElement(o.a,{style:{display:"none"},id:this._selectedFilterDomId,key:this._selectedFilterDomId,role:" "},P.SELECTEDFILTER_TEXT),this.props.isRTL?r.createElement(o.a,{id:s,style:i,role:"presentation","aria-hidden":"true"}):null)}return null}catch(t){return console.error(t.message),null}}}const kt=Object(s.a)((function(){let t=null,e=null,n=null;const r=Object(w.h)(),a=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let t=null,e=null;return function(n,r){var a,i,s,o,c,l,u,d,p,h,g,m,b,f,y,v,_,S,O,C,I,P,j,T,E,F,w,x,A,N,k,D,M,R;const L=Object(Ot.a)(n),V=Object(Ct.b)(n)&&Object(G.a)(n,B.Fb,B.Lc)&&(null===(a=Object(Ct.a)(n))||void 0===a?void 0:a.Components)?Object(Ct.a)(n).Components:null;return e!==L&&(e=L,t={jumpBarStyle:{width:"100%",height:L.sizes.Measures.Measure300,display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",listStyleType:"none",backgroundColor:(null===(o=null===(s=null===(i=null==V?void 0:V.Grid)||void 0===i?void 0:i.Footer)||void 0===s?void 0:s.JumpBar)||void 0===o?void 0:o.BackgroundColor)||L.colors.BaseColor.Grey.Grey1,border:"1px solid transparent"},jumpBarButtonStyle:{display:"flex",fontSize:L.fontSizes.Font085,fontFamily:L.fontFamilies.Regular,color:(null===(u=null===(l=null===(c=null==V?void 0:V.Grid)||void 0===c?void 0:c.Footer)||void 0===l?void 0:l.JumpBar)||void 0===u?void 0:u.TextColor)||L.colors.MainThemeColor.MainColor1.Fill,cursor:L.display.PointerCursorStyle,borderStyle:"none",backgroundColor:"transparent",padding:"0",marginLeft:L.sizes.Measures.Measure100,marginRight:L.sizes.Measures.Measure100,marginTop:L.sizes.Measures.Measure050,marginBottom:L.sizes.Measures.Measure050,maxWidth:"100%"},jumpBarButtonMobileStyle:{display:"flex",fontSize:L.fontSizes.Font100,fontFamily:L.fontFamilies.Regular,color:(null===(h=null===(p=null===(d=null==V?void 0:V.Grid)||void 0===d?void 0:d.Footer)||void 0===p?void 0:p.JumpBar)||void 0===h?void 0:h.TextColor)||L.colors.MainThemeColor.MainColor1.Fill,cursor:L.display.PointerCursorStyle,borderStyle:"none",backgroundColor:"transparent",padding:"0",marginLeft:L.sizes.Measures.Measure100,marginRight:L.sizes.Measures.Measure100,marginTop:L.sizes.Measures.Measure050,marginBottom:L.sizes.Measures.Measure050,maxWidth:"100%"},jumpBarButtonTextStyle:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},jumpBarFlyoutStyle:{border:L.borders.Border02,backgroundColor:L.colors.BaseColor.Grey.Grey1,overflowY:"auto",overflowX:"hidden"},closeButtonStyle:{position:"absolute",top:"0",right:"0",borderStyle:"none",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"transparent",cursor:L.display.PointerCursorStyle,padding:L.sizes.Measures.Measure100,width:L.sizes.Measures.Measure300,height:L.sizes.Measures.Measure300},closeButtonTextStyle:{fontSize:"16px",color:L.colors.BaseColor.Grey.Grey7},jumpBarStyleMobile:{height:"auto",flexWrap:"wrap",display:"flex",alignItems:"center",justifyContent:"flex-start",paddingTop:L.sizes.Measures.Measure300,paddingRight:L.sizes.Measures.Measure050,paddingBottom:L.sizes.Measures.Measure150,paddingLeft:L.sizes.Measures.Measure300,maxWidth:"20rem"},listItemStyle:{textAlign:"center",position:"relative",height:L.sizes.Measures.Measure125},listItemSelectedStyle:{borderStyle:"solid",borderBottomColor:(null===(b=null===(m=null===(g=null==V?void 0:V.Grid)||void 0===g?void 0:g.Footer)||void 0===m?void 0:m.JumpBar)||void 0===b?void 0:b.SelectedColor)||L.colors.MainThemeColor.MainColor1.Fill,borderBottomWidth:L.sizes.Measures.Measure025},listItemStyleMobile:{display:"flex",alignItems:"center",justifyContent:"center",cursor:L.display.PointerCursorStyle,marginRight:L.sizes.Measures.Measure150,marginBottom:L.sizes.Measures.Measure150,width:L.sizes.Measures.Measure300,height:L.sizes.Measures.Measure300,border:L.borders.Border01,borderColor:(null===(v=null===(y=null===(f=null==V?void 0:V.Grid)||void 0===f?void 0:f.Footer)||void 0===y?void 0:y.JumpBar)||void 0===v?void 0:v.BorderColor)||L.colors.BaseColor.Blue.Blue3,backgroundColor:(null===(O=null===(S=null===(_=null==V?void 0:V.Grid)||void 0===_?void 0:_.Footer)||void 0===S?void 0:S.JumpBar)||void 0===O?void 0:O.BackgroundColorMobile)||L.colors.BaseColor.White,":nth-child(2)":{marginRight:"50%"},outlineOffset:"0px !important"},listItemSelectedStyleMobile:{borderColor:(null===(P=null===(I=null===(C=null==V?void 0:V.Grid)||void 0===C?void 0:C.Footer)||void 0===I?void 0:I.JumpBar)||void 0===P?void 0:P.SelectedBorderColor)||L.colors.BaseColor.Transparent,backgroundColor:(null===(E=null===(T=null===(j=null==V?void 0:V.Grid)||void 0===j?void 0:j.Footer)||void 0===T?void 0:T.JumpBar)||void 0===E?void 0:E.SelectedColorMobile)||L.colors.BaseColor.Grey.Grey2},hyperlinkStyle:{textDecoration:"none",textAlign:"center",fontSize:L.fontSizes.Font085,fontFamily:L.fontFamilies.Regular,whiteSpace:"nowrap",color:(null===(x=null===(w=null===(F=null==V?void 0:V.Grid)||void 0===F?void 0:F.Footer)||void 0===w?void 0:w.JumpBar)||void 0===x?void 0:x.LinkColor)||L.colors.BaseColor.Grey.Grey7},hyperlinkStyleMobile:{color:(null===(k=null===(N=null===(A=null==V?void 0:V.Grid)||void 0===A?void 0:A.Footer)||void 0===N?void 0:N.JumpBar)||void 0===k?void 0:k.LinkColor)||L.colors.BaseColor.Blue.Blue3},hyperlinkSelectedStyleMobile:{color:(null===(R=null===(M=null===(D=null==V?void 0:V.Grid)||void 0===D?void 0:D.Footer)||void 0===M?void 0:M.JumpBar)||void 0===R?void 0:R.SelectedBorderColor)||L.colors.BaseColor.Grey.Grey7}}),t}}();return(i,s)=>{const o=a(i,s);if(null===t&&(t=Object(A.E)(i,s.entityTypeName)),null==e&&(e=i.metadata.attributes[s.entityTypeName]),Object(G.a)(i,B.ac)){const t=Object(j.v)(i,s.id,s.contextToken);n=t&&t.fetchXml}return{resourceStrings:r(i,P.labelList),primaryNameAttribute:t,dataSetFetchXml:n,entityAttributeMetadata:e,styles:o}}}),(function(t,e){return{applyGridFilter:(n,r,a)=>{if(t(Object(St.m)(n,e.id,a)),t(Object(xt.b)(e.id,a,1)),r){const t=[{filterType:4,filterExpressionOrValue:n}];e.updateGridPaginationStateHandler(t,e.id),e.setResetPagingInfoForEnhancedPaging()}}}}))(Nt);var Dt=n("49Nd");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Mt=n("5UPV"),Rt=n("RrRu"),Lt=n("jRHm"),Vt=n("lEp6"),Bt=n("wFY3"),Gt=n("LAGg"),Xt=n("fU7K");class Ut extends r.Component{constructor(t){super(t),this._goToFirstPage=this._goToFirstPage.bind(this),this._goToPreviousPage=this._goToPreviousPage.bind(this),this._goToNextPage=this._goToNextPage.bind(this),Object(w.c)(t.resourceStrings,Dt.d)||t.retrieveResourceStrings(Dt.k)}_firstButtonEnabled(t){return this.props.currentPage>1}_nextButtonEnabled(t){return(!(this.props.currentPage===Math.floor(t.totalResultCount/t.pageSize))||!this.props.pagingInfo.isGridScrolledToBottom)&&t.hasNextPage}_previousButtonEnabled(t){return this.props.currentPage>1}_goToNextPage(t){this.props.updateDataSetLoadingState(1),this.props.incrementLastPage(),this.props.setNewPageRequested(!0),this.props.updatePageNumber(this.props.currentPage+1),this._setFooterButtonsFocus(t,!0)}_goToPreviousPage(t){this.props.updateDataSetLoadingState(1),this.props.setNewPageRequested(!0),this.props.updatePageNumber(this.props.currentPage-1),this._setFooterButtonsFocus(t,!1)}_goToFirstPage(t){this.props.updateDataSetLoadingState(1),this.props.setNewPageRequested(!0),this.props.setFirstPage(1),this.props.updatePageNumber(1),this._setFooterButtonsFocus(t,!1)}_setFooterButtonsFocus(t,e){if(null!==t&&null!==t.currentTarget&&null!==t.currentTarget.parentElement&&null!==t.currentTarget.parentElement.children)if(e&&t.currentTarget.parentElement.children.length>=2&&null!==t.currentTarget.parentElement.children[1]){const e=t.currentTarget,n=t.currentTarget.parentElement.children[1];setTimeout(()=>{e.disabled&&n.focus()},500)}else if(!e&&null!==t.currentTarget.parentElement.lastElementChild){const e=t.currentTarget,n=t.currentTarget.parentElement.lastElementChild;setTimeout(()=>{e.disabled&&n.focus()},500)}}_getResources(){if(this._loadFirstPage=this._loadFirstPage||Object(w.c)(this.props.resourceStrings,Dt.d),this._loadNextPage=this._loadNextPage||Object(w.c)(this.props.resourceStrings,Dt.e),this._loadPreviousPage=this._loadPreviousPage||Object(w.c)(this.props.resourceStrings,Dt.f),!this._spaceResource){const t=Object(w.c)(this.props.resourceStrings,Dt.j);this._spaceResource=Object(Xt.CrmHtmlDecode)(t)}this._gridInfoResource=this._gridInfoResource||Object(w.c)(this.props.resourceStrings,Dt.a),this._gridTotalCount=this._gridTotalCount||Object(w.c)(this.props.resourceStrings,Dt.c),this._itemSelected=this._itemSelected||Object(w.c)(this.props.resourceStrings,Dt.b),this._totalApproximate=this._totalApproximate||Object(w.c)(this.props.resourceStrings,Dt.h),this._totalExact=this._totalExact||Object(w.c)(this.props.resourceStrings,Dt.i)}render(){if(!this.props.pagingData)return null;const t=Object(Vt.a)(this.props.pagingData);let e=0,n=0;t.totalResultCount&&(this.props.enhancedPagingDisabled?(e=t.pageSize*(this.props.currentPage-1)+1,n=this.props.currentPage*t.pageSize,-1!==t.totalResultCount&&this.props.currentPage*t.pageSize>t.totalResultCount&&(n=t.totalResultCount,this.props.isServerOffline&&this.props.currentPage>1&&(n=t.pageSize*(this.props.currentPage-1)+t.totalResultCount))):(e=t.pageSize*(this.props.pagingInfo.firstPageNumber-1)+1,n=this.props.pagingInfo.lastPageNumber*t.pageSize,this.props.pagingInfo.pageShift>0&&(e+=this.props.pagingInfo.pageShift,n+=this.props.pagingInfo.pageShift),-1!==t.totalResultCount&&this.props.pagingInfo.lastPageNumber*t.pageSize>t.totalResultCount&&(n=t.totalResultCount,this.props.isServerOffline&&this.props.currentPage>1&&(n=t.pageSize*(this.props.currentPage-1)+t.totalResultCount))));const a=t.totalResultCount,i=this._firstButtonEnabled(t),s=this._nextButtonEnabled(t),c=this._previousButtonEnabled(t);this._getResources();let l=a;-1===a&&(l=n<this.props.gridTotalRecordsCountLimit?this.props.gridTotalRecordsCountLimit:n);let u="";u=-1===a?String.format(this._totalApproximate,this.props.isServerOffline?n:l):this.props.isServerOffline&&a>t.pageSize?String.format(this._totalApproximate,n):String.format(this._totalExact,this.props.isServerOffline?n:a);const d=String.format(this._gridTotalCount,this._spaceResource,u),p=this.props.selectedRowCount>0?String.format(this._itemSelected,this._spaceResource,this.props.selectedRowCount):null,h=Object(w.c)(this.props.resourceStrings,Dt.g),g=String.format(h,this.props.currentPage);let m=a/t.pageSize;return this.props.isServerOffline&&0!==this.props.currentPage&&(m=-1/t.pageSize),r.createElement(o.a,{style:this.props.styleProps.containerStyle},this._renderPagingText(e,n,d,p),this._renderPagingButtons(i,s,c,g,m))}_renderPagingButtons(t,e,n,a,i){return(i<0||i>1)&&this.props.enhancedPagingDisabled?r.createElement(o.a,{style:this.props.styleProps.navigationPanelStyle},r.createElement(vt.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"loadFirstPage_"+this.props.id},accessibilityLabel:this._loadFirstPage,disabled:!t,tabIndex:0,onClick:this._goToFirstPage},r.createElement(Q.b,{type:d.a.FirstPageButton})),r.createElement(vt.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"moveToPreviousPage_"+this.props.id},accessibilityLabel:this._loadPreviousPage,disabled:!n,tabIndex:0,onClick:this._goToPreviousPage},r.createElement(Q.b,{type:d.a.BackButton})),r.createElement(l.a,{style:this.props.styleProps.pageNumberStyle,testhooks:{id:"pageNumber_"+this.props.id},role:Et.a,notificationType:Bt.b},null!==this.props.currentPage?String.format(a,this.props.currentPage):null),r.createElement(vt.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"moveToNextPage_"+this.props.id},accessibilityLabel:this._loadNextPage,disabled:!e,tabIndex:0,onClick:this._goToNextPage},r.createElement(Q.b,{type:d.a.Forward}))):null}_renderPagingText(t,e,n,a){if(!this.props.pagingTextDisabled&&this.props.shouldPagingTextRender&&this.props.gridTotalRecordsCountLimit)return r.createElement(o.a,{style:this.props.styleProps.pagingTextStyle,testhooks:{id:"pagingText"}},r.createElement(l.a,null,String.format(this._gridInfoResource,t,e,n,a)))}}const qt=Object(s.a)((function(){let t=null;const e=Object(w.h)(),n=function(){let t=null,e=null;const n={containerStyle:{justifyContent:"space-between",alignItems:"center",width:"100%"},navigationPanelStyle:{flexDirection:"row"},pageNumberStyle:{whiteSpace:"nowrap"},pagingButton:{borderStyle:"none",display:"inline-block",backgroundColor:"transparent",fontSize:"16px"}};return function(r,a){var i,s,o,c,l,u,d,p,h,g;const m=Object(Ct.b)(r)&&Object(G.a)(r,B.Fb,B.Lc)&&(null===(i=Object(Ct.a)(r))||void 0===i?void 0:i.Components)?Object(Ct.a)(r).Components:null;if(t!==a){t=a;const i=Object(Ot.a)(r),{isRTL:b}=r.user.userSettings,f=Object.assign(Object.assign({},n.containerStyle),{marginRight:i.sizes.Measures.Measure100,marginLeft:i.sizes.Measures.Measure100}),y=Object.assign(Object.assign({},n.navigationPanelStyle),{["margin"+(b?"Right":"Left")]:"auto"}),v=Object.assign(Object.assign({},n.pageNumberStyle),{marginRight:i.sizes.Measures.Measure100,marginLeft:i.sizes.Measures.Measure100,fontSize:i.fontSizes.Font085,fontFamily:i.fontFamilies.Regular,color:(null===(o=null===(s=null==m?void 0:m.Grid)||void 0===s?void 0:s.Footer)||void 0===o?void 0:o.TextColor)||i.colors.BaseColor.Grey.Grey7}),_=Object.assign(Object.assign(Object.assign({},n.pagingButton),{color:(null===(l=null===(c=null==m?void 0:m.Grid)||void 0===c?void 0:c.Footer)||void 0===l?void 0:l.IconColor)||i.colors.BaseColor.Blue.Blue3,marginLeft:i.sizes.Measures.Measure050,marginRight:i.sizes.Measures.Measure050,width:"0px",fontSize:i.fontSizes.Font085,"[disabled]":{color:(null===(p=null===(d=null===(u=null==m?void 0:m.Grid)||void 0===u?void 0:u.Footer)||void 0===d?void 0:d.Disabled)||void 0===p?void 0:p.IconColor)||i.colors.BaseColor.Grey.Grey5}}),b&&{transform:"scaleX(-1)"}),S={["margin"+(b?"Left":"Right")]:"auto",fontSize:i.fontSizes.Font085,fontFamily:i.fontFamilies.Regular,color:(null===(g=null===(h=null==m?void 0:m.Grid)||void 0===h?void 0:h.Footer)||void 0===g?void 0:g.TextColor)||i.colors.BaseColor.Grey.Grey7};e=Object.assign(Object.assign({},n),{containerStyle:f,navigationPanelStyle:y,pagingButton:_,pageNumberStyle:v,pagingTextStyle:S})}return e}}();return(r,a)=>{const i=n(r,a.contextString),s=Object(j.fb)(r,a.id,a.contextToken),o=s?s.length:0,c=e(r,Dt.k),l=Object(j.Y)(r,a.id,a.contextToken),u=Object(j.x)(r,a.id,a.contextToken);return t!==i&&(t=i),{selectedRowCount:o,resourceStrings:c,pagingData:l,currentPage:null===u?1:u,styleProps:t}}}),(function(t,e){return{retrieveResourceStrings:e=>t(Object(F.e)(e)),updatePageNumber:n=>{if(t(Object(xt.b)(e.id,e.contextToken,n)),1===n&&e.enhancedPagingDisabled&&t(Object(Gt.b)(e.id,e.contextToken)),e.isGridRoot){const t=[{filterType:12,filterExpressionOrValue:n}];e.updateGridPaginationStateHandler(t,e.id)}return t(Object(Lt.b)(e.id,e.contextToken,null)),t(Object(Rt.b)(e.id,e.contextToken,[]))},setNewPageRequested:n=>{t(Object(Mt.b)(e.id,e.contextToken,n))}}}))(Ut);var zt=n("PBKq"),Ht=n("Yexl"),Wt=n("IqkD");var Yt=n("5O6t"),Kt=n("b8TU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Qt extends r.Component{constructor(t){super(t),this._quickFindInnerTextRef=null,this._searchBarFocusTriggered=!1,this._onTextInputChange=this._onTextInputChange.bind(this),this._onkeyDown=this._onkeyDown.bind(this),this._onButtonClick=this._onButtonClick.bind(this),this._focusTextInput=this._focusTextInput.bind(this),this.updateSearchTextAndFind=this.updateSearchTextAndFind.bind(this),this.props.isGridPaginationStateFeatureEnabled&&this.props&&this.props.gridInput&&this.props.gridInput.quickFindExpression?this.state={quickFindText:this.props.gridInput.quickFindExpression.trim(),currentViewId:this.props.currentViewIdToRestore,clearQuickFind:!0}:this.state={quickFindText:null,currentViewId:null,clearQuickFind:!1}}clearSearchBar(){this.setState({quickFindText:null,clearQuickFind:!1})}updateSearchTextAndFind(t,e){this.setState({quickFindText:t},()=>{e&&this._applyQuickFind()})}_onButtonClick(t){this.props.updateDataSetLoadingState(1),this.state.clearQuickFind?this._clearQuickFind():this._applyQuickFind()}_onkeyDown(t){t.keyCode===Pt.a.Enter&&(this.props.updateDataSetLoadingState(1),this._applyQuickFind())}_onTextInputChange(t){const e=""===t;this.setState({quickFindText:t,clearQuickFind:e})}_applyFilter(){const t=this._formatQuickFindText(),e=Object(jt.b)(t,this.props.primaryNameAttribute);this.props.applyGridFilter(e,this.props.contextToken)}_clearFilter(){this.setState({quickFindText:""},()=>{this._applyFilter()})}_formatQuickFindText(){return this.state.quickFindText.split("*").join("%").replace(/%?\s*$/,"%")}_applyQuickFind(){this.state.quickFindText&&""!==this.state.quickFindText.trim()?this.props.shouldUseFilter?(this._applyFilter(),this.setState({clearQuickFind:!0})):this.props.applyQuickFind(this.state.quickFindText,this.props.id,this.props.gridInput,this.props.contextToken,this.props.controlName,this.props.isGridPaginationStateFeatureEnabled).then(t=>{this.setState({clearQuickFind:!0}),this.state.currentViewId||this.setState({currentViewId:t})}):this._clearQuickFind()}_clearQuickFind(){this.props.shouldUseFilter?(this._clearFilter(),this.setState({clearQuickFind:!1})):this.props.clearQuickFind(this.state.currentViewId,this.props.id,this.props.gridInput,this.props.contextToken,this.props.controlName).then(()=>{this.setState({quickFindText:"",currentViewId:null,clearQuickFind:!1})})}_getPlaceholderText(){return this.props.isGridSearchCanUseCurrentViewFeatureEnabled?this.props.shouldGridSearchUseCurrentView?Object(w.c)(this.props.resourceStrings,P.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT_SEARCH_THIS_VIEW):Object(w.c)(this.props.resourceStrings,P.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT_QUICK_FIND_VIEW):Object(w.c)(this.props.resourceStrings,P.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT)}_createUniqueId(t){const{contextToken:e,id:n}=this.props;return e.controlName?`${t}_${e.controlName}_${n}`:`${t}_${n}`}render(){const t=this._getPlaceholderText(),e=Object(w.c)(this.props.resourceStrings,P.QUICK_FIND_TOOLTIP_CLEAR_BUTTON);if(this.props.showNewQuickFindSearchBarForMobile)return r.createElement(o.a,null,r.createElement(L.i,{placeholder:t,cancelText:Object(w.c)(this.props.resourceStrings,P.QUICK_FIND_CANCEL_LABEL_ID),clearText:e,applyQuickFind:this._applyQuickFind,windowWidth:this.props.viewPortWidth,updateSearchTextAndFind:this.updateSearchTextAndFind,value:this.state.quickFindText,quickFindRNStyleProps:this.props.quickFindRNStyleProps}));const n=this._createUniqueId("quickFind_text"),a=this._createUniqueId("quickFind_button"),i=this._createUniqueId("quickFind_button_icon"),s=Object(w.c)(this.props.resourceStrings,P.QUICK_FIND_TOOLTIP_APPLY_BUTTON),c=this.state&&this.state.clearQuickFind?e:s;return r.createElement(o.a,{style:this.props.styleProps.quickFindStyle,testhooks:{id:"data-set-quickFind-container"}},r.createElement(zt.a,{id:n,key:n,ref:t=>{this._quickFindInnerTextRef=t},testhooks:{id:n},value:this.state&&this.state.quickFindText?this.state.quickFindText:null,accessibilityLabel:t,onChangeText:this._onTextInputChange,onKeyDown:this._onkeyDown,style:this.props.styleProps.inputStyle,placeholder:t}),r.createElement(vt.a,{id:a,key:a,testhooks:{id:a},accessibilityLabel:c,title:c,onClick:this._onButtonClick,tabIndex:0,style:this.props.styleProps.buttonStyle},r.createElement(Q.b,{id:i,key:i,type:this.state&&this.state.clearQuickFind?d.a.Cancel:d.a.SearchButton,style:this.props.styleProps.buttonIconStyle})))}_focusTextInput(){if(this.props.focusSearchBoxAfterRender&&!this._searchBarFocusTriggered){const t=a.findDOMNode(this._quickFindInnerTextRef);t&&(t.focus(),this._searchBarFocusTriggered=!0)}}componentDidMount(){this._focusTextInput()}}Qt.displayName="DataSetQuickFind";const Jt=Object(s.a)((function(){let t=null,e=null,n=null,r={quickFindText:null,currentViewId:null,clearQuickFind:null,primaryNameAttribute:null,styleProps:null,quickFindRNStyleProps:null,shouldUseFilter:!1,resourceStrings:null,isGridPaginationStateFeatureEnabled:null,currentViewIdToRestore:null,shouldGridSearchUseCurrentView:null,isGridSearchCanUseCurrentViewFeatureEnabled:null,isQuickFindImprovementsFeatureEnabled:null,viewPortWidth:null};const a=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let t,e=null,n=null,r={buttonStyle:{border:"none",padding:"0",backgroundColor:"transparent",flexDirection:"column","-webkit-appearance":"none"},inputStyle:{border:"none",backgroundColor:"transparent",width:"100%",minWidth:"0px","-webkit-appearance":"none","::-ms-clear":{display:"none"}},quickFindStyle:{borderWidth:"1px",borderStyle:"solid",display:"flex",flexDirection:"row",width:"100%"},buttonIconStyle:{fontWeight:"bold",marginTop:"auto",marginBottom:"auto",width:"100%"}};return function(a,i){var s,o,c,l,u,d,p,h,g,m,b,f,y,v,_,S;const O=Object(Wt.g)(a),C=Object(Ct.b)(a)&&Object(G.a)(a,B.Fb,B.Lc)&&(null===(s=Object(Ct.a)(a))||void 0===s?void 0:s.Components)?Object(Ct.a)(a).Components:null;if(C&&(r=Object.assign(r,{inputStyle:{color:null===(l=null===(c=null===(o=null==C?void 0:C.Grid)||void 0===o?void 0:o.ColumnHeader)||void 0===c?void 0:c.QuickFind)||void 0===l?void 0:l.TextColor,backgroundColor:null===(p=null===(d=null===(u=null==C?void 0:C.Grid)||void 0===u?void 0:u.ColumnHeader)||void 0===d?void 0:d.QuickFind)||void 0===p?void 0:p.BackgroundColor,borderColor:"transparent"},searchIconStyle:{color:null===(m=null===(g=null===(h=null==C?void 0:C.Grid)||void 0===h?void 0:h.ColumnHeader)||void 0===g?void 0:g.QuickFind)||void 0===m?void 0:m.IconColor},buttonIconStyle:{color:null===(y=null===(f=null===(b=null==C?void 0:C.Grid)||void 0===b?void 0:b.ColumnHeader)||void 0===f?void 0:f.QuickFind)||void 0===y?void 0:y.IconColor}})),e!==i||t!==O){e=i,t=O;const s=Object(Ot.a)(a),o=Object.assign(Object.assign({},r.buttonStyle),{":before":{content:"''",display:"inline-block",width:s.sizes.Measures.Measure250}}),c=Object.assign(Object.assign({},r.quickFindStyle),{borderColor:(null===(S=null===(_=null===(v=null==C?void 0:C.Grid)||void 0===v?void 0:v.ColumnHeader)||void 0===_?void 0:_.QuickFind)||void 0===S?void 0:S.BorderColor)||s.colors.BaseColor.Grey.Grey3,["padding"+(O?"Right":"Left")]:s.sizes.Measures.Measure025});n=Object.assign(Object.assign({},r),{buttonStyle:o,quickFindStyle:c})}return n}}(),i=Object(Yt.a)(),s=Object(w.h)();let o=null;return(c,l)=>{const u=a(c,l.contextString),d=i(c,l);n||(n=s(c,P.labelList)),t!==u&&(t=u),e!==d&&(e=d),o||(o=Object(G.c)(c,B.bd));const p=Object(G.a)(c,B.zb);let h=null;if(p&&l.gridInput){h=(l.gridInput&&l.gridInput.viewId&&!_.a.isNullOrEmpty(l.gridInput.viewId)?l.gridInput.viewId:null)||Object(O.a)(c,l.entityTypeName,C.a.MAIN_APPLICATION_VIEW)}return r={quickFindText:"",currentViewId:null,clearQuickFind:!1,primaryNameAttribute:Object(A.E)(c,l.entityTypeName),styleProps:t,quickFindRNStyleProps:e,shouldUseFilter:!(Object(It.e)(l.contextString)||Object(It.d)(l.contextString)||Object(It.g)(l.contextString)&&o),resourceStrings:n,isGridPaginationStateFeatureEnabled:p,currentViewIdToRestore:h,shouldGridSearchUseCurrentView:Object(it.l)(c),isGridSearchCanUseCurrentViewFeatureEnabled:Object(G.a)(c,B.Db,B.h),isQuickFindImprovementsFeatureEnabled:Object(G.a)(c,B.ad,B.tc),viewPortWidth:Object(Kt.c)(c)},r}}),(function(t,e){return{applyQuickFind:(n,r,a,i,s,o)=>{if(a&&o){const t=[{filterType:1,filterExpressionOrValue:n}];a.entityTypeName===f.a&&t.push({filterType:2,filterExpressionOrValue:e.entityTypeName}),e.updateGridPaginationStateHandler(t,e.id),e.resetPagingInfoForEnhancedPaging()}return t(Object(Ht.a)(n,r,i,s))},clearQuickFind:(n,r,a,i,s)=>{if(a){const t=[{filterType:1,filterExpressionOrValue:null}];e.updateGridPaginationStateHandler(t,e.id)}return t(Object(Ht.b)(n,r,i,s))},applyGridFilter:(n,r)=>{t(Object(St.n)(n,e.id,r))}}}),null,{forwardRef:!0})(Qt);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Zt=({onSeeMoreClick:t,resourceStrings:e,containerStyle:n,buttonStyle:a,seeMoreTextStyle:i,localizedStrings:s})=>function(t,e,n,a,i,s){const c=(null==s?void 0:s.seeMoreTooltip)||Object(w.c)(e,P.SEE_MORE_TOOL_TIP),u=(null==s?void 0:s.seeMoreLabel)||Object(w.c)(e,P.SEE_MORE_LABEL);let d=c;return(null==s?void 0:s.uniqueLabel)&&(d+=" "+s.uniqueLabel),r.createElement(o.a,{style:n},r.createElement(vt.a,{key:"seeMoreBtn",id:"seemore-btn",title:c,style:a,onClick:t,tabIndex:0,accessibilityLabel:d,describedByElementId:null},r.createElement(l.a,{style:i},u)))}(t,e,n,a,i,s)
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */;var $t=n("5R5s"),te=n("kKLx"),ee=n("vNXc"),ne=n("504W"),re=n("aF0N");var ae=n("iOrn"),ie=n("zFtG"),se=n("waMg"),oe=n("6Qf/"),ce=n("B9jE"),le=n("Jpj4"),ue=n("E6o7"),de=n("QXpm"),pe=n("rQHy"),he=n("kt5S"),ge=n("Nb1E"),me=n("odYE"),be=n("wyQO");var fe=n("fyfl"),ye=n("ojtV"),ve=n("2YQW"),_e=n("ngeo"),Se=n("WZ96"),Oe=n("QBtP"),Ce=n("1uZV"),Ie=n("tICD"),Pe=n("uNu9"),je=n("PVDM"),Te=n("PZ34");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Ee(t){return r.createElement(ct.a,{loader:()=>Promise.all([n.e(9),n.e(10),n.e(11),n.e(13),n.e(12),n.e(14),n.e(15),n.e(17),n.e(21),n.e(33)]).then(n.bind(null,"BvEH")).then(t=>t.DataSetExpressionBuilder),props:t})}Ee.displayName="DataSetExpressionBuilderLazyLoadComponent";var Fe=n("b41/"),we=n("p/Kg"),xe=n("Tz6o"),Ae=n("BkgE"),Ne=n("+HfF"),ke=n("Uv1Y"),De=n("VcAV"),Me=n("eOoD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Re(t){return r.createElement(ct.a,{loader:()=>Promise.all([n.e(9),n.e(10),n.e(11),n.e(13),n.e(12),n.e(14),n.e(16),n.e(112),n.e(32)]).then(n.bind(null,"12bH")).then(t=>t.ColumnEditor),props:t})}Re.displayName="ColumnEditorLazyLoadComponent";var Le=n("2Sll"),Ve=n("ozuu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
Object(Le.a)();const Be=f.x+".DataSetHost",Ge=Be+".AdvancedFind.Open",Xe=Be+".AdvancedFind.Discard";class Ue extends r.Component{constructor(t){super(t),this._quickFindCommandBarId="showQuickFind",this._changeVisualizationCommandBarId="changeVisualization",this._savedDefault=null,this._savedFormInfo=null,this._currentFilterValue=null,this._addedCommandListFromHost=[],this._addedCommandListFromControl=[],this._addedCommandListFromHostParent=[],this._memoizedConfiguration=null,this._memoizedResourceStrings=null,this._memoizedViewConfigurations=null,this._memoizedButtonList=null,this._parentSwitchVisualizationButton=null,this._keyIndex=0,this._width=0,this._height=0,this._isFirstRequestComplete=!1,this._isPreNavigationEventAttached=!1,this._offlineSqlQueryRetrieveState=0,this._dataSetQuickFindRef=r.createRef(),this._isSubGridFirstLoad=!1,this._minWidthForChartPlusGridReflow=640,this._isReflowLayoutVertical=!1,this._isSwitchVisualizationInitialized=!1,this._accessibilityId=1,this._incrementLastPage=()=>{this.props.pageNumber===this.state.pagingInfo.lastPageNumber&&this.setState({pagingInfo:Object.assign(Object.assign({},this.state.pagingInfo),{lastPageNumber:this.state.pagingInfo.lastPageNumber+1})})},this._setFirstPage=t=>{this.setState({pagingInfo:Object.assign(Object.assign({},this.state.pagingInfo),{firstPageNumber:t})})},this._seeMorePopup=this._seeMorePopup.bind(this),this._onSendControlCommandsEventFired=this._onSendControlCommandsEventFired.bind(this),this._onSelectedOrderColumnChangeFired=this._onSelectedOrderColumnChangeFired.bind(this),this._onParentPagePreNavigationEventFired=this._onParentPagePreNavigationEventFired.bind(this),this._onFilterChange=this._onFilterChange.bind(this),this._onActivityTypeMenuDismissed=this._onActivityTypeMenuDismissed.bind(this),this._updateDataSetLoadingStateEvent=this._updateDataSetLoadingStateEvent.bind(this),this._updateFilterValue=this._updateFilterValue.bind(this),this._onRollupViewToggleChanged=this._onRollupViewToggleChanged.bind(this),this._onQuickFind=this._onQuickFind.bind(this),this._onItemIconPointerDown=this._onItemIconPointerDown.bind(this),this._onViewChanged=this._onViewChanged.bind(this),this._onControlLoadedError=this._onControlLoadedError.bind(this),this._updatePagingInfo=this._updatePagingInfo.bind(this),this._updateFilterExpressionStrings=this._updateFilterExpressionStrings.bind(this),this._configureDataSetControlParams=this._configureDataSetControlParams.bind(this),this._openManageDuplicatesDialog=this._openManageDuplicatesDialog.bind(this),this._showInnerError=this._showInnerError.bind(this),this._isInSeeMoreState=this._isInSeeMoreState.bind(this),this._getChartPaneText=this._getChartPaneText.bind(this),this.onMeasuring=this.onMeasuring.bind(this),this.closeFilterPanel=this.closeFilterPanel.bind(this),this._clearActivityTypeFilter=this._clearActivityTypeFilter.bind(this),this._updateCurrentPageNumber=this._updateCurrentPageNumber.bind(this),this._isNativePlatform=null!=t.platformType&&t.platformType===b.b.Native,this._currentPagingString=null,this._preSeeMoreCachedPagingString=null,this._boundOnRecordsSelected=null,this._pageNumberToRestoreForEnhancedPaging=this.props.pageNumberForEnhancedPaging,this._shouldResetPagingForEnhancedPaging=!1,this._previousSortingInfo=null,this._resetProcessedForEnhancedPaging=!0,this.state={quickFindVisibility:!1,addedCommandList:[],inSeeMoreState:!1,pagingInfo:{firstPageNumber:Object(ne.a)(this.props.pageNumberForEnhancedPaging)?1:this.props.pageNumberForEnhancedPaging,lastPageNumber:Object(ne.a)(this.props.pageNumberForEnhancedPaging)?1:this.props.pageNumberForEnhancedPaging,currentPageNumber:Object(ne.a)(this.props.pageNumberForEnhancedPaging)?1:this.props.pageNumberForEnhancedPaging,pageShift:0,isGridScrolledToBottom:!1},compositeControlInitState:N.a.Uninitialized,controlLoadErrorMessage:null,controlLoadInnerErrorMessage:null,loadingState:0,isFilterPanelOpen:!1,columnEditorPanelOpen:!1,isAdvancedFilterEdited:!1},this._parentDefinedProps={eventListeners:[{eventname:"sendgridcontrolcommandstohostcommandbar",eventhandler:[this._onSendControlCommandsEventFired]},{eventname:"onselectedordercolumnchange",eventhandler:[this._onSelectedOrderColumnChangeFired]},{eventname:"parentPagePreNavigation",eventhandler:[this._onParentPagePreNavigationEventFired]},{eventname:"sendpaginginfotopagingcontrol",eventhandler:[this._updatePagingInfo]},{eventname:"sendfilterexpressionstringstodatasethost",eventhandler:[this._updateFilterExpressionStrings]},{eventname:"updatedatasethostloadingstate",eventhandler:[this._updateDataSetLoadingStateEvent]},{eventname:"openmanageduplicatesdialog",eventhandler:[this._openManageDuplicatesDialog]},{eventname:"showinnererror",eventhandler:[this._showInnerError]},{eventname:"sendcurrentpagenumber",eventhandler:[this._updateCurrentPageNumber]}],containerStyleOverrides:{rootContainer:{flex:Object(It.e)(t.contextString)?"1 1 100%":"1 1 auto",minHeight:"0"}},onControlLoadedError:this._onControlLoadedError},this._seeMoreHelper=new m.a}_logInfo(t){this._tracer&&this._tracer.info(t)}_updateDataSetLoadingStateEvent(t){this._updateDataSetLoadingState(t.value)}_updateDataSetLoadingState(t,e={}){(1===t&&this.props.featureControlProps.isGridProgressIndicatorFeatureEnabled||1!==t)&&(this.setState(Object.assign(e,{loadingState:t})),this._currentLoadingTimeoutIdentifier&&clearTimeout(this._currentLoadingTimeoutIdentifier),this._currentLoadingTimeoutIdentifier=null,1===t&&(this._currentLoadingTimeoutIdentifier=setTimeout(()=>{this._updateDataSetLoadingState(2)},3e4)))}_openManageDuplicatesDialog(t){!this.props.isOffline&&t&&t.entityReference&&t.reject&&this.props.openManageDuplicatesDialog(t)}_showInnerError(t){this.props.showInnerError(t)}_updatePagingInfo(t){t&&t.currentPageNumber>0&&(this.props.setNewPageRequested(this.props.id,this.props.contextToken,!1),this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&(this._resetProcessedForEnhancedPaging||1!==t.currentPageNumber||(this._resetProcessedForEnhancedPaging=!0,this._pageNumberToRestoreForEnhancedPaging=1),this.props.pageNumberForEnhancedPaging!==t.currentPageNumber&&this.props.updatePageNumberForEnhancedPaging(t.currentPageNumber,this.props.contextToken)),Object(ve.e)(this.state.pagingInfo,t)||this.setState({pagingInfo:t}))}_updateCurrentPageNumber(t){t&&t.currentPageNumber>0&&this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,t.currentPageNumber)}_updateFilterExpressionStrings(t){if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&t&&(t.nativeFilterExpressionString||t.dataSetFilterExpressionString)){const e=[{filterType:5,filterExpressionOrValue:t.nativeFilterExpressionString},{filterType:6,filterExpressionOrValue:t.dataSetFilterExpressionString}];this.props.updateGridPaginationStateHandler(e,this.props.id),this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1)}}_setResetPagingInfoForEnhancedPaging(){this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&this._isNativePlatform&&(this._shouldResetPagingForEnhancedPaging=!0)}_resetPagingInfoForEnhancedPaging(){this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&this._isNativePlatform&&(this.setState({pagingInfo:{firstPageNumber:1,lastPageNumber:1,currentPageNumber:1,pageShift:0,isGridScrolledToBottom:!1}}),this._pageNumberToRestoreForEnhancedPaging=1)}_onControlLoadedError(t){const e=t?t.message:null;this._logTelemetryData(e),this._setControlLoadError()}_setControlLoadError(t=P.GRID_CONTROL_LOAD_ERROR){this.setState({controlLoadErrorMessage:Object(w.c)(this.props.resourceStrings,t)})}_logTelemetryData(t){this._tracer&&this._tracer.error("Loading for the grid failed because of error :"+(t||"CustomControl_Calendar_ErrorView_DefaultMessage"))}_renderTitle(){if(!this.props.descriptor)return null;const{ShowLabel:t,Name:e,Label:n}=this.props.descriptor,a=this._isWidthLessThanViewportSm()?this.props.styles.titleMobileStyle:this.props.styles.titleStyle;return t&&n?r.createElement(l.a,{key:e,semanticTag:"div",style:a},n):null}onMeasuring(t,e){if(this._height=e,Math.abs(this._width-t)<50)return;if(this._width=t,this._getCachedSize()&&t===this._getCachedSize().width&&(!e||e===this._getCachedSize().height))return;const n={},r=this._seeMoreHelper.shouldGivePoppedOutDimensions(!0),a=this._seeMoreHelper.getSeeMorePopupInfo(),i=r?a.endWidthInner:t,s=[];!this._isWidthInitialized()&&t>0&&(n.isWidthInitialized=!0,s.push("isWidthInitialized:"+n.isWidthInitialized));const o=i<=this.props.viewportSm;o!==this._isWidthLessThanViewportSm()&&(n.isWidthLessThanViewportSm=o,s.push("isWidthLessThanViewportSm:"+o));const c=i<=this.props.viewportM;c!==this._isWidthLessThanViewportM()&&(n.isWidthLessThanViewportM=c,s.push("isWidthLessThanViewportM:"+c));const l=i<this._minWidthForChartPlusGridReflow;l!==this._isWidthLessThanMinWidthForChartPlusGridReflow()&&(n.isWidthLessThanMinWidthForChartPlusGridReflow=l,s.push("isWidthLessThanMinWidthForChartPlusGridReflow:"+l));const u=this._jumpBarShouldRenderAsFlyout(i);u!==this._isJumpBarRenderingAsFlyout()&&(n.isJumpBarRenderingAsFlyout=u,s.push("isJumpBarRenderingAsFlyout:"+u));const d=i>480;d!==this._isWidthGreaterThan480()&&(n.isWidthGreaterThan480=d,s.push("isWidthGreaterThan480:"+d));const p=r?a.endHeightInner:e,h=p>240;h!==this._isHeightGreaterThan240()&&(n.isHeightGreaterThan240=h,s.push("isHeightGreaterThan240:"+h)),0!==t&&0!==e||this._tracer&&this._tracer.warn(`The measuring service returned width or height as 0. The new dimensions are width is ${t} and height is ${e}`);let g=!1;const m=this.props.quickFindProps&&o&&!this._checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot();m!==this._showCommandBarButtonSearch()&&(n.showCommandBarButtonSearch=m,s.push("showCommandBarButtonSearch:"+m),g=!0);const b=Object(It.e)(this.props.contextString)||Object(It.d)(this.props.contextString)&&this.props.featureControlProps.isChartOnAssociatedGridEnabled;if(b!==this._showCommandBarButtonShowChart()&&(n.showCommandBarButtonShowChart=b,s.push("showCommandBarButtonShowChart:"+b),g=!0),s.length>0){s.push("currentWidth:"+t),s.push("currentHeight:"+e),s.push("usePoppedOutDimensions:"+r),s.push("newWidth:"+i),s.push("newHeight:"+p),s.push("commandBarNeedsUpdate:"+g);const n=s.join(",");this._logInfo("onMeasuring change: "+n)}this._getCachedSize()&&this._getCachedSize().update&&(this._cachedSize=this._getCachedSize().update({width:t,height:e,isWidthInitialized:t>0,isWidthLessThanViewportSm:o,isWidthLessThanViewportM:c,isWidthLessThanMinWidthForChartPlusGridReflow:l,isJumpBarRenderingAsFlyout:u,isWidthGreaterThan480:d,isHeightGreaterThan240:h,showCommandBarButtonSearch:m,showCommandBarButtonShowChart:b}));let f=n;g&&(f=Object.assign(f,this._getUpdateAddedCommandList(m,b))),Object.keys(f).length&&this.setState(f)}_getUpdateAddedCommandList(t,e){if(this._addedCommandListFromHost=[],t&&(this._logInfo("Adding search button to commandbar for DataSethost."),this._addedCommandListFromHost.push({Icon:"SearchButton",DisplayText:Object(w.c)(this.props.resourceStrings,P.QUICK_FIND_COMMANDBAR_TEXT),Id:this._quickFindCommandBarId,execute:this._onQuickFind})),this.props.isQueryMode){this._logInfo("Adding clear query button to commandbar for DataSethost.");const t=this._getClearQueryText();this._addedCommandListFromHost.push({Icon:"ClearDefault",DisplayText:t,Tooltip:{title:t},Id:"ClearQuery",execute:()=>this.props.clearQuery()})}if(!this.props.isOffline&&e){this._logInfo("Adding show chart button to commandbar for DataSethost.");const t=this._getChartPaneText();this._addedCommandListFromHost.push({Icon:"SelectChart",DisplayText:t,Tooltip:{title:t},Id:"ShowChartPane",execute:()=>this.props.toggleChartPane(this.props.id,this.props.contextToken,!this.props.showChart)})}return this._onAddedCommandListChange(!1)}_onViewChanged(t,e,n=!0){var r;n&&this._updateDataSetLoadingState(1);const a=this.props.descriptor?this.props.descriptor.Id:null;this._logInfo("The view for the grid changed. The new view parameters for the view are - NewViewId : "+t+", EntityTypeName : "+e+"and ControlName : "+a),this._resetPagingInfoForEnhancedPaging(),null===(r=this._dataSetQuickFindRef.current)||void 0===r||r.clearSearchBar();const i=this.props.gridInput&&this.props.gridInput.entityTypeName.toLowerCase()===j.a;this.props.updateView(this.props.id,a,t,e,this.props.commandBarProps&&this.props.commandBarProps.commandManagerId,this.props.contextToken,this.props.userId,this.props.featureControlProps&&this.props.featureControlProps.isQueueFilterPerfUCIEnabled,i).then(()=>{this.props.nonCompositionProps&&this.props.nonCompositionProps.setPageInputViewId&&this.props.nonCompositionProps.setPageInputViewId(t),this.state.controlLoadErrorMessage&&this.setState({controlLoadErrorMessage:null})},t=>{this._logInfo(t.message),this._setControlLoadError()})}_onItemIconPointerDown(t,e,n,r,a){this._logInfo("“Trying to set default view for user. The new view parameters for the view are - NewViewId : "+e+", EntityTypeName : "+t+", ViewType : "+n+"and Unpin  : "+a);const i=st(this._currentFilterValue);return this.props.updateUserDefaultGridView(t,e,n,r,i,a)}_onQuickFind(){this.setState({quickFindVisibility:!this.state.quickFindVisibility})}_getChartPaneText(){const{resourceStrings:t,showChart:e}=this.props;return e?Object(w.c)(t,P.CHARTS_HIDE_CHART_PANE_LABEL):Object(w.c)(t,P.CHARTS_SHOW_CHART_PANE_LABEL)}_getClearQueryText(){return"Clear query"}_updateFilterValue(t){this._currentFilterValue=t}_onFilterChange(t,e=this.props.gridEntityTypeName){this._logInfo("Applying grid filter, the new value received is "+t),2===this.state.loadingState&&this._updateDataSetLoadingState(1),this._updateFilterValue(t);const n=Object($t.a)(this.props.viewSelectorProps.entityTypeName,this.props.userId,this.props.contextToken,this.props.featureControlProps.isQueueFilterPerfUCIEnabled,this.props.entityIsActivityType).getFilterExpression(t,this.props.userSetting,e);this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1),this._setResetPagingInfoForEnhancedPaging(),this.props.applyGridFilter(n,t,this.props.contextToken)}_clearActivityTypeFilter(){this.props.applyActivityTypeFilter("","",this.props.contextToken)}_onActivityTypeMenuDismissed(t){if(!this.props.isOffline){const e=t.join(","),n=function(t,e){if(null!=t){if(t.indexOf("selectAllKey")>-1||0===t.length||null!=e&&e.length===t.length)return null;let n=null;const r=[];for(let e=0;e<t.length;e++)r.push({attributeName:"activitytypecode",conditionOperator:0,value:t[e]});return r&&r.length>0&&(n={conditions:r,filterOperator:1}),n}}(t,this.props.entityFilterProps.filterOptionsForActivityType),r=n?JSON.stringify(n):"";void 0===this.props.entityFilterProps.activityTypePreviousValues?this.props.applyActivityTypeFilter(r,e,this.props.contextToken):e!==this.props.entityFilterProps.activityTypePreviousValues&&this._shouldActivitySelectAllFilterFire(e,this.props.entityFilterProps.activityTypePreviousValues,this.props.entityFilterProps.isActivityFilterSelectAllEnabled)&&(this._logInfo("Applying activity type grid filter, the new value received is "+e),2===this.state.loadingState&&this._updateDataSetLoadingState(1),this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1),this._setResetPagingInfoForEnhancedPaging(),this.props.applyActivityTypeFilter(r,e,this.props.contextToken));const a=[{name:"ActivityTypeFilterUsage",value:"Initiated"},{name:"SelectedActivityTypeFilterCount",value:t.length},{name:"ActivityTypeFilterDropDownCount",value:this.props.entityFilterProps.filterOptionsForActivityType.length}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentSuccess&&this.context.EventManager.ReportComponentSuccess(Be,a)}}_shouldActivitySelectAllFilterFire(t,e,n){if(n){let n=!1,r=!1;return(e.indexOf("selectAllKey")>-1||""===e)&&(n=!0),(t.indexOf("selectAllKey")>-1||""===t)&&(r=!0),!(n&&r)}return!0}_onRollupViewToggleChanged(t){this._logInfo("Toggling rollupView control, the new value received is "+t),this.props.toggleGridRollupView(t,this.props.contextToken)}_updateFilterOnViewSelectorChange(t){this._logInfo("Updating dataset with the existing filter selection for activity pointer"),this._onFilterChange(this._currentFilterValue,t)}_onSendControlCommandsEventFired(t){this._logInfo("Adding control commands to command bar. The command to be added are : "+t),t!==this._addedCommandListFromControl&&(this._addedCommandListFromControl=t,this._onAddedCommandListChange())}_onSelectedOrderColumnChangeFired(t){if(this._logInfo("Updating jumpbar filter based on the selected order column"),this.props.featureControlProps.isJumpBarShouldHonorSortingFeatureEnabled&&this.props.jumpBarProps){let e=t.columnSortingName;e=Object(jt.d)(e,t.columnSortingType,t.primaryNameAttribute);const n=Object(jt.b)(this.props.jumpBarProps.selectedFilter,e);this.props.onSelectedOrderColumnChange(n,this.props.contextToken)}}_onParentPagePreNavigationEventFired(t){t&&Array.isArray(t)&&t.length>0&&!this._isPreNavigationEventAttached&&this.context&&this.context.Router&&this.context.Router.registerPreNavigationHandler&&(this._tracer&&this._tracer.info("Adding control preNavigation handlers to the router"),t.forEach(t=>this.context.Router.registerPreNavigationHandler(()=>{try{return t()}catch(t){const e=[{name:"subComponent",value:"onPreNavigation"}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentFailure&&this.context.EventManager.ReportComponentFailure(Be,t,null,e)}return Promise.resolve(!0)})),this._isPreNavigationEventAttached=!0)}_createSwitchVisualization(t,e){return()=>{switch(this._keyIndex++,this.props.contextString){case f.h.ASSOCIATEDGRID:this.props.switchAssociatedGridVisualization(this.props.id,this.props.entityTypeName,this.props.controlId,this.props.viewId,t,this.props.nonCompositionProps&&this.props.nonCompositionProps.viewConfigurations,this.props.nonCompositionProps&&this.props.nonCompositionProps.gridConfigurations,"VIEW_CONFIG"===e);break;case f.h.SUBGRID:this.props.switchSubgridVisualization(this.props.id,t,this.props.controlId);break;case f.h.GRID:default:if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput){const t=[{filterType:3,filterExpressionOrValue:null}];this.props.updateGridPaginationStateHandler(t,this.props.id),this.props.setCustomFilter("",0,this.props.id,this.props.contextToken)}"VIEW_CONFIG"===e?this.props.switchViewConfiguration(this.props.id,this.props.contextToken,t,this.props.controlId,!1):this.props.switchHomepageConfiguration(this.props.id,this.props.contextToken,t,this.props.controlId,!0)}}}_updateChangeVisualizationButtons(t){let e=[];const n=this.props.nonCompositionProps&&this.props.nonCompositionProps.gridConfigurations,r=this.props.nonCompositionProps&&this.props.nonCompositionProps.viewConfigurations;let a=!1;this._parentSwitchVisualizationButton||(this._parentSwitchVisualizationButton={Icon:"SelectChart",DisplayText:Object(w.c)(this.props.resourceStrings,P.SWITCH_VISUALIZATION_BUTTON_LABEL),Id:this._changeVisualizationCommandBarId+"-Parent",WillOpenFlyout:!0,Children:null}),this._memoizedConfiguration===this.props.updatedConfiguration&&this._memoizedViewConfigurations===r&&this._memoizedResourceStrings===this.props.switchVisualizationResourceStrings||this.props.switchVisualizationResourceStrings&&(this._memoizedConfiguration=this.props.updatedConfiguration,this._memoizedViewConfigurations=r,this._memoizedResourceStrings=this.props.switchVisualizationResourceStrings,this._memoizedButtonList=[],e=Object(he.c)(n,r,this.props.updatedConfiguration,this.props,this.props.contextString,t),e.forEach(e=>{if(Object(he.a)(this.props.updatedConfiguration,e.configuration)||e.configuration.isDefaultConfig&&this.props.updatedConfiguration.isDefaultConfig||this.props.featureControlProps.isDisableEditableGridControlOnPhoneFeatureEnabled&&Object(it.g)(e.configuration,parseInt(t,10)))return;const n={Icon:"SelectChart",DisplayText:""+Object(he.b)(this.props.switchVisualizationResourceStrings,e.configuration),Id:`${this._changeVisualizationCommandBarId}-${e.configuration.Name}-${e.formFactor}`,execute:this._createSwitchVisualization(e.configuration,e.configurationType),IsInFlyout:!0};this._memoizedButtonList.push(n),a=!0})),!this._isSwitchVisualizationInitialized&&this.props.commandBarProps&&(Object(he.d)(this.props.retrieveControlResourceStringsForSwitchVisualization,this.context,n,r,this.props.updatedConfiguration,this.props,this.props.contextString,t),this._isSwitchVisualizationInitialized=!0),this._parentSwitchVisualizationButton.Children=this._memoizedButtonList,a&&this._onAddedCommandListChange()}_onAddedCommandListChange(t=!0){var e,n,r,a;const i=[],s=[],o=(null===(n=null===(e=this._parentSwitchVisualizationButton)||void 0===e?void 0:e.Children)||void 0===n?void 0:n.length)>0;if(this.props.featureControlProps.isShowAsButtonFirstEnabled&&o&&s.push(this._parentSwitchVisualizationButton),s.push(...this._addedCommandListFromControl),s.push(...this._addedCommandListFromHost),(null===(a=null===(r=this.props.nonCompositionProps)||void 0===r?void 0:r.addedCommandListFromHostParent)||void 0===a?void 0:a.length)>0&&i.push(...this.props.nonCompositionProps.addedCommandListFromHostParent),!this.props.featureControlProps.isShowAsButtonFirstEnabled&&o&&i.push(this._parentSwitchVisualizationButton),!t)return{addedCommandList:s,appendedCommandList:i};this&&this.setState&&this.setState({addedCommandList:s,appendedCommandList:i})}_seeMoreCallback(t){this.setState({inSeeMoreState:!this.state.inSeeMoreState})}_seeMorePopup(t,e=!1){!0===t?(this._preSeeMoreCachedPagingString=this._currentPagingString,this._currentPagingString=null):(this._currentPagingString=this._preSeeMoreCachedPagingString,this._preSeeMoreCachedPagingString=null),this._keyIndex++,this._seeMoreHelper.seeMorePopup(this._getDataSetHostRootElement(),this._seeMoreCallback.bind(this),t,e,this.props.isRTL)}_getDataSetHostRootElement(){return a.findDOMNode(this)}_onRecordsSelectedCallback(t,e){this._logInfo("onRecordsSelected for DataSetHost. New selected rows are "+e);const n=[];for(const t of e)n.push(new _.a(t));if(this.props.markSelectedRows(this.props.id,this.props.contextToken,n),t){const t=this.props.updatedConfiguration.Parameters[this.props.nestedGridDatasetName];this.props.markSelectedRelatedEntity(this.props.id,this.props.contextToken,t.TargetEntityType)}else this.props.markSelectedRelatedEntity(this.props.id,this.props.contextToken,null);this.props.isGridEditable&&e.length>0&&this.props.rowProperties(this.props.id,this.props.contextToken,n),this.props.isGridEditable&&(this._logInfo("Running onRecordSelect for EditableGrid"),this.props.runOnRecordSelect(this.props.id,this.props.contextToken,n)),!t&&this._onRecordsSelectedParent&&(this._logInfo("onRecordsSelected: Calling onRecordsSelected callback for the parent control"),this._onRecordsSelectedParent(e))}markGridFirstRequestComplete(){this._isFirstRequestComplete=!0}_isDataSetHostKnownError(t){return!(!t||""===t)&&(-1!==t.indexOf(_e.a.getHexErrorCodeFromInt(2415919120))||!(-1===t.indexOf(_e.a.getHexErrorCodeFromInt(-2147093999))||this.props.offlineProps.isEntityAvailableForOffline&&this.props.offlineProps.isOfflineAvailableForUse))}_onDataSetUpdateCallback(t){this._logInfo("DataSetUpdated for DataSetHost control");const e=[{name:"currentPagingString",value:t&&t.existedPagingString||""}];this.markGridFirstRequestComplete(),this._currentPagingString!==t.existedPagingString&&e.push({name:"previousPagingString",value:this._currentPagingString});let n=!1;t.error?(n=this._isDataSetHostKnownError(t.errorMessage)||!Object(De.b)(t.innerError),t.innerError&&e.push({name:"InnerErrorMessage",value:t.innerError}),this.context.EventManager.ReportComponentFailure(Be,new Error(t.errorMessage||""),null,e)):this.context.EventManager.ReportComponentSuccess(Be,e);let r={};if(n)r={compositeControlInitState:N.a.Error,controlLoadErrorMessage:t.errorMessage},t.innerError&&(r.controlLoadInnerErrorMessage=t.innerError);else{this.props.updateFetchXml(this.props.id,this.props.contextToken,t.fetchXmlInUse);let e=null;if(t.existedFilteringString){const n=JSON.parse(t.existedFilteringString);e=Object(h.j)(n,Xt.CrmXmlEncode),this.props.setCustomFilter(e,0,this.props.id,this.props.contextToken)}if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled){const e=[];let n=!1,r=null;t.existedValidSortingArrayString&&(r=t.existedValidSortingArrayString);const a=!Object(ne.a)(r)&&JSON.parse(r);if(a&&a instanceof Array&&a.length>0&&r!==this.props.gridSortingInfo&&(this.props.gridInput&&e.push({filterType:7,filterExpressionOrValue:r}),n=!0),n){if(t.existedPagingString){const e=JSON.parse(t.existedPagingString);e.firstPageNumber&&(this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,e.firstPageNumber),this.props.gridInput&&this._setResetPagingInfoForEnhancedPaging())}this.props.gridInput&&this.props.updateGridPaginationStateHandler(e,this.props.id)}}this.props.updateQueryKey(t.newQueryKey,this.props.id,this.props.contextToken),this.props.updatePagingData(this.props.id,this.props.contextToken,t.existedPagingString),this.props.setNewPageRequested(this.props.id,this.props.contextToken,!1),this._logInfo("onDataSetUpdate: eventPagingString: "+t.existedPagingString),this._currentPagingString=t.existedPagingString}2!==this.state.loadingState?this._updateDataSetLoadingState(2,r):this.setState(r),this._accessibilityId++}_configureDataSetControlParams(){if(!this.props.updatedConfiguration)return;const t=this.props.updatedConfiguration.Parameters[this.props.primaryDataSetName];if(t){!Object(ne.a)(t.onRecordsSelected)&&Object(ne.a)(this._onRecordsSelectedParent)&&t.onRecordsSelected!==this._boundOnRecordsSelected&&(this._onRecordsSelectedParent=t.onRecordsSelected),this._isFirstRequestComplete&&(t.FirstDataRequestType=0),Object(ne.a)(this._boundOnRecordsSelected)&&(this._boundOnRecordsSelected=this._onRecordsSelectedCallback.bind(this,!1)),t.onRecordsSelected=this._boundOnRecordsSelected,t.onDataSetUpdate=this._onDataSetUpdateCallback.bind(this);const e=this.props.descriptor;let n=1,r=this.state.pagingInfo.lastPageNumber;this.props.isGridEditable||this._isNativePlatform?this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this._isNativePlatform&&(n=this.state.pagingInfo.firstPageNumber):(n=this.props.pageNumber,r=this.props.pageNumber);const a={firstPageNumber:n,lastPageNumber:r,pageSize:!this._isInSeeMoreState()&&e&&e.Parameters&&e.Parameters[f.q]&&parseInt(e.Parameters[f.q],10)||this.props.recordsPerPageSetting,pagingRefreshInput:this.props.pagingRefreshInput?this.props.pagingRefreshInput.toString():""},i=Object(Vt.a)(this._currentPagingString);if(i&&i.pageSize&&(this._logInfo("Updating pageSize based on _receivedPagingStringData.pageSize to "+i.pageSize),a.pageSize=i.pageSize),t.PagingInput={Static:!0,Value:JSON.stringify(a)},this.props.refreshCounter){const e=this.props.refreshCounter.toString();if(t.RefreshInput={Value:parseInt(e,10),Static:!0},!Object(ne.a)(this.props.customFilter)&&!Object(ne.a)(this.props.customFilter.customFilterXml)&&this.props.customFilter.source&&1===this.props.customFilter.source){const e=Object(h.i)(this.props.customFilter.customFilterXml);t.FilteringInput={Static:!0,Value:JSON.stringify(e)}}}if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput){if(!Object(ne.a)(this.props.customFilter)&&!Object(ne.a)(this.props.customFilter.customFilterXml)){const e=Object(h.i)(this.props.customFilter.customFilterXml);t.FilteringInput={Static:!0,Value:JSON.stringify(e)}}const e=!Object(ne.a)(this.props.gridSortingInfo)&&JSON.parse(this.props.gridSortingInfo),n=e&&e instanceof Array&&e.length>0,r=!Object(ne.a)(this._previousSortingInfo)&&JSON.parse(this._previousSortingInfo),a=r&&r instanceof Array&&r.length>0;(n||a&&this.props.gridSortingInfo!==this._previousSortingInfo)&&(this._previousSortingInfo=this.props.gridSortingInfo,t.SortingInput={Static:!0,Value:this.props.gridSortingInfo})}this.props.gridEntityTypeName&&(t.EntityName=this.props.gridEntityTypeName)}this._addExtraParametersToConfiguration();const e=this.props.updatedConfiguration.Parameters[this.props.nestedGridDatasetName];if(e&&(e.onRecordsSelected=this._onRecordsSelectedCallback.bind(this,!0),this.props.refreshCounter)){const t=this.props.refreshCounter.toString();e.RefreshInput={Value:parseInt(t,10),Static:!0}}}_addExtraParametersToConfiguration(){if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&(this.props.updatedConfiguration.Parameters.NativeFilterExpressionToRestore={Usage:1,Static:!0,Value:this.props.nativeFilterExpression},!Object(ne.a)(this._pageNumberToRestoreForEnhancedPaging))){let t=this._pageNumberToRestoreForEnhancedPaging;this._pageNumberToRestoreForEnhancedPaging>1&&(this._shouldResetPagingForEnhancedPaging||!this._resetProcessedForEnhancedPaging)&&(this._shouldResetPagingForEnhancedPaging=!1,this._resetProcessedForEnhancedPaging=!1,t=-1),this.props.updatedConfiguration.Parameters.PageNumberToRestore={Usage:1,Static:!0,Value:t}}this.props.lookupAttributeForRecordHierarchy&&this.props.gridInput&&(this.props.updatedConfiguration.Parameters.LookupAttributeNameForHierarchy={Usage:1,Static:!0,Value:this.props.lookupAttributeForRecordHierarchy})}_renderAccessibilityNotification(t){var e;const n=t+"_accessibility",a={left:"-3000%",width:"0%",height:"0%",position:"absolute"};this.props.featureControlProps.isAssociatedGridHeightEnabled&&(a.overflow="hidden");const i=Object(w.c)(this.props.resourceStrings,P.GRID_LOADING_PLACEHOLDER).replace("{0}",this.props.entityDisplayName),s=2===this.state.loadingState?null!==(e=this.props.notificationMessage)&&void 0!==e?e:"":i;return r.createElement(o.a,{key:`${n}_${this._accessibilityId}`,id:n,style:a,role:Et.s,notificationType:Bt.b},s)}_renderQuickFind(){const t=this._showNewQuickFindSearchBarForMobile();if(this.props.quickFindProps&&this._isWidthInitialized()){if(this._isWidthLessThanViewportSm()&&(this.state.quickFindVisibility||t)){const e=Object.assign(this.props.quickFindProps,{focusSearchBoxAfterRender:!0});return r.createElement(o.a,{key:"quickFind",style:this.props.styles.quickFindMobileStyle},r.createElement(Jt,Object.assign({},e,{updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,resetPagingInfoForEnhancedPaging:this._resetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),ref:this._dataSetQuickFindRef,showNewQuickFindSearchBarForMobile:t})))}if(!this._isWidthLessThanViewportSm())return Object(It.g)(this.props.contextString)?r.createElement(o.a,{style:this.props.styles.quickFindContainerStyle},this._getQuickFind()):this._getQuickFind()}return null}_renderAdvancedFilter(){return this._isWidthInitialized()&&this.props.showAdvancedFilter&&this.props.quickFindProps&&r.createElement(vt.a,{key:"openAdvancedFilter",id:"open-advanced-filter",iconType:"filter",title:Object(w.c)(this.props.resourceStrings,Fe.c.OpenAdvancedFiltersTitleAndAria),style:this.props.styles.advancedFilterButtonStyles,onClick:()=>{this._renderAdvancedFindPanel()},tabIndex:0,accessibilityLabel:Object(w.c)(this.props.resourceStrings,Fe.c.OpenAdvancedFiltersTitleAndAria)},r.createElement(Q.b,{id:"filter",accessibilityHidden:!0,type:d.a.Filter}))}_renderAdvancedFindPanel(){var t;this._updateDataSetLoadingState(1);const e=[{name:"entityName",value:this.props.entityTypeName},{name:"ViewId",value:null===(t=this.props.viewId)||void 0===t?void 0:t.guid}];this.props.retrieveRelatedEntitiesMetadata(this.props.entityTypeName).then(()=>{this.setState({isFilterPanelOpen:!0}),this._updateDataSetLoadingState(2),this.context.EventManager.ReportComponentSuccess(Ge,e)},t=>{this._tracer.error(null==t?void 0:t.message),this._updateDataSetLoadingState(2),this.context.EventManager.ReportComponentFailure(Ge,new Error(t),e)})}_renderDiscardChanges(){if(this.props.showAdvancedFilter&&this.props.isViewEdited&&this._isWidthInitialized()&&!this.props.showColumnEditor)return r.createElement(vt.a,{key:"clearAdvancedFilter",id:"clear-advanced-filter",iconType:"clearFilter",title:Object(w.c)(this.props.resourceStrings,P.AdvancedFind_DiscardButton_Title),style:this.props.styles.advancedFilterButtonStyles,onClick:()=>{var t;this.props.removeEditedViewPageMap(this.props.gridInput.pageToEditedViewMapId.guid,this.props.viewId),this._clearCustomFilterAndUpdateControlKeyIndex();const e=[{name:"entityName",value:this.props.entityTypeName},{name:"ViewId",value:null===(t=this.props.viewId)||void 0===t?void 0:t.guid}];this.context.EventManager.ReportComponentSuccess(Xe,e)},tabIndex:0,accessibilityLabel:Object(w.c)(this.props.resourceStrings,P.AdvancedFilter_DiscardButton_AccessibilityLabel)},r.createElement(Q.b,{id:"clearFilter",type:d.a.GlobalFilterClearAll}))}_renderColumnEditor(){if(this.props.showColumnEditor&&this._isWidthInitialized()){const t=Object(w.c)(this.props.resourceStrings,P.ColumnEditorButton);return r.createElement(Ve.a,{key:"columnEditorBtn",id:"columnEditor-btn",iconProps:{iconName:"ColumnOptions",style:{color:"black"}},title:t,"aria-label":t,onClick:()=>this.setState({columnEditorPanelOpen:!0}),style:this.props.styles.columnEditorButtonStyle})}}_clearCustomFilterAndUpdateControlKeyIndex(){this.props.setCustomFilter("",0,this.props.id,this.props.contextToken).then(()=>{this._keyIndex++,this._onViewChanged(this.props.viewId.guid,this.props.entityTypeName,!1)})}_getQuickFind(){return r.createElement(o.a,{key:"quickFind",style:this.props.styles.quickFindStyle},r.createElement(Jt,Object.assign({},this.props.quickFindProps,{updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,resetPagingInfoForEnhancedPaging:this._resetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),ref:this._dataSetQuickFindRef})))}_renderViewSelector(){if(this.props.viewSelectorProps&&this._isWidthInitialized()){const t=this._isWidthLessThanViewportSm()?this.props.styles.viewSelectorOuterMobileStyle:this.props.styles.viewSelectorOuterStyle;return r.createElement(o.a,{key:"viewSelector",style:t},r.createElement(W,Object.assign({isGridRoot:Object(It.e)(this.props.contextString)},this.props.viewSelectorProps,{isTablet:this._isWidthLessThanViewportM(),isPhone:this._isWidthLessThanViewportSm(),key:"dataSetHostView",onChange:this._onViewChanged,onItemIconPointerDown:this._onItemIconPointerDown,rootZIndex:this._isInSeeMoreState(),isRTL:this.props.isRTL,removeEditedViewPageMap:this.props.removeEditedViewPageMap})))}return this._renderTitle()}_renderQueueFilter(){if((this.props.entityTypeName===Pe.Bb||this.props.entityTypeName===je.a)&&this.props.queueFilterProps&&this._isWidthInitialized()){const t=this._isWidthLessThanViewportSm()?this.props.styles.filterContainerMobileStyle:this.props.styles.filterContainerStyle;return r.createElement(ot,Object.assign({},this.props.queueFilterProps,{key:"queueFilter",onFilterChange:this._onFilterChange,updateFilterValue:this._updateFilterValue,resourceStrings:this.props.resourceStrings,style:t,isGridPaginationStateFeatureEnabled:this.props.featureControlProps.isGridPaginationStateFeatureEnabled}))}return null}_renderEntityFilter(){if(this.props.entityFilterProps&&this._isWidthInitialized()){const t=this._isWidthLessThanViewportSm(),e=t?this.props.styles.filterContainerMobileStyle:this.props.styles.filterContainerStyle,n=this.props.styles.activityTypeFilterContainerStyle;return r.createElement(gt,Object.assign({},this.props.entityFilterProps,{onToggleChange:this._onRollupViewToggleChanged,key:"EntityFilterDataSet",onFilterChange:this._onFilterChange,onActivityTypeChange:this._onActivityTypeMenuDismissed,onActivityTypeFilterClear:this._clearActivityTypeFilter,gridEntityName:this.props.gridEntityTypeName,resourceStrings:this.props.resourceStrings,containerStyle:e,activityTypeContainerStyle:n,rootZIndex:this._isInSeeMoreState(),isGridPaginationStateFeatureEnabled:this.props.featureControlProps.isGridPaginationStateFeatureEnabled,isMobile:t}))}return null}_renderDataSetChart(){return this.props.chartProps&&this._isWidthInitialized()?(this.props.chartProps.isLayoutVertical=this._isReflowLayoutVertical,r.createElement(v,Object.assign({},this.props.chartProps,{style:this._isReflowLayoutVertical?this._isWidthLessThanViewportSm()?this.props.styles.reflowChartMobileStyle:this.props.styles.reflowChartStyle:this.props.styles.chartStyle,key:"pageChartDataSet",closeChartPaneHandler:this.props.toggleChartPane}))):null}_renderBackButtonForGridInMobile(){return this.props.commandBarProps&&this._isWidthInitialized()&&Object(It.e)(this.props.contextString)&&this._isWidthLessThanViewportSm()&&this.props.backButtonEnabled?r.createElement(Z.a,{pageId:this.props.id,overwriteStyle:{borderWidth:0,height:"auto",padding:0,margin:"-8px 0"}}):null}_renderCommandBar(){if(!this.props.commandBarProps||!this._isWidthInitialized())return null;this._commandBarLoadedPromise||(this._commandBarLoadedPromise=new Promise(t=>{this._commandBarLoadedResolve=t})),this._commandManagerId=this._commandManagerId||this.props.commandBarProps.commandManagerId||Object(mt.a)();let t=this.props.styles.commandManagerContainerStyle,e=this.props.styles.commandBarStyle;this._isWidthLessThanViewportSm()&&(t=this.props.styles.commandManagerContainerMobileStyle,e=this.props.styles.commandBarMobileInnerStyle);const n=Object(It.e)(this.props.contextString);return Object(K.b)(this.props.commandBarRefreshProps,e,this._isWidthLessThanViewportSm(),t),r.createElement(rt,Object.assign({},this.props.commandBarProps,{key:"commandBarDataSet",addedCommandList:this.state.addedCommandList,appendedCommandList:this.state.appendedCommandList,metaDataLoadedResolve:this._commandBarLoadedResolve,commandManagerId:this._commandManagerId,style:t,commandbarStyles:e,rootZIndex:this._isInSeeMoreState(),customControlType:this.props.updatedConfiguration.CustomControlId,isGridRoot:n,collapsed:this._isWidthLessThanViewportSm(),isNativeMode:this._isNativeSubgrid()}))}_renderFooter(){let t=!1;if(this.props.totalResultCount<=this.props.pageSize&&!this.props.totalRecordCountLimitExceeded&&Object(It.g)(this.props.contextString)&&!this._isInSeeMoreState()&&!this.props.jumpBarProps&&(t=this._shouldRenderSeeMoreButton(),!t))return this._logInfo("Hiding the footer for the subgrid because there is less than 2 pages of data"),null;if(this._isWidthInitialized()&&(this.props.jumpBarProps||this.props.pagingProps)){const e=this._isJumpBarRenderingAsFlyout()?this.props.styles.footerMobileStyle:this.props.isGridEditable?this.props.styles.footerEditableGridStyle:Object.assign(Object.assign({},this.props.styles.footerOuterStyle),this.props.jumpBarProps?this.props.styles.defaultFooterHeightStyle:this.props.styles.jumpBarLessFooterHeightStyle);if(!this.props.isGridEditable)return this._hideJumpbarForMobile()?null:r.createElement(o.a,{key:"dataSetFooter_"+this.props.id,style:e},!t&&this._renderJumpBar(),r.createElement(o.a,{key:"dataSetPagingContainer_"+this.props.id,style:this.props.styles.footerPagingContainer},this._renderPaging(t),this._renderSeeMoreButton()));if(this.props.jumpBarProps)return r.createElement(o.a,{key:"dataSetFooter_"+this.props.id,style:e},this._renderJumpBar());this._logInfo("Hiding the footer for the editable grid because the jump bar props is null")}return this._logInfo("Hiding the footer for the grid because the width for the controld is 0 or the jump bar props is null or paging props is null"),null}_jumpBarShouldRenderAsFlyout(t){const e=Object(w.c)(this.props.resourceStrings,P.JUMPBAR_ALPHABET);if(e){const n=e.split(","),r=t-100,a=this._isJumpBarRenderingAsFlyout()?.5:-.5;return!!n&&r/n.length<=32+a}return!1}_renderJumpBar(){let t=null;return this._isJumpBarRenderingAsFlyout()&&(t=this.props.styles.jumpBarButtonContainerStyle),this.props.jumpBarProps?r.createElement(o.a,{key:"jumpBar_"+this.props.id,style:t},r.createElement(kt,Object.assign({},this.props.jumpBarProps,{rootZIndex:this._isInSeeMoreState(),controlKey:this.props.controlKey,renderMobile:this._isJumpBarRenderingAsFlyout(),isDeviceSizeSmall:!this._isWidthGreaterThan480(),isRTL:this.props.isRTL,isGridRoot:Object(It.e)(this.props.contextString),updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,setResetPagingInfoForEnhancedPaging:this._setResetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),isMobile:this._isWidthLessThanViewportM()}))):null}_renderPaging(t){const e=Object(It.f)(this.props),n=!this.props.hasCustomDataProvider&&Object(ne.a)(this.props.totalRecordCountLimitExceeded);return e&&this._logInfo("Hiding the paging button for the grid because the sharepoint grid does not support paging"),this.props.pagingProps?r.createElement(qt,Object.assign({},this.props.pagingProps,{pagingInfo:this.state.pagingInfo,shouldPagingTextRender:!t,incrementLastPage:this._incrementLastPage,setFirstPage:this._setFirstPage,enhancedPagingDisabled:!t&&!e&&!this._isNativePlatform,pagingTextDisabled:n,gridTotalRecordsCountLimit:this.props.gridTotalRecordsCountLimit,isGridRoot:Object(It.e)(this.props.contextString),updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),isServerOffline:this.props.isOffline})):null}renderDataSetHostComponent(t,e,n,a,i){var s,l,u;let h=[];const m=this._isWidthLessThanViewportSm();this._isReflowLayoutVertical=!(!this._isWidthLessThanMinWidthForChartPlusGridReflow()||!this.props.chartProps);try{const b=this._getDataSetHostErrorMessage();if(Object(ne.a)(b)||this.state.compositeControlInitState===N.a.Initializing){if(this._isWidthInitialized()||Object(It.g)(this.props.contextString)&&this.state.compositeControlInitState!==N.a.Initializing){this._isShowChartChanged&&(this._getUpdateAddedCommandList(this._showCommandBarButtonSearch(),this._showCommandBarButtonShowChart()),this._onAddedCommandListChange(),this._isShowChartChanged=!1);const e=(Object(It.e)(this.props.contextString)||Object(It.d)(this.props.contextString))&&this.props.entityIsActivityType;m||Object(It.g)(this.props.contextString)?(this.props.viewSelectorProps||this.props.quickFindProps||this.props.entityFilterProps||this.props.queueFilterProps||this.props.commandBarProps)&&(this.props.featureControlProps.isInMobileModeForOct2019&&Object(It.e)(this.props.contextString)&&(i=Object.assign(Object.assign({},i),{display:"none"})),h.push(r.createElement(o.a,{key:"dataSetHeader_"+this.props.id,style:n},this._renderHeader([this._renderBackButtonForGridInMobile(),this._renderViewSelector(),this._renderCommandBar()],i),this._renderQuickFind(),e||this.props.entityFilterProps&&this.props.entityFilterProps.isRollupViewSupported&&this.props.contextString===f.h.ASSOCIATEDGRID?this._renderEntityFilter():this._renderQueueFilter()))):(h.push(this._renderCommandBar()),(this.props.viewSelectorProps||this.props.quickFindProps||this.props.entityFilterProps||this.props.queueFilterProps)&&h.push(r.createElement(o.a,{key:"dataSetHeader_"+this.props.id,style:n},this._renderHeader([this._renderViewSelector(),this._renderDiscardChanges(),this._renderColumnEditor(),this._renderAdvancedFilter(),this._renderQuickFind()],i),e||this.props.entityFilterProps&&this.props.entityFilterProps.isRollupViewSupported&&this.props.contextString===f.h.ASSOCIATEDGRID?this._renderEntityFilter():this._renderQueueFilter())));let c=this.props.chartProps&&this._isReflowLayoutVertical?this.props.styles.reflowdataSetContentBodyStyle:this.props.styles.dataSetContentBodyStyle;this.props.featureControlProps.isAssociatedGridHeightEnabled&&Object(It.d)(this.props.contextString)&&(c=Object.assign(Object.assign({},c),{flexBasis:"0px"}));if(this.props.chartProps&&!this._isReflowLayoutVertical&&this.props.featureControlProps.isSuiterChartEnabled||this._showNewQuickFindSearchBarForMobile()){const t="1px solid #d8d8d8";c=Object.assign(Object.assign({},c),{borderTop:t})}const d=(null===(u=null===(l=null===(s=this.props)||void 0===s?void 0:s.configuration)||void 0===l?void 0:l.Parameters)||void 0===u?void 0:u.EnableSubGridAutoCollapse)&&this.props.configuration.Parameters.EnableSubGridAutoCollapse,b=d&&d.Value,y=this.props.featureControlProps.isSubGridAutoCollapseEnabled&&Object(It.g)(this.props.contextString)&&"true"===b;y&&0===this.props.totalResultCount&&(c=Object.assign(Object.assign({},c),{display:"none"})),this.props.featureControlProps.isSubGridRemoveMinHeightEnabled&&y&&(c=Object.assign(Object.assign({},c),{minHeight:"0px"}));const v=m&&Object(It.e)(this.props.contextString),_=this._parentDefinedProps;this.props.parentDefinedControlProps&&(_.height=this.props.parentDefinedControlProps.height>0&&this._seeMoreHelper.getSeeMorePopupStatus()===g.b.NotInUse?this.props.parentDefinedControlProps.height:void 0,_.width=this.props.parentDefinedControlProps.width>0&&this._seeMoreHelper.getSeeMorePopupStatus()===g.b.NotInUse?this.props.parentDefinedControlProps.width:void 0,_.decorators=this.props.parentDefinedControlProps.decorators,_.propertyBagOverrides=this.props.parentDefinedControlProps.propertyBagOverrides),_.parentInSeeMoreMode=this._seeMoreHelper.getSeeMorePopupStatus()!==g.b.NotInUse,_.containerStyleOverrides=this._getCombinedContainerStyleOverrides();const S="data-set-body-container";let O=null;this.props.chartProps&&this._isWidthInitialized()&&(O={width:"70%"});const C=At.a.getInstance().get_IsBrowserIE()?Object.assign(a,{flex:"1 1 100%"}):a;h.push(r.createElement(o.a,{key:"dataSetContentBody_"+this.props.id,style:c},this._renderDataSetChart(),r.createElement(o.a,{key:"dataSetBody_"+this.props.id,style:!0===this._isReflowLayoutVertical?this.props.styles.reflowGridStyle:Object.assign(C,O),className:this._isInSeeMoreState()?"seeMore":void 0,testhooks:{id:S}},r.createElement(p.c,{key:this.props.controlKey+this._keyIndex,controlId:this.props.controlId,id:this.props.id,formInfo:this._savedFormInfo,configuration:this.props.updatedConfiguration,descriptor:this.props.descriptor?this.props.descriptor:this._savedDefault,systemDefinedProperties:this.props.systemDefinedProperties,rowSpan:this.props.rowSpan,parentDefinedControlProps:_,parentContextToken:this.props.contextToken,contextString:this.props.contextString,externalCommandManagerId:this._commandManagerId,externalCommandPromise:this._commandBarLoadedPromise,shouldRender:this.props.nonCompositionProps?this.props.nonCompositionProps.shouldRender:void 0}),v?null:this._renderFooter()))),v&&h.push(this._renderFooter()),h.push(this._renderAccessibilityNotification(t)),h=h.concat(this._renderAccessibilityComponent(t))}}else if(2!==this.state.loadingState&&this._updateDataSetLoadingState(2),h.push(r.createElement(o.a,{key:"dataSetHeader_"+this.props.id,style:n},this._renderHeader([this._renderViewSelector()],i))),this._isWidthInitialized()){const t={fontSize:this._isHeightGreaterThan240()&&this._isWidthGreaterThan480()?"4.5em":"2em",color:"red"},e={display:"flex",justifyContent:"center"},n=Object(w.c)(this.props.resourceStrings,P.SEE_MORE_DETAILS);h.push(r.createElement(o.a,null,r.createElement(c.a,{id:"gridErrorContainer"+this.props.id,text:b,icon:d.a.DetailsPageClose,iconStyle:t}),this.state.controlLoadInnerErrorMessage&&!this._isDataSetHostKnownError(this.state.controlLoadErrorMessage)&&r.createElement(o.a,{style:e},r.createElement(yt.a,{key:"gridInnerErrorMessage",href:"#",accessibilityLabel:n,onClick:()=>{this.props.showInnerError(this.state.controlLoadInnerErrorMessage)}},n))))}const y=Object.assign(Object.assign({},e),this.state.controlLoadInnerErrorMessage&&{backgroundColor:"#FFFFFF"});return r.createElement(o.a,{style:y,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0,id:t,key:t,testhooks:{id:t,[Se.b]:this.props.previewId,[Se.c]:20},semanticTag:this.props.semanticTag},h)}catch(t){this._onControlLoadedError(t)}}_getDataSetHostErrorMessage(){var t;let e=null;if(this.props.hasReadRolePrivilege)if(this.props.isUCIEntity||this.props.hasCustomDataProvider)if(this.props.offlineProps.isOfflineSqlQueryAvailable)e=this.props.isOffline&&this.state.controlLoadErrorMessage&&!this.props.hasCustomDataProvider?this.props.offlineProps.isEntityAvailableForOffline?this.props.offlineProps.isOfflineAvailableForUse?this.state.controlLoadErrorMessage:Object(w.c)(this.props.resourceStrings,P.OFFLINE_NOT_READY_FOR_USE):Object(w.c)(this.props.resourceStrings,P.ENTITY_NOT_AVAILABLE_IN_PROFILE):this.state.controlLoadErrorMessage;else{let t="";this.props.offlineProps.offlineErrorMessageKey&&(t=Object(w.c)(this.props.resourceStrings,this.props.offlineProps.offlineErrorMessageKey)),t||(t=Object(w.c)(this.props.resourceStrings,P.VIEW_NOTAVAILABLE_IN_OFFLINE)),e=t}else{const t=this.props.entityDisplayName?this.props.entityDisplayName:this.props.entityTypeName,n=Object(w.c)(this.props.resourceStrings,P.UCI_DISABLED_ENTITY_ERROR);e=String.format(n,t)}else e=Object(w.c)(this.props.resourceStrings,P.READ_PRIVILEGE_VIOLATION_KEY);return Object(ne.a)(e)||null===(t=this._tracer)||void 0===t||t.error(`${Be}._getDataSetHostErrorMessage : ${e}`,this.props.isOffline&&this.props.offlineProps.offlineGridErrorTelemetryParams),e}_renderHeader(t=[],e){const n=(t||[]).filter(t=>!!t);return n.length?r.createElement(o.a,{key:"dataSetHeaderInner_"+this.props.id,style:e},n):null}_getParentDefinedPropsDecoratorValue(t){return this.props.parentDefinedControlProps&&this.props.parentDefinedControlProps.decorators&&this.props.parentDefinedControlProps.decorators[t]}_shouldRenderSeeMoreButton(){return this._getParentDefinedPropsDecoratorValue("ShowSeeMore")&&!!this.props.totalResultCount}_renderSeeMoreButton(){const t=Object(It.g)(this.props.contextString),e=Object(It.d)(this.props.contextString),n=this._seeMoreHelper.getSeeMorePopupStatus(),a=Object(It.f)(this.props);return!((t||e)&&!a)||n===g.b.PopFadeIn||n===g.b.PoppedOut||n===g.b.ReturnFadeOutAndMove||this.props.totalResultCount>=0&&this.props.totalResultCount<=this.props.pageSize&&!this._shouldRenderSeeMoreButton()||!this._isNativePlatform?(this._logInfo("Hiding the See more button for the grid because the grid does not support see more or there is less than 2 pages of data"),null):r.createElement(Zt,{onSeeMoreClick:this._seeMorePopup.bind(this,!0,!1),resourceStrings:this.props.resourceStrings,containerStyle:this.props.styles.seeMoreButtonContainerStyle,buttonStyle:this.props.styles.seeMoreButtonStyle,seeMoreTextStyle:this.props.styles.seeMoreButtonTextStyle,localizedStrings:this._getSeeMoreLocalizedStrings()})}_getSeeMoreLocalizedStrings(){let t=null;return this.props.viewSelectorProps&&this.props.viewSelectorProps.title?t=this.props.viewSelectorProps.title:this.props.descriptor.ShowLabel&&this.props.descriptor.Label?t=this.props.descriptor.Label:this.props.entityDisplayName&&(t=this.props.entityDisplayName),this._isNativeSubgrid()?{uniqueLabel:t,seeMoreLabel:Object(w.c)(this.props.resourceStrings,P.SEE_ALL_LABEL),seeMoreTooltip:Object(w.c)(this.props.resourceStrings,P.SEE_ALL_TOOL_TIP)}:{uniqueLabel:t}}_isStreamOnSuiterDashboard(){return this.props.featureControlProps.isSuiterDashboardEnabled&&Object(It.g)(this.props.contextString)&&this.props.configuration&&this.props.configuration.Parameters&&this.props.configuration.Parameters.UseDefaultCardFormForList&&this.props.configuration.Parameters.UseDefaultCardFormForList.Value}_renderProgressIndicator(){let t="datasethost-progress-indicator";this.props.descriptor&&(t+="-"+this.props.descriptor.Id);const e=Object.assign({},this.props.styles.dataSetChangingProgressIndicatorContainerStyle);let n=this.props.styles.progressIndicatorContainerStyle;return 1===this.state.loadingState?(e.width=this._width,e.height=Math.max(this._height,100)):0===this.state.loadingState&&this._isStreamOnSuiterDashboard()&&(n=Object.assign(Object.assign({},n),{borderBottom:"none"})),r.createElement(o.a,{key:"progressIndicatorContainer",id:"progressIndicatorContainer",style:0===this.state.loadingState?n:e},r.createElement(o.a,{key:"progressIndicator",id:"progressIndicator",style:0===this.state.loadingState?this.props.styles.progressIndicatorStyle:this.props.styles.dataSetChangingProgressIndicatorStyle},r.createElement(u.a,{key:t,id:t,testhooks:{id:t},style:this.props.styles.datasethostProgressIndicatorStyle,progressType:"ring",displayDelay:0===this.state.loadingState&&2e3,active:!0})))}componentWillUnmount(){this._seeMoreHelper&&this._seeMoreHelper.destroy(),clearTimeout(this._statusTimeout),this._statusTimeout=null}get _tracer(){return this.context?this.context.TraceManager.getTracer(f.z):null}_updateStatus(t){this.state.statusMessage===t||this._isSubGridFirstLoad||(clearTimeout(this._statusTimeout),this._statusTimeout=setTimeout(()=>this.setState({statusMessage:t}),1e3))}render(){var t,e,n,a,i;if(Object(ne.a)(this.props.updatedConfiguration))return this._logInfo("DataSetHost not rendered. Configuration is null"),null;if(!this.props.isInitialized&&this.props.contextToken&&this.props.primaryDataSetName&&this.state.compositeControlInitState!==N.a.Error){const t=this.props.updatedConfiguration.Parameters[this.props.primaryDataSetName];if(!t)return this._logInfo("DataSetHost not rendered. DataSet is not initialized and configuration does not contain primary dataset name."),null;if(this.state.compositeControlInitState===N.a.Uninitialized){this.setState({compositeControlInitState:N.a.Initializing});const e=this.props.viewId?this.props.viewId:t.ViewId?_.a.parse(t.ViewId):null,n=this.props.gridEntityTypeName||t.TargetEntityType||t.EntityName;if(!n&&!this.props.hasCustomDataProvider)return this._tracer&&this._tracer.error("DataSetHost not rendered. Reason: entityName unknown"),null;this.props&&this.props.hasCustomDataProvider&&this._logInfo("render: Initializing DataSetHost, id "+this.props.controlId+", for custom data provider"),this._logInfo(`Initializing grid for ${e} view and ${n} entity.`),this.props.initializeGrid(e,n,this.props.commandBarProps&&this.props.commandBarProps.commandManagerId,this.props.contextToken).then(()=>{this._logInfo(`Initialized grid for ${e} view and ${n} entity.`),this.setState({compositeControlInitState:N.a.Initialized})},t=>{const e=t instanceof Error?t.message:t;-1!==te.c.indexOf(e)?this._setControlLoadError(e):this._tracer&&this._tracer.error("Grid initialization failed. Reason: "+e),this.setState({compositeControlInitState:N.a.Error})})}return this._logInfo("DataSetHost not rendered. Either state is not initialized or resource strings are not initialized"),null}if(this.props&&this.props.nonCompositionProps&&this.props.nonCompositionProps.addedCommandListFromHostParent&&this._addedCommandListFromHostParent!==this.props.nonCompositionProps.addedCommandListFromHostParent&&(this._addedCommandListFromHostParent=this.props.nonCompositionProps.addedCommandListFromHostParent,this._onAddedCommandListChange()),this.props.descriptor&&this.props.descriptor.Parameters){const t=this.props.descriptor.Parameters[f.c];if(this._isWidthLessThanViewportSm()&&t&&"false"===t)return this._logInfo("DataSetHost not rendered. Available on phone is set to false"),null}this._configureDataSetControlParams(),this._updateViewSelectorProps(this.props),!this.props.viewId||!(null===(t=this.props.nonCompositionProps)||void 0===t?void 0:t.setPageInputViewId)||this.props.viewId.guid===(null===(n=null===(e=this.props.gridInput)||void 0===e?void 0:e.viewId)||void 0===n?void 0:n.guid)&&(null===(a=this.props.gridInput)||void 0===a?void 0:a.viewType)||this.props.savedQueryType===C.a.QUICKFIND_SEARCH||this.props.nonCompositionProps.setPageInputViewId(this.props.viewId.guid),this._savedDefault&&this.props.controlId===this._savedDefault.Id||(this._savedDefault={Id:this.props.controlId,HasContext:!0,Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1}),this.props.formInfo&&(this._savedFormInfo=this.props.formInfo,null!=this.props.ribbonId&&(this._savedFormInfo.RibbonId=this.props.ribbonId));const s=this.props.descriptor&&this.props.descriptor.DomId&&this.props.descriptor.Id?this.props.descriptor.DomId.includes(this.props.descriptor.Id)?this.props.descriptor.DomId:this.props.descriptor.Id:this.props.id,c="dataSetRoot_"+s,{containerStyle:u,headerStyle:d}=this.props.styles;let{rootStyle:p,headerInnerStyle:h,bodyStyle:m}=this.props.styles;this._updateChangeVisualizationButtons(this.props.updatedConfiguration.FormFactor.toString());let b=u,y={shadowStyle:null,innerStyle:null,outerStyle:null};this._isWidthLessThanViewportSm()&&(m=this.props.styles.bodyMobileStyle,h=this.props.styles.headerInnerMobileStyle);const v=this._seeMoreHelper.getSeeMorePopupStatus(),S=this._seeMoreHelper.getSeeMorePopupInfo();v!==g.b.NotInUse&&(y=g.a.getCustomControlFancyPopoutStyles(this.props.renderer,v,S),v!==g.b.ReturnFadeIn&&(b={height:S.startHeight,width:S.startWidth},p=Object.assign(Object.assign({},p),{height:S.endHeightInner-48})));const O=this.renderDataSetHostComponent(c,p,d,m,h),I=(this._getDataSetHostRootElement(),this._seeMorePopup.bind(this,!1)),P=this.props.isRTL,j=function(t,e,n,a,i,s,c,l=!1){const u=i||s,d="DataSetHostContainer";return r.createElement(o.a,{key:d,id:`${d}_${c}`,style:u,testhooks:{id:d}},t.renderCloseButton(a,!0,!1,l),t.renderSpacer(!0,!1),e)}(this._seeMoreHelper,O,0,I,y.innerStyle,p,c,P);let T=Object.assign({},y.outerStyle?y.outerStyle:p);0===this.state.loadingState?(T.visibility="hidden",T.maxHeight="0"):1===this.state.loadingState&&(T=Object.assign(Object.assign({},T),{opacity:"0.6",pointerEvents:"none",minHeight:this._height}));const E=function(t,e,n,a){const i=e||{width:"100%"},s=a?Et.e:null;return r.createElement(o.a,{key:"DataSetHostOuterContainer",id:n+"_outer",style:i,role:s},t)}(j,T,c,(null===(i=this._seeMoreHelper)||void 0===i?void 0:i.getSeeMorePopupStatus())!==g.b.NotInUse),F=function(t,e){return e=e||{display:"none"},r.createElement(o.a,{key:"shadow",id:t?t+"shadow":null,style:e})}(c,y.shadowStyle),w=`datassethost_root_view_${s}_${c}`,x=At.a.getInstance().get_IsBrowserIE()&&Object(It.g)(this.props.contextString)?{overflow:"visible"}:{},{mobileSubGridContainerStyles:A}=this.props.styles;let k=Object.assign(b,x);return this._isNativePlatform&&Object(It.g)(this.props.contextString)&&this.props.featureControlProps.isInMobileModeForApril2020&&this.props.featureControlProps.isSubgridImprovementsEnabled&&(k=Object.assign(Object.assign({},k),A)),r.createElement(o.a,{key:w,style:k},r.createElement(l.a,{role:Et.s,notificationType:Bt.b,style:{left:"-3000%",width:"0%",height:"0%",position:"absolute"}},this.state.statusMessage),F,E,this.props.showAdvancedFilter&&this.state.isFilterPanelOpen&&r.createElement(Ee,{controlId:this.props.controlId,controlKey:this.props.controlKey,id:this.props.id,contextToken:this.props.contextToken,entityTypeName:this.props.entityTypeName,fetchXML:this.props.fetchXML,filterPanelOpen:this.state.isFilterPanelOpen,viewId:this.props.viewId,gridInput:this.props.gridInput,updateFetchXml:this.props.updateFetchXml,updatePageInput:this.props.updatePageInput,closeFilterPanel:this.closeFilterPanel,onViewChanged:this._onViewChanged,setAdvancedPanelApplyClick:()=>{this._clearCustomFilterAndUpdateControlKeyIndex(),this.setState({isAdvancedFilterEdited:!0})},originalView:this.props.originalView,resourceStrings:this.props.resourceStrings,telemetryMonitorAdvancedFindDiscard:Xe,resetAdvancedFilter:()=>this.setState({isAdvancedFilterEdited:!1})}),this.props.showColumnEditor&&r.createElement(Re,{entityTypeName:this.props.entityTypeName,onViewChanged:this._onViewChanged,columnEditorPanelOpen:this.state.columnEditorPanelOpen,columnEditorPanelDismiss:()=>this.setState({columnEditorPanelOpen:!1}),viewId:this.props.viewId,pageId:this.props.id,gridInput:this.props.gridInput,updatePageInput:this.props.updatePageInput,fetchXML:this.props.fetchXML,isAdvancedFindFilterEdited:this.state.isAdvancedFilterEdited}),2!==this.state.loadingState?this._renderProgressIndicator():null)}componentDidMount(){this._getUpdateAddedCommandList(this._showCommandBarButtonSearch(),this._showCommandBarButtonShowChart())}closeFilterPanel(){this.setState({isFilterPanelOpen:!1})}componentWillReceiveProps(t){(Object(It.e)(this.props.contextString)||Object(It.g)(this.props.contextString)||Object(It.d)(this.props.contextString))&&!this.props.isOffline&&t.isOffline&&0===this._offlineSqlQueryRetrieveState&&this.props.offlineProps.isEmptyOfflineSqlQuery&&(this._offlineSqlQueryRetrieveState=1,this.props.retrieveView(this.props.entityTypeName,this.props.savedQueryType,this.props.viewType,this.props.viewId,!1).then(()=>{this._offlineSqlQueryRetrieveState=2;const t=[{name:"scenario",value:"Called retrieveView"},{name:"entityTypeName",value:this.props.entityTypeName},{name:"viewId",value:_.a.toString(this.props.viewId)}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentSuccess&&this.context.EventManager.ReportComponentSuccess(Be+".componentWillReceiveProps",t)}).catch(t=>{this._offlineSqlQueryRetrieveState=2;const e=[{name:"scenario",value:"Called retrieveView"},{name:"error",value:t&&t.message},{name:"entityTypeName",value:this.props.entityTypeName},{name:"viewId",value:_.a.toString(this.props.viewId)},{name:"viewType",value:this.props.viewType},{name:"savedQueryType",value:this.props.savedQueryType}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentFailure&&this.context.EventManager.ReportComponentFailure(Be+".componentWillReceiveProps",t,null,e)})),this._isShowChartChanged=this.props.showChart!==t.showChart}shouldComponentUpdate(t){return this.props.entityTypeName===j.a&&this.props.gridEntityTypeName!==t.gridEntityTypeName&&this._currentFilterValue?(this._updateFilterOnViewSelectorChange(t.gridEntityTypeName),!1):1!==this._offlineSqlQueryRetrieveState&&(0!==t.refreshCounter&&this.props.refreshCounter!==t.refreshCounter&&2===this.state.loadingState&&this._updateDataSetLoadingState(1),!0)}componentDidUpdate(){this._seeMoreHelper.getSeeMorePopupStatus()!==g.b.NotInUse&&this._seeMoreHelper.checkOnPopupStatus(!0,!1,this._getDataSetHostRootElement());const t=Object(w.c)(this.props.resourceStrings,P.GRID_LOADING_PLACEHOLDER).replace("{0}",this.props.entityDisplayName),e=2===this.state.loadingState?this.props.notificationMessage:t;Object(It.g)(this.props.contextString)&&(0===this.state.loadingState?this._isSubGridFirstLoad=!0:1===this.state.loadingState&&(this._isSubGridFirstLoad=!1)),this._updateStatus(e)}_renderAccessibilityComponent(t){const e=t+"Accessibility";if(Object(It.e)(this.props.contextString)){const n=[];if(this.props.viewSelectorProps){const a=this.props.viewSelectorProps.id;n.push(r.createElement(Tt.a,{key:e,rootElementId:t,isModal:!1,shouldManageFocus:!0,defaultFocusId:a}))}else n.push(r.createElement(Tt.a,{key:e,rootElementId:t,isModal:!1,shouldManageFocus:!0}));return n}return null}_isInSeeMoreState(){const t=this._seeMoreHelper.getSeeMorePopupStatus();return t!==g.b.NotInUse&&t!==g.b.ReturnFadeOutAndMove&&t!==g.b.ReturnFadeIn}_isNativeSubgrid(){return Object(It.g)(this.props.contextString)&&this.props.clientHostSubtype===Me.a.Phone&&this.props.featureControlProps.isInMobileModeForOct2019&&this.props.featureControlProps.isInMobileModeForApril2020&&this.props.featureControlProps.isSubgridImprovementsEnabled}_getCombinedContainerStyleOverrides(){const{containerStyleOverrides:t}=this._parentDefinedProps,e=this.props.parentDefinedControlProps&&this.props.parentDefinedControlProps.containerStyleOverrides;return Object.assign(t,e,{rootContainer:Object.assign(t.rootContainer,{flex:Object(It.e)(this.props.contextString)||this._isInSeeMoreState()?"1 1 100%":"1 1 auto"},e&&e.rootContainer),primaryInnerContainer:this._isInSeeMoreState()?{flex:"1 1 100%",minHeight:"0"}:{}})}_updateViewSelectorProps(t){if(t.descriptor&&t.viewSelectorProps&&t.descriptor.Parameters){const e=t.descriptor.Parameters[f.B],n=e?e.toString().split(","):null,r=n?n.map(t=>_.a.tryParse(t)):null;t.viewSelectorProps.viewIds=r||null}}_getCachedSize(){return this._cachedSize||(this._cachedSize=this.props.cachedSize),this._cachedSize}_isWidthInitialized(){return this.state.isWidthInitialized||this._getCachedSize()&&this._getCachedSize().isWidthInitialized||!1}_isWidthLessThanViewportSm(){return this.state.isWidthLessThanViewportSm||this._getCachedSize()&&this._getCachedSize().isWidthLessThanViewportSm||!1}_isWidthLessThanViewportM(){return this.state.isWidthLessThanViewportM||this._getCachedSize()&&this._getCachedSize().isWidthLessThanViewportM||!1}_isWidthLessThanMinWidthForChartPlusGridReflow(){return this.state.isWidthLessThanMinWidthForChartPlusGridReflow||this._getCachedSize()&&this._getCachedSize().isWidthLessThanMinWidthForChartPlusGridReflow||!1}_isWidthGreaterThan480(){return this.state.isWidthGreaterThan480||this._getCachedSize()&&this._getCachedSize().isWidthGreaterThan480||!1}_isHeightGreaterThan240(){return this.state.isHeightGreaterThan240||this._getCachedSize()&&this._getCachedSize().isHeightGreaterThan240||!1}_showCommandBarButtonSearch(){return this.state.showCommandBarButtonSearch||this._getCachedSize()&&this._getCachedSize().showCommandBarButtonSearch||!1}_showCommandBarButtonShowChart(){return this.state.showCommandBarButtonShowChart||this._getCachedSize()&&this._getCachedSize().showCommandBarButtonShowChart||!1}_isJumpBarRenderingAsFlyout(){return this.state.isJumpBarRenderingAsFlyout||this._getCachedSize()&&this._getCachedSize().isJumpBarRenderingAsFlyout||!1}_hideJumpbarForMobile(){return this.props.featureControlProps.isJumpbarFeatureForMobileEnabled&&this._isWidthLessThanViewportSm()&&(Object(It.e)(this.props.contextString)||Object(It.d)(this.props.contextString))&&this.props.featureControlProps.isInMobileModeForApril2020}_showNewQuickFindSearchBarForMobile(){var t,e;return this._checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot()&&this._isWidthLessThanViewportSm()&&((null===(t=this.props.configuration)||void 0===t?void 0:t.CustomControlId)===f.p||(null===(e=this.props.configuration)||void 0===e?void 0:e.Name)===f.m)}_checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot(){return this.props.featureControlProps.isQuickFindImprovementsEnabled&&this.props.featureControlProps.isInMobileModeForApril2020&&Object(It.e)(this.props.contextString)}}function qe(t,e){return r.createElement(Ue,Object.assign({},t,{renderer:e.renderer}))}Ue.displayName="DataSetHost",Ue.contextType=Oe.a,qe.contextTypes={renderer:i.object};const ze=Object(s.a)(It.i,(function(t,e){return{initializeGrid:(n,r,a,i)=>{const s=ee.a.fromXmlAndSql("","",n).getQueryState(),o=e.descriptor&&e.descriptor.Parameters?e.descriptor.Parameters[f.r]:null,c=e.descriptor&&e.descriptor.Parameters&&e.descriptor.Parameters[f.s]?parseInt(e.descriptor.Parameters[f.s],10):null;a||(a=Object(it.c)(e.id,i));const l=t(Object(oe.d)(s,r,e.id,i,e.descriptor,o,c,void 0,a)),u=t(Object(fe.b)(r,n,e.id)),d=t(Object(F.e)(P.labelList));return Promise.all([l,d,u])},removeEditedViewPageMap:(e,n)=>t(Object(we.c)(e,n.guid)),updatePageInput:(e,n)=>t(Object(xe.b)(e,n)),updateView:(n,r,a,i,s,o,c,l,u)=>{const d=t(Object(ce.a)(n,o,r,a,i)).then(()=>t(Object(pe.a)(n,s))),p=_.a.tryParseOrNull(a),h=t(Object(fe.b)(i,p,n));let g=Promise.resolve(null);if(u){const e=Object($t.a)(i,c,o,l,!0);g=t(e.getFilterOptionsAction())}return Promise.all([d,h,g]).then(()=>{if(Object(It.e)(e.contextString)){const t=[{filterType:0,filterExpressionOrValue:null}];e.updateGridPaginationStateHandler(t,e.id)}t(Object(St.m)("",n,o)),t(Object(St.n)("",n,o)),t(Object(St.j)("",n,o)),t(Object(ae.b)("",0,n,o))})},retrieveView:(e,n,r,a,i)=>t(Object(E.a)(e,n,r,a,!1)),markSelectedRows:(e,n,r)=>t(Object(Rt.b)(e,n,r)),markSelectedRelatedEntity:(e,n,r)=>t(Object(Lt.b)(e,n,r)),rowProperties:(e,n,r)=>t(Object(le.b)(e,n,r)),updateFetchXml:(e,n,r)=>t(Object(ue.b)(e,n,r)),applyGridFilter:(n,r,a)=>{if(Object(It.e)(e.contextString)){const t=[{filterType:8,filterExpressionOrValue:n},{filterType:11,filterExpressionOrValue:r}];e.updateGridPaginationStateHandler(t,e.id)}t(Object(St.k)(r,e.id,a)),t(Object(St.l)(n,e.id,a))},applyActivityTypeFilter:(n,r,a)=>{if(Object(It.e)(e.contextString)){const t=[{filterType:9,filterExpressionOrValue:n},{filterType:10,filterExpressionOrValue:r}];e.updateGridPaginationStateHandler(t,e.id)}t(Object(St.h)(r,e.id,a)),t(Object(St.i)(n,e.id,a))},onSelectedOrderColumnChange:(n,r)=>{t(Object(St.o)(n,e.id,r))},toggleGridRollupView:(n,r)=>{t(Object(de.b)(n,e.id,r))},updatePagingData:(e,n,r)=>t(Object(ie.b)(e,n,r)),updateQueryKey:(e,n,r)=>{t(Object(se.b)(e,n,r))},setCustomFilter:(e,n,r,a)=>t(Object(ae.b)(e,n,r,a)),runOnRecordSelect:(n,r,a)=>{t(function(t,e,n,r,a){return{type:"dataset.run.on.record.select",sync:!0,execute({dispatch:a,getState:i},s){const o=s.TraceManager.getTracer(f.z),c=f.x+".RunOnRecordAction";try{if(s&&s.ScriptManager){const l=s.ScriptManager.getContainer(t);if(l&&r&&1===r.length){const t=Object(re.c)(i()),u=Object(re.b)(i());t&&(a(l.getEventManager().addGridOnRecordSelectHandlers(e)),a(l.getEventManager().addGridOnChangeHandlers(e))),(t||u)&&a(l.getEventManager().runOnRecordSelect(e,n)),o.info("Triggered the action for {0} selected records"+r.length),s.EventManager.ReportComponentSuccess(c)}}}catch(t){const e="Triggered action for selected records failed with error : "+t.message;s.EventManager.ReportComponentFailure(c,Error(e))}}}}(n,r,r.controlName?r.controlName:"entity_control",a,Object(It.e)(e.contextString)||Object(It.g)(e.contextString)))},retrieveRelatedEntitiesMetadata:e=>t(Object(Ae.a)(e)),switchHomepageConfiguration:(e,n,r,a,i)=>{t(Object(he.g)(e,n,r,a,i))},switchViewConfiguration:(e,n,r,a,i)=>{t(Object(he.i)(e,n,r,a,i))},switchSubgridVisualization:(e,n,r)=>{t(Object(he.h)(e,n,r))},switchAssociatedGridVisualization:(e,n,r,a,i,s,o,c)=>{t(c?Object(he.f)(e,n,r,a,i,s,o):Object(he.e)(e,n,r,i,o))},toggleChartPane:(e,n,r)=>{t(Object(ye.b)(e,n,r))},clearQuery:()=>{t(Object(Te.a)())},updateUserDefaultGridView:(e,n,r,a,i,s)=>t(function(t,e,n,r,a,i){return{type:"grid.update.userdefaultview",execute(s,o){const c=o.TraceManager.getTracer(f.z),l=f.x+".updateUserDefaultGridViewAction";try{c.info("Updating the user default view for the grid.");const u=s.getState(),d="usersettings",p=new me.a(d,Object(Wt.q)(u)),h=Object(A.h)(u,t);if(!p||!h.ObjectTypeCode)return Promise.resolve();const g="<DefaultGridViews><DefaultGridView><EntityTypeCode>{0}</EntityTypeCode><ChildEntityName>{1}</ChildEntityName><QueueId>{2}</QueueId><ViewId>{3}</ViewId><ViewType>{4}</ViewType></DefaultGridView></DefaultGridViews>";i&&(e="",n="",a=[],r="");const m=[];for(const t of a){const e=_.a.tryParse(t),n=_.a.externalGuid(e);m.push(n)}const b=String.format(g,h.ObjectTypeCode,r||"",1===m.length?m.toString():"",_.a.externalGuid(_.a.tryParse(e)),n);s.dispatch(Object(ge.f)(p,{personalizationsettings:b}));const f={ViewId:e,ViewType:+n,QueueId:a.toString()};return s.dispatch(Object(be.f)(f,t)),o.EventManager.ReportComponentSuccess(l),Promise.resolve()}catch(t){const e="Failed to update user default grid view with error : "+t.message;o.EventManager.ReportComponentFailure(l,Error(e))}}}}(e,n,r,a,i,s)),updateCurrentPageNumber:(e,n,r)=>t(Object(xt.b)(e,n,r)),setNewPageRequested:(e,n,r)=>{t(Object(Mt.b)(e,n,r))},retrieveControlResourceStringsForSwitchVisualization:e=>{const n=e.filter(t=>null!=t);return t(Object(F.e)(n))},updatePageNumberForEnhancedPaging:t=>{if(Object(It.e)(e.contextString)){const n=[{filterType:12,filterExpressionOrValue:t}];e.updateGridPaginationStateHandler(n,e.id)}},openManageDuplicatesDialog:e=>{t(Object(Ce.a)(null,null,me.a.fromExternalEntityReference(e.entityReference))).then(n=>{if(0===n.status)return t(Object(Ie.a)(n.pageId)).then(t=>{"ignore_save"===t.value.param_lastButtonClicked&&e.reject()})})},showInnerError:n=>{const r=new ke.a(n,null,null,null,null,{stack:`${n} ${(new Error).stack}`,message:n});t(Object(Ne.a)(e.id,r))}}}))(qe)},"8O0c":function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var r=n("Lyxw"),a=n("53SR"),i=n("Nb1E"),s=n("7tM0"),o=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c="ProcessControl_ActionExecuter_ExecutionTimeTooltip",l="ProcessControl_ActionExecuter_ErrorMessageTooltip",u="cc_MscrmControls.Containers.ProcessBreadCrumb/strings/ProcessControlResources";var d;function p(t){switch(t){case d.InProgress:case d.Waiting:return 1;case d.Succeeded:return 2;case d.Failed:case d.Canceled:return 3;default:return 0}}function h(t,e,n,r){let a="";if(Object(o.b)(t)||(a=String.format(r[c],new Date(t).toLocaleString())),n===d.Failed){const t=Object(o.b)(e)?r.Crm_GenericErrorMessage:e;a+="\n"+String.format(r[l],t)}return""===a?e:a}function g(t,e){return{type:"businessProcessFlow.actionLogs.retrieve",execute({dispatch:n,getState:o},d){const g=String.format("?$select=workflowlogid,message,status,modifiedon,stepname,activityname,_asyncoperationid_value&$filter=activityname%20eq%20'{0}'%20and%20_asyncoperationid_value%20eq%20{1}&$orderby=modifiedon%20desc&$top=500",t.guid,e.id.guid),m=o();if(function(t){return Object(r.b)(t,"BpfActionSupportActionQuerying")}(m))return n(Object(i.e)("workflowlog",g)).then(t=>{if(t.value&&t.value.length){const r={};r[c]=Object(s.a)(m,u,c),r[l]=Object(s.a)(m,u,l),r.Crm_GenericErrorMessage=Object(s.a)(m,u,"Crm_GenericErrorMessage");const i={};t.value.forEach(t=>{if(t.stepname&&-1===Object.keys(i).indexOf(t.stepname)){const e={actionLogId:t.workflowlogid,status:p(t.status),modifiedOn:t.modifiedon,stepId:t.stepname,processDefinitionid:t.activityname,processInstanceid:t._asyncoperationid_value,message:h(t.modifiedon,t.message,t.status,r)};i[t.stepname]=e}});const o={actionLogCollection:i};return n(Object(a.a)(o,e))}})}}}!function(t){t[t.InProgress=1]="InProgress",t[t.Succeeded=2]="Succeeded",t[t.Failed=3]="Failed",t[t.Canceled=4]="Canceled",t[t.Waiting=5]="Waiting"}(d||(d={}))},"91Ew":function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="attribute.option.add";function i(t,e,n,i,s){const o=Object(r.x)(e);return{type:a,payload:{option:i,index:s},meta:{pageId:t,contextKey:o,dataFieldName:n}}}},"95wm":function(t,e,n){"use strict";n.d(e,"f",(function(){return h})),n.d(e,"c",(function(){return m})),n.d(e,"d",(function(){return b})),n.d(e,"b",(function(){return g})),n.d(e,"e",(function(){return f})),n.d(e,"a",(function(){return y}));var r=n("SAYH"),a=n("eXjw"),i=n("GEBM"),s=n("haag"),o=n("0L4T"),c=n("iZ7K"),l=n("YxC/"),u=n("69Qu"),d=n("WPtp"),p=n("LbMF");const h=s.a;function g(t,e,n,a,d,p,g,m=!1){return function(t,e,n){if(!r.a.toString(n.viewId)){const n="viewid is required to call retrieve chart data";throw t.EventManager.ReportComponentFailure(h+".retrieveChartData",Error(n),s.d,e),new Error(n)}return!0}(n,a,d)&&function(t,e,n,a,s){if(!r.a.toString(n.visualizationId)||r.a.toString(n.visualizationId)===r.a.EMPTYGUIDSTRING){const r=t(),u=Object(l.b)(r,i.n),d=Object(c.f)(r,a)||a,p=String.format(u,d);return Object(o.a)(r,e,p,n,s),!1}return!0}(t,e,d,p,g)&&function(t,e,n,r){const a=t();if(!Object(u.b)(a)){const t=Object(l.b)(a,i.r);return Object(o.a)(a,e,t,n,r),!1}return!0}(t,e,d,g)&&function(t,e,n,r){if(n.isRollUpView){const a=t(),s=Object(l.b)(a,i.j);return Object(o.a)(a,e,s,n,r),!1}return!0}(t,e,d,g)&&(!m||function(t,e,n,r){if(!n.viewXml){const a=Object(l.b)(t(),i.g);return Object(o.a)(t(),e,a,n,r),!1}return!0}(t,e,d,g)&&function(t,e,n,r){if(!n.fetchXml){const a=Object(l.b)(t(),i.o);return Object(o.a)(t(),e,a,n,r),!1}return!0}(t,e,d,g))}function m(t,e,n){const i=new r.a(t),s=r.a.toString(i),o=new r.a(e);return{type:n,payload:{charts:{[s]:{[r.a.toString(o)]:{initialized:a.a.Initializing}}}}}}function b(t,e){return{type:e,payload:{chartData:{[t]:{initialized:a.a.Initializing}}}}}function f(t,e,n){var r;const a=null===(r=null==t?void 0:t.category)||void 0===r?void 0:r.primaryGroupBy,i=null==a?void 0:a.groupAttribute;if(!function(t,e){var n;if(!t)return!1;const r=null===(n=null==t?void 0:t.entity)||void 0===n?void 0:n.entityName,a=null==t?void 0:t.attributeName,i=Object(p.b)(a,r,e);return"picklist"===i||"state"===i||"status"===i}(i,n))return;if(!t.isOrderPresentOnPrimaryGroupBy())return;const s=i.aliasName,o=new v(s);e.sort(o.comparator),a.descending&&e.reverse()}function y(t){const e=/(Name=\"o\:)(\w+)(,)(\d+)(\")/,n=t.match(new RegExp(e,"g"));let r=[];return n&&n.forEach(t=>{r=t.match(new RegExp(e,"m"))}),r}class v{constructor(t){this._primaryGroupByAttributeAlias=null,this.comparator=(t,e)=>this._getRawValue(t)-this._getRawValue(e),this._primaryGroupByAttributeAlias=t}_getRawValue(t){if(this._primaryGroupByAttributeAlias in t.fields){const e=t.fields[this._primaryGroupByAttributeAlias],n=Object(d.e)(e);return parseInt(n,10)}return-1}}},"9NSo":function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="form.setLabel";function i(t,e,n){const i=Object(r.v)(e);return{type:a,payload:{label:n},meta:{pageId:t,contextKey:i}}}},"9i5P":function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var r=n("OQLa"),a=n("SAYH"),i=n("16wZ"),s=n("UqyN"),o=n("L8zx"),c=n("3yqi"),l=n("EOIL"),u=n("P6DH"),d=n("qshH"),p=n("9ksH"),h=n("E7fB"),g=n("n6Qt"),m=n("arV0"),b=n("deGN"),f=n("ZIjf");let y;class v{constructor(t,e,n,r,a,s){const o="ClientApi.XrmGridRow.constructor";t||Object(i.j)(o,"store"),r||Object(i.j)(o,"pageId"),n||Object(i.j)(o,"contextToken"),a||Object(i.j)(o,"entityType"),s||Object(i.j)(o,"entityId"),y=t,this._applicationContext=e,this._pageId=r,this._contextToken=n,this._entityType=a,this._entityId=s}get applicationContext(){return f.a.instance.reportUsage("ClientApi.XrmGridRow.applicationContext_get"),this._applicationContext}get context(){const t="ClientApi.XrmGridRow.context";try{return f.a.instance.reportCall(t),this._globalContext||(this._globalContext=new h.a(y,this._pageId)),f.a.instance.reportSuccess(t),this._globalContext}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,n),e}}get data(){const t="ClientApi.XrmGridRow.data";try{if(f.a.instance.reportCall(t),!this._data){const e=new s.a(y,this._contextToken,this._pageId,this,this._entityType,this._entityId,_,this._applicationContext);this._data=new o.a(y,this._contextToken,this._pageId,this,e);const n=new p.b(y,this._pageId),r=[],i={isEventParam:!0,name:"attributeName",value:""};r.push(i),e.attributes.forEach(e=>{const s=e.getName();i.value=s;const o={Id:s,Label:null,Name:s,ShowLabel:!1,Visible:!0,ClassId:new a.a(p.a),Disabled:!1,DataFieldName:s},c=n.createXrmControl(this._contextToken,o,this,t,r);c&&e.controls.add(c.getName(),c)})}return f.a.instance.reportSuccess(t),this._data}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,n),e}}getData(){try{return f.a.instance.reportUsage("ClientApi.XrmGridRow.getData"),this.data}catch(t){const e=d.a.getInstance().getEventParameters(this._contextToken);throw e.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.getData",t,null,e),t}}get ui(){try{if(f.a.instance.reportCall("ClientApi.XrmGridRow.ui"),!this._ui){const t=new p.b(y,this._pageId);this._ui=new l.a(y,this._contextToken,this._pageId,this,this._entityType,t)}return f.a.instance.reportSuccess("ClientApi.XrmGridRow.ui"),this._ui}catch(t){const e=d.a.getInstance().getEventParameters(this._contextToken);throw e.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.ui",t,null,e),t}}getControl(t){const e="ClientApi.XrmGridRow.getControl";try{f.a.instance.reportCall(e);const n=this.ui.controls.get(t);return f.a.instance.reportSuccess(e),n}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(e,t,null,n),t}}getAttribute(t){const e="ClientApi.XrmGridRow.getAttribute";try{if(f.a.instance.reportCall(e),this.data.entity){const n=this.data.entity.attributes.get(t);return f.a.instance.reportSuccess(e),n}return f.a.instance.reportSuccess(e),null}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(e,t,null,n),t}}getUrl(t){const e="ClientApi.XrmGridRow.getUrl";try{f.a.instance.reportCall(e);const n=this.data.entity.getEntityReference();this._internal=new g.a(y,this._applicationContext,this.context,this._pageId);const i=Object(m.g)(y.getState(),this._pageId),s={entityTypeName:n.entityType,etn:n.name,id:a.a.fromExternalGuid(n.id),entityTypeCode:this._internal.getEntityCode(n.entityType),languageId:this.context.userSettings.languageId,recordSetQueryKey:i.recordSetQueryKey};if(1===t){const t=y.dispatch(Object(r.a)(c.a.EditForm,s));return f.a.instance.reportSuccess(e),t}const o=Object(b.a)(y,this._pageId),l=y.dispatch(Object(r.c)(o,c.a.EditForm,s));return f.a.instance.reportSuccess(e),l}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(e,t,null,n),t}}get entityReference(){try{return this.data.entity.getEntityReference()}catch(t){const e=d.a.getInstance().getEventParameters(this._contextToken);throw e.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.entityReference",t,null,e),t}}}function _(t,e,n){const r=Object(u.D)(y.getState(),{id:n},e.parentContextToken);return r||(t.TraceManager.getTracer("ClientApi.XrmGridRow.getAttributeNames").error("Grid attributes was null"),[])}},"9ksH":function(t,e,n){"use strict";n.d(e,"b",(function(){return Et})),n.d(e,"a",(function(){return jt}));var r=n("AF/G"),a=n("arV0"),i=n("HcnX"),s=n("i1f0"),o=n("TsER"),c=n("qshH"),l=n("ZIjf");let u;class d extends i.a{constructor(t,e,n,r,a,i){super(t,e,n,r,a,i),u=t}refresh(){const t="ClientApi.XrmControlTimer.refresh";try{l.a.instance.reportCall(t),u.dispatch(Object(o.b)(this.pageId,this.contextToken,this.name)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}getState(){const t="ClientApi.XrmControlTimer.getState";try{l.a.instance.reportCall(t);const e=Object(s.cb)(u.getState(),this.pageId,this.contextToken),n=e.controls[this.getName()].parameters.timerState;return l.a.instance.reportSuccess(t),n}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlTimer.getControlType"),"timercontrol"}}var p=n("lJW1"),h=n("1kth"),g=n("16wZ"),m=n("PUjk");let b;class f extends i.a{constructor(t,e,n,r,a,i){super(t,e,n,r,a,i),b=t,this.registerObserversForControlStateChange()}addOnClick(t){const e="ClientApi.XrmControlButton.addOnClick";t||Object(g.j)(e,"handler");try{l.a.instance.reportCall(e),b.dispatch(Object(h.b)(this.contextToken,this.pageId,this.name,t)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}removeOnClick(t){const e="ClientApi.XrmControlButton.removeOnClick";t||Object(g.j)(e,"handler");try{l.a.instance.reportCall(e),b.dispatch(Object(h.w)(this.contextToken,this.pageId,this.name,t)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlButton.getControlType"),"button"}registerObserversForControlStateChange(){if(this.getName().startsWith("header_process")){const t=Object(m.a)(this.pageId);t&&this.controlStateObservable.registerObserver(t)}}}var y=n("0nOn"),v=n("yl9a"),_=n("NjDY"),S=n("3mEc");let O;class C extends i.a{constructor(t,e,n,r,a,i){super(t,e,n,r,a,i),O=t;const s=[{name:"controlName",value:a,isEventParam:!0}];this._clientApiExecutorWebResource=new y.a(t,"ClientApi.XrmControlWebResource.",n,e,s)}getSrc(){return this._clientApiExecutorWebResource.execute("getSrc",()=>{const t=O.getState(),e=Object(_.t)(t)+Object(s.wb)(t,{controlName:this.name,id:this.pageId},this.contextToken);return Object(S.c)(t,this.pageId,this.name,this.contextToken,e)})}getContentWindow(){return this._clientApiExecutorWebResource.executeAsync("getContentWindow",(t,e)=>{const n=this.formContext.applicationContext.TraceManager.getTracer(t),r=()=>{const t=Object(s.xb)(O.getState(),this.pageId,this.getName());if(t){let r=null;try{return r=t.contentWindow,"complete"===r.document.readyState?Promise.resolve(r):(e.push({name:"readyState",value:r.document.readyState}),n.info("Frame content window not ready",e),Promise.reject({message:"Frame element not ready.",errorCode:111,contentWindow:r}))}catch(t){return r?(e.push({name:"Error",value:t.message}),n.warn("Error getting Frame content window readyState",e),Promise.resolve(r)):Promise.reject(t)}}else n.info("Frame DOM element not ready",e);return Promise.reject({message:"Frame element could not be found.",errorCode:111})};return r().then(t=>Promise.resolve(t)).catch(t=>{if(111!==t.errorCode)return Promise.reject(t);const a=this.contextToken,i=this.pageId,s=this.getName();return new Promise((t,o)=>{const c=()=>{Object(h.G)(a,i,c,s),r().then(e=>{t(e)}).catch(r=>{r.contentWindow?(n.err("Frame content window readyState should be complete after OnReadyStateComplete",e),t(r.contentWindow)):o&&(111===r.errorCode?(n.err("Frame Element not found after OnReadyStateComplete",e),o(new Error("Frame element could not be found."))):o(r))})};O.dispatch(Object(h.l)(a,i,c,s))})})})}getObject(){return this._clientApiExecutorWebResource.execute("getObject",()=>Object(s.xb)(O.getState(),this.pageId,this.name))}setSrc(t){return this._clientApiExecutorWebResource.execute("getControlType",()=>{Object(g.a)(t)||O.dispatch(Object(v.b)(this.pageId,this.name,this.contextToken,t))})}getControlType(){return this._clientApiExecutorWebResource.execute("getControlType",()=>"webresource")}addOnReadyStateComplete(t){return this._clientApiExecutorWebResource.execute("addOnReadyStateComplete",()=>{O.dispatch(Object(h.l)(this.contextToken,this.pageId,t,this.getName()))},[{name:"handler",value:t,isRequired:!0}])}removeOnReadyStateComplete(t){return this._clientApiExecutorWebResource.execute("removeOnReadyStateComplete",()=>{O.dispatch(Object(h.G)(this.contextToken,this.pageId,t,this.getName()))},[{name:"handler",value:t,isRequired:!0}])}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let I;class P extends C{constructor(t,e,n,r,a,i){super(t,e,n,r,a,i),I=t}getInitialUrl(){const t="ClientApi.XrmControlIFrame.getInitialUrl";try{l.a.instance.reportCall(t);const e=Object(s.sb)(I.getState(),{controlName:this.name,id:this.pageId},this.contextToken);return l.a.instance.reportSuccess(t),e}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlIFrame.getControlType"),"iframe"}getSrc(){const t="ClientApi.XrmControlIFrame.getSrc";try{l.a.instance.reportCall(t);const e=I.getState(),n=this.getInitialUrl(),r=Object(S.c)(e,this.pageId,this.name,this.contextToken,n);return l.a.instance.reportSuccess(t),r}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}}var j=n("bGh0"),T=n("/5se"),E=n("xorU"),F=n("fREn"),w=n("hA8P"),x=n("SAYH"),A=n("/q65");let N;class k extends j.a{constructor(t,e,n,r,a,i){super(t,e,n,r,a,i),N=t,this._clientApiExecutorLookup=new y.a(t,"ClientApi.XrmControlLookup.",n,e,[{name:"controlName",value:a,isEventParam:!0}])}addCustomView(t,e,n,r,a,i){this._clientApiExecutorLookup.execute("addCustomView",(s,o)=>{const c=x.a.tryParseOrNull(t);c||Object(g.k)(s,"guid","viewId",o),N.dispatch(Object(F.a)(this.pageId,this.name,c,e,this.contextToken,n,r,a)),i&&this.setDefaultView(t)},[{name:"viewId",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"guid"},{name:"entityLogicalName",value:e,isRequired:!0,isEventParam:!0},{name:"viewDisplayName",value:n,isRequired:!0},{name:"fetchXml",value:r,isRequired:!0},{name:"layoutXml",value:a,isRequired:!0},{name:"isDefault",value:i,isRequired:!0}])}addCustomFilter(t,e){const n="ClientApi.XrmControlLookup.addCustomFilter";Object(g.a)(t)&&Object(g.j)(n,"fetchXmlFilter"),Object(g.b)(t)||Object(g.l)(n);try{l.a.instance.reportCall(n),N.dispatch(Object(E.d)(this.pageId,this.name,e,this.contextToken,t)),this.controlStateObservable.notifyObservers(this.controlDescriptor),l.a.instance.reportSuccess(n)}catch(t){const e=c.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(n,t,null,e),t}}get disableMru(){const t="ClientApi.XrmControlLookup.getDisableMru";try{l.a.instance.reportCall(t);const e=Object(s.x)(N.getState(),{id:this.pageId,controlName:this.name},this.contextToken);return l.a.instance.reportSuccess(t),e}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}set disableMru(t){const e="ClientApi.XrmControlLookup.setDisableMru";try{l.a.instance.reportCall(e),N.dispatch(Object(w.b)(N.getState(),this.pageId,this.name,this.contextToken,t)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}startCustomFilter(){const t="ClientApi.XrmControlLookup.startCustomFilter";try{l.a.instance.reportCall(t),N.dispatch(Object(E.f)(this.pageId,this.name,this.contextToken)),this.controlStateObservable.notifyObservers(this.controlDescriptor),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}endCustomFilter(){const t="ClientApi.XrmControlLookup.endCustomFilter";try{l.a.instance.reportCall(t),N.dispatch(Object(E.e)(this.pageId,this.name,this.contextToken)),this.controlStateObservable.notifyObservers(this.controlDescriptor),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}getDefaultView(){return this._clientApiExecutorLookup.execute("getDefaultView",()=>{const t=Object(s.O)(N.getState(),this.pageId,this.name,this.contextToken);return t?x.a.externalGuid(new x.a(t)):null})}setDefaultView(t){this._clientApiExecutorLookup.execute("setDefaultView",(e,n)=>{const r=x.a.tryParseOrNull(t);r||Object(g.k)(e,"guid","id",n),N.dispatch(Object(T.b)(this.pageId,this.name,this.contextToken,r))},[{name:"defaultViewId",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"guid"}])}addOnLookupTagClick(t){const e="ClientApi.XrmControlLookup.addOnLookupTagClick";t||Object(g.j)(e,"handler");try{l.a.instance.reportCall(e),N.dispatch(Object(h.g)(this.contextToken,this.pageId,this.name,t)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}addPreSearch(t){const e="ClientApi.XrmControlLookup.addPreSearch";t||Object(g.j)(e,"handler");try{l.a.instance.reportCall(e),N.dispatch(Object(h.t)(this.contextToken,this.pageId,this.name,t)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}removeOnLookupTagClick(t){const e="ClientApi.XrmControlLookup.removeOnLookupTagClick";t||Object(g.j)(e,"handler");try{l.a.instance.reportCall(e),N.dispatch(Object(h.B)(this.contextToken,this.pageId,this.name,t)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}removePreSearch(t){const e="ClientApi.XrmControlLookup.removePreSearch";t||Object(g.j)(e,"handler");try{l.a.instance.reportCall(e),N.dispatch(Object(h.O)(this.contextToken,this.pageId,this.name,t)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlLookup.getControlType"),"lookup"}getEntityTypes(){const t="ClientApi.XrmControlLookup.getEntityTypes";try{l.a.instance.reportCall(t);const e=Object(s.Ob)(N.getState(),this.pageId,this.contextToken,this._dataFieldName);return l.a.instance.reportSuccess(t),e}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}setEntityTypes(t){const e="ClientApi.XrmControlLookup.setEntityTypes";t||Object(g.j)(e,"entityTypes");const n=[];try{l.a.instance.reportCall(e),t=Array.from(new Set(t));const r=Object(s.Pb)(N.getState(),this.pageId,this.contextToken,this._dataFieldName),a={};r.forEach(t=>{a[t]=!0}),t.forEach(t=>{a[t]||n.push(t)})}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e+".validation",t,null,n),t}n.length>0&&Object(g.h)(e,"entityType",n[0]);try{N.dispatch(Object(A.b)(this.pageId,this.contextToken,this._dataFieldName,t)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}get _dataFieldName(){return this.controlDescriptor&&this.controlDescriptor.DataFieldName?this.controlDescriptor.DataFieldName:this.name}}var D=n("91Ew"),M=n("KnyI"),R=n("tvJg");let L;class V extends j.a{constructor(t,e,n,r,a,i){super(t,e,n,r,a,i),L=t;const s=[{name:"controlName",value:a,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];this._clientApiExecutorOptionsetBase=new y.a(t,"ClientApi.XrmControlOptionSetBase.",n,e,s)}addOption(t,e){this._clientApiExecutorOptionsetBase.execute("addOption",()=>{const n=this._options.length;Object(g.a)(e)||isNaN(e)||e>=n?e=n:e<=0?e=0:e-=1,L.dispatch(Object(D.b)(this.pageId,this.contextToken,this.controlDescriptor.DataFieldName,{Color:null,Label:t.text,Value:t.value},e))},[{name:"optionSetItem",value:t,isRequired:!0},{name:"optionSetItem.value",value:null==t?void 0:t.value,isRequired:!0,expectedDataType:"number"}])}clearOptions(){this._clientApiExecutorOptionsetBase.execute("clearOptions",()=>{L.dispatch(Object(R.b)(this.pageId,this.contextToken,this.controlDescriptor.DataFieldName))})}removeOption(t){return this._clientApiExecutorOptionsetBase.execute("removeOption",()=>{L.dispatch(Object(M.b)(this.pageId,this.contextToken,this.controlDescriptor.DataFieldName,t))},[{name:"value",value:t,isRequired:!0}])}getOptions(){return this._clientApiExecutorOptionsetBase.execute("getOptions",()=>this._options)}get _options(){const t=new Array,e=Object(s.B)(L.getState(),this.pageId,this.contextToken,this.name);if(e){e.length&&t.push({text:"",value:NaN});for(const n in e)t.push({text:e[n].Label,value:e[n].Value})}return t}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class B extends V{getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlOptionSet.getControlType"),"optionset"}}var G=n("cf3Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let X;class U extends j.a{constructor(t,e,n,r,a,i){super(t,e,n,r,a,i),this._isDateFormatDateTime=!1,X=t,this._clientApiExecutorDateTime=new y.a(t,"ClientApi.XrmControlDateTime.",n,e,[{name:"controlName",value:a,isEventParam:!0}]),this._clientApiExecutorDateTime.execute("constructor",(t,e)=>{this._isDateFormatDateTime=this._getShowTime(t,e)},null,!1)}getShowTime(){return this._clientApiExecutorDateTime.execute("getShowTime",(t,e)=>this._getShowTime(t,e))}setShowTime(t){this._clientApiExecutorDateTime.execute("setShowTime",(e,n)=>{if(this._getShowTime(e,n)!==t){const e=t&&this._isDateFormatDateTime?"datetime":"date";X.dispatch(Object(G.b)(this.pageId,this.contextToken,this.name,e))}})}_getShowTime(t,e){const n=this.getAttrDescriptor(t,e,this._clientApiExecutorDateTime);return!n||"datetime"===n.Format}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class q extends V{getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlMultiSelectOptionSet.getControlType"),"multiselectoptionset"}}var z=n("455M"),H=n("zgeC"),W=n("dHD5"),Y=n("HAeo"),K=n("ghNp"),Q=n("P6DH");let J;class Z extends i.a{constructor(t,e,n,r,a){super(t,e,n,r,r.Name,a);const i=Object(W.e)(e,r.Name);t.dispatch(Object(K.a)(this,n,i)),J=t,this._clientApiExecutorControlstream=new y.a(t,"ClientApi.XrmControlStream.",n,e)}get clientApiExecutor(){return this._clientApiExecutorControlstream}_getGridControls(){if(!this._underlyingGridControls){this._underlyingGridControls=[];const t=this.controlDescriptor.Parameters&&this.controlDescriptor.Parameters[0]&&this.controlDescriptor.Parameters[0].StreamObjects;if(t){const e=t.StreamObjectCollection;if(e){const t=e.ShowAsTiles?[!0,!1]:[!0];for(const n of e)for(const e of t){const t=Object(W.o)(this.contextToken,this.getName(),n.Id,e),r=new Y.a(J,t,this.pageId,!1,3,!0,this.formContext.applicationContext,t.controlName);this._underlyingGridControls.push({contextToken:t,gridControl:r})}}}}return this._underlyingGridControls}refresh(){this.clientApiExecutor.execute("refresh",()=>{const t=[];for(const{contextToken:e,gridControl:n}of this._getGridControls()){if(Object(Q.hb)(J.getState(),this.pageId,e,e.controlName))try{n.refresh()}catch(e){t.push(e)}}if(t.length>0){const e=[...c.a.getInstance().getEventParameters(this.contextToken),{name:"count",value:t.length}];Object(g.e)(this.clientApiExecutor.getComponentName("refresh"),"Some grids in stream failed to refresh",null,e)}})}}var $=n("odYE"),tt=n("6QGX"),et=n("tpZ5"),nt=n("E7fB"),rt=n("jq7Z"),at=n("zsAz"),it=n("IaGr");let st;class ot extends i.a{constructor(t,e,n,r,a,i){super(t,e,n,r,r.Name,a),st=t,this._clientApiExecutor=new y.a(t,"ClientApi.XrmControlSubFormBase.",n,e,[{name:"controlName",value:null==r?void 0:r.Name,isEventParam:!0}]),this._xrmControlFactory=i}getParentComponent(){return Object(rt.a)(st.getState(),this.pageId)}get context(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.context",()=>this._form?this._form.context:null)}get _parentFormContext(){return this.formContext}get _form(){if(this._tryGetSubFormInstanceId(),!this._isSubFormMetadataLoaded())throw Object(at.d)("SUBFORM_METADATA_NOT_LOADED",2415919107);const t=this._subFormControlContextToken;if(t&&this._formInstance)return this._formInstance;const e=this._getValueInternal(),n=Object(tt.d)(e);if(t)return this._formInstance=st.dispatch(Object(K.b)(this._subFormInstanceId,t)),this._formInstance||n&&n.length>0&&(this._formInstance=st.dispatch(this._createXrmForm(t,this._subFormInstanceId,n[0].entityType,new x.a(n[0].id)))),this._formInstance&&!this._formInstance.context&&(this._formInstance.context=this._parentFormContext.context),this._formInstance;return c.a.getInstance().getEventParameters(this.contextToken).push({name:"controlName",value:this.getName()}),it.a.getInstance().traceManager.getTracer("ClientApi.XrmControlSubFormBase._form").info("XrmControlSubForm._form is null"),null}_createXrmForm(t,e,n,r){const a=this._xrmControlFactory;return{type:"clientapi.create.xrmform",sync:!0,execute(i,s){const o=new et.a(i,{etn:n,id:r},a,t,e);o.applicationContext=s;const c=new nt.a(i,e);return o.context=c,o}}}get _subFormControlContextToken(){const t=this._getValueInternal(),e=Object(tt.d)(t);return e&&e[0]&&e[0].id?this._entityRecordId!==e[0].id&&(this._entityType=e[0].entityType,this._entityRecordId=e[0].id,this._subFormContextToken&&st.dispatch(Object(K.h)(this._subFormInstanceId,this._subFormContextToken)),this._subFormContextToken=this._getSubFormContextToken(this.contextToken,this.name,this._entityType),this._formInstance=null):this._subFormContextToken&&(st.dispatch(Object(K.h)(this._subFormInstanceId,this._subFormContextToken)),this._subFormContextToken=void 0,this._entityType=void 0,this._entityRecordId=void 0,this._formInstance=null),this._subFormContextToken}get data(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.data",()=>this._form?this._form.data:null)}get ui(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.ui",()=>this._form?this._form.ui:null)}get entityReference(){return l.a.instance.reportUsage("ClientApi.XrmControlSubFormBase.entityReference"),null}getControl(t){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getControl",()=>this._form?this._form.getControl(t):null)}getAttribute(t){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getAttribute",()=>this._form?this._form.getAttribute(t):null)}getUrl(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getUrl",()=>this._form?this._form.getUrl():null)}refresh(){this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.refresh",()=>{this.data&&this.data.refresh()})}_getValueInternal(){const t=this._parentFormContext.data.entity.getEntityName(),e=this._parentFormContext.data.entity.getId(),n=e?new $.a(t,new x.a(e)):new $.a(t),r=Object(s.ac)(st.getState(),this._subFormInstanceId,this.contextToken);return Object(s.X)(st.getState(),this._subFormInstanceId,this._subFormContextToken,r,n,this.controlDescriptor.DataFieldName)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let ct;class lt extends ot{constructor(t,e,n,r,a,i){super(t,e,n,r,a,i),ct=t}_getSubFormContextToken(t,e,n){return Object(W.l)(this.contextToken,this.name,this._entityType)}getSubFormInstanceId(){return this.pageId}_isSubFormMetadataLoaded(){return!!this._subFormInstanceId}_tryGetSubFormInstanceId(){}get _subFormInstanceId(){return this.pageId}isLoaded(){const t="ClientApi.XrmControlQuickForm.isLoaded";try{l.a.instance.reportCall(t);const e=Object(s.ic)(ct.getState(),this.getSubFormInstanceId(),this._subFormControlContextToken);return l.a.instance.reportSuccess(t),!!e}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlQuickForm.getControlType"),"quickform"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let ut;class dt extends j.a{constructor(t,e,n,r,a,i){t||Object(g.j)("ClientApi.XrmStandardDataControl.constructor","store"),super(t,e,n,r,a,i),ut=t}getValue(){const t="ClientApi.XrmStandardDataControl.getValue";try{l.a.instance.reportCall(t);const e=Object(s.F)(ut.getState(),{controlName:this.name,id:this.pageId},this.contextToken);return l.a.instance.reportSuccess(t),e}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(t,e,null,n),e}}addOnKeyPress(t){const e="ClientApi.XrmStandardDataControl.addOnKeyPress";t||Object(g.j)(e,"handler");try{l.a.instance.reportCall(e),ut.dispatch(Object(h.e)(this.contextToken,this.pageId,this.name,t)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(e,t,null,n),t}}removeOnKeyPress(t){const e="ClientApi.XrmStandardDataControl.removeOnKeyPress";t||Object(g.j)(e,"handler");try{l.a.instance.reportCall(e),ut.dispatch(Object(h.z)(this.contextToken,this.pageId,this.name,t)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(e,t,null,n),t}}fireOnKeyPress(){const t="ClientApi.XrmStandardDataControl.fireOnKeyPress";try{l.a.instance.reportCall(t),ut.dispatch(Object(h.R)(this.contextToken,this.pageId,this.name,this)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(t,e,null,n),e}}}var pt=n("ywwS"),ht=n("VqBP"),gt=n("w92Z");class mt extends B{constructor(t,e,n,r,a,i){super(t,e,n,r,a,i),this._clientApiExecutorDependentOptionSet=new y.a(t,"ClientApi.XrmControlDependentOptionSet.",n,e,[{name:"controlName",value:a,isEventParam:!0}])}addOption(t,e){return this._clientApiExecutorDependentOptionSet.execute("addOption",(t,e)=>{Object(g.i)(t,"DependentOptionSet.addOption",e)})}clearOptions(){return this._clientApiExecutorDependentOptionSet.execute("clearOptions",(t,e)=>{Object(g.i)(t,"DependentOptionSet.clearOptions",e)})}removeOption(t){return this._clientApiExecutorDependentOptionSet.execute("removeOption",(t,e)=>{Object(g.i)(t,"DependentOptionSet.removeOption",e)})}setDisabled(t){return this._clientApiExecutorDependentOptionSet.execute("setDisabled",(t,e)=>{Object(g.i)(t,"DependentOptionSet.setDisabled",e)})}setVisible(t){return this._clientApiExecutorDependentOptionSet.execute("setVisible",(t,e)=>{Object(g.i)(t,"DependentOptionSet.setVisible",e)})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class bt extends q{constructor(t,e,n,r,a,i){super(t,e,n,r,a,i),this._clientApiExecutorDependentOptionSet=new y.a(t,"ClientApi.XrmControlMultiSelectDependentOptionSet.",n,e,[{name:"controlName",value:a,isEventParam:!0}])}addOption(t,e){return this._clientApiExecutorDependentOptionSet.execute("addOption",(t,e)=>{Object(g.i)(t,"MultiSelectDependentOptionSet.addOption",e)})}clearOptions(){return this._clientApiExecutorDependentOptionSet.execute("clearOptions",(t,e)=>{Object(g.i)(t,"MultiSelectDependentOptionSet.clearOptions",e)})}removeOption(t){return this._clientApiExecutorDependentOptionSet.execute("removeOption",(t,e)=>{Object(g.i)(t,"MultiSelectDependentOptionSet.removeOption",e)})}setDisabled(t){return this._clientApiExecutorDependentOptionSet.execute("setDisabled",(t,e)=>{Object(g.i)(t,"MultiSelectDependentOptionSet.setDisabled",e)})}setVisible(t){return this._clientApiExecutorDependentOptionSet.execute("setVisible",(t,e)=>{Object(g.i)(t,"MultiSelectDependentOptionSet.setVisible",e)})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ft extends dt{setDisabled(t){const e="ClientApi.XrmDependentOptionSetGridControl.setDisabled";l.a.instance.reportUsage(e),Object(g.e)(e,String.format("Can not execute {0} for dependent option set control","setDisabled"))}}var yt=n("LbMF"),vt=n("3/02"),_t=n("Lyxw"),St=n("Z/4N"),Ot=n("BoVI");let Ct;class It extends ot{constructor(t,e,n,r,a,i){var s,o;super(t,e,n,r,a,i),this._formInstanceId=null===(o=null===(s=this.getParentComponent())||void 0===s?void 0:s.formInstances)||void 0===o?void 0:o.formInstanceIdByControlName[this.controlDescriptor.Name],this._formComponentClientApiExecutor=new y.a(t,"ClientApi.XrmControlFormComponent.",this._formInstanceId),this._formComponentClientApiExecutor.addEventParameter({name:"controlName",value:r.Name,isEventParam:!0}),Ct=t}_tryGetSubFormInstanceId(){var t,e;this._formInstanceId||(this._formInstanceId=null===(e=null===(t=this.getParentComponent())||void 0===t?void 0:t.formInstances)||void 0===e?void 0:e.formInstanceIdByControlName[this.controlDescriptor.Name])}_isSubFormMetadataLoaded(){return!!this._subFormInstanceId}_getSubFormContextToken(t,e,n){return Object(W.h)(n)}get _subFormInstanceId(){return this._formInstanceId}isLoaded(){return this._isSubFormMetadataLoaded()&&this._formComponentClientApiExecutor.execute("ClientApi.XrmControlFormComponent.isLoaded",()=>!!Object(s.yc)(Ct.getState(),this._subFormInstanceId,this._subFormControlContextToken))}setInitializationIntent(t="fullload"){this._formComponentClientApiExecutor.execute("setInitializationIntent",e=>{"nothing"!==t&&"fullload"!==t&&Object(g.h)(e,t,"intent"),Ct.dispatch(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(t,e,n,r){const a=Object(W.v)(n);return{type:Ot.d,payload:r,meta:{pageId:t,controlName:e,contextKey:a}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(this.pageId,this.name,this.contextToken,t))},[{name:"intent",value:t,isEventParam:!0,expectedDataType:"string"}])}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlFormComponent.getControlType"),"formcomponent"}}var Pt=n("CYtR");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const jt="3d180de6-b456-4d90-9d5a-9899936baf44";let Tt;class Et{constructor(t,e){this._pageId=e,Tt=t}createXrmControl(t,e,n,s,o){Object(g.g)(e,s,"control");try{o.push({name:"controlClassId",value:e&&e.ClassId?e.ClassId.guid:""}),o.push({name:"controlName",value:e?e.Name:""}),o.push({name:"controlDataFieldName",value:e?e.DataFieldName:""}),o.push({name:"pageId",value:this._pageId});const l=Object(a.l)(Tt.getState(),this._pageId);o.push({name:"pageType",value:l});let u=!1,h=null,g=!1;const m=this._getControlType(e,n,t,s,o);switch(m){case r.i.guid:h=new f(Tt,t,this._pageId,e,e.Name,n);break;case z.a.KbContent:case z.a.KbArticle:case r.C.guid:case r.I.guid:h=new P(Tt,t,this._pageId,e,e.Name,n);break;case z.a.LookupRegarding:case z.a.LookupCustomer:case z.a.LookupMultiEntity:case z.a.LookupOwner:case z.a.LookupSimple:case z.a.LookupPartyList:case r.M.guid:case r.fb.guid:case r.S.guid:case r.l.guid:if(Object(_t.c)(Tt.getState(),vt.jb)){const r=Object(rt.b)(Tt.getState(),this._pageId,t);if(Object(St.c)(Tt.getState(),e.UniqueId,r)===Pt.d){h=new It(Tt,t,this._pageId,e,n,this);break}}h=new k(Tt,t,this._pageId,e,e.Name,n);break;case z.a.OptionSet:case r.U.guid:if(g=Object(_t.c)(Tt.getState(),vt.L),1==g){const r=this._getEntityNameForControl(e,n);if(Object(yt.l)(Tt.getState(),r,e.DataFieldName)){h=new mt(Tt,t,this._pageId,e,e.Name,n);break}}case z.a.EntityNameOptionSet:case z.a.TwoOptions:case z.a.StatusOptionSet:case r.sb.guid:case r.K.guid:case r.W.guid:case r.V.guid:case r.hb.guid:case r.n.guid:case r.N.guid:h=new B(Tt,t,this._pageId,e,e.Name,n);break;case z.a.MultiSelectPicklist:case r.Q.guid:if(g=Object(_t.c)(Tt.getState(),vt.L),g){const r=this._getEntityNameForControl(e,n);if(Object(yt.l)(Tt.getState(),r,e.DataFieldName)){h=new bt(Tt,t,this._pageId,e,e.Name,n);break}}h=new q(Tt,t,this._pageId,e,e.Name,n);break;case z.a.QuickForm:case r.cb.guid:case r.ab.guid:case r.Z.guid:const a=new lt(Tt,t,this._pageId,e,n,this);n.ui.quickForms.add(e.Name,a);break;case z.a.SearchWidget:case z.a.ReferencePanelSearchWidget:case r.db.guid:case r.kb.guid:h=new p.a(Tt,t,this._pageId,e,e.Name,n);break;case z.a.TimelineWall:case r.qb.guid:h=Tt.dispatch(Object(K.f)(this._pageId,Object(W.p)(t,e.Name))),h||(h=new pt.a(Tt,t,this._pageId,e,e.Name,e.LabelId,n,n.applicationContext));break;case z.a.DateAndTimeDateOnly:case z.a.DateAndTimeDateAndTime:case r.q.guid:h=new U(Tt,t,this._pageId,e,e.Name,n);break;case z.a.Grid:case r.eb.guid:case r.E.guid:const l=Object(W.p)(t,e.Name),b=Tt.dispatch(Object(K.c)(this._pageId,l));b&&(b.getName||3!==b.getGridType()?h=b:(c.a.getInstance().reportFailure(s,new Error("Main grid found in cache - converting to a subgrid."),null,o),Tt.dispatch(Object(K.h)(this._pageId,l)))),h||(h=new H.a(Tt,t,this._pageId,e.Name,Object(Q.wb)(Tt.getState(),this._pageId,t,e.Name),n,e,n.applicationContext));break;case z.a.Timer:case r.rb.guid:h=new d(Tt,t,this._pageId,e,e.Name,n);break;case z.a.WebResourceHtmlControl:case r.ub.guid:case r.vb.guid:h=new C(Tt,t,this._pageId,e,e.Name,n);break;case r.mb.guid:h=new Z(Tt,t,this._pageId,e,n);break;case r.z.guid:case r.G.guid:break;case jt:if(g=Object(_t.c)(Tt.getState(),vt.L),g&&Object(yt.l)(Tt.getState(),t.entityTypeName,e.Name)){h=new ft(Tt,t,this._pageId,e,e.Name,n);break}case z.a.AppliedFilters:case z.a.BusinessProcessFlow:case z.a.Card:case z.a.Currency:case z.a.Dashboard:case z.a.Decimal:case z.a.EmailEngagementActions:case z.a.EmailEngagementRecipientActivity:case z.a.FP:case z.a.GlobalFilter:case z.a.MicrosoftFlow:case z.a.Multiple:case z.a.PowerBI:case z.a.ReferencePanel:case z.a.Search:case z.a.SingleLineAddress:case z.a.SingleLineEmail:case z.a.SingleLinePhone:case z.a.SingleLineText:case z.a.SingleLineTextArea:case z.a.SingleLineTickerSymbol:case z.a.SingleLineURL:case z.a.SocialInsightsControl:case z.a.WholeDuration:case z.a.WholeLanguage:case z.a.WholeNone:case z.a.WholeTimeZone:case r.a.guid:case r.b.guid:case r.c.guid:case r.d.guid:case r.e.guid:case r.f.guid:case r.g.guid:case r.h.guid:case r.j.guid:case r.k.guid:case r.m.guid:case r.p.guid:case r.r.guid:case r.s.guid:case r.t.guid:case r.u.guid:case r.v.guid:case r.w.guid:case r.x.guid:case r.y.guid:case r.A.guid:case r.B.guid:case r.D.guid:case r.H.guid:case r.J.guid:case r.L.guid:case r.O.guid:case r.P.guid:case r.R.guid:case r.T.guid:case r.X.guid:case r.Y.guid:case r.bb.guid:case r.gb.guid:case r.ib.guid:case r.jb.guid:case r.lb.guid:case r.mb.guid:case r.nb.guid:case r.ob.guid:case r.pb.guid:case r.tb.guid:case r.wb.guid:u=!0;default:h=e.DataFieldName?new dt(Tt,t,this._pageId,e,e.Name,n):new i.a(Tt,t,this._pageId,e,e.Name,n),u||(o.push({name:"controlType",value:m}),it.a.getInstance().traceManager.getTracer(s).error("Unknown Form Control",o))}return h}catch(t){return c.a.getInstance().reportFailure(s+".createXrmControl",t,null,o),null}}_getControlType(t,e,n,a,i){if(x.a.equals(t.ClassId,r.o)){const r=this._getCustomControlType(t,e,n);return r||it.a.getInstance().traceManager.getTracer(a+".controlPrimaryType").error("Control primary type could not be determined",i),i.push({name:"manifestControlType",value:r}),r}return t.ClassId.guid}_getCustomControlType(t,e,n){var r,a,i;const o=Object(rt.b)(Tt.getState(),this._pageId,n);let c=Object(ht.c)(Tt.getState(),t,o);if(!c){const l=Object(s.h)(),u=(null===(a=null===(r=e.data)||void 0===r?void 0:r.entity)||void 0===a?void 0:a.getEntityName())||"";let d=l(Tt.getState(),t,this._pageId,o,u);if(d||(d=Object(gt.a)(Tt.getState(),t,this._pageId,n)),null==d?void 0:d.Parameters)for(const t in d.Parameters)if(null===(i=d.Parameters[t])||void 0===i?void 0:i.Primary){c=d.Parameters[t].Type;break}}return c}_getEntityNameForControl(t,e){let n="";if(t.Relationship)n=Object(s.T)(Tt.getState(),this._pageId,t.Relationship);else{const r=e.getAttribute(t.DataFieldName);r&&r.getParent()&&(n=r.getParent().getEntityName())}return n}}},AE7n:function(t,e,n){"use strict";n.d(e,"a",(function(){return S}));var r=n("YYhu"),a=n("iZ7K"),i=n("vNXc"),s=n("q/4y"),o=n("GxhD"),c=n("hQd/"),l=n("SAYH"),u=n("i1f0"),d=n("dHD5"),p=n("arV0"),h=n("P6DH"),g=n("fILV"),m=n("aF0N"),b=n("P+kM"),f=n("3/02"),y=n("Lyxw"),v=n("HfZT"),_=n("E8F2");function S(t,e,n,S,O,C,I=!1,P){return{type:"embeddedEntity.save",execute(S,j){const T=S.getState(),E=new l.a(n),F=Object(d.f)(P,E,e);let w;switch(Object(p.l)(T,t)){case g.a:w=Object(h.R)(T,t,F);break;default:w=Object(u.ac)(T,t,F)}const x=Object(m.c)(T),A=Object(m.b)(T);if((x||A)&&"Dashboard"!==Object(p.l)(T,t)){const e=j.ScriptManager.getContainer(t).getEventManager();if(S.dispatch(e.runOnSave(P,1,null,n)))return Promise.reject(Object(_.b)(T,t,2200000005,""))}return S.dispatch(Object(r.c)(w,I,O)).then(r=>{const u=Object(h.qb)(T,new l.a(C),t),d=Object(a.h)(T,e),p=i.a.fromXmlAndSql(u.fetchXML,u.offlineSqlQuery,u.viewId,null,u.entityLogicalName,S.getState);return p.where(new s.a("eq",new o.a(e,d.PrimaryIdAttribute),new c.a(n))),S.dispatch(Object(v.d)(p.getQueryState())).then(()=>r)}).catch(t=>(Object(y.a)(T,f.xb)&&w&&S.dispatch(Object(b.b)(w,!1)),Promise.reject(t)))}}}},AbXy:function(t,e,n){"use strict";n.d(e,"a",(function(){return y}));var r=n("P6DH"),a=n("Sbn7"),i=n("9i5P"),s=n("16wZ"),o=n("dHD5"),c=n("SAYH"),l=n("5Oca"),u=n("odYE"),d=n("WPtp"),p=n("qshH"),h=n("1kth"),g=n("ZIjf"),m=n("Uv1Y"),b=n("IaGr");let f;class y{constructor(t,e,n,r,a,i,o){const c="ClientApi.XrmControlGrid.constructor";if(r||Object(s.j)(c,"pageId"),n||Object(s.j)(c,"contextToken"),t||Object(s.j)(c,"store"),a||Object(s.j)(c,"gridEntity"),Object(s.a)(i)&&Object(s.j)(c,"isEditable"),f=t,this._applicationContext=e,this._contextToken=n,this._pageId=r,this._gridEntityName=a,this.controlName=o,this._isEditable=i,!this._contextToken.contextTokenType){const t=p.a.getInstance().getEventParameters(this._contextToken);t.push({name:"controlName",value:this.controlName}),t.push({name:"gridEntityName",value:this._gridEntityName}),p.a.getInstance().reportFailure(c,new m.a("context token passed to grids with empty context token type"),null,t)}}get _isEditable(){const t=Object(r.V)(f.getState(),this._pageId,this._gridEntityName,this._contextToken,this.controlName);if(null===t){const t="ClientApi.XrmControlGrid._isEditable_get",e=p.a.getInstance().getEventParameters(this._contextToken);return e.push({name:"controlName",value:this.controlName}),e.push({name:"gridEntityName",value:this._gridEntityName}),b.a.getInstance().eventManager.ReportComponentFailure(t,new m.a("control configuration parameters not found"),null,e),this._isGridEditable}return t}set _isEditable(t){this._isGridEditable=t}get applicationContext(){return g.a.instance.reportUsage("ClientApi.XrmControlGrid.applicationContext_get"),this._applicationContext}set applicationContext(t){g.a.instance.reportUsage("ClientApi.XrmControlGrid.applicationContext_set")}getTotalRecordCount(){const t="ClientApi.XrmControlGrid.getTotalRecordCount";try{g.a.instance.reportCall(t);const e=Object(r.Y)(f.getState(),this._pageId,this._contextToken);if(e){const n=JSON.parse(e),r=n&&n.totalResultCount?n.totalResultCount:0;return g.a.instance.reportSuccess(t),r}return g.a.instance.reportSuccess(t),0}catch(e){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),p.a.getInstance().reportFailure(t,e,null,n),e}}getRows(){const t="ClientApi.XrmControlGrid.getRows";try{g.a.instance.reportCall(t);const e=new a.a(t),n=f.getState(),s=Object(r.H)(n,this.contextToken,{id:this.pageId});if(s)for(let t=0;t<s.length;t++){const n=s[t].identifier.id,r=this._getRowEntityName(s[t],n),a=new i.a(f,this._applicationContext,Object(o.f)(this.contextToken,n,r),this.pageId,r,n),c=s[t].identifier.id.guid;e.add(c,a)}return g.a.instance.reportSuccess(t),e}catch(e){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),p.a.getInstance().reportFailure(t,e,null,n),e}}getSelectedRows(){const t="ClientApi.XrmControlGrid.getSelectedRows";try{g.a.instance.reportCall(t);const e=new a.a(t),n=Object(r.fb)(f.getState(),this.pageId,this.contextToken);if(n){const t=Object(r.Q)(f.getState(),this.pageId,this.contextToken);for(let a=0;a<n.length;a++){let s;if(t)s=t;else{const t=f.getState(),e=Object(r.v)(t,this.pageId,this.contextToken),i=(e&&e.queryKey&&Object(l.q)(t,e.queryKey,null,null,!0)||[]).find(t=>t.identifier&&c.a.equals(t.identifier.id,n[a]));s=this._getRowEntityName(i,n[a])}const u=new i.a(f,this._applicationContext,Object(o.f)(this.contextToken,n[a],s),this.pageId,s,n[a]),d=n[a].guid;e.add(d,u)}}return g.a.instance.reportSuccess(t),e}catch(e){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),p.a.getInstance().reportFailure(t,e,null,n),e}}addOnRecordSelect(t){const e="ClientApi.XrmControlGrid.addOnRecordSelect";if(this._isEditable){t||Object(s.j)(e,"handler");try{g.a.instance.reportCall(e),f.dispatch(Object(h.m)(this.contextToken,this.pageId,t,this.controlName)),g.a.instance.reportSuccess(e)}catch(t){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),p.a.getInstance().reportFailure(e,t,null,n),t}}}removeOnRecordSelect(t){const e="ClientApi.XrmControlGrid.removeOnRecordSelect";if(this._isEditable){t||Object(s.j)(e,"handler");try{g.a.instance.reportCall(e),f.dispatch(Object(h.H)(this.contextToken,this.pageId,t,this.controlName)),g.a.instance.reportSuccess(e)}catch(t){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),p.a.getInstance().reportFailure(e,t,null,n),t}}}runOnRecordSelect(t){const e="ClientApi.XrmControlGrid.runOnRecordSelect";try{g.a.instance.reportCall(e),this._isEditable&&f.dispatch(Object(h.T)(this.contextToken,this.pageId,t,this.controlName)),g.a.instance.reportSuccess(e)}catch(t){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),p.a.getInstance().reportFailure(e,t,null,n),t}}_getRowEntityName(t,e){const n=t&&t.identifier?t.identifier.etn:this._gridEntityName;if("activitypointer"===n){const t="activitytypecode",n=Object(l.j)(f.getState(),new u.a(this._gridEntityName,e),t);if(Object(d.j)(n))return n.value}return n}get pageId(){return this._pageId}get contextToken(){return this._contextToken}}},B9jE:function(t,e,n){"use strict";n.d(e,"a",(function(){return F}));var r=n("P6DH"),a=n("Utin");var i=n("Uv1Y"),s=n("SAYH"),o=n("eXjw"),c=n("a72m"),l=n("KBcj"),u=n("d0w6"),d=n("dQnL"),p=n("WK+4"),h=n("CngE"),g=n("iZ7K"),m=n("69Qu"),b=n("BzGi"),f=n("BFlg"),y=n("s+OO"),v=n("7k+e");var _=n("LAGg"),S=n("RrRu"),O=n("jRHm"),C=n("uCpV"),I=n("X37l"),P=n("ujVH"),j=n("3/02"),T=n("Lyxw"),E=n("VcAV");function F(t,e,n,F,x,A){return{type:"grid.refresh.async",execute({dispatch:N,getState:k},D){const M=D.TraceManager.getTracer(f.z),R=f.x+".refreshGridAction";try{const L=k(),V=s.a.tryParseOrNull(F);if(V){const B=A||(n?u.a.SUB_GRID:u.a.MAIN_APPLICATION_VIEW);return function(t,e,n,a,d,p,h,g){const b=Object(r.qb)(e,g,n);if(b&&b.initialized===o.a.Initialized&&(Object(m.b)(e)||!Object(E.b)(b.offlineSqlQuery)))return Promise.resolve(g);const f=p||Object(r.F)(e,n,a,d),y=Object(l.f)(e,f,h),v=Object(l.f)(e,f,u.a.MAIN_APPLICATION_VIEW);let _=y&&y[s.a.toString(g)]&&y[s.a.toString(g)].isUserView?u.b.userview:u.b.savedview;v&&v[s.a.toString(g)]&&v[s.a.toString(g)].isUserView&&(_=u.b.userview);return t(Object(c.a)(f,h,_,g)).then(t=>{if(!t)throw new i.a("View retrieval failed");return t})}(N,L,t,e,n,x,B,V).then(i=>{M.info("Refreshing the grid with new view id - {0}"+V);const c=Object(r.T)(L,t,e);N(function(t,e,n,r){return Object(a.b)(t,e,"ViewId",n,r)}(t,n,F,e)),function(t,e,n,a,i,c,u,d,p){let h=function(t,e,n,a,i){return t||Object(r.F)(e,n,a,i)}(n,t,i,c,u);const g=Object(r.qb)(t,a,i);if(g&&g.initialized===o.a.Initialized){const n=Object(l.f)(t,h,d),r=n&&n[s.a.toString(a)]&&n[s.a.toString(a)].isUserView;if(h===f.a&&(h=g.entityLogicalName?g.entityLogicalName:h),!g.title){const t=[];t.push({name:"view.title",value:"View title doesn't contains value"}),t.push({name:"ViewId",value:"ViewId: "+a}),t.push({name:"View",value:w(g)}),t.push({name:"entityTypeName",value:h}),p.EventManager.ReportComponentFailure("RefreshGrid",new Error("Title for recent item is null or empty."),"Analyze event parameters to understand why title is empty.",t)}const i={RecordType:I.a.Grid,EntityTypeName:h,LastAccessed:new Date,ObjectId:a,IsUserView:r,Title:g.title};e(Object(C.b)(i))}}(k(),N,x,i,t,e,n,B,D);Object(T.c)(k(),j.L)&&N(Object(P.b)(t,e)),x&&N(function(t,e,n,r){return Object(a.b)(t,e,"TargetEntityType",n,r)}(t,n,x,e)),N(Object(_.b)(t,e)),N(Object(S.b)(t,e,[])),N(Object(O.b)(t,e,null));const E=[];if(x&&E.push({name:"entityName",value:x}),!Object(r.ib)(L,t,e))return D.EventManager.ReportComponentSuccess(R,E),Promise.resolve();N(function(t,e,n,a,i,o){return{type:"chart.refresh.async",execute({dispatch:c,getState:_},S){const O=f.x+".refreshChartAction",C=_();if(!n)return Promise.resolve();if(!Object(m.b)(C))return Promise.resolve();const I=Object(l.c)(C,n);if(!(i=I&&I.entityLogicalName?I.entityLogicalName:null))return Promise.resolve();if(o===u.a.QUICKFIND_SEARCH&&(c(Object(v.c)(t,e,[])),c(Object(y.c)(t,e,"{}"))),!s.a.equals(a,n)){c(Object(v.c)(t,e,[])),c(Object(y.c)(t,e,"{}"));const n=Object(r.r)(C,t,e,i),a=Object(h.a)(C,n),o=a&&a.PrimaryEntityTypeCode,l=o&&Object(g.m)(C,parseInt(o,10));if(l&&i!==l)return c(Object(d.a)(i,b.a.savedvisualization)).then(n=>{let r=s.a.toString(n);return r||(r=s.a.EMPTYGUIDSTRING),c(Object(p.b)(t,e,r)).then(()=>{S.EventManager.ReportComponentSuccess(O)})})}return S.EventManager.ReportComponentSuccess(O),Promise.resolve()}}}(t,e,V,c,x,A)).then(()=>(N(Object(_.b)(t,e)),D.EventManager.ReportComponentSuccess(R,E),Promise.resolve())).catch(t=>(D.EventManager.ReportComponentFailure(R,Error(t)),Promise.resolve()))})}if(Object(r.v)(k(),t,e)){M.info("Refreshing the grid."),N(Object(_.b)(t,e)),N(Object(S.b)(t,e,[])),N(Object(O.b)(t,e,null));const n=[];x&&n.push({name:"entityName",value:x}),D.EventManager.ReportComponentSuccess(R,n)}return Promise.resolve()}catch(t){let e="Refresh action for grid failed";t&&t.message&&(e+="with the error message as : "+t.message),D.EventManager.ReportComponentFailure(R,Error(e))}}}}function w(t){if(!t)return"View is "+t;const e={initialized:t.initialized,viewId:t.viewId,entityLogicalName:t.entityLogicalName,queryApi:t.queryApi,columnXML:t.columnXML,idColumName:t.idColumName,queryType:t.queryType,layoutXML:t.layoutXML,isUserView:t.isUserView,versionNumber:t.versionNumber,OverallVersionNumber:t.OverallVersionNumber,OverallUserVersionNumber:t.OverallUserVersionNumber};return JSON.stringify(e)}},BkgE:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return l}));var r=n("FZDd"),a=n("iZ7K"),i=n("BFlg"),s=n("F7qm"),o=n("LbMF");function c(t){return{type:"grid.retrieveRelatedEntityMetadata.async",execute({dispatch:e,getState:n},i){try{const s=Object(a.h)(n(),t),o={};return u(o,t),Object.keys(s.ManyToManyRelationships).forEach(e=>{const n=s.ManyToManyRelationships[e];if(n.IsValidForAdvancedFind){let e=n.Entity1LogicalName;e===t&&(e=n.Entity2LogicalName),u(o,e)}}),Object.keys(s.OneToManyRelationships).forEach(t=>{const e=s.OneToManyRelationships[t];e.IsValidForAdvancedFind&&u(o,e.ReferencingEntity,e.ReferencingAttribute)}),Object.keys(s.ManyToOneRelationships).forEach(t=>{const e=s.ManyToOneRelationships[t];e.IsValidForAdvancedFind&&(u(o,e.ReferencedEntity),u(o,e.ReferencingEntity,e.ReferencingAttribute))}),e(Object(r.e)(o)).catch(e=>h(t,i,e,"retrieveRelatedEntityMetadata.async","retrieveRelatedEntityMetadata"))}catch(e){return h(t,i,e,"retrieveRelatedEntityMetadata.async","retrieveRelatedEntityMetadata")}}}}function l(t){return{type:"grid.retrieveRelatedEntityRelationshipMetadata.async",execute({getState:e},n){try{let n=[];const r=e(),i=Object(a.h)(r,t),c=[];Object.keys(i.OneToManyRelationships).forEach(t=>{var e,n;const l=i.OneToManyRelationships[t];if(l.IsValidForAdvancedFind){const t=l.ReferencingEntity,i=Object(a.h)(r,t),u=Object(o.a)(r,t,l.ReferencingAttribute);if(i){const t=d(i,1===l.AssociatedMenuConfiguration.Behavior?null!==(e=l.AssociatedMenuConfiguration.Label)&&void 0!==e?e:"":null!==(n=null==u?void 0:u.DisplayName)&&void 0!==n?n:i.DisplayCollectionName),r=p(l,i.DisplayCollectionName,s.RelationshipType.OneToMany);c.push([t,r])}}}),Object.keys(i.ManyToManyRelationships).forEach(t=>{var e,n;const o=i.ManyToManyRelationships[t];if(o.IsValidForAdvancedFind){let t,l,u=!0,p=o.Entity1LogicalName,h=!0;if(p===i.EntityLogicalName?(p=o.Entity2LogicalName,o.IsCustomRelationship&&(u=2!==o.Entity2AssociatedMenuConfiguration.Behavior),l=o.Entity2AssociatedMenuConfiguration.Behavior,t=null!==(e=o.Entity2AssociatedMenuConfiguration.Label)&&void 0!==e?e:"",h=!1):(o.IsCustomRelationship&&(u=2!==o.Entity1AssociatedMenuConfiguration.Behavior),l=o.Entity1AssociatedMenuConfiguration.Behavior,t=null!==(n=o.Entity1AssociatedMenuConfiguration.Label)&&void 0!==n?n:""),u){const e=Object(a.h)(r,p);if(e){const n=d(e,1===l?t:e.DisplayCollectionName);let r;r=h?{displayName:e.DisplayCollectionName,referencedFieldName:i.PrimaryIdAttribute,referencingFieldName:e.PrimaryIdAttribute,relationshipType:s.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:o.IntersectEntityName,entityIntersectIdAttribute:o.Entity2IntersectAttribute,relatedEntityIntersectIdAttribute:o.Entity1IntersectAttribute}:{displayName:e.DisplayCollectionName,referencedFieldName:i.PrimaryIdAttribute,referencingFieldName:e.PrimaryIdAttribute,relationshipType:s.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:o.IntersectEntityName,entityIntersectIdAttribute:o.Entity1IntersectAttribute,relatedEntityIntersectIdAttribute:o.Entity2IntersectAttribute},c.push([n,r])}}if(o.Entity1LogicalName===o.Entity2LogicalName){const t=Object(a.h)(r,o.Entity2LogicalName);if(2!==o.Entity1AssociatedMenuConfiguration.Behavior){const e=d(t,1===o.Entity1AssociatedMenuConfiguration.Behavior?o.Entity1AssociatedMenuConfiguration.Label:t.DisplayCollectionName),n={displayName:t.DisplayCollectionName,referencedFieldName:i.PrimaryIdAttribute,referencingFieldName:t.PrimaryIdAttribute,relationshipType:s.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:o.IntersectEntityName,entityIntersectIdAttribute:o.Entity2IntersectAttribute,relatedEntityIntersectIdAttribute:o.Entity1IntersectAttribute};c.push([e,n])}}}}),Object.keys(i.ManyToOneRelationships).forEach(t=>{var e,n;const l=i.ManyToOneRelationships[t];if(l.IsValidForAdvancedFind){const t=l.ReferencedEntity,u=l.ReferencingAttribute,h=Object(a.h)(r,t),g=Object(o.a)(r,i.EntityLogicalName,u);if(h){const t=p(l,1===l.AssociatedMenuConfiguration.Behavior?null!==(e=l.AssociatedMenuConfiguration.Label)&&void 0!==e?e:"":null!==(n=null==g?void 0:g.DisplayName)&&void 0!==n?n:h.DisplayCollectionName,s.RelationshipType.ManyToOne);c.push([d(h,h.DisplayCollectionName),t])}}});return n=c.sort((t,e)=>{var n,r,a,i;if(!(null===(n=t[1])||void 0===n?void 0:n.displayName)||!(null===(r=e[1])||void 0===r?void 0:r.displayName))return 0;const s=t[1].displayName.localeCompare(e[1].displayName);return 0===s?(null===(a=t[0])||void 0===a?void 0:a.displayName)&&(null===(i=e[0])||void 0===i?void 0:i.displayName)?t[0].displayName.localeCompare(e[0].displayName):0:s}),Promise.resolve(n)}catch(e){return h(t,n,e,"retrieveRelatedEntityRelationshipMetadata.async","retrieveRelationshipMetadata")}}}}function u(t,e,n){t[e]||(t[e]=[]),n&&-1===t[e].indexOf(n)&&t[e].push(n)}function d(t,e){var n;return{metadataId:null===(n=t.Id)||void 0===n?void 0:n.guid,displayName:e,primaryIdField:t.PrimaryIdAttribute,primaryNameField:t.PrimaryNameAttribute,name:t.EntityLogicalName}}function p(t,e,n){return{displayName:e,referencingFieldName:t.ReferencingAttribute,isHierarchical:t.IsHierarchical,relationshipType:n,referencedFieldName:t.ReferencedAttribute}}function h(t,e,n,r,a){const s=[{name:i.k,value:t}];return e.EventManager.ReportComponentFailure(Object(i.G)(r,a),n,null,s),Promise.resolve(null)}},COKI:function(t,e,n){"use strict";n.d(e,"a",(function(){return w}));var r=n("i1f0"),a=n("pF61"),i=n("Sbn7"),s=n("ScMg"),o=n("ldWj"),c=n("TYIz"),l=n("16wZ"),u=n("1kth"),d=n("mhYf"),p=n("PbI6"),h=n("FHmp"),g=n("qshH"),m=n("ZIjf"),b=n("ABCl");let f;class y extends s.a{constructor(t,e,n,r,a,i){Object(l.g)(a,"ClientApi.XrmTab.constructor","parent"),Object(l.g)(t,"ClientApi.XrmTab.constructor","store"),super(t,e,r,n),f=t,this._parent=a,this._formContext=i,this._iConnectedTabProps={tabName:this.name,tabId:this._getTabId(),id:this.pageId,showTab:!0},this._clientApiExecutor=new b.b(f,"ClientApi.XrmTab.",e)}get sections(){const t="ClientApi.XrmTab.sections";try{if(m.a.instance.reportCall(t),!this._sections){this._sections=new i.a(t);const e=f.getState(),n=Object(r.Gc)(e,this.pageId,this.name,this.contextToken);for(let t=0;t<n.Columns.length;t++){const a=Object(r.p)(e,{id:this.pageId,tabName:n.Id,columnIndex:t},this.contextToken);let i=null;for(let t=0;t<a.SectionNames.length;t++)i=new o.a(f,this.contextToken,this.pageId,a.SectionNames[t],this,this._formContext),this._sections.add(i.getName(),i)}}return m.a.instance.reportSuccess(t),this._sections}catch(e){const n=g.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(t,e,null,n),e}}addTabStateChange(t){const e="ClientApi.XrmTab.addTabStateChange";Object(l.g)(t,e,"handler");try{m.a.instance.reportCall(e),f.dispatch(Object(u.s)(this.contextToken,this.pageId,this.name,t)),m.a.instance.reportSuccess(e)}catch(t){const n=g.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(e,t,null,n),t}}removeTabStateChange(t){const e="ClientApi.XrmTab.removeTabStateChange";Object(l.g)(t,e,"handler");try{m.a.instance.reportCall(e),f.dispatch(Object(u.N)(this.contextToken,this.pageId,this.name,t)),m.a.instance.reportSuccess(e)}catch(t){const n=g.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(e,t,null,n),t}}getDisplayState(){const t="ClientApi.XrmTab.getDisplayState";try{m.a.instance.reportCall(t);const e=Object(r.Dc)(f.getState(),this._getTabId(),this.pageId,this.contextToken)?"collapsed":"expanded";return m.a.instance.reportSuccess(t),e}catch(e){const n=g.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(t,e,null,n),e}}getParent(){return m.a.instance.reportUsage("ClientApi.XrmTab.getParent"),this._parent}setDisplayState(t){const e="ClientApi.XrmTab.setDisplayState";try{m.a.instance.reportCall(e);let n=!1;switch(t){case"collapsed":n=!0;break;case"expanded":n=!1;break;default:Object(l.h)(e,"TabDisplayState",t)}n||f.dispatch(Object(c.b)(this.pageId,this._getTabId(),this.contextToken)),m.a.instance.reportSuccess(e)}catch(t){const n=g.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(e,t,null,n),t}}setFocus(){try{m.a.instance.reportCall("ClientApi.XrmTab.setFocus"),f.dispatch(Object(c.b)(this.pageId,this._getTabId(),this.contextToken)),m.a.instance.reportSuccess("ClientApi.XrmTab.setFocus")}catch(t){const e=g.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure("ClientApi.XrmTab.setFocus",t,null,e),t}}setVisible(t){const e="ClientApi.XrmTab.setVisible";try{m.a.instance.reportCall(e),f.dispatch(Object(d.b)(this.pageId,this._getTabId(),this.contextToken,!0===t)),m.a.instance.reportSuccess(e)}catch(t){const n=g.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(e,t,null,n),t}}getLabel(){try{m.a.instance.reportCall("ClientApi.XrmTab.getLabel");const t=Object(r.Hc)(f.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken)||"";return m.a.instance.reportSuccess("ClientApi.XrmTab.getLabel"),t}catch(t){const e=g.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure("ClientApi.XrmTab.getLabel",t,null,e),t}}getVisible(){const t="ClientApi.XrmTab.getVisible";try{m.a.instance.reportCall(t);const e=Object(r.Kc)(f.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken);return m.a.instance.reportSuccess(t),e}catch(e){const n=g.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(t,e,null,n),e}}setLabel(t){const e="ClientApi.XrmTab.setLabel";Object(l.g)(t,e,"label");try{m.a.instance.reportCall(e),f.dispatch(Object(h.b)(this.pageId,this.contextToken,this._getTabId(),t)),m.a.instance.reportSuccess(e)}catch(t){const n=g.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(e,t,null,n),t}}_getTabId(){const t=f.getState(),e=Object(r.Gc)(t,this.pageId,this.name,this.contextToken);if(e&&e.Id)return e.Id}setContentType(t){return this._clientApiExecutor.execute("setContentType",()=>{let e;switch(t){case"default":case"cardSections":e="cardSections";break;case"expandAvailableSpace":case"singleComponent":e="singleComponent";break;default:Object(l.h)("setContentType","TabContentType",t)}f.dispatch(Object(p.b)(this.pageId,this._getTabId(),this.contextToken,e))},[{name:"tabContentType",value:t,isRequired:!0,expectedDataType:"string"}])}getContentType(){return this._clientApiExecutor.execute("getContentType",()=>{var t;return null===(t=Object(r.Jc)(f.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken))||void 0===t?void 0:t.contentType})}}var v=n("SAYH"),_=n("rQHy"),S=n("jRy5"),O=n("y60j"),C=n("arV0"),I=n("3yqi"),P=n("0nOn"),j=n("zmL5"),T=n("jq7Z"),E=n("IaGr");let F;class w{constructor(t,e,n,r,a,i,s){const o=Object(C.l)(t.getState(),n),c=[{name:"store",value:t,isRequired:!0},{name:"contextToken",value:e,isRequired:!0},{name:"pageId",value:n,isRequired:!0,isEventParam:!0},{name:"pageType",value:o,isEventParam:!0},{name:"formContext",value:r,isRequired:!0},{name:"entityName",value:a,isEventParam:!0},{name:"formSelectorType",value:s,isRequired:!0}];this._clientApiExecutor=new P.a(t,"ClientApi.XrmFormUIBase.",n,e,c),this._pageId=n,F=t,this._formContext=r,this._entityName=a,this._contextToken=e,this._formSelectorType=s,this.xrmControlFactory=i}get controls(){return this._clientApiExecutor.execute("controls_get",(t,e)=>{if(!this._controls){this._controls=new i.a(t);const n=function(t,e,n){const a=Object(T.b)(F.getState(),t,e),i=Object(j.b)(F.getState(),t),s=v.a.equals(a,i),o=Object(C.l)(F.getState(),t)===I.a.Dialog,c=Object(O.y)(F.getState(),a),l=c&&c.reduce((t,e)=>(t.add(e),t),new Set);return(a,i)=>{const c=Object(r.s)(F.getState(),{controlName:a,id:t},e),u=Object(r.Rc)(F.getState(),t,c);s&&u&&!o?l&&l.has(c.DataFieldName)&&Object(r.fd)(F.getState(),t,c,e)&&n.add(a,i):n.add(a,i)}}(this.pageId,this.contextToken,this._controls),a=this.getFormDescriptor(t,e);if(a){const r={isEventParam:!0,name:"controlName",value:""},i={isEventParam:!0,name:"controlType",value:""};e.push(r),e.push(i);for(const s in a.Controls){const o=a.Controls[s];r.value=s,i.value=o&&o.ClassId?o.ClassId.guid:"";const c=this.xrmControlFactory.createXrmControl(this.contextToken,o,this._formContext,t,e);c&&n(c.getName(),c)}}}return this._controls})}get formSelector(){return this._clientApiExecutor.execute("formSelector_get",(t,e)=>{if(!this._formSelector){const n=this.getFormDescriptor(t,e);n&&(this._formSelector=new this._formSelectorType(F,this._contextToken,n.Id,this._entityName,this._pageId))}return this._formSelector})}get tabs(){return this._clientApiExecutor.execute("tabs_get",(t,e)=>{if(!this._tabs){this._tabs=new i.a(t);const n=this.getFormDescriptor(t,e);if(n){const t=n.Tabs;for(const e in t){const n=new y(F,this._contextToken,t[e].Name,this._pageId,this,this._formContext);this._tabs.add(n.getName(),n)}}}return this._tabs})}get pageId(){return this._pageId}refreshRibbon(t=!1){this._clientApiExecutor.executeAsync("refreshRibbon",()=>F.dispatch(Object(_.a)(this._pageId,null,t)))}get contextToken(){return this._contextToken}get formContext(){return this._clientApiExecutor.execute("formContext",()=>this._formContext)}getControls(){if(!this._controls&&this.contextToken.contextTokenType===S.a.GridRow){const t=this._clientApiExecutor.getComponentName("getControls");return this._controls=new i.a(t),this._controls}return this.controls}getFormDescriptor(t,e){const n=Object(r.fb)(F.getState(),{id:this._pageId},this._contextToken);if(!n){const n="Form descriptor not found";if(Object(a.n)(F.getState(),this._pageId))E.a.getInstance().traceManager.getTracer(t).error(n+": Page is dead",e);else if(this.contextToken.contextTokenType===S.a.GridRow)E.a.getInstance().traceManager.getTracer(t).error(n,e);else{if(!this._clientApiExecutor.isPageReadyForClientAPIAccess())return null;const r=new Error(n);this._clientApiExecutor.reportFailure(t,r,e)}}return n}}},CbNq:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return o})),n.d(e,"d",(function(){return c}));var r=n("P6DH");function a(t){const e=Object(r.m)(t),n=t&&t.metadata?t.metadata.entities:null,a=[];return n?(e.forEach(t=>{if(4200!==n[t].ObjectTypeCode){const e=function(t){const e=t.DisplayName,n=t.ObjectTypeCode.toString();return{entityDisplayName:e,objectTypeCode:n}}(n[t]);a.push(e)}}),a.sort(i)):a}function i(t,e){const n=t.entityDisplayName,r=e.entityDisplayName;let a=0;return n>r?a=1:n<r&&(a=-1),a}function s(t){const e=[];for(let n=0;n<t.length;n++){const r={key:t[n].objectTypeCode,text:t[n].entityDisplayName};e.push(r)}return e}function o(t){return t?t.split(","):[]}function c(t){return t?t.map(t=>({key:t.value,text:t.text})):[]}},Co7m:function(t,e,n){"use strict";n.d(e,"a",(function(){return w}));var r=n("TAjd"),a=n("SAYH"),i=n("504W"),s=n("WPtp"),o=n("CPoS"),c=n("5Oca"),l=n("+nNZ"),u=n("odYE"),d=n("0PSL"),p=n("23K5"),h=n("bJaF"),g=n("KGWS"),m=n("ccIw"),b=n("arV0"),f=n("rodW"),y=n("eXjw"),v=n("k1f1"),_=n("AFlp"),S=n("c7jw"),O=n("53SR"),C=n("PUjk"),I=n("i1f0"),P=n("7LBy"),j=n("2Ct/"),T=n("iZ7K"),E=n("D4Jo"),F=n("JF0K");class w{static get Instance(){return w._instance||(w._instance=new w,Object(C.c)(w._instance)),w._instance}init(t,e,r){return this._getState&&this._businessProcessPerPageWrapper?Promise.resolve():(this._applicationContext=t,this._reloadDataCount=0,this._getState=e,this._dispatch=r,this._processManager=new h.a(t,e,r,new m.a,new g.a),this._businessProcessFlowWrapperIdentifierFactory=new p.a,this._businessProcessFlowWrapperFactory=new d.a(e,this._businessProcessFlowWrapperIdentifierFactory,t),n.e(48).then(n.bind(null,"esKF")).then(({BusinessProcessPageWrapper:t})=>(this._businessProcessPerPageWrapper=new t(this._applicationContext,this._getState,this._dispatch),Promise.resolve())))}getBusinessProcessFlowWrapper(t,e){return Object(j.f)(this._getState())?this._businessProcessPerPageWrapper.getBusinessProcessFlowWrapper(t,e):(this._reloadDataIfRequired(t,e),this._businessProcessFlowWrapperFactory.generate(t,this._processManager))}getProcessManager(t,e){return Object(j.f)(this._getState())?this._businessProcessPerPageWrapper.getProcessManager(t,e):(this._reloadDataIfRequired(t,e),this._processManager)}getCurrentProcessManagerWithoutInit(t){if(!Object(j.f)(this._getState()))return this._processManager;if(this._businessProcessPerPageWrapper)return this._businessProcessPerPageWrapper.getCurrentProcessManagerWithoutInit(t);const e=Object(b.g)(this._getState(),t),n=e&&e.entityTypeName?new u.a(e.entityTypeName,e.id):null,r=this._applicationContext.TraceManager.getTracer("BusinessProcessWrapperManager.GetProcessManagerWithoutinit"),a=Object(E.a)(this._getState(),n,t,this._applicationContext);return r.warn("BusinessProcessWrapperManager: BusinessProcessPerPageWrapper is not initialized",a),null}hasChanged(t,e,n,r){if(!Object(j.f)(this._getState())){if(Object(j.g)(t)&&(!Object(j.d)(t)||Object(j.c)(t,r)))return!0;if(!e)return!1;const a=new u.a(e.entityTypeName,e.id),s=Object(l.f)(t,a);return!Object(i.a)(s)&&(!n||s>n.instanceModifiedTimestamp)||this._needsDockedModeRefresh(n,e)}return this._businessProcessPerPageWrapper.hasChanged(t,e,n,r)}_needsDockedModeRefresh(t,e){return this._processManager.getDisplayState()===r.a.expanded&&t.isFormInactive!==Object(I.Lb)(this._getState(),e.entityTypeName,e.id)}_reloadData(t,e){const n=this._getState();this._pageId=t,this._pageInfo=e;const r=Object(b.g)(n,t);if(!r)return;const d=r.id,p=new u.a(r.entityTypeName,d);if(this._processIdInState=Object(c.e)(n,p),Object(j.g)(n)&&(!Object(j.d)(n)||Object(j.c)(n,t))){const e=this._processManager.getTelemetryParams();return this._processManager.isVisible()&&this._processManager.setVisible(!1),this._processManager.initilaizeWithFormEntityOnly(p,t),void Object(E.c)(F.e,e,this._applicationContext)}const h=Object(P.a)(r),g=Object(P.b)(r);if(a.a.equals(p.id,a.a.EMPTY)&&h&&g){const e=Object(o.b)(n,h),a=new u.a(e.businessProcessFlowUniqueName,g),s=Object(l.b)(n,a);return Object(i.a)(this._lastPageEntityFromCrossEntity)||Object(i.a)(p)||this._lastPageEntityFromCrossEntity.etn===p.etn||this._moveToNextStageForCrossEntityBPF(s,r),void this._processManager.initilaizeWithProcessAndFormEntity(s,e,p,h,a,t)}if(this._processIdInState){const e=Object(o.b)(n,this._processIdInState);if(!Object(i.a)(e)&&Object(y.b)(e.initialized)){const r=new u.a(e.businessProcessFlowUniqueName,Object(c.f)(n,p)),o=Object(l.b)(n,r);if(a.a.equals(p.id,a.a.EMPTY)){const n=Object(j.b)(e);if(this._lastPageIdInNewForm!==t&&(this._lastPageIdInNewForm=t,this._dispatch(Object(O.a)(null,r))),n&&n.stage&&n.stage.stageId){const a=Object(j.a)(n);return this._dispatch(Object(S.b)(r,a)),void this._processManager.initilaizeWithProcessAndFormEntity(a.fields,e,p,this._processIdInState,r,t)}}else if(Object(i.a)(o))return;const d=Object(T.h)(n,p.etn);if(d&&d.IsBPFEntity)return void this._processManager.initilaizeWithProcessAndFormEntity(o,e,p,this._processIdInState,r,t);for(const n in o)if(Object(s.k)(o[n])&&o[n].reference&&o[n].reference.id&&o[n].reference.etn===p.etn&&(a.a.equals(o[n].reference.id,p.id)||a.a.equals(o[n].reference.id,a.a.EMPTY))&&Object(j.e)(n))return void this._processManager.initilaizeWithProcessAndFormEntity(o,e,p,this._processIdInState,r,t);const h=this._dispatch(Object(v.b)(a.a.EMPTY,p)),g=this._dispatch(Object(_.b)(a.a.EMPTY,p));Promise.all([h,g]).then(e=>{this._processManager.initilaizeWithFormEntityOnly(p,t)})}else this._processManager.initilaizeWithFormEntityOnly(p,t)}else this._processManager.initilaizeWithFormEntityOnly(p,t)}_reloadDataIfRequired(t,e){const n=this._getState(),r=this._processManager.getCurrentFormEntity();this._lastPageEntityFromCrossEntity=r;let i=null,s=!1;if(r&&(i=Object(c.b)(r)(n,r.etn),i&&(s=i.refreshGlobalNavigationData)),!Object(j.g)(n)&&(!this._pageInfo||!a.a.equals(this._pageInfo.id,e.id)||this._pageId!==t||this._hasProcessChanged(e)||s)||Object(j.g)(n)&&this._processManager.getProcessId()){if(i&&i.refreshGlobalNavigationData&&this._dispatch(Object(f.b)(!1,r)),this._reloadDataCount<30)this._reloadData(t,e);else if(this._pageId!==t&&(this._reloadDataCount=0),30===this._reloadDataCount){const t=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ReachMaxBpfReloadDataCount"),e=this._processManager.getTelemetryParams();t.error("Max BPF reloadData count reached limit of 30. Root cause may be infinite loop when rendering the ProcessControl.",e)}this._reloadDataCount++}else this._reloadDataCount=0}_hasProcessChanged(t){const e=this._processIdInState||a.a.EMPTY,n=this._getState(),r=new u.a(t.entityTypeName,t.id),i=Object(b.g)(n,this._pageId),s=Object(P.a)(i),l=a.a.equals(r.id,a.a.EMPTY)&&s?s:Object(c.e)(n,r)||a.a.EMPTY;if(!a.a.equals(l,e))return!0;if(a.a.equals(l,a.a.EMPTY))return!1;const d=Object(o.b)(n,l);return!!d&&this._processManager.getVersion()<d.businessProcessFlowProcessVersion}_moveToNextStageForCrossEntityBPF(t,e){const n=t.activestageid,r=t.traversedpath;let i=e.data.nextStageId;if(!i){const t=Object(P.a)(e),n=Object(P.b)(e);if(!a.a.equals(t,this._processManager.getProcessId())||!a.a.equals(n,this._processManager.getProcessInstanceId()))return;i=this._processManager.getStageMetadata().getNextStageId(this._processManager.getActiveStageId())}if(!a.a.equals(n.reference.id,new a.a(i))){n.reference=new u.a("processstage",new a.a(i)),r.value=r.value+","+i;t.activestagestartedon.value=new Date}}}},D4Jo:function(t,e,n){"use strict";n.d(e,"a",(function(){return p})),n.d(e,"c",(function(){return h})),n.d(e,"b",(function(){return g}));var r=n("VcAV"),a=n("Uv1Y"),i=n("bT7G"),s=n("JF0K"),o=n("SAYH"),c=n("5Oca"),l=n("+nNZ"),u=n("arV0"),d=n("504W");function p(t,e,n,r){const a=[];try{const r=e&&Object(c.e)(t,e)?Object(c.e)(t,e):o.a.EMPTY,i=e&&Object(c.f)(t,e)?Object(c.f)(t,e):o.a.EMPTY,s=r&&!o.a.equals(r,o.a.EMPTY)?function(t,e){const n=Object(l.a)(t,e);if(n)return n.businessProcessFlowProcessState;return null}(t,r):0,d=Object(u.l)(t,n),p={name:"ProcessId",value:r?o.a.toString(r):o.a.EMPTYGUIDSTRING},h={name:"ProcessInstanceId",value:i?o.a.toString(i):o.a.EMPTYGUIDSTRING},g={name:"CurrentFormEntityType",value:e&&e.etn?e.etn:""},m={name:"CurrentFormEntityId",value:e&&e.id?o.a.toString(e.id):""},b={name:"ProcessState",value:s},f={name:"PageId",value:n||""},y={name:"PageType",value:d};a.push(p),a.push(h),a.push(g),a.push(m),a.push(b),a.push(f),a.push(y)}catch(t){r.TraceManager.getTracer("BusinessProcessFlow.TelemetryGeneration").error("Exception while generating businessprocess telemetry parameters: "+t.message,a)}return a}function h(t,e,n){n.EventManager.ReportComponentSuccess(t,e)}function g(t,e,n,o,c,l,u){!function(t,e){if(!Object(r.c)(t)){const n=Object(a.c)(t);if(!Object(r.c)(n)){const t=n.errorCode;if(!Object(r.c)(t)){const n={name:"ErrorCode",value:"0x"+t.toString(16)};e.push(n)}}}}(e,o),function(t,e,n,o){if(!Object(r.c)(t)){const c=Object(a.c)(t);if(!Object(r.c)(c)&&!Object(r.c)(c.FaultedSnapshotId)){const t={name:s.p,value:c.FaultedSnapshotId};if(e.push(t),!Object(r.c)(n)&&!Object(r.c)(o)){const t=Object(i.c)(o,n);if(!Object(r.c)(t)){const n=t.snapshotId;if(!Object(r.c)(n)&&!Object(d.b)(n)&&n===c.FaultedSnapshotId){const t={name:s.q,value:"serverSideCurrentForm"};e.push(t)}}}}}}(e,o,l,u),c.EventManager.ReportComponentFailure(t,e,n,o)}},DAWX:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{get_ErrorType(){return this._errorType}set_ErrorType(t){this._errorType=t}get_ErrorDescription(){return this._errorDescription}set_ErrorDescription(t){this._errorDescription=t}}},DU8S:function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"e",(function(){return c})),n.d(e,"b",(function(){return l})),n.d(e,"a",(function(){return u})),n.d(e,"d",(function(){return d}));var r=n("9A3e"),a=n("VDDv"),i=n("VkXQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="customcontrol.propertybag.device.isoperationavailable";function o(){return{type:s,execute:(t,e)=>new r.a(e,t).isOperationAvailable(i.b.getBarcodeValue.name),sync:!0}}function c(){return{type:s,execute:(t,e)=>new a.a(e,t).isOperationAvailable(i.f.takePicture.name),sync:!0}}function l(){return{type:s,execute:(t,e)=>new a.a(e,t).isOperationAvailable(i.f.captureVideo.name),sync:!0}}function u(){return{type:s,execute:(t,e)=>new a.a(e,t).isOperationAvailable(i.f.captureAudio.name),sync:!0}}function d(){return{type:s,execute:()=>!1,sync:!0}}},E6o7:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return o}));var r=n("dHD5"),a=n("jAuy"),i=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="dataset.update.fetchxml";function o(t,e,n){return{type:"dataset.update.fetchxml.async",execute({dispatch:o,getState:c},l){const u=l.TraceManager.getTracer(i.z),d=i.x+".updateFetchXMLAction";try{u.info("Updating the fetch xml for the grid."),o(function(t,e,n){const a=Object(r.y)(e),i=Object(r.v)(e);return{type:s,payload:n,meta:{pageId:t,contextKey:a,dataSetContextKey:i}}}(t,e,n));const i=Object(a.j)(n),c=[];return c.push({name:"fetchXML",value:i}),l.EventManager.ReportComponentSuccess(d,c),Promise.resolve()}catch(t){const n="Updating the fetchxml for the grid with contextKey : "+Object(r.v)(e)+" failed with the error : "+t.message;l.EventManager.ReportComponentFailure(d,Error(n))}}}}},EOIL:function(t,e,n){"use strict";n.d(e,"a",(function(){return tt}));var r=n("0nOn"),a=n("i1f0"),i=n("ZIjf"),s=n("Sbn7"),o=n("Bj/n"),c=n("jTSi"),l=n("9NSo"),u=n("SAYH"),d=n("uOtn"),p=n("+zjj"),h=n("N+Ya"),g=n("dIqG"),m=n("16wZ"),b=n("qshH"),f=n("meVR"),y=n("TYIz"),v=n("dHD5");var _=n("IqkD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let S;class O{constructor(t,e,n,r){const a="ClientApi.XrmNavigationItem.constructor";t||Object(m.j)(a,"store"),n||Object(m.j)(a,"pageId"),e||Object(m.j)(a,"contextToken"),Object(m.a)(r)&&Object(m.j)(a,"id"),S=t,this._pageId=n,this._id=r,this._contextToken=e}getId(){return i.a.instance.reportUsage("ClientApi.XrmNavigationItem.getId"),this._id}getLabel(){const t="ClientApi.XrmNavigationItem.getLabel";try{i.a.instance.reportCall(t);const e=Object(a.Rb)(S.getState(),this._pageId,this._id);return i.a.instance.reportSuccess(t),e}catch(e){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}}getVisible(){const t="ClientApi.XrmNavigationItem.getVisible";try{i.a.instance.reportCall(t);const e=Object(a.Ub)(S.getState(),this._pageId,this._id);return i.a.instance.reportSuccess(t),e}catch(e){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}}setFocus(){const t="ClientApi.XrmNavigationItem.setFocus";try{i.a.instance.reportCall(t),S.dispatch((e=this._pageId,n=this._contextToken,r=this._id,{type:"forms.selectnavigationtab",sync:!0,execute({dispatch:t,getState:a},i,s){const o=Object(p.d)(a(),e,r);if(o){o.isSelected=!0;const r=Object(v.a)(n,o.relationshipName,o.ordinal);t(Object(y.b)(e,void 0,n)),t(Object(f.a)(e,r,o))}else i.TraceManager.getTracer("Forms.SelectNavigationTab").error("Could not find relatedEntityInfo to select")}})),i.a.instance.reportSuccess(t)}catch(e){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}var e,n,r}setLabel(t){const e="ClientApi.XrmNavigationItem.setLabel";try{if(i.a.instance.reportCall(e),!Object(m.a)(t)){const e=Object(_.s)(S.getState());S.dispatch(Object(h.b)(this._pageId,this._id,t,e))}i.a.instance.reportSuccess(e)}catch(t){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}}setVisible(t){const e="ClientApi.XrmNavigationItem.setVisible";try{i.a.instance.reportCall(e),S.dispatch(Object(g.b)(this._pageId,this._id,!0===t)),i.a.instance.reportSuccess(e)}catch(t){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let C;class I{constructor(t,e,n){n||Object(m.j)("ClientApi.XrmFormNavigation.constructor","pageId"),t||Object(m.j)("ClientApi.XrmFormNavigation.constructor","store"),C=t,this._pageId=n,this._contextToken=e}get items(){const t="ClientApi.XrmFormNavigation.items";try{if(i.a.instance.reportCall(t),!this._items){this._items=new s.a(t);const e=Object(p.f)()(C.getState(),{id:this._pageId});e&&e.forEach(t=>{t&&t.relatedItems&&t.relatedItems.forEach(t=>{t&&t.id&&this._items.add(t.id,new O(C,this._contextToken,this._pageId,t.id))})})}return i.a.instance.reportSuccess(t),this._items}catch(e){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}}}var P=n("ldWj"),j=n("PidC"),T=n("4U8P"),E=n("NtHU"),F=n("FhIR"),w=n("ABCl");let x;class A extends P.a{constructor(t,e,n,r){super(t,e,n,A.NAME,null,r),x=t,this._clientApiExecutor=new w.b(x,"ClientApi.XrmHeaderSection.",e)}getLabel(){return i.a.instance.reportUsage("ClientApi.XrmHeaderSection.getLabel"),""}getVisible(){return i.a.instance.reportUsage("ClientApi.XrmHeaderSection.getVisible"),!0}setLabel(t){i.a.instance.reportUsage("ClientApi.XrmHeaderSection.setLabel")}setVisible(t){i.a.instance.reportUsage("ClientApi.XrmHeaderSection.setVisible")}getControlsDescriptor(t){const e=Object(a.tb)(t,{id:this.pageId},this.contextToken),n={};if(e)for(let t=0;t<e.length;t++){const r=e[t];n[r.Name]=r}return n}setCommandBarVisible(t){this._clientApiExecutor.execute("setCommandBarVisible",()=>{x.dispatch(Object(T.b)(this.pageId,this.contextToken,t))},[{name:"visible",value:t,isRequired:!0,expectedDataType:"boolean"}])}getCommandBarVisible(){return this._clientApiExecutor.execute("getCommandBarVisible",()=>{var t;return null===(t=Object(j.f)(x.getState(),this.pageId,this.contextToken))||void 0===t?void 0:t.commandBarVisible})}setBodyVisible(t){this._clientApiExecutor.execute("setBodyVisible",()=>{x.dispatch(Object(E.b)(this.pageId,this.contextToken,t))},[{name:"visible",value:t,isRequired:!0,expectedDataType:"boolean"}])}getBodyVisible(){return this._clientApiExecutor.execute("getCommandBarVisible",()=>{var t;return null===(t=Object(j.f)(x.getState(),this.pageId,this.contextToken))||void 0===t?void 0:t.bodyVisible})}setTabNavigatorVisible(t){this._clientApiExecutor.execute("setTabNavigatorVisible",()=>{x.dispatch(Object(F.b)(this.pageId,this.contextToken,t))},[{name:"visible",value:t,isRequired:!0,expectedDataType:"boolean"}])}getTabNavigatorVisible(){return this._clientApiExecutor.execute("getTabNavigatorVisible",()=>{var t;return null===(t=Object(j.f)(x.getState(),this.pageId,this.contextToken))||void 0===t?void 0:t.tabNavigatorVisible})}}A.NAME="Header";var N=n("5iTp"),k=n("m+2h");let D;class M extends P.a{constructor(t,e,n,r){super(t,e,n,M.NAME,null,r),D=t,this._clientApiExecutor=new w.b(D,"ClientApi.XrmFooterSection.",e)}getLabel(){return i.a.instance.reportUsage("ClientApi.XrmFooterSection.getLabel"),""}getVisible(){return this._clientApiExecutor.execute("getVisible",()=>{var t;return null===(t=Object(N.a)(D.getState(),this.pageId,this.contextToken))||void 0===t?void 0:t.visible})}setLabel(t){i.a.instance.reportUsage("ClientApi.XrmFooterSection.setLabel")}setVisible(t){this._clientApiExecutor.execute("setVisible",()=>{D.dispatch(Object(k.b)(this.pageId,this.contextToken,t))},[{name:"visible",value:t,isRequired:!0,expectedDataType:"boolean"}])}getControlsDescriptor(t){const e=Object(a.Z)(t,{id:this.pageId},this.contextToken),n={};if(e)for(let t=0;t<e.length;t++){const r=e[t];n[r.Name]=r}return n}}M.NAME="Footer";var R=n("gQ5I"),L=n("arV0"),V=n("PUjk"),B=n("r/aD"),G=n("bpBl"),X=n("IaGr");let U;class q{constructor(t,e,n,r){const a="ClientApi.XrmProcessControlUI.constructor";r||Object(m.j)(a,"entity"),e||Object(m.j)(a,"contextToken"),n||Object(m.j)(a,"pageId"),t||Object(m.j)(a,"store"),U=t,this._pageId=n;let i=!1;if(Object(B.d)(U.getState(),this._pageId,a)){const t=Object(L.g)(U.getState(),this._pageId);this._processManager=Object(V.b)(this._pageId,t),i=!0}this._contextToken=e;const s=Object(B.b)(n,t.getState(),i);X.a.getInstance().eventManager.ReportComponentSuccess(a,s)}getDisplayState(){const t="ClientApi.XrmProcessControlUI.getDisplayState";try{if(i.a.instance.reportCall(t),!Object(B.d)(U.getState(),this._pageId,t))return i.a.instance.reportSuccess(t),null;const e=this._getProcessManager().getDisplayState();return i.a.instance.reportSuccess(t),e}catch(e){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}}getVisible(){const t="ClientApi.XrmProcessControlUI.getVisible";try{if(i.a.instance.reportCall(t),!Object(B.d)(U.getState(),this._pageId,t))return i.a.instance.reportSuccess(t),!1;const e=this._getProcessManager().isVisible();return i.a.instance.reportSuccess(t),e}catch(e){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}}setDisplayState(t){const e="ClientApi.XrmProcessControlUI.setDisplayState";try{if(i.a.instance.reportCall(e),!Object(B.d)(U.getState(),this._pageId,e))return void i.a.instance.reportSuccess(e);t!==G.a.collapsed&&t!==G.a.expanded&&t!==G.a.floating||this._getProcessManager().setDisplayState(t),i.a.instance.reportSuccess(e)}catch(t){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}}setVisible(t){const e="ClientApi.XrmProcessControlUI.setVisible";try{if(i.a.instance.reportCall(e),!Object(B.d)(U.getState(),this._pageId,e))return void i.a.instance.reportSuccess(e);this._getProcessManager().setVisible(t),i.a.instance.reportSuccess(e)}catch(t){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}}reflow(t,e,n){const r="ClientApi.XrmProcessControlUI.reflow";try{if(i.a.instance.reportCall(r),!Object(B.d)(U.getState(),this._pageId,r))return void i.a.instance.reportSuccess(r);this._getProcessManager().reflow(t,e,n),i.a.instance.reportSuccess(r)}catch(t){const e=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(r,t,null,e),t}}_getProcessManager(){return this._processManager||(this._processManager=Object(B.c)(this._processManager,U,this._pageId,"ClientApi.XrmProcessControlUI.getProcessManager")),this._processManager}}var z=n("1kth"),H=n("uNLT"),W=n("bT7G"),Y=n("Dea/"),K=n("Fij2"),Q=n("pF61"),J=n("COKI"),Z=n("zJiL");let $;class tt extends J.a{constructor(t,e,n,a,i,s){$=t,super(t,e,n,a,i,s,d.a),this._clientApiExecutorFormUI=new r.a(t,"ClientApi.XrmFormUI.",n,e),this._clientApiExecutorFormUI.addEventParameter({name:"entityName",value:i,isEventParam:!0})}get headerSection(){const t="ClientApi.XrmFormUI.headerSection";try{return i.a.instance.reportCall(t),this._headerSection||(this._headerSection=new A($,this.contextToken,this.pageId,this.formContext)),i.a.instance.reportSuccess(t),this._headerSection}catch(e){throw this._reportFailure(t,e)}}get footerSection(){const t="ClientApi.XrmFormUI.footerSection";try{return i.a.instance.reportCall(t),this._footerSection||(this._footerSection=new M($,this.contextToken,this.pageId,this.formContext)),i.a.instance.reportSuccess(t),this._footerSection}catch(e){throw this._reportFailure(t,e)}}addControls(t){const e=b.a.getInstance().getEventParameters(this.contextToken),n={name:"controlName",value:""};e.push(n);for(const r in t)if(t[r]){n.value=r;const a=this.xrmControlFactory.createXrmControl(this.contextToken,t[r],this.formContext,"ClientApi.XrmFormUI.addControls",e);a&&this.controls.add(a.getName(),a)}}get navigation(){const t="ClientApi.XrmFormUI.navigation";try{return i.a.instance.reportCall(t),this._navigation||(this._navigation=new I($,this.contextToken,this.pageId)),i.a.instance.reportSuccess(t),this._navigation}catch(e){throw this._reportFailure(t,e)}}get process(){const t="ClientApi.XrmFormUI.process_get";try{i.a.instance.reportCall(t);const e=!!this._process;!this._process&&this.formContext.data&&this.formContext.data.entity&&(this._process=new q($,this.contextToken,this.pageId,this.formContext.data.entity));const n=Object(B.a)(this.pageId,$.getState(),e,!(!this.formContext.data||!this.formContext.data.entity));return X.a.getInstance().eventManager.ReportComponentSuccess(t,n),i.a.instance.reportSuccess(t),this._process}catch(e){throw this._reportFailure(t,e)}}set process(t){const e=Object(B.a)(this.pageId,$.getState(),!!this._process,!(!this.formContext.data||!this.formContext.data.entity));X.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmFormUI.process_set",e),this._process=t}get quickForms(){const t="ClientApi.XrmFormUI.quickForms";try{return i.a.instance.reportCall(t),this._quickForms||(this._quickForms=new s.a(t),this.controls),i.a.instance.reportSuccess(t),this._quickForms}catch(e){throw this._reportFailure(t,e)}}clearFormNotification(t){const e="ClientApi.XrmFormUI.clearFormNotification";try{i.a.instance.reportCall(e);const n=$.dispatch(Object(c.b)(this.contextToken,this.pageId,t));return i.a.instance.reportSuccess(e),n}catch(t){throw this._reportFailure(e,t)}}close(){try{i.a.instance.reportCall("ClientApi.XrmFormUI.close"),Object(K.a)(Object(Q.b)($.getState())===this.pageId)||$.dispatch(Object(R.e)(this.pageId)),i.a.instance.reportSuccess("ClientApi.XrmFormUI.close")}catch(t){throw this._reportFailure("ClientApi.XrmFormUI.close",t)}}getFormType(){return this._clientApiExecutorFormUI.execute("getFormType",(t,e)=>{const n=this.getFormDescriptor(t,e);if(n){const r=this.formContext;if(r&&r.data&&r.data.entity&&Object(a.Lb)($.getState(),r.data.entity.getEntityName(),u.a.tryParse(r.data.entity.getId())))return 4;if(Object(a.kb)($.getState(),{id:this.pageId},this.contextToken))return 3;if(6===n.FormType)return 3;const i=Object(a.ac)($.getState(),this.pageId,this.contextToken);if(i){const n=Object(W.b)($.getState(),i);return n?n.mode===Y.a.Create?1:2:(e.push({name:"snapshotID",value:i}),this._clientApiExecutorFormUI.reportFailure(t+".getSnapshot",new Error("Snapshot is null or undefined"),e),0)}return r&&r.data&&r.data.entity&&!u.a.tryParseOrNull(r.data.entity.getId())?1:2}return 0})}isDialog(){return this._clientApiExecutorFormUI.execute("isDialog",()=>Object(L.f)($.getState(),this.pageId))}getViewPortHeight(){const t="ClientApi.XrmFormUI.getViewPortHeight";try{i.a.instance.reportCall(t);const e=Object(a.qb)($.getState(),{id:this.pageId},this.contextToken);return i.a.instance.reportSuccess(t),e}catch(e){throw this._reportFailure(t,e)}}getViewPortWidth(){const t="ClientApi.XrmFormUI.getViewPortWidth";try{i.a.instance.reportCall(t);const e=Object(a.rb)($.getState(),{id:this.pageId},this.contextToken);return i.a.instance.reportSuccess(t),e}catch(e){throw this._reportFailure(t,e)}}setFormEntityName(t){const e="ClientApi.XrmFormUI.setFormEntityName";Object(m.g)(t,e,"name");try{i.a.instance.reportCall(e),$.dispatch(Object(l.b)(this.pageId,this.contextToken,t)),i.a.instance.reportSuccess(e)}catch(t){throw this._reportFailure(e,t)}}setFormNotification(t,e,n,r,a){return this._clientApiExecutorFormUI.execute("setFormNotification",(i,s)=>{let c;switch(Object(m.a)(n)&&(n="Random_String_"+Math.random()),e){case"ERROR":c=Z.a;break;case"WARNING":c=Z.e;break;case"INFORMATION":case"INFO":c=Z.b;break;default:Object(m.h)(i,"notificationLevel",e,s)}return!Object(m.a)(t)&&"string"==typeof t&&($.dispatch(Object(o.c)(this.contextToken,this.pageId,t,c,n,r,a)),!0)})}addOnLoad(t){const e="ClientApi.XrmFormUI.addOnLoad";Object(m.g)(t,e,"handler");try{i.a.instance.reportCall(e),$.dispatch(Object(z.f)(this.contextToken,this.pageId,t)),i.a.instance.reportSuccess(e)}catch(t){throw this._reportFailure(e,t)}}removeOnLoad(t){const e="ClientApi.XrmFormUI.removeOnLoad";Object(m.g)(t,e,"handler");try{i.a.instance.reportCall(e),$.dispatch(Object(z.A)(this.contextToken,this.pageId,t)),i.a.instance.reportSuccess(e)}catch(t){throw this._reportFailure(e,t)}}refresh(){const t="ClientApi.XrmFormUI.refresh";try{i.a.instance.reportCall(t);const e=Object(L.l)($.getState(),this.pageId);return $.dispatch(Object(H.f)(this.pageId,e,!0,1,!0,!0)).then(e=>(Object(K.b)(this.formContext.data.entity),i.a.instance.reportSuccess(t),e)).catch(e=>{const n=b.a.getInstance().getEventParameters(this.contextToken);return Object(m.d)($,e,t+".saveFormAndNavigate",n)})}catch(e){const n=b.a.getInstance().getEventParameters(this.contextToken);return Object(m.d)($,e,t,n)}}_reportFailure(t,e){const n=b.a.getInstance().getEventParameters(this.contextToken);return b.a.getInstance().reportFailure(t,e,null,n),e}}},FHmp:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="tab.setlabel";function i(t,e,n,i){const s=Object(r.v)(e);return{type:a,payload:i,meta:{pageId:t,contextKey:s,tabId:n}}}},FhIR:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="header.tabnavigatorvisible";function i(t,e,n){const i=Object(r.v)(e);return{type:a,payload:n,meta:{pageId:t,contextKey:i}}}},G0J3:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n("ghNp"),a=n("i1f0"),i=n("0nOn");let s;class o{constructor(t,e,n,a,o,c){this._clientApiExecutor=new i.a(t,"ClientApi.XrmFormBase.",a,n,[{name:"store",value:t,isRequired:!0},{name:"entityName",value:this._entityName,isEventParam:!0},{name:"pageId",value:a,isRequired:!0,isEventParam:!0},{name:"contextToken",value:n,isRequired:!0},{name:"getUiType",value:o,isRequired:!0}]),s=t,this.pageId=a,this.contextToken=n,this._entityName=e,this._getUiType=o,this._xrmControlFactory=c,s.dispatch(Object(r.a)(this,a,n))}get ui(){return this._clientApiExecutor.execute("ui_get",()=>{if(!this._ui){const t={id:this.pageId},e=Object(a.fb)(s.getState(),t,this.contextToken),n=e&&e.FormType,r=this._getUiType(n);this._ui=new r(s,this.contextToken,this.pageId,this,this._entityName,this._xrmControlFactory)}return this._ui})}getControl(t){const e=[{name:"entityName",value:this._entityName,isRequired:!1,isEventParam:!0}];return this._clientApiExecutor.execute("getControl",()=>this.ui.controls.get(t),e)}}},GodX:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("2YQW"),a=n("jsFU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i=Object(r.d)({[a.a]:function(t,e){return Object.assign({},e.payload.formlessControlOutputs)}},{})},GxhD:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));class r{constructor(t,e){this._etn=null,this._attributeName=null,this._etn=t,this._attributeName=e}get etn(){return this._etn}set etn(t){this._etn=t}get attributeName(){return this._attributeName}set attributeName(t){this._attributeName=t}}},HAeo:function(t,e,n){"use strict";n.d(e,"a",(function(){return w})),n.d(e,"b",(function(){return x}));var r=n("0nOn"),a=n("arV0"),i=n("3yqi"),s=n("AbXy"),o=n("SAYH"),c=n("B9jE"),l=n("16wZ"),u=n("P6DH"),d=n("qshH"),p=n("i1f0"),h=n("Uv1Y"),g=n("dHD5"),m=n("ZIjf"),b=n("IaGr");let f;class y{constructor(t,e,n,a,i){this._pageId=n,f=t,this._contextToken=e,this._controlName=a,this._gridType=i,this._clientApiExecutor=new r.a(t,"ClientApi.XrmViewSelector.",n,e,[{name:"controlName",value:a,isEventParam:!0},{name:"gridType",value:i,isEventParam:!0,isRequired:!0},{name:"contextToken",value:e,isRequired:!0},{name:"store",value:t,isRequired:!0}])}setCurrentView(t){this._clientApiExecutor.executeAsync("setCurrentView",(e,n)=>t&&t.id?f.dispatch(Object(c.a)(this._pageId,this._contextToken,this._controlName,t.id)):(n.push({name:"validationError",value:"true"}),b.a.getInstance().traceManager.getTracer(e).error("View ID is required",n),Promise.resolve()))}getCurrentView(){const t="ClientApi.XrmViewSelector.getCurrentView";try{m.a.instance.reportCall(t);const e=Object(u.hb)(f.getState(),this._pageId,this._contextToken,this._controlName);let n=null,r=null;if(e)r=e.ViewId;else if(3===this._gridType){const e={id:this._pageId},n=Object(p.fb)(f.getState(),e,this._contextToken.parentContextToken),a="ViewId";if(!(n&&n.Controls&&n.Controls[this._controlName]&&n.Controls[this._controlName].Parameters&&n.Controls[this._controlName].Parameters[a])){let e;n?n.Controls?n.Controls[this._controlName]?n.Controls[this._controlName].Parameters?n.Controls[this._controlName].Parameters[a]||(e="formDescriptor.Controls[this._controlName].Parameters[propertyViewId] is null or undefined"):e="formDescriptor.Controls[this._controlName].Parameters is null or undefined":e="formDescriptor.Controls[this._controlName] is null or undefined":e="formDescriptor.Controls is null or undefined":e="formDescriptor is null or undefined";const r=d.a.getInstance().getEventParameters(this._contextToken);return r.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,new h.a(e),null,r),null}r=n.Controls[this._controlName].Parameters[a]}if(r){if(n=Object(u.qb)(f.getState(),o.a.parse(r),this._pageId),n){const e={entityType:Object(u.ob)(f.getState(),r,this._pageId),id:o.a.externalGuid(n.viewId),name:n.title};return m.a.instance.reportSuccess(t),e}const e=[];return e.push({name:"controlName",value:this._controlName}),e.push({name:"contextKey",value:Object(g.v)(this._contextToken)}),d.a.getInstance().reportFailure(t,new Error("ViewDescriptor is coming as null"),null,e),null}const a=[];return a.push({name:"controlName",value:this._controlName}),a.push({name:"contextKey",value:Object(g.v)(this._contextToken)}),d.a.getInstance().reportFailure(t,new Error("viewId is coming as null or undefined"),null,a),null}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,e,null,n),e}}isVisible(){const t="ClientApi.XrmViewSelector.isVisible";try{if(m.a.instance.reportCall(t),Object(l.a)(this._isVisible)){const e=Object(u.hb)(f.getState(),this._pageId,this._contextToken,this._controlName);if(e)this._isVisible=e.EnableViewPicker;else{const e={id:this._pageId},n=Object(p.fb)(f.getState(),e,this._contextToken.parentContextToken),r="EnableViewPicker";if(!(n&&n.Controls&&n.Controls[this._controlName]&&n.Controls[this._controlName].Parameters&&n.Controls[this._controlName].Parameters[r])){const e=d.a.getInstance().getEventParameters(this._contextToken);return e.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,new h.a("FormDescriptor is null"),null,e),!1}this._isVisible=n.Controls[this._controlName].Parameters[r]}}return m.a.instance.reportSuccess(t),this._isVisible}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,e,null,n),e}}}var v=n("ghNp"),_=n("OQLa"),S=n("rQHy"),O=n("iOrn"),C=n("iZ7K"),I=n("d0w6"),P=n("deGN"),j=n("Lyxw"),T=n("3/02"),E=n("whN/");let F;class w{constructor(t,e,n,a,i,s,o,c){this._relationship=null;const u="ClientApi.XrmGridControl.constructor";t||Object(l.j)(u,"store"),e||Object(l.j)(u,"contextToken"),n||Object(l.j)(u,"pageId"),F=t,this._pageId=n,this._contextToken=e,this._controlName=c,this._isEditable=a,this._gridType=i,this._applicationContext=o,s||F.dispatch(Object(v.a)(this,n,e)),this._clientApiExecutor=new r.a(t,"ClientApi.XrmGridControl.",n,e),this._clientApiExecutor.addEventParameter({name:"controlName",value:c,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"isEditable",value:a,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"isCallFromSubgrid",value:s,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"gridType",value:i,isEventParam:!0})}get _connectedControlProps(){return{controlName:this._controlName,id:this._pageId}}setFilterXml(t){this._clientApiExecutor.executeAsync("setFilterXml",()=>{const e=(new Date).getTime();return F.dispatch(Object(O.b)(t,1,this._pageId,this._contextToken,e))})}getFilterXml(){const t="ClientApi.XrmGridControl.getFilterXml";try{m.a.instance.reportCall(t);const e=Object(u.u)(F.getState(),this._pageId,this._contextToken);return m.a.instance.reportSuccess(t),e}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,e,null,n),e}}getFetchXml(){const t="ClientApi.XrmGridControl.getFetchXml";try{m.a.instance.reportCall(t);const e=Object(u.A)(F.getState(),this._contextToken,{id:this._pageId});return m.a.instance.reportSuccess(t),e}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,e,null,n),e}}getGrid(){const t="ClientApi.XrmGridControl.getGrid";try{return m.a.instance.reportCall(t),!this._grid&&this.getEntityName()&&(this._grid=new s.a(F,this._applicationContext,this._contextToken,this._pageId,this.getEntityName(),this._isEditable,this._controlName)),m.a.instance.reportSuccess(t),this._grid}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,e,null,n),e}}getViewSelector(){const t="ClientApi.XrmGridControl.getViewSelector";try{return m.a.instance.reportCall(t),this._viewSelector||(this._viewSelector=new y(F,this._contextToken,this._pageId,this._controlName,this._gridType)),m.a.instance.reportSuccess(t),this._viewSelector}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,e,null,n),e}}getTeamTemplateId(){const t="ClientApi.XrmGridControl.getTeamTemplateId";try{m.a.instance.reportCall(t);let e=null;const n=F.getState();if(Object(j.c)(n,T.c)){if(this.getEntityName()&&3===this._gridType){const t=Object(p.fb)(n,this._connectedControlProps,this._contextToken.parentContextToken),r="TeamTemplateId";t&&t.Controls&&t.Controls[this._controlName]&&t.Controls[this._controlName].Parameters&&t.Controls[this._controlName].Parameters[r]&&(e=t.Controls[this._controlName].Parameters[r])}}return m.a.instance.reportSuccess(t),e}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,e,null,n),e}}getEntityName(){return this._clientApiExecutor.execute("getEntityName",(t,e)=>{if(!this._entityName){if(this._entityName=Object(u.F)(F.getState(),this._pageId,this._contextToken,this._controlName),!this._entityName&&3===this._gridType){const n=Object(p.fb)(F.getState(),this._connectedControlProps,this._contextToken.parentContextToken),r="TargetEntityType";if(!(n&&n.Controls&&n.Controls[this._controlName]&&n.Controls[this._controlName].Parameters&&n.Controls[this._controlName].Parameters[r])){let a;return n?n.Controls?n.Controls[this._controlName]?n.Controls[this._controlName].Parameters?n.Controls[this._controlName].Parameters[r]||(a="formDescriptor.Controls[this.name].Parameters[targetEntityType] is null or undefined"):a="formDescriptor.Controls[this.name].Parameters is null or undefined":a="formDescriptor.Controls[this.name] is null or undefined":a="formDescriptor.Controls is null or undefined":a="formDescriptor is null or undefined",this._clientApiExecutor.reportFailure(t,new h.a(a),e),null}this._entityName=n.Controls[this._controlName].Parameters[r]}if(!this._entityName)return this._clientApiExecutor.reportFailure(t,new h.a("Logical name of the entity type is coming as null or undefined."),e),null}return this._entityName})}refresh(){this._clientApiExecutor.executeAsync("refresh",()=>F.dispatch(Object(c.a)(this._pageId,this._contextToken,this._controlName)))}refreshRibbon(){this._clientApiExecutor.executeAsync("refreshRibbon",()=>F.dispatch(Object(S.a)(this._pageId,Object(u.w)(F.getState(),this._pageId,this._contextToken))))}getUrl(t){const e="ClientApi.XrmGridControl.getUrl";try{m.a.instance.reportCall(e);let n=null,r=null;const a=this._getCurrentView();r={entityTypeName:this.getEntityName()},a&&(r.viewType="savedquery"===a.entityType?I.b.savedview:I.b.userview,r.viewId=new o.a(a.id)),n=i.a.Grid;let s=null;if(1===t)s=F.dispatch(Object(_.a)(n,r));else{const t=Object(P.a)(F,this._pageId);s=F.dispatch(Object(_.c)(t,n,r))}return m.a.instance.reportSuccess(e),s}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,n),t}}getRecordSetQueryKey(){return this._clientApiExecutor.execute("getRecordSetQueryKey",()=>Object(u.cb)(F.getState(),this._contextToken,{id:this._pageId}))}getGridType(){return m.a.instance.reportUsage("ClientApi.XrmGridControl.getGridType"),this._gridType}getRelationship(){return this._clientApiExecutor.execute("getRelationship",(t,e)=>{if(!this._relationship){const n=Object(u.v)(F.getState(),this._pageId,this._contextToken);if(n){const t=n.relationshipName;if(t&&(this._relationship=x(t,this.getEntityName()),n.relationshipRoleOrdinal)){const t=n.relationshipRoleOrdinal===E.a.Referencing?1:2;this._relationship.roleType=t}}else b.a.getInstance().traceManager.getTracer(t).error("Grid dataset was null",e)}return this._relationship})}getParentForm(){const t="ClientApi.XrmGridControl.getParentForm";try{m.a.instance.reportCall(t);const e=this._contextToken&&this._contextToken.parentContextToken?F.dispatch(Object(v.b)(this._pageId,this._contextToken.parentContextToken)):null;return m.a.instance.reportSuccess(t),e}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,e,null,n),e}}getRollupType(){return this._clientApiExecutor.execute("getRollupType",()=>Object(u.eb)(F.getState(),this._pageId,this._contextToken))}_getCurrentView(){let t=null;const e=this.getViewSelector().getCurrentView();if(e)return t="savedquery"===e.entityType?"savedquery":"userquery",{entityType:t,id:e.id};const n=Object(a.g)(F.getState(),this._pageId);if(n.viewType&&n.viewId){const e=n.viewId?o.a.externalGuid(n.viewId):void 0;if(t=n.viewType===I.b.savedview?"savedquery":"userquery",t&&e)return{entityType:t,id:e}}return null}}function x(t,e){const n={};n.name=t;const r=Object(C.h)(F.getState(),e);if(r){let e;if(r.OneToManyRelationships&&r.OneToManyRelationships[t]?e=r.OneToManyRelationships[t]:r.ManyToOneRelationships&&r.ManyToOneRelationships[t]&&(e=r.ManyToOneRelationships[t]),e)n.attributeName=e.ReferencingAttribute,n.relationshipType=0,n.navigationPropertyName=e.ReferencingEntityNavigationPropertyName;else if(r.ManyToManyRelationships&&r.ManyToManyRelationships[t]){const e=r.ManyToManyRelationships[t];n.relationshipType=1,1===n.roleType?(n.attributeName=e.Entity1IntersectAttribute,n.navigationPropertyName=e.Entity1NavigationPropertyName):(n.attributeName=e.Entity2IntersectAttribute,n.navigationPropertyName=e.Entity2NavigationPropertyName)}}return n}},HhsT:function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var r=n("uNLT"),a=n("Uv1Y"),i=n("cUbT"),s=n("gQ5I"),o=n("+aj2"),c=n("YxC/"),l=n("ZUzm"),u=n("sHzf"),d=n("bvqZ"),p=n("FdXt"),h=n("dHD5"),g=n("i1f0"),m=n("bT7G"),b=n("3tOH"),f=n("Bj/n"),y=n("O7zD");function v(t){return{type:"saveAndClose.saveAndCloseFormDialogAction.async",execute({dispatch:e,getState:n},v,_){const S=n(),O=Object(h.j)(S,t),C=Object(g.zb)(S,t,O),I=Object(g.ac)(S,t,O);if(!(!Object(m.g)(S,I)&&C&&Object.keys(C).length>0))return e(Object(r.e)(t,2)).then(n=>{const r=Object(g.Ib)(S,t),h=r?"Forms.MainFormDialogRoot.SaveAndClose":"Forms.QuickCreateFormRoot.SaveAndClose";if(n){const a=[{name:"isEntityRefNull",value:!1},{name:"entityTypeName",value:n.etn}];v.EventManager.ReportComponentSuccess(h,a);return(r?Promise.resolve(t):e(Object(o.b)(t,n))).then(t=>(e(Object(i.a)(n.etn)),function(t,e,n){const r="quickcreate_",a=Object(c.e)(e,[p.g,p.c]),i={actionLabel:Object(c.c)(a,p.g),eventHandler:()=>{t(Object(l.a)(n)),t(Object(u.removeToastNotification)(r+n.id.guid))}},s=null,o={id:r+n.id.guid,type:1,level:1,message:Object(c.c)(a,p.c),title:null,action:i,onCloseHandler:s};t(Object(d.b)(o))}(e,S,n),e(Object(s.e)(t,"save")).then(()=>n)))}return v.EventManager.ReportComponentSuccess(h,[{name:"isEntityRefNull",value:!0}]),Promise.reject(new a.a("Record is not created"))});for(const n in C){const r=C[n].label,a=C[n].errorMessage,i=e(Object(f.b)(r,a));e(Object(f.c)(O,t,i,b.a.error,Object(y.d)(t,n)))}}}}},JF0K:function(t,e,n){"use strict";n.d(e,"h",(function(){return r})),n.d(e,"i",(function(){return a})),n.d(e,"o",(function(){return i})),n.d(e,"a",(function(){return s})),n.d(e,"j",(function(){return o})),n.d(e,"c",(function(){return c})),n.d(e,"f",(function(){return l})),n.d(e,"g",(function(){return u})),n.d(e,"b",(function(){return h})),n.d(e,"d",(function(){return g})),n.d(e,"k",(function(){return m})),n.d(e,"l",(function(){return b})),n.d(e,"e",(function(){return f})),n.d(e,"q",(function(){return y})),n.d(e,"p",(function(){return v})),n.d(e,"m",(function(){return d})),n.d(e,"n",(function(){return p}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="BusinessProcessFlow.MoveToNextStage",a="BusinessProcessFlow.MoveToPreviousStage",i="BusinessProcessFlow.SetActiveStage",s="BusinessProcessFlow.AbandonProcess",o="BusinessProcessFlow.ReactivateProcess",c="BusinessProcessFlow.CompleteProcess",l="BusinessProcessFlow.InitilaizeWithFormEntityOnly",u="BusinessProcessFlow.InitilaizeWithProcessAndFormEntity",d="BusinessProcessFlow.SetActiveProcess",p="BusinessProcessFlow.SetActiveProcessInstance",h="BusinessProcessFlow.ActionStep",g="BusinessProcessFlow.FlowStepWidget",m="BusinessProcessFlow.RefreshFlowStep",b="BusinessProcessFlow.RenderProcessControl",f="BusinessProcessFlow.HideProcessControlForUciOffline",y="SaveFailureReason",v="faultedSnapshotId"},Jpj4:function(t,e,n){"use strict";n.d(e,"a",(function(){return m})),n.d(e,"b",(function(){return b}));var r=n("SAYH"),a=n("dHD5"),i=n("BFlg"),s=n("P6DH"),o=n("LbMF"),c=n("3hnk"),l=n("NUHF"),u=n("odYE"),d=n("3/02"),p=n("Lyxw"),h=n("bT7G"),g=n("qLnS");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const m="dataset.row.properties";function b(t,e,n){return{type:"row.properties.async",execute({dispatch:l,getState:h},b){const y=b.TraceManager.getTracer(i.z),v=i.x+".RowPropertiesAction",_=Object(p.c)(h(),d.L);try{const i=Object(a.v)(e),d=Object(s.P)(h(),e,{id:t});if(d){let p=null;const C=Object(s.Q)(h(),t,e);if(C)p=C;else{const n=Object(s.S)(h(),{id:t},e);n&&n.entityLogicalName&&(p=n.entityLogicalName)}if(p){const a=Object(o.d)(h(),p),i=Object(s.y)(h(),e,t);if(a){const t=[];for(const e of Object.keys(a)){const n=a[e],r=Object(c.f)(h(),p,n.LogicalName,g.a.CanUpdate);let s=!0;_&&i&&0===i[n.LogicalName]&&(s=!1),t.push({[n.LogicalName]:{requiredLevel:n.RequiredLevel,isDisabled:!(n.IsValidForUpdate&&r&&s),notifications:{}}})}for(const e of n)if(0===d.records.filter(t=>Object.keys(t)[0]===r.a.toString(e)).length)d.records.push({[r.a.toString(e)]:t});else{const n=d.records.find(t=>Object.keys(t)[0]===r.a.toString(e))[r.a.toString(e)],a=JSON.parse(JSON.stringify(t));n&&n.forEach(t=>{const e=t[Object.keys(t)[0]];e&&Object.keys(e.notifications).length>0&&(a.find(e=>Object.keys(e)[0]===Object.keys(t)[0])[Object.keys(t)[0]].notifications=e.notifications)}),d.records.find(t=>Object.keys(t)[0]===r.a.toString(e))[r.a.toString(e)]=a}}}if(l(function(t,e,n){return{type:m,payload:n,meta:{pageId:t,dataSetContextKey:e}}}(t,i,d)),_&&p){const r=Object(o.d)(h(),p),i=Object(s.y)(h(),e,t);for(const s of n){const n=(h(),S=s,O=p,new u.a(O,S)),o=Object(a.f)(e,s,p);if(r)for(const e of Object.keys(r)){const a=r[e];i&&1===i[a.LogicalName]&&null===a.ParentPicklistLogicalName&&f(h(),l,t,n,a.LogicalName,o)}}}y.info("creating the rowproperties for {0} rows"+n.length),b.EventManager.ReportComponentSuccess(v)}return Promise.resolve()}catch(t){const e="creating the rowproperties for {0} rows"+n.length+"failed";b.EventManager.ReportComponentFailure(v,Error(e))}var S,O}}}function f(t,e,n,r,a,i){const o={},c=Object(s.R)(t,n,i),u=Object(h.d)(t,c,r,a);o[a]=u,Object.keys(o).length>0&&e(Object(l.b)(n,i,!1,o))}},KGWS:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(t,e){this._traversedPath=t,this._stageId=e}get traversedPath(){return this._traversedPath}set traversedPath(t){this._traversedPath=t}get stageId(){return this._stageId}set stageId(t){this._stageId=t}}var a=n("sxfa"),i=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class s{get globalPathAndActiveStage(){return this._globalPathAndActiveStage}get navigationEntities(){return this._navigationEntities}get navigationEntityIdsByEntityLogicalName(){return this._navigationEntityIdsByEntityLogicalName}set globalPathAndActiveStage(t){(t||this._globalPathAndActiveStage||this._globalPathAndActiveStage.stageId===t.stageId)&&(this._globalPathAndActiveStage=t)}InitGlobalPathAndActiveStage(t){this._updateNavigationDictionary(t.navigationEntities),this.UpdateGlobalPathAndActiveStage(t.traversedPath,t.activeStageId)}UpdateGlobalPathAndActiveStage(t,e){this.globalPathAndActiveStage=new r(new a.a(t),e)}_updateNavigationDictionary(t){if(t){this._navigationEntities=t,this._navigationEntityIdsByEntityLogicalName={};for(let e=0;e<t.length;e++)this._navigationEntityIdsByEntityLogicalName[t[e].entityLogicalName]=new i.a(t[e].id)}}}},KnyI:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="attribute.removeOption";function i(t,e,n,i){const s=Object(r.x)(e);return{type:a,payload:i,meta:{pageId:t,contextKey:s,dataFieldName:n}}}},L8zx:function(t,e,n){"use strict";n.d(e,"a",(function(){return Q})),n.d(e,"b",(function(){return J}));var r=n("SAYH"),a=n("i1f0"),i=n("UqyN"),s=n("ABCl"),o=n("0nOn"),c=n("odYE"),l=n("hvSt"),u=n("5Oca"),d=n("CPoS"),p=n("qshH"),h=n("16wZ"),g=n("ZIjf");class m{constructor(t,e,n){const r="ClientApi.XrmProcessStep.constructor";e||Object(h.j)(r,"step"),n||Object(h.j)(r,"processManager"),t||Object(h.j)(r,"store"),this._step=e,this._processManager=n}isRequired(){const t="ClientApi.XrmProcessStep.isRequired";try{g.a.instance.reportCall(t);const e=this._step.get_isProcessRequired();return g.a.instance.reportSuccess(t),e}catch(e){throw p.a.getInstance().reportFailure(t,e),e}}getAttribute(){const t="ClientApi.XrmProcessStep.getAttribute";try{if(g.a.instance.reportCall(t),!this._attribute){const t=this._step.get_Steps().get_item(0);this._attribute=!t||t.get_isSystemControl()?null:t.get_dataFieldName()}return g.a.instance.reportSuccess(t),this._attribute}catch(e){throw p.a.getInstance().reportFailure(t,e),e}}getName(){const t="ClientApi.XrmProcessStep.getName";try{g.a.instance.reportCall(t);const e=this._step.get_Name();return g.a.instance.reportSuccess(t),e}catch(e){throw p.a.getInstance().reportFailure(t,e),e}}getProgress(){const t="ClientApi.XrmProcessStep.getProgress";try{g.a.instance.reportCall(t);let e=4;if(this._step.get_Steps()&&this._step.get_Steps().get_item(0)){if(this._step.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep&&this._processManager){const t=this._processManager.getActionLog(new r.a(this._step.get_Id()));t&&(e=t.status),e=0}}return g.a.instance.reportSuccess(t),e}catch(e){throw p.a.getInstance().reportFailure(t,e),e}}setProgress(t,e){const n="ClientApi.XrmProcessStep.setProgress";try{g.a.instance.reportCall(n);let r="invalid";switch(t){case 0:case 1:case 2:case 3:case 4:r=this._setProgressInternal(t,e)}return g.a.instance.reportSuccess(n),r}catch(t){throw p.a.getInstance().reportFailure(n,t),t}}_setProgressInternal(t,e){if(this._step.get_Steps()&&this._step.get_Steps().get_item(0)){if(this._step.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep){const n=this._processManager.UpdateActionLog(new r.a(this._step.get_Id()),t,e);if(n)return n}}return"invalid"}}var b=n("Sbn7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class f{constructor(t,e){this._processManager=e,null!=this._processManager&&this._processManager.shouldReInitializeNavigationBehavior()&&this._processManager.setBpfNavigationBehavior(this)}get allowCreateNew(){return g.a.instance.reportUsage("ClientApi.XrmProcessNavigationBehavior.getAllowCreateNew"),this._allowCreateNew}set allowCreateNew(t){const e="ClientApi.XrmProcessNavigationBehavior.setAllowCreateNew";try{g.a.instance.reportCall(e),this._allowCreateNew=t,null!=this._processManager&&this._processManager.setBpfNavigationBehavior(this),g.a.instance.reportSuccess(e)}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let y;class v{constructor(t,e,n,r,a){y=t,this._entityTypeName=n,this._activeStageId=r,this._stageStep=e,new f(t,a),a&&(this._processManager=a)}getCategory(){const t="ClientApi.XrmProcessStage.getCategory";try{g.a.instance.reportCall(t);const e=this._stageStep.get_stageCategory(),n={getValue(){let t=parseInt(e,10);return Number.isNaN(t)&&(t=-1),t}};return g.a.instance.reportSuccess(t),n}catch(e){throw p.a.getInstance().reportFailure(t,e),e}}getId(){const t="ClientApi.XrmProcessStage.getId";try{g.a.instance.reportCall(t);const e=this._stageStep.get_Id();return g.a.instance.reportSuccess(t),e}catch(e){throw p.a.getInstance().reportFailure(t,e),e}}getEntityName(){return g.a.instance.reportUsage("ClientApi.XrmProcessStage.getEntityName"),this._entityTypeName}getStatus(){const t="ClientApi.XrmProcessStage.getStatus";try{g.a.instance.reportCall(t);const e=this.getId()===this._activeStageId?"active":"inactive";return g.a.instance.reportSuccess(t),e}catch(e){throw p.a.getInstance().reportFailure(t,e),e}}getName(){const t="ClientApi.XrmProcessStage.getName";try{g.a.instance.reportCall(t);const e=this._stageStep.get_Description();return g.a.instance.reportSuccess(t),e}catch(e){throw p.a.getInstance().reportFailure(t,e),e}}getSteps(){const t="ClientApi.XrmProcessStage.getSteps";try{if(g.a.instance.reportCall(t),!this._steps&&(this._steps=new b.a(t),null!=this._stageStep.get_Steps()&&this._stageStep.get_Steps().get_Count()>0))for(let t=0;t<this._stageStep.get_Steps().get_Count();t++){const e=this._stageStep.get_Steps().get_item(t);if(e instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){const t=e.get_Steps().get_item(0);t&&(t instanceof Microsoft.Crm.Workflow.ObjectModel.ControlStep||t instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep||t instanceof Microsoft.Crm.Workflow.ObjectModel.FlowStep)&&this._steps.add(e.get_Id(),new m(y,e,this._processManager))}}return g.a.instance.reportSuccess(t),this._steps}catch(e){throw p.a.getInstance().reportFailure(t,e),e}}getNavigationBehavior(){const t="ClientApi.XrmProcessStage.getNavigationBehavior";try{g.a.instance.reportCall(t);const e=this._processManager.getBpfNavigationBehavior();return g.a.instance.reportSuccess(t),e}catch(e){throw p.a.getInstance().reportFailure(t,e),e}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let _;class S{constructor(t,e,n,r,a){const i="ClientApi.XrmBusinessProcessFlow.constructor";e||Object(h.j)(i,"workflowStep"),r||Object(h.j)(i,"activeStageId"),a||Object(h.j)(i,"processManager"),t||Object(h.j)(i,"store"),Object(h.a)(n)&&Object(h.j)(i,"isRendered"),_=t,this._isRendered=n,this._workflowStep=e,this._activeStageId=r,this._processManager=a}getName(){const t="ClientApi.XrmBusinessProcessFlow.getName";try{g.a.instance.reportCall(t);const e=this._workflowStep.get_Name();return g.a.instance.reportSuccess(t),e}catch(e){throw p.a.getInstance().reportFailure(t,e),e}}getId(){const t="ClientApi.XrmBusinessProcessFlow.getId";try{g.a.instance.reportCall(t);const e=this._workflowStep.get_Id();return g.a.instance.reportSuccess(t),e}catch(e){throw p.a.getInstance().reportFailure(t,e),e}}isRendered(){return g.a.instance.reportUsage("ClientApi.XrmBusinessProcessFlow.isRendered"),this._isRendered}getStages(){const t="ClientApi.XrmBusinessProcessFlow.getStages";try{if(g.a.instance.reportCall(t),!this._stages){this._stages=new b.a(t);for(let t=0;t<this._workflowStep.get_Steps().get_Count();t++){const e=this._workflowStep.get_Steps().get_item(t);if(e instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep){const t=e;for(let e=0;e<t.get_Steps().get_Count();e++){const n=t.get_Steps().get_item(e);this._stages.add(n.get_Id(),new v(_,n,t.get_EntityLogicalName(),this._activeStageId,this._processManager))}}}}return g.a.instance.reportSuccess(t),this._stages}catch(e){throw p.a.getInstance().reportFailure(t,e),e}}}var O,C=n("1kth"),I=n("cZbt"),P=n("blB4"),j=n("UuJw");!function(t){t.success="success",t.invalid="invalid"}(O||(O={}));var T=n("r/aD"),E=n("iF9X"),F=n("37s6"),w=n("69Qu"),x=n("IaGr"),A=n("arV0"),N=n("2Ct/"),k=n("ycdb"),D=n("ruPX"),M=n("cfbi");let R;class L{constructor(t,e,n,a,i){this._clientApiExecutor=new o.a(t,"ClientApi.XrmProcessControlData.",n,e);const s=this._clientApiExecutor.getComponentName("constructor");n||Object(h.j)(s,"pageId"),a||Object(h.j)(s,"entity"),e||Object(h.j)(s,"contextToken"),t||Object(h.j)(s,"store"),R=t,this._pageId=n,this._entity=a;let l=!1;Object(T.d)(R.getState(),this._pageId,s,!0)&&(this._processManager=i,l=!0),this._contextToken=e;const u=a.getEntityReference();this._entityRef=new c.a(u.entityType,r.a.tryParseOrNull(u.id),u.name);const d=Object(T.b)(n,t.getState(),l);x.a.getInstance().eventManager.ReportComponentSuccess(s,d)}getActiveProcess(){const t="ClientApi.XrmProcessControlData.getActiveProcess";try{if(g.a.instance.reportCall(t),!Object(T.d)(R.getState(),this._pageId,t))return g.a.instance.reportSuccess(t),null;const e=this._getProcessManager().getProcess();let n=null;if(e){const t=this._getProcessManager().getActiveStageId();n=new S(R,e,!0,t,this._getProcessManager())}return g.a.instance.reportSuccess(t),n}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}setStatus(t,e){const n="ClientApi.XrmProcessControlData.setStatus";try{if(g.a.instance.reportCall(n),!Object(T.d)(R.getState(),this._pageId,n))return void g.a.instance.reportSuccess(n);if(!t||this.getStatus()&&t===this.getStatus())return void g.a.instance.reportSuccess(n);let r;if(t===I.a.active)r=l.a.Active;else if(t===I.a.finished)r=l.a.Finished;else{if(t!==I.a.aborted)return void g.a.instance.reportSuccess(n);r=l.a.Aborted}this._getProcessManager().setStatus(r).then(()=>{this._callback(e,t,n),g.a.instance.reportSuccess(n)}).catch(e=>{const r=p.a.getInstance().getEventParameters(this._contextToken);return r.push({name:"newStatus",value:t}),Object(h.d)(R,e,n,r)})}catch(t){const e=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(n,t,null,e),t}}getStatus(){const t="ClientApi.XrmProcessControlData.getStatus";try{if(g.a.instance.reportCall(t),!Object(T.d)(R.getState(),this._pageId,t))return g.a.instance.reportSuccess(t),null;const e=this._convertToXrmProcessInstanceStatus(this._getProcessManager().getStatus());return g.a.instance.reportSuccess(t),e}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}getInstanceName(){const t="ClientApi.XrmProcessControlData.getInstanceName";try{if(g.a.instance.reportCall(t),!Object(T.d)(R.getState(),this._pageId,t))return g.a.instance.reportSuccess(t),null;let e=this._getProcessManager().getProcessInstanceName();if(!e){const t=Object(u.e)(R.getState(),this._entityRef);e=Object(d.c)(R.getState(),t)}return g.a.instance.reportSuccess(t),e}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}getInstanceId(){const t="ClientApi.XrmProcessControlData.getInstanceId";try{if(g.a.instance.reportCall(t),!Object(T.d)(R.getState(),this._pageId,t))return g.a.instance.reportSuccess(t),null;const e=this._getProcessManager().getProcessInstanceId(),n=e?r.a.toString(e):null;return g.a.instance.reportSuccess(t),n}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}getProcessInstances(t){const e="ClientApi.XrmProcessControlData.getProcessInstances";try{if(g.a.instance.reportCall(e),!Object(T.d)(R.getState(),this._pageId,e)||Object(N.g)(R.getState()))return;"function"==typeof t&&this._getProcessManager().getProcessInstances().then(n=>{if(n&&n.value&&n.value.length>0){const r={};n.value.forEach(t=>{t.businessprocessflowinstanceid&&(r[t.businessprocessflowinstanceid]={CreatedOnDate:t.createdon?new Date(t.createdon):null,ProcessDefinitionID:t._processid_value,ProcessDefinitionName:t.name,ProcessInstanceID:t.businessprocessflowinstanceid,ProcessInstanceName:t.name,StatusCodeName:this._convertToXrmProcessInstanceStatus(t.Process_x002e_statuscode),CreatedOn:t.createdon?new Date(t.createdon).toLocaleDateString():"",ProcessDefintionID:t._processid_value,ProcessDefintionName:t.name})}),Object(s.c)(e,[],()=>{t(r)})}g.a.instance.reportSuccess(e)}).catch(t=>{const n=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(R,t,e+".getProcessInstances",n)})}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}setActiveProcess(t,e){this._clientApiExecutor.executeAsync("setActiveProcess",(n,a)=>{const i=r.a.tryParseOrNull(t),s=Object(A.m)(R.getState(),this._pageId);if(i&&r.a.equals(i,r.a.EMPTY)){if(s){const t=new c.a(this._entity.getEntityName(),r.a.EMPTY);return R.dispatch(Object(k.b)(!0,t)),x.a.getInstance().eventManager.ReportComponentSuccess(n,a),Promise.resolve().then(()=>(this._callback(e,O.success,n,a),Promise.resolve())).catch(t=>(this._callback(e,O.invalid,n,a),Promise.reject(t)))}return Promise.resolve().then(()=>(this._callback(e,O.invalid,n,a),Promise.resolve()))}if(!Object(T.d)(R.getState(),this._pageId,n,!0)||Object(N.g)(R.getState()))return Promise.resolve();let o=null;return o=s?Promise.resolve():this._getProcessManager().setActiveProcess(t),o.then(()=>{this._callback(e,O.success,n,a);const r=this.getActiveProcess();return r&&r.getId().toUpperCase()===t.toUpperCase()||this._reloadPage(n,this._getProcessManager().getCurrentFormEntity(),t),Promise.resolve()}).catch(t=>(this._callback(e,O.invalid,n,a),Promise.reject(t)))},[{name:"processId",value:t,isRequired:!0,expectedDataType:"guid"}])}setActiveProcessInstance(t,e){this._clientApiExecutor.executeAsync("setActiveProcessInstance",(n,r)=>!Object(T.d)(R.getState(),this._pageId,n)||Object(N.g)(R.getState())?Promise.resolve():this._getProcessManager().setActiveProcessInstance(t).then(a=>{this._callback(e,O.success,n,r);return this.getInstanceId()!==t&&this._reloadPage(n,this._getProcessManager().getCurrentFormEntity(),a,t),Promise.resolve()}).catch(t=>(this._callback(e,O.invalid,n,r),Promise.reject(t))),[{name:"processInstanceId",value:t,isRequired:!0,expectedDataType:"guid"}])}getEnabledProcesses(t){const e="ClientApi.XrmProcessControlData.getEnabledProcesses";try{if(g.a.instance.reportCall(e),!Object(T.d)(R.getState(),this._pageId,e,!0))return void g.a.instance.reportSuccess(e);const n=R.getState();if(Object(E.g)(n)&&Object(F.w)(n)&&!Object(w.b)(n)){const n={};return void("function"==typeof t&&Object(s.c)(e,[],()=>{t(n)}))}this._getProcessManager().getEnabledProcesses().then(n=>{const r={};n&&n.length>0&&n.forEach(t=>{r[t.workflowId]=t.name}),"function"==typeof t&&Object(s.c)(e,[],()=>{t(r)}),g.a.instance.reportSuccess(e)}).catch(t=>{const n=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(R,t,e+".getEnabledProcesses",n)})}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}switchProcess(){const t="ClientApi.XrmProcessControlData.switchProcess";try{if(g.a.instance.reportCall(t),!Object(T.d)(R.getState(),this._pageId,t)||Object(N.g)(R.getState()))return;this._getProcessManager().switchProcess(),g.a.instance.reportSuccess(t)}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}abandonProcess(){const t="ClientApi.XrmProcessControlData.abandonProcess";try{if(g.a.instance.reportCall(t),!Object(T.d)(R.getState(),this._pageId,t)||Object(A.m)(R.getState(),this._pageId))return void g.a.instance.reportSuccess(t);this._getProcessManager().abandonProcess().then(()=>{g.a.instance.reportSuccess(t)}).catch(e=>{const n=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(R,e,t+".abandonProcess",n)})}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}reactivateProcess(){const t="ClientApi.XrmProcessControlData.reactivateProcess";try{if(g.a.instance.reportCall(t),!Object(T.d)(R.getState(),this._pageId,t)||Object(A.m)(R.getState(),this._pageId))return void g.a.instance.reportSuccess(t);this._getProcessManager().reactivateProcess().then(()=>{g.a.instance.reportSuccess(t)}).catch(e=>{const n=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(R,e,t+".reactivateProcess",n)})}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}completeProcess(){const t="ClientApi.XrmProcessControlData.completeProcess";try{if(g.a.instance.reportCall(t),!Object(T.d)(R.getState(),this._pageId,t)||Object(A.m)(R.getState(),this._pageId))return void g.a.instance.reportSuccess(t);this._getProcessManager().completeProcess().then(()=>{g.a.instance.reportSuccess(t)}).catch(e=>{const n=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(R,e,t+".completeProcess",n)})}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}getActiveStage(){const t="ClientApi.XrmProcessControlData.getActiveStage";try{if(g.a.instance.reportCall(t),!Object(T.d)(R.getState(),this._pageId,t))return g.a.instance.reportSuccess(t),null;const e=this._getProcessManager().getActiveStage();let n=null;return e&&(n=new v(R,e,this._getProcessManager().getCurrentFormEntity().etn,e.get_Id(),this._getProcessManager())),g.a.instance.reportSuccess(t),n}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}getActivePath(){const t="ClientApi.XrmProcessControlData.getActivePath";try{if(g.a.instance.reportCall(t),!Object(T.d)(R.getState(),this._pageId,t))return g.a.instance.reportSuccess(t),null;const e=this._getProcessManager().getActivePathStages();let n=null;if(e){const r=this._getProcessManager().getActiveStageId(),a=new b.a(t);e.forEach(t=>{const e=t.get_parent().get_EntityLogicalName();a.add(t.get_stageId(),new v(R,t,e,r,this._getProcessManager()))}),n=a}return g.a.instance.reportSuccess(t),n}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}setActiveStage(t,e){const n="ClientApi.XrmProcessControlData.setActiveStage";try{if(g.a.instance.reportCall(n),this._entity.getIsDirty()||Object(A.m)(R.getState(),this._pageId))g.a.instance.reportSuccess(n),this._callback(e,P.a.dirtyForm,n);else{if(!Object(T.d)(R.getState(),this._pageId,n))return void g.a.instance.reportSuccess(n);this._getProcessManager().setActiveStage(t).then(()=>{this._callback(e,this._getStageInvalidReason(null),n),this._loadActiveStageEntity(n),g.a.instance.reportSuccess(n)}).catch(t=>{this._callback(e,t?this._getStageInvalidReason(t):j.a.invalid,n)})}}catch(t){const e=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(n,t,null,e),t}}moveNext(t){const e="ClientApi.XrmProcessControlData.moveNext";try{const n=!0;if(g.a.instance.reportCall(e),this._entity.getIsDirty()||Object(A.m)(R.getState(),this._pageId))g.a.instance.reportSuccess(e),this._callback(t,P.a.dirtyForm,e);else{if(!Object(T.d)(R.getState(),this._pageId,e))return void g.a.instance.reportSuccess(e);if(this._getProcessManager().isCrossEntityNavigation(n))return this._callback(t,P.a.crossEntity,e),void g.a.instance.reportSuccess(e);this._getProcessManager().moveToNextStage().then(()=>{this._callback(t,this._getNavigationStatus(null),e),g.a.instance.reportSuccess(e)}).catch(n=>{const r=n?this._getNavigationStatus(n):P.a.invalid;if(this._callback(t,r,e),r===P.a.invalid){const t=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(R,n,e+".moveToNextStage",t)}g.a.instance.reportSuccess(e)})}}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}movePrevious(t){const e="ClientApi.XrmProcessControlData.movePrevious";try{const n=!0;if(g.a.instance.reportCall(e),this._entity.getIsDirty()||Object(A.m)(R.getState(),this._pageId))g.a.instance.reportSuccess(e),this._callback(t,P.a.dirtyForm,e);else{if(!Object(T.d)(R.getState(),this._pageId,e))return void g.a.instance.reportSuccess(e);if(Object(N.g)(R.getState())&&this._getProcessManager().isCrossEntityNavigation(!n))return this._callback(t,P.a.crossEntity,e),void g.a.instance.reportSuccess(e);this._getProcessManager().moveToPreviousStage().then(()=>{this._callback(t,this._getNavigationStatus(null),e),this._loadActiveStageEntity(e),g.a.instance.reportSuccess(e)}).catch(n=>{const r=n?this._getNavigationStatus(n):P.a.invalid;if(this._callback(t,r,e),r===P.a.invalid){const t=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(R,n,e+".moveToPreviousStage",t)}g.a.instance.reportSuccess(e)})}}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}getSelectedStage(){const t="ClientApi.XrmProcessControlData.getSelectedStage";try{if(g.a.instance.reportCall(t),!Object(T.d)(R.getState(),this._pageId,t))return g.a.instance.reportSuccess(t),null;const e=this._getProcessManager().getSelectedStage();let n=null;if(e){const t=this._getProcessManager().getActiveStageId();n=new v(R,e,this._getProcessManager().getCurrentFormEntity().etn,t,this._getProcessManager())}return g.a.instance.reportSuccess(t),n}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}addOnStageChange(t){const e="ClientApi.XrmProcessControlData.addOnStageChange";t||Object(h.j)(e,"handler");try{if(g.a.instance.reportCall(e),!Object(T.d)(R.getState(),this._pageId,e))return void g.a.instance.reportSuccess(e);R.dispatch(Object(C.q)(this._contextToken,this._pageId,t)),g.a.instance.reportSuccess(e)}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}addOnPreStageChange(t){const e="ClientApi.XrmProcessControlData.addOnPreStageChange";Object(h.g)(t,e,"handler");try{if(g.a.instance.reportCall(e),!Object(T.d)(R.getState(),this._pageId,e))return void g.a.instance.reportSuccess(e);R.dispatch(Object(C.j)(this._contextToken,this._pageId,t)),g.a.instance.reportSuccess(e)}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}removeOnStageChange(t){const e="ClientApi.XrmProcessControlData.removeOnStageChange";t||Object(h.j)(e,"handler");try{if(g.a.instance.reportCall(e),!Object(T.d)(R.getState(),this._pageId,e))return void g.a.instance.reportSuccess(e);R.dispatch(Object(C.L)(this._contextToken,this._pageId,t)),g.a.instance.reportSuccess(e)}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}removeOnPreStageChange(t){const e="ClientApi.XrmProcessControlData.removeOnPreStageChange";Object(h.g)(t,e,"handler");try{if(g.a.instance.reportCall(e),!Object(T.d)(R.getState(),this._pageId,e))return void g.a.instance.reportSuccess(e);R.dispatch(Object(C.E)(this._contextToken,this._pageId,t)),g.a.instance.reportSuccess(e)}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}addOnStageSelected(t){const e="ClientApi.XrmProcessControlData.addOnStageSelected";t||Object(h.j)(e,"handler");try{if(g.a.instance.reportCall(e),!Object(T.d)(R.getState(),this._pageId,e))return void g.a.instance.reportSuccess(e);R.dispatch(Object(C.r)(this._contextToken,this._pageId,t)),g.a.instance.reportSuccess(e)}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}removeOnStageSelected(t){const e="ClientApi.XrmProcessControlData.removeOnStageSelected";t||Object(h.j)(e,"handler");try{if(g.a.instance.reportCall(e),!Object(T.d)(R.getState(),this._pageId,e))return void g.a.instance.reportSuccess(e);R.dispatch(Object(C.M)(this._contextToken,this._pageId,t)),g.a.instance.reportSuccess(e)}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}addOnProcessStatusChange(t){const e="ClientApi.XrmProcessControlData.addOnProcessStatusChange";t||Object(h.j)(e,"handler");try{if(g.a.instance.reportCall(e),!Object(T.d)(R.getState(),this._pageId,e))return void g.a.instance.reportSuccess(e);R.dispatch(Object(C.k)(this._contextToken,this._pageId,t)),g.a.instance.reportSuccess(e)}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}addOnPreProcessStatusChange(t){const e="ClientApi.XrmProcessControlData.addOnPreProcessStatusChange";Object(h.g)(t,e,"handler");try{if(g.a.instance.reportCall(e),!Object(T.d)(R.getState(),this._pageId,e))return void g.a.instance.reportSuccess(e);R.dispatch(Object(C.i)(this._contextToken,this._pageId,t)),g.a.instance.reportSuccess(e)}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}removeOnProcessStatusChange(t){const e="ClientApi.XrmProcessControlData.removeOnProcessStatusChange";t||Object(h.j)(e,"handler");try{if(g.a.instance.reportCall(e),!Object(T.d)(R.getState(),this._pageId,e))return void g.a.instance.reportSuccess(e);R.dispatch(Object(C.F)(this._contextToken,this._pageId,t)),g.a.instance.reportSuccess(e)}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}removeOnPreProcessStatusChange(t){const e="ClientApi.XrmProcessControlData.removeOnPreProcessStatusChange";Object(h.g)(t,e,"handler");try{if(g.a.instance.reportCall(e),!Object(T.d)(R.getState(),this._pageId,e))return void g.a.instance.reportSuccess(e);R.dispatch(Object(C.D)(this._contextToken,this._pageId,t)),g.a.instance.reportSuccess(e)}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}_getStageInvalidReason(t){return t?t.stageInvalidReason||j.a.invalid:P.a.success}_getNavigationStatus(t){return t?t.navigationStatus||P.a.invalid:P.a.success}_convertToXrmProcessInstanceStatus(t){if(t){if(t===l.a.Active)return I.a.active;if(t===l.a.Finished)return I.a.finished;if(t===l.a.Aborted)return I.a.aborted}return null}_callback(t,e,n,r){const a=n+".Callback";r||(r=p.a.getInstance().getEventParameters(this._contextToken)),r.push({name:"Status",value:e}),Object(s.c)(a,r,()=>{"function"==typeof t&&t(e)})}_reloadPage(t,e,n,r){if(e){const a=Object(A.m)(R.getState(),this._pageId),i={entityTypeName:e.etn,id:a?void 0:e.id,processId:n,processInstanceId:r},s={target:"inline"};R.dispatch(Object(D.a)(M.a,i,this._pageId,s)).then(e=>{if(0!==e.status)return Object(h.d)(R,e.error,t+".navigateTo.INavigationFailure")}).catch(e=>Object(h.d)(R,e,t+".navigateTo."))}}_loadActiveStageEntity(t){const e=this._getProcessManager().getActiveStageEntityRef();e&&e.etn!==this._getProcessManager().getCurrentFormEntity().etn&&this._reloadPage(t,e,this.getActiveProcess().getId(),this.getInstanceId())}_getProcessManager(){return this._processManager||(this._processManager=Object(T.c)(this._processManager,R,this._pageId,"ClientApi.XrmProcessControlData.getProcessManager")),this._processManager}}var V=n("uNLT"),B=n("/q/W"),G=n("jRy5"),X=n("Uv1Y"),U=n("Fij2"),q=n("mIxf"),z=n("HhsT"),H=n("PUjk"),W=n("AE7n"),Y=n("P6DH");let K;class Q{constructor(t,e,n,r,a){this._entity=null;const i="ClientApi.XrmFormData.constructor";t||Object(h.j)(i,"store"),n||Object(h.j)(i,"pageId"),e||Object(h.j)(i,"contextToken"),r||Object(h.j)(i,"formContext"),K=t,this._pageId=n,this._formContext=r,this._contextToken=e,this._entity=a}get entity(){return g.a.instance.reportUsage("ClientApi.XrmFormData.entity"),this._entity}get process(){const t="ClientApi.XrmFormData.process_get";try{const e=Object(N.f)(K.getState());g.a.instance.reportCall(t);const n=!!this._process;if((!e&&!this._process||e)&&this._entity){const t=Object(A.g)(K.getState(),this._pageId),e=Object(H.b)(this._pageId,t);this._entity&&(this._process=new L(K,this._contextToken,this._pageId,this.entity,e))}g.a.instance.reportSuccess(t);const r=Object(T.a)(this._pageId,K.getState(),n,!!this._entity);return x.a.getInstance().eventManager.ReportComponentSuccess(t,r),this._process}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}set process(t){const e=Object(T.a)(this._pageId,K.getState(),!!this._process,!!this._entity);x.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmFormData.process_set",e),this._process=t}getEntity(){return g.a.instance.reportUsage("ClientApi.XrmFormData.getEntity"),this._entity}getIsDirty(){var t,e,n;const r="ClientApi.XrmFormData.getIsDirty";try{g.a.instance.reportCall(r);let a=!1;if(this._entity&&this._entity.getIsDirty())a=!0;else{for(let t=0;t<this.attributes.getLength();t++){const e=this.attributes.get(t);if("never"!==e.getSubmitMode()&&e.getIsDirty()){a=!0;break}}if(!a&&(null===(e=null===(t=this._formContext)||void 0===t?void 0:t.ui)||void 0===e?void 0:e.controls))for(let t=0;t<this._formContext.ui.controls.getLength();t++){const e=this._formContext.ui.controls.get(t);if("formcomponent"===e.getControlType()&&e.isLoaded()&&(null===(n=e.data)||void 0===n?void 0:n.getIsDirty())){a=!0;break}}}return g.a.instance.reportSuccess(r),a}catch(t){const e=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(r,t,null,e),t}}get attributes(){const t="ClientApi.XrmFormData.attributes";try{if(g.a.instance.reportCall(t),!this._unboundAttributes){this._unboundAttributes=new b.a(t);const e=Object(a.Oc)(K.getState(),this._pageId);if(e)for(const t in e){const n=e[t],r=t,a=Object(i.b)(K,this._contextToken,this._pageId,r,this.entity,this._formContext.ui,n);this._unboundAttributes.add(a.getName(),a)}}return g.a.instance.reportSuccess(t),this._unboundAttributes}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}_refreshEntity(t){return this.entity.refresh().then(()=>{Object(V.d)(K.dispatch,this._contextToken,this._pageId),t&&K.dispatch(Object(C.Q)(this._contextToken,this._pageId,3,this.entity)),Object(U.b)(this.entity)})}refresh(t){const e="ClientApi.XrmFormData.refresh";try{if(g.a.instance.reportCall(e),this.entity){const n=Object(a.kb)(K.getState(),{id:this._pageId},this._contextToken);return!n&&t&&this.entity.getIsDirty()?this.save().then(t=>(g.a.instance.reportSuccess(e),{})).catch(t=>{const n=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(K,t,e+".save",n)}):!n&&this.entity.getIsDirty()?K.dispatch(Object(B.a)(this._pageId)).then(t=>{if(t)return this._refreshEntity(!0).then(()=>(g.a.instance.reportSuccess(e),{})).catch(t=>{const n=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(K,t,e+".handleUnsavedChanges.refreshEntity",n)})}).catch(t=>{const n=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(K,t,e+".handleUnsavedChanges",n)}):this._refreshEntity(!0).then(()=>(g.a.instance.reportSuccess(e),{})).catch(t=>{const n=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(K,t,e+".handleUnsavedChanges.refreshEntity",n)})}const n=new X.a("Refresh action cannot be executed since form entity is null",2147746581);return x.a.getInstance().traceManager.getTracer(e).info("Refreshing on a non entity page"),Object(h.d)(K,n,e+".entity")}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(K,t,e,n)}}save(t){const e="ClientApi.XrmFormData.save",n=p.a.getInstance().getEventParameters(this._contextToken);if(!this._entity){const t=new X.a("Save action cannot be executed since form entity is null",2147746581);return Object(h.d)(K,t,e+".entity")}try{g.a.instance.reportCall(e);let i=1;t&&t.saveMode&&(i=t.saveMode);return J(this._pageId,K,i,n,this._contextToken,this.entity,!0,!0).then(t=>{if(t){const i={entityType:t.etn,id:r.a.toString(t.id),name:t.name};return Object(a.Kb)(K.getState(),this._pageId)?(g.a.instance.reportSuccess(e),{savedEntityReference:i}):this._refreshEntity(!1).then(()=>(g.a.instance.reportSuccess(e),{savedEntityReference:i})).catch(t=>Object(h.d)(K,t,e+".refresh",n))}if(Object(a.kb)(K.getState(),{id:this._pageId},this._contextToken)||!this.entity.getIsDirty()){const t=this.entity.getEntityReference();return g.a.instance.reportSuccess(e),{savedEntityReference:t}}const i=new X.a("Save action was not executed and the form is dirty.",2147879192);return Object(h.d)(K,i,e+".NoReference",null,!1)}).catch(t=>{if(t&&(2200000006===t.errorCode||2200000004===t.errorCode)){const t=this.entity.getEntityReference();return g.a.instance.reportSuccess(e),Promise.resolve({savedEntityReference:t})}return Object(h.d)(K,t,e,n)})}catch(t){return Object(h.d)(K,t,e,n)}}isValid(){var t,e,n;const r="ClientApi.XrmFormData.isValid";try{g.a.instance.reportCall(r);let a=!0;if(this.entity&&!this.entity.isValid())a=!1;else if(this.attributes)for(let t=0;t<this.attributes.getLength();t++)if(!this.attributes.get(t).isValid()){a=!1;break}if(a&&(null===(e=null===(t=this._formContext)||void 0===t?void 0:t.ui)||void 0===e?void 0:e.controls))for(let t=0;t<this._formContext.ui.controls.getLength();t++){const e=this._formContext.ui.controls.get(t);if("formcomponent"===e.getControlType()&&e.isLoaded()&&!(null===(n=e.data)||void 0===n?void 0:n.isValid())){a=!1;break}}return a||K.dispatch(Object(q.b)(this._pageId,this._contextToken)),g.a.instance.reportSuccess(r),a}catch(t){const e=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(r,t,null,e),t}}addOnLoad(t){const e="ClientApi.XrmFormData.addOnLoad";t||Object(h.j)(e,"handler");try{g.a.instance.reportCall(e),K.dispatch(Object(C.c)(this._contextToken,this._pageId,t)),g.a.instance.reportSuccess(e)}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}removeOnLoad(t){const e="ClientApi.XrmFormData.removeOnLoad";t||Object(h.j)(e,"handler");try{g.a.instance.reportCall(e),K.dispatch(Object(C.x)(this._contextToken,this._pageId,t)),g.a.instance.reportSuccess(e)}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}}function J(t,e,n,i,s,o,c,l){const u=e.getState(),d=r.a.tryParseOrNull(o.getId());if(s.contextTokenType===G.a.GridRow){const n=[],r=Object(Y.T)(u,t,s.parentContextToken,s.parentContextToken.controlName);return o.attributes.forEach(t=>n.push(t.getName())),i.push({name:"functionName",value:"saveEmbeddedEntity"}),e.dispatch(Object(W.a)(t,o.getEntityName(),null==d?void 0:d.guid,null,n,null==r?void 0:r.guid,!1,s.parentContextToken))}if(Object(a.Kb)(u,t))return i.push({name:"functionName",value:"saveAndCloseFormDialogAction"}),e.dispatch(Object(z.a)(t));if(d&&!r.a.equals(d,r.a.EMPTY))return i.push({name:"functionName",value:"saveForm"}),e.dispatch(Object(V.e)(t,n));const p=Object(A.l)(e.getState(),t);return i.push({name:"functionName",value:"saveFormAndNavigate"}),e.dispatch(Object(V.f)(t,p,l,n,!1,c))}},LLfG:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="attribute.submitmode";function i(t,e,n,i){const s=Object(r.x)(e);return{type:a,payload:i,meta:{pageId:t,contextKey:s,dataFieldName:n}}}},MgYC:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="form.ShowHeaderFieldsInFlyout.set";function i(t,e,n){const i=Object(r.v)(e);return{type:a,payload:{headerFieldsInFlyout:n},meta:{pageId:t,contextKey:i}}}},"N+Ya":function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="navigation.item.label";function a(t,e,n,a){return{type:r,payload:{label:n,currentLanguageId:a},meta:{pageId:t,navigationItemId:e}}}},Nse0:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s}));var r=n("BFlg"),a=n("Uv1Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="customcontrol.refreshCustomDataProvider";function s(t,e,n,s){return{type:"customcontrol.refreshCustomDataProvider.async",execute({dispatch:o,getState:c},l){const u=r.x+".refreshCustomDataProviderAction";return s().then(r=>(o(function(t,e,n,r){let a=new Array;r&&r.length>0&&(a=r.slice());return{type:i,payload:a,meta:{pageId:t,customControlId:e,dataSetParameterName:n}}}(t,e,n,r)),l.EventManager.ReportComponentSuccess(u),r)).catch(t=>(l.EventManager.ReportComponentFailure(u,Error(t)),Promise.reject(new a.a(t))))}}}},NtHU:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="header.bodyvisible";function i(t,e,n){const i=Object(r.v)(e);return{type:a,payload:n,meta:{pageId:t,contextKey:i}}}},OWbt:function(t,e,n){"use strict";n.d(e,"f",(function(){return _t})),n.d(e,"h",(function(){return rt})),n.d(e,"i",(function(){return dt})),n.d(e,"j",(function(){return pt})),n.d(e,"k",(function(){return ht})),n.d(e,"c",(function(){return st})),n.d(e,"d",(function(){return ot})),n.d(e,"a",(function(){return et})),n.d(e,"b",(function(){return nt})),n.d(e,"e",(function(){return at})),n.d(e,"g",(function(){return vt}));var r=n("4leG"),a=n("SAYH"),i=n("y60j"),s=n("Uv1Y"),o=n("i1f0"),c=n("Z/4N"),l=n("arV0"),u=n("odYE"),d=n("LbMF"),p=n("IqkD"),h=n("mIxf"),g=n("1qQb"),m=n("FZDd"),b=n("WY/A"),f=n("Dea/"),y=n("iZ7K"),v=n("5Oca"),_=n("Jj4w"),S=n("IVVt");var O=n("3hnk"),C=n("qTme"),I=n("dMZy"),P=n("lLEV"),j=n("5ZBI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const T="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlTimelineWallSelector";var E=n("E5qG"),F=n("dHD5"),w=n("EY5k"),x=n("YGjz"),A=n("3mEc"),N=n("8nT0"),k=n("Co7m"),D=n("bT7G"),M=n("AF/G"),R=n("1usl"),L=n("4Us1"),V=n("99zj"),B=n("E8F2"),G=n("YxC/"),X=n("HfZT"),U=n("74Tm"),q=n("9fGf"),z=n("/qEh"),H=n("ldGr"),W=n("NUHF"),Y=n("3/02"),K=n("Lyxw"),Q=n("N6E8"),J=n("455M"),Z=n("p8cR"),$=n("pF61"),tt=n("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const et="form.initialize",nt="form.xrmready";function rt(t,e,n,r,c){const g=[{name:"formId",value:a.a.toString(t)},{name:"pageId",value:e},{name:"contextKey",value:Object(F.v)(n)}];return{type:"form.initialize.async",execute({dispatch:m,getState:b},f,v){const _=b(),S=Object(l.g)(_,e),{entityTypeName:C,data:I,recordSetQueryKey:w}=S,x=f.TraceManager.getTracer("Forms.InitializeForm"),D=[];let L;if(g.push({name:"isPreview",value:S&&S.isPreview}),g.push({name:"EntityName",value:S&&S.entityTypeName}),x.info("initializeForm started.",g),Object(Z.b)(function(t){return()=>{const e={},n={},r={};return(a,i,s,o,c)=>{j.a.info(T+s.controlId+": createGetTimelineWallData started");let l=!1;n.hasOwnProperty(a)&&n[a]||(n[a]=new P.a(t,a,s.id));const u=n[a],d=u.retrieveTimelineWallObject(i,s,o,c,t);r.hasOwnProperty(a)&&r[a]&&d===r[a]||(r[a]=d,l=!0);const p=u;return l&&(e[a]=p),j.a.info(T+s.controlId+": createGetTimelineWallData finished"),e[a]}}}(m),J.a.TimelineWall),x.info("BusinessProcessWrapperManager.Instance.init started.",g),D.push(k.a.Instance.init(f,b,m).then(()=>x.info("BusinessProcessWrapperManager.Instance.init completed.",g))),Object(O.a)(_,t))if(Object(l.m)(_,e)){if(!Object(O.g)(_,C,1,0)&&!(null==S?void 0:S.isPreview))return it(22e8,m,x,v,_,e)}else{if(!Object(O.g)(_,C,2,0))return it(2147746342,m,x,v,_,e)}const G=Object(i.j)(_,t),q=vt(_,G,t),$=bt(_,C,G),tt=function(t,e,n,r){const a={};if(e&&e.RelatedEntityAttributes&&r)for(const i in e.RelatedEntityAttributes){const s=Object(y.x)(t,r,i);if(s&&s.ReferencedEntity){const r={},o=ft(t,s.ReferencedEntity,e.RelatedEntityAttributes[i]),c=Object(F.m)(n,i);a[Object(F.v)(c)]={attributes:o,submitModes:r}}}return a}(_,G,n,C),et=Object(U.a)(_),nt=Object(p.s)(_);St(_,m,t,q,$,e,n,tt,nt),w&&!et&&m(Object(X.g)(e,w)),x.info("Update quick view forms started.",g);for(const r in G.InlineQuickForms){const a=G.InlineQuickForms[r];for(const s in a){const o=a[s],c=Object(i.j)(_,o),l=vt(_,c,o),u=bt(_,s,c),d=Object(F.l)(n,r,s);St(_,m,t,l,u,e,d,null,nt)}}if(x.info("Update quick view forms completed.",g),I&&0!==Object.keys(I).length){const{createFromEntity:r,createFromRelationship:i}=S,{initWithEntity:c}=S;let p=r;!p&&c&&(p=c),L=function(t,e,n,r,i,c,p,g,m,b,f){n&&n.info("initializeFormWithDefaultValue started.",r);const v=Object(d.d)(t,c);let _=null;const S={},O=Object(l.m)(t,i),C=a.a.toString(g);let I,P;const j=[];C&&(_=Object(d.k)(t,C));for(const s of Object.keys(p)){if("processid"===s)continue;let l=v[s];if(!l&&_&&(l=_[s]),l&&!l.AttributeOf){const o=l.Type;switch(o){case"customer":case"owner":case"lookup":case"regarding":if("string"==typeof p[s]){const u=ct(p,s,l);if(!u){ut(n,s);continue}if(S[s]=u,!a.a.equals(a.a.EMPTY,u.id)&&"owner"!==o&&O&&(b||f))if(P){const t=P.then(()=>e(Object(z.b)(i,g)).then(()=>{n&&n.info("updateSnapshotWithOptions completed (1).",r)}));j.push(t)}else P=mt(t,e,u,c,i,n,r,b,f),j.push(P)}else{let t;t=Array.isArray(p[s])?p[s][0]:p[s],t&&t.id&&a.a.tryParseOrNull(t.id)&&t.entityType&&(S[s]=new u.a(t.entityType,new a.a(t.id),t.name))}break;case"partylist":const d=p[s];let h=d;const m=[];try{"string"==typeof d&&(h=JSON.parse(d));for(const t of h)m.push(new u.a(t.entityType,new a.a(t.id),t.name))}catch(t){ut(n,s,"partylist")}S[s]=m;break;case"boolean":case"picklist":case"status":S[s]=p[s];break;case"uniqueidentifier":S[s]=new a.a(p[s]);break;default:S[s]=p[s]}}else if(-1!==s.indexOf(Q.d)||"_CreateFromId"===s){let a=null;if(-1!==s.indexOf(Q.d)&&(a=ct(p,Q.d,l)),!a&&"_CreateFromId"===s){const e=Object(y.m)(t,p._CreateFromType),n=Object(y.h)(t,e);n&&(a=lt(e,p._CreateFromId,n.DisplayName))}if(!a){ut(n,Q.d);continue}if(!I&&(I=a,O))if(P){const t=P.then(()=>e(Object(z.b)(i,g)).then(()=>{n&&n.info("updateSnapshotWithOptions completed (2).",r)}));j.push(t)}else P=mt(t,e,I,c,i,n,r,b,f),j.push(P);if(Object(y.h)(t,c).IsActivity&&-1===Object.keys(S).indexOf(N.t)&&Object(y.z)(t,c,I.etn,N.t)){const e=Object(o.ab)(t,i,m);e&&e[N.t]&&(S[N.t]=a)}}else{ut(n,s);if(Object(K.c)(t,Y.Rc))return Promise.reject(Object(B.b)(t,i,2200000009))}}const T=Object(K.c)(t,Y.L);let E=S;T&&(E=function(t,e,n,r,a){const i={},s=Object(F.w)(r),c=Object(o.P)(t,s,e,n);for(const s in a){if(!c||!c.hasOwnProperty(s)){i[s]=a[s];continue}const o=Object(d.a)(t,e,s);if(!(o&&o.ParentPicklistLogicalName)&&!Object(H.a)(t,r,n,e,c,s,{name:s,value:0})){i[s]=a[s];let c=[];for(o&&o.ChildPicklistLogicalNames&&(c=c.concat(o.ChildPicklistLogicalNames));c&&c.length>0;){const s=c.pop();if(a.hasOwnProperty(s)){const o=Object(d.a)(t,e,s),l=JSON.parse(a[o.ParentPicklistLogicalName]),u=JSON.parse(a[s]);Object(W.a)(t,n,r,o,e,l,u)&&(i[s]=a[s],o.ChildPicklistLogicalNames&&o.ChildPicklistLogicalNames.length>0&&(c=c.concat(o.ChildPicklistLogicalNames)))}}}}return i}(t,c,i,m,S));const w=gt(E);if(j.length>0)return Promise.all(j).catch(t=>{if(2147749377===t.errorCode||-2147093999===t.errorCode)return Promise.resolve(null);Object(s.b)(t)}).then(()=>(e(Object(h.a)(i,w,!0,!0)),n&&n.info("initializeFormWithDefaultValue completed at snapshotPromiseList.length > 0.",r),Promise.resolve(null)));return e(Object(h.a)(i,w,!0,!0)),n&&n.info("initializeFormWithDefaultValue completed at snapshotPromiseList.length == 0.",r),Promise.resolve(null)}(b(),m,x,g,e,C,I,t,n,p,i)}if(G&&G.Controls&&G.Controls.notescontrol){const t=Object(l.g)(_,e);x.info("loadTimelineConfigAndMetaData started.",g),m(Object(E.b)(G.Controls.notescontrol,t,r)).then(()=>{x.info("loadTimelineConfigAndMetaData completed.",g)})}if(G&&G.Controls)for(const t in G.Controls)if(G.Controls[t]){if(G.Controls[t].Id&&G.Controls[t].Id.startsWith("WebResource"))for(const e of G.Controls[t].Parameters)if("Url"===e.Name){let t=!1;if(c)for(const n of c){const r=e.Value&&e.Value.toLowerCase()||"";if(r.length>=n.length&&r.length-n.length===r.lastIndexOf(n)){t=!0;break}}if(!t){const t=Object(A.j)(_,e.Value);t&&!t.Name&&(x.info("retrieveWebResourceDescriptorByName started.",g),m(Object(V.c)(e.Value)).then(()=>{x.info("retrieveWebResourceDescriptorByName completed.",g)}))}}a.a.equals(G.Controls[t].ClassId,M.rb)&&_&&void 0===_.currentServerTime.serverTimeDiffInSeconds&&(x.info("retrieveServerTime started.",g),m(Object(R.b)(new u.a(C))).then(()=>{x.info("retrieveServerTime completed.",g)}))}return null!=L?L:(x.info("initializeForm completed.",g),Promise.all(D))},getFailureParameters:(t,e)=>g}}function at(t,e,n,a,i,s,o){const c=e(Object(m.f)(s,!1,[])).then(()=>{const n=Object(y.h)(t(),s);if(n.IsChildEntity){const r=Object(O.d)(t(),n);return e(Object(m.f)(r.EntityLogicalName,!1,[]))}}),u=()=>{const i=t();if(!Object(O.b)(i,s))return it(2200000001,e,n,a,i,o);const c=Object(O.c)(i,s),u=Object(r.d)(i);return c&&Object(l.m)(i,o)&&!u?it(2200000002,e,n,a,i,o):void 0};return c?c.then(u):Promise.resolve(u())}function it(t,e,n,r,a,i){const s=Object(B.d)(t);return e(Object(w.e)(s)).then(()=>{const e=Object(B.c)(t);if(n){const t=[{name:"CorrelationId",value:r.correlationId},{name:"ContextId",value:r.contextId},{name:"ActionStack",value:r.stack}];n.debug(e,t)}const o=Object(G.e)(a,s),c=Object(G.c)(o,s[0]),l=Object(G.c)(o,s[1]);throw Object(B.b)(a,i,t,e,c,l)})}function st(t,e,n,r,a,i,s,c,g){g.push({name:"AutoPopulateFieldsTimeStamp",value:Date.now()}),c&&c.info("autoPopulateFields started.",g);const m=Object(d.d)(t,n);if(!m)return void(c&&c.warn("attributes is null.",g));const b=t=>t&&t.OptionSet&&Object.keys(t.OptionSet).length>0,{id:f}=Object(l.g)(t,r),y=new u.a(n,f),v={},_=Object(o.ac)(t,r,s);for(const e of a.concat(i)){const n=m[e];if(n&&(a.indexOf(e)>=0&&i.indexOf(e)>=0||b(n))){if(!Object(o.X)(t,r,s,_,y,n.LogicalName)){switch(e){case N.q:const n=Object(p.q)(t),r=Object(p.t)(t);if(n&&r){const t=new u.a(x.a,n,r);v[e]=t}break;case N.w:if(!Object(D.d)(t,_,null,N.w)){const n=Object(p.b)(t);if(n){const t=new u.a(x.b,n.transactionCurrencyId,n.currencyName);v[e]=t}}}if(b(n)){const r=Object(D.d)(t,_,new u.a(n.EntityLogicalName),e),i=r?parseInt(r.valueString,10):null!=n.DefaultValue?n.DefaultValue:e===N.u?0:void 0;if(void 0===i||i<0||(v[e]=i),e===N.u&&-1!==a.indexOf(N.v)){const t=m[e];if(t&&t.OptionSet&&Object.keys(t.OptionSet).length>0){const t=n.OptionSet.find(t=>t.Value===i),e=t?t.DefaultStatus:m[N.v].DefaultValue||0;e<0||(v[N.v]=e)}}}}}}const S=gt(v);e(Object(h.a)(r,S,!0,!0)),c.info("autoPopulateFields completed.",g)}function ot(t,e,n,r,i,s,o){const{id:c}=Object(l.g)(t,r),d=new u.a(n,c),p={};if(a.a.isNullOrEmpty(d.id)&&!o)return function(t,e,n,r,i){const s=Object(v.d)(t,n);if(null!=s)return Promise.resolve(s);return e(Object(L.a)(a.a.EMPTY,new u.a(n,a.a.EMPTY))).then(t=>t&&t.businessProcessFlows?Promise.resolve(a.a.tryParse(Object.keys(t.businessProcessFlows)[0])):Promise.resolve(null)).catch(t=>{const e=[{name:"CorrelationId",value:i.correlationId},{name:"ContextId",value:i.contextId},{name:"ActionStack",value:i.stack},{name:"entityName",value:n},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}];return r.EventManager.ReportComponentFailure("Forms.InitializeForm",Error("Catch block of InitializeForm.retrieveBusinessProcessFlow"),void 0,e),r.TraceManager.getTracer("Forms.InitializeForm").error("Error while executing getBusinessProcessFlowDefaultIdForEntity in the retrieveBusinessProcessFlow promise.",e),Promise.resolve(null)})}(t,e,n,i,s).then(t=>{t&&(p.processid=t.guid);const n=gt(p);return e(Object(h.a)(r,n,!0,!0)),Promise.resolve()});o&&(p.processid=o);const g=gt(p);return e(Object(h.a)(r,g,!0,!0)),Promise.resolve()}function ct(t,e,n){let r=e;!e.match(/id$/i)&&e.indexOf(Q.d)>-1&&(r+="id");const i=t[r];if(null!=i){if(a.a.validate(i)){const r=i,a=t[e+"name"];let s=t[e+"type"]||t[e+"target"];return!s&&n.Targets&&n.Targets.length>0&&(s=n.Targets[0]),lt(s,r,a)}try{const t=JSON.parse(i);if(t)return lt(t.entityType,t.id,t.name)}catch(t){}}return null}function lt(t,e,n){if(t&&e&&a.a.validate(e)){const r=new a.a(e);if(!a.a.isNullOrEmpty(r))return new u.a(t,r,n)}return null}function ut(t,e,n){if(t){const r=[{name:"key",value:e},{name:"source",value:n}];t.warn("Value passed is not in correct syntax.",r)}}function dt(t,e,n,r,a,i,s,o){return pt(t,e,n,r,i,s,o).then(()=>ht(t,e,n,a,i,s,o))}function pt(t,e,n,r,a,i,s){if(!Object(o.Eb)(t,a)&&Object($.n)(t,a))return i&&i.warn("pageId"+a+" is dead so rejecting loadScripts"),Promise.reject(Object(B.b)(t,a,2200000008,"Page has expired."));i&&i.info("loadScripts started.",s);return n(e.ScriptManager.getContainer(a).getEventManager().loadScripts(r,a)).then(()=>{i&&i.info("loadScripts completed",s)})}function ht(t,e,n,r,a,i,s){if(!Object(o.Eb)(t,a)&&Object($.n)(t,a))return void(i&&i.warn("pageId "+a+" is dead so won't run runFormOnLoadScripts",s));i&&i.info("runFormOnLoadScripts started.",s);const c=e.ScriptManager.getContainer(a).getEventManager();n(c.addPblEvent(r)),n(c.runOnLoad(r,1)),n(c.runOnDataLoad(r,1)),i&&i.info("runFormOnLoadScripts completed.",s)}function gt(t){const e={};for(const n in t){const r={fieldName:n,value:t[n]};e[n]=r}return e}function mt(t,e,n,r,a,i,o,c,l){const d=Object(F.j)(t,a),p=Object(F.x)(d);return i&&i.info("createAndSetDataSnapshotFrom started.",o),e(function(t,e,n,r,a){return{type:"snapshot.from.async",execute({dispatch:i,getState:o},c){const l=c.DataSource,d=u.a.toLegacyEntityReference(t),p=new _.a(d,e,S.a.All),h=l.execute(p,null).nativePromise();let O=null,C=null,I=null;return h.then(t=>{const n=t.get_entity();return O=Object(g.a)(n),C=O.fields,I=O.identifier,i(Object(m.f)(e,!1,Object.keys(O.fields)))},t=>{const n=Object(s.c)(t);if(t&&t.get_ErrorCode&&(-2147093999===t.get_ErrorCode()||n&&-2147217919===n.getNegativeErrorCode())&&r){const t=[];if(C={},r.etn){const n=Object(y.c)(o(),r.etn,e);if(n)for(const e of n)e.ReferencingAttribute&&t.push(e.ReferencingAttribute)}else a&&t.push(a.attributeName);for(const e of t){if(!r.name&&r.id){const t=Object(v.h)(o(),r.etn,r.id.guid);if(t&&t.fields){const e=Object(y.E)(o(),r.etn);let n=t.fields[e];n&&n.value||(n=t.fields.name),n&&n.value&&(r={etn:r.etn,id:r.id,name:n.value})}}C[e]={reference:r,timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}}}return I=new u.a(e),i(Object(m.f)(e,!1,t))}Object(s.b)(t)}).then(()=>{const t=Object(b.b)(o(),I,C,n,f.a.Create),e=t.payload.snapshotId;return i(t),e})}}}(n,r,p,c,l)).then(t=>{i&&(o.push({name:"newSnapshotId",value:t?t.toString():"<null>"}),i.info("initializeCreateDataSnapshotFrom completed.",o)),e(Object(C.b)(a,t,d)).then(()=>{i&&i.info("createAndSetDataSnapshotFrom completed.",o)})})}function bt(t,e,n){let r={};if(n&&n.Attributes&&e){const a=Object(A.d)(t,n.FormLibraries,[e]);if(n.Attributes||a){const i=[].concat(n.Attributes,a);-1===i.indexOf(N.u)&&i.push(N.u),r=ft(t,e,i)}}return{attributes:r,submitModes:{}}}function ft(t,e,n){const r={};if(n&&e)for(let a=0;a<n.length;a++){const i=n[a];if(i){const n=Object(o.L)(t,e,i);n&&(r[i]=n)}}return r}function yt(t){return Array.isArray(t)?t:t.Controls?t.Controls:null}function vt(t,e,n){const r={},a={},i={},s={bodyVisible:!0,commandBarVisible:!0,tabNavigatorVisible:!0},l={visible:!0};let u={navBarAreas:{},navPaneIsvItems:{},navBarByRelationshipItems:{},navBarItems:{}};if(e&&e.Tabs&&e.TabNames){const n=Object(o.m)(t,e);let s=!1;for(const o of n){const n={collapsed:!!s||!(o.Expanded&&o.Visible),visible:o.Visible,label:o.Label,sectionNames:[],domId:o.DomId,showLabel:o.ShowLabel,contentType:null};switch(o.ContentType){case"expandAvailableSpace":case"singleComponent":n.contentType="singleComponent";break;default:n.contentType="cardSections"}s=s||o.Expanded&&o.Visible;const l=[];if(o.Columns)for(let n=0;n<o.Columns.length;n++){const r=o.Columns[n];if(r.SectionNames)for(let n=0;n<r.SectionNames.length;n++){const s=r.SectionNames[n];if(e.Sections[s]){const n=e.Sections[s];l.push(s);const r=[];for(const t of e.Sections[s].Rows)for(const e of t.Cells)e.ControlName&&r.push(e.ControlName);const u={parentTabId:o.Id,visible:n.Visible,label:n.Label,controlNames:r,domId:n.DomId,semanticZoomDomId:n.SemanticZoomDomId};a[s]=u;for(let n=0;n<r.length;n++){const a=r[n];if(e.Controls[a]){const n=e.Controls[a],r=_t(n,s,!0),o=Object(c.a)(n,e,Object(q.b)(t));null!=o&&(r.visible=r.visible||o.ShouldOverrideControlVisible),Ot(r),i[a]=r}}}}}if(o.Header)for(const t of o.Header)i[t.Name]=_t(t,null,!0);if(o.Footer)for(const t of o.Footer)i[t.Name]=_t(t,null,!0);n.sectionNames=l,r[o.Id]=n}}if(e&&e.Navigation&&(u=e.Navigation),e&&e.Header){const t=yt(e.Header);if(t)for(const e of t)i[e.Name]=_t(e,null,!0),Ot(i[e.Name]);s.bodyVisible=!1!==e.Header.BodyVisible,s.commandBarVisible=!1!==e.Header.CommandBarVisible,s.tabNavigatorVisible=!1!==e.Header.TabNavigatorVisible}if(e&&e.Footer){const t=yt(e.Footer);if(t)for(const e of t)i[e.Name]=_t(e,null,!0),Ot(i[e.Name]);l.visible=!1!==e.Footer.Visible}return{formId:n,tabs:r,sections:a,controls:i,selectedTab:Object(I.a)(),selectedRelatedEntity:null,isSaving:!1,invalidControls:{},invalidAttributes:{},controlUnboundOutputs:{},inlineQuickForms:e&&e.InlineQuickForms?e.InlineQuickForms:null,xrmReady:!1,label:"",navigation:u,viewportWidth:0,viewportHeight:0,showHeaderFieldsInSection:!1,headerFieldsInFlyout:new Set,isAutoSaving:!1,header:s,footer:l}}function _t(t,e,n){return t?{parentSectionName:e,visible:t.Visible,label:t.Label,valid:n,labelSource:t.LabelSource,domId:t.DomId,parameters:t.Parameters,dataFieldName:t.DataFieldName,relationship:t.Relationship}:null}function St(t,e,n,r,i,s,c,l=null,u){const d=Object(o.cb)(t,s,c),p=Object(tt.a)(t,s);a.a.equals(null==d?void 0:d.formId,null==r?void 0:r.formId)&&a.a.equals(n,null==p?void 0:p.formId)||e(function(t,e,n,r,a,i=null,s){return{type:et,payload:{formId:t,formUIState:e,formMetadataState:n,relatedEntityMetadataState:i,currentLanguageId:s},meta:{pageId:r,contextToken:a}}}(n,r,i,s,c,l,u))}function Ot(t){t&&t.parameters&&t.parameters.DefaultViewId&&(t.parameters.defaultviewid=t.parameters.DefaultViewId)}},PZ34:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("ruPX"),a=n("baQL");function i(t,e){return Object(r.a)(a.a,{},e,t)}},PbI6:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="tab.contentType";function i(t,e,n,i){const s=Object(r.v)(n);return{type:a,payload:i,meta:{pageId:t,tabId:e,contextKey:s}}}},Q1Tc:function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return i}));var r=n("dHD5"),a=n("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="control.update.unboundOutputs";function s(t,e,n,s){return{type:"control.update.unboundOutputs.async",execute({dispatch:o,getState:c}){if(!Object.keys(s).length)return Promise.resolve();const l=c(),u=Object(a.a)(l,t);let d=!1;const p=Object(r.v)(n),h=Object.assign({},u.forms[p].controlUnboundOutputs);for(const t in s){const n=s[t],r=e+"."+t;h[r]!==n&&(h[r]=n,d=!0)}return d&&o(function(t,e,n){return{type:i,payload:{controlUnboundOutputs:n},meta:{pageId:t,contextKey:e}}}(t,p,h)),Promise.resolve()}}}},QXpm:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return o}));var r=n("dHD5"),a=n("BFlg"),i=n("LAGg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="grid.toggleRollupView";const o=(t,e,n)=>function(t,e,n,s){return{type:"grid.toggleRollupView.async",execute({dispatch:o},c){const l=c.TraceManager.getTracer(a.z),u=a.x+".toggleRollupViewAction";try{l.info(`Setting Toggle value to ${e} for the grid.`);const a=Object(r.v)(s);o(function(t,e,n,r){return{type:t,payload:e,meta:{pageId:n,dataSetContextKey:r}}}(t,e,n,a)),o(Object(i.b)(n,s));const d=[{name:"newValue",value:e}];return c.EventManager.ReportComponentSuccess(u,d),Promise.resolve()}catch(t){const e="Setting Toggle value to the grid failed";c.EventManager.ReportComponentFailure(u,Error(e))}}}}(s,t,e,n)},SVnG:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n("+aBC"),a=n("Nse0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i={};function s(t=i,e){return e.type===a.a?Object.assign(Object.assign({},t),{[Object(r.a)(e.meta.customControlId,e.meta.dataSetParameterName)]:e.payload}):t}},TAjd:function(t,e,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(e,"a",(function(){return r})),function(t){t.collapsed="collapsed",t.expanded="expanded",t.floating="floating",t.getDefaultDisplayState=function(){return t.collapsed}}(r||(r={}))},TD3W:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="form.relationship.clear";function a(t,e){return{type:r,payload:{relationship:e},meta:{pageId:t}}}},Tg1Y:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="form.tab.selectPrevious";function i(t,e){const n=Object(r.v)(e);return{type:a,payload:null,meta:{pageId:t,contextKey:n}}}},TsER:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="refresh.timer";function i(t,e,n){const i=Object(r.x)(e);return{type:a,payload:null,meta:{pageId:t,contextKey:i,controlName:n}}}},UqyN:function(t,e,n){"use strict";n.d(e,"a",(function(){return kt})),n.d(e,"b",(function(){return Dt}));var r=n("0nOn"),a=n("SAYH"),i=n("WPtp"),s=n("odYE"),o=n("ZIjf"),c=n("LbMF"),l=n("UJfx"),u=n("bT7G"),d=n("mlKL"),p=n("LLfG"),h=n("i1f0"),g=n("BvQu"),m=n("Sbn7"),b=n("mIxf"),f=n("1kth"),y=n("16wZ"),v=n("qshH"),_=n("dHD5"),S=n("iZ7K"),O=n("3tOH"),C=n("z5LE"),I=n("3HPu"),P=n("jTSi"),j=n("jq7Z"),T=n("fU7K"),E=n("O7zD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const F="ClientApi.XrmEntityAttribute.";let w;class x{constructor(t,e,n,a,i,s){w=t,this._clientApiExecutorAttribute=new r.a(t,F,n,e),this._clientApiExecutorAttribute.addEventParameter({name:"attributeName",value:a,isEventParam:!0});const o=this._clientApiExecutorAttribute.getComponentName("constructor");a||Object(y.j)(o,"attributeName"),t||Object(y.j)(o,"store"),n||Object(y.j)(o,"pageId"),e||Object(y.j)(o,"contextToken"),s||Object(y.j)(o,"xrmFormUi"),this._attributeName=a,this._parentEntity=i,this._pageId=n,this.xrmFormUi=s,this._contextToken=e}get controls(){return this._clientApiExecutorAttribute.execute("controls",(t,e)=>{if(!this._controls){this._controls=new m.a(t);const e=Object(h.z)(w.getState(),this._pageId,this.contextToken,this._attributeName);if(e){this.xrmFormUi.getControls();const t=this.xrmFormUi.controls;for(let n=0;n<e.length;n++){const r=e[n],a=t.get(r);a&&this._controls.add(r,a)}}}return this._controls})}addOnChange(t){const e=F+"addOnChange";t||Object(y.j)(e,"handler");try{o.a.instance.reportCall(e),w.dispatch(Object(f.a)(this.contextToken,this._pageId,this.getName(),t)),o.a.instance.reportSuccess(e)}catch(t){const n=v.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(e,t,null,n),t}}fireOnChange(){const t=F+"fireOnChange";try{o.a.instance.reportCall(t),w.dispatch(Object(f.P)(this.contextToken,this._pageId,this.getName())),o.a.instance.reportSuccess(t)}catch(e){const n=v.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(t,e,null,n),e}}getAttributeType(){const t=F+"getAttributeType";try{o.a.instance.reportCall(t);const e=this.getAttrDescriptor().Type;return o.a.instance.reportSuccess(t),e}catch(e){const n=v.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(t,e,null,n),e}}getFormat(){return this._clientApiExecutorAttribute.execute("getFormat",()=>{const t=this.getAttrDescriptor();if(!t||!t.Format)return null;const e=t.Format.toLowerCase();let n=e;switch(this.getAttrDescriptor().Type){case"string":"text"===n||"email"===n||"phone"===n||"url"===n||"tickersymbol"===n||"1"!==e&&"2"!==e||(n="textarea");break;case"integer":"duration"!==n&&(n="none");break;case"lookup":"0"===e&&(n="none");break;case"memo":"2"!==e&&"1"!==e||(n="textarea");break;default:"0"===e?n="none":void 0===n&&(n=null)}return n})}getIsDirty(){const t=F+"getIsDirty";try{o.a.instance.reportCall(t);const e=Object(h.Jb)(w.getState(),this.getPageId(),this.dataContextToken,this.getName())&&Object(u.e)(w.getState(),Object(h.ac)(w.getState(),this.getPageId(),this.dataContextToken),this.getName());return o.a.instance.reportSuccess(t),e}catch(e){const n=v.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(t,e,null,n),e}}getName(){return o.a.instance.reportUsage(F+"getName"),this._attributeName}getParent(){return o.a.instance.reportUsage(F+"getParent"),this._parentEntity}getRequiredLevel(){const t=F+"getRequiredLevel";try{o.a.instance.reportCall(t);const e=Object(h.pc)(w.getState(),this._pageId,this.dataContextToken,this.getName());let n;switch(e){case 2:case 1:n="required";break;case-1:case 0:n="none";break;case 3:n="recommended";break;default:Object(y.h)(t,"RequiredLevel",e)}return o.a.instance.reportSuccess(t),n}catch(e){const n=v.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(t,e,null,n),e}}getSubmitMode(){const t=F+"getSubmitMode";try{o.a.instance.reportCall(t);const e=Object(h.zc)(w.getState(),this._pageId,this.contextToken,this.getName());let n;switch(e){case g.a.Dirty:n="dirty";break;case g.a.Always:n="always";break;case g.a.Never:n="never";break;default:Object(y.h)(t,"SubmitMode",e)}return o.a.instance.reportSuccess(t),n}catch(e){const n=v.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(t,e,null,n),e}}getUserPrivilege(){const t=F+"getUserPrivilege";try{o.a.instance.reportCall(t);let e=null;if(w.getState()&&this._parentEntity&&this._attributeName){const t=Object(l.a)(w.getState(),this._parentEntity.getEntityName(),a.a.fromExternalGuid(this._parentEntity.getId()),this._attributeName);t&&(e={canCreate:t.canCreate,canRead:t.canRead,canUpdate:t.canUpdate})}return o.a.instance.reportSuccess(t),e}catch(e){const n=v.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(t,e,null,n),e}}getValue(){const t=F+"getValue";try{o.a.instance.reportCall(t);const e=this.getValueInternal();let n=null;return Object(y.a)(e)||(Object(i.j)(e)?n=e.value:Object(y.k)(t,"isPlainValue","value")),o.a.instance.reportSuccess(t),n}catch(e){const n=v.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(t,e,null,n),e}}removeOnChange(t){const e=F+"removeOnChange";t||Object(y.j)(e,"handler");try{o.a.instance.reportCall(e),w.dispatch(Object(f.v)(this.contextToken,this._pageId,this.getName(),t)),o.a.instance.reportSuccess(e)}catch(t){const n=v.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(e,t,null,n),t}}setRequiredLevel(t){const e=F+"setRequiredLevel";t||Object(y.j)(e,"requiredLevel"),"none"!==t&&"recommended"!==t&&"required"!==t&&Object(y.h)(e,"RequiredLevel",t);try{let n;switch(o.a.instance.reportCall(e),t){case"none":n=0;break;case"recommended":n=3;break;case"required":n=2}w.dispatch(Object(d.b)(this._pageId,this.dataContextToken,this._attributeName,n)),o.a.instance.reportSuccess(e)}catch(t){const n=v.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(e,t,null,n),t}}setSubmitMode(t){const e=F+"setSubmitMode";t||Object(y.j)(e,"mode"),"dirty"!==t&&"always"!==t&&"never"!==t&&Object(y.h)(e,"SubmitMode",t);try{let n;switch(o.a.instance.reportCall(e),t){case"dirty":n=g.a.Dirty;break;case"always":n=g.a.Always;break;case"never":n=g.a.Never}w.dispatch(Object(p.b)(this._pageId,this.contextToken,this.getName(),n)),o.a.instance.reportSuccess(e)}catch(t){const n=v.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(e,t,null,n),t}}setValue(t){const e=F+"setValue";try{o.a.instance.reportCall(e),this.setValueInternal(t),o.a.instance.reportSuccess(e)}catch(t){const n=v.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(e,t,null,n),t}}setIsValid(t,e){return this._clientApiExecutorAttribute.execute("setIsValid",(n,r)=>{t?(w.dispatch(Object(I.b)(this._pageId,this._attributeName,!0,this.contextToken)),w.dispatch(Object(P.b)(this.contextToken,this._pageId,Object(E.d)(this._pageId,this._attributeName))),w.dispatch(Object(C.b)(w.getState(),this._pageId,this._attributeName,null,this.contextToken))):this._addNotification(e)})}_addNotification(t){w.dispatch(Object(I.b)(this._pageId,this._attributeName,!1,this.contextToken));const e={messages:[t],notificationLevel:O.a.error};w.dispatch(Object(C.b)(w.getState(),this._pageId,this._attributeName,e,this.contextToken))}isValid(){const t=F+"isValid";try{o.a.instance.reportCall(t);const e=this.getValueInternal(),n=this.getParent();if(n){const r=Object(S.h)(w.getState(),n.getEntityName());if(r&&r.PrimaryIdAttribute!==this.getName()&&n.getId()!==a.a.EMPTYSTRING&&"required"===this.getRequiredLevel()&&Object(y.a)(e))return o.a.instance.reportSuccess(t),!1}let r=!0;return this.hasErrorNotification()?r=!1:e&&e.validationResult&&(r=e.validationResult.isValueValid),o.a.instance.reportSuccess(t),r}catch(e){const n=v.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(t,e,null,n),e}}hasErrorNotification(){const t=Object(_.v)(this.contextToken),e=w.getState(),n=Object(j.a)(e,this._pageId);if(n.forms&&n.forms[t]&&(n.forms[t].invalidControls||n.forms[t].invalidAttributes)){return!0===n.forms[t].invalidControls[this.getName()]||!0===n.forms[t].invalidAttributes[this.getName()]}return!1}getPageId(){return this._pageId}getAttrDescriptor(){if(this.getParent()){let t=Object(h.r)(w.getState(),this.getParent().getEntityName(),this.getName(),this._pageId,this.contextToken);return t||(t=Object(c.a)(w.getState(),this.getParent().getEntityName(),this.getName())),t}return Object(h.Nc)(w.getState(),this.getPageId(),this.getName())}getDataXmlInternal(){let t="";return t=t+"<"+Object(T.CrmXmlEncode)(this.getName())+">"+Object(T.CrmXmlEncode)(this.getValue())+"</"+Object(T.CrmXmlEncode)(this.getName())+">",t}setValueInternal(t){const e=this.getName(),n={};n[e]={fieldName:e,value:t},w.dispatch(Object(b.a)(this._pageId,n,!1,!0,this.getParent()?this.getParent().getEntityName():null,this.getParent()?this.getParent().getId():null,Object(_.t)(this._contextToken),this.contextToken))}get parentEntityReference(){let t,e;return this.getParent()?(t=this.getParent().getEntityName(),e=this.getParent().getId()):this.contextToken.formId&&(t=this.contextToken.formId.guid),e?new s.a(t,new a.a(e)):new s.a(t)}getValueInternal(){const t=Object(h.ac)(w.getState(),this.getPageId(),this.dataContextToken);return Object(h.X)(w.getState(),this._pageId,this._contextToken,t,this.parentEntityReference,this._attributeName,w.dispatch)}get contextToken(){return Object(_.r)(this._contextToken)}get dataContextToken(){return this._contextToken}}var A=n("5Oca"),N=n("6QGX");class k extends x{getOption(t){const e="ClientApi.XrmEntityAttributeOptionSetBase.getOption";if(Object(y.a)(t))return null;const n="number"==typeof t?t:parseInt(t,10);isNaN(n)&&Object(y.k)(e,"number","value");try{o.a.instance.reportCall(e);const n=this.getAttrDescriptor().OptionSet;let r=null;for(let e=0;e<n.length;e++)n[e].Value===t&&(r={text:n[e].Label,value:n[e].Value});return o.a.instance.reportSuccess(e),r}catch(t){throw v.a.getInstance().getEventParameters(this.contextToken).push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t),t}}getOptions(){const t="ClientApi.XrmEntityAttributeOptionSetBase.getOptions";try{o.a.instance.reportCall(t);const e=this.getAttrDescriptor().OptionSet.map(t=>({text:t.Label,value:t.Value}));return o.a.instance.reportSuccess(t),e}catch(e){throw v.a.getInstance().getEventParameters(this.contextToken).push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e),e}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let D,M;class R extends k{constructor(t,e,n,r,a,i){super(t,e,n,r,a,i),D=t}getInitialValue(){const t="ClientApi.XrmEntityAttributeBoolean.getInitialValue";try{o.a.instance.reportCall(t);const e=Object(A.j)(D.getState(),this.parentEntityReference,this.getName()),n=e?parseInt(e.valueString,10):null;return o.a.instance.reportSuccess(t),n}catch(e){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}getValue(){const t="ClientApi.XrmEntityAttributeBoolean.getValue";try{o.a.instance.reportCall(t);const e=this.getValueInternal(),n=Object(N.a)(e);return o.a.instance.reportSuccess(t),n}catch(e){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}setValue(t){const e="ClientApi.XrmEntityAttributeBoolean.setValue";Object(y.a)(t)||"boolean"!=typeof t&&Object(y.k)(e,"boolean","value");try{o.a.instance.reportCall(e),this.setValueInternal(t),o.a.instance.reportSuccess(e)}catch(t){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,n),t}}getAttributeType(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributeBoolean.getAttributeType"),"boolean"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class L extends k{constructor(t,e,n,r,a,i){super(t,e,n,r,a,i),M=t}getInitialValue(){const t="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getInitialValue";try{o.a.instance.reportCall(t);const e=Object(A.j)(M.getState(),this.parentEntityReference,this.getName()),n=Object(N.e)(e);return o.a.instance.reportSuccess(t),n}catch(e){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}getSelectedOption(){const t="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getSelectedOption";try{o.a.instance.reportCall(t);let e=null;const n=this.getValue();return n&&(e=[],n.forEach(t=>{const n=this.getOption(t);n&&e.push(n)})),o.a.instance.reportSuccess(t),e}catch(e){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}getText(){const t="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getText";try{o.a.instance.reportCall(t);let e=null;const n=this.getSelectedOption();return n&&(e=[],n.forEach(t=>{e.push(t.text)})),o.a.instance.reportSuccess(t),e}catch(e){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}getValue(){const t="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getValue";try{o.a.instance.reportCall(t);const e=this.getValueInternal();let n=null;return e&&(n=Object(N.e)(e)),o.a.instance.reportSuccess(t),n}catch(e){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}getAttributeType(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributeMultiSelectOptionSet.getAttributeType"),"multiselectoptionset"}setValue(t){const e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.setValue";try{o.a.instance.reportCall(e),Array.isArray(t)?this.setValueInternal(t):this.setValueInternal([]),o.a.instance.reportSuccess(e)}catch(t){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,n),t}}}var V=n("Xd5/"),B=n("xkcG"),G=n("MXaZ"),X=n("Ae6N");let U;class q extends x{constructor(t,e,n,r,a,i){super(t,e,n,r,a,i),U=t}getDataXmlInternal(){let t=this.getValue();null!==t&&(t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes()));const e=Object(T.CrmXmlEncode)(this.getName());let n="";return n+=`<${e}>`,n+=""+(null===t?"":Object(T.CrmXmlEncode)(t.format("s"))),n+=`</${e}>`,n}getValue(){const t="ClientApi.XrmEntityAttributeDateTime.getValue";try{o.a.instance.reportCall(t);const e=this.getValueInternal();let n=null;if(Object(i.j)(e)&&!Object(y.a)(e.formatted)){const t=this.getAttrDescriptor();n=Object(N.b)(U.getState(),t,e)}return o.a.instance.reportSuccess(t),n}catch(e){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}_userSettings(){return this.xrmFormUi.formContext.context?this.xrmFormUi.formContext.context.userSettings:new B.a(U)}getUtcValue(){const t="ClientApi.XrmEntityAttributeDateTime.getUtcValue";try{o.a.instance.reportCall(t);const e=this.getValue();return o.a.instance.reportSuccess(t),e}catch(e){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}setValue(t){const e="ClientApi.XrmEntityAttributeDateTime.setValue";Object(y.a)(t)||"[object Date]"!==Object.prototype.toString.call(t)&&Object(y.k)(e,"Date","value");try{if(o.a.instance.reportCall(e),Object(y.a)(t))this.setValueInternal(t);else if("[object Date]"===Object.prototype.toString.call(t)){const e=new Date,n=this.getAttrDescriptor(),r=Object(V.z)(U.getState(),n),a=6e4*this._userSettings().getTimeZoneOffsetMinutes(),i=Object(G.o)(new Date(e.getFullYear(),e.getMonth(),e.getDate()),r.userSettings.timeZoneAdjusters)-Object(G.o)(t,r.userSettings.timeZoneAdjusters),s=6e4*t.getTimezoneOffset();let o=null;switch(r.controlAttributes.Behavior){case X.a.UserLocal:o=new Date(t.getTime()+s+a-i);break;default:o=new Date(t.getTime())}this.setValueInternal(o)}o.a.instance.reportSuccess(e)}catch(t){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,n),t}}setUtcValue(t){const e="ClientApi.XrmEntityAttributeDateTime.setUtcValue";try{o.a.instance.reportCall(e),this.setValue(t),o.a.instance.reportSuccess(e)}catch(t){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,n),t}}getAttributeType(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributeDateTime.getAttributeType"),"datetime"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let z;class H extends x{constructor(t,e,n,r,a,i){super(t,e,n,r,a,i),z=t}getIsPartyList(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributeLookup.getIsPartyList"),!1}getDataXmlInternal(){const t=this.getValue();let e="";if(null!==t&&t.length>0)e+=this.getLookupDataXml(this.getName(),t[0]);else{const t=Object(T.CrmXmlEncode)(this.getName());e+=`<${t}>`,e+=`</${t}>`}return e.toString()}getLookupDataXml(t,e){const n=Object(T.CrmXmlEncode)(t);let r="<"+n;const a=this.getEntityTypeCode(e.entityType);return a>0&&(r+=` type="${Object(T.CrmXmlAttributeEncode)(a.toString())}"`),e.entityType&&(r+=` typeName="${Object(T.CrmXmlAttributeEncode)(e.entityType)}"`),Object(y.a)(e.name)||(r+=` name="${Object(T.CrmXmlAttributeEncode)(e.name)}"`),r+=`>${Object(T.CrmXmlEncode)(e.id)}</${n}>`,r}getEntityTypeCode(t){return Object(S.p)(z.getState(),t)}setValue(t){const e="ClientApi.XrmEntityAttributeLookup.setValue";let n=null;if(t&&Array.isArray(t)&&t.length>0){let r;t.length>1?Object(y.k)(e,"LookupValue[] of size not more than one.","value"):t[0].entityType?t[0].id?a.a.tryParseOrNull(t[0].id)||Object(y.h)(e,"guid",t[0].id):Object(y.j)(e,"value[0].id"):Object(y.j)(e,"value[0].entityType");try{r=Object(h.Ob)(z.getState(),this.getPageId(),this.dataContextToken,this.getName())}catch(t){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e+".getLookupTargets",t,null,n),t}if(r&&!(r.indexOf(t[0].entityType)>-1)){const n=v.a.getInstance().getEventParameters(this.contextToken);n.push({name:"attributeName",value:this.getName()}),n.push({name:"actualValue",value:t[0].entityType}),Object(y.k)(e,"entityType","value[0].entityType",n)}try{o.a.instance.reportCall(e),r?r.indexOf(t[0].entityType)>-1&&(n=new s.a(t[0].entityType,new a.a(t[0].id),t[0].name),this.setValueInternal(n)):this.setValueInternal(n),o.a.instance.reportSuccess(e)}catch(t){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,n),t}}else this.setValueInternal(n)}getValue(){const t="ClientApi.XrmEntityAttributeLookup.getValue";try{o.a.instance.reportCall(t);const e=this.getValueInternal(),n=Object(N.d)(e);return o.a.instance.reportSuccess(t),n}catch(e){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}getAttributeType(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributeLookup.getAttributeType"),"lookup"}}var W=n("3c9R"),Y=n("IaGr");let K;class Q extends x{constructor(t,e,n,a,i,s){super(t,e,n,a,i,s),K=t,this._clientApiExecutorAttributeNumber=new r.a(t,"ClientApi.XrmEntityAttributeNumber.",n,e,[{name:"attributeName",value:a,isEventParam:!0}])}getMax(){return this._clientApiExecutorAttributeNumber.execute("getMax",()=>this.getAttrDescriptor().MaxValue)}getMin(){return this._clientApiExecutorAttributeNumber.execute("getMin",()=>this.getAttrDescriptor().MinValue)}getPrecision(){return this._clientApiExecutorAttributeNumber.execute("getPrecision",()=>Object(h.k)(K.getState(),this.getPageId(),this.dataContextToken,this.getName()))}setPrecision(t){return this._clientApiExecutorAttributeNumber.execute("setPrecision",(e,n)=>{"integer"===this.getAttributeType()&&Object(y.e)(e,"setPrecision is not valid on integer attributes",void 0,n);const r=Object(c.a)(K.getState(),this.getParent().getEntityName(),this.getName());(t<0||t>r.Precision)&&(n.push({name:"metadataPrecision",value:r.Precision}),Object(y.h)(e,"precision",t.toString(),n)),K.dispatch(Object(W.b)(this.getPageId(),this.dataContextToken,this.getName(),t))},[{name:"precision",value:t,isRequired:!0,expectedDataType:"number"}])}getValue(){return this._clientApiExecutorAttributeNumber.execute("getValue",()=>{const t=this.getValueInternal();return Object(N.f)(t,this.getAttributeType(),this.getPrecision())})}setValue(t){return this._clientApiExecutorAttributeNumber.execute("setValue",()=>{this.setValueInternal(t)},[{name:"value",value:t,expectedDataType:"number"}])}getAttributeType(){return this._clientApiExecutorAttributeNumber.execute("getAttributeType",(t,e)=>{const n=this.getAttrDescriptor().Type;switch(n){case"decimal":return"decimal";case"double":return"double";case"integer":return"integer";case"money":return"money";default:return e.push({name:"attributeType",value:n}),n?this._clientApiExecutorAttributeNumber.reportFailure(t,new Error("Unexpected number attribute type."),e):Y.a.getInstance().traceManager.getTracer(t).error("Number attribute type was not defined in metadata.",e),super.getAttributeType()}})}}var J=n("arV0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let Z;class $ extends k{constructor(t,e,n,r,a,i){super(t,e,n,r,a,i),Z=t}getInitialValue(){const t="ClientApi.XrmEntityAttributeOptionSet.getInitialValue";try{o.a.instance.reportCall(t);const e=Object(A.j)(Z.getState(),this.parentEntityReference,this.getName());let n;if(Object(J.m)(Z.getState(),this.getPageId())){const t=this.getAttrDescriptor();n=Object(N.g)(e)||t&&t.DefaultFormValue?t.DefaultFormValue:null}else n=Object(N.g)(e);return o.a.instance.reportSuccess(t),n}catch(e){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}getSelectedOption(){const t="ClientApi.XrmEntityAttributeOptionSet.getSelectedOption";try{o.a.instance.reportCall(t);const e=this.getOption(this.getValue());return o.a.instance.reportSuccess(t),e}catch(e){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}getText(){const t="ClientApi.XrmEntityAttributeOptionSet.getText";try{o.a.instance.reportCall(t);const e=this.getSelectedOption();let n=null;return e&&(n=e.text),o.a.instance.reportSuccess(t),n}catch(e){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}getValue(){const t="ClientApi.XrmEntityAttributeOptionSet.getValue";try{o.a.instance.reportCall(t);const e=this.getValueInternal(),n=Object(N.g)(e),r=Object(y.a)(n)?Object(N.f)(e,this.getAttributeType(),0):n;return o.a.instance.reportSuccess(t),r}catch(e){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}setValue(t){const e="ClientApi.XrmEntityAttributeOptionSet.setValue";t&&isNaN(t)&&Object(y.k)(e,"number","value");let n=!1;try{if(t&&this.getParent()){const e=this.getAttrDescriptor();for(const r in e.OptionSet)if(t===e.OptionSet[r].Value){n=!0;break}}else n=!0}catch(t){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e+".getAttributeDescriptor",t,null,n),t}n||Object(y.h)(e,"OptionSetValue",t);try{o.a.instance.reportCall(e),this.setValueInternal(t),o.a.instance.reportSuccess(e)}catch(t){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,n),t}}getAttributeType(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributeOptionSet.getAttributeType"),"optionset"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class tt extends x{getMaxLength(){const t="ClientApi.XrmEntityAttributeString.getMaxLength";try{o.a.instance.reportCall(t);const e=this.getAttrDescriptor().MaxLength;return o.a.instance.reportSuccess(t),e}catch(e){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}getValue(){const t="ClientApi.XrmEntityAttributeString.getValue";try{o.a.instance.reportCall(t);const e=this.getValueInternal(),n=Object(N.i)(e);return o.a.instance.reportSuccess(t),n}catch(e){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}setValue(t){const e="ClientApi.XrmEntityAttributeString.setValue";Object(y.a)(t)||"string"!=typeof t&&Object(y.k)(e,"string","value");try{o.a.instance.reportCall(e),this.setValueInternal(t),o.a.instance.reportSuccess(e)}catch(t){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,n),t}}getAttributeType(){const t="ClientApi.XrmEntityAttributeString.getAttributeType";try{let e;o.a.instance.reportCall(t);const n=this.getAttrDescriptor().Type;switch(n){case"memo":e="memo";break;case"string":e="string";break;default:const r=v.a.getInstance().getEventParameters(this.contextToken);r.push({name:"attributeName",value:this.getName()}),r.push({name:"attributeType",value:n}),v.a.getInstance().reportFailure(t,new Error("Unexpected string attribute type."),null,r),e=super.getAttributeType()}return o.a.instance.reportSuccess(t),e}catch(e){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class et extends x{constructor(t,e,n,a,i,s){super(t,e,n,a,i,s),this._clientApiExecutor=new r.a(t,"ClientApi.XrmEntityAttributeUniqueIdentifier.",n,e),this._clientApiExecutor.addEventParameter({name:"attributeName",value:a,isEventParam:!0})}setValue(t){this._clientApiExecutor.execute("setValue",()=>{this.setValueInternal(a.a.tryParseOrNull(t))},[{name:"value",value:t,expectedDataType:"guid"}])}getValue(){return this._clientApiExecutor.execute("getValue",()=>{const t=this.getValueInternal();return Object(N.j)(t)})}getAttributeType(){return this._clientApiExecutor.execute("getAttributeType",()=>"string")}}var nt=n("nVTU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let rt;class at extends H{constructor(t,e,n,r,a,i){super(t,e,n,r,a,i),rt=t}getDataXmlInternal(){const t=Object(T.CrmXmlEncode)(this.getName()),e=this.getValue();let n="";return n+=`<${t}>`,e.forEach(t=>{n+="<activityparty>",n+=this.getLookupDataXml("partyid",t),n+="</activityparty>"}),n+=`</${t}>`,n.toString()}setValue(t){const e="ClientApi.XrmEntityAttributePartyList.setValue",n=v.a.getInstance().getEventParameters(this.contextToken);let r;n.push({name:"attributeName",value:this.getName()}),t&&(Array.isArray(t)||Object(y.k)(e,"LookupValue[]","value",n));const a=new Array;try{r=Object(h.Ob)(rt.getState(),this.getPageId(),this.dataContextToken,this.getName())}catch(t){throw v.a.getInstance().reportFailure(e+".getLookupTargets",t,null,n),t}t&&r&&(r.push("unresolvedaddress"),t.forEach(t=>{r.indexOf(t.entityType)>-1||(n.push({name:"entityType",value:t.entityType}),Object(y.e)(e,`LookupValue[] with invalid entity type. Entity type "${t.entityType}" is invalid.`,"LookupValue[] with invalid entity type",n))}));try{o.a.instance.reportCall(e),t?(r?t.forEach(t=>{r.indexOf(t.entityType)>-1&&a.push(new nt.a(t.entityType,t.id,t.name))}):t.forEach(t=>{a.push(new nt.a(t.entityType,t.id,t.name))}),this.setValueInternal(a)):this.setValueInternal([]),o.a.instance.reportSuccess(e)}catch(t){throw v.a.getInstance().reportFailure(e,t,null,n),t}}getValue(){const t="ClientApi.XrmEntityAttributePartyList.getValue";try{o.a.instance.reportCall(t);const e=this.getValueInternal(),n=Object(N.h)(e);return o.a.instance.reportSuccess(t),n}catch(e){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}getIsPartyList(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributePartyList.getIsPartyList"),!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class it extends x{constructor(t,e,n,a,i,s){super(t,e,n,a,i,s),this._clientApiExecutorAttributeFile=new r.a(t,"ClientApi.XrmEntityFile.",n,e,[{name:"attributeName",value:a,isEventParam:!0}])}getValue(){return this._clientApiExecutorAttributeFile.execute("getValue",()=>{const t=this.getValueInternal();return Object(N.c)(t)})}setValue(t){this._clientApiExecutorAttributeFile.execute("setValue",()=>{this.setValueInternal(t)})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let st;class ot extends x{constructor(t,e,n,r,a,i){super(t,e,n,r,a,i),st=t}getValue(){const t="ClientApi.XrmEntityAttributeEntityName.getValue";try{o.a.instance.reportCall(t);const e=this.getValueInternal(),n=Object(c.a)(st.getState(),this.getParent().getEntityName(),this.getName());let r=null;return n.IsEntityReferenceStored&&Object(i.j)(e)&&(r=e.value),o.a.instance.reportSuccess(t),r}catch(e){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}setValue(t){const e="ClientApi.XrmEntityAttributeEntityName.setvalue";Object(y.a)(t)||"string"==typeof t||Object(y.k)(e,"string","value");try{o.a.instance.reportCall(e),this.setValueInternal(t),o.a.instance.reportSuccess(e)}catch(t){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,n),t}}getAttributeType(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributeEntityName.getAttributeType"),"entityname"}}var ct=n("aOhN"),lt=n("Pcet"),ut=n("WY/A"),dt=n("qTme"),pt=n("Dea/"),ht=n("NPZ3"),gt=n("bGh0"),mt=n("srnJ"),bt=n("Fij2"),ft=n("pF61"),yt=n("ruPX"),vt=n("cfbi"),_t=n("P6DH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function St(t,e,n,r){const a=Object(h.z)(t,e,n,r,n.relationshipName);if(!a||0===a.length)return!0;for(let r=0;r<a.length;r++)if(!Object(h.t)(t,{controlName:a[r],id:e},n))return!0;return!1}function Ot(t,e,n,r,a,i){if(!Object(_t.K)(t,e,n,r,null==i?void 0:i.id))return!1;const s=Object(_t.y)(t,n,e);if(!a||!s)return!1;if(s&&0===s[r])return!1;if(null===a.ParentPicklistLogicalName)return!0;const o=Object(h.ac)(t,e,n),c=Object(h.X)(t,e,n,o,i,a.ParentPicklistLogicalName);return!(!c||!c.label)}var Ct=n("jRy5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let It;class Pt extends ${constructor(t,e,n,r,a,i){super(t,e,n,r,a,i),It=t}setValue(t){const e="ClientApi.XrmEntityAttributeDependentOptionSet.setValue";let n;try{o.a.instance.reportCall(e),n=this.contextToken.contextTokenType===Ct.a.MainGrid||this.contextToken.contextTokenType===Ct.a.SubGrid||this.contextToken.contextTokenType===Ct.a.AssociatedGrid?Ot(It.getState(),this.getPageId(),this.contextToken,this.getName(),this.getAttrDescriptor(),this.parentEntityReference):St(It.getState(),this.getPageId(),this.contextToken,this.getName()),o.a.instance.reportSuccess(e)}catch(t){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,n),t}n?super.setValue(t):Object(y.e)("ClientApi.XrmEntityAttributeDependentOptionSet.setValue","Can not execute setValue for dependent option set attribute since it is disabled.")}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let jt;class Tt extends L{constructor(t,e,n,r,a,i){super(t,e,n,r,a,i),jt=t}setValue(t){const e="ClientApi.XrmEntityAttributeMultiSelectDependentOptionSet.setValue";let n;try{o.a.instance.reportCall(e),n=this.contextToken.contextTokenType===Ct.a.MainGrid||this.contextToken.contextTokenType===Ct.a.SubGrid||this.contextToken.contextTokenType===Ct.a.AssociatedGrid?Ot(jt.getState(),this.getPageId(),this.contextToken,this.getName(),this.getAttrDescriptor(),this.parentEntityReference):St(jt.getState(),this.getPageId(),this.contextToken,this.getName()),o.a.instance.reportSuccess(e)}catch(t){const n=v.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,n),t}n?super.setValue(t):Object(y.e)(e,"Can not execute setValue for dependent option set attribute since it is disabled.")}}var Et=n("3/02"),Ft=n("Lyxw"),wt=n("QHx/"),xt=n("L8zx"),At=n("Exmh");let Nt;class kt{constructor(t,e,n,a,i,s,o,c){Nt=t;const l=[{name:"pageId",value:n,isEventParam:!0,isRequired:!0,expectedDataType:"string"},{name:"entityType",value:i,isEventParam:!0,isRequired:!1,expectedDataType:"string"},{name:"store",value:t,isRequired:!0},{name:"contextToken",value:e,isRequired:!0},{name:"xrmForm",value:a,isRequired:!0}];this._clientApiExecutor=new r.a(t,"ClientApi.XrmEntity.",n,e,l),this._pageId=n,this._xrmForm=a,this._contextToken=e,this._entityType=i,this._entityId=s,this._getAttributeNames=o,this._applicationContext=c}get attributes(){return this._clientApiExecutor.execute("attributes",(t,e)=>{if(!this._attributes){this._attributes=new m.a(t);const n=this._getAttributeNames(this._applicationContext,this._contextToken,this._pageId);if(!n)return this._clientApiExecutor.reportFailure(t,new Error("Entity attribute names array was null or undefined"),e),this._attributes;0===n.length&&this._clientApiExecutor.reportFailure(t,new Error("Entity attribute names array was empty."),e),n.forEach(t=>{const e=Object(c.a)(Nt.getState(),this.getEntityName(),t);if(e){const n=Dt(Nt,this._contextToken,this._pageId,t,this,this._xrmForm.ui,e);this._attributes.add(t,n)}})}return this._attributes})}get relatedEntities(){const t="ClientApi.XrmEntity.relatedEntities";try{if(o.a.instance.reportCall(t),!this._relatedEntities){this._relatedEntities=new m.a(t);const e=Object(h.oc)(Nt.getState(),{id:this._pageId},this._contextToken);for(const t in e)if(e[t]){const n=Object(_.m)(this._contextToken,t),r=new kt(Nt,n,this._pageId,this._xrmForm,e[t].etn,e[t].id,this._getAttributeNames,this._applicationContext);this._relatedEntities.add(t,r),this._updateControl(r,t)}const n=Object(h.nc)(Nt.getState(),{id:this._pageId}),r={};for(const t in n){const e=n[t];r[e.referencingAttribute]||(r[e.referencingAttribute]={}),r[e.referencingAttribute][e.referencedEntity]=t}for(const t in r)Nt.dispatch(Object(f.a)(this._contextToken,this._pageId,t,e=>{for(const e in r[t]){const n=this._relatedEntities.get(r[t][e]);n&&this._relatedEntities.remove(n)}const n=e.getEventSource().getValue();if(n&&n.length>0){const e=n[0],i=r[t][e.entityType],s=Object(_.m)(this._contextToken,i),o=new kt(Nt,s,this._pageId,this._xrmForm,e.entityType,a.a.tryParse(e.id),this._getAttributeNames,this._applicationContext);this._relatedEntities.add(i,o),this._updateControl(o,i)}},!0))}return o.a.instance.reportSuccess(t),this._relatedEntities}catch(e){const n=v.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}_updateControl(t,e){this._xrmForm&&this._xrmForm.ui&&this._xrmForm.ui.controls&&this._xrmForm.ui.controls.forEach(n=>{n instanceof gt.a&&n.updateAttribute(t,e)})}addOnSave(t){const e="ClientApi.XrmEntity.addOnSave";t||Object(y.j)(e,"handler");try{o.a.instance.reportCall(e),Nt.dispatch(Object(f.o)(this._contextToken,this._pageId,t)),o.a.instance.reportSuccess(e)}catch(t){const n=v.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),v.a.getInstance().reportFailure(e,t,null,n),t}}getDataXml(){const t="ClientApi.XrmEntity.getDataXml";try{o.a.instance.reportCall(t);let e="";return this.attributes.forEach(t=>{t.getIsDirty()&&(e+=t.getDataXmlInternal())}),e="<"+Object(T.CrmXmlEncode)(this.getEntityName())+">"+e+"</"+Object(T.CrmXmlEncode)(this.getEntityName())+">",o.a.instance.reportSuccess(t),e}catch(e){const n=v.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}getEntityReference(){const t="ClientApi.XrmEntity.getEntityReference";try{o.a.instance.reportCall(t);const e={entityType:this.getEntityName(),id:this.getId(),name:this.getPrimaryAttributeValue()};return o.a.instance.reportSuccess(t),e}catch(e){const n=v.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}getEntityName(){const t="ClientApi.XrmEntity.getEntityName";try{return o.a.instance.reportCall(t),o.a.instance.reportSuccess(t),this._entityType}catch(e){const n=v.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}getId(){const t="ClientApi.XrmEntity.getId";try{if(o.a.instance.reportCall(t),!this._entityId||this._entityId&&this._entityId.guid===a.a.EMPTYGUIDSTRING){const t=Object(J.i)(Nt.getState(),this._pageId);if(t&&t.value){const e=t.value;this._entityId=e.id}else{const t=Object(h.ac)(Nt.getState(),this._pageId,this._contextToken);if(t){const e=Object(u.b)(Nt.getState(),t);e&&e.identifier&&(this._entityId=e.identifier.id)}}}return this._entityId&&this._entityId.guid===a.a.EMPTYGUIDSTRING?(o.a.instance.reportSuccess(t),a.a.EMPTYSTRING):(o.a.instance.reportSuccess(t),a.a.externalGuid(this._entityId))}catch(e){const n=v.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}getPrimaryAttributeValue(){return this._clientApiExecutor.execute("getPrimaryAttributeValue",(t,e)=>{let n="";const r=Object(S.h)(Nt.getState(),this.getEntityName());if(r){if(!r.PrimaryNameAttribute)return n="PrimaryNameAttribute was not defined",Y.a.getInstance().traceManager.getTracer(t).error(n,e),"";{const t=Object(h.ac)(Nt.getState(),this._pageId,this._contextToken),e=this.getId()?new s.a(this.getEntityName(),new a.a(this.getId())):new s.a(this.getEntityName()),o=Object(h.X)(Nt.getState(),this._pageId,this._contextToken,t,e,r.PrimaryNameAttribute);if(!o)return"";if(Object(i.j)(o))return o.value;n="PrimaryAttribute value was not an IPlainValue"}}else n="Entity descriptor could not be retrieved.";return v.a.getInstance().reportFailure(t,new Error(n),null,e),""})}getIsDirty(){const t="ClientApi.XrmEntity.getIsDirty";try{o.a.instance.reportCall(t);for(let e=0;e<this.attributes.getLength();e++){const n=this.attributes.get(e);if("never"!==n.getSubmitMode()&&n.getIsDirty())return o.a.instance.reportSuccess(t),!0}for(let e=0;e<this.relatedEntities.getLength();e++){if(this.relatedEntities.get(e).getIsDirty())return o.a.instance.reportSuccess(t),!0}return o.a.instance.reportSuccess(t),!1}catch(e){const n=v.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}removeOnSave(t){const e="ClientApi.XrmEntity.removeOnSave";t||Object(y.j)(e,"handler");try{o.a.instance.reportCall(e),Nt.dispatch(Object(f.J)(this._contextToken,this._pageId,t)),o.a.instance.reportSuccess(e)}catch(t){const n=v.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),v.a.getInstance().reportFailure(e,t,null,n),t}}save(t){this._clientApiExecutor.executeAsync("save",(e,n)=>{let r=1;if(t)if("string"==typeof t)switch(t){case"save":r=1;break;case"saveandclose":r=2;break;case"saveandnew":r=59}else t.saveMode&&(r=t.saveMode);const a=Nt.getState();return Object(xt.b)(this._pageId,Nt,r,n,this._contextToken,this,!1,"saveandclose"!==t).then(e=>this._performAfterSaveLogic(a,e,t))})}isValid(){const t="ClientApi.XrmEntity.isValid";try{if(o.a.instance.reportCall(t),this.attributes)for(let e=0;e<this.attributes.getLength();e++){const n=this.attributes.get(e);if(this._attributeHasActiveControl(n)&&!n.isValid()||n.hasErrorNotification())return o.a.instance.reportSuccess(t),!1}if(this.relatedEntities)for(let e=0;e<this.relatedEntities.getLength();e++)if(!this.relatedEntities.get(e).isValid())return o.a.instance.reportSuccess(t),!1;return o.a.instance.reportSuccess(t),!0}catch(e){const n=v.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),v.a.getInstance().reportFailure(t,e,null,n),e}}setRecordId(t){const e="ClientApi.XrmEntity.setRecordId";t||Object(y.j)(e,"id");try{if(o.a.instance.reportCall(e),this.getId()&&this._entityId.guid!==a.a.EMPTYGUIDSTRING)o.a.instance.reportSuccess(e);else{const n=a.a.tryParse(t);a.a.isNullOrEmpty(n)&&Object(y.j)(e,"id");const r={},i=Nt.getState(),c=Object(h.ac)(i,this._pageId,this._contextToken),l=Object(_.x)(this._contextToken);if(c){const t=new s.a(this.getEntityName(),n);Nt.dispatch(Object(lt.b)(c,t)),o.a.instance.reportSuccess(e)}else{const t=Object(ut.b)(i,new s.a(this.getEntityName(),n),r,l,pt.a.Create),a=t.payload.snapshotId;Nt.dispatch(t),Nt.dispatch(Object(dt.b)(this._pageId,a,this._contextToken)).then(()=>{o.a.instance.reportSuccess(e)}).catch(t=>{const n=v.a.getInstance().getEventParameters(this._contextToken);n.push({name:"entityName",value:this.getEntityName()}),v.a.getInstance().reportFailure(e+".setDataSnapshotId",t,null,n)})}}}catch(t){const n=v.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),v.a.getInstance().reportFailure(e,t,null,n),t}}refresh(){const t="ClientApi.XrmEntity.refresh";try{if(o.a.instance.reportCall(t),this.getId()){const e=new s.a(this.getEntityName(),new a.a(this.getId())),n=[],r=[];for(let t=0;t<this.attributes.getLength();t++)r.push(this.attributes.get(t).getName());const i=Object(ht.a)(Nt.getState(),e.etn);if(i&&r.push(...i),n.push(Nt.dispatch(Object(mt.a)(this._pageId,e,r,new At.a(s.a.toLegacyEntityReference(e),null,null)))),this.relatedEntities)for(let t=0;t<this.relatedEntities.getLength();t++)n.push(this.relatedEntities.get(t).refresh());return Promise.all(n).then(()=>{Object(bt.b)(this),o.a.instance.reportSuccess(t)}).catch(e=>{const n=v.a.getInstance().getEventParameters(this._contextToken);return n.push({name:"entityName",value:this.getEntityName()}),Object(y.d)(Nt,e,t,n)})}return o.a.instance.reportSuccess(t),Promise.resolve(null)}catch(e){const n=v.a.getInstance().getEventParameters(this._contextToken);return n.push({name:"entityName",value:this.getEntityName()}),Object(y.d)(Nt,e,t,n)}}_attributeHasActiveControl(t){if(t&&t.controls){const e=t.controls.getLength();for(let n=0;n<e;n++)if(!t.controls.get(n).getDisabled())return!0}return!1}_performAfterSaveLogic(t,e,n){const r=Object(h.kb)(Nt.getState(),{id:this._pageId},this._contextToken);if(e||!this.getIsDirty()||r)if(Object(bt.b)(this),"saveandclose"===n){if(!Object(bt.a)(Object(ft.b)(Nt.getState())===this._pageId)){const e=Object(h.Kb)(t,this._pageId),n=Object(h.Ib)(t,this._pageId);if(!e&&!n){const t=Object(wt.a)(Nt.getState(),this._pageId);return Nt.dispatch(Object(ct.b)(t))}}}else if("saveandnew"===n){const t={entityTypeName:this.getEntityName()};return Nt.dispatch(Object(yt.a)(vt.a,t,this._pageId))}return Promise.resolve()}}function Dt(t,e,n,r,a,i,s){let o=null,l=!1;switch(s.Type){case"datetime":o=new q(t,e,n,r,a,i);break;case"decimal":case"double":case"integer":case"money":o=new Q(t,e,n,r,a,i);break;case"lookup":case"owner":case"customer":o=new H(t,e,n,r,a,i);break;case"partylist":o=new at(t,e,n,r,a,i);break;case"memo":case"string":o=new tt(t,e,n,r,a,i);break;case"picklist":if(l=Object(Ft.c)(t.getState(),Et.L),l&&Object(c.l)(t.getState(),s.EntityLogicalName,r)){o=new Pt(t,e,n,r,a,i);break}case"optionset":case"state":case"status":o=new $(t,e,n,r,a,i);break;case"boolean":o=new R(t,e,n,r,a,i);break;case"entityname":o=new ot(t,e,n,r,a,i);break;case"uniqueidentifier":o=new et(t,e,n,r,a,i);break;case"multiselectpicklist":l=Object(Ft.c)(t.getState(),Et.L),o=l&&Object(c.l)(t.getState(),s.EntityLogicalName,r)?new Tt(t,e,n,r,a,i):new L(t,e,n,r,a,i);break;case"file":o=new it(t,e,n,r,a,i);break;default:o=new x(t,e,n,r,a,i)}return o}},Utin:function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return i}));var r=n("dHD5"),a=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="control.update.parameter";function s(t,e,n,s,o){return{type:"control.update.parameter.async",execute({dispatch:c,getState:l},u){const d=a.x+".updateControlParameterAction";c(function(t,e,n,s,o){const c=Object(r.v)(o);return{type:i,payload:{name:n,value:s},meta:{pageId:t,dataSetContextKey:c,controlName:a.o}}}(t,0,n,s,o));const p=[];return p.push({name:"controlName",value:e}),p.push({name:"paramName",value:""+n}),u.EventManager.ReportComponentSuccess(d,p),Promise.resolve()}}}},VpHT:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var r=n("NjDY"),a=n("99zj"),i=n("V6aM"),s=n("3mEc"),o=n("69Qu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c=["JQUERY","JQUERY.JS"];let l,u,d;function p(t){return{type:"customcontrol.loadresources",execute({dispatch:e,getState:n},p){const h=[],g=n(),m=Object(r.t)(g),b=t.Properties.Resources.filter((t,e,n)=>(0===t.Type||4===t.Type||1===t.Type)&&!(t.LibraryName&&-1!==c.indexOf(t.LibraryName.toUpperCase())||p.AssetLoader.isResourceLoaded(m+t.Name))).sort((t,e)=>t.LoadOrder-e.LoadOrder),f=t.Properties.Resources.filter((t,e,n)=>5===t.Type);if(b.length>0){let t;const n=()=>function(t,e,n,r,a){const s=[];for(let o=0;o<a.length;o++){const c=a[o];let u,d=c.Name,p=n;if(l&&l[c.Name])p=window.__public_path__+"control",d=l[c.Name];else if(0===c.Type){const t=c.LibraryName+".js";l&&l[t]&&(p=window.__public_path__+"control",d=l[t])}switch(c.Type){case 0:case 4:u=r.loadWebResource(d,p,3,e=>t(Object(i.a)(e)),e,!1);break;case 1:u=u=r.loadWebResource(d,p,2,e=>t(Object(i.a)(e)),e);break;default:u=null}u&&s.push(u)}return Promise.all(s)}(e,!Object(o.b)(g),m,p.AssetLoader,b);t=!function(){null==d&&(d=window.location.search.toLocaleLowerCase().indexOf("uselocal=true")>=0);return d}()||l?n():function(){if(u)return u;if("/uclient/"!==window.__public_path__){if(!l){const t=window.__public_path__+"controlFileMap.json";u=-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0?new Promise(e=>{const n=new XMLHttpRequest;n.addEventListener("load",(function(){let t={};try{t=JSON.parse(this.responseText)}catch(t){}e(t)})),n.addEventListener("error",()=>{e({})}),n.open("GET",t),n.send()}):fetch(t).then(t=>t.json(),()=>Promise.resolve({})),u.then(t=>{l=t},()=>{l={}})}}else l={},u=Promise.resolve({});return u}().then(n,n),t&&h.push(t)}const y=Object(s.k)(g);for(let t=0;t<f.length;t++)if(!y||!y.hasOwnProperty(f[t].Name)){const n=e(Object(a.c)(f[t].Name)).then(n=>{let r=!1;for(const e of n)e&&e.webResourceDescriptorsByName&&e.webResourceDescriptorsByName.hasOwnProperty(f[t].Name)&&(r=!0);!r&&e(Object(a.b)(f[t].Name))});h.push(n)}return h.length>0?Promise.all(h):null},sync:!0}}},"WK+4":function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s}));var r=n("dHD5"),a=n("BFlg");const i="chart.visualizationid.update";function s(t,e,n){return{type:"chart.visualizationid.update.async",execute({dispatch:s,getState:o},c){const l=c.TraceManager.getTracer(a.z),u=a.x+".updateVisualizationIdAction";try{l.info("Updating the chart visualization id"),e||(e=Object(r.k)(o(),t));const a=Object(r.v)(e);return s(function(t,e,n){return{type:i,payload:{name:"VisualizationId",value:n},meta:{pageId:t,dataSetContextKey:e}}}(t,a,n)),c.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(t){const e="Updatation of the chart visualization id failed with error : "+t.message;c.EventManager.ReportComponentFailure(u,Error(e))}}}}},WRDA:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(t){return Object(r.b)(t)?null:("{"===(t=t.trim())[0]&&"}"===t[t.length-1]&&(t=t.substring(1,t.length-1)),t.toLowerCase())}},Wdaq:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s}));var r=n("dHD5"),a=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="grid.setCommandManagerId";function s(t,e,n){return{type:"grid.setCommandManagerId.async",execute({dispatch:s,getState:o},c){const l=c.TraceManager.getTracer(a.z),u=a.x+".setCommandManagerIdAction";try{l.info("Updating the command manager id for the grid.");const a=Object(r.v)(n);return s(function(t,e,n){return{type:i,payload:e,meta:{pageId:t,dataSetContextKey:n}}}(t,e,a)),c.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(t){const e="Updating the command manager id for the grid failed with error : "+t.message;c.EventManager.ReportComponentFailure(u,Error(e))}}}}},XVX7:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return o}));var r=n("OWbt"),a=n("6Qf/"),i=n("dHD5");function s(t,e,n){const a=Object(i.v)(n),s={xrmReady:t};return{type:r.b,payload:s,meta:{pageId:e,contextKey:a}}}function o(t,e,n){const r=Object(i.u)(n),s={xrmReady:t};return{type:a.b,payload:s,meta:{pageId:e,contextKey:r}}}},Y5AI:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="form.ShowHeaderFieldsInSection.set";function i(t,e,n){const i=Object(r.v)(e);return{type:a,payload:{showHeaderFieldsInSection:n},meta:{pageId:t,contextKey:i}}}},Yexl:function(t,e,n){"use strict";n.d(e,"a",(function(){return m})),n.d(e,"b",(function(){return b}));var r=n("3/02"),a=n("SAYH"),i=n("P6DH"),s=n("Lyxw"),o=n("B9jE"),c=n("jRy5"),l=n("a72m"),u=n("KBcj"),d=n("d0w6"),p=n("BFlg"),h=n("hSDL"),g=n("jAuy");function m(t,e,n,m){return{type:"grid.quickfind.apply.async",execute({dispatch:b,getState:f},y){const v=y.TraceManager.getTracer(p.z),_=p.x+".QuickFilterAction";try{const p=f(),S=Object(i.F)(p,e,n,m);return function(t,e,n){return new Promise(r=>{const a=Object(u.a)(t,n,d.a.QUICKFIND_SEARCH);a?r(a):e(Object(l.a)(n,d.a.QUICKFIND_SEARCH,d.b.savedview)).then(t=>{r(t)})})}(p,b,S).then(l=>{v.info("Performing quick find on the grid ");const u=Object(i.T)(p,e,n,m);let S=u;const O=n.contextTokenType===c.a.SubGrid;let C=!1;if(O&&n.controlName){const t=Object(i.hb)(f(),e,n,n.controlName);t&&(C=t.EnableViewPicker)}return Object(s.a)(f(),r.Nd)&&O&&!C||Object(g.l)(p)||(S=l),b(Object(h.n)(t,e,n)),b(Object(o.a)(e,n,m,a.a.toString(S),null,d.a.QUICKFIND_SEARCH)).then(()=>(y.EventManager.ReportComponentSuccess(_),u))})}catch(t){const e="Unable to perform a quick find on the grid";y.EventManager.ReportComponentFailure(_,Error(e))}}}}function b(t,e,n,r){return{type:"grid.quickfind.clear.async",execute({dispatch:i,getState:s},c){const l=c.TraceManager.getTracer(p.z),u=p.x+".QuickFilterAction";try{return l.info("Clearing quick find from the grid."),i(Object(h.n)("",e,n)),i(Object(o.a)(e,n,r,a.a.toString(t))).then(()=>{c.EventManager.ReportComponentSuccess(u)})}catch(t){const e="Unable to clear quick find value for grid";c.EventManager.ReportComponentFailure(u,Error(e))}}}}},ZJsz:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r={queryKey:null,pageNumber:1,isNewPageRequested:!1,selectedRows:[],selectedRelatedEntity:null,filters:{},rowProperties:{records:[]},fetchXml:"",controls:{},refreshCounter:0,pagingRefreshInput:0,pagingData:"",relationshipName:null,relationshipRoleOrdinal:null,showChart:null,useRollupView:!1,chartVisualizationType:null,dependentOptionSetColumnStatus:{},chartDrillDownParameters:[]}},ZUzm:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("cfbi"),a=n("ruPX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(t,e,n,i,s,o,c,l,u){const d={entityTypeName:t.etn,id:t.id,formId:n,data:i,processId:s,processInstanceId:o,selectedStageId:c,isCrossEntityNavigate:l,recordSetQueryKey:u};return Object(a.a)(r.a,d,e)}},Zw8F:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var r=n("SAYH"),a=n("qshH"),i=n("arV0"),s=n("16wZ"),o=n("ZIjf"),c=n("rs6x"),l=n("7TDv"),u=n("+Ljw");let d;class p{constructor(t,e,n,r){this._id=t,this._label=e,d=n,this._pageId=r}getId(){const t="ClientApi.XrmFormSelectorItem.getId";try{o.a.instance.reportCall(t);const e=r.a.toString(this._id);return o.a.instance.reportSuccess(t),e}catch(e){throw a.a.getInstance().reportFailure(t,e),e}}getLabel(){return o.a.instance.reportUsage("ClientApi.XrmFormSelectorItem.getLabel"),this._label}getPageId(){return o.a.instance.reportUsage("ClientApi.XrmFormSelectorItem.getPageId"),this._pageId}setVisible(t){const e="ClientApi.XrmFormSelectorItem.setVisible";try{o.a.instance.reportCall(e),d.dispatch(Object(l.b)(this._pageId,r.a.toString(this._id),t)),o.a.instance.reportSuccess(e)}catch(t){throw a.a.getInstance().reportFailure(e,t),t}}getVisible(){const t="ClientApi.XrmFormSelectorItem.getVisible";try{o.a.instance.reportCall(t);const e=Object(u.c)(d.getState(),this._pageId,this._id);return o.a.instance.reportSuccess(t),e}catch(e){throw a.a.getInstance().reportFailure(t,e),e}}navigate(){const t="ClientApi.XrmFormSelectorItem.navigate";try{this._pageId||Object(s.j)(t,"PageId"),o.a.instance.reportCall(t);const e=Object(i.g)(d.getState(),this._pageId),n=e&&e.id?e.id.guid:"",r=Object(i.l)(d.getState(),this._pageId);d.dispatch(Object(c.a)(this._id.guid,this._pageId,r,n)).then(()=>{o.a.instance.reportSuccess(t)}).catch(e=>Object(s.d)(d,e,t+".changeForm"))}catch(e){throw a.a.getInstance().reportFailure(t,e),e}}}},"b41/":function(t,e,n){"use strict";n.d(e,"f",(function(){return r})),n.d(e,"g",(function(){return a})),n.d(e,"h",(function(){return i})),n.d(e,"i",(function(){return s})),n.d(e,"a",(function(){return o})),n.d(e,"e",(function(){return c})),n.d(e,"c",(function(){return l})),n.d(e,"d",(function(){return u})),n.d(e,"b",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r={advancedFilters:"Grid_AdvancedFilter_AdvancedFilters",cancel:"GlobalFilter_Cancel",apply:"Button_Label_Apply",addButton:"Web.SFA.Workflow.Variables.Add",addRow:"MenuItem_Label_AddRow_SentenceCase",addGroup:"MenuItem_Label_AddGroup_SentenceCase",deleteExpression:"Web.SFA.Workflow.Variables.Delete",moveUpExpression:"Web._controls.listedit.buttons.MoveUp",moveDownExpression:"Web._controls.listedit.buttons.MoveDown_SentenceCas",makeGroup:"Grid_AdvancedFilter_MakeGroup",ungroup:"AF_MenuItem_UnGroup",andGroup:"AF_Text_And",orGroup:"AF_Text_Or_SentenceCase",addRelatedEntity:"MenuItem_Label_AddRelatedEntity_SentenceCase",relatedEntityPlaceholder:"Grid_AdvancedFilter_RelatedEntityPlaceholder",fieldPlaceholder:"Audit.Incontext.Filters.AttributesGroup",containsData:"Web._tools.search.search.js_12_8_SentenceCase",doesNotContainData:"Web._tools.search.search.js_12_9_SentenceCase",doesNotContainDataWarning:"Grid_AdvancedFilter_DoesNotContainDataWarning",manyToOne:"Grid_AdvancedFilter_ManyToOne",oneToMany:"Grid_AdvancedFilter_OneToMany",manyToMany:"Grid_AdvancedFilter_ManyToMany",noRelationships:"Grid_AdvancedFilter_NoRelationships",moreCommandsAriaLabel:"AF_Aria_MoreCommands",rowSelectorAriaLabel:"AF_Aria_RowSelector",groupSelectorAriaLabel:"AF_Aria_GroupSelector",groupExpandAriaLabel:"AF_MenuItem_Expand",groupCollapseAriaLabel:"AF_MenuItem_Collapse",groupExpandAriaDescription:"AF_Aria_GroupExpand",groupCollapseAriaDescription:"AF_Aria_GroupCollapse",errorQuickFind:"AF_Error_QuickFindView",errorMalformed:"Grid_AdvancedFilter_ErrorMalformed",invalidField:"Grid_AdvancedFilter_InvalidField",fieldSelectorControlLabel:"Grid_AdvancedFilter_FieldSelector",operatorSelectorControlLabel:"Web.SFA.Workflow.AssignValueDialog.Operator",errorFailedToLoad:"Grid_AdvancedFilter_FailedToLoad",fetchXmlConditionWarning:"Grid_AdvancedFilter_FetchXmlConditionWarning"},a=Object.values(r),i={contains:"SystemCustomization.BusinessRules.ConditionOperator.CONTAINS",doesNotContain:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTCONTAIN",beginsWith:"SystemCustomization.BusinessRules.ConditionOperator.BEGINSWITH",doesNotBeginWith:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTBEGINWITH",endsWith:"SystemCustomization.BusinessRules.ConditionOperator.ENDSWITH",doesNotEndWith:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTENDWITH",containsData:"SystemCustomization.BusinessRules.ConditionOperator.NOTNULL",doesNotContainData:"SystemCustomization.BusinessRules.ConditionOperator.ISNULL",equals:"CustomControl_Grid_Filtering_ConditionOperator_Equals",doesNotEqual:"CustomControl_Grid_Filtering_ConditionOperator_DoesNotEqual",greaterThan:"CustomControl_Grid_Filtering_ConditionOperator_Greater",greaterThanOrEqualTo:"CustomControl_Grid_Filtering_ConditionOperator_GreaterOrEqual",lessThan:"CustomControl_Grid_Filtering_ConditionOperator_Less",lessThanOrEqualTo:"CustomControl_Grid_Filtering_ConditionOperator_LessOrEqual",dateQuarter:"ViewDesigner.RecordFilter.quarter",dateFiscalYear:"FiscalYear_Format_String_NoSpace",on:"Web._tools.search.search.js_16_0",onOrAfter:"CustomControl_Grid_Filtering_ConditionOperator_OnOrAfter",onOrBefore:"ViewDesigner.RecordFilter.on_or_before",yesterday:"Web._tools.search.search.js_16_3",today:"Web._tools.search.search.js_16_4",tomorrow:"Web._tools.search.search.js_16_5",nextSevenDays:"Web._tools.search.search.js_16_6",lastSevenDays:"Web._tools.search.search.js_16_7_SentenceCase",nextWeek:"Web._tools.search.search.js_16_8_SentenceCase",lastWeek:"Web._tools.search.search.js_16_9_SentenceCase",thisWeek:"Web._tools.search.search.js_16_10_SentenceCase",nextMonth:"Web._tools.search.search.js_16_11_SentenceCase",lastMonth:"Web._tools.search.search.js_16_12_SentenceCase",thisMonth:"Web._tools.search.search.js_16_13_SentenceCase",nextYear:"Web._tools.search.search.js_16_14_SentenceCase",lastYear:"Web._tools.search.search.js_16_15_SentenceCase",thisYear:"Web._tools.search.search.js_16_16_SentenceCase",lastXHours:"AF_Option_LastXHours_SentenceCase",nextXHours:"AF_Option_NextXHours_SentenceCase",lastXDays:"AF_Option_LastXDays_SentenceCase",nextXDays:"AF_Option_NextXDays_SentenceCase",lastXWeeks:"AF_Option_LastXWeeks_SentenceCase",nextXWeeks:"AF_Option_NextXWeeks_SentenceCase",lastXMonths:"AF_Option_LastXMonths_SentenceCase",nextXMonths:"AF_Option_NextXMonths_SentenceCase",lastXYears:"AF_Option_LastXYears_SentenceCase",nextXYears:"AF_Option_NextXYears_SentenceCase",anyTime:"Search.Time.Range.Anytime",olderThanXMinutes:"AF_Option_OlderThanXMinutes_SentenceCase",olderThanXHours:"AF_Option_OlderThanXHours_SentenceCase",olderThanXDays:"AF_Option_OlderThanXDays_SentenceCase",olderThanXWeeks:"AF_Option_OlderThanXWeeks_SentenceCase",olderThanXMonths:"AF_Option_OlderThanXMonths_SentenceCase",olderThanXYears:"AF_Option_OlderThanXYears_SentenceCase",inFiscalYear:"AF_Option_InFiscalYear_SentenceCase",lastFiscalYear:"AF_Option_LastFiscalYear_SentenceCase",thisFiscalYear:"AF_Option_ThisFiscalYear_SentenceCase",nextFiscalYear:"AF_Option_NextFiscalYear_SentenceCase",lastXFiscalYears:"AF_Option_LastXFiscalYears_SentenceCase",nextXFiscalYears:"AF_Option_NextXFiscalYears_SentenceCase",inFiscalPeriod:"AF_Option_InFiscalPeriod_SentenceCase",lastFiscalPeriod:"AF_Option_LastFiscalPeriod_SentenceCase",thisFiscalPeriod:"AF_Option_ThisFiscalPeriod_SentenceCase",nextFiscalPeriod:"AF_Option_NextFiscalPeriod_SentenceCase",lastXFiscalPeriods:"AF_Option_LastXFiscalPeriods_SentenceCase",nextXFiscalPeriods:"AF_Option_NextXFiscalPeriods_SentenceCase",inFiscalPeriodAndYear:"AF_Option_InFiscalPeriodAndYear_SentenceCase",inOrAfterFiscalPeriodAndYear:"AF_Option_InOrAfterFiscalPeriod_SentenceCase",inOrBeforeFiscalPeriodAndYear:"AF_Option_InOrBeforeFiscalPeriod_SentenceCase",containValues:"Web._tools.search.search.js_17_4_SentenceCase",doesNotContainValues:"Web._tools.search.search.js_17_5_SentenceCase",equalsCurrentUserLanguage:"AF_Option_EqUserLanguage_SentenceCase",isCurrentUser:"Web._tools.search.search.js_17_0_SentenceCase",notCurrentUser:"Web._tools.search.search.js_17_1_SentenceCase",isCurrentBusinessUnit:"Web._tools.search.search.js_19_1_SentenceCase",notCurrentBusinessUnit:"Web._tools.search.search.js_19_2_SentenceCase",under:"Web.SFA.Workflow.UnderOperator",notUnder:"Web.SFA.Workflow.NotUnderOperator",above:"ViewDesigner.RecordFilter.above",viewAll:"CustomControl_Calendar_ViewMore",aboveOrEqual:"ViewDesigner.RecordFilter.eq_or_above_SentenceCase",underOrEqual:"ViewDesigner.RecordFilter.eq_or_under_SentenceCase",isCurrentUserOrReportingHierarchy:"OwnershipOperator_EqualsCurrentUserOrHierarchy_SentenceCase",isCurrentUserAndTeamsOrReportingHierarchyAndTeams:"OwnershipOperator_EqualsCurrentUserOrHierarchyAndTeams_SentenceCase",isCurrentUserTeams:"OwnershipOperator_EqualsCurrentUserTeams_SentenceCase",isCurrentUserOrTeams:"OwnershipOperator_EqualsCurrentUserOrUserTeams_SentenceCase",loadingResults:"Grid_AdvancedFilter_LoadingResults",noResults:"KMControl.SearchKMArticles.NoResults",errorNoValues:"AF_Error_NoValues",inputControlLabel:"Web.SFA.Workflow.AssignValueDialog.Value",removeButtonAriaLabel:"Dialog_Disassociate_Header",noValue:"Grid_AdvancedFilter_NoValue",minValue:"Grid_AdvancedFilter_MinValue",maxValue:"Grid_AdvancedFilter_MaxValue",maxPrecision:"Grid_AdvancedFilter_MaxPrecision",maxLength:"Grid_AdvancedFilter_MaxLength",incorrectDataType:"Grid_AdvancedFilter_IncorrectDataType",durationUnit:"Grid_AdvancedFilter_durationUnit"},s=Object.values(i),o={dropDownOptionsAll:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsAll",dropDownOptionsDefault:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsDefault",dropDownOptionsCustom:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsCustom",fieldContextMenuRemove:"Grid_AdvancedFilter_ColumnEditor_FieldContextMenuRemove",addColumn:"Grid_AdvancedFilter_ColumnEditor_AddColumn",editColumns:"Grid_AdvancedFilter_ColumnEditor_EditColumns",apply:"Grid_AdvancedFilter_ColumnEditor_Apply",cancel:"Grid_AdvancedFilter_ColumnEditor_Cancel",search:"Grid_AdvancedFilter_ColumnEditor_Search",related:"Grid_AdvancedFilter_ColumnEditor_Related",moveUp:"Grid_AdvancedFilter_ColumnEditor_MoveUp",moveDown:"Grid_AdvancedFilter_ColumnEditor_MoveDown",resetToDefault:"Grid_AdvancedFilter_ColumnEditor_ResetToDefault",close:"Grid_AdvancedFilter_ColumnEditor_Close",listAriaLabel:"Grid_AdvancedFilter_ColumnEditor_AttributesListLabel",columnEditor:"Grid_AdvancedFilter_ColumnEditor_ColumnEditor",saveAsNewView:"Grid_AdvancedFilter_ColumnEditor_SaveAsNewView",saveChangesToCurrentView:"Grid_AdvancedFilter_ColumnEditor_SaveChangesToCurrentView",noFieldsToDisplay:"Grid_AdvancedFilter_ColumnEditor_NoFieldsToDisplay",moreOptions:"Grid_AdvancedFilter_ColumnEditor_MoreOptions",dropdown:"Grid_AdvancedFilter_ColumnEditor_Dropdown"},c=Object.values(o),l={ApplyAdvancedFiltersTitle:"Grid_AdvancedFilter_ApplyAdvancedFiltersTitle",ApplyAdvancedFiltersAria:"Grid_AdvancedFilter_ApplyAdvancedFiltersAriaLabel",CancelEditingFiltersAria:"Grid_AdvancedFilter_CancelEditingAdvancedFiltersAriaLabel",OpenAdvancedFiltersTitleAndAria:"Grid_AdvancedFilter_OpenAdvancedFilterTitleAndAria",resetToDefault:"Grid_AdvancedFilter_ColumnEditor_ResetToDefault"},u=Object.values(l),d=[...a,...s,...u]},bGh0:function(t,e,n){"use strict";n.d(e,"a",(function(){return y}));var r=n("PUjk"),a=n("HcnX"),i=n("odYE"),s=n("Khp3");class o{constructor(t,e,n,r){this.eventName="BusinessRuleRecommendation_"+t,this.eventParameters=[{name:"EntityTypeName",value:e},{name:"FieldName",value:n},{name:"Title",value:r}]}}var c=n("qshH"),l=n("16wZ"),u=n("i1f0"),d=n("LbMF"),p=n("Qn2w"),h=n("SAYH"),g=n("uhZ3"),m=n("IaGr");var b=n("ZIjf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let f;class y extends a.a{constructor(t,e,n,r,a,i){super(t,e,n,r,a,i),this._entityAttribute=null,f=t,this.registerObserversForControlStateChange()}getAttribute(){const t="ClientApi.XrmDataControl.getAttribute";try{if(b.a.instance.reportCall(t),!this._entityAttribute){let t;if(this.formContext&&this.formContext.data&&this.formContext.data.entity&&(t=this.controlDescriptor&&this.controlDescriptor.Relationship?this.formContext.data.entity.relatedEntities.get(this.controlDescriptor.Relationship):this.formContext.data.entity),this.controlDescriptor&&this.controlDescriptor.DataFieldName&&this.formContext&&this.formContext.data)if(this.controlDescriptor.IsUnbound)this._entityAttribute=this.formContext.data.attributes.get(this.controlDescriptor.DataFieldName);else{const e=t?t.attributes:this.formContext.data.attributes;this._entityAttribute=e.get(this.controlDescriptor.DataFieldName)}}return b.a.instance.reportSuccess(t),this._entityAttribute}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}updateAttribute(t,e){const n="ClientApi.XrmDataControl.updateAttribute";try{if(b.a.instance.reportCall(n),t&&e&&this.controlDescriptor&&this.controlDescriptor.Relationship===e){this._entityAttribute=null;const e=t.attributes;e&&(this._entityAttribute=e.get(this.controlDescriptor.DataFieldName))}this._entityAttribute&&this._entityAttribute.controls.add(this.name,this),b.a.instance.reportSuccess(n)}catch(t){const e=c.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(n,t,null,e),t}}addNotification(t){const e="ClientApi.XrmDataControl.addNotification";try{if(b.a.instance.reportCall(e),this._isValidNotification(t)&&this.getVisible()){const n={uniqueId:t.uniqueId?t.uniqueId:"",messages:t.messages,notificationLevel:t.notificationLevel,actions:t.actions};return"RECOMMENDATION"===t.notificationLevel?this._reportAddNotificationEvent(t):f.dispatch(Object(p.b)(this.pageId,this.getName(),!1,this.contextToken)),f.dispatch(Object(s.b)(this.pageId,this.getName(),n,this.contextToken)),b.a.instance.reportSuccess(e),!0}return b.a.instance.reportSuccess(e),!1}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}_clearControlNotification(t){const e=Object(u.A)(f.getState(),{controlName:this.name,id:this.pageId},this.contextToken);if(e){const n=Object.keys(e);let r=null;if(t){if(r=e[t],!(r&&r.messages&&r.notificationLevel))return!1;this._clearNotification(r)}else(Object(l.a)(t)||0===t.trim().length)&&n.forEach(t=>{r=e[t],this._clearNotification(r)});return!0}return!1}_clearNotification(t){t.actions=null,t.messages=null,t.notificationLevel=null,f.dispatch(Object(s.b)(this.pageId,this.name,t,this.contextToken))}clearNotification(t){const e="ClientApi.XrmDataControl.clearNotification";try{b.a.instance.reportCall(e);const n=!!this._clearControlNotification(t);return b.a.instance.reportSuccess(e),n}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}setNotification(t,e){const n="ClientApi.XrmDataControl.setNotification";try{b.a.instance.reportCall(n);const r={uniqueId:e,messages:[t],priority:0,notificationLevel:"ERROR",actions:[{actions:[function(){}],message:""}]};return b.a.instance.reportSuccess(n),this.addNotification(r)}catch(t){const e=c.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(n,t,null,e),t}}_isValidNotification(t){return!(!t||!t.messages||Object(g.b)(t.messages[0]))&&("RECOMMENDATION"===t.notificationLevel||"ERROR"===t.notificationLevel)}_reportAddNotificationEvent(t){if(!this._isValidNotification(t))return;const e=t.messages[0],n=new o("Added",this.contextToken.entityTypeName,this.getName(),e);var r;f.dispatch((r=n,{type:"report.xrm.event",execute(t,e){try{c.a.getInstance().reportEvent(r)}catch(t){const e="ClientApi.ReportXrmEventAction.reportXrmEvent";m.a.getInstance().eventManager.ReportComponentFailure(e,t),Object(l.j)(e,"XrmReporting")}return Promise.resolve()}}))}getEntityReference(){const t=this.formContext.entityReference,e=t.id?new h.a(t.id):null;return new i.a(t.entityType,e)}registerObserversForControlStateChange(){if(this.getName().startsWith("header_process")){const t=Object(r.a)(this.pageId);t&&this.controlStateObservable.registerObserver(t)}}getAttrDescriptor(t,e,n){const r=this.getEntityReference().etn;let a=Object(u.r)(f.getState(),r,this.name,this.pageId,this.contextToken);return a||(this.controlDescriptor?this.controlDescriptor.DataFieldName?(m.a.getInstance().traceManager.getTracer(t).warn("ControlAttributeDescriptor was not found, falling back to the attribute descriptor.",e),a=Object(d.a)(f.getState(),r,this.controlDescriptor.DataFieldName),a||(e.push({name:"attributeName",value:this.controlDescriptor.DataFieldName}),e.push({name:"entityName",value:r}),n.reportFailure(t,new Error("Attribute descriptor was not found"),e))):n.reportFailure(t,new Error("Control descriptor did not have a DataFieldName"),e):n.reportFailure(t,new Error("Control descriptor was not found"),e)),a}}},bJaF:function(t,e,n){"use strict";n.d(e,"a",(function(){return oe}));var r,a=n("DRVD"),i=n.n(a),s=n("arV0"),o=n("TAjd"),c=n("uNu9"),l=n("uNLT"),u=n("tT9w"),d=n("ofgb"),p=n("+hq9"),h=n("Uv1Y"),g=n("SAYH"),m=n("+nNZ"),b=n("7tM0");!function(t){t[t.None=0]="None",t[t.Processing=1]="Processing",t[t.Completed=2]="Completed",t[t.Failure=3]="Failure",t[t.Invalid=4]="Invalid"}(r||(r={}));class f{constructor(t,e){this._getState=t,this._processId=e}GenerateMessageForAction(t){let e="";const n="cc_MscrmControls.Containers.ProcessBreadCrumb/strings/ProcessControlResources",a=this._getState(),i=Object(b.a)(a,n,"ProcessControl_ActionExecuter_ExecutionTimeTooltip"),s=Object(b.a)(a,n,"ProcessControl_ActionExecuter_ErrorMessageTooltip"),o=Object(b.a)(a,n,"Crm_GenericErrorMessage");switch(t){case r.Completed:e=String.format(i,(new Date).toLocaleString());break;case r.Failure:e=String.format(i,(new Date).toLocaleString())+"\n"+String.format(s,o)}return e}GetActionMetadata(t){const e=Object(m.a)(this._getState(),new g.a(this._processId.guid));let n;return e&&e.businessProcessFlowActions&&e.businessProcessFlowActions[t]&&(n=e.businessProcessFlowActions[t]),n}InvokeProcessAction(t,e,n){return Xrm.Utility.invokeProcessActionInternal(t,n,e)}}var y=n("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function v(t){if(!t)return null;const e=function(t){const e=[];return t.forEach(t=>{const n={id:g.a.tryParse(t.Id),primaryField:t.PrimaryField,entityTypeCode:t.EntityTypeCode,entityLogicalName:t.EntityLogicalName,primaryKeyName:t.PrimaryKeyName};e.push(n)}),e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(t.NavigationEntities);return{entityDisplayName:t.EntityDisplayName,entityLogicalName:t.EntityLogicalName,entityTypeCode:t.entityTypeCode,showCreate:t.ShowCreate,navigationEntities:e}}function _(t,e,n,r){return{type:"businessProcessFlow.retrieveNavigationEntities.async",execute:({dispatch:a,getState:i},s)=>function(t,e,n,r,a){return t.retrieveNavigationEntities(e,n,r,a,null).nativePromise().then(v,h.b)}(s.DataSource,t,e,n,r)}}var S=n("rodW"),O=n("bCAK"),C=n("LFkE");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class I{constructor(t,e){this.Target=t,this.NewProcess=e}getMetadata(){return{boundParameter:null,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcess:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}},operationName:"SetProcess",operationType:0}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class P{constructor(t,e,n){this.Target=t,this.NewProcess=e,this.NewProcessInstance=n}getMetadata(){return{boundParameter:null,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcess:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcessInstance:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}},operationName:"SetProcess",operationType:0}}}var j=n("w72X"),T=n("EHQq");function E(t,e,n,r,a,i){return{type:"businessProcessFlow.navigateToNextEntity.async",execute:({dispatch:s,getState:o},c)=>function(t,e,n,r,a,i,s){const o=new T.a(g.a.toLegacyGuid(e.id),e.etn,g.a.toLegacyGuid(n.id),n.etn,g.a.toLegacyGuid(r),a,g.a.toLegacyGuid(i),g.a.toLegacyGuid(s));return t.execute(o,null).nativePromise()}(c.DataSource,t,e,n,r,a,i)}}var F=n("sNgR");class w{constructor(t,e){this.EntityId=t,this.EntityLogicalName=e}getMetadata(){return{boundParameter:null,parameterTypes:{EntityId:{typeName:"Edm.Guid",structuralProperty:1},EntityLogicalName:{typeName:"Edm.String",structuralProperty:1}},operationName:"RetrieveProcessInstances",operationType:1}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class x{constructor(t,e){this.EntityLogicalName=t,this.AppModuleId=e}getMetadata(){return{boundParameter:null,parameterTypes:{EntityLogicalName:{typeName:"Edm.String",structuralProperty:1},AppModuleId:{typeName:"Edm.Guid",structuralProperty:1}},operationName:"RetrieveFilteredProcesses",operationType:1}}}var A=n("E5IU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class N{constructor(t,e,n){this._name=t,this._uniqueName=e,this._workflowId=n}get workflowId(){return this._workflowId}set workflowId(t){this._workflowId=t}get uniqueName(){return this._uniqueName}set uniqueName(t){this._uniqueName=t}get name(){return this._name}set name(t){this._name=t}}var k=n("WPtp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class D{get activeStageId(){return this._activeStageId}set activeStageId(t){this._activeStageId=t}set businessProcessInstanceId(t){this._businessProcessInstanceId=t}get businessProcessInstanceId(){return this._businessProcessInstanceId}get businessProcessInstanceName(){return this._businessProcessInstanceName}set businessProcessInstanceName(t){this._businessProcessInstanceName=t}get businessProcessState(){return this._businessProcessState}set businessProcessState(t){this._businessProcessState=t}get businessProcessStatus(){return this._businessProcessStatus}set businessProcessStatus(t){this._businessProcessStatus=t}get navigationEntities(){return this._navigationEntities}set navigationEntities(t){this._navigationEntities=t}get traversedPath(){return this._traversedPath}set traversedPath(t){this._traversedPath=t}get bpfDefinitionVersionNumber(){return this._bpfDefinitionVersionNumber}set bpfDefinitionVersionNumber(t){this._bpfDefinitionVersionNumber=t}}var M=n("sxfa");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class R{get id(){return this._id}set id(t){this._id=t}get primaryField(){return this._primaryField}set primaryField(t){this._primaryField=t}get entityTypeCode(){return this._entityTypeCode}set entityTypeCode(t){this._entityTypeCode=t}get entityLogicalName(){return this._entityLogicalName}set entityLogicalName(t){this._entityLogicalName=t}get primaryKeyName(){return this._primaryKeyName}set primaryKeyName(t){this._primaryKeyName=t}}var L,V=n("hvSt");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(t){t[t.Active=0]="Active",t[t.Inactive=1]="Inactive"}(L||(L={}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class B{constructor(t){this._stageManager=t,this._populateTraversedPath()}getTraversedPath(){return this._traversedPath}_populateTraversedPath(){this._traversedPath=this._stageManager.globalPathAndActiveStage.traversedPath.path}}var G=n("blB4"),X=n("UuJw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class U extends Error{constructor(t){super(t),this.navigationStatus=G.a.invalid,this.stageInvalidReason=X.a.invalid,Object.setPrototypeOf(this,U.prototype)}}Error;class q extends Error{constructor(t){super(t),this.stageInvalidReason=X.a.unreachable,Object.setPrototypeOf(this,q.prototype)}}class z extends Error{constructor(t){super(t),this.navigationStatus=G.a.dirtyForm,this.stageInvalidReason=X.a.dirtyForm,Object.setPrototypeOf(this,z.prototype)}}class H extends Error{constructor(t){super(t),this.navigationStatus=G.a.end,Object.setPrototypeOf(this,H.prototype)}}class W extends Error{constructor(t){super(t),this.navigationStatus=G.a.beginning,Object.setPrototypeOf(this,W.prototype)}}class Y extends Error{constructor(t){super(t),this.navigationStatus=G.a.stageGate,Object.setPrototypeOf(this,Y.prototype)}}class K extends Error{constructor(t){super(t),this.navigationStatus=G.a.invalidProcess,this.stageInvalidReason=X.a.invalidProcess,Object.setPrototypeOf(this,K.prototype)}}class Q extends Error{constructor(t){super(t),this.navigationStatus=G.a.dirtyForm,this.stageInvalidReason=X.a.dirtyForm,Object.setPrototypeOf(this,Q.prototype)}}var J=n("odYE"),Z=n("mL5Q"),$=n("f/sd"),tt=n("53SR"),et=n("nexV"),nt=n("quej"),rt=n("ijzp"),at=n("WY/A"),it=n("sX6v"),st=n("P+kM"),ot=n("YYhu"),ct=n("srnJ"),lt=n("5Oca"),ut=n("Dea/"),dt=n("dHD5"),pt=n("bT7G"),ht=n("e3W2"),gt=n("WePp");class mt extends gt.a{constructor(t,e,n){super("BusinessProcessFlow_"+t),this.addEventParameter("ProcessId",e),this.addEventParameter("ProcessInstanceId",n)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class bt extends mt{constructor(t,e){super("Initialized",t,e)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ft extends mt{constructor(t,e,n){super("SetActiveStageEvent",t,e),this.addEventParameter("ActiveStageId",n)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class yt extends mt{constructor(t,e,n){super("DisplayStateEvent",t,e),this.addEventParameter("CurrentDisplayState",n)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class vt extends mt{constructor(t,e,n,r){super("StatusEvent",t,e),this.addEventParameter("ProcessStatus",n),this.addEventParameter("CurrentDisplayState",r)}}var _t=n("uzi5"),St=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Ot{getMetadata(){return{boundParameter:"entity",operationName:"ExecuteWorkflow",operationType:0,parameterTypes:{entity:{typeName:"Microsoft.Dynamics.CRM.workflow",structuralProperty:5},EntityId:{typeName:"Edm.Guid",structuralProperty:1},InputArguments:{typeName:"Microsoft.Dynamics.CRM.InputArgumentCollection",structuralProperty:2}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Ct{getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Type:{typeName:"Edm.String",structuralProperty:1},Value:{typeName:"Edm.String",structuralProperty:1}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class It{getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Count:{typeName:"Edm.Int32",structuralProperty:1},IsReadOnly:{typeName:"Edm.Boolean",structuralProperty:1},Keys:{typeName:"Edm.String",structuralProperty:4},Values:{typeName:"mscrm.AnyComplexType",structuralProperty:4}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Pt{getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Arguments:{typeName:"Microsoft.Dynamics.CRM.InputArgument",structuralProperty:2}}}}}var jt,Tt=n("+XGO"),Et=n("mIxf"),Ft=n("AFlp"),wt=n("k1f1");!function(t){t[t.ProcessAction=0]="ProcessAction",t[t.TaskFlow=1]="TaskFlow",t[t.SyncWorkflow=2]="SyncWorkflow",t[t.AsyncWorkflow=3]="AsyncWorkflow",t[t.MessageAction=4]="MessageAction"}(jt||(jt={}));var xt=n("D4Jo"),At=n("JF0K"),Nt=n("iZ7K"),kt=n("JP46");var Dt=n("ghNp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Mt=n("VcAV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Rt{constructor(t,e){this._getState=t,this._applicationContext=e}setBpfInstance(t){return this._processInstance=t,this}setBpfInstanceName(t){return this._processInstanceName=t,this}setProcess(t){return this._process=t,this}setProcessId(t){return this._processId=t,this}setFormEntity(t){return this._formEntity=t,this}GetFlowStepMetadata(t,e){const n=e.TraceManager.getTracer("businessProcessFlow.flowStepManager"),r=this._processId&&this._processId.guid||null,a=Object(m.a)(this._getState(),g.a.tryParse(r));if(Object(Mt.c)(a))return n.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined bpfDescriptor: "+a),null;const i=a.businessProcessFlowFlows;if(Object(Mt.c)(i))return n.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined businessProcessFlowFlows: "+i),null;const s=i[t];return Object(Mt.c)(i)?(n.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined flowStepDescriptor: "+s),null):s}openFlowWidget(t,e){if(g.a.tryParse(t.flowStepId)===g.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty flowStepId: "+t.flowStepId);const n=this._populateFlowDialogParams(t,e),r={height:600,width:600};Xrm.Navigation.openDialog("MicrosoftFlowsDialog",r,n)}_populateFlowDialogParams(t,e){const n=this.GetFlowStepMetadata(t.flowStepId,this._applicationContext);if(Object(Mt.c)(n))throw new Error("BPF Flow Step Failure: null metadata");const r={},a=n.flowId;if(Object(Mt.c)(a))throw new Error("BPF Flow Step Failure: null metadata.flowId");if(!this._processInstance&&!this._processInstance.id){const t=[];t.push(this._processInstance.id.guid);const e=JSON.stringify(t);r.entity_ids=e}r.flow_id=a,r.org_unique_name=Xrm.Utility.getGlobalContext().getOrgUniqueName(),r.bpf_step_id=t.flowStepId;const i=Xrm.Page.data.entity.getEntityName(),s=this._getState().metadata.entities[i].EntitySetName,o=Xrm.Utility.getGlobalContext().getAdvancedConfigSetting("MicrosoftFlowDestinationUrl");r.entity_logical_collection_name=s,r.entity_logical_name=i,r.flows_destination_url=o,r.dynamics365_access_token=sessionStorage.getItem("dynamics365AccessToken");const c=Xrm.Utility.getGlobalContext().getAdvancedConfigSetting("MicrosoftFlowFirstPartyIntegrationSiteUrl");r.flows_fpi_site_url=c+"&flowsEnableWidgetV2=true",r.flows_authentication_string=this._getLocalizedLabel("SystemCustomization.SystemSettingsDialog.PreviewTab.IsMicrosoftFlowEnabled.AuthenticateButton.Text"),r.flows_enable_widget_v2=!0,Rt.UpdateEventParameter(e,"flows_destination_url",o),Rt.UpdateEventParameter(e,"flow_id",a),Object(Mt.c)(t.workflowLogId)||t.workflowLogId===g.a.EMPTY||(r.flows_wflog_id=g.a.toString(t.workflowLogId));const l=this._processInstance&&this._processInstance.id;if(Object(Mt.c)(l)||l===g.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty processInstanceId: "+l);r.bpf_instance_id=g.a.toString(l);const u=this._processInstance&&this._processInstance.etn;if(Object(St.b)(u))throw new Error("BPF Flow Step On-Click Failure: null or empty processInstanceEntityLogicalName: "+u);r.bpf_instance_entity_name=u;const d=this._processId&&this._processId.guid||null;if(g.a.tryParse(d)===g.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty processId: "+d);r.bpf_definition_id=d,r.bpf_definition_entity_name="workflow";const p=this._process&&this._process.get_Name();if(Object(St.b)(p))throw new Error("BPF Flow Step On-Click Failure: null or undefined bpfDefinitionName: "+p);if(r.bpf_definition_name=p,Object(St.b)(this._processInstanceName))throw new Error("BPF Flow Step On-Click Failure: null or undefined processInstanceName: "+this._processInstanceName);r.bpf_instance_name=this._processInstanceName;const h=t.selectedStage&&t.selectedStage.get_Description();if(Object(St.b)(h))throw new Error("BPF Flow Step On-Click Failure: null or undefined flowStageName: "+h);r.bpf_flowstage_localized_name=h,r.bpf_flowstage_entity_name=i,r.bpf_flowstage_entity_collection_name=s;const m=this._formEntity&&this._formEntity.id;if(Object(Mt.c)(m)||m===g.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty flowStageRecordId: "+m);r.bpf_flowstage_entity_record_id=g.a.toString(m);const b=g.a.tryParseOrNull(t.activeStage&&t.activeStage.get_Id()||"");if(Object(Mt.c)(b)||b===g.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty activeStageId: "+b);r.bpf_activestage_id=g.a.toString(b);const f=t.activeStage&&t.activeStage.get_Description();if(Object(St.b)(f))throw new Error("BPF Flow Step On-Click Failure: null or undefined activeStageName: "+f);return r.bpf_activestage_localized_name=f,r.bpf_activestageentity_name="processstage",r}_getLocalizedLabel(t){return Xrm.Utility.getResourceString("Main_system_library",t)}static getTelemetryParamsForFlowStep(t,e,n,r,a){const i=a||[],s={name:"flow_id",value:t},o={name:"environment_id",value:e},c={name:"flows_destination_url",value:n},l={name:"bpf_step_id",value:r};return i.push(s),i.push(o),i.push(c),i.push(l),i}static UpdateEventParameter(t,e,n){t&&0!==t.length&&t.some(t=>{if(t.name===e)return t.value=n,!0})}}var Lt=n("Lyxw"),Vt=n("7LBy"),Bt=n("ftQm"),Gt=n("2Ct/"),Xt=n("84PK"),Ut=n("Exmh"),qt=n("cfbi"),zt=n("pF61");var Ht=n("8O0c"),Wt=n("g6bs"),Yt=n("zmL5"),Kt=n("jq7Z"),Qt=n("xMtD"),Jt=n("7Sr4"),Zt=n("1uZV"),$t=n("tICD"),te=n("E8F2"),ee=n("UqQu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ne=i.a.createEvent("Initialize","BusinessProcessFlow.ProcessManager"),re=i.a.createEvent("SetActiveStage","BusinessProcessFlow.ProcessManager"),ae=i.a.createEvent("ValidateRequiredFields","BusinessProcessFlow.ProcessManager"),ie=i.a.createEvent("CreateActiveStageSnapshot","BusinessProcessFlow.ProcessManager"),se=i.a.createEvent("SaveFormAndActiveStage","BusinessProcessFlow.ProcessManager");class oe{constructor(t,e,n,r,a){this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isUserSelectedStage=!1,this._isBpfFormValid=null,this._applicationContext=t,this._getState=e,this._dispatch=n,this._stageMetadata=r,this._activeStageManager=a}initilaizeWithProcessAndFormEntity(t,e,n,r,a,i){const s=ne.startStopwatch({processId:g.a.toString(r),processInstanceId:g.a.toString(a.id)});this._currentPageId=i,this._processId=r,this._version=e.businessProcessFlowProcessVersion,this._currentFormEntity=n,this._currentBpfInstance=a,this._stageMetadata.setPrimaryModel(this._currentFormEntity.etn),this._stageMetadata.setObjectModel(e);const o=this._createGlobalNavigationData(t);this._activeStageManager.InitGlobalPathAndActiveStage(o),this._stageMetadata.initializeDefaultPathManager(new B(this._activeStageManager),this),this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isBpfFormValid=null;const c={};if(this._isUserSelectedStage)c.selectedStageId=g.a.tryParseOrNull(this.getSelectedStageId());else{const t=this.getActiveStageId();this._isActiveStageInCurrentEntity(t)?c.selectedStageId=g.a.tryParseOrNull(t):c.selectedStageId=this._getDefaultSelectedStageId()||g.a.tryParseOrNull(t)}this._dispatch(Object(tt.a)(c,this._currentBpfInstance));const l=new bt(g.a.toString(r),g.a.toString(a.id));this._applicationContext.EventManager.ReportEvent(l),this._savedPageId!==i&&(this._savedPageId=i,this.getScriptContainerPromise().then(t=>{t&&t.getEventManager().addOnProcessChangeEvent(this.getContextToken(),()=>{this._saveCrossEntityBpf()})})),Object(Gt.f)(this._getState())||this._updateProcessInstanceModifiedTime(),this._actionStepManager=new f(this._getState,r),this._flowStepManager=new Rt(this._getState,this._applicationContext).setBpfInstance(this._currentBpfInstance).setProcess(this.getProcess()).setProcessId(this.getProcessId()).setFormEntity(this._currentFormEntity).setBpfInstanceName(this.getProcessInstanceName()),this._instanceModifiedTimestamp=Object(m.f)(this._getState(),this._currentFormEntity),this._instanceModifiedTimestamp||(this._instanceModifiedTimestamp=(new Date).getTime()),Object(Gt.f)(this._getState())&&Bt.a.Instance.setProcessManagerByPageId(this._currentPageId,this);const u=this.getTelemetryParams();if(!this._currentFormEntity){this._applicationContext.TraceManager.getTracer(At.g).error("ProcessManager is initialized with current entity as null",u)}Object(xt.c)(At.g,u,this._applicationContext),s()}_saveCrossEntityBpf(){const t=this._getState(),e=Object(s.g)(t,this._currentPageId),n=Object(Vt.a)(e),r=Object(Vt.b)(e);if(n&&r){const t=new J.a(e.data.parentrecordtype,new g.a(e.data.parentrecordid)),a=new J.a(e.entityTypeName,e.id);this._dispatch(Object(Ft.b)(n,a)),this._dispatch(Object(wt.b)(r,a)),this.navigateToNextEntityForCrossEntityBpf(t,a,n,r)}}initilaizeWithFormEntityOnly(t,e){this._currentPageId=e,this._currentFormEntity=t,this._processId=null,this._version=-1,this._currentBpfInstance=null,this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isBpfFormValid=null,Object(Gt.f)(this._getState())||this._updateProcessInstanceModifiedTime(),Object(Gt.f)(this._getState())&&Bt.a.Instance.setProcessManagerByPageId(this._currentPageId,this);const n=this.getTelemetryParams();if(!this._currentFormEntity){this._applicationContext.TraceManager.getTracer(At.f).error("ProcessManager is initialized with current entity as null",n)}Object(xt.c)(At.f,n,this._applicationContext)}setActiveProcess(t){return new Promise((e,n)=>{const r=this.getTelemetryParams();if(!this.getCurrentFormEntity()){const t=new h.a("Current form entity is not initialized.",2147877745);return Object(xt.b)(At.m,t,null,r,this._applicationContext,null,this._getState()),void n(new h.a("Current form entity is not initialized",2147877745))}const a=g.a.tryParseOrNull(t);if(!a)return Object(xt.c)(At.m,r,this._applicationContext),void n(new Error("Invalid process id"));if(g.a.isNullOrEmpty(this.getCurrentFormEntity().id))return Object(xt.c)(At.m,r,this._applicationContext),void n(new h.a("Not supported on new records",2147877748));const i=new I({id:g.a.toString(this.getCurrentFormEntity().id),entityType:this.getCurrentFormEntity().etn},{id:g.a.toString(a),entityType:c.fc});this._dispatch(Object(j.b)(i)).then(()=>{this._executePostEvent("runOnProcessChange","setActiveProcess"),Object(xt.c)(At.m,r,this._applicationContext),e()},t=>{this._dispatch(Object(u.b)(t,!0)).then(()=>n(t)),Object(xt.b)(At.m,t,null,r,this._applicationContext,null,this._getState())})})}setActiveProcessInstance(t){return new Promise((e,n)=>{const r=this.getTelemetryParams();if(!this.getCurrentFormEntity()){const t=new h.a("Current form entity is not initialized.",2147877745);return Object(xt.b)(At.n,t,null,r,this._applicationContext,null,this._getState()),void n(new h.a("Current form entity is not initialized",2147877745))}const a=g.a.tryParseOrNull(t);a?this.getProcessInstances().then(t=>{if(!t||!t.value)return void n(new Error("No process instances found for current entity"));let r="";for(const e of t.value)if(e&&e.businessprocessflowinstanceid&&e.businessprocessflowinstanceid.toLowerCase()===g.a.toString(a).toLowerCase()){r=e["a_processid_value".substring(1)];break}if(Object(St.b)(r))return void n(new h.a("Supplied process instance does not match any existing instance on this entity",2147877744));const i=g.a.tryParseOrNull(r);if(!i)return void n(new Error("Invalid process id"));const s=new P({id:g.a.toString(this.getCurrentFormEntity().id),entityType:this.getCurrentFormEntity().etn},{id:g.a.toString(i),entityType:c.fc},{id:g.a.toString(a),entityType:c.fc});this._dispatch(Object(j.b)(s)).then(()=>{this._executePostEvent("runOnProcessChange","setActiveProcessInstance"),e(r)},t=>{this._dispatch(Object(u.b)(t,!0)).then(()=>n(t))})},t=>{this._dispatch(Object(u.b)(t,!0)).then(()=>n(t))}):n(new Error("Invalid process instance id"))})}setCurrentInstance(t){this._currentBpfInstance=t}setStatus(t){return new Promise((e,n)=>{let r;if(t||n(new Error("setStatus can only be called with a valid status (active, finished, aborted")),t===V.a.Active)r=this.reactivateProcess();else if(t===V.a.Finished)r=this.completeProcess();else{if(t!==V.a.Aborted)return n(new Error("Invalid status passed to setStatus"));r=this.abandonProcess()}r.then(()=>{const n=new vt(g.a.toString(this._processId),g.a.toString(this.getProcessInstanceId()),t,this.getDisplayState());this._applicationContext.EventManager.ReportEvent(n),e()},t=>{n(t)})})}setVisible(t){if(Object(St.a)(this._currentBpfInstance)||Object(St.a)(this._currentFormEntity)||Object(St.a)(this._currentFormEntity.etn))return;const e=Object(dt.h)(this._currentFormEntity.etn);this._dispatch(Object(ht.b)(this._currentPageId,_t.a,e,!0===t)),this._updateProcessInstanceModifiedTime()}isVisible(){if(!this._currentBpfInstance)return!1;const t=Object(dt.h)(this._currentFormEntity.etn);return!0===Object(y.G)(this._getState(),{id:this._currentPageId,controlName:_t.a},t)}getCurrentFormEntity(){return this._currentFormEntity}getActiveStageEntityRef(){const t=this._getStage(this.getActiveStageId()),e=t&&t.get_parent()&&t.get_parent().get_Name()||null,n=this._getNavigationEntityIdsByEntityLogicalName();return e&&n&&n.hasOwnProperty(e)?new J.a(e,n[e]):null}getProcess(){return this._currentBpfInstance&&this._stageMetadata.getProcessObjectModel()}getProcessInstanceName(){return this._currentBpfInstance&&Object(O.e)(this._getState(),this._currentBpfInstance)}getTraversedPath(){return Object(O.h)(this._getState(),this._currentBpfInstance)}getProcessId(){return this._processId}getVersion(){return this._version}getProcessInstanceId(){return this._currentBpfInstance&&this._currentBpfInstance.id}getBpfEntityLogicalName(){return this._currentBpfInstance&&this._currentBpfInstance.etn}getEntityStages(){return this._stageMetadata.getEntityStages()}getActiveStage(){return this._getStage(this.getActiveStageId())}getProcessInstances(){return new Promise((t,e)=>{var n,r;this._dispatch((n=this._currentFormEntity.id,r=this._currentFormEntity.etn,{type:"businessProcessFlow.retrieveProcessInstancesRequest.async",execute({dispatch:t,getState:e},a){const i=a.DataSource.get_WebAPIService(),s=new w(n,r),o=Object(F.a)(e(),s);return i.sendRequest(o).then(t=>t.json(),h.b)}})).then(e=>{t(e)},t=>{e(t)})})}getSelectedStage(){return this._getStage(this.getSelectedStageId())}isCrossEntityNavigation(t){const e=t?this._stageMetadata.getNextStageId(this.getActiveStageId()):this._stageMetadata.getPreviousStageId(this.getActiveStageId());if(!e)return!1;const n=this._stageMetadata.getStage(e);if(!n)return!1;const r=n.get_parent();return this._currentFormEntity&&this._currentFormEntity.etn&&r&&r.get_EntityLogicalName()!==this._currentFormEntity.etn}_isStageOnPath(t,e){for(const n of e)if(g.a.equals(n,t))return!0;return!1}getProcessState(){const t=Object(m.a)(this._getState(),this.getProcessId());return t?t.businessProcessFlowProcessState:null}getState(){if(this._currentBpfInstance){const t=Object(O.f)(this._getState(),this._currentBpfInstance);if(t){const e=parseInt(t.valueString,10);return isNaN(e)?null:e}}return null}getStatusName(){if(this._currentBpfInstance){const t=Object(O.g)(this._getState(),this._currentBpfInstance);if(t){return t.label}}return null}getStatus(){if(this._currentBpfInstance){const t=Object(O.g)(this._getState(),this._currentBpfInstance);if(t){const e=parseInt(t.valueString,10);return isNaN(e)?null:e}}return null}getActiveStageId(){if(this._currentBpfInstance){let t=this._currentBpfInstance&&Object(O.a)(this._getState(),this._currentBpfInstance);if(g.a.isNullOrEmpty(t)&&this._currentBpfInstance&&this._activeStageManager&&this._activeStageManager.globalPathAndActiveStage){const e=this._activeStageManager.globalPathAndActiveStage.stageId;e&&(t=g.a.tryParseOrNull(e))}if(!g.a.isNullOrEmpty(t)){const e=this.getActivePath();if(e&&e.length>0)return this._isStageOnPath(t,e)?t.guid:e[0].guid}}return null}getActivePathStages(){const t=this.getActivePath();if(t){const e=new Array(t.length);for(let n=0;n<t.length;n++)e[n]=this._getStage(t[n].guid);return e}return null}getActivePath(){if(!this._currentBpfInstance)return null;let t=Object(C.c)(this._getState(),this.getProcessInstanceId());return t||(t=this._getDefaultActivePath()),t}getDisplayState(){return this._currentBpfInstance?Object(C.d)(this._getState())||o.a.getDefaultDisplayState():null}getSelectedStageId(){if(!this._currentBpfInstance)return null;const t=Object(C.g)(this._getState(),this.getProcessInstanceId());return t?t.guid:this.getActiveStageId()}_getDefaultSelectedStageId(){if(!this._currentBpfInstance)return null;const t=Object(C.g)(this._getState(),g.a.EMPTY);return t&&!this._stageMetadata.getStage(t.guid)?null:t}_isActiveStageInCurrentEntity(t){try{return this._stageMetadata.getStage(t).get_parent().get_Name()===this._currentFormEntity.etn}catch(t){this._applicationContext.EventManager.ReportComponentFailure("ProcessManager._isActiveStageInCurrentEntity",t)}return!0}getStageMetadata(){return this._stageMetadata}isBusinessProcessAborted(){return this.getStatus()===V.a.Aborted}isBusinessProcessCompleted(){return this.getStatus()===V.a.Finished}moveToNextStage(){const t=this.getTelemetryParams(),e=new Promise((t,e)=>{if(Object(St.a)(this._currentBpfInstance))return e(new h.a("Process Control does not exist on form.",2147877746));const n=this._stageMetadata.getNextStageId(this.getActiveStageId());if(!n)return void e(new H("Last stage in the active path reached. Next stage does not exist."));t(this._saveMainFormIfImmersiveBpfAndNewRecord().then(()=>this._saveFormDataAndActiveStage(g.a.tryParseOrNull(n),0,"MoveToNextStage")))});return e.then(()=>{Object(xt.c)(At.h,t,this._applicationContext)},e=>{this._shouldReportErrorAsSuccess(e)?Object(xt.c)(At.h,t,this._applicationContext):Object(xt.b)(At.h,e,null,t,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),e}moveToPreviousStage(){const t=this.getTelemetryParams(),e=new Promise((t,e)=>{if(Object(St.a)(this._currentBpfInstance))return e(new h.a("Process Control does not exist on form.",2147877746));const n=this._stageMetadata.getPreviousStageId(this.getActiveStageId());if(!n)return e(new W("The first stage in the traversed path reached. Previous stage does not exist."));t(this._saveFormDataAndActiveStage(g.a.tryParseOrNull(n),1,"MoveToPreviousStage"))}).then(()=>{this._stageMetadata.getDefaultPathManager().triggerSubsequentDefaultPathCalculation(this.getActiveStageId())});return e.then(()=>{Object(xt.c)(At.i,t,this._applicationContext)},e=>{this._shouldReportErrorAsSuccess(e)?Object(xt.c)(At.i,t,this._applicationContext):Object(xt.b)(At.i,e,null,t,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),e}setActiveStage(t){const e=re.startStopwatch({processId:g.a.toString(this.getProcessId()),processInstanceId:g.a.toString(this.getProcessInstanceId()),stageId:t}),n=this.getTelemetryParams(),r=new Promise((e,n)=>{const r=g.a.tryParseOrNull(t),a=this.getTraversedPath();if(Object(St.a)(this._currentBpfInstance))return n(new h.a("Process Control does not exist on form.",2147877746));if(!r)return n(new U("setActiveStage can only be called with a valid stage id"));if(!this._stageMetadata.getStage(r.guid))return n(new U("stage id does not exist on any path of the instance"));if(!a)return n(new U("Traversed Path is not present"));if(this.getActiveStageId()===r.guid)return e();const i=new M.a(a);if(!i||!i.isInTraversedPath(t)){return n(this.getActivePath().some(t=>g.a.equals(t,r))?new U("The stage is not in traversed path. Only navigating backwards is supported."):new q("stage id does not exist on the current acitve path of the instance."))}e(this._saveFormDataAndActiveStage(r,1,"SetActiveStage"))}).then(()=>{const e=new ft(g.a.toString(this._processId),g.a.toString(this.getProcessInstanceId()),t);this._applicationContext.EventManager.ReportEvent(e),this._stageMetadata.getDefaultPathManager().triggerSubsequentDefaultPathCalculation(t)});return r.then(()=>{e(),Object(xt.c)(At.o,n,this._applicationContext)},t=>{e(),this._shouldReportErrorAsSuccess(t)?Object(xt.c)(At.o,n,this._applicationContext):Object(xt.b)(At.o,t,null,n,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),r}switchProcess(){}abandonProcess(){const t=this.getTelemetryParams(),e=new Promise((t,e)=>Object(St.a)(this._currentBpfInstance)?e(new h.a("Process Control does not exist on form.",2147877746)):this.isBusinessProcessAborted()?t():void t(this._updateStateAndStatusOfProcess(V.a.Aborted,L.Inactive,"AbandonProcess")));return e.then(()=>{Object(xt.c)(At.a,t,this._applicationContext)},e=>{this._shouldReportErrorAsSuccess(e)?Object(xt.c)(At.a,t,this._applicationContext):Object(xt.b)(At.a,e,null,t,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),e}reactivateProcess(){const t=this.getTelemetryParams(),e=new Promise((t,e)=>Object(St.a)(this._currentBpfInstance)?e(new h.a("Process Control does not exist on form.",2147877746)):this.getStatus()===V.a.Active?t():void t(this._updateStateAndStatusOfProcess(V.a.Active,L.Active,"ReactivateProcess")));return e.then(()=>{Object(xt.c)(At.j,t,this._applicationContext)},e=>{this._shouldReportErrorAsSuccess(e)?Object(xt.c)(At.j,t,this._applicationContext):Object(xt.b)(At.j,e,null,t,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),e}completeProcess(){const t=this.getTelemetryParams(),e=new Promise((t,e)=>Object(St.a)(this._currentBpfInstance)?e(new h.a("Process Control does not exist on form.",2147877746)):this.isBusinessProcessCompleted()?t():g.a.tryParseOrNull(this._stageMetadata.getNextStageId(this.getActiveStageId()))?e(new h.a("Attempt to finish a process not on last stage.",2148081666)):void t(this._saveMainFormIfImmersiveBpfAndNewRecord().then(()=>this._updateStateAndStatusOfProcess(V.a.Finished,L.Inactive,"CompleteProcess"))));return e.then(()=>{Object(xt.c)(At.c,t,this._applicationContext)},e=>{this._shouldReportErrorAsSuccess(e)?Object(xt.c)(At.c,t,this._applicationContext):Object(xt.b)(At.c,e,null,t,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),e}_shouldReportErrorAsSuccess(t){return t instanceof K||(t instanceof Y||(t instanceof H||(t instanceof W||(t instanceof U||(t instanceof q||t instanceof Q)))))}triggerActionStepClick(t){if(Object(St.b)(t)){const t=new Error("BPF Action Step Failure: null ControlId");throw Object(xt.b)(At.b,t,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),t}const e=this._actionStepManager.GetActionMetadata(t);if(Object(St.a)(e)){const t=new Error("BPF Action Step Failure: null metadata");throw Object(xt.b)(At.b,t,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),t}const n=this._getState();if(Object(St.a)(n)){const t=new Error("BPF Action Step Failure: null state");throw Object(xt.b)(At.b,t,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),t}let r=this._getTelemetryParamsForActionStep(e.actionType,t,e.actionId);try{const n=new g.a(e.actionId);if(e.actionType===jt.AsyncWorkflow||e.actionType===jt.SyncWorkflow){const a=["BusinessProcessFlowId","BusinessProcessFlowInstanceId","ActionStepId"],i=[this._processId.guid,g.a.toString(this.getProcessInstanceId()),n.guid].map(t=>{const e=new Ct;return e.Type="System.String",e.Value=t,e}),s=new It;s.Keys=a,s.Values=i,s.Count=3,s.IsReadOnly=!0;const o=new Pt;o.Arguments=s;const c=new Ot;c.EntityId=this._currentFormEntity.id,c.InputArguments=o,c.entity={id:e.workflowId,entityType:"workflow"},this.UpdateActionLog(n,1),this._dispatch(Object(j.b)(c)).then(()=>{Object(Tt.a)(this._currentPageId,this.getContextToken(),t),this.UpdateActionLog(n,2,this._actionStepManager.GenerateMessageForAction(2)),Object(xt.c)(At.b,r,this._applicationContext)},e=>{Object(Tt.a)(this._currentPageId,this.getContextToken(),t),this.UpdateActionLog(n,3,this._actionStepManager.GenerateMessageForAction(3)),Object(xt.b)(At.b,e,null,r,this._applicationContext,this.getCurrentFormEntity(),this._getState()),this._dispatch(Object(u.b)(e,!0)).then()})}else if(e.actionType===jt.ProcessAction){const a=e=>{Object(Tt.a)(this._currentPageId,this.getContextToken(),t),this.UpdateActionLog(n,3,this._actionStepManager.GenerateMessageForAction(3)),Object(xt.b)(At.b,e,null,r,this._applicationContext,this.getCurrentFormEntity(),this._getState()),this._dispatch(Object(u.b)(e,!0)).then()},i=a=>{Object(Tt.a)(this._currentPageId,this.getContextToken(),t),this.UpdateActionLog(n,2,this._actionStepManager.GenerateMessageForAction(2));const i=a.get_outputParameters();e.outputBindings.forEach(t=>{if(t.parameterName in i){const e=i[t.parameterName],n=t.boundAttributeName,r={};r[n]={key:n,value:e},this._dispatch(Object(Et.a)(this._currentPageId,r,!1,!0,this._currentFormEntity.etn,this._currentFormEntity.id.guid,null,this.getContextToken()))}}),Object(xt.c)(At.b,r,this._applicationContext)},s=r=>{if(r=r?r.parameters:{},this._filterInputArguments(r)){const t={id:g.a.toString(this.getCurrentFormEntity().id),entityType:this.getCurrentFormEntity().etn};r.Target=t,r.BusinessProcessFlowId=this._processId.guid,r.BusinessProcessFlowInstanceId=g.a.toString(this.getProcessInstanceId()),r.ActionStepId=e.actionId,this._actionStepManager.InvokeProcessAction(e.uniqueName,e,r).then(i,a)}else Object(Tt.a)(this._currentPageId,this.getContextToken(),t),this.UpdateActionLog(n,3,this._actionStepManager.GenerateMessageForAction(3))},o={};e.inputBindings.forEach(t=>{const e=Object(k.c)(Object(lt.j)(this._getState(),this.getCurrentFormEntity(),t.boundAttributeName));o["ProcessUnification_Arguments_"+t.parameterName]=e}),this._addInputParametersToParamList(e.inputParameters,o),this.UpdateActionLog(n,1),Xrm.Navigation.openDialog(e.workflowId,this._getDialogOptions(),o).then(s,a)}}catch(t){throw 0===r.length&&(r=this.getTelemetryParams()),Object(xt.b)(At.b,t,null,r,this._applicationContext,this.getCurrentFormEntity(),this._getState()),t}}triggerFlowStepClick(t,e){e=e;const n=Rt.getTelemetryParamsForFlowStep(null,null,null,t,this.getTelemetryParams());try{const e=g.a.newGuid(),r={activeStage:this.getActiveStage(),selectedStage:this.getSelectedStage(),flowStepId:t,workflowLogId:e};this._flowStepManager.openFlowWidget(r,n),this.UpdateActionLog(new g.a(t),1,void 0,e);const a=this.getActionLog(new g.a(t));this.createWorkflowLogRecord(a),Object(xt.c)(At.d,n,this._applicationContext)}catch(t){Object(xt.b)(At.d,t,null,n,this._applicationContext,this.getCurrentFormEntity(),this._getState())}}refreshFlowStepClick(t){const e=Rt.getTelemetryParamsForFlowStep(null,null,null,t,this.getTelemetryParams()),n=this._dispatch(Object(Ht.a)(this._processId,this._currentBpfInstance));Promise.resolve(n).then(()=>{this._updateProcessInstanceModifiedTime(),Object(xt.c)(At.k,e,this._applicationContext)}).catch(t=>{Object(xt.b)(At.k,t,null,e,this._applicationContext,this.getCurrentFormEntity(),this._getState())})}_addInputParametersToParamList(t,e){for(const n of Object.keys(t))"ProcessUnification_Arguments_"+t[n].parameterName in e||(e["ProcessUnification_Arguments_"+t[n].parameterName]=null)}_filterInputArguments(t){if(t&&"last_button_clicked"in t&&"ok_id"===t.last_button_clicked){const e="ProcessUnification_Arguments_";for(const n in t){const r=t[n];if(n.startsWith(e)){t[n.substring(e.length,n.length)]=r}delete t[n]}return!0}return!1}_getDialogOptions(){return{height:450,width:450,position:1}}_createSnapshotRequest(t,e){if(!t)throw new Error("Active stage cannot be null or undefined.");const n=new J.a("processstage",t),r=this._calculateNewTraversedPath(t),a={activestageid:{reference:n,timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:t.guid}},traversedpath:{value:r,timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:""}}};return this._addFieldsToBPFSnapshotForCreate(a,e)}_addFieldsToBPFSnapshotForCreate(t,e){if(!t||!this._hasBpfInstance())return t;const n=Object(Wt.b)(this._getState(),this._currentFormEntity.etn,this._currentBpfInstance.etn);return n&&(t[n.ReferencingAttribute]={reference:new J.a(this._currentFormEntity.etn,e),timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}}),t.processid={reference:new J.a("workflow",this.getProcessId()),timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}},t}generateBPFInstanceSnapshotId(){if(this.isImmersiveBPF()||!Object(Lt.c)(this._getState(),"FCB.SplitBPFEntityAndParticipatingEntityCreates"))return null;let t=[],e=null;try{const n=Object(y.ac)(this._getState(),this._currentPageId,this.getContextToken()),r=Object(pt.b)(this._getState(),n);let a=r.identifier&&r.identifier.id||this._currentFormEntity.id;const i=Object(s.g)(this._getState(),this._currentPageId);if(Object(Wt.e)(i))return Object(Wt.f)(this._getState(),n,a,this._dispatch),null;if(!this._hasBpfInstance()||g.a.isNullOrEmpty(this.getProcessId()))return null;if(t=this.getTelemetryParams(),Object(Wt.d)(this._getState(),r.identifier,this._currentPageId))return Object(Wt.f)(this._getState(),n,a,this._dispatch),null;g.a.isNullOrEmpty(a)&&(a=g.a.newGuid(),Object(Wt.f)(this._getState(),n,a,this._dispatch)),e=this._createActiveStageSnapshot(g.a.tryParse(this.getActiveStageId()),a);const o=Object(pt.b)(this._getState(),e);t.push({name:"SnapshotId",value:e}),t.push({name:"Snapshot active changes",value:o&&o.activeChanges&&Object.keys(o.activeChanges).map(t=>"Property: "+t).join("; ")}),this._applicationContext.EventManager.ReportComponentSuccess("ProcessManager.generateBPFInstanceSnapshotId",t)}catch(e){this._applicationContext.EventManager.ReportComponentFailure("ProcessManager.generateBPFInstanceSnapshotId",e,null,t)}return e}_calculateNewTraversedPath(t){let e="";for(const n of this.getActivePath())if(e+=","+n.guid,g.a.equals(n,t))return e.substring(1);return e+=","+t.guid,e.substring(1)}_createActiveStageSnapshot(t,e){const n=this._createSnapshotRequest(t,e),r=ie.startStopwatch({processId:g.a.toString(this.getProcessId()),processInstanceId:g.a.toString(this.getProcessInstanceId())});let a=Object(pt.c)(this._getState(),this.getCurrentFormEntity());if(this.isImmersiveBPF()&&!Object(St.a)(a)){const t=Object(it.b)(this._getState(),a.snapshotId,n);return this._dispatch(t),a=Object(pt.c)(this._getState(),this.getCurrentFormEntity()),r(),a.snapshotId}const i=Object(dt.h)(this._currentFormEntity.etn),s=Object(dt.x)(i),o=Object(at.b)(this._getState(),this._currentBpfInstance,n,s,this._hasBpfInstance()?ut.a.Create:ut.a.Update),c=o.payload.snapshotId;return this._dispatch(o),r(),c}_hasBpfInstance(){return!this._currentBpfInstance||g.a.isNullOrEmpty(this._currentBpfInstance.id)}_updateStateAndStatusOfProcess(t,e,n){return new Promise((r,a)=>{const i=this._createStatusAndStateUpdateRequest(t,e);let s=Object(pt.c)(this._getState(),this.getCurrentFormEntity()),o=null;if(this.isImmersiveBPF()&&!Object(St.a)(s)){const t=Object(it.b)(this._getState(),s.snapshotId,i);this._dispatch(t),s=Object(pt.c)(this._getState(),this.getCurrentFormEntity())}else{const t=Object(dt.h)(this.getCurrentFormEntity().etn),e=Object(dt.x)(t),n=Object(at.b)(this._getState(),this._currentBpfInstance,i,e);o=n.payload.snapshotId,this._dispatch(n)}if(!this.executePreEvent("runOnPreProcessStatusChange",n,null,t))if(this._shouldPerformFormSave()){const e=this._validateSnapshot(s).then(()=>this._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(n)).then(()=>this._saveFormEntityAndBPFEntitySnapshots(o,s,!1)).then(()=>{this._executePostEvent("runOnProcessStatusChange",n,null,t)}).catch(t=>{const e=Object(h.c)(t);return this._handleDuplicateDetection(e,o)}).catch(t=>{throw this._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(t),t}).catch(t=>{this._dispatch(Object(u.b)(t,!0)).then(()=>a(t))});r(e)}else this._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(n).then(()=>{let e=null;e=this.isImmersiveBPF()&&!Object(St.a)(s)?s.snapshotId:o;this._dispatch(Object(ot.c)(e,!0,["statuscode","statecode","activestagestartedon","completedon"])).then(()=>{this._dispatch(Object(ct.a)(this._currentPageId,this.getCurrentFormEntity(),this._getColumnsToRefresh())).then(()=>{this._updateProcessInstanceModifiedTime(),this._executePostEvent("runOnProcessStatusChange",n,null,t)}),r()}).catch(t=>{this._dispatch(Object(u.b)(t,!0)).then(()=>a(t))})});r()})}_validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(t){return new Promise((e,n)=>{if("CompleteProcess"===t||"MoveToNextStage"===t){const e=this.ValidateRequiredFieldsForNavigation();if(e&&!e.isValid)if("MoveToNextStage"===t)n(new Y("Unable to navigate to next stage as required fields have not been set"));else{if("CompleteProcess"===t)return n(new Y("Unable to complete process as required fields have not been set"));n(new Error("validation failed for unexpected BPF operation: "+t))}}return e()})}_saveFormChangesBeforeNavigation(){if(this._shouldPerformFormSave()){const t=Object(pt.c)(this._getState(),this.getCurrentFormEntity());return this._validateSnapshot(t).then(()=>this._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures("MoveToNextStage")).then(()=>{const e=this._getColumnsToRefresh();return this._dispatch(Object(ot.c)(t.snapshotId,!0,e))}).catch(e=>(this._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(e,t.snapshotId),this._dispatch(Object(u.b)(e,!0))))}return Promise.resolve()}_shouldPerformFormSave(){const t=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ShouldPerformFormSave"),e=this.getTelemetryParams(),n=this._getState();if(Object(y.kb)(n,{id:this._currentPageId},this.getContextToken()))return t.info("Skip main form save for BPF state or stage change due to read only form",e),!1;const r=this._dispatch(Object(Dt.b)(this._currentPageId,this.getContextToken()));if(r&&r.data&&r.data.getIsDirty){const n=r.data.getIsDirty(),a={name:"shouldPerformMainFormSave",value:n};return e.push(a),t.info("Checking if main form save should be performed due to dirty form",e),n}return t.error("Unable to determine dirty state of main form - skipping save of main form",e),!1}_saveMainFormIfImmersiveBpfAndNewRecord(){const t=Object(s.l)(this._getState(),this._currentPageId);if(this.isImmersiveBPF()&&t===qt.a&&g.a.isNullOrEmpty(this.getCurrentFormEntity().id)){const e=1;return this._dispatch(Object(l.f)(this._currentPageId,t,!1,e,!1,!1)).then(t=>{this._currentFormEntity=t})}return Promise.resolve(void 0)}_validateSnapshot(t){return new Promise((e,n)=>{const r=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SnapshotValidation"),a=this._getSnapshotStateTelemetryParams(t),i=this._currentPageId,s=this.getContextToken();this._dispatch(this._getEventManager().runOnSave(s,1))&&(this._dispatch(Object(d.b)(i,s,2)),this._dispatch(Object(p.b)(i,s,!1)),r.warn("BPF ProcessManager: Unable to save form data due to web resource registered onSave invoking preventDefault",a),n(new h.a("Unable to save form data due to web resource registered onSave invoking preventDefault",2147877737)));for(const e in t.activeChanges){const i=t.activeChanges[e],s=this._applicationContext.DataSource.get_MetadataCache().getAttributeMetadata(t.identifier.etn,e),o=Object(St.a)(s)?null:s.get_logicalName(),c=Object(St.a)(s)?Xt.a.get_empty():s.get_id();if(Object(St.a)(i))return r.error("BPF ProcessManager: unexpected null or undefined fieldValue for attribute "+o+" with ID: "+c,a),n(new Error("Internal Client Error - null fieldValue"));const l=i.validationResult;if(Object(St.a)(l)){if(o===kt.c){r.info("BPF ProcessManager: skipping formEntitySnapshot validation for atttribute: "+o+" with ID: "+c,a);continue}return r.error("BPF ProcessManager: unexpected null or undefined validationResult for atttribute: "+o+" with ID: "+c,a),n(new Error("Internal Client Error - null validatorResult"))}const u=l.isValueValid;if(Object(St.a)(u))return r.error("BPF ProcessManager: unexpected null or undefined validationResult.isValidValue for atttribute: "+o+" with ID: "+c,a),n(new Error("Internal Client Error - null validationResult.isValidValue"));if(!u){const t={name:At.q,value:"clientSideCurrentForm"};return a.push(t),r.warn("BPF ProcessManager: unable to save form due to invalid value for attribute: "+o+" with ID: "+c,a),n(new z("Unable to save form data due to validation errors"))}}return e(!0)})}_createStatusAndStateUpdateRequest(t,e){return{statuscode:{label:V.a[t],valueString:t.toString(),timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null}},statecode:{label:L[e],valueString:e.toString(),timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null}}}}ValidateRequiredFieldsForNavigation(){const t=ae.startStopwatch({processId:g.a.toString(this.getProcessId()),processInstanceId:g.a.toString(this.getProcessInstanceId())}),e=this._getState(),n=this._stageMetadata.getRequiredAttributesForStage(this.getActiveStageId(),this._currentPageId,this.getContextToken(),e),r=this._stageMetadata.getRequiredFlowStepsForStage(this.getActiveStageId(),this._currentPageId,this.getContextToken(),e),a={emptySteps:[],errorSteps:[]},i=Object(pt.c)(this._getState(),this.getCurrentFormEntity()),o=this._getSnapshotStateTelemetryParams(i),c=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SnapshotValidation");for(const t of n){c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: validating attribute: "+t,o);let e=Object(lt.j)(this._getState(),this.getCurrentFormEntity(),t);i&&i.activeChanges&&t in i.activeChanges&&(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: fieldIsDirty: "+t,o),e=i.activeChanges[t]);Object(C.h)(e,this._getState(),this.getCurrentFormEntity().etn,t)?(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: emptyField: "+t,o),a.emptySteps.push(t)):e.validationResult.isValueValid||(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: !fieldValue.validationResult.isValueValid: "+t,o),a.errorSteps.push(t))}for(const t of r){const e=g.a.tryParse(t);if(g.a.isNullOrEmpty(e)){c.error("BPF ProcessManager ValidateRequiredFieldsForNavigation: invalid Flow Step ID GUID: "+t,o);continue}const n=this.getActionLog(e);if(n){const e=n.status;2!==e&&(c.info("BPF ProcessManager ValidateRequiredFieldsForNavigation: Required Flow Step not completed for stepId "+t+". The Flow Step Action Log has stauts of : "+e,o),a.errorSteps.push(t))}else c.info("BPF ProcessManager ValidateRequiredFieldsForNavigation: Required Flow Step not completed for stepId "+t+". No action logs were found for this Flow Step",o),a.errorSteps.push(t)}a.isValid=0===a.emptySteps.length&&0===a.errorSteps.length;const u=Object(Kt.a)(e,this._currentPageId);if(!Object(y.Gb)(u,e,this._currentPageId,this.getContextToken())){c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: form is not valid - "+this._currentPageId,o);const t=Object(s.l)(this._getState(),this._currentPageId);this._dispatch(Object(l.f)(this._currentPageId,t,!1,1,!1,!1)),a.isValid=!1}if(!a.isValid){const t=String.format("BPF ProcessManager: ValidateRequiredFieldsForNavigation returned invalid");c.warn(t,o)}return t(),a}setSelectedStage(t,e=!1){return new Promise((n,r)=>{const a=g.a.tryParseOrNull(t);if(!a)return r("setSelectedStage can only be called with a valid stage id");const i={selectedStageId:a};this._updateBusinessProcessFlowData(this._currentBpfInstance,i),this._isUserSelectedStage=e,e&&this._executePostEvent("runOnStageSelected","setSelectedStage"),n()})}setDisplayState(t){if(this._currentBpfInstance&&(t===o.a.collapsed||t===o.a.expanded||t===o.a.floating)){this._updateDisplayState(this._currentBpfInstance,t);const e=new yt(g.a.toString(this._processId),g.a.toString(this.getProcessInstanceId()),t);this._applicationContext.EventManager.ReportEvent(e)}}setActivePath(t){if(!t||0===t.length)return;const e=[];for(let n=0;n<t.length;n++)e[n]=new g.a(t[n]);const n={activePath:e};this._updateBusinessProcessFlowData(this._currentBpfInstance,n)}setBpfNavigationBehavior(t){const e={processNavigationBehavior:{navigationBehavior:t,navigationBehaviorPageId:this._currentPageId}};this._updateBusinessProcessFlowData(this._currentBpfInstance,e)}getBpfNavigationBehavior(){return this._currentBpfInstance&&Object(C.e)(this._getState(),this.getProcessInstanceId())}shouldReInitializeNavigationBehavior(){return!(!this._currentBpfInstance||!(null==this.getBpfNavigationBehavior()&&Object(St.a)(Object(C.b)(this._getState(),this.getProcessInstanceId()))||Object(C.f)(this._getState(),this.getProcessInstanceId())!==this._currentPageId))}getBpfNavigationBehaviorAllowCreateNew(t){const e=this._currentBpfInstance&&Object(C.b)(this._getState(),this.getProcessInstanceId());return!e||!t||e(t)}createWorkflowLogRecord(t){if(Object(St.a)(t))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined actionLog");const e=this._getState();if(Object(St.a)(e))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined state");const n=e.metadata;if(Object(St.a)(n))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined metadata");const r=n.entities;if(Object(St.a)(r))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined entities");const a=this._currentBpfInstance.etn;if(Object(St.b)(a))throw new Error("BPF Create WorkflowLog Record Failure: null or empty entityLogicalName");const i=r[a];if(Object(St.a)(i))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined bpfEntity");const s=i.EntitySetName;if(Object(St.b)(s))throw new Error("BPF Create WorkflowLog Record Failure: null or empty entitySetName");const o=Object(Nt.z)(e,"workflowlog",i.EntityLogicalName,"asyncoperationid");if(Object(St.a)(o))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined relationshipMetadata");if(Object(St.b)(o.ReferencingEntityNavigationPropertyName))throw new Error("BPF Create WorkflowLog Record Failure: null or empty relationshipMetadata.ReferencingEntityNavigationPropertyName");const c=o.ReferencingEntityNavigationPropertyName+"@odata.bind",l="/"+s+"("+t.processInstanceid.guid+")",u={workflowlogid:t.actionLogId.guid,stepname:t.stepId.guid,[c]:l,activityname:t.processDefinitionid.guid,status:t.status};Xrm.WebApi.createRecord("workflowlog",u)}_getTracer(){return Object(St.a)(this._applicationContext)||Object(St.a)(this._applicationContext.TraceManager)?null:this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ProcessManager")}_getDefaultActivePath(){const t=this._getTracer();if(Object(St.a)(this._stageMetadata))return t&&t.error("ProcessManager _getDefaultActivePath method: NullOrUndefined _stageMetadata"),null;const e=this._stageMetadata.getDefaultPathManager();if(Object(St.a)(e))return t&&t.error("ProcessManager _getDefaultActivePath method: NullOrUndefined defaultPathManager"),null;const n=e.getDefaultPath();if(Object(St.a)(n))return t&&t.error("ProcessManager _getDefaultActivePath method: NullOrUndefined stringPath"),null;const r=[];for(const t in n){const e=g.a.parse(n[t]);r.push(e)}return r}_updateBusinessProcessFlowData(t,e){t&&(this._dispatch(Object(tt.a)(e,t)),this._updateProcessInstanceModifiedTime())}_updateDisplayState(t,e){this._dispatch(Object(et.a)(e,t)),this._updateProcessInstanceModifiedTime()}getForwardNavigationEntities(t,e,n,r){return this._saveFormChangesBeforeNavigation().then(()=>this._dispatch(_(t,e,n,r||null)))}navigateToNextEntity(t,e,n,r){return new Promise((a,i)=>{const s=this.ValidateRequiredFieldsForNavigation();if(s&&!s.isValid)return i(new Y("Unable to navigate to next stage as required fields have not been set"));const o=this._stageMetadata.getNextStageId(this.getActiveStageId());if(!o)return i(new H("Last stage in the active path reached. Next stage does not exist."));const c=new g.a(o),l=this.getTraversedPath()+","+o;return this._saveFormChangesBeforeNavigation().then(()=>this._dispatch(E(t,e,c,l,n,r))).then(()=>this.setSelectedStage(o)).then(()=>{this._executePostEvent("runOnStageChange","navigateToNextEntity",0),a()}).catch(t=>{this._dispatch(Object(u.b)(t,!0)).then(()=>i(t))})})}navigateToNextEntityForCrossEntityBpf(t,e,n,r){return new Promise((a,i)=>{this._dispatch(E(t,e,new g.a(this.getActiveStageId()),this.getTraversedPath(),n,r)).then(()=>{this._dispatch(Object(rt.b)(e,this._currentBpfInstance)),this._executePostEvent("runOnStageChange","navigateToNextEntityForCrossEntityBpf",0),a()}).catch(t=>{this._dispatch(Object(u.b)(t,!0)).then(()=>i(t))})})}getActiveStageActiveFor(){if(this._currentBpfInstance){const t=Object(O.b)(this._getState(),this._currentBpfInstance);if(t){return(new Date).valueOf()-t.valueOf()}}return null}getBpfInstanceActiveFor(){if(this._currentBpfInstance){const t=Object(O.d)(this._getState(),this._currentBpfInstance);if(t)return(new Date).valueOf()-t.valueOf()}return null}getBpfInstanceCompletedIn(){if(this._currentBpfInstance){const t=Object(O.d)(this._getState(),this._currentBpfInstance),e=Object(O.c)(this._getState(),this._currentBpfInstance);if(e&&t)return e.valueOf()-t.valueOf()}return null}getActionLogCollection(){return this._currentBpfInstance?Object(C.a)(this._getState(),this.getProcessInstanceId()):null}getActionLog(t){const e=this.getActionLogCollection();return e&&e[t.guid]?e[t.guid]:null}UpdateActionLog(t,e,n,r){if(!this._currentBpfInstance)return null;const a=Object(C.a)(this._getState(),this.getProcessInstanceId()),i=a&&a[t.guid]?a[t.guid]:null;let s=g.a.EMPTY;s=Object(St.a)(r)||r===g.a.EMPTY?i?i.actionLogId:g.a.newGuid():r;const o={actionLogId:s,status:e,modifiedOn:(new Date).toLocaleString(),stepId:t,processDefinitionid:this._processId,processInstanceid:this.getProcessInstanceId(),message:n},c=Object.assign({},a);c[t.guid]=o;const l={actionLogCollection:c};return this._updateBusinessProcessFlowData(this._currentBpfInstance,l),"success"}getEnabledProcesses(){const t=[];return new Promise((e,n)=>{var r;this._currentFormEntity&&this._currentFormEntity.etn?this._dispatch((r=this._currentFormEntity.etn,{type:"businessProcessFlow.retrieveFilteredProcesses.async",execute({dispatch:t,getState:e},n){const a=n.DataSource.get_WebAPIService(),i=e(),s=g.a.tryParse(Object(A.i)(i)),o=new x(r,s),c=Object(F.a)(e(),o);return a.sendRequest(c).then(t=>t.json(),h.b)}})).then(n=>{for(const e of n.value)t.push(new N(e.name,e.uniquename,e.workflowid));e(t)},t=>{n(t)}):n(new h.a("Current Form Entity cannot be NULL",2147877745))})}getNavigationEntities(){return this._activeStageManager.navigationEntities}_getNavigationEntityIdsByEntityLogicalName(){return this._activeStageManager.navigationEntityIdsByEntityLogicalName}_updateGlobalActiveStage(t,e){this._activeStageManager.UpdateGlobalPathAndActiveStage(t,e)}_createGlobalNavigationData(t){const e=new D,n=Object(k.b)(t.activestageid);e.activeStageId=g.a.toString(n);let r=Object(k.c)(t.traversedpath);Object(St.b)(r)&&(r=M.a.getCandidateTraversedPathFromStagStep(this._stageMetadata.businessProcessFlowVisitor.get_stages(),e.activeStageId)),e.traversedPath=r,e.navigationEntities=[];const a=this._getNavigationEntityTypesFromWorkflowObjectModel();for(const n of a){const r=new R;r.entityLogicalName=n,r.id=g.a.EMPTY.guid;for(const e in t)if(Object(k.k)(t[e])){const a=t[e],i=[],s="NULL";if(Object(St.a)(a.reference)||Object(St.a)(a.reference.etn)){i.push({name:"entityReference.reference",value:s});this._applicationContext.TraceManager.getTracer("CreateGlobalNavigationData").info("Navigation entity should not be null .",i)}a&&a.reference&&a.reference.etn===n&&(r.id=a.reference.id.guid)}e.navigationEntities.push(r)}t.hasOwnProperty("businessprocessflowinstanceid")&&(e.businessProcessInstanceId=Object(k.c)(t.businessprocessflowinstanceid));t.hasOwnProperty("name")&&(e.businessProcessInstanceName=Object(k.c)(t.name));t.hasOwnProperty("statecode")&&(e.businessProcessState=Object(k.c)(t.statecode));t.hasOwnProperty("statuscode")&&(e.businessProcessStatus=Object(k.c)(t.statuscode));return t.hasOwnProperty("bpfDefinitionVersioNumber")&&(e.bpfDefinitionVersionNumber=Object(k.c)(t.bpfDefinitionVersioNumber)),e}_getNavigationEntityTypesFromWorkflowObjectModel(){const t={};if(!Object(St.a)(this.getProcess()))for(let e=0;e<this.getProcess().get_Steps().get_Count();e++){const n=this.getProcess().get_Steps().get_item(e);if(!(n instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep))continue;const r=n.get_Description();t[r]||(t[r]=r)}return Object.keys(t)}reflow(t,e,n){const r=this._stageMetadata.getDefaultPathManager();if(!e&&!n)return void this._reflowInternal();if(!e)return;e=new g.a(e).guid;const a=this.getTraversedPath(),i=this.getActiveStageId();a&&i&&(i===e||a.indexOf(e)<0)&&(r.updateDefaultPath(e,n),this._updateProcessInstanceModifiedTime())}_reflowInternal(t,e){const n=this._stageMetadata.getDefaultPathManager();t||e||(e=this.getActiveStageId(),t=this._stageMetadata.getPreviousStageId(e)),t&&(n.updateDefaultPath(t,e),this._updateProcessInstanceModifiedTime())}callPblToEvaluateBranching(t){const e=this._getState();if(!this._currentPageId)throw new Error("The current page Id should not be null when callPblToEvaluateBranching has been called. Because the reflow logic should be triggered for a particular page.");const n=Object(Z.a)(e,this._currentPageId);this.getScriptContainerPromise().then(e=>{n<$.a.EditReady&&e.getEventManager().addOnLoadEvent(this.getContextToken(),()=>{e.execute(t,[])}),n>=$.a.OnLoadReady&&e.execute(t,[])})}update(t){!Object(St.a)(this._currentBpfInstance)&&this._isSelectedStageControl(t.Id)&&this._updateProcessInstanceModifiedTime()}waitForOngoingWork(){return Jt.a.getInstance().checkForOutstandingWork(this._getState())}_getEventManager(){const t=this.getScriptContainer();return t?t.getEventManager():null}getScriptContainer(){if(!this._applicationContext||!this._applicationContext.ScriptManager)return null;let t=null;try{t=this._applicationContext.ScriptManager.getContainer(this._currentPageId)}catch(t){this._logTraceFailureForScriptContainer()}return t}getScriptContainerPromise(){return this._applicationContext&&this._applicationContext.ScriptManager?this._applicationContext.ScriptManager.initializeContainer(this._currentPageId):Promise.reject("The current container should be created before invoking handlers.")}_executePostEvent(t,e,n=null,r=null){if(Object(zt.n)(this._getState(),this._currentPageId)||!this._getEventManager())this._logTraceFailureForProcessEvent(e,t,t);else switch(t){case"runOnProcessChange":this._dispatch(this._getEventManager().runOnProcessChange(this.getContextToken(),this));break;case"runOnProcessStatusChange":this._dispatch(this._getEventManager().runOnProcessStatusChange(this.getContextToken(),V.a[r],this));break;case"runOnStageChange":this._dispatch(this._getEventManager().runOnStageChange(this.getContextToken(),this,n));break;case"runOnStageSelected":this._dispatch(this._getEventManager().runOnStageSelected(this.getContextToken(),this))}}executePreEvent(t,e,n=null,r=null){let a=!1;if(!Object(zt.n)(this._getState(),this._currentPageId)&&this._getEventManager()){switch(t){case"runOnPreProcessStatusChange":a=this._dispatch(this._getEventManager().runOnPreProcessStatusChange(this.getContextToken(),V.a[r],this));break;case"runOnPreStageChange":a=this._dispatch(this._getEventManager().runOnPreStageChange(this.getContextToken(),this,n))}return this._logTraceInfoForProcessPreEvent(a,t,e,e),a}return this._logTraceFailureForProcessEvent(e,t,t),a}_saveFormDataAndActiveStage(t,e,n){const r=se.startStopwatch({processId:g.a.toString(this.getProcessId()),processInstanceId:g.a.toString(this.getProcessInstanceId())}),a=this.executePreEvent("runOnPreStageChange",n,e),i=Object(pt.c)(this._getState(),this.getCurrentFormEntity());if(!a){const r=new Promise((e,r)=>{if(!t)return r(new U("Attemping to save invalid stage id"));const a=["traversedpath","activestageid","activestagestartedon","completedon"],s=this.getNavigationEntities(),o=Object(m.b)(this._getState(),this._currentBpfInstance);for(const t of s)for(const e in o)if(e.includes(t.entityLogicalName)){a.push(e);break}let c,l;if(this._shouldPerformFormSave()){const e=this._getState();c=this._validateSnapshot(i).then(()=>this._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(n)).then(()=>(l=this._createActiveStageSnapshot(t),this._saveFormEntityAndBPFEntitySnapshots(l,i,!1))).then(()=>{const t=this.getCurrentFormEntity();this._dispatch(Object(ee.a)(this._currentPageId,e,this.getContextToken(),t.etn,t.id))}).catch(t=>{const e=Object(h.c)(t);return this._handleDuplicateDetection(e,l)})}else c=this._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(n).then(()=>(l=this._createActiveStageSnapshot(t),this._dispatch(Object(ot.c)(l,!0,a,this._getRetrieveProcessControlDataRequest())).then(()=>{this._dispatch(Object(ct.a)(this._currentPageId,this.getCurrentFormEntity(),this._getColumnsToRefresh(),this._getRetrieveProcessControlDataRequest())),this._dispatch(Object(S.b)(!0,this._currentFormEntity))})));e(c)}).then(()=>{const t=this.getTraversedPath(),r=this.getActiveStageId();this._updateGlobalActiveStage(t,r),this.setSelectedStage(r),this._executePostEvent("runOnStageChange",n,e)},t=>{throw this._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(t),t});return r.then(s,s),r}function s(){r()}}_handleDuplicateDetection(t,e){if(Object(te.e)(t)){return this._dispatch(Object(Zt.a)(this._currentPageId,t,this._currentFormEntity)).then(t=>0===t.status?this._dispatch(Object($t.a)(t.pageId)).then(t=>t.value.param_lastButtonClicked===l.a?Promise.resolve("success"):Promise.resolve("aborted")):Promise.resolve("noop")).then(t=>{if("success"===t){const t=Object(pt.c)(this._getState(),this.getCurrentFormEntity());return this._saveFormEntityAndBPFEntitySnapshots(e,t,!0)}})}throw t}_saveFormEntityAndBPFEntitySnapshots(t,e,n){const r={};r[e.identifier.etn]=this._getColumnsToRefresh();let a=null;return a=this.isImmersiveBPF()?[e.snapshotId]:[e.snapshotId,t],this._dispatch(Object(ot.d)(a,n,r,this._getRetrieveProcessControlDataRequest()))}_logTraceInfoForProcessPreEvent(t,e,n,r){const a=this._applicationContext.TraceManager.getTracer(r),i=this.getTelemetryParams(),s={name:"BpfOperationName",value:n};i.push(s);const o={name:"eventName",value:e};i.push(o);const c={name:"preventDefaultInvokedByWebResource",value:t};i.push(c),a.info("BPF ProcessManager executed scripts registered to event "+e,i)}_logTraceFailureForProcessEvent(t,e,n){const r=this._applicationContext.TraceManager.getTracer(n),a=this.getTelemetryParams(),i={name:"BpfOperationName",value:t};a.push(i);a.push({name:"preventDefaultInvokedByWebResource",value:null});const s={name:"eventName",value:e};a.push(s);const o={name:"isPageDead",value:Object(zt.n)(this._getState(),this._currentPageId)};a.push(o);const c={name:"currentPageId",value:this._currentPageId};a.push(c),r.error(`BPF ProcessManager not able to to execute scripts registered on event ${e} does not exist`,a)}_logTraceFailureForScriptContainer(){const t=this._applicationContext.TraceManager.getTracer("GET_SCRIPT_CONTAINER"),e=this.getTelemetryParams();e.push({name:"BpfOperationName",value:"GetScriptContainer"});const n={name:"IsPageDead",value:Object(zt.n)(this._getState(),this._currentPageId)};e.push(n);e.push({name:"IsSciptContainerAvailable",value:!1}),t.error("BPF ProcessManager not able to to execute scripts as the script container does not exist",e)}_getStage(t){let e=null;if(t){const n=this.getEntityStages();n&&n.some(n=>{for(let r=0;r<n.get_Steps().get_Count();r++){const a=n.get_Steps().get_item(r);if(this._equalsIgnoreCase(t,a.get_Id()))return e=a,!0}})}return e}getContextToken(){return Object(dt.j)(this._getState(),this._currentPageId)}_updateProcessInstanceModifiedTime(){this._dispatch(Object(nt.b)(this.getCurrentFormEntity()))}_isSelectedStageControl(t){if(!Object(St.a)(this.getSelectedStage())){const e=this.getSelectedStage().get_Steps();for(let n=0;n<e.get_Count();n++)if(this._equalsIgnoreCase(e.get_item(n).get_Id(),t))return!0}return!1}_equalsIgnoreCase(t,e){return!!t&&!!e&&t.toUpperCase()===e.toUpperCase()}_getSnapshotStateTelemetryParams(t){const e=[];if(Object(St.a)(t))return e;const n={name:"mode",value:t.mode},r={name:"identifierId",value:Object(St.a)(t.identifier)||Object(St.a)(t.identifier.id)?null:g.a.toString(t.identifier.id)},a=this._applicationContext.DataSource.get_MetadataCache().getEntityMetadata(t.identifier.etn),i={name:"identifierEntityId",value:Object(St.a)(a)?null:g.a.fromLegacyGuid(a.get_id()).guid},s={name:"identifierEntityObjectTypeCode",value:Object(St.a)(a)?null:a.get_objectTypeCode()},o={name:"activeChanges",value:Object(St.a)(a)?null:this._getIFieldValuesString(t.activeChanges,a.get_logicalName())},c={name:"lockedChanges",value:Object(St.a)(a)?null:this._getIFieldValuesString(t.lockedChanges,a.get_logicalName())};return e.push(n),e.push(i),e.push(s),e.push(r),e.push(o),e.push(c),e}_getTelemetryParamsForActionStep(t,e,n){const r=this.getTelemetryParams(),a={name:"ActionStepType",value:t},i={name:"ControlId",value:e},s={name:"ActionStepId",value:n};return r.push(a),r.push(i),r.push(s),r}getTelemetryParams(){const t=[];try{const e={name:"ProcessId",value:g.a.toString(this.getProcessId())},n={name:"ProcessInstanceId",value:g.a.toString(this.getProcessInstanceId())},r={name:"ActiveStageId",value:this.getActiveStageId()},a={name:"SelectedStageId",value:this.getSelectedStageId()},i={name:"TraversedPath",value:this.getTraversedPath()},o={name:"ActivePath",value:this._getActivePathString()},c={name:"CurrentFormEntityType",value:this.getCurrentFormEntity()&&this.getCurrentFormEntity().etn?this.getCurrentFormEntity().etn:""},l={name:"CurrentFormEntityId",value:this.getCurrentFormEntity()&&this.getCurrentFormEntity().id?g.a.toString(this.getCurrentFormEntity().id):""},u={name:"ProcessState",value:this.getProcessState()},d={name:"PageId",value:this._currentPageId},p={name:"PageType",value:Object(s.l)(this._getState(),this._currentPageId)},h={name:"SavedPageId",value:this._savedPageId},m={name:"SavedPageType",value:Object(s.l)(this._getState(),this._savedPageId)};if(Object(Lt.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){const e={name:"CustomControlsPresent",value:this.getCustomControlIndicator()},n={name:"RenderedFromFormXML",value:this.getFormXmlRenderingIndicator()};t.push(e),t.push(n)}const b={name:"IsImmersiveBPF",value:this.isImmersiveBPF()};t.push(e),t.push(n),t.push(r),t.push(i),t.push(o),t.push(a),t.push(c),t.push(l),t.push(u),t.push(d),t.push(p),t.push(h),t.push(m),t.push(b)}catch(e){this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ProcessManagerTelemetryGeneration").error("Exception while generating Process Manager telemetry parameters: "+e.message,t)}return t}_getIFieldValuesString(t,e){let n="";if(!Object(St.a)(t))for(const r in t)if(Object(St.a)(r))n+=String.format("[fieldName: {0}]",null);else{const a=this._applicationContext.DataSource.get_MetadataCache().getAttributeMetadata(e,r),i=t[r];if(Object(St.a)(i)||Object(St.a)(a))n+=String.format("[attributeId is null: {0}, attributeMetadata is null: {1}]",Object(St.a)(i),Object(St.a)(a));else{let t="";Object(St.a)(i.timestamp)||(t=i.timestamp.toUTCString());let e="",r="",s=null,o=null;Object(St.a)(i.validationResult)||(e=i.validationResult.errorId,r=i.validationResult.errorMessage,s=i.validationResult.isOfflineSyncError,o=i.validationResult.isValueValid);const c=a.get_id();n+=String.format("[attributeId: {0}, timeStamp: {1}, validationResultErrorId: {2}, validationResultErrorMessage: {3}, validationResultIsOfflineSyncError: {4}, validationResultIsValueValid: {5}]",c,t,e,r,s,o)}}return n}_getActivePathString(){const t=this.getActivePath();let e="";if(t&&t.length>0){for(let n=0;n<t.length-1;n++)e=e+t[n].guid+",";e+=t[t.length-1].guid}return e}isImmersiveBPF(){return this.getCurrentFormEntity()&&this._currentBpfInstance&&this.getCurrentFormEntity().etn===this._currentBpfInstance.etn}_getColumnsToRefresh(){const t=Object(Yt.b)(this._getState(),this._currentPageId),e=Object(s.g)(this._getState(),this._currentPageId);if(Object(St.a)(e)){const t=Object(pt.c)(this._getState(),this.getCurrentFormEntity()),e=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SaveAndRefresh"),n=this._getSnapshotStateTelemetryParams(t);return e.warn("Columns To Refresh is not set as PageInput is null. Primary entity not refreshed after save",n),[]}const n=Object(Nt.E)(this._getState(),e.entityTypeName),r=Object(l.g)(this._getState(),t,e,n,null);return r&&r.hasOwnProperty(e.entityTypeName)?r[e.entityTypeName]:[]}_getRetrieveProcessControlDataRequest(){const t=this.getProcessId()&&!g.a.equals(this.getProcessId(),g.a.EMPTY)?J.a.toLegacyEntityReference(new J.a("businessprocessflowinstance",this.getProcessId())):null,e=this.getProcessInstanceId()&&!g.a.equals(this.getProcessInstanceId(),g.a.EMPTY)?J.a.toLegacyEntityReference(new J.a("businessprocessflowinstance",this.getProcessInstanceId())):null;return this.getCurrentFormEntity()&&t&&e?new Ut.a(J.a.toLegacyEntityReference(this.getCurrentFormEntity()),t,e):this.getCurrentFormEntity()?new Ut.a(J.a.toLegacyEntityReference(this.getCurrentFormEntity()),null,null):null}getCustomControlIndicator(){return this._customControlsPresent}setCustomControlIndicator(t){this._customControlsPresent=t}getFormXmlRenderingIndicator(){return this._renderedFromFormXml}setFormXmlRenderingIndicator(t){this._renderedFromFormXml=t}getInstanceModifiedTimestamp(){return this._instanceModifiedTimestamp}isBpfFormDescriptorValid(t,e,n,r){return null===this._isBpfFormValid&&(this._isBpfFormValid=Object(Qt.f)(t,e,n,r)),this._isBpfFormValid}_unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(t,e){let n=e;if(Object(St.a)(e)){const e=Object(h.c)(t);n=!Object(St.a)(e)&&e.FaultedSnapshotId}!Object(St.b)(n)&&this._dispatch(Object(st.b)(n,!1));const r=Object(pt.c)(this._getState(),this.getCurrentFormEntity());r&&!Object(St.a)(r.snapshotId)&&r.snapshotId!==n&&this._dispatch(Object(st.b)(r.snapshotId,!1))}}},bq0x:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(t,e){const n=Object(r.Zb)(t,e);return n&&n.output?n.output.value:null}},ccIw:function(t,e,n){"use strict";n.d(e,"a",(function(){return I}));var r=n("WRDA"),a=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i{get invocationSource(){return this._invocationSource}set invocationSource(t){this._invocationSource=t}get workflowStep(){return this._workflowStep}set workflowStep(t){this._workflowStep=t}get businessProcessFlowVisitor(){return this._businessProcessFlowVisitor}set businessProcessFlowVisitor(t){this._businessProcessFlowVisitor=t}get currentEntityName(){return this._currentEntityName}set currentEntityName(t){this._currentEntityName=t}get processManager(){return this._processManager}set processManager(t){this._processManager=t}getStageStep(t){if(Object(a.b)(t)||!this._businessProcessFlowVisitor)return null;const e=this._businessProcessFlowVisitor.get_stagesById()[Object(r.a)(t)];return e||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class s extends
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class{constructor(t){this.value=t,this._next=null}get value(){return this._value}set value(t){this._value=t}getNext(){return this._next}setNext(t){this._next=t}}{constructor(t){super(Object(r.a)(t))}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class o{constructor(){this._latestDefaultPathCalculated=!1,this._rootNodes=[],this._rootNodesValue=[],this._lastDefaultPathCalculatedTimeHash=this._generateDefaultPathCalculatedTimeHash()}find(t,e){if(t=Object(r.a)(t),e){for(const e in this._rootNodesValue)if(t===this._rootNodesValue[e])return this._rootNodes[e];return null}for(const e in this._rootNodes){let n=this._rootNodes[e];if(n.value===t)return n;for(;null!=n.getNext();)if(n=n.getNext(),n.value===t)return n}return null}getNode(t){return this._rootNodes[t]}setNode(t,e){this._latestDefaultPathCalculated=!1,this._rootNodes[t]=e,this._rootNodesValue[t]=e.value}getDefaultPath(){return this._ensureLatestDefaultPathIsCalculated(),this._defaultPathArray}addAfter(t,e){this.find(e.value,!0)?this._addAfterInternal(t,new s(null)):this._addAfterInternal(t,e)}getDefaultPathHash(){return this._ensureLatestDefaultPathIsCalculated(),this._lastDefaultPathCalculatedTimeHash}_ensureLatestDefaultPathIsCalculated(){this._latestDefaultPathCalculated||(this._defaultPathArray=this._recaculateDefaultPath(),this._latestDefaultPathCalculated=!0,this._lastDefaultPathCalculatedTimeHash=this._generateDefaultPathCalculatedTimeHash())}_recaculateDefaultPath(){this._defaultPathArray=[];for(let t=0;t<this._rootNodes.length;t++){let e=this._rootNodes[t];for(this._defaultPathArray[this._defaultPathArray.length]=e.value;e.getNext();){const t=e.getNext();t.value&&(this._defaultPathArray[this._defaultPathArray.length]=t.value),e=t}}return this._defaultPathArray}_addAfterInternal(t,e){t.setNext(e),this._latestDefaultPathCalculated=!1}_generateDefaultPathCalculatedTimeHash(){let t=Math.floor(1e4*Math.random());try{t=crypto.getRandomValues(new Uint32Array(1))[0]}catch(t){}return Date.now().toString()+t}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class c{pathChanged(t){this._handler&&!Object(a.b)(t.parentStage)&&this._handler.handleChange(t.parentStage,t.nextStage)}getHandler(){return this._handler}setHandler(t){this._handler=t}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class l{constructor(t,e){this._nextStage=e,this._parentStage=t}get parentStage(){return this._parentStage}get nextStage(){return this._nextStage}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class u{constructor(t,e,n){this._context=t,this._defaultPath=e,this._staticPath=n}calculate(){let t=this._startingNodeInDefaultPath();for(let e=0;e<this._staticPath.length;e++){const n=this._staticPath[e];if(!this._context.businessProcessFlowVisitor.get_stagesById().hasOwnProperty(n))continue;const r=this._defaultPath.find(n,!0);r?t=r:(this._defaultPath.addAfter(t,new s(n)),t=t.getNext())}this._lastEvaluatedNode=t}getLastEvaluatedNodeInDefaultPath(){return this._lastEvaluatedNode}getDefaultPath(){return this._defaultPath}_startingNodeInDefaultPath(){return this._startNode||(this._startNode=this._defaultPath.getNode(0)),this._startNode}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class d{constructor(t,e){this._defaultPath=e,this._context=t}calculate(){this._staticPathToDefaultPathCalculator.calculate(),this._defaultPath=this._staticPathToDefaultPathCalculator.getDefaultPath()}getLastDefaultNode(){return this._staticPathToDefaultPathCalculator.getLastEvaluatedNodeInDefaultPath()}get traversedPath(){return this._traversedPath||(this._traversedPath=[]),this._traversedPath}set traversedPath(t){this._traversedPath=t}getDefaultPath(){return this._defaultPath}get _staticPathToDefaultPathCalculator(){return this.__staticPathToDefaultPathCalculator||(this.__staticPathToDefaultPathCalculator=new u(this._context,this._defaultPath,this._traversedPath)),this.__staticPathToDefaultPathCalculator}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class p{constructor(t,e){this._context=t,this._defaultPath=e}calculate(){this._context.businessProcessFlowVisitor.get_areConditionsPresent()&&this._calculateForTraveresedStages()}get traversedPath(){return this._traversedPath}set traversedPath(t){this._traversedPath=t}getLastCalculatedDefaultNode(){return this._traversedDefaultPathCalculator?this._traversedDefaultPathCalculator.getLastDefaultNode():null}getDefaultPath(){return this._defaultPath}_calculateForTraveresedStages(){this._traversedDefaultPathCalculator.traversedPath=this._traversedPath.split(","),this._traversedDefaultPathCalculator.calculate()}get _traversedDefaultPathCalculator(){return this.__traversedDefaultPathCalculator||(this.__traversedDefaultPathCalculator=new d(this._context,this._defaultPath)),this.__traversedDefaultPathCalculator}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class h{constructor(t){this.context=t}get stage(){return this._stageStep}set stage(t){this._stageStep=t}tryExecute(){const t=Object(r.a)(this.stage.get_stageId());return!!this.context.businessProcessFlowVisitor.get_conditionsByParentStageId()[t]&&(this.executeCondition(),!0)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class g extends h{executeCondition(){const t="bpf_"+this._sanitizeGuidForFunctionName(this.stage.get_stageId());this.context.processManager.callPblToEvaluateBranching(t)}_sanitizeGuidForFunctionName(t){if(Object(a.b)(t))return t;for(t=Object(r.a)(t);t.indexOf("-")>-1;)t=t.replace("-","");return t}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class m extends h{executeCondition(){const t=Object(r.a)(this.stage.get_stageId()),e=this.context.businessProcessFlowVisitor.get_conditionsByParentStageId()[t];if(!e)return;const n=e.findElseBranch();let a=null;if(n&&n.get_Steps().get_Count()>0){a=n.get_Steps().get_item(0).get_stageId()}this._invokeReflowFunction(t,a)}_invokeReflowFunction(t,e){this.context.processManager.reflow(!1,t,e)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class b{getStageCommand(t,e){const n=t.businessProcessFlowVisitor.get_parentEntityStepByStageId()[Object(r.a)(e.get_stageId())];return t.currentEntityName!==n.get_EntityLogicalName()?new m(t):new g(t)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class f{constructor(t,e,n){this._defaultPath=e,this._cascadeUpdate=n,this._context=t,this._businessRuleCommandFactory=new b}handleChange(t,e){const n=this._defaultPath.find(t,!1);if(null!=n){const t=Object(a.b)(e)?null:e,r=new s(t);this._defaultPath.addAfter(n,r),t&&this.triggerSubsequentDefaultPathCalculation(r)}}triggerSubsequentDefaultPathCalculation(t){if(!t)return;const e=t.value;if(e&&!this._tryExecuteConditionForStage(t)){const n=this._context.getStageStep(e).get_nextStageId();if(!n)return;const r=this._defaultPath.find(n,!0);if(r)return void(this._cascadeUpdate&&this.triggerSubsequentDefaultPathCalculation(r));this._defaultPath.addAfter(t,new s(n)),this.triggerSubsequentDefaultPathCalculation(t.getNext())}}_tryExecuteConditionForStage(t){const e=this._context.invocationSource;try{this._context.invocationSource="internal";const n=this._context.getStageStep(t.value),r=this._businessRuleCommandFactory.getStageCommand(this._context,n);if(r.stage=n,!r.tryExecute())return!1;if(t.getNext())return!0}finally{this._context.invocationSource=e}return!1}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class y{constructor(t,e,n){this._context=t,this._listener=e,this._defaultPath=n}calculate(){const t=this._pathChangeHandler;this._listener.setHandler(t),t.triggerSubsequentDefaultPathCalculation(this._startNode)}get startingNodeInDefaultPath(){return this._startNode}set startingNodeInDefaultPath(t){this._startNode=t}getDefaultPath(){return this._defaultPath}get _pathChangeHandler(){return this.__pathChangeHandler||(this.__pathChangeHandler=new f(this._context,this._defaultPath,!0)),this.__pathChangeHandler}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class v{constructor(t,e,n){this._context=t,this._listener=e,this._initialDefaultPath=n}calculate(){this._context.businessProcessFlowVisitor.get_areConditionsPresent()||(this._defaultPath=this._initialDefaultPath),this._calculateForTraversedStages(),this._calculateForNonTraversedStages()}get startingNodeInDefaultPath(){return this._startingNodeInDefaultPath}set startingNodeInDefaultPath(t){this._startingNodeInDefaultPath=t}getDefaultPath(){return this._defaultPath}_calculateForTraversedStages(){this._defaultPath=this._initialDefaultPath}_calculateForNonTraversedStages(){this._nonTraversedDefaultPathCalculator.startingNodeInDefaultPath=this.startingNodeInDefaultPath,this._nonTraversedDefaultPathCalculator.calculate()}get _nonTraversedDefaultPathCalculator(){return this.__nonTraversedDefaultPathCalculator||(this.__nonTraversedDefaultPathCalculator=new y(this._context,this._listener,this._defaultPath)),this.__nonTraversedDefaultPathCalculator}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class _{constructor(t,e,n){this._context=t,this._changeListener=e,this._defaultPath=n}calculate(){const t=this._pathChangeHandler;this._changeListener.setHandler(t)}getDefaultPath(){return this._defaultPath}get _pathChangeHandler(){return this.__pathChangeHandler||(this.__pathChangeHandler=new f(this._context,this._defaultPath,!1)),this.__pathChangeHandler}}var S=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class O{constructor(t,e){this._context=e,this._traversedPathProvider=t,this._changeListener=new c,this._initializeDefaultPathFromRootStages()}initializeComplete(){const t=this.defaultPathHash();this._initializeTraversedPath(),this._initializeNonTraversedPath();const e=this._context.processManager.getSelectedStageId(),n=this._context.processManager.getActivePath(),r=!Object(a.a)(e)&&!Object(a.a)(n),i=r&&n.findIndex(t=>t.guid.toString()===e)<0,s=r&&this.getDefaultPath().indexOf(e)>=0;this.getDefaultPath()&&(t!==this.defaultPathHash()||i&&s)&&this._context.processManager.setActivePath(this.getDefaultPath())}updateDefaultPath(t,e){if(!t)return;let n=null;if("internal"!==this._context.invocationSource&&(n=this.defaultPathHash()),this._changeListener.pathChanged(new l(t,e)),"internal"!==this._context.invocationSource){if(n!==this.defaultPathHash()){const t=this.getDefaultPath();this._context.processManager.setActivePath(t)}}}triggerSubsequentDefaultPathCalculation(t){if(!(!!S.a.tryParseOrNull(t)&&!!this.getDefaultPath().find(e=>e.toLowerCase()===t.toLowerCase())))return;let e=null;if("internal"!==this._context.invocationSource&&(e=this.defaultPathHash()),this._changeListener.getHandler().triggerSubsequentDefaultPathCalculation(new s(t)),"internal"!==this._context.invocationSource){if(e!==this.defaultPathHash()){const t=this.getDefaultPath();this._context.processManager.setActivePath(t)}}}getDefaultPath(){return this._defaultPath.getDefaultPath()}defaultPathHash(){return this._defaultPath.getDefaultPathHash()}getNextStage(t){const e=this.getDefaultPath(),n=e.indexOf(Object(r.a)(t));return-1!==n&&n<e.length-1?e[n+1]:null}getPreviousStage(t){const e=this.getDefaultPath(),n=e.indexOf(Object(r.a)(t));return n<=0?null:e[n-1]}_initializeDefaultPathFromRootStages(){this._defaultPath=new o;const t=this._context.businessProcessFlowVisitor.get_firstLevelStages();let e=0;for(const n in t)this._defaultPath.setNode(e,new s(n)),e++}_initializeTraversedPath(){this._loadTimeDefaultPathCalculator.traversedPath=this._traversedPathProvider.getTraversedPath(),this._loadTimeDefaultPathCalculator.calculate(),this._defaultPath=this._loadTimeDefaultPathCalculator.getDefaultPath()}_initializeNonTraversedPath(){this._afterLoadPathCalculator.startingNodeInDefaultPath=this._loadTimeDefaultPathCalculator.getLastCalculatedDefaultNode(),this._afterLoadPathCalculator.calculate(),this._defaultPath=this._afterLoadPathCalculator.getDefaultPath(),this._runTimePathCalculator.calculate()}get _loadTimeDefaultPathCalculator(){return this._loadTimePathCalculator||(this._loadTimePathCalculator=new p(this._context,this._defaultPath)),this._loadTimePathCalculator}get _afterLoadPathCalculator(){return this.__afterLoadPathCalculator||(this.__afterLoadPathCalculator=new v(this._context,this._changeListener,this._defaultPath)),this.__afterLoadPathCalculator}get _runTimePathCalculator(){return this.__runTimePathCalculator||(this.__runTimePathCalculator=new _(this._context,this._changeListener,this._defaultPath)),this.__runTimePathCalculator}}var C=n("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class I{setPrimaryModel(t){this._primaryModelName=t}getDefaultPathManager(){return this._defaultPathManager}setObjectModel(t){const e=new Microsoft.Crm.Workflow.ObjectModel.WorkflowStep("",0),n={};t.businessProcessFlowEntities.forEach(t=>{if(this._isRelationshipStep(t)){const n=this._createRelationshipCollectionStep(e,t);n&&e.appendStep(n)}else{const r=this._createEntity(e,t);r&&(e.appendStep(r),n.hasOwnProperty(r.get_EntityLogicalName())||(n[r.get_EntityLogicalName()]=!0))}}),e.set_Name(t.businessProcessFlowName),e.set_Id(t.businessProcessFlowId?t.businessProcessFlowId.guid:""),this._processObjectModel=e,this._initializeVisitor()}initializeDefaultPathManager(t,e){const n=new i;n.processManager=e,n.businessProcessFlowVisitor=this._businessProcessFlowVisitor,n.workflowStep=this._processObjectModel,n.currentEntityName=this._primaryModelName,this._defaultPathManager=new O(t,n),this._defaultPathManager.initializeComplete()}get businessProcessFlowVisitor(){return this._businessProcessFlowVisitor}getEntityStages(){if(!this._processObjectModel)return null;const t=this._processObjectModel.get_Steps(),e=[];if(t){for(let n=0;n<t.get_Count();n++){const r=t.get_item(n);r&&r instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep&&(e[e.length]=t.get_item(n))}return e}return null}getRequiredFlowStepsForStage(t,e,n,r){const a=[],i=this.getStage(t);if(!i)throw new Error(t+" is not a valid stage id.");const s=i.get_Steps();if(!s)throw new Error(t+" does not include valid steps");for(let t=0;t<s.get_Count();t++)if(s.get_item(t)instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){const e=s.get_item(t);this._isFlowStep(e)&&e.get_isProcessRequired()&&a.push(e.get_Id())}return a}getRequiredAttributesForStage(t,e,n,r){const a=[],i=this.getStage(t);if(!i)throw new Error(t+" is not a valid stage id.");const s=i.get_Steps();if(!s)throw new Error(t+" does not include valid steps");for(let t=0;t<s.get_Count();t++)if(s.get_item(t)instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){const i=s.get_item(t);if(!this._isActionStep(i)&&!this._isFlowStep(i))if(i.get_isProcessRequired())a.push(i.get_Description());else{const t=this._getDataFieldNameFromStepStep(i);t&&this._isRequiredAttribute(t,e,n,r)&&a.push(i.get_Description())}}return a}_getDataFieldNameFromStepStep(t){if(this._isActionStep(t)||this._isFlowStep(t))return null;if(this._isControlStep(t)){const e=t.get_Steps().get_item(0);return!e||e.get_isSystemControl()?null:e.get_dataFieldName()}return null}_isRequiredAttribute(t,e,n,r){if(null!=t){return 2===Object(C.pc)(r,e,n,t)}return!1}_isFlowStep(t){if(t&&t.get_Steps()&&t.get_Steps().get_Count()>0){if(t.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.FlowStep)return!0}return!1}_isActionStep(t){if(t&&t.get_Steps()&&t.get_Steps().get_Count()>0){if(t.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep)return!0}return!1}_isControlStep(t){if(t&&t.get_Steps()&&t.get_Steps().get_Count()>0){if(t.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ControlStep)return!0}return!1}_initializeVisitor(){this._businessProcessFlowVisitor=new ProcessObjectModel.Visitors.BusinessProcessFlowVisitor,this._businessProcessFlowVisitor.visit(this._processObjectModel)}_isRelationshipStep(t){return!(!t||!t.hasOwnProperty("relationships"))}_createEntity(t,e){const n=new Microsoft.Crm.Workflow.ObjectModel.EntityStep(t,e.entityLogicalName);n.set_Name(e.entityLogicalName),n.set_Description(e.entityDisplayName),n.set_relationshipName(e.relationshipName),n.set_attributeName(e.referencingAttributeName),n.set_parent(t);const r=this._createStage(t,e.stage);n&&r&&n.appendStep(r);for(let n=0;n<e.stage.steps.length;n++){const a=this._createStep(t,e.stage.steps[n]);a&&r.appendStep(a)}const a=this._createConditionStep(t,r,e.stage);return a&&r.appendStep(a),n}_createRelationshipCollectionStep(t,e){const n=new Microsoft.Crm.Workflow.ObjectModel.RelationshipCollectionStep(t);if(n.set_workflow(t),e.relationships)for(let r=0;r<e.relationships.length;r++){const a=this._createRelationshipStep(t,e.relationships[r]);n.appendStep(a)}return n}_createRelationshipStep(t,e){const n=new Microsoft.Crm.Workflow.ObjectModel.RelationshipStep(t);return n.set_workflow(t),n.set_sourceStageId(e.sourceStageId.guid),n.set_targetStageId(e.targetStageId.guid),n.set_attributeName(e.attributeName),n.set_relationshipName(e.relationshipName),n}_createStage(t,e){const n=new Microsoft.Crm.Workflow.ObjectModel.StageStep(t,e.stageDisplayName||"dummy");return n.set_Id(e.stageId.guid),n.set_stageId(e.stageId.guid),n.set_nextStageId(e.nextStageId?e.nextStageId.guid:""),n.set_stageCategory(e.stageCategory),n}_createStep(t,e){const n="action"===e.stepType.toLowerCase()?e.label:e.name,r=new Microsoft.Crm.Workflow.ObjectModel.StepStep(t,n||"dummy");r.set_isProcessRequired(e.required),r.set_Name(e.label),r.set_Id(e.stepId?e.stepId.guid:""),r.set_workflow(t);const a=new Microsoft.Crm.Workflow.ObjectModel.ControlStep(t);if(a.set_dataFieldName(n),"action"===e.stepType.toLowerCase()){const e=new Microsoft.Crm.Workflow.ObjectModel.ActionStep(t);e.set_Name(n),e.set_actionControl(a),r.appendStep(e)}else if("modernflow"===e.stepType.toLowerCase()){const e=new Microsoft.Crm.Workflow.ObjectModel.FlowStep(t);e.set_Name(n),e.set_flowControl(a),r.appendStep(e)}else r.appendStep(a);return r}_createConditionStep(t,e,n){if(!n.conditionJson)return null;const r=new Microsoft.Crm.Workflow.ObjectModel.ConditionStep(t);return r.set_parent(e),r.initializeFromDynamic(JSON.parse(n.conditionJson)),r.fixLinks(),r}getProcessObjectModel(){return this._processObjectModel}getStage(t){return Object(a.a)(t)||!this._processObjectModel?null:this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(t)?this._businessProcessFlowVisitor.get_stagesById()[t]:null}getPreviousStageId(t){if(this._defaultPathManager&&this._businessProcessFlowVisitor){const e=this._defaultPathManager.getPreviousStage(t);if(this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(e))return e}return null}getNextStageId(t){if(this._defaultPathManager&&this._businessProcessFlowVisitor){const e=this._defaultPathManager.getNextStage(t);if(this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(e))return e}return null}}},cf3Y:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="attribute.format";function i(t,e,n,i){const s=Object(r.x)(e);return{type:a,payload:i,meta:{pageId:t,contextKey:s,dataFieldName:n}}}},d0Pd:function(t,e,n){"use strict";n.d(e,"a",(function(){return j}));var r=n("3/02"),a=n("SAYH"),i=n("eXjw"),s=n("j2fa"),o=n("dQnL"),c=n("CngE"),l=n("GEBM"),u=n("0L4T"),d=n("FZDd"),p=n("EY5k"),h=n("a72m"),g=n("YxC/"),m=n("KBcj"),b=n("p/2N"),f=n("16wZ"),y=n("K3gL"),v=n("ngeo"),_=n("504W"),S=n("95wm"),O=n("haag");function C(t,e,n){return{type:"chartData.retrieve.preReq_async",execute({dispatch:r,getState:C},I){let P=C();const j=O.b+".chartData.retrieve.preReq_async",T=t.visualizationId,E=t.viewId;return r(Object(h.a)(e,void 0,t.viewType,E)).then(()=>{P=C();const h=Object(m.c)(P,E);if(!function(t,e,r,a){if(!r||!r.fetchXML)return Object(u.a)(t,e,Object(g.b)(t,l.g),a,n),!1;return!0}(P,r,h,t))return Promise.resolve(null);const f=r(Object(o.a)(e,t.visualizationType,T)),v=r(Object(p.e)(l.A));return Promise.all([f,v]).then(()=>{P=C();const e=Object(c.a)(P,T);if(function(t){if(t&&t.WebResourceId)return!0;return!1}(e))return Object(s.d)(P,r,a.a.toString(t.visualizationId),a.a.toString(t.viewId),n),Promise.resolve(t);if(!function(t,e,r,a){if(r){if(r.initialized===i.a.Error){const i=Object(y.a)(r.errorCode)||l.u;return e(Object(p.e)([i])).then(()=>{const r=Object(g.b)(t,i);Object(u.a)(t,e,r,a,n)},()=>{Object(u.a)(t,e,Object(g.b)(t,l.u),a,n)}),!1}return!!r.DataDescription||(Object(u.a)(t,e,Object(g.b)(t,l.o),a,n),!1)}return!1}(P,r,e,t))return Promise.resolve(null);t.initialized||(t.initialize(e.DataDescription,h.fetchXML,e.PresentationDescription,h.title,h.entityLogicalName,e.Name,e.PrimaryEntityTypeCode,!1),t.setupAggregationQueries());const o={},m=t.dataDefinition.allAttributeNamesByEntity;Array.from(m.keys()).map(t=>{const e=Array.from(m.get(t).keys());o[t]=e});const f=Object(b.c)(h).filter(t=>-1===t.indexOf("."));if(f&&f.length>0){const t=h.entityLogicalName;t in o?o[t].push(...f):o[t]=f}try{const t=e.PresentationDescription,n=Object(S.a)(t);if(!Object(_.b)(t)&&n.length>0){const t=h.entityLogicalName,e=[];e.push(function(t,e){const n=e[2]?e[2].toLowerCase():"";if(n.substring(0,t.length)!==t)return"";return n.substring(t.length+1,n.length)}(t,n)),t in o?o[t].push(...e):o[t]=e}}catch(t){const e="Failed to retrieve entity metadata attributes for Chart Series with error : "+t.message;I.EventManager.ReportComponentFailure(j,Error(e))}return r(Object(d.e)(o)).then(()=>t)},e=>(Object(u.b)(e.getNegativeErrorCode(),C(),r,Object(g.b)(C(),l.q),t,n),Promise.resolve(null)))},e=>{const a=e&&!Object(f.a)(e.errorCode)&&e.errorCode,i=Object(y.a)(a),s=i?Object(g.b)(P,i):"retrieve chart failed. error code: "+v.a.getHexErrorCodeFromInt(a);return Object(u.a)(P,r,s,t,n),Promise.resolve(null)})}}}var I=n("Tezb"),P=n("Lyxw");function j(t,e,n,o=!1){return{type:"chartData.retrieve.async",execute({dispatch:l,getState:u},d){const p=[];try{p.push({name:O.g,value:a.a.toString(t.viewId)}),p.push({name:O.h,value:a.a.toString(t.visualizationId)});const h=u(),g=t.visualizationId,m=a.a.toString(g),b=t.viewId,f=a.a.toString(b);if(!Object(S.b)(u,l,d,p,t,e,n))return Promise.resolve();let y;const v=Object(P.c)(h,r.rd);return y=v?Object(c.e)(h,t.getStorageKey()):Object(c.d)(h,m,f),(y===i.a.Initialized&&Object(c.b)(h,m,f)||y===i.a.Initializing)&&!o?Promise.resolve():(l(v?Object(S.d)(t.getStorageKey(),I.c):Object(S.c)(m,f,I.c)),l(C(t,e,n)).then(t=>{if(!t||t.isWebResourceChart)return Promise.resolve();const r=t;return l(Object(s.b)(r,e,n))}))}catch(t){return d.EventManager.ReportComponentFailure(S.f+".retrieveChartData",Error(t),O.b,p),Promise.reject(t)}}}}},dIqG:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="navigation.item.visibility";function a(t,e,n){return{type:r,payload:{show:n},meta:{pageId:t,navigationItemId:e}}}},dMZy:function(t,e,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(){return{tabId:"",navigationStack:[]}}n.d(e,"a",(function(){return r}))},dQnL:function(t,e,n){"use strict";n.d(e,"a",(function(){return _}));var r=n("SAYH"),a=n("eXjw"),i=n("95wm"),s=n("CngE"),o=n("haag"),c=n("BzGi"),l=n("K7RF"),u=n("Nb1E"),d=n("odYE"),p=n("2XFH"),h=n("Uv1Y"),g=n("Tezb"),m=n("/oKV"),b=n("iJGp"),f=n("S2mk"),y=n("3/02"),v=n("Lyxw");function _(t,e=c.a.savedvisualization,n){const p=[];return p.push({name:o.f,value:t}),p.push({name:o.i,value:e}),p.push({name:o.h,value:r.a.toString(n)}),{type:"chart.retrieve.async",execute({dispatch:g,getState:f},_){try{let S=m.a.LocalAndRemote;const C=_.TraceManager.getTracer(o.d),j=_.DataSource,F=f();let w=n;if(C.info(o.d+"entityTypeName:"+t+"visualizationType:"+e+"visualizationId:"+n),!t){const t="entityTypeName is null";return _.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error(t),o.d,p),Promise.reject(t)}r.a.isNullOrEmpty(w)&&(w=Object(s.j)(F,t));const x=Object(v.c)(f(),y.A);if(!r.a.isNullOrEmpty(w)){const n=Object(s.f)(F,w),r=Object(s.g)(F,w),f=()=>{const n=Object(s.a)(F,w),r=function(t,e,n,r){const a=c.a[n],i=Object(s.i)(t,e);return i&&i.chartTypes&&i.chartTypes[a]&&i.chartTypes[a][r.guid]}(F,t,e,w),a=r&&!r.IsUserChart;switch(Object(l.d)(F,a,n,()=>r)){case 1:S=m.a.Remote;break;case 2:g(function(t,e,n){const r=[];return r.push({name:"entityTypeName",value:e}),r.push({name:"visualizationType",value:n}),{type:"chartselector.retrieve.async",execute({dispatch:t,getState:a},s){try{return t(Object(l.b)(c.a[n],null,e,null,!0,b.a.OnDemandWithContext,null,null,[],null,m.a.LocalAndRemote)).catch(h.b)}catch(t){throw s.EventManager.ReportComponentFailure(i.f+"._retrieveChartSelector",Error(t),o.e,r),t}}}}(0,t,e))}};if(n===a.a.Initialized){if(f(),S!==m.a.LocalAndRemote)return I(g,j,t,w,e,S,_,p);if(x&&r===a.a.Uninitialized){const t=new d.a(e===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",w),n=Object(s.a)(F,w);return g(O(w,a.a.Initialized)),g(Object(u.d)(t)).catch(h.b).then(t=>(P(n,t),g(T(t)),_.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData"),Promise.resolve(w)),t=>(E(g,t,w.guid,n,_,p),Promise.resolve(w)))}return Promise.resolve(w)}return I(g,j,t,w,e,S,_,p)}return I(g,j,t,w,e,S,_,p)}catch(t){throw _.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error(t),o.d,p),t}}}}function S(t){return{type:"chart.dependencies.update.async",execute({dispatch:e,getState:n},a){const i=[];for(const e in t)i.push(t[e]+":name");if(i.length>0){return e(Object(p.a)(i)).then(()=>{const a=new Map,i=n();for(const e in t){const n=t[e],o=Object(s.a)(i,new r.a(n));o&&n&&i.metadata.labels&&i.metadata.labels[n]&&i.metadata.labels[n].name&&(o.Name=i.metadata.labels[n].name,a.set(n,o))}a.size>0&&e(function(t){const e={};t.forEach((t,n)=>{e[n]=t});return{type:"chart.descriptor.update",payload:{charts:e}}}(a))},h.b)}return Promise.resolve()}}}function O(t,e){const n=r.a.isNullOrEmpty(t)?null:{charts:{[r.a.toString(t)]:{initialized:e,oDataInitialized:a.a.Initializing}}};return{type:g.f,payload:n}}function C(t,e,n,s=c.a.savedvisualization,p){const g=[];return g.push({name:o.f,value:e}),g.push({name:o.i,value:s}),g.push({name:o.h,value:r.a.toString(n)}),{type:"chart.retrieve.async",execute:({dispatch:t,getState:o},m)=>Object(v.c)(o(),y.A)?n?function(t,e,n,s,o,p,g){const m=new d.a(s===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",n);return t(O(n,a.a.Initializing)),Promise.all([t(Object(l.b)(c.a[s],null,e,r.a.toLegacyGuid(n),!0,b.a.OnDemandWithContext,null,null,[],null,o)).catch(h.b),t(Object(u.d)(m)).catch(h.c)]).then(e=>(e[1].constructor===h.a?E(t,e[1],n.guid,e[0].charts[n.guid],p,g):(P(e[0].charts[n.guid],e[1]),t(T(e[1])),p.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData")),e[0]))}(t,e,n,s,p,m,g):function(t,e,n,s,o,p,g){return t(Object(l.b)(c.a[s],null,e,r.a.toLegacyGuid(n),!0,b.a.OnDemandWithContext,null,null,[],null,o)).catch(h.b).then(e=>{const n=new r.a(Object.keys(e.charts)[0]),o=new d.a(s===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",n);return t(O(n,a.a.Initializing)),t(Object(u.d)(o)).catch(h.b).then(r=>(P(e.charts[n.guid],r),t(T(r)),p.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData"),e),r=>(E(t,r,n.guid,e.charts[n.guid],p,g),e))})}(t,e,n,s,p,m,g):function(t,e,n,a,i){return t(Object(l.b)(c.a[a],null,e,r.a.toLegacyGuid(n),!0,b.a.OnDemandWithContext,null,null,[],null,i)).catch(h.b)}(t,e,n,s,p)}}function I(t,e,n,s,c,l,u,d){return t(function(t){const e=r.a.isNullOrEmpty(t)?null:{charts:{[r.a.toString(t)]:{initialized:a.a.Initializing}}};return{type:g.b,payload:e}}(s)),t(C(0,n,s,c,l)).then(e=>{e&&e.chartSelectors&&!e.chartSelectors[n]&&(e.chartSelectors[n]={initialized:a.a.Initialized,chartTypes:{}});const o=[];for(const t in e.charts)o.push(t);return t(S(o)).then(()=>(t(j(e)),r.a.isNullOrEmpty(s)&&(s=e.chartDefaults[n]),u.EventManager.ReportComponentSuccess(i.f+".retrieveChart"),s),h.b)},e=>{const c=e&&!Object(f.j)(e.errorCode)&&e.errorCode,l={chartSelectors:{[n]:{initialized:a.a.Initialized,chartTypes:{}}}};if(t(j(l)),Object(f.j)(c))return u.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error(e),o.d,d),Object(h.b)(e);{const e={charts:{[r.a.toString(s)]:{initialized:a.a.Error,errorCode:c}}};t(j(e))}})}function P(t,e){t.PresentationDescription=e.presentationdescription.replace(/(\r\n\s*)/g,""),t.oDataInitialized=a.a.Initialized}function j(t){return{type:g.b,payload:t}}function T(t){return{type:g.f,payload:t}}function E(t,e,n,r,s,c){t(T({charts:{[n]:{initialized:r.initialized,oDataInitialized:a.a.Error}}})),s.EventManager.ReportComponentFailure(i.f+".retrieveChartOData",Error(e),o.c,c)}},dtbk:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="navigation.item.defaultvalues";function a(t,e,n){return{type:r,payload:{allNavBarByRelationshipItems:e,currentLanguageId:n},meta:{pageId:t}}}},fREn:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return u}));var r=n("eXjw"),a=n("dHD5"),i=n("37s6"),s=n("a8zb"),o=n("BoVI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(t,e,n,i,s,c,u,d){const p=Object(a.v)(s),h=function(t,e){if(!t)return null;const n=new DOMParser,r=t?n.parseFromString(t,"text/xml"):null;if(!r)return null;const a=r.documentElement?r.documentElement.children?r.documentElement.children:r.documentElement.childNodes:void 0;if(!a)return null;const i=a,s=[];for(let t=0;t<i.length;t++){if(!i[t].getAttribute)continue;const r=i[t]?i[t].children?i[t].children:i[t].childNodes:void 0,a=[];let o=null;for(let t=0;t<r.length;t++){const i=r[t];if(!i.getAttribute)continue;const s=i.getAttribute("name");let c;({relatedEntityName:c,fetchXmlDocument:o}=l(s,o,n,e)),a.push({name:s,width:parseInt(i.getAttribute("width"),10),relatedEntityName:c,disableMetaDataBinding:"1"===i.getAttribute("disableMetaDataBinding"),labelId:i.getAttribute("labelId"),isHidden:"1"===i.getAttribute("isHidden"),disableSorting:"1"===i.getAttribute("disableSorting"),addedBy:i.getAttribute("addedBy"),desc:i.getAttribute("desc"),cellType:i.getAttribute("cellType"),imageProviderWebresource:i.getAttribute("imageProviderWebresource"),imageProviderFunctionName:i.getAttribute("imageProviderFunctionName")})}const c={name:i[t].getAttribute("name"),id:i[t].getAttribute("id"),cells:a,multiObjectIdField:i[t].getAttribute("multiObjectIdField"),layoutStyle:i[t].getAttribute("multiObjectIdField")};s.push(c)}return{name:r.documentElement.getAttribute("name"),object:parseInt(r.documentElement.getAttribute("object"),10),rows:s,customControlDescriptions:null,jump:r.documentElement.getAttribute("jump"),select:"1"===r.documentElement.getAttribute("select"),icon:"1"===r.documentElement.getAttribute("icon"),preview:"1"===r.documentElement.getAttribute("preview"),iconRenderer:null}}(d,u),g={initialized:r.a.Initialized,viewId:n,fetchXML:u,entityLogicalName:i,title:c,layoutXML:d,grid:h,isCustomView:!0};return{type:o.a,payload:{views:{[n.guid]:g}},meta:{pageId:t,controlName:e,contextKey:p}}}function l(t,e,n,r){let a="";if(t.indexOf(".")>0){const i=t.split(".")[0];e||(e=n.parseFromString(r,"text/xml"));const s=e.querySelector('link-entity[alias="'+i+'"]');s&&(a=s.getAttribute("name")||"")}return{relatedEntityName:a,fetchXmlDocument:e}}function u(t){return{type:o.f,execute:(e,n)=>(Object(i.w)(e.getState())?s.a.createSqlfromFetchXMLAsync(e,t.fetchXML):Promise.resolve(null)).then(e=>t.offlineSqlQuery=e)}}},fyfl:function(t,e,n){"use strict";n.d(e,"a",(function(){return p})),n.d(e,"b",(function(){return d}));var r=n("SAYH"),a=n("FZDd"),i=n("d0w6"),s=n("Uv1Y"),o=n("a72m"),c=n("BFlg"),l=n("kKLx"),u=n("P6DH");function d(t,e,n){return{type:"datasethost.dependencies.retrieve.async",execute({dispatch:d,getState:h},g){const m=g.TraceManager.getTracer(c.z),b=c.x+".loadDataSetHostDependenciesAction";m.info(`Retrieving view with ID ${r.a.toString(e)} for ${t} entity.`);const f=Object(u.pb)(h(),t,e);return d(Object(o.a)(t,i.a.MAIN_APPLICATION_VIEW,f,e)).then(i=>{if(!i){const n=`Unable to retrieve DataSetHost dependencies for the grid. Failed to retrieve view with ID ${r.a.toString(e)} for ${t}`;return g.EventManager.ReportComponentFailure(b,Error(n)),Promise.reject(new s.a(l.b))}const o=p(h(),e,n);return d(Object(a.e)(o)).then(()=>{const n=[{name:"entityTypeName",value:t},{name:"viewId",value:r.a.toString(e)}];return g.EventManager.ReportComponentSuccess(b,n),Promise.resolve()}).catch(n=>{let a=[];for(const t in o)o[t].length&&(a=[...o[t],...a]);const i=`Unable to retrieve DataSetHost dependencies for the grid for view with ID ${r.a.toString(e)}. Failed to retrieve entity with attributes ${a.join()} for ${t}`;return g.EventManager.ReportComponentFailure(b,Error(i)),Promise.reject(new s.a(l.a))})})}}}function p(t,e,n){const r=Object(u.qb)(t,e,n),a={};if(r&&r.grid&&r.grid.rows&&r.grid.rows[0]&&r.grid.rows[0].cells){const t=[];r.grid.rows[0].cells.forEach(e=>{if(!e.disableMetaDataBinding)if(e.relatedEntityName){if(e.name&&-1!==e.name.indexOf(".")){const t=e.name.split(".")[1];a[e.relatedEntityName]||(a[e.relatedEntityName]=[]),-1===a[e.relatedEntityName].indexOf(t)&&t&&a[e.relatedEntityName].push(t)}}else-1===t.indexOf(e.name)&&t.push(e.name)}),t.length>0&&(a[r.entityLogicalName]=t)}return a}},gDO8:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="form.setFormLoadError";function a(t,e){return{type:r,payload:{error:e},meta:{pageId:t}}}},hA8P:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="control.mrudisabled";function i(t,e,n,i,s){const o=Object(r.v)(i);return{type:a,payload:s,meta:{pageId:e,controlName:n,contextKey:o}}}},hHCe:function(t,e,n){"use strict";n.r(e),n.d(e,"CustomControl",(function(){return v}));var r=n("Nk+G"),a=n("Z/4N"),i=n("oOvK"),s=n("arV0"),o=n("XVX7"),c=n("dHD5"),l=n("Z4sG"),u=n("ZFRl");var d=n("4rWj"),p=n("YWpA"),h=n("u+q+"),g=n("223Y"),m=n("nuS9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function b(t){return{FormFactor:2,CustomControlId:t.customcontrolId,Name:"",Version:"1.0.0",Parameters:{},ShouldOverrideControlVisible:!1}}function f(t){return{Id:t.customcontrolId,Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1,FullPageParamers:t.data}}const y=Object(h.a)((function(){let t,e,n,r,i;return(o,l)=>{const u=l.id,{customControlId:d,data:p}=Object(s.g)(o,u),h=Object(a.e)(o,d);return t=t||Object(c.b)(o,u),h===r&&d===e&&p===n||(r=h,e=d,n=p,i={data:n,customcontrolId:e,manifest:r,contextToken:t}),i}}))((function(t){return t.customcontrolId&&t.manifest?m.createElement(p.a,{key:"customControlRoot",style:{display:"flex",flexDirection:"row",flex:"auto"}},m.createElement(g.c,{key:t.customcontrolId,id:t.id,controlId:t.customcontrolId,configuration:b(t),descriptor:f(t),parentContextToken:t.contextToken})):null}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class v{constructor(t){var e;this._id=t,this._initializationAction=(e=this._id,{type:"customcontrol.initialize.async",execute(t,n){const{dispatch:r,getState:d}=t;Object(l.a)(t,n,e);const{customControlId:p}=Object(s.g)(d(),e),h=Object(c.e)(void 0,p),g=r(Object(i.c)(p)),m=n.ScriptManager.initializeContainerForClientApi(e);return Promise.all([m,g]).then(()=>{if(!Object(a.e)(d(),p))throw new Error("Manifest not found");r(Object(o.a)(!0,e,h)),r(Object(u.c)(e,null))})}})}getName(){return r.a}getId(){return this._id}getInitializationAction(){return this._initializationAction}getRootReducer(){return d.a}getRootComponent(){return y}getCloseAction(t){}}},"hQd/":function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));class r{constructor(t){this._value=null,this._value=t}get value(){return this._value}set value(t){this._value=t}}},hSDL:function(t,e,n){"use strict";n.d(e,"e",(function(){return s})),n.d(e,"b",(function(){return o})),n.d(e,"f",(function(){return c})),n.d(e,"g",(function(){return l})),n.d(e,"d",(function(){return u})),n.d(e,"c",(function(){return p})),n.d(e,"a",(function(){return d})),n.d(e,"l",(function(){return m})),n.d(e,"i",(function(){return b})),n.d(e,"m",(function(){return f})),n.d(e,"n",(function(){return y})),n.d(e,"k",(function(){return v})),n.d(e,"h",(function(){return _})),n.d(e,"o",(function(){return g})),n.d(e,"j",(function(){return S}));var r=n("dHD5"),a=n("BFlg"),i=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="grid.applyFilter",o="grid.applyActivityTypeFilter",c="grid.applyJumpBarFilter",l="grid.applyQuickFindFilter",u="grid.applyFilterCurrentValue",d="grid.applyActivityTypeFilterCurrentValue",p="grid.applyAdvancedFindFilter";function h(t,e,n,i){return{type:"grid.applyFilter.async",execute({dispatch:s},o){const c=o.TraceManager.getTracer(a.z),l=a.x+".applyGridFilterAction",u=Object(r.v)(i),d=[];d.push({name:a.n,value:t}),d.push({name:a.e,value:u});try{return c.info("Applying the filter expression to the grid. "),s(function(t,e,n,r){return{type:t,payload:e,meta:{pageId:n,dataSetContextKey:r}}}(t,e,n,u)),o.EventManager.ReportComponentSuccess(l,d),Promise.resolve()}catch(t){const e="Applying the filter expression to the grid failed ";o.EventManager.ReportComponentFailure(l,Error(e),"",d)}}}}function g(t,e,n){const a=Object(r.v)(n);return{type:c,payload:t,meta:{pageId:e,dataSetContextKey:a}}}const m=(t,e,n)=>h(s,t,e,n),b=(t,e,n)=>h(o,t,e,n),f=(t,e,n)=>h(c,t,e,n),y=(t,e,n)=>h(l,Object(i.a)(t)?t:t.trim(),e,n),v=(t,e,n)=>h(u,t,e,n),_=(t,e,n)=>h(d,t,e,n),S=(t,e,n)=>h(p,t,e,n)},haag:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"g",(function(){return a})),n.d(e,"h",(function(){return i})),n.d(e,"f",(function(){return s})),n.d(e,"i",(function(){return o})),n.d(e,"d",(function(){return c})),n.d(e,"e",(function(){return l})),n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Chart.Component",a="ViewId",i="visualizationId",s="entity Type",o="chart visualization type",c="RETRIEVECHART",l="RETRIEVECHARTTS_RETRIEVECHARTSELECTOR",u="RETRIEVECHARTTS_RETRIEVECHARTDATA",d="RETRIEVECHARTTS_RETRIEVECHARTODATA"},iHOm:function(t,e,n){"use strict";n.d(e,"a",(function(){return at}));var r=n("2YQW"),a=n("ZJsz"),i=n("RrRu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s=[],o=Object(r.d)({[i.a]:function(t=s,e){return e.payload?e.payload:t}},s);var c=n("jRHm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const l=Object(r.d)({[c.a]:function(t=null,e){return e?e.payload:t}},null);var u=n("Jpj4"),d=n("ApeL"),p=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const h=Object(r.d)({[u.a]:function(t=null,e){return e.payload?e.payload:t},[d.b]:function(t=null,e){if(t&&t.records){const n=t.records.filter(t=>Object.keys(t)[0]===p.a.toString(e.payload.recordId));if(n&&n.length){const t=n[0];t&&t[p.a.toString(e.payload.recordId)]&&t[p.a.toString(e.payload.recordId)].filter(t=>Object.keys(t)[0]===e.payload.attributeName)&&(void 0!==e.payload.requiredLevel&&(t[p.a.toString(e.payload.recordId)].filter(t=>Object.keys(t)[0]===e.payload.attributeName)[0][e.payload.attributeName].requiredLevel=e.payload.requiredLevel),void 0!==e.payload.isDisabled&&(t[p.a.toString(e.payload.recordId)].filter(t=>Object.keys(t)[0]===e.payload.attributeName)[0][e.payload.attributeName].isDisabled=e.payload.isDisabled),void 0!==e.payload.notifications&&(t[p.a.toString(e.payload.recordId)].filter(t=>Object.keys(t)[0]===e.payload.attributeName)[0][e.payload.attributeName].notifications=e.payload.notifications))}}return t},[d.a]:function(t=null,e){return t}},null);var g=n("hSDL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const m={activityOrQueue:null,jumpBar:null,quickFind:null,advancedFindFilter:null,activityOrQueueFilterValue:null,activityTypeFilter:null,activityTypeSelectedValues:null},b=function(t=m,e){switch(e.type){case g.e:return Object.assign(Object.assign({},t),{activityOrQueue:e.payload});case g.b:return Object.assign(Object.assign({},t),{activityTypeFilter:e.payload});case g.f:return Object.assign(Object.assign({},t),{jumpBar:e.payload});case g.g:return Object.assign(Object.assign({},t),{quickFind:e.payload});case g.d:return Object.assign(Object.assign({},t),{activityOrQueueFilterValue:e.payload});case g.c:return Object.assign(Object.assign({},t),{advancedFindFilter:e.payload});case g.a:return Object.assign(Object.assign({},t),{activityTypeSelectedValues:e.payload});default:return t}},f=Object(r.d)({[g.e]:b,[g.f]:b,[g.g]:b,[g.d]:b,[g.c]:b,[g.b]:b,[g.a]:b},m);var y=n("QXpm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const v=Object(r.d)({[y.a]:function(t=false,e){return t!==e.payload?e.payload:t}},false);var _=n("E6o7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const S=Object(r.d)({[_.a]:function(t="",e){return e.payload?e.payload:t}},"");var O=n("ojtV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const C=Object(r.d)({[O.a]:function(t=false,e){return e.payload&&"showChart"===e.payload.name?e.payload.value:t}},false);var I=n("iOrn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const P={customFilterXml:null,source:null,timeStamp:null},j=Object(r.d)({[I.a]:function(t=P,e){return null!=e.payload?e.payload:t}},P);var T=n("LAGg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const E=Object(r.d)({[T.a]:function(t,e){if(e.payload)return e.payload;return t}},0);var F=n("mLMm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const w=Object(r.d)({[F.a]:function(t,e){if(e.payload)return e.payload;return t}},0);var x=n("waMg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const A=Object(r.d)({[x.a]:function(t=null,e){return e.payload?e.payload:t}},null);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function N(t,e){return e.payload?e.payload:t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function k(t=!1,e){return t!==e.payload?e.payload:t}var D=n("Utin");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const M=Object(r.d)({[D.a]:function(t=null,e){return e.payload&&"ViewId"===e.payload.name?p.a.tryParseOrNull(e.payload.value):t}},null);var R=n("WK+4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const L=Object(r.d)({[R.a]:function(t=null,e){return e.payload&&"VisualizationId"===e.payload.name?p.a.tryParseOrNull(e.payload.value):t}},null);var V=n("qwRa");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const B=n("BzGi").a.savedvisualization,G=Object(r.d)({[V.a]:function(t=B,e){return e.payload&&"chartVisualizationType"===e.payload.name?e.payload.value:t}},B),X={parameters:{}};const U=Object(r.d)({[D.a]:function(t=X,e){const n=e.payload.name,r=t.parameters;let a;for(const t in r)r[t].Name===n&&(a=t);const i=Object.assign(Object.assign({},t.parameters[a]),{Value:e.payload.value}),s=Object.assign(Object.assign({},t.parameters),{[a]:i});return s[n]&&(s[n]=e.payload.value),Object.assign(Object.assign({},t),{parameters:s})}},X),q=Object(r.b)("controlName",U);var z=n("s+OO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const H=Object(r.d)({[z.b]:(t="",e)=>e.payload&&e.payload.name===z.a?e.payload.value:t},"");var W=n("7k+e");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Y=[],K=Object(r.d)({[W.b]:(t=Y,e)=>e.payload&&e.payload.name===W.a?e.payload.value:t},Y);var Q=n("L4PC"),J=n("5UPV"),Z=n("zFtG"),$=n("Wdaq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function tt(t,e){return e.payload?e.payload:t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const et=Object(r.d)({[$.a]:function(t,e){if(e)return e.payload;return t}},"");var nt=n("ujVH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const rt=Object(r.d)({[nt.a]:function(t=null,e){return e.payload?e.payload:t}},null),at=Object(r.b)("dataSetContextKey",(t=a.a,e)=>{switch(e.type){case i.a:return Object.assign(Object.assign({},t),{selectedRows:o(t.selectedRows,e)});case c.a:return Object.assign(Object.assign({},t),{selectedRelatedEntity:l(t.selectedRelatedEntity,e)});case u.a:return Object.assign(Object.assign({},t),{rowProperties:h(t.rowProperties,e)});case T.a:return Object.assign(Object.assign({},t),{refreshCounter:E(t.refreshCounter,e)});case F.a:return Object.assign(Object.assign({},t),{pagingRefreshInput:w(t.pagingRefreshInput,e)});case x.a:return Object.assign(Object.assign({},t),{queryKey:A(t.queryKey,e)});case I.a:return Object.assign(Object.assign({},t),{customFilter:j(t.customFilter,e)});case g.e:case g.b:case g.f:case g.g:case g.d:case g.c:case g.a:return Object.assign(Object.assign({},t),{filters:f(t.filters,e)});case y.a:return Object.assign(Object.assign({},t),{useRollupView:v(t.useRollupView,e)});case _.a:return Object.assign(Object.assign({},t),{fetchXml:S(t.fetchXml,e)});case D.a:return Object.assign(Object.assign({},t),{viewId:M(t.viewId,e),controls:q(t.controls,e)});case R.a:return Object.assign(Object.assign({},t),{visualizationId:L(t.visualizationId,e)});case V.a:return Object.assign(Object.assign({},t),{chartVisualizationType:G(t.chartVisualizationType,e)});case d.b:case d.a:return Object.assign(Object.assign({},t),{rowProperties:h(t.rowProperties,e)});case Q.a:return Object.assign(Object.assign({},t),{pageNumber:N(t.pageNumber,e)});case J.a:return Object.assign(Object.assign({},t),{isNewPageRequested:k(t.isNewPageRequested,e)});case Z.a:return Object.assign(Object.assign({},t),{pagingData:tt(t.pagingData,e)});case $.a:return Object.assign(Object.assign({},t),{commandManagerId:et(t.commandManagerId,e)});case z.b:return Object.assign(Object.assign({},t),{chartFilterExpression:H(t.chartFilterExpression,e)});case W.b:return Object.assign(Object.assign({},t),{chartDrillDownParameters:K(t.chartDrillDownParameters,e)});case O.a:return Object.assign(Object.assign({},t),{showChart:C(t.showChart,e)});case nt.a:return Object.assign(Object.assign({},t),{dependentOptionSetColumnStatus:rt(t.dependentOptionSetColumnStatus,e)});default:return t}})},iOrn:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s}));var r=n("dHD5"),a=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="grid.setCustomFilter";function s(t,e,n,s,o){return{type:"grid.setCustomFilter.async",execute({dispatch:c,getState:l},u){const d=u.TraceManager.getTracer(a.z),p=a.x+".setCustomFilterAction";try{return d.info("Adding a custom filter for the grid. "),c(function(t,e,n,a,s){let o=null;if(null!=t){o={customFilterXml:t,source:e,timeStamp:s||null}}const c=Object(r.y)(a),l=Object(r.v)(a);return{type:i,payload:o,meta:{pageId:n,contextKey:c,dataSetContextKey:l}}}(t,e,n,s,o)),u.EventManager.ReportComponentSuccess(p),Promise.resolve()}catch(t){const e="Adding a custom filter for the grid failed";u.EventManager.ReportComponentFailure(p,Error(e))}}}}},iWfp:function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return o}));var r=n("nuS9"),a=n("Gilj"),i=n("FhVi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(t,e,n,r,i,s){return new a.a(t,t=>{e(t.EVENT)},n,r,i,s)}function o(t){return r.createElement(i.a,{key:t.id,keyboardShortcuts:t.keyboardShortcuts,defaultFocusId:t.defaultFocusId,rootElementId:t.rootElementId,isModal:t.isModal,shouldManageFocus:t.shouldManageFocus||!1})}},j2fa:function(t,e,n){"use strict";n.d(e,"b",(function(){return St})),n.d(e,"d",(function(){return Ot})),n.d(e,"e",(function(){return Ct})),n.d(e,"c",(function(){return It})),n.d(e,"a",(function(){return Pt}));var r=n("Wgxh"),a=n("SAYH"),i=n("eXjw"),s=n("95wm");var o=n("fKWG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var c=n("odYE"),l=n("VcAV"),u=n("MXaZ");class d{constructor(){this._dataPointAggregators=new Array(0),this._dataPointDateTimeRangeAggregatorInfoMap=new Map,this._dataPointFiscalPeriodAggregators=new Array(0),this._dataPointFiscalYearAggregators=new Array(0)}addAggregator(t,e,n,r,i){if(n>=o.a.DAY&&n<o.a.FISCAL_PERIOD)this._addDateTimeRangeAggregatorInfo(t,e,n,r,i);else if(n===o.a.FISCAL_PERIOD)this._addDataPointFiscalPeriodAggregator(t,e,r,i);else if(n===o.a.FISCAL_YEAR)this._addDataPointFiscalYearAggregator(t,e,r,i);else{const n=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(t){return{FieldName:t&&t.FieldName||null,EntityName:t&&t.EntityName||null,LinkEntityExpressionArray:t&&t.LinkEntityExpressionArray||null,Value:t&&t.Value||null,DisplayName:t&&t.DisplayName||null,EntityLogicalName:t&&t.EntityLogicalName||null}}();if(n.FieldName=t,n.EntityName=r,n.LinkEntityExpressionArray=i,Object(l.c)(e))n.Value=null;else if(e instanceof c.a){const t=e;n.Value=t.id.guid,n.DisplayName=t.name,n.EntityLogicalName=t.etn}else e instanceof a.a?n.Value=a.a.toString(e):n.Value=e.toString();this._dataPointAggregators.push(n)}}static _daysInMonth(t,e){return new Date(t,e,0).getDate()}_addDataPointFiscalPeriodAggregator(t,e,n,r){const a=function(t){return{FieldName:t&&t.FieldName||null,EntityName:t&&t.EntityName||null,LinkEntityExpressionArray:t&&t.LinkEntityExpressionArray||null,FiscalType:t&&t.FiscalType||null,Year:t&&t.Year||0,Period:t&&t.Period||0}}();if(a.FiscalType="in-fiscal-period-and-year",a.FieldName=t,a.EntityName=n,a.LinkEntityExpressionArray=r,!e)return void this._dataPointFiscalPeriodAggregators.push(a);if("string"!=typeof e)throw new Error("value should be string");if(e.indexOf("-")<=0)throw new Error("value should have xxxx-yy format");const i=e.split("-");a.Year=Number(i[0]),a.Period=Number(i[1]),this._dataPointFiscalPeriodAggregators.push(a)}_addDataPointFiscalYearAggregator(t,e,n,r){const a=function(t){return{FieldName:t&&t.FieldName||null,EntityName:t&&t.EntityName||null,LinkEntityExpressionArray:t&&t.LinkEntityExpressionArray||null,FiscalType:t&&t.FiscalType||null,Year:t&&t.Year||0}}();if(a.FiscalType="in-fiscal-year",a.FieldName=t,a.EntityName=n,a.LinkEntityExpressionArray=r,e){if("number"!=typeof e)throw new Error("value should be number");a.Year=Number(e),this._dataPointFiscalYearAggregators.push(a)}else this._dataPointFiscalYearAggregators.push(a)}_addDateTimeRangeAggregatorInfo(t,e,n,r,a){let i=null;switch(this._dataPointDateTimeRangeAggregatorInfoMap.has(t)?i=this._dataPointDateTimeRangeAggregatorInfoMap.get(t):(i=function(t){return{dateTimeAggregatorDay:(null==t?void 0:t.dateTimeAggregatorDay)||null,dateTimeAggregatorWeek:(null==t?void 0:t.dateTimeAggregatorWeek)||null,dateTimeAggregatorMonth:(null==t?void 0:t.dateTimeAggregatorMonth)||null,dateTimeAggregatorYear:(null==t?void 0:t.dateTimeAggregatorYear)||null,dateTimeAggregatorFieldName:(null==t?void 0:t.dateTimeAggregatorFieldName)||null,dateTimeAggregatorEntityName:(null==t?void 0:t.dateTimeAggregatorEntityName)||null,dateTimeAggregatorLinkEntityExpressionArr:(null==t?void 0:t.dateTimeAggregatorLinkEntityExpressionArr)||null,dateTimeAggregatorPrecision:(null==t?void 0:t.dateTimeAggregatorPrecision)||o.a.YEAR}}({dateTimeAggregatorFieldName:t}),this._dataPointDateTimeRangeAggregatorInfoMap.set(t,i)),i.dateTimeAggregatorEntityName||(i.dateTimeAggregatorEntityName=r),i.dateTimeAggregatorLinkEntityExpressionArr||(i.dateTimeAggregatorLinkEntityExpressionArr=a),n){case o.a.DAY:i.dateTimeAggregatorDay=Number(e);break;case o.a.WEEK:i.dateTimeAggregatorWeek=Number(e);break;case o.a.MONTH:i.dateTimeAggregatorMonth=Number(e);break;case o.a.QUARTER:i.dateTimeAggregatorMonth=3*Number(e);break;case o.a.YEAR:i.dateTimeAggregatorYear=Number(e);break;default:throw new Error("DateTime Group type not supported")}i.dateTimeAggregatorPrecision=Math.min(n,i.dateTimeAggregatorPrecision)}_getDataPointDateTimeRangeAggregators(t,e){const n=new Array(0);return 0===this._dataPointDateTimeRangeAggregatorInfoMap.size||this._dataPointDateTimeRangeAggregatorInfoMap.forEach((r,a)=>{const i={FieldName:(null==s?void 0:s.FieldName)||null,EntityName:(null==s?void 0:s.EntityName)||null,LinkEntityExpressionArray:(null==s?void 0:s.LinkEntityExpressionArray)||null,MinDate:(null==s?void 0:s.MinDate)||null,MaxDate:(null==s?void 0:s.MaxDate)||null};var s;if(i.FieldName=r.dateTimeAggregatorFieldName,i.EntityName=r.dateTimeAggregatorEntityName,i.LinkEntityExpressionArray=r.dateTimeAggregatorLinkEntityExpressionArr,r.dateTimeAggregatorYear){switch(r.dateTimeAggregatorMonth=r.dateTimeAggregatorMonth?r.dateTimeAggregatorMonth:12,r.dateTimeAggregatorDay=r.dateTimeAggregatorDay?r.dateTimeAggregatorDay:d._daysInMonth(r.dateTimeAggregatorYear,r.dateTimeAggregatorMonth),i.MaxDate=new Date(r.dateTimeAggregatorYear,r.dateTimeAggregatorMonth-1,r.dateTimeAggregatorDay),r.dateTimeAggregatorPrecision){case o.a.DAY:p(i.MaxDate),i.MinDate=new Date(i.MaxDate.getFullYear(),i.MaxDate.getMonth(),i.MaxDate.getDate());break;case o.a.WEEK:{e===u.a.FirstFullWeekOfTheYear&&(e=u.a.FirstDayOfTheYear);let n=Object(u.s)(r.dateTimeAggregatorYear,r.dateTimeAggregatorWeek,t,e),a=Object(u.s)(r.dateTimeAggregatorYear,r.dateTimeAggregatorWeek+1,t,e);if(a.setDate(a.getDate()-1),e===u.a.FirstDayOfTheYear){if(a>=new Date(r.dateTimeAggregatorYear+1,0,1))a=new Date(r.dateTimeAggregatorYear+1,0,0);else if(1===r.dateTimeAggregatorWeek){const t=new Date(r.dateTimeAggregatorYear,0,1);n<t&&(n=t)}}i.MinDate=n,i.MaxDate=a,p(i.MaxDate),p(i.MinDate);break}case o.a.MONTH:i.MinDate=new Date(i.MaxDate.getFullYear(),i.MaxDate.getMonth()-1,d._daysInMonth(r.dateTimeAggregatorYear,i.MaxDate.getMonth())+1),p(i.MaxDate),p(i.MinDate);break;case o.a.QUARTER:i.MinDate=new Date(i.MaxDate.getFullYear(),i.MaxDate.getMonth()-3,d._daysInMonth(r.dateTimeAggregatorYear,i.MaxDate.getMonth()-2)+1),p(i.MaxDate),p(i.MinDate);break;case o.a.YEAR:p(i.MaxDate),i.MinDate=new Date(i.MaxDate.getFullYear()-1,i.MaxDate.getMonth(),i.MaxDate.getDate()+1);break;default:throw new Error("DateTime Group type not supported")}n.push(i)}else n.push(i)}),n}getAggregators(t,e){let n=this._dataPointAggregators;const r=this._getDataPointDateTimeRangeAggregators(t,e);return r&&r.length>0&&(n=n.concat(r)),this._dataPointFiscalPeriodAggregators&&this._dataPointFiscalPeriodAggregators.length>0&&(n=n.concat(this._dataPointFiscalPeriodAggregators)),this._dataPointFiscalYearAggregators&&this._dataPointFiscalYearAggregators.length>0&&(n=n.concat(this._dataPointFiscalYearAggregators)),n}}function p(t){t.getTimezoneOffset()<0&&t.setDate(t.getDate()+1)}var h=n("YxC/"),g=n("GEBM"),m=n("IqkD"),b=n("Xd5/"),f=n("nfCs"),y=n("NjDY"),v=n("LbMF"),_=n("S70w"),S=n("Ae6N");function O(t,e){const n=Object(v.a)(t,e.entity.entityName,e.attributeName);let r=n?n.DisplayName:null;r||(r=e.attributeName);let a=r;if(e.dateTimeGrouping){const n=f.c(e.dateTimeGrouping.groupingType).replace("-","").toUpperCase();a=String.format(Object(h.b)(t,g.c),Object(h.b)(t,`${g.c}.${n.toUpperCase()}`),r)}else e.hasAggregate&&e.aggregateType&&(a=String.format(Object(h.b)(t,g.d),Object(h.b)(t,`${g.d}.${e.aggregateType.toUpperCase()}`),r));if(n&&"money"===n.Type){let r="",i=null;const s=Object(y.x)(t);n.IsBaseCurrency?s&&s.baseCurrencyId&&s.transactionCurrencyById&&(i=s.transactionCurrencyById[s.baseCurrencyId.guid]):e.hasAggregate&&(i=Object(m.b)(t)),i&&(r=s&&s.currencyDisplayOption===_.a.CurrencyCode?i.currencyCode:i.currencySymbol),r&&(a=String.format(Object(h.b)(t,g.b),a,r))}return a}function C(t,e,n){return n>0?String.format(Object(h.b)(t,g.y),n,e):String.format(Object(h.b)(t,g.w),e)}function I(t,e,n,r,a){const i=a<1&&r>=1&&n<1,s=a<1&&r<1&&n>=1,o=r<1&&n<1;if(a>=1&&r<1&&n>=1){const r=new Date(e,n-1,a),{formatInfoCultureName:i,numberFormatInfo:s,dateFormatInfo:o}=Object(m.w)(t),c=new Sys.CultureInfo(i,s,o);return Object(b.s)(r,c,S.a.None)}return i?String.format(Object(h.b)(t,g.z),r,e):s?String.format("{0} {1}",function(t){const e=Object(h.b)(t,g.e).split(",");if(!e||12!==e.length)throw new Error("Expect 12 months! Actual: "+e.length);return e}(t)[n-1],e):o?String(e):""}function P(t){return Object(h.b)(t,g.v)}var j=n("WPtp"),T=n("16wZ");function E(t,e,n){let r=!1;n&&n.groupAttribute&&n.groupAttribute.dateTimeGrouping&&(r=!0);return{attribute:e,primaryGroupBy:n,aliasName:e.aliasName||e.attributeName,state:t,isDateTimeChart:r}}function F(t,e){let n=t.isDateTimeChart?function(t,e){if(!e.fields||!Object(j.c)(e.fields[t.aliasName]))return"";switch(t.attribute.dateTimeGrouping.groupingType){case o.a.DAY:return function(t,e){const n=Object(j.e)(e.fields[t.aliasName]),r=Object(j.e)(e.fields[t.primaryGroupBy.extendedGroupBys[0].aliasName]),a=Object(j.e)(e.fields[t.primaryGroupBy.extendedGroupBys[1].aliasName]);return I(t.state,a,r,-1,n)}(t,e);case o.a.WEEK:return function(t,e){const n=Object(j.e)(e.fields[t.aliasName]),r=Object(j.e)(e.fields[t.primaryGroupBy.extendedGroupBys[0].aliasName]);return I(t.state,r,-1,n,-1)}(t,e);case o.a.MONTH:return function(t,e){const n=Object(j.e)(e.fields[t.aliasName]),r=Object(j.e)(e.fields[t.primaryGroupBy.extendedGroupBys[0].aliasName]);return I(t.state,r,n,-1,-1)}(t,e);case o.a.QUARTER:return function(t,e){const n=Object(j.e)(e.fields[t.aliasName]),r=Object(j.e)(e.fields[t.primaryGroupBy.extendedGroupBys[0].aliasName]);return C(t.state,r,n)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(t,e);case o.a.FISCAL_PERIOD:return function(t,e){return Object(j.e)(e.fields[t.aliasName])}(t,e);case o.a.YEAR:return function(t,e){const n=Object(j.e)(e.fields[t.aliasName]);return I(t.state,n,-1,-1,-1)}(t,e);case o.a.FISCAL_YEAR:return function(t,e){const n=Object(j.e)(e.fields[t.aliasName]);return C(t.state,n,-1)}(t,e);default:return Object(j.c)(e.fields[t.attribute.attributeName])}}(t,e):null;return n||(n=Object(j.c)(e.fields[t.aliasName]),n=n||""),0===n.length?Object(h.b)(t.state,g.v):n}function w(t,e){if(!t.attribute||!Object(v.a)(t.state,t.attribute.entity.entityName,t.attribute.attributeName))return F(t,e);switch(Object(v.a)(t.state,t.attribute.entity.entityName,t.attribute.attributeName).Type){case"picklist":case"status":case"state":case"boolean":{let n=Object(j.e)(e.fields[t.aliasName]);return n=Object(T.a)(n)?-1:Number(n),n}case"datetime":return function(t,e){let n=-1,r=-1,a=-1;switch(t.attribute.dateTimeGrouping.groupingType){case o.a.DAY:n=Object(j.e)(e.fields[t.aliasName]),r=Object(j.e)(e.fields[t.primaryGroupBy.extendedGroupBys[0].aliasName]),a=Object(j.e)(e.fields[t.primaryGroupBy.extendedGroupBys[1].aliasName]);break;case o.a.MONTH:r=Object(j.e)(e.fields[t.aliasName]),a=Object(j.e)(e.fields[t.primaryGroupBy.extendedGroupBys[0].aliasName]);break;case o.a.YEAR:a=Object(j.e)(e.fields[t.aliasName]);break;case o.a.QUARTER:r=Object(j.e)(e.fields[t.aliasName]),a=Object(j.e)(e.fields[t.primaryGroupBy.extendedGroupBys[0].aliasName]);break;case o.a.WEEK:n=1+7*(Object(j.e)(e.fields[t.aliasName])-1),a=Object(j.e)(e.fields[t.primaryGroupBy.extendedGroupBys[0].aliasName]);break;default:return F(t,e)}return new Date(a,r-1,n).getTime()}(t,e);default:return F(t,e)}}function x(t){return{Enabled:t&&t.Enabled||!1,X:t&&t.X||0,Y:t&&t.Y||0,Align:t&&t.Align||"left",VerticalAlign:t&&t.VerticalAlign||"middle",LabelFormatter:t&&t.LabelFormatter||null,Color:t&&t.Color||""}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function A(t){return{Value:t&&t.Value||0,FormattedValue:t&&t.FormattedValue||null,Aggregators:t&&t.Aggregators||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class N extends Error{constructor(t,e,n){super(t),Object.setPrototypeOf(this,N.prototype),this.title=e,this.description=n}}var k=n("Lyxw"),D=n("3/02"),M=n("zh0k"),R=n("hwt8"),L=n("504W");function V(){return this.point.formattedValue}function B(t){return function(){return Highcharts.numberFormat(parseFloat(this.point.y)/t*100)+"%"}}class G{constructor(){this.isInitialized=!1}get primaryGroupBy(){return this.chartDataDescription&&this.chartDataDescription.category&&this.chartDataDescription.category.primaryGroupBy}get queryModel(){return this._queryModel}initialize(t,e,n,r,a,i,s,o,c,l){this.getState=t,this.chartData=e,this.chartDataDescription=n,this.categoryColumn=this.chartDataDescription.categoryColumns,this.chartPresentationSeries=r,this.chartPresentationXAxis=a,this.chartPresentationYAxis=i,this.chartPresentationArea3DStyle=s,this.chartPresentationAreaGradientStyle=o,this._queryModel=c,this.chartPresentationAnnotationList=l,this._isChartCustomizationParityFCBEnabled()&&this._validateChartAggregateAttributes(),this.isInitialized=!0}setXAxisMajorGridAndMajorTickProperties(t,e=0){var n,r,a,i,s,o,c,l;return t.AxisMajorGridColor=null===(r=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[e])||void 0===r?void 0:r.AxisMajorGridColor,t.AxisMajorGridEnabled=null===(i=null===(a=this.chartPresentationXAxis)||void 0===a?void 0:a[e])||void 0===i?void 0:i.AxisMajorGridEnabled,t.AxisMajorTickMarkColor=null===(o=null===(s=this.chartPresentationXAxis)||void 0===s?void 0:s[e])||void 0===o?void 0:o.AxisMajorTickMarkColor,t.AxisMajorTickMarkEnabled=null===(l=null===(c=this.chartPresentationXAxis)||void 0===c?void 0:c[e])||void 0===l?void 0:l.AxisMajorTickMarkEnabled,t}setYAxisMajorGridAndMajorTickProperties(t,e=0){var n,r,a,i,s,o,c,l;return t.AxisMajorGridColor=null===(r=null===(n=this.chartPresentationYAxis)||void 0===n?void 0:n[e])||void 0===r?void 0:r.AxisMajorGridColor,t.AxisMajorGridEnabled=null===(i=null===(a=this.chartPresentationYAxis)||void 0===a?void 0:a[e])||void 0===i?void 0:i.AxisMajorGridEnabled,t.AxisMajorTickMarkColor=null===(o=null===(s=this.chartPresentationYAxis)||void 0===s?void 0:s[e])||void 0===o?void 0:o.AxisMajorTickMarkColor,t.AxisMajorTickMarkEnabled=null===(l=null===(c=this.chartPresentationYAxis)||void 0===c?void 0:c[e])||void 0===l?void 0:l.AxisMajorTickMarkEnabled,t}retrieveChartArea3DStyle(){const t={};return t.Enable3D=this.chartPresentationArea3DStyle.Enable3D,t}retrieveChartAreaGradientStyle(){const t={};return t.BackColor=this.chartPresentationAreaGradientStyle.BackColor,t.BackSecondaryColor=this.chartPresentationAreaGradientStyle.BackSecondaryColor,t.BackGradientStyle=this.chartPresentationAreaGradientStyle.BackGradientStyle,t}setYAxisOppositeProperty(t){var e,n,r,a;return this._isChartCustomizationParityFCBEnabled()&&(null===(n=null===(e=this.chartPresentationXAxis)||void 0===e?void 0:e[0])||void 0===n?void 0:n.IsReversed)&&(t.Opposite=null===(a=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[0])||void 0===a?void 0:a.IsReversed),t}setXAxisIsReversedProperty(t){var e,n,r,a;return this._isChartCustomizationParityFCBEnabled()&&(null===(n=null===(e=this.chartPresentationXAxis)||void 0===e?void 0:e[0])||void 0===n?void 0:n.IsReversed)&&(t.IsReversed=null===(a=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[0])||void 0===a?void 0:a.IsReversed),t}retrieveChartYAxis(){const t=new Array(1);if(t[0]={},!this._queryModel.SeriesList)return t;const e=(t,e,n)=>{this.chartPresentationYAxis&&this.chartPresentationYAxis.length>e&&this.chartPresentationYAxis[e]&&this.chartPresentationYAxis[e].Title?t.Title=this.chartPresentationYAxis[e].Title:1===n&&(t.Title=this._queryModel.SeriesList[e].Title)};let n=0,r=-1,a=-1,i=!1,s=!1;for(let t=0;t<this.chartPresentationSeries.length;t++)this.chartPresentationSeries[t].SecondaryYAxis?(n++,a=-1===a?t:a,s=s||this.shouldDisableAllowDecimals(t)):(r=-1===r?t:r,i=i||this.shouldDisableAllowDecimals(t));return e(t[0],r,this.chartPresentationSeries.length-n),t[0].Opposite=!1,i&&(t[0].AllowDecimals=!1),0===n&&(t[0]=this.setYAxisOppositeProperty(t[0])),n>0&&(t[1]={},e(t[1],a,n),t[1].Opposite=!0,s&&(t[1].AllowDecimals=!1)),t.forEach((t,e)=>{var n,r,a,i,s,o,c,l,u,d,p,h,g,m;t.Disabled=this.chartPresentationYAxis&&this.chartPresentationYAxis[e]&&this.chartPresentationYAxis[e].Disabled,t.LabelForeColor=null===(r=null===(n=this.chartPresentationYAxis)||void 0===n?void 0:n[e])||void 0===r?void 0:r.LabelForeColor,t.AxisLineColor=null===(i=null===(a=this.chartPresentationYAxis)||void 0===a?void 0:a[e])||void 0===i?void 0:i.AxisLineColor,t.AxisTitleForeColor=null===(o=null===(s=this.chartPresentationYAxis)||void 0===s?void 0:s[e])||void 0===o?void 0:o.AxisTitleForeColor,t.LabelDisabled=null===(l=null===(c=this.chartPresentationYAxis)||void 0===c?void 0:c[e])||void 0===l?void 0:l.LabelDisabled,t.AxisInterval=null===(d=null===(u=this.chartPresentationYAxis)||void 0===u?void 0:u[e])||void 0===d?void 0:d.AxisInterval,t.AxisMinimum=null===(h=null===(p=this.chartPresentationYAxis)||void 0===p?void 0:p[e])||void 0===h?void 0:h.AxisMinimum,t.AxisMaximum=null===(m=null===(g=this.chartPresentationYAxis)||void 0===g?void 0:g[e])||void 0===m?void 0:m.AxisMaximum,t=this.setYAxisMajorGridAndMajorTickProperties(t,e)}),this.chartPresentationYAxis&&this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].FormatString?t[0].FormatString=this.chartPresentationYAxis[0].FormatString:t[0].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[0].measures[0].measureAttribute),n>0&&(this.chartPresentationYAxis&&this.chartPresentationYAxis[1]&&this.chartPresentationYAxis[1].FormatString?t[1].FormatString=this.chartPresentationYAxis[1].FormatString:t[1].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[a].measures[0].measureAttribute)),t}_isChartCustomizationParityFCBEnabled(){return Object(k.a)(this.getState(),D.s,D.Lc,D.w)}retrieveChartAnnotations(){const t=new Array(this.chartPresentationAnnotationList.length);for(let e=0;e<this.chartPresentationAnnotationList.length;e++){const n={};n.X=this.chartPresentationAnnotationList[e].X,n.Y=this.chartPresentationAnnotationList[e].Y,n.Text=this.chartPresentationAnnotationList[e].Text,n.ForeColor=this.chartPresentationAnnotationList[e].ForeColor,t[e]=n}return t}retrieveChartCategory(){var t,e,n,r,a,i;const s=new Array(1);let o=null;this.categoryColumn.length>0&&(o=E(this.getState(),this.categoryColumn[0],this.chartDataDescription.category.primaryGroupBy)),s[0]={};const c=new Array(this.chartData.length);for(let t=0;t<this.chartData.length;t++){const e=this.chartData[t];if(o){if(c[t]=F(o,e),"-1"===c[t])c[t]=Object(h.b)(this.getState(),g.f);else if(!o.isDateTimeChart&&"number"==typeof Object(j.e)(e.fields[o.aliasName])&&this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString){const n=Object(m.w)(this.getState());c[t]=Object(R.c)(Object(j.e)(e.fields[o.aliasName]),Object(b.d)(n),this.chartPresentationXAxis[0].FormatString)}}else c[t]=P(this.getState())}return s[0].Title=this.retrieveChartCategoryTitle(o),s[0].Values=c,s[0].Disabled=this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].Disabled,s[0].LabelForeColor=null===(e=null===(t=this.chartPresentationXAxis)||void 0===t?void 0:t[0])||void 0===e?void 0:e.LabelForeColor,s[0].AxisLineColor=null===(r=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[0])||void 0===r?void 0:r.AxisLineColor,s[0].AxisTitleForeColor=null===(i=null===(a=this.chartPresentationXAxis)||void 0===a?void 0:a[0])||void 0===i?void 0:i.AxisTitleForeColor,s[0].LabelDisabled=this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].LabelDisabled,s[0]=this.setXAxisMajorGridAndMajorTickProperties(s[0]),s[0]=this.setXAxisIsReversedProperty(s[0]),s}retrieveChartCategoryTitle(t){return this.chartPresentationXAxis&&this.chartPresentationXAxis.length>0&&this.chartPresentationXAxis[0].Title?this.chartPresentationXAxis[0].Title:t?O((e=t).state,e.attribute):"";var e}retrieveChartSeries(t){const e=new Array(this.chartPresentationSeries.length);for(let n=0;n<this.chartPresentationSeries.length;n++){const r=this.chartDataDescription.category.measureCollections[n].measures[0].measureAttribute,a=r.aliasName?r.aliasName:r.attributeName,i=this.chartPresentationSeries[n].IsValueShownAsLabel,s=this.chartPresentationSeries[n].LabelFormat;let o=null;s&&Object(R.d)(s)&&(o=Object(R.g)(s));let c=!1;this.chartPresentationSeries[n].Label&&"#percent"===this.chartPresentationSeries[n].Label.toLowerCase()&&(c=!0);let l=!1;s&&X(this.chartPresentationSeries[n].ChartType)&&Object(R.e)(s)&&(l=!0);let u=null;const d=O(this.getState(),r);e[n]=this.cloneBlueprintSeriesStyle(this.chartPresentationSeries[n]),this.chartPresentationSeries[n].SecondaryYAxis&&(e[n].YAxisNumber=1),this.primaryGroupBy&&(u=[],u.push(this.primaryGroupBy.groupAttribute),this.primaryGroupBy.extendedGroupBys&&this.primaryGroupBy.extendedGroupBys.forEach(t=>{u.push(t)}));const p=new Array(this.chartData.length),h=a;let g=0;for(let t=0;t<this.chartData.length;t++){const e=this.chartData[t];p[t]=A();const r=Object(j.e)(e.fields[a]);if(p[t].Value=r||0,g+=r||0,s){const r=Object(m.w)(this.getState()),a=Object(b.d)(r);Object(R.f)(s)?p[t].FormattedValue=Object(M.b)(p[t].Value,this.chartPresentationSeries[n].LabelFormat,a):Object(R.d)(s)&&!l?p[t].FormattedValue=Object(R.a)(p[t].Value,o,a):p[t].FormattedValue=Object(j.c)(e.fields[h])||0}else p[t].FormattedValue=Object(j.c)(e.fields[h])||0;this.attachAggregators(p[t],e,u)}const f=x();i?(f.Enabled=!0,f.LabelFormatter=V):c&&(f.Enabled=!0,f.LabelFormatter=B(g)),f.Color=this.chartPresentationSeries[n].LabelForeColor,e[n].DataLabels=f,e[n].DataPoints=p,e[n].Title=this.getChartTitleFromPresentationSeries(d,n),e[n].XAxisNumber=t,e[n].HideInLegend=this.chartPresentationSeries[n].HideInLegend,e[n].Stack=this.chartPresentationSeries[n].Stack}const n=Object(m.w)(this.getState()),r=Object(b.d)(n),a=this.chartPresentationSeries[0].IsValueShownAsLabel,i=this.chartPresentationSeries[0].LabelFormat;if(a&&X(this.chartPresentationSeries[0].ChartType)&&Object(R.e)(i)){const t=U(i,r);for(let n=0;n<e[0].DataPoints.length;n++)t(0,n,0,e)}return e}getChartTitleFromPresentationSeries(t,e=0){return Object(L.b)(this.chartPresentationSeries[e].LegendText)?Object(L.b)(this.chartPresentationSeries[e].Name)?t:this.chartPresentationSeries[e].Name:this.chartPresentationSeries[e].LegendText}shouldDisableAllowDecimals(t){const e=this.chartDataDescription.category.measureCollections[t].measures[0].measureAttribute;return"count"===e.aggregateType||"countcolumn"===e.aggregateType}cloneBlueprintSeriesStyle(t){const e={DataPoints:n&&n.DataPoints||null,DataLabels:n&&n.DataLabels||null,ChartType:n&&n.ChartType||"line",YAxisNumber:n&&n.YAxisNumber||0,XAxisNumber:n&&n.XAxisNumber||0,Title:n&&n.Title||"",Color:n&&n.Color||"",BorderColor:n&&n.BorderColor||"",BorderWidth:n&&n.BorderWidth||0,CustomProperties:n&&n.CustomProperties||null,Stack:n&&n.Stack||null};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n;return e.ChartType=t.ChartType,e.Color=t.Color,e.BorderColor=t.BorderColor,e.BorderWidth=t.BorderWidth,e.CustomProperties=t.CustomProperties,e}attachAggregators(t,e,n){if(n){const r=new d;for(let t=0;t<n.length;t++){const a=n[t],i=new Array;a.entity.baseEntity&&a.entity.baseEntity.linkedEntities&&a.entity.baseEntity.linkedEntities.forEach(t=>{const e={name:n&&n.name||null,from:n&&n.from||null,to:n&&n.to||null,linkType:n&&n.linkType||null,alias:n&&n.alias||null};var n;e.name=t.entityName,e.from=t.linkFromAttribute,e.to=t.linkToAttribute,e.linkType=t.joinType.toString(),e.alias=t.alias,i.push(e)}),r.addAggregator(a.attributeName,Object(j.e)(e.fields[G._getFieldName(a)]),a.dateTimeGrouping?a.dateTimeGrouping.groupingType:-1,a.entity.entityName,i)}const a=Object(m.w)(this.getState()),i=this._getFirstDayOfWeekFromUserSettings(a),s=this._getCalendarWeekRuleFromUserSettings(a);t.Aggregators=r.getAggregators(i,s)}}_getFirstDayOfWeekFromUserSettings(t){var e;return(null===(e=t.dateFormatInfo)||void 0===e?void 0:e.FirstDayOfWeek)||0}_getCalendarWeekRuleFromUserSettings(t){var e;return(null===(e=t.dateFormatInfo)||void 0===e?void 0:e.CalendarWeekRule)||0}getFormatterPropertiesForAttribute(t){return Object(b.z)(this.getState(),Object(v.a)(this.getState(),t.entity.entityName,t.attributeName))}static _getFieldName(t){return t.aliasName&&t.aliasName.trim()?t.aliasName:t.attributeName}isChartDrillable(){if(!this._isGroupByDrillable(this.chartDataDescription.category.primaryGroupBy))return!1;for(const t of this.chartDataDescription.category.measureCollections)for(const e of t.secondaryGroupBys)if(!this._isGroupByDrillable(e))return!1;return!!this.chartDataDescription.entityExpression.hasAggregate}_isGroupByDrillable(t){return!this.chartDataDescription.isGroupByFromNestedLinkEntity()&&(!(!t||!t.groupAttribute.hasGroupBy)&&this._isAttributeDrillable(t.groupAttribute))}_isAttributeDrillable(t){var e;const n=null===(e=null==t?void 0:t.entity)||void 0===e?void 0:e.entityName,r=null==t?void 0:t.attributeName;return"memo"!==Object(v.b)(r,n,this.getState())}_validateChartAggregateAttributes(){var t,e,n,r;for(let a=0;a<(null===(n=null===(e=null===(t=this.chartDataDescription)||void 0===t?void 0:t.entityExpression)||void 0===e?void 0:e.aggregateAttributes)||void 0===n?void 0:n.length);a++){const t=this.chartDataDescription.entityExpression.aggregateAttributes[a],e=null===(r=null==t?void 0:t.entity)||void 0===r?void 0:r.entityName,n=null==t?void 0:t.attributeName,i=Object(v.b)(n,e,this.getState());if(!("date"!==i&&"datetime"!==i||"min"!==t.aggregateType&&"max"!==t.aggregateType)){const t=String.format(Object(h.b)(this.getState(),g.h),n);throw new N("ChartError",t,t)}}}}function X(t){return!!t&&("stackedbar100"===t.toLowerCase()||"stackedcolumn100"===t.toLowerCase()||"stackedarea100"===t.toLowerCase())}function U(t,e){return function n(r,a,i,s){if(r===s.length)return i;const o=s[r].DataPoints[a];return i=n(++r,a,i+(o&&o.Value?o.Value:0),s),o&&o.Value&&(o.FormattedValue=Object(R.a)(o.Value/i*100,Object(R.g)(t),e)),i}}var q=n("iZ7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class z extends G{parse(){var t,e,n,r;if(!this.isInitialized)throw new Error("The instance of the ComparisonChartDataParser class is not properly initialized.");const a=new Array(0),i=new Map,s=this.chartDataDescription.category,o=s.measureCollections[0];if(o.secondaryGroupBys.length<=0)throw new Error("Comparison chart can only be plotted with secondary groups's");if(o.measures&&o.measures.length>0&&o.measures[0].parentCategory&&o.measures[0].parentCategory.primaryGroupBy&&(o.measures[0].parentCategory.primaryGroupBy.groupAttribute&&a.push(o.measures[0].parentCategory.primaryGroupBy.groupAttribute),o.measures[0].parentCategory.primaryGroupBy.extendedGroupBys))for(let t=0;t<o.measures[0].parentCategory.primaryGroupBy.extendedGroupBys.length;t++)a.push(o.measures[0].parentCategory.primaryGroupBy.extendedGroupBys[t]);if(1!==this.chartPresentationSeries.length)throw new Error("Comparison chart should have only one series");const c=this._addSecondaryGroupByToFieldAggregators(o,a),l=o.measures[0].measureAttribute,u=l.aliasName?l.aliasName:l.attributeName,d=u,p=s.primaryGroupBy.groupAttribute,h=E(this.getState(),this._getGroupByAttribute(p,s.primaryGroupBy),s.primaryGroupBy),g=new Array,f=new Array,y=new Map;for(let t=0;t<this.chartData.length;t++){const e=this.chartData[t],n=F(h,e);let r,a=F(c,e);null==a?(a=P(this.getState()),r=a):r=w(c,e),i.set(r,a),f.indexOf(n)<0&&f.push(n),g.indexOf(r)<0&&g.push(r)}g.forEach(t=>{const e=new Array(f.length);y.set(t,e)});const v=Object(m.w)(this.getState()),_=this.chartPresentationSeries[0].LabelFormat;let S=!1;this.chartPresentationSeries[0].Label&&"#percent"===this.chartPresentationSeries[0].Label.toLowerCase()&&(S=!0);let O=!1;_&&X(this.chartPresentationSeries[0].ChartType)&&Object(R.e)(_)&&(O=!0);for(let t=0;t<this.chartData.length;t++){const e=this.chartData[t];let n=w(c,e);Object(T.a)(n)&&(n=P(this.getState()));const r=y.get(n),i=F(h,e),s=f.indexOf(i);if(this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString&&(f[s]=Object(R.c)(Object(j.e)(e.fields[h.aliasName]),Object(b.d)(v),this.chartPresentationXAxis[0].FormatString)),r[s]=A(),r[s].Value=Object(j.e)(e.fields[u]),_){const n=Object(b.d)(v);Object(R.f)(_)?r[s].FormattedValue=Object(M.b)(r[t].Value,_,n):Object(R.d)(_)&&!O?r[s].FormattedValue=Object(R.a)(r[s].Value,Object(R.g)(_),n):r[s].FormattedValue=Object(j.c)(e.fields[d])||0}else r[s].FormattedValue=Object(j.c)(e.fields[d])||0;this.attachAggregators(r[s],e,a)}g.forEach(t=>{const e=y.get(t);for(let t=0;t<f.length;t++)e[t]||(e[t]=A())});const C=new Array(1);C[0]={},C[0].Title=this.retrieveChartCategoryTitle(h),C[0].Values=f,C[0].LabelForeColor=null===(t=this.chartPresentationXAxis[0])||void 0===t?void 0:t.LabelForeColor,C[0].AxisLineColor=null===(e=this.chartPresentationXAxis[0])||void 0===e?void 0:e.AxisLineColor,C[0].AxisTitleForeColor=null===(n=this.chartPresentationXAxis[0])||void 0===n?void 0:n.AxisTitleForeColor,C[0].LabelDisabled=null===(r=this.chartPresentationXAxis[0])||void 0===r?void 0:r.LabelDisabled,C[0]=this.setXAxisMajorGridAndMajorTickProperties(C[0]),C[0]=this.setXAxisIsReversedProperty(C[0]),this._sortComparisonCodes(o,g);const I=new Array(g.length),N=this.chartPresentationSeries[0]&&this.chartPresentationSeries[0].IsValueShownAsLabel,k=this.chartPresentationSeries[0]?this.chartPresentationSeries[0].LabelForeColor:null,D=this.chartPresentationSeries[0]&&this.chartPresentationSeries[0].HideInLegend,L=this.getChartTitleFromPresentationSeries(this.chartPresentationSeries[0].Name);for(let t=0;t<g.length;t++){const e=g[t];if(I[t]=this.cloneBlueprintSeriesStyle(this.chartPresentationSeries[0]),I[t].Title=L||i.get(e),I[t].DataPoints=y.get(e),I[t].HideInLegend=D,N){const e=x();e.Enabled=!0,e.LabelFormatter=V,I[t].DataLabels=e,e.Color=k}else if(S){let e=0;I[t].DataPoints.forEach(t=>{e+=t&&t.Value?t.Value:0});const n=x();n.Enabled=!0,n.LabelFormatter=B(e),I[t].DataLabels=n,n.Color=k}}if(N&&O){const t=U(_,Object(b.d)(v));for(let e=0;e<C[0].Values.length;e++)t(0,e,0,I)}this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=C,this.queryModel.YAxes=this._retrieveChartYAxis(l),this.queryModel.SeriesList=I,this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations()}_sortComparisonCodes(t,e){t.secondaryGroupBys[0].descending?e.sort((t,e)=>"number"==typeof t&&"number"==typeof e?e-t:e.localeCompare(t)):e.sort((t,e)=>"number"==typeof t&&"number"==typeof e?t-e:t.localeCompare(e))}_getGroupByAttribute(t,e){return t.attributeName!==Object(q.h)(this.getState(),t.entity.entityName).PrimaryIdAttribute?t:e.extendedGroupBys&&e.extendedGroupBys.length>0?e.extendedGroupBys[0]:t}_addSecondaryGroupByToFieldAggregators(t,e){const n=t.secondaryGroupBys[0].groupAttribute,r=E(this.getState(),this._getGroupByAttribute(n,t.secondaryGroupBys[0]),t.secondaryGroupBys[0]);if(n&&e.push(n),t.secondaryGroupBys[0].extendedGroupBys)for(let n=0;n<t.secondaryGroupBys[0].extendedGroupBys.length;n++)e.push(t.secondaryGroupBys[0].extendedGroupBys[n]);return r}_retrieveChartYAxis(t){var e,n,r,a,i,s,o,c;const l=new Array(1);return l[0]={},this.chartPresentationYAxis&&this.chartPresentationYAxis.length>0&&this.chartPresentationYAxis[0].Title?l[0].Title=this.chartPresentationYAxis[0].Title:l[0].Title=O(this.getState(),t),this.chartPresentationYAxis[0].FormatString?l[0].FormatString=this.chartPresentationYAxis[0].FormatString:l[0].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[0].measures[0].measureAttribute),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelForeColor&&(l[0].LabelForeColor=this.chartPresentationYAxis[0].LabelForeColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].AxisLineColor&&(l[0].AxisLineColor=this.chartPresentationYAxis[0].AxisLineColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].AxisTitleForeColor&&(l[0].AxisTitleForeColor=this.chartPresentationYAxis[0].AxisTitleForeColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelDisabled&&(l[0].LabelDisabled=null===(n=null===(e=this.chartPresentationYAxis)||void 0===e?void 0:e[0])||void 0===n?void 0:n.LabelDisabled),l[0].AxisInterval=null===(a=null===(r=this.chartPresentationYAxis)||void 0===r?void 0:r[0])||void 0===a?void 0:a.AxisInterval,l[0].AxisMinimum=null===(s=null===(i=this.chartPresentationYAxis)||void 0===i?void 0:i[0])||void 0===s?void 0:s.AxisMinimum,l[0].AxisMaximum=null===(c=null===(o=this.chartPresentationYAxis)||void 0===o?void 0:o[0])||void 0===c?void 0:c.AxisMaximum,this.shouldDisableAllowDecimals(0)&&(l[0].AllowDecimals=!1),l[0]=this.setYAxisMajorGridAndMajorTickProperties(l[0]),l[0]=this.setYAxisOppositeProperty(l[0]),l}}class H extends G{parse(){if(!this.isInitialized)throw new Error("The instance of the DateTimeChartDataParser class is not properly initialized.");this.categoryColumn&&0!==this.categoryColumn.length&&(this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=this.retrieveChartCategory(),this.queryModel.SeriesList=this.retrieveChartSeries(0),this.queryModel.YAxes=this.retrieveChartYAxis(),this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations())}retrieveChartCategory(){var t,e,n,r,a,i,s,o;const c=new Array(1);if(this.chartData.length<1)return c;const l=this.primaryGroupBy.groupAttribute;c[0]={};const u=new Array(this.chartData.length),d=E(this.getState(),l,this.primaryGroupBy);c[0].Title=this.retrieveChartCategoryTitle(d),c[0].LabelForeColor=null===(e=null===(t=this.chartPresentationXAxis)||void 0===t?void 0:t[0])||void 0===e?void 0:e.LabelForeColor,c[0].AxisLineColor=null===(r=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[0])||void 0===r?void 0:r.AxisLineColor,c[0].AxisTitleForeColor=null===(i=null===(a=this.chartPresentationXAxis)||void 0===a?void 0:a[0])||void 0===i?void 0:i.AxisTitleForeColor,c[0].LabelDisabled=null===(o=null===(s=this.chartPresentationXAxis)||void 0===s?void 0:s[0])||void 0===o?void 0:o.LabelDisabled,c[0]=this.setXAxisMajorGridAndMajorTickProperties(c[0]),c[0]=this.setXAxisIsReversedProperty(c[0]);for(let t=0;t<this.chartData.length;t++){const e=this.chartData[t];u[t]=F(d,e),d.isDateTimeChart&&this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString&&u[t]!==Object(h.b)(d.state,g.v)&&(u[t]=Object(R.b)(new Date(u[t]),Object(b.d)(Object(m.w)(this.getState())),this.chartPresentationXAxis[0].FormatString))}return c[0].Values=u,c}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class W extends G{parse(){if(!this.isInitialized)throw new Error("The instance of the NormalChartDataParser class is not properly initialized.");this.categoryColumn&&0!==this.categoryColumn.length&&(this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=this.retrieveChartCategory(),this.queryModel.SeriesList=this.retrieveChartSeries(0),this.queryModel.YAxes=this.retrieveChartYAxis(),this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations())}}var Y=n("DAWX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function K(t){const e={};try{if(t){const n=/\w+=\w+/;t.split(/\s*,\s*/).forEach(t=>{if(t&&n.test(t)){const[n,r]=t.split("=");e[n]=r}})}}catch(e){throw`Failed to parse chart custom properties, value: ${t} `}return{FunnelNeckHeight:e&&Number(e.FunnelNeckHeight)||0,FunnelNeckWidth:e&&Number(e.FunnelNeckWidth)||10,StackedGroupName:e&&e.StackedGroupName||null}}var Q=n("S2mk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const J=["COLUMN","STACKEDCOLUMN","STACKEDCOLUMN100","BAR","STACKEDBAR","STACKEDBAR100","AREA","STACKEDAREA","STACKEDAREA100","LINE","PIE","FUNNEL","TAG","DOUGHNUT","POINT"];function Z(t,e,n){const r=(new DOMParser).parseFromString(e,"text/xml");!function(t,e){const n=t.getElementsByTagName("parsererror");if(n&&n.length>0)throw new N("ChartError",Object(h.b)(e,g.t),Object(h.b)(e,g.s))}(r,t);return{chartPresentationSeries:$(t,r,n),chartPresentationLegendList:nt(r),colorsList:et(r),chartPresentationArea3DStyle:ot(r),chartPresentationAreaGradientStyle:ct(r),chartPresentationXAxis:at(r),chartPresentationYAxis:it(r),chartPresentationAnnotationList:rt(r)}}function $(t,e,n){const r=new Array,a=e.querySelectorAll("Chart Series Series"),i=new XMLSerializer;for(let e=0;e<a.length;e++){const s=a[e],o={},c=s.getAttribute("ChartType")||"Column";if(-1===J.indexOf(c.toUpperCase()))throw new N("ChartError",Object(h.b)(t,g.t),Object(h.b)(t,g.t));o.ChartType=c;const l=s.getAttribute("Color");o.Color=l?lt(l):null;const u=s.getAttribute("LegendText");o.LegendText=u||null;const d=s.getAttribute("CustomProperties");o.CustomProperties=K(d);const p=s.getAttribute("BorderColor");o.BorderColor=p?lt(p):null;const m=s.getAttribute("BorderWidth");o.BorderWidth=m?Number(m):null;const b=s.getAttribute("IsValueShownAsLabel");o.IsValueShownAsLabel=b&&"true"===b.toLowerCase()||!1,o.Label=s.getAttribute("Label");const f=s.getAttribute("YAxisType");o.SecondaryYAxis=f&&"secondary"===f.toLowerCase();const y=s.getAttribute("IsVisibleInLegend");o.HideInLegend=y&&"false"===y.toLowerCase();const v=s.getAttribute("LabelForeColor");o.LabelForeColor=v?lt(v):null,o.LabelFormat=s.getAttribute("LabelFormat");const _=tt(t,s.outerHTML||i.serializeToString(s),n);o.Name=_||null,o.Stack=o.CustomProperties.StackedGroupName,r.push(o)}return r}function tt(t,e,n){const r=Object(s.a)(e);if(Object(Q.j)(r)||r.length<5)return"";const a=r[2].toLowerCase(),i=r[4];let o="";const c=a.substring(0,n.length);if(c!==n)return"";const l=a.substring(n.length+1,a.length),u=Object(v.a)(t,c,l);return u&&u.OptionSet&&(o=u.OptionSet.filter(t=>t.Value.toString().toLowerCase()===i.toLowerCase())[0].Label),o}function et(t){const e=new Array,n=t.querySelector("Chart").getAttribute("PaletteCustomColors");return null!==n&&n.split(";").forEach(t=>{if(t){const n=lt(t);e.push(n)}}),e}function nt(t){const e=new Array,n=t.querySelectorAll("Chart Legends Legend");for(let t=0;t<n.length;t++){const r={},a=n[t].getAttribute("Enabled");r.Enabled=null===a||"True"===a,e.push(r)}return e}function rt(t){const e=new Array,n=t.querySelectorAll("Chart Annotations TextAnnotation");for(let t=0;t<n.length;t++){const r=n[t],a={},i=r.getAttribute("X");a.X=i?Number(i):null;const s=r.getAttribute("Y");a.Y=s?Number(s):null,a.Text=r.getAttribute("Text");const o=r.getAttribute("ForeColor");a.ForeColor=o?lt(o):null,e.push(a)}return e}function at(t){const e=new Array,n=t.querySelectorAll("Chart ChartAreas ChartArea AxisX");for(let r=0;r<n.length;r++){const a=n[r],i={};st(i,t.querySelectorAll("Chart ChartAreas ChartArea AxisX MajorGrid")[0],t.querySelectorAll("Chart ChartAreas ChartArea AxisX MajorTickMark")[0]),i.Title=a.getAttribute("Title");const s=t.querySelectorAll("Chart ChartAreas ChartArea AxisX LabelStyle")[0];if(s){const t=null==s?void 0:s.getAttribute("ForeColor"),e=null==s?void 0:s.getAttribute("Enabled");i.LabelForeColor=t?lt(t):null,i.LabelDisabled=e&&"false"===e.toLowerCase(),i.FormatString=s.getAttribute("Format")}const o=a.getAttribute("Enabled"),c=a.getAttribute("LineColor"),l=a.getAttribute("TitleForeColor");i.Disabled=o&&"false"===o.toLowerCase(),i.AxisLineColor=c?lt(c):null,i.AxisTitleForeColor=l?lt(l):null,i.Disabled=o&&"false"===o.toLowerCase();const u=a.getAttribute("IsReversed");i.IsReversed=u&&"true"===u.toLowerCase(),e.push(i)}return e}function it(t){const e=new Array,n=(t,n)=>{var r,a;const i={};if(!t)return void e.splice(n,0,i);const s=t;i.Title=s.getAttribute("Title");st(i,s.querySelectorAll("MajorGrid")[0],s.querySelectorAll("MajorTickMark")[0]);const o=s.getAttribute("Enabled");i.Disabled=o&&"false"===o.toLowerCase();const c=s.getAttribute("Interval"),l=s.getAttribute("Minimum"),u=s.getAttribute("Maximum");i.AxisInterval=c?Number(c):null,i.AxisMinimum=l?Number(l):null,i.AxisMaximum=u?Number(u):null;const d=s.querySelectorAll("LabelStyle");d&&d[0]&&d[0].getAttribute("Format")&&(i.FormatString=d[0].getAttribute("Format"));const p=null===(r=null==d?void 0:d[0])||void 0===r?void 0:r.getAttribute("ForeColor");i.LabelForeColor=p?lt(p):null;const h=null===(a=null==d?void 0:d[0])||void 0===a?void 0:a.getAttribute("Enabled");i.LabelDisabled=h&&"false"===h.toLowerCase();const g=s.getAttribute("LineColor");i.AxisLineColor=g?lt(g):null;const m=s.getAttribute("TitleForeColor");i.AxisTitleForeColor=m?lt(m):null,e.splice(n,0,i)};let r=t.querySelectorAll("Chart ChartAreas ChartArea AxisY");return r&&n(r[0],0),r=t.querySelectorAll("Chart ChartAreas ChartArea AxisY2"),r&&n(r[0],1),e}function st(t,e,n){if(t){if(e){const n=e.getAttribute("LineColor"),r=e.getAttribute("Enabled");t.AxisMajorGridColor=n?lt(n):null,t.AxisMajorGridEnabled=r&&"true"===r.toLowerCase()}if(n){const e=n.getAttribute("LineColor"),r=n.getAttribute("Enabled");t.AxisMajorTickMarkColor=e?lt(e):null,t.AxisMajorTickMarkEnabled=r&&"true"===r.toLowerCase()}return t}}function ot(t){const e=t.querySelector("Chart ChartAreas ChartArea Area3DStyle"),n={};return n.Enable3D=!!e&&"true"===e.getAttribute("Enable3D").toLowerCase(),n}function ct(t){const e=t.querySelector("Chart ChartAreas ChartArea"),n={};return n.BackColor=e?e.getAttribute("BackColor"):"",n.BackSecondaryColor=e?e.getAttribute("BackSecondaryColor"):"",n.BackGradientStyle=e?e.getAttribute("BackGradientStyle"):"",n}function lt(t){if(!t)return null;if(function(t){return/^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$/.test(t)}(t=t.trim()))return String.format("rgb({0})",t);if(function(t){return/#[0-9a-fA-F]{6}/.test(t)}(t))return t;if(function(t){return/^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,(\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,){2}\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$/.test(t)}(t)){const e=[];t.split(",").forEach(t=>e.push(t.trim()));const n=e.shift(),r=parseFloat(n)/255,a=e.slice();return a.push(r.toString()),String.format("rgba({0})",a.join(","))}return t}var ut=n("z8iZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function dt(t){return{Text:t&&t.Text||"",HorizontalAlignment:t&&t.HorizontalAlignment||"center",VerticalAlignment:t&&t.VerticalAlignment||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class pt{constructor(t,e,n,r,a,i,s,o){this._getState=t,this._chartData=a,this._viewRecord=e,this._visualizationRecord=n,this._chartDataDescription=r,this._chartPresentationXML=i,this._drilldownChartType=s,this._entityLogicalName=o}buildChartModel(){if(this._chartQueryModel=Object(ut.a)(),this._chartData.length>0){this._buildChartHeading();try{this._buildChartPresentation(),this._buildChart()}catch(t){if(!(t instanceof N))throw t;this._buildErrorMessage(t)}}else this._buildDataEmptyMessage();return this._chartQueryModel}_buildDataEmptyMessage(){const t=Object(h.b)(this._getState(),g.m),e=dt();e.Text=this._visualizationRecord&&this._visualizationRecord.get_DisplayName()?this._visualizationRecord.get_DisplayName():t,e.HorizontalAlignment="center",e.VerticalAlignment="middle",this._chartQueryModel.Title=e,this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName(),this._chartQueryModel.DisplayMode=1,this._chartQueryModel.ErrorInformation=new Y.a,this._chartQueryModel.ErrorInformation.set_ErrorType(null),this._chartQueryModel.ErrorInformation.set_ErrorDescription(t)}_buildErrorMessage(t){this._chartQueryModel.Title=dt(),this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName(),this._chartQueryModel.DisplayMode=1,this._chartQueryModel.ErrorInformation=new Y.a,this._chartQueryModel.ErrorInformation.set_ErrorType(t.title),this._chartQueryModel.ErrorInformation.set_ErrorDescription(t.description)}_buildChartHeading(){const t=this._visualizationRecord.get_DisplayName();this._chartQueryModel.Title=dt(),this._chartQueryModel.Title.Text=t,this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName()}_buildChartPresentation(){var t;this._chartPresentationParser=Z(this._getState(),this._chartPresentationXML,this._entityLogicalName),this._drilldownChartType&&this._chartPresentationParser.chartPresentationSeries.forEach(t=>{t.ChartType=this._drilldownChartType}),this._chartPresentationSeries=this._chartPresentationParser.chartPresentationSeries,this._chartPresentationXAxis=this._chartPresentationParser.chartPresentationXAxis,this._chartPresentationYAxis=this._chartPresentationParser.chartPresentationYAxis,this._chartPresentationAnnotationList=this._chartPresentationParser.chartPresentationAnnotationList,this._chartPresentationArea3DStyle=this._chartPresentationParser.chartPresentationArea3DStyle,this._chartPresentationAreaGradientStyle=this._chartPresentationParser.chartPresentationAreaGradientStyle,this._chartQueryModel.Legend={Enabled:t&&t.Enabled||!1},this._chartPresentationParser.chartPresentationLegendList.length>0?this._chartQueryModel.Legend.Enabled=this._chartPresentationParser.chartPresentationLegendList[0].Enabled:this._chartQueryModel.Legend.Enabled=!1,this._colors=this._chartPresentationParser.colorsList}_buildChart(){this._chartParserType=this._getChartParserType();const t=function(t){let e=null;switch(t){case 2:e=new z;break;case 3:e=new H;break;case 1:default:e=new W}return e}(this._chartParserType);t.initialize(this._getState,this._chartData,this._chartDataDescription,this._chartPresentationSeries,this._chartPresentationXAxis,this._chartPresentationYAxis,this._chartPresentationArea3DStyle,this._chartPresentationAreaGradientStyle,this._chartQueryModel,this._chartPresentationAnnotationList),this._chartQueryModel.Colors=this._colors,t.parse()}_getChartParserType(){return this._chartDataDescription.isComparisonChart?2:this._chartDataDescription.category.primaryGroupBy.groupAttribute.dateTimeGrouping?3:1}}var ht=n("haag"),gt=n("0L4T"),mt=n("nxXM"),bt=n("ddoO"),ft=n("q/7h"),yt=n("Tezb"),vt=n("WF3G"),_t=n("4r2D");function St(t,e,n){return{type:"chartData.retrieve.core.async",execute({dispatch:r,getState:i},o,c){const l=[];try{const u=i();if(!Object(s.b)(i,r,o,l,t,e,n,!0))return Promise.resolve();const d=new vt.a(t.fetchXml);d.set_NoLock(!0),d.set_PageSize(t.dataDefinition.entityExpression.top);const p=function(t){const e={};if(null!=t){const n=new vt.a(t);n.set_PageSize(0),n.set_NoLock(!0),e[""]=n}return e}(t.viewXml);return function(t,e,n,r){const i=new _t.a(a.a.toString(a.a.newGuid()),r&&r.isPreloadCall);return t.retrieveEntitiesForAggregateQuery(e,n,i).nativePromise()}(o.DataSource,d,p,c).then(o=>{const c=function(e,n,r){const a=new jt(t.viewTitle,t.viewEntityLogicalName),i=new jt(t.chartName,t.chartPrimaryEntityTypeCode),o=t.dataDefinition,c=Object(ft.a)(e);Object(s.e)(o,c,n());const l=t,u=new pt(n,a,i,o,c,t.presentationXml,l.drillDownChartType?l.drillDownChartType:null,r);return u.buildChartModel()}(o,i,e);Object(k.c)(u,D.rd)?(r(Pt(t.getStorageKey(),c)),Ct(u,r,t.getStorageKey(),n)):(r(It(a.a.toString(t.visualizationId),a.a.toString(t.viewId),c)),Ot(u,r,a.a.toString(t.visualizationId),a.a.toString(t.viewId),n))}).catch(e=>{Object(gt.c)(u,r,e,t,n)})}catch(t){return o.EventManager.ReportComponentFailure(s.f+".retrieveChartDataCore",Error(t),ht.b,l),Promise.reject(t)}}}}function Ot(t,e,n,i,s){if(t){const o=new a.a(n),c=a.a.toString(o),l=new a.a(i),u=a.a.toString(l),d={},p={};if(p[u]=function(t,e,n,a){if(!t)return null;if(a&&""!==a){const i=Object(bt.c)(t,e,n),s=i&&i.slice();return Object(r.a)(s,a)}return null}(t,c,u,s),p[u]){d[c]=p;const t={entities:null,lists:null,charts:d};e(Object(mt.b)(t))}}}function Ct(t,e,n,a){if(t){const i={};if(i[n]=function(t,e,n){if(!t)return null;if(n){const a=Object(bt.b)(t,e),i=a&&a.slice();return Object(r.a)(i,n)}return null}(t,n,a),i[n]){const t={entities:null,lists:null,charts:null,chartData:i};e(Object(mt.b)(t))}}}function It(t,e,n){const r=new a.a(t),s=a.a.toString(r),o=new a.a(e),c={charts:{[s]:{[a.a.toString(o)]:{initialized:i.a.Initialized,chartConfigObject:n}}}};return{type:yt.d,payload:c}}function Pt(t,e){const n={chartData:{[t]:{initialized:i.a.Initialized,chartConfigObject:e}}};return{type:yt.d,payload:n}}class jt{constructor(t,e){this._displayName=t,this._associatedEntityLogicalName=e,Object.freeze(this)}get_DisplayName(){return this._displayName}get_AssociatedEntityLogicalName(){return this._associatedEntityLogicalName}}},jR7L:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="form.entityreferencebyrelationship";function a(t,e){return{type:r,payload:e,meta:{pageId:t}}}},jsFU:function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return i}));var r=n("BFlg"),a=n("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="control.update.formlessControlOutputs";function s(t,e,n){return{type:"control.update.formlessControlOutputs.async",execute({dispatch:s,getState:o},c){const l=c.TraceManager.getTracer(r.z),u=r.x+".formlessControlOutputsIdAction";try{if(!Object.keys(n).length)return Promise.resolve();const r=o(),d=Object(a.a)(r,t),p=Object.assign({},d.formlessControlOutputs);let h=!1;l.info("Updating the unbound output.");for(const t in n){const r=n[t],a=e+"."+t;p[a]!==r&&(p[a]=r,h=!0)}return h&&s(function(t,e){return{type:i,payload:{formlessControlOutputs:e},meta:{pageId:t}}}(t,p)),c.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(t){const e="Updating the outbound outputs for the grid failed with error : "+t.message;c.EventManager.ReportComponentFailure(u,Error(e))}}}}},kC0I:function(t,e,n){"use strict";n.d(e,"i",(function(){return dt})),n.d(e,"g",(function(){return nt})),n.d(e,"e",(function(){return rt})),n.d(e,"d",(function(){return at})),n.d(e,"f",(function(){return ht})),n.d(e,"h",(function(){return gt})),n.d(e,"c",(function(){return st})),n.d(e,"a",(function(){return ut})),n.d(e,"b",(function(){return lt}));var r=n("SAYH"),a=n("eOoD"),i=n("w1eR"),s=n("eXjw"),o=n("S2mk"),c=n("jRy5"),l=n("ILmX"),u=n("d0w6"),d=n("iZ7K"),p=n("IqkD"),h=n("NjDY"),g=n("YxC/"),m=n("KBcj"),b=n("BzGi"),f=n("BFlg"),y=n("P6DH"),v=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function _(){let t=null,e=null,n=null;return(r,a)=>{const i=a.parentContextToken,s=a.contextString,o=function(t,e){const n=e.parentContextToken;switch(e.contextString){case f.h.ASSOCIATEDGRID:const r=Object(y.gb)(t,e,n);return v.a(n,r.relationshipName,r.ordinal);case f.h.SUBGRID:if(e.descriptor&&e.descriptor.StreamId)return v.o(n,e.descriptor.Name,e.descriptor.StreamId,!!e.descriptor.IsTile);const a=v.p(n,e.descriptor.Name),i=a&&a.parentContextToken?a.parentContextToken.entityTypeName:null;return a.relationshipType=st(t,e,i,a),a;case f.h.GRID:return v.k(t,e.id);case f.h.CUSTOM:return v.c(n,e.controlId);default:return n}}(r,a);return(n!==s||S(t,o)||S(e,i))&&(t=o,e=i,n=s),t}}function S(t,e){return t&&e?t.entityTypeName!==e.entityTypeName||t.controlName!==e.controlName||(t.formId&&t.formId.guid)!==(e.formId&&e.formId.guid)||(t.recordId&&t.recordId.guid)!==(e.recordId&&e.recordId.guid)||t.relationshipName!==e.relationshipName||t.roleOrd!==e.roleOrd:t!==e}var O=n("5O6t"),C=n("XvLr"),I=n("LzVy"),P=n("sclX"),j=n("unFF"),T=n("GYEz"),E=n("o0iw"),F=n("504W"),w=n("3hnk"),x=n("sZ+8"),A=n("69Qu"),N=n("3/02"),k=n("Lyxw"),D=n("kt5S"),M=n("jAuy"),R=n("arV0"),L=n("pEXn"),V=n("5R5s"),B=n("VnpK"),G=n("85o3"),X=n("lEp6"),U=n("YPtO"),q=n("0kGT"),z=n("Z/4N"),H=n("nIfK"),W=n("8nT0"),Y=n("CbNq"),K=n("b41/"),Q=n("7+p5"),J=n("37s6"),Z=n("LbMF"),$=n("SJlc"),tt=n("AVDU"),et=n("H4dV");function nt(t){return t===f.h.SUBGRID}function rt(t){return t===f.h.GRID}function at(t){return t===f.h.ASSOCIATEDGRID}function it(t){switch(t){case f.h.ASSOCIATEDGRID:case f.h.SUBGRID:return"div";case f.h.GRID:default:return"section"}}function st(t,e,n,r){let a=n?Object(d.G)(t,n,r.relationshipName):null;if(null===a&&e.descriptor&&e.descriptor.Parameters){const r=e.descriptor.Parameters[f.F.RELATIONSHIP_NAME],i=e.descriptor.Parameters[f.F.TARGET_ENTITY_TYPE];r&&n?a=Object(d.G)(t,n,r):r&&i&&(a=Object(d.G)(t,i,r))}return a}function ot(){let t=null,e=null;return n=>(t!==n.contextString&&(t=n.contextString,e=function(t){switch(t.contextString){case f.h.ASSOCIATEDGRID:case f.h.SUBGRID:return[u.a.SUB_GRID,u.a.MAIN_APPLICATION_VIEW];case f.h.GRID:return t.isAdvancedFindView?[u.a.ADVANCED_SEARCH]:[u.a.MAIN_APPLICATION_VIEW];default:return[u.a.MAIN_APPLICATION_VIEW]}}(n)),e)}function ct(t){return t&&[t.CustomControlId,t.Name].some(t=>-1!==H.a.indexOf(t))}function lt(t,e,n){if(!t||!t.contextTokenType||t.contextTokenType!==c.a.AssociatedGrid&&t.contextTokenType!==c.a.MainGrid)return null;switch(e){case"displayChart":return!1;case"displayCommandBar":return!0;case"displayIndex":return ct(n);case"displayQuickFind":case"displayViewSelector":return!0}return null}function ut(){let t=null,e=null;return(n,r,a)=>{if(t&&e===r.CustomControlId)return t;const i=r&&r.CustomControlId?r.CustomControlId:null;if(!i)return null;const s=Object(y.ab)(n,i),o=Object(z.e)(n,i);if(s&&o&&o.Properties.DataSetDefinitions&&o.Properties.DataSetDefinitions[s]&&o.Properties.DataSetDefinitions[s].CDSDataSetOptions){const n=o.Properties.DataSetDefinitions[s].CDSDataSetOptions;t={displayChart:n.hasOwnProperty("displayChart")?n.displayChart:lt(a,"displayChart",r),displayCommandBar:n.hasOwnProperty("displayCommandBar")?n.displayCommandBar:lt(a,"displayCommandBar",r),displayIndex:n.hasOwnProperty("displayIndex")?n.displayIndex:lt(a,"displayIndex",r),displayQuickFind:n.hasOwnProperty("displayQuickFind")?n.displayQuickFind:lt(a,"displayQuickFind",r),displayViewSelector:n.hasOwnProperty("displayViewSelector")?n.displayViewSelector:lt(a,"displayViewSelector",r)},e=r.CustomControlId}return t}}function dt(){let t,e=null,n=null,c=null,v=null,S="",B=null,z=null,H=null,lt=null,ut=null,dt=null,ht=null,ft=null;const yt=function(){let t=null;return(e,n,r,a)=>{let i=t;switch(Object(F.b)(a)&&(a=n.contextString),a){case f.h.ASSOCIATEDGRID:i=Object(l.b)(r);break;case f.h.SUBGRID:i=Object(l.l)(r);break;case f.h.GRID:default:i=Object(l.h)(r)}return i!==t&&(t=i),t}}(),vt=Object(O.a)(),_t=_(),St=function(){let t=null;const e=function(){let t=null;return(e,n,a)=>{let s,c,l,u,d;if(Object(y.ib)(e,n.id,a)){s=Object(y.T)(e,n.id,a);const t=Object(y.qb)(e,s,n.id);c=t&&t.entityLogicalName,d=t&&t.isUserView,l=Object(y.r)(e,n.id,a,c),u=Object(y.s)(e,n.id,a)!==b.a.savedvisualization}else{const t=Object(y.ab)(e,n.configuration.CustomControlId);if(t){const e=n.configuration.Parameters[t];e&&(s=e.ViewId&&new r.a(e.ViewId),c=e.TargetEntityType,l=e.VisualizationId&&new r.a(e.VisualizationId),u=!(!e.IsUserChart||"true"!==e.IsUserChart),d=!(!e.IsUserView||"true"!==e.IsUserView))}}if(!r.a.isNullOrEmpty(s)&&l&&c){const p=Object(y.q)(e,n.id,a),h=Object(y.p)(e,n.id,a),g=Object(y.C)(e,n.id,a),m=pt(e,n,a,g,!0),b=Object(y.N)(e,n.id,a),v=e.user&&e.user.userId,_=Object(k.c)(e,N.Zc),S=Object(V.a)(c,v,a,_),O=S&&S.getFilterAndLinkedEntities(g&&g.activityOrQueueFilterValue?g.activityOrQueueFilterValue:void 0),C=O&&null!==O.linkEntities?JSON.stringify(O.linkEntities):null,I=Object(k.a)(e,N.Od,N.h),P=!I||I&&Object(T.a)(e)===i.a.MobileApplication,j=I,E=at(n.contextString)?Object(o.p)(f.d,c,r.a.toString(s),r.a.toString(l),a.relationshipName,b,u,d,m,C,j):Object(o.t)(f.d,c,r.a.toString(s),r.a.toString(l),b,p,u,h,d,m,C,P,j);if(t){const n=E&&E.CustomControlId?E.CustomControlId:null,r=Object(y.ab)(e,n);if(r&&E.Parameters[r]){const e=E.Parameters[r],n=t.Parameters[r];e.ViewId===n.ViewId&&e.VisualizationId===n.VisualizationId&&e.EntityName===n.EntityName&&e.HighchartFilterExpression===n.HighchartFilterExpression&&e.ChartDrillDownParameters===n.ChartDrillDownParameters&&e.ExtraFilters===n.ExtraFilters||(t=E)}}else t=E}else if(t&&c&&!l){const n=t.CustomControlId,r=Object(y.ab)(e,n);r&&t.Parameters[r]&&c!==t.Parameters[r].EntityName&&(t=null)}return t}}();return(n,r,a)=>{const i=e(n,r,a),s=r.id;return t&&t.configuration===i&&t.id===s||(t={configuration:i,id:s,chartId:f.d,showChart:!0,contextToken:a}),t}}(),Ot=function(){let t=null;return(e,n,r,a,i,s)=>{const o=s.commandBarStyle,c=n.id,l=st(e,n,r&&r.parentContextToken?r.parentContextToken.entityTypeName:null,r),u=Object(y.w)(e,c,r);return t&&t.commandManagerId===u&&t.pageId===c&&t.ribbonId===i&&t.relationshipType===l&&t.contextToken===r&&t.style===o||(t={commandManagerId:u,pageId:c,ribbonId:i,relationshipType:l,contextToken:r,style:o}),t}}(),Ct=function(){let t=null;const e=ot();return(n,a,i,s,o,c)=>{var l;const d=c.viewSelectorStyle,h=r.a.toString(o),g=e(a),b=Object(y.nb)(a.id,h),f=rt(a.contextString),v=f,_=a.contextString,S=Object(y.Z)(n),O=Object(p.g)(n),C=Object(y.qb)(n,o,a.id),I=C?C.title:null;let P=u.a.MAIN_APPLICATION_VIEW;nt(_)?P=u.a.SUB_GRID:f&&a.isAdvancedFindView&&(P=u.a.ADVANCED_SEARCH);const j=Object(m.a)(n,s,P),T=j||r.a.EMPTY,E=Object(R.g)(n,null==a?void 0:a.id),F=Object(y.rb)(n,null===(l=null==E?void 0:E.pageToEditedViewMapId)||void 0===l?void 0:l.guid,null==o?void 0:o.guid);return t&&t.id===b&&t.entityTypeName===s&&t.selectedViewId===h&&t.queryViewSelectorTypes===g&&t.shouldDisplayNestedViewSelector===v&&t.isRTL===O&&t.defaultViewId===T&&t.isEdited===!!F||(t={id:b,pageId:a.id,title:I,entityTypeName:s,selectedViewId:h,style:d,queryViewSelectorTypes:g,shouldDisplayNestedViewSelector:v,contextString:_,pinnedActivityView:S,isRTL:O,defaultViewId:T,isAdvancedFindView:a.isQueryMode&&a.isAdvancedFindView,isEdited:!!F,pageToEditedViewMapId:null==E?void 0:E.pageToEditedViewMapId}),t}}(),It=function(){let t=null;return(e,n,r,a,i)=>{const s=n.id,o=Object(y.G)(e,n),c=Object(p.w)(e),l=i.filterComboStyle,u=Object(R.g)(e,s).entityFilterValue;return t&&t.id===s&&t.entityTypeName===a&&t.filterOptions===o&&t.comboBoxStyle===l&&t.userSetting===c&&u===t.previousValue||(t={id:s,filterOptions:o,entityTypeName:a,updateFilterValue:null,onFilterChange:null,resourceStrings:null,userSetting:c,style:null,comboBoxStyle:l,previousValue:u}),t}}(),Pt=function(){let t=null;return(e,n,r,a,i)=>{const s=n.id,o=Object(y.G)(e,n,a),c=Object(Y.a)(e),l=i.filterComboStyle,u=i.dueDateComboBoxStyles,d=i.activityTypeComboBoxStyles,h=Object(M.h)(e,r.relationshipName,at(n.contextString)),g=!Object(A.b)(e),m=Object(y.kb)(e,s,r),b=Object(p.g)(e),f=Object(j.a)(e),v=Object(R.g)(e,s),_=v.entityFilterValue,S=v.activityTypeFilterValue,O=Object(k.a)(e,N.a,N.h),I=Object(k.a)(e,N.a,N.Lc),P=Object(y.ub)(e,a),T=Object(k.c)(e,N.Zc),E=Object(V.a)(a,e.user.userId,r,T,P),F=E&&E.getFilterLabelResourceKey(),w=C.ACTIVITY_MGMT_ACTIVITY_TYPE_LABEL,x=C.ACTIVITY_MGMT_DUE_DATE_LABEL;if(!t||t.id!==s||t.entityTypeName!==a||t.filterOptions!==o||t.comboBoxStyle!==l||t.dueDatecomboBoxStyle!==u||t.activityTypecomboBoxStyle!==d||t.labelStyle!==i.filterLabelStyle||t.activityMgmtLabelStyle!==i.activityMgmtLabelStyle||t.isActivityManagementFeatureEnabled!==O||t.filterOptionsForActivityType!==c||t.isRollupViewSupported!==h||t.isOffline!==g||t.toggleValue!==m||t.isRTL!==b||t.theme!==f||t.previousValue!==_||t.activityTypePreviousValues!==S||t.isActivityFilterSelectAllEnabled!==I||t.entityIsActivityType!==P){const e={isRollupViewSupported:h,isOffline:g,toggleValue:m,onToggleChange:null,isRTL:b,theme:f};t=Object.assign({id:s,filterOptions:o,filterOptionsForActivityType:c,entityTypeName:a,onFilterChange:null,onActivityTypeChange:null,onActivityTypeFilterClear:null,gridEntityName:null,resourceStrings:null,comboBoxStyle:l,dueDatecomboBoxStyle:u,activityTypecomboBoxStyle:d,containerStyle:null,activityTypeContainerStyle:null,labelStyle:i.filterLabelStyle,activityMgmtLabelStyle:i.activityMgmtLabelStyle,previousValue:_,activityTypePreviousValues:S,isActivityManagementFeatureEnabled:O,activityViewContainerStyle:i.activityViewContainerStyle,entityFilterLabelResourceString:F,activityTypeFilterLabelResourceString:w,dueDateFilterLabelResourceString:x,isActivityFilterSelectAllEnabled:I,isRTL:b,entityIsActivityType:P},e)}return t}}(),jt=function(){let t=null;const e=[1041,2052,3076,1028,1042];return(n,r,a,i,s,o)=>{const c=n.id,l=n.descriptor&&n.descriptor.Id?n.descriptor.Id:null,u=s?JSON.parse(s).conditions[0]:null,d=function(t,e){if(e=e?e.value.replace("%","").toUpperCase():null,t){const n=gt(t.split(",")[0]),r=n[1].split("|");if(r&&e===r[0])return n[1]}return e}(Object(g.c)(o,C.JUMPBAR_ALPHABET),u);return e.indexOf(i)>-1?t=null:t&&t.id===c&&t.contextToken===r&&t.entityTypeName===a&&t.selectedFilter===d||(t={id:c,uniqueId:l,contextToken:r,entityTypeName:a,selectedFilter:d,languageId:i}),t}}(),Tt=function(){let t=null;return(e,n,r,a)=>{const{id:i,contextString:s}=e;return t&&t.id===i&&t.contextToken===n&&t.entityTypeName===r&&t.gridInput===a||(t={id:i,contextToken:n,entityTypeName:r,contextString:s,gridInput:a}),t}}(),Et=function(){let t=null;return(e,n,r)=>{const{id:a,contextString:i}=e;return t&&t.id===a&&t.contextToken===n||(t={id:a,contextToken:n,contextString:i}),t}}(),Ft=Object(g.h)(),wt=function(){let t=null,e=null;const n={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},r={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1};let s=null;const o={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},c={Type:"WholeNumber.None",Usage:1,Static:!0,Value:!1,Primary:!1},l={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},u={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},d={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},p={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},g={Type:"TwoOptions",Usage:1,Static:!0,Value:!1,Primary:!1},m={Type:"TwoOptions",Usage:1,Static:!0,Value:!1,Primary:!1};let b,f,v={useSkypeProtocol:n,gridPageNumber:r,isNewPageRequested:o,enhancedPagingDisabled:c,isActivityTypeFilterDisabled:l,showAddNewCommand:u,emptySubgridIconAndTextChanges:d,emptyGridChangesIfQuickFindImprovementsEnabled:p,headerDialogOnTop:g,headerDialogPreventDismissOnScroll:m};return(_,S,O)=>{const C=Object(T.e)(_),j=Object(h.x)(_).useSkypeProtocol,E=Object(y.x)(_,S.id,O),F=Object(y.X)(_,S.id,O);F||s===E||(s=E),b||(b=Object(I.a)(_),f=null!=b&&b===P.b.Native);const w=!f,x=Object(k.a)(_,N.a,N.h),{systemDefinedProperties:A}=S,D=E!==s&&F,M=w!==c.Value;let R=!1;x&&(at(S.contextString)||rt(S.contextString))&&(R=!0);let L=!1;Object(q.a)(_)&&nt(S.contextString)&&(L=!0);let V=!1;Object(q.a)(_)&&Object(k.c)(_,N.Md)&&nt(S.contextString)&&Object(T.a)(_)===i.a.MobileApplication&&(V=!0);let B=!1;if(Object(q.a)(_)&&Object(k.c)(_,N.ad)&&rt(S.contextString)&&Object(T.a)(_)===i.a.MobileApplication){const t=Object(y.C)(_,S.id,O);(null==t?void 0:t.quickFind)&&(B=!0)}const G=!rt(S.contextString)&&a.a.Tablet===C,X=a.a.Tablet===C&&!at(S.contextString)||"Web"===Object(T.k)(_)&&!et.a.getInstance().get_IsAndroid()&&!et.a.getInstance().get_IsWindows()&&!et.a.getInstance().get_isIPhone();if(C!==t||j!==e||D||M||F!==o.Value||R!==l.Value||L!==u.Value||V!==d.Value||B!==p.Value||G!==g.Value||X!==m.Value){t=C,e=j,r.Value=E,s=E,o.Value=F,c.Value=w,l.Value=R,u.Value=L,d.Value=V,p.Value=B,g.Value=G,m.Value=X;const a=null==t?j:null;(a!==n.Value||D||M)&&(n.Value=a,v=Object.assign(Object.assign({},A),{useSkypeProtocol:n,gridPageNumber:r,isNewPageRequested:o,enhancedPagingDisabled:c,isActivityTypeFilterDisabled:l,showAddNewCommand:u,emptySubgridIconAndTextChanges:d,emptyGridChangesIfQuickFindImprovementsEnabled:p,headerDialogOnTop:g,headerDialogPreventDismissOnScroll:m}))}return v}}(),xt=function(){let t=null,e=null;return(n,r,a)=>(n&&(e&&t===n&&!a||(e=Object.assign({},n),n.Parameters&&(e.Parameters=Object.assign({},n.Parameters),r&&n.Parameters[r]&&(e.Parameters[r]=Object.assign({},n.Parameters[r]),n.Parameters[r].Columns&&(e.Parameters[r].Columns=n.Parameters[r].Columns.slice(0)))),t=n)),e)}(),At=Object(E.s)(),Nt=function(){const t=[];return(e,n,r,a,i,s,o,c,l,u,d)=>(t&&t.length&&t.splice(0,t.length),t.push({name:L.b.IsGridRoot,value:e},{name:L.b.IsSubGrid,value:n},{name:L.b.IsAssociatedGrid,value:r},{name:L.b.EntityName,value:a},{name:L.b.ViewId,value:i},{name:L.b.IsEmptyFetch,value:s},{name:L.b.IsEmptyOfflineSqlQuery,value:o},{name:L.b.IsValidFetchXmlForOfflineUsage,value:c},{name:L.b.IsEntityAvailableForOfflineUsage,value:l},{name:L.b.OfflineConfigurationErrorCode,value:u},{name:L.b.RelatedEntityUnavailableOffline,value:d}),t)}(),kt=function(){let t=null;return e=>(t||(t={isGridPaginationStateFeatureEnabled:Object(k.a)(e,N.zb),isAssociatedGridHeightEnabled:Object(M.e)(e),isChartOnAssociatedGridEnabled:Object(k.a)(e,N.x,N.h,N.i),isGridProgressIndicatorFeatureEnabled:Object(k.a)(e,N.Ab),isInMobileModeForOct2019:Object(q.b)(e),isJumpBarShouldHonorSortingFeatureEnabled:Object(k.a)(e,N.ac),isJumpbarFeatureForMobileEnabled:Object(k.c)(e,N.Kb),isSuiterChartEnabled:Object(k.a)(e,N.Od,N.h),isSuiterDashboardEnabled:Object(k.a)(e,N.Pd,N.h),isAdvancedFindEnabled:Object(Q.a)(e),isDisableEditableGridControlOnPhoneFeatureEnabled:Object(k.c)(e,N.O),isInMobileModeForApril2020:Object(q.a)(e),isSubgridImprovementsEnabled:Object(k.c)(e,N.Md),isSubGridAutoCollapseEnabled:Object(k.a)(e,N.Jd,N.Lc),isSubGridRemoveMinHeightEnabled:Object(k.a)(e,N.Ld,N.Lc),isQuickFindImprovementsEnabled:Object(k.c)(e,N.ad),isShowAsButtonFirstEnabled:Object(k.c)(e,N.Bd),isColumnEditorButtonEnabled:Object(y.tb)(e),isQueueFilterPerfUCIEnabled:Object(k.c)(e,N.Zc)}),t)}(),Dt=function(){let t={fetchXML:null,entityName:null,isOffline:null},e={error:!1,errorCode:null,relatedEntityUnavailableOffline:null};return function(n,r,a,i){if(t.entityName!==a||t.fetchXML!==r||t.isOffline!==i)if(Object(x.k)(a)){const s=Object(x.b)(n,r);e={error:s.error,errorCode:s.error?C.LINKED_ENTITY_NOT_SUPPORTED:null,relatedEntityUnavailableOffline:s.relatedEntityUnavailableOffline},t={fetchXML:r,entityName:a,isOffline:i}}else e={error:!0,errorCode:C.ACTIVITY_ENTITY_NOT_SUPPORTED_OFFLINE},t={fetchXML:r,entityName:a,isOffline:i};return e}}();return function(a,i){var o;const l=Object(p.w)(a),b=_t(a,i),_=Object(y.v)(a,i.id,b),O=b.relationshipName,E=b.roleOrd,L=Object(y.N)(a,i.id,b),q=Object(y.I)(a,i.id,b),Y=Object(y.x)(a,i.id,b),Q=i.descriptor,et=bt.bind(null,i,Q),st=i.configuration,ot=st&&st.CustomControlId?st.CustomControlId:null,gt=Object(I.a)(a),Mt=Object(T.e)(a),Rt=Object(y.ab)(a,ot)||(i.contextString===f.h.CUSTOM?f.g:null),Lt=rt(i.contextString),Vt=kt(a),Bt=Object(y.A)(a,b,i);let Gt=null,Xt=!1,Ut=null;const qt=Object(y.t)(a,i.id,b),zt=Object(y.C)(a,i.id,b);Lt&&(Gt=Object(R.g)(a,i.id),Vt.isGridPaginationStateFeatureEnabled&&(Ut=Gt.gridSortingInfo,Ut&&(Object(F.a)(lt)||lt!==Ut)&&(lt=Ut,Xt=!0),qt&&(Object(F.a)(ut)||ut!==qt.customFilterXml)&&(ut=qt.customFilterXml,Xt=!0)),(zt&&Object(F.a)(dt)||dt!==zt)&&(dt=zt,Xt=!0));const Ht=xt(st,Rt,Xt),Wt=Ht&&Ht.Parameters?Ht.Parameters[Rt]:null,Yt=at(i.contextString),Kt=nt(i.contextString),Qt=!Object(A.b)(a),Jt=Object(y.jb)(a,b,i),Zt=Wt&&!!Wt.DataProvider,$t=Wt&&!!Wt.BoundViewParams,te=Object(h.x)(a),ee=te&&te.gridTotalRecordCountLimit?te.gridTotalRecordCountLimit:5e3,ne=Object(y.ib)(a,i.id,b),re=ct(i.configuration),ae=ct(i.configuration);if(null!=i.nonCompositionProps){const t=st&&st.FormFactor&&st.FormFactor.toString(),e=Object(D.c)(i.nonCompositionProps.gridConfigurations,i.nonCompositionProps.viewConfigurations,st,null,f.h.GRID,t).map(t=>t.configuration.DisplayNameKey),n=Ft(a,e);(!H&&""!==Object(g.c)(n,e[0])||H!==n)&&(H=n)}let ie=!!_;let se=Object(y.T)(a,i.id,b)||(Q&&Q.Parameters&&Q.Parameters.ViewId?r.a.parse(Q.Parameters.ViewId):null);const oe=Object(y.qb)(a,se,i.id),ce=(null==oe?void 0:oe.isUserView)?u.b.userview:u.b.savedview,le=null==oe?void 0:oe.queryType,ue=null==oe?void 0:oe.entityLogicalName;ue&&ue!==c&&(c=ue);const de=Object(d.h)(a,c),pe=!Qt&&gt===P.b.Web&&Lt&&Vt.isAdvancedFindEnabled&&(null==de?void 0:de.IsValidForAdvancedFind);if(!z||t!==pe){let e=[...C.labelList];pe&&(e=[...e,K.c.OpenAdvancedFiltersTitleAndAria]);const n=Ft(a,e);""!==Object(g.c)(n,C.JUMPBAR_ALL_TITLE)?(z=n,t=pe):ie=!1}const he=Object(y.W)(a,ot);he&&he!==B&&(B=he);const ge=vt(a,i);ct(i.configuration)&&(Object.assign(ge.bodyStyle,{flexDirection:"column"}),Object.assign(ge.bodyMobileStyle,{flexDirection:"column"}));let me=Object(y.F)(a,i.id,b)||(Q&&Q.Parameters&&Q.Parameters[f.u]?Q.Parameters[f.u]:null),be=me;Lt&&(be=Gt.entityTypeName);const fe=Object(w.b)(a,me);de&&de.Initialized===s.a.Initialized||Zt||$t||(ie=!1);const ye=de?de.DisplayName:"",ve=Object(h.t)(a),_e=Object(d.i)(a,me),Se=!(oe&&oe.fetchXML),Oe=oe&&oe.viewId,Ce=Dt(a,Se?"":oe.fetchXML,c,Qt),Ie=!Se&&!Ce.error,Pe=null!=oe&&Object(F.b)(oe.offlineSqlQuery),je=Object(x.l)(a,c),Te=Nt(Lt,Kt,Yt,c,Oe?Oe.guid:null,Se,Pe,Ie,je,Ce.error&&Ce.errorCode||"",Ce.error&&Ce.relatedEntityUnavailableOffline||""),Ee=!((Lt||Yt||Kt)&&oe&&oe.fetchXML&&Qt&&je)||!Pe&&Ie;let Fe="";if(Ee?je||(Fe=C.ENTITY_NOT_AVAILABLE_IN_PROFILE):Pe?Fe=C.SQL_QUERY_NOT_AVAILABLE:Ce.error&&(Fe=Ce.errorCode),Wt){Wt.TargetEntityType&&me!==Wt.TargetEntityType&&(me=Wt.TargetEntityType),Wt.ExtraFilters=pt(a,i,b,zt,!1);const t=function(t,e,n,r,a){let i=[];const s=Object(y.q)(t,e.id,n);if(s){const t=JSON.parse(s);if(t.conditions)for(const e of t.conditions)e.linkEntityExpressions&&(i=i.concat(e.linkEntityExpressions))}const o=t.user&&t.user.userId,c=Object(k.c)(t,N.Zc),l=Object(y.ub)(t,r),u=Object(V.a)(r,o,n,c,l);let d=u&&u.getFilterAndLinkedEntities(a&&void 0!==a.activityOrQueueFilterValue?a.activityOrQueueFilterValue:G.a,a&&!a.activityOrQueue);d&&d.linkEntities&&(i=i.concat(d.linkEntities));return d=d||{filter:null,linkEntities:null},d.linkEntities=i,d}(a,i,b,me,zt);if(t&&t.filter&&(Wt.ExtraFilters?Wt.ExtraFilters.push(JSON.stringify(t.filter)):Wt.ExtraFilters=[JSON.stringify(t.filter)]),t&&t.linkEntities&&t.linkEntities.length>0){let e={Static:!0,Value:Object(X.b)(t.linkEntities)};if(Wt.LinkingInput){e=Wt.LinkingInput;const n=Object(X.a)(Wt.LinkingInput.Value);if(n){const r=new U.a;n.forEach(t=>{r.addLinkedEntity(t)}),t.linkEntities.forEach(t=>{r.addLinkedEntity(t)}),e.Value=Object(X.b)(r.getLinkedEntities())}}Wt.LinkingInput=e}if(se){const t=r.a.toString(se);t!==Wt.ViewId&&(Wt.ViewId=t)}else se=r.a.tryParseOrNull(Wt.ViewId);(Q&&Q.Parameters?"false"===Q.Parameters[f.F.ENABLE_CONTEXTUALACTIONS]:null)&&(Ht.Parameters[f.i]={Usage:1,Static:!0,Type:"Enum",Value:!1,Primary:!1})}me&&me!==v&&(v=me);const we=Object(d.r)(a,me)&&i.contextString===f.h.GRID?y.a:me,xe=Wt&&Wt.CommandBarContext,Ae=yt(a,i,we,xe),Ne=function(t,e,n){const r=Object(y.qb)(t,e,n);return r&&r.grid&&r.grid.rows&&r.grid.rows[0]&&r.grid.rows[0].cells}(a,se,i.id),ke=null==Ne?void 0:Ne.map(t=>t.name),De=null==n?void 0:n.map(t=>t.name);(JSON.stringify(ke)!==JSON.stringify(De)||(se&&se.guid)!==(e&&e.guid)||O===ht&&E!==ft)&&(e=se,ft=E,S=(Q&&Q.Id?Q.Id:"")+(new Date).getTime(),n=Ne),O&&O!==ht&&(ht=O);const Me=Object(y.o)(a,me),Re=Me?Me.lookupAttribute:null;Wt&&(function(t,e,n,r,a,i,s){const o=Object(d.h)(t,r);if(o&&ct(e.configuration)){const c=f.b;n.Columns||(n.Columns=[]),r!==y.a||a&&a.some(t=>t.name===c)||n.Columns.find(t=>t.Name===c)||n.Columns.push({Alias:c,DataType:"",Type:"",Name:c});const l=o&&o.PrimaryNameAttribute,u=a&&a.some(t=>t.name===l);if(!l||u||n.Columns.some(t=>t.Name===l)||n.Columns.push({Alias:l,DataType:"",Type:"",Name:l}),!Object(y.vb)(e.configuration.Parameters)){const e=Object(M.a)(o.PrimaryImageAttribute);e&&!n.Columns.find(t=>t.Name===e)&&n.Columns.push({Alias:W.d,DataType:"SingleLine.Text",Type:"",Name:e}),Object(k.a)(t,N.ub)&&i&&s&&(n.Columns.find(t=>t.Name===y.c)||n.Columns.push({Alias:y.c,DataType:"Whole.None",Type:"",Name:y.c,PreventMetadataRequest:!0}),n.Columns.find(t=>t.Name===i)||n.Columns.push({Alias:i,DataType:"Lookup.Simple",Type:"",Name:i}))}}}(a,i,Wt,me,n,Re,!Object(F.a)(Gt)),function(t,e,n,r,a){if(!Object(y.vb)(e.configuration.Parameters))return;(null==a?void 0:a.some(e=>{var n;return(null===(n=Object(Z.a)(t,r,e.name))||void 0===n?void 0:n.Type)===$.a.moneyType}))&&(n.Columns.some(t=>t.Alias===f.A)||n.Columns.push({Alias:f.A,DataType:"Lookup.Simple",Type:"",Name:W.w}))}(a,i,Wt,me,n));const Le=!me||(Object(w.i)(me)||Object(w.g)(a,me,2,0)&&function(t,e){let n=!0;e&&e.forEach(e=>{if(e.relatedEntityName&&(n=Object(w.g)(t,e.relatedEntityName,2,0),!n))return!1});return n}(a,n)),Ve=Object(y.Y)(a,i.id,b),Be=Ve?JSON.parse(Ve):null,Ge=Be?Be.totalResultCount:null,Xe=Be?Be.pageSize:null,Ue=null!==Ge&&Ge>-1?0===Ge?Object(g.c)(z,C.NO_DATA_AVAILABLE):String.format(C.X_RECORDS_PRESENT,Ge):"",qe=At(a,Lt),ze=!(null!=gt&&gt===P.b.Native),He=Object(y.rb)(a,null===(o=null==Gt?void 0:Gt.pageToEditedViewMapId)||void 0===o?void 0:o.guid,null==se?void 0:se.guid),We={isEmptyOfflineSqlQuery:Pe,isEntityAvailableForOffline:je,isOfflineSqlQueryAvailable:Ee,offlineErrorMessageKey:Fe,isOfflineAvailableForUse:Object(J.w)(a),offlineGridErrorTelemetryParams:Te},Ye=Object(tt.d)(a),Ke=Object(m.c)(a,e),Qe=!Qt&&gt===P.b.Web&&Lt&&Vt.isColumnEditorButtonEnabled&&!Yt&&!Kt,Je=Object(y.ub)(a,me);return{showAdvancedFilter:pe,isViewEdited:!!He,isInitialized:ie,viewId:e,customFilter:qt,gridEntityTypeName:c,chartEntityTypeName:c,isUCIEntity:fe,totalRecordCountLimitExceeded:Jt,chartProps:ne?St(a,i,b):null,viewDescriptor:oe,commandBarProps:et(f.E.COMMANDBAR_ENABLED,!0,f.F.ENABLE_CONTEXTUALACTIONS,Rt,!0)?Ot(a,i,b,Q,Ae,ge):null,viewSelectorProps:be&&et(f.E.VIEWSELECTOR_ENABLED,!0,f.F.ENABLE_VIEW_PICKER,Rt)?Ct(a,i,b,be,e,ge):null,queueFilterProps:st&&et(null,!0,f.F.ENABLE_QUEUEFILTER,Rt)?It(a,i,b,me,ge):null,entityFilterProps:Qt||!Je&&!Object(M.h)(a,ht,Yt)?null:Pt(a,i,b,me,ge),jumpBarProps:et(f.E.JUMPBAR_ENABLED,re,f.F.ENABLE_JUMPBAR,Rt)&&mt(i)?jt(i,b,me,l.languageId,zt?zt.jumpBar:null,z):null,quickFindProps:et(f.E.QUICKFIND_ENABLED,!0,f.F.ENABLE_QUICKFIND,Rt)?Tt(i,b,me,Gt):null,pagingProps:et(f.E.PAGING_ENABLED,ae,null,Rt)?Et(i,b,me):null,contextToken:b,controlKey:S,styles:ge,refreshCounter:L,pagingRefreshInput:q,pageNumber:Y,ribbonId:Ae,semanticTag:it(i.contextString),recordsPerPageSetting:Object(p.h)(a),userSetting:l,hasReadRolePrivilege:Le,resourceStrings:z,switchVisualizationResourceStrings:H,entityTypeName:v,primaryDataSetName:Rt,nestedGridDatasetName:B,viewportSm:Object(j.a)(a).sizes.Breakpoints.DimensionS,viewportM:Object(j.a)(a).sizes.Breakpoints.DimensionM,systemDefinedProperties:wt(a,i,b),platformType:Object(I.a)(a),isGridEditable:Object(y.vb)(st?st.Parameters:null),notificationMessage:Ue,totalResultCount:Ge,pageSize:Xe,offlineProps:We,isRTL:Object(p.g)(a),entityDisplayName:ye,isOffline:Qt,showChart:ne,entityIconVectorName:_e,webResourceUrl:ve,hasCustomDataProvider:Zt,commandBarRefreshProps:qe,updatedConfiguration:Ht,offlineGridErrorTelemetryParams:Te,gridInput:Gt,gridTotalRecordsCountLimit:ee,gridSortingInfo:Ut,nativeFilterExpression:Vt.isGridPaginationStateFeatureEnabled&&Gt?Gt.nativeFilterExpression:null,pageNumberForEnhancedPaging:Vt.isGridPaginationStateFeatureEnabled&&!ze&&Gt?Gt.gridPageNumber:null,userId:a.user&&a.user.userId||null,lookupAttributeForRecordHierarchy:Re,fetchXML:Bt,viewType:ce,savedQueryType:le,featureControlProps:Vt,clientHostSubtype:Mt,backButtonEnabled:Ye,originalView:Ke,showColumnEditor:Qe,entityIsActivityType:Je}}}function pt(t,e,n,r,a){if(!r)return[];const i=rt(e.contextString),s=at(e.contextString),o=nt(e.contextString)&&Object(k.c)(t,N.bd),c=[];for(const t in r)c.push([t,r[t]]);const l=c.reduce((t,[e,n])=>((i||s||o)&&"quickFind"===e||("activityOrQueueFilterValue"===e||"activityTypeSelectedValues"===e)||!n||t.push(n),t),[]);if(a){const r=Object(y.t)(t,e.id,n);if(r&&r.customFilterXml){const t=Object(B.i)(r.customFilterXml),e=JSON.stringify(t);e&&l.push(e)}}else{const r=Object(y.q)(t,e.id,n);r&&l.push(r)}return l}function ht(t){let e=t.configuration&&"MscrmControls.SharepointAssociatedGrid.SharepointControl"===t.configuration.CustomControlId;return e||(e=t.configuration&&"MscrmControls.SharepointAssociatedGrid.SharepointControl"===t.configuration.Name),e}function gt(t){if(!t&&"("!==t[0]||")"!==t[t.length-1])throw new Error(String.format("Resource string group must be in the format (A:a).  The format {0} is invalid.",t));const e=(t=(t=t.replace("(","")).replace(")","")).split(":");if(2!==e.length)throw new Error("Resource string group must have a search list defined.  E.g : (A:a).");return e}function mt(t){var e,n,r;return"no"!==(null===(r=null===(n=null===(e=t.configuration)||void 0===e?void 0:e.Parameters)||void 0===n?void 0:n.EnableJumpBar)||void 0===r?void 0:r.Value)}function bt(t,e,n,r,a,i,s){let o=t.dataSetUIOptions,c=r;if(s=!!Object(F.a)(s)||s,!o&&t.configuration&&t.configuration.Parameters){const e=t.configuration.Parameters[i];e&&e[f.f]&&(o=e[f.f])}const l=e&&e.Parameters&&e.Parameters[a]?"true"===e.Parameters[a]:s;return o&&n&&!Object(F.a)(o[n])&&(c=o[n]),c&&l}},kt5S:function(t,e,n){"use strict";n.d(e,"g",(function(){return v})),n.d(e,"i",(function(){return _})),n.d(e,"h",(function(){return S})),n.d(e,"e",(function(){return O})),n.d(e,"f",(function(){return C})),n.d(e,"a",(function(){return I})),n.d(e,"c",(function(){return j})),n.d(e,"b",(function(){return E})),n.d(e,"d",(function(){return P}));var r=n("BFlg"),a=n("P6DH"),i=n("arV0");function s(t,e,n,r){return{type:"update.grid.configuration",payload:{[e]:{[n]:t}},meta:{pageId:r}}}function o(t,e,n){return{type:"update.views.configuration",payload:{[e]:t},meta:{pageId:n}}}var c=n("oOvK"),l=n("9fGf"),u=n("Z/4N"),d=n("y60j"),p=n("SAYH"),h=n("KBcj"),g=n("S2mk"),m=n("5ZBI"),b=n("j6Db"),f=n("zmL5");function y(t,e){const n=Object.assign({},t.CustomControls);if(t.CustomControls[e]&&!t.CustomControls[e].isDefaultConfig){let r=!1;for(const n in t.CustomControls)if(I(t.CustomControls[n],t.CustomControls[e])&&n!==e.toString()){r=!0;break}if(!r){let r=-1;n[r]?r--:n[r.toString()]=t.CustomControls[e]}}return n[e]=null,n}function v(t,e,n,r,u){return{type:"customcontrol.changevisualization.homepage",sync:!0,execute({dispatch:d,getState:p},h){const g=p(),f=Object(l.b)(g),y=Object(a.k)(g,t,e),v={UniqueId:y?y.UniqueId:null,CustomControls:{[f]:Object.assign(Object.assign({},n),{FormFactor:f})},FormLibraries:y?y.FormLibraries:null,EventHandlers:y?y.EventHandlers:null},{entityTypeName:_}=Object(i.g)(g,t);if(u){const n=Object(a.T)(g,t,e);d(o({UniqueId:null,CustomControls:{[f]:null},FormLibraries:null,EventHandlers:null},n.guid,t))}d(Object(c.c)(n.CustomControlId)).then(()=>{d(s(v,_,r,t))},e=>{const a=Object(m.b)(p(),n.CustomControlId);h.EventManager.ReportComponentFailure(a+".CustomControl.retrieveControlManifest",e,"retrieveControlManifest failure error message",[{name:"APIName",value:b.a+".Actions.SwitchVisualization"},{name:"entityTypeName",value:_},{name:"customControlId",value:n.CustomControlId},{name:"pageId",value:t},{name:"controlId",value:r},{name:"config",value:JSON.stringify(n)}])})}}}function _(t,e,n,r,u){return{type:"customcontrol.changevisualization.homepage",sync:!0,execute({dispatch:d,getState:p}){const g=p(),m=Object(l.b)(g),b=Object(a.T)(g,t,e),f=Object(h.d)(g,b),v={UniqueId:f?f.UniqueId:null,CustomControls:{[m]:Object.assign(Object.assign({},n),{FormFactor:m})},FormLibraries:f?f.FormLibraries:null,EventHandlers:f?f.EventHandlers:null},{entityTypeName:_}=Object(i.g)(g,t);if(u){const n=Object(a.k)(g,t,e);if(n&&n.CustomControls&&n.CustomControls[m]){const e={UniqueId:n.UniqueId,CustomControls:y(n,m),FormLibraries:n.FormLibraries,EventHandlers:n.EventHandlers};d(s(e,_,r,t))}}d(Object(c.c)(n.CustomControlId)).then(()=>{d(o(v,b.guid,t))})}}}function S(t,e,n){return{type:"customcontrol.changevisualization.subgrid",sync:!0,execute({dispatch:r,getState:a}){const i=a(),o=Object(l.b)(i),p=Object(f.b)(i,t),h=Object(d.b)(i,t,p,n),g=Object(u.b)(i,h.UniqueId,p);if(!g||!g.CustomControls)return;const m={UniqueId:h.UniqueId,CustomControls:{[o]:Object.assign(Object.assign({},e),{FormFactor:o})},FormLibraries:g.FormLibraries,EventHandlers:g.EventHandlers};r(Object(c.c)(e.CustomControlId)).then(()=>{r(s(m,p.guid,g.UniqueId,t))})}}}function O(t,e,n,r,a){return{type:"customcontrol.changevisualization.associatedgrid.grid",sync:!0,execute({dispatch:i,getState:o}){const u=o(),d=Object(l.b)(u),p={UniqueId:a.UniqueId,CustomControls:{[d]:Object.assign(Object.assign({},r),{FormFactor:d})},FormLibraries:a.FormLibraries,EventHandlers:a.EventHandlers};i(Object(c.c)(r.CustomControlId)).then(()=>{i(s(p,e,n,t))})}}}function C(t,e,n,r,a,i,u){return{type:"customcontrol.changevisualization.associatedgrid.view",sync:!0,execute({dispatch:d,getState:p}){const h=p(),g=Object(l.b)(h),m={UniqueId:i.UniqueId,CustomControls:{[g]:Object.assign(Object.assign({},a),{FormFactor:g})},FormLibraries:i.FormLibraries,EventHandlers:i.EventHandlers};if(u&&u.CustomControls&&u.CustomControls[g]){const r={UniqueId:u.UniqueId,CustomControls:y(u,g),FormLibraries:u.FormLibraries,EventHandlers:u.EventHandlers};d(s(r,e,n,t))}d(Object(c.c)(a.CustomControlId)).then(()=>{d(o(m,r.guid,t))})}}}function I(t,e){if(t&&e){let n=!!t==!!e&&t.CustomControlId===e.CustomControlId&&t.Name===e.Name&&t.ShouldOverrideControlVisible===e.ShouldOverrideControlVisible&&t.Version===e.Version&&t.isDefaultConfig===e.isDefaultConfig&&function t(e,n){var r,a;if(e&&n&&e!==n){if(e instanceof Array&&n instanceof Array&&e.length!==n.length)return!1;for(const i in e)if(e[i]!==n[i]){if("function"==typeof e[i])continue;if(e[i]&&n[i]&&"object"==typeof e[i]&&"object"==typeof n[i]){if(t(e[i],n[i]))continue;return!1}if("EnableViewPicker"===i)return(null===(r=e[i])||void 0===r?void 0:r.toString())===(null===(a=n[i])||void 0===a?void 0:a.toString());if("ExtraFilters"!==i&&"PagingInput"!==i&&"FilteringInput"!==i&&"RefreshInput"!==i&&"ViewId"!==i&&"EntityName"!==i&&"LinkingInput"!==i&&"FirstDataRequestType"!==i&&"NativeFilterExpressionToRestore"!==i&&"LookupAttributeNameForHierarchy"!==i&&"SortingInput"!==i&&"function"!=typeof e[i])return!1}}return!0}(t.Parameters,e.Parameters);if(t.Children&&e.Children){if(Object.keys(t.Children).length===Object.keys(e.Children).length){for(const r in t.Children)n=n&&I(t.Children[r],e.Children[r]);return n}return!1}return n&&t.Children===e.Children}return!!t==!!e}function P(t,e,n,r,a,i,s,o){const c=e?e.TraceManager.getTracer("customcontrol"):null;return t(j(n,r,i.configuration,i,i.contextString,o).map(t=>t.configuration.DisplayNameKey)).catch(t=>(c&&c.info("Resource retrieve failed: "+t.message),Promise.resolve()))}function j(t,e,n,a,i,s){const o=[];if(null==s)return o;if(i===r.h.CUSTOM&&a.configuration.isDefaultConfig)return o;const c=i===r.h.GRID||i===r.h.ASSOCIATEDGRID?Object(g.u)(a&&a.controlId,a&&a.gridEntityTypeName,a&&p.a.toString(a.viewId)):Object(g.x)(a&&a.controlId,a&&a.descriptor.Parameters);return o.push({configuration:c,formFactor:s,configurationType:null}),t&&t.CustomControls&&T(o,t,"GRID_CONFIG"),e&&e.CustomControls&&T(o,e,"VIEW_CONFIG"),o}function T(t,e,n){for(const r in e.CustomControls)if(e.CustomControls[r]&&!e.CustomControls[r].isDefaultConfig){let a=!1;for(let n=0;n<t.length;n++)if(I(t[n].configuration,e.CustomControls[r])){a=!0;break}a||t.push({configuration:e.CustomControls[r],formFactor:r,configurationType:n})}}function E(t,e){return null!=e.DisplayNameKey?null!=t&&null!=t[e.DisplayNameKey]?t[e.DisplayNameKey]:e.DisplayNameKey:"Grid"}},lEp6:function(t,e,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(t){let e=null;try{e=JSON.parse(t)}catch(t){}return e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(t){let e="";try{e=JSON.stringify(t)}catch(t){}return e}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a}))},"lIi+":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("WLAV"),a=n("ruPX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(t,e,n,i,s,o,c,l){const u={powerBIEmbedUrl:e,powerBIGroupId:n,powerBIDashboardId:i,powerBITileId:s,powerBIReportId:o,powerBIReportUrl:c,powerBIComponentTypeCode:l};return Object(a.a)(r.a,u,t,{target:"dialog"})}},ldWj:function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var r=n("0nOn"),a=n("ScMg"),i=n("i1f0"),s=n("Sbn7"),o=n("16wZ"),c=n("vlcQ"),l=n("3MuQ"),u=n("qshH"),d=n("ZIjf"),p=n("IaGr");let h;class g extends a.a{constructor(t,e,n,a,i,s){super(t,e,n,a),this._parent=i,h=t,this._formContext=s,this._iConnectedSectionProp={sectionName:this.name,id:this.pageId},this._clientApiExecutorTabSection=new r.a(t,"ClientApi.XrmTabSection.",n,e),this.clientApiExecutor.addEventParameter({name:"controlName",value:a,isEventParam:!0})}get clientApiExecutor(){return this._clientApiExecutorTabSection}get controls(){return this.clientApiExecutor.execute("controls",(t,e)=>{if(!this._controls){const n=h.getState();this._controls=new s.a(t);const r=this.getControlsDescriptor(n);if(!r)return this._controls;for(const n in r){const r=this._formContext.ui.controls.get(n);if(r)this._controls.add(r.getName(),r);else{const r=e.slice();r.push({name:"controlKey",value:n}),p.a.getInstance().traceManager.getTracer(t).warn("Section control was not found in the form controls collection",r)}}}return this._controls})}getParent(){return d.a.instance.reportUsage("ClientApi.XrmTabSection.getParent"),this._parent}getVisible(){const t="ClientApi.XrmTabSection.getVisible";try{d.a.instance.reportCall(t);const e=Object(i.tc)(h.getState(),this._iConnectedSectionProp,this.contextToken),n=Object(o.a)(e)?this._getSectionDescriptorValues().Visible:e;return d.a.instance.reportSuccess(t),n}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(t,e,null,n),e}}getLabel(){const t="ClientApi.XrmTabSection.getLabel";try{d.a.instance.reportCall(t);const e=Object(i.rc)(h.getState(),this._iConnectedSectionProp,this.contextToken),n=Object(o.a)(e)?this._getSectionDescriptorValues().Label?this._getSectionDescriptorValues().Label:"":e;return d.a.instance.reportSuccess(t),n}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(t,e,null,n),e}}_getSectionDescriptorValues(){try{return Object(i.qc)(h.getState(),this._iConnectedSectionProp,this.contextToken)}catch(t){const e=u.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure("ClientApi.XrmTabSection._getSectionDescriptorValues",t,null,e),t}}getControlsDescriptor(t){try{return Object(i.H)(t,this._iConnectedSectionProp,this.contextToken)}catch(t){const e=u.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure("ClientApi.XrmTabSection.getControlsDescriptor",t,null,e),t}}setVisible(t){const e="ClientApi.XrmTabSection.setVisible";try{d.a.instance.reportCall(e),h.dispatch(Object(c.b)(this.pageId,this.contextToken,this.name,!0===t)),d.a.instance.reportSuccess(e)}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(e,t,null,n),t}}setLabel(t){const e="ClientApi.XrmTabSection.setLabel";Object(o.a)(t)&&Object(o.j)(e,"label");try{d.a.instance.reportCall(e),h.dispatch(Object(l.b)(this.pageId,this.contextToken,this.name,t)),d.a.instance.reportSuccess(e)}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(e,t,null,n),t}}}},lxh6:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="form.ViewPortSizes.set";function i(t,e,n,i){const s=Object(r.v)(e);return{type:a,payload:{viewportWidth:n,viewportHeight:i},meta:{pageId:t,contextKey:s}}}},"m+2h":function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="footer.visible";function i(t,e,n){const i=Object(r.v)(e);return{type:a,payload:n,meta:{pageId:t,contextKey:i}}}},mLMm:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s}));var r=n("dHD5"),a=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="update.grid.paging.refresh.input";function s(t,e){return{type:"update.grid.paging.refresh.input.async",execute({dispatch:n,getState:s},o){const c=o.TraceManager.getTracer(a.z),l=a.x+".updateGridPagingRefreshInputAction";try{const a=Object(r.u)(e);return n(function(t,e){return{type:i,payload:Math.floor(1e3*Math.random()),meta:{pageId:t,dataSetContextKey:e}}}(t,a)),c.info("Updating the grid pagingRefreshInput"),o.EventManager.ReportComponentSuccess(l),Promise.resolve()}catch(t){const e="Updating the grid pagingRefreshInput failed with error : "+t.message;o.EventManager.ReportComponentFailure(l,Error(e))}}}}},meVR:function(t,e,n){"use strict";n.d(e,"a",(function(){return E}));var r=n("+zjj"),a=n("+Ajx"),i=n("6Qf/"),s=n("P6DH"),o=n("d0w6"),c=n("KBcj"),l=n("vNXc"),u=n("a72m"),d=n("BFlg"),p=n("pEXn"),h=n("5R5s"),g=n("hSDL"),m=n("aF0N"),b=n("Ii8m"),f=n("69Qu"),y=n("jAuy"),v=n("eXjw"),_=n("Lyxw"),S=n("3/02"),O=n("fyfl"),C=n("FZDd");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const I=`${d.x}.${d.v}`;function P(t,e,n,r,a,o,u,d,p,m){const b=T(r,u,p),v=Object(c.c)(e,n);if(!v)return Promise.resolve(null);const O=l.a.fromXmlAndSql(v.fetchXML,v.offlineSqlQuery,n).getQueryState(),C=m||Object(s.db)(e,r,u),I=Object(y.c)(a,o);let P=!1;Object(f.b)(e)&&Object(y.h)(e,o.relationshipName,!0)&&(P=!0);const E=Object(s.ub)(e,r);if(E||"activitypointer"===r||P){const n=e.user&&e.user.userId,s=Object(_.c)(e,S.Zc),c=Object(h.a)(r,n,o,s,E);return t(c.getFilterOptionsAction()).then(n=>{if(n&&n.length>0){const e=n.filter(t=>t.isDefault);if(e&&e.length>0){const n=c.getFilterExpression(e[0].value);t(Object(g.l)(n,a,o))}}return t(Object(i.d)(O,r,a,o,null,u,C,P,I)).then(n=>j(t,n,e,r,a,b,d))})}return t(Object(i.d)(O,r,a,o,null,u,C,void 0,I)).then(n=>j(t,n,e,r,a,b,d))}function j(t,e,n,r,a,o,c){const l=Object(m.c)(n),u=Object(m.b)(n);return(l||u)&&Object(s.sb)(n,r)&&Object(i.e)(c,t,r,a),c.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid.initializeRelatedGrid",o),c.EventManager.ReportComponentSuccess(I,o),e}function T(t,e,n){return[{name:p.a.CorrelationId,value:n.correlationId},{name:p.a.ContextId,value:n.contextId},{name:p.a.ActionStack,value:n.stack},{name:"entityName",value:t},{name:"relationshipName",value:e}]}function E(t,e,n){const i=[{name:"EntityName",value:n.entityName}];return{type:"form.related.openGrid",execute({dispatch:i,getState:l},d,h){const g=l(),m=Object(r.e)(g,{id:t},e.parentContextToken),f=T(n.entityName,n.relationshipName,h);if(i(Object(a.b)(t,e,n)),null!==m&&m.id===n.id&&m.isSelected===n.isSelected&&m.relationshipName===n.relationshipName||i(Object(a.b)(t,e.parentContextToken,n)),i(Object(b.a)(t,n)),n&&!n.url){const r=function(t,e){return[{name:p.a.CorrelationId,value:t.correlationId},{name:p.a.ContextId,value:t.contextId},{name:p.a.ActionStack,value:t.stack},{name:"hasViewId",value:!0},{name:"entityName",value:e}]}(h,n.entityName);if(!Object(s.v)(g,t,e)){i(Object(u.b)(n.entityName,o.a.MAIN_APPLICATION_VIEW));const a=Object(c.a)(g,n.entityName,o.a.SUB_GRID),s=Object(c.c)(g,a),p=Object(_.c)(g,S.Xc),m=!p||function(t,e){var n,r,a;if(!(null===(r=null===(n=null==e?void 0:e.grid)||void 0===n?void 0:n.rows)||void 0===r?void 0:r.length)||!(null===(a=t.metadata)||void 0===a?void 0:a.entities))return!0;const i=e.grid.rows[0].cells;if(!(null==i?void 0:i.length))return!0;for(let e=0;e<i.length;e++)if(i[e].relatedEntityName&&!t.metadata.entities[i[e].relatedEntityName])return!1;return!0}(g,s);return s&&s.initialized===v.a.Initialized&&m?(P(i,g,a,n.entityName,t,e,n.relationshipName,d,h,n.ordinal).catch(t=>{d.EventManager.ReportComponentFailure(I,t,null,f)}),d.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid",r),Promise.resolve(a)):i(Object(u.a)(n.entityName,o.a.SUB_GRID)).then(a=>{let s=Promise.resolve();if(p){const e=Object(O.a)(g,a,t);s=i(Object(C.e)(e))}return s.then(()=>{const s=l();return P(i,s,a,n.entityName,t,e,n.relationshipName,d,h,n.ordinal).catch(t=>{d.EventManager.ReportComponentFailure(I,t,null,f)}),d.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid",r),a})},t=>{d.EventManager.ReportComponentFailure(I,t,null,f)})}}return Promise.resolve(null)},getFailureParameters:(t,e)=>i}}},mhYf:function(t,e,n){"use strict";n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return p}));var r=n("dHD5"),a=n("i1f0"),i=n("TYIz"),s=n("+zjj"),o=n("wL2W"),c=n("4aOd"),l=n("pEXn"),u=n("tWr6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d="tab.visible";function p(t,e,n,p){return{type:"tab.visible.sync",sync:!0,execute({dispatch:h,getState:g},m){var b;const f=g();h(function(t,e,n,a){const i=Object(r.v)(n);return{type:d,payload:a,meta:{pageId:t,tabId:e,contextKey:i}}}(t,e,n,p));const y=Object(a.wc)(f,{id:t},n),v=Object(s.e)(f,{id:t},n);if(y||(null==v?void 0:v.isSelected)||!p){if(y===e&&!p){const r=Object(a.fb)(f,{id:t},n);let s=!1;if(r){const o=Object(a.m)(f,r);for(const r of o)if(r.Id!==e&&Object(a.Kc)(f,r.Id,t,n)){s=!0,h(Object(i.b)(t,r.Id,n));break}}s||h(Object(i.b)(t,void 0,n))}}else h(Object(i.b)(t,e,n));if(Object(o.a)()){const r=g(),i=null===(b=null==m?void 0:m.TraceManager)||void 0===b?void 0:b.getTracer(`${l.k}${l.r}`),s=Object(a.Kc)(f,e,t,n),o=Object(a.Kc)(r,e,t,n),d=Object(u.a)(r,t);d.push({name:"tabId",value:e}),d.push({name:"tabName",value:Object(a.Ic)(r,e,t,n)}),d.push({name:"tabLabel",value:Object(a.Hc)(r,e,t,n)}),d.push({name:"visible state before change",value:null==s?void 0:s.toString()}),d.push({name:"visible state after change",value:null==o?void 0:o.toString()}),d.push({name:"callstack",value:new c.a(new Error).getStackTrace()}),null==i||i.warn(l.n,[{name:l.v,value:l.r+".visible"},{name:l.r,value:JSON.stringify(d)}])}}}}},mlKL:function(t,e,n){"use strict";n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return p}));var r=n("arV0"),a=n("jRy5"),i=n("dHD5"),s=n("ApeL"),o=n("i1f0"),c=n("mIxf"),l=n("bT7G"),u=n("WPtp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d="attribute.requiredLevel";function p(t,e,n,p){return{type:"attribute.requiredLevel.validation",sync:!0,execute(h,g){const m=h.getState();if(p!==Object(o.pc)(m,t,e,n)){h.dispatch(function(t,e,n,r){if(e&&e.contextTokenType&&e.contextTokenType===a.a.GridRow)return Object(s.f)(t,e,n,r);const o=Object(i.x)(e);return{type:d,payload:r,meta:{pageId:t,contextKey:o,dataFieldName:n}}}(t,e,n,p));const g=Object(o.ac)(m,t,e),b=Object(l.b)(m,g);if((0===p||3===p)&&b&&b.activeChanges&&b.activeChanges[n]||e&&e.contextTokenType&&e.contextTokenType===a.a.GridRow){let s=null,d=null,p=null,b=null;if(e&&e.contextTokenType&&e.contextTokenType===a.a.GridRow)s=e.entityTypeName?e.entityTypeName:null,d=e.recordId?e.recordId:null,p=Object(i.t)(e),b=Object(i.r)(e);else{const n=Object(r.g)(m,t);s=n&&n.entityTypeName?n.entityTypeName:null,d=n&&n.id?n.id:null,p=null,b=e}const f=Object(l.d)(m,g,{etn:s,id:d},n);if(Object(o.Uc)(f)){const e={[n]:{fieldName:n,value:f?f.formatted?f:Object(u.e)(f):f}};h.dispatch(Object(c.a)(t,e,!0,!0,s,d?d.guid:null,p,b))}}}}}}},nIfK:function(t,e,n){"use strict";n.d(e,"a",(function(){return N})),n.d(e,"e",(function(){return D})),n.d(e,"d",(function(){return L})),n.d(e,"b",(function(){return R})),n.d(e,"c",(function(){return M}));var r=n("Yx7Y"),a=n("SAYH"),i=n("vNXc"),s=n("9fGf"),o=n("Z/4N"),c=n("P6DH"),l=n("p/2N"),u=n("iZ7K"),d=n("sn0j"),p=n("y60j"),h=n("BJ7u"),g=n("JwRZ"),m=n("504W"),b=n("IqkD"),f=n("CB5L"),y=n("odYE"),v=n("i1f0"),_=n("bT7G"),S=n("00VO"),O=n("YGjz"),C=n("LbMF"),I=n("BFlg"),P=n("Lyxw"),j=n("3/02"),T=n("jAuy"),E=n("/Zy9"),F=n("arV0"),w=n("z+5+"),x=n("d0w6"),A=n("AF/G");const N=["MscrmControls.Grid.ReadOnlyGrid","MscrmControls.Grid.GridControl","MscrmControls.SharepointAssociatedGrid.SharepointControl","MscrmControls.MailApp.MailAppListControl"],k=["Opportunity_ActivityPointers"];function D(t){const e=t&&t.control&&t.control.Parameters&&t.control.Parameters.hasOwnProperty(I.r)&&t.control.Parameters[I.r],n=[t.viewId,e,t.recordsPerPage,(r=t,r&&r.controlParameters&&r.controlParameters.ChartDrillDownParameters&&r.controlParameters.ChartDrillDownParameters.length>0)];var r;return t.customQueryStateKeyParts&&n.push(...t.customQueryStateKeyParts),n.join("")}function M(t,e,n,r,a){const s=R(t,e,n,r,a);return e=>{const n=s(e);return n&&n.getQueryState(n instanceof i.a?void 0:t)}}function R(t,e,n,r,o){const l={};return u=>{const d=new a.a(u.viewId),p=Object(c.qb)(t(),d,e);if(!p)return null;const h=function(t,e,n){let r=e.fetchXML,a=null;const i="TeamTemplateId";if(e.entityLogicalName===O.a&&t.controlParameters[i]){const e=t.controlParameters[i];if(r&&r.indexOf(e)<0){const t=n?n.guid:"",i=Object(S.a)(r,e,t);r=i.updatedFetchXml,a=i.filterString}}return{fetchXML:r,filterString:a}}(u,p,r);let I=h.fetchXML;if(!I&&p.queryApi)return null;if(Object(T.l)(t())&&u.quickFindViewId){const n=new a.a(u.quickFindViewId),r=a.a.isNullOrEmpty(n)?null:Object(c.qb)(t(),n,e);Object(m.a)(r)||(I=function(t,e){const n=new DOMParser;if(t){const r=n.parseFromString(t.fetchXML,"text/xml"),a=n.parseFromString(e.fetchXML,"text/xml"),i=r.getElementsByTagName("filter");for(let t=0;t<i.length;t++)i[t].attributes&&i[t].attributes.getNamedItem("isquickfindfields")&&a.getElementsByTagName("entity")[0].appendChild(i[t]);return(new XMLSerializer).serializeToString(a)}return e.fetchXML}(r,p))}const N=t(),D=u.entityLogicalName,M=u.getCustomFilter&&u.getCustomFilter(),R=function(t,e,n,r,i){const s=i.controlParameters.RelationshipName;if(s){let o=r,l=null,u=null;if(i.controlParameters.DependentAttributeName){u=i.controlParameters.DependentAttributeName;l=u.split(".")[1]||u}if(i.controlParameters.IsDataSetLookup&&(o=null==i.controlParameters.ParentRecordId?a.a.EMPTY:new a.a(i.controlParameters.ParentRecordId),i.controlParameters.DependentAttributeName)){u=i.controlParameters.DependentAttributeName;l=u.split(".")[1]||u}const d=Object(v.ac)(t,e,i.contextToken),p=new y.a(n,o);let h=null,g=!1;Object(C.a)(t,n,l)?h=Object(_.d)(t,d,p,l):i.controlParameters.DependentAttributeType&&(g=i.controlParameters.DependentAttributeType===n&&i.controlParameters.DependentAttributeType!==i.entityLogicalName);const m=h;m&&m.reference?o=m.reference.id:!i.controlParameters.IsDataSetLookup&&null===l||null!==m&&null!==m.reference||!p||null===p.id||g||(o=null);const b=Object(c.kb)(t,e,i.contextToken);let S=0,O=f.h.None;return b?(S=1,-1===k.indexOf(s)&&(O=f.h.Related)):(i.controlParameters.ShouldApplyContextFilter&&i.controlParameters.IsDataSetLookup||!i.controlParameters.IsDataSetLookup)&&(S=2),{type:S,rollupType:O,entityReference:p,contextId:o,relationshipName:s}}return null}(N,e,o||n&&n.EntityLogicalName,r,u),V=Object(g.p)(t(),D),B=function(t,e,n,r,i,s,o){var l;const u=Object(F.g)(t,s),d=!(!(null==u?void 0:u.pageToEditedViewMapId)||!Object(c.rb)(t,u.pageToEditedViewMapId.guid,o.guid)),p=Object(c.qb)(t,o,s),h=e.hasGrid&&(1===e.gridType||void 0===e.gridType&&a.a.equals(null===(l=e.control)||void 0===l?void 0:l.ClassId,A.E));return Object(w.e)(t)&&(h||Object(w.f)(t))&&!(1===(null==n?void 0:n.type))&&!(2===(null==n?void 0:n.type))&&!(r&&r.linkEntities&&Array.isArray(r.linkEntities)&&r.linkEntities.length>0)&&!i&&!(r&&r.filter&&Array.isArray(r.filter)&&r.filter.length>0)&&!d&&(null==p?void 0:p.queryType)!==x.a.QUICKFIND_SEARCH&&!e.quickFindViewId}(N,u,R,M,V,e,d)?E.a.fromView(d,u.quickFindSearchString):i.a.fromXmlAndSql(I,p.offlineSqlQuery,d,u.quickFindSearchString,D,t);(null==h?void 0:h.filterString)&&r&&B.addExistingContextFilterToKey(a.a.toString(r),h.filterString);const G=Object(c.x)(t(),e,u.contextToken);G&&(B.pageNumber=G);const X=L(t(),e,n,u,p,D);X.length&&B.select(...X);const U=function(t,e,n,r,a,i){let o=null;if(!Object(P.a)(t,j.ub)||!i.hasGrid||1!==i.gridType)return null;const l=Object(c.j)(r)(t,e,i.contextToken),u=Object(s.b)(t),d=l&&l.CustomControls&&l.CustomControls[u]&&l.CustomControls[u].Parameters;if(!Object(c.vb)(d)&&(o=Object(c.o)(t,n),o)){const t=[],e=a&&a.grid&&a.grid.rows&&a.grid.rows[0]&&a.grid.rows[0].cells;if(e)for(const n in e)e.hasOwnProperty(n)&&t.push(e[n].name);-1!==t.indexOf(o.lookupAttribute)&&(o.lookupAttribute=null),a&&a.fetchXML&&Object(T.b)(a.fetchXML)&&(o.primaryAttribute=null)}return o}(t(),e,D,d,p,u);U&&(U.lookupAttribute&&B.select(U.lookupAttribute),U.primaryAttribute&&B.addChildCountAttribute(U.primaryAttribute));const q=u.getCustomSorting&&u.getCustomSorting(p,l);if(q)for(const t of q)B.orderBy(t.name,1===t.sortDirection);if(R)switch(R.type){case 1:B.applyRollupContextFilter(R.entityReference,R.rollupType);break;case 2:const t=Object(c.v)(N,e,u.contextToken);B.applyContextFilter(R.relationshipName,R.contextId,N,t?t.relationshipRoleOrdinal:void 0)}if(V&&B.where(V),M&&M.filter)if(Array.isArray(M.filter)){const t=M.filter;for(const e of t)B.where(e,e.shouldReplace)}else{const t=M.filter;!function(t){return!!(t&&t.operator&&t.terms)}(t)?B.where(Object(g.n)(M.filter,null)):B.where(t,t.shouldReplace)}if(M&&M.linkEntities)for(const t of M.linkEntities)B.addLinkedEntity(t,t.attributes||[]);const z=u.recordsPerPage;if(z)B.pageSize=z;else{const e=Object(b.h)(t());u.hasChart||Object(m.a)(e)?B instanceof i.a&&B.setDefaultPageSize():B.pageSize=e}return B}}function L(t,e,n,r,a,i){const s=[...V(t,n,r,a.viewId),...B(t,r,i,a.viewId),...G(t,n,r,i),...X(t,r,i),...U(t,e,r,i),...r.getCustomColumns?r.getCustomColumns():[]];if(s.length){const t=[],e=[],n=a&&a.grid&&a.grid.rows&&a.grid.rows[0]&&a.grid.rows[0].cells;if(n)for(const t in n)n.hasOwnProperty(t)&&e.push(n[t].name);for(const n in s){const r=s[n];-1===e.indexOf(r)&&-1===t.indexOf(r)&&t.push(r)}return t}return s}function V(t,e,n,r){if(0!==n.gridType)return[];let a="Grid";const i=Object(s.b)(t),u=e&&Object(o.a)(n.control,e,i);return u&&(a=Object(c.ab)(t,u.CustomControlId)),Object(l.b)(t,n.control.UniqueId,a,e&&e.Id,null,null,r)||[]}function B(t,e,n,r){return 1!==e.gridType?[]:Object(l.a)(t,n,r)||[]}function G(t,e,n,r){const a=[],i=Object(u.h)(t,r);return i&&(function(t,e,n){const r=Object(s.b)(t),a=e&&Object(o.a)(n.control,e,r);return a&&[a.CustomControlId&&a.Name].some(t=>-1!==N.indexOf(t))}(t,e,n)||n.hasGrid)&&("activitypointer"===r&&a.push("activitytypecode"),i.PrimaryNameAttribute&&a.push(i.PrimaryNameAttribute),Object(c.vb)(n.controlParameters)||i.PrimaryImageAttribute&&a.push(Object(T.a)(i.PrimaryImageAttribute))),a}function X(t,e,n){const r=[];if(4&e.streamMode){r.push("modifiedon");const e=Object(C.d)(t,n);if(e)for(const a in e){const i=e[a];i.IsSortableEnabled&&"image"!==i.Type&&"multiselectpicklist"!==i.Type&&Object(d.b)(t,n,i.LogicalName,i)&&r.push(i.LogicalName)}}else 2&e.streamMode&&r.push("modifiedon");return r}function U(t,e,n,i){const s=[],o=n.cardFormId;if(o)if("activitypointer"===i)s.push(...d.a);else{const n=a.a.equals(o,r.a)?Object(p.h)(t,i,Object(h.a)(11)):o,c=Object(p.d)(t,n,e);if(c)for(const t in c){const e=c[t];e.DataFieldName&&s.push(e.DataFieldName)}}return s}},nexV:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("Kvn0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(t,e){const n={displayState:t};return{type:r.c,payload:n}}},ojtV:function(t,e,n){"use strict";n.d(e,"a",(function(){return y})),n.d(e,"b",(function(){return v}));var r=n("dHD5"),a=n("BFlg"),i=n("dQnL"),s=n("KBcj"),o=n("SAYH"),c=n("P6DH"),l=n("CngE"),u=n("iZ7K"),d=n("qwRa"),p=n("WK+4"),h=n("BzGi"),g=n("EY5k"),m=n("GEBM"),b=n("69Qu"),f=n("LAGg");const y="chart.showChart.update";function v(t,e,n){return{type:"chart.showChart.update.async",execute({dispatch:y,getState:v},S){const O=S.TraceManager.getTracer(a.z),C=a.x+".updateShowChartAction";try{O.info("Updating the show chart"),e||(e=Object(r.k)(v(),t));const a=v(),I=Object(r.v)(e),P=Object(c.T)(a,t,e),j=Object(s.c)(a,P),T=j&&j.entityLogicalName;let E=Object(c.r)(a,t,e,T),F=Object(c.s)(a,t,e);const w=Object(l.a)(a,E),x=w&&w.PrimaryEntityTypeCode,A=x&&Object(u.m)(a,parseInt(x,10));T&&A&&T!==A&&(E=null,F=h.a.savedvisualization);const N=Object(l.i)(a,T);if(E&&N&&N.chartTypes&&Object.keys(N.chartTypes).length>0){const t=o.a.toString(E);F=t in N.chartTypes[h.a[h.a.savedvisualization]]?h.a.savedvisualization:h.a.uservisualization}if(!n)return y(_(t,I,n)),S.EventManager.ReportComponentSuccess(C),Promise.resolve();if(!Object(b.b)(v()))return Promise.resolve();return y(Object(g.e)(m.A)).then(()=>{y(Object(i.a)(T,F,E)).then(n=>o.a.isNullOrEmpty(n)?(F=h.a.uservisualization,y(Object(d.b)(t,e,F)).then(()=>y(Object(i.a)(T,F,E)).then(t=>Promise.resolve(t)))):Promise.resolve(n)).then(r=>{const a=o.a.toString(r);Promise.all([y(Object(p.b)(t,e,a)),y(Object(d.b)(t,e,F)),y(_(t,I,n))]).then(()=>(S.EventManager.ReportComponentSuccess(C),y(Object(f.b)(t,e)),Promise.resolve()))})}).catch(t=>(S.EventManager.ReportComponentFailure(C,Error("Retrieve resource strings for chart failed")),Promise.reject(t))),Promise.resolve()}catch(t){const e="Update the show chart failed with error : "+t.message;S.EventManager.ReportComponentFailure(C,Error(e))}}}}function _(t,e,n){return{type:y,payload:{name:"showChart",value:n},meta:{pageId:t,dataSetContextKey:e}}}},pp6D:function(t,e,n){"use strict";n.d(e,"b",(function(){return N})),n.d(e,"a",(function(){return A})),n.d(e,"c",(function(){return D})),n.d(e,"e",(function(){return M})),n.d(e,"d",(function(){return R}));var r=n("2yvP"),a=n("jRy5"),i=n("IaGr"),s=n("9ksH"),o=n("tpZ5"),c=n("G0J3"),l=n("COKI"),u=n("uOtn"),d=n("OtHk"),p=n("SAYH"),h=n("Zw8F"),g=n("pnQK"),m=n("0nOn"),b=n("+baL");let f;class y extends h.a{constructor(t,e,n,r){super(t,e,n,r),this._dashboardId=t,f=n,this._clientApiExecutor=new m.a(n,"ClientApi.XrmDashboardSelectorItem.",r)}_getEventParams(){return this._commonEventParams||(this._commonEventParams=[{name:"dashboardId",value:p.a.toString(this._dashboardId),isRequired:!1,isEventParam:!0}])}get isBoundDashboard(){return this._clientApiExecutor.execute("isBoundDashboard_get",()=>{const t=Object(g.a)(f.getState(),this._dashboardId);return!t||1032==+t.Type},this._getEventParams())}get isUserDashboard(){return this._clientApiExecutor.execute("isUserDashboard_get",()=>{const t=Object(g.a)(f.getState(),this._dashboardId);return Object(g.c)(t)},this._getEventParams())}navigate(){this._clientApiExecutor.executeAsync("navigate",()=>f.dispatch(Object(b.a)(null,this._dashboardId,null,null,null,null,this.getPageId())),this._getEventParams())}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class v extends u.b{constructor(t,e,n,r,a){let i=d.c;if(r){const e=t.getState(),a=Object(d.g)(e,r);a&&a[n.guid]&&(i=d.g)}super(t,e,n,r,a,i,y)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class _ extends l.a{constructor(t,e,n,r,a,i){super(t,e,n,r,a,i,v)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let S;class O extends c.a{constructor(t,e,n,r,a,i){super(t,e&&e.etn,r,a,()=>_,n),S=t,this._getCommands=i,this._apiExecutor=new m.a(t,"ClientApi.XrmDashboard.",a,r)}get commands(){return this._apiExecutor.execute("commands_get",()=>this._commands||(this._commands=this._getCommands(S,this.contextToken,this.pageId)))}}var C=n("HAeo"),I=n("zgeC"),P=n("ywwS"),j=n("ghNp"),T=n("i1f0"),E=n("qshH"),F=n("E7fB"),w=n("16wZ"),x=n("T6Zt");function A(t,e,n,r){return k((n,a)=>new O(n,a,new s.b(n,e),t,e,r),"clientapi.create.xrmdashboard","ClientApi.XrmCommandObjectFactory.createXrmDashboard",t,e,n,!1)}function N(t,e,n,r){return k((n,r)=>new o.a(n,r,new s.b(n,e),t,e),"clientapi.create.xrmform","ClientApi.XrmCommandObjectFactory.createXrmForm",t,e,n,!0,r)}function k(t,e,n,a,s,o,c,l){return{type:e,sync:!0,execute(e,u){Object(w.g)(a,n,"contextToken"),Object(w.g)(s,n,"pageId"),c&&Object(w.g)(o,n,"entityTypeName");try{let n=e.dispatch(Object(j.b)(s,a));if(!n){n=t(e,{etn:o,id:l}),n.applicationContext=u;const i=new F.a(e,s);if(n.context=i,!a.parentContextToken){const t=u.ClientApiManager.getClientApiEntry(s);Object(r.b)("form.initialization",()=>{t.xrmInstance.Page=n}),t.primaryContextToken=a}}return n}catch(t){const e=E.a.getInstance().getEventParameters(a);throw e.push({name:"entityTypeName",value:o}),i.a.getInstance().eventManager.ReportComponentFailure(n,t,null,e),t}}}}function D(t,e,n,r,s){const o="ClientApi.XrmCommandObjectFactory.createXrmGrid";return{type:"clientapi.create.xrmgrid",sync:!0,execute(c,l){Object(w.g)(t,o,"contextToken"),Object(w.g)(e,o,"pageId");try{let u=c.dispatch(Object(j.c)(e,t));if(!u){if(3===r){const a=Object(T.s)(c.getState(),{id:e,controlName:s},t.parentContextToken);if(a){const r=c.dispatch(Object(j.b)(e,t.parentContextToken));return new I.a(c,t.parentContextToken,e,s,n,r,a,l)}const u=E.a.getInstance().getEventParameters(t);u.push({name:"controlName",value:s}),u.push({name:"gridType",value:r}),i.a.getInstance().eventManager.ReportComponentFailure(o,new Error("Control descriptor could not be found for subgrid control"),null,u)}if(u=new C.a(c,t,e,n,r,!1,l,s),!t.parentContextToken&&t.contextTokenType===a.a.MainGrid){l.ClientApiManager.getClientApiEntry(e).primaryContextToken=t}}return u}catch(e){const n=E.a.getInstance().getEventParameters(t);throw n.push({name:"controlName",value:s}),n.push({name:"gridType",value:r}),i.a.getInstance().eventManager.ReportComponentFailure(o,e,null,n),e}}}}function M(t,e,n,r){const a="ClientApi.XrmCommandObjectFactory.registerNewControl";return{type:"clientapi.create.xrmTimeline",sync:!0,execute(s,o){Object(w.g)(t,a,"contextToken"),Object(w.g)(e,a,"pageId"),Object(w.g)(n,a,"controlName"),Object(w.g)(r,a,"controlId");try{const c=s.dispatch(Object(j.b)(e,t.parentContextToken));let l=null;switch(n){case"notescontrol":if(l=s.dispatch(Object(j.f)(e,t)),!l){const a=Object(T.s)(s.getState(),{id:e,controlName:n},t.parentContextToken);l=new P.a(s,t.parentContextToken,e,a,n,r,c,o)}break;default:const u=E.a.getInstance().getEventParameters(t);u.push({name:"controlName",value:n}),i.a.getInstance().eventManager.ReportComponentFailure(a,new Error("Failed to create and return the control"),null,u)}return l}catch(e){const r=E.a.getInstance().getEventParameters(t);throw r.push({name:"controlName",value:n}),i.a.getInstance().eventManager.ReportComponentFailure(a,e,null,r),e}}}}function R(t,e){const n="ClientApi.XrmCommandObjectFactory.createXrmKBSearch";return{type:"clientapi.create.xrmkbsearch",sync:!0,execute(r,a){Object(w.g)(t,n,"contextToken"),Object(w.g)(e,n,"pageId");try{let n=r.dispatch(Object(j.g)(e,t));if(!n&&(n=new x.a(r,t,e),!t.parentContextToken)){const r=a.ClientApiManager.getClientApiEntry(e);r.xrmInstance.Page=n,r.primaryContextToken=t}return n}catch(e){const r=E.a.getInstance().getEventParameters(t);throw i.a.getInstance().eventManager.ReportComponentFailure(n,e,null,r),e}}}}},qwRa:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s}));var r=n("dHD5"),a=n("BFlg");const i="chart.visualizationtype.update";function s(t,e,n){return{type:"chart.visualizationtype.update.async",execute({dispatch:s,getState:o},c){const l=c.TraceManager.getTracer(a.z),u=a.x+".updateVisualizationTypeAction";try{l.info("Update the chart visualization type"),e||(e=Object(r.k)(o(),t));const a=Object(r.v)(e);return s(function(t,e,n){return{type:i,payload:{name:"chartVisualizationType",value:n},meta:{pageId:t,dataSetContextKey:e}}}(t,a,n)),c.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(t){const e="Update the chart visualization type failed with error : "+t.message;c.EventManager.ReportComponentFailure(u,Error(e))}}}}},"r/aD":function(t,e,n){"use strict";n.d(e,"d",(function(){return u})),n.d(e,"c",(function(){return d})),n.d(e,"a",(function(){return p})),n.d(e,"b",(function(){return h}));var r=n("i1f0"),a=n("arV0"),i=n("PUjk"),s=n("IaGr"),o=n("2Ct/"),c=n("odYE"),l=n("g6bs");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(t,e,n,i=!1){if(!t)return s.a.getInstance().traceManager.getTracer(n).error("isXrmProcessControlClientApiSupportedOnForm invoked with unexpected null state object"),!1;if(!e)return s.a.getInstance().traceManager.getTracer(n).error("isXrmProcessControlClientApiSupportedOnForm invoked with unexpected null pageId object"),!1;const u=function(t,e){const n=Object(a.g)(t,e);if(!n)return null;const{entityTypeName:r,id:i}=n;return new c.a(r,i)}(t,e),d=!Object(r.Kb)(t,e)&&(Object(o.d)(t)||!Object(o.g)(t))&&(i||!Object(l.d)(t,u,e)),p=g(e,t);return p.push({name:"xrmProcessControlClientApiIsSupported",value:d}),s.a.getInstance().eventManager.ReportComponentSuccess(n,p),d}function d(t,e,n,r){if(!t&&(s.a.getInstance().traceManager.getTracer(r).error("getProcessManagerWithJitInitIfNeeded invoked with unexpected null processManager",g(n,e.getState())),u(e.getState(),n,r))){s.a.getInstance().traceManager.getTracer(r).error("getProcessManagerWithJitInitIfNeeded invoking JIT initialization of process manager",g(n,e.getState()));const t=Object(a.g)(e.getState(),n);return Object(i.b)(n,t)}return t}function p(t,e,n,r){return[{name:"pageId",value:t},{name:"formType",value:Object(a.l)(e,t)},{name:"InitialXrmProcessControlIsNotNull",value:n},{name:"XrmEntityIsNotNull",value:r}]}function h(t,e,n){return[{name:"pageId",value:t},{name:"formType",value:Object(a.l)(e,t)},{name:"getProcessManagerInvoked",value:n}]}function g(t,e){return[{name:"pageId",value:t},{name:"formType",value:Object(a.l)(e,t)}]}},rdSB:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return c})),n.d(e,"d",(function(){return l}));var r=n("SAYH"),a=n("OWbt"),i=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="businessProcessFlow.attributes.add",o="businessProcessFlow.controls.add";function c(t,e,n){const r=Object(i.v)(t);return{type:s,payload:{attributes:d(n)},meta:{pageId:e,contextKey:r}}}function l(t,e,n){const r=Object(i.v)(t);return{type:o,payload:{controls:u(n)},meta:{pageId:e,contextKey:r}}}function u(t){const e={};t&&!t.header_process&&(t.header_process={Id:null,Label:null,Name:"header_process",ShowLabel:!1,Visible:!0,Disabled:!1,DataFieldName:null,UniqueId:null,ClassId:r.a.tryParse("06E9F7AF-1F54-4681-8EEC-1E21A1CEB465")});for(const n in t){const r=Object(a.f)(t[n],null,!0);r&&(e[n]=r)}return e}function d(t){const e={};for(const n in t){const r=t[n],a={Precision:r.Precision,PrecisionSource:r.PrecisionSource,RequiredLevel:r.RequiredLevel,Format:r.Format,OptionSet:r.OptionSet,IsValidForCreate:r.IsValidForCreate,IsValidForUpdate:r.IsValidForUpdate,Targets:r.Targets};e[r.LogicalName]=a}return e}},rs6x:function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));var r=n("SAYH"),a=n("arV0"),i=n("ruPX"),s=n("kX6F"),o=n("Nb1E"),c=n("odYE"),l=n("iZ7K"),u=n("504W"),d=n("lEFU"),p=n("IqkD"),h=n("69Qu"),g=n("i1f0"),m=n("E8F2");function b(t,e,n,c){const b=[{name:"formId",value:t},{name:"pageName",value:n}];return{type:"form.change",execute({dispatch:y,getState:v},_,S){const O=v();if(Object(g.Eb)(O,e))return Promise.reject(Object(m.b)(O,e,2200000016));const{entityTypeName:C,id:I,recordSetQueryKey:P,data:j,createFromRelationship:T,initWithEntity:E}=Object(a.g)(O,e);b.push({name:"entityTypeName",value:C});const F=r.a.tryParse(t),w={entityTypeName:C,formId:F,id:c?r.a.tryParse(c):I,recordSetQueryKey:P,data:j,createFromRelationship:T,initWithEntity:E},x=F.guid.toString(),A=`<MRUForm><Form Type="Main" Id="${x}" /></MRUForm>`,N=Object(d.c)(O,C);return y(Object(i.a)(n,w,e,{replaceState:!0})).then(t=>{var e,n;if(0===t.status)if(Object(h.b)(v()))null==N||N===r.a.EMPTY?function(t,e,n,a,i,c,d,h){const g=Object(l.p)(a,t),m=Object(p.q)(a),b="?$select=userentityuisettingsid&$filter=objecttypecode eq {0} and _ownerid_value eq '{1}'&$top=1",y=String.format(b,g.toString(),m.guid.toString());i(Object(o.e)("userentityuisettings",y)).then(p=>{p.value&&p.value.length>0&&(n=p.value[0].userentityuisettingsid?new r.a(p.value[0].userentityuisettingsid):r.a.EMPTY),Object(u.a)(n)||Object(u.a)(c)||Object(u.a)(t)||0===t.length||r.a.isNullOrEmpty(n)?null!=n&&n!==r.a.EMPTY||function(t,e,n,a,i,c,d){let p=r.a.EMPTY;const h=Object(l.p)(n,t),g="userentityuisettings";a(Object(o.b)(g,{objecttypecode:h,lastviewedformxml:e})).then(e=>{if(p=e,!(Object(u.a)(p)||Object(u.a)(i)||Object(u.a)(t)||0===t.length||r.a.isNullOrEmpty(p))){const e=d.TraceManager.getTracer("Forms.FormSelectorChange"),n="Created an entry for selected form successfully formid : "+i;e.info(n),a(Object(s.b)(t,i,p))}}).catch(e=>{if(-2147093999===e.errorCode)return Object(u.a)(i)||Object(u.a)(t)||0===t.length||a(Object(s.b)(t,i,p)),{};const n=[{name:"CorrelationId",value:c.correlationId},{name:"ContextId",value:c.contextId},{name:"ActionStack",value:c.stack},{name:"entityName",value:t},{name:"reason",value:e&&e.message?e.message:JSON.stringify(e)}],r="Catch block of ChangeForm.oDataCreate, for formid: "+i;d.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(r),void 0,n),d.TraceManager.getTracer("Forms.FormSelectorChange").error(r,n)})}(t,e,a,i,c,d,h):f(t,e,n,a,i,c,d,h)}).catch(e=>{if(-2147093999===e.errorCode)return Object(u.a)(c)||Object(u.a)(t)||0===t.length||i(Object(s.b)(t,c,n)),{};const r=[{name:"CorrelationId",value:d.correlationId},{name:"ContextId",value:d.contextId},{name:"ActionStack",value:d.stack},{name:"entityName",value:t},{name:"reason",value:e&&e.message?e.message:JSON.stringify(e)}],a="Catch block of ChangeForm.oDataRetrieve, for formid: "+c;h.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(a),void 0,r),h.TraceManager.getTracer("Forms.FormSelectorChange").error(a,r)})}(C,A,N,v(),y,F,S,_):f(C,A,N,v(),y,F,S,_);else{Object(u.a)(F)||Object(u.a)(C)||0===C.length||y(Object(s.b)(C,F,N));const t=null===(e=null==_?void 0:_.TraceManager)||void 0===e?void 0:e.getTracer("Forms.FormSelectorChange"),n="Selected form did not save in the UserEntityUiSetting table, for formid: "+F;null==t||t.info(n)}else if(1===t.status){const t=null===(n=null==_?void 0:_.TraceManager)||void 0===n?void 0:n.getTracer("Forms.FormSelectorChange"),e=`Could not change to form with id ${x} due to a navigation failure or because navigation was cancelled`;null==t||t.info(e,b)}return t})},getFailureParameters:(t,e)=>b}}function f(t,e,n,a,i,l,d,p){const h=new c.a("userentityuisettings",n);i(Object(o.f)(h,{lastviewedformxml:e})).then(()=>{if(!(Object(u.a)(n)||Object(u.a)(l)||Object(u.a)(t)||0===t.length||r.a.isNullOrEmpty(n))){const e=p.TraceManager.getTracer("Forms.FormSelectorChange"),r="Updated selected form successfully to : "+l;e.info(r),i(Object(s.b)(t,l,n))}}).catch(e=>{if(-2147093999===e.errorCode)return Object(u.a)(l)||Object(u.a)(t)||0===t.length||i(Object(s.b)(t,l,n)),{};const r=[{name:"CorrelationId",value:d.correlationId},{name:"ContextId",value:d.contextId},{name:"ActionStack",value:d.stack},{name:"entityName",value:t},{name:"reason",value:e&&e.message?e.message:JSON.stringify(e)}],a="Catch block of ChangeForm.oDataUpdate, for formid: "+l;p.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(a),void 0,r),p.TraceManager.getTracer("Forms.FormSelectorChange").error(a,r)})}},"s+OO":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return o}));var r=n("dHD5"),a=n("BFlg");const i="chart.filterexpression.update",s="ChartFilterExpression";function o(t,e,n){return{type:"chart.filterexpression.update.async",execute({dispatch:o,getState:c},l){const u=l.TraceManager.getTracer(a.z),d=a.x+".updateFilterExpressionAction";try{u.info("Updating the chart filter expression"),e||(e=Object(r.k)(c(),t));const a=Object(r.v)(e);return o(function(t,e,n){return{type:i,payload:{name:s,value:n},meta:{pageId:t,dataSetContextKey:e}}}(t,a,n)),l.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(t){const e="Updatation of the chart filter expression failed with error : "+t.message;l.EventManager.ReportComponentFailure(d,Error(e))}}}}},sn0j:function(t,e,n){"use strict";n.d(e,"c",(function(){return p})),n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return h}));var r=n("SAYH"),a=n("Lohl"),i=n("y60j"),s=n("LbMF"),o=n("FZDd"),c=n("3hnk"),l=n("j6Db"),u=n("qLnS");const d=["activitytypecode","prioritycode","scheduledend","subject","description","regardingobjectid","ownerid","createdon","statecode","modifiedon"];function p(t,e,n){return{type:"formandattribute.retrieve.async",execute({dispatch:c,getState:u},p){const m="Card"===n;return t.etn&&"activitypointer"===t.etn&&m?c(Object(o.f)("activitypointer",!1,d)).then(()=>{const e=u(),n={};for(const r of d){const a=Object(s.a)(e,t.etn,r);a&&h(e,t.etn,r,a)&&(n[r]=a)}return g(e,t.etn,n,Object(s.d)(e,t.etn)),{formDescriptor:null,attributeDescriptors:n}}):c(Object(a.b)(t,e,n)).then(a=>{const d={};let b=null;return t.etn?c(Object(o.f)(t.etn,!0,[])).then(()=>{const e=u();if(!r.a.isNullOrEmpty(a)&&(b=Object(i.j)(e,a),b&&b.Attributes))for(const n in b.Attributes){const r=b.Attributes[n],a=Object(s.a)(e,t.etn,r);a&&h(e,t.etn,r,a)&&(d[r]=a)}return m&&g(e,t.etn,d,Object(s.d)(e,t.etn)),{formDescriptor:b,attributeDescriptors:d}}):(p.EventManager.ReportComponentSuccess("Form.CustomControl.retrieveFormWithAttributes",[{name:"APIName",value:l.a+".Actions.RetrieveFormWithAttributesAction"},{name:"formId",value:r.a.toString(e)},{name:"formType",value:n}]),null)},t=>{const a=t.get_message();p.EventManager.ReportComponentFailure("Form.CustomControl.retrieveFormWithAttributes",new Error(a),a,[{name:"APIName",value:l.a+".Actions.RetrieveFormWithAttributesAction"},{name:"formId",value:r.a.toString(e)},{name:"formType",value:n}])})}}}function h(t,e,n,r){return Object(c.f)(t,e,n,u.a.CanRead)&&r&&r.IsValidForRead}function g(t,e,n,r){if(r)for(const a in r){const i=r[a];!i.IsSortableEnabled&&"modifiedon"!==i.LogicalName||n[a]||!h(t,e,i.LogicalName,i)||"image"===i.Type||"multiselectpicklist"===i.Type||(n[a]=i)}}},sxfa:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("WRDA"),a=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i{constructor(t){this.path=t}get path(){return this._traversedPath}set path(t){for(this._traversedPath=Object(r.a)(t);this._traversedPath&&this._traversedPath.indexOf("}")>0;)this._traversedPath=Object(r.a)(this._traversedPath)}static getCandidateTraversedPathFromStagStep(t,e){e=Object(r.a)(e);let n=!1;if(!t||t.length)return null;for(let a=0;a<t.length;a++){const i=Object(r.a)(t[a].get_stageId());if("".concat(i,","),e===i){n=!0;break}}return n?"".substring(0,"".length-2):null}isInTraversedPath(t){return!Object(a.b)(t)&&this._traversedPath.indexOf(Object(r.a)(t))>-1}}},tpZ5:function(t,e,n){"use strict";n.d(e,"a",(function(){return I}));var r=n("0nOn"),a=n("OQLa"),i=n("arV0"),s=n("UqyN"),o=n("L8zx"),c=n("ZIjf"),l=n("3yqi"),u=n("EOIL"),d=n("i1f0"),p=n("Bo7t"),h=n("Tg1Y"),g=n("16wZ"),m=n("qshH");let b;class f extends u.a{constructor(t,e,n,r,a,i){super(t,e,n,r,a,i),b=t}getDefaultNextPageName(){const t="ClientApi.XrmNavigableFormUi.getDefaultNextPageName";try{c.a.instance.reportCall(t);const e=Object(d.M)(b.getState(),this.pageId,this.contextToken);return c.a.instance.reportSuccess(t),e}catch(e){const n=m.a.getInstance().getEventParameters(this.contextToken);throw m.a.getInstance().reportFailure(t,e,null,n),e}}movePrevious(){const t="ClientApi.XrmNavigableFormUi.movePrevious";try{c.a.instance.reportCall(t),b.dispatch(Object(h.b)(this.pageId,this.contextToken)),c.a.instance.reportSuccess(t)}catch(e){const n=m.a.getInstance().getEventParameters(this.contextToken);throw m.a.getInstance().reportFailure(t,e,null,n),e}}moveTo(t){const e="ClientApi.XrmNavigableFormUi.moveTo";let n;try{if(c.a.instance.reportCall(e),t&&this.tabs){const e=Object(d.Gc)(b.getState(),this.pageId,t,this.contextToken);n=this.tabs.get(null==e?void 0:e.Name),n&&b.dispatch(Object(p.b)(this.pageId,this.contextToken,null==e?void 0:e.Id))}c.a.instance.reportSuccess(e)}catch(t){const n=m.a.getInstance().getEventParameters(this.contextToken);throw m.a.getInstance().reportFailure(e,t,null,n),t}n||Object(g.h)(e,"pageName",t)}get taskProcess(){return c.a.instance.reportUsage("ClientApi.XrmNavigableFormUi.taskProcess"),this}}var y=n("SAYH"),v=n("n6Qt"),_=n("deGN"),S=n("G0J3"),O=n("504W");let C;class I extends S.a{constructor(t,e,n,a,i){super(t,e&&e.etn,a,i,t=>10===t||12===t?f:u.a,n);const s=[{name:"pageId",value:i,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];this._clientApiExecutorForm=new r.a(t,"ClientApi.XrmForm.",i,a,s),C=t,this._entityReference=e}get applicationContext(){return this._applicationContext}set applicationContext(t){this._applicationContext=t}get context(){try{return c.a.instance.reportCall("ClientApi.XrmForm.context"),c.a.instance.reportSuccess("ClientApi.XrmForm.context"),this._globalContext}catch(t){throw this._reportFailure("ClientApi.XrmForm.context",t)}}set context(t){this._globalContext=t}get entityReference(){return this._clientApiExecutorForm.execute("entityReference_get",()=>({id:y.a.externalGuid(this._entityReference.id),entityType:this._entityReference.etn}))}get data(){try{if(c.a.instance.reportCall("ClientApi.XrmForm.data"),!this._data){let t;const e=Object(i.l)(C.getState(),this.pageId);e!==l.a.Dialog&&e!==l.a.ModalDialog&&this._entityReference&&(t=new s.a(C,this.contextToken,this.pageId,this,this._entityReference.etn,this._entityReference.id,P,this._applicationContext)),this._data=new o.a(C,this.contextToken,this.pageId,this,t)}return c.a.instance.reportSuccess("ClientApi.XrmForm.data"),this._data}catch(t){throw this._reportFailure("ClientApi.XrmForm.data",t)}}getAttribute(t){return this._clientApiExecutorForm.execute("getAttribute",()=>{var e,n;let r=null;return this.data&&this.data.entity&&(r=this.data.entity.attributes.get(t)),r?Object(O.a)(t)&&(r=r.concat(this.data.attributes.get(t))):r=null===(n=null===(e=this.data)||void 0===e?void 0:e.attributes)||void 0===n?void 0:n.get(t),r})}getUrl(t){try{c.a.instance.reportCall("ClientApi.XrmForm.getUrl");let e=null,n=null;if(this.contextToken.parentContextToken){const t=this.data.entity.getEntityReference(),r={entityTypeName:t.entityType,etn:t.name,id:y.a.fromExternalGuid(t.id)};e=l.a.EditForm,n=r}else e=Object(i.l)(C.getState(),this.pageId),n=Object(i.g)(C.getState(),this.pageId);switch(e){case l.a.EditForm:{const t=new v.a(C,this.applicationContext,this.context,this.pageId);n={entityTypeName:n.entityTypeName,etn:n.etn,id:n.id,entityTypeCode:t.getEntityCode(n.entityTypeName),languageId:this._globalContext.userSettings.languageId,recordSetQueryKey:n.recordSetQueryKey};break}case l.a.Grid:{const t=new v.a(C,this.applicationContext,this.context,this.pageId);n={entityTypeName:n.entityTypeName,pageType:n.pageType,entityTypeCode:t.getEntityCode(n.entityTypeName)};break}}let r=null;if(1===t)r=C.dispatch(Object(a.a)(e,n));else{const t=Object(_.a)(C,this.pageId);r=C.dispatch(Object(a.c)(t,e,n))}return c.a.instance.reportSuccess("ClientApi.XrmForm.getUrl"),r}catch(t){throw this._reportFailure("ClientApi.XrmForm.getUrl",t)}}_reportFailure(t,e){const n=m.a.getInstance().getEventParameters(this.contextToken);return n.push({name:"entityName",value:this._entityReference.etn}),m.a.getInstance().reportFailure(t,e,null,n),e}}function P(t,e,n){const r=Object(d.bb)(C.getState(),n,e);return r||t.TraceManager.getTracer("ClientApi.XrmForm.getAttributeNames").error("Form attributes was null"),r}},tvJg:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="attribute.options.clear";function i(t,e,n){const i=Object(r.x)(e);return{type:a,payload:void 0,meta:{pageId:t,contextKey:i,dataFieldName:n}}}},uOtn:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return l}));var r=n("Sbn7"),a=n("Zw8F"),i=n("y60j"),s=n("SAYH"),o=n("0nOn");let c;class l{constructor(t,e,n,r,s,l=i.n,u=a.a){this._formId=n,c=t,this._entityName=r,this._pageId=s,this._getSelectorItems=l,this._selectorItemType=u,this._clientApiExecutor=new o.a(t,"ClientApi.XrmControlFormSelector.",s,e)}get items(){return this._clientApiExecutor.execute("items_get",t=>{if(!this._items){this._items=new r.a(t);const e=this._getSelectorItems(c.getState(),this._entityName);if(e)for(const t in e){const n=e[t],r=n.name||n.DisplayName,a=new this._selectorItemType(new s.a(t),r,c,this._pageId);this._items.add(a.getId(),a)}}return this._items})}getCurrentItem(){return this._clientApiExecutor.execute("getCurrentItem",()=>{const t=this.items;for(let e=0;e<t.getLength();e++){const n=t.get(e);if(n.getId()===s.a.toString(this._formId))return n}return null})}}class u extends l{}},"uPT+":function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a}));const r="powerbi.signedin.state";function a(t,e){return{type:r,payload:e,meta:{pageId:t}}}},ujVH:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return d}));var r=n("dHD5"),a=n("BFlg"),i=n("P6DH"),s=n("3hnk"),o=n("kWiz"),c=n("WePp"),l=n("qLnS");const u="dataset.dependentoptionset.column.status";function d(t,e){const n=[];return{type:"dependentoptionset.column.status",sync:!0,execute({dispatch:s,getState:l},d,m){const b=d.TraceManager.getTracer(a.z),f=a.x+".SetDependentOptionSetColumnStatusAction";d.TraceManager.setLogLevel(o.a.Info,f);try{const a=Object(r.v)(e),o=l();let y=null;const v=Object(i.Q)(l(),t,e),_={};if(v)y=v;else{const n=Object(i.S)(l(),{id:t},e);n&&n.entityLogicalName&&(y=n.entityLogicalName)}if(y){n.push({name:"CorrelationId",value:m.correlationId},{name:"ContextId",value:m.contextId},{name:"ActionStack",value:m.stack},{name:"PageId",value:t},{name:"EntityTypeName",value:y}),b.info("Executing initialize dependent option set column status action in grid.",n);const r={name:"NumPartialDependentOptionSetChainAttributesInGrid",value:0},a=[];let s=0;const l=Object(i.z)(o,e,y,t);for(const n in l){const i=l[n];if(null===i.ParentPicklistLogicalName){const i={name:n,value:0};p(o,e,t,y,l,n,i)?h(l,n,_,r):(g(l,n,_),s++,a.push(i))}else void 0===l[i.ParentPicklistLogicalName]&&h(l,n,_,r)}const u={name:"NumCompleteDependentOptionSetChainsInGrid",value:s},v={name:"CompleteChainsMaxDepthInGrid",value:a};n.push(u,r,v);const S=new c.a(f);S.addEventParameter("NumCompleteDependentOptionSetChainsInGrid",s),S.addEventParameter("NumPartialDependentOptionSetChainAttributesInGrid",r.value),S.addEventParameter("CompleteChainsMaxDepthInGrid",a),d.EventManager.ReportEvent(S),d.EventManager.ReportComponentSuccess(f),b.info("Executed initialize dependent option set column status action successfully.",n)}Object.keys(_).length>0&&s(function(t,e,n){return{type:u,payload:n,meta:{pageId:t,dataSetContextKey:e}}}(t,a,_))}catch(t){const e="creating dependent option set column status node in state tree failed.";d.EventManager.ReportComponentFailure(f,Error(e))}}}}function p(t,e,n,r,a,i,o){if(void 0===a[i])return!0;if(function(t,e,n,r,a){if(!Object(s.f)(t,a,r,l.a.CanUpdate)||!n[r].IsValidForUpdate)return!0;return!1}(t,0,a,i,r))return!0;const c=a[i].ChildPicklistLogicalNames;if(null!==c)for(let s=0;s<c.length;s++){const l={name:i,value:0};if(p(t,e,n,r,a,c[s],l))return!0;o.value=Math.max(o.value,l.value)}return o.value=o.value+1,!1}function h(t,e,n,r){if(void 0===t[e])return;n[e]=0,r.value=r.value+1;const a=t[e].ChildPicklistLogicalNames;if(a)for(let e=0;e<a.length;e++)h(t,a[e],n,r)}function g(t,e,n){n[e]=1;const r=t[e].ChildPicklistLogicalNames;if(r)for(let e=0;e<r.length;e++)g(t,r[e],n)}},wFY3:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="polite",a="assertive"},wZxB:function(t,e,n){"use strict";n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return p}));var r=n("4r2D"),a=n("SAYH"),i=n("iZ7K"),s=n("FZDd"),o=n("pEXn"),c=n("Nb1E"),l=n("fU7K");const u=o.b.AdvancedFindLookupResolverParameters;function d(t,e,n){const c=[];return{type:"advancedFind.lookup.retrieve.async",execute({dispatch:l,getState:d},p,g){const m=new r.a(a.a.newGuid().guid,g&&g.isPreloadCall);c.push({name:o.b.ActionType,value:"advancedFind.lookup.retrieve.async"},{name:o.b.ClientRequestId,value:m.RequestId()},{name:u.PrimaryEntity,value:t},{name:u.Targets,value:e.join(",")});const b=e.reduce((t,e)=>Object.assign(Object.assign({},t),{[e]:[]}),{});return l(Object(s.e)(b)).then(()=>{const t=function(t,e,n,r){return(a,s)=>{const o=Object(i.h)(n,s);if(!o||!o.EntityLogicalName||!o.PrimaryNameAttribute)return r.push({name:u.EntityMetadataUnavailable,value:s}),a;const c=`<fetch version="1.0" mapping="logical" no-lock="false"><entity name="${o.EntityLogicalName}"><attribute name="${o.PrimaryNameAttribute}"/><attribute name="${o.PrimaryIdAttribute}"/><order attribute="${o.PrimaryNameAttribute}" descending="false" /><filter type="or"><condition attribute="${o.PrimaryNameAttribute}" operator="like" value="%${e||""}%" /></filter></entity></fetch>`,l=h(t,o,c,r);return a.push(l),a}}(l,n,d(),c),r=e.reduce(t,[]);return Promise.all(r).then(t=>Promise.resolve([].concat(...t)))})},getSuccessParameters:()=>c,getFailureParameters:(t,e)=>c}}function p(t,e,n){const c=[];return{type:"advancedFind.lookup.retrieve.by.id.async",execute({dispatch:l,getState:d},p,g){const m=new r.a(a.a.newGuid().guid,g&&g.isPreloadCall);c.push({name:o.b.ActionType,value:"advancedFind.lookup.retrieve.async"},{name:o.b.ClientRequestId,value:m.RequestId()},{name:u.PrimaryEntity,value:t},{name:u.Targets,value:e.join(",")});const b=e.reduce((t,e)=>Object.assign(Object.assign({},t),{[e]:[]}),{});return l(Object(s.e)(b)).then(()=>{const t=function(t,e,n,r){return(a,s)=>{const o=Object(i.h)(n,s);if(!o||!o.EntityLogicalName||!o.PrimaryNameAttribute)return r.push({name:u.EntityMetadataUnavailable,value:s}),a;const c=e.filter(t=>!!t).map(t=>`<condition attribute="${o.PrimaryIdAttribute}" operator="eq" value="${t}" />`),l=`<fetch version="1.0" mapping="logical" no-lock="false"><entity name="${o.EntityLogicalName}"><attribute name="${o.PrimaryNameAttribute}"/><attribute name="${o.PrimaryIdAttribute}"/><order attribute="${o.PrimaryNameAttribute}" descending="false" /><filter type="or">${c}</filter></entity></fetch>`,d=h(t,o,l,r);return a.push(d),a}}(l,n,d(),c),r=e.reduce(t,[]);return Promise.all(r).then(t=>Promise.resolve([].concat(...t)))})},getSuccessParameters:()=>c,getFailureParameters:(t,e)=>c}}function h(t,e,n,r){const a="?fetchXml="+Object(l.CrmUrlEncode)(n);return new Promise((n,i)=>{t(Object(c.e)(e.EntityLogicalName,a,100)).then(t=>{const a=function(t,e){const n=[];e.value&&e.value.length>0&&e.value.forEach(e=>{n.push({id:e[t.PrimaryIdAttribute],displayName:e[t.PrimaryNameAttribute],entityLogicalName:(null==t?void 0:t.EntityLogicalName)||void 0,entityDisplayName:(null==t?void 0:t.DisplayName)||void 0})});return n}(e,t);r.push({name:u.RetrieveRequestSuccess,value:`Retrieve Seccuess for ${e.EntityLogicalName} Count: ${a.length}`}),n(a)},t=>{r.push({name:u.RetrieveRequestFail,value:`Failed to retrieve records for ${e.EntityLogicalName} Error: ${t}`}),n([])})})}},waMg:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="grid.updatequerykey";function i(t,e,n){const i=Object(r.y)(n),s=Object(r.v)(n);return{type:a,payload:t,meta:{pageId:e,contextKey:i,dataSetContextKey:s}}}},xorU:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"f",(function(){return c})),n.d(e,"b",(function(){return s})),n.d(e,"e",(function(){return l}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="controls.addCustomFilter",i="controls.startCustomFilter",s="controls.endCustomFilter";function o(t,e,n,i,s){const o=Object(r.v)(i);return{type:a,payload:{customFilter:s,entityLogicalName:n},meta:{pageId:t,controlName:e,contextKey:o}}}function c(t,e,n){const a=Object(r.v)(n);return{type:i,payload:{},meta:{pageId:t,controlName:e,contextKey:a}}}function l(t,e,n){const a=Object(r.v)(n);return{type:s,payload:{},meta:{pageId:t,controlName:e,contextKey:a}}}},yl9a:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="control.setSrc";function i(t,e,n,i){const s=Object(r.v)(n);return{type:a,payload:{Url:i,isCustomSrc:!0},meta:{pageId:t,controlName:e,contextKey:s}}}},ywwS:function(t,e,n){"use strict";n.d(e,"a",(function(){return _}));var r=n("0nOn"),a=n("P6DH"),i=n("HcnX"),s=n("AbXy"),o=n("FETf"),c=n("LE5i"),l=n("16wZ"),u=n("NAAR"),d=n("qshH"),p=n("HAeo"),h=n("ghNp"),g=n("dHD5"),m=n("ZIjf"),b=n("FZDd"),f=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const y="ClientApi.XrmControlTimeline.";let v;class _ extends i.a{constructor(t,e,n,a,i,s,o,c){super(t,e,n,a,i,o),this._defaultLabel=u.u.Timeline,v=t,this._applicationContext=c,this._controlId=s,this._traceManager=c.TraceManager,this._subgridToken=Object(g.p)(e,i),this._clientApiExecutorTimeline=new r.a(t,y,n,e),this._clientApiExecutorTimeline.addEventParameter({name:"controlName",value:i,isEventParam:!0,expectedDataType:"string"}),this._clientApiExecutorTimeline.addEventParameter({name:"controlId",value:s,isEventParam:!0,expectedDataType:"string"}),this._gridControl=new p.a(t,this._subgridToken,n,!1,3,!0,c,i),t.dispatch(Object(h.a)(this,n,this._subgridToken))}getControlType(){return m.a.instance.reportUsage(y+"getControlType"),"timelinewall"}getName(){return this.clientApiExecutor.execute("getName",()=>this.controlDescriptor&&this.controlDescriptor.Parameters&&this.controlDescriptor.Parameters[u.s.UClientUniqueName]?this.controlDescriptor.Parameters[u.s.UClientUniqueName]:u.u.Timeline)}getLabel(){const t=y+"getLabel";try{m.a.instance.reportCall(t);const e=this.controlDescriptor&&this.controlDescriptor.Parameters&&!Object(l.a)(this.controlDescriptor.Parameters[u.s.Label])?this.controlDescriptor.Parameters[u.s.Label]:this._defaultLabel?this._defaultLabel:"";return m.a.instance.reportSuccess(t),e}catch(e){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(t,e,null,n),e}}setLabel(t){const e=y+"setLabel";try{m.a.instance.reportCall(e),super.setLabel(t),this.controlDescriptor&&this.controlDescriptor.Parameters?this.controlDescriptor.Parameters[u.s.Label]=t:this._defaultLabel=t,m.a.instance.reportSuccess(e)}catch(t){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,n),t}}openEmail(t){const e=y+"openEmail";try{m.a.instance.reportCall(e),v.dispatch(Object(o.t)(this._controlId,t)),v.dispatch(Object(o.o)(this._controlId,c.a.ContextualDialogEntity,2,f.a.toString(f.a.newGuid()))),m.a.instance.reportSuccess(e)}catch(t){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,n),t}}refresh(t){let e=y+"refresh";t&&t.modules&&(e+="-modules"),t&&t.activities&&(e+="-activities");try{m.a.instance.reportCall(e),t&&this.controlDescriptor&&this.controlDescriptor.Parameters&&(t.modules&&(this.controlDescriptor.Parameters[u.s.UClientModules]=t.modules),t.activities&&(this.controlDescriptor.Parameters[u.s.UClientActivities]=t.activities)),v.dispatch(Object(o.o)(this._controlId,c.a.InitiateRefresh,1,f.a.toString(f.a.newGuid()))),m.a.instance.reportSuccess(e)}catch(t){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,n),t}}setTargetEntity(t,e,n=!0){const r=y+"setTargetEntity";try{m.a.instance.reportCall(r);const a={etn:t,id:e,isAPI:!0},i={};return i[t]=[],v.dispatch(Object(o.v)(this._controlId,a)),v.dispatch(Object(b.e)(i)).catch(e=>{const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),n.push({name:"entityName",value:t}),d.a.getInstance().reportFailure(r+"-retrieveEntities",e,null,n),e}).then(()=>{n&&v.dispatch(Object(o.o)(this._controlId,c.a.InitiateRefresh,1,f.a.toString(f.a.newGuid()))),m.a.instance.reportSuccess(r)})}catch(t){const e=d.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(r,t,null,e),t}}getGrid(){const t=y+"getGrid";try{return m.a.instance.reportCall(t),this._grid||(this._grid=new s.a(v,this._applicationContext,this._subgridToken,this.pageId,this.getEntityName(),!1,this.name)),m.a.instance.reportSuccess(t),this._grid}catch(e){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(t,e,null,n),e}}getRecordSetQueryKey(){return this.clientApiExecutor.execute("getRecordSetQueryKey",()=>Object(a.cb)(v.getState(),this._subgridToken,{id:this.pageId}))}getGridType(){return m.a.instance.reportUsage(y+"getGridType"),3}getRollupType(){return this.clientApiExecutor.execute("getRollupType",()=>Object(a.eb)(v.getState(),this.pageId,this.contextToken))}getParentForm(){const t=y+"getParentForm";try{m.a.instance.reportCall(t);const e=this._gridControl.getParentForm();return m.a.instance.reportSuccess(t),e}catch(e){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(t,e,null,n),e}}refreshRibbon(){const t=y+"refreshRibbon";try{m.a.instance.reportCall(t),this._gridControl.refreshRibbon(),m.a.instance.reportSuccess(t)}catch(e){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(t,e,null,n),e}}getEntityName(){return m.a.instance.reportUsage(y+"getEntityName"),"activitypointer"}getUrl(){const t=d.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer("ClientApi.XrmControlTimeline.getUrl").warn("Not Supported in Timeline control",t),m.a.instance.reportUsage("ClientApi.XrmControlTimeline.getUrl"),""}getFilterXml(){const t=y+"getFilterXml",e=d.a.getInstance().getEventParameters(this.contextToken);return e.push({name:"controlName",value:this.getName()}),e.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",e),m.a.instance.reportUsage(t),""}getFetchXml(){const t=y+"getFetchXml",e=d.a.getInstance().getEventParameters(this.contextToken);return e.push({name:"controlName",value:this.getName()}),e.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",e),m.a.instance.reportUsage(t),""}getViewSelector(){const t=y+"getViewSelector",e=d.a.getInstance().getEventParameters(this.contextToken);return e.push({name:"controlName",value:this.getName()}),e.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",e),m.a.instance.reportUsage(t),null}getTeamTemplateId(){return null}getRelationship(){const t=y+"getRelationship",e=d.a.getInstance().getEventParameters(this.contextToken);return e.push({name:"controlName",value:this.getName()}),e.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",e),m.a.instance.reportUsage(t),null}setFilterXml(t){const e=y+"setFilterXml",n=d.a.getInstance().getEventParameters(this.contextToken);n.push({name:"controlName",value:this.getName()}),n.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",n),m.a.instance.reportUsage(e)}addOnLoad(t){const e=d.a.getInstance().getEventParameters(this.contextToken);e.push({name:"controlName",value:this.getName()}),e.push({name:"validationError",value:"true"}),this._traceManager.getTracer("ClientApi.XrmControlTimeline.addOnLoad").warn("Not Supported in Timeline control",e),m.a.instance.reportUsage("ClientApi.XrmControlTimeline.addOnLoad")}removeOnLoad(t){const e=y+"removeOnLoad",n=d.a.getInstance().getEventParameters(this.contextToken);n.push({name:"controlName",value:this.getName()}),n.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",n),m.a.instance.reportUsage(e)}openRelatedGrid(){const t=y+"openRelatedGrid",e=d.a.getInstance().getEventParameters(this.contextToken);e.push({name:"controlName",value:this.getName()}),e.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",e),m.a.instance.reportUsage(t)}}},z5LE:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return o}));var r=n("jRy5"),a=n("dHD5"),i=n("ApeL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="attribute.notification.update";function o(t,e,n,o,c){return{type:"attribute.notification.add.clear.form.notification",sync:!0,execute(t,l){t.dispatch(function(t,e,n,o){if(o&&o.contextTokenType&&o.contextTokenType===r.a.GridRow)return Object(i.d)(t,o,e,n);const c=Object(a.x)(o);return{type:s,payload:n,meta:{pageId:t,contextKey:c,dataFieldName:e}}}(e,n,o,c))}}}},z8iZ:function(t,e,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(t){return{Title:t&&t.Title||null,Legend:t&&t.Legend||null,Area3DStyle:t&&t.Area3DStyle||null,AreaGradientStyle:t&&t.AreaGradientStyle||null,XAxes:t&&t.XAxes||null,YAxes:t&&t.YAxes||null,SeriesList:t&&t.SeriesList||null,SubTitle:t&&t.SubTitle||null,Colors:t&&t.Colors||null,DisplayMode:t&&t.DisplayMode||0,ErrorInformation:t&&t.ErrorInformation||null,EnableDrilldown:t&&t.EnableDrilldown||!0,Annotations:t&&t.Annotations||null}}n.d(e,"a",(function(){return r}))},zFtG:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s}));var r=n("dHD5"),a=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="dataset.update.pagingdata";function s(t,e,n){return{type:"dataset.update.pagingdata.async",execute({dispatch:s,getState:o},c){const l=c.TraceManager.getTracer(a.z),u=a.x+".updatePagingDataAction";try{return l.info("Updating the paging data for the grid."),s(function(t,e,n){const a=Object(r.y)(e),s=Object(r.v)(e);return{type:i,payload:n,meta:{pageId:t,contextKey:a,dataSetContextKey:s}}}(t,e,n)),c.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(t){const e="Updation of paging data for the grid failed with error : "+t.message;c.EventManager.ReportComponentFailure(u,Error(e))}}}}},zgeC:function(t,e,n){"use strict";n.d(e,"a",(function(){return _}));var r=n("0nOn"),a=n("P6DH"),i=n("SAYH"),s=n("HcnX"),o=n("1kth"),c=n("dHD5"),l=n("meVR"),u=n("qshH"),d=n("+zjj"),p=n("w92Z"),h=n("whN/"),g=n("HAeo"),m=n("ghNp"),b=n("ZIjf"),f=n("IaGr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const y="ClientApi.XrmControlSubGrid.";let v;class _ extends s.a{constructor(t,e,n,a,i,s,o,l){super(t,e,n,o,a,s),this._relationship=null,v=t,this._subgridToken=Object(c.p)(e,a),this._clientApiExecutorSubGrid=new r.a(t,y,n,this._subgridToken),this.clientApiExecutor.addEventParameter({name:"controlName",value:a,isEventParam:!0}),this.clientApiExecutor.addEventParameter({name:"isEditable",value:i,isEventParam:!0}),this._gridControl=new g.a(t,this._subgridToken,n,i,3,!0,l,a),t.dispatch(Object(m.a)(this,n,this._subgridToken))}get clientApiExecutor(){return this._clientApiExecutorSubGrid}setFilterXml(t){const e=y+"setFilterXml";try{b.a.instance.reportCall(e),this._gridControl.setFilterXml(t),b.a.instance.reportSuccess(e)}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,n),t}}getFilterXml(){const t=y+"getFilterXml";try{b.a.instance.reportCall(t);const e=this._gridControl.getFilterXml();return b.a.instance.reportSuccess(t),e}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,n),e}}refresh(){const t=y+"refresh";try{b.a.instance.reportCall(t),this._gridControl.refresh(),b.a.instance.reportSuccess(t)}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,n),e}}getFetchXml(){const t=y+"getFetchXml";try{b.a.instance.reportCall(t);const e=this._gridControl.getFetchXml();return b.a.instance.reportSuccess(t),e}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,n),e}}getGrid(){const t=y+"getGrid";try{b.a.instance.reportCall(t);const e=this._gridControl.getGrid();return b.a.instance.reportSuccess(t),e}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,n),e}}getViewSelector(){const t=y+"getViewSelector";try{b.a.instance.reportCall(t);const e=this._gridControl.getViewSelector();return b.a.instance.reportSuccess(t),e}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,n),e}}getTeamTemplateId(){const t=y+"getTeamTemplateId";try{b.a.instance.reportCall(t);const e=this._gridControl.getTeamTemplateId();return b.a.instance.reportSuccess(t),e}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(t,e,null,n),e}}addOnLoad(t){this.clientApiExecutor.execute("addOnLoad",()=>{v.dispatch(Object(o.d)(this._subgridToken,this.pageId,t,this.name))},[{name:"handler",value:t,isRequired:!0,isEventParam:!1}])}removeOnLoad(t){this.clientApiExecutor.execute("removeOnLoad",()=>{v.dispatch(Object(o.y)(this._subgridToken,this.pageId,t,this.name))},[{name:"handler",value:t,isRequired:!0,isEventParam:!1}])}getEntityName(){const t=y+"getEntityName";try{b.a.instance.reportCall(t);const e=this._gridControl.getEntityName();return b.a.instance.reportSuccess(t),e}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,n),e}}getControlType(){return this.clientApiExecutor.execute("getControlType",()=>{const t=Object(p.a)(v.getState(),this.controlDescriptor,this.pageId,this.contextToken);return t?"customsubgrid:"+t.Name:"subgrid"})}getRelationship(){return this.clientApiExecutor.execute("getRelationship",(t,e)=>{var n,r;if(!this._relationship){if(null===(r=null===(n=this.controlDescriptor)||void 0===n?void 0:n.Parameters)||void 0===r?void 0:r.RelationshipName){const t=this.controlDescriptor.Parameters.RelationshipName,e=this.controlDescriptor.Parameters.RelationshipRoleOrdinal,n=this.controlDescriptor.Parameters.TargetEntityType;this._relationship=Object(g.b)(t,n),this._relationship.roleType=e}this._relationship||(this._relationship=this._gridControl.getRelationship())}return this._relationship})}getRecordSetQueryKey(){return this.clientApiExecutor.execute("getRecordSetQueryKey",()=>Object(a.cb)(v.getState(),this._subgridToken,{id:this.pageId}))}getGridType(){return b.a.instance.reportUsage(y+"getGridType"),3}getRollupType(){return this.clientApiExecutor.execute("getRollupType",()=>Object(a.eb)(v.getState(),this.pageId,this.contextToken))}openRelatedGrid(){this.clientApiExecutor.executeAsync("openRelatedGrid",(t,e)=>{const n=this.getRelationship();if(!n)return f.a.getInstance().traceManager.getTracer(t).error("Can't open related grid: the relationship was not retrieved from the inner grid.",e),Promise.resolve(i.a.EMPTY);const r=Object(d.c)(v.getState(),this.pageId);let a=null;for(let t=0;t<r.length;t++)if(r[t].relationshipName===n.name){a=r[t];break}if(!a)return e.push({name:"relationshipName",value:n.name}),f.a.getInstance().traceManager.getTracer(t).error("Can't open related grid: no relationship was found with the specified name.",e),Promise.resolve(i.a.EMPTY);const s={id:a.id,title:a.title,entityName:this.getEntityName(),relationshipName:n.name,isSelected:!0,show:a.show},o=Object(c.a)(this._subgridToken.parentContextToken,n.name,n.roleType?1===n.roleType?h.a.Referencing:h.a.AssociationEntity:void 0);return v.dispatch(Object(l.a)(this.pageId,o,s))})}refreshRibbon(){const t=y+"refreshRibbon";try{b.a.instance.reportCall(t),this._gridControl.refreshRibbon(),b.a.instance.reportSuccess(t)}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,n),e}}getUrl(){const t=y+"getUrl";try{b.a.instance.reportCall(t);const e=this._gridControl.getUrl();return b.a.instance.reportSuccess(t),e}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,n),e}}getParentForm(){const t=y+"getParentForm";try{b.a.instance.reportCall(t);const e=this._gridControl.getParentForm();return b.a.instance.reportSuccess(t),e}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,n),e}}}}}]),window.bundleExecutionMarkers["scripts/customcontrolpage.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();