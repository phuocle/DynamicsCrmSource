(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/contextualHelpBrowser.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[51,52],{Q5Tn:function(e,t,o){"use strict";o.r(t),o.d(t,"ContextualHelpBrowser",(function(){return O}));var r=o("c/eZ"),n=o("nuS9"),i=o("2Sll"),a=o("bXgA"),s=o("6S5c"),l=o("+170");async function d(e,t,o=5,r){let n;if(r)n=await fetch(r,{method:"GET"});else{const r=e.split(",");if(3!==r.length||r.some(e=>null==e)||!r[0].toLowerCase().startsWith("app:")||!r[1].toLowerCase().startsWith("entity:")||!r[2].toLowerCase().startsWith("ui:"))throw new Error("query");const i=r[0].substring(4),a=r[1].substring(7),s=r[2].substring(3);let l=encodeURIComponent(`(scopes/any(t:t eq 'D365-App-${i.toLowerCase()}') or scopes/any(t:t eq 'D365-App-*'))`);l+=a?encodeURIComponent(` and (scopes/any(t:t eq 'D365-Entity-${a.toLowerCase()}') or scopes/any(t:t eq 'D365-Entity-*'))`):encodeURIComponent(" and (scopes/any(t:t eq 'D365-Entity-*'))"),l+=s?encodeURIComponent(` and (scopes/any(t:t eq 'D365-UI-${function(e){switch(e){case"Views":return"View";case"Forms":return"Form";case"Dashboards":return"Dashboard"}}(s)}') or scopes/any(t:t eq 'D365-UI-*'))`):encodeURIComponent("and (scopes/any(t:t eq 'D365-UI-*'))"),n=await fetch(`https://docs.microsoft.com/api/Search?locale=${t.toLowerCase()}&search=*&$filter=${l}&$top=${o}`,{method:"GET"})}const i=await n.json();return{items:i.results.map(e=>({title:e.title,summary:e.description,url:e.url})),totalItemCount:i.count,continuationToken:i["@nextLink"]}}var m=o("6Iin");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const c=["crmhub","customerservice","customerservicehub","fieldservice","msdyn_cfs","msdyn_channelintegrationframeworkapp","msdyn_clientexecutiveapp","msdyn_fieldservice","msdyn_fieldservicemobile","msdyn_ocapp","msdyn_projectservice","msdyn_psahub","msdyn_resourcescheduling","msdyn_resourceschedulingoptimization","msdyn_solutionhealthhub","msdyn_timeexpense","msdynce_emailinunifiedinterface","msdynce_salesbusiness","msdynce_saleshub","msdynce_salespro","msdynce_voc","msdyncrm_marketingsmbapp","msdyncrm_surveysapp","msdyusd_usdadminsettings","msft_answersindiet","msft_permitsandlicensing","msft_stakeholdermanagement","msnfp_nonprofitaccelerator","projectservice","sales"];function p(e){return async(t,o)=>{const r=Object(m.to)(o.replace(/\-/,"_")),n=new URL(t),i=n.href.substring(n.protocol.length).substr(2),a=await fetch(`api/data/v9.0/msdyn_helppages?$filter=msdyn_path eq '${i}' and msdyn_locale eq ${r} and statecode eq 0`);if(!a.ok)throw 404===a.status?new l.b(t):401===a.status||403===a.status?new l.a(t):new l.c(t);const s=await a.json();if(0===s.value.length){const r=i.split("/"),n=r[2];if(c.indexOf(n.toLowerCase())>=0){let i,a;r.length>=5&&"entities"===r[3].toLowerCase()&&(i=r[4]),r.length>=6&&"entities"===r[3].toLowerCase()?a=r[5]:r.length>=4&&(a=r[3]);const s=await d(`app:${n},entity:${i||""},ui:${a||""}`,o);if(s.items.length<1)throw new l.b(t);const m=s.items.map(e=>`<p><a href="${e.url}" target="_blank">${e.title}</a></p>`);return`<pphml><p></p><collapsible title="${e}">${m}</collapsible></pphml>`}throw new l.b(t)}return s.value[0].msdyn_content}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */async function u(e,t,o){const r=Object(m.to)(o.replace(/\-/,"_")),n=new URL(t),i=n.href.substring(n.protocol.length).substr(2);let a="";const s=(new DOMParser).parseFromString(e,"text/html"),l=s.body&&s.body.firstElementChild,d=l&&"pphml"===l.tagName.toLowerCase()&&l.firstElementChild;d&&"h1"===d.tagName.toLowerCase()&&(a=d.textContent);const c=await fetch(`api/data/v9.0/msdyn_helppages?$filter=msdyn_path eq '${i}' and msdyn_locale eq ${r}`);if(!c.ok)throw new Error("Could not save Help page.");const p=await c.json();if(0===p.value.length){const t=await fetch("api/data/v9.0/msdyn_helppages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({msdyn_displayname:a,msdyn_path:i,msdyn_contenttype:"text/pphml",msdyn_content:e,msdyn_locale:r,statecode:0})});if(!t.ok)throw new Error(await t.text())}else{const t=p.value[0].msdyn_helppageid,o=await fetch(`api/data/v9.0/msdyn_helppages(${t})`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({msdyn_displayname:a,msdyn_path:i,msdyn_contenttype:"text/pphml",msdyn_content:e,msdyn_locale:r,statecode:0})});if(!o.ok)throw new Error(await o.text())}}var g=o("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function T(e){if(!e.pageInput)return`help://CDS/Apps/${e.appId}/Default`;switch(e.pageInput.pageType){case"entitylist":{const t=e.pageInput;return`help://CDS/Apps/${e.appId}/Entities/${t.entityTypeName}/Views/Default`}case"entityrecord":{const t=e.pageInput;return`help://CDS/Apps/${e.appId}/Entities/${t.entityTypeName}/Forms/Default`}case"dashboard":{const t=e.pageInput;return t.etn?`help://CDS/Apps/${e.appId}/Entities/${t.etn}/Dashboards/${t.dashboardId?g.a.toString(t.dashboardId):"Default"}`:`help://CDS/Apps/${e.appId}/Dashboards/${t.dashboardId?g.a.toString(t.dashboardId):"Default"}`}default:return`help://CDS/Apps/${e.appId}/Default`}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const b={subComponentStyles:{panel:{content:{paddingBottom:0}},backButton:{},backMenuItem:{},discardButton:{},documentForbiddenErrorMessage:{},documentNotFoundErrorMessage:{},documentResolutionErrorMessage:{},editMenuItem:{},editor:{},errorMessage:{},forwardMenuItem:{},homeButton:{},invalidURLErrorMessage:{},keytipLayer:{},layer:{},lpmlField:{},mediaBlockShimmer:{},navigationMenuButton:{},navigationTitle:{},panelHosted:{},refreshMenuItem:{},saveButton:{},searchBox:{root:{display:"none"}},searchResultsList:{},textBlockShimmer:{},titleShimmer:{}}};var h=o("ruPX"),F=o("u+q+"),x=o("QBtP");const y=Object(F.a)(void 0,(function(e){return{navigateTo:t=>e(Object(h.a)(t))}}))((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){const{defaultRender:t}=e,o=Object(r.__rest)(e,["defaultRender"]),i=n.useContext(x.a).Router;let a=!0;try{i.getPageMappings().getPageFromUrl(o.href)}catch(e){a=!1}return o.target&&"_top"===o.target.toLowerCase()&&a?n.createElement(t,Object.assign({},o,{onClick:t=>{t.preventDefault(),e.navigateTo(o.href)}})):n.createElement(t,Object.assign({},o))}));y.displayName="ContextualHelpBrowserLink";var k=o("SEva");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var C=o("xE5/"),f=o("3hnk"),E=o("unFF"),L=o("DL5f"),w=o("JzeI"),v=o("YxC/"),B=o("mKm/"),I=o("IqkD"),P=o("E5IU"),M=o("pF61"),_=o("arV0"),U=o("QT+q"),S=o("b8TU"),D=o("mpSO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
Object(i.a)();const $=Object(L.b)({marginRight:U.b+U.a,width:`calc(100% - ${U.b+U.a}px)`,position:"relative"}),R=Object(L.b)({marginLeft:U.b+U.a,width:`calc(100% - ${U.b+U.a}px)`,position:"relative"}),j=e=>{const{appId:t,pageInput:o,contextToURLFunc:i=T,lcid:l,close:c,onError:g,isLargeViewPort:h,isRTL:x,userCanEditHelp:C,theme:f,fallbackContentTitle:E}=e,L=Object(r.__rest)(e,["appId","pageInput","contextToURLFunc","lcid","close","onError","isLargeViewPort","isRTL","userCanEditHelp","theme","fallbackContentTitle"]),v=function(e){if(""===e)throw new Error("componentType");const t=Object(F.c)();return(o,r)=>t({type:"component.logEvent",execute(t,n){if(r&&"event"in r)throw new Error("eventArgs");const i=[{name:"event",value:o}];return r&&Object.keys(r).forEach(e=>{i.push({name:e,value:r[e]})}),n.EventManager.ReportComponentSuccess(e.toUpperCase(),i),Promise.resolve()}})}("ContextualHelpBrowser");n.useEffect(()=>(v("open"),()=>v("close")),[v]),n.useEffect(()=>{if(!h)return;const e=x?R:$;return document.body.classList.add(e),()=>document.body.classList.remove(e)},[h,x]);const B=i({appId:t,pageInput:o});return n.createElement(k.a,{name:"ContextualHelpBrowser",onError:()=>{c(),g&&g()}},n.createElement(a.a,{theme:Object(w.d)({palette:{themePrimary:f.colors.MainThemeColor.MainColor1.Fill,themeDarkAlt:f.colors.MainThemeColor.MainColor3.Fill}})},n.createElement(s.a,Object.assign({styles:b},L,{homeUrl:B,loadFunc:p(E),searchFunc:d,saveFunc:u,locale:Object(m.from)(l).replace(/_/,"-"),homeButtonProps:{onClick:()=>{v("homeButtonClick")}},backMenuItemProps:{item:{onClick:()=>{v("backMenuItemClick")}}},forwardMenuItemProps:{item:{onClick:()=>{v("forwardMenuItemClick")}}},refreshMenuItemProps:{item:{onClick:()=>{v("refreshMenuItemClick")}}},searchBoxProps:{onSearch:()=>{v("searchBoxSearch")}},saveButtonProps:{onClick:()=>{v("saveButtonClick")}},discardButtonProps:{onClick:()=>{v("discardButtonClick")}},editMenuItemProps:{item:{onClick:()=>{v("editMenuItemClick")},disabled:!C}},lpmlFieldProps:{linkAs:y},editorProps:{interactiveElements:()=>document.querySelectorAll('[data-lp-id]:not([value=""]), [data-id]:not([value=""])'),interactiveElementSelectorFunc:e=>"lpId"in e.dataset?`[data-lp-id="${e.dataset.lpId}"]`:"id"in e.dataset?`[data-id="${e.dataset.id}"]`:""},onClose:c}))))};j.displayName="ContextualHelpBrowser";const O=Object(F.a)((function(){const e=Object(v.h)();let t=null,o=null;return function(r){const n=e(r,B.ContextualHelpBrowserStrings);return n!==t&&(t=n,o=Object(B.mapStringResources)(t)),{appId:Object(P.l)(r),pageInput:Object(_.g)(r,Object(M.c)(r)),isRTL:Object(I.g)(r),isLargeViewPort:Object(S.c)(r)>D.e,userCanEditHelp:Object(f.g)(r,"msdyn_helppage",3,0),lcid:Object(I.w)(r).languageId,strings:o,theme:Object(E.a)(r),fallbackContentTitle:Object(v.b)(r,"ContextualHelpBrowser.searchResultsList.sectionHeader")}}}),(function(e){return{close(){e(Object(C.b)())}}}))(j)},"mKm/":function(e,t,o){"use strict";o.r(t),o.d(t,"ContextualHelpBrowserStrings",(function(){return a})),o.d(t,"mapStringResources",(function(){return s}));var r=o("kSoB");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n="ContextualHelpBrowser",i={headerTitle:"headerTitle",homeButtonTooltip:"homeButtonTooltip",backButtonTooltip:"backButtonTooltip",searchResultsTitle:"searchResultsTitle",refreshMenuItemText:"refreshMenuItemText",refreshMenuItemTooltip:"refreshMenuItemTooltip",backMenuItemText:"backMenuItemText",backMenuItemTooltip:"backMenuItemTooltip",forwardMenuItemText:"forwardMenuItemText",forwardMenuItemTooltip:"forwardMenuItemTooltip",invalidUrlErrorTitle:"invalidUrlErrorTitle",invalidUrlErrorDescription:"invalidUrlErrorDescription",documentForbiddenErrorTitle:"documentForbiddenErrorTitle",documentForbiddenErrorDescription:"documentForbiddenErrorDescription",documentNotFoundErrorTitle:"documentNotFoundErrorTitle",documentNotFoundErrorDescription:"documentNotFoundErrorDescription",documentResolutionErrorTitle:"documentResolutionErrorTitle",documentResolutionErrorDescription:"documentResolutionErrorDescription",unknownErrorTitle:"unknownErrorTitle",unknownErrorDescription:"unknownErrorDescription",retryButtonText:"retryButtonText",newHelpPageDefaultTitle:"newHelpPageDefaultTitle",editMenuItemText:"editMenuItemText",editMenuItemTooltip:"editMenuItemTooltip",searchBoxPlaceholder:"searchBoxPlaceholder",saveButtonText:"saveButtonText",saveButtonTooltip:"saveButtonTooltip",discardButtonText:"discardButtonText",discardButtonTooltip:"discardButtonTooltip",helpNotFoundMessage:"helpNotFoundMessage",saveFailureMessage:"saveFailureMessage",editModeAnnouncedMessage:"editModeAnnouncedMessage",relatedDocsTitle:"searchResultsList.sectionHeader",subComponentStrings:{searchResultsList:{retryFailedLoadButtonText:"searchResultsList.retryFailedLoadButtonText",subComponentStrings:{partialResultsList:{loadMoreItemsButtonText:"searchResultsList.partialResultsList.loadMoreItemsButtonText",emptyStatePrimaryMessage:"searchResultsList.partialResultsList.emptyStatePrimaryMessage",emptyStateSecondaryMessage:"searchResultsList.partialResultsList.emptyStateSecondaryMessage"}}},editor:{formatPivotItemText:"editor.formatPivotItemText",insertPivotItemText:"editor.insertPivotItemText",subComponentStrings:{formatCommandBar:{toggleBoldCommandButtonText:"editor.formatCommandBar.toggleBoldCommandButtonText",toggleItalicCommandButtonText:"editor.formatCommandBar.toggleItalicCommandButtonText",toggleUnderlineCommandButtonText:"editor.formatCommandBar.toggleUnderlineCommandButtonText",toggleStrikethroughCommandButtonText:"editor.formatCommandBar.toggleStrikethroughCommandButtonText",toggleBulletedListCommandButtonText:"editor.formatCommandBar.toggleBulletedListCommandButtonText",toggleNumberedListCommandButtonText:"editor.formatCommandBar.toggleNumberedListCommandButtonText",unlinkCommandButtonText:"editor.formatCommandBar.unlinkCommandButtonText"},insertCommandBar:{insertCollapsibleCommandButtonText:"editor.insertCommandBar.insertCollapsibleCommandButtonText",insertImageCommandButtonText:"editor.insertCommandBar.insertImageCommandButtonText",insertVideoCommandButtonText:"editor.insertCommandBar.insertVideoCommandButtonText",insertLinkCommandButtonText:"editor.insertCommandBar.insertLinkCommandButtonText",insertCoachmarkLinkCommandButtonText:"editor.insertCommandBar.insertCoachmarkLinkCommandButtonText",insertBalloonLinkCommandButtonText:"editor.insertCommandBar.insertBalloonLinkCommandButtonText"},propertyPanel:{saveButtonText:"editor.propertyPanel.saveButtonText",discardButtonText:"editor.propertyPanel.discardButtonText"},collapsiblePropertiesForm:{descriptionText:"editor.collapsiblePropertiesForm.descriptionText",collapsibleTitleFieldLabel:"editor.collapsiblePropertiesForm.collapsibleTitleFieldLabel",collapsibleIsCollapsedFieldLabel:"editor.collapsiblePropertiesForm.collapsibleIsCollapsedFieldLabel"},imagePropertiesForm:{descriptionText:"editor.imagePropertiesForm.descriptionText",imageUrlFieldLabel:"editor.imagePropertiesForm.imageUrlFieldLabel",imageUrlFieldEmptyUrlErrorMessage:"editor.imagePropertiesForm.imageUrlFieldEmptyUrlErrorMessage",imageUrlFieldInvalidUrlErrorMessage:"editor.imagePropertiesForm.imageUrlFieldInvalidUrlErrorMessage",imageTitleFieldLabel:"editor.imagePropertiesForm.imageTitleFieldLabel",imageAltTextFieldLabel:"editor.imagePropertiesForm.imageAltTextFieldLabel"},videoPropertiesForm:{descriptionText:"editor.videoPropertiesForm.descriptionText",videoUrlFieldLabel:"editor.videoPropertiesForm.videoUrlFieldLabel",videoUrlFieldEmptyUrlErrorMessage:"editor.videoPropertiesForm.videoUrlFieldEmptyUrlErrorMessage",videoUrlFieldValueIsUrlErrorMessage:"editor.videoPropertiesForm.videoUrlFieldValueIsUrlErrorMessage",videoAllowFullScreenFieldLabel:"editor.videoPropertiesForm.videoAllowFullScreenFieldLabel",videoAutoPlayFieldLabel:"editor.videoPropertiesForm.videoAutoPlayFieldLabel",videoStartTimeFieldLabel:"editor.videoPropertiesForm.videoStartTimeFieldLabel",videoStartTimeFieldSuffix:"editor.videoPropertiesForm.videoStartTimeFieldSuffix"},linkPropertiesForm:{descriptionText:"editor.linkPropertiesForm.descriptionText",externalLinkTypePivotItemLabel:"editor.linkPropertiesForm.externalLinkTypePivotItemLabel",internalLinkTypePivotItemLabel:"editor.linkPropertiesForm.internalLinkTypePivotItemLabel",linkUrlFieldLabel:"editor.linkPropertiesForm.linkUrlFieldLabel",linkUrlFieldEmptyUrlErrorMessage:"editor.linkPropertiesForm.linkUrlFieldEmptyUrlErrorMessage",linkUrlFieldInvalidUrlErrorMessage:"editor.linkPropertiesForm.linkUrlFieldInvalidUrlErrorMessage",linkTextFieldLabel:"editor.linkPropertiesForm.linkTextFieldLabel",linkTextFieldEmptyTextErrorMessage:"editor.linkPropertiesForm.linkTextFieldEmptyTextErrorMessage",linkTargetFieldLabel:"editor.linkPropertiesForm.linkTargetFieldLabel"},coachmarkLinkPropertiesForm:{descriptionText:"editor.coachmarkLinkPropertiesForm.descriptionText",linkTextFieldLabel:"editor.coachmarkLinkPropertiesForm.linkTextFieldLabel",linkTextFieldEmptyTextErrorMessage:"editor.coachmarkLinkPropertiesForm.linkTextFieldEmptyTextErrorMessage",coachmarkTargetFieldEmptyTextErrorMessage:"editor.coachmarkLinkPropertiesForm.coachmarkTargetFieldEmptyTextErrorMessage",subComponentStrings:{coachmarkTargetField:{label:"editor.coachmarkLinkPropertiesForm.coachmarkTargetField.label"}}},balloonLinkPropertiesForm:{descriptionText:"editor.balloonLinkPropertiesForm.descriptionText",linkTextFieldLabel:"editor.balloonLinkPropertiesForm.linkTextFieldLabel",linkTextFieldEmptyTextErrorMessage:"editor.balloonLinkPropertiesForm.linkTextFieldEmptyTextErrorMessage",balloonTargetFieldEmptyTextErrorMessage:"editor.balloonLinkPropertiesForm.balloonTargetFieldEmptyTextErrorMessage",balloonTitleFieldLabel:"editor.balloonLinkPropertiesForm.balloonTitleFieldLabel",balloonTitleFieldEmptyTextErrorMessage:"editor.balloonLinkPropertiesForm.balloonTitleFieldEmptyTextErrorMessage",balloonDetailsFieldLabel:"editor.balloonLinkPropertiesForm.balloonDetailsFieldLabel",balloonDetailsFieldEmptyTextErrorMessage:"editor.balloonLinkPropertiesForm.balloonDetailsFieldEmptyTextErrorMessage",subComponentStrings:{balloonTargetField:{label:"editor.balloonLinkPropertiesForm.balloonTargetField.label"}}}}}}},a=r(i).reduce((function(e,t){return this.isLeaf&&e.push(`${n}.${t}`),e}),[]);function s(e){return r(i).map((function(t){if(this.isLeaf){const o=e[`${n}.${t}`];null==o?this.remove():this.update(o)}}))}}}]),window.bundleExecutionMarkers["scripts/contextualHelpBrowser.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();