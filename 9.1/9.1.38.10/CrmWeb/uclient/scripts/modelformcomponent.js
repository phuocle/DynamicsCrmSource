(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/modelformcomponent.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[81,29],{"+Ljw":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return l}));var r=n("SAYH"),i=n("jq7Z"),a=n("arV0"),s=n("y60j");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t,n=!1){var r;const{entityTypeName:o}=Object(a.g)(e,t),c=Object(s.n)(e,o);if(!n)return c;const l=Object(i.a)(e,t),u=null===(r=null==l?void 0:l.formSelector)||void 0===r?void 0:r.forms;let d=c;if(u&&Object.keys(u).length>0){d=new Object;for(const e in c)u[e]&&!u[e].visible||(d[e]=c[e])}return d}function c(e,t,n){var o,c;const l=Object(i.a)(e,t),u=r.a.toString(n);if(null===(c=null===(o=null==l?void 0:l.formSelector)||void 0===o?void 0:o.forms)||void 0===c?void 0:c[u])return l.formSelector.forms[u].visible;const{entityTypeName:d}=Object(a.g)(e,t);return!!Object(s.m)(e,d,n)||null}function l(e,t){var n;const r=Object(i.a)(e,t);return null===(n=null==r?void 0:r.formSelector)||void 0===n?void 0:n.selectedFormId}},"+Vem":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="form.referenceinformationbyrelationship";function i(e,t){return{type:r,payload:t,meta:{pageId:e}}}},"+aj2":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n("bq0x");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="quickCreateForm.output";function a(e,t){return{type:"quickCreateForm.output.async",execute({dispatch:n,getState:a}){const s=Object(r.a)(a(),e)||[];return s.push(t),n(function(e,t){return{type:i,payload:{reason:"close",value:t},meta:{pageId:e}}}(e,s)),Promise.resolve(e)}}}},"/2of":function(e,t,n){"use strict";n.d(t,"a",(function(){return ie}));var r=n("nuS9"),i=n("nJrx"),a=n("u+q+"),s=n("i1f0"),o=n("arV0"),c=n("DOFJ"),l=n("YWpA"),u=n("H/hG"),d=n("unFF"),p=n("tJ+6"),h=n("Oyec");var g=n("dHD5"),m=n("f3SV"),b=n("3wMZ"),y=n("yji3"),f=n("UIMH"),S=n("H+1e"),v=n("Afz2"),C=n("RiHV"),O=n("ZGH+"),_=n("YxC/"),I=n("p0fx"),j=n("eOoD"),P=n("GYEz"),F=n("y60j"),T=n("WZ96"),w=n("QBtP"),E=n("O7zD"),x=n("jq7Z"),N=n("TQn4"),A=n("Z/4N"),k=n("CYtR"),M=n("SDQ8");class D extends r.Component{constructor(e){super(e),this.onMeasuring=this.onMeasuring.bind(this),this.state={columnLayout:window.innerWidth<=e.breakpointForSectionReflow?1:null,forceSmallLayout:null}}onMeasuring(e){if(e>0){const t=this._getColumnLayout(e),n=this.props.customStyle&&this.props.customStyle.paddingLeft?parseFloat(this.props.customStyle.paddingLeft.toString()):0,r=this.props.customStyle&&this.props.customStyle.paddingLeft?parseFloat(this.props.customStyle.paddingRight.toString()):0,i=e-Object(O.a)(n+r)<this.props.cellBreakPointWidthInPx;t===this.state.columnLayout&&this.state.forceSmallLayout===i||this.setState({columnLayout:t,forceSmallLayout:i});const a=[{name:"currentWidth",value:e},{name:"currentColumnLayout",value:t.toString()}];this.context.TraceManager.getTracer("Forms.Section").debug("Column layout for section",a)}}_transformStyle(){const e=null===this.state.columnLayout?{visibility:"hidden"}:null,t=this.props.pageType&&"quickcreate"===this.props.pageType?{boxShadow:"none"}:null,n=this._isSectionSidePaddingAdded()?null:{paddingLeft:"0px",paddingRight:"0px"},r=this._isSectionTopPaddingAdded()?null:{paddingTop:"0px"};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.props.sectionStyle),this.props.customStyle),e),t),n),r)}_isSectionSidePaddingAdded(){return!this.props.noSidePaddingMode||this.props.clientHostSubtype!==j.a.Phone}_isSectionTopPaddingAdded(){return(!this.props.noTopPaddingMode||1!==this.props.descriptor.Columns)&&!this._isSectionSidePaddingAdded()||this.props.clientHostSubtype!==j.a.Phone}_sectionHasSingleColumnCells(e){for(const t of e)for(const e of t.Cells)if(e.ControlName&&e.ColSpan>1)return!1;return!0}_getColumnLayout(e){return e>0&&e<this.props.breakpointForSectionReflow?1:0}_renderRowsAsColumns(e){var t,n;const i=[],a=[];for(let e=0;e<this.props.numberOfColumns;e++)i[e]=[];for(let t=0;t<e.length;t++)a[t]=[];let s=0;for(const o of e){let e=0;for(const u of o.Cells){for(;a[s][e]&&e<this.props.numberOfColumns;)e++;if(i[e]){for(let t=s;t<s+u.RowSpan;t++)a[t]||(a[t]=[]),a[t][e]=!0;const o=Object(O.a)(this.props.cellHeightInRem)*u.RowSpan,d=Object.assign(Object.assign({},this.props.cellContainerStyle),this.props.customCellContainerStyle);let p=!0;u.ControlName&&this.props.controlVisibilityByName&&-1!==Object.keys(this.props.controlVisibilityByName).indexOf(u.ControlName)&&(p=this.props.controlVisibilityByName[u.ControlName]);const h=r.createElement(l.a,{key:u.Id,style:d},r.createElement(c.a,{domId:Object(E.g)(u.DomId,this.props.id),previewId:u.PreviewId,id:this.props.id,controlName:u.ControlName,userSpacer:u.UserSpacer,rowSpan:u.RowSpan,columnSpan:1,autoExpand:u.AutoExpand,style:this.props.cellStyle,cellSizeMode:this.state.forceSmallLayout?2:0,shouldRender:this.props.shouldRender,scope:S.a.EditForm,overriddenVisibility:p,availableForPhone:u.AvailableForPhone,inDialogWithZIndex:this.props.inDialogWithZIndex,intersectionObserverHelper:this._getIntersectionObserverHelperForCell(),cellLabelPosition:null===(n=null===(t=this.props.descriptor)||void 0===t?void 0:t.CellLabel)||void 0===n?void 0:n.Position,isParentPaddingAdded:this._isSectionSidePaddingAdded()})),g=r.createElement(l.a,{style:Object.assign(Object.assign({},this.props.spacerContainerStyle),{minHeight:o.toString()+"px"})},r.createElement(l.a,{style:this.props.spacerStyle}));i[e].push(u.ControlName?h:u.UserSpacer?g:null)}e++}s++}const o=0===this.state.columnLayout?Math.floor(100/this.props.numberOfColumns)+"%":"100%",u=[];for(let e=0;e<this.props.numberOfColumns;e++){const t=e<this.props.numberOfColumns-1?{paddingRight:"1.5rem"}:{};u.push(r.createElement(l.a,{style:Object.assign(Object.assign(Object.assign({},this.props.columnStyle),{width:o}),t)},i[e]))}return r.createElement(l.a,{key:"section-columns-wrapper",style:this.props.columnsWrapperStyle},u)}_renderRowsAfterReflow(e){var t,n;const i=[];for(const a of e)for(const e of a.Cells)if(e.ControlName){let a=!0;this.props.controlVisibilityByName&&-1!==Object.keys(this.props.controlVisibilityByName).indexOf(e.ControlName)&&(a=this.props.controlVisibilityByName[e.ControlName]),i.push(r.createElement(c.a,{key:e.Id,id:this.props.id,domId:Object(E.g)(e.DomId,this.props.id),previewId:e.PreviewId,controlName:e.ControlName,rowSpan:e.RowSpan,columnSpan:e.ColSpan,autoExpand:e.AutoExpand,cellSizeMode:this.state.forceSmallLayout?2:0,shouldRender:this.props.shouldRender,style:Object.assign(Object.assign({},this.props.cellStyle),this.props.reflowCellStyle),availableForPhone:e.AvailableForPhone,overriddenVisibility:a,inDialogWithZIndex:this.props.inDialogWithZIndex,intersectionObserverHelper:this._getIntersectionObserverHelperForCell(),isParentPaddingAdded:this._isSectionSidePaddingAdded(),cellLabelPosition:null===(n=null===(t=this.props.descriptor)||void 0===t?void 0:t.CellLabel)||void 0===n?void 0:n.Position}))}return r.createElement(l.a,null,i)}_renderRowsInTable(e){var t,n;let a=[];const s=[],o=Object(O.a)(this.props.cellHeightInRem);for(const u in e){a=[];const d=e[u];for(const e of d.Cells){const s=o*e.RowSpan;let u=!0;e.ControlName&&this.props.controlVisibilityByName&&-1!==Object.keys(this.props.controlVisibilityByName).indexOf(e.ControlName)&&(u=this.props.controlVisibilityByName[e.ControlName]);const d=e.ControlName?r.createElement(c.a,{key:e.Id,id:this.props.id,domId:Object(E.g)(e.DomId,this.props.id),previewId:e.PreviewId,controlName:e.ControlName,rowSpan:e.RowSpan,columnSpan:e.ColSpan,autoExpand:e.AutoExpand,style:this.props.cellStyle,cellSizeMode:this.state.forceSmallLayout?2:0,shouldRender:this.props.shouldRender,availableForPhone:e.AvailableForPhone,overriddenVisibility:u,inDialogWithZIndex:this.props.inDialogWithZIndex,intersectionObserverHelper:this._getIntersectionObserverHelperForCell(),isParentPaddingAdded:this._isSectionSidePaddingAdded(),cellLabelPosition:null===(n=null===(t=this.props.descriptor)||void 0===t?void 0:t.CellLabel)||void 0===n?void 0:n.Position}):e.UserSpacer?r.createElement(l.a,{style:Object.assign(Object.assign({},this.props.spacerContainerStyle),{minHeight:s.toString()+"px"})},r.createElement(l.a,{style:this.props.spacerStyle})):r.createElement(l.a,{style:this.props.emptyCellStyle});e.ControlName&&void 0!==u&&!u||a.push(r.createElement(f.a,{role:v.r,style:this.props.tableCellStyle,id:Object(E.g)(Object(i.a)(),this.props.id),key:e.Id,rowSpan:e.RowSpan,colSpan:e.ColSpan},d))}s.push(r.createElement(y.a,{role:v.r,key:this.props.id+"_row_"+u},a))}return r.createElement(b.a,{role:v.r,style:this.props.tableStyle,key:this.props.id+"_table"},r.createElement(m.a,{role:v.r,key:this.props.id+"_tablebody"},s))}_renderLegend(e,t){return t&&e?r.createElement(u.a,{semanticTag:"legend",style:this._isSectionSidePaddingAdded()?this.props.legendStyle:this.props.legendNoSectionSidePaddingStyle},r.createElement(u.a,Object.assign({semanticTag:"h2",style:this.props.legendTextStyle},{[C.a.LearningPathDOMAttributeName]:"form-sectionHeader-"+this.props.sectionName},{testhooks:{id:"form-sectionHeader-"+this.props.sectionName},title:e}),e)):null}_renderHeaderFooterFields(e){return e.map(e=>{var t,n;return r.createElement(c.a,{key:e.Id,id:this.props.id,previewId:e.PreviewId,controlName:e.Name,shouldRender:this.props.shouldRender,cellSizeMode:this.state.forceSmallLayout?2:0,style:Object.assign(Object.assign({},this.props.cellStyle),this.props.headerFooterFieldCellStyle),inDialogWithZIndex:this.props.inDialogWithZIndex,intersectionObserverHelper:this._getIntersectionObserverHelperForCell(),cellLabelPosition:null===(n=null===(t=this.props.descriptor)||void 0===t?void 0:t.CellLabel)||void 0===n?void 0:n.Position})})}_renderHeaderFooterSection(){const e="headerFooterFieldSection";let t=!1;const n=(this.props.shouldRenderHeaderFields?this.props.headerFields:[]).concat(this.props.shouldRenderFooterFields?this.props.footerFields:[]);for(const e of n)if(e.Visible){t=!0;break}if(!((this.props.shouldRenderHeaderFields&&0!==this.props.headerFields.length||this.props.shouldRenderFooterFields&&0!==this.props.footerFields.length)&&t))return null;const i=this._transformStyle();return r.createElement(l.a,{onMeasuring:this.onMeasuring,isRequestedMeasuring:!0,id:e,semanticTag:"section",style:i,testhooks:{id:e,[T.b]:this.props.headerPreviewId,[T.c]:5},accessibilityLabel:"Header and Footer"},r.createElement(l.a,{key:"field-set-wrapper",style:this.props.contentStyle},null!==this.state.columnLayout&&null!==this.state.forceSmallLayout&&this._renderHeaderFooterFields(n)))}_renderContent(){let e;const{label:t}=this.props,n=this.props.descriptor,{Rows:i,ShowLabel:a}=n;return e=1===this.props.numberOfColumns||this._sectionHasSingleColumnCells(i)?this._renderRowsAsColumns(i):1===this.state.columnLayout?this._renderRowsAfterReflow(i):this._renderRowsInTable(i),r.createElement(l.a,{key:"field-set-wrapper",style:this.props.contentStyle},this._renderLegend(t,a),e)}render(){if(this.props.isHeaderOrFooterSection)return this.props.clientHostSubtype!==j.a.Phone||this.props.isHeaderSectionAvailableForPhone||this.props.isFooterSectionAvailableForPhone?this._renderHeaderFooterSection():null;const e=this.props.descriptor;if(!e)return null;if(this.props.clientHostSubtype===j.a.Phone&&null!==e.AvailableForPhone&&void 0!==e.AvailableForPhone&&!e.AvailableForPhone)return null;const{visible:t}=this.props;if(!t)return null;if(!this.props.shouldSectionRender)return null;const n=null!==this.state.columnLayout&&null!==this.state.forceSmallLayout,i=n?this._transformStyle():void 0,a=this.props.label?this.props.label:null;return r.createElement(l.a,{onMeasuring:this.onMeasuring,isRequestedMeasuring:!0,id:e.DomId,style:i,semanticTag:"section",testhooks:{id:this.props.sectionName,[T.b]:this.props.descriptor.PreviewId,[T.c]:5},accessibilityLabel:a},n&&this._renderContent())}_getIntersectionObserverHelperForCell(){return this.props.isHeaderOrFooterSection?null:this.props.intersectionObserverHelper}}function R(){let e,t;return function(n){return t!==n&&(t=n,e=function(e){if(!e)return null;let t=0;switch(e.Columns){case 1:t=1;break;case 11:t=2;break;case 111:t=3;break;case 1111:t=4}let n=0;for(const t of e.Rows){const e=t.Cells.reduce((e,t)=>e+(t.ColSpan?t.ColSpan:1),0);n=Math.max(n,e)}return Math.max(n,t)}(t)),e}}D.displayName="Section";const B=Object(a.a)((function(){const e=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e=null,t=null,n=null,r=null;return function(i,a){var s;const o=Object(d.a)(i),c=Object(p.c)(i),l=Object(p.a)(i),u=null==l?void 0:l.Colors;if(t!==o||n!==c||r!==u){t=o,n=c,r=u;const i=Object(h.a)(o);e={sectionStyle:{display:"block",backgroundColor:c?null===(s=null==u?void 0:u.Palette)||void 0===s?void 0:s.Primary01:o.colors.BaseColor.White,boxShadow:"0px 0px 9px -1px "+o.colors.BaseColor.White},contentStyle:{flex:"1 1 auto",display:"block",width:"100%"},columnsWrapperStyle:{flex:"1 1 auto",flexWrap:"wrap",flexDirection:"row"},columnStyle:{display:"block",boxSizing:"border-box"},cellContainerStyle:{display:"block",flex:"0 1 auto",width:"100%"},headerStyle:{color:o.colors.MainThemeColor.MainColor1.Fill||"#000080",fontSize:o.fontSizes.Header.Header3,fontWeight:600},tableStyle:{width:"100%",tableLayout:"fixed"},emptyCellContainerStyle:{flex:"0 1 auto",whiteSpace:"nowrap",overflow:"hidden"},emptyCellStyle:{width:"100%"},spacerContainerStyle:{flex:"0 1 auto",width:"100%",whiteSpace:"nowrap",overflow:"hidden"},spacerStyle:{width:"100%"},tableCellStyle:{height:"1px"},reflowCellStyle:{flex:"1 1 auto"},headerFooterFieldCellStyle:{flex:"1 1 auto"},legendStyle:{height:o.sizes.Measures.Measure225,lineHeight:o.sizes.Measures.Measure225,marginBottom:o.sizes.Measures.Measure025,width:"inherit"},legendNoSectionSidePaddingStyle:{height:o.sizes.Measures.Measure225,lineHeight:o.sizes.Measures.Measure225,marginBottom:o.sizes.Measures.Measure025,paddingLeft:i.paddingLeft,paddingRight:i.paddingRight,width:"auto"},legendTextStyle:{color:o.colors.BaseColor.Grey.Grey7,fontSize:o.fontSizes.Font125,fontFamily:o.fontFamilies.Regular,fontWeight:"normal",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}}}return e}}(),t=Object(s.ed)(),n=Object(s.dd)(),r=R(),i=Object(_.h)(),a=Object(s.bd)();return function(c,l){const u=Object(g.j)(c,l.id),p=Object(s.qc)(c,l,u),h=Object(s.fb)(c,l,u),m=Object(x.b)(c,l.id,u),b=h&&h.Header,y=b&&Object(E.g)(b.DomId,l.id),f=b&&b.PreviewId,S=Object(s.gd)(c,l,u),v=Object(s.tc)(c,l,u),C=Object(s.rc)(c,l,u),_=Object(o.k)(c,l),j=t(c,{id:l.id,contextToken:u}),T=n(c,{id:l.id,contextToken:u}),w=e(c,l),D=Object(N.b)(c,0),{firstControlName:R,firstControlComponentId:B,firstControlFormId:L}=function e(t,n,r,i){var a,s,o,c,l,u,d,p,h,g,m,b;const y=null===(c=null===(o=null===(s=null===(a=null==r?void 0:r.Rows)||void 0===a?void 0:a[0])||void 0===s?void 0:s.Cells)||void 0===o?void 0:o[0])||void 0===c?void 0:c.ControlName;if(Object(A.c)(t,null===(u=null===(l=null==i?void 0:i.Controls)||void 0===l?void 0:l[y])||void 0===u?void 0:u.UniqueId,null==i?void 0:i.Id)===k.d){const r=Object(M.b)(n,y),a=null===(d=Object(x.a)(t,r))||void 0===d?void 0:d.formId;if(!r||!a)return{firstControlName:y,firstControlComponentId:n,firstControlFormId:null==i?void 0:i.Id};const s=Object(F.j)(t,a),o=null===(b=null===(m=null===(g=null===(h=null===(p=null==s?void 0:s.Tabs)||void 0===p?void 0:p[0])||void 0===h?void 0:h.Columns)||void 0===g?void 0:g[0])||void 0===m?void 0:m.SectionNames)||void 0===b?void 0:b[0];return e(t,r,Object(F.t)(t,a,o),s)}return{firstControlName:y,firstControlComponentId:n,firstControlFormId:null==i?void 0:i.Id}}(c,l.id,p,h),V=Object(N.a)(c,B,L,R),z=a(c,l,u),H=Object(d.a)(c),G=r(p),W=function(e,t){if(!e||!t)return null;const n=Object(O.c)();return t*e.sizes.Section.SectionWidth-2*(t-1)*n}(H,G),U=i(c,I.a),q=Object(P.e)(c),X=Object(F.q)(c,m),Y=Object(F.p)(c,m),K=H.sizes.Section.CellBreakPointWidth;return{sectionStyle:w.sectionStyle,contentStyle:w.contentStyle,columnsWrapperStyle:w.columnsWrapperStyle,columnStyle:w.columnStyle,cellContainerStyle:w.cellContainerStyle,headerStyle:w.headerStyle,tableStyle:w.tableStyle,emptyCellContainerStyle:w.emptyCellContainerStyle,emptyCellStyle:w.emptyCellStyle,spacerContainerStyle:w.spacerContainerStyle,spacerStyle:w.spacerStyle,tableCellStyle:w.tableCellStyle,reflowCellStyle:w.reflowCellStyle,headerFooterFieldCellStyle:w.headerFooterFieldCellStyle,legendStyle:w.legendStyle,legendNoSectionSidePaddingStyle:w.legendNoSectionSidePaddingStyle,legendTextStyle:w.legendTextStyle,noSidePaddingMode:D,noTopPaddingMode:V,descriptor:p,headerDomId:y,headerPreviewId:f,shouldSectionRender:S,visible:v,mediumBreakpoint:H.sizes.Breakpoints.DimensionM,label:C,pageType:_,headerFields:j,footerFields:T,numberOfColumns:G,breakpointForSectionReflow:W,cellHeightInRem:H.sizes.Section.cellHeightInRem,clientHostSubtype:q,resourceStrings:U,controlVisibilityByName:z,isHeaderSectionAvailableForPhone:X,isFooterSectionAvailableForPhone:Y,cellBreakPointWidthInPx:K}}}))(D);D.contextType=w.a;var L=n("2YQW"),V=n("223Y"),z=n("S2mk"),H=n("IqkD");function G(e){const t=Object.assign(Object.assign({},e.referencePanelSectionStyle),e.customStyle);return e.isRTL?Object.assign(Object.assign({},t),{paddingLeft:"0rem"}):Object.assign(Object.assign({},t),{paddingRight:"0rem"})}function W(e){if(!e.visible)return null;const t=Object(z.B)("MscrmControls.Containers.ReferencePanelControl"),{DomId:n}=e.sectionDescriptor,i=isNaN(Number.parseInt(e.sectionDescriptor.Height,10))?10:Number.parseInt(e.sectionDescriptor.Height,10);return r.createElement(l.a,{id:n,style:G(e),semanticTag:"section",testhooks:{id:e.sectionName}},r.createElement(V.c,{key:"MscrmControls.Containers.ReferencePanelControl",controlId:"MscrmControls.Containers.ReferencePanelControl",id:e.id,descriptor:e.controlDescriptor,configuration:t,parentContextToken:e.contextToken,rowSpan:i}))}W.displayName="ReferencePanelSection";const U=Object(a.a)((function(){const e=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e=null,t=null;return function(n,r){const i=Object(d.a)(n);return t!==i&&(t=i,e={referencePanelSectionStyle:{display:"block",backgroundColor:i.colors.BaseColor.White,boxShadow:"0px 0px 9px -1px "+i.colors.BaseColor.White},contentStyle:{flex:"1 1 auto",display:"block",width:"100%"},spacerContainerStyle:{flex:"0 1 auto",width:"100%",whiteSpace:"nowrap",overflow:"hidden"},spacerStyle:{width:"100%"},legendStyle:{height:i.sizes.Measures.Measure225,lineHeight:i.sizes.Measures.Measure225,marginBottom:i.sizes.Measures.Measure025},legendTextStyle:{color:i.colors.BaseColor.Blue.Blue4,fontSize:i.fontSizes.Font125,fontFamily:i.fontFamilies.Regular,fontWeight:"normal",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}}),e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(),t=function(){let e,t="";return function(n,r,i){return i.Name!==t&&(e={Id:i.Name+"_control",Label:i.Label,Name:i.Name+"_control",ShowLabel:i.ShowLabel,Visible:i.Visible,Disabled:!1},t=i.Name),e}}(),n=function(){let e=null;return function(t,n){const r=Object(g.j)(t,n.id);return Object(L.e)(e,r)||(e=r),e}}();return function(r,i){const a=n(r,i),c=Object(s.qc)(r,i,a),l=t(r,i,c),u=Object(s.gd)(r,i,a),d=Object(s.tc)(r,i,a),p=Object(s.rc)(r,i,a),h=Object(o.k)(r,i),g=e(r,i),m=Object(H.g)(r);return{contextToken:a,referencePanelSectionStyle:g.referencePanelSectionStyle,contentStyle:g.contentStyle,spacerContainerStyle:g.spacerContainerStyle,spacerStyle:g.spacerStyle,legendStyle:g.legendStyle,legendTextStyle:g.legendTextStyle,sectionDescriptor:c,controlDescriptor:l,shouldSectionRender:u,visible:d,label:p,pageType:h,isRTL:m}}}))(W);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var q=n("Lyxw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class X extends r.Component{transformDeviceStyle(){return Object.assign(Object.assign({},this.props.columnStyle.columnStyle),this.props.customStyle)}render(){const e=this.props.column,t=null==e?void 0:e.SectionNames[0],n=[];if(this.props.shouldRenderHeaderFields||this.props.shouldRenderFooterFields){const e="headerFooterSection";n.push(r.createElement(B,{key:e,id:this.props.id,sectionName:e,isHeaderOrFooterSection:!0,shouldRender:this.props.shouldRender,shouldRenderHeaderFields:this.props.shouldRenderHeaderFields,shouldRenderFooterFields:this.props.shouldRenderFooterFields,customStyle:this.props.sectionStyle,cellStyle:this.props.cellStyle,customCellContainerStyle:this.props.cellContainerStyle,inDialogWithZIndex:this.props.inDialogWithZIndex,intersectionObserverHelper:this.props.intersectionObserverHelper}))}return e.SectionNames.map(e=>{this.props.referencePanelSectionNames&&this.props.referencePanelSectionNames.length>0&&this.props.referencePanelSectionNames.indexOf(e)>-1?n.push(r.createElement(U,{id:this.props.id,key:e,sectionName:e,shouldRender:this.props.shouldRender,customStyle:this.props.sectionStyle})):n.push(r.createElement(B,{key:e,id:this.props.id,sectionName:e,shouldRender:this.props.shouldRender,customStyle:this.props.sectionStyle,cellStyle:this.props.cellStyle,customCellContainerStyle:this.props.cellContainerStyle,inDialogWithZIndex:this.props.inDialogWithZIndex,intersectionObserverHelper:this.props.intersectionObserverHelper}))}),r.createElement(l.a,{id:t,semanticTag:"section",ref:this.props.descriptorDomId,style:this.transformDeviceStyle(),role:v.r},n)}}X.displayName="Column";const Y=Object(a.a)((function(){const e=function(){let e=null,t=null;return function(n,r){const i=Object(d.a)(n);return t!==i&&(t=i,e={columnStyle:{display:"block"}}),e}}(),t=function(){let e,t;return function(n,r){return t!==r&&(t=r,e=r.SectionNames.filter(e=>Object(s.Mb)(n,e))),e}}();return function(n,r){const i=Object(g.j)(n,r.id),a=Object(s.p)(n,r,i),o=e(n,r),c=Object(q.b)(n,"ReferencePanelControl")?t(n,a):null;return{column:a,columnStyle:o,shouldRenderHeaderFields:r.renderHeaderFields,shouldRenderFooterFields:r.renderFooterFields,referencePanelSectionNames:c}}}))(X);var K=n("b8TU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Q=n("QJW6"),Z=n("QXIS"),J=n("3/02"),$=n("3yqi"),ee=n("H4dV"),te=n("hAdb"),ne=n("a475");class re extends r.Component{constructor(e,t){super(e,t),this._shouldRenderContents=!1,this.state={numberOfFormComponentSectionColumns:null};if(!(ee.a.getInstance().get_IsIOS()&&ne.a.get_Instance().get_device().get_DeviceState().get_IsNarratorActive())&&e.isIntersectionObserverEnabled&&e.viewportElementId&&e.pageName===$.a.EditForm&&!t.AccessibilityManager.isClientAPISetFocusScheduled())try{this._setupIntersectionObserver(e.viewportElementId,e.formLazyLoadConfigFlag)}catch(e){this.context.TraceManager.getTracer("Forms.Tab").warn("Failed to initialize intersection observer with error: "+e.message)}this._formComponentSectionColumnMeasuringCallback=this._formComponentSectionColumnMeasuringCallback.bind(this)}_formComponentSectionColumnMeasuringCallback(e){const{descriptor:t}=this.props;let n=null;const r=()=>{var e,n;const r=document.getElementById(null===(n=null===(e=t.Columns[0])||void 0===e?void 0:e.SectionNames)||void 0===n?void 0:n[0]);return r?getComputedStyle(r).width:null};if(0!==e&&(this._lastViewWidth!==e||this._lastFirstSectionWidth!==(n=r()))){this._lastViewWidth=e,this._lastFirstSectionWidth=n||r();const t=this._getFormComponentSectionColumns(this.props.descriptor,this.props.isDeviceWidthLessThanDimensionS);this.state.numberOfFormComponentSectionColumns!==t&&this.setState({numberOfFormComponentSectionColumns:t})}}_getFormComponentSectionColumns(e,t){var n,r,i,a,s,o,c,l,u;if(!(null==e?void 0:e.Columns))return null;if(e.Columns.length>1&&!t){const t=document.getElementById(null===(r=null===(n=e.Columns[0])||void 0===n?void 0:n.SectionNames)||void 0===r?void 0:r[0]),d=document.getElementById(null===(a=null===(i=e.Columns[1])||void 0===i?void 0:i.SectionNames)||void 0===a?void 0:a[0]),p=document.getElementById(null===(o=null===(s=e.Columns[2])||void 0===s?void 0:s.SectionNames)||void 0===o?void 0:o[0]);if(t&&d){const e=null===(c=t.getBoundingClientRect())||void 0===c?void 0:c.top,n=null===(l=d.getBoundingClientRect())||void 0===l?void 0:l.top;if(e&&n)if(p){const t=null===(u=p.getBoundingClientRect())||void 0===u?void 0:u.top;if(t&&e===n&&e===t&&n===t)return 3;if(e===n)return 2}else if(e===n)return 2}}return 1}_renderColumns(e){const t=[];for(let n=0;n<e.Columns.length;n++){let i=!1,a=!1;0===n&&this.props.firstVisibleTab&&this.props.tabId===this.props.firstVisibleTab.Id&&(i=this.props.showHeaderFieldsRenderInSection&&this.props.renderHeaderFields,a=this.props.showFooterFieldsRenderInSection&&this.props.renderFooterFields);const s=e.Columns[n].Width;let o={},c=this.props.isDeviceWidthLessThanDimensionS?{flex:(parseInt(s,10)/10).toString()+" "+this.props.sectionWidthInPx.toString()+"px",minWidth:0}:{flex:(parseInt(s,10)/10).toString(),minWidth:this.props.sectionWidthInPx};const l=this.props.isRTL?{paddingLeft:"1.5rem"}:{paddingRight:"1.5rem"},u=this.state.numberOfFormComponentSectionColumns;u?(n<u-1&&(c=Object.assign(c,l)),1===u&&(o=this.props.sectionFullBleedStyle)):this.props.isFormComponentInstance&&((e.Columns.length<=1||this.props.isDeviceWidthLessThanDimensionS)&&(o=this.props.sectionFullBleedStyle),n<e.Columns.length-1&&!this.props.isDeviceWidthLessThanDimensionS&&(c=Object.assign(c,l)));const d=Object.assign(Object.assign({},this.props.columnStyle),c),p=Object.assign(Object.assign({},this.props.sectionStyle),o);t.push(r.createElement(Y,{key:n,tabName:this.props.tabId,columnIndex:n,id:this.props.id,renderHeaderFields:i,renderFooterFields:a,descriptorDomId:Object(E.g)(this.props.descriptor.DomId,this.props.id),shouldRender:!0,customStyle:d,sectionStyle:p,cellStyle:this.props.cellStyle,cellContainerStyle:this.props.cellContainerStyle,inDialogWithZIndex:this.props.inDialogWithZIndex,intersectionObserverHelper:this._intersectionObserverHelper}))}return t}componentWillUnmount(){this._cleanupIntersectionObserverHelper()}_cleanupIntersectionObserverHelper(){this._intersectionObserverHelper&&(this.context.IntersectionObserverManager.delete(this.props.tabId),this._intersectionObserverHelper.cleanup(),this._intersectionObserverHelper=null)}_setupIntersectionObserver(e,t){if(!this._intersectionObserverHelper&&e){const n=document.getElementById(e);if(n){const e={root:n,rootMargin:"50%",threshold:0};this._intersectionObserverHelper=new Z.b(e,this.context.EventManager,t),this.context.IntersectionObserverManager.set(this.props.tabId,this._intersectionObserverHelper)}}}_renderSingleComponent(){return this.props.firstCell?r.createElement(c.a,{key:0,domId:Object(E.g)(this.props.firstCell.DomId,this.props.id),previewId:this.props.firstCell.PreviewId,id:this.props.id,controlName:this.props.firstCell.ControlName,userSpacer:this.props.firstCell.UserSpacer,rowSpan:this.props.firstCell.RowSpan,columnSpan:1,autoExpand:this.props.firstCell.AutoExpand,style:this.props.cellStyle,cellSizeMode:0,shouldRender:!0,scope:S.a.EditForm,availableForPhone:this.props.firstCell.AvailableForPhone,inDialogWithZIndex:this.props.inDialogWithZIndex,cellLabelPosition:1,isParentPaddingAdded:!0,useControlWrapper:!1}):null}render(){const e=this.props.descriptor;if(!e)return null;if(this._shouldRenderContents=this._shouldRenderContents||this.props.showTab,!this._shouldRenderContents||!this.props.visible||this.props.clientHostSubtype===j.a.Phone&&null!==e.AvailableForPhone&&void 0!==e.AvailableForPhone&&!e.AvailableForPhone)return null;let t=this.props.showTab?this.props.tabContainerStyle:this.props.hiddenTabStyle;t=this.props.singleComponent&&this.props.showTab?this.props.expandedTabContainerStyle:Object.assign(Object.assign({},t),this.props.style);const n=Q.a.getInstance().getDisableScrollStyle()?"forceNewStackContextInert":"forceNewStackContext";return r.createElement(l.a,{id:e.DomId,ref:e.DomId,testhooks:{id:"tabpanel-"+this.props.tabName,[T.b]:e.PreviewId,[C.a.LearningPathDOMAttributeSuffix]:"tabpanel-"+this.props.tabName},style:t,role:this.props.pageName===$.a.Dialog||this.props.pageName===$.a.ModalDialog||this.props.pageName===$.a.QuickCreateForm||this.props.isFormComponentInstance?v.r:v.v,accessibilityLabel:this.props.pageName===$.a.Dialog||this.props.pageName===$.a.ModalDialog||this.props.pageName===$.a.QuickCreateForm||this.props.isFormComponentInstance?null:this.props.label,"aria-hidden":!this.props.showTab,explicitStyles:n,onMeasuring:this._formComponentSectionColumnMeasuringCallback,isRequestedMeasuring:this.props.isFormComponentInstance},this.props.singleComponent?this._renderSingleComponent():this._renderColumns(e))}}re.displayName="Tab";const ie=Object(a.a)((function(){const e=function(){let e=null,t=null,n=null;return function(r,i){const a=Object(d.a)(r),o=Object(K.c)(r),c=Object(s.Ib)(r,i.id);return t===a&&n===o||(t=a,n=o,e={tabContainerStyle:{width:"100%",flexWrap:"wrap",overflowY:"auto",overflowX:"hidden",flexDirection:"row",flex:"1 0 0px",backgroundColor:c?"#F8F7F6":void 0},hiddenTabStyle:{width:"100%",overflowX:"hidden",display:"none"},customFooterRootStyle:{width:"100%",display:"block",position:"fixed",left:o<=a.sizes.Breakpoints.DimensionS?a.sizes.Measures.Measure050:a.sizes.Measures.Measure150,bottom:0,marginLeft:o<=a.sizes.Breakpoints.DimensionS?"-0.5rem":"-1.5rem",marginRight:o<=a.sizes.Breakpoints.DimensionS?"-0.5rem":"-1.5rem"},expandedTabContainerStyle:{display:"flex",width:"100%",flexWrap:"wrap",overflowY:"visible",overflowX:"hidden",flexDirection:"row",flex:"1 0 0px"},sectionFullBleedStyle:{paddingTop:"0px",paddingLeft:"0px",paddingBottom:"0px",paddingRight:"0px",borderWidth:"0px",marginBottom:"0px"}}),e}}();let t=null;return function(n,r){var i;const a=Object(g.j)(n,r.id);Object(L.e)(t,a)||(t=a);const c=Object(s.Fc)(n,r.id,r.tabId,a),l=Object(s.Kc)(n,r.tabId,r.id,a),u=Object(s.Hc)(n,r.tabId,r.id,a),p=Object(d.a)(n),h=Object(P.e)(n),m=Object(s.Y)(n,r,a),b=e(n,r),y=p.sizes.Section.SectionWidth,f=Object(s.xc)(n,r,a),S=Object(q.c)(n,J.Q)&&Z.a,v=Object(o.l)(n,r.id),C=Object(K.c)(n)<n.theme.sizes.Breakpoints.DimensionS,O=!1!==Object(te.d)(n,"formlazyload")&&!0!==Object(te.d)(n,"testmode"),_=Object(s.Eb)(n,r.id),I=Object(H.g)(n),j="singleComponent"===(null===(i=Object(s.Jc)(n,r.id,r.tabId,a))||void 0===i?void 0:i.contentType),F=j?function(e,t,n,r){for(const i of e.Columns||[])if(i)for(const e of i.SectionNames||[]){const i=Object(s.qc)(t,{id:n.id,sectionName:e},r),a=Object(s.tc)(t,{id:n.id,sectionName:e},r);if(i&&!1!==a)for(const e of i.Rows||[])if(e&&!1!==e.Visible)for(const t of e.Cells||[])if(t&&!1!==t.Visible)return t}return null}(c,n,r,a):null;return{descriptor:c,visible:l,label:u,hiddenTabStyle:b.hiddenTabStyle,tabContainerStyle:b.tabContainerStyle,customFooterRootStyle:b.customFooterRootStyle,expandedTabContainerStyle:b.expandedTabContainerStyle,sectionFullBleedStyle:b.sectionFullBleedStyle,clientHostSubtype:h,firstVisibleTab:m,contextToken:t,sectionWidthInPx:y,showHeaderFieldsRenderInSection:f,isIntersectionObserverEnabled:S,pageName:v,isDeviceWidthLessThanDimensionS:C,formLazyLoadConfigFlag:O,isFormComponentInstance:_,isRTL:I,singleComponent:j,firstCell:F}}}))(re);re.contextType=w.a},"/5se":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="controls.DefaultView";function a(e,t,n,a){const s=Object(r.v)(n);return{type:i,payload:a.guid,meta:{pageId:e,controlName:t,contextKey:s}}}},"/q/W":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("SoKF"),i=n("RrRQ"),a=n("i1f0"),s=n("4UCL"),o=n("zmL5"),c=n("dHD5"),l=n("bT7G"),u=n("jTSi"),d=n("O7zD");function p(e){return{type:"handle.unsaved.changes.async",execute:({dispatch:t,getState:n},p,h)=>t(Object(r.a)(e)).then(r=>{if(r){const r=Object(o.a)(n(),e),p=r.map(e=>Object(c.j)(n(),e));for(let e=0;e<r.length;e++){const o=r[e],c=p[e],h=Object(a.ac)(n(),o,c),g=Object(l.b)(n(),h),m=(null==g?void 0:g.activeChanges)?Object.keys(g.activeChanges):[];for(const e of m)t(Object(u.b)(c,o,Object(d.d)(o,e)));t(Object(i.c)(o,h,c)),t(Object(s.d)(o,c))}return!0}return!1})}}},"/q65":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="attribute.targets.set";function a(e,t,n,a){const s=Object(r.x)(t);return{type:i,payload:a,meta:{pageId:e,contextKey:s,dataFieldName:n}}}},"09am":function(e,t,n){"use strict";function r(e,t){if(e&&e.indexOf("<QuickFormId")>0)
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
return function(e){if(e){const t={},n=e.match(/(?!entityname=")[A-Za-z0-9_]+(?=".*<\/QuickFormId>)/g),r=e.match(/[A-Za-z0-9]+-[A-Za-z0-9]+-[A-Za-z0-9]+-[A-Za-z0-9]+-[A-Za-z0-9]+(?=<\/QuickFormId>)/g);for(let e=0;e<n.length;e++)t[n[e]]=r[e];return t}return null}(e);const n={};return n[t]=e,n}n.d(t,"a",(function(){return r}))},"0L4T":function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return h}));var r=n("j2fa"),i=n("YxC/"),a=n("GEBM"),s=n("z8iZ"),o=n("DAWX"),c=n("3/02"),l=n("Lyxw"),u=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function d(e,t,n,r,s){let o=null;if(o=Object(i.b)(e,a.q),"function"==typeof n.get_ErrorCode)switch(n.get_ErrorCode()){case-2147093999:o=Object(i.b)(e,a.r);break;case-2147220960:o=Object(i.b)(e,a.o);break;case-2147164125:o=Object(i.b)(e,a.a);break;case-2147164130:case-2147164126:o=Object(i.b)(e,a.j);break;case-2147217149:o=Object(i.b)(e,a.i);break;case-2147217098:o=Object(i.b)(e,a.x);break;case-2147220969:case-2147187962:o=Object(i.b)(e,a.p);break;default:n.get_Message()&&(o=o+" "+n.get_Message())}p(e,t,o,r,s)}function p(e,t,n,i,a){let d=null;d=function(e){const t=Object(s.a)();return t.ErrorInformation=new o.a,t.ErrorInformation.set_ErrorDescription(e),t}(n),Object(l.c)(e,c.rd)?(t(Object(r.a)(i.getStorageKey(),d)),Object(r.e)(e,t,i.getStorageKey(),a)):(t(Object(r.c)(u.a.toString(i.visualizationId)||u.a.EMPTYGUIDSTRING,u.a.toString(i.viewId)||u.a.EMPTYGUIDSTRING,d)),Object(r.d)(e,t,u.a.toString(i.visualizationId)||u.a.EMPTYGUIDSTRING,u.a.toString(i.viewId)||u.a.EMPTYGUIDSTRING,a))}function h(e,t,n,r,s,o){p(t,n,-2147220960===e?Object(i.b)(t,a.o):r,s,o)}},"0N/X":function(e,t,n){"use strict";n.r(t),n.d(t,"ModelFormComponent",(function(){return ee}));var r=n("SAYH"),i=n("Gn6i"),a=n("odYE"),s=n("uNLT"),o=n("y60j"),c=n("lY/Z"),l=n("4fxQ"),u=n("nuS9"),d=n("QBtP"),p=n("XOQQ"),h=n("HMYz"),g=n("clbQ"),m=n("GO2b"),b=n("mL5Q"),y=n("u+q+"),f=n("f/sd"),S=n("YWpA"),v=n("ShM1"),C=n("Gh4N");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const O={containerStyle:{paddingTop:"2em",paddingBottom:"2em",display:"flex",justifyContent:"center",borderBottom:"1px solid "+n("SocB").d.Grey.Grey3}};var _=n("YxC/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var I=n("z0a7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const j=u.memo((function(e){const[t,n]=u.useState(!1);u.useEffect(()=>{const e=setTimeout(()=>{n(!0)},500);return()=>clearTimeout(e)},[]);const r="form-component-spinner-container-"+e.id,i="form-component-spinner-"+e.id,a=Object(I.a)(["Model_Form_Component_Loading_Message"]),s=Object(_.c)(a,"Model_Form_Component_Loading_Message"),o=s&&""!==s;return t?u.createElement(S.a,{key:r,id:r,style:O.containerStyle},u.createElement(v.a,{key:i,id:i,label:o?s:"Getting things ready...",labelPosition:"right",size:C.a.large})):null}));var P=n("jq7Z"),F=n("dHD5"),T=n("i1f0"),w=n("unFF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const E=Object(y.a)((e,t)=>{var n,r;const i=Object(b.a)(e,t.id),a=null===(n=Object(P.a)(e,t.id))||void 0===n?void 0:n.parentComponentId,s=a?null===(r=Object(T.cb)(e,a,Object(F.j)(e,a)))||void 0===r?void 0:r.viewportWidth:void 0,o=Object(w.a)(e);return{loadingState:i,initialSizeMode:null!=s&&s<o.sizes.Breakpoints.DimensionM?2:void 0}})((function(e){const{id:t,loadingState:n}=e;return!n||n<f.a.EditReady?u.createElement(j,{id:t}):u.createElement(m.a,{id:t,initialSizeMode:e.initialSizeMode})}));var x=n("H/hG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const N=u.memo((function(e){const t=Object(I.a)([e.resourceStringId]),n=Object(_.c)(t,e.resourceStringId),r=n&&""!==n,i="form-component-error-container-"+e.id,a="form-component-error-text-"+e.id;return u.createElement(S.a,{key:i,id:i,style:O.containerStyle},u.createElement(x.a,{key:a,id:a},r?n:null==e?void 0:e.defaultString))}));var A=n("lk80"),k=n("8KYF"),M=n("BoVI");var D=n("pCLb"),R=n("FdKt"),B=n("/iCT"),L=n("RrRQ");var V=n("yUiV"),z=n("zmaG"),H=n.n(z),G=n("09am"),W=n("SDQ8"),U=n("pEXn"),q=n("SoKF"),X=n("mIxf"),Y=n("zmL5"),K=n("iZ7K"),Q=n("bT7G"),Z=n("KXSk"),J=n("E8F2");var $;!function(e){e[e.uninitialized=0]="uninitialized",e[e.initializing=1]="initializing",e[e.initialized=2]="initialized",e[e.disposed=3]="disposed",e[e.error=4]="error"}($||($={}));class ee{constructor(e,t,n,i){var s,o;this._boundOnce=!1,this._div=e,this._subForms=Object(G.a)(t,n),this._state=$.uninitialized;const c=this._subForms[n];n&&i&&(this._entityReference=new a.a(n,new r.a(i))),this._performanceParameters={[U.b.EntityName]:n,[U.b.FormId]:c},H.a.addKeyPerformanceIndicatorOnIdle("Forms.FormComponent",this._performanceParameters),this._formInput={entityTypeName:this._entityReference&&this._entityReference.etn,pageType:"entityrecord",formId:c?new r.a(c):void 0,id:null!==(o=null===(s=this._entityReference)||void 0===s?void 0:s.id)&&void 0!==o?o:r.a.EMPTY},this._tracer=ee._context.TraceManager.getTracer("Forms.FormComponent")}render(e){return this._div&&ee._context&&ee._store?this._entityReference&&this._entityReference.etn&&this._entityReference.id&&this._formInput&&this._formInput.formId?this._renderInternal():(this._renderNoBoundRecord(),Promise.resolve()):Promise.reject("Invalid params")}bindRecord(e,t,n){if(e&&t){const n=this._entityReference&&this._entityReference.etn,i=this._entityReference&&this._entityReference.id;if(this._updateEntityReferenceAndFormInput(e,t),n&&this._entityReference.etn===n&&r.a.equals(this._entityReference.id,i))return;!n&&this._entityReference.etn&&this._entityReference.id?this._renderInternal():n!==this._entityReference.etn?this._disposeThenRender():r.a.equals(this._entityReference.id,i)||this._bindRecordInternal()}else this._checkForUnsavedChanges()}async _checkForUnsavedChanges(){const e=ee._store.getState(),t=Object(F.j)(e,this._formComponentId),n=Object(T.ac)(e,this._formComponentId,t),r=Object(Q.b)(e,n);if((null==r?void 0:r.activeChanges)&&Object.keys(r.activeChanges).length>0){const{title:t,message:n}=this._getLocalizedUnsavedChangesStrings(e);if(!await ee._store.dispatch(Object(q.a)(this._formComponentId,n,t))){const t=Object(o.b)(e,this._sourcePageId,Object(Y.b)(e,this._sourcePageId),this._controlName),n=null==t?void 0:t.DataFieldName;if(n){const e={[n]:{fieldName:n,value:this._entityReference}};ee._store.dispatch(Object(X.a)(this._sourcePageId,e,!1,!1))}return}}this._disposeThenRenderNoBound()}_getLocalizedUnsavedChangesStrings(e){var t;const n=Object(_.e)(e,["Model_Form_Component_Unsaved_Linked_Data_Title","Model_Form_Component_Unsaved_Linked_Data_Message"]),r=null===(t=Object(K.h)(e,this._entityReference.etn))||void 0===t?void 0:t.DisplayName,i=Object(_.c)(n,"Model_Form_Component_Unsaved_Linked_Data_Message")||"There is data linked to this field that hasn't been saved. If you change this record those changes will be lost";let a=Object(_.c)(n,"Model_Form_Component_Unsaved_Linked_Data_Title")||"Unsaved Linked Data";return r&&(a+=": "+r),{title:a,message:i}}save(e){this._checkInitializationState();return ee._store.dispatch(Object(s.e)(this._formComponentId,1)).then(e=>({entityReference:e}))}refreshData(){this._checkInitializationState();const e=Object(o.y)(ee._store.getState(),this._formInput.formId);return ee._store.dispatch(Object(c.c)(this._entityReference,e)).catch(e=>{throw this._disposeThenRenderError(e),e})}register(e,t){
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n,r;this._formComponentId?(ee._store.dispatch(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,n){return{type:M.b,payload:{formInstanceId:t,controlName:n},meta:{pageId:e}}}(e,this._formComponentId,this._controlName)),ee._store.dispatch((n=e,r=this._formComponentId,{type:M.c,payload:{parentComponentId:n},meta:{pageId:r}}))):(this._controlName=t,this._sourcePageId=e)}_disposeThenRenderNoBound(){this._entityReference=void 0,this.dispose(),Object(R.b)(()=>{this._renderNoBoundRecord()},"Render no bound record component after ModelFormComponent dispose")}_disposeThenRenderError(e){this._entityReference=void 0,this._state=$.error,this.dispose(),Object(R.b)(()=>{this._renderErrorElement(e)},"Render no bound record component after ModelFormComponent dispose")}_disposeThenRender(){this.dispose(),Object(R.b)(()=>{this._renderInternal()},"Re-render formComponent")}dispose(){this._clearDataSnapshots(),this._state!==$.initialized&&this._state!==$.error||(Object(W.d)(this._sourcePageId,this._controlName),Object(R.b)(()=>{var e,t,n,r;ee._store.dispatch({type:k.REMOVE_FORM_INSTANCE,payload:void 0,meta:{pageId:this._formComponentId}}),ee._store.dispatch(Object(D.a)(this._formComponentId)),Object(B.a)(this._formComponentId),ee._store.dispatch((t=this._sourcePageId,n=this._formComponentId,r=this._controlName,{type:M.g,payload:{formInstanceId:n,controlName:r},meta:{pageId:t}})),l.unmountComponentAtNode(this._div);const i=null===(e=ee._context)||void 0===e?void 0:e.MutationObserverHandler;null==i||i.removeObserverTarget(this._mutationObserver),this._mutationObserver=void 0,this._state=$.uninitialized,this._formComponentId=void 0},"Dispose formComponent "+this._formComponentId))}_clearDataSnapshots(){const e=Object(F.j)(ee._store.getState(),this._formComponentId),t=Object(T.ac)(ee._store.getState(),this._formComponentId,e);ee._store.dispatch(Object(L.c)(this._formComponentId,t,e))}_checkInitializationState(){if(this._state!==$.initialized)return this._tracer.warn("Form Component has not been initialized."),Promise.reject("Form Component has not been initialized.")}_checkIsEntityAndFormBound(){if(!(this._entityReference&&this._entityReference.etn&&this._entityReference.id&&this._formInput&&this._formInput.formId))return Promise.reject("Cannot render as the FormComponent does not have bound entity or associated form")}_bindRecordInternal(){return this._checkIsEntityAndFormBound(),this._checkInitializationState(),this._clearDataSnapshots(),Object(i.b)(ee._store.getState(),ee._store.dispatch,this._formComponentId,this._tracer,this._entityReference,this._formInput.formId,this._formInput,[]).then(()=>(ee._store.dispatch(function(e,t,n){const r={entityReference:n},i=Object(F.j)(e,t);return{type:M.h,payload:r,meta:{pageId:t,contextToken:i}}}(ee._store.getState(),this._formComponentId,this._entityReference)),Promise.resolve())).catch(e=>{throw this._disposeThenRenderError(e),e})}_updateEntityReferenceAndFormInput(e,t){this._entityReference=new a.a(e,new r.a(t)),this._formInput.id=this._entityReference.id,this._formInput.entityTypeName=this._entityReference.etn,this._formInput.formId=this._subForms&&this._subForms[this._entityReference.etn]?new r.a(this._subForms[this._entityReference.etn]):void 0}_renderFormElement(){const e=u.createElement(E,{id:this._formComponentId});return this._renderElement(e)}_renderNoBoundRecord(){const e={id:this._formComponentId,resourceStringId:"Model_Form_Component_No_Bound_Record_Message",defaultString:"Source record not selected"},t=u.createElement(N,e);return this._renderElement(t)}_renderErrorElement(e){var t;const n={id:this._formComponentId,resourceStringId:(null==e?void 0:e.errorCode)?null===(t=Object(J.d)(e.errorCode))||void 0===t?void 0:t[0]:null,defaultString:"Unexpected Error"},r=u.createElement(N,n);return this._renderElement(r)}_renderElement(e){const t=u.createElement(d.a.Provider,{value:ee._context},e),n=u.createElement(p.a,{store:ee._store},t),r=u.createElement(h.Provider,A.a,n);l.render(r,this._div);const i=ee._context.MutationObserverHandler,a=g.a.getInstance();return this._mutationObserver=new MutationObserver(()=>{a.scheduleMeasuringUpdate()}),i.addObserverTarget(this._mutationObserver,this._div.id),Promise.resolve(!0)}_renderInternal(){var e;if(this._checkIsEntityAndFormBound(),this._renderFormElement(),this._state===$.uninitialized){this._state=$.initializing,this._formComponentId=this._boundOnce?Object(W.c)(this._sourcePageId,this._controlName):Object(W.b)(this._sourcePageId,this._controlName);const t=null===(e=Object(P.a)(ee._store.getState(),this._formComponentId))||void 0===e?void 0:e.formLoadError;if(t&&!this._boundOnce)return this._boundOnce=!0,this._disposeThenRenderError(t),Promise.resolve();const n=!this._boundOnce&&Object(Z.a)(ee._store.getState(),this._sourcePageId,this._controlName),r=n?Promise.resolve():Object(V.a)(this._formComponentId,this._formInput);return this._performanceParameters[U.b.ModelFormComponent.IsPreInitialized]=n.toString(),r.then(()=>{this._state=$.initialized,this.register(this._sourcePageId,this._controlName),this._renderFormElement()}).catch(e=>{throw this._disposeThenRenderError(e),e}),this._boundOnce=!0,r}return Promise.reject("FormComponent is already initialized. Cannot initialize again")}}},"0PSL":function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var r,i=n("SAYH"),a=n("hvSt");!function(e){e[e.Active=0]="Active",e[e.Inactive=1]="Inactive",e[e.Completed=2]="Completed"}(r||(r={}));var s=n("CPoS"),o=n("xMtD"),c=n("odYE"),l=n("VnpK"),u=n("S2mk"),d=n("LbMF"),p=n("+nNZ"),h=n("i1f0"),g=n("dHD5"),m=n("iZ7K"),b=n("504W"),y=n("Lyxw"),f=n("9fGf"),S=n("arV0"),v=n("WRF3"),C=n("fU7K");class O{constructor(e,t,n){this._memorizedExtraFilters=[],this._getState=e,this._businessProcessFlowWrapperIdentifierFactory=t,this._context=n}generate(e,t){return t?this._getBusinessProcessFlowWrapper(e,t):null}_getBusinessProcessFlowWrapper(e,t){const n=this._getState(),r=this._businessProcessFlowWrapperIdentifierFactory.generate(e,t);if(!r||!t||!t.getProcessId())return null;const a=t.getCurrentFormEntity(),c=Object(S.g)(n,e);this._navigationEntities=t.getNavigationEntities();const l=Object(p.f)(n,a);return{id:t.getProcessId(),instanceId:t.getProcessInstanceId(),name:Object(s.c)(n,t.getProcessId()),bpfEntityLogicalName:t.getBpfEntityLogicalName(),stages:this._getStages(r.data.activePath,r.activeStageId,r.data.selectedStageId,e,t),relationships:Object(o.e)(this._getState(),t.getProcessId()),activeStageId:r.activeStageId,selectedStageId:r.data.selectedStageId,activePath:r.data.activePath,displayState:r.displayState,currentEntity:new v.a(a.etn,i.a.toLegacyGuid(a.id)),processState:t.getProcessState(),state:t.getState(),status:t.getStatus(),statusName:t.getStatusName(),isFormInactive:Object(h.Lb)(n,c.entityTypeName,c.id),delegates:this._getActions(t),isVisible:t.isVisible(),actionLogs:r.data.actionLogCollection,instanceModifiedTimestamp:l,instanceName:t.getProcessInstanceName(),isCustomControlsPresent:t.getCustomControlIndicator(),isRenderedFromFormXml:t.getFormXmlRenderingIndicator(),isImmersiveBPF:t.isImmersiveBPF()}}_getStages(e,t,n,r,a){if(!e||0===e.length)return null;const s={},o=[];return e.forEach((e,c)=>{s[e.guid]=c;const l=i.a.equals(e,n),u=this._getStageWrapper(e,l,t,s,r,a);u&&o.push(u)}),o}_getStageWrapper(e,t,n,r,a,s){const c=Object(o.c)(this._getState(),s.getProcessId(),e);if(!c)return null;let l=t&&this._getSteps(c,a,s)||[];if(Object(y.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){const e="BusinessProcessFlow.CustomControlConfiguration",t=this._context.TraceManager.getTracer(e),n=Object(o.a)(this._getState(),s.getProcessId(),t);if(!Object(b.a)(n)&&!Object(b.a)(n.ControlConfigurations)){const r=s.getTelemetryParams();if(r.push({name:"BPFEntityFormId",value:n.Id.guid},{name:"BPFEntityFormType",value:n.FormType}),Object(b.a)(n.ControlConfigurations)||r.push({name:"CustomControls",value:Object.keys(n.ControlConfigurations).length}),s.isBpfFormDescriptorValid(this._getState(),s.getProcessId(),n,t))try{if(!Object(b.a)(n.ControlConfigurations)){const u=Object(o.b)(n,t),d=n.ControlConfigurations,p=this._getNonDefaultControlConfiguration(d);if(Object(y.c)(this._getState(),"FCB.EnableBPFCCPhase3")){const t=this._buildStepsFromFormXml(c,n,p,r,a,s);t&&t.length>0&&(l=t,s.setFormXmlRenderingIndicator(!0),this._context.EventManager.ReportComponentSuccess(e,r))}else Object(b.a)(u)||Object.keys(u).forEach(n=>{if(u[n].ParentCellId){const a=new i.a(u[n].ParentCellId);if((c&&c.stage&&c.stage.steps?c.stage.steps.map(e=>e.stepId.guid).indexOf(a.guid):-1)>=0&&a){const o=[];o.push({name:"StepId",value:a.guid},{name:"NonDefaultControlUniqueId",value:u[n].UniqueId}),t.info("Non-default control found for step",o);let d=null;p&&u[n].UniqueId&&(s.setFormXmlRenderingIndicator(!0),d=p[u[n].UniqueId]?p[u[n].UniqueId]:null);const h={attributeName:u[n].DataFieldName,isRequired:this._getIsStepRequired(a.guid,c),name:u[n].Label,stepId:new i.a(a.guid),stepType:"field",attributeType:this._getMetadataTypeByAttribute(c.entityLogicalName,u[n].DataFieldName),controlName:"header_process_"+u[n].Label,isVisible:u[n].Visible,isControlDisabled:u[n].Disabled,nonDefaultConfiguration:d};l.push(h),Object(b.a)(h.stepId.guid)||h.stepId.guid===i.a.EMPTY.guid||r.push({name:"StepId",value:h.stepId.guid}),r.push({name:"AttributeName",value:h.attributeName},{name:"AttributeType",value:h.attributeType},{name:"IsRequired",value:h.isRequired},{name:"NonDefaultControlUniqueId",value:u[n].UniqueId}),Object(b.a)(d)?this._context.EventManager.ReportComponentFailure(e,new Error("CustomControlConfiguration is null or undefined even though the BPF entity form XML is valid and contains non-default custom control descriptors"),null,r):(s.setCustomControlIndicator(!0),r.push({name:"CustomControlId",value:d.CustomControlId}),!Object(b.a)(d.Name)&&d.Name.indexOf("MscrmControls")>=0&&r.push({name:"CustomControlName",value:d.Name}),this._context.EventManager.ReportComponentSuccess(e,r))}}})}}catch(n){t.error(`Message: ${n.message}, Stack: ${n.stack}`,r),this._context.EventManager.ReportComponentFailure(e,n,null,r)}else this._context.EventManager.ReportComponentFailure(e,new Error("Invalid FormXML - Fallback invoked"),null,r)}}return{id:c.stage.stageId,name:c.stage.stageDisplayName,entityName:c.entityLogicalName,entityDisplayName:Object(m.f)(this._getState(),c.entityLogicalName)||c.entityDisplayName,relatedEntityReference:this._getRelatedEntityReference(c.entityLogicalName),referencingAttributeName:c.referencingAttributeName,status:this._getStageStatus(r[e.guid],r[n.guid],s),steps:l}}_buildStepsFromFormXml(e,t,n,r,a,s){const o=[],c=t.Controls;return!Object(b.a)(c)&&this._areStepsValid(e,t,r)&&Object.keys(c).forEach(l=>{if(!Object(b.a)(c[l])&&c[l].ParentCellId){const u=new i.a(c[l].ParentCellId),d=t.Tabs.find(e=>e.Id===c[l].ParentTabId);if(d&&!Object(b.a)(d.RawTabId)&&e.stage.stageId.guid===new i.a(d.RawTabId).guid){let d=null;n&&c[l].UniqueId!==i.a.EMPTY.guid&&(d=n[c[l].UniqueId]?n[c[l].UniqueId]:null);const p=this._retrieveControlName(c[l],e.stage.steps),g=this._getUIControl(a,p),m={attributeName:c[l].DataFieldName,isRequired:c[l].IsRequired,name:this._retrieveStepLabel(c[l],g,e.stage.steps),stepId:new i.a(u.guid),stepType:this._getStepTypeFromControlKey(l),attributeType:this._getMetadataTypeByAttribute(e.entityLogicalName,c[l].DataFieldName),controlName:p,isVisible:g&&!Object(b.a)(g.visible)?g.visible:c[l].Visible,isControlDisabled:c[l].Disabled||Object(h.t)(this._getState(),{id:a,controlName:p},s.getContextToken()),viewId:g&&g.parameters&&g.parameters.defaultviewid?g.parameters.defaultviewid:null,nonDefaultConfiguration:Object(b.a)(d)?null:d};m.config=this._getConfig(t,s,c[l],a,r),m.viewId&&m.config&&m.config.Parameters&&m.config.Parameters.value&&(m.config.Parameters.value.ViewId=m.viewId,g&&g.customFilter&&g.customFilter.length>0&&(this._applyLookupFilter(m,g),m.config.Parameters.value.ExtraFilters=m.extraFilters)),o.push(m),r.push({name:"StepId",value:m.stepId.guid},{name:"AttributeName",value:m.attributeName},{name:"AttributeType",value:m.attributeType},{name:"IsRequired",value:m.isRequired},{name:"NonDefaultControlUniqueId",value:c[l].UniqueId}),Object(b.a)(d)||c[l].UniqueId===i.a.EMPTY.guid||(s.setCustomControlIndicator(!0),r.push({name:"CustomControlId",value:d.CustomControlId}),!Object(b.a)(d.Name)&&d.Name.indexOf("MscrmControls")>=0&&r.push({name:"CustomControlName",value:d.Name}))}}}),o}_areStepsValid(e,t,n){if(!(Object(b.a)(t)||Object(b.a)(e)||Object(b.a)(e.stage)||Object(b.a)(e.stage.stageId))){const r=t.Controls,a=e.stage.stageId.guid.toLowerCase(),s=e.stage.steps,o=[];if(!Object(b.a)(r)){if(Object.keys(r).forEach(e=>{if(!Object(b.a)(r[e].ParentCellId)){const n=new i.a(r[e].ParentCellId).guid.toLowerCase(),s=t.Tabs.find(t=>t.Id===r[e].ParentTabId);if(!Object(b.a)(s)&&!Object(b.a)(s.RawTabId)){const e=new i.a(s.RawTabId).guid.toLowerCase();a===e&&o.indexOf(n)<0&&o.push(n)}}}),s.length!==o.length)return n.push({name:"StepFallback",value:"No. of steps in BPF stage don't match no. of cells in corresponding tab"},{name:"BPFStageStepCount",value:s.length},{name:"TabCellCount",value:o.length}),!1;for(let e=0;e<s.length;e++)if(o.indexOf(s[e].stepId.guid.toLowerCase())<0)return n.push({name:"StepFallback",value:"BPF stage stepId does not match corresponding tab's cellId"},{name:"MissingBPFStepId",value:s[e].stepId.guid.toLowerCase()}),!1;return!0}}return!1}_retrieveStepLabel(e,t,n){if(!Object(b.a)(t)&&!Object(b.a)(t.label)&&""!==t.label)return t.label;if(!Object(b.a)(e.Label)&&""!==e.Label)return e.Label;if(!Object(b.a)(n)&&n.length>0)for(const t of n)if(t.stepId.guid===new i.a(e.ParentCellId).guid&&!Object(b.a)(t.label)&&""!==t.label)return t.label;return""}_retrieveControlName(e,t){if(!Object(b.a)(t)&&t.length>0)for(const n of t)if(n.stepId.guid===new i.a(e.ParentCellId).guid&&!Object(b.b)(n.controlName))return n.controlName;return Object(b.a)(e.DataFieldName)||""===e.DataFieldName?"":"header_process_"+e.DataFieldName}_getConfig(e,t,n,r,i){try{const a=Object(h.h)(),s=e&&e.Id,o=t.getCurrentFormEntity();i.push({name:"ControlDescriptorName",value:n&&n.Name});const c=a(this._getState(),n,r,s,o&&o.name,!1);return i.push({name:"CCFControlConfigID",value:c&&c.CustomControlId},{name:"CCFControlConfigName",value:c&&c.Name},{name:"CCFControlConfigParams",value:c&&c.Parameters&&Object.keys(c.Parameters).join(",")}),c}catch(e){i.push({name:"CCFControlConfigError",value:e})}return null}_getStageStatus(e,t,n){if(null==t||e<t)return r.Completed;if(e===t){return n.getStatus()===a.a.Finished?r.Completed:r.Active}return r.Inactive}_getSteps(e,t,n){const r=[];if(!e.stage||!e.stage.steps||0===e.stage.steps.length)return null;for(const i of e.stage.steps){const a=this._getUIControl(t,i.controlName);let s=null;if(i.name&&i.stepType&&"field"===i.stepType.toLowerCase()){if(s=this._getMetadataTypeByAttribute(e.entityLogicalName,i.name),!s)continue;if(Object(y.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){const e="BpfCustomControlSupport",t=this._context.TraceManager.getTracer(e),r=Object(o.a)(this._getState(),n.getProcessId(),t);if(!Object(b.a)(r)&&!Object(b.a)(r.ControlConfigurations)&&n.isBpfFormDescriptorValid(this._getState(),n.getProcessId(),r,t)){const e=Object(o.b)(r,t),n=this._getNonDefaultControlStepIds(e);if(!Object(b.a)(n)&&n.map(e=>e.guid).indexOf(i.stepId.guid)>=0)continue}}}const c=this._getState(),l={attributeName:i.name,controlName:i.controlName,isRequired:i.required,isVisible:!a||a.visible,name:a?a.label:i.label,stepId:i.stepId,stepType:i.stepType,attributeType:s,viewId:a&&a.parameters&&a.parameters.defaultviewid?a.parameters.defaultviewid:i.viewId,isControlDisabled:Object(h.t)(c,{id:t,controlName:i.controlName},n.getContextToken())};l.viewId&&a&&a.customFilter&&a.customFilter&&a.customFilter.length>0&&this._applyLookupFilter(l,a),r.push(l)}return r}_applyLookupFilter(e,t){let n;n=!1;const r=[];if(e&&t){for(let e=0;e<t.customFilter.length;e++){if("END_FLAG"===t.customFilter[e].customFilter){n=!0;break}if("START_FLAG"!==t.customFilter[e].customFilter){const n=Object(l.i)(Object(C.CrmHtmlDecode)(t.customFilter[e].customFilter));n&&(n.conditions&&n.conditions.length>0||n.filters&&n.filters.length>0)&&r.push(JSON.stringify(n))}}n?(this._memorizedExtraFilters=r,e.extraFilters=this._memorizedExtraFilters):e.extraFilters=this._memorizedExtraFilters?this._memorizedExtraFilters:[]}}_getMetadataTypeByAttribute(e,t){const n=this._getState(),r=Object(d.a)(n,e,t);if(!r)return null;const i=`${r.Type}.${r.Format}`;return Object(u.n)(i)}_getActions(e){return{completeProcess:()=>e.completeProcess(),moveNext:()=>e.moveToNextStage(),movePrevious:()=>e.moveToPreviousStage(),setActiveStage:t=>e.setActiveStage(t.guid),setSelectedStage:(t,n=!1)=>{e.setSelectedStage(t?t.guid:null,n)},triggerActionStepClick:t=>{e.triggerActionStepClick(t)},triggerFlowStepClick:(t,n)=>{e.triggerFlowStepClick(t,n)},refreshFlowStepClick:t=>{e.refreshFlowStepClick(t)},setDisplayState:t=>{e.setDisplayState(t)},getForwardNavigationEntities:(t,n,r,i)=>e.getForwardNavigationEntities(t,n,r,i),navigateToNextEntity:(t,n,r,i)=>e.navigateToNextEntity(c.a.fromLegacyEntityReference(t),c.a.fromLegacyEntityReference(n),r,i),executePreEvent:(t,n,r,i)=>e.executePreEvent(t,n,r,i),validateRequiredFieldsForNavigation:()=>e.ValidateRequiredFieldsForNavigation(),waitForOngoingWork:()=>e.waitForOngoingWork(),getActiveStageActiveFor:()=>e.getActiveStageActiveFor(),getBpfInstanceActiveFor:()=>e.getBpfInstanceActiveFor(),getBpfInstanceCompletedIn:()=>e.getBpfInstanceCompletedIn(),getBpfNavigationBehavior:()=>e.getBpfNavigationBehavior(),setBpfNavigationBehavior:t=>{e.setBpfNavigationBehavior(t)},getBpfNavigationBehaviorAllowCreateNew:t=>e.getBpfNavigationBehaviorAllowCreateNew(t),getActiveStage:()=>{const t=e.getContextToken(),n=e.getScriptContainer().getEventManager().getClientApiForm(t);return n?n.data.process.getActiveStage():null}}}_getRelatedEntityReference(e){if(!this._navigationEntities)return null;const t=this._navigationEntities.find(t=>t.entityLogicalName===e);return t?new v.a(t.entityLogicalName,i.a.toLegacyGuid(i.a.parse(t.id))):null}_getUIControl(e,t){if(t){const n=this._getState(),r=Object(g.j)(n,e),i={controlName:t,id:e};return Object(h.Mc)(this._getState(),i,r)}return null}_getNonDefaultControlConfiguration(e){const t={};if(e){const n=Object.keys(e);for(let r=0;r<n.length;r++){let i=null;const a=Object(f.b)(this._getState());i=e[n[r]].CustomControls[a],i&&(t[n[r]]={FormFactor:i.FormFactor,CustomControlId:i.CustomControlId,Name:i.Name,Version:i.Version,Parameters:i.Parameters,ShouldOverrideControlVisible:i.ShouldOverrideControlVisible,DisplayNameKey:i.DisplayNameKey})}}return t}_getNonDefaultControlStepIds(e){const t=[];return e&&Object.keys(e).forEach(n=>{e[n].ParentCellId&&t.push(new i.a(e[n].ParentCellId))}),t}_getIsStepRequired(e,t){const n=t.stage.steps,r=n?n.map(e=>e.stepId.guid).indexOf(e):-1;return r>=0&&!Object(b.a)(n[r].required)&&n[r].required}_getStepTypeFromControlKey(e){return e.endsWith("_actionstep")?"action":e.endsWith("_flowstep")?"modernflow":"field"}}},"0bz+":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("WY/A"),i=n("RrRQ"),a=n("qTme");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e=null,t){if(t.type===r.a){return t.payload.snapshotId}return t.type===a.a?t.payload:t.type===i.a?null:e}},"1yY9":function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n("i1f0"),i=n("Bj/n"),a=n("3tOH"),s=n("bT7G"),o=n("dHD5"),c=n("uNLT"),l=n("+aj2"),u=n("cUbT"),d=n("wBG+"),p=n("Tz6o"),h=n("yq1L"),g=n("O7zD");function m(e,t){return{type:"saveAndNew.quickCreateFormAction.async",execute({dispatch:n,getState:m},b,y){const f=m(),S=Object(o.j)(f,t),v=Object(r.zb)(f,t,S),C=Object(r.ac)(f,t,S);if(Object(s.g)(f,C)||!v)return n(Object(c.e)(t,59)).then(i=>{const a=Object(r.Ib)(f,t),s=a?"Forms.MainFormDialogRoot.SaveAndNew":"Forms.QuickCreateFormRoot.SaveAndNew";if(i){const r=[{name:"isEntityRefNull",value:!1},{name:"entityTypeName",value:i.etn}];b.EventManager.ReportComponentSuccess(s,r);return(a?Promise.resolve(t):n(Object(l.b)(t,i))).then(r=>(n(Object(u.a)(i.etn)),n(Object(d.a)(r)).then(()=>{const r=Object.assign(Object.assign({},e),{id:null});return n(Object(p.b)(r,t)),n(Object(h.b)(t,!0)),i})))}b.TraceManager.getTracer().error("Record is not created",[{name:"isEntityRefNull",value:!0}])}).catch(e=>{b.TraceManager.getTracer().error("Record is not created",e)});for(const e in v){const r=v[e].label,s=v[e].errorMessage,o=n(Object(i.b)(r,s));n(Object(i.c)(S,t,o,a.a.error,Object(g.d)(t,e)))}}}}},"223Y":function(e,t,n){"use strict";n.d(t,"b",(function(){return un})),n.d(t,"a",(function(){return dn})),n.d(t,"d",(function(){return hn})),n.d(t,"c",(function(){return ln}));var r=n("u+q+"),i=n("QBtP"),a=n("nuS9"),s=n("93Ls"),o=n("kGA3"),c=n("VnpK"),l=n("S2mk"),u=n("DRVD"),d=n.n(u),p=n("SZCI"),h=n("SAYH"),g=n("504W"),m=n("arV0"),b=n("xHmU"),y=n("i1f0"),f=n("lEFU"),S=n("Z/4N"),v=n("5ZBI"),C=n("dHD5"),O=n("jRy5"),_=n("odYE"),I=n("bT7G"),j=n("pnQK"),P=n("OtHk"),F=n("3/02"),T=n("Lyxw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const w="CustomControlFramework.Selectors.CustomControlHostContextTokenSelectors";function E(){let e=null,t=null,n=null;return(r,i)=>{v.a.info(i.controlId+"."+w+": createGetContextTokenSelector started");const a=i.parentContextToken,s=i.contextString,o=function(e,t){const n=t.parentContextToken,r=t.contextString;let i;const a=t.configuration,s=Object(S.e)(e,t.configuration.CustomControlId);if(Object(T.c)(e,F.J)&&Object(c.s)(s)&&function e(t,n){if(!n)return!1;if(n.contextTokenType===O.a.UnboundForm&&n.formId)return!(!Object(j.a)(t,n.formId)&&!Object(P.a)(t,n.formId));return e(t,n.parentContextToken)}(e,n))return i=C.p(n.parentContextToken,t.controlId),i;if("default"===r&&Object(c.s)(s)&&!Object(c.r)(t.configuration.Parameters)||Object(c.r)(t.configuration.Parameters)&&function(e){if(e.indexOf("ClientContextGridControl")>-1||e.indexOf("activeProcessGridControlContainer")>-1||e.indexOf("ManageDuplicatesGrid")>-1||e.indexOf("archivedProcessGridControlContainer")>-1)return!0;return!1}(t.controlId))return i=C.e(n,t.controlId),i;if(!t.formInfo&&a&&a.Parameters&&a.Parameters.value&&"TimelineWall"===a.Parameters.value.Type)return i=C.p(n,t.controlId),i;if(!t.formInfo&&Object(c.t)(t.configuration)){const r=function(e,t){const n=Object(m.g)(e,t.id),r=new _.a(n.entityTypeName,n.id||h.a.EMPTY),i=Object(y.ac)(e,t.id,t.parentContextToken),a=Object(I.d)(e,i,r,t.descriptor.DataFieldName),s=a?a.reference:null;return s?s.etn:Object(c.m)(t.descriptor)}(e,t);return i=C.l(n,t.controlId,r),i}i=n;const o=t.descriptor&&t.descriptor.Relationship;o&&(i=C.m(i,o));return i}(r,i);return(n!==s||x(e,o)||x(t,a))&&(e=o,t=a,n=s),v.a.info(i.controlId+"."+w+": createGetContextTokenSelector finished"),e}}function x(e,t){return e&&t?e.entityTypeName!==t.entityTypeName||e.controlName!==t.controlName||(e.formId&&e.formId.guid)!==(t.formId&&t.formId.guid)||(e.recordId&&e.recordId.guid)!==(t.recordId&&t.recordId.guid)||e.relationshipName!==t.relationshipName:e!==t}var N=n("p8cR"),A=n("P6DH"),k=n("zmL5"),M=n("OKVy"),D=n("FdB0"),R=n("fILV");function B(){let e={},t=!1;return(n,r,i,a,s,o)=>{v.a.info(r.controlId+".CustomControlFramework.Selectors.CustomControlHostPersonalizationInfoSelectors: createGetPersonalizationConfiguration started");const c=Object(m.a)(n,r),l=c&&c.id,u=e&&l&&l.guid&&(!e.recordGuid||e.recordGuid&&l.guid!==e.recordGuid.guid);if(!t||u){const c=Object(k.b)(n,r.id),l=h.a.equals(h.a.tryParse(i.UniqueId),h.a.EMPTY)?r.controlId:i.UniqueId;e=c&&o===M.a?function(e,t,n,r){return{areaType:"dashboard",entityTypeName:null,recordGuid:null,formGuid:n,controlUniqueId:r,viewId:void 0}}(0,0,c,l):c&&o===D.a?function(e,t,n,r){const{entityTypeName:i,recordSetQueryKey:a}=Object(m.a)(e,t);return{areaType:"dialog",entityTypeName:i,formGuid:n,controlUniqueId:r,viewId:a?a.split(",")[1]:void 0}}(n,r,c,l):c?function(e,t,n,r){const{entityTypeName:i,recordSetQueryKey:a,id:s}=Object(m.a)(e,t);return{areaType:"form",entityTypeName:i,recordGuid:s,formGuid:n,controlUniqueId:r,viewId:a?a.split(",")[1]:void 0}}(n,r,c,l):o===R.a?function(e,t,n,r){const i=Object(A.cb)(e,r,t);return{areaType:"grid",entityTypeName:n,viewId:i?i.split(",")[1]:void 0}}(n,r,a.entityTypeName,s):{areaType:null,entityTypeName:null,controlUniqueId:l,viewId:void 0},t=!0}return v.a.info(r.controlId+".CustomControlFramework.Selectors.CustomControlHostPersonalizationInfoSelectors: createGetPersonalizationConfiguration finished"),e}}var L=n("q6Ks"),V=n("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function z(e,t,n,r,i){const a=Object(V.a)(e,t),s=i?"__hiddenCommandManagerIds":"__pendingCommandManagerIds",o=Object(C.v)(r);return a&&a[s]&&a[s][o]&&a[s][o][n]?a[s][o][n]:null}var H=n("GT4X"),G=n("tJ+6"),W=n("cfbi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const U=d.a.createEvent("CustomControlHostSelectors.mapStateToProps",p.c);var q=n("r/9v"),X=n("OmkB"),Y=n("tOh6"),K=n("BJ7u"),Q=n("5DN6"),Z=n("iZ7K"),J=n("lY/Z"),$=n("Lohl"),ee=n("y60j"),te=n("XlXz");function ne(e,t){return{type:te.a,payload:e,meta:{pageId:t}}}function re(e){return{type:"execute.cleanreferencepanelstate.async",execute:({dispatch:t,getState:n},r)=>(t(function(e){return{type:te.b,payload:{},meta:{pageId:e}}}(e)),Promise.resolve())}}function ie(e){return{type:"execute.closeallsessiontabs.async",execute({dispatch:t,getState:n},r){const i=n();return t(function(e,t){return{type:te.c,payload:e,meta:{pageId:t}}}({sessionTabs:[],activeTabId:Object(Q.b)(i,e)},e)),Promise.resolve()}}}function ae(e,t){return{type:"execute.closesessiontab.async",execute({dispatch:n,getState:r},i){const a=r(),s=Object(Q.d)(a,t),o=Object(Q.a)(a,e,t);return s.splice(e,1),n(function(e,t){return{type:te.d,payload:e,meta:{pageId:t}}}({sessionTabs:s,activeTabId:o},t)),Promise.resolve()}}}function se(e){return{type:"execute.dismissmessage.async",execute:({dispatch:t,getState:n},r)=>(t(function(e,t){return{type:te.e,payload:{referencePanelState:t},meta:{pageId:e}}}(e,{messageId:""})),Promise.resolve())}}function oe(e,t){return{type:"execute.initializereferencepanelcontrol.async",execute({dispatch:n,getState:r},i){const a=Object(Q.c)(r(),t);if(e&&!(a.activeTabId&&a.controlNames.length>0))return n(function(e,t){return{type:te.f,payload:e,meta:{pageId:t}}}({controlNames:e.map(e=>e.Name),activeTabId:e[0].Id},t)),Promise.resolve()}}}var ce=n("SWZ5");function le(e,t){return{type:"execute.addsessiontab.async",execute({dispatch:n,getState:r},i){const a=Object(Q.d)(r(),t),s=[];for(let t=0;t<a.length;t++)a[t].id===e.id?s.push(e):s.push(a[t]);return n(function(e,t){return{type:te.h,payload:e,meta:{pageId:t}}}({sessionTabs:s},t)),Promise.resolve()}}}var ue=n("IaGr"),de=n("1kth");var pe=n("Or4W"),he=n("BMZr"),ge=n("uPT+"),me=n("mIxf"),be=n("sX6v"),ye=n("WY/A"),fe=n("JP46"),Se=n("Dea/");var ve=n("ghNp"),Ce=n("yRo8"),Oe=n("oOvK"),_e=n("FZDd"),Ie=n("HfZT"),je=n("6Qf/"),Pe=n("a72m"),Fe=n("YYhu"),Te=n("Tf+h"),we=n("ZUzm"),Ee=n("0uKS"),xe=n("lIi+"),Ne=n("lYcl"),Ae=n("4fxQ"),ke=n("VCkP");var Me=n("DU8S");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class De{constructor(e,t){this.Target=e,this.FieldName=t}getMetadata(){return{boundParameter:null,operationName:"CalculateRollupField",operationType:1,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},FieldName:{typeName:"Edm.String",structuralProperty:1}}}}}var Re=n("srnJ"),Be=n("UR8A"),Le=n("j6Db");var Ve=n("NjDY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var ze=n("969l"),He=n("EY5k"),Ge=n("YxC/");var We=n("VpHT");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ue(e,t){return{type:"customcontrol.loadresources.async",execute:({dispatch:n,getState:r},i)=>function(e,t,n,r){const i=Object(Ve.t)(t);return n.initializeContainerForClientApi(r).then(t=>t.loadWebResources([Object(Ve.a)(i,e)]).then(()=>({container:t,webResourcePath:i})))}(e,r(),i.ScriptManager,t)}}var qe=n("kWiz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Xe=n("Khp3"),Ye=n("3tOH"),Ke=n("Qn2w"),Qe=n("LbMF");var Ze=n("dQnL"),Je=n("d0Pd"),$e=n("0L4T"),et=n("NbYl"),tt=n("NYBK"),nt=n("7fV9"),rt=n("Z+6x"),it=n("Nse0"),at=n("WK+4"),st=n("qwRa"),ot=n("s+OO"),ct=n("7k+e"),lt=n("eXjw"),ut=n("Uv1Y"),dt=n("vNXc"),pt=n("5Oca");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class ht{constructor(e,t,n){this.Target=e,this.Query=t,this.RollupType=n}getMetadata(){return{boundParameter:null,operationName:"Rollup",operationType:1,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},Query:{typeName:"Microsoft.Dynamics.CRM.QueryBase",structuralProperty:2},RollupType:{typeName:"Microsoft.Dynamics.CRM.RollupType",structuralProperty:3,enumProperties:[,{name:"None",value:0},{name:"Related",value:1},{name:"Extended",value:2}]}}}}}var gt=n("sNgR"),mt=n("tHtE"),bt=n("SRlt"),yt=n("fYtF");function ft(e,t=!1){const n=[];return{type:"gridData.retrieve.rollup.async",execute({dispatch:r,getState:i},a){let s=i();const o=e.key,c=dt.a.fromState(e,i),l=Object(pt.u)(s,o,c.pageNumber-1);return l&&(c.pagingCookie=l),n.push({name:yt.a,value:Object(yt.e)(e)}),n.push({name:"isRefresh",value:t}),r(function(e,t,n=!1){const r={lists:{[e]:{initialized:n?lt.a.Refreshing:lt.a.Initializing,pageSize:t}}};return{type:"gridData.retrieve.rollup",payload:r}}(o,c.pageSize,t)),function(e,t,n){return n.toQueryExpression(e,t).then(r=>t(Object(gt.b)(new ht(_.a.toExternalEntityReference(n.target),r,n.rollupType))).then(r=>Object(bt.g)(r).then(r=>function(e,t,n,r){const i=n.getKeyQuery(),a=Object(mt.e)(i),s=Object(_e.e)(a.entity2AttributesMap);return t(s).then(()=>{const t=e();return Object(mt.a)(t,i,a,r)})}(e,t,n,r))))}(i,r,c).then(e=>{s=i(),r(Object(Ie.e)(s,r,o,c,e))}).catch(e=>{Object(ut.b)(e)})},getFailureParameters:(e,t)=>n,getSuccessParameters:(e,t,r)=>n}}var St=n("fREn"),vt=n("ngeo"),Ct=n("xorU");function Ot(e,t,n,r,i){let a="",s="";if(r&&r.message&&(a=r.message),r&&r.errorCode){const o=i||Le.a,c=e=>(n.EventManager.ReportComponentFailure(o,e,null,[{name:"hexErrorCode",value:s},{name:"errorStatus",value:JSON.stringify(r)},{name:"customControlId",value:i},{name:"APIName",value:Le.a+".Actions.RefreshDataSetParameter.getErrorMessage"}]),Promise.resolve(`${s} ${a}`));try{s="0x"+vt.a.getHexErrorCodeFromInt(r.errorCode);const n="Error_Title_"+s,i="Error_Message_"+s,a=`Localized resource strings not found for neither ${n} nor ${i}.  Please add error resources for error code ${s}`,o=e(Object(He.e)([n])).catch(()=>{}),l=e(Object(He.e)([i])).catch(()=>{});return Promise.all([o,l]).then(()=>{const e=Object(Ge.e)(t(),[n,i]),r=Object(Ge.c)(e,n),o=Object(Ge.c)(e,i);let l="";return l=function(e){return"0x8005f211"===(null==e?void 0:e.toLowerCase())}(s)?`${r}${r&&o?": ":""}${o}`:r||o,l?Promise.resolve(`${s} ${l}`):c(a)})}catch(e){return c(e)}}return Promise.resolve(`${s} ${a}`)}function _t(e,t){if(e instanceof nt.a){e.getLatestData().loading=!0,e.setRefreshingStart()}else if(e instanceof rt.a||e instanceof tt.a){const t=e.getLatestData();t&&(t.working=!0,rt.a,e.setWrapperLoadingFlag(!0))}return{type:"customcontrol.refreshDataSetParameter.async",execute({dispatch:n,getState:r},i){if(e instanceof et.a){const a={retrieveGridDataAction:e=>n(Object(Ie.d)(e)),retrieveViewAction:(e,t,r,i)=>n(Object(Pe.a)(e,t,r,i)),retrieveViewSelectorAction:(e,t)=>n(Object(Pe.b)(e,t)),runPreSearch:(e,r,i)=>n(Object(de.W)(t,e,r,i)),runSetAdditionalParams:(e,r,i)=>n(Object(de.X)(t,e,r,i)),refreshCustomDataProviderAction:(e,t,r,i)=>n(Object(it.b)(e,t,r,i)),retreiveChartAction:(e,t,r)=>n(Object(Ze.a)(e,t,r)),retreiveChartDataAction:(e,t,r,i=!0)=>n(Object(Je.a)(e,t,r,i)),updateDataSetChartVisualizationId:(e,t,r)=>n(Object(at.b)(e,t,r)),updateDataSetChartVisualizationType:(e,t,r)=>n(Object(st.b)(e,t,r)),getEntityMetadataAction:(e,t)=>n(Object(_e.f)(e,!1,t)),getLocalizedErrorMessage:(e,t)=>Ot(n,r,i,e,t),updateChartFilterExpression:(e,t,r)=>n(Object(ot.c)(e,t,r)),updateChartDrillDownParameters:(e,t,r)=>n(Object(ct.c)(e,t,r)),updateChartErrorInformation:(e,t,r,i)=>{Object($e.a)(e,n,t,r,i)}};return e.refreshDataSet(r,a,i)}const a={retrieveGridDataAction:e=>Object(g.a)(e.rollupType)?n(Object(Ie.d)(e)):n(ft(e)),retrieveViewAction:(e,t,r,i)=>n(Object(Pe.a)(e,t,r,i)),retrieveViewSelectorAction:(e,t)=>n(Object(Pe.b)(e,t)),runPreSearch:(e,r,i)=>n(Object(de.W)(t,e,r,i)),runSetAdditionalParams:(e,r,i)=>n(Object(de.X)(t,e,r,i)),startCustomFilter:(e,t,r)=>n(Object(Ct.f)(e,t,r)),endCustomFilter:(e,t,r)=>n(Object(Ct.e)(e,t,r)),refreshCustomDataProviderAction:(e,t,r,i)=>n(Object(it.b)(e,t,r,i)),getEntityMetadataAction:(e,t)=>n(Object(_e.f)(e,!1,t)),getLocalizedErrorMessage:e=>Ot(n,r,i,e),getAdditionalResourceStrings:e=>n(Object(He.e)(e)),addCustomViewAction:(e,t,r,i,a,s,o,c)=>n(Object(St.a)(e,t,r,i,a,s,o,c)),setOfflineQueryAction:e=>n(Object(St.b)(e))};return e.refreshDataSet(r,a,i)}}}var It=n("7Sr4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var jt=n("sn0j"),Pt=n("KVHF");var Ft=n("mFPv"),Tt=n("AE7n"),wt=n("pp6D"),Et=n("9i5P");var xt=n("Q1Tc"),Nt=n("jsFU"),At=n("455M");var kt=n("BFlg"),Mt=n("7p56");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Dt(e,t,n){if(n.dataSetUIOptions){const r=e+t.id;let i=t.contextString;switch(t.contextString){case kt.h.ASSOCIATEDGRID:case kt.h.SUBGRID:case kt.h.GRID:break;case kt.h.CUSTOM:default:i=kt.h.CUSTOM}return a.createElement(Mt.a,{key:r,id:t.id,systemDefinedProperties:t.systemDefinedProperties,controlId:t.controlId,configuration:t.configuration,descriptor:t.descriptor,formInfo:t.formInfo,themingData:t.themingData,parentDefinedControlProps:t.parentDefinedControlProps,children:t.children,rowSpan:t.rowSpan,contextString:i,parentContextToken:t.parentContextToken,dataSetUIOptions:n.dataSetUIOptions})}return a.createElement(ln,{key:e,id:t.id,systemDefinedProperties:t.systemDefinedProperties,controlId:t.controlId,configuration:t.configuration,descriptor:t.descriptor,formInfo:t.formInfo,themingData:t.themingData,parentDefinedControlProps:t.parentDefinedControlProps,children:t.children,rowSpan:t.rowSpan,contextString:t.contextString,parentContextToken:t.parentContextToken})}var Rt=n("iWfp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Bt(e){if(!e)return;if(e instanceof _.a)return e;const t=e.entityName||e.LogicalName;let n;return n=h.a.fromLegacyGuid(e.Id),h.a.isNullOrEmpty(n)&&(n=new h.a(e.id||e.Id)),new _.a(t,n,Object(g.a)(e.name)?e.Name:e.name)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Lt(e,t,n,r){return r&&r.DisplayName&&"partylist"!==r.Type&&Object(jt.b)(e,t,n,r)&&r.IsValidForAdvancedFind}var Vt=n("thZs"),zt=n("R5Qn"),Ht=n("E3i9"),Gt=n("KBcj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Wt{convert(e,t,n){const r=(new DOMParser).parseFromString(e,"text/xml"),i=this._firstElementChild(r),a=this._childElements(i);if(!a)return null;const s=[];for(const e of a){const t=[],n=this._childElements(e);for(const e of n)t.push(this._getGridCellDescriptor(e));s.push(this._getGridRowDescriptor(e,t))}const o=this._getGridDescriptor(i,s,n);return this._populateRelationshipInformation(o,t),o}_attributeValueBoolean(e,t){return"1"===this._attributeValueString(e,t,"")}_attributeValueString(e,t,n){const r=e.attributes.getNamedItem(t);return r&&r.value||n}_attributeValueInt(e,t,n){const r=this._attributeValueString(e,t,n+"");return parseInt(r,10)}_childElements(e){if(!e)return null;if(e.children)return Array.from(e.children);if(e.childNodes){return Array.from(e.childNodes).filter(e=>e.nodeType===Node.ELEMENT_NODE).map(e=>e)}return null}_getGridCellDescriptor(e){return{name:this._attributeValueString(e,"name",""),width:this._attributeValueInt(e,"width",0),relatedEntityName:this._attributeValueString(e,"relatedentityname",""),disableMetaDataBinding:this._attributeValueBoolean(e,"disableMetaDataBinding"),labelId:this._attributeValueString(e,"LabelId",""),isHidden:this._attributeValueBoolean(e,"ishidden"),disableSorting:this._attributeValueBoolean(e,"disableSorting"),addedBy:this._attributeValueString(e,"addedby",""),desc:this._attributeValueString(e,"desc",""),cellType:this._attributeValueString(e,"cellType",""),imageProviderWebresource:this._attributeValueString(e,"imageproviderwebresource",""),imageProviderFunctionName:this._attributeValueString(e,"imageproviderfunctionname","")}}_getGridRowDescriptor(e,t){return{name:this._attributeValueString(e,"name",""),id:this._attributeValueString(e,"id",""),cells:t,multiObjectIdField:this._attributeValueString(e,"multiobjectidfield",""),layoutStyle:this._attributeValueString(e,"layoutstyle","")}}_getGridDescriptor(e,t,n){return{name:this._attributeValueString(e,"name",""),object:n,rows:t,customControlDescriptions:null,jump:this._attributeValueString(e,"jump",""),select:this._attributeValueBoolean(e,"select"),icon:this._attributeValueBoolean(e,"icon"),preview:this._attributeValueBoolean(e,"preview"),iconrenderer:this._attributeValueString(e,"iconrenderer","")}}_firstElementChild(e){if(!e)return null;if(e.firstElementChild)return e.firstElementChild;const t=this._childElements(e);return t&&t[0]}_populateRelationshipInformation(e,t){const n=(new DOMParser).parseFromString(t,"text/xml"),r=this._firstElementChild(n),i=this._firstElementChild(r),a=this._childElements(i);if(a)for(const t of a)"link-entity"===t.nodeName&&this._attributeValueString(t,"alias","")&&this._attributeValueString(t,"name","")&&this._setRelatedEntityName(e,this._attributeValueString(t,"alias",""),this._attributeValueString(t,"name",""))}_setRelatedEntityName(e,t,n){for(let r=0;r<e.rows.length;r++)for(let i=0;i<e.rows[r].cells.length;i++){const a=e.rows[r].cells[i].name;(a?a.substring(0,a.indexOf(".")):void 0)===t&&(e.rows[r].cells[i].relatedEntityName=n)}}}var Ut=n("DU5H"),qt=n("fU7K");function Xt(e,t=!1,n,r,i,a,s,o){return{type:"populateAndSend.LookupData.Action",sync:!0,execute({dispatch:c,getState:l},u){const d=l(),p=i||e.LookupEntityByName[0].EntityLogicalName,g=Object(zt.f)(d,p,s,r),b=[];if(o){const t=o.split("."),i=Object(m.g)(d,r);let a;const s=Object(y.ac)(d,r,n),c=Object(I.b)(d,s);a=c&&c.activeChanges&&c.activeChanges[t[1]]?c.activeChanges[t[1]]:Object(pt.j)(d,new _.a(t[0],i.id),t[1]),e.RelatedRecordId=a&&a.reference&&a.reference.id}if(e.LookupEntityByName&&e.LookupEntityByName.length){const t=Object(y.eb)(d,r,n),i=t&&t[a];for(const t of e.LookupEntityByName){const e=Object(Ut.b)(d,r,n,a,t.EntityLogicalName);if(e&&(t.CustomFilter=Object(qt.CrmHtmlDecode)(e).replace(/"/g,"'")),g){const e=Object(Ht.a)(d,g,t.EntityLogicalName);e&&e.view&&(h.a.equals(e.view.viewId,t.ViewId)||Object(Gt.c)(d,t.ViewId))||b.push(c(Object(Pe.a)(t.EntityLogicalName,null,null,t.ViewId)))}const s=i&&i.parameters&&i.parameters.defaultviewid;if(i&&i.views&&i.views[s]&&i.views[s].entityLogicalName===t.EntityLogicalName){t.ViewId=null,t.FetchXml=i.views[s].fetchXML.replace(/"/g,"'");const e=Object(Z.h)(d,t.EntityLogicalName),n=new Wt;t.LayoutJson=JSON.stringify(n.convert(i.views[s].layoutXML,i.views[s].fetchXML,e.ObjectTypeCode)).replace(/"/g,"'")}}}const f=Object(Vt.b)(d,p,e),S=Object(pt.o)(d,f);t=t||S===lt.a.Initialized,b.push(c(Object(Vt.d)(e,t)));const v=function(e,t,n,r,i){const a={};let s=r||n.EntityAndAttribute&&n.EntityAndAttribute.EntityName;const o=i||n.EntityAndAttribute&&n.EntityAndAttribute.AttributeName;if(!s&&!o)return null;s||(s="placeholderEtn");if(n.LookupEntityByName)for(const t of n.LookupEntityByName)a[t.EntityLogicalName]=Object(Vt.b)(e,t.EntityLogicalName,n);const c=Object(Vt.c)(e,n);return{type:"update.lookupRequestDataKey",payload:{[s]:{[o]:{metadataKey:c,dataKeys:a}}},meta:{pageId:t}}}(d,r,e,i,s);return v&&c(v),Promise.all(b)}}}var Yt=n("mpSO"),Kt=n("F1Lu");var Qt=n("+pAH"),Zt=n("wZxB");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let Jt,$t,en,tn;function nn(e,t){return{openEditForm:(n,r,i,a,s)=>{const o=Bt(n);e(r?Object(we.a)(o,t.id,void 0,void 0,r,i,a,s):Object(we.a)(o,t.id))},openGridPage:(n,r,i,a,s,o,c,l)=>{e(Object(Ee.a)(n,t.id,h.a.tryParseOrNull(r),i,a,h.a.tryParseOrNull(s),o,null,l,c))},openCreateForm:(n,r,i)=>{e(Object($.b)(new _.a(n),null,"QuickCreate")).then(a=>{e(Object(he.b)(n,t.id,null,r,Bt(i)))}).catch(i=>{e(Object(we.a)(new _.a(n),t.id,void 0,r))})},openSearch:n=>{e(Object(Ne.a)(n,null,t.id))},openPowerBIFullScreenPage:(n,r,i,a,s,o,c)=>{e(Object(xe.a)(t.id,n,r,i,a,s,o,c))},openDashboard:e=>{},openUrl:(e,t)=>{},openUrlWithProtocol:(e,t)=>{},openPhoneNumber:(n,r,i,a,s,o,c,l,u,d=!1,p=!0)=>e(function(e,t,n,r,i,a,s,o,c,l,u=!1,d=!0){return{type:"customcontrol.openphonecall",execute(p,g){let m=e.trim();const b=Object(Ve.x)(p.getState()).defaultCountryCode;0!==m.indexOf("tel:")?(b&&(m=b+m),m="tel:"+m):b&&(m=m.slice(0,4)+b+m.slice(4));const y=new Kt.a(g,p);let f;g.ScriptManager.containerExists(Yt.d)&&(f=g.GlobalCustomEventManager);const S=()=>{if(u){let c=null;const l={};if(t){c=new _.a(n,new h.a(t));const i={id:t,entityType:n,name:r};let u=i;a&&(u={id:a,entityType:s,name:o}),l.contactinfo=e,l.to=[i],l.regardingobjectid=u}return p.dispatch(Object(he.b)("phonecall",i,null,l,c,null,{entityName:"phonecall",showDialog:!0}))}};return y.canOpenUri(m).then(e=>{if(d&&f&&p.dispatch(f.runOnOpenUrl(i,m,l,c)))return null;const t=Object(T.c)(p.getState(),F.C);e?(y.openUri(m),t&&S()):u&&t&&S()},()=>null)},shouldReceiveFullStore:!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(n,i,r,a,t.id,o,s,c,l,u,d,p)),openMaps:e=>{},openMap:e=>{}}}var rn=n("Ki7F"),an=n("nJrx"),sn=n("o0iw"),on=n("llMO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const cn=Object(r.a)(()=>{let e,t={},n=null,r={},i={},a={},s=!1,o="",u=null,d={},p=!1,C="",O=!1,_={stateToPropsMappingError:!1,dynamicData:null,manifest:null,personalizationState:null,propBagData:null,pageType:null,popupStack:null,contextToken:null,portalFlyoutToDialogId:null,designLanguage:null,inactive:!1},I=-1,j=-1;const P=Object(N.a)(),F=Object(L.a)(),T=B(),w=E();return(E,x)=>{v.a.info(x.configuration.CustomControlId+".CustomControlFramework.Selectors.CustomControlHostSelectors: makeMapStateToProps started");const N=U.startStopwatch({controlId:x.controlId,parentId:Object(c.p)(x),level:(0).toString()});let A,k,M,D,R,B=[],L=!1,V=null,q=null,X=null,Y=null,K=null,Q=null,Z=null,J=null,$=null,ee=null,te=!1,ne=null,re=null,ie=null,ae=!1;try{let e=null;x.formInfo?(u&&d.EntityName===x.formInfo.EntityName&&d.RecordId===x.formInfo.RecordId&&d.FormId===x.formInfo.FormId||(u={id:x.formInfo.RecordId?new h.a(x.formInfo.RecordId):null,formId:x.formInfo.FormId?new h.a(x.formInfo.FormId):null,entityTypeName:x.formInfo.EntityName},d=x.formInfo),e=u):e=Object(m.g)(E,x.id),q=x.descriptor,X=x.configuration,M=Object(b.b)(E),A=Object(m.l)(E,x.id),Object(m.f)(E,x.id)&&(R="DialogContainer__"+x.id),!R&&x.parentDefinedControlProps&&x.parentDefinedControlProps.parentFlyoutId&&(R=x.parentDefinedControlProps.parentFlyoutId),A&&(k=w(E,x));const t=Object(y.kb)(E,x,k);let n=X;if(null!==x.systemDefinedProperties){const e=Object.assign(Object.assign({},X.Parameters),x.systemDefinedProperties);n=Object.assign(Object.assign({},X),{Parameters:e})}if(Y=Object(S.e)(E,X.CustomControlId)||Object(S.e)(E,X.Name),!Y||!Y.ConstructorName){Y=null;const e=Object(l.h)(X.CustomControlId);e!==X.CustomControlId&&(Y=Object(S.e)(E,e))}Y&&(J=F(E,Y,e,t,x.contextHelper),Z=J.response,Q=P(n,q,x,E,e,k),K=Q.response,ee=K&&K.dataReady?T(E,x,q,e,k,A):null,$=Object(f.a)(E,ee,Y.CustomControlId,x.id));const r=z(E,x.id,x.controlId,k);r&&(te=r.every(e=>Object(H.b)(E,e))),D=z(E,x.id,x.controlId,k,!0),re=x.parentDefinedControlProps&&!Object(g.a)(x.parentDefinedControlProps.height)?x.parentDefinedControlProps.height:-1,ne=x.parentDefinedControlProps&&!Object(g.a)(x.parentDefinedControlProps.width)?x.parentDefinedControlProps.width:-1,ie=Object(G.b)(E)?Object(G.a)(E):null,ae=((e,t,n,r)=>Object(m.l)(e,t)===W.a&&!Object(y.Fb)(e,t,n,r))(E,x.id,k,x.descriptor.Name)}catch(e){const t=Y.ConstructorName;v.a.error(t+": makeMapStateToProps encountered error, err "+e,[{name:"ApiName",value:"CustomControlFramework.Selectors.CustomControlHostSelectors"},{name:"controlId",value:x.controlId},{name:"customControlId",value:Y.CustomControlId},{name:"manifest",value:JSON.stringify(Y)},{name:"descriptor",value:JSON.stringify(q)},{name:"configuration",value:JSON.stringify(X)},{name:"error.Stack",value:JSON.stringify(e.stack)}]),L=!0,V=e.toString()+". Stack: "+e.Stack}return n&&(B=B.concat(((e,t)=>{const n=[];return e.Disabled!==t.Disabled&&n.push("IsControlDisabled"),e.Label!==t.Label&&n.push("Label"),n})(q,n))),n=x.descriptor,K!==r||Y!==t||Z!==i||ee!==a||L!==s||A!==o||te!==p||D!==e||re!==j||ne!==I||R!==C||ie!==_.designLanguage||ae!==O?(re===j&&ne===I||B.push("layout"),Q&&(B=B.concat(Q.updatedProperties)),J&&(B=B.concat(J.updatedProperties)),ie!==_.designLanguage&&B.push("design"),_={stateToPropsMappingError:L,stateToPropsMappingErrorMessage:V,dynamicData:K,manifest:Y,personalizationState:$,propBagData:Z,children:X&&X.Children,personalizationConfiguration:ee,pageType:A,popupStack:M,contextToken:k,updatedProperties:B,globalCommandManagerInitialized:te,internalCommandManagerIds:D,portalFlyoutToDialogId:R,designLanguage:ie,inactive:ae},p=te,e=D,C=R,s=L,i=Z,t=Y,r=K,a=ee,o=A,j=re,I=ne,O=ae):_.updatedProperties=B,N({updatedProperties:JSON.stringify(B)}),v.a.info(x.configuration.CustomControlId+".CustomControlFramework.Selectors.CustomControlHostSelectors: makeMapStateToProps finished"),_}},(function(){let e;return function(t,n){if(e)return e;const r=nn(t,n);return Jt={setNotification:(e,n,r,i,a,s,o)=>t(function(e,t,n,r,i,a,s){return{type:"customcontrol.propertybag.mode.setnotification",execute({dispatch:o,getState:c},l){const u={uniqueId:t||"",messages:[e],priority:0,notificationLevel:Ye.a.error,actions:[{actions:[function(){}],message:""}]};o(Object(Xe.b)(n,r,u,i));const d=c(),p=new _.a(a,h.a.fromExternalGuid(s)),g=Object(Qe.a)(d,p.etn,r);return p&&g&&(2===g.RequiredLevel||1===g.RequiredLevel)&&o(Object(Ke.b)(n,r,!1,i)),!0},sync:!0}}(e,n,r,i,a,s,o)),clearNotification:(e,n,r,i,a,s)=>t(function(e,t,n,r,i,a){return{type:"customcontrol.propertybag.mode.clearnotification",execute({dispatch:r,getState:i},s){const o=Object(y.A)(i(),{controlName:t,id:e},n);if(o){a=a||"";const i=Object.keys(o);let s=null;for(let c=i.length-1;c>-1;--c)i[c]===a&&(s=o[i[c]],s.actions=null,s.messages=null,s.notificationLevel=null,r(Object(Xe.b)(e,t,s,n)))}return!0},sync:!0}}(e,n,r,0,0,s))},en={setState:e=>!0,logMessage:(e,n,r)=>{t(function(e,t,n){return{type:"customcontrol.log",execute({dispatch:r,getState:i},a){const s=a.TraceManager.getTracer("customcontrol"),o=e+": "+t;switch(n){case qe.a.Error:s.error(o);break;case qe.a.Info:s.info(o);break;case qe.a.Warning:s.warn(o);break;case qe.a.Verbose:s.debug(o)}},sync:!0}}(e,n,r))}},$t={isGetBarcodeValueOperationAvailable:()=>t(Object(Me.c)()),isTakePictureOperationAvailable:()=>t(Object(Me.e)()),isCaptureVideoOperationAvailable:()=>t(Object(Me.b)()),isCaptureAudioOperationAvailable:()=>t(Object(Me.a)()),isOpenARViewerAvailable:()=>t(Object(Me.d)())},tn={clearNestedChild:e=>!0,createAccessibilityComponent:Rt.a,createCommandManagerUXComponent:()=>{let e=null;return t=>{const n=dn(t);return hn(e,t.selectedRecords)?n.selectedRecords=e:e=n.selectedRecords,un(n)}},createKeyboardShortcut:Rt.b,createXrmForm:(e,n,r,i)=>function(e,t,n,r,i){return!!e(Object(wt.b)(t,n,r,new h.a(i)))}(t,e,n,r,i),createXrmGrid:(e,n,r,i)=>{const a=[O.a.AssociatedGrid,O.a.CustomGrid,O.a.SubGrid,O.a.MainGrid];if(e&&-1===a.indexOf(e.contextTokenType))for(const i in r)if("Grid"===r[i].Type){const a=r[i];t(Object(je.c)(a.TargetEntityType||a.EntityName,a.ViewId,n,e));break}return function(e,t,n,r,i){const a=Object(A.vb)(r);if(t){let r;switch(t.contextTokenType){case O.a.SubGrid:r=3;break;case O.a.AssociatedGrid:r=2;break;case O.a.MainGrid:case O.a.CustomGrid:r=1;break;default:const e=[{name:"contextToken",value:JSON.stringify(t)},{name:"controlName",value:i},{name:"isEditableGrid",value:a}];ue.a.getInstance().eventManager.ReportComponentFailure("ClientApi.XrmCommandObjectWrapper.createXrmGridWrapper",new Error("Unknown context token type for grid"),null,e),r=1}return!!e(Object(wt.c)(t,n,a,r,i))}return!0}(t,e,n,r,i)},registerNewControl:(e,n,r,i)=>function(e,t,n,r,i){return!!e(Object(wt.e)(t,n,r,i))}(t,e,n,r,i),executeAddOnLoad:(e,n)=>{t(function(e,t){return{type:"customcontrol.executeAddOnLoad.async",sync:!0,execute({dispatch:n,getState:r},i){e.gridRunOnLoad((e,r,a)=>{if(i.ScriptManager.containerExists(e)){const s=i.ScriptManager.getContainer(e).getEventManager();n(s.runOnGridDataLoad(t,1,a,r))}})}}}(e,n))},addSessionTab:(e,n)=>t(function(e,t){return{type:"execute.addsessiontab.async",execute({dispatch:n,getState:r},i){const a=r(),s=Object(Q.d)(a,t);let o=!0;if(e){if(s.forEach(t=>{e.id===t.id&&(o=!1)}),o){if("quickViewFormTab"===e.type){let r=!1;const i=e,o=Object(K.a)(6),c=Object(Z.E)(a,i.entityFormOptions.entityName),l="activitypointer";let u;u=a.data.entities[l]&&a.data.entities[l].hasOwnProperty(i.entityFormOptions.entityId)?Object(y.ec)(a,l,new h.a(i.entityFormOptions.entityId)):Object(y.ec)(a,i.entityFormOptions.entityName,new h.a(i.entityFormOptions.entityId));const d=new _.a(i.entityFormOptions.entityName,new h.a(i.entityFormOptions.entityId)),p=[];if(!u){const e=n(Object(J.d)(d,[c]));p.push(e)}let g=Object(ee.h)(a,i.entityFormOptions.entityName,o);if(h.a.isNullOrEmpty(g)){const e=n(Object($.b)(d,null,o)).then(e=>{g=e,h.a.isNullOrEmpty(g)||g===$.a||(r=!0)});p.push(e)}else r=!0,i.entityFormOptions.formId=g.guid;Promise.all(p).then(()=>{i.entityFormOptions.formId=r?g.guid:"",i.entityMetadata={DisplayName:a.metadata.entities[i.entityFormOptions.entityName].DisplayName},a.data.entities[l]&&a.data.entities[l].hasOwnProperty(i.entityFormOptions.entityId)?i.title=Object(y.ec)(a,l,new h.a(i.entityFormOptions.entityId)):i.title=Object(y.ec)(a,i.entityFormOptions.entityName,new h.a(i.entityFormOptions.entityId)),s.unshift(i),n(ne({sessionTabs:s,activeTabId:i.id,messageId:r?"":"quick_view_form_not_exist_message"},t))})}else s.unshift(e),n(ne({sessionTabs:s,activeTabId:e.id},t));return Promise.resolve()}n(ne({sessionTabs:s,activeTabId:e.id},t))}}}}(e,n)),closeSessionTab:(e,n)=>t(ae(e,n)),updateSessionTab:(e,n)=>t(le(e,n)),closeAllSessionTabs:e=>t(ie(e)),dismissMessage:e=>t(se(e)),markActiveTab:(e,n,r)=>t(Object(ce.b)(e,n,r)),initializeReferencePanelControl:(e,n)=>t(oe(e,n)),cleanReferencePanelState:e=>t(re(e)),executeNotifyHandlersThatEventOccurred:e=>t(function(e){return{type:"execute.notifyhandlersthatevenoccurred.async",execute({dispatch:t,getState:n},r){let i=null;try{switch(e.eventName){case"onresultopened":t(Object(de.U)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onselection":t(Object(de.V)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onpostsearch":t(Object(de.S)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onlookuptagclick":const a="ClientApi.ExecuteNotifyHandlersThatEventOccurred.runOnLookupTagClick",s=e.contextToken,o=e.fieldName,c=e.record;let l=!1;const u=Object(de.u)(a,n(),r,e.pageId,c);u&&(l=t(u.runOnLookupTagClick(s,o,null,c,n()))),i=l}return Promise.resolve(i)}catch(e){throw ue.a.getInstance().eventManager.ReportComponentFailure("ClientApi.ExecuteNotifyHandlersThatEventOccurred.executeNotifyHandlersThatEventOccurred",e),e}}}}(e)),getConnectorsApi:e=>null,executeRollupRequest:(e,n,r)=>t(function(e,t,n){return{type:"customcontrol.executeRollupRequest.async",execute({dispatch:r,getState:i},a){if(e&&t){const i=new De(e,t),s=Be.a.execute(i).then(e=>e.json()).then(i=>{if(i){const s=[];for(const e in i)-1!==e.indexOf("@")||e.startsWith("_")||s.push(e);const o=new _.a(e.entityType,h.a.fromExternalGuid(e.id));return r(Object(Re.a)(n,o,s)).then(()=>{a.EventManager.ReportComponentSuccess(Le.a+".Action",[{name:"APIName",value:Le.a+".Action.ExecuteRollupRequest"},{name:"target.entityType",value:e.entityType}])},n=>{a.EventManager.ReportComponentFailure(Le.a+".Actions",n,"refreshRecordData failure error message",[{name:"APIName",value:Le.a+".Actions.ExecuteRollupRequest"},{name:"target.entityType",value:e.entityType},{name:"target.id",value:e.id},{name:"fieldName",value:t},{name:"jsonResponse",value:i}])})}});return Be.a.Diagnostics.traceInfo(Le.a+".refreshRecordData","refresh record data return promise"),s}return Promise.resolve()}}}(e,n,r)),getResource:e=>t(function(e){return{type:"customcontrol.getresources.async",execute({dispatch:t,getState:n},r){const i=r.AssetLoader,a=n(),s=Object(Ve.t)(a);if(3===e.Type||2===e.Type)return i.loadRawData(s+e.Name)}}}(e)),getRecordSetQueryKey:e=>e?e.getPreviousQueryKey():null,loadResources:e=>t(Object(We.a)(e)),triggerOfflineMetadataSync:()=>t(Object(Ce.h)()),retrieveFormWithAttributes:(e,n,r)=>t(Object(jt.c)(new _.a(e),h.a.tryParse(n),r)),loadManifest:(e,n)=>t(Object(Oe.c)(e,n)),updateOutputs:(e,n,r,i,a,s,o)=>t(function(e,t,n,r,i,a,s){return{type:"outputs.update",execute({dispatch:o,getState:c},l){try{const l={},u={};if(a)for(const e of Object.keys(a)){const t=a[e];let n=e;switch(t.fieldName&&(n=t.fieldName),(t.paramType===At.a.LookupSimple||t.paramType===At.a.LookupCustomer||t.paramType===At.a.LookupOwner||t.paramType===At.a.LookupRegarding||t.paramType===At.a.LookupMultiEntity)&&t.value&&t.value instanceof Array&&(t.value.length>0?t.value=t.value[0]:t.value=null),t.type){case 0:l[n]=a[e];break;case 2:u[n]=a[e]}}const d=new Array,p=o(Object(me.a)(e,l,!1,!1,t,n,i,s));if(d.push(p),Object(V.a)(c(),e).forms){const t=o(Object(xt.b)(e,r,s,u));d.push(t)}else{const t=o(Object(Nt.b)(e,r,u));d.push(t)}return Promise.all(d)}catch(i){const s=r+" failed at updating its outputs",o=Object(v.b)(c(),r);return l.EventManager.ReportComponentFailure(o+".CustomControl.updateOutputs",i,s,[{name:"APIName",value:Le.a+".Actions.UpdateOutputs"},{name:"customControlId",value:r},{name:"pageId",value:e},{name:"entityTypeName",value:t},{name:"recordId",value:n},{name:"outputs",value:JSON.stringify(a)}]),l.TraceManager.getTracer("customcontrol").warn(o+" failed at updating its outputs"),null}},sync:!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,n,r,i,a,s,o)),updateFieldValue:(e,n,r,i,a,s,o)=>t(Object(me.a)(e,n,!1,r,i,a,s,o)),runCustomOpenRecord:(e,n,r,i)=>t(function(e,t,n,r){return{type:"record.open",execute(i,a){const s=a.ScriptManager.getContainer(e).getEventManager(),o=new h.a(n),c=Object(C.f)(r,o,t);let l=i.dispatch(Object(wt.b)(c,e,t,o));return l=new Et.a(i,a,c,e,t,o),i.dispatch(s.runOnRecordOpen(r,n,l))}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,n,r,i)),getBoundFileObject:(e,n,r,i)=>{if(null==e||null==n||null==n.id||null==r)return null;const a={id:new h.a(n.id),etn:n.entityType};return t(Object(Qt.c)(e,a,r,i,"full"))},saveEmbeddedEntity:(e,n,r,i,a,s,o=!1,c)=>t(Object(Tt.a)(e,n,r,i,a,s,o,c)),renderNestedCustomControl:Dt,renderReactSubtree:Ae.createPortal,retrieveView:(e,n,r,i)=>t(Object(Pe.a)(e,n,r,i)),retrieveViewSelector:(e,n)=>t(Object(Pe.b)(e,n)),retrieveGridData:e=>t(Object(Ie.d)(e)),retrieveRecordDataForForm:(e,n,r,i,a)=>t(Object(J.e)(Bt(e),h.a.tryParse(n),r,i,a)),retrieveForm:(e,n,r)=>{const i=h.a.tryParse(n),a=Bt(e);return t(Object($.b)(a,i,r)).then(e=>t(Object(pe.c)(i,a.etn)).then(()=>e))},retrieveEntityData:e=>t(Object(_e.f)(e,!1,[])),retrieveChartDrilldownAttributes:e=>{return t((n=e,{type:"customcontrol.charts.attributes.retrieve.async",execute:({dispatch:e,getState:t},r)=>e(Object(_e.f)(n,!0,[])).then(()=>{const e=t(),r=Object(Qe.d)(e,n);if(r&&Object.keys(r).length>0){const t={};for(const i in r){const a=r[i];Lt(e,n,i,a)&&(t[i]=a)}return t}return null},e=>{const t=e.get_message();return r.EventManager.ReportComponentFailure(Le.a+".CustomControl.retrieveChartDrilldownAttributes",new Error(t),t,[{name:"APIName",value:Le.a+".Actions.RetrieveChartDrilldownAttributes"},{name:"Entity",value:n}]),null})}));var n},refreshDataSetParameter:(e,n)=>t(_t(e,n)),retrieveLookupMetadataAction:e=>{return t((n=e,{type:"customcontrol.retrieveLookupMetaData.async",execute({dispatch:e,getState:t},r){if(n instanceof Pt.a){const r={retrieveGridDataAction:t=>e(Object(Ie.d)(t)),retrieveViewAction:(t,n,r,i)=>e(Object(Pe.a)(t,n,r,i)),retrieveViewSelectorAction:(t,n)=>e(Object(Pe.b)(t,n)),runPreSearch:(n,r,i)=>e(Object(de.W)(Object(C.j)(t(),n),n,r,i)),runSetAdditionalParams:(n,r,i)=>e(Object(de.X)(Object(C.j)(t(),n),n,r,i)),refreshCustomDataProviderAction:(t,n,r,i)=>e(Object(it.b)(t,n,r,i)),getEntityMetadataAction:(t,n)=>e(Object(_e.f)(t,!1,n))};return n.retrieveLookupMetadata(t,r)}}}));var n},retrieveDataSetLookupCellParameter:(e,n,r)=>t(function(e,t,n){return{type:"customcontrol.retrieveDataSetLookupCellParameter.async",execute:({dispatch:r,getState:i},a)=>r(_t(t,n)).then(()=>{const n=t.retrieveDataSetObject(i(),e,a);return Promise.resolve(n)}).catch(e=>{a.EventManager.ReportComponentFailure(Le.a+".Actions",{name:"error",message:e.get_message()},null,[{name:"APIName",value:Le.a+".Actions.RetrieveDataSetLookupCellParameter"}])})}}(e,n,r)),updateControlMemoizedDataSet:(e,n,r)=>t(function(e,t,n){return{type:"customcontrol.updateControlMemoizedDataSet",sync:!0,execute({dispatch:r,getState:i},a){const s=i(),o=e.retrieveDataSetObject(s,null,null,null,a);e.linkToParameter(o,t),e.updateControlMemoizedParameter(s,o,!0,n)}}}(e,n,r)),loadResourceStrings:e=>{return t((n=e,{type:"customcontrol.loadresourcestrings.async",execute({dispatch:e,getState:t},r){const i=n.CustomControlId;if(!i)return Promise.resolve();const a=t(),s=ze.a.getControlsResourceKeyList(i);if(!s)return Promise.resolve();const o=Object(Ge.d)(a);if(!o)return e(Object(He.e)(s));const c=[];for(const e of s)o.hasOwnProperty(e)||c.push(e);return 0===c.length?Promise.resolve():e(Object(He.e)(c))}}));var n},retrieveLookupData:e=>t(Object(Ie.d)(e)),setFieldControlPersonalization:(e,n,r)=>t(Object(Te.j)(e,n,r)),setGridControlPersonalization:(e,n,r)=>t(Object(Te.m)(e,n,r)),setDashboardControlPersonalization:(e,n,r)=>t(Object(Te.i)(e,n,r)),setGenericControlPersonalization:(e,n,r)=>t(Object(Te.k)(e,n,r)),setGlobalControlPersonalization:(e,n)=>t(Object(Te.l)(e,n)),setPowerBISignedInState:(e,n)=>t(Object(ge.b)(e,n)),beginSecureSessionForResource:(e,n,r,i)=>t(function(e,t,n,r){return{type:"customcontrol.beginsecuresessionforresource",execute(i,a){const s=new ke.a(a,i);return r?s.beginSecureSessionForResource(e,t,n):s.beginSecureSessionForResourceSilent(e,t,n)},shouldReceiveFullStore:!0}}(e,n,r,i)),setXrmObject:e=>{},addPendingCommandManagerId:(e,n,r,i)=>{let a;t(Object(Ft.a)(e,n,r,i));return{promise:new Promise(e=>{a=e}),resolve:a}},initializeCommandManager:(e,n,r,i,a)=>{let s;t(Object(Ft.b)(e,n,r,i,a));return{promise:new Promise(e=>{s=e}),resolve:s}},retrieveRecordCommand:(e,n,r,i,a,s,o,c,l,u)=>t(Object(Ft.c)(u,e,n,r,i,a,s,o,c,l)),setValue:(e,n,r,i)=>e&&n?t(function(e,t,n,r){const i=[{name:"snapshotId",value:r},{name:"entityTypeName",value:t.etn},{name:"attributeNameValuePairs.length",value:n?Object.keys(n).length:null}];return{type:"control.update.value.by.snapshot.async",execute({dispatch:a,getState:s},o,c){const l=s(),u=Object(C.j)(l,e),d=Object(C.x)(u),p=Object(fe.a)(l,r,t,n,!1,u,o.TraceManager.getTracer("Forms.UpdateValue")),g=h.a.isNullOrEmpty(t.id)?Se.a.Create:Se.a.Update;if(i.push({name:"CorrelationId",value:c.correlationId},{name:"ContextId",value:c.contextId},{name:"ActionStack",value:c.stack},{name:"mode",value:g}),r)return a(Object(be.b)(l,r,p)),o.EventManager.ReportComponentSuccess("Forms.UpdateValue.updateDataSnapshot",i),Promise.resolve();const m=Object(ye.b)(l,t,p,d,g),b=m.payload.snapshotId;return a(m),i.push({name:"newSnapshotId",value:b}),o.EventManager.ReportComponentSuccess("Forms.UpdateValue.createDataSnapshotAction",i),Promise.resolve(b)},getFailureParameters:(e,t)=>i}}(i,e,n,r)).then(e=>Promise.resolve(e||r)):Promise.reject("setValue: entityReference and controlKeyValuePairs parameters are required"),save:(e,n=[])=>t(Object(Fe.c)(e,!1,n)),openPopup:e=>t(Object(Y.a)(e)),closePopup:e=>t(Object(X.a)(e)),loadWebResource:(e,n)=>t(Ue(e,n)),registerOngoingWork:(e,n,r,i)=>t(function(e,t,n,r){return{type:"customcontrol.registerworkoutstanding",execute:({dispatch:i,getState:a},s)=>(It.a.getInstance().addWorkOutstandingPromise(e,t,n,r),Promise.resolve())}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,n,r,i)),isPresenceEnabledEntity:e=>Object(q.b)(e),getPresenceMappedField:e=>Object(q.a)(e),fireXrmEvent:(e,n,r,i,a)=>{const s=t(Object(ve.b)(n,r));let o=null;if(s&&s.ui&&s.ui.controls&&(o=s.ui.controls.get(e)),o)switch(i){case 0:o.fireOnKeyPress&&o.fireOnKeyPress()}},sendLookupRequest:(e,n,r,i,a,s,o)=>t(Xt(e,!0,n,r,i,a,s,o)),runPreSearch:(e,n,r)=>{t(function(e,t,n){return{type:"CCF.RunPreSearch",execute({dispatch:r,getState:i}){r(Object(Ct.f)(n,t,e)),r(Object(de.W)(e,n,t)),r(Object(de.X)(e,n,t)),r(Object(Ct.e)(n,t,e))},sync:!0}}(e,n,r))},runOnReadyStateComplete:(e,n,r)=>{t(function(e,t,n){return{type:"CCF.RunOnReadyStateComplete",execute({dispatch:r,getState:i},a){a.ScriptManager.containerExists(t)&&r(a.ScriptManager.getContainer(t).getEventManager().runOnReadyStateComplete(e,null,n))},sync:!0}}(e,n,r))},retrieveLookupRecordsBySearchString:(e,n,r)=>t(Object(Zt.a)(e,n,r)),retrieveLookupRecordsByIds:(e,n,r)=>t(Object(Zt.b)(e,n,r))},e={actions:tn,propBagMethods:{utils:en,navigation:r,device:$t,mode:Jt}},e}}))(s.a);class ln extends a.Component{constructor(e,t){super(e),this._updateCounter=0,this._isUpdateScheduled=!1,this._reRunMapStateToProps=()=>{this._isUpdateScheduled||(this._isUpdateScheduled=!0,Object(on.c)(()=>{this._isUpdateScheduled=!1,this._updateCounter++,this.forceUpdate()}))},this._reRunMapStateToProps=this._reRunMapStateToProps.bind(this)}render(){let e=null,t=null;return this.context&&this.context.CustomControlGlobalHelper&&(e=this.context.CustomControlGlobalHelper,t=this.context.TraceManager.getLogLevel()),a.createElement(o.a.Provider,{value:this.context},a.createElement(cn,Object.assign({},this.props,{contextHelper:e,logLevel:t,updateCounter:this._updateCounter,reRunMapStateMainProps:this._reRunMapStateToProps})))}}function un(e){const t="cm"+Object(an.a)();return a.createElement(rn.a,{commandbarDisplayMode:e.commandbarDisplayMode,addedCommandList:e.addedCommandList,key:e.key,iconPosition:e.iconPosition,id:e.id,commandManagerId:e.commandManagerId||t,ribbonId:e.ribbonId,selectedRecords:e.selectedRecords,width:e.width,metaDataLoadedResolve:e.metaDataLoadedResolve,isHidden:e.isHidden,commandBarStyle:e.commandBarStyle,customCommandManagerStyle:e.customCommandManagerStyle,contextToken:e.contextToken,rootZIndex:e.rootZIndex,customControlType:e.customControlType})}function dn(e){return{commandbarDisplayMode:void 0!==e.commandbarDisplayMode&&null!==e.commandbarDisplayMode?e.commandbarDisplayMode:sn.a.IconLabel,id:e.id,commandManagerId:e.commandManagerId,ribbonId:e.ribbonId,mainMenuLength:e.mainMenuLength,iconPosition:e.iconPosition,selectedRecords:pn(e.selectedRecords),key:e.key,commandBarStyle:e.commandBarStyle,customCommandManagerStyle:e.customCommandManagerStyle,isHidden:e.isHidden,width:e.width,metaDataLoadedResolve:e.metaDataLoadedResolve,addedCommandList:e.addedCommandList,contextToken:e.contextToken,rootZIndex:e.rootZIndex,customControlType:e.customControlType}}function pn(e){const t=[];if(e)for(const n of e)t.push(Bt(n));return t}function hn(e,t){if(e===t)return!0;if(e&&t&&e.length===t.length){const n=e.length;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}return!1}ln.contextType=i.a},"23K5":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class i{generate(e,t){if(!t||!t.getProcessId())return null;return{businessProcessFlowInstanceId:t.getProcessInstanceId(),activeStageId:r.a.tryParseOrNull(t.getActiveStageId()),displayState:t.getDisplayState(),processState:t.getProcessState(),state:t.getState(),status:t.getStatus(),isVisible:t.isVisible(),data:{activePath:t.getActivePath(),selectedStageId:r.a.tryParseOrNull(t.getSelectedStageId()),businessProcessFlowId:t.getProcessId(),actionLogCollection:t.getActionLogCollection(),processNavigationBehavior:{navigationBehavior:t.getBpfNavigationBehavior()}}}}}},"33Bq":function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return g}));var r=n("CpcI"),i=n("xy1J"),a=n("09gH"),s=n("sptG"),o=n("FdXt"),c=n("bJSG"),l=n("8Jtx"),u=n("1fn7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d="Role_Editor_Row_Name_Quick_Create",p="PageLoadingMessage",h="SharePoint.Form.Saving",g=["Button_Label_Close",d,p,h].concat(r.g,i.m,a.o,s.f,c.c,o.h,l.b,[u.g,u.f],[u.d])},"3MuQ":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="section.label";function a(e,t,n,a){const s=Object(r.v)(t);return{type:i,payload:a,meta:{pageId:e,contextKey:s,sectionName:n}}}},"3RSF":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("zu1I"),i=n("odYE"),a=n("SAYH"),s=n("lY/Z"),o=n("tICD"),c=n("H4dV"),l=n("O7zD"),u=n("iZ7K");function d(e,t,n,d,p,h,g){return{type:"form.openuploadentityimagedialog.async",execute({dispatch:m,getState:b}){const y=Object(u.h)(b(),t),f={entityimageurl_id:e,entitylogicalname_id:t,entity_id:n,entityprimaryattribute_id:d,cameraenabled_id:p,formattedPrimaryImage_Attribute:y&&y.PrimaryImageAttribute?y.PrimaryImageAttribute:"entityimage"},S=c.a.getInstance().get_IsMobilePhone()?"35rem":"27rem";return m(Object(r.b)("EntityImageUpload",{height:S,width:"30rem"},f,g)).then(e=>0===e.status?m(Object(o.a)(e.pageId)).then(e=>e):Promise.reject(e.error)).then(e=>{if(n&&t){const e=new i.a(t,a.a.tryParse(n)),r=Object(l.a)(null,b(),t),o=h&&r?[r]:null;m(Object(s.c)(e,o))}})}}}},"3c9R":function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var r=n("jRy5"),i=n("dHD5"),a=n("i1f0"),s=n("mIxf"),o=n("bT7G"),c=n("arV0"),l=n("ApeL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const u="attribute.precision";function d(e,t,n,d){return{type:"attribute.precision.update",sync:!0,execute({dispatch:p,getState:h},g){let m=h();p(function(e,t,n,a){if(t&&t.contextTokenType&&t.contextTokenType===r.a.GridRow)return Object(l.e)(e,t,n,a);const s=Object(i.x)(t);return{type:u,payload:a,meta:{pageId:e,contextKey:s,dataFieldName:n}}}(e,t,n,d)),m=h();let b=null,y=null,f=null,S=null;if(t&&t.contextTokenType&&t.contextTokenType===r.a.GridRow)b=t.entityTypeName?t.entityTypeName:null,y=t.recordId?t.recordId:null,f=Object(i.t)(t),S=Object(i.r)(t);else{const n=Object(c.g)(m,e);b=n&&n.entityTypeName?n.entityTypeName:null,y=n&&n.id?n.id:null,f=null,S=t}const v=Object(a.ac)(m,e,t),C=Object(o.d)(m,v,{etn:b,id:y},n),O={[n]:C};p(Object(s.a)(e,O,!0,!0,b,y?y.guid:null,f,S))}}}},"49Nd":function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"j",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"k",(function(){return h}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Grid_Paging_Mask",i="Grid_StatusMessage_Mask",a="Grid_ItemsSelected_Mask",s="Grid_TotalCount_Mask",o="Grid_ToolTip_FirstPage",c="Grid_ToolTip_PreviousPage",l="Grid_ToolTip_NextPage",u="Grid_TotalCount_SpaceMask",d="Grid_TotalCount_Approximate",p="Grid_TotalCount_Exact",h=[r,i,a,s,o,c,l,u,d,p]},"4U8P":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="header.commandbarvisible";function a(e,t,n){const a=Object(r.v)(t);return{type:i,payload:n,meta:{pageId:e,contextKey:a}}}},"4XwW":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="form.setSelectedFormId";function i(e,t){return{type:r,payload:{formId:t},meta:{pageId:e}}}},"4rWj":function(e,t,n){"use strict";n.d(t,"a",(function(){return lt}));var r=n("c/eZ"),i=n("OWbt"),a=n("SAYH"),s=n("dMZy"),o=n("TYIz"),c=n("mhYf"),l=n("PbI6"),u=n("FHmp"),d=n("2YQW");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const p=Object(d.d)({[o.a]:function(e,t){return Object.assign(Object.assign({},e),{collapsed:t.payload})},[c.a]:function(e,t){return Object.assign(Object.assign({},e),{visible:t.payload})},[l.a]:function(e,t){return Object.assign(Object.assign({},e),{contentType:t.payload})},[u.a]:function(e,t){return Object.assign(Object.assign({},e),{label:t.payload})}},{collapsed:!1,visible:!0,label:"",sectionNames:[],domId:null,showLabel:!0,contentType:"cardSections"});var h=n("vlcQ"),g=n("3MuQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const m=Object(d.d)({[h.a]:function(e,t){return Object.assign(Object.assign({},e),{visible:t.payload})},[g.a]:function(e,t){return Object.assign(Object.assign({},e),{label:t.payload})}},{parentTabId:null,visible:!0,label:"",controlNames:[],domId:null,semanticZoomDomId:null});var b=n("lju1"),y=n("e3W2"),f=n("ZMWz"),S=n("Zpd/"),v=n("hA8P"),C=n("yl9a"),O=n("/5se"),_=n("Khp3"),I=n("xorU"),j=n("BoVI"),P=n("TsER");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const F=Object(d.d)({[y.a]:function(e,t){return Object.assign(Object.assign({},e),{visible:t.payload})},[f.a]:function(e,t){return Object.assign(Object.assign({},e),{label:t.payload,labelSource:b.a.ClientAPI})},[S.a]:function(e,t){return null!==t.payload?Object.assign(Object.assign({},e),{disabledByClientApi:t.payload}):e},[C.a]:function(e,t){const n=Object.assign(Object.assign({},e.parameters),t.payload);return Object.assign(Object.assign({},e),{parameters:n})},[O.a]:function(e,t){const n=Object.assign(Object.assign({},e.parameters),{defaultviewid:t.payload});return Object.assign(Object.assign({},e),{parameters:n})},[j.a]:function(e,t){const n=Object.assign(Object.assign({},e.views),t.payload.views);return Object.assign(Object.assign({},e),{views:n})},[I.a]:function(e,t){const n=e.customFilter?e.customFilter:[];for(let r=n.length-1;r>=0;r--)if(n[r].entityLogicalName===t.payload.entityLogicalName){if(n[r].customFilter===t.payload.customFilter)return e;break}return n.push(t.payload),Object.assign(Object.assign({},e),{customFilter:n})},[I.c]:function(e,t){const n=[];return n.push({customFilter:"START_FLAG",entityLogicalName:""}),Object.assign(Object.assign({},e),{customFilter:n})},[I.b]:function(e,t){const n=e.customFilter?e.customFilter:[];if(n.length>0&&"END_FLAG"===n[n.length-1].customFilter)return e;return n.push({customFilter:"END_FLAG",entityLogicalName:""}),Object.assign(Object.assign({},e),{customFilter:n})},[_.a]:function(e,t){if(t.payload)return Object.assign(Object.assign({},e),{notifications:Object.assign(Object.assign({},e.notifications),t.payload)});return Object.assign(Object.assign({},e),{notifications:t.payload})},[v.a]:function(e,t){const n=[].concat(e.parameters);let r=e;null!==t.payload&&(n.DisableMru=t.payload?"true":"false",r=Object.assign(Object.assign({},r),{parameters:n}));return r},[P.a]:
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){return Object.assign({},e)},[j.d]:function(e,t){return Object.assign(Object.assign({},e),{initializationIntent:t.payload})}},{parentSectionName:null,visible:!0,label:"",valid:!0,domId:null,notifications:null,dataFieldName:null});var T=n("Qn2w");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function w(e,t,n){const r=Object.assign({},e),i=Object.keys(r).length,a={};return n?(r.hasOwnProperty(t)&&delete r[t],Object.assign({},r)):i>0?r.hasOwnProperty(t)?r:(a[t]=!0,Object.assign(Object.assign({},e),a)):(a[t]=!0,a)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const E=Object(d.d)({[T.a]:function(e,t){return Object.assign({},w(e,t.meta.controlName,t.payload.isValid))}},{});var x=n("Bo7t"),N=n("Tg1Y"),A=n("+Ajx"),k=n("ofgb"),M=n("1HWW"),D=n("9NSo"),R=n("+hq9"),B=n("Q1Tc");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const L=Object(d.d)({[B.a]:function(e,t){return Object.assign({},t.payload.controlUnboundOutputs)}},{});var V=n("lxh6"),z=n("Y5AI"),H=n("MgYC"),G=n("3HPu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const W=Object(d.d)({[G.a]:function(e,t){return Object.assign({},w(e,t.meta.attributeName,t.payload.isValid))}},{});var U=n("FhIR"),q=n("NtHU"),X=n("4U8P"),Y=n("m+2h");const K={tabs:Object(d.b)("tabId",p),sections:Object(d.b)("sectionName",m),controls:Object(d.b)("controlName",F),selectedTab:function(e=Object(s.a)(),t){if(t.type===N.a){if(e.navigationStack&&e.navigationStack.length>0)return Object.assign(Object.assign({},e),{tabId:e.navigationStack[e.navigationStack.length-1],navigationStack:e.navigationStack.slice(0,e.navigationStack.length-1)})}else if(t.type===x.a){const n=(e.navigationStack||[]).slice(0);return e.tabId&&e.tabId!==t.payload&&n.push(e.tabId),Object.assign(Object.assign({},e),{tabId:t.payload,navigationStack:n})}return e},selectedRelatedEntity:function(e=null,t){return t.type===A.a?t.payload:e},xrmReady:function(e=!1,t){return t.type===i.b?t.payload.xrmReady:e},isSaving:function(e=!1,t){return t.type===k.a?t.payload.savingState:e},controlUnboundOutputs:L,inlineQuickForms:function(e=null,t){return t.type===i.a?t.payload.formUIState.inlineQuickForms:e},invalidControls:E,invalidAttributes:W,label:function(e="",t){return t.type===D.a?t.payload.label:e},hasOfflineChanges:function(e=!1,t){return t.type===M.a?t.payload.hasOfflineChanges:e},viewportWidth:function(e=0,t){return t.type===V.a?t.payload.viewportWidth:e},viewportHeight:function(e=0,t){return t.type===V.a?t.payload.viewportHeight:e},formId:function(e=a.a.EMPTY,t){return e},showHeaderFieldsInSection:function(e=!1,t){return t.type===z.a?t.payload.showHeaderFieldsInSection:e},headerFieldsInFlyout:function(e,t){if(t.type===H.a){const e=new Set,n=t.payload.headerFieldsInFlyout;for(let t=0;t<n.length;t++)e.add(n[t].Name);return e}return e},isAutoSaving:function(e=!1,t){return t.type===R.a?t.payload.isAutoSaving:e},header:function(e=null,t){switch(null==e&&(e={bodyVisible:!0,commandBarVisible:!0,tabNavigatorVisible:!0}),t.type){case q.a:return Object.assign(Object.assign({},e),{bodyVisible:t.payload});case X.a:return Object.assign(Object.assign({},e),{commandBarVisible:t.payload});case U.a:return Object.assign(Object.assign({},e),{tabNavigatorVisible:t.payload})}return e},footer:function(e=null,t){switch(null==e&&(e={visible:!0}),t.type){case Y.a:return Object.assign(Object.assign({},e),{visible:t.payload})}return e},formScrollAndFocusState:function(e,t){return t.type===j.e?t.payload:e}},Q=Object(d.a)(K),Z=Object(d.b)("contextKey",Q);var J=n("0bz+"),$=n("4UCL"),ee=n("WKRf");const te={snapshotId:J.a,updatedFields:
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){if(t.type===$.a){const n={},r=t.payload.fieldValues;if(!r)return e;for(const t in r)e&&e.hasOwnProperty(t)||(n[t]=r[t]);return Object.keys(n).length>0?Object.assign(Object.assign({},e),n):e}if(t.type===$.b){const n={};if(t.payload.keepFields)for(const r of t.payload.keepFields)e[r]&&(n[r]=e[r]);return n}return e},isDeleted:function(e=!1,t){return t.type===ee.a?t.payload:e}},ne=Object(d.a)(te),re=Object(d.b)("contextKey",ne);var ie=n("3c9R"),ae=n("mlKL"),se=n("cf3Y"),oe=n("/q65"),ce=n("91Ew"),le=n("KnyI"),ue=n("tvJg"),de=n("TAgK"),pe=n("RREX"),he=n("z5LE");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ge=Object(d.d)({[ie.a]:function(e,t){return Object.assign(Object.assign({},e),{Precision:t.payload,PrecisionSource:pe.a.attribute})},[ae.a]:function(e,t){return Object.assign(Object.assign({},e),{RequiredLevel:t.payload})},[se.a]:function(e,t){return Object.assign(Object.assign({},e),{Format:t.payload})},[oe.a]:function(e,t){return Object.assign(Object.assign({},e),{Targets:t.payload})},[ce.a]:function(e,t){let n=e.OptionSet;const r=t.payload.option;if(!n||!r)return e;const i=t.payload.index;n=n.slice(0),i>=0&&i<n.length?n.splice(i,0,r):n.push(r);return Object.assign(Object.assign({},e),{OptionSet:n})},[le.a]:function(e,t){let n=e.OptionSet;if(!n)return e;const r=t.payload;let i;n=n.slice(0);for(let t=0;t<n.length;t++)if(i=n[t],i.Value===r)return n.splice(t,1),Object.assign(Object.assign({},e),{OptionSet:n});return e},[ue.a]:function(e,t){if(!e.OptionSet)return e;return Object.assign(Object.assign({},e),{OptionSet:[]})},[de.a]:function(e,t){if(!e.OptionSet)return e;const n=t.payload;return Object.assign(Object.assign({},e),{OptionSet:n||[]})},[he.a]:function(e,t){if(t.payload)return Object.assign(Object.assign({},e),{notifications:Object.assign(Object.assign({},e.notifications),t.payload)});return Object.assign(Object.assign({},e),{notifications:t.payload})}},{Precision:null,PrecisionSource:null,RequiredLevel:null,Format:null,OptionSet:null,IsValidForCreate:null,IsValidForUpdate:null,notifications:null,Targets:null});var me=n("BvQu"),be=n("LLfG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ye=Object(d.d)({[be.a]:function(e,t){if(t.payload===me.a.Dirty){const n={};if(t.meta.dataFieldName&&Object.keys(e).lastIndexOf(t.meta.dataFieldName)>-1){for(const r of Object.keys(e))r!==t.meta.dataFieldName&&(n[r]=e[r]);return Object.freeze(n)}return e}return Object.assign(Object.assign({},e),{[t.meta.dataFieldName]:t.payload})}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},{});const fe={attributes:Object(d.b)("dataFieldName",ge),submitModes:ye},Se=Object(d.a)(fe),ve=Object(d.b)("contextKey",Se);var Ce=n("+aj2"),Oe=n("NDmk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const _e=Object(d.d)({[Ce.a]:function(e,t){return Object.assign(Object.assign({},e),{value:t.payload.value})},[Oe.a]:function(e,t){return Object.assign(Object.assign({},e),{value:t.payload.value})}},{reason:"",value:""});var Ie=n("f/sd"),je=n("SVnG"),Pe=n("GodX"),Fe=n("N+Ya"),Te=n("dIqG"),we=n("hK10");const Ee=Object(d.d)({[Fe.a]:function(e,t){const n=Object.assign({},e);return xe(n,t.payload.label,t.payload.currentLanguageId),n.labelSetByClientAPI=!0,Object.freeze(n)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */,[Te.a]:function(e,t){const n=t.payload;return Object.freeze(Object.assign(Object.assign(Object.assign({},e),n),{showSetByClientAPI:!0}))}},{titles:{},tooltipTitles:{},privileges:[],relationshipName:"",id:"",area:"",titleResourceId:"",client:"",availableOffline:!1,icon:"",sequence:"",show:!0,viewId:""});function xe(e,t,n){const r=Object(we.b)(e,n);if(r)r.Value=t;else{const r=null===n?"":n.toString();e.titles[""]={Name:r,Value:t}}return e}const Ne=Object(d.d)({},{}),Ae=Object(d.d)({},{}),ke=Object(d.d)({},{});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Me=n("dtbk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const De=Object(d.b)("navigationItemId",Ee);const Re={navBarAreas:Ne,navPaneIsvItems:Ae,navBarByRelationshipItems:function(e,t){if(t.type===Me.a){if(t.payload.allNavBarByRelationshipItems&&t.payload.allNavBarByRelationshipItems.length>0){const n=Object.assign({},e);return t.payload.allNavBarByRelationshipItems.forEach(e=>{e&&e.id&&(n[e.id]||(n[e.id]=Object.assign(Object.assign({},{titles:{},tooltipTitles:{},privileges:[],relationshipName:"",id:"",area:"",titleResourceId:"",client:"",availableOffline:!1,icon:"",sequence:"",show:!0,viewId:""}),{id:e.id})),xe(n[e.id],e.title,t.payload.currentLanguageId))}),Object.freeze(n)}return e}return De(e,t)},navBarItems:ke},Be=Object(d.a)(Re);var Le=n("Bj/n"),Ve=n("jTSi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ze=Object(d.d)({[Le.a]:function(e,t){const n={Message:t.payload.message,Level:t.payload.level,UniqueId:t.payload.uniqueId,Buttons:t.payload.buttons,MessagePlaceholders:t.payload.placeholders,ControlName:t.payload.controlName,ComponentId:t.payload.componentId};return Object.assign(Object.assign({},e),{[t.payload.uniqueId]:n})},[Ve.a]:function(e,t){if(Object.keys(e).length<1)return e;const n={};if(t.payload.uniqueId)for(const r of Object.keys(e))r!==t.payload.uniqueId&&(n[r]=e[r]);return n}},{});var He=n("jR7L"),Ge=n("TD3W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const We=Object(d.d)({[He.a]:function(e,t){if(t.type===He.a)return Object.assign(Object.assign({},e),t.payload);return e},[Ge.a]:function(e,t){const n=Object.assign({},e);return delete n[t.payload.relationship],Object.freeze(n)}},{});var Ue=n("MktZ"),qe=n("uPT+"),Xe=n("LAcd"),Ye=n("rdSB"),Ke=n("+Vem"),Qe=n("iHOm"),Ze=n("6Qf/"),Je=n("jRy5"),$e=n("dHD5"),et=n("59++"),tt=n("QiMq"),nt=n("9wSR"),rt=n("7TDv");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const it={selectedFormId:null,forms:{}};var at=n("gDO8"),st=n("XlXz");var ot=n("4XwW");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const ct=Object(d.a)({loadingState:function(e=Ie.a.Initial,t){return t.type===Ue.a?t.payload:e},formId:function(e=null,t){return t.type===i.a?t.payload.formId:e},navigation:Be,notifications:ze,powerBISignedInState:function(e="NotSignedIn",t){return t.type===qe.a?t.payload:e},suppressDuplicateDetection:function(e=!1,t){return t.type===Xe.a?t.payload.suppressDuplicateDetection:e},customDataProviderOutputs:je.a,formlessControlOutputs:Pe.a,output:_e,datasets:Qe.a,metadata:ve,records:re,forms:Z,entityReferenceByRelationship:We,referenceInformationByRelationship:function(e={},t){return t.type===Ke.a?t.payload:e},primaryEntity:function(e="",t){return"set.primary.entity"===t.type?t.payload:e},visitedTabNames:function(e=null,t){if(t.type===tt.a){const n=t.payload;if(!e)return n?new Set([n]):null;if(!n||e.has(n))return new Set(e);const r=new Set(e);return r.add(n),r}return e},autoSaveInterval:function(e=nt.a,t){return t.type===nt.d?e=nt.a:t.type===nt.b&&e<nt.c&&(e+=nt.a),e},formInstances:function(e={list:[],formInstanceIdByControlName:{},controlNameByFormInstanceId:{}},t){if(t.type===j.b){const n=t.payload.formInstanceId,r=t.payload.controlName,i=[...e.list,n],a=Object.assign(Object.assign({},e.formInstanceIdByControlName),{[r]:n}),s=Object.assign(Object.assign({},e.controlNameByFormInstanceId),{[n]:r});e=Object.assign(Object.assign({},e),{list:i,formInstanceIdByControlName:a,controlNameByFormInstanceId:s})}else if(t.type===j.g){const n=t.payload.formInstanceId,i=t.payload.controlName,a=e.list.filter(e=>e!==n);if(e.formInstanceIdByControlName[i]&&e.controlNameByFormInstanceId[n]){const t=i,s=e.formInstanceIdByControlName,o=t,c=(s[o],Object(r.__rest)(s,["symbol"==typeof o?o:o+""])),l=n,u=e.controlNameByFormInstanceId,d=l,p=(u[d],Object(r.__rest)(u,["symbol"==typeof d?d:d+""]));e=Object.assign(Object.assign({},e),{list:a,formInstanceIdByControlName:c,controlNameByFormInstanceId:p})}}return e},formSelector:function(e=it,t){return t.type===rt.a?Object.assign(Object.assign({},e),{forms:Object.assign(Object.assign({},e.forms),{[t.meta.formId]:{visible:t.payload.visible}})}):t.type===ot.a?Object.assign(Object.assign({},e),{selectedFormId:t.payload.formId}):e},parentComponentId:function(e="",t){return t.type===j.c?t.payload.parentComponentId:e},referencePanel:function(e={sessionTabs:[],controlNames:[],activeTabId:"",messageId:""},t){switch(t.type){case st.a:return t.payload.messageId?Object.freeze(Object.assign(Object.assign({},e),{sessionTabs:t.payload.sessionTabs,activeTabId:t.payload.activeTabId,messageId:t.payload.messageId})):Object.freeze(Object.assign(Object.assign({},e),{sessionTabs:t.payload.sessionTabs,activeTabId:t.payload.activeTabId}));case st.d:case st.c:return Object.freeze(Object.assign(Object.assign({},e),{sessionTabs:t.payload.sessionTabs,activeTabId:t.payload.activeTabId}));case st.e:return Object.freeze(Object.assign(Object.assign({},e),{messageId:t.payload.messageId}));case st.g:return Object.freeze(Object.assign(Object.assign({},e),{sessionTabs:t.payload.sessionTabs,controlNames:t.payload.controlNames,activeTabId:t.payload.activeTabId}));case st.f:return Object.freeze(Object.assign(Object.assign({},e),{controlNames:t.payload.controlNames,activeTabId:t.payload.activeTabId}));case st.b:return Object.freeze({sessionTabs:[],controlNames:[],activeTabId:"",messageId:""});case st.h:return Object.freeze(Object.assign(Object.assign({},e),{sessionTabs:t.payload.sessionTabs}));default:return e}},formLoadError:function(e=null,t){return t.type===at.a?t.payload.error:e}});function lt(e,t){if(void 0===e){const n=ct(e,t);return Object.freeze(n)}let n;if(t.type===i.a){const r=t.meta.contextToken,i=Object($e.v)(r),a=ut(i),s="NotSignedIn",o=!1,c=e.forms[i];let l=e.metadata;t.payload.relatedEntityMetadataState&&(l=Object.assign({},l,t.payload.relatedEntityMetadataState));const u=Object.assign(Object.assign({},e.forms),{[i]:Object.assign(Object.assign({},c),t.payload.formUIState)});l=Object.assign(Object.assign({},l),{[i]:Object.assign(Object.assign({},l[i]),t.payload.formMetadataState)});const d=Object.assign(Object.assign({},e.navigation),u&&r.contextTokenType===Je.a.MainForm?u[i].navigation:e.navigation);if(d.navBarByRelationshipItems){const e=d.navBarByRelationshipItems;d.navBarByRelationshipItems={};const n=Object.keys(e);for(let r=0;r<n.length;r++){const i=n[r];d.navBarByRelationshipItems[i]=Object(we.a)(e[i],t.payload.currentLanguageId)}}n=Object.assign(Object.assign({},e),{formId:t.payload.formId,forms:u,metadata:l,records:a,powerBISignedInState:s,suppressDuplicateDetection:o,navigation:d})}else if(t.type===Ye.a&&e.metadata[t.meta.contextKey]){const r=e.metadata[t.meta.contextKey];n=Object.assign(Object.assign({},e),{metadata:Object.assign(Object.assign({},e.metadata),{[t.meta.contextKey]:Object.assign(Object.assign({},r),{attributes:Object.assign(Object.assign({},null==r?void 0:r.attributes),t.payload.attributes)})})})}else if(t.type===Ye.b){const r=e.forms[t.meta.contextKey];n=Object.assign(Object.assign({},e),{forms:Object.assign(Object.assign({},e.forms),{[t.meta.contextKey]:Object.assign(Object.assign({},r),{controls:Object.assign(Object.assign({},e.forms[t.meta.contextKey].controls),t.payload.controls)})})})}else if(t.type===Ze.a){const r=t.payload,i=Object.assign(Object.assign({},e.datasets),{[r.contextKey]:r.initialDataSetState});n=Object.assign(Object.assign({},e),{datasets:i})}else if(t.type===et.a){const r=t.meta.contextToken,i=Object($e.v)(r),a=e.forms[i],s=Object.assign({},a),o=a.selectedTab.tabId;if(!t.payload.formUIState.tabs[o]){const e=a.tabs[o];if(e){const n=e.domId;let r;for(const e in t.payload.formUIState.tabs){if(t.payload.formUIState.tabs[e].domId===n){r=e;break}}a.selectedTab.tabId=r||""}}s.controls=t.payload.formUIState.controls,s.sections=t.payload.formUIState.sections,s.tabs=t.payload.formUIState.tabs,s.label=t.payload.formUIState.label,s.inlineQuickForms=t.payload.formUIState.inlineQuickForms,n=Object.assign(Object.assign({},e),{forms:Object.assign(Object.assign({},e.forms),{[i]:s})})}else if(t.type===j.h){const r=t.meta.contextToken,i=ut(Object($e.v)(r));n=Object.assign(Object.assign({},e),{records:i})}else n=ct(e,t);return Object.freeze(n)}function ut(e){return{[e]:{snapshotId:"",isDeleted:!1}}}},"53SR":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("SAYH"),i=n("Kvn0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function a(e,t){const n={dataById:{[r.a.toString(t.id)]:e}};return{type:i.a,payload:n}}},"59++":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return a}));var r=n("y60j"),i=n("OWbt");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="form.ui.metadata.update";function s(e,t,n){return{type:"form.ui.metadata.update.async",execute({dispatch:s,getState:o},c,l){const u=o(),d=Object(r.j)(u,e),p=Object(i.g)(u,d,e);return s(function(e,t,n,r){return{type:a,payload:{formId:e,formUIState:t},meta:{pageId:n,contextToken:r}}}(e,p,t,n)),Promise.resolve()}}}},"5UPV":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="dataset.set.newPageRequested";function a(e,t,n){const a=Object(r.y)(t),s=Object(r.v)(t);return{type:i,payload:n,meta:{pageId:e,contextKey:a,dataSetContextKey:s}}}},"5iTp":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,n){const i=Object(r.cb)(e,t,n);return i?i.footer:null}},"6Qf/":function(e,t,n){"use strict";n.d(t,"f",(function(){return g})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return y}));var r=n("SAYH"),i=n("dHD5"),a=n("BFlg"),s=n("ZJsz"),o=n("P6DH"),c=n("3/02"),l=n("Lyxw"),u=n("ujVH"),d=n("jAuy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const p="grid.initialize",h="grid.initialize.xrmready";function g(e,t,n){return{type:"grid.preinitialize.sync",sync:!0,execute({dispatch:r,getState:i},s){const o=a.x+".gridPreInitializedAction";try{r(b(null,e,t,n,void 0,void 0,void 0,void 0,null));const i=[{name:"entityTypeName",value:e}];return s.EventManager.ReportComponentSuccess(o,i),Promise.resolve(void 0)}catch(t){const n="Failed for "+e+" with error "+t.message;return s.EventManager.ReportComponentFailure(o,Error(n)),Promise.resolve(void 0)}}}}function m(e,t,n,r,i,d,p,h,g){return e?{type:"grid.initialize.async",execute({dispatch:m,getState:y},f){const S=a.x+".gridInitializedAction";try{let a=null;Object(l.c)(y(),c.zb)&&(a=function(e,t,n){const r=Object(o.v)(e,t,n),i=Object.assign({},s.a);return r&&(r.filters&&(i.filters=r.filters),r.customFilter&&(i.customFilter=r.customFilter),r.pageNumber&&(i.pageNumber=r.pageNumber),r.pagingRefreshInput&&(i.pagingRefreshInput=r.pagingRefreshInput)),i}(y(),n,r)),m(b(e,t,n,r,i,d,p,h,a,g));const v=[];v.push({name:"entityTypeName",value:t}),f.EventManager.ReportComponentSuccess(S,v);return Object(l.c)(y(),c.L)&&m(Object(u.b)(n,r)),Promise.resolve(void 0)}catch(e){const n="Grid initialized failed for entity type "+t;return f.EventManager.ReportComponentFailure(S,Error(n)),Promise.reject(void 0)}}}:null}function b(e,t,n,o,c,l,u,h,g,m){const b=c&&c.Parameters?c.Parameters[a.j]:null;try{let c=!0;b&&(c="true"===b);const y=Object(i.u)(o),f={contextKey:y,initialDataSetState:Object.assign(Object.assign(Object.assign({},s.a),g),{viewId:e?e.viewId:null,fetchXml:e?e.fetchXml:null,relationshipName:l,relationshipRoleOrdinal:u,useRollupView:h||!1,commandManagerId:m||Object(d.d)(n,o),controls:{homepageGrid:{parameters:{0:{Name:a.C,Value:e&&e.viewId?r.a.toString(e.viewId):null},1:{Name:a.j,Value:c},2:{Name:a.u,Value:t}}}}})};return{type:p,payload:f,meta:{pageId:n,contextKey:y}}}catch(e){throw Error(e)}}function y(e,t,n,o){const c=Object(i.u)(o),l=r.a.tryParseOrNull(t),u={contextKey:c,initialDataSetState:Object.assign(Object.assign({},s.a),{viewId:l||null,fetchXml:null,commandManagerId:Object(d.d)(n,o),controls:{homepageGrid:{parameters:{0:{Name:a.C,Value:t||null},1:{Name:a.j,Value:!1},2:{Name:a.u,Value:e}}}}})};return{type:p,payload:u,meta:{pageId:n,contextKey:c}}}function f(e,t,n,r){return t(e.ScriptManager.getContainer(r).getEventManager().loadGridScripts(n,r))}},"7+p5":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("Lyxw"),i=n("3/02"),a=n("IqkD");function s(e){if(Object(r.a)(e,i.S,i.h)){return!!Object(r.a)(e,i.d,i.Lc)||1033===Object(a.s)(e)}return!1}},"7TDv":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="formSelector.visible";function i(e,t,n){return{type:r,payload:{visible:n},meta:{pageId:e,formId:t}}}},"7k+e":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return o}));var r=n("dHD5"),i=n("BFlg");const a="chart.drilldownparameters.update",s="ChartDrillDownParameters";function o(e,t,n){return{type:"chart.drilldownparameters.update.async",execute({dispatch:o,getState:c},l){const u=l.TraceManager.getTracer(i.z),d=i.x+".updateChartDrillDownParametersAction";try{u.info("Updating the chart drilldown parameters"),t||(t=Object(r.k)(c(),e));const i=Object(r.v)(t);return o(function(e,t,n){return{type:a,payload:{name:s,value:n},meta:{pageId:e,dataSetContextKey:t}}}(e,i,n)),l.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){const t="Updatation of the chart drilldown parameters failed with error : "+e.message;l.EventManager.ReportComponentFailure(d,Error(t))}}}}},"7p56":function(e,t,n){"use strict";n.d(t,"a",(function(){return Ut}));var r=n("nuS9"),i=n("4fxQ"),a=n("D9ys"),s=n("u+q+"),o=n("YWpA"),c=n("hPFj"),l=n("H/hG"),u=n("e9UD"),d=n("znb3"),p=n("223Y"),h=n("VnpK"),g=n("POU9"),m=n("vP/5"),b=n("sclX"),y=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const f=2/(1+Math.sqrt(5));class S extends r.Component{constructor(e){super(e),this._memorizedDescriptor=null,this.onMeasuring=this.onMeasuring.bind(this),this.state={width:0,height:0}}_getGoldenRatioHeight(e){return f*e}onMeasuring(e,t){let n=!1;const r={};e!==this.state.width&&(r.width=e,n=!0),t!==this.state.height&&(r.height=t,n=!0),n&&this.setState(r)}render(){const e=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(y.z):null;if(!this.props||!this.props.showChart||!this.props.configuration)return e&&e.info("Chart not rendered because the configuration is missing or show chart is set to false"),null;this._memorizedDescriptor&&this.props.chartId===this._memorizedDescriptor.Id||(this._memorizedDescriptor={Id:this.props.chartId,Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1});const t=parseFloat(getComputedStyle(document.documentElement).fontSize),n=this._getTopAndBottomAdjustment(t),i=this._getLeftAndRightAdjustment(t);let a,s;this.props.isLayoutVertical?(a=this.state.width-i,s=this._getGoldenRatioHeight(a),this.props.style.minHeight=s+n):(a=Math.max(this.state.width,320)-i,s=this.state.height-n);const c={minWidth:a.toString()+"px",minHeight:s.toString()+"px"},l={width:a>0?a:-1,height:s>0?s:-1,eventListeners:[{eventname:"onChartPaneClose",eventhandler:[this._closeChartPane.bind(this)]}]};return r.createElement(o.a,{key:"pageChart_"+this.props.id,testhooks:{id:"pageChart_"+this.props.id},style:this.props.style,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0},r.createElement(o.a,{key:"pageChart_"+this.props.id+"_container",style:c},r.createElement(p.c,{key:this.props.chartId,controlId:this.props.chartId,id:this.props.id,configuration:this.props.configuration,descriptor:this._memorizedDescriptor,parentDefinedControlProps:l,parentContextToken:this.props.contextToken})))}_closeChartPane(){this.props.closeChartPaneHandler(this.props.id,this.props.contextToken,!1)}_getTopAndBottomAdjustment(e){let t=0;return this.props.style.borderTopWidth&&(t+=e*("string"==typeof this.props.style.borderTopWidth?parseFloat(this.props.style.borderTopWidth||"0px"):this.props.style.borderTopWidth)),this.props.style.paddingTop&&(t+=e*("string"==typeof this.props.style.paddingTop?parseFloat(this.props.style.paddingTop||"0px"):this.props.style.paddingTop)),this.props.style.borderTop&&(t+=1),this.props.style.borderBottom&&(t+=1),t}_getLeftAndRightAdjustment(e){let t=0;return this.props.style.paddingLeft&&(t+=e*("string"==typeof this.props.style.paddingLeft?parseFloat(this.props.style.paddingLeft||"0px"):this.props.style.paddingLeft)),this.props.style.paddingRight&&(t+=e*("string"==typeof this.props.style.paddingRight?parseFloat(this.props.style.paddingRight||"0px"):this.props.style.paddingRight)),this.props.style.borderLeft&&(t+=1),this.props.style.borderRight&&(t+=1),t}}var v=n("SAYH"),C=n("ah4O"),O=n("KBcj"),_=n("d0w6"),I=n("iWfp"),j=n("XvLr"),P=n("P6DH"),F=n("b6Tl"),T=n("a72m"),w=n("EY5k"),E=n("YxC/"),x=n("FZDd"),N=n("iZ7K"),A=n("eXjw"),k=n("OmkB"),M=n("tOh6"),D=n("sZ+8"),R=n("69Qu"),B=n("RJiR"),L=n("0kGT"),V=n("3/02"),z=n("Lyxw"),H=n("PMTb");let G=[];class W extends r.Component{constructor(e){super(e),this._onItemIconPointerDown=this._onItemIconPointerDown.bind(this),this._onChange=this._onChange.bind(this),this.props.entityTypeName.toLowerCase()===P.a&&(this.props.loadAllActivityTypes(e.activities),this.props.loadAllActivityResourceString())}_getEntityTypeNameFromViewId(e){return e&&this.props.gridViewSelectorItems&&this.props.gridViewSelectorItems[e]&&this.props.gridViewSelectorItems[e].relatedEntityName?this.props.gridViewSelectorItems[e].relatedEntityName:null}_onChange(e){var t;this.props.isGridRoot&&this.props.pageToEditedViewMapId&&this.props.selectedViewId!==e&&this.props.removeEditedViewPageMap(null===(t=this.props.pageToEditedViewMapId)||void 0===t?void 0:t.guid,new v.a(this.props.selectedViewId)),this.props.onChange(e,this.props.entityTypeName===P.a?this._getEntityTypeNameFromViewId(e):this.props.entityTypeName)}_isViewSelectorHidden(){return!(this.props.gridViewSelectorItems&&this.props.viewCategories&&this.props.selectedViewId)}render(){const e=Object(E.c)(this.props.resourceStrings,j.VIEWSELECTOR_TOOLTIP),t=this.props.contextString===y.h.GRID,n=t?this._onItemIconPointerDown:null,i=this.props.useViewSelectorV2?this.props.isPhone:this.props.isTablet,a=i?this.props.styleProps.textStyleMobile:this.props.styleProps.textStyle,s=i?this.props.styleProps.viewSelectorMobileStyle:this.props.styleProps.viewSelectorStyle,o=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(y.z):null;if(this._isViewSelectorHidden())return o&&o.info("View Selector not rendered because view selector items or view categories or selected view is not available."),null;const c=[];let l=!1;for(const e in this.props.gridViewSelectorItems){const n=this.props.gridViewSelectorItems[e];if(!n)continue;const r=n.isUserView;let i;if(r&&(l=!0),this.props.entityTypeName===P.a&&this.props.pinnedActivityView){const e=n;i=e.isPinned&&this.props.pinnedActivityView.PinnedEntity===e.relatedEntityName}else i=n.isPinned;const a=t?i?d.a.Pinned:d.a.Pin:null,s='""',o='""',u={":hover":{"::before":{content:i?s:o}}};this.props.useViewSelectorV2&&Object.assign(u,{marginLeft:"8px",marginRight:"8px"});const p=t?u:null,h=Object(E.c)(this.props.resourceStrings,j.VIEWSELECTOR_DEFAULTVIEW),g=Object(E.c)(this.props.resourceStrings,j.VIEWSELECTOR_SETDEFAULTVIEW),m=t?i?h:g:null;let b="";b=this.props.entityTypeName===P.a&&this.props.allActivitiesString&&this.props.shouldDisplayNestedViewSelector?(G.indexOf(n.relatedEntityName)+1).toString():r?_.b.userview.toString():_.b.savedview.toString();let y=n.name;e===this.props.selectedViewId&&this.props.isEdited&&(this.props.isRTL?y="*"+y:y+="*"),c.push({value:e,text:y,categoryId:b,iconType:a,iconTitle:m,iconStyle:p})}if(this.props.selectedViewId&&this.props.quickFindViewId&&this.props.quickFindViewId===this.props.selectedViewId){const e=Object(E.c)(this.props.resourceStrings,j.QUICK_FIND_VIEWS_LABEL_ID);c.push({value:this.props.selectedViewId,text:e,categoryId:_.b.savedview.toString()})}const u=l?this.props.viewCategories:this.props.viewCategories.filter(e=>e.id!==_.b.userview.toString());return this.props.isGridRoot&&this.props.isInMobileModeForOct2019?r.createElement(B.c,{pageId:this.props.pageId},this.props.isAdvancedFindView?r.createElement(H.a,null,"New view"):r.createElement(B.k,{items:c,selectedItemId:this.props.selectedViewId,onChange:this._onChange})):this.props.isAdvancedFindView?r.createElement(H.a,{style:a},"New view"):r.createElement(C.a,{id:this.props.id,testhooks:{id:"ViewSelector_"+this.props.selectedViewId},value:this.props.selectedViewId,role:"presentation",title:e,categories:u,options:c,style:this.props.style,caretType:d.a.ChevronDownMed,caretStyle:this.props.styleProps.caretStyle,textStyle:a,viewSelectorStyle:s,onChange:this._onChange,onItemIconPointerDown:n,createAccessibilityComponent:I.a,createKeyboardShortcut:I.b,parentCustomControlId:this.props.id,rootZIndex:this.props.rootZIndex,isRTL:this.props.isRTL,useViewSelectorV2:this.props.useViewSelectorV2,placeItemIconOnRight:!0,useHeader:this.props.isGridRoot})}componentDidMount(){if(this.props.viewIds?this.props.loadGridViewsByViewId(this.props.viewIds,this.props.entityTypeName):this.props.loadViewsByType(this.props.queryViewSelectorTypes,this.props.entityTypeName,this.props.gridViewSelectorItems),this._isViewSelectorHidden())return;let e=!1;if(this.props.selectedViewId&&""!==this.props.selectedViewId&&(this.props.gridViewSelectorItems&&this.props.gridViewSelectorItems[this.props.selectedViewId]||this.props.quickFindViewId&&this.props.quickFindViewId===this.props.selectedViewId)&&(e=!0),!e){if(this.props.viewIds){this.props.viewIds.find(e=>e.guid===this.props.selectedViewId)&&(e=!0)}this.props.defaultViewId&&this.props.defaultViewId.guid!==v.a.EMPTYSTRING&&this.props.onChange(this.props.defaultViewId.guid,this.props.entityTypeName)}}_onItemIconPointerDown(e){const t=e,n=e.iconType===d.a.Pinned,r=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(y.z):null;let i=e.categoryId,a=this.props.entityTypeName;if(this.props.entityTypeName===P.a){const t=this.props.gridViewSelectorItems;a=t&&t[e.value]?t[e.value].relatedEntityName:a;i=!(!t||!t[e.value])&&t[e.value].isUserView?_.b.userview.toString():_.b.savedview.toString()}r&&r.info(`Toggle the the pin status for ${e.value} for ${a} entity`),this.props.onItemIconPointerDown(a,e.value,i,"",n).then(()=>{if(r&&r.info("Resetting the pin status of all the options and toggle the pin status of the recently selected item"),!n&&this.props.entityTypeName===P.a){const n=this.props.gridViewSelectorItems[t.value];this.props.pinnedActivityView.PinnedEntity=n.relatedEntityName,this.props.pinnedActivityView.ViewId=new v.a(e.value),this.props.pinnedActivityView.ViewType=n.isUserView?_.b.userview:_.b.savedview}for(const e in this.props.gridViewSelectorItems)this.props.gridViewSelectorItems[e].isPinned=e===t.value&&!n;this.forceUpdate()},e=>{r&&r.error("Could not pin the selected view, pinning action failed with error "+e)})}}function U(e,t,n,r){let i=[];if(t===P.a&&r){let t=1;G.forEach(n=>{i.push({id:t.toString(),name:Object(N.f)(e,n)}),t++})}else i=Object(P.mb)(e,n);return i}function q(e,t,n){let r;return t.forEach((t,i)=>{const a=function(e,t,n){let r=Object(O.f)(e,t,n);r&&!Object(R.b)(e)&&Object(D.l)(e,t)&&(r=Object.keys(r).reduce((i,a)=>((r[a].isAvailableInOffline||a===v.a.toString(Object(O.a)(e,t,n)))&&(i[a]=r[a]),i),{}));return r}(e,n,t);a&&(r=Object.assign(Object.assign({},r),a))}),r}W.displayName="DataSetViewSelector";const X=Object(s.a)((function(){let e=null,t=null,n=null,r={gridViewSelectorItems:null,viewCategories:null,allActivitiesString:null,activities:null,activityOptions:null,resourceStrings:null,quickFindViewId:null,styleProps:null};const i=Object(F.a)(),a=Object(E.h)();return(s,o)=>{const c=a(s,j.labelList),l=v.a.toString(Object(O.a)(s,o.entityTypeName,_.a.QUICKFIND_SEARCH));let u=null;let d=null;const p=i(s,o.contextString);G=Object(P.B)(s);let h=!1;if(o.queryViewSelectorTypes&&o.queryViewSelectorTypes.length>0&&!o.viewIds){if(o.entityTypeName===P.a&&o.shouldDisplayNestedViewSelector?(G.forEach(e=>{const t=q(s,o.queryViewSelectorTypes,e);t&&(u=Object.assign(Object.assign({},u),t))}),d=Object(E.e)(s,["ViewSelectorAllActivities"])):u=q(s,o.queryViewSelectorTypes,o.entityTypeName),e)for(const t in u)if(!e[t]||e[t]!==u[t]){h=!0;break}}else if(o.viewIds){const t={};for(let n=0;n<o.viewIds.length;n++){const r=Object(P.qb)(s,o.viewIds[n],o.id);if(r&&r.grid&&r.grid.rows){const n=e?e[r.viewId.guid]:void 0,i=!n||n.name!==r.title||n.queryType!==r.queryType,a=i?{name:r.title,queryType:r.queryType,isDefault:!1,isQuickFindQuery:!1,isUserView:r.isUserView}:n;Object.assign(t,{[r.viewId.guid]:a}),h=h||i}}t&&(u=t)}return!u||e&&Object.keys(e).length===Object.keys(u).length||(h=!0),d&&r.allActivitiesString!==d.ViewSelectorAllActivities&&(h=!0),t!==l&&(h=!0),n!==p&&(h=!0),h&&(e=u,t=l,n=p,r={gridViewSelectorItems:e,viewCategories:U(s,o.entityTypeName,j,o.shouldDisplayNestedViewSelector),allActivitiesString:d&&d.ViewSelectorAllActivities,activities:null,activityOptions:null,resourceStrings:c,quickFindViewId:t,styleProps:n,isInMobileModeForOct2019:Object(L.b)(s),useViewSelectorV2:Object(z.a)(s,V.le,V.h)}),r}}),(function(e){return{loadViewsByType:(t,n,r)=>{const i=[];return t.forEach((t,a)=>{t===_.a.MAIN_APPLICATION_VIEW&&r&&0!==Object.keys(r).length||i.push(e(Object(T.a)(n,t,void 0,void 0)))}),Promise.all(i)},loadAllActivityResourceString:()=>e(Object(w.e)(["ViewSelectorAllActivities"])),loadAllActivityTypes:t=>{let n=null;for(const e in t)t[e].Initialized!==A.a.Initialized&&(n||(n={}),n[e]=["DisplayName","ActivityTypeMask","IsVisibleInMobileClient"]);return n?e(Object(x.e)(n)):Promise.resolve()},loadGridViewsByViewId:(t,n)=>{const r=[];return t.forEach((t,i)=>{r.push(e(Object(T.a)(n,void 0,void 0,t)))}),Promise.all(r)},openPopup:t=>e(Object(M.a)(t)),closePopup:t=>e(Object(k.a)(t))}}))(W);var Y=n("Ki7F"),K=n("o0iw"),Q=n("XIN1"),Z=n("Wdaq"),J=n("/aHX"),$=n("ZGH+"),ee=n("AVDU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const te=42;class ne extends r.Component{constructor(e){super(e),this.onMeasuring=this.onMeasuring.bind(this),this.state={commandbarWidth:0},this._lastCommandManagerId=e.commandManagerId}onMeasuring(e){const t=e-((this.props.style.paddingLeft?"string"==typeof this.props.style.paddingLeft?Object($.e)(this.props.style.paddingLeft):this.props.style.paddingLeft:0)+(this.props.style.paddingRight?"string"==typeof this.props.style.paddingRight?Object($.e)(this.props.style.paddingRight):this.props.style.paddingRight:0))-(this.props.backButtonEnabled?te:0);t!==this.state.commandbarWidth&&this.setState({commandbarWidth:t})}componentDidUpdate(){this.props.commandManagerId!==this._lastCommandManagerId&&(this._lastCommandManagerId=this.props.commandManagerId,this.props.setCommandManagerId(this.props.pageId,this.props.commandManagerId,this.props.contextToken))}_renderConsoleAppBackButton(){return this.props.backButtonEnabled?r.createElement(J.a,{pageId:this.props.pageId}):null}_renderNativeSubgridCommandBar(){return this.props.isNativeMode?r.createElement(B.e,{commandManagerId:this.props.commandManagerId,pageId:this.props.pageId}):null}render(){if(!this.props.pageId||!this.props.ribbonId||!this.props.commandManagerId)return null;const e=!this.state.commandbarWidth,t=r.createElement(Y.a,{commandBarStyle:this.props.commandbarStyles,width:this.state.commandbarWidth,commandbarDisplayMode:K.a.IconLabel,key:this.props.pageId,iconPosition:Q.a.Left,commandManagerId:this.props.commandManagerId,id:this.props.pageId,ribbonId:this.props.ribbonId,relationshipType:this.props.relationshipType,addedCommandList:this.props.addedCommandList,appendedCommandList:this.props.appendedCommandList,contextToken:this.props.contextToken,metaDataLoadedResolve:this.props.metaDataLoadedResolve,isHidden:e,rootZIndex:this.props.rootZIndex,customControlType:this.props.customControlType,isNativeMode:this.props.isNativeMode});return this.props.isInMobileModeForOct2019&&this.props.isGridRoot?t:r.createElement(o.a,{key:"commandBar_"+this.props.pageId,testhooks:{id:"commandBar_"+this.props.pageId},style:this.props.style,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0},this._renderConsoleAppBackButton(),t,this._renderNativeSubgridCommandBar())}}ne.displayName="DataSetCommandBar";const re=Object(s.a)((function(){return(e,t)=>{const n=Object(L.b)(e);return{commandManagerId:Object(P.w)(e,t.pageId,t.contextToken)||t.commandManagerId,backButtonEnabled:Object(ee.d)(e)&&t.isGridRoot&&!t.collapsed,isInMobileModeForOct2019:n}}}),(function(e){return{setCommandManagerId:(t,n,r)=>{t&&n&&r&&e(Object(Z.b)(t,n,r))}}}))(ne);var ie=n("A6np"),ae=n("jAuy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function se(e){if(e){const t=e.split(":");if(2===t.length){return t[1].split(",")}}return[]}function oe(e){if(e&&e.filterOptions&&e.filterOptions.length>0){let t=e.filterOptions.filter(e=>e.isDefault);const n=e.userSetting,i=n&&n.defaultGridViews&&n.defaultGridViews[e.entityTypeName];let a,s;i&&""!==i.QueueId&&(t=e.filterOptions.filter(e=>Object(P.bb)(i.QueueId).sort().join(",")===se(e.value).sort().join(","))),e.isGridPaginationStateFeatureEnabled&&null!=e.previousValue&&(a=Object(ae.f)(e.filterOptions,e.previousValue),s=e.previousValue),a||(t.length>0?(a=t[0].text,s=t[0].value):(a=e.filterOptions[0].text,s=e.filterOptions[0].value)),e.updateFilterValue(s);const c=Object(E.c)(e.resourceStrings,j.QUEUE_FILTER_LABEL),l=r.createElement(ie.a,{key:"gridFilter",testhooks:{id:"gridFilter_"+e},title:c,accessibilityLabel:c,defaultValue:a,options:e.filterOptions,onChange:e.onFilterChange,createAccessibilityComponent:I.a,style:e.comboBoxStyle,createKeyboardShortcut:I.b,freeTextMode:!0,suppressFreeTextChangeCallback:!0});return r.createElement(o.a,{key:"GridFilterView",style:e.style},l)}const t=e.TraceManager&&e.TraceManager.getTracer?e.TraceManager.getTracer(y.z):null;return t&&t.info("Queue Filter not rendered because there are no filter options available"),null}var ce=n("KOTC"),le=n("CbNq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ue={Id:"toggleButtonControl",Label:null,Name:"toggleButtonControl",ShowLabel:!1,Visible:!0,Disabled:!1},de={FormFactor:2,CustomControlId:"MscrmControls.FlipSwitch.FlipSwitchControl",Name:"MscrmControls.FlipSwitch.FlipSwitchControl",Version:"1.0.0",Parameters:{value:{Usage:3,Static:!1,Value:0,Type:"TwoOptions",Attributes:{DefaultValue:0,Options:null},Callback:null}},ShouldOverrideControlVisible:!1};function pe(e,t){if(!e.isRollupViewSupported)return null;const n=function(e){const t=[];if(!Array.isArray(e))return t;for(let n=0;n<e.length;++n)t.push({Label:e[n],Value:n});return t}([Object(E.c)(e.resourceStrings,j.ROLLUPVIEW_SWITCH_OFF),Object(E.c)(e.resourceStrings,j.ROLLUPVIEW_SWITCH_ON)]),i=e.isOffline,a=(s=e.toggleValue,o=t,c=e.onToggleChange,l=n,Object.assign(Object.assign({},de),{Parameters:{value:{Usage:3,Static:!1,Type:"TwoOptions",Value:s?1:0,Attributes:{DefaultValue:0,Options:l,DisplayName:o},Callback:c}}}));var s,o,c,l;const u=function(e,t){return Object.assign(Object.assign({},ue),{Label:e,Disabled:t})}(t,i),d="rollup_view_switch_"+e.id;return r.createElement(p.c,{key:d,controlId:d,id:e.id,systemDefinedProperties:null,descriptor:u,configuration:a,formInfo:void 0,shouldRender:!0,parentContextToken:null,parentDefinedControlProps:void 0})}function he(e,t,n,i,a){const s=e.theme,c=e.isRTL,l=e.isActivityManagementFeatureEnabled&&e.entityIsActivityType;return r.createElement(o.a,{key:"ActivityViewContainer",role:"presentation",style:e.activityViewContainerStyle},r.createElement(o.a,{key:"ActivityDueDateFilterView",style:l?e.activityTypeContainerStyle:e.containerStyle},[t,n]),a?r.createElement(o.a,{key:"ActivityTypeFilterView",style:e.activityTypeContainerStyle},[i,a]):null,function(e,t,n,i){if(!t)return;const a=Object(E.c)(e.resourceStrings,j.ROLLUPVIEW_SWITCH_LABEL),s={flex:"1 1 auto",marginLeft:n.sizes.Measures.Measure200,marginRight:n.sizes.Measures.Measure200,marginTop:n.sizes.Measures.Measure050,minWidth:"15rem"},c={whiteSpace:"nowrap",flex:"1 0 auto",marginRight:i?0:n.sizes.Measures.Measure100,marginLeft:i?n.sizes.Measures.Measure100:0};return r.createElement(o.a,{key:"RollupViewControlContainer",style:s},r.createElement(o.a,{key:"rollupViewFilterLabelView",style:c},a),pe(e,a))}(e,e.isRollupViewSupported,s,c))}const ge=Object(s.a)(void 0,(function(e){return{openPopup:t=>e(Object(M.a)(t)),closePopup:t=>e(Object(k.a)(t))}}))((function(e){const t=e.TraceManager&&e.TraceManager.getTracer?e.TraceManager.getTracer(y.z):null;let i,a="";const s=e.isActivityManagementFeatureEnabled&&e.entityIsActivityType;if(e&&e.filterOptions&&e.filterOptions.length>0){const t=e.filterOptions.filter(e=>e.isDefault);s&&(i=Object(le.d)(e.filterOptions)),e.isGridPaginationStateFeatureEnabled&&null!=e.previousValue&&(a=s?e.previousValue:Object(ae.f)(e.filterOptions,e.previousValue)),a||(a=t.length>0?s?t[0].value:t[0].text:s?e.filterOptions[0].value:e.filterOptions[0].text)}const[c,u]=r.useState(a);if(e&&e.filterOptions&&e.filterOptions.length>0){const d={flex:"1 0 auto",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",width:"0px"},p=s?Object(E.c)(e.resourceStrings,e.dueDateFilterLabelResourceString):Object(E.c)(e.resourceStrings,e.entityFilterLabelResourceString);let h=null;p&&(h=r.createElement(l.a,{key:"activityDueDateFilterLabel",style:s?e.activityMgmtLabelStyle:e.labelStyle}," ",p," "));const g=r.createElement(o.a,{key:"activityDueDateFilterLabelView",style:{alignItems:"center",justifyContent:"center"}},h);let m=r.createElement(ie.a,{key:"activityDueDateFilterComboBox",testhooks:{id:"activityDueDateFilterComboBox_"+e.id},id:"activityDueDateFilterComboBox",defaultValue:a,options:e.filterOptions,onChange:e.onFilterChange,createAccessibilityComponent:I.a,style:e.comboBoxStyle,textStyle:d,createKeyboardShortcut:I.b,openPopup:e.openPopup,closePopup:e.closePopup,parentCustomControlId:"activityDueDateFilterComboBox",rootZIndex:e.rootZIndex,accessibilityLabel:p,freeTextMode:!0,suppressFreeTextChangeCallback:!0});s&&(m=r.createElement(ce.a,{key:"activityDueDateFilterComboBox",loader:()=>Promise.all([n.e(10),n.e(11),n.e(13),n.e(12),n.e(14),n.e(15),n.e(17),n.e(21),n.e(28),n.e(90)]).then(n.bind(null,"YDph")).then(e=>e.ComboBox),props:{selectedKey:c,key:"activityDueDateFilterComboBox",id:"activityDueDateFilterComboBox",options:i,onChange:(t,n)=>{u(n.key),e.onFilterChange(n.key)},style:e.dueDatecomboBoxStyle,ariaLabel:p,useComboBoxAsMenuWidth:!0,allowFreeform:!0}}));if(e.isActivityManagementFeatureEnabled&&!e.isOffline&&!e.isMobile&&e.gridEntityName===y.a){let i=null;const a=Object(E.c)(e.resourceStrings,e.activityTypeFilterLabelResourceString);a&&(i=r.createElement(l.a,{key:"activityTypeFilterLabel",style:e.activityMgmtLabelStyle}," ",a," "));const s=r.createElement(o.a,{key:"activityTypeFilterLabelView",style:{alignItems:"center",justifyContent:"center"}},i);let c;if(e.filterOptionsForActivityType&&e.filterOptionsForActivityType.length>0){t&&t.info("Activity Management Filter - Activity Type Filter Rendered with no. of options "+e.filterOptionsForActivityType.length);let i=Object(le.c)(e.filterOptionsForActivityType);if(e.isActivityFilterSelectAllEnabled){const t=Object(E.c)(e.resourceStrings,j.ACTIVITYTYPE_SELECTALL),n=[];n.push({key:"selectAllKey",text:t}),i=n.concat(i)}let s=[];e.isGridPaginationStateFeatureEnabled&&null!=e.activityTypePreviousValues&&(s=Object(le.b)(e.activityTypePreviousValues)),c=r.createElement(ce.a,{key:"activityTypeFilterBox",loader:()=>Promise.all([n.e(10),n.e(28),n.e(40)]).then(n.bind(null,"yiyP")).then(e=>e.ActivityTypeCombobox),props:{key:"activityTypeFilterBox",id:"activityTypeFilterBox",selectedOptionKeys:s,onActivityTypeFilterClear:()=>{e.onActivityTypeFilterClear()},onActivityTypeMenuDismissed:t=>{e.onActivityTypeChange(t)},options:i,ariaLabel:a,isRTL:e.isRTL,style:e.activityTypeContainerStyle,resourceStrings:e.resourceStrings,selectAllEnabled:e.isActivityFilterSelectAllEnabled}})}return he(e,g,m,s,c)}return he(e,g,m,null,null)}return t&&t.info("Activity Filter not rendered because there are no filter options available"),null}));var me=n("nJrx"),be=n("gvL4"),ye=n("Smta"),fe=n("vTeb"),Se=n("evW+"),ve=n("1AYO"),Ce=n("hSDL"),Oe=n("unFF"),_e=n("tJ+6");var Ie=n("kC0I"),je=n("3rse"),Pe=n("00VO"),Fe=n("FhVi"),Te=n("Afz2"),we=n("Gilj"),Ee=n("cz9j"),xe=n("L4PC"),Ne=n("H4dV");class Ae extends r.Component{constructor(e){super(e),this._cachedSelectedFilter="",this._onFilterChange=this._onFilterChange.bind(this),this._toggleJumpBarFlyout=this._toggleJumpBarFlyout.bind(this),this._closeJumpBarDomId="close-jumpbar-"+Object(me.a)(),this._selectedFilterDomId="selected-filter-"+Object(me.a)(),this.state={isFlyoutOpened:!1}}_onOutsideClickHandler(e,t){const n=t.target,r=document.getElementById(e);n&&!r.contains(n)&&r!==n&&this._toggleJumpBarFlyout()}keyDownHandler(e){switch(e.EVENT.keyCode){case je.a.Escape:this._setIsFlyoutOpenedState(!1)}}_toggleJumpBarFlyout(){this._setIsFlyoutOpenedState(!this.state.isFlyoutOpened)}_setIsFlyoutOpenedState(e){this.setState({isFlyoutOpened:e}),Object(Ee.g)(e)}_filterGrid(e){let t,n=e.getAttribute("data-value");if(n!==this._cachedSelectedFilter&&(this.props.updateDataSetLoadingState(1),this._cachedSelectedFilter=n),1033===this.props.languageId&&n){const t=e.getAttribute("data-value").toUpperCase();t!==n&&(n=`${n}|${t}`)}t=this.props.dataSetFetchXml?Object(Pe.c)(this.props.dataSetFetchXml,this.props.entityAttributeMetadata,this.props.primaryNameAttribute):this.props.primaryNameAttribute,this.props.applyGridFilter(Object(Pe.b)(n,t),this.props.isGridRoot,this.props.contextToken),this._setIsFlyoutOpenedState(this.props.renderMobile&&!this.state.isFlyoutOpened)}_onFilterChange(e){let t=e.target;const n=e;("click"===e.type||n&&n.keyCode===je.a.Enter)&&(e.preventDefault(),t&&"a"===t.tagName.toLowerCase()&&(t=t.parentElement),this._filterGrid(t))}_renderListItem(e,t,n){let i=Object.assign({},this.props.renderMobile?this.props.styles.listItemStyleMobile:this.props.styles.listItemStyle),a=Object.assign(Object.assign({},this.props.styles.hyperlinkStyle),this.props.renderMobile?this.props.styles.hyperlinkStyleMobile:null);return n.describedByElementId&&(i=Object.assign(i,this.props.renderMobile?this.props.styles.listItemSelectedStyleMobile:this.props.styles.listItemSelectedStyle),a=Object.assign(a,this.props.renderMobile?this.props.styles.hyperlinkSelectedStyleMobile:null)),r.createElement(ye.a,Object.assign({},n,{style:i}),r.createElement(fe.a,Object.assign({},e,{style:a}),t))}_createKeyboardShortcuts(){const e=Object(E.c)(this.props.resourceStrings,j.CLOSE_JUMPBAR_ARIALABEL),t=this.keyDownHandler.bind(this),n=[],r=new we.a([je.a.Escape],t,!0,"",e);return n.push(r),n}_renderJumpBarAlphabet(){const e=[],t=Object(E.c)(this.props.resourceStrings,j.JUMPBAR_ALPHABET),n=Object(E.c)(this.props.resourceStrings,j.JUMPBAR_NUMBER_INDICATOR),r=Object(E.c)(this.props.resourceStrings,j.JUMPBAR_NUMBER_TOOLTIP),i=Ne.a.getInstance(),a=!!i&&i.get_IsIOS();return t.split(",").forEach(t=>{const i=Object(Ie.h)(t),s=i[0],o=i[1],c=s+"_listItem",l=s+"_link",u={id:c,key:c,accessibilityLabel:String.format(j.FILTERBY_ARIALABEL,o),role:Te.q,onClick:this._onFilterChange,onKeyDown:this._onFilterChange,tabIndex:-1},d={id:l,key:l,testhooks:{id:l},tabIndex:-1,role:Te.r,accessibilityHidden:!a,accessibilityLabel:a?String.format(j.FILTERBY_ARIALABEL,o):void 0};s===n&&(d.title=r,d.accessibilityLabel=j.NUMBER_ARIALABEL),this.props.selectedFilter!==s&&this.props.selectedFilter!==o||(u.describedByElementId=this._selectedFilterDomId,u.isSelected=!0,u.tabIndex=0),o&&(u.dataValue=o),e.push(this._renderListItem(d,s,u))}),e}_renderJumpBarAll(){const e=Object(E.c)(this.props.resourceStrings,j.JUMPBAR_ALL),t=Object(E.c)(this.props.resourceStrings,j.JUMPBAR_ALL_TITLE);this._allListItemDomId=e+"_listItem";const n=e+"_link",r=Ne.a.getInstance(),i=!!r&&r.get_IsIOS(),a={id:this._allListItemDomId,key:this._allListItemDomId,onClick:this._onFilterChange,onKeyDown:this._onFilterChange,role:Te.q,tabIndex:-1,accessibilityLabel:String.format(j.FILTERBY_ARIALABEL,e)},s={id:n,key:n,testhooks:{id:n},tabIndex:-1,role:Te.r,accessibilityHidden:!i,accessibilityLabel:i?String.format(j.FILTERBY_ARIALABEL,e):void 0,title:t};return this.props.selectedFilter&&this.props.selectedFilter!==e||(a.describedByElementId=this._selectedFilterDomId,a.isSelected=!0,a.tabIndex=0),this._renderListItem(s,e,a)}_renderList(){const e=Object(E.c)(this.props.resourceStrings,j.JUMPBAR_LETTER_TITLE);return r.createElement(be.a,{id:"JumpBarItemsList",key:"JumpBarItemsList",testhooks:{id:"JumpBarItemsList"},title:e,role:Te.j,onKeyDown:this._onJumpbarKeyDown.bind(this),style:Object.assign(Object.assign({},this.props.styles.jumpBarStyle),this.props.renderMobile?this.props.styles.jumpBarStyleMobile:null),accessibilityLabel:j.JUMPBAR_ARIALABEL},this._renderJumpBarAll(),this._renderJumpBarAlphabet())}_onJumpbarKeyDown(e){const t=e.target;if(this.state.isFlyoutOpened){const n=9===e.keyCode,r=e.shiftKey;if(n){if(e.stopPropagation(),e.preventDefault(),r){if(t.id===this._closeJumpBarDomId)return void document.querySelector("#JumpBarItemsList").lastElementChild.focus();const e=t.previousElementSibling;e?e.focus():t.id===this._allListItemDomId&&document.getElementById(this._closeJumpBarDomId).focus()}else{if(t.id===this._closeJumpBarDomId)return void document.getElementById(this._allListItemDomId).focus();if(t.parentElement&&t.parentElement.lastElementChild&&t.id===t.parentElement.lastElementChild.getAttribute("id"))return void document.getElementById(this._closeJumpBarDomId).focus();const e=t.nextElementSibling;e&&e.focus()}return}}if(e.keyCode===je.a.UpArrow||e.keyCode===je.a.DownArrow||e.keyCode===je.a.LeftArrow||e.keyCode===je.a.RightArrow){e.stopPropagation(),e.preventDefault();const n=e.keyCode===je.a.DownArrow||e.keyCode===je.a.RightArrow,r=e.keyCode===je.a.UpArrow||e.keyCode===je.a.LeftArrow;if(n){const e=t.nextElementSibling;return void(e&&e.focus())}if(r){const e=t.previousElementSibling;return void(e&&e.focus())}}}_renderJumpBarFlyout(e,t){const n="jumpbar-flyout_"+this.props.id,i=n+"Accessibility",a=[];return a.push(r.createElement(Fe.a,{key:i,rootElementId:n,shouldManageFocus:!0,isModal:!0,keyboardShortcuts:this._createKeyboardShortcuts(),defaultFocusId:this._closeJumpBarDomId})),r.createElement(o.a,{role:Te.e},r.createElement(ve.a,{id:n,testhooks:{id:n},key:n,rootZIndex:this.props.rootZIndex,positionType:"relative",relativeToElementId:t,flyoutStyle:this.props.styles.jumpBarFlyoutStyle,flyoutDirection:this.props.isRTL?ve.b.upleft:ve.b.rightup,onOutsideClick:this._onOutsideClickHandler.bind(this,e)},r.createElement(Se.a,{key:"cancel",style:this.props.styles.closeButtonStyle,id:this._closeJumpBarDomId,onClick:this._toggleJumpBarFlyout,onKeyDown:this._onJumpbarKeyDown.bind(this),accessibilityLabel:j.CLOSE_JUMPBAR_ARIALABEL},r.createElement(l.a,{style:this.props.styles.closeButtonTextStyle},r.createElement(Q.b,{type:d.a.Close}))),this._renderList()),a)}_renderFlyoutButton(e){const t=Object(E.c)(this.props.resourceStrings,j.JUMPBAR_LETTER_TITLE),n=Object(E.c)(this.props.resourceStrings,j.JUMPBAR_ALPHABET).split(",");let i="";for(let e=0;e<3;e++){i+=Object(Ie.h)(n[e+1])[0]}return r.createElement(Se.a,{id:e,accessibilityLabel:t,title:t,style:this.props.isMobile?this.props.styles.jumpBarButtonMobileStyle:this.props.styles.jumpBarButtonStyle,onClick:this._toggleJumpBarFlyout,testhooks:{id:e}},r.createElement(l.a,{style:this.props.styles.jumpBarButtonTextStyle},i))}render(){try{if(this.props.resourceStrings){const e="jumpBarRoot_"+this.props.id,t=`${e}_${this.props.uniqueId}`,n="jumpbarBtn_"+(this.props.uniqueId||this.props.id),i={position:"relative"};this.props.renderMobile&&Object.assign(i,{maxWidth:"100%"});const a={height:"0",width:"0"},s="flyoutRelativeElement"+this.props.controlKey;return r.createElement(o.a,{id:t,key:t,testhooks:{id:e},style:i},this.props.isRTL?null:r.createElement(o.a,{id:s,style:a,role:"presentation","aria-hidden":"true"}),this.props.renderMobile?this._renderFlyoutButton(n):this._renderList(),this.state.isFlyoutOpened?this._renderJumpBarFlyout(n,s):null,r.createElement(o.a,{style:{display:"none"},id:this._selectedFilterDomId,key:this._selectedFilterDomId,role:" "},j.SELECTEDFILTER_TEXT),this.props.isRTL?r.createElement(o.a,{id:s,style:a,role:"presentation","aria-hidden":"true"}):null)}return null}catch(e){return console.error(e.message),null}}}const ke=Object(s.a)((function(){let e=null,t=null,n=null;const r=Object(E.h)(),i=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e=null,t=null;return function(n,r){var i,a,s,o,c,l,u,d,p,h,g,m,b,y,f,S,v,C,O,_,I,j,P,F,T,w,E,x,N,A,k,M,D,R;const B=Object(Oe.a)(n),L=Object(_e.b)(n)&&Object(z.a)(n,V.Fb,V.Lc)&&(null===(i=Object(_e.a)(n))||void 0===i?void 0:i.Components)?Object(_e.a)(n).Components:null;return t!==B&&(t=B,e={jumpBarStyle:{width:"100%",height:B.sizes.Measures.Measure300,display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",listStyleType:"none",backgroundColor:(null===(o=null===(s=null===(a=null==L?void 0:L.Grid)||void 0===a?void 0:a.Footer)||void 0===s?void 0:s.JumpBar)||void 0===o?void 0:o.BackgroundColor)||B.colors.BaseColor.Grey.Grey1,border:"1px solid transparent"},jumpBarButtonStyle:{display:"flex",fontSize:B.fontSizes.Font085,fontFamily:B.fontFamilies.Regular,color:(null===(u=null===(l=null===(c=null==L?void 0:L.Grid)||void 0===c?void 0:c.Footer)||void 0===l?void 0:l.JumpBar)||void 0===u?void 0:u.TextColor)||B.colors.MainThemeColor.MainColor1.Fill,cursor:B.display.PointerCursorStyle,borderStyle:"none",backgroundColor:"transparent",padding:"0",marginLeft:B.sizes.Measures.Measure100,marginRight:B.sizes.Measures.Measure100,marginTop:B.sizes.Measures.Measure050,marginBottom:B.sizes.Measures.Measure050,maxWidth:"100%"},jumpBarButtonMobileStyle:{display:"flex",fontSize:B.fontSizes.Font100,fontFamily:B.fontFamilies.Regular,color:(null===(h=null===(p=null===(d=null==L?void 0:L.Grid)||void 0===d?void 0:d.Footer)||void 0===p?void 0:p.JumpBar)||void 0===h?void 0:h.TextColor)||B.colors.MainThemeColor.MainColor1.Fill,cursor:B.display.PointerCursorStyle,borderStyle:"none",backgroundColor:"transparent",padding:"0",marginLeft:B.sizes.Measures.Measure100,marginRight:B.sizes.Measures.Measure100,marginTop:B.sizes.Measures.Measure050,marginBottom:B.sizes.Measures.Measure050,maxWidth:"100%"},jumpBarButtonTextStyle:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},jumpBarFlyoutStyle:{border:B.borders.Border02,backgroundColor:B.colors.BaseColor.Grey.Grey1,overflowY:"auto",overflowX:"hidden"},closeButtonStyle:{position:"absolute",top:"0",right:"0",borderStyle:"none",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"transparent",cursor:B.display.PointerCursorStyle,padding:B.sizes.Measures.Measure100,width:B.sizes.Measures.Measure300,height:B.sizes.Measures.Measure300},closeButtonTextStyle:{fontSize:"16px",color:B.colors.BaseColor.Grey.Grey7},jumpBarStyleMobile:{height:"auto",flexWrap:"wrap",display:"flex",alignItems:"center",justifyContent:"flex-start",paddingTop:B.sizes.Measures.Measure300,paddingRight:B.sizes.Measures.Measure050,paddingBottom:B.sizes.Measures.Measure150,paddingLeft:B.sizes.Measures.Measure300,maxWidth:"20rem"},listItemStyle:{textAlign:"center",position:"relative",height:B.sizes.Measures.Measure125},listItemSelectedStyle:{borderStyle:"solid",borderBottomColor:(null===(b=null===(m=null===(g=null==L?void 0:L.Grid)||void 0===g?void 0:g.Footer)||void 0===m?void 0:m.JumpBar)||void 0===b?void 0:b.SelectedColor)||B.colors.MainThemeColor.MainColor1.Fill,borderBottomWidth:B.sizes.Measures.Measure025},listItemStyleMobile:{display:"flex",alignItems:"center",justifyContent:"center",cursor:B.display.PointerCursorStyle,marginRight:B.sizes.Measures.Measure150,marginBottom:B.sizes.Measures.Measure150,width:B.sizes.Measures.Measure300,height:B.sizes.Measures.Measure300,border:B.borders.Border01,borderColor:(null===(S=null===(f=null===(y=null==L?void 0:L.Grid)||void 0===y?void 0:y.Footer)||void 0===f?void 0:f.JumpBar)||void 0===S?void 0:S.BorderColor)||B.colors.BaseColor.Blue.Blue3,backgroundColor:(null===(O=null===(C=null===(v=null==L?void 0:L.Grid)||void 0===v?void 0:v.Footer)||void 0===C?void 0:C.JumpBar)||void 0===O?void 0:O.BackgroundColorMobile)||B.colors.BaseColor.White,":nth-child(2)":{marginRight:"50%"},outlineOffset:"0px !important"},listItemSelectedStyleMobile:{borderColor:(null===(j=null===(I=null===(_=null==L?void 0:L.Grid)||void 0===_?void 0:_.Footer)||void 0===I?void 0:I.JumpBar)||void 0===j?void 0:j.SelectedBorderColor)||B.colors.BaseColor.Transparent,backgroundColor:(null===(T=null===(F=null===(P=null==L?void 0:L.Grid)||void 0===P?void 0:P.Footer)||void 0===F?void 0:F.JumpBar)||void 0===T?void 0:T.SelectedColorMobile)||B.colors.BaseColor.Grey.Grey2},hyperlinkStyle:{textDecoration:"none",textAlign:"center",fontSize:B.fontSizes.Font085,fontFamily:B.fontFamilies.Regular,whiteSpace:"nowrap",color:(null===(x=null===(E=null===(w=null==L?void 0:L.Grid)||void 0===w?void 0:w.Footer)||void 0===E?void 0:E.JumpBar)||void 0===x?void 0:x.LinkColor)||B.colors.BaseColor.Grey.Grey7},hyperlinkStyleMobile:{color:(null===(k=null===(A=null===(N=null==L?void 0:L.Grid)||void 0===N?void 0:N.Footer)||void 0===A?void 0:A.JumpBar)||void 0===k?void 0:k.LinkColor)||B.colors.BaseColor.Blue.Blue3},hyperlinkSelectedStyleMobile:{color:(null===(R=null===(D=null===(M=null==L?void 0:L.Grid)||void 0===M?void 0:M.Footer)||void 0===D?void 0:D.JumpBar)||void 0===R?void 0:R.SelectedBorderColor)||B.colors.BaseColor.Grey.Grey7}}),e}}();return(a,s)=>{const o=i(a,s);if(null===e&&(e=Object(N.E)(a,s.entityTypeName)),null==t&&(t=a.metadata.attributes[s.entityTypeName]),Object(z.a)(a,V.ac)){const e=Object(P.v)(a,s.id,s.contextToken);n=e&&e.fetchXml}return{resourceStrings:r(a,j.labelList),primaryNameAttribute:e,dataSetFetchXml:n,entityAttributeMetadata:t,styles:o}}}),(function(e,t){return{applyGridFilter:(n,r,i)=>{if(e(Object(Ce.m)(n,t.id,i)),e(Object(xe.b)(t.id,i,1)),r){const e=[{filterType:4,filterExpressionOrValue:n}];t.updateGridPaginationStateHandler(e,t.id),t.setResetPagingInfoForEnhancedPaging()}}}}))(Ae);var Me=n("49Nd");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var De=n("5UPV"),Re=n("RrRu"),Be=n("jRHm"),Le=n("lEp6"),Ve=n("wFY3"),ze=n("LAGg"),He=n("fU7K");class Ge extends r.Component{constructor(e){super(e),this._goToFirstPage=this._goToFirstPage.bind(this),this._goToPreviousPage=this._goToPreviousPage.bind(this),this._goToNextPage=this._goToNextPage.bind(this),Object(E.c)(e.resourceStrings,Me.d)||e.retrieveResourceStrings(Me.k)}_firstButtonEnabled(e){return this.props.currentPage>1}_nextButtonEnabled(e){return(!(this.props.currentPage===Math.floor(e.totalResultCount/e.pageSize))||!this.props.pagingInfo.isGridScrolledToBottom)&&e.hasNextPage}_previousButtonEnabled(e){return this.props.currentPage>1}_goToNextPage(e){this.props.updateDataSetLoadingState(1),this.props.incrementLastPage(),this.props.setNewPageRequested(!0),this.props.updatePageNumber(this.props.currentPage+1),this._setFooterButtonsFocus(e,!0)}_goToPreviousPage(e){this.props.updateDataSetLoadingState(1),this.props.setNewPageRequested(!0),this.props.updatePageNumber(this.props.currentPage-1),this._setFooterButtonsFocus(e,!1)}_goToFirstPage(e){this.props.updateDataSetLoadingState(1),this.props.setNewPageRequested(!0),this.props.setFirstPage(1),this.props.updatePageNumber(1),this._setFooterButtonsFocus(e,!1)}_setFooterButtonsFocus(e,t){if(null!==e&&null!==e.currentTarget&&null!==e.currentTarget.parentElement&&null!==e.currentTarget.parentElement.children)if(t&&e.currentTarget.parentElement.children.length>=2&&null!==e.currentTarget.parentElement.children[1]){const t=e.currentTarget,n=e.currentTarget.parentElement.children[1];setTimeout(()=>{t.disabled&&n.focus()},500)}else if(!t&&null!==e.currentTarget.parentElement.lastElementChild){const t=e.currentTarget,n=e.currentTarget.parentElement.lastElementChild;setTimeout(()=>{t.disabled&&n.focus()},500)}}_getResources(){if(this._loadFirstPage=this._loadFirstPage||Object(E.c)(this.props.resourceStrings,Me.d),this._loadNextPage=this._loadNextPage||Object(E.c)(this.props.resourceStrings,Me.e),this._loadPreviousPage=this._loadPreviousPage||Object(E.c)(this.props.resourceStrings,Me.f),!this._spaceResource){const e=Object(E.c)(this.props.resourceStrings,Me.j);this._spaceResource=Object(He.CrmHtmlDecode)(e)}this._gridInfoResource=this._gridInfoResource||Object(E.c)(this.props.resourceStrings,Me.a),this._gridTotalCount=this._gridTotalCount||Object(E.c)(this.props.resourceStrings,Me.c),this._itemSelected=this._itemSelected||Object(E.c)(this.props.resourceStrings,Me.b),this._totalApproximate=this._totalApproximate||Object(E.c)(this.props.resourceStrings,Me.h),this._totalExact=this._totalExact||Object(E.c)(this.props.resourceStrings,Me.i)}render(){if(!this.props.pagingData)return null;const e=Object(Le.a)(this.props.pagingData);let t=0,n=0;e.totalResultCount&&(this.props.enhancedPagingDisabled?(t=e.pageSize*(this.props.currentPage-1)+1,n=this.props.currentPage*e.pageSize,-1!==e.totalResultCount&&this.props.currentPage*e.pageSize>e.totalResultCount&&(n=e.totalResultCount,this.props.isServerOffline&&this.props.currentPage>1&&(n=e.pageSize*(this.props.currentPage-1)+e.totalResultCount))):(t=e.pageSize*(this.props.pagingInfo.firstPageNumber-1)+1,n=this.props.pagingInfo.lastPageNumber*e.pageSize,this.props.pagingInfo.pageShift>0&&(t+=this.props.pagingInfo.pageShift,n+=this.props.pagingInfo.pageShift),-1!==e.totalResultCount&&this.props.pagingInfo.lastPageNumber*e.pageSize>e.totalResultCount&&(n=e.totalResultCount,this.props.isServerOffline&&this.props.currentPage>1&&(n=e.pageSize*(this.props.currentPage-1)+e.totalResultCount))));const i=e.totalResultCount,a=this._firstButtonEnabled(e),s=this._nextButtonEnabled(e),c=this._previousButtonEnabled(e);this._getResources();let l=i;-1===i&&(l=n<this.props.gridTotalRecordsCountLimit?this.props.gridTotalRecordsCountLimit:n);let u="";u=-1===i?String.format(this._totalApproximate,this.props.isServerOffline?n:l):this.props.isServerOffline&&i>e.pageSize?String.format(this._totalApproximate,n):String.format(this._totalExact,this.props.isServerOffline?n:i);const d=String.format(this._gridTotalCount,this._spaceResource,u),p=this.props.selectedRowCount>0?String.format(this._itemSelected,this._spaceResource,this.props.selectedRowCount):null,h=Object(E.c)(this.props.resourceStrings,Me.g),g=String.format(h,this.props.currentPage);let m=i/e.pageSize;return this.props.isServerOffline&&0!==this.props.currentPage&&(m=-1/e.pageSize),r.createElement(o.a,{style:this.props.styleProps.containerStyle},this._renderPagingText(t,n,d,p),this._renderPagingButtons(a,s,c,g,m))}_renderPagingButtons(e,t,n,i,a){return(a<0||a>1)&&this.props.enhancedPagingDisabled?r.createElement(o.a,{style:this.props.styleProps.navigationPanelStyle},r.createElement(Se.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"loadFirstPage_"+this.props.id},accessibilityLabel:this._loadFirstPage,disabled:!e,tabIndex:0,onClick:this._goToFirstPage},r.createElement(Q.b,{type:d.a.FirstPageButton})),r.createElement(Se.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"moveToPreviousPage_"+this.props.id},accessibilityLabel:this._loadPreviousPage,disabled:!n,tabIndex:0,onClick:this._goToPreviousPage},r.createElement(Q.b,{type:d.a.BackButton})),r.createElement(l.a,{style:this.props.styleProps.pageNumberStyle,testhooks:{id:"pageNumber_"+this.props.id},role:Te.a,notificationType:Ve.b},null!==this.props.currentPage?String.format(i,this.props.currentPage):null),r.createElement(Se.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"moveToNextPage_"+this.props.id},accessibilityLabel:this._loadNextPage,disabled:!t,tabIndex:0,onClick:this._goToNextPage},r.createElement(Q.b,{type:d.a.Forward}))):null}_renderPagingText(e,t,n,i){if(!this.props.pagingTextDisabled&&this.props.shouldPagingTextRender&&this.props.gridTotalRecordsCountLimit)return r.createElement(o.a,{style:this.props.styleProps.pagingTextStyle,testhooks:{id:"pagingText"}},r.createElement(l.a,null,String.format(this._gridInfoResource,e,t,n,i)))}}const We=Object(s.a)((function(){let e=null;const t=Object(E.h)(),n=function(){let e=null,t=null;const n={containerStyle:{justifyContent:"space-between",alignItems:"center",width:"100%"},navigationPanelStyle:{flexDirection:"row"},pageNumberStyle:{whiteSpace:"nowrap"},pagingButton:{borderStyle:"none",display:"inline-block",backgroundColor:"transparent",fontSize:"16px"}};return function(r,i){var a,s,o,c,l,u,d,p,h,g;const m=Object(_e.b)(r)&&Object(z.a)(r,V.Fb,V.Lc)&&(null===(a=Object(_e.a)(r))||void 0===a?void 0:a.Components)?Object(_e.a)(r).Components:null;if(e!==i){e=i;const a=Object(Oe.a)(r),{isRTL:b}=r.user.userSettings,y=Object.assign(Object.assign({},n.containerStyle),{marginRight:a.sizes.Measures.Measure100,marginLeft:a.sizes.Measures.Measure100}),f=Object.assign(Object.assign({},n.navigationPanelStyle),{["margin"+(b?"Right":"Left")]:"auto"}),S=Object.assign(Object.assign({},n.pageNumberStyle),{marginRight:a.sizes.Measures.Measure100,marginLeft:a.sizes.Measures.Measure100,fontSize:a.fontSizes.Font085,fontFamily:a.fontFamilies.Regular,color:(null===(o=null===(s=null==m?void 0:m.Grid)||void 0===s?void 0:s.Footer)||void 0===o?void 0:o.TextColor)||a.colors.BaseColor.Grey.Grey7}),v=Object.assign(Object.assign(Object.assign({},n.pagingButton),{color:(null===(l=null===(c=null==m?void 0:m.Grid)||void 0===c?void 0:c.Footer)||void 0===l?void 0:l.IconColor)||a.colors.BaseColor.Blue.Blue3,marginLeft:a.sizes.Measures.Measure050,marginRight:a.sizes.Measures.Measure050,width:"0px",fontSize:a.fontSizes.Font085,"[disabled]":{color:(null===(p=null===(d=null===(u=null==m?void 0:m.Grid)||void 0===u?void 0:u.Footer)||void 0===d?void 0:d.Disabled)||void 0===p?void 0:p.IconColor)||a.colors.BaseColor.Grey.Grey5}}),b&&{transform:"scaleX(-1)"}),C={["margin"+(b?"Left":"Right")]:"auto",fontSize:a.fontSizes.Font085,fontFamily:a.fontFamilies.Regular,color:(null===(g=null===(h=null==m?void 0:m.Grid)||void 0===h?void 0:h.Footer)||void 0===g?void 0:g.TextColor)||a.colors.BaseColor.Grey.Grey7};t=Object.assign(Object.assign({},n),{containerStyle:y,navigationPanelStyle:f,pagingButton:v,pageNumberStyle:S,pagingTextStyle:C})}return t}}();return(r,i)=>{const a=n(r,i.contextString),s=Object(P.fb)(r,i.id,i.contextToken),o=s?s.length:0,c=t(r,Me.k),l=Object(P.Y)(r,i.id,i.contextToken),u=Object(P.x)(r,i.id,i.contextToken);return e!==a&&(e=a),{selectedRowCount:o,resourceStrings:c,pagingData:l,currentPage:null===u?1:u,styleProps:e}}}),(function(e,t){return{retrieveResourceStrings:t=>e(Object(w.e)(t)),updatePageNumber:n=>{if(e(Object(xe.b)(t.id,t.contextToken,n)),1===n&&t.enhancedPagingDisabled&&e(Object(ze.b)(t.id,t.contextToken)),t.isGridRoot){const e=[{filterType:12,filterExpressionOrValue:n}];t.updateGridPaginationStateHandler(e,t.id)}return e(Object(Be.b)(t.id,t.contextToken,null)),e(Object(Re.b)(t.id,t.contextToken,[]))},setNewPageRequested:n=>{e(Object(De.b)(t.id,t.contextToken,n))}}}))(Ge);var Ue=n("PBKq"),qe=n("Yexl"),Xe=n("IqkD");var Ye=n("5O6t"),Ke=n("b8TU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Qe extends r.Component{constructor(e){super(e),this._quickFindInnerTextRef=null,this._searchBarFocusTriggered=!1,this._onTextInputChange=this._onTextInputChange.bind(this),this._onkeyDown=this._onkeyDown.bind(this),this._onButtonClick=this._onButtonClick.bind(this),this._focusTextInput=this._focusTextInput.bind(this),this.updateSearchTextAndFind=this.updateSearchTextAndFind.bind(this),this.props.isGridPaginationStateFeatureEnabled&&this.props&&this.props.gridInput&&this.props.gridInput.quickFindExpression?this.state={quickFindText:this.props.gridInput.quickFindExpression.trim(),currentViewId:this.props.currentViewIdToRestore,clearQuickFind:!0}:this.state={quickFindText:null,currentViewId:null,clearQuickFind:!1}}clearSearchBar(){this.setState({quickFindText:null,clearQuickFind:!1})}updateSearchTextAndFind(e,t){this.setState({quickFindText:e},()=>{t&&this._applyQuickFind()})}_onButtonClick(e){this.props.updateDataSetLoadingState(1),this.state.clearQuickFind?this._clearQuickFind():this._applyQuickFind()}_onkeyDown(e){e.keyCode===je.a.Enter&&(this.props.updateDataSetLoadingState(1),this._applyQuickFind())}_onTextInputChange(e){const t=""===e;this.setState({quickFindText:e,clearQuickFind:t})}_applyFilter(){const e=this._formatQuickFindText(),t=Object(Pe.b)(e,this.props.primaryNameAttribute);this.props.applyGridFilter(t,this.props.contextToken)}_clearFilter(){this.setState({quickFindText:""},()=>{this._applyFilter()})}_formatQuickFindText(){return this.state.quickFindText.split("*").join("%").replace(/%?\s*$/,"%")}_applyQuickFind(){this.state.quickFindText&&""!==this.state.quickFindText.trim()?this.props.shouldUseFilter?(this._applyFilter(),this.setState({clearQuickFind:!0})):this.props.applyQuickFind(this.state.quickFindText,this.props.id,this.props.gridInput,this.props.contextToken,this.props.controlName,this.props.isGridPaginationStateFeatureEnabled).then(e=>{this.setState({clearQuickFind:!0}),this.state.currentViewId||this.setState({currentViewId:e})}):this._clearQuickFind()}_clearQuickFind(){this.props.shouldUseFilter?(this._clearFilter(),this.setState({clearQuickFind:!1})):this.props.clearQuickFind(this.state.currentViewId,this.props.id,this.props.gridInput,this.props.contextToken,this.props.controlName).then(()=>{this.setState({quickFindText:"",currentViewId:null,clearQuickFind:!1})})}_getPlaceholderText(){return this.props.isGridSearchCanUseCurrentViewFeatureEnabled?this.props.shouldGridSearchUseCurrentView?Object(E.c)(this.props.resourceStrings,j.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT_SEARCH_THIS_VIEW):Object(E.c)(this.props.resourceStrings,j.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT_QUICK_FIND_VIEW):Object(E.c)(this.props.resourceStrings,j.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT)}_createUniqueId(e){const{contextToken:t,id:n}=this.props;return t.controlName?`${e}_${t.controlName}_${n}`:`${e}_${n}`}render(){const e=this._getPlaceholderText(),t=Object(E.c)(this.props.resourceStrings,j.QUICK_FIND_TOOLTIP_CLEAR_BUTTON);if(this.props.showNewQuickFindSearchBarForMobile)return r.createElement(o.a,null,r.createElement(B.i,{placeholder:e,cancelText:Object(E.c)(this.props.resourceStrings,j.QUICK_FIND_CANCEL_LABEL_ID),clearText:t,applyQuickFind:this._applyQuickFind,windowWidth:this.props.viewPortWidth,updateSearchTextAndFind:this.updateSearchTextAndFind,value:this.state.quickFindText,quickFindRNStyleProps:this.props.quickFindRNStyleProps}));const n=this._createUniqueId("quickFind_text"),i=this._createUniqueId("quickFind_button"),a=this._createUniqueId("quickFind_button_icon"),s=Object(E.c)(this.props.resourceStrings,j.QUICK_FIND_TOOLTIP_APPLY_BUTTON),c=this.state&&this.state.clearQuickFind?t:s;return r.createElement(o.a,{style:this.props.styleProps.quickFindStyle,testhooks:{id:"data-set-quickFind-container"}},r.createElement(Ue.a,{id:n,key:n,ref:e=>{this._quickFindInnerTextRef=e},testhooks:{id:n},value:this.state&&this.state.quickFindText?this.state.quickFindText:null,accessibilityLabel:e,onChangeText:this._onTextInputChange,onKeyDown:this._onkeyDown,style:this.props.styleProps.inputStyle,placeholder:e}),r.createElement(Se.a,{id:i,key:i,testhooks:{id:i},accessibilityLabel:c,title:c,onClick:this._onButtonClick,tabIndex:0,style:this.props.styleProps.buttonStyle},r.createElement(Q.b,{id:a,key:a,type:this.state&&this.state.clearQuickFind?d.a.Cancel:d.a.SearchButton,style:this.props.styleProps.buttonIconStyle})))}_focusTextInput(){if(this.props.focusSearchBoxAfterRender&&!this._searchBarFocusTriggered){const e=i.findDOMNode(this._quickFindInnerTextRef);e&&(e.focus(),this._searchBarFocusTriggered=!0)}}componentDidMount(){this._focusTextInput()}}Qe.displayName="DataSetQuickFind";const Ze=Object(s.a)((function(){let e=null,t=null,n=null,r={quickFindText:null,currentViewId:null,clearQuickFind:null,primaryNameAttribute:null,styleProps:null,quickFindRNStyleProps:null,shouldUseFilter:!1,resourceStrings:null,isGridPaginationStateFeatureEnabled:null,currentViewIdToRestore:null,shouldGridSearchUseCurrentView:null,isGridSearchCanUseCurrentViewFeatureEnabled:null,isQuickFindImprovementsFeatureEnabled:null,viewPortWidth:null};const i=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e,t=null,n=null,r={buttonStyle:{border:"none",padding:"0",backgroundColor:"transparent",flexDirection:"column","-webkit-appearance":"none"},inputStyle:{border:"none",backgroundColor:"transparent",width:"100%",minWidth:"0px","-webkit-appearance":"none","::-ms-clear":{display:"none"}},quickFindStyle:{borderWidth:"1px",borderStyle:"solid",display:"flex",flexDirection:"row",width:"100%"},buttonIconStyle:{fontWeight:"bold",marginTop:"auto",marginBottom:"auto",width:"100%"}};return function(i,a){var s,o,c,l,u,d,p,h,g,m,b,y,f,S,v,C;const O=Object(Xe.g)(i),_=Object(_e.b)(i)&&Object(z.a)(i,V.Fb,V.Lc)&&(null===(s=Object(_e.a)(i))||void 0===s?void 0:s.Components)?Object(_e.a)(i).Components:null;if(_&&(r=Object.assign(r,{inputStyle:{color:null===(l=null===(c=null===(o=null==_?void 0:_.Grid)||void 0===o?void 0:o.ColumnHeader)||void 0===c?void 0:c.QuickFind)||void 0===l?void 0:l.TextColor,backgroundColor:null===(p=null===(d=null===(u=null==_?void 0:_.Grid)||void 0===u?void 0:u.ColumnHeader)||void 0===d?void 0:d.QuickFind)||void 0===p?void 0:p.BackgroundColor,borderColor:"transparent"},searchIconStyle:{color:null===(m=null===(g=null===(h=null==_?void 0:_.Grid)||void 0===h?void 0:h.ColumnHeader)||void 0===g?void 0:g.QuickFind)||void 0===m?void 0:m.IconColor},buttonIconStyle:{color:null===(f=null===(y=null===(b=null==_?void 0:_.Grid)||void 0===b?void 0:b.ColumnHeader)||void 0===y?void 0:y.QuickFind)||void 0===f?void 0:f.IconColor}})),t!==a||e!==O){t=a,e=O;const s=Object(Oe.a)(i),o=Object.assign(Object.assign({},r.buttonStyle),{":before":{content:"''",display:"inline-block",width:s.sizes.Measures.Measure250}}),c=Object.assign(Object.assign({},r.quickFindStyle),{borderColor:(null===(C=null===(v=null===(S=null==_?void 0:_.Grid)||void 0===S?void 0:S.ColumnHeader)||void 0===v?void 0:v.QuickFind)||void 0===C?void 0:C.BorderColor)||s.colors.BaseColor.Grey.Grey3,["padding"+(O?"Right":"Left")]:s.sizes.Measures.Measure025});n=Object.assign(Object.assign({},r),{buttonStyle:o,quickFindStyle:c})}return n}}(),a=Object(Ye.a)(),s=Object(E.h)();let o=null;return(c,l)=>{const u=i(c,l.contextString),d=a(c,l);n||(n=s(c,j.labelList)),e!==u&&(e=u),t!==d&&(t=d),o||(o=Object(z.c)(c,V.bd));const p=Object(z.a)(c,V.zb);let h=null;if(p&&l.gridInput){h=(l.gridInput&&l.gridInput.viewId&&!v.a.isNullOrEmpty(l.gridInput.viewId)?l.gridInput.viewId:null)||Object(O.a)(c,l.entityTypeName,_.a.MAIN_APPLICATION_VIEW)}return r={quickFindText:"",currentViewId:null,clearQuickFind:!1,primaryNameAttribute:Object(N.E)(c,l.entityTypeName),styleProps:e,quickFindRNStyleProps:t,shouldUseFilter:!(Object(Ie.e)(l.contextString)||Object(Ie.d)(l.contextString)||Object(Ie.g)(l.contextString)&&o),resourceStrings:n,isGridPaginationStateFeatureEnabled:p,currentViewIdToRestore:h,shouldGridSearchUseCurrentView:Object(ae.l)(c),isGridSearchCanUseCurrentViewFeatureEnabled:Object(z.a)(c,V.Db,V.h),isQuickFindImprovementsFeatureEnabled:Object(z.a)(c,V.ad,V.tc),viewPortWidth:Object(Ke.c)(c)},r}}),(function(e,t){return{applyQuickFind:(n,r,i,a,s,o)=>{if(i&&o){const e=[{filterType:1,filterExpressionOrValue:n}];i.entityTypeName===y.a&&e.push({filterType:2,filterExpressionOrValue:t.entityTypeName}),t.updateGridPaginationStateHandler(e,t.id),t.resetPagingInfoForEnhancedPaging()}return e(Object(qe.a)(n,r,a,s))},clearQuickFind:(n,r,i,a,s)=>{if(i){const e=[{filterType:1,filterExpressionOrValue:null}];t.updateGridPaginationStateHandler(e,t.id)}return e(Object(qe.b)(n,r,a,s))},applyGridFilter:(n,r)=>{e(Object(Ce.n)(n,t.id,r))}}}),null,{forwardRef:!0})(Qe);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Je=({onSeeMoreClick:e,resourceStrings:t,containerStyle:n,buttonStyle:i,seeMoreTextStyle:a,localizedStrings:s})=>function(e,t,n,i,a,s){const c=(null==s?void 0:s.seeMoreTooltip)||Object(E.c)(t,j.SEE_MORE_TOOL_TIP),u=(null==s?void 0:s.seeMoreLabel)||Object(E.c)(t,j.SEE_MORE_LABEL);let d=c;return(null==s?void 0:s.uniqueLabel)&&(d+=" "+s.uniqueLabel),r.createElement(o.a,{style:n},r.createElement(Se.a,{key:"seeMoreBtn",id:"seemore-btn",title:c,style:i,onClick:e,tabIndex:0,accessibilityLabel:d,describedByElementId:null},r.createElement(l.a,{style:a},u)))}(e,t,n,i,a,s)
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */;var $e=n("5R5s"),et=n("kKLx"),tt=n("vNXc"),nt=n("504W"),rt=n("aF0N");var it=n("iOrn"),at=n("zFtG"),st=n("waMg"),ot=n("6Qf/"),ct=n("B9jE"),lt=n("Jpj4"),ut=n("E6o7"),dt=n("QXpm"),pt=n("rQHy"),ht=n("kt5S"),gt=n("Nb1E"),mt=n("odYE"),bt=n("wyQO");var yt=n("fyfl"),ft=n("ojtV"),St=n("2YQW"),vt=n("ngeo"),Ct=n("WZ96"),Ot=n("QBtP"),_t=n("1uZV"),It=n("tICD"),jt=n("uNu9"),Pt=n("PVDM"),Ft=n("PZ34");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Tt(e){return r.createElement(ce.a,{loader:()=>Promise.all([n.e(9),n.e(10),n.e(11),n.e(13),n.e(12),n.e(14),n.e(15),n.e(17),n.e(21),n.e(33)]).then(n.bind(null,"BvEH")).then(e=>e.DataSetExpressionBuilder),props:e})}Tt.displayName="DataSetExpressionBuilderLazyLoadComponent";var wt=n("b41/"),Et=n("p/Kg"),xt=n("Tz6o"),Nt=n("BkgE"),At=n("+HfF"),kt=n("Uv1Y"),Mt=n("VcAV"),Dt=n("eOoD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Rt(e){return r.createElement(ce.a,{loader:()=>Promise.all([n.e(9),n.e(10),n.e(11),n.e(13),n.e(12),n.e(14),n.e(16),n.e(112),n.e(32)]).then(n.bind(null,"12bH")).then(e=>e.ColumnEditor),props:e})}Rt.displayName="ColumnEditorLazyLoadComponent";var Bt=n("2Sll"),Lt=n("ozuu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
Object(Bt.a)();const Vt=y.x+".DataSetHost",zt=Vt+".AdvancedFind.Open",Ht=Vt+".AdvancedFind.Discard";class Gt extends r.Component{constructor(e){super(e),this._quickFindCommandBarId="showQuickFind",this._changeVisualizationCommandBarId="changeVisualization",this._savedDefault=null,this._savedFormInfo=null,this._currentFilterValue=null,this._addedCommandListFromHost=[],this._addedCommandListFromControl=[],this._addedCommandListFromHostParent=[],this._memoizedConfiguration=null,this._memoizedResourceStrings=null,this._memoizedViewConfigurations=null,this._memoizedButtonList=null,this._parentSwitchVisualizationButton=null,this._keyIndex=0,this._width=0,this._height=0,this._isFirstRequestComplete=!1,this._isPreNavigationEventAttached=!1,this._offlineSqlQueryRetrieveState=0,this._dataSetQuickFindRef=r.createRef(),this._isSubGridFirstLoad=!1,this._minWidthForChartPlusGridReflow=640,this._isReflowLayoutVertical=!1,this._isSwitchVisualizationInitialized=!1,this._accessibilityId=1,this._incrementLastPage=()=>{this.props.pageNumber===this.state.pagingInfo.lastPageNumber&&this.setState({pagingInfo:Object.assign(Object.assign({},this.state.pagingInfo),{lastPageNumber:this.state.pagingInfo.lastPageNumber+1})})},this._setFirstPage=e=>{this.setState({pagingInfo:Object.assign(Object.assign({},this.state.pagingInfo),{firstPageNumber:e})})},this._seeMorePopup=this._seeMorePopup.bind(this),this._onSendControlCommandsEventFired=this._onSendControlCommandsEventFired.bind(this),this._onSelectedOrderColumnChangeFired=this._onSelectedOrderColumnChangeFired.bind(this),this._onParentPagePreNavigationEventFired=this._onParentPagePreNavigationEventFired.bind(this),this._onFilterChange=this._onFilterChange.bind(this),this._onActivityTypeMenuDismissed=this._onActivityTypeMenuDismissed.bind(this),this._updateDataSetLoadingStateEvent=this._updateDataSetLoadingStateEvent.bind(this),this._updateFilterValue=this._updateFilterValue.bind(this),this._onRollupViewToggleChanged=this._onRollupViewToggleChanged.bind(this),this._onQuickFind=this._onQuickFind.bind(this),this._onItemIconPointerDown=this._onItemIconPointerDown.bind(this),this._onViewChanged=this._onViewChanged.bind(this),this._onControlLoadedError=this._onControlLoadedError.bind(this),this._updatePagingInfo=this._updatePagingInfo.bind(this),this._updateFilterExpressionStrings=this._updateFilterExpressionStrings.bind(this),this._configureDataSetControlParams=this._configureDataSetControlParams.bind(this),this._openManageDuplicatesDialog=this._openManageDuplicatesDialog.bind(this),this._showInnerError=this._showInnerError.bind(this),this._isInSeeMoreState=this._isInSeeMoreState.bind(this),this._getChartPaneText=this._getChartPaneText.bind(this),this.onMeasuring=this.onMeasuring.bind(this),this.closeFilterPanel=this.closeFilterPanel.bind(this),this._clearActivityTypeFilter=this._clearActivityTypeFilter.bind(this),this._updateCurrentPageNumber=this._updateCurrentPageNumber.bind(this),this._isNativePlatform=null!=e.platformType&&e.platformType===b.b.Native,this._currentPagingString=null,this._preSeeMoreCachedPagingString=null,this._boundOnRecordsSelected=null,this._pageNumberToRestoreForEnhancedPaging=this.props.pageNumberForEnhancedPaging,this._shouldResetPagingForEnhancedPaging=!1,this._previousSortingInfo=null,this._resetProcessedForEnhancedPaging=!0,this.state={quickFindVisibility:!1,addedCommandList:[],inSeeMoreState:!1,pagingInfo:{firstPageNumber:Object(nt.a)(this.props.pageNumberForEnhancedPaging)?1:this.props.pageNumberForEnhancedPaging,lastPageNumber:Object(nt.a)(this.props.pageNumberForEnhancedPaging)?1:this.props.pageNumberForEnhancedPaging,currentPageNumber:Object(nt.a)(this.props.pageNumberForEnhancedPaging)?1:this.props.pageNumberForEnhancedPaging,pageShift:0,isGridScrolledToBottom:!1},compositeControlInitState:A.a.Uninitialized,controlLoadErrorMessage:null,controlLoadInnerErrorMessage:null,loadingState:0,isFilterPanelOpen:!1,columnEditorPanelOpen:!1,isAdvancedFilterEdited:!1},this._parentDefinedProps={eventListeners:[{eventname:"sendgridcontrolcommandstohostcommandbar",eventhandler:[this._onSendControlCommandsEventFired]},{eventname:"onselectedordercolumnchange",eventhandler:[this._onSelectedOrderColumnChangeFired]},{eventname:"parentPagePreNavigation",eventhandler:[this._onParentPagePreNavigationEventFired]},{eventname:"sendpaginginfotopagingcontrol",eventhandler:[this._updatePagingInfo]},{eventname:"sendfilterexpressionstringstodatasethost",eventhandler:[this._updateFilterExpressionStrings]},{eventname:"updatedatasethostloadingstate",eventhandler:[this._updateDataSetLoadingStateEvent]},{eventname:"openmanageduplicatesdialog",eventhandler:[this._openManageDuplicatesDialog]},{eventname:"showinnererror",eventhandler:[this._showInnerError]},{eventname:"sendcurrentpagenumber",eventhandler:[this._updateCurrentPageNumber]}],containerStyleOverrides:{rootContainer:{flex:Object(Ie.e)(e.contextString)?"1 1 100%":"1 1 auto",minHeight:"0"}},onControlLoadedError:this._onControlLoadedError},this._seeMoreHelper=new m.a}_logInfo(e){this._tracer&&this._tracer.info(e)}_updateDataSetLoadingStateEvent(e){this._updateDataSetLoadingState(e.value)}_updateDataSetLoadingState(e,t={}){(1===e&&this.props.featureControlProps.isGridProgressIndicatorFeatureEnabled||1!==e)&&(this.setState(Object.assign(t,{loadingState:e})),this._currentLoadingTimeoutIdentifier&&clearTimeout(this._currentLoadingTimeoutIdentifier),this._currentLoadingTimeoutIdentifier=null,1===e&&(this._currentLoadingTimeoutIdentifier=setTimeout(()=>{this._updateDataSetLoadingState(2)},3e4)))}_openManageDuplicatesDialog(e){!this.props.isOffline&&e&&e.entityReference&&e.reject&&this.props.openManageDuplicatesDialog(e)}_showInnerError(e){this.props.showInnerError(e)}_updatePagingInfo(e){e&&e.currentPageNumber>0&&(this.props.setNewPageRequested(this.props.id,this.props.contextToken,!1),this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&(this._resetProcessedForEnhancedPaging||1!==e.currentPageNumber||(this._resetProcessedForEnhancedPaging=!0,this._pageNumberToRestoreForEnhancedPaging=1),this.props.pageNumberForEnhancedPaging!==e.currentPageNumber&&this.props.updatePageNumberForEnhancedPaging(e.currentPageNumber,this.props.contextToken)),Object(St.e)(this.state.pagingInfo,e)||this.setState({pagingInfo:e}))}_updateCurrentPageNumber(e){e&&e.currentPageNumber>0&&this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,e.currentPageNumber)}_updateFilterExpressionStrings(e){if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&e&&(e.nativeFilterExpressionString||e.dataSetFilterExpressionString)){const t=[{filterType:5,filterExpressionOrValue:e.nativeFilterExpressionString},{filterType:6,filterExpressionOrValue:e.dataSetFilterExpressionString}];this.props.updateGridPaginationStateHandler(t,this.props.id),this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1)}}_setResetPagingInfoForEnhancedPaging(){this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&this._isNativePlatform&&(this._shouldResetPagingForEnhancedPaging=!0)}_resetPagingInfoForEnhancedPaging(){this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&this._isNativePlatform&&(this.setState({pagingInfo:{firstPageNumber:1,lastPageNumber:1,currentPageNumber:1,pageShift:0,isGridScrolledToBottom:!1}}),this._pageNumberToRestoreForEnhancedPaging=1)}_onControlLoadedError(e){const t=e?e.message:null;this._logTelemetryData(t),this._setControlLoadError()}_setControlLoadError(e=j.GRID_CONTROL_LOAD_ERROR){this.setState({controlLoadErrorMessage:Object(E.c)(this.props.resourceStrings,e)})}_logTelemetryData(e){this._tracer&&this._tracer.error("Loading for the grid failed because of error :"+(e||"CustomControl_Calendar_ErrorView_DefaultMessage"))}_renderTitle(){if(!this.props.descriptor)return null;const{ShowLabel:e,Name:t,Label:n}=this.props.descriptor,i=this._isWidthLessThanViewportSm()?this.props.styles.titleMobileStyle:this.props.styles.titleStyle;return e&&n?r.createElement(l.a,{key:t,semanticTag:"div",style:i},n):null}onMeasuring(e,t){if(this._height=t,Math.abs(this._width-e)<50)return;if(this._width=e,this._getCachedSize()&&e===this._getCachedSize().width&&(!t||t===this._getCachedSize().height))return;const n={},r=this._seeMoreHelper.shouldGivePoppedOutDimensions(!0),i=this._seeMoreHelper.getSeeMorePopupInfo(),a=r?i.endWidthInner:e,s=[];!this._isWidthInitialized()&&e>0&&(n.isWidthInitialized=!0,s.push("isWidthInitialized:"+n.isWidthInitialized));const o=a<=this.props.viewportSm;o!==this._isWidthLessThanViewportSm()&&(n.isWidthLessThanViewportSm=o,s.push("isWidthLessThanViewportSm:"+o));const c=a<=this.props.viewportM;c!==this._isWidthLessThanViewportM()&&(n.isWidthLessThanViewportM=c,s.push("isWidthLessThanViewportM:"+c));const l=a<this._minWidthForChartPlusGridReflow;l!==this._isWidthLessThanMinWidthForChartPlusGridReflow()&&(n.isWidthLessThanMinWidthForChartPlusGridReflow=l,s.push("isWidthLessThanMinWidthForChartPlusGridReflow:"+l));const u=this._jumpBarShouldRenderAsFlyout(a);u!==this._isJumpBarRenderingAsFlyout()&&(n.isJumpBarRenderingAsFlyout=u,s.push("isJumpBarRenderingAsFlyout:"+u));const d=a>480;d!==this._isWidthGreaterThan480()&&(n.isWidthGreaterThan480=d,s.push("isWidthGreaterThan480:"+d));const p=r?i.endHeightInner:t,h=p>240;h!==this._isHeightGreaterThan240()&&(n.isHeightGreaterThan240=h,s.push("isHeightGreaterThan240:"+h)),0!==e&&0!==t||this._tracer&&this._tracer.warn(`The measuring service returned width or height as 0. The new dimensions are width is ${e} and height is ${t}`);let g=!1;const m=this.props.quickFindProps&&o&&!this._checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot();m!==this._showCommandBarButtonSearch()&&(n.showCommandBarButtonSearch=m,s.push("showCommandBarButtonSearch:"+m),g=!0);const b=Object(Ie.e)(this.props.contextString)||Object(Ie.d)(this.props.contextString)&&this.props.featureControlProps.isChartOnAssociatedGridEnabled;if(b!==this._showCommandBarButtonShowChart()&&(n.showCommandBarButtonShowChart=b,s.push("showCommandBarButtonShowChart:"+b),g=!0),s.length>0){s.push("currentWidth:"+e),s.push("currentHeight:"+t),s.push("usePoppedOutDimensions:"+r),s.push("newWidth:"+a),s.push("newHeight:"+p),s.push("commandBarNeedsUpdate:"+g);const n=s.join(",");this._logInfo("onMeasuring change: "+n)}this._getCachedSize()&&this._getCachedSize().update&&(this._cachedSize=this._getCachedSize().update({width:e,height:t,isWidthInitialized:e>0,isWidthLessThanViewportSm:o,isWidthLessThanViewportM:c,isWidthLessThanMinWidthForChartPlusGridReflow:l,isJumpBarRenderingAsFlyout:u,isWidthGreaterThan480:d,isHeightGreaterThan240:h,showCommandBarButtonSearch:m,showCommandBarButtonShowChart:b}));let y=n;g&&(y=Object.assign(y,this._getUpdateAddedCommandList(m,b))),Object.keys(y).length&&this.setState(y)}_getUpdateAddedCommandList(e,t){if(this._addedCommandListFromHost=[],e&&(this._logInfo("Adding search button to commandbar for DataSethost."),this._addedCommandListFromHost.push({Icon:"SearchButton",DisplayText:Object(E.c)(this.props.resourceStrings,j.QUICK_FIND_COMMANDBAR_TEXT),Id:this._quickFindCommandBarId,execute:this._onQuickFind})),this.props.isQueryMode){this._logInfo("Adding clear query button to commandbar for DataSethost.");const e=this._getClearQueryText();this._addedCommandListFromHost.push({Icon:"ClearDefault",DisplayText:e,Tooltip:{title:e},Id:"ClearQuery",execute:()=>this.props.clearQuery()})}if(!this.props.isOffline&&t){this._logInfo("Adding show chart button to commandbar for DataSethost.");const e=this._getChartPaneText();this._addedCommandListFromHost.push({Icon:"SelectChart",DisplayText:e,Tooltip:{title:e},Id:"ShowChartPane",execute:()=>this.props.toggleChartPane(this.props.id,this.props.contextToken,!this.props.showChart)})}return this._onAddedCommandListChange(!1)}_onViewChanged(e,t,n=!0){var r;n&&this._updateDataSetLoadingState(1);const i=this.props.descriptor?this.props.descriptor.Id:null;this._logInfo("The view for the grid changed. The new view parameters for the view are - NewViewId : "+e+", EntityTypeName : "+t+"and ControlName : "+i),this._resetPagingInfoForEnhancedPaging(),null===(r=this._dataSetQuickFindRef.current)||void 0===r||r.clearSearchBar();const a=this.props.gridInput&&this.props.gridInput.entityTypeName.toLowerCase()===P.a;this.props.updateView(this.props.id,i,e,t,this.props.commandBarProps&&this.props.commandBarProps.commandManagerId,this.props.contextToken,this.props.userId,this.props.featureControlProps&&this.props.featureControlProps.isQueueFilterPerfUCIEnabled,a).then(()=>{this.props.nonCompositionProps&&this.props.nonCompositionProps.setPageInputViewId&&this.props.nonCompositionProps.setPageInputViewId(e),this.state.controlLoadErrorMessage&&this.setState({controlLoadErrorMessage:null})},e=>{this._logInfo(e.message),this._setControlLoadError()})}_onItemIconPointerDown(e,t,n,r,i){this._logInfo("“Trying to set default view for user. The new view parameters for the view are - NewViewId : "+t+", EntityTypeName : "+e+", ViewType : "+n+"and Unpin  : "+i);const a=se(this._currentFilterValue);return this.props.updateUserDefaultGridView(e,t,n,r,a,i)}_onQuickFind(){this.setState({quickFindVisibility:!this.state.quickFindVisibility})}_getChartPaneText(){const{resourceStrings:e,showChart:t}=this.props;return t?Object(E.c)(e,j.CHARTS_HIDE_CHART_PANE_LABEL):Object(E.c)(e,j.CHARTS_SHOW_CHART_PANE_LABEL)}_getClearQueryText(){return"Clear query"}_updateFilterValue(e){this._currentFilterValue=e}_onFilterChange(e,t=this.props.gridEntityTypeName){this._logInfo("Applying grid filter, the new value received is "+e),2===this.state.loadingState&&this._updateDataSetLoadingState(1),this._updateFilterValue(e);const n=Object($e.a)(this.props.viewSelectorProps.entityTypeName,this.props.userId,this.props.contextToken,this.props.featureControlProps.isQueueFilterPerfUCIEnabled,this.props.entityIsActivityType).getFilterExpression(e,this.props.userSetting,t);this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1),this._setResetPagingInfoForEnhancedPaging(),this.props.applyGridFilter(n,e,this.props.contextToken)}_clearActivityTypeFilter(){this.props.applyActivityTypeFilter("","",this.props.contextToken)}_onActivityTypeMenuDismissed(e){if(!this.props.isOffline){const t=e.join(","),n=function(e,t){if(null!=e){if(e.indexOf("selectAllKey")>-1||0===e.length||null!=t&&t.length===e.length)return null;let n=null;const r=[];for(let t=0;t<e.length;t++)r.push({attributeName:"activitytypecode",conditionOperator:0,value:e[t]});return r&&r.length>0&&(n={conditions:r,filterOperator:1}),n}}(e,this.props.entityFilterProps.filterOptionsForActivityType),r=n?JSON.stringify(n):"";void 0===this.props.entityFilterProps.activityTypePreviousValues?this.props.applyActivityTypeFilter(r,t,this.props.contextToken):t!==this.props.entityFilterProps.activityTypePreviousValues&&this._shouldActivitySelectAllFilterFire(t,this.props.entityFilterProps.activityTypePreviousValues,this.props.entityFilterProps.isActivityFilterSelectAllEnabled)&&(this._logInfo("Applying activity type grid filter, the new value received is "+t),2===this.state.loadingState&&this._updateDataSetLoadingState(1),this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1),this._setResetPagingInfoForEnhancedPaging(),this.props.applyActivityTypeFilter(r,t,this.props.contextToken));const i=[{name:"ActivityTypeFilterUsage",value:"Initiated"},{name:"SelectedActivityTypeFilterCount",value:e.length},{name:"ActivityTypeFilterDropDownCount",value:this.props.entityFilterProps.filterOptionsForActivityType.length}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentSuccess&&this.context.EventManager.ReportComponentSuccess(Vt,i)}}_shouldActivitySelectAllFilterFire(e,t,n){if(n){let n=!1,r=!1;return(t.indexOf("selectAllKey")>-1||""===t)&&(n=!0),(e.indexOf("selectAllKey")>-1||""===e)&&(r=!0),!(n&&r)}return!0}_onRollupViewToggleChanged(e){this._logInfo("Toggling rollupView control, the new value received is "+e),this.props.toggleGridRollupView(e,this.props.contextToken)}_updateFilterOnViewSelectorChange(e){this._logInfo("Updating dataset with the existing filter selection for activity pointer"),this._onFilterChange(this._currentFilterValue,e)}_onSendControlCommandsEventFired(e){this._logInfo("Adding control commands to command bar. The command to be added are : "+e),e!==this._addedCommandListFromControl&&(this._addedCommandListFromControl=e,this._onAddedCommandListChange())}_onSelectedOrderColumnChangeFired(e){if(this._logInfo("Updating jumpbar filter based on the selected order column"),this.props.featureControlProps.isJumpBarShouldHonorSortingFeatureEnabled&&this.props.jumpBarProps){let t=e.columnSortingName;t=Object(Pe.d)(t,e.columnSortingType,e.primaryNameAttribute);const n=Object(Pe.b)(this.props.jumpBarProps.selectedFilter,t);this.props.onSelectedOrderColumnChange(n,this.props.contextToken)}}_onParentPagePreNavigationEventFired(e){e&&Array.isArray(e)&&e.length>0&&!this._isPreNavigationEventAttached&&this.context&&this.context.Router&&this.context.Router.registerPreNavigationHandler&&(this._tracer&&this._tracer.info("Adding control preNavigation handlers to the router"),e.forEach(e=>this.context.Router.registerPreNavigationHandler(()=>{try{return e()}catch(e){const t=[{name:"subComponent",value:"onPreNavigation"}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentFailure&&this.context.EventManager.ReportComponentFailure(Vt,e,null,t)}return Promise.resolve(!0)})),this._isPreNavigationEventAttached=!0)}_createSwitchVisualization(e,t){return()=>{switch(this._keyIndex++,this.props.contextString){case y.h.ASSOCIATEDGRID:this.props.switchAssociatedGridVisualization(this.props.id,this.props.entityTypeName,this.props.controlId,this.props.viewId,e,this.props.nonCompositionProps&&this.props.nonCompositionProps.viewConfigurations,this.props.nonCompositionProps&&this.props.nonCompositionProps.gridConfigurations,"VIEW_CONFIG"===t);break;case y.h.SUBGRID:this.props.switchSubgridVisualization(this.props.id,e,this.props.controlId);break;case y.h.GRID:default:if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput){const e=[{filterType:3,filterExpressionOrValue:null}];this.props.updateGridPaginationStateHandler(e,this.props.id),this.props.setCustomFilter("",0,this.props.id,this.props.contextToken)}"VIEW_CONFIG"===t?this.props.switchViewConfiguration(this.props.id,this.props.contextToken,e,this.props.controlId,!1):this.props.switchHomepageConfiguration(this.props.id,this.props.contextToken,e,this.props.controlId,!0)}}}_updateChangeVisualizationButtons(e){let t=[];const n=this.props.nonCompositionProps&&this.props.nonCompositionProps.gridConfigurations,r=this.props.nonCompositionProps&&this.props.nonCompositionProps.viewConfigurations;let i=!1;this._parentSwitchVisualizationButton||(this._parentSwitchVisualizationButton={Icon:"SelectChart",DisplayText:Object(E.c)(this.props.resourceStrings,j.SWITCH_VISUALIZATION_BUTTON_LABEL),Id:this._changeVisualizationCommandBarId+"-Parent",WillOpenFlyout:!0,Children:null}),this._memoizedConfiguration===this.props.updatedConfiguration&&this._memoizedViewConfigurations===r&&this._memoizedResourceStrings===this.props.switchVisualizationResourceStrings||this.props.switchVisualizationResourceStrings&&(this._memoizedConfiguration=this.props.updatedConfiguration,this._memoizedViewConfigurations=r,this._memoizedResourceStrings=this.props.switchVisualizationResourceStrings,this._memoizedButtonList=[],t=Object(ht.c)(n,r,this.props.updatedConfiguration,this.props,this.props.contextString,e),t.forEach(t=>{if(Object(ht.a)(this.props.updatedConfiguration,t.configuration)||t.configuration.isDefaultConfig&&this.props.updatedConfiguration.isDefaultConfig||this.props.featureControlProps.isDisableEditableGridControlOnPhoneFeatureEnabled&&Object(ae.g)(t.configuration,parseInt(e,10)))return;const n={Icon:"SelectChart",DisplayText:""+Object(ht.b)(this.props.switchVisualizationResourceStrings,t.configuration),Id:`${this._changeVisualizationCommandBarId}-${t.configuration.Name}-${t.formFactor}`,execute:this._createSwitchVisualization(t.configuration,t.configurationType),IsInFlyout:!0};this._memoizedButtonList.push(n),i=!0})),!this._isSwitchVisualizationInitialized&&this.props.commandBarProps&&(Object(ht.d)(this.props.retrieveControlResourceStringsForSwitchVisualization,this.context,n,r,this.props.updatedConfiguration,this.props,this.props.contextString,e),this._isSwitchVisualizationInitialized=!0),this._parentSwitchVisualizationButton.Children=this._memoizedButtonList,i&&this._onAddedCommandListChange()}_onAddedCommandListChange(e=!0){var t,n,r,i;const a=[],s=[],o=(null===(n=null===(t=this._parentSwitchVisualizationButton)||void 0===t?void 0:t.Children)||void 0===n?void 0:n.length)>0;if(this.props.featureControlProps.isShowAsButtonFirstEnabled&&o&&s.push(this._parentSwitchVisualizationButton),s.push(...this._addedCommandListFromControl),s.push(...this._addedCommandListFromHost),(null===(i=null===(r=this.props.nonCompositionProps)||void 0===r?void 0:r.addedCommandListFromHostParent)||void 0===i?void 0:i.length)>0&&a.push(...this.props.nonCompositionProps.addedCommandListFromHostParent),!this.props.featureControlProps.isShowAsButtonFirstEnabled&&o&&a.push(this._parentSwitchVisualizationButton),!e)return{addedCommandList:s,appendedCommandList:a};this&&this.setState&&this.setState({addedCommandList:s,appendedCommandList:a})}_seeMoreCallback(e){this.setState({inSeeMoreState:!this.state.inSeeMoreState})}_seeMorePopup(e,t=!1){!0===e?(this._preSeeMoreCachedPagingString=this._currentPagingString,this._currentPagingString=null):(this._currentPagingString=this._preSeeMoreCachedPagingString,this._preSeeMoreCachedPagingString=null),this._keyIndex++,this._seeMoreHelper.seeMorePopup(this._getDataSetHostRootElement(),this._seeMoreCallback.bind(this),e,t,this.props.isRTL)}_getDataSetHostRootElement(){return i.findDOMNode(this)}_onRecordsSelectedCallback(e,t){this._logInfo("onRecordsSelected for DataSetHost. New selected rows are "+t);const n=[];for(const e of t)n.push(new v.a(e));if(this.props.markSelectedRows(this.props.id,this.props.contextToken,n),e){const e=this.props.updatedConfiguration.Parameters[this.props.nestedGridDatasetName];this.props.markSelectedRelatedEntity(this.props.id,this.props.contextToken,e.TargetEntityType)}else this.props.markSelectedRelatedEntity(this.props.id,this.props.contextToken,null);this.props.isGridEditable&&t.length>0&&this.props.rowProperties(this.props.id,this.props.contextToken,n),this.props.isGridEditable&&(this._logInfo("Running onRecordSelect for EditableGrid"),this.props.runOnRecordSelect(this.props.id,this.props.contextToken,n)),!e&&this._onRecordsSelectedParent&&(this._logInfo("onRecordsSelected: Calling onRecordsSelected callback for the parent control"),this._onRecordsSelectedParent(t))}markGridFirstRequestComplete(){this._isFirstRequestComplete=!0}_isDataSetHostKnownError(e){return!(!e||""===e)&&(-1!==e.indexOf(vt.a.getHexErrorCodeFromInt(2415919120))||!(-1===e.indexOf(vt.a.getHexErrorCodeFromInt(-2147093999))||this.props.offlineProps.isEntityAvailableForOffline&&this.props.offlineProps.isOfflineAvailableForUse))}_onDataSetUpdateCallback(e){this._logInfo("DataSetUpdated for DataSetHost control");const t=[{name:"currentPagingString",value:e&&e.existedPagingString||""}];this.markGridFirstRequestComplete(),this._currentPagingString!==e.existedPagingString&&t.push({name:"previousPagingString",value:this._currentPagingString});let n=!1;e.error?(n=this._isDataSetHostKnownError(e.errorMessage)||!Object(Mt.b)(e.innerError),e.innerError&&t.push({name:"InnerErrorMessage",value:e.innerError}),this.context.EventManager.ReportComponentFailure(Vt,new Error(e.errorMessage||""),null,t)):this.context.EventManager.ReportComponentSuccess(Vt,t);let r={};if(n)r={compositeControlInitState:A.a.Error,controlLoadErrorMessage:e.errorMessage},e.innerError&&(r.controlLoadInnerErrorMessage=e.innerError);else{this.props.updateFetchXml(this.props.id,this.props.contextToken,e.fetchXmlInUse);let t=null;if(e.existedFilteringString){const n=JSON.parse(e.existedFilteringString);t=Object(h.j)(n,He.CrmXmlEncode),this.props.setCustomFilter(t,0,this.props.id,this.props.contextToken)}if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled){const t=[];let n=!1,r=null;e.existedValidSortingArrayString&&(r=e.existedValidSortingArrayString);const i=!Object(nt.a)(r)&&JSON.parse(r);if(i&&i instanceof Array&&i.length>0&&r!==this.props.gridSortingInfo&&(this.props.gridInput&&t.push({filterType:7,filterExpressionOrValue:r}),n=!0),n){if(e.existedPagingString){const t=JSON.parse(e.existedPagingString);t.firstPageNumber&&(this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,t.firstPageNumber),this.props.gridInput&&this._setResetPagingInfoForEnhancedPaging())}this.props.gridInput&&this.props.updateGridPaginationStateHandler(t,this.props.id)}}this.props.updateQueryKey(e.newQueryKey,this.props.id,this.props.contextToken),this.props.updatePagingData(this.props.id,this.props.contextToken,e.existedPagingString),this.props.setNewPageRequested(this.props.id,this.props.contextToken,!1),this._logInfo("onDataSetUpdate: eventPagingString: "+e.existedPagingString),this._currentPagingString=e.existedPagingString}2!==this.state.loadingState?this._updateDataSetLoadingState(2,r):this.setState(r),this._accessibilityId++}_configureDataSetControlParams(){if(!this.props.updatedConfiguration)return;const e=this.props.updatedConfiguration.Parameters[this.props.primaryDataSetName];if(e){!Object(nt.a)(e.onRecordsSelected)&&Object(nt.a)(this._onRecordsSelectedParent)&&e.onRecordsSelected!==this._boundOnRecordsSelected&&(this._onRecordsSelectedParent=e.onRecordsSelected),this._isFirstRequestComplete&&(e.FirstDataRequestType=0),Object(nt.a)(this._boundOnRecordsSelected)&&(this._boundOnRecordsSelected=this._onRecordsSelectedCallback.bind(this,!1)),e.onRecordsSelected=this._boundOnRecordsSelected,e.onDataSetUpdate=this._onDataSetUpdateCallback.bind(this);const t=this.props.descriptor;let n=1,r=this.state.pagingInfo.lastPageNumber;this.props.isGridEditable||this._isNativePlatform?this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this._isNativePlatform&&(n=this.state.pagingInfo.firstPageNumber):(n=this.props.pageNumber,r=this.props.pageNumber);const i={firstPageNumber:n,lastPageNumber:r,pageSize:!this._isInSeeMoreState()&&t&&t.Parameters&&t.Parameters[y.q]&&parseInt(t.Parameters[y.q],10)||this.props.recordsPerPageSetting,pagingRefreshInput:this.props.pagingRefreshInput?this.props.pagingRefreshInput.toString():""},a=Object(Le.a)(this._currentPagingString);if(a&&a.pageSize&&(this._logInfo("Updating pageSize based on _receivedPagingStringData.pageSize to "+a.pageSize),i.pageSize=a.pageSize),e.PagingInput={Static:!0,Value:JSON.stringify(i)},this.props.refreshCounter){const t=this.props.refreshCounter.toString();if(e.RefreshInput={Value:parseInt(t,10),Static:!0},!Object(nt.a)(this.props.customFilter)&&!Object(nt.a)(this.props.customFilter.customFilterXml)&&this.props.customFilter.source&&1===this.props.customFilter.source){const t=Object(h.i)(this.props.customFilter.customFilterXml);e.FilteringInput={Static:!0,Value:JSON.stringify(t)}}}if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput){if(!Object(nt.a)(this.props.customFilter)&&!Object(nt.a)(this.props.customFilter.customFilterXml)){const t=Object(h.i)(this.props.customFilter.customFilterXml);e.FilteringInput={Static:!0,Value:JSON.stringify(t)}}const t=!Object(nt.a)(this.props.gridSortingInfo)&&JSON.parse(this.props.gridSortingInfo),n=t&&t instanceof Array&&t.length>0,r=!Object(nt.a)(this._previousSortingInfo)&&JSON.parse(this._previousSortingInfo),i=r&&r instanceof Array&&r.length>0;(n||i&&this.props.gridSortingInfo!==this._previousSortingInfo)&&(this._previousSortingInfo=this.props.gridSortingInfo,e.SortingInput={Static:!0,Value:this.props.gridSortingInfo})}this.props.gridEntityTypeName&&(e.EntityName=this.props.gridEntityTypeName)}this._addExtraParametersToConfiguration();const t=this.props.updatedConfiguration.Parameters[this.props.nestedGridDatasetName];if(t&&(t.onRecordsSelected=this._onRecordsSelectedCallback.bind(this,!0),this.props.refreshCounter)){const e=this.props.refreshCounter.toString();t.RefreshInput={Value:parseInt(e,10),Static:!0}}}_addExtraParametersToConfiguration(){if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&(this.props.updatedConfiguration.Parameters.NativeFilterExpressionToRestore={Usage:1,Static:!0,Value:this.props.nativeFilterExpression},!Object(nt.a)(this._pageNumberToRestoreForEnhancedPaging))){let e=this._pageNumberToRestoreForEnhancedPaging;this._pageNumberToRestoreForEnhancedPaging>1&&(this._shouldResetPagingForEnhancedPaging||!this._resetProcessedForEnhancedPaging)&&(this._shouldResetPagingForEnhancedPaging=!1,this._resetProcessedForEnhancedPaging=!1,e=-1),this.props.updatedConfiguration.Parameters.PageNumberToRestore={Usage:1,Static:!0,Value:e}}this.props.lookupAttributeForRecordHierarchy&&this.props.gridInput&&(this.props.updatedConfiguration.Parameters.LookupAttributeNameForHierarchy={Usage:1,Static:!0,Value:this.props.lookupAttributeForRecordHierarchy})}_renderAccessibilityNotification(e){var t;const n=e+"_accessibility",i={left:"-3000%",width:"0%",height:"0%",position:"absolute"};this.props.featureControlProps.isAssociatedGridHeightEnabled&&(i.overflow="hidden");const a=Object(E.c)(this.props.resourceStrings,j.GRID_LOADING_PLACEHOLDER).replace("{0}",this.props.entityDisplayName),s=2===this.state.loadingState?null!==(t=this.props.notificationMessage)&&void 0!==t?t:"":a;return r.createElement(o.a,{key:`${n}_${this._accessibilityId}`,id:n,style:i,role:Te.s,notificationType:Ve.b},s)}_renderQuickFind(){const e=this._showNewQuickFindSearchBarForMobile();if(this.props.quickFindProps&&this._isWidthInitialized()){if(this._isWidthLessThanViewportSm()&&(this.state.quickFindVisibility||e)){const t=Object.assign(this.props.quickFindProps,{focusSearchBoxAfterRender:!0});return r.createElement(o.a,{key:"quickFind",style:this.props.styles.quickFindMobileStyle},r.createElement(Ze,Object.assign({},t,{updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,resetPagingInfoForEnhancedPaging:this._resetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),ref:this._dataSetQuickFindRef,showNewQuickFindSearchBarForMobile:e})))}if(!this._isWidthLessThanViewportSm())return Object(Ie.g)(this.props.contextString)?r.createElement(o.a,{style:this.props.styles.quickFindContainerStyle},this._getQuickFind()):this._getQuickFind()}return null}_renderAdvancedFilter(){return this._isWidthInitialized()&&this.props.showAdvancedFilter&&this.props.quickFindProps&&r.createElement(Se.a,{key:"openAdvancedFilter",id:"open-advanced-filter",iconType:"filter",title:Object(E.c)(this.props.resourceStrings,wt.c.OpenAdvancedFiltersTitleAndAria),style:this.props.styles.advancedFilterButtonStyles,onClick:()=>{this._renderAdvancedFindPanel()},tabIndex:0,accessibilityLabel:Object(E.c)(this.props.resourceStrings,wt.c.OpenAdvancedFiltersTitleAndAria)},r.createElement(Q.b,{id:"filter",accessibilityHidden:!0,type:d.a.Filter}))}_renderAdvancedFindPanel(){var e;this._updateDataSetLoadingState(1);const t=[{name:"entityName",value:this.props.entityTypeName},{name:"ViewId",value:null===(e=this.props.viewId)||void 0===e?void 0:e.guid}];this.props.retrieveRelatedEntitiesMetadata(this.props.entityTypeName).then(()=>{this.setState({isFilterPanelOpen:!0}),this._updateDataSetLoadingState(2),this.context.EventManager.ReportComponentSuccess(zt,t)},e=>{this._tracer.error(null==e?void 0:e.message),this._updateDataSetLoadingState(2),this.context.EventManager.ReportComponentFailure(zt,new Error(e),t)})}_renderDiscardChanges(){if(this.props.showAdvancedFilter&&this.props.isViewEdited&&this._isWidthInitialized()&&!this.props.showColumnEditor)return r.createElement(Se.a,{key:"clearAdvancedFilter",id:"clear-advanced-filter",iconType:"clearFilter",title:Object(E.c)(this.props.resourceStrings,j.AdvancedFind_DiscardButton_Title),style:this.props.styles.advancedFilterButtonStyles,onClick:()=>{var e;this.props.removeEditedViewPageMap(this.props.gridInput.pageToEditedViewMapId.guid,this.props.viewId),this._clearCustomFilterAndUpdateControlKeyIndex();const t=[{name:"entityName",value:this.props.entityTypeName},{name:"ViewId",value:null===(e=this.props.viewId)||void 0===e?void 0:e.guid}];this.context.EventManager.ReportComponentSuccess(Ht,t)},tabIndex:0,accessibilityLabel:Object(E.c)(this.props.resourceStrings,j.AdvancedFilter_DiscardButton_AccessibilityLabel)},r.createElement(Q.b,{id:"clearFilter",type:d.a.GlobalFilterClearAll}))}_renderColumnEditor(){if(this.props.showColumnEditor&&this._isWidthInitialized()){const e=Object(E.c)(this.props.resourceStrings,j.ColumnEditorButton);return r.createElement(Lt.a,{key:"columnEditorBtn",id:"columnEditor-btn",iconProps:{iconName:"ColumnOptions",style:{color:"black"}},title:e,"aria-label":e,onClick:()=>this.setState({columnEditorPanelOpen:!0}),style:this.props.styles.columnEditorButtonStyle})}}_clearCustomFilterAndUpdateControlKeyIndex(){this.props.setCustomFilter("",0,this.props.id,this.props.contextToken).then(()=>{this._keyIndex++,this._onViewChanged(this.props.viewId.guid,this.props.entityTypeName,!1)})}_getQuickFind(){return r.createElement(o.a,{key:"quickFind",style:this.props.styles.quickFindStyle},r.createElement(Ze,Object.assign({},this.props.quickFindProps,{updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,resetPagingInfoForEnhancedPaging:this._resetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),ref:this._dataSetQuickFindRef})))}_renderViewSelector(){if(this.props.viewSelectorProps&&this._isWidthInitialized()){const e=this._isWidthLessThanViewportSm()?this.props.styles.viewSelectorOuterMobileStyle:this.props.styles.viewSelectorOuterStyle;return r.createElement(o.a,{key:"viewSelector",style:e},r.createElement(X,Object.assign({isGridRoot:Object(Ie.e)(this.props.contextString)},this.props.viewSelectorProps,{isTablet:this._isWidthLessThanViewportM(),isPhone:this._isWidthLessThanViewportSm(),key:"dataSetHostView",onChange:this._onViewChanged,onItemIconPointerDown:this._onItemIconPointerDown,rootZIndex:this._isInSeeMoreState(),isRTL:this.props.isRTL,removeEditedViewPageMap:this.props.removeEditedViewPageMap})))}return this._renderTitle()}_renderQueueFilter(){if((this.props.entityTypeName===jt.Bb||this.props.entityTypeName===Pt.a)&&this.props.queueFilterProps&&this._isWidthInitialized()){const e=this._isWidthLessThanViewportSm()?this.props.styles.filterContainerMobileStyle:this.props.styles.filterContainerStyle;return r.createElement(oe,Object.assign({},this.props.queueFilterProps,{key:"queueFilter",onFilterChange:this._onFilterChange,updateFilterValue:this._updateFilterValue,resourceStrings:this.props.resourceStrings,style:e,isGridPaginationStateFeatureEnabled:this.props.featureControlProps.isGridPaginationStateFeatureEnabled}))}return null}_renderEntityFilter(){if(this.props.entityFilterProps&&this._isWidthInitialized()){const e=this._isWidthLessThanViewportSm(),t=e?this.props.styles.filterContainerMobileStyle:this.props.styles.filterContainerStyle,n=this.props.styles.activityTypeFilterContainerStyle;return r.createElement(ge,Object.assign({},this.props.entityFilterProps,{onToggleChange:this._onRollupViewToggleChanged,key:"EntityFilterDataSet",onFilterChange:this._onFilterChange,onActivityTypeChange:this._onActivityTypeMenuDismissed,onActivityTypeFilterClear:this._clearActivityTypeFilter,gridEntityName:this.props.gridEntityTypeName,resourceStrings:this.props.resourceStrings,containerStyle:t,activityTypeContainerStyle:n,rootZIndex:this._isInSeeMoreState(),isGridPaginationStateFeatureEnabled:this.props.featureControlProps.isGridPaginationStateFeatureEnabled,isMobile:e}))}return null}_renderDataSetChart(){return this.props.chartProps&&this._isWidthInitialized()?(this.props.chartProps.isLayoutVertical=this._isReflowLayoutVertical,r.createElement(S,Object.assign({},this.props.chartProps,{style:this._isReflowLayoutVertical?this._isWidthLessThanViewportSm()?this.props.styles.reflowChartMobileStyle:this.props.styles.reflowChartStyle:this.props.styles.chartStyle,key:"pageChartDataSet",closeChartPaneHandler:this.props.toggleChartPane}))):null}_renderBackButtonForGridInMobile(){return this.props.commandBarProps&&this._isWidthInitialized()&&Object(Ie.e)(this.props.contextString)&&this._isWidthLessThanViewportSm()&&this.props.backButtonEnabled?r.createElement(J.a,{pageId:this.props.id,overwriteStyle:{borderWidth:0,height:"auto",padding:0,margin:"-8px 0"}}):null}_renderCommandBar(){if(!this.props.commandBarProps||!this._isWidthInitialized())return null;this._commandBarLoadedPromise||(this._commandBarLoadedPromise=new Promise(e=>{this._commandBarLoadedResolve=e})),this._commandManagerId=this._commandManagerId||this.props.commandBarProps.commandManagerId||Object(me.a)();let e=this.props.styles.commandManagerContainerStyle,t=this.props.styles.commandBarStyle;this._isWidthLessThanViewportSm()&&(e=this.props.styles.commandManagerContainerMobileStyle,t=this.props.styles.commandBarMobileInnerStyle);const n=Object(Ie.e)(this.props.contextString);return Object(K.b)(this.props.commandBarRefreshProps,t,this._isWidthLessThanViewportSm(),e),r.createElement(re,Object.assign({},this.props.commandBarProps,{key:"commandBarDataSet",addedCommandList:this.state.addedCommandList,appendedCommandList:this.state.appendedCommandList,metaDataLoadedResolve:this._commandBarLoadedResolve,commandManagerId:this._commandManagerId,style:e,commandbarStyles:t,rootZIndex:this._isInSeeMoreState(),customControlType:this.props.updatedConfiguration.CustomControlId,isGridRoot:n,collapsed:this._isWidthLessThanViewportSm(),isNativeMode:this._isNativeSubgrid()}))}_renderFooter(){let e=!1;if(this.props.totalResultCount<=this.props.pageSize&&!this.props.totalRecordCountLimitExceeded&&Object(Ie.g)(this.props.contextString)&&!this._isInSeeMoreState()&&!this.props.jumpBarProps&&(e=this._shouldRenderSeeMoreButton(),!e))return this._logInfo("Hiding the footer for the subgrid because there is less than 2 pages of data"),null;if(this._isWidthInitialized()&&(this.props.jumpBarProps||this.props.pagingProps)){const t=this._isJumpBarRenderingAsFlyout()?this.props.styles.footerMobileStyle:this.props.isGridEditable?this.props.styles.footerEditableGridStyle:Object.assign(Object.assign({},this.props.styles.footerOuterStyle),this.props.jumpBarProps?this.props.styles.defaultFooterHeightStyle:this.props.styles.jumpBarLessFooterHeightStyle);if(!this.props.isGridEditable)return this._hideJumpbarForMobile()?null:r.createElement(o.a,{key:"dataSetFooter_"+this.props.id,style:t},!e&&this._renderJumpBar(),r.createElement(o.a,{key:"dataSetPagingContainer_"+this.props.id,style:this.props.styles.footerPagingContainer},this._renderPaging(e),this._renderSeeMoreButton()));if(this.props.jumpBarProps)return r.createElement(o.a,{key:"dataSetFooter_"+this.props.id,style:t},this._renderJumpBar());this._logInfo("Hiding the footer for the editable grid because the jump bar props is null")}return this._logInfo("Hiding the footer for the grid because the width for the controld is 0 or the jump bar props is null or paging props is null"),null}_jumpBarShouldRenderAsFlyout(e){const t=Object(E.c)(this.props.resourceStrings,j.JUMPBAR_ALPHABET);if(t){const n=t.split(","),r=e-100,i=this._isJumpBarRenderingAsFlyout()?.5:-.5;return!!n&&r/n.length<=32+i}return!1}_renderJumpBar(){let e=null;return this._isJumpBarRenderingAsFlyout()&&(e=this.props.styles.jumpBarButtonContainerStyle),this.props.jumpBarProps?r.createElement(o.a,{key:"jumpBar_"+this.props.id,style:e},r.createElement(ke,Object.assign({},this.props.jumpBarProps,{rootZIndex:this._isInSeeMoreState(),controlKey:this.props.controlKey,renderMobile:this._isJumpBarRenderingAsFlyout(),isDeviceSizeSmall:!this._isWidthGreaterThan480(),isRTL:this.props.isRTL,isGridRoot:Object(Ie.e)(this.props.contextString),updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,setResetPagingInfoForEnhancedPaging:this._setResetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),isMobile:this._isWidthLessThanViewportM()}))):null}_renderPaging(e){const t=Object(Ie.f)(this.props),n=!this.props.hasCustomDataProvider&&Object(nt.a)(this.props.totalRecordCountLimitExceeded);return t&&this._logInfo("Hiding the paging button for the grid because the sharepoint grid does not support paging"),this.props.pagingProps?r.createElement(We,Object.assign({},this.props.pagingProps,{pagingInfo:this.state.pagingInfo,shouldPagingTextRender:!e,incrementLastPage:this._incrementLastPage,setFirstPage:this._setFirstPage,enhancedPagingDisabled:!e&&!t&&!this._isNativePlatform,pagingTextDisabled:n,gridTotalRecordsCountLimit:this.props.gridTotalRecordsCountLimit,isGridRoot:Object(Ie.e)(this.props.contextString),updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),isServerOffline:this.props.isOffline})):null}renderDataSetHostComponent(e,t,n,i,a){var s,l,u;let h=[];const m=this._isWidthLessThanViewportSm();this._isReflowLayoutVertical=!(!this._isWidthLessThanMinWidthForChartPlusGridReflow()||!this.props.chartProps);try{const b=this._getDataSetHostErrorMessage();if(Object(nt.a)(b)||this.state.compositeControlInitState===A.a.Initializing){if(this._isWidthInitialized()||Object(Ie.g)(this.props.contextString)&&this.state.compositeControlInitState!==A.a.Initializing){this._isShowChartChanged&&(this._getUpdateAddedCommandList(this._showCommandBarButtonSearch(),this._showCommandBarButtonShowChart()),this._onAddedCommandListChange(),this._isShowChartChanged=!1);const t=(Object(Ie.e)(this.props.contextString)||Object(Ie.d)(this.props.contextString))&&this.props.entityIsActivityType;m||Object(Ie.g)(this.props.contextString)?(this.props.viewSelectorProps||this.props.quickFindProps||this.props.entityFilterProps||this.props.queueFilterProps||this.props.commandBarProps)&&(this.props.featureControlProps.isInMobileModeForOct2019&&Object(Ie.e)(this.props.contextString)&&(a=Object.assign(Object.assign({},a),{display:"none"})),h.push(r.createElement(o.a,{key:"dataSetHeader_"+this.props.id,style:n},this._renderHeader([this._renderBackButtonForGridInMobile(),this._renderViewSelector(),this._renderCommandBar()],a),this._renderQuickFind(),t||this.props.entityFilterProps&&this.props.entityFilterProps.isRollupViewSupported&&this.props.contextString===y.h.ASSOCIATEDGRID?this._renderEntityFilter():this._renderQueueFilter()))):(h.push(this._renderCommandBar()),(this.props.viewSelectorProps||this.props.quickFindProps||this.props.entityFilterProps||this.props.queueFilterProps)&&h.push(r.createElement(o.a,{key:"dataSetHeader_"+this.props.id,style:n},this._renderHeader([this._renderViewSelector(),this._renderDiscardChanges(),this._renderColumnEditor(),this._renderAdvancedFilter(),this._renderQuickFind()],a),t||this.props.entityFilterProps&&this.props.entityFilterProps.isRollupViewSupported&&this.props.contextString===y.h.ASSOCIATEDGRID?this._renderEntityFilter():this._renderQueueFilter())));let c=this.props.chartProps&&this._isReflowLayoutVertical?this.props.styles.reflowdataSetContentBodyStyle:this.props.styles.dataSetContentBodyStyle;this.props.featureControlProps.isAssociatedGridHeightEnabled&&Object(Ie.d)(this.props.contextString)&&(c=Object.assign(Object.assign({},c),{flexBasis:"0px"}));if(this.props.chartProps&&!this._isReflowLayoutVertical&&this.props.featureControlProps.isSuiterChartEnabled||this._showNewQuickFindSearchBarForMobile()){const e="1px solid #d8d8d8";c=Object.assign(Object.assign({},c),{borderTop:e})}const d=(null===(u=null===(l=null===(s=this.props)||void 0===s?void 0:s.configuration)||void 0===l?void 0:l.Parameters)||void 0===u?void 0:u.EnableSubGridAutoCollapse)&&this.props.configuration.Parameters.EnableSubGridAutoCollapse,b=d&&d.Value,f=this.props.featureControlProps.isSubGridAutoCollapseEnabled&&Object(Ie.g)(this.props.contextString)&&"true"===b;f&&0===this.props.totalResultCount&&(c=Object.assign(Object.assign({},c),{display:"none"})),this.props.featureControlProps.isSubGridRemoveMinHeightEnabled&&f&&(c=Object.assign(Object.assign({},c),{minHeight:"0px"}));const S=m&&Object(Ie.e)(this.props.contextString),v=this._parentDefinedProps;this.props.parentDefinedControlProps&&(v.height=this.props.parentDefinedControlProps.height>0&&this._seeMoreHelper.getSeeMorePopupStatus()===g.b.NotInUse?this.props.parentDefinedControlProps.height:void 0,v.width=this.props.parentDefinedControlProps.width>0&&this._seeMoreHelper.getSeeMorePopupStatus()===g.b.NotInUse?this.props.parentDefinedControlProps.width:void 0,v.decorators=this.props.parentDefinedControlProps.decorators,v.propertyBagOverrides=this.props.parentDefinedControlProps.propertyBagOverrides),v.parentInSeeMoreMode=this._seeMoreHelper.getSeeMorePopupStatus()!==g.b.NotInUse,v.containerStyleOverrides=this._getCombinedContainerStyleOverrides();const C="data-set-body-container";let O=null;this.props.chartProps&&this._isWidthInitialized()&&(O={width:"70%"});const _=Ne.a.getInstance().get_IsBrowserIE()?Object.assign(i,{flex:"1 1 100%"}):i;h.push(r.createElement(o.a,{key:"dataSetContentBody_"+this.props.id,style:c},this._renderDataSetChart(),r.createElement(o.a,{key:"dataSetBody_"+this.props.id,style:!0===this._isReflowLayoutVertical?this.props.styles.reflowGridStyle:Object.assign(_,O),className:this._isInSeeMoreState()?"seeMore":void 0,testhooks:{id:C}},r.createElement(p.c,{key:this.props.controlKey+this._keyIndex,controlId:this.props.controlId,id:this.props.id,formInfo:this._savedFormInfo,configuration:this.props.updatedConfiguration,descriptor:this.props.descriptor?this.props.descriptor:this._savedDefault,systemDefinedProperties:this.props.systemDefinedProperties,rowSpan:this.props.rowSpan,parentDefinedControlProps:v,parentContextToken:this.props.contextToken,contextString:this.props.contextString,externalCommandManagerId:this._commandManagerId,externalCommandPromise:this._commandBarLoadedPromise,shouldRender:this.props.nonCompositionProps?this.props.nonCompositionProps.shouldRender:void 0}),S?null:this._renderFooter()))),S&&h.push(this._renderFooter()),h.push(this._renderAccessibilityNotification(e)),h=h.concat(this._renderAccessibilityComponent(e))}}else if(2!==this.state.loadingState&&this._updateDataSetLoadingState(2),h.push(r.createElement(o.a,{key:"dataSetHeader_"+this.props.id,style:n},this._renderHeader([this._renderViewSelector()],a))),this._isWidthInitialized()){const e={fontSize:this._isHeightGreaterThan240()&&this._isWidthGreaterThan480()?"4.5em":"2em",color:"red"},t={display:"flex",justifyContent:"center"},n=Object(E.c)(this.props.resourceStrings,j.SEE_MORE_DETAILS);h.push(r.createElement(o.a,null,r.createElement(c.a,{id:"gridErrorContainer"+this.props.id,text:b,icon:d.a.DetailsPageClose,iconStyle:e}),this.state.controlLoadInnerErrorMessage&&!this._isDataSetHostKnownError(this.state.controlLoadErrorMessage)&&r.createElement(o.a,{style:t},r.createElement(fe.a,{key:"gridInnerErrorMessage",href:"#",accessibilityLabel:n,onClick:()=>{this.props.showInnerError(this.state.controlLoadInnerErrorMessage)}},n))))}const f=Object.assign(Object.assign({},t),this.state.controlLoadInnerErrorMessage&&{backgroundColor:"#FFFFFF"});return r.createElement(o.a,{style:f,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0,id:e,key:e,testhooks:{id:e,[Ct.b]:this.props.previewId,[Ct.c]:20},semanticTag:this.props.semanticTag},h)}catch(e){this._onControlLoadedError(e)}}_getDataSetHostErrorMessage(){var e;let t=null;if(this.props.hasReadRolePrivilege)if(this.props.isUCIEntity||this.props.hasCustomDataProvider)if(this.props.offlineProps.isOfflineSqlQueryAvailable)t=this.props.isOffline&&this.state.controlLoadErrorMessage&&!this.props.hasCustomDataProvider?this.props.offlineProps.isEntityAvailableForOffline?this.props.offlineProps.isOfflineAvailableForUse?this.state.controlLoadErrorMessage:Object(E.c)(this.props.resourceStrings,j.OFFLINE_NOT_READY_FOR_USE):Object(E.c)(this.props.resourceStrings,j.ENTITY_NOT_AVAILABLE_IN_PROFILE):this.state.controlLoadErrorMessage;else{let e="";this.props.offlineProps.offlineErrorMessageKey&&(e=Object(E.c)(this.props.resourceStrings,this.props.offlineProps.offlineErrorMessageKey)),e||(e=Object(E.c)(this.props.resourceStrings,j.VIEW_NOTAVAILABLE_IN_OFFLINE)),t=e}else{const e=this.props.entityDisplayName?this.props.entityDisplayName:this.props.entityTypeName,n=Object(E.c)(this.props.resourceStrings,j.UCI_DISABLED_ENTITY_ERROR);t=String.format(n,e)}else t=Object(E.c)(this.props.resourceStrings,j.READ_PRIVILEGE_VIOLATION_KEY);return Object(nt.a)(t)||null===(e=this._tracer)||void 0===e||e.error(`${Vt}._getDataSetHostErrorMessage : ${t}`,this.props.isOffline&&this.props.offlineProps.offlineGridErrorTelemetryParams),t}_renderHeader(e=[],t){const n=(e||[]).filter(e=>!!e);return n.length?r.createElement(o.a,{key:"dataSetHeaderInner_"+this.props.id,style:t},n):null}_getParentDefinedPropsDecoratorValue(e){return this.props.parentDefinedControlProps&&this.props.parentDefinedControlProps.decorators&&this.props.parentDefinedControlProps.decorators[e]}_shouldRenderSeeMoreButton(){return this._getParentDefinedPropsDecoratorValue("ShowSeeMore")&&!!this.props.totalResultCount}_renderSeeMoreButton(){const e=Object(Ie.g)(this.props.contextString),t=Object(Ie.d)(this.props.contextString),n=this._seeMoreHelper.getSeeMorePopupStatus(),i=Object(Ie.f)(this.props);return!((e||t)&&!i)||n===g.b.PopFadeIn||n===g.b.PoppedOut||n===g.b.ReturnFadeOutAndMove||this.props.totalResultCount>=0&&this.props.totalResultCount<=this.props.pageSize&&!this._shouldRenderSeeMoreButton()||!this._isNativePlatform?(this._logInfo("Hiding the See more button for the grid because the grid does not support see more or there is less than 2 pages of data"),null):r.createElement(Je,{onSeeMoreClick:this._seeMorePopup.bind(this,!0,!1),resourceStrings:this.props.resourceStrings,containerStyle:this.props.styles.seeMoreButtonContainerStyle,buttonStyle:this.props.styles.seeMoreButtonStyle,seeMoreTextStyle:this.props.styles.seeMoreButtonTextStyle,localizedStrings:this._getSeeMoreLocalizedStrings()})}_getSeeMoreLocalizedStrings(){let e=null;return this.props.viewSelectorProps&&this.props.viewSelectorProps.title?e=this.props.viewSelectorProps.title:this.props.descriptor.ShowLabel&&this.props.descriptor.Label?e=this.props.descriptor.Label:this.props.entityDisplayName&&(e=this.props.entityDisplayName),this._isNativeSubgrid()?{uniqueLabel:e,seeMoreLabel:Object(E.c)(this.props.resourceStrings,j.SEE_ALL_LABEL),seeMoreTooltip:Object(E.c)(this.props.resourceStrings,j.SEE_ALL_TOOL_TIP)}:{uniqueLabel:e}}_isStreamOnSuiterDashboard(){return this.props.featureControlProps.isSuiterDashboardEnabled&&Object(Ie.g)(this.props.contextString)&&this.props.configuration&&this.props.configuration.Parameters&&this.props.configuration.Parameters.UseDefaultCardFormForList&&this.props.configuration.Parameters.UseDefaultCardFormForList.Value}_renderProgressIndicator(){let e="datasethost-progress-indicator";this.props.descriptor&&(e+="-"+this.props.descriptor.Id);const t=Object.assign({},this.props.styles.dataSetChangingProgressIndicatorContainerStyle);let n=this.props.styles.progressIndicatorContainerStyle;return 1===this.state.loadingState?(t.width=this._width,t.height=Math.max(this._height,100)):0===this.state.loadingState&&this._isStreamOnSuiterDashboard()&&(n=Object.assign(Object.assign({},n),{borderBottom:"none"})),r.createElement(o.a,{key:"progressIndicatorContainer",id:"progressIndicatorContainer",style:0===this.state.loadingState?n:t},r.createElement(o.a,{key:"progressIndicator",id:"progressIndicator",style:0===this.state.loadingState?this.props.styles.progressIndicatorStyle:this.props.styles.dataSetChangingProgressIndicatorStyle},r.createElement(u.a,{key:e,id:e,testhooks:{id:e},style:this.props.styles.datasethostProgressIndicatorStyle,progressType:"ring",displayDelay:0===this.state.loadingState&&2e3,active:!0})))}componentWillUnmount(){this._seeMoreHelper&&this._seeMoreHelper.destroy(),clearTimeout(this._statusTimeout),this._statusTimeout=null}get _tracer(){return this.context?this.context.TraceManager.getTracer(y.z):null}_updateStatus(e){this.state.statusMessage===e||this._isSubGridFirstLoad||(clearTimeout(this._statusTimeout),this._statusTimeout=setTimeout(()=>this.setState({statusMessage:e}),1e3))}render(){var e,t,n,i,a;if(Object(nt.a)(this.props.updatedConfiguration))return this._logInfo("DataSetHost not rendered. Configuration is null"),null;if(!this.props.isInitialized&&this.props.contextToken&&this.props.primaryDataSetName&&this.state.compositeControlInitState!==A.a.Error){const e=this.props.updatedConfiguration.Parameters[this.props.primaryDataSetName];if(!e)return this._logInfo("DataSetHost not rendered. DataSet is not initialized and configuration does not contain primary dataset name."),null;if(this.state.compositeControlInitState===A.a.Uninitialized){this.setState({compositeControlInitState:A.a.Initializing});const t=this.props.viewId?this.props.viewId:e.ViewId?v.a.parse(e.ViewId):null,n=this.props.gridEntityTypeName||e.TargetEntityType||e.EntityName;if(!n&&!this.props.hasCustomDataProvider)return this._tracer&&this._tracer.error("DataSetHost not rendered. Reason: entityName unknown"),null;this.props&&this.props.hasCustomDataProvider&&this._logInfo("render: Initializing DataSetHost, id "+this.props.controlId+", for custom data provider"),this._logInfo(`Initializing grid for ${t} view and ${n} entity.`),this.props.initializeGrid(t,n,this.props.commandBarProps&&this.props.commandBarProps.commandManagerId,this.props.contextToken).then(()=>{this._logInfo(`Initialized grid for ${t} view and ${n} entity.`),this.setState({compositeControlInitState:A.a.Initialized})},e=>{const t=e instanceof Error?e.message:e;-1!==et.c.indexOf(t)?this._setControlLoadError(t):this._tracer&&this._tracer.error("Grid initialization failed. Reason: "+t),this.setState({compositeControlInitState:A.a.Error})})}return this._logInfo("DataSetHost not rendered. Either state is not initialized or resource strings are not initialized"),null}if(this.props&&this.props.nonCompositionProps&&this.props.nonCompositionProps.addedCommandListFromHostParent&&this._addedCommandListFromHostParent!==this.props.nonCompositionProps.addedCommandListFromHostParent&&(this._addedCommandListFromHostParent=this.props.nonCompositionProps.addedCommandListFromHostParent,this._onAddedCommandListChange()),this.props.descriptor&&this.props.descriptor.Parameters){const e=this.props.descriptor.Parameters[y.c];if(this._isWidthLessThanViewportSm()&&e&&"false"===e)return this._logInfo("DataSetHost not rendered. Available on phone is set to false"),null}this._configureDataSetControlParams(),this._updateViewSelectorProps(this.props),!this.props.viewId||!(null===(e=this.props.nonCompositionProps)||void 0===e?void 0:e.setPageInputViewId)||this.props.viewId.guid===(null===(n=null===(t=this.props.gridInput)||void 0===t?void 0:t.viewId)||void 0===n?void 0:n.guid)&&(null===(i=this.props.gridInput)||void 0===i?void 0:i.viewType)||this.props.savedQueryType===_.a.QUICKFIND_SEARCH||this.props.nonCompositionProps.setPageInputViewId(this.props.viewId.guid),this._savedDefault&&this.props.controlId===this._savedDefault.Id||(this._savedDefault={Id:this.props.controlId,HasContext:!0,Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1}),this.props.formInfo&&(this._savedFormInfo=this.props.formInfo,null!=this.props.ribbonId&&(this._savedFormInfo.RibbonId=this.props.ribbonId));const s=this.props.descriptor&&this.props.descriptor.DomId&&this.props.descriptor.Id?this.props.descriptor.DomId.includes(this.props.descriptor.Id)?this.props.descriptor.DomId:this.props.descriptor.Id:this.props.id,c="dataSetRoot_"+s,{containerStyle:u,headerStyle:d}=this.props.styles;let{rootStyle:p,headerInnerStyle:h,bodyStyle:m}=this.props.styles;this._updateChangeVisualizationButtons(this.props.updatedConfiguration.FormFactor.toString());let b=u,f={shadowStyle:null,innerStyle:null,outerStyle:null};this._isWidthLessThanViewportSm()&&(m=this.props.styles.bodyMobileStyle,h=this.props.styles.headerInnerMobileStyle);const S=this._seeMoreHelper.getSeeMorePopupStatus(),C=this._seeMoreHelper.getSeeMorePopupInfo();S!==g.b.NotInUse&&(f=g.a.getCustomControlFancyPopoutStyles(this.props.renderer,S,C),S!==g.b.ReturnFadeIn&&(b={height:C.startHeight,width:C.startWidth},p=Object.assign(Object.assign({},p),{height:C.endHeightInner-48})));const O=this.renderDataSetHostComponent(c,p,d,m,h),I=(this._getDataSetHostRootElement(),this._seeMorePopup.bind(this,!1)),j=this.props.isRTL,P=function(e,t,n,i,a,s,c,l=!1){const u=a||s,d="DataSetHostContainer";return r.createElement(o.a,{key:d,id:`${d}_${c}`,style:u,testhooks:{id:d}},e.renderCloseButton(i,!0,!1,l),e.renderSpacer(!0,!1),t)}(this._seeMoreHelper,O,0,I,f.innerStyle,p,c,j);let F=Object.assign({},f.outerStyle?f.outerStyle:p);0===this.state.loadingState?(F.visibility="hidden",F.maxHeight="0"):1===this.state.loadingState&&(F=Object.assign(Object.assign({},F),{opacity:"0.6",pointerEvents:"none",minHeight:this._height}));const T=function(e,t,n,i){const a=t||{width:"100%"},s=i?Te.e:null;return r.createElement(o.a,{key:"DataSetHostOuterContainer",id:n+"_outer",style:a,role:s},e)}(P,F,c,(null===(a=this._seeMoreHelper)||void 0===a?void 0:a.getSeeMorePopupStatus())!==g.b.NotInUse),w=function(e,t){return t=t||{display:"none"},r.createElement(o.a,{key:"shadow",id:e?e+"shadow":null,style:t})}(c,f.shadowStyle),E=`datassethost_root_view_${s}_${c}`,x=Ne.a.getInstance().get_IsBrowserIE()&&Object(Ie.g)(this.props.contextString)?{overflow:"visible"}:{},{mobileSubGridContainerStyles:N}=this.props.styles;let k=Object.assign(b,x);return this._isNativePlatform&&Object(Ie.g)(this.props.contextString)&&this.props.featureControlProps.isInMobileModeForApril2020&&this.props.featureControlProps.isSubgridImprovementsEnabled&&(k=Object.assign(Object.assign({},k),N)),r.createElement(o.a,{key:E,style:k},r.createElement(l.a,{role:Te.s,notificationType:Ve.b,style:{left:"-3000%",width:"0%",height:"0%",position:"absolute"}},this.state.statusMessage),w,T,this.props.showAdvancedFilter&&this.state.isFilterPanelOpen&&r.createElement(Tt,{controlId:this.props.controlId,controlKey:this.props.controlKey,id:this.props.id,contextToken:this.props.contextToken,entityTypeName:this.props.entityTypeName,fetchXML:this.props.fetchXML,filterPanelOpen:this.state.isFilterPanelOpen,viewId:this.props.viewId,gridInput:this.props.gridInput,updateFetchXml:this.props.updateFetchXml,updatePageInput:this.props.updatePageInput,closeFilterPanel:this.closeFilterPanel,onViewChanged:this._onViewChanged,setAdvancedPanelApplyClick:()=>{this._clearCustomFilterAndUpdateControlKeyIndex(),this.setState({isAdvancedFilterEdited:!0})},originalView:this.props.originalView,resourceStrings:this.props.resourceStrings,telemetryMonitorAdvancedFindDiscard:Ht,resetAdvancedFilter:()=>this.setState({isAdvancedFilterEdited:!1})}),this.props.showColumnEditor&&r.createElement(Rt,{entityTypeName:this.props.entityTypeName,onViewChanged:this._onViewChanged,columnEditorPanelOpen:this.state.columnEditorPanelOpen,columnEditorPanelDismiss:()=>this.setState({columnEditorPanelOpen:!1}),viewId:this.props.viewId,pageId:this.props.id,gridInput:this.props.gridInput,updatePageInput:this.props.updatePageInput,fetchXML:this.props.fetchXML,isAdvancedFindFilterEdited:this.state.isAdvancedFilterEdited}),2!==this.state.loadingState?this._renderProgressIndicator():null)}componentDidMount(){this._getUpdateAddedCommandList(this._showCommandBarButtonSearch(),this._showCommandBarButtonShowChart())}closeFilterPanel(){this.setState({isFilterPanelOpen:!1})}componentWillReceiveProps(e){(Object(Ie.e)(this.props.contextString)||Object(Ie.g)(this.props.contextString)||Object(Ie.d)(this.props.contextString))&&!this.props.isOffline&&e.isOffline&&0===this._offlineSqlQueryRetrieveState&&this.props.offlineProps.isEmptyOfflineSqlQuery&&(this._offlineSqlQueryRetrieveState=1,this.props.retrieveView(this.props.entityTypeName,this.props.savedQueryType,this.props.viewType,this.props.viewId,!1).then(()=>{this._offlineSqlQueryRetrieveState=2;const e=[{name:"scenario",value:"Called retrieveView"},{name:"entityTypeName",value:this.props.entityTypeName},{name:"viewId",value:v.a.toString(this.props.viewId)}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentSuccess&&this.context.EventManager.ReportComponentSuccess(Vt+".componentWillReceiveProps",e)}).catch(e=>{this._offlineSqlQueryRetrieveState=2;const t=[{name:"scenario",value:"Called retrieveView"},{name:"error",value:e&&e.message},{name:"entityTypeName",value:this.props.entityTypeName},{name:"viewId",value:v.a.toString(this.props.viewId)},{name:"viewType",value:this.props.viewType},{name:"savedQueryType",value:this.props.savedQueryType}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentFailure&&this.context.EventManager.ReportComponentFailure(Vt+".componentWillReceiveProps",e,null,t)})),this._isShowChartChanged=this.props.showChart!==e.showChart}shouldComponentUpdate(e){return this.props.entityTypeName===P.a&&this.props.gridEntityTypeName!==e.gridEntityTypeName&&this._currentFilterValue?(this._updateFilterOnViewSelectorChange(e.gridEntityTypeName),!1):1!==this._offlineSqlQueryRetrieveState&&(0!==e.refreshCounter&&this.props.refreshCounter!==e.refreshCounter&&2===this.state.loadingState&&this._updateDataSetLoadingState(1),!0)}componentDidUpdate(){this._seeMoreHelper.getSeeMorePopupStatus()!==g.b.NotInUse&&this._seeMoreHelper.checkOnPopupStatus(!0,!1,this._getDataSetHostRootElement());const e=Object(E.c)(this.props.resourceStrings,j.GRID_LOADING_PLACEHOLDER).replace("{0}",this.props.entityDisplayName),t=2===this.state.loadingState?this.props.notificationMessage:e;Object(Ie.g)(this.props.contextString)&&(0===this.state.loadingState?this._isSubGridFirstLoad=!0:1===this.state.loadingState&&(this._isSubGridFirstLoad=!1)),this._updateStatus(t)}_renderAccessibilityComponent(e){const t=e+"Accessibility";if(Object(Ie.e)(this.props.contextString)){const n=[];if(this.props.viewSelectorProps){const i=this.props.viewSelectorProps.id;n.push(r.createElement(Fe.a,{key:t,rootElementId:e,isModal:!1,shouldManageFocus:!0,defaultFocusId:i}))}else n.push(r.createElement(Fe.a,{key:t,rootElementId:e,isModal:!1,shouldManageFocus:!0}));return n}return null}_isInSeeMoreState(){const e=this._seeMoreHelper.getSeeMorePopupStatus();return e!==g.b.NotInUse&&e!==g.b.ReturnFadeOutAndMove&&e!==g.b.ReturnFadeIn}_isNativeSubgrid(){return Object(Ie.g)(this.props.contextString)&&this.props.clientHostSubtype===Dt.a.Phone&&this.props.featureControlProps.isInMobileModeForOct2019&&this.props.featureControlProps.isInMobileModeForApril2020&&this.props.featureControlProps.isSubgridImprovementsEnabled}_getCombinedContainerStyleOverrides(){const{containerStyleOverrides:e}=this._parentDefinedProps,t=this.props.parentDefinedControlProps&&this.props.parentDefinedControlProps.containerStyleOverrides;return Object.assign(e,t,{rootContainer:Object.assign(e.rootContainer,{flex:Object(Ie.e)(this.props.contextString)||this._isInSeeMoreState()?"1 1 100%":"1 1 auto"},t&&t.rootContainer),primaryInnerContainer:this._isInSeeMoreState()?{flex:"1 1 100%",minHeight:"0"}:{}})}_updateViewSelectorProps(e){if(e.descriptor&&e.viewSelectorProps&&e.descriptor.Parameters){const t=e.descriptor.Parameters[y.B],n=t?t.toString().split(","):null,r=n?n.map(e=>v.a.tryParse(e)):null;e.viewSelectorProps.viewIds=r||null}}_getCachedSize(){return this._cachedSize||(this._cachedSize=this.props.cachedSize),this._cachedSize}_isWidthInitialized(){return this.state.isWidthInitialized||this._getCachedSize()&&this._getCachedSize().isWidthInitialized||!1}_isWidthLessThanViewportSm(){return this.state.isWidthLessThanViewportSm||this._getCachedSize()&&this._getCachedSize().isWidthLessThanViewportSm||!1}_isWidthLessThanViewportM(){return this.state.isWidthLessThanViewportM||this._getCachedSize()&&this._getCachedSize().isWidthLessThanViewportM||!1}_isWidthLessThanMinWidthForChartPlusGridReflow(){return this.state.isWidthLessThanMinWidthForChartPlusGridReflow||this._getCachedSize()&&this._getCachedSize().isWidthLessThanMinWidthForChartPlusGridReflow||!1}_isWidthGreaterThan480(){return this.state.isWidthGreaterThan480||this._getCachedSize()&&this._getCachedSize().isWidthGreaterThan480||!1}_isHeightGreaterThan240(){return this.state.isHeightGreaterThan240||this._getCachedSize()&&this._getCachedSize().isHeightGreaterThan240||!1}_showCommandBarButtonSearch(){return this.state.showCommandBarButtonSearch||this._getCachedSize()&&this._getCachedSize().showCommandBarButtonSearch||!1}_showCommandBarButtonShowChart(){return this.state.showCommandBarButtonShowChart||this._getCachedSize()&&this._getCachedSize().showCommandBarButtonShowChart||!1}_isJumpBarRenderingAsFlyout(){return this.state.isJumpBarRenderingAsFlyout||this._getCachedSize()&&this._getCachedSize().isJumpBarRenderingAsFlyout||!1}_hideJumpbarForMobile(){return this.props.featureControlProps.isJumpbarFeatureForMobileEnabled&&this._isWidthLessThanViewportSm()&&(Object(Ie.e)(this.props.contextString)||Object(Ie.d)(this.props.contextString))&&this.props.featureControlProps.isInMobileModeForApril2020}_showNewQuickFindSearchBarForMobile(){var e,t;return this._checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot()&&this._isWidthLessThanViewportSm()&&((null===(e=this.props.configuration)||void 0===e?void 0:e.CustomControlId)===y.p||(null===(t=this.props.configuration)||void 0===t?void 0:t.Name)===y.m)}_checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot(){return this.props.featureControlProps.isQuickFindImprovementsEnabled&&this.props.featureControlProps.isInMobileModeForApril2020&&Object(Ie.e)(this.props.contextString)}}function Wt(e,t){return r.createElement(Gt,Object.assign({},e,{renderer:t.renderer}))}Gt.displayName="DataSetHost",Gt.contextType=Ot.a,Wt.contextTypes={renderer:a.object};const Ut=Object(s.a)(Ie.i,(function(e,t){return{initializeGrid:(n,r,i,a)=>{const s=tt.a.fromXmlAndSql("","",n).getQueryState(),o=t.descriptor&&t.descriptor.Parameters?t.descriptor.Parameters[y.r]:null,c=t.descriptor&&t.descriptor.Parameters&&t.descriptor.Parameters[y.s]?parseInt(t.descriptor.Parameters[y.s],10):null;i||(i=Object(ae.c)(t.id,a));const l=e(Object(ot.d)(s,r,t.id,a,t.descriptor,o,c,void 0,i)),u=e(Object(yt.b)(r,n,t.id)),d=e(Object(w.e)(j.labelList));return Promise.all([l,d,u])},removeEditedViewPageMap:(t,n)=>e(Object(Et.c)(t,n.guid)),updatePageInput:(t,n)=>e(Object(xt.b)(t,n)),updateView:(n,r,i,a,s,o,c,l,u)=>{const d=e(Object(ct.a)(n,o,r,i,a)).then(()=>e(Object(pt.a)(n,s))),p=v.a.tryParseOrNull(i),h=e(Object(yt.b)(a,p,n));let g=Promise.resolve(null);if(u){const t=Object($e.a)(a,c,o,l,!0);g=e(t.getFilterOptionsAction())}return Promise.all([d,h,g]).then(()=>{if(Object(Ie.e)(t.contextString)){const e=[{filterType:0,filterExpressionOrValue:null}];t.updateGridPaginationStateHandler(e,t.id)}e(Object(Ce.m)("",n,o)),e(Object(Ce.n)("",n,o)),e(Object(Ce.j)("",n,o)),e(Object(it.b)("",0,n,o))})},retrieveView:(t,n,r,i,a)=>e(Object(T.a)(t,n,r,i,!1)),markSelectedRows:(t,n,r)=>e(Object(Re.b)(t,n,r)),markSelectedRelatedEntity:(t,n,r)=>e(Object(Be.b)(t,n,r)),rowProperties:(t,n,r)=>e(Object(lt.b)(t,n,r)),updateFetchXml:(t,n,r)=>e(Object(ut.b)(t,n,r)),applyGridFilter:(n,r,i)=>{if(Object(Ie.e)(t.contextString)){const e=[{filterType:8,filterExpressionOrValue:n},{filterType:11,filterExpressionOrValue:r}];t.updateGridPaginationStateHandler(e,t.id)}e(Object(Ce.k)(r,t.id,i)),e(Object(Ce.l)(n,t.id,i))},applyActivityTypeFilter:(n,r,i)=>{if(Object(Ie.e)(t.contextString)){const e=[{filterType:9,filterExpressionOrValue:n},{filterType:10,filterExpressionOrValue:r}];t.updateGridPaginationStateHandler(e,t.id)}e(Object(Ce.h)(r,t.id,i)),e(Object(Ce.i)(n,t.id,i))},onSelectedOrderColumnChange:(n,r)=>{e(Object(Ce.o)(n,t.id,r))},toggleGridRollupView:(n,r)=>{e(Object(dt.b)(n,t.id,r))},updatePagingData:(t,n,r)=>e(Object(at.b)(t,n,r)),updateQueryKey:(t,n,r)=>{e(Object(st.b)(t,n,r))},setCustomFilter:(t,n,r,i)=>e(Object(it.b)(t,n,r,i)),runOnRecordSelect:(n,r,i)=>{e(function(e,t,n,r,i){return{type:"dataset.run.on.record.select",sync:!0,execute({dispatch:i,getState:a},s){const o=s.TraceManager.getTracer(y.z),c=y.x+".RunOnRecordAction";try{if(s&&s.ScriptManager){const l=s.ScriptManager.getContainer(e);if(l&&r&&1===r.length){const e=Object(rt.c)(a()),u=Object(rt.b)(a());e&&(i(l.getEventManager().addGridOnRecordSelectHandlers(t)),i(l.getEventManager().addGridOnChangeHandlers(t))),(e||u)&&i(l.getEventManager().runOnRecordSelect(t,n)),o.info("Triggered the action for {0} selected records"+r.length),s.EventManager.ReportComponentSuccess(c)}}}catch(e){const t="Triggered action for selected records failed with error : "+e.message;s.EventManager.ReportComponentFailure(c,Error(t))}}}}(n,r,r.controlName?r.controlName:"entity_control",i,Object(Ie.e)(t.contextString)||Object(Ie.g)(t.contextString)))},retrieveRelatedEntitiesMetadata:t=>e(Object(Nt.a)(t)),switchHomepageConfiguration:(t,n,r,i,a)=>{e(Object(ht.g)(t,n,r,i,a))},switchViewConfiguration:(t,n,r,i,a)=>{e(Object(ht.i)(t,n,r,i,a))},switchSubgridVisualization:(t,n,r)=>{e(Object(ht.h)(t,n,r))},switchAssociatedGridVisualization:(t,n,r,i,a,s,o,c)=>{e(c?Object(ht.f)(t,n,r,i,a,s,o):Object(ht.e)(t,n,r,a,o))},toggleChartPane:(t,n,r)=>{e(Object(ft.b)(t,n,r))},clearQuery:()=>{e(Object(Ft.a)())},updateUserDefaultGridView:(t,n,r,i,a,s)=>e(function(e,t,n,r,i,a){return{type:"grid.update.userdefaultview",execute(s,o){const c=o.TraceManager.getTracer(y.z),l=y.x+".updateUserDefaultGridViewAction";try{c.info("Updating the user default view for the grid.");const u=s.getState(),d="usersettings",p=new mt.a(d,Object(Xe.q)(u)),h=Object(N.h)(u,e);if(!p||!h.ObjectTypeCode)return Promise.resolve();const g="<DefaultGridViews><DefaultGridView><EntityTypeCode>{0}</EntityTypeCode><ChildEntityName>{1}</ChildEntityName><QueueId>{2}</QueueId><ViewId>{3}</ViewId><ViewType>{4}</ViewType></DefaultGridView></DefaultGridViews>";a&&(t="",n="",i=[],r="");const m=[];for(const e of i){const t=v.a.tryParse(e),n=v.a.externalGuid(t);m.push(n)}const b=String.format(g,h.ObjectTypeCode,r||"",1===m.length?m.toString():"",v.a.externalGuid(v.a.tryParse(t)),n);s.dispatch(Object(gt.f)(p,{personalizationsettings:b}));const y={ViewId:t,ViewType:+n,QueueId:i.toString()};return s.dispatch(Object(bt.f)(y,e)),o.EventManager.ReportComponentSuccess(l),Promise.resolve()}catch(e){const t="Failed to update user default grid view with error : "+e.message;o.EventManager.ReportComponentFailure(l,Error(t))}}}}(t,n,r,i,a,s)),updateCurrentPageNumber:(t,n,r)=>e(Object(xe.b)(t,n,r)),setNewPageRequested:(t,n,r)=>{e(Object(De.b)(t,n,r))},retrieveControlResourceStringsForSwitchVisualization:t=>{const n=t.filter(e=>null!=e);return e(Object(w.e)(n))},updatePageNumberForEnhancedPaging:e=>{if(Object(Ie.e)(t.contextString)){const n=[{filterType:12,filterExpressionOrValue:e}];t.updateGridPaginationStateHandler(n,t.id)}},openManageDuplicatesDialog:t=>{e(Object(_t.a)(null,null,mt.a.fromExternalEntityReference(t.entityReference))).then(n=>{if(0===n.status)return e(Object(It.a)(n.pageId)).then(e=>{"ignore_save"===e.value.param_lastButtonClicked&&t.reject()})})},showInnerError:n=>{const r=new kt.a(n,null,null,null,null,{stack:`${n} ${(new Error).stack}`,message:n});e(Object(At.a)(t.id,r))}}}))(Wt)},"89vK":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("unFF"),i=n("IqkD"),a=n("tJ+6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(){let e=null,t=null,n=null,s=null,o=null;return function(c,l){var u,d,p,h;const g=Object(r.a)(c),m=Object(a.c)(c),b=Object(a.a)(c),y=null==b?void 0:b.Colors,f=Object(i.g)(c);return t===g&&o===f&&s===y&&n===m||(t=g,o=f,s=y,n=m,e={selectedTabUnderlineStyle:{height:"3px",width:"auto",backgroundColor:m?null===(u=null==y?void 0:y.Palette)||void 0===u?void 0:u.Primary02:g.colors.BaseColor.Blue.Blue9,borderRadius:"2px",opacity:1,transition:"opacity 200ms;",marginTop:"3px"},highContrastSelectedTabUnerlineStyle:{height:"3px",width:"auto",borderTop:"solid transparent",opacity:1,transition:"opacity 200ms;",marginTop:"3px"},selectedTabStyle:{marginLeft:f?g.sizes.EditForm.TabListItemMargin:0,marginRight:f?0:g.sizes.EditForm.TabListItemMargin,padding:0,display:"inline",fontSize:g.fontSizes.Font115,cursor:"pointer",color:g.colors.BaseColor.Black,paddingBottom:"5px",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontFamily:g.fontFamilies.Semibold,width:"auto",maxWidth:g.sizes.EditForm.TabListItemMaxWidth,lineHeight:"25px"},scrollableSelectedTabStyle:{paddingLeft:g.sizes.EditForm.ScrollableTabListItemPadding,paddingRight:g.sizes.EditForm.ScrollableTabListItemPadding,paddingTop:"12px",paddingBottom:"12px",marginBottom:"8px",borderBottom:"1.5px solid "+(m?null===(d=null==y?void 0:y.Palette)||void 0===d?void 0:d.Primary02:g.colors.BaseColor.Blue.Blue9),flexGrow:1,display:"inline",fontSize:g.fontSizes.Font115,cursor:"pointer",color:m?null===(p=null==y?void 0:y.Palette)||void 0===p?void 0:p.Primary02:g.colors.BaseColor.Blue.Blue9,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontFamily:g.fontFamilies.Semibold,minWidth:"min-content",maxWidth:g.sizes.EditForm.ScrollableTabListItemMaxWidth,lineHeight:"25px","-webkit-user-select":"none"},singleScrollableSelectedTabStyle:{paddingLeft:g.sizes.EditForm.ScrollableTabListItemPadding,paddingRight:g.sizes.EditForm.ScrollableTabListItemPadding,paddingTop:"12px",paddingBottom:"12px",display:"inline",fontSize:g.fontSizes.Font115,cursor:"pointer",color:g.colors.BaseColor.Black,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontFamily:g.fontFamilies.Semibold,minWidth:"min-content",maxWidth:"none",lineHeight:"25px","-webkit-user-select":"none"},tabStyle:{marginLeft:f?g.sizes.EditForm.TabListItemMargin:0,marginRight:f?0:g.sizes.EditForm.TabListItemMargin,fontSize:g.fontSizes.Font115,padding:0,cursor:"pointer",width:"auto",maxWidth:g.sizes.EditForm.TabListItemMaxWidth,color:g.colors.BaseColor.Black,paddingBottom:g.sizes.Measures.Measure075,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontFamily:g.fontFamilies.Regular,lineHeight:"25px",":hover":{fontFamily:g.fontFamilies.Semibold}},scrollableTabStyle:{paddingLeft:g.sizes.EditForm.ScrollableTabListItemPadding,paddingRight:g.sizes.EditForm.ScrollableTabListItemPadding,paddingTop:"12px",paddingBottom:"12px",marginBottom:"8px",borderBottom:"0.5px solid "+g.colors.BaseColor.Grey.Grey2,flexGrow:1,fontSize:g.fontSizes.Font115,cursor:"pointer",minWidth:"min-content",maxWidth:g.sizes.EditForm.ScrollableTabListItemMaxWidth,color:g.colors.BaseColor.Black,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontFamily:g.fontFamilies.Regular,lineHeight:"25px","-webkit-user-select":"none",":active":{color:g.colors.BaseColor.Grey.Grey2}},semiboldContainerStyle:{visibility:"hidden",fontFamily:g.fontFamilies.Semibold,height:0,overflow:"hidden"},overflowButtonStyle:{borderStyle:"none",backgroundColor:m?null===(h=null==y?void 0:y.Palette)||void 0===h?void 0:h.Primary01:g.colors.BaseColor.White,cursor:"pointer",display:"inline",verticalAlign:"middle"}}),e}}},"8KYF":function(e,t,n){"use strict";n.r(t),n.d(t,"formInstancesReducer",(function(){return l})),n.d(t,"CREATE_FORM_INSTANCE",(function(){return s})),n.d(t,"REMOVE_FORM_INSTANCE",(function(){return o}));var r=n("4rWj"),i=n("Lc3p"),a=n("BoVI");const s="formInstance.create",o="formInstance.remove",c={};function l(e=c,t){if(t.meta&&t.meta.pageId){const n=t.meta.pageId;if(void 0===e[n]){if(t.type===s){const a={},s=Object.assign(Object.assign(Object.assign(Object.assign({},a),Object(r.a)(a,t)),Object(i.b)(a,t)),u(a,t));e=Object.freeze(Object.assign(Object.assign({},e),{[n]:s}))}}else{if(t.type===o){const t={},r=Object.keys(e);for(const i of r)i!==n&&(t[i]=e[i]);return Object.freeze(t)}const a=e[n],s=Object.assign(Object.assign(Object.assign(Object.assign({},a),Object(r.a)(a,t)),Object(i.b)(a,t)),u(a,t));e=Object.freeze(Object.assign(Object.assign({},e),{[n]:s}))}}return e}function u(e,t){return{input:function(e={},t){if(t.type===s)return Object.freeze(Object.assign({},t.payload.input));if(t.type===a.h)return Object.assign(Object.assign({},e),{id:t.payload.entityReference.id});return e}(e.input,t),__pageName:function(e,t){if(t.type===s)return t.payload.__pageName;return e}(e.__pageName,t)}}},"8O0c":function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n("Lyxw"),i=n("53SR"),a=n("Nb1E"),s=n("7tM0"),o=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c="ProcessControl_ActionExecuter_ExecutionTimeTooltip",l="ProcessControl_ActionExecuter_ErrorMessageTooltip",u="cc_MscrmControls.Containers.ProcessBreadCrumb/strings/ProcessControlResources";var d;function p(e){switch(e){case d.InProgress:case d.Waiting:return 1;case d.Succeeded:return 2;case d.Failed:case d.Canceled:return 3;default:return 0}}function h(e,t,n,r){let i="";if(Object(o.b)(e)||(i=String.format(r[c],new Date(e).toLocaleString())),n===d.Failed){const e=Object(o.b)(t)?r.Crm_GenericErrorMessage:t;i+="\n"+String.format(r[l],e)}return""===i?t:i}function g(e,t){return{type:"businessProcessFlow.actionLogs.retrieve",execute({dispatch:n,getState:o},d){const g=String.format("?$select=workflowlogid,message,status,modifiedon,stepname,activityname,_asyncoperationid_value&$filter=activityname%20eq%20'{0}'%20and%20_asyncoperationid_value%20eq%20{1}&$orderby=modifiedon%20desc&$top=500",e.guid,t.id.guid),m=o();if(function(e){return Object(r.b)(e,"BpfActionSupportActionQuerying")}(m))return n(Object(a.e)("workflowlog",g)).then(e=>{if(e.value&&e.value.length){const r={};r[c]=Object(s.a)(m,u,c),r[l]=Object(s.a)(m,u,l),r.Crm_GenericErrorMessage=Object(s.a)(m,u,"Crm_GenericErrorMessage");const a={};e.value.forEach(e=>{if(e.stepname&&-1===Object.keys(a).indexOf(e.stepname)){const t={actionLogId:e.workflowlogid,status:p(e.status),modifiedOn:e.modifiedon,stepId:e.stepname,processDefinitionid:e.activityname,processInstanceid:e._asyncoperationid_value,message:h(e.modifiedon,e.message,e.status,r)};a[e.stepname]=t}});const o={actionLogCollection:a};return n(Object(i.a)(o,t))}})}}}!function(e){e[e.InProgress=1]="InProgress",e[e.Succeeded=2]="Succeeded",e[e.Failed=3]="Failed",e[e.Canceled=4]="Canceled",e[e.Waiting=5]="Waiting"}(d||(d={}))},"91Ew":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="attribute.option.add";function a(e,t,n,a,s){const o=Object(r.x)(t);return{type:i,payload:{option:a,index:s},meta:{pageId:e,contextKey:o,dataFieldName:n}}}},"95wm":function(e,t,n){"use strict";n.d(t,"f",(function(){return h})),n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return b})),n.d(t,"b",(function(){return g})),n.d(t,"e",(function(){return y})),n.d(t,"a",(function(){return f}));var r=n("SAYH"),i=n("eXjw"),a=n("GEBM"),s=n("haag"),o=n("0L4T"),c=n("iZ7K"),l=n("YxC/"),u=n("69Qu"),d=n("WPtp"),p=n("LbMF");const h=s.a;function g(e,t,n,i,d,p,g,m=!1){return function(e,t,n){if(!r.a.toString(n.viewId)){const n="viewid is required to call retrieve chart data";throw e.EventManager.ReportComponentFailure(h+".retrieveChartData",Error(n),s.d,t),new Error(n)}return!0}(n,i,d)&&function(e,t,n,i,s){if(!r.a.toString(n.visualizationId)||r.a.toString(n.visualizationId)===r.a.EMPTYGUIDSTRING){const r=e(),u=Object(l.b)(r,a.n),d=Object(c.f)(r,i)||i,p=String.format(u,d);return Object(o.a)(r,t,p,n,s),!1}return!0}(e,t,d,p,g)&&function(e,t,n,r){const i=e();if(!Object(u.b)(i)){const e=Object(l.b)(i,a.r);return Object(o.a)(i,t,e,n,r),!1}return!0}(e,t,d,g)&&function(e,t,n,r){if(n.isRollUpView){const i=e(),s=Object(l.b)(i,a.j);return Object(o.a)(i,t,s,n,r),!1}return!0}(e,t,d,g)&&(!m||function(e,t,n,r){if(!n.viewXml){const i=Object(l.b)(e(),a.g);return Object(o.a)(e(),t,i,n,r),!1}return!0}(e,t,d,g)&&function(e,t,n,r){if(!n.fetchXml){const i=Object(l.b)(e(),a.o);return Object(o.a)(e(),t,i,n,r),!1}return!0}(e,t,d,g))}function m(e,t,n){const a=new r.a(e),s=r.a.toString(a),o=new r.a(t);return{type:n,payload:{charts:{[s]:{[r.a.toString(o)]:{initialized:i.a.Initializing}}}}}}function b(e,t){return{type:t,payload:{chartData:{[e]:{initialized:i.a.Initializing}}}}}function y(e,t,n){var r;const i=null===(r=null==e?void 0:e.category)||void 0===r?void 0:r.primaryGroupBy,a=null==i?void 0:i.groupAttribute;if(!function(e,t){var n;if(!e)return!1;const r=null===(n=null==e?void 0:e.entity)||void 0===n?void 0:n.entityName,i=null==e?void 0:e.attributeName,a=Object(p.b)(i,r,t);return"picklist"===a||"state"===a||"status"===a}(a,n))return;if(!e.isOrderPresentOnPrimaryGroupBy())return;const s=a.aliasName,o=new S(s);t.sort(o.comparator),i.descending&&t.reverse()}function f(e){const t=/(Name=\"o\:)(\w+)(,)(\d+)(\")/,n=e.match(new RegExp(t,"g"));let r=[];return n&&n.forEach(e=>{r=e.match(new RegExp(t,"m"))}),r}class S{constructor(e){this._primaryGroupByAttributeAlias=null,this.comparator=(e,t)=>this._getRawValue(e)-this._getRawValue(t),this._primaryGroupByAttributeAlias=e}_getRawValue(e){if(this._primaryGroupByAttributeAlias in e.fields){const t=e.fields[this._primaryGroupByAttributeAlias],n=Object(d.e)(t);return parseInt(n,10)}return-1}}},"9NSo":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="form.setLabel";function a(e,t,n){const a=Object(r.v)(t);return{type:i,payload:{label:n},meta:{pageId:e,contextKey:a}}}},"9gu/":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("dHD5"),i=n("i1f0"),a=n("SoKF"),s=n("gQ5I"),o=n("cUbT"),c=n("7Sr4");function l(e,t){return{type:"cancel.quickCreateFormAction.async",execute({dispatch:n,getState:s},o){const l=s(),d=Object(r.j)(s(),e);return c.a.getInstance().checkForOutstandingWork(s()).then(()=>{if(Object(i.Nb)(l,e,d)){return n(Object(a.a)(e)).then(r=>{if(!r)return Promise.resolve({});u(n,e,t)})}u(n,e,t)})}}}function u(e,t,n){if(n&&n.length>0){e(Object(s.e)(t,"save"));const r=[n[0].etn];for(let e=1;e<n.length;e++){let t=!1;for(let i=0;i<r.length;i++)r[i]===n[e].etn&&(t=!0);t||r.push(n[e].etn)}for(let t=0;t<r.length;t++)e(Object(o.a)(r[t]))}else e(Object(s.e)(t))}},"9i5P":function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var r=n("OQLa"),i=n("SAYH"),a=n("16wZ"),s=n("UqyN"),o=n("L8zx"),c=n("3yqi"),l=n("EOIL"),u=n("P6DH"),d=n("qshH"),p=n("9ksH"),h=n("E7fB"),g=n("n6Qt"),m=n("arV0"),b=n("deGN"),y=n("ZIjf");let f;class S{constructor(e,t,n,r,i,s){const o="ClientApi.XrmGridRow.constructor";e||Object(a.j)(o,"store"),r||Object(a.j)(o,"pageId"),n||Object(a.j)(o,"contextToken"),i||Object(a.j)(o,"entityType"),s||Object(a.j)(o,"entityId"),f=e,this._applicationContext=t,this._pageId=r,this._contextToken=n,this._entityType=i,this._entityId=s}get applicationContext(){return y.a.instance.reportUsage("ClientApi.XrmGridRow.applicationContext_get"),this._applicationContext}get context(){const e="ClientApi.XrmGridRow.context";try{return y.a.instance.reportCall(e),this._globalContext||(this._globalContext=new h.a(f,this._pageId)),y.a.instance.reportSuccess(e),this._globalContext}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(e,t,null,n),t}}get data(){const e="ClientApi.XrmGridRow.data";try{if(y.a.instance.reportCall(e),!this._data){const t=new s.a(f,this._contextToken,this._pageId,this,this._entityType,this._entityId,v,this._applicationContext);this._data=new o.a(f,this._contextToken,this._pageId,this,t);const n=new p.b(f,this._pageId),r=[],a={isEventParam:!0,name:"attributeName",value:""};r.push(a),t.attributes.forEach(t=>{const s=t.getName();a.value=s;const o={Id:s,Label:null,Name:s,ShowLabel:!1,Visible:!0,ClassId:new i.a(p.a),Disabled:!1,DataFieldName:s},c=n.createXrmControl(this._contextToken,o,this,e,r);c&&t.controls.add(c.getName(),c)})}return y.a.instance.reportSuccess(e),this._data}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(e,t,null,n),t}}getData(){try{return y.a.instance.reportUsage("ClientApi.XrmGridRow.getData"),this.data}catch(e){const t=d.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.getData",e,null,t),e}}get ui(){try{if(y.a.instance.reportCall("ClientApi.XrmGridRow.ui"),!this._ui){const e=new p.b(f,this._pageId);this._ui=new l.a(f,this._contextToken,this._pageId,this,this._entityType,e)}return y.a.instance.reportSuccess("ClientApi.XrmGridRow.ui"),this._ui}catch(e){const t=d.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.ui",e,null,t),e}}getControl(e){const t="ClientApi.XrmGridRow.getControl";try{y.a.instance.reportCall(t);const n=this.ui.controls.get(e);return y.a.instance.reportSuccess(t),n}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,n),e}}getAttribute(e){const t="ClientApi.XrmGridRow.getAttribute";try{if(y.a.instance.reportCall(t),this.data.entity){const n=this.data.entity.attributes.get(e);return y.a.instance.reportSuccess(t),n}return y.a.instance.reportSuccess(t),null}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,n),e}}getUrl(e){const t="ClientApi.XrmGridRow.getUrl";try{y.a.instance.reportCall(t);const n=this.data.entity.getEntityReference();this._internal=new g.a(f,this._applicationContext,this.context,this._pageId);const a=Object(m.g)(f.getState(),this._pageId),s={entityTypeName:n.entityType,etn:n.name,id:i.a.fromExternalGuid(n.id),entityTypeCode:this._internal.getEntityCode(n.entityType),languageId:this.context.userSettings.languageId,recordSetQueryKey:a.recordSetQueryKey};if(1===e){const e=f.dispatch(Object(r.a)(c.a.EditForm,s));return y.a.instance.reportSuccess(t),e}const o=Object(b.a)(f,this._pageId),l=f.dispatch(Object(r.c)(o,c.a.EditForm,s));return y.a.instance.reportSuccess(t),l}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,n),e}}get entityReference(){try{return this.data.entity.getEntityReference()}catch(e){const t=d.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.entityReference",e,null,t),e}}}function v(e,t,n){const r=Object(u.D)(f.getState(),{id:n},t.parentContextToken);return r||(e.TraceManager.getTracer("ClientApi.XrmGridRow.getAttributeNames").error("Grid attributes was null"),[])}},"9kE/":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("c/eZ"),i=n("nuS9"),a=n("Gh4N"),s=n("UdPG"),o=n("ptNh"),c=n("Ss07"),l=Object(s.a)(),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.type,n=e.size,s=e.ariaLabel,u=e.ariaLive,d=e.styles,p=e.label,h=e.theme,g=e.className,m=e.labelPosition,b=s,y=Object(o.j)(this.props,o.h,["size"]),f=n;void 0===f&&void 0!==t&&(f=t===a.b.large?a.a.large:a.a.medium);var S=l(d,{theme:h,size:f,className:g,labelPosition:m});return i.createElement("div",Object(r.__assign)({},y,{className:S.root}),i.createElement("div",{className:S.circle}),p&&i.createElement("div",{className:S.label},p),b&&i.createElement("div",{role:"status","aria-live":u},i.createElement(c.a,null,i.createElement("div",{className:S.screenReaderText},b))))},t.defaultProps={size:a.a.medium,ariaLive:"polite",labelPosition:"bottom"},t}(i.Component)},"9ksH":function(e,t,n){"use strict";n.d(t,"b",(function(){return Te})),n.d(t,"a",(function(){return Pe}));var r=n("AF/G"),i=n("arV0"),a=n("HcnX"),s=n("i1f0"),o=n("TsER"),c=n("qshH"),l=n("ZIjf");let u;class d extends a.a{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),u=e}refresh(){const e="ClientApi.XrmControlTimer.refresh";try{l.a.instance.reportCall(e),u.dispatch(Object(o.b)(this.pageId,this.contextToken,this.name)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}getState(){const e="ClientApi.XrmControlTimer.getState";try{l.a.instance.reportCall(e);const t=Object(s.cb)(u.getState(),this.pageId,this.contextToken),n=t.controls[this.getName()].parameters.timerState;return l.a.instance.reportSuccess(e),n}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlTimer.getControlType"),"timercontrol"}}var p=n("lJW1"),h=n("1kth"),g=n("16wZ"),m=n("PUjk");let b;class y extends a.a{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),b=e,this.registerObserversForControlStateChange()}addOnClick(e){const t="ClientApi.XrmControlButton.addOnClick";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),b.dispatch(Object(h.b)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}removeOnClick(e){const t="ClientApi.XrmControlButton.removeOnClick";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),b.dispatch(Object(h.w)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlButton.getControlType"),"button"}registerObserversForControlStateChange(){if(this.getName().startsWith("header_process")){const e=Object(m.a)(this.pageId);e&&this.controlStateObservable.registerObserver(e)}}}var f=n("0nOn"),S=n("yl9a"),v=n("NjDY"),C=n("3mEc");let O;class _ extends a.a{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),O=e;const s=[{name:"controlName",value:i,isEventParam:!0}];this._clientApiExecutorWebResource=new f.a(e,"ClientApi.XrmControlWebResource.",n,t,s)}getSrc(){return this._clientApiExecutorWebResource.execute("getSrc",()=>{const e=O.getState(),t=Object(v.t)(e)+Object(s.wb)(e,{controlName:this.name,id:this.pageId},this.contextToken);return Object(C.c)(e,this.pageId,this.name,this.contextToken,t)})}getContentWindow(){return this._clientApiExecutorWebResource.executeAsync("getContentWindow",(e,t)=>{const n=this.formContext.applicationContext.TraceManager.getTracer(e),r=()=>{const e=Object(s.xb)(O.getState(),this.pageId,this.getName());if(e){let r=null;try{return r=e.contentWindow,"complete"===r.document.readyState?Promise.resolve(r):(t.push({name:"readyState",value:r.document.readyState}),n.info("Frame content window not ready",t),Promise.reject({message:"Frame element not ready.",errorCode:111,contentWindow:r}))}catch(e){return r?(t.push({name:"Error",value:e.message}),n.warn("Error getting Frame content window readyState",t),Promise.resolve(r)):Promise.reject(e)}}else n.info("Frame DOM element not ready",t);return Promise.reject({message:"Frame element could not be found.",errorCode:111})};return r().then(e=>Promise.resolve(e)).catch(e=>{if(111!==e.errorCode)return Promise.reject(e);const i=this.contextToken,a=this.pageId,s=this.getName();return new Promise((e,o)=>{const c=()=>{Object(h.G)(i,a,c,s),r().then(t=>{e(t)}).catch(r=>{r.contentWindow?(n.err("Frame content window readyState should be complete after OnReadyStateComplete",t),e(r.contentWindow)):o&&(111===r.errorCode?(n.err("Frame Element not found after OnReadyStateComplete",t),o(new Error("Frame element could not be found."))):o(r))})};O.dispatch(Object(h.l)(i,a,c,s))})})})}getObject(){return this._clientApiExecutorWebResource.execute("getObject",()=>Object(s.xb)(O.getState(),this.pageId,this.name))}setSrc(e){return this._clientApiExecutorWebResource.execute("getControlType",()=>{Object(g.a)(e)||O.dispatch(Object(S.b)(this.pageId,this.name,this.contextToken,e))})}getControlType(){return this._clientApiExecutorWebResource.execute("getControlType",()=>"webresource")}addOnReadyStateComplete(e){return this._clientApiExecutorWebResource.execute("addOnReadyStateComplete",()=>{O.dispatch(Object(h.l)(this.contextToken,this.pageId,e,this.getName()))},[{name:"handler",value:e,isRequired:!0}])}removeOnReadyStateComplete(e){return this._clientApiExecutorWebResource.execute("removeOnReadyStateComplete",()=>{O.dispatch(Object(h.G)(this.contextToken,this.pageId,e,this.getName()))},[{name:"handler",value:e,isRequired:!0}])}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let I;class j extends _{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),I=e}getInitialUrl(){const e="ClientApi.XrmControlIFrame.getInitialUrl";try{l.a.instance.reportCall(e);const t=Object(s.sb)(I.getState(),{controlName:this.name,id:this.pageId},this.contextToken);return l.a.instance.reportSuccess(e),t}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlIFrame.getControlType"),"iframe"}getSrc(){const e="ClientApi.XrmControlIFrame.getSrc";try{l.a.instance.reportCall(e);const t=I.getState(),n=this.getInitialUrl(),r=Object(C.c)(t,this.pageId,this.name,this.contextToken,n);return l.a.instance.reportSuccess(e),r}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}}var P=n("bGh0"),F=n("/5se"),T=n("xorU"),w=n("fREn"),E=n("hA8P"),x=n("SAYH"),N=n("/q65");let A;class k extends P.a{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),A=e,this._clientApiExecutorLookup=new f.a(e,"ClientApi.XrmControlLookup.",n,t,[{name:"controlName",value:i,isEventParam:!0}])}addCustomView(e,t,n,r,i,a){this._clientApiExecutorLookup.execute("addCustomView",(s,o)=>{const c=x.a.tryParseOrNull(e);c||Object(g.k)(s,"guid","viewId",o),A.dispatch(Object(w.a)(this.pageId,this.name,c,t,this.contextToken,n,r,i)),a&&this.setDefaultView(e)},[{name:"viewId",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"guid"},{name:"entityLogicalName",value:t,isRequired:!0,isEventParam:!0},{name:"viewDisplayName",value:n,isRequired:!0},{name:"fetchXml",value:r,isRequired:!0},{name:"layoutXml",value:i,isRequired:!0},{name:"isDefault",value:a,isRequired:!0}])}addCustomFilter(e,t){const n="ClientApi.XrmControlLookup.addCustomFilter";Object(g.a)(e)&&Object(g.j)(n,"fetchXmlFilter"),Object(g.b)(e)||Object(g.l)(n);try{l.a.instance.reportCall(n),A.dispatch(Object(T.d)(this.pageId,this.name,t,this.contextToken,e)),this.controlStateObservable.notifyObservers(this.controlDescriptor),l.a.instance.reportSuccess(n)}catch(e){const t=c.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(n,e,null,t),e}}get disableMru(){const e="ClientApi.XrmControlLookup.getDisableMru";try{l.a.instance.reportCall(e);const t=Object(s.x)(A.getState(),{id:this.pageId,controlName:this.name},this.contextToken);return l.a.instance.reportSuccess(e),t}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}set disableMru(e){const t="ClientApi.XrmControlLookup.setDisableMru";try{l.a.instance.reportCall(t),A.dispatch(Object(E.b)(A.getState(),this.pageId,this.name,this.contextToken,e)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}startCustomFilter(){const e="ClientApi.XrmControlLookup.startCustomFilter";try{l.a.instance.reportCall(e),A.dispatch(Object(T.f)(this.pageId,this.name,this.contextToken)),this.controlStateObservable.notifyObservers(this.controlDescriptor),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}endCustomFilter(){const e="ClientApi.XrmControlLookup.endCustomFilter";try{l.a.instance.reportCall(e),A.dispatch(Object(T.e)(this.pageId,this.name,this.contextToken)),this.controlStateObservable.notifyObservers(this.controlDescriptor),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}getDefaultView(){return this._clientApiExecutorLookup.execute("getDefaultView",()=>{const e=Object(s.O)(A.getState(),this.pageId,this.name,this.contextToken);return e?x.a.externalGuid(new x.a(e)):null})}setDefaultView(e){this._clientApiExecutorLookup.execute("setDefaultView",(t,n)=>{const r=x.a.tryParseOrNull(e);r||Object(g.k)(t,"guid","id",n),A.dispatch(Object(F.b)(this.pageId,this.name,this.contextToken,r))},[{name:"defaultViewId",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"guid"}])}addOnLookupTagClick(e){const t="ClientApi.XrmControlLookup.addOnLookupTagClick";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),A.dispatch(Object(h.g)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}addPreSearch(e){const t="ClientApi.XrmControlLookup.addPreSearch";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),A.dispatch(Object(h.t)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}removeOnLookupTagClick(e){const t="ClientApi.XrmControlLookup.removeOnLookupTagClick";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),A.dispatch(Object(h.B)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}removePreSearch(e){const t="ClientApi.XrmControlLookup.removePreSearch";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),A.dispatch(Object(h.O)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlLookup.getControlType"),"lookup"}getEntityTypes(){const e="ClientApi.XrmControlLookup.getEntityTypes";try{l.a.instance.reportCall(e);const t=Object(s.Ob)(A.getState(),this.pageId,this.contextToken,this._dataFieldName);return l.a.instance.reportSuccess(e),t}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}setEntityTypes(e){const t="ClientApi.XrmControlLookup.setEntityTypes";e||Object(g.j)(t,"entityTypes");const n=[];try{l.a.instance.reportCall(t),e=Array.from(new Set(e));const r=Object(s.Pb)(A.getState(),this.pageId,this.contextToken,this._dataFieldName),i={};r.forEach(e=>{i[e]=!0}),e.forEach(e=>{i[e]||n.push(e)})}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t+".validation",e,null,n),e}n.length>0&&Object(g.h)(t,"entityType",n[0]);try{A.dispatch(Object(N.b)(this.pageId,this.contextToken,this._dataFieldName,e)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}get _dataFieldName(){return this.controlDescriptor&&this.controlDescriptor.DataFieldName?this.controlDescriptor.DataFieldName:this.name}}var M=n("91Ew"),D=n("KnyI"),R=n("tvJg");let B;class L extends P.a{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),B=e;const s=[{name:"controlName",value:i,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];this._clientApiExecutorOptionsetBase=new f.a(e,"ClientApi.XrmControlOptionSetBase.",n,t,s)}addOption(e,t){this._clientApiExecutorOptionsetBase.execute("addOption",()=>{const n=this._options.length;Object(g.a)(t)||isNaN(t)||t>=n?t=n:t<=0?t=0:t-=1,B.dispatch(Object(M.b)(this.pageId,this.contextToken,this.controlDescriptor.DataFieldName,{Color:null,Label:e.text,Value:e.value},t))},[{name:"optionSetItem",value:e,isRequired:!0},{name:"optionSetItem.value",value:null==e?void 0:e.value,isRequired:!0,expectedDataType:"number"}])}clearOptions(){this._clientApiExecutorOptionsetBase.execute("clearOptions",()=>{B.dispatch(Object(R.b)(this.pageId,this.contextToken,this.controlDescriptor.DataFieldName))})}removeOption(e){return this._clientApiExecutorOptionsetBase.execute("removeOption",()=>{B.dispatch(Object(D.b)(this.pageId,this.contextToken,this.controlDescriptor.DataFieldName,e))},[{name:"value",value:e,isRequired:!0}])}getOptions(){return this._clientApiExecutorOptionsetBase.execute("getOptions",()=>this._options)}get _options(){const e=new Array,t=Object(s.B)(B.getState(),this.pageId,this.contextToken,this.name);if(t){t.length&&e.push({text:"",value:NaN});for(const n in t)e.push({text:t[n].Label,value:t[n].Value})}return e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class V extends L{getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlOptionSet.getControlType"),"optionset"}}var z=n("cf3Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let H;class G extends P.a{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),this._isDateFormatDateTime=!1,H=e,this._clientApiExecutorDateTime=new f.a(e,"ClientApi.XrmControlDateTime.",n,t,[{name:"controlName",value:i,isEventParam:!0}]),this._clientApiExecutorDateTime.execute("constructor",(e,t)=>{this._isDateFormatDateTime=this._getShowTime(e,t)},null,!1)}getShowTime(){return this._clientApiExecutorDateTime.execute("getShowTime",(e,t)=>this._getShowTime(e,t))}setShowTime(e){this._clientApiExecutorDateTime.execute("setShowTime",(t,n)=>{if(this._getShowTime(t,n)!==e){const t=e&&this._isDateFormatDateTime?"datetime":"date";H.dispatch(Object(z.b)(this.pageId,this.contextToken,this.name,t))}})}_getShowTime(e,t){const n=this.getAttrDescriptor(e,t,this._clientApiExecutorDateTime);return!n||"datetime"===n.Format}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class W extends L{getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlMultiSelectOptionSet.getControlType"),"multiselectoptionset"}}var U=n("455M"),q=n("zgeC"),X=n("dHD5"),Y=n("HAeo"),K=n("ghNp"),Q=n("P6DH");let Z;class J extends a.a{constructor(e,t,n,r,i){super(e,t,n,r,r.Name,i);const a=Object(X.e)(t,r.Name);e.dispatch(Object(K.a)(this,n,a)),Z=e,this._clientApiExecutorControlstream=new f.a(e,"ClientApi.XrmControlStream.",n,t)}get clientApiExecutor(){return this._clientApiExecutorControlstream}_getGridControls(){if(!this._underlyingGridControls){this._underlyingGridControls=[];const e=this.controlDescriptor.Parameters&&this.controlDescriptor.Parameters[0]&&this.controlDescriptor.Parameters[0].StreamObjects;if(e){const t=e.StreamObjectCollection;if(t){const e=t.ShowAsTiles?[!0,!1]:[!0];for(const n of t)for(const t of e){const e=Object(X.o)(this.contextToken,this.getName(),n.Id,t),r=new Y.a(Z,e,this.pageId,!1,3,!0,this.formContext.applicationContext,e.controlName);this._underlyingGridControls.push({contextToken:e,gridControl:r})}}}}return this._underlyingGridControls}refresh(){this.clientApiExecutor.execute("refresh",()=>{const e=[];for(const{contextToken:t,gridControl:n}of this._getGridControls()){if(Object(Q.hb)(Z.getState(),this.pageId,t,t.controlName))try{n.refresh()}catch(t){e.push(t)}}if(e.length>0){const t=[...c.a.getInstance().getEventParameters(this.contextToken),{name:"count",value:e.length}];Object(g.e)(this.clientApiExecutor.getComponentName("refresh"),"Some grids in stream failed to refresh",null,t)}})}}var $=n("odYE"),ee=n("6QGX"),te=n("tpZ5"),ne=n("E7fB"),re=n("jq7Z"),ie=n("zsAz"),ae=n("IaGr");let se;class oe extends a.a{constructor(e,t,n,r,i,a){super(e,t,n,r,r.Name,i),se=e,this._clientApiExecutor=new f.a(e,"ClientApi.XrmControlSubFormBase.",n,t,[{name:"controlName",value:null==r?void 0:r.Name,isEventParam:!0}]),this._xrmControlFactory=a}getParentComponent(){return Object(re.a)(se.getState(),this.pageId)}get context(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.context",()=>this._form?this._form.context:null)}get _parentFormContext(){return this.formContext}get _form(){if(this._tryGetSubFormInstanceId(),!this._isSubFormMetadataLoaded())throw Object(ie.d)("SUBFORM_METADATA_NOT_LOADED",2415919107);const e=this._subFormControlContextToken;if(e&&this._formInstance)return this._formInstance;const t=this._getValueInternal(),n=Object(ee.d)(t);if(e)return this._formInstance=se.dispatch(Object(K.b)(this._subFormInstanceId,e)),this._formInstance||n&&n.length>0&&(this._formInstance=se.dispatch(this._createXrmForm(e,this._subFormInstanceId,n[0].entityType,new x.a(n[0].id)))),this._formInstance&&!this._formInstance.context&&(this._formInstance.context=this._parentFormContext.context),this._formInstance;return c.a.getInstance().getEventParameters(this.contextToken).push({name:"controlName",value:this.getName()}),ae.a.getInstance().traceManager.getTracer("ClientApi.XrmControlSubFormBase._form").info("XrmControlSubForm._form is null"),null}_createXrmForm(e,t,n,r){const i=this._xrmControlFactory;return{type:"clientapi.create.xrmform",sync:!0,execute(a,s){const o=new te.a(a,{etn:n,id:r},i,e,t);o.applicationContext=s;const c=new ne.a(a,t);return o.context=c,o}}}get _subFormControlContextToken(){const e=this._getValueInternal(),t=Object(ee.d)(e);return t&&t[0]&&t[0].id?this._entityRecordId!==t[0].id&&(this._entityType=t[0].entityType,this._entityRecordId=t[0].id,this._subFormContextToken&&se.dispatch(Object(K.h)(this._subFormInstanceId,this._subFormContextToken)),this._subFormContextToken=this._getSubFormContextToken(this.contextToken,this.name,this._entityType),this._formInstance=null):this._subFormContextToken&&(se.dispatch(Object(K.h)(this._subFormInstanceId,this._subFormContextToken)),this._subFormContextToken=void 0,this._entityType=void 0,this._entityRecordId=void 0,this._formInstance=null),this._subFormContextToken}get data(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.data",()=>this._form?this._form.data:null)}get ui(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.ui",()=>this._form?this._form.ui:null)}get entityReference(){return l.a.instance.reportUsage("ClientApi.XrmControlSubFormBase.entityReference"),null}getControl(e){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getControl",()=>this._form?this._form.getControl(e):null)}getAttribute(e){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getAttribute",()=>this._form?this._form.getAttribute(e):null)}getUrl(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getUrl",()=>this._form?this._form.getUrl():null)}refresh(){this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.refresh",()=>{this.data&&this.data.refresh()})}_getValueInternal(){const e=this._parentFormContext.data.entity.getEntityName(),t=this._parentFormContext.data.entity.getId(),n=t?new $.a(e,new x.a(t)):new $.a(e),r=Object(s.ac)(se.getState(),this._subFormInstanceId,this.contextToken);return Object(s.X)(se.getState(),this._subFormInstanceId,this._subFormContextToken,r,n,this.controlDescriptor.DataFieldName)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let ce;class le extends oe{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),ce=e}_getSubFormContextToken(e,t,n){return Object(X.l)(this.contextToken,this.name,this._entityType)}getSubFormInstanceId(){return this.pageId}_isSubFormMetadataLoaded(){return!!this._subFormInstanceId}_tryGetSubFormInstanceId(){}get _subFormInstanceId(){return this.pageId}isLoaded(){const e="ClientApi.XrmControlQuickForm.isLoaded";try{l.a.instance.reportCall(e);const t=Object(s.ic)(ce.getState(),this.getSubFormInstanceId(),this._subFormControlContextToken);return l.a.instance.reportSuccess(e),!!t}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlQuickForm.getControlType"),"quickform"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let ue;class de extends P.a{constructor(e,t,n,r,i,a){e||Object(g.j)("ClientApi.XrmStandardDataControl.constructor","store"),super(e,t,n,r,i,a),ue=e}getValue(){const e="ClientApi.XrmStandardDataControl.getValue";try{l.a.instance.reportCall(e);const t=Object(s.F)(ue.getState(),{controlName:this.name,id:this.pageId},this.contextToken);return l.a.instance.reportSuccess(e),t}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(e,t,null,n),t}}addOnKeyPress(e){const t="ClientApi.XrmStandardDataControl.addOnKeyPress";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),ue.dispatch(Object(h.e)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(t,e,null,n),e}}removeOnKeyPress(e){const t="ClientApi.XrmStandardDataControl.removeOnKeyPress";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),ue.dispatch(Object(h.z)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(t,e,null,n),e}}fireOnKeyPress(){const e="ClientApi.XrmStandardDataControl.fireOnKeyPress";try{l.a.instance.reportCall(e),ue.dispatch(Object(h.R)(this.contextToken,this.pageId,this.name,this)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(e,t,null,n),t}}}var pe=n("ywwS"),he=n("VqBP"),ge=n("w92Z");class me extends V{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),this._clientApiExecutorDependentOptionSet=new f.a(e,"ClientApi.XrmControlDependentOptionSet.",n,t,[{name:"controlName",value:i,isEventParam:!0}])}addOption(e,t){return this._clientApiExecutorDependentOptionSet.execute("addOption",(e,t)=>{Object(g.i)(e,"DependentOptionSet.addOption",t)})}clearOptions(){return this._clientApiExecutorDependentOptionSet.execute("clearOptions",(e,t)=>{Object(g.i)(e,"DependentOptionSet.clearOptions",t)})}removeOption(e){return this._clientApiExecutorDependentOptionSet.execute("removeOption",(e,t)=>{Object(g.i)(e,"DependentOptionSet.removeOption",t)})}setDisabled(e){return this._clientApiExecutorDependentOptionSet.execute("setDisabled",(e,t)=>{Object(g.i)(e,"DependentOptionSet.setDisabled",t)})}setVisible(e){return this._clientApiExecutorDependentOptionSet.execute("setVisible",(e,t)=>{Object(g.i)(e,"DependentOptionSet.setVisible",t)})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class be extends W{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),this._clientApiExecutorDependentOptionSet=new f.a(e,"ClientApi.XrmControlMultiSelectDependentOptionSet.",n,t,[{name:"controlName",value:i,isEventParam:!0}])}addOption(e,t){return this._clientApiExecutorDependentOptionSet.execute("addOption",(e,t)=>{Object(g.i)(e,"MultiSelectDependentOptionSet.addOption",t)})}clearOptions(){return this._clientApiExecutorDependentOptionSet.execute("clearOptions",(e,t)=>{Object(g.i)(e,"MultiSelectDependentOptionSet.clearOptions",t)})}removeOption(e){return this._clientApiExecutorDependentOptionSet.execute("removeOption",(e,t)=>{Object(g.i)(e,"MultiSelectDependentOptionSet.removeOption",t)})}setDisabled(e){return this._clientApiExecutorDependentOptionSet.execute("setDisabled",(e,t)=>{Object(g.i)(e,"MultiSelectDependentOptionSet.setDisabled",t)})}setVisible(e){return this._clientApiExecutorDependentOptionSet.execute("setVisible",(e,t)=>{Object(g.i)(e,"MultiSelectDependentOptionSet.setVisible",t)})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ye extends de{setDisabled(e){const t="ClientApi.XrmDependentOptionSetGridControl.setDisabled";l.a.instance.reportUsage(t),Object(g.e)(t,String.format("Can not execute {0} for dependent option set control","setDisabled"))}}var fe=n("LbMF"),Se=n("3/02"),ve=n("Lyxw"),Ce=n("Z/4N"),Oe=n("BoVI");let _e;class Ie extends oe{constructor(e,t,n,r,i,a){var s,o;super(e,t,n,r,i,a),this._formInstanceId=null===(o=null===(s=this.getParentComponent())||void 0===s?void 0:s.formInstances)||void 0===o?void 0:o.formInstanceIdByControlName[this.controlDescriptor.Name],this._formComponentClientApiExecutor=new f.a(e,"ClientApi.XrmControlFormComponent.",this._formInstanceId),this._formComponentClientApiExecutor.addEventParameter({name:"controlName",value:r.Name,isEventParam:!0}),_e=e}_tryGetSubFormInstanceId(){var e,t;this._formInstanceId||(this._formInstanceId=null===(t=null===(e=this.getParentComponent())||void 0===e?void 0:e.formInstances)||void 0===t?void 0:t.formInstanceIdByControlName[this.controlDescriptor.Name])}_isSubFormMetadataLoaded(){return!!this._subFormInstanceId}_getSubFormContextToken(e,t,n){return Object(X.h)(n)}get _subFormInstanceId(){return this._formInstanceId}isLoaded(){return this._isSubFormMetadataLoaded()&&this._formComponentClientApiExecutor.execute("ClientApi.XrmControlFormComponent.isLoaded",()=>!!Object(s.yc)(_e.getState(),this._subFormInstanceId,this._subFormControlContextToken))}setInitializationIntent(e="fullload"){this._formComponentClientApiExecutor.execute("setInitializationIntent",t=>{"nothing"!==e&&"fullload"!==e&&Object(g.h)(t,e,"intent"),_e.dispatch(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,n,r){const i=Object(X.v)(n);return{type:Oe.d,payload:r,meta:{pageId:e,controlName:t,contextKey:i}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(this.pageId,this.name,this.contextToken,e))},[{name:"intent",value:e,isEventParam:!0,expectedDataType:"string"}])}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlFormComponent.getControlType"),"formcomponent"}}var je=n("CYtR");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Pe="3d180de6-b456-4d90-9d5a-9899936baf44";let Fe;class Te{constructor(e,t){this._pageId=t,Fe=e}createXrmControl(e,t,n,s,o){Object(g.g)(t,s,"control");try{o.push({name:"controlClassId",value:t&&t.ClassId?t.ClassId.guid:""}),o.push({name:"controlName",value:t?t.Name:""}),o.push({name:"controlDataFieldName",value:t?t.DataFieldName:""}),o.push({name:"pageId",value:this._pageId});const l=Object(i.l)(Fe.getState(),this._pageId);o.push({name:"pageType",value:l});let u=!1,h=null,g=!1;const m=this._getControlType(t,n,e,s,o);switch(m){case r.i.guid:h=new y(Fe,e,this._pageId,t,t.Name,n);break;case U.a.KbContent:case U.a.KbArticle:case r.C.guid:case r.I.guid:h=new j(Fe,e,this._pageId,t,t.Name,n);break;case U.a.LookupRegarding:case U.a.LookupCustomer:case U.a.LookupMultiEntity:case U.a.LookupOwner:case U.a.LookupSimple:case U.a.LookupPartyList:case r.M.guid:case r.fb.guid:case r.S.guid:case r.l.guid:if(Object(ve.c)(Fe.getState(),Se.jb)){const r=Object(re.b)(Fe.getState(),this._pageId,e);if(Object(Ce.c)(Fe.getState(),t.UniqueId,r)===je.d){h=new Ie(Fe,e,this._pageId,t,n,this);break}}h=new k(Fe,e,this._pageId,t,t.Name,n);break;case U.a.OptionSet:case r.U.guid:if(g=Object(ve.c)(Fe.getState(),Se.L),1==g){const r=this._getEntityNameForControl(t,n);if(Object(fe.l)(Fe.getState(),r,t.DataFieldName)){h=new me(Fe,e,this._pageId,t,t.Name,n);break}}case U.a.EntityNameOptionSet:case U.a.TwoOptions:case U.a.StatusOptionSet:case r.sb.guid:case r.K.guid:case r.W.guid:case r.V.guid:case r.hb.guid:case r.n.guid:case r.N.guid:h=new V(Fe,e,this._pageId,t,t.Name,n);break;case U.a.MultiSelectPicklist:case r.Q.guid:if(g=Object(ve.c)(Fe.getState(),Se.L),g){const r=this._getEntityNameForControl(t,n);if(Object(fe.l)(Fe.getState(),r,t.DataFieldName)){h=new be(Fe,e,this._pageId,t,t.Name,n);break}}h=new W(Fe,e,this._pageId,t,t.Name,n);break;case U.a.QuickForm:case r.cb.guid:case r.ab.guid:case r.Z.guid:const i=new le(Fe,e,this._pageId,t,n,this);n.ui.quickForms.add(t.Name,i);break;case U.a.SearchWidget:case U.a.ReferencePanelSearchWidget:case r.db.guid:case r.kb.guid:h=new p.a(Fe,e,this._pageId,t,t.Name,n);break;case U.a.TimelineWall:case r.qb.guid:h=Fe.dispatch(Object(K.f)(this._pageId,Object(X.p)(e,t.Name))),h||(h=new pe.a(Fe,e,this._pageId,t,t.Name,t.LabelId,n,n.applicationContext));break;case U.a.DateAndTimeDateOnly:case U.a.DateAndTimeDateAndTime:case r.q.guid:h=new G(Fe,e,this._pageId,t,t.Name,n);break;case U.a.Grid:case r.eb.guid:case r.E.guid:const l=Object(X.p)(e,t.Name),b=Fe.dispatch(Object(K.c)(this._pageId,l));b&&(b.getName||3!==b.getGridType()?h=b:(c.a.getInstance().reportFailure(s,new Error("Main grid found in cache - converting to a subgrid."),null,o),Fe.dispatch(Object(K.h)(this._pageId,l)))),h||(h=new q.a(Fe,e,this._pageId,t.Name,Object(Q.wb)(Fe.getState(),this._pageId,e,t.Name),n,t,n.applicationContext));break;case U.a.Timer:case r.rb.guid:h=new d(Fe,e,this._pageId,t,t.Name,n);break;case U.a.WebResourceHtmlControl:case r.ub.guid:case r.vb.guid:h=new _(Fe,e,this._pageId,t,t.Name,n);break;case r.mb.guid:h=new J(Fe,e,this._pageId,t,n);break;case r.z.guid:case r.G.guid:break;case Pe:if(g=Object(ve.c)(Fe.getState(),Se.L),g&&Object(fe.l)(Fe.getState(),e.entityTypeName,t.Name)){h=new ye(Fe,e,this._pageId,t,t.Name,n);break}case U.a.AppliedFilters:case U.a.BusinessProcessFlow:case U.a.Card:case U.a.Currency:case U.a.Dashboard:case U.a.Decimal:case U.a.EmailEngagementActions:case U.a.EmailEngagementRecipientActivity:case U.a.FP:case U.a.GlobalFilter:case U.a.MicrosoftFlow:case U.a.Multiple:case U.a.PowerBI:case U.a.ReferencePanel:case U.a.Search:case U.a.SingleLineAddress:case U.a.SingleLineEmail:case U.a.SingleLinePhone:case U.a.SingleLineText:case U.a.SingleLineTextArea:case U.a.SingleLineTickerSymbol:case U.a.SingleLineURL:case U.a.SocialInsightsControl:case U.a.WholeDuration:case U.a.WholeLanguage:case U.a.WholeNone:case U.a.WholeTimeZone:case r.a.guid:case r.b.guid:case r.c.guid:case r.d.guid:case r.e.guid:case r.f.guid:case r.g.guid:case r.h.guid:case r.j.guid:case r.k.guid:case r.m.guid:case r.p.guid:case r.r.guid:case r.s.guid:case r.t.guid:case r.u.guid:case r.v.guid:case r.w.guid:case r.x.guid:case r.y.guid:case r.A.guid:case r.B.guid:case r.D.guid:case r.H.guid:case r.J.guid:case r.L.guid:case r.O.guid:case r.P.guid:case r.R.guid:case r.T.guid:case r.X.guid:case r.Y.guid:case r.bb.guid:case r.gb.guid:case r.ib.guid:case r.jb.guid:case r.lb.guid:case r.mb.guid:case r.nb.guid:case r.ob.guid:case r.pb.guid:case r.tb.guid:case r.wb.guid:u=!0;default:h=t.DataFieldName?new de(Fe,e,this._pageId,t,t.Name,n):new a.a(Fe,e,this._pageId,t,t.Name,n),u||(o.push({name:"controlType",value:m}),ae.a.getInstance().traceManager.getTracer(s).error("Unknown Form Control",o))}return h}catch(e){return c.a.getInstance().reportFailure(s+".createXrmControl",e,null,o),null}}_getControlType(e,t,n,i,a){if(x.a.equals(e.ClassId,r.o)){const r=this._getCustomControlType(e,t,n);return r||ae.a.getInstance().traceManager.getTracer(i+".controlPrimaryType").error("Control primary type could not be determined",a),a.push({name:"manifestControlType",value:r}),r}return e.ClassId.guid}_getCustomControlType(e,t,n){var r,i,a;const o=Object(re.b)(Fe.getState(),this._pageId,n);let c=Object(he.c)(Fe.getState(),e,o);if(!c){const l=Object(s.h)(),u=(null===(i=null===(r=t.data)||void 0===r?void 0:r.entity)||void 0===i?void 0:i.getEntityName())||"";let d=l(Fe.getState(),e,this._pageId,o,u);if(d||(d=Object(ge.a)(Fe.getState(),e,this._pageId,n)),null==d?void 0:d.Parameters)for(const e in d.Parameters)if(null===(a=d.Parameters[e])||void 0===a?void 0:a.Primary){c=d.Parameters[e].Type;break}}return c}_getEntityNameForControl(e,t){let n="";if(e.Relationship)n=Object(s.T)(Fe.getState(),this._pageId,e.Relationship);else{const r=t.getAttribute(e.DataFieldName);r&&r.getParent()&&(n=r.getParent().getEntityName())}return n}}},AE7n:function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var r=n("YYhu"),i=n("iZ7K"),a=n("vNXc"),s=n("q/4y"),o=n("GxhD"),c=n("hQd/"),l=n("SAYH"),u=n("i1f0"),d=n("dHD5"),p=n("arV0"),h=n("P6DH"),g=n("fILV"),m=n("aF0N"),b=n("P+kM"),y=n("3/02"),f=n("Lyxw"),S=n("HfZT"),v=n("E8F2");function C(e,t,n,C,O,_,I=!1,j){return{type:"embeddedEntity.save",execute(C,P){const F=C.getState(),T=new l.a(n),w=Object(d.f)(j,T,t);let E;switch(Object(p.l)(F,e)){case g.a:E=Object(h.R)(F,e,w);break;default:E=Object(u.ac)(F,e,w)}const x=Object(m.c)(F),N=Object(m.b)(F);if((x||N)&&"Dashboard"!==Object(p.l)(F,e)){const t=P.ScriptManager.getContainer(e).getEventManager();if(C.dispatch(t.runOnSave(j,1,null,n)))return Promise.reject(Object(v.b)(F,e,2200000005,""))}return C.dispatch(Object(r.c)(E,I,O)).then(r=>{const u=Object(h.qb)(F,new l.a(_),e),d=Object(i.h)(F,t),p=a.a.fromXmlAndSql(u.fetchXML,u.offlineSqlQuery,u.viewId,null,u.entityLogicalName,C.getState);return p.where(new s.a("eq",new o.a(t,d.PrimaryIdAttribute),new c.a(n))),C.dispatch(Object(S.d)(p.getQueryState())).then(()=>r)}).catch(e=>(Object(f.a)(F,y.xb)&&E&&C.dispatch(Object(b.b)(E,!1)),Promise.reject(e)))}}}},AbXy:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("P6DH"),i=n("Sbn7"),a=n("9i5P"),s=n("16wZ"),o=n("dHD5"),c=n("SAYH"),l=n("5Oca"),u=n("odYE"),d=n("WPtp"),p=n("qshH"),h=n("1kth"),g=n("ZIjf"),m=n("Uv1Y"),b=n("IaGr");let y;class f{constructor(e,t,n,r,i,a,o){const c="ClientApi.XrmControlGrid.constructor";if(r||Object(s.j)(c,"pageId"),n||Object(s.j)(c,"contextToken"),e||Object(s.j)(c,"store"),i||Object(s.j)(c,"gridEntity"),Object(s.a)(a)&&Object(s.j)(c,"isEditable"),y=e,this._applicationContext=t,this._contextToken=n,this._pageId=r,this._gridEntityName=i,this.controlName=o,this._isEditable=a,!this._contextToken.contextTokenType){const e=p.a.getInstance().getEventParameters(this._contextToken);e.push({name:"controlName",value:this.controlName}),e.push({name:"gridEntityName",value:this._gridEntityName}),p.a.getInstance().reportFailure(c,new m.a("context token passed to grids with empty context token type"),null,e)}}get _isEditable(){const e=Object(r.V)(y.getState(),this._pageId,this._gridEntityName,this._contextToken,this.controlName);if(null===e){const e="ClientApi.XrmControlGrid._isEditable_get",t=p.a.getInstance().getEventParameters(this._contextToken);return t.push({name:"controlName",value:this.controlName}),t.push({name:"gridEntityName",value:this._gridEntityName}),b.a.getInstance().eventManager.ReportComponentFailure(e,new m.a("control configuration parameters not found"),null,t),this._isGridEditable}return e}set _isEditable(e){this._isGridEditable=e}get applicationContext(){return g.a.instance.reportUsage("ClientApi.XrmControlGrid.applicationContext_get"),this._applicationContext}set applicationContext(e){g.a.instance.reportUsage("ClientApi.XrmControlGrid.applicationContext_set")}getTotalRecordCount(){const e="ClientApi.XrmControlGrid.getTotalRecordCount";try{g.a.instance.reportCall(e);const t=Object(r.Y)(y.getState(),this._pageId,this._contextToken);if(t){const n=JSON.parse(t),r=n&&n.totalResultCount?n.totalResultCount:0;return g.a.instance.reportSuccess(e),r}return g.a.instance.reportSuccess(e),0}catch(t){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),p.a.getInstance().reportFailure(e,t,null,n),t}}getRows(){const e="ClientApi.XrmControlGrid.getRows";try{g.a.instance.reportCall(e);const t=new i.a(e),n=y.getState(),s=Object(r.H)(n,this.contextToken,{id:this.pageId});if(s)for(let e=0;e<s.length;e++){const n=s[e].identifier.id,r=this._getRowEntityName(s[e],n),i=new a.a(y,this._applicationContext,Object(o.f)(this.contextToken,n,r),this.pageId,r,n),c=s[e].identifier.id.guid;t.add(c,i)}return g.a.instance.reportSuccess(e),t}catch(t){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),p.a.getInstance().reportFailure(e,t,null,n),t}}getSelectedRows(){const e="ClientApi.XrmControlGrid.getSelectedRows";try{g.a.instance.reportCall(e);const t=new i.a(e),n=Object(r.fb)(y.getState(),this.pageId,this.contextToken);if(n){const e=Object(r.Q)(y.getState(),this.pageId,this.contextToken);for(let i=0;i<n.length;i++){let s;if(e)s=e;else{const e=y.getState(),t=Object(r.v)(e,this.pageId,this.contextToken),a=(t&&t.queryKey&&Object(l.q)(e,t.queryKey,null,null,!0)||[]).find(e=>e.identifier&&c.a.equals(e.identifier.id,n[i]));s=this._getRowEntityName(a,n[i])}const u=new a.a(y,this._applicationContext,Object(o.f)(this.contextToken,n[i],s),this.pageId,s,n[i]),d=n[i].guid;t.add(d,u)}}return g.a.instance.reportSuccess(e),t}catch(t){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),p.a.getInstance().reportFailure(e,t,null,n),t}}addOnRecordSelect(e){const t="ClientApi.XrmControlGrid.addOnRecordSelect";if(this._isEditable){e||Object(s.j)(t,"handler");try{g.a.instance.reportCall(t),y.dispatch(Object(h.m)(this.contextToken,this.pageId,e,this.controlName)),g.a.instance.reportSuccess(t)}catch(e){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),p.a.getInstance().reportFailure(t,e,null,n),e}}}removeOnRecordSelect(e){const t="ClientApi.XrmControlGrid.removeOnRecordSelect";if(this._isEditable){e||Object(s.j)(t,"handler");try{g.a.instance.reportCall(t),y.dispatch(Object(h.H)(this.contextToken,this.pageId,e,this.controlName)),g.a.instance.reportSuccess(t)}catch(e){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),p.a.getInstance().reportFailure(t,e,null,n),e}}}runOnRecordSelect(e){const t="ClientApi.XrmControlGrid.runOnRecordSelect";try{g.a.instance.reportCall(t),this._isEditable&&y.dispatch(Object(h.T)(this.contextToken,this.pageId,e,this.controlName)),g.a.instance.reportSuccess(t)}catch(e){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),p.a.getInstance().reportFailure(t,e,null,n),e}}_getRowEntityName(e,t){const n=e&&e.identifier?e.identifier.etn:this._gridEntityName;if("activitypointer"===n){const e="activitytypecode",n=Object(l.j)(y.getState(),new u.a(this._gridEntityName,t),e);if(Object(d.j)(n))return n.value}return n}get pageId(){return this._pageId}get contextToken(){return this._contextToken}}},B9jE:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var r=n("P6DH"),i=n("Utin");var a=n("Uv1Y"),s=n("SAYH"),o=n("eXjw"),c=n("a72m"),l=n("KBcj"),u=n("d0w6"),d=n("dQnL"),p=n("WK+4"),h=n("CngE"),g=n("iZ7K"),m=n("69Qu"),b=n("BzGi"),y=n("BFlg"),f=n("s+OO"),S=n("7k+e");var v=n("LAGg"),C=n("RrRu"),O=n("jRHm"),_=n("uCpV"),I=n("X37l"),j=n("ujVH"),P=n("3/02"),F=n("Lyxw"),T=n("VcAV");function w(e,t,n,w,x,N){return{type:"grid.refresh.async",execute({dispatch:A,getState:k},M){const D=M.TraceManager.getTracer(y.z),R=y.x+".refreshGridAction";try{const B=k(),L=s.a.tryParseOrNull(w);if(L){const V=N||(n?u.a.SUB_GRID:u.a.MAIN_APPLICATION_VIEW);return function(e,t,n,i,d,p,h,g){const b=Object(r.qb)(t,g,n);if(b&&b.initialized===o.a.Initialized&&(Object(m.b)(t)||!Object(T.b)(b.offlineSqlQuery)))return Promise.resolve(g);const y=p||Object(r.F)(t,n,i,d),f=Object(l.f)(t,y,h),S=Object(l.f)(t,y,u.a.MAIN_APPLICATION_VIEW);let v=f&&f[s.a.toString(g)]&&f[s.a.toString(g)].isUserView?u.b.userview:u.b.savedview;S&&S[s.a.toString(g)]&&S[s.a.toString(g)].isUserView&&(v=u.b.userview);return e(Object(c.a)(y,h,v,g)).then(e=>{if(!e)throw new a.a("View retrieval failed");return e})}(A,B,e,t,n,x,V,L).then(a=>{D.info("Refreshing the grid with new view id - {0}"+L);const c=Object(r.T)(B,e,t);A(function(e,t,n,r){return Object(i.b)(e,t,"ViewId",n,r)}(e,n,w,t)),function(e,t,n,i,a,c,u,d,p){let h=function(e,t,n,i,a){return e||Object(r.F)(t,n,i,a)}(n,e,a,c,u);const g=Object(r.qb)(e,i,a);if(g&&g.initialized===o.a.Initialized){const n=Object(l.f)(e,h,d),r=n&&n[s.a.toString(i)]&&n[s.a.toString(i)].isUserView;if(h===y.a&&(h=g.entityLogicalName?g.entityLogicalName:h),!g.title){const e=[];e.push({name:"view.title",value:"View title doesn't contains value"}),e.push({name:"ViewId",value:"ViewId: "+i}),e.push({name:"View",value:E(g)}),e.push({name:"entityTypeName",value:h}),p.EventManager.ReportComponentFailure("RefreshGrid",new Error("Title for recent item is null or empty."),"Analyze event parameters to understand why title is empty.",e)}const a={RecordType:I.a.Grid,EntityTypeName:h,LastAccessed:new Date,ObjectId:i,IsUserView:r,Title:g.title};t(Object(_.b)(a))}}(k(),A,x,a,e,t,n,V,M);Object(F.c)(k(),P.L)&&A(Object(j.b)(e,t)),x&&A(function(e,t,n,r){return Object(i.b)(e,t,"TargetEntityType",n,r)}(e,n,x,t)),A(Object(v.b)(e,t)),A(Object(C.b)(e,t,[])),A(Object(O.b)(e,t,null));const T=[];if(x&&T.push({name:"entityName",value:x}),!Object(r.ib)(B,e,t))return M.EventManager.ReportComponentSuccess(R,T),Promise.resolve();A(function(e,t,n,i,a,o){return{type:"chart.refresh.async",execute({dispatch:c,getState:v},C){const O=y.x+".refreshChartAction",_=v();if(!n)return Promise.resolve();if(!Object(m.b)(_))return Promise.resolve();const I=Object(l.c)(_,n);if(!(a=I&&I.entityLogicalName?I.entityLogicalName:null))return Promise.resolve();if(o===u.a.QUICKFIND_SEARCH&&(c(Object(S.c)(e,t,[])),c(Object(f.c)(e,t,"{}"))),!s.a.equals(i,n)){c(Object(S.c)(e,t,[])),c(Object(f.c)(e,t,"{}"));const n=Object(r.r)(_,e,t,a),i=Object(h.a)(_,n),o=i&&i.PrimaryEntityTypeCode,l=o&&Object(g.m)(_,parseInt(o,10));if(l&&a!==l)return c(Object(d.a)(a,b.a.savedvisualization)).then(n=>{let r=s.a.toString(n);return r||(r=s.a.EMPTYGUIDSTRING),c(Object(p.b)(e,t,r)).then(()=>{C.EventManager.ReportComponentSuccess(O)})})}return C.EventManager.ReportComponentSuccess(O),Promise.resolve()}}}(e,t,L,c,x,N)).then(()=>(A(Object(v.b)(e,t)),M.EventManager.ReportComponentSuccess(R,T),Promise.resolve())).catch(e=>(M.EventManager.ReportComponentFailure(R,Error(e)),Promise.resolve()))})}if(Object(r.v)(k(),e,t)){D.info("Refreshing the grid."),A(Object(v.b)(e,t)),A(Object(C.b)(e,t,[])),A(Object(O.b)(e,t,null));const n=[];x&&n.push({name:"entityName",value:x}),M.EventManager.ReportComponentSuccess(R,n)}return Promise.resolve()}catch(e){let t="Refresh action for grid failed";e&&e.message&&(t+="with the error message as : "+e.message),M.EventManager.ReportComponentFailure(R,Error(t))}}}}function E(e){if(!e)return"View is "+e;const t={initialized:e.initialized,viewId:e.viewId,entityLogicalName:e.entityLogicalName,queryApi:e.queryApi,columnXML:e.columnXML,idColumName:e.idColumName,queryType:e.queryType,layoutXML:e.layoutXML,isUserView:e.isUserView,versionNumber:e.versionNumber,OverallVersionNumber:e.OverallVersionNumber,OverallUserVersionNumber:e.OverallUserVersionNumber};return JSON.stringify(t)}},BkgE:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l}));var r=n("FZDd"),i=n("iZ7K"),a=n("BFlg"),s=n("F7qm"),o=n("LbMF");function c(e){return{type:"grid.retrieveRelatedEntityMetadata.async",execute({dispatch:t,getState:n},a){try{const s=Object(i.h)(n(),e),o={};return u(o,e),Object.keys(s.ManyToManyRelationships).forEach(t=>{const n=s.ManyToManyRelationships[t];if(n.IsValidForAdvancedFind){let t=n.Entity1LogicalName;t===e&&(t=n.Entity2LogicalName),u(o,t)}}),Object.keys(s.OneToManyRelationships).forEach(e=>{const t=s.OneToManyRelationships[e];t.IsValidForAdvancedFind&&u(o,t.ReferencingEntity,t.ReferencingAttribute)}),Object.keys(s.ManyToOneRelationships).forEach(e=>{const t=s.ManyToOneRelationships[e];t.IsValidForAdvancedFind&&(u(o,t.ReferencedEntity),u(o,t.ReferencingEntity,t.ReferencingAttribute))}),t(Object(r.e)(o)).catch(t=>h(e,a,t,"retrieveRelatedEntityMetadata.async","retrieveRelatedEntityMetadata"))}catch(t){return h(e,a,t,"retrieveRelatedEntityMetadata.async","retrieveRelatedEntityMetadata")}}}}function l(e){return{type:"grid.retrieveRelatedEntityRelationshipMetadata.async",execute({getState:t},n){try{let n=[];const r=t(),a=Object(i.h)(r,e),c=[];Object.keys(a.OneToManyRelationships).forEach(e=>{var t,n;const l=a.OneToManyRelationships[e];if(l.IsValidForAdvancedFind){const e=l.ReferencingEntity,a=Object(i.h)(r,e),u=Object(o.a)(r,e,l.ReferencingAttribute);if(a){const e=d(a,1===l.AssociatedMenuConfiguration.Behavior?null!==(t=l.AssociatedMenuConfiguration.Label)&&void 0!==t?t:"":null!==(n=null==u?void 0:u.DisplayName)&&void 0!==n?n:a.DisplayCollectionName),r=p(l,a.DisplayCollectionName,s.RelationshipType.OneToMany);c.push([e,r])}}}),Object.keys(a.ManyToManyRelationships).forEach(e=>{var t,n;const o=a.ManyToManyRelationships[e];if(o.IsValidForAdvancedFind){let e,l,u=!0,p=o.Entity1LogicalName,h=!0;if(p===a.EntityLogicalName?(p=o.Entity2LogicalName,o.IsCustomRelationship&&(u=2!==o.Entity2AssociatedMenuConfiguration.Behavior),l=o.Entity2AssociatedMenuConfiguration.Behavior,e=null!==(t=o.Entity2AssociatedMenuConfiguration.Label)&&void 0!==t?t:"",h=!1):(o.IsCustomRelationship&&(u=2!==o.Entity1AssociatedMenuConfiguration.Behavior),l=o.Entity1AssociatedMenuConfiguration.Behavior,e=null!==(n=o.Entity1AssociatedMenuConfiguration.Label)&&void 0!==n?n:""),u){const t=Object(i.h)(r,p);if(t){const n=d(t,1===l?e:t.DisplayCollectionName);let r;r=h?{displayName:t.DisplayCollectionName,referencedFieldName:a.PrimaryIdAttribute,referencingFieldName:t.PrimaryIdAttribute,relationshipType:s.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:o.IntersectEntityName,entityIntersectIdAttribute:o.Entity2IntersectAttribute,relatedEntityIntersectIdAttribute:o.Entity1IntersectAttribute}:{displayName:t.DisplayCollectionName,referencedFieldName:a.PrimaryIdAttribute,referencingFieldName:t.PrimaryIdAttribute,relationshipType:s.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:o.IntersectEntityName,entityIntersectIdAttribute:o.Entity1IntersectAttribute,relatedEntityIntersectIdAttribute:o.Entity2IntersectAttribute},c.push([n,r])}}if(o.Entity1LogicalName===o.Entity2LogicalName){const e=Object(i.h)(r,o.Entity2LogicalName);if(2!==o.Entity1AssociatedMenuConfiguration.Behavior){const t=d(e,1===o.Entity1AssociatedMenuConfiguration.Behavior?o.Entity1AssociatedMenuConfiguration.Label:e.DisplayCollectionName),n={displayName:e.DisplayCollectionName,referencedFieldName:a.PrimaryIdAttribute,referencingFieldName:e.PrimaryIdAttribute,relationshipType:s.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:o.IntersectEntityName,entityIntersectIdAttribute:o.Entity2IntersectAttribute,relatedEntityIntersectIdAttribute:o.Entity1IntersectAttribute};c.push([t,n])}}}}),Object.keys(a.ManyToOneRelationships).forEach(e=>{var t,n;const l=a.ManyToOneRelationships[e];if(l.IsValidForAdvancedFind){const e=l.ReferencedEntity,u=l.ReferencingAttribute,h=Object(i.h)(r,e),g=Object(o.a)(r,a.EntityLogicalName,u);if(h){const e=p(l,1===l.AssociatedMenuConfiguration.Behavior?null!==(t=l.AssociatedMenuConfiguration.Label)&&void 0!==t?t:"":null!==(n=null==g?void 0:g.DisplayName)&&void 0!==n?n:h.DisplayCollectionName,s.RelationshipType.ManyToOne);c.push([d(h,h.DisplayCollectionName),e])}}});return n=c.sort((e,t)=>{var n,r,i,a;if(!(null===(n=e[1])||void 0===n?void 0:n.displayName)||!(null===(r=t[1])||void 0===r?void 0:r.displayName))return 0;const s=e[1].displayName.localeCompare(t[1].displayName);return 0===s?(null===(i=e[0])||void 0===i?void 0:i.displayName)&&(null===(a=t[0])||void 0===a?void 0:a.displayName)?e[0].displayName.localeCompare(t[0].displayName):0:s}),Promise.resolve(n)}catch(t){return h(e,n,t,"retrieveRelatedEntityRelationshipMetadata.async","retrieveRelationshipMetadata")}}}}function u(e,t,n){e[t]||(e[t]=[]),n&&-1===e[t].indexOf(n)&&e[t].push(n)}function d(e,t){var n;return{metadataId:null===(n=e.Id)||void 0===n?void 0:n.guid,displayName:t,primaryIdField:e.PrimaryIdAttribute,primaryNameField:e.PrimaryNameAttribute,name:e.EntityLogicalName}}function p(e,t,n){return{displayName:t,referencingFieldName:e.ReferencingAttribute,isHierarchical:e.IsHierarchical,relationshipType:n,referencedFieldName:e.ReferencedAttribute}}function h(e,t,n,r,i){const s=[{name:a.k,value:e}];return t.EventManager.ReportComponentFailure(Object(a.G)(r,i),n,null,s),Promise.resolve(null)}},COKI:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var r=n("i1f0"),i=n("pF61"),a=n("Sbn7"),s=n("ScMg"),o=n("ldWj"),c=n("TYIz"),l=n("16wZ"),u=n("1kth"),d=n("mhYf"),p=n("PbI6"),h=n("FHmp"),g=n("qshH"),m=n("ZIjf"),b=n("ABCl");let y;class f extends s.a{constructor(e,t,n,r,i,a){Object(l.g)(i,"ClientApi.XrmTab.constructor","parent"),Object(l.g)(e,"ClientApi.XrmTab.constructor","store"),super(e,t,r,n),y=e,this._parent=i,this._formContext=a,this._iConnectedTabProps={tabName:this.name,tabId:this._getTabId(),id:this.pageId,showTab:!0},this._clientApiExecutor=new b.b(y,"ClientApi.XrmTab.",t)}get sections(){const e="ClientApi.XrmTab.sections";try{if(m.a.instance.reportCall(e),!this._sections){this._sections=new a.a(e);const t=y.getState(),n=Object(r.Gc)(t,this.pageId,this.name,this.contextToken);for(let e=0;e<n.Columns.length;e++){const i=Object(r.p)(t,{id:this.pageId,tabName:n.Id,columnIndex:e},this.contextToken);let a=null;for(let e=0;e<i.SectionNames.length;e++)a=new o.a(y,this.contextToken,this.pageId,i.SectionNames[e],this,this._formContext),this._sections.add(a.getName(),a)}}return m.a.instance.reportSuccess(e),this._sections}catch(t){const n=g.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(e,t,null,n),t}}addTabStateChange(e){const t="ClientApi.XrmTab.addTabStateChange";Object(l.g)(e,t,"handler");try{m.a.instance.reportCall(t),y.dispatch(Object(u.s)(this.contextToken,this.pageId,this.name,e)),m.a.instance.reportSuccess(t)}catch(e){const n=g.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(t,e,null,n),e}}removeTabStateChange(e){const t="ClientApi.XrmTab.removeTabStateChange";Object(l.g)(e,t,"handler");try{m.a.instance.reportCall(t),y.dispatch(Object(u.N)(this.contextToken,this.pageId,this.name,e)),m.a.instance.reportSuccess(t)}catch(e){const n=g.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(t,e,null,n),e}}getDisplayState(){const e="ClientApi.XrmTab.getDisplayState";try{m.a.instance.reportCall(e);const t=Object(r.Dc)(y.getState(),this._getTabId(),this.pageId,this.contextToken)?"collapsed":"expanded";return m.a.instance.reportSuccess(e),t}catch(t){const n=g.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(e,t,null,n),t}}getParent(){return m.a.instance.reportUsage("ClientApi.XrmTab.getParent"),this._parent}setDisplayState(e){const t="ClientApi.XrmTab.setDisplayState";try{m.a.instance.reportCall(t);let n=!1;switch(e){case"collapsed":n=!0;break;case"expanded":n=!1;break;default:Object(l.h)(t,"TabDisplayState",e)}n||y.dispatch(Object(c.b)(this.pageId,this._getTabId(),this.contextToken)),m.a.instance.reportSuccess(t)}catch(e){const n=g.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(t,e,null,n),e}}setFocus(){try{m.a.instance.reportCall("ClientApi.XrmTab.setFocus"),y.dispatch(Object(c.b)(this.pageId,this._getTabId(),this.contextToken)),m.a.instance.reportSuccess("ClientApi.XrmTab.setFocus")}catch(e){const t=g.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure("ClientApi.XrmTab.setFocus",e,null,t),e}}setVisible(e){const t="ClientApi.XrmTab.setVisible";try{m.a.instance.reportCall(t),y.dispatch(Object(d.b)(this.pageId,this._getTabId(),this.contextToken,!0===e)),m.a.instance.reportSuccess(t)}catch(e){const n=g.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(t,e,null,n),e}}getLabel(){try{m.a.instance.reportCall("ClientApi.XrmTab.getLabel");const e=Object(r.Hc)(y.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken)||"";return m.a.instance.reportSuccess("ClientApi.XrmTab.getLabel"),e}catch(e){const t=g.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure("ClientApi.XrmTab.getLabel",e,null,t),e}}getVisible(){const e="ClientApi.XrmTab.getVisible";try{m.a.instance.reportCall(e);const t=Object(r.Kc)(y.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken);return m.a.instance.reportSuccess(e),t}catch(t){const n=g.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(e,t,null,n),t}}setLabel(e){const t="ClientApi.XrmTab.setLabel";Object(l.g)(e,t,"label");try{m.a.instance.reportCall(t),y.dispatch(Object(h.b)(this.pageId,this.contextToken,this._getTabId(),e)),m.a.instance.reportSuccess(t)}catch(e){const n=g.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(t,e,null,n),e}}_getTabId(){const e=y.getState(),t=Object(r.Gc)(e,this.pageId,this.name,this.contextToken);if(t&&t.Id)return t.Id}setContentType(e){return this._clientApiExecutor.execute("setContentType",()=>{let t;switch(e){case"default":case"cardSections":t="cardSections";break;case"expandAvailableSpace":case"singleComponent":t="singleComponent";break;default:Object(l.h)("setContentType","TabContentType",e)}y.dispatch(Object(p.b)(this.pageId,this._getTabId(),this.contextToken,t))},[{name:"tabContentType",value:e,isRequired:!0,expectedDataType:"string"}])}getContentType(){return this._clientApiExecutor.execute("getContentType",()=>{var e;return null===(e=Object(r.Jc)(y.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken))||void 0===e?void 0:e.contentType})}}var S=n("SAYH"),v=n("rQHy"),C=n("jRy5"),O=n("y60j"),_=n("arV0"),I=n("3yqi"),j=n("0nOn"),P=n("zmL5"),F=n("jq7Z"),T=n("IaGr");let w;class E{constructor(e,t,n,r,i,a,s){const o=Object(_.l)(e.getState(),n),c=[{name:"store",value:e,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"pageId",value:n,isRequired:!0,isEventParam:!0},{name:"pageType",value:o,isEventParam:!0},{name:"formContext",value:r,isRequired:!0},{name:"entityName",value:i,isEventParam:!0},{name:"formSelectorType",value:s,isRequired:!0}];this._clientApiExecutor=new j.a(e,"ClientApi.XrmFormUIBase.",n,t,c),this._pageId=n,w=e,this._formContext=r,this._entityName=i,this._contextToken=t,this._formSelectorType=s,this.xrmControlFactory=a}get controls(){return this._clientApiExecutor.execute("controls_get",(e,t)=>{if(!this._controls){this._controls=new a.a(e);const n=function(e,t,n){const i=Object(F.b)(w.getState(),e,t),a=Object(P.b)(w.getState(),e),s=S.a.equals(i,a),o=Object(_.l)(w.getState(),e)===I.a.Dialog,c=Object(O.y)(w.getState(),i),l=c&&c.reduce((e,t)=>(e.add(t),e),new Set);return(i,a)=>{const c=Object(r.s)(w.getState(),{controlName:i,id:e},t),u=Object(r.Rc)(w.getState(),e,c);s&&u&&!o?l&&l.has(c.DataFieldName)&&Object(r.fd)(w.getState(),e,c,t)&&n.add(i,a):n.add(i,a)}}(this.pageId,this.contextToken,this._controls),i=this.getFormDescriptor(e,t);if(i){const r={isEventParam:!0,name:"controlName",value:""},a={isEventParam:!0,name:"controlType",value:""};t.push(r),t.push(a);for(const s in i.Controls){const o=i.Controls[s];r.value=s,a.value=o&&o.ClassId?o.ClassId.guid:"";const c=this.xrmControlFactory.createXrmControl(this.contextToken,o,this._formContext,e,t);c&&n(c.getName(),c)}}}return this._controls})}get formSelector(){return this._clientApiExecutor.execute("formSelector_get",(e,t)=>{if(!this._formSelector){const n=this.getFormDescriptor(e,t);n&&(this._formSelector=new this._formSelectorType(w,this._contextToken,n.Id,this._entityName,this._pageId))}return this._formSelector})}get tabs(){return this._clientApiExecutor.execute("tabs_get",(e,t)=>{if(!this._tabs){this._tabs=new a.a(e);const n=this.getFormDescriptor(e,t);if(n){const e=n.Tabs;for(const t in e){const n=new f(w,this._contextToken,e[t].Name,this._pageId,this,this._formContext);this._tabs.add(n.getName(),n)}}}return this._tabs})}get pageId(){return this._pageId}refreshRibbon(e=!1){this._clientApiExecutor.executeAsync("refreshRibbon",()=>w.dispatch(Object(v.a)(this._pageId,null,e)))}get contextToken(){return this._contextToken}get formContext(){return this._clientApiExecutor.execute("formContext",()=>this._formContext)}getControls(){if(!this._controls&&this.contextToken.contextTokenType===C.a.GridRow){const e=this._clientApiExecutor.getComponentName("getControls");return this._controls=new a.a(e),this._controls}return this.controls}getFormDescriptor(e,t){const n=Object(r.fb)(w.getState(),{id:this._pageId},this._contextToken);if(!n){const n="Form descriptor not found";if(Object(i.n)(w.getState(),this._pageId))T.a.getInstance().traceManager.getTracer(e).error(n+": Page is dead",t);else if(this.contextToken.contextTokenType===C.a.GridRow)T.a.getInstance().traceManager.getTracer(e).error(n,t);else{if(!this._clientApiExecutor.isPageReadyForClientAPIAccess())return null;const r=new Error(n);this._clientApiExecutor.reportFailure(e,r,t)}}return n}}},"CV4+":function(e,t,n){"use strict";n.d(t,"a",(function(){return z}));var r=n("nuS9"),i=n("4fxQ"),a=n("2YQW"),s=n("u+q+"),o=n("YxC/"),c=n("S1lN"),l=n("evW+"),u=n("XIN1"),d=n("znb3"),p=n("unFF"),h=n("ZGH+"),g=n("tJ+6");var m=n("1AYO"),b=n("YWpA"),y=n("DOFJ"),f=n("FhVi"),S=n("Gilj"),v=n("3rse"),C=n("H+1e"),O=n("Afz2"),_=n("WZ96"),I=n("4leG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const j="headerFieldsFlyout";class P extends r.Component{constructor(e){super(e),this._onCellsDidMount=this._onCellsDidMount.bind(this),this._handleCloseFlyout=this._handleCloseFlyout.bind(this),this._handleOutsideClick=this._handleOutsideClick.bind(this),this.state={isCellRendered:!1}}_handleOutsideClick(e){setTimeout(()=>{this.props.handleOutsideClick(e),this.setState({isCellRendered:!1})},0)}_handleCloseFlyout(){this.props.closeFlyout(!0),this.setState({isCellRendered:!1})}_shortcutHandler(e){if(e.EVENT.keyCode===v.a.Escape){const t=e.EVENT.target.closest("#__flyoutRootNode");t&&t.childNodes.length<=1&&this._handleCloseFlyout()}}_createKeyboardShortcuts(){const e=Object(o.c)(this.props.resourceStrings,c.a),t=Object(o.c)(this.props.resourceStrings,c.b),n=this._shortcutHandler.bind(this),r=[],i=new S.a([v.a.Escape],n,!0,e,t);return r.push(i),r}_onCellsDidMount(){this.props.headerFields&&this.props.isFlyoutOpened&&this.setState({isCellRendered:!0})}_renderHeaderFields(e){const t=this.props.headerFields&&this.props.headerFields.map(t=>r.createElement(y.a,{key:t.Id,id:this.props.id,previewId:t.PreviewId,controlName:t.Name,ref:t.Id,cellSizeMode:0,shouldNotifyRenderComplete:!0,onRenderComplete:this._onCellsDidMount,style:this.props.cellStyle,scope:C.a.EditForm,parentFlyoutRoot:e}));return this.props.showControlsInContainer?r.createElement(b.a,null,t):t}render(){if(this.props.isFlyoutOpened){const e=r.createElement(m.a,{key:j,id:j,flyoutDirection:m.b.downleft,relativeToElementId:this.props.relativeElementId,positionType:"relative",flyoutStyle:this.props.flyoutStyle,onOutsideClick:this._handleOutsideClick,testhooks:{id:j,[_.b]:`${this.props.headerPreviewId}-${_.d}-${j}`,[_.c]:20..toString()},parentFlyoutRoot:"__flyoutRootNode"},this._renderHeaderFields("__flyoutRootNode")),t=this.state.isCellRendered?r.createElement(f.a,{key:"headerFieldsFlyoutAccessibility",rootElementId:j,overrideFocusId:j,shouldManageFocus:!this.props.isPreviewMode,waitForEditable:!1,keyboardShortcuts:this._createKeyboardShortcuts(),isModal:!0}):null;return r.createElement(b.a,{key:"headerFieldsFlyoutContainer",id:"headerFieldsFlyoutContainer",tabIndex:0,role:O.e},e,t)}return null}}P.displayName="HeaderFields";const F=Object(s.a)((function(){const e=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e=null,t=null,n=null,r=null;return function(i,a){var s;const o=Object(p.a)(i),c=Object(g.c)(i),l=Object(g.a)(i),u=null==l?void 0:l.Colors;return t===o&&n===c&&r===u||(t=o,n=c,r=u,e={flyoutStyle:{borderColor:"#ffffff",borderWidth:"1px",borderStyle:"solid",borderTopWidth:0,padding:o.sizes.Measures.Measure100,width:"30rem",height:"auto",maxHeight:"23.75rem",boxShadow:o.shadows.Shadow01,backgroundColor:c?null===(s=null==u?void 0:u.Palette)||void 0===s?void 0:s.Primary01:o.colors.BaseColor.White,flexDirection:"column",overflowY:"auto"},cellStyle:{width:"100%",minHeight:Object(h.a)(o.sizes.Section.cellHeightInRem)}}),e}}(),t=Object(o.h)();return function(n,r){const i=e(n,r),a=t(n,c.e),s=Object(I.d)(n);return{flyoutStyle:i.flyoutStyle,cellStyle:i.cellStyle,resourceStrings:a,isPreviewMode:s}}}))(P);var T=n("dHD5"),w=n("ynyB"),E=n("eu2O"),x=n("IqkD"),N=n("H4dV");var A=n("PidC"),k=n("H/hG"),M=n("i1f0"),D=n("3/02"),R=n("QBtP"),B=n("eL7I"),L=n("zmL5");class V extends r.Component{constructor(e){super(e),this._previousHeaderCollaped=!1,this._onExpandButtonClick=this._onExpandButtonClick.bind(this),this._flyoutOutsideClickHandler=this._flyoutOutsideClickHandler.bind(this),this._moveFocusToExpandButton=this._moveFocusToExpandButton.bind(this),this._toggleFlyout=this._toggleFlyout.bind(this),this.state={isFlyoutOpened:!1}}_toggleFlyout(e){const t=e||this.state.isFlyoutOpened;if(this.setState({isFlyoutOpened:!t},()=>{this.state.isFlyoutOpened||this._moveFocusToExpandButton()}),!this.state.isFlyoutOpened){const e=[{name:"formId",value:this.props.formId}];this.context.EventManager.ReportComponentSuccess("Forms.HeaderFieldsChevron.buttonClicked",e)}}_moveFocusToExpandButton(){const e=i.findDOMNode(this.refs[B.b]);e&&e.focus()}_flyoutOutsideClickHandler(e){if(e&&e.target){const t=e.target.id;t===B.b||"expandIcon"===t||this.props.headerPreviewId||this._toggleFlyout(!0)}}_onExpandButtonClick(e){this._toggleFlyout()}_shortcutHandler(e){e.EVENT.keyCode===v.a.Escape&&this.state.isFlyoutOpened&&this._toggleFlyout()}_createKeyboardShortcuts(){const e=Object(o.c)(this.props.resourceStrings,c.a),t=Object(o.c)(this.props.resourceStrings,c.b),n=this._shortcutHandler.bind(this),r=[],i=new S.a([v.a.Escape],n,!0,e,t);return r.push(i),r}_renderExpandButton(){const e=this.props.isChevronVisible,t=Object(o.c)(this.props.resourceStrings,c.c),n=Object.assign(Object.assign(Object.assign({},this.props.styles.expandButtonStyle),{opacity:e?1:0,pointerEvents:e?void 0:"none"}),this.props.customStyle),i=r.createElement(l.a,{key:B.b,id:B.b,accessibilityLabel:t,title:this.props.hasInvalidControls?Object(o.c)(this.props.resourceStrings,c.d):t,onClick:this._onExpandButtonClick,style:this.props.enabledFormFCBs.has(D.mb)?this.props.styles.errorIconAndChevronInnerContainerStyle:n,accessibilityExpanded:this.state.isFlyoutOpened,accessibilityHasPopup:!0,describedByElementId:this.props.hasInvalidControls?"headerFieldsChevronError":void 0,ref:B.b,testhooks:{id:"header_overflowButton",[_.b]:`${this.props.headerPreviewId}-${_.d}-header_overflowButton`,[_.c]:20},disabled:!e||void 0,accessibilityHidden:!e||void 0,tabIndex:e?void 0:-1},this._renderErrorIcon(),this._renderExpandIcon(n));return this.props.enabledFormFCBs.has(D.mb)?e?r.createElement(b.a,{style:this.props.styles.errorIconAndChevronOuterContainerStyle},i):null:i}_renderErrorIcon(){return this.props.enabledFormFCBs.has(D.mb)&&this.props.hasInvalidControls?r.createElement(u.b,{type:d.a.MarkAsLost,style:this.props.styles.errorIconStyle}):null}_renderExpandIcon(e){return r.createElement(u.b,{id:"expandIcon",style:this.props.enabledFormFCBs.has(D.mb)?e:this.props.styles.expandButtonIconStyle,type:this.state.isFlyoutOpened?d.a.ChevronUp:d.a.ChevronDown})}_renderHeaderFieldsFlyout(){if(this.props.isChevronVisible){const e=this.props.headerCollapsed===this._previousHeaderCollaped&&this.state.isFlyoutOpened;return r.createElement(F,{key:"headerFieldsFlyout",id:this.props.id,relativeElementId:B.b,isFlyoutOpened:e,handleOutsideClick:this._flyoutOutsideClickHandler,closeFlyout:this._toggleFlyout,headerFields:this.props.headerFields,showControlsInContainer:this.props.enabledFormFCBs.has(D.mb),headerPreviewId:this.props.headerPreviewId})}return null}_renderErrorString(){const e=Object(o.c)(this.props.resourceStrings,c.d);return r.createElement(k.a,{id:"headerFieldsChevronError",hidden:!0,role:O.a},e)}render(){return r.createElement(r.Fragment,null,this.props.hasInvalidControls?this._renderErrorString():null,this._renderExpandButton(),this._renderHeaderFieldsFlyout(),r.createElement(f.a,{key:"headerFieldsChevronAccessibility",rootElementId:"headerFieldsChevron",shouldManageFocus:!1,keyboardShortcuts:this._createKeyboardShortcuts()}))}componentWillReceiveProps(e){e.headerCollapsed!==this._previousHeaderCollaped&&this.state.isFlyoutOpened&&this._toggleFlyout(!0)}componentDidUpdate(){this._previousHeaderCollaped=this.props.headerCollapsed}}V.displayName="HeaderFieldsChevron",V.contextType=R.a;const z=Object(s.a)((function(){const e=Object(o.h)(),t=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e=null,t=null,n=!1,r=!1,i=!1,a=!1;return function(s,o,c,l){const u=Object(p.a)(s),d=Object(x.g)(s),h=o.headerCollapsed;return t===u&&n===h&&r===c&&i===d&&a===l||(t=u,n=h,r=c,i=d,a=l,e={expandButtonStyle:{cursor:"pointer",borderWidth:0,padding:0,height:u.sizes.Measures.Measure300,width:u.sizes.Measures.Measure300,marginTop:u.sizes.HeaderFields.ExpandButtonMarginTop,transition:w.b,transform:h?`translateY(-${u.sizes.Measures.Measure175})`:"none",backgroundColor:"transparent",":hover":{backgroundColor:u.colors.BaseColor.Grey.Grey3}},expandButtonIconStyle:{margin:"0 auto",transform:N.a.getInstance().get_IsBrowserEdge()||N.a.getInstance().get_IsBrowserIE()?`translateY(${u.sizes.Measures.Measure100})`:void 0},errorIconStyle:{color:E.f,height:"16px",width:"16px",fontSize:"16px",lineHeight:"16px",marginLeft:"8px",marginRight:"8px"},errorIconAndChevronOuterContainerStyle:{display:"flex",alignItems:l?void 0:"center",marginLeft:d?void 0:l?"auto":"18px",marginRight:d?l?"auto":"18px":void 0,flexShrink:N.a.getInstance().get_IsBrowserIE()?0:void 0},errorIconAndChevronInnerContainerStyle:{borderWidth:0,padding:0,display:"flex",height:"32px",alignItems:"center",backgroundColor:c?E.b:"transparent",":hover":{backgroundColor:u.colors.BaseColor.Grey.Grey3}}}),e}}(),n=Object(M.cd)();let r=null;return function(i,s){const o=Object(T.j)(i,s.id);Object(a.e)(r,o)||(r=o);const l=e(i,c.e),u=Object(A.d)(i,s.id,s.headerFields,r),d=t(i,s,u,s.justifyEnd),p=n(i,s,r),h=Object(A.e)(i,s,o),g=Object(L.b)(i,s.id)?Object(L.b)(i,s.id).guid:"";return{resourceStrings:l,styles:d,contextToken:r,enabledFormFCBs:p,hasInvalidControls:u,headerPreviewId:h,formId:g}}}))(V)},CbNq:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return c}));var r=n("P6DH");function i(e){const t=Object(r.m)(e),n=e&&e.metadata?e.metadata.entities:null,i=[];return n?(t.forEach(e=>{if(4200!==n[e].ObjectTypeCode){const t=function(e){const t=e.DisplayName,n=e.ObjectTypeCode.toString();return{entityDisplayName:t,objectTypeCode:n}}(n[e]);i.push(t)}}),i.sort(a)):i}function a(e,t){const n=e.entityDisplayName,r=t.entityDisplayName;let i=0;return n>r?i=1:n<r&&(i=-1),i}function s(e){const t=[];for(let n=0;n<e.length;n++){const r={key:e[n].objectTypeCode,text:e[n].entityDisplayName};t.push(r)}return t}function o(e){return e?e.split(","):[]}function c(e){return e?e.map(e=>({key:e.value,text:e.text})):[]}},Co7m:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var r=n("TAjd"),i=n("SAYH"),a=n("504W"),s=n("WPtp"),o=n("CPoS"),c=n("5Oca"),l=n("+nNZ"),u=n("odYE"),d=n("0PSL"),p=n("23K5"),h=n("bJaF"),g=n("KGWS"),m=n("ccIw"),b=n("arV0"),y=n("rodW"),f=n("eXjw"),S=n("k1f1"),v=n("AFlp"),C=n("c7jw"),O=n("53SR"),_=n("PUjk"),I=n("i1f0"),j=n("7LBy"),P=n("2Ct/"),F=n("iZ7K"),T=n("D4Jo"),w=n("JF0K");class E{static get Instance(){return E._instance||(E._instance=new E,Object(_.c)(E._instance)),E._instance}init(e,t,r){return this._getState&&this._businessProcessPerPageWrapper?Promise.resolve():(this._applicationContext=e,this._reloadDataCount=0,this._getState=t,this._dispatch=r,this._processManager=new h.a(e,t,r,new m.a,new g.a),this._businessProcessFlowWrapperIdentifierFactory=new p.a,this._businessProcessFlowWrapperFactory=new d.a(t,this._businessProcessFlowWrapperIdentifierFactory,e),n.e(48).then(n.bind(null,"esKF")).then(({BusinessProcessPageWrapper:e})=>(this._businessProcessPerPageWrapper=new e(this._applicationContext,this._getState,this._dispatch),Promise.resolve())))}getBusinessProcessFlowWrapper(e,t){return Object(P.f)(this._getState())?this._businessProcessPerPageWrapper.getBusinessProcessFlowWrapper(e,t):(this._reloadDataIfRequired(e,t),this._businessProcessFlowWrapperFactory.generate(e,this._processManager))}getProcessManager(e,t){return Object(P.f)(this._getState())?this._businessProcessPerPageWrapper.getProcessManager(e,t):(this._reloadDataIfRequired(e,t),this._processManager)}getCurrentProcessManagerWithoutInit(e){if(!Object(P.f)(this._getState()))return this._processManager;if(this._businessProcessPerPageWrapper)return this._businessProcessPerPageWrapper.getCurrentProcessManagerWithoutInit(e);const t=Object(b.g)(this._getState(),e),n=t&&t.entityTypeName?new u.a(t.entityTypeName,t.id):null,r=this._applicationContext.TraceManager.getTracer("BusinessProcessWrapperManager.GetProcessManagerWithoutinit"),i=Object(T.a)(this._getState(),n,e,this._applicationContext);return r.warn("BusinessProcessWrapperManager: BusinessProcessPerPageWrapper is not initialized",i),null}hasChanged(e,t,n,r){if(!Object(P.f)(this._getState())){if(Object(P.g)(e)&&(!Object(P.d)(e)||Object(P.c)(e,r)))return!0;if(!t)return!1;const i=new u.a(t.entityTypeName,t.id),s=Object(l.f)(e,i);return!Object(a.a)(s)&&(!n||s>n.instanceModifiedTimestamp)||this._needsDockedModeRefresh(n,t)}return this._businessProcessPerPageWrapper.hasChanged(e,t,n,r)}_needsDockedModeRefresh(e,t){return this._processManager.getDisplayState()===r.a.expanded&&e.isFormInactive!==Object(I.Lb)(this._getState(),t.entityTypeName,t.id)}_reloadData(e,t){const n=this._getState();this._pageId=e,this._pageInfo=t;const r=Object(b.g)(n,e);if(!r)return;const d=r.id,p=new u.a(r.entityTypeName,d);if(this._processIdInState=Object(c.e)(n,p),Object(P.g)(n)&&(!Object(P.d)(n)||Object(P.c)(n,e))){const t=this._processManager.getTelemetryParams();return this._processManager.isVisible()&&this._processManager.setVisible(!1),this._processManager.initilaizeWithFormEntityOnly(p,e),void Object(T.c)(w.e,t,this._applicationContext)}const h=Object(j.a)(r),g=Object(j.b)(r);if(i.a.equals(p.id,i.a.EMPTY)&&h&&g){const t=Object(o.b)(n,h),i=new u.a(t.businessProcessFlowUniqueName,g),s=Object(l.b)(n,i);return Object(a.a)(this._lastPageEntityFromCrossEntity)||Object(a.a)(p)||this._lastPageEntityFromCrossEntity.etn===p.etn||this._moveToNextStageForCrossEntityBPF(s,r),void this._processManager.initilaizeWithProcessAndFormEntity(s,t,p,h,i,e)}if(this._processIdInState){const t=Object(o.b)(n,this._processIdInState);if(!Object(a.a)(t)&&Object(f.b)(t.initialized)){const r=new u.a(t.businessProcessFlowUniqueName,Object(c.f)(n,p)),o=Object(l.b)(n,r);if(i.a.equals(p.id,i.a.EMPTY)){const n=Object(P.b)(t);if(this._lastPageIdInNewForm!==e&&(this._lastPageIdInNewForm=e,this._dispatch(Object(O.a)(null,r))),n&&n.stage&&n.stage.stageId){const i=Object(P.a)(n);return this._dispatch(Object(C.b)(r,i)),void this._processManager.initilaizeWithProcessAndFormEntity(i.fields,t,p,this._processIdInState,r,e)}}else if(Object(a.a)(o))return;const d=Object(F.h)(n,p.etn);if(d&&d.IsBPFEntity)return void this._processManager.initilaizeWithProcessAndFormEntity(o,t,p,this._processIdInState,r,e);for(const n in o)if(Object(s.k)(o[n])&&o[n].reference&&o[n].reference.id&&o[n].reference.etn===p.etn&&(i.a.equals(o[n].reference.id,p.id)||i.a.equals(o[n].reference.id,i.a.EMPTY))&&Object(P.e)(n))return void this._processManager.initilaizeWithProcessAndFormEntity(o,t,p,this._processIdInState,r,e);const h=this._dispatch(Object(S.b)(i.a.EMPTY,p)),g=this._dispatch(Object(v.b)(i.a.EMPTY,p));Promise.all([h,g]).then(t=>{this._processManager.initilaizeWithFormEntityOnly(p,e)})}else this._processManager.initilaizeWithFormEntityOnly(p,e)}else this._processManager.initilaizeWithFormEntityOnly(p,e)}_reloadDataIfRequired(e,t){const n=this._getState(),r=this._processManager.getCurrentFormEntity();this._lastPageEntityFromCrossEntity=r;let a=null,s=!1;if(r&&(a=Object(c.b)(r)(n,r.etn),a&&(s=a.refreshGlobalNavigationData)),!Object(P.g)(n)&&(!this._pageInfo||!i.a.equals(this._pageInfo.id,t.id)||this._pageId!==e||this._hasProcessChanged(t)||s)||Object(P.g)(n)&&this._processManager.getProcessId()){if(a&&a.refreshGlobalNavigationData&&this._dispatch(Object(y.b)(!1,r)),this._reloadDataCount<30)this._reloadData(e,t);else if(this._pageId!==e&&(this._reloadDataCount=0),30===this._reloadDataCount){const e=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ReachMaxBpfReloadDataCount"),t=this._processManager.getTelemetryParams();e.error("Max BPF reloadData count reached limit of 30. Root cause may be infinite loop when rendering the ProcessControl.",t)}this._reloadDataCount++}else this._reloadDataCount=0}_hasProcessChanged(e){const t=this._processIdInState||i.a.EMPTY,n=this._getState(),r=new u.a(e.entityTypeName,e.id),a=Object(b.g)(n,this._pageId),s=Object(j.a)(a),l=i.a.equals(r.id,i.a.EMPTY)&&s?s:Object(c.e)(n,r)||i.a.EMPTY;if(!i.a.equals(l,t))return!0;if(i.a.equals(l,i.a.EMPTY))return!1;const d=Object(o.b)(n,l);return!!d&&this._processManager.getVersion()<d.businessProcessFlowProcessVersion}_moveToNextStageForCrossEntityBPF(e,t){const n=e.activestageid,r=e.traversedpath;let a=t.data.nextStageId;if(!a){const e=Object(j.a)(t),n=Object(j.b)(t);if(!i.a.equals(e,this._processManager.getProcessId())||!i.a.equals(n,this._processManager.getProcessInstanceId()))return;a=this._processManager.getStageMetadata().getNextStageId(this._processManager.getActiveStageId())}if(!i.a.equals(n.reference.id,new i.a(a))){n.reference=new u.a("processstage",new i.a(a)),r.value=r.value+","+a;e.activestagestartedon.value=new Date}}}},D4Jo:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return g}));var r=n("VcAV"),i=n("Uv1Y"),a=n("bT7G"),s=n("JF0K"),o=n("SAYH"),c=n("5Oca"),l=n("+nNZ"),u=n("arV0"),d=n("504W");function p(e,t,n,r){const i=[];try{const r=t&&Object(c.e)(e,t)?Object(c.e)(e,t):o.a.EMPTY,a=t&&Object(c.f)(e,t)?Object(c.f)(e,t):o.a.EMPTY,s=r&&!o.a.equals(r,o.a.EMPTY)?function(e,t){const n=Object(l.a)(e,t);if(n)return n.businessProcessFlowProcessState;return null}(e,r):0,d=Object(u.l)(e,n),p={name:"ProcessId",value:r?o.a.toString(r):o.a.EMPTYGUIDSTRING},h={name:"ProcessInstanceId",value:a?o.a.toString(a):o.a.EMPTYGUIDSTRING},g={name:"CurrentFormEntityType",value:t&&t.etn?t.etn:""},m={name:"CurrentFormEntityId",value:t&&t.id?o.a.toString(t.id):""},b={name:"ProcessState",value:s},y={name:"PageId",value:n||""},f={name:"PageType",value:d};i.push(p),i.push(h),i.push(g),i.push(m),i.push(b),i.push(y),i.push(f)}catch(e){r.TraceManager.getTracer("BusinessProcessFlow.TelemetryGeneration").error("Exception while generating businessprocess telemetry parameters: "+e.message,i)}return i}function h(e,t,n){n.EventManager.ReportComponentSuccess(e,t)}function g(e,t,n,o,c,l,u){!function(e,t){if(!Object(r.c)(e)){const n=Object(i.c)(e);if(!Object(r.c)(n)){const e=n.errorCode;if(!Object(r.c)(e)){const n={name:"ErrorCode",value:"0x"+e.toString(16)};t.push(n)}}}}(t,o),function(e,t,n,o){if(!Object(r.c)(e)){const c=Object(i.c)(e);if(!Object(r.c)(c)&&!Object(r.c)(c.FaultedSnapshotId)){const e={name:s.p,value:c.FaultedSnapshotId};if(t.push(e),!Object(r.c)(n)&&!Object(r.c)(o)){const e=Object(a.c)(o,n);if(!Object(r.c)(e)){const n=e.snapshotId;if(!Object(r.c)(n)&&!Object(d.b)(n)&&n===c.FaultedSnapshotId){const e={name:s.q,value:"serverSideCurrentForm"};t.push(e)}}}}}}(t,o,l,u),c.EventManager.ReportComponentFailure(e,t,n,o)}},DAWX:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{get_ErrorType(){return this._errorType}set_ErrorType(e){this._errorType=e}get_ErrorDescription(){return this._errorDescription}set_ErrorDescription(e){this._errorDescription=e}}},DOFJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return q}));var r=n("nuS9"),i=n("223Y"),a=n("u+q+"),s=n("H+1e"),o=n("YWpA"),c=n("unFF"),l=n("ZGH+"),u=n("WZ96"),d=n("dHD5"),p=n("+zjj"),h=n("meVR"),g=n("pgSX"),m=n("si7p"),b=n("EY5k"),y=n("YxC/");var f=n("QBtP"),S=n("whN/"),v=n("BFlg"),C=n("GEBM");class O extends r.Component{constructor(e){super(e),this.onMeasuring=this.onMeasuring.bind(this),this.state={width:0}}onMeasuring(e){e>0&&e!==this.state.width&&this.setState({width:e})}render(){if(!this.props.configuration)return null;const e=this.state.width,t=this.props.rowSpan*this.props.rowHeight,n={minWidth:e.toString()+"px",minHeight:t.toString()+"px"},a={width:e>0?e:-1,height:t>0?t:-1,eventListeners:[{eventname:"navigateToAssociatedGrid",eventhandler:[this._navigateToAssociatedGrid.bind(this)]}]};return r.createElement(o.a,{key:"FormCellChart_"+this.props.id,testhooks:{id:"FormCellChart_"+this.props.id},style:this.props.style,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0},this.state.width>0&&r.createElement(o.a,{key:"FormCellChart_"+this.props.id+"_container",style:n,id:this.props.domId,testhooks:{[u.b]:this.props.previewId,[u.c]:20}},r.createElement(i.c,{key:this.props.key,controlId:this.props.controlId,id:this.props.id,systemDefinedProperties:this.props.customControlPropertyBag,configuration:this.props.configuration,descriptor:this.props.descriptor,parentDefinedControlProps:a})))}_navigateToAssociatedGrid(){const e=this._getRelatedEntityItemForChart(this.props);let t="FormCellChart.navigateToAssociatedGrid",n=[];if(!e){const e=this.props.descriptor&&this.props.descriptor.Parameters?this.props.descriptor.Parameters[v.F.RELATIONSHIP_NAME]:null,r=String.format(this.props.chartNavigationErrorDetail,e);return t="FormCellChart.openErrorDialog",n=[{name:"pageEtn",value:this.props.contextToken.parentContextToken.entityTypeName},{name:"associatedGridRelationship",value:e}],this.props.openErrorDialog(this.props.chartNavigationError,[r],this.props.id,"https://docs.microsoft.com/en-us/powerapps/maker/model-driven-apps/add-edit-form-navigation-related-entities").then(()=>{this.context.EventManager.ReportComponentSuccess(t,n)},e=>{this.context.EventManager.ReportComponentFailure(t,e,"",n)})}const r=Object(d.a)(this.props.contextToken.parentContextToken,e.relationshipName,e.ordinal);return n=[{name:"pageEtn",value:this.props.contextToken.parentContextToken.entityTypeName},{name:"associatedGridRelationship",value:e.relationshipName},{name:"associatedGridEntityName",value:e.entityName}],this.props.openRelatedGrid(this.props.id,r,e).then(()=>{this.context.EventManager.ReportComponentSuccess(t,n)},e=>{this.context.EventManager.ReportComponentFailure(t,e,"",n)})}_getRelatedEntityItemForChart(e){if(!e.associatedGridsRelationshipInfo||0===e.associatedGridsRelationshipInfo.length)return null;const t=e.descriptor&&e.descriptor.Parameters?e.descriptor.Parameters[v.F.RELATIONSHIP_NAME]:null;if(!t)return null;let n=null;return e.associatedGridsRelationshipInfo.forEach(e=>{!n&&e&&e.relatedItems&&e.relatedItems.forEach(e=>{!e||e.relationshipName!==t||e.ordinal&&e.ordinal!==S.a.Referencing||(n=e)})}),n?{id:n.id,title:n.title,entityName:n.entityName,isSelected:!0,relationshipName:n.relationshipName,url:n.url,ordinal:n.ordinal}:null}}const _=Object(a.a)((function(){let e=null;const t=function(){let e=null;const t=Object(p.f)();return(n,r)=>(e||(e=t(n,{id:r.id})),e)}();return function(n,r){const i=Object(c.a)(n),a=Object(l.a)(i.sizes.Section.cellHeightInRem),s=t(n,r),o=Object(y.b)(n,C.k),u=Object(y.b)(n,C.l);return e={rowHeight:a,associatedGridsRelationshipInfo:s,chartNavigationError:o,chartNavigationErrorDetail:u},e}}),(function(e,t){return{openRelatedGrid:(t,n,r)=>e(Object(h.a)(t,n,r)),openErrorDialog:(t,n,r,i)=>e(function(e,t,n,r){return{type:"form.openFormChartErrorDialog",execute(i,a,s){const o=["ErrorIconAltInformation","Button_Label_OK","L_Show_Details_Text","L_Help_Label_Text"];return i.dispatch(Object(b.e)(o)).then(()=>{const a=Object(y.e)(i.getState(),o),s=Object(y.c)(a,"ErrorIconAltInformation"),c=Object(y.c)(a,"Button_Label_OK"),l=Object(y.c)(a,"L_Show_Details_Text"),u={dynamicHelpLabel:Object(y.c)(a,"L_Help_Label_Text"),dynamicHelpURL:r};return i.dispatch(Object(g.a)(m.d,void 0,{type:"information"},void 0,s,e,c,l,t,!0,n,u))})}}}(t,n,r,i))}}))(O);O.contextType=f.a;const I=Object(a.a)((function(e){return{cellHeightInRem:Object(c.a)(e).sizes.Section.cellHeightInRem}}))(e=>{const t=window.innerWidth<=381?1.32:0,n={height:Object(l.a)(t+e.cellHeightInRem)+"px"};return r.createElement(o.a,{id:e.domId,testhooks:{id:e.controlName},style:n},e.disableWebResourceControlsMessage)});var j=n("w1eR"),P=n("eOoD"),F=n("SAYH"),T=n("KBcj"),w=n("Lyxw"),E=n("Z/4N"),x=n("P6DH"),N=n("3/02"),A=n("i1f0");var k=n("7p56"),M=n("N0PS");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const D=["OpenAssociatedGridViewImageButtonTooltip","OpenAssociatedGridViewImageButtonText","OpenAllRecordsViewImageButtonText","OpenAllRecordsViewImageButtonToolTip"];var R=n("ruPX"),B=n("d0w6"),L=n("z0a7"),V=n("fILV");function z(e){if(!e.associatedGridsRelationshipInfo||0===e.associatedGridsRelationshipInfo.length)return null;const t=e.descriptor&&e.descriptor.Parameters?e.descriptor.Parameters[v.F.RELATIONSHIP_NAME]:null;if(!t)return null;let n=null;return e.associatedGridsRelationshipInfo.forEach(e=>{!n&&e&&e.relatedItems&&e.relatedItems.forEach(e=>{!e||e.relationshipName!==t||e.ordinal&&e.ordinal!==S.a.Referencing||(n=e)})}),n?{id:n.id,title:n.title,entityName:n.entityName,isSelected:!0,relationshipName:n.relationshipName,url:n.url,ordinal:n.ordinal}:null}const H=Object(a.a)((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e={associatedGridsRelationshipInfo:null,gridEntityTypeName:null,subgridControlDataSetUIOptions:null,isInsideFormComponentInstance:null};const t=function(){let e=null;const t=Object(p.f)();return(n,r)=>(e||(e=t(n,{id:r.id})),e)}(),n=function(){let e=null;return(t,n)=>{if(e)return e;const r=n&&n.CustomControlId?n.CustomControlId:null;if(!r)return null;const i=Object(x.ab)(t,r),a=Object(E.e)(t,r);if(i&&a&&a.Properties.DataSetDefinitions&&a.Properties.DataSetDefinitions[i]&&a.Properties.DataSetDefinitions[i].CDSDataSetOptions){const t=a.Properties.DataSetDefinitions[i].CDSDataSetOptions;e={displayChart:!(!t.hasOwnProperty("displayChart")||!t.displayChart),displayCommandBar:!(!t.hasOwnProperty("displayCommandBar")||!t.displayCommandBar),displayIndex:!(!t.hasOwnProperty("displayIndex")||!t.displayIndex),displayQuickFind:!(!t.hasOwnProperty("displayQuickFind")||!t.displayQuickFind),displayViewSelector:!(!t.hasOwnProperty("displayViewSelector")||!t.displayViewSelector)}}return e}}();return(r,i)=>{let a=null,s=null;if(Object(w.c)(r,N.Fc)){const e=Object(T.c)(r,F.a.tryParse(i.descriptor.Parameters.ViewId));s=e?e.entityLogicalName:null,s="actioncard"===s?null:s,a=t(r,i)}const o=n(r,i.configuration),c=Object(A.Eb)(r,i.id);return e={associatedGridsRelationshipInfo:a,gridEntityTypeName:s,subgridControlDataSetUIOptions:o,isInsideFormComponentInstance:c},e}}),(function(e,t){return{openRelatedGrid:(t,n,r)=>e(Object(h.a)(t,n,r)),createXrm:t=>e(Object(M.b)(t)),openGrid:(t,n)=>e(Object(R.a)(V.a,n,t))}}))((function(e){const{controlName:t,id:n,rowSpan:i}=e,a=r.useContext(f.a),s=Object(L.a)(D);let o=!1;const c=[],l=z(e);if(l&&!e.isInsideFormComponentInstance){const t={Icon:"TableLink",Tooltip:{title:Object(y.c)(s,"OpenAssociatedGridViewImageButtonTooltip")},DisplayText:Object(y.c)(s,"OpenAssociatedGridViewImageButtonText"),Id:`navigateToAssociatedGrid-${l.relationshipName}-${e.id}`,WillOpenFlyout:!1,IsInFlyout:!0,Children:null,execute:()=>function(e,t){const n=z(e);if(!n)return Promise.reject("related entity item not found for this button");const r=[{name:"pageEtn",value:e.contextToken.parentContextToken.entityTypeName},{name:"associatedGridRelationship",value:n.relationshipName},{name:"associatedGridEntityName",value:n.entityName}],i=Object(d.a)(e.contextToken.parentContextToken,n.relationshipName,n.ordinal);return e.openRelatedGrid(e.id,i,n).then(()=>{t.EventManager.ReportComponentSuccess("ShowFullView.navigateToAssociatedGrid",r)},e=>{t.EventManager.ReportComponentFailure("ShowFullView.navigateToAssociatedGrid",e,"",r)})}(e,a)};c.push(t)}else if(e.gridEntityTypeName){const t={Icon:"TableGroup",Tooltip:{title:Object(y.c)(s,"OpenAllRecordsViewImageButtonToolTip")},DisplayText:Object(y.c)(s,"OpenAllRecordsViewImageButtonText"),Id:"navigateToGrid-"+e.id,WillOpenFlyout:!1,IsInFlyout:!0,Children:null,execute:()=>function(e,t){const n={pageType:"entitylist",viewId:e.descriptor.Parameters.ViewId?new F.a(e.descriptor.Parameters.ViewId):null,entityTypeName:e.gridEntityTypeName,viewType:"true"===e.descriptor.Parameters.isUserView?B.b.userview:B.b.savedview},r=[{name:"pageEtn",value:e.contextToken.parentContextToken.entityTypeName},{name:"gridEtn",value:e.gridEntityTypeName},{name:"viewId",value:e.descriptor.Parameters.ViewId}];return e.openGrid(e.id,n).then(e=>{e&&0===e.status?t.EventManager.ReportComponentSuccess("ShowFullView.navigateToGrid",r):t.EventManager.ReportComponentFailure("ShowFullView.navigateToGrid",e.error,"",r)})}(e,a)};c.push(t)}const u={shouldRender:e.shouldRender,gridConfigurations:e.configurations,addedCommandListFromHostParent:c};let p=null;return"MscrmControls.Grid.ReadOnlyGrid"===e.configuration.CustomControlId||"MscrmControls.Grid.GridControl"===e.configuration.CustomControlId||"MscrmControls.MailApp.MailAppListControl"===e.configuration.CustomControlId||"MscrmControls.Grid.ReadOnlyGrid"===e.configuration.Name||"MscrmControls.Grid.GridControl"===e.configuration.Name||"MscrmControls.MailApp.MailAppListControl"===e.configuration.Name?(p={displayChart:!0,displayCommandBar:!0,displayIndex:!0,displayQuickFind:!0,displayViewSelector:!0},o=!0):e.subgridControlDataSetUIOptions?(p=e.subgridControlDataSetUIOptions,e.subgridControlDataSetUIOptions.displayCommandBar&&(o=!0)):p={displayChart:!1,displayCommandBar:!1,displayIndex:!1,displayQuickFind:!1,displayViewSelector:!1},"MscrmControls.Calendar.CalendarControl"===e.configuration.Name&&(p.displayCommandBar=!0,o=!0),p.displayCommandBar=o,r.createElement(k.a,{key:n+t,id:n,previewId:e.previewId,controlId:t,contextString:v.h.SUBGRID,configuration:e.configuration,descriptor:e.descriptor,systemDefinedProperties:e.customControlPropertyBag,rowSpan:i,parentContextToken:e.parentContextToken,nonCompositionProps:u,formInfo:e.formInfo,dataSetUIOptions:p,parentDefinedControlProps:e.parentProps})}));var G=n("llMO"),W=n("CYtR");class U extends r.Component{constructor(e,t){super(e,t),this.onRenderCompleteCallback=this.onRenderCompleteCallback.bind(this),e.domId&&!t.AccessibilityManager.isClientAPISetFocusScheduled()&&(this._intersectionObserverHelper=e.intersectionObserverHelper),this.state={visibleToViewport:!this._intersectionObserverHelper||void 0}}componentDidMount(){this._observeCell(),this.onRenderCompleteCallback()}componentDidUpdate(){this._observeCell()}_observeCell(){this._intersectionObserverHelper&&!this.state.visibleToViewport&&this._intersectionObserverHelper.observe(this)}componentWillUnmount(){this._intersectionObserverHelper&&this._intersectionObserverHelper.unobserve(this)}getDomId(){return this.props.domId}intersecting(){this.state.visibleToViewport||Object(G.c)(()=>this.setState({visibleToViewport:!0}))}onRenderCompleteCallback(){this.props.shouldNotifyRenderComplete&&this.props.onRenderComplete()}_transformStyle(){let e=this.props.defaultCellStyle;return this.props.style&&Object.keys(this.props.style).length>0&&(e=Object.assign(Object.assign({},e),this.props.style)),!1===this.props.isParentPaddingAdded&&1!==this.props.cellControlMode&&this.props.configuration.Name!==W.d&&(e=Object.assign(Object.assign({},e),this.props.extraSidePaddingStyle)),e}render(){return this.state.visibleToViewport&&!this.props.disableWebResourceControlsMessage?this._render():r.createElement(I,{controlName:this.props.controlName,domId:this.props.domId,disableWebResourceControlsMessage:this.props.disableWebResourceControlsMessage})}_render(){if(void 0!==this.props.overriddenVisibility&&!this.props.overriddenVisibility)return null;if(!this.props.descriptor||!this.props.informationAvailableToRender)return null;if(this.props.clientHost===j.a.MobileApplication&&void 0!==this.props.descriptor.Parameters.ShowOnMobileClient&&"false"===this.props.descriptor.Parameters.ShowOnMobileClient||this.props.clientHostSubtype===P.a.Phone&&null!==this.props.availableForPhone&&void 0!==this.props.availableForPhone&&!this.props.availableForPhone)return null;if(this.props.isCreateForm&&this.props.isRelatedDataSetControl&&!this.props.isPreviewMode)return null;const{controlName:e,id:t,userSpacer:n,rowSpan:a}=this.props;if(this._parentProps||(this._parentProps={parentInSeeMoreMode:this.props.inDialogWithZIndex,parentFlyoutId:this.props.parentFlyoutRoot}),n)return r.createElement(o.a,{id:this.props.domId,style:this.props.spacerCellStyle,testhooks:{[u.b]:this.props.previewId,[u.c]:20,"control-name":e}});if(!e)return null;if(2===this.props.cellControlMode)return r.createElement(o.a,{style:this._transformStyle(),testhooks:{"control-name":e},id:this.props.domId},r.createElement(_,{key:e+t,controlId:e,id:t,domId:this.props.domId,previewId:this.props.previewId,customControlPropertyBag:this.props.customControlPropertyBag,descriptor:this.props.descriptor,configuration:this.props.configuration,style:this._transformStyle(),rowSpan:a,contextToken:this.props.contextToken}));if(1===this.props.cellControlMode)return r.createElement(o.a,{style:this._transformStyle(),testhooks:{"control-name":e},id:this.props.domId},r.createElement(H,{key:e+t,controlName:e,id:t,previewId:this.props.previewId,customControlPropertyBag:this.props.customControlPropertyBag,descriptor:this.props.descriptor,configuration:this.props.configuration,configurations:this.props.configurations,rowSpan:a,isRemoteAvailable:this.props.isRemoteAvailable,isEntityEnabledForOffline:this.props.isEntityEnabledForOffline,parentProps:this._parentProps,contextToken:this.props.contextToken,parentContextToken:this.props.parentContextToken,shouldRender:this.props.shouldRender,formInfo:this.props.formInfo}));const s=this.props.configuration.Children&&this.props.configuration.Children.fieldControl,c=s?s.CustomControlId:this.props.configuration.CustomControlId,l=!1===this.props.useControlWrapper&&s?s:this.props.configuration;return r.createElement(o.a,{style:this._transformStyle(),testhooks:{id:e,[u.b]:this.props.previewId,[u.c]:20,"control-name":e},id:this.props.domId},r.createElement(i.c,{key:e+t+c,controlId:e,id:t,systemDefinedProperties:this.props.customControlPropertyBag,descriptor:this.props.descriptor,configuration:l,rowSpan:a,formInfo:this.props.formInfo,shouldRender:this.props.shouldRender,parentContextToken:this.props.parentContextToken,parentDefinedControlProps:this._parentProps}))}}U.displayName="Cell";const q=Object(a.a)(s.c)(U);U.contextType=f.a},DU8S:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return d}));var r=n("9A3e"),i=n("VDDv"),a=n("VkXQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="customcontrol.propertybag.device.isoperationavailable";function o(){return{type:s,execute:(e,t)=>new r.a(t,e).isOperationAvailable(a.b.getBarcodeValue.name),sync:!0}}function c(){return{type:s,execute:(e,t)=>new i.a(t,e).isOperationAvailable(a.f.takePicture.name),sync:!0}}function l(){return{type:s,execute:(e,t)=>new i.a(t,e).isOperationAvailable(a.f.captureVideo.name),sync:!0}}function u(){return{type:s,execute:(e,t)=>new i.a(t,e).isOperationAvailable(a.f.captureAudio.name),sync:!0}}function d(){return{type:s,execute:()=>!1,sync:!0}}},E6o7:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));var r=n("dHD5"),i=n("jAuy"),a=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="dataset.update.fetchxml";function o(e,t,n){return{type:"dataset.update.fetchxml.async",execute({dispatch:o,getState:c},l){const u=l.TraceManager.getTracer(a.z),d=a.x+".updateFetchXMLAction";try{u.info("Updating the fetch xml for the grid."),o(function(e,t,n){const i=Object(r.y)(t),a=Object(r.v)(t);return{type:s,payload:n,meta:{pageId:e,contextKey:i,dataSetContextKey:a}}}(e,t,n));const a=Object(i.j)(n),c=[];return c.push({name:"fetchXML",value:a}),l.EventManager.ReportComponentSuccess(d,c),Promise.resolve()}catch(e){const n="Updating the fetchxml for the grid with contextKey : "+Object(r.v)(t)+" failed with the error : "+e.message;l.EventManager.ReportComponentFailure(d,Error(n))}}}}},EOIL:function(e,t,n){"use strict";n.d(t,"a",(function(){return ee}));var r=n("0nOn"),i=n("i1f0"),a=n("ZIjf"),s=n("Sbn7"),o=n("Bj/n"),c=n("jTSi"),l=n("9NSo"),u=n("SAYH"),d=n("uOtn"),p=n("+zjj"),h=n("N+Ya"),g=n("dIqG"),m=n("16wZ"),b=n("qshH"),y=n("meVR"),f=n("TYIz"),S=n("dHD5");var v=n("IqkD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let C;class O{constructor(e,t,n,r){const i="ClientApi.XrmNavigationItem.constructor";e||Object(m.j)(i,"store"),n||Object(m.j)(i,"pageId"),t||Object(m.j)(i,"contextToken"),Object(m.a)(r)&&Object(m.j)(i,"id"),C=e,this._pageId=n,this._id=r,this._contextToken=t}getId(){return a.a.instance.reportUsage("ClientApi.XrmNavigationItem.getId"),this._id}getLabel(){const e="ClientApi.XrmNavigationItem.getLabel";try{a.a.instance.reportCall(e);const t=Object(i.Rb)(C.getState(),this._pageId,this._id);return a.a.instance.reportSuccess(e),t}catch(t){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}}getVisible(){const e="ClientApi.XrmNavigationItem.getVisible";try{a.a.instance.reportCall(e);const t=Object(i.Ub)(C.getState(),this._pageId,this._id);return a.a.instance.reportSuccess(e),t}catch(t){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}}setFocus(){const e="ClientApi.XrmNavigationItem.setFocus";try{a.a.instance.reportCall(e),C.dispatch((t=this._pageId,n=this._contextToken,r=this._id,{type:"forms.selectnavigationtab",sync:!0,execute({dispatch:e,getState:i},a,s){const o=Object(p.d)(i(),t,r);if(o){o.isSelected=!0;const r=Object(S.a)(n,o.relationshipName,o.ordinal);e(Object(f.b)(t,void 0,n)),e(Object(y.a)(t,r,o))}else a.TraceManager.getTracer("Forms.SelectNavigationTab").error("Could not find relatedEntityInfo to select")}})),a.a.instance.reportSuccess(e)}catch(t){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}var t,n,r}setLabel(e){const t="ClientApi.XrmNavigationItem.setLabel";try{if(a.a.instance.reportCall(t),!Object(m.a)(e)){const t=Object(v.s)(C.getState());C.dispatch(Object(h.b)(this._pageId,this._id,e,t))}a.a.instance.reportSuccess(t)}catch(e){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}}setVisible(e){const t="ClientApi.XrmNavigationItem.setVisible";try{a.a.instance.reportCall(t),C.dispatch(Object(g.b)(this._pageId,this._id,!0===e)),a.a.instance.reportSuccess(t)}catch(e){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let _;class I{constructor(e,t,n){n||Object(m.j)("ClientApi.XrmFormNavigation.constructor","pageId"),e||Object(m.j)("ClientApi.XrmFormNavigation.constructor","store"),_=e,this._pageId=n,this._contextToken=t}get items(){const e="ClientApi.XrmFormNavigation.items";try{if(a.a.instance.reportCall(e),!this._items){this._items=new s.a(e);const t=Object(p.f)()(_.getState(),{id:this._pageId});t&&t.forEach(e=>{e&&e.relatedItems&&e.relatedItems.forEach(e=>{e&&e.id&&this._items.add(e.id,new O(_,this._contextToken,this._pageId,e.id))})})}return a.a.instance.reportSuccess(e),this._items}catch(t){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}}}var j=n("ldWj"),P=n("PidC"),F=n("4U8P"),T=n("NtHU"),w=n("FhIR"),E=n("ABCl");let x;class N extends j.a{constructor(e,t,n,r){super(e,t,n,N.NAME,null,r),x=e,this._clientApiExecutor=new E.b(x,"ClientApi.XrmHeaderSection.",t)}getLabel(){return a.a.instance.reportUsage("ClientApi.XrmHeaderSection.getLabel"),""}getVisible(){return a.a.instance.reportUsage("ClientApi.XrmHeaderSection.getVisible"),!0}setLabel(e){a.a.instance.reportUsage("ClientApi.XrmHeaderSection.setLabel")}setVisible(e){a.a.instance.reportUsage("ClientApi.XrmHeaderSection.setVisible")}getControlsDescriptor(e){const t=Object(i.tb)(e,{id:this.pageId},this.contextToken),n={};if(t)for(let e=0;e<t.length;e++){const r=t[e];n[r.Name]=r}return n}setCommandBarVisible(e){this._clientApiExecutor.execute("setCommandBarVisible",()=>{x.dispatch(Object(F.b)(this.pageId,this.contextToken,e))},[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])}getCommandBarVisible(){return this._clientApiExecutor.execute("getCommandBarVisible",()=>{var e;return null===(e=Object(P.f)(x.getState(),this.pageId,this.contextToken))||void 0===e?void 0:e.commandBarVisible})}setBodyVisible(e){this._clientApiExecutor.execute("setBodyVisible",()=>{x.dispatch(Object(T.b)(this.pageId,this.contextToken,e))},[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])}getBodyVisible(){return this._clientApiExecutor.execute("getCommandBarVisible",()=>{var e;return null===(e=Object(P.f)(x.getState(),this.pageId,this.contextToken))||void 0===e?void 0:e.bodyVisible})}setTabNavigatorVisible(e){this._clientApiExecutor.execute("setTabNavigatorVisible",()=>{x.dispatch(Object(w.b)(this.pageId,this.contextToken,e))},[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])}getTabNavigatorVisible(){return this._clientApiExecutor.execute("getTabNavigatorVisible",()=>{var e;return null===(e=Object(P.f)(x.getState(),this.pageId,this.contextToken))||void 0===e?void 0:e.tabNavigatorVisible})}}N.NAME="Header";var A=n("5iTp"),k=n("m+2h");let M;class D extends j.a{constructor(e,t,n,r){super(e,t,n,D.NAME,null,r),M=e,this._clientApiExecutor=new E.b(M,"ClientApi.XrmFooterSection.",t)}getLabel(){return a.a.instance.reportUsage("ClientApi.XrmFooterSection.getLabel"),""}getVisible(){return this._clientApiExecutor.execute("getVisible",()=>{var e;return null===(e=Object(A.a)(M.getState(),this.pageId,this.contextToken))||void 0===e?void 0:e.visible})}setLabel(e){a.a.instance.reportUsage("ClientApi.XrmFooterSection.setLabel")}setVisible(e){this._clientApiExecutor.execute("setVisible",()=>{M.dispatch(Object(k.b)(this.pageId,this.contextToken,e))},[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])}getControlsDescriptor(e){const t=Object(i.Z)(e,{id:this.pageId},this.contextToken),n={};if(t)for(let e=0;e<t.length;e++){const r=t[e];n[r.Name]=r}return n}}D.NAME="Footer";var R=n("gQ5I"),B=n("arV0"),L=n("PUjk"),V=n("r/aD"),z=n("bpBl"),H=n("IaGr");let G;class W{constructor(e,t,n,r){const i="ClientApi.XrmProcessControlUI.constructor";r||Object(m.j)(i,"entity"),t||Object(m.j)(i,"contextToken"),n||Object(m.j)(i,"pageId"),e||Object(m.j)(i,"store"),G=e,this._pageId=n;let a=!1;if(Object(V.d)(G.getState(),this._pageId,i)){const e=Object(B.g)(G.getState(),this._pageId);this._processManager=Object(L.b)(this._pageId,e),a=!0}this._contextToken=t;const s=Object(V.b)(n,e.getState(),a);H.a.getInstance().eventManager.ReportComponentSuccess(i,s)}getDisplayState(){const e="ClientApi.XrmProcessControlUI.getDisplayState";try{if(a.a.instance.reportCall(e),!Object(V.d)(G.getState(),this._pageId,e))return a.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getDisplayState();return a.a.instance.reportSuccess(e),t}catch(t){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}}getVisible(){const e="ClientApi.XrmProcessControlUI.getVisible";try{if(a.a.instance.reportCall(e),!Object(V.d)(G.getState(),this._pageId,e))return a.a.instance.reportSuccess(e),!1;const t=this._getProcessManager().isVisible();return a.a.instance.reportSuccess(e),t}catch(t){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}}setDisplayState(e){const t="ClientApi.XrmProcessControlUI.setDisplayState";try{if(a.a.instance.reportCall(t),!Object(V.d)(G.getState(),this._pageId,t))return void a.a.instance.reportSuccess(t);e!==z.a.collapsed&&e!==z.a.expanded&&e!==z.a.floating||this._getProcessManager().setDisplayState(e),a.a.instance.reportSuccess(t)}catch(e){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}}setVisible(e){const t="ClientApi.XrmProcessControlUI.setVisible";try{if(a.a.instance.reportCall(t),!Object(V.d)(G.getState(),this._pageId,t))return void a.a.instance.reportSuccess(t);this._getProcessManager().setVisible(e),a.a.instance.reportSuccess(t)}catch(e){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}}reflow(e,t,n){const r="ClientApi.XrmProcessControlUI.reflow";try{if(a.a.instance.reportCall(r),!Object(V.d)(G.getState(),this._pageId,r))return void a.a.instance.reportSuccess(r);this._getProcessManager().reflow(e,t,n),a.a.instance.reportSuccess(r)}catch(e){const t=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(r,e,null,t),e}}_getProcessManager(){return this._processManager||(this._processManager=Object(V.c)(this._processManager,G,this._pageId,"ClientApi.XrmProcessControlUI.getProcessManager")),this._processManager}}var U=n("1kth"),q=n("uNLT"),X=n("bT7G"),Y=n("Dea/"),K=n("Fij2"),Q=n("pF61"),Z=n("COKI"),J=n("zJiL");let $;class ee extends Z.a{constructor(e,t,n,i,a,s){$=e,super(e,t,n,i,a,s,d.a),this._clientApiExecutorFormUI=new r.a(e,"ClientApi.XrmFormUI.",n,t),this._clientApiExecutorFormUI.addEventParameter({name:"entityName",value:a,isEventParam:!0})}get headerSection(){const e="ClientApi.XrmFormUI.headerSection";try{return a.a.instance.reportCall(e),this._headerSection||(this._headerSection=new N($,this.contextToken,this.pageId,this.formContext)),a.a.instance.reportSuccess(e),this._headerSection}catch(t){throw this._reportFailure(e,t)}}get footerSection(){const e="ClientApi.XrmFormUI.footerSection";try{return a.a.instance.reportCall(e),this._footerSection||(this._footerSection=new D($,this.contextToken,this.pageId,this.formContext)),a.a.instance.reportSuccess(e),this._footerSection}catch(t){throw this._reportFailure(e,t)}}addControls(e){const t=b.a.getInstance().getEventParameters(this.contextToken),n={name:"controlName",value:""};t.push(n);for(const r in e)if(e[r]){n.value=r;const i=this.xrmControlFactory.createXrmControl(this.contextToken,e[r],this.formContext,"ClientApi.XrmFormUI.addControls",t);i&&this.controls.add(i.getName(),i)}}get navigation(){const e="ClientApi.XrmFormUI.navigation";try{return a.a.instance.reportCall(e),this._navigation||(this._navigation=new I($,this.contextToken,this.pageId)),a.a.instance.reportSuccess(e),this._navigation}catch(t){throw this._reportFailure(e,t)}}get process(){const e="ClientApi.XrmFormUI.process_get";try{a.a.instance.reportCall(e);const t=!!this._process;!this._process&&this.formContext.data&&this.formContext.data.entity&&(this._process=new W($,this.contextToken,this.pageId,this.formContext.data.entity));const n=Object(V.a)(this.pageId,$.getState(),t,!(!this.formContext.data||!this.formContext.data.entity));return H.a.getInstance().eventManager.ReportComponentSuccess(e,n),a.a.instance.reportSuccess(e),this._process}catch(t){throw this._reportFailure(e,t)}}set process(e){const t=Object(V.a)(this.pageId,$.getState(),!!this._process,!(!this.formContext.data||!this.formContext.data.entity));H.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmFormUI.process_set",t),this._process=e}get quickForms(){const e="ClientApi.XrmFormUI.quickForms";try{return a.a.instance.reportCall(e),this._quickForms||(this._quickForms=new s.a(e),this.controls),a.a.instance.reportSuccess(e),this._quickForms}catch(t){throw this._reportFailure(e,t)}}clearFormNotification(e){const t="ClientApi.XrmFormUI.clearFormNotification";try{a.a.instance.reportCall(t);const n=$.dispatch(Object(c.b)(this.contextToken,this.pageId,e));return a.a.instance.reportSuccess(t),n}catch(e){throw this._reportFailure(t,e)}}close(){try{a.a.instance.reportCall("ClientApi.XrmFormUI.close"),Object(K.a)(Object(Q.b)($.getState())===this.pageId)||$.dispatch(Object(R.e)(this.pageId)),a.a.instance.reportSuccess("ClientApi.XrmFormUI.close")}catch(e){throw this._reportFailure("ClientApi.XrmFormUI.close",e)}}getFormType(){return this._clientApiExecutorFormUI.execute("getFormType",(e,t)=>{const n=this.getFormDescriptor(e,t);if(n){const r=this.formContext;if(r&&r.data&&r.data.entity&&Object(i.Lb)($.getState(),r.data.entity.getEntityName(),u.a.tryParse(r.data.entity.getId())))return 4;if(Object(i.kb)($.getState(),{id:this.pageId},this.contextToken))return 3;if(6===n.FormType)return 3;const a=Object(i.ac)($.getState(),this.pageId,this.contextToken);if(a){const n=Object(X.b)($.getState(),a);return n?n.mode===Y.a.Create?1:2:(t.push({name:"snapshotID",value:a}),this._clientApiExecutorFormUI.reportFailure(e+".getSnapshot",new Error("Snapshot is null or undefined"),t),0)}return r&&r.data&&r.data.entity&&!u.a.tryParseOrNull(r.data.entity.getId())?1:2}return 0})}isDialog(){return this._clientApiExecutorFormUI.execute("isDialog",()=>Object(B.f)($.getState(),this.pageId))}getViewPortHeight(){const e="ClientApi.XrmFormUI.getViewPortHeight";try{a.a.instance.reportCall(e);const t=Object(i.qb)($.getState(),{id:this.pageId},this.contextToken);return a.a.instance.reportSuccess(e),t}catch(t){throw this._reportFailure(e,t)}}getViewPortWidth(){const e="ClientApi.XrmFormUI.getViewPortWidth";try{a.a.instance.reportCall(e);const t=Object(i.rb)($.getState(),{id:this.pageId},this.contextToken);return a.a.instance.reportSuccess(e),t}catch(t){throw this._reportFailure(e,t)}}setFormEntityName(e){const t="ClientApi.XrmFormUI.setFormEntityName";Object(m.g)(e,t,"name");try{a.a.instance.reportCall(t),$.dispatch(Object(l.b)(this.pageId,this.contextToken,e)),a.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}}setFormNotification(e,t,n,r,i){return this._clientApiExecutorFormUI.execute("setFormNotification",(a,s)=>{let c;switch(Object(m.a)(n)&&(n="Random_String_"+Math.random()),t){case"ERROR":c=J.a;break;case"WARNING":c=J.e;break;case"INFORMATION":case"INFO":c=J.b;break;default:Object(m.h)(a,"notificationLevel",t,s)}return!Object(m.a)(e)&&"string"==typeof e&&($.dispatch(Object(o.c)(this.contextToken,this.pageId,e,c,n,r,i)),!0)})}addOnLoad(e){const t="ClientApi.XrmFormUI.addOnLoad";Object(m.g)(e,t,"handler");try{a.a.instance.reportCall(t),$.dispatch(Object(U.f)(this.contextToken,this.pageId,e)),a.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}}removeOnLoad(e){const t="ClientApi.XrmFormUI.removeOnLoad";Object(m.g)(e,t,"handler");try{a.a.instance.reportCall(t),$.dispatch(Object(U.A)(this.contextToken,this.pageId,e)),a.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}}refresh(){const e="ClientApi.XrmFormUI.refresh";try{a.a.instance.reportCall(e);const t=Object(B.l)($.getState(),this.pageId);return $.dispatch(Object(q.f)(this.pageId,t,!0,1,!0,!0)).then(t=>(Object(K.b)(this.formContext.data.entity),a.a.instance.reportSuccess(e),t)).catch(t=>{const n=b.a.getInstance().getEventParameters(this.contextToken);return Object(m.d)($,t,e+".saveFormAndNavigate",n)})}catch(t){const n=b.a.getInstance().getEventParameters(this.contextToken);return Object(m.d)($,t,e,n)}}_reportFailure(e,t){const n=b.a.getInstance().getEventParameters(this.contextToken);return b.a.getInstance().reportFailure(e,t,null,n),t}}},FHmp:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="tab.setlabel";function a(e,t,n,a){const s=Object(r.v)(t);return{type:i,payload:a,meta:{pageId:e,contextKey:s,tabId:n}}}},FhIR:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="header.tabnavigatorvisible";function a(e,t,n){const a=Object(r.v)(t);return{type:i,payload:n,meta:{pageId:e,contextKey:a}}}},G0J3:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("ghNp"),i=n("i1f0"),a=n("0nOn");let s;class o{constructor(e,t,n,i,o,c){this._clientApiExecutor=new a.a(e,"ClientApi.XrmFormBase.",i,n,[{name:"store",value:e,isRequired:!0},{name:"entityName",value:this._entityName,isEventParam:!0},{name:"pageId",value:i,isRequired:!0,isEventParam:!0},{name:"contextToken",value:n,isRequired:!0},{name:"getUiType",value:o,isRequired:!0}]),s=e,this.pageId=i,this.contextToken=n,this._entityName=t,this._getUiType=o,this._xrmControlFactory=c,s.dispatch(Object(r.a)(this,i,n))}get ui(){return this._clientApiExecutor.execute("ui_get",()=>{if(!this._ui){const e={id:this.pageId},t=Object(i.fb)(s.getState(),e,this.contextToken),n=t&&t.FormType,r=this._getUiType(n);this._ui=new r(s,this.contextToken,this.pageId,this,this._entityName,this._xrmControlFactory)}return this._ui})}getControl(e){const t=[{name:"entityName",value:this._entityName,isRequired:!1,isEventParam:!0}];return this._clientApiExecutor.execute("getControl",()=>this.ui.controls.get(e),t)}}},GO2b:function(e,t,n){"use strict";n.d(t,"a",(function(){return Rn}));var r=n("u+q+"),i=n("nuS9"),a=n("4fxQ"),s=n("/2of"),o=n("OA2N"),c=n("2YQW"),l=n("i1f0"),u=n("+zjj"),d=n("TYIz"),p=n("gvL4"),h=n("3rse"),g=n("io1E"),m=n("arV0"),b=n("ZGH+"),y=n("b8TU"),f=n("dHD5"),S=n("tjBT"),v=n("unFF"),C=n("meVR"),O=n("YxC/"),_=n("X3qb"),I=n("89vK"),j=n("e1AF"),P=n("iZ7K"),F=n("PtYj"),T=n("QiMq"),w=n("zmL5"),E=n("YWpA"),x=n("+Ajx"),N=n("O7zD"),A=n("hXGe"),k=n("jrkH");class M extends i.Component{constructor(e){super(e),this._dataId="tablist-",this._displayedTabs=[],this._overflowTabs=[],this._previousTabItems=[],this._keyDownHandler=this._keyDownHandler.bind(this),this._selectRelatedEntityHandler=this._selectRelatedEntityHandler.bind(this),this._flyoutKeyDownHandler=this._flyoutKeyDownHandler.bind(this),this._ulRef=this._ulRef.bind(this),this._toggleFlyout=this._toggleFlyout.bind(this),this._closeFlyout=this._closeFlyout.bind(this),this.onMeasuring=this.onMeasuring.bind(this),this._backgroundCanvas=document.createElement("canvas"),this.state={isFlyoutOpened:!1,retrieveMissingRelatedEntitiesFinished:!1},this._previousHeaderCollapsed=e.headerCollapsed}onMeasuring(e){this._previousWidth!==e&&(this._previousWidth=e),this._reflowTabs(e)}componentDidMount(){this._previousHeaderCollapsed=this.props.headerCollapsed}componentDidUpdate(){var e,t,n;if(this._tabNavigatorList)if(null===(e=this.props.selectedRelatedEntity)||void 0===e?void 0:e.isSelected){const e=null===(t=a.findDOMNode(this._tabNavigatorList))||void 0===t?void 0:t.childNodes;let n;for(let e=0;e<this.props.tabItems.length;e++)this.props.tabItems[e].name===this.props.selectedRelatedEntity.id&&this.props.tabItems[e].id===A.a&&(n=this.props.tabItems[e].id);if(n){let t;for(let r=0;r<e.length;r++)if(Object(A.g)(e[r].id,this.props.id)===n){t=r;break}e[t]&&this._previousFocusedItem!==e[t]&&(e[t].focus(),this._previousFocusedItem=e[t],this.props.selectedTabId&&this.props.selectRelatedTab(this.props.selectedRelatedEntity,this.props.contextToken))}}else{const e=null===(n=a.findDOMNode(this._tabNavigatorList))||void 0===n?void 0:n.childNodes;let t;for(let n=0;n<e.length;n++)if(Object(A.g)(e[n].id,this.props.id)===this.props.selectedTabId){t=n;break}e[t]&&this._previousFocusedItem!==e[t]&&(e[t].focus(),this._previousFocusedItem=e[t])}this._previousHeaderCollapsed=this.props.headerCollapsed}componentWillReceiveProps(e){e.headerCollapsed!==this._previousHeaderCollapsed&&this.state.isFlyoutOpened&&this._toggleFlyout()}componentWillUnmount(){this.props.updateVisitedTabNames(this.props.selectedTabId)}_renderAssociativeOrGanttGrid(){return i.createElement(k.a,{id:this.props.id,selectedRelatedEntity:this.props.selectedRelatedEntity,isAuditFeatureEnabled:this.props.isAuditFeatureEnabled,contextToken:this.props.contextToken,formId:this.props.formId.guid,entityName:this.props.entityTypeName,recordId:this.props.entityId.guid,style:this.props.associatedGridContainerStyle})}_createOnClick(e){return()=>{if(e===A.b||"more_tab"===e)this.props.retrieveMissingRelatedEntities(this.props.entityTypeName).then(e=>{e&&this.setState({retrieveMissingRelatedEntitiesFinished:!0})}),this._toggleFlyout();else{this.props.selectTab(e,this.props.contextToken,this.props.selectedRelatedEntity);this._overflowTabs.findIndex(t=>t.id===e)>-1&&this._toggleFlyout()}}}_keyDownHandler(e){var t,n;const r=null===(t=e.target)||void 0===t?void 0:t.id;if(this._tabNavigatorList){const t=null===(n=a.findDOMNode(this._tabNavigatorList))||void 0===n?void 0:n.childNodes;if(t&&t.length>0){let n,i;for(let e=0;e<t.length;e++)if(t[e].id===r){n=e;break}if(e.keyCode===h.a.LeftArrow)i=(n-1+t.length)%t.length,t[i].focus();else if(e.keyCode===h.a.RightArrow)i=(n+1+t.length)%t.length,t[i].focus();else if(e.keyCode===h.a.Enter||e.keyCode===h.a.Space)if(Object(A.g)(r,this.props.id)===A.b||"more_tab"===Object(A.g)(r,this.props.id))this.props.retrieveMissingRelatedEntities(this.props.entityTypeName).then(e=>{e&&this.setState({retrieveMissingRelatedEntitiesFinished:!0})}),this._toggleFlyout();else{const e=this.props.tabItems.find(e=>e.id===Object(A.g)(r,this.props.id)),t=null==e?void 0:e.id;this.props.selectTab(t,this.props.contextToken,this.props.selectedRelatedEntity)}}}}_flyoutKeyDownHandler(e){var t,n;const r=Object(A.g)(null===(t=e.target)||void 0===t?void 0:t.id,this.props.id);if(e.keyCode===h.a.Enter||e.keyCode===h.a.Space){const e=null===(n=this.props.tabItems.find(e=>e.id===r))||void 0===n?void 0:n.id;this.props.selectTab(e,this.props.contextToken,this.props.selectedRelatedEntity),this._toggleFlyout()}}_toggleFlyout(){this.setState({isFlyoutOpened:!this.state.isFlyoutOpened})}_renderTabFlyout(e){const t=this._overflowTabs.length>0?"more_tab":A.b,n=this.props.headerCollapsed===this._previousHeaderCollapsed&&this.state.isFlyoutOpened;return i.createElement(g.a,{key:Object(N.g)(A.a,this.props.id),id:this.props.id,relativeElementId:Object(N.g)(t,this.props.id),isFlyoutOpened:n,moreTabItems:e,selectTab:this._flyoutKeyDownHandler,selectRelatedEntity:this._selectRelatedEntityHandler,closeFlyout:e=>this._closeFlyout(e),retrieveMissingRelatedEntitiesFinished:this.state.retrieveMissingRelatedEntitiesFinished,isInCreateMode:this.props.isInCreateMode,tabNavigatorList:this._tabNavigatorList})}_renderTabList(e){const t=Object(O.c)(this.props.resourceStrings,_.b),n=t?String.format(t,this.props.entityDisplayName):"";return i.createElement(E.a,{isRequestedMeasuring:!0,onMeasuring:this.onMeasuring},i.createElement(p.a,{id:Object(N.g)(A.c,this.props.id),key:A.c+(e&&e.length),role:"tablist",ref:this._ulRef,style:this.props.tabListStyle,onKeyDown:this._keyDownHandler,accessibilityLabel:n},e))}_renderTabContent(){var e;if(this.props.selectedTabId&&!(null===(e=this.props.selectedRelatedEntity)||void 0===e?void 0:e.isSelected)){const e=[];for(const t of this.props.tabItems){const n=this.props.selectedTabId===t.id;e.push(i.createElement(s.a,{renderHeaderFields:this.props.renderHeaderFields,renderFooterFields:this.props.renderFooterFields,key:"tab_"+t.id,id:this.props.id,tabId:t.id,tabName:t.name,showTab:n,labelledBy:t.id,columnStyle:this.props.columnStyle,sectionStyle:this.props.sectionStyle,cellStyle:this.props.cellStyle,cellContainerStyle:this.props.cellContainerStyle,style:Object.assign(Object.assign({},this.props.tabBasicStyle),n?this.props.selectedTabStyle:this.props.tabStyle),showFooterFieldsRenderInSection:this.props.showFooterFieldsRenderInSection,viewportElementId:this.props.viewportElementId}))}return i.createElement(E.a,{style:this.props.tabsContainerStyle},e)}return this.props.selectedRelatedEntity&&this.props.selectedRelatedEntity.isSelected?i.createElement(E.a,{style:this.props.containerStyle},this._renderAssociativeOrGanttGrid()):null}_getTabLabelWidth(e){const t=this._backgroundCanvas.getContext("2d");let n,r;if(this.props.tabListItemStyles&&this.props.tabListItemStyles.selectedTabStyle&&this.props.tabListItemStyles.selectedTabStyle.fontSize&&this.props.tabListItemStyles.selectedTabStyle.fontFamily?t.font=Object(b.a)(parseFloat(this.props.tabListItemStyles.selectedTabStyle.fontSize))+"px "+this.props.tabListItemStyles.selectedTabStyle.fontFamily:t.font="14px Segoe UI",this.props.tabListItemStyles&&this.props.tabListItemStyles.tabStyle&&this.props.tabListItemStyles.tabStyle.maxWidth&&(this.props.tabListItemStyles.tabStyle.marginLeft||this.props.tabListItemStyles.tabStyle.marginRight)){const e=this.props.tabListItemStyles.tabStyle.maxWidth.toString();e.length&&(n=Number(e.substr(0,e.length-2)));const t=this.props.tabListItemStyles.tabStyle.marginLeft?this.props.tabListItemStyles.tabStyle.marginLeft.toString():this.props.tabListItemStyles.tabStyle.marginRight.toString();r=Number(t.substr(0,t.length-2))}return e.length>n?t.measureText(e.substr(0,n)).width+r:t.measureText(e).width+r}_reflowTabs(e){this._displayedTabs=[],this._overflowTabs=[];const t=this.props.tabListStyle?Object(b.e)(this.props.tabListStyle.paddingLeft.toString()):0,n=this.props.tabListStyle?Object(b.e)(this.props.tabListStyle.paddingRight.toString()):0,r=Object(A.d)(this.props.tabItems);let i=(r?this._getTabLabelWidth(r.label):26)+n+t;const a=Math.floor(e);for(const e of this.props.tabItems){const t=e.id,n=e.label;if(!e.visible)continue;const r=this._getTabLabelWidth(n);if(i+=r,e.id!==A.b)if(i<a)this._displayedTabs.push(e);else if(t===this.props.selectedTabId||t===A.a&&this.props.selectedRelatedEntity&&this.props.selectedRelatedEntity.isSelected){const t=this._numberOfTabsToRemove(this._displayedTabs,r),n=this._displayedTabs.splice(this._displayedTabs.length-t,t);for(const e of n)this._overflowTabs.unshift(e);this._displayedTabs.push(e)}else t!==A.a&&this._overflowTabs.push(e)}}_numberOfTabsToRemove(e,t){let n=0,r=0;for(let i=e.length-1;i>=0;i--){if(t<=this._getTabLabelWidth(e[i].label)+n)return r++,r;n+=this._getTabLabelWidth(e[i].label),r++}return r}render(){const e=[],t=[];this._previousWidth&&this._displayedTabs.length>0&&(this._previousTabItems!==this.props.tabItems||this._previousSelectedTabId!==this.props.selectedTabId||this._previousSelectedRelatedEntity!==this.props.selectedRelatedEntity)&&(this._previousTabItems=this.props.tabItems,this._previousSelectedTabId=this.props.selectedTabId,this._previousSelectedRelatedEntity=this.props.selectedRelatedEntity,this._reflowTabs(this._previousWidth)),0===this._displayedTabs.length&&this.props.initialWidth&&this._reflowTabs(this.props.initialWidth);for(const t of this._displayedTabs){const n=t.name,r=t.label,a=t.id,s=t.previewId,c=this._createOnClick(a),l=this.props.selectedRelatedEntity&&this.props.selectedRelatedEntity.isSelected?A.a===a:this.props.selectedTabId===a;e.push(i.createElement(o.a,{key:n,tabName:n,label:r,isSelected:l,relatedTabId:Object(N.g)(A.b,this.props.id),isFlyoutOpened:this.state.isFlyoutOpened,testhooks:Object(A.e)({id:this._dataId+n},s),id:Object(N.g)(a,this.props.id),tabLength:this.props.tabItems.length,onClick:c}))}if(this._overflowTabs.length>0){const t=Object(N.g)("more_tab",this.props.id),n=Object(O.c)(this.props.resourceStrings,_.c),r=this._createOnClick("more_tab");e.push(i.createElement(o.a,{key:Object(N.g)("more_tab",this.props.id),tabName:t,label:n,isSelected:!1,id:Object(N.g)("more_tab",this.props.id),testhooks:{id:Object(N.g)("more_tab",this.props.id)},style:this.props.overflowTabListItemStyle,isMoreTab:!0,isFlyoutOpened:this.state.isFlyoutOpened,tabLength:this.props.tabItems.length,onClick:r}))}else if(Object(A.d)(this.props.tabItems)){const t=Object(A.d)(this.props.tabItems),n=t.name,r=t.label,a=this.props.selectedTabId===A.b,s=t.previewId,c=this._createOnClick(A.b);e.push(i.createElement(o.a,{key:n,tabName:n,label:r,isSelected:a,relatedTabId:Object(N.g)(A.b,this.props.id),isFlyoutOpened:this.state.isFlyoutOpened,testhooks:Object(A.e)({id:this._dataId+n},s),id:Object(N.g)(A.b,this.props.id),tabLength:this.props.tabItems.length,onClick:c}))}for(const e of this._overflowTabs){const n=e.name,r=e.label,a=e.id,s=e.previewId,c=this._createOnClick(a);t.push(i.createElement(o.a,{key:n,tabName:n,label:r,isSelected:!1,relatedTabId:Object(N.g)(A.b,this.props.id),isFlyoutOpened:this.state.isFlyoutOpened,testhooks:Object(A.e)({id:this._dataId+n},s),id:Object(N.g)(a,this.props.id),tabLength:this.props.tabItems.length,onClick:c,style:this.props.overflowTabListItemStyle}))}let n;return n=this.props.returnTabsBody?this._renderTabContent():this.props.showTabNavigator?i.createElement(E.a,{style:this.props.headerStyle},this._renderTabList(e),this._renderTabFlyout(t)):null,n}_closeFlyout(e){e&&e.target&&e.target.id!==A.b&&this._toggleFlyout()}_ulRef(e){this._tabNavigatorList=e}_selectRelatedEntityHandler(e){this._toggleFlyout(),this.props.selectRelatedTab(e,this.props.contextToken)}}M.displayName="TabNavigator";const D=Object(r.a)((function(){const e=Object(A.f)(),t=Object(u.f)(),n=Object(S.a)(),r=Object(I.a)(),i=Object(O.h)();let a=null;return function(s,o){const d=i(s,_.f),p=Object(f.j)(s,o.id);Object(c.e)(a,p)||(a=p);const h=Object(m.g)(s,o.id),g=Object(y.c)(s),b=h,S=Object(m.m)(s,o.id),C=S?null:t(s,o),O=Object(u.e)(s,o,a),I=e(s,{props:o,resourceStrings:d,selectedRelatedEntity:O,isInCreateMode:S});let j=Object(l.wc)(s,o,a),T=!0;for(const e of I)j!==e.id||e.visible||(T=!1);if(!T)for(const e of I)if(e.visible){j=e.id;break}const E=n(s,Object.assign(Object.assign({},o),{viewPortWidth:g}),o.headerCollapsed,o.enabledFormFCBs),x=Object(v.a)(s),N=Object(w.b)(s,o.id),A=r(s);let k="",M=null,D=!0;b&&(k=b.entityTypeName,M=b.id,D=!b.bodyOnly);const R=Object(F.a)(s,k),B=Object(P.h)(s,k);return{selectedTabId:j,relatedEntities:C,tabItems:I,selectedRelatedEntity:O,entityTypeName:k,entityId:M,tabListStyle:E.tabListStyle,scrollableTabListStyle:E.scrollableTabListStyle,tabBasicStyle:E.tabBasicStyle,containerStyle:E.containerStyle,tabsContainerStyle:E.tabsContainerStyle,headerStyle:E.headerStyle,cellContainerStyle:E.cellContainerStyle,selectedTabStyle:E.selectedTabStyle,semanticZoomListItemStyle:E.semanticZoomListItemStyle,customSemanticZoomButtonStyle:E.customSemanticZoomButtonStyle,overflowTabListItemStyle:E.overflowTabListItemStyle,contextToken:a,associatedGridContainerStyle:E.associatedGridContainerStyle,semanticZoomTabListItemWidthInEm:x.sizes.TabNavigator.SemanticZoomTabListItemWidthInEm,overflowtItemWidthInEm:x.sizes.TabNavigator.OverflowtItemWidthInEm,tabListItemStyles:A,formId:N,resourceStrings:d,isInCreateMode:S,entityDisplayName:B.DisplayName,showTabNavigator:D,viewportElementId:o.viewportElementId,isAuditFeatureEnabled:R}}}),(function(e,t){return{selectTab:(n,r,i)=>{if(n===A.a){if(i){const n=Object(f.a)(r,i.relationshipName,i.ordinal),a=Object.assign(Object.assign({},i),{isSelected:!0});e(Object(d.b)(t.id,void 0,r)),e(Object(C.a)(t.id,n,a)),t.afterSelectTab()}}else{if(i&&i.isSelected){const n=Object.assign(Object.assign({},i),{isSelected:!1});e(Object(x.b)(t.id,r,n))}e(Object(d.b)(t.id,n,r)),t.afterSelectTab()}},selectRelatedTab:(n,r)=>{if(n){const i=Object(f.a)(r,n.relationshipName,n.ordinal),a=Object.assign(Object.assign({},n),{isSelected:!0});e(Object(d.b)(t.id,void 0,r)),e(Object(C.a)(t.id,i,a)),t.afterSelectTab()}else e(Object(d.b)(t.id,void 0,r)),t.afterSelectTab()},updateVisitedTabNames:n=>{e(Object(T.b)(t.id,n))},retrieveMissingRelatedEntities:t=>e(Object(j.a)(t))}}))(M);var R=n("w1eR"),B=n("GYEz"),L=n("ynyB");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function V(e){let t=e.viewPortWidthLessThanOrEqualToSmallBreakpoint?11.85:17.15;return e.bpfControlRendered||(t-=4),e.clientHost===R.a.MobileApplication&&e.bpfControlRendered&&(t-=.5),!e.viewPortWidthLessThanOrEqualToSmallBreakpoint&&e.viewPortWidthLessThanOrEqualToMediumBreakpoint&&(t-=.25),e.formNotificationHeight&&(t+=Object(b.b)(e.formNotificationHeight)+.15),e.hasCmdBar||e.viewPortWidthLessThanOrEqualToSmallBreakpoint||(t-=3),t+"rem"}function z(e){if(!e.headerCollapsed)return"none";let t=e.viewPortWidthLessThanOrEqualToSmallBreakpoint?1.6:3;return e.bpfControlRendered&&(t+=.75),`translateY(-${t}rem)`}function H(e){return i.createElement(E.a,{id:"shadow",style:{position:"absolute",height:"4px",width:"100%",top:V(e),opacity:e.tabScrolledToTop?0:1,background:"linear-gradient(180deg, rgba(0,0,0,.35), rgba(0, 0, 0, 0))",transition:L.c,transform:z(e)}})}H.displayName="Shadow";const G=Object(r.a)((function(){return function(e,t){const n=Object(f.j)(e,t.id),r=Object(l.o)(e,t.id,n),i=Object(y.c)(e),a=Object(v.a)(e);return{bpfControlRendered:r,clientHost:Object(B.a)(e),viewPortWidthLessThanOrEqualToSmallBreakpoint:i<=a.sizes.Breakpoints.DimensionS,viewPortWidthLessThanOrEqualToMediumBreakpoint:i<=a.sizes.Breakpoints.DimensionM}}}),(function(e,t){return{}}))(H);var W=n("223Y"),U=n("odYE"),q=n("SAYH"),X=n("eXjw"),Y=n("5Oca"),K=n("+nNZ"),Q=n("4Us1"),Z=n("8O0c"),J=n("53SR"),$=n("nexV"),ee=n("kQA8"),te=n("S2mk"),ne=n("Nb1E"),re=n("oLL6"),ie=n("VcAV");var ae,se;!function(e){e[e.BreadCrumb=0]="BreadCrumb",e[e.Stage=1]="Stage"}(ae||(ae={})),function(e){e[e.Initializing=0]="Initializing",e[e.MetadataReady=1]="MetadataReady",e[e.ReadyToRender=2]="ReadyToRender"}(se||(se={}));class oe extends i.Component{constructor(e){super(e),this._flowStepInitInProgress=!1,this.state={status:se.Initializing};const t=e.renderingMode===ae.BreadCrumb?"MscrmControls.Containers.ProcessBreadCrumb":"MscrmControls.Containers.ProcessStageControl";this._CCF_config=Object(te.o)(t)}render(){return!this.props.workflowObjectModelLibraryLoaded||!this.props.processInstanceId||this.props.descriptor&&!this.props.descriptor.hasOwnProperty("businessProcessFlowId")?null:this.props.renderingMode===ae.BreadCrumb&&this.props.processInstanceId&&this.state.status!==se.Initializing?i.createElement(E.a,{id:"bpfContainer",key:"bpfContainer",style:this.props.breadCrumbContainerStyle},i.createElement(W.c,{key:"businessProcessFlow",id:this.props.id,controlId:"MscrmControls.Containers.ProcessBreadCrumb",configuration:this._CCF_config,descriptor:oe._CCF_BC_descriptor,parentContextToken:this.props.contextToken})):this.state.status===se.ReadyToRender?i.createElement(W.c,{key:"businessProcessFlowStage",id:this.props.id,controlId:"MscrmControls.Containers.ProcessStageControl",configuration:this._CCF_config,descriptor:oe._CCF_STAGE_descriptor,parentContextToken:this.props.contextToken}):null}componentDidMount(){this._checkForStatusUpdate()}componentDidUpdate(){this._checkForStatusUpdate()}_checkForStatusUpdate(){switch(this.state.status){case se.Initializing:this._loadDescriptorsIfUnavailable(),this._updateSelectedStageFromParams(),this._isMetadataReady()&&this.setState({status:se.MetadataReady});break;case se.MetadataReady:this._isProcessControlLoadable()&&(this._loadActionLogs(),this._loadFlowStepFlowIdsIfUnavailable(),this.setState({status:se.ReadyToRender}));break;case se.ReadyToRender:this._isProcessControlLoadable()&&this._loadFlowStepFlowIdsIfUnavailable()}}_updateSelectedStageFromParams(){if(this.props.selectedStageId&&!q.a.equals(this.props.selectedStageId,q.a.EMPTY)){const e={selectedStageId:this.props.selectedStageId},t=new U.a("businessprocessflowinstance",this.props.processInstanceId);if(this.props.updateBusinessProcessFlowData(e,t),!this.props.displayState){const e="floating";this.props.updateDisplayState(e,t)}}}_loadDescriptorsIfUnavailable(){this.props.processDescriptorLoaded||this.props.processId||this.props.currentEntity||this.props.retrieveBusinessProcessFlowDescriptor(this.props.processId,this.props.currentEntity)}_loadFlowStepFlowIdsIfUnavailable(){if(this.props.descriptor&&this.props.descriptor.businessProcessFlowFlows&&!this._flowStepInitInProgress){const e=this.props.descriptor.businessProcessFlowFlows;for(const t in e){const n=e[t];if(n.workflowId&&!n.flowId){this._flowStepInitInProgress=!0;return void this.props.retrieveBusinessProcessFlowFlowStepFlowIds(this.props.processId).then(()=>{this._flowStepInitInProgress=!1},e=>{this._flowStepInitInProgress=!1})}}}}_loadActionLogs(){if(this.props.descriptor&&this.props.descriptor.businessProcessFlowEntities&&this.props.renderingMode===ae.Stage)for(const e of this.props.descriptor.businessProcessFlowEntities)if(e.stage){const t=e.stage;for(const e of t.steps){const t=e.stepType.toLowerCase();if("action"===t||"modernflow"===t)return void this.props.retrieveBusinessProcessFlowActionLogs(this.props.processId,new U.a(this.props.descriptor.businessProcessFlowUniqueName,this.props.processInstanceId))}}}_isProcessControlLoadable(){return!!this.props.processInstanceId}_isMetadataReady(){return!!this.props.processControlEnabled&&(!!this.props.currentEntity&&(!(!this.props.processId||q.a.equals(this.props.processId,q.a.EMPTY))&&!!this.props.processDescriptorLoaded))}}oe._CCF_BC_descriptor={Id:"MscrmControls.Containers.ProcessBreadCrumb",Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1},oe._CCF_STAGE_descriptor={Id:"MscrmControls.Containers.ProcessStageControl",Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1},oe.displayName="BusinessProcessFlow";const ce=Object(r.a)((function(){const e=(e,t)=>{if(void 0===t.id&&void 0===t.processId)return;if(!t.id)return q.a.EMPTY;const n=Object(m.a)(e,t),r=new U.a(n.entityTypeName,n.id);return Object(Y.e)(e,r)},t=(e,t)=>{if(void 0===t.id&&void 0===t.processId)return;if(!t.id)return q.a.EMPTY;const n=Object(m.a)(e,t),r=new U.a(n.entityTypeName,n.id);return Object(Y.f)(e,r)},n=(e,t)=>!!(e&&e.metadata&&e.metadata.controlManifests&&e.metadata.controlManifests.hasOwnProperty("MscrmControls.Containers.ProcessBreadCrumb")&&e.metadata.controlManifests.hasOwnProperty("MscrmControls.Containers.ProcessBreadCrumb")),r=function(){let e=!1;return(t,n)=>{const r=Object(m.a)(t,n),i=new U.a(r.entityTypeName,r.id),a=Object(Y.e)(t,i),s=a?Object(K.a)(t,a):null,o=null!==s&&s.initialized===X.a.Initialized;return o!==e&&(e=o),e}}(),i=(e,t)=>{const n=Object(m.a)(e,t),r=new U.a(n.entityTypeName,n.id),i=Object(Y.e)(e,r);return i?Object(K.a)(e,i):null},a=function(){let e=null;return(t,n)=>{const r=Object(m.a)(t,n),i=new U.a(r.entityTypeName,r.id);return e||(e=i),i.id===e.id&&i.etn===e.etn||(e=i),e}}(),s=function(){let e=null;return(t,n)=>{const r=Object(m.a)(t,n);return r.selectedStageId&&!q.a.equals(e,q.a.tryParse(r.selectedStageId))&&(e=q.a.parse(r.selectedStageId)),e}}(),o=function(){let e=null;return(t,n)=>{const r=function(e){return e&&e.businessProcessFlowData&&e.businessProcessFlowData.displayState?e.businessProcessFlowData.displayState:null}(t);return e!==r&&(e=r),e}}();return function(c,l){const u=e(c,l),d=t(c,l),p=n(c,l),h=r(c,l),g=i(c,l),m=a(c,l),b=s(c,l),y=o(c,l),f=Object(K.h)(c);return{processId:u,processControlEnabled:p,processInstanceId:d,processDescriptorLoaded:h,currentEntity:m,selectedStageId:b,displayState:y,descriptor:g,contextToken:l.contextToken,workflowObjectModelLibraryLoaded:f}}}),(function(e,t){return{retrieveBusinessProcessFlowDescriptor:(t,n)=>e(Object(Q.a)(t,n)),updateBusinessProcessFlowData:(t,n)=>e(Object(J.a)(t,n)),updateDisplayState:(t,n)=>e(Object($.a)(t,n)),retrieveBusinessProcessFlowActionLogs:(t,n)=>e(Object(Z.a)(t,n)),retrieveBusinessProcessFlowFlowStepFlowIds:t=>e(function(e){return{type:"businessprocessflow.flowstep.flowids.retrieve",execute({dispatch:t,getState:n},r){const i=r.TraceManager.getTracer("businessProcessFlow.retrieveBusinessProcessFlowFlowStepFlowIds"),a=n().metadata.businessProcessFlows;if(Object(ie.c)(a))return void i.warn("Skip retrieveBusinessProcessFlowFlowStepFlowIds: IsNullOrUndefined businessProcessFlowsById: "+a);const s=a[e.guid];if(Object(ie.c)(s))return void i.warn(`Skip retrieveBusinessProcessFlowFlowStepFlowIds for processId: ${e.guid.toString()}. IsNullOrUndefined businessProcessFlowDescriptor: ${s}`);const o=s.businessProcessFlowFlows;if(Object(ie.c)(o))return void i.warn(`Skip retrieveBusinessProcessFlowFlowStepFlowIds for processId: ${e.guid.toString()}. IsNullOrUndefined businessProcessFlowFlowDescriptorDictionary: ${o}`);const c=[];for(const t in o){const n=o[t];if(Object(ie.c)(n)){i.warn(`failure in retrieveBusinessProcessFlowFlowStepFlowIds for processId: ${e.guid.toString()}. IsNullOrUndefined businessProcessFlowFlowDescriptor: ${n}`);continue}const r=n.workflowId;Object(ie.c)(r)?i.warn(`failure in retrieveBusinessProcessFlowFlowStepFlowIds for processId: ${e.guid.toString()}. IsNullOrUndefined workflowId: ${r}`):c.indexOf(r)<0&&c.push(r)}let l="?$select=workflowidunique,workflowid&$filter=",u=!0;for(let e=0;e<c.length;e++){const t=String.format("(workflowid%20eq%20({0}))",c[e]);u?(l+=t,u=!1):(l+="%20or%20",l+=t)}return i.info("retrieveBusinessProcessFlowFlowStepFlowIds OData RetrieveMultiple querystring: "+l),t(Object(ne.e)("workflow",l)).then(n=>{n.value&&n.value.length&&(n.value.forEach(t=>{for(const n in o){const r=o[n];Object(ie.c)(r)?i.warn(`failure in retrieveBusinessProcessFlowFlowStepFlowIds for processId: ${e.guid.toString()}. IsNullOrUndefined businessProcessFlowFlowDescriptor: ${r}`):(i.info(`retrieveBusinessProcessFlowFlowStepFlowIds comparing workflowid: ${r.workflowId}. workflowidunique: ${r.flowId}`),r.workflowId===t.workflowid&&(r.flowId=t.workflowidunique,i.info(`set businessProcessFlowFlowDescriptor.flowId: ${r.flowId}. actionid: ${r.actionId}`)))}}),t(Object(re.b)(a)))})}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(t)),offlineBPFMultipleInstancesAlert:n=>e(Object(ee.a)(n,t.id))}}))(oe);var le=n("EDOo"),ue=n("Qjw6"),de=n("znb3"),pe=n("XIN1"),he=n("H/hG"),ge=n("7sMj"),me=n("tyZ/"),be=n("ISM0"),ye=n("IqkD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const fe=L.c+",opacity 0.125s linear";function Se(e,t,n){let r={position:"relative",width:"100%",paddingLeft:t<=e.sizes.Breakpoints.DimensionS?e.sizes.Measures.Measure100:e.sizes.Measures.Measure150,paddingRight:t<=e.sizes.Breakpoints.DimensionS?e.sizes.Measures.Measure100:e.sizes.Measures.Measure150,display:"flex",justifyContent:"space-between",flex:"1 0 auto",flexWrap:"wrap",boxSizing:"border-box",backgroundColor:e.colors.WhiteBackground};return t>e.sizes.Breakpoints.DimensionS?r=Object.assign(Object.assign({},r),{paddingTop:e.sizes.Measures.Measure150,height:e.sizes.Measures.Measure675,maxHeight:e.sizes.Measures.Measure675}):t<=e.sizes.Breakpoints.DimensionS&&(r=Object.assign(Object.assign({},r),{paddingTop:e.sizes.Measures.Measure075,height:e.sizes.Measures.Measure450,maxHeight:e.sizes.Measures.Measure450})),n||(r.display="none"),r}function ve(e,t,n,r,i){let a=t<=e.sizes.Breakpoints.DimensionS?.5:1.15;r&&i&&(a+=.15);const s=a+"rem",o={border:"2px transparent solid",transition:L.c,transform:n?`scale(0.75) translateY(-${s})`:"none",transformOrigin:"left"};return t>=e.sizes.Breakpoints.DimensionL||t<e.sizes.Breakpoints.DimensionL&&t>e.sizes.Breakpoints.DimensionS?Object.assign(o,{height:e.sizes.Measures.Measure350,width:e.sizes.Measures.Measure350,minWidth:e.sizes.Measures.Measure350,lineHeight:e.sizes.Measures.Measure350,fontSize:e.fontSizes.Font150,marginRight:e.sizes.Measures.Measure100}):Object.assign(o,{height:e.sizes.Measures.Measure250,width:e.sizes.Measures.Measure250,minWidth:e.sizes.Measures.Measure250,lineHeight:e.sizes.Measures.Measure250,fontSize:e.fontSizes.Font100,marginRight:e.sizes.Measures.Measure050}),o}function Ce(e,t){let n={};return n=t>=e.sizes.Breakpoints.DimensionL||t<e.sizes.Breakpoints.DimensionL&&t>e.sizes.Breakpoints.DimensionS?{height:e.sizes.Measures.Measure250,width:e.sizes.Measures.Measure250,minWidth:e.sizes.Measures.Measure250}:{height:e.sizes.Measures.Measure150,width:e.sizes.Measures.Measure150,minWidth:e.sizes.Measures.Measure150},n}function Oe(e,t,n,r,i,a,s,o){const c={fontFamily:e.fontFamilies.Regular,maxWidth:"100%",opacity:1,transform:"translate(0rem,0rem)"};let l={};if(t>=e.sizes.Breakpoints.DimensionL){l={height:n?r?e.sizes.Measures.Measure100:e.sizes.Measures.Measure175:i?e.sizes.Measures.Measure150:e.sizes.Measures.Measure200,lineHeight:n?r?e.sizes.Measures.Measure100:e.sizes.Measures.Measure150:i?e.sizes.Measures.Measure150:e.sizes.Measures.Measure200}}else if(t<e.sizes.Breakpoints.DimensionL&&t>e.sizes.Breakpoints.DimensionS){l={opacity:1,height:n?r?e.sizes.Measures.Measure100:e.sizes.Measures.Measure175:i?e.sizes.Measures.Measure150:e.sizes.Measures.Measure200,lineHeight:n?r?e.sizes.Measures.Measure100:e.sizes.Measures.Measure150:i?e.sizes.Measures.Measure150:e.sizes.Measures.Measure200}}else l={fontSize:e.sizes.Measures.Measure100,height:r?e.sizes.Measures.Measure100:e.sizes.Measures.Measure175,lineHeight:r?e.sizes.Measures.Measure100:e.sizes.Measures.Measure150};if(a&&(r&&(l.transform=`translate(-${e.sizes.Measures.Measure100}, -${e.sizes.Measures.Measure225})`,l.opacity=0),!r&&!i)){const r=t<=e.sizes.Breakpoints.DimensionS?"0rem":"1.4rem";let i=t<=e.sizes.Breakpoints.DimensionS?1.15:n?1.5:2.25;s&&o&&(i+=.15);const a=i+"rem";l.transform=`translate(-${r}, -${a})`}return Object.assign(Object.assign({},c),l)}var _e=n("WPtp"),Ie=n("mL5Q"),je=n("f/sd");var Pe=n("DOFJ"),Fe=n("S1lN"),Te=n("H+1e"),we=n("Afz2"),Ee=n("y60j"),xe=n("eOoD"),Ne=n("Y5AI"),Ae=n("MgYC"),ke=n("CV4+"),Me=n("QBtP"),De=n("jq7Z");class Re extends i.Component{constructor(e){super(e),this._nonOverflowControls=[],this._nonOverflowControlNames=new Set,this._overflowControls=[],this._minimumCellWidth=1,this._previousHeaderCollaped=!1,this.onMeasuring=this.onMeasuring.bind(this),this.state={previousWidth:0,maximumNumberOfControls:0}}componentWillMount(){this._minimumCellWidth=Object(b.a)(this.props.minimumCellWidth)}onMeasuring(e){const t=[{name:"currentWidth",value:e}];if(this._clearControls(),e!==this.state.previousWidth||0===e){const n=Math.floor((e-this.props.expandButtonWidth)/(this._minimumCellWidth+this.props.cellContainerSpacerWidth));t.push({name:"maximumNumberOfControls",value:n}),this.setState(Object.assign(Object.assign({},this.state),{previousWidth:e,maximumNumberOfControls:n}));const r=this.props.formWidthLessThanLargeBreakpoint||this.props.headerFields&&this.props.headerFields.length>0&&n<=0;this._showHeaderFieldsInSection=r,this.props.updateShowHeaderFieldsInSection(this.props.contextToken,r)}this.context.TraceManager.getTracer("Forms.HeaderFields").debug("Measuring Header Fields",t)}_renderHeaderFields(){if(this.props.headerCollapsed===this._previousHeaderCollaped||this.props.headerCollapsed||(this._overflowControls=this._overflowControls.slice(this.state.maximumNumberOfControls,this._overflowControls.length)),this.props.headerFields!==this._previousHeaderFields&&(this._previousHeaderFields=this.props.headerFields,this._clearControls()),this.props.headerFields.forEach((e,t)=>{if(this.props.headerCollapsed!==this._previousHeaderCollaped&&this.props.headerCollapsed&&t<this.state.maximumNumberOfControls)this._overflowControls.unshift(e);else if(t<this.state.maximumNumberOfControls&&this._nonOverflowControls.length!==this.state.maximumNumberOfControls&&this._nonOverflowControls.length<this.props.headerFields.length&&!this._nonOverflowControlNames.has(e.Name)){const n=Object.assign(Object.assign({},this.props.cellWrapperStyle),t===this.state.maximumNumberOfControls||this.props.headerFields.length<this.state.maximumNumberOfControls&&t===this.props.headerFields.length-1?{marginRight:0}:{});this._nonOverflowControls.push(i.createElement(E.a,{style:n},i.createElement(Pe.a,{key:e.Id,id:this.props.id,previewId:e.PreviewId,controlName:e.Name,cellSizeMode:1,style:this.props.cellStyle,scope:Te.a.Header}))),this._nonOverflowControlNames.add(e.Name)}else t>=this.state.maximumNumberOfControls&&this._overflowControls.length<this.props.headerFields.length-this.state.maximumNumberOfControls&&(this._overflowControls.push(e),this._nonOverflowControlNames.delete(e.Name))}),this.props.headerCollapsed!==this._previousHeaderCollaped)if(this.props.headerCollapsed)for(const e of this._nonOverflowControls)e.props.style.visibility="hidden",e.props.style.transitionDelay=L.a;else for(const e of this._nonOverflowControls)e.props.style.visibility=void 0,e.props.style.transitionDelay="0s";return this._headerFieldsinFlyout!==this._overflowControls&&(this._headerFieldsinFlyout=this._overflowControls,this.props.updateHeaderFieldsInFlyout(this.props.contextToken,this._headerFieldsinFlyout)),i.createElement(E.a,{style:{display:"flex",transition:L.b,opacity:this.props.headerCollapsed?0:1}},this._nonOverflowControls)}_clearControls(){this._overflowControls=[],this._nonOverflowControls=[],this._nonOverflowControlNames.clear()}_shouldHeaderFieldsFlyoutComponentsRender(){return this._overflowControls&&this._overflowControls.length>0&&!this.props.formWidthLessThanLargeBreakpoint}render(){return(this.props.clientHostSubtype!==xe.a.Phone||null===this.props.isAvailableForPhone||void 0===this.props.isAvailableForPhone||this.props.isAvailableForPhone)&&this.props.headerFields&&this.props.headerFields.length>0?i.createElement(E.a,{onMeasuring:this.onMeasuring,isRequestedMeasuring:!0,key:"headerFieldsContainer",style:this.props.containerStyle,testhooks:{id:"header_fields_container"},role:we.r},this._renderHeaderFields(),i.createElement(ke.a,{headerCollapsed:this.props.headerCollapsed,id:this.props.id,isMainFormDialog:this.props.isMainFormDialog,isChevronVisible:this._shouldHeaderFieldsFlyoutComponentsRender(),headerFields:this._overflowControls,customStyle:this._showHeaderFieldsInSection?this.props.customChevronStyle:void 0,headerPreviewId:this.props.headerPreviewId})):null}componentDidUpdate(){this._previousHeaderCollaped=this.props.headerCollapsed}}Re.displayName="HeaderFields";const Be=Object(r.a)((function(){const e=Object(O.h)(),t=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e=null,t=null;return function(n,r){const i=Object(v.a)(n);return t!==i&&(t=i,e={containerStyle:{display:"flex",flexDirection:"row",flexGrow:1,justifyContent:"flex-end",flexWrap:"nowrap",height:"auto"},cellWrapperStyle:{whiteSpace:"nowrap",flex:"1 1 auto",width:i.sizes.HeaderFields.MaximumCellWidth,maxWidth:i.sizes.HeaderFields.MaximumCellWidth,maxHeight:"5.25rem",height:"5.25rem",marginRight:i.sizes.Measures.Measure300,overflowY:"hidden",transition:"visibility 0s linear"},cellStyle:{flex:"1 1 auto",width:"100%",borderWidth:0,color:"#000",overflowY:"hidden",maxHeight:"5.25rem",height:"5.25rem"},customChevronStyle:{width:0}}),e}}(),n=Object(l.ed)();let r=null;return function(i,a){const s=Object(f.j)(i,a.id);Object(c.e)(r,s)||(r=s);const o=n(i,{id:a.id,contextToken:r}),l=e(i,Fe.e),u=t(i,a),d=Object(y.c)(i),p=Object(v.a)(i),h=d<p.sizes.Breakpoints.DimensionL,g=Object(De.b)(i,a.id,r),m=Object(Ee.q)(i,g),b=Object(B.e)(i);return{headerFields:o,resourceStrings:l,formWidthLessThanLargeBreakpoint:h,containerStyle:u.containerStyle,cellWrapperStyle:u.cellWrapperStyle,cellStyle:u.cellStyle,customChevronStyle:u.customChevronStyle,minimumCellWidth:p.sizes.HeaderFields.MinimumCellWidthEm+p.sizes.HeaderFields.HeaderFieldMarginEm,expandButtonWidth:p.sizes.HeaderFields.ExpandButtonWidthPx,cellContainerSpacerWidth:p.sizes.HeaderFields.CellContainerSpacerWidthPx,isAvailableForPhone:m,clientHostSubtype:b,contextToken:r}}}),(function(e,t){return{updateShowHeaderFieldsInSection:(n,r)=>{e(Object(Ne.b)(t.id,n,r))},updateHeaderFieldsInFlyout:(n,r)=>{e(Object(Ae.b)(t.id,n,r))}}}))(Re);Re.contextType=Me.a;var Le=n("d5d1"),Ve=n("NjDY"),ze=n("RiHV"),He=n("Ki7F"),Ge=n("o0iw"),We=n("ILmX"),Ue=n("WZ96"),qe=n("3RSF"),Xe=n("Lyxw"),Ye=n("3/02"),Ke=n("XT3E"),Qe=n("+Ljw");class Ze extends i.Component{constructor(e){super(e),this._onEntityImageClick=this._onEntityImageClick.bind(this)}_renderFormNavigator(){return i.createElement(E.a,{accessibilityHidden:this.props.headerCollapsed},i.createElement(be.a,{key:"FormNavigator_"+this.props.id,id:this.props.id,pageName:ue.a.getName(),defaultFormId:q.a.toString(this.props.descriptor.Id),selectedTab:this.props.selectedTab,viewSelectorStyle:this.props.viewSelectorStyle,viewSelectorArrowStyle:this.props.viewSelectorArrowStyle,viewSelectorTextStyle:this.props.viewSelectorTextStyle,entityLogicalName:this.props.descriptor.EntityLogicalName,readOnly:this.props.headerCollapsed}))}_renderFormHeader(){const e=this.props.entityDisplayName||"",{formSelectorItems:t}=this.props;return this.props.descriptor&&t&&Object.keys(t).length>1&&!this.props.isMainFormDialog?this._renderFormNavigator():i.createElement(he.a,{key:"entityName",testhooks:{id:"entity_name_span"},style:this.props.headerEntityNameStyle},e.toLocaleUpperCase())}_renderTitle(){if(!this.props.isTitleReady)return null;const e=Object(l.ob)(this.props.recordId,this.props.formHeaderTitle,this.props.newRecordTitle,this.props.formLabel);return i.createElement(he.a,{semanticTag:"h1",testhooks:{id:"header_title"},key:"headerTitle",id:Object(N.g)(Ke.a,this.props.id),style:this.props.headerRecordNameStyle,title:e},e)}_renderEntityImage(){if(!this.props.isEntityImageVisible)return null;let e=null;const t={entityName:this.props.inputs?this.props.inputs.entityTypeName:null,Id:this.props.inputs.id?this.props.inputs.id.guid:void 0},n={key:"entity_image",hasPrimaryImageField:this.props.hasPrimaryImageField,sipUrl:this.props.entitySipValue,presenceIndicatorSize:me.b.Large,entityReference:t,imageSrc:this.props.entityImageUrl,customEntityIcon:this.props.entityIconVectorName?this.props.webResourceUrl+this.props.entityIconVectorName:null,alt:this.props.formHeaderTitle?this.props.formHeaderTitle:this.props.newRecordTitle,entityPrimaryField:this.props.formHeaderTitle,wrapperStyle:null,style:this.props.entityImageStyle},r=ge.c.getMode(n);if(r===ge.b.CustomEntityIcon||r===ge.b.CustomImage){const e=n.style;n.style=this.props.entityImageCircleStyle,n.wrapperStyle=Object.assign(Object.assign({},e),{display:"flex"})}return e=i.createElement(ge.a,Object.assign({},n,{[ze.a.LearningPathDOMAttributeName]:"form-entityImage"})),i.createElement(E.a,{key:"entityimageContainer",testhooks:{id:"entityImageContainer"},style:this.props.entityImageContainerStyle,onClick:this._onEntityImageClick,role:we.r},e)}_renderReadOnlyIcon(){return i.createElement(he.a,{style:this.props.readOnlyIconWrapperStyle},i.createElement(pe.b,{style:this.props.readOnlyIconStyle,id:"readOnlyIcon",type:de.a.Locked,testhooks:{id:"formReadOnlyIcon"}}))}_renderReadOnlyStatus(){if(this.props.isReadOnly){const e=Object(O.c)(this.props.resourceStrings,le.b),t=i.createElement(he.a,{key:"readOnlyStatus",style:this.props.readOnlyTextStyle,testhooks:{id:"readOnlyStatus"}},e),n=this._renderReadOnlyIcon();return i.createElement(E.a,{style:this.props.readOnlyStatusContainerStyle},n,t)}return null}_onEntityImageClick(e){this.props.isEntityImageUploadDialogOpenable&&this.props.openUploadEntityImageDialog(this.props.entityImageUrl,this.props.inputs.entityTypeName,this.props.inputs.id.guid,this.props.primaryNameAttributeValue,this.props.cameraEnabled,this.props.hasPrimaryImageField)}_renderLoadingExperience(){return i.createElement(E.a,{testhooks:{id:"form-header"},key:"form-header",style:this.props.formHeaderPlaceHoldStyle,role:we.r},i.createElement(E.a,{key:"headerContainer",style:this.props.headerContainerViewStyle},i.createElement(E.a,{key:"entityImagePlacehold",style:this.props.entityImagePlaceholdStyle}),i.createElement(E.a,{key:"formHeaderTitlePlaceholdContainer",style:this.props.formHeaderTitlePlaceholdContainerStyle},i.createElement(E.a,{key:"formHeaderTitlePlacehold1",style:this.props.formHeaderTitlePlacehold1Style}),i.createElement(E.a,{key:"formHeaderTitlePlacehold2",style:this.props.formHeaderTitlePlacehold2Style}))))}_renderCommandBarManager(){return this.props.ribbonId?i.createElement(He.a,{key:this.props.id,commandbarDisplayMode:Ge.a.IconOnly,iconPosition:pe.a.Left,id:this.props.id,mainMenuLength:1,ribbonId:this.props.ribbonId,commandBarStyle:this.props.commandBarStyle,customCommandManagerStyle:this.props.commandManagerStyle,commandManagerId:this.props.id}):null}_internalRender(){return i.createElement(E.a,{id:this.props.domId,testhooks:{id:"form-header",[Ue.b]:this.props.previewId,[Ue.c]:10},key:"formHeader",style:this.props.formHeaderStyle,onClick:this.props.onHeaderClick,role:we.r},i.createElement(E.a,{id:"headerContainer",key:"headerContainer",style:this.props.headerContainerViewStyle},this._renderEntityImage(),i.createElement(E.a,Object.assign({key:"formHeaderAndTitle",style:this.props.formHeaderAndTitleStyle},{[ze.a.LearningPathDOMAttributeName]:"form-header-title"}),this._renderFormHeader(),this._renderTitle(),this._renderReadOnlyStatus()),i.createElement(Be,{id:this.props.id,headerCollapsed:this.props.headerCollapsed,isMainFormDialog:this.props.isMainFormDialog,headerPreviewId:this.props.descriptor.Header.PreviewId}),this.props.formWidthLessThanOrEqualToSmallBreakpoint?this._renderCommandBarManager():null))}render(){return this.props.inputs&&this.props.inputs.bodyOnly?null:this.props.isReady?this._internalRender():this._renderLoadingExperience()}}Ze.displayName="FormHeader";const Je=Object(r.a)((function(){const e=Object(O.h)(),t=function(){let e=null,t=null,n=0,r=null,i=null,a=null,s=null,o=null,c=null;return function(u,d){const p=Object(v.a)(u),h=d.formWidth,g=d.isReadOnly,m=Object(ye.g)(u),b=d.headerCollapsed,y=Object(B.a)(u)===R.a.MobileApplication,S=Object(f.j)(u,d.id),C=Object(l.o)(u,d.id,S),O=!1!==d.visible;if(t!==p||n!==h||r!==g||a!==m||i!==b||o!==C||s!==y||c!==O){if(t=p,n=h,r=g,i=b,a=m,o=C,s=y,c=O,e={headerEntityNameStyle:Object.assign({fontSize:p.fontSizes.Font100,color:p.colors.BaseColor.Grey.Grey7,overflow:"hidden",textOverflow:"ellipsis"},Oe(p,h,g,!0,!0,b,y,C)),formHeaderStyle:Se(p,h,O),formHeaderPlaceHoldStyle:Object.assign(Object.assign({},Se(p,h,b)),{height:p.sizes.Measures.Measure750}),headerContainerViewStyle:{display:"flex",flexDirection:"row",height:"100%",width:"100%"},headerRecordNameStyle:Object.assign({fontSize:p.fontSizes.Font150,verticalAlign:"middle",fontWeight:"normal",color:p.colors.BaseColor.Grey.Grey7,overflow:"hidden",textOverflow:"ellipsis",paddingTop:"0em",transition:L.c},Oe(p,h,g,!1,!1,b,y,C)),formHeaderAndTitleStyle:{position:"relative",display:"flex",flexDirection:"column",padding:0,height:"auto",whiteSpace:"nowrap",width:"100%",minWidth:"auto",maxWidth:h<=p.sizes.Breakpoints.DimensionS?"none":h<p.sizes.Breakpoints.DimensionL?"60%":"25em",marginRight:m?0:p.sizes.Measures.Measure200,transition:L.c,transform:b&&h<=p.sizes.Breakpoints.DimensionS?`translateX(-${p.sizes.Measures.Measure050})`:void 0},entityImageContainerStyle:Object.assign(Object.assign({},ve(p,h,b,y,C)),{marginTop:0,marginBottom:0,marginLeft:m?p.sizes.Measures.Measure150:0,border:0,backgroundColor:"transparent"}),entityImageCircleStyle:{},entityImageStyle:Object.assign(Object.assign({},ve(p,h,b,y,C)),{borderRadius:"50%",textAlign:"center",fontWeight:"bold",textTransform:"uppercase",color:"white",marginRight:0,fontSize:h>=p.sizes.Breakpoints.DimensionM?p.fontSizes.Font115:p.fontSizes.Font100}),entityImageInnerStyle:Object.assign(Object.assign({},Ce(p,h)),{margin:"auto"}),entityImagePlaceholdStyle:Object.assign(Object.assign({},ve(p,h,b,y,C)),{borderRadius:"50%",backgroundColor:p.colors.BaseColor.Grey.Grey3,marginTop:0,marginRight:p.sizes.Measures.Measure100}),selectedTabNameStyle:Object.assign(Oe(p,h,g,!1,!0,b,y,C),{verticalAlign:"middle",color:p.colors.BaseColor.Grey.Grey7,overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",marginRight:p.sizes.Measures.Measure050}),readOnlyStatusContainerStyle:{height:h<=p.sizes.Breakpoints.DimensionS?p.sizes.Measures.Measure075:p.sizes.Measures.Measure100,lineHeight:h<=p.sizes.Breakpoints.DimensionS?p.sizes.Measures.Measure075:p.sizes.Measures.Measure100,transition:L.c+",opacity 0.15s linear",transform:b?`translate(-${p.sizes.Measures.Measure100}, -${p.sizes.Measures.Measure225})`:"none",opacity:b?0:1,color:p.colors.BaseColor.Grey.Grey5},readOnlyTextStyle:{fontFamily:p.fontFamilies.Regular,fontSize:h<=p.sizes.Breakpoints.DimensionS?p.fontSizes.Font075:p.fontSizes.Font100,lineHeight:h<=p.sizes.Breakpoints.DimensionS?p.sizes.Measures.Measure075:p.sizes.Measures.Measure150},readOnlyIconWrapperStyle:{textAlign:"center",fontSize:h<=p.sizes.Breakpoints.DimensionS?p.fontSizes.Font075:p.fontSizes.Font100,marginRight:p.sizes.Measures.Measure050,color:p.colors.BaseColor.Red.Red3},readOnlyIconStyle:{display:"inline-block",color:p.colors.BaseColor.Grey.Grey5,height:h<=p.sizes.Breakpoints.DimensionS?p.sizes.Measures.Measure100:p.sizes.Measures.Measure150,width:h<=p.sizes.Breakpoints.DimensionS?p.sizes.Measures.Measure100:p.sizes.Measures.Measure150,lineHeight:h<=p.sizes.Breakpoints.DimensionS?p.sizes.Measures.Measure100:p.sizes.Measures.Measure150,fontSize:h<=p.sizes.Breakpoints.DimensionS?p.fontSizes.Font065:p.fontSizes.Font100,position:"relative",top:h<=p.sizes.Breakpoints.DimensionS?-2:null,borderRadius:"10px",textAlign:"center",verticalAlign:"middle"},selectedTabNameAndReadOnlyStatusContainerStyle:Object.assign({display:"flex",flexDirection:"row",overflow:"hidden",textOverflow:"ellipsis"},Oe(p,h,g,!1,!1,b,y,C)),viewSelectorStyle:Object.assign({color:p.colors.BaseColor.Grey.Grey7,overflow:"hidden",transition:fe},Oe(p,h,g,!0,!0,b,y,C)),viewSelectorArrowStyle:{fontSize:p.fontSizes.Font100,color:p.colors.BaseColor.Grey.Grey7,overflow:"hidden",textOverflow:"ellipsis",marginLeft:p.sizes.Measures.Measure075,marginRight:p.sizes.Measures.Measure075,minWidth:p.sizes.Measures.Measure100,transition:fe},viewSelectorTextStyle:Object.assign({padding:0,overflow:"hidden",textOverflow:"ellipsis",height:p.sizes.Measures.Measure100,lineHeight:p.sizes.Measures.Measure100,fontSize:p.fontSizes.Font100,transition:fe},Oe(p,h,g,!0,!0,b,y,C)),formHeaderTitlePlaceholdContainerStyle:{position:"relative",display:"block",padding:0,width:h<=p.sizes.Breakpoints.DimensionS?"60%":"35em",height:"100%",paddingBottom:g?"0":p.sizes.Measures.Measure150},formHeaderTitlePlacehold1Style:{backgroundColor:p.colors.BaseColor.Grey.Grey1,height:p.sizes.Measures.Measure100,marginBottom:h<=p.sizes.Breakpoints.DimensionS?p.sizes.Measures.Measure050:p.sizes.Measures.Measure150,width:"100%"},formHeaderTitlePlacehold2Style:{backgroundColor:p.colors.BaseColor.Grey.Grey1,height:p.sizes.Measures.Measure100,width:"50%"},commandBarStyle:{container:{marginLeft:0,marginRight:0,backgroundColor:"transparent",width:"100%",maxHeight:"100%",boxSizing:"border-box",flexDirection:"row-reverse",paddingBottom:p.sizes.Measures.Measure150},list:{margin:0,width:p.sizes.Measures.Measure400,height:p.sizes.Measures.Measure200,flexDirection:"row",justifyContent:"flex-end"},listItem:{margin:0,width:p.sizes.Measures.Measure200,height:p.sizes.Measures.Measure200,"[aria-expanded=true]":{backgroundColor:p.colors.BaseColor.Grey.Grey2},"[data-expanded=true]":{backgroundColor:p.colors.BaseColor.Grey.Grey2},":hover":{backgroundColor:p.colors.BaseColor.Grey.Grey2}},overflowFlyoutMoreButton:{backgroundColor:"transparent",lineHeight:p.sizes.Measures.Measure100,height:p.sizes.Measures.Measure100,borderWidth:0,padding:0,cursor:"pointer",alignItems:"center",marginRight:p.sizes.Measures.Measure050,marginLeft:p.sizes.Measures.Measure050,marginTop:p.sizes.Measures.Measure050},listItemBody:{text:{fontFamily:p.fontFamilies.Regular,color:p.colors.BaseColor.Black},button:{width:p.sizes.Measures.Measure200,height:p.sizes.Measures.Measure200,paddingBottom:0,paddingLeft:m?0:p.sizes.Measures.Measure050,paddingRight:m?p.sizes.Measures.Measure050:0,backgroundColor:"transparent",borderWidth:0},icon:{color:p.colors.BaseColor.Grey.Grey7}},moreIcon:{margin:"0 auto"}},commandManagerStyle:{right:"0",width:"1px",alignItems:"center",marginTop:p.sizes.Measures.Measure025,transition:L.c,transform:b?`translateY(-${p.sizes.Measures.Measure050})`:"none",flexGrow:1}},h<=p.sizes.Breakpoints.DimensionS){const t={overflow:"hidden"},n={minWidth:p.sizes.Measures.Measure400,marginLeft:m?0:p.sizes.Measures.Measure100};if(m){const r={marginRight:0};t.marginLeft=p.sizes.Measures.Measure200,n.marginRight=p.sizes.Measures.Measure100,e.entityImageContainerStyle=Object.assign(Object.assign({},e.entityImageContainerStyle),r)}e.formHeaderAndTitleStyle=Object.assign(Object.assign({},e.formHeaderAndTitleStyle),t),e.commandManagerStyle=Object.assign(Object.assign({},e.commandManagerStyle),n)}e.entityImageCircleStyle=Object.assign(Object.assign(Object.assign({},e.entityImageStyle),e.entityImageInnerStyle),e.entityImageContainerStyle)}return e}}();let n=null;return function(r,i){const a=Object(f.j)(r,i.id);Object(c.e)(n,a)||(n=a);const s=Object(v.a)(r),o=Object(We.f)(r,i),u=Object(l.fb)(r,i,a),d=Object(Qe.a)(r,i.id,!0),p=Object(l.hb)(r,i),h=Object(l.gb)(r,i),g=Object(l.Ib)(r,i.id),b=Object(y.c)(r),S=b<=s.sizes.Breakpoints.DimensionS,C=Object(l.V)(r,i),_=Object(m.a)(r,i),I=_.entityTypeName,j=e(r,le.c),F=Object(l.wc)(r,i,n),T=Object(l.Fc)(r,i.id,F,a),w=Object(l.kb)(r,i,n),E=Object(P.h)(r,I),x=Object(Ie.a)(r,i.id),N=x>je.a.Loading,A=x>je.a.OnLoadReady,k=new U.a(I,_.id),M=Object(l.Yb)(r,i.id,n),D=t(r,Object.assign(Object.assign({},i),{formWidth:b,isReadOnly:w,hasCmdbar:Object(l.Bb)(r,i.id,n),headerCollapsed:i.headerCollapsed})),R=Object(P.i)(r,I),B=Object(Ve.t)(r),{id:L}=Object(m.g)(r,i.id);let V;if(E&&null!=E.PrimaryNameAttribute){const e=Object(Y.b)(k)(r,I);e&&e.fields&&e.fields[E.PrimaryNameAttribute]&&(V=Object(_e.e)(e.fields[E.PrimaryNameAttribute]))}const z=E?E.DisplayName:"",H=Object(O.c)(j,le.a),G=z&&H?String.format(H,z):"",W=E&&!!E.PrimaryImageAttribute,q=W&&!w&&!Object(m.m)(r,i.id),X=!Object(Xe.a)(r,Ye.Dd,Ye.h)||!u||u.ShowEntityImage;return{isReady:N,isTitleReady:A,descriptor:u,formSelectorItems:d,formHeaderTitle:p,headerEntityNameStyle:D.headerEntityNameStyle,formHeaderStyle:D.formHeaderStyle,formHeaderPlaceHoldStyle:D.formHeaderPlaceHoldStyle,headerContainerViewStyle:D.headerContainerViewStyle,headerRecordNameStyle:D.headerRecordNameStyle,formHeaderAndTitleStyle:D.formHeaderAndTitleStyle,entityImageContainerStyle:D.entityImageContainerStyle,entityImageStyle:D.entityImageStyle,entityImageInnerStyle:D.entityImageInnerStyle,selectedTabNameStyle:D.selectedTabNameStyle,readOnlyStatusContainerStyle:D.readOnlyStatusContainerStyle,readOnlyTextStyle:D.readOnlyTextStyle,readOnlyIconWrapperStyle:D.readOnlyIconWrapperStyle,readOnlyIconStyle:D.readOnlyIconStyle,selectedTabNameAndReadOnlyStatusContainerStyle:D.selectedTabNameAndReadOnlyStatusContainerStyle,entityImagePlaceholdStyle:D.entityImagePlaceholdStyle,formHeaderTitlePlaceholdContainerStyle:D.formHeaderTitlePlaceholdContainerStyle,formHeaderTitlePlacehold1Style:D.formHeaderTitlePlacehold1Style,formHeaderTitlePlacehold2Style:D.formHeaderTitlePlacehold2Style,entityImageCircleStyle:D.entityImageCircleStyle,viewSelectorStyle:D.viewSelectorStyle,viewSelectorArrowStyle:D.viewSelectorArrowStyle,viewSelectorTextStyle:D.viewSelectorTextStyle,commandBarStyle:D.commandBarStyle,commandManagerStyle:D.commandManagerStyle,entityImageUrl:h,cameraEnabled:Object(Le.e)(r,"camera"),hasPrimaryImageField:W,resourceStrings:j,selectedTabId:T?T.Label:"",isReadOnly:w,inputs:_,primaryNameAttributeValue:V,entityDisplayName:z,formLabel:M,contextToken:n,formWidthLessThanOrEqualToSmallBreakpoint:S,entitySipValue:C,ribbonId:o,entityIconVectorName:R,webResourceUrl:B,recordId:L,isMainFormDialog:g,newRecordTitle:G,isEntityImageUploadDialogOpenable:q,isEntityImageVisible:X}}}),(function(e,t){return{openUploadEntityImageDialog:(n,r,i,a,s,o)=>e(Object(qe.a)(n,r,i,a,s,o,t.id))}}))(Ze);var $e=n("FhVi"),et=n("ix9S"),tt=n("1fn7"),nt=n("qMYv"),rt=n("wFY3");var it=n("c6SX"),at=n("0uKS"),st=n("nJrx"),ot=n("1AYO"),ct=n("Gilj"),lt=n("evW+");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ut=["ProcessControl.Configurator.Collapse","ProcessControl.Configurator.Expand","Web.Footer.MoreFields","FooterFields.KeyboardShortCut.Area","FooterFields.KeyboardShortCut.Escape","FooterFields.KeyboardShortCut.Down","FooterFields.KeyboardShortCut.Up","Flyout.KeyboardShortCut.Tab.NotAllowed"];var dt=n("cz9j");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const pt=Object(st.a)(),ht="footerFieldsFlyout",gt=Object(st.a)(),mt=Object(st.a)(),bt=Object(st.a)();class yt extends i.Component{constructor(e){super(e),this._onCellsDidMount=this._onCellsDidMount.bind(this),this._moveFocusToExpandButton=this._moveFocusToExpandButton.bind(this),this._moveFocus=this._moveFocus.bind(this),this._handleKeyCodeNavigation=this._handleKeyCodeNavigation.bind(this),this._flyoutOutsideClickHandler=this._flyoutOutsideClickHandler.bind(this),this._toggleFlyout=this._toggleFlyout.bind(this),this.state={isFlyoutOpened:!1,selectedIndex:-1,isCellRendered:!1}}_toggleFlyout(){this.setState(Object.assign(Object.assign({},this.state),{isFlyoutOpened:!this.state.isFlyoutOpened,selectedIndex:-1,isCellRendered:!1}),()=>{this.state.isFlyoutOpened||this._moveFocusToExpandButton()})}_flyoutOutsideClickHandler(e){if(e&&e.target){e.target.id!==pt&&this._toggleFlyout()}}_createKeyboardShortcuts(){const e=Object(O.c)(this.props.resourceStrings,"FooterFields.KeyboardShortCut.Area"),t=Object(O.c)(this.props.resourceStrings,"FooterFields.KeyboardShortCut.Escape"),n=Object(O.c)(this.props.resourceStrings,"FooterFields.KeyboardShortCut.Down"),r=Object(O.c)(this.props.resourceStrings,"FooterFields.KeyboardShortCut.Up"),i=Object(O.c)(this.props.resourceStrings,"Flyout.KeyboardShortCut.Tab.NotAllowed"),a=this._shortcutHandler.bind(this),s=[],o=new ct.a([h.a.UpArrow],a,!0,e,r),c=new ct.a([h.a.DownArrow],a,!0,e,n),l=new ct.a([h.a.Escape],a,!0,e,t),u=new ct.a([h.a.Tab],a,!0,e,i);return s.push(o),s.push(c),s.push(l),s.push(u),s}_shortcutHandler(e){const t=e.EVENT,n=t.keyCode;n===h.a.Escape?this._toggleFlyout():n===h.a.UpArrow||n===h.a.DownArrow?this._handleKeyCodeNavigation(n):n===h.a.Tab&&(t.preventDefault(),t.stopPropagation())}_handleKeyCodeNavigation(e){const t=h.a.DownArrow===e?this.state.selectedIndex+1:-1===this.state.selectedIndex?this.props.overFlownFooterFields.length-1:this.state.selectedIndex-1,n=this.props.overFlownFooterFields.length,r=(t+n)%n;this._moveFocus(r)}_moveFocus(e){const t=this.props.overFlownFooterFields[e],n=a.findDOMNode(this.refs[t.Id]);if(n){const t=dt.b(n);(t.editableElement||t.focusableElement)&&(t.editableElement?t.editableElement.focus():t.focusableElement.focus(),this.setState(Object.assign(Object.assign({},this.state),{selectedIndex:e})))}}_moveFocusToExpandButton(){const e=a.findDOMNode(this.refs[gt]);if(e){const t=dt.b(e);(t.editableElement||t.focusableElement)&&(t.editableElement?t.editableElement.focus():t.focusableElement.focus())}}_onCellsDidMount(){-1===this.state.selectedIndex&&this.props.overFlownFooterFields&&this.state.isFlyoutOpened&&this.setState(Object.assign(Object.assign({},this.state),{isCellRendered:!0,selectedIndex:0}))}_renderFooterFields(){let e=[];return e=this.props.overFlownFooterFields.map(e=>i.createElement(Pe.a,{key:e.Id,id:this.props.id,previewId:e.PreviewId,controlName:e.Name,ref:e.Id,cellSizeMode:0,shouldNotifyRenderComplete:!0,onRenderComplete:this._onCellsDidMount,style:this.props.cellStyle,scope:Te.a.EditForm})),e}render(){const e={height:this.props.overFlownFooterFields&&this.props.overFlownFooterFields.length>0?50*this.props.overFlownFooterFields.length:0},t=Object(O.c)(this.props.resourceStrings,"Web.Footer.MoreFields");let n,r;return this.state.isFlyoutOpened?(n=i.createElement(ot.a,{key:ht,id:ht,flyoutDirection:ot.b.upleft,relativeToElementId:pt,positionType:"relative",flyoutStyle:this.props.flyoutStyle,size:e,onOutsideClick:this._flyoutOutsideClickHandler,testhooks:{id:ht}},this._renderFooterFields()),r=this.state.isCellRendered?i.createElement($e.a,{key:"footerFieldsFlyoutAccessibility",rootElementId:ht,overrideFocusId:ht,shouldManageFocus:!0,waitForEditable:!1,keyboardShortcuts:this._createKeyboardShortcuts(),isModal:!0}):null):n=void 0,i.createElement(E.a,{key:gt,id:gt,ref:gt,role:we.r},i.createElement(lt.a,{key:mt,accessibilityLabel:t,tabIndex:0,onClick:this._toggleFlyout,style:this.props.expandButtonStyle,accessibilityExpanded:this.state.isFlyoutOpened,accessibilityHasPopup:!0,testhooks:{id:"footer_overflowButton"}},i.createElement(pe.b,{style:this.props.expandButtonIconStyle,id:pt,type:this.state.isFlyoutOpened?de.a.ChevronDown:de.a.ChevronUp})),i.createElement(E.a,{key:bt,id:bt,ownsElementId:this.state.isFlyoutOpened?ht:""},n,r))}}yt.displayName="FooterFieldsFlyout";const ft=Object(r.a)((function(){const e=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e=null,t=null;return function(n,r){const i=Object(v.a)(n);return t!==i&&(t=i,e={flyoutStyle:{borderWidth:"1px",borderColor:i.colors.BaseColor.White,borderStyle:"solid",padding:i.sizes.Measures.Measure100,width:"30rem",height:"auto",maxHeight:"23.75rem",boxShadow:i.shadows.Shadow01,backgroundColor:i.colors.BaseColor.White,flexDirection:"column",overflowY:"auto"},expandButtonStyle:{cursor:"pointer",borderWidth:0,padding:0,height:i.sizes.Measures.Measure200,width:i.sizes.Measures.Measure200,lineHeight:i.sizes.Measures.Measure200,backgroundColor:"transparent"},expandButtonIconStyle:{width:"100%",height:"100%",textAlign:"center"},cellStyle:{width:"100%",flex:"0 0 auto"}}),e}}(),t=Object(O.h)();return function(n,r){const i=e(n,r);return{resourceStrings:t(n,ut),flyoutStyle:i.flyoutStyle,expandButtonStyle:i.expandButtonStyle,cellStyle:i.cellStyle,expandButtonIconStyle:i.expandButtonIconStyle}}}))(yt);var St=n("cfbi"),vt=n("GEbX"),Ct=n("Knfm"),Ot=n("NPmm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const _t=Object(st.a)();function It(e){return i.createElement(lt.a,{key:"saveBtn",testhooks:{id:"edit-form-save-btn",[ze.a.LearningPathDOMAttributeSuffix]:"form-footer-saveBtn"},accessKey:"S",title:e.saveLabel,style:e.saveButtonStyle,onClick:e.save,accessibilityLabel:e.saveLabel,tabIndex:0},i.createElement(pe.b,{key:"icon",style:e.saveButtonIconStyle,id:_t,type:de.a.Save}),i.createElement(he.a,{key:"text",style:e.saveButtonLabelStyle},e.saveLabel))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const jt=Object(st.a)();class Pt extends i.Component{constructor(e){super(e),this._measuringFooter=this._measuringFooter.bind(this),this._onPopoutButtonClick=this._onPopoutButtonClick.bind(this),this.state={previousFooterFieldsWidth:0,maximumNumberOfControls:0,isSpaceAvailableForFields:!0,previousFooterHeight:0}}componentWillUpdate(e){this.props.isSaving&&!e.isSaving&&(this._saveStatusMessage=Object(O.c)(this.props.resourceStrings,nt.c))}_onPopoutButtonClick(e){this.props.openGridPage(this.props.entityTypeName)}_getFooterMessage(){return this.props.isSaving?this.props.savingChangesMessage:this.props.formDirty?this.props.unsavedChangesWarning:this.props.hasOfflineChanges?this.props.offlineChangesMessage:""}_isPopoutHidden(){return!(this.props.viewPortWidth>this.props.breakPointS&&this.props.clienthost!==R.a.MobileApplication&&this.props.navigationType===vt.a.SingleSession)}_measuringFooter(e){const t=[{name:"currentWidth",value:e}];if(e>0&&e!==this.state.previousFooterFieldsWidth){const n=Math.floor(e/(this.props.footerFieldMinimumCellWidth+this.props.cellContainerSpacerWidth)),r=!(e<250);t.push({name:"maxNumberOfControlsToDisplay",value:n},{name:"enoughSpaceForControls",value:r}),this.setState(Object.assign(Object.assign({},this.state),{previousFooterFieldsWidth:e,maximumNumberOfControls:n,isSpaceAvailableForFields:r}))}this.context.TraceManager.getTracer("Forms.FormFooter").debug("Measuring Footer",t)}_renderFooterFieldCells(){if(!this.props.footerFields)return null;this._overFlownFooterFields=[];return this.props.footerFields.map((e,t)=>{if(e.Id&&t<this.state.maximumNumberOfControls&&this.state.isSpaceAvailableForFields||0===t&&!this.state.isSpaceAvailableForFields)return i.createElement(E.a,{style:this.props.cellWrapperStyle},i.createElement(Pe.a,{key:e.Id,id:this.props.id,previewId:e.PreviewId,controlName:e.Name,cellSizeMode:0,style:this.props.cellStyle,scope:Te.a.Footer}));e.Id&&e.Visible&&this._overFlownFooterFields.push(e)})}_renderFooterFieldsFlyout(){return this._overFlownFooterFields&&this._overFlownFooterFields.length>0?i.createElement(ft,{overFlownFooterFields:this._overFlownFooterFields,id:this.props.id}):null}_renderFooterFields(){if(this.props.footerFields&&this.props.footerFields.length>0){let e=null;const t=i.createElement(E.a,{key:"footerFields",style:this.props.flyoutContainerStyle},this._renderFooterFieldCells(),this._renderFooterFieldsFlyout());return e=this.state.isSpaceAvailableForFields?t:i.createElement(E.a,{key:"footerFields",style:this.props.formFooterStyle,role:we.r,testhooks:{id:"FooterBar_ChildDiv"}},t),e}return null}_renderPopoutButton(){const e={entityTypeName:this.props.entityTypeName,id:this.props.entityId?q.a.parse(this.props.entityId.guid):null,newWindowOptions:{width:window.innerWidth,height:window.innerHeight}};return i.createElement(E.a,{key:"popoutButton",title:this.props.popoutButtonTooltip,style:this.props.popoutButtonWrapperStyle,role:we.r},i.createElement(it.a,{sourcePageId:this.props.id,pageName:St.a,input:e,target:it.b,style:this.props.footerPopoutLinkStyle,accessibilityLabel:this.props.popoutButtonTooltip},i.createElement(E.a,{id:"popout-btn",style:this.props.popoutButtonStyle,onClick:this._onPopoutButtonClick,accessibilityHidden:!0,role:we.r,testhooks:{id:"popout_btn"}},i.createElement(he.a,{style:this.props.popoutButtonIconStyle},i.createElement(pe.b,{id:jt,type:de.a.ExpandButton})))))}render(){if(this.props.clienthost===R.a.MobileApplication||this.props.clienthost===R.a.MailApp)return null;let e;if(this._getFooterMessage()&&(e=this._getFooterMessage(),this._saveStatusMessage=""),!this.props.isReady)return i.createElement(E.a,{style:this.props.formFooterStyle,role:we.r});const t=Object(O.c)(this.props.resourceStrings,nt.d);return i.createElement(E.a,{style:this.props.customRootStyle,id:this.props.domId,testhooks:{id:"form-footer",[Ue.b]:this.props.previewId,[Ue.c]:10}},i.createElement($e.a,{key:"formfooterAccessibility",shouldManageFocus:!1}),this.state.isSpaceAvailableForFields?null:this._renderFooterFields(),i.createElement(E.a,{key:"footerWrapper",id:"footerWrapper",style:this.props.formFooterWrapperStyle,testhooks:{id:"FooterBar_ParentDiv"}},i.createElement(E.a,{style:this.props.formFooterStyle},this._isPopoutHidden()?null:this._renderPopoutButton(),i.createElement(he.a,{testhooks:{id:"edit-form-status-message"},style:this.props.footerStatusStyle,role:we.s,accessibilityLabel:this.props.recordStatusMessage,key:"footerStatus"},this.props.recordStatusMessage),i.createElement(E.a,{key:"footerDivider",id:"footerDivider",style:this.props.footerDividerStyle}),i.createElement(E.a,{key:"fields",id:"footerFieldsContainer",style:this.props.footerFieldStyle,onMeasuring:this._measuringFooter,isRequestedMeasuring:!0},this.state.isSpaceAvailableForFields?this._renderFooterFields():null),i.createElement(E.a,{key:"action",style:this.props.footerActionAndStatusWrapperStyle},i.createElement(E.a,{key:"message",style:this.props.footerMessageContainerStyle,role:we.a,notificationType:rt.b},i.createElement(he.a,{style:this.props.statusStyle}," ",e||this._saveStatusMessage," ")),i.createElement(he.a,{key:"footerMessage",title:e,testhooks:{id:"edit-form-footer-message"},style:this.props.footerMessageStyle},e),i.createElement(Ot.a,{pageId:this.props.id},e=>i.createElement(It,{save:e,saveLabel:t,saveButtonStyle:this.props.saveButtonStyle,saveButtonIconStyle:this.props.saveButtonIconStyle,saveButtonLabelStyle:this.props.saveButtonLabelStyle}))))))}}Pt.displayName="FormFooter";const Ft=Object(r.a)((function(){const e=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e=null,t=null,n=!1,r=null,i=null;return function(a,s){const o=Object(f.j)(a,s.id),c=Object(v.a)(a),u=Object(l.kb)(a,s,o),d=s.viewPortWidth,p=s.hasFooterFields;return t===c&&n===u&&r===d&&i===p||(t=c,n=u,r=d,i=p,e={formFooterWrapperStyle:{opacity:1,maxHeight:c.sizes.Measures.Measure200,display:"flex",flex:"0 1 2rem",borderTopWidth:"1px",borderTopColor:c.colors.BaseColor.Grey.Grey3,borderTopStyle:"solid"},formFooterStyle:{overflow:"hidden",display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"100%",borderWidth:0,backgroundColor:c.colors.BaseColor.Grey.Grey3,paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0,position:"relative",bottom:"0px",justifyContent:"space-between",boxSizing:"border-box",height:c.sizes.Measures.Measure200},footerStatusStyle:{flex:"0 1 auto",color:c.colors.BaseColor.Grey.Grey7,marginLeft:c.sizes.Measures.Measure100,paddingTop:c.sizes.Measures.Measure050,paddingBottom:c.sizes.Measures.Measure050,paddingLeft:0,paddingRight:0,lineHeight:c.sizes.Measures.Measure100,fontSize:c.fontSizes.Font085},footerMessageStyle:{position:"relative",flexGrow:0,color:c.colors.BaseColor.Grey.Grey7,paddingTop:c.sizes.Measures.Measure050,paddingBottom:c.sizes.Measures.Measure050,marginLeft:c.sizes.Measures.Measure100,marginRight:c.sizes.Measures.Measure100,lineHeight:c.sizes.Measures.Measure100,fontSize:c.fontSizes.Font085,width:Math.min(.132*d,Object(b.a)(15)).toString()+"px",textAlign:"right",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},saveButtonStyle:{position:"relative",borderStyle:"none",backgroundColor:"transparent",color:c.colors.BaseColor.Grey.Grey7,display:u?"none":"flex",cursor:"pointer",paddingLeft:c.sizes.Measures.Measure050,paddingRight:c.sizes.Measures.Measure100,paddingTop:0,paddingBottom:0,lineHeight:c.sizes.Measures.Measure200,flexGrow:0,float:"right"},popoutButtonWrapperStyle:{height:c.sizes.Measures.Measure200,width:c.sizes.Measures.Measure200,paddingLeft:c.sizes.Measures.Measure050,paddingRight:c.sizes.Measures.Measure050,marginLeft:0,boxSizing:"content-box"},popoutButtonStyle:{display:"flex",height:"100%",width:"100%",position:"relative",borderStyle:"none",backgroundColor:"transparent",padding:0,paddingTop:c.sizes.Measures.Measure050,paddingBottom:c.sizes.Measures.Measure050,color:c.colors.BaseColor.Grey.Grey7,cursor:"pointer"},popoutButtonIconStyle:{height:"100%",width:"100%"},footerFieldStyle:{display:"flex",flexDirection:"row",justifyContent:"flex-start",marginRight:c.sizes.Measures.Measure100,marginLeft:0,flexGrow:15,width:0},footerPopoutLinkStyle:{textDecoration:"none",flexGrow:1,height:"100%",width:"100%"},flyoutContainerStyle:{display:"flex",flex:"1 1 0px",justifyContent:"flex-start",alignItems:"center"},footerFieldsFlyoutStyle:{borderColor:"#ffffff",borderWidth:"1px",borderStyle:"solid",borderTopWidth:0,paddingLeft:"15px",width:"300px",overflow:"auto",right:"10px",boxShadow:"4px 4px 2px #808080",backgroundColor:c.colors.BaseColor.White},cellWrapperStyle:{whiteSpace:"nowrap",flexGrow:1,width:c.sizes.HeaderFields.MaximumCellWidth,minWidth:"22rem"},cellStyle:{width:"100%",flex:"1 1 auto",minHeight:0,overflowY:"hidden",marginRight:c.sizes.Measures.Measure100,marginLeft:c.sizes.Measures.Measure100,color:"#fff"},footerMessageContainerStyle:{opacity:0,height:0,width:0},footerActionAndStatusWrapperStyle:{display:"flex",flexDirection:"row",justifyContent:"flex-end"},statusStyle:{color:c.colors.BaseColor.Grey.Grey7,fontSize:c.fontSizes.Font100},disabledSaveButtonStyle:{backgroundColor:"transparent",color:c.colors.BaseColor.Grey.Grey5},footerDividerStyle:{display:d<c.sizes.Breakpoints.DimensionM?"none":"flex",flex:"0 1 auto",width:"0.5px",height:d<c.sizes.Breakpoints.DimensionL?"16px":c.sizes.Measures.Measure100,marginTop:d<c.sizes.Breakpoints.DimensionL?"6px":c.sizes.Measures.Measure050,marginBottom:d<c.sizes.Breakpoints.DimensionL?"6px":c.sizes.Measures.Measure050,marginLeft:c.sizes.Measures.Measure100,marginRight:0,backgroundColor:c.colors.BaseColor.Grey.Grey4},saveButtonIconStyle:{width:c.sizes.Measures.Measure200,height:c.sizes.Measures.Measure200},saveButtonLabelStyle:{fontSize:c.fontSizes.Font085}}),e}}(),t=Object(l.dd)(),n=Object(O.h)();return function(r,i){const a=Object(f.j)(r,i.id),s=Object(m.g)(r,i.id),o=Object(v.a)(r),c=s,u=Object(l.jb)(r,i.id),d=Object(l.Nb)(r,i.id,a),p=t(r,{id:i.id,contextToken:a}),h=Object(y.c)(r),g=e(r,Object.assign(Object.assign({},i),{viewPortWidth:h,hasFooterFields:p&&p.length>0})),S=Object(Ie.a)(r,i.id)>je.a.Loading,C=Object(l.Vb)(r,i,a),O=n(r,nt.e),_=Object(B.a)(r),I=Object(Ct.a)(r);let j="",P=null;c&&(j=c.entityTypeName,P=c.id);const F=Object(l.mc)(r,i.id,O);return{isSaving:u,formDirty:d,footerFields:p,entityTypeName:j,entityId:P,formFooterWrapperStyle:g.formFooterWrapperStyle,formFooterStyle:g.formFooterStyle,footerStatusStyle:g.footerStatusStyle,footerMessageStyle:g.footerMessageStyle,saveButtonStyle:g.saveButtonStyle,footerFieldStyle:g.footerFieldStyle,cellWrapperStyle:g.cellWrapperStyle,cellStyle:g.cellStyle,footerMessageContainerStyle:g.footerMessageContainerStyle,popoutButtonWrapperStyle:g.popoutButtonWrapperStyle,popoutButtonStyle:g.popoutButtonStyle,popoutButtonIconStyle:g.popoutButtonIconStyle,footerFieldsFlyoutStyle:g.footerFieldsFlyoutStyle,flyoutContainerStyle:g.flyoutContainerStyle,footerPopoutLinkStyle:g.footerPopoutLinkStyle,footerActionAndStatusWrapperStyle:g.footerActionAndStatusWrapperStyle,statusStyle:g.statusStyle,disabledSaveButtonStyle:g.disabledSaveButtonStyle,footerDividerStyle:g.footerDividerStyle,saveButtonIconStyle:g.saveButtonIconStyle,saveButtonLabelStyle:g.saveButtonLabelStyle,isReady:S,hasOfflineChanges:C,recordStatusMessage:F,resourceStrings:O,viewPortWidth:h,breakPointS:o.sizes.Breakpoints.DimensionS,footerFieldMinimumCellWidth:Object(b.a)(o.sizes.FooterFields.MinimumCellWidthEm),clienthost:_,cellContainerSpacerWidth:o.sizes.FooterFields.CellContainerSpacerWidthPx,navigationType:I}}}),(function(e,t){return{openGridPage:n=>{e(Object(at.a)(n,t.id))}}}))(Pt);Pt.contextType=Me.a;var Tt=n("xy1J"),wt=n("QJW6"),Et=n("N6E8"),xt=n("Zzxs"),Nt=n("y3FQ"),At=n("eu2O"),kt=n("KOTC"),Mt=n("jSRx"),Dt=n("qFOq"),Rt=n("LTq1"),Bt=n("zJiL");function Lt(e){let t=Rt.c;switch(e.readOnlyState){case Dt.a.RecordPermissions:t=Rt.c;break;case Dt.a.EntityPermissions:t=Rt.b;break;case Dt.a.Offline:t=Rt.a;break;case Dt.a.RecordStatus:t=Rt.d}let n=Object(O.c)(e.resourceStrings,t);return t===Rt.d?n=n.replace("{0}",e.recordStatusMessage):t===Rt.b&&(n=n.replace("{0}",e.entityDisplayCollectionName)),n}const Vt=Object(r.a)((function(){const e=Object(O.h)(),t=Object(l.cd)();let n=null;return function(r,i){const a=Object(f.j)(r,i.id);Object(c.e)(n,a)||(n=a);const s=e(r,Rt.e),o=t(r,i,n);return{readOnlyState:Object(l.lb)(r,i,n),recordStatusMessage:Object(l.mc)(r,i.id,s),resourceStrings:s,enabledFormFCBs:o}}}))((function(e){if(!e.enabledFormFCBs.has(Ye.mb)||e.readOnlyState===Dt.a.NotReadOnly)return null;const t={Message:Lt(e),Level:Bt.c,UniqueId:"formReadOnlyNotification"};return i.createElement(Mt.a,{key:"formReadOnlyNotification",domWidth:e.domWidth,id:e.id,notification:t,notificationType:t.Level,shouldNotifyRenderComplete:!0,displayFullMessage:!0,onlyNotification:!0,onRenderComplete:()=>{}})}));var zt=n("H4dV"),Ht=n("PidC"),Gt=n("UIlN"),Wt=n("lSDC");const Ut=[Wt.a];var qt=n("0kGT"),Xt=n("miNs"),Yt=n("/aHX"),Kt=n("JEGW"),Qt=n("HfZT"),Zt=n("VnpK"),Jt=n("AVDU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const $t=Object(st.a)();function en({id:e,recordSetNavigatorCollapsed:t,shouldRenderRecordSetNavigatorButton:n,onToggleRecordSetNavigator:s,commandBarStyle:o,collapseExpandButtonStyle:c,collapseExpandButtonTextStyle:l}){const u=i.useRef(),d=i.useCallback(e=>{s(),a.findDOMNode(u.current).focus()},[s,u]),p=i.useContext(gn),h=Object(r.d)(ye.g),g=Object(O.c)(p,tt.l);let m=t?h?de.a.BackwardButton:de.a.ForwardButton:h?de.a.ForwardButton:de.a.BackwardButton;Object(r.d)(Jt.d)&&(m=de.a.CustomList);const b=o&&o.commandBarRefreshProps&&o.commandBarRefreshProps.isRefreshedCommandBarFCBEnabled&&!Object(Zt.n)(),y=Object(Ge.h)(de.a[m],b,!1,null,null,Object(N.g)($t,e),{id:"recordSetNavExpandIcon"});return b&&(l.display="flex",l.alignItems="center",c.display="flex",c.alignItems="center"),n&&i.createElement(lt.a,Object.assign({id:Object(N.g)("collapseExpandBtn",e),ref:u,tabIndex:0,accessKey:t?"X":"L",accessibilityLabel:g,onClick:d,style:c,accessibilityExpanded:t},{[ze.a.LearningPathDOMAttributeName]:"form-recordset-navigator"}),i.createElement(he.a,{style:l},y))}var tn=n("uNu9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const nn=42,rn=42;function an({id:e,hasCmdbar:t,recordSetNavigatorCollapsed:n,viewPortWidth:a,smallBreakPoint:s,numberOfAvailableRecords:o,commandBarStyle:c,commandManagerStyle:u,commandManagerContainerStyle:d,tabBackButtonStyle:p,collapseExpandButtonWrapperStyle:h,collapseExpandButtonStyle:g,collapseExpandButtonTextStyle:b}){const y=i.useContext(gn),f=Object(r.d)(qt.b),S=Object(r.d)(t=>Object(l.Ib)(t,e)),v=Object(r.c)(),C=Object(r.d)(t=>Object(m.g)(t,e)),O=Object(r.d)(Ct.a)===vt.a.MultiSession,_=C&&C.recordSetQueryKey,I=_&&_.split("-")[0],j=Object(r.d)(e=>Object(Xe.c)(e,Ye.h)),P=Object(r.d)(e=>Object(Xe.c)(e,Ye.Sc)),F=Object(r.d)(e=>Object(Xe.c)(e,Ye.gd)),T=P||F&&j,w=(I!==tn.Bb||I===tn.Bb&&T)&&o>1&&!O,E=i.useCallback(()=>{v(Object(Kt.b)(!n)),_&&n&&v(Object(Qt.g)(null,_))},[v,_,n]);return f&&!S?i.createElement(ln,{id:e,shouldRenderRecordSetNavigatorButton:w,commandBarStyle:c,commandManagerStyle:u}):t&&i.createElement(sn,{id:e,recordSetNavigatorCollapsed:n,shouldRenderRecordSetNavigatorButton:w,viewPortWidth:a,smallBreakPoint:s,resourceStrings:y,onToggleRecordSetNavigator:E,commandManagerContainerStyle:d,collapseExpandButtonWrapperStyle:h,tabBackButtonStyle:p,commandBarStyle:c,commandManagerStyle:u,collapseExpandButtonStyle:g,collapseExpandButtonTextStyle:b})}function sn({id:e,recordSetNavigatorCollapsed:t,shouldRenderRecordSetNavigatorButton:n,viewPortWidth:r,smallBreakPoint:a,resourceStrings:s,onToggleRecordSetNavigator:o,commandManagerContainerStyle:c,collapseExpandButtonWrapperStyle:l,tabBackButtonStyle:u,commandBarStyle:d,commandManagerStyle:p,collapseExpandButtonStyle:h,collapseExpandButtonTextStyle:g}){return i.createElement(E.a,{key:"commandBarContainer",style:c},i.createElement(cn,{id:e,tabBackButtonStyle:u}),i.createElement(E.a,{key:"recordSetNavBtnWrapper",title:t?Object(O.c)(s,tt.m):Object(O.c)(s,tt.k),style:l,onKeyDown:on(o)},r>a&&i.createElement(en,{id:e,recordSetNavigatorCollapsed:t,shouldRenderRecordSetNavigatorButton:n,onToggleRecordSetNavigator:o,commandBarStyle:d,collapseExpandButtonStyle:h,collapseExpandButtonTextStyle:g})),i.createElement(ln,{id:e,shouldRenderRecordSetNavigatorButton:n,commandBarStyle:d,commandManagerStyle:p}))}function on(e){return t=>{t.keyCode===Xt.a.Enter&&e()}}function cn({id:e,tabBackButtonStyle:t}){const n=Object(r.d)(e=>Object(Jt.d)(e));return!Object(r.d)(t=>Object(m.f)(t,e))&&n?i.createElement(Yt.a,{pageId:e,overwriteStyle:t}):null}function ln({id:e,shouldRenderRecordSetNavigatorButton:t,commandBarStyle:n,commandManagerStyle:a}){const s=i.useContext(gn),o=Object(r.c)(),c={id:e},u=Object(r.d)(e=>Object(We.f)(e,c)),d=Object(r.d)(t=>Object(m.g)(t,e)).entityTypeName,p=i.useMemo(()=>{const e={entityTypeName:d};return Object(f.i)(e)},[d]),h=Object(r.d)(Gt.d),g=Object(r.d)(e=>Object(l.rb)(e,c,p)),b=Object(r.d)(Jt.d),y=i.useMemo(()=>o(function(e,t,n){return{type:"generate.injected.button",sync:!0,execute(r,i){const a=[];return Ut.forEach(s=>{const o=s(r,i,e,t,n);o&&a.push(o)}),a}}}(e,p,s)),[o,e,p,s]),S=Object(r.d)(t=>Object(l.Ib)(t,e));if(!h||!u)return null;let v=g;return b&&(v-=rn),t&&(v-=nn),i.createElement(He.a,{key:e,commandbarDisplayMode:Ge.a.IconLabel,iconPosition:pe.a.Left,id:e,width:v,addedCommandList:y,ribbonId:u,commandBarStyle:n,customCommandManagerStyle:a,commandManagerId:e,isCommandBarRefreshForceEnabled:!0,isMainFormDialog:S})}var un=n("RJiR");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let dn=0;class pn extends i.Component{constructor(e){super(e),this._mainSectionElement=null,this._scrollHandlerAdded=!1,this._previousTabScrollTop=0,this._previousScrollingDown=!1,this._scheduledAnimationFrame=!1,this._lastScrollHandlerExecutionTime=0,this._focusInHandlerAdded=!1,this._mainElementFocusInHandlerAdded=!1,this._scrollPositionSet=!1,this._focusedElementSet=!1,this._getControlName=e=>{for(;null!=e;){const t=e.attributes.getNamedItem("data-control-name");if(t)return t.value;if("mainContent"===e.id)return null;e="HTML"===e.tagName&&null!==e.ownerDocument&&null!==e.ownerDocument.defaultView&&null!==e.ownerDocument.defaultView.frameElement?e.ownerDocument.defaultView.frameElement.parentElement:e.parentElement}},this._updateScrollBarVisible=()=>{const e=document.getElementById(this.props.mainSectionId),t=e&&e.scrollHeight>e.clientHeight;t!==this.state.scrollBarVisible&&this.setState({scrollBarVisible:t})},this._mainSectionMountCallback=this._mainSectionMountCallback.bind(this),this._tabPlaceholdMeasuringCallback=this._tabPlaceholdMeasuringCallback.bind(this),this._outerheaderContainerOnMeasuring=this._outerheaderContainerOnMeasuring.bind(this),this._onKeyDownHandler=this._onKeyDownHandler.bind(this),this._mainSectionMeasuringCallback=this._mainSectionMeasuringCallback.bind(this),this._formNotificationMeasuringCallback=this._formNotificationMeasuringCallback.bind(this),this._setFormNotificationHeight=this._setFormNotificationHeight.bind(this),this._afterSelectTab=this._afterSelectTab.bind(this),this._onScrollThrottler=this._onScrollThrottler.bind(this),this._focusInHandler=this._focusInHandler.bind(this),this._iframeFocusInHandler=this._iframeFocusInHandler.bind(this),this._mainElementFocusHandler=this._mainElementFocusHandler.bind(this),this._showFooterFieldsRenderInSection=this._showFooterFieldsRenderInSection.bind(this),this.state={sizeMode:null!=e.initialSizeMode?e.initialSizeMode:null,numberOfRow:null,tabScrolledToTop:!0,tabScrolledToBottom:!1,headerCollapsed:!1,headerShadowVisible:!1,formNotificationSize:0,scrollBarVisible:!0},this._lastScrollHandlerExecutionTime=Date.now(),0!==dn||e.enabledFormFCBs.has(Ye.mb)||(dn=hn()),this._mainElementFocusInHandlerAdded=!this.props.enabledFormFCBs.has(Ye.kb),this._scrollPositionSet=!this.props.formScrollAndFocusState||null==this.props.formScrollAndFocusState.scrollTopPosition,this._focusedElementSet=!this.props.formScrollAndFocusState||null==this.props.formScrollAndFocusState.focusedControlName,this._currentScrollAndFocusState={},this._iframesWithFocusHandlerAdded={}}_renderFormHeaderCommandBar(){return this.props.showCommandBar?i.createElement(an,{id:this.props.id,hasCmdbar:this.props.hasCmdbar,recordSetNavigatorCollapsed:this.props.recordSetNavigatorCollapsed,viewPortWidth:this.props.viewPortWidth,smallBreakPoint:this.props.smallBreakPoint,numberOfAvailableRecords:this.props.numberOfAvailableRecords,commandBarStyle:this.props.commandBarStyle,commandManagerStyle:this.props.commandManagerStyle,commandManagerContainerStyle:this.props.commandManagerContainerStyle,tabBackButtonStyle:this.props.tabBackButtonStyle,collapseExpandButtonWrapperStyle:this.props.collapseExpandButtonWrapperStyle,collapseExpandButtonStyle:this.props.collapseExpandButtonStyle,collapseExpandButtonTextStyle:this.props.collapseExpandButtonTextStyle}):null}_renderFormHeaderBody(){return this.props.enabledFormFCBs.has(Ye.mb)?i.createElement(kt.a,{loader:()=>n.e(63).then(n.bind(null,"ekyV")).then(e=>e.FormHeaderV2),props:{id:this.props.id,headerCollapsed:this.state.headerCollapsed,domId:this.props.descriptor&&this.props.descriptor.Header&&this.props.descriptor.Header.DomId,previewId:this.props.descriptor&&this.props.descriptor.Header&&this.props.descriptor.Header.PreviewId,visible:this.props.showHeaderBody}}):i.createElement(Je,{id:this.props.id,key:Object(N.g)("form-header",this.props.id),headerCollapsed:this.state.headerCollapsed,domId:Object(N.g)(this.props.descriptor&&this.props.descriptor.Header&&this.props.descriptor.Header.DomId,this.props.id),previewId:this.props.descriptor&&this.props.descriptor.Header&&this.props.descriptor.Header.PreviewId,visible:this.props.showHeaderBody})}_renderFormHeaderTabNavigator(){var e;return this.props.showTabNavigator?this.props.enabledFormFCBs.has(Ye.sc)&&this.props.isInMobileNativeApr2020?i.createElement(kt.a,{loader:()=>n.e(79).then(n.bind(null,"gJPS")).then(e=>e.MobileScrollableTabs),props:{renderHeaderFields:this.props.hasHeaderFields,renderFooterFields:this.props.hasFooterFields,id:this.props.id,availableTabs:this.props.availableTabs,tabStyle:this.props.tabCustomStyle,columnStyle:this.props.columnStyle,sectionStyle:this.props.sectionStyle,cellStyle:this.props.cellStyle,showFooterFieldsRenderInSection:this._showFooterFieldsRenderInSection(),sizeMode:this.state.sizeMode,headerCollapsed:this.state.headerCollapsed,afterSelectTab:this._afterSelectTab,returnTabsBody:!1,enabledFormFCBs:this.props.enabledFormFCBs,isRTL:this.props.isRTL}}):i.createElement(D,{renderHeaderFields:this.props.hasHeaderFields,renderFooterFields:this.props.hasFooterFields,key:(null===(e=this.props.descriptor)||void 0===e?void 0:e.TabNames)+"_tabControl",id:this.props.id,ref:Object(N.g)("tablistRef",this.props.id),availableTabs:this.props.availableTabs,tabStyle:this.props.tabCustomStyle,columnStyle:this.props.columnStyle,sectionStyle:this.props.sectionStyle,cellStyle:this.props.cellStyle,showFooterFieldsRenderInSection:this._showFooterFieldsRenderInSection(),sizeMode:this.state.sizeMode,headerCollapsed:this.state.headerCollapsed,afterSelectTab:this._afterSelectTab,returnTabsBody:!1,enabledFormFCBs:this.props.enabledFormFCBs,initialWidth:this._previousMainSectionWidth}):null}_renderFormHeader(){var e,t,n;if(this.props&&this.props.id){if(this.props.isFormComponentInstance)return;return this.props.showLoadingIndicator?i.createElement(Je,{id:this.props.id,key:Object(N.g)("form-header",this.props.id)}):i.createElement(E.a,{id:Object(N.g)("outerHeaderContainer",this.props.id),style:this._getHeaderContainerStyle(),ref:Object(N.g)("outerHeaderContainer",this.props.id),onMeasuring:this._outerheaderContainerOnMeasuring,isRequestedMeasuring:!0},this._renderFormHeaderCommandBar(),this._renderFormNotifications(),this._renderFormHeaderBody(),(null===(e=this.props.pageInput)||void 0===e?void 0:e.bodyOnly)?null:this._renderBusinessProcessFlow(ae.BreadCrumb),this._renderFormHeaderTabNavigator(),(null===(t=this.props.pageInput)||void 0===t?void 0:t.bodyOnly)||this.props.enabledFormFCBs.has(Ye.mb)?null:i.createElement(G,{headerCollapsed:this.state.headerCollapsed,tabScrolledToTop:this.state.tabScrolledToTop,id:this.props.id,hasCmdBar:this.props.hasCmdbar,formNotificationHeight:this.state.formNotificationSize}),this.props.enabledFormFCBs.has(Ye.mb)&&this._isHeaderSticky&&this.state.headerShadowVisible&&!(null===(n=this.props.pageInput)||void 0===n?void 0:n.bodyOnly)?i.createElement(E.a,{id:"shadow",style:this.props.headerShadowV2Style}):null)}}_renderFormFooter(){return this.props.isMainFormDialog||!this.props.showFooter?null:this.props.isFormComponentInstance?void 0:(this.props.showLoadingIndicator||null!==this.state.sizeMode&&this.props.viewPortWidth>0&&this.props.viewPortWidth>=this.props.largeBreakPoint)&&this.props&&this.props.id&&this.props.pageInput&&!this.props.pageInput.bodyOnly?i.createElement(Ft,{contextToken:this.props.contextToken,id:this.props.id,key:this.props.id,domId:Object(N.g)(this.props.descriptor&&this.props.descriptor.Footer&&this.props.descriptor.Footer.DomId,this.props.id),previewId:this.props.descriptor&&this.props.descriptor.Footer&&this.props.descriptor.Footer.PreviewId,formValid:this.props.isFormValid,saveLabel:Object(O.c)(this.props.resourceStrings,tt.p),readOnlyMessage:Object(O.c)(this.props.resourceStrings,tt.j),unsavedChangesWarning:Object(O.c)(this.props.resourceStrings,tt.s),offlineChangesMessage:Object(O.c)(this.props.resourceStrings,tt.h),savingChangesMessage:Object(O.c)(this.props.resourceStrings,tt.q),popoutButtonTooltip:Object(O.c)(this.props.resourceStrings,tt.i),saveErrorLabel:Object(O.c)(this.props.resourceStrings,Tt.e)}):null}_getHeaderContainerStyle(){if(this.props.enabledFormFCBs.has(Ye.mb))return this.props.headerContainerStyle;const e={};return dn>0&&this.state.scrollBarVisible&&(e.width=`calc(100% - ${dn}px)`),this.state.headerCollapsed&&(e.height=0),Object.assign(Object.assign({},this.props.headerContainerStyle),e)}_renderFormNotifications(){if(this.props.shouldFormNotificationBarRender){const e={marginTop:0};return i.createElement(E.a,{style:{height:"auto",minHeight:this.state.formNotificationSize+"px",borderBottom:"1px solid rgb(216, 216, 216)",flexDirection:"column"}},i.createElement(Vt,{id:this.props.id,domWidth:this._domWidth,entityDisplayCollectionName:this.props.entityDescriptor.DisplayCollectionName}),this.props.formNotificationIds&&this.props.formNotificationIds.length>0?i.createElement(et.a,{key:"formNotificationList",id:this.props.id,domWidth:this._domWidth,component:this.props.rootElementId,customStyle:e,headerCollapsed:this.state.headerCollapsed,buttonMeasuringCallback:this._formNotificationMeasuringCallback,setFormNotificationHeight:this._setFormNotificationHeight}):null)}return 0!==this.state.formNotificationSize&&this.setState(Object.assign(Object.assign({},this.state),{formNotificationSize:0})),i.createElement(E.a,{style:{height:0},role:we.a,accessibilityLive:"assertive"})}_renderBusinessProcessFlow(e){if(this.props.isFormComponentInstance||this.props.bpfDisabled)return null;if(this.props.descriptor){const t={display:"flex",flexShrink:0},n=this.props.viewPortWidth<=this.props.smallBreakPoint?"translateY(-2.25rem)":"translateY(-3.75rem)",r={"background-color":this.props.theme.colors.WhiteBackground,width:"100%",height:this.props.bpfControlRendered?"4em":"0rem",zIndex:2,transition:L.c,transform:this.state.headerCollapsed?n:"none"};return this.props.bpfControlRendered||(r.display="none"),i.createElement(E.a,{key:ae[e],style:t,id:"processControl"+ae[e],accessibilityHidden:!!this.state.headerCollapsed||void 0},i.createElement(ce,{renderingMode:e,id:this.props.id,key:"businessProcessFlow",contextToken:this.props.contextToken,breadCrumbContainerStyle:r}))}return null}_focusInHandler(e){const t=e&&e.target&&e.target,n=e&&e.relatedTarget&&e.relatedTarget,r=a.findDOMNode(this.refs[Object(N.g)("outerHeaderContainer",this.props.id)]),i=n&&r&&r.contains(n),s=a.findDOMNode(this.refs[Object(N.g)("tablistRef",this.props.id)]);if(this.props.enabledFormFCBs.has(Ye.kb)&&(this._currentScrollAndFocusState.focusedControlName=this._getControlName(t)),t&&s&&t.getBoundingClientRect()&&s.getBoundingClientRect()&&t&&n&&t!==n&&!n.contains(t)&&!i){const e=t.getBoundingClientRect().top-s.getBoundingClientRect().bottom;if(e<0&&this._mainSectionElement){let t=this._mainSectionElement.scrollTop;t+=Math.min(0,3*e),t<25&&(t=0),this._mainSectionElement.scrollTop=t}}}_onScrollThrottler(e){if(!this._scheduledAnimationFrame)if(zt.a.getInstance().get_IsAndroid())requestAnimationFrame(this._scrollHandler.bind(this)),this._scheduledAnimationFrame=!0;else{const e=Date.now();e-this._lastScrollHandlerExecutionTime>=100&&(requestAnimationFrame(this._scrollHandler.bind(this)),this._scheduledAnimationFrame=!0,this._lastScrollHandlerExecutionTime=e)}}_scrollHandler(){let e=this.state.headerCollapsed,t=this.state.headerShadowVisible;const n=this._mainSectionElement,r=n.scrollTop;if(r!==this._previousTabScrollTop){const i=r<=0,a=n.scrollHeight-r<=n.offsetHeight,s=r>this._previousTabScrollTop;if(s!==this._previousScrollingDown){const t=r>=this.props.headerSpacerHeightInPx-this.props.headerCollapsedHeightInPx;(s&&t||!s)&&(s&&!i||!s&&!a)&&(this._previousScrollingDown=s,e=s)}s&&(t=!0);const o=i!==this.state.tabScrolledToTop,c=a!==this.state.tabScrolledToBottom,l=e!==this.state.headerCollapsed,u=t!==this.state.headerShadowVisible;if(o||c||l||u){const n={};i!==this.state.tabScrolledToTop&&(n.tabScrolledToTop=i),a&&!this.state.tabScrolledToBottom?(n.tabScrolledToBottom=!0,this.props.updateFormViewPortSizes(this.props.contextToken,this._previousMainSectionWidth,this._getNewViewPortHeight(this._previousMainSectionHeight))):!a&&this.state.tabScrolledToBottom&&(n.tabScrolledToBottom=!1,this.props.updateFormViewPortSizes(this.props.contextToken,this._previousMainSectionWidth,this._previousMainSectionHeight)),l&&!this.props.enabledFormFCBs.has(Ye.mb)&&(n.headerCollapsed=e),u&&this.props.enabledFormFCBs.has(Ye.mb)&&(n.headerShadowVisible=t),this.setState(Object.assign(Object.assign({},this.state),n))}}this._previousTabScrollTop=r,this._scheduledAnimationFrame=!1}_renderTabs(){var e;return this.props.descriptor&&this.props.descriptor.TabNames?this.props.enabledFormFCBs.has(Ye.mb)||this.props.isFormComponentInstance?this._renderTabsBody():i.createElement(E.a,{semanticTag:"section",style:{width:"100%",display:"flex",flexDirection:"column",flex:"1 0 auto",position:"relative"}},(null===(e=this.props.pageInput)||void 0===e?void 0:e.bodyOnly)&&!this.props.hasCmdbar?null:i.createElement(E.a,{style:this._getTransformedHeaderSpacerStyle(this.props.headerSpacerStyle)}),this._renderTabsBody()):null}_renderTabsBody(){var e;return this.props.enabledFormFCBs.has(Ye.sc)&&this.props.isInMobileNativeApr2020?i.createElement(kt.a,{loader:()=>n.e(79).then(n.bind(null,"gJPS")).then(e=>e.MobileScrollableTabs),props:{renderHeaderFields:this.props.hasHeaderFields,renderFooterFields:this.props.hasFooterFields,id:this.props.id,availableTabs:this.props.availableTabs,tabStyle:this.props.tabCustomStyle,columnStyle:this.props.columnStyle,sectionStyle:this.props.sectionStyle,cellStyle:this.props.cellStyle,showFooterFieldsRenderInSection:this._showFooterFieldsRenderInSection(),sizeMode:this.state.sizeMode,returnTabsBody:!0,viewportElementId:this.props.mainSectionId,enabledFormFCBs:this.props.enabledFormFCBs}}):i.createElement(D,{renderHeaderFields:this.props.hasHeaderFields,renderFooterFields:this.props.hasFooterFields,key:(null===(e=this.props.descriptor)||void 0===e?void 0:e.TabNames)+"_tabControl2",id:this.props.id,availableTabs:this.props.availableTabs,tabStyle:this.props.tabCustomStyle,columnStyle:this.props.columnStyle,sectionStyle:this.props.sectionStyle,cellStyle:this.props.cellStyle,showFooterFieldsRenderInSection:this._showFooterFieldsRenderInSection(),sizeMode:this.state.sizeMode,returnTabsBody:!0,viewportElementId:this.props.mainSectionId,enabledFormFCBs:this.props.enabledFormFCBs})}_renderOverlay(){if(this.props.showSavingIndicator||this.props.isMainFormDialog&&this.props.showLoadingIndicator){let e=Object(O.c)(this.props.resourceStrings,this.props.showSavingIndicator?tt.r:tt.e);return this.props.isInMobileNative&&(e=null),i.createElement(E.a,{style:this.props.overlayStyle},i.createElement(he.a,{style:this.props.overlayTextStyle},e))}return null}_getTransformedHeaderSpacerStyle(e){if(!e||!e.height||!this.state.formNotificationSize)return e;const t=e.height.split("rem");return t&&0!==t.length?Object.assign(Object.assign({},e),{height:parseFloat(t[0])+Object(b.b)(this.state.formNotificationSize)/3+"rem"}):e}_formNotificationMeasuringCallback(e,t){this.props.formNotificationIds&&1!==this.props.formNotificationIds.length||this._setFormNotificationHeight(t)}_setFormNotificationHeight(e){Math.abs(e-this.state.formNotificationSize)>1&&(e<40&&(e=At.a),this.setState(Object.assign(Object.assign({},this.state),{formNotificationSize:e})))}_mainSectionMeasuringCallback(e,t){const n=e<this.props.mediumBreakPoint?2:e<=this.props.largeBreakPoint?1:0;n!==this.state.sizeMode&&this.setState({sizeMode:n}),this.props.enabledFormFCBs.has(Ye.mb)&&this._updateIsHeaderSticky(e,t),this._previousMainSectionHeight=t,this._previousMainSectionWidth=e,!this.props.isFormComponentInstance&&this.props.updateFormViewPortSizes(this.props.contextToken,e,this._getNewViewPortHeight(t)),this.props.enabledFormFCBs.has(Ye.mb)||(dn=hn())}_updateIsHeaderSticky(e,t){(!this.props.isInMobileNative||this.props.isMainFormDialog)&&e>Ht.a?this._previousMainSectionWidth!==e&&(this._isHeaderSticky=!(e<=700&&t<=300&&0!==t)):this._isHeaderSticky=!1}_getNewViewPortHeight(e){let t=e;const n=this.props.clientHost===R.a.MobileApplication;return(!n&&2===this.state.sizeMode&&this.state.tabScrolledToBottom||n&&this.state.tabScrolledToBottom)&&(t-=Object(b.d)("footerWrapper")),(!this.props.enabledFormFCBs.has(Ye.mb)||this.props.enabledFormFCBs.has(Ye.mb)&&!this._isHeaderSticky)&&(t-=this._previousHeaderHeight),t}_onKeyDownHandler(e){e&&e.keyCode&&e.keyCode===h.a.Escape&&this.props.cancelForm(this.props.pageInput,this.props.output)}_getDefaultFocusId(){if(this.props.isMainFormDialog)return Object(Nt.b)(this.props.id);if(this.props.pageInput&&this.props.pageInput.bodyOnly&&this.props.selectedRelatedEntity)return this.props.viewSelectorDOMId;if(this.props.descriptor&&this.props.descriptor.Tabs&&this.props.selectedTab){const e=this.props.descriptor.Tabs;for(let t=0;t<e.length;t++)if(e[t].Id===this.props.selectedTab)return Object(N.g)(e[t].Id,this.props.id)}else if(this.props.selectedRelatedEntity)return Object(N.g)(A.a,this.props.id)}_tabPlaceholdMeasuringCallback(e,t){const n=parseInt((t/Object(b.a)(this.props.tabPlaceholdRowHeightEm)).toString(),10)-1;this.setState(Object.assign(Object.assign({},this.state),{numberOfRow:n}))}_outerheaderContainerOnMeasuring(e,t){const n=document.getElementById(Object(N.g)("outerHeaderContainer",this.props.id));n&&(this._domWidth=n.offsetWidth,this._previousHeaderHeight!==t&&(this._previousHeaderHeight=t,!this.props.isFormComponentInstance&&this.props.updateFormViewPortSizes(this.props.contextToken,this._previousMainSectionWidth,this._getNewViewPortHeight(this._previousMainSectionHeight))))}_renderRowPlacehold(){const e=[];if(!this.state||!this.state.numberOfRow)return e;for(let t=0;t<this.state.numberOfRow;t++)e.push(i.createElement(E.a,{style:this.props.rowPlaceholdContainerStyle},i.createElement(E.a,{key:"sectionColumn1Placehold",style:this.props.sectionColumn1PlaceholdStyle},i.createElement(E.a,{style:this.props.rowPlaceholdStyle})),i.createElement(E.a,{key:"sectionColumn2Placehold",style:this.props.sectionColumn2PlaceholdStyle},i.createElement(E.a,{style:this.props.rowPlaceholdStyle}))));return e}_renderLoadingExperience(){return i.createElement(E.a,{testhooks:{id:Et.a},semanticTag:"form",id:this.props.rootElementId,style:this.props.formGeneralStyle,role:we.r},i.createElement(E.a,{style:this.props.formMainSectionStyle},i.createElement(E.a,{style:this.props.mainContentStyle},this.props.viewPortWidth<=this.props.smallBreakPoint||!this.props.hasCmdbar?null:i.createElement(E.a,{id:"commandBarPlacehold",key:Object(N.g)("commandBarPlacehold",this.props.id),style:this.props.commandBarPlaceholdStyle}),this._renderFormHeader(),i.createElement(E.a,{key:Object(N.g)("bpfPlacehold",this.props.id),id:Object(N.g)("bpfPlacehold",this.props.id),style:this.props.bpfPlaceholdStyle}),this.props.hasCmdbar?i.createElement(E.a,{key:Object(N.g)("tabNavPlacehold",this.props.id),id:Object(N.g)("tabNavPlacehold",this.props.id),style:this.props.tabNavPlaceholdStyle}):null,i.createElement(E.a,{id:Object(N.g)("tab-section-placeholder",this.props.id),key:Object(N.g)("tab-section-placeholder",this.props.id),style:this.props.mainSectionPlaceholdStyle},i.createElement(E.a,{key:"tabPlacehold",style:this.props.tabPlaceholdStyle,isRequestedMeasuring:!0,onMeasuring:this._tabPlaceholdMeasuringCallback},i.createElement(E.a,{key:"legendPlaceholdContainer",style:this.props.legendPlaceholdContainerStyle},i.createElement(E.a,{key:"legendPlacehold",style:this.props.legendPlaceholdStyle})),i.createElement(E.a,{key:"sectionContainerPlacehold",style:this.props.sectionContainerPlaceholdStyle},this._renderRowPlacehold()))))),this._renderFormFooter(),i.createElement($e.a,{key:Object(N.g)("editformAccessibility",this.props.id),rootElementId:Object(N.g)("editFormRoot",this.props.id),isModal:!1,shouldManageFocus:!0}),this._renderOverlay())}_createKeyboardShortcuts(){const e=[];if(!this.props.isFormComponentInstance){const t=Object(O.c)(this.props.resourceStrings,nt.a),n=Object(O.c)(this.props.resourceStrings,nt.b),r=this._shortcutHandler.bind(this),i=new ct.a([h.a.Ctrl,h.a.S],r,!0,t,n);e.push(i)}return e}_shortcutHandler(e){const t=e.EVENT;t.preventDefault(),t.ctrlKey&&t.keyCode===h.a.S&&!this.props.hasActiveDialogOnTop&&(this._clearFormNotification(xt.b),this.props.saveForm(this.props.pageInput))}_clearFormNotification(e){e&&this.props.formNotificationIds.indexOf(e)>=0&&this.props.clearFormNotification(this.props.contextToken,e)}static _addPreviewAttribute(e,t){e.setAttribute("data-"+Ue.b,t)}_mainSectionMountCallback(e){let t;e&&(this._scrollHandlerAdded&&this._focusInHandlerAdded&&this._mainElementFocusInHandlerAdded||(t=a.findDOMNode(e),t&&(this._mainSectionElement=t,this._scrollHandlerAdded||(t.addEventListener("scroll",this._onScrollThrottler),this._scrollHandlerAdded=!0),this._focusInHandlerAdded||(t.addEventListener("focusin",this._focusInHandler),this._focusInHandlerAdded=!0),this._mainElementFocusInHandlerAdded||(document.getElementById("mainContent").addEventListener("focusin",this._mainElementFocusHandler),this._mainElementFocusInHandlerAdded=!0))),this.props.pageInput&&this.props.pageInput.isPreview&&(t||(t=a.findDOMNode(e)),t&&this.props.formId&&pn._addPreviewAttribute(t,`${Ue.a}${this.props.formId.guid}-${Ue.d}-mainSection`)))}_rootMountCallback(e){if(e&&this.props.pageInput&&this.props.pageInput.isPreview){const t=a.findDOMNode(e);t&&this.props.formId&&pn._addPreviewAttribute(t,`${Ue.a}${this.props.formId.guid}`)}}_afterSelectTab(){this.setState(Object.assign(Object.assign({},this.state),{headerCollapsed:!1,tabScrolledToTop:!0})),this._mainSectionElement.scrollTop=0}_showFooterFieldsRenderInSection(){return this.props.viewPortWidth<=this.props.largeBreakPoint&&!(this.props.clientHostSubtype===xe.a.Phone&&!this.props.isFooterAvailableForPhone)}_renderMainSection(){const e="backgroundContainer-"+this.props.id;return i.createElement(E.a,{id:this.props.mainSectionId,ref:e=>this._mainSectionMountCallback(e),key:Et.c,style:this.props.tabGeneralStyle,isRequestedMeasuring:!0,onMeasuring:this._mainSectionMeasuringCallback},!this.props.isFormComponentInstance&&this.props.isInMobileNative&&!this.props.isMainFormDialog&&i.createElement(un.b,{id:this.props.mainSectionId}),this.props.enabledFormFCBs.has(Ye.mb)&&!this._isHeaderSticky&&!this.props.isFormComponentInstance&&this._renderFormHeader(),null!==this.state.sizeMode&&i.createElement(E.a,{id:e,style:this.props.tabHeaderBodyContainerStyle},this._renderTabs()))}componentDidUpdate(){zt.a.getInstance().get_IsBrowserFirefox()&&(null!=this._scrollBarVisibleInitialTimeoutId&&clearTimeout(this._scrollBarVisibleInitialTimeoutId),null!=this._scrollBarVisibleDelayedTimeoutId&&clearTimeout(this._scrollBarVisibleDelayedTimeoutId),this._scrollBarVisibleInitialTimeoutId=setTimeout(this._updateScrollBarVisible),this._scrollBarVisibleDelayedTimeoutId=setTimeout(this._updateScrollBarVisible,1e3)),this.props.enabledFormFCBs.has(Ye.kb)&&(this._focusedElementSet||null!=document.querySelector("[data-control-name="+this.props.formScrollAndFocusState.focusedControlName+"]")&&(this.props.setFocus(this.props.id,this.props.contextToken,this.props.formScrollAndFocusState.focusedControlName),this._focusedElementSet=!0),this._scrollPositionSet||(this._mainSectionElement.scrollTop=this.props.formScrollAndFocusState.scrollTopPosition,this._scrollPositionSet=this._mainSectionElement.scrollTop===this.props.formScrollAndFocusState.scrollTopPosition),null!=this._mainSectionElement&&this._addFocusHandlersForIframes(this._mainSectionElement.getElementsByTagName("iframe")))}componentWillUnmount(){this.props.enabledFormFCBs.has(Ye.kb)&&(this._currentScrollAndFocusState.scrollTopPosition=this._mainSectionElement.scrollTop,this.props.setFormScrollAndFocusState(this.props.id,this.props.contextToken,this._currentScrollAndFocusState),document.getElementById("mainContent").removeEventListener("focusin",this._mainElementFocusHandler),this._removeFocusHandlersForIFrames(this._mainSectionElement.getElementsByTagName("iframe")))}_addFocusHandlersForIframes(e){var t;for(let n=0;n<e.length;n++)null!=e[n].contentDocument&&(this._iframesWithFocusHandlerAdded[e[n].outerHTML]||(null===(t=e[n].contentDocument.body)||void 0===t||t.addEventListener("focusin",this._iframeFocusInHandler),this._iframesWithFocusHandlerAdded[e[n].outerHTML]=e[n]),this._addFocusHandlersForIframes(e[n].contentDocument.getElementsByTagName("iframe")))}_removeFocusHandlersForIFrames(e){var t;for(let n=0;n<e.length;n++)null!=e[n].contentDocument&&(null===(t=e[n].contentDocument.body)||void 0===t||t.removeEventListener("focusin",this._iframeFocusInHandler),this._removeFocusHandlersForIFrames(e[n].contentDocument.getElementsByTagName("iframe")))}_iframeFocusInHandler(e){const t=e&&e.target&&e.target;this.props.enabledFormFCBs.has(Ye.kb)&&(this._currentScrollAndFocusState.focusedControlName=this._getControlName(t))}_mainElementFocusHandler(e){const t=e&&e.target&&e.target;this.props.enabledFormFCBs.has(Ye.kb)&&"mainContent"===t.id&&(this._currentScrollAndFocusState.focusedControlName=null)}render(){if(!this.props.pageInput)return null;if(this.props.showLoadingIndicator&&!this.props.isMainFormDialog)return this._renderLoadingExperience();const e=wt.a.getInstance().getDisableScrollStyle()?"forceNewStackContextInert":"forceNewStackContext";return i.createElement(gn.Provider,{value:this.props.resourceStrings},i.createElement(E.a,Object.assign({style:this.props.containerStyle,role:we.r},this.props.isMainFormDialog?{onKeyDown:this._onKeyDownHandler}:null),i.createElement(E.a,{testhooks:{id:this.props.isMainFormDialog?Et.b:Et.a},ref:e=>this._rootMountCallback(e),role:this.props.isFormComponentInstance?null:we.g,id:this.props.rootElementId,style:this.props.formGeneralStyle,labelledByElementId:this.props.isFormComponentInstance?null:Object(N.g)(Ke.a,this.props.id),explicitStyles:e},i.createElement(E.a,{style:this.props.formMainSectionStyle},i.createElement(E.a,{style:this.props.mainContentStyle,explicitStyles:e},(!this.props.enabledFormFCBs.has(Ye.mb)||this.props.enabledFormFCBs.has(Ye.mb)&&this._isHeaderSticky)&&this._renderFormHeader(),this._renderMainSection()),null!==this.state.sizeMode&&this._renderBusinessProcessFlow(ae.Stage)),this._renderFormFooter(),this.props.isFormComponentInstance?null:i.createElement($e.a,{key:Object(N.g)("editformAccessibility",this.props.id),rootElementId:this.props.rootElementId,isModal:this.props.isMainFormDialog,shouldManageFocus:!0,waitForEditable:!1,overrideFocusId:this._getDefaultFocusId(),keyboardShortcuts:this._createKeyboardShortcuts()}),this._renderOverlay())))}}function hn(){let e=dn;if(!zt.a.getInstance().get_IsAndroid()){const t=document.createElement("div");t.style.width="100px",t.style.height="100px",t.style.overflow="scroll",t.style.position="absolute",t.style.top="-10000px",t.style.visibility="hidden",document.body.appendChild(t),e=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return e}pn.displayName="EditFormRoot";const gn=i.createContext({});var mn=n("tJ+6"),bn=n("Oyec");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function yn(){let e=null,t=null,n=null,r=null,i=null,a=null,s=null,o=null,c=null,d=null,p=null,h=null,g=null,m=null,S=null;return function(C,O,_,I,j){var P,F;const T=Object(v.a)(C),w=Object(mn.c)(C),E=Object(mn.a)(C),x=null==E?void 0:E.Colors,N=Object(y.c)(C),A=Object(y.b)(C),k=Object(ye.g)(C),M=Object(f.j)(C,O.id),D=Object(l.o)(C,O.id,M),R=Object(l.Bb)(C,O.id,M),B=function(e,t,n){const r=Object(u.e)(e,{id:t},n);return r&&!!r.url||fn.some(n=>n(e,t,r))}(C,O.id,M),L=function(e,t,n){const r=Object(u.e)(e,{id:t},n);return r&&!!r.entityName}(C,O.id,M),V=Object(l.Eb)(C,O.id);if(t!==T||i!==N||a!==A||s!==k||o!==D||c!==R||d!==_||p!==I||g!==j||h!==B||m!==L||S!==V||n!==w||r!==x){t=T,i=N,a=A,s=k,o=D,c=R,d=_,p=I,g=j,h=B,m=L,S=V,n=w,r=x;const l={display:"block",flex:"1 0 0px",width:"100%",height:"100%",maxWidth:"100%",overflowX:"hidden"},u=function(e,t){if(!t)return e;const n={display:"block"};return Object.assign(Object.assign({},e),n)}({display:"flex",position:"relative",flexDirection:"column",flex:"1 0 0px",maxWidth:"100%",width:"100%",height:"100%",overflow:"hidden",backgroundColor:w?null===(P=null==x?void 0:x.Palette)||void 0===P?void 0:P.Primary01:T.colors.BaseColor.White},V),y=function(e,t){if(!t)return e;return Object.assign(Object.assign({},e),{overflowY:"auto"})}({display:"flex",position:"relative",flexDirection:"column",flex:"1 1 0px",width:"100%",height:"inherit",overflowY:"hidden",overflowX:"hidden"},V),f=function(e,t){if(!t)return e;const n={height:"auto",display:"block"};return Object.assign(Object.assign({},e),n)}({display:j.has(Ye.mb)?"inline-flex":"flex",flexDirection:"column",flexGrow:1,maxWidth:"100%",width:"100%",height:j.has(Ye.mb)?"auto":"100%",overflowX:"hidden"},V),v=function(e,t){if(!t)return e;const n={marginRight:0,marginLeft:0};return Object.assign(Object.assign({},e),n)}({boxSizing:"border-box",marginLeft:N<T.sizes.Breakpoints.DimensionS?0:T.sizes.Measures.Measure075,marginRight:N<T.sizes.Breakpoints.DimensionS?0:T.sizes.Measures.Measure075},V),O=Object(bn.a)(T),E={paddingTop:T.sizes.Measures.Measure025,paddingBottom:T.sizes.Measures.Measure225,paddingLeft:O.paddingLeft,paddingRight:O.paddingRight,borderStyle:"solid",borderWidth:"1px",borderColor:T.colors.SectionBorder,marginBottom:N<T.sizes.Breakpoints.DimensionS?T.sizes.Measures.Measure050:T.sizes.Measures.Measure150},M=function(e,t){if(!t)return e;const n={display:"block",flex:"1 0 auto",width:"100%",height:"auto",margin:0};return Object.assign(Object.assign({},e),n)}({display:"flex",flexDirection:"column",flex:"1 0",width:"100%",height:"100%",margin:0,overflowY:"auto"},V);e={containerStyle:l,formMainSectionStyle:{display:"flex",flexDirection:"row",flex:"1 1 0px",height:"inherit",maxWidth:"100%",minHeight:"0"},formGeneralStyle:u,tabGeneralStyle:y,tabHeaderBodyContainerStyle:M,tabCustomStyle:{overflowX:"visible",flex:"1 0 auto",width:"100%",boxSizing:"border-box",maxWidth:"100%",transform:"rotate(0deg)"},formButtonWrapper:{float:"right"},formButtonStyle:{borderStyle:"none",backgroundColor:"transparent",cursor:"pointer"},formButtonIconStyle:{color:"#000",width:"40px",backgroundColor:"transparent",fontSize:T.fontSizes.TextBox.FontIcon},formCloseViewStyle:{display:"flex",flex:"0 0 auto"},formCloseStyle:{borderWidth:"0px",alignSelf:"flex-end",cursor:"pointer",backgroundColor:"transparent"},saveButtonStyle:{margin:"7px",display:"flex",flex:"0 0 auto"},formCloseIconStyle:{color:"#000",fontFamily:"Dyn CRM Symbol, Segoe MDL2 Assets",fontSize:"12px",backgroundColor:"transparent"},temporaryButtonContainerStyle:{margin:T.sizes.SmallMargin,display:"flex",flex:"0 0 auto",flexWrap:"wrap"},recordSetNavigationContainerStyle:{width:T.sizes.RecordSetNavigator.width},mainContentStyle:f,overlayStyle:{opacity:.8,backgroundColor:w?null===(F=null==x?void 0:x.Palette)||void 0===F?void 0:F.Primary01:T.colors.BaseColor.White,position:"absolute",width:"100%",height:"100%",top:0,left:0},overlayTextStyle:{width:"100%",textAlign:"center",fontSize:T.fontSizes.Font100,color:T.colors.BaseColor.Grey.Grey7,lineHeight:a.toString()+"px"},commandManagerContainerStyle:{maxHeight:T.sizes.Measures.Measure300,height:T.sizes.Measures.Measure300,flex:"1 0 auto",backgroundColor:T.colors.WhiteBackground},commandManagerStyle:{right:"0",width:"100%",alignItems:"center",flexGrow:1,paddingTop:T.sizes.Measures.Measure075,paddingBottom:T.sizes.Measures.Measure075,paddingRight:T.sizes.Measures.Measure100,paddingLeft:T.sizes.Measures.Measure075,backgroundColor:T.colors.MainThemeColor.MainColor1.Fill,color:T.colors.BaseColor.White},commandBarStyle:{container:{backgroundColor:T.colors.MainThemeColor.MainColor1.Fill,width:"100%",maxHeight:"100%",height:"100%",boxSizing:"border-box"},list:{margin:0,height:T.sizes.Measures.Measure100},listItem:{marginRight:T.sizes.Measures.Measure200,marginLeft:0,height:T.sizes.Measures.Measure100,lineHeight:T.sizes.Measures.Measure100},listItemBody:{text:{fontFamily:T.fontFamilies.Regular,color:T.colors.BaseColor.White},button:{height:T.sizes.Measures.Measure150,lineHeight:T.sizes.Measures.Measure100,padding:0,backgroundColor:"transparent",borderStyle:"none",color:T.colors.BaseColor.White},icon:{color:T.colors.BaseColor.White,height:T.sizes.Measures.Measure100,lineHeight:T.sizes.Measures.Measure100,fontSize:"16px"}},overflowFlyoutMoreButton:{backgroundColor:"transparent",lineHeight:T.sizes.Measures.Measure100,height:T.sizes.Measures.Measure100,borderStyle:"none",padding:0,cursor:"pointer",color:T.colors.BaseColor.White}},collapseExpandButtonWrapperStyle:{backgroundColor:T.colors.MainThemeColor.MainColor1.Fill},collapseExpandButtonStyle:{display:"inline-block",borderStyle:"solid",backgroundColor:"transparent",cursor:"pointer",color:T.colors.MainThemeColor.MainColor1.Text,margin:0,width:T.sizes.Measures.Measure300,height:T.sizes.Measures.Measure300,borderWidth:k?"0 0 0 1px":"0 1px 0 0",borderRightColor:T.colors.MainThemeColor.MainColor1.Text},collapseExpandButtonTextStyle:{fontSize:"16px",margin:"0 auto"},commandBarPlaceholdStyle:{width:"100%",height:T.sizes.Measures.Measure400,backgroundColor:T.colors.BaseColor.Grey.Grey3},bpfPlaceholdStyle:{width:"100%",height:N<=T.sizes.Breakpoints.DimensionS?T.sizes.Measures.Measure400:T.sizes.Measures.Measure450},tabNavPlaceholdStyle:{width:"100%",height:(T.sizes.Breakpoints.DimensionS,T.sizes.Measures.Measure225),marginBottom:N<=T.sizes.Breakpoints.DimensionS?T.sizes.Measures.Measure050:T.sizes.Measures.Measure150},tabPlaceholdStyle:{display:"flex",flex:"1 1 auto",flexDirection:"column",borderStyle:"solid",borderTopWidth:T.sizes.Measures.Measure025,borderTopColor:T.colors.BaseColor.Grey.Grey3,backgroundColor:T.colors.BaseColor.White,borderLeftWidth:"1px",borderLeftColor:T.colors.SectionBorder,borderRightWidth:"1px",borderRightColor:T.colors.SectionBorder,borderBottomWidth:"1px",borderBottomColor:T.colors.SectionBorder,paddingLeft:T.sizes.Measures.Measure100,paddingRight:T.sizes.Measures.Measure100},mainSectionPlaceholdStyle:{flex:"1 1 auto",paddingLeft:N<=T.sizes.Breakpoints.DimensionS?T.sizes.Measures.Measure050:T.sizes.Measures.Measure150,paddingRight:N<=T.sizes.Breakpoints.DimensionS?T.sizes.Measures.Measure050:T.sizes.Measures.Measure150},legendPlaceholdContainerStyle:{display:N<=T.sizes.Breakpoints.DimensionS?"block":"flex",width:"100%",height:T.sizes.Measures.Measure300,borderStyle:"solid",borderBottomWidth:"1px",borderBottomColor:T.colors.BaseColor.Grey.Grey1,position:"relative"},legendPlaceholdStyle:{height:T.sizes.Measures.Measure100,backgroundColor:T.colors.BaseColor.Grey.Grey1,marginTop:T.sizes.Measures.Measure100,marginBottom:T.sizes.Measures.Measure100,width:"12%"},sectionContainerPlaceholdStyle:{display:"block",width:"100%",flex:"1 1 auto"},rowPlaceholdContainerStyle:{width:"100%",height:T.sizes.Measures.Measure300,borderStyle:"solid",borderBottomWidth:"1px",borderBottomColor:T.colors.BaseColor.Grey.Grey1,position:"relative"},rowPlaceholdStyle:{height:T.sizes.Measures.Measure100,backgroundColor:T.colors.BaseColor.Grey.Grey1,marginTop:T.sizes.Measures.Measure100,marginBottom:T.sizes.Measures.Measure100,width:"100%"},sectionColumn1PlaceholdStyle:{position:"relative",flexGrow:1,width:"25%",marginRight:"5%",height:"100%",display:"block"},sectionColumn2PlaceholdStyle:{position:"relative",flexGrow:3,width:"70%",height:"100%",display:"block"},columnStyle:v,sectionStyle:E,cellStyle:{flex:"0 1 auto"},headerSpacerStyle:{display:"block",height:N<=T.sizes.Breakpoints.DimensionM?T.sizes.Measures.Measure450:"16rem"},headerSpacerHeightInPx:224,headerCollapsedHeightInPx:112,headerContainerStyle:{display:"flex",flexDirection:"column",flex:"0 0 auto",width:"100%",margin:0,position:j.has(Ye.mb)?"static":"absolute",top:j.has(Ye.mb)?0:void 0,zIndex:1},headerShadowStyle:"rgba(0, 0, 0, 0.5) 0px 6px 4px -4px",headerShadowV2Style:{height:w?"0px":"4px",width:"100%",background:"linear-gradient(180deg, rgba(0,0,0,.35), rgba(0, 0, 0, 0))"},tabBackButtonStyle:{borderWidth:k?"0 0 1px 1px":"0 1px 1px 0"}},function(e,t,n,r,i){const a=Object(Ge.p)(n,null),s=!1;a.container.backgroundColor=s?t.colors.BaseColor.White:t.colors.MainThemeColor.MainColor1.Fill,a.container.marginLeft="0px",a.container.marginRight="0px",r&&(a.container.boxSizing="border-box");a.listItemBody.text.color=s?t.colors.BaseColor.Grey.Grey7:t.colors.MainThemeColor.MainColor1.Text,a.listItemBody.icon.color=s?t.colors.BaseColor.Grey.Grey7:t.colors.MainThemeColor.MainColor1.Text,a.listItemBody.iconWrapperStyles.color=s?t.colors.BaseColor.Grey.Grey7:t.colors.MainThemeColor.MainColor1.Text,a.moreIcon.color=s?t.colors.BaseColor.Grey.Grey7:t.colors.MainThemeColor.MainColor1.Text,a.splitbuttonicon.color=s?t.colors.BaseColor.Grey.Grey7:t.colors.MainThemeColor.MainColor1.Text;const o={":hover":{backgroundColor:s?t.colors.BaseColor.Grey.Grey2:t.colors.MainThemeColor.MainColor3.Fill}},c={"[aria-expanded=true]":{backgroundColor:s?t.colors.BaseColor.Grey.Grey2:t.colors.MainThemeColor.MainColor3.Fill},"[data-expanded=true]":{backgroundColor:s?t.colors.BaseColor.Grey.Grey2:t.colors.MainThemeColor.MainColor3.Fill}};a.listItemBody.button=Object.assign(Object.assign({},a.listItemBody.button),o),a.overflowFlyoutMoreButton=Object.assign(Object.assign({},a.overflowFlyoutMoreButton),o),a.listItem=Object.assign(Object.assign({},a.listItem),c),a.splitbuttonOverflowButton=Object.assign(Object.assign({},a.splitbuttonOverflowButton),c),e.commandBarStyle=a;const l=Object(Ge.s)()(i,null,!0);Object(Ge.b)(l,e.commandBarStyle,s,e.commandManagerStyle,e.commandManagerContainerStyle),function(e,t,n,r,i){let a={},s={};if(n&&!r){const n=Object(Ge.m)(null);s={color:n.colors.text,borderWidth:i?"0 0 "+n.border.width+" "+n.border.width:"0 "+n.border.width+" "+n.border.width+" 0",borderStyle:n.border.style,borderColor:n.colors.border+" !important"},a={backgroundColor:n.colors.background},Object.assign(t,s),Object.assign(e,a)}}(e.collapseExpandButtonWrapperStyle,e.collapseExpandButtonStyle,l.isRefreshedCommandBarFCBEnabled,s,n)}(e,T,k,_,C),function(e,t,n,r,i,a,s){let o=n<=t.sizes.Breakpoints.DimensionS?14.5:16;const c=8;r||(o-=4);s&&(o=n<=t.sizes.Breakpoints.DimensionS?0:3);!i&&o>=3&&(o-=3);a&&(o+=2.65);e.headerSpacerStyle.height=o+"rem",e.headerSpacerHeightInPx=Object(b.a)(o),e.headerCollapsedHeightInPx=Object(b.a)(c)}(e,T,N,D,R,_,I)}return e}}const fn=[(e,t,n)=>Object(F.b)(e,t,n)];var Sn=n("74Tm"),vn=n("lxh6"),Cn=n("69Qu"),On=n("iF9X"),_n=n("sZ+8"),In=n("3hnk"),jn=n("jTSi"),Pn=n("uNLT"),Fn=n("P6DH"),Tn=n("9gu/"),wn=n("bq0x"),En=n("HhsT"),xn=n("mHvI"),Nn=n("Y2Yg"),An=n("5iTp"),kn=n("xHmU"),Mn=n("+XGO"),Dn=n("BoVI");const Rn=Object(r.a)((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){const e=Object(O.h)(),t=Object(l.Yc)(),n=yn(),r=Object(l.ed)(),i=Object(l.dd)(),a=Object(l.ad)(),s=Object(l.cd)();let o=null;return function(d,p){const h=Object(f.j)(d,p.id);Object(c.e)(o,h)||(o=h);const g=Et.a+p.id,b=Object(v.a)(d),S=Object(m.g)(d,p.id),C=Object(De.a)(d,p.id),O=Object(l.fb)(d,p,o),_=Object(l.wc)(d,p,o),I=Object(l.J)(d,p),j=Object(Ie.a)(d,p.id),F=Object(l.g)(C,d,p,o)||j<je.a.EditReady,T=t(d,p.id),w=Object(l.Ib)(d,p.id),E=Object(xn.a)(d,p.id),x=e(d,E),N=Object(y.c)(d),A=Object(P.h)(d,null==S?void 0:S.entityTypeName),k=s(d,p,h),M=Object(l.lb)(d,p,o),D=Object(l.Eb)(d,p.id),R=Object(l.nb)(d,p.id,o),L=Object(Ht.l)(d,p.id,o,T,M),V=n(d,p,L,S&&S.bodyOnly,k),z=Object(Sn.a)(d),H=b.sizes.Breakpoints.DimensionXL,G=null==S?void 0:S.recordSetQueryKey,W=Object(B.a)(d),U=Object(B.e)(d),X=Object(u.e)(d,p,o),K=r(d,{id:p.id,contextToken:o}),Q=i(d,{id:p.id,contextToken:o}),Z=Object(l.dc)(d,S,p.id,o),J=Object(Cn.b)(d),$=Object(On.a)(d),ee=Object(_n.l)(d,null==S?void 0:S.entityTypeName),te=Object(l.Lb)(d,null==S?void 0:S.entityTypeName,null==S?void 0:S.id),ne=Object(In.h)(d,null==S?void 0:S.entityTypeName,q.a.toString(I),Nn.a.WriteAccess),re=Object(In.g)(d,null==S?void 0:S.entityTypeName,3,0),ie=!D&&!Object(l.ib)(d,p.id)&&Object(l.jb)(d,p.id),ae=Object(ye.g)(d),se=Object(l.o)(d,p.id,h),oe=Object(l.Bb)(d,p.id,o),ce=Object(wn.a)(d,p.id),le=Object(Ct.a)(d)===vt.a.MultiSession,ue=Object(kn.a)(d);let de,pe=!1;if(ue&&ue.length>0){pe=Object(l.Q)(d)!==p.id}let he=[];O&&(de=Object(Ee.p)(d,O.Id),he=a(d,O));let ge,me=null;if(X&&S&&S.bodyOnly){const e=Object(f.a)(h,X.relationshipName,X.ordinal);me=Object(Fn.nb)(p.id,q.a.toString(Object(Fn.T)(d,p.id,e)))}A&&G&&(ge=Object(Y.q)(d,G,1,[A.PrimaryNameAttribute],!0));const be=ge&&ge.length>0?ge.length:0,fe=Object(Ht.f)(d,p.id,h),Se=Object(An.a)(d,p.id,h),ve=Object(l.n)(d);return{hasActiveDialogOnTop:pe,rootElementId:g,descriptor:O,selectedTab:_,currentEntityId:I,isFormValid:F,formNotificationIds:T,containerStyle:V.containerStyle,formMainSectionStyle:V.formMainSectionStyle,formGeneralStyle:V.formGeneralStyle,formButtonWrapper:V.formButtonWrapper,formButtonStyle:V.formButtonStyle,tabHeaderBodyContainerStyle:V.tabHeaderBodyContainerStyle,tabCustomStyle:V.tabCustomStyle,tabGeneralStyle:V.tabGeneralStyle,formButtonIconStyle:V.formButtonIconStyle,formCloseViewStyle:V.formCloseViewStyle,formCloseStyle:V.formCloseStyle,saveButtonStyle:V.saveButtonStyle,formCloseIconStyle:V.formCloseIconStyle,temporaryButtonContainerStyle:V.temporaryButtonContainerStyle,recordSetNavigationContainerStyle:V.recordSetNavigationContainerStyle,mainContentStyle:V.mainContentStyle,overlayStyle:V.overlayStyle,overlayTextStyle:V.overlayTextStyle,commandManagerContainerStyle:V.commandManagerContainerStyle,commandManagerStyle:V.commandManagerStyle,commandBarStyle:V.commandBarStyle,collapseExpandButtonStyle:V.collapseExpandButtonStyle,collapseExpandButtonTextStyle:V.collapseExpandButtonTextStyle,collapseExpandButtonWrapperStyle:V.collapseExpandButtonWrapperStyle,commandBarPlaceholdStyle:V.commandBarPlaceholdStyle,bpfPlaceholdStyle:V.bpfPlaceholdStyle,tabNavPlaceholdStyle:V.tabNavPlaceholdStyle,tabPlaceholdStyle:V.tabPlaceholdStyle,mainSectionPlaceholdStyle:V.mainSectionPlaceholdStyle,legendPlaceholdContainerStyle:V.legendPlaceholdContainerStyle,legendPlaceholdStyle:V.legendPlaceholdStyle,sectionContainerPlaceholdStyle:V.sectionContainerPlaceholdStyle,rowPlaceholdContainerStyle:V.rowPlaceholdContainerStyle,rowPlaceholdStyle:V.rowPlaceholdStyle,sectionColumn1PlaceholdStyle:V.sectionColumn1PlaceholdStyle,sectionColumn2PlaceholdStyle:V.sectionColumn2PlaceholdStyle,columnStyle:V.columnStyle,sectionStyle:V.sectionStyle,cellStyle:V.cellStyle,resourceStrings:x,viewPortWidth:N,entityDescriptor:A,pageInput:S,formId:O&&O.Id?O.Id:null,showLoadingIndicator:j===je.a.Initial||j===je.a.Loading,XLBreakPoint:b.sizes.Breakpoints.DimensionXL,largeBreakPoint:b.sizes.Breakpoints.DimensionL,mediumBreakPoint:b.sizes.Breakpoints.DimensionM,smallBreakPoint:b.sizes.Breakpoints.DimensionS,headerSpacerStyle:V.headerSpacerStyle,headerSpacerHeightInPx:V.headerSpacerHeightInPx,headerCollapsedHeightInPx:V.headerCollapsedHeightInPx,headerContainerStyle:V.headerContainerStyle,recordSetNavigatorCollapsed:z,recordSetNavBreakPoint:H,numberOfAvailableRecords:be,clientHost:W,clientHostSubtype:U,tabPlaceholdRowHeightEm:b.sizes.EditForm.TabPlaceholdRowHeightEm,primaryControlDomId:Z,selectedRelatedEntity:X,hasHeaderFields:K&&K.length>0,hasFooterFields:Q&&Q.length>0,contextToken:o,headerShadowStyle:V.headerShadowStyle,headerShadowV2Style:V.headerShadowV2Style,serverIsAvailable:J,isMocaOfflineEnabled:$,isEntityAvailableForOffline:ee,isRecordStatusInactive:te,isEditableForSharedRecord:ne,hasWriteRolePrivilege:re,showSavingIndicator:ie,isRTL:ae,bpfControlRendered:se,hasCmdbar:oe,multiSessionEnabled:le,viewSelectorDOMId:me,theme:b,availableTabs:he,isFooterAvailableForPhone:de,isMainFormDialog:w,output:ce,tabBackButtonStyle:V.tabBackButtonStyle,enabledFormFCBs:k,shouldFormNotificationBarRender:L,mainSectionId:Et.c+p.id,isInMobileNative:Object(qt.b)(d),isInMobileNativeApr2020:Object(qt.a)(d),isFormComponentInstance:D,showHeaderBody:null==fe?void 0:fe.bodyVisible,showCommandBar:null==fe?void 0:fe.commandBarVisible,showTabNavigator:null==fe?void 0:fe.tabNavigatorVisible,showFooter:null==Se?void 0:Se.visible,formScrollAndFocusState:R,bpfDisabled:ve}}}),(function(e,t){return{updateFormViewPortSizes:(n,r,i)=>{e(Object(vn.b)(t.id,n,r,i))},clearFormNotification:(n,r)=>{e(Object(jn.b)(n,t.id,r))},saveAndCloseForm:()=>{e(Object(En.a)(t.id))},saveForm:n=>{q.a.isNullOrEmpty(null==n?void 0:n.id)?e(Object(Pn.f)(t.id,St.a,!0,1,!1,!0)):e(Object(Pn.e)(t.id,1))},cancelForm:(n,r)=>{e(Object(Tn.a)(t.id,r))},setFormScrollAndFocusState:(t,n,r)=>{e(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,n){const r=Object(f.v)(t),i=n;return{type:Dn.e,payload:i,meta:{pageId:e,contextKey:r}}}(t,n,r))},setFocus:(t,n,r)=>{e(Object(Mn.a)(t,n,r))}}}))(pn)},Gh4N:function(e,t,n){"use strict";var r,i;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),function(e){e[e.xSmall=0]="xSmall",e[e.small=1]="small",e[e.medium=2]="medium",e[e.large=3]="large"}(r||(r={})),function(e){e[e.normal=0]="normal",e[e.large=1]="large"}(i||(i={}))},Gn6i:function(e,t,n){"use strict";n.d(t,"a",(function(){return Ht})),n.d(t,"b",(function(){return Gt}));var r=n("SAYH"),i=n("odYE"),a=n("lY/Z"),s=n("5Oca"),o=n("OWbt"),c=n("NPZ3"),l=n("XVX7"),u=n("wNQP"),d=n("y60j"),p=n("EY5k"),h=n("MktZ"),g=n("f/sd"),m=n("ZXdP"),b=n("2yvP"),y=n("arV0"),f=n("4Us1"),S=n("+nNZ"),v=n("dHD5"),C=n("zmaG"),O=n.n(C),_=n("pEXn"),I=n("ghNp"),j=n("rdSB"),P=n("LbMF"),F=n("UqyN"),T=n("IaGr"),w=n("qshH"),E=n("mIxf");function x(e){const t={};for(const n in e){const r={fieldName:n,value:e[n]};t[n]=r}return t}var N=n("AFlp"),A=n("k1f1"),k=n("ycdb"),M=n("Lohl"),D=n("Lyxw"),R=n("Kvn0");var B=n("504W"),L=n("iZ7K"),V=n("PUjk"),z=n("D4Jo"),H=n("JF0K"),G=n.p+"scripts/WorkflowObjectModel.js?v=1.4.9962-v91onpremise",W=n("7LBy"),U=n("jq7Z");function q(e,t,n,a,o,c,l,u,d,p,h){const g=Object(s.e)(e(),c),m=c&&c.etn||"",b=Object(L.p)(e(),m),y=c&&c.id?r.a.toString(c.id):"",S=u.correlationId,v={};v[_.b.BpfProcessControlRenderParameters.ProcessId]=r.a.toString(l),v[_.b.BpfProcessControlRenderParameters.BusinessProcessFlowInstanceId]=Object(B.a)(g)?"":r.a.toString(g),v[_.b.BpfProcessControlRenderParameters.EntityTypeCode]=Object(B.a)(b)?"":b.toString(),v[_.b.BpfProcessControlRenderParameters.EntityId]=y,v[_.b.BpfProcessControlRenderParameters.CorrelationId]=S,v[_.b.BpfProcessControlRenderParameters.PageId]=a,O.a.addKeyPerformanceIndicator("BPF.RenderProcessControl",v);const C=[{name:"CorrelationId",value:S},{name:"ContextId",value:u.contextId},{name:"ActionStack",value:u.stack},{name:"entityTypeCode",value:b},{name:"entityId",value:y}],I=d.AssetLoader.loadScript(G),j=t(Object(f.a)(l,c,p));return Promise.all([I,j]).then(u=>{
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var d;t((d=!0,{type:R.b,payload:{workflowObjectModelLibraryLoaded:d}}));const g=u[1];if(!g)return Promise.resolve();n.info("retrieveBusinessProcessFlow promise resolved successfully.");const m=e();let b=Promise.resolve();const y=[];if(Object(D.c)(m,"FCB.EnableBPFNonDefaultCustomControls")&&(Object(B.a)(p)||p.then(()=>{b=function(e,t,n,a,o,c){let l=Promise.resolve(),u=c;if(t&&t.businessProcessFlows&&Object.keys(t.businessProcessFlows).length>0){if(u===r.a.EMPTY&&!Object(B.a)(o)){const n=Object(s.b)(o)(e,o.etn);u=n&&n.businessProcessFlowId?n.businessProcessFlowId:t.businessProcessFlows[Object.keys(t.businessProcessFlows)[0]].businessProcessFlowId}const c=u!==r.a.EMPTY?t.businessProcessFlows[u.guid].businessProcessFlowUniqueName:null;if(Object(B.a)(c)){if(!Object(B.a)(t)&&!Object(B.a)(t.businessProcessFlows)&&Object.keys(t.businessProcessFlows).length>0){const e=[];e.push({name:"BPF Id",value:t.businessProcessFlows[Object.keys(t.businessProcessFlows)[0]].businessProcessFlowId.guid},{name:"BPF UniqueName",value:t.businessProcessFlows[Object.keys(t.businessProcessFlows)[0]].businessProcessFlowUniqueName},{name:"currentProcessId",value:u?u.guid:""},{name:"BPF Name",value:t.businessProcessFlows[Object.keys(t.businessProcessFlows)[0]].businessProcessFlowName}),a.error("BPF descriptor does not contain unique name which is required to load BPF Entity form descriptor",e)}}else l=n(Object(M.b)(new i.a(c),null))}return l}(m,g,t,n,c,l)})),c.id===r.a.EMPTY){const i=Object(W.a)(h),u=Object(W.b)(h);if(y.push(t(Object(k.b)(!1,c))),i&&u)return y.push(t(Object(N.b)(i,c))),y.push(t(Object(A.b)(u,c))),Promise.all(y).then(r=>X(c,o,a,t,e,n));let d=l;if(r.a.isNullOrEmpty(d)&&(d=Object(s.d)(m,c.etn)),!r.a.isNullOrEmpty(d))return y.push(t(Object(N.b)(d,c))),y.push(t(Object(A.b)(r.a.EMPTY,c))),Promise.all(y).then(r=>X(c,o,a,t,e,n,!0))}return Promise.all([p,b]).then(()=>X(c,o,a,t,e,n))}).then(()=>{const e=Object(V.a)(a);e&&(C.push(...e.getTelemetryParams()),Object(z.c)(H.l,C,d))}).catch(t=>{const r=h&&h.entityTypeName?new i.a(h.entityTypeName,h.id):null,s=Object(z.a)(e(),r,a,d);return s&&(C.push(...s),n.error("Error while executing loadBusinessProcessFlow in the retrieveBusinessProcessFlow promise.",C),Object(z.b)(H.l,t,null,C,d,c,e())),Promise.resolve(null)})}function X(e,t,n,i,a,o,c=!1){const l=[];let u=Promise.resolve();const d=a(),p=Object(s.e)(d,e);if(!r.a.isNullOrEmpty(p)){const r=Object(S.a)(d,p);if(r&&r.businessProcessFlowStepEntityAttributeControls){o.debug("BusinessProcessFlowDescriptor is valid.",l);const a=r.businessProcessFlowStepEntityAttributeControls[e.etn];if(a&&Object.keys(a).length){l.push({name:"bpfControls.length",value:Object.keys(a).length}),o.debug("bpfControls is valid.",l);const r=Object(v.v)(t),s=Object(U.a)(d,n),p=s&&s.metadata&&s.metadata[r]&&s.metadata[r].attributes,h={};for(const t in a){const n=a[t].DataFieldName;if(h[n]||p&&n in p)continue;const r=Object(P.a)(d,e.etn,n);r&&(h[n]=r)}let g=Y(i,a,n,t);i(Object(j.c)(t,n,h)),i(Object(j.d)(t,n,g)),g=Y(i,a,n,t),u=i(function(e,t,n,r,i,a=!1){return{type:"clientapi.add.controls",execute(s,o){try{return Object(b.b)("bpf.initialization",()=>{const o=s.dispatch(Object(I.b)(t,e));if(o&&o.data&&o.ui){const c=o.data.entity,l=o.ui;if(c&&c.attributes){if(n){const r=c.attributes;for(const o in n){const u=n[o];let d=r.get(o);if(!d){const i=Object(F.b)(s,e,t,o,c,l,n[o]);i&&(r.add(o,i),d=r.get(o))}if(u&&d){const e="picklist"===u.Type&&0===u.OptionSetType&&u.DefaultValue&&u.DefaultValue>-1,n="boolean"===u.Type&&3===u.OptionSetType&&u.DefaultValue;if(a&&(e||n)&&!d.getValue()){const e={};e[o]=u.DefaultValue;const n=x(e);s.dispatch(Object(E.a)(t,n,!0,!0))}}else{const e=[];e.push({name:"BpfAttribute",value:o}),i.debug("BPF Attribute cannot be null.",e)}}}r&&l.addControls(r)}}}),Promise.resolve()}catch(t){const n=w.a.getInstance().getEventParameters(e);throw T.a.getInstance().eventManager.ReportComponentFailure("ClientApi.AddBpfFieldsToXrmCollection.addBpfFieldsToXrmCollection",t,null,n),t}},shouldReceiveFullStore:!0}}(t,n,h,g,o,c))}else o.debug("bpfControls is invalid.",l)}else o.debug("BusinessProcessFlowDescriptor is invalid.",l)}return u}function Y(e,t,n,r){let i={};const a=e(Object(I.b)(n,r));return Object(b.b)("bpf.initialization",()=>{if(a&&a.data&&a.ui){const e=a.ui;if(t){const n=[];e.controls.forEach(e=>n.push(e.getName()));const r=new Set(n),a=Object.keys(t);let s={};if(r&&a&&a.length>0){return a.filter(e=>!r.has(e)).forEach(e=>{s={[e]:t[e]},i=Object.assign(Object.assign({},i),s)}),i}}}return t})}var K=n("8nT0"),Q=n("M0zh"),Z=n("nmJf"),J=n("Bo7t"),$=n("i1f0"),ee=n("Bj/n"),te=n("ruPX"),ne=n("3tOH"),re=n("uCpV"),ie=n("X37l"),ae=n("1HWW"),se=n("DRVD"),oe=n.n(se),ce=n("SZCI"),le=n("WIoD");class ue{constructor(e,t,n,r,i){this._callback=i,this._callbackCalled=!1,this._editReadyTime=0,this._controlsShouldRender=[];const a=[le.a.guid,le.b.guid,le.g.guid],s=Object(d.g)(e,t,n,r);s&&Object.keys(s).forEach(e=>{const t=s[e];e&&t&&t.Visible&&a.indexOf(t.ClassId.guid)<0&&this._controlsShouldRender.push(e)})}writeMarker(e,t,n){this._receivedEvent(e,t,n)}writeRetroactiveTimespan(e,t,n,r){this._receivedEvent(e,t+n,r)}startTimespan(e,t,n){return(r,i)=>{this._receivedEvent(e,t+r,n)}}_receivedEvent(e,t,n){if(this._callbackCalled)return;const r=e.getName();if(r===ce.m){const e=this._getControlName(n);this._controlsShouldRender.indexOf(e)>=0&&this._editReadyTime<t&&(this._editReadyTime=t)}else"FormOnloadCompleteEvent"===r?this._editReadyTime<t&&(this._editReadyTime=t):r===ce.i&&(this._callbackCalled=!0,this._callback({timestamp:this._editReadyTime}))}_getControlName(e){const t=e[ce.l];return t||null}}function de(e,t,n,i,a,s){const o=new ue(e,t,n,s,e=>{oe.a.removeTransport(o);const t=i&&i.id?i.id.guid:"null";!function(e,t,n,i,a){O.a.addKeyPerformanceIndicator(i,{formId:r.a.toString(e),recordId:t,etn:n},a)}(n,t,a,"RenderedEditReady",e.timestamp)});oe.a.registerTransport(o,[C.KPI_ZONE,ce.g,ce.d])}var pe=n("wF0i"),he=n("Or4W"),ge=n("MoY7"),me=n("ZFRl"),be=n("O7zD"),ye=n("Xi8U"),fe=n("Uv1Y"),Se=n("AF/G"),ve=n("VqBP"),Ce=n("Z/4N"),Oe=n("CYtR");function _e(e,t,n){let r=e.controls[t];r||(r=e.controls[t]={numPresent:0,numVisible:0}),r.numPresent++,n&&r.numVisible++}function Ie(e,t,n,r,i){if(r){const a=r.ParentSectionName;a&&-1===n.sections.indexOf(a)&&n.sections.push(a);let s=Object(Se.F)(r.ClassId);Object(Ce.c)(e,r.UniqueId,t)===Oe.d&&(s=Oe.d),_e(n,s,r.Visible),function(e,t,n){t&&n&&n[t.Name]&&(t.Parameters&&"true"===t.Parameters[ve.a]?_e(e,"QuickFormCardsByParameter",t.Visible):_e(e,"QuickFormsByParameter",t.Visible))}(n,r,i)}}var je=n("PidC"),Pe=n("5iTp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Fe(e,t,n,r,i,a,s,o){!function(e,t,n,r){const i=Object(L.h)(e,t);i&&r.push({name:"IsCustomEntity",value:i.IsCustomEntity},{name:"IsActivityEntity",value:i.IsActivity});if(n){const t=Object(L.k)(e,n);r.push({name:"HasEntityImage",value:null!=t&&t.trim().length>0})}}(e,i,a,o),function(e,t,n,r,i){const a=Object(d.d)(e,r,t);if(a){const s=Object.keys(a),o={},c=Object(d.r)(e,r);s.forEach(i=>{const s=a[i];!function(e,t,n,r,i,a,s){if(a&&i&&a.ParentTabId){const o=a.ParentTabId;let c=i[o];if(!c){const r=Object($.Jc)(e,t,o,n);c={tabName:o,sections:[],controls:{},contentType:"cardSections"},(null==r?void 0:r.contentType)&&(c.contentType=r.contentType),i[o]=c}Ie(e,r,c,a,s)}}(e,t,n,r,o,s,c)});const l=Object($.N)(e,r),u=Object($.uc)(e,t,n);i.push({name:"defaultTabId",value:l},{name:"selectedTabId",value:u},{name:"FormComplexitiesByTab",value:JSON.stringify(o)})}}(e,t,n,r,o),function(e,t){e&&null!=e.bodyOnly&&t.push({name:"BodyOnly",value:e.bodyOnly})}(s,o);const c=Object(d.w)(e,r);null!=c&&o.push({name:"NumTabs",value:c});const l=Object(d.u)(e,r);null!=l&&o.push({name:"NumSections",value:l});const u=Object(d.j)(e,r);u&&o.push({name:"HeaderDensity",value:u.HeaderDensity});let p=0;const h=Object(d.e)(e,r,t);if(null!=h){const r=[];for(const i of h)"header_process"!==i.Name&&(r.push(i),Object($.t)(e,{id:t,controlName:i.Name},n)&&p++);o.push({name:"NumHeaderFields",value:r.length}),o.push({name:"NumReadOnlyHeaderFields",value:p});const i=r.filter(e=>!Object(je.k)(e));o.push({name:"NumHeaderV2UnsupportedControls",value:i.length})}const g=Object(je.f)(e,t,n);g&&(o.push({name:"HeaderCommandBarVisible",value:g.commandBarVisible}),o.push({name:"HeaderBodyVisible",value:g.bodyVisible}),o.push({name:"HeaderTabNavigatorVisible",value:g.tabNavigatorVisible}));const m=Object(Pe.a)(e,t,n);m&&o.push({name:"FooterVisible",value:m.visible});const b=Object(d.c)(e,r,t);null!=b&&o.push({name:"NumFooterFields",value:b.length})}var Te=n("uWQm"),we=n("+zjj"),Ee=n("meVR"),xe=n("E8F2"),Ne=n("VpHT"),Ae=n("69Qu"),ke=n("pp6D"),Me=n("YxC/"),De=n("sptG"),Re=n("jTSi"),Be=n("Zzxs"),Le=n("SnEr"),Ve=n("WA3M"),ze=n("txdA"),He=n("dtbk"),Ge=n("TBkx"),We=n("ldGr"),Ue=n("3/02"),qe=n("bT7G"),Xe=n("sozv"),Ye=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Ke{constructor(e){this.type=e.type,this.raw=Object.assign({},e.raw),this.attributes=Object.assign({},e.attributes),this.error=e.error,this.errorMessage=e.errorMessage,this.security=Object.assign({},e.security),this.timerParameterAttributeValues=Object.assign({},e.timerParameterAttributeValues),this.timerParameters=Object.assign({},e.timerParameters),this.timerState=e.timerState,this.serverTimeDifferenceInSeconds=e.serverTimeDifferenceInSeconds,this.timerControlId=e.timerControlId,this.telemetryParameters=Object.assign({},e.telemetryParameters)}}var Qe=n("zmL5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Ze,Je;!function(e){e[e.CancelCondition=0]="CancelCondition",e[e.FailureCondition=1]="FailureCondition",e[e.FailureTimeField=2]="FailureTimeField",e[e.PauseCondition=3]="PauseCondition",e[e.SuccessCondition=4]="SuccessCondition",e[e.WarningCondition=5]="WarningCondition"}(Ze||(Ze={})),function(e){e[e.NoPrivilege=0]="NoPrivilege",e[e.NotSet=1]="NotSet",e[e.InProgress=2]="InProgress",e[e.Warning=3]="Warning",e[e.Violated=4]="Violated",e[e.Succeeded=5]="Succeeded",e[e.Unsucceeded=6]="Unsucceeded",e[e.Canceled=7]="Canceled",e[e.Paused=8]="Paused"}(Je||(Je={}));class $e{constructor(e,t,n){this._entityName="",this._propValue=new Ke({type:"",raw:null,attributes:{},error:!1,errorMessage:"",security:{},timerParameterAttributeValues:{},timerParameters:{},timerState:Je.NotSet,serverTimeDifferenceInSeconds:null!=n?n:0,timerControlId:t,telemetryParameters:{}})}_getTimeRemainingInMilliseconds(e){const t=(new Date).toUTCString();return new Date(e).getTime()-new Date(t).getTime()+1e3*this._propValue.serverTimeDifferenceInSeconds}_getTimerParameterAttributes(){const e=[];let t;return this._propValue&&(t=this._propValue.timerParameters)?(e.push(t.CancelConditionName),e.push(t.FailureConditionName),e.push(t.FailureTimeField),e.push(t.PauseConditionName),e.push(t.SuccessConditionName),e.push(t.WarningConditionName),e):e}_updateTimerContext(e,t,n,r){let i,a=!0;const s={},o=this._getTimerParameterAttributes(),c=Object($.ac)(e,n,r);i=0;for(const t of o){if(Object(B.b)(t)){i++;continue}const n=t;if(Object(B.b)(s[n])){const t=Object(qe.d)(e,c,this._entityRef,n),r=Object(P.a)(e,this._entityName,n);null!=r&&null!=r.IsValidForRead&&(a=r.IsValidForRead&&a),s[n]=t}this._updateTimerParameterAttributeValues(i++,s[n])}this._updateTimerState(a)}_updateTimerParameterAttributeValues(e,t){const n=this._propValue.timerParameterAttributeValues;switch(e){case Ze.CancelCondition:const e=t;n.CancelConditionAttributeValue=e&&e.valueString;break;case Ze.FailureCondition:const r=t;n.FailureConditionAttributeValue=r&&r.valueString;break;case Ze.FailureTimeField:const i=t;n.FailureTimeFieldAttributeValue=i&&i.value;break;case Ze.PauseCondition:const a=t;n.PauseConditionAttributeValue=a&&a.valueString;break;case Ze.SuccessCondition:const s=t;n.SuccessConditionAttributeValue=s&&s.valueString;break;case Ze.WarningCondition:const o=t;n.WarningConditionAttributeValue=o&&o.valueString}this._propValue.timerParameterAttributeValues=n}_updateTimerState(e){let t,n,r=Je.Violated;this._propValue&&(t=this._propValue.timerParameters)&&(n=this._propValue.timerParameterAttributeValues)&&(r=e?null==t.FailureTimeField||Object(B.b)(n.FailureTimeFieldAttributeValue)?Je.NotSet:Object(B.b)(t.FailureConditionName)||Object(B.b)(t.FailureConditionValue)||n.FailureConditionAttributeValue!==t.FailureConditionValue?Object(B.b)(t.CancelConditionName)||Object(B.b)(t.CancelConditionValue)||n.CancelConditionAttributeValue!==t.CancelConditionValue?Object(B.b)(t.SuccessConditionName)||Object(B.b)(t.SuccessConditionValue)||n.SuccessConditionAttributeValue!==t.SuccessConditionValue?Object(B.b)(t.PauseConditionName)||Object(B.b)(t.PauseConditionValue)||n.PauseConditionAttributeValue!==t.PauseConditionValue?this._getTimeRemainingInMilliseconds(n.FailureTimeFieldAttributeValue)>0?Object(B.b)(t.WarningConditionName)||Object(B.b)(t.WarningConditionValue)||n.WarningConditionAttributeValue!==t.WarningConditionValue?Je.InProgress:Je.Warning:Je.Violated:Je.Paused:Je.Succeeded:Je.Canceled:Je.Unsucceeded:Je.NoPrivilege,this._propValue.timerState=r)}getLatestData(){return this._propValue}linkToParameter(e,t){}getTimerData(e,t,n,a,o,c){let l=null,u=r.a.EMPTY;const p=a.Parameters[e];let h=r.a.EMPTY;if(!p||!this._propValue)return this._propValue;const g=0===p.Usage,m=n.id,b=p&&p.TimerParameters;if(!g||!b)return this._propValue;if(this._propValue.type=p.Type,this._propValue.timerParameters=b,n.formInfo&&(u=new r.a(n.formInfo.FormId),l=n.formInfo.EntityName,h=new r.a(n.formInfo.RecordId)),r.a.isNullOrEmpty(u)&&(u=Object(Qe.b)(t,n.id)),Object(B.b)(l)&&o&&(l=o.entityTypeName),r.a.isNullOrEmpty(h)&&o&&(h=o.id),r.a.isNullOrEmpty(u)||r.a.isNullOrEmpty(h)||Object(B.b)(l))return this._propValue;if(this._entityName=l,this._entityRef=new i.a(l,h),!this._entityRef)return this._propValue;if(!Object(Xe.b)(t,u)){const e=Object(s.b)(this._entityRef)(t,this._entityRef.etn);if(!e||!Object(Ye.b)(e.initialized))return this._propValue}if(this._updateTimerContext(t,n,m,c),n.descriptor.Parameters.timerState=this._propValue.timerState,null!=t){if(t.organization&&(t.organization.organizationId&&(this._propValue.telemetryParameters.OrgId=t.organization.organizationId.guid),t.organization.organizationSettings&&null!=t.organization.organizationSettings.isTrialOrganization&&(this._propValue.telemetryParameters.IsTrialOrganization=t.organization.organizationSettings.isTrialOrganization.toString())),t.user&&t.user.userId&&(this._propValue.telemetryParameters.UserId=t.user.userId.guid),!Object(B.b)(l)&&t.metadata&&(t.metadata.entities&&t.metadata.entities[l]&&(null!=t.metadata.entities[l].IsActivity&&(this._propValue.telemetryParameters.IsActivity=t.metadata.entities[l].IsActivity.toString()),null!=t.metadata.entities[l].IsCustomEntity&&(this._propValue.telemetryParameters.IsCustomEntity=t.metadata.entities[l].IsCustomEntity.toString()),"true"===this._propValue.telemetryParameters.IsCustomEntity?this._propValue.telemetryParameters.EntityName="":this._propValue.telemetryParameters.EntityName=l,t.metadata.entities[l].ObjectTypeCode&&(this._propValue.telemetryParameters.EntityTypeCode=t.metadata.entities[l].ObjectTypeCode.toString())),!r.a.isNullOrEmpty(u))){const e=Object(d.j)(t,u);e.FormType&&(this._propValue.telemetryParameters.FormType=e.FormType.toString()),this._propValue.telemetryParameters.FormId=u.guid}this._propValue.telemetryParameters.IsSLAEnabled=""}return this._propValue}}var et=n("5ZBI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const tt="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlTimerSelector";function nt(){const e={},t={},n={};return(i,a,s,o,c,l)=>{et.a.info(s.controlId+"."+tt+": createGetTimerData started");let u,d=!1;u=s.formInfo&&s.formInfo.RecordId?new r.a(s.formInfo.RecordId):c.id,t.hasOwnProperty(i)&&t[i]&&!r.a.isNullOrEmpty(u)||(t[i]=new $e(i,s.controlId,function(e){if(e&&e.currentServerTime)return e.currentServerTime.serverTimeDiffInSeconds;return 0}(a)));const p=t[i],h=p.getTimerData(i,a,s,o,c,l);var g,m;return null!=h?n.hasOwnProperty(i)&&n[i]&&(g=h,m=n[i],g.timerControlId===m.timerControlId&&g.timerState===m.timerState&&g.timerParameterAttributeValues.FailureTimeFieldAttributeValue===m.timerParameterAttributeValues.FailureTimeFieldAttributeValue)||(d=!0):null!=n[i]&&(d=!0),d&&(n[i]=new Ke(h),e[i]=p),et.a.info(s.controlId+"."+tt+": createGetTimerData finished"),n[i]}}var rt=n("455M"),it=n("Co7m");function at(){const e={};return(t,n,r,i,a)=>{et.a.info(r.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlBusinessProcessSelector PageId."+r.id+": createGetBusinessProcessFlowData started");if(!e[t]||it.a.Instance.hasChanged(n,a,e[t].ProcessWrapper,r.id)){const n=it.a.Instance.getBusinessProcessFlowWrapper(r.id,a);(!n||n.stages&&n.stages.length>0)&&(e[t]={ProcessWrapper:n,Type:rt.a.BusinessProcessFlow})}return et.a.info(r.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlBusinessProcessSelector PageId."+r.id+": createGetBusinessProcessFlowData finished"),e[t]}}var st=n("npAL"),ot=n("S2mk");class ct{getComponentNameByControlId(e){throw new Error("Not initialized.")}getComponentPropsByControlId(e){throw new Error("Not initialized.")}addSessionTab(e,t){throw new Error("Not initialized.")}closeSessionTab(e,t){throw new Error("Not initialized.")}updateSessionTab(e,t){throw new Error("Not initialized")}closeAllSessionTabs(e){throw new Error("Not initialized.")}dismissMessage(e){throw new Error("Not initialized.")}cleanReferencePanelState(e){throw new Error("Not initialized.")}initializeReferencePanelControl(e,t){throw new Error("Not initialized.")}markActiveTab(e,t,n){throw new Error("Not initialized.")}}var lt=n("unFF"),ut=n("BJ7u"),dt=n("GYEz"),pt=n("eOoD"),ht=n("w1eR"),gt=n("16wZ"),mt=n("P6DH"),bt=n("9fGf"),yt=n("5DN6");class ft{constructor(){this.objectWrapperType=1,this._referencePanelQuickFormCollectionControl="b68b05f0-a46d-43f8-843b-917920af806a",this._quickFormComponentName="MscrmControls.Containers.QuickForm",this._quickForm_Type="Form.QuickForm",this._searchWidgetComponentName="MscrmControls.KbSearchControl.KbSearchControl",this._searchWidget_Type="SearchWidget.SearchWidget",this._searchWidget_ControlId="KbSearchControl|",this._gridType="Grid",this._subGridType="subgrid",this._enableIndex="EnableJumpBar",this._enableViewSelector="EnableViewPicker",this._enableQuickFind="EnableQuickFind",this._memoizedComponents={},this.previousReferencePanelParameter=null}retrieveReferencePanelObject(e,t,n,r){this._pageId=t.id;const a=new i.a(n.entityTypeName,n.id),s=Object(Qe.b)(e,t.id),o=Object(d.j)(e,s),c=Object(lt.a)(e);let l,u=null,p="",h="";Object.keys(o.Sections).map(t=>{if(Object($.Mb)(e,t))return u=o.Sections[t],void(p=t)});const g=Object(yt.c)(e,t.id);if(h=this._isActiveTabHidden(e,t.id,s,g,r)?this._getNextVisibleControlId(e,t.id,s,r,g.controlNames):g.activeTabId,l=u&&u.Height?Number.parseInt(u.Height,10):10,l*=c.sizes.Section.cellHeightInRem,!this.previousReferencePanelParameter){const n=new ct;n.formDescriptor=Object.assign({},o),n.referencePanelSectionName=p,n.height=l,n.getComponentPropsByControlId=this.getComponentPropsByControlId.bind(this,o,e,a,t,r),n.getComponentNameByControlId=this.getComponentNameByControlId.bind(this,o,e);const i=Object(dt.a)(e),s=Object(dt.e)(e),c=[];return o.Sections[u.Name].Rows.forEach(n=>n.Cells.forEach(n=>{const a=o.Controls[n.ControlName],l=Object($.C)(e,t.id,n.ControlName,r),u=Object($.t)(e,{id:t.id,controlName:n.ControlName},r);if((i!==ht.a.MobileApplication||Object(gt.a)(a.Parameters.ShowOnMobileClient)||"true"===a.Parameters.ShowOnMobileClient)&&(s!==pt.a.Phone||Object(gt.a)(n.AvailableForPhone)||n.AvailableForPhone)&&n.Visible){const e=this._cloneControlWithControlState(a,l,u);c.push(e)}})),n.activeTabId=h,n.controls=c,n.addSessionTab=null,n.updateSessionTab=null,n.closeAllSessionTabs=null,n.closeSessionTab=null,n.dismissMessage=null,n.markActiveTab=null,n.initializeReferencePanelControl=null,n.cleanReferencePanelState=null,n.sessionTabs=[],this.previousReferencePanelParameter=n,this.previousReferencePanelParameter}if(g&&(this.previousReferencePanelParameter.activeTabId!==g.activeTabId||null!==this.previousReferencePanelParameter.messageId&&null===g.messageId||null===this.previousReferencePanelParameter.messageId&&null!==g.messageId||this.previousReferencePanelParameter.messageId&&g.messageId&&this.previousReferencePanelParameter.messageId!==g.messageId||this._sessionTabsChanged(g)||this._staticTabsChanged(e,t.id,s,g)||this._quickViewFormChanged(o,e,a,g.activeTabId,t,r)||this._controlStateChanged(g,e,t.id,r))){const n=new ct;n.sessionTabs=g.sessionTabs.slice(),n.activeTabId=h,n.messageId=g.messageId;const i=g.controlNames&&g.controlNames.length?g.controlNames:this.previousReferencePanelParameter.controls.map(e=>e.Name);n.controls=i.map(n=>{const i=Object(d.b)(e,t.id,s,n),a=Object($.C)(e,t.id,n,r),o=Object($.t)(e,{id:t.id,controlName:n},r);return this._cloneControlWithControlState(i,a,o)}),n.formDescriptor=Object.assign({},o),n.height=l,n.referencePanelSectionName=p,n.addSessionTab=this.previousReferencePanelParameter.addSessionTab,n.updateSessionTab=this.previousReferencePanelParameter.updateSessionTab,n.closeAllSessionTabs=this.previousReferencePanelParameter.closeAllSessionTabs,n.closeSessionTab=this.previousReferencePanelParameter.closeSessionTab,n.dismissMessage=this.previousReferencePanelParameter.dismissMessage,n.markActiveTab=this.previousReferencePanelParameter.markActiveTab,n.initializeReferencePanelControl=this.previousReferencePanelParameter.initializeReferencePanelControl,n.cleanReferencePanelState=this.previousReferencePanelParameter.cleanReferencePanelState,this.previousReferencePanelParameter=n}return this.previousReferencePanelParameter.getComponentNameByControlId=this.getComponentNameByControlId.bind(this,o,e),this.previousReferencePanelParameter.getComponentPropsByControlId=this.getComponentPropsByControlId.bind(this,o,e,a,t,r),this.previousReferencePanelParameter}_controlStateChanged(e,t,n,r){if(!e||!e.controlNames||0===e.controlNames.length||!this.previousReferencePanelParameter)return!1;for(let i=0;i<e.controlNames.length;i++){const a=e.controlNames[i],s=Object($.C)(t,n,a,r),o=Object($.t)(t,{id:n,controlName:a},r);if(this.previousReferencePanelParameter.controls[i].Visible!==(null==s?void 0:s.visible)||this.previousReferencePanelParameter.controls[i].Label!==(null==s?void 0:s.label)||this.previousReferencePanelParameter.controls[i].Disabled!==o)return!0}return!1}_isActiveTabHidden(e,t,n,r,i){for(const a of r.controlNames){const s=Object(d.b)(e,t,n,a),o=Object($.G)(e,{id:t,controlName:a},i);if((null==s?void 0:s.Id)===r.activeTabId&&!0!==o)return!0}return!1}_getNextVisibleControlId(e,t,n,r,i){var a;if(!i||!i.length)return null;for(const s of i){if(Object($.G)(e,{id:t,controlName:s},r))return null===(a=Object(d.b)(e,t,n,s))||void 0===a?void 0:a.Id}return null}_staticTabsChanged(e,t,n,r){for(let i=0;i<r.controlNames.length;i++){const a=r.controlNames[i];if(Object(d.b)(e,t,n,a).Id!==this.previousReferencePanelParameter.controls[i].Id)return!0}return!1}_sessionTabsChanged(e){if(null!==this.previousReferencePanelParameter.sessionTabs&&null===e.sessionTabs||null===this.previousReferencePanelParameter.sessionTabs&&null!==e.sessionTabs||this.previousReferencePanelParameter.sessionTabs&&e.sessionTabs&&this.previousReferencePanelParameter.sessionTabs.length!==e.sessionTabs.length)return!0;for(let t=0;t<e.sessionTabs.length;t++)if(e.sessionTabs[t].id!==this.previousReferencePanelParameter.sessionTabs[t].id)return!0;return!1}_quickViewFormChanged(e,t,n,r,i,a){if(this._isQuickViewFormControl(e.Controls[r])){const o=Object($.ac)(t,i.id,a);return Object(s.j)(t,n,e.Controls[r].DataFieldName)!==Object(qe.d)(t,o,n,e.Controls[r].DataFieldName)}return!1}_isQuickViewFormControl(e){return e&&e.ClassId&&e.ClassId.guid.toString()===this._referencePanelQuickFormCollectionControl}linkToParameter(e,t){const n=t.addSessionTab;e.addSessionTab=this.executeAddSessionTab.bind(this,n);const r=t.updateSessionTab;e.updateSessionTab=this.executeUpdateSessionTab.bind(this,r);const i=t.closeAllSessionTabs;e.closeAllSessionTabs=this.executeCloseAllSessionTabs.bind(this,i);const a=t.closeSessionTab;e.closeSessionTab=this.executeCloseSessionTab.bind(this,a);const s=t.dismissMessage;e.dismissMessage=this.executeDismissMessage.bind(this,s);const o=t.markActiveTab;e.markActiveTab=this.executeMarkActiveTab.bind(this,o);const c=t.initializeReferencePanelControl;e.initializeReferencePanelControl=this.executeInitializeReferencePanelControl.bind(this,c);const l=t.cleanReferencePanelState;e.cleanReferencePanelState=this.executeCleanReferencePanelState.bind(this,l)}executeAddSessionTab(e,t){e(t,this._pageId)}executeUpdateSessionTab(e,t){e(t,this._pageId)}executeInitializeReferencePanelControl(e,t){e(t,this._pageId)}executeCloseSessionTab(e,t){e(t,this._pageId)}executeCloseAllSessionTabs(e){e(this._pageId)}executeDismissMessage(e){e(this._pageId)}executeCleanReferencePanelState(e){e(this._pageId)}executeMarkActiveTab(e,t,n){e(t,n,this._pageId)}getComponentNameByControlId(e,t,n){const r=e.Controls[n];if(!ft._isControlDefaultMapping(e,n))return r.UniqueId;if(r.ClassId&&r.ClassId.guid.toString()===this._referencePanelQuickFormCollectionControl)return this._quickFormComponentName;const i=ft._getDefaultControlConfiguration(e,t,n);return Object(ot.z)(i)}getComponentPropsByControlId(e,t,n,r,i,a,s=!1){var o;et.a.info("CustomControlFramework.Models.Wrapper.ReferencePanelObjectWrapper: getComponentPropsByControlId started"),this._memoizedComponents[a]||(this._memoizedComponents[a]={controlId:a});const c=this._memoizedComponents[a];let l;const u=e.Controls[a],p=ft._forceReadOnlyGridOnPhone(t,e,u);if(ft._isControlDefaultMapping(e,a)||s||!e.ControlConfigurations[u.UniqueId].CustomControls[0]||p)if(a&&!u)if(a.indexOf(this._searchWidget_ControlId)>=0)l={FormFactor:2,CustomControlId:this._searchWidgetComponentName,Name:a.replace(this._searchWidget_ControlId,""),DisplayNameKey:a.replace(this._searchWidget_ControlId,""),Version:"1.0.0",Parameters:{value:{Static:!1,Type:this._searchWidget_Type}},ShouldOverrideControlVisible:!1};else{const e=a.split("|")[0],n=Object(ut.a)(6),r=Object(d.h)(t,e,n);l={FormFactor:2,CustomControlId:this._quickFormComponentName,Name:a,DisplayNameKey:a,Version:"1.0.0",Parameters:{value:{Static:!1,Type:this._quickForm_Type,Value:r.guid+":quick|"+a}},ShouldOverrideControlVisible:!1}}else l=ft._getDefaultControlConfiguration(e,t,a);else l=e.ControlConfigurations[u.UniqueId].CustomControls[0];if(this._isQuickViewFormControl(u)){const e=Object($.ac)(t,r.id,i),a=Object(qe.d)(t,e,n,u.DataFieldName),s="entityname";if(a&&a.validationResult&&a.validationResult.isValueValid){const e=(new DOMParser).parseFromString(u.Parameters[0].Value,"text/xml").getElementsByTagName("QuickFormId");for(let t=0;t<e.length;t++)if(e[t].attributes[s]&&e[t].attributes[s].nodeValue===(null===(o=a.reference)||void 0===o?void 0:o.etn)){l.Parameters.value.Value=e[t].textContent+"|"+u.DataFieldName;break}}}const h={configuration:l,descriptor:u};return(u&&u.ClassId&&"02d4264b-47e2-4b4c-aa95-f439f3f4d458"===u.ClassId.guid.toString()||p)&&this._updateConfigurationForSubGridControl(h),c.componentProps&&h.configuration===c.componentProps.configuration&&h.descriptor===c.componentProps.descriptor||(c.componentProps=h),et.a.info("CustomControlFramework.Models.Wrapper.ReferencePanelObjectWrapper: getComponentPropsByControlId finished"),c.componentProps}_updateConfigurationForSubGridControl(e){const t={DataSetUIOptions:{displayCommandBar:!0,displayIndex:e.descriptor.Parameters[this._enableIndex],displayQuickFind:e.descriptor.Parameters[this._enableQuickFind],displayViewSelector:e.descriptor.Parameters[this._enableViewSelector]}};Object.assign(e.configuration.Parameters[this._gridType],t),e.contextString=this._subGridType}static _isControlDefaultMapping(e,t){const n=e.Controls[t];return!n||!n.UniqueId||!e.ControlConfigurations[n.UniqueId]}static _forceReadOnlyGridOnPhone(e,t,n){return t&&t.ControlConfigurations&&n&&n.UniqueId&&t.ControlConfigurations[n.UniqueId]&&t.ControlConfigurations[n.UniqueId].CustomControls&&Object(mt.xb)(e,t.ControlConfigurations[n.UniqueId].CustomControls[0],Object(bt.b)(e))}static _getDefaultControlConfiguration(e,t,n){et.a.info("CustomControlFramework.Models.Wrapper.ReferencePanelObjectWrapper: _getDefaultControlConfiguration started");const i=e.Controls[n],a=e.EntityLogicalName,s=Object(ve.b)(t,a,i),o=ft._forceReadOnlyGridOnPhone(t,e,i)?"02d4264b-47e2-4b4c-aa95-f439f3f4d458":i.ClassId&&r.a.toString(i.ClassId);return et.a.info("CustomControlFramework.Models.Wrapper.ReferencePanelObjectWrapper: _getDefaultControlConfiguration finished"),Object(ot.q)(i.Id,i.DataFieldName,s,i,a,o)}_cloneControlWithControlState(e,t,n){return Object.assign(Object.assign({},e),{Label:null==t?void 0:t.label,Visible:null==t?void 0:t.visible,Disabled:n})}getLatestData(){return this.previousReferencePanelParameter}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function St(){et.a.info("CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlReferencePanelSelector: createGetReferencePanelData started");const e={},t={},n={};return(r,i,a,s,o,c)=>{let l=!1;t.hasOwnProperty(r)&&t[r]||(t[r]=new ft);const u=t[r],d=u.retrieveReferencePanelObject(i,a,o,c);return n.hasOwnProperty(r)&&n[r]&&d===n[r]||(l=!0),l&&(n[r]=d,e[r]=u),et.a.info("CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlReferencePanelSelector: createGetReferencePanelData finished"),e[r]}}var vt=n("p8cR"),Ct=n("IqkD"),Ot=n("QiMq"),_t=n("mHvI"),It=n("Exmh"),jt=n("Jsfi"),Pt=n("I8bZ"),Ft=n("nJrx"),Tt=n("K7RF");var wt=n("TYIz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Et(e,t,n){return{type:"tab.expandinitial.sync",sync:!0,execute({dispatch:r}){r(xt(t,n)),r({type:wt.a,payload:!1,meta:{pageId:t,contextKey:Object(v.v)(n),tabId:e}})}}}function xt(e,t){return{type:"tab.collapseinitial.sync",sync:!0,execute({dispatch:n,getState:r}){var i,a;const s=r(),o=Object(U.a)(s,e),c=Object(v.v)(t),l=null===(a=null===(i=null==o?void 0:o.forms)||void 0===i?void 0:i[c])||void 0===a?void 0:a.tabs;if(l)for(const t in l)if(!l[t].collapsed){n({type:wt.a,payload:!0,meta:{pageId:e,contextKey:c,tabId:t}});break}}}}var Nt=n("SDQ8");var At=n("FdKt"),kt=n("09am"),Mt=n("KXSk"),Dt=n("yUiV");var Rt=n("tT9w"),Bt=n("gQ5I"),Lt=n("gDO8"),Vt=n("wL2W");var zt=n("XVSa");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ht(e){const t=[];return n=>({type:"initialize.editFormAction.async",execute({dispatch:b,getState:f},S,C){const I=f(),j=Object($.Ib)(I,e),P=Object($.Eb)(I,e),F=S.TraceManager.getTracer(Object($.S)(j,"initializeAction")),T=Object($.R)(j,"initializeAction");!function(e){Object(vt.b)(nt,rt.a.Timer),Object(vt.b)(at,rt.a.BusinessProcessFlow),Object(vt.b)(Object(st.a)(e),rt.a.SearchWidget,rt.a.ReferencePanelSearchWidget),Object(vt.b)(St,rt.a.ReferencePanel),Object(vt.b)(ge.a,rt.a.PowerBI)}(b),function(e,t,n){if(!n){const n=function(e){return(t,n)=>(Object(Nt.a)(e),Promise.resolve())}(e);t.Router.registerPreCloseHandler(e,n)}}(e,S,P);const w=Object(y.g)(f(),e);let E=w.formId;const x=r.a.toString(E),N=w.entityTypeName,A=w.id,k=r.a.isNullOrEmpty(A),M=r.a.toString(A),R=w.selectedTabId,B=w.selectedRelatedEntity,V=Q.g+N,z=new i.a(N,A);let H,G,W,U,Y;t.push({name:"CorrelationId",value:C.correlationId},{name:"ContextId",value:C.contextId},{name:"ActionStack",value:C.stack},{name:"InitialFormId",value:x},{name:"EntityName",value:N},{name:"entityId",value:M},{name:"PageId",value:e},{name:"IsMainFormDialog",value:j.toString()}),F.info("Executing edit form initialize action.",t);const se=Object(v.j)(f(),e);t.push({name:"ContextToken",value:JSON.stringify(se)}),b(Object(ke.b)(se,e,w.entityTypeName,A));const le=function(e,t,n,i,a){if(n&&n.error)return Promise.reject(n.error);if(n&&!0===n.noFormsFound)return Promise.reject(2200000017);const s=n&&n.updatedFormId;if(!s||r.a.equals(s,r.a.EMPTY)){const e="Form descriptor is null or not defined";throw t.error(e,a),new fe.a(e)}return e(Object(he.c)(s,i)).then(()=>s)}(b,F,n,N,t),ue=Object(_t.a)(I,e),Se=b(Object(p.e)(ue)).then(()=>{t.push({name:"RetrievedResourceStringsTimeStamp",value:Date.now()}),F.info("Got resource strings",t)}),ve=P?Promise.resolve():b(Object(Z.a)(V)),_e=Object(ye.h)(f());return le.then(n=>{n!==E&&t.push({name:"FormId",value:r.a.toString(n)});const p=Object(o.e)(f,b,F,C,A,N,e);E=n,z.id===r.a.EMPTY&&b(Object(Le.b)(z));const j=Object($.N)(f(),E),T=R||(B?B.id:j);b(Object(Ot.b)(e,T)),T&&(!function(e,t,n,r,i){const a=Object($.db)(e(),n,r,!1,(e,t)=>Object(d.g)(e,n,t,i)),s=Object(d.j)(e(),r);let o=null;for(const t in s.Controls){const n=s.Controls[t];if(Object(Ce.c)(e(),n.UniqueId,r)===Oe.d){o={[t]:n};break}}const c=Object($.gc)(e(),r,i).map(t=>Object($.db)(e(),n,t));c.push(a),o&&c.push(Object($.db)(e(),n,r,!1,()=>o));const l=c.reduce((e,t)=>{for(const n in t)e[n]=t[n];return e},{}),u=[];for(const e in l)u.push(t(Object(Ne.a)(l[e])));Promise.all(u)}(f,b,e,E,T),de(f(),e,E,z,N,T)),G=Object(c.a)(f(),N);const x=Object(d.j)(f(),E);U=Object(he.d)(b,x.InlineQuickForms,I,S);const M=b(Object(a.f)(x.FormLibraries));return p.then(()=>Promise.all([Se]).then(()=>(function(e,t,n){if(!e||!n||!n.Controls)return;if(!e.clientHost||e.clientHost.subtype!==pt.a.Phone)return;const i=n.Controls.notescontrol;if(!i||!i.ParentSectionName)return;const a=n.Tabs[0];let s;const o=a.Columns.findIndex(e=>(s=e.SectionNames.indexOf(i.ParentSectionName),s>-1));if(o<0)return;const c=a.Columns[o],l=Object.assign(Object.assign({},c),{SectionNames:[i.ParentSectionName]});c.SectionNames.length>1?c.SectionNames.splice(s,1):a.Columns.splice(o,1);const u=Object.assign({},n);u.Tabs.push(Object.assign(Object.assign({},a),{Id:"tab_"+r.a.newGuid().guid,Name:"TIMELINEWALL_TAB_SYSTEM_GENERATED",Label:Object(Me.b)(e,"L_InteractionWall_Title"),Columns:[l],DomId:Object(Ft.a)(),LabelId:null})),u.TabNames.splice(1,0,"TIMELINEWALL_TAB_SYSTEM_GENERATED");const d={};d[r.a.toString(u.Id)]=u;const p={forms:d};t({type:Tt.a,payload:p})}(f(),b,x),b(Object(o.h)(E,e,se,_e)).then(()=>{W=b(Object(ae.b)(w.entityTypeName,E)).then(t=>b(Object(ae.c)(e,se,t))),F.info("initializeForm promise resolved successfully."),b(Object(h.b)(e,g.a.MetadataRetrieved))}))).catch(e=>{t.push({name:"loadResourceStringsBeforeInitializeForm.reason",value:Object(Ge.e)(e)}),F.error("Could not load resource strings prior to InitializeForm",t),Object(fe.b)(e)})).then(()=>{const n=Gt(f(),b,e,F,z,E,w,G),c=w&&w.data&&w.data[K.r],p=Object(o.d)(f(),b,N,e,S,C,c).then(()=>P||Object($.n)(I)?Promise.resolve():q(f,b,F,e,se,z,r.a.tryParse(w.processId),C,S,n,w)),W=Object(ze.d)(f(),e,E,se,T,!1,!1,k);Y=Object(Ve.a)(f,b,F,S.EventManager,e,x,A,W).inProgress,Promise.all([n,...Y]).then(pe.c);const U=S.ScriptManager.initializeContainerForClientApi(e,!Object($.Eb)(f(),e));return function(e,t,n,r,i,a){if(t)e(Object(J.b)(n,a,t)),e(Et(t,n,a));else if(r){const{id:t,title:i,entityName:s,relationshipName:o,ordinal:c}=r,l=Object(v.a)(a,o,c),u={id:t,title:i,entityName:s,isSelected:!0,relationshipName:o};e(Object(Ee.a)(n,l,u)),e(xt(n,a))}else i&&(e(Object(J.b)(n,a,i)),e(Et(i,n,a)))}(b,R,e,B,j,se),U.then(()=>function(e,t,n,r,i,a,s){return r.info("createXrmForm promise resolved successfully."),Object(o.j)(e,t,n,i,a,r,s).then(()=>{r.info("loadScripts promise defined in loadScriptsAfterClientApi() function resolved successfully.",s)}).catch(e=>(s.push({name:"loadScripts.reason",value:Object(Ge.e)(e)}),r.error("Error while executing loadScripts promise defined in loadScriptsAfterClientApi() function.",s),Promise.resolve()))}(f(),S,b,F,E,e,t).then(()=>{Object(D.c)(f(),Ue.nd)||b(Object(h.b)(e,g.a.OnLoadReady));return n.then(()=>{F.info("loadRecordData promise resolved successfully."),function(e,t,n,a){if(n.id===r.a.EMPTY)return;const o=Object(L.h)(e,n.etn),c=Object($.ec)(e,n.etn,n.id);if(!c){const t=[];if(t.push({name:"title",value:""+c}),t.push({name:"identifier.etn",value:n.etn}),t.push({name:"identifier.id",value:r.a.toString(n.id)}),o){const r=new i.a(n.etn,n.id),a=Object(s.j)(e,r,o.PrimaryNameAttribute);t.push({name:"entityDetails.PrimaryNameAttribute",value:o.PrimaryNameAttribute}),t.push({name:"nonFormattedPrimaryNameAttributeValue has value",value:!!a})}else t.push({name:"entityDetails",value:""+o});a.EventManager.ReportComponentFailure("MRU.EditForm.InitializeAction",new Error("Title for recent item is null or empty."),"Analyze event parameters to understand why Title is empty.",t)}const l={RecordType:ie.a.Entity,EntityTypeName:n.etn,LastAccessed:new Date,ObjectId:n.id,Title:c,IconPath:Object(L.j)(e,n.etn,n.id),HasPrimaryImageField:o&&!!o.PrimaryImageAttribute};t(Object(re.b)(l))}(f(),b,z,S);const n=function(e,t,n,r,i){let a=[];const s=Object(we.f)()(e(),{id:n,isFromInitializeAction:!0});if(s){let o=null,c=null;s.forEach(e=>{if(e&&e.relatedItems&&(a=a.concat(e.relatedItems),t.id&&t.navItemId))for(const n of e.relatedItems)if(n.id.toLowerCase()===t.navItemId.toLowerCase()){c={id:n.id,title:n.title,isSelected:!0,entityName:n.entityName,relationshipName:n.relationshipName},o=Object(v.a)(r,n.relationshipName,n.ordinal);break}});const l=Object(Ct.w)(e()),u=l?l.languageId:null;if(i(Object(He.b)(n,a,u)),c&&o)return i(Object(Ee.a)(n,o,c)).then(a=>{if(t.bodyOnly){const s=Object(be.b)(n,t.entityTypeName,e(),a,r);if(s)return i(Object(me.c)(n,s)),!0}})}return Promise.resolve(!1)}(f,w,e,se,b);if(function(e,t,n,r,i){const a=Object(s.t)(e,i);if(!a)return;for(let o=0;o<a.length;o++){const c=a[o],l=[];if(c.Parameters)for(let t=0;t<c.Parameters.length;t++){const a=c.Parameters[t];if(a.ParameterType===jt.a.Attribute){const t=Object(s.j)(e,i,a.Data);if(t){const e=t.reference,i=()=>{const t={entityTypeName:e.etn,id:e.id};r(Object(te.a)("EditForm",t,n))};l.push({Label:e.name,Handler:i})}}else a.ParameterType===jt.a.String&&l.push({Label:a.Data})}let u=ne.a.information;switch(c.Severity){case Pt.a.Warning:u=ne.a.warning;break;case Pt.a.Error:u=ne.a.error}r(Object(ee.c)(t,n,c.Message,u,"serverNotification_"+o,void 0,l))}}(f(),se,e,b,z),H=function(e,t,n,i,o,c,l,u,p,h){const g=[],m=Object($.fc)(e,i,o),b=Object($.gc)(e,l,u);for(const l in m){const u=Object($.C)(e,i,l,o),y=u?u.dataFieldName:null,f=Object(s.j)(e,c,y);if(f){const s=f.reference;if(!s)break;const c=m[l][s.etn];if(!r.a.isNullOrEmpty(c)){const r=b.indexOf(c)>=0;if(r){const r=Object(L.h)(e,s.etn),i=[];r&&!!r.PrimaryImageAttribute&&i.push(Object(be.a)(r.PrimaryImageAttribute,null,null));const o=t(Object(a.e)(s,c,null,i,!0)).catch(e=>{const t=s.id?s.id.guid:"Invalid associated recordId.";p.push({name:"retrieveRecordDataForForm.Reason",value:Object(Ge.e)(e)},{name:"associatedRecordId",value:t},{name:"entityRef.etn",value:s.etn}),n.error("Error while executing dataPromise promise by calling loadQuickFormsData() function. Check EventContext for retrieveRecordDataForForm.Reason to see which catch block this error occurred.",p),Object(fe.b)(e)});g.push(o)}if(Object(Ae.b)(e)){const a=Object(ze.j)(e,i,[c],o,r);if(s.id&&a&&Object.keys(a).length>0){const r=Object(d.j)(e,c),o=Object(Ve.a)(()=>e,t,n,h.EventManager,i,r,s.id,a).inProgress;g.push(...o)}}}}}return Promise.all(g).then(()=>{g.length<=0&&n.warn("No dataPromises within EditForm while calling loadQuickFormsData() function.",p)}).catch(e=>{p.push({name:"Promise.all.Reason",value:Object(Ge.e)(e)}),n.error("Error with dataPromises in EditForm while calling loadQuickFormsData() function. Check EventContext for Promise.all.Reason to see which catch block this error occurred.",p)})}(f(),b,F,e,se,z,E,T,t,S),b(Object(m.a)(e,se)),r.a.isNullOrEmpty(w.id)){const n=Object(d.j)(f(),E),r=[K.q,K.u,K.v,K.w];Object(o.c)(f(),b,N,e,r,n.Attributes,se,F,t)}return p.then(()=>(Object(D.c)(f(),Ue.L)&&b(Object(We.c)(N,e,se)),M.then(()=>{if(Object(D.c)(f(),Ue.nd)&&b(Object(h.b)(e,g.a.OnLoadReady)),Object(o.k)(f(),S,b,se,e,F,t),k){S.ScriptManager.getContainer(e).getEventManager().addOnProcessChangeEvent(se,()=>{!P&&b(function(e){return{type:"Forms.EditForm.InjectBPFFields",sync:!0,execute({dispatch:t,getState:n},r,a){const o=n(),c=Object(y.g)(o,e);if(c){const a=c.id,l=new i.a(c.entityTypeName,a),u=Object(v.j)(o,e);if(Object(s.e)(o,l)){const i=r.TraceManager.getTracer("initializeNewBpf.editFormAction.async");return X(l,u,e,t,n,i)}}}}}(e)),b(Object(We.c)(N,e,se))})}b(Object(l.a)(!0,e,se)),!P&&!Object($.q)(I)&&b(Object(u.a)(V,e,e,se)),oe.a.createEvent("FormOnloadCompleteEvent",ce.g).createMarker(),b(Object(h.b)(e,g.a.EditReady)),O.a.addCommonKpiParameters({[_.b.FormId]:r.a.toString(E)}),n.then(t=>{if(!t){const t=Object(be.c)(e,N,f(),se);t&&b(Object(me.c)(e,t))}})}).catch(e=>{t.push({name:"retrieveRecordDataForOrganization.Reason",value:Object(Ge.e)(e)}),Object(fe.b)(e)}))).catch(e=>{t.push({name:"loadBusinessProcessFlow.Reason",value:Object(Ge.e)(e)}),Object(fe.b)(e)})}).catch(e=>{t.push({name:"loadRecordData.Reason",value:Object(Ge.e)(e)}),F.error("Error while executing loadRecordData promise. Check EventContext for retrieveRecordDataForOrganization.Reason, loadBusinessProcessFlow.Reason and loadRecordData.Reason to see which catch block this error occurred.",t),Object(fe.b)(e)})}).catch(e=>{t.push({name:"loadScriptsAfterClientApi.Reason",value:Object(Ge.e)(e)}),Object(fe.b)(e)})).catch(e=>{t.push({name:"initializeContainer.Reason",value:Object(Ge.e)(e)}),Object(fe.b)(e)})}).catch(e=>{const n=e;n&&n.getNegativeErrorCode&&-2147220969===n.getNegativeErrorCode()&&b(Object(Te.c)(A,Object(Ae.b)(f()))),t.push({name:"checkEntityEnabledForUCIPromise.Reason",value:Object(Ge.e)(e)}),Object(fe.b)(e)})}).then(()=>Promise.all([Se,ve,H,W,U]).then(()=>{!function(e,t,n,r){const i=Object(y.g)(e,n);Object($.kb)(e,{id:n},t)&&i.isOfflineSyncError&&(r(Object(Re.b)(t,n,Be.c)),r(Object(ee.c)(t,n,Object(Me.b)(e,De.e),ne.a.error,"osn_"+(new Date).getMilliseconds())))}(f(),se,e,b)})).then(()=>{Fe(f(),e,se,E,N,z,w,t),S.EventManager.ReportComponentSuccess(T,t),b(Object(h.b)(e,g.a.FullLoad)),
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,n,i,a){Object(At.b)(()=>{var o,c,l,u,d,p,h;const g=e(),m=[];for(const b in a.Controls){const y=a.Controls[b];if(Object(Ce.c)(g,y.UniqueId,a.Id)===Oe.d){const f=Object(s.j)(g,i,y.DataFieldName),S=null===(o=null==f?void 0:f.reference)||void 0===o?void 0:o.etn,v=null===(c=null==f?void 0:f.reference)||void 0===c?void 0:c.id;if(!v||!S)continue;const C=null===(l=Object($.Mc)(g,{id:t,controlName:b},n))||void 0===l?void 0:l.initializationIntent,O=Object(Ce.b)(g,y.UniqueId,a.Id),_=Object(bt.b)(g),I=(null===(p=null===(d=null===(u=null==O?void 0:O.CustomControls)||void 0===u?void 0:u[_])||void 0===d?void 0:d.Parameters)||void 0===p?void 0:p.QuickForms).Value;let j;if(I&&(j=r.a.tryParseOrNull(null===(h=Object(kt.a)(I,S))||void 0===h?void 0:h[S])),Object(Mt.a)(e(),t,b))continue;if("fullload"===C){const e={entityTypeName:S,pageType:"entityrecord",formId:j,id:v};m.push({input:e,controlName:b})}}}m.reduce((n,r)=>n.then(()=>{let n=Object(Mt.a)(e(),t,r.controlName);return n?Promise.resolve():new Promise((i,a)=>{Object(At.b)(()=>{if(n=Object(Mt.a)(e(),t,r.controlName),n)return i();Object(Dt.a)(Object(Nt.b)(t,r.controlName),r.input).then(()=>i())},"initialize form component")})}),Promise.resolve())},"load form components")}(f,e,se,z,Object(d.j)(I,E)),function(e,t,n,r){Object(Vt.a)()&&(e(function(e){const t=[];return{type:"formChecker.RelatedMenu.async",async execute({dispatch:n,getState:r},i){var a;const s=r(),o=null===(a=null==i?void 0:i.TraceManager)||void 0===a?void 0:a.getTracer(`${_.k}${_.p}`),c=Object(_t.b)();await n(Object(p.e)(c));const l=r(),u=Object(Me.e)(l,c),d=[];if(Object(we.h)(l,{id:e})){const t=Object(we.f)()(s,{id:e,getAllMenuItemsForFormChecker:!0}),n=Object(y.g)(l,e),r=null==n?void 0:n.entityTypeName;null==t||t.forEach(e=>{e&&e.relatedItems&&e.relatedItems.forEach(t=>{var n,i,a,s;if(t){const o=(null===(n=t.displayStateReason)||void 0===n?void 0:n.reason)?Object(Me.c)(u,t.displayStateReason.reason):null,c=t.labelSource?Object(Me.c)(u,t.labelSource):null,l={Id:t.id,Label:t.title,Area:e.areaName,"Primary Entity":r,"Related Entity":t.entityName,Relationship:t.relationshipName,Displayed:null===(a=null===(i=t.displayStateReason)||void 0===i?void 0:i.displayed)||void 0===a?void 0:a.toString(),"Displayed State Reason":`[${null===(s=t.displayStateReason)||void 0===s?void 0:s.reason}]`+(o?": "+o:""),"Label Source":`[${t.labelSource}]`+(c?": "+c:"")};d.push(l)}})})}else{const e=we.a.NotDisplayed_ShowNavigationItemsOptionDisabled,t=e.reason?Object(Me.c)(u,e.reason):null;d.push({Displayed:"false","Displayed State Reason":`[${e.reason}]`+(t?": "+t:"")})}t.push({name:_.v,value:_.p}),t.push({name:_.p,value:JSON.stringify(d)}),null==o||o.warn(_.n,t)}}}(t)),e(Object(zt.a)(t,n,r)))}(b,e,se,N),Promise.all(Y).catch(()=>{F.warn("Executing edit form initialize action : controlPromises.",t)})}).catch(n=>{if(Fe(f(),e,se,E,N,z,w,t),2200000017===n){const t=Object(xe.b)(f(),e,2200000017);b(Object(Rt.b)(t,!0,e)).then(()=>{b(Object(Bt.e)(e,"dismiss"))})}else b(Object(Lt.b)(e,Object(fe.c)(n))),Object(xe.h)(f(),e,n,t,S,T),Object(fe.b)(n)})},getFailureParameters:e=>(Object(xe.a)(e,t),t)})}function Gt(e,t,n,s,o,c,l,u){const d=Object($.Eb)(e,n)?null:function(e,t){const n=r.a.tryParseOrNull(e.processId),a=r.a.tryParseOrNull(e.processInstanceId);if(t&&t.etn&&t.id&&n&&a){const e=i.a.toLegacyEntityReference(new i.a("businessprocessflowinstance",n)),r=i.a.toLegacyEntityReference(new i.a("businessprocessflowinstance",a));return new It.a(i.a.toLegacyEntityReference(t),e,r)}return new It.a(i.a.toLegacyEntityReference(t),null,null)}(l,o);return t(Object(a.e)(o,c,d,u,!0)).then(()=>{oe.a.createEvent("DataLoaded",ce.g).createMarker()}).catch(e=>{const t=[{name:"retrieveRecordDataForForm.Reason",value:Object(Ge.e)(e)}];Object(xe.a)(e,t),s.error("Error while executing retrieveRecordDataForForm promise defined in loadRecordData() function. Check EventContext for retrieveRecordDataForForm.Reason to see which catch block this error occurred.",t),Object(fe.b)(e)})}},GodX:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("2YQW"),i=n("jsFU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a=Object(r.d)({[i.a]:function(e,t){return Object.assign({},t.payload.formlessControlOutputs)}},{})},GxhD:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e,t){this._etn=null,this._attributeName=null,this._etn=e,this._attributeName=t}get etn(){return this._etn}set etn(e){this._etn=e}get attributeName(){return this._attributeName}set attributeName(e){this._attributeName=e}}},"H+1e":function(e,t,n){"use strict";n.d(t,"a",(function(){return A})),n.d(t,"c",(function(){return k})),n.d(t,"b",(function(){return M}));var r=n("2YQW"),i=n("VcAV"),a=n("y60j"),s=n("i1f0"),o=n("Z/4N"),c=n("arV0"),l=n("WIoD"),u=n("455M"),d=n("unFF"),p=n("ZGH+"),h=n("Oyec");var g=n("jRy5"),m=n("dHD5"),b=n("iZ7K"),y=n("69Qu"),f=n("BFlg"),S=n("P6DH"),v=n("b8TU"),C=n("GYEz"),O=n("SAYH"),_=n("sZ+8"),I=n("LbMF"),j=n("3/02"),P=n("Lyxw"),F=n("4leG"),T=n("zmL5"),w=n("YxC/"),E=n("1fn7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const x=[u.a.LookupSimple,u.a.LookupPartyList,u.a.LookupRegarding,u.a.LookupOwner,u.a.LookupCustomer,u.a.LookupMultiEntity],N=[l.c,l.i,l.h];var A;function k(){let e=null,t=null,n=null,v=null,A=null,k=null,D=null,R=null,B=null,L=null,V=null,z=null,H=!1,G=0,W=null,U={descriptor:null,configuration:null,configurations:null,contextKey:null,defaultCellStyle:null,spacerCellStyle:null,extraSidePaddingStyle:null,parentContextToken:null,formInfo:null,clientHost:null,clientHostSubtype:null,isRemoteAvailable:!1,isEntityEnabledForOffline:!1,informationAvailableToRender:!1,cellControlMode:0,isCreateForm:!1,isRelatedDataSetControl:!1,isPreviewMode:!1};const q=Object(s.h)(),X=function(){let e=null,t=null,n=null,r=null;return(o,l)=>{if(!l.controlName)return t;null===r&&(r=Object(P.c)(o,j.bd));const u=Object(T.b)(o,l.id);if(u){const d=Object(m.j)(o,l.id);let p=Object(a.b)(o,l.id,u,l.controlName);if(p){let a=p.Visible,u=p.Label,h=p.Disabled,g=p.Parameters&&p.Parameters.DisableMru,b=p.Url;const v=Object(s.w)(o,l,d);i.c(v)||(u=v);const C=Object(s.G)(o,l,d);i.c(C)||(a=C);const _=Object(s.t)(o,l,d);i.c(_)||(h=_);const I=Object(s.D)(o,l,d);i.c(I)||(b=I);const j=Object(s.x)(o,l,d);i.c(j)||(g=j);let P=O.a.tryParseOrNull(Object(s.K)(o,l.id,l.controlName,d));if(P&&O.a.equals(P,n)){const e=Object(m.p)(d,l.controlName),t=Object(m.v)(e),n=Object(m.h)(t);P=Object(S.T)(o,l.id,n,l.controlName)||P}if(!O.a.equals(P,n)){n=P;for(const e in p.Parameters)if(p.Parameters[e].Name===f.C){p=Object.assign({},p),r&&(p.Parameters=Object.assign({},p.Parameters),p.Parameters[e]=Object.assign({},p.Parameters[e])),p.Parameters[e].Value=O.a.toString(P);break}p.Parameters[f.C]=O.a.toString(P)}if("TaskBasedFlow"!==Object(c.l)(o,l.id)||Object(y.b)(o)||(h=!0),p!==e||a!==t.Visible||u!==t.Label||h!==t.Disabled||b!==t.Url||g!==t.Parameters.DisableMru){e=p;const n=b?Object.assign(Object.assign({},e.Parameters),{Url:b,isCustomSrc:Object(s.E)(o,l,d),length:e.Parameters.length}):e.Parameters;t=Object.assign(Object.assign({},p),{Visible:a,Label:u,Disabled:h,Url:b,Parameters:n}),t.Parameters.DisableMru=g}}else e=null,t=null}return t}}(),Y=function(){let e=null;return(t,n,r)=>{const a=r;if(a&&a.Relationship){const r=Object(s.U)(t,n,a.Relationship);if(r)e&&e.EntityName===r.etn&&e.RecordId===r.id.guid||(e={EntityName:r.etn,RecordId:r.id.guid});else{const r=Object(c.g)(t,n.id);if(r){const n=Object(b.x)(t,r.entityTypeName,a.Relationship);n&&n.ReferencedEntity&&(e&&e.EntityName===n.ReferencedEntity&&i.c(e.RecordId)||(e={EntityName:n.ReferencedEntity}))}}}return e}}(),K=M(),Q=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e=null,t=null;return function(n,r){const i=Object(d.a)(n),a=Object(p.a)(i.sizes.Section.cellHeightInRem);if(t!==i){t=i;const n=Object(h.a)(i);e={defaultCellStyle:{flex:"1 1 auto",width:"100%",whiteSpace:"nowrap",overflowX:"hidden",overflowY:"hidden",minHeight:a+"px"},spacerCellStyle:{height:i.sizes.Measures.Measure350},extraSidePaddingStyle:{paddingLeft:n.paddingLeft,paddingRight:n.paddingRight,width:"auto"}}}return e}}();return(a,p)=>{const h=X(a,p);let b=t,S=v,M=A,Z=k;const J=Y(a,p,h),$=Object(C.a)(a),ee=Object(C.e)(a);let te=!0;h&&h.Relationship&&J&&i.c(J.RecordId)&&(h.Disabled=!0);const ne=Object(T.b)(a,p.id),re=h?Object(o.b)(a,h.UniqueId,ne):null;if((h&&(h!==e||h.Parameters.hasOwnProperty(s.d))||0!==G)&&(b=q(a,h,p.id,ne,J&&J.EntityName,!1,M)),0===G&&b&&h&&h.Parameters&&Object(P.c)(a,j.y)){const e=h.Parameters,t=O.a.tryParse(e.VisualizationId);O.a.isNullOrEmpty(t)||"Chart"!==e.ChartGridMode||(G=2)}!S&&b&&(Z=Object(m.j)(a,p.id),M=Object(m.p)(Z,p.controlName),S=Object(m.v)(M));const ie=Object(s.u)(a,{id:p.id,controlName:p.controlName},Z)?Object(w.b)(a,E.d)||"The control has been disabled with a URL parameter":null;if(0===G&&b){const e=h&&h.ClassId&&h.ClassId.guid?h.ClassId.guid:null;e&&u.a.ClassIdControlMap[e.toLowerCase()]===f.t&&(G=1),0===G&&b&&b.Parameters&&Object.keys(b.Parameters).map(e=>b.Parameters[e]).filter(e=>e.Type===u.a.Grid).length>0&&(G=1)}if(1===G)M=Object(m.p)(Z,h.Name),S=Object(m.v)(M);else if(b&&b.Parameters&&b.Parameters.value){const e=b.Parameters.value;if(x.indexOf(e.Type)>-1){const t=e;if(t){const e=Object(s.C)(a,p.id,b.Name,Object(m.j)(a,p.id)),n=e&&e.parameters&&e.parameters.DefaultViewId,r=e&&e.parameters&&e.parameters.defaultviewid;r?t.ViewId=r:n&&(t.ViewId=n)}}}R=K(p,a,M);const ae=Object(r.e)(k,Z),se=Object(r.e)(A,M),oe=Object(y.b)(a),ce=!(!J||!J.EntityName)&&Object(_.l)(a,J.EntityName);if(M&&M.parentContextToken&&M.parentContextToken.contextTokenType===g.a.MainForm&&Object(s.Rc)(a,p.id,h)){let e=M.parentContextToken.entityTypeName;if(J&&J.EntityName)e=J.EntityName;else{const t=Object(c.g)(a,p.id);t&&t.entityTypeName&&(e=t.entityTypeName)}Object(I.a)(a,e,h.DataFieldName)||(te=!1)}const le=Object(c.m)(a,p.id);let ue=!1;if(1!==G&&2!==G||(ue=!!(h&&h.Parameters&&h.Parameters.RelationshipName)),h!==e||b!==t||J!==D||n!==re||!ae||!se||B!==$||L!==ee||V!==oe||z!==ce||H!==te||G!==U.cellControlMode||le!==U.isCreateForm||ue!==U.isRelatedDataSetControl||W!==ie){const r=Q(a,p);if(h&&h.ClassId&&(O.a.equals(h.ClassId,l.e)&&(r.defaultCellStyle.overflowX="visible",r.defaultCellStyle.overflowY="visible"),de=h.ClassId,N.filter(e=>O.a.equals(de,e)).length>0)){const e=Object(d.a)(a);r.defaultCellStyle.minHeight=(p.rowSpan?p.rowSpan:1)*e.sizes.Section.cellHeightInRem+"rem"}U={descriptor:h,configuration:b,configurations:re,contextKey:S,contextToken:M,defaultCellStyle:r.defaultCellStyle,spacerCellStyle:r.spacerCellStyle,extraSidePaddingStyle:r.extraSidePaddingStyle,parentContextToken:Z,customControlPropertyBag:R,formInfo:J,clientHost:$,clientHostSubtype:ee,isRemoteAvailable:oe,isEntityEnabledForOffline:ce,informationAvailableToRender:te,cellControlMode:G,isCreateForm:le,isRelatedDataSetControl:ue,isPreviewMode:Object(F.d)(a),disableWebResourceControlsMessage:ie},e=h,t=b,v=S,A=M,k=Z,D=J,n=re,B=$,L=ee,V=oe,z=ce,H=te,W=ie}var de;return U}}function M(){const e={Usage:1,Static:!0,Type:"WholeNumber.None",Value:0,Primary:!1},t={Usage:1,Static:!0,Type:"WholeNumber.None",Value:0,Primary:!1},n={Usage:1,Static:!0,Type:"WholeNumber.None",Value:A.EditForm,Primary:!1},r={Usage:1,Static:!0,Type:"TwoOptions",Value:!1,Primary:!1},i={Usage:1,Static:!0,Type:"TwoOptions",Value:!1,Primary:!1},a={Usage:1,Static:!0,Type:"TwoOptions",Value:!0,Primary:!1},o={Usage:1,Static:!0,Type:"TwoOptions",Value:!1,Primary:!1};let c={deviceSizeMode:e,viewportSizeMode:t,syncError:r,isEmpty:a,scope:n,forceColumnLayout:i,autoExpand:o};return(l,u,p)=>{const h=Object(s.Cc)(u,l,p),g=function(e){const t=Object(d.a)(e),n=t.sizes.Breakpoints.DimensionM,r=t.sizes.Breakpoints.DimensionS,i=Object(v.c)(e);return i<r?2:i<n?1:0}(u),m=1===l.cellLabelPosition;return l.cellSizeMode===e.Value&&h===r.Value&&l.scope===n.Value&&g===t.Value&&m===i.Value&&l.autoExpand===o.Value||(e.Value=l.cellSizeMode,t.Value=g,n.Value=l.scope,r.Value=h,i.Value=m,o.Value=l.autoExpand,c={deviceSizeMode:e,viewportSizeMode:t,scope:n,isEmpty:a,syncError:r,forceColumnLayout:i,autoExpand:o}),c}}!function(e){e[e.Header=0]="Header",e[e.EditForm=1]="EditForm",e[e.Footer=2]="Footer"}(A||(A={}))},HAeo:function(e,t,n){"use strict";n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return x}));var r=n("0nOn"),i=n("arV0"),a=n("3yqi"),s=n("AbXy"),o=n("SAYH"),c=n("B9jE"),l=n("16wZ"),u=n("P6DH"),d=n("qshH"),p=n("i1f0"),h=n("Uv1Y"),g=n("dHD5"),m=n("ZIjf"),b=n("IaGr");let y;class f{constructor(e,t,n,i,a){this._pageId=n,y=e,this._contextToken=t,this._controlName=i,this._gridType=a,this._clientApiExecutor=new r.a(e,"ClientApi.XrmViewSelector.",n,t,[{name:"controlName",value:i,isEventParam:!0},{name:"gridType",value:a,isEventParam:!0,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"store",value:e,isRequired:!0}])}setCurrentView(e){this._clientApiExecutor.executeAsync("setCurrentView",(t,n)=>e&&e.id?y.dispatch(Object(c.a)(this._pageId,this._contextToken,this._controlName,e.id)):(n.push({name:"validationError",value:"true"}),b.a.getInstance().traceManager.getTracer(t).error("View ID is required",n),Promise.resolve()))}getCurrentView(){const e="ClientApi.XrmViewSelector.getCurrentView";try{m.a.instance.reportCall(e);const t=Object(u.hb)(y.getState(),this._pageId,this._contextToken,this._controlName);let n=null,r=null;if(t)r=t.ViewId;else if(3===this._gridType){const t={id:this._pageId},n=Object(p.fb)(y.getState(),t,this._contextToken.parentContextToken),i="ViewId";if(!(n&&n.Controls&&n.Controls[this._controlName]&&n.Controls[this._controlName].Parameters&&n.Controls[this._controlName].Parameters[i])){let t;n?n.Controls?n.Controls[this._controlName]?n.Controls[this._controlName].Parameters?n.Controls[this._controlName].Parameters[i]||(t="formDescriptor.Controls[this._controlName].Parameters[propertyViewId] is null or undefined"):t="formDescriptor.Controls[this._controlName].Parameters is null or undefined":t="formDescriptor.Controls[this._controlName] is null or undefined":t="formDescriptor.Controls is null or undefined":t="formDescriptor is null or undefined";const r=d.a.getInstance().getEventParameters(this._contextToken);return r.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,new h.a(t),null,r),null}r=n.Controls[this._controlName].Parameters[i]}if(r){if(n=Object(u.qb)(y.getState(),o.a.parse(r),this._pageId),n){const t={entityType:Object(u.ob)(y.getState(),r,this._pageId),id:o.a.externalGuid(n.viewId),name:n.title};return m.a.instance.reportSuccess(e),t}const t=[];return t.push({name:"controlName",value:this._controlName}),t.push({name:"contextKey",value:Object(g.v)(this._contextToken)}),d.a.getInstance().reportFailure(e,new Error("ViewDescriptor is coming as null"),null,t),null}const i=[];return i.push({name:"controlName",value:this._controlName}),i.push({name:"contextKey",value:Object(g.v)(this._contextToken)}),d.a.getInstance().reportFailure(e,new Error("viewId is coming as null or undefined"),null,i),null}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,n),t}}isVisible(){const e="ClientApi.XrmViewSelector.isVisible";try{if(m.a.instance.reportCall(e),Object(l.a)(this._isVisible)){const t=Object(u.hb)(y.getState(),this._pageId,this._contextToken,this._controlName);if(t)this._isVisible=t.EnableViewPicker;else{const t={id:this._pageId},n=Object(p.fb)(y.getState(),t,this._contextToken.parentContextToken),r="EnableViewPicker";if(!(n&&n.Controls&&n.Controls[this._controlName]&&n.Controls[this._controlName].Parameters&&n.Controls[this._controlName].Parameters[r])){const t=d.a.getInstance().getEventParameters(this._contextToken);return t.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,new h.a("FormDescriptor is null"),null,t),!1}this._isVisible=n.Controls[this._controlName].Parameters[r]}}return m.a.instance.reportSuccess(e),this._isVisible}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,n),t}}}var S=n("ghNp"),v=n("OQLa"),C=n("rQHy"),O=n("iOrn"),_=n("iZ7K"),I=n("d0w6"),j=n("deGN"),P=n("Lyxw"),F=n("3/02"),T=n("whN/");let w;class E{constructor(e,t,n,i,a,s,o,c){this._relationship=null;const u="ClientApi.XrmGridControl.constructor";e||Object(l.j)(u,"store"),t||Object(l.j)(u,"contextToken"),n||Object(l.j)(u,"pageId"),w=e,this._pageId=n,this._contextToken=t,this._controlName=c,this._isEditable=i,this._gridType=a,this._applicationContext=o,s||w.dispatch(Object(S.a)(this,n,t)),this._clientApiExecutor=new r.a(e,"ClientApi.XrmGridControl.",n,t),this._clientApiExecutor.addEventParameter({name:"controlName",value:c,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"isEditable",value:i,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"isCallFromSubgrid",value:s,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"gridType",value:a,isEventParam:!0})}get _connectedControlProps(){return{controlName:this._controlName,id:this._pageId}}setFilterXml(e){this._clientApiExecutor.executeAsync("setFilterXml",()=>{const t=(new Date).getTime();return w.dispatch(Object(O.b)(e,1,this._pageId,this._contextToken,t))})}getFilterXml(){const e="ClientApi.XrmGridControl.getFilterXml";try{m.a.instance.reportCall(e);const t=Object(u.u)(w.getState(),this._pageId,this._contextToken);return m.a.instance.reportSuccess(e),t}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,n),t}}getFetchXml(){const e="ClientApi.XrmGridControl.getFetchXml";try{m.a.instance.reportCall(e);const t=Object(u.A)(w.getState(),this._contextToken,{id:this._pageId});return m.a.instance.reportSuccess(e),t}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,n),t}}getGrid(){const e="ClientApi.XrmGridControl.getGrid";try{return m.a.instance.reportCall(e),!this._grid&&this.getEntityName()&&(this._grid=new s.a(w,this._applicationContext,this._contextToken,this._pageId,this.getEntityName(),this._isEditable,this._controlName)),m.a.instance.reportSuccess(e),this._grid}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,n),t}}getViewSelector(){const e="ClientApi.XrmGridControl.getViewSelector";try{return m.a.instance.reportCall(e),this._viewSelector||(this._viewSelector=new f(w,this._contextToken,this._pageId,this._controlName,this._gridType)),m.a.instance.reportSuccess(e),this._viewSelector}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,n),t}}getTeamTemplateId(){const e="ClientApi.XrmGridControl.getTeamTemplateId";try{m.a.instance.reportCall(e);let t=null;const n=w.getState();if(Object(P.c)(n,F.c)){if(this.getEntityName()&&3===this._gridType){const e=Object(p.fb)(n,this._connectedControlProps,this._contextToken.parentContextToken),r="TeamTemplateId";e&&e.Controls&&e.Controls[this._controlName]&&e.Controls[this._controlName].Parameters&&e.Controls[this._controlName].Parameters[r]&&(t=e.Controls[this._controlName].Parameters[r])}}return m.a.instance.reportSuccess(e),t}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,n),t}}getEntityName(){return this._clientApiExecutor.execute("getEntityName",(e,t)=>{if(!this._entityName){if(this._entityName=Object(u.F)(w.getState(),this._pageId,this._contextToken,this._controlName),!this._entityName&&3===this._gridType){const n=Object(p.fb)(w.getState(),this._connectedControlProps,this._contextToken.parentContextToken),r="TargetEntityType";if(!(n&&n.Controls&&n.Controls[this._controlName]&&n.Controls[this._controlName].Parameters&&n.Controls[this._controlName].Parameters[r])){let i;return n?n.Controls?n.Controls[this._controlName]?n.Controls[this._controlName].Parameters?n.Controls[this._controlName].Parameters[r]||(i="formDescriptor.Controls[this.name].Parameters[targetEntityType] is null or undefined"):i="formDescriptor.Controls[this.name].Parameters is null or undefined":i="formDescriptor.Controls[this.name] is null or undefined":i="formDescriptor.Controls is null or undefined":i="formDescriptor is null or undefined",this._clientApiExecutor.reportFailure(e,new h.a(i),t),null}this._entityName=n.Controls[this._controlName].Parameters[r]}if(!this._entityName)return this._clientApiExecutor.reportFailure(e,new h.a("Logical name of the entity type is coming as null or undefined."),t),null}return this._entityName})}refresh(){this._clientApiExecutor.executeAsync("refresh",()=>w.dispatch(Object(c.a)(this._pageId,this._contextToken,this._controlName)))}refreshRibbon(){this._clientApiExecutor.executeAsync("refreshRibbon",()=>w.dispatch(Object(C.a)(this._pageId,Object(u.w)(w.getState(),this._pageId,this._contextToken))))}getUrl(e){const t="ClientApi.XrmGridControl.getUrl";try{m.a.instance.reportCall(t);let n=null,r=null;const i=this._getCurrentView();r={entityTypeName:this.getEntityName()},i&&(r.viewType="savedquery"===i.entityType?I.b.savedview:I.b.userview,r.viewId=new o.a(i.id)),n=a.a.Grid;let s=null;if(1===e)s=w.dispatch(Object(v.a)(n,r));else{const e=Object(j.a)(w,this._pageId);s=w.dispatch(Object(v.c)(e,n,r))}return m.a.instance.reportSuccess(t),s}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,e,null,n),e}}getRecordSetQueryKey(){return this._clientApiExecutor.execute("getRecordSetQueryKey",()=>Object(u.cb)(w.getState(),this._contextToken,{id:this._pageId}))}getGridType(){return m.a.instance.reportUsage("ClientApi.XrmGridControl.getGridType"),this._gridType}getRelationship(){return this._clientApiExecutor.execute("getRelationship",(e,t)=>{if(!this._relationship){const n=Object(u.v)(w.getState(),this._pageId,this._contextToken);if(n){const e=n.relationshipName;if(e&&(this._relationship=x(e,this.getEntityName()),n.relationshipRoleOrdinal)){const e=n.relationshipRoleOrdinal===T.a.Referencing?1:2;this._relationship.roleType=e}}else b.a.getInstance().traceManager.getTracer(e).error("Grid dataset was null",t)}return this._relationship})}getParentForm(){const e="ClientApi.XrmGridControl.getParentForm";try{m.a.instance.reportCall(e);const t=this._contextToken&&this._contextToken.parentContextToken?w.dispatch(Object(S.b)(this._pageId,this._contextToken.parentContextToken)):null;return m.a.instance.reportSuccess(e),t}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,n),t}}getRollupType(){return this._clientApiExecutor.execute("getRollupType",()=>Object(u.eb)(w.getState(),this._pageId,this._contextToken))}_getCurrentView(){let e=null;const t=this.getViewSelector().getCurrentView();if(t)return e="savedquery"===t.entityType?"savedquery":"userquery",{entityType:e,id:t.id};const n=Object(i.g)(w.getState(),this._pageId);if(n.viewType&&n.viewId){const t=n.viewId?o.a.externalGuid(n.viewId):void 0;if(e=n.viewType===I.b.savedview?"savedquery":"userquery",e&&t)return{entityType:e,id:t}}return null}}function x(e,t){const n={};n.name=e;const r=Object(_.h)(w.getState(),t);if(r){let t;if(r.OneToManyRelationships&&r.OneToManyRelationships[e]?t=r.OneToManyRelationships[e]:r.ManyToOneRelationships&&r.ManyToOneRelationships[e]&&(t=r.ManyToOneRelationships[e]),t)n.attributeName=t.ReferencingAttribute,n.relationshipType=0,n.navigationPropertyName=t.ReferencingEntityNavigationPropertyName;else if(r.ManyToManyRelationships&&r.ManyToManyRelationships[e]){const t=r.ManyToManyRelationships[e];n.relationshipType=1,1===n.roleType?(n.attributeName=t.Entity1IntersectAttribute,n.navigationPropertyName=t.Entity1NavigationPropertyName):(n.attributeName=t.Entity2IntersectAttribute,n.navigationPropertyName=t.Entity2NavigationPropertyName)}}return n}},HhsT:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var r=n("uNLT"),i=n("Uv1Y"),a=n("cUbT"),s=n("gQ5I"),o=n("+aj2"),c=n("YxC/"),l=n("ZUzm"),u=n("sHzf"),d=n("bvqZ"),p=n("FdXt"),h=n("dHD5"),g=n("i1f0"),m=n("bT7G"),b=n("3tOH"),y=n("Bj/n"),f=n("O7zD");function S(e){return{type:"saveAndClose.saveAndCloseFormDialogAction.async",execute({dispatch:t,getState:n},S,v){const C=n(),O=Object(h.j)(C,e),_=Object(g.zb)(C,e,O),I=Object(g.ac)(C,e,O);if(!(!Object(m.g)(C,I)&&_&&Object.keys(_).length>0))return t(Object(r.e)(e,2)).then(n=>{const r=Object(g.Ib)(C,e),h=r?"Forms.MainFormDialogRoot.SaveAndClose":"Forms.QuickCreateFormRoot.SaveAndClose";if(n){const i=[{name:"isEntityRefNull",value:!1},{name:"entityTypeName",value:n.etn}];S.EventManager.ReportComponentSuccess(h,i);return(r?Promise.resolve(e):t(Object(o.b)(e,n))).then(e=>(t(Object(a.a)(n.etn)),function(e,t,n){const r="quickcreate_",i=Object(c.e)(t,[p.g,p.c]),a={actionLabel:Object(c.c)(i,p.g),eventHandler:()=>{e(Object(l.a)(n)),e(Object(u.removeToastNotification)(r+n.id.guid))}},s=null,o={id:r+n.id.guid,type:1,level:1,message:Object(c.c)(i,p.c),title:null,action:a,onCloseHandler:s};e(Object(d.b)(o))}(t,C,n),t(Object(s.e)(e,"save")).then(()=>n)))}return S.EventManager.ReportComponentSuccess(h,[{name:"isEntityRefNull",value:!0}]),Promise.reject(new i.a("Record is not created"))});for(const n in _){const r=_[n].label,i=_[n].errorMessage,a=t(Object(y.b)(r,i));t(Object(y.c)(O,e,a,b.a.error,Object(f.d)(e,n)))}}}}},ISM0:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n("nuS9"),i=n("u+q+"),a=n("i1f0"),s=n("ah4O"),o=n("rs6x"),c=n("iWfp"),l=n("iZ7K"),u=n("3/02"),d=n("dHD5"),p=n("2YQW"),h=n("4XwW"),g=n("+Ljw");function m(e){var t;const n=null!==(t=e.selectedFormId)&&void 0!==t?t:e.defaultFormId;const i=e.formNavigatorOptions,a={id:e.id,value:n,onChange:async function(t){const r=n;e.setSelectedFormId(t),1===(await e.changeForm(t)).status&&e.setSelectedFormId(r)},options:i,createAccessibilityComponent:c.a,createKeyboardShortcut:c.b,testhooks:{id:"form-selector"},viewSelectorStyle:e.viewSelectorStyle,caretStyle:e.viewSelectorArrowStyle,textStyle:e.viewSelectorTextStyle,readOnly:!0===e.readOnly||void 0,overrideTextContainerStyle:e.overrideTextContainerStyle,expandedBackgroundColor:e.expandedBackgroundColor,hoveredStyle:e.viewSelectorCaretHoveredStyle,useViewSelectorV2:e.enabledFormFCBs.has(u.le)};return r.createElement(s.a,a)}m.displayName="FormNavigator";const b=Object(i.a)((function(){const e=Object(a.cd)();let t=null;const n=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){const e={};return function(t,n,r,i){const a=Object(g.a)(t,n,!0),s=[];for(const t in a){const n=a[t].name,o={id:t,value:t,text:r.has(u.mb)?n:i?`${i}: ${n}`:n};t in e&&e[t].text===o.text||(e[t]=o),s.push(e[t])}return s}}();return function(r,i){const a=Object(d.j)(r,i.id);Object(p.e)(t,a)||(t=a);const s=Object(l.h)(r,i.entityLogicalName),o=e(r,i,t),c=s&&s.DisplayName;return{enabledFormFCBs:o,formNavigatorOptions:n(r,i.id,o,c),selectedFormId:Object(g.b)(r,i.id)}}}),(function(e,t){return{changeForm:n=>e(Object(o.a)(n,t.id,t.pageName)),setSelectedFormId:n=>{e(Object(h.b)(t.id,n))}}}))(m)},JF0K:function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"i",(function(){return i})),n.d(t,"o",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"j",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return h})),n.d(t,"d",(function(){return g})),n.d(t,"k",(function(){return m})),n.d(t,"l",(function(){return b})),n.d(t,"e",(function(){return y})),n.d(t,"q",(function(){return f})),n.d(t,"p",(function(){return S})),n.d(t,"m",(function(){return d})),n.d(t,"n",(function(){return p}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="BusinessProcessFlow.MoveToNextStage",i="BusinessProcessFlow.MoveToPreviousStage",a="BusinessProcessFlow.SetActiveStage",s="BusinessProcessFlow.AbandonProcess",o="BusinessProcessFlow.ReactivateProcess",c="BusinessProcessFlow.CompleteProcess",l="BusinessProcessFlow.InitilaizeWithFormEntityOnly",u="BusinessProcessFlow.InitilaizeWithProcessAndFormEntity",d="BusinessProcessFlow.SetActiveProcess",p="BusinessProcessFlow.SetActiveProcessInstance",h="BusinessProcessFlow.ActionStep",g="BusinessProcessFlow.FlowStepWidget",m="BusinessProcessFlow.RefreshFlowStep",b="BusinessProcessFlow.RenderProcessControl",y="BusinessProcessFlow.HideProcessControlForUciOffline",f="SaveFailureReason",S="faultedSnapshotId"},Jpj4:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b}));var r=n("SAYH"),i=n("dHD5"),a=n("BFlg"),s=n("P6DH"),o=n("LbMF"),c=n("3hnk"),l=n("NUHF"),u=n("odYE"),d=n("3/02"),p=n("Lyxw"),h=n("bT7G"),g=n("qLnS");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const m="dataset.row.properties";function b(e,t,n){return{type:"row.properties.async",execute({dispatch:l,getState:h},b){const f=b.TraceManager.getTracer(a.z),S=a.x+".RowPropertiesAction",v=Object(p.c)(h(),d.L);try{const a=Object(i.v)(t),d=Object(s.P)(h(),t,{id:e});if(d){let p=null;const _=Object(s.Q)(h(),e,t);if(_)p=_;else{const n=Object(s.S)(h(),{id:e},t);n&&n.entityLogicalName&&(p=n.entityLogicalName)}if(p){const i=Object(o.d)(h(),p),a=Object(s.y)(h(),t,e);if(i){const e=[];for(const t of Object.keys(i)){const n=i[t],r=Object(c.f)(h(),p,n.LogicalName,g.a.CanUpdate);let s=!0;v&&a&&0===a[n.LogicalName]&&(s=!1),e.push({[n.LogicalName]:{requiredLevel:n.RequiredLevel,isDisabled:!(n.IsValidForUpdate&&r&&s),notifications:{}}})}for(const t of n)if(0===d.records.filter(e=>Object.keys(e)[0]===r.a.toString(t)).length)d.records.push({[r.a.toString(t)]:e});else{const n=d.records.find(e=>Object.keys(e)[0]===r.a.toString(t))[r.a.toString(t)],i=JSON.parse(JSON.stringify(e));n&&n.forEach(e=>{const t=e[Object.keys(e)[0]];t&&Object.keys(t.notifications).length>0&&(i.find(t=>Object.keys(t)[0]===Object.keys(e)[0])[Object.keys(e)[0]].notifications=t.notifications)}),d.records.find(e=>Object.keys(e)[0]===r.a.toString(t))[r.a.toString(t)]=i}}}if(l(function(e,t,n){return{type:m,payload:n,meta:{pageId:e,dataSetContextKey:t}}}(e,a,d)),v&&p){const r=Object(o.d)(h(),p),a=Object(s.y)(h(),t,e);for(const s of n){const n=(h(),C=s,O=p,new u.a(O,C)),o=Object(i.f)(t,s,p);if(r)for(const t of Object.keys(r)){const i=r[t];a&&1===a[i.LogicalName]&&null===i.ParentPicklistLogicalName&&y(h(),l,e,n,i.LogicalName,o)}}}f.info("creating the rowproperties for {0} rows"+n.length),b.EventManager.ReportComponentSuccess(S)}return Promise.resolve()}catch(e){const t="creating the rowproperties for {0} rows"+n.length+"failed";b.EventManager.ReportComponentFailure(S,Error(t))}var C,O}}}function y(e,t,n,r,i,a){const o={},c=Object(s.R)(e,n,a),u=Object(h.d)(e,c,r,i);o[i]=u,Object.keys(o).length>0&&t(Object(l.b)(n,a,!1,o))}},KGWS:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t){this._traversedPath=e,this._stageId=t}get traversedPath(){return this._traversedPath}set traversedPath(e){this._traversedPath=e}get stageId(){return this._stageId}set stageId(e){this._stageId=e}}var i=n("sxfa"),a=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class s{get globalPathAndActiveStage(){return this._globalPathAndActiveStage}get navigationEntities(){return this._navigationEntities}get navigationEntityIdsByEntityLogicalName(){return this._navigationEntityIdsByEntityLogicalName}set globalPathAndActiveStage(e){(e||this._globalPathAndActiveStage||this._globalPathAndActiveStage.stageId===e.stageId)&&(this._globalPathAndActiveStage=e)}InitGlobalPathAndActiveStage(e){this._updateNavigationDictionary(e.navigationEntities),this.UpdateGlobalPathAndActiveStage(e.traversedPath,e.activeStageId)}UpdateGlobalPathAndActiveStage(e,t){this.globalPathAndActiveStage=new r(new i.a(e),t)}_updateNavigationDictionary(e){if(e){this._navigationEntities=e,this._navigationEntityIdsByEntityLogicalName={};for(let t=0;t<e.length;t++)this._navigationEntityIdsByEntityLogicalName[e[t].entityLogicalName]=new a.a(e[t].id)}}}},KnyI:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="attribute.removeOption";function a(e,t,n,a){const s=Object(r.x)(t);return{type:i,payload:a,meta:{pageId:e,contextKey:s,dataFieldName:n}}}},L4Zk:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("c/eZ"),i=n("rFRM"),a=n("7JDo"),s=n("k6Yd"),o=n("1UTq"),c=Object(o.c)((function(e,t){var n,o,c,l,u,d,p,h,g,m,b=e.effects,y=e.palette,f=e.semanticColors,S={position:"absolute",width:1,right:31,top:8,bottom:8},v={splitButtonContainer:[Object(i.c)(e,{highContrastStyle:{left:-2,top:-2,bottom:-2,right:-2,border:"none"},inset:2}),{display:"inline-flex",selectors:{".ms-Button--default":{borderTopRightRadius:"0",borderBottomRightRadius:"0",borderRight:"none"},".ms-Button--primary":{borderTopRightRadius:"0",borderBottomRightRadius:"0",border:"none",selectors:(n={},n[a.b]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},n)},".ms-Button--primary + .ms-Button":{border:"none"}}}],splitButtonContainerHovered:{selectors:{".ms-Button--primary":{selectors:(o={},o[a.b]={color:"Window",backgroundColor:"Highlight"},o)},".ms-Button.is-disabled":{color:f.buttonTextDisabled,selectors:(c={},c[a.b]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},c)}}},splitButtonContainerChecked:{selectors:{".ms-Button--primary":{selectors:(l={},l[a.b]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},l)}}},splitButtonContainerCheckedHovered:{selectors:{".ms-Button--primary":{selectors:(u={},u[a.b]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},u)}}},splitButtonContainerFocused:{outline:"none!important"},splitButtonMenuButton:{padding:6,height:"auto",boxSizing:"border-box",borderRadius:0,borderTopRightRadius:b.roundedCorner2,borderBottomRightRadius:b.roundedCorner2,border:"1px solid "+y.neutralSecondaryAlt,borderLeft:"none",outline:"transparent",userSelect:"none",display:"inline-block",textDecoration:"none",textAlign:"center",cursor:"pointer",verticalAlign:"top",width:32,marginLeft:-1,marginTop:0,marginRight:0,marginBottom:0},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},S),{selectors:(d={},d[a.b]={backgroundColor:"WindowText"},d)}),splitButtonDividerDisabled:Object(r.__assign)(Object(r.__assign)({},S),{selectors:(p={},p[a.b]={backgroundColor:"GrayText"},p)}),splitButtonMenuButtonDisabled:{pointerEvents:"none",border:"none",selectors:(h={":hover":{cursor:"default"},".ms-Button--primary":{selectors:(g={},g[a.b]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},g)}},h[a.b]={border:"1px solid GrayText",color:"GrayText",backgroundColor:"Window"},h)},splitButtonFlexContainer:{display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"center",alignItems:"center"},splitButtonContainerDisabled:{outline:"none",border:"none",selectors:(m={},m[a.b]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},m)}};return Object(s.a)(v,t)}))},L8zx:function(e,t,n){"use strict";n.d(t,"a",(function(){return Q})),n.d(t,"b",(function(){return Z}));var r=n("SAYH"),i=n("i1f0"),a=n("UqyN"),s=n("ABCl"),o=n("0nOn"),c=n("odYE"),l=n("hvSt"),u=n("5Oca"),d=n("CPoS"),p=n("qshH"),h=n("16wZ"),g=n("ZIjf");class m{constructor(e,t,n){const r="ClientApi.XrmProcessStep.constructor";t||Object(h.j)(r,"step"),n||Object(h.j)(r,"processManager"),e||Object(h.j)(r,"store"),this._step=t,this._processManager=n}isRequired(){const e="ClientApi.XrmProcessStep.isRequired";try{g.a.instance.reportCall(e);const t=this._step.get_isProcessRequired();return g.a.instance.reportSuccess(e),t}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}getAttribute(){const e="ClientApi.XrmProcessStep.getAttribute";try{if(g.a.instance.reportCall(e),!this._attribute){const e=this._step.get_Steps().get_item(0);this._attribute=!e||e.get_isSystemControl()?null:e.get_dataFieldName()}return g.a.instance.reportSuccess(e),this._attribute}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}getName(){const e="ClientApi.XrmProcessStep.getName";try{g.a.instance.reportCall(e);const t=this._step.get_Name();return g.a.instance.reportSuccess(e),t}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}getProgress(){const e="ClientApi.XrmProcessStep.getProgress";try{g.a.instance.reportCall(e);let t=4;if(this._step.get_Steps()&&this._step.get_Steps().get_item(0)){if(this._step.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep&&this._processManager){const e=this._processManager.getActionLog(new r.a(this._step.get_Id()));e&&(t=e.status),t=0}}return g.a.instance.reportSuccess(e),t}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}setProgress(e,t){const n="ClientApi.XrmProcessStep.setProgress";try{g.a.instance.reportCall(n);let r="invalid";switch(e){case 0:case 1:case 2:case 3:case 4:r=this._setProgressInternal(e,t)}return g.a.instance.reportSuccess(n),r}catch(e){throw p.a.getInstance().reportFailure(n,e),e}}_setProgressInternal(e,t){if(this._step.get_Steps()&&this._step.get_Steps().get_item(0)){if(this._step.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep){const n=this._processManager.UpdateActionLog(new r.a(this._step.get_Id()),e,t);if(n)return n}}return"invalid"}}var b=n("Sbn7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class y{constructor(e,t){this._processManager=t,null!=this._processManager&&this._processManager.shouldReInitializeNavigationBehavior()&&this._processManager.setBpfNavigationBehavior(this)}get allowCreateNew(){return g.a.instance.reportUsage("ClientApi.XrmProcessNavigationBehavior.getAllowCreateNew"),this._allowCreateNew}set allowCreateNew(e){const t="ClientApi.XrmProcessNavigationBehavior.setAllowCreateNew";try{g.a.instance.reportCall(t),this._allowCreateNew=e,null!=this._processManager&&this._processManager.setBpfNavigationBehavior(this),g.a.instance.reportSuccess(t)}catch(e){throw p.a.getInstance().reportFailure(t,e),e}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let f;class S{constructor(e,t,n,r,i){f=e,this._entityTypeName=n,this._activeStageId=r,this._stageStep=t,new y(e,i),i&&(this._processManager=i)}getCategory(){const e="ClientApi.XrmProcessStage.getCategory";try{g.a.instance.reportCall(e);const t=this._stageStep.get_stageCategory(),n={getValue(){let e=parseInt(t,10);return Number.isNaN(e)&&(e=-1),e}};return g.a.instance.reportSuccess(e),n}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}getId(){const e="ClientApi.XrmProcessStage.getId";try{g.a.instance.reportCall(e);const t=this._stageStep.get_Id();return g.a.instance.reportSuccess(e),t}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}getEntityName(){return g.a.instance.reportUsage("ClientApi.XrmProcessStage.getEntityName"),this._entityTypeName}getStatus(){const e="ClientApi.XrmProcessStage.getStatus";try{g.a.instance.reportCall(e);const t=this.getId()===this._activeStageId?"active":"inactive";return g.a.instance.reportSuccess(e),t}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}getName(){const e="ClientApi.XrmProcessStage.getName";try{g.a.instance.reportCall(e);const t=this._stageStep.get_Description();return g.a.instance.reportSuccess(e),t}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}getSteps(){const e="ClientApi.XrmProcessStage.getSteps";try{if(g.a.instance.reportCall(e),!this._steps&&(this._steps=new b.a(e),null!=this._stageStep.get_Steps()&&this._stageStep.get_Steps().get_Count()>0))for(let e=0;e<this._stageStep.get_Steps().get_Count();e++){const t=this._stageStep.get_Steps().get_item(e);if(t instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){const e=t.get_Steps().get_item(0);e&&(e instanceof Microsoft.Crm.Workflow.ObjectModel.ControlStep||e instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep||e instanceof Microsoft.Crm.Workflow.ObjectModel.FlowStep)&&this._steps.add(t.get_Id(),new m(f,t,this._processManager))}}return g.a.instance.reportSuccess(e),this._steps}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}getNavigationBehavior(){const e="ClientApi.XrmProcessStage.getNavigationBehavior";try{g.a.instance.reportCall(e);const t=this._processManager.getBpfNavigationBehavior();return g.a.instance.reportSuccess(e),t}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let v;class C{constructor(e,t,n,r,i){const a="ClientApi.XrmBusinessProcessFlow.constructor";t||Object(h.j)(a,"workflowStep"),r||Object(h.j)(a,"activeStageId"),i||Object(h.j)(a,"processManager"),e||Object(h.j)(a,"store"),Object(h.a)(n)&&Object(h.j)(a,"isRendered"),v=e,this._isRendered=n,this._workflowStep=t,this._activeStageId=r,this._processManager=i}getName(){const e="ClientApi.XrmBusinessProcessFlow.getName";try{g.a.instance.reportCall(e);const t=this._workflowStep.get_Name();return g.a.instance.reportSuccess(e),t}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}getId(){const e="ClientApi.XrmBusinessProcessFlow.getId";try{g.a.instance.reportCall(e);const t=this._workflowStep.get_Id();return g.a.instance.reportSuccess(e),t}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}isRendered(){return g.a.instance.reportUsage("ClientApi.XrmBusinessProcessFlow.isRendered"),this._isRendered}getStages(){const e="ClientApi.XrmBusinessProcessFlow.getStages";try{if(g.a.instance.reportCall(e),!this._stages){this._stages=new b.a(e);for(let e=0;e<this._workflowStep.get_Steps().get_Count();e++){const t=this._workflowStep.get_Steps().get_item(e);if(t instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep){const e=t;for(let t=0;t<e.get_Steps().get_Count();t++){const n=e.get_Steps().get_item(t);this._stages.add(n.get_Id(),new S(v,n,e.get_EntityLogicalName(),this._activeStageId,this._processManager))}}}}return g.a.instance.reportSuccess(e),this._stages}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}}var O,_=n("1kth"),I=n("cZbt"),j=n("blB4"),P=n("UuJw");!function(e){e.success="success",e.invalid="invalid"}(O||(O={}));var F=n("r/aD"),T=n("iF9X"),w=n("37s6"),E=n("69Qu"),x=n("IaGr"),N=n("arV0"),A=n("2Ct/"),k=n("ycdb"),M=n("ruPX"),D=n("cfbi");let R;class B{constructor(e,t,n,i,a){this._clientApiExecutor=new o.a(e,"ClientApi.XrmProcessControlData.",n,t);const s=this._clientApiExecutor.getComponentName("constructor");n||Object(h.j)(s,"pageId"),i||Object(h.j)(s,"entity"),t||Object(h.j)(s,"contextToken"),e||Object(h.j)(s,"store"),R=e,this._pageId=n,this._entity=i;let l=!1;Object(F.d)(R.getState(),this._pageId,s,!0)&&(this._processManager=a,l=!0),this._contextToken=t;const u=i.getEntityReference();this._entityRef=new c.a(u.entityType,r.a.tryParseOrNull(u.id),u.name);const d=Object(F.b)(n,e.getState(),l);x.a.getInstance().eventManager.ReportComponentSuccess(s,d)}getActiveProcess(){const e="ClientApi.XrmProcessControlData.getActiveProcess";try{if(g.a.instance.reportCall(e),!Object(F.d)(R.getState(),this._pageId,e))return g.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getProcess();let n=null;if(t){const e=this._getProcessManager().getActiveStageId();n=new C(R,t,!0,e,this._getProcessManager())}return g.a.instance.reportSuccess(e),n}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}setStatus(e,t){const n="ClientApi.XrmProcessControlData.setStatus";try{if(g.a.instance.reportCall(n),!Object(F.d)(R.getState(),this._pageId,n))return void g.a.instance.reportSuccess(n);if(!e||this.getStatus()&&e===this.getStatus())return void g.a.instance.reportSuccess(n);let r;if(e===I.a.active)r=l.a.Active;else if(e===I.a.finished)r=l.a.Finished;else{if(e!==I.a.aborted)return void g.a.instance.reportSuccess(n);r=l.a.Aborted}this._getProcessManager().setStatus(r).then(()=>{this._callback(t,e,n),g.a.instance.reportSuccess(n)}).catch(t=>{const r=p.a.getInstance().getEventParameters(this._contextToken);return r.push({name:"newStatus",value:e}),Object(h.d)(R,t,n,r)})}catch(e){const t=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(n,e,null,t),e}}getStatus(){const e="ClientApi.XrmProcessControlData.getStatus";try{if(g.a.instance.reportCall(e),!Object(F.d)(R.getState(),this._pageId,e))return g.a.instance.reportSuccess(e),null;const t=this._convertToXrmProcessInstanceStatus(this._getProcessManager().getStatus());return g.a.instance.reportSuccess(e),t}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}getInstanceName(){const e="ClientApi.XrmProcessControlData.getInstanceName";try{if(g.a.instance.reportCall(e),!Object(F.d)(R.getState(),this._pageId,e))return g.a.instance.reportSuccess(e),null;let t=this._getProcessManager().getProcessInstanceName();if(!t){const e=Object(u.e)(R.getState(),this._entityRef);t=Object(d.c)(R.getState(),e)}return g.a.instance.reportSuccess(e),t}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}getInstanceId(){const e="ClientApi.XrmProcessControlData.getInstanceId";try{if(g.a.instance.reportCall(e),!Object(F.d)(R.getState(),this._pageId,e))return g.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getProcessInstanceId(),n=t?r.a.toString(t):null;return g.a.instance.reportSuccess(e),n}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}getProcessInstances(e){const t="ClientApi.XrmProcessControlData.getProcessInstances";try{if(g.a.instance.reportCall(t),!Object(F.d)(R.getState(),this._pageId,t)||Object(A.g)(R.getState()))return;"function"==typeof e&&this._getProcessManager().getProcessInstances().then(n=>{if(n&&n.value&&n.value.length>0){const r={};n.value.forEach(e=>{e.businessprocessflowinstanceid&&(r[e.businessprocessflowinstanceid]={CreatedOnDate:e.createdon?new Date(e.createdon):null,ProcessDefinitionID:e._processid_value,ProcessDefinitionName:e.name,ProcessInstanceID:e.businessprocessflowinstanceid,ProcessInstanceName:e.name,StatusCodeName:this._convertToXrmProcessInstanceStatus(e.Process_x002e_statuscode),CreatedOn:e.createdon?new Date(e.createdon).toLocaleDateString():"",ProcessDefintionID:e._processid_value,ProcessDefintionName:e.name})}),Object(s.c)(t,[],()=>{e(r)})}g.a.instance.reportSuccess(t)}).catch(e=>{const n=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(R,e,t+".getProcessInstances",n)})}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}setActiveProcess(e,t){this._clientApiExecutor.executeAsync("setActiveProcess",(n,i)=>{const a=r.a.tryParseOrNull(e),s=Object(N.m)(R.getState(),this._pageId);if(a&&r.a.equals(a,r.a.EMPTY)){if(s){const e=new c.a(this._entity.getEntityName(),r.a.EMPTY);return R.dispatch(Object(k.b)(!0,e)),x.a.getInstance().eventManager.ReportComponentSuccess(n,i),Promise.resolve().then(()=>(this._callback(t,O.success,n,i),Promise.resolve())).catch(e=>(this._callback(t,O.invalid,n,i),Promise.reject(e)))}return Promise.resolve().then(()=>(this._callback(t,O.invalid,n,i),Promise.resolve()))}if(!Object(F.d)(R.getState(),this._pageId,n,!0)||Object(A.g)(R.getState()))return Promise.resolve();let o=null;return o=s?Promise.resolve():this._getProcessManager().setActiveProcess(e),o.then(()=>{this._callback(t,O.success,n,i);const r=this.getActiveProcess();return r&&r.getId().toUpperCase()===e.toUpperCase()||this._reloadPage(n,this._getProcessManager().getCurrentFormEntity(),e),Promise.resolve()}).catch(e=>(this._callback(t,O.invalid,n,i),Promise.reject(e)))},[{name:"processId",value:e,isRequired:!0,expectedDataType:"guid"}])}setActiveProcessInstance(e,t){this._clientApiExecutor.executeAsync("setActiveProcessInstance",(n,r)=>!Object(F.d)(R.getState(),this._pageId,n)||Object(A.g)(R.getState())?Promise.resolve():this._getProcessManager().setActiveProcessInstance(e).then(i=>{this._callback(t,O.success,n,r);return this.getInstanceId()!==e&&this._reloadPage(n,this._getProcessManager().getCurrentFormEntity(),i,e),Promise.resolve()}).catch(e=>(this._callback(t,O.invalid,n,r),Promise.reject(e))),[{name:"processInstanceId",value:e,isRequired:!0,expectedDataType:"guid"}])}getEnabledProcesses(e){const t="ClientApi.XrmProcessControlData.getEnabledProcesses";try{if(g.a.instance.reportCall(t),!Object(F.d)(R.getState(),this._pageId,t,!0))return void g.a.instance.reportSuccess(t);const n=R.getState();if(Object(T.g)(n)&&Object(w.w)(n)&&!Object(E.b)(n)){const n={};return void("function"==typeof e&&Object(s.c)(t,[],()=>{e(n)}))}this._getProcessManager().getEnabledProcesses().then(n=>{const r={};n&&n.length>0&&n.forEach(e=>{r[e.workflowId]=e.name}),"function"==typeof e&&Object(s.c)(t,[],()=>{e(r)}),g.a.instance.reportSuccess(t)}).catch(e=>{const n=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(R,e,t+".getEnabledProcesses",n)})}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}switchProcess(){const e="ClientApi.XrmProcessControlData.switchProcess";try{if(g.a.instance.reportCall(e),!Object(F.d)(R.getState(),this._pageId,e)||Object(A.g)(R.getState()))return;this._getProcessManager().switchProcess(),g.a.instance.reportSuccess(e)}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}abandonProcess(){const e="ClientApi.XrmProcessControlData.abandonProcess";try{if(g.a.instance.reportCall(e),!Object(F.d)(R.getState(),this._pageId,e)||Object(N.m)(R.getState(),this._pageId))return void g.a.instance.reportSuccess(e);this._getProcessManager().abandonProcess().then(()=>{g.a.instance.reportSuccess(e)}).catch(t=>{const n=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(R,t,e+".abandonProcess",n)})}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}reactivateProcess(){const e="ClientApi.XrmProcessControlData.reactivateProcess";try{if(g.a.instance.reportCall(e),!Object(F.d)(R.getState(),this._pageId,e)||Object(N.m)(R.getState(),this._pageId))return void g.a.instance.reportSuccess(e);this._getProcessManager().reactivateProcess().then(()=>{g.a.instance.reportSuccess(e)}).catch(t=>{const n=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(R,t,e+".reactivateProcess",n)})}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}completeProcess(){const e="ClientApi.XrmProcessControlData.completeProcess";try{if(g.a.instance.reportCall(e),!Object(F.d)(R.getState(),this._pageId,e)||Object(N.m)(R.getState(),this._pageId))return void g.a.instance.reportSuccess(e);this._getProcessManager().completeProcess().then(()=>{g.a.instance.reportSuccess(e)}).catch(t=>{const n=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(R,t,e+".completeProcess",n)})}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}getActiveStage(){const e="ClientApi.XrmProcessControlData.getActiveStage";try{if(g.a.instance.reportCall(e),!Object(F.d)(R.getState(),this._pageId,e))return g.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getActiveStage();let n=null;return t&&(n=new S(R,t,this._getProcessManager().getCurrentFormEntity().etn,t.get_Id(),this._getProcessManager())),g.a.instance.reportSuccess(e),n}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}getActivePath(){const e="ClientApi.XrmProcessControlData.getActivePath";try{if(g.a.instance.reportCall(e),!Object(F.d)(R.getState(),this._pageId,e))return g.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getActivePathStages();let n=null;if(t){const r=this._getProcessManager().getActiveStageId(),i=new b.a(e);t.forEach(e=>{const t=e.get_parent().get_EntityLogicalName();i.add(e.get_stageId(),new S(R,e,t,r,this._getProcessManager()))}),n=i}return g.a.instance.reportSuccess(e),n}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}setActiveStage(e,t){const n="ClientApi.XrmProcessControlData.setActiveStage";try{if(g.a.instance.reportCall(n),this._entity.getIsDirty()||Object(N.m)(R.getState(),this._pageId))g.a.instance.reportSuccess(n),this._callback(t,j.a.dirtyForm,n);else{if(!Object(F.d)(R.getState(),this._pageId,n))return void g.a.instance.reportSuccess(n);this._getProcessManager().setActiveStage(e).then(()=>{this._callback(t,this._getStageInvalidReason(null),n),this._loadActiveStageEntity(n),g.a.instance.reportSuccess(n)}).catch(e=>{this._callback(t,e?this._getStageInvalidReason(e):P.a.invalid,n)})}}catch(e){const t=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(n,e,null,t),e}}moveNext(e){const t="ClientApi.XrmProcessControlData.moveNext";try{const n=!0;if(g.a.instance.reportCall(t),this._entity.getIsDirty()||Object(N.m)(R.getState(),this._pageId))g.a.instance.reportSuccess(t),this._callback(e,j.a.dirtyForm,t);else{if(!Object(F.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);if(this._getProcessManager().isCrossEntityNavigation(n))return this._callback(e,j.a.crossEntity,t),void g.a.instance.reportSuccess(t);this._getProcessManager().moveToNextStage().then(()=>{this._callback(e,this._getNavigationStatus(null),t),g.a.instance.reportSuccess(t)}).catch(n=>{const r=n?this._getNavigationStatus(n):j.a.invalid;if(this._callback(e,r,t),r===j.a.invalid){const e=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(R,n,t+".moveToNextStage",e)}g.a.instance.reportSuccess(t)})}}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}movePrevious(e){const t="ClientApi.XrmProcessControlData.movePrevious";try{const n=!0;if(g.a.instance.reportCall(t),this._entity.getIsDirty()||Object(N.m)(R.getState(),this._pageId))g.a.instance.reportSuccess(t),this._callback(e,j.a.dirtyForm,t);else{if(!Object(F.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);if(Object(A.g)(R.getState())&&this._getProcessManager().isCrossEntityNavigation(!n))return this._callback(e,j.a.crossEntity,t),void g.a.instance.reportSuccess(t);this._getProcessManager().moveToPreviousStage().then(()=>{this._callback(e,this._getNavigationStatus(null),t),this._loadActiveStageEntity(t),g.a.instance.reportSuccess(t)}).catch(n=>{const r=n?this._getNavigationStatus(n):j.a.invalid;if(this._callback(e,r,t),r===j.a.invalid){const e=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(R,n,t+".moveToPreviousStage",e)}g.a.instance.reportSuccess(t)})}}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}getSelectedStage(){const e="ClientApi.XrmProcessControlData.getSelectedStage";try{if(g.a.instance.reportCall(e),!Object(F.d)(R.getState(),this._pageId,e))return g.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getSelectedStage();let n=null;if(t){const e=this._getProcessManager().getActiveStageId();n=new S(R,t,this._getProcessManager().getCurrentFormEntity().etn,e,this._getProcessManager())}return g.a.instance.reportSuccess(e),n}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}addOnStageChange(e){const t="ClientApi.XrmProcessControlData.addOnStageChange";e||Object(h.j)(t,"handler");try{if(g.a.instance.reportCall(t),!Object(F.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(_.q)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}addOnPreStageChange(e){const t="ClientApi.XrmProcessControlData.addOnPreStageChange";Object(h.g)(e,t,"handler");try{if(g.a.instance.reportCall(t),!Object(F.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(_.j)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}removeOnStageChange(e){const t="ClientApi.XrmProcessControlData.removeOnStageChange";e||Object(h.j)(t,"handler");try{if(g.a.instance.reportCall(t),!Object(F.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(_.L)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}removeOnPreStageChange(e){const t="ClientApi.XrmProcessControlData.removeOnPreStageChange";Object(h.g)(e,t,"handler");try{if(g.a.instance.reportCall(t),!Object(F.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(_.E)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}addOnStageSelected(e){const t="ClientApi.XrmProcessControlData.addOnStageSelected";e||Object(h.j)(t,"handler");try{if(g.a.instance.reportCall(t),!Object(F.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(_.r)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}removeOnStageSelected(e){const t="ClientApi.XrmProcessControlData.removeOnStageSelected";e||Object(h.j)(t,"handler");try{if(g.a.instance.reportCall(t),!Object(F.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(_.M)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}addOnProcessStatusChange(e){const t="ClientApi.XrmProcessControlData.addOnProcessStatusChange";e||Object(h.j)(t,"handler");try{if(g.a.instance.reportCall(t),!Object(F.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(_.k)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}addOnPreProcessStatusChange(e){const t="ClientApi.XrmProcessControlData.addOnPreProcessStatusChange";Object(h.g)(e,t,"handler");try{if(g.a.instance.reportCall(t),!Object(F.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(_.i)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}removeOnProcessStatusChange(e){const t="ClientApi.XrmProcessControlData.removeOnProcessStatusChange";e||Object(h.j)(t,"handler");try{if(g.a.instance.reportCall(t),!Object(F.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(_.F)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}removeOnPreProcessStatusChange(e){const t="ClientApi.XrmProcessControlData.removeOnPreProcessStatusChange";Object(h.g)(e,t,"handler");try{if(g.a.instance.reportCall(t),!Object(F.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(_.D)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}_getStageInvalidReason(e){return e?e.stageInvalidReason||P.a.invalid:j.a.success}_getNavigationStatus(e){return e?e.navigationStatus||j.a.invalid:j.a.success}_convertToXrmProcessInstanceStatus(e){if(e){if(e===l.a.Active)return I.a.active;if(e===l.a.Finished)return I.a.finished;if(e===l.a.Aborted)return I.a.aborted}return null}_callback(e,t,n,r){const i=n+".Callback";r||(r=p.a.getInstance().getEventParameters(this._contextToken)),r.push({name:"Status",value:t}),Object(s.c)(i,r,()=>{"function"==typeof e&&e(t)})}_reloadPage(e,t,n,r){if(t){const i=Object(N.m)(R.getState(),this._pageId),a={entityTypeName:t.etn,id:i?void 0:t.id,processId:n,processInstanceId:r},s={target:"inline"};R.dispatch(Object(M.a)(D.a,a,this._pageId,s)).then(t=>{if(0!==t.status)return Object(h.d)(R,t.error,e+".navigateTo.INavigationFailure")}).catch(t=>Object(h.d)(R,t,e+".navigateTo."))}}_loadActiveStageEntity(e){const t=this._getProcessManager().getActiveStageEntityRef();t&&t.etn!==this._getProcessManager().getCurrentFormEntity().etn&&this._reloadPage(e,t,this.getActiveProcess().getId(),this.getInstanceId())}_getProcessManager(){return this._processManager||(this._processManager=Object(F.c)(this._processManager,R,this._pageId,"ClientApi.XrmProcessControlData.getProcessManager")),this._processManager}}var L=n("uNLT"),V=n("/q/W"),z=n("jRy5"),H=n("Uv1Y"),G=n("Fij2"),W=n("mIxf"),U=n("HhsT"),q=n("PUjk"),X=n("AE7n"),Y=n("P6DH");let K;class Q{constructor(e,t,n,r,i){this._entity=null;const a="ClientApi.XrmFormData.constructor";e||Object(h.j)(a,"store"),n||Object(h.j)(a,"pageId"),t||Object(h.j)(a,"contextToken"),r||Object(h.j)(a,"formContext"),K=e,this._pageId=n,this._formContext=r,this._contextToken=t,this._entity=i}get entity(){return g.a.instance.reportUsage("ClientApi.XrmFormData.entity"),this._entity}get process(){const e="ClientApi.XrmFormData.process_get";try{const t=Object(A.f)(K.getState());g.a.instance.reportCall(e);const n=!!this._process;if((!t&&!this._process||t)&&this._entity){const e=Object(N.g)(K.getState(),this._pageId),t=Object(q.b)(this._pageId,e);this._entity&&(this._process=new B(K,this._contextToken,this._pageId,this.entity,t))}g.a.instance.reportSuccess(e);const r=Object(F.a)(this._pageId,K.getState(),n,!!this._entity);return x.a.getInstance().eventManager.ReportComponentSuccess(e,r),this._process}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}set process(e){const t=Object(F.a)(this._pageId,K.getState(),!!this._process,!!this._entity);x.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmFormData.process_set",t),this._process=e}getEntity(){return g.a.instance.reportUsage("ClientApi.XrmFormData.getEntity"),this._entity}getIsDirty(){var e,t,n;const r="ClientApi.XrmFormData.getIsDirty";try{g.a.instance.reportCall(r);let i=!1;if(this._entity&&this._entity.getIsDirty())i=!0;else{for(let e=0;e<this.attributes.getLength();e++){const t=this.attributes.get(e);if("never"!==t.getSubmitMode()&&t.getIsDirty()){i=!0;break}}if(!i&&(null===(t=null===(e=this._formContext)||void 0===e?void 0:e.ui)||void 0===t?void 0:t.controls))for(let e=0;e<this._formContext.ui.controls.getLength();e++){const t=this._formContext.ui.controls.get(e);if("formcomponent"===t.getControlType()&&t.isLoaded()&&(null===(n=t.data)||void 0===n?void 0:n.getIsDirty())){i=!0;break}}}return g.a.instance.reportSuccess(r),i}catch(e){const t=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(r,e,null,t),e}}get attributes(){const e="ClientApi.XrmFormData.attributes";try{if(g.a.instance.reportCall(e),!this._unboundAttributes){this._unboundAttributes=new b.a(e);const t=Object(i.Oc)(K.getState(),this._pageId);if(t)for(const e in t){const n=t[e],r=e,i=Object(a.b)(K,this._contextToken,this._pageId,r,this.entity,this._formContext.ui,n);this._unboundAttributes.add(i.getName(),i)}}return g.a.instance.reportSuccess(e),this._unboundAttributes}catch(t){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,n),t}}_refreshEntity(e){return this.entity.refresh().then(()=>{Object(L.d)(K.dispatch,this._contextToken,this._pageId),e&&K.dispatch(Object(_.Q)(this._contextToken,this._pageId,3,this.entity)),Object(G.b)(this.entity)})}refresh(e){const t="ClientApi.XrmFormData.refresh";try{if(g.a.instance.reportCall(t),this.entity){const n=Object(i.kb)(K.getState(),{id:this._pageId},this._contextToken);return!n&&e&&this.entity.getIsDirty()?this.save().then(e=>(g.a.instance.reportSuccess(t),{})).catch(e=>{const n=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(K,e,t+".save",n)}):!n&&this.entity.getIsDirty()?K.dispatch(Object(V.a)(this._pageId)).then(e=>{if(e)return this._refreshEntity(!0).then(()=>(g.a.instance.reportSuccess(t),{})).catch(e=>{const n=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(K,e,t+".handleUnsavedChanges.refreshEntity",n)})}).catch(e=>{const n=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(K,e,t+".handleUnsavedChanges",n)}):this._refreshEntity(!0).then(()=>(g.a.instance.reportSuccess(t),{})).catch(e=>{const n=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(K,e,t+".handleUnsavedChanges.refreshEntity",n)})}const n=new H.a("Refresh action cannot be executed since form entity is null",2147746581);return x.a.getInstance().traceManager.getTracer(t).info("Refreshing on a non entity page"),Object(h.d)(K,n,t+".entity")}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(K,e,t,n)}}save(e){const t="ClientApi.XrmFormData.save",n=p.a.getInstance().getEventParameters(this._contextToken);if(!this._entity){const e=new H.a("Save action cannot be executed since form entity is null",2147746581);return Object(h.d)(K,e,t+".entity")}try{g.a.instance.reportCall(t);let a=1;e&&e.saveMode&&(a=e.saveMode);return Z(this._pageId,K,a,n,this._contextToken,this.entity,!0,!0).then(e=>{if(e){const a={entityType:e.etn,id:r.a.toString(e.id),name:e.name};return Object(i.Kb)(K.getState(),this._pageId)?(g.a.instance.reportSuccess(t),{savedEntityReference:a}):this._refreshEntity(!1).then(()=>(g.a.instance.reportSuccess(t),{savedEntityReference:a})).catch(e=>Object(h.d)(K,e,t+".refresh",n))}if(Object(i.kb)(K.getState(),{id:this._pageId},this._contextToken)||!this.entity.getIsDirty()){const e=this.entity.getEntityReference();return g.a.instance.reportSuccess(t),{savedEntityReference:e}}const a=new H.a("Save action was not executed and the form is dirty.",2147879192);return Object(h.d)(K,a,t+".NoReference",null,!1)}).catch(e=>{if(e&&(2200000006===e.errorCode||2200000004===e.errorCode)){const e=this.entity.getEntityReference();return g.a.instance.reportSuccess(t),Promise.resolve({savedEntityReference:e})}return Object(h.d)(K,e,t,n)})}catch(e){return Object(h.d)(K,e,t,n)}}isValid(){var e,t,n;const r="ClientApi.XrmFormData.isValid";try{g.a.instance.reportCall(r);let i=!0;if(this.entity&&!this.entity.isValid())i=!1;else if(this.attributes)for(let e=0;e<this.attributes.getLength();e++)if(!this.attributes.get(e).isValid()){i=!1;break}if(i&&(null===(t=null===(e=this._formContext)||void 0===e?void 0:e.ui)||void 0===t?void 0:t.controls))for(let e=0;e<this._formContext.ui.controls.getLength();e++){const t=this._formContext.ui.controls.get(e);if("formcomponent"===t.getControlType()&&t.isLoaded()&&!(null===(n=t.data)||void 0===n?void 0:n.isValid())){i=!1;break}}return i||K.dispatch(Object(W.b)(this._pageId,this._contextToken)),g.a.instance.reportSuccess(r),i}catch(e){const t=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(r,e,null,t),e}}addOnLoad(e){const t="ClientApi.XrmFormData.addOnLoad";e||Object(h.j)(t,"handler");try{g.a.instance.reportCall(t),K.dispatch(Object(_.c)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}removeOnLoad(e){const t="ClientApi.XrmFormData.removeOnLoad";e||Object(h.j)(t,"handler");try{g.a.instance.reportCall(t),K.dispatch(Object(_.x)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const n=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,n),e}}}function Z(e,t,n,a,s,o,c,l){const u=t.getState(),d=r.a.tryParseOrNull(o.getId());if(s.contextTokenType===z.a.GridRow){const n=[],r=Object(Y.T)(u,e,s.parentContextToken,s.parentContextToken.controlName);return o.attributes.forEach(e=>n.push(e.getName())),a.push({name:"functionName",value:"saveEmbeddedEntity"}),t.dispatch(Object(X.a)(e,o.getEntityName(),null==d?void 0:d.guid,null,n,null==r?void 0:r.guid,!1,s.parentContextToken))}if(Object(i.Kb)(u,e))return a.push({name:"functionName",value:"saveAndCloseFormDialogAction"}),t.dispatch(Object(U.a)(e));if(d&&!r.a.equals(d,r.a.EMPTY))return a.push({name:"functionName",value:"saveForm"}),t.dispatch(Object(L.e)(e,n));const p=Object(N.l)(t.getState(),e);return a.push({name:"functionName",value:"saveFormAndNavigate"}),t.dispatch(Object(L.f)(e,p,l,n,!1,c))}},LLfG:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="attribute.submitmode";function a(e,t,n,a){const s=Object(r.x)(t);return{type:i,payload:a,meta:{pageId:e,contextKey:s,dataFieldName:n}}}},MgYC:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="form.ShowHeaderFieldsInFlyout.set";function a(e,t,n){const a=Object(r.v)(t);return{type:i,payload:{headerFieldsInFlyout:n},meta:{pageId:e,contextKey:a}}}},MoY7:function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var r=n("arV0"),i=n("xhhr"),a=n("dHD5"),s=n("odYE"),o=n("i1f0"),c=n("Lyxw"),l=n("3/02"),u=n("NjDY"),d=n("b8TU"),p=n("unFF"),h=n("bT7G"),g=n("WPtp"),m=n("SAYH"),b=n("6QGX"),y=n("uhZ3"),f=n("jq7Z"),S=n("zmL5"),v=n("5ZBI"),C=n("pEXn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class O{constructor(e){this.previousReturn={EnableInMobile:!1,PowerBIGroupId:"",PowerBIDashboardId:"",PowerBIReportId:"",PowerBIFilter:"",TileId:"",TileUrl:"",PowerBIType:0,IsPowerBIEnabled:!1,FirstPartyIntegrationSiteUrl:"",PowerBISignedInState:"",setPowerBISignedInState:P,beginSecureSessionForResource:P},this._propKey=e}linkToParameter(e,t){const n=t.setPowerBISignedInState;e.setPowerBISignedInState=e=>n(this._pageId,e);const r=t.beginSecureSessionForResource;e.beginSecureSessionForResource=r}retrievePowerBIObject(e,t,n,g){var m,b;this._pageId=t.id;const y=t.descriptor.Parameters,O=Object(i.b)(e),F=n.Parameters[this._propKey],T=Object(u.z)(e);let w,E,x;Object(c.c)(e,l.Wc)&&(E=y.PowerBIReportId,x=F.PowerBIReportId,y.PowerBIFilter&&(w=function(e,t,n){const{entityTypeName:i,id:c}=Object(r.g)(e,t),l=Object(a.j)(e,t),u=Object(o.ac)(e,t,l),d=new s.a(i,c);try{const t=JSON.parse(n);let r=t.Filter;const i=t.Alias;for(const t in i){const n=i[t],a=Object(h.d)(e,u,d,n),s=a&&j(a)||null;if(Array.isArray(s)){const e=s.map(e=>I(e,!1)).join(",");r=r.split(t).join(e)}else r=_(r,[{placeholder:`"${t}"`,value:I(s,!0)},{placeholder:`'${t}'`,value:null===s?I(s,!0):`'${encodeURIComponent(s)}'`},{placeholder:t,value:I(s,!1)}])}return r}catch(e){return void v.a.error(C.w,[{name:"errorCategory",value:"PowerBIFilter"},{name:"errorMessage",value:null==e?void 0:e.message},{name:"callstack",value:null==e?void 0:e.stack},{name:"filter",value:n}])}}(e,this._pageId,y.PowerBIFilter)));const N=Object(f.a)(e,this._pageId).powerBISignedInState,A=Object(S.b)(e,this._pageId),k=Object(d.c)(e),M=Object(p.a)(e);return this.previousReturn={EnableInMobile:"true"===(null===(m=F.EnableInMobile)||void 0===m?void 0:m.toString().toLowerCase())||"true"===(null===(b=y.EnableInMobile)||void 0===b?void 0:b.toString().toLowerCase()),PowerBIGroupId:F.PowerBIGroupId||y.PowerBIGroupId,PowerBIDashboardId:F.PowerBIDashboardId||y.PowerBIDashboardId,PowerBIReportId:x||E,PowerBIFilter:w,TileId:F.TileId||y.TileId,TileUrl:F.TileUrl||y.TileUrl,PowerBIType:parseInt(F.PowerBIType,10)||parseInt(y.Type,10)||0,IsPowerBIEnabled:O.isPowerBIEnabled,FirstPartyIntegrationSiteUrl:O.firstPartyIntegrationSiteUrl,PowerBISignedInState:N,Tenant:T,ForceMobile:k<=M.sizes.Breakpoints.DimensionS,FormId:A,setPowerBISignedInState:P,beginSecureSessionForResource:P},this.previousReturn}getLatestData(){return this.previousReturn}}function _(e,t,n=0){const{placeholder:r,value:i}=t[n],a=e.split(r),s=n+1;if(s<t.length)for(const e in a)a[e]=_(a[e],t,s);return e=a.join(i)}function I(e,t){if(!t&&(null==e?void 0:e.length)>0){const t=Number(e);if(!isNaN(t)&&t.toString()===e)return JSON.stringify(t)}return JSON.stringify(e)}function j(e){if(Object(g.i)(e))return e.valueString;if(Object(g.g)(e))return m.a.toString(e.id);if(Object(g.k)(e))return e.reference&&m.a.toString(e.reference.id);if(Object(g.j)(e))return!Object(y.a)(e.value)&&e.value.toString();if(Object(g.h)(e)){const t=Object(b.h)(e);if(t){return t.map(e=>m.a.toString(m.a.fromExternalGuid(e.id)))}}else if(Object(g.f)(e)&&e.innerValue)return j(e.innerValue)}function P(){throw new Error("Not Replaced")}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const F="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlPowerBISelector";function T(){return(e,t,n,r,i)=>{v.a.info(n.controlId+"."+F+": createGetPowerBIData started");const a=new O(e);return a.retrievePowerBIObject(t,n,r,i),v.a.info(n.controlId+"."+F+": createGetPowerBIData finished"),a}}},"N+Ya":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="navigation.item.label";function i(e,t,n,i){return{type:r,payload:{label:n,currentLanguageId:i},meta:{pageId:e,navigationItemId:t}}}},NPmm:function(e,t,n){"use strict";n.d(t,"c",(function(){return S})),n.d(t,"d",(function(){return v})),n.d(t,"b",(function(){return C})),n.d(t,"a",(function(){return O}));var r=n("u+q+"),i=n("Zzxs"),a=n("nuS9"),s=n("jTSi"),o=n("arV0"),c=n("uNLT"),l=n("SAYH"),u=n("cfbi"),d=n("dHD5"),p=n("i1f0"),h=n("/q/W"),g=n("aOhN"),m=n("ruPX"),b=n("z0a7"),y=n("1fn7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function f(e,t){return e(Object(c.e)(t,1))}function S(e){const t=Object(r.c)(),n=Object(r.d)(t=>Object(d.j)(t,e),r.b),p=Object(r.d)(t=>Object(o.g)(t,e)),{isInCreateMode:m,isDirty:b}=v(e),y=a.useCallback(()=>{t(Object(s.b)(n,e,i.b)),p&&p.id&&!l.a.isNullOrEmpty(p.id)?f(t,e):t(Object(c.f)(e,u.a,!0,1,!1)).then(r=>{r&&Object(c.d)(t,n,e)})},[n,t,e,p]),S=a.useCallback(()=>{t(m?Object(g.b)():Object(h.a)(e))},[t,m,e]);return a.useMemo(()=>({save:y,discard:S,isInCreateMode:m,isDirty:b}),[S,b,m,y])}function v(e){const t=Object(r.d)(t=>Object(o.m)(t,e)),n=Object(r.d)(n=>t||Object(p.Nb)(n,e,Object(d.j)(n,e)));return{isInCreateMode:t,isDirty:n}}function C(e){const t=Object(r.c)(),n=Object(b.a)([y.n])[y.n],{entityTypeName:i}=Object(r.d)(t=>Object(o.g)(t,e));return a.useMemo(()=>[{save:()=>f(t,e).then(()=>t(Object(m.a)(u.a,{entityTypeName:i},e))),label:n}],[t,i,e,n])}function O({pageId:e,children:t}){const{save:n,isDirty:r}=S(e);return t(n,r)}},Nse0:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n("BFlg"),i=n("Uv1Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="customcontrol.refreshCustomDataProvider";function s(e,t,n,s){return{type:"customcontrol.refreshCustomDataProvider.async",execute({dispatch:o,getState:c},l){const u=r.x+".refreshCustomDataProviderAction";return s().then(r=>(o(function(e,t,n,r){let i=new Array;r&&r.length>0&&(i=r.slice());return{type:a,payload:i,meta:{pageId:e,customControlId:t,dataSetParameterName:n}}}(e,t,n,r)),l.EventManager.ReportComponentSuccess(u),r)).catch(e=>(l.EventManager.ReportComponentFailure(u,Error(e)),Promise.reject(new i.a(e))))}}}},NtHU:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="header.bodyvisible";function a(e,t,n){const a=Object(r.v)(t);return{type:i,payload:n,meta:{pageId:e,contextKey:a}}}},OA2N:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n("nuS9"),i=n("4fxQ"),a=n("89vK"),s=n("u+q+"),o=n("Smta"),c=n("H/hG"),l=n("YWpA"),u=n("XIN1"),d=n("znb3"),p=n("Afz2"),h=n("RiHV"),g=n("VnpK");class m extends r.Component{render(){let e=this.props.isScrollable?this.props.scrollableTabStyle:this.props.tabStyle;this.props.isSelected&&(e=this.props.isScrollable?1===this.props.tabLength?this.props.singleScrollableSelectedTabStyle:this.props.scrollableSelectedTabStyle:this.props.selectedTabStyle);const t=Object.assign(Object.assign({},e),this.props.style);let n;if(this.props.isMoreTab)n=r.createElement(o.a,{style:t,id:this.props.id,role:p.t,tabIndex:this.props.isSelected&&this.props.tabLength>1?0:-1,testhooks:this.props.testhooks,accessibilityHasPopup:!0,accessibilityExpanded:!!this.props.isFlyoutOpened,onClick:this.props.onClick,accessibilityLabel:this.props.label},r.createElement(l.a,{style:this.props.overflowButtonStyle,id:"button_"+this.props.id,accessibilityHidden:!0,testhooks:{id:"more_button"}},r.createElement(c.a,null,r.createElement(u.b,{id:"icon_"+this.props.id,type:d.a.More}))));else{const e=this.props.relatedTabId===this.props.id,i=this.props.isFlyoutOpened?"relatedEntityContainer":"",a=Object(g.n)()?this.props.highContrastSelectedTabUnerlineStyle:this.props.selectedTabUnderlineStyle;n=r.createElement(o.a,Object.assign({style:t,id:this.props.id,testhooks:this.props.testhooks,"aria-controls":this.props.tabName,isSelected:this.props.isSelected,tabIndex:this.props.isSelected?0:-1,role:this.props.isOverFlowEnabled?p.n:p.t,ownsElementId:e?i:"",accessibilityHasPopup:!!e||null,accessibilityExpanded:e?!!this.props.isFlyoutOpened:null,title:this.props.label,accessibilityLabel:this.props.label,onClick:this.props.onClick},{[h.a.LearningPathDOMAttributeName]:"form-tab-"+this.props.id}),this.props.label,r.createElement(l.a,{style:this.props.isSelected&&!this.props.isScrollable?a:null,accessibilityHidden:!0}),r.createElement(l.a,{style:this.props.semiboldContainerStyle,accessibilityHidden:!0},this.props.label))}return n}componentDidUpdate(e){if(this.props.isSelected&&!e.isSelected){const e=i.findDOMNode(this);e&&e.focus()}}}m.displayName="TabListItem";const b=Object(s.a)((function(){const e=Object(a.a)();return function(t,n){const r=e(t,n);return{selectedTabStyle:r.selectedTabStyle,scrollableSelectedTabStyle:r.scrollableSelectedTabStyle,singleScrollableSelectedTabStyle:r.singleScrollableSelectedTabStyle,tabStyle:r.tabStyle,scrollableTabStyle:r.scrollableTabStyle,selectedTabUnderlineStyle:r.selectedTabUnderlineStyle,highContrastSelectedTabUnerlineStyle:r.highContrastSelectedTabUnerlineStyle,semiboldContainerStyle:r.semiboldContainerStyle,overflowButtonStyle:r.overflowButtonStyle}}}))(m)},OWbt:function(e,t,n){"use strict";n.d(t,"f",(function(){return ve})),n.d(t,"h",(function(){return re})),n.d(t,"i",(function(){return de})),n.d(t,"j",(function(){return pe})),n.d(t,"k",(function(){return he})),n.d(t,"c",(function(){return se})),n.d(t,"d",(function(){return oe})),n.d(t,"a",(function(){return te})),n.d(t,"b",(function(){return ne})),n.d(t,"e",(function(){return ie})),n.d(t,"g",(function(){return Se}));var r=n("4leG"),i=n("SAYH"),a=n("y60j"),s=n("Uv1Y"),o=n("i1f0"),c=n("Z/4N"),l=n("arV0"),u=n("odYE"),d=n("LbMF"),p=n("IqkD"),h=n("mIxf"),g=n("1qQb"),m=n("FZDd"),b=n("WY/A"),y=n("Dea/"),f=n("iZ7K"),S=n("5Oca"),v=n("Jj4w"),C=n("IVVt");var O=n("3hnk"),_=n("qTme"),I=n("dMZy"),j=n("lLEV"),P=n("5ZBI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const F="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlTimelineWallSelector";var T=n("E5qG"),w=n("dHD5"),E=n("EY5k"),x=n("YGjz"),N=n("3mEc"),A=n("8nT0"),k=n("Co7m"),M=n("bT7G"),D=n("AF/G"),R=n("1usl"),B=n("4Us1"),L=n("99zj"),V=n("E8F2"),z=n("YxC/"),H=n("HfZT"),G=n("74Tm"),W=n("9fGf"),U=n("/qEh"),q=n("ldGr"),X=n("NUHF"),Y=n("3/02"),K=n("Lyxw"),Q=n("N6E8"),Z=n("455M"),J=n("p8cR"),$=n("pF61"),ee=n("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const te="form.initialize",ne="form.xrmready";function re(e,t,n,r,c){const g=[{name:"formId",value:i.a.toString(e)},{name:"pageId",value:t},{name:"contextKey",value:Object(w.v)(n)}];return{type:"form.initialize.async",execute({dispatch:m,getState:b},y,S){const v=b(),C=Object(l.g)(v,t),{entityTypeName:_,data:I,recordSetQueryKey:E}=C,x=y.TraceManager.getTracer("Forms.InitializeForm"),M=[];let B;if(g.push({name:"isPreview",value:C&&C.isPreview}),g.push({name:"EntityName",value:C&&C.entityTypeName}),x.info("initializeForm started.",g),Object(J.b)(function(e){return()=>{const t={},n={},r={};return(i,a,s,o,c)=>{P.a.info(F+s.controlId+": createGetTimelineWallData started");let l=!1;n.hasOwnProperty(i)&&n[i]||(n[i]=new j.a(e,i,s.id));const u=n[i],d=u.retrieveTimelineWallObject(a,s,o,c,e);r.hasOwnProperty(i)&&r[i]&&d===r[i]||(r[i]=d,l=!0);const p=u;return l&&(t[i]=p),P.a.info(F+s.controlId+": createGetTimelineWallData finished"),t[i]}}}(m),Z.a.TimelineWall),x.info("BusinessProcessWrapperManager.Instance.init started.",g),M.push(k.a.Instance.init(y,b,m).then(()=>x.info("BusinessProcessWrapperManager.Instance.init completed.",g))),Object(O.a)(v,e))if(Object(l.m)(v,t)){if(!Object(O.g)(v,_,1,0)&&!(null==C?void 0:C.isPreview))return ae(22e8,m,x,S,v,t)}else{if(!Object(O.g)(v,_,2,0))return ae(2147746342,m,x,S,v,t)}const z=Object(a.j)(v,e),W=Se(v,z,e),$=be(v,_,z),ee=function(e,t,n,r){const i={};if(t&&t.RelatedEntityAttributes&&r)for(const a in t.RelatedEntityAttributes){const s=Object(f.x)(e,r,a);if(s&&s.ReferencedEntity){const r={},o=ye(e,s.ReferencedEntity,t.RelatedEntityAttributes[a]),c=Object(w.m)(n,a);i[Object(w.v)(c)]={attributes:o,submitModes:r}}}return i}(v,z,n,_),te=Object(G.a)(v),ne=Object(p.s)(v);Ce(v,m,e,W,$,t,n,ee,ne),E&&!te&&m(Object(H.g)(t,E)),x.info("Update quick view forms started.",g);for(const r in z.InlineQuickForms){const i=z.InlineQuickForms[r];for(const s in i){const o=i[s],c=Object(a.j)(v,o),l=Se(v,c,o),u=be(v,s,c),d=Object(w.l)(n,r,s);Ce(v,m,e,l,u,t,d,null,ne)}}if(x.info("Update quick view forms completed.",g),I&&0!==Object.keys(I).length){const{createFromEntity:r,createFromRelationship:a}=C,{initWithEntity:c}=C;let p=r;!p&&c&&(p=c),B=function(e,t,n,r,a,c,p,g,m,b,y){n&&n.info("initializeFormWithDefaultValue started.",r);const S=Object(d.d)(e,c);let v=null;const C={},O=Object(l.m)(e,a),_=i.a.toString(g);let I,j;const P=[];_&&(v=Object(d.k)(e,_));for(const s of Object.keys(p)){if("processid"===s)continue;let l=S[s];if(!l&&v&&(l=v[s]),l&&!l.AttributeOf){const o=l.Type;switch(o){case"customer":case"owner":case"lookup":case"regarding":if("string"==typeof p[s]){const u=ce(p,s,l);if(!u){ue(n,s);continue}if(C[s]=u,!i.a.equals(i.a.EMPTY,u.id)&&"owner"!==o&&O&&(b||y))if(j){const e=j.then(()=>t(Object(U.b)(a,g)).then(()=>{n&&n.info("updateSnapshotWithOptions completed (1).",r)}));P.push(e)}else j=me(e,t,u,c,a,n,r,b,y),P.push(j)}else{let e;e=Array.isArray(p[s])?p[s][0]:p[s],e&&e.id&&i.a.tryParseOrNull(e.id)&&e.entityType&&(C[s]=new u.a(e.entityType,new i.a(e.id),e.name))}break;case"partylist":const d=p[s];let h=d;const m=[];try{"string"==typeof d&&(h=JSON.parse(d));for(const e of h)m.push(new u.a(e.entityType,new i.a(e.id),e.name))}catch(e){ue(n,s,"partylist")}C[s]=m;break;case"boolean":case"picklist":case"status":C[s]=p[s];break;case"uniqueidentifier":C[s]=new i.a(p[s]);break;default:C[s]=p[s]}}else if(-1!==s.indexOf(Q.d)||"_CreateFromId"===s){let i=null;if(-1!==s.indexOf(Q.d)&&(i=ce(p,Q.d,l)),!i&&"_CreateFromId"===s){const t=Object(f.m)(e,p._CreateFromType),n=Object(f.h)(e,t);n&&(i=le(t,p._CreateFromId,n.DisplayName))}if(!i){ue(n,Q.d);continue}if(!I&&(I=i,O))if(j){const e=j.then(()=>t(Object(U.b)(a,g)).then(()=>{n&&n.info("updateSnapshotWithOptions completed (2).",r)}));P.push(e)}else j=me(e,t,I,c,a,n,r,b,y),P.push(j);if(Object(f.h)(e,c).IsActivity&&-1===Object.keys(C).indexOf(A.t)&&Object(f.z)(e,c,I.etn,A.t)){const t=Object(o.ab)(e,a,m);t&&t[A.t]&&(C[A.t]=i)}}else{ue(n,s);if(Object(K.c)(e,Y.Rc))return Promise.reject(Object(V.b)(e,a,2200000009))}}const F=Object(K.c)(e,Y.L);let T=C;F&&(T=function(e,t,n,r,i){const a={},s=Object(w.w)(r),c=Object(o.P)(e,s,t,n);for(const s in i){if(!c||!c.hasOwnProperty(s)){a[s]=i[s];continue}const o=Object(d.a)(e,t,s);if(!(o&&o.ParentPicklistLogicalName)&&!Object(q.a)(e,r,n,t,c,s,{name:s,value:0})){a[s]=i[s];let c=[];for(o&&o.ChildPicklistLogicalNames&&(c=c.concat(o.ChildPicklistLogicalNames));c&&c.length>0;){const s=c.pop();if(i.hasOwnProperty(s)){const o=Object(d.a)(e,t,s),l=JSON.parse(i[o.ParentPicklistLogicalName]),u=JSON.parse(i[s]);Object(X.a)(e,n,r,o,t,l,u)&&(a[s]=i[s],o.ChildPicklistLogicalNames&&o.ChildPicklistLogicalNames.length>0&&(c=c.concat(o.ChildPicklistLogicalNames)))}}}}return a}(e,c,a,m,C));const E=ge(T);if(P.length>0)return Promise.all(P).catch(e=>{if(2147749377===e.errorCode||-2147093999===e.errorCode)return Promise.resolve(null);Object(s.b)(e)}).then(()=>(t(Object(h.a)(a,E,!0,!0)),n&&n.info("initializeFormWithDefaultValue completed at snapshotPromiseList.length > 0.",r),Promise.resolve(null)));return t(Object(h.a)(a,E,!0,!0)),n&&n.info("initializeFormWithDefaultValue completed at snapshotPromiseList.length == 0.",r),Promise.resolve(null)}(b(),m,x,g,t,_,I,e,n,p,a)}if(z&&z.Controls&&z.Controls.notescontrol){const e=Object(l.g)(v,t);x.info("loadTimelineConfigAndMetaData started.",g),m(Object(T.b)(z.Controls.notescontrol,e,r)).then(()=>{x.info("loadTimelineConfigAndMetaData completed.",g)})}if(z&&z.Controls)for(const e in z.Controls)if(z.Controls[e]){if(z.Controls[e].Id&&z.Controls[e].Id.startsWith("WebResource"))for(const t of z.Controls[e].Parameters)if("Url"===t.Name){let e=!1;if(c)for(const n of c){const r=t.Value&&t.Value.toLowerCase()||"";if(r.length>=n.length&&r.length-n.length===r.lastIndexOf(n)){e=!0;break}}if(!e){const e=Object(N.j)(v,t.Value);e&&!e.Name&&(x.info("retrieveWebResourceDescriptorByName started.",g),m(Object(L.c)(t.Value)).then(()=>{x.info("retrieveWebResourceDescriptorByName completed.",g)}))}}i.a.equals(z.Controls[e].ClassId,D.rb)&&v&&void 0===v.currentServerTime.serverTimeDiffInSeconds&&(x.info("retrieveServerTime started.",g),m(Object(R.b)(new u.a(_))).then(()=>{x.info("retrieveServerTime completed.",g)}))}return null!=B?B:(x.info("initializeForm completed.",g),Promise.all(M))},getFailureParameters:(e,t)=>g}}function ie(e,t,n,i,a,s,o){const c=t(Object(m.f)(s,!1,[])).then(()=>{const n=Object(f.h)(e(),s);if(n.IsChildEntity){const r=Object(O.d)(e(),n);return t(Object(m.f)(r.EntityLogicalName,!1,[]))}}),u=()=>{const a=e();if(!Object(O.b)(a,s))return ae(2200000001,t,n,i,a,o);const c=Object(O.c)(a,s),u=Object(r.d)(a);return c&&Object(l.m)(a,o)&&!u?ae(2200000002,t,n,i,a,o):void 0};return c?c.then(u):Promise.resolve(u())}function ae(e,t,n,r,i,a){const s=Object(V.d)(e);return t(Object(E.e)(s)).then(()=>{const t=Object(V.c)(e);if(n){const e=[{name:"CorrelationId",value:r.correlationId},{name:"ContextId",value:r.contextId},{name:"ActionStack",value:r.stack}];n.debug(t,e)}const o=Object(z.e)(i,s),c=Object(z.c)(o,s[0]),l=Object(z.c)(o,s[1]);throw Object(V.b)(i,a,e,t,c,l)})}function se(e,t,n,r,i,a,s,c,g){g.push({name:"AutoPopulateFieldsTimeStamp",value:Date.now()}),c&&c.info("autoPopulateFields started.",g);const m=Object(d.d)(e,n);if(!m)return void(c&&c.warn("attributes is null.",g));const b=e=>e&&e.OptionSet&&Object.keys(e.OptionSet).length>0,{id:y}=Object(l.g)(e,r),f=new u.a(n,y),S={},v=Object(o.ac)(e,r,s);for(const t of i.concat(a)){const n=m[t];if(n&&(i.indexOf(t)>=0&&a.indexOf(t)>=0||b(n))){if(!Object(o.X)(e,r,s,v,f,n.LogicalName)){switch(t){case A.q:const n=Object(p.q)(e),r=Object(p.t)(e);if(n&&r){const e=new u.a(x.a,n,r);S[t]=e}break;case A.w:if(!Object(M.d)(e,v,null,A.w)){const n=Object(p.b)(e);if(n){const e=new u.a(x.b,n.transactionCurrencyId,n.currencyName);S[t]=e}}}if(b(n)){const r=Object(M.d)(e,v,new u.a(n.EntityLogicalName),t),a=r?parseInt(r.valueString,10):null!=n.DefaultValue?n.DefaultValue:t===A.u?0:void 0;if(void 0===a||a<0||(S[t]=a),t===A.u&&-1!==i.indexOf(A.v)){const e=m[t];if(e&&e.OptionSet&&Object.keys(e.OptionSet).length>0){const e=n.OptionSet.find(e=>e.Value===a),t=e?e.DefaultStatus:m[A.v].DefaultValue||0;t<0||(S[A.v]=t)}}}}}}const C=ge(S);t(Object(h.a)(r,C,!0,!0)),c.info("autoPopulateFields completed.",g)}function oe(e,t,n,r,a,s,o){const{id:c}=Object(l.g)(e,r),d=new u.a(n,c),p={};if(i.a.isNullOrEmpty(d.id)&&!o)return function(e,t,n,r,a){const s=Object(S.d)(e,n);if(null!=s)return Promise.resolve(s);return t(Object(B.a)(i.a.EMPTY,new u.a(n,i.a.EMPTY))).then(e=>e&&e.businessProcessFlows?Promise.resolve(i.a.tryParse(Object.keys(e.businessProcessFlows)[0])):Promise.resolve(null)).catch(e=>{const t=[{name:"CorrelationId",value:a.correlationId},{name:"ContextId",value:a.contextId},{name:"ActionStack",value:a.stack},{name:"entityName",value:n},{name:"reason",value:e&&e.message?e.message:JSON.stringify(e)}];return r.EventManager.ReportComponentFailure("Forms.InitializeForm",Error("Catch block of InitializeForm.retrieveBusinessProcessFlow"),void 0,t),r.TraceManager.getTracer("Forms.InitializeForm").error("Error while executing getBusinessProcessFlowDefaultIdForEntity in the retrieveBusinessProcessFlow promise.",t),Promise.resolve(null)})}(e,t,n,a,s).then(e=>{e&&(p.processid=e.guid);const n=ge(p);return t(Object(h.a)(r,n,!0,!0)),Promise.resolve()});o&&(p.processid=o);const g=ge(p);return t(Object(h.a)(r,g,!0,!0)),Promise.resolve()}function ce(e,t,n){let r=t;!t.match(/id$/i)&&t.indexOf(Q.d)>-1&&(r+="id");const a=e[r];if(null!=a){if(i.a.validate(a)){const r=a,i=e[t+"name"];let s=e[t+"type"]||e[t+"target"];return!s&&n.Targets&&n.Targets.length>0&&(s=n.Targets[0]),le(s,r,i)}try{const e=JSON.parse(a);if(e)return le(e.entityType,e.id,e.name)}catch(e){}}return null}function le(e,t,n){if(e&&t&&i.a.validate(t)){const r=new i.a(t);if(!i.a.isNullOrEmpty(r))return new u.a(e,r,n)}return null}function ue(e,t,n){if(e){const r=[{name:"key",value:t},{name:"source",value:n}];e.warn("Value passed is not in correct syntax.",r)}}function de(e,t,n,r,i,a,s,o){return pe(e,t,n,r,a,s,o).then(()=>he(e,t,n,i,a,s,o))}function pe(e,t,n,r,i,a,s){if(!Object(o.Eb)(e,i)&&Object($.n)(e,i))return a&&a.warn("pageId"+i+" is dead so rejecting loadScripts"),Promise.reject(Object(V.b)(e,i,2200000008,"Page has expired."));a&&a.info("loadScripts started.",s);return n(t.ScriptManager.getContainer(i).getEventManager().loadScripts(r,i)).then(()=>{a&&a.info("loadScripts completed",s)})}function he(e,t,n,r,i,a,s){if(!Object(o.Eb)(e,i)&&Object($.n)(e,i))return void(a&&a.warn("pageId "+i+" is dead so won't run runFormOnLoadScripts",s));a&&a.info("runFormOnLoadScripts started.",s);const c=t.ScriptManager.getContainer(i).getEventManager();n(c.addPblEvent(r)),n(c.runOnLoad(r,1)),n(c.runOnDataLoad(r,1)),a&&a.info("runFormOnLoadScripts completed.",s)}function ge(e){const t={};for(const n in e){const r={fieldName:n,value:e[n]};t[n]=r}return t}function me(e,t,n,r,i,a,o,c,l){const d=Object(w.j)(e,i),p=Object(w.x)(d);return a&&a.info("createAndSetDataSnapshotFrom started.",o),t(function(e,t,n,r,i){return{type:"snapshot.from.async",execute({dispatch:a,getState:o},c){const l=c.DataSource,d=u.a.toLegacyEntityReference(e),p=new v.a(d,t,C.a.All),h=l.execute(p,null).nativePromise();let O=null,_=null,I=null;return h.then(e=>{const n=e.get_entity();return O=Object(g.a)(n),_=O.fields,I=O.identifier,a(Object(m.f)(t,!1,Object.keys(O.fields)))},e=>{const n=Object(s.c)(e);if(e&&e.get_ErrorCode&&(-2147093999===e.get_ErrorCode()||n&&-2147217919===n.getNegativeErrorCode())&&r){const e=[];if(_={},r.etn){const n=Object(f.c)(o(),r.etn,t);if(n)for(const t of n)t.ReferencingAttribute&&e.push(t.ReferencingAttribute)}else i&&e.push(i.attributeName);for(const t of e){if(!r.name&&r.id){const e=Object(S.h)(o(),r.etn,r.id.guid);if(e&&e.fields){const t=Object(f.E)(o(),r.etn);let n=e.fields[t];n&&n.value||(n=e.fields.name),n&&n.value&&(r={etn:r.etn,id:r.id,name:n.value})}}_[t]={reference:r,timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}}}return I=new u.a(t),a(Object(m.f)(t,!1,e))}Object(s.b)(e)}).then(()=>{const e=Object(b.b)(o(),I,_,n,y.a.Create),t=e.payload.snapshotId;return a(e),t})}}}(n,r,p,c,l)).then(e=>{a&&(o.push({name:"newSnapshotId",value:e?e.toString():"<null>"}),a.info("initializeCreateDataSnapshotFrom completed.",o)),t(Object(_.b)(i,e,d)).then(()=>{a&&a.info("createAndSetDataSnapshotFrom completed.",o)})})}function be(e,t,n){let r={};if(n&&n.Attributes&&t){const i=Object(N.d)(e,n.FormLibraries,[t]);if(n.Attributes||i){const a=[].concat(n.Attributes,i);-1===a.indexOf(A.u)&&a.push(A.u),r=ye(e,t,a)}}return{attributes:r,submitModes:{}}}function ye(e,t,n){const r={};if(n&&t)for(let i=0;i<n.length;i++){const a=n[i];if(a){const n=Object(o.L)(e,t,a);n&&(r[a]=n)}}return r}function fe(e){return Array.isArray(e)?e:e.Controls?e.Controls:null}function Se(e,t,n){const r={},i={},a={},s={bodyVisible:!0,commandBarVisible:!0,tabNavigatorVisible:!0},l={visible:!0};let u={navBarAreas:{},navPaneIsvItems:{},navBarByRelationshipItems:{},navBarItems:{}};if(t&&t.Tabs&&t.TabNames){const n=Object(o.m)(e,t);let s=!1;for(const o of n){const n={collapsed:!!s||!(o.Expanded&&o.Visible),visible:o.Visible,label:o.Label,sectionNames:[],domId:o.DomId,showLabel:o.ShowLabel,contentType:null};switch(o.ContentType){case"expandAvailableSpace":case"singleComponent":n.contentType="singleComponent";break;default:n.contentType="cardSections"}s=s||o.Expanded&&o.Visible;const l=[];if(o.Columns)for(let n=0;n<o.Columns.length;n++){const r=o.Columns[n];if(r.SectionNames)for(let n=0;n<r.SectionNames.length;n++){const s=r.SectionNames[n];if(t.Sections[s]){const n=t.Sections[s];l.push(s);const r=[];for(const e of t.Sections[s].Rows)for(const t of e.Cells)t.ControlName&&r.push(t.ControlName);const u={parentTabId:o.Id,visible:n.Visible,label:n.Label,controlNames:r,domId:n.DomId,semanticZoomDomId:n.SemanticZoomDomId};i[s]=u;for(let n=0;n<r.length;n++){const i=r[n];if(t.Controls[i]){const n=t.Controls[i],r=ve(n,s,!0),o=Object(c.a)(n,t,Object(W.b)(e));null!=o&&(r.visible=r.visible||o.ShouldOverrideControlVisible),Oe(r),a[i]=r}}}}}if(o.Header)for(const e of o.Header)a[e.Name]=ve(e,null,!0);if(o.Footer)for(const e of o.Footer)a[e.Name]=ve(e,null,!0);n.sectionNames=l,r[o.Id]=n}}if(t&&t.Navigation&&(u=t.Navigation),t&&t.Header){const e=fe(t.Header);if(e)for(const t of e)a[t.Name]=ve(t,null,!0),Oe(a[t.Name]);s.bodyVisible=!1!==t.Header.BodyVisible,s.commandBarVisible=!1!==t.Header.CommandBarVisible,s.tabNavigatorVisible=!1!==t.Header.TabNavigatorVisible}if(t&&t.Footer){const e=fe(t.Footer);if(e)for(const t of e)a[t.Name]=ve(t,null,!0),Oe(a[t.Name]);l.visible=!1!==t.Footer.Visible}return{formId:n,tabs:r,sections:i,controls:a,selectedTab:Object(I.a)(),selectedRelatedEntity:null,isSaving:!1,invalidControls:{},invalidAttributes:{},controlUnboundOutputs:{},inlineQuickForms:t&&t.InlineQuickForms?t.InlineQuickForms:null,xrmReady:!1,label:"",navigation:u,viewportWidth:0,viewportHeight:0,showHeaderFieldsInSection:!1,headerFieldsInFlyout:new Set,isAutoSaving:!1,header:s,footer:l}}function ve(e,t,n){return e?{parentSectionName:t,visible:e.Visible,label:e.Label,valid:n,labelSource:e.LabelSource,domId:e.DomId,parameters:e.Parameters,dataFieldName:e.DataFieldName,relationship:e.Relationship}:null}function Ce(e,t,n,r,a,s,c,l=null,u){const d=Object(o.cb)(e,s,c),p=Object(ee.a)(e,s);i.a.equals(null==d?void 0:d.formId,null==r?void 0:r.formId)&&i.a.equals(n,null==p?void 0:p.formId)||t(function(e,t,n,r,i,a=null,s){return{type:te,payload:{formId:e,formUIState:t,formMetadataState:n,relatedEntityMetadataState:a,currentLanguageId:s},meta:{pageId:r,contextToken:i}}}(n,r,a,s,c,l,u))}function Oe(e){e&&e.parameters&&e.parameters.DefaultViewId&&(e.parameters.defaultviewid=e.parameters.DefaultViewId)}},Oyec:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return{paddingLeft:e.sizes.Measures.Measure100,paddingRight:e.sizes.Measures.Measure100}}n.d(t,"a",(function(){return r}))},PZ34:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("ruPX"),i=n("baQL");function a(e,t){return Object(r.a)(i.a,{},t,e)}},PbI6:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="tab.contentType";function a(e,t,n,a){const s=Object(r.v)(n);return{type:i,payload:a,meta:{pageId:e,tabId:t,contextKey:s}}}},Q1Tc:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return a}));var r=n("dHD5"),i=n("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="control.update.unboundOutputs";function s(e,t,n,s){return{type:"control.update.unboundOutputs.async",execute({dispatch:o,getState:c}){if(!Object.keys(s).length)return Promise.resolve();const l=c(),u=Object(i.a)(l,e);let d=!1;const p=Object(r.v)(n),h=Object.assign({},u.forms[p].controlUnboundOutputs);for(const e in s){const n=s[e],r=t+"."+e;h[r]!==n&&(h[r]=n,d=!0)}return d&&o(function(e,t,n){return{type:a,payload:{controlUnboundOutputs:n},meta:{pageId:e,contextKey:t}}}(e,p,h)),Promise.resolve()}}}},QXpm:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));var r=n("dHD5"),i=n("BFlg"),a=n("LAGg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="grid.toggleRollupView";const o=(e,t,n)=>function(e,t,n,s){return{type:"grid.toggleRollupView.async",execute({dispatch:o},c){const l=c.TraceManager.getTracer(i.z),u=i.x+".toggleRollupViewAction";try{l.info(`Setting Toggle value to ${t} for the grid.`);const i=Object(r.v)(s);o(function(e,t,n,r){return{type:e,payload:t,meta:{pageId:n,dataSetContextKey:r}}}(e,t,n,i)),o(Object(a.b)(n,s));const d=[{name:"newValue",value:t}];return c.EventManager.ReportComponentSuccess(u,d),Promise.resolve()}catch(e){const t="Setting Toggle value to the grid failed";c.EventManager.ReportComponentFailure(u,Error(t))}}}}(s,e,t,n)},S1lN:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Web.Header.MoreFields",i="HeaderFields.KeyboardShortCut.Escape",a="Header_Fields_Label",s="HeaderFields.More.Error",o=["ProcessControl.Configurator.Collapse","ProcessControl.Configurator.Expand",r,i,"HeaderFields.KeyboardShortCut.Area",a,"Flyout.KeyboardShortCut.Tab.NotAllowed","HeaderFields.KeyboardShortCut.Down","HeaderFields.KeyboardShortCut.Up",s]},SVnG:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("+aBC"),i=n("Nse0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a={};function s(e=a,t){return t.type===i.a?Object.assign(Object.assign({},e),{[Object(r.a)(t.meta.customControlId,t.meta.dataSetParameterName)]:t.payload}):e}},ShM1:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("J1L+"),i=n("9kE/"),a=n("Gh4N"),s=n("Wv+H"),o=n("IrUg"),c=n("7JDo"),l=n("RoqB"),u={root:"ms-Spinner",circle:"ms-Spinner-circle",label:"ms-Spinner-label"},d=Object(s.a)({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}),p=Object(r.a)(i.a,(function(e){var t,n=e.theme,r=e.size,i=e.className,s=e.labelPosition,p=n.palette,h=Object(o.a)(u,n);return{root:[h.root,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},"top"===s&&{flexDirection:"column-reverse"},"right"===s&&{flexDirection:"row"},"left"===s&&{flexDirection:"row-reverse"},i],circle:[h.circle,{boxSizing:"border-box",borderRadius:"50%",border:"1.5px solid "+p.themeLight,borderTopColor:p.themePrimary,animationName:d,animationDuration:"1.3s",animationIterationCount:"infinite",animationTimingFunction:"cubic-bezier(.53,.21,.29,.67)",selectors:(t={},t[c.b]={borderTopColor:"Highlight"},t)},r===a.a.xSmall&&["ms-Spinner--xSmall",{width:12,height:12}],r===a.a.small&&["ms-Spinner--small",{width:16,height:16}],r===a.a.medium&&["ms-Spinner--medium",{width:20,height:20}],r===a.a.large&&["ms-Spinner--large",{width:28,height:28}]],label:[h.label,n.fonts.small,{color:p.themePrimary,margin:"8px 0 0",textAlign:"center"},"top"===s&&{margin:"0 0 8px"},"right"===s&&{margin:"0 0 0 8px"},"left"===s&&{margin:"0 8px 0 0"}],screenReaderText:l.a}}),void 0,{scope:"Spinner"})},Ss07:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("c/eZ"),i=n("nuS9"),a=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isRendered:!1},n}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props.delay;this._timeoutId=window.setTimeout((function(){e.setState({isRendered:!0})}),t)},t.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)},t.prototype.render=function(){return this.state.isRendered?i.Children.only(this.props.children):null},t.defaultProps={delay:0},t}(i.Component)},TAjd:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.collapsed="collapsed",e.expanded="expanded",e.floating="floating",e.getDefaultDisplayState=function(){return e.collapsed}}(r||(r={}))},TD3W:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="form.relationship.clear";function i(e,t){return{type:r,payload:{relationship:t},meta:{pageId:e}}}},Tg1Y:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="form.tab.selectPrevious";function a(e,t){const n=Object(r.v)(t);return{type:i,payload:null,meta:{pageId:e,contextKey:n}}}},TsER:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="refresh.timer";function a(e,t,n){const a=Object(r.x)(t);return{type:i,payload:null,meta:{pageId:e,contextKey:a,controlName:n}}}},UqyN:function(e,t,n){"use strict";n.d(t,"a",(function(){return ke})),n.d(t,"b",(function(){return Me}));var r=n("0nOn"),i=n("SAYH"),a=n("WPtp"),s=n("odYE"),o=n("ZIjf"),c=n("LbMF"),l=n("UJfx"),u=n("bT7G"),d=n("mlKL"),p=n("LLfG"),h=n("i1f0"),g=n("BvQu"),m=n("Sbn7"),b=n("mIxf"),y=n("1kth"),f=n("16wZ"),S=n("qshH"),v=n("dHD5"),C=n("iZ7K"),O=n("3tOH"),_=n("z5LE"),I=n("3HPu"),j=n("jTSi"),P=n("jq7Z"),F=n("fU7K"),T=n("O7zD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const w="ClientApi.XrmEntityAttribute.";let E;class x{constructor(e,t,n,i,a,s){E=e,this._clientApiExecutorAttribute=new r.a(e,w,n,t),this._clientApiExecutorAttribute.addEventParameter({name:"attributeName",value:i,isEventParam:!0});const o=this._clientApiExecutorAttribute.getComponentName("constructor");i||Object(f.j)(o,"attributeName"),e||Object(f.j)(o,"store"),n||Object(f.j)(o,"pageId"),t||Object(f.j)(o,"contextToken"),s||Object(f.j)(o,"xrmFormUi"),this._attributeName=i,this._parentEntity=a,this._pageId=n,this.xrmFormUi=s,this._contextToken=t}get controls(){return this._clientApiExecutorAttribute.execute("controls",(e,t)=>{if(!this._controls){this._controls=new m.a(e);const t=Object(h.z)(E.getState(),this._pageId,this.contextToken,this._attributeName);if(t){this.xrmFormUi.getControls();const e=this.xrmFormUi.controls;for(let n=0;n<t.length;n++){const r=t[n],i=e.get(r);i&&this._controls.add(r,i)}}}return this._controls})}addOnChange(e){const t=w+"addOnChange";e||Object(f.j)(t,"handler");try{o.a.instance.reportCall(t),E.dispatch(Object(y.a)(this.contextToken,this._pageId,this.getName(),e)),o.a.instance.reportSuccess(t)}catch(e){const n=S.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),S.a.getInstance().reportFailure(t,e,null,n),e}}fireOnChange(){const e=w+"fireOnChange";try{o.a.instance.reportCall(e),E.dispatch(Object(y.P)(this.contextToken,this._pageId,this.getName())),o.a.instance.reportSuccess(e)}catch(t){const n=S.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),S.a.getInstance().reportFailure(e,t,null,n),t}}getAttributeType(){const e=w+"getAttributeType";try{o.a.instance.reportCall(e);const t=this.getAttrDescriptor().Type;return o.a.instance.reportSuccess(e),t}catch(t){const n=S.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),S.a.getInstance().reportFailure(e,t,null,n),t}}getFormat(){return this._clientApiExecutorAttribute.execute("getFormat",()=>{const e=this.getAttrDescriptor();if(!e||!e.Format)return null;const t=e.Format.toLowerCase();let n=t;switch(this.getAttrDescriptor().Type){case"string":"text"===n||"email"===n||"phone"===n||"url"===n||"tickersymbol"===n||"1"!==t&&"2"!==t||(n="textarea");break;case"integer":"duration"!==n&&(n="none");break;case"lookup":"0"===t&&(n="none");break;case"memo":"2"!==t&&"1"!==t||(n="textarea");break;default:"0"===t?n="none":void 0===n&&(n=null)}return n})}getIsDirty(){const e=w+"getIsDirty";try{o.a.instance.reportCall(e);const t=Object(h.Jb)(E.getState(),this.getPageId(),this.dataContextToken,this.getName())&&Object(u.e)(E.getState(),Object(h.ac)(E.getState(),this.getPageId(),this.dataContextToken),this.getName());return o.a.instance.reportSuccess(e),t}catch(t){const n=S.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),S.a.getInstance().reportFailure(e,t,null,n),t}}getName(){return o.a.instance.reportUsage(w+"getName"),this._attributeName}getParent(){return o.a.instance.reportUsage(w+"getParent"),this._parentEntity}getRequiredLevel(){const e=w+"getRequiredLevel";try{o.a.instance.reportCall(e);const t=Object(h.pc)(E.getState(),this._pageId,this.dataContextToken,this.getName());let n;switch(t){case 2:case 1:n="required";break;case-1:case 0:n="none";break;case 3:n="recommended";break;default:Object(f.h)(e,"RequiredLevel",t)}return o.a.instance.reportSuccess(e),n}catch(t){const n=S.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),S.a.getInstance().reportFailure(e,t,null,n),t}}getSubmitMode(){const e=w+"getSubmitMode";try{o.a.instance.reportCall(e);const t=Object(h.zc)(E.getState(),this._pageId,this.contextToken,this.getName());let n;switch(t){case g.a.Dirty:n="dirty";break;case g.a.Always:n="always";break;case g.a.Never:n="never";break;default:Object(f.h)(e,"SubmitMode",t)}return o.a.instance.reportSuccess(e),n}catch(t){const n=S.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),S.a.getInstance().reportFailure(e,t,null,n),t}}getUserPrivilege(){const e=w+"getUserPrivilege";try{o.a.instance.reportCall(e);let t=null;if(E.getState()&&this._parentEntity&&this._attributeName){const e=Object(l.a)(E.getState(),this._parentEntity.getEntityName(),i.a.fromExternalGuid(this._parentEntity.getId()),this._attributeName);e&&(t={canCreate:e.canCreate,canRead:e.canRead,canUpdate:e.canUpdate})}return o.a.instance.reportSuccess(e),t}catch(t){const n=S.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),S.a.getInstance().reportFailure(e,t,null,n),t}}getValue(){const e=w+"getValue";try{o.a.instance.reportCall(e);const t=this.getValueInternal();let n=null;return Object(f.a)(t)||(Object(a.j)(t)?n=t.value:Object(f.k)(e,"isPlainValue","value")),o.a.instance.reportSuccess(e),n}catch(t){const n=S.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),S.a.getInstance().reportFailure(e,t,null,n),t}}removeOnChange(e){const t=w+"removeOnChange";e||Object(f.j)(t,"handler");try{o.a.instance.reportCall(t),E.dispatch(Object(y.v)(this.contextToken,this._pageId,this.getName(),e)),o.a.instance.reportSuccess(t)}catch(e){const n=S.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),S.a.getInstance().reportFailure(t,e,null,n),e}}setRequiredLevel(e){const t=w+"setRequiredLevel";e||Object(f.j)(t,"requiredLevel"),"none"!==e&&"recommended"!==e&&"required"!==e&&Object(f.h)(t,"RequiredLevel",e);try{let n;switch(o.a.instance.reportCall(t),e){case"none":n=0;break;case"recommended":n=3;break;case"required":n=2}E.dispatch(Object(d.b)(this._pageId,this.dataContextToken,this._attributeName,n)),o.a.instance.reportSuccess(t)}catch(e){const n=S.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),S.a.getInstance().reportFailure(t,e,null,n),e}}setSubmitMode(e){const t=w+"setSubmitMode";e||Object(f.j)(t,"mode"),"dirty"!==e&&"always"!==e&&"never"!==e&&Object(f.h)(t,"SubmitMode",e);try{let n;switch(o.a.instance.reportCall(t),e){case"dirty":n=g.a.Dirty;break;case"always":n=g.a.Always;break;case"never":n=g.a.Never}E.dispatch(Object(p.b)(this._pageId,this.contextToken,this.getName(),n)),o.a.instance.reportSuccess(t)}catch(e){const n=S.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),S.a.getInstance().reportFailure(t,e,null,n),e}}setValue(e){const t=w+"setValue";try{o.a.instance.reportCall(t),this.setValueInternal(e),o.a.instance.reportSuccess(t)}catch(e){const n=S.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),S.a.getInstance().reportFailure(t,e,null,n),e}}setIsValid(e,t){return this._clientApiExecutorAttribute.execute("setIsValid",(n,r)=>{e?(E.dispatch(Object(I.b)(this._pageId,this._attributeName,!0,this.contextToken)),E.dispatch(Object(j.b)(this.contextToken,this._pageId,Object(T.d)(this._pageId,this._attributeName))),E.dispatch(Object(_.b)(E.getState(),this._pageId,this._attributeName,null,this.contextToken))):this._addNotification(t)})}_addNotification(e){E.dispatch(Object(I.b)(this._pageId,this._attributeName,!1,this.contextToken));const t={messages:[e],notificationLevel:O.a.error};E.dispatch(Object(_.b)(E.getState(),this._pageId,this._attributeName,t,this.contextToken))}isValid(){const e=w+"isValid";try{o.a.instance.reportCall(e);const t=this.getValueInternal(),n=this.getParent();if(n){const r=Object(C.h)(E.getState(),n.getEntityName());if(r&&r.PrimaryIdAttribute!==this.getName()&&n.getId()!==i.a.EMPTYSTRING&&"required"===this.getRequiredLevel()&&Object(f.a)(t))return o.a.instance.reportSuccess(e),!1}let r=!0;return this.hasErrorNotification()?r=!1:t&&t.validationResult&&(r=t.validationResult.isValueValid),o.a.instance.reportSuccess(e),r}catch(t){const n=S.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),S.a.getInstance().reportFailure(e,t,null,n),t}}hasErrorNotification(){const e=Object(v.v)(this.contextToken),t=E.getState(),n=Object(P.a)(t,this._pageId);if(n.forms&&n.forms[e]&&(n.forms[e].invalidControls||n.forms[e].invalidAttributes)){return!0===n.forms[e].invalidControls[this.getName()]||!0===n.forms[e].invalidAttributes[this.getName()]}return!1}getPageId(){return this._pageId}getAttrDescriptor(){if(this.getParent()){let e=Object(h.r)(E.getState(),this.getParent().getEntityName(),this.getName(),this._pageId,this.contextToken);return e||(e=Object(c.a)(E.getState(),this.getParent().getEntityName(),this.getName())),e}return Object(h.Nc)(E.getState(),this.getPageId(),this.getName())}getDataXmlInternal(){let e="";return e=e+"<"+Object(F.CrmXmlEncode)(this.getName())+">"+Object(F.CrmXmlEncode)(this.getValue())+"</"+Object(F.CrmXmlEncode)(this.getName())+">",e}setValueInternal(e){const t=this.getName(),n={};n[t]={fieldName:t,value:e},E.dispatch(Object(b.a)(this._pageId,n,!1,!0,this.getParent()?this.getParent().getEntityName():null,this.getParent()?this.getParent().getId():null,Object(v.t)(this._contextToken),this.contextToken))}get parentEntityReference(){let e,t;return this.getParent()?(e=this.getParent().getEntityName(),t=this.getParent().getId()):this.contextToken.formId&&(e=this.contextToken.formId.guid),t?new s.a(e,new i.a(t)):new s.a(e)}getValueInternal(){const e=Object(h.ac)(E.getState(),this.getPageId(),this.dataContextToken);return Object(h.X)(E.getState(),this._pageId,this._contextToken,e,this.parentEntityReference,this._attributeName,E.dispatch)}get contextToken(){return Object(v.r)(this._contextToken)}get dataContextToken(){return this._contextToken}}var N=n("5Oca"),A=n("6QGX");class k extends x{getOption(e){const t="ClientApi.XrmEntityAttributeOptionSetBase.getOption";if(Object(f.a)(e))return null;const n="number"==typeof e?e:parseInt(e,10);isNaN(n)&&Object(f.k)(t,"number","value");try{o.a.instance.reportCall(t);const n=this.getAttrDescriptor().OptionSet;let r=null;for(let t=0;t<n.length;t++)n[t].Value===e&&(r={text:n[t].Label,value:n[t].Value});return o.a.instance.reportSuccess(t),r}catch(e){throw S.a.getInstance().getEventParameters(this.contextToken).push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(t,e),e}}getOptions(){const e="ClientApi.XrmEntityAttributeOptionSetBase.getOptions";try{o.a.instance.reportCall(e);const t=this.getAttrDescriptor().OptionSet.map(e=>({text:e.Label,value:e.Value}));return o.a.instance.reportSuccess(e),t}catch(t){throw S.a.getInstance().getEventParameters(this.contextToken).push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(e,t),t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let M,D;class R extends k{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),M=e}getInitialValue(){const e="ClientApi.XrmEntityAttributeBoolean.getInitialValue";try{o.a.instance.reportCall(e);const t=Object(N.j)(M.getState(),this.parentEntityReference,this.getName()),n=t?parseInt(t.valueString,10):null;return o.a.instance.reportSuccess(e),n}catch(t){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}getValue(){const e="ClientApi.XrmEntityAttributeBoolean.getValue";try{o.a.instance.reportCall(e);const t=this.getValueInternal(),n=Object(A.a)(t);return o.a.instance.reportSuccess(e),n}catch(t){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}setValue(e){const t="ClientApi.XrmEntityAttributeBoolean.setValue";Object(f.a)(e)||"boolean"!=typeof e&&Object(f.k)(t,"boolean","value");try{o.a.instance.reportCall(t),this.setValueInternal(e),o.a.instance.reportSuccess(t)}catch(e){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(t,e,null,n),e}}getAttributeType(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributeBoolean.getAttributeType"),"boolean"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class B extends k{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),D=e}getInitialValue(){const e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getInitialValue";try{o.a.instance.reportCall(e);const t=Object(N.j)(D.getState(),this.parentEntityReference,this.getName()),n=Object(A.e)(t);return o.a.instance.reportSuccess(e),n}catch(t){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}getSelectedOption(){const e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getSelectedOption";try{o.a.instance.reportCall(e);let t=null;const n=this.getValue();return n&&(t=[],n.forEach(e=>{const n=this.getOption(e);n&&t.push(n)})),o.a.instance.reportSuccess(e),t}catch(t){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}getText(){const e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getText";try{o.a.instance.reportCall(e);let t=null;const n=this.getSelectedOption();return n&&(t=[],n.forEach(e=>{t.push(e.text)})),o.a.instance.reportSuccess(e),t}catch(t){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}getValue(){const e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getValue";try{o.a.instance.reportCall(e);const t=this.getValueInternal();let n=null;return t&&(n=Object(A.e)(t)),o.a.instance.reportSuccess(e),n}catch(t){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}getAttributeType(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributeMultiSelectOptionSet.getAttributeType"),"multiselectoptionset"}setValue(e){const t="ClientApi.XrmEntityAttributeMultiSelectOptionSet.setValue";try{o.a.instance.reportCall(t),Array.isArray(e)?this.setValueInternal(e):this.setValueInternal([]),o.a.instance.reportSuccess(t)}catch(e){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(t,e,null,n),e}}}var L=n("Xd5/"),V=n("xkcG"),z=n("MXaZ"),H=n("Ae6N");let G;class W extends x{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),G=e}getDataXmlInternal(){let e=this.getValue();null!==e&&(e=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes()));const t=Object(F.CrmXmlEncode)(this.getName());let n="";return n+=`<${t}>`,n+=""+(null===e?"":Object(F.CrmXmlEncode)(e.format("s"))),n+=`</${t}>`,n}getValue(){const e="ClientApi.XrmEntityAttributeDateTime.getValue";try{o.a.instance.reportCall(e);const t=this.getValueInternal();let n=null;if(Object(a.j)(t)&&!Object(f.a)(t.formatted)){const e=this.getAttrDescriptor();n=Object(A.b)(G.getState(),e,t)}return o.a.instance.reportSuccess(e),n}catch(t){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}_userSettings(){return this.xrmFormUi.formContext.context?this.xrmFormUi.formContext.context.userSettings:new V.a(G)}getUtcValue(){const e="ClientApi.XrmEntityAttributeDateTime.getUtcValue";try{o.a.instance.reportCall(e);const t=this.getValue();return o.a.instance.reportSuccess(e),t}catch(t){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}setValue(e){const t="ClientApi.XrmEntityAttributeDateTime.setValue";Object(f.a)(e)||"[object Date]"!==Object.prototype.toString.call(e)&&Object(f.k)(t,"Date","value");try{if(o.a.instance.reportCall(t),Object(f.a)(e))this.setValueInternal(e);else if("[object Date]"===Object.prototype.toString.call(e)){const t=new Date,n=this.getAttrDescriptor(),r=Object(L.z)(G.getState(),n),i=6e4*this._userSettings().getTimeZoneOffsetMinutes(),a=Object(z.o)(new Date(t.getFullYear(),t.getMonth(),t.getDate()),r.userSettings.timeZoneAdjusters)-Object(z.o)(e,r.userSettings.timeZoneAdjusters),s=6e4*e.getTimezoneOffset();let o=null;switch(r.controlAttributes.Behavior){case H.a.UserLocal:o=new Date(e.getTime()+s+i-a);break;default:o=new Date(e.getTime())}this.setValueInternal(o)}o.a.instance.reportSuccess(t)}catch(e){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(t,e,null,n),e}}setUtcValue(e){const t="ClientApi.XrmEntityAttributeDateTime.setUtcValue";try{o.a.instance.reportCall(t),this.setValue(e),o.a.instance.reportSuccess(t)}catch(e){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(t,e,null,n),e}}getAttributeType(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributeDateTime.getAttributeType"),"datetime"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let U;class q extends x{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),U=e}getIsPartyList(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributeLookup.getIsPartyList"),!1}getDataXmlInternal(){const e=this.getValue();let t="";if(null!==e&&e.length>0)t+=this.getLookupDataXml(this.getName(),e[0]);else{const e=Object(F.CrmXmlEncode)(this.getName());t+=`<${e}>`,t+=`</${e}>`}return t.toString()}getLookupDataXml(e,t){const n=Object(F.CrmXmlEncode)(e);let r="<"+n;const i=this.getEntityTypeCode(t.entityType);return i>0&&(r+=` type="${Object(F.CrmXmlAttributeEncode)(i.toString())}"`),t.entityType&&(r+=` typeName="${Object(F.CrmXmlAttributeEncode)(t.entityType)}"`),Object(f.a)(t.name)||(r+=` name="${Object(F.CrmXmlAttributeEncode)(t.name)}"`),r+=`>${Object(F.CrmXmlEncode)(t.id)}</${n}>`,r}getEntityTypeCode(e){return Object(C.p)(U.getState(),e)}setValue(e){const t="ClientApi.XrmEntityAttributeLookup.setValue";let n=null;if(e&&Array.isArray(e)&&e.length>0){let r;e.length>1?Object(f.k)(t,"LookupValue[] of size not more than one.","value"):e[0].entityType?e[0].id?i.a.tryParseOrNull(e[0].id)||Object(f.h)(t,"guid",e[0].id):Object(f.j)(t,"value[0].id"):Object(f.j)(t,"value[0].entityType");try{r=Object(h.Ob)(U.getState(),this.getPageId(),this.dataContextToken,this.getName())}catch(e){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(t+".getLookupTargets",e,null,n),e}if(r&&!(r.indexOf(e[0].entityType)>-1)){const n=S.a.getInstance().getEventParameters(this.contextToken);n.push({name:"attributeName",value:this.getName()}),n.push({name:"actualValue",value:e[0].entityType}),Object(f.k)(t,"entityType","value[0].entityType",n)}try{o.a.instance.reportCall(t),r?r.indexOf(e[0].entityType)>-1&&(n=new s.a(e[0].entityType,new i.a(e[0].id),e[0].name),this.setValueInternal(n)):this.setValueInternal(n),o.a.instance.reportSuccess(t)}catch(e){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(t,e,null,n),e}}else this.setValueInternal(n)}getValue(){const e="ClientApi.XrmEntityAttributeLookup.getValue";try{o.a.instance.reportCall(e);const t=this.getValueInternal(),n=Object(A.d)(t);return o.a.instance.reportSuccess(e),n}catch(t){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}getAttributeType(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributeLookup.getAttributeType"),"lookup"}}var X=n("3c9R"),Y=n("IaGr");let K;class Q extends x{constructor(e,t,n,i,a,s){super(e,t,n,i,a,s),K=e,this._clientApiExecutorAttributeNumber=new r.a(e,"ClientApi.XrmEntityAttributeNumber.",n,t,[{name:"attributeName",value:i,isEventParam:!0}])}getMax(){return this._clientApiExecutorAttributeNumber.execute("getMax",()=>this.getAttrDescriptor().MaxValue)}getMin(){return this._clientApiExecutorAttributeNumber.execute("getMin",()=>this.getAttrDescriptor().MinValue)}getPrecision(){return this._clientApiExecutorAttributeNumber.execute("getPrecision",()=>Object(h.k)(K.getState(),this.getPageId(),this.dataContextToken,this.getName()))}setPrecision(e){return this._clientApiExecutorAttributeNumber.execute("setPrecision",(t,n)=>{"integer"===this.getAttributeType()&&Object(f.e)(t,"setPrecision is not valid on integer attributes",void 0,n);const r=Object(c.a)(K.getState(),this.getParent().getEntityName(),this.getName());(e<0||e>r.Precision)&&(n.push({name:"metadataPrecision",value:r.Precision}),Object(f.h)(t,"precision",e.toString(),n)),K.dispatch(Object(X.b)(this.getPageId(),this.dataContextToken,this.getName(),e))},[{name:"precision",value:e,isRequired:!0,expectedDataType:"number"}])}getValue(){return this._clientApiExecutorAttributeNumber.execute("getValue",()=>{const e=this.getValueInternal();return Object(A.f)(e,this.getAttributeType(),this.getPrecision())})}setValue(e){return this._clientApiExecutorAttributeNumber.execute("setValue",()=>{this.setValueInternal(e)},[{name:"value",value:e,expectedDataType:"number"}])}getAttributeType(){return this._clientApiExecutorAttributeNumber.execute("getAttributeType",(e,t)=>{const n=this.getAttrDescriptor().Type;switch(n){case"decimal":return"decimal";case"double":return"double";case"integer":return"integer";case"money":return"money";default:return t.push({name:"attributeType",value:n}),n?this._clientApiExecutorAttributeNumber.reportFailure(e,new Error("Unexpected number attribute type."),t):Y.a.getInstance().traceManager.getTracer(e).error("Number attribute type was not defined in metadata.",t),super.getAttributeType()}})}}var Z=n("arV0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let J;class $ extends k{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),J=e}getInitialValue(){const e="ClientApi.XrmEntityAttributeOptionSet.getInitialValue";try{o.a.instance.reportCall(e);const t=Object(N.j)(J.getState(),this.parentEntityReference,this.getName());let n;if(Object(Z.m)(J.getState(),this.getPageId())){const e=this.getAttrDescriptor();n=Object(A.g)(t)||e&&e.DefaultFormValue?e.DefaultFormValue:null}else n=Object(A.g)(t);return o.a.instance.reportSuccess(e),n}catch(t){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}getSelectedOption(){const e="ClientApi.XrmEntityAttributeOptionSet.getSelectedOption";try{o.a.instance.reportCall(e);const t=this.getOption(this.getValue());return o.a.instance.reportSuccess(e),t}catch(t){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}getText(){const e="ClientApi.XrmEntityAttributeOptionSet.getText";try{o.a.instance.reportCall(e);const t=this.getSelectedOption();let n=null;return t&&(n=t.text),o.a.instance.reportSuccess(e),n}catch(t){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}getValue(){const e="ClientApi.XrmEntityAttributeOptionSet.getValue";try{o.a.instance.reportCall(e);const t=this.getValueInternal(),n=Object(A.g)(t),r=Object(f.a)(n)?Object(A.f)(t,this.getAttributeType(),0):n;return o.a.instance.reportSuccess(e),r}catch(t){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}setValue(e){const t="ClientApi.XrmEntityAttributeOptionSet.setValue";e&&isNaN(e)&&Object(f.k)(t,"number","value");let n=!1;try{if(e&&this.getParent()){const t=this.getAttrDescriptor();for(const r in t.OptionSet)if(e===t.OptionSet[r].Value){n=!0;break}}else n=!0}catch(e){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(t+".getAttributeDescriptor",e,null,n),e}n||Object(f.h)(t,"OptionSetValue",e);try{o.a.instance.reportCall(t),this.setValueInternal(e),o.a.instance.reportSuccess(t)}catch(e){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(t,e,null,n),e}}getAttributeType(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributeOptionSet.getAttributeType"),"optionset"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ee extends x{getMaxLength(){const e="ClientApi.XrmEntityAttributeString.getMaxLength";try{o.a.instance.reportCall(e);const t=this.getAttrDescriptor().MaxLength;return o.a.instance.reportSuccess(e),t}catch(t){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}getValue(){const e="ClientApi.XrmEntityAttributeString.getValue";try{o.a.instance.reportCall(e);const t=this.getValueInternal(),n=Object(A.i)(t);return o.a.instance.reportSuccess(e),n}catch(t){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}setValue(e){const t="ClientApi.XrmEntityAttributeString.setValue";Object(f.a)(e)||"string"!=typeof e&&Object(f.k)(t,"string","value");try{o.a.instance.reportCall(t),this.setValueInternal(e),o.a.instance.reportSuccess(t)}catch(e){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(t,e,null,n),e}}getAttributeType(){const e="ClientApi.XrmEntityAttributeString.getAttributeType";try{let t;o.a.instance.reportCall(e);const n=this.getAttrDescriptor().Type;switch(n){case"memo":t="memo";break;case"string":t="string";break;default:const r=S.a.getInstance().getEventParameters(this.contextToken);r.push({name:"attributeName",value:this.getName()}),r.push({name:"attributeType",value:n}),S.a.getInstance().reportFailure(e,new Error("Unexpected string attribute type."),null,r),t=super.getAttributeType()}return o.a.instance.reportSuccess(e),t}catch(t){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class te extends x{constructor(e,t,n,i,a,s){super(e,t,n,i,a,s),this._clientApiExecutor=new r.a(e,"ClientApi.XrmEntityAttributeUniqueIdentifier.",n,t),this._clientApiExecutor.addEventParameter({name:"attributeName",value:i,isEventParam:!0})}setValue(e){this._clientApiExecutor.execute("setValue",()=>{this.setValueInternal(i.a.tryParseOrNull(e))},[{name:"value",value:e,expectedDataType:"guid"}])}getValue(){return this._clientApiExecutor.execute("getValue",()=>{const e=this.getValueInternal();return Object(A.j)(e)})}getAttributeType(){return this._clientApiExecutor.execute("getAttributeType",()=>"string")}}var ne=n("nVTU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let re;class ie extends q{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),re=e}getDataXmlInternal(){const e=Object(F.CrmXmlEncode)(this.getName()),t=this.getValue();let n="";return n+=`<${e}>`,t.forEach(e=>{n+="<activityparty>",n+=this.getLookupDataXml("partyid",e),n+="</activityparty>"}),n+=`</${e}>`,n.toString()}setValue(e){const t="ClientApi.XrmEntityAttributePartyList.setValue",n=S.a.getInstance().getEventParameters(this.contextToken);let r;n.push({name:"attributeName",value:this.getName()}),e&&(Array.isArray(e)||Object(f.k)(t,"LookupValue[]","value",n));const i=new Array;try{r=Object(h.Ob)(re.getState(),this.getPageId(),this.dataContextToken,this.getName())}catch(e){throw S.a.getInstance().reportFailure(t+".getLookupTargets",e,null,n),e}e&&r&&(r.push("unresolvedaddress"),e.forEach(e=>{r.indexOf(e.entityType)>-1||(n.push({name:"entityType",value:e.entityType}),Object(f.e)(t,`LookupValue[] with invalid entity type. Entity type "${e.entityType}" is invalid.`,"LookupValue[] with invalid entity type",n))}));try{o.a.instance.reportCall(t),e?(r?e.forEach(e=>{r.indexOf(e.entityType)>-1&&i.push(new ne.a(e.entityType,e.id,e.name))}):e.forEach(e=>{i.push(new ne.a(e.entityType,e.id,e.name))}),this.setValueInternal(i)):this.setValueInternal([]),o.a.instance.reportSuccess(t)}catch(e){throw S.a.getInstance().reportFailure(t,e,null,n),e}}getValue(){const e="ClientApi.XrmEntityAttributePartyList.getValue";try{o.a.instance.reportCall(e);const t=this.getValueInternal(),n=Object(A.h)(t);return o.a.instance.reportSuccess(e),n}catch(t){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}getIsPartyList(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributePartyList.getIsPartyList"),!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ae extends x{constructor(e,t,n,i,a,s){super(e,t,n,i,a,s),this._clientApiExecutorAttributeFile=new r.a(e,"ClientApi.XrmEntityFile.",n,t,[{name:"attributeName",value:i,isEventParam:!0}])}getValue(){return this._clientApiExecutorAttributeFile.execute("getValue",()=>{const e=this.getValueInternal();return Object(A.c)(e)})}setValue(e){this._clientApiExecutorAttributeFile.execute("setValue",()=>{this.setValueInternal(e)})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let se;class oe extends x{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),se=e}getValue(){const e="ClientApi.XrmEntityAttributeEntityName.getValue";try{o.a.instance.reportCall(e);const t=this.getValueInternal(),n=Object(c.a)(se.getState(),this.getParent().getEntityName(),this.getName());let r=null;return n.IsEntityReferenceStored&&Object(a.j)(t)&&(r=t.value),o.a.instance.reportSuccess(e),r}catch(t){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}setValue(e){const t="ClientApi.XrmEntityAttributeEntityName.setvalue";Object(f.a)(e)||"string"==typeof e||Object(f.k)(t,"string","value");try{o.a.instance.reportCall(t),this.setValueInternal(e),o.a.instance.reportSuccess(t)}catch(e){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(t,e,null,n),e}}getAttributeType(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributeEntityName.getAttributeType"),"entityname"}}var ce=n("aOhN"),le=n("Pcet"),ue=n("WY/A"),de=n("qTme"),pe=n("Dea/"),he=n("NPZ3"),ge=n("bGh0"),me=n("srnJ"),be=n("Fij2"),ye=n("pF61"),fe=n("ruPX"),Se=n("cfbi"),ve=n("P6DH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Ce(e,t,n,r){const i=Object(h.z)(e,t,n,r,n.relationshipName);if(!i||0===i.length)return!0;for(let r=0;r<i.length;r++)if(!Object(h.t)(e,{controlName:i[r],id:t},n))return!0;return!1}function Oe(e,t,n,r,i,a){if(!Object(ve.K)(e,t,n,r,null==a?void 0:a.id))return!1;const s=Object(ve.y)(e,n,t);if(!i||!s)return!1;if(s&&0===s[r])return!1;if(null===i.ParentPicklistLogicalName)return!0;const o=Object(h.ac)(e,t,n),c=Object(h.X)(e,t,n,o,a,i.ParentPicklistLogicalName);return!(!c||!c.label)}var _e=n("jRy5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let Ie;class je extends ${constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),Ie=e}setValue(e){const t="ClientApi.XrmEntityAttributeDependentOptionSet.setValue";let n;try{o.a.instance.reportCall(t),n=this.contextToken.contextTokenType===_e.a.MainGrid||this.contextToken.contextTokenType===_e.a.SubGrid||this.contextToken.contextTokenType===_e.a.AssociatedGrid?Oe(Ie.getState(),this.getPageId(),this.contextToken,this.getName(),this.getAttrDescriptor(),this.parentEntityReference):Ce(Ie.getState(),this.getPageId(),this.contextToken,this.getName()),o.a.instance.reportSuccess(t)}catch(e){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(t,e,null,n),e}n?super.setValue(e):Object(f.e)("ClientApi.XrmEntityAttributeDependentOptionSet.setValue","Can not execute setValue for dependent option set attribute since it is disabled.")}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let Pe;class Fe extends B{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),Pe=e}setValue(e){const t="ClientApi.XrmEntityAttributeMultiSelectDependentOptionSet.setValue";let n;try{o.a.instance.reportCall(t),n=this.contextToken.contextTokenType===_e.a.MainGrid||this.contextToken.contextTokenType===_e.a.SubGrid||this.contextToken.contextTokenType===_e.a.AssociatedGrid?Oe(Pe.getState(),this.getPageId(),this.contextToken,this.getName(),this.getAttrDescriptor(),this.parentEntityReference):Ce(Pe.getState(),this.getPageId(),this.contextToken,this.getName()),o.a.instance.reportSuccess(t)}catch(e){const n=S.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),S.a.getInstance().reportFailure(t,e,null,n),e}n?super.setValue(e):Object(f.e)(t,"Can not execute setValue for dependent option set attribute since it is disabled.")}}var Te=n("3/02"),we=n("Lyxw"),Ee=n("QHx/"),xe=n("L8zx"),Ne=n("Exmh");let Ae;class ke{constructor(e,t,n,i,a,s,o,c){Ae=e;const l=[{name:"pageId",value:n,isEventParam:!0,isRequired:!0,expectedDataType:"string"},{name:"entityType",value:a,isEventParam:!0,isRequired:!1,expectedDataType:"string"},{name:"store",value:e,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"xrmForm",value:i,isRequired:!0}];this._clientApiExecutor=new r.a(e,"ClientApi.XrmEntity.",n,t,l),this._pageId=n,this._xrmForm=i,this._contextToken=t,this._entityType=a,this._entityId=s,this._getAttributeNames=o,this._applicationContext=c}get attributes(){return this._clientApiExecutor.execute("attributes",(e,t)=>{if(!this._attributes){this._attributes=new m.a(e);const n=this._getAttributeNames(this._applicationContext,this._contextToken,this._pageId);if(!n)return this._clientApiExecutor.reportFailure(e,new Error("Entity attribute names array was null or undefined"),t),this._attributes;0===n.length&&this._clientApiExecutor.reportFailure(e,new Error("Entity attribute names array was empty."),t),n.forEach(e=>{const t=Object(c.a)(Ae.getState(),this.getEntityName(),e);if(t){const n=Me(Ae,this._contextToken,this._pageId,e,this,this._xrmForm.ui,t);this._attributes.add(e,n)}})}return this._attributes})}get relatedEntities(){const e="ClientApi.XrmEntity.relatedEntities";try{if(o.a.instance.reportCall(e),!this._relatedEntities){this._relatedEntities=new m.a(e);const t=Object(h.oc)(Ae.getState(),{id:this._pageId},this._contextToken);for(const e in t)if(t[e]){const n=Object(v.m)(this._contextToken,e),r=new ke(Ae,n,this._pageId,this._xrmForm,t[e].etn,t[e].id,this._getAttributeNames,this._applicationContext);this._relatedEntities.add(e,r),this._updateControl(r,e)}const n=Object(h.nc)(Ae.getState(),{id:this._pageId}),r={};for(const e in n){const t=n[e];r[t.referencingAttribute]||(r[t.referencingAttribute]={}),r[t.referencingAttribute][t.referencedEntity]=e}for(const e in r)Ae.dispatch(Object(y.a)(this._contextToken,this._pageId,e,t=>{for(const t in r[e]){const n=this._relatedEntities.get(r[e][t]);n&&this._relatedEntities.remove(n)}const n=t.getEventSource().getValue();if(n&&n.length>0){const t=n[0],a=r[e][t.entityType],s=Object(v.m)(this._contextToken,a),o=new ke(Ae,s,this._pageId,this._xrmForm,t.entityType,i.a.tryParse(t.id),this._getAttributeNames,this._applicationContext);this._relatedEntities.add(a,o),this._updateControl(o,a)}},!0))}return o.a.instance.reportSuccess(e),this._relatedEntities}catch(t){const n=S.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}_updateControl(e,t){this._xrmForm&&this._xrmForm.ui&&this._xrmForm.ui.controls&&this._xrmForm.ui.controls.forEach(n=>{n instanceof ge.a&&n.updateAttribute(e,t)})}addOnSave(e){const t="ClientApi.XrmEntity.addOnSave";e||Object(f.j)(t,"handler");try{o.a.instance.reportCall(t),Ae.dispatch(Object(y.o)(this._contextToken,this._pageId,e)),o.a.instance.reportSuccess(t)}catch(e){const n=S.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),S.a.getInstance().reportFailure(t,e,null,n),e}}getDataXml(){const e="ClientApi.XrmEntity.getDataXml";try{o.a.instance.reportCall(e);let t="";return this.attributes.forEach(e=>{e.getIsDirty()&&(t+=e.getDataXmlInternal())}),t="<"+Object(F.CrmXmlEncode)(this.getEntityName())+">"+t+"</"+Object(F.CrmXmlEncode)(this.getEntityName())+">",o.a.instance.reportSuccess(e),t}catch(t){const n=S.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}getEntityReference(){const e="ClientApi.XrmEntity.getEntityReference";try{o.a.instance.reportCall(e);const t={entityType:this.getEntityName(),id:this.getId(),name:this.getPrimaryAttributeValue()};return o.a.instance.reportSuccess(e),t}catch(t){const n=S.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}getEntityName(){const e="ClientApi.XrmEntity.getEntityName";try{return o.a.instance.reportCall(e),o.a.instance.reportSuccess(e),this._entityType}catch(t){const n=S.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}getId(){const e="ClientApi.XrmEntity.getId";try{if(o.a.instance.reportCall(e),!this._entityId||this._entityId&&this._entityId.guid===i.a.EMPTYGUIDSTRING){const e=Object(Z.i)(Ae.getState(),this._pageId);if(e&&e.value){const t=e.value;this._entityId=t.id}else{const e=Object(h.ac)(Ae.getState(),this._pageId,this._contextToken);if(e){const t=Object(u.b)(Ae.getState(),e);t&&t.identifier&&(this._entityId=t.identifier.id)}}}return this._entityId&&this._entityId.guid===i.a.EMPTYGUIDSTRING?(o.a.instance.reportSuccess(e),i.a.EMPTYSTRING):(o.a.instance.reportSuccess(e),i.a.externalGuid(this._entityId))}catch(t){const n=S.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}getPrimaryAttributeValue(){return this._clientApiExecutor.execute("getPrimaryAttributeValue",(e,t)=>{let n="";const r=Object(C.h)(Ae.getState(),this.getEntityName());if(r){if(!r.PrimaryNameAttribute)return n="PrimaryNameAttribute was not defined",Y.a.getInstance().traceManager.getTracer(e).error(n,t),"";{const e=Object(h.ac)(Ae.getState(),this._pageId,this._contextToken),t=this.getId()?new s.a(this.getEntityName(),new i.a(this.getId())):new s.a(this.getEntityName()),o=Object(h.X)(Ae.getState(),this._pageId,this._contextToken,e,t,r.PrimaryNameAttribute);if(!o)return"";if(Object(a.j)(o))return o.value;n="PrimaryAttribute value was not an IPlainValue"}}else n="Entity descriptor could not be retrieved.";return S.a.getInstance().reportFailure(e,new Error(n),null,t),""})}getIsDirty(){const e="ClientApi.XrmEntity.getIsDirty";try{o.a.instance.reportCall(e);for(let t=0;t<this.attributes.getLength();t++){const n=this.attributes.get(t);if("never"!==n.getSubmitMode()&&n.getIsDirty())return o.a.instance.reportSuccess(e),!0}for(let t=0;t<this.relatedEntities.getLength();t++){if(this.relatedEntities.get(t).getIsDirty())return o.a.instance.reportSuccess(e),!0}return o.a.instance.reportSuccess(e),!1}catch(t){const n=S.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}removeOnSave(e){const t="ClientApi.XrmEntity.removeOnSave";e||Object(f.j)(t,"handler");try{o.a.instance.reportCall(t),Ae.dispatch(Object(y.J)(this._contextToken,this._pageId,e)),o.a.instance.reportSuccess(t)}catch(e){const n=S.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),S.a.getInstance().reportFailure(t,e,null,n),e}}save(e){this._clientApiExecutor.executeAsync("save",(t,n)=>{let r=1;if(e)if("string"==typeof e)switch(e){case"save":r=1;break;case"saveandclose":r=2;break;case"saveandnew":r=59}else e.saveMode&&(r=e.saveMode);const i=Ae.getState();return Object(xe.b)(this._pageId,Ae,r,n,this._contextToken,this,!1,"saveandclose"!==e).then(t=>this._performAfterSaveLogic(i,t,e))})}isValid(){const e="ClientApi.XrmEntity.isValid";try{if(o.a.instance.reportCall(e),this.attributes)for(let t=0;t<this.attributes.getLength();t++){const n=this.attributes.get(t);if(this._attributeHasActiveControl(n)&&!n.isValid()||n.hasErrorNotification())return o.a.instance.reportSuccess(e),!1}if(this.relatedEntities)for(let t=0;t<this.relatedEntities.getLength();t++)if(!this.relatedEntities.get(t).isValid())return o.a.instance.reportSuccess(e),!1;return o.a.instance.reportSuccess(e),!0}catch(t){const n=S.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),S.a.getInstance().reportFailure(e,t,null,n),t}}setRecordId(e){const t="ClientApi.XrmEntity.setRecordId";e||Object(f.j)(t,"id");try{if(o.a.instance.reportCall(t),this.getId()&&this._entityId.guid!==i.a.EMPTYGUIDSTRING)o.a.instance.reportSuccess(t);else{const n=i.a.tryParse(e);i.a.isNullOrEmpty(n)&&Object(f.j)(t,"id");const r={},a=Ae.getState(),c=Object(h.ac)(a,this._pageId,this._contextToken),l=Object(v.x)(this._contextToken);if(c){const e=new s.a(this.getEntityName(),n);Ae.dispatch(Object(le.b)(c,e)),o.a.instance.reportSuccess(t)}else{const e=Object(ue.b)(a,new s.a(this.getEntityName(),n),r,l,pe.a.Create),i=e.payload.snapshotId;Ae.dispatch(e),Ae.dispatch(Object(de.b)(this._pageId,i,this._contextToken)).then(()=>{o.a.instance.reportSuccess(t)}).catch(e=>{const n=S.a.getInstance().getEventParameters(this._contextToken);n.push({name:"entityName",value:this.getEntityName()}),S.a.getInstance().reportFailure(t+".setDataSnapshotId",e,null,n)})}}}catch(e){const n=S.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),S.a.getInstance().reportFailure(t,e,null,n),e}}refresh(){const e="ClientApi.XrmEntity.refresh";try{if(o.a.instance.reportCall(e),this.getId()){const t=new s.a(this.getEntityName(),new i.a(this.getId())),n=[],r=[];for(let e=0;e<this.attributes.getLength();e++)r.push(this.attributes.get(e).getName());const a=Object(he.a)(Ae.getState(),t.etn);if(a&&r.push(...a),n.push(Ae.dispatch(Object(me.a)(this._pageId,t,r,new Ne.a(s.a.toLegacyEntityReference(t),null,null)))),this.relatedEntities)for(let e=0;e<this.relatedEntities.getLength();e++)n.push(this.relatedEntities.get(e).refresh());return Promise.all(n).then(()=>{Object(be.b)(this),o.a.instance.reportSuccess(e)}).catch(t=>{const n=S.a.getInstance().getEventParameters(this._contextToken);return n.push({name:"entityName",value:this.getEntityName()}),Object(f.d)(Ae,t,e,n)})}return o.a.instance.reportSuccess(e),Promise.resolve(null)}catch(t){const n=S.a.getInstance().getEventParameters(this._contextToken);return n.push({name:"entityName",value:this.getEntityName()}),Object(f.d)(Ae,t,e,n)}}_attributeHasActiveControl(e){if(e&&e.controls){const t=e.controls.getLength();for(let n=0;n<t;n++)if(!e.controls.get(n).getDisabled())return!0}return!1}_performAfterSaveLogic(e,t,n){const r=Object(h.kb)(Ae.getState(),{id:this._pageId},this._contextToken);if(t||!this.getIsDirty()||r)if(Object(be.b)(this),"saveandclose"===n){if(!Object(be.a)(Object(ye.b)(Ae.getState())===this._pageId)){const t=Object(h.Kb)(e,this._pageId),n=Object(h.Ib)(e,this._pageId);if(!t&&!n){const e=Object(Ee.a)(Ae.getState(),this._pageId);return Ae.dispatch(Object(ce.b)(e))}}}else if("saveandnew"===n){const e={entityTypeName:this.getEntityName()};return Ae.dispatch(Object(fe.a)(Se.a,e,this._pageId))}return Promise.resolve()}}function Me(e,t,n,r,i,a,s){let o=null,l=!1;switch(s.Type){case"datetime":o=new W(e,t,n,r,i,a);break;case"decimal":case"double":case"integer":case"money":o=new Q(e,t,n,r,i,a);break;case"lookup":case"owner":case"customer":o=new q(e,t,n,r,i,a);break;case"partylist":o=new ie(e,t,n,r,i,a);break;case"memo":case"string":o=new ee(e,t,n,r,i,a);break;case"picklist":if(l=Object(we.c)(e.getState(),Te.L),l&&Object(c.l)(e.getState(),s.EntityLogicalName,r)){o=new je(e,t,n,r,i,a);break}case"optionset":case"state":case"status":o=new $(e,t,n,r,i,a);break;case"boolean":o=new R(e,t,n,r,i,a);break;case"entityname":o=new oe(e,t,n,r,i,a);break;case"uniqueidentifier":o=new te(e,t,n,r,i,a);break;case"multiselectpicklist":l=Object(we.c)(e.getState(),Te.L),o=l&&Object(c.l)(e.getState(),s.EntityLogicalName,r)?new Fe(e,t,n,r,i,a):new B(e,t,n,r,i,a);break;case"file":o=new ae(e,t,n,r,i,a);break;default:o=new x(e,t,n,r,i,a)}return o}},Utin:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return a}));var r=n("dHD5"),i=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="control.update.parameter";function s(e,t,n,s,o){return{type:"control.update.parameter.async",execute({dispatch:c,getState:l},u){const d=i.x+".updateControlParameterAction";c(function(e,t,n,s,o){const c=Object(r.v)(o);return{type:a,payload:{name:n,value:s},meta:{pageId:e,dataSetContextKey:c,controlName:i.o}}}(e,0,n,s,o));const p=[];return p.push({name:"controlName",value:t}),p.push({name:"paramName",value:""+n}),u.EventManager.ReportComponentSuccess(d,p),Promise.resolve()}}}},VpHT:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("NjDY"),i=n("99zj"),a=n("V6aM"),s=n("3mEc"),o=n("69Qu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c=["JQUERY","JQUERY.JS"];let l,u,d;function p(e){return{type:"customcontrol.loadresources",execute({dispatch:t,getState:n},p){const h=[],g=n(),m=Object(r.t)(g),b=e.Properties.Resources.filter((e,t,n)=>(0===e.Type||4===e.Type||1===e.Type)&&!(e.LibraryName&&-1!==c.indexOf(e.LibraryName.toUpperCase())||p.AssetLoader.isResourceLoaded(m+e.Name))).sort((e,t)=>e.LoadOrder-t.LoadOrder),y=e.Properties.Resources.filter((e,t,n)=>5===e.Type);if(b.length>0){let e;const n=()=>function(e,t,n,r,i){const s=[];for(let o=0;o<i.length;o++){const c=i[o];let u,d=c.Name,p=n;if(l&&l[c.Name])p=window.__public_path__+"control",d=l[c.Name];else if(0===c.Type){const e=c.LibraryName+".js";l&&l[e]&&(p=window.__public_path__+"control",d=l[e])}switch(c.Type){case 0:case 4:u=r.loadWebResource(d,p,3,t=>e(Object(a.a)(t)),t,!1);break;case 1:u=u=r.loadWebResource(d,p,2,t=>e(Object(a.a)(t)),t);break;default:u=null}u&&s.push(u)}return Promise.all(s)}(t,!Object(o.b)(g),m,p.AssetLoader,b);e=!function(){null==d&&(d=window.location.search.toLocaleLowerCase().indexOf("uselocal=true")>=0);return d}()||l?n():function(){if(u)return u;if("/uclient/"!==window.__public_path__){if(!l){const e=window.__public_path__+"controlFileMap.json";u=-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0?new Promise(t=>{const n=new XMLHttpRequest;n.addEventListener("load",(function(){let e={};try{e=JSON.parse(this.responseText)}catch(e){}t(e)})),n.addEventListener("error",()=>{t({})}),n.open("GET",e),n.send()}):fetch(e).then(e=>e.json(),()=>Promise.resolve({})),u.then(e=>{l=e},()=>{l={}})}}else l={},u=Promise.resolve({});return u}().then(n,n),e&&h.push(e)}const f=Object(s.k)(g);for(let e=0;e<y.length;e++)if(!f||!f.hasOwnProperty(y[e].Name)){const n=t(Object(i.c)(y[e].Name)).then(n=>{let r=!1;for(const t of n)t&&t.webResourceDescriptorsByName&&t.webResourceDescriptorsByName.hasOwnProperty(y[e].Name)&&(r=!0);!r&&t(Object(i.b)(y[e].Name))});h.push(n)}return h.length>0?Promise.all(h):null},sync:!0}}},WA3M:function(e,t,n){"use strict";n.d(t,"a",(function(){return V}));var r=n("Yx7Y"),i=n("SAYH"),a=n("eXjw"),s=n("arV0"),o=n("69Qu"),c=n("FZDd"),l=n("iZ7K"),u=n("3hnk"),d=n("nmJf"),p=n("odYE"),h=n("Lohl"),g=n("BJ7u"),m=n("a72m"),b=n("BFlg"),y=n("d0w6"),f=n("nIfK"),S=n("HfZT"),v=n("6Qf/"),C=n("P6DH"),O=n("jAuy"),_=n("dQnL"),I=n("d0Pd"),j=n("3/02"),P=n("Lyxw"),F=n("ANW1"),T=n("fSnw"),w=n("CngE"),E=n("ngeo"),x=n("S2mk"),N=n("5R5s"),A=n("G4xW"),k=n("85o3"),M=n("IqkD"),D=n("pEXn"),R=n("Uv1Y");var B=n("vNXc"),L=n("fYtF");function V(e,t,n,V,H,G,W,U,q=(()=>7),X,Y,K=!0,Q=!1){const Z=[],J=[],$=function(e,t,n,A,V,H,G,W,U,q=!0,X=!1){const Y=Object(s.l)(e(),A),K={},Q=function(e,t,n){const r=[],a=[],s={},o={};return(c,l,u)=>{const d=[],p=l.controlParameters,h=i.a.tryParseOrNull(l.viewId)?i.a.tryParseOrNull(l.viewId):i.a.tryParseOrNull(p.ViewId),g=i.a.toString(h),b=i.a.tryParseOrNull(p.VisualizationId),f=i.a.toString(b);if("true"===p.EnableChartPicker&&-1===r.indexOf(l.entityLogicalName)){r.push(l.entityLogicalName);const e=c(Object(_.a)(l.entityLogicalName,l.chartType)),i=[{name:"TargetEntityType",value:l.entityLogicalName}];t.info(n+" page, chart control, retrieve chart dispatched",i),d.push(e)}if(Object(P.c)(e(),j.B)&&"true"===p.EnableViewPicker&&-1===a.indexOf(l.entityLogicalName)){a.push(l.entityLogicalName);const e=c(Object(m.a)(l.entityLogicalName,y.a.MAIN_APPLICATION_VIEW,void 0,void 0,!0)),r=[{name:"TargetEntityType",value:l.entityLogicalName}];t.info(n+" page, chart control, retrieve view dispatched",r),d.push(e)}return f&&(s[f]||(s[f]=c(Object(_.a)(l.entityLogicalName,l.chartType,b)).catch(e=>{const r=e&&e.getNegativeErrorCode&&e.getNegativeErrorCode(),i=[{name:"TargetEntityType",value:l.entityLogicalName},{name:"VisualizationId",value:f},{name:"ChartType",value:l.chartType},{name:"ErrorCode",value:Object(x.j)(r)?"":"0x"+E.a.getHexErrorCodeFromInt(r)},{name:"ErrorMessage",value:e.message?e.message:""},{name:"ErrorDetails",value:e.details?e.details:""}];t.info(n+" page, retrieve Chart Control metadata failed.",i)})),u.push(s[f]),d.push(s[f])),g&&(o[g]||(o[g]=c(Object(m.a)(l.entityLogicalName,void 0,l.viewType,h)).catch(e=>{const r=e&&e.getNegativeErrorCode&&e.getNegativeErrorCode(),i=[{name:"TargetEntityType",value:l.entityLogicalName},{name:"ViewId",value:g},{name:"ViewType",value:l.viewType},{name:"ErrorCode",value:Object(x.j)(r)?"":"0x"+E.a.getHexErrorCodeFromInt(r)},{name:"ErrorMessage",value:e.message?e.message:""},{name:"ErrorDetails",value:e.details?e.details:""}];t.info(n+" page, retrieve Chart Control metadata failed.",i)})),u.push(o[g]),d.push(o[g])),d}}(e,t,Y),Z=function(e,t,n,r,a,s){const o=[],c={},l=Object(f.c)(e,r,a,s);return(a,s)=>{const u=s.controlParameters,d=Object(f.e)(s);let p,h=c[d];if(!h){const t=e(),n=s.entityLogicalName,r=Object(M.q)(t);if(t&&n&&r){const e=Object(P.c)(t,j.Zc),i=Object(N.a)(n,r,s.contextToken,e).getFilterAndLinkedEntities(k.a,!0);if(i){if(s.getCustomFilter){const e=s.getCustomFilter();if(e&&e.filter){const t=i.filter,n={conditions:[],filterOperator:0,filters:[e.filter,t]};i.filter=n}e&&e.linkEntities&&i.linkEntities.push(...e.linkEntities)}s.getCustomFilter=()=>i}}h=l(s),c[d]=h}const g=u.ChartDrillDownParameters;if(g&&g.length>0){const r=g[g.length-1];p=new F.a(e,i.a.tryParse(u.VisualizationId),i.a.tryParse(s.viewId),s.chartType,s.viewType,r.groupByAttribute.name,r.groupByAttribute.relatedEntityName,r.chartType);const a=[{name:"TargetEntityType",value:s.entityLogicalName},{name:"ViewId",value:s.viewId},{name:"VisualizationId",value:u.VisualizationId},{name:"DrilldownAttributeName",value:r.groupByAttribute.name},{name:"DrilldownChartType",value:r.chartType}];t.info(n+" page, retrieve chart drilldown data dispatched",a)}else{p=new T.a(e,i.a.tryParse(u.VisualizationId),i.a.tryParse(s.viewId),s.chartType,s.viewType);const r=[{name:"TargetEntityType",value:s.entityLogicalName},{name:"ViewId",value:s.viewId},{name:"VisualizationId",value:u.VisualizationId}];t.info(n+" page, retrieve chart data dispatched",r)}const m=Object(C.qb)(e(),i.a.tryParse(s.viewId),r),b=Object(w.a)(e(),i.a.tryParse(u.VisualizationId));return b&&b.DataDescription&&(h&&h.fetchXml||m&&m.fetchXML)&&(p.initialize(b.DataDescription,h.fetchXml?h.fetchXml:m.fetchXML,b.PresentationDescription,m.title,m.entityLogicalName,b.Name,b.PrimaryEntityTypeCode,!i.a.isNullOrEmpty(b.WebResourceId)),p.setupAggregationQueries()),-1===o.indexOf(p.getStorageKey())?(o.push(p.getStorageKey()),a(Object(I.a)(p,s.entityLogicalName,r,!1))):null}}(e,t,Y,A,V,H),J=function(e,t,n,a){const s=[],o={},c={},l={};return(u,b,f)=>{const S=[],v=b.entityLogicalName,C=b.controlParameters;if(b.ribbonContext){const n=b.ribbonContext+v;if(-1===s.indexOf(n)){s.push(n);const r=u(Object(d.a)(n));S.push(r);const i=[{name:"TargetEntityType",value:v},{name:"RibbonContext",value:b.ribbonContext}];e.info(t+" page, retrieve ribbon dispatched",i)}}const O=b.cardFormId;if(O&&(!i.a.equals(O,r.a)||"activitypointer"!==v)){const n=i.a.equals(O,r.a)?null:O,a=n?n.guid:b.entityLogicalName;if(!o[a]){const r=u(Object(h.b)(new p.a(v),n,Object(g.a)(11)));o[a]=r,S.push(r);const i=[{name:"TargetEntityType",value:v},{name:"FormId",value:O&&O.guid}];e.info(t+" page, retrieve card form dispatched",i)}f.push(o[a])}if(!(1===b.gridType||"true"!==C.EnableViewPicker||l[v]&&l[v].allViews)){l[v]||(l[v]={allViews:!1,viewIds:[]});const n=l[v],r=C.ViewIds,s=r&&r.split(",");if(s&&0!==s.length){for(const r of s)if(-1===n.viewIds.indexOf(r)){n.viewIds.push(r);const s=i.a.tryParseOrNull(r);if(s){const n=u(Object(m.a)(v,void 0,void 0,s,void 0,a));S.push(n);const i=[{name:"TargetEntityType",value:v},{name:"ViewId",value:r}];e.info(t+" page, retrieve view dispatched",i)}}}else{if(n.allViews=!0,0===b.gridType){const e=u(Object(m.a)(v,y.a.SUB_GRID,void 0,void 0,void 0,a));S.push(e)}const r=u(Object(m.a)(v,y.a.MAIN_APPLICATION_VIEW,void 0,void 0,void 0,a));S.push(r);const i=[{name:"TargetEntityType",value:v}];e.info(t+" page, retrieve all views dispatched",i)}}const _=b.viewId;if(c[_])b.viewId=c[_];else{const r="true"===C.IsUserView?y.b.userview:y.b.savedview,a=b.pinnedEntityLogicalName;let s=0===b.gridType?y.a.SUB_GRID:y.a.MAIN_APPLICATION_VIEW,o=a||v;b.quickFindSearchString&&(s=y.a.QUICKFIND_SEARCH,o=b.quickFindEntityIfActivity||o);const l=u(function(e,t,n,r){return{type:"view.retrieveornull.async",execute({dispatch:i,getState:a},s,o){const c=i(Object(m.a)(e,t,n,r));return new Promise(i=>{c.then(e=>i(e),a=>{const o=s.TraceManager.getTracer("view.retrieveornull.async"),c=[{name:D.b.EntityName,value:e},{name:D.b.ViewId,value:r&&r.guid||""},{name:"ViewType",value:n},{name:"SavedQueryType",value:t}];return o.warn("Retrieve view or null : retrieve of view failed : "+Object(R.d)(a),c),i(null)})})}}}(o,s,r,i.a.tryParseOrNull(_))).then(t=>{if(_&&!t&&n){e.warn("Pinned view retrieval failed. Loading default view.");return u(Object(m.a)(v,y.a.MAIN_APPLICATION_VIEW)).then(e=>r(e))}return r(t);function r(e){const t=e&&e.guid;if(b.viewId=t,c[_]=t,b.onViewRetrieve)return b.onViewRetrieve(e)}});S.push(l),f.push(l);const d=[{name:"TargetEntityType",value:v},{name:"ViewId",value:_}];e.info(t+" page, retrieve view dispatched from retrieveControlMetadataAndData",d)}return S}}(t,Y,q,X),$=function(e,t,n,r,i,s){const o={},c=Object(f.b)(e,r,i,s);return(i,s,l,u,d)=>{var p,h;const g=[],m=s.entityLogicalName,b=s.viewId;if(b){const y=Object(f.e)(s);let O=o[y];if(!O){const r=c(s);if(O=O instanceof B.a?r&&r.getQueryState():r&&r.getQueryState(e),!O)return g;if(o[y]=O,Object(L.c)(O,null===(p=s.contextToken)||void 0===p?void 0:p.contextTokenType,null===(h=s.control)||void 0===h?void 0:h.Id),u){i(Object(S.d)(O)).catch(()=>{const e={lists:{[O.key]:{initialized:a.a.Error,lastRetrieved:new Date,pageSize:r.pageSize}}};i({type:S.b,payload:e})});const e=[{name:"TargetEntityType",value:m},{name:"ViewId",value:b}];t.info(n+" page, retrieve grid data dispatched",e)}}if(d){const t=s.controlParameters.RelationshipName,n=Object(C.db)(e(),m,t),a=i(Object(v.d)(O,m,r,s.contextToken,s.control,t,n,void 0,l));if(g.push(a),s.onInitializeGrid){const e=a.then(s.onInitializeGrid);g.push(e)}}else if(s.onInitializeGrid){const e=s.onInitializeGrid();g.push(e)}const _=[{name:"TargetEntityType",value:m},{name:"ViewId",value:b}];return t.info(n+" page, initialize grid dispatched",_),g}}}(e,t,Y,A,V,H),ee=function(e){if(e&&e.FormType){const t=Object(g.a)(e.FormType);return`${b.x}.${b.y}.${t}`}return""}(V),te=z(G,2),ne=z(G,4);return t=>({type:"retrieveControlMetadataAndData.loadControl",execute:({dispatch:r})=>{const s=function(e,t){if(e&&t&&t.hasGrid&&t.control&&t.controlParameters){const n=[];return n.push({name:"FormId",value:i.a.toString(e.Id)}),n.push({name:"ViewId",value:t.viewId}),n.push({name:"IsUserView",value:t.controlParameters.IsUserView}),n.push({name:"ControlId",value:t.control.Id}),n}return null}(V,t),d=ne(t)&&Object(o.b)(e()),p=[],h=[],g=t.hasGrid&&t.ribbonContext&&t.contextToken&&Object(O.c)(A,t.contextToken),m=t.entityLogicalName;let b=K[m];if(!b){const e=W&&W(m);b=r(Object(c.f)(m,e,[])),K[m]=b}const y=[],f=t.hasChart&&d&&Q(r,t,y);h.push(...y),f&&p.push(...f);const S=[],v=t.hasGrid&&J(r,t,S);h.push(...S),v&&(p.push(...v),0===t.gridType&&Promise.all(S).catch(e=>{n.ReportComponentFailure(ee,e,null,s)}));const C=U&&U(t,h);C&&p.push(...C);const _=Promise.all([b,...h]).then(()=>{const i=Object(l.h)(e(),m);if(i&&i.Initialized===a.a.Initialized&&(!i.IsEnabledInUnifiedInterface||!Object(u.g)(e(),m,2,0)))return;const c=Object(o.b)(e())&&d,p=[],h=t.hasChart&&c&&Z(r,t);h&&p.push(h);const b=t.hasGrid&&$(r,t,g,ne(t),te(t));return b&&(p.push(...b),0===t.gridType&&Promise.all(b).then(()=>{n.ReportComponentSuccess(ee,s)},e=>{n.ReportComponentFailure(ee,e,null,s)})),Promise.all(p)});return p.push(_),Promise.all(p)}})}(e,n,V,H,G,W,q,X,Y,K,Q),ee=z(q,1),te=z(q,0);for(const e in U){const n=U[e];if(ee(n))Z.push(t($(n)));else if(!te(n)){const e=Object(A.a)($(n));J.push(t(e))}}return{inProgress:Z,preload:J}}function z(e,t){return 0===t?t=>0===e(t):n=>!!(e(n)&t)}},"WK+4":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n("dHD5"),i=n("BFlg");const a="chart.visualizationid.update";function s(e,t,n){return{type:"chart.visualizationid.update.async",execute({dispatch:s,getState:o},c){const l=c.TraceManager.getTracer(i.z),u=i.x+".updateVisualizationIdAction";try{l.info("Updating the chart visualization id"),t||(t=Object(r.k)(o(),e));const i=Object(r.v)(t);return s(function(e,t,n){return{type:a,payload:{name:"VisualizationId",value:n},meta:{pageId:e,dataSetContextKey:t}}}(e,i,n)),c.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){const t="Updatation of the chart visualization id failed with error : "+e.message;c.EventManager.ReportComponentFailure(u,Error(t))}}}}},WRDA:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e){return Object(r.b)(e)?null:("{"===(e=e.trim())[0]&&"}"===e[e.length-1]&&(e=e.substring(1,e.length-1)),e.toLowerCase())}},Wdaq:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n("dHD5"),i=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="grid.setCommandManagerId";function s(e,t,n){return{type:"grid.setCommandManagerId.async",execute({dispatch:s,getState:o},c){const l=c.TraceManager.getTracer(i.z),u=i.x+".setCommandManagerIdAction";try{l.info("Updating the command manager id for the grid.");const i=Object(r.v)(n);return s(function(e,t,n){return{type:a,payload:t,meta:{pageId:e,dataSetContextKey:n}}}(e,t,i)),c.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){const t="Updating the command manager id for the grid failed with error : "+e.message;c.EventManager.ReportComponentFailure(u,Error(t))}}}}},XT3E:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="formHeaderTitle"},XVSa:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("pEXn"),i=n("YxC/"),a=n("mHvI"),s=n("EY5k"),o=n("i1f0"),c=n("LbMF");function l(e,t,n){return{type:"formChecker.ControlState.async",async execute({dispatch:l,getState:u},d){var p,h;const g=u(),m=null===(p=null==d?void 0:d.TraceManager)||void 0===p?void 0:p.getTracer(`${r.k}${r.l}`),b=Object(o.eb)(g,e,t),y=Object(a.b)();if(!b||!m)return Promise.resolve();await l(Object(s.e)(y));const f=u(),S=Object(i.e)(f,y),v=[];for(const r in b){const a=b[r];if(a){const s={id:e,controlName:r},l=Object(o.v)(f,s,t),u=(null==l?void 0:l.reason)?Object(i.c)(S,l.reason):null,d=a.labelSource?Object(i.c)(S,a.labelSource):null,p=a.dataFieldName?Object(c.a)(f,n,null==a?void 0:a.dataFieldName):null,g={"Control Name":r,"Control Label":Object(o.w)(f,s,t),"Control Label Source":`[${a.labelSource}]`+(d?": "+d:""),Attribute:null==p?void 0:p.LogicalName,Disabled:null===(h=null==l?void 0:l.disabled)||void 0===h?void 0:h.toString(),"Disabled State Reason":`[${null==l?void 0:l.reason}]`+(u?": "+u:"")};v.push(g)}}m.warn(r.n,[{name:r.v,value:r.l},{name:r.l,value:JSON.stringify(v)}])}}}},XVX7:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));var r=n("OWbt"),i=n("6Qf/"),a=n("dHD5");function s(e,t,n){const i=Object(a.v)(n),s={xrmReady:e};return{type:r.b,payload:s,meta:{pageId:t,contextKey:i}}}function o(e,t,n){const r=Object(a.u)(n),s={xrmReady:e};return{type:i.b,payload:s,meta:{pageId:t,contextKey:r}}}},XfPn:function(e,t,n){"use strict";n.r(t),n.d(t,"BarNotificationList",(function(){return F}));var r=n("nuS9"),i=n("4fxQ"),a=n("u+q+"),s=n("nJrx"),o=n("unFF"),c=n("b8TU"),l=n("eu2O");var u=n("YxC/"),d=n("sptG"),p=n("zJiL"),h=n("gvL4"),g=n("H/hG"),m=n("YWpA"),b=n("Afz2"),y=n("1AYO"),f=n("3rse"),S=n("Gilj"),v=n("FhVi"),C=n("eL7I"),O=n("XIN1"),_=n("znb3"),I=n("jSRx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const j=Object(s.a)();class P extends r.Component{constructor(e){super(e),this._flyoutOutsideClickHandler=this._flyoutOutsideClickHandler.bind(this),this._notificationKeyDownHandler=this._notificationKeyDownHandler.bind(this),this._onNotificationItemDidMount=this._onNotificationItemDidMount.bind(this),this._toggleFlyout=this._toggleFlyout.bind(this),this._notificationRef=this._notificationRef.bind(this),this.onMeasuring=this.onMeasuring.bind(this),this.state={isNotificationFlyoutOpened:!1,focusedIndex:-1,isNotificationRendered:!1},this._previousHeaderCollapsed=e.headerCollapsed}_toggleFlyout(){this._updateFlyoutWidth(),this.state.isNotificationFlyoutOpened?this.setState(Object.assign(Object.assign({},this.state),{isNotificationFlyoutOpened:!this.state.isNotificationFlyoutOpened,focusedIndex:-1,isNotificationRendered:!1})):this.setState(Object.assign(Object.assign({},this.state),{isNotificationFlyoutOpened:!this.state.isNotificationFlyoutOpened}))}_notificationsCountMessage(){let e=Object(u.c)(this.props.resourceStrings,d.a);return e=e.replace("{0}",String(this.props.notificationList.length)),e}_updateFlyoutWidth(){const e=i.findDOMNode(this.refs.notificationWrapper);e&&(this._clientWidth=e.clientWidth)}_createKeyboardShortcuts(){const e="Notification Flyout "+this.props.component,t=this._shortcutHandler.bind(this),n=this._shiftTabShortcutHandler.bind(this),r=[],i=new S.a([f.a.Escape],t,!0,e,"Close Notification Flyout"),a=new S.a([f.a.Enter],t,!1,e,"Open Notification Flyout",this._getWrapperId()),s=new S.a([f.a.UpArrow],t,!0,e,"Move Up on Notifiation Flyout"),o=new S.a([f.a.DownArrow],t,!0,e,"Move Down on Notifiation Flyout"),c=new S.a([f.a.Tab],t,!0,e,"Tab on the Notification Flyout"),l=new S.a([f.a.Shift,f.a.Tab],n,!0,e,"Shift Tab on the Notification Flyout");return r.push(i),r.push(a),r.push(s),r.push(o),r.push(c),r.push(l),r}_shiftTabShortcutHandler(e){const t=e.EVENT;this.state.isNotificationFlyoutOpened&&(t.preventDefault(),t.stopPropagation())}_shortcutHandler(e){const t=e.EVENT;if(t.keyCode===f.a.Enter)this.state.isNotificationFlyoutOpened||this._toggleFlyout();else if(t.keyCode===f.a.DownArrow&&this.state.focusedIndex>-1){const e=(this.state.focusedIndex+1+this.props.notificationList.length)%this.props.notificationList.length;this._moveFocus(e)}else if(t.keyCode===f.a.UpArrow&&this.state.focusedIndex>-1){const e=(this.state.focusedIndex-1+this.props.notificationList.length)%this.props.notificationList.length;this._moveFocus(e)}else t.keyCode===f.a.Tab&&this.state.isNotificationFlyoutOpened&&t.preventDefault()}_moveFocus(e){const t=i.findDOMNode(this._notificationItemsList).childNodes[e];t&&(t.tabIndex=0,t.focus(),this.setState({focusedIndex:e}))}_notificationRef(e){this._notificationItemsList=e}_onNotificationItemDidMount(){-1===this.state.focusedIndex&&this.state.isNotificationFlyoutOpened&&this.setState(Object.assign(Object.assign({},this.state),{isNotificationRendered:!0}))}_renderNotificationList(e){if(e&&e.length){const t=1===e.length,n=e.map((e,n)=>r.createElement(I.a,{key:e.UniqueId,id:this.props.id,domWidth:this.props.domWidth,notification:e,notificationType:e.Level,shouldNotifyRenderComplete:!0,onRenderComplete:this._onNotificationItemDidMount,displayFullMessage:this.props.displayFullMessage,keyDownHandler:this._notificationKeyDownHandler,notificationWidth:this._clientWidth,onlyNotification:t,buttonMeasuringCallback:this.props.buttonMeasuringCallback,toggleFlyout:this._toggleFlyout}));return r.createElement(h.a,{testhooks:{id:"notificationList"},ref:this._notificationRef,style:this.props.formNotificationListStyle,role:t?b.r:void 0},n)}}_flyoutOutsideClickHandler(e){if(e&&e.target){const t=e.target.id;t!==this._getWrapperId()&&t!==this._getWrapperId()+"_icon"&&t!==this._getWrapperId()+"_message"&&t!==this._getWrapperId()+"_expandIcon"&&"notificationIcon"!==t&&t!==C.a&&this._toggleFlyout()}}_notificationKeyDownHandler(e){if(this.state.isNotificationFlyoutOpened&&e&&e.keyCode&&e.keyCode===f.a.Escape){this._toggleFlyout(),e.stopPropagation();const t=i.findDOMNode(this.refs.notificationWrapper);t&&t.focus()}}_getWrapperId(){return"notificationWrapper"+this.props.id}_getMessageIcon(e){switch(e){case p.a:return _.a.MarkAsLost;case p.e:return _.a.Warning;case p.d:return _.a.SuccessIcon;default:return _.a.InformationIcon}}onMeasuring(e){const t=i.findDOMNode(this.refs.notificationWrapper);if(!t)return;const n=t.clientWidth,r=t.clientHeight;this._clientWidth!==n&&this.state.isNotificationFlyoutOpened&&(this._updateFlyoutWidth(),this.setState(Object.assign(Object.assign({},this.state),{isNotificationFlyoutOpened:this.state.isNotificationFlyoutOpened,focusedIndex:-1,isNotificationRendered:!0}))),this._clientHeight!==r&&(this.props.buttonMeasuringCallback&&this.props.buttonMeasuringCallback(n,r),this._clientHeight=t.clientHeight)}componentWillReceiveProps(e){this.state.isNotificationFlyoutOpened&&this._previousHeaderCollapsed!==e.headerCollapsed&&this._toggleFlyout()}render(){return r.createElement(m.a,{key:"barnotificationlistAccessibility",id:"barnotificationlistAccessibility_"+Object(s.a)()},this._renderBarNotifications())}_renderBarNotifications(){if(this.props.notificationList.length>0){if(1===this.props.notificationList.length){const e=this._renderNotificationList(this.props.notificationList);return r.createElement(m.a,{ref:"notificationWrapper",style:Object.assign(Object.assign({},this.props.formNotificationWrapperStyle),this.props.customStyle),testhooks:{id:"notificationWrapper"}},r.createElement(v.a,{keyboardShortcuts:this._createKeyboardShortcuts(),shouldManageFocus:!0}),e)}let e;if(this.state.isNotificationFlyoutOpened){const t=this._renderNotificationList(this.props.notificationList);e=r.createElement(y.a,{key:j,id:j,flyoutDirection:y.b.down,relativeToElementId:this._getWrapperId(),enforceDirection:!0,positionType:"relative",flyoutStyle:this.props.formNotificationFlyoutStyle,size:{width:this._clientWidth||500},onOutsideClick:this._flyoutOutsideClickHandler,testhooks:{id:"notificationFlyout"}},t)}else e=void 0;return this.props.setFormNotificationHeight&&this.props.setFormNotificationHeight(l.a),r.createElement(m.a,{isRequestedMeasuring:!0,onMeasuring:this.onMeasuring,style:Object.assign(Object.assign({},this.props.formNotificationWrapperStyle),this.props.customStyle),role:b.a},r.createElement(m.a,{ref:"notificationWrapper",style:this.props.formNotificationStyle,onClick:()=>this._toggleFlyout(),role:b.d,controlsElementId:j,notificationType:"assertive",testhooks:{id:"notificationWrapper"},id:this._getWrapperId(),tabIndex:0,accessibilityExpanded:this.state.isNotificationFlyoutOpened},r.createElement(v.a,{key:"flyoutAccessibility",rootElementId:this._getWrapperId(),keyboardShortcuts:this._createKeyboardShortcuts(),shouldManageFocus:!1}),r.createElement(g.a,{id:this._getWrapperId()+"_icon",style:this.props.notificationList.some(e=>e.Level===p.a)?this.props.notificationIconWrapperStyle:this.props.notificationNoErrorIconWrapperStyle},r.createElement(O.b,{style:this.props.notificationIconStyle,id:"notificationIcon",type:this._getMessageIcon(this.props.mostSevereLevel),testhooks:{id:"formNotificationIcon"}})),r.createElement(g.a,{id:this._getWrapperId()+"_message",announceAccessibilityNotification:!0,ownsElementId:this.state.isNotificationFlyoutOpened?j:void 0,style:this.props.notificationList.some(e=>e.Level===p.a)?this.props.alertTextStyle:this.props.alertNoErrorTextStyle},this._notificationsCountMessage()),r.createElement(g.a,{id:this._getWrapperId()+"_expandIcon",style:this.props.notificationExpandIconWrapperStyle},r.createElement(O.b,{style:this.props.notificationExpandIconStyle,id:C.a,type:this.state.isNotificationFlyoutOpened?_.a.ChevronUp:_.a.ChevronDown,testhooks:{id:{NOTIFICATION_EXPAND_ICON_ID:C.a}}})),e))}return null}componentDidUpdate(){-1===this.state.focusedIndex&&this._notificationItemsList&&this.state.isNotificationFlyoutOpened&&this.state.isNotificationRendered&&this._moveFocus(0),this._previousHeaderCollapsed=this.props.headerCollapsed}componentDidMount(){this._previousHeaderCollapsed=this.props.headerCollapsed}}P.displayName="BarNotificationList";const F=Object(a.a)((function(){const e=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e=null,t=null,n=null,r=null,i=null;return function(a,s,u){const d=Object(o.a)(a),p=Object(c.b)(a),h=Object(c.c)(a);if(n!==d||r!==p||i!==h||t!==u){n=d,r=p,i=h,t=u;const a=Object(l.d)(u);e={formNotificationWrapperStyle:{display:"flex",width:"100%",boxSizing:"border-box",minHeight:l.a+"px",maxHeight:"100%",marginTop:d.sizes.Measures.Measure100},formNotificationStyle:{display:"flex",backgroundColor:a,flex:"1 1 auto",cursor:"pointer",boxSizing:"border-box"},formNotificationFlyoutStyle:{left:"15px",display:"flex",flexDirection:"column",boxShadow:"0px 1.2px 3.6px rgba(0, 0, 0, 0.12), 0px 6.4px 7.2px rgba(0, 0, 0, 0.1)"},formNotificationListStyle:{overflowY:"hidden",listStyleType:"none",width:"100%",display:"inline"},notificationIconWrapperStyle:{textAlign:"center",backgroundColor:"transparent",borderBottom:"1px solid transparent",height:"20px",paddingLeft:"10px",paddingRight:"10px",paddingTop:"6px"},notificationNoErrorIconWrapperStyle:{textAlign:"center",backgroundColor:"transparent",borderBottom:"1px solid transparent",height:"20px",paddingLeft:"10px",paddingRight:"10px",paddingTop:"6px",color:"#797673"},notificationIconStyle:{height:"20px",width:"20px",fontSize:"20px",color:Object(l.e)(u)},alertTextStyle:{flexGrow:1,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontSize:"12px",fontFamily:d.fontFamilies.Regular,color:"#1F2126",marginTop:"7px",lineHeight:"16px"},alertNoErrorTextStyle:{flexGrow:1,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontSize:"12px",fontFamily:d.fontFamilies.Regular,color:"#1F2126",marginTop:"7px",lineHeight:"16px"},notificationExpandIconWrapperStyle:{paddingTop:"9px",paddingRight:"10px",paddingLeft:"10px",textAlign:"center",backgroundColor:"transparent"},notificationExpandIconStyle:{height:"16px",width:"16px",fontSize:"16px",color:"#1F2126"}}}return e}}(),t=Object(u.h)();return function(n,r){const i=function(e){const t=p.b;if(!e||0===e.length)return t;const n=[p.a,p.e,p.b,p.d],r=e.map(e=>e.Level);for(const e of n)if(r.indexOf(e)>=0)return e;return t}(r.notificationList),a=e(n,r,i),s=t(n,d.f);return Object.assign(Object.assign({},a),{mostSevereLevel:i,resourceStrings:s})}}))(P)},Y5AI:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="form.ShowHeaderFieldsInSection.set";function a(e,t,n){const a=Object(r.v)(t);return{type:i,payload:{showHeaderFieldsInSection:n},meta:{pageId:e,contextKey:a}}}},Yexl:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b}));var r=n("3/02"),i=n("SAYH"),a=n("P6DH"),s=n("Lyxw"),o=n("B9jE"),c=n("jRy5"),l=n("a72m"),u=n("KBcj"),d=n("d0w6"),p=n("BFlg"),h=n("hSDL"),g=n("jAuy");function m(e,t,n,m){return{type:"grid.quickfind.apply.async",execute({dispatch:b,getState:y},f){const S=f.TraceManager.getTracer(p.z),v=p.x+".QuickFilterAction";try{const p=y(),C=Object(a.F)(p,t,n,m);return function(e,t,n){return new Promise(r=>{const i=Object(u.a)(e,n,d.a.QUICKFIND_SEARCH);i?r(i):t(Object(l.a)(n,d.a.QUICKFIND_SEARCH,d.b.savedview)).then(e=>{r(e)})})}(p,b,C).then(l=>{S.info("Performing quick find on the grid ");const u=Object(a.T)(p,t,n,m);let C=u;const O=n.contextTokenType===c.a.SubGrid;let _=!1;if(O&&n.controlName){const e=Object(a.hb)(y(),t,n,n.controlName);e&&(_=e.EnableViewPicker)}return Object(s.a)(y(),r.Nd)&&O&&!_||Object(g.l)(p)||(C=l),b(Object(h.n)(e,t,n)),b(Object(o.a)(t,n,m,i.a.toString(C),null,d.a.QUICKFIND_SEARCH)).then(()=>(f.EventManager.ReportComponentSuccess(v),u))})}catch(e){const t="Unable to perform a quick find on the grid";f.EventManager.ReportComponentFailure(v,Error(t))}}}}function b(e,t,n,r){return{type:"grid.quickfind.clear.async",execute({dispatch:a,getState:s},c){const l=c.TraceManager.getTracer(p.z),u=p.x+".QuickFilterAction";try{return l.info("Clearing quick find from the grid."),a(Object(h.n)("",t,n)),a(Object(o.a)(t,n,r,i.a.toString(e))).then(()=>{c.EventManager.ReportComponentSuccess(u)})}catch(e){const t="Unable to clear quick find value for grid";c.EventManager.ReportComponentFailure(u,Error(t))}}}}},ZJsz:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r={queryKey:null,pageNumber:1,isNewPageRequested:!1,selectedRows:[],selectedRelatedEntity:null,filters:{},rowProperties:{records:[]},fetchXml:"",controls:{},refreshCounter:0,pagingRefreshInput:0,pagingData:"",relationshipName:null,relationshipRoleOrdinal:null,showChart:null,useRollupView:!1,chartVisualizationType:null,dependentOptionSetColumnStatus:{},chartDrillDownParameters:[]}},ZUzm:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("cfbi"),i=n("ruPX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function a(e,t,n,a,s,o,c,l,u){const d={entityTypeName:e.etn,id:e.id,formId:n,data:a,processId:s,processInstanceId:o,selectedStageId:c,isCrossEntityNavigate:l,recordSetQueryKey:u};return Object(i.a)(r.a,d,t)}},Zw8F:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("SAYH"),i=n("qshH"),a=n("arV0"),s=n("16wZ"),o=n("ZIjf"),c=n("rs6x"),l=n("7TDv"),u=n("+Ljw");let d;class p{constructor(e,t,n,r){this._id=e,this._label=t,d=n,this._pageId=r}getId(){const e="ClientApi.XrmFormSelectorItem.getId";try{o.a.instance.reportCall(e);const t=r.a.toString(this._id);return o.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}getLabel(){return o.a.instance.reportUsage("ClientApi.XrmFormSelectorItem.getLabel"),this._label}getPageId(){return o.a.instance.reportUsage("ClientApi.XrmFormSelectorItem.getPageId"),this._pageId}setVisible(e){const t="ClientApi.XrmFormSelectorItem.setVisible";try{o.a.instance.reportCall(t),d.dispatch(Object(l.b)(this._pageId,r.a.toString(this._id),e)),o.a.instance.reportSuccess(t)}catch(e){throw i.a.getInstance().reportFailure(t,e),e}}getVisible(){const e="ClientApi.XrmFormSelectorItem.getVisible";try{o.a.instance.reportCall(e);const t=Object(u.c)(d.getState(),this._pageId,this._id);return o.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}navigate(){const e="ClientApi.XrmFormSelectorItem.navigate";try{this._pageId||Object(s.j)(e,"PageId"),o.a.instance.reportCall(e);const t=Object(a.g)(d.getState(),this._pageId),n=t&&t.id?t.id.guid:"",r=Object(a.l)(d.getState(),this._pageId);d.dispatch(Object(c.a)(this._id.guid,this._pageId,r,n)).then(()=>{o.a.instance.reportSuccess(e)}).catch(t=>Object(s.d)(d,t,e+".changeForm"))}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}}},"b41/":function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"g",(function(){return i})),n.d(t,"h",(function(){return a})),n.d(t,"i",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r={advancedFilters:"Grid_AdvancedFilter_AdvancedFilters",cancel:"GlobalFilter_Cancel",apply:"Button_Label_Apply",addButton:"Web.SFA.Workflow.Variables.Add",addRow:"MenuItem_Label_AddRow_SentenceCase",addGroup:"MenuItem_Label_AddGroup_SentenceCase",deleteExpression:"Web.SFA.Workflow.Variables.Delete",moveUpExpression:"Web._controls.listedit.buttons.MoveUp",moveDownExpression:"Web._controls.listedit.buttons.MoveDown_SentenceCas",makeGroup:"Grid_AdvancedFilter_MakeGroup",ungroup:"AF_MenuItem_UnGroup",andGroup:"AF_Text_And",orGroup:"AF_Text_Or_SentenceCase",addRelatedEntity:"MenuItem_Label_AddRelatedEntity_SentenceCase",relatedEntityPlaceholder:"Grid_AdvancedFilter_RelatedEntityPlaceholder",fieldPlaceholder:"Audit.Incontext.Filters.AttributesGroup",containsData:"Web._tools.search.search.js_12_8_SentenceCase",doesNotContainData:"Web._tools.search.search.js_12_9_SentenceCase",doesNotContainDataWarning:"Grid_AdvancedFilter_DoesNotContainDataWarning",manyToOne:"Grid_AdvancedFilter_ManyToOne",oneToMany:"Grid_AdvancedFilter_OneToMany",manyToMany:"Grid_AdvancedFilter_ManyToMany",noRelationships:"Grid_AdvancedFilter_NoRelationships",moreCommandsAriaLabel:"AF_Aria_MoreCommands",rowSelectorAriaLabel:"AF_Aria_RowSelector",groupSelectorAriaLabel:"AF_Aria_GroupSelector",groupExpandAriaLabel:"AF_MenuItem_Expand",groupCollapseAriaLabel:"AF_MenuItem_Collapse",groupExpandAriaDescription:"AF_Aria_GroupExpand",groupCollapseAriaDescription:"AF_Aria_GroupCollapse",errorQuickFind:"AF_Error_QuickFindView",errorMalformed:"Grid_AdvancedFilter_ErrorMalformed",invalidField:"Grid_AdvancedFilter_InvalidField",fieldSelectorControlLabel:"Grid_AdvancedFilter_FieldSelector",operatorSelectorControlLabel:"Web.SFA.Workflow.AssignValueDialog.Operator",errorFailedToLoad:"Grid_AdvancedFilter_FailedToLoad",fetchXmlConditionWarning:"Grid_AdvancedFilter_FetchXmlConditionWarning"},i=Object.values(r),a={contains:"SystemCustomization.BusinessRules.ConditionOperator.CONTAINS",doesNotContain:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTCONTAIN",beginsWith:"SystemCustomization.BusinessRules.ConditionOperator.BEGINSWITH",doesNotBeginWith:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTBEGINWITH",endsWith:"SystemCustomization.BusinessRules.ConditionOperator.ENDSWITH",doesNotEndWith:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTENDWITH",containsData:"SystemCustomization.BusinessRules.ConditionOperator.NOTNULL",doesNotContainData:"SystemCustomization.BusinessRules.ConditionOperator.ISNULL",equals:"CustomControl_Grid_Filtering_ConditionOperator_Equals",doesNotEqual:"CustomControl_Grid_Filtering_ConditionOperator_DoesNotEqual",greaterThan:"CustomControl_Grid_Filtering_ConditionOperator_Greater",greaterThanOrEqualTo:"CustomControl_Grid_Filtering_ConditionOperator_GreaterOrEqual",lessThan:"CustomControl_Grid_Filtering_ConditionOperator_Less",lessThanOrEqualTo:"CustomControl_Grid_Filtering_ConditionOperator_LessOrEqual",dateQuarter:"ViewDesigner.RecordFilter.quarter",dateFiscalYear:"FiscalYear_Format_String_NoSpace",on:"Web._tools.search.search.js_16_0",onOrAfter:"CustomControl_Grid_Filtering_ConditionOperator_OnOrAfter",onOrBefore:"ViewDesigner.RecordFilter.on_or_before",yesterday:"Web._tools.search.search.js_16_3",today:"Web._tools.search.search.js_16_4",tomorrow:"Web._tools.search.search.js_16_5",nextSevenDays:"Web._tools.search.search.js_16_6",lastSevenDays:"Web._tools.search.search.js_16_7_SentenceCase",nextWeek:"Web._tools.search.search.js_16_8_SentenceCase",lastWeek:"Web._tools.search.search.js_16_9_SentenceCase",thisWeek:"Web._tools.search.search.js_16_10_SentenceCase",nextMonth:"Web._tools.search.search.js_16_11_SentenceCase",lastMonth:"Web._tools.search.search.js_16_12_SentenceCase",thisMonth:"Web._tools.search.search.js_16_13_SentenceCase",nextYear:"Web._tools.search.search.js_16_14_SentenceCase",lastYear:"Web._tools.search.search.js_16_15_SentenceCase",thisYear:"Web._tools.search.search.js_16_16_SentenceCase",lastXHours:"AF_Option_LastXHours_SentenceCase",nextXHours:"AF_Option_NextXHours_SentenceCase",lastXDays:"AF_Option_LastXDays_SentenceCase",nextXDays:"AF_Option_NextXDays_SentenceCase",lastXWeeks:"AF_Option_LastXWeeks_SentenceCase",nextXWeeks:"AF_Option_NextXWeeks_SentenceCase",lastXMonths:"AF_Option_LastXMonths_SentenceCase",nextXMonths:"AF_Option_NextXMonths_SentenceCase",lastXYears:"AF_Option_LastXYears_SentenceCase",nextXYears:"AF_Option_NextXYears_SentenceCase",anyTime:"Search.Time.Range.Anytime",olderThanXMinutes:"AF_Option_OlderThanXMinutes_SentenceCase",olderThanXHours:"AF_Option_OlderThanXHours_SentenceCase",olderThanXDays:"AF_Option_OlderThanXDays_SentenceCase",olderThanXWeeks:"AF_Option_OlderThanXWeeks_SentenceCase",olderThanXMonths:"AF_Option_OlderThanXMonths_SentenceCase",olderThanXYears:"AF_Option_OlderThanXYears_SentenceCase",inFiscalYear:"AF_Option_InFiscalYear_SentenceCase",lastFiscalYear:"AF_Option_LastFiscalYear_SentenceCase",thisFiscalYear:"AF_Option_ThisFiscalYear_SentenceCase",nextFiscalYear:"AF_Option_NextFiscalYear_SentenceCase",lastXFiscalYears:"AF_Option_LastXFiscalYears_SentenceCase",nextXFiscalYears:"AF_Option_NextXFiscalYears_SentenceCase",inFiscalPeriod:"AF_Option_InFiscalPeriod_SentenceCase",lastFiscalPeriod:"AF_Option_LastFiscalPeriod_SentenceCase",thisFiscalPeriod:"AF_Option_ThisFiscalPeriod_SentenceCase",nextFiscalPeriod:"AF_Option_NextFiscalPeriod_SentenceCase",lastXFiscalPeriods:"AF_Option_LastXFiscalPeriods_SentenceCase",nextXFiscalPeriods:"AF_Option_NextXFiscalPeriods_SentenceCase",inFiscalPeriodAndYear:"AF_Option_InFiscalPeriodAndYear_SentenceCase",inOrAfterFiscalPeriodAndYear:"AF_Option_InOrAfterFiscalPeriod_SentenceCase",inOrBeforeFiscalPeriodAndYear:"AF_Option_InOrBeforeFiscalPeriod_SentenceCase",containValues:"Web._tools.search.search.js_17_4_SentenceCase",doesNotContainValues:"Web._tools.search.search.js_17_5_SentenceCase",equalsCurrentUserLanguage:"AF_Option_EqUserLanguage_SentenceCase",isCurrentUser:"Web._tools.search.search.js_17_0_SentenceCase",notCurrentUser:"Web._tools.search.search.js_17_1_SentenceCase",isCurrentBusinessUnit:"Web._tools.search.search.js_19_1_SentenceCase",notCurrentBusinessUnit:"Web._tools.search.search.js_19_2_SentenceCase",under:"Web.SFA.Workflow.UnderOperator",notUnder:"Web.SFA.Workflow.NotUnderOperator",above:"ViewDesigner.RecordFilter.above",viewAll:"CustomControl_Calendar_ViewMore",aboveOrEqual:"ViewDesigner.RecordFilter.eq_or_above_SentenceCase",underOrEqual:"ViewDesigner.RecordFilter.eq_or_under_SentenceCase",isCurrentUserOrReportingHierarchy:"OwnershipOperator_EqualsCurrentUserOrHierarchy_SentenceCase",isCurrentUserAndTeamsOrReportingHierarchyAndTeams:"OwnershipOperator_EqualsCurrentUserOrHierarchyAndTeams_SentenceCase",isCurrentUserTeams:"OwnershipOperator_EqualsCurrentUserTeams_SentenceCase",isCurrentUserOrTeams:"OwnershipOperator_EqualsCurrentUserOrUserTeams_SentenceCase",loadingResults:"Grid_AdvancedFilter_LoadingResults",noResults:"KMControl.SearchKMArticles.NoResults",errorNoValues:"AF_Error_NoValues",inputControlLabel:"Web.SFA.Workflow.AssignValueDialog.Value",removeButtonAriaLabel:"Dialog_Disassociate_Header",noValue:"Grid_AdvancedFilter_NoValue",minValue:"Grid_AdvancedFilter_MinValue",maxValue:"Grid_AdvancedFilter_MaxValue",maxPrecision:"Grid_AdvancedFilter_MaxPrecision",maxLength:"Grid_AdvancedFilter_MaxLength",incorrectDataType:"Grid_AdvancedFilter_IncorrectDataType",durationUnit:"Grid_AdvancedFilter_durationUnit"},s=Object.values(a),o={dropDownOptionsAll:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsAll",dropDownOptionsDefault:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsDefault",dropDownOptionsCustom:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsCustom",fieldContextMenuRemove:"Grid_AdvancedFilter_ColumnEditor_FieldContextMenuRemove",addColumn:"Grid_AdvancedFilter_ColumnEditor_AddColumn",editColumns:"Grid_AdvancedFilter_ColumnEditor_EditColumns",apply:"Grid_AdvancedFilter_ColumnEditor_Apply",cancel:"Grid_AdvancedFilter_ColumnEditor_Cancel",search:"Grid_AdvancedFilter_ColumnEditor_Search",related:"Grid_AdvancedFilter_ColumnEditor_Related",moveUp:"Grid_AdvancedFilter_ColumnEditor_MoveUp",moveDown:"Grid_AdvancedFilter_ColumnEditor_MoveDown",resetToDefault:"Grid_AdvancedFilter_ColumnEditor_ResetToDefault",close:"Grid_AdvancedFilter_ColumnEditor_Close",listAriaLabel:"Grid_AdvancedFilter_ColumnEditor_AttributesListLabel",columnEditor:"Grid_AdvancedFilter_ColumnEditor_ColumnEditor",saveAsNewView:"Grid_AdvancedFilter_ColumnEditor_SaveAsNewView",saveChangesToCurrentView:"Grid_AdvancedFilter_ColumnEditor_SaveChangesToCurrentView",noFieldsToDisplay:"Grid_AdvancedFilter_ColumnEditor_NoFieldsToDisplay",moreOptions:"Grid_AdvancedFilter_ColumnEditor_MoreOptions",dropdown:"Grid_AdvancedFilter_ColumnEditor_Dropdown"},c=Object.values(o),l={ApplyAdvancedFiltersTitle:"Grid_AdvancedFilter_ApplyAdvancedFiltersTitle",ApplyAdvancedFiltersAria:"Grid_AdvancedFilter_ApplyAdvancedFiltersAriaLabel",CancelEditingFiltersAria:"Grid_AdvancedFilter_CancelEditingAdvancedFiltersAriaLabel",OpenAdvancedFiltersTitleAndAria:"Grid_AdvancedFilter_OpenAdvancedFilterTitleAndAria",resetToDefault:"Grid_AdvancedFilter_ColumnEditor_ResetToDefault"},u=Object.values(l),d=[...i,...s,...u]},bGh0:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("PUjk"),i=n("HcnX"),a=n("odYE"),s=n("Khp3");class o{constructor(e,t,n,r){this.eventName="BusinessRuleRecommendation_"+e,this.eventParameters=[{name:"EntityTypeName",value:t},{name:"FieldName",value:n},{name:"Title",value:r}]}}var c=n("qshH"),l=n("16wZ"),u=n("i1f0"),d=n("LbMF"),p=n("Qn2w"),h=n("SAYH"),g=n("uhZ3"),m=n("IaGr");var b=n("ZIjf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let y;class f extends i.a{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),this._entityAttribute=null,y=e,this.registerObserversForControlStateChange()}getAttribute(){const e="ClientApi.XrmDataControl.getAttribute";try{if(b.a.instance.reportCall(e),!this._entityAttribute){let e;if(this.formContext&&this.formContext.data&&this.formContext.data.entity&&(e=this.controlDescriptor&&this.controlDescriptor.Relationship?this.formContext.data.entity.relatedEntities.get(this.controlDescriptor.Relationship):this.formContext.data.entity),this.controlDescriptor&&this.controlDescriptor.DataFieldName&&this.formContext&&this.formContext.data)if(this.controlDescriptor.IsUnbound)this._entityAttribute=this.formContext.data.attributes.get(this.controlDescriptor.DataFieldName);else{const t=e?e.attributes:this.formContext.data.attributes;this._entityAttribute=t.get(this.controlDescriptor.DataFieldName)}}return b.a.instance.reportSuccess(e),this._entityAttribute}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}updateAttribute(e,t){const n="ClientApi.XrmDataControl.updateAttribute";try{if(b.a.instance.reportCall(n),e&&t&&this.controlDescriptor&&this.controlDescriptor.Relationship===t){this._entityAttribute=null;const t=e.attributes;t&&(this._entityAttribute=t.get(this.controlDescriptor.DataFieldName))}this._entityAttribute&&this._entityAttribute.controls.add(this.name,this),b.a.instance.reportSuccess(n)}catch(e){const t=c.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(n,e,null,t),e}}addNotification(e){const t="ClientApi.XrmDataControl.addNotification";try{if(b.a.instance.reportCall(t),this._isValidNotification(e)&&this.getVisible()){const n={uniqueId:e.uniqueId?e.uniqueId:"",messages:e.messages,notificationLevel:e.notificationLevel,actions:e.actions};return"RECOMMENDATION"===e.notificationLevel?this._reportAddNotificationEvent(e):y.dispatch(Object(p.b)(this.pageId,this.getName(),!1,this.contextToken)),y.dispatch(Object(s.b)(this.pageId,this.getName(),n,this.contextToken)),b.a.instance.reportSuccess(t),!0}return b.a.instance.reportSuccess(t),!1}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}_clearControlNotification(e){const t=Object(u.A)(y.getState(),{controlName:this.name,id:this.pageId},this.contextToken);if(t){const n=Object.keys(t);let r=null;if(e){if(r=t[e],!(r&&r.messages&&r.notificationLevel))return!1;this._clearNotification(r)}else(Object(l.a)(e)||0===e.trim().length)&&n.forEach(e=>{r=t[e],this._clearNotification(r)});return!0}return!1}_clearNotification(e){e.actions=null,e.messages=null,e.notificationLevel=null,y.dispatch(Object(s.b)(this.pageId,this.name,e,this.contextToken))}clearNotification(e){const t="ClientApi.XrmDataControl.clearNotification";try{b.a.instance.reportCall(t);const n=!!this._clearControlNotification(e);return b.a.instance.reportSuccess(t),n}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}setNotification(e,t){const n="ClientApi.XrmDataControl.setNotification";try{b.a.instance.reportCall(n);const r={uniqueId:t,messages:[e],priority:0,notificationLevel:"ERROR",actions:[{actions:[function(){}],message:""}]};return b.a.instance.reportSuccess(n),this.addNotification(r)}catch(e){const t=c.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(n,e,null,t),e}}_isValidNotification(e){return!(!e||!e.messages||Object(g.b)(e.messages[0]))&&("RECOMMENDATION"===e.notificationLevel||"ERROR"===e.notificationLevel)}_reportAddNotificationEvent(e){if(!this._isValidNotification(e))return;const t=e.messages[0],n=new o("Added",this.contextToken.entityTypeName,this.getName(),t);var r;y.dispatch((r=n,{type:"report.xrm.event",execute(e,t){try{c.a.getInstance().reportEvent(r)}catch(e){const t="ClientApi.ReportXrmEventAction.reportXrmEvent";m.a.getInstance().eventManager.ReportComponentFailure(t,e),Object(l.j)(t,"XrmReporting")}return Promise.resolve()}}))}getEntityReference(){const e=this.formContext.entityReference,t=e.id?new h.a(e.id):null;return new a.a(e.entityType,t)}registerObserversForControlStateChange(){if(this.getName().startsWith("header_process")){const e=Object(r.a)(this.pageId);e&&this.controlStateObservable.registerObserver(e)}}getAttrDescriptor(e,t,n){const r=this.getEntityReference().etn;let i=Object(u.r)(y.getState(),r,this.name,this.pageId,this.contextToken);return i||(this.controlDescriptor?this.controlDescriptor.DataFieldName?(m.a.getInstance().traceManager.getTracer(e).warn("ControlAttributeDescriptor was not found, falling back to the attribute descriptor.",t),i=Object(d.a)(y.getState(),r,this.controlDescriptor.DataFieldName),i||(t.push({name:"attributeName",value:this.controlDescriptor.DataFieldName}),t.push({name:"entityName",value:r}),n.reportFailure(e,new Error("Attribute descriptor was not found"),t))):n.reportFailure(e,new Error("Control descriptor did not have a DataFieldName"),t):n.reportFailure(e,new Error("Control descriptor was not found"),t)),i}}},bJaF:function(e,t,n){"use strict";n.d(t,"a",(function(){return ot}));var r,i=n("DRVD"),a=n.n(i),s=n("arV0"),o=n("TAjd"),c=n("uNu9"),l=n("uNLT"),u=n("tT9w"),d=n("ofgb"),p=n("+hq9"),h=n("Uv1Y"),g=n("SAYH"),m=n("+nNZ"),b=n("7tM0");!function(e){e[e.None=0]="None",e[e.Processing=1]="Processing",e[e.Completed=2]="Completed",e[e.Failure=3]="Failure",e[e.Invalid=4]="Invalid"}(r||(r={}));class y{constructor(e,t){this._getState=e,this._processId=t}GenerateMessageForAction(e){let t="";const n="cc_MscrmControls.Containers.ProcessBreadCrumb/strings/ProcessControlResources",i=this._getState(),a=Object(b.a)(i,n,"ProcessControl_ActionExecuter_ExecutionTimeTooltip"),s=Object(b.a)(i,n,"ProcessControl_ActionExecuter_ErrorMessageTooltip"),o=Object(b.a)(i,n,"Crm_GenericErrorMessage");switch(e){case r.Completed:t=String.format(a,(new Date).toLocaleString());break;case r.Failure:t=String.format(a,(new Date).toLocaleString())+"\n"+String.format(s,o)}return t}GetActionMetadata(e){const t=Object(m.a)(this._getState(),new g.a(this._processId.guid));let n;return t&&t.businessProcessFlowActions&&t.businessProcessFlowActions[e]&&(n=t.businessProcessFlowActions[e]),n}InvokeProcessAction(e,t,n){return Xrm.Utility.invokeProcessActionInternal(e,n,t)}}var f=n("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function S(e){if(!e)return null;const t=function(e){const t=[];return e.forEach(e=>{const n={id:g.a.tryParse(e.Id),primaryField:e.PrimaryField,entityTypeCode:e.EntityTypeCode,entityLogicalName:e.EntityLogicalName,primaryKeyName:e.PrimaryKeyName};t.push(n)}),t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e.NavigationEntities);return{entityDisplayName:e.EntityDisplayName,entityLogicalName:e.EntityLogicalName,entityTypeCode:e.entityTypeCode,showCreate:e.ShowCreate,navigationEntities:t}}function v(e,t,n,r){return{type:"businessProcessFlow.retrieveNavigationEntities.async",execute:({dispatch:i,getState:a},s)=>function(e,t,n,r,i){return e.retrieveNavigationEntities(t,n,r,i,null).nativePromise().then(S,h.b)}(s.DataSource,e,t,n,r)}}var C=n("rodW"),O=n("bCAK"),_=n("LFkE");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class I{constructor(e,t){this.Target=e,this.NewProcess=t}getMetadata(){return{boundParameter:null,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcess:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}},operationName:"SetProcess",operationType:0}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class j{constructor(e,t,n){this.Target=e,this.NewProcess=t,this.NewProcessInstance=n}getMetadata(){return{boundParameter:null,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcess:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcessInstance:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}},operationName:"SetProcess",operationType:0}}}var P=n("w72X"),F=n("EHQq");function T(e,t,n,r,i,a){return{type:"businessProcessFlow.navigateToNextEntity.async",execute:({dispatch:s,getState:o},c)=>function(e,t,n,r,i,a,s){const o=new F.a(g.a.toLegacyGuid(t.id),t.etn,g.a.toLegacyGuid(n.id),n.etn,g.a.toLegacyGuid(r),i,g.a.toLegacyGuid(a),g.a.toLegacyGuid(s));return e.execute(o,null).nativePromise()}(c.DataSource,e,t,n,r,i,a)}}var w=n("sNgR");class E{constructor(e,t){this.EntityId=e,this.EntityLogicalName=t}getMetadata(){return{boundParameter:null,parameterTypes:{EntityId:{typeName:"Edm.Guid",structuralProperty:1},EntityLogicalName:{typeName:"Edm.String",structuralProperty:1}},operationName:"RetrieveProcessInstances",operationType:1}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class x{constructor(e,t){this.EntityLogicalName=e,this.AppModuleId=t}getMetadata(){return{boundParameter:null,parameterTypes:{EntityLogicalName:{typeName:"Edm.String",structuralProperty:1},AppModuleId:{typeName:"Edm.Guid",structuralProperty:1}},operationName:"RetrieveFilteredProcesses",operationType:1}}}var N=n("E5IU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class A{constructor(e,t,n){this._name=e,this._uniqueName=t,this._workflowId=n}get workflowId(){return this._workflowId}set workflowId(e){this._workflowId=e}get uniqueName(){return this._uniqueName}set uniqueName(e){this._uniqueName=e}get name(){return this._name}set name(e){this._name=e}}var k=n("WPtp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class M{get activeStageId(){return this._activeStageId}set activeStageId(e){this._activeStageId=e}set businessProcessInstanceId(e){this._businessProcessInstanceId=e}get businessProcessInstanceId(){return this._businessProcessInstanceId}get businessProcessInstanceName(){return this._businessProcessInstanceName}set businessProcessInstanceName(e){this._businessProcessInstanceName=e}get businessProcessState(){return this._businessProcessState}set businessProcessState(e){this._businessProcessState=e}get businessProcessStatus(){return this._businessProcessStatus}set businessProcessStatus(e){this._businessProcessStatus=e}get navigationEntities(){return this._navigationEntities}set navigationEntities(e){this._navigationEntities=e}get traversedPath(){return this._traversedPath}set traversedPath(e){this._traversedPath=e}get bpfDefinitionVersionNumber(){return this._bpfDefinitionVersionNumber}set bpfDefinitionVersionNumber(e){this._bpfDefinitionVersionNumber=e}}var D=n("sxfa");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class R{get id(){return this._id}set id(e){this._id=e}get primaryField(){return this._primaryField}set primaryField(e){this._primaryField=e}get entityTypeCode(){return this._entityTypeCode}set entityTypeCode(e){this._entityTypeCode=e}get entityLogicalName(){return this._entityLogicalName}set entityLogicalName(e){this._entityLogicalName=e}get primaryKeyName(){return this._primaryKeyName}set primaryKeyName(e){this._primaryKeyName=e}}var B,L=n("hvSt");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.Active=0]="Active",e[e.Inactive=1]="Inactive"}(B||(B={}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class V{constructor(e){this._stageManager=e,this._populateTraversedPath()}getTraversedPath(){return this._traversedPath}_populateTraversedPath(){this._traversedPath=this._stageManager.globalPathAndActiveStage.traversedPath.path}}var z=n("blB4"),H=n("UuJw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class G extends Error{constructor(e){super(e),this.navigationStatus=z.a.invalid,this.stageInvalidReason=H.a.invalid,Object.setPrototypeOf(this,G.prototype)}}Error;class W extends Error{constructor(e){super(e),this.stageInvalidReason=H.a.unreachable,Object.setPrototypeOf(this,W.prototype)}}class U extends Error{constructor(e){super(e),this.navigationStatus=z.a.dirtyForm,this.stageInvalidReason=H.a.dirtyForm,Object.setPrototypeOf(this,U.prototype)}}class q extends Error{constructor(e){super(e),this.navigationStatus=z.a.end,Object.setPrototypeOf(this,q.prototype)}}class X extends Error{constructor(e){super(e),this.navigationStatus=z.a.beginning,Object.setPrototypeOf(this,X.prototype)}}class Y extends Error{constructor(e){super(e),this.navigationStatus=z.a.stageGate,Object.setPrototypeOf(this,Y.prototype)}}class K extends Error{constructor(e){super(e),this.navigationStatus=z.a.invalidProcess,this.stageInvalidReason=H.a.invalidProcess,Object.setPrototypeOf(this,K.prototype)}}class Q extends Error{constructor(e){super(e),this.navigationStatus=z.a.dirtyForm,this.stageInvalidReason=H.a.dirtyForm,Object.setPrototypeOf(this,Q.prototype)}}var Z=n("odYE"),J=n("mL5Q"),$=n("f/sd"),ee=n("53SR"),te=n("nexV"),ne=n("quej"),re=n("ijzp"),ie=n("WY/A"),ae=n("sX6v"),se=n("P+kM"),oe=n("YYhu"),ce=n("srnJ"),le=n("5Oca"),ue=n("Dea/"),de=n("dHD5"),pe=n("bT7G"),he=n("e3W2"),ge=n("WePp");class me extends ge.a{constructor(e,t,n){super("BusinessProcessFlow_"+e),this.addEventParameter("ProcessId",t),this.addEventParameter("ProcessInstanceId",n)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class be extends me{constructor(e,t){super("Initialized",e,t)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ye extends me{constructor(e,t,n){super("SetActiveStageEvent",e,t),this.addEventParameter("ActiveStageId",n)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class fe extends me{constructor(e,t,n){super("DisplayStateEvent",e,t),this.addEventParameter("CurrentDisplayState",n)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Se extends me{constructor(e,t,n,r){super("StatusEvent",e,t),this.addEventParameter("ProcessStatus",n),this.addEventParameter("CurrentDisplayState",r)}}var ve=n("uzi5"),Ce=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Oe{getMetadata(){return{boundParameter:"entity",operationName:"ExecuteWorkflow",operationType:0,parameterTypes:{entity:{typeName:"Microsoft.Dynamics.CRM.workflow",structuralProperty:5},EntityId:{typeName:"Edm.Guid",structuralProperty:1},InputArguments:{typeName:"Microsoft.Dynamics.CRM.InputArgumentCollection",structuralProperty:2}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class _e{getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Type:{typeName:"Edm.String",structuralProperty:1},Value:{typeName:"Edm.String",structuralProperty:1}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Ie{getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Count:{typeName:"Edm.Int32",structuralProperty:1},IsReadOnly:{typeName:"Edm.Boolean",structuralProperty:1},Keys:{typeName:"Edm.String",structuralProperty:4},Values:{typeName:"mscrm.AnyComplexType",structuralProperty:4}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class je{getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Arguments:{typeName:"Microsoft.Dynamics.CRM.InputArgument",structuralProperty:2}}}}}var Pe,Fe=n("+XGO"),Te=n("mIxf"),we=n("AFlp"),Ee=n("k1f1");!function(e){e[e.ProcessAction=0]="ProcessAction",e[e.TaskFlow=1]="TaskFlow",e[e.SyncWorkflow=2]="SyncWorkflow",e[e.AsyncWorkflow=3]="AsyncWorkflow",e[e.MessageAction=4]="MessageAction"}(Pe||(Pe={}));var xe=n("D4Jo"),Ne=n("JF0K"),Ae=n("iZ7K"),ke=n("JP46");var Me=n("ghNp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var De=n("VcAV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Re{constructor(e,t){this._getState=e,this._applicationContext=t}setBpfInstance(e){return this._processInstance=e,this}setBpfInstanceName(e){return this._processInstanceName=e,this}setProcess(e){return this._process=e,this}setProcessId(e){return this._processId=e,this}setFormEntity(e){return this._formEntity=e,this}GetFlowStepMetadata(e,t){const n=t.TraceManager.getTracer("businessProcessFlow.flowStepManager"),r=this._processId&&this._processId.guid||null,i=Object(m.a)(this._getState(),g.a.tryParse(r));if(Object(De.c)(i))return n.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined bpfDescriptor: "+i),null;const a=i.businessProcessFlowFlows;if(Object(De.c)(a))return n.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined businessProcessFlowFlows: "+a),null;const s=a[e];return Object(De.c)(a)?(n.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined flowStepDescriptor: "+s),null):s}openFlowWidget(e,t){if(g.a.tryParse(e.flowStepId)===g.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty flowStepId: "+e.flowStepId);const n=this._populateFlowDialogParams(e,t),r={height:600,width:600};Xrm.Navigation.openDialog("MicrosoftFlowsDialog",r,n)}_populateFlowDialogParams(e,t){const n=this.GetFlowStepMetadata(e.flowStepId,this._applicationContext);if(Object(De.c)(n))throw new Error("BPF Flow Step Failure: null metadata");const r={},i=n.flowId;if(Object(De.c)(i))throw new Error("BPF Flow Step Failure: null metadata.flowId");if(!this._processInstance&&!this._processInstance.id){const e=[];e.push(this._processInstance.id.guid);const t=JSON.stringify(e);r.entity_ids=t}r.flow_id=i,r.org_unique_name=Xrm.Utility.getGlobalContext().getOrgUniqueName(),r.bpf_step_id=e.flowStepId;const a=Xrm.Page.data.entity.getEntityName(),s=this._getState().metadata.entities[a].EntitySetName,o=Xrm.Utility.getGlobalContext().getAdvancedConfigSetting("MicrosoftFlowDestinationUrl");r.entity_logical_collection_name=s,r.entity_logical_name=a,r.flows_destination_url=o,r.dynamics365_access_token=sessionStorage.getItem("dynamics365AccessToken");const c=Xrm.Utility.getGlobalContext().getAdvancedConfigSetting("MicrosoftFlowFirstPartyIntegrationSiteUrl");r.flows_fpi_site_url=c+"&flowsEnableWidgetV2=true",r.flows_authentication_string=this._getLocalizedLabel("SystemCustomization.SystemSettingsDialog.PreviewTab.IsMicrosoftFlowEnabled.AuthenticateButton.Text"),r.flows_enable_widget_v2=!0,Re.UpdateEventParameter(t,"flows_destination_url",o),Re.UpdateEventParameter(t,"flow_id",i),Object(De.c)(e.workflowLogId)||e.workflowLogId===g.a.EMPTY||(r.flows_wflog_id=g.a.toString(e.workflowLogId));const l=this._processInstance&&this._processInstance.id;if(Object(De.c)(l)||l===g.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty processInstanceId: "+l);r.bpf_instance_id=g.a.toString(l);const u=this._processInstance&&this._processInstance.etn;if(Object(Ce.b)(u))throw new Error("BPF Flow Step On-Click Failure: null or empty processInstanceEntityLogicalName: "+u);r.bpf_instance_entity_name=u;const d=this._processId&&this._processId.guid||null;if(g.a.tryParse(d)===g.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty processId: "+d);r.bpf_definition_id=d,r.bpf_definition_entity_name="workflow";const p=this._process&&this._process.get_Name();if(Object(Ce.b)(p))throw new Error("BPF Flow Step On-Click Failure: null or undefined bpfDefinitionName: "+p);if(r.bpf_definition_name=p,Object(Ce.b)(this._processInstanceName))throw new Error("BPF Flow Step On-Click Failure: null or undefined processInstanceName: "+this._processInstanceName);r.bpf_instance_name=this._processInstanceName;const h=e.selectedStage&&e.selectedStage.get_Description();if(Object(Ce.b)(h))throw new Error("BPF Flow Step On-Click Failure: null or undefined flowStageName: "+h);r.bpf_flowstage_localized_name=h,r.bpf_flowstage_entity_name=a,r.bpf_flowstage_entity_collection_name=s;const m=this._formEntity&&this._formEntity.id;if(Object(De.c)(m)||m===g.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty flowStageRecordId: "+m);r.bpf_flowstage_entity_record_id=g.a.toString(m);const b=g.a.tryParseOrNull(e.activeStage&&e.activeStage.get_Id()||"");if(Object(De.c)(b)||b===g.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty activeStageId: "+b);r.bpf_activestage_id=g.a.toString(b);const y=e.activeStage&&e.activeStage.get_Description();if(Object(Ce.b)(y))throw new Error("BPF Flow Step On-Click Failure: null or undefined activeStageName: "+y);return r.bpf_activestage_localized_name=y,r.bpf_activestageentity_name="processstage",r}_getLocalizedLabel(e){return Xrm.Utility.getResourceString("Main_system_library",e)}static getTelemetryParamsForFlowStep(e,t,n,r,i){const a=i||[],s={name:"flow_id",value:e},o={name:"environment_id",value:t},c={name:"flows_destination_url",value:n},l={name:"bpf_step_id",value:r};return a.push(s),a.push(o),a.push(c),a.push(l),a}static UpdateEventParameter(e,t,n){e&&0!==e.length&&e.some(e=>{if(e.name===t)return e.value=n,!0})}}var Be=n("Lyxw"),Le=n("7LBy"),Ve=n("ftQm"),ze=n("2Ct/"),He=n("84PK"),Ge=n("Exmh"),We=n("cfbi"),Ue=n("pF61");var qe=n("8O0c"),Xe=n("g6bs"),Ye=n("zmL5"),Ke=n("jq7Z"),Qe=n("xMtD"),Ze=n("7Sr4"),Je=n("1uZV"),$e=n("tICD"),et=n("E8F2"),tt=n("UqQu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const nt=a.a.createEvent("Initialize","BusinessProcessFlow.ProcessManager"),rt=a.a.createEvent("SetActiveStage","BusinessProcessFlow.ProcessManager"),it=a.a.createEvent("ValidateRequiredFields","BusinessProcessFlow.ProcessManager"),at=a.a.createEvent("CreateActiveStageSnapshot","BusinessProcessFlow.ProcessManager"),st=a.a.createEvent("SaveFormAndActiveStage","BusinessProcessFlow.ProcessManager");class ot{constructor(e,t,n,r,i){this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isUserSelectedStage=!1,this._isBpfFormValid=null,this._applicationContext=e,this._getState=t,this._dispatch=n,this._stageMetadata=r,this._activeStageManager=i}initilaizeWithProcessAndFormEntity(e,t,n,r,i,a){const s=nt.startStopwatch({processId:g.a.toString(r),processInstanceId:g.a.toString(i.id)});this._currentPageId=a,this._processId=r,this._version=t.businessProcessFlowProcessVersion,this._currentFormEntity=n,this._currentBpfInstance=i,this._stageMetadata.setPrimaryModel(this._currentFormEntity.etn),this._stageMetadata.setObjectModel(t);const o=this._createGlobalNavigationData(e);this._activeStageManager.InitGlobalPathAndActiveStage(o),this._stageMetadata.initializeDefaultPathManager(new V(this._activeStageManager),this),this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isBpfFormValid=null;const c={};if(this._isUserSelectedStage)c.selectedStageId=g.a.tryParseOrNull(this.getSelectedStageId());else{const e=this.getActiveStageId();this._isActiveStageInCurrentEntity(e)?c.selectedStageId=g.a.tryParseOrNull(e):c.selectedStageId=this._getDefaultSelectedStageId()||g.a.tryParseOrNull(e)}this._dispatch(Object(ee.a)(c,this._currentBpfInstance));const l=new be(g.a.toString(r),g.a.toString(i.id));this._applicationContext.EventManager.ReportEvent(l),this._savedPageId!==a&&(this._savedPageId=a,this.getScriptContainerPromise().then(e=>{e&&e.getEventManager().addOnProcessChangeEvent(this.getContextToken(),()=>{this._saveCrossEntityBpf()})})),Object(ze.f)(this._getState())||this._updateProcessInstanceModifiedTime(),this._actionStepManager=new y(this._getState,r),this._flowStepManager=new Re(this._getState,this._applicationContext).setBpfInstance(this._currentBpfInstance).setProcess(this.getProcess()).setProcessId(this.getProcessId()).setFormEntity(this._currentFormEntity).setBpfInstanceName(this.getProcessInstanceName()),this._instanceModifiedTimestamp=Object(m.f)(this._getState(),this._currentFormEntity),this._instanceModifiedTimestamp||(this._instanceModifiedTimestamp=(new Date).getTime()),Object(ze.f)(this._getState())&&Ve.a.Instance.setProcessManagerByPageId(this._currentPageId,this);const u=this.getTelemetryParams();if(!this._currentFormEntity){this._applicationContext.TraceManager.getTracer(Ne.g).error("ProcessManager is initialized with current entity as null",u)}Object(xe.c)(Ne.g,u,this._applicationContext),s()}_saveCrossEntityBpf(){const e=this._getState(),t=Object(s.g)(e,this._currentPageId),n=Object(Le.a)(t),r=Object(Le.b)(t);if(n&&r){const e=new Z.a(t.data.parentrecordtype,new g.a(t.data.parentrecordid)),i=new Z.a(t.entityTypeName,t.id);this._dispatch(Object(we.b)(n,i)),this._dispatch(Object(Ee.b)(r,i)),this.navigateToNextEntityForCrossEntityBpf(e,i,n,r)}}initilaizeWithFormEntityOnly(e,t){this._currentPageId=t,this._currentFormEntity=e,this._processId=null,this._version=-1,this._currentBpfInstance=null,this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isBpfFormValid=null,Object(ze.f)(this._getState())||this._updateProcessInstanceModifiedTime(),Object(ze.f)(this._getState())&&Ve.a.Instance.setProcessManagerByPageId(this._currentPageId,this);const n=this.getTelemetryParams();if(!this._currentFormEntity){this._applicationContext.TraceManager.getTracer(Ne.f).error("ProcessManager is initialized with current entity as null",n)}Object(xe.c)(Ne.f,n,this._applicationContext)}setActiveProcess(e){return new Promise((t,n)=>{const r=this.getTelemetryParams();if(!this.getCurrentFormEntity()){const e=new h.a("Current form entity is not initialized.",2147877745);return Object(xe.b)(Ne.m,e,null,r,this._applicationContext,null,this._getState()),void n(new h.a("Current form entity is not initialized",2147877745))}const i=g.a.tryParseOrNull(e);if(!i)return Object(xe.c)(Ne.m,r,this._applicationContext),void n(new Error("Invalid process id"));if(g.a.isNullOrEmpty(this.getCurrentFormEntity().id))return Object(xe.c)(Ne.m,r,this._applicationContext),void n(new h.a("Not supported on new records",2147877748));const a=new I({id:g.a.toString(this.getCurrentFormEntity().id),entityType:this.getCurrentFormEntity().etn},{id:g.a.toString(i),entityType:c.fc});this._dispatch(Object(P.b)(a)).then(()=>{this._executePostEvent("runOnProcessChange","setActiveProcess"),Object(xe.c)(Ne.m,r,this._applicationContext),t()},e=>{this._dispatch(Object(u.b)(e,!0)).then(()=>n(e)),Object(xe.b)(Ne.m,e,null,r,this._applicationContext,null,this._getState())})})}setActiveProcessInstance(e){return new Promise((t,n)=>{const r=this.getTelemetryParams();if(!this.getCurrentFormEntity()){const e=new h.a("Current form entity is not initialized.",2147877745);return Object(xe.b)(Ne.n,e,null,r,this._applicationContext,null,this._getState()),void n(new h.a("Current form entity is not initialized",2147877745))}const i=g.a.tryParseOrNull(e);i?this.getProcessInstances().then(e=>{if(!e||!e.value)return void n(new Error("No process instances found for current entity"));let r="";for(const t of e.value)if(t&&t.businessprocessflowinstanceid&&t.businessprocessflowinstanceid.toLowerCase()===g.a.toString(i).toLowerCase()){r=t["a_processid_value".substring(1)];break}if(Object(Ce.b)(r))return void n(new h.a("Supplied process instance does not match any existing instance on this entity",2147877744));const a=g.a.tryParseOrNull(r);if(!a)return void n(new Error("Invalid process id"));const s=new j({id:g.a.toString(this.getCurrentFormEntity().id),entityType:this.getCurrentFormEntity().etn},{id:g.a.toString(a),entityType:c.fc},{id:g.a.toString(i),entityType:c.fc});this._dispatch(Object(P.b)(s)).then(()=>{this._executePostEvent("runOnProcessChange","setActiveProcessInstance"),t(r)},e=>{this._dispatch(Object(u.b)(e,!0)).then(()=>n(e))})},e=>{this._dispatch(Object(u.b)(e,!0)).then(()=>n(e))}):n(new Error("Invalid process instance id"))})}setCurrentInstance(e){this._currentBpfInstance=e}setStatus(e){return new Promise((t,n)=>{let r;if(e||n(new Error("setStatus can only be called with a valid status (active, finished, aborted")),e===L.a.Active)r=this.reactivateProcess();else if(e===L.a.Finished)r=this.completeProcess();else{if(e!==L.a.Aborted)return n(new Error("Invalid status passed to setStatus"));r=this.abandonProcess()}r.then(()=>{const n=new Se(g.a.toString(this._processId),g.a.toString(this.getProcessInstanceId()),e,this.getDisplayState());this._applicationContext.EventManager.ReportEvent(n),t()},e=>{n(e)})})}setVisible(e){if(Object(Ce.a)(this._currentBpfInstance)||Object(Ce.a)(this._currentFormEntity)||Object(Ce.a)(this._currentFormEntity.etn))return;const t=Object(de.h)(this._currentFormEntity.etn);this._dispatch(Object(he.b)(this._currentPageId,ve.a,t,!0===e)),this._updateProcessInstanceModifiedTime()}isVisible(){if(!this._currentBpfInstance)return!1;const e=Object(de.h)(this._currentFormEntity.etn);return!0===Object(f.G)(this._getState(),{id:this._currentPageId,controlName:ve.a},e)}getCurrentFormEntity(){return this._currentFormEntity}getActiveStageEntityRef(){const e=this._getStage(this.getActiveStageId()),t=e&&e.get_parent()&&e.get_parent().get_Name()||null,n=this._getNavigationEntityIdsByEntityLogicalName();return t&&n&&n.hasOwnProperty(t)?new Z.a(t,n[t]):null}getProcess(){return this._currentBpfInstance&&this._stageMetadata.getProcessObjectModel()}getProcessInstanceName(){return this._currentBpfInstance&&Object(O.e)(this._getState(),this._currentBpfInstance)}getTraversedPath(){return Object(O.h)(this._getState(),this._currentBpfInstance)}getProcessId(){return this._processId}getVersion(){return this._version}getProcessInstanceId(){return this._currentBpfInstance&&this._currentBpfInstance.id}getBpfEntityLogicalName(){return this._currentBpfInstance&&this._currentBpfInstance.etn}getEntityStages(){return this._stageMetadata.getEntityStages()}getActiveStage(){return this._getStage(this.getActiveStageId())}getProcessInstances(){return new Promise((e,t)=>{var n,r;this._dispatch((n=this._currentFormEntity.id,r=this._currentFormEntity.etn,{type:"businessProcessFlow.retrieveProcessInstancesRequest.async",execute({dispatch:e,getState:t},i){const a=i.DataSource.get_WebAPIService(),s=new E(n,r),o=Object(w.a)(t(),s);return a.sendRequest(o).then(e=>e.json(),h.b)}})).then(t=>{e(t)},e=>{t(e)})})}getSelectedStage(){return this._getStage(this.getSelectedStageId())}isCrossEntityNavigation(e){const t=e?this._stageMetadata.getNextStageId(this.getActiveStageId()):this._stageMetadata.getPreviousStageId(this.getActiveStageId());if(!t)return!1;const n=this._stageMetadata.getStage(t);if(!n)return!1;const r=n.get_parent();return this._currentFormEntity&&this._currentFormEntity.etn&&r&&r.get_EntityLogicalName()!==this._currentFormEntity.etn}_isStageOnPath(e,t){for(const n of t)if(g.a.equals(n,e))return!0;return!1}getProcessState(){const e=Object(m.a)(this._getState(),this.getProcessId());return e?e.businessProcessFlowProcessState:null}getState(){if(this._currentBpfInstance){const e=Object(O.f)(this._getState(),this._currentBpfInstance);if(e){const t=parseInt(e.valueString,10);return isNaN(t)?null:t}}return null}getStatusName(){if(this._currentBpfInstance){const e=Object(O.g)(this._getState(),this._currentBpfInstance);if(e){return e.label}}return null}getStatus(){if(this._currentBpfInstance){const e=Object(O.g)(this._getState(),this._currentBpfInstance);if(e){const t=parseInt(e.valueString,10);return isNaN(t)?null:t}}return null}getActiveStageId(){if(this._currentBpfInstance){let e=this._currentBpfInstance&&Object(O.a)(this._getState(),this._currentBpfInstance);if(g.a.isNullOrEmpty(e)&&this._currentBpfInstance&&this._activeStageManager&&this._activeStageManager.globalPathAndActiveStage){const t=this._activeStageManager.globalPathAndActiveStage.stageId;t&&(e=g.a.tryParseOrNull(t))}if(!g.a.isNullOrEmpty(e)){const t=this.getActivePath();if(t&&t.length>0)return this._isStageOnPath(e,t)?e.guid:t[0].guid}}return null}getActivePathStages(){const e=this.getActivePath();if(e){const t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=this._getStage(e[n].guid);return t}return null}getActivePath(){if(!this._currentBpfInstance)return null;let e=Object(_.c)(this._getState(),this.getProcessInstanceId());return e||(e=this._getDefaultActivePath()),e}getDisplayState(){return this._currentBpfInstance?Object(_.d)(this._getState())||o.a.getDefaultDisplayState():null}getSelectedStageId(){if(!this._currentBpfInstance)return null;const e=Object(_.g)(this._getState(),this.getProcessInstanceId());return e?e.guid:this.getActiveStageId()}_getDefaultSelectedStageId(){if(!this._currentBpfInstance)return null;const e=Object(_.g)(this._getState(),g.a.EMPTY);return e&&!this._stageMetadata.getStage(e.guid)?null:e}_isActiveStageInCurrentEntity(e){try{return this._stageMetadata.getStage(e).get_parent().get_Name()===this._currentFormEntity.etn}catch(e){this._applicationContext.EventManager.ReportComponentFailure("ProcessManager._isActiveStageInCurrentEntity",e)}return!0}getStageMetadata(){return this._stageMetadata}isBusinessProcessAborted(){return this.getStatus()===L.a.Aborted}isBusinessProcessCompleted(){return this.getStatus()===L.a.Finished}moveToNextStage(){const e=this.getTelemetryParams(),t=new Promise((e,t)=>{if(Object(Ce.a)(this._currentBpfInstance))return t(new h.a("Process Control does not exist on form.",2147877746));const n=this._stageMetadata.getNextStageId(this.getActiveStageId());if(!n)return void t(new q("Last stage in the active path reached. Next stage does not exist."));e(this._saveMainFormIfImmersiveBpfAndNewRecord().then(()=>this._saveFormDataAndActiveStage(g.a.tryParseOrNull(n),0,"MoveToNextStage")))});return t.then(()=>{Object(xe.c)(Ne.h,e,this._applicationContext)},t=>{this._shouldReportErrorAsSuccess(t)?Object(xe.c)(Ne.h,e,this._applicationContext):Object(xe.b)(Ne.h,t,null,e,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),t}moveToPreviousStage(){const e=this.getTelemetryParams(),t=new Promise((e,t)=>{if(Object(Ce.a)(this._currentBpfInstance))return t(new h.a("Process Control does not exist on form.",2147877746));const n=this._stageMetadata.getPreviousStageId(this.getActiveStageId());if(!n)return t(new X("The first stage in the traversed path reached. Previous stage does not exist."));e(this._saveFormDataAndActiveStage(g.a.tryParseOrNull(n),1,"MoveToPreviousStage"))}).then(()=>{this._stageMetadata.getDefaultPathManager().triggerSubsequentDefaultPathCalculation(this.getActiveStageId())});return t.then(()=>{Object(xe.c)(Ne.i,e,this._applicationContext)},t=>{this._shouldReportErrorAsSuccess(t)?Object(xe.c)(Ne.i,e,this._applicationContext):Object(xe.b)(Ne.i,t,null,e,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),t}setActiveStage(e){const t=rt.startStopwatch({processId:g.a.toString(this.getProcessId()),processInstanceId:g.a.toString(this.getProcessInstanceId()),stageId:e}),n=this.getTelemetryParams(),r=new Promise((t,n)=>{const r=g.a.tryParseOrNull(e),i=this.getTraversedPath();if(Object(Ce.a)(this._currentBpfInstance))return n(new h.a("Process Control does not exist on form.",2147877746));if(!r)return n(new G("setActiveStage can only be called with a valid stage id"));if(!this._stageMetadata.getStage(r.guid))return n(new G("stage id does not exist on any path of the instance"));if(!i)return n(new G("Traversed Path is not present"));if(this.getActiveStageId()===r.guid)return t();const a=new D.a(i);if(!a||!a.isInTraversedPath(e)){return n(this.getActivePath().some(e=>g.a.equals(e,r))?new G("The stage is not in traversed path. Only navigating backwards is supported."):new W("stage id does not exist on the current acitve path of the instance."))}t(this._saveFormDataAndActiveStage(r,1,"SetActiveStage"))}).then(()=>{const t=new ye(g.a.toString(this._processId),g.a.toString(this.getProcessInstanceId()),e);this._applicationContext.EventManager.ReportEvent(t),this._stageMetadata.getDefaultPathManager().triggerSubsequentDefaultPathCalculation(e)});return r.then(()=>{t(),Object(xe.c)(Ne.o,n,this._applicationContext)},e=>{t(),this._shouldReportErrorAsSuccess(e)?Object(xe.c)(Ne.o,n,this._applicationContext):Object(xe.b)(Ne.o,e,null,n,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),r}switchProcess(){}abandonProcess(){const e=this.getTelemetryParams(),t=new Promise((e,t)=>Object(Ce.a)(this._currentBpfInstance)?t(new h.a("Process Control does not exist on form.",2147877746)):this.isBusinessProcessAborted()?e():void e(this._updateStateAndStatusOfProcess(L.a.Aborted,B.Inactive,"AbandonProcess")));return t.then(()=>{Object(xe.c)(Ne.a,e,this._applicationContext)},t=>{this._shouldReportErrorAsSuccess(t)?Object(xe.c)(Ne.a,e,this._applicationContext):Object(xe.b)(Ne.a,t,null,e,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),t}reactivateProcess(){const e=this.getTelemetryParams(),t=new Promise((e,t)=>Object(Ce.a)(this._currentBpfInstance)?t(new h.a("Process Control does not exist on form.",2147877746)):this.getStatus()===L.a.Active?e():void e(this._updateStateAndStatusOfProcess(L.a.Active,B.Active,"ReactivateProcess")));return t.then(()=>{Object(xe.c)(Ne.j,e,this._applicationContext)},t=>{this._shouldReportErrorAsSuccess(t)?Object(xe.c)(Ne.j,e,this._applicationContext):Object(xe.b)(Ne.j,t,null,e,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),t}completeProcess(){const e=this.getTelemetryParams(),t=new Promise((e,t)=>Object(Ce.a)(this._currentBpfInstance)?t(new h.a("Process Control does not exist on form.",2147877746)):this.isBusinessProcessCompleted()?e():g.a.tryParseOrNull(this._stageMetadata.getNextStageId(this.getActiveStageId()))?t(new h.a("Attempt to finish a process not on last stage.",2148081666)):void e(this._saveMainFormIfImmersiveBpfAndNewRecord().then(()=>this._updateStateAndStatusOfProcess(L.a.Finished,B.Inactive,"CompleteProcess"))));return t.then(()=>{Object(xe.c)(Ne.c,e,this._applicationContext)},t=>{this._shouldReportErrorAsSuccess(t)?Object(xe.c)(Ne.c,e,this._applicationContext):Object(xe.b)(Ne.c,t,null,e,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),t}_shouldReportErrorAsSuccess(e){return e instanceof K||(e instanceof Y||(e instanceof q||(e instanceof X||(e instanceof G||(e instanceof W||e instanceof Q)))))}triggerActionStepClick(e){if(Object(Ce.b)(e)){const e=new Error("BPF Action Step Failure: null ControlId");throw Object(xe.b)(Ne.b,e,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),e}const t=this._actionStepManager.GetActionMetadata(e);if(Object(Ce.a)(t)){const e=new Error("BPF Action Step Failure: null metadata");throw Object(xe.b)(Ne.b,e,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),e}const n=this._getState();if(Object(Ce.a)(n)){const e=new Error("BPF Action Step Failure: null state");throw Object(xe.b)(Ne.b,e,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),e}let r=this._getTelemetryParamsForActionStep(t.actionType,e,t.actionId);try{const n=new g.a(t.actionId);if(t.actionType===Pe.AsyncWorkflow||t.actionType===Pe.SyncWorkflow){const i=["BusinessProcessFlowId","BusinessProcessFlowInstanceId","ActionStepId"],a=[this._processId.guid,g.a.toString(this.getProcessInstanceId()),n.guid].map(e=>{const t=new _e;return t.Type="System.String",t.Value=e,t}),s=new Ie;s.Keys=i,s.Values=a,s.Count=3,s.IsReadOnly=!0;const o=new je;o.Arguments=s;const c=new Oe;c.EntityId=this._currentFormEntity.id,c.InputArguments=o,c.entity={id:t.workflowId,entityType:"workflow"},this.UpdateActionLog(n,1),this._dispatch(Object(P.b)(c)).then(()=>{Object(Fe.a)(this._currentPageId,this.getContextToken(),e),this.UpdateActionLog(n,2,this._actionStepManager.GenerateMessageForAction(2)),Object(xe.c)(Ne.b,r,this._applicationContext)},t=>{Object(Fe.a)(this._currentPageId,this.getContextToken(),e),this.UpdateActionLog(n,3,this._actionStepManager.GenerateMessageForAction(3)),Object(xe.b)(Ne.b,t,null,r,this._applicationContext,this.getCurrentFormEntity(),this._getState()),this._dispatch(Object(u.b)(t,!0)).then()})}else if(t.actionType===Pe.ProcessAction){const i=t=>{Object(Fe.a)(this._currentPageId,this.getContextToken(),e),this.UpdateActionLog(n,3,this._actionStepManager.GenerateMessageForAction(3)),Object(xe.b)(Ne.b,t,null,r,this._applicationContext,this.getCurrentFormEntity(),this._getState()),this._dispatch(Object(u.b)(t,!0)).then()},a=i=>{Object(Fe.a)(this._currentPageId,this.getContextToken(),e),this.UpdateActionLog(n,2,this._actionStepManager.GenerateMessageForAction(2));const a=i.get_outputParameters();t.outputBindings.forEach(e=>{if(e.parameterName in a){const t=a[e.parameterName],n=e.boundAttributeName,r={};r[n]={key:n,value:t},this._dispatch(Object(Te.a)(this._currentPageId,r,!1,!0,this._currentFormEntity.etn,this._currentFormEntity.id.guid,null,this.getContextToken()))}}),Object(xe.c)(Ne.b,r,this._applicationContext)},s=r=>{if(r=r?r.parameters:{},this._filterInputArguments(r)){const e={id:g.a.toString(this.getCurrentFormEntity().id),entityType:this.getCurrentFormEntity().etn};r.Target=e,r.BusinessProcessFlowId=this._processId.guid,r.BusinessProcessFlowInstanceId=g.a.toString(this.getProcessInstanceId()),r.ActionStepId=t.actionId,this._actionStepManager.InvokeProcessAction(t.uniqueName,t,r).then(a,i)}else Object(Fe.a)(this._currentPageId,this.getContextToken(),e),this.UpdateActionLog(n,3,this._actionStepManager.GenerateMessageForAction(3))},o={};t.inputBindings.forEach(e=>{const t=Object(k.c)(Object(le.j)(this._getState(),this.getCurrentFormEntity(),e.boundAttributeName));o["ProcessUnification_Arguments_"+e.parameterName]=t}),this._addInputParametersToParamList(t.inputParameters,o),this.UpdateActionLog(n,1),Xrm.Navigation.openDialog(t.workflowId,this._getDialogOptions(),o).then(s,i)}}catch(e){throw 0===r.length&&(r=this.getTelemetryParams()),Object(xe.b)(Ne.b,e,null,r,this._applicationContext,this.getCurrentFormEntity(),this._getState()),e}}triggerFlowStepClick(e,t){t=t;const n=Re.getTelemetryParamsForFlowStep(null,null,null,e,this.getTelemetryParams());try{const t=g.a.newGuid(),r={activeStage:this.getActiveStage(),selectedStage:this.getSelectedStage(),flowStepId:e,workflowLogId:t};this._flowStepManager.openFlowWidget(r,n),this.UpdateActionLog(new g.a(e),1,void 0,t);const i=this.getActionLog(new g.a(e));this.createWorkflowLogRecord(i),Object(xe.c)(Ne.d,n,this._applicationContext)}catch(e){Object(xe.b)(Ne.d,e,null,n,this._applicationContext,this.getCurrentFormEntity(),this._getState())}}refreshFlowStepClick(e){const t=Re.getTelemetryParamsForFlowStep(null,null,null,e,this.getTelemetryParams()),n=this._dispatch(Object(qe.a)(this._processId,this._currentBpfInstance));Promise.resolve(n).then(()=>{this._updateProcessInstanceModifiedTime(),Object(xe.c)(Ne.k,t,this._applicationContext)}).catch(e=>{Object(xe.b)(Ne.k,e,null,t,this._applicationContext,this.getCurrentFormEntity(),this._getState())})}_addInputParametersToParamList(e,t){for(const n of Object.keys(e))"ProcessUnification_Arguments_"+e[n].parameterName in t||(t["ProcessUnification_Arguments_"+e[n].parameterName]=null)}_filterInputArguments(e){if(e&&"last_button_clicked"in e&&"ok_id"===e.last_button_clicked){const t="ProcessUnification_Arguments_";for(const n in e){const r=e[n];if(n.startsWith(t)){e[n.substring(t.length,n.length)]=r}delete e[n]}return!0}return!1}_getDialogOptions(){return{height:450,width:450,position:1}}_createSnapshotRequest(e,t){if(!e)throw new Error("Active stage cannot be null or undefined.");const n=new Z.a("processstage",e),r=this._calculateNewTraversedPath(e),i={activestageid:{reference:n,timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:e.guid}},traversedpath:{value:r,timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:""}}};return this._addFieldsToBPFSnapshotForCreate(i,t)}_addFieldsToBPFSnapshotForCreate(e,t){if(!e||!this._hasBpfInstance())return e;const n=Object(Xe.b)(this._getState(),this._currentFormEntity.etn,this._currentBpfInstance.etn);return n&&(e[n.ReferencingAttribute]={reference:new Z.a(this._currentFormEntity.etn,t),timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}}),e.processid={reference:new Z.a("workflow",this.getProcessId()),timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}},e}generateBPFInstanceSnapshotId(){if(this.isImmersiveBPF()||!Object(Be.c)(this._getState(),"FCB.SplitBPFEntityAndParticipatingEntityCreates"))return null;let e=[],t=null;try{const n=Object(f.ac)(this._getState(),this._currentPageId,this.getContextToken()),r=Object(pe.b)(this._getState(),n);let i=r.identifier&&r.identifier.id||this._currentFormEntity.id;const a=Object(s.g)(this._getState(),this._currentPageId);if(Object(Xe.e)(a))return Object(Xe.f)(this._getState(),n,i,this._dispatch),null;if(!this._hasBpfInstance()||g.a.isNullOrEmpty(this.getProcessId()))return null;if(e=this.getTelemetryParams(),Object(Xe.d)(this._getState(),r.identifier,this._currentPageId))return Object(Xe.f)(this._getState(),n,i,this._dispatch),null;g.a.isNullOrEmpty(i)&&(i=g.a.newGuid(),Object(Xe.f)(this._getState(),n,i,this._dispatch)),t=this._createActiveStageSnapshot(g.a.tryParse(this.getActiveStageId()),i);const o=Object(pe.b)(this._getState(),t);e.push({name:"SnapshotId",value:t}),e.push({name:"Snapshot active changes",value:o&&o.activeChanges&&Object.keys(o.activeChanges).map(e=>"Property: "+e).join("; ")}),this._applicationContext.EventManager.ReportComponentSuccess("ProcessManager.generateBPFInstanceSnapshotId",e)}catch(t){this._applicationContext.EventManager.ReportComponentFailure("ProcessManager.generateBPFInstanceSnapshotId",t,null,e)}return t}_calculateNewTraversedPath(e){let t="";for(const n of this.getActivePath())if(t+=","+n.guid,g.a.equals(n,e))return t.substring(1);return t+=","+e.guid,t.substring(1)}_createActiveStageSnapshot(e,t){const n=this._createSnapshotRequest(e,t),r=at.startStopwatch({processId:g.a.toString(this.getProcessId()),processInstanceId:g.a.toString(this.getProcessInstanceId())});let i=Object(pe.c)(this._getState(),this.getCurrentFormEntity());if(this.isImmersiveBPF()&&!Object(Ce.a)(i)){const e=Object(ae.b)(this._getState(),i.snapshotId,n);return this._dispatch(e),i=Object(pe.c)(this._getState(),this.getCurrentFormEntity()),r(),i.snapshotId}const a=Object(de.h)(this._currentFormEntity.etn),s=Object(de.x)(a),o=Object(ie.b)(this._getState(),this._currentBpfInstance,n,s,this._hasBpfInstance()?ue.a.Create:ue.a.Update),c=o.payload.snapshotId;return this._dispatch(o),r(),c}_hasBpfInstance(){return!this._currentBpfInstance||g.a.isNullOrEmpty(this._currentBpfInstance.id)}_updateStateAndStatusOfProcess(e,t,n){return new Promise((r,i)=>{const a=this._createStatusAndStateUpdateRequest(e,t);let s=Object(pe.c)(this._getState(),this.getCurrentFormEntity()),o=null;if(this.isImmersiveBPF()&&!Object(Ce.a)(s)){const e=Object(ae.b)(this._getState(),s.snapshotId,a);this._dispatch(e),s=Object(pe.c)(this._getState(),this.getCurrentFormEntity())}else{const e=Object(de.h)(this.getCurrentFormEntity().etn),t=Object(de.x)(e),n=Object(ie.b)(this._getState(),this._currentBpfInstance,a,t);o=n.payload.snapshotId,this._dispatch(n)}if(!this.executePreEvent("runOnPreProcessStatusChange",n,null,e))if(this._shouldPerformFormSave()){const t=this._validateSnapshot(s).then(()=>this._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(n)).then(()=>this._saveFormEntityAndBPFEntitySnapshots(o,s,!1)).then(()=>{this._executePostEvent("runOnProcessStatusChange",n,null,e)}).catch(e=>{const t=Object(h.c)(e);return this._handleDuplicateDetection(t,o)}).catch(e=>{throw this._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(e),e}).catch(e=>{this._dispatch(Object(u.b)(e,!0)).then(()=>i(e))});r(t)}else this._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(n).then(()=>{let t=null;t=this.isImmersiveBPF()&&!Object(Ce.a)(s)?s.snapshotId:o;this._dispatch(Object(oe.c)(t,!0,["statuscode","statecode","activestagestartedon","completedon"])).then(()=>{this._dispatch(Object(ce.a)(this._currentPageId,this.getCurrentFormEntity(),this._getColumnsToRefresh())).then(()=>{this._updateProcessInstanceModifiedTime(),this._executePostEvent("runOnProcessStatusChange",n,null,e)}),r()}).catch(e=>{this._dispatch(Object(u.b)(e,!0)).then(()=>i(e))})});r()})}_validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(e){return new Promise((t,n)=>{if("CompleteProcess"===e||"MoveToNextStage"===e){const t=this.ValidateRequiredFieldsForNavigation();if(t&&!t.isValid)if("MoveToNextStage"===e)n(new Y("Unable to navigate to next stage as required fields have not been set"));else{if("CompleteProcess"===e)return n(new Y("Unable to complete process as required fields have not been set"));n(new Error("validation failed for unexpected BPF operation: "+e))}}return t()})}_saveFormChangesBeforeNavigation(){if(this._shouldPerformFormSave()){const e=Object(pe.c)(this._getState(),this.getCurrentFormEntity());return this._validateSnapshot(e).then(()=>this._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures("MoveToNextStage")).then(()=>{const t=this._getColumnsToRefresh();return this._dispatch(Object(oe.c)(e.snapshotId,!0,t))}).catch(t=>(this._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(t,e.snapshotId),this._dispatch(Object(u.b)(t,!0))))}return Promise.resolve()}_shouldPerformFormSave(){const e=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ShouldPerformFormSave"),t=this.getTelemetryParams(),n=this._getState();if(Object(f.kb)(n,{id:this._currentPageId},this.getContextToken()))return e.info("Skip main form save for BPF state or stage change due to read only form",t),!1;const r=this._dispatch(Object(Me.b)(this._currentPageId,this.getContextToken()));if(r&&r.data&&r.data.getIsDirty){const n=r.data.getIsDirty(),i={name:"shouldPerformMainFormSave",value:n};return t.push(i),e.info("Checking if main form save should be performed due to dirty form",t),n}return e.error("Unable to determine dirty state of main form - skipping save of main form",t),!1}_saveMainFormIfImmersiveBpfAndNewRecord(){const e=Object(s.l)(this._getState(),this._currentPageId);if(this.isImmersiveBPF()&&e===We.a&&g.a.isNullOrEmpty(this.getCurrentFormEntity().id)){const t=1;return this._dispatch(Object(l.f)(this._currentPageId,e,!1,t,!1,!1)).then(e=>{this._currentFormEntity=e})}return Promise.resolve(void 0)}_validateSnapshot(e){return new Promise((t,n)=>{const r=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SnapshotValidation"),i=this._getSnapshotStateTelemetryParams(e),a=this._currentPageId,s=this.getContextToken();this._dispatch(this._getEventManager().runOnSave(s,1))&&(this._dispatch(Object(d.b)(a,s,2)),this._dispatch(Object(p.b)(a,s,!1)),r.warn("BPF ProcessManager: Unable to save form data due to web resource registered onSave invoking preventDefault",i),n(new h.a("Unable to save form data due to web resource registered onSave invoking preventDefault",2147877737)));for(const t in e.activeChanges){const a=e.activeChanges[t],s=this._applicationContext.DataSource.get_MetadataCache().getAttributeMetadata(e.identifier.etn,t),o=Object(Ce.a)(s)?null:s.get_logicalName(),c=Object(Ce.a)(s)?He.a.get_empty():s.get_id();if(Object(Ce.a)(a))return r.error("BPF ProcessManager: unexpected null or undefined fieldValue for attribute "+o+" with ID: "+c,i),n(new Error("Internal Client Error - null fieldValue"));const l=a.validationResult;if(Object(Ce.a)(l)){if(o===ke.c){r.info("BPF ProcessManager: skipping formEntitySnapshot validation for atttribute: "+o+" with ID: "+c,i);continue}return r.error("BPF ProcessManager: unexpected null or undefined validationResult for atttribute: "+o+" with ID: "+c,i),n(new Error("Internal Client Error - null validatorResult"))}const u=l.isValueValid;if(Object(Ce.a)(u))return r.error("BPF ProcessManager: unexpected null or undefined validationResult.isValidValue for atttribute: "+o+" with ID: "+c,i),n(new Error("Internal Client Error - null validationResult.isValidValue"));if(!u){const e={name:Ne.q,value:"clientSideCurrentForm"};return i.push(e),r.warn("BPF ProcessManager: unable to save form due to invalid value for attribute: "+o+" with ID: "+c,i),n(new U("Unable to save form data due to validation errors"))}}return t(!0)})}_createStatusAndStateUpdateRequest(e,t){return{statuscode:{label:L.a[e],valueString:e.toString(),timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null}},statecode:{label:B[t],valueString:t.toString(),timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null}}}}ValidateRequiredFieldsForNavigation(){const e=it.startStopwatch({processId:g.a.toString(this.getProcessId()),processInstanceId:g.a.toString(this.getProcessInstanceId())}),t=this._getState(),n=this._stageMetadata.getRequiredAttributesForStage(this.getActiveStageId(),this._currentPageId,this.getContextToken(),t),r=this._stageMetadata.getRequiredFlowStepsForStage(this.getActiveStageId(),this._currentPageId,this.getContextToken(),t),i={emptySteps:[],errorSteps:[]},a=Object(pe.c)(this._getState(),this.getCurrentFormEntity()),o=this._getSnapshotStateTelemetryParams(a),c=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SnapshotValidation");for(const e of n){c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: validating attribute: "+e,o);let t=Object(le.j)(this._getState(),this.getCurrentFormEntity(),e);a&&a.activeChanges&&e in a.activeChanges&&(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: fieldIsDirty: "+e,o),t=a.activeChanges[e]);Object(_.h)(t,this._getState(),this.getCurrentFormEntity().etn,e)?(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: emptyField: "+e,o),i.emptySteps.push(e)):t.validationResult.isValueValid||(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: !fieldValue.validationResult.isValueValid: "+e,o),i.errorSteps.push(e))}for(const e of r){const t=g.a.tryParse(e);if(g.a.isNullOrEmpty(t)){c.error("BPF ProcessManager ValidateRequiredFieldsForNavigation: invalid Flow Step ID GUID: "+e,o);continue}const n=this.getActionLog(t);if(n){const t=n.status;2!==t&&(c.info("BPF ProcessManager ValidateRequiredFieldsForNavigation: Required Flow Step not completed for stepId "+e+". The Flow Step Action Log has stauts of : "+t,o),i.errorSteps.push(e))}else c.info("BPF ProcessManager ValidateRequiredFieldsForNavigation: Required Flow Step not completed for stepId "+e+". No action logs were found for this Flow Step",o),i.errorSteps.push(e)}i.isValid=0===i.emptySteps.length&&0===i.errorSteps.length;const u=Object(Ke.a)(t,this._currentPageId);if(!Object(f.Gb)(u,t,this._currentPageId,this.getContextToken())){c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: form is not valid - "+this._currentPageId,o);const e=Object(s.l)(this._getState(),this._currentPageId);this._dispatch(Object(l.f)(this._currentPageId,e,!1,1,!1,!1)),i.isValid=!1}if(!i.isValid){const e=String.format("BPF ProcessManager: ValidateRequiredFieldsForNavigation returned invalid");c.warn(e,o)}return e(),i}setSelectedStage(e,t=!1){return new Promise((n,r)=>{const i=g.a.tryParseOrNull(e);if(!i)return r("setSelectedStage can only be called with a valid stage id");const a={selectedStageId:i};this._updateBusinessProcessFlowData(this._currentBpfInstance,a),this._isUserSelectedStage=t,t&&this._executePostEvent("runOnStageSelected","setSelectedStage"),n()})}setDisplayState(e){if(this._currentBpfInstance&&(e===o.a.collapsed||e===o.a.expanded||e===o.a.floating)){this._updateDisplayState(this._currentBpfInstance,e);const t=new fe(g.a.toString(this._processId),g.a.toString(this.getProcessInstanceId()),e);this._applicationContext.EventManager.ReportEvent(t)}}setActivePath(e){if(!e||0===e.length)return;const t=[];for(let n=0;n<e.length;n++)t[n]=new g.a(e[n]);const n={activePath:t};this._updateBusinessProcessFlowData(this._currentBpfInstance,n)}setBpfNavigationBehavior(e){const t={processNavigationBehavior:{navigationBehavior:e,navigationBehaviorPageId:this._currentPageId}};this._updateBusinessProcessFlowData(this._currentBpfInstance,t)}getBpfNavigationBehavior(){return this._currentBpfInstance&&Object(_.e)(this._getState(),this.getProcessInstanceId())}shouldReInitializeNavigationBehavior(){return!(!this._currentBpfInstance||!(null==this.getBpfNavigationBehavior()&&Object(Ce.a)(Object(_.b)(this._getState(),this.getProcessInstanceId()))||Object(_.f)(this._getState(),this.getProcessInstanceId())!==this._currentPageId))}getBpfNavigationBehaviorAllowCreateNew(e){const t=this._currentBpfInstance&&Object(_.b)(this._getState(),this.getProcessInstanceId());return!t||!e||t(e)}createWorkflowLogRecord(e){if(Object(Ce.a)(e))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined actionLog");const t=this._getState();if(Object(Ce.a)(t))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined state");const n=t.metadata;if(Object(Ce.a)(n))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined metadata");const r=n.entities;if(Object(Ce.a)(r))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined entities");const i=this._currentBpfInstance.etn;if(Object(Ce.b)(i))throw new Error("BPF Create WorkflowLog Record Failure: null or empty entityLogicalName");const a=r[i];if(Object(Ce.a)(a))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined bpfEntity");const s=a.EntitySetName;if(Object(Ce.b)(s))throw new Error("BPF Create WorkflowLog Record Failure: null or empty entitySetName");const o=Object(Ae.z)(t,"workflowlog",a.EntityLogicalName,"asyncoperationid");if(Object(Ce.a)(o))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined relationshipMetadata");if(Object(Ce.b)(o.ReferencingEntityNavigationPropertyName))throw new Error("BPF Create WorkflowLog Record Failure: null or empty relationshipMetadata.ReferencingEntityNavigationPropertyName");const c=o.ReferencingEntityNavigationPropertyName+"@odata.bind",l="/"+s+"("+e.processInstanceid.guid+")",u={workflowlogid:e.actionLogId.guid,stepname:e.stepId.guid,[c]:l,activityname:e.processDefinitionid.guid,status:e.status};Xrm.WebApi.createRecord("workflowlog",u)}_getTracer(){return Object(Ce.a)(this._applicationContext)||Object(Ce.a)(this._applicationContext.TraceManager)?null:this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ProcessManager")}_getDefaultActivePath(){const e=this._getTracer();if(Object(Ce.a)(this._stageMetadata))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined _stageMetadata"),null;const t=this._stageMetadata.getDefaultPathManager();if(Object(Ce.a)(t))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined defaultPathManager"),null;const n=t.getDefaultPath();if(Object(Ce.a)(n))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined stringPath"),null;const r=[];for(const e in n){const t=g.a.parse(n[e]);r.push(t)}return r}_updateBusinessProcessFlowData(e,t){e&&(this._dispatch(Object(ee.a)(t,e)),this._updateProcessInstanceModifiedTime())}_updateDisplayState(e,t){this._dispatch(Object(te.a)(t,e)),this._updateProcessInstanceModifiedTime()}getForwardNavigationEntities(e,t,n,r){return this._saveFormChangesBeforeNavigation().then(()=>this._dispatch(v(e,t,n,r||null)))}navigateToNextEntity(e,t,n,r){return new Promise((i,a)=>{const s=this.ValidateRequiredFieldsForNavigation();if(s&&!s.isValid)return a(new Y("Unable to navigate to next stage as required fields have not been set"));const o=this._stageMetadata.getNextStageId(this.getActiveStageId());if(!o)return a(new q("Last stage in the active path reached. Next stage does not exist."));const c=new g.a(o),l=this.getTraversedPath()+","+o;return this._saveFormChangesBeforeNavigation().then(()=>this._dispatch(T(e,t,c,l,n,r))).then(()=>this.setSelectedStage(o)).then(()=>{this._executePostEvent("runOnStageChange","navigateToNextEntity",0),i()}).catch(e=>{this._dispatch(Object(u.b)(e,!0)).then(()=>a(e))})})}navigateToNextEntityForCrossEntityBpf(e,t,n,r){return new Promise((i,a)=>{this._dispatch(T(e,t,new g.a(this.getActiveStageId()),this.getTraversedPath(),n,r)).then(()=>{this._dispatch(Object(re.b)(t,this._currentBpfInstance)),this._executePostEvent("runOnStageChange","navigateToNextEntityForCrossEntityBpf",0),i()}).catch(e=>{this._dispatch(Object(u.b)(e,!0)).then(()=>a(e))})})}getActiveStageActiveFor(){if(this._currentBpfInstance){const e=Object(O.b)(this._getState(),this._currentBpfInstance);if(e){return(new Date).valueOf()-e.valueOf()}}return null}getBpfInstanceActiveFor(){if(this._currentBpfInstance){const e=Object(O.d)(this._getState(),this._currentBpfInstance);if(e)return(new Date).valueOf()-e.valueOf()}return null}getBpfInstanceCompletedIn(){if(this._currentBpfInstance){const e=Object(O.d)(this._getState(),this._currentBpfInstance),t=Object(O.c)(this._getState(),this._currentBpfInstance);if(t&&e)return t.valueOf()-e.valueOf()}return null}getActionLogCollection(){return this._currentBpfInstance?Object(_.a)(this._getState(),this.getProcessInstanceId()):null}getActionLog(e){const t=this.getActionLogCollection();return t&&t[e.guid]?t[e.guid]:null}UpdateActionLog(e,t,n,r){if(!this._currentBpfInstance)return null;const i=Object(_.a)(this._getState(),this.getProcessInstanceId()),a=i&&i[e.guid]?i[e.guid]:null;let s=g.a.EMPTY;s=Object(Ce.a)(r)||r===g.a.EMPTY?a?a.actionLogId:g.a.newGuid():r;const o={actionLogId:s,status:t,modifiedOn:(new Date).toLocaleString(),stepId:e,processDefinitionid:this._processId,processInstanceid:this.getProcessInstanceId(),message:n},c=Object.assign({},i);c[e.guid]=o;const l={actionLogCollection:c};return this._updateBusinessProcessFlowData(this._currentBpfInstance,l),"success"}getEnabledProcesses(){const e=[];return new Promise((t,n)=>{var r;this._currentFormEntity&&this._currentFormEntity.etn?this._dispatch((r=this._currentFormEntity.etn,{type:"businessProcessFlow.retrieveFilteredProcesses.async",execute({dispatch:e,getState:t},n){const i=n.DataSource.get_WebAPIService(),a=t(),s=g.a.tryParse(Object(N.i)(a)),o=new x(r,s),c=Object(w.a)(t(),o);return i.sendRequest(c).then(e=>e.json(),h.b)}})).then(n=>{for(const t of n.value)e.push(new A(t.name,t.uniquename,t.workflowid));t(e)},e=>{n(e)}):n(new h.a("Current Form Entity cannot be NULL",2147877745))})}getNavigationEntities(){return this._activeStageManager.navigationEntities}_getNavigationEntityIdsByEntityLogicalName(){return this._activeStageManager.navigationEntityIdsByEntityLogicalName}_updateGlobalActiveStage(e,t){this._activeStageManager.UpdateGlobalPathAndActiveStage(e,t)}_createGlobalNavigationData(e){const t=new M,n=Object(k.b)(e.activestageid);t.activeStageId=g.a.toString(n);let r=Object(k.c)(e.traversedpath);Object(Ce.b)(r)&&(r=D.a.getCandidateTraversedPathFromStagStep(this._stageMetadata.businessProcessFlowVisitor.get_stages(),t.activeStageId)),t.traversedPath=r,t.navigationEntities=[];const i=this._getNavigationEntityTypesFromWorkflowObjectModel();for(const n of i){const r=new R;r.entityLogicalName=n,r.id=g.a.EMPTY.guid;for(const t in e)if(Object(k.k)(e[t])){const i=e[t],a=[],s="NULL";if(Object(Ce.a)(i.reference)||Object(Ce.a)(i.reference.etn)){a.push({name:"entityReference.reference",value:s});this._applicationContext.TraceManager.getTracer("CreateGlobalNavigationData").info("Navigation entity should not be null .",a)}i&&i.reference&&i.reference.etn===n&&(r.id=i.reference.id.guid)}t.navigationEntities.push(r)}e.hasOwnProperty("businessprocessflowinstanceid")&&(t.businessProcessInstanceId=Object(k.c)(e.businessprocessflowinstanceid));e.hasOwnProperty("name")&&(t.businessProcessInstanceName=Object(k.c)(e.name));e.hasOwnProperty("statecode")&&(t.businessProcessState=Object(k.c)(e.statecode));e.hasOwnProperty("statuscode")&&(t.businessProcessStatus=Object(k.c)(e.statuscode));return e.hasOwnProperty("bpfDefinitionVersioNumber")&&(t.bpfDefinitionVersionNumber=Object(k.c)(e.bpfDefinitionVersioNumber)),t}_getNavigationEntityTypesFromWorkflowObjectModel(){const e={};if(!Object(Ce.a)(this.getProcess()))for(let t=0;t<this.getProcess().get_Steps().get_Count();t++){const n=this.getProcess().get_Steps().get_item(t);if(!(n instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep))continue;const r=n.get_Description();e[r]||(e[r]=r)}return Object.keys(e)}reflow(e,t,n){const r=this._stageMetadata.getDefaultPathManager();if(!t&&!n)return void this._reflowInternal();if(!t)return;t=new g.a(t).guid;const i=this.getTraversedPath(),a=this.getActiveStageId();i&&a&&(a===t||i.indexOf(t)<0)&&(r.updateDefaultPath(t,n),this._updateProcessInstanceModifiedTime())}_reflowInternal(e,t){const n=this._stageMetadata.getDefaultPathManager();e||t||(t=this.getActiveStageId(),e=this._stageMetadata.getPreviousStageId(t)),e&&(n.updateDefaultPath(e,t),this._updateProcessInstanceModifiedTime())}callPblToEvaluateBranching(e){const t=this._getState();if(!this._currentPageId)throw new Error("The current page Id should not be null when callPblToEvaluateBranching has been called. Because the reflow logic should be triggered for a particular page.");const n=Object(J.a)(t,this._currentPageId);this.getScriptContainerPromise().then(t=>{n<$.a.EditReady&&t.getEventManager().addOnLoadEvent(this.getContextToken(),()=>{t.execute(e,[])}),n>=$.a.OnLoadReady&&t.execute(e,[])})}update(e){!Object(Ce.a)(this._currentBpfInstance)&&this._isSelectedStageControl(e.Id)&&this._updateProcessInstanceModifiedTime()}waitForOngoingWork(){return Ze.a.getInstance().checkForOutstandingWork(this._getState())}_getEventManager(){const e=this.getScriptContainer();return e?e.getEventManager():null}getScriptContainer(){if(!this._applicationContext||!this._applicationContext.ScriptManager)return null;let e=null;try{e=this._applicationContext.ScriptManager.getContainer(this._currentPageId)}catch(e){this._logTraceFailureForScriptContainer()}return e}getScriptContainerPromise(){return this._applicationContext&&this._applicationContext.ScriptManager?this._applicationContext.ScriptManager.initializeContainer(this._currentPageId):Promise.reject("The current container should be created before invoking handlers.")}_executePostEvent(e,t,n=null,r=null){if(Object(Ue.n)(this._getState(),this._currentPageId)||!this._getEventManager())this._logTraceFailureForProcessEvent(t,e,e);else switch(e){case"runOnProcessChange":this._dispatch(this._getEventManager().runOnProcessChange(this.getContextToken(),this));break;case"runOnProcessStatusChange":this._dispatch(this._getEventManager().runOnProcessStatusChange(this.getContextToken(),L.a[r],this));break;case"runOnStageChange":this._dispatch(this._getEventManager().runOnStageChange(this.getContextToken(),this,n));break;case"runOnStageSelected":this._dispatch(this._getEventManager().runOnStageSelected(this.getContextToken(),this))}}executePreEvent(e,t,n=null,r=null){let i=!1;if(!Object(Ue.n)(this._getState(),this._currentPageId)&&this._getEventManager()){switch(e){case"runOnPreProcessStatusChange":i=this._dispatch(this._getEventManager().runOnPreProcessStatusChange(this.getContextToken(),L.a[r],this));break;case"runOnPreStageChange":i=this._dispatch(this._getEventManager().runOnPreStageChange(this.getContextToken(),this,n))}return this._logTraceInfoForProcessPreEvent(i,e,t,t),i}return this._logTraceFailureForProcessEvent(t,e,e),i}_saveFormDataAndActiveStage(e,t,n){const r=st.startStopwatch({processId:g.a.toString(this.getProcessId()),processInstanceId:g.a.toString(this.getProcessInstanceId())}),i=this.executePreEvent("runOnPreStageChange",n,t),a=Object(pe.c)(this._getState(),this.getCurrentFormEntity());if(!i){const r=new Promise((t,r)=>{if(!e)return r(new G("Attemping to save invalid stage id"));const i=["traversedpath","activestageid","activestagestartedon","completedon"],s=this.getNavigationEntities(),o=Object(m.b)(this._getState(),this._currentBpfInstance);for(const e of s)for(const t in o)if(t.includes(e.entityLogicalName)){i.push(t);break}let c,l;if(this._shouldPerformFormSave()){const t=this._getState();c=this._validateSnapshot(a).then(()=>this._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(n)).then(()=>(l=this._createActiveStageSnapshot(e),this._saveFormEntityAndBPFEntitySnapshots(l,a,!1))).then(()=>{const e=this.getCurrentFormEntity();this._dispatch(Object(tt.a)(this._currentPageId,t,this.getContextToken(),e.etn,e.id))}).catch(e=>{const t=Object(h.c)(e);return this._handleDuplicateDetection(t,l)})}else c=this._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(n).then(()=>(l=this._createActiveStageSnapshot(e),this._dispatch(Object(oe.c)(l,!0,i,this._getRetrieveProcessControlDataRequest())).then(()=>{this._dispatch(Object(ce.a)(this._currentPageId,this.getCurrentFormEntity(),this._getColumnsToRefresh(),this._getRetrieveProcessControlDataRequest())),this._dispatch(Object(C.b)(!0,this._currentFormEntity))})));t(c)}).then(()=>{const e=this.getTraversedPath(),r=this.getActiveStageId();this._updateGlobalActiveStage(e,r),this.setSelectedStage(r),this._executePostEvent("runOnStageChange",n,t)},e=>{throw this._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(e),e});return r.then(s,s),r}function s(){r()}}_handleDuplicateDetection(e,t){if(Object(et.e)(e)){return this._dispatch(Object(Je.a)(this._currentPageId,e,this._currentFormEntity)).then(e=>0===e.status?this._dispatch(Object($e.a)(e.pageId)).then(e=>e.value.param_lastButtonClicked===l.a?Promise.resolve("success"):Promise.resolve("aborted")):Promise.resolve("noop")).then(e=>{if("success"===e){const e=Object(pe.c)(this._getState(),this.getCurrentFormEntity());return this._saveFormEntityAndBPFEntitySnapshots(t,e,!0)}})}throw e}_saveFormEntityAndBPFEntitySnapshots(e,t,n){const r={};r[t.identifier.etn]=this._getColumnsToRefresh();let i=null;return i=this.isImmersiveBPF()?[t.snapshotId]:[t.snapshotId,e],this._dispatch(Object(oe.d)(i,n,r,this._getRetrieveProcessControlDataRequest()))}_logTraceInfoForProcessPreEvent(e,t,n,r){const i=this._applicationContext.TraceManager.getTracer(r),a=this.getTelemetryParams(),s={name:"BpfOperationName",value:n};a.push(s);const o={name:"eventName",value:t};a.push(o);const c={name:"preventDefaultInvokedByWebResource",value:e};a.push(c),i.info("BPF ProcessManager executed scripts registered to event "+t,a)}_logTraceFailureForProcessEvent(e,t,n){const r=this._applicationContext.TraceManager.getTracer(n),i=this.getTelemetryParams(),a={name:"BpfOperationName",value:e};i.push(a);i.push({name:"preventDefaultInvokedByWebResource",value:null});const s={name:"eventName",value:t};i.push(s);const o={name:"isPageDead",value:Object(Ue.n)(this._getState(),this._currentPageId)};i.push(o);const c={name:"currentPageId",value:this._currentPageId};i.push(c),r.error(`BPF ProcessManager not able to to execute scripts registered on event ${t} does not exist`,i)}_logTraceFailureForScriptContainer(){const e=this._applicationContext.TraceManager.getTracer("GET_SCRIPT_CONTAINER"),t=this.getTelemetryParams();t.push({name:"BpfOperationName",value:"GetScriptContainer"});const n={name:"IsPageDead",value:Object(Ue.n)(this._getState(),this._currentPageId)};t.push(n);t.push({name:"IsSciptContainerAvailable",value:!1}),e.error("BPF ProcessManager not able to to execute scripts as the script container does not exist",t)}_getStage(e){let t=null;if(e){const n=this.getEntityStages();n&&n.some(n=>{for(let r=0;r<n.get_Steps().get_Count();r++){const i=n.get_Steps().get_item(r);if(this._equalsIgnoreCase(e,i.get_Id()))return t=i,!0}})}return t}getContextToken(){return Object(de.j)(this._getState(),this._currentPageId)}_updateProcessInstanceModifiedTime(){this._dispatch(Object(ne.b)(this.getCurrentFormEntity()))}_isSelectedStageControl(e){if(!Object(Ce.a)(this.getSelectedStage())){const t=this.getSelectedStage().get_Steps();for(let n=0;n<t.get_Count();n++)if(this._equalsIgnoreCase(t.get_item(n).get_Id(),e))return!0}return!1}_equalsIgnoreCase(e,t){return!!e&&!!t&&e.toUpperCase()===t.toUpperCase()}_getSnapshotStateTelemetryParams(e){const t=[];if(Object(Ce.a)(e))return t;const n={name:"mode",value:e.mode},r={name:"identifierId",value:Object(Ce.a)(e.identifier)||Object(Ce.a)(e.identifier.id)?null:g.a.toString(e.identifier.id)},i=this._applicationContext.DataSource.get_MetadataCache().getEntityMetadata(e.identifier.etn),a={name:"identifierEntityId",value:Object(Ce.a)(i)?null:g.a.fromLegacyGuid(i.get_id()).guid},s={name:"identifierEntityObjectTypeCode",value:Object(Ce.a)(i)?null:i.get_objectTypeCode()},o={name:"activeChanges",value:Object(Ce.a)(i)?null:this._getIFieldValuesString(e.activeChanges,i.get_logicalName())},c={name:"lockedChanges",value:Object(Ce.a)(i)?null:this._getIFieldValuesString(e.lockedChanges,i.get_logicalName())};return t.push(n),t.push(a),t.push(s),t.push(r),t.push(o),t.push(c),t}_getTelemetryParamsForActionStep(e,t,n){const r=this.getTelemetryParams(),i={name:"ActionStepType",value:e},a={name:"ControlId",value:t},s={name:"ActionStepId",value:n};return r.push(i),r.push(a),r.push(s),r}getTelemetryParams(){const e=[];try{const t={name:"ProcessId",value:g.a.toString(this.getProcessId())},n={name:"ProcessInstanceId",value:g.a.toString(this.getProcessInstanceId())},r={name:"ActiveStageId",value:this.getActiveStageId()},i={name:"SelectedStageId",value:this.getSelectedStageId()},a={name:"TraversedPath",value:this.getTraversedPath()},o={name:"ActivePath",value:this._getActivePathString()},c={name:"CurrentFormEntityType",value:this.getCurrentFormEntity()&&this.getCurrentFormEntity().etn?this.getCurrentFormEntity().etn:""},l={name:"CurrentFormEntityId",value:this.getCurrentFormEntity()&&this.getCurrentFormEntity().id?g.a.toString(this.getCurrentFormEntity().id):""},u={name:"ProcessState",value:this.getProcessState()},d={name:"PageId",value:this._currentPageId},p={name:"PageType",value:Object(s.l)(this._getState(),this._currentPageId)},h={name:"SavedPageId",value:this._savedPageId},m={name:"SavedPageType",value:Object(s.l)(this._getState(),this._savedPageId)};if(Object(Be.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){const t={name:"CustomControlsPresent",value:this.getCustomControlIndicator()},n={name:"RenderedFromFormXML",value:this.getFormXmlRenderingIndicator()};e.push(t),e.push(n)}const b={name:"IsImmersiveBPF",value:this.isImmersiveBPF()};e.push(t),e.push(n),e.push(r),e.push(a),e.push(o),e.push(i),e.push(c),e.push(l),e.push(u),e.push(d),e.push(p),e.push(h),e.push(m),e.push(b)}catch(t){this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ProcessManagerTelemetryGeneration").error("Exception while generating Process Manager telemetry parameters: "+t.message,e)}return e}_getIFieldValuesString(e,t){let n="";if(!Object(Ce.a)(e))for(const r in e)if(Object(Ce.a)(r))n+=String.format("[fieldName: {0}]",null);else{const i=this._applicationContext.DataSource.get_MetadataCache().getAttributeMetadata(t,r),a=e[r];if(Object(Ce.a)(a)||Object(Ce.a)(i))n+=String.format("[attributeId is null: {0}, attributeMetadata is null: {1}]",Object(Ce.a)(a),Object(Ce.a)(i));else{let e="";Object(Ce.a)(a.timestamp)||(e=a.timestamp.toUTCString());let t="",r="",s=null,o=null;Object(Ce.a)(a.validationResult)||(t=a.validationResult.errorId,r=a.validationResult.errorMessage,s=a.validationResult.isOfflineSyncError,o=a.validationResult.isValueValid);const c=i.get_id();n+=String.format("[attributeId: {0}, timeStamp: {1}, validationResultErrorId: {2}, validationResultErrorMessage: {3}, validationResultIsOfflineSyncError: {4}, validationResultIsValueValid: {5}]",c,e,t,r,s,o)}}return n}_getActivePathString(){const e=this.getActivePath();let t="";if(e&&e.length>0){for(let n=0;n<e.length-1;n++)t=t+e[n].guid+",";t+=e[e.length-1].guid}return t}isImmersiveBPF(){return this.getCurrentFormEntity()&&this._currentBpfInstance&&this.getCurrentFormEntity().etn===this._currentBpfInstance.etn}_getColumnsToRefresh(){const e=Object(Ye.b)(this._getState(),this._currentPageId),t=Object(s.g)(this._getState(),this._currentPageId);if(Object(Ce.a)(t)){const e=Object(pe.c)(this._getState(),this.getCurrentFormEntity()),t=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SaveAndRefresh"),n=this._getSnapshotStateTelemetryParams(e);return t.warn("Columns To Refresh is not set as PageInput is null. Primary entity not refreshed after save",n),[]}const n=Object(Ae.E)(this._getState(),t.entityTypeName),r=Object(l.g)(this._getState(),e,t,n,null);return r&&r.hasOwnProperty(t.entityTypeName)?r[t.entityTypeName]:[]}_getRetrieveProcessControlDataRequest(){const e=this.getProcessId()&&!g.a.equals(this.getProcessId(),g.a.EMPTY)?Z.a.toLegacyEntityReference(new Z.a("businessprocessflowinstance",this.getProcessId())):null,t=this.getProcessInstanceId()&&!g.a.equals(this.getProcessInstanceId(),g.a.EMPTY)?Z.a.toLegacyEntityReference(new Z.a("businessprocessflowinstance",this.getProcessInstanceId())):null;return this.getCurrentFormEntity()&&e&&t?new Ge.a(Z.a.toLegacyEntityReference(this.getCurrentFormEntity()),e,t):this.getCurrentFormEntity()?new Ge.a(Z.a.toLegacyEntityReference(this.getCurrentFormEntity()),null,null):null}getCustomControlIndicator(){return this._customControlsPresent}setCustomControlIndicator(e){this._customControlsPresent=e}getFormXmlRenderingIndicator(){return this._renderedFromFormXml}setFormXmlRenderingIndicator(e){this._renderedFromFormXml=e}getInstanceModifiedTimestamp(){return this._instanceModifiedTimestamp}isBpfFormDescriptorValid(e,t,n,r){return null===this._isBpfFormValid&&(this._isBpfFormValid=Object(Qe.f)(e,t,n,r)),this._isBpfFormValid}_unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(e,t){let n=t;if(Object(Ce.a)(t)){const t=Object(h.c)(e);n=!Object(Ce.a)(t)&&t.FaultedSnapshotId}!Object(Ce.b)(n)&&this._dispatch(Object(se.b)(n,!1));const r=Object(pe.c)(this._getState(),this.getCurrentFormEntity());r&&!Object(Ce.a)(r.snapshotId)&&r.snapshotId!==n&&this._dispatch(Object(se.b)(r.snapshotId,!1))}}},bq0x:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t){const n=Object(r.Zb)(e,t);return n&&n.output?n.output.value:null}},c6SX:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var r=n("nuS9"),i=n("ruPX"),a=n("vTeb"),s=n("u+q+"),o=n("QBtP");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c="_blank";class l extends r.Component{constructor(e){super(e),this._onClick=this._onClick.bind(this)}render(){const e=this.context.Router.createUrlForPage(this.props.pageName,this.props.input);return r.createElement(a.a,{tabIndex:this.props.tabIndex,id:this.props.id,href:e,target:this.props.target,onClick:this._onClick,style:this.props.style,role:this.props.role,accessibilityLabel:this.props.accessibilityLabel,describedByElementId:this.props.describedByElementId},this.props.children)}_onClick(e){e.preventDefault(),this.props.target===c?this.props.navigateToNewWindow(this.props.pageName,this.props.input,this.props.target):this.props.navigateTo(this.props.pageName,this.props.input,this.props.sourcePageId)}}l.contextType=o.a;const u=Object(s.a)(void 0,(function(e){return{navigateTo:(t,n,r)=>{e(Object(i.a)(t,n,r))},navigateToNewWindow:(t,n,r)=>{e(Object(i.c)(t,n,r))}}}))(l)},cGlR:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n("c/eZ"),i=n("nuS9"),a=n("UKHH"),s=n("Nubg"),o=n("KovS"),c=n("Bz7c"),l=n("k6Yd"),u=n("1UTq"),d=n("EOcA"),p=n("L4Zk"),h=n("lhDp"),g=Object(u.c)((function(e,t,n){var r=Object(d.a)(e),i=Object(p.a)(e),a={root:{minWidth:"80px",height:"32px"},label:{fontWeight:c.b.semibold}};return Object(l.a)(r,a,n?Object(h.a)(e):Object(h.b)(e),i,t)})),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.primary,n=void 0!==t&&t,o=e.styles,c=e.theme;return i.createElement(a.a,Object(r.__assign)({},this.props,{variantClassName:n?"ms-Button--primary":"ms-Button--default",styles:g(c,o,n),onRenderDescription:s.b}))},t=Object(r.__decorate)([Object(o.a)("DefaultButton",["theme","styles"],!0)],t)}(i.Component)},ccIw:function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var r=n("WRDA"),i=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class a{get invocationSource(){return this._invocationSource}set invocationSource(e){this._invocationSource=e}get workflowStep(){return this._workflowStep}set workflowStep(e){this._workflowStep=e}get businessProcessFlowVisitor(){return this._businessProcessFlowVisitor}set businessProcessFlowVisitor(e){this._businessProcessFlowVisitor=e}get currentEntityName(){return this._currentEntityName}set currentEntityName(e){this._currentEntityName=e}get processManager(){return this._processManager}set processManager(e){this._processManager=e}getStageStep(e){if(Object(i.b)(e)||!this._businessProcessFlowVisitor)return null;const t=this._businessProcessFlowVisitor.get_stagesById()[Object(r.a)(e)];return t||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class s extends
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class{constructor(e){this.value=e,this._next=null}get value(){return this._value}set value(e){this._value=e}getNext(){return this._next}setNext(e){this._next=e}}{constructor(e){super(Object(r.a)(e))}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class o{constructor(){this._latestDefaultPathCalculated=!1,this._rootNodes=[],this._rootNodesValue=[],this._lastDefaultPathCalculatedTimeHash=this._generateDefaultPathCalculatedTimeHash()}find(e,t){if(e=Object(r.a)(e),t){for(const t in this._rootNodesValue)if(e===this._rootNodesValue[t])return this._rootNodes[t];return null}for(const t in this._rootNodes){let n=this._rootNodes[t];if(n.value===e)return n;for(;null!=n.getNext();)if(n=n.getNext(),n.value===e)return n}return null}getNode(e){return this._rootNodes[e]}setNode(e,t){this._latestDefaultPathCalculated=!1,this._rootNodes[e]=t,this._rootNodesValue[e]=t.value}getDefaultPath(){return this._ensureLatestDefaultPathIsCalculated(),this._defaultPathArray}addAfter(e,t){this.find(t.value,!0)?this._addAfterInternal(e,new s(null)):this._addAfterInternal(e,t)}getDefaultPathHash(){return this._ensureLatestDefaultPathIsCalculated(),this._lastDefaultPathCalculatedTimeHash}_ensureLatestDefaultPathIsCalculated(){this._latestDefaultPathCalculated||(this._defaultPathArray=this._recaculateDefaultPath(),this._latestDefaultPathCalculated=!0,this._lastDefaultPathCalculatedTimeHash=this._generateDefaultPathCalculatedTimeHash())}_recaculateDefaultPath(){this._defaultPathArray=[];for(let e=0;e<this._rootNodes.length;e++){let t=this._rootNodes[e];for(this._defaultPathArray[this._defaultPathArray.length]=t.value;t.getNext();){const e=t.getNext();e.value&&(this._defaultPathArray[this._defaultPathArray.length]=e.value),t=e}}return this._defaultPathArray}_addAfterInternal(e,t){e.setNext(t),this._latestDefaultPathCalculated=!1}_generateDefaultPathCalculatedTimeHash(){let e=Math.floor(1e4*Math.random());try{e=crypto.getRandomValues(new Uint32Array(1))[0]}catch(e){}return Date.now().toString()+e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class c{pathChanged(e){this._handler&&!Object(i.b)(e.parentStage)&&this._handler.handleChange(e.parentStage,e.nextStage)}getHandler(){return this._handler}setHandler(e){this._handler=e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class l{constructor(e,t){this._nextStage=t,this._parentStage=e}get parentStage(){return this._parentStage}get nextStage(){return this._nextStage}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class u{constructor(e,t,n){this._context=e,this._defaultPath=t,this._staticPath=n}calculate(){let e=this._startingNodeInDefaultPath();for(let t=0;t<this._staticPath.length;t++){const n=this._staticPath[t];if(!this._context.businessProcessFlowVisitor.get_stagesById().hasOwnProperty(n))continue;const r=this._defaultPath.find(n,!0);r?e=r:(this._defaultPath.addAfter(e,new s(n)),e=e.getNext())}this._lastEvaluatedNode=e}getLastEvaluatedNodeInDefaultPath(){return this._lastEvaluatedNode}getDefaultPath(){return this._defaultPath}_startingNodeInDefaultPath(){return this._startNode||(this._startNode=this._defaultPath.getNode(0)),this._startNode}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class d{constructor(e,t){this._defaultPath=t,this._context=e}calculate(){this._staticPathToDefaultPathCalculator.calculate(),this._defaultPath=this._staticPathToDefaultPathCalculator.getDefaultPath()}getLastDefaultNode(){return this._staticPathToDefaultPathCalculator.getLastEvaluatedNodeInDefaultPath()}get traversedPath(){return this._traversedPath||(this._traversedPath=[]),this._traversedPath}set traversedPath(e){this._traversedPath=e}getDefaultPath(){return this._defaultPath}get _staticPathToDefaultPathCalculator(){return this.__staticPathToDefaultPathCalculator||(this.__staticPathToDefaultPathCalculator=new u(this._context,this._defaultPath,this._traversedPath)),this.__staticPathToDefaultPathCalculator}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class p{constructor(e,t){this._context=e,this._defaultPath=t}calculate(){this._context.businessProcessFlowVisitor.get_areConditionsPresent()&&this._calculateForTraveresedStages()}get traversedPath(){return this._traversedPath}set traversedPath(e){this._traversedPath=e}getLastCalculatedDefaultNode(){return this._traversedDefaultPathCalculator?this._traversedDefaultPathCalculator.getLastDefaultNode():null}getDefaultPath(){return this._defaultPath}_calculateForTraveresedStages(){this._traversedDefaultPathCalculator.traversedPath=this._traversedPath.split(","),this._traversedDefaultPathCalculator.calculate()}get _traversedDefaultPathCalculator(){return this.__traversedDefaultPathCalculator||(this.__traversedDefaultPathCalculator=new d(this._context,this._defaultPath)),this.__traversedDefaultPathCalculator}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class h{constructor(e){this.context=e}get stage(){return this._stageStep}set stage(e){this._stageStep=e}tryExecute(){const e=Object(r.a)(this.stage.get_stageId());return!!this.context.businessProcessFlowVisitor.get_conditionsByParentStageId()[e]&&(this.executeCondition(),!0)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class g extends h{executeCondition(){const e="bpf_"+this._sanitizeGuidForFunctionName(this.stage.get_stageId());this.context.processManager.callPblToEvaluateBranching(e)}_sanitizeGuidForFunctionName(e){if(Object(i.b)(e))return e;for(e=Object(r.a)(e);e.indexOf("-")>-1;)e=e.replace("-","");return e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class m extends h{executeCondition(){const e=Object(r.a)(this.stage.get_stageId()),t=this.context.businessProcessFlowVisitor.get_conditionsByParentStageId()[e];if(!t)return;const n=t.findElseBranch();let i=null;if(n&&n.get_Steps().get_Count()>0){i=n.get_Steps().get_item(0).get_stageId()}this._invokeReflowFunction(e,i)}_invokeReflowFunction(e,t){this.context.processManager.reflow(!1,e,t)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class b{getStageCommand(e,t){const n=e.businessProcessFlowVisitor.get_parentEntityStepByStageId()[Object(r.a)(t.get_stageId())];return e.currentEntityName!==n.get_EntityLogicalName()?new m(e):new g(e)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class y{constructor(e,t,n){this._defaultPath=t,this._cascadeUpdate=n,this._context=e,this._businessRuleCommandFactory=new b}handleChange(e,t){const n=this._defaultPath.find(e,!1);if(null!=n){const e=Object(i.b)(t)?null:t,r=new s(e);this._defaultPath.addAfter(n,r),e&&this.triggerSubsequentDefaultPathCalculation(r)}}triggerSubsequentDefaultPathCalculation(e){if(!e)return;const t=e.value;if(t&&!this._tryExecuteConditionForStage(e)){const n=this._context.getStageStep(t).get_nextStageId();if(!n)return;const r=this._defaultPath.find(n,!0);if(r)return void(this._cascadeUpdate&&this.triggerSubsequentDefaultPathCalculation(r));this._defaultPath.addAfter(e,new s(n)),this.triggerSubsequentDefaultPathCalculation(e.getNext())}}_tryExecuteConditionForStage(e){const t=this._context.invocationSource;try{this._context.invocationSource="internal";const n=this._context.getStageStep(e.value),r=this._businessRuleCommandFactory.getStageCommand(this._context,n);if(r.stage=n,!r.tryExecute())return!1;if(e.getNext())return!0}finally{this._context.invocationSource=t}return!1}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class f{constructor(e,t,n){this._context=e,this._listener=t,this._defaultPath=n}calculate(){const e=this._pathChangeHandler;this._listener.setHandler(e),e.triggerSubsequentDefaultPathCalculation(this._startNode)}get startingNodeInDefaultPath(){return this._startNode}set startingNodeInDefaultPath(e){this._startNode=e}getDefaultPath(){return this._defaultPath}get _pathChangeHandler(){return this.__pathChangeHandler||(this.__pathChangeHandler=new y(this._context,this._defaultPath,!0)),this.__pathChangeHandler}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class S{constructor(e,t,n){this._context=e,this._listener=t,this._initialDefaultPath=n}calculate(){this._context.businessProcessFlowVisitor.get_areConditionsPresent()||(this._defaultPath=this._initialDefaultPath),this._calculateForTraversedStages(),this._calculateForNonTraversedStages()}get startingNodeInDefaultPath(){return this._startingNodeInDefaultPath}set startingNodeInDefaultPath(e){this._startingNodeInDefaultPath=e}getDefaultPath(){return this._defaultPath}_calculateForTraversedStages(){this._defaultPath=this._initialDefaultPath}_calculateForNonTraversedStages(){this._nonTraversedDefaultPathCalculator.startingNodeInDefaultPath=this.startingNodeInDefaultPath,this._nonTraversedDefaultPathCalculator.calculate()}get _nonTraversedDefaultPathCalculator(){return this.__nonTraversedDefaultPathCalculator||(this.__nonTraversedDefaultPathCalculator=new f(this._context,this._listener,this._defaultPath)),this.__nonTraversedDefaultPathCalculator}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class v{constructor(e,t,n){this._context=e,this._changeListener=t,this._defaultPath=n}calculate(){const e=this._pathChangeHandler;this._changeListener.setHandler(e)}getDefaultPath(){return this._defaultPath}get _pathChangeHandler(){return this.__pathChangeHandler||(this.__pathChangeHandler=new y(this._context,this._defaultPath,!1)),this.__pathChangeHandler}}var C=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class O{constructor(e,t){this._context=t,this._traversedPathProvider=e,this._changeListener=new c,this._initializeDefaultPathFromRootStages()}initializeComplete(){const e=this.defaultPathHash();this._initializeTraversedPath(),this._initializeNonTraversedPath();const t=this._context.processManager.getSelectedStageId(),n=this._context.processManager.getActivePath(),r=!Object(i.a)(t)&&!Object(i.a)(n),a=r&&n.findIndex(e=>e.guid.toString()===t)<0,s=r&&this.getDefaultPath().indexOf(t)>=0;this.getDefaultPath()&&(e!==this.defaultPathHash()||a&&s)&&this._context.processManager.setActivePath(this.getDefaultPath())}updateDefaultPath(e,t){if(!e)return;let n=null;if("internal"!==this._context.invocationSource&&(n=this.defaultPathHash()),this._changeListener.pathChanged(new l(e,t)),"internal"!==this._context.invocationSource){if(n!==this.defaultPathHash()){const e=this.getDefaultPath();this._context.processManager.setActivePath(e)}}}triggerSubsequentDefaultPathCalculation(e){if(!(!!C.a.tryParseOrNull(e)&&!!this.getDefaultPath().find(t=>t.toLowerCase()===e.toLowerCase())))return;let t=null;if("internal"!==this._context.invocationSource&&(t=this.defaultPathHash()),this._changeListener.getHandler().triggerSubsequentDefaultPathCalculation(new s(e)),"internal"!==this._context.invocationSource){if(t!==this.defaultPathHash()){const e=this.getDefaultPath();this._context.processManager.setActivePath(e)}}}getDefaultPath(){return this._defaultPath.getDefaultPath()}defaultPathHash(){return this._defaultPath.getDefaultPathHash()}getNextStage(e){const t=this.getDefaultPath(),n=t.indexOf(Object(r.a)(e));return-1!==n&&n<t.length-1?t[n+1]:null}getPreviousStage(e){const t=this.getDefaultPath(),n=t.indexOf(Object(r.a)(e));return n<=0?null:t[n-1]}_initializeDefaultPathFromRootStages(){this._defaultPath=new o;const e=this._context.businessProcessFlowVisitor.get_firstLevelStages();let t=0;for(const n in e)this._defaultPath.setNode(t,new s(n)),t++}_initializeTraversedPath(){this._loadTimeDefaultPathCalculator.traversedPath=this._traversedPathProvider.getTraversedPath(),this._loadTimeDefaultPathCalculator.calculate(),this._defaultPath=this._loadTimeDefaultPathCalculator.getDefaultPath()}_initializeNonTraversedPath(){this._afterLoadPathCalculator.startingNodeInDefaultPath=this._loadTimeDefaultPathCalculator.getLastCalculatedDefaultNode(),this._afterLoadPathCalculator.calculate(),this._defaultPath=this._afterLoadPathCalculator.getDefaultPath(),this._runTimePathCalculator.calculate()}get _loadTimeDefaultPathCalculator(){return this._loadTimePathCalculator||(this._loadTimePathCalculator=new p(this._context,this._defaultPath)),this._loadTimePathCalculator}get _afterLoadPathCalculator(){return this.__afterLoadPathCalculator||(this.__afterLoadPathCalculator=new S(this._context,this._changeListener,this._defaultPath)),this.__afterLoadPathCalculator}get _runTimePathCalculator(){return this.__runTimePathCalculator||(this.__runTimePathCalculator=new v(this._context,this._changeListener,this._defaultPath)),this.__runTimePathCalculator}}var _=n("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class I{setPrimaryModel(e){this._primaryModelName=e}getDefaultPathManager(){return this._defaultPathManager}setObjectModel(e){const t=new Microsoft.Crm.Workflow.ObjectModel.WorkflowStep("",0),n={};e.businessProcessFlowEntities.forEach(e=>{if(this._isRelationshipStep(e)){const n=this._createRelationshipCollectionStep(t,e);n&&t.appendStep(n)}else{const r=this._createEntity(t,e);r&&(t.appendStep(r),n.hasOwnProperty(r.get_EntityLogicalName())||(n[r.get_EntityLogicalName()]=!0))}}),t.set_Name(e.businessProcessFlowName),t.set_Id(e.businessProcessFlowId?e.businessProcessFlowId.guid:""),this._processObjectModel=t,this._initializeVisitor()}initializeDefaultPathManager(e,t){const n=new a;n.processManager=t,n.businessProcessFlowVisitor=this._businessProcessFlowVisitor,n.workflowStep=this._processObjectModel,n.currentEntityName=this._primaryModelName,this._defaultPathManager=new O(e,n),this._defaultPathManager.initializeComplete()}get businessProcessFlowVisitor(){return this._businessProcessFlowVisitor}getEntityStages(){if(!this._processObjectModel)return null;const e=this._processObjectModel.get_Steps(),t=[];if(e){for(let n=0;n<e.get_Count();n++){const r=e.get_item(n);r&&r instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep&&(t[t.length]=e.get_item(n))}return t}return null}getRequiredFlowStepsForStage(e,t,n,r){const i=[],a=this.getStage(e);if(!a)throw new Error(e+" is not a valid stage id.");const s=a.get_Steps();if(!s)throw new Error(e+" does not include valid steps");for(let e=0;e<s.get_Count();e++)if(s.get_item(e)instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){const t=s.get_item(e);this._isFlowStep(t)&&t.get_isProcessRequired()&&i.push(t.get_Id())}return i}getRequiredAttributesForStage(e,t,n,r){const i=[],a=this.getStage(e);if(!a)throw new Error(e+" is not a valid stage id.");const s=a.get_Steps();if(!s)throw new Error(e+" does not include valid steps");for(let e=0;e<s.get_Count();e++)if(s.get_item(e)instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){const a=s.get_item(e);if(!this._isActionStep(a)&&!this._isFlowStep(a))if(a.get_isProcessRequired())i.push(a.get_Description());else{const e=this._getDataFieldNameFromStepStep(a);e&&this._isRequiredAttribute(e,t,n,r)&&i.push(a.get_Description())}}return i}_getDataFieldNameFromStepStep(e){if(this._isActionStep(e)||this._isFlowStep(e))return null;if(this._isControlStep(e)){const t=e.get_Steps().get_item(0);return!t||t.get_isSystemControl()?null:t.get_dataFieldName()}return null}_isRequiredAttribute(e,t,n,r){if(null!=e){return 2===Object(_.pc)(r,t,n,e)}return!1}_isFlowStep(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0){if(e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.FlowStep)return!0}return!1}_isActionStep(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0){if(e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep)return!0}return!1}_isControlStep(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0){if(e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ControlStep)return!0}return!1}_initializeVisitor(){this._businessProcessFlowVisitor=new ProcessObjectModel.Visitors.BusinessProcessFlowVisitor,this._businessProcessFlowVisitor.visit(this._processObjectModel)}_isRelationshipStep(e){return!(!e||!e.hasOwnProperty("relationships"))}_createEntity(e,t){const n=new Microsoft.Crm.Workflow.ObjectModel.EntityStep(e,t.entityLogicalName);n.set_Name(t.entityLogicalName),n.set_Description(t.entityDisplayName),n.set_relationshipName(t.relationshipName),n.set_attributeName(t.referencingAttributeName),n.set_parent(e);const r=this._createStage(e,t.stage);n&&r&&n.appendStep(r);for(let n=0;n<t.stage.steps.length;n++){const i=this._createStep(e,t.stage.steps[n]);i&&r.appendStep(i)}const i=this._createConditionStep(e,r,t.stage);return i&&r.appendStep(i),n}_createRelationshipCollectionStep(e,t){const n=new Microsoft.Crm.Workflow.ObjectModel.RelationshipCollectionStep(e);if(n.set_workflow(e),t.relationships)for(let r=0;r<t.relationships.length;r++){const i=this._createRelationshipStep(e,t.relationships[r]);n.appendStep(i)}return n}_createRelationshipStep(e,t){const n=new Microsoft.Crm.Workflow.ObjectModel.RelationshipStep(e);return n.set_workflow(e),n.set_sourceStageId(t.sourceStageId.guid),n.set_targetStageId(t.targetStageId.guid),n.set_attributeName(t.attributeName),n.set_relationshipName(t.relationshipName),n}_createStage(e,t){const n=new Microsoft.Crm.Workflow.ObjectModel.StageStep(e,t.stageDisplayName||"dummy");return n.set_Id(t.stageId.guid),n.set_stageId(t.stageId.guid),n.set_nextStageId(t.nextStageId?t.nextStageId.guid:""),n.set_stageCategory(t.stageCategory),n}_createStep(e,t){const n="action"===t.stepType.toLowerCase()?t.label:t.name,r=new Microsoft.Crm.Workflow.ObjectModel.StepStep(e,n||"dummy");r.set_isProcessRequired(t.required),r.set_Name(t.label),r.set_Id(t.stepId?t.stepId.guid:""),r.set_workflow(e);const i=new Microsoft.Crm.Workflow.ObjectModel.ControlStep(e);if(i.set_dataFieldName(n),"action"===t.stepType.toLowerCase()){const t=new Microsoft.Crm.Workflow.ObjectModel.ActionStep(e);t.set_Name(n),t.set_actionControl(i),r.appendStep(t)}else if("modernflow"===t.stepType.toLowerCase()){const t=new Microsoft.Crm.Workflow.ObjectModel.FlowStep(e);t.set_Name(n),t.set_flowControl(i),r.appendStep(t)}else r.appendStep(i);return r}_createConditionStep(e,t,n){if(!n.conditionJson)return null;const r=new Microsoft.Crm.Workflow.ObjectModel.ConditionStep(e);return r.set_parent(t),r.initializeFromDynamic(JSON.parse(n.conditionJson)),r.fixLinks(),r}getProcessObjectModel(){return this._processObjectModel}getStage(e){return Object(i.a)(e)||!this._processObjectModel?null:this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(e)?this._businessProcessFlowVisitor.get_stagesById()[e]:null}getPreviousStageId(e){if(this._defaultPathManager&&this._businessProcessFlowVisitor){const t=this._defaultPathManager.getPreviousStage(e);if(this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(t))return t}return null}getNextStageId(e){if(this._defaultPathManager&&this._businessProcessFlowVisitor){const t=this._defaultPathManager.getNextStage(e);if(this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(t))return t}return null}}},cf3Y:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="attribute.format";function a(e,t,n,a){const s=Object(r.x)(t);return{type:i,payload:a,meta:{pageId:e,contextKey:s,dataFieldName:n}}}},d0Pd:function(e,t,n){"use strict";n.d(t,"a",(function(){return P}));var r=n("3/02"),i=n("SAYH"),a=n("eXjw"),s=n("j2fa"),o=n("dQnL"),c=n("CngE"),l=n("GEBM"),u=n("0L4T"),d=n("FZDd"),p=n("EY5k"),h=n("a72m"),g=n("YxC/"),m=n("KBcj"),b=n("p/2N"),y=n("16wZ"),f=n("K3gL"),S=n("ngeo"),v=n("504W"),C=n("95wm"),O=n("haag");function _(e,t,n){return{type:"chartData.retrieve.preReq_async",execute({dispatch:r,getState:_},I){let j=_();const P=O.b+".chartData.retrieve.preReq_async",F=e.visualizationId,T=e.viewId;return r(Object(h.a)(t,void 0,e.viewType,T)).then(()=>{j=_();const h=Object(m.c)(j,T);if(!function(e,t,r,i){if(!r||!r.fetchXML)return Object(u.a)(e,t,Object(g.b)(e,l.g),i,n),!1;return!0}(j,r,h,e))return Promise.resolve(null);const y=r(Object(o.a)(t,e.visualizationType,F)),S=r(Object(p.e)(l.A));return Promise.all([y,S]).then(()=>{j=_();const t=Object(c.a)(j,F);if(function(e){if(e&&e.WebResourceId)return!0;return!1}(t))return Object(s.d)(j,r,i.a.toString(e.visualizationId),i.a.toString(e.viewId),n),Promise.resolve(e);if(!function(e,t,r,i){if(r){if(r.initialized===a.a.Error){const a=Object(f.a)(r.errorCode)||l.u;return t(Object(p.e)([a])).then(()=>{const r=Object(g.b)(e,a);Object(u.a)(e,t,r,i,n)},()=>{Object(u.a)(e,t,Object(g.b)(e,l.u),i,n)}),!1}return!!r.DataDescription||(Object(u.a)(e,t,Object(g.b)(e,l.o),i,n),!1)}return!1}(j,r,t,e))return Promise.resolve(null);e.initialized||(e.initialize(t.DataDescription,h.fetchXML,t.PresentationDescription,h.title,h.entityLogicalName,t.Name,t.PrimaryEntityTypeCode,!1),e.setupAggregationQueries());const o={},m=e.dataDefinition.allAttributeNamesByEntity;Array.from(m.keys()).map(e=>{const t=Array.from(m.get(e).keys());o[e]=t});const y=Object(b.c)(h).filter(e=>-1===e.indexOf("."));if(y&&y.length>0){const e=h.entityLogicalName;e in o?o[e].push(...y):o[e]=y}try{const e=t.PresentationDescription,n=Object(C.a)(e);if(!Object(v.b)(e)&&n.length>0){const e=h.entityLogicalName,t=[];t.push(function(e,t){const n=t[2]?t[2].toLowerCase():"";if(n.substring(0,e.length)!==e)return"";return n.substring(e.length+1,n.length)}(e,n)),e in o?o[e].push(...t):o[e]=t}}catch(e){const t="Failed to retrieve entity metadata attributes for Chart Series with error : "+e.message;I.EventManager.ReportComponentFailure(P,Error(t))}return r(Object(d.e)(o)).then(()=>e)},t=>(Object(u.b)(t.getNegativeErrorCode(),_(),r,Object(g.b)(_(),l.q),e,n),Promise.resolve(null)))},t=>{const i=t&&!Object(y.a)(t.errorCode)&&t.errorCode,a=Object(f.a)(i),s=a?Object(g.b)(j,a):"retrieve chart failed. error code: "+S.a.getHexErrorCodeFromInt(i);return Object(u.a)(j,r,s,e,n),Promise.resolve(null)})}}}var I=n("Tezb"),j=n("Lyxw");function P(e,t,n,o=!1){return{type:"chartData.retrieve.async",execute({dispatch:l,getState:u},d){const p=[];try{p.push({name:O.g,value:i.a.toString(e.viewId)}),p.push({name:O.h,value:i.a.toString(e.visualizationId)});const h=u(),g=e.visualizationId,m=i.a.toString(g),b=e.viewId,y=i.a.toString(b);if(!Object(C.b)(u,l,d,p,e,t,n))return Promise.resolve();let f;const S=Object(j.c)(h,r.rd);return f=S?Object(c.e)(h,e.getStorageKey()):Object(c.d)(h,m,y),(f===a.a.Initialized&&Object(c.b)(h,m,y)||f===a.a.Initializing)&&!o?Promise.resolve():(l(S?Object(C.d)(e.getStorageKey(),I.c):Object(C.c)(m,y,I.c)),l(_(e,t,n)).then(e=>{if(!e||e.isWebResourceChart)return Promise.resolve();const r=e;return l(Object(s.b)(r,t,n))}))}catch(e){return d.EventManager.ReportComponentFailure(C.f+".retrieveChartData",Error(e),O.b,p),Promise.reject(e)}}}}},dIqG:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="navigation.item.visibility";function i(e,t,n){return{type:r,payload:{show:n},meta:{pageId:e,navigationItemId:t}}}},dMZy:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(){return{tabId:"",navigationStack:[]}}n.d(t,"a",(function(){return r}))},dQnL:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n("SAYH"),i=n("eXjw"),a=n("95wm"),s=n("CngE"),o=n("haag"),c=n("BzGi"),l=n("K7RF"),u=n("Nb1E"),d=n("odYE"),p=n("2XFH"),h=n("Uv1Y"),g=n("Tezb"),m=n("/oKV"),b=n("iJGp"),y=n("S2mk"),f=n("3/02"),S=n("Lyxw");function v(e,t=c.a.savedvisualization,n){const p=[];return p.push({name:o.f,value:e}),p.push({name:o.i,value:t}),p.push({name:o.h,value:r.a.toString(n)}),{type:"chart.retrieve.async",execute({dispatch:g,getState:y},v){try{let C=m.a.LocalAndRemote;const _=v.TraceManager.getTracer(o.d),P=v.DataSource,w=y();let E=n;if(_.info(o.d+"entityTypeName:"+e+"visualizationType:"+t+"visualizationId:"+n),!e){const e="entityTypeName is null";return v.EventManager.ReportComponentFailure(a.f+".retrieveChart",Error(e),o.d,p),Promise.reject(e)}r.a.isNullOrEmpty(E)&&(E=Object(s.j)(w,e));const x=Object(S.c)(y(),f.A);if(!r.a.isNullOrEmpty(E)){const n=Object(s.f)(w,E),r=Object(s.g)(w,E),y=()=>{const n=Object(s.a)(w,E),r=function(e,t,n,r){const i=c.a[n],a=Object(s.i)(e,t);return a&&a.chartTypes&&a.chartTypes[i]&&a.chartTypes[i][r.guid]}(w,e,t,E),i=r&&!r.IsUserChart;switch(Object(l.d)(w,i,n,()=>r)){case 1:C=m.a.Remote;break;case 2:g(function(e,t,n){const r=[];return r.push({name:"entityTypeName",value:t}),r.push({name:"visualizationType",value:n}),{type:"chartselector.retrieve.async",execute({dispatch:e,getState:i},s){try{return e(Object(l.b)(c.a[n],null,t,null,!0,b.a.OnDemandWithContext,null,null,[],null,m.a.LocalAndRemote)).catch(h.b)}catch(e){throw s.EventManager.ReportComponentFailure(a.f+"._retrieveChartSelector",Error(e),o.e,r),e}}}}(0,e,t))}};if(n===i.a.Initialized){if(y(),C!==m.a.LocalAndRemote)return I(g,P,e,E,t,C,v,p);if(x&&r===i.a.Uninitialized){const e=new d.a(t===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",E),n=Object(s.a)(w,E);return g(O(E,i.a.Initialized)),g(Object(u.d)(e)).catch(h.b).then(e=>(j(n,e),g(F(e)),v.EventManager.ReportComponentSuccess(a.f+".retrieveChartOData"),Promise.resolve(E)),e=>(T(g,e,E.guid,n,v,p),Promise.resolve(E)))}return Promise.resolve(E)}return I(g,P,e,E,t,C,v,p)}return I(g,P,e,E,t,C,v,p)}catch(e){throw v.EventManager.ReportComponentFailure(a.f+".retrieveChart",Error(e),o.d,p),e}}}}function C(e){return{type:"chart.dependencies.update.async",execute({dispatch:t,getState:n},i){const a=[];for(const t in e)a.push(e[t]+":name");if(a.length>0){return t(Object(p.a)(a)).then(()=>{const i=new Map,a=n();for(const t in e){const n=e[t],o=Object(s.a)(a,new r.a(n));o&&n&&a.metadata.labels&&a.metadata.labels[n]&&a.metadata.labels[n].name&&(o.Name=a.metadata.labels[n].name,i.set(n,o))}i.size>0&&t(function(e){const t={};e.forEach((e,n)=>{t[n]=e});return{type:"chart.descriptor.update",payload:{charts:t}}}(i))},h.b)}return Promise.resolve()}}}function O(e,t){const n=r.a.isNullOrEmpty(e)?null:{charts:{[r.a.toString(e)]:{initialized:t,oDataInitialized:i.a.Initializing}}};return{type:g.f,payload:n}}function _(e,t,n,s=c.a.savedvisualization,p){const g=[];return g.push({name:o.f,value:t}),g.push({name:o.i,value:s}),g.push({name:o.h,value:r.a.toString(n)}),{type:"chart.retrieve.async",execute:({dispatch:e,getState:o},m)=>Object(S.c)(o(),f.A)?n?function(e,t,n,s,o,p,g){const m=new d.a(s===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",n);return e(O(n,i.a.Initializing)),Promise.all([e(Object(l.b)(c.a[s],null,t,r.a.toLegacyGuid(n),!0,b.a.OnDemandWithContext,null,null,[],null,o)).catch(h.b),e(Object(u.d)(m)).catch(h.c)]).then(t=>(t[1].constructor===h.a?T(e,t[1],n.guid,t[0].charts[n.guid],p,g):(j(t[0].charts[n.guid],t[1]),e(F(t[1])),p.EventManager.ReportComponentSuccess(a.f+".retrieveChartOData")),t[0]))}(e,t,n,s,p,m,g):function(e,t,n,s,o,p,g){return e(Object(l.b)(c.a[s],null,t,r.a.toLegacyGuid(n),!0,b.a.OnDemandWithContext,null,null,[],null,o)).catch(h.b).then(t=>{const n=new r.a(Object.keys(t.charts)[0]),o=new d.a(s===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",n);return e(O(n,i.a.Initializing)),e(Object(u.d)(o)).catch(h.b).then(r=>(j(t.charts[n.guid],r),e(F(r)),p.EventManager.ReportComponentSuccess(a.f+".retrieveChartOData"),t),r=>(T(e,r,n.guid,t.charts[n.guid],p,g),t))})}(e,t,n,s,p,m,g):function(e,t,n,i,a){return e(Object(l.b)(c.a[i],null,t,r.a.toLegacyGuid(n),!0,b.a.OnDemandWithContext,null,null,[],null,a)).catch(h.b)}(e,t,n,s,p)}}function I(e,t,n,s,c,l,u,d){return e(function(e){const t=r.a.isNullOrEmpty(e)?null:{charts:{[r.a.toString(e)]:{initialized:i.a.Initializing}}};return{type:g.b,payload:t}}(s)),e(_(0,n,s,c,l)).then(t=>{t&&t.chartSelectors&&!t.chartSelectors[n]&&(t.chartSelectors[n]={initialized:i.a.Initialized,chartTypes:{}});const o=[];for(const e in t.charts)o.push(e);return e(C(o)).then(()=>(e(P(t)),r.a.isNullOrEmpty(s)&&(s=t.chartDefaults[n]),u.EventManager.ReportComponentSuccess(a.f+".retrieveChart"),s),h.b)},t=>{const c=t&&!Object(y.j)(t.errorCode)&&t.errorCode,l={chartSelectors:{[n]:{initialized:i.a.Initialized,chartTypes:{}}}};if(e(P(l)),Object(y.j)(c))return u.EventManager.ReportComponentFailure(a.f+".retrieveChart",Error(t),o.d,d),Object(h.b)(t);{const t={charts:{[r.a.toString(s)]:{initialized:i.a.Error,errorCode:c}}};e(P(t))}})}function j(e,t){e.PresentationDescription=t.presentationdescription.replace(/(\r\n\s*)/g,""),e.oDataInitialized=i.a.Initialized}function P(e){return{type:g.b,payload:e}}function F(e){return{type:g.f,payload:e}}function T(e,t,n,r,s,c){e(F({charts:{[n]:{initialized:r.initialized,oDataInitialized:i.a.Error}}})),s.EventManager.ReportComponentFailure(a.f+".retrieveChartOData",Error(t),o.c,c)}},dtbk:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="navigation.item.defaultvalues";function i(e,t,n){return{type:r,payload:{allNavBarByRelationshipItems:t,currentLanguageId:n},meta:{pageId:e}}}},e1AF:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("FZDd"),i=n("NP1x"),a=n("69Qu"),s=n("i1f0");function o(e){const t=[{name:"parentEntity",value:e}];return{type:"relatedEntity.loadMetaData.async",execute({dispatch:n,getState:o},c,l){const u=o(),d=Object(i.b)(u,e),p=!Object(a.b)(u),h=p?{}:d;if(p&&d){const e=Object(s.Wb)(u,Object.keys(d));e&&e.forEach(e=>{h[e]=d[e]}),t.push({name:"all_related_entities_filtered_by_offline_profile",value:h?Object.keys(h).toString():null})}t.push({name:"all_related_entities",value:d?Object.keys(d).toString():null});const g=e=>(c.EventManager.ReportComponentFailure("relatedEntity.loadMetaData",e,void 0,t),!0);return n(Object(r.e)(h)).then(()=>(p&&c.EventManager.ReportComponentSuccess("relatedEntity.loadMetaData",t),!0),g).catch(g)},getFailureParameters:(e,n)=>t}}},eu2O:function(e,t,n){"use strict";n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"b",(function(){return i})),n.d(t,"f",(function(){return s})),n.d(t,"i",(function(){return o})),n.d(t,"g",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"h",(function(){return a})),n.d(t,"a",(function(){return u}));var r=n("zJiL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="#FDE7E9",a="#107C10",s="#A80000",o="#D83B01",c="#6E6F77",l="#E8EAEC",u=32;function d(e){return e===r.a?i:e===r.e?"#FED9CC":e===r.c?"#E1DFDD":e===r.d?"#DFF6DD":"#FFF4CE"}function p(e){return e===r.a?s:e===r.e?o:e===r.d?a:c}},fREn:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n("eXjw"),i=n("dHD5"),a=n("37s6"),s=n("a8zb"),o=n("BoVI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e,t,n,a,s,c,u,d){const p=Object(i.v)(s),h=function(e,t){if(!e)return null;const n=new DOMParser,r=e?n.parseFromString(e,"text/xml"):null;if(!r)return null;const i=r.documentElement?r.documentElement.children?r.documentElement.children:r.documentElement.childNodes:void 0;if(!i)return null;const a=i,s=[];for(let e=0;e<a.length;e++){if(!a[e].getAttribute)continue;const r=a[e]?a[e].children?a[e].children:a[e].childNodes:void 0,i=[];let o=null;for(let e=0;e<r.length;e++){const a=r[e];if(!a.getAttribute)continue;const s=a.getAttribute("name");let c;({relatedEntityName:c,fetchXmlDocument:o}=l(s,o,n,t)),i.push({name:s,width:parseInt(a.getAttribute("width"),10),relatedEntityName:c,disableMetaDataBinding:"1"===a.getAttribute("disableMetaDataBinding"),labelId:a.getAttribute("labelId"),isHidden:"1"===a.getAttribute("isHidden"),disableSorting:"1"===a.getAttribute("disableSorting"),addedBy:a.getAttribute("addedBy"),desc:a.getAttribute("desc"),cellType:a.getAttribute("cellType"),imageProviderWebresource:a.getAttribute("imageProviderWebresource"),imageProviderFunctionName:a.getAttribute("imageProviderFunctionName")})}const c={name:a[e].getAttribute("name"),id:a[e].getAttribute("id"),cells:i,multiObjectIdField:a[e].getAttribute("multiObjectIdField"),layoutStyle:a[e].getAttribute("multiObjectIdField")};s.push(c)}return{name:r.documentElement.getAttribute("name"),object:parseInt(r.documentElement.getAttribute("object"),10),rows:s,customControlDescriptions:null,jump:r.documentElement.getAttribute("jump"),select:"1"===r.documentElement.getAttribute("select"),icon:"1"===r.documentElement.getAttribute("icon"),preview:"1"===r.documentElement.getAttribute("preview"),iconRenderer:null}}(d,u),g={initialized:r.a.Initialized,viewId:n,fetchXML:u,entityLogicalName:a,title:c,layoutXML:d,grid:h,isCustomView:!0};return{type:o.a,payload:{views:{[n.guid]:g}},meta:{pageId:e,controlName:t,contextKey:p}}}function l(e,t,n,r){let i="";if(e.indexOf(".")>0){const a=e.split(".")[0];t||(t=n.parseFromString(r,"text/xml"));const s=t.querySelector('link-entity[alias="'+a+'"]');s&&(i=s.getAttribute("name")||"")}return{relatedEntityName:i,fetchXmlDocument:t}}function u(e){return{type:o.f,execute:(t,n)=>(Object(a.w)(t.getState())?s.a.createSqlfromFetchXMLAsync(t,e.fetchXML):Promise.resolve(null)).then(t=>e.offlineSqlQuery=t)}}},fyfl:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return d}));var r=n("SAYH"),i=n("FZDd"),a=n("d0w6"),s=n("Uv1Y"),o=n("a72m"),c=n("BFlg"),l=n("kKLx"),u=n("P6DH");function d(e,t,n){return{type:"datasethost.dependencies.retrieve.async",execute({dispatch:d,getState:h},g){const m=g.TraceManager.getTracer(c.z),b=c.x+".loadDataSetHostDependenciesAction";m.info(`Retrieving view with ID ${r.a.toString(t)} for ${e} entity.`);const y=Object(u.pb)(h(),e,t);return d(Object(o.a)(e,a.a.MAIN_APPLICATION_VIEW,y,t)).then(a=>{if(!a){const n=`Unable to retrieve DataSetHost dependencies for the grid. Failed to retrieve view with ID ${r.a.toString(t)} for ${e}`;return g.EventManager.ReportComponentFailure(b,Error(n)),Promise.reject(new s.a(l.b))}const o=p(h(),t,n);return d(Object(i.e)(o)).then(()=>{const n=[{name:"entityTypeName",value:e},{name:"viewId",value:r.a.toString(t)}];return g.EventManager.ReportComponentSuccess(b,n),Promise.resolve()}).catch(n=>{let i=[];for(const e in o)o[e].length&&(i=[...o[e],...i]);const a=`Unable to retrieve DataSetHost dependencies for the grid for view with ID ${r.a.toString(t)}. Failed to retrieve entity with attributes ${i.join()} for ${e}`;return g.EventManager.ReportComponentFailure(b,Error(a)),Promise.reject(new s.a(l.a))})})}}}function p(e,t,n){const r=Object(u.qb)(e,t,n),i={};if(r&&r.grid&&r.grid.rows&&r.grid.rows[0]&&r.grid.rows[0].cells){const e=[];r.grid.rows[0].cells.forEach(t=>{if(!t.disableMetaDataBinding)if(t.relatedEntityName){if(t.name&&-1!==t.name.indexOf(".")){const e=t.name.split(".")[1];i[t.relatedEntityName]||(i[t.relatedEntityName]=[]),-1===i[t.relatedEntityName].indexOf(e)&&e&&i[t.relatedEntityName].push(e)}}else-1===e.indexOf(t.name)&&e.push(t.name)}),e.length>0&&(i[r.entityLogicalName]=e)}return i}},gDO8:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="form.setFormLoadError";function i(e,t){return{type:r,payload:{error:t},meta:{pageId:e}}}},hA8P:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="control.mrudisabled";function a(e,t,n,a,s){const o=Object(r.v)(a);return{type:i,payload:s,meta:{pageId:t,controlName:n,contextKey:o}}}},"hQd/":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e){this._value=null,this._value=e}get value(){return this._value}set value(e){this._value=e}}},hSDL:function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return d})),n.d(t,"l",(function(){return m})),n.d(t,"i",(function(){return b})),n.d(t,"m",(function(){return y})),n.d(t,"n",(function(){return f})),n.d(t,"k",(function(){return S})),n.d(t,"h",(function(){return v})),n.d(t,"o",(function(){return g})),n.d(t,"j",(function(){return C}));var r=n("dHD5"),i=n("BFlg"),a=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="grid.applyFilter",o="grid.applyActivityTypeFilter",c="grid.applyJumpBarFilter",l="grid.applyQuickFindFilter",u="grid.applyFilterCurrentValue",d="grid.applyActivityTypeFilterCurrentValue",p="grid.applyAdvancedFindFilter";function h(e,t,n,a){return{type:"grid.applyFilter.async",execute({dispatch:s},o){const c=o.TraceManager.getTracer(i.z),l=i.x+".applyGridFilterAction",u=Object(r.v)(a),d=[];d.push({name:i.n,value:e}),d.push({name:i.e,value:u});try{return c.info("Applying the filter expression to the grid. "),s(function(e,t,n,r){return{type:e,payload:t,meta:{pageId:n,dataSetContextKey:r}}}(e,t,n,u)),o.EventManager.ReportComponentSuccess(l,d),Promise.resolve()}catch(e){const t="Applying the filter expression to the grid failed ";o.EventManager.ReportComponentFailure(l,Error(t),"",d)}}}}function g(e,t,n){const i=Object(r.v)(n);return{type:c,payload:e,meta:{pageId:t,dataSetContextKey:i}}}const m=(e,t,n)=>h(s,e,t,n),b=(e,t,n)=>h(o,e,t,n),y=(e,t,n)=>h(c,e,t,n),f=(e,t,n)=>h(l,Object(a.a)(e)?e:e.trim(),t,n),S=(e,t,n)=>h(u,e,t,n),v=(e,t,n)=>h(d,e,t,n),C=(e,t,n)=>h(p,e,t,n)},hXGe:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"d",(function(){return h})),n.d(t,"e",(function(){return g})),n.d(t,"f",(function(){return m}));var r=n("+zjj"),i=n("YxC/"),a=n("i1f0"),s=n("dHD5"),o=n("X3qb"),c=n("WZ96");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l="related_entity",u="related_tab",d="tablist";function p(e,t){if(e&&e.length&&t.length)return e.substr(0,e.length-t.length-"_".length)}function h(e){return e.find(e=>e.id===u)}function g(e,t){return e&&t?Object.assign(Object.assign({},e),{[c.b]:`${t}-${c.d}-tabHeader`,[c.c]:25..toString()}):e}function m(){let e=null;return function(t,n){const{props:c,resourceStrings:d,selectedRelatedEntity:p,isInCreateMode:h}=n,g=Object(i.c)(d,o.e),m=[],b=Object(s.j)(t,c.id);for(const e of c.availableTabs)m.push({name:e.Name,label:Object(a.Hc)(t,e.Id,c.id,b),id:e.Id,visible:Object(a.Kc)(t,e.Id,c.id,b),previewId:e.PreviewId});p&&m.push({name:p.id,label:p.title,id:l,visible:!0});const y=Object(r.h)(t,c);!h&&y&&m.push({name:"tab_related3b554255-7717-4d17-bb7f-9936fb1e75ca",label:g,id:u,visible:!0});const f=e&&e.every((e,t)=>m[t]&&e.label===m[t].label),S=e&&e.every((e,t)=>m[t]&&e.name===m[t].name),v=e&&e.every((e,t)=>m[t]&&e.id===m[t].id),C=e&&e.every((e,t)=>m[t]&&e.visible===m[t].visible);return S&&f&&v&&C&&e.length===m.length||(e=m),e}}},haag:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"g",(function(){return i})),n.d(t,"h",(function(){return a})),n.d(t,"f",(function(){return s})),n.d(t,"i",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Chart.Component",i="ViewId",a="visualizationId",s="entity Type",o="chart visualization type",c="RETRIEVECHART",l="RETRIEVECHARTTS_RETRIEVECHARTSELECTOR",u="RETRIEVECHARTTS_RETRIEVECHARTDATA",d="RETRIEVECHARTTS_RETRIEVECHARTODATA"},iHOm:function(e,t,n){"use strict";n.d(t,"a",(function(){return ie}));var r=n("2YQW"),i=n("ZJsz"),a=n("RrRu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s=[],o=Object(r.d)({[a.a]:function(e=s,t){return t.payload?t.payload:e}},s);var c=n("jRHm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const l=Object(r.d)({[c.a]:function(e=null,t){return t?t.payload:e}},null);var u=n("Jpj4"),d=n("ApeL"),p=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const h=Object(r.d)({[u.a]:function(e=null,t){return t.payload?t.payload:e},[d.b]:function(e=null,t){if(e&&e.records){const n=e.records.filter(e=>Object.keys(e)[0]===p.a.toString(t.payload.recordId));if(n&&n.length){const e=n[0];e&&e[p.a.toString(t.payload.recordId)]&&e[p.a.toString(t.payload.recordId)].filter(e=>Object.keys(e)[0]===t.payload.attributeName)&&(void 0!==t.payload.requiredLevel&&(e[p.a.toString(t.payload.recordId)].filter(e=>Object.keys(e)[0]===t.payload.attributeName)[0][t.payload.attributeName].requiredLevel=t.payload.requiredLevel),void 0!==t.payload.isDisabled&&(e[p.a.toString(t.payload.recordId)].filter(e=>Object.keys(e)[0]===t.payload.attributeName)[0][t.payload.attributeName].isDisabled=t.payload.isDisabled),void 0!==t.payload.notifications&&(e[p.a.toString(t.payload.recordId)].filter(e=>Object.keys(e)[0]===t.payload.attributeName)[0][t.payload.attributeName].notifications=t.payload.notifications))}}return e},[d.a]:function(e=null,t){return e}},null);var g=n("hSDL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const m={activityOrQueue:null,jumpBar:null,quickFind:null,advancedFindFilter:null,activityOrQueueFilterValue:null,activityTypeFilter:null,activityTypeSelectedValues:null},b=function(e=m,t){switch(t.type){case g.e:return Object.assign(Object.assign({},e),{activityOrQueue:t.payload});case g.b:return Object.assign(Object.assign({},e),{activityTypeFilter:t.payload});case g.f:return Object.assign(Object.assign({},e),{jumpBar:t.payload});case g.g:return Object.assign(Object.assign({},e),{quickFind:t.payload});case g.d:return Object.assign(Object.assign({},e),{activityOrQueueFilterValue:t.payload});case g.c:return Object.assign(Object.assign({},e),{advancedFindFilter:t.payload});case g.a:return Object.assign(Object.assign({},e),{activityTypeSelectedValues:t.payload});default:return e}},y=Object(r.d)({[g.e]:b,[g.f]:b,[g.g]:b,[g.d]:b,[g.c]:b,[g.b]:b,[g.a]:b},m);var f=n("QXpm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const S=Object(r.d)({[f.a]:function(e=false,t){return e!==t.payload?t.payload:e}},false);var v=n("E6o7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const C=Object(r.d)({[v.a]:function(e="",t){return t.payload?t.payload:e}},"");var O=n("ojtV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const _=Object(r.d)({[O.a]:function(e=false,t){return t.payload&&"showChart"===t.payload.name?t.payload.value:e}},false);var I=n("iOrn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const j={customFilterXml:null,source:null,timeStamp:null},P=Object(r.d)({[I.a]:function(e=j,t){return null!=t.payload?t.payload:e}},j);var F=n("LAGg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const T=Object(r.d)({[F.a]:function(e,t){if(t.payload)return t.payload;return e}},0);var w=n("mLMm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const E=Object(r.d)({[w.a]:function(e,t){if(t.payload)return t.payload;return e}},0);var x=n("waMg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const N=Object(r.d)({[x.a]:function(e=null,t){return t.payload?t.payload:e}},null);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function A(e,t){return t.payload?t.payload:e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function k(e=!1,t){return e!==t.payload?t.payload:e}var M=n("Utin");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const D=Object(r.d)({[M.a]:function(e=null,t){return t.payload&&"ViewId"===t.payload.name?p.a.tryParseOrNull(t.payload.value):e}},null);var R=n("WK+4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const B=Object(r.d)({[R.a]:function(e=null,t){return t.payload&&"VisualizationId"===t.payload.name?p.a.tryParseOrNull(t.payload.value):e}},null);var L=n("qwRa");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const V=n("BzGi").a.savedvisualization,z=Object(r.d)({[L.a]:function(e=V,t){return t.payload&&"chartVisualizationType"===t.payload.name?t.payload.value:e}},V),H={parameters:{}};const G=Object(r.d)({[M.a]:function(e=H,t){const n=t.payload.name,r=e.parameters;let i;for(const e in r)r[e].Name===n&&(i=e);const a=Object.assign(Object.assign({},e.parameters[i]),{Value:t.payload.value}),s=Object.assign(Object.assign({},e.parameters),{[i]:a});return s[n]&&(s[n]=t.payload.value),Object.assign(Object.assign({},e),{parameters:s})}},H),W=Object(r.b)("controlName",G);var U=n("s+OO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const q=Object(r.d)({[U.b]:(e="",t)=>t.payload&&t.payload.name===U.a?t.payload.value:e},"");var X=n("7k+e");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Y=[],K=Object(r.d)({[X.b]:(e=Y,t)=>t.payload&&t.payload.name===X.a?t.payload.value:e},Y);var Q=n("L4PC"),Z=n("5UPV"),J=n("zFtG"),$=n("Wdaq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function ee(e,t){return t.payload?t.payload:e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const te=Object(r.d)({[$.a]:function(e,t){if(t)return t.payload;return e}},"");var ne=n("ujVH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const re=Object(r.d)({[ne.a]:function(e=null,t){return t.payload?t.payload:e}},null),ie=Object(r.b)("dataSetContextKey",(e=i.a,t)=>{switch(t.type){case a.a:return Object.assign(Object.assign({},e),{selectedRows:o(e.selectedRows,t)});case c.a:return Object.assign(Object.assign({},e),{selectedRelatedEntity:l(e.selectedRelatedEntity,t)});case u.a:return Object.assign(Object.assign({},e),{rowProperties:h(e.rowProperties,t)});case F.a:return Object.assign(Object.assign({},e),{refreshCounter:T(e.refreshCounter,t)});case w.a:return Object.assign(Object.assign({},e),{pagingRefreshInput:E(e.pagingRefreshInput,t)});case x.a:return Object.assign(Object.assign({},e),{queryKey:N(e.queryKey,t)});case I.a:return Object.assign(Object.assign({},e),{customFilter:P(e.customFilter,t)});case g.e:case g.b:case g.f:case g.g:case g.d:case g.c:case g.a:return Object.assign(Object.assign({},e),{filters:y(e.filters,t)});case f.a:return Object.assign(Object.assign({},e),{useRollupView:S(e.useRollupView,t)});case v.a:return Object.assign(Object.assign({},e),{fetchXml:C(e.fetchXml,t)});case M.a:return Object.assign(Object.assign({},e),{viewId:D(e.viewId,t),controls:W(e.controls,t)});case R.a:return Object.assign(Object.assign({},e),{visualizationId:B(e.visualizationId,t)});case L.a:return Object.assign(Object.assign({},e),{chartVisualizationType:z(e.chartVisualizationType,t)});case d.b:case d.a:return Object.assign(Object.assign({},e),{rowProperties:h(e.rowProperties,t)});case Q.a:return Object.assign(Object.assign({},e),{pageNumber:A(e.pageNumber,t)});case Z.a:return Object.assign(Object.assign({},e),{isNewPageRequested:k(e.isNewPageRequested,t)});case J.a:return Object.assign(Object.assign({},e),{pagingData:ee(e.pagingData,t)});case $.a:return Object.assign(Object.assign({},e),{commandManagerId:te(e.commandManagerId,t)});case U.b:return Object.assign(Object.assign({},e),{chartFilterExpression:q(e.chartFilterExpression,t)});case X.b:return Object.assign(Object.assign({},e),{chartDrillDownParameters:K(e.chartDrillDownParameters,t)});case O.a:return Object.assign(Object.assign({},e),{showChart:_(e.showChart,t)});case ne.a:return Object.assign(Object.assign({},e),{dependentOptionSetColumnStatus:re(e.dependentOptionSetColumnStatus,t)});default:return e}})},iOrn:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n("dHD5"),i=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="grid.setCustomFilter";function s(e,t,n,s,o){return{type:"grid.setCustomFilter.async",execute({dispatch:c,getState:l},u){const d=u.TraceManager.getTracer(i.z),p=i.x+".setCustomFilterAction";try{return d.info("Adding a custom filter for the grid. "),c(function(e,t,n,i,s){let o=null;if(null!=e){o={customFilterXml:e,source:t,timeStamp:s||null}}const c=Object(r.y)(i),l=Object(r.v)(i);return{type:a,payload:o,meta:{pageId:n,contextKey:c,dataSetContextKey:l}}}(e,t,n,s,o)),u.EventManager.ReportComponentSuccess(p),Promise.resolve()}catch(e){const t="Adding a custom filter for the grid failed";u.EventManager.ReportComponentFailure(p,Error(t))}}}}},iWfp:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var r=n("nuS9"),i=n("Gilj"),a=n("FhVi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t,n,r,a,s){return new i.a(e,e=>{t(e.EVENT)},n,r,a,s)}function o(e){return r.createElement(a.a,{key:e.id,keyboardShortcuts:e.keyboardShortcuts,defaultFocusId:e.defaultFocusId,rootElementId:e.rootElementId,isModal:e.isModal,shouldManageFocus:e.shouldManageFocus||!1})}},io1E:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var r=n("nuS9"),i=n("4fxQ"),a=n("u+q+"),s=n("gvL4"),o=n("H/hG"),c=n("YWpA"),l=n("Afz2"),u=n("1AYO"),d=n("+zjj"),p=n("3rse"),h=n("RiHV"),g=n("7sMj"),m=n("nVTU"),b=n("7Xh3");class y extends r.Component{constructor(e){super(e),this._keyDownHandler=this._keyDownHandler.bind(this)}render(){if(!this.props.relatedEntityItem)return null;let e=null;if(this.props.relatedEntityItem&&this.props.relatedEntityItem.webResourceIcon)e=r.createElement(b.a,{source:this.props.relatedEntityItem.webResourceIcon,style:this.props.style.navLinkImageStyle});else if(this.props.relatedEntityItem.isCustomEntity){const t={entityReference:new m.a(this.props.relatedEntityItem.entityName)},n=r.createElement(g.a,Object.assign({},t));e=r.createElement(o.a,{key:this.props.relatedEntityItem.id+"_Related",id:this.props.relatedEntityItem.id+"_Related",style:this.props.style.entityIconStyle}," ",n," ")}else e=this.props.relatedEntityItem.icon?r.createElement(o.a,{key:this.props.relatedEntityItem.id+"_Related",id:this.props.relatedEntityItem.id+"_Related",style:this.props.style.entityIconStyle},this.props.relatedEntityItem.icon):r.createElement(c.a,{key:this.props.relatedEntityItem.id+"_Related",id:this.props.relatedEntityItem.id+"_Related",style:this.props.style.tileStyle,testhooks:{id:this.props.relatedEntityItem.id}});return r.createElement(c.a,Object.assign({key:this.props.relatedEntityItem.id,id:this.props.relatedEntityItem.id,style:this.props.style.sectionStyle,role:l.n,accessibilityLabel:this.props.relatedEntityItem.title+" "+this.props.relatedItemsArea,tabIndex:0,onClick:()=>this.props.handleRelatedEntityCallBack(this.props.relatedEntityItem),onKeyDown:this._keyDownHandler},{[h.a.LearningPathDOMAttributeName]:"form-tab-relatedEntity-"+this.props.relatedEntityItem.id},{testhooks:{id:"form-tab-relatedEntity-"+this.props.relatedEntityItem.id}}),e,r.createElement(o.a,{style:this.props.style.entityTitleStyle},this.props.relatedEntityItem.title))}_keyDownHandler(e){e.keyCode===p.a.Tab&&e.preventDefault()}}var f=n("Gilj"),S=n("FhVi"),v=n("unFF"),C=n("b8TU"),O=n("IqkD");var _=n("nJrx"),I=n("YxC/"),j=n("oSQy"),P=n("O7zD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const F=Object(_.a)();class T extends r.Component{constructor(e){super(e),this._tabKeyDownScope="tabs",this._relatedKeyDownScope="relatedItems",this._moveFocus=this._moveFocus.bind(this),this._handleKeyCodeNavigation=this._handleKeyCodeNavigation.bind(this),this._ulOverFlowTabsRef=this._ulOverFlowTabsRef.bind(this),this._handleOutsideClick=this._handleOutsideClick.bind(this),this._relatedItemSelected=this._relatedItemSelected.bind(this),this._tabItemSelected=this._tabItemSelected.bind(this),this.state={selectedIndex:-1,keyDownScope:this._tabKeyDownScope}}_renderRelatedEntitiesList(e,t){const n={sectionStyle:this.props.relatedEntitySectionStyle,tileStyle:this.props.tileStyle,entityTitleStyle:this.props.entityTitleStyle,entityIconStyle:this.props.entityIconStyle,navLinkImageStyle:this.props.navLinkImageStyle};if(e&&e.length){const i=[];return e.forEach(e=>{e.show&&(this._relatedEntityIds.push(e.id),i.push(r.createElement(y,{key:e.id,ref:e.id,relatedEntityItem:e,relatedItemsArea:t,handleRelatedEntityCallBack:this._relatedItemSelected,style:n})))}),i}}_tabItemSelected(e){this.props.selectTab(e)}_relatedItemSelected(e){this.setState({selectedIndex:-1,keyDownScope:this._tabKeyDownScope}),this.props.selectRelatedEntity(e)}_handleOutsideClick(e){e&&e.target&&e.target.id!==Object(P.g)("related_tab",this.props.id)&&e.target.id!==Object(P.g)("more_tab",this.props.id)&&(this.props.closeFlyout(e),this.setState({selectedIndex:-1}))}_ulOverFlowTabsRef(e){this._overFlowTabList=e}_shortcutHandler(e){const t=e.EVENT;let n,i,a,s;if(this._overFlowTabList&&(a=r.Children.count(this._overFlowTabList.props.children)),this._relatedEntityIds&&(s=this._relatedEntityIds.length),this._relatedEntityIds&&!this._overFlowTabList&&(this.setState({keyDownScope:this._relatedKeyDownScope}),s=this._relatedEntityIds.length),this._overFlowTabList&&this.state.keyDownScope===this._tabKeyDownScope?(n=a,i=s):this._relatedEntityIds&&this.state.keyDownScope===this._relatedKeyDownScope&&(n=s,i=a),this._relatedEntityIds||this._overFlowTabList){const e=0===a?this._relatedKeyDownScope:this._tabKeyDownScope;if(t.keyCode===p.a.DownArrow)t.preventDefault(),this._handleKeyCodeNavigation(p.a.DownArrow,a,s,n,i);else if(t.keyCode===p.a.UpArrow)t.preventDefault(),this._handleKeyCodeNavigation(p.a.UpArrow,a,s,n,i);else if(t.keyCode===p.a.Escape)this.props.closeFlyout(t),this.setState({selectedIndex:-1,keyDownScope:e}),this._moveFocusToLastTab();else if(t.keyCode===p.a.Enter){if(this.state.keyDownScope===this._relatedKeyDownScope){const e=t.target;if(e.id!==Object(P.g)("related_tab",this.props.id)){const t=this._getRelatedItem(e.id);this._relatedItemSelected(t)}}else this._tabItemSelected(t);this.setState({selectedIndex:-1,keyDownScope:e})}else t.keyCode===p.a.Tab&&t.preventDefault()}}_moveFocusToLastTab(){if(this.props.tabNavigatorList){const e=i.findDOMNode(this.props.tabNavigatorList),t=e.childNodes.length-1;t>-1&&e.childNodes[t].focus()}}_handleKeyCodeNavigation(e,t,n,r,i){const a=p.a.DownArrow===e?this.state.selectedIndex+1:this.state.selectedIndex-1;let s;const o=0===this.state.selectedIndex&&p.a.UpArrow===e;this.state.keyDownScope===this._relatedKeyDownScope?s=o&&t?t:n:this.state.keyDownScope===this._tabKeyDownScope&&(s=o&&n?n:t);const c=(a+s)%s;let l=-1;if(p.a.DownArrow===e&&a===s&&i?l=0:p.a.UpArrow===e&&-1===a&&i&&(l=s-1),l>-1){const e=this.state.keyDownScope===this._tabKeyDownScope?this._relatedKeyDownScope:this._tabKeyDownScope;this.setState({keyDownScope:e})}this._moveFocus(c,this.state.keyDownScope)}_moveFocus(e,t){let n,r;t===this._relatedKeyDownScope?n=i.findDOMNode(this.refs[this._relatedEntityIds[e]]):t===this._tabKeyDownScope&&(r=i.findDOMNode(this._overFlowTabList).childNodes[e]),(n||r)&&this.setState({selectedIndex:e},()=>{const e=t===this._relatedKeyDownScope?n:r;e&&(e.tabIndex=0,e.focus())})}_createKeyboardShortcuts(){const e=Object(I.c)(this.props.resourceStrings,j.a),t=Object(I.c)(this.props.resourceStrings,j.b),n=Object(I.c)(this.props.resourceStrings,j.f),r=Object(I.c)(this.props.resourceStrings,j.d),i=Object(I.c)(this.props.resourceStrings,j.c),a=Object(I.c)(this.props.resourceStrings,j.e),s=this._shortcutHandler.bind(this),o=[],c=new f.a([p.a.UpArrow],s,!0,e,n),l=new f.a([p.a.DownArrow],s,!0,e,t),u=new f.a([p.a.Escape],s,!0,e,r),d=new f.a([p.a.Enter],s,!0,e,i),h=new f.a([p.a.Tab],s,!0,e,a);return o.push(c),o.push(l),o.push(u),o.push(d),o.push(h),o}_getRelatedEntityContainer(){const e=[],t=[];if(this._relatedEntityIds=[],this.props.moreTabItems&&this.props.moreTabItems.length&&e.push(r.createElement(s.a,{key:"OverFlowTabList",role:l.r,ref:this._ulOverFlowTabsRef,onClick:this._tabItemSelected},this.props.moreTabItems)),this.props.isShowNavigation&&!this.props.isInCreateMode){if(this.props.relatedEntitiesList)for(let t=0;t<this.props.relatedEntitiesList.length;t++){const n=this.props.relatedEntitiesList[t];n&&n.relatedItems&&n.relatedItems.find(e=>!1!==e.show)&&e.push(r.createElement(c.a,{key:"related_"+n.areaName+t,style:this.props.tabStyle},r.createElement(c.a,{key:"related_area_"+n.areaName+t,style:this.props.areaNameContainerStyle},r.createElement(o.a,{key:"areaName_"+n.areaName,accessibilityLabel:n.areaName},n.areaName)),this._renderRelatedEntitiesList(n.relatedItems,n.areaName)))}if((null==this.props.relatedEntitiesList||0===this._relatedEntityIds.length)&&this.props.retrieveMissingRelatedEntitiesFinished&&this.props.relativeElementId===Object(P.g)("related_tab",this.props.id)){const t=Object(I.c)(this.props.resourceStrings,j.g);e.push(r.createElement(c.a,{key:"related_noData",style:this.props.tabStyle},r.createElement(c.a,{key:"related_entity_noData_container",style:this.props.noDataContainerStyle},r.createElement(o.a,{key:"related_entity_noData_available_text",id:"related_entity_noData_available_text",accessibilityLabel:t,tabIndex:0,role:l.n},t))))}}return t.push(r.createElement(c.a,{key:"related_flyout",role:l.l,style:this.props.relatedItemsSectionsContainerStyle},e)),t}_getRelatedItem(e){if(this.props.relatedEntitiesList)for(let t=0;t<this.props.relatedEntitiesList.length;t++)if(this.props.relatedEntitiesList[t].relatedItems){const n=this.props.relatedEntitiesList[t].relatedItems.find(t=>t&&t.id===e);if(n)return n}}render(){return this.props.isFlyoutOpened?r.createElement(c.a,{key:"relatedEntityContainer",id:"relatedEntityContainer",ownsElementId:F},r.createElement(S.a,{key:"relatedEntityFlyoutAccessibility",rootElementId:F,keyboardShortcuts:this._createKeyboardShortcuts(),shouldManageFocus:!1}),r.createElement(u.a,{key:F,id:F,testhooks:{id:F},flyoutDirection:u.b.down,relativeToElementId:this.props.relativeElementId,positionType:"relative",flyoutStyle:this.props.flyoutStyle,onOutsideClick:this._handleOutsideClick},this._getRelatedEntityContainer())):null}componentDidUpdate(){-1===this.state.selectedIndex&&(this._overFlowTabList||this._relatedEntityIds)&&this.props.isFlyoutOpened&&(this._overFlowTabList&&this.state.keyDownScope===this._tabKeyDownScope?this._moveFocus(0,this._tabKeyDownScope):this._relatedEntityIds&&this._moveFocus(0,this._relatedKeyDownScope))}}T.displayName="TabFlyout";const w=Object(a.a)((function(){const e=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e=null,t=null,n=null,r=null;return function(i){const a=Object(C.c)(i),s=Object(v.a)(i),o=Object(O.g)(i);return t===s&&n===a&&r===o||(e={relatedItemsSectionsContainerStyle:{display:"block",width:"100%"},relatedEntitySectionStyle:{paddingTop:s.sizes.Measures.Measure050,paddingBottom:s.sizes.Measures.Measure050,height:"auto",maxHeight:s.sizes.Measures.Measure300,lineHeight:s.sizes.Measures.Measure150,overflow:"hidden",cursor:s.display.PointerCursorStyle},tabStyle:{display:"block",marginTop:0,marginBottom:s.sizes.Measures.Measure075},tileStyle:{width:s.sizes.Measures.Measure150,height:s.sizes.Measures.Measure150,marginRight:s.sizes.Measures.Measure100,backgroundColor:s.colors.SemanticZoomTileBackground},flyoutStyle:{borderColor:"#ffffff",borderWidth:"1px",borderStyle:"solid",borderTopWidth:0,paddingLeft:s.sizes.Measures.Measure150,paddingRight:s.sizes.Measures.Measure150,paddingTop:s.sizes.Measures.Measure100,paddingBottom:s.sizes.Measures.Measure025,maxWidth:"22.86rem",minWidth:s.sizes.DockablePanel.PanelWidthM,maxHeight:s.sizes.Flyout.MaxHeight,boxShadow:s.shadows.Shadow01,backgroundColor:s.colors.BaseColor.White,width:a<s.sizes.Breakpoints.DimensionXS?"95%":void 0,height:a<s.sizes.Breakpoints.DimensionXS?"60%":void 0,margin:a<s.sizes.Breakpoints.DimensionXS?"0 2.5%":void 0},areaNameContainerStyle:{paddingTop:s.sizes.Measures.Measure050,paddingBottom:s.sizes.Measures.Measure050,height:s.sizes.Measures.Measure150,lineHeight:s.sizes.Measures.Measure150,borderBottom:s.borders.Border02,fontSize:s.fontSizes.Font100,fontFamily:s.fontFamilies.Semibold,color:s.colors.BaseColor.Grey.Grey7},entityTitleStyle:{fontSize:s.fontSizes.Font100,fontFamily:s.fontFamilies.Regular,color:s.colors.BaseColor.Grey.Grey7},entityIconStyle:{fontFamily:"Dyn CRM Symbol",fontSize:"16px",width:s.sizes.Measures.Measure115,marginLeft:o?s.sizes.Measures.Measure100:0,marginRight:o?0:s.sizes.Measures.Measure100},noDataContainerStyle:{paddingTop:s.sizes.Measures.Measure050,paddingBottom:s.sizes.Measures.Measure050,height:s.sizes.Measures.Measure150,lineHeight:s.sizes.Measures.Measure150,fontSize:s.fontSizes.Font100,fontFamily:s.fontFamilies.Semibold,color:s.colors.BaseColor.Grey.Grey7},navLinkImageStyle:{width:"16px",height:"16px",marginLeft:o?s.sizes.Measures.Measure100:0,marginRight:o?0:s.sizes.Measures.Measure100,marginTop:"2px"}},t=s,n=a,r=o),e}}(),t=Object(I.h)(),n=Object(d.f)();return function(r,i){const a=e(r),s=t(r,j.h),o=n(r,i);return{tileStyle:a.tileStyle,flyoutStyle:a.flyoutStyle,tabStyle:a.tabStyle,navLinkImageStyle:a.navLinkImageStyle,relatedEntitySectionStyle:a.relatedEntitySectionStyle,relatedItemsSectionsContainerStyle:a.relatedItemsSectionsContainerStyle,areaNameContainerStyle:a.areaNameContainerStyle,entityTitleStyle:a.entityTitleStyle,entityIconStyle:a.entityIconStyle,resourceStrings:s,noDataContainerStyle:a.noDataContainerStyle,relatedEntitiesList:o,isShowNavigation:Object(d.h)(r,i)}}}))(T)},ix9S:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var r=n("nuS9"),i=n("i1f0"),a=n("u+q+"),s=n("XfPn"),o=n("dHD5");function c(e,t,n){const r=[{name:"controlId",value:n}];return{type:"onClick.FormNotificationAction.sync",sync:!0,execute({dispatch:i,getState:a},s,o){if(r.push({name:"CorrelationId",value:o.correlationId},{name:"ContextId",value:o.contextId},{name:"ActionStack",value:o.stack}),n){i(s.ScriptManager.getContainer(t).getEventManager().runOnClick(e,n)),s.EventManager.ReportComponentSuccess("Forms.FormNotificationButtonOnClickAction",r)}else s.TraceManager.getTracer("Forms.FormNotificationButtonOnClickAction").warn("Null/undefined controlId.",r)},getFailureParameters:(e,t)=>r}}var l=n("+XGO"),u=n("Lyxw"),d=n("3/02"),p=n("zJiL"),h=n("YxC/"),g=n("sptG"),m=n("/Ikn"),b=n("dGG5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function y(e){return r.createElement(s.BarNotificationList,Object.assign({},e))}function f(e,t,n,r){if(e)return e.map((e,i)=>{const a=Object(m.b)(r,i+"");return{Label:e.Label,Handler:c(t,n,a)}})}function S(e,t,n,r){if(e)return e.map((e,i)=>{const a=Object(b.b)(r,i+"");return{Label:e.Label,Handler:c(t,n,a)}})}function v(e,t,n,r,i){return!t.ControlName&&n&&t.Level!==p.c&&r?(e||"")+" "+function(e){return Object(h.b)(e,g.d)}(i):e}function C(e){return{type:"set.focus.on.notification",execute({dispatch:t,getState:n},r){if(e.ControlName){const i=[{name:"NotificationId",value:e.UniqueId}],a=Object(o.j)(n(),e.ComponentId);return t(Object(l.a)(e.ComponentId,a,e.ControlName)).then(()=>{r.EventManager.ReportComponentSuccess("Forms.SetFocusAction.entered",i)})}}}}y.displayName="FormNotificationList";const O=Object(a.a)((function(){let e={},t=[];const n=Object(i.Zc)();return function(r,a){const s=n(r,a.id);e!==s&&(t=function(e,t,n){const r=[];if(e){const a=Object(u.a)(n,d.ob),s=Object(o.j)(n,t),c=Object(i.zb)(n,t,s);for(const i of Object.keys(e)){const o=e[i],l=o.UniqueId in c,u=Object.assign(Object.assign({},o),{Buttons:f(o.Buttons,s,t,o.UniqueId),MessagePlaceholders:S(o.MessagePlaceholders,s,t,o.UniqueId),Message:v(o.Message,o,l,a,n),OnNotificationClick:o.ControlName&&a&&C(o)});r.push(u)}}return r}(s,a.id,r),e=s);return{notificationList:t}}}))(y)},j2fa:function(e,t,n){"use strict";n.d(t,"b",(function(){return Ce})),n.d(t,"d",(function(){return Oe})),n.d(t,"e",(function(){return _e})),n.d(t,"c",(function(){return Ie})),n.d(t,"a",(function(){return je}));var r=n("Wgxh"),i=n("SAYH"),a=n("eXjw"),s=n("95wm");var o=n("fKWG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var c=n("odYE"),l=n("VcAV"),u=n("MXaZ");class d{constructor(){this._dataPointAggregators=new Array(0),this._dataPointDateTimeRangeAggregatorInfoMap=new Map,this._dataPointFiscalPeriodAggregators=new Array(0),this._dataPointFiscalYearAggregators=new Array(0)}addAggregator(e,t,n,r,a){if(n>=o.a.DAY&&n<o.a.FISCAL_PERIOD)this._addDateTimeRangeAggregatorInfo(e,t,n,r,a);else if(n===o.a.FISCAL_PERIOD)this._addDataPointFiscalPeriodAggregator(e,t,r,a);else if(n===o.a.FISCAL_YEAR)this._addDataPointFiscalYearAggregator(e,t,r,a);else{const n=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,Value:e&&e.Value||null,DisplayName:e&&e.DisplayName||null,EntityLogicalName:e&&e.EntityLogicalName||null}}();if(n.FieldName=e,n.EntityName=r,n.LinkEntityExpressionArray=a,Object(l.c)(t))n.Value=null;else if(t instanceof c.a){const e=t;n.Value=e.id.guid,n.DisplayName=e.name,n.EntityLogicalName=e.etn}else t instanceof i.a?n.Value=i.a.toString(t):n.Value=t.toString();this._dataPointAggregators.push(n)}}static _daysInMonth(e,t){return new Date(e,t,0).getDate()}_addDataPointFiscalPeriodAggregator(e,t,n,r){const i=function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,FiscalType:e&&e.FiscalType||null,Year:e&&e.Year||0,Period:e&&e.Period||0}}();if(i.FiscalType="in-fiscal-period-and-year",i.FieldName=e,i.EntityName=n,i.LinkEntityExpressionArray=r,!t)return void this._dataPointFiscalPeriodAggregators.push(i);if("string"!=typeof t)throw new Error("value should be string");if(t.indexOf("-")<=0)throw new Error("value should have xxxx-yy format");const a=t.split("-");i.Year=Number(a[0]),i.Period=Number(a[1]),this._dataPointFiscalPeriodAggregators.push(i)}_addDataPointFiscalYearAggregator(e,t,n,r){const i=function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,FiscalType:e&&e.FiscalType||null,Year:e&&e.Year||0}}();if(i.FiscalType="in-fiscal-year",i.FieldName=e,i.EntityName=n,i.LinkEntityExpressionArray=r,t){if("number"!=typeof t)throw new Error("value should be number");i.Year=Number(t),this._dataPointFiscalYearAggregators.push(i)}else this._dataPointFiscalYearAggregators.push(i)}_addDateTimeRangeAggregatorInfo(e,t,n,r,i){let a=null;switch(this._dataPointDateTimeRangeAggregatorInfoMap.has(e)?a=this._dataPointDateTimeRangeAggregatorInfoMap.get(e):(a=function(e){return{dateTimeAggregatorDay:(null==e?void 0:e.dateTimeAggregatorDay)||null,dateTimeAggregatorWeek:(null==e?void 0:e.dateTimeAggregatorWeek)||null,dateTimeAggregatorMonth:(null==e?void 0:e.dateTimeAggregatorMonth)||null,dateTimeAggregatorYear:(null==e?void 0:e.dateTimeAggregatorYear)||null,dateTimeAggregatorFieldName:(null==e?void 0:e.dateTimeAggregatorFieldName)||null,dateTimeAggregatorEntityName:(null==e?void 0:e.dateTimeAggregatorEntityName)||null,dateTimeAggregatorLinkEntityExpressionArr:(null==e?void 0:e.dateTimeAggregatorLinkEntityExpressionArr)||null,dateTimeAggregatorPrecision:(null==e?void 0:e.dateTimeAggregatorPrecision)||o.a.YEAR}}({dateTimeAggregatorFieldName:e}),this._dataPointDateTimeRangeAggregatorInfoMap.set(e,a)),a.dateTimeAggregatorEntityName||(a.dateTimeAggregatorEntityName=r),a.dateTimeAggregatorLinkEntityExpressionArr||(a.dateTimeAggregatorLinkEntityExpressionArr=i),n){case o.a.DAY:a.dateTimeAggregatorDay=Number(t);break;case o.a.WEEK:a.dateTimeAggregatorWeek=Number(t);break;case o.a.MONTH:a.dateTimeAggregatorMonth=Number(t);break;case o.a.QUARTER:a.dateTimeAggregatorMonth=3*Number(t);break;case o.a.YEAR:a.dateTimeAggregatorYear=Number(t);break;default:throw new Error("DateTime Group type not supported")}a.dateTimeAggregatorPrecision=Math.min(n,a.dateTimeAggregatorPrecision)}_getDataPointDateTimeRangeAggregators(e,t){const n=new Array(0);return 0===this._dataPointDateTimeRangeAggregatorInfoMap.size||this._dataPointDateTimeRangeAggregatorInfoMap.forEach((r,i)=>{const a={FieldName:(null==s?void 0:s.FieldName)||null,EntityName:(null==s?void 0:s.EntityName)||null,LinkEntityExpressionArray:(null==s?void 0:s.LinkEntityExpressionArray)||null,MinDate:(null==s?void 0:s.MinDate)||null,MaxDate:(null==s?void 0:s.MaxDate)||null};var s;if(a.FieldName=r.dateTimeAggregatorFieldName,a.EntityName=r.dateTimeAggregatorEntityName,a.LinkEntityExpressionArray=r.dateTimeAggregatorLinkEntityExpressionArr,r.dateTimeAggregatorYear){switch(r.dateTimeAggregatorMonth=r.dateTimeAggregatorMonth?r.dateTimeAggregatorMonth:12,r.dateTimeAggregatorDay=r.dateTimeAggregatorDay?r.dateTimeAggregatorDay:d._daysInMonth(r.dateTimeAggregatorYear,r.dateTimeAggregatorMonth),a.MaxDate=new Date(r.dateTimeAggregatorYear,r.dateTimeAggregatorMonth-1,r.dateTimeAggregatorDay),r.dateTimeAggregatorPrecision){case o.a.DAY:p(a.MaxDate),a.MinDate=new Date(a.MaxDate.getFullYear(),a.MaxDate.getMonth(),a.MaxDate.getDate());break;case o.a.WEEK:{t===u.a.FirstFullWeekOfTheYear&&(t=u.a.FirstDayOfTheYear);let n=Object(u.s)(r.dateTimeAggregatorYear,r.dateTimeAggregatorWeek,e,t),i=Object(u.s)(r.dateTimeAggregatorYear,r.dateTimeAggregatorWeek+1,e,t);if(i.setDate(i.getDate()-1),t===u.a.FirstDayOfTheYear){if(i>=new Date(r.dateTimeAggregatorYear+1,0,1))i=new Date(r.dateTimeAggregatorYear+1,0,0);else if(1===r.dateTimeAggregatorWeek){const e=new Date(r.dateTimeAggregatorYear,0,1);n<e&&(n=e)}}a.MinDate=n,a.MaxDate=i,p(a.MaxDate),p(a.MinDate);break}case o.a.MONTH:a.MinDate=new Date(a.MaxDate.getFullYear(),a.MaxDate.getMonth()-1,d._daysInMonth(r.dateTimeAggregatorYear,a.MaxDate.getMonth())+1),p(a.MaxDate),p(a.MinDate);break;case o.a.QUARTER:a.MinDate=new Date(a.MaxDate.getFullYear(),a.MaxDate.getMonth()-3,d._daysInMonth(r.dateTimeAggregatorYear,a.MaxDate.getMonth()-2)+1),p(a.MaxDate),p(a.MinDate);break;case o.a.YEAR:p(a.MaxDate),a.MinDate=new Date(a.MaxDate.getFullYear()-1,a.MaxDate.getMonth(),a.MaxDate.getDate()+1);break;default:throw new Error("DateTime Group type not supported")}n.push(a)}else n.push(a)}),n}getAggregators(e,t){let n=this._dataPointAggregators;const r=this._getDataPointDateTimeRangeAggregators(e,t);return r&&r.length>0&&(n=n.concat(r)),this._dataPointFiscalPeriodAggregators&&this._dataPointFiscalPeriodAggregators.length>0&&(n=n.concat(this._dataPointFiscalPeriodAggregators)),this._dataPointFiscalYearAggregators&&this._dataPointFiscalYearAggregators.length>0&&(n=n.concat(this._dataPointFiscalYearAggregators)),n}}function p(e){e.getTimezoneOffset()<0&&e.setDate(e.getDate()+1)}var h=n("YxC/"),g=n("GEBM"),m=n("IqkD"),b=n("Xd5/"),y=n("nfCs"),f=n("NjDY"),S=n("LbMF"),v=n("S70w"),C=n("Ae6N");function O(e,t){const n=Object(S.a)(e,t.entity.entityName,t.attributeName);let r=n?n.DisplayName:null;r||(r=t.attributeName);let i=r;if(t.dateTimeGrouping){const n=y.c(t.dateTimeGrouping.groupingType).replace("-","").toUpperCase();i=String.format(Object(h.b)(e,g.c),Object(h.b)(e,`${g.c}.${n.toUpperCase()}`),r)}else t.hasAggregate&&t.aggregateType&&(i=String.format(Object(h.b)(e,g.d),Object(h.b)(e,`${g.d}.${t.aggregateType.toUpperCase()}`),r));if(n&&"money"===n.Type){let r="",a=null;const s=Object(f.x)(e);n.IsBaseCurrency?s&&s.baseCurrencyId&&s.transactionCurrencyById&&(a=s.transactionCurrencyById[s.baseCurrencyId.guid]):t.hasAggregate&&(a=Object(m.b)(e)),a&&(r=s&&s.currencyDisplayOption===v.a.CurrencyCode?a.currencyCode:a.currencySymbol),r&&(i=String.format(Object(h.b)(e,g.b),i,r))}return i}function _(e,t,n){return n>0?String.format(Object(h.b)(e,g.y),n,t):String.format(Object(h.b)(e,g.w),t)}function I(e,t,n,r,i){const a=i<1&&r>=1&&n<1,s=i<1&&r<1&&n>=1,o=r<1&&n<1;if(i>=1&&r<1&&n>=1){const r=new Date(t,n-1,i),{formatInfoCultureName:a,numberFormatInfo:s,dateFormatInfo:o}=Object(m.w)(e),c=new Sys.CultureInfo(a,s,o);return Object(b.s)(r,c,C.a.None)}return a?String.format(Object(h.b)(e,g.z),r,t):s?String.format("{0} {1}",function(e){const t=Object(h.b)(e,g.e).split(",");if(!t||12!==t.length)throw new Error("Expect 12 months! Actual: "+t.length);return t}(e)[n-1],t):o?String(t):""}function j(e){return Object(h.b)(e,g.v)}var P=n("WPtp"),F=n("16wZ");function T(e,t,n){let r=!1;n&&n.groupAttribute&&n.groupAttribute.dateTimeGrouping&&(r=!0);return{attribute:t,primaryGroupBy:n,aliasName:t.aliasName||t.attributeName,state:e,isDateTimeChart:r}}function w(e,t){let n=e.isDateTimeChart?function(e,t){if(!t.fields||!Object(P.c)(t.fields[e.aliasName]))return"";switch(e.attribute.dateTimeGrouping.groupingType){case o.a.DAY:return function(e,t){const n=Object(P.e)(t.fields[e.aliasName]),r=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]),i=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[1].aliasName]);return I(e.state,i,r,-1,n)}(e,t);case o.a.WEEK:return function(e,t){const n=Object(P.e)(t.fields[e.aliasName]),r=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return I(e.state,r,-1,n,-1)}(e,t);case o.a.MONTH:return function(e,t){const n=Object(P.e)(t.fields[e.aliasName]),r=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return I(e.state,r,n,-1,-1)}(e,t);case o.a.QUARTER:return function(e,t){const n=Object(P.e)(t.fields[e.aliasName]),r=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return _(e.state,r,n)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,t);case o.a.FISCAL_PERIOD:return function(e,t){return Object(P.e)(t.fields[e.aliasName])}(e,t);case o.a.YEAR:return function(e,t){const n=Object(P.e)(t.fields[e.aliasName]);return I(e.state,n,-1,-1,-1)}(e,t);case o.a.FISCAL_YEAR:return function(e,t){const n=Object(P.e)(t.fields[e.aliasName]);return _(e.state,n,-1)}(e,t);default:return Object(P.c)(t.fields[e.attribute.attributeName])}}(e,t):null;return n||(n=Object(P.c)(t.fields[e.aliasName]),n=n||""),0===n.length?Object(h.b)(e.state,g.v):n}function E(e,t){if(!e.attribute||!Object(S.a)(e.state,e.attribute.entity.entityName,e.attribute.attributeName))return w(e,t);switch(Object(S.a)(e.state,e.attribute.entity.entityName,e.attribute.attributeName).Type){case"picklist":case"status":case"state":case"boolean":{let n=Object(P.e)(t.fields[e.aliasName]);return n=Object(F.a)(n)?-1:Number(n),n}case"datetime":return function(e,t){let n=-1,r=-1,i=-1;switch(e.attribute.dateTimeGrouping.groupingType){case o.a.DAY:n=Object(P.e)(t.fields[e.aliasName]),r=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]),i=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[1].aliasName]);break;case o.a.MONTH:r=Object(P.e)(t.fields[e.aliasName]),i=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;case o.a.YEAR:i=Object(P.e)(t.fields[e.aliasName]);break;case o.a.QUARTER:r=Object(P.e)(t.fields[e.aliasName]),i=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;case o.a.WEEK:n=1+7*(Object(P.e)(t.fields[e.aliasName])-1),i=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;default:return w(e,t)}return new Date(i,r-1,n).getTime()}(e,t);default:return w(e,t)}}function x(e){return{Enabled:e&&e.Enabled||!1,X:e&&e.X||0,Y:e&&e.Y||0,Align:e&&e.Align||"left",VerticalAlign:e&&e.VerticalAlign||"middle",LabelFormatter:e&&e.LabelFormatter||null,Color:e&&e.Color||""}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function N(e){return{Value:e&&e.Value||0,FormattedValue:e&&e.FormattedValue||null,Aggregators:e&&e.Aggregators||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class A extends Error{constructor(e,t,n){super(e),Object.setPrototypeOf(this,A.prototype),this.title=t,this.description=n}}var k=n("Lyxw"),M=n("3/02"),D=n("zh0k"),R=n("hwt8"),B=n("504W");function L(){return this.point.formattedValue}function V(e){return function(){return Highcharts.numberFormat(parseFloat(this.point.y)/e*100)+"%"}}class z{constructor(){this.isInitialized=!1}get primaryGroupBy(){return this.chartDataDescription&&this.chartDataDescription.category&&this.chartDataDescription.category.primaryGroupBy}get queryModel(){return this._queryModel}initialize(e,t,n,r,i,a,s,o,c,l){this.getState=e,this.chartData=t,this.chartDataDescription=n,this.categoryColumn=this.chartDataDescription.categoryColumns,this.chartPresentationSeries=r,this.chartPresentationXAxis=i,this.chartPresentationYAxis=a,this.chartPresentationArea3DStyle=s,this.chartPresentationAreaGradientStyle=o,this._queryModel=c,this.chartPresentationAnnotationList=l,this._isChartCustomizationParityFCBEnabled()&&this._validateChartAggregateAttributes(),this.isInitialized=!0}setXAxisMajorGridAndMajorTickProperties(e,t=0){var n,r,i,a,s,o,c,l;return e.AxisMajorGridColor=null===(r=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[t])||void 0===r?void 0:r.AxisMajorGridColor,e.AxisMajorGridEnabled=null===(a=null===(i=this.chartPresentationXAxis)||void 0===i?void 0:i[t])||void 0===a?void 0:a.AxisMajorGridEnabled,e.AxisMajorTickMarkColor=null===(o=null===(s=this.chartPresentationXAxis)||void 0===s?void 0:s[t])||void 0===o?void 0:o.AxisMajorTickMarkColor,e.AxisMajorTickMarkEnabled=null===(l=null===(c=this.chartPresentationXAxis)||void 0===c?void 0:c[t])||void 0===l?void 0:l.AxisMajorTickMarkEnabled,e}setYAxisMajorGridAndMajorTickProperties(e,t=0){var n,r,i,a,s,o,c,l;return e.AxisMajorGridColor=null===(r=null===(n=this.chartPresentationYAxis)||void 0===n?void 0:n[t])||void 0===r?void 0:r.AxisMajorGridColor,e.AxisMajorGridEnabled=null===(a=null===(i=this.chartPresentationYAxis)||void 0===i?void 0:i[t])||void 0===a?void 0:a.AxisMajorGridEnabled,e.AxisMajorTickMarkColor=null===(o=null===(s=this.chartPresentationYAxis)||void 0===s?void 0:s[t])||void 0===o?void 0:o.AxisMajorTickMarkColor,e.AxisMajorTickMarkEnabled=null===(l=null===(c=this.chartPresentationYAxis)||void 0===c?void 0:c[t])||void 0===l?void 0:l.AxisMajorTickMarkEnabled,e}retrieveChartArea3DStyle(){const e={};return e.Enable3D=this.chartPresentationArea3DStyle.Enable3D,e}retrieveChartAreaGradientStyle(){const e={};return e.BackColor=this.chartPresentationAreaGradientStyle.BackColor,e.BackSecondaryColor=this.chartPresentationAreaGradientStyle.BackSecondaryColor,e.BackGradientStyle=this.chartPresentationAreaGradientStyle.BackGradientStyle,e}setYAxisOppositeProperty(e){var t,n,r,i;return this._isChartCustomizationParityFCBEnabled()&&(null===(n=null===(t=this.chartPresentationXAxis)||void 0===t?void 0:t[0])||void 0===n?void 0:n.IsReversed)&&(e.Opposite=null===(i=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[0])||void 0===i?void 0:i.IsReversed),e}setXAxisIsReversedProperty(e){var t,n,r,i;return this._isChartCustomizationParityFCBEnabled()&&(null===(n=null===(t=this.chartPresentationXAxis)||void 0===t?void 0:t[0])||void 0===n?void 0:n.IsReversed)&&(e.IsReversed=null===(i=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[0])||void 0===i?void 0:i.IsReversed),e}retrieveChartYAxis(){const e=new Array(1);if(e[0]={},!this._queryModel.SeriesList)return e;const t=(e,t,n)=>{this.chartPresentationYAxis&&this.chartPresentationYAxis.length>t&&this.chartPresentationYAxis[t]&&this.chartPresentationYAxis[t].Title?e.Title=this.chartPresentationYAxis[t].Title:1===n&&(e.Title=this._queryModel.SeriesList[t].Title)};let n=0,r=-1,i=-1,a=!1,s=!1;for(let e=0;e<this.chartPresentationSeries.length;e++)this.chartPresentationSeries[e].SecondaryYAxis?(n++,i=-1===i?e:i,s=s||this.shouldDisableAllowDecimals(e)):(r=-1===r?e:r,a=a||this.shouldDisableAllowDecimals(e));return t(e[0],r,this.chartPresentationSeries.length-n),e[0].Opposite=!1,a&&(e[0].AllowDecimals=!1),0===n&&(e[0]=this.setYAxisOppositeProperty(e[0])),n>0&&(e[1]={},t(e[1],i,n),e[1].Opposite=!0,s&&(e[1].AllowDecimals=!1)),e.forEach((e,t)=>{var n,r,i,a,s,o,c,l,u,d,p,h,g,m;e.Disabled=this.chartPresentationYAxis&&this.chartPresentationYAxis[t]&&this.chartPresentationYAxis[t].Disabled,e.LabelForeColor=null===(r=null===(n=this.chartPresentationYAxis)||void 0===n?void 0:n[t])||void 0===r?void 0:r.LabelForeColor,e.AxisLineColor=null===(a=null===(i=this.chartPresentationYAxis)||void 0===i?void 0:i[t])||void 0===a?void 0:a.AxisLineColor,e.AxisTitleForeColor=null===(o=null===(s=this.chartPresentationYAxis)||void 0===s?void 0:s[t])||void 0===o?void 0:o.AxisTitleForeColor,e.LabelDisabled=null===(l=null===(c=this.chartPresentationYAxis)||void 0===c?void 0:c[t])||void 0===l?void 0:l.LabelDisabled,e.AxisInterval=null===(d=null===(u=this.chartPresentationYAxis)||void 0===u?void 0:u[t])||void 0===d?void 0:d.AxisInterval,e.AxisMinimum=null===(h=null===(p=this.chartPresentationYAxis)||void 0===p?void 0:p[t])||void 0===h?void 0:h.AxisMinimum,e.AxisMaximum=null===(m=null===(g=this.chartPresentationYAxis)||void 0===g?void 0:g[t])||void 0===m?void 0:m.AxisMaximum,e=this.setYAxisMajorGridAndMajorTickProperties(e,t)}),this.chartPresentationYAxis&&this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].FormatString?e[0].FormatString=this.chartPresentationYAxis[0].FormatString:e[0].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[0].measures[0].measureAttribute),n>0&&(this.chartPresentationYAxis&&this.chartPresentationYAxis[1]&&this.chartPresentationYAxis[1].FormatString?e[1].FormatString=this.chartPresentationYAxis[1].FormatString:e[1].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[i].measures[0].measureAttribute)),e}_isChartCustomizationParityFCBEnabled(){return Object(k.a)(this.getState(),M.s,M.Lc,M.w)}retrieveChartAnnotations(){const e=new Array(this.chartPresentationAnnotationList.length);for(let t=0;t<this.chartPresentationAnnotationList.length;t++){const n={};n.X=this.chartPresentationAnnotationList[t].X,n.Y=this.chartPresentationAnnotationList[t].Y,n.Text=this.chartPresentationAnnotationList[t].Text,n.ForeColor=this.chartPresentationAnnotationList[t].ForeColor,e[t]=n}return e}retrieveChartCategory(){var e,t,n,r,i,a;const s=new Array(1);let o=null;this.categoryColumn.length>0&&(o=T(this.getState(),this.categoryColumn[0],this.chartDataDescription.category.primaryGroupBy)),s[0]={};const c=new Array(this.chartData.length);for(let e=0;e<this.chartData.length;e++){const t=this.chartData[e];if(o){if(c[e]=w(o,t),"-1"===c[e])c[e]=Object(h.b)(this.getState(),g.f);else if(!o.isDateTimeChart&&"number"==typeof Object(P.e)(t.fields[o.aliasName])&&this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString){const n=Object(m.w)(this.getState());c[e]=Object(R.c)(Object(P.e)(t.fields[o.aliasName]),Object(b.d)(n),this.chartPresentationXAxis[0].FormatString)}}else c[e]=j(this.getState())}return s[0].Title=this.retrieveChartCategoryTitle(o),s[0].Values=c,s[0].Disabled=this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].Disabled,s[0].LabelForeColor=null===(t=null===(e=this.chartPresentationXAxis)||void 0===e?void 0:e[0])||void 0===t?void 0:t.LabelForeColor,s[0].AxisLineColor=null===(r=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[0])||void 0===r?void 0:r.AxisLineColor,s[0].AxisTitleForeColor=null===(a=null===(i=this.chartPresentationXAxis)||void 0===i?void 0:i[0])||void 0===a?void 0:a.AxisTitleForeColor,s[0].LabelDisabled=this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].LabelDisabled,s[0]=this.setXAxisMajorGridAndMajorTickProperties(s[0]),s[0]=this.setXAxisIsReversedProperty(s[0]),s}retrieveChartCategoryTitle(e){return this.chartPresentationXAxis&&this.chartPresentationXAxis.length>0&&this.chartPresentationXAxis[0].Title?this.chartPresentationXAxis[0].Title:e?O((t=e).state,t.attribute):"";var t}retrieveChartSeries(e){const t=new Array(this.chartPresentationSeries.length);for(let n=0;n<this.chartPresentationSeries.length;n++){const r=this.chartDataDescription.category.measureCollections[n].measures[0].measureAttribute,i=r.aliasName?r.aliasName:r.attributeName,a=this.chartPresentationSeries[n].IsValueShownAsLabel,s=this.chartPresentationSeries[n].LabelFormat;let o=null;s&&Object(R.d)(s)&&(o=Object(R.g)(s));let c=!1;this.chartPresentationSeries[n].Label&&"#percent"===this.chartPresentationSeries[n].Label.toLowerCase()&&(c=!0);let l=!1;s&&H(this.chartPresentationSeries[n].ChartType)&&Object(R.e)(s)&&(l=!0);let u=null;const d=O(this.getState(),r);t[n]=this.cloneBlueprintSeriesStyle(this.chartPresentationSeries[n]),this.chartPresentationSeries[n].SecondaryYAxis&&(t[n].YAxisNumber=1),this.primaryGroupBy&&(u=[],u.push(this.primaryGroupBy.groupAttribute),this.primaryGroupBy.extendedGroupBys&&this.primaryGroupBy.extendedGroupBys.forEach(e=>{u.push(e)}));const p=new Array(this.chartData.length),h=i;let g=0;for(let e=0;e<this.chartData.length;e++){const t=this.chartData[e];p[e]=N();const r=Object(P.e)(t.fields[i]);if(p[e].Value=r||0,g+=r||0,s){const r=Object(m.w)(this.getState()),i=Object(b.d)(r);Object(R.f)(s)?p[e].FormattedValue=Object(D.b)(p[e].Value,this.chartPresentationSeries[n].LabelFormat,i):Object(R.d)(s)&&!l?p[e].FormattedValue=Object(R.a)(p[e].Value,o,i):p[e].FormattedValue=Object(P.c)(t.fields[h])||0}else p[e].FormattedValue=Object(P.c)(t.fields[h])||0;this.attachAggregators(p[e],t,u)}const y=x();a?(y.Enabled=!0,y.LabelFormatter=L):c&&(y.Enabled=!0,y.LabelFormatter=V(g)),y.Color=this.chartPresentationSeries[n].LabelForeColor,t[n].DataLabels=y,t[n].DataPoints=p,t[n].Title=this.getChartTitleFromPresentationSeries(d,n),t[n].XAxisNumber=e,t[n].HideInLegend=this.chartPresentationSeries[n].HideInLegend,t[n].Stack=this.chartPresentationSeries[n].Stack}const n=Object(m.w)(this.getState()),r=Object(b.d)(n),i=this.chartPresentationSeries[0].IsValueShownAsLabel,a=this.chartPresentationSeries[0].LabelFormat;if(i&&H(this.chartPresentationSeries[0].ChartType)&&Object(R.e)(a)){const e=G(a,r);for(let n=0;n<t[0].DataPoints.length;n++)e(0,n,0,t)}return t}getChartTitleFromPresentationSeries(e,t=0){return Object(B.b)(this.chartPresentationSeries[t].LegendText)?Object(B.b)(this.chartPresentationSeries[t].Name)?e:this.chartPresentationSeries[t].Name:this.chartPresentationSeries[t].LegendText}shouldDisableAllowDecimals(e){const t=this.chartDataDescription.category.measureCollections[e].measures[0].measureAttribute;return"count"===t.aggregateType||"countcolumn"===t.aggregateType}cloneBlueprintSeriesStyle(e){const t={DataPoints:n&&n.DataPoints||null,DataLabels:n&&n.DataLabels||null,ChartType:n&&n.ChartType||"line",YAxisNumber:n&&n.YAxisNumber||0,XAxisNumber:n&&n.XAxisNumber||0,Title:n&&n.Title||"",Color:n&&n.Color||"",BorderColor:n&&n.BorderColor||"",BorderWidth:n&&n.BorderWidth||0,CustomProperties:n&&n.CustomProperties||null,Stack:n&&n.Stack||null};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n;return t.ChartType=e.ChartType,t.Color=e.Color,t.BorderColor=e.BorderColor,t.BorderWidth=e.BorderWidth,t.CustomProperties=e.CustomProperties,t}attachAggregators(e,t,n){if(n){const r=new d;for(let e=0;e<n.length;e++){const i=n[e],a=new Array;i.entity.baseEntity&&i.entity.baseEntity.linkedEntities&&i.entity.baseEntity.linkedEntities.forEach(e=>{const t={name:n&&n.name||null,from:n&&n.from||null,to:n&&n.to||null,linkType:n&&n.linkType||null,alias:n&&n.alias||null};var n;t.name=e.entityName,t.from=e.linkFromAttribute,t.to=e.linkToAttribute,t.linkType=e.joinType.toString(),t.alias=e.alias,a.push(t)}),r.addAggregator(i.attributeName,Object(P.e)(t.fields[z._getFieldName(i)]),i.dateTimeGrouping?i.dateTimeGrouping.groupingType:-1,i.entity.entityName,a)}const i=Object(m.w)(this.getState()),a=this._getFirstDayOfWeekFromUserSettings(i),s=this._getCalendarWeekRuleFromUserSettings(i);e.Aggregators=r.getAggregators(a,s)}}_getFirstDayOfWeekFromUserSettings(e){var t;return(null===(t=e.dateFormatInfo)||void 0===t?void 0:t.FirstDayOfWeek)||0}_getCalendarWeekRuleFromUserSettings(e){var t;return(null===(t=e.dateFormatInfo)||void 0===t?void 0:t.CalendarWeekRule)||0}getFormatterPropertiesForAttribute(e){return Object(b.z)(this.getState(),Object(S.a)(this.getState(),e.entity.entityName,e.attributeName))}static _getFieldName(e){return e.aliasName&&e.aliasName.trim()?e.aliasName:e.attributeName}isChartDrillable(){if(!this._isGroupByDrillable(this.chartDataDescription.category.primaryGroupBy))return!1;for(const e of this.chartDataDescription.category.measureCollections)for(const t of e.secondaryGroupBys)if(!this._isGroupByDrillable(t))return!1;return!!this.chartDataDescription.entityExpression.hasAggregate}_isGroupByDrillable(e){return!this.chartDataDescription.isGroupByFromNestedLinkEntity()&&(!(!e||!e.groupAttribute.hasGroupBy)&&this._isAttributeDrillable(e.groupAttribute))}_isAttributeDrillable(e){var t;const n=null===(t=null==e?void 0:e.entity)||void 0===t?void 0:t.entityName,r=null==e?void 0:e.attributeName;return"memo"!==Object(S.b)(r,n,this.getState())}_validateChartAggregateAttributes(){var e,t,n,r;for(let i=0;i<(null===(n=null===(t=null===(e=this.chartDataDescription)||void 0===e?void 0:e.entityExpression)||void 0===t?void 0:t.aggregateAttributes)||void 0===n?void 0:n.length);i++){const e=this.chartDataDescription.entityExpression.aggregateAttributes[i],t=null===(r=null==e?void 0:e.entity)||void 0===r?void 0:r.entityName,n=null==e?void 0:e.attributeName,a=Object(S.b)(n,t,this.getState());if(!("date"!==a&&"datetime"!==a||"min"!==e.aggregateType&&"max"!==e.aggregateType)){const e=String.format(Object(h.b)(this.getState(),g.h),n);throw new A("ChartError",e,e)}}}}function H(e){return!!e&&("stackedbar100"===e.toLowerCase()||"stackedcolumn100"===e.toLowerCase()||"stackedarea100"===e.toLowerCase())}function G(e,t){return function n(r,i,a,s){if(r===s.length)return a;const o=s[r].DataPoints[i];return a=n(++r,i,a+(o&&o.Value?o.Value:0),s),o&&o.Value&&(o.FormattedValue=Object(R.a)(o.Value/a*100,Object(R.g)(e),t)),a}}var W=n("iZ7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class U extends z{parse(){var e,t,n,r;if(!this.isInitialized)throw new Error("The instance of the ComparisonChartDataParser class is not properly initialized.");const i=new Array(0),a=new Map,s=this.chartDataDescription.category,o=s.measureCollections[0];if(o.secondaryGroupBys.length<=0)throw new Error("Comparison chart can only be plotted with secondary groups's");if(o.measures&&o.measures.length>0&&o.measures[0].parentCategory&&o.measures[0].parentCategory.primaryGroupBy&&(o.measures[0].parentCategory.primaryGroupBy.groupAttribute&&i.push(o.measures[0].parentCategory.primaryGroupBy.groupAttribute),o.measures[0].parentCategory.primaryGroupBy.extendedGroupBys))for(let e=0;e<o.measures[0].parentCategory.primaryGroupBy.extendedGroupBys.length;e++)i.push(o.measures[0].parentCategory.primaryGroupBy.extendedGroupBys[e]);if(1!==this.chartPresentationSeries.length)throw new Error("Comparison chart should have only one series");const c=this._addSecondaryGroupByToFieldAggregators(o,i),l=o.measures[0].measureAttribute,u=l.aliasName?l.aliasName:l.attributeName,d=u,p=s.primaryGroupBy.groupAttribute,h=T(this.getState(),this._getGroupByAttribute(p,s.primaryGroupBy),s.primaryGroupBy),g=new Array,y=new Array,f=new Map;for(let e=0;e<this.chartData.length;e++){const t=this.chartData[e],n=w(h,t);let r,i=w(c,t);null==i?(i=j(this.getState()),r=i):r=E(c,t),a.set(r,i),y.indexOf(n)<0&&y.push(n),g.indexOf(r)<0&&g.push(r)}g.forEach(e=>{const t=new Array(y.length);f.set(e,t)});const S=Object(m.w)(this.getState()),v=this.chartPresentationSeries[0].LabelFormat;let C=!1;this.chartPresentationSeries[0].Label&&"#percent"===this.chartPresentationSeries[0].Label.toLowerCase()&&(C=!0);let O=!1;v&&H(this.chartPresentationSeries[0].ChartType)&&Object(R.e)(v)&&(O=!0);for(let e=0;e<this.chartData.length;e++){const t=this.chartData[e];let n=E(c,t);Object(F.a)(n)&&(n=j(this.getState()));const r=f.get(n),a=w(h,t),s=y.indexOf(a);if(this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString&&(y[s]=Object(R.c)(Object(P.e)(t.fields[h.aliasName]),Object(b.d)(S),this.chartPresentationXAxis[0].FormatString)),r[s]=N(),r[s].Value=Object(P.e)(t.fields[u]),v){const n=Object(b.d)(S);Object(R.f)(v)?r[s].FormattedValue=Object(D.b)(r[e].Value,v,n):Object(R.d)(v)&&!O?r[s].FormattedValue=Object(R.a)(r[s].Value,Object(R.g)(v),n):r[s].FormattedValue=Object(P.c)(t.fields[d])||0}else r[s].FormattedValue=Object(P.c)(t.fields[d])||0;this.attachAggregators(r[s],t,i)}g.forEach(e=>{const t=f.get(e);for(let e=0;e<y.length;e++)t[e]||(t[e]=N())});const _=new Array(1);_[0]={},_[0].Title=this.retrieveChartCategoryTitle(h),_[0].Values=y,_[0].LabelForeColor=null===(e=this.chartPresentationXAxis[0])||void 0===e?void 0:e.LabelForeColor,_[0].AxisLineColor=null===(t=this.chartPresentationXAxis[0])||void 0===t?void 0:t.AxisLineColor,_[0].AxisTitleForeColor=null===(n=this.chartPresentationXAxis[0])||void 0===n?void 0:n.AxisTitleForeColor,_[0].LabelDisabled=null===(r=this.chartPresentationXAxis[0])||void 0===r?void 0:r.LabelDisabled,_[0]=this.setXAxisMajorGridAndMajorTickProperties(_[0]),_[0]=this.setXAxisIsReversedProperty(_[0]),this._sortComparisonCodes(o,g);const I=new Array(g.length),A=this.chartPresentationSeries[0]&&this.chartPresentationSeries[0].IsValueShownAsLabel,k=this.chartPresentationSeries[0]?this.chartPresentationSeries[0].LabelForeColor:null,M=this.chartPresentationSeries[0]&&this.chartPresentationSeries[0].HideInLegend,B=this.getChartTitleFromPresentationSeries(this.chartPresentationSeries[0].Name);for(let e=0;e<g.length;e++){const t=g[e];if(I[e]=this.cloneBlueprintSeriesStyle(this.chartPresentationSeries[0]),I[e].Title=B||a.get(t),I[e].DataPoints=f.get(t),I[e].HideInLegend=M,A){const t=x();t.Enabled=!0,t.LabelFormatter=L,I[e].DataLabels=t,t.Color=k}else if(C){let t=0;I[e].DataPoints.forEach(e=>{t+=e&&e.Value?e.Value:0});const n=x();n.Enabled=!0,n.LabelFormatter=V(t),I[e].DataLabels=n,n.Color=k}}if(A&&O){const e=G(v,Object(b.d)(S));for(let t=0;t<_[0].Values.length;t++)e(0,t,0,I)}this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=_,this.queryModel.YAxes=this._retrieveChartYAxis(l),this.queryModel.SeriesList=I,this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations()}_sortComparisonCodes(e,t){e.secondaryGroupBys[0].descending?t.sort((e,t)=>"number"==typeof e&&"number"==typeof t?t-e:t.localeCompare(e)):t.sort((e,t)=>"number"==typeof e&&"number"==typeof t?e-t:e.localeCompare(t))}_getGroupByAttribute(e,t){return e.attributeName!==Object(W.h)(this.getState(),e.entity.entityName).PrimaryIdAttribute?e:t.extendedGroupBys&&t.extendedGroupBys.length>0?t.extendedGroupBys[0]:e}_addSecondaryGroupByToFieldAggregators(e,t){const n=e.secondaryGroupBys[0].groupAttribute,r=T(this.getState(),this._getGroupByAttribute(n,e.secondaryGroupBys[0]),e.secondaryGroupBys[0]);if(n&&t.push(n),e.secondaryGroupBys[0].extendedGroupBys)for(let n=0;n<e.secondaryGroupBys[0].extendedGroupBys.length;n++)t.push(e.secondaryGroupBys[0].extendedGroupBys[n]);return r}_retrieveChartYAxis(e){var t,n,r,i,a,s,o,c;const l=new Array(1);return l[0]={},this.chartPresentationYAxis&&this.chartPresentationYAxis.length>0&&this.chartPresentationYAxis[0].Title?l[0].Title=this.chartPresentationYAxis[0].Title:l[0].Title=O(this.getState(),e),this.chartPresentationYAxis[0].FormatString?l[0].FormatString=this.chartPresentationYAxis[0].FormatString:l[0].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[0].measures[0].measureAttribute),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelForeColor&&(l[0].LabelForeColor=this.chartPresentationYAxis[0].LabelForeColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].AxisLineColor&&(l[0].AxisLineColor=this.chartPresentationYAxis[0].AxisLineColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].AxisTitleForeColor&&(l[0].AxisTitleForeColor=this.chartPresentationYAxis[0].AxisTitleForeColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelDisabled&&(l[0].LabelDisabled=null===(n=null===(t=this.chartPresentationYAxis)||void 0===t?void 0:t[0])||void 0===n?void 0:n.LabelDisabled),l[0].AxisInterval=null===(i=null===(r=this.chartPresentationYAxis)||void 0===r?void 0:r[0])||void 0===i?void 0:i.AxisInterval,l[0].AxisMinimum=null===(s=null===(a=this.chartPresentationYAxis)||void 0===a?void 0:a[0])||void 0===s?void 0:s.AxisMinimum,l[0].AxisMaximum=null===(c=null===(o=this.chartPresentationYAxis)||void 0===o?void 0:o[0])||void 0===c?void 0:c.AxisMaximum,this.shouldDisableAllowDecimals(0)&&(l[0].AllowDecimals=!1),l[0]=this.setYAxisMajorGridAndMajorTickProperties(l[0]),l[0]=this.setYAxisOppositeProperty(l[0]),l}}class q extends z{parse(){if(!this.isInitialized)throw new Error("The instance of the DateTimeChartDataParser class is not properly initialized.");this.categoryColumn&&0!==this.categoryColumn.length&&(this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=this.retrieveChartCategory(),this.queryModel.SeriesList=this.retrieveChartSeries(0),this.queryModel.YAxes=this.retrieveChartYAxis(),this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations())}retrieveChartCategory(){var e,t,n,r,i,a,s,o;const c=new Array(1);if(this.chartData.length<1)return c;const l=this.primaryGroupBy.groupAttribute;c[0]={};const u=new Array(this.chartData.length),d=T(this.getState(),l,this.primaryGroupBy);c[0].Title=this.retrieveChartCategoryTitle(d),c[0].LabelForeColor=null===(t=null===(e=this.chartPresentationXAxis)||void 0===e?void 0:e[0])||void 0===t?void 0:t.LabelForeColor,c[0].AxisLineColor=null===(r=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[0])||void 0===r?void 0:r.AxisLineColor,c[0].AxisTitleForeColor=null===(a=null===(i=this.chartPresentationXAxis)||void 0===i?void 0:i[0])||void 0===a?void 0:a.AxisTitleForeColor,c[0].LabelDisabled=null===(o=null===(s=this.chartPresentationXAxis)||void 0===s?void 0:s[0])||void 0===o?void 0:o.LabelDisabled,c[0]=this.setXAxisMajorGridAndMajorTickProperties(c[0]),c[0]=this.setXAxisIsReversedProperty(c[0]);for(let e=0;e<this.chartData.length;e++){const t=this.chartData[e];u[e]=w(d,t),d.isDateTimeChart&&this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString&&u[e]!==Object(h.b)(d.state,g.v)&&(u[e]=Object(R.b)(new Date(u[e]),Object(b.d)(Object(m.w)(this.getState())),this.chartPresentationXAxis[0].FormatString))}return c[0].Values=u,c}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class X extends z{parse(){if(!this.isInitialized)throw new Error("The instance of the NormalChartDataParser class is not properly initialized.");this.categoryColumn&&0!==this.categoryColumn.length&&(this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=this.retrieveChartCategory(),this.queryModel.SeriesList=this.retrieveChartSeries(0),this.queryModel.YAxes=this.retrieveChartYAxis(),this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations())}}var Y=n("DAWX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function K(e){const t={};try{if(e){const n=/\w+=\w+/;e.split(/\s*,\s*/).forEach(e=>{if(e&&n.test(e)){const[n,r]=e.split("=");t[n]=r}})}}catch(t){throw`Failed to parse chart custom properties, value: ${e} `}return{FunnelNeckHeight:t&&Number(t.FunnelNeckHeight)||0,FunnelNeckWidth:t&&Number(t.FunnelNeckWidth)||10,StackedGroupName:t&&t.StackedGroupName||null}}var Q=n("S2mk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Z=["COLUMN","STACKEDCOLUMN","STACKEDCOLUMN100","BAR","STACKEDBAR","STACKEDBAR100","AREA","STACKEDAREA","STACKEDAREA100","LINE","PIE","FUNNEL","TAG","DOUGHNUT","POINT"];function J(e,t,n){const r=(new DOMParser).parseFromString(t,"text/xml");!function(e,t){const n=e.getElementsByTagName("parsererror");if(n&&n.length>0)throw new A("ChartError",Object(h.b)(t,g.t),Object(h.b)(t,g.s))}(r,e);return{chartPresentationSeries:$(e,r,n),chartPresentationLegendList:ne(r),colorsList:te(r),chartPresentationArea3DStyle:oe(r),chartPresentationAreaGradientStyle:ce(r),chartPresentationXAxis:ie(r),chartPresentationYAxis:ae(r),chartPresentationAnnotationList:re(r)}}function $(e,t,n){const r=new Array,i=t.querySelectorAll("Chart Series Series"),a=new XMLSerializer;for(let t=0;t<i.length;t++){const s=i[t],o={},c=s.getAttribute("ChartType")||"Column";if(-1===Z.indexOf(c.toUpperCase()))throw new A("ChartError",Object(h.b)(e,g.t),Object(h.b)(e,g.t));o.ChartType=c;const l=s.getAttribute("Color");o.Color=l?le(l):null;const u=s.getAttribute("LegendText");o.LegendText=u||null;const d=s.getAttribute("CustomProperties");o.CustomProperties=K(d);const p=s.getAttribute("BorderColor");o.BorderColor=p?le(p):null;const m=s.getAttribute("BorderWidth");o.BorderWidth=m?Number(m):null;const b=s.getAttribute("IsValueShownAsLabel");o.IsValueShownAsLabel=b&&"true"===b.toLowerCase()||!1,o.Label=s.getAttribute("Label");const y=s.getAttribute("YAxisType");o.SecondaryYAxis=y&&"secondary"===y.toLowerCase();const f=s.getAttribute("IsVisibleInLegend");o.HideInLegend=f&&"false"===f.toLowerCase();const S=s.getAttribute("LabelForeColor");o.LabelForeColor=S?le(S):null,o.LabelFormat=s.getAttribute("LabelFormat");const v=ee(e,s.outerHTML||a.serializeToString(s),n);o.Name=v||null,o.Stack=o.CustomProperties.StackedGroupName,r.push(o)}return r}function ee(e,t,n){const r=Object(s.a)(t);if(Object(Q.j)(r)||r.length<5)return"";const i=r[2].toLowerCase(),a=r[4];let o="";const c=i.substring(0,n.length);if(c!==n)return"";const l=i.substring(n.length+1,i.length),u=Object(S.a)(e,c,l);return u&&u.OptionSet&&(o=u.OptionSet.filter(e=>e.Value.toString().toLowerCase()===a.toLowerCase())[0].Label),o}function te(e){const t=new Array,n=e.querySelector("Chart").getAttribute("PaletteCustomColors");return null!==n&&n.split(";").forEach(e=>{if(e){const n=le(e);t.push(n)}}),t}function ne(e){const t=new Array,n=e.querySelectorAll("Chart Legends Legend");for(let e=0;e<n.length;e++){const r={},i=n[e].getAttribute("Enabled");r.Enabled=null===i||"True"===i,t.push(r)}return t}function re(e){const t=new Array,n=e.querySelectorAll("Chart Annotations TextAnnotation");for(let e=0;e<n.length;e++){const r=n[e],i={},a=r.getAttribute("X");i.X=a?Number(a):null;const s=r.getAttribute("Y");i.Y=s?Number(s):null,i.Text=r.getAttribute("Text");const o=r.getAttribute("ForeColor");i.ForeColor=o?le(o):null,t.push(i)}return t}function ie(e){const t=new Array,n=e.querySelectorAll("Chart ChartAreas ChartArea AxisX");for(let r=0;r<n.length;r++){const i=n[r],a={};se(a,e.querySelectorAll("Chart ChartAreas ChartArea AxisX MajorGrid")[0],e.querySelectorAll("Chart ChartAreas ChartArea AxisX MajorTickMark")[0]),a.Title=i.getAttribute("Title");const s=e.querySelectorAll("Chart ChartAreas ChartArea AxisX LabelStyle")[0];if(s){const e=null==s?void 0:s.getAttribute("ForeColor"),t=null==s?void 0:s.getAttribute("Enabled");a.LabelForeColor=e?le(e):null,a.LabelDisabled=t&&"false"===t.toLowerCase(),a.FormatString=s.getAttribute("Format")}const o=i.getAttribute("Enabled"),c=i.getAttribute("LineColor"),l=i.getAttribute("TitleForeColor");a.Disabled=o&&"false"===o.toLowerCase(),a.AxisLineColor=c?le(c):null,a.AxisTitleForeColor=l?le(l):null,a.Disabled=o&&"false"===o.toLowerCase();const u=i.getAttribute("IsReversed");a.IsReversed=u&&"true"===u.toLowerCase(),t.push(a)}return t}function ae(e){const t=new Array,n=(e,n)=>{var r,i;const a={};if(!e)return void t.splice(n,0,a);const s=e;a.Title=s.getAttribute("Title");se(a,s.querySelectorAll("MajorGrid")[0],s.querySelectorAll("MajorTickMark")[0]);const o=s.getAttribute("Enabled");a.Disabled=o&&"false"===o.toLowerCase();const c=s.getAttribute("Interval"),l=s.getAttribute("Minimum"),u=s.getAttribute("Maximum");a.AxisInterval=c?Number(c):null,a.AxisMinimum=l?Number(l):null,a.AxisMaximum=u?Number(u):null;const d=s.querySelectorAll("LabelStyle");d&&d[0]&&d[0].getAttribute("Format")&&(a.FormatString=d[0].getAttribute("Format"));const p=null===(r=null==d?void 0:d[0])||void 0===r?void 0:r.getAttribute("ForeColor");a.LabelForeColor=p?le(p):null;const h=null===(i=null==d?void 0:d[0])||void 0===i?void 0:i.getAttribute("Enabled");a.LabelDisabled=h&&"false"===h.toLowerCase();const g=s.getAttribute("LineColor");a.AxisLineColor=g?le(g):null;const m=s.getAttribute("TitleForeColor");a.AxisTitleForeColor=m?le(m):null,t.splice(n,0,a)};let r=e.querySelectorAll("Chart ChartAreas ChartArea AxisY");return r&&n(r[0],0),r=e.querySelectorAll("Chart ChartAreas ChartArea AxisY2"),r&&n(r[0],1),t}function se(e,t,n){if(e){if(t){const n=t.getAttribute("LineColor"),r=t.getAttribute("Enabled");e.AxisMajorGridColor=n?le(n):null,e.AxisMajorGridEnabled=r&&"true"===r.toLowerCase()}if(n){const t=n.getAttribute("LineColor"),r=n.getAttribute("Enabled");e.AxisMajorTickMarkColor=t?le(t):null,e.AxisMajorTickMarkEnabled=r&&"true"===r.toLowerCase()}return e}}function oe(e){const t=e.querySelector("Chart ChartAreas ChartArea Area3DStyle"),n={};return n.Enable3D=!!t&&"true"===t.getAttribute("Enable3D").toLowerCase(),n}function ce(e){const t=e.querySelector("Chart ChartAreas ChartArea"),n={};return n.BackColor=t?t.getAttribute("BackColor"):"",n.BackSecondaryColor=t?t.getAttribute("BackSecondaryColor"):"",n.BackGradientStyle=t?t.getAttribute("BackGradientStyle"):"",n}function le(e){if(!e)return null;if(function(e){return/^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$/.test(e)}(e=e.trim()))return String.format("rgb({0})",e);if(function(e){return/#[0-9a-fA-F]{6}/.test(e)}(e))return e;if(function(e){return/^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,(\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,){2}\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$/.test(e)}(e)){const t=[];e.split(",").forEach(e=>t.push(e.trim()));const n=t.shift(),r=parseFloat(n)/255,i=t.slice();return i.push(r.toString()),String.format("rgba({0})",i.join(","))}return e}var ue=n("z8iZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function de(e){return{Text:e&&e.Text||"",HorizontalAlignment:e&&e.HorizontalAlignment||"center",VerticalAlignment:e&&e.VerticalAlignment||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class pe{constructor(e,t,n,r,i,a,s,o){this._getState=e,this._chartData=i,this._viewRecord=t,this._visualizationRecord=n,this._chartDataDescription=r,this._chartPresentationXML=a,this._drilldownChartType=s,this._entityLogicalName=o}buildChartModel(){if(this._chartQueryModel=Object(ue.a)(),this._chartData.length>0){this._buildChartHeading();try{this._buildChartPresentation(),this._buildChart()}catch(e){if(!(e instanceof A))throw e;this._buildErrorMessage(e)}}else this._buildDataEmptyMessage();return this._chartQueryModel}_buildDataEmptyMessage(){const e=Object(h.b)(this._getState(),g.m),t=de();t.Text=this._visualizationRecord&&this._visualizationRecord.get_DisplayName()?this._visualizationRecord.get_DisplayName():e,t.HorizontalAlignment="center",t.VerticalAlignment="middle",this._chartQueryModel.Title=t,this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName(),this._chartQueryModel.DisplayMode=1,this._chartQueryModel.ErrorInformation=new Y.a,this._chartQueryModel.ErrorInformation.set_ErrorType(null),this._chartQueryModel.ErrorInformation.set_ErrorDescription(e)}_buildErrorMessage(e){this._chartQueryModel.Title=de(),this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName(),this._chartQueryModel.DisplayMode=1,this._chartQueryModel.ErrorInformation=new Y.a,this._chartQueryModel.ErrorInformation.set_ErrorType(e.title),this._chartQueryModel.ErrorInformation.set_ErrorDescription(e.description)}_buildChartHeading(){const e=this._visualizationRecord.get_DisplayName();this._chartQueryModel.Title=de(),this._chartQueryModel.Title.Text=e,this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName()}_buildChartPresentation(){var e;this._chartPresentationParser=J(this._getState(),this._chartPresentationXML,this._entityLogicalName),this._drilldownChartType&&this._chartPresentationParser.chartPresentationSeries.forEach(e=>{e.ChartType=this._drilldownChartType}),this._chartPresentationSeries=this._chartPresentationParser.chartPresentationSeries,this._chartPresentationXAxis=this._chartPresentationParser.chartPresentationXAxis,this._chartPresentationYAxis=this._chartPresentationParser.chartPresentationYAxis,this._chartPresentationAnnotationList=this._chartPresentationParser.chartPresentationAnnotationList,this._chartPresentationArea3DStyle=this._chartPresentationParser.chartPresentationArea3DStyle,this._chartPresentationAreaGradientStyle=this._chartPresentationParser.chartPresentationAreaGradientStyle,this._chartQueryModel.Legend={Enabled:e&&e.Enabled||!1},this._chartPresentationParser.chartPresentationLegendList.length>0?this._chartQueryModel.Legend.Enabled=this._chartPresentationParser.chartPresentationLegendList[0].Enabled:this._chartQueryModel.Legend.Enabled=!1,this._colors=this._chartPresentationParser.colorsList}_buildChart(){this._chartParserType=this._getChartParserType();const e=function(e){let t=null;switch(e){case 2:t=new U;break;case 3:t=new q;break;case 1:default:t=new X}return t}(this._chartParserType);e.initialize(this._getState,this._chartData,this._chartDataDescription,this._chartPresentationSeries,this._chartPresentationXAxis,this._chartPresentationYAxis,this._chartPresentationArea3DStyle,this._chartPresentationAreaGradientStyle,this._chartQueryModel,this._chartPresentationAnnotationList),this._chartQueryModel.Colors=this._colors,e.parse()}_getChartParserType(){return this._chartDataDescription.isComparisonChart?2:this._chartDataDescription.category.primaryGroupBy.groupAttribute.dateTimeGrouping?3:1}}var he=n("haag"),ge=n("0L4T"),me=n("nxXM"),be=n("ddoO"),ye=n("q/7h"),fe=n("Tezb"),Se=n("WF3G"),ve=n("4r2D");function Ce(e,t,n){return{type:"chartData.retrieve.core.async",execute({dispatch:r,getState:a},o,c){const l=[];try{const u=a();if(!Object(s.b)(a,r,o,l,e,t,n,!0))return Promise.resolve();const d=new Se.a(e.fetchXml);d.set_NoLock(!0),d.set_PageSize(e.dataDefinition.entityExpression.top);const p=function(e){const t={};if(null!=e){const n=new Se.a(e);n.set_PageSize(0),n.set_NoLock(!0),t[""]=n}return t}(e.viewXml);return function(e,t,n,r){const a=new ve.a(i.a.toString(i.a.newGuid()),r&&r.isPreloadCall);return e.retrieveEntitiesForAggregateQuery(t,n,a).nativePromise()}(o.DataSource,d,p,c).then(o=>{const c=function(t,n,r){const i=new Pe(e.viewTitle,e.viewEntityLogicalName),a=new Pe(e.chartName,e.chartPrimaryEntityTypeCode),o=e.dataDefinition,c=Object(ye.a)(t);Object(s.e)(o,c,n());const l=e,u=new pe(n,i,a,o,c,e.presentationXml,l.drillDownChartType?l.drillDownChartType:null,r);return u.buildChartModel()}(o,a,t);Object(k.c)(u,M.rd)?(r(je(e.getStorageKey(),c)),_e(u,r,e.getStorageKey(),n)):(r(Ie(i.a.toString(e.visualizationId),i.a.toString(e.viewId),c)),Oe(u,r,i.a.toString(e.visualizationId),i.a.toString(e.viewId),n))}).catch(t=>{Object(ge.c)(u,r,t,e,n)})}catch(e){return o.EventManager.ReportComponentFailure(s.f+".retrieveChartDataCore",Error(e),he.b,l),Promise.reject(e)}}}}function Oe(e,t,n,a,s){if(e){const o=new i.a(n),c=i.a.toString(o),l=new i.a(a),u=i.a.toString(l),d={},p={};if(p[u]=function(e,t,n,i){if(!e)return null;if(i&&""!==i){const a=Object(be.c)(e,t,n),s=a&&a.slice();return Object(r.a)(s,i)}return null}(e,c,u,s),p[u]){d[c]=p;const e={entities:null,lists:null,charts:d};t(Object(me.b)(e))}}}function _e(e,t,n,i){if(e){const a={};if(a[n]=function(e,t,n){if(!e)return null;if(n){const i=Object(be.b)(e,t),a=i&&i.slice();return Object(r.a)(a,n)}return null}(e,n,i),a[n]){const e={entities:null,lists:null,charts:null,chartData:a};t(Object(me.b)(e))}}}function Ie(e,t,n){const r=new i.a(e),s=i.a.toString(r),o=new i.a(t),c={charts:{[s]:{[i.a.toString(o)]:{initialized:a.a.Initialized,chartConfigObject:n}}}};return{type:fe.d,payload:c}}function je(e,t){const n={chartData:{[e]:{initialized:a.a.Initialized,chartConfigObject:t}}};return{type:fe.d,payload:n}}class Pe{constructor(e,t){this._displayName=e,this._associatedEntityLogicalName=t,Object.freeze(this)}get_DisplayName(){return this._displayName}get_AssociatedEntityLogicalName(){return this._associatedEntityLogicalName}}},jR7L:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="form.entityreferencebyrelationship";function i(e,t){return{type:r,payload:t,meta:{pageId:e}}}},jSRx:function(e,t,n){"use strict";n.d(t,"a",(function(){return P}));var r=n("nuS9"),i=n("u+q+"),a=n("H/hG"),s=n("evW+"),o=n("pxbl"),c=n("Smta"),l=n("YWpA"),u=n("unFF"),d=n("b8TU"),p=n("eu2O"),h=n("Lyxw"),g=n("3/02");var m=n("vTeb"),b=n("/Ikn"),y=n("dGG5"),f=n("XIN1"),S=n("znb3"),v=n("3rse"),C=n("Afz2"),O=n("zJiL"),_=n("YxC/"),I=n("sptG");class j extends r.Component{constructor(e){super(e),this._onButtonClick=this._onButtonClick.bind(this),this._onNotificationClick=this._onNotificationClick.bind(this),this.toggleExpandMessage=this.toggleExpandMessage.bind(this),this.onRenderCompleteCallback=this.onRenderCompleteCallback.bind(this),this.onKeyDownAnchorEvent=this.onKeyDownAnchorEvent.bind(this),this.onKeyDownEvent=this.onKeyDownEvent.bind(this),this.state={messageExpanded:!1},this._backgroundCanvas=document.createElement("canvas")}toggleExpandMessage(e){e&&e.stopPropagation(),this.setState(Object.assign(Object.assign({},this.state),{messageExpanded:!this.state.messageExpanded}))}_renderButtons(){const e=this.props.notification.Buttons,t=[];if(!e||0===e.length)return null;for(const n in e){const i=e[n],o=Object(b.b)(this.props.notification.UniqueId,n),c=0===t.length?this.props.buttonStyle:this.props.secondaryButtonStyle,l=Object.assign(Object.assign({},c),0===t.length?this.props.firstButtonStyle:{});if(t.push(r.createElement(s.a,{key:o,id:o,style:l,onClick:this._onButtonClick.bind(this,i),title:i.Label},r.createElement(a.a,{testhooks:{id:i.Label},style:0===t.length?this.props.buttonLabelStyle:this.props.secondaryButtonLabelStyle},i.Label))),t.length>2)break}return r.createElement(l.a,{key:"buttonWrapper",style:this.props.buttonWrapperStyle},t)}_renderCloseButton(){return this.props.closeAction&&r.createElement(s.a,{onClick:this.props.closeAction,style:this.props.closeButtonStyle},r.createElement(f.b,{type:S.a.Cancel}))}_renderMessage(e,t){const n=this.props.notification.MessagePlaceholders,i=[];let s="";const c=this.state.messageExpanded||!t?99:2;if(n&&n.length>0&&this._getPlacehoderCountInMessage()===n.length){const e=this.props.notification.Message.split(/{[0-9]+}/);for(const t in e){const a=e[t];if(i.push(a),s=s.concat(a),parseInt(t,10)<n.length){const e=n[parseInt(t,10)],a=Object(y.b)(this.props.notification.UniqueId,t);s=s.concat(e.Label),e.Handler?i.push(r.createElement(m.a,{key:a,id:a,style:this.props.placeHolderLinkStyle,href:null,onClick:this._onButtonClick.bind(this,e)},e.Label)):i.push(e.Label)}}}return r.createElement(l.a,{key:"message",style:this.props.notificationType===O.a?this.props.notificationErrorMessageStyle:this.props.notificationMessageStyle},r.createElement(o.a,{noExpandable:!0,truncatedlines:c,testhooks:{id:"warningNotification"}},i&&i.length>0?i:this.props.notification.Message,e&&this.state.messageExpanded?r.createElement(a.a,{onClick:this.toggleExpandMessage,style:this.props.notificationExpandTextStyle,tabIndex:0,onKeyDown:this.onKeyDownEvent},this._notificationLongMessageTruncate()):null),e&&!this.state.messageExpanded?r.createElement(a.a,{onClick:this.toggleExpandMessage,style:this.props.notificationExpandTextStyle,tabIndex:0,onKeyDown:this.onKeyDownEvent},this._notificationLongMessageExpand()):null)}_getPlacehoderCountInMessage(){return(this.props.notification.Message.match(/{[0-9]+}/g)||[]).length}_onButtonClick(e,t){t.preventDefault(),this.props.buttonOnClick(e)}_notificationLongMessageTruncate(){return Object(_.c)(this.props.resourceStrings,I.c)}_notificationLongMessageExpand(){return Object(_.c)(this.props.resourceStrings,I.b)}_getMessageIcon(e,t){switch(e){case O.a:return r.createElement(l.a,{accessibilityHidden:!0,style:this.props.errorIconStyleWrapper},r.createElement(f.b,{style:this.props.notificationIconStyle,id:"notification_icon_"+t,type:S.a.MarkAsLost}));case O.e:return r.createElement(l.a,{accessibilityHidden:!0,style:this.props.warningIconStyleWrapper},r.createElement(f.b,{style:this.props.notificationIconStyle,id:"notification_icon_"+t,type:S.a.Warning}));case O.d:return r.createElement(l.a,{accessibilityHidden:!0,style:this.props.successIconStyleWrapper},r.createElement(f.b,{style:this.props.notificationIconStyle,id:"notification_icon_"+t,type:S.a.SuccessIcon}));case O.c:return r.createElement(l.a,{accessibilityHidden:!0,style:this.props.infoIconStyleWrapper},r.createElement(f.b,{style:this.props.notificationIconStyle,id:"notification_icon_"+t,type:S.a.Locked,testhooks:{id:"formReadOnlyIcon"}}));default:return r.createElement(l.a,{accessibilityHidden:!0,style:this.props.infoIconStyleWrapper},r.createElement(f.b,{style:this.props.notificationIconStyle,id:"notification_icon_"+t,type:S.a.InformationIcon}))}}onRenderCompleteCallback(){this.props.shouldNotifyRenderComplete&&this.props.onRenderComplete()}componentDidMount(){this.onRenderCompleteCallback()}onKeyDownEvent(e){e.keyCode===v.a.Escape?this.props.keyDownHandler(e):e.keyCode===v.a.Enter&&this.toggleExpandMessage()}onKeyDownAnchorEvent(e){e.keyCode===v.a.Escape?this.props.keyDownHandler(e):e.keyCode===v.a.Enter&&this._onNotificationClick()}_onNotificationClick(){this.props.notification.OnNotificationClick&&(!this.props.onlyNotification&&this.props.toggleFlyout&&this.props.toggleFlyout(),this.props.notificationClick())}_isLongMessage(){const e=this._backgroundCanvas.getContext("2d");e.font=this.props.notificationMessageStyle.fontSize&&this.props.notificationMessageStyle.fontFamily;return e.measureText(this.props.notification.Message).width/this.props.domWidth>=2}render(){const e=this._isLongMessage(),t=!this.props.useSeeMoreBtn&&e,n=Object.assign(Object.assign(Object.assign({},this.props.formNotificationStyle),this.props.displayFullMessage?{maxHeight:"none"}:{}),{":hover":{backgroundColor:this.props.notification.OnNotificationClick||t?"#F3F2F1":""},cursor:this.props.notification.OnNotificationClick||t?"pointer":"default"});return r.createElement(c.a,{key:"Notification_"+this.props.notification.UniqueId,style:n,onClick:this.props.notification.OnNotificationClick?this._onNotificationClick.bind(this):void 0,onKeyDown:this.props.notification.OnNotificationClick?this.onKeyDownAnchorEvent:this.onKeyDownEvent,role:!this.props.onlyNotification||"ERROR"!==this.props.notification.Level&&"INFORMATION"!==this.props.notification.Level&&"WARNING"!==this.props.notification.Level?void 0:C.a},r.createElement(a.a,{key:"text",style:this.props.messageIconWrapperStyle},r.createElement(a.a,{style:this.props.messageIconStyle,accessibilityHidden:!0},this._getMessageIcon(this.props.notification.Level,this.props.notification.Message))),r.createElement(l.a,{key:"notificationMessageAndButtons",id:"notificationMessageAndButtons",onClick:this.props.notification.OnNotificationClick||!t?void 0:this.toggleExpandMessage,style:this.props.notificationMessageAndButtonsStyle,isRequestedMeasuring:!!this.props.buttonMeasuringCallback,onMeasuring:this.props.buttonMeasuringCallback},this._renderMessage(this.props.useSeeMoreBtn&&e,e),this._renderButtons()),this._renderCloseButton())}}j.displayName="FormNotification";const P=Object(i.a)((function(){const e=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e=null,t=null,n=null,r=!1,i=null;return function(a,s){const o=Object(u.a)(a),c=Object(d.c)(a),l=Object(h.a)(a,g.ob);if(t!==o||n!==c||r!==s.onlyNotification||i!==s.notificationType){t=o,n=c,r=s.onlyNotification,i=s.notificationType;const a=s.notificationWidth<=o.sizes.Breakpoints.DimensionXS;e={formNotificationStyle:{display:"flex",width:"100%",flexDirection:"row",backgroundColor:s.onlyNotification?Object(p.d)(s.notificationType):"#FFFFFF",paddingRight:"10px",paddingLeft:"10px",minHeight:p.a+"px",height:"auto",lineHeight:o.sizes.Measures.Measure100,boxSizing:"border-box",overflow:"hidden",borderBottom:s.onlyNotification?"":"1px solid "+p.c},notificationMessageAndButtonsStyle:{display:"flex",flexDirection:"row",flexWrap:"wrap",width:"100%",paddingLeft:"9px",paddingRight:"9px"},notificationMessageStyle:{flexGrow:1,whiteSpace:"normal",padding:0,marginTop:"7px",marginBottom:"7px",lineHeight:"16px",overflow:"hidden",textOverflow:"ellipsis",fontSize:"12px",fontFamily:o.fontFamilies.Regular,color:"#1F2126"},notificationExpandTextStyle:{fontSize:"12px",whiteSpace:"nowrap",paddingTop:"16px",fontFamily:o.fontFamilies.Regular,color:"#0000FF",paddingLeft:"2px",paddingRight:"2px",cursor:"pointer"},notificationErrorMessageStyle:{flexGrow:1,whiteSpace:"normal",marginTop:"7px",marginBottom:"7px",lineHeight:"16px",overflow:"hidden",textOverflow:"ellipsis",fontSize:"12px",fontFamily:o.fontFamilies.Regular,color:"#1F2126"},buttonWrapperStyle:{marginBottom:"5px",maxWidth:"100%",flexWrap:a?"wrap":"nowrap",marginTop:"5px"},buttonStyle:{height:"21px",backgroundColor:"#6E6F77",border:"1px solid #6E6F77",boxSizing:"border-box",borderRadius:"2px",":hover":{border:"1px solid #3A3C42",boxSizing:"border-box",borderRadius:"2px",backgroundColor:"#3A3C42"}},secondaryButtonStyle:{height:"21px",backgroundColor:"#FFFFFF",border:"1px solid #6E6F77",boxSizing:"border-box",borderRadius:"2px",":hover":{border:"1px solid #A4A6AC",boxSizing:"border-box",backgroundColor:"#E8EAEC",borderRadius:"2px"}},buttonLabelStyle:Object.assign(Object.assign({},o.buttons.ButtonPrimaryText),{color:"#FFFFFF",lineHeight:"19px",fontSize:"12px"}),secondaryButtonLabelStyle:Object.assign(Object.assign({},o.buttons.ButtonSecondaryText),{color:"#1F2126",lineHeight:"19px",fontSize:"12px"}),placeHolderLinkStyle:{cursor:"pointer",color:o.colors.BaseColor.Blue.Blue3,padding:0},messageIconWrapperStyle:{boxSizing:"content-box",minWidth:l?"16px":"20px",height:l?"16px":"20px",position:"relative"},messageIconStyle:{position:"absolute",height:l?"16px":"20px",width:l?"16px":"20px",paddingTop:"9px"},firstButtonStyle:{marginRight:a?"0":"0.5rem"},errorIconStyleWrapper:{color:p.f},successIconStyleWrapper:{color:p.h},warningIconStyleWrapper:{color:p.i},infoIconStyleWrapper:{color:p.g},notificationIconStyle:{fontSize:"20px"},closeButtonStyle:{backgroundColor:"transparent",borderWidth:0,marginTop:"8px",height:"16px",fontSize:"16px",padding:0}}}return e}}(),t=Object(_.h)();return function(n,r){const i=e(n,r),a=t(n,I.f),s=Object(h.a)(n,g.ob);return Object.assign(Object.assign({},i),{resourceStrings:a,useSeeMoreBtn:s})}}),(function(e,t){return{buttonOnClick:t=>{t.Handler&&("function"==typeof t.Handler?t.Handler():e(t.Handler))},notificationClick:t.notification.OnNotificationClick&&(()=>e(t.notification.OnNotificationClick)),closeAction:t.notification.CloseAction&&(()=>e(t.notification.CloseAction))}}))(j)},jrkH:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var r=n("uNu9"),i=n("nuS9"),a=n("u+q+"),s=n("7p56"),o=n("dHD5"),c=n("P6DH"),l=n("BFlg"),u=n("KBcj"),d=n("+zjj"),p=n("whN/"),h=n("jAuy"),g=n("kC0I"),m=n("9fGf");function b(){let e=null;return(t,n,r,i,a)=>{const s=Object(c.n)(t,i,n,r,a);return((e?!s:s)||((t,n)=>{if(e&&n){const r=Object(c.ab)(t,n.CustomControlId);if(!r)return!0;if(e.CustomControlId!==n.CustomControlId)return!0;const i=n.Parameters[r],a=e.Parameters[r];return!a||!i||a.RelationshipName!==i.RelationshipName||a.ViewId!==i.ViewId||a.TargetEntityType!==i.TargetEntityType}})(t,s))&&(e=s),e}}const y=Object(a.a)((function(){let e=null,t=null;const n=b(),r=Object(g.a)();return function(i,a){const{id:s,formInfo:l}=a,h=Object(d.e)(i,a,a.parentContextToken);t!==h&&(t=h);const g=Object(o.a)(a.parentContextToken,h.relationshipName,h.ordinal),b=Object(c.T)(i,s,g),y=t&&t.relationshipName,f=t&&t.ordinal?t.ordinal:p.a.Referencing;e||(e=Object(o.j)(i,s));let S=null;t&&t.entityName&&t.relationshipName&&b&&(S=n(i,t.entityName,t.relationshipName,b,s));let v=null;const C=Object(u.d)(i,b);h&&h.entityName&&(v=Object(c.l)(i,h.entityName));const O=S&&r(i,S,g),_=Object(m.b)(i);return{subgridConfiguration:S,id:s,viewId:b,relationshipName:y,parentContextToken:e,formInfo:l,homePageConfigurations:v,viewConfigurations:C,roleOrd:f,dataSetUIOptions:O,deviceFormFactor:_}}}))((function(e){if(e.viewId&&e.relationshipName){const t=e.homePageConfigurations&&e.homePageConfigurations.CustomControls&&e.homePageConfigurations.CustomControls[e.deviceFormFactor];Object(h.m)(t);const n={gridConfigurations:e.homePageConfigurations,viewConfigurations:e.viewConfigurations};return i.createElement(s.a,{key:e.id+e.relationshipName,id:e.id,controlId:"entity_control",contextString:l.h.ASSOCIATEDGRID,configuration:e.subgridConfiguration,nonCompositionProps:n,descriptor:null,parentContextToken:e.parentContextToken,dataSetUIOptions:e.dataSetUIOptions})}return null}));var f=n("YWpA"),S=n("223Y"),v=n("Z/4N"),C=n("3mEc"),O=n("455M"),_=n("iZ7K"),I=n("arV0"),j=n("NjDY"),P=n("IqkD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const F="MscrmControls.WebResource.WebResourceHtmlControl";const T=Object(a.a)((function(){let e={manifest:null,entityTypeCode:null,orgName:null,userSettings:null,orgSettings:null};return(t,n)=>{const r=Object(v.e)(t,F),i=Object(I.g)(t,n.id),a=Object(_.p)(t,i.entityTypeName),s=Object(j.x)(t),o=Object(j.w)(t),c=Object(P.w)(t);return null===r&&null===i&&null===a&&null===c&&null===s||(e={manifest:r,entityTypeCode:a,orgName:o,userSettings:c,orgSettings:s}),e}}))((function(e){const t=function(e){const t={formId:e.formId,id:e.recordId,orglcid:e.orgSettings.languageCode.toString(),orgname:e.orgName,pagemode:"iframe",type:e.entityTypeCode.toString(),typename:e.entityName,userlcid:e.userSettings.languageId.toString()},n=Object.keys(t).map(e=>[e,t[e]].map(encodeURIComponent).join("=")).join("&");return e.url+"?"+n}(e),n={FormFactor:2,CustomControlId:F,Name:C.a,Version:"1.0.0",Parameters:{value:{Usage:0,Type:O.a.WebResourceHtmlControl}},ShouldOverrideControlVisible:!1},r={Id:F,Label:"",Name:C.a,ShowLabel:!1,Visible:!0,Disabled:!1,Url:t,Parameters:{Url:t,Security:"false",Border:"false"}};return i.createElement(f.a,{key:"WebResourceGanttGridRoot",style:{display:"flex",flexDirection:"row",flex:"auto"}},i.createElement(S.c,{key:F,id:e.id,controlId:F,configuration:n,descriptor:r,parentContextToken:e.parentContextToken}))}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const w=Object(a.a)((function(){let e={manifest:null,entityTypeCode:null,orgName:null,userSettings:null,orgSettings:null};return(t,n)=>{const r=Object(v.e)(t,"MscrmControls.AuditAssociatedGrid.AuditControl"),i=Object(I.g)(t,n.id),a=Object(_.p)(t,i.entityTypeName),s=Object(j.x)(t),o=Object(j.w)(t),c=Object(P.w)(t);return null===r&&null===i&&null===a&&null===c&&null===s||(e={manifest:r,entityTypeCode:a,orgName:o,userSettings:c,orgSettings:s}),e}}))((function(e){const t=function(e){const t={formId:e.formId,id:e.recordId,orglcid:e.orgSettings.languageCode.toString(),orgname:e.orgName,pagemode:"iframe",type:e.entityTypeCode.toString(),typename:e.entityName,userlcid:e.userSettings.languageId.toString()},n=Object.keys(t).map(e=>[e,t[e]].map(encodeURIComponent).join("=")).join("&");return e.url+"?"+n}(e),n={FormFactor:2,CustomControlId:"MscrmControls.AuditAssociatedGrid.AuditControl",Name:C.a,Version:"1.0.0",Parameters:{FormId:{Usage:1,Static:!0,Type:O.a.SingleLineText,Value:e.formId},OType:{Usage:1,Static:!0,Type:O.a.SingleLineText,Value:e.entityTypeCode},value:{Usage:0,Type:O.a.WebResourceHtmlControl}},ShouldOverrideControlVisible:!1},r={Id:"MscrmControls.AuditAssociatedGrid.AuditControl",Label:"",Name:C.a,ShowLabel:!1,Visible:!0,Disabled:!1,Url:t,Parameters:{Url:t,Security:"false",Border:"false"}},a="AuditHistoryGrid";return i.createElement(f.a,{key:a+"-container",style:{display:"flex",flexDirection:"column",flex:1}},i.createElement(S.c,{key:a+"-customControlHost",id:e.id,controlId:"MscrmControls.AuditAssociatedGrid.AuditControl",configuration:n,descriptor:r,parentContextToken:e.parentContextToken,parentDefinedControlProps:{containerStyleOverrides:{rootContainer:{height:"100%"}}}}))})),E=e=>{const t=e.selectedRelatedEntity;if(!(null==t?void 0:t.isSelected))return null;if(t.entityName===r.g&&e.isAuditFeatureEnabled)return i.createElement(w,{id:e.id,parentContextToken:e.contextToken,formId:e.formId,entityName:e.entityName,recordId:e.recordId,url:t.url});if(!t.url){const t={EntityName:e.entityName,RecordId:e.recordId};return i.createElement(f.a,{style:e.style},i.createElement(y,{parentContextToken:e.contextToken,id:e.id,formInfo:t}))}return i.createElement(T,{id:e.id,parentContextToken:e.contextToken,formId:e.formId,entityName:e.entityName,recordId:e.recordId,url:t.url})};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},jsFU:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return a}));var r=n("BFlg"),i=n("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="control.update.formlessControlOutputs";function s(e,t,n){return{type:"control.update.formlessControlOutputs.async",execute({dispatch:s,getState:o},c){const l=c.TraceManager.getTracer(r.z),u=r.x+".formlessControlOutputsIdAction";try{if(!Object.keys(n).length)return Promise.resolve();const r=o(),d=Object(i.a)(r,e),p=Object.assign({},d.formlessControlOutputs);let h=!1;l.info("Updating the unbound output.");for(const e in n){const r=n[e],i=t+"."+e;p[i]!==r&&(p[i]=r,h=!0)}return h&&s(function(e,t){return{type:a,payload:{formlessControlOutputs:t},meta:{pageId:e}}}(e,p)),c.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){const t="Updating the outbound outputs for the grid failed with error : "+e.message;c.EventManager.ReportComponentFailure(u,Error(t))}}}}},kC0I:function(e,t,n){"use strict";n.d(t,"i",(function(){return de})),n.d(t,"g",(function(){return ne})),n.d(t,"e",(function(){return re})),n.d(t,"d",(function(){return ie})),n.d(t,"f",(function(){return he})),n.d(t,"h",(function(){return ge})),n.d(t,"c",(function(){return se})),n.d(t,"a",(function(){return ue})),n.d(t,"b",(function(){return le}));var r=n("SAYH"),i=n("eOoD"),a=n("w1eR"),s=n("eXjw"),o=n("S2mk"),c=n("jRy5"),l=n("ILmX"),u=n("d0w6"),d=n("iZ7K"),p=n("IqkD"),h=n("NjDY"),g=n("YxC/"),m=n("KBcj"),b=n("BzGi"),y=n("BFlg"),f=n("P6DH"),S=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function v(){let e=null,t=null,n=null;return(r,i)=>{const a=i.parentContextToken,s=i.contextString,o=function(e,t){const n=t.parentContextToken;switch(t.contextString){case y.h.ASSOCIATEDGRID:const r=Object(f.gb)(e,t,n);return S.a(n,r.relationshipName,r.ordinal);case y.h.SUBGRID:if(t.descriptor&&t.descriptor.StreamId)return S.o(n,t.descriptor.Name,t.descriptor.StreamId,!!t.descriptor.IsTile);const i=S.p(n,t.descriptor.Name),a=i&&i.parentContextToken?i.parentContextToken.entityTypeName:null;return i.relationshipType=se(e,t,a,i),i;case y.h.GRID:return S.k(e,t.id);case y.h.CUSTOM:return S.c(n,t.controlId);default:return n}}(r,i);return(n!==s||C(e,o)||C(t,a))&&(e=o,t=a,n=s),e}}function C(e,t){return e&&t?e.entityTypeName!==t.entityTypeName||e.controlName!==t.controlName||(e.formId&&e.formId.guid)!==(t.formId&&t.formId.guid)||(e.recordId&&e.recordId.guid)!==(t.recordId&&t.recordId.guid)||e.relationshipName!==t.relationshipName||e.roleOrd!==t.roleOrd:e!==t}var O=n("5O6t"),_=n("XvLr"),I=n("LzVy"),j=n("sclX"),P=n("unFF"),F=n("GYEz"),T=n("o0iw"),w=n("504W"),E=n("3hnk"),x=n("sZ+8"),N=n("69Qu"),A=n("3/02"),k=n("Lyxw"),M=n("kt5S"),D=n("jAuy"),R=n("arV0"),B=n("pEXn"),L=n("5R5s"),V=n("VnpK"),z=n("85o3"),H=n("lEp6"),G=n("YPtO"),W=n("0kGT"),U=n("Z/4N"),q=n("nIfK"),X=n("8nT0"),Y=n("CbNq"),K=n("b41/"),Q=n("7+p5"),Z=n("37s6"),J=n("LbMF"),$=n("SJlc"),ee=n("AVDU"),te=n("H4dV");function ne(e){return e===y.h.SUBGRID}function re(e){return e===y.h.GRID}function ie(e){return e===y.h.ASSOCIATEDGRID}function ae(e){switch(e){case y.h.ASSOCIATEDGRID:case y.h.SUBGRID:return"div";case y.h.GRID:default:return"section"}}function se(e,t,n,r){let i=n?Object(d.G)(e,n,r.relationshipName):null;if(null===i&&t.descriptor&&t.descriptor.Parameters){const r=t.descriptor.Parameters[y.F.RELATIONSHIP_NAME],a=t.descriptor.Parameters[y.F.TARGET_ENTITY_TYPE];r&&n?i=Object(d.G)(e,n,r):r&&a&&(i=Object(d.G)(e,a,r))}return i}function oe(){let e=null,t=null;return n=>(e!==n.contextString&&(e=n.contextString,t=function(e){switch(e.contextString){case y.h.ASSOCIATEDGRID:case y.h.SUBGRID:return[u.a.SUB_GRID,u.a.MAIN_APPLICATION_VIEW];case y.h.GRID:return e.isAdvancedFindView?[u.a.ADVANCED_SEARCH]:[u.a.MAIN_APPLICATION_VIEW];default:return[u.a.MAIN_APPLICATION_VIEW]}}(n)),t)}function ce(e){return e&&[e.CustomControlId,e.Name].some(e=>-1!==q.a.indexOf(e))}function le(e,t,n){if(!e||!e.contextTokenType||e.contextTokenType!==c.a.AssociatedGrid&&e.contextTokenType!==c.a.MainGrid)return null;switch(t){case"displayChart":return!1;case"displayCommandBar":return!0;case"displayIndex":return ce(n);case"displayQuickFind":case"displayViewSelector":return!0}return null}function ue(){let e=null,t=null;return(n,r,i)=>{if(e&&t===r.CustomControlId)return e;const a=r&&r.CustomControlId?r.CustomControlId:null;if(!a)return null;const s=Object(f.ab)(n,a),o=Object(U.e)(n,a);if(s&&o&&o.Properties.DataSetDefinitions&&o.Properties.DataSetDefinitions[s]&&o.Properties.DataSetDefinitions[s].CDSDataSetOptions){const n=o.Properties.DataSetDefinitions[s].CDSDataSetOptions;e={displayChart:n.hasOwnProperty("displayChart")?n.displayChart:le(i,"displayChart",r),displayCommandBar:n.hasOwnProperty("displayCommandBar")?n.displayCommandBar:le(i,"displayCommandBar",r),displayIndex:n.hasOwnProperty("displayIndex")?n.displayIndex:le(i,"displayIndex",r),displayQuickFind:n.hasOwnProperty("displayQuickFind")?n.displayQuickFind:le(i,"displayQuickFind",r),displayViewSelector:n.hasOwnProperty("displayViewSelector")?n.displayViewSelector:le(i,"displayViewSelector",r)},t=r.CustomControlId}return e}}function de(){let e,t=null,n=null,c=null,S=null,C="",V=null,U=null,q=null,le=null,ue=null,de=null,he=null,ye=null;const fe=function(){let e=null;return(t,n,r,i)=>{let a=e;switch(Object(w.b)(i)&&(i=n.contextString),i){case y.h.ASSOCIATEDGRID:a=Object(l.b)(r);break;case y.h.SUBGRID:a=Object(l.l)(r);break;case y.h.GRID:default:a=Object(l.h)(r)}return a!==e&&(e=a),e}}(),Se=Object(O.a)(),ve=v(),Ce=function(){let e=null;const t=function(){let e=null;return(t,n,i)=>{let s,c,l,u,d;if(Object(f.ib)(t,n.id,i)){s=Object(f.T)(t,n.id,i);const e=Object(f.qb)(t,s,n.id);c=e&&e.entityLogicalName,d=e&&e.isUserView,l=Object(f.r)(t,n.id,i,c),u=Object(f.s)(t,n.id,i)!==b.a.savedvisualization}else{const e=Object(f.ab)(t,n.configuration.CustomControlId);if(e){const t=n.configuration.Parameters[e];t&&(s=t.ViewId&&new r.a(t.ViewId),c=t.TargetEntityType,l=t.VisualizationId&&new r.a(t.VisualizationId),u=!(!t.IsUserChart||"true"!==t.IsUserChart),d=!(!t.IsUserView||"true"!==t.IsUserView))}}if(!r.a.isNullOrEmpty(s)&&l&&c){const p=Object(f.q)(t,n.id,i),h=Object(f.p)(t,n.id,i),g=Object(f.C)(t,n.id,i),m=pe(t,n,i,g,!0),b=Object(f.N)(t,n.id,i),S=t.user&&t.user.userId,v=Object(k.c)(t,A.Zc),C=Object(L.a)(c,S,i,v),O=C&&C.getFilterAndLinkedEntities(g&&g.activityOrQueueFilterValue?g.activityOrQueueFilterValue:void 0),_=O&&null!==O.linkEntities?JSON.stringify(O.linkEntities):null,I=Object(k.a)(t,A.Od,A.h),j=!I||I&&Object(F.a)(t)===a.a.MobileApplication,P=I,T=ie(n.contextString)?Object(o.p)(y.d,c,r.a.toString(s),r.a.toString(l),i.relationshipName,b,u,d,m,_,P):Object(o.t)(y.d,c,r.a.toString(s),r.a.toString(l),b,p,u,h,d,m,_,j,P);if(e){const n=T&&T.CustomControlId?T.CustomControlId:null,r=Object(f.ab)(t,n);if(r&&T.Parameters[r]){const t=T.Parameters[r],n=e.Parameters[r];t.ViewId===n.ViewId&&t.VisualizationId===n.VisualizationId&&t.EntityName===n.EntityName&&t.HighchartFilterExpression===n.HighchartFilterExpression&&t.ChartDrillDownParameters===n.ChartDrillDownParameters&&t.ExtraFilters===n.ExtraFilters||(e=T)}}else e=T}else if(e&&c&&!l){const n=e.CustomControlId,r=Object(f.ab)(t,n);r&&e.Parameters[r]&&c!==e.Parameters[r].EntityName&&(e=null)}return e}}();return(n,r,i)=>{const a=t(n,r,i),s=r.id;return e&&e.configuration===a&&e.id===s||(e={configuration:a,id:s,chartId:y.d,showChart:!0,contextToken:i}),e}}(),Oe=function(){let e=null;return(t,n,r,i,a,s)=>{const o=s.commandBarStyle,c=n.id,l=se(t,n,r&&r.parentContextToken?r.parentContextToken.entityTypeName:null,r),u=Object(f.w)(t,c,r);return e&&e.commandManagerId===u&&e.pageId===c&&e.ribbonId===a&&e.relationshipType===l&&e.contextToken===r&&e.style===o||(e={commandManagerId:u,pageId:c,ribbonId:a,relationshipType:l,contextToken:r,style:o}),e}}(),_e=function(){let e=null;const t=oe();return(n,i,a,s,o,c)=>{var l;const d=c.viewSelectorStyle,h=r.a.toString(o),g=t(i),b=Object(f.nb)(i.id,h),y=re(i.contextString),S=y,v=i.contextString,C=Object(f.Z)(n),O=Object(p.g)(n),_=Object(f.qb)(n,o,i.id),I=_?_.title:null;let j=u.a.MAIN_APPLICATION_VIEW;ne(v)?j=u.a.SUB_GRID:y&&i.isAdvancedFindView&&(j=u.a.ADVANCED_SEARCH);const P=Object(m.a)(n,s,j),F=P||r.a.EMPTY,T=Object(R.g)(n,null==i?void 0:i.id),w=Object(f.rb)(n,null===(l=null==T?void 0:T.pageToEditedViewMapId)||void 0===l?void 0:l.guid,null==o?void 0:o.guid);return e&&e.id===b&&e.entityTypeName===s&&e.selectedViewId===h&&e.queryViewSelectorTypes===g&&e.shouldDisplayNestedViewSelector===S&&e.isRTL===O&&e.defaultViewId===F&&e.isEdited===!!w||(e={id:b,pageId:i.id,title:I,entityTypeName:s,selectedViewId:h,style:d,queryViewSelectorTypes:g,shouldDisplayNestedViewSelector:S,contextString:v,pinnedActivityView:C,isRTL:O,defaultViewId:F,isAdvancedFindView:i.isQueryMode&&i.isAdvancedFindView,isEdited:!!w,pageToEditedViewMapId:null==T?void 0:T.pageToEditedViewMapId}),e}}(),Ie=function(){let e=null;return(t,n,r,i,a)=>{const s=n.id,o=Object(f.G)(t,n),c=Object(p.w)(t),l=a.filterComboStyle,u=Object(R.g)(t,s).entityFilterValue;return e&&e.id===s&&e.entityTypeName===i&&e.filterOptions===o&&e.comboBoxStyle===l&&e.userSetting===c&&u===e.previousValue||(e={id:s,filterOptions:o,entityTypeName:i,updateFilterValue:null,onFilterChange:null,resourceStrings:null,userSetting:c,style:null,comboBoxStyle:l,previousValue:u}),e}}(),je=function(){let e=null;return(t,n,r,i,a)=>{const s=n.id,o=Object(f.G)(t,n,i),c=Object(Y.a)(t),l=a.filterComboStyle,u=a.dueDateComboBoxStyles,d=a.activityTypeComboBoxStyles,h=Object(D.h)(t,r.relationshipName,ie(n.contextString)),g=!Object(N.b)(t),m=Object(f.kb)(t,s,r),b=Object(p.g)(t),y=Object(P.a)(t),S=Object(R.g)(t,s),v=S.entityFilterValue,C=S.activityTypeFilterValue,O=Object(k.a)(t,A.a,A.h),I=Object(k.a)(t,A.a,A.Lc),j=Object(f.ub)(t,i),F=Object(k.c)(t,A.Zc),T=Object(L.a)(i,t.user.userId,r,F,j),w=T&&T.getFilterLabelResourceKey(),E=_.ACTIVITY_MGMT_ACTIVITY_TYPE_LABEL,x=_.ACTIVITY_MGMT_DUE_DATE_LABEL;if(!e||e.id!==s||e.entityTypeName!==i||e.filterOptions!==o||e.comboBoxStyle!==l||e.dueDatecomboBoxStyle!==u||e.activityTypecomboBoxStyle!==d||e.labelStyle!==a.filterLabelStyle||e.activityMgmtLabelStyle!==a.activityMgmtLabelStyle||e.isActivityManagementFeatureEnabled!==O||e.filterOptionsForActivityType!==c||e.isRollupViewSupported!==h||e.isOffline!==g||e.toggleValue!==m||e.isRTL!==b||e.theme!==y||e.previousValue!==v||e.activityTypePreviousValues!==C||e.isActivityFilterSelectAllEnabled!==I||e.entityIsActivityType!==j){const t={isRollupViewSupported:h,isOffline:g,toggleValue:m,onToggleChange:null,isRTL:b,theme:y};e=Object.assign({id:s,filterOptions:o,filterOptionsForActivityType:c,entityTypeName:i,onFilterChange:null,onActivityTypeChange:null,onActivityTypeFilterClear:null,gridEntityName:null,resourceStrings:null,comboBoxStyle:l,dueDatecomboBoxStyle:u,activityTypecomboBoxStyle:d,containerStyle:null,activityTypeContainerStyle:null,labelStyle:a.filterLabelStyle,activityMgmtLabelStyle:a.activityMgmtLabelStyle,previousValue:v,activityTypePreviousValues:C,isActivityManagementFeatureEnabled:O,activityViewContainerStyle:a.activityViewContainerStyle,entityFilterLabelResourceString:w,activityTypeFilterLabelResourceString:E,dueDateFilterLabelResourceString:x,isActivityFilterSelectAllEnabled:I,isRTL:b,entityIsActivityType:j},t)}return e}}(),Pe=function(){let e=null;const t=[1041,2052,3076,1028,1042];return(n,r,i,a,s,o)=>{const c=n.id,l=n.descriptor&&n.descriptor.Id?n.descriptor.Id:null,u=s?JSON.parse(s).conditions[0]:null,d=function(e,t){if(t=t?t.value.replace("%","").toUpperCase():null,e){const n=ge(e.split(",")[0]),r=n[1].split("|");if(r&&t===r[0])return n[1]}return t}(Object(g.c)(o,_.JUMPBAR_ALPHABET),u);return t.indexOf(a)>-1?e=null:e&&e.id===c&&e.contextToken===r&&e.entityTypeName===i&&e.selectedFilter===d||(e={id:c,uniqueId:l,contextToken:r,entityTypeName:i,selectedFilter:d,languageId:a}),e}}(),Fe=function(){let e=null;return(t,n,r,i)=>{const{id:a,contextString:s}=t;return e&&e.id===a&&e.contextToken===n&&e.entityTypeName===r&&e.gridInput===i||(e={id:a,contextToken:n,entityTypeName:r,contextString:s,gridInput:i}),e}}(),Te=function(){let e=null;return(t,n,r)=>{const{id:i,contextString:a}=t;return e&&e.id===i&&e.contextToken===n||(e={id:i,contextToken:n,contextString:a}),e}}(),we=Object(g.h)(),Ee=function(){let e=null,t=null;const n={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},r={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1};let s=null;const o={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},c={Type:"WholeNumber.None",Usage:1,Static:!0,Value:!1,Primary:!1},l={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},u={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},d={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},p={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},g={Type:"TwoOptions",Usage:1,Static:!0,Value:!1,Primary:!1},m={Type:"TwoOptions",Usage:1,Static:!0,Value:!1,Primary:!1};let b,y,S={useSkypeProtocol:n,gridPageNumber:r,isNewPageRequested:o,enhancedPagingDisabled:c,isActivityTypeFilterDisabled:l,showAddNewCommand:u,emptySubgridIconAndTextChanges:d,emptyGridChangesIfQuickFindImprovementsEnabled:p,headerDialogOnTop:g,headerDialogPreventDismissOnScroll:m};return(v,C,O)=>{const _=Object(F.e)(v),P=Object(h.x)(v).useSkypeProtocol,T=Object(f.x)(v,C.id,O),w=Object(f.X)(v,C.id,O);w||s===T||(s=T),b||(b=Object(I.a)(v),y=null!=b&&b===j.b.Native);const E=!y,x=Object(k.a)(v,A.a,A.h),{systemDefinedProperties:N}=C,M=T!==s&&w,D=E!==c.Value;let R=!1;x&&(ie(C.contextString)||re(C.contextString))&&(R=!0);let B=!1;Object(W.a)(v)&&ne(C.contextString)&&(B=!0);let L=!1;Object(W.a)(v)&&Object(k.c)(v,A.Md)&&ne(C.contextString)&&Object(F.a)(v)===a.a.MobileApplication&&(L=!0);let V=!1;if(Object(W.a)(v)&&Object(k.c)(v,A.ad)&&re(C.contextString)&&Object(F.a)(v)===a.a.MobileApplication){const e=Object(f.C)(v,C.id,O);(null==e?void 0:e.quickFind)&&(V=!0)}const z=!re(C.contextString)&&i.a.Tablet===_,H=i.a.Tablet===_&&!ie(C.contextString)||"Web"===Object(F.k)(v)&&!te.a.getInstance().get_IsAndroid()&&!te.a.getInstance().get_IsWindows()&&!te.a.getInstance().get_isIPhone();if(_!==e||P!==t||M||D||w!==o.Value||R!==l.Value||B!==u.Value||L!==d.Value||V!==p.Value||z!==g.Value||H!==m.Value){e=_,t=P,r.Value=T,s=T,o.Value=w,c.Value=E,l.Value=R,u.Value=B,d.Value=L,p.Value=V,g.Value=z,m.Value=H;const i=null==e?P:null;(i!==n.Value||M||D)&&(n.Value=i,S=Object.assign(Object.assign({},N),{useSkypeProtocol:n,gridPageNumber:r,isNewPageRequested:o,enhancedPagingDisabled:c,isActivityTypeFilterDisabled:l,showAddNewCommand:u,emptySubgridIconAndTextChanges:d,emptyGridChangesIfQuickFindImprovementsEnabled:p,headerDialogOnTop:g,headerDialogPreventDismissOnScroll:m}))}return S}}(),xe=function(){let e=null,t=null;return(n,r,i)=>(n&&(t&&e===n&&!i||(t=Object.assign({},n),n.Parameters&&(t.Parameters=Object.assign({},n.Parameters),r&&n.Parameters[r]&&(t.Parameters[r]=Object.assign({},n.Parameters[r]),n.Parameters[r].Columns&&(t.Parameters[r].Columns=n.Parameters[r].Columns.slice(0)))),e=n)),t)}(),Ne=Object(T.s)(),Ae=function(){const e=[];return(t,n,r,i,a,s,o,c,l,u,d)=>(e&&e.length&&e.splice(0,e.length),e.push({name:B.b.IsGridRoot,value:t},{name:B.b.IsSubGrid,value:n},{name:B.b.IsAssociatedGrid,value:r},{name:B.b.EntityName,value:i},{name:B.b.ViewId,value:a},{name:B.b.IsEmptyFetch,value:s},{name:B.b.IsEmptyOfflineSqlQuery,value:o},{name:B.b.IsValidFetchXmlForOfflineUsage,value:c},{name:B.b.IsEntityAvailableForOfflineUsage,value:l},{name:B.b.OfflineConfigurationErrorCode,value:u},{name:B.b.RelatedEntityUnavailableOffline,value:d}),e)}(),ke=function(){let e=null;return t=>(e||(e={isGridPaginationStateFeatureEnabled:Object(k.a)(t,A.zb),isAssociatedGridHeightEnabled:Object(D.e)(t),isChartOnAssociatedGridEnabled:Object(k.a)(t,A.x,A.h,A.i),isGridProgressIndicatorFeatureEnabled:Object(k.a)(t,A.Ab),isInMobileModeForOct2019:Object(W.b)(t),isJumpBarShouldHonorSortingFeatureEnabled:Object(k.a)(t,A.ac),isJumpbarFeatureForMobileEnabled:Object(k.c)(t,A.Kb),isSuiterChartEnabled:Object(k.a)(t,A.Od,A.h),isSuiterDashboardEnabled:Object(k.a)(t,A.Pd,A.h),isAdvancedFindEnabled:Object(Q.a)(t),isDisableEditableGridControlOnPhoneFeatureEnabled:Object(k.c)(t,A.O),isInMobileModeForApril2020:Object(W.a)(t),isSubgridImprovementsEnabled:Object(k.c)(t,A.Md),isSubGridAutoCollapseEnabled:Object(k.a)(t,A.Jd,A.Lc),isSubGridRemoveMinHeightEnabled:Object(k.a)(t,A.Ld,A.Lc),isQuickFindImprovementsEnabled:Object(k.c)(t,A.ad),isShowAsButtonFirstEnabled:Object(k.c)(t,A.Bd),isColumnEditorButtonEnabled:Object(f.tb)(t),isQueueFilterPerfUCIEnabled:Object(k.c)(t,A.Zc)}),e)}(),Me=function(){let e={fetchXML:null,entityName:null,isOffline:null},t={error:!1,errorCode:null,relatedEntityUnavailableOffline:null};return function(n,r,i,a){if(e.entityName!==i||e.fetchXML!==r||e.isOffline!==a)if(Object(x.k)(i)){const s=Object(x.b)(n,r);t={error:s.error,errorCode:s.error?_.LINKED_ENTITY_NOT_SUPPORTED:null,relatedEntityUnavailableOffline:s.relatedEntityUnavailableOffline},e={fetchXML:r,entityName:i,isOffline:a}}else t={error:!0,errorCode:_.ACTIVITY_ENTITY_NOT_SUPPORTED_OFFLINE},e={fetchXML:r,entityName:i,isOffline:a};return t}}();return function(i,a){var o;const l=Object(p.w)(i),b=ve(i,a),v=Object(f.v)(i,a.id,b),O=b.relationshipName,T=b.roleOrd,B=Object(f.N)(i,a.id,b),W=Object(f.I)(i,a.id,b),Y=Object(f.x)(i,a.id,b),Q=a.descriptor,te=be.bind(null,a,Q),se=a.configuration,oe=se&&se.CustomControlId?se.CustomControlId:null,ge=Object(I.a)(i),De=Object(F.e)(i),Re=Object(f.ab)(i,oe)||(a.contextString===y.h.CUSTOM?y.g:null),Be=re(a.contextString),Le=ke(i),Ve=Object(f.A)(i,b,a);let ze=null,He=!1,Ge=null;const We=Object(f.t)(i,a.id,b),Ue=Object(f.C)(i,a.id,b);Be&&(ze=Object(R.g)(i,a.id),Le.isGridPaginationStateFeatureEnabled&&(Ge=ze.gridSortingInfo,Ge&&(Object(w.a)(le)||le!==Ge)&&(le=Ge,He=!0),We&&(Object(w.a)(ue)||ue!==We.customFilterXml)&&(ue=We.customFilterXml,He=!0)),(Ue&&Object(w.a)(de)||de!==Ue)&&(de=Ue,He=!0));const qe=xe(se,Re,He),Xe=qe&&qe.Parameters?qe.Parameters[Re]:null,Ye=ie(a.contextString),Ke=ne(a.contextString),Qe=!Object(N.b)(i),Ze=Object(f.jb)(i,b,a),Je=Xe&&!!Xe.DataProvider,$e=Xe&&!!Xe.BoundViewParams,et=Object(h.x)(i),tt=et&&et.gridTotalRecordCountLimit?et.gridTotalRecordCountLimit:5e3,nt=Object(f.ib)(i,a.id,b),rt=ce(a.configuration),it=ce(a.configuration);if(null!=a.nonCompositionProps){const e=se&&se.FormFactor&&se.FormFactor.toString(),t=Object(M.c)(a.nonCompositionProps.gridConfigurations,a.nonCompositionProps.viewConfigurations,se,null,y.h.GRID,e).map(e=>e.configuration.DisplayNameKey),n=we(i,t);(!q&&""!==Object(g.c)(n,t[0])||q!==n)&&(q=n)}let at=!!v;let st=Object(f.T)(i,a.id,b)||(Q&&Q.Parameters&&Q.Parameters.ViewId?r.a.parse(Q.Parameters.ViewId):null);const ot=Object(f.qb)(i,st,a.id),ct=(null==ot?void 0:ot.isUserView)?u.b.userview:u.b.savedview,lt=null==ot?void 0:ot.queryType,ut=null==ot?void 0:ot.entityLogicalName;ut&&ut!==c&&(c=ut);const dt=Object(d.h)(i,c),pt=!Qe&&ge===j.b.Web&&Be&&Le.isAdvancedFindEnabled&&(null==dt?void 0:dt.IsValidForAdvancedFind);if(!U||e!==pt){let t=[..._.labelList];pt&&(t=[...t,K.c.OpenAdvancedFiltersTitleAndAria]);const n=we(i,t);""!==Object(g.c)(n,_.JUMPBAR_ALL_TITLE)?(U=n,e=pt):at=!1}const ht=Object(f.W)(i,oe);ht&&ht!==V&&(V=ht);const gt=Se(i,a);ce(a.configuration)&&(Object.assign(gt.bodyStyle,{flexDirection:"column"}),Object.assign(gt.bodyMobileStyle,{flexDirection:"column"}));let mt=Object(f.F)(i,a.id,b)||(Q&&Q.Parameters&&Q.Parameters[y.u]?Q.Parameters[y.u]:null),bt=mt;Be&&(bt=ze.entityTypeName);const yt=Object(E.b)(i,mt);dt&&dt.Initialized===s.a.Initialized||Je||$e||(at=!1);const ft=dt?dt.DisplayName:"",St=Object(h.t)(i),vt=Object(d.i)(i,mt),Ct=!(ot&&ot.fetchXML),Ot=ot&&ot.viewId,_t=Me(i,Ct?"":ot.fetchXML,c,Qe),It=!Ct&&!_t.error,jt=null!=ot&&Object(w.b)(ot.offlineSqlQuery),Pt=Object(x.l)(i,c),Ft=Ae(Be,Ke,Ye,c,Ot?Ot.guid:null,Ct,jt,It,Pt,_t.error&&_t.errorCode||"",_t.error&&_t.relatedEntityUnavailableOffline||""),Tt=!((Be||Ye||Ke)&&ot&&ot.fetchXML&&Qe&&Pt)||!jt&&It;let wt="";if(Tt?Pt||(wt=_.ENTITY_NOT_AVAILABLE_IN_PROFILE):jt?wt=_.SQL_QUERY_NOT_AVAILABLE:_t.error&&(wt=_t.errorCode),Xe){Xe.TargetEntityType&&mt!==Xe.TargetEntityType&&(mt=Xe.TargetEntityType),Xe.ExtraFilters=pe(i,a,b,Ue,!1);const e=function(e,t,n,r,i){let a=[];const s=Object(f.q)(e,t.id,n);if(s){const e=JSON.parse(s);if(e.conditions)for(const t of e.conditions)t.linkEntityExpressions&&(a=a.concat(t.linkEntityExpressions))}const o=e.user&&e.user.userId,c=Object(k.c)(e,A.Zc),l=Object(f.ub)(e,r),u=Object(L.a)(r,o,n,c,l);let d=u&&u.getFilterAndLinkedEntities(i&&void 0!==i.activityOrQueueFilterValue?i.activityOrQueueFilterValue:z.a,i&&!i.activityOrQueue);d&&d.linkEntities&&(a=a.concat(d.linkEntities));return d=d||{filter:null,linkEntities:null},d.linkEntities=a,d}(i,a,b,mt,Ue);if(e&&e.filter&&(Xe.ExtraFilters?Xe.ExtraFilters.push(JSON.stringify(e.filter)):Xe.ExtraFilters=[JSON.stringify(e.filter)]),e&&e.linkEntities&&e.linkEntities.length>0){let t={Static:!0,Value:Object(H.b)(e.linkEntities)};if(Xe.LinkingInput){t=Xe.LinkingInput;const n=Object(H.a)(Xe.LinkingInput.Value);if(n){const r=new G.a;n.forEach(e=>{r.addLinkedEntity(e)}),e.linkEntities.forEach(e=>{r.addLinkedEntity(e)}),t.Value=Object(H.b)(r.getLinkedEntities())}}Xe.LinkingInput=t}if(st){const e=r.a.toString(st);e!==Xe.ViewId&&(Xe.ViewId=e)}else st=r.a.tryParseOrNull(Xe.ViewId);(Q&&Q.Parameters?"false"===Q.Parameters[y.F.ENABLE_CONTEXTUALACTIONS]:null)&&(qe.Parameters[y.i]={Usage:1,Static:!0,Type:"Enum",Value:!1,Primary:!1})}mt&&mt!==S&&(S=mt);const Et=Object(d.r)(i,mt)&&a.contextString===y.h.GRID?f.a:mt,xt=Xe&&Xe.CommandBarContext,Nt=fe(i,a,Et,xt),At=function(e,t,n){const r=Object(f.qb)(e,t,n);return r&&r.grid&&r.grid.rows&&r.grid.rows[0]&&r.grid.rows[0].cells}(i,st,a.id),kt=null==At?void 0:At.map(e=>e.name),Mt=null==n?void 0:n.map(e=>e.name);(JSON.stringify(kt)!==JSON.stringify(Mt)||(st&&st.guid)!==(t&&t.guid)||O===he&&T!==ye)&&(t=st,ye=T,C=(Q&&Q.Id?Q.Id:"")+(new Date).getTime(),n=At),O&&O!==he&&(he=O);const Dt=Object(f.o)(i,mt),Rt=Dt?Dt.lookupAttribute:null;Xe&&(function(e,t,n,r,i,a,s){const o=Object(d.h)(e,r);if(o&&ce(t.configuration)){const c=y.b;n.Columns||(n.Columns=[]),r!==f.a||i&&i.some(e=>e.name===c)||n.Columns.find(e=>e.Name===c)||n.Columns.push({Alias:c,DataType:"",Type:"",Name:c});const l=o&&o.PrimaryNameAttribute,u=i&&i.some(e=>e.name===l);if(!l||u||n.Columns.some(e=>e.Name===l)||n.Columns.push({Alias:l,DataType:"",Type:"",Name:l}),!Object(f.vb)(t.configuration.Parameters)){const t=Object(D.a)(o.PrimaryImageAttribute);t&&!n.Columns.find(e=>e.Name===t)&&n.Columns.push({Alias:X.d,DataType:"SingleLine.Text",Type:"",Name:t}),Object(k.a)(e,A.ub)&&a&&s&&(n.Columns.find(e=>e.Name===f.c)||n.Columns.push({Alias:f.c,DataType:"Whole.None",Type:"",Name:f.c,PreventMetadataRequest:!0}),n.Columns.find(e=>e.Name===a)||n.Columns.push({Alias:a,DataType:"Lookup.Simple",Type:"",Name:a}))}}}(i,a,Xe,mt,n,Rt,!Object(w.a)(ze)),function(e,t,n,r,i){if(!Object(f.vb)(t.configuration.Parameters))return;(null==i?void 0:i.some(t=>{var n;return(null===(n=Object(J.a)(e,r,t.name))||void 0===n?void 0:n.Type)===$.a.moneyType}))&&(n.Columns.some(e=>e.Alias===y.A)||n.Columns.push({Alias:y.A,DataType:"Lookup.Simple",Type:"",Name:X.w}))}(i,a,Xe,mt,n));const Bt=!mt||(Object(E.i)(mt)||Object(E.g)(i,mt,2,0)&&function(e,t){let n=!0;t&&t.forEach(t=>{if(t.relatedEntityName&&(n=Object(E.g)(e,t.relatedEntityName,2,0),!n))return!1});return n}(i,n)),Lt=Object(f.Y)(i,a.id,b),Vt=Lt?JSON.parse(Lt):null,zt=Vt?Vt.totalResultCount:null,Ht=Vt?Vt.pageSize:null,Gt=null!==zt&&zt>-1?0===zt?Object(g.c)(U,_.NO_DATA_AVAILABLE):String.format(_.X_RECORDS_PRESENT,zt):"",Wt=Ne(i,Be),Ut=!(null!=ge&&ge===j.b.Native),qt=Object(f.rb)(i,null===(o=null==ze?void 0:ze.pageToEditedViewMapId)||void 0===o?void 0:o.guid,null==st?void 0:st.guid),Xt={isEmptyOfflineSqlQuery:jt,isEntityAvailableForOffline:Pt,isOfflineSqlQueryAvailable:Tt,offlineErrorMessageKey:wt,isOfflineAvailableForUse:Object(Z.w)(i),offlineGridErrorTelemetryParams:Ft},Yt=Object(ee.d)(i),Kt=Object(m.c)(i,t),Qt=!Qe&&ge===j.b.Web&&Be&&Le.isColumnEditorButtonEnabled&&!Ye&&!Ke,Zt=Object(f.ub)(i,mt);return{showAdvancedFilter:pt,isViewEdited:!!qt,isInitialized:at,viewId:t,customFilter:We,gridEntityTypeName:c,chartEntityTypeName:c,isUCIEntity:yt,totalRecordCountLimitExceeded:Ze,chartProps:nt?Ce(i,a,b):null,viewDescriptor:ot,commandBarProps:te(y.E.COMMANDBAR_ENABLED,!0,y.F.ENABLE_CONTEXTUALACTIONS,Re,!0)?Oe(i,a,b,Q,Nt,gt):null,viewSelectorProps:bt&&te(y.E.VIEWSELECTOR_ENABLED,!0,y.F.ENABLE_VIEW_PICKER,Re)?_e(i,a,b,bt,t,gt):null,queueFilterProps:se&&te(null,!0,y.F.ENABLE_QUEUEFILTER,Re)?Ie(i,a,b,mt,gt):null,entityFilterProps:Qe||!Zt&&!Object(D.h)(i,he,Ye)?null:je(i,a,b,mt,gt),jumpBarProps:te(y.E.JUMPBAR_ENABLED,rt,y.F.ENABLE_JUMPBAR,Re)&&me(a)?Pe(a,b,mt,l.languageId,Ue?Ue.jumpBar:null,U):null,quickFindProps:te(y.E.QUICKFIND_ENABLED,!0,y.F.ENABLE_QUICKFIND,Re)?Fe(a,b,mt,ze):null,pagingProps:te(y.E.PAGING_ENABLED,it,null,Re)?Te(a,b,mt):null,contextToken:b,controlKey:C,styles:gt,refreshCounter:B,pagingRefreshInput:W,pageNumber:Y,ribbonId:Nt,semanticTag:ae(a.contextString),recordsPerPageSetting:Object(p.h)(i),userSetting:l,hasReadRolePrivilege:Bt,resourceStrings:U,switchVisualizationResourceStrings:q,entityTypeName:S,primaryDataSetName:Re,nestedGridDatasetName:V,viewportSm:Object(P.a)(i).sizes.Breakpoints.DimensionS,viewportM:Object(P.a)(i).sizes.Breakpoints.DimensionM,systemDefinedProperties:Ee(i,a,b),platformType:Object(I.a)(i),isGridEditable:Object(f.vb)(se?se.Parameters:null),notificationMessage:Gt,totalResultCount:zt,pageSize:Ht,offlineProps:Xt,isRTL:Object(p.g)(i),entityDisplayName:ft,isOffline:Qe,showChart:nt,entityIconVectorName:vt,webResourceUrl:St,hasCustomDataProvider:Je,commandBarRefreshProps:Wt,updatedConfiguration:qe,offlineGridErrorTelemetryParams:Ft,gridInput:ze,gridTotalRecordsCountLimit:tt,gridSortingInfo:Ge,nativeFilterExpression:Le.isGridPaginationStateFeatureEnabled&&ze?ze.nativeFilterExpression:null,pageNumberForEnhancedPaging:Le.isGridPaginationStateFeatureEnabled&&!Ut&&ze?ze.gridPageNumber:null,userId:i.user&&i.user.userId||null,lookupAttributeForRecordHierarchy:Rt,fetchXML:Ve,viewType:ct,savedQueryType:lt,featureControlProps:Le,clientHostSubtype:De,backButtonEnabled:Yt,originalView:Kt,showColumnEditor:Qt,entityIsActivityType:Zt}}}function pe(e,t,n,r,i){if(!r)return[];const a=re(t.contextString),s=ie(t.contextString),o=ne(t.contextString)&&Object(k.c)(e,A.bd),c=[];for(const e in r)c.push([e,r[e]]);const l=c.reduce((e,[t,n])=>((a||s||o)&&"quickFind"===t||("activityOrQueueFilterValue"===t||"activityTypeSelectedValues"===t)||!n||e.push(n),e),[]);if(i){const r=Object(f.t)(e,t.id,n);if(r&&r.customFilterXml){const e=Object(V.i)(r.customFilterXml),t=JSON.stringify(e);t&&l.push(t)}}else{const r=Object(f.q)(e,t.id,n);r&&l.push(r)}return l}function he(e){let t=e.configuration&&"MscrmControls.SharepointAssociatedGrid.SharepointControl"===e.configuration.CustomControlId;return t||(t=e.configuration&&"MscrmControls.SharepointAssociatedGrid.SharepointControl"===e.configuration.Name),t}function ge(e){if(!e&&"("!==e[0]||")"!==e[e.length-1])throw new Error(String.format("Resource string group must be in the format (A:a).  The format {0} is invalid.",e));const t=(e=(e=e.replace("(","")).replace(")","")).split(":");if(2!==t.length)throw new Error("Resource string group must have a search list defined.  E.g : (A:a).");return t}function me(e){var t,n,r;return"no"!==(null===(r=null===(n=null===(t=e.configuration)||void 0===t?void 0:t.Parameters)||void 0===n?void 0:n.EnableJumpBar)||void 0===r?void 0:r.Value)}function be(e,t,n,r,i,a,s){let o=e.dataSetUIOptions,c=r;if(s=!!Object(w.a)(s)||s,!o&&e.configuration&&e.configuration.Parameters){const t=e.configuration.Parameters[a];t&&t[y.f]&&(o=t[y.f])}const l=t&&t.Parameters&&t.Parameters[i]?"true"===t.Parameters[i]:s;return o&&n&&!Object(w.a)(o[n])&&(c=o[n]),c&&l}},kQA8:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("TBkx"),i=n("YxC/"),a=n("69Qu"),s=n("Nzmy"),o=n("EY5k"),c=n("si7p"),l=n("pgSX");function u(e,t){return{type:"offline.alert.dialog.async",execute({dispatch:n,getState:u},d){if(Object(a.b)(u()))return s.c.info("Offline: Server is available"),Promise.resolve();const p=["Dialog_Button_Ok",e];return n(Object(o.e)(p)).then(()=>{const a=Object(i.b)(u(),"Dialog_Button_Ok"),o=Object(i.b)(u(),e);return n(Object(l.a)(c.a,o,null,a,null,void 0,void 0,void 0,void 0,void 0,t)).then(e=>0===e.status?(s.c.info("Offline: Alert dialog is created successfully with message "+o),Promise.resolve()):(s.c.error("Offline: Error in Sync error dialog creation "+Object(r.e)(e.error)),Promise.reject(e.error)))}).catch(e=>(s.c.error("Offline: Error in alert dialog creation "+Object(r.e)(e)),Promise.reject(e)))}}}},kt5S:function(e,t,n){"use strict";n.d(t,"g",(function(){return S})),n.d(t,"i",(function(){return v})),n.d(t,"h",(function(){return C})),n.d(t,"e",(function(){return O})),n.d(t,"f",(function(){return _})),n.d(t,"a",(function(){return I})),n.d(t,"c",(function(){return P})),n.d(t,"b",(function(){return T})),n.d(t,"d",(function(){return j}));var r=n("BFlg"),i=n("P6DH"),a=n("arV0");function s(e,t,n,r){return{type:"update.grid.configuration",payload:{[t]:{[n]:e}},meta:{pageId:r}}}function o(e,t,n){return{type:"update.views.configuration",payload:{[t]:e},meta:{pageId:n}}}var c=n("oOvK"),l=n("9fGf"),u=n("Z/4N"),d=n("y60j"),p=n("SAYH"),h=n("KBcj"),g=n("S2mk"),m=n("5ZBI"),b=n("j6Db"),y=n("zmL5");function f(e,t){const n=Object.assign({},e.CustomControls);if(e.CustomControls[t]&&!e.CustomControls[t].isDefaultConfig){let r=!1;for(const n in e.CustomControls)if(I(e.CustomControls[n],e.CustomControls[t])&&n!==t.toString()){r=!0;break}if(!r){let r=-1;n[r]?r--:n[r.toString()]=e.CustomControls[t]}}return n[t]=null,n}function S(e,t,n,r,u){return{type:"customcontrol.changevisualization.homepage",sync:!0,execute({dispatch:d,getState:p},h){const g=p(),y=Object(l.b)(g),f=Object(i.k)(g,e,t),S={UniqueId:f?f.UniqueId:null,CustomControls:{[y]:Object.assign(Object.assign({},n),{FormFactor:y})},FormLibraries:f?f.FormLibraries:null,EventHandlers:f?f.EventHandlers:null},{entityTypeName:v}=Object(a.g)(g,e);if(u){const n=Object(i.T)(g,e,t);d(o({UniqueId:null,CustomControls:{[y]:null},FormLibraries:null,EventHandlers:null},n.guid,e))}d(Object(c.c)(n.CustomControlId)).then(()=>{d(s(S,v,r,e))},t=>{const i=Object(m.b)(p(),n.CustomControlId);h.EventManager.ReportComponentFailure(i+".CustomControl.retrieveControlManifest",t,"retrieveControlManifest failure error message",[{name:"APIName",value:b.a+".Actions.SwitchVisualization"},{name:"entityTypeName",value:v},{name:"customControlId",value:n.CustomControlId},{name:"pageId",value:e},{name:"controlId",value:r},{name:"config",value:JSON.stringify(n)}])})}}}function v(e,t,n,r,u){return{type:"customcontrol.changevisualization.homepage",sync:!0,execute({dispatch:d,getState:p}){const g=p(),m=Object(l.b)(g),b=Object(i.T)(g,e,t),y=Object(h.d)(g,b),S={UniqueId:y?y.UniqueId:null,CustomControls:{[m]:Object.assign(Object.assign({},n),{FormFactor:m})},FormLibraries:y?y.FormLibraries:null,EventHandlers:y?y.EventHandlers:null},{entityTypeName:v}=Object(a.g)(g,e);if(u){const n=Object(i.k)(g,e,t);if(n&&n.CustomControls&&n.CustomControls[m]){const t={UniqueId:n.UniqueId,CustomControls:f(n,m),FormLibraries:n.FormLibraries,EventHandlers:n.EventHandlers};d(s(t,v,r,e))}}d(Object(c.c)(n.CustomControlId)).then(()=>{d(o(S,b.guid,e))})}}}function C(e,t,n){return{type:"customcontrol.changevisualization.subgrid",sync:!0,execute({dispatch:r,getState:i}){const a=i(),o=Object(l.b)(a),p=Object(y.b)(a,e),h=Object(d.b)(a,e,p,n),g=Object(u.b)(a,h.UniqueId,p);if(!g||!g.CustomControls)return;const m={UniqueId:h.UniqueId,CustomControls:{[o]:Object.assign(Object.assign({},t),{FormFactor:o})},FormLibraries:g.FormLibraries,EventHandlers:g.EventHandlers};r(Object(c.c)(t.CustomControlId)).then(()=>{r(s(m,p.guid,g.UniqueId,e))})}}}function O(e,t,n,r,i){return{type:"customcontrol.changevisualization.associatedgrid.grid",sync:!0,execute({dispatch:a,getState:o}){const u=o(),d=Object(l.b)(u),p={UniqueId:i.UniqueId,CustomControls:{[d]:Object.assign(Object.assign({},r),{FormFactor:d})},FormLibraries:i.FormLibraries,EventHandlers:i.EventHandlers};a(Object(c.c)(r.CustomControlId)).then(()=>{a(s(p,t,n,e))})}}}function _(e,t,n,r,i,a,u){return{type:"customcontrol.changevisualization.associatedgrid.view",sync:!0,execute({dispatch:d,getState:p}){const h=p(),g=Object(l.b)(h),m={UniqueId:a.UniqueId,CustomControls:{[g]:Object.assign(Object.assign({},i),{FormFactor:g})},FormLibraries:a.FormLibraries,EventHandlers:a.EventHandlers};if(u&&u.CustomControls&&u.CustomControls[g]){const r={UniqueId:u.UniqueId,CustomControls:f(u,g),FormLibraries:u.FormLibraries,EventHandlers:u.EventHandlers};d(s(r,t,n,e))}d(Object(c.c)(i.CustomControlId)).then(()=>{d(o(m,r.guid,e))})}}}function I(e,t){if(e&&t){let n=!!e==!!t&&e.CustomControlId===t.CustomControlId&&e.Name===t.Name&&e.ShouldOverrideControlVisible===t.ShouldOverrideControlVisible&&e.Version===t.Version&&e.isDefaultConfig===t.isDefaultConfig&&function e(t,n){var r,i;if(t&&n&&t!==n){if(t instanceof Array&&n instanceof Array&&t.length!==n.length)return!1;for(const a in t)if(t[a]!==n[a]){if("function"==typeof t[a])continue;if(t[a]&&n[a]&&"object"==typeof t[a]&&"object"==typeof n[a]){if(e(t[a],n[a]))continue;return!1}if("EnableViewPicker"===a)return(null===(r=t[a])||void 0===r?void 0:r.toString())===(null===(i=n[a])||void 0===i?void 0:i.toString());if("ExtraFilters"!==a&&"PagingInput"!==a&&"FilteringInput"!==a&&"RefreshInput"!==a&&"ViewId"!==a&&"EntityName"!==a&&"LinkingInput"!==a&&"FirstDataRequestType"!==a&&"NativeFilterExpressionToRestore"!==a&&"LookupAttributeNameForHierarchy"!==a&&"SortingInput"!==a&&"function"!=typeof t[a])return!1}}return!0}(e.Parameters,t.Parameters);if(e.Children&&t.Children){if(Object.keys(e.Children).length===Object.keys(t.Children).length){for(const r in e.Children)n=n&&I(e.Children[r],t.Children[r]);return n}return!1}return n&&e.Children===t.Children}return!!e==!!t}function j(e,t,n,r,i,a,s,o){const c=t?t.TraceManager.getTracer("customcontrol"):null;return e(P(n,r,a.configuration,a,a.contextString,o).map(e=>e.configuration.DisplayNameKey)).catch(e=>(c&&c.info("Resource retrieve failed: "+e.message),Promise.resolve()))}function P(e,t,n,i,a,s){const o=[];if(null==s)return o;if(a===r.h.CUSTOM&&i.configuration.isDefaultConfig)return o;const c=a===r.h.GRID||a===r.h.ASSOCIATEDGRID?Object(g.u)(i&&i.controlId,i&&i.gridEntityTypeName,i&&p.a.toString(i.viewId)):Object(g.x)(i&&i.controlId,i&&i.descriptor.Parameters);return o.push({configuration:c,formFactor:s,configurationType:null}),e&&e.CustomControls&&F(o,e,"GRID_CONFIG"),t&&t.CustomControls&&F(o,t,"VIEW_CONFIG"),o}function F(e,t,n){for(const r in t.CustomControls)if(t.CustomControls[r]&&!t.CustomControls[r].isDefaultConfig){let i=!1;for(let n=0;n<e.length;n++)if(I(e[n].configuration,t.CustomControls[r])){i=!0;break}i||e.push({configuration:t.CustomControls[r],formFactor:r,configurationType:n})}}function T(e,t){return null!=t.DisplayNameKey?null!=e&&null!=e[t.DisplayNameKey]?e[t.DisplayNameKey]:t.DisplayNameKey:"Grid"}},lEp6:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){let t=null;try{t=JSON.parse(e)}catch(e){}return t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e){let t="";try{t=JSON.stringify(e)}catch(e){}return t}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}))},"lIi+":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("WLAV"),i=n("ruPX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function a(e,t,n,a,s,o,c,l){const u={powerBIEmbedUrl:t,powerBIGroupId:n,powerBIDashboardId:a,powerBITileId:s,powerBIReportId:o,powerBIReportUrl:c,powerBIComponentTypeCode:l};return Object(i.a)(r.a,u,e,{target:"dialog"})}},lSDC:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var r=n("Lyxw"),i=n("3/02"),a=n("arV0"),s=n("zu1I"),o=n("Nb1E"),c=n("odYE");var l=n("YxC/"),u=n("69Qu");function d(e,t,n,d,p){const m=Object(r.a)(e.getState(),i.F)&&Object(u.b)(e.getState()),b=Object(a.g)(e.getState(),n);if(m&&b&&"connectionrole"===b.entityTypeName&&b.id){return{Icon:"ConnectionRoleManageRecordType",DisplayText:Object(l.c)(p,h),Tooltip:{title:Object(l.c)(p,g),description:Object(l.c)(p,g)},Id:"manageRecordTypes",execute:()=>{return t=e.dispatch,r=b.id,t(function(e,t){return{type:"open.manage.resource.type.dialog",execute({dispatch:n,getState:r},i,a){const l=new c.a("connectionrole",e),u=[{name:"recordId",value:e.guid}];return n(Object(o.d)(l,"?$expand=connection_role_connection_role_object_type_codes")).then(r=>{if(r&&r.connection_role_connection_role_object_type_codes){const a=r.connection_role_connection_role_object_type_codes,o=[],c=r.statecode;a.map(e=>{o.push({LogicalName:e.associatedobjecttypecode,connectionroleobjecttypecodeid:e.connectionroleobjecttypecodeid})});const l={param_recordId:e,param_selectedEntities:JSON.stringify(o),param_stateCode:c},d={height:480,width:320};return n(Object(s.b)("ConnectionRoleManageRecordTypesDialog",d,l,t)).then(e=>{i.EventManager.ReportComponentSuccess("ConnectionRoleManageRecordTypesDialog",u)})}},e=>{i.EventManager.ReportComponentFailure("ConnectionRoleManageRecordTypesDialog",e,null,u)})}}}(r,n)).then(()=>({}));var t,r}}}return null}function p(e,t){const n=Object(r.a)(e,i.F)&&Object(u.b)(e),s=Object(a.g)(e,t);return n&&s&&"connectionrole"===s.entityTypeName?m:[]}const h="ConnectionRole_EntityPickerMDD_Button_Label",g="ConnectionRole_EntityPickerMDD_Button_Description",m=[h,g]},ldWj:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n("0nOn"),i=n("ScMg"),a=n("i1f0"),s=n("Sbn7"),o=n("16wZ"),c=n("vlcQ"),l=n("3MuQ"),u=n("qshH"),d=n("ZIjf"),p=n("IaGr");let h;class g extends i.a{constructor(e,t,n,i,a,s){super(e,t,n,i),this._parent=a,h=e,this._formContext=s,this._iConnectedSectionProp={sectionName:this.name,id:this.pageId},this._clientApiExecutorTabSection=new r.a(e,"ClientApi.XrmTabSection.",n,t),this.clientApiExecutor.addEventParameter({name:"controlName",value:i,isEventParam:!0})}get clientApiExecutor(){return this._clientApiExecutorTabSection}get controls(){return this.clientApiExecutor.execute("controls",(e,t)=>{if(!this._controls){const n=h.getState();this._controls=new s.a(e);const r=this.getControlsDescriptor(n);if(!r)return this._controls;for(const n in r){const r=this._formContext.ui.controls.get(n);if(r)this._controls.add(r.getName(),r);else{const r=t.slice();r.push({name:"controlKey",value:n}),p.a.getInstance().traceManager.getTracer(e).warn("Section control was not found in the form controls collection",r)}}}return this._controls})}getParent(){return d.a.instance.reportUsage("ClientApi.XrmTabSection.getParent"),this._parent}getVisible(){const e="ClientApi.XrmTabSection.getVisible";try{d.a.instance.reportCall(e);const t=Object(a.tc)(h.getState(),this._iConnectedSectionProp,this.contextToken),n=Object(o.a)(t)?this._getSectionDescriptorValues().Visible:t;return d.a.instance.reportSuccess(e),n}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(e,t,null,n),t}}getLabel(){const e="ClientApi.XrmTabSection.getLabel";try{d.a.instance.reportCall(e);const t=Object(a.rc)(h.getState(),this._iConnectedSectionProp,this.contextToken),n=Object(o.a)(t)?this._getSectionDescriptorValues().Label?this._getSectionDescriptorValues().Label:"":t;return d.a.instance.reportSuccess(e),n}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(e,t,null,n),t}}_getSectionDescriptorValues(){try{return Object(a.qc)(h.getState(),this._iConnectedSectionProp,this.contextToken)}catch(e){const t=u.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure("ClientApi.XrmTabSection._getSectionDescriptorValues",e,null,t),e}}getControlsDescriptor(e){try{return Object(a.H)(e,this._iConnectedSectionProp,this.contextToken)}catch(e){const t=u.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure("ClientApi.XrmTabSection.getControlsDescriptor",e,null,t),e}}setVisible(e){const t="ClientApi.XrmTabSection.setVisible";try{d.a.instance.reportCall(t),h.dispatch(Object(c.b)(this.pageId,this.contextToken,this.name,!0===e)),d.a.instance.reportSuccess(t)}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(t,e,null,n),e}}setLabel(e){const t="ClientApi.XrmTabSection.setLabel";Object(o.a)(e)&&Object(o.j)(t,"label");try{d.a.instance.reportCall(t),h.dispatch(Object(l.b)(this.pageId,this.contextToken,this.name,e)),d.a.instance.reportSuccess(t)}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(t,e,null,n),e}}}},lhDp:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var r=n("c/eZ"),i=n("7JDo"),a=n("So1i");function s(e){var t,n,a,s,o,c=e.semanticColors,l=e.palette,u=c.buttonBackground,d=c.buttonBackgroundPressed,p=c.buttonBackgroundHovered,h=c.buttonText,g=c.buttonTextHovered,m=c.buttonTextChecked,b=c.buttonTextCheckedHovered;return{root:{backgroundColor:u,color:h},rootHovered:{backgroundColor:p,color:g,selectors:(t={},t[i.b]={borderColor:"Highlight",color:"Highlight"},t)},rootPressed:{backgroundColor:d,color:m},rootExpanded:{backgroundColor:d,color:m},rootChecked:{backgroundColor:d,color:m},rootCheckedHovered:{backgroundColor:d,color:b},rootDisabled:{selectors:(n={},n[i.b]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},n)},splitButtonContainer:{selectors:(a={},a[i.b]={border:"none"},a)},splitButtonMenuButton:{color:l.white,backgroundColor:"transparent",selectors:{":hover":{backgroundColor:l.neutralLight,selectors:(s={},s[i.b]={color:"Highlight"},s)}}},splitButtonMenuButtonDisabled:{backgroundColor:c.buttonBackgroundDisabled,selectors:{":hover":{backgroundColor:c.buttonBackgroundDisabled}}},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},{position:"absolute",width:1,right:31,top:8,bottom:8}),{backgroundColor:l.neutralTertiaryAlt,selectors:(o={},o[i.b]={backgroundColor:"WindowText"},o)}),splitButtonDividerDisabled:{backgroundColor:e.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:l.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:l.neutralQuaternaryAlt}}},splitButtonMenuButtonExpanded:{backgroundColor:l.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:l.neutralQuaternaryAlt}}},splitButtonMenuIcon:{color:c.buttonText},splitButtonMenuIconDisabled:{color:c.buttonTextDisabled}}}function o(e){var t,n,s,o,c,l,u,d,p,h=e.palette,g=e.semanticColors;return{root:{backgroundColor:g.primaryButtonBackground,border:"1px solid "+g.primaryButtonBackground,color:g.primaryButtonText,selectors:(t={},t[i.b]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},t["."+a.a+" &:focus"]={selectors:{":after":{border:"none",outlineColor:h.white}}},t)},rootHovered:{backgroundColor:g.primaryButtonBackgroundHovered,border:"1px solid "+g.primaryButtonBackgroundHovered,color:g.primaryButtonTextHovered,selectors:(n={},n[i.b]={color:"Window",backgroundColor:"Highlight",borderColor:"Highlight"},n)},rootPressed:{backgroundColor:g.primaryButtonBackgroundPressed,border:"1px solid "+g.primaryButtonBackgroundPressed,color:g.primaryButtonTextPressed,selectors:(s={},s[i.b]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},s)},rootExpanded:{backgroundColor:g.primaryButtonBackgroundPressed,color:g.primaryButtonTextPressed},rootChecked:{backgroundColor:g.primaryButtonBackgroundPressed,color:g.primaryButtonTextPressed},rootCheckedHovered:{backgroundColor:g.primaryButtonBackgroundPressed,color:g.primaryButtonTextPressed},rootDisabled:{selectors:(o={},o[i.b]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},o)},splitButtonContainer:{selectors:(c={},c[i.b]={border:"none"},c)},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},{position:"absolute",width:1,right:31,top:8,bottom:8}),{backgroundColor:h.white,selectors:(l={},l[i.b]={backgroundColor:"Window"},l)}),splitButtonMenuButton:{backgroundColor:g.primaryButtonBackground,color:g.primaryButtonText,selectors:(u={},u[i.b]={backgroundColor:"WindowText"},u[":hover"]={backgroundColor:g.primaryButtonBackgroundHovered,selectors:(d={},d[i.b]={color:"Highlight"},d)},u)},splitButtonMenuButtonDisabled:{backgroundColor:g.primaryButtonBackgroundDisabled,selectors:{":hover":{backgroundColor:g.primaryButtonBackgroundDisabled}}},splitButtonMenuButtonChecked:{backgroundColor:g.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:g.primaryButtonBackgroundPressed}}},splitButtonMenuButtonExpanded:{backgroundColor:g.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:g.primaryButtonBackgroundPressed}}},splitButtonMenuIcon:{color:g.primaryButtonText},splitButtonMenuIconDisabled:{color:h.neutralTertiary,selectors:(p={},p[i.b]={color:"GrayText"},p)}}}},lxh6:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="form.ViewPortSizes.set";function a(e,t,n,a){const s=Object(r.v)(t);return{type:i,payload:{viewportWidth:n,viewportHeight:a},meta:{pageId:e,contextKey:s}}}},"m+2h":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="footer.visible";function a(e,t,n){const a=Object(r.v)(t);return{type:i,payload:n,meta:{pageId:e,contextKey:a}}}},mHvI:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n("lSDC"),i=n("1fn7"),a=n("i1f0"),s=n("+zjj"),o=n("lju1");const c=[r.b];function l(e,t){let n=Object(a.Ib)(e,t)?i.u:i.t;return n=n.concat(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){let n=[];if(c)for(const r of c)n=n.concat(r(e,t));return n}(e,t)),n}function u(){let e=[];return e=e.concat(Object.values(s.a).map(e=>e.reason)),e=e.concat(Object.values(s.b)),e=e.concat(Object.values(o.a)),e=e.concat(Object.values(a.b).map(e=>e.reason)),e}},mLMm:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n("dHD5"),i=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="update.grid.paging.refresh.input";function s(e,t){return{type:"update.grid.paging.refresh.input.async",execute({dispatch:n,getState:s},o){const c=o.TraceManager.getTracer(i.z),l=i.x+".updateGridPagingRefreshInputAction";try{const i=Object(r.u)(t);return n(function(e,t){return{type:a,payload:Math.floor(1e3*Math.random()),meta:{pageId:e,dataSetContextKey:t}}}(e,i)),c.info("Updating the grid pagingRefreshInput"),o.EventManager.ReportComponentSuccess(l),Promise.resolve()}catch(e){const t="Updating the grid pagingRefreshInput failed with error : "+e.message;o.EventManager.ReportComponentFailure(l,Error(t))}}}}},meVR:function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var r=n("+zjj"),i=n("+Ajx"),a=n("6Qf/"),s=n("P6DH"),o=n("d0w6"),c=n("KBcj"),l=n("vNXc"),u=n("a72m"),d=n("BFlg"),p=n("pEXn"),h=n("5R5s"),g=n("hSDL"),m=n("aF0N"),b=n("Ii8m"),y=n("69Qu"),f=n("jAuy"),S=n("eXjw"),v=n("Lyxw"),C=n("3/02"),O=n("fyfl"),_=n("FZDd");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const I=`${d.x}.${d.v}`;function j(e,t,n,r,i,o,u,d,p,m){const b=F(r,u,p),S=Object(c.c)(t,n);if(!S)return Promise.resolve(null);const O=l.a.fromXmlAndSql(S.fetchXML,S.offlineSqlQuery,n).getQueryState(),_=m||Object(s.db)(t,r,u),I=Object(f.c)(i,o);let j=!1;Object(y.b)(t)&&Object(f.h)(t,o.relationshipName,!0)&&(j=!0);const T=Object(s.ub)(t,r);if(T||"activitypointer"===r||j){const n=t.user&&t.user.userId,s=Object(v.c)(t,C.Zc),c=Object(h.a)(r,n,o,s,T);return e(c.getFilterOptionsAction()).then(n=>{if(n&&n.length>0){const t=n.filter(e=>e.isDefault);if(t&&t.length>0){const n=c.getFilterExpression(t[0].value);e(Object(g.l)(n,i,o))}}return e(Object(a.d)(O,r,i,o,null,u,_,j,I)).then(n=>P(e,n,t,r,i,b,d))})}return e(Object(a.d)(O,r,i,o,null,u,_,void 0,I)).then(n=>P(e,n,t,r,i,b,d))}function P(e,t,n,r,i,o,c){const l=Object(m.c)(n),u=Object(m.b)(n);return(l||u)&&Object(s.sb)(n,r)&&Object(a.e)(c,e,r,i),c.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid.initializeRelatedGrid",o),c.EventManager.ReportComponentSuccess(I,o),t}function F(e,t,n){return[{name:p.a.CorrelationId,value:n.correlationId},{name:p.a.ContextId,value:n.contextId},{name:p.a.ActionStack,value:n.stack},{name:"entityName",value:e},{name:"relationshipName",value:t}]}function T(e,t,n){const a=[{name:"EntityName",value:n.entityName}];return{type:"form.related.openGrid",execute({dispatch:a,getState:l},d,h){const g=l(),m=Object(r.e)(g,{id:e},t.parentContextToken),y=F(n.entityName,n.relationshipName,h);if(a(Object(i.b)(e,t,n)),null!==m&&m.id===n.id&&m.isSelected===n.isSelected&&m.relationshipName===n.relationshipName||a(Object(i.b)(e,t.parentContextToken,n)),a(Object(b.a)(e,n)),n&&!n.url){const r=function(e,t){return[{name:p.a.CorrelationId,value:e.correlationId},{name:p.a.ContextId,value:e.contextId},{name:p.a.ActionStack,value:e.stack},{name:"hasViewId",value:!0},{name:"entityName",value:t}]}(h,n.entityName);if(!Object(s.v)(g,e,t)){a(Object(u.b)(n.entityName,o.a.MAIN_APPLICATION_VIEW));const i=Object(c.a)(g,n.entityName,o.a.SUB_GRID),s=Object(c.c)(g,i),p=Object(v.c)(g,C.Xc),m=!p||function(e,t){var n,r,i;if(!(null===(r=null===(n=null==t?void 0:t.grid)||void 0===n?void 0:n.rows)||void 0===r?void 0:r.length)||!(null===(i=e.metadata)||void 0===i?void 0:i.entities))return!0;const a=t.grid.rows[0].cells;if(!(null==a?void 0:a.length))return!0;for(let t=0;t<a.length;t++)if(a[t].relatedEntityName&&!e.metadata.entities[a[t].relatedEntityName])return!1;return!0}(g,s);return s&&s.initialized===S.a.Initialized&&m?(j(a,g,i,n.entityName,e,t,n.relationshipName,d,h,n.ordinal).catch(e=>{d.EventManager.ReportComponentFailure(I,e,null,y)}),d.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid",r),Promise.resolve(i)):a(Object(u.a)(n.entityName,o.a.SUB_GRID)).then(i=>{let s=Promise.resolve();if(p){const t=Object(O.a)(g,i,e);s=a(Object(_.e)(t))}return s.then(()=>{const s=l();return j(a,s,i,n.entityName,e,t,n.relationshipName,d,h,n.ordinal).catch(e=>{d.EventManager.ReportComponentFailure(I,e,null,y)}),d.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid",r),i})},e=>{d.EventManager.ReportComponentFailure(I,e,null,y)})}}return Promise.resolve(null)},getFailureParameters:(e,t)=>a}}},mhYf:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var r=n("dHD5"),i=n("i1f0"),a=n("TYIz"),s=n("+zjj"),o=n("wL2W"),c=n("4aOd"),l=n("pEXn"),u=n("tWr6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d="tab.visible";function p(e,t,n,p){return{type:"tab.visible.sync",sync:!0,execute({dispatch:h,getState:g},m){var b;const y=g();h(function(e,t,n,i){const a=Object(r.v)(n);return{type:d,payload:i,meta:{pageId:e,tabId:t,contextKey:a}}}(e,t,n,p));const f=Object(i.wc)(y,{id:e},n),S=Object(s.e)(y,{id:e},n);if(f||(null==S?void 0:S.isSelected)||!p){if(f===t&&!p){const r=Object(i.fb)(y,{id:e},n);let s=!1;if(r){const o=Object(i.m)(y,r);for(const r of o)if(r.Id!==t&&Object(i.Kc)(y,r.Id,e,n)){s=!0,h(Object(a.b)(e,r.Id,n));break}}s||h(Object(a.b)(e,void 0,n))}}else h(Object(a.b)(e,t,n));if(Object(o.a)()){const r=g(),a=null===(b=null==m?void 0:m.TraceManager)||void 0===b?void 0:b.getTracer(`${l.k}${l.r}`),s=Object(i.Kc)(y,t,e,n),o=Object(i.Kc)(r,t,e,n),d=Object(u.a)(r,e);d.push({name:"tabId",value:t}),d.push({name:"tabName",value:Object(i.Ic)(r,t,e,n)}),d.push({name:"tabLabel",value:Object(i.Hc)(r,t,e,n)}),d.push({name:"visible state before change",value:null==s?void 0:s.toString()}),d.push({name:"visible state after change",value:null==o?void 0:o.toString()}),d.push({name:"callstack",value:new c.a(new Error).getStackTrace()}),null==a||a.warn(l.n,[{name:l.v,value:l.r+".visible"},{name:l.r,value:JSON.stringify(d)}])}}}}},mlKL:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var r=n("arV0"),i=n("jRy5"),a=n("dHD5"),s=n("ApeL"),o=n("i1f0"),c=n("mIxf"),l=n("bT7G"),u=n("WPtp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d="attribute.requiredLevel";function p(e,t,n,p){return{type:"attribute.requiredLevel.validation",sync:!0,execute(h,g){const m=h.getState();if(p!==Object(o.pc)(m,e,t,n)){h.dispatch(function(e,t,n,r){if(t&&t.contextTokenType&&t.contextTokenType===i.a.GridRow)return Object(s.f)(e,t,n,r);const o=Object(a.x)(t);return{type:d,payload:r,meta:{pageId:e,contextKey:o,dataFieldName:n}}}(e,t,n,p));const g=Object(o.ac)(m,e,t),b=Object(l.b)(m,g);if((0===p||3===p)&&b&&b.activeChanges&&b.activeChanges[n]||t&&t.contextTokenType&&t.contextTokenType===i.a.GridRow){let s=null,d=null,p=null,b=null;if(t&&t.contextTokenType&&t.contextTokenType===i.a.GridRow)s=t.entityTypeName?t.entityTypeName:null,d=t.recordId?t.recordId:null,p=Object(a.t)(t),b=Object(a.r)(t);else{const n=Object(r.g)(m,e);s=n&&n.entityTypeName?n.entityTypeName:null,d=n&&n.id?n.id:null,p=null,b=t}const y=Object(l.d)(m,g,{etn:s,id:d},n);if(Object(o.Uc)(y)){const t={[n]:{fieldName:n,value:y?y.formatted?y:Object(u.e)(y):y}};h.dispatch(Object(c.a)(e,t,!0,!0,s,d?d.guid:null,p,b))}}}}}}},nIfK:function(e,t,n){"use strict";n.d(t,"a",(function(){return A})),n.d(t,"e",(function(){return M})),n.d(t,"d",(function(){return B})),n.d(t,"b",(function(){return R})),n.d(t,"c",(function(){return D}));var r=n("Yx7Y"),i=n("SAYH"),a=n("vNXc"),s=n("9fGf"),o=n("Z/4N"),c=n("P6DH"),l=n("p/2N"),u=n("iZ7K"),d=n("sn0j"),p=n("y60j"),h=n("BJ7u"),g=n("JwRZ"),m=n("504W"),b=n("IqkD"),y=n("CB5L"),f=n("odYE"),S=n("i1f0"),v=n("bT7G"),C=n("00VO"),O=n("YGjz"),_=n("LbMF"),I=n("BFlg"),j=n("Lyxw"),P=n("3/02"),F=n("jAuy"),T=n("/Zy9"),w=n("arV0"),E=n("z+5+"),x=n("d0w6"),N=n("AF/G");const A=["MscrmControls.Grid.ReadOnlyGrid","MscrmControls.Grid.GridControl","MscrmControls.SharepointAssociatedGrid.SharepointControl","MscrmControls.MailApp.MailAppListControl"],k=["Opportunity_ActivityPointers"];function M(e){const t=e&&e.control&&e.control.Parameters&&e.control.Parameters.hasOwnProperty(I.r)&&e.control.Parameters[I.r],n=[e.viewId,t,e.recordsPerPage,(r=e,r&&r.controlParameters&&r.controlParameters.ChartDrillDownParameters&&r.controlParameters.ChartDrillDownParameters.length>0)];var r;return e.customQueryStateKeyParts&&n.push(...e.customQueryStateKeyParts),n.join("")}function D(e,t,n,r,i){const s=R(e,t,n,r,i);return t=>{const n=s(t);return n&&n.getQueryState(n instanceof a.a?void 0:e)}}function R(e,t,n,r,o){const l={};return u=>{const d=new i.a(u.viewId),p=Object(c.qb)(e(),d,t);if(!p)return null;const h=function(e,t,n){let r=t.fetchXML,i=null;const a="TeamTemplateId";if(t.entityLogicalName===O.a&&e.controlParameters[a]){const t=e.controlParameters[a];if(r&&r.indexOf(t)<0){const e=n?n.guid:"",a=Object(C.a)(r,t,e);r=a.updatedFetchXml,i=a.filterString}}return{fetchXML:r,filterString:i}}(u,p,r);let I=h.fetchXML;if(!I&&p.queryApi)return null;if(Object(F.l)(e())&&u.quickFindViewId){const n=new i.a(u.quickFindViewId),r=i.a.isNullOrEmpty(n)?null:Object(c.qb)(e(),n,t);Object(m.a)(r)||(I=function(e,t){const n=new DOMParser;if(e){const r=n.parseFromString(e.fetchXML,"text/xml"),i=n.parseFromString(t.fetchXML,"text/xml"),a=r.getElementsByTagName("filter");for(let e=0;e<a.length;e++)a[e].attributes&&a[e].attributes.getNamedItem("isquickfindfields")&&i.getElementsByTagName("entity")[0].appendChild(a[e]);return(new XMLSerializer).serializeToString(i)}return t.fetchXML}(r,p))}const A=e(),M=u.entityLogicalName,D=u.getCustomFilter&&u.getCustomFilter(),R=function(e,t,n,r,a){const s=a.controlParameters.RelationshipName;if(s){let o=r,l=null,u=null;if(a.controlParameters.DependentAttributeName){u=a.controlParameters.DependentAttributeName;l=u.split(".")[1]||u}if(a.controlParameters.IsDataSetLookup&&(o=null==a.controlParameters.ParentRecordId?i.a.EMPTY:new i.a(a.controlParameters.ParentRecordId),a.controlParameters.DependentAttributeName)){u=a.controlParameters.DependentAttributeName;l=u.split(".")[1]||u}const d=Object(S.ac)(e,t,a.contextToken),p=new f.a(n,o);let h=null,g=!1;Object(_.a)(e,n,l)?h=Object(v.d)(e,d,p,l):a.controlParameters.DependentAttributeType&&(g=a.controlParameters.DependentAttributeType===n&&a.controlParameters.DependentAttributeType!==a.entityLogicalName);const m=h;m&&m.reference?o=m.reference.id:!a.controlParameters.IsDataSetLookup&&null===l||null!==m&&null!==m.reference||!p||null===p.id||g||(o=null);const b=Object(c.kb)(e,t,a.contextToken);let C=0,O=y.h.None;return b?(C=1,-1===k.indexOf(s)&&(O=y.h.Related)):(a.controlParameters.ShouldApplyContextFilter&&a.controlParameters.IsDataSetLookup||!a.controlParameters.IsDataSetLookup)&&(C=2),{type:C,rollupType:O,entityReference:p,contextId:o,relationshipName:s}}return null}(A,t,o||n&&n.EntityLogicalName,r,u),L=Object(g.p)(e(),M),V=function(e,t,n,r,a,s,o){var l;const u=Object(w.g)(e,s),d=!(!(null==u?void 0:u.pageToEditedViewMapId)||!Object(c.rb)(e,u.pageToEditedViewMapId.guid,o.guid)),p=Object(c.qb)(e,o,s),h=t.hasGrid&&(1===t.gridType||void 0===t.gridType&&i.a.equals(null===(l=t.control)||void 0===l?void 0:l.ClassId,N.E));return Object(E.e)(e)&&(h||Object(E.f)(e))&&!(1===(null==n?void 0:n.type))&&!(2===(null==n?void 0:n.type))&&!(r&&r.linkEntities&&Array.isArray(r.linkEntities)&&r.linkEntities.length>0)&&!a&&!(r&&r.filter&&Array.isArray(r.filter)&&r.filter.length>0)&&!d&&(null==p?void 0:p.queryType)!==x.a.QUICKFIND_SEARCH&&!t.quickFindViewId}(A,u,R,D,L,t,d)?T.a.fromView(d,u.quickFindSearchString):a.a.fromXmlAndSql(I,p.offlineSqlQuery,d,u.quickFindSearchString,M,e);(null==h?void 0:h.filterString)&&r&&V.addExistingContextFilterToKey(i.a.toString(r),h.filterString);const z=Object(c.x)(e(),t,u.contextToken);z&&(V.pageNumber=z);const H=B(e(),t,n,u,p,M);H.length&&V.select(...H);const G=function(e,t,n,r,i,a){let o=null;if(!Object(j.a)(e,P.ub)||!a.hasGrid||1!==a.gridType)return null;const l=Object(c.j)(r)(e,t,a.contextToken),u=Object(s.b)(e),d=l&&l.CustomControls&&l.CustomControls[u]&&l.CustomControls[u].Parameters;if(!Object(c.vb)(d)&&(o=Object(c.o)(e,n),o)){const e=[],t=i&&i.grid&&i.grid.rows&&i.grid.rows[0]&&i.grid.rows[0].cells;if(t)for(const n in t)t.hasOwnProperty(n)&&e.push(t[n].name);-1!==e.indexOf(o.lookupAttribute)&&(o.lookupAttribute=null),i&&i.fetchXML&&Object(F.b)(i.fetchXML)&&(o.primaryAttribute=null)}return o}(e(),t,M,d,p,u);G&&(G.lookupAttribute&&V.select(G.lookupAttribute),G.primaryAttribute&&V.addChildCountAttribute(G.primaryAttribute));const W=u.getCustomSorting&&u.getCustomSorting(p,l);if(W)for(const e of W)V.orderBy(e.name,1===e.sortDirection);if(R)switch(R.type){case 1:V.applyRollupContextFilter(R.entityReference,R.rollupType);break;case 2:const e=Object(c.v)(A,t,u.contextToken);V.applyContextFilter(R.relationshipName,R.contextId,A,e?e.relationshipRoleOrdinal:void 0)}if(L&&V.where(L),D&&D.filter)if(Array.isArray(D.filter)){const e=D.filter;for(const t of e)V.where(t,t.shouldReplace)}else{const e=D.filter;!function(e){return!!(e&&e.operator&&e.terms)}(e)?V.where(Object(g.n)(D.filter,null)):V.where(e,e.shouldReplace)}if(D&&D.linkEntities)for(const e of D.linkEntities)V.addLinkedEntity(e,e.attributes||[]);const U=u.recordsPerPage;if(U)V.pageSize=U;else{const t=Object(b.h)(e());u.hasChart||Object(m.a)(t)?V instanceof a.a&&V.setDefaultPageSize():V.pageSize=t}return V}}function B(e,t,n,r,i,a){const s=[...L(e,n,r,i.viewId),...V(e,r,a,i.viewId),...z(e,n,r,a),...H(e,r,a),...G(e,t,r,a),...r.getCustomColumns?r.getCustomColumns():[]];if(s.length){const e=[],t=[],n=i&&i.grid&&i.grid.rows&&i.grid.rows[0]&&i.grid.rows[0].cells;if(n)for(const e in n)n.hasOwnProperty(e)&&t.push(n[e].name);for(const n in s){const r=s[n];-1===t.indexOf(r)&&-1===e.indexOf(r)&&e.push(r)}return e}return s}function L(e,t,n,r){if(0!==n.gridType)return[];let i="Grid";const a=Object(s.b)(e),u=t&&Object(o.a)(n.control,t,a);return u&&(i=Object(c.ab)(e,u.CustomControlId)),Object(l.b)(e,n.control.UniqueId,i,t&&t.Id,null,null,r)||[]}function V(e,t,n,r){return 1!==t.gridType?[]:Object(l.a)(e,n,r)||[]}function z(e,t,n,r){const i=[],a=Object(u.h)(e,r);return a&&(function(e,t,n){const r=Object(s.b)(e),i=t&&Object(o.a)(n.control,t,r);return i&&[i.CustomControlId&&i.Name].some(e=>-1!==A.indexOf(e))}(e,t,n)||n.hasGrid)&&("activitypointer"===r&&i.push("activitytypecode"),a.PrimaryNameAttribute&&i.push(a.PrimaryNameAttribute),Object(c.vb)(n.controlParameters)||a.PrimaryImageAttribute&&i.push(Object(F.a)(a.PrimaryImageAttribute))),i}function H(e,t,n){const r=[];if(4&t.streamMode){r.push("modifiedon");const t=Object(_.d)(e,n);if(t)for(const i in t){const a=t[i];a.IsSortableEnabled&&"image"!==a.Type&&"multiselectpicklist"!==a.Type&&Object(d.b)(e,n,a.LogicalName,a)&&r.push(a.LogicalName)}}else 2&t.streamMode&&r.push("modifiedon");return r}function G(e,t,n,a){const s=[],o=n.cardFormId;if(o)if("activitypointer"===a)s.push(...d.a);else{const n=i.a.equals(o,r.a)?Object(p.h)(e,a,Object(h.a)(11)):o,c=Object(p.d)(e,n,t);if(c)for(const e in c){const t=c[e];t.DataFieldName&&s.push(t.DataFieldName)}}return s}},nexV:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("Kvn0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t){const n={displayState:e};return{type:r.c,payload:n}}},npAL:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("dHD5"),i=n("5d8d"),a=n("uxy2");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class s{constructor(e){Object.assign(this,e)}executeNotifyHandlersThatEventOccurred(e){throw new Error("Not Replaced")}executeUpdateCurrentSearchText(e){throw new Error("Not Replaced")}executeUpdateSearchResults(e){throw new Error("Not Replaced")}executeUpdateSelectedResult(e){throw new Error("Not Replaced")}}var o=n("16wZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class c{constructor(e,t){this.objectWrapperType=2,this.previousReturn=new s({pageId:null,controlId:null,contextToken:null,showLabel:!1,isOnPremises:!1,label:"",records:null,isKnowledgeManagementEnabled:!1,currentSearchText:"",entityDisplayName:"",isControlDisabled:!1,urlQueryParams:null,filterQueryParams:null,entityReference:null,searchWidgetActionResult:null,hideSearchOnRecordLoad:!1,blockClick:!1,descriptors:{numberOfResults:10,showArticleStatusFilter:!1,articleStatusFilter:"",showLanguageFilter:!1,languageFilter:"",isAutoSuggestionsEnabled:!1,enableRating:"",showRatingUsing:"",selectDefaultLanguage:"",selectPrimaryCustomer:"",mappedFields:[],enableMDF:!1,allowDisablingMDFOnUI:!1,showContextualActions:"",actionList:[]},executeNotifyHandlersThatEventOccurred:null,executeUpdateCurrentSearchText:null,executeUpdateSearchResults:null,executeUpdateSelectedResult:null}),this._previousControlStateId={},this._propKey=t,this._executeUpdateCurrentSearchText=(t,n)=>e(Object(a.d)(t,n)),this._executeUpdateSearchResults=(t,n)=>e(Object(a.f)(t,n)),this._executeUpdateSelectedResult=(t,n)=>e(Object(a.g)(t,n))}linkToParameter(e,t){const n=t.executeNotifyHandlersThatEventOccurred;e.executeNotifyHandlersThatEventOccurred=this.executeNotifyHandlersThatEventOccurred.bind(this,n),e.executeUpdateCurrentSearchText=this._executeUpdateCurrentSearchText,e.executeUpdateSearchResults=this._executeUpdateSearchResults,e.executeUpdateSelectedResult=this._executeUpdateSelectedResult}retrieveSearchWidgetObject(e,t,n,a,c){const l="hideSearchOnRecordLoad"in t.descriptor&&!!t.descriptor.hideSearchOnRecordLoad,u={};let d=!1;const p=l?t.descriptor.contextToken:Object(r.n)(c,t.controlId),h=Object(r.v)(p),g=e.searchWidget.list&&e.searchWidget.list[h];this._searchWidgetDescriptor=t.descriptor;const m=Object(i.j)(a);if(t.descriptor){u[this._propKey]=new s({pageId:t.id,controlId:t.controlId,contextToken:p,records:g?e.searchWidget.list[h].records:null,label:this._searchWidgetDescriptor.Label,showLabel:this._searchWidgetDescriptor.ShowLabel,isOnPremises:Object(i.i)(e),urlQueryParams:m?null:this._getUrlQueryParams(a),filterQueryParams:g?e.searchWidget.list[h].filterQueryParams:null,blockClick:m?!!g&&e.searchWidget.list[h].blockClick:g&&!Object(o.a)(e.searchWidget.list[h].blockClick)?e.searchWidget.list[h].blockClick:a.blockClick,descriptors:l?t.descriptor.descriptors:{articleStatusFilter:this._searchWidgetDescriptor.Parameters.FilterResults,showArticleStatusFilter:"true"===this._searchWidgetDescriptor.Parameters.AllowChangingFiltersOnUI,languageFilter:this._searchWidgetDescriptor.Parameters.SelectDefaultLanguage,showLanguageFilter:"true"===this._searchWidgetDescriptor.Parameters.ShowLanguageFilter,numberOfResults:this._searchWidgetDescriptor.Parameters.NumberOfResults,isAutoSuggestionsEnabled:this._searchWidgetDescriptor.Parameters.EnableAutoSuggestions,enableRating:this._searchWidgetDescriptor.Parameters.EnableRating,showRatingUsing:this._searchWidgetDescriptor.Parameters.ShowRatingUsing,selectDefaultLanguage:this._searchWidgetDescriptor.Parameters.SelectDefaultLanguage,selectPrimaryCustomer:this._searchWidgetDescriptor.Parameters.SelectPrimaryCustomer,mappedFields:this._searchWidgetDescriptor.Parameters.hasOwnProperty("MappedFields")?JSON.parse(this._searchWidgetDescriptor.Parameters.MappedFields):[],enableMDF:!!this._searchWidgetDescriptor.Parameters.hasOwnProperty("EnableMDF")&&"true"===this._searchWidgetDescriptor.Parameters.EnableMDF.toLowerCase(),allowDisablingMDFOnUI:!!this._searchWidgetDescriptor.Parameters.hasOwnProperty("AllowDisablingMDFOnUI")&&"true"===this._searchWidgetDescriptor.Parameters.AllowDisablingMDFOnUI.toLowerCase(),showContextualActions:this._searchWidgetDescriptor.Parameters.hasOwnProperty("ShowContextualActions")?this._searchWidgetDescriptor.Parameters.ShowContextualActions:"",actionList:this._searchWidgetDescriptor.Parameters.hasOwnProperty("ActionList")&&this._searchWidgetDescriptor.Parameters.ActionList?this._searchWidgetDescriptor.Parameters.ActionList.split(",").map(e=>parseInt(e,10)):[]},isKnowledgeManagementEnabled:!m||Object(i.h)(e,a.entityTypeName),entityDisplayName:m?Object(i.b)(e,a.entityTypeName):"",isControlDisabled:!!g&&e.searchWidget.list[h].isControlDisabled,hideSearchOnRecordLoad:!1,currentSearchText:g?e.searchWidget.list[h].currentSearchText:null,entityReference:{Id:m?a.id:"",Name:m&&e.metadata.entities[a.entityTypeName]?e.metadata.entities[a.entityTypeName].PrimaryNameAttribute:null,LogicalName:m?a.entityTypeName:""},searchWidgetActionResult:g?e.searchWidget.list[h].searchWidgetActionResult:null,executeNotifyHandlersThatEventOccurred:e=>{},executeUpdateCurrentSearchText:e=>{},executeUpdateSearchResults:e=>{},executeUpdateSelectedResult:e=>{}});let n=!1;"hideSearchOnRecordLoad"in t.descriptor&&t.descriptor.hideSearchOnRecordLoad&&g&&(u[this._propKey].hideSearchOnRecordLoad=t.descriptor.hideSearchOnRecordLoad,u[this._propKey].kbSearchResultActions=t.descriptor.kbSearchResultActions,u[this._propKey].records=[],u[this._propKey].records.push(t.descriptor.records[0]),n=!0),this._searchWidgetDescriptor&&(!this.previousReturn||!g||this._previousControlStateId[h]!==e.searchWidget.list[h].controlStateId||this.previousReturn.label!==u[this._propKey].label||this.previousReturn.showLabel!==u[this._propKey].showLabel||this.previousReturn.currentSearchText!==u[this._propKey].currentSearchText||this._filterQueryParamsHaveChanged(u[this._propKey].filterQueryParams)||this.previousReturn.blockClick!==u[this._propKey].blockClick||this._descriptorsHaveChanged(u[this._propKey].descriptors)||!this.previousReturn.entityReference&&u[this._propKey].entityReference||this.previousReturn.entityReference&&!u[this._propKey].entityReference||this.previousReturn.entityReference&&u[this._propKey].entityReference&&this.previousReturn.entityReference.Id!==u[this._propKey].entityReference.Id||this.previousReturn.searchWidgetActionResult!==u[this._propKey].searchWidgetActionResult)&&(n=!0),d=n}return d&&(this.previousReturn=u[this._propKey],g&&(this._previousControlStateId[h]=e.searchWidget.list[h].controlStateId)),this.previousReturn}getLatestData(){return this.previousReturn}executeNotifyHandlersThatEventOccurred(e,t,n){e(t,n)}_getUrlQueryParams(e){return{queryString:e.query,sort:e.sort,enableSelection:e.enableSelection,enableContextualActions:e.enableContextualActions}}_filterQueryParamsHaveChanged(e){return!this.previousReturn.filterQueryParams&&!!e||!!this.previousReturn.filterQueryParams&&!e||!!this.previousReturn&&!!e&&(this.previousReturn.filterQueryParams.command!==e.command||this.previousReturn.filterQueryParams.value!==e.value)}_descriptorsHaveChanged(e){return this.previousReturn.descriptors.articleStatusFilter!==e.articleStatusFilter||this.previousReturn.descriptors.showArticleStatusFilter!==e.showArticleStatusFilter||this.previousReturn.descriptors.languageFilter!==e.languageFilter||this.previousReturn.descriptors.showLanguageFilter!==e.showLanguageFilter||this.previousReturn.descriptors.numberOfResults!==e.numberOfResults}}var l=n("5ZBI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const u="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlSearchWidgetSelector";function d(e){return()=>{const t={},n={},r={};return(i,a,s,o,d,p)=>{l.a.info(s.controlId+"."+u+": createGetSearchWidgetData started");let h=!1;r.hasOwnProperty(i)&&r[i]||(r[i]=new c(e,i));const g=r[i],m=g.retrieveSearchWidgetObject(a,s,o,d,p);return n.hasOwnProperty(i)&&n[i]&&m===n[i]||(n[i]=m,h=!0),h&&(t[i]=g),l.a.info(s.controlId+"."+u+": createGetSearchWidgetData finished"),t[i]}}}},ojtV:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return S}));var r=n("dHD5"),i=n("BFlg"),a=n("dQnL"),s=n("KBcj"),o=n("SAYH"),c=n("P6DH"),l=n("CngE"),u=n("iZ7K"),d=n("qwRa"),p=n("WK+4"),h=n("BzGi"),g=n("EY5k"),m=n("GEBM"),b=n("69Qu"),y=n("LAGg");const f="chart.showChart.update";function S(e,t,n){return{type:"chart.showChart.update.async",execute({dispatch:f,getState:S},C){const O=C.TraceManager.getTracer(i.z),_=i.x+".updateShowChartAction";try{O.info("Updating the show chart"),t||(t=Object(r.k)(S(),e));const i=S(),I=Object(r.v)(t),j=Object(c.T)(i,e,t),P=Object(s.c)(i,j),F=P&&P.entityLogicalName;let T=Object(c.r)(i,e,t,F),w=Object(c.s)(i,e,t);const E=Object(l.a)(i,T),x=E&&E.PrimaryEntityTypeCode,N=x&&Object(u.m)(i,parseInt(x,10));F&&N&&F!==N&&(T=null,w=h.a.savedvisualization);const A=Object(l.i)(i,F);if(T&&A&&A.chartTypes&&Object.keys(A.chartTypes).length>0){const e=o.a.toString(T);w=e in A.chartTypes[h.a[h.a.savedvisualization]]?h.a.savedvisualization:h.a.uservisualization}if(!n)return f(v(e,I,n)),C.EventManager.ReportComponentSuccess(_),Promise.resolve();if(!Object(b.b)(S()))return Promise.resolve();return f(Object(g.e)(m.A)).then(()=>{f(Object(a.a)(F,w,T)).then(n=>o.a.isNullOrEmpty(n)?(w=h.a.uservisualization,f(Object(d.b)(e,t,w)).then(()=>f(Object(a.a)(F,w,T)).then(e=>Promise.resolve(e)))):Promise.resolve(n)).then(r=>{const i=o.a.toString(r);Promise.all([f(Object(p.b)(e,t,i)),f(Object(d.b)(e,t,w)),f(v(e,I,n))]).then(()=>(C.EventManager.ReportComponentSuccess(_),f(Object(y.b)(e,t)),Promise.resolve()))})}).catch(e=>(C.EventManager.ReportComponentFailure(_,Error("Retrieve resource strings for chart failed")),Promise.reject(e))),Promise.resolve()}catch(e){const t="Update the show chart failed with error : "+e.message;C.EventManager.ReportComponentFailure(_,Error(t))}}}}function v(e,t,n){return{type:f,payload:{name:"showChart",value:n},meta:{pageId:e,dataSetContextKey:t}}}},pp6D:function(e,t,n){"use strict";n.d(t,"b",(function(){return A})),n.d(t,"a",(function(){return N})),n.d(t,"c",(function(){return M})),n.d(t,"e",(function(){return D})),n.d(t,"d",(function(){return R}));var r=n("2yvP"),i=n("jRy5"),a=n("IaGr"),s=n("9ksH"),o=n("tpZ5"),c=n("G0J3"),l=n("COKI"),u=n("uOtn"),d=n("OtHk"),p=n("SAYH"),h=n("Zw8F"),g=n("pnQK"),m=n("0nOn"),b=n("+baL");let y;class f extends h.a{constructor(e,t,n,r){super(e,t,n,r),this._dashboardId=e,y=n,this._clientApiExecutor=new m.a(n,"ClientApi.XrmDashboardSelectorItem.",r)}_getEventParams(){return this._commonEventParams||(this._commonEventParams=[{name:"dashboardId",value:p.a.toString(this._dashboardId),isRequired:!1,isEventParam:!0}])}get isBoundDashboard(){return this._clientApiExecutor.execute("isBoundDashboard_get",()=>{const e=Object(g.a)(y.getState(),this._dashboardId);return!e||1032==+e.Type},this._getEventParams())}get isUserDashboard(){return this._clientApiExecutor.execute("isUserDashboard_get",()=>{const e=Object(g.a)(y.getState(),this._dashboardId);return Object(g.c)(e)},this._getEventParams())}navigate(){this._clientApiExecutor.executeAsync("navigate",()=>y.dispatch(Object(b.a)(null,this._dashboardId,null,null,null,null,this.getPageId())),this._getEventParams())}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class S extends u.b{constructor(e,t,n,r,i){let a=d.c;if(r){const t=e.getState(),i=Object(d.g)(t,r);i&&i[n.guid]&&(a=d.g)}super(e,t,n,r,i,a,f)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class v extends l.a{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a,S)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let C;class O extends c.a{constructor(e,t,n,r,i,a){super(e,t&&t.etn,r,i,()=>v,n),C=e,this._getCommands=a,this._apiExecutor=new m.a(e,"ClientApi.XrmDashboard.",i,r)}get commands(){return this._apiExecutor.execute("commands_get",()=>this._commands||(this._commands=this._getCommands(C,this.contextToken,this.pageId)))}}var _=n("HAeo"),I=n("zgeC"),j=n("ywwS"),P=n("ghNp"),F=n("i1f0"),T=n("qshH"),w=n("E7fB"),E=n("16wZ"),x=n("T6Zt");function N(e,t,n,r){return k((n,i)=>new O(n,i,new s.b(n,t),e,t,r),"clientapi.create.xrmdashboard","ClientApi.XrmCommandObjectFactory.createXrmDashboard",e,t,n,!1)}function A(e,t,n,r){return k((n,r)=>new o.a(n,r,new s.b(n,t),e,t),"clientapi.create.xrmform","ClientApi.XrmCommandObjectFactory.createXrmForm",e,t,n,!0,r)}function k(e,t,n,i,s,o,c,l){return{type:t,sync:!0,execute(t,u){Object(E.g)(i,n,"contextToken"),Object(E.g)(s,n,"pageId"),c&&Object(E.g)(o,n,"entityTypeName");try{let n=t.dispatch(Object(P.b)(s,i));if(!n){n=e(t,{etn:o,id:l}),n.applicationContext=u;const a=new w.a(t,s);if(n.context=a,!i.parentContextToken){const e=u.ClientApiManager.getClientApiEntry(s);Object(r.b)("form.initialization",()=>{e.xrmInstance.Page=n}),e.primaryContextToken=i}}return n}catch(e){const t=T.a.getInstance().getEventParameters(i);throw t.push({name:"entityTypeName",value:o}),a.a.getInstance().eventManager.ReportComponentFailure(n,e,null,t),e}}}}function M(e,t,n,r,s){const o="ClientApi.XrmCommandObjectFactory.createXrmGrid";return{type:"clientapi.create.xrmgrid",sync:!0,execute(c,l){Object(E.g)(e,o,"contextToken"),Object(E.g)(t,o,"pageId");try{let u=c.dispatch(Object(P.c)(t,e));if(!u){if(3===r){const i=Object(F.s)(c.getState(),{id:t,controlName:s},e.parentContextToken);if(i){const r=c.dispatch(Object(P.b)(t,e.parentContextToken));return new I.a(c,e.parentContextToken,t,s,n,r,i,l)}const u=T.a.getInstance().getEventParameters(e);u.push({name:"controlName",value:s}),u.push({name:"gridType",value:r}),a.a.getInstance().eventManager.ReportComponentFailure(o,new Error("Control descriptor could not be found for subgrid control"),null,u)}if(u=new _.a(c,e,t,n,r,!1,l,s),!e.parentContextToken&&e.contextTokenType===i.a.MainGrid){l.ClientApiManager.getClientApiEntry(t).primaryContextToken=e}}return u}catch(t){const n=T.a.getInstance().getEventParameters(e);throw n.push({name:"controlName",value:s}),n.push({name:"gridType",value:r}),a.a.getInstance().eventManager.ReportComponentFailure(o,t,null,n),t}}}}function D(e,t,n,r){const i="ClientApi.XrmCommandObjectFactory.registerNewControl";return{type:"clientapi.create.xrmTimeline",sync:!0,execute(s,o){Object(E.g)(e,i,"contextToken"),Object(E.g)(t,i,"pageId"),Object(E.g)(n,i,"controlName"),Object(E.g)(r,i,"controlId");try{const c=s.dispatch(Object(P.b)(t,e.parentContextToken));let l=null;switch(n){case"notescontrol":if(l=s.dispatch(Object(P.f)(t,e)),!l){const i=Object(F.s)(s.getState(),{id:t,controlName:n},e.parentContextToken);l=new j.a(s,e.parentContextToken,t,i,n,r,c,o)}break;default:const u=T.a.getInstance().getEventParameters(e);u.push({name:"controlName",value:n}),a.a.getInstance().eventManager.ReportComponentFailure(i,new Error("Failed to create and return the control"),null,u)}return l}catch(t){const r=T.a.getInstance().getEventParameters(e);throw r.push({name:"controlName",value:n}),a.a.getInstance().eventManager.ReportComponentFailure(i,t,null,r),t}}}}function R(e,t){const n="ClientApi.XrmCommandObjectFactory.createXrmKBSearch";return{type:"clientapi.create.xrmkbsearch",sync:!0,execute(r,i){Object(E.g)(e,n,"contextToken"),Object(E.g)(t,n,"pageId");try{let n=r.dispatch(Object(P.g)(t,e));if(!n&&(n=new x.a(r,e,t),!e.parentContextToken)){const r=i.ClientApiManager.getClientApiEntry(t);r.xrmInstance.Page=n,r.primaryContextToken=e}return n}catch(t){const r=T.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(n,t,null,r),t}}}}},qwRa:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n("dHD5"),i=n("BFlg");const a="chart.visualizationtype.update";function s(e,t,n){return{type:"chart.visualizationtype.update.async",execute({dispatch:s,getState:o},c){const l=c.TraceManager.getTracer(i.z),u=i.x+".updateVisualizationTypeAction";try{l.info("Update the chart visualization type"),t||(t=Object(r.k)(o(),e));const i=Object(r.v)(t);return s(function(e,t,n){return{type:a,payload:{name:"chartVisualizationType",value:n},meta:{pageId:e,dataSetContextKey:t}}}(e,i,n)),c.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){const t="Update the chart visualization type failed with error : "+e.message;c.EventManager.ReportComponentFailure(u,Error(t))}}}}},"r/aD":function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return h}));var r=n("i1f0"),i=n("arV0"),a=n("PUjk"),s=n("IaGr"),o=n("2Ct/"),c=n("odYE"),l=n("g6bs");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(e,t,n,a=!1){if(!e)return s.a.getInstance().traceManager.getTracer(n).error("isXrmProcessControlClientApiSupportedOnForm invoked with unexpected null state object"),!1;if(!t)return s.a.getInstance().traceManager.getTracer(n).error("isXrmProcessControlClientApiSupportedOnForm invoked with unexpected null pageId object"),!1;const u=function(e,t){const n=Object(i.g)(e,t);if(!n)return null;const{entityTypeName:r,id:a}=n;return new c.a(r,a)}(e,t),d=!Object(r.Kb)(e,t)&&(Object(o.d)(e)||!Object(o.g)(e))&&(a||!Object(l.d)(e,u,t)),p=g(t,e);return p.push({name:"xrmProcessControlClientApiIsSupported",value:d}),s.a.getInstance().eventManager.ReportComponentSuccess(n,p),d}function d(e,t,n,r){if(!e&&(s.a.getInstance().traceManager.getTracer(r).error("getProcessManagerWithJitInitIfNeeded invoked with unexpected null processManager",g(n,t.getState())),u(t.getState(),n,r))){s.a.getInstance().traceManager.getTracer(r).error("getProcessManagerWithJitInitIfNeeded invoking JIT initialization of process manager",g(n,t.getState()));const e=Object(i.g)(t.getState(),n);return Object(a.b)(n,e)}return e}function p(e,t,n,r){return[{name:"pageId",value:e},{name:"formType",value:Object(i.l)(t,e)},{name:"InitialXrmProcessControlIsNotNull",value:n},{name:"XrmEntityIsNotNull",value:r}]}function h(e,t,n){return[{name:"pageId",value:e},{name:"formType",value:Object(i.l)(t,e)},{name:"getProcessManagerInvoked",value:n}]}function g(e,t){return[{name:"pageId",value:e},{name:"formType",value:Object(i.l)(t,e)}]}},rdSB:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return l}));var r=n("SAYH"),i=n("OWbt"),a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="businessProcessFlow.attributes.add",o="businessProcessFlow.controls.add";function c(e,t,n){const r=Object(a.v)(e);return{type:s,payload:{attributes:d(n)},meta:{pageId:t,contextKey:r}}}function l(e,t,n){const r=Object(a.v)(e);return{type:o,payload:{controls:u(n)},meta:{pageId:t,contextKey:r}}}function u(e){const t={};e&&!e.header_process&&(e.header_process={Id:null,Label:null,Name:"header_process",ShowLabel:!1,Visible:!0,Disabled:!1,DataFieldName:null,UniqueId:null,ClassId:r.a.tryParse("06E9F7AF-1F54-4681-8EEC-1E21A1CEB465")});for(const n in e){const r=Object(i.f)(e[n],null,!0);r&&(t[n]=r)}return t}function d(e){const t={};for(const n in e){const r=e[n],i={Precision:r.Precision,PrecisionSource:r.PrecisionSource,RequiredLevel:r.RequiredLevel,Format:r.Format,OptionSet:r.OptionSet,IsValidForCreate:r.IsValidForCreate,IsValidForUpdate:r.IsValidForUpdate,Targets:r.Targets};t[r.LogicalName]=i}return t}},rs6x:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n("SAYH"),i=n("arV0"),a=n("ruPX"),s=n("kX6F"),o=n("Nb1E"),c=n("odYE"),l=n("iZ7K"),u=n("504W"),d=n("lEFU"),p=n("IqkD"),h=n("69Qu"),g=n("i1f0"),m=n("E8F2");function b(e,t,n,c){const b=[{name:"formId",value:e},{name:"pageName",value:n}];return{type:"form.change",execute({dispatch:f,getState:S},v,C){const O=S();if(Object(g.Eb)(O,t))return Promise.reject(Object(m.b)(O,t,2200000016));const{entityTypeName:_,id:I,recordSetQueryKey:j,data:P,createFromRelationship:F,initWithEntity:T}=Object(i.g)(O,t);b.push({name:"entityTypeName",value:_});const w=r.a.tryParse(e),E={entityTypeName:_,formId:w,id:c?r.a.tryParse(c):I,recordSetQueryKey:j,data:P,createFromRelationship:F,initWithEntity:T},x=w.guid.toString(),N=`<MRUForm><Form Type="Main" Id="${x}" /></MRUForm>`,A=Object(d.c)(O,_);return f(Object(a.a)(n,E,t,{replaceState:!0})).then(e=>{var t,n;if(0===e.status)if(Object(h.b)(S()))null==A||A===r.a.EMPTY?function(e,t,n,i,a,c,d,h){const g=Object(l.p)(i,e),m=Object(p.q)(i),b="?$select=userentityuisettingsid&$filter=objecttypecode eq {0} and _ownerid_value eq '{1}'&$top=1",f=String.format(b,g.toString(),m.guid.toString());a(Object(o.e)("userentityuisettings",f)).then(p=>{p.value&&p.value.length>0&&(n=p.value[0].userentityuisettingsid?new r.a(p.value[0].userentityuisettingsid):r.a.EMPTY),Object(u.a)(n)||Object(u.a)(c)||Object(u.a)(e)||0===e.length||r.a.isNullOrEmpty(n)?null!=n&&n!==r.a.EMPTY||function(e,t,n,i,a,c,d){let p=r.a.EMPTY;const h=Object(l.p)(n,e),g="userentityuisettings";i(Object(o.b)(g,{objecttypecode:h,lastviewedformxml:t})).then(t=>{if(p=t,!(Object(u.a)(p)||Object(u.a)(a)||Object(u.a)(e)||0===e.length||r.a.isNullOrEmpty(p))){const t=d.TraceManager.getTracer("Forms.FormSelectorChange"),n="Created an entry for selected form successfully formid : "+a;t.info(n),i(Object(s.b)(e,a,p))}}).catch(t=>{if(-2147093999===t.errorCode)return Object(u.a)(a)||Object(u.a)(e)||0===e.length||i(Object(s.b)(e,a,p)),{};const n=[{name:"CorrelationId",value:c.correlationId},{name:"ContextId",value:c.contextId},{name:"ActionStack",value:c.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],r="Catch block of ChangeForm.oDataCreate, for formid: "+a;d.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(r),void 0,n),d.TraceManager.getTracer("Forms.FormSelectorChange").error(r,n)})}(e,t,i,a,c,d,h):y(e,t,n,i,a,c,d,h)}).catch(t=>{if(-2147093999===t.errorCode)return Object(u.a)(c)||Object(u.a)(e)||0===e.length||a(Object(s.b)(e,c,n)),{};const r=[{name:"CorrelationId",value:d.correlationId},{name:"ContextId",value:d.contextId},{name:"ActionStack",value:d.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],i="Catch block of ChangeForm.oDataRetrieve, for formid: "+c;h.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(i),void 0,r),h.TraceManager.getTracer("Forms.FormSelectorChange").error(i,r)})}(_,N,A,S(),f,w,C,v):y(_,N,A,S(),f,w,C,v);else{Object(u.a)(w)||Object(u.a)(_)||0===_.length||f(Object(s.b)(_,w,A));const e=null===(t=null==v?void 0:v.TraceManager)||void 0===t?void 0:t.getTracer("Forms.FormSelectorChange"),n="Selected form did not save in the UserEntityUiSetting table, for formid: "+w;null==e||e.info(n)}else if(1===e.status){const e=null===(n=null==v?void 0:v.TraceManager)||void 0===n?void 0:n.getTracer("Forms.FormSelectorChange"),t=`Could not change to form with id ${x} due to a navigation failure or because navigation was cancelled`;null==e||e.info(t,b)}return e})},getFailureParameters:(e,t)=>b}}function y(e,t,n,i,a,l,d,p){const h=new c.a("userentityuisettings",n);a(Object(o.f)(h,{lastviewedformxml:t})).then(()=>{if(!(Object(u.a)(n)||Object(u.a)(l)||Object(u.a)(e)||0===e.length||r.a.isNullOrEmpty(n))){const t=p.TraceManager.getTracer("Forms.FormSelectorChange"),r="Updated selected form successfully to : "+l;t.info(r),a(Object(s.b)(e,l,n))}}).catch(t=>{if(-2147093999===t.errorCode)return Object(u.a)(l)||Object(u.a)(e)||0===e.length||a(Object(s.b)(e,l,n)),{};const r=[{name:"CorrelationId",value:d.correlationId},{name:"ContextId",value:d.contextId},{name:"ActionStack",value:d.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],i="Catch block of ChangeForm.oDataUpdate, for formid: "+l;p.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(i),void 0,r),p.TraceManager.getTracer("Forms.FormSelectorChange").error(i,r)})}},"s+OO":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return o}));var r=n("dHD5"),i=n("BFlg");const a="chart.filterexpression.update",s="ChartFilterExpression";function o(e,t,n){return{type:"chart.filterexpression.update.async",execute({dispatch:o,getState:c},l){const u=l.TraceManager.getTracer(i.z),d=i.x+".updateFilterExpressionAction";try{u.info("Updating the chart filter expression"),t||(t=Object(r.k)(c(),e));const i=Object(r.v)(t);return o(function(e,t,n){return{type:a,payload:{name:s,value:n},meta:{pageId:e,dataSetContextKey:t}}}(e,i,n)),l.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){const t="Updatation of the chart filter expression failed with error : "+e.message;l.EventManager.ReportComponentFailure(d,Error(t))}}}}},sn0j:function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return h}));var r=n("SAYH"),i=n("Lohl"),a=n("y60j"),s=n("LbMF"),o=n("FZDd"),c=n("3hnk"),l=n("j6Db"),u=n("qLnS");const d=["activitytypecode","prioritycode","scheduledend","subject","description","regardingobjectid","ownerid","createdon","statecode","modifiedon"];function p(e,t,n){return{type:"formandattribute.retrieve.async",execute({dispatch:c,getState:u},p){const m="Card"===n;return e.etn&&"activitypointer"===e.etn&&m?c(Object(o.f)("activitypointer",!1,d)).then(()=>{const t=u(),n={};for(const r of d){const i=Object(s.a)(t,e.etn,r);i&&h(t,e.etn,r,i)&&(n[r]=i)}return g(t,e.etn,n,Object(s.d)(t,e.etn)),{formDescriptor:null,attributeDescriptors:n}}):c(Object(i.b)(e,t,n)).then(i=>{const d={};let b=null;return e.etn?c(Object(o.f)(e.etn,!0,[])).then(()=>{const t=u();if(!r.a.isNullOrEmpty(i)&&(b=Object(a.j)(t,i),b&&b.Attributes))for(const n in b.Attributes){const r=b.Attributes[n],i=Object(s.a)(t,e.etn,r);i&&h(t,e.etn,r,i)&&(d[r]=i)}return m&&g(t,e.etn,d,Object(s.d)(t,e.etn)),{formDescriptor:b,attributeDescriptors:d}}):(p.EventManager.ReportComponentSuccess("Form.CustomControl.retrieveFormWithAttributes",[{name:"APIName",value:l.a+".Actions.RetrieveFormWithAttributesAction"},{name:"formId",value:r.a.toString(t)},{name:"formType",value:n}]),null)},e=>{const i=e.get_message();p.EventManager.ReportComponentFailure("Form.CustomControl.retrieveFormWithAttributes",new Error(i),i,[{name:"APIName",value:l.a+".Actions.RetrieveFormWithAttributesAction"},{name:"formId",value:r.a.toString(t)},{name:"formType",value:n}])})}}}function h(e,t,n,r){return Object(c.f)(e,t,n,u.a.CanRead)&&r&&r.IsValidForRead}function g(e,t,n,r){if(r)for(const i in r){const a=r[i];!a.IsSortableEnabled&&"modifiedon"!==a.LogicalName||n[i]||!h(e,t,a.LogicalName,a)||"image"===a.Type||"multiselectpicklist"===a.Type||(n[i]=a)}}},sxfa:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("WRDA"),i=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class a{constructor(e){this.path=e}get path(){return this._traversedPath}set path(e){for(this._traversedPath=Object(r.a)(e);this._traversedPath&&this._traversedPath.indexOf("}")>0;)this._traversedPath=Object(r.a)(this._traversedPath)}static getCandidateTraversedPathFromStagStep(e,t){t=Object(r.a)(t);let n=!1;if(!e||e.length)return null;for(let i=0;i<e.length;i++){const a=Object(r.a)(e[i].get_stageId());if("".concat(a,","),t===a){n=!0;break}}return n?"".substring(0,"".length-2):null}isInTraversedPath(e){return!Object(i.b)(e)&&this._traversedPath.indexOf(Object(r.a)(e))>-1}}},tjBT:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("unFF"),i=n("IqkD"),a=n("ynyB"),s=n("i1f0"),o=n("dHD5"),c=n("3/02"),l=n("H4dV"),u=n("jAuy"),d=n("tJ+6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function p(){let e=null,t=null,n=null,p=null,g=0,m=null,b=null,y=null,f=null,S=null,v=null;return function(C,O,_,I){var j,P;const F=Object(r.a)(C),T=Object(d.c)(C),w=Object(d.a)(C),E=null==w?void 0:w.Colors,x=O.viewPortWidth,N=Object(i.g)(C),A=Object(o.j)(C,O.id),k=Object(s.o)(C,O.id,A),M=x<=F.sizes.Breakpoints.DimensionS,D=Object(u.e)(C),R=Object(s.Eb)(C,O.id);if(t!==F||g!==x||m!==N||b!==_||y!==k||f!==I||S!==M||v!==R||n!==T||p!==E){const r=function(e,t){const n={boxSizing:"border-box",overflowX:"hidden",position:"relative",paddingBottom:"0px",paddingLeft:"0px",paddingRight:"0px"};return t?Object.assign(Object.assign({},e),n):e}({boxSizing:"border-box",overflowX:"hidden",position:"relative",paddingBottom:x<=F.sizes.Breakpoints.DimensionS?F.sizes.Measures.Measure050:F.sizes.Measures.Measure150,paddingLeft:x<=F.sizes.Breakpoints.DimensionS?F.sizes.Measures.Measure050:F.sizes.Measures.Measure075,paddingRight:x<=F.sizes.Breakpoints.DimensionS?F.sizes.Measures.Measure050:F.sizes.Measures.Measure075},R),i=function(e,t){const n={paddingTop:"0px"};return t?Object.assign(Object.assign({},e),n):e}({paddingTop:I.has(c.mb)?"0px":x<=F.sizes.Breakpoints.DimensionS?"25px":"37px",flex:"1 0 auto",height:"inherit"},R);e={tabListStyle:{listStyleType:"none",paddingLeft:x<=F.sizes.Breakpoints.DimensionS?"16px":F.sizes.Measures.Measure150,paddingRight:F.sizes.Measures.Measure150,paddingTop:I.has(c.mb)?"14px":"18px",paddingBottom:"10px",height:"60px",lineHeight:"55px",boxSizing:"border-box",maxWidth:"100%",backgroundColor:T?null===(j=null==E?void 0:E.Palette)||void 0===j?void 0:j.Primary01:"#ffffff"},scrollableTabListStyle:{listStyleType:"none",boxSizing:"border-box",maxWidth:"100%",backgroundColor:T?null===(P=null==E?void 0:E.Palette)||void 0===P?void 0:P.Primary01:"#ffffff",textAlign:"center",overflowX:"scroll",scrollBehavior:l.a.getInstance().get_IsIOS()?"auto":"smooth","::-webkit-scrollbar":{display:"none"},"-webkit-user-select":"none"},associatedGridContainerStyle:{flexGrow:D?1:void 0},tabBasicStyle:r,containerStyle:{width:"100%",display:"flex",paddingTop:x<=F.sizes.Breakpoints.DimensionS||I.has(c.mb)?void 0:"1.25rem",flexDirection:"column",flex:"1 0 auto",position:"relative"},tabsContainerStyle:i,headerStyle:{display:"block",flex:"0 0 auto",backgroundColor:"#f8f7f6",transition:a.c,transform:h(F,x,_,k)},cellContainerStyle:{flex:"0 1 auto"},selectedTabStyle:{height:"inherit",fontFamily:F.fontFamilies.Semibold,overflowY:R?"hidden":"scroll"},semanticZoomListItemStyle:{marginLeft:N?F.sizes.Measures.Measure100:0,marginRight:N?0:F.sizes.Measures.Measure100,fontSize:F.fontSizes.Font100,cursor:"pointer",maxWidth:F.sizes.Measures.Measure900,color:F.colors.BaseColor.Grey.Grey5,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",width:F.sizes.Measures.Measure300,height:"100%",listStyleType:"none",paddingTop:x<=F.sizes.Breakpoints.DimensionS?F.sizes.Measures.Measure050:F.sizes.Measures.Measure150,paddingLeft:x<=F.sizes.Breakpoints.DimensionS?F.sizes.Measures.Measure050:F.sizes.Measures.Measure150,paddingRight:0,paddingBottom:x<=F.sizes.Breakpoints.DimensionS?0:F.sizes.Measures.Measure100,boxSizing:"border-box",float:"left"},customSemanticZoomButtonStyle:{height:"100%",width:"100%"},overflowTabListItemStyle:{marginRight:0,marginLeft:0}};const s=l.a.getInstance();if(N&&s.get_IsIOS()){const t={overflow:"hidden"};e.containerStyle=Object.assign(Object.assign({},e.containerStyle),t)}t=F,g=x,m=N,b=_,y=k,f=I,S=M,v=R,n=T,p=E}return e}}function h(e,t,n,r){if(!n)return"none";let i=t<=e.sizes.Breakpoints.DimensionS?1.6:3;return r&&(i+=.75),`translateY(-${i}rem)`}},tpZ5:function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var r=n("0nOn"),i=n("OQLa"),a=n("arV0"),s=n("UqyN"),o=n("L8zx"),c=n("ZIjf"),l=n("3yqi"),u=n("EOIL"),d=n("i1f0"),p=n("Bo7t"),h=n("Tg1Y"),g=n("16wZ"),m=n("qshH");let b;class y extends u.a{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),b=e}getDefaultNextPageName(){const e="ClientApi.XrmNavigableFormUi.getDefaultNextPageName";try{c.a.instance.reportCall(e);const t=Object(d.M)(b.getState(),this.pageId,this.contextToken);return c.a.instance.reportSuccess(e),t}catch(t){const n=m.a.getInstance().getEventParameters(this.contextToken);throw m.a.getInstance().reportFailure(e,t,null,n),t}}movePrevious(){const e="ClientApi.XrmNavigableFormUi.movePrevious";try{c.a.instance.reportCall(e),b.dispatch(Object(h.b)(this.pageId,this.contextToken)),c.a.instance.reportSuccess(e)}catch(t){const n=m.a.getInstance().getEventParameters(this.contextToken);throw m.a.getInstance().reportFailure(e,t,null,n),t}}moveTo(e){const t="ClientApi.XrmNavigableFormUi.moveTo";let n;try{if(c.a.instance.reportCall(t),e&&this.tabs){const t=Object(d.Gc)(b.getState(),this.pageId,e,this.contextToken);n=this.tabs.get(null==t?void 0:t.Name),n&&b.dispatch(Object(p.b)(this.pageId,this.contextToken,null==t?void 0:t.Id))}c.a.instance.reportSuccess(t)}catch(e){const n=m.a.getInstance().getEventParameters(this.contextToken);throw m.a.getInstance().reportFailure(t,e,null,n),e}n||Object(g.h)(t,"pageName",e)}get taskProcess(){return c.a.instance.reportUsage("ClientApi.XrmNavigableFormUi.taskProcess"),this}}var f=n("SAYH"),S=n("n6Qt"),v=n("deGN"),C=n("G0J3"),O=n("504W");let _;class I extends C.a{constructor(e,t,n,i,a){super(e,t&&t.etn,i,a,e=>10===e||12===e?y:u.a,n);const s=[{name:"pageId",value:a,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];this._clientApiExecutorForm=new r.a(e,"ClientApi.XrmForm.",a,i,s),_=e,this._entityReference=t}get applicationContext(){return this._applicationContext}set applicationContext(e){this._applicationContext=e}get context(){try{return c.a.instance.reportCall("ClientApi.XrmForm.context"),c.a.instance.reportSuccess("ClientApi.XrmForm.context"),this._globalContext}catch(e){throw this._reportFailure("ClientApi.XrmForm.context",e)}}set context(e){this._globalContext=e}get entityReference(){return this._clientApiExecutorForm.execute("entityReference_get",()=>({id:f.a.externalGuid(this._entityReference.id),entityType:this._entityReference.etn}))}get data(){try{if(c.a.instance.reportCall("ClientApi.XrmForm.data"),!this._data){let e;const t=Object(a.l)(_.getState(),this.pageId);t!==l.a.Dialog&&t!==l.a.ModalDialog&&this._entityReference&&(e=new s.a(_,this.contextToken,this.pageId,this,this._entityReference.etn,this._entityReference.id,j,this._applicationContext)),this._data=new o.a(_,this.contextToken,this.pageId,this,e)}return c.a.instance.reportSuccess("ClientApi.XrmForm.data"),this._data}catch(e){throw this._reportFailure("ClientApi.XrmForm.data",e)}}getAttribute(e){return this._clientApiExecutorForm.execute("getAttribute",()=>{var t,n;let r=null;return this.data&&this.data.entity&&(r=this.data.entity.attributes.get(e)),r?Object(O.a)(e)&&(r=r.concat(this.data.attributes.get(e))):r=null===(n=null===(t=this.data)||void 0===t?void 0:t.attributes)||void 0===n?void 0:n.get(e),r})}getUrl(e){try{c.a.instance.reportCall("ClientApi.XrmForm.getUrl");let t=null,n=null;if(this.contextToken.parentContextToken){const e=this.data.entity.getEntityReference(),r={entityTypeName:e.entityType,etn:e.name,id:f.a.fromExternalGuid(e.id)};t=l.a.EditForm,n=r}else t=Object(a.l)(_.getState(),this.pageId),n=Object(a.g)(_.getState(),this.pageId);switch(t){case l.a.EditForm:{const e=new S.a(_,this.applicationContext,this.context,this.pageId);n={entityTypeName:n.entityTypeName,etn:n.etn,id:n.id,entityTypeCode:e.getEntityCode(n.entityTypeName),languageId:this._globalContext.userSettings.languageId,recordSetQueryKey:n.recordSetQueryKey};break}case l.a.Grid:{const e=new S.a(_,this.applicationContext,this.context,this.pageId);n={entityTypeName:n.entityTypeName,pageType:n.pageType,entityTypeCode:e.getEntityCode(n.entityTypeName)};break}}let r=null;if(1===e)r=_.dispatch(Object(i.a)(t,n));else{const e=Object(v.a)(_,this.pageId);r=_.dispatch(Object(i.c)(e,t,n))}return c.a.instance.reportSuccess("ClientApi.XrmForm.getUrl"),r}catch(e){throw this._reportFailure("ClientApi.XrmForm.getUrl",e)}}_reportFailure(e,t){const n=m.a.getInstance().getEventParameters(this.contextToken);return n.push({name:"entityName",value:this._entityReference.etn}),m.a.getInstance().reportFailure(e,t,null,n),t}}function j(e,t,n){const r=Object(d.bb)(_.getState(),n,t);return r||e.TraceManager.getTracer("ClientApi.XrmForm.getAttributeNames").error("Form attributes was null"),r}},tvJg:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="attribute.options.clear";function a(e,t,n){const a=Object(r.x)(t);return{type:i,payload:void 0,meta:{pageId:e,contextKey:a,dataFieldName:n}}}},uOtn:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l}));var r=n("Sbn7"),i=n("Zw8F"),a=n("y60j"),s=n("SAYH"),o=n("0nOn");let c;class l{constructor(e,t,n,r,s,l=a.n,u=i.a){this._formId=n,c=e,this._entityName=r,this._pageId=s,this._getSelectorItems=l,this._selectorItemType=u,this._clientApiExecutor=new o.a(e,"ClientApi.XrmControlFormSelector.",s,t)}get items(){return this._clientApiExecutor.execute("items_get",e=>{if(!this._items){this._items=new r.a(e);const t=this._getSelectorItems(c.getState(),this._entityName);if(t)for(const e in t){const n=t[e],r=n.name||n.DisplayName,i=new this._selectorItemType(new s.a(e),r,c,this._pageId);this._items.add(i.getId(),i)}}return this._items})}getCurrentItem(){return this._clientApiExecutor.execute("getCurrentItem",()=>{const e=this.items;for(let t=0;t<e.getLength();t++){const n=e.get(t);if(n.getId()===s.a.toString(this._formId))return n}return null})}}class u extends l{}},"uPT+":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));const r="powerbi.signedin.state";function i(e,t){return{type:r,payload:t,meta:{pageId:e}}}},ujVH:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var r=n("dHD5"),i=n("BFlg"),a=n("P6DH"),s=n("3hnk"),o=n("kWiz"),c=n("WePp"),l=n("qLnS");const u="dataset.dependentoptionset.column.status";function d(e,t){const n=[];return{type:"dependentoptionset.column.status",sync:!0,execute({dispatch:s,getState:l},d,m){const b=d.TraceManager.getTracer(i.z),y=i.x+".SetDependentOptionSetColumnStatusAction";d.TraceManager.setLogLevel(o.a.Info,y);try{const i=Object(r.v)(t),o=l();let f=null;const S=Object(a.Q)(l(),e,t),v={};if(S)f=S;else{const n=Object(a.S)(l(),{id:e},t);n&&n.entityLogicalName&&(f=n.entityLogicalName)}if(f){n.push({name:"CorrelationId",value:m.correlationId},{name:"ContextId",value:m.contextId},{name:"ActionStack",value:m.stack},{name:"PageId",value:e},{name:"EntityTypeName",value:f}),b.info("Executing initialize dependent option set column status action in grid.",n);const r={name:"NumPartialDependentOptionSetChainAttributesInGrid",value:0},i=[];let s=0;const l=Object(a.z)(o,t,f,e);for(const n in l){const a=l[n];if(null===a.ParentPicklistLogicalName){const a={name:n,value:0};p(o,t,e,f,l,n,a)?h(l,n,v,r):(g(l,n,v),s++,i.push(a))}else void 0===l[a.ParentPicklistLogicalName]&&h(l,n,v,r)}const u={name:"NumCompleteDependentOptionSetChainsInGrid",value:s},S={name:"CompleteChainsMaxDepthInGrid",value:i};n.push(u,r,S);const C=new c.a(y);C.addEventParameter("NumCompleteDependentOptionSetChainsInGrid",s),C.addEventParameter("NumPartialDependentOptionSetChainAttributesInGrid",r.value),C.addEventParameter("CompleteChainsMaxDepthInGrid",i),d.EventManager.ReportEvent(C),d.EventManager.ReportComponentSuccess(y),b.info("Executed initialize dependent option set column status action successfully.",n)}Object.keys(v).length>0&&s(function(e,t,n){return{type:u,payload:n,meta:{pageId:e,dataSetContextKey:t}}}(e,i,v))}catch(e){const t="creating dependent option set column status node in state tree failed.";d.EventManager.ReportComponentFailure(y,Error(t))}}}}function p(e,t,n,r,i,a,o){if(void 0===i[a])return!0;if(function(e,t,n,r,i){if(!Object(s.f)(e,i,r,l.a.CanUpdate)||!n[r].IsValidForUpdate)return!0;return!1}(e,0,i,a,r))return!0;const c=i[a].ChildPicklistLogicalNames;if(null!==c)for(let s=0;s<c.length;s++){const l={name:a,value:0};if(p(e,t,n,r,i,c[s],l))return!0;o.value=Math.max(o.value,l.value)}return o.value=o.value+1,!1}function h(e,t,n,r){if(void 0===e[t])return;n[t]=0,r.value=r.value+1;const i=e[t].ChildPicklistLogicalNames;if(i)for(let t=0;t<i.length;t++)h(e,i[t],n,r)}function g(e,t,n){n[t]=1;const r=e[t].ChildPicklistLogicalNames;if(r)for(let t=0;t<r.length;t++)g(e,r[t],n)}},"wBG+":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("i1f0"),i=n("RrRQ"),a=n("dHD5");function s(e){return{type:"form.cancel.async",execute({dispatch:t,getState:n}){const s=Object(a.j)(n(),e),o=Object(r.ac)(n(),e,s);return t(Object(i.c)(e,o,s)),Promise.resolve()}}}},wFY3:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="polite",i="assertive"},wZxB:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var r=n("4r2D"),i=n("SAYH"),a=n("iZ7K"),s=n("FZDd"),o=n("pEXn"),c=n("Nb1E"),l=n("fU7K");const u=o.b.AdvancedFindLookupResolverParameters;function d(e,t,n){const c=[];return{type:"advancedFind.lookup.retrieve.async",execute({dispatch:l,getState:d},p,g){const m=new r.a(i.a.newGuid().guid,g&&g.isPreloadCall);c.push({name:o.b.ActionType,value:"advancedFind.lookup.retrieve.async"},{name:o.b.ClientRequestId,value:m.RequestId()},{name:u.PrimaryEntity,value:e},{name:u.Targets,value:t.join(",")});const b=t.reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:[]}),{});return l(Object(s.e)(b)).then(()=>{const e=function(e,t,n,r){return(i,s)=>{const o=Object(a.h)(n,s);if(!o||!o.EntityLogicalName||!o.PrimaryNameAttribute)return r.push({name:u.EntityMetadataUnavailable,value:s}),i;const c=`<fetch version="1.0" mapping="logical" no-lock="false"><entity name="${o.EntityLogicalName}"><attribute name="${o.PrimaryNameAttribute}"/><attribute name="${o.PrimaryIdAttribute}"/><order attribute="${o.PrimaryNameAttribute}" descending="false" /><filter type="or"><condition attribute="${o.PrimaryNameAttribute}" operator="like" value="%${t||""}%" /></filter></entity></fetch>`,l=h(e,o,c,r);return i.push(l),i}}(l,n,d(),c),r=t.reduce(e,[]);return Promise.all(r).then(e=>Promise.resolve([].concat(...e)))})},getSuccessParameters:()=>c,getFailureParameters:(e,t)=>c}}function p(e,t,n){const c=[];return{type:"advancedFind.lookup.retrieve.by.id.async",execute({dispatch:l,getState:d},p,g){const m=new r.a(i.a.newGuid().guid,g&&g.isPreloadCall);c.push({name:o.b.ActionType,value:"advancedFind.lookup.retrieve.async"},{name:o.b.ClientRequestId,value:m.RequestId()},{name:u.PrimaryEntity,value:e},{name:u.Targets,value:t.join(",")});const b=t.reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:[]}),{});return l(Object(s.e)(b)).then(()=>{const e=function(e,t,n,r){return(i,s)=>{const o=Object(a.h)(n,s);if(!o||!o.EntityLogicalName||!o.PrimaryNameAttribute)return r.push({name:u.EntityMetadataUnavailable,value:s}),i;const c=t.filter(e=>!!e).map(e=>`<condition attribute="${o.PrimaryIdAttribute}" operator="eq" value="${e}" />`),l=`<fetch version="1.0" mapping="logical" no-lock="false"><entity name="${o.EntityLogicalName}"><attribute name="${o.PrimaryNameAttribute}"/><attribute name="${o.PrimaryIdAttribute}"/><order attribute="${o.PrimaryNameAttribute}" descending="false" /><filter type="or">${c}</filter></entity></fetch>`,d=h(e,o,l,r);return i.push(d),i}}(l,n,d(),c),r=t.reduce(e,[]);return Promise.all(r).then(e=>Promise.resolve([].concat(...e)))})},getSuccessParameters:()=>c,getFailureParameters:(e,t)=>c}}function h(e,t,n,r){const i="?fetchXml="+Object(l.CrmUrlEncode)(n);return new Promise((n,a)=>{e(Object(c.e)(t.EntityLogicalName,i,100)).then(e=>{const i=function(e,t){const n=[];t.value&&t.value.length>0&&t.value.forEach(t=>{n.push({id:t[e.PrimaryIdAttribute],displayName:t[e.PrimaryNameAttribute],entityLogicalName:(null==e?void 0:e.EntityLogicalName)||void 0,entityDisplayName:(null==e?void 0:e.DisplayName)||void 0})});return n}(t,e);r.push({name:u.RetrieveRequestSuccess,value:`Retrieve Seccuess for ${t.EntityLogicalName} Count: ${i.length}`}),n(i)},e=>{r.push({name:u.RetrieveRequestFail,value:`Failed to retrieve records for ${t.EntityLogicalName} Error: ${e}`}),n([])})})}},waMg:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="grid.updatequerykey";function a(e,t,n){const a=Object(r.y)(n),s=Object(r.v)(n);return{type:i,payload:e,meta:{pageId:t,contextKey:a,dataSetContextKey:s}}}},xorU:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"f",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return l}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="controls.addCustomFilter",a="controls.startCustomFilter",s="controls.endCustomFilter";function o(e,t,n,a,s){const o=Object(r.v)(a);return{type:i,payload:{customFilter:s,entityLogicalName:n},meta:{pageId:e,controlName:t,contextKey:o}}}function c(e,t,n){const i=Object(r.v)(n);return{type:a,payload:{},meta:{pageId:e,controlName:t,contextKey:i}}}function l(e,t,n){const i=Object(r.v)(n);return{type:s,payload:{},meta:{pageId:e,controlName:t,contextKey:i}}}},y3FQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return R})),n.d(t,"b",(function(){return B}));var r=n("nuS9"),i=n("2YQW"),a=n("H/hG"),s=n("YWpA"),o=n("evW+"),c=n("u+q+"),l=n("i1f0"),u=n("arV0"),d=n("dHD5"),p=n("b8TU"),h=n("RiHV"),g=n("YxC/"),m=n("unFF"),b=n("IqkD"),y=n("H4dV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function f(){let e=null,t=null,n=null,r=null,i=null,a=null;return function(s,o){const c=Object(m.a)(s),l=function(e,t){const n=Object(p.c)(e);return n<t?n:t}(s,500),u=Object(p.b)(s),d=Object(p.c)(s),h=Object(b.g)(s);if(t!==c||n!==l||r!==u||i!==d||a!==h){t=c,n=l,r=u,i=d,a=h;const s=i<c.sizes.Breakpoints.DimensionS?"0px":c.sizes.Measures.Measure050,o=y.a.getInstance().get_IsBrowserIE();e={formButtonWrapperStyle:{marginTop:c.sizes.Measures.Measure125,marginLeft:0,marginRight:0,marginBottom:0,width:"100%",display:"flex",flex:"0 0 auto",flexDirection:i<c.sizes.Breakpoints.DimensionS?"column":"row",justifyContent:"flex-end",alignItems:"center"},saveAndCloseButtonStyle:Object.assign(Object.assign({},c.buttons.Button01Primary),{marginTop:0,marginBottom:0,marginLeft:0,width:i<c.sizes.Breakpoints.DimensionS?"100%":"auto"}),splitButtonStyle:{marginTop:0,marginBottom:0,marginLeft:0,fontSize:"14px",fontStyle:"normal",fontFamily:c.fontFamilies.Normal,width:i<c.sizes.Breakpoints.DimensionS?"100%":"auto",borderColor:"transparent",height:c.sizes.Measures.Measure250,paddingLeft:c.sizes.Measures.Measure100,paddingRight:c.sizes.Measures.Measure100},splitStyle:{width:i<c.sizes.Breakpoints.DimensionS?"100%":"auto"},splitButtonMenuStyle:{marginTop:0,marginBottom:0,marginLeft:0,fontSize:"14px",fontStyle:"normal",fontFamily:c.fontFamilies.Normal,width:"32px",minWidth:"32px",height:c.sizes.Measures.Measure250,flexDirection:o?"column":"inherit"},customSplitButtonStyles:{splitButtonMenuButton:{backgroundColor:"#4979B2",height:c.sizes.Measures.Measure250},root:{backgroundColor:"#4979B2"}},cancelButtonStyle:Object.assign(Object.assign({},c.buttons.Button01Secondary),{marginTop:i<c.sizes.Breakpoints.DimensionS?c.sizes.Measures.Measure050:0,marginLeft:h?void 0:s,marginRight:h?s:void 0,paddingLeft:c.sizes.Measures.Measure100,paddingRight:c.sizes.Measures.Measure100,width:i<c.sizes.Breakpoints.DimensionS?"100%":"auto"}),saveAndCloseButtonLabelStyle:Object.assign(Object.assign({},c.buttons.ButtonPrimaryText),{width:"100%",margin:"0 auto",maxWidth:"100%",cursor:"pointer"}),cancelButtonLabelStyle:Object.assign(Object.assign({},c.buttons.ButtonSecondaryText),{width:"100%",maxWidth:"100%",margin:"0 auto",cursor:"pointer"})}}return e}}var S=n("9gu/"),v=n("FdXt"),C=n("Afz2"),O=n("bq0x"),_=n("bT7G"),I=n("HhsT"),j=n("3/02"),P=n("Lyxw"),F=n("1yY9"),T=n("2Sll"),w=n("Mjry"),E=n("3rse"),x=n("cGlR");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const N={flexDirection:"row",justifyContent:"flex-end",width:"100%"},A={display:"flex",alignItems:"center",justifyContent:"center"},k={position:"relative",borderLeft:"1px solid white",right:"100%",height:"19px"},M=({primaryButtonProps:e,menuButtonProps:t,viewStyles:n,separatorStyles:i})=>r.createElement(s.a,{key:"_splitButtonView",style:Object.assign(Object.assign({},N),n)},r.createElement(x.a,Object.assign({key:e.id||"primaryButtonKey","data-id":e.dataId},e)),r.createElement(s.a,{key:"_splitButtonMenuView",style:Object.assign({},A)},r.createElement(x.a,Object.assign({key:t.id||"menuButtonKey","data-id":t.dataId},t)),r.createElement(s.a,{style:Object.assign(Object.assign({},k),i)})))
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */;class D extends r.Component{constructor(e){super(e),this._onCancelButtonClick=this._onCancelButtonClick.bind(this),this._onSaveAndCloseButtonClick=this._onSaveAndCloseButtonClick.bind(this),this._onSaveAndNewButtonClick=this._onSaveAndNewButtonClick.bind(this)}render(){return r.createElement(s.a,{semanticTag:"section",style:this.props.formButtonWrapperStyle,role:C.r,className:"dialogButtons"},this.props.quickCreateSplitButtonEnabled?this._renderSplitButton():this._renderSaveAndCloseButton(),this._renderCancelButton())}_renderSplitButton(){const e=Object(g.c)(this.props.resourceStrings,v.f),t=Object(g.c)(this.props.resourceStrings,v.e),n=Object(g.c)(this.props.resourceStrings,v.b),i=Object(g.c)(this.props.resourceStrings,v.e)+" "+Object(g.c)(this.props.resourceStrings,v.d);Object(T.a)();const a=y.a.getInstance().get_IsBrowserIE(),s={primary:!0,id:"quickCreateSaveAndCloseBtn",dataId:"quickCreateSaveAndCloseBtn",text:t,styles:this.props.customSplitButtonStyles,ariaLabel:t,accessKey:"S",style:this.props.splitButtonStyle,onClick:this._onSaveAndCloseButtonClick,tabIndex:0,disabled:this.props.isSaving},o=Object.assign({primary:!0,styles:this.props.customSplitButtonStyles,ariaLabel:i,ariaRoleDescription:i,role:C.d,splitButtonAriaLabel:n,dataId:"quickCreateSaveAndNewBtn",id:"quickCreateSaveAndNewBtn",style:this.props.splitButtonMenuStyle,tabIndex:0,menuTriggerKeyCode:E.a.Space,menuProps:{directionalHint:w.a.topAutoEdge,items:[{key:"saveandnew",text:e,accessibilityLabel:e,style:{":hover":{backgroundColor:"#D8D8D8"},textAlign:"center"},onClick:this._onSaveAndNewButtonClick}]}},a?{menuIconProps:{style:{position:"absolute",top:0,left:0,transform:"translate(50%, 50%)"}}}:{});return r.createElement(M,{primaryButtonProps:s,menuButtonProps:o})}_renderSaveAndCloseButton(){const e=Object(g.c)(this.props.resourceStrings,v.e);return r.createElement(o.a,{testhooks:{id:"quickCreateSaveAndCloseBtn",[h.a.LearningPathDOMAttributeSuffix]:"quick-create|quickCreateSaveAndCloseBtn"},id:"quickCreateSaveAndCloseBtn",accessKey:"S",ref:"quickCreateSaveAndCloseBtn",onClick:this._onSaveAndCloseButtonClick,disabled:this.props.isSaving,accessibilityLabel:e,style:this.props.saveAndCloseButtonStyle},r.createElement(a.a,{style:this.props.saveAndCloseButtonLabelStyle},e))}_renderCancelButton(){const e=Object(g.c)(this.props.resourceStrings,v.a);return r.createElement(o.a,{id:B(this.props.id),testhooks:{id:"quickCreateCancelBtn",[h.a.LearningPathDOMAttributeSuffix]:"quick-create|quickCreateCancelBtn"},ref:"quickCreateCancelBtn",accessKey:"C",onClick:this._onCancelButtonClick,disabled:this.props.isSaving,accessibilityLabel:e,style:this.props.cancelButtonStyle},r.createElement(a.a,{style:this.props.cancelButtonLabelStyle},e))}_onSaveAndCloseButtonClick(){this.props.saveAndCloseForm()}_onSaveAndNewButtonClick(){this.props.saveFormAndNew(this.props.pageInput)}_onCancelButtonClick(e){this.props.cancelForm(this.props.output)}}D.displayName="QuickCreateFormFooter";const R=Object(c.a)((function(){const e=f(),t=Object(l.dd)(),n=Object(g.h)();let r=null;return function(a,s){const o=Object(d.j)(a,s.id),c=Object(P.a)(a,j.cd);Object(i.e)(r,o)||(r=o);const h=Object(u.g)(a,s.id),g=Object(l.mb)(a,s,r),m=t(a,{id:s.id,contextToken:o}),b=Object(p.c)(a),y=e(a,Object.assign(Object.assign({},s),{viewPortWidth:b,hasFooterFields:m&&m.length>0})),f=Object(O.a)(a,s.id),S=n(a,v.h),C=Object(l.ac)(a,s.id,r),I=Object(_.g)(a,C);return{isSaving:g,splitStyle:y.splitStyle,formButtonWrapperStyle:y.formButtonWrapperStyle,saveAndCloseButtonStyle:y.saveAndCloseButtonStyle,cancelButtonStyle:y.cancelButtonStyle,splitButtonMenuStyle:y.splitButtonMenuStyle,customSplitButtonStyles:y.customSplitButtonStyles,saveAndCloseButtonLabelStyle:y.saveAndCloseButtonLabelStyle,splitButtonStyle:y.splitButtonStyle,cancelButtonLabelStyle:y.cancelButtonLabelStyle,pageInput:h,contextToken:r,resourceStrings:S,output:f,formDirty:I,quickCreateSplitButtonEnabled:c}}}),(function(e,t){return{saveAndCloseForm:()=>{e(Object(I.a)(t.id))},cancelForm:n=>{e(Object(S.a)(t.id,n))},saveFormAndNew:n=>{e(Object(F.a)(n,t.id))}}}))(D);function B(e){return"quickCreateCancelBtn"+e}},yUiV:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("Qjw6"),i=n("8KYF"),a=n("2YQW");var s=n("9XdG"),o=n("cfbi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let c;function l(e,t){const l=Object(s.a)();c||(c=function(e){return Promise.resolve().then(n.bind(null,"8KYF")).then(t=>{if(t){const n=Object.assign(Object.assign({},e.currentReducerMap),{formInstances:t.formInstancesReducer});e.replaceReducer(Object(a.a)(n)),e.currentReducerMap=n}})}(l));const u=r.a.createPageModule(e);return c.then(()=>l.dispatch(r.a.preInitializePage(t,e)).then(n=>u.then(r=>{if(r){l.dispatch(function(e,t,n){return{type:i.CREATE_FORM_INSTANCE,payload:{currentPage:e,error:null,input:n,__pageName:o.a},meta:{pageId:t}}}(r,e,t));const a=r.getInitializationAction(n);return l.dispatch(a)}})))}},yl9a:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="control.setSrc";function a(e,t,n,a){const s=Object(r.v)(n);return{type:i,payload:{Url:a,isCustomSrc:!0},meta:{pageId:e,controlName:t,contextKey:s}}}},ynyB:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n("H4dV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="0.3s",a=r.a.getInstance().get_IsBrowserIE()?void 0:"transform 0.25s linear",s=a+",opacity 0.25s linear"},yq1L:function(e,t,n){"use strict";n.d(t,"a",(function(){return A})),n.d(t,"b",(function(){return k}));var r=n("arV0"),i=n("EY5k"),a=n("OWbt"),s=n("XVX7"),o=n("33Bq"),c=n("dHD5"),l=n("MktZ"),u=n("f/sd"),d=n("y60j"),p=n("8nT0"),h=n("ZFRl"),g=n("Or4W"),m=n("O7zD"),b=n("lY/Z"),y=n("SAYH"),f=n("iZ7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function S(e,t,n,r,i){!function(e,t,n){const r=Object(f.h)(e,t);r&&n.push({name:"IsCustomEntity",value:r.IsCustomEntity},{name:"IsActivityEntity",value:r.IsActivity})}(e,r,i),function(e,t,n,r){const i=Object(d.d)(e,n,t);if(i){const e=Object.keys(i);r.push({name:"NumControls",value:e.length})}}(e,t,n,i)}var v=n("Uv1Y"),C=n("E8F2"),O=n("pp6D"),_=n("i1f0"),I=n("Bo7t"),j=n("TBkx"),P=n("ldGr"),F=n("3/02"),T=n("Lyxw"),w=n("zmL5"),E=n("g6bs"),x=n("XVSa"),N=n("wL2W");function A(e,t){return n=>M(e,t,n,"initialize.quickCreateFormAction.async")}function k(e,t){return M(e,t,null,"initialize.quickCreateFormActionsaveandnew.async")}function M(e,t,n,f){const A=[{name:"RemoveScriptContainer",value:t}];return{type:f,execute({dispatch:k,getState:M},D,R){const B=M(),L=Object(r.g)(B,e),{entityTypeName:V,formId:z,id:H}=L,G=D.TraceManager.getTracer("Forms.QuickCreate.InitializeAction");A.push({name:"CorrelationId",value:R.correlationId},{name:"ContextId",value:R.contextId},{name:"ActionStack",value:R.stack},{name:"InitialFormId",value:y.a.toString(z)},{name:"EntityName",value:V},{name:"PageId",value:e},{name:"updatedFormId",value:y.a.toString(n&&n.updatedFormId)}),G.info("_initializeAction started.",A);const W=Object(c.j)(B,e);if(t){D.ScriptManager.removeContainer(e,!0)}const U=function(e,t,n,r,i,a,s){if(s){const e=Object(w.b)(i,a);return r.push({name:"skippedPreInitCodePath",value:s},{name:"newFormId",value:y.a.toString(e)}),e}if(r.push({name:"preInitResult",value:JSON.stringify(e)}),!e){const e="PreInitResult during QuickCreateForm is invalid for entity '"+t+"'";throw n.error(e,r),new v.a(e)}if(e.error)throw e.error;const o=e.updatedFormId;if(!o||y.a.equals(o,y.a.EMPTY)){const e="Form descriptor is null or not defined";throw n.error(e,r),new v.a(e)}return r.push({name:"newFormId",value:y.a.toString(o)}),o}(n,V,G,A,B,e,"initialize.quickCreateFormActionsaveandnew.async"===f);G.info("parallelizablePromises started.",A);return function(e,t,n,r,s,c,l,u,d,p,h,m){h.info("retrieveResourceStrings started.",m);const b=e(Object(i.e)(o.d)).then(()=>{h&&(m.push({name:"RetrievedResourceStringsTimeStamp",value:Date.now()}),h.info("retrieveResourceStrings completed.",m))}).catch(e=>{m.push({name:"loadResourceStringsPromise.Reason",value:Object(j.e)(e)}),Object(v.b)(e)});h&&h.info("initializeContainerForClientApi started.",m);const y=u.ScriptManager.initializeContainerForClientApi(r).then(()=>{h&&h.info("initializeContainerForClientApi completed.",m),e(Object(O.b)(n,r,p,s))}).catch(e=>{m.push({name:"initializeClientApiContainerPromise.Reason",value:Object(j.e)(e)}),Object(v.b)(e)});h&&h.info("checkEntityEnabledForUCI started.",m);const f=Object(a.e)(t,e,h,l,s,p,r).then(()=>{h&&h.info("checkEntityEnabledForUCI completed.",m)}).catch(e=>{m.push({name:"checkEntityEnabledForUCIPromise.Reason",value:Object(j.e)(e)}),Object(v.b)(e)});h&&h.info("loadFormDependencies started.",m);const S=e(Object(g.c)(c,p)).then(()=>{h&&h.info("loadFormDependencies completed.",m)}).catch(e=>{m.push({name:"loadFormDependencies.Reason",value:Object(j.e)(e)}),Object(v.b)(e)}),C=Object(E.c)(t(),e,u,p,h,m);return Promise.all([b,y,f,S,C])}(k,M,W,e,H,U,R,D,0,V,G,A).then(()=>(G.info("parallelizablePromises completed.",A),k(Object(a.h)(U,e,W)).then(()=>{const t=Object(d.j)(M(),U),n=Object(_.N)(M(),U);k(Object(I.b)(e,W,n)),G.info("retrieveRecordDataForOrganization started.",A);return k(Object(b.f)(t.FormLibraries)).then(()=>{G.info("retrieveRecordDataForOrganization completed.",A),k(Object(s.a)(!0,e,W))}).then(()=>{const n=[p.q,p.u,p.v,p.w];Object(a.c)(M(),k,V,e,n,t.Attributes,W,G,A)}).then(()=>(Object(T.c)(M(),F.L)&&k(Object(P.c)(V,e,W)),Object(T.c)(M(),F.nd)&&k(Object(l.b)(e,u.a.OnLoadReady)),Object(a.i)(M(),D,k,U,W,e,G,A))).catch(e=>{A.push({name:"retrieveRecordDataForOrganization.Reason",value:Object(j.e)(e)}),Object(v.b)(e)})}).catch(e=>{A.push({name:"initializeForm.Reason",value:Object(j.e)(e)}),Object(v.b)(e)}))).catch(e=>{A.push({name:"initializeActionPromise.Reason",value:Object(j.e)(e)}),Object(v.b)(e)}).then(()=>{S(M(),e,z,V,A),D.EventManager.ReportComponentSuccess("Forms.QuickCreate.InitializeAction",A),G.info("_initializeAction completed.",A),k(Object(l.b)(e,u.a.FullLoad));const t=Object(m.c)(e,V,M(),W);t&&k(Object(h.c)(e,t)),function(e,t,n,r){Object(N.a)()&&e(Object(x.a)(t,n,r))}(k,e,W,V)}).catch(t=>{S(M(),e,z,V,A),Object(C.h)(M(),e,t,A,D,"Forms.QuickCreate.InitializeAction"),Object(v.b)(t)})},getFailureParameters:(e,t)=>(Object(C.a)(e,A),A)}}},ywwS:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n("0nOn"),i=n("P6DH"),a=n("HcnX"),s=n("AbXy"),o=n("FETf"),c=n("LE5i"),l=n("16wZ"),u=n("NAAR"),d=n("qshH"),p=n("HAeo"),h=n("ghNp"),g=n("dHD5"),m=n("ZIjf"),b=n("FZDd"),y=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const f="ClientApi.XrmControlTimeline.";let S;class v extends a.a{constructor(e,t,n,i,a,s,o,c){super(e,t,n,i,a,o),this._defaultLabel=u.u.Timeline,S=e,this._applicationContext=c,this._controlId=s,this._traceManager=c.TraceManager,this._subgridToken=Object(g.p)(t,a),this._clientApiExecutorTimeline=new r.a(e,f,n,t),this._clientApiExecutorTimeline.addEventParameter({name:"controlName",value:a,isEventParam:!0,expectedDataType:"string"}),this._clientApiExecutorTimeline.addEventParameter({name:"controlId",value:s,isEventParam:!0,expectedDataType:"string"}),this._gridControl=new p.a(e,this._subgridToken,n,!1,3,!0,c,a),e.dispatch(Object(h.a)(this,n,this._subgridToken))}getControlType(){return m.a.instance.reportUsage(f+"getControlType"),"timelinewall"}getName(){return this.clientApiExecutor.execute("getName",()=>this.controlDescriptor&&this.controlDescriptor.Parameters&&this.controlDescriptor.Parameters[u.s.UClientUniqueName]?this.controlDescriptor.Parameters[u.s.UClientUniqueName]:u.u.Timeline)}getLabel(){const e=f+"getLabel";try{m.a.instance.reportCall(e);const t=this.controlDescriptor&&this.controlDescriptor.Parameters&&!Object(l.a)(this.controlDescriptor.Parameters[u.s.Label])?this.controlDescriptor.Parameters[u.s.Label]:this._defaultLabel?this._defaultLabel:"";return m.a.instance.reportSuccess(e),t}catch(t){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,n),t}}setLabel(e){const t=f+"setLabel";try{m.a.instance.reportCall(t),super.setLabel(e),this.controlDescriptor&&this.controlDescriptor.Parameters?this.controlDescriptor.Parameters[u.s.Label]=e:this._defaultLabel=e,m.a.instance.reportSuccess(t)}catch(e){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(t,e,null,n),e}}openEmail(e){const t=f+"openEmail";try{m.a.instance.reportCall(t),S.dispatch(Object(o.t)(this._controlId,e)),S.dispatch(Object(o.o)(this._controlId,c.a.ContextualDialogEntity,2,y.a.toString(y.a.newGuid()))),m.a.instance.reportSuccess(t)}catch(e){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(t,e,null,n),e}}refresh(e){let t=f+"refresh";e&&e.modules&&(t+="-modules"),e&&e.activities&&(t+="-activities");try{m.a.instance.reportCall(t),e&&this.controlDescriptor&&this.controlDescriptor.Parameters&&(e.modules&&(this.controlDescriptor.Parameters[u.s.UClientModules]=e.modules),e.activities&&(this.controlDescriptor.Parameters[u.s.UClientActivities]=e.activities)),S.dispatch(Object(o.o)(this._controlId,c.a.InitiateRefresh,1,y.a.toString(y.a.newGuid()))),m.a.instance.reportSuccess(t)}catch(e){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(t,e,null,n),e}}setTargetEntity(e,t,n=!0){const r=f+"setTargetEntity";try{m.a.instance.reportCall(r);const i={etn:e,id:t,isAPI:!0},a={};return a[e]=[],S.dispatch(Object(o.v)(this._controlId,i)),S.dispatch(Object(b.e)(a)).catch(t=>{const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),n.push({name:"entityName",value:e}),d.a.getInstance().reportFailure(r+"-retrieveEntities",t,null,n),t}).then(()=>{n&&S.dispatch(Object(o.o)(this._controlId,c.a.InitiateRefresh,1,y.a.toString(y.a.newGuid()))),m.a.instance.reportSuccess(r)})}catch(e){const t=d.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(r,e,null,t),e}}getGrid(){const e=f+"getGrid";try{return m.a.instance.reportCall(e),this._grid||(this._grid=new s.a(S,this._applicationContext,this._subgridToken,this.pageId,this.getEntityName(),!1,this.name)),m.a.instance.reportSuccess(e),this._grid}catch(t){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,n),t}}getRecordSetQueryKey(){return this.clientApiExecutor.execute("getRecordSetQueryKey",()=>Object(i.cb)(S.getState(),this._subgridToken,{id:this.pageId}))}getGridType(){return m.a.instance.reportUsage(f+"getGridType"),3}getRollupType(){return this.clientApiExecutor.execute("getRollupType",()=>Object(i.eb)(S.getState(),this.pageId,this.contextToken))}getParentForm(){const e=f+"getParentForm";try{m.a.instance.reportCall(e);const t=this._gridControl.getParentForm();return m.a.instance.reportSuccess(e),t}catch(t){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,n),t}}refreshRibbon(){const e=f+"refreshRibbon";try{m.a.instance.reportCall(e),this._gridControl.refreshRibbon(),m.a.instance.reportSuccess(e)}catch(t){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,n),t}}getEntityName(){return m.a.instance.reportUsage(f+"getEntityName"),"activitypointer"}getUrl(){const e=d.a.getInstance().getEventParameters(this.contextToken);return e.push({name:"controlName",value:this.getName()}),e.push({name:"validationError",value:"true"}),this._traceManager.getTracer("ClientApi.XrmControlTimeline.getUrl").warn("Not Supported in Timeline control",e),m.a.instance.reportUsage("ClientApi.XrmControlTimeline.getUrl"),""}getFilterXml(){const e=f+"getFilterXml",t=d.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),m.a.instance.reportUsage(e),""}getFetchXml(){const e=f+"getFetchXml",t=d.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),m.a.instance.reportUsage(e),""}getViewSelector(){const e=f+"getViewSelector",t=d.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),m.a.instance.reportUsage(e),null}getTeamTemplateId(){return null}getRelationship(){const e=f+"getRelationship",t=d.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),m.a.instance.reportUsage(e),null}setFilterXml(e){const t=f+"setFilterXml",n=d.a.getInstance().getEventParameters(this.contextToken);n.push({name:"controlName",value:this.getName()}),n.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",n),m.a.instance.reportUsage(t)}addOnLoad(e){const t=d.a.getInstance().getEventParameters(this.contextToken);t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer("ClientApi.XrmControlTimeline.addOnLoad").warn("Not Supported in Timeline control",t),m.a.instance.reportUsage("ClientApi.XrmControlTimeline.addOnLoad")}removeOnLoad(e){const t=f+"removeOnLoad",n=d.a.getInstance().getEventParameters(this.contextToken);n.push({name:"controlName",value:this.getName()}),n.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",n),m.a.instance.reportUsage(t)}openRelatedGrid(){const e=f+"openRelatedGrid",t=d.a.getInstance().getEventParameters(this.contextToken);t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),m.a.instance.reportUsage(e)}}},z5LE:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));var r=n("jRy5"),i=n("dHD5"),a=n("ApeL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="attribute.notification.update";function o(e,t,n,o,c){return{type:"attribute.notification.add.clear.form.notification",sync:!0,execute(e,l){e.dispatch(function(e,t,n,o){if(o&&o.contextTokenType&&o.contextTokenType===r.a.GridRow)return Object(a.d)(e,o,t,n);const c=Object(i.x)(o);return{type:s,payload:n,meta:{pageId:e,contextKey:c,dataFieldName:t}}}(t,n,o,c))}}}},z8iZ:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return{Title:e&&e.Title||null,Legend:e&&e.Legend||null,Area3DStyle:e&&e.Area3DStyle||null,AreaGradientStyle:e&&e.AreaGradientStyle||null,XAxes:e&&e.XAxes||null,YAxes:e&&e.YAxes||null,SeriesList:e&&e.SeriesList||null,SubTitle:e&&e.SubTitle||null,Colors:e&&e.Colors||null,DisplayMode:e&&e.DisplayMode||0,ErrorInformation:e&&e.ErrorInformation||null,EnableDrilldown:e&&e.EnableDrilldown||!0,Annotations:e&&e.Annotations||null}}n.d(t,"a",(function(){return r}))},zFtG:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n("dHD5"),i=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="dataset.update.pagingdata";function s(e,t,n){return{type:"dataset.update.pagingdata.async",execute({dispatch:s,getState:o},c){const l=c.TraceManager.getTracer(i.z),u=i.x+".updatePagingDataAction";try{return l.info("Updating the paging data for the grid."),s(function(e,t,n){const i=Object(r.y)(t),s=Object(r.v)(t);return{type:a,payload:n,meta:{pageId:e,contextKey:i,dataSetContextKey:s}}}(e,t,n)),c.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){const t="Updation of paging data for the grid failed with error : "+e.message;c.EventManager.ReportComponentFailure(u,Error(t))}}}}},zgeC:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n("0nOn"),i=n("P6DH"),a=n("SAYH"),s=n("HcnX"),o=n("1kth"),c=n("dHD5"),l=n("meVR"),u=n("qshH"),d=n("+zjj"),p=n("w92Z"),h=n("whN/"),g=n("HAeo"),m=n("ghNp"),b=n("ZIjf"),y=n("IaGr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const f="ClientApi.XrmControlSubGrid.";let S;class v extends s.a{constructor(e,t,n,i,a,s,o,l){super(e,t,n,o,i,s),this._relationship=null,S=e,this._subgridToken=Object(c.p)(t,i),this._clientApiExecutorSubGrid=new r.a(e,f,n,this._subgridToken),this.clientApiExecutor.addEventParameter({name:"controlName",value:i,isEventParam:!0}),this.clientApiExecutor.addEventParameter({name:"isEditable",value:a,isEventParam:!0}),this._gridControl=new g.a(e,this._subgridToken,n,a,3,!0,l,i),e.dispatch(Object(m.a)(this,n,this._subgridToken))}get clientApiExecutor(){return this._clientApiExecutorSubGrid}setFilterXml(e){const t=f+"setFilterXml";try{b.a.instance.reportCall(t),this._gridControl.setFilterXml(e),b.a.instance.reportSuccess(t)}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,n),e}}getFilterXml(){const e=f+"getFilterXml";try{b.a.instance.reportCall(e);const t=this._gridControl.getFilterXml();return b.a.instance.reportSuccess(e),t}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,n),t}}refresh(){const e=f+"refresh";try{b.a.instance.reportCall(e),this._gridControl.refresh(),b.a.instance.reportSuccess(e)}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,n),t}}getFetchXml(){const e=f+"getFetchXml";try{b.a.instance.reportCall(e);const t=this._gridControl.getFetchXml();return b.a.instance.reportSuccess(e),t}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,n),t}}getGrid(){const e=f+"getGrid";try{b.a.instance.reportCall(e);const t=this._gridControl.getGrid();return b.a.instance.reportSuccess(e),t}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,n),t}}getViewSelector(){const e=f+"getViewSelector";try{b.a.instance.reportCall(e);const t=this._gridControl.getViewSelector();return b.a.instance.reportSuccess(e),t}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,n),t}}getTeamTemplateId(){const e=f+"getTeamTemplateId";try{b.a.instance.reportCall(e);const t=this._gridControl.getTeamTemplateId();return b.a.instance.reportSuccess(e),t}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(e,t,null,n),t}}addOnLoad(e){this.clientApiExecutor.execute("addOnLoad",()=>{S.dispatch(Object(o.d)(this._subgridToken,this.pageId,e,this.name))},[{name:"handler",value:e,isRequired:!0,isEventParam:!1}])}removeOnLoad(e){this.clientApiExecutor.execute("removeOnLoad",()=>{S.dispatch(Object(o.y)(this._subgridToken,this.pageId,e,this.name))},[{name:"handler",value:e,isRequired:!0,isEventParam:!1}])}getEntityName(){const e=f+"getEntityName";try{b.a.instance.reportCall(e);const t=this._gridControl.getEntityName();return b.a.instance.reportSuccess(e),t}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,n),t}}getControlType(){return this.clientApiExecutor.execute("getControlType",()=>{const e=Object(p.a)(S.getState(),this.controlDescriptor,this.pageId,this.contextToken);return e?"customsubgrid:"+e.Name:"subgrid"})}getRelationship(){return this.clientApiExecutor.execute("getRelationship",(e,t)=>{var n,r;if(!this._relationship){if(null===(r=null===(n=this.controlDescriptor)||void 0===n?void 0:n.Parameters)||void 0===r?void 0:r.RelationshipName){const e=this.controlDescriptor.Parameters.RelationshipName,t=this.controlDescriptor.Parameters.RelationshipRoleOrdinal,n=this.controlDescriptor.Parameters.TargetEntityType;this._relationship=Object(g.b)(e,n),this._relationship.roleType=t}this._relationship||(this._relationship=this._gridControl.getRelationship())}return this._relationship})}getRecordSetQueryKey(){return this.clientApiExecutor.execute("getRecordSetQueryKey",()=>Object(i.cb)(S.getState(),this._subgridToken,{id:this.pageId}))}getGridType(){return b.a.instance.reportUsage(f+"getGridType"),3}getRollupType(){return this.clientApiExecutor.execute("getRollupType",()=>Object(i.eb)(S.getState(),this.pageId,this.contextToken))}openRelatedGrid(){this.clientApiExecutor.executeAsync("openRelatedGrid",(e,t)=>{const n=this.getRelationship();if(!n)return y.a.getInstance().traceManager.getTracer(e).error("Can't open related grid: the relationship was not retrieved from the inner grid.",t),Promise.resolve(a.a.EMPTY);const r=Object(d.c)(S.getState(),this.pageId);let i=null;for(let e=0;e<r.length;e++)if(r[e].relationshipName===n.name){i=r[e];break}if(!i)return t.push({name:"relationshipName",value:n.name}),y.a.getInstance().traceManager.getTracer(e).error("Can't open related grid: no relationship was found with the specified name.",t),Promise.resolve(a.a.EMPTY);const s={id:i.id,title:i.title,entityName:this.getEntityName(),relationshipName:n.name,isSelected:!0,show:i.show},o=Object(c.a)(this._subgridToken.parentContextToken,n.name,n.roleType?1===n.roleType?h.a.Referencing:h.a.AssociationEntity:void 0);return S.dispatch(Object(l.a)(this.pageId,o,s))})}refreshRibbon(){const e=f+"refreshRibbon";try{b.a.instance.reportCall(e),this._gridControl.refreshRibbon(),b.a.instance.reportSuccess(e)}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,n),t}}getUrl(){const e=f+"getUrl";try{b.a.instance.reportCall(e);const t=this._gridControl.getUrl();return b.a.instance.reportSuccess(e),t}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,n),t}}getParentForm(){const e=f+"getParentForm";try{b.a.instance.reportCall(e);const t=this._gridControl.getParentForm();return b.a.instance.reportSuccess(e),t}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,n),t}}}}}]),window.bundleExecutionMarkers["scripts/modelformcomponent.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();