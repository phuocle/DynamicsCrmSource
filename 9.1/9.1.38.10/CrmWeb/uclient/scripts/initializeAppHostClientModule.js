(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/initializeAppHostClientModule.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[68],{sra9:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"a",(function(){return l}));var o=n("NjDY"),i=n("hAdb"),r=n("Lyxw"),s=n("3/02"),c=n("twWZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function a(e){return e.appHostClient.initialized}function u(e){return e.appHostClient.error}function d(e){const{geoName:t,isSovereignCloud:n}=Object(o.x)(e);if(Object(r.c)(e,s.yc))return"Test";switch(null==t?void 0:t.toUpperCase()){case"TIP":const t=Object(i.b)(e,"canvashostenv");switch(null==t?void 0:t.toUpperCase()){case"LOCAL":return"Local";default:return"Test"}case"USG":return"GccHigh";case"NA":if(n)return"Gcc";default:const o=Object(i.b)(e,"canvashostenv");switch(null==o?void 0:o.toUpperCase()){case"PREVIEW":return"Preview";case"INT":return"Int";case"PREPROD":return"Preprod";default:return"Prod"}}}function p(e){switch(d(e)){case"Local":return c.Endpoint.Local;case"Test":return c.Endpoint.Test;case"Int":return c.Endpoint.Int;case"Preprod":return c.Endpoint.Preprod;case"Gcc":return c.Endpoint.Gcc;case"GccHigh":return c.Endpoint.GccHigh;case"Preview":return c.Endpoint.Preview;default:return c.Endpoint.Prod}}function l(e){return e.appHostClient.bundleLoaded}},wge3:function(e,t,n){"use strict";n.r(t),n.d(t,"initializeAppHostClient",(function(){return h})),n.d(t,"getRootAppId",(function(){return v})),n.d(t,"getRootAppLogicalName",(function(){return b})),n.d(t,"runWindowOverrides",(function(){return m}));var o=n("hAdb"),i=n("7cfk"),r=n("P4TJ"),s=n("sra9"),c=n("eL04"),a=n("SAYH"),u=n("P+p9"),d=n("9eA9"),p=n("IqkD"),l=n("EY5k"),f=n("YxC/");function w(e){switch(e){case"error":return 2;case"success":return 1;case"warning":return 3;case"info":default:return 4}}function h(e){return{type:"apphostclient.initialize.async",async execute(t,n){var o,d,h;if(!n.AppHostClient){if(!Object(s.a)(t.getState())){const e=(h=t.getState(),Object(s.e)(h)+"/apphost/clientsdk?version=1");await n.AssetLoader.loadScript(e),t.dispatch({type:r.a,payload:!0})}const b=v(t.getState(),e),m={authMode:5,endpoint:Object(s.e)(t.getState()),_rootAppId:b,hostConfig:{correlationId:n.EventManager.getCurrentSessionId(),locale:Object(p.w)(t.getState()).formatInfoCultureName,source:"UCI"}};try{await function(e,t,n){let o;const i=new Promise((e,t)=>{o=setTimeout(()=>t({message:"PowerAppsHostingSdk.initializeAsync timed out"}),n)}),r=PowerAppsHostingSdk.initializeAsync(t).then(t=>{clearTimeout(o),e.AppHostClient=t});return Promise.race([r,i])}(n,m,9e4),n.AppHostClient.on("appHostClientErrorEvent",(d=t.dispatch,function(e){e&&e.errorInfo&&d(Object(c.b)({level:2,message:e.errorInfo.localizedMessage,id:a.a.newGuid().guid,type:2,showCloseButton:!0}))})),n.AppHostClient.on("appHostClientNotification",function(e){return function(t){if(t&&t.notificationInfo){const n=t.notificationInfo.timeoutInMilliSec,o=a.a.newGuid().guid;e(Object(c.b)({level:w(t.notificationInfo.notificationType),message:t.notificationInfo.message,id:o,type:2,showCloseButton:!0,onCloseHandler:t.notificationInfo.clickHandler})),n>0&&1e4!==n&&setTimeout(()=>{e(Object(u.b)(o))},n)}}}(t.dispatch)),t.dispatch({type:r.b,payload:{initialized:i.a.Initialized,error:void 0}})}catch(i){if(null===(o=null==i?void 0:i.errorInfo)||void 0===o?void 0:o.code)t.dispatch(g(i));else{const e="Crm.GenericErrorMessage",n=[e];t.dispatch(Object(l.e)(n)).then(()=>{const o=Object(f.e)(t.getState(),n);t.dispatch(g({errorInfo:{code:"unknown",localizedMessage:Object(f.c)(o,e),timestamp:Date.now(),description:(null==i?void 0:i.message)||"Unknown error occured while initializing apphostclient"}}))})}const r=[{name:"environment",value:Object(s.d)(t.getState())},{name:"appId",value:e}];throw n.EventManager.ReportComponentFailure("CustomPage.SharedAppHostInitialize",i,void 0,r),i}}}}}function g(e){return{type:r.c,payload:{initialized:i.a.Initialize_Failed,error:e}}}function v(e,t){return Object(o.e)(e,"rootAppId")||t}function b(e,t){return Object(o.b)(e,"appLogicalName")||t}function m(e){const t=e.TraceManager.getTracer("TrustedUCI");XMLHttpRequest=window.routedXHR;const n=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(){const e=arguments[0];let o=arguments[1];const i=arguments[2];if(!1===i){const e=[{name:"url",value:o}];t.error("Sync call attempted",e)}const r=arguments[1].indexOf("/webresources/");if(-1!==r){const e=o.slice(r+"/webresources/".length);o=`${Object(d.b)()}/api/data/v9.0/webresourceset?$filter=name eq '${e}'&$select=content`;const t=this.onload;this.onload=()=>{var e;try{const t=JSON.parse(this.responseText);this._responseText=atob(null===(e=null==t?void 0:t.value[0])||void 0===e?void 0:e.content)}catch(e){}t(this)}}-1===o.indexOf("https://")&&(o=Object(d.b)()+o),n.call(this,e,o)},window.fetch=e=>new Promise((t,n)=>{const o=new XMLHttpRequest;o.open(e.method,e.url),e.headers.forEach((e,t)=>{o.setRequestHeader(t,e)}),o.onload=function(){const e=204===o.status?null:o.response||o.responseText,n=new Headers;o.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach(e=>{const t=e.split(": ");n.append(t.shift(),t.join(": "))});const i=new Response(e,{status:o.status,statusText:o.statusText,headers:n});t(i)},o.onerror=function(){n("Error")},e.text().then(e=>{o.send(e)})})}}}]),window.bundleExecutionMarkers["scripts/initializeAppHostClientModule.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();