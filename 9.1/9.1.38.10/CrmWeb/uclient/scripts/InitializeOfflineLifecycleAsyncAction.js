(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/InitializeOfflineLifecycleAsyncAction.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[35,69],{"6u68":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var i=n("/D1P");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="offline.upsync.pending";function o(){const e={upSyncStatus:i.a.Pending};return{type:a,payload:e}}},"9bCE":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="offline.database.cleanup";function a(e){return{type:i,payload:{isDbCleanupNeeded:e}}}},"Eh/Y":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="offline.database.update";function a(e){return{type:i,payload:{existingDatabaseName:e}}}},QSjj:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="offline.disabled.entities.update";function a(e,t,n){return{type:i,payload:{offlineDisabledEntities:e,lastMetadataVersionUsedForValidation:t,offlineDisabledPrimaryEntities:n}}}},VKvO:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var i=n("/D1P");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="offline.upsync.completed";function o(){const e={upSyncStatus:i.a.Completed};return{type:a,payload:e}}},WTtv:function(e,t,n){"use strict";n.r(t),n.d(t,"initializeOfflineLifecycleAsyncAction",(function(){return I}));var i=n("Rj8P"),a=n("VKvO"),o=n("TBkx"),r=n("37s6"),c=n("SAYH"),s=n("zmAS"),f=n("e+ib"),l=n("Uv1Y"),u=n("9bCE"),O=n("Eh/Y"),b=n("Nzmy"),d=n("QSjj"),y=n("iOI1"),p=n("eZ32"),S=n("8CLP");var v=n("NjDY"),j=n("GL3b"),m=n("iF9X"),D=n("yRo8"),h=n("ml6Y"),g=n("8Mff");function P(){return{type:"offline.save.sessionstate",execute({getState:e},t){const n=e(),i=Object(r.p)(n),a={},s={},f={},l={},u=[];return i!==g.a.Disabled?(s[h.a.OfflineProfileIdKey]=c.a.toString(j.c(n)),s[h.a.OfflineProfileVersionKey]=j.d(n),s[h.a.OfflineProfileAvailableEntitiesKey]=j.b(n),a[h.a.norsyncServerConnectionStringKey]=m.c(n),a[h.a.isTrialOrganizationKey]=m.b(n).toString(),a[h.a.isMocaOfflineFCBEnabledKey]=m.a(n).toString(),b.c.info("Offline: OfflineSaveSessionState: Saving information to the session state:"+h.a.OfflineProfileDataKey),u.push(t.DataSource.saveSessionState(h.a.OfflineProfileDataKey,s,!1)),b.c.info("Offline: OfflineSaveSessionState: Saving information to the session state:"+h.a.offlineDatabaseInformationKey),u.push(t.DataSource.saveSessionState(h.a.offlineDatabaseInformationKey,a,!1))):(b.c.info("Offline: OfflineSaveSessionState: Clearing the Session State"),u.push(t.DataSource.deleteSessionState(h.a.OfflineProfileDataKey)),u.push(t.DataSource.deleteSessionState(h.a.offlineDatabaseInformationKey)),u.push(t.DataSource.deleteSessionState(h.a.OfflineEntityPluralNamesKey)),u.push(t.DataSource.deleteSessionState(h.a.OfflinePrimaryAvailableEntitiesKey)),u.push(t.DataSource.deleteSessionState(D.a))),l[h.a.isMobileOfflineOptedInKey]=i.toString(),b.c.info("Offline: OfflineSaveSessionState: Saving information to the session state:"+h.a.isMobileOfflineOptedInKey),u.push(t.DataSource.saveSessionState(h.a.isMobileOfflineOptedInKey,l,!1)),f[h.a.OfflineDatabaseKey]=Object(r.d)(n),b.c.info("Offline: OfflineSaveSessionState: Saving information to the session state:"+h.a.OfflineDatabaseKey),u.push(t.DataSource.saveSessionState(h.a.OfflineDatabaseKey,f,!1)),Promise.all(u).then(()=>(b.c.info("Offline: OfflineSaveSessionState: SaveMobileofflineInformation: Complete"),Promise.resolve())).catch(e=>(b.c.error("Offline: OfflineSaveSessionState: SaveMobileofflineInformation: Failed"+Object(o.e)(e)),Promise.reject(e)))}}}var _=n("504W"),w=n("69Qu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function E(e,t,n,a,o){const s=Object(v.m)(t),u=Object(j.e)(t),O=Object(r.p)(t),d=Object(j.c)(t);s&&O!==g.a.Disabled&&(d&&d!==c.a.EMPTY&&u?(O===g.a.Default&&n(Object(f.b)(g.a.Enabled)),n(function(e,t){return{type:"offline.schedule.datasync.async",execute({dispatch:n,getState:a},o){const c=o.OfflineProvider,s=Object(r.d)(a());if(Object(_.a)(s)){const e=Object(w.b)(a())?p.a.Initializing:p.a.NotAvailable;b.c.info("OfflineDataSyncAsyncAction.startOfflineDataSync: The offline status has been set to "+e),n(Object(i.c)(e,S.a.None))}else b.c.info("OfflineDataSyncAsyncAction.startOfflineDataSync: The offline status has been set to Available."),n(Object(i.c)(p.a.Available,S.a.None));return b.c.info("OfflineDataSyncAsyncAction.startOfflineDataSync: Schedule Periodic Sync Job started."),c.schedulePeriodicSyncJob(e,t).nativePromise().catch(l.b)}}}(a,o)),b.c.warn("Offline: OfflineWrapper: OfflinePerformDataSync: The offline feature status is : mobileOfflineOptStatus =  "+O)):(n(Object(i.c)(p.a.NotAvailable,S.a.ProfileUnavailable)),b.c.warn("Offline: OfflineWrapper: OfflinePerformDataSync: The offline feature status is set to "+p.a.NotAvailable)))}function A(e,t,n,a,c){var s;Object(r.c)(t)?(b.c.warn("OfflineWrapper: OfflineInitDataSync: Deleting the existing offline database as isDBCleanNeeded is true "+Object(r.d)(t)),n((s=Object(r.d)(t),{type:"offline.database.delete.async",execute:({dispatch:e,getState:t},n)=>n.OfflineProvider.cleanUpDatabases(s).nativePromise().then(()=>{e(Object(O.b)("")),e(Object(i.c)(p.a.NotAvailable,S.a.None)),e(Object(u.b)(!1)),e(Object(y.b)(null)),e(Object(d.b)(null,null,null))}).catch(e=>(b.c.error("Offline.databaseDeleteAction: OfflineProvider.cleanUpDatabases failed with error:"+Object(o.e)(e)),Promise.reject(e)))})).then(()=>{E(0,t,n,a,c),n(P())},l.b)):(b.c.warn("OfflineWrapper: OfflineInitDataSync: perform offline data sync "),E(0,t,n,a,c),n(P()))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function I(e,t){return{type:"offline.init.lifecycle.async",execute:({dispatch:n,getState:f},l)=>l.OfflineProvider.initializeOfflineDataSource(l.DataSource.get_UserContext()).nativePromise().then(()=>{const o=f(),u=Object(w.b)(o),O=Object(r.d)(o);if(Object(r.p)(f())===g.a.Disabled||null===O||""===O||c.a.equals(c.a.parse(O),c.a.EMPTY)||n(Object(i.c)(p.a.Available,S.a.None)),null!=O){const i=()=>!u||n(Object(s.initializeOfflineUpsyncProcessAsyncAction)()).then(()=>(A(0,f(),n,e,t),!0));return l.OfflineProvider.calculateDisabledOfflineEntities().nativePromise().then(i,i)}return u&&(n(Object(a.b)()),A(0,f(),n,e,t)),!0}).catch(e=>(b.c.error("OFFLINE : initializeOfflineLifecycleAsyncAction Failed"+Object(o.e)(e)),Promise.reject(e)))}}},"e+ib":function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return y})),n.d(t,"c",(function(){return d}));var i=n("8Mff"),a=n("9bCE"),o=n("Rj8P"),r=n("qjwL"),c=n("Nzmy"),s=n("eZ32"),f=n("8CLP");var l=n("kQA8"),u=n("37s6"),O=n("69Qu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const b="offline.opt.status";function d(e){return{type:"offline.opt.status.save",execute({dispatch:t,getState:n}){const b=n(),d=Object(u.p)(b)===i.a.Enabled;if(e!==d)if(e)t(y(i.a.Enabled));else{if(!Object(O.b)(b))return t(Object(l.a)("Settings_Offline_DisableSync_Information_Message",void 0));!
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){e(Object(a.b)(!0)),e(y(i.a.Disabled)),c.c.info("Offline: OfflineDisable: disableOffline: The offline feature status is disabled"),e(Object(o.c)(s.a.NotAvailable,f.a.None)),c.c.info("Offline: OfflineDisable: disableOffline: The offline status is set to "+s.a.NotAvailable),e(Object(r.b)(!0)),c.c.info("Offline: offlineDisable: disableOffline: Completed")}(t)}return Promise.resolve()}}}function y(e){return{type:b,payload:{offlineFeatureStatus:e}}}},iOI1:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="offline.available.primary.entities.update";function a(e){return{type:i,payload:{offlineAvailablePrimaryEntities:e}}}},kQA8:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("TBkx"),a=n("YxC/"),o=n("69Qu"),r=n("Nzmy"),c=n("EY5k"),s=n("si7p"),f=n("pgSX");function l(e,t){return{type:"offline.alert.dialog.async",execute({dispatch:n,getState:l},u){if(Object(o.b)(l()))return r.c.info("Offline: Server is available"),Promise.resolve();const O=["Dialog_Button_Ok",e];return n(Object(c.e)(O)).then(()=>{const o=Object(a.b)(l(),"Dialog_Button_Ok"),c=Object(a.b)(l(),e);return n(Object(f.a)(s.a,c,null,o,null,void 0,void 0,void 0,void 0,void 0,t)).then(e=>0===e.status?(r.c.info("Offline: Alert dialog is created successfully with message "+c),Promise.resolve()):(r.c.error("Offline: Error in Sync error dialog creation "+Object(i.e)(e.error)),Promise.reject(e.error)))}).catch(e=>(r.c.error("Offline: Error in alert dialog creation "+Object(i.e)(e)),Promise.reject(e)))}}}},qjwL:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="offline.set.reinitializeoffline";function a(e){return{type:i,payload:{reInitializeOffline:e}}}},wje5:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var i=n("/D1P");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="offline.upsync.start";function o(){const e={upSyncStatus:i.a.InProgress};return{type:a,payload:e}}},zmAS:function(e,t,n){"use strict";n.r(t),n.d(t,"OFFLINE_UPSYNC_HANDLE_ACTION",(function(){return P})),n.d(t,"initializeOfflineUpsyncProcessAsyncAction",(function(){return w}));var i=n("6u68"),a=n("TBkx"),o=n("YxC/"),r=n("Nzmy"),c=n("0uKS"),s=n("pgSX"),f=n("tICD"),l=n("EY5k"),u=n("si7p"),O=n("vONk"),b=n("504W");var d=n("wje5"),y=n("VKvO"),p=n("ybGo"),S=n("/D1P"),v=n("umme"),j=n("bvqZ"),m=n("Lyxw"),D=n("3/02"),h=n("xM/W"),g=n("6fj+");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const P="offline.upsync.process.async";let _=null;function w(e=!1){return{type:P,async execute({dispatch:t,getState:n},j){const m=Object(p.b)(n());if(!e&&m===S.a.Completed)return Promise.resolve();if(null!=_)await _;else try{await(_=async function(e,t,n){const p=new Date,S="Offline: Upsync";try{if(await n.OfflineProvider.hasItemsToUpsync().nativePromise()){r.c.info("OFFLINE : OfflineUpsyncHandler : Has Items To Upsync"),t(Object(d.b)());try{const i=await n.OfflineProvider.startPlayback().nativePromise();return t(Object(y.b)()),Object(b.a)(i)||0!==i.get_errorCount()?(r.c.warn("OFFLINE : OfflineUpsyncHandler : Upsync done with conflict"),t((v=String(i.get_lastSuccessfulSaveOnCrm()),{type:"offline.syncerror.dialog.async",execute({dispatch:e,getState:t},n){const i=["L_Show_Details_Text","Sync_Status_Error_Message","L_Last_Save_To_CRM_Server_Text","Sync_Status_Dialog_Title","Dialog_Button_Ok"];return e(Object(l.e)(i)).then(()=>{const n=Object(o.e)(t(),i),l=Object(o.c)(n,"L_Show_Details_Text"),d=Object(o.c)(n,"Sync_Status_Error_Message"),y=Object(o.c)(n,"L_Last_Save_To_CRM_Server_Text"),p=Object(o.c)(n,"Sync_Status_Dialog_Title"),S=Object(o.c)(n,"Dialog_Button_Ok"),j=d+"\n"+y;let m="";return m=Object(b.b)(O.a.get_OverallSyncErrorMessage())?j.replace("{0}",v):O.a.get_OverallSyncErrorMessage(),e(Object(s.a)(u.c,m,{},l,p,"",S)).then(t=>0===t.status?e(Object(f.a)(t.pageId)).then(n=>{n.value.confirmed&&e(Object(c.a)("syncerror",t.pageId,null,null,null,null,null))}):(r.c.error("Offline: Error in Sync error dialog creation "+Object(a.e)(t.error)),Promise.reject(t.error)))}).catch(e=>(r.c.error("Offline: Error in Sync error dialog creation "+Object(a.e)(e)),Promise.reject(e)))}}))):(await E(e,t),r.c.info("OFFLINE : OfflineUpsyncHandler : Upsync done without conflict")),n.EventManager.ReportComponentSuccess(S),void n.EventManager.ReportComponentPerformance(S,"Time Taken in ms",+new Date-+p)}catch(e){return r.c.error("OFFLINE : OfflineUpsyncHandler : Upsync Error"),t(Object(i.b)()),n.EventManager.ReportComponentFailure(S,e),n.EventManager.ReportComponentPerformance(S,"Time Taken in ms",+new Date-+p),Promise.reject(e)}}r.c.info("OFFLINE : OfflineUpsyncHandler : Upsync has no items to sync"),t(Object(y.b)()),await E(e,t)}catch(e){return r.c.error("OFFLINE : OfflineUpsyncHandler : hasItemsToUpsync Handler Failed"),Promise.reject(e)}var v}(n,t,j))}catch(e){if(!(e instanceof v.a)){const t=(null==e?void 0:e.message)||"Unexpected upsync error";e=v.a.FromMessage(t)}throw e}finally{_=null}}}}async function E(e,t){if(Object(m.c)(e(),D.l)&&Object(g.e)(e())){const n=["offline_notification_reconnect_success_text"];await t(Object(l.e)(n));const i={id:"upsync_complete_toast",level:1,message:Object(o.b)(e(),n[0]),title:null,type:1,onCloseHandler:null};t(Object(h.b)(!1)),t(Object(j.b)(i))}}}}]),window.bundleExecutionMarkers["scripts/InitializeOfflineLifecycleAsyncAction.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();