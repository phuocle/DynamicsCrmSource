(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/powerbifullscreenpage.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[97],{"+Ljw":function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"c",(function(){return c})),r.d(t,"b",(function(){return l}));var n=r("SAYH"),i=r("jq7Z"),a=r("arV0"),o=r("y60j");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t,r=!1){var n;const{entityTypeName:s}=Object(a.g)(e,t),c=Object(o.n)(e,s);if(!r)return c;const l=Object(i.a)(e,t),u=null===(n=null==l?void 0:l.formSelector)||void 0===n?void 0:n.forms;let d=c;if(u&&Object.keys(u).length>0){d=new Object;for(const e in c)u[e]&&!u[e].visible||(d[e]=c[e])}return d}function c(e,t,r){var s,c;const l=Object(i.a)(e,t),u=n.a.toString(r);if(null===(c=null===(s=null==l?void 0:l.formSelector)||void 0===s?void 0:s.forms)||void 0===c?void 0:c[u])return l.formSelector.forms[u].visible;const{entityTypeName:d}=Object(a.g)(e,t);return!!Object(o.m)(e,d,r)||null}function l(e,t){var r;const n=Object(i.a)(e,t);return null===(r=null==n?void 0:n.formSelector)||void 0===r?void 0:r.selectedFormId}},"+aj2":function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return i}));var n=r("bq0x");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="quickCreateForm.output";function a(e,t){return{type:"quickCreateForm.output.async",execute({dispatch:r,getState:a}){const o=Object(n.a)(a(),e)||[];return o.push(t),r(function(e,t){return{type:i,payload:{reason:"close",value:t},meta:{pageId:e}}}(e,o)),Promise.resolve(e)}}}},"/5se":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="controls.DefaultView";function a(e,t,r,a){const o=Object(n.v)(r);return{type:i,payload:a.guid,meta:{pageId:e,controlName:t,contextKey:o}}}},"/q/W":function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r("SoKF"),i=r("RrRQ"),a=r("i1f0"),o=r("4UCL"),s=r("zmL5"),c=r("dHD5"),l=r("bT7G"),u=r("jTSi"),d=r("O7zD");function p(e){return{type:"handle.unsaved.changes.async",execute:({dispatch:t,getState:r},p,h)=>t(Object(n.a)(e)).then(n=>{if(n){const n=Object(s.a)(r(),e),p=n.map(e=>Object(c.j)(r(),e));for(let e=0;e<n.length;e++){const s=n[e],c=p[e],h=Object(a.ac)(r(),s,c),g=Object(l.b)(r(),h),m=(null==g?void 0:g.activeChanges)?Object.keys(g.activeChanges):[];for(const e of m)t(Object(u.b)(c,s,Object(d.d)(s,e)));t(Object(i.c)(s,h,c)),t(Object(o.d)(s,c))}return!0}return!1})}}},"/q65":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="attribute.targets.set";function a(e,t,r,a){const o=Object(n.x)(t);return{type:i,payload:a,meta:{pageId:e,contextKey:o,dataFieldName:r}}}},"0L4T":function(e,t,r){"use strict";r.d(t,"c",(function(){return d})),r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return h}));var n=r("j2fa"),i=r("YxC/"),a=r("GEBM"),o=r("z8iZ"),s=r("DAWX"),c=r("3/02"),l=r("Lyxw"),u=r("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function d(e,t,r,n,o){let s=null;if(s=Object(i.b)(e,a.q),"function"==typeof r.get_ErrorCode)switch(r.get_ErrorCode()){case-2147093999:s=Object(i.b)(e,a.r);break;case-2147220960:s=Object(i.b)(e,a.o);break;case-2147164125:s=Object(i.b)(e,a.a);break;case-2147164130:case-2147164126:s=Object(i.b)(e,a.j);break;case-2147217149:s=Object(i.b)(e,a.i);break;case-2147217098:s=Object(i.b)(e,a.x);break;case-2147220969:case-2147187962:s=Object(i.b)(e,a.p);break;default:r.get_Message()&&(s=s+" "+r.get_Message())}p(e,t,s,n,o)}function p(e,t,r,i,a){let d=null;d=function(e){const t=Object(o.a)();return t.ErrorInformation=new s.a,t.ErrorInformation.set_ErrorDescription(e),t}(r),Object(l.c)(e,c.rd)?(t(Object(n.a)(i.getStorageKey(),d)),Object(n.e)(e,t,i.getStorageKey(),a)):(t(Object(n.c)(u.a.toString(i.visualizationId)||u.a.EMPTYGUIDSTRING,u.a.toString(i.viewId)||u.a.EMPTYGUIDSTRING,d)),Object(n.d)(e,t,u.a.toString(i.visualizationId)||u.a.EMPTYGUIDSTRING,u.a.toString(i.viewId)||u.a.EMPTYGUIDSTRING,a))}function h(e,t,r,n,o,s){p(t,r,-2147220960===e?Object(i.b)(t,a.o):n,o,s)}},"223Y":function(e,t,r){"use strict";r.d(t,"b",(function(){return lr})),r.d(t,"a",(function(){return ur})),r.d(t,"d",(function(){return pr})),r.d(t,"c",(function(){return cr}));var n=r("u+q+"),i=r("QBtP"),a=r("nuS9"),o=r("93Ls"),s=r("kGA3"),c=r("VnpK"),l=r("S2mk"),u=r("DRVD"),d=r.n(u),p=r("SZCI"),h=r("SAYH"),g=r("504W"),m=r("arV0"),b=r("xHmU"),y=r("i1f0"),f=r("lEFU"),v=r("Z/4N"),C=r("5ZBI"),S=r("dHD5"),I=r("jRy5"),_=r("odYE"),O=r("bT7G"),T=r("pnQK"),j=r("OtHk"),P=r("3/02"),E=r("Lyxw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const x="CustomControlFramework.Selectors.CustomControlHostContextTokenSelectors";function A(){let e=null,t=null,r=null;return(n,i)=>{C.a.info(i.controlId+"."+x+": createGetContextTokenSelector started");const a=i.parentContextToken,o=i.contextString,s=function(e,t){const r=t.parentContextToken,n=t.contextString;let i;const a=t.configuration,o=Object(v.e)(e,t.configuration.CustomControlId);if(Object(E.c)(e,P.J)&&Object(c.s)(o)&&function e(t,r){if(!r)return!1;if(r.contextTokenType===I.a.UnboundForm&&r.formId)return!(!Object(T.a)(t,r.formId)&&!Object(j.a)(t,r.formId));return e(t,r.parentContextToken)}(e,r))return i=S.p(r.parentContextToken,t.controlId),i;if("default"===n&&Object(c.s)(o)&&!Object(c.r)(t.configuration.Parameters)||Object(c.r)(t.configuration.Parameters)&&function(e){if(e.indexOf("ClientContextGridControl")>-1||e.indexOf("activeProcessGridControlContainer")>-1||e.indexOf("ManageDuplicatesGrid")>-1||e.indexOf("archivedProcessGridControlContainer")>-1)return!0;return!1}(t.controlId))return i=S.e(r,t.controlId),i;if(!t.formInfo&&a&&a.Parameters&&a.Parameters.value&&"TimelineWall"===a.Parameters.value.Type)return i=S.p(r,t.controlId),i;if(!t.formInfo&&Object(c.t)(t.configuration)){const n=function(e,t){const r=Object(m.g)(e,t.id),n=new _.a(r.entityTypeName,r.id||h.a.EMPTY),i=Object(y.ac)(e,t.id,t.parentContextToken),a=Object(O.d)(e,i,n,t.descriptor.DataFieldName),o=a?a.reference:null;return o?o.etn:Object(c.m)(t.descriptor)}(e,t);return i=S.l(r,t.controlId,n),i}i=r;const s=t.descriptor&&t.descriptor.Relationship;s&&(i=S.m(i,s));return i}(n,i);return(r!==o||w(e,s)||w(t,a))&&(e=s,t=a,r=o),C.a.info(i.controlId+"."+x+": createGetContextTokenSelector finished"),e}}function w(e,t){return e&&t?e.entityTypeName!==t.entityTypeName||e.controlName!==t.controlName||(e.formId&&e.formId.guid)!==(t.formId&&t.formId.guid)||(e.recordId&&e.recordId.guid)!==(t.recordId&&t.recordId.guid)||e.relationshipName!==t.relationshipName:e!==t}var F=r("p8cR"),N=r("P6DH"),k=r("zmL5"),D=r("OKVy"),M=r("FdB0"),R=r("fILV");function L(){let e={},t=!1;return(r,n,i,a,o,s)=>{C.a.info(n.controlId+".CustomControlFramework.Selectors.CustomControlHostPersonalizationInfoSelectors: createGetPersonalizationConfiguration started");const c=Object(m.a)(r,n),l=c&&c.id,u=e&&l&&l.guid&&(!e.recordGuid||e.recordGuid&&l.guid!==e.recordGuid.guid);if(!t||u){const c=Object(k.b)(r,n.id),l=h.a.equals(h.a.tryParse(i.UniqueId),h.a.EMPTY)?n.controlId:i.UniqueId;e=c&&s===D.a?function(e,t,r,n){return{areaType:"dashboard",entityTypeName:null,recordGuid:null,formGuid:r,controlUniqueId:n,viewId:void 0}}(0,0,c,l):c&&s===M.a?function(e,t,r,n){const{entityTypeName:i,recordSetQueryKey:a}=Object(m.a)(e,t);return{areaType:"dialog",entityTypeName:i,formGuid:r,controlUniqueId:n,viewId:a?a.split(",")[1]:void 0}}(r,n,c,l):c?function(e,t,r,n){const{entityTypeName:i,recordSetQueryKey:a,id:o}=Object(m.a)(e,t);return{areaType:"form",entityTypeName:i,recordGuid:o,formGuid:r,controlUniqueId:n,viewId:a?a.split(",")[1]:void 0}}(r,n,c,l):s===R.a?function(e,t,r,n){const i=Object(N.cb)(e,n,t);return{areaType:"grid",entityTypeName:r,viewId:i?i.split(",")[1]:void 0}}(r,n,a.entityTypeName,o):{areaType:null,entityTypeName:null,controlUniqueId:l,viewId:void 0},t=!0}return C.a.info(n.controlId+".CustomControlFramework.Selectors.CustomControlHostPersonalizationInfoSelectors: createGetPersonalizationConfiguration finished"),e}}var V=r("q6Ks"),B=r("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function G(e,t,r,n,i){const a=Object(B.a)(e,t),o=i?"__hiddenCommandManagerIds":"__pendingCommandManagerIds",s=Object(S.v)(n);return a&&a[o]&&a[o][s]&&a[o][s][r]?a[o][s][r]:null}var X=r("GT4X"),U=r("tJ+6"),z=r("cfbi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const H=d.a.createEvent("CustomControlHostSelectors.mapStateToProps",p.c);var q=r("r/9v"),W=r("OmkB"),Y=r("tOh6"),Q=r("BJ7u"),K=r("5DN6"),J=r("iZ7K"),Z=r("lY/Z"),$=r("Lohl"),ee=r("y60j"),te=r("XlXz");function re(e,t){return{type:te.a,payload:e,meta:{pageId:t}}}function ne(e){return{type:"execute.cleanreferencepanelstate.async",execute:({dispatch:t,getState:r},n)=>(t(function(e){return{type:te.b,payload:{},meta:{pageId:e}}}(e)),Promise.resolve())}}function ie(e){return{type:"execute.closeallsessiontabs.async",execute({dispatch:t,getState:r},n){const i=r();return t(function(e,t){return{type:te.c,payload:e,meta:{pageId:t}}}({sessionTabs:[],activeTabId:Object(K.b)(i,e)},e)),Promise.resolve()}}}function ae(e,t){return{type:"execute.closesessiontab.async",execute({dispatch:r,getState:n},i){const a=n(),o=Object(K.d)(a,t),s=Object(K.a)(a,e,t);return o.splice(e,1),r(function(e,t){return{type:te.d,payload:e,meta:{pageId:t}}}({sessionTabs:o,activeTabId:s},t)),Promise.resolve()}}}function oe(e){return{type:"execute.dismissmessage.async",execute:({dispatch:t,getState:r},n)=>(t(function(e,t){return{type:te.e,payload:{referencePanelState:t},meta:{pageId:e}}}(e,{messageId:""})),Promise.resolve())}}function se(e,t){return{type:"execute.initializereferencepanelcontrol.async",execute({dispatch:r,getState:n},i){const a=Object(K.c)(n(),t);if(e&&!(a.activeTabId&&a.controlNames.length>0))return r(function(e,t){return{type:te.f,payload:e,meta:{pageId:t}}}({controlNames:e.map(e=>e.Name),activeTabId:e[0].Id},t)),Promise.resolve()}}}var ce=r("SWZ5");function le(e,t){return{type:"execute.addsessiontab.async",execute({dispatch:r,getState:n},i){const a=Object(K.d)(n(),t),o=[];for(let t=0;t<a.length;t++)a[t].id===e.id?o.push(e):o.push(a[t]);return r(function(e,t){return{type:te.h,payload:e,meta:{pageId:t}}}({sessionTabs:o},t)),Promise.resolve()}}}var ue=r("IaGr"),de=r("1kth");var pe=r("Or4W"),he=r("BMZr"),ge=r("uPT+"),me=r("mIxf"),be=r("sX6v"),ye=r("WY/A"),fe=r("JP46"),ve=r("Dea/");var Ce=r("ghNp"),Se=r("yRo8"),Ie=r("oOvK"),_e=r("FZDd"),Oe=r("HfZT"),Te=r("6Qf/"),je=r("a72m"),Pe=r("YYhu"),Ee=r("Tf+h"),xe=r("ZUzm"),Ae=r("0uKS"),we=r("lIi+"),Fe=r("lYcl"),Ne=r("4fxQ"),ke=r("VCkP");var De=r("DU8S");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Me{constructor(e,t){this.Target=e,this.FieldName=t}getMetadata(){return{boundParameter:null,operationName:"CalculateRollupField",operationType:1,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},FieldName:{typeName:"Edm.String",structuralProperty:1}}}}}var Re=r("srnJ"),Le=r("UR8A"),Ve=r("j6Db");var Be=r("NjDY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Ge=r("969l"),Xe=r("EY5k"),Ue=r("YxC/");var ze=r("VpHT");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function He(e,t){return{type:"customcontrol.loadresources.async",execute:({dispatch:r,getState:n},i)=>function(e,t,r,n){const i=Object(Be.t)(t);return r.initializeContainerForClientApi(n).then(t=>t.loadWebResources([Object(Be.a)(i,e)]).then(()=>({container:t,webResourcePath:i})))}(e,n(),i.ScriptManager,t)}}var qe=r("kWiz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var We=r("Khp3"),Ye=r("3tOH"),Qe=r("Qn2w"),Ke=r("LbMF");var Je=r("dQnL"),Ze=r("d0Pd"),$e=r("0L4T"),et=r("NbYl"),tt=r("NYBK"),rt=r("7fV9"),nt=r("Z+6x"),it=r("Nse0"),at=r("WK+4"),ot=r("qwRa"),st=r("s+OO"),ct=r("7k+e"),lt=r("eXjw"),ut=r("Uv1Y"),dt=r("vNXc"),pt=r("5Oca");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class ht{constructor(e,t,r){this.Target=e,this.Query=t,this.RollupType=r}getMetadata(){return{boundParameter:null,operationName:"Rollup",operationType:1,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},Query:{typeName:"Microsoft.Dynamics.CRM.QueryBase",structuralProperty:2},RollupType:{typeName:"Microsoft.Dynamics.CRM.RollupType",structuralProperty:3,enumProperties:[,{name:"None",value:0},{name:"Related",value:1},{name:"Extended",value:2}]}}}}}var gt=r("sNgR"),mt=r("tHtE"),bt=r("SRlt"),yt=r("fYtF");function ft(e,t=!1){const r=[];return{type:"gridData.retrieve.rollup.async",execute({dispatch:n,getState:i},a){let o=i();const s=e.key,c=dt.a.fromState(e,i),l=Object(pt.u)(o,s,c.pageNumber-1);return l&&(c.pagingCookie=l),r.push({name:yt.a,value:Object(yt.e)(e)}),r.push({name:"isRefresh",value:t}),n(function(e,t,r=!1){const n={lists:{[e]:{initialized:r?lt.a.Refreshing:lt.a.Initializing,pageSize:t}}};return{type:"gridData.retrieve.rollup",payload:n}}(s,c.pageSize,t)),function(e,t,r){return r.toQueryExpression(e,t).then(n=>t(Object(gt.b)(new ht(_.a.toExternalEntityReference(r.target),n,r.rollupType))).then(n=>Object(bt.g)(n).then(n=>function(e,t,r,n){const i=r.getKeyQuery(),a=Object(mt.e)(i),o=Object(_e.e)(a.entity2AttributesMap);return t(o).then(()=>{const t=e();return Object(mt.a)(t,i,a,n)})}(e,t,r,n))))}(i,n,c).then(e=>{o=i(),n(Object(Oe.e)(o,n,s,c,e))}).catch(e=>{Object(ut.b)(e)})},getFailureParameters:(e,t)=>r,getSuccessParameters:(e,t,n)=>r}}var vt=r("fREn"),Ct=r("ngeo"),St=r("xorU");function It(e,t,r,n,i){let a="",o="";if(n&&n.message&&(a=n.message),n&&n.errorCode){const s=i||Ve.a,c=e=>(r.EventManager.ReportComponentFailure(s,e,null,[{name:"hexErrorCode",value:o},{name:"errorStatus",value:JSON.stringify(n)},{name:"customControlId",value:i},{name:"APIName",value:Ve.a+".Actions.RefreshDataSetParameter.getErrorMessage"}]),Promise.resolve(`${o} ${a}`));try{o="0x"+Ct.a.getHexErrorCodeFromInt(n.errorCode);const r="Error_Title_"+o,i="Error_Message_"+o,a=`Localized resource strings not found for neither ${r} nor ${i}.  Please add error resources for error code ${o}`,s=e(Object(Xe.e)([r])).catch(()=>{}),l=e(Object(Xe.e)([i])).catch(()=>{});return Promise.all([s,l]).then(()=>{const e=Object(Ue.e)(t(),[r,i]),n=Object(Ue.c)(e,r),s=Object(Ue.c)(e,i);let l="";return l=function(e){return"0x8005f211"===(null==e?void 0:e.toLowerCase())}(o)?`${n}${n&&s?": ":""}${s}`:n||s,l?Promise.resolve(`${o} ${l}`):c(a)})}catch(e){return c(e)}}return Promise.resolve(`${o} ${a}`)}function _t(e,t){if(e instanceof rt.a){e.getLatestData().loading=!0,e.setRefreshingStart()}else if(e instanceof nt.a||e instanceof tt.a){const t=e.getLatestData();t&&(t.working=!0,nt.a,e.setWrapperLoadingFlag(!0))}return{type:"customcontrol.refreshDataSetParameter.async",execute({dispatch:r,getState:n},i){if(e instanceof et.a){const a={retrieveGridDataAction:e=>r(Object(Oe.d)(e)),retrieveViewAction:(e,t,n,i)=>r(Object(je.a)(e,t,n,i)),retrieveViewSelectorAction:(e,t)=>r(Object(je.b)(e,t)),runPreSearch:(e,n,i)=>r(Object(de.W)(t,e,n,i)),runSetAdditionalParams:(e,n,i)=>r(Object(de.X)(t,e,n,i)),refreshCustomDataProviderAction:(e,t,n,i)=>r(Object(it.b)(e,t,n,i)),retreiveChartAction:(e,t,n)=>r(Object(Je.a)(e,t,n)),retreiveChartDataAction:(e,t,n,i=!0)=>r(Object(Ze.a)(e,t,n,i)),updateDataSetChartVisualizationId:(e,t,n)=>r(Object(at.b)(e,t,n)),updateDataSetChartVisualizationType:(e,t,n)=>r(Object(ot.b)(e,t,n)),getEntityMetadataAction:(e,t)=>r(Object(_e.f)(e,!1,t)),getLocalizedErrorMessage:(e,t)=>It(r,n,i,e,t),updateChartFilterExpression:(e,t,n)=>r(Object(st.c)(e,t,n)),updateChartDrillDownParameters:(e,t,n)=>r(Object(ct.c)(e,t,n)),updateChartErrorInformation:(e,t,n,i)=>{Object($e.a)(e,r,t,n,i)}};return e.refreshDataSet(n,a,i)}const a={retrieveGridDataAction:e=>Object(g.a)(e.rollupType)?r(Object(Oe.d)(e)):r(ft(e)),retrieveViewAction:(e,t,n,i)=>r(Object(je.a)(e,t,n,i)),retrieveViewSelectorAction:(e,t)=>r(Object(je.b)(e,t)),runPreSearch:(e,n,i)=>r(Object(de.W)(t,e,n,i)),runSetAdditionalParams:(e,n,i)=>r(Object(de.X)(t,e,n,i)),startCustomFilter:(e,t,n)=>r(Object(St.f)(e,t,n)),endCustomFilter:(e,t,n)=>r(Object(St.e)(e,t,n)),refreshCustomDataProviderAction:(e,t,n,i)=>r(Object(it.b)(e,t,n,i)),getEntityMetadataAction:(e,t)=>r(Object(_e.f)(e,!1,t)),getLocalizedErrorMessage:e=>It(r,n,i,e),getAdditionalResourceStrings:e=>r(Object(Xe.e)(e)),addCustomViewAction:(e,t,n,i,a,o,s,c)=>r(Object(vt.a)(e,t,n,i,a,o,s,c)),setOfflineQueryAction:e=>r(Object(vt.b)(e))};return e.refreshDataSet(n,a,i)}}}var Ot=r("7Sr4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Tt=r("sn0j"),jt=r("KVHF");var Pt=r("mFPv"),Et=r("AE7n"),xt=r("pp6D"),At=r("9i5P");var wt=r("Q1Tc"),Ft=r("jsFU"),Nt=r("455M");var kt=r("BFlg"),Dt=r("7p56");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Mt(e,t,r){if(r.dataSetUIOptions){const n=e+t.id;let i=t.contextString;switch(t.contextString){case kt.h.ASSOCIATEDGRID:case kt.h.SUBGRID:case kt.h.GRID:break;case kt.h.CUSTOM:default:i=kt.h.CUSTOM}return a.createElement(Dt.a,{key:n,id:t.id,systemDefinedProperties:t.systemDefinedProperties,controlId:t.controlId,configuration:t.configuration,descriptor:t.descriptor,formInfo:t.formInfo,themingData:t.themingData,parentDefinedControlProps:t.parentDefinedControlProps,children:t.children,rowSpan:t.rowSpan,contextString:i,parentContextToken:t.parentContextToken,dataSetUIOptions:r.dataSetUIOptions})}return a.createElement(cr,{key:e,id:t.id,systemDefinedProperties:t.systemDefinedProperties,controlId:t.controlId,configuration:t.configuration,descriptor:t.descriptor,formInfo:t.formInfo,themingData:t.themingData,parentDefinedControlProps:t.parentDefinedControlProps,children:t.children,rowSpan:t.rowSpan,contextString:t.contextString,parentContextToken:t.parentContextToken})}var Rt=r("iWfp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Lt(e){if(!e)return;if(e instanceof _.a)return e;const t=e.entityName||e.LogicalName;let r;return r=h.a.fromLegacyGuid(e.Id),h.a.isNullOrEmpty(r)&&(r=new h.a(e.id||e.Id)),new _.a(t,r,Object(g.a)(e.name)?e.Name:e.name)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Vt(e,t,r,n){return n&&n.DisplayName&&"partylist"!==n.Type&&Object(Tt.b)(e,t,r,n)&&n.IsValidForAdvancedFind}var Bt=r("thZs"),Gt=r("R5Qn"),Xt=r("E3i9"),Ut=r("KBcj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class zt{convert(e,t,r){const n=(new DOMParser).parseFromString(e,"text/xml"),i=this._firstElementChild(n),a=this._childElements(i);if(!a)return null;const o=[];for(const e of a){const t=[],r=this._childElements(e);for(const e of r)t.push(this._getGridCellDescriptor(e));o.push(this._getGridRowDescriptor(e,t))}const s=this._getGridDescriptor(i,o,r);return this._populateRelationshipInformation(s,t),s}_attributeValueBoolean(e,t){return"1"===this._attributeValueString(e,t,"")}_attributeValueString(e,t,r){const n=e.attributes.getNamedItem(t);return n&&n.value||r}_attributeValueInt(e,t,r){const n=this._attributeValueString(e,t,r+"");return parseInt(n,10)}_childElements(e){if(!e)return null;if(e.children)return Array.from(e.children);if(e.childNodes){return Array.from(e.childNodes).filter(e=>e.nodeType===Node.ELEMENT_NODE).map(e=>e)}return null}_getGridCellDescriptor(e){return{name:this._attributeValueString(e,"name",""),width:this._attributeValueInt(e,"width",0),relatedEntityName:this._attributeValueString(e,"relatedentityname",""),disableMetaDataBinding:this._attributeValueBoolean(e,"disableMetaDataBinding"),labelId:this._attributeValueString(e,"LabelId",""),isHidden:this._attributeValueBoolean(e,"ishidden"),disableSorting:this._attributeValueBoolean(e,"disableSorting"),addedBy:this._attributeValueString(e,"addedby",""),desc:this._attributeValueString(e,"desc",""),cellType:this._attributeValueString(e,"cellType",""),imageProviderWebresource:this._attributeValueString(e,"imageproviderwebresource",""),imageProviderFunctionName:this._attributeValueString(e,"imageproviderfunctionname","")}}_getGridRowDescriptor(e,t){return{name:this._attributeValueString(e,"name",""),id:this._attributeValueString(e,"id",""),cells:t,multiObjectIdField:this._attributeValueString(e,"multiobjectidfield",""),layoutStyle:this._attributeValueString(e,"layoutstyle","")}}_getGridDescriptor(e,t,r){return{name:this._attributeValueString(e,"name",""),object:r,rows:t,customControlDescriptions:null,jump:this._attributeValueString(e,"jump",""),select:this._attributeValueBoolean(e,"select"),icon:this._attributeValueBoolean(e,"icon"),preview:this._attributeValueBoolean(e,"preview"),iconrenderer:this._attributeValueString(e,"iconrenderer","")}}_firstElementChild(e){if(!e)return null;if(e.firstElementChild)return e.firstElementChild;const t=this._childElements(e);return t&&t[0]}_populateRelationshipInformation(e,t){const r=(new DOMParser).parseFromString(t,"text/xml"),n=this._firstElementChild(r),i=this._firstElementChild(n),a=this._childElements(i);if(a)for(const t of a)"link-entity"===t.nodeName&&this._attributeValueString(t,"alias","")&&this._attributeValueString(t,"name","")&&this._setRelatedEntityName(e,this._attributeValueString(t,"alias",""),this._attributeValueString(t,"name",""))}_setRelatedEntityName(e,t,r){for(let n=0;n<e.rows.length;n++)for(let i=0;i<e.rows[n].cells.length;i++){const a=e.rows[n].cells[i].name;(a?a.substring(0,a.indexOf(".")):void 0)===t&&(e.rows[n].cells[i].relatedEntityName=r)}}}var Ht=r("DU5H"),qt=r("fU7K");function Wt(e,t=!1,r,n,i,a,o,s){return{type:"populateAndSend.LookupData.Action",sync:!0,execute({dispatch:c,getState:l},u){const d=l(),p=i||e.LookupEntityByName[0].EntityLogicalName,g=Object(Gt.f)(d,p,o,n),b=[];if(s){const t=s.split("."),i=Object(m.g)(d,n);let a;const o=Object(y.ac)(d,n,r),c=Object(O.b)(d,o);a=c&&c.activeChanges&&c.activeChanges[t[1]]?c.activeChanges[t[1]]:Object(pt.j)(d,new _.a(t[0],i.id),t[1]),e.RelatedRecordId=a&&a.reference&&a.reference.id}if(e.LookupEntityByName&&e.LookupEntityByName.length){const t=Object(y.eb)(d,n,r),i=t&&t[a];for(const t of e.LookupEntityByName){const e=Object(Ht.b)(d,n,r,a,t.EntityLogicalName);if(e&&(t.CustomFilter=Object(qt.CrmHtmlDecode)(e).replace(/"/g,"'")),g){const e=Object(Xt.a)(d,g,t.EntityLogicalName);e&&e.view&&(h.a.equals(e.view.viewId,t.ViewId)||Object(Ut.c)(d,t.ViewId))||b.push(c(Object(je.a)(t.EntityLogicalName,null,null,t.ViewId)))}const o=i&&i.parameters&&i.parameters.defaultviewid;if(i&&i.views&&i.views[o]&&i.views[o].entityLogicalName===t.EntityLogicalName){t.ViewId=null,t.FetchXml=i.views[o].fetchXML.replace(/"/g,"'");const e=Object(J.h)(d,t.EntityLogicalName),r=new zt;t.LayoutJson=JSON.stringify(r.convert(i.views[o].layoutXML,i.views[o].fetchXML,e.ObjectTypeCode)).replace(/"/g,"'")}}}const f=Object(Bt.b)(d,p,e),v=Object(pt.o)(d,f);t=t||v===lt.a.Initialized,b.push(c(Object(Bt.d)(e,t)));const C=function(e,t,r,n,i){const a={};let o=n||r.EntityAndAttribute&&r.EntityAndAttribute.EntityName;const s=i||r.EntityAndAttribute&&r.EntityAndAttribute.AttributeName;if(!o&&!s)return null;o||(o="placeholderEtn");if(r.LookupEntityByName)for(const t of r.LookupEntityByName)a[t.EntityLogicalName]=Object(Bt.b)(e,t.EntityLogicalName,r);const c=Object(Bt.c)(e,r);return{type:"update.lookupRequestDataKey",payload:{[o]:{[s]:{metadataKey:c,dataKeys:a}}},meta:{pageId:t}}}(d,n,e,i,o);return C&&c(C),Promise.all(b)}}}var Yt=r("mpSO"),Qt=r("F1Lu");var Kt=r("+pAH"),Jt=r("wZxB");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let Zt,$t,er,tr;function rr(e,t){return{openEditForm:(r,n,i,a,o)=>{const s=Lt(r);e(n?Object(xe.a)(s,t.id,void 0,void 0,n,i,a,o):Object(xe.a)(s,t.id))},openGridPage:(r,n,i,a,o,s,c,l)=>{e(Object(Ae.a)(r,t.id,h.a.tryParseOrNull(n),i,a,h.a.tryParseOrNull(o),s,null,l,c))},openCreateForm:(r,n,i)=>{e(Object($.b)(new _.a(r),null,"QuickCreate")).then(a=>{e(Object(he.b)(r,t.id,null,n,Lt(i)))}).catch(i=>{e(Object(xe.a)(new _.a(r),t.id,void 0,n))})},openSearch:r=>{e(Object(Fe.a)(r,null,t.id))},openPowerBIFullScreenPage:(r,n,i,a,o,s,c)=>{e(Object(we.a)(t.id,r,n,i,a,o,s,c))},openDashboard:e=>{},openUrl:(e,t)=>{},openUrlWithProtocol:(e,t)=>{},openPhoneNumber:(r,n,i,a,o,s,c,l,u,d=!1,p=!0)=>e(function(e,t,r,n,i,a,o,s,c,l,u=!1,d=!0){return{type:"customcontrol.openphonecall",execute(p,g){let m=e.trim();const b=Object(Be.x)(p.getState()).defaultCountryCode;0!==m.indexOf("tel:")?(b&&(m=b+m),m="tel:"+m):b&&(m=m.slice(0,4)+b+m.slice(4));const y=new Qt.a(g,p);let f;g.ScriptManager.containerExists(Yt.d)&&(f=g.GlobalCustomEventManager);const v=()=>{if(u){let c=null;const l={};if(t){c=new _.a(r,new h.a(t));const i={id:t,entityType:r,name:n};let u=i;a&&(u={id:a,entityType:o,name:s}),l.contactinfo=e,l.to=[i],l.regardingobjectid=u}return p.dispatch(Object(he.b)("phonecall",i,null,l,c,null,{entityName:"phonecall",showDialog:!0}))}};return y.canOpenUri(m).then(e=>{if(d&&f&&p.dispatch(f.runOnOpenUrl(i,m,l,c)))return null;const t=Object(E.c)(p.getState(),P.C);e?(y.openUri(m),t&&v()):u&&t&&v()},()=>null)},shouldReceiveFullStore:!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(r,i,n,a,t.id,s,o,c,l,u,d,p)),openMaps:e=>{},openMap:e=>{}}}var nr=r("Ki7F"),ir=r("nJrx"),ar=r("o0iw"),or=r("llMO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const sr=Object(n.a)(()=>{let e,t={},r=null,n={},i={},a={},o=!1,s="",u=null,d={},p=!1,S="",I=!1,_={stateToPropsMappingError:!1,dynamicData:null,manifest:null,personalizationState:null,propBagData:null,pageType:null,popupStack:null,contextToken:null,portalFlyoutToDialogId:null,designLanguage:null,inactive:!1},O=-1,T=-1;const j=Object(F.a)(),P=Object(V.a)(),E=L(),x=A();return(A,w)=>{C.a.info(w.configuration.CustomControlId+".CustomControlFramework.Selectors.CustomControlHostSelectors: makeMapStateToProps started");const F=H.startStopwatch({controlId:w.controlId,parentId:Object(c.p)(w),level:(0).toString()});let N,k,D,M,R,L=[],V=!1,B=null,q=null,W=null,Y=null,Q=null,K=null,J=null,Z=null,$=null,ee=null,te=!1,re=null,ne=null,ie=null,ae=!1;try{let e=null;w.formInfo?(u&&d.EntityName===w.formInfo.EntityName&&d.RecordId===w.formInfo.RecordId&&d.FormId===w.formInfo.FormId||(u={id:w.formInfo.RecordId?new h.a(w.formInfo.RecordId):null,formId:w.formInfo.FormId?new h.a(w.formInfo.FormId):null,entityTypeName:w.formInfo.EntityName},d=w.formInfo),e=u):e=Object(m.g)(A,w.id),q=w.descriptor,W=w.configuration,D=Object(b.b)(A),N=Object(m.l)(A,w.id),Object(m.f)(A,w.id)&&(R="DialogContainer__"+w.id),!R&&w.parentDefinedControlProps&&w.parentDefinedControlProps.parentFlyoutId&&(R=w.parentDefinedControlProps.parentFlyoutId),N&&(k=x(A,w));const t=Object(y.kb)(A,w,k);let r=W;if(null!==w.systemDefinedProperties){const e=Object.assign(Object.assign({},W.Parameters),w.systemDefinedProperties);r=Object.assign(Object.assign({},W),{Parameters:e})}if(Y=Object(v.e)(A,W.CustomControlId)||Object(v.e)(A,W.Name),!Y||!Y.ConstructorName){Y=null;const e=Object(l.h)(W.CustomControlId);e!==W.CustomControlId&&(Y=Object(v.e)(A,e))}Y&&(Z=P(A,Y,e,t,w.contextHelper),J=Z.response,K=j(r,q,w,A,e,k),Q=K.response,ee=Q&&Q.dataReady?E(A,w,q,e,k,N):null,$=Object(f.a)(A,ee,Y.CustomControlId,w.id));const n=G(A,w.id,w.controlId,k);n&&(te=n.every(e=>Object(X.b)(A,e))),M=G(A,w.id,w.controlId,k,!0),ne=w.parentDefinedControlProps&&!Object(g.a)(w.parentDefinedControlProps.height)?w.parentDefinedControlProps.height:-1,re=w.parentDefinedControlProps&&!Object(g.a)(w.parentDefinedControlProps.width)?w.parentDefinedControlProps.width:-1,ie=Object(U.b)(A)?Object(U.a)(A):null,ae=((e,t,r,n)=>Object(m.l)(e,t)===z.a&&!Object(y.Fb)(e,t,r,n))(A,w.id,k,w.descriptor.Name)}catch(e){const t=Y.ConstructorName;C.a.error(t+": makeMapStateToProps encountered error, err "+e,[{name:"ApiName",value:"CustomControlFramework.Selectors.CustomControlHostSelectors"},{name:"controlId",value:w.controlId},{name:"customControlId",value:Y.CustomControlId},{name:"manifest",value:JSON.stringify(Y)},{name:"descriptor",value:JSON.stringify(q)},{name:"configuration",value:JSON.stringify(W)},{name:"error.Stack",value:JSON.stringify(e.stack)}]),V=!0,B=e.toString()+". Stack: "+e.Stack}return r&&(L=L.concat(((e,t)=>{const r=[];return e.Disabled!==t.Disabled&&r.push("IsControlDisabled"),e.Label!==t.Label&&r.push("Label"),r})(q,r))),r=w.descriptor,Q!==n||Y!==t||J!==i||ee!==a||V!==o||N!==s||te!==p||M!==e||ne!==T||re!==O||R!==S||ie!==_.designLanguage||ae!==I?(ne===T&&re===O||L.push("layout"),K&&(L=L.concat(K.updatedProperties)),Z&&(L=L.concat(Z.updatedProperties)),ie!==_.designLanguage&&L.push("design"),_={stateToPropsMappingError:V,stateToPropsMappingErrorMessage:B,dynamicData:Q,manifest:Y,personalizationState:$,propBagData:J,children:W&&W.Children,personalizationConfiguration:ee,pageType:N,popupStack:D,contextToken:k,updatedProperties:L,globalCommandManagerInitialized:te,internalCommandManagerIds:M,portalFlyoutToDialogId:R,designLanguage:ie,inactive:ae},p=te,e=M,S=R,o=V,i=J,t=Y,n=Q,a=ee,s=N,T=ne,O=re,I=ae):_.updatedProperties=L,F({updatedProperties:JSON.stringify(L)}),C.a.info(w.configuration.CustomControlId+".CustomControlFramework.Selectors.CustomControlHostSelectors: makeMapStateToProps finished"),_}},(function(){let e;return function(t,r){if(e)return e;const n=rr(t,r);return Zt={setNotification:(e,r,n,i,a,o,s)=>t(function(e,t,r,n,i,a,o){return{type:"customcontrol.propertybag.mode.setnotification",execute({dispatch:s,getState:c},l){const u={uniqueId:t||"",messages:[e],priority:0,notificationLevel:Ye.a.error,actions:[{actions:[function(){}],message:""}]};s(Object(We.b)(r,n,u,i));const d=c(),p=new _.a(a,h.a.fromExternalGuid(o)),g=Object(Ke.a)(d,p.etn,n);return p&&g&&(2===g.RequiredLevel||1===g.RequiredLevel)&&s(Object(Qe.b)(r,n,!1,i)),!0},sync:!0}}(e,r,n,i,a,o,s)),clearNotification:(e,r,n,i,a,o)=>t(function(e,t,r,n,i,a){return{type:"customcontrol.propertybag.mode.clearnotification",execute({dispatch:n,getState:i},o){const s=Object(y.A)(i(),{controlName:t,id:e},r);if(s){a=a||"";const i=Object.keys(s);let o=null;for(let c=i.length-1;c>-1;--c)i[c]===a&&(o=s[i[c]],o.actions=null,o.messages=null,o.notificationLevel=null,n(Object(We.b)(e,t,o,r)))}return!0},sync:!0}}(e,r,n,0,0,o))},er={setState:e=>!0,logMessage:(e,r,n)=>{t(function(e,t,r){return{type:"customcontrol.log",execute({dispatch:n,getState:i},a){const o=a.TraceManager.getTracer("customcontrol"),s=e+": "+t;switch(r){case qe.a.Error:o.error(s);break;case qe.a.Info:o.info(s);break;case qe.a.Warning:o.warn(s);break;case qe.a.Verbose:o.debug(s)}},sync:!0}}(e,r,n))}},$t={isGetBarcodeValueOperationAvailable:()=>t(Object(De.c)()),isTakePictureOperationAvailable:()=>t(Object(De.e)()),isCaptureVideoOperationAvailable:()=>t(Object(De.b)()),isCaptureAudioOperationAvailable:()=>t(Object(De.a)()),isOpenARViewerAvailable:()=>t(Object(De.d)())},tr={clearNestedChild:e=>!0,createAccessibilityComponent:Rt.a,createCommandManagerUXComponent:()=>{let e=null;return t=>{const r=ur(t);return pr(e,t.selectedRecords)?r.selectedRecords=e:e=r.selectedRecords,lr(r)}},createKeyboardShortcut:Rt.b,createXrmForm:(e,r,n,i)=>function(e,t,r,n,i){return!!e(Object(xt.b)(t,r,n,new h.a(i)))}(t,e,r,n,i),createXrmGrid:(e,r,n,i)=>{const a=[I.a.AssociatedGrid,I.a.CustomGrid,I.a.SubGrid,I.a.MainGrid];if(e&&-1===a.indexOf(e.contextTokenType))for(const i in n)if("Grid"===n[i].Type){const a=n[i];t(Object(Te.c)(a.TargetEntityType||a.EntityName,a.ViewId,r,e));break}return function(e,t,r,n,i){const a=Object(N.vb)(n);if(t){let n;switch(t.contextTokenType){case I.a.SubGrid:n=3;break;case I.a.AssociatedGrid:n=2;break;case I.a.MainGrid:case I.a.CustomGrid:n=1;break;default:const e=[{name:"contextToken",value:JSON.stringify(t)},{name:"controlName",value:i},{name:"isEditableGrid",value:a}];ue.a.getInstance().eventManager.ReportComponentFailure("ClientApi.XrmCommandObjectWrapper.createXrmGridWrapper",new Error("Unknown context token type for grid"),null,e),n=1}return!!e(Object(xt.c)(t,r,a,n,i))}return!0}(t,e,r,n,i)},registerNewControl:(e,r,n,i)=>function(e,t,r,n,i){return!!e(Object(xt.e)(t,r,n,i))}(t,e,r,n,i),executeAddOnLoad:(e,r)=>{t(function(e,t){return{type:"customcontrol.executeAddOnLoad.async",sync:!0,execute({dispatch:r,getState:n},i){e.gridRunOnLoad((e,n,a)=>{if(i.ScriptManager.containerExists(e)){const o=i.ScriptManager.getContainer(e).getEventManager();r(o.runOnGridDataLoad(t,1,a,n))}})}}}(e,r))},addSessionTab:(e,r)=>t(function(e,t){return{type:"execute.addsessiontab.async",execute({dispatch:r,getState:n},i){const a=n(),o=Object(K.d)(a,t);let s=!0;if(e){if(o.forEach(t=>{e.id===t.id&&(s=!1)}),s){if("quickViewFormTab"===e.type){let n=!1;const i=e,s=Object(Q.a)(6),c=Object(J.E)(a,i.entityFormOptions.entityName),l="activitypointer";let u;u=a.data.entities[l]&&a.data.entities[l].hasOwnProperty(i.entityFormOptions.entityId)?Object(y.ec)(a,l,new h.a(i.entityFormOptions.entityId)):Object(y.ec)(a,i.entityFormOptions.entityName,new h.a(i.entityFormOptions.entityId));const d=new _.a(i.entityFormOptions.entityName,new h.a(i.entityFormOptions.entityId)),p=[];if(!u){const e=r(Object(Z.d)(d,[c]));p.push(e)}let g=Object(ee.h)(a,i.entityFormOptions.entityName,s);if(h.a.isNullOrEmpty(g)){const e=r(Object($.b)(d,null,s)).then(e=>{g=e,h.a.isNullOrEmpty(g)||g===$.a||(n=!0)});p.push(e)}else n=!0,i.entityFormOptions.formId=g.guid;Promise.all(p).then(()=>{i.entityFormOptions.formId=n?g.guid:"",i.entityMetadata={DisplayName:a.metadata.entities[i.entityFormOptions.entityName].DisplayName},a.data.entities[l]&&a.data.entities[l].hasOwnProperty(i.entityFormOptions.entityId)?i.title=Object(y.ec)(a,l,new h.a(i.entityFormOptions.entityId)):i.title=Object(y.ec)(a,i.entityFormOptions.entityName,new h.a(i.entityFormOptions.entityId)),o.unshift(i),r(re({sessionTabs:o,activeTabId:i.id,messageId:n?"":"quick_view_form_not_exist_message"},t))})}else o.unshift(e),r(re({sessionTabs:o,activeTabId:e.id},t));return Promise.resolve()}r(re({sessionTabs:o,activeTabId:e.id},t))}}}}(e,r)),closeSessionTab:(e,r)=>t(ae(e,r)),updateSessionTab:(e,r)=>t(le(e,r)),closeAllSessionTabs:e=>t(ie(e)),dismissMessage:e=>t(oe(e)),markActiveTab:(e,r,n)=>t(Object(ce.b)(e,r,n)),initializeReferencePanelControl:(e,r)=>t(se(e,r)),cleanReferencePanelState:e=>t(ne(e)),executeNotifyHandlersThatEventOccurred:e=>t(function(e){return{type:"execute.notifyhandlersthatevenoccurred.async",execute({dispatch:t,getState:r},n){let i=null;try{switch(e.eventName){case"onresultopened":t(Object(de.U)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onselection":t(Object(de.V)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onpostsearch":t(Object(de.S)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onlookuptagclick":const a="ClientApi.ExecuteNotifyHandlersThatEventOccurred.runOnLookupTagClick",o=e.contextToken,s=e.fieldName,c=e.record;let l=!1;const u=Object(de.u)(a,r(),n,e.pageId,c);u&&(l=t(u.runOnLookupTagClick(o,s,null,c,r()))),i=l}return Promise.resolve(i)}catch(e){throw ue.a.getInstance().eventManager.ReportComponentFailure("ClientApi.ExecuteNotifyHandlersThatEventOccurred.executeNotifyHandlersThatEventOccurred",e),e}}}}(e)),getConnectorsApi:e=>null,executeRollupRequest:(e,r,n)=>t(function(e,t,r){return{type:"customcontrol.executeRollupRequest.async",execute({dispatch:n,getState:i},a){if(e&&t){const i=new Me(e,t),o=Le.a.execute(i).then(e=>e.json()).then(i=>{if(i){const o=[];for(const e in i)-1!==e.indexOf("@")||e.startsWith("_")||o.push(e);const s=new _.a(e.entityType,h.a.fromExternalGuid(e.id));return n(Object(Re.a)(r,s,o)).then(()=>{a.EventManager.ReportComponentSuccess(Ve.a+".Action",[{name:"APIName",value:Ve.a+".Action.ExecuteRollupRequest"},{name:"target.entityType",value:e.entityType}])},r=>{a.EventManager.ReportComponentFailure(Ve.a+".Actions",r,"refreshRecordData failure error message",[{name:"APIName",value:Ve.a+".Actions.ExecuteRollupRequest"},{name:"target.entityType",value:e.entityType},{name:"target.id",value:e.id},{name:"fieldName",value:t},{name:"jsonResponse",value:i}])})}});return Le.a.Diagnostics.traceInfo(Ve.a+".refreshRecordData","refresh record data return promise"),o}return Promise.resolve()}}}(e,r,n)),getResource:e=>t(function(e){return{type:"customcontrol.getresources.async",execute({dispatch:t,getState:r},n){const i=n.AssetLoader,a=r(),o=Object(Be.t)(a);if(3===e.Type||2===e.Type)return i.loadRawData(o+e.Name)}}}(e)),getRecordSetQueryKey:e=>e?e.getPreviousQueryKey():null,loadResources:e=>t(Object(ze.a)(e)),triggerOfflineMetadataSync:()=>t(Object(Se.h)()),retrieveFormWithAttributes:(e,r,n)=>t(Object(Tt.c)(new _.a(e),h.a.tryParse(r),n)),loadManifest:(e,r)=>t(Object(Ie.c)(e,r)),updateOutputs:(e,r,n,i,a,o,s)=>t(function(e,t,r,n,i,a,o){return{type:"outputs.update",execute({dispatch:s,getState:c},l){try{const l={},u={};if(a)for(const e of Object.keys(a)){const t=a[e];let r=e;switch(t.fieldName&&(r=t.fieldName),(t.paramType===Nt.a.LookupSimple||t.paramType===Nt.a.LookupCustomer||t.paramType===Nt.a.LookupOwner||t.paramType===Nt.a.LookupRegarding||t.paramType===Nt.a.LookupMultiEntity)&&t.value&&t.value instanceof Array&&(t.value.length>0?t.value=t.value[0]:t.value=null),t.type){case 0:l[r]=a[e];break;case 2:u[r]=a[e]}}const d=new Array,p=s(Object(me.a)(e,l,!1,!1,t,r,i,o));if(d.push(p),Object(B.a)(c(),e).forms){const t=s(Object(wt.b)(e,n,o,u));d.push(t)}else{const t=s(Object(Ft.b)(e,n,u));d.push(t)}return Promise.all(d)}catch(i){const o=n+" failed at updating its outputs",s=Object(C.b)(c(),n);return l.EventManager.ReportComponentFailure(s+".CustomControl.updateOutputs",i,o,[{name:"APIName",value:Ve.a+".Actions.UpdateOutputs"},{name:"customControlId",value:n},{name:"pageId",value:e},{name:"entityTypeName",value:t},{name:"recordId",value:r},{name:"outputs",value:JSON.stringify(a)}]),l.TraceManager.getTracer("customcontrol").warn(s+" failed at updating its outputs"),null}},sync:!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,r,n,i,a,o,s)),updateFieldValue:(e,r,n,i,a,o,s)=>t(Object(me.a)(e,r,!1,n,i,a,o,s)),runCustomOpenRecord:(e,r,n,i)=>t(function(e,t,r,n){return{type:"record.open",execute(i,a){const o=a.ScriptManager.getContainer(e).getEventManager(),s=new h.a(r),c=Object(S.f)(n,s,t);let l=i.dispatch(Object(xt.b)(c,e,t,s));return l=new At.a(i,a,c,e,t,s),i.dispatch(o.runOnRecordOpen(n,r,l))}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,r,n,i)),getBoundFileObject:(e,r,n,i)=>{if(null==e||null==r||null==r.id||null==n)return null;const a={id:new h.a(r.id),etn:r.entityType};return t(Object(Kt.c)(e,a,n,i,"full"))},saveEmbeddedEntity:(e,r,n,i,a,o,s=!1,c)=>t(Object(Et.a)(e,r,n,i,a,o,s,c)),renderNestedCustomControl:Mt,renderReactSubtree:Ne.createPortal,retrieveView:(e,r,n,i)=>t(Object(je.a)(e,r,n,i)),retrieveViewSelector:(e,r)=>t(Object(je.b)(e,r)),retrieveGridData:e=>t(Object(Oe.d)(e)),retrieveRecordDataForForm:(e,r,n,i,a)=>t(Object(Z.e)(Lt(e),h.a.tryParse(r),n,i,a)),retrieveForm:(e,r,n)=>{const i=h.a.tryParse(r),a=Lt(e);return t(Object($.b)(a,i,n)).then(e=>t(Object(pe.c)(i,a.etn)).then(()=>e))},retrieveEntityData:e=>t(Object(_e.f)(e,!1,[])),retrieveChartDrilldownAttributes:e=>{return t((r=e,{type:"customcontrol.charts.attributes.retrieve.async",execute:({dispatch:e,getState:t},n)=>e(Object(_e.f)(r,!0,[])).then(()=>{const e=t(),n=Object(Ke.d)(e,r);if(n&&Object.keys(n).length>0){const t={};for(const i in n){const a=n[i];Vt(e,r,i,a)&&(t[i]=a)}return t}return null},e=>{const t=e.get_message();return n.EventManager.ReportComponentFailure(Ve.a+".CustomControl.retrieveChartDrilldownAttributes",new Error(t),t,[{name:"APIName",value:Ve.a+".Actions.RetrieveChartDrilldownAttributes"},{name:"Entity",value:r}]),null})}));var r},refreshDataSetParameter:(e,r)=>t(_t(e,r)),retrieveLookupMetadataAction:e=>{return t((r=e,{type:"customcontrol.retrieveLookupMetaData.async",execute({dispatch:e,getState:t},n){if(r instanceof jt.a){const n={retrieveGridDataAction:t=>e(Object(Oe.d)(t)),retrieveViewAction:(t,r,n,i)=>e(Object(je.a)(t,r,n,i)),retrieveViewSelectorAction:(t,r)=>e(Object(je.b)(t,r)),runPreSearch:(r,n,i)=>e(Object(de.W)(Object(S.j)(t(),r),r,n,i)),runSetAdditionalParams:(r,n,i)=>e(Object(de.X)(Object(S.j)(t(),r),r,n,i)),refreshCustomDataProviderAction:(t,r,n,i)=>e(Object(it.b)(t,r,n,i)),getEntityMetadataAction:(t,r)=>e(Object(_e.f)(t,!1,r))};return r.retrieveLookupMetadata(t,n)}}}));var r},retrieveDataSetLookupCellParameter:(e,r,n)=>t(function(e,t,r){return{type:"customcontrol.retrieveDataSetLookupCellParameter.async",execute:({dispatch:n,getState:i},a)=>n(_t(t,r)).then(()=>{const r=t.retrieveDataSetObject(i(),e,a);return Promise.resolve(r)}).catch(e=>{a.EventManager.ReportComponentFailure(Ve.a+".Actions",{name:"error",message:e.get_message()},null,[{name:"APIName",value:Ve.a+".Actions.RetrieveDataSetLookupCellParameter"}])})}}(e,r,n)),updateControlMemoizedDataSet:(e,r,n)=>t(function(e,t,r){return{type:"customcontrol.updateControlMemoizedDataSet",sync:!0,execute({dispatch:n,getState:i},a){const o=i(),s=e.retrieveDataSetObject(o,null,null,null,a);e.linkToParameter(s,t),e.updateControlMemoizedParameter(o,s,!0,r)}}}(e,r,n)),loadResourceStrings:e=>{return t((r=e,{type:"customcontrol.loadresourcestrings.async",execute({dispatch:e,getState:t},n){const i=r.CustomControlId;if(!i)return Promise.resolve();const a=t(),o=Ge.a.getControlsResourceKeyList(i);if(!o)return Promise.resolve();const s=Object(Ue.d)(a);if(!s)return e(Object(Xe.e)(o));const c=[];for(const e of o)s.hasOwnProperty(e)||c.push(e);return 0===c.length?Promise.resolve():e(Object(Xe.e)(c))}}));var r},retrieveLookupData:e=>t(Object(Oe.d)(e)),setFieldControlPersonalization:(e,r,n)=>t(Object(Ee.j)(e,r,n)),setGridControlPersonalization:(e,r,n)=>t(Object(Ee.m)(e,r,n)),setDashboardControlPersonalization:(e,r,n)=>t(Object(Ee.i)(e,r,n)),setGenericControlPersonalization:(e,r,n)=>t(Object(Ee.k)(e,r,n)),setGlobalControlPersonalization:(e,r)=>t(Object(Ee.l)(e,r)),setPowerBISignedInState:(e,r)=>t(Object(ge.b)(e,r)),beginSecureSessionForResource:(e,r,n,i)=>t(function(e,t,r,n){return{type:"customcontrol.beginsecuresessionforresource",execute(i,a){const o=new ke.a(a,i);return n?o.beginSecureSessionForResource(e,t,r):o.beginSecureSessionForResourceSilent(e,t,r)},shouldReceiveFullStore:!0}}(e,r,n,i)),setXrmObject:e=>{},addPendingCommandManagerId:(e,r,n,i)=>{let a;t(Object(Pt.a)(e,r,n,i));return{promise:new Promise(e=>{a=e}),resolve:a}},initializeCommandManager:(e,r,n,i,a)=>{let o;t(Object(Pt.b)(e,r,n,i,a));return{promise:new Promise(e=>{o=e}),resolve:o}},retrieveRecordCommand:(e,r,n,i,a,o,s,c,l,u)=>t(Object(Pt.c)(u,e,r,n,i,a,o,s,c,l)),setValue:(e,r,n,i)=>e&&r?t(function(e,t,r,n){const i=[{name:"snapshotId",value:n},{name:"entityTypeName",value:t.etn},{name:"attributeNameValuePairs.length",value:r?Object.keys(r).length:null}];return{type:"control.update.value.by.snapshot.async",execute({dispatch:a,getState:o},s,c){const l=o(),u=Object(S.j)(l,e),d=Object(S.x)(u),p=Object(fe.a)(l,n,t,r,!1,u,s.TraceManager.getTracer("Forms.UpdateValue")),g=h.a.isNullOrEmpty(t.id)?ve.a.Create:ve.a.Update;if(i.push({name:"CorrelationId",value:c.correlationId},{name:"ContextId",value:c.contextId},{name:"ActionStack",value:c.stack},{name:"mode",value:g}),n)return a(Object(be.b)(l,n,p)),s.EventManager.ReportComponentSuccess("Forms.UpdateValue.updateDataSnapshot",i),Promise.resolve();const m=Object(ye.b)(l,t,p,d,g),b=m.payload.snapshotId;return a(m),i.push({name:"newSnapshotId",value:b}),s.EventManager.ReportComponentSuccess("Forms.UpdateValue.createDataSnapshotAction",i),Promise.resolve(b)},getFailureParameters:(e,t)=>i}}(i,e,r,n)).then(e=>Promise.resolve(e||n)):Promise.reject("setValue: entityReference and controlKeyValuePairs parameters are required"),save:(e,r=[])=>t(Object(Pe.c)(e,!1,r)),openPopup:e=>t(Object(Y.a)(e)),closePopup:e=>t(Object(W.a)(e)),loadWebResource:(e,r)=>t(He(e,r)),registerOngoingWork:(e,r,n,i)=>t(function(e,t,r,n){return{type:"customcontrol.registerworkoutstanding",execute:({dispatch:i,getState:a},o)=>(Ot.a.getInstance().addWorkOutstandingPromise(e,t,r,n),Promise.resolve())}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,r,n,i)),isPresenceEnabledEntity:e=>Object(q.b)(e),getPresenceMappedField:e=>Object(q.a)(e),fireXrmEvent:(e,r,n,i,a)=>{const o=t(Object(Ce.b)(r,n));let s=null;if(o&&o.ui&&o.ui.controls&&(s=o.ui.controls.get(e)),s)switch(i){case 0:s.fireOnKeyPress&&s.fireOnKeyPress()}},sendLookupRequest:(e,r,n,i,a,o,s)=>t(Wt(e,!0,r,n,i,a,o,s)),runPreSearch:(e,r,n)=>{t(function(e,t,r){return{type:"CCF.RunPreSearch",execute({dispatch:n,getState:i}){n(Object(St.f)(r,t,e)),n(Object(de.W)(e,r,t)),n(Object(de.X)(e,r,t)),n(Object(St.e)(r,t,e))},sync:!0}}(e,r,n))},runOnReadyStateComplete:(e,r,n)=>{t(function(e,t,r){return{type:"CCF.RunOnReadyStateComplete",execute({dispatch:n,getState:i},a){a.ScriptManager.containerExists(t)&&n(a.ScriptManager.getContainer(t).getEventManager().runOnReadyStateComplete(e,null,r))},sync:!0}}(e,r,n))},retrieveLookupRecordsBySearchString:(e,r,n)=>t(Object(Jt.a)(e,r,n)),retrieveLookupRecordsByIds:(e,r,n)=>t(Object(Jt.b)(e,r,n))},e={actions:tr,propBagMethods:{utils:er,navigation:n,device:$t,mode:Zt}},e}}))(o.a);class cr extends a.Component{constructor(e,t){super(e),this._updateCounter=0,this._isUpdateScheduled=!1,this._reRunMapStateToProps=()=>{this._isUpdateScheduled||(this._isUpdateScheduled=!0,Object(or.c)(()=>{this._isUpdateScheduled=!1,this._updateCounter++,this.forceUpdate()}))},this._reRunMapStateToProps=this._reRunMapStateToProps.bind(this)}render(){let e=null,t=null;return this.context&&this.context.CustomControlGlobalHelper&&(e=this.context.CustomControlGlobalHelper,t=this.context.TraceManager.getLogLevel()),a.createElement(s.a.Provider,{value:this.context},a.createElement(sr,Object.assign({},this.props,{contextHelper:e,logLevel:t,updateCounter:this._updateCounter,reRunMapStateMainProps:this._reRunMapStateToProps})))}}function lr(e){const t="cm"+Object(ir.a)();return a.createElement(nr.a,{commandbarDisplayMode:e.commandbarDisplayMode,addedCommandList:e.addedCommandList,key:e.key,iconPosition:e.iconPosition,id:e.id,commandManagerId:e.commandManagerId||t,ribbonId:e.ribbonId,selectedRecords:e.selectedRecords,width:e.width,metaDataLoadedResolve:e.metaDataLoadedResolve,isHidden:e.isHidden,commandBarStyle:e.commandBarStyle,customCommandManagerStyle:e.customCommandManagerStyle,contextToken:e.contextToken,rootZIndex:e.rootZIndex,customControlType:e.customControlType})}function ur(e){return{commandbarDisplayMode:void 0!==e.commandbarDisplayMode&&null!==e.commandbarDisplayMode?e.commandbarDisplayMode:ar.a.IconLabel,id:e.id,commandManagerId:e.commandManagerId,ribbonId:e.ribbonId,mainMenuLength:e.mainMenuLength,iconPosition:e.iconPosition,selectedRecords:dr(e.selectedRecords),key:e.key,commandBarStyle:e.commandBarStyle,customCommandManagerStyle:e.customCommandManagerStyle,isHidden:e.isHidden,width:e.width,metaDataLoadedResolve:e.metaDataLoadedResolve,addedCommandList:e.addedCommandList,contextToken:e.contextToken,rootZIndex:e.rootZIndex,customControlType:e.customControlType}}function dr(e){const t=[];if(e)for(const r of e)t.push(Lt(r));return t}function pr(e,t){if(e===t)return!0;if(e&&t&&e.length===t.length){const r=e.length;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}return!1}cr.contextType=i.a},"3MuQ":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="section.label";function a(e,t,r,a){const o=Object(n.v)(t);return{type:i,payload:a,meta:{pageId:e,contextKey:o,sectionName:r}}}},"3c9R":function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return d}));var n=r("jRy5"),i=r("dHD5"),a=r("i1f0"),o=r("mIxf"),s=r("bT7G"),c=r("arV0"),l=r("ApeL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const u="attribute.precision";function d(e,t,r,d){return{type:"attribute.precision.update",sync:!0,execute({dispatch:p,getState:h},g){let m=h();p(function(e,t,r,a){if(t&&t.contextTokenType&&t.contextTokenType===n.a.GridRow)return Object(l.e)(e,t,r,a);const o=Object(i.x)(t);return{type:u,payload:a,meta:{pageId:e,contextKey:o,dataFieldName:r}}}(e,t,r,d)),m=h();let b=null,y=null,f=null,v=null;if(t&&t.contextTokenType&&t.contextTokenType===n.a.GridRow)b=t.entityTypeName?t.entityTypeName:null,y=t.recordId?t.recordId:null,f=Object(i.t)(t),v=Object(i.r)(t);else{const r=Object(c.g)(m,e);b=r&&r.entityTypeName?r.entityTypeName:null,y=r&&r.id?r.id:null,f=null,v=t}const C=Object(a.ac)(m,e,t),S=Object(s.d)(m,C,{etn:b,id:y},r),I={[r]:S};p(Object(o.a)(e,I,!0,!0,b,y?y.guid:null,f,v))}}}},"49Nd":function(e,t,r){"use strict";r.d(t,"g",(function(){return n})),r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"f",(function(){return c})),r.d(t,"e",(function(){return l})),r.d(t,"j",(function(){return u})),r.d(t,"h",(function(){return d})),r.d(t,"i",(function(){return p})),r.d(t,"k",(function(){return h}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n="Grid_Paging_Mask",i="Grid_StatusMessage_Mask",a="Grid_ItemsSelected_Mask",o="Grid_TotalCount_Mask",s="Grid_ToolTip_FirstPage",c="Grid_ToolTip_PreviousPage",l="Grid_ToolTip_NextPage",u="Grid_TotalCount_SpaceMask",d="Grid_TotalCount_Approximate",p="Grid_TotalCount_Exact",h=[n,i,a,o,s,c,l,u,d,p]},"4U8P":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="header.commandbarvisible";function a(e,t,r){const a=Object(n.v)(t);return{type:i,payload:r,meta:{pageId:e,contextKey:a}}}},"5UPV":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="dataset.set.newPageRequested";function a(e,t,r){const a=Object(n.y)(t),o=Object(n.v)(t);return{type:i,payload:r,meta:{pageId:e,contextKey:a,dataSetContextKey:o}}}},"5iTp":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){const i=Object(n.cb)(e,t,r);return i?i.footer:null}},"6Qf/":function(e,t,r){"use strict";r.d(t,"f",(function(){return g})),r.d(t,"d",(function(){return m})),r.d(t,"e",(function(){return f})),r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return y}));var n=r("SAYH"),i=r("dHD5"),a=r("BFlg"),o=r("ZJsz"),s=r("P6DH"),c=r("3/02"),l=r("Lyxw"),u=r("ujVH"),d=r("jAuy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const p="grid.initialize",h="grid.initialize.xrmready";function g(e,t,r){return{type:"grid.preinitialize.sync",sync:!0,execute({dispatch:n,getState:i},o){const s=a.x+".gridPreInitializedAction";try{n(b(null,e,t,r,void 0,void 0,void 0,void 0,null));const i=[{name:"entityTypeName",value:e}];return o.EventManager.ReportComponentSuccess(s,i),Promise.resolve(void 0)}catch(t){const r="Failed for "+e+" with error "+t.message;return o.EventManager.ReportComponentFailure(s,Error(r)),Promise.resolve(void 0)}}}}function m(e,t,r,n,i,d,p,h,g){return e?{type:"grid.initialize.async",execute({dispatch:m,getState:y},f){const v=a.x+".gridInitializedAction";try{let a=null;Object(l.c)(y(),c.zb)&&(a=function(e,t,r){const n=Object(s.v)(e,t,r),i=Object.assign({},o.a);return n&&(n.filters&&(i.filters=n.filters),n.customFilter&&(i.customFilter=n.customFilter),n.pageNumber&&(i.pageNumber=n.pageNumber),n.pagingRefreshInput&&(i.pagingRefreshInput=n.pagingRefreshInput)),i}(y(),r,n)),m(b(e,t,r,n,i,d,p,h,a,g));const C=[];C.push({name:"entityTypeName",value:t}),f.EventManager.ReportComponentSuccess(v,C);return Object(l.c)(y(),c.L)&&m(Object(u.b)(r,n)),Promise.resolve(void 0)}catch(e){const r="Grid initialized failed for entity type "+t;return f.EventManager.ReportComponentFailure(v,Error(r)),Promise.reject(void 0)}}}:null}function b(e,t,r,s,c,l,u,h,g,m){const b=c&&c.Parameters?c.Parameters[a.j]:null;try{let c=!0;b&&(c="true"===b);const y=Object(i.u)(s),f={contextKey:y,initialDataSetState:Object.assign(Object.assign(Object.assign({},o.a),g),{viewId:e?e.viewId:null,fetchXml:e?e.fetchXml:null,relationshipName:l,relationshipRoleOrdinal:u,useRollupView:h||!1,commandManagerId:m||Object(d.d)(r,s),controls:{homepageGrid:{parameters:{0:{Name:a.C,Value:e&&e.viewId?n.a.toString(e.viewId):null},1:{Name:a.j,Value:c},2:{Name:a.u,Value:t}}}}})};return{type:p,payload:f,meta:{pageId:r,contextKey:y}}}catch(e){throw Error(e)}}function y(e,t,r,s){const c=Object(i.u)(s),l=n.a.tryParseOrNull(t),u={contextKey:c,initialDataSetState:Object.assign(Object.assign({},o.a),{viewId:l||null,fetchXml:null,commandManagerId:Object(d.d)(r,s),controls:{homepageGrid:{parameters:{0:{Name:a.C,Value:t||null},1:{Name:a.j,Value:!1},2:{Name:a.u,Value:e}}}}})};return{type:p,payload:u,meta:{pageId:r,contextKey:c}}}function f(e,t,r,n){return t(e.ScriptManager.getContainer(n).getEventManager().loadGridScripts(r,n))}},"7+p5":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("Lyxw"),i=r("3/02"),a=r("IqkD");function o(e){if(Object(n.a)(e,i.S,i.h)){return!!Object(n.a)(e,i.d,i.Lc)||1033===Object(a.s)(e)}return!1}},"7TDv":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n="formSelector.visible";function i(e,t,r){return{type:n,payload:{visible:r},meta:{pageId:e,formId:t}}}},"7k+e":function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return o})),r.d(t,"c",(function(){return s}));var n=r("dHD5"),i=r("BFlg");const a="chart.drilldownparameters.update",o="ChartDrillDownParameters";function s(e,t,r){return{type:"chart.drilldownparameters.update.async",execute({dispatch:s,getState:c},l){const u=l.TraceManager.getTracer(i.z),d=i.x+".updateChartDrillDownParametersAction";try{u.info("Updating the chart drilldown parameters"),t||(t=Object(n.k)(c(),e));const i=Object(n.v)(t);return s(function(e,t,r){return{type:a,payload:{name:o,value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,i,r)),l.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){const t="Updatation of the chart drilldown parameters failed with error : "+e.message;l.EventManager.ReportComponentFailure(d,Error(t))}}}}},"7p56":function(e,t,r){"use strict";r.d(t,"a",(function(){return Ht}));var n=r("nuS9"),i=r("4fxQ"),a=r("D9ys"),o=r("u+q+"),s=r("YWpA"),c=r("hPFj"),l=r("H/hG"),u=r("e9UD"),d=r("znb3"),p=r("223Y"),h=r("VnpK"),g=r("POU9"),m=r("vP/5"),b=r("sclX"),y=r("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const f=2/(1+Math.sqrt(5));class v extends n.Component{constructor(e){super(e),this._memorizedDescriptor=null,this.onMeasuring=this.onMeasuring.bind(this),this.state={width:0,height:0}}_getGoldenRatioHeight(e){return f*e}onMeasuring(e,t){let r=!1;const n={};e!==this.state.width&&(n.width=e,r=!0),t!==this.state.height&&(n.height=t,r=!0),r&&this.setState(n)}render(){const e=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(y.z):null;if(!this.props||!this.props.showChart||!this.props.configuration)return e&&e.info("Chart not rendered because the configuration is missing or show chart is set to false"),null;this._memorizedDescriptor&&this.props.chartId===this._memorizedDescriptor.Id||(this._memorizedDescriptor={Id:this.props.chartId,Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1});const t=parseFloat(getComputedStyle(document.documentElement).fontSize),r=this._getTopAndBottomAdjustment(t),i=this._getLeftAndRightAdjustment(t);let a,o;this.props.isLayoutVertical?(a=this.state.width-i,o=this._getGoldenRatioHeight(a),this.props.style.minHeight=o+r):(a=Math.max(this.state.width,320)-i,o=this.state.height-r);const c={minWidth:a.toString()+"px",minHeight:o.toString()+"px"},l={width:a>0?a:-1,height:o>0?o:-1,eventListeners:[{eventname:"onChartPaneClose",eventhandler:[this._closeChartPane.bind(this)]}]};return n.createElement(s.a,{key:"pageChart_"+this.props.id,testhooks:{id:"pageChart_"+this.props.id},style:this.props.style,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0},n.createElement(s.a,{key:"pageChart_"+this.props.id+"_container",style:c},n.createElement(p.c,{key:this.props.chartId,controlId:this.props.chartId,id:this.props.id,configuration:this.props.configuration,descriptor:this._memorizedDescriptor,parentDefinedControlProps:l,parentContextToken:this.props.contextToken})))}_closeChartPane(){this.props.closeChartPaneHandler(this.props.id,this.props.contextToken,!1)}_getTopAndBottomAdjustment(e){let t=0;return this.props.style.borderTopWidth&&(t+=e*("string"==typeof this.props.style.borderTopWidth?parseFloat(this.props.style.borderTopWidth||"0px"):this.props.style.borderTopWidth)),this.props.style.paddingTop&&(t+=e*("string"==typeof this.props.style.paddingTop?parseFloat(this.props.style.paddingTop||"0px"):this.props.style.paddingTop)),this.props.style.borderTop&&(t+=1),this.props.style.borderBottom&&(t+=1),t}_getLeftAndRightAdjustment(e){let t=0;return this.props.style.paddingLeft&&(t+=e*("string"==typeof this.props.style.paddingLeft?parseFloat(this.props.style.paddingLeft||"0px"):this.props.style.paddingLeft)),this.props.style.paddingRight&&(t+=e*("string"==typeof this.props.style.paddingRight?parseFloat(this.props.style.paddingRight||"0px"):this.props.style.paddingRight)),this.props.style.borderLeft&&(t+=1),this.props.style.borderRight&&(t+=1),t}}var C=r("SAYH"),S=r("ah4O"),I=r("KBcj"),_=r("d0w6"),O=r("iWfp"),T=r("XvLr"),j=r("P6DH"),P=r("b6Tl"),E=r("a72m"),x=r("EY5k"),A=r("YxC/"),w=r("FZDd"),F=r("iZ7K"),N=r("eXjw"),k=r("OmkB"),D=r("tOh6"),M=r("sZ+8"),R=r("69Qu"),L=r("RJiR"),V=r("0kGT"),B=r("3/02"),G=r("Lyxw"),X=r("PMTb");let U=[];class z extends n.Component{constructor(e){super(e),this._onItemIconPointerDown=this._onItemIconPointerDown.bind(this),this._onChange=this._onChange.bind(this),this.props.entityTypeName.toLowerCase()===j.a&&(this.props.loadAllActivityTypes(e.activities),this.props.loadAllActivityResourceString())}_getEntityTypeNameFromViewId(e){return e&&this.props.gridViewSelectorItems&&this.props.gridViewSelectorItems[e]&&this.props.gridViewSelectorItems[e].relatedEntityName?this.props.gridViewSelectorItems[e].relatedEntityName:null}_onChange(e){var t;this.props.isGridRoot&&this.props.pageToEditedViewMapId&&this.props.selectedViewId!==e&&this.props.removeEditedViewPageMap(null===(t=this.props.pageToEditedViewMapId)||void 0===t?void 0:t.guid,new C.a(this.props.selectedViewId)),this.props.onChange(e,this.props.entityTypeName===j.a?this._getEntityTypeNameFromViewId(e):this.props.entityTypeName)}_isViewSelectorHidden(){return!(this.props.gridViewSelectorItems&&this.props.viewCategories&&this.props.selectedViewId)}render(){const e=Object(A.c)(this.props.resourceStrings,T.VIEWSELECTOR_TOOLTIP),t=this.props.contextString===y.h.GRID,r=t?this._onItemIconPointerDown:null,i=this.props.useViewSelectorV2?this.props.isPhone:this.props.isTablet,a=i?this.props.styleProps.textStyleMobile:this.props.styleProps.textStyle,o=i?this.props.styleProps.viewSelectorMobileStyle:this.props.styleProps.viewSelectorStyle,s=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(y.z):null;if(this._isViewSelectorHidden())return s&&s.info("View Selector not rendered because view selector items or view categories or selected view is not available."),null;const c=[];let l=!1;for(const e in this.props.gridViewSelectorItems){const r=this.props.gridViewSelectorItems[e];if(!r)continue;const n=r.isUserView;let i;if(n&&(l=!0),this.props.entityTypeName===j.a&&this.props.pinnedActivityView){const e=r;i=e.isPinned&&this.props.pinnedActivityView.PinnedEntity===e.relatedEntityName}else i=r.isPinned;const a=t?i?d.a.Pinned:d.a.Pin:null,o='""',s='""',u={":hover":{"::before":{content:i?o:s}}};this.props.useViewSelectorV2&&Object.assign(u,{marginLeft:"8px",marginRight:"8px"});const p=t?u:null,h=Object(A.c)(this.props.resourceStrings,T.VIEWSELECTOR_DEFAULTVIEW),g=Object(A.c)(this.props.resourceStrings,T.VIEWSELECTOR_SETDEFAULTVIEW),m=t?i?h:g:null;let b="";b=this.props.entityTypeName===j.a&&this.props.allActivitiesString&&this.props.shouldDisplayNestedViewSelector?(U.indexOf(r.relatedEntityName)+1).toString():n?_.b.userview.toString():_.b.savedview.toString();let y=r.name;e===this.props.selectedViewId&&this.props.isEdited&&(this.props.isRTL?y="*"+y:y+="*"),c.push({value:e,text:y,categoryId:b,iconType:a,iconTitle:m,iconStyle:p})}if(this.props.selectedViewId&&this.props.quickFindViewId&&this.props.quickFindViewId===this.props.selectedViewId){const e=Object(A.c)(this.props.resourceStrings,T.QUICK_FIND_VIEWS_LABEL_ID);c.push({value:this.props.selectedViewId,text:e,categoryId:_.b.savedview.toString()})}const u=l?this.props.viewCategories:this.props.viewCategories.filter(e=>e.id!==_.b.userview.toString());return this.props.isGridRoot&&this.props.isInMobileModeForOct2019?n.createElement(L.c,{pageId:this.props.pageId},this.props.isAdvancedFindView?n.createElement(X.a,null,"New view"):n.createElement(L.k,{items:c,selectedItemId:this.props.selectedViewId,onChange:this._onChange})):this.props.isAdvancedFindView?n.createElement(X.a,{style:a},"New view"):n.createElement(S.a,{id:this.props.id,testhooks:{id:"ViewSelector_"+this.props.selectedViewId},value:this.props.selectedViewId,role:"presentation",title:e,categories:u,options:c,style:this.props.style,caretType:d.a.ChevronDownMed,caretStyle:this.props.styleProps.caretStyle,textStyle:a,viewSelectorStyle:o,onChange:this._onChange,onItemIconPointerDown:r,createAccessibilityComponent:O.a,createKeyboardShortcut:O.b,parentCustomControlId:this.props.id,rootZIndex:this.props.rootZIndex,isRTL:this.props.isRTL,useViewSelectorV2:this.props.useViewSelectorV2,placeItemIconOnRight:!0,useHeader:this.props.isGridRoot})}componentDidMount(){if(this.props.viewIds?this.props.loadGridViewsByViewId(this.props.viewIds,this.props.entityTypeName):this.props.loadViewsByType(this.props.queryViewSelectorTypes,this.props.entityTypeName,this.props.gridViewSelectorItems),this._isViewSelectorHidden())return;let e=!1;if(this.props.selectedViewId&&""!==this.props.selectedViewId&&(this.props.gridViewSelectorItems&&this.props.gridViewSelectorItems[this.props.selectedViewId]||this.props.quickFindViewId&&this.props.quickFindViewId===this.props.selectedViewId)&&(e=!0),!e){if(this.props.viewIds){this.props.viewIds.find(e=>e.guid===this.props.selectedViewId)&&(e=!0)}this.props.defaultViewId&&this.props.defaultViewId.guid!==C.a.EMPTYSTRING&&this.props.onChange(this.props.defaultViewId.guid,this.props.entityTypeName)}}_onItemIconPointerDown(e){const t=e,r=e.iconType===d.a.Pinned,n=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(y.z):null;let i=e.categoryId,a=this.props.entityTypeName;if(this.props.entityTypeName===j.a){const t=this.props.gridViewSelectorItems;a=t&&t[e.value]?t[e.value].relatedEntityName:a;i=!(!t||!t[e.value])&&t[e.value].isUserView?_.b.userview.toString():_.b.savedview.toString()}n&&n.info(`Toggle the the pin status for ${e.value} for ${a} entity`),this.props.onItemIconPointerDown(a,e.value,i,"",r).then(()=>{if(n&&n.info("Resetting the pin status of all the options and toggle the pin status of the recently selected item"),!r&&this.props.entityTypeName===j.a){const r=this.props.gridViewSelectorItems[t.value];this.props.pinnedActivityView.PinnedEntity=r.relatedEntityName,this.props.pinnedActivityView.ViewId=new C.a(e.value),this.props.pinnedActivityView.ViewType=r.isUserView?_.b.userview:_.b.savedview}for(const e in this.props.gridViewSelectorItems)this.props.gridViewSelectorItems[e].isPinned=e===t.value&&!r;this.forceUpdate()},e=>{n&&n.error("Could not pin the selected view, pinning action failed with error "+e)})}}function H(e,t,r,n){let i=[];if(t===j.a&&n){let t=1;U.forEach(r=>{i.push({id:t.toString(),name:Object(F.f)(e,r)}),t++})}else i=Object(j.mb)(e,r);return i}function q(e,t,r){let n;return t.forEach((t,i)=>{const a=function(e,t,r){let n=Object(I.f)(e,t,r);n&&!Object(R.b)(e)&&Object(M.l)(e,t)&&(n=Object.keys(n).reduce((i,a)=>((n[a].isAvailableInOffline||a===C.a.toString(Object(I.a)(e,t,r)))&&(i[a]=n[a]),i),{}));return n}(e,r,t);a&&(n=Object.assign(Object.assign({},n),a))}),n}z.displayName="DataSetViewSelector";const W=Object(o.a)((function(){let e=null,t=null,r=null,n={gridViewSelectorItems:null,viewCategories:null,allActivitiesString:null,activities:null,activityOptions:null,resourceStrings:null,quickFindViewId:null,styleProps:null};const i=Object(P.a)(),a=Object(A.h)();return(o,s)=>{const c=a(o,T.labelList),l=C.a.toString(Object(I.a)(o,s.entityTypeName,_.a.QUICKFIND_SEARCH));let u=null;let d=null;const p=i(o,s.contextString);U=Object(j.B)(o);let h=!1;if(s.queryViewSelectorTypes&&s.queryViewSelectorTypes.length>0&&!s.viewIds){if(s.entityTypeName===j.a&&s.shouldDisplayNestedViewSelector?(U.forEach(e=>{const t=q(o,s.queryViewSelectorTypes,e);t&&(u=Object.assign(Object.assign({},u),t))}),d=Object(A.e)(o,["ViewSelectorAllActivities"])):u=q(o,s.queryViewSelectorTypes,s.entityTypeName),e)for(const t in u)if(!e[t]||e[t]!==u[t]){h=!0;break}}else if(s.viewIds){const t={};for(let r=0;r<s.viewIds.length;r++){const n=Object(j.qb)(o,s.viewIds[r],s.id);if(n&&n.grid&&n.grid.rows){const r=e?e[n.viewId.guid]:void 0,i=!r||r.name!==n.title||r.queryType!==n.queryType,a=i?{name:n.title,queryType:n.queryType,isDefault:!1,isQuickFindQuery:!1,isUserView:n.isUserView}:r;Object.assign(t,{[n.viewId.guid]:a}),h=h||i}}t&&(u=t)}return!u||e&&Object.keys(e).length===Object.keys(u).length||(h=!0),d&&n.allActivitiesString!==d.ViewSelectorAllActivities&&(h=!0),t!==l&&(h=!0),r!==p&&(h=!0),h&&(e=u,t=l,r=p,n={gridViewSelectorItems:e,viewCategories:H(o,s.entityTypeName,T,s.shouldDisplayNestedViewSelector),allActivitiesString:d&&d.ViewSelectorAllActivities,activities:null,activityOptions:null,resourceStrings:c,quickFindViewId:t,styleProps:r,isInMobileModeForOct2019:Object(V.b)(o),useViewSelectorV2:Object(G.a)(o,B.le,B.h)}),n}}),(function(e){return{loadViewsByType:(t,r,n)=>{const i=[];return t.forEach((t,a)=>{t===_.a.MAIN_APPLICATION_VIEW&&n&&0!==Object.keys(n).length||i.push(e(Object(E.a)(r,t,void 0,void 0)))}),Promise.all(i)},loadAllActivityResourceString:()=>e(Object(x.e)(["ViewSelectorAllActivities"])),loadAllActivityTypes:t=>{let r=null;for(const e in t)t[e].Initialized!==N.a.Initialized&&(r||(r={}),r[e]=["DisplayName","ActivityTypeMask","IsVisibleInMobileClient"]);return r?e(Object(w.e)(r)):Promise.resolve()},loadGridViewsByViewId:(t,r)=>{const n=[];return t.forEach((t,i)=>{n.push(e(Object(E.a)(r,void 0,void 0,t)))}),Promise.all(n)},openPopup:t=>e(Object(D.a)(t)),closePopup:t=>e(Object(k.a)(t))}}))(z);var Y=r("Ki7F"),Q=r("o0iw"),K=r("XIN1"),J=r("Wdaq"),Z=r("/aHX"),$=r("ZGH+"),ee=r("AVDU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const te=42;class re extends n.Component{constructor(e){super(e),this.onMeasuring=this.onMeasuring.bind(this),this.state={commandbarWidth:0},this._lastCommandManagerId=e.commandManagerId}onMeasuring(e){const t=e-((this.props.style.paddingLeft?"string"==typeof this.props.style.paddingLeft?Object($.e)(this.props.style.paddingLeft):this.props.style.paddingLeft:0)+(this.props.style.paddingRight?"string"==typeof this.props.style.paddingRight?Object($.e)(this.props.style.paddingRight):this.props.style.paddingRight:0))-(this.props.backButtonEnabled?te:0);t!==this.state.commandbarWidth&&this.setState({commandbarWidth:t})}componentDidUpdate(){this.props.commandManagerId!==this._lastCommandManagerId&&(this._lastCommandManagerId=this.props.commandManagerId,this.props.setCommandManagerId(this.props.pageId,this.props.commandManagerId,this.props.contextToken))}_renderConsoleAppBackButton(){return this.props.backButtonEnabled?n.createElement(Z.a,{pageId:this.props.pageId}):null}_renderNativeSubgridCommandBar(){return this.props.isNativeMode?n.createElement(L.e,{commandManagerId:this.props.commandManagerId,pageId:this.props.pageId}):null}render(){if(!this.props.pageId||!this.props.ribbonId||!this.props.commandManagerId)return null;const e=!this.state.commandbarWidth,t=n.createElement(Y.a,{commandBarStyle:this.props.commandbarStyles,width:this.state.commandbarWidth,commandbarDisplayMode:Q.a.IconLabel,key:this.props.pageId,iconPosition:K.a.Left,commandManagerId:this.props.commandManagerId,id:this.props.pageId,ribbonId:this.props.ribbonId,relationshipType:this.props.relationshipType,addedCommandList:this.props.addedCommandList,appendedCommandList:this.props.appendedCommandList,contextToken:this.props.contextToken,metaDataLoadedResolve:this.props.metaDataLoadedResolve,isHidden:e,rootZIndex:this.props.rootZIndex,customControlType:this.props.customControlType,isNativeMode:this.props.isNativeMode});return this.props.isInMobileModeForOct2019&&this.props.isGridRoot?t:n.createElement(s.a,{key:"commandBar_"+this.props.pageId,testhooks:{id:"commandBar_"+this.props.pageId},style:this.props.style,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0},this._renderConsoleAppBackButton(),t,this._renderNativeSubgridCommandBar())}}re.displayName="DataSetCommandBar";const ne=Object(o.a)((function(){return(e,t)=>{const r=Object(V.b)(e);return{commandManagerId:Object(j.w)(e,t.pageId,t.contextToken)||t.commandManagerId,backButtonEnabled:Object(ee.d)(e)&&t.isGridRoot&&!t.collapsed,isInMobileModeForOct2019:r}}}),(function(e){return{setCommandManagerId:(t,r,n)=>{t&&r&&n&&e(Object(J.b)(t,r,n))}}}))(re);var ie=r("A6np"),ae=r("jAuy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function oe(e){if(e){const t=e.split(":");if(2===t.length){return t[1].split(",")}}return[]}function se(e){if(e&&e.filterOptions&&e.filterOptions.length>0){let t=e.filterOptions.filter(e=>e.isDefault);const r=e.userSetting,i=r&&r.defaultGridViews&&r.defaultGridViews[e.entityTypeName];let a,o;i&&""!==i.QueueId&&(t=e.filterOptions.filter(e=>Object(j.bb)(i.QueueId).sort().join(",")===oe(e.value).sort().join(","))),e.isGridPaginationStateFeatureEnabled&&null!=e.previousValue&&(a=Object(ae.f)(e.filterOptions,e.previousValue),o=e.previousValue),a||(t.length>0?(a=t[0].text,o=t[0].value):(a=e.filterOptions[0].text,o=e.filterOptions[0].value)),e.updateFilterValue(o);const c=Object(A.c)(e.resourceStrings,T.QUEUE_FILTER_LABEL),l=n.createElement(ie.a,{key:"gridFilter",testhooks:{id:"gridFilter_"+e},title:c,accessibilityLabel:c,defaultValue:a,options:e.filterOptions,onChange:e.onFilterChange,createAccessibilityComponent:O.a,style:e.comboBoxStyle,createKeyboardShortcut:O.b,freeTextMode:!0,suppressFreeTextChangeCallback:!0});return n.createElement(s.a,{key:"GridFilterView",style:e.style},l)}const t=e.TraceManager&&e.TraceManager.getTracer?e.TraceManager.getTracer(y.z):null;return t&&t.info("Queue Filter not rendered because there are no filter options available"),null}var ce=r("KOTC"),le=r("CbNq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ue={Id:"toggleButtonControl",Label:null,Name:"toggleButtonControl",ShowLabel:!1,Visible:!0,Disabled:!1},de={FormFactor:2,CustomControlId:"MscrmControls.FlipSwitch.FlipSwitchControl",Name:"MscrmControls.FlipSwitch.FlipSwitchControl",Version:"1.0.0",Parameters:{value:{Usage:3,Static:!1,Value:0,Type:"TwoOptions",Attributes:{DefaultValue:0,Options:null},Callback:null}},ShouldOverrideControlVisible:!1};function pe(e,t){if(!e.isRollupViewSupported)return null;const r=function(e){const t=[];if(!Array.isArray(e))return t;for(let r=0;r<e.length;++r)t.push({Label:e[r],Value:r});return t}([Object(A.c)(e.resourceStrings,T.ROLLUPVIEW_SWITCH_OFF),Object(A.c)(e.resourceStrings,T.ROLLUPVIEW_SWITCH_ON)]),i=e.isOffline,a=(o=e.toggleValue,s=t,c=e.onToggleChange,l=r,Object.assign(Object.assign({},de),{Parameters:{value:{Usage:3,Static:!1,Type:"TwoOptions",Value:o?1:0,Attributes:{DefaultValue:0,Options:l,DisplayName:s},Callback:c}}}));var o,s,c,l;const u=function(e,t){return Object.assign(Object.assign({},ue),{Label:e,Disabled:t})}(t,i),d="rollup_view_switch_"+e.id;return n.createElement(p.c,{key:d,controlId:d,id:e.id,systemDefinedProperties:null,descriptor:u,configuration:a,formInfo:void 0,shouldRender:!0,parentContextToken:null,parentDefinedControlProps:void 0})}function he(e,t,r,i,a){const o=e.theme,c=e.isRTL,l=e.isActivityManagementFeatureEnabled&&e.entityIsActivityType;return n.createElement(s.a,{key:"ActivityViewContainer",role:"presentation",style:e.activityViewContainerStyle},n.createElement(s.a,{key:"ActivityDueDateFilterView",style:l?e.activityTypeContainerStyle:e.containerStyle},[t,r]),a?n.createElement(s.a,{key:"ActivityTypeFilterView",style:e.activityTypeContainerStyle},[i,a]):null,function(e,t,r,i){if(!t)return;const a=Object(A.c)(e.resourceStrings,T.ROLLUPVIEW_SWITCH_LABEL),o={flex:"1 1 auto",marginLeft:r.sizes.Measures.Measure200,marginRight:r.sizes.Measures.Measure200,marginTop:r.sizes.Measures.Measure050,minWidth:"15rem"},c={whiteSpace:"nowrap",flex:"1 0 auto",marginRight:i?0:r.sizes.Measures.Measure100,marginLeft:i?r.sizes.Measures.Measure100:0};return n.createElement(s.a,{key:"RollupViewControlContainer",style:o},n.createElement(s.a,{key:"rollupViewFilterLabelView",style:c},a),pe(e,a))}(e,e.isRollupViewSupported,o,c))}const ge=Object(o.a)(void 0,(function(e){return{openPopup:t=>e(Object(D.a)(t)),closePopup:t=>e(Object(k.a)(t))}}))((function(e){const t=e.TraceManager&&e.TraceManager.getTracer?e.TraceManager.getTracer(y.z):null;let i,a="";const o=e.isActivityManagementFeatureEnabled&&e.entityIsActivityType;if(e&&e.filterOptions&&e.filterOptions.length>0){const t=e.filterOptions.filter(e=>e.isDefault);o&&(i=Object(le.d)(e.filterOptions)),e.isGridPaginationStateFeatureEnabled&&null!=e.previousValue&&(a=o?e.previousValue:Object(ae.f)(e.filterOptions,e.previousValue)),a||(a=t.length>0?o?t[0].value:t[0].text:o?e.filterOptions[0].value:e.filterOptions[0].text)}const[c,u]=n.useState(a);if(e&&e.filterOptions&&e.filterOptions.length>0){const d={flex:"1 0 auto",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",width:"0px"},p=o?Object(A.c)(e.resourceStrings,e.dueDateFilterLabelResourceString):Object(A.c)(e.resourceStrings,e.entityFilterLabelResourceString);let h=null;p&&(h=n.createElement(l.a,{key:"activityDueDateFilterLabel",style:o?e.activityMgmtLabelStyle:e.labelStyle}," ",p," "));const g=n.createElement(s.a,{key:"activityDueDateFilterLabelView",style:{alignItems:"center",justifyContent:"center"}},h);let m=n.createElement(ie.a,{key:"activityDueDateFilterComboBox",testhooks:{id:"activityDueDateFilterComboBox_"+e.id},id:"activityDueDateFilterComboBox",defaultValue:a,options:e.filterOptions,onChange:e.onFilterChange,createAccessibilityComponent:O.a,style:e.comboBoxStyle,textStyle:d,createKeyboardShortcut:O.b,openPopup:e.openPopup,closePopup:e.closePopup,parentCustomControlId:"activityDueDateFilterComboBox",rootZIndex:e.rootZIndex,accessibilityLabel:p,freeTextMode:!0,suppressFreeTextChangeCallback:!0});o&&(m=n.createElement(ce.a,{key:"activityDueDateFilterComboBox",loader:()=>Promise.all([r.e(10),r.e(11),r.e(13),r.e(12),r.e(14),r.e(15),r.e(17),r.e(21),r.e(28),r.e(90)]).then(r.bind(null,"YDph")).then(e=>e.ComboBox),props:{selectedKey:c,key:"activityDueDateFilterComboBox",id:"activityDueDateFilterComboBox",options:i,onChange:(t,r)=>{u(r.key),e.onFilterChange(r.key)},style:e.dueDatecomboBoxStyle,ariaLabel:p,useComboBoxAsMenuWidth:!0,allowFreeform:!0}}));if(e.isActivityManagementFeatureEnabled&&!e.isOffline&&!e.isMobile&&e.gridEntityName===y.a){let i=null;const a=Object(A.c)(e.resourceStrings,e.activityTypeFilterLabelResourceString);a&&(i=n.createElement(l.a,{key:"activityTypeFilterLabel",style:e.activityMgmtLabelStyle}," ",a," "));const o=n.createElement(s.a,{key:"activityTypeFilterLabelView",style:{alignItems:"center",justifyContent:"center"}},i);let c;if(e.filterOptionsForActivityType&&e.filterOptionsForActivityType.length>0){t&&t.info("Activity Management Filter - Activity Type Filter Rendered with no. of options "+e.filterOptionsForActivityType.length);let i=Object(le.c)(e.filterOptionsForActivityType);if(e.isActivityFilterSelectAllEnabled){const t=Object(A.c)(e.resourceStrings,T.ACTIVITYTYPE_SELECTALL),r=[];r.push({key:"selectAllKey",text:t}),i=r.concat(i)}let o=[];e.isGridPaginationStateFeatureEnabled&&null!=e.activityTypePreviousValues&&(o=Object(le.b)(e.activityTypePreviousValues)),c=n.createElement(ce.a,{key:"activityTypeFilterBox",loader:()=>Promise.all([r.e(10),r.e(28),r.e(40)]).then(r.bind(null,"yiyP")).then(e=>e.ActivityTypeCombobox),props:{key:"activityTypeFilterBox",id:"activityTypeFilterBox",selectedOptionKeys:o,onActivityTypeFilterClear:()=>{e.onActivityTypeFilterClear()},onActivityTypeMenuDismissed:t=>{e.onActivityTypeChange(t)},options:i,ariaLabel:a,isRTL:e.isRTL,style:e.activityTypeContainerStyle,resourceStrings:e.resourceStrings,selectAllEnabled:e.isActivityFilterSelectAllEnabled}})}return he(e,g,m,o,c)}return he(e,g,m,null,null)}return t&&t.info("Activity Filter not rendered because there are no filter options available"),null}));var me=r("nJrx"),be=r("gvL4"),ye=r("Smta"),fe=r("vTeb"),ve=r("evW+"),Ce=r("1AYO"),Se=r("hSDL"),Ie=r("unFF"),_e=r("tJ+6");var Oe=r("kC0I"),Te=r("3rse"),je=r("00VO"),Pe=r("FhVi"),Ee=r("Afz2"),xe=r("Gilj"),Ae=r("cz9j"),we=r("L4PC"),Fe=r("H4dV");class Ne extends n.Component{constructor(e){super(e),this._cachedSelectedFilter="",this._onFilterChange=this._onFilterChange.bind(this),this._toggleJumpBarFlyout=this._toggleJumpBarFlyout.bind(this),this._closeJumpBarDomId="close-jumpbar-"+Object(me.a)(),this._selectedFilterDomId="selected-filter-"+Object(me.a)(),this.state={isFlyoutOpened:!1}}_onOutsideClickHandler(e,t){const r=t.target,n=document.getElementById(e);r&&!n.contains(r)&&n!==r&&this._toggleJumpBarFlyout()}keyDownHandler(e){switch(e.EVENT.keyCode){case Te.a.Escape:this._setIsFlyoutOpenedState(!1)}}_toggleJumpBarFlyout(){this._setIsFlyoutOpenedState(!this.state.isFlyoutOpened)}_setIsFlyoutOpenedState(e){this.setState({isFlyoutOpened:e}),Object(Ae.g)(e)}_filterGrid(e){let t,r=e.getAttribute("data-value");if(r!==this._cachedSelectedFilter&&(this.props.updateDataSetLoadingState(1),this._cachedSelectedFilter=r),1033===this.props.languageId&&r){const t=e.getAttribute("data-value").toUpperCase();t!==r&&(r=`${r}|${t}`)}t=this.props.dataSetFetchXml?Object(je.c)(this.props.dataSetFetchXml,this.props.entityAttributeMetadata,this.props.primaryNameAttribute):this.props.primaryNameAttribute,this.props.applyGridFilter(Object(je.b)(r,t),this.props.isGridRoot,this.props.contextToken),this._setIsFlyoutOpenedState(this.props.renderMobile&&!this.state.isFlyoutOpened)}_onFilterChange(e){let t=e.target;const r=e;("click"===e.type||r&&r.keyCode===Te.a.Enter)&&(e.preventDefault(),t&&"a"===t.tagName.toLowerCase()&&(t=t.parentElement),this._filterGrid(t))}_renderListItem(e,t,r){let i=Object.assign({},this.props.renderMobile?this.props.styles.listItemStyleMobile:this.props.styles.listItemStyle),a=Object.assign(Object.assign({},this.props.styles.hyperlinkStyle),this.props.renderMobile?this.props.styles.hyperlinkStyleMobile:null);return r.describedByElementId&&(i=Object.assign(i,this.props.renderMobile?this.props.styles.listItemSelectedStyleMobile:this.props.styles.listItemSelectedStyle),a=Object.assign(a,this.props.renderMobile?this.props.styles.hyperlinkSelectedStyleMobile:null)),n.createElement(ye.a,Object.assign({},r,{style:i}),n.createElement(fe.a,Object.assign({},e,{style:a}),t))}_createKeyboardShortcuts(){const e=Object(A.c)(this.props.resourceStrings,T.CLOSE_JUMPBAR_ARIALABEL),t=this.keyDownHandler.bind(this),r=[],n=new xe.a([Te.a.Escape],t,!0,"",e);return r.push(n),r}_renderJumpBarAlphabet(){const e=[],t=Object(A.c)(this.props.resourceStrings,T.JUMPBAR_ALPHABET),r=Object(A.c)(this.props.resourceStrings,T.JUMPBAR_NUMBER_INDICATOR),n=Object(A.c)(this.props.resourceStrings,T.JUMPBAR_NUMBER_TOOLTIP),i=Fe.a.getInstance(),a=!!i&&i.get_IsIOS();return t.split(",").forEach(t=>{const i=Object(Oe.h)(t),o=i[0],s=i[1],c=o+"_listItem",l=o+"_link",u={id:c,key:c,accessibilityLabel:String.format(T.FILTERBY_ARIALABEL,s),role:Ee.q,onClick:this._onFilterChange,onKeyDown:this._onFilterChange,tabIndex:-1},d={id:l,key:l,testhooks:{id:l},tabIndex:-1,role:Ee.r,accessibilityHidden:!a,accessibilityLabel:a?String.format(T.FILTERBY_ARIALABEL,s):void 0};o===r&&(d.title=n,d.accessibilityLabel=T.NUMBER_ARIALABEL),this.props.selectedFilter!==o&&this.props.selectedFilter!==s||(u.describedByElementId=this._selectedFilterDomId,u.isSelected=!0,u.tabIndex=0),s&&(u.dataValue=s),e.push(this._renderListItem(d,o,u))}),e}_renderJumpBarAll(){const e=Object(A.c)(this.props.resourceStrings,T.JUMPBAR_ALL),t=Object(A.c)(this.props.resourceStrings,T.JUMPBAR_ALL_TITLE);this._allListItemDomId=e+"_listItem";const r=e+"_link",n=Fe.a.getInstance(),i=!!n&&n.get_IsIOS(),a={id:this._allListItemDomId,key:this._allListItemDomId,onClick:this._onFilterChange,onKeyDown:this._onFilterChange,role:Ee.q,tabIndex:-1,accessibilityLabel:String.format(T.FILTERBY_ARIALABEL,e)},o={id:r,key:r,testhooks:{id:r},tabIndex:-1,role:Ee.r,accessibilityHidden:!i,accessibilityLabel:i?String.format(T.FILTERBY_ARIALABEL,e):void 0,title:t};return this.props.selectedFilter&&this.props.selectedFilter!==e||(a.describedByElementId=this._selectedFilterDomId,a.isSelected=!0,a.tabIndex=0),this._renderListItem(o,e,a)}_renderList(){const e=Object(A.c)(this.props.resourceStrings,T.JUMPBAR_LETTER_TITLE);return n.createElement(be.a,{id:"JumpBarItemsList",key:"JumpBarItemsList",testhooks:{id:"JumpBarItemsList"},title:e,role:Ee.j,onKeyDown:this._onJumpbarKeyDown.bind(this),style:Object.assign(Object.assign({},this.props.styles.jumpBarStyle),this.props.renderMobile?this.props.styles.jumpBarStyleMobile:null),accessibilityLabel:T.JUMPBAR_ARIALABEL},this._renderJumpBarAll(),this._renderJumpBarAlphabet())}_onJumpbarKeyDown(e){const t=e.target;if(this.state.isFlyoutOpened){const r=9===e.keyCode,n=e.shiftKey;if(r){if(e.stopPropagation(),e.preventDefault(),n){if(t.id===this._closeJumpBarDomId)return void document.querySelector("#JumpBarItemsList").lastElementChild.focus();const e=t.previousElementSibling;e?e.focus():t.id===this._allListItemDomId&&document.getElementById(this._closeJumpBarDomId).focus()}else{if(t.id===this._closeJumpBarDomId)return void document.getElementById(this._allListItemDomId).focus();if(t.parentElement&&t.parentElement.lastElementChild&&t.id===t.parentElement.lastElementChild.getAttribute("id"))return void document.getElementById(this._closeJumpBarDomId).focus();const e=t.nextElementSibling;e&&e.focus()}return}}if(e.keyCode===Te.a.UpArrow||e.keyCode===Te.a.DownArrow||e.keyCode===Te.a.LeftArrow||e.keyCode===Te.a.RightArrow){e.stopPropagation(),e.preventDefault();const r=e.keyCode===Te.a.DownArrow||e.keyCode===Te.a.RightArrow,n=e.keyCode===Te.a.UpArrow||e.keyCode===Te.a.LeftArrow;if(r){const e=t.nextElementSibling;return void(e&&e.focus())}if(n){const e=t.previousElementSibling;return void(e&&e.focus())}}}_renderJumpBarFlyout(e,t){const r="jumpbar-flyout_"+this.props.id,i=r+"Accessibility",a=[];return a.push(n.createElement(Pe.a,{key:i,rootElementId:r,shouldManageFocus:!0,isModal:!0,keyboardShortcuts:this._createKeyboardShortcuts(),defaultFocusId:this._closeJumpBarDomId})),n.createElement(s.a,{role:Ee.e},n.createElement(Ce.a,{id:r,testhooks:{id:r},key:r,rootZIndex:this.props.rootZIndex,positionType:"relative",relativeToElementId:t,flyoutStyle:this.props.styles.jumpBarFlyoutStyle,flyoutDirection:this.props.isRTL?Ce.b.upleft:Ce.b.rightup,onOutsideClick:this._onOutsideClickHandler.bind(this,e)},n.createElement(ve.a,{key:"cancel",style:this.props.styles.closeButtonStyle,id:this._closeJumpBarDomId,onClick:this._toggleJumpBarFlyout,onKeyDown:this._onJumpbarKeyDown.bind(this),accessibilityLabel:T.CLOSE_JUMPBAR_ARIALABEL},n.createElement(l.a,{style:this.props.styles.closeButtonTextStyle},n.createElement(K.b,{type:d.a.Close}))),this._renderList()),a)}_renderFlyoutButton(e){const t=Object(A.c)(this.props.resourceStrings,T.JUMPBAR_LETTER_TITLE),r=Object(A.c)(this.props.resourceStrings,T.JUMPBAR_ALPHABET).split(",");let i="";for(let e=0;e<3;e++){i+=Object(Oe.h)(r[e+1])[0]}return n.createElement(ve.a,{id:e,accessibilityLabel:t,title:t,style:this.props.isMobile?this.props.styles.jumpBarButtonMobileStyle:this.props.styles.jumpBarButtonStyle,onClick:this._toggleJumpBarFlyout,testhooks:{id:e}},n.createElement(l.a,{style:this.props.styles.jumpBarButtonTextStyle},i))}render(){try{if(this.props.resourceStrings){const e="jumpBarRoot_"+this.props.id,t=`${e}_${this.props.uniqueId}`,r="jumpbarBtn_"+(this.props.uniqueId||this.props.id),i={position:"relative"};this.props.renderMobile&&Object.assign(i,{maxWidth:"100%"});const a={height:"0",width:"0"},o="flyoutRelativeElement"+this.props.controlKey;return n.createElement(s.a,{id:t,key:t,testhooks:{id:e},style:i},this.props.isRTL?null:n.createElement(s.a,{id:o,style:a,role:"presentation","aria-hidden":"true"}),this.props.renderMobile?this._renderFlyoutButton(r):this._renderList(),this.state.isFlyoutOpened?this._renderJumpBarFlyout(r,o):null,n.createElement(s.a,{style:{display:"none"},id:this._selectedFilterDomId,key:this._selectedFilterDomId,role:" "},T.SELECTEDFILTER_TEXT),this.props.isRTL?n.createElement(s.a,{id:o,style:a,role:"presentation","aria-hidden":"true"}):null)}return null}catch(e){return console.error(e.message),null}}}const ke=Object(o.a)((function(){let e=null,t=null,r=null;const n=Object(A.h)(),i=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e=null,t=null;return function(r,n){var i,a,o,s,c,l,u,d,p,h,g,m,b,y,f,v,C,S,I,_,O,T,j,P,E,x,A,w,F,N,k,D,M,R;const L=Object(Ie.a)(r),V=Object(_e.b)(r)&&Object(G.a)(r,B.Fb,B.Lc)&&(null===(i=Object(_e.a)(r))||void 0===i?void 0:i.Components)?Object(_e.a)(r).Components:null;return t!==L&&(t=L,e={jumpBarStyle:{width:"100%",height:L.sizes.Measures.Measure300,display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",listStyleType:"none",backgroundColor:(null===(s=null===(o=null===(a=null==V?void 0:V.Grid)||void 0===a?void 0:a.Footer)||void 0===o?void 0:o.JumpBar)||void 0===s?void 0:s.BackgroundColor)||L.colors.BaseColor.Grey.Grey1,border:"1px solid transparent"},jumpBarButtonStyle:{display:"flex",fontSize:L.fontSizes.Font085,fontFamily:L.fontFamilies.Regular,color:(null===(u=null===(l=null===(c=null==V?void 0:V.Grid)||void 0===c?void 0:c.Footer)||void 0===l?void 0:l.JumpBar)||void 0===u?void 0:u.TextColor)||L.colors.MainThemeColor.MainColor1.Fill,cursor:L.display.PointerCursorStyle,borderStyle:"none",backgroundColor:"transparent",padding:"0",marginLeft:L.sizes.Measures.Measure100,marginRight:L.sizes.Measures.Measure100,marginTop:L.sizes.Measures.Measure050,marginBottom:L.sizes.Measures.Measure050,maxWidth:"100%"},jumpBarButtonMobileStyle:{display:"flex",fontSize:L.fontSizes.Font100,fontFamily:L.fontFamilies.Regular,color:(null===(h=null===(p=null===(d=null==V?void 0:V.Grid)||void 0===d?void 0:d.Footer)||void 0===p?void 0:p.JumpBar)||void 0===h?void 0:h.TextColor)||L.colors.MainThemeColor.MainColor1.Fill,cursor:L.display.PointerCursorStyle,borderStyle:"none",backgroundColor:"transparent",padding:"0",marginLeft:L.sizes.Measures.Measure100,marginRight:L.sizes.Measures.Measure100,marginTop:L.sizes.Measures.Measure050,marginBottom:L.sizes.Measures.Measure050,maxWidth:"100%"},jumpBarButtonTextStyle:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},jumpBarFlyoutStyle:{border:L.borders.Border02,backgroundColor:L.colors.BaseColor.Grey.Grey1,overflowY:"auto",overflowX:"hidden"},closeButtonStyle:{position:"absolute",top:"0",right:"0",borderStyle:"none",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"transparent",cursor:L.display.PointerCursorStyle,padding:L.sizes.Measures.Measure100,width:L.sizes.Measures.Measure300,height:L.sizes.Measures.Measure300},closeButtonTextStyle:{fontSize:"16px",color:L.colors.BaseColor.Grey.Grey7},jumpBarStyleMobile:{height:"auto",flexWrap:"wrap",display:"flex",alignItems:"center",justifyContent:"flex-start",paddingTop:L.sizes.Measures.Measure300,paddingRight:L.sizes.Measures.Measure050,paddingBottom:L.sizes.Measures.Measure150,paddingLeft:L.sizes.Measures.Measure300,maxWidth:"20rem"},listItemStyle:{textAlign:"center",position:"relative",height:L.sizes.Measures.Measure125},listItemSelectedStyle:{borderStyle:"solid",borderBottomColor:(null===(b=null===(m=null===(g=null==V?void 0:V.Grid)||void 0===g?void 0:g.Footer)||void 0===m?void 0:m.JumpBar)||void 0===b?void 0:b.SelectedColor)||L.colors.MainThemeColor.MainColor1.Fill,borderBottomWidth:L.sizes.Measures.Measure025},listItemStyleMobile:{display:"flex",alignItems:"center",justifyContent:"center",cursor:L.display.PointerCursorStyle,marginRight:L.sizes.Measures.Measure150,marginBottom:L.sizes.Measures.Measure150,width:L.sizes.Measures.Measure300,height:L.sizes.Measures.Measure300,border:L.borders.Border01,borderColor:(null===(v=null===(f=null===(y=null==V?void 0:V.Grid)||void 0===y?void 0:y.Footer)||void 0===f?void 0:f.JumpBar)||void 0===v?void 0:v.BorderColor)||L.colors.BaseColor.Blue.Blue3,backgroundColor:(null===(I=null===(S=null===(C=null==V?void 0:V.Grid)||void 0===C?void 0:C.Footer)||void 0===S?void 0:S.JumpBar)||void 0===I?void 0:I.BackgroundColorMobile)||L.colors.BaseColor.White,":nth-child(2)":{marginRight:"50%"},outlineOffset:"0px !important"},listItemSelectedStyleMobile:{borderColor:(null===(T=null===(O=null===(_=null==V?void 0:V.Grid)||void 0===_?void 0:_.Footer)||void 0===O?void 0:O.JumpBar)||void 0===T?void 0:T.SelectedBorderColor)||L.colors.BaseColor.Transparent,backgroundColor:(null===(E=null===(P=null===(j=null==V?void 0:V.Grid)||void 0===j?void 0:j.Footer)||void 0===P?void 0:P.JumpBar)||void 0===E?void 0:E.SelectedColorMobile)||L.colors.BaseColor.Grey.Grey2},hyperlinkStyle:{textDecoration:"none",textAlign:"center",fontSize:L.fontSizes.Font085,fontFamily:L.fontFamilies.Regular,whiteSpace:"nowrap",color:(null===(w=null===(A=null===(x=null==V?void 0:V.Grid)||void 0===x?void 0:x.Footer)||void 0===A?void 0:A.JumpBar)||void 0===w?void 0:w.LinkColor)||L.colors.BaseColor.Grey.Grey7},hyperlinkStyleMobile:{color:(null===(k=null===(N=null===(F=null==V?void 0:V.Grid)||void 0===F?void 0:F.Footer)||void 0===N?void 0:N.JumpBar)||void 0===k?void 0:k.LinkColor)||L.colors.BaseColor.Blue.Blue3},hyperlinkSelectedStyleMobile:{color:(null===(R=null===(M=null===(D=null==V?void 0:V.Grid)||void 0===D?void 0:D.Footer)||void 0===M?void 0:M.JumpBar)||void 0===R?void 0:R.SelectedBorderColor)||L.colors.BaseColor.Grey.Grey7}}),e}}();return(a,o)=>{const s=i(a,o);if(null===e&&(e=Object(F.E)(a,o.entityTypeName)),null==t&&(t=a.metadata.attributes[o.entityTypeName]),Object(G.a)(a,B.ac)){const e=Object(j.v)(a,o.id,o.contextToken);r=e&&e.fetchXml}return{resourceStrings:n(a,T.labelList),primaryNameAttribute:e,dataSetFetchXml:r,entityAttributeMetadata:t,styles:s}}}),(function(e,t){return{applyGridFilter:(r,n,i)=>{if(e(Object(Se.m)(r,t.id,i)),e(Object(we.b)(t.id,i,1)),n){const e=[{filterType:4,filterExpressionOrValue:r}];t.updateGridPaginationStateHandler(e,t.id),t.setResetPagingInfoForEnhancedPaging()}}}}))(Ne);var De=r("49Nd");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Me=r("5UPV"),Re=r("RrRu"),Le=r("jRHm"),Ve=r("lEp6"),Be=r("wFY3"),Ge=r("LAGg"),Xe=r("fU7K");class Ue extends n.Component{constructor(e){super(e),this._goToFirstPage=this._goToFirstPage.bind(this),this._goToPreviousPage=this._goToPreviousPage.bind(this),this._goToNextPage=this._goToNextPage.bind(this),Object(A.c)(e.resourceStrings,De.d)||e.retrieveResourceStrings(De.k)}_firstButtonEnabled(e){return this.props.currentPage>1}_nextButtonEnabled(e){return(!(this.props.currentPage===Math.floor(e.totalResultCount/e.pageSize))||!this.props.pagingInfo.isGridScrolledToBottom)&&e.hasNextPage}_previousButtonEnabled(e){return this.props.currentPage>1}_goToNextPage(e){this.props.updateDataSetLoadingState(1),this.props.incrementLastPage(),this.props.setNewPageRequested(!0),this.props.updatePageNumber(this.props.currentPage+1),this._setFooterButtonsFocus(e,!0)}_goToPreviousPage(e){this.props.updateDataSetLoadingState(1),this.props.setNewPageRequested(!0),this.props.updatePageNumber(this.props.currentPage-1),this._setFooterButtonsFocus(e,!1)}_goToFirstPage(e){this.props.updateDataSetLoadingState(1),this.props.setNewPageRequested(!0),this.props.setFirstPage(1),this.props.updatePageNumber(1),this._setFooterButtonsFocus(e,!1)}_setFooterButtonsFocus(e,t){if(null!==e&&null!==e.currentTarget&&null!==e.currentTarget.parentElement&&null!==e.currentTarget.parentElement.children)if(t&&e.currentTarget.parentElement.children.length>=2&&null!==e.currentTarget.parentElement.children[1]){const t=e.currentTarget,r=e.currentTarget.parentElement.children[1];setTimeout(()=>{t.disabled&&r.focus()},500)}else if(!t&&null!==e.currentTarget.parentElement.lastElementChild){const t=e.currentTarget,r=e.currentTarget.parentElement.lastElementChild;setTimeout(()=>{t.disabled&&r.focus()},500)}}_getResources(){if(this._loadFirstPage=this._loadFirstPage||Object(A.c)(this.props.resourceStrings,De.d),this._loadNextPage=this._loadNextPage||Object(A.c)(this.props.resourceStrings,De.e),this._loadPreviousPage=this._loadPreviousPage||Object(A.c)(this.props.resourceStrings,De.f),!this._spaceResource){const e=Object(A.c)(this.props.resourceStrings,De.j);this._spaceResource=Object(Xe.CrmHtmlDecode)(e)}this._gridInfoResource=this._gridInfoResource||Object(A.c)(this.props.resourceStrings,De.a),this._gridTotalCount=this._gridTotalCount||Object(A.c)(this.props.resourceStrings,De.c),this._itemSelected=this._itemSelected||Object(A.c)(this.props.resourceStrings,De.b),this._totalApproximate=this._totalApproximate||Object(A.c)(this.props.resourceStrings,De.h),this._totalExact=this._totalExact||Object(A.c)(this.props.resourceStrings,De.i)}render(){if(!this.props.pagingData)return null;const e=Object(Ve.a)(this.props.pagingData);let t=0,r=0;e.totalResultCount&&(this.props.enhancedPagingDisabled?(t=e.pageSize*(this.props.currentPage-1)+1,r=this.props.currentPage*e.pageSize,-1!==e.totalResultCount&&this.props.currentPage*e.pageSize>e.totalResultCount&&(r=e.totalResultCount,this.props.isServerOffline&&this.props.currentPage>1&&(r=e.pageSize*(this.props.currentPage-1)+e.totalResultCount))):(t=e.pageSize*(this.props.pagingInfo.firstPageNumber-1)+1,r=this.props.pagingInfo.lastPageNumber*e.pageSize,this.props.pagingInfo.pageShift>0&&(t+=this.props.pagingInfo.pageShift,r+=this.props.pagingInfo.pageShift),-1!==e.totalResultCount&&this.props.pagingInfo.lastPageNumber*e.pageSize>e.totalResultCount&&(r=e.totalResultCount,this.props.isServerOffline&&this.props.currentPage>1&&(r=e.pageSize*(this.props.currentPage-1)+e.totalResultCount))));const i=e.totalResultCount,a=this._firstButtonEnabled(e),o=this._nextButtonEnabled(e),c=this._previousButtonEnabled(e);this._getResources();let l=i;-1===i&&(l=r<this.props.gridTotalRecordsCountLimit?this.props.gridTotalRecordsCountLimit:r);let u="";u=-1===i?String.format(this._totalApproximate,this.props.isServerOffline?r:l):this.props.isServerOffline&&i>e.pageSize?String.format(this._totalApproximate,r):String.format(this._totalExact,this.props.isServerOffline?r:i);const d=String.format(this._gridTotalCount,this._spaceResource,u),p=this.props.selectedRowCount>0?String.format(this._itemSelected,this._spaceResource,this.props.selectedRowCount):null,h=Object(A.c)(this.props.resourceStrings,De.g),g=String.format(h,this.props.currentPage);let m=i/e.pageSize;return this.props.isServerOffline&&0!==this.props.currentPage&&(m=-1/e.pageSize),n.createElement(s.a,{style:this.props.styleProps.containerStyle},this._renderPagingText(t,r,d,p),this._renderPagingButtons(a,o,c,g,m))}_renderPagingButtons(e,t,r,i,a){return(a<0||a>1)&&this.props.enhancedPagingDisabled?n.createElement(s.a,{style:this.props.styleProps.navigationPanelStyle},n.createElement(ve.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"loadFirstPage_"+this.props.id},accessibilityLabel:this._loadFirstPage,disabled:!e,tabIndex:0,onClick:this._goToFirstPage},n.createElement(K.b,{type:d.a.FirstPageButton})),n.createElement(ve.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"moveToPreviousPage_"+this.props.id},accessibilityLabel:this._loadPreviousPage,disabled:!r,tabIndex:0,onClick:this._goToPreviousPage},n.createElement(K.b,{type:d.a.BackButton})),n.createElement(l.a,{style:this.props.styleProps.pageNumberStyle,testhooks:{id:"pageNumber_"+this.props.id},role:Ee.a,notificationType:Be.b},null!==this.props.currentPage?String.format(i,this.props.currentPage):null),n.createElement(ve.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"moveToNextPage_"+this.props.id},accessibilityLabel:this._loadNextPage,disabled:!t,tabIndex:0,onClick:this._goToNextPage},n.createElement(K.b,{type:d.a.Forward}))):null}_renderPagingText(e,t,r,i){if(!this.props.pagingTextDisabled&&this.props.shouldPagingTextRender&&this.props.gridTotalRecordsCountLimit)return n.createElement(s.a,{style:this.props.styleProps.pagingTextStyle,testhooks:{id:"pagingText"}},n.createElement(l.a,null,String.format(this._gridInfoResource,e,t,r,i)))}}const ze=Object(o.a)((function(){let e=null;const t=Object(A.h)(),r=function(){let e=null,t=null;const r={containerStyle:{justifyContent:"space-between",alignItems:"center",width:"100%"},navigationPanelStyle:{flexDirection:"row"},pageNumberStyle:{whiteSpace:"nowrap"},pagingButton:{borderStyle:"none",display:"inline-block",backgroundColor:"transparent",fontSize:"16px"}};return function(n,i){var a,o,s,c,l,u,d,p,h,g;const m=Object(_e.b)(n)&&Object(G.a)(n,B.Fb,B.Lc)&&(null===(a=Object(_e.a)(n))||void 0===a?void 0:a.Components)?Object(_e.a)(n).Components:null;if(e!==i){e=i;const a=Object(Ie.a)(n),{isRTL:b}=n.user.userSettings,y=Object.assign(Object.assign({},r.containerStyle),{marginRight:a.sizes.Measures.Measure100,marginLeft:a.sizes.Measures.Measure100}),f=Object.assign(Object.assign({},r.navigationPanelStyle),{["margin"+(b?"Right":"Left")]:"auto"}),v=Object.assign(Object.assign({},r.pageNumberStyle),{marginRight:a.sizes.Measures.Measure100,marginLeft:a.sizes.Measures.Measure100,fontSize:a.fontSizes.Font085,fontFamily:a.fontFamilies.Regular,color:(null===(s=null===(o=null==m?void 0:m.Grid)||void 0===o?void 0:o.Footer)||void 0===s?void 0:s.TextColor)||a.colors.BaseColor.Grey.Grey7}),C=Object.assign(Object.assign(Object.assign({},r.pagingButton),{color:(null===(l=null===(c=null==m?void 0:m.Grid)||void 0===c?void 0:c.Footer)||void 0===l?void 0:l.IconColor)||a.colors.BaseColor.Blue.Blue3,marginLeft:a.sizes.Measures.Measure050,marginRight:a.sizes.Measures.Measure050,width:"0px",fontSize:a.fontSizes.Font085,"[disabled]":{color:(null===(p=null===(d=null===(u=null==m?void 0:m.Grid)||void 0===u?void 0:u.Footer)||void 0===d?void 0:d.Disabled)||void 0===p?void 0:p.IconColor)||a.colors.BaseColor.Grey.Grey5}}),b&&{transform:"scaleX(-1)"}),S={["margin"+(b?"Left":"Right")]:"auto",fontSize:a.fontSizes.Font085,fontFamily:a.fontFamilies.Regular,color:(null===(g=null===(h=null==m?void 0:m.Grid)||void 0===h?void 0:h.Footer)||void 0===g?void 0:g.TextColor)||a.colors.BaseColor.Grey.Grey7};t=Object.assign(Object.assign({},r),{containerStyle:y,navigationPanelStyle:f,pagingButton:C,pageNumberStyle:v,pagingTextStyle:S})}return t}}();return(n,i)=>{const a=r(n,i.contextString),o=Object(j.fb)(n,i.id,i.contextToken),s=o?o.length:0,c=t(n,De.k),l=Object(j.Y)(n,i.id,i.contextToken),u=Object(j.x)(n,i.id,i.contextToken);return e!==a&&(e=a),{selectedRowCount:s,resourceStrings:c,pagingData:l,currentPage:null===u?1:u,styleProps:e}}}),(function(e,t){return{retrieveResourceStrings:t=>e(Object(x.e)(t)),updatePageNumber:r=>{if(e(Object(we.b)(t.id,t.contextToken,r)),1===r&&t.enhancedPagingDisabled&&e(Object(Ge.b)(t.id,t.contextToken)),t.isGridRoot){const e=[{filterType:12,filterExpressionOrValue:r}];t.updateGridPaginationStateHandler(e,t.id)}return e(Object(Le.b)(t.id,t.contextToken,null)),e(Object(Re.b)(t.id,t.contextToken,[]))},setNewPageRequested:r=>{e(Object(Me.b)(t.id,t.contextToken,r))}}}))(Ue);var He=r("PBKq"),qe=r("Yexl"),We=r("IqkD");var Ye=r("5O6t"),Qe=r("b8TU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Ke extends n.Component{constructor(e){super(e),this._quickFindInnerTextRef=null,this._searchBarFocusTriggered=!1,this._onTextInputChange=this._onTextInputChange.bind(this),this._onkeyDown=this._onkeyDown.bind(this),this._onButtonClick=this._onButtonClick.bind(this),this._focusTextInput=this._focusTextInput.bind(this),this.updateSearchTextAndFind=this.updateSearchTextAndFind.bind(this),this.props.isGridPaginationStateFeatureEnabled&&this.props&&this.props.gridInput&&this.props.gridInput.quickFindExpression?this.state={quickFindText:this.props.gridInput.quickFindExpression.trim(),currentViewId:this.props.currentViewIdToRestore,clearQuickFind:!0}:this.state={quickFindText:null,currentViewId:null,clearQuickFind:!1}}clearSearchBar(){this.setState({quickFindText:null,clearQuickFind:!1})}updateSearchTextAndFind(e,t){this.setState({quickFindText:e},()=>{t&&this._applyQuickFind()})}_onButtonClick(e){this.props.updateDataSetLoadingState(1),this.state.clearQuickFind?this._clearQuickFind():this._applyQuickFind()}_onkeyDown(e){e.keyCode===Te.a.Enter&&(this.props.updateDataSetLoadingState(1),this._applyQuickFind())}_onTextInputChange(e){const t=""===e;this.setState({quickFindText:e,clearQuickFind:t})}_applyFilter(){const e=this._formatQuickFindText(),t=Object(je.b)(e,this.props.primaryNameAttribute);this.props.applyGridFilter(t,this.props.contextToken)}_clearFilter(){this.setState({quickFindText:""},()=>{this._applyFilter()})}_formatQuickFindText(){return this.state.quickFindText.split("*").join("%").replace(/%?\s*$/,"%")}_applyQuickFind(){this.state.quickFindText&&""!==this.state.quickFindText.trim()?this.props.shouldUseFilter?(this._applyFilter(),this.setState({clearQuickFind:!0})):this.props.applyQuickFind(this.state.quickFindText,this.props.id,this.props.gridInput,this.props.contextToken,this.props.controlName,this.props.isGridPaginationStateFeatureEnabled).then(e=>{this.setState({clearQuickFind:!0}),this.state.currentViewId||this.setState({currentViewId:e})}):this._clearQuickFind()}_clearQuickFind(){this.props.shouldUseFilter?(this._clearFilter(),this.setState({clearQuickFind:!1})):this.props.clearQuickFind(this.state.currentViewId,this.props.id,this.props.gridInput,this.props.contextToken,this.props.controlName).then(()=>{this.setState({quickFindText:"",currentViewId:null,clearQuickFind:!1})})}_getPlaceholderText(){return this.props.isGridSearchCanUseCurrentViewFeatureEnabled?this.props.shouldGridSearchUseCurrentView?Object(A.c)(this.props.resourceStrings,T.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT_SEARCH_THIS_VIEW):Object(A.c)(this.props.resourceStrings,T.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT_QUICK_FIND_VIEW):Object(A.c)(this.props.resourceStrings,T.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT)}_createUniqueId(e){const{contextToken:t,id:r}=this.props;return t.controlName?`${e}_${t.controlName}_${r}`:`${e}_${r}`}render(){const e=this._getPlaceholderText(),t=Object(A.c)(this.props.resourceStrings,T.QUICK_FIND_TOOLTIP_CLEAR_BUTTON);if(this.props.showNewQuickFindSearchBarForMobile)return n.createElement(s.a,null,n.createElement(L.i,{placeholder:e,cancelText:Object(A.c)(this.props.resourceStrings,T.QUICK_FIND_CANCEL_LABEL_ID),clearText:t,applyQuickFind:this._applyQuickFind,windowWidth:this.props.viewPortWidth,updateSearchTextAndFind:this.updateSearchTextAndFind,value:this.state.quickFindText,quickFindRNStyleProps:this.props.quickFindRNStyleProps}));const r=this._createUniqueId("quickFind_text"),i=this._createUniqueId("quickFind_button"),a=this._createUniqueId("quickFind_button_icon"),o=Object(A.c)(this.props.resourceStrings,T.QUICK_FIND_TOOLTIP_APPLY_BUTTON),c=this.state&&this.state.clearQuickFind?t:o;return n.createElement(s.a,{style:this.props.styleProps.quickFindStyle,testhooks:{id:"data-set-quickFind-container"}},n.createElement(He.a,{id:r,key:r,ref:e=>{this._quickFindInnerTextRef=e},testhooks:{id:r},value:this.state&&this.state.quickFindText?this.state.quickFindText:null,accessibilityLabel:e,onChangeText:this._onTextInputChange,onKeyDown:this._onkeyDown,style:this.props.styleProps.inputStyle,placeholder:e}),n.createElement(ve.a,{id:i,key:i,testhooks:{id:i},accessibilityLabel:c,title:c,onClick:this._onButtonClick,tabIndex:0,style:this.props.styleProps.buttonStyle},n.createElement(K.b,{id:a,key:a,type:this.state&&this.state.clearQuickFind?d.a.Cancel:d.a.SearchButton,style:this.props.styleProps.buttonIconStyle})))}_focusTextInput(){if(this.props.focusSearchBoxAfterRender&&!this._searchBarFocusTriggered){const e=i.findDOMNode(this._quickFindInnerTextRef);e&&(e.focus(),this._searchBarFocusTriggered=!0)}}componentDidMount(){this._focusTextInput()}}Ke.displayName="DataSetQuickFind";const Je=Object(o.a)((function(){let e=null,t=null,r=null,n={quickFindText:null,currentViewId:null,clearQuickFind:null,primaryNameAttribute:null,styleProps:null,quickFindRNStyleProps:null,shouldUseFilter:!1,resourceStrings:null,isGridPaginationStateFeatureEnabled:null,currentViewIdToRestore:null,shouldGridSearchUseCurrentView:null,isGridSearchCanUseCurrentViewFeatureEnabled:null,isQuickFindImprovementsFeatureEnabled:null,viewPortWidth:null};const i=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e,t=null,r=null,n={buttonStyle:{border:"none",padding:"0",backgroundColor:"transparent",flexDirection:"column","-webkit-appearance":"none"},inputStyle:{border:"none",backgroundColor:"transparent",width:"100%",minWidth:"0px","-webkit-appearance":"none","::-ms-clear":{display:"none"}},quickFindStyle:{borderWidth:"1px",borderStyle:"solid",display:"flex",flexDirection:"row",width:"100%"},buttonIconStyle:{fontWeight:"bold",marginTop:"auto",marginBottom:"auto",width:"100%"}};return function(i,a){var o,s,c,l,u,d,p,h,g,m,b,y,f,v,C,S;const I=Object(We.g)(i),_=Object(_e.b)(i)&&Object(G.a)(i,B.Fb,B.Lc)&&(null===(o=Object(_e.a)(i))||void 0===o?void 0:o.Components)?Object(_e.a)(i).Components:null;if(_&&(n=Object.assign(n,{inputStyle:{color:null===(l=null===(c=null===(s=null==_?void 0:_.Grid)||void 0===s?void 0:s.ColumnHeader)||void 0===c?void 0:c.QuickFind)||void 0===l?void 0:l.TextColor,backgroundColor:null===(p=null===(d=null===(u=null==_?void 0:_.Grid)||void 0===u?void 0:u.ColumnHeader)||void 0===d?void 0:d.QuickFind)||void 0===p?void 0:p.BackgroundColor,borderColor:"transparent"},searchIconStyle:{color:null===(m=null===(g=null===(h=null==_?void 0:_.Grid)||void 0===h?void 0:h.ColumnHeader)||void 0===g?void 0:g.QuickFind)||void 0===m?void 0:m.IconColor},buttonIconStyle:{color:null===(f=null===(y=null===(b=null==_?void 0:_.Grid)||void 0===b?void 0:b.ColumnHeader)||void 0===y?void 0:y.QuickFind)||void 0===f?void 0:f.IconColor}})),t!==a||e!==I){t=a,e=I;const o=Object(Ie.a)(i),s=Object.assign(Object.assign({},n.buttonStyle),{":before":{content:"''",display:"inline-block",width:o.sizes.Measures.Measure250}}),c=Object.assign(Object.assign({},n.quickFindStyle),{borderColor:(null===(S=null===(C=null===(v=null==_?void 0:_.Grid)||void 0===v?void 0:v.ColumnHeader)||void 0===C?void 0:C.QuickFind)||void 0===S?void 0:S.BorderColor)||o.colors.BaseColor.Grey.Grey3,["padding"+(I?"Right":"Left")]:o.sizes.Measures.Measure025});r=Object.assign(Object.assign({},n),{buttonStyle:s,quickFindStyle:c})}return r}}(),a=Object(Ye.a)(),o=Object(A.h)();let s=null;return(c,l)=>{const u=i(c,l.contextString),d=a(c,l);r||(r=o(c,T.labelList)),e!==u&&(e=u),t!==d&&(t=d),s||(s=Object(G.c)(c,B.bd));const p=Object(G.a)(c,B.zb);let h=null;if(p&&l.gridInput){h=(l.gridInput&&l.gridInput.viewId&&!C.a.isNullOrEmpty(l.gridInput.viewId)?l.gridInput.viewId:null)||Object(I.a)(c,l.entityTypeName,_.a.MAIN_APPLICATION_VIEW)}return n={quickFindText:"",currentViewId:null,clearQuickFind:!1,primaryNameAttribute:Object(F.E)(c,l.entityTypeName),styleProps:e,quickFindRNStyleProps:t,shouldUseFilter:!(Object(Oe.e)(l.contextString)||Object(Oe.d)(l.contextString)||Object(Oe.g)(l.contextString)&&s),resourceStrings:r,isGridPaginationStateFeatureEnabled:p,currentViewIdToRestore:h,shouldGridSearchUseCurrentView:Object(ae.l)(c),isGridSearchCanUseCurrentViewFeatureEnabled:Object(G.a)(c,B.Db,B.h),isQuickFindImprovementsFeatureEnabled:Object(G.a)(c,B.ad,B.tc),viewPortWidth:Object(Qe.c)(c)},n}}),(function(e,t){return{applyQuickFind:(r,n,i,a,o,s)=>{if(i&&s){const e=[{filterType:1,filterExpressionOrValue:r}];i.entityTypeName===y.a&&e.push({filterType:2,filterExpressionOrValue:t.entityTypeName}),t.updateGridPaginationStateHandler(e,t.id),t.resetPagingInfoForEnhancedPaging()}return e(Object(qe.a)(r,n,a,o))},clearQuickFind:(r,n,i,a,o)=>{if(i){const e=[{filterType:1,filterExpressionOrValue:null}];t.updateGridPaginationStateHandler(e,t.id)}return e(Object(qe.b)(r,n,a,o))},applyGridFilter:(r,n)=>{e(Object(Se.n)(r,t.id,n))}}}),null,{forwardRef:!0})(Ke);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Ze=({onSeeMoreClick:e,resourceStrings:t,containerStyle:r,buttonStyle:i,seeMoreTextStyle:a,localizedStrings:o})=>function(e,t,r,i,a,o){const c=(null==o?void 0:o.seeMoreTooltip)||Object(A.c)(t,T.SEE_MORE_TOOL_TIP),u=(null==o?void 0:o.seeMoreLabel)||Object(A.c)(t,T.SEE_MORE_LABEL);let d=c;return(null==o?void 0:o.uniqueLabel)&&(d+=" "+o.uniqueLabel),n.createElement(s.a,{style:r},n.createElement(ve.a,{key:"seeMoreBtn",id:"seemore-btn",title:c,style:i,onClick:e,tabIndex:0,accessibilityLabel:d,describedByElementId:null},n.createElement(l.a,{style:a},u)))}(e,t,r,i,a,o)
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */;var $e=r("5R5s"),et=r("kKLx"),tt=r("vNXc"),rt=r("504W"),nt=r("aF0N");var it=r("iOrn"),at=r("zFtG"),ot=r("waMg"),st=r("6Qf/"),ct=r("B9jE"),lt=r("Jpj4"),ut=r("E6o7"),dt=r("QXpm"),pt=r("rQHy"),ht=r("kt5S"),gt=r("Nb1E"),mt=r("odYE"),bt=r("wyQO");var yt=r("fyfl"),ft=r("ojtV"),vt=r("2YQW"),Ct=r("ngeo"),St=r("WZ96"),It=r("QBtP"),_t=r("1uZV"),Ot=r("tICD"),Tt=r("uNu9"),jt=r("PVDM"),Pt=r("PZ34");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Et(e){return n.createElement(ce.a,{loader:()=>Promise.all([r.e(9),r.e(10),r.e(11),r.e(13),r.e(12),r.e(14),r.e(15),r.e(17),r.e(21),r.e(33)]).then(r.bind(null,"BvEH")).then(e=>e.DataSetExpressionBuilder),props:e})}Et.displayName="DataSetExpressionBuilderLazyLoadComponent";var xt=r("b41/"),At=r("p/Kg"),wt=r("Tz6o"),Ft=r("BkgE"),Nt=r("+HfF"),kt=r("Uv1Y"),Dt=r("VcAV"),Mt=r("eOoD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Rt(e){return n.createElement(ce.a,{loader:()=>Promise.all([r.e(9),r.e(10),r.e(11),r.e(13),r.e(12),r.e(14),r.e(16),r.e(112),r.e(32)]).then(r.bind(null,"12bH")).then(e=>e.ColumnEditor),props:e})}Rt.displayName="ColumnEditorLazyLoadComponent";var Lt=r("2Sll"),Vt=r("ozuu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
Object(Lt.a)();const Bt=y.x+".DataSetHost",Gt=Bt+".AdvancedFind.Open",Xt=Bt+".AdvancedFind.Discard";class Ut extends n.Component{constructor(e){super(e),this._quickFindCommandBarId="showQuickFind",this._changeVisualizationCommandBarId="changeVisualization",this._savedDefault=null,this._savedFormInfo=null,this._currentFilterValue=null,this._addedCommandListFromHost=[],this._addedCommandListFromControl=[],this._addedCommandListFromHostParent=[],this._memoizedConfiguration=null,this._memoizedResourceStrings=null,this._memoizedViewConfigurations=null,this._memoizedButtonList=null,this._parentSwitchVisualizationButton=null,this._keyIndex=0,this._width=0,this._height=0,this._isFirstRequestComplete=!1,this._isPreNavigationEventAttached=!1,this._offlineSqlQueryRetrieveState=0,this._dataSetQuickFindRef=n.createRef(),this._isSubGridFirstLoad=!1,this._minWidthForChartPlusGridReflow=640,this._isReflowLayoutVertical=!1,this._isSwitchVisualizationInitialized=!1,this._accessibilityId=1,this._incrementLastPage=()=>{this.props.pageNumber===this.state.pagingInfo.lastPageNumber&&this.setState({pagingInfo:Object.assign(Object.assign({},this.state.pagingInfo),{lastPageNumber:this.state.pagingInfo.lastPageNumber+1})})},this._setFirstPage=e=>{this.setState({pagingInfo:Object.assign(Object.assign({},this.state.pagingInfo),{firstPageNumber:e})})},this._seeMorePopup=this._seeMorePopup.bind(this),this._onSendControlCommandsEventFired=this._onSendControlCommandsEventFired.bind(this),this._onSelectedOrderColumnChangeFired=this._onSelectedOrderColumnChangeFired.bind(this),this._onParentPagePreNavigationEventFired=this._onParentPagePreNavigationEventFired.bind(this),this._onFilterChange=this._onFilterChange.bind(this),this._onActivityTypeMenuDismissed=this._onActivityTypeMenuDismissed.bind(this),this._updateDataSetLoadingStateEvent=this._updateDataSetLoadingStateEvent.bind(this),this._updateFilterValue=this._updateFilterValue.bind(this),this._onRollupViewToggleChanged=this._onRollupViewToggleChanged.bind(this),this._onQuickFind=this._onQuickFind.bind(this),this._onItemIconPointerDown=this._onItemIconPointerDown.bind(this),this._onViewChanged=this._onViewChanged.bind(this),this._onControlLoadedError=this._onControlLoadedError.bind(this),this._updatePagingInfo=this._updatePagingInfo.bind(this),this._updateFilterExpressionStrings=this._updateFilterExpressionStrings.bind(this),this._configureDataSetControlParams=this._configureDataSetControlParams.bind(this),this._openManageDuplicatesDialog=this._openManageDuplicatesDialog.bind(this),this._showInnerError=this._showInnerError.bind(this),this._isInSeeMoreState=this._isInSeeMoreState.bind(this),this._getChartPaneText=this._getChartPaneText.bind(this),this.onMeasuring=this.onMeasuring.bind(this),this.closeFilterPanel=this.closeFilterPanel.bind(this),this._clearActivityTypeFilter=this._clearActivityTypeFilter.bind(this),this._updateCurrentPageNumber=this._updateCurrentPageNumber.bind(this),this._isNativePlatform=null!=e.platformType&&e.platformType===b.b.Native,this._currentPagingString=null,this._preSeeMoreCachedPagingString=null,this._boundOnRecordsSelected=null,this._pageNumberToRestoreForEnhancedPaging=this.props.pageNumberForEnhancedPaging,this._shouldResetPagingForEnhancedPaging=!1,this._previousSortingInfo=null,this._resetProcessedForEnhancedPaging=!0,this.state={quickFindVisibility:!1,addedCommandList:[],inSeeMoreState:!1,pagingInfo:{firstPageNumber:Object(rt.a)(this.props.pageNumberForEnhancedPaging)?1:this.props.pageNumberForEnhancedPaging,lastPageNumber:Object(rt.a)(this.props.pageNumberForEnhancedPaging)?1:this.props.pageNumberForEnhancedPaging,currentPageNumber:Object(rt.a)(this.props.pageNumberForEnhancedPaging)?1:this.props.pageNumberForEnhancedPaging,pageShift:0,isGridScrolledToBottom:!1},compositeControlInitState:N.a.Uninitialized,controlLoadErrorMessage:null,controlLoadInnerErrorMessage:null,loadingState:0,isFilterPanelOpen:!1,columnEditorPanelOpen:!1,isAdvancedFilterEdited:!1},this._parentDefinedProps={eventListeners:[{eventname:"sendgridcontrolcommandstohostcommandbar",eventhandler:[this._onSendControlCommandsEventFired]},{eventname:"onselectedordercolumnchange",eventhandler:[this._onSelectedOrderColumnChangeFired]},{eventname:"parentPagePreNavigation",eventhandler:[this._onParentPagePreNavigationEventFired]},{eventname:"sendpaginginfotopagingcontrol",eventhandler:[this._updatePagingInfo]},{eventname:"sendfilterexpressionstringstodatasethost",eventhandler:[this._updateFilterExpressionStrings]},{eventname:"updatedatasethostloadingstate",eventhandler:[this._updateDataSetLoadingStateEvent]},{eventname:"openmanageduplicatesdialog",eventhandler:[this._openManageDuplicatesDialog]},{eventname:"showinnererror",eventhandler:[this._showInnerError]},{eventname:"sendcurrentpagenumber",eventhandler:[this._updateCurrentPageNumber]}],containerStyleOverrides:{rootContainer:{flex:Object(Oe.e)(e.contextString)?"1 1 100%":"1 1 auto",minHeight:"0"}},onControlLoadedError:this._onControlLoadedError},this._seeMoreHelper=new m.a}_logInfo(e){this._tracer&&this._tracer.info(e)}_updateDataSetLoadingStateEvent(e){this._updateDataSetLoadingState(e.value)}_updateDataSetLoadingState(e,t={}){(1===e&&this.props.featureControlProps.isGridProgressIndicatorFeatureEnabled||1!==e)&&(this.setState(Object.assign(t,{loadingState:e})),this._currentLoadingTimeoutIdentifier&&clearTimeout(this._currentLoadingTimeoutIdentifier),this._currentLoadingTimeoutIdentifier=null,1===e&&(this._currentLoadingTimeoutIdentifier=setTimeout(()=>{this._updateDataSetLoadingState(2)},3e4)))}_openManageDuplicatesDialog(e){!this.props.isOffline&&e&&e.entityReference&&e.reject&&this.props.openManageDuplicatesDialog(e)}_showInnerError(e){this.props.showInnerError(e)}_updatePagingInfo(e){e&&e.currentPageNumber>0&&(this.props.setNewPageRequested(this.props.id,this.props.contextToken,!1),this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&(this._resetProcessedForEnhancedPaging||1!==e.currentPageNumber||(this._resetProcessedForEnhancedPaging=!0,this._pageNumberToRestoreForEnhancedPaging=1),this.props.pageNumberForEnhancedPaging!==e.currentPageNumber&&this.props.updatePageNumberForEnhancedPaging(e.currentPageNumber,this.props.contextToken)),Object(vt.e)(this.state.pagingInfo,e)||this.setState({pagingInfo:e}))}_updateCurrentPageNumber(e){e&&e.currentPageNumber>0&&this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,e.currentPageNumber)}_updateFilterExpressionStrings(e){if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&e&&(e.nativeFilterExpressionString||e.dataSetFilterExpressionString)){const t=[{filterType:5,filterExpressionOrValue:e.nativeFilterExpressionString},{filterType:6,filterExpressionOrValue:e.dataSetFilterExpressionString}];this.props.updateGridPaginationStateHandler(t,this.props.id),this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1)}}_setResetPagingInfoForEnhancedPaging(){this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&this._isNativePlatform&&(this._shouldResetPagingForEnhancedPaging=!0)}_resetPagingInfoForEnhancedPaging(){this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&this._isNativePlatform&&(this.setState({pagingInfo:{firstPageNumber:1,lastPageNumber:1,currentPageNumber:1,pageShift:0,isGridScrolledToBottom:!1}}),this._pageNumberToRestoreForEnhancedPaging=1)}_onControlLoadedError(e){const t=e?e.message:null;this._logTelemetryData(t),this._setControlLoadError()}_setControlLoadError(e=T.GRID_CONTROL_LOAD_ERROR){this.setState({controlLoadErrorMessage:Object(A.c)(this.props.resourceStrings,e)})}_logTelemetryData(e){this._tracer&&this._tracer.error("Loading for the grid failed because of error :"+(e||"CustomControl_Calendar_ErrorView_DefaultMessage"))}_renderTitle(){if(!this.props.descriptor)return null;const{ShowLabel:e,Name:t,Label:r}=this.props.descriptor,i=this._isWidthLessThanViewportSm()?this.props.styles.titleMobileStyle:this.props.styles.titleStyle;return e&&r?n.createElement(l.a,{key:t,semanticTag:"div",style:i},r):null}onMeasuring(e,t){if(this._height=t,Math.abs(this._width-e)<50)return;if(this._width=e,this._getCachedSize()&&e===this._getCachedSize().width&&(!t||t===this._getCachedSize().height))return;const r={},n=this._seeMoreHelper.shouldGivePoppedOutDimensions(!0),i=this._seeMoreHelper.getSeeMorePopupInfo(),a=n?i.endWidthInner:e,o=[];!this._isWidthInitialized()&&e>0&&(r.isWidthInitialized=!0,o.push("isWidthInitialized:"+r.isWidthInitialized));const s=a<=this.props.viewportSm;s!==this._isWidthLessThanViewportSm()&&(r.isWidthLessThanViewportSm=s,o.push("isWidthLessThanViewportSm:"+s));const c=a<=this.props.viewportM;c!==this._isWidthLessThanViewportM()&&(r.isWidthLessThanViewportM=c,o.push("isWidthLessThanViewportM:"+c));const l=a<this._minWidthForChartPlusGridReflow;l!==this._isWidthLessThanMinWidthForChartPlusGridReflow()&&(r.isWidthLessThanMinWidthForChartPlusGridReflow=l,o.push("isWidthLessThanMinWidthForChartPlusGridReflow:"+l));const u=this._jumpBarShouldRenderAsFlyout(a);u!==this._isJumpBarRenderingAsFlyout()&&(r.isJumpBarRenderingAsFlyout=u,o.push("isJumpBarRenderingAsFlyout:"+u));const d=a>480;d!==this._isWidthGreaterThan480()&&(r.isWidthGreaterThan480=d,o.push("isWidthGreaterThan480:"+d));const p=n?i.endHeightInner:t,h=p>240;h!==this._isHeightGreaterThan240()&&(r.isHeightGreaterThan240=h,o.push("isHeightGreaterThan240:"+h)),0!==e&&0!==t||this._tracer&&this._tracer.warn(`The measuring service returned width or height as 0. The new dimensions are width is ${e} and height is ${t}`);let g=!1;const m=this.props.quickFindProps&&s&&!this._checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot();m!==this._showCommandBarButtonSearch()&&(r.showCommandBarButtonSearch=m,o.push("showCommandBarButtonSearch:"+m),g=!0);const b=Object(Oe.e)(this.props.contextString)||Object(Oe.d)(this.props.contextString)&&this.props.featureControlProps.isChartOnAssociatedGridEnabled;if(b!==this._showCommandBarButtonShowChart()&&(r.showCommandBarButtonShowChart=b,o.push("showCommandBarButtonShowChart:"+b),g=!0),o.length>0){o.push("currentWidth:"+e),o.push("currentHeight:"+t),o.push("usePoppedOutDimensions:"+n),o.push("newWidth:"+a),o.push("newHeight:"+p),o.push("commandBarNeedsUpdate:"+g);const r=o.join(",");this._logInfo("onMeasuring change: "+r)}this._getCachedSize()&&this._getCachedSize().update&&(this._cachedSize=this._getCachedSize().update({width:e,height:t,isWidthInitialized:e>0,isWidthLessThanViewportSm:s,isWidthLessThanViewportM:c,isWidthLessThanMinWidthForChartPlusGridReflow:l,isJumpBarRenderingAsFlyout:u,isWidthGreaterThan480:d,isHeightGreaterThan240:h,showCommandBarButtonSearch:m,showCommandBarButtonShowChart:b}));let y=r;g&&(y=Object.assign(y,this._getUpdateAddedCommandList(m,b))),Object.keys(y).length&&this.setState(y)}_getUpdateAddedCommandList(e,t){if(this._addedCommandListFromHost=[],e&&(this._logInfo("Adding search button to commandbar for DataSethost."),this._addedCommandListFromHost.push({Icon:"SearchButton",DisplayText:Object(A.c)(this.props.resourceStrings,T.QUICK_FIND_COMMANDBAR_TEXT),Id:this._quickFindCommandBarId,execute:this._onQuickFind})),this.props.isQueryMode){this._logInfo("Adding clear query button to commandbar for DataSethost.");const e=this._getClearQueryText();this._addedCommandListFromHost.push({Icon:"ClearDefault",DisplayText:e,Tooltip:{title:e},Id:"ClearQuery",execute:()=>this.props.clearQuery()})}if(!this.props.isOffline&&t){this._logInfo("Adding show chart button to commandbar for DataSethost.");const e=this._getChartPaneText();this._addedCommandListFromHost.push({Icon:"SelectChart",DisplayText:e,Tooltip:{title:e},Id:"ShowChartPane",execute:()=>this.props.toggleChartPane(this.props.id,this.props.contextToken,!this.props.showChart)})}return this._onAddedCommandListChange(!1)}_onViewChanged(e,t,r=!0){var n;r&&this._updateDataSetLoadingState(1);const i=this.props.descriptor?this.props.descriptor.Id:null;this._logInfo("The view for the grid changed. The new view parameters for the view are - NewViewId : "+e+", EntityTypeName : "+t+"and ControlName : "+i),this._resetPagingInfoForEnhancedPaging(),null===(n=this._dataSetQuickFindRef.current)||void 0===n||n.clearSearchBar();const a=this.props.gridInput&&this.props.gridInput.entityTypeName.toLowerCase()===j.a;this.props.updateView(this.props.id,i,e,t,this.props.commandBarProps&&this.props.commandBarProps.commandManagerId,this.props.contextToken,this.props.userId,this.props.featureControlProps&&this.props.featureControlProps.isQueueFilterPerfUCIEnabled,a).then(()=>{this.props.nonCompositionProps&&this.props.nonCompositionProps.setPageInputViewId&&this.props.nonCompositionProps.setPageInputViewId(e),this.state.controlLoadErrorMessage&&this.setState({controlLoadErrorMessage:null})},e=>{this._logInfo(e.message),this._setControlLoadError()})}_onItemIconPointerDown(e,t,r,n,i){this._logInfo("Trying to set default view for user. The new view parameters for the view are - NewViewId : "+t+", EntityTypeName : "+e+", ViewType : "+r+"and Unpin  : "+i);const a=oe(this._currentFilterValue);return this.props.updateUserDefaultGridView(e,t,r,n,a,i)}_onQuickFind(){this.setState({quickFindVisibility:!this.state.quickFindVisibility})}_getChartPaneText(){const{resourceStrings:e,showChart:t}=this.props;return t?Object(A.c)(e,T.CHARTS_HIDE_CHART_PANE_LABEL):Object(A.c)(e,T.CHARTS_SHOW_CHART_PANE_LABEL)}_getClearQueryText(){return"Clear query"}_updateFilterValue(e){this._currentFilterValue=e}_onFilterChange(e,t=this.props.gridEntityTypeName){this._logInfo("Applying grid filter, the new value received is "+e),2===this.state.loadingState&&this._updateDataSetLoadingState(1),this._updateFilterValue(e);const r=Object($e.a)(this.props.viewSelectorProps.entityTypeName,this.props.userId,this.props.contextToken,this.props.featureControlProps.isQueueFilterPerfUCIEnabled,this.props.entityIsActivityType).getFilterExpression(e,this.props.userSetting,t);this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1),this._setResetPagingInfoForEnhancedPaging(),this.props.applyGridFilter(r,e,this.props.contextToken)}_clearActivityTypeFilter(){this.props.applyActivityTypeFilter("","",this.props.contextToken)}_onActivityTypeMenuDismissed(e){if(!this.props.isOffline){const t=e.join(","),r=function(e,t){if(null!=e){if(e.indexOf("selectAllKey")>-1||0===e.length||null!=t&&t.length===e.length)return null;let r=null;const n=[];for(let t=0;t<e.length;t++)n.push({attributeName:"activitytypecode",conditionOperator:0,value:e[t]});return n&&n.length>0&&(r={conditions:n,filterOperator:1}),r}}(e,this.props.entityFilterProps.filterOptionsForActivityType),n=r?JSON.stringify(r):"";void 0===this.props.entityFilterProps.activityTypePreviousValues?this.props.applyActivityTypeFilter(n,t,this.props.contextToken):t!==this.props.entityFilterProps.activityTypePreviousValues&&this._shouldActivitySelectAllFilterFire(t,this.props.entityFilterProps.activityTypePreviousValues,this.props.entityFilterProps.isActivityFilterSelectAllEnabled)&&(this._logInfo("Applying activity type grid filter, the new value received is "+t),2===this.state.loadingState&&this._updateDataSetLoadingState(1),this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1),this._setResetPagingInfoForEnhancedPaging(),this.props.applyActivityTypeFilter(n,t,this.props.contextToken));const i=[{name:"ActivityTypeFilterUsage",value:"Initiated"},{name:"SelectedActivityTypeFilterCount",value:e.length},{name:"ActivityTypeFilterDropDownCount",value:this.props.entityFilterProps.filterOptionsForActivityType.length}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentSuccess&&this.context.EventManager.ReportComponentSuccess(Bt,i)}}_shouldActivitySelectAllFilterFire(e,t,r){if(r){let r=!1,n=!1;return(t.indexOf("selectAllKey")>-1||""===t)&&(r=!0),(e.indexOf("selectAllKey")>-1||""===e)&&(n=!0),!(r&&n)}return!0}_onRollupViewToggleChanged(e){this._logInfo("Toggling rollupView control, the new value received is "+e),this.props.toggleGridRollupView(e,this.props.contextToken)}_updateFilterOnViewSelectorChange(e){this._logInfo("Updating dataset with the existing filter selection for activity pointer"),this._onFilterChange(this._currentFilterValue,e)}_onSendControlCommandsEventFired(e){this._logInfo("Adding control commands to command bar. The command to be added are : "+e),e!==this._addedCommandListFromControl&&(this._addedCommandListFromControl=e,this._onAddedCommandListChange())}_onSelectedOrderColumnChangeFired(e){if(this._logInfo("Updating jumpbar filter based on the selected order column"),this.props.featureControlProps.isJumpBarShouldHonorSortingFeatureEnabled&&this.props.jumpBarProps){let t=e.columnSortingName;t=Object(je.d)(t,e.columnSortingType,e.primaryNameAttribute);const r=Object(je.b)(this.props.jumpBarProps.selectedFilter,t);this.props.onSelectedOrderColumnChange(r,this.props.contextToken)}}_onParentPagePreNavigationEventFired(e){e&&Array.isArray(e)&&e.length>0&&!this._isPreNavigationEventAttached&&this.context&&this.context.Router&&this.context.Router.registerPreNavigationHandler&&(this._tracer&&this._tracer.info("Adding control preNavigation handlers to the router"),e.forEach(e=>this.context.Router.registerPreNavigationHandler(()=>{try{return e()}catch(e){const t=[{name:"subComponent",value:"onPreNavigation"}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentFailure&&this.context.EventManager.ReportComponentFailure(Bt,e,null,t)}return Promise.resolve(!0)})),this._isPreNavigationEventAttached=!0)}_createSwitchVisualization(e,t){return()=>{switch(this._keyIndex++,this.props.contextString){case y.h.ASSOCIATEDGRID:this.props.switchAssociatedGridVisualization(this.props.id,this.props.entityTypeName,this.props.controlId,this.props.viewId,e,this.props.nonCompositionProps&&this.props.nonCompositionProps.viewConfigurations,this.props.nonCompositionProps&&this.props.nonCompositionProps.gridConfigurations,"VIEW_CONFIG"===t);break;case y.h.SUBGRID:this.props.switchSubgridVisualization(this.props.id,e,this.props.controlId);break;case y.h.GRID:default:if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput){const e=[{filterType:3,filterExpressionOrValue:null}];this.props.updateGridPaginationStateHandler(e,this.props.id),this.props.setCustomFilter("",0,this.props.id,this.props.contextToken)}"VIEW_CONFIG"===t?this.props.switchViewConfiguration(this.props.id,this.props.contextToken,e,this.props.controlId,!1):this.props.switchHomepageConfiguration(this.props.id,this.props.contextToken,e,this.props.controlId,!0)}}}_updateChangeVisualizationButtons(e){let t=[];const r=this.props.nonCompositionProps&&this.props.nonCompositionProps.gridConfigurations,n=this.props.nonCompositionProps&&this.props.nonCompositionProps.viewConfigurations;let i=!1;this._parentSwitchVisualizationButton||(this._parentSwitchVisualizationButton={Icon:"SelectChart",DisplayText:Object(A.c)(this.props.resourceStrings,T.SWITCH_VISUALIZATION_BUTTON_LABEL),Id:this._changeVisualizationCommandBarId+"-Parent",WillOpenFlyout:!0,Children:null}),this._memoizedConfiguration===this.props.updatedConfiguration&&this._memoizedViewConfigurations===n&&this._memoizedResourceStrings===this.props.switchVisualizationResourceStrings||this.props.switchVisualizationResourceStrings&&(this._memoizedConfiguration=this.props.updatedConfiguration,this._memoizedViewConfigurations=n,this._memoizedResourceStrings=this.props.switchVisualizationResourceStrings,this._memoizedButtonList=[],t=Object(ht.c)(r,n,this.props.updatedConfiguration,this.props,this.props.contextString,e),t.forEach(t=>{if(Object(ht.a)(this.props.updatedConfiguration,t.configuration)||t.configuration.isDefaultConfig&&this.props.updatedConfiguration.isDefaultConfig||this.props.featureControlProps.isDisableEditableGridControlOnPhoneFeatureEnabled&&Object(ae.g)(t.configuration,parseInt(e,10)))return;const r={Icon:"SelectChart",DisplayText:""+Object(ht.b)(this.props.switchVisualizationResourceStrings,t.configuration),Id:`${this._changeVisualizationCommandBarId}-${t.configuration.Name}-${t.formFactor}`,execute:this._createSwitchVisualization(t.configuration,t.configurationType),IsInFlyout:!0};this._memoizedButtonList.push(r),i=!0})),!this._isSwitchVisualizationInitialized&&this.props.commandBarProps&&(Object(ht.d)(this.props.retrieveControlResourceStringsForSwitchVisualization,this.context,r,n,this.props.updatedConfiguration,this.props,this.props.contextString,e),this._isSwitchVisualizationInitialized=!0),this._parentSwitchVisualizationButton.Children=this._memoizedButtonList,i&&this._onAddedCommandListChange()}_onAddedCommandListChange(e=!0){var t,r,n,i;const a=[],o=[],s=(null===(r=null===(t=this._parentSwitchVisualizationButton)||void 0===t?void 0:t.Children)||void 0===r?void 0:r.length)>0;if(this.props.featureControlProps.isShowAsButtonFirstEnabled&&s&&o.push(this._parentSwitchVisualizationButton),o.push(...this._addedCommandListFromControl),o.push(...this._addedCommandListFromHost),(null===(i=null===(n=this.props.nonCompositionProps)||void 0===n?void 0:n.addedCommandListFromHostParent)||void 0===i?void 0:i.length)>0&&a.push(...this.props.nonCompositionProps.addedCommandListFromHostParent),!this.props.featureControlProps.isShowAsButtonFirstEnabled&&s&&a.push(this._parentSwitchVisualizationButton),!e)return{addedCommandList:o,appendedCommandList:a};this&&this.setState&&this.setState({addedCommandList:o,appendedCommandList:a})}_seeMoreCallback(e){this.setState({inSeeMoreState:!this.state.inSeeMoreState})}_seeMorePopup(e,t=!1){!0===e?(this._preSeeMoreCachedPagingString=this._currentPagingString,this._currentPagingString=null):(this._currentPagingString=this._preSeeMoreCachedPagingString,this._preSeeMoreCachedPagingString=null),this._keyIndex++,this._seeMoreHelper.seeMorePopup(this._getDataSetHostRootElement(),this._seeMoreCallback.bind(this),e,t,this.props.isRTL)}_getDataSetHostRootElement(){return i.findDOMNode(this)}_onRecordsSelectedCallback(e,t){this._logInfo("onRecordsSelected for DataSetHost. New selected rows are "+t);const r=[];for(const e of t)r.push(new C.a(e));if(this.props.markSelectedRows(this.props.id,this.props.contextToken,r),e){const e=this.props.updatedConfiguration.Parameters[this.props.nestedGridDatasetName];this.props.markSelectedRelatedEntity(this.props.id,this.props.contextToken,e.TargetEntityType)}else this.props.markSelectedRelatedEntity(this.props.id,this.props.contextToken,null);this.props.isGridEditable&&t.length>0&&this.props.rowProperties(this.props.id,this.props.contextToken,r),this.props.isGridEditable&&(this._logInfo("Running onRecordSelect for EditableGrid"),this.props.runOnRecordSelect(this.props.id,this.props.contextToken,r)),!e&&this._onRecordsSelectedParent&&(this._logInfo("onRecordsSelected: Calling onRecordsSelected callback for the parent control"),this._onRecordsSelectedParent(t))}markGridFirstRequestComplete(){this._isFirstRequestComplete=!0}_isDataSetHostKnownError(e){return!(!e||""===e)&&(-1!==e.indexOf(Ct.a.getHexErrorCodeFromInt(2415919120))||!(-1===e.indexOf(Ct.a.getHexErrorCodeFromInt(-2147093999))||this.props.offlineProps.isEntityAvailableForOffline&&this.props.offlineProps.isOfflineAvailableForUse))}_onDataSetUpdateCallback(e){this._logInfo("DataSetUpdated for DataSetHost control");const t=[{name:"currentPagingString",value:e&&e.existedPagingString||""}];this.markGridFirstRequestComplete(),this._currentPagingString!==e.existedPagingString&&t.push({name:"previousPagingString",value:this._currentPagingString});let r=!1;e.error?(r=this._isDataSetHostKnownError(e.errorMessage)||!Object(Dt.b)(e.innerError),e.innerError&&t.push({name:"InnerErrorMessage",value:e.innerError}),this.context.EventManager.ReportComponentFailure(Bt,new Error(e.errorMessage||""),null,t)):this.context.EventManager.ReportComponentSuccess(Bt,t);let n={};if(r)n={compositeControlInitState:N.a.Error,controlLoadErrorMessage:e.errorMessage},e.innerError&&(n.controlLoadInnerErrorMessage=e.innerError);else{this.props.updateFetchXml(this.props.id,this.props.contextToken,e.fetchXmlInUse);let t=null;if(e.existedFilteringString){const r=JSON.parse(e.existedFilteringString);t=Object(h.j)(r,Xe.CrmXmlEncode),this.props.setCustomFilter(t,0,this.props.id,this.props.contextToken)}if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled){const t=[];let r=!1,n=null;e.existedValidSortingArrayString&&(n=e.existedValidSortingArrayString);const i=!Object(rt.a)(n)&&JSON.parse(n);if(i&&i instanceof Array&&i.length>0&&n!==this.props.gridSortingInfo&&(this.props.gridInput&&t.push({filterType:7,filterExpressionOrValue:n}),r=!0),r){if(e.existedPagingString){const t=JSON.parse(e.existedPagingString);t.firstPageNumber&&(this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,t.firstPageNumber),this.props.gridInput&&this._setResetPagingInfoForEnhancedPaging())}this.props.gridInput&&this.props.updateGridPaginationStateHandler(t,this.props.id)}}this.props.updateQueryKey(e.newQueryKey,this.props.id,this.props.contextToken),this.props.updatePagingData(this.props.id,this.props.contextToken,e.existedPagingString),this.props.setNewPageRequested(this.props.id,this.props.contextToken,!1),this._logInfo("onDataSetUpdate: eventPagingString: "+e.existedPagingString),this._currentPagingString=e.existedPagingString}2!==this.state.loadingState?this._updateDataSetLoadingState(2,n):this.setState(n),this._accessibilityId++}_configureDataSetControlParams(){if(!this.props.updatedConfiguration)return;const e=this.props.updatedConfiguration.Parameters[this.props.primaryDataSetName];if(e){!Object(rt.a)(e.onRecordsSelected)&&Object(rt.a)(this._onRecordsSelectedParent)&&e.onRecordsSelected!==this._boundOnRecordsSelected&&(this._onRecordsSelectedParent=e.onRecordsSelected),this._isFirstRequestComplete&&(e.FirstDataRequestType=0),Object(rt.a)(this._boundOnRecordsSelected)&&(this._boundOnRecordsSelected=this._onRecordsSelectedCallback.bind(this,!1)),e.onRecordsSelected=this._boundOnRecordsSelected,e.onDataSetUpdate=this._onDataSetUpdateCallback.bind(this);const t=this.props.descriptor;let r=1,n=this.state.pagingInfo.lastPageNumber;this.props.isGridEditable||this._isNativePlatform?this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this._isNativePlatform&&(r=this.state.pagingInfo.firstPageNumber):(r=this.props.pageNumber,n=this.props.pageNumber);const i={firstPageNumber:r,lastPageNumber:n,pageSize:!this._isInSeeMoreState()&&t&&t.Parameters&&t.Parameters[y.q]&&parseInt(t.Parameters[y.q],10)||this.props.recordsPerPageSetting,pagingRefreshInput:this.props.pagingRefreshInput?this.props.pagingRefreshInput.toString():""},a=Object(Ve.a)(this._currentPagingString);if(a&&a.pageSize&&(this._logInfo("Updating pageSize based on _receivedPagingStringData.pageSize to "+a.pageSize),i.pageSize=a.pageSize),e.PagingInput={Static:!0,Value:JSON.stringify(i)},this.props.refreshCounter){const t=this.props.refreshCounter.toString();if(e.RefreshInput={Value:parseInt(t,10),Static:!0},!Object(rt.a)(this.props.customFilter)&&!Object(rt.a)(this.props.customFilter.customFilterXml)&&this.props.customFilter.source&&1===this.props.customFilter.source){const t=Object(h.i)(this.props.customFilter.customFilterXml);e.FilteringInput={Static:!0,Value:JSON.stringify(t)}}}if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput){if(!Object(rt.a)(this.props.customFilter)&&!Object(rt.a)(this.props.customFilter.customFilterXml)){const t=Object(h.i)(this.props.customFilter.customFilterXml);e.FilteringInput={Static:!0,Value:JSON.stringify(t)}}const t=!Object(rt.a)(this.props.gridSortingInfo)&&JSON.parse(this.props.gridSortingInfo),r=t&&t instanceof Array&&t.length>0,n=!Object(rt.a)(this._previousSortingInfo)&&JSON.parse(this._previousSortingInfo),i=n&&n instanceof Array&&n.length>0;(r||i&&this.props.gridSortingInfo!==this._previousSortingInfo)&&(this._previousSortingInfo=this.props.gridSortingInfo,e.SortingInput={Static:!0,Value:this.props.gridSortingInfo})}this.props.gridEntityTypeName&&(e.EntityName=this.props.gridEntityTypeName)}this._addExtraParametersToConfiguration();const t=this.props.updatedConfiguration.Parameters[this.props.nestedGridDatasetName];if(t&&(t.onRecordsSelected=this._onRecordsSelectedCallback.bind(this,!0),this.props.refreshCounter)){const e=this.props.refreshCounter.toString();t.RefreshInput={Value:parseInt(e,10),Static:!0}}}_addExtraParametersToConfiguration(){if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&(this.props.updatedConfiguration.Parameters.NativeFilterExpressionToRestore={Usage:1,Static:!0,Value:this.props.nativeFilterExpression},!Object(rt.a)(this._pageNumberToRestoreForEnhancedPaging))){let e=this._pageNumberToRestoreForEnhancedPaging;this._pageNumberToRestoreForEnhancedPaging>1&&(this._shouldResetPagingForEnhancedPaging||!this._resetProcessedForEnhancedPaging)&&(this._shouldResetPagingForEnhancedPaging=!1,this._resetProcessedForEnhancedPaging=!1,e=-1),this.props.updatedConfiguration.Parameters.PageNumberToRestore={Usage:1,Static:!0,Value:e}}this.props.lookupAttributeForRecordHierarchy&&this.props.gridInput&&(this.props.updatedConfiguration.Parameters.LookupAttributeNameForHierarchy={Usage:1,Static:!0,Value:this.props.lookupAttributeForRecordHierarchy})}_renderAccessibilityNotification(e){var t;const r=e+"_accessibility",i={left:"-3000%",width:"0%",height:"0%",position:"absolute"};this.props.featureControlProps.isAssociatedGridHeightEnabled&&(i.overflow="hidden");const a=Object(A.c)(this.props.resourceStrings,T.GRID_LOADING_PLACEHOLDER).replace("{0}",this.props.entityDisplayName),o=2===this.state.loadingState?null!==(t=this.props.notificationMessage)&&void 0!==t?t:"":a;return n.createElement(s.a,{key:`${r}_${this._accessibilityId}`,id:r,style:i,role:Ee.s,notificationType:Be.b},o)}_renderQuickFind(){const e=this._showNewQuickFindSearchBarForMobile();if(this.props.quickFindProps&&this._isWidthInitialized()){if(this._isWidthLessThanViewportSm()&&(this.state.quickFindVisibility||e)){const t=Object.assign(this.props.quickFindProps,{focusSearchBoxAfterRender:!0});return n.createElement(s.a,{key:"quickFind",style:this.props.styles.quickFindMobileStyle},n.createElement(Je,Object.assign({},t,{updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,resetPagingInfoForEnhancedPaging:this._resetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),ref:this._dataSetQuickFindRef,showNewQuickFindSearchBarForMobile:e})))}if(!this._isWidthLessThanViewportSm())return Object(Oe.g)(this.props.contextString)?n.createElement(s.a,{style:this.props.styles.quickFindContainerStyle},this._getQuickFind()):this._getQuickFind()}return null}_renderAdvancedFilter(){return this._isWidthInitialized()&&this.props.showAdvancedFilter&&this.props.quickFindProps&&n.createElement(ve.a,{key:"openAdvancedFilter",id:"open-advanced-filter",iconType:"filter",title:Object(A.c)(this.props.resourceStrings,xt.c.OpenAdvancedFiltersTitleAndAria),style:this.props.styles.advancedFilterButtonStyles,onClick:()=>{this._renderAdvancedFindPanel()},tabIndex:0,accessibilityLabel:Object(A.c)(this.props.resourceStrings,xt.c.OpenAdvancedFiltersTitleAndAria)},n.createElement(K.b,{id:"filter",accessibilityHidden:!0,type:d.a.Filter}))}_renderAdvancedFindPanel(){var e;this._updateDataSetLoadingState(1);const t=[{name:"entityName",value:this.props.entityTypeName},{name:"ViewId",value:null===(e=this.props.viewId)||void 0===e?void 0:e.guid}];this.props.retrieveRelatedEntitiesMetadata(this.props.entityTypeName).then(()=>{this.setState({isFilterPanelOpen:!0}),this._updateDataSetLoadingState(2),this.context.EventManager.ReportComponentSuccess(Gt,t)},e=>{this._tracer.error(null==e?void 0:e.message),this._updateDataSetLoadingState(2),this.context.EventManager.ReportComponentFailure(Gt,new Error(e),t)})}_renderDiscardChanges(){if(this.props.showAdvancedFilter&&this.props.isViewEdited&&this._isWidthInitialized()&&!this.props.showColumnEditor)return n.createElement(ve.a,{key:"clearAdvancedFilter",id:"clear-advanced-filter",iconType:"clearFilter",title:Object(A.c)(this.props.resourceStrings,T.AdvancedFind_DiscardButton_Title),style:this.props.styles.advancedFilterButtonStyles,onClick:()=>{var e;this.props.removeEditedViewPageMap(this.props.gridInput.pageToEditedViewMapId.guid,this.props.viewId),this._clearCustomFilterAndUpdateControlKeyIndex();const t=[{name:"entityName",value:this.props.entityTypeName},{name:"ViewId",value:null===(e=this.props.viewId)||void 0===e?void 0:e.guid}];this.context.EventManager.ReportComponentSuccess(Xt,t)},tabIndex:0,accessibilityLabel:Object(A.c)(this.props.resourceStrings,T.AdvancedFilter_DiscardButton_AccessibilityLabel)},n.createElement(K.b,{id:"clearFilter",type:d.a.GlobalFilterClearAll}))}_renderColumnEditor(){if(this.props.showColumnEditor&&this._isWidthInitialized()){const e=Object(A.c)(this.props.resourceStrings,T.ColumnEditorButton);return n.createElement(Vt.a,{key:"columnEditorBtn",id:"columnEditor-btn",iconProps:{iconName:"ColumnOptions",style:{color:"black"}},title:e,"aria-label":e,onClick:()=>this.setState({columnEditorPanelOpen:!0}),style:this.props.styles.columnEditorButtonStyle})}}_clearCustomFilterAndUpdateControlKeyIndex(){this.props.setCustomFilter("",0,this.props.id,this.props.contextToken).then(()=>{this._keyIndex++,this._onViewChanged(this.props.viewId.guid,this.props.entityTypeName,!1)})}_getQuickFind(){return n.createElement(s.a,{key:"quickFind",style:this.props.styles.quickFindStyle},n.createElement(Je,Object.assign({},this.props.quickFindProps,{updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,resetPagingInfoForEnhancedPaging:this._resetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),ref:this._dataSetQuickFindRef})))}_renderViewSelector(){if(this.props.viewSelectorProps&&this._isWidthInitialized()){const e=this._isWidthLessThanViewportSm()?this.props.styles.viewSelectorOuterMobileStyle:this.props.styles.viewSelectorOuterStyle;return n.createElement(s.a,{key:"viewSelector",style:e},n.createElement(W,Object.assign({isGridRoot:Object(Oe.e)(this.props.contextString)},this.props.viewSelectorProps,{isTablet:this._isWidthLessThanViewportM(),isPhone:this._isWidthLessThanViewportSm(),key:"dataSetHostView",onChange:this._onViewChanged,onItemIconPointerDown:this._onItemIconPointerDown,rootZIndex:this._isInSeeMoreState(),isRTL:this.props.isRTL,removeEditedViewPageMap:this.props.removeEditedViewPageMap})))}return this._renderTitle()}_renderQueueFilter(){if((this.props.entityTypeName===Tt.Bb||this.props.entityTypeName===jt.a)&&this.props.queueFilterProps&&this._isWidthInitialized()){const e=this._isWidthLessThanViewportSm()?this.props.styles.filterContainerMobileStyle:this.props.styles.filterContainerStyle;return n.createElement(se,Object.assign({},this.props.queueFilterProps,{key:"queueFilter",onFilterChange:this._onFilterChange,updateFilterValue:this._updateFilterValue,resourceStrings:this.props.resourceStrings,style:e,isGridPaginationStateFeatureEnabled:this.props.featureControlProps.isGridPaginationStateFeatureEnabled}))}return null}_renderEntityFilter(){if(this.props.entityFilterProps&&this._isWidthInitialized()){const e=this._isWidthLessThanViewportSm(),t=e?this.props.styles.filterContainerMobileStyle:this.props.styles.filterContainerStyle,r=this.props.styles.activityTypeFilterContainerStyle;return n.createElement(ge,Object.assign({},this.props.entityFilterProps,{onToggleChange:this._onRollupViewToggleChanged,key:"EntityFilterDataSet",onFilterChange:this._onFilterChange,onActivityTypeChange:this._onActivityTypeMenuDismissed,onActivityTypeFilterClear:this._clearActivityTypeFilter,gridEntityName:this.props.gridEntityTypeName,resourceStrings:this.props.resourceStrings,containerStyle:t,activityTypeContainerStyle:r,rootZIndex:this._isInSeeMoreState(),isGridPaginationStateFeatureEnabled:this.props.featureControlProps.isGridPaginationStateFeatureEnabled,isMobile:e}))}return null}_renderDataSetChart(){return this.props.chartProps&&this._isWidthInitialized()?(this.props.chartProps.isLayoutVertical=this._isReflowLayoutVertical,n.createElement(v,Object.assign({},this.props.chartProps,{style:this._isReflowLayoutVertical?this._isWidthLessThanViewportSm()?this.props.styles.reflowChartMobileStyle:this.props.styles.reflowChartStyle:this.props.styles.chartStyle,key:"pageChartDataSet",closeChartPaneHandler:this.props.toggleChartPane}))):null}_renderBackButtonForGridInMobile(){return this.props.commandBarProps&&this._isWidthInitialized()&&Object(Oe.e)(this.props.contextString)&&this._isWidthLessThanViewportSm()&&this.props.backButtonEnabled?n.createElement(Z.a,{pageId:this.props.id,overwriteStyle:{borderWidth:0,height:"auto",padding:0,margin:"-8px 0"}}):null}_renderCommandBar(){if(!this.props.commandBarProps||!this._isWidthInitialized())return null;this._commandBarLoadedPromise||(this._commandBarLoadedPromise=new Promise(e=>{this._commandBarLoadedResolve=e})),this._commandManagerId=this._commandManagerId||this.props.commandBarProps.commandManagerId||Object(me.a)();let e=this.props.styles.commandManagerContainerStyle,t=this.props.styles.commandBarStyle;this._isWidthLessThanViewportSm()&&(e=this.props.styles.commandManagerContainerMobileStyle,t=this.props.styles.commandBarMobileInnerStyle);const r=Object(Oe.e)(this.props.contextString);return Object(Q.b)(this.props.commandBarRefreshProps,t,this._isWidthLessThanViewportSm(),e),n.createElement(ne,Object.assign({},this.props.commandBarProps,{key:"commandBarDataSet",addedCommandList:this.state.addedCommandList,appendedCommandList:this.state.appendedCommandList,metaDataLoadedResolve:this._commandBarLoadedResolve,commandManagerId:this._commandManagerId,style:e,commandbarStyles:t,rootZIndex:this._isInSeeMoreState(),customControlType:this.props.updatedConfiguration.CustomControlId,isGridRoot:r,collapsed:this._isWidthLessThanViewportSm(),isNativeMode:this._isNativeSubgrid()}))}_renderFooter(){let e=!1;if(this.props.totalResultCount<=this.props.pageSize&&!this.props.totalRecordCountLimitExceeded&&Object(Oe.g)(this.props.contextString)&&!this._isInSeeMoreState()&&!this.props.jumpBarProps&&(e=this._shouldRenderSeeMoreButton(),!e))return this._logInfo("Hiding the footer for the subgrid because there is less than 2 pages of data"),null;if(this._isWidthInitialized()&&(this.props.jumpBarProps||this.props.pagingProps)){const t=this._isJumpBarRenderingAsFlyout()?this.props.styles.footerMobileStyle:this.props.isGridEditable?this.props.styles.footerEditableGridStyle:Object.assign(Object.assign({},this.props.styles.footerOuterStyle),this.props.jumpBarProps?this.props.styles.defaultFooterHeightStyle:this.props.styles.jumpBarLessFooterHeightStyle);if(!this.props.isGridEditable)return this._hideJumpbarForMobile()?null:n.createElement(s.a,{key:"dataSetFooter_"+this.props.id,style:t},!e&&this._renderJumpBar(),n.createElement(s.a,{key:"dataSetPagingContainer_"+this.props.id,style:this.props.styles.footerPagingContainer},this._renderPaging(e),this._renderSeeMoreButton()));if(this.props.jumpBarProps)return n.createElement(s.a,{key:"dataSetFooter_"+this.props.id,style:t},this._renderJumpBar());this._logInfo("Hiding the footer for the editable grid because the jump bar props is null")}return this._logInfo("Hiding the footer for the grid because the width for the controld is 0 or the jump bar props is null or paging props is null"),null}_jumpBarShouldRenderAsFlyout(e){const t=Object(A.c)(this.props.resourceStrings,T.JUMPBAR_ALPHABET);if(t){const r=t.split(","),n=e-100,i=this._isJumpBarRenderingAsFlyout()?.5:-.5;return!!r&&n/r.length<=32+i}return!1}_renderJumpBar(){let e=null;return this._isJumpBarRenderingAsFlyout()&&(e=this.props.styles.jumpBarButtonContainerStyle),this.props.jumpBarProps?n.createElement(s.a,{key:"jumpBar_"+this.props.id,style:e},n.createElement(ke,Object.assign({},this.props.jumpBarProps,{rootZIndex:this._isInSeeMoreState(),controlKey:this.props.controlKey,renderMobile:this._isJumpBarRenderingAsFlyout(),isDeviceSizeSmall:!this._isWidthGreaterThan480(),isRTL:this.props.isRTL,isGridRoot:Object(Oe.e)(this.props.contextString),updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,setResetPagingInfoForEnhancedPaging:this._setResetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),isMobile:this._isWidthLessThanViewportM()}))):null}_renderPaging(e){const t=Object(Oe.f)(this.props),r=!this.props.hasCustomDataProvider&&Object(rt.a)(this.props.totalRecordCountLimitExceeded);return t&&this._logInfo("Hiding the paging button for the grid because the sharepoint grid does not support paging"),this.props.pagingProps?n.createElement(ze,Object.assign({},this.props.pagingProps,{pagingInfo:this.state.pagingInfo,shouldPagingTextRender:!e,incrementLastPage:this._incrementLastPage,setFirstPage:this._setFirstPage,enhancedPagingDisabled:!e&&!t&&!this._isNativePlatform,pagingTextDisabled:r,gridTotalRecordsCountLimit:this.props.gridTotalRecordsCountLimit,isGridRoot:Object(Oe.e)(this.props.contextString),updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),isServerOffline:this.props.isOffline})):null}renderDataSetHostComponent(e,t,r,i,a){var o,l,u;let h=[];const m=this._isWidthLessThanViewportSm();this._isReflowLayoutVertical=!(!this._isWidthLessThanMinWidthForChartPlusGridReflow()||!this.props.chartProps);try{const b=this._getDataSetHostErrorMessage();if(Object(rt.a)(b)||this.state.compositeControlInitState===N.a.Initializing){if(this._isWidthInitialized()||Object(Oe.g)(this.props.contextString)&&this.state.compositeControlInitState!==N.a.Initializing){this._isShowChartChanged&&(this._getUpdateAddedCommandList(this._showCommandBarButtonSearch(),this._showCommandBarButtonShowChart()),this._onAddedCommandListChange(),this._isShowChartChanged=!1);const t=(Object(Oe.e)(this.props.contextString)||Object(Oe.d)(this.props.contextString))&&this.props.entityIsActivityType;m||Object(Oe.g)(this.props.contextString)?(this.props.viewSelectorProps||this.props.quickFindProps||this.props.entityFilterProps||this.props.queueFilterProps||this.props.commandBarProps)&&(this.props.featureControlProps.isInMobileModeForOct2019&&Object(Oe.e)(this.props.contextString)&&(a=Object.assign(Object.assign({},a),{display:"none"})),h.push(n.createElement(s.a,{key:"dataSetHeader_"+this.props.id,style:r},this._renderHeader([this._renderBackButtonForGridInMobile(),this._renderViewSelector(),this._renderCommandBar()],a),this._renderQuickFind(),t||this.props.entityFilterProps&&this.props.entityFilterProps.isRollupViewSupported&&this.props.contextString===y.h.ASSOCIATEDGRID?this._renderEntityFilter():this._renderQueueFilter()))):(h.push(this._renderCommandBar()),(this.props.viewSelectorProps||this.props.quickFindProps||this.props.entityFilterProps||this.props.queueFilterProps)&&h.push(n.createElement(s.a,{key:"dataSetHeader_"+this.props.id,style:r},this._renderHeader([this._renderViewSelector(),this._renderDiscardChanges(),this._renderColumnEditor(),this._renderAdvancedFilter(),this._renderQuickFind()],a),t||this.props.entityFilterProps&&this.props.entityFilterProps.isRollupViewSupported&&this.props.contextString===y.h.ASSOCIATEDGRID?this._renderEntityFilter():this._renderQueueFilter())));let c=this.props.chartProps&&this._isReflowLayoutVertical?this.props.styles.reflowdataSetContentBodyStyle:this.props.styles.dataSetContentBodyStyle;this.props.featureControlProps.isAssociatedGridHeightEnabled&&Object(Oe.d)(this.props.contextString)&&(c=Object.assign(Object.assign({},c),{flexBasis:"0px"}));if(this.props.chartProps&&!this._isReflowLayoutVertical&&this.props.featureControlProps.isSuiterChartEnabled||this._showNewQuickFindSearchBarForMobile()){const e="1px solid #d8d8d8";c=Object.assign(Object.assign({},c),{borderTop:e})}const d=(null===(u=null===(l=null===(o=this.props)||void 0===o?void 0:o.configuration)||void 0===l?void 0:l.Parameters)||void 0===u?void 0:u.EnableSubGridAutoCollapse)&&this.props.configuration.Parameters.EnableSubGridAutoCollapse,b=d&&d.Value,f=this.props.featureControlProps.isSubGridAutoCollapseEnabled&&Object(Oe.g)(this.props.contextString)&&"true"===b;f&&0===this.props.totalResultCount&&(c=Object.assign(Object.assign({},c),{display:"none"})),this.props.featureControlProps.isSubGridRemoveMinHeightEnabled&&f&&(c=Object.assign(Object.assign({},c),{minHeight:"0px"}));const v=m&&Object(Oe.e)(this.props.contextString),C=this._parentDefinedProps;this.props.parentDefinedControlProps&&(C.height=this.props.parentDefinedControlProps.height>0&&this._seeMoreHelper.getSeeMorePopupStatus()===g.b.NotInUse?this.props.parentDefinedControlProps.height:void 0,C.width=this.props.parentDefinedControlProps.width>0&&this._seeMoreHelper.getSeeMorePopupStatus()===g.b.NotInUse?this.props.parentDefinedControlProps.width:void 0,C.decorators=this.props.parentDefinedControlProps.decorators,C.propertyBagOverrides=this.props.parentDefinedControlProps.propertyBagOverrides),C.parentInSeeMoreMode=this._seeMoreHelper.getSeeMorePopupStatus()!==g.b.NotInUse,C.containerStyleOverrides=this._getCombinedContainerStyleOverrides();const S="data-set-body-container";let I=null;this.props.chartProps&&this._isWidthInitialized()&&(I={width:"70%"});const _=Fe.a.getInstance().get_IsBrowserIE()?Object.assign(i,{flex:"1 1 100%"}):i;h.push(n.createElement(s.a,{key:"dataSetContentBody_"+this.props.id,style:c},this._renderDataSetChart(),n.createElement(s.a,{key:"dataSetBody_"+this.props.id,style:!0===this._isReflowLayoutVertical?this.props.styles.reflowGridStyle:Object.assign(_,I),className:this._isInSeeMoreState()?"seeMore":void 0,testhooks:{id:S}},n.createElement(p.c,{key:this.props.controlKey+this._keyIndex,controlId:this.props.controlId,id:this.props.id,formInfo:this._savedFormInfo,configuration:this.props.updatedConfiguration,descriptor:this.props.descriptor?this.props.descriptor:this._savedDefault,systemDefinedProperties:this.props.systemDefinedProperties,rowSpan:this.props.rowSpan,parentDefinedControlProps:C,parentContextToken:this.props.contextToken,contextString:this.props.contextString,externalCommandManagerId:this._commandManagerId,externalCommandPromise:this._commandBarLoadedPromise,shouldRender:this.props.nonCompositionProps?this.props.nonCompositionProps.shouldRender:void 0}),v?null:this._renderFooter()))),v&&h.push(this._renderFooter()),h.push(this._renderAccessibilityNotification(e)),h=h.concat(this._renderAccessibilityComponent(e))}}else if(2!==this.state.loadingState&&this._updateDataSetLoadingState(2),h.push(n.createElement(s.a,{key:"dataSetHeader_"+this.props.id,style:r},this._renderHeader([this._renderViewSelector()],a))),this._isWidthInitialized()){const e={fontSize:this._isHeightGreaterThan240()&&this._isWidthGreaterThan480()?"4.5em":"2em",color:"red"},t={display:"flex",justifyContent:"center"},r=Object(A.c)(this.props.resourceStrings,T.SEE_MORE_DETAILS);h.push(n.createElement(s.a,null,n.createElement(c.a,{id:"gridErrorContainer"+this.props.id,text:b,icon:d.a.DetailsPageClose,iconStyle:e}),this.state.controlLoadInnerErrorMessage&&!this._isDataSetHostKnownError(this.state.controlLoadErrorMessage)&&n.createElement(s.a,{style:t},n.createElement(fe.a,{key:"gridInnerErrorMessage",href:"#",accessibilityLabel:r,onClick:()=>{this.props.showInnerError(this.state.controlLoadInnerErrorMessage)}},r))))}const f=Object.assign(Object.assign({},t),this.state.controlLoadInnerErrorMessage&&{backgroundColor:"#FFFFFF"});return n.createElement(s.a,{style:f,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0,id:e,key:e,testhooks:{id:e,[St.b]:this.props.previewId,[St.c]:20},semanticTag:this.props.semanticTag},h)}catch(e){this._onControlLoadedError(e)}}_getDataSetHostErrorMessage(){var e;let t=null;if(this.props.hasReadRolePrivilege)if(this.props.isUCIEntity||this.props.hasCustomDataProvider)if(this.props.offlineProps.isOfflineSqlQueryAvailable)t=this.props.isOffline&&this.state.controlLoadErrorMessage&&!this.props.hasCustomDataProvider?this.props.offlineProps.isEntityAvailableForOffline?this.props.offlineProps.isOfflineAvailableForUse?this.state.controlLoadErrorMessage:Object(A.c)(this.props.resourceStrings,T.OFFLINE_NOT_READY_FOR_USE):Object(A.c)(this.props.resourceStrings,T.ENTITY_NOT_AVAILABLE_IN_PROFILE):this.state.controlLoadErrorMessage;else{let e="";this.props.offlineProps.offlineErrorMessageKey&&(e=Object(A.c)(this.props.resourceStrings,this.props.offlineProps.offlineErrorMessageKey)),e||(e=Object(A.c)(this.props.resourceStrings,T.VIEW_NOTAVAILABLE_IN_OFFLINE)),t=e}else{const e=this.props.entityDisplayName?this.props.entityDisplayName:this.props.entityTypeName,r=Object(A.c)(this.props.resourceStrings,T.UCI_DISABLED_ENTITY_ERROR);t=String.format(r,e)}else t=Object(A.c)(this.props.resourceStrings,T.READ_PRIVILEGE_VIOLATION_KEY);return Object(rt.a)(t)||null===(e=this._tracer)||void 0===e||e.error(`${Bt}._getDataSetHostErrorMessage : ${t}`,this.props.isOffline&&this.props.offlineProps.offlineGridErrorTelemetryParams),t}_renderHeader(e=[],t){const r=(e||[]).filter(e=>!!e);return r.length?n.createElement(s.a,{key:"dataSetHeaderInner_"+this.props.id,style:t},r):null}_getParentDefinedPropsDecoratorValue(e){return this.props.parentDefinedControlProps&&this.props.parentDefinedControlProps.decorators&&this.props.parentDefinedControlProps.decorators[e]}_shouldRenderSeeMoreButton(){return this._getParentDefinedPropsDecoratorValue("ShowSeeMore")&&!!this.props.totalResultCount}_renderSeeMoreButton(){const e=Object(Oe.g)(this.props.contextString),t=Object(Oe.d)(this.props.contextString),r=this._seeMoreHelper.getSeeMorePopupStatus(),i=Object(Oe.f)(this.props);return!((e||t)&&!i)||r===g.b.PopFadeIn||r===g.b.PoppedOut||r===g.b.ReturnFadeOutAndMove||this.props.totalResultCount>=0&&this.props.totalResultCount<=this.props.pageSize&&!this._shouldRenderSeeMoreButton()||!this._isNativePlatform?(this._logInfo("Hiding the See more button for the grid because the grid does not support see more or there is less than 2 pages of data"),null):n.createElement(Ze,{onSeeMoreClick:this._seeMorePopup.bind(this,!0,!1),resourceStrings:this.props.resourceStrings,containerStyle:this.props.styles.seeMoreButtonContainerStyle,buttonStyle:this.props.styles.seeMoreButtonStyle,seeMoreTextStyle:this.props.styles.seeMoreButtonTextStyle,localizedStrings:this._getSeeMoreLocalizedStrings()})}_getSeeMoreLocalizedStrings(){let e=null;return this.props.viewSelectorProps&&this.props.viewSelectorProps.title?e=this.props.viewSelectorProps.title:this.props.descriptor.ShowLabel&&this.props.descriptor.Label?e=this.props.descriptor.Label:this.props.entityDisplayName&&(e=this.props.entityDisplayName),this._isNativeSubgrid()?{uniqueLabel:e,seeMoreLabel:Object(A.c)(this.props.resourceStrings,T.SEE_ALL_LABEL),seeMoreTooltip:Object(A.c)(this.props.resourceStrings,T.SEE_ALL_TOOL_TIP)}:{uniqueLabel:e}}_isStreamOnSuiterDashboard(){return this.props.featureControlProps.isSuiterDashboardEnabled&&Object(Oe.g)(this.props.contextString)&&this.props.configuration&&this.props.configuration.Parameters&&this.props.configuration.Parameters.UseDefaultCardFormForList&&this.props.configuration.Parameters.UseDefaultCardFormForList.Value}_renderProgressIndicator(){let e="datasethost-progress-indicator";this.props.descriptor&&(e+="-"+this.props.descriptor.Id);const t=Object.assign({},this.props.styles.dataSetChangingProgressIndicatorContainerStyle);let r=this.props.styles.progressIndicatorContainerStyle;return 1===this.state.loadingState?(t.width=this._width,t.height=Math.max(this._height,100)):0===this.state.loadingState&&this._isStreamOnSuiterDashboard()&&(r=Object.assign(Object.assign({},r),{borderBottom:"none"})),n.createElement(s.a,{key:"progressIndicatorContainer",id:"progressIndicatorContainer",style:0===this.state.loadingState?r:t},n.createElement(s.a,{key:"progressIndicator",id:"progressIndicator",style:0===this.state.loadingState?this.props.styles.progressIndicatorStyle:this.props.styles.dataSetChangingProgressIndicatorStyle},n.createElement(u.a,{key:e,id:e,testhooks:{id:e},style:this.props.styles.datasethostProgressIndicatorStyle,progressType:"ring",displayDelay:0===this.state.loadingState&&2e3,active:!0})))}componentWillUnmount(){this._seeMoreHelper&&this._seeMoreHelper.destroy(),clearTimeout(this._statusTimeout),this._statusTimeout=null}get _tracer(){return this.context?this.context.TraceManager.getTracer(y.z):null}_updateStatus(e){this.state.statusMessage===e||this._isSubGridFirstLoad||(clearTimeout(this._statusTimeout),this._statusTimeout=setTimeout(()=>this.setState({statusMessage:e}),1e3))}render(){var e,t,r,i,a;if(Object(rt.a)(this.props.updatedConfiguration))return this._logInfo("DataSetHost not rendered. Configuration is null"),null;if(!this.props.isInitialized&&this.props.contextToken&&this.props.primaryDataSetName&&this.state.compositeControlInitState!==N.a.Error){const e=this.props.updatedConfiguration.Parameters[this.props.primaryDataSetName];if(!e)return this._logInfo("DataSetHost not rendered. DataSet is not initialized and configuration does not contain primary dataset name."),null;if(this.state.compositeControlInitState===N.a.Uninitialized){this.setState({compositeControlInitState:N.a.Initializing});const t=this.props.viewId?this.props.viewId:e.ViewId?C.a.parse(e.ViewId):null,r=this.props.gridEntityTypeName||e.TargetEntityType||e.EntityName;if(!r&&!this.props.hasCustomDataProvider)return this._tracer&&this._tracer.error("DataSetHost not rendered. Reason: entityName unknown"),null;this.props&&this.props.hasCustomDataProvider&&this._logInfo("render: Initializing DataSetHost, id "+this.props.controlId+", for custom data provider"),this._logInfo(`Initializing grid for ${t} view and ${r} entity.`),this.props.initializeGrid(t,r,this.props.commandBarProps&&this.props.commandBarProps.commandManagerId,this.props.contextToken).then(()=>{this._logInfo(`Initialized grid for ${t} view and ${r} entity.`),this.setState({compositeControlInitState:N.a.Initialized})},e=>{const t=e instanceof Error?e.message:e;-1!==et.c.indexOf(t)?this._setControlLoadError(t):this._tracer&&this._tracer.error("Grid initialization failed. Reason: "+t),this.setState({compositeControlInitState:N.a.Error})})}return this._logInfo("DataSetHost not rendered. Either state is not initialized or resource strings are not initialized"),null}if(this.props&&this.props.nonCompositionProps&&this.props.nonCompositionProps.addedCommandListFromHostParent&&this._addedCommandListFromHostParent!==this.props.nonCompositionProps.addedCommandListFromHostParent&&(this._addedCommandListFromHostParent=this.props.nonCompositionProps.addedCommandListFromHostParent,this._onAddedCommandListChange()),this.props.descriptor&&this.props.descriptor.Parameters){const e=this.props.descriptor.Parameters[y.c];if(this._isWidthLessThanViewportSm()&&e&&"false"===e)return this._logInfo("DataSetHost not rendered. Available on phone is set to false"),null}this._configureDataSetControlParams(),this._updateViewSelectorProps(this.props),!this.props.viewId||!(null===(e=this.props.nonCompositionProps)||void 0===e?void 0:e.setPageInputViewId)||this.props.viewId.guid===(null===(r=null===(t=this.props.gridInput)||void 0===t?void 0:t.viewId)||void 0===r?void 0:r.guid)&&(null===(i=this.props.gridInput)||void 0===i?void 0:i.viewType)||this.props.savedQueryType===_.a.QUICKFIND_SEARCH||this.props.nonCompositionProps.setPageInputViewId(this.props.viewId.guid),this._savedDefault&&this.props.controlId===this._savedDefault.Id||(this._savedDefault={Id:this.props.controlId,HasContext:!0,Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1}),this.props.formInfo&&(this._savedFormInfo=this.props.formInfo,null!=this.props.ribbonId&&(this._savedFormInfo.RibbonId=this.props.ribbonId));const o=this.props.descriptor&&this.props.descriptor.DomId&&this.props.descriptor.Id?this.props.descriptor.DomId.includes(this.props.descriptor.Id)?this.props.descriptor.DomId:this.props.descriptor.Id:this.props.id,c="dataSetRoot_"+o,{containerStyle:u,headerStyle:d}=this.props.styles;let{rootStyle:p,headerInnerStyle:h,bodyStyle:m}=this.props.styles;this._updateChangeVisualizationButtons(this.props.updatedConfiguration.FormFactor.toString());let b=u,f={shadowStyle:null,innerStyle:null,outerStyle:null};this._isWidthLessThanViewportSm()&&(m=this.props.styles.bodyMobileStyle,h=this.props.styles.headerInnerMobileStyle);const v=this._seeMoreHelper.getSeeMorePopupStatus(),S=this._seeMoreHelper.getSeeMorePopupInfo();v!==g.b.NotInUse&&(f=g.a.getCustomControlFancyPopoutStyles(this.props.renderer,v,S),v!==g.b.ReturnFadeIn&&(b={height:S.startHeight,width:S.startWidth},p=Object.assign(Object.assign({},p),{height:S.endHeightInner-48})));const I=this.renderDataSetHostComponent(c,p,d,m,h),O=(this._getDataSetHostRootElement(),this._seeMorePopup.bind(this,!1)),T=this.props.isRTL,j=function(e,t,r,i,a,o,c,l=!1){const u=a||o,d="DataSetHostContainer";return n.createElement(s.a,{key:d,id:`${d}_${c}`,style:u,testhooks:{id:d}},e.renderCloseButton(i,!0,!1,l),e.renderSpacer(!0,!1),t)}(this._seeMoreHelper,I,0,O,f.innerStyle,p,c,T);let P=Object.assign({},f.outerStyle?f.outerStyle:p);0===this.state.loadingState?(P.visibility="hidden",P.maxHeight="0"):1===this.state.loadingState&&(P=Object.assign(Object.assign({},P),{opacity:"0.6",pointerEvents:"none",minHeight:this._height}));const E=function(e,t,r,i){const a=t||{width:"100%"},o=i?Ee.e:null;return n.createElement(s.a,{key:"DataSetHostOuterContainer",id:r+"_outer",style:a,role:o},e)}(j,P,c,(null===(a=this._seeMoreHelper)||void 0===a?void 0:a.getSeeMorePopupStatus())!==g.b.NotInUse),x=function(e,t){return t=t||{display:"none"},n.createElement(s.a,{key:"shadow",id:e?e+"shadow":null,style:t})}(c,f.shadowStyle),A=`datassethost_root_view_${o}_${c}`,w=Fe.a.getInstance().get_IsBrowserIE()&&Object(Oe.g)(this.props.contextString)?{overflow:"visible"}:{},{mobileSubGridContainerStyles:F}=this.props.styles;let k=Object.assign(b,w);return this._isNativePlatform&&Object(Oe.g)(this.props.contextString)&&this.props.featureControlProps.isInMobileModeForApril2020&&this.props.featureControlProps.isSubgridImprovementsEnabled&&(k=Object.assign(Object.assign({},k),F)),n.createElement(s.a,{key:A,style:k},n.createElement(l.a,{role:Ee.s,notificationType:Be.b,style:{left:"-3000%",width:"0%",height:"0%",position:"absolute"}},this.state.statusMessage),x,E,this.props.showAdvancedFilter&&this.state.isFilterPanelOpen&&n.createElement(Et,{controlId:this.props.controlId,controlKey:this.props.controlKey,id:this.props.id,contextToken:this.props.contextToken,entityTypeName:this.props.entityTypeName,fetchXML:this.props.fetchXML,filterPanelOpen:this.state.isFilterPanelOpen,viewId:this.props.viewId,gridInput:this.props.gridInput,updateFetchXml:this.props.updateFetchXml,updatePageInput:this.props.updatePageInput,closeFilterPanel:this.closeFilterPanel,onViewChanged:this._onViewChanged,setAdvancedPanelApplyClick:()=>{this._clearCustomFilterAndUpdateControlKeyIndex(),this.setState({isAdvancedFilterEdited:!0})},originalView:this.props.originalView,resourceStrings:this.props.resourceStrings,telemetryMonitorAdvancedFindDiscard:Xt,resetAdvancedFilter:()=>this.setState({isAdvancedFilterEdited:!1})}),this.props.showColumnEditor&&n.createElement(Rt,{entityTypeName:this.props.entityTypeName,onViewChanged:this._onViewChanged,columnEditorPanelOpen:this.state.columnEditorPanelOpen,columnEditorPanelDismiss:()=>this.setState({columnEditorPanelOpen:!1}),viewId:this.props.viewId,pageId:this.props.id,gridInput:this.props.gridInput,updatePageInput:this.props.updatePageInput,fetchXML:this.props.fetchXML,isAdvancedFindFilterEdited:this.state.isAdvancedFilterEdited}),2!==this.state.loadingState?this._renderProgressIndicator():null)}componentDidMount(){this._getUpdateAddedCommandList(this._showCommandBarButtonSearch(),this._showCommandBarButtonShowChart())}closeFilterPanel(){this.setState({isFilterPanelOpen:!1})}componentWillReceiveProps(e){(Object(Oe.e)(this.props.contextString)||Object(Oe.g)(this.props.contextString)||Object(Oe.d)(this.props.contextString))&&!this.props.isOffline&&e.isOffline&&0===this._offlineSqlQueryRetrieveState&&this.props.offlineProps.isEmptyOfflineSqlQuery&&(this._offlineSqlQueryRetrieveState=1,this.props.retrieveView(this.props.entityTypeName,this.props.savedQueryType,this.props.viewType,this.props.viewId,!1).then(()=>{this._offlineSqlQueryRetrieveState=2;const e=[{name:"scenario",value:"Called retrieveView"},{name:"entityTypeName",value:this.props.entityTypeName},{name:"viewId",value:C.a.toString(this.props.viewId)}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentSuccess&&this.context.EventManager.ReportComponentSuccess(Bt+".componentWillReceiveProps",e)}).catch(e=>{this._offlineSqlQueryRetrieveState=2;const t=[{name:"scenario",value:"Called retrieveView"},{name:"error",value:e&&e.message},{name:"entityTypeName",value:this.props.entityTypeName},{name:"viewId",value:C.a.toString(this.props.viewId)},{name:"viewType",value:this.props.viewType},{name:"savedQueryType",value:this.props.savedQueryType}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentFailure&&this.context.EventManager.ReportComponentFailure(Bt+".componentWillReceiveProps",e,null,t)})),this._isShowChartChanged=this.props.showChart!==e.showChart}shouldComponentUpdate(e){return this.props.entityTypeName===j.a&&this.props.gridEntityTypeName!==e.gridEntityTypeName&&this._currentFilterValue?(this._updateFilterOnViewSelectorChange(e.gridEntityTypeName),!1):1!==this._offlineSqlQueryRetrieveState&&(0!==e.refreshCounter&&this.props.refreshCounter!==e.refreshCounter&&2===this.state.loadingState&&this._updateDataSetLoadingState(1),!0)}componentDidUpdate(){this._seeMoreHelper.getSeeMorePopupStatus()!==g.b.NotInUse&&this._seeMoreHelper.checkOnPopupStatus(!0,!1,this._getDataSetHostRootElement());const e=Object(A.c)(this.props.resourceStrings,T.GRID_LOADING_PLACEHOLDER).replace("{0}",this.props.entityDisplayName),t=2===this.state.loadingState?this.props.notificationMessage:e;Object(Oe.g)(this.props.contextString)&&(0===this.state.loadingState?this._isSubGridFirstLoad=!0:1===this.state.loadingState&&(this._isSubGridFirstLoad=!1)),this._updateStatus(t)}_renderAccessibilityComponent(e){const t=e+"Accessibility";if(Object(Oe.e)(this.props.contextString)){const r=[];if(this.props.viewSelectorProps){const i=this.props.viewSelectorProps.id;r.push(n.createElement(Pe.a,{key:t,rootElementId:e,isModal:!1,shouldManageFocus:!0,defaultFocusId:i}))}else r.push(n.createElement(Pe.a,{key:t,rootElementId:e,isModal:!1,shouldManageFocus:!0}));return r}return null}_isInSeeMoreState(){const e=this._seeMoreHelper.getSeeMorePopupStatus();return e!==g.b.NotInUse&&e!==g.b.ReturnFadeOutAndMove&&e!==g.b.ReturnFadeIn}_isNativeSubgrid(){return Object(Oe.g)(this.props.contextString)&&this.props.clientHostSubtype===Mt.a.Phone&&this.props.featureControlProps.isInMobileModeForOct2019&&this.props.featureControlProps.isInMobileModeForApril2020&&this.props.featureControlProps.isSubgridImprovementsEnabled}_getCombinedContainerStyleOverrides(){const{containerStyleOverrides:e}=this._parentDefinedProps,t=this.props.parentDefinedControlProps&&this.props.parentDefinedControlProps.containerStyleOverrides;return Object.assign(e,t,{rootContainer:Object.assign(e.rootContainer,{flex:Object(Oe.e)(this.props.contextString)||this._isInSeeMoreState()?"1 1 100%":"1 1 auto"},t&&t.rootContainer),primaryInnerContainer:this._isInSeeMoreState()?{flex:"1 1 100%",minHeight:"0"}:{}})}_updateViewSelectorProps(e){if(e.descriptor&&e.viewSelectorProps&&e.descriptor.Parameters){const t=e.descriptor.Parameters[y.B],r=t?t.toString().split(","):null,n=r?r.map(e=>C.a.tryParse(e)):null;e.viewSelectorProps.viewIds=n||null}}_getCachedSize(){return this._cachedSize||(this._cachedSize=this.props.cachedSize),this._cachedSize}_isWidthInitialized(){return this.state.isWidthInitialized||this._getCachedSize()&&this._getCachedSize().isWidthInitialized||!1}_isWidthLessThanViewportSm(){return this.state.isWidthLessThanViewportSm||this._getCachedSize()&&this._getCachedSize().isWidthLessThanViewportSm||!1}_isWidthLessThanViewportM(){return this.state.isWidthLessThanViewportM||this._getCachedSize()&&this._getCachedSize().isWidthLessThanViewportM||!1}_isWidthLessThanMinWidthForChartPlusGridReflow(){return this.state.isWidthLessThanMinWidthForChartPlusGridReflow||this._getCachedSize()&&this._getCachedSize().isWidthLessThanMinWidthForChartPlusGridReflow||!1}_isWidthGreaterThan480(){return this.state.isWidthGreaterThan480||this._getCachedSize()&&this._getCachedSize().isWidthGreaterThan480||!1}_isHeightGreaterThan240(){return this.state.isHeightGreaterThan240||this._getCachedSize()&&this._getCachedSize().isHeightGreaterThan240||!1}_showCommandBarButtonSearch(){return this.state.showCommandBarButtonSearch||this._getCachedSize()&&this._getCachedSize().showCommandBarButtonSearch||!1}_showCommandBarButtonShowChart(){return this.state.showCommandBarButtonShowChart||this._getCachedSize()&&this._getCachedSize().showCommandBarButtonShowChart||!1}_isJumpBarRenderingAsFlyout(){return this.state.isJumpBarRenderingAsFlyout||this._getCachedSize()&&this._getCachedSize().isJumpBarRenderingAsFlyout||!1}_hideJumpbarForMobile(){return this.props.featureControlProps.isJumpbarFeatureForMobileEnabled&&this._isWidthLessThanViewportSm()&&(Object(Oe.e)(this.props.contextString)||Object(Oe.d)(this.props.contextString))&&this.props.featureControlProps.isInMobileModeForApril2020}_showNewQuickFindSearchBarForMobile(){var e,t;return this._checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot()&&this._isWidthLessThanViewportSm()&&((null===(e=this.props.configuration)||void 0===e?void 0:e.CustomControlId)===y.p||(null===(t=this.props.configuration)||void 0===t?void 0:t.Name)===y.m)}_checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot(){return this.props.featureControlProps.isQuickFindImprovementsEnabled&&this.props.featureControlProps.isInMobileModeForApril2020&&Object(Oe.e)(this.props.contextString)}}function zt(e,t){return n.createElement(Ut,Object.assign({},e,{renderer:t.renderer}))}Ut.displayName="DataSetHost",Ut.contextType=It.a,zt.contextTypes={renderer:a.object};const Ht=Object(o.a)(Oe.i,(function(e,t){return{initializeGrid:(r,n,i,a)=>{const o=tt.a.fromXmlAndSql("","",r).getQueryState(),s=t.descriptor&&t.descriptor.Parameters?t.descriptor.Parameters[y.r]:null,c=t.descriptor&&t.descriptor.Parameters&&t.descriptor.Parameters[y.s]?parseInt(t.descriptor.Parameters[y.s],10):null;i||(i=Object(ae.c)(t.id,a));const l=e(Object(st.d)(o,n,t.id,a,t.descriptor,s,c,void 0,i)),u=e(Object(yt.b)(n,r,t.id)),d=e(Object(x.e)(T.labelList));return Promise.all([l,d,u])},removeEditedViewPageMap:(t,r)=>e(Object(At.c)(t,r.guid)),updatePageInput:(t,r)=>e(Object(wt.b)(t,r)),updateView:(r,n,i,a,o,s,c,l,u)=>{const d=e(Object(ct.a)(r,s,n,i,a)).then(()=>e(Object(pt.a)(r,o))),p=C.a.tryParseOrNull(i),h=e(Object(yt.b)(a,p,r));let g=Promise.resolve(null);if(u){const t=Object($e.a)(a,c,s,l,!0);g=e(t.getFilterOptionsAction())}return Promise.all([d,h,g]).then(()=>{if(Object(Oe.e)(t.contextString)){const e=[{filterType:0,filterExpressionOrValue:null}];t.updateGridPaginationStateHandler(e,t.id)}e(Object(Se.m)("",r,s)),e(Object(Se.n)("",r,s)),e(Object(Se.j)("",r,s)),e(Object(it.b)("",0,r,s))})},retrieveView:(t,r,n,i,a)=>e(Object(E.a)(t,r,n,i,!1)),markSelectedRows:(t,r,n)=>e(Object(Re.b)(t,r,n)),markSelectedRelatedEntity:(t,r,n)=>e(Object(Le.b)(t,r,n)),rowProperties:(t,r,n)=>e(Object(lt.b)(t,r,n)),updateFetchXml:(t,r,n)=>e(Object(ut.b)(t,r,n)),applyGridFilter:(r,n,i)=>{if(Object(Oe.e)(t.contextString)){const e=[{filterType:8,filterExpressionOrValue:r},{filterType:11,filterExpressionOrValue:n}];t.updateGridPaginationStateHandler(e,t.id)}e(Object(Se.k)(n,t.id,i)),e(Object(Se.l)(r,t.id,i))},applyActivityTypeFilter:(r,n,i)=>{if(Object(Oe.e)(t.contextString)){const e=[{filterType:9,filterExpressionOrValue:r},{filterType:10,filterExpressionOrValue:n}];t.updateGridPaginationStateHandler(e,t.id)}e(Object(Se.h)(n,t.id,i)),e(Object(Se.i)(r,t.id,i))},onSelectedOrderColumnChange:(r,n)=>{e(Object(Se.o)(r,t.id,n))},toggleGridRollupView:(r,n)=>{e(Object(dt.b)(r,t.id,n))},updatePagingData:(t,r,n)=>e(Object(at.b)(t,r,n)),updateQueryKey:(t,r,n)=>{e(Object(ot.b)(t,r,n))},setCustomFilter:(t,r,n,i)=>e(Object(it.b)(t,r,n,i)),runOnRecordSelect:(r,n,i)=>{e(function(e,t,r,n,i){return{type:"dataset.run.on.record.select",sync:!0,execute({dispatch:i,getState:a},o){const s=o.TraceManager.getTracer(y.z),c=y.x+".RunOnRecordAction";try{if(o&&o.ScriptManager){const l=o.ScriptManager.getContainer(e);if(l&&n&&1===n.length){const e=Object(nt.c)(a()),u=Object(nt.b)(a());e&&(i(l.getEventManager().addGridOnRecordSelectHandlers(t)),i(l.getEventManager().addGridOnChangeHandlers(t))),(e||u)&&i(l.getEventManager().runOnRecordSelect(t,r)),s.info("Triggered the action for {0} selected records"+n.length),o.EventManager.ReportComponentSuccess(c)}}}catch(e){const t="Triggered action for selected records failed with error : "+e.message;o.EventManager.ReportComponentFailure(c,Error(t))}}}}(r,n,n.controlName?n.controlName:"entity_control",i,Object(Oe.e)(t.contextString)||Object(Oe.g)(t.contextString)))},retrieveRelatedEntitiesMetadata:t=>e(Object(Ft.a)(t)),switchHomepageConfiguration:(t,r,n,i,a)=>{e(Object(ht.g)(t,r,n,i,a))},switchViewConfiguration:(t,r,n,i,a)=>{e(Object(ht.i)(t,r,n,i,a))},switchSubgridVisualization:(t,r,n)=>{e(Object(ht.h)(t,r,n))},switchAssociatedGridVisualization:(t,r,n,i,a,o,s,c)=>{e(c?Object(ht.f)(t,r,n,i,a,o,s):Object(ht.e)(t,r,n,a,s))},toggleChartPane:(t,r,n)=>{e(Object(ft.b)(t,r,n))},clearQuery:()=>{e(Object(Pt.a)())},updateUserDefaultGridView:(t,r,n,i,a,o)=>e(function(e,t,r,n,i,a){return{type:"grid.update.userdefaultview",execute(o,s){const c=s.TraceManager.getTracer(y.z),l=y.x+".updateUserDefaultGridViewAction";try{c.info("Updating the user default view for the grid.");const u=o.getState(),d="usersettings",p=new mt.a(d,Object(We.q)(u)),h=Object(F.h)(u,e);if(!p||!h.ObjectTypeCode)return Promise.resolve();const g="<DefaultGridViews><DefaultGridView><EntityTypeCode>{0}</EntityTypeCode><ChildEntityName>{1}</ChildEntityName><QueueId>{2}</QueueId><ViewId>{3}</ViewId><ViewType>{4}</ViewType></DefaultGridView></DefaultGridViews>";a&&(t="",r="",i=[],n="");const m=[];for(const e of i){const t=C.a.tryParse(e),r=C.a.externalGuid(t);m.push(r)}const b=String.format(g,h.ObjectTypeCode,n||"",1===m.length?m.toString():"",C.a.externalGuid(C.a.tryParse(t)),r);o.dispatch(Object(gt.f)(p,{personalizationsettings:b}));const y={ViewId:t,ViewType:+r,QueueId:i.toString()};return o.dispatch(Object(bt.f)(y,e)),s.EventManager.ReportComponentSuccess(l),Promise.resolve()}catch(e){const t="Failed to update user default grid view with error : "+e.message;s.EventManager.ReportComponentFailure(l,Error(t))}}}}(t,r,n,i,a,o)),updateCurrentPageNumber:(t,r,n)=>e(Object(we.b)(t,r,n)),setNewPageRequested:(t,r,n)=>{e(Object(Me.b)(t,r,n))},retrieveControlResourceStringsForSwitchVisualization:t=>{const r=t.filter(e=>null!=e);return e(Object(x.e)(r))},updatePageNumberForEnhancedPaging:e=>{if(Object(Oe.e)(t.contextString)){const r=[{filterType:12,filterExpressionOrValue:e}];t.updateGridPaginationStateHandler(r,t.id)}},openManageDuplicatesDialog:t=>{e(Object(_t.a)(null,null,mt.a.fromExternalEntityReference(t.entityReference))).then(r=>{if(0===r.status)return e(Object(Ot.a)(r.pageId)).then(e=>{"ignore_save"===e.value.param_lastButtonClicked&&t.reject()})})},showInnerError:r=>{const n=new kt.a(r,null,null,null,null,{stack:`${r} ${(new Error).stack}`,message:r});e(Object(Nt.a)(t.id,n))}}}))(zt)},"91Ew":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="attribute.option.add";function a(e,t,r,a,o){const s=Object(n.x)(t);return{type:i,payload:{option:a,index:o},meta:{pageId:e,contextKey:s,dataFieldName:r}}}},"95wm":function(e,t,r){"use strict";r.d(t,"f",(function(){return h})),r.d(t,"c",(function(){return m})),r.d(t,"d",(function(){return b})),r.d(t,"b",(function(){return g})),r.d(t,"e",(function(){return y})),r.d(t,"a",(function(){return f}));var n=r("SAYH"),i=r("eXjw"),a=r("GEBM"),o=r("haag"),s=r("0L4T"),c=r("iZ7K"),l=r("YxC/"),u=r("69Qu"),d=r("WPtp"),p=r("LbMF");const h=o.a;function g(e,t,r,i,d,p,g,m=!1){return function(e,t,r){if(!n.a.toString(r.viewId)){const r="viewid is required to call retrieve chart data";throw e.EventManager.ReportComponentFailure(h+".retrieveChartData",Error(r),o.d,t),new Error(r)}return!0}(r,i,d)&&function(e,t,r,i,o){if(!n.a.toString(r.visualizationId)||n.a.toString(r.visualizationId)===n.a.EMPTYGUIDSTRING){const n=e(),u=Object(l.b)(n,a.n),d=Object(c.f)(n,i)||i,p=String.format(u,d);return Object(s.a)(n,t,p,r,o),!1}return!0}(e,t,d,p,g)&&function(e,t,r,n){const i=e();if(!Object(u.b)(i)){const e=Object(l.b)(i,a.r);return Object(s.a)(i,t,e,r,n),!1}return!0}(e,t,d,g)&&function(e,t,r,n){if(r.isRollUpView){const i=e(),o=Object(l.b)(i,a.j);return Object(s.a)(i,t,o,r,n),!1}return!0}(e,t,d,g)&&(!m||function(e,t,r,n){if(!r.viewXml){const i=Object(l.b)(e(),a.g);return Object(s.a)(e(),t,i,r,n),!1}return!0}(e,t,d,g)&&function(e,t,r,n){if(!r.fetchXml){const i=Object(l.b)(e(),a.o);return Object(s.a)(e(),t,i,r,n),!1}return!0}(e,t,d,g))}function m(e,t,r){const a=new n.a(e),o=n.a.toString(a),s=new n.a(t);return{type:r,payload:{charts:{[o]:{[n.a.toString(s)]:{initialized:i.a.Initializing}}}}}}function b(e,t){return{type:t,payload:{chartData:{[e]:{initialized:i.a.Initializing}}}}}function y(e,t,r){var n;const i=null===(n=null==e?void 0:e.category)||void 0===n?void 0:n.primaryGroupBy,a=null==i?void 0:i.groupAttribute;if(!function(e,t){var r;if(!e)return!1;const n=null===(r=null==e?void 0:e.entity)||void 0===r?void 0:r.entityName,i=null==e?void 0:e.attributeName,a=Object(p.b)(i,n,t);return"picklist"===a||"state"===a||"status"===a}(a,r))return;if(!e.isOrderPresentOnPrimaryGroupBy())return;const o=a.aliasName,s=new v(o);t.sort(s.comparator),i.descending&&t.reverse()}function f(e){const t=/(Name=\"o\:)(\w+)(,)(\d+)(\")/,r=e.match(new RegExp(t,"g"));let n=[];return r&&r.forEach(e=>{n=e.match(new RegExp(t,"m"))}),n}class v{constructor(e){this._primaryGroupByAttributeAlias=null,this.comparator=(e,t)=>this._getRawValue(e)-this._getRawValue(t),this._primaryGroupByAttributeAlias=e}_getRawValue(e){if(this._primaryGroupByAttributeAlias in e.fields){const t=e.fields[this._primaryGroupByAttributeAlias],r=Object(d.e)(t);return parseInt(r,10)}return-1}}},"9NSo":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="form.setLabel";function a(e,t,r){const a=Object(n.v)(t);return{type:i,payload:{label:r},meta:{pageId:e,contextKey:a}}}},"9i5P":function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r("OQLa"),i=r("SAYH"),a=r("16wZ"),o=r("UqyN"),s=r("L8zx"),c=r("3yqi"),l=r("EOIL"),u=r("P6DH"),d=r("qshH"),p=r("9ksH"),h=r("E7fB"),g=r("n6Qt"),m=r("arV0"),b=r("deGN"),y=r("ZIjf");let f;class v{constructor(e,t,r,n,i,o){const s="ClientApi.XrmGridRow.constructor";e||Object(a.j)(s,"store"),n||Object(a.j)(s,"pageId"),r||Object(a.j)(s,"contextToken"),i||Object(a.j)(s,"entityType"),o||Object(a.j)(s,"entityId"),f=e,this._applicationContext=t,this._pageId=n,this._contextToken=r,this._entityType=i,this._entityId=o}get applicationContext(){return y.a.instance.reportUsage("ClientApi.XrmGridRow.applicationContext_get"),this._applicationContext}get context(){const e="ClientApi.XrmGridRow.context";try{return y.a.instance.reportCall(e),this._globalContext||(this._globalContext=new h.a(f,this._pageId)),y.a.instance.reportSuccess(e),this._globalContext}catch(t){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(e,t,null,r),t}}get data(){const e="ClientApi.XrmGridRow.data";try{if(y.a.instance.reportCall(e),!this._data){const t=new o.a(f,this._contextToken,this._pageId,this,this._entityType,this._entityId,C,this._applicationContext);this._data=new s.a(f,this._contextToken,this._pageId,this,t);const r=new p.b(f,this._pageId),n=[],a={isEventParam:!0,name:"attributeName",value:""};n.push(a),t.attributes.forEach(t=>{const o=t.getName();a.value=o;const s={Id:o,Label:null,Name:o,ShowLabel:!1,Visible:!0,ClassId:new i.a(p.a),Disabled:!1,DataFieldName:o},c=r.createXrmControl(this._contextToken,s,this,e,n);c&&t.controls.add(c.getName(),c)})}return y.a.instance.reportSuccess(e),this._data}catch(t){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(e,t,null,r),t}}getData(){try{return y.a.instance.reportUsage("ClientApi.XrmGridRow.getData"),this.data}catch(e){const t=d.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.getData",e,null,t),e}}get ui(){try{if(y.a.instance.reportCall("ClientApi.XrmGridRow.ui"),!this._ui){const e=new p.b(f,this._pageId);this._ui=new l.a(f,this._contextToken,this._pageId,this,this._entityType,e)}return y.a.instance.reportSuccess("ClientApi.XrmGridRow.ui"),this._ui}catch(e){const t=d.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.ui",e,null,t),e}}getControl(e){const t="ClientApi.XrmGridRow.getControl";try{y.a.instance.reportCall(t);const r=this.ui.controls.get(e);return y.a.instance.reportSuccess(t),r}catch(e){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,r),e}}getAttribute(e){const t="ClientApi.XrmGridRow.getAttribute";try{if(y.a.instance.reportCall(t),this.data.entity){const r=this.data.entity.attributes.get(e);return y.a.instance.reportSuccess(t),r}return y.a.instance.reportSuccess(t),null}catch(e){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,r),e}}getUrl(e){const t="ClientApi.XrmGridRow.getUrl";try{y.a.instance.reportCall(t);const r=this.data.entity.getEntityReference();this._internal=new g.a(f,this._applicationContext,this.context,this._pageId);const a=Object(m.g)(f.getState(),this._pageId),o={entityTypeName:r.entityType,etn:r.name,id:i.a.fromExternalGuid(r.id),entityTypeCode:this._internal.getEntityCode(r.entityType),languageId:this.context.userSettings.languageId,recordSetQueryKey:a.recordSetQueryKey};if(1===e){const e=f.dispatch(Object(n.a)(c.a.EditForm,o));return y.a.instance.reportSuccess(t),e}const s=Object(b.a)(f,this._pageId),l=f.dispatch(Object(n.c)(s,c.a.EditForm,o));return y.a.instance.reportSuccess(t),l}catch(e){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,r),e}}get entityReference(){try{return this.data.entity.getEntityReference()}catch(e){const t=d.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.entityReference",e,null,t),e}}}function C(e,t,r){const n=Object(u.D)(f.getState(),{id:r},t.parentContextToken);return n||(e.TraceManager.getTracer("ClientApi.XrmGridRow.getAttributeNames").error("Grid attributes was null"),[])}},"9ksH":function(e,t,r){"use strict";r.d(t,"b",(function(){return Ee})),r.d(t,"a",(function(){return je}));var n=r("AF/G"),i=r("arV0"),a=r("HcnX"),o=r("i1f0"),s=r("TsER"),c=r("qshH"),l=r("ZIjf");let u;class d extends a.a{constructor(e,t,r,n,i,a){super(e,t,r,n,i,a),u=e}refresh(){const e="ClientApi.XrmControlTimer.refresh";try{l.a.instance.reportCall(e),u.dispatch(Object(s.b)(this.pageId,this.contextToken,this.name)),l.a.instance.reportSuccess(e)}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,r),t}}getState(){const e="ClientApi.XrmControlTimer.getState";try{l.a.instance.reportCall(e);const t=Object(o.cb)(u.getState(),this.pageId,this.contextToken),r=t.controls[this.getName()].parameters.timerState;return l.a.instance.reportSuccess(e),r}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,r),t}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlTimer.getControlType"),"timercontrol"}}var p=r("lJW1"),h=r("1kth"),g=r("16wZ"),m=r("PUjk");let b;class y extends a.a{constructor(e,t,r,n,i,a){super(e,t,r,n,i,a),b=e,this.registerObserversForControlStateChange()}addOnClick(e){const t="ClientApi.XrmControlButton.addOnClick";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),b.dispatch(Object(h.b)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,r),e}}removeOnClick(e){const t="ClientApi.XrmControlButton.removeOnClick";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),b.dispatch(Object(h.w)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,r),e}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlButton.getControlType"),"button"}registerObserversForControlStateChange(){if(this.getName().startsWith("header_process")){const e=Object(m.a)(this.pageId);e&&this.controlStateObservable.registerObserver(e)}}}var f=r("0nOn"),v=r("yl9a"),C=r("NjDY"),S=r("3mEc");let I;class _ extends a.a{constructor(e,t,r,n,i,a){super(e,t,r,n,i,a),I=e;const o=[{name:"controlName",value:i,isEventParam:!0}];this._clientApiExecutorWebResource=new f.a(e,"ClientApi.XrmControlWebResource.",r,t,o)}getSrc(){return this._clientApiExecutorWebResource.execute("getSrc",()=>{const e=I.getState(),t=Object(C.t)(e)+Object(o.wb)(e,{controlName:this.name,id:this.pageId},this.contextToken);return Object(S.c)(e,this.pageId,this.name,this.contextToken,t)})}getContentWindow(){return this._clientApiExecutorWebResource.executeAsync("getContentWindow",(e,t)=>{const r=this.formContext.applicationContext.TraceManager.getTracer(e),n=()=>{const e=Object(o.xb)(I.getState(),this.pageId,this.getName());if(e){let n=null;try{return n=e.contentWindow,"complete"===n.document.readyState?Promise.resolve(n):(t.push({name:"readyState",value:n.document.readyState}),r.info("Frame content window not ready",t),Promise.reject({message:"Frame element not ready.",errorCode:111,contentWindow:n}))}catch(e){return n?(t.push({name:"Error",value:e.message}),r.warn("Error getting Frame content window readyState",t),Promise.resolve(n)):Promise.reject(e)}}else r.info("Frame DOM element not ready",t);return Promise.reject({message:"Frame element could not be found.",errorCode:111})};return n().then(e=>Promise.resolve(e)).catch(e=>{if(111!==e.errorCode)return Promise.reject(e);const i=this.contextToken,a=this.pageId,o=this.getName();return new Promise((e,s)=>{const c=()=>{Object(h.G)(i,a,c,o),n().then(t=>{e(t)}).catch(n=>{n.contentWindow?(r.err("Frame content window readyState should be complete after OnReadyStateComplete",t),e(n.contentWindow)):s&&(111===n.errorCode?(r.err("Frame Element not found after OnReadyStateComplete",t),s(new Error("Frame element could not be found."))):s(n))})};I.dispatch(Object(h.l)(i,a,c,o))})})})}getObject(){return this._clientApiExecutorWebResource.execute("getObject",()=>Object(o.xb)(I.getState(),this.pageId,this.name))}setSrc(e){return this._clientApiExecutorWebResource.execute("getControlType",()=>{Object(g.a)(e)||I.dispatch(Object(v.b)(this.pageId,this.name,this.contextToken,e))})}getControlType(){return this._clientApiExecutorWebResource.execute("getControlType",()=>"webresource")}addOnReadyStateComplete(e){return this._clientApiExecutorWebResource.execute("addOnReadyStateComplete",()=>{I.dispatch(Object(h.l)(this.contextToken,this.pageId,e,this.getName()))},[{name:"handler",value:e,isRequired:!0}])}removeOnReadyStateComplete(e){return this._clientApiExecutorWebResource.execute("removeOnReadyStateComplete",()=>{I.dispatch(Object(h.G)(this.contextToken,this.pageId,e,this.getName()))},[{name:"handler",value:e,isRequired:!0}])}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let O;class T extends _{constructor(e,t,r,n,i,a){super(e,t,r,n,i,a),O=e}getInitialUrl(){const e="ClientApi.XrmControlIFrame.getInitialUrl";try{l.a.instance.reportCall(e);const t=Object(o.sb)(O.getState(),{controlName:this.name,id:this.pageId},this.contextToken);return l.a.instance.reportSuccess(e),t}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,r),t}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlIFrame.getControlType"),"iframe"}getSrc(){const e="ClientApi.XrmControlIFrame.getSrc";try{l.a.instance.reportCall(e);const t=O.getState(),r=this.getInitialUrl(),n=Object(S.c)(t,this.pageId,this.name,this.contextToken,r);return l.a.instance.reportSuccess(e),n}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,r),t}}}var j=r("bGh0"),P=r("/5se"),E=r("xorU"),x=r("fREn"),A=r("hA8P"),w=r("SAYH"),F=r("/q65");let N;class k extends j.a{constructor(e,t,r,n,i,a){super(e,t,r,n,i,a),N=e,this._clientApiExecutorLookup=new f.a(e,"ClientApi.XrmControlLookup.",r,t,[{name:"controlName",value:i,isEventParam:!0}])}addCustomView(e,t,r,n,i,a){this._clientApiExecutorLookup.execute("addCustomView",(o,s)=>{const c=w.a.tryParseOrNull(e);c||Object(g.k)(o,"guid","viewId",s),N.dispatch(Object(x.a)(this.pageId,this.name,c,t,this.contextToken,r,n,i)),a&&this.setDefaultView(e)},[{name:"viewId",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"guid"},{name:"entityLogicalName",value:t,isRequired:!0,isEventParam:!0},{name:"viewDisplayName",value:r,isRequired:!0},{name:"fetchXml",value:n,isRequired:!0},{name:"layoutXml",value:i,isRequired:!0},{name:"isDefault",value:a,isRequired:!0}])}addCustomFilter(e,t){const r="ClientApi.XrmControlLookup.addCustomFilter";Object(g.a)(e)&&Object(g.j)(r,"fetchXmlFilter"),Object(g.b)(e)||Object(g.l)(r);try{l.a.instance.reportCall(r),N.dispatch(Object(E.d)(this.pageId,this.name,t,this.contextToken,e)),this.controlStateObservable.notifyObservers(this.controlDescriptor),l.a.instance.reportSuccess(r)}catch(e){const t=c.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(r,e,null,t),e}}get disableMru(){const e="ClientApi.XrmControlLookup.getDisableMru";try{l.a.instance.reportCall(e);const t=Object(o.x)(N.getState(),{id:this.pageId,controlName:this.name},this.contextToken);return l.a.instance.reportSuccess(e),t}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,r),t}}set disableMru(e){const t="ClientApi.XrmControlLookup.setDisableMru";try{l.a.instance.reportCall(t),N.dispatch(Object(A.b)(N.getState(),this.pageId,this.name,this.contextToken,e)),l.a.instance.reportSuccess(t)}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,r),e}}startCustomFilter(){const e="ClientApi.XrmControlLookup.startCustomFilter";try{l.a.instance.reportCall(e),N.dispatch(Object(E.f)(this.pageId,this.name,this.contextToken)),this.controlStateObservable.notifyObservers(this.controlDescriptor),l.a.instance.reportSuccess(e)}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,r),t}}endCustomFilter(){const e="ClientApi.XrmControlLookup.endCustomFilter";try{l.a.instance.reportCall(e),N.dispatch(Object(E.e)(this.pageId,this.name,this.contextToken)),this.controlStateObservable.notifyObservers(this.controlDescriptor),l.a.instance.reportSuccess(e)}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,r),t}}getDefaultView(){return this._clientApiExecutorLookup.execute("getDefaultView",()=>{const e=Object(o.O)(N.getState(),this.pageId,this.name,this.contextToken);return e?w.a.externalGuid(new w.a(e)):null})}setDefaultView(e){this._clientApiExecutorLookup.execute("setDefaultView",(t,r)=>{const n=w.a.tryParseOrNull(e);n||Object(g.k)(t,"guid","id",r),N.dispatch(Object(P.b)(this.pageId,this.name,this.contextToken,n))},[{name:"defaultViewId",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"guid"}])}addOnLookupTagClick(e){const t="ClientApi.XrmControlLookup.addOnLookupTagClick";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),N.dispatch(Object(h.g)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,r),e}}addPreSearch(e){const t="ClientApi.XrmControlLookup.addPreSearch";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),N.dispatch(Object(h.t)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,r),e}}removeOnLookupTagClick(e){const t="ClientApi.XrmControlLookup.removeOnLookupTagClick";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),N.dispatch(Object(h.B)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,r),e}}removePreSearch(e){const t="ClientApi.XrmControlLookup.removePreSearch";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),N.dispatch(Object(h.O)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,r),e}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlLookup.getControlType"),"lookup"}getEntityTypes(){const e="ClientApi.XrmControlLookup.getEntityTypes";try{l.a.instance.reportCall(e);const t=Object(o.Ob)(N.getState(),this.pageId,this.contextToken,this._dataFieldName);return l.a.instance.reportSuccess(e),t}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,r),t}}setEntityTypes(e){const t="ClientApi.XrmControlLookup.setEntityTypes";e||Object(g.j)(t,"entityTypes");const r=[];try{l.a.instance.reportCall(t),e=Array.from(new Set(e));const n=Object(o.Pb)(N.getState(),this.pageId,this.contextToken,this._dataFieldName),i={};n.forEach(e=>{i[e]=!0}),e.forEach(e=>{i[e]||r.push(e)})}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t+".validation",e,null,r),e}r.length>0&&Object(g.h)(t,"entityType",r[0]);try{N.dispatch(Object(F.b)(this.pageId,this.contextToken,this._dataFieldName,e)),l.a.instance.reportSuccess(t)}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,r),e}}get _dataFieldName(){return this.controlDescriptor&&this.controlDescriptor.DataFieldName?this.controlDescriptor.DataFieldName:this.name}}var D=r("91Ew"),M=r("KnyI"),R=r("tvJg");let L;class V extends j.a{constructor(e,t,r,n,i,a){super(e,t,r,n,i,a),L=e;const o=[{name:"controlName",value:i,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];this._clientApiExecutorOptionsetBase=new f.a(e,"ClientApi.XrmControlOptionSetBase.",r,t,o)}addOption(e,t){this._clientApiExecutorOptionsetBase.execute("addOption",()=>{const r=this._options.length;Object(g.a)(t)||isNaN(t)||t>=r?t=r:t<=0?t=0:t-=1,L.dispatch(Object(D.b)(this.pageId,this.contextToken,this.controlDescriptor.DataFieldName,{Color:null,Label:e.text,Value:e.value},t))},[{name:"optionSetItem",value:e,isRequired:!0},{name:"optionSetItem.value",value:null==e?void 0:e.value,isRequired:!0,expectedDataType:"number"}])}clearOptions(){this._clientApiExecutorOptionsetBase.execute("clearOptions",()=>{L.dispatch(Object(R.b)(this.pageId,this.contextToken,this.controlDescriptor.DataFieldName))})}removeOption(e){return this._clientApiExecutorOptionsetBase.execute("removeOption",()=>{L.dispatch(Object(M.b)(this.pageId,this.contextToken,this.controlDescriptor.DataFieldName,e))},[{name:"value",value:e,isRequired:!0}])}getOptions(){return this._clientApiExecutorOptionsetBase.execute("getOptions",()=>this._options)}get _options(){const e=new Array,t=Object(o.B)(L.getState(),this.pageId,this.contextToken,this.name);if(t){t.length&&e.push({text:"",value:NaN});for(const r in t)e.push({text:t[r].Label,value:t[r].Value})}return e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class B extends V{getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlOptionSet.getControlType"),"optionset"}}var G=r("cf3Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let X;class U extends j.a{constructor(e,t,r,n,i,a){super(e,t,r,n,i,a),this._isDateFormatDateTime=!1,X=e,this._clientApiExecutorDateTime=new f.a(e,"ClientApi.XrmControlDateTime.",r,t,[{name:"controlName",value:i,isEventParam:!0}]),this._clientApiExecutorDateTime.execute("constructor",(e,t)=>{this._isDateFormatDateTime=this._getShowTime(e,t)},null,!1)}getShowTime(){return this._clientApiExecutorDateTime.execute("getShowTime",(e,t)=>this._getShowTime(e,t))}setShowTime(e){this._clientApiExecutorDateTime.execute("setShowTime",(t,r)=>{if(this._getShowTime(t,r)!==e){const t=e&&this._isDateFormatDateTime?"datetime":"date";X.dispatch(Object(G.b)(this.pageId,this.contextToken,this.name,t))}})}_getShowTime(e,t){const r=this.getAttrDescriptor(e,t,this._clientApiExecutorDateTime);return!r||"datetime"===r.Format}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class z extends V{getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlMultiSelectOptionSet.getControlType"),"multiselectoptionset"}}var H=r("455M"),q=r("zgeC"),W=r("dHD5"),Y=r("HAeo"),Q=r("ghNp"),K=r("P6DH");let J;class Z extends a.a{constructor(e,t,r,n,i){super(e,t,r,n,n.Name,i);const a=Object(W.e)(t,n.Name);e.dispatch(Object(Q.a)(this,r,a)),J=e,this._clientApiExecutorControlstream=new f.a(e,"ClientApi.XrmControlStream.",r,t)}get clientApiExecutor(){return this._clientApiExecutorControlstream}_getGridControls(){if(!this._underlyingGridControls){this._underlyingGridControls=[];const e=this.controlDescriptor.Parameters&&this.controlDescriptor.Parameters[0]&&this.controlDescriptor.Parameters[0].StreamObjects;if(e){const t=e.StreamObjectCollection;if(t){const e=t.ShowAsTiles?[!0,!1]:[!0];for(const r of t)for(const t of e){const e=Object(W.o)(this.contextToken,this.getName(),r.Id,t),n=new Y.a(J,e,this.pageId,!1,3,!0,this.formContext.applicationContext,e.controlName);this._underlyingGridControls.push({contextToken:e,gridControl:n})}}}}return this._underlyingGridControls}refresh(){this.clientApiExecutor.execute("refresh",()=>{const e=[];for(const{contextToken:t,gridControl:r}of this._getGridControls()){if(Object(K.hb)(J.getState(),this.pageId,t,t.controlName))try{r.refresh()}catch(t){e.push(t)}}if(e.length>0){const t=[...c.a.getInstance().getEventParameters(this.contextToken),{name:"count",value:e.length}];Object(g.e)(this.clientApiExecutor.getComponentName("refresh"),"Some grids in stream failed to refresh",null,t)}})}}var $=r("odYE"),ee=r("6QGX"),te=r("tpZ5"),re=r("E7fB"),ne=r("jq7Z"),ie=r("zsAz"),ae=r("IaGr");let oe;class se extends a.a{constructor(e,t,r,n,i,a){super(e,t,r,n,n.Name,i),oe=e,this._clientApiExecutor=new f.a(e,"ClientApi.XrmControlSubFormBase.",r,t,[{name:"controlName",value:null==n?void 0:n.Name,isEventParam:!0}]),this._xrmControlFactory=a}getParentComponent(){return Object(ne.a)(oe.getState(),this.pageId)}get context(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.context",()=>this._form?this._form.context:null)}get _parentFormContext(){return this.formContext}get _form(){if(this._tryGetSubFormInstanceId(),!this._isSubFormMetadataLoaded())throw Object(ie.d)("SUBFORM_METADATA_NOT_LOADED",2415919107);const e=this._subFormControlContextToken;if(e&&this._formInstance)return this._formInstance;const t=this._getValueInternal(),r=Object(ee.d)(t);if(e)return this._formInstance=oe.dispatch(Object(Q.b)(this._subFormInstanceId,e)),this._formInstance||r&&r.length>0&&(this._formInstance=oe.dispatch(this._createXrmForm(e,this._subFormInstanceId,r[0].entityType,new w.a(r[0].id)))),this._formInstance&&!this._formInstance.context&&(this._formInstance.context=this._parentFormContext.context),this._formInstance;return c.a.getInstance().getEventParameters(this.contextToken).push({name:"controlName",value:this.getName()}),ae.a.getInstance().traceManager.getTracer("ClientApi.XrmControlSubFormBase._form").info("XrmControlSubForm._form is null"),null}_createXrmForm(e,t,r,n){const i=this._xrmControlFactory;return{type:"clientapi.create.xrmform",sync:!0,execute(a,o){const s=new te.a(a,{etn:r,id:n},i,e,t);s.applicationContext=o;const c=new re.a(a,t);return s.context=c,s}}}get _subFormControlContextToken(){const e=this._getValueInternal(),t=Object(ee.d)(e);return t&&t[0]&&t[0].id?this._entityRecordId!==t[0].id&&(this._entityType=t[0].entityType,this._entityRecordId=t[0].id,this._subFormContextToken&&oe.dispatch(Object(Q.h)(this._subFormInstanceId,this._subFormContextToken)),this._subFormContextToken=this._getSubFormContextToken(this.contextToken,this.name,this._entityType),this._formInstance=null):this._subFormContextToken&&(oe.dispatch(Object(Q.h)(this._subFormInstanceId,this._subFormContextToken)),this._subFormContextToken=void 0,this._entityType=void 0,this._entityRecordId=void 0,this._formInstance=null),this._subFormContextToken}get data(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.data",()=>this._form?this._form.data:null)}get ui(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.ui",()=>this._form?this._form.ui:null)}get entityReference(){return l.a.instance.reportUsage("ClientApi.XrmControlSubFormBase.entityReference"),null}getControl(e){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getControl",()=>this._form?this._form.getControl(e):null)}getAttribute(e){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getAttribute",()=>this._form?this._form.getAttribute(e):null)}getUrl(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getUrl",()=>this._form?this._form.getUrl():null)}refresh(){this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.refresh",()=>{this.data&&this.data.refresh()})}_getValueInternal(){const e=this._parentFormContext.data.entity.getEntityName(),t=this._parentFormContext.data.entity.getId(),r=t?new $.a(e,new w.a(t)):new $.a(e),n=Object(o.ac)(oe.getState(),this._subFormInstanceId,this.contextToken);return Object(o.X)(oe.getState(),this._subFormInstanceId,this._subFormContextToken,n,r,this.controlDescriptor.DataFieldName)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let ce;class le extends se{constructor(e,t,r,n,i,a){super(e,t,r,n,i,a),ce=e}_getSubFormContextToken(e,t,r){return Object(W.l)(this.contextToken,this.name,this._entityType)}getSubFormInstanceId(){return this.pageId}_isSubFormMetadataLoaded(){return!!this._subFormInstanceId}_tryGetSubFormInstanceId(){}get _subFormInstanceId(){return this.pageId}isLoaded(){const e="ClientApi.XrmControlQuickForm.isLoaded";try{l.a.instance.reportCall(e);const t=Object(o.ic)(ce.getState(),this.getSubFormInstanceId(),this._subFormControlContextToken);return l.a.instance.reportSuccess(e),!!t}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,r),t}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlQuickForm.getControlType"),"quickform"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let ue;class de extends j.a{constructor(e,t,r,n,i,a){e||Object(g.j)("ClientApi.XrmStandardDataControl.constructor","store"),super(e,t,r,n,i,a),ue=e}getValue(){const e="ClientApi.XrmStandardDataControl.getValue";try{l.a.instance.reportCall(e);const t=Object(o.F)(ue.getState(),{controlName:this.name,id:this.pageId},this.contextToken);return l.a.instance.reportSuccess(e),t}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(e,t,null,r),t}}addOnKeyPress(e){const t="ClientApi.XrmStandardDataControl.addOnKeyPress";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),ue.dispatch(Object(h.e)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(t,e,null,r),e}}removeOnKeyPress(e){const t="ClientApi.XrmStandardDataControl.removeOnKeyPress";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),ue.dispatch(Object(h.z)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(t,e,null,r),e}}fireOnKeyPress(){const e="ClientApi.XrmStandardDataControl.fireOnKeyPress";try{l.a.instance.reportCall(e),ue.dispatch(Object(h.R)(this.contextToken,this.pageId,this.name,this)),l.a.instance.reportSuccess(e)}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(e,t,null,r),t}}}var pe=r("ywwS"),he=r("VqBP"),ge=r("w92Z");class me extends B{constructor(e,t,r,n,i,a){super(e,t,r,n,i,a),this._clientApiExecutorDependentOptionSet=new f.a(e,"ClientApi.XrmControlDependentOptionSet.",r,t,[{name:"controlName",value:i,isEventParam:!0}])}addOption(e,t){return this._clientApiExecutorDependentOptionSet.execute("addOption",(e,t)=>{Object(g.i)(e,"DependentOptionSet.addOption",t)})}clearOptions(){return this._clientApiExecutorDependentOptionSet.execute("clearOptions",(e,t)=>{Object(g.i)(e,"DependentOptionSet.clearOptions",t)})}removeOption(e){return this._clientApiExecutorDependentOptionSet.execute("removeOption",(e,t)=>{Object(g.i)(e,"DependentOptionSet.removeOption",t)})}setDisabled(e){return this._clientApiExecutorDependentOptionSet.execute("setDisabled",(e,t)=>{Object(g.i)(e,"DependentOptionSet.setDisabled",t)})}setVisible(e){return this._clientApiExecutorDependentOptionSet.execute("setVisible",(e,t)=>{Object(g.i)(e,"DependentOptionSet.setVisible",t)})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class be extends z{constructor(e,t,r,n,i,a){super(e,t,r,n,i,a),this._clientApiExecutorDependentOptionSet=new f.a(e,"ClientApi.XrmControlMultiSelectDependentOptionSet.",r,t,[{name:"controlName",value:i,isEventParam:!0}])}addOption(e,t){return this._clientApiExecutorDependentOptionSet.execute("addOption",(e,t)=>{Object(g.i)(e,"MultiSelectDependentOptionSet.addOption",t)})}clearOptions(){return this._clientApiExecutorDependentOptionSet.execute("clearOptions",(e,t)=>{Object(g.i)(e,"MultiSelectDependentOptionSet.clearOptions",t)})}removeOption(e){return this._clientApiExecutorDependentOptionSet.execute("removeOption",(e,t)=>{Object(g.i)(e,"MultiSelectDependentOptionSet.removeOption",t)})}setDisabled(e){return this._clientApiExecutorDependentOptionSet.execute("setDisabled",(e,t)=>{Object(g.i)(e,"MultiSelectDependentOptionSet.setDisabled",t)})}setVisible(e){return this._clientApiExecutorDependentOptionSet.execute("setVisible",(e,t)=>{Object(g.i)(e,"MultiSelectDependentOptionSet.setVisible",t)})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ye extends de{setDisabled(e){const t="ClientApi.XrmDependentOptionSetGridControl.setDisabled";l.a.instance.reportUsage(t),Object(g.e)(t,String.format("Can not execute {0} for dependent option set control","setDisabled"))}}var fe=r("LbMF"),ve=r("3/02"),Ce=r("Lyxw"),Se=r("Z/4N"),Ie=r("BoVI");let _e;class Oe extends se{constructor(e,t,r,n,i,a){var o,s;super(e,t,r,n,i,a),this._formInstanceId=null===(s=null===(o=this.getParentComponent())||void 0===o?void 0:o.formInstances)||void 0===s?void 0:s.formInstanceIdByControlName[this.controlDescriptor.Name],this._formComponentClientApiExecutor=new f.a(e,"ClientApi.XrmControlFormComponent.",this._formInstanceId),this._formComponentClientApiExecutor.addEventParameter({name:"controlName",value:n.Name,isEventParam:!0}),_e=e}_tryGetSubFormInstanceId(){var e,t;this._formInstanceId||(this._formInstanceId=null===(t=null===(e=this.getParentComponent())||void 0===e?void 0:e.formInstances)||void 0===t?void 0:t.formInstanceIdByControlName[this.controlDescriptor.Name])}_isSubFormMetadataLoaded(){return!!this._subFormInstanceId}_getSubFormContextToken(e,t,r){return Object(W.h)(r)}get _subFormInstanceId(){return this._formInstanceId}isLoaded(){return this._isSubFormMetadataLoaded()&&this._formComponentClientApiExecutor.execute("ClientApi.XrmControlFormComponent.isLoaded",()=>!!Object(o.yc)(_e.getState(),this._subFormInstanceId,this._subFormControlContextToken))}setInitializationIntent(e="fullload"){this._formComponentClientApiExecutor.execute("setInitializationIntent",t=>{"nothing"!==e&&"fullload"!==e&&Object(g.h)(t,e,"intent"),_e.dispatch(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,r,n){const i=Object(W.v)(r);return{type:Ie.d,payload:n,meta:{pageId:e,controlName:t,contextKey:i}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(this.pageId,this.name,this.contextToken,e))},[{name:"intent",value:e,isEventParam:!0,expectedDataType:"string"}])}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlFormComponent.getControlType"),"formcomponent"}}var Te=r("CYtR");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const je="3d180de6-b456-4d90-9d5a-9899936baf44";let Pe;class Ee{constructor(e,t){this._pageId=t,Pe=e}createXrmControl(e,t,r,o,s){Object(g.g)(t,o,"control");try{s.push({name:"controlClassId",value:t&&t.ClassId?t.ClassId.guid:""}),s.push({name:"controlName",value:t?t.Name:""}),s.push({name:"controlDataFieldName",value:t?t.DataFieldName:""}),s.push({name:"pageId",value:this._pageId});const l=Object(i.l)(Pe.getState(),this._pageId);s.push({name:"pageType",value:l});let u=!1,h=null,g=!1;const m=this._getControlType(t,r,e,o,s);switch(m){case n.i.guid:h=new y(Pe,e,this._pageId,t,t.Name,r);break;case H.a.KbContent:case H.a.KbArticle:case n.C.guid:case n.I.guid:h=new T(Pe,e,this._pageId,t,t.Name,r);break;case H.a.LookupRegarding:case H.a.LookupCustomer:case H.a.LookupMultiEntity:case H.a.LookupOwner:case H.a.LookupSimple:case H.a.LookupPartyList:case n.M.guid:case n.fb.guid:case n.S.guid:case n.l.guid:if(Object(Ce.c)(Pe.getState(),ve.jb)){const n=Object(ne.b)(Pe.getState(),this._pageId,e);if(Object(Se.c)(Pe.getState(),t.UniqueId,n)===Te.d){h=new Oe(Pe,e,this._pageId,t,r,this);break}}h=new k(Pe,e,this._pageId,t,t.Name,r);break;case H.a.OptionSet:case n.U.guid:if(g=Object(Ce.c)(Pe.getState(),ve.L),1==g){const n=this._getEntityNameForControl(t,r);if(Object(fe.l)(Pe.getState(),n,t.DataFieldName)){h=new me(Pe,e,this._pageId,t,t.Name,r);break}}case H.a.EntityNameOptionSet:case H.a.TwoOptions:case H.a.StatusOptionSet:case n.sb.guid:case n.K.guid:case n.W.guid:case n.V.guid:case n.hb.guid:case n.n.guid:case n.N.guid:h=new B(Pe,e,this._pageId,t,t.Name,r);break;case H.a.MultiSelectPicklist:case n.Q.guid:if(g=Object(Ce.c)(Pe.getState(),ve.L),g){const n=this._getEntityNameForControl(t,r);if(Object(fe.l)(Pe.getState(),n,t.DataFieldName)){h=new be(Pe,e,this._pageId,t,t.Name,r);break}}h=new z(Pe,e,this._pageId,t,t.Name,r);break;case H.a.QuickForm:case n.cb.guid:case n.ab.guid:case n.Z.guid:const i=new le(Pe,e,this._pageId,t,r,this);r.ui.quickForms.add(t.Name,i);break;case H.a.SearchWidget:case H.a.ReferencePanelSearchWidget:case n.db.guid:case n.kb.guid:h=new p.a(Pe,e,this._pageId,t,t.Name,r);break;case H.a.TimelineWall:case n.qb.guid:h=Pe.dispatch(Object(Q.f)(this._pageId,Object(W.p)(e,t.Name))),h||(h=new pe.a(Pe,e,this._pageId,t,t.Name,t.LabelId,r,r.applicationContext));break;case H.a.DateAndTimeDateOnly:case H.a.DateAndTimeDateAndTime:case n.q.guid:h=new U(Pe,e,this._pageId,t,t.Name,r);break;case H.a.Grid:case n.eb.guid:case n.E.guid:const l=Object(W.p)(e,t.Name),b=Pe.dispatch(Object(Q.c)(this._pageId,l));b&&(b.getName||3!==b.getGridType()?h=b:(c.a.getInstance().reportFailure(o,new Error("Main grid found in cache - converting to a subgrid."),null,s),Pe.dispatch(Object(Q.h)(this._pageId,l)))),h||(h=new q.a(Pe,e,this._pageId,t.Name,Object(K.wb)(Pe.getState(),this._pageId,e,t.Name),r,t,r.applicationContext));break;case H.a.Timer:case n.rb.guid:h=new d(Pe,e,this._pageId,t,t.Name,r);break;case H.a.WebResourceHtmlControl:case n.ub.guid:case n.vb.guid:h=new _(Pe,e,this._pageId,t,t.Name,r);break;case n.mb.guid:h=new Z(Pe,e,this._pageId,t,r);break;case n.z.guid:case n.G.guid:break;case je:if(g=Object(Ce.c)(Pe.getState(),ve.L),g&&Object(fe.l)(Pe.getState(),e.entityTypeName,t.Name)){h=new ye(Pe,e,this._pageId,t,t.Name,r);break}case H.a.AppliedFilters:case H.a.BusinessProcessFlow:case H.a.Card:case H.a.Currency:case H.a.Dashboard:case H.a.Decimal:case H.a.EmailEngagementActions:case H.a.EmailEngagementRecipientActivity:case H.a.FP:case H.a.GlobalFilter:case H.a.MicrosoftFlow:case H.a.Multiple:case H.a.PowerBI:case H.a.ReferencePanel:case H.a.Search:case H.a.SingleLineAddress:case H.a.SingleLineEmail:case H.a.SingleLinePhone:case H.a.SingleLineText:case H.a.SingleLineTextArea:case H.a.SingleLineTickerSymbol:case H.a.SingleLineURL:case H.a.SocialInsightsControl:case H.a.WholeDuration:case H.a.WholeLanguage:case H.a.WholeNone:case H.a.WholeTimeZone:case n.a.guid:case n.b.guid:case n.c.guid:case n.d.guid:case n.e.guid:case n.f.guid:case n.g.guid:case n.h.guid:case n.j.guid:case n.k.guid:case n.m.guid:case n.p.guid:case n.r.guid:case n.s.guid:case n.t.guid:case n.u.guid:case n.v.guid:case n.w.guid:case n.x.guid:case n.y.guid:case n.A.guid:case n.B.guid:case n.D.guid:case n.H.guid:case n.J.guid:case n.L.guid:case n.O.guid:case n.P.guid:case n.R.guid:case n.T.guid:case n.X.guid:case n.Y.guid:case n.bb.guid:case n.gb.guid:case n.ib.guid:case n.jb.guid:case n.lb.guid:case n.mb.guid:case n.nb.guid:case n.ob.guid:case n.pb.guid:case n.tb.guid:case n.wb.guid:u=!0;default:h=t.DataFieldName?new de(Pe,e,this._pageId,t,t.Name,r):new a.a(Pe,e,this._pageId,t,t.Name,r),u||(s.push({name:"controlType",value:m}),ae.a.getInstance().traceManager.getTracer(o).error("Unknown Form Control",s))}return h}catch(e){return c.a.getInstance().reportFailure(o+".createXrmControl",e,null,s),null}}_getControlType(e,t,r,i,a){if(w.a.equals(e.ClassId,n.o)){const n=this._getCustomControlType(e,t,r);return n||ae.a.getInstance().traceManager.getTracer(i+".controlPrimaryType").error("Control primary type could not be determined",a),a.push({name:"manifestControlType",value:n}),n}return e.ClassId.guid}_getCustomControlType(e,t,r){var n,i,a;const s=Object(ne.b)(Pe.getState(),this._pageId,r);let c=Object(he.c)(Pe.getState(),e,s);if(!c){const l=Object(o.h)(),u=(null===(i=null===(n=t.data)||void 0===n?void 0:n.entity)||void 0===i?void 0:i.getEntityName())||"";let d=l(Pe.getState(),e,this._pageId,s,u);if(d||(d=Object(ge.a)(Pe.getState(),e,this._pageId,r)),null==d?void 0:d.Parameters)for(const e in d.Parameters)if(null===(a=d.Parameters[e])||void 0===a?void 0:a.Primary){c=d.Parameters[e].Type;break}}return c}_getEntityNameForControl(e,t){let r="";if(e.Relationship)r=Object(o.T)(Pe.getState(),this._pageId,e.Relationship);else{const n=t.getAttribute(e.DataFieldName);n&&n.getParent()&&(r=n.getParent().getEntityName())}return r}}},AE7n:function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n=r("YYhu"),i=r("iZ7K"),a=r("vNXc"),o=r("q/4y"),s=r("GxhD"),c=r("hQd/"),l=r("SAYH"),u=r("i1f0"),d=r("dHD5"),p=r("arV0"),h=r("P6DH"),g=r("fILV"),m=r("aF0N"),b=r("P+kM"),y=r("3/02"),f=r("Lyxw"),v=r("HfZT"),C=r("E8F2");function S(e,t,r,S,I,_,O=!1,T){return{type:"embeddedEntity.save",execute(S,j){const P=S.getState(),E=new l.a(r),x=Object(d.f)(T,E,t);let A;switch(Object(p.l)(P,e)){case g.a:A=Object(h.R)(P,e,x);break;default:A=Object(u.ac)(P,e,x)}const w=Object(m.c)(P),F=Object(m.b)(P);if((w||F)&&"Dashboard"!==Object(p.l)(P,e)){const t=j.ScriptManager.getContainer(e).getEventManager();if(S.dispatch(t.runOnSave(T,1,null,r)))return Promise.reject(Object(C.b)(P,e,2200000005,""))}return S.dispatch(Object(n.c)(A,O,I)).then(n=>{const u=Object(h.qb)(P,new l.a(_),e),d=Object(i.h)(P,t),p=a.a.fromXmlAndSql(u.fetchXML,u.offlineSqlQuery,u.viewId,null,u.entityLogicalName,S.getState);return p.where(new o.a("eq",new s.a(t,d.PrimaryIdAttribute),new c.a(r))),S.dispatch(Object(v.d)(p.getQueryState())).then(()=>n)}).catch(e=>(Object(f.a)(P,y.xb)&&A&&S.dispatch(Object(b.b)(A,!1)),Promise.reject(e)))}}}},ATZz:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r("SAYH"),i=r("y60j");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a=new n.a("8c54228c-1b25-4909-a12a-f2b968bb0d62");function o(e,t){const r=Object(i.d)(e,t,null);if(!r||1!==Object.keys(r).length)return null;const o=r[Object.keys(r)[0]];return o&&n.a.equals(o.ClassId,a)?o.Parameters:null}function s(e,t){const r=o(e,t),n=null==r?void 0:r.Type;return n&&-1!==["1","2"].indexOf(n)}},AbXy:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r("P6DH"),i=r("Sbn7"),a=r("9i5P"),o=r("16wZ"),s=r("dHD5"),c=r("SAYH"),l=r("5Oca"),u=r("odYE"),d=r("WPtp"),p=r("qshH"),h=r("1kth"),g=r("ZIjf"),m=r("Uv1Y"),b=r("IaGr");let y;class f{constructor(e,t,r,n,i,a,s){const c="ClientApi.XrmControlGrid.constructor";if(n||Object(o.j)(c,"pageId"),r||Object(o.j)(c,"contextToken"),e||Object(o.j)(c,"store"),i||Object(o.j)(c,"gridEntity"),Object(o.a)(a)&&Object(o.j)(c,"isEditable"),y=e,this._applicationContext=t,this._contextToken=r,this._pageId=n,this._gridEntityName=i,this.controlName=s,this._isEditable=a,!this._contextToken.contextTokenType){const e=p.a.getInstance().getEventParameters(this._contextToken);e.push({name:"controlName",value:this.controlName}),e.push({name:"gridEntityName",value:this._gridEntityName}),p.a.getInstance().reportFailure(c,new m.a("context token passed to grids with empty context token type"),null,e)}}get _isEditable(){const e=Object(n.V)(y.getState(),this._pageId,this._gridEntityName,this._contextToken,this.controlName);if(null===e){const e="ClientApi.XrmControlGrid._isEditable_get",t=p.a.getInstance().getEventParameters(this._contextToken);return t.push({name:"controlName",value:this.controlName}),t.push({name:"gridEntityName",value:this._gridEntityName}),b.a.getInstance().eventManager.ReportComponentFailure(e,new m.a("control configuration parameters not found"),null,t),this._isGridEditable}return e}set _isEditable(e){this._isGridEditable=e}get applicationContext(){return g.a.instance.reportUsage("ClientApi.XrmControlGrid.applicationContext_get"),this._applicationContext}set applicationContext(e){g.a.instance.reportUsage("ClientApi.XrmControlGrid.applicationContext_set")}getTotalRecordCount(){const e="ClientApi.XrmControlGrid.getTotalRecordCount";try{g.a.instance.reportCall(e);const t=Object(n.Y)(y.getState(),this._pageId,this._contextToken);if(t){const r=JSON.parse(t),n=r&&r.totalResultCount?r.totalResultCount:0;return g.a.instance.reportSuccess(e),n}return g.a.instance.reportSuccess(e),0}catch(t){const r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),p.a.getInstance().reportFailure(e,t,null,r),t}}getRows(){const e="ClientApi.XrmControlGrid.getRows";try{g.a.instance.reportCall(e);const t=new i.a(e),r=y.getState(),o=Object(n.H)(r,this.contextToken,{id:this.pageId});if(o)for(let e=0;e<o.length;e++){const r=o[e].identifier.id,n=this._getRowEntityName(o[e],r),i=new a.a(y,this._applicationContext,Object(s.f)(this.contextToken,r,n),this.pageId,n,r),c=o[e].identifier.id.guid;t.add(c,i)}return g.a.instance.reportSuccess(e),t}catch(t){const r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),p.a.getInstance().reportFailure(e,t,null,r),t}}getSelectedRows(){const e="ClientApi.XrmControlGrid.getSelectedRows";try{g.a.instance.reportCall(e);const t=new i.a(e),r=Object(n.fb)(y.getState(),this.pageId,this.contextToken);if(r){const e=Object(n.Q)(y.getState(),this.pageId,this.contextToken);for(let i=0;i<r.length;i++){let o;if(e)o=e;else{const e=y.getState(),t=Object(n.v)(e,this.pageId,this.contextToken),a=(t&&t.queryKey&&Object(l.q)(e,t.queryKey,null,null,!0)||[]).find(e=>e.identifier&&c.a.equals(e.identifier.id,r[i]));o=this._getRowEntityName(a,r[i])}const u=new a.a(y,this._applicationContext,Object(s.f)(this.contextToken,r[i],o),this.pageId,o,r[i]),d=r[i].guid;t.add(d,u)}}return g.a.instance.reportSuccess(e),t}catch(t){const r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),p.a.getInstance().reportFailure(e,t,null,r),t}}addOnRecordSelect(e){const t="ClientApi.XrmControlGrid.addOnRecordSelect";if(this._isEditable){e||Object(o.j)(t,"handler");try{g.a.instance.reportCall(t),y.dispatch(Object(h.m)(this.contextToken,this.pageId,e,this.controlName)),g.a.instance.reportSuccess(t)}catch(e){const r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),p.a.getInstance().reportFailure(t,e,null,r),e}}}removeOnRecordSelect(e){const t="ClientApi.XrmControlGrid.removeOnRecordSelect";if(this._isEditable){e||Object(o.j)(t,"handler");try{g.a.instance.reportCall(t),y.dispatch(Object(h.H)(this.contextToken,this.pageId,e,this.controlName)),g.a.instance.reportSuccess(t)}catch(e){const r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),p.a.getInstance().reportFailure(t,e,null,r),e}}}runOnRecordSelect(e){const t="ClientApi.XrmControlGrid.runOnRecordSelect";try{g.a.instance.reportCall(t),this._isEditable&&y.dispatch(Object(h.T)(this.contextToken,this.pageId,e,this.controlName)),g.a.instance.reportSuccess(t)}catch(e){const r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),p.a.getInstance().reportFailure(t,e,null,r),e}}_getRowEntityName(e,t){const r=e&&e.identifier?e.identifier.etn:this._gridEntityName;if("activitypointer"===r){const e="activitytypecode",r=Object(l.j)(y.getState(),new u.a(this._gridEntityName,t),e);if(Object(d.j)(r))return r.value}return r}get pageId(){return this._pageId}get contextToken(){return this._contextToken}}},B9jE:function(e,t,r){"use strict";r.d(t,"a",(function(){return x}));var n=r("P6DH"),i=r("Utin");var a=r("Uv1Y"),o=r("SAYH"),s=r("eXjw"),c=r("a72m"),l=r("KBcj"),u=r("d0w6"),d=r("dQnL"),p=r("WK+4"),h=r("CngE"),g=r("iZ7K"),m=r("69Qu"),b=r("BzGi"),y=r("BFlg"),f=r("s+OO"),v=r("7k+e");var C=r("LAGg"),S=r("RrRu"),I=r("jRHm"),_=r("uCpV"),O=r("X37l"),T=r("ujVH"),j=r("3/02"),P=r("Lyxw"),E=r("VcAV");function x(e,t,r,x,w,F){return{type:"grid.refresh.async",execute({dispatch:N,getState:k},D){const M=D.TraceManager.getTracer(y.z),R=y.x+".refreshGridAction";try{const L=k(),V=o.a.tryParseOrNull(x);if(V){const B=F||(r?u.a.SUB_GRID:u.a.MAIN_APPLICATION_VIEW);return function(e,t,r,i,d,p,h,g){const b=Object(n.qb)(t,g,r);if(b&&b.initialized===s.a.Initialized&&(Object(m.b)(t)||!Object(E.b)(b.offlineSqlQuery)))return Promise.resolve(g);const y=p||Object(n.F)(t,r,i,d),f=Object(l.f)(t,y,h),v=Object(l.f)(t,y,u.a.MAIN_APPLICATION_VIEW);let C=f&&f[o.a.toString(g)]&&f[o.a.toString(g)].isUserView?u.b.userview:u.b.savedview;v&&v[o.a.toString(g)]&&v[o.a.toString(g)].isUserView&&(C=u.b.userview);return e(Object(c.a)(y,h,C,g)).then(e=>{if(!e)throw new a.a("View retrieval failed");return e})}(N,L,e,t,r,w,B,V).then(a=>{M.info("Refreshing the grid with new view id - {0}"+V);const c=Object(n.T)(L,e,t);N(function(e,t,r,n){return Object(i.b)(e,t,"ViewId",r,n)}(e,r,x,t)),function(e,t,r,i,a,c,u,d,p){let h=function(e,t,r,i,a){return e||Object(n.F)(t,r,i,a)}(r,e,a,c,u);const g=Object(n.qb)(e,i,a);if(g&&g.initialized===s.a.Initialized){const r=Object(l.f)(e,h,d),n=r&&r[o.a.toString(i)]&&r[o.a.toString(i)].isUserView;if(h===y.a&&(h=g.entityLogicalName?g.entityLogicalName:h),!g.title){const e=[];e.push({name:"view.title",value:"View title doesn't contains value"}),e.push({name:"ViewId",value:"ViewId: "+i}),e.push({name:"View",value:A(g)}),e.push({name:"entityTypeName",value:h}),p.EventManager.ReportComponentFailure("RefreshGrid",new Error("Title for recent item is null or empty."),"Analyze event parameters to understand why title is empty.",e)}const a={RecordType:O.a.Grid,EntityTypeName:h,LastAccessed:new Date,ObjectId:i,IsUserView:n,Title:g.title};t(Object(_.b)(a))}}(k(),N,w,a,e,t,r,B,D);Object(P.c)(k(),j.L)&&N(Object(T.b)(e,t)),w&&N(function(e,t,r,n){return Object(i.b)(e,t,"TargetEntityType",r,n)}(e,r,w,t)),N(Object(C.b)(e,t)),N(Object(S.b)(e,t,[])),N(Object(I.b)(e,t,null));const E=[];if(w&&E.push({name:"entityName",value:w}),!Object(n.ib)(L,e,t))return D.EventManager.ReportComponentSuccess(R,E),Promise.resolve();N(function(e,t,r,i,a,s){return{type:"chart.refresh.async",execute({dispatch:c,getState:C},S){const I=y.x+".refreshChartAction",_=C();if(!r)return Promise.resolve();if(!Object(m.b)(_))return Promise.resolve();const O=Object(l.c)(_,r);if(!(a=O&&O.entityLogicalName?O.entityLogicalName:null))return Promise.resolve();if(s===u.a.QUICKFIND_SEARCH&&(c(Object(v.c)(e,t,[])),c(Object(f.c)(e,t,"{}"))),!o.a.equals(i,r)){c(Object(v.c)(e,t,[])),c(Object(f.c)(e,t,"{}"));const r=Object(n.r)(_,e,t,a),i=Object(h.a)(_,r),s=i&&i.PrimaryEntityTypeCode,l=s&&Object(g.m)(_,parseInt(s,10));if(l&&a!==l)return c(Object(d.a)(a,b.a.savedvisualization)).then(r=>{let n=o.a.toString(r);return n||(n=o.a.EMPTYGUIDSTRING),c(Object(p.b)(e,t,n)).then(()=>{S.EventManager.ReportComponentSuccess(I)})})}return S.EventManager.ReportComponentSuccess(I),Promise.resolve()}}}(e,t,V,c,w,F)).then(()=>(N(Object(C.b)(e,t)),D.EventManager.ReportComponentSuccess(R,E),Promise.resolve())).catch(e=>(D.EventManager.ReportComponentFailure(R,Error(e)),Promise.resolve()))})}if(Object(n.v)(k(),e,t)){M.info("Refreshing the grid."),N(Object(C.b)(e,t)),N(Object(S.b)(e,t,[])),N(Object(I.b)(e,t,null));const r=[];w&&r.push({name:"entityName",value:w}),D.EventManager.ReportComponentSuccess(R,r)}return Promise.resolve()}catch(e){let t="Refresh action for grid failed";e&&e.message&&(t+="with the error message as : "+e.message),D.EventManager.ReportComponentFailure(R,Error(t))}}}}function A(e){if(!e)return"View is "+e;const t={initialized:e.initialized,viewId:e.viewId,entityLogicalName:e.entityLogicalName,queryApi:e.queryApi,columnXML:e.columnXML,idColumName:e.idColumName,queryType:e.queryType,layoutXML:e.layoutXML,isUserView:e.isUserView,versionNumber:e.versionNumber,OverallVersionNumber:e.OverallVersionNumber,OverallUserVersionNumber:e.OverallUserVersionNumber};return JSON.stringify(t)}},BkgE:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return l}));var n=r("FZDd"),i=r("iZ7K"),a=r("BFlg"),o=r("F7qm"),s=r("LbMF");function c(e){return{type:"grid.retrieveRelatedEntityMetadata.async",execute({dispatch:t,getState:r},a){try{const o=Object(i.h)(r(),e),s={};return u(s,e),Object.keys(o.ManyToManyRelationships).forEach(t=>{const r=o.ManyToManyRelationships[t];if(r.IsValidForAdvancedFind){let t=r.Entity1LogicalName;t===e&&(t=r.Entity2LogicalName),u(s,t)}}),Object.keys(o.OneToManyRelationships).forEach(e=>{const t=o.OneToManyRelationships[e];t.IsValidForAdvancedFind&&u(s,t.ReferencingEntity,t.ReferencingAttribute)}),Object.keys(o.ManyToOneRelationships).forEach(e=>{const t=o.ManyToOneRelationships[e];t.IsValidForAdvancedFind&&(u(s,t.ReferencedEntity),u(s,t.ReferencingEntity,t.ReferencingAttribute))}),t(Object(n.e)(s)).catch(t=>h(e,a,t,"retrieveRelatedEntityMetadata.async","retrieveRelatedEntityMetadata"))}catch(t){return h(e,a,t,"retrieveRelatedEntityMetadata.async","retrieveRelatedEntityMetadata")}}}}function l(e){return{type:"grid.retrieveRelatedEntityRelationshipMetadata.async",execute({getState:t},r){try{let r=[];const n=t(),a=Object(i.h)(n,e),c=[];Object.keys(a.OneToManyRelationships).forEach(e=>{var t,r;const l=a.OneToManyRelationships[e];if(l.IsValidForAdvancedFind){const e=l.ReferencingEntity,a=Object(i.h)(n,e),u=Object(s.a)(n,e,l.ReferencingAttribute);if(a){const e=d(a,1===l.AssociatedMenuConfiguration.Behavior?null!==(t=l.AssociatedMenuConfiguration.Label)&&void 0!==t?t:"":null!==(r=null==u?void 0:u.DisplayName)&&void 0!==r?r:a.DisplayCollectionName),n=p(l,a.DisplayCollectionName,o.RelationshipType.OneToMany);c.push([e,n])}}}),Object.keys(a.ManyToManyRelationships).forEach(e=>{var t,r;const s=a.ManyToManyRelationships[e];if(s.IsValidForAdvancedFind){let e,l,u=!0,p=s.Entity1LogicalName,h=!0;if(p===a.EntityLogicalName?(p=s.Entity2LogicalName,s.IsCustomRelationship&&(u=2!==s.Entity2AssociatedMenuConfiguration.Behavior),l=s.Entity2AssociatedMenuConfiguration.Behavior,e=null!==(t=s.Entity2AssociatedMenuConfiguration.Label)&&void 0!==t?t:"",h=!1):(s.IsCustomRelationship&&(u=2!==s.Entity1AssociatedMenuConfiguration.Behavior),l=s.Entity1AssociatedMenuConfiguration.Behavior,e=null!==(r=s.Entity1AssociatedMenuConfiguration.Label)&&void 0!==r?r:""),u){const t=Object(i.h)(n,p);if(t){const r=d(t,1===l?e:t.DisplayCollectionName);let n;n=h?{displayName:t.DisplayCollectionName,referencedFieldName:a.PrimaryIdAttribute,referencingFieldName:t.PrimaryIdAttribute,relationshipType:o.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:s.IntersectEntityName,entityIntersectIdAttribute:s.Entity2IntersectAttribute,relatedEntityIntersectIdAttribute:s.Entity1IntersectAttribute}:{displayName:t.DisplayCollectionName,referencedFieldName:a.PrimaryIdAttribute,referencingFieldName:t.PrimaryIdAttribute,relationshipType:o.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:s.IntersectEntityName,entityIntersectIdAttribute:s.Entity1IntersectAttribute,relatedEntityIntersectIdAttribute:s.Entity2IntersectAttribute},c.push([r,n])}}if(s.Entity1LogicalName===s.Entity2LogicalName){const e=Object(i.h)(n,s.Entity2LogicalName);if(2!==s.Entity1AssociatedMenuConfiguration.Behavior){const t=d(e,1===s.Entity1AssociatedMenuConfiguration.Behavior?s.Entity1AssociatedMenuConfiguration.Label:e.DisplayCollectionName),r={displayName:e.DisplayCollectionName,referencedFieldName:a.PrimaryIdAttribute,referencingFieldName:e.PrimaryIdAttribute,relationshipType:o.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:s.IntersectEntityName,entityIntersectIdAttribute:s.Entity2IntersectAttribute,relatedEntityIntersectIdAttribute:s.Entity1IntersectAttribute};c.push([t,r])}}}}),Object.keys(a.ManyToOneRelationships).forEach(e=>{var t,r;const l=a.ManyToOneRelationships[e];if(l.IsValidForAdvancedFind){const e=l.ReferencedEntity,u=l.ReferencingAttribute,h=Object(i.h)(n,e),g=Object(s.a)(n,a.EntityLogicalName,u);if(h){const e=p(l,1===l.AssociatedMenuConfiguration.Behavior?null!==(t=l.AssociatedMenuConfiguration.Label)&&void 0!==t?t:"":null!==(r=null==g?void 0:g.DisplayName)&&void 0!==r?r:h.DisplayCollectionName,o.RelationshipType.ManyToOne);c.push([d(h,h.DisplayCollectionName),e])}}});return r=c.sort((e,t)=>{var r,n,i,a;if(!(null===(r=e[1])||void 0===r?void 0:r.displayName)||!(null===(n=t[1])||void 0===n?void 0:n.displayName))return 0;const o=e[1].displayName.localeCompare(t[1].displayName);return 0===o?(null===(i=e[0])||void 0===i?void 0:i.displayName)&&(null===(a=t[0])||void 0===a?void 0:a.displayName)?e[0].displayName.localeCompare(t[0].displayName):0:o}),Promise.resolve(r)}catch(t){return h(e,r,t,"retrieveRelatedEntityRelationshipMetadata.async","retrieveRelationshipMetadata")}}}}function u(e,t,r){e[t]||(e[t]=[]),r&&-1===e[t].indexOf(r)&&e[t].push(r)}function d(e,t){var r;return{metadataId:null===(r=e.Id)||void 0===r?void 0:r.guid,displayName:t,primaryIdField:e.PrimaryIdAttribute,primaryNameField:e.PrimaryNameAttribute,name:e.EntityLogicalName}}function p(e,t,r){return{displayName:t,referencingFieldName:e.ReferencingAttribute,isHierarchical:e.IsHierarchical,relationshipType:r,referencedFieldName:e.ReferencedAttribute}}function h(e,t,r,n,i){const o=[{name:a.k,value:e}];return t.EventManager.ReportComponentFailure(Object(a.G)(n,i),r,null,o),Promise.resolve(null)}},COKI:function(e,t,r){"use strict";r.d(t,"a",(function(){return A}));var n=r("i1f0"),i=r("pF61"),a=r("Sbn7"),o=r("ScMg"),s=r("ldWj"),c=r("TYIz"),l=r("16wZ"),u=r("1kth"),d=r("mhYf"),p=r("PbI6"),h=r("FHmp"),g=r("qshH"),m=r("ZIjf"),b=r("ABCl");let y;class f extends o.a{constructor(e,t,r,n,i,a){Object(l.g)(i,"ClientApi.XrmTab.constructor","parent"),Object(l.g)(e,"ClientApi.XrmTab.constructor","store"),super(e,t,n,r),y=e,this._parent=i,this._formContext=a,this._iConnectedTabProps={tabName:this.name,tabId:this._getTabId(),id:this.pageId,showTab:!0},this._clientApiExecutor=new b.b(y,"ClientApi.XrmTab.",t)}get sections(){const e="ClientApi.XrmTab.sections";try{if(m.a.instance.reportCall(e),!this._sections){this._sections=new a.a(e);const t=y.getState(),r=Object(n.Gc)(t,this.pageId,this.name,this.contextToken);for(let e=0;e<r.Columns.length;e++){const i=Object(n.p)(t,{id:this.pageId,tabName:r.Id,columnIndex:e},this.contextToken);let a=null;for(let e=0;e<i.SectionNames.length;e++)a=new s.a(y,this.contextToken,this.pageId,i.SectionNames[e],this,this._formContext),this._sections.add(a.getName(),a)}}return m.a.instance.reportSuccess(e),this._sections}catch(t){const r=g.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(e,t,null,r),t}}addTabStateChange(e){const t="ClientApi.XrmTab.addTabStateChange";Object(l.g)(e,t,"handler");try{m.a.instance.reportCall(t),y.dispatch(Object(u.s)(this.contextToken,this.pageId,this.name,e)),m.a.instance.reportSuccess(t)}catch(e){const r=g.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(t,e,null,r),e}}removeTabStateChange(e){const t="ClientApi.XrmTab.removeTabStateChange";Object(l.g)(e,t,"handler");try{m.a.instance.reportCall(t),y.dispatch(Object(u.N)(this.contextToken,this.pageId,this.name,e)),m.a.instance.reportSuccess(t)}catch(e){const r=g.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(t,e,null,r),e}}getDisplayState(){const e="ClientApi.XrmTab.getDisplayState";try{m.a.instance.reportCall(e);const t=Object(n.Dc)(y.getState(),this._getTabId(),this.pageId,this.contextToken)?"collapsed":"expanded";return m.a.instance.reportSuccess(e),t}catch(t){const r=g.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(e,t,null,r),t}}getParent(){return m.a.instance.reportUsage("ClientApi.XrmTab.getParent"),this._parent}setDisplayState(e){const t="ClientApi.XrmTab.setDisplayState";try{m.a.instance.reportCall(t);let r=!1;switch(e){case"collapsed":r=!0;break;case"expanded":r=!1;break;default:Object(l.h)(t,"TabDisplayState",e)}r||y.dispatch(Object(c.b)(this.pageId,this._getTabId(),this.contextToken)),m.a.instance.reportSuccess(t)}catch(e){const r=g.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(t,e,null,r),e}}setFocus(){try{m.a.instance.reportCall("ClientApi.XrmTab.setFocus"),y.dispatch(Object(c.b)(this.pageId,this._getTabId(),this.contextToken)),m.a.instance.reportSuccess("ClientApi.XrmTab.setFocus")}catch(e){const t=g.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure("ClientApi.XrmTab.setFocus",e,null,t),e}}setVisible(e){const t="ClientApi.XrmTab.setVisible";try{m.a.instance.reportCall(t),y.dispatch(Object(d.b)(this.pageId,this._getTabId(),this.contextToken,!0===e)),m.a.instance.reportSuccess(t)}catch(e){const r=g.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(t,e,null,r),e}}getLabel(){try{m.a.instance.reportCall("ClientApi.XrmTab.getLabel");const e=Object(n.Hc)(y.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken)||"";return m.a.instance.reportSuccess("ClientApi.XrmTab.getLabel"),e}catch(e){const t=g.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure("ClientApi.XrmTab.getLabel",e,null,t),e}}getVisible(){const e="ClientApi.XrmTab.getVisible";try{m.a.instance.reportCall(e);const t=Object(n.Kc)(y.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken);return m.a.instance.reportSuccess(e),t}catch(t){const r=g.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(e,t,null,r),t}}setLabel(e){const t="ClientApi.XrmTab.setLabel";Object(l.g)(e,t,"label");try{m.a.instance.reportCall(t),y.dispatch(Object(h.b)(this.pageId,this.contextToken,this._getTabId(),e)),m.a.instance.reportSuccess(t)}catch(e){const r=g.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(t,e,null,r),e}}_getTabId(){const e=y.getState(),t=Object(n.Gc)(e,this.pageId,this.name,this.contextToken);if(t&&t.Id)return t.Id}setContentType(e){return this._clientApiExecutor.execute("setContentType",()=>{let t;switch(e){case"default":case"cardSections":t="cardSections";break;case"expandAvailableSpace":case"singleComponent":t="singleComponent";break;default:Object(l.h)("setContentType","TabContentType",e)}y.dispatch(Object(p.b)(this.pageId,this._getTabId(),this.contextToken,t))},[{name:"tabContentType",value:e,isRequired:!0,expectedDataType:"string"}])}getContentType(){return this._clientApiExecutor.execute("getContentType",()=>{var e;return null===(e=Object(n.Jc)(y.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken))||void 0===e?void 0:e.contentType})}}var v=r("SAYH"),C=r("rQHy"),S=r("jRy5"),I=r("y60j"),_=r("arV0"),O=r("3yqi"),T=r("0nOn"),j=r("zmL5"),P=r("jq7Z"),E=r("IaGr");let x;class A{constructor(e,t,r,n,i,a,o){const s=Object(_.l)(e.getState(),r),c=[{name:"store",value:e,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"pageId",value:r,isRequired:!0,isEventParam:!0},{name:"pageType",value:s,isEventParam:!0},{name:"formContext",value:n,isRequired:!0},{name:"entityName",value:i,isEventParam:!0},{name:"formSelectorType",value:o,isRequired:!0}];this._clientApiExecutor=new T.a(e,"ClientApi.XrmFormUIBase.",r,t,c),this._pageId=r,x=e,this._formContext=n,this._entityName=i,this._contextToken=t,this._formSelectorType=o,this.xrmControlFactory=a}get controls(){return this._clientApiExecutor.execute("controls_get",(e,t)=>{if(!this._controls){this._controls=new a.a(e);const r=function(e,t,r){const i=Object(P.b)(x.getState(),e,t),a=Object(j.b)(x.getState(),e),o=v.a.equals(i,a),s=Object(_.l)(x.getState(),e)===O.a.Dialog,c=Object(I.y)(x.getState(),i),l=c&&c.reduce((e,t)=>(e.add(t),e),new Set);return(i,a)=>{const c=Object(n.s)(x.getState(),{controlName:i,id:e},t),u=Object(n.Rc)(x.getState(),e,c);o&&u&&!s?l&&l.has(c.DataFieldName)&&Object(n.fd)(x.getState(),e,c,t)&&r.add(i,a):r.add(i,a)}}(this.pageId,this.contextToken,this._controls),i=this.getFormDescriptor(e,t);if(i){const n={isEventParam:!0,name:"controlName",value:""},a={isEventParam:!0,name:"controlType",value:""};t.push(n),t.push(a);for(const o in i.Controls){const s=i.Controls[o];n.value=o,a.value=s&&s.ClassId?s.ClassId.guid:"";const c=this.xrmControlFactory.createXrmControl(this.contextToken,s,this._formContext,e,t);c&&r(c.getName(),c)}}}return this._controls})}get formSelector(){return this._clientApiExecutor.execute("formSelector_get",(e,t)=>{if(!this._formSelector){const r=this.getFormDescriptor(e,t);r&&(this._formSelector=new this._formSelectorType(x,this._contextToken,r.Id,this._entityName,this._pageId))}return this._formSelector})}get tabs(){return this._clientApiExecutor.execute("tabs_get",(e,t)=>{if(!this._tabs){this._tabs=new a.a(e);const r=this.getFormDescriptor(e,t);if(r){const e=r.Tabs;for(const t in e){const r=new f(x,this._contextToken,e[t].Name,this._pageId,this,this._formContext);this._tabs.add(r.getName(),r)}}}return this._tabs})}get pageId(){return this._pageId}refreshRibbon(e=!1){this._clientApiExecutor.executeAsync("refreshRibbon",()=>x.dispatch(Object(C.a)(this._pageId,null,e)))}get contextToken(){return this._contextToken}get formContext(){return this._clientApiExecutor.execute("formContext",()=>this._formContext)}getControls(){if(!this._controls&&this.contextToken.contextTokenType===S.a.GridRow){const e=this._clientApiExecutor.getComponentName("getControls");return this._controls=new a.a(e),this._controls}return this.controls}getFormDescriptor(e,t){const r=Object(n.fb)(x.getState(),{id:this._pageId},this._contextToken);if(!r){const r="Form descriptor not found";if(Object(i.n)(x.getState(),this._pageId))E.a.getInstance().traceManager.getTracer(e).error(r+": Page is dead",t);else if(this.contextToken.contextTokenType===S.a.GridRow)E.a.getInstance().traceManager.getTracer(e).error(r,t);else{if(!this._clientApiExecutor.isPageReadyForClientAPIAccess())return null;const n=new Error(r);this._clientApiExecutor.reportFailure(e,n,t)}}return r}}},CbNq:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return o})),r.d(t,"b",(function(){return s})),r.d(t,"d",(function(){return c}));var n=r("P6DH");function i(e){const t=Object(n.m)(e),r=e&&e.metadata?e.metadata.entities:null,i=[];return r?(t.forEach(e=>{if(4200!==r[e].ObjectTypeCode){const t=function(e){const t=e.DisplayName,r=e.ObjectTypeCode.toString();return{entityDisplayName:t,objectTypeCode:r}}(r[e]);i.push(t)}}),i.sort(a)):i}function a(e,t){const r=e.entityDisplayName,n=t.entityDisplayName;let i=0;return r>n?i=1:r<n&&(i=-1),i}function o(e){const t=[];for(let r=0;r<e.length;r++){const n={key:e[r].objectTypeCode,text:e[r].entityDisplayName};t.push(n)}return t}function s(e){return e?e.split(","):[]}function c(e){return e?e.map(e=>({key:e.value,text:e.text})):[]}},DAWX:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class n{get_ErrorType(){return this._errorType}set_ErrorType(e){this._errorType=e}get_ErrorDescription(){return this._errorDescription}set_ErrorDescription(e){this._errorDescription=e}}},DU8S:function(e,t,r){"use strict";r.d(t,"c",(function(){return s})),r.d(t,"e",(function(){return c})),r.d(t,"b",(function(){return l})),r.d(t,"a",(function(){return u})),r.d(t,"d",(function(){return d}));var n=r("9A3e"),i=r("VDDv"),a=r("VkXQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="customcontrol.propertybag.device.isoperationavailable";function s(){return{type:o,execute:(e,t)=>new n.a(t,e).isOperationAvailable(a.b.getBarcodeValue.name),sync:!0}}function c(){return{type:o,execute:(e,t)=>new i.a(t,e).isOperationAvailable(a.f.takePicture.name),sync:!0}}function l(){return{type:o,execute:(e,t)=>new i.a(t,e).isOperationAvailable(a.f.captureVideo.name),sync:!0}}function u(){return{type:o,execute:(e,t)=>new i.a(t,e).isOperationAvailable(a.f.captureAudio.name),sync:!0}}function d(){return{type:o,execute:()=>!1,sync:!0}}},E6o7:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r("dHD5"),i=r("jAuy"),a=r("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="dataset.update.fetchxml";function s(e,t,r){return{type:"dataset.update.fetchxml.async",execute({dispatch:s,getState:c},l){const u=l.TraceManager.getTracer(a.z),d=a.x+".updateFetchXMLAction";try{u.info("Updating the fetch xml for the grid."),s(function(e,t,r){const i=Object(n.y)(t),a=Object(n.v)(t);return{type:o,payload:r,meta:{pageId:e,contextKey:i,dataSetContextKey:a}}}(e,t,r));const a=Object(i.j)(r),c=[];return c.push({name:"fetchXML",value:a}),l.EventManager.ReportComponentSuccess(d,c),Promise.resolve()}catch(e){const r="Updating the fetchxml for the grid with contextKey : "+Object(n.v)(t)+" failed with the error : "+e.message;l.EventManager.ReportComponentFailure(d,Error(r))}}}}},EOIL:function(e,t,r){"use strict";r.d(t,"a",(function(){return ee}));var n=r("0nOn"),i=r("i1f0"),a=r("ZIjf"),o=r("Sbn7"),s=r("Bj/n"),c=r("jTSi"),l=r("9NSo"),u=r("SAYH"),d=r("uOtn"),p=r("+zjj"),h=r("N+Ya"),g=r("dIqG"),m=r("16wZ"),b=r("qshH"),y=r("meVR"),f=r("TYIz"),v=r("dHD5");var C=r("IqkD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let S;class I{constructor(e,t,r,n){const i="ClientApi.XrmNavigationItem.constructor";e||Object(m.j)(i,"store"),r||Object(m.j)(i,"pageId"),t||Object(m.j)(i,"contextToken"),Object(m.a)(n)&&Object(m.j)(i,"id"),S=e,this._pageId=r,this._id=n,this._contextToken=t}getId(){return a.a.instance.reportUsage("ClientApi.XrmNavigationItem.getId"),this._id}getLabel(){const e="ClientApi.XrmNavigationItem.getLabel";try{a.a.instance.reportCall(e);const t=Object(i.Rb)(S.getState(),this._pageId,this._id);return a.a.instance.reportSuccess(e),t}catch(t){const r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}}getVisible(){const e="ClientApi.XrmNavigationItem.getVisible";try{a.a.instance.reportCall(e);const t=Object(i.Ub)(S.getState(),this._pageId,this._id);return a.a.instance.reportSuccess(e),t}catch(t){const r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}}setFocus(){const e="ClientApi.XrmNavigationItem.setFocus";try{a.a.instance.reportCall(e),S.dispatch((t=this._pageId,r=this._contextToken,n=this._id,{type:"forms.selectnavigationtab",sync:!0,execute({dispatch:e,getState:i},a,o){const s=Object(p.d)(i(),t,n);if(s){s.isSelected=!0;const n=Object(v.a)(r,s.relationshipName,s.ordinal);e(Object(f.b)(t,void 0,r)),e(Object(y.a)(t,n,s))}else a.TraceManager.getTracer("Forms.SelectNavigationTab").error("Could not find relatedEntityInfo to select")}})),a.a.instance.reportSuccess(e)}catch(t){const r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}var t,r,n}setLabel(e){const t="ClientApi.XrmNavigationItem.setLabel";try{if(a.a.instance.reportCall(t),!Object(m.a)(e)){const t=Object(C.s)(S.getState());S.dispatch(Object(h.b)(this._pageId,this._id,e,t))}a.a.instance.reportSuccess(t)}catch(e){const r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,r),e}}setVisible(e){const t="ClientApi.XrmNavigationItem.setVisible";try{a.a.instance.reportCall(t),S.dispatch(Object(g.b)(this._pageId,this._id,!0===e)),a.a.instance.reportSuccess(t)}catch(e){const r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,r),e}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let _;class O{constructor(e,t,r){r||Object(m.j)("ClientApi.XrmFormNavigation.constructor","pageId"),e||Object(m.j)("ClientApi.XrmFormNavigation.constructor","store"),_=e,this._pageId=r,this._contextToken=t}get items(){const e="ClientApi.XrmFormNavigation.items";try{if(a.a.instance.reportCall(e),!this._items){this._items=new o.a(e);const t=Object(p.f)()(_.getState(),{id:this._pageId});t&&t.forEach(e=>{e&&e.relatedItems&&e.relatedItems.forEach(e=>{e&&e.id&&this._items.add(e.id,new I(_,this._contextToken,this._pageId,e.id))})})}return a.a.instance.reportSuccess(e),this._items}catch(t){const r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}}}var T=r("ldWj"),j=r("PidC"),P=r("4U8P"),E=r("NtHU"),x=r("FhIR"),A=r("ABCl");let w;class F extends T.a{constructor(e,t,r,n){super(e,t,r,F.NAME,null,n),w=e,this._clientApiExecutor=new A.b(w,"ClientApi.XrmHeaderSection.",t)}getLabel(){return a.a.instance.reportUsage("ClientApi.XrmHeaderSection.getLabel"),""}getVisible(){return a.a.instance.reportUsage("ClientApi.XrmHeaderSection.getVisible"),!0}setLabel(e){a.a.instance.reportUsage("ClientApi.XrmHeaderSection.setLabel")}setVisible(e){a.a.instance.reportUsage("ClientApi.XrmHeaderSection.setVisible")}getControlsDescriptor(e){const t=Object(i.tb)(e,{id:this.pageId},this.contextToken),r={};if(t)for(let e=0;e<t.length;e++){const n=t[e];r[n.Name]=n}return r}setCommandBarVisible(e){this._clientApiExecutor.execute("setCommandBarVisible",()=>{w.dispatch(Object(P.b)(this.pageId,this.contextToken,e))},[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])}getCommandBarVisible(){return this._clientApiExecutor.execute("getCommandBarVisible",()=>{var e;return null===(e=Object(j.f)(w.getState(),this.pageId,this.contextToken))||void 0===e?void 0:e.commandBarVisible})}setBodyVisible(e){this._clientApiExecutor.execute("setBodyVisible",()=>{w.dispatch(Object(E.b)(this.pageId,this.contextToken,e))},[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])}getBodyVisible(){return this._clientApiExecutor.execute("getCommandBarVisible",()=>{var e;return null===(e=Object(j.f)(w.getState(),this.pageId,this.contextToken))||void 0===e?void 0:e.bodyVisible})}setTabNavigatorVisible(e){this._clientApiExecutor.execute("setTabNavigatorVisible",()=>{w.dispatch(Object(x.b)(this.pageId,this.contextToken,e))},[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])}getTabNavigatorVisible(){return this._clientApiExecutor.execute("getTabNavigatorVisible",()=>{var e;return null===(e=Object(j.f)(w.getState(),this.pageId,this.contextToken))||void 0===e?void 0:e.tabNavigatorVisible})}}F.NAME="Header";var N=r("5iTp"),k=r("m+2h");let D;class M extends T.a{constructor(e,t,r,n){super(e,t,r,M.NAME,null,n),D=e,this._clientApiExecutor=new A.b(D,"ClientApi.XrmFooterSection.",t)}getLabel(){return a.a.instance.reportUsage("ClientApi.XrmFooterSection.getLabel"),""}getVisible(){return this._clientApiExecutor.execute("getVisible",()=>{var e;return null===(e=Object(N.a)(D.getState(),this.pageId,this.contextToken))||void 0===e?void 0:e.visible})}setLabel(e){a.a.instance.reportUsage("ClientApi.XrmFooterSection.setLabel")}setVisible(e){this._clientApiExecutor.execute("setVisible",()=>{D.dispatch(Object(k.b)(this.pageId,this.contextToken,e))},[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])}getControlsDescriptor(e){const t=Object(i.Z)(e,{id:this.pageId},this.contextToken),r={};if(t)for(let e=0;e<t.length;e++){const n=t[e];r[n.Name]=n}return r}}M.NAME="Footer";var R=r("gQ5I"),L=r("arV0"),V=r("PUjk"),B=r("r/aD"),G=r("bpBl"),X=r("IaGr");let U;class z{constructor(e,t,r,n){const i="ClientApi.XrmProcessControlUI.constructor";n||Object(m.j)(i,"entity"),t||Object(m.j)(i,"contextToken"),r||Object(m.j)(i,"pageId"),e||Object(m.j)(i,"store"),U=e,this._pageId=r;let a=!1;if(Object(B.d)(U.getState(),this._pageId,i)){const e=Object(L.g)(U.getState(),this._pageId);this._processManager=Object(V.b)(this._pageId,e),a=!0}this._contextToken=t;const o=Object(B.b)(r,e.getState(),a);X.a.getInstance().eventManager.ReportComponentSuccess(i,o)}getDisplayState(){const e="ClientApi.XrmProcessControlUI.getDisplayState";try{if(a.a.instance.reportCall(e),!Object(B.d)(U.getState(),this._pageId,e))return a.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getDisplayState();return a.a.instance.reportSuccess(e),t}catch(t){const r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}}getVisible(){const e="ClientApi.XrmProcessControlUI.getVisible";try{if(a.a.instance.reportCall(e),!Object(B.d)(U.getState(),this._pageId,e))return a.a.instance.reportSuccess(e),!1;const t=this._getProcessManager().isVisible();return a.a.instance.reportSuccess(e),t}catch(t){const r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}}setDisplayState(e){const t="ClientApi.XrmProcessControlUI.setDisplayState";try{if(a.a.instance.reportCall(t),!Object(B.d)(U.getState(),this._pageId,t))return void a.a.instance.reportSuccess(t);e!==G.a.collapsed&&e!==G.a.expanded&&e!==G.a.floating||this._getProcessManager().setDisplayState(e),a.a.instance.reportSuccess(t)}catch(e){const r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,r),e}}setVisible(e){const t="ClientApi.XrmProcessControlUI.setVisible";try{if(a.a.instance.reportCall(t),!Object(B.d)(U.getState(),this._pageId,t))return void a.a.instance.reportSuccess(t);this._getProcessManager().setVisible(e),a.a.instance.reportSuccess(t)}catch(e){const r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,r),e}}reflow(e,t,r){const n="ClientApi.XrmProcessControlUI.reflow";try{if(a.a.instance.reportCall(n),!Object(B.d)(U.getState(),this._pageId,n))return void a.a.instance.reportSuccess(n);this._getProcessManager().reflow(e,t,r),a.a.instance.reportSuccess(n)}catch(e){const t=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(n,e,null,t),e}}_getProcessManager(){return this._processManager||(this._processManager=Object(B.c)(this._processManager,U,this._pageId,"ClientApi.XrmProcessControlUI.getProcessManager")),this._processManager}}var H=r("1kth"),q=r("uNLT"),W=r("bT7G"),Y=r("Dea/"),Q=r("Fij2"),K=r("pF61"),J=r("COKI"),Z=r("zJiL");let $;class ee extends J.a{constructor(e,t,r,i,a,o){$=e,super(e,t,r,i,a,o,d.a),this._clientApiExecutorFormUI=new n.a(e,"ClientApi.XrmFormUI.",r,t),this._clientApiExecutorFormUI.addEventParameter({name:"entityName",value:a,isEventParam:!0})}get headerSection(){const e="ClientApi.XrmFormUI.headerSection";try{return a.a.instance.reportCall(e),this._headerSection||(this._headerSection=new F($,this.contextToken,this.pageId,this.formContext)),a.a.instance.reportSuccess(e),this._headerSection}catch(t){throw this._reportFailure(e,t)}}get footerSection(){const e="ClientApi.XrmFormUI.footerSection";try{return a.a.instance.reportCall(e),this._footerSection||(this._footerSection=new M($,this.contextToken,this.pageId,this.formContext)),a.a.instance.reportSuccess(e),this._footerSection}catch(t){throw this._reportFailure(e,t)}}addControls(e){const t=b.a.getInstance().getEventParameters(this.contextToken),r={name:"controlName",value:""};t.push(r);for(const n in e)if(e[n]){r.value=n;const i=this.xrmControlFactory.createXrmControl(this.contextToken,e[n],this.formContext,"ClientApi.XrmFormUI.addControls",t);i&&this.controls.add(i.getName(),i)}}get navigation(){const e="ClientApi.XrmFormUI.navigation";try{return a.a.instance.reportCall(e),this._navigation||(this._navigation=new O($,this.contextToken,this.pageId)),a.a.instance.reportSuccess(e),this._navigation}catch(t){throw this._reportFailure(e,t)}}get process(){const e="ClientApi.XrmFormUI.process_get";try{a.a.instance.reportCall(e);const t=!!this._process;!this._process&&this.formContext.data&&this.formContext.data.entity&&(this._process=new z($,this.contextToken,this.pageId,this.formContext.data.entity));const r=Object(B.a)(this.pageId,$.getState(),t,!(!this.formContext.data||!this.formContext.data.entity));return X.a.getInstance().eventManager.ReportComponentSuccess(e,r),a.a.instance.reportSuccess(e),this._process}catch(t){throw this._reportFailure(e,t)}}set process(e){const t=Object(B.a)(this.pageId,$.getState(),!!this._process,!(!this.formContext.data||!this.formContext.data.entity));X.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmFormUI.process_set",t),this._process=e}get quickForms(){const e="ClientApi.XrmFormUI.quickForms";try{return a.a.instance.reportCall(e),this._quickForms||(this._quickForms=new o.a(e),this.controls),a.a.instance.reportSuccess(e),this._quickForms}catch(t){throw this._reportFailure(e,t)}}clearFormNotification(e){const t="ClientApi.XrmFormUI.clearFormNotification";try{a.a.instance.reportCall(t);const r=$.dispatch(Object(c.b)(this.contextToken,this.pageId,e));return a.a.instance.reportSuccess(t),r}catch(e){throw this._reportFailure(t,e)}}close(){try{a.a.instance.reportCall("ClientApi.XrmFormUI.close"),Object(Q.a)(Object(K.b)($.getState())===this.pageId)||$.dispatch(Object(R.e)(this.pageId)),a.a.instance.reportSuccess("ClientApi.XrmFormUI.close")}catch(e){throw this._reportFailure("ClientApi.XrmFormUI.close",e)}}getFormType(){return this._clientApiExecutorFormUI.execute("getFormType",(e,t)=>{const r=this.getFormDescriptor(e,t);if(r){const n=this.formContext;if(n&&n.data&&n.data.entity&&Object(i.Lb)($.getState(),n.data.entity.getEntityName(),u.a.tryParse(n.data.entity.getId())))return 4;if(Object(i.kb)($.getState(),{id:this.pageId},this.contextToken))return 3;if(6===r.FormType)return 3;const a=Object(i.ac)($.getState(),this.pageId,this.contextToken);if(a){const r=Object(W.b)($.getState(),a);return r?r.mode===Y.a.Create?1:2:(t.push({name:"snapshotID",value:a}),this._clientApiExecutorFormUI.reportFailure(e+".getSnapshot",new Error("Snapshot is null or undefined"),t),0)}return n&&n.data&&n.data.entity&&!u.a.tryParseOrNull(n.data.entity.getId())?1:2}return 0})}isDialog(){return this._clientApiExecutorFormUI.execute("isDialog",()=>Object(L.f)($.getState(),this.pageId))}getViewPortHeight(){const e="ClientApi.XrmFormUI.getViewPortHeight";try{a.a.instance.reportCall(e);const t=Object(i.qb)($.getState(),{id:this.pageId},this.contextToken);return a.a.instance.reportSuccess(e),t}catch(t){throw this._reportFailure(e,t)}}getViewPortWidth(){const e="ClientApi.XrmFormUI.getViewPortWidth";try{a.a.instance.reportCall(e);const t=Object(i.rb)($.getState(),{id:this.pageId},this.contextToken);return a.a.instance.reportSuccess(e),t}catch(t){throw this._reportFailure(e,t)}}setFormEntityName(e){const t="ClientApi.XrmFormUI.setFormEntityName";Object(m.g)(e,t,"name");try{a.a.instance.reportCall(t),$.dispatch(Object(l.b)(this.pageId,this.contextToken,e)),a.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}}setFormNotification(e,t,r,n,i){return this._clientApiExecutorFormUI.execute("setFormNotification",(a,o)=>{let c;switch(Object(m.a)(r)&&(r="Random_String_"+Math.random()),t){case"ERROR":c=Z.a;break;case"WARNING":c=Z.e;break;case"INFORMATION":case"INFO":c=Z.b;break;default:Object(m.h)(a,"notificationLevel",t,o)}return!Object(m.a)(e)&&"string"==typeof e&&($.dispatch(Object(s.c)(this.contextToken,this.pageId,e,c,r,n,i)),!0)})}addOnLoad(e){const t="ClientApi.XrmFormUI.addOnLoad";Object(m.g)(e,t,"handler");try{a.a.instance.reportCall(t),$.dispatch(Object(H.f)(this.contextToken,this.pageId,e)),a.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}}removeOnLoad(e){const t="ClientApi.XrmFormUI.removeOnLoad";Object(m.g)(e,t,"handler");try{a.a.instance.reportCall(t),$.dispatch(Object(H.A)(this.contextToken,this.pageId,e)),a.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}}refresh(){const e="ClientApi.XrmFormUI.refresh";try{a.a.instance.reportCall(e);const t=Object(L.l)($.getState(),this.pageId);return $.dispatch(Object(q.f)(this.pageId,t,!0,1,!0,!0)).then(t=>(Object(Q.b)(this.formContext.data.entity),a.a.instance.reportSuccess(e),t)).catch(t=>{const r=b.a.getInstance().getEventParameters(this.contextToken);return Object(m.d)($,t,e+".saveFormAndNavigate",r)})}catch(t){const r=b.a.getInstance().getEventParameters(this.contextToken);return Object(m.d)($,t,e,r)}}_reportFailure(e,t){const r=b.a.getInstance().getEventParameters(this.contextToken);return b.a.getInstance().reportFailure(e,t,null,r),t}}},EOZU:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return l}));var n=r("d4He"),i=r("ATZz"),a=r("fU7K"),o=r("9eA9");const s=["app.powerbi.com","msit.powerbi.com","app.powerbigov.us","app.high.powerbigov.us","app.mil.powerbigov.us","app.powerbi.cn","powerbi-df.analysis-df.windows.net"];function c(e){return{type:"dashboard.openinpowerbi",execute({dispatch:t,getState:r}){const n=Object(i.a)(r(),e);return n?t(l(n.TileUrl,n.Type,n.PowerBIGroupId,n.PowerBIDashboardId,null,n.PowerBIReportId)):Promise.resolve()}}}function l(e,t,r,i,c,l){return{type:"powerbi.openInPowerBICore",execute({dispatch:u},d){const p=d.TraceManager.getTracer("PowerBI"),{hostname:h,pathname:g,searchParams:m}=new o.a(e);let b="app.powerbi.com";-1!==s.indexOf(h)?b=h:p.error("Invalid PowerBI domain, using "+b,[{name:"PowerBIDomain",value:h}]);const y=new o.a(`https://${b}/MobileRedirect.html`),f=y.searchParams;let v;switch(t){case"0":v="OpenTile",f.set("tileObjectId",Object(a.CrmUrlEncode)(c));case"1":v=v||"OpenDashboard",f.set("dashboardObjectId",Object(a.CrmUrlEncode)(i));break;case"2":v=(null==g?void 0:g.endsWith("rdlEmbed"))?"OpenRdlReport":"OpenReport",f.set("reportObjectId",Object(a.CrmUrlEncode)(l));const e=m.get("pageName");e&&f.set("reportPage",Object(a.CrmUrlEncode)(e));break;default:return p.error("Invalid PowerBIObjectType",[{name:"PowerBIObjectType",value:t}]),Promise.reject("Invalid PowerBIObjectType: "+t)}return f.set("action",v),r&&f.set("groupObjectId",Object(a.CrmUrlEncode)(r)),u(Object(n.a)(y.toString())),Promise.resolve()}}}},FHmp:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="tab.setlabel";function a(e,t,r,a){const o=Object(n.v)(t);return{type:i,payload:a,meta:{pageId:e,contextKey:o,tabId:r}}}},FhIR:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="header.tabnavigatorvisible";function a(e,t,r){const a=Object(n.v)(t);return{type:i,payload:r,meta:{pageId:e,contextKey:a}}}},G0J3:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("ghNp"),i=r("i1f0"),a=r("0nOn");let o;class s{constructor(e,t,r,i,s,c){this._clientApiExecutor=new a.a(e,"ClientApi.XrmFormBase.",i,r,[{name:"store",value:e,isRequired:!0},{name:"entityName",value:this._entityName,isEventParam:!0},{name:"pageId",value:i,isRequired:!0,isEventParam:!0},{name:"contextToken",value:r,isRequired:!0},{name:"getUiType",value:s,isRequired:!0}]),o=e,this.pageId=i,this.contextToken=r,this._entityName=t,this._getUiType=s,this._xrmControlFactory=c,o.dispatch(Object(n.a)(this,i,r))}get ui(){return this._clientApiExecutor.execute("ui_get",()=>{if(!this._ui){const e={id:this.pageId},t=Object(i.fb)(o.getState(),e,this.contextToken),r=t&&t.FormType,n=this._getUiType(r);this._ui=new n(o,this.contextToken,this.pageId,this,this._entityName,this._xrmControlFactory)}return this._ui})}getControl(e){const t=[{name:"entityName",value:this._entityName,isRequired:!1,isEventParam:!0}];return this._clientApiExecutor.execute("getControl",()=>this.ui.controls.get(e),t)}}},GxhD:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e,t){this._etn=null,this._attributeName=null,this._etn=e,this._attributeName=t}get etn(){return this._etn}set etn(e){this._etn=e}get attributeName(){return this._attributeName}set attributeName(e){this._attributeName=e}}},HAeo:function(e,t,r){"use strict";r.d(t,"a",(function(){return A})),r.d(t,"b",(function(){return w}));var n=r("0nOn"),i=r("arV0"),a=r("3yqi"),o=r("AbXy"),s=r("SAYH"),c=r("B9jE"),l=r("16wZ"),u=r("P6DH"),d=r("qshH"),p=r("i1f0"),h=r("Uv1Y"),g=r("dHD5"),m=r("ZIjf"),b=r("IaGr");let y;class f{constructor(e,t,r,i,a){this._pageId=r,y=e,this._contextToken=t,this._controlName=i,this._gridType=a,this._clientApiExecutor=new n.a(e,"ClientApi.XrmViewSelector.",r,t,[{name:"controlName",value:i,isEventParam:!0},{name:"gridType",value:a,isEventParam:!0,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"store",value:e,isRequired:!0}])}setCurrentView(e){this._clientApiExecutor.executeAsync("setCurrentView",(t,r)=>e&&e.id?y.dispatch(Object(c.a)(this._pageId,this._contextToken,this._controlName,e.id)):(r.push({name:"validationError",value:"true"}),b.a.getInstance().traceManager.getTracer(t).error("View ID is required",r),Promise.resolve()))}getCurrentView(){const e="ClientApi.XrmViewSelector.getCurrentView";try{m.a.instance.reportCall(e);const t=Object(u.hb)(y.getState(),this._pageId,this._contextToken,this._controlName);let r=null,n=null;if(t)n=t.ViewId;else if(3===this._gridType){const t={id:this._pageId},r=Object(p.fb)(y.getState(),t,this._contextToken.parentContextToken),i="ViewId";if(!(r&&r.Controls&&r.Controls[this._controlName]&&r.Controls[this._controlName].Parameters&&r.Controls[this._controlName].Parameters[i])){let t;r?r.Controls?r.Controls[this._controlName]?r.Controls[this._controlName].Parameters?r.Controls[this._controlName].Parameters[i]||(t="formDescriptor.Controls[this._controlName].Parameters[propertyViewId] is null or undefined"):t="formDescriptor.Controls[this._controlName].Parameters is null or undefined":t="formDescriptor.Controls[this._controlName] is null or undefined":t="formDescriptor.Controls is null or undefined":t="formDescriptor is null or undefined";const n=d.a.getInstance().getEventParameters(this._contextToken);return n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,new h.a(t),null,n),null}n=r.Controls[this._controlName].Parameters[i]}if(n){if(r=Object(u.qb)(y.getState(),s.a.parse(n),this._pageId),r){const t={entityType:Object(u.ob)(y.getState(),n,this._pageId),id:s.a.externalGuid(r.viewId),name:r.title};return m.a.instance.reportSuccess(e),t}const t=[];return t.push({name:"controlName",value:this._controlName}),t.push({name:"contextKey",value:Object(g.v)(this._contextToken)}),d.a.getInstance().reportFailure(e,new Error("ViewDescriptor is coming as null"),null,t),null}const i=[];return i.push({name:"controlName",value:this._controlName}),i.push({name:"contextKey",value:Object(g.v)(this._contextToken)}),d.a.getInstance().reportFailure(e,new Error("viewId is coming as null or undefined"),null,i),null}catch(t){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,r),t}}isVisible(){const e="ClientApi.XrmViewSelector.isVisible";try{if(m.a.instance.reportCall(e),Object(l.a)(this._isVisible)){const t=Object(u.hb)(y.getState(),this._pageId,this._contextToken,this._controlName);if(t)this._isVisible=t.EnableViewPicker;else{const t={id:this._pageId},r=Object(p.fb)(y.getState(),t,this._contextToken.parentContextToken),n="EnableViewPicker";if(!(r&&r.Controls&&r.Controls[this._controlName]&&r.Controls[this._controlName].Parameters&&r.Controls[this._controlName].Parameters[n])){const t=d.a.getInstance().getEventParameters(this._contextToken);return t.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,new h.a("FormDescriptor is null"),null,t),!1}this._isVisible=r.Controls[this._controlName].Parameters[n]}}return m.a.instance.reportSuccess(e),this._isVisible}catch(t){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,r),t}}}var v=r("ghNp"),C=r("OQLa"),S=r("rQHy"),I=r("iOrn"),_=r("iZ7K"),O=r("d0w6"),T=r("deGN"),j=r("Lyxw"),P=r("3/02"),E=r("whN/");let x;class A{constructor(e,t,r,i,a,o,s,c){this._relationship=null;const u="ClientApi.XrmGridControl.constructor";e||Object(l.j)(u,"store"),t||Object(l.j)(u,"contextToken"),r||Object(l.j)(u,"pageId"),x=e,this._pageId=r,this._contextToken=t,this._controlName=c,this._isEditable=i,this._gridType=a,this._applicationContext=s,o||x.dispatch(Object(v.a)(this,r,t)),this._clientApiExecutor=new n.a(e,"ClientApi.XrmGridControl.",r,t),this._clientApiExecutor.addEventParameter({name:"controlName",value:c,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"isEditable",value:i,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"isCallFromSubgrid",value:o,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"gridType",value:a,isEventParam:!0})}get _connectedControlProps(){return{controlName:this._controlName,id:this._pageId}}setFilterXml(e){this._clientApiExecutor.executeAsync("setFilterXml",()=>{const t=(new Date).getTime();return x.dispatch(Object(I.b)(e,1,this._pageId,this._contextToken,t))})}getFilterXml(){const e="ClientApi.XrmGridControl.getFilterXml";try{m.a.instance.reportCall(e);const t=Object(u.u)(x.getState(),this._pageId,this._contextToken);return m.a.instance.reportSuccess(e),t}catch(t){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,r),t}}getFetchXml(){const e="ClientApi.XrmGridControl.getFetchXml";try{m.a.instance.reportCall(e);const t=Object(u.A)(x.getState(),this._contextToken,{id:this._pageId});return m.a.instance.reportSuccess(e),t}catch(t){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,r),t}}getGrid(){const e="ClientApi.XrmGridControl.getGrid";try{return m.a.instance.reportCall(e),!this._grid&&this.getEntityName()&&(this._grid=new o.a(x,this._applicationContext,this._contextToken,this._pageId,this.getEntityName(),this._isEditable,this._controlName)),m.a.instance.reportSuccess(e),this._grid}catch(t){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,r),t}}getViewSelector(){const e="ClientApi.XrmGridControl.getViewSelector";try{return m.a.instance.reportCall(e),this._viewSelector||(this._viewSelector=new f(x,this._contextToken,this._pageId,this._controlName,this._gridType)),m.a.instance.reportSuccess(e),this._viewSelector}catch(t){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,r),t}}getTeamTemplateId(){const e="ClientApi.XrmGridControl.getTeamTemplateId";try{m.a.instance.reportCall(e);let t=null;const r=x.getState();if(Object(j.c)(r,P.c)){if(this.getEntityName()&&3===this._gridType){const e=Object(p.fb)(r,this._connectedControlProps,this._contextToken.parentContextToken),n="TeamTemplateId";e&&e.Controls&&e.Controls[this._controlName]&&e.Controls[this._controlName].Parameters&&e.Controls[this._controlName].Parameters[n]&&(t=e.Controls[this._controlName].Parameters[n])}}return m.a.instance.reportSuccess(e),t}catch(t){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,r),t}}getEntityName(){return this._clientApiExecutor.execute("getEntityName",(e,t)=>{if(!this._entityName){if(this._entityName=Object(u.F)(x.getState(),this._pageId,this._contextToken,this._controlName),!this._entityName&&3===this._gridType){const r=Object(p.fb)(x.getState(),this._connectedControlProps,this._contextToken.parentContextToken),n="TargetEntityType";if(!(r&&r.Controls&&r.Controls[this._controlName]&&r.Controls[this._controlName].Parameters&&r.Controls[this._controlName].Parameters[n])){let i;return r?r.Controls?r.Controls[this._controlName]?r.Controls[this._controlName].Parameters?r.Controls[this._controlName].Parameters[n]||(i="formDescriptor.Controls[this.name].Parameters[targetEntityType] is null or undefined"):i="formDescriptor.Controls[this.name].Parameters is null or undefined":i="formDescriptor.Controls[this.name] is null or undefined":i="formDescriptor.Controls is null or undefined":i="formDescriptor is null or undefined",this._clientApiExecutor.reportFailure(e,new h.a(i),t),null}this._entityName=r.Controls[this._controlName].Parameters[n]}if(!this._entityName)return this._clientApiExecutor.reportFailure(e,new h.a("Logical name of the entity type is coming as null or undefined."),t),null}return this._entityName})}refresh(){this._clientApiExecutor.executeAsync("refresh",()=>x.dispatch(Object(c.a)(this._pageId,this._contextToken,this._controlName)))}refreshRibbon(){this._clientApiExecutor.executeAsync("refreshRibbon",()=>x.dispatch(Object(S.a)(this._pageId,Object(u.w)(x.getState(),this._pageId,this._contextToken))))}getUrl(e){const t="ClientApi.XrmGridControl.getUrl";try{m.a.instance.reportCall(t);let r=null,n=null;const i=this._getCurrentView();n={entityTypeName:this.getEntityName()},i&&(n.viewType="savedquery"===i.entityType?O.b.savedview:O.b.userview,n.viewId=new s.a(i.id)),r=a.a.Grid;let o=null;if(1===e)o=x.dispatch(Object(C.a)(r,n));else{const e=Object(T.a)(x,this._pageId);o=x.dispatch(Object(C.c)(e,r,n))}return m.a.instance.reportSuccess(t),o}catch(e){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,e,null,r),e}}getRecordSetQueryKey(){return this._clientApiExecutor.execute("getRecordSetQueryKey",()=>Object(u.cb)(x.getState(),this._contextToken,{id:this._pageId}))}getGridType(){return m.a.instance.reportUsage("ClientApi.XrmGridControl.getGridType"),this._gridType}getRelationship(){return this._clientApiExecutor.execute("getRelationship",(e,t)=>{if(!this._relationship){const r=Object(u.v)(x.getState(),this._pageId,this._contextToken);if(r){const e=r.relationshipName;if(e&&(this._relationship=w(e,this.getEntityName()),r.relationshipRoleOrdinal)){const e=r.relationshipRoleOrdinal===E.a.Referencing?1:2;this._relationship.roleType=e}}else b.a.getInstance().traceManager.getTracer(e).error("Grid dataset was null",t)}return this._relationship})}getParentForm(){const e="ClientApi.XrmGridControl.getParentForm";try{m.a.instance.reportCall(e);const t=this._contextToken&&this._contextToken.parentContextToken?x.dispatch(Object(v.b)(this._pageId,this._contextToken.parentContextToken)):null;return m.a.instance.reportSuccess(e),t}catch(t){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,r),t}}getRollupType(){return this._clientApiExecutor.execute("getRollupType",()=>Object(u.eb)(x.getState(),this._pageId,this._contextToken))}_getCurrentView(){let e=null;const t=this.getViewSelector().getCurrentView();if(t)return e="savedquery"===t.entityType?"savedquery":"userquery",{entityType:e,id:t.id};const r=Object(i.g)(x.getState(),this._pageId);if(r.viewType&&r.viewId){const t=r.viewId?s.a.externalGuid(r.viewId):void 0;if(e=r.viewType===O.b.savedview?"savedquery":"userquery",e&&t)return{entityType:e,id:t}}return null}}function w(e,t){const r={};r.name=e;const n=Object(_.h)(x.getState(),t);if(n){let t;if(n.OneToManyRelationships&&n.OneToManyRelationships[e]?t=n.OneToManyRelationships[e]:n.ManyToOneRelationships&&n.ManyToOneRelationships[e]&&(t=n.ManyToOneRelationships[e]),t)r.attributeName=t.ReferencingAttribute,r.relationshipType=0,r.navigationPropertyName=t.ReferencingEntityNavigationPropertyName;else if(n.ManyToManyRelationships&&n.ManyToManyRelationships[e]){const t=n.ManyToManyRelationships[e];r.relationshipType=1,1===r.roleType?(r.attributeName=t.Entity1IntersectAttribute,r.navigationPropertyName=t.Entity1NavigationPropertyName):(r.attributeName=t.Entity2IntersectAttribute,r.navigationPropertyName=t.Entity2NavigationPropertyName)}}return r}},HhsT:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r("uNLT"),i=r("Uv1Y"),a=r("cUbT"),o=r("gQ5I"),s=r("+aj2"),c=r("YxC/"),l=r("ZUzm"),u=r("sHzf"),d=r("bvqZ"),p=r("FdXt"),h=r("dHD5"),g=r("i1f0"),m=r("bT7G"),b=r("3tOH"),y=r("Bj/n"),f=r("O7zD");function v(e){return{type:"saveAndClose.saveAndCloseFormDialogAction.async",execute({dispatch:t,getState:r},v,C){const S=r(),I=Object(h.j)(S,e),_=Object(g.zb)(S,e,I),O=Object(g.ac)(S,e,I);if(!(!Object(m.g)(S,O)&&_&&Object.keys(_).length>0))return t(Object(n.e)(e,2)).then(r=>{const n=Object(g.Ib)(S,e),h=n?"Forms.MainFormDialogRoot.SaveAndClose":"Forms.QuickCreateFormRoot.SaveAndClose";if(r){const i=[{name:"isEntityRefNull",value:!1},{name:"entityTypeName",value:r.etn}];v.EventManager.ReportComponentSuccess(h,i);return(n?Promise.resolve(e):t(Object(s.b)(e,r))).then(e=>(t(Object(a.a)(r.etn)),function(e,t,r){const n="quickcreate_",i=Object(c.e)(t,[p.g,p.c]),a={actionLabel:Object(c.c)(i,p.g),eventHandler:()=>{e(Object(l.a)(r)),e(Object(u.removeToastNotification)(n+r.id.guid))}},o=null,s={id:n+r.id.guid,type:1,level:1,message:Object(c.c)(i,p.c),title:null,action:a,onCloseHandler:o};e(Object(d.b)(s))}(t,S,r),t(Object(o.e)(e,"save")).then(()=>r)))}return v.EventManager.ReportComponentSuccess(h,[{name:"isEntityRefNull",value:!0}]),Promise.reject(new i.a("Record is not created"))});for(const r in _){const n=_[r].label,i=_[r].errorMessage,a=t(Object(y.b)(n,i));t(Object(y.c)(I,e,a,b.a.error,Object(f.d)(e,r)))}}}}},Jpj4:function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return b}));var n=r("SAYH"),i=r("dHD5"),a=r("BFlg"),o=r("P6DH"),s=r("LbMF"),c=r("3hnk"),l=r("NUHF"),u=r("odYE"),d=r("3/02"),p=r("Lyxw"),h=r("bT7G"),g=r("qLnS");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const m="dataset.row.properties";function b(e,t,r){return{type:"row.properties.async",execute({dispatch:l,getState:h},b){const f=b.TraceManager.getTracer(a.z),v=a.x+".RowPropertiesAction",C=Object(p.c)(h(),d.L);try{const a=Object(i.v)(t),d=Object(o.P)(h(),t,{id:e});if(d){let p=null;const _=Object(o.Q)(h(),e,t);if(_)p=_;else{const r=Object(o.S)(h(),{id:e},t);r&&r.entityLogicalName&&(p=r.entityLogicalName)}if(p){const i=Object(s.d)(h(),p),a=Object(o.y)(h(),t,e);if(i){const e=[];for(const t of Object.keys(i)){const r=i[t],n=Object(c.f)(h(),p,r.LogicalName,g.a.CanUpdate);let o=!0;C&&a&&0===a[r.LogicalName]&&(o=!1),e.push({[r.LogicalName]:{requiredLevel:r.RequiredLevel,isDisabled:!(r.IsValidForUpdate&&n&&o),notifications:{}}})}for(const t of r)if(0===d.records.filter(e=>Object.keys(e)[0]===n.a.toString(t)).length)d.records.push({[n.a.toString(t)]:e});else{const r=d.records.find(e=>Object.keys(e)[0]===n.a.toString(t))[n.a.toString(t)],i=JSON.parse(JSON.stringify(e));r&&r.forEach(e=>{const t=e[Object.keys(e)[0]];t&&Object.keys(t.notifications).length>0&&(i.find(t=>Object.keys(t)[0]===Object.keys(e)[0])[Object.keys(e)[0]].notifications=t.notifications)}),d.records.find(e=>Object.keys(e)[0]===n.a.toString(t))[n.a.toString(t)]=i}}}if(l(function(e,t,r){return{type:m,payload:r,meta:{pageId:e,dataSetContextKey:t}}}(e,a,d)),C&&p){const n=Object(s.d)(h(),p),a=Object(o.y)(h(),t,e);for(const o of r){const r=(h(),S=o,I=p,new u.a(I,S)),s=Object(i.f)(t,o,p);if(n)for(const t of Object.keys(n)){const i=n[t];a&&1===a[i.LogicalName]&&null===i.ParentPicklistLogicalName&&y(h(),l,e,r,i.LogicalName,s)}}}f.info("creating the rowproperties for {0} rows"+r.length),b.EventManager.ReportComponentSuccess(v)}return Promise.resolve()}catch(e){const t="creating the rowproperties for {0} rows"+r.length+"failed";b.EventManager.ReportComponentFailure(v,Error(t))}var S,I}}}function y(e,t,r,n,i,a){const s={},c=Object(o.R)(e,r,a),u=Object(h.d)(e,c,n,i);s[i]=u,Object.keys(s).length>0&&t(Object(l.b)(r,a,!1,s))}},KnyI:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="attribute.removeOption";function a(e,t,r,a){const o=Object(n.x)(t);return{type:i,payload:a,meta:{pageId:e,contextKey:o,dataFieldName:r}}}},L1d8:function(e,t,r){"use strict";r.r(t),r.d(t,"PowerBIFullScreen",(function(){return V}));var n=r("WLAV"),i=r("arV0"),a=r("oOvK"),o=r("EY5k");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s=["Ribbon.Jewel.PowerBI.Refresh","Ribbon.Jewel.PowerBI.OpenInPowerBI","Ribbon.Jewel.PowerBI.OpenPowerBIReport","PowerBI.FullScreenPage.Title"];var c=r("ZFRl"),l=r("YxC/"),u=r("jq7Z");function d(e){return Object(l.h)()(e,s)}var p=r("Z4sG"),h=r("455M"),g=r("p8cR"),m=r("MoY7");function b(e){return{type:"initialize.powerBIFullScreenAction.async",execute(t,r){const{dispatch:n,getState:u}=t,b=n(Object(a.c)("MscrmControls.PowerBI.PowerBIControl"));Object(g.b)(m.a,h.a.PowerBI);const y=Object(i.g)(u(),e),f={powerBIEmbedUrl:y.powerBIEmbedUrl,powerBIGroupId:y.powerBIGroupId,powerBIDashboardId:y.powerBIDashboardId,powerBITileId:y.powerBITileId,powerBIReportId:y.powerBIReportId,powerBIReportUrl:y.powerBIReportUrl,powerBIComponentTypeCode:y.powerBIComponentTypeCode,xrmReady:!0,powerBISignedInState:"NotSignedIn"};n(function(e,t){return{type:"initialize.powerBIFullScreen.page",payload:t,meta:{pageId:e}}}(e,f));const v=n(Object(o.e)(s));return Object(p.a)(t,r,e),Promise.all([b,v]).then(()=>{const t=d(u()),r=Object(l.c)(t,"PowerBI.FullScreenPage.Title");n(Object(c.c)(e,r)),n(function(e,t){return{type:"xrmready.powerBIFullScreen",payload:{xrmReady:e},meta:{pageId:t}}}(!0,e))})}}}var y=r("nuS9"),f=r("u+q+"),v=r("YWpA"),C=r("223Y"),S=r("Ki7F"),I=r("o0iw"),_=r("XIN1"),O=r("lIi+"),T=r("uPT+"),j=r("unFF"),P=r("IqkD"),E=r("b8TU"),x=r("EOZU"),A=r("xhhr"),w=r("0kGT"),F=r("Lyxw"),N=r("3/02");class k extends y.Component{constructor(){super(...arguments),this._renderCount=0}_refresh(e){return{type:"Power BI Refresh",execute:({dispatch:t},r)=>new Promise(r=>{t(Object(T.b)(e,"Refresh")),r()})}}_openPowerBIReport(e,t,r,n){return{type:"Power BI Open Power BI report",execute:({dispatch:i})=>i(Object(O.a)(e,t,r,null,null,n,null,"2"))}}render(){if(!this.props.powerBIEmbedUrl)return null;this._CCF_descriptor&&this.props.powerBIEmbedUrl===this._CCF_descriptor.Parameters.TileUrl||(this._renderCount++,this._CCF_descriptor={Id:"MscrmControls.PowerBI.PowerBIControl",Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1,Parameters:{EnableInMobile:!0,PowerBIGroupId:this.props.powerBIGroupId,PowerBIDashboardId:this.props.powerBIDashboardId,TileId:this.props.powerBITileId,TileUrl:this.props.powerBIEmbedUrl,PowerBIType:this.props.powerBIComponentTypeCode?parseInt(this.props.powerBIComponentTypeCode,10):0,IsPowerBIEnabled:this.props.isPowerBIEnabled,FirstPartyIntegrationSiteUrl:this.props.firstPartyIntegrationSiteUrl}},this._CCF_config={FormFactor:2,CustomControlId:"MscrmControls.PowerBI.PowerBIControl",Name:name,Version:"1.0.0",Parameters:{value:{Usage:0,Type:h.a.PowerBI,ControlId:"PowerBIFullScreenPagePowerBIControl",EnableInMobile:!0,PowerBIGroupId:this.props.powerBIGroupId,PowerBIDashboardId:this.props.powerBIDashboardId,TileId:this.props.powerBITileId,TileUrl:this.props.powerBIEmbedUrl,PowerBIType:this.props.powerBIComponentTypeCode?parseInt(this.props.powerBIComponentTypeCode,10):0,IsPowerBIEnabled:this.props.isPowerBIEnabled,FirstPartyIntegrationSiteUrl:this.props.firstPartyIntegrationSiteUrl}},ShouldOverrideControlVisible:!1});const{commandBarStyle:e,commandManagerContainerStyle:t}=this._getCommandBarStyle(),r=[];r.push({Icon:"Refresh",DisplayText:Object(l.c)(this.props.resourceStrings,"Ribbon.Jewel.PowerBI.Refresh"),Id:"PBI-Refresh",execute:this._refresh(this.props.id)}),r.push({Icon:"OpenInPowerBI",DisplayText:Object(l.c)(this.props.resourceStrings,"Ribbon.Jewel.PowerBI.OpenInPowerBI"),Id:"PBI-OpenInPowerBI",execute:Object(x.b)(this.props.powerBIEmbedUrl,this.props.powerBIComponentTypeCode,this.props.powerBIGroupId,this.props.powerBIDashboardId,this.props.powerBITileId,this.props.powerBIReportId)}),"0"===this.props.powerBIComponentTypeCode&&this.props.powerBIReportUrl&&r.push({Icon:"OpenPowerBIReport",DisplayText:Object(l.c)(this.props.resourceStrings,"Ribbon.Jewel.PowerBI.OpenPowerBIReport"),Id:"PBI-OpenPowerBIReport",execute:this._openPowerBIReport(this.props.id,this.props.powerBIReportUrl,this.props.powerBIGroupId,this.props.powerBIReportId)});const n={display:"flex",flex:"1 1 auto"};return this.props.openAsDialog||Object.assign(n,{marginTop:this.props.theme.sizes.Measures.Measure150,marginLeft:this.props.theme.sizes.Measures.Measure150,marginRight:this.props.theme.sizes.Measures.Measure150,marginBottom:this.props.theme.sizes.Measures.Measure225,borderTop:`${this.props.theme.sizes.Measures.Measure025} solid ${this.props.theme.colors.BaseColor.Blue.Blue3}`}),y.createElement(v.a,{key:"powerbiRoot",id:"PowerBIView",style:{display:"flex",flexDirection:"column",flex:"1 1 auto"}},y.createElement(D,{containerStyle:t},y.createElement(S.a,{commandbarDisplayMode:I.a.IconLabel,key:this.props.id,addedCommandList:r,iconPosition:_.a.Left,id:this.props.id,width:this.props.viewPortWidth,ribbonId:null,commandBarStyle:e,commandManagerId:this.props.id})),y.createElement(v.a,{key:"powerBICustomControlContainer",id:"powerBICustomControlContainer",style:n},this._renderPowerBICustomControl()))}_getCommandBarStyle(){let e;this.props.openAsDialog?(e=Object(I.p)(this.props.isRTL,null),Object.assign(e.container,{marginLeft:"0px",marginRight:"0px"})):(e=Object(I.k)(this.props.isRTL,null),e.container.backgroundColor=this.props.theme.colors.MainThemeColor.MainColor1.Fill,e.listItemBody.text.color=this.props.theme.colors.BaseColor.White,e.listItemBody.button.color=this.props.theme.colors.BaseColor.White,e.listItemBody.text.maxWidth="0%",e.listItemBody.text.minWidth="100%");const t={display:"flex",flex:"1 1 auto",backgroundColor:this.props.theme.colors.BaseColor.Blue.Blue3,maxHeight:this.props.theme.sizes.Measures.Measure300};return Object(I.b)(this.props.commandBarRefreshProps,e,!1,t),{commandBarStyle:e,commandManagerContainerStyle:t}}_renderPowerBICustomControl(){const e={eventListeners:[{eventname:"onFilterPageFullLoad",eventhandler:[this._onFilterPageFullLoad.bind(this)]}]};return this._renderCount%2==0?y.createElement(v.a,{key:"powerBICustomControlContainer2",id:"powerBICustomControlContainer2",style:{display:"flex",flex:"1 1 auto"}},y.createElement(C.c,{key:"MscrmControls.PowerBI.PowerBIControl",controlId:"MscrmControls.PowerBI.PowerBIControl",id:this.props.id,configuration:this._CCF_config,descriptor:this._CCF_descriptor,parentDefinedControlProps:e})):y.createElement(C.c,{key:"MscrmControls.PowerBI.PowerBIControl",controlId:"MscrmControls.PowerBI.PowerBIControl",id:this.props.id,configuration:this._CCF_config,descriptor:this._CCF_descriptor,parentDefinedControlProps:e})}_onFilterPageFullLoad(){window.setTimeout(()=>{const e=document.getElementById("defaultDialogChromeCloseIconButton");e&&e.focus()},100)}}function D({children:e,containerStyle:t}){return Object(f.d)(w.b)?y.createElement(y.Fragment,null,e):y.createElement(v.a,{key:"commandManagerContainer",id:"commandManagerContainer",style:t},e)}const M=Object(f.a)((function(e,t){const r=function(e,t){return Object(u.a)(e,t.id)}(e,t),n=Object(A.b)(e),i=Object(I.s)()(e),a=Object(F.a)(e,N.Vc,N.h);return{powerBIEmbedUrl:r.powerBIEmbedUrl,powerBIGroupId:r.powerBIGroupId,powerBIDashboardId:r.powerBIDashboardId,powerBITileId:r.powerBITileId,powerBIReportId:r.powerBIReportId,powerBIReportUrl:r.powerBIReportUrl,powerBIComponentTypeCode:r.powerBIComponentTypeCode,isPowerBIEnabled:n.isPowerBIEnabled,firstPartyIntegrationSiteUrl:n.firstPartyIntegrationSiteUrl,resourceStrings:d(e),theme:Object(j.a)(e),isRTL:Object(P.g)(e),viewPortWidth:Object(E.c)(e),commandBarRefreshProps:i,openAsDialog:a}}))(k),R={powerBIEmbedUrl:"",powerBIGroupId:"",powerBIDashboardId:"",powerBITileId:"",powerBIReportId:"",powerBIReportUrl:"",powerBIComponentTypeCode:"",xrmReady:!1,powerBISignedInState:"NotSignedIn"};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function L(e=R,t){switch(t.type){case"initialize.powerBIFullScreen.page":return Object.freeze(Object.assign(Object.assign({},R),t.payload));case"xrmready.powerBIFullScreen":return Object.freeze(Object.assign(Object.assign({},e),t.payload));case T.a:return Object.freeze(Object.assign(Object.assign({},e),{powerBISignedInState:t.payload}));default:return e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class V{constructor(e){this._id=e,this._initializationAction=b(this._id)}getName(){return n.a}getId(){return this._id}getInitializationAction(){return this._initializationAction}getRootReducer(){return L}getRootComponent(){return M}getCloseAction(e){}}},L8zx:function(e,t,r){"use strict";r.d(t,"a",(function(){return K})),r.d(t,"b",(function(){return J}));var n=r("SAYH"),i=r("i1f0"),a=r("UqyN"),o=r("ABCl"),s=r("0nOn"),c=r("odYE"),l=r("hvSt"),u=r("5Oca"),d=r("CPoS"),p=r("qshH"),h=r("16wZ"),g=r("ZIjf");class m{constructor(e,t,r){const n="ClientApi.XrmProcessStep.constructor";t||Object(h.j)(n,"step"),r||Object(h.j)(n,"processManager"),e||Object(h.j)(n,"store"),this._step=t,this._processManager=r}isRequired(){const e="ClientApi.XrmProcessStep.isRequired";try{g.a.instance.reportCall(e);const t=this._step.get_isProcessRequired();return g.a.instance.reportSuccess(e),t}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}getAttribute(){const e="ClientApi.XrmProcessStep.getAttribute";try{if(g.a.instance.reportCall(e),!this._attribute){const e=this._step.get_Steps().get_item(0);this._attribute=!e||e.get_isSystemControl()?null:e.get_dataFieldName()}return g.a.instance.reportSuccess(e),this._attribute}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}getName(){const e="ClientApi.XrmProcessStep.getName";try{g.a.instance.reportCall(e);const t=this._step.get_Name();return g.a.instance.reportSuccess(e),t}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}getProgress(){const e="ClientApi.XrmProcessStep.getProgress";try{g.a.instance.reportCall(e);let t=4;if(this._step.get_Steps()&&this._step.get_Steps().get_item(0)){if(this._step.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep&&this._processManager){const e=this._processManager.getActionLog(new n.a(this._step.get_Id()));e&&(t=e.status),t=0}}return g.a.instance.reportSuccess(e),t}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}setProgress(e,t){const r="ClientApi.XrmProcessStep.setProgress";try{g.a.instance.reportCall(r);let n="invalid";switch(e){case 0:case 1:case 2:case 3:case 4:n=this._setProgressInternal(e,t)}return g.a.instance.reportSuccess(r),n}catch(e){throw p.a.getInstance().reportFailure(r,e),e}}_setProgressInternal(e,t){if(this._step.get_Steps()&&this._step.get_Steps().get_item(0)){if(this._step.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep){const r=this._processManager.UpdateActionLog(new n.a(this._step.get_Id()),e,t);if(r)return r}}return"invalid"}}var b=r("Sbn7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class y{constructor(e,t){this._processManager=t,null!=this._processManager&&this._processManager.shouldReInitializeNavigationBehavior()&&this._processManager.setBpfNavigationBehavior(this)}get allowCreateNew(){return g.a.instance.reportUsage("ClientApi.XrmProcessNavigationBehavior.getAllowCreateNew"),this._allowCreateNew}set allowCreateNew(e){const t="ClientApi.XrmProcessNavigationBehavior.setAllowCreateNew";try{g.a.instance.reportCall(t),this._allowCreateNew=e,null!=this._processManager&&this._processManager.setBpfNavigationBehavior(this),g.a.instance.reportSuccess(t)}catch(e){throw p.a.getInstance().reportFailure(t,e),e}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let f;class v{constructor(e,t,r,n,i){f=e,this._entityTypeName=r,this._activeStageId=n,this._stageStep=t,new y(e,i),i&&(this._processManager=i)}getCategory(){const e="ClientApi.XrmProcessStage.getCategory";try{g.a.instance.reportCall(e);const t=this._stageStep.get_stageCategory(),r={getValue(){let e=parseInt(t,10);return Number.isNaN(e)&&(e=-1),e}};return g.a.instance.reportSuccess(e),r}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}getId(){const e="ClientApi.XrmProcessStage.getId";try{g.a.instance.reportCall(e);const t=this._stageStep.get_Id();return g.a.instance.reportSuccess(e),t}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}getEntityName(){return g.a.instance.reportUsage("ClientApi.XrmProcessStage.getEntityName"),this._entityTypeName}getStatus(){const e="ClientApi.XrmProcessStage.getStatus";try{g.a.instance.reportCall(e);const t=this.getId()===this._activeStageId?"active":"inactive";return g.a.instance.reportSuccess(e),t}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}getName(){const e="ClientApi.XrmProcessStage.getName";try{g.a.instance.reportCall(e);const t=this._stageStep.get_Description();return g.a.instance.reportSuccess(e),t}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}getSteps(){const e="ClientApi.XrmProcessStage.getSteps";try{if(g.a.instance.reportCall(e),!this._steps&&(this._steps=new b.a(e),null!=this._stageStep.get_Steps()&&this._stageStep.get_Steps().get_Count()>0))for(let e=0;e<this._stageStep.get_Steps().get_Count();e++){const t=this._stageStep.get_Steps().get_item(e);if(t instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){const e=t.get_Steps().get_item(0);e&&(e instanceof Microsoft.Crm.Workflow.ObjectModel.ControlStep||e instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep||e instanceof Microsoft.Crm.Workflow.ObjectModel.FlowStep)&&this._steps.add(t.get_Id(),new m(f,t,this._processManager))}}return g.a.instance.reportSuccess(e),this._steps}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}getNavigationBehavior(){const e="ClientApi.XrmProcessStage.getNavigationBehavior";try{g.a.instance.reportCall(e);const t=this._processManager.getBpfNavigationBehavior();return g.a.instance.reportSuccess(e),t}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let C;class S{constructor(e,t,r,n,i){const a="ClientApi.XrmBusinessProcessFlow.constructor";t||Object(h.j)(a,"workflowStep"),n||Object(h.j)(a,"activeStageId"),i||Object(h.j)(a,"processManager"),e||Object(h.j)(a,"store"),Object(h.a)(r)&&Object(h.j)(a,"isRendered"),C=e,this._isRendered=r,this._workflowStep=t,this._activeStageId=n,this._processManager=i}getName(){const e="ClientApi.XrmBusinessProcessFlow.getName";try{g.a.instance.reportCall(e);const t=this._workflowStep.get_Name();return g.a.instance.reportSuccess(e),t}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}getId(){const e="ClientApi.XrmBusinessProcessFlow.getId";try{g.a.instance.reportCall(e);const t=this._workflowStep.get_Id();return g.a.instance.reportSuccess(e),t}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}isRendered(){return g.a.instance.reportUsage("ClientApi.XrmBusinessProcessFlow.isRendered"),this._isRendered}getStages(){const e="ClientApi.XrmBusinessProcessFlow.getStages";try{if(g.a.instance.reportCall(e),!this._stages){this._stages=new b.a(e);for(let e=0;e<this._workflowStep.get_Steps().get_Count();e++){const t=this._workflowStep.get_Steps().get_item(e);if(t instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep){const e=t;for(let t=0;t<e.get_Steps().get_Count();t++){const r=e.get_Steps().get_item(t);this._stages.add(r.get_Id(),new v(C,r,e.get_EntityLogicalName(),this._activeStageId,this._processManager))}}}}return g.a.instance.reportSuccess(e),this._stages}catch(t){throw p.a.getInstance().reportFailure(e,t),t}}}var I,_=r("1kth"),O=r("cZbt"),T=r("blB4"),j=r("UuJw");!function(e){e.success="success",e.invalid="invalid"}(I||(I={}));var P=r("r/aD"),E=r("iF9X"),x=r("37s6"),A=r("69Qu"),w=r("IaGr"),F=r("arV0"),N=r("2Ct/"),k=r("ycdb"),D=r("ruPX"),M=r("cfbi");let R;class L{constructor(e,t,r,i,a){this._clientApiExecutor=new s.a(e,"ClientApi.XrmProcessControlData.",r,t);const o=this._clientApiExecutor.getComponentName("constructor");r||Object(h.j)(o,"pageId"),i||Object(h.j)(o,"entity"),t||Object(h.j)(o,"contextToken"),e||Object(h.j)(o,"store"),R=e,this._pageId=r,this._entity=i;let l=!1;Object(P.d)(R.getState(),this._pageId,o,!0)&&(this._processManager=a,l=!0),this._contextToken=t;const u=i.getEntityReference();this._entityRef=new c.a(u.entityType,n.a.tryParseOrNull(u.id),u.name);const d=Object(P.b)(r,e.getState(),l);w.a.getInstance().eventManager.ReportComponentSuccess(o,d)}getActiveProcess(){const e="ClientApi.XrmProcessControlData.getActiveProcess";try{if(g.a.instance.reportCall(e),!Object(P.d)(R.getState(),this._pageId,e))return g.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getProcess();let r=null;if(t){const e=this._getProcessManager().getActiveStageId();r=new S(R,t,!0,e,this._getProcessManager())}return g.a.instance.reportSuccess(e),r}catch(t){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,r),t}}setStatus(e,t){const r="ClientApi.XrmProcessControlData.setStatus";try{if(g.a.instance.reportCall(r),!Object(P.d)(R.getState(),this._pageId,r))return void g.a.instance.reportSuccess(r);if(!e||this.getStatus()&&e===this.getStatus())return void g.a.instance.reportSuccess(r);let n;if(e===O.a.active)n=l.a.Active;else if(e===O.a.finished)n=l.a.Finished;else{if(e!==O.a.aborted)return void g.a.instance.reportSuccess(r);n=l.a.Aborted}this._getProcessManager().setStatus(n).then(()=>{this._callback(t,e,r),g.a.instance.reportSuccess(r)}).catch(t=>{const n=p.a.getInstance().getEventParameters(this._contextToken);return n.push({name:"newStatus",value:e}),Object(h.d)(R,t,r,n)})}catch(e){const t=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(r,e,null,t),e}}getStatus(){const e="ClientApi.XrmProcessControlData.getStatus";try{if(g.a.instance.reportCall(e),!Object(P.d)(R.getState(),this._pageId,e))return g.a.instance.reportSuccess(e),null;const t=this._convertToXrmProcessInstanceStatus(this._getProcessManager().getStatus());return g.a.instance.reportSuccess(e),t}catch(t){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,r),t}}getInstanceName(){const e="ClientApi.XrmProcessControlData.getInstanceName";try{if(g.a.instance.reportCall(e),!Object(P.d)(R.getState(),this._pageId,e))return g.a.instance.reportSuccess(e),null;let t=this._getProcessManager().getProcessInstanceName();if(!t){const e=Object(u.e)(R.getState(),this._entityRef);t=Object(d.c)(R.getState(),e)}return g.a.instance.reportSuccess(e),t}catch(t){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,r),t}}getInstanceId(){const e="ClientApi.XrmProcessControlData.getInstanceId";try{if(g.a.instance.reportCall(e),!Object(P.d)(R.getState(),this._pageId,e))return g.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getProcessInstanceId(),r=t?n.a.toString(t):null;return g.a.instance.reportSuccess(e),r}catch(t){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,r),t}}getProcessInstances(e){const t="ClientApi.XrmProcessControlData.getProcessInstances";try{if(g.a.instance.reportCall(t),!Object(P.d)(R.getState(),this._pageId,t)||Object(N.g)(R.getState()))return;"function"==typeof e&&this._getProcessManager().getProcessInstances().then(r=>{if(r&&r.value&&r.value.length>0){const n={};r.value.forEach(e=>{e.businessprocessflowinstanceid&&(n[e.businessprocessflowinstanceid]={CreatedOnDate:e.createdon?new Date(e.createdon):null,ProcessDefinitionID:e._processid_value,ProcessDefinitionName:e.name,ProcessInstanceID:e.businessprocessflowinstanceid,ProcessInstanceName:e.name,StatusCodeName:this._convertToXrmProcessInstanceStatus(e.Process_x002e_statuscode),CreatedOn:e.createdon?new Date(e.createdon).toLocaleDateString():"",ProcessDefintionID:e._processid_value,ProcessDefintionName:e.name})}),Object(o.c)(t,[],()=>{e(n)})}g.a.instance.reportSuccess(t)}).catch(e=>{const r=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(R,e,t+".getProcessInstances",r)})}catch(e){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,r),e}}setActiveProcess(e,t){this._clientApiExecutor.executeAsync("setActiveProcess",(r,i)=>{const a=n.a.tryParseOrNull(e),o=Object(F.m)(R.getState(),this._pageId);if(a&&n.a.equals(a,n.a.EMPTY)){if(o){const e=new c.a(this._entity.getEntityName(),n.a.EMPTY);return R.dispatch(Object(k.b)(!0,e)),w.a.getInstance().eventManager.ReportComponentSuccess(r,i),Promise.resolve().then(()=>(this._callback(t,I.success,r,i),Promise.resolve())).catch(e=>(this._callback(t,I.invalid,r,i),Promise.reject(e)))}return Promise.resolve().then(()=>(this._callback(t,I.invalid,r,i),Promise.resolve()))}if(!Object(P.d)(R.getState(),this._pageId,r,!0)||Object(N.g)(R.getState()))return Promise.resolve();let s=null;return s=o?Promise.resolve():this._getProcessManager().setActiveProcess(e),s.then(()=>{this._callback(t,I.success,r,i);const n=this.getActiveProcess();return n&&n.getId().toUpperCase()===e.toUpperCase()||this._reloadPage(r,this._getProcessManager().getCurrentFormEntity(),e),Promise.resolve()}).catch(e=>(this._callback(t,I.invalid,r,i),Promise.reject(e)))},[{name:"processId",value:e,isRequired:!0,expectedDataType:"guid"}])}setActiveProcessInstance(e,t){this._clientApiExecutor.executeAsync("setActiveProcessInstance",(r,n)=>!Object(P.d)(R.getState(),this._pageId,r)||Object(N.g)(R.getState())?Promise.resolve():this._getProcessManager().setActiveProcessInstance(e).then(i=>{this._callback(t,I.success,r,n);return this.getInstanceId()!==e&&this._reloadPage(r,this._getProcessManager().getCurrentFormEntity(),i,e),Promise.resolve()}).catch(e=>(this._callback(t,I.invalid,r,n),Promise.reject(e))),[{name:"processInstanceId",value:e,isRequired:!0,expectedDataType:"guid"}])}getEnabledProcesses(e){const t="ClientApi.XrmProcessControlData.getEnabledProcesses";try{if(g.a.instance.reportCall(t),!Object(P.d)(R.getState(),this._pageId,t,!0))return void g.a.instance.reportSuccess(t);const r=R.getState();if(Object(E.g)(r)&&Object(x.w)(r)&&!Object(A.b)(r)){const r={};return void("function"==typeof e&&Object(o.c)(t,[],()=>{e(r)}))}this._getProcessManager().getEnabledProcesses().then(r=>{const n={};r&&r.length>0&&r.forEach(e=>{n[e.workflowId]=e.name}),"function"==typeof e&&Object(o.c)(t,[],()=>{e(n)}),g.a.instance.reportSuccess(t)}).catch(e=>{const r=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(R,e,t+".getEnabledProcesses",r)})}catch(e){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,r),e}}switchProcess(){const e="ClientApi.XrmProcessControlData.switchProcess";try{if(g.a.instance.reportCall(e),!Object(P.d)(R.getState(),this._pageId,e)||Object(N.g)(R.getState()))return;this._getProcessManager().switchProcess(),g.a.instance.reportSuccess(e)}catch(t){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,r),t}}abandonProcess(){const e="ClientApi.XrmProcessControlData.abandonProcess";try{if(g.a.instance.reportCall(e),!Object(P.d)(R.getState(),this._pageId,e)||Object(F.m)(R.getState(),this._pageId))return void g.a.instance.reportSuccess(e);this._getProcessManager().abandonProcess().then(()=>{g.a.instance.reportSuccess(e)}).catch(t=>{const r=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(R,t,e+".abandonProcess",r)})}catch(t){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,r),t}}reactivateProcess(){const e="ClientApi.XrmProcessControlData.reactivateProcess";try{if(g.a.instance.reportCall(e),!Object(P.d)(R.getState(),this._pageId,e)||Object(F.m)(R.getState(),this._pageId))return void g.a.instance.reportSuccess(e);this._getProcessManager().reactivateProcess().then(()=>{g.a.instance.reportSuccess(e)}).catch(t=>{const r=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(R,t,e+".reactivateProcess",r)})}catch(t){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,r),t}}completeProcess(){const e="ClientApi.XrmProcessControlData.completeProcess";try{if(g.a.instance.reportCall(e),!Object(P.d)(R.getState(),this._pageId,e)||Object(F.m)(R.getState(),this._pageId))return void g.a.instance.reportSuccess(e);this._getProcessManager().completeProcess().then(()=>{g.a.instance.reportSuccess(e)}).catch(t=>{const r=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(R,t,e+".completeProcess",r)})}catch(t){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,r),t}}getActiveStage(){const e="ClientApi.XrmProcessControlData.getActiveStage";try{if(g.a.instance.reportCall(e),!Object(P.d)(R.getState(),this._pageId,e))return g.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getActiveStage();let r=null;return t&&(r=new v(R,t,this._getProcessManager().getCurrentFormEntity().etn,t.get_Id(),this._getProcessManager())),g.a.instance.reportSuccess(e),r}catch(t){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,r),t}}getActivePath(){const e="ClientApi.XrmProcessControlData.getActivePath";try{if(g.a.instance.reportCall(e),!Object(P.d)(R.getState(),this._pageId,e))return g.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getActivePathStages();let r=null;if(t){const n=this._getProcessManager().getActiveStageId(),i=new b.a(e);t.forEach(e=>{const t=e.get_parent().get_EntityLogicalName();i.add(e.get_stageId(),new v(R,e,t,n,this._getProcessManager()))}),r=i}return g.a.instance.reportSuccess(e),r}catch(t){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,r),t}}setActiveStage(e,t){const r="ClientApi.XrmProcessControlData.setActiveStage";try{if(g.a.instance.reportCall(r),this._entity.getIsDirty()||Object(F.m)(R.getState(),this._pageId))g.a.instance.reportSuccess(r),this._callback(t,T.a.dirtyForm,r);else{if(!Object(P.d)(R.getState(),this._pageId,r))return void g.a.instance.reportSuccess(r);this._getProcessManager().setActiveStage(e).then(()=>{this._callback(t,this._getStageInvalidReason(null),r),this._loadActiveStageEntity(r),g.a.instance.reportSuccess(r)}).catch(e=>{this._callback(t,e?this._getStageInvalidReason(e):j.a.invalid,r)})}}catch(e){const t=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(r,e,null,t),e}}moveNext(e){const t="ClientApi.XrmProcessControlData.moveNext";try{const r=!0;if(g.a.instance.reportCall(t),this._entity.getIsDirty()||Object(F.m)(R.getState(),this._pageId))g.a.instance.reportSuccess(t),this._callback(e,T.a.dirtyForm,t);else{if(!Object(P.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);if(this._getProcessManager().isCrossEntityNavigation(r))return this._callback(e,T.a.crossEntity,t),void g.a.instance.reportSuccess(t);this._getProcessManager().moveToNextStage().then(()=>{this._callback(e,this._getNavigationStatus(null),t),g.a.instance.reportSuccess(t)}).catch(r=>{const n=r?this._getNavigationStatus(r):T.a.invalid;if(this._callback(e,n,t),n===T.a.invalid){const e=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(R,r,t+".moveToNextStage",e)}g.a.instance.reportSuccess(t)})}}catch(e){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,r),e}}movePrevious(e){const t="ClientApi.XrmProcessControlData.movePrevious";try{const r=!0;if(g.a.instance.reportCall(t),this._entity.getIsDirty()||Object(F.m)(R.getState(),this._pageId))g.a.instance.reportSuccess(t),this._callback(e,T.a.dirtyForm,t);else{if(!Object(P.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);if(Object(N.g)(R.getState())&&this._getProcessManager().isCrossEntityNavigation(!r))return this._callback(e,T.a.crossEntity,t),void g.a.instance.reportSuccess(t);this._getProcessManager().moveToPreviousStage().then(()=>{this._callback(e,this._getNavigationStatus(null),t),this._loadActiveStageEntity(t),g.a.instance.reportSuccess(t)}).catch(r=>{const n=r?this._getNavigationStatus(r):T.a.invalid;if(this._callback(e,n,t),n===T.a.invalid){const e=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(R,r,t+".moveToPreviousStage",e)}g.a.instance.reportSuccess(t)})}}catch(e){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,r),e}}getSelectedStage(){const e="ClientApi.XrmProcessControlData.getSelectedStage";try{if(g.a.instance.reportCall(e),!Object(P.d)(R.getState(),this._pageId,e))return g.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getSelectedStage();let r=null;if(t){const e=this._getProcessManager().getActiveStageId();r=new v(R,t,this._getProcessManager().getCurrentFormEntity().etn,e,this._getProcessManager())}return g.a.instance.reportSuccess(e),r}catch(t){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,r),t}}addOnStageChange(e){const t="ClientApi.XrmProcessControlData.addOnStageChange";e||Object(h.j)(t,"handler");try{if(g.a.instance.reportCall(t),!Object(P.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(_.q)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,r),e}}addOnPreStageChange(e){const t="ClientApi.XrmProcessControlData.addOnPreStageChange";Object(h.g)(e,t,"handler");try{if(g.a.instance.reportCall(t),!Object(P.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(_.j)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,r),e}}removeOnStageChange(e){const t="ClientApi.XrmProcessControlData.removeOnStageChange";e||Object(h.j)(t,"handler");try{if(g.a.instance.reportCall(t),!Object(P.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(_.L)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,r),e}}removeOnPreStageChange(e){const t="ClientApi.XrmProcessControlData.removeOnPreStageChange";Object(h.g)(e,t,"handler");try{if(g.a.instance.reportCall(t),!Object(P.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(_.E)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,r),e}}addOnStageSelected(e){const t="ClientApi.XrmProcessControlData.addOnStageSelected";e||Object(h.j)(t,"handler");try{if(g.a.instance.reportCall(t),!Object(P.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(_.r)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,r),e}}removeOnStageSelected(e){const t="ClientApi.XrmProcessControlData.removeOnStageSelected";e||Object(h.j)(t,"handler");try{if(g.a.instance.reportCall(t),!Object(P.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(_.M)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,r),e}}addOnProcessStatusChange(e){const t="ClientApi.XrmProcessControlData.addOnProcessStatusChange";e||Object(h.j)(t,"handler");try{if(g.a.instance.reportCall(t),!Object(P.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(_.k)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,r),e}}addOnPreProcessStatusChange(e){const t="ClientApi.XrmProcessControlData.addOnPreProcessStatusChange";Object(h.g)(e,t,"handler");try{if(g.a.instance.reportCall(t),!Object(P.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(_.i)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,r),e}}removeOnProcessStatusChange(e){const t="ClientApi.XrmProcessControlData.removeOnProcessStatusChange";e||Object(h.j)(t,"handler");try{if(g.a.instance.reportCall(t),!Object(P.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(_.F)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,r),e}}removeOnPreProcessStatusChange(e){const t="ClientApi.XrmProcessControlData.removeOnPreProcessStatusChange";Object(h.g)(e,t,"handler");try{if(g.a.instance.reportCall(t),!Object(P.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(_.D)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,r),e}}_getStageInvalidReason(e){return e?e.stageInvalidReason||j.a.invalid:T.a.success}_getNavigationStatus(e){return e?e.navigationStatus||T.a.invalid:T.a.success}_convertToXrmProcessInstanceStatus(e){if(e){if(e===l.a.Active)return O.a.active;if(e===l.a.Finished)return O.a.finished;if(e===l.a.Aborted)return O.a.aborted}return null}_callback(e,t,r,n){const i=r+".Callback";n||(n=p.a.getInstance().getEventParameters(this._contextToken)),n.push({name:"Status",value:t}),Object(o.c)(i,n,()=>{"function"==typeof e&&e(t)})}_reloadPage(e,t,r,n){if(t){const i=Object(F.m)(R.getState(),this._pageId),a={entityTypeName:t.etn,id:i?void 0:t.id,processId:r,processInstanceId:n},o={target:"inline"};R.dispatch(Object(D.a)(M.a,a,this._pageId,o)).then(t=>{if(0!==t.status)return Object(h.d)(R,t.error,e+".navigateTo.INavigationFailure")}).catch(t=>Object(h.d)(R,t,e+".navigateTo."))}}_loadActiveStageEntity(e){const t=this._getProcessManager().getActiveStageEntityRef();t&&t.etn!==this._getProcessManager().getCurrentFormEntity().etn&&this._reloadPage(e,t,this.getActiveProcess().getId(),this.getInstanceId())}_getProcessManager(){return this._processManager||(this._processManager=Object(P.c)(this._processManager,R,this._pageId,"ClientApi.XrmProcessControlData.getProcessManager")),this._processManager}}var V=r("uNLT"),B=r("/q/W"),G=r("jRy5"),X=r("Uv1Y"),U=r("Fij2"),z=r("mIxf"),H=r("HhsT"),q=r("PUjk"),W=r("AE7n"),Y=r("P6DH");let Q;class K{constructor(e,t,r,n,i){this._entity=null;const a="ClientApi.XrmFormData.constructor";e||Object(h.j)(a,"store"),r||Object(h.j)(a,"pageId"),t||Object(h.j)(a,"contextToken"),n||Object(h.j)(a,"formContext"),Q=e,this._pageId=r,this._formContext=n,this._contextToken=t,this._entity=i}get entity(){return g.a.instance.reportUsage("ClientApi.XrmFormData.entity"),this._entity}get process(){const e="ClientApi.XrmFormData.process_get";try{const t=Object(N.f)(Q.getState());g.a.instance.reportCall(e);const r=!!this._process;if((!t&&!this._process||t)&&this._entity){const e=Object(F.g)(Q.getState(),this._pageId),t=Object(q.b)(this._pageId,e);this._entity&&(this._process=new L(Q,this._contextToken,this._pageId,this.entity,t))}g.a.instance.reportSuccess(e);const n=Object(P.a)(this._pageId,Q.getState(),r,!!this._entity);return w.a.getInstance().eventManager.ReportComponentSuccess(e,n),this._process}catch(t){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,r),t}}set process(e){const t=Object(P.a)(this._pageId,Q.getState(),!!this._process,!!this._entity);w.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmFormData.process_set",t),this._process=e}getEntity(){return g.a.instance.reportUsage("ClientApi.XrmFormData.getEntity"),this._entity}getIsDirty(){var e,t,r;const n="ClientApi.XrmFormData.getIsDirty";try{g.a.instance.reportCall(n);let i=!1;if(this._entity&&this._entity.getIsDirty())i=!0;else{for(let e=0;e<this.attributes.getLength();e++){const t=this.attributes.get(e);if("never"!==t.getSubmitMode()&&t.getIsDirty()){i=!0;break}}if(!i&&(null===(t=null===(e=this._formContext)||void 0===e?void 0:e.ui)||void 0===t?void 0:t.controls))for(let e=0;e<this._formContext.ui.controls.getLength();e++){const t=this._formContext.ui.controls.get(e);if("formcomponent"===t.getControlType()&&t.isLoaded()&&(null===(r=t.data)||void 0===r?void 0:r.getIsDirty())){i=!0;break}}}return g.a.instance.reportSuccess(n),i}catch(e){const t=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(n,e,null,t),e}}get attributes(){const e="ClientApi.XrmFormData.attributes";try{if(g.a.instance.reportCall(e),!this._unboundAttributes){this._unboundAttributes=new b.a(e);const t=Object(i.Oc)(Q.getState(),this._pageId);if(t)for(const e in t){const r=t[e],n=e,i=Object(a.b)(Q,this._contextToken,this._pageId,n,this.entity,this._formContext.ui,r);this._unboundAttributes.add(i.getName(),i)}}return g.a.instance.reportSuccess(e),this._unboundAttributes}catch(t){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(e,t,null,r),t}}_refreshEntity(e){return this.entity.refresh().then(()=>{Object(V.d)(Q.dispatch,this._contextToken,this._pageId),e&&Q.dispatch(Object(_.Q)(this._contextToken,this._pageId,3,this.entity)),Object(U.b)(this.entity)})}refresh(e){const t="ClientApi.XrmFormData.refresh";try{if(g.a.instance.reportCall(t),this.entity){const r=Object(i.kb)(Q.getState(),{id:this._pageId},this._contextToken);return!r&&e&&this.entity.getIsDirty()?this.save().then(e=>(g.a.instance.reportSuccess(t),{})).catch(e=>{const r=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(Q,e,t+".save",r)}):!r&&this.entity.getIsDirty()?Q.dispatch(Object(B.a)(this._pageId)).then(e=>{if(e)return this._refreshEntity(!0).then(()=>(g.a.instance.reportSuccess(t),{})).catch(e=>{const r=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(Q,e,t+".handleUnsavedChanges.refreshEntity",r)})}).catch(e=>{const r=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(Q,e,t+".handleUnsavedChanges",r)}):this._refreshEntity(!0).then(()=>(g.a.instance.reportSuccess(t),{})).catch(e=>{const r=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(Q,e,t+".handleUnsavedChanges.refreshEntity",r)})}const r=new X.a("Refresh action cannot be executed since form entity is null",2147746581);return w.a.getInstance().traceManager.getTracer(t).info("Refreshing on a non entity page"),Object(h.d)(Q,r,t+".entity")}catch(e){const r=p.a.getInstance().getEventParameters(this._contextToken);return Object(h.d)(Q,e,t,r)}}save(e){const t="ClientApi.XrmFormData.save",r=p.a.getInstance().getEventParameters(this._contextToken);if(!this._entity){const e=new X.a("Save action cannot be executed since form entity is null",2147746581);return Object(h.d)(Q,e,t+".entity")}try{g.a.instance.reportCall(t);let a=1;e&&e.saveMode&&(a=e.saveMode);return J(this._pageId,Q,a,r,this._contextToken,this.entity,!0,!0).then(e=>{if(e){const a={entityType:e.etn,id:n.a.toString(e.id),name:e.name};return Object(i.Kb)(Q.getState(),this._pageId)?(g.a.instance.reportSuccess(t),{savedEntityReference:a}):this._refreshEntity(!1).then(()=>(g.a.instance.reportSuccess(t),{savedEntityReference:a})).catch(e=>Object(h.d)(Q,e,t+".refresh",r))}if(Object(i.kb)(Q.getState(),{id:this._pageId},this._contextToken)||!this.entity.getIsDirty()){const e=this.entity.getEntityReference();return g.a.instance.reportSuccess(t),{savedEntityReference:e}}const a=new X.a("Save action was not executed and the form is dirty.",2147879192);return Object(h.d)(Q,a,t+".NoReference",null,!1)}).catch(e=>{if(e&&(2200000006===e.errorCode||2200000004===e.errorCode)){const e=this.entity.getEntityReference();return g.a.instance.reportSuccess(t),Promise.resolve({savedEntityReference:e})}return Object(h.d)(Q,e,t,r)})}catch(e){return Object(h.d)(Q,e,t,r)}}isValid(){var e,t,r;const n="ClientApi.XrmFormData.isValid";try{g.a.instance.reportCall(n);let i=!0;if(this.entity&&!this.entity.isValid())i=!1;else if(this.attributes)for(let e=0;e<this.attributes.getLength();e++)if(!this.attributes.get(e).isValid()){i=!1;break}if(i&&(null===(t=null===(e=this._formContext)||void 0===e?void 0:e.ui)||void 0===t?void 0:t.controls))for(let e=0;e<this._formContext.ui.controls.getLength();e++){const t=this._formContext.ui.controls.get(e);if("formcomponent"===t.getControlType()&&t.isLoaded()&&!(null===(r=t.data)||void 0===r?void 0:r.isValid())){i=!1;break}}return i||Q.dispatch(Object(z.b)(this._pageId,this._contextToken)),g.a.instance.reportSuccess(n),i}catch(e){const t=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(n,e,null,t),e}}addOnLoad(e){const t="ClientApi.XrmFormData.addOnLoad";e||Object(h.j)(t,"handler");try{g.a.instance.reportCall(t),Q.dispatch(Object(_.c)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,r),e}}removeOnLoad(e){const t="ClientApi.XrmFormData.removeOnLoad";e||Object(h.j)(t,"handler");try{g.a.instance.reportCall(t),Q.dispatch(Object(_.x)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=p.a.getInstance().getEventParameters(this._contextToken);throw p.a.getInstance().reportFailure(t,e,null,r),e}}}function J(e,t,r,a,o,s,c,l){const u=t.getState(),d=n.a.tryParseOrNull(s.getId());if(o.contextTokenType===G.a.GridRow){const r=[],n=Object(Y.T)(u,e,o.parentContextToken,o.parentContextToken.controlName);return s.attributes.forEach(e=>r.push(e.getName())),a.push({name:"functionName",value:"saveEmbeddedEntity"}),t.dispatch(Object(W.a)(e,s.getEntityName(),null==d?void 0:d.guid,null,r,null==n?void 0:n.guid,!1,o.parentContextToken))}if(Object(i.Kb)(u,e))return a.push({name:"functionName",value:"saveAndCloseFormDialogAction"}),t.dispatch(Object(H.a)(e));if(d&&!n.a.equals(d,n.a.EMPTY))return a.push({name:"functionName",value:"saveForm"}),t.dispatch(Object(V.e)(e,r));const p=Object(F.l)(t.getState(),e);return a.push({name:"functionName",value:"saveFormAndNavigate"}),t.dispatch(Object(V.f)(e,p,l,r,!1,c))}},LLfG:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="attribute.submitmode";function a(e,t,r,a){const o=Object(n.x)(t);return{type:i,payload:a,meta:{pageId:e,contextKey:o,dataFieldName:r}}}},MoY7:function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n=r("arV0"),i=r("xhhr"),a=r("dHD5"),o=r("odYE"),s=r("i1f0"),c=r("Lyxw"),l=r("3/02"),u=r("NjDY"),d=r("b8TU"),p=r("unFF"),h=r("bT7G"),g=r("WPtp"),m=r("SAYH"),b=r("6QGX"),y=r("uhZ3"),f=r("jq7Z"),v=r("zmL5"),C=r("5ZBI"),S=r("pEXn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class I{constructor(e){this.previousReturn={EnableInMobile:!1,PowerBIGroupId:"",PowerBIDashboardId:"",PowerBIReportId:"",PowerBIFilter:"",TileId:"",TileUrl:"",PowerBIType:0,IsPowerBIEnabled:!1,FirstPartyIntegrationSiteUrl:"",PowerBISignedInState:"",setPowerBISignedInState:j,beginSecureSessionForResource:j},this._propKey=e}linkToParameter(e,t){const r=t.setPowerBISignedInState;e.setPowerBISignedInState=e=>r(this._pageId,e);const n=t.beginSecureSessionForResource;e.beginSecureSessionForResource=n}retrievePowerBIObject(e,t,r,g){var m,b;this._pageId=t.id;const y=t.descriptor.Parameters,I=Object(i.b)(e),P=r.Parameters[this._propKey],E=Object(u.z)(e);let x,A,w;Object(c.c)(e,l.Wc)&&(A=y.PowerBIReportId,w=P.PowerBIReportId,y.PowerBIFilter&&(x=function(e,t,r){const{entityTypeName:i,id:c}=Object(n.g)(e,t),l=Object(a.j)(e,t),u=Object(s.ac)(e,t,l),d=new o.a(i,c);try{const t=JSON.parse(r);let n=t.Filter;const i=t.Alias;for(const t in i){const r=i[t],a=Object(h.d)(e,u,d,r),o=a&&T(a)||null;if(Array.isArray(o)){const e=o.map(e=>O(e,!1)).join(",");n=n.split(t).join(e)}else n=_(n,[{placeholder:`"${t}"`,value:O(o,!0)},{placeholder:`'${t}'`,value:null===o?O(o,!0):`'${encodeURIComponent(o)}'`},{placeholder:t,value:O(o,!1)}])}return n}catch(e){return void C.a.error(S.w,[{name:"errorCategory",value:"PowerBIFilter"},{name:"errorMessage",value:null==e?void 0:e.message},{name:"callstack",value:null==e?void 0:e.stack},{name:"filter",value:r}])}}(e,this._pageId,y.PowerBIFilter)));const F=Object(f.a)(e,this._pageId).powerBISignedInState,N=Object(v.b)(e,this._pageId),k=Object(d.c)(e),D=Object(p.a)(e);return this.previousReturn={EnableInMobile:"true"===(null===(m=P.EnableInMobile)||void 0===m?void 0:m.toString().toLowerCase())||"true"===(null===(b=y.EnableInMobile)||void 0===b?void 0:b.toString().toLowerCase()),PowerBIGroupId:P.PowerBIGroupId||y.PowerBIGroupId,PowerBIDashboardId:P.PowerBIDashboardId||y.PowerBIDashboardId,PowerBIReportId:w||A,PowerBIFilter:x,TileId:P.TileId||y.TileId,TileUrl:P.TileUrl||y.TileUrl,PowerBIType:parseInt(P.PowerBIType,10)||parseInt(y.Type,10)||0,IsPowerBIEnabled:I.isPowerBIEnabled,FirstPartyIntegrationSiteUrl:I.firstPartyIntegrationSiteUrl,PowerBISignedInState:F,Tenant:E,ForceMobile:k<=D.sizes.Breakpoints.DimensionS,FormId:N,setPowerBISignedInState:j,beginSecureSessionForResource:j},this.previousReturn}getLatestData(){return this.previousReturn}}function _(e,t,r=0){const{placeholder:n,value:i}=t[r],a=e.split(n),o=r+1;if(o<t.length)for(const e in a)a[e]=_(a[e],t,o);return e=a.join(i)}function O(e,t){if(!t&&(null==e?void 0:e.length)>0){const t=Number(e);if(!isNaN(t)&&t.toString()===e)return JSON.stringify(t)}return JSON.stringify(e)}function T(e){if(Object(g.i)(e))return e.valueString;if(Object(g.g)(e))return m.a.toString(e.id);if(Object(g.k)(e))return e.reference&&m.a.toString(e.reference.id);if(Object(g.j)(e))return!Object(y.a)(e.value)&&e.value.toString();if(Object(g.h)(e)){const t=Object(b.h)(e);if(t){return t.map(e=>m.a.toString(m.a.fromExternalGuid(e.id)))}}else if(Object(g.f)(e)&&e.innerValue)return T(e.innerValue)}function j(){throw new Error("Not Replaced")}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const P="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlPowerBISelector";function E(){return(e,t,r,n,i)=>{C.a.info(r.controlId+"."+P+": createGetPowerBIData started");const a=new I(e);return a.retrievePowerBIObject(t,r,n,i),C.a.info(r.controlId+"."+P+": createGetPowerBIData finished"),a}}},"N+Ya":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n="navigation.item.label";function i(e,t,r,i){return{type:n,payload:{label:r,currentLanguageId:i},meta:{pageId:e,navigationItemId:t}}}},Nse0:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o}));var n=r("BFlg"),i=r("Uv1Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="customcontrol.refreshCustomDataProvider";function o(e,t,r,o){return{type:"customcontrol.refreshCustomDataProvider.async",execute({dispatch:s,getState:c},l){const u=n.x+".refreshCustomDataProviderAction";return o().then(n=>(s(function(e,t,r,n){let i=new Array;n&&n.length>0&&(i=n.slice());return{type:a,payload:i,meta:{pageId:e,customControlId:t,dataSetParameterName:r}}}(e,t,r,n)),l.EventManager.ReportComponentSuccess(u),n)).catch(e=>(l.EventManager.ReportComponentFailure(u,Error(e)),Promise.reject(new i.a(e))))}}}},NtHU:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="header.bodyvisible";function a(e,t,r){const a=Object(n.v)(t);return{type:i,payload:r,meta:{pageId:e,contextKey:a}}}},PZ34:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("ruPX"),i=r("baQL");function a(e,t){return Object(n.a)(i.a,{},t,e)}},PbI6:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="tab.contentType";function a(e,t,r,a){const o=Object(n.v)(r);return{type:i,payload:a,meta:{pageId:e,tabId:t,contextKey:o}}}},Q1Tc:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return a}));var n=r("dHD5"),i=r("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="control.update.unboundOutputs";function o(e,t,r,o){return{type:"control.update.unboundOutputs.async",execute({dispatch:s,getState:c}){if(!Object.keys(o).length)return Promise.resolve();const l=c(),u=Object(i.a)(l,e);let d=!1;const p=Object(n.v)(r),h=Object.assign({},u.forms[p].controlUnboundOutputs);for(const e in o){const r=o[e],n=t+"."+e;h[n]!==r&&(h[n]=r,d=!0)}return d&&s(function(e,t,r){return{type:a,payload:{controlUnboundOutputs:r},meta:{pageId:e,contextKey:t}}}(e,p,h)),Promise.resolve()}}}},QXpm:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r("dHD5"),i=r("BFlg"),a=r("LAGg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="grid.toggleRollupView";const s=(e,t,r)=>function(e,t,r,o){return{type:"grid.toggleRollupView.async",execute({dispatch:s},c){const l=c.TraceManager.getTracer(i.z),u=i.x+".toggleRollupViewAction";try{l.info(`Setting Toggle value to ${t} for the grid.`);const i=Object(n.v)(o);s(function(e,t,r,n){return{type:e,payload:t,meta:{pageId:r,dataSetContextKey:n}}}(e,t,r,i)),s(Object(a.b)(r,o));const d=[{name:"newValue",value:t}];return c.EventManager.ReportComponentSuccess(u,d),Promise.resolve()}catch(e){const t="Setting Toggle value to the grid failed";c.EventManager.ReportComponentFailure(u,Error(t))}}}}(o,e,t,r)},Tg1Y:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="form.tab.selectPrevious";function a(e,t){const r=Object(n.v)(t);return{type:i,payload:null,meta:{pageId:e,contextKey:r}}}},TsER:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="refresh.timer";function a(e,t,r){const a=Object(n.x)(t);return{type:i,payload:null,meta:{pageId:e,contextKey:a,controlName:r}}}},UqyN:function(e,t,r){"use strict";r.d(t,"a",(function(){return ke})),r.d(t,"b",(function(){return De}));var n=r("0nOn"),i=r("SAYH"),a=r("WPtp"),o=r("odYE"),s=r("ZIjf"),c=r("LbMF"),l=r("UJfx"),u=r("bT7G"),d=r("mlKL"),p=r("LLfG"),h=r("i1f0"),g=r("BvQu"),m=r("Sbn7"),b=r("mIxf"),y=r("1kth"),f=r("16wZ"),v=r("qshH"),C=r("dHD5"),S=r("iZ7K"),I=r("3tOH"),_=r("z5LE"),O=r("3HPu"),T=r("jTSi"),j=r("jq7Z"),P=r("fU7K"),E=r("O7zD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const x="ClientApi.XrmEntityAttribute.";let A;class w{constructor(e,t,r,i,a,o){A=e,this._clientApiExecutorAttribute=new n.a(e,x,r,t),this._clientApiExecutorAttribute.addEventParameter({name:"attributeName",value:i,isEventParam:!0});const s=this._clientApiExecutorAttribute.getComponentName("constructor");i||Object(f.j)(s,"attributeName"),e||Object(f.j)(s,"store"),r||Object(f.j)(s,"pageId"),t||Object(f.j)(s,"contextToken"),o||Object(f.j)(s,"xrmFormUi"),this._attributeName=i,this._parentEntity=a,this._pageId=r,this.xrmFormUi=o,this._contextToken=t}get controls(){return this._clientApiExecutorAttribute.execute("controls",(e,t)=>{if(!this._controls){this._controls=new m.a(e);const t=Object(h.z)(A.getState(),this._pageId,this.contextToken,this._attributeName);if(t){this.xrmFormUi.getControls();const e=this.xrmFormUi.controls;for(let r=0;r<t.length;r++){const n=t[r],i=e.get(n);i&&this._controls.add(n,i)}}}return this._controls})}addOnChange(e){const t=x+"addOnChange";e||Object(f.j)(t,"handler");try{s.a.instance.reportCall(t),A.dispatch(Object(y.a)(this.contextToken,this._pageId,this.getName(),e)),s.a.instance.reportSuccess(t)}catch(e){const r=v.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(t,e,null,r),e}}fireOnChange(){const e=x+"fireOnChange";try{s.a.instance.reportCall(e),A.dispatch(Object(y.P)(this.contextToken,this._pageId,this.getName())),s.a.instance.reportSuccess(e)}catch(t){const r=v.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(e,t,null,r),t}}getAttributeType(){const e=x+"getAttributeType";try{s.a.instance.reportCall(e);const t=this.getAttrDescriptor().Type;return s.a.instance.reportSuccess(e),t}catch(t){const r=v.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(e,t,null,r),t}}getFormat(){return this._clientApiExecutorAttribute.execute("getFormat",()=>{const e=this.getAttrDescriptor();if(!e||!e.Format)return null;const t=e.Format.toLowerCase();let r=t;switch(this.getAttrDescriptor().Type){case"string":"text"===r||"email"===r||"phone"===r||"url"===r||"tickersymbol"===r||"1"!==t&&"2"!==t||(r="textarea");break;case"integer":"duration"!==r&&(r="none");break;case"lookup":"0"===t&&(r="none");break;case"memo":"2"!==t&&"1"!==t||(r="textarea");break;default:"0"===t?r="none":void 0===r&&(r=null)}return r})}getIsDirty(){const e=x+"getIsDirty";try{s.a.instance.reportCall(e);const t=Object(h.Jb)(A.getState(),this.getPageId(),this.dataContextToken,this.getName())&&Object(u.e)(A.getState(),Object(h.ac)(A.getState(),this.getPageId(),this.dataContextToken),this.getName());return s.a.instance.reportSuccess(e),t}catch(t){const r=v.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(e,t,null,r),t}}getName(){return s.a.instance.reportUsage(x+"getName"),this._attributeName}getParent(){return s.a.instance.reportUsage(x+"getParent"),this._parentEntity}getRequiredLevel(){const e=x+"getRequiredLevel";try{s.a.instance.reportCall(e);const t=Object(h.pc)(A.getState(),this._pageId,this.dataContextToken,this.getName());let r;switch(t){case 2:case 1:r="required";break;case-1:case 0:r="none";break;case 3:r="recommended";break;default:Object(f.h)(e,"RequiredLevel",t)}return s.a.instance.reportSuccess(e),r}catch(t){const r=v.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(e,t,null,r),t}}getSubmitMode(){const e=x+"getSubmitMode";try{s.a.instance.reportCall(e);const t=Object(h.zc)(A.getState(),this._pageId,this.contextToken,this.getName());let r;switch(t){case g.a.Dirty:r="dirty";break;case g.a.Always:r="always";break;case g.a.Never:r="never";break;default:Object(f.h)(e,"SubmitMode",t)}return s.a.instance.reportSuccess(e),r}catch(t){const r=v.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(e,t,null,r),t}}getUserPrivilege(){const e=x+"getUserPrivilege";try{s.a.instance.reportCall(e);let t=null;if(A.getState()&&this._parentEntity&&this._attributeName){const e=Object(l.a)(A.getState(),this._parentEntity.getEntityName(),i.a.fromExternalGuid(this._parentEntity.getId()),this._attributeName);e&&(t={canCreate:e.canCreate,canRead:e.canRead,canUpdate:e.canUpdate})}return s.a.instance.reportSuccess(e),t}catch(t){const r=v.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(e,t,null,r),t}}getValue(){const e=x+"getValue";try{s.a.instance.reportCall(e);const t=this.getValueInternal();let r=null;return Object(f.a)(t)||(Object(a.j)(t)?r=t.value:Object(f.k)(e,"isPlainValue","value")),s.a.instance.reportSuccess(e),r}catch(t){const r=v.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(e,t,null,r),t}}removeOnChange(e){const t=x+"removeOnChange";e||Object(f.j)(t,"handler");try{s.a.instance.reportCall(t),A.dispatch(Object(y.v)(this.contextToken,this._pageId,this.getName(),e)),s.a.instance.reportSuccess(t)}catch(e){const r=v.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(t,e,null,r),e}}setRequiredLevel(e){const t=x+"setRequiredLevel";e||Object(f.j)(t,"requiredLevel"),"none"!==e&&"recommended"!==e&&"required"!==e&&Object(f.h)(t,"RequiredLevel",e);try{let r;switch(s.a.instance.reportCall(t),e){case"none":r=0;break;case"recommended":r=3;break;case"required":r=2}A.dispatch(Object(d.b)(this._pageId,this.dataContextToken,this._attributeName,r)),s.a.instance.reportSuccess(t)}catch(e){const r=v.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(t,e,null,r),e}}setSubmitMode(e){const t=x+"setSubmitMode";e||Object(f.j)(t,"mode"),"dirty"!==e&&"always"!==e&&"never"!==e&&Object(f.h)(t,"SubmitMode",e);try{let r;switch(s.a.instance.reportCall(t),e){case"dirty":r=g.a.Dirty;break;case"always":r=g.a.Always;break;case"never":r=g.a.Never}A.dispatch(Object(p.b)(this._pageId,this.contextToken,this.getName(),r)),s.a.instance.reportSuccess(t)}catch(e){const r=v.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(t,e,null,r),e}}setValue(e){const t=x+"setValue";try{s.a.instance.reportCall(t),this.setValueInternal(e),s.a.instance.reportSuccess(t)}catch(e){const r=v.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(t,e,null,r),e}}setIsValid(e,t){return this._clientApiExecutorAttribute.execute("setIsValid",(r,n)=>{e?(A.dispatch(Object(O.b)(this._pageId,this._attributeName,!0,this.contextToken)),A.dispatch(Object(T.b)(this.contextToken,this._pageId,Object(E.d)(this._pageId,this._attributeName))),A.dispatch(Object(_.b)(A.getState(),this._pageId,this._attributeName,null,this.contextToken))):this._addNotification(t)})}_addNotification(e){A.dispatch(Object(O.b)(this._pageId,this._attributeName,!1,this.contextToken));const t={messages:[e],notificationLevel:I.a.error};A.dispatch(Object(_.b)(A.getState(),this._pageId,this._attributeName,t,this.contextToken))}isValid(){const e=x+"isValid";try{s.a.instance.reportCall(e);const t=this.getValueInternal(),r=this.getParent();if(r){const n=Object(S.h)(A.getState(),r.getEntityName());if(n&&n.PrimaryIdAttribute!==this.getName()&&r.getId()!==i.a.EMPTYSTRING&&"required"===this.getRequiredLevel()&&Object(f.a)(t))return s.a.instance.reportSuccess(e),!1}let n=!0;return this.hasErrorNotification()?n=!1:t&&t.validationResult&&(n=t.validationResult.isValueValid),s.a.instance.reportSuccess(e),n}catch(t){const r=v.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),v.a.getInstance().reportFailure(e,t,null,r),t}}hasErrorNotification(){const e=Object(C.v)(this.contextToken),t=A.getState(),r=Object(j.a)(t,this._pageId);if(r.forms&&r.forms[e]&&(r.forms[e].invalidControls||r.forms[e].invalidAttributes)){return!0===r.forms[e].invalidControls[this.getName()]||!0===r.forms[e].invalidAttributes[this.getName()]}return!1}getPageId(){return this._pageId}getAttrDescriptor(){if(this.getParent()){let e=Object(h.r)(A.getState(),this.getParent().getEntityName(),this.getName(),this._pageId,this.contextToken);return e||(e=Object(c.a)(A.getState(),this.getParent().getEntityName(),this.getName())),e}return Object(h.Nc)(A.getState(),this.getPageId(),this.getName())}getDataXmlInternal(){let e="";return e=e+"<"+Object(P.CrmXmlEncode)(this.getName())+">"+Object(P.CrmXmlEncode)(this.getValue())+"</"+Object(P.CrmXmlEncode)(this.getName())+">",e}setValueInternal(e){const t=this.getName(),r={};r[t]={fieldName:t,value:e},A.dispatch(Object(b.a)(this._pageId,r,!1,!0,this.getParent()?this.getParent().getEntityName():null,this.getParent()?this.getParent().getId():null,Object(C.t)(this._contextToken),this.contextToken))}get parentEntityReference(){let e,t;return this.getParent()?(e=this.getParent().getEntityName(),t=this.getParent().getId()):this.contextToken.formId&&(e=this.contextToken.formId.guid),t?new o.a(e,new i.a(t)):new o.a(e)}getValueInternal(){const e=Object(h.ac)(A.getState(),this.getPageId(),this.dataContextToken);return Object(h.X)(A.getState(),this._pageId,this._contextToken,e,this.parentEntityReference,this._attributeName,A.dispatch)}get contextToken(){return Object(C.r)(this._contextToken)}get dataContextToken(){return this._contextToken}}var F=r("5Oca"),N=r("6QGX");class k extends w{getOption(e){const t="ClientApi.XrmEntityAttributeOptionSetBase.getOption";if(Object(f.a)(e))return null;const r="number"==typeof e?e:parseInt(e,10);isNaN(r)&&Object(f.k)(t,"number","value");try{s.a.instance.reportCall(t);const r=this.getAttrDescriptor().OptionSet;let n=null;for(let t=0;t<r.length;t++)r[t].Value===e&&(n={text:r[t].Label,value:r[t].Value});return s.a.instance.reportSuccess(t),n}catch(e){throw v.a.getInstance().getEventParameters(this.contextToken).push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e),e}}getOptions(){const e="ClientApi.XrmEntityAttributeOptionSetBase.getOptions";try{s.a.instance.reportCall(e);const t=this.getAttrDescriptor().OptionSet.map(e=>({text:e.Label,value:e.Value}));return s.a.instance.reportSuccess(e),t}catch(t){throw v.a.getInstance().getEventParameters(this.contextToken).push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t),t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let D,M;class R extends k{constructor(e,t,r,n,i,a){super(e,t,r,n,i,a),D=e}getInitialValue(){const e="ClientApi.XrmEntityAttributeBoolean.getInitialValue";try{s.a.instance.reportCall(e);const t=Object(F.j)(D.getState(),this.parentEntityReference,this.getName()),r=t?parseInt(t.valueString,10):null;return s.a.instance.reportSuccess(e),r}catch(t){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}getValue(){const e="ClientApi.XrmEntityAttributeBoolean.getValue";try{s.a.instance.reportCall(e);const t=this.getValueInternal(),r=Object(N.a)(t);return s.a.instance.reportSuccess(e),r}catch(t){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}setValue(e){const t="ClientApi.XrmEntityAttributeBoolean.setValue";Object(f.a)(e)||"boolean"!=typeof e&&Object(f.k)(t,"boolean","value");try{s.a.instance.reportCall(t),this.setValueInternal(e),s.a.instance.reportSuccess(t)}catch(e){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,r),e}}getAttributeType(){return s.a.instance.reportUsage("ClientApi.XrmEntityAttributeBoolean.getAttributeType"),"boolean"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class L extends k{constructor(e,t,r,n,i,a){super(e,t,r,n,i,a),M=e}getInitialValue(){const e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getInitialValue";try{s.a.instance.reportCall(e);const t=Object(F.j)(M.getState(),this.parentEntityReference,this.getName()),r=Object(N.e)(t);return s.a.instance.reportSuccess(e),r}catch(t){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}getSelectedOption(){const e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getSelectedOption";try{s.a.instance.reportCall(e);let t=null;const r=this.getValue();return r&&(t=[],r.forEach(e=>{const r=this.getOption(e);r&&t.push(r)})),s.a.instance.reportSuccess(e),t}catch(t){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}getText(){const e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getText";try{s.a.instance.reportCall(e);let t=null;const r=this.getSelectedOption();return r&&(t=[],r.forEach(e=>{t.push(e.text)})),s.a.instance.reportSuccess(e),t}catch(t){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}getValue(){const e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getValue";try{s.a.instance.reportCall(e);const t=this.getValueInternal();let r=null;return t&&(r=Object(N.e)(t)),s.a.instance.reportSuccess(e),r}catch(t){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}getAttributeType(){return s.a.instance.reportUsage("ClientApi.XrmEntityAttributeMultiSelectOptionSet.getAttributeType"),"multiselectoptionset"}setValue(e){const t="ClientApi.XrmEntityAttributeMultiSelectOptionSet.setValue";try{s.a.instance.reportCall(t),Array.isArray(e)?this.setValueInternal(e):this.setValueInternal([]),s.a.instance.reportSuccess(t)}catch(e){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,r),e}}}var V=r("Xd5/"),B=r("xkcG"),G=r("MXaZ"),X=r("Ae6N");let U;class z extends w{constructor(e,t,r,n,i,a){super(e,t,r,n,i,a),U=e}getDataXmlInternal(){let e=this.getValue();null!==e&&(e=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes()));const t=Object(P.CrmXmlEncode)(this.getName());let r="";return r+=`<${t}>`,r+=""+(null===e?"":Object(P.CrmXmlEncode)(e.format("s"))),r+=`</${t}>`,r}getValue(){const e="ClientApi.XrmEntityAttributeDateTime.getValue";try{s.a.instance.reportCall(e);const t=this.getValueInternal();let r=null;if(Object(a.j)(t)&&!Object(f.a)(t.formatted)){const e=this.getAttrDescriptor();r=Object(N.b)(U.getState(),e,t)}return s.a.instance.reportSuccess(e),r}catch(t){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}_userSettings(){return this.xrmFormUi.formContext.context?this.xrmFormUi.formContext.context.userSettings:new B.a(U)}getUtcValue(){const e="ClientApi.XrmEntityAttributeDateTime.getUtcValue";try{s.a.instance.reportCall(e);const t=this.getValue();return s.a.instance.reportSuccess(e),t}catch(t){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}setValue(e){const t="ClientApi.XrmEntityAttributeDateTime.setValue";Object(f.a)(e)||"[object Date]"!==Object.prototype.toString.call(e)&&Object(f.k)(t,"Date","value");try{if(s.a.instance.reportCall(t),Object(f.a)(e))this.setValueInternal(e);else if("[object Date]"===Object.prototype.toString.call(e)){const t=new Date,r=this.getAttrDescriptor(),n=Object(V.z)(U.getState(),r),i=6e4*this._userSettings().getTimeZoneOffsetMinutes(),a=Object(G.o)(new Date(t.getFullYear(),t.getMonth(),t.getDate()),n.userSettings.timeZoneAdjusters)-Object(G.o)(e,n.userSettings.timeZoneAdjusters),o=6e4*e.getTimezoneOffset();let s=null;switch(n.controlAttributes.Behavior){case X.a.UserLocal:s=new Date(e.getTime()+o+i-a);break;default:s=new Date(e.getTime())}this.setValueInternal(s)}s.a.instance.reportSuccess(t)}catch(e){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,r),e}}setUtcValue(e){const t="ClientApi.XrmEntityAttributeDateTime.setUtcValue";try{s.a.instance.reportCall(t),this.setValue(e),s.a.instance.reportSuccess(t)}catch(e){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,r),e}}getAttributeType(){return s.a.instance.reportUsage("ClientApi.XrmEntityAttributeDateTime.getAttributeType"),"datetime"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let H;class q extends w{constructor(e,t,r,n,i,a){super(e,t,r,n,i,a),H=e}getIsPartyList(){return s.a.instance.reportUsage("ClientApi.XrmEntityAttributeLookup.getIsPartyList"),!1}getDataXmlInternal(){const e=this.getValue();let t="";if(null!==e&&e.length>0)t+=this.getLookupDataXml(this.getName(),e[0]);else{const e=Object(P.CrmXmlEncode)(this.getName());t+=`<${e}>`,t+=`</${e}>`}return t.toString()}getLookupDataXml(e,t){const r=Object(P.CrmXmlEncode)(e);let n="<"+r;const i=this.getEntityTypeCode(t.entityType);return i>0&&(n+=` type="${Object(P.CrmXmlAttributeEncode)(i.toString())}"`),t.entityType&&(n+=` typeName="${Object(P.CrmXmlAttributeEncode)(t.entityType)}"`),Object(f.a)(t.name)||(n+=` name="${Object(P.CrmXmlAttributeEncode)(t.name)}"`),n+=`>${Object(P.CrmXmlEncode)(t.id)}</${r}>`,n}getEntityTypeCode(e){return Object(S.p)(H.getState(),e)}setValue(e){const t="ClientApi.XrmEntityAttributeLookup.setValue";let r=null;if(e&&Array.isArray(e)&&e.length>0){let n;e.length>1?Object(f.k)(t,"LookupValue[] of size not more than one.","value"):e[0].entityType?e[0].id?i.a.tryParseOrNull(e[0].id)||Object(f.h)(t,"guid",e[0].id):Object(f.j)(t,"value[0].id"):Object(f.j)(t,"value[0].entityType");try{n=Object(h.Ob)(H.getState(),this.getPageId(),this.dataContextToken,this.getName())}catch(e){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t+".getLookupTargets",e,null,r),e}if(n&&!(n.indexOf(e[0].entityType)>-1)){const r=v.a.getInstance().getEventParameters(this.contextToken);r.push({name:"attributeName",value:this.getName()}),r.push({name:"actualValue",value:e[0].entityType}),Object(f.k)(t,"entityType","value[0].entityType",r)}try{s.a.instance.reportCall(t),n?n.indexOf(e[0].entityType)>-1&&(r=new o.a(e[0].entityType,new i.a(e[0].id),e[0].name),this.setValueInternal(r)):this.setValueInternal(r),s.a.instance.reportSuccess(t)}catch(e){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,r),e}}else this.setValueInternal(r)}getValue(){const e="ClientApi.XrmEntityAttributeLookup.getValue";try{s.a.instance.reportCall(e);const t=this.getValueInternal(),r=Object(N.d)(t);return s.a.instance.reportSuccess(e),r}catch(t){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}getAttributeType(){return s.a.instance.reportUsage("ClientApi.XrmEntityAttributeLookup.getAttributeType"),"lookup"}}var W=r("3c9R"),Y=r("IaGr");let Q;class K extends w{constructor(e,t,r,i,a,o){super(e,t,r,i,a,o),Q=e,this._clientApiExecutorAttributeNumber=new n.a(e,"ClientApi.XrmEntityAttributeNumber.",r,t,[{name:"attributeName",value:i,isEventParam:!0}])}getMax(){return this._clientApiExecutorAttributeNumber.execute("getMax",()=>this.getAttrDescriptor().MaxValue)}getMin(){return this._clientApiExecutorAttributeNumber.execute("getMin",()=>this.getAttrDescriptor().MinValue)}getPrecision(){return this._clientApiExecutorAttributeNumber.execute("getPrecision",()=>Object(h.k)(Q.getState(),this.getPageId(),this.dataContextToken,this.getName()))}setPrecision(e){return this._clientApiExecutorAttributeNumber.execute("setPrecision",(t,r)=>{"integer"===this.getAttributeType()&&Object(f.e)(t,"setPrecision is not valid on integer attributes",void 0,r);const n=Object(c.a)(Q.getState(),this.getParent().getEntityName(),this.getName());(e<0||e>n.Precision)&&(r.push({name:"metadataPrecision",value:n.Precision}),Object(f.h)(t,"precision",e.toString(),r)),Q.dispatch(Object(W.b)(this.getPageId(),this.dataContextToken,this.getName(),e))},[{name:"precision",value:e,isRequired:!0,expectedDataType:"number"}])}getValue(){return this._clientApiExecutorAttributeNumber.execute("getValue",()=>{const e=this.getValueInternal();return Object(N.f)(e,this.getAttributeType(),this.getPrecision())})}setValue(e){return this._clientApiExecutorAttributeNumber.execute("setValue",()=>{this.setValueInternal(e)},[{name:"value",value:e,expectedDataType:"number"}])}getAttributeType(){return this._clientApiExecutorAttributeNumber.execute("getAttributeType",(e,t)=>{const r=this.getAttrDescriptor().Type;switch(r){case"decimal":return"decimal";case"double":return"double";case"integer":return"integer";case"money":return"money";default:return t.push({name:"attributeType",value:r}),r?this._clientApiExecutorAttributeNumber.reportFailure(e,new Error("Unexpected number attribute type."),t):Y.a.getInstance().traceManager.getTracer(e).error("Number attribute type was not defined in metadata.",t),super.getAttributeType()}})}}var J=r("arV0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let Z;class $ extends k{constructor(e,t,r,n,i,a){super(e,t,r,n,i,a),Z=e}getInitialValue(){const e="ClientApi.XrmEntityAttributeOptionSet.getInitialValue";try{s.a.instance.reportCall(e);const t=Object(F.j)(Z.getState(),this.parentEntityReference,this.getName());let r;if(Object(J.m)(Z.getState(),this.getPageId())){const e=this.getAttrDescriptor();r=Object(N.g)(t)||e&&e.DefaultFormValue?e.DefaultFormValue:null}else r=Object(N.g)(t);return s.a.instance.reportSuccess(e),r}catch(t){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}getSelectedOption(){const e="ClientApi.XrmEntityAttributeOptionSet.getSelectedOption";try{s.a.instance.reportCall(e);const t=this.getOption(this.getValue());return s.a.instance.reportSuccess(e),t}catch(t){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}getText(){const e="ClientApi.XrmEntityAttributeOptionSet.getText";try{s.a.instance.reportCall(e);const t=this.getSelectedOption();let r=null;return t&&(r=t.text),s.a.instance.reportSuccess(e),r}catch(t){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}getValue(){const e="ClientApi.XrmEntityAttributeOptionSet.getValue";try{s.a.instance.reportCall(e);const t=this.getValueInternal(),r=Object(N.g)(t),n=Object(f.a)(r)?Object(N.f)(t,this.getAttributeType(),0):r;return s.a.instance.reportSuccess(e),n}catch(t){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}setValue(e){const t="ClientApi.XrmEntityAttributeOptionSet.setValue";e&&isNaN(e)&&Object(f.k)(t,"number","value");let r=!1;try{if(e&&this.getParent()){const t=this.getAttrDescriptor();for(const n in t.OptionSet)if(e===t.OptionSet[n].Value){r=!0;break}}else r=!0}catch(e){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t+".getAttributeDescriptor",e,null,r),e}r||Object(f.h)(t,"OptionSetValue",e);try{s.a.instance.reportCall(t),this.setValueInternal(e),s.a.instance.reportSuccess(t)}catch(e){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,r),e}}getAttributeType(){return s.a.instance.reportUsage("ClientApi.XrmEntityAttributeOptionSet.getAttributeType"),"optionset"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ee extends w{getMaxLength(){const e="ClientApi.XrmEntityAttributeString.getMaxLength";try{s.a.instance.reportCall(e);const t=this.getAttrDescriptor().MaxLength;return s.a.instance.reportSuccess(e),t}catch(t){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}getValue(){const e="ClientApi.XrmEntityAttributeString.getValue";try{s.a.instance.reportCall(e);const t=this.getValueInternal(),r=Object(N.i)(t);return s.a.instance.reportSuccess(e),r}catch(t){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}setValue(e){const t="ClientApi.XrmEntityAttributeString.setValue";Object(f.a)(e)||"string"!=typeof e&&Object(f.k)(t,"string","value");try{s.a.instance.reportCall(t),this.setValueInternal(e),s.a.instance.reportSuccess(t)}catch(e){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,r),e}}getAttributeType(){const e="ClientApi.XrmEntityAttributeString.getAttributeType";try{let t;s.a.instance.reportCall(e);const r=this.getAttrDescriptor().Type;switch(r){case"memo":t="memo";break;case"string":t="string";break;default:const n=v.a.getInstance().getEventParameters(this.contextToken);n.push({name:"attributeName",value:this.getName()}),n.push({name:"attributeType",value:r}),v.a.getInstance().reportFailure(e,new Error("Unexpected string attribute type."),null,n),t=super.getAttributeType()}return s.a.instance.reportSuccess(e),t}catch(t){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class te extends w{constructor(e,t,r,i,a,o){super(e,t,r,i,a,o),this._clientApiExecutor=new n.a(e,"ClientApi.XrmEntityAttributeUniqueIdentifier.",r,t),this._clientApiExecutor.addEventParameter({name:"attributeName",value:i,isEventParam:!0})}setValue(e){this._clientApiExecutor.execute("setValue",()=>{this.setValueInternal(i.a.tryParseOrNull(e))},[{name:"value",value:e,expectedDataType:"guid"}])}getValue(){return this._clientApiExecutor.execute("getValue",()=>{const e=this.getValueInternal();return Object(N.j)(e)})}getAttributeType(){return this._clientApiExecutor.execute("getAttributeType",()=>"string")}}var re=r("nVTU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let ne;class ie extends q{constructor(e,t,r,n,i,a){super(e,t,r,n,i,a),ne=e}getDataXmlInternal(){const e=Object(P.CrmXmlEncode)(this.getName()),t=this.getValue();let r="";return r+=`<${e}>`,t.forEach(e=>{r+="<activityparty>",r+=this.getLookupDataXml("partyid",e),r+="</activityparty>"}),r+=`</${e}>`,r.toString()}setValue(e){const t="ClientApi.XrmEntityAttributePartyList.setValue",r=v.a.getInstance().getEventParameters(this.contextToken);let n;r.push({name:"attributeName",value:this.getName()}),e&&(Array.isArray(e)||Object(f.k)(t,"LookupValue[]","value",r));const i=new Array;try{n=Object(h.Ob)(ne.getState(),this.getPageId(),this.dataContextToken,this.getName())}catch(e){throw v.a.getInstance().reportFailure(t+".getLookupTargets",e,null,r),e}e&&n&&(n.push("unresolvedaddress"),e.forEach(e=>{n.indexOf(e.entityType)>-1||(r.push({name:"entityType",value:e.entityType}),Object(f.e)(t,`LookupValue[] with invalid entity type. Entity type "${e.entityType}" is invalid.`,"LookupValue[] with invalid entity type",r))}));try{s.a.instance.reportCall(t),e?(n?e.forEach(e=>{n.indexOf(e.entityType)>-1&&i.push(new re.a(e.entityType,e.id,e.name))}):e.forEach(e=>{i.push(new re.a(e.entityType,e.id,e.name))}),this.setValueInternal(i)):this.setValueInternal([]),s.a.instance.reportSuccess(t)}catch(e){throw v.a.getInstance().reportFailure(t,e,null,r),e}}getValue(){const e="ClientApi.XrmEntityAttributePartyList.getValue";try{s.a.instance.reportCall(e);const t=this.getValueInternal(),r=Object(N.h)(t);return s.a.instance.reportSuccess(e),r}catch(t){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}getIsPartyList(){return s.a.instance.reportUsage("ClientApi.XrmEntityAttributePartyList.getIsPartyList"),!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ae extends w{constructor(e,t,r,i,a,o){super(e,t,r,i,a,o),this._clientApiExecutorAttributeFile=new n.a(e,"ClientApi.XrmEntityFile.",r,t,[{name:"attributeName",value:i,isEventParam:!0}])}getValue(){return this._clientApiExecutorAttributeFile.execute("getValue",()=>{const e=this.getValueInternal();return Object(N.c)(e)})}setValue(e){this._clientApiExecutorAttributeFile.execute("setValue",()=>{this.setValueInternal(e)})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let oe;class se extends w{constructor(e,t,r,n,i,a){super(e,t,r,n,i,a),oe=e}getValue(){const e="ClientApi.XrmEntityAttributeEntityName.getValue";try{s.a.instance.reportCall(e);const t=this.getValueInternal(),r=Object(c.a)(oe.getState(),this.getParent().getEntityName(),this.getName());let n=null;return r.IsEntityReferenceStored&&Object(a.j)(t)&&(n=t.value),s.a.instance.reportSuccess(e),n}catch(t){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}setValue(e){const t="ClientApi.XrmEntityAttributeEntityName.setvalue";Object(f.a)(e)||"string"==typeof e||Object(f.k)(t,"string","value");try{s.a.instance.reportCall(t),this.setValueInternal(e),s.a.instance.reportSuccess(t)}catch(e){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,r),e}}getAttributeType(){return s.a.instance.reportUsage("ClientApi.XrmEntityAttributeEntityName.getAttributeType"),"entityname"}}var ce=r("aOhN"),le=r("Pcet"),ue=r("WY/A"),de=r("qTme"),pe=r("Dea/"),he=r("NPZ3"),ge=r("bGh0"),me=r("srnJ"),be=r("Fij2"),ye=r("pF61"),fe=r("ruPX"),ve=r("cfbi"),Ce=r("P6DH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Se(e,t,r,n){const i=Object(h.z)(e,t,r,n,r.relationshipName);if(!i||0===i.length)return!0;for(let n=0;n<i.length;n++)if(!Object(h.t)(e,{controlName:i[n],id:t},r))return!0;return!1}function Ie(e,t,r,n,i,a){if(!Object(Ce.K)(e,t,r,n,null==a?void 0:a.id))return!1;const o=Object(Ce.y)(e,r,t);if(!i||!o)return!1;if(o&&0===o[n])return!1;if(null===i.ParentPicklistLogicalName)return!0;const s=Object(h.ac)(e,t,r),c=Object(h.X)(e,t,r,s,a,i.ParentPicklistLogicalName);return!(!c||!c.label)}var _e=r("jRy5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let Oe;class Te extends ${constructor(e,t,r,n,i,a){super(e,t,r,n,i,a),Oe=e}setValue(e){const t="ClientApi.XrmEntityAttributeDependentOptionSet.setValue";let r;try{s.a.instance.reportCall(t),r=this.contextToken.contextTokenType===_e.a.MainGrid||this.contextToken.contextTokenType===_e.a.SubGrid||this.contextToken.contextTokenType===_e.a.AssociatedGrid?Ie(Oe.getState(),this.getPageId(),this.contextToken,this.getName(),this.getAttrDescriptor(),this.parentEntityReference):Se(Oe.getState(),this.getPageId(),this.contextToken,this.getName()),s.a.instance.reportSuccess(t)}catch(e){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,r),e}r?super.setValue(e):Object(f.e)("ClientApi.XrmEntityAttributeDependentOptionSet.setValue","Can not execute setValue for dependent option set attribute since it is disabled.")}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let je;class Pe extends L{constructor(e,t,r,n,i,a){super(e,t,r,n,i,a),je=e}setValue(e){const t="ClientApi.XrmEntityAttributeMultiSelectDependentOptionSet.setValue";let r;try{s.a.instance.reportCall(t),r=this.contextToken.contextTokenType===_e.a.MainGrid||this.contextToken.contextTokenType===_e.a.SubGrid||this.contextToken.contextTokenType===_e.a.AssociatedGrid?Ie(je.getState(),this.getPageId(),this.contextToken,this.getName(),this.getAttrDescriptor(),this.parentEntityReference):Se(je.getState(),this.getPageId(),this.contextToken,this.getName()),s.a.instance.reportSuccess(t)}catch(e){const r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),v.a.getInstance().reportFailure(t,e,null,r),e}r?super.setValue(e):Object(f.e)(t,"Can not execute setValue for dependent option set attribute since it is disabled.")}}var Ee=r("3/02"),xe=r("Lyxw"),Ae=r("QHx/"),we=r("L8zx"),Fe=r("Exmh");let Ne;class ke{constructor(e,t,r,i,a,o,s,c){Ne=e;const l=[{name:"pageId",value:r,isEventParam:!0,isRequired:!0,expectedDataType:"string"},{name:"entityType",value:a,isEventParam:!0,isRequired:!1,expectedDataType:"string"},{name:"store",value:e,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"xrmForm",value:i,isRequired:!0}];this._clientApiExecutor=new n.a(e,"ClientApi.XrmEntity.",r,t,l),this._pageId=r,this._xrmForm=i,this._contextToken=t,this._entityType=a,this._entityId=o,this._getAttributeNames=s,this._applicationContext=c}get attributes(){return this._clientApiExecutor.execute("attributes",(e,t)=>{if(!this._attributes){this._attributes=new m.a(e);const r=this._getAttributeNames(this._applicationContext,this._contextToken,this._pageId);if(!r)return this._clientApiExecutor.reportFailure(e,new Error("Entity attribute names array was null or undefined"),t),this._attributes;0===r.length&&this._clientApiExecutor.reportFailure(e,new Error("Entity attribute names array was empty."),t),r.forEach(e=>{const t=Object(c.a)(Ne.getState(),this.getEntityName(),e);if(t){const r=De(Ne,this._contextToken,this._pageId,e,this,this._xrmForm.ui,t);this._attributes.add(e,r)}})}return this._attributes})}get relatedEntities(){const e="ClientApi.XrmEntity.relatedEntities";try{if(s.a.instance.reportCall(e),!this._relatedEntities){this._relatedEntities=new m.a(e);const t=Object(h.oc)(Ne.getState(),{id:this._pageId},this._contextToken);for(const e in t)if(t[e]){const r=Object(C.m)(this._contextToken,e),n=new ke(Ne,r,this._pageId,this._xrmForm,t[e].etn,t[e].id,this._getAttributeNames,this._applicationContext);this._relatedEntities.add(e,n),this._updateControl(n,e)}const r=Object(h.nc)(Ne.getState(),{id:this._pageId}),n={};for(const e in r){const t=r[e];n[t.referencingAttribute]||(n[t.referencingAttribute]={}),n[t.referencingAttribute][t.referencedEntity]=e}for(const e in n)Ne.dispatch(Object(y.a)(this._contextToken,this._pageId,e,t=>{for(const t in n[e]){const r=this._relatedEntities.get(n[e][t]);r&&this._relatedEntities.remove(r)}const r=t.getEventSource().getValue();if(r&&r.length>0){const t=r[0],a=n[e][t.entityType],o=Object(C.m)(this._contextToken,a),s=new ke(Ne,o,this._pageId,this._xrmForm,t.entityType,i.a.tryParse(t.id),this._getAttributeNames,this._applicationContext);this._relatedEntities.add(a,s),this._updateControl(s,a)}},!0))}return s.a.instance.reportSuccess(e),this._relatedEntities}catch(t){const r=v.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}_updateControl(e,t){this._xrmForm&&this._xrmForm.ui&&this._xrmForm.ui.controls&&this._xrmForm.ui.controls.forEach(r=>{r instanceof ge.a&&r.updateAttribute(e,t)})}addOnSave(e){const t="ClientApi.XrmEntity.addOnSave";e||Object(f.j)(t,"handler");try{s.a.instance.reportCall(t),Ne.dispatch(Object(y.o)(this._contextToken,this._pageId,e)),s.a.instance.reportSuccess(t)}catch(e){const r=v.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),v.a.getInstance().reportFailure(t,e,null,r),e}}getDataXml(){const e="ClientApi.XrmEntity.getDataXml";try{s.a.instance.reportCall(e);let t="";return this.attributes.forEach(e=>{e.getIsDirty()&&(t+=e.getDataXmlInternal())}),t="<"+Object(P.CrmXmlEncode)(this.getEntityName())+">"+t+"</"+Object(P.CrmXmlEncode)(this.getEntityName())+">",s.a.instance.reportSuccess(e),t}catch(t){const r=v.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}getEntityReference(){const e="ClientApi.XrmEntity.getEntityReference";try{s.a.instance.reportCall(e);const t={entityType:this.getEntityName(),id:this.getId(),name:this.getPrimaryAttributeValue()};return s.a.instance.reportSuccess(e),t}catch(t){const r=v.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}getEntityName(){const e="ClientApi.XrmEntity.getEntityName";try{return s.a.instance.reportCall(e),s.a.instance.reportSuccess(e),this._entityType}catch(t){const r=v.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}getId(){const e="ClientApi.XrmEntity.getId";try{if(s.a.instance.reportCall(e),!this._entityId||this._entityId&&this._entityId.guid===i.a.EMPTYGUIDSTRING){const e=Object(J.i)(Ne.getState(),this._pageId);if(e&&e.value){const t=e.value;this._entityId=t.id}else{const e=Object(h.ac)(Ne.getState(),this._pageId,this._contextToken);if(e){const t=Object(u.b)(Ne.getState(),e);t&&t.identifier&&(this._entityId=t.identifier.id)}}}return this._entityId&&this._entityId.guid===i.a.EMPTYGUIDSTRING?(s.a.instance.reportSuccess(e),i.a.EMPTYSTRING):(s.a.instance.reportSuccess(e),i.a.externalGuid(this._entityId))}catch(t){const r=v.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}getPrimaryAttributeValue(){return this._clientApiExecutor.execute("getPrimaryAttributeValue",(e,t)=>{let r="";const n=Object(S.h)(Ne.getState(),this.getEntityName());if(n){if(!n.PrimaryNameAttribute)return r="PrimaryNameAttribute was not defined",Y.a.getInstance().traceManager.getTracer(e).error(r,t),"";{const e=Object(h.ac)(Ne.getState(),this._pageId,this._contextToken),t=this.getId()?new o.a(this.getEntityName(),new i.a(this.getId())):new o.a(this.getEntityName()),s=Object(h.X)(Ne.getState(),this._pageId,this._contextToken,e,t,n.PrimaryNameAttribute);if(!s)return"";if(Object(a.j)(s))return s.value;r="PrimaryAttribute value was not an IPlainValue"}}else r="Entity descriptor could not be retrieved.";return v.a.getInstance().reportFailure(e,new Error(r),null,t),""})}getIsDirty(){const e="ClientApi.XrmEntity.getIsDirty";try{s.a.instance.reportCall(e);for(let t=0;t<this.attributes.getLength();t++){const r=this.attributes.get(t);if("never"!==r.getSubmitMode()&&r.getIsDirty())return s.a.instance.reportSuccess(e),!0}for(let t=0;t<this.relatedEntities.getLength();t++){if(this.relatedEntities.get(t).getIsDirty())return s.a.instance.reportSuccess(e),!0}return s.a.instance.reportSuccess(e),!1}catch(t){const r=v.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}removeOnSave(e){const t="ClientApi.XrmEntity.removeOnSave";e||Object(f.j)(t,"handler");try{s.a.instance.reportCall(t),Ne.dispatch(Object(y.J)(this._contextToken,this._pageId,e)),s.a.instance.reportSuccess(t)}catch(e){const r=v.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),v.a.getInstance().reportFailure(t,e,null,r),e}}save(e){this._clientApiExecutor.executeAsync("save",(t,r)=>{let n=1;if(e)if("string"==typeof e)switch(e){case"save":n=1;break;case"saveandclose":n=2;break;case"saveandnew":n=59}else e.saveMode&&(n=e.saveMode);const i=Ne.getState();return Object(we.b)(this._pageId,Ne,n,r,this._contextToken,this,!1,"saveandclose"!==e).then(t=>this._performAfterSaveLogic(i,t,e))})}isValid(){const e="ClientApi.XrmEntity.isValid";try{if(s.a.instance.reportCall(e),this.attributes)for(let t=0;t<this.attributes.getLength();t++){const r=this.attributes.get(t);if(this._attributeHasActiveControl(r)&&!r.isValid()||r.hasErrorNotification())return s.a.instance.reportSuccess(e),!1}if(this.relatedEntities)for(let t=0;t<this.relatedEntities.getLength();t++)if(!this.relatedEntities.get(t).isValid())return s.a.instance.reportSuccess(e),!1;return s.a.instance.reportSuccess(e),!0}catch(t){const r=v.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),v.a.getInstance().reportFailure(e,t,null,r),t}}setRecordId(e){const t="ClientApi.XrmEntity.setRecordId";e||Object(f.j)(t,"id");try{if(s.a.instance.reportCall(t),this.getId()&&this._entityId.guid!==i.a.EMPTYGUIDSTRING)s.a.instance.reportSuccess(t);else{const r=i.a.tryParse(e);i.a.isNullOrEmpty(r)&&Object(f.j)(t,"id");const n={},a=Ne.getState(),c=Object(h.ac)(a,this._pageId,this._contextToken),l=Object(C.x)(this._contextToken);if(c){const e=new o.a(this.getEntityName(),r);Ne.dispatch(Object(le.b)(c,e)),s.a.instance.reportSuccess(t)}else{const e=Object(ue.b)(a,new o.a(this.getEntityName(),r),n,l,pe.a.Create),i=e.payload.snapshotId;Ne.dispatch(e),Ne.dispatch(Object(de.b)(this._pageId,i,this._contextToken)).then(()=>{s.a.instance.reportSuccess(t)}).catch(e=>{const r=v.a.getInstance().getEventParameters(this._contextToken);r.push({name:"entityName",value:this.getEntityName()}),v.a.getInstance().reportFailure(t+".setDataSnapshotId",e,null,r)})}}}catch(e){const r=v.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),v.a.getInstance().reportFailure(t,e,null,r),e}}refresh(){const e="ClientApi.XrmEntity.refresh";try{if(s.a.instance.reportCall(e),this.getId()){const t=new o.a(this.getEntityName(),new i.a(this.getId())),r=[],n=[];for(let e=0;e<this.attributes.getLength();e++)n.push(this.attributes.get(e).getName());const a=Object(he.a)(Ne.getState(),t.etn);if(a&&n.push(...a),r.push(Ne.dispatch(Object(me.a)(this._pageId,t,n,new Fe.a(o.a.toLegacyEntityReference(t),null,null)))),this.relatedEntities)for(let e=0;e<this.relatedEntities.getLength();e++)r.push(this.relatedEntities.get(e).refresh());return Promise.all(r).then(()=>{Object(be.b)(this),s.a.instance.reportSuccess(e)}).catch(t=>{const r=v.a.getInstance().getEventParameters(this._contextToken);return r.push({name:"entityName",value:this.getEntityName()}),Object(f.d)(Ne,t,e,r)})}return s.a.instance.reportSuccess(e),Promise.resolve(null)}catch(t){const r=v.a.getInstance().getEventParameters(this._contextToken);return r.push({name:"entityName",value:this.getEntityName()}),Object(f.d)(Ne,t,e,r)}}_attributeHasActiveControl(e){if(e&&e.controls){const t=e.controls.getLength();for(let r=0;r<t;r++)if(!e.controls.get(r).getDisabled())return!0}return!1}_performAfterSaveLogic(e,t,r){const n=Object(h.kb)(Ne.getState(),{id:this._pageId},this._contextToken);if(t||!this.getIsDirty()||n)if(Object(be.b)(this),"saveandclose"===r){if(!Object(be.a)(Object(ye.b)(Ne.getState())===this._pageId)){const t=Object(h.Kb)(e,this._pageId),r=Object(h.Ib)(e,this._pageId);if(!t&&!r){const e=Object(Ae.a)(Ne.getState(),this._pageId);return Ne.dispatch(Object(ce.b)(e))}}}else if("saveandnew"===r){const e={entityTypeName:this.getEntityName()};return Ne.dispatch(Object(fe.a)(ve.a,e,this._pageId))}return Promise.resolve()}}function De(e,t,r,n,i,a,o){let s=null,l=!1;switch(o.Type){case"datetime":s=new z(e,t,r,n,i,a);break;case"decimal":case"double":case"integer":case"money":s=new K(e,t,r,n,i,a);break;case"lookup":case"owner":case"customer":s=new q(e,t,r,n,i,a);break;case"partylist":s=new ie(e,t,r,n,i,a);break;case"memo":case"string":s=new ee(e,t,r,n,i,a);break;case"picklist":if(l=Object(xe.c)(e.getState(),Ee.L),l&&Object(c.l)(e.getState(),o.EntityLogicalName,n)){s=new Te(e,t,r,n,i,a);break}case"optionset":case"state":case"status":s=new $(e,t,r,n,i,a);break;case"boolean":s=new R(e,t,r,n,i,a);break;case"entityname":s=new se(e,t,r,n,i,a);break;case"uniqueidentifier":s=new te(e,t,r,n,i,a);break;case"multiselectpicklist":l=Object(xe.c)(e.getState(),Ee.L),s=l&&Object(c.l)(e.getState(),o.EntityLogicalName,n)?new Pe(e,t,r,n,i,a):new L(e,t,r,n,i,a);break;case"file":s=new ae(e,t,r,n,i,a);break;default:s=new w(e,t,r,n,i,a)}return s}},Utin:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return a}));var n=r("dHD5"),i=r("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="control.update.parameter";function o(e,t,r,o,s){return{type:"control.update.parameter.async",execute({dispatch:c,getState:l},u){const d=i.x+".updateControlParameterAction";c(function(e,t,r,o,s){const c=Object(n.v)(s);return{type:a,payload:{name:r,value:o},meta:{pageId:e,dataSetContextKey:c,controlName:i.o}}}(e,0,r,o,s));const p=[];return p.push({name:"controlName",value:t}),p.push({name:"paramName",value:""+r}),u.EventManager.ReportComponentSuccess(d,p),Promise.resolve()}}}},VpHT:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r("NjDY"),i=r("99zj"),a=r("V6aM"),o=r("3mEc"),s=r("69Qu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c=["JQUERY","JQUERY.JS"];let l,u,d;function p(e){return{type:"customcontrol.loadresources",execute({dispatch:t,getState:r},p){const h=[],g=r(),m=Object(n.t)(g),b=e.Properties.Resources.filter((e,t,r)=>(0===e.Type||4===e.Type||1===e.Type)&&!(e.LibraryName&&-1!==c.indexOf(e.LibraryName.toUpperCase())||p.AssetLoader.isResourceLoaded(m+e.Name))).sort((e,t)=>e.LoadOrder-t.LoadOrder),y=e.Properties.Resources.filter((e,t,r)=>5===e.Type);if(b.length>0){let e;const r=()=>function(e,t,r,n,i){const o=[];for(let s=0;s<i.length;s++){const c=i[s];let u,d=c.Name,p=r;if(l&&l[c.Name])p=window.__public_path__+"control",d=l[c.Name];else if(0===c.Type){const e=c.LibraryName+".js";l&&l[e]&&(p=window.__public_path__+"control",d=l[e])}switch(c.Type){case 0:case 4:u=n.loadWebResource(d,p,3,t=>e(Object(a.a)(t)),t,!1);break;case 1:u=u=n.loadWebResource(d,p,2,t=>e(Object(a.a)(t)),t);break;default:u=null}u&&o.push(u)}return Promise.all(o)}(t,!Object(s.b)(g),m,p.AssetLoader,b);e=!function(){null==d&&(d=window.location.search.toLocaleLowerCase().indexOf("uselocal=true")>=0);return d}()||l?r():function(){if(u)return u;if("/uclient/"!==window.__public_path__){if(!l){const e=window.__public_path__+"controlFileMap.json";u=-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0?new Promise(t=>{const r=new XMLHttpRequest;r.addEventListener("load",(function(){let e={};try{e=JSON.parse(this.responseText)}catch(e){}t(e)})),r.addEventListener("error",()=>{t({})}),r.open("GET",e),r.send()}):fetch(e).then(e=>e.json(),()=>Promise.resolve({})),u.then(e=>{l=e},()=>{l={}})}}else l={},u=Promise.resolve({});return u}().then(r,r),e&&h.push(e)}const f=Object(o.k)(g);for(let e=0;e<y.length;e++)if(!f||!f.hasOwnProperty(y[e].Name)){const r=t(Object(i.c)(y[e].Name)).then(r=>{let n=!1;for(const t of r)t&&t.webResourceDescriptorsByName&&t.webResourceDescriptorsByName.hasOwnProperty(y[e].Name)&&(n=!0);!n&&t(Object(i.b)(y[e].Name))});h.push(r)}return h.length>0?Promise.all(h):null},sync:!0}}},"WK+4":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o}));var n=r("dHD5"),i=r("BFlg");const a="chart.visualizationid.update";function o(e,t,r){return{type:"chart.visualizationid.update.async",execute({dispatch:o,getState:s},c){const l=c.TraceManager.getTracer(i.z),u=i.x+".updateVisualizationIdAction";try{l.info("Updating the chart visualization id"),t||(t=Object(n.k)(s(),e));const i=Object(n.v)(t);return o(function(e,t,r){return{type:a,payload:{name:"VisualizationId",value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,i,r)),c.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){const t="Updatation of the chart visualization id failed with error : "+e.message;c.EventManager.ReportComponentFailure(u,Error(t))}}}}},Wdaq:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o}));var n=r("dHD5"),i=r("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="grid.setCommandManagerId";function o(e,t,r){return{type:"grid.setCommandManagerId.async",execute({dispatch:o,getState:s},c){const l=c.TraceManager.getTracer(i.z),u=i.x+".setCommandManagerIdAction";try{l.info("Updating the command manager id for the grid.");const i=Object(n.v)(r);return o(function(e,t,r){return{type:a,payload:t,meta:{pageId:e,dataSetContextKey:r}}}(e,t,i)),c.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){const t="Updating the command manager id for the grid failed with error : "+e.message;c.EventManager.ReportComponentFailure(u,Error(t))}}}}},Yexl:function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return b}));var n=r("3/02"),i=r("SAYH"),a=r("P6DH"),o=r("Lyxw"),s=r("B9jE"),c=r("jRy5"),l=r("a72m"),u=r("KBcj"),d=r("d0w6"),p=r("BFlg"),h=r("hSDL"),g=r("jAuy");function m(e,t,r,m){return{type:"grid.quickfind.apply.async",execute({dispatch:b,getState:y},f){const v=f.TraceManager.getTracer(p.z),C=p.x+".QuickFilterAction";try{const p=y(),S=Object(a.F)(p,t,r,m);return function(e,t,r){return new Promise(n=>{const i=Object(u.a)(e,r,d.a.QUICKFIND_SEARCH);i?n(i):t(Object(l.a)(r,d.a.QUICKFIND_SEARCH,d.b.savedview)).then(e=>{n(e)})})}(p,b,S).then(l=>{v.info("Performing quick find on the grid ");const u=Object(a.T)(p,t,r,m);let S=u;const I=r.contextTokenType===c.a.SubGrid;let _=!1;if(I&&r.controlName){const e=Object(a.hb)(y(),t,r,r.controlName);e&&(_=e.EnableViewPicker)}return Object(o.a)(y(),n.Nd)&&I&&!_||Object(g.l)(p)||(S=l),b(Object(h.n)(e,t,r)),b(Object(s.a)(t,r,m,i.a.toString(S),null,d.a.QUICKFIND_SEARCH)).then(()=>(f.EventManager.ReportComponentSuccess(C),u))})}catch(e){const t="Unable to perform a quick find on the grid";f.EventManager.ReportComponentFailure(C,Error(t))}}}}function b(e,t,r,n){return{type:"grid.quickfind.clear.async",execute({dispatch:a,getState:o},c){const l=c.TraceManager.getTracer(p.z),u=p.x+".QuickFilterAction";try{return l.info("Clearing quick find from the grid."),a(Object(h.n)("",t,r)),a(Object(s.a)(t,r,n,i.a.toString(e))).then(()=>{c.EventManager.ReportComponentSuccess(u)})}catch(e){const t="Unable to clear quick find value for grid";c.EventManager.ReportComponentFailure(u,Error(t))}}}}},ZJsz:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n={queryKey:null,pageNumber:1,isNewPageRequested:!1,selectedRows:[],selectedRelatedEntity:null,filters:{},rowProperties:{records:[]},fetchXml:"",controls:{},refreshCounter:0,pagingRefreshInput:0,pagingData:"",relationshipName:null,relationshipRoleOrdinal:null,showChart:null,useRollupView:!1,chartVisualizationType:null,dependentOptionSetColumnStatus:{},chartDrillDownParameters:[]}},ZUzm:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("cfbi"),i=r("ruPX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function a(e,t,r,a,o,s,c,l,u){const d={entityTypeName:e.etn,id:e.id,formId:r,data:a,processId:o,processInstanceId:s,selectedStageId:c,isCrossEntityNavigate:l,recordSetQueryKey:u};return Object(i.a)(n.a,d,t)}},Zw8F:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r("SAYH"),i=r("qshH"),a=r("arV0"),o=r("16wZ"),s=r("ZIjf"),c=r("rs6x"),l=r("7TDv"),u=r("+Ljw");let d;class p{constructor(e,t,r,n){this._id=e,this._label=t,d=r,this._pageId=n}getId(){const e="ClientApi.XrmFormSelectorItem.getId";try{s.a.instance.reportCall(e);const t=n.a.toString(this._id);return s.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}getLabel(){return s.a.instance.reportUsage("ClientApi.XrmFormSelectorItem.getLabel"),this._label}getPageId(){return s.a.instance.reportUsage("ClientApi.XrmFormSelectorItem.getPageId"),this._pageId}setVisible(e){const t="ClientApi.XrmFormSelectorItem.setVisible";try{s.a.instance.reportCall(t),d.dispatch(Object(l.b)(this._pageId,n.a.toString(this._id),e)),s.a.instance.reportSuccess(t)}catch(e){throw i.a.getInstance().reportFailure(t,e),e}}getVisible(){const e="ClientApi.XrmFormSelectorItem.getVisible";try{s.a.instance.reportCall(e);const t=Object(u.c)(d.getState(),this._pageId,this._id);return s.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}navigate(){const e="ClientApi.XrmFormSelectorItem.navigate";try{this._pageId||Object(o.j)(e,"PageId"),s.a.instance.reportCall(e);const t=Object(a.g)(d.getState(),this._pageId),r=t&&t.id?t.id.guid:"",n=Object(a.l)(d.getState(),this._pageId);d.dispatch(Object(c.a)(this._id.guid,this._pageId,n,r)).then(()=>{s.a.instance.reportSuccess(e)}).catch(t=>Object(o.d)(d,t,e+".changeForm"))}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}}},"b41/":function(e,t,r){"use strict";r.d(t,"f",(function(){return n})),r.d(t,"g",(function(){return i})),r.d(t,"h",(function(){return a})),r.d(t,"i",(function(){return o})),r.d(t,"a",(function(){return s})),r.d(t,"e",(function(){return c})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return u})),r.d(t,"b",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n={advancedFilters:"Grid_AdvancedFilter_AdvancedFilters",cancel:"GlobalFilter_Cancel",apply:"Button_Label_Apply",addButton:"Web.SFA.Workflow.Variables.Add",addRow:"MenuItem_Label_AddRow_SentenceCase",addGroup:"MenuItem_Label_AddGroup_SentenceCase",deleteExpression:"Web.SFA.Workflow.Variables.Delete",moveUpExpression:"Web._controls.listedit.buttons.MoveUp",moveDownExpression:"Web._controls.listedit.buttons.MoveDown_SentenceCas",makeGroup:"Grid_AdvancedFilter_MakeGroup",ungroup:"AF_MenuItem_UnGroup",andGroup:"AF_Text_And",orGroup:"AF_Text_Or_SentenceCase",addRelatedEntity:"MenuItem_Label_AddRelatedEntity_SentenceCase",relatedEntityPlaceholder:"Grid_AdvancedFilter_RelatedEntityPlaceholder",fieldPlaceholder:"Audit.Incontext.Filters.AttributesGroup",containsData:"Web._tools.search.search.js_12_8_SentenceCase",doesNotContainData:"Web._tools.search.search.js_12_9_SentenceCase",doesNotContainDataWarning:"Grid_AdvancedFilter_DoesNotContainDataWarning",manyToOne:"Grid_AdvancedFilter_ManyToOne",oneToMany:"Grid_AdvancedFilter_OneToMany",manyToMany:"Grid_AdvancedFilter_ManyToMany",noRelationships:"Grid_AdvancedFilter_NoRelationships",moreCommandsAriaLabel:"AF_Aria_MoreCommands",rowSelectorAriaLabel:"AF_Aria_RowSelector",groupSelectorAriaLabel:"AF_Aria_GroupSelector",groupExpandAriaLabel:"AF_MenuItem_Expand",groupCollapseAriaLabel:"AF_MenuItem_Collapse",groupExpandAriaDescription:"AF_Aria_GroupExpand",groupCollapseAriaDescription:"AF_Aria_GroupCollapse",errorQuickFind:"AF_Error_QuickFindView",errorMalformed:"Grid_AdvancedFilter_ErrorMalformed",invalidField:"Grid_AdvancedFilter_InvalidField",fieldSelectorControlLabel:"Grid_AdvancedFilter_FieldSelector",operatorSelectorControlLabel:"Web.SFA.Workflow.AssignValueDialog.Operator",errorFailedToLoad:"Grid_AdvancedFilter_FailedToLoad",fetchXmlConditionWarning:"Grid_AdvancedFilter_FetchXmlConditionWarning"},i=Object.values(n),a={contains:"SystemCustomization.BusinessRules.ConditionOperator.CONTAINS",doesNotContain:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTCONTAIN",beginsWith:"SystemCustomization.BusinessRules.ConditionOperator.BEGINSWITH",doesNotBeginWith:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTBEGINWITH",endsWith:"SystemCustomization.BusinessRules.ConditionOperator.ENDSWITH",doesNotEndWith:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTENDWITH",containsData:"SystemCustomization.BusinessRules.ConditionOperator.NOTNULL",doesNotContainData:"SystemCustomization.BusinessRules.ConditionOperator.ISNULL",equals:"CustomControl_Grid_Filtering_ConditionOperator_Equals",doesNotEqual:"CustomControl_Grid_Filtering_ConditionOperator_DoesNotEqual",greaterThan:"CustomControl_Grid_Filtering_ConditionOperator_Greater",greaterThanOrEqualTo:"CustomControl_Grid_Filtering_ConditionOperator_GreaterOrEqual",lessThan:"CustomControl_Grid_Filtering_ConditionOperator_Less",lessThanOrEqualTo:"CustomControl_Grid_Filtering_ConditionOperator_LessOrEqual",dateQuarter:"ViewDesigner.RecordFilter.quarter",dateFiscalYear:"FiscalYear_Format_String_NoSpace",on:"Web._tools.search.search.js_16_0",onOrAfter:"CustomControl_Grid_Filtering_ConditionOperator_OnOrAfter",onOrBefore:"ViewDesigner.RecordFilter.on_or_before",yesterday:"Web._tools.search.search.js_16_3",today:"Web._tools.search.search.js_16_4",tomorrow:"Web._tools.search.search.js_16_5",nextSevenDays:"Web._tools.search.search.js_16_6",lastSevenDays:"Web._tools.search.search.js_16_7_SentenceCase",nextWeek:"Web._tools.search.search.js_16_8_SentenceCase",lastWeek:"Web._tools.search.search.js_16_9_SentenceCase",thisWeek:"Web._tools.search.search.js_16_10_SentenceCase",nextMonth:"Web._tools.search.search.js_16_11_SentenceCase",lastMonth:"Web._tools.search.search.js_16_12_SentenceCase",thisMonth:"Web._tools.search.search.js_16_13_SentenceCase",nextYear:"Web._tools.search.search.js_16_14_SentenceCase",lastYear:"Web._tools.search.search.js_16_15_SentenceCase",thisYear:"Web._tools.search.search.js_16_16_SentenceCase",lastXHours:"AF_Option_LastXHours_SentenceCase",nextXHours:"AF_Option_NextXHours_SentenceCase",lastXDays:"AF_Option_LastXDays_SentenceCase",nextXDays:"AF_Option_NextXDays_SentenceCase",lastXWeeks:"AF_Option_LastXWeeks_SentenceCase",nextXWeeks:"AF_Option_NextXWeeks_SentenceCase",lastXMonths:"AF_Option_LastXMonths_SentenceCase",nextXMonths:"AF_Option_NextXMonths_SentenceCase",lastXYears:"AF_Option_LastXYears_SentenceCase",nextXYears:"AF_Option_NextXYears_SentenceCase",anyTime:"Search.Time.Range.Anytime",olderThanXMinutes:"AF_Option_OlderThanXMinutes_SentenceCase",olderThanXHours:"AF_Option_OlderThanXHours_SentenceCase",olderThanXDays:"AF_Option_OlderThanXDays_SentenceCase",olderThanXWeeks:"AF_Option_OlderThanXWeeks_SentenceCase",olderThanXMonths:"AF_Option_OlderThanXMonths_SentenceCase",olderThanXYears:"AF_Option_OlderThanXYears_SentenceCase",inFiscalYear:"AF_Option_InFiscalYear_SentenceCase",lastFiscalYear:"AF_Option_LastFiscalYear_SentenceCase",thisFiscalYear:"AF_Option_ThisFiscalYear_SentenceCase",nextFiscalYear:"AF_Option_NextFiscalYear_SentenceCase",lastXFiscalYears:"AF_Option_LastXFiscalYears_SentenceCase",nextXFiscalYears:"AF_Option_NextXFiscalYears_SentenceCase",inFiscalPeriod:"AF_Option_InFiscalPeriod_SentenceCase",lastFiscalPeriod:"AF_Option_LastFiscalPeriod_SentenceCase",thisFiscalPeriod:"AF_Option_ThisFiscalPeriod_SentenceCase",nextFiscalPeriod:"AF_Option_NextFiscalPeriod_SentenceCase",lastXFiscalPeriods:"AF_Option_LastXFiscalPeriods_SentenceCase",nextXFiscalPeriods:"AF_Option_NextXFiscalPeriods_SentenceCase",inFiscalPeriodAndYear:"AF_Option_InFiscalPeriodAndYear_SentenceCase",inOrAfterFiscalPeriodAndYear:"AF_Option_InOrAfterFiscalPeriod_SentenceCase",inOrBeforeFiscalPeriodAndYear:"AF_Option_InOrBeforeFiscalPeriod_SentenceCase",containValues:"Web._tools.search.search.js_17_4_SentenceCase",doesNotContainValues:"Web._tools.search.search.js_17_5_SentenceCase",equalsCurrentUserLanguage:"AF_Option_EqUserLanguage_SentenceCase",isCurrentUser:"Web._tools.search.search.js_17_0_SentenceCase",notCurrentUser:"Web._tools.search.search.js_17_1_SentenceCase",isCurrentBusinessUnit:"Web._tools.search.search.js_19_1_SentenceCase",notCurrentBusinessUnit:"Web._tools.search.search.js_19_2_SentenceCase",under:"Web.SFA.Workflow.UnderOperator",notUnder:"Web.SFA.Workflow.NotUnderOperator",above:"ViewDesigner.RecordFilter.above",viewAll:"CustomControl_Calendar_ViewMore",aboveOrEqual:"ViewDesigner.RecordFilter.eq_or_above_SentenceCase",underOrEqual:"ViewDesigner.RecordFilter.eq_or_under_SentenceCase",isCurrentUserOrReportingHierarchy:"OwnershipOperator_EqualsCurrentUserOrHierarchy_SentenceCase",isCurrentUserAndTeamsOrReportingHierarchyAndTeams:"OwnershipOperator_EqualsCurrentUserOrHierarchyAndTeams_SentenceCase",isCurrentUserTeams:"OwnershipOperator_EqualsCurrentUserTeams_SentenceCase",isCurrentUserOrTeams:"OwnershipOperator_EqualsCurrentUserOrUserTeams_SentenceCase",loadingResults:"Grid_AdvancedFilter_LoadingResults",noResults:"KMControl.SearchKMArticles.NoResults",errorNoValues:"AF_Error_NoValues",inputControlLabel:"Web.SFA.Workflow.AssignValueDialog.Value",removeButtonAriaLabel:"Dialog_Disassociate_Header",noValue:"Grid_AdvancedFilter_NoValue",minValue:"Grid_AdvancedFilter_MinValue",maxValue:"Grid_AdvancedFilter_MaxValue",maxPrecision:"Grid_AdvancedFilter_MaxPrecision",maxLength:"Grid_AdvancedFilter_MaxLength",incorrectDataType:"Grid_AdvancedFilter_IncorrectDataType",durationUnit:"Grid_AdvancedFilter_durationUnit"},o=Object.values(a),s={dropDownOptionsAll:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsAll",dropDownOptionsDefault:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsDefault",dropDownOptionsCustom:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsCustom",fieldContextMenuRemove:"Grid_AdvancedFilter_ColumnEditor_FieldContextMenuRemove",addColumn:"Grid_AdvancedFilter_ColumnEditor_AddColumn",editColumns:"Grid_AdvancedFilter_ColumnEditor_EditColumns",apply:"Grid_AdvancedFilter_ColumnEditor_Apply",cancel:"Grid_AdvancedFilter_ColumnEditor_Cancel",search:"Grid_AdvancedFilter_ColumnEditor_Search",related:"Grid_AdvancedFilter_ColumnEditor_Related",moveUp:"Grid_AdvancedFilter_ColumnEditor_MoveUp",moveDown:"Grid_AdvancedFilter_ColumnEditor_MoveDown",resetToDefault:"Grid_AdvancedFilter_ColumnEditor_ResetToDefault",close:"Grid_AdvancedFilter_ColumnEditor_Close",listAriaLabel:"Grid_AdvancedFilter_ColumnEditor_AttributesListLabel",columnEditor:"Grid_AdvancedFilter_ColumnEditor_ColumnEditor",saveAsNewView:"Grid_AdvancedFilter_ColumnEditor_SaveAsNewView",saveChangesToCurrentView:"Grid_AdvancedFilter_ColumnEditor_SaveChangesToCurrentView",noFieldsToDisplay:"Grid_AdvancedFilter_ColumnEditor_NoFieldsToDisplay",moreOptions:"Grid_AdvancedFilter_ColumnEditor_MoreOptions",dropdown:"Grid_AdvancedFilter_ColumnEditor_Dropdown"},c=Object.values(s),l={ApplyAdvancedFiltersTitle:"Grid_AdvancedFilter_ApplyAdvancedFiltersTitle",ApplyAdvancedFiltersAria:"Grid_AdvancedFilter_ApplyAdvancedFiltersAriaLabel",CancelEditingFiltersAria:"Grid_AdvancedFilter_CancelEditingAdvancedFiltersAriaLabel",OpenAdvancedFiltersTitleAndAria:"Grid_AdvancedFilter_OpenAdvancedFilterTitleAndAria",resetToDefault:"Grid_AdvancedFilter_ColumnEditor_ResetToDefault"},u=Object.values(l),d=[...i,...o,...u]},bGh0:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r("PUjk"),i=r("HcnX"),a=r("odYE"),o=r("Khp3");class s{constructor(e,t,r,n){this.eventName="BusinessRuleRecommendation_"+e,this.eventParameters=[{name:"EntityTypeName",value:t},{name:"FieldName",value:r},{name:"Title",value:n}]}}var c=r("qshH"),l=r("16wZ"),u=r("i1f0"),d=r("LbMF"),p=r("Qn2w"),h=r("SAYH"),g=r("uhZ3"),m=r("IaGr");var b=r("ZIjf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let y;class f extends i.a{constructor(e,t,r,n,i,a){super(e,t,r,n,i,a),this._entityAttribute=null,y=e,this.registerObserversForControlStateChange()}getAttribute(){const e="ClientApi.XrmDataControl.getAttribute";try{if(b.a.instance.reportCall(e),!this._entityAttribute){let e;if(this.formContext&&this.formContext.data&&this.formContext.data.entity&&(e=this.controlDescriptor&&this.controlDescriptor.Relationship?this.formContext.data.entity.relatedEntities.get(this.controlDescriptor.Relationship):this.formContext.data.entity),this.controlDescriptor&&this.controlDescriptor.DataFieldName&&this.formContext&&this.formContext.data)if(this.controlDescriptor.IsUnbound)this._entityAttribute=this.formContext.data.attributes.get(this.controlDescriptor.DataFieldName);else{const t=e?e.attributes:this.formContext.data.attributes;this._entityAttribute=t.get(this.controlDescriptor.DataFieldName)}}return b.a.instance.reportSuccess(e),this._entityAttribute}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,r),t}}updateAttribute(e,t){const r="ClientApi.XrmDataControl.updateAttribute";try{if(b.a.instance.reportCall(r),e&&t&&this.controlDescriptor&&this.controlDescriptor.Relationship===t){this._entityAttribute=null;const t=e.attributes;t&&(this._entityAttribute=t.get(this.controlDescriptor.DataFieldName))}this._entityAttribute&&this._entityAttribute.controls.add(this.name,this),b.a.instance.reportSuccess(r)}catch(e){const t=c.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(r,e,null,t),e}}addNotification(e){const t="ClientApi.XrmDataControl.addNotification";try{if(b.a.instance.reportCall(t),this._isValidNotification(e)&&this.getVisible()){const r={uniqueId:e.uniqueId?e.uniqueId:"",messages:e.messages,notificationLevel:e.notificationLevel,actions:e.actions};return"RECOMMENDATION"===e.notificationLevel?this._reportAddNotificationEvent(e):y.dispatch(Object(p.b)(this.pageId,this.getName(),!1,this.contextToken)),y.dispatch(Object(o.b)(this.pageId,this.getName(),r,this.contextToken)),b.a.instance.reportSuccess(t),!0}return b.a.instance.reportSuccess(t),!1}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,r),e}}_clearControlNotification(e){const t=Object(u.A)(y.getState(),{controlName:this.name,id:this.pageId},this.contextToken);if(t){const r=Object.keys(t);let n=null;if(e){if(n=t[e],!(n&&n.messages&&n.notificationLevel))return!1;this._clearNotification(n)}else(Object(l.a)(e)||0===e.trim().length)&&r.forEach(e=>{n=t[e],this._clearNotification(n)});return!0}return!1}_clearNotification(e){e.actions=null,e.messages=null,e.notificationLevel=null,y.dispatch(Object(o.b)(this.pageId,this.name,e,this.contextToken))}clearNotification(e){const t="ClientApi.XrmDataControl.clearNotification";try{b.a.instance.reportCall(t);const r=!!this._clearControlNotification(e);return b.a.instance.reportSuccess(t),r}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,r),e}}setNotification(e,t){const r="ClientApi.XrmDataControl.setNotification";try{b.a.instance.reportCall(r);const n={uniqueId:t,messages:[e],priority:0,notificationLevel:"ERROR",actions:[{actions:[function(){}],message:""}]};return b.a.instance.reportSuccess(r),this.addNotification(n)}catch(e){const t=c.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(r,e,null,t),e}}_isValidNotification(e){return!(!e||!e.messages||Object(g.b)(e.messages[0]))&&("RECOMMENDATION"===e.notificationLevel||"ERROR"===e.notificationLevel)}_reportAddNotificationEvent(e){if(!this._isValidNotification(e))return;const t=e.messages[0],r=new s("Added",this.contextToken.entityTypeName,this.getName(),t);var n;y.dispatch((n=r,{type:"report.xrm.event",execute(e,t){try{c.a.getInstance().reportEvent(n)}catch(e){const t="ClientApi.ReportXrmEventAction.reportXrmEvent";m.a.getInstance().eventManager.ReportComponentFailure(t,e),Object(l.j)(t,"XrmReporting")}return Promise.resolve()}}))}getEntityReference(){const e=this.formContext.entityReference,t=e.id?new h.a(e.id):null;return new a.a(e.entityType,t)}registerObserversForControlStateChange(){if(this.getName().startsWith("header_process")){const e=Object(n.a)(this.pageId);e&&this.controlStateObservable.registerObserver(e)}}getAttrDescriptor(e,t,r){const n=this.getEntityReference().etn;let i=Object(u.r)(y.getState(),n,this.name,this.pageId,this.contextToken);return i||(this.controlDescriptor?this.controlDescriptor.DataFieldName?(m.a.getInstance().traceManager.getTracer(e).warn("ControlAttributeDescriptor was not found, falling back to the attribute descriptor.",t),i=Object(d.a)(y.getState(),n,this.controlDescriptor.DataFieldName),i||(t.push({name:"attributeName",value:this.controlDescriptor.DataFieldName}),t.push({name:"entityName",value:n}),r.reportFailure(e,new Error("Attribute descriptor was not found"),t))):r.reportFailure(e,new Error("Control descriptor did not have a DataFieldName"),t):r.reportFailure(e,new Error("Control descriptor was not found"),t)),i}}},bq0x:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t){const r=Object(n.Zb)(e,t);return r&&r.output?r.output.value:null}},cf3Y:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="attribute.format";function a(e,t,r,a){const o=Object(n.x)(t);return{type:i,payload:a,meta:{pageId:e,contextKey:o,dataFieldName:r}}}},d0Pd:function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var n=r("3/02"),i=r("SAYH"),a=r("eXjw"),o=r("j2fa"),s=r("dQnL"),c=r("CngE"),l=r("GEBM"),u=r("0L4T"),d=r("FZDd"),p=r("EY5k"),h=r("a72m"),g=r("YxC/"),m=r("KBcj"),b=r("p/2N"),y=r("16wZ"),f=r("K3gL"),v=r("ngeo"),C=r("504W"),S=r("95wm"),I=r("haag");function _(e,t,r){return{type:"chartData.retrieve.preReq_async",execute({dispatch:n,getState:_},O){let T=_();const j=I.b+".chartData.retrieve.preReq_async",P=e.visualizationId,E=e.viewId;return n(Object(h.a)(t,void 0,e.viewType,E)).then(()=>{T=_();const h=Object(m.c)(T,E);if(!function(e,t,n,i){if(!n||!n.fetchXML)return Object(u.a)(e,t,Object(g.b)(e,l.g),i,r),!1;return!0}(T,n,h,e))return Promise.resolve(null);const y=n(Object(s.a)(t,e.visualizationType,P)),v=n(Object(p.e)(l.A));return Promise.all([y,v]).then(()=>{T=_();const t=Object(c.a)(T,P);if(function(e){if(e&&e.WebResourceId)return!0;return!1}(t))return Object(o.d)(T,n,i.a.toString(e.visualizationId),i.a.toString(e.viewId),r),Promise.resolve(e);if(!function(e,t,n,i){if(n){if(n.initialized===a.a.Error){const a=Object(f.a)(n.errorCode)||l.u;return t(Object(p.e)([a])).then(()=>{const n=Object(g.b)(e,a);Object(u.a)(e,t,n,i,r)},()=>{Object(u.a)(e,t,Object(g.b)(e,l.u),i,r)}),!1}return!!n.DataDescription||(Object(u.a)(e,t,Object(g.b)(e,l.o),i,r),!1)}return!1}(T,n,t,e))return Promise.resolve(null);e.initialized||(e.initialize(t.DataDescription,h.fetchXML,t.PresentationDescription,h.title,h.entityLogicalName,t.Name,t.PrimaryEntityTypeCode,!1),e.setupAggregationQueries());const s={},m=e.dataDefinition.allAttributeNamesByEntity;Array.from(m.keys()).map(e=>{const t=Array.from(m.get(e).keys());s[e]=t});const y=Object(b.c)(h).filter(e=>-1===e.indexOf("."));if(y&&y.length>0){const e=h.entityLogicalName;e in s?s[e].push(...y):s[e]=y}try{const e=t.PresentationDescription,r=Object(S.a)(e);if(!Object(C.b)(e)&&r.length>0){const e=h.entityLogicalName,t=[];t.push(function(e,t){const r=t[2]?t[2].toLowerCase():"";if(r.substring(0,e.length)!==e)return"";return r.substring(e.length+1,r.length)}(e,r)),e in s?s[e].push(...t):s[e]=t}}catch(e){const t="Failed to retrieve entity metadata attributes for Chart Series with error : "+e.message;O.EventManager.ReportComponentFailure(j,Error(t))}return n(Object(d.e)(s)).then(()=>e)},t=>(Object(u.b)(t.getNegativeErrorCode(),_(),n,Object(g.b)(_(),l.q),e,r),Promise.resolve(null)))},t=>{const i=t&&!Object(y.a)(t.errorCode)&&t.errorCode,a=Object(f.a)(i),o=a?Object(g.b)(T,a):"retrieve chart failed. error code: "+v.a.getHexErrorCodeFromInt(i);return Object(u.a)(T,n,o,e,r),Promise.resolve(null)})}}}var O=r("Tezb"),T=r("Lyxw");function j(e,t,r,s=!1){return{type:"chartData.retrieve.async",execute({dispatch:l,getState:u},d){const p=[];try{p.push({name:I.g,value:i.a.toString(e.viewId)}),p.push({name:I.h,value:i.a.toString(e.visualizationId)});const h=u(),g=e.visualizationId,m=i.a.toString(g),b=e.viewId,y=i.a.toString(b);if(!Object(S.b)(u,l,d,p,e,t,r))return Promise.resolve();let f;const v=Object(T.c)(h,n.rd);return f=v?Object(c.e)(h,e.getStorageKey()):Object(c.d)(h,m,y),(f===a.a.Initialized&&Object(c.b)(h,m,y)||f===a.a.Initializing)&&!s?Promise.resolve():(l(v?Object(S.d)(e.getStorageKey(),O.c):Object(S.c)(m,y,O.c)),l(_(e,t,r)).then(e=>{if(!e||e.isWebResourceChart)return Promise.resolve();const n=e;return l(Object(o.b)(n,t,r))}))}catch(e){return d.EventManager.ReportComponentFailure(S.f+".retrieveChartData",Error(e),I.b,p),Promise.reject(e)}}}}},dIqG:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n="navigation.item.visibility";function i(e,t,r){return{type:n,payload:{show:r},meta:{pageId:e,navigationItemId:t}}}},dQnL:function(e,t,r){"use strict";r.d(t,"a",(function(){return C}));var n=r("SAYH"),i=r("eXjw"),a=r("95wm"),o=r("CngE"),s=r("haag"),c=r("BzGi"),l=r("K7RF"),u=r("Nb1E"),d=r("odYE"),p=r("2XFH"),h=r("Uv1Y"),g=r("Tezb"),m=r("/oKV"),b=r("iJGp"),y=r("S2mk"),f=r("3/02"),v=r("Lyxw");function C(e,t=c.a.savedvisualization,r){const p=[];return p.push({name:s.f,value:e}),p.push({name:s.i,value:t}),p.push({name:s.h,value:n.a.toString(r)}),{type:"chart.retrieve.async",execute({dispatch:g,getState:y},C){try{let S=m.a.LocalAndRemote;const _=C.TraceManager.getTracer(s.d),j=C.DataSource,x=y();let A=r;if(_.info(s.d+"entityTypeName:"+e+"visualizationType:"+t+"visualizationId:"+r),!e){const e="entityTypeName is null";return C.EventManager.ReportComponentFailure(a.f+".retrieveChart",Error(e),s.d,p),Promise.reject(e)}n.a.isNullOrEmpty(A)&&(A=Object(o.j)(x,e));const w=Object(v.c)(y(),f.A);if(!n.a.isNullOrEmpty(A)){const r=Object(o.f)(x,A),n=Object(o.g)(x,A),y=()=>{const r=Object(o.a)(x,A),n=function(e,t,r,n){const i=c.a[r],a=Object(o.i)(e,t);return a&&a.chartTypes&&a.chartTypes[i]&&a.chartTypes[i][n.guid]}(x,e,t,A),i=n&&!n.IsUserChart;switch(Object(l.d)(x,i,r,()=>n)){case 1:S=m.a.Remote;break;case 2:g(function(e,t,r){const n=[];return n.push({name:"entityTypeName",value:t}),n.push({name:"visualizationType",value:r}),{type:"chartselector.retrieve.async",execute({dispatch:e,getState:i},o){try{return e(Object(l.b)(c.a[r],null,t,null,!0,b.a.OnDemandWithContext,null,null,[],null,m.a.LocalAndRemote)).catch(h.b)}catch(e){throw o.EventManager.ReportComponentFailure(a.f+"._retrieveChartSelector",Error(e),s.e,n),e}}}}(0,e,t))}};if(r===i.a.Initialized){if(y(),S!==m.a.LocalAndRemote)return O(g,j,e,A,t,S,C,p);if(w&&n===i.a.Uninitialized){const e=new d.a(t===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",A),r=Object(o.a)(x,A);return g(I(A,i.a.Initialized)),g(Object(u.d)(e)).catch(h.b).then(e=>(T(r,e),g(P(e)),C.EventManager.ReportComponentSuccess(a.f+".retrieveChartOData"),Promise.resolve(A)),e=>(E(g,e,A.guid,r,C,p),Promise.resolve(A)))}return Promise.resolve(A)}return O(g,j,e,A,t,S,C,p)}return O(g,j,e,A,t,S,C,p)}catch(e){throw C.EventManager.ReportComponentFailure(a.f+".retrieveChart",Error(e),s.d,p),e}}}}function S(e){return{type:"chart.dependencies.update.async",execute({dispatch:t,getState:r},i){const a=[];for(const t in e)a.push(e[t]+":name");if(a.length>0){return t(Object(p.a)(a)).then(()=>{const i=new Map,a=r();for(const t in e){const r=e[t],s=Object(o.a)(a,new n.a(r));s&&r&&a.metadata.labels&&a.metadata.labels[r]&&a.metadata.labels[r].name&&(s.Name=a.metadata.labels[r].name,i.set(r,s))}i.size>0&&t(function(e){const t={};e.forEach((e,r)=>{t[r]=e});return{type:"chart.descriptor.update",payload:{charts:t}}}(i))},h.b)}return Promise.resolve()}}}function I(e,t){const r=n.a.isNullOrEmpty(e)?null:{charts:{[n.a.toString(e)]:{initialized:t,oDataInitialized:i.a.Initializing}}};return{type:g.f,payload:r}}function _(e,t,r,o=c.a.savedvisualization,p){const g=[];return g.push({name:s.f,value:t}),g.push({name:s.i,value:o}),g.push({name:s.h,value:n.a.toString(r)}),{type:"chart.retrieve.async",execute:({dispatch:e,getState:s},m)=>Object(v.c)(s(),f.A)?r?function(e,t,r,o,s,p,g){const m=new d.a(o===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",r);return e(I(r,i.a.Initializing)),Promise.all([e(Object(l.b)(c.a[o],null,t,n.a.toLegacyGuid(r),!0,b.a.OnDemandWithContext,null,null,[],null,s)).catch(h.b),e(Object(u.d)(m)).catch(h.c)]).then(t=>(t[1].constructor===h.a?E(e,t[1],r.guid,t[0].charts[r.guid],p,g):(T(t[0].charts[r.guid],t[1]),e(P(t[1])),p.EventManager.ReportComponentSuccess(a.f+".retrieveChartOData")),t[0]))}(e,t,r,o,p,m,g):function(e,t,r,o,s,p,g){return e(Object(l.b)(c.a[o],null,t,n.a.toLegacyGuid(r),!0,b.a.OnDemandWithContext,null,null,[],null,s)).catch(h.b).then(t=>{const r=new n.a(Object.keys(t.charts)[0]),s=new d.a(o===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",r);return e(I(r,i.a.Initializing)),e(Object(u.d)(s)).catch(h.b).then(n=>(T(t.charts[r.guid],n),e(P(n)),p.EventManager.ReportComponentSuccess(a.f+".retrieveChartOData"),t),n=>(E(e,n,r.guid,t.charts[r.guid],p,g),t))})}(e,t,r,o,p,m,g):function(e,t,r,i,a){return e(Object(l.b)(c.a[i],null,t,n.a.toLegacyGuid(r),!0,b.a.OnDemandWithContext,null,null,[],null,a)).catch(h.b)}(e,t,r,o,p)}}function O(e,t,r,o,c,l,u,d){return e(function(e){const t=n.a.isNullOrEmpty(e)?null:{charts:{[n.a.toString(e)]:{initialized:i.a.Initializing}}};return{type:g.b,payload:t}}(o)),e(_(0,r,o,c,l)).then(t=>{t&&t.chartSelectors&&!t.chartSelectors[r]&&(t.chartSelectors[r]={initialized:i.a.Initialized,chartTypes:{}});const s=[];for(const e in t.charts)s.push(e);return e(S(s)).then(()=>(e(j(t)),n.a.isNullOrEmpty(o)&&(o=t.chartDefaults[r]),u.EventManager.ReportComponentSuccess(a.f+".retrieveChart"),o),h.b)},t=>{const c=t&&!Object(y.j)(t.errorCode)&&t.errorCode,l={chartSelectors:{[r]:{initialized:i.a.Initialized,chartTypes:{}}}};if(e(j(l)),Object(y.j)(c))return u.EventManager.ReportComponentFailure(a.f+".retrieveChart",Error(t),s.d,d),Object(h.b)(t);{const t={charts:{[n.a.toString(o)]:{initialized:i.a.Error,errorCode:c}}};e(j(t))}})}function T(e,t){e.PresentationDescription=t.presentationdescription.replace(/(\r\n\s*)/g,""),e.oDataInitialized=i.a.Initialized}function j(e){return{type:g.b,payload:e}}function P(e){return{type:g.f,payload:e}}function E(e,t,r,n,o,c){e(P({charts:{[r]:{initialized:n.initialized,oDataInitialized:i.a.Error}}})),o.EventManager.ReportComponentFailure(a.f+".retrieveChartOData",Error(t),s.c,c)}},fREn:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return u}));var n=r("eXjw"),i=r("dHD5"),a=r("37s6"),o=r("a8zb"),s=r("BoVI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e,t,r,a,o,c,u,d){const p=Object(i.v)(o),h=function(e,t){if(!e)return null;const r=new DOMParser,n=e?r.parseFromString(e,"text/xml"):null;if(!n)return null;const i=n.documentElement?n.documentElement.children?n.documentElement.children:n.documentElement.childNodes:void 0;if(!i)return null;const a=i,o=[];for(let e=0;e<a.length;e++){if(!a[e].getAttribute)continue;const n=a[e]?a[e].children?a[e].children:a[e].childNodes:void 0,i=[];let s=null;for(let e=0;e<n.length;e++){const a=n[e];if(!a.getAttribute)continue;const o=a.getAttribute("name");let c;({relatedEntityName:c,fetchXmlDocument:s}=l(o,s,r,t)),i.push({name:o,width:parseInt(a.getAttribute("width"),10),relatedEntityName:c,disableMetaDataBinding:"1"===a.getAttribute("disableMetaDataBinding"),labelId:a.getAttribute("labelId"),isHidden:"1"===a.getAttribute("isHidden"),disableSorting:"1"===a.getAttribute("disableSorting"),addedBy:a.getAttribute("addedBy"),desc:a.getAttribute("desc"),cellType:a.getAttribute("cellType"),imageProviderWebresource:a.getAttribute("imageProviderWebresource"),imageProviderFunctionName:a.getAttribute("imageProviderFunctionName")})}const c={name:a[e].getAttribute("name"),id:a[e].getAttribute("id"),cells:i,multiObjectIdField:a[e].getAttribute("multiObjectIdField"),layoutStyle:a[e].getAttribute("multiObjectIdField")};o.push(c)}return{name:n.documentElement.getAttribute("name"),object:parseInt(n.documentElement.getAttribute("object"),10),rows:o,customControlDescriptions:null,jump:n.documentElement.getAttribute("jump"),select:"1"===n.documentElement.getAttribute("select"),icon:"1"===n.documentElement.getAttribute("icon"),preview:"1"===n.documentElement.getAttribute("preview"),iconRenderer:null}}(d,u),g={initialized:n.a.Initialized,viewId:r,fetchXML:u,entityLogicalName:a,title:c,layoutXML:d,grid:h,isCustomView:!0};return{type:s.a,payload:{views:{[r.guid]:g}},meta:{pageId:e,controlName:t,contextKey:p}}}function l(e,t,r,n){let i="";if(e.indexOf(".")>0){const a=e.split(".")[0];t||(t=r.parseFromString(n,"text/xml"));const o=t.querySelector('link-entity[alias="'+a+'"]');o&&(i=o.getAttribute("name")||"")}return{relatedEntityName:i,fetchXmlDocument:t}}function u(e){return{type:s.f,execute:(t,r)=>(Object(a.w)(t.getState())?o.a.createSqlfromFetchXMLAsync(t,e.fetchXML):Promise.resolve(null)).then(t=>e.offlineSqlQuery=t)}}},fyfl:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return d}));var n=r("SAYH"),i=r("FZDd"),a=r("d0w6"),o=r("Uv1Y"),s=r("a72m"),c=r("BFlg"),l=r("kKLx"),u=r("P6DH");function d(e,t,r){return{type:"datasethost.dependencies.retrieve.async",execute({dispatch:d,getState:h},g){const m=g.TraceManager.getTracer(c.z),b=c.x+".loadDataSetHostDependenciesAction";m.info(`Retrieving view with ID ${n.a.toString(t)} for ${e} entity.`);const y=Object(u.pb)(h(),e,t);return d(Object(s.a)(e,a.a.MAIN_APPLICATION_VIEW,y,t)).then(a=>{if(!a){const r=`Unable to retrieve DataSetHost dependencies for the grid. Failed to retrieve view with ID ${n.a.toString(t)} for ${e}`;return g.EventManager.ReportComponentFailure(b,Error(r)),Promise.reject(new o.a(l.b))}const s=p(h(),t,r);return d(Object(i.e)(s)).then(()=>{const r=[{name:"entityTypeName",value:e},{name:"viewId",value:n.a.toString(t)}];return g.EventManager.ReportComponentSuccess(b,r),Promise.resolve()}).catch(r=>{let i=[];for(const e in s)s[e].length&&(i=[...s[e],...i]);const a=`Unable to retrieve DataSetHost dependencies for the grid for view with ID ${n.a.toString(t)}. Failed to retrieve entity with attributes ${i.join()} for ${e}`;return g.EventManager.ReportComponentFailure(b,Error(a)),Promise.reject(new o.a(l.a))})})}}}function p(e,t,r){const n=Object(u.qb)(e,t,r),i={};if(n&&n.grid&&n.grid.rows&&n.grid.rows[0]&&n.grid.rows[0].cells){const e=[];n.grid.rows[0].cells.forEach(t=>{if(!t.disableMetaDataBinding)if(t.relatedEntityName){if(t.name&&-1!==t.name.indexOf(".")){const e=t.name.split(".")[1];i[t.relatedEntityName]||(i[t.relatedEntityName]=[]),-1===i[t.relatedEntityName].indexOf(e)&&e&&i[t.relatedEntityName].push(e)}}else-1===e.indexOf(t.name)&&e.push(t.name)}),e.length>0&&(i[n.entityLogicalName]=e)}return i}},hA8P:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="control.mrudisabled";function a(e,t,r,a,o){const s=Object(n.v)(a);return{type:i,payload:o,meta:{pageId:t,controlName:r,contextKey:s}}}},"hQd/":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e){this._value=null,this._value=e}get value(){return this._value}set value(e){this._value=e}}},hSDL:function(e,t,r){"use strict";r.d(t,"e",(function(){return o})),r.d(t,"b",(function(){return s})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return l})),r.d(t,"d",(function(){return u})),r.d(t,"c",(function(){return p})),r.d(t,"a",(function(){return d})),r.d(t,"l",(function(){return m})),r.d(t,"i",(function(){return b})),r.d(t,"m",(function(){return y})),r.d(t,"n",(function(){return f})),r.d(t,"k",(function(){return v})),r.d(t,"h",(function(){return C})),r.d(t,"o",(function(){return g})),r.d(t,"j",(function(){return S}));var n=r("dHD5"),i=r("BFlg"),a=r("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="grid.applyFilter",s="grid.applyActivityTypeFilter",c="grid.applyJumpBarFilter",l="grid.applyQuickFindFilter",u="grid.applyFilterCurrentValue",d="grid.applyActivityTypeFilterCurrentValue",p="grid.applyAdvancedFindFilter";function h(e,t,r,a){return{type:"grid.applyFilter.async",execute({dispatch:o},s){const c=s.TraceManager.getTracer(i.z),l=i.x+".applyGridFilterAction",u=Object(n.v)(a),d=[];d.push({name:i.n,value:e}),d.push({name:i.e,value:u});try{return c.info("Applying the filter expression to the grid. "),o(function(e,t,r,n){return{type:e,payload:t,meta:{pageId:r,dataSetContextKey:n}}}(e,t,r,u)),s.EventManager.ReportComponentSuccess(l,d),Promise.resolve()}catch(e){const t="Applying the filter expression to the grid failed ";s.EventManager.ReportComponentFailure(l,Error(t),"",d)}}}}function g(e,t,r){const i=Object(n.v)(r);return{type:c,payload:e,meta:{pageId:t,dataSetContextKey:i}}}const m=(e,t,r)=>h(o,e,t,r),b=(e,t,r)=>h(s,e,t,r),y=(e,t,r)=>h(c,e,t,r),f=(e,t,r)=>h(l,Object(a.a)(e)?e:e.trim(),t,r),v=(e,t,r)=>h(u,e,t,r),C=(e,t,r)=>h(d,e,t,r),S=(e,t,r)=>h(p,e,t,r)},haag:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"g",(function(){return i})),r.d(t,"h",(function(){return a})),r.d(t,"f",(function(){return o})),r.d(t,"i",(function(){return s})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return l})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n="Chart.Component",i="ViewId",a="visualizationId",o="entity Type",s="chart visualization type",c="RETRIEVECHART",l="RETRIEVECHARTTS_RETRIEVECHARTSELECTOR",u="RETRIEVECHARTTS_RETRIEVECHARTDATA",d="RETRIEVECHARTTS_RETRIEVECHARTODATA"},iOrn:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o}));var n=r("dHD5"),i=r("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="grid.setCustomFilter";function o(e,t,r,o,s){return{type:"grid.setCustomFilter.async",execute({dispatch:c,getState:l},u){const d=u.TraceManager.getTracer(i.z),p=i.x+".setCustomFilterAction";try{return d.info("Adding a custom filter for the grid. "),c(function(e,t,r,i,o){let s=null;if(null!=e){s={customFilterXml:e,source:t,timeStamp:o||null}}const c=Object(n.y)(i),l=Object(n.v)(i);return{type:a,payload:s,meta:{pageId:r,contextKey:c,dataSetContextKey:l}}}(e,t,r,o,s)),u.EventManager.ReportComponentSuccess(p),Promise.resolve()}catch(e){const t="Adding a custom filter for the grid failed";u.EventManager.ReportComponentFailure(p,Error(t))}}}}},iWfp:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return s}));var n=r("nuS9"),i=r("Gilj"),a=r("FhVi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t,r,n,a,o){return new i.a(e,e=>{t(e.EVENT)},r,n,a,o)}function s(e){return n.createElement(a.a,{key:e.id,keyboardShortcuts:e.keyboardShortcuts,defaultFocusId:e.defaultFocusId,rootElementId:e.rootElementId,isModal:e.isModal,shouldManageFocus:e.shouldManageFocus||!1})}},j2fa:function(e,t,r){"use strict";r.d(t,"b",(function(){return Se})),r.d(t,"d",(function(){return Ie})),r.d(t,"e",(function(){return _e})),r.d(t,"c",(function(){return Oe})),r.d(t,"a",(function(){return Te}));var n=r("Wgxh"),i=r("SAYH"),a=r("eXjw"),o=r("95wm");var s=r("fKWG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var c=r("odYE"),l=r("VcAV"),u=r("MXaZ");class d{constructor(){this._dataPointAggregators=new Array(0),this._dataPointDateTimeRangeAggregatorInfoMap=new Map,this._dataPointFiscalPeriodAggregators=new Array(0),this._dataPointFiscalYearAggregators=new Array(0)}addAggregator(e,t,r,n,a){if(r>=s.a.DAY&&r<s.a.FISCAL_PERIOD)this._addDateTimeRangeAggregatorInfo(e,t,r,n,a);else if(r===s.a.FISCAL_PERIOD)this._addDataPointFiscalPeriodAggregator(e,t,n,a);else if(r===s.a.FISCAL_YEAR)this._addDataPointFiscalYearAggregator(e,t,n,a);else{const r=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,Value:e&&e.Value||null,DisplayName:e&&e.DisplayName||null,EntityLogicalName:e&&e.EntityLogicalName||null}}();if(r.FieldName=e,r.EntityName=n,r.LinkEntityExpressionArray=a,Object(l.c)(t))r.Value=null;else if(t instanceof c.a){const e=t;r.Value=e.id.guid,r.DisplayName=e.name,r.EntityLogicalName=e.etn}else t instanceof i.a?r.Value=i.a.toString(t):r.Value=t.toString();this._dataPointAggregators.push(r)}}static _daysInMonth(e,t){return new Date(e,t,0).getDate()}_addDataPointFiscalPeriodAggregator(e,t,r,n){const i=function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,FiscalType:e&&e.FiscalType||null,Year:e&&e.Year||0,Period:e&&e.Period||0}}();if(i.FiscalType="in-fiscal-period-and-year",i.FieldName=e,i.EntityName=r,i.LinkEntityExpressionArray=n,!t)return void this._dataPointFiscalPeriodAggregators.push(i);if("string"!=typeof t)throw new Error("value should be string");if(t.indexOf("-")<=0)throw new Error("value should have xxxx-yy format");const a=t.split("-");i.Year=Number(a[0]),i.Period=Number(a[1]),this._dataPointFiscalPeriodAggregators.push(i)}_addDataPointFiscalYearAggregator(e,t,r,n){const i=function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,FiscalType:e&&e.FiscalType||null,Year:e&&e.Year||0}}();if(i.FiscalType="in-fiscal-year",i.FieldName=e,i.EntityName=r,i.LinkEntityExpressionArray=n,t){if("number"!=typeof t)throw new Error("value should be number");i.Year=Number(t),this._dataPointFiscalYearAggregators.push(i)}else this._dataPointFiscalYearAggregators.push(i)}_addDateTimeRangeAggregatorInfo(e,t,r,n,i){let a=null;switch(this._dataPointDateTimeRangeAggregatorInfoMap.has(e)?a=this._dataPointDateTimeRangeAggregatorInfoMap.get(e):(a=function(e){return{dateTimeAggregatorDay:(null==e?void 0:e.dateTimeAggregatorDay)||null,dateTimeAggregatorWeek:(null==e?void 0:e.dateTimeAggregatorWeek)||null,dateTimeAggregatorMonth:(null==e?void 0:e.dateTimeAggregatorMonth)||null,dateTimeAggregatorYear:(null==e?void 0:e.dateTimeAggregatorYear)||null,dateTimeAggregatorFieldName:(null==e?void 0:e.dateTimeAggregatorFieldName)||null,dateTimeAggregatorEntityName:(null==e?void 0:e.dateTimeAggregatorEntityName)||null,dateTimeAggregatorLinkEntityExpressionArr:(null==e?void 0:e.dateTimeAggregatorLinkEntityExpressionArr)||null,dateTimeAggregatorPrecision:(null==e?void 0:e.dateTimeAggregatorPrecision)||s.a.YEAR}}({dateTimeAggregatorFieldName:e}),this._dataPointDateTimeRangeAggregatorInfoMap.set(e,a)),a.dateTimeAggregatorEntityName||(a.dateTimeAggregatorEntityName=n),a.dateTimeAggregatorLinkEntityExpressionArr||(a.dateTimeAggregatorLinkEntityExpressionArr=i),r){case s.a.DAY:a.dateTimeAggregatorDay=Number(t);break;case s.a.WEEK:a.dateTimeAggregatorWeek=Number(t);break;case s.a.MONTH:a.dateTimeAggregatorMonth=Number(t);break;case s.a.QUARTER:a.dateTimeAggregatorMonth=3*Number(t);break;case s.a.YEAR:a.dateTimeAggregatorYear=Number(t);break;default:throw new Error("DateTime Group type not supported")}a.dateTimeAggregatorPrecision=Math.min(r,a.dateTimeAggregatorPrecision)}_getDataPointDateTimeRangeAggregators(e,t){const r=new Array(0);return 0===this._dataPointDateTimeRangeAggregatorInfoMap.size||this._dataPointDateTimeRangeAggregatorInfoMap.forEach((n,i)=>{const a={FieldName:(null==o?void 0:o.FieldName)||null,EntityName:(null==o?void 0:o.EntityName)||null,LinkEntityExpressionArray:(null==o?void 0:o.LinkEntityExpressionArray)||null,MinDate:(null==o?void 0:o.MinDate)||null,MaxDate:(null==o?void 0:o.MaxDate)||null};var o;if(a.FieldName=n.dateTimeAggregatorFieldName,a.EntityName=n.dateTimeAggregatorEntityName,a.LinkEntityExpressionArray=n.dateTimeAggregatorLinkEntityExpressionArr,n.dateTimeAggregatorYear){switch(n.dateTimeAggregatorMonth=n.dateTimeAggregatorMonth?n.dateTimeAggregatorMonth:12,n.dateTimeAggregatorDay=n.dateTimeAggregatorDay?n.dateTimeAggregatorDay:d._daysInMonth(n.dateTimeAggregatorYear,n.dateTimeAggregatorMonth),a.MaxDate=new Date(n.dateTimeAggregatorYear,n.dateTimeAggregatorMonth-1,n.dateTimeAggregatorDay),n.dateTimeAggregatorPrecision){case s.a.DAY:p(a.MaxDate),a.MinDate=new Date(a.MaxDate.getFullYear(),a.MaxDate.getMonth(),a.MaxDate.getDate());break;case s.a.WEEK:{t===u.a.FirstFullWeekOfTheYear&&(t=u.a.FirstDayOfTheYear);let r=Object(u.s)(n.dateTimeAggregatorYear,n.dateTimeAggregatorWeek,e,t),i=Object(u.s)(n.dateTimeAggregatorYear,n.dateTimeAggregatorWeek+1,e,t);if(i.setDate(i.getDate()-1),t===u.a.FirstDayOfTheYear){if(i>=new Date(n.dateTimeAggregatorYear+1,0,1))i=new Date(n.dateTimeAggregatorYear+1,0,0);else if(1===n.dateTimeAggregatorWeek){const e=new Date(n.dateTimeAggregatorYear,0,1);r<e&&(r=e)}}a.MinDate=r,a.MaxDate=i,p(a.MaxDate),p(a.MinDate);break}case s.a.MONTH:a.MinDate=new Date(a.MaxDate.getFullYear(),a.MaxDate.getMonth()-1,d._daysInMonth(n.dateTimeAggregatorYear,a.MaxDate.getMonth())+1),p(a.MaxDate),p(a.MinDate);break;case s.a.QUARTER:a.MinDate=new Date(a.MaxDate.getFullYear(),a.MaxDate.getMonth()-3,d._daysInMonth(n.dateTimeAggregatorYear,a.MaxDate.getMonth()-2)+1),p(a.MaxDate),p(a.MinDate);break;case s.a.YEAR:p(a.MaxDate),a.MinDate=new Date(a.MaxDate.getFullYear()-1,a.MaxDate.getMonth(),a.MaxDate.getDate()+1);break;default:throw new Error("DateTime Group type not supported")}r.push(a)}else r.push(a)}),r}getAggregators(e,t){let r=this._dataPointAggregators;const n=this._getDataPointDateTimeRangeAggregators(e,t);return n&&n.length>0&&(r=r.concat(n)),this._dataPointFiscalPeriodAggregators&&this._dataPointFiscalPeriodAggregators.length>0&&(r=r.concat(this._dataPointFiscalPeriodAggregators)),this._dataPointFiscalYearAggregators&&this._dataPointFiscalYearAggregators.length>0&&(r=r.concat(this._dataPointFiscalYearAggregators)),r}}function p(e){e.getTimezoneOffset()<0&&e.setDate(e.getDate()+1)}var h=r("YxC/"),g=r("GEBM"),m=r("IqkD"),b=r("Xd5/"),y=r("nfCs"),f=r("NjDY"),v=r("LbMF"),C=r("S70w"),S=r("Ae6N");function I(e,t){const r=Object(v.a)(e,t.entity.entityName,t.attributeName);let n=r?r.DisplayName:null;n||(n=t.attributeName);let i=n;if(t.dateTimeGrouping){const r=y.c(t.dateTimeGrouping.groupingType).replace("-","").toUpperCase();i=String.format(Object(h.b)(e,g.c),Object(h.b)(e,`${g.c}.${r.toUpperCase()}`),n)}else t.hasAggregate&&t.aggregateType&&(i=String.format(Object(h.b)(e,g.d),Object(h.b)(e,`${g.d}.${t.aggregateType.toUpperCase()}`),n));if(r&&"money"===r.Type){let n="",a=null;const o=Object(f.x)(e);r.IsBaseCurrency?o&&o.baseCurrencyId&&o.transactionCurrencyById&&(a=o.transactionCurrencyById[o.baseCurrencyId.guid]):t.hasAggregate&&(a=Object(m.b)(e)),a&&(n=o&&o.currencyDisplayOption===C.a.CurrencyCode?a.currencyCode:a.currencySymbol),n&&(i=String.format(Object(h.b)(e,g.b),i,n))}return i}function _(e,t,r){return r>0?String.format(Object(h.b)(e,g.y),r,t):String.format(Object(h.b)(e,g.w),t)}function O(e,t,r,n,i){const a=i<1&&n>=1&&r<1,o=i<1&&n<1&&r>=1,s=n<1&&r<1;if(i>=1&&n<1&&r>=1){const n=new Date(t,r-1,i),{formatInfoCultureName:a,numberFormatInfo:o,dateFormatInfo:s}=Object(m.w)(e),c=new Sys.CultureInfo(a,o,s);return Object(b.s)(n,c,S.a.None)}return a?String.format(Object(h.b)(e,g.z),n,t):o?String.format("{0} {1}",function(e){const t=Object(h.b)(e,g.e).split(",");if(!t||12!==t.length)throw new Error("Expect 12 months! Actual: "+t.length);return t}(e)[r-1],t):s?String(t):""}function T(e){return Object(h.b)(e,g.v)}var j=r("WPtp"),P=r("16wZ");function E(e,t,r){let n=!1;r&&r.groupAttribute&&r.groupAttribute.dateTimeGrouping&&(n=!0);return{attribute:t,primaryGroupBy:r,aliasName:t.aliasName||t.attributeName,state:e,isDateTimeChart:n}}function x(e,t){let r=e.isDateTimeChart?function(e,t){if(!t.fields||!Object(j.c)(t.fields[e.aliasName]))return"";switch(e.attribute.dateTimeGrouping.groupingType){case s.a.DAY:return function(e,t){const r=Object(j.e)(t.fields[e.aliasName]),n=Object(j.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]),i=Object(j.e)(t.fields[e.primaryGroupBy.extendedGroupBys[1].aliasName]);return O(e.state,i,n,-1,r)}(e,t);case s.a.WEEK:return function(e,t){const r=Object(j.e)(t.fields[e.aliasName]),n=Object(j.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return O(e.state,n,-1,r,-1)}(e,t);case s.a.MONTH:return function(e,t){const r=Object(j.e)(t.fields[e.aliasName]),n=Object(j.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return O(e.state,n,r,-1,-1)}(e,t);case s.a.QUARTER:return function(e,t){const r=Object(j.e)(t.fields[e.aliasName]),n=Object(j.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return _(e.state,n,r)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,t);case s.a.FISCAL_PERIOD:return function(e,t){return Object(j.e)(t.fields[e.aliasName])}(e,t);case s.a.YEAR:return function(e,t){const r=Object(j.e)(t.fields[e.aliasName]);return O(e.state,r,-1,-1,-1)}(e,t);case s.a.FISCAL_YEAR:return function(e,t){const r=Object(j.e)(t.fields[e.aliasName]);return _(e.state,r,-1)}(e,t);default:return Object(j.c)(t.fields[e.attribute.attributeName])}}(e,t):null;return r||(r=Object(j.c)(t.fields[e.aliasName]),r=r||""),0===r.length?Object(h.b)(e.state,g.v):r}function A(e,t){if(!e.attribute||!Object(v.a)(e.state,e.attribute.entity.entityName,e.attribute.attributeName))return x(e,t);switch(Object(v.a)(e.state,e.attribute.entity.entityName,e.attribute.attributeName).Type){case"picklist":case"status":case"state":case"boolean":{let r=Object(j.e)(t.fields[e.aliasName]);return r=Object(P.a)(r)?-1:Number(r),r}case"datetime":return function(e,t){let r=-1,n=-1,i=-1;switch(e.attribute.dateTimeGrouping.groupingType){case s.a.DAY:r=Object(j.e)(t.fields[e.aliasName]),n=Object(j.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]),i=Object(j.e)(t.fields[e.primaryGroupBy.extendedGroupBys[1].aliasName]);break;case s.a.MONTH:n=Object(j.e)(t.fields[e.aliasName]),i=Object(j.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;case s.a.YEAR:i=Object(j.e)(t.fields[e.aliasName]);break;case s.a.QUARTER:n=Object(j.e)(t.fields[e.aliasName]),i=Object(j.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;case s.a.WEEK:r=1+7*(Object(j.e)(t.fields[e.aliasName])-1),i=Object(j.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;default:return x(e,t)}return new Date(i,n-1,r).getTime()}(e,t);default:return x(e,t)}}function w(e){return{Enabled:e&&e.Enabled||!1,X:e&&e.X||0,Y:e&&e.Y||0,Align:e&&e.Align||"left",VerticalAlign:e&&e.VerticalAlign||"middle",LabelFormatter:e&&e.LabelFormatter||null,Color:e&&e.Color||""}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function F(e){return{Value:e&&e.Value||0,FormattedValue:e&&e.FormattedValue||null,Aggregators:e&&e.Aggregators||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class N extends Error{constructor(e,t,r){super(e),Object.setPrototypeOf(this,N.prototype),this.title=t,this.description=r}}var k=r("Lyxw"),D=r("3/02"),M=r("zh0k"),R=r("hwt8"),L=r("504W");function V(){return this.point.formattedValue}function B(e){return function(){return Highcharts.numberFormat(parseFloat(this.point.y)/e*100)+"%"}}class G{constructor(){this.isInitialized=!1}get primaryGroupBy(){return this.chartDataDescription&&this.chartDataDescription.category&&this.chartDataDescription.category.primaryGroupBy}get queryModel(){return this._queryModel}initialize(e,t,r,n,i,a,o,s,c,l){this.getState=e,this.chartData=t,this.chartDataDescription=r,this.categoryColumn=this.chartDataDescription.categoryColumns,this.chartPresentationSeries=n,this.chartPresentationXAxis=i,this.chartPresentationYAxis=a,this.chartPresentationArea3DStyle=o,this.chartPresentationAreaGradientStyle=s,this._queryModel=c,this.chartPresentationAnnotationList=l,this._isChartCustomizationParityFCBEnabled()&&this._validateChartAggregateAttributes(),this.isInitialized=!0}setXAxisMajorGridAndMajorTickProperties(e,t=0){var r,n,i,a,o,s,c,l;return e.AxisMajorGridColor=null===(n=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[t])||void 0===n?void 0:n.AxisMajorGridColor,e.AxisMajorGridEnabled=null===(a=null===(i=this.chartPresentationXAxis)||void 0===i?void 0:i[t])||void 0===a?void 0:a.AxisMajorGridEnabled,e.AxisMajorTickMarkColor=null===(s=null===(o=this.chartPresentationXAxis)||void 0===o?void 0:o[t])||void 0===s?void 0:s.AxisMajorTickMarkColor,e.AxisMajorTickMarkEnabled=null===(l=null===(c=this.chartPresentationXAxis)||void 0===c?void 0:c[t])||void 0===l?void 0:l.AxisMajorTickMarkEnabled,e}setYAxisMajorGridAndMajorTickProperties(e,t=0){var r,n,i,a,o,s,c,l;return e.AxisMajorGridColor=null===(n=null===(r=this.chartPresentationYAxis)||void 0===r?void 0:r[t])||void 0===n?void 0:n.AxisMajorGridColor,e.AxisMajorGridEnabled=null===(a=null===(i=this.chartPresentationYAxis)||void 0===i?void 0:i[t])||void 0===a?void 0:a.AxisMajorGridEnabled,e.AxisMajorTickMarkColor=null===(s=null===(o=this.chartPresentationYAxis)||void 0===o?void 0:o[t])||void 0===s?void 0:s.AxisMajorTickMarkColor,e.AxisMajorTickMarkEnabled=null===(l=null===(c=this.chartPresentationYAxis)||void 0===c?void 0:c[t])||void 0===l?void 0:l.AxisMajorTickMarkEnabled,e}retrieveChartArea3DStyle(){const e={};return e.Enable3D=this.chartPresentationArea3DStyle.Enable3D,e}retrieveChartAreaGradientStyle(){const e={};return e.BackColor=this.chartPresentationAreaGradientStyle.BackColor,e.BackSecondaryColor=this.chartPresentationAreaGradientStyle.BackSecondaryColor,e.BackGradientStyle=this.chartPresentationAreaGradientStyle.BackGradientStyle,e}setYAxisOppositeProperty(e){var t,r,n,i;return this._isChartCustomizationParityFCBEnabled()&&(null===(r=null===(t=this.chartPresentationXAxis)||void 0===t?void 0:t[0])||void 0===r?void 0:r.IsReversed)&&(e.Opposite=null===(i=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[0])||void 0===i?void 0:i.IsReversed),e}setXAxisIsReversedProperty(e){var t,r,n,i;return this._isChartCustomizationParityFCBEnabled()&&(null===(r=null===(t=this.chartPresentationXAxis)||void 0===t?void 0:t[0])||void 0===r?void 0:r.IsReversed)&&(e.IsReversed=null===(i=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[0])||void 0===i?void 0:i.IsReversed),e}retrieveChartYAxis(){const e=new Array(1);if(e[0]={},!this._queryModel.SeriesList)return e;const t=(e,t,r)=>{this.chartPresentationYAxis&&this.chartPresentationYAxis.length>t&&this.chartPresentationYAxis[t]&&this.chartPresentationYAxis[t].Title?e.Title=this.chartPresentationYAxis[t].Title:1===r&&(e.Title=this._queryModel.SeriesList[t].Title)};let r=0,n=-1,i=-1,a=!1,o=!1;for(let e=0;e<this.chartPresentationSeries.length;e++)this.chartPresentationSeries[e].SecondaryYAxis?(r++,i=-1===i?e:i,o=o||this.shouldDisableAllowDecimals(e)):(n=-1===n?e:n,a=a||this.shouldDisableAllowDecimals(e));return t(e[0],n,this.chartPresentationSeries.length-r),e[0].Opposite=!1,a&&(e[0].AllowDecimals=!1),0===r&&(e[0]=this.setYAxisOppositeProperty(e[0])),r>0&&(e[1]={},t(e[1],i,r),e[1].Opposite=!0,o&&(e[1].AllowDecimals=!1)),e.forEach((e,t)=>{var r,n,i,a,o,s,c,l,u,d,p,h,g,m;e.Disabled=this.chartPresentationYAxis&&this.chartPresentationYAxis[t]&&this.chartPresentationYAxis[t].Disabled,e.LabelForeColor=null===(n=null===(r=this.chartPresentationYAxis)||void 0===r?void 0:r[t])||void 0===n?void 0:n.LabelForeColor,e.AxisLineColor=null===(a=null===(i=this.chartPresentationYAxis)||void 0===i?void 0:i[t])||void 0===a?void 0:a.AxisLineColor,e.AxisTitleForeColor=null===(s=null===(o=this.chartPresentationYAxis)||void 0===o?void 0:o[t])||void 0===s?void 0:s.AxisTitleForeColor,e.LabelDisabled=null===(l=null===(c=this.chartPresentationYAxis)||void 0===c?void 0:c[t])||void 0===l?void 0:l.LabelDisabled,e.AxisInterval=null===(d=null===(u=this.chartPresentationYAxis)||void 0===u?void 0:u[t])||void 0===d?void 0:d.AxisInterval,e.AxisMinimum=null===(h=null===(p=this.chartPresentationYAxis)||void 0===p?void 0:p[t])||void 0===h?void 0:h.AxisMinimum,e.AxisMaximum=null===(m=null===(g=this.chartPresentationYAxis)||void 0===g?void 0:g[t])||void 0===m?void 0:m.AxisMaximum,e=this.setYAxisMajorGridAndMajorTickProperties(e,t)}),this.chartPresentationYAxis&&this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].FormatString?e[0].FormatString=this.chartPresentationYAxis[0].FormatString:e[0].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[0].measures[0].measureAttribute),r>0&&(this.chartPresentationYAxis&&this.chartPresentationYAxis[1]&&this.chartPresentationYAxis[1].FormatString?e[1].FormatString=this.chartPresentationYAxis[1].FormatString:e[1].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[i].measures[0].measureAttribute)),e}_isChartCustomizationParityFCBEnabled(){return Object(k.a)(this.getState(),D.s,D.Lc,D.w)}retrieveChartAnnotations(){const e=new Array(this.chartPresentationAnnotationList.length);for(let t=0;t<this.chartPresentationAnnotationList.length;t++){const r={};r.X=this.chartPresentationAnnotationList[t].X,r.Y=this.chartPresentationAnnotationList[t].Y,r.Text=this.chartPresentationAnnotationList[t].Text,r.ForeColor=this.chartPresentationAnnotationList[t].ForeColor,e[t]=r}return e}retrieveChartCategory(){var e,t,r,n,i,a;const o=new Array(1);let s=null;this.categoryColumn.length>0&&(s=E(this.getState(),this.categoryColumn[0],this.chartDataDescription.category.primaryGroupBy)),o[0]={};const c=new Array(this.chartData.length);for(let e=0;e<this.chartData.length;e++){const t=this.chartData[e];if(s){if(c[e]=x(s,t),"-1"===c[e])c[e]=Object(h.b)(this.getState(),g.f);else if(!s.isDateTimeChart&&"number"==typeof Object(j.e)(t.fields[s.aliasName])&&this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString){const r=Object(m.w)(this.getState());c[e]=Object(R.c)(Object(j.e)(t.fields[s.aliasName]),Object(b.d)(r),this.chartPresentationXAxis[0].FormatString)}}else c[e]=T(this.getState())}return o[0].Title=this.retrieveChartCategoryTitle(s),o[0].Values=c,o[0].Disabled=this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].Disabled,o[0].LabelForeColor=null===(t=null===(e=this.chartPresentationXAxis)||void 0===e?void 0:e[0])||void 0===t?void 0:t.LabelForeColor,o[0].AxisLineColor=null===(n=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[0])||void 0===n?void 0:n.AxisLineColor,o[0].AxisTitleForeColor=null===(a=null===(i=this.chartPresentationXAxis)||void 0===i?void 0:i[0])||void 0===a?void 0:a.AxisTitleForeColor,o[0].LabelDisabled=this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].LabelDisabled,o[0]=this.setXAxisMajorGridAndMajorTickProperties(o[0]),o[0]=this.setXAxisIsReversedProperty(o[0]),o}retrieveChartCategoryTitle(e){return this.chartPresentationXAxis&&this.chartPresentationXAxis.length>0&&this.chartPresentationXAxis[0].Title?this.chartPresentationXAxis[0].Title:e?I((t=e).state,t.attribute):"";var t}retrieveChartSeries(e){const t=new Array(this.chartPresentationSeries.length);for(let r=0;r<this.chartPresentationSeries.length;r++){const n=this.chartDataDescription.category.measureCollections[r].measures[0].measureAttribute,i=n.aliasName?n.aliasName:n.attributeName,a=this.chartPresentationSeries[r].IsValueShownAsLabel,o=this.chartPresentationSeries[r].LabelFormat;let s=null;o&&Object(R.d)(o)&&(s=Object(R.g)(o));let c=!1;this.chartPresentationSeries[r].Label&&"#percent"===this.chartPresentationSeries[r].Label.toLowerCase()&&(c=!0);let l=!1;o&&X(this.chartPresentationSeries[r].ChartType)&&Object(R.e)(o)&&(l=!0);let u=null;const d=I(this.getState(),n);t[r]=this.cloneBlueprintSeriesStyle(this.chartPresentationSeries[r]),this.chartPresentationSeries[r].SecondaryYAxis&&(t[r].YAxisNumber=1),this.primaryGroupBy&&(u=[],u.push(this.primaryGroupBy.groupAttribute),this.primaryGroupBy.extendedGroupBys&&this.primaryGroupBy.extendedGroupBys.forEach(e=>{u.push(e)}));const p=new Array(this.chartData.length),h=i;let g=0;for(let e=0;e<this.chartData.length;e++){const t=this.chartData[e];p[e]=F();const n=Object(j.e)(t.fields[i]);if(p[e].Value=n||0,g+=n||0,o){const n=Object(m.w)(this.getState()),i=Object(b.d)(n);Object(R.f)(o)?p[e].FormattedValue=Object(M.b)(p[e].Value,this.chartPresentationSeries[r].LabelFormat,i):Object(R.d)(o)&&!l?p[e].FormattedValue=Object(R.a)(p[e].Value,s,i):p[e].FormattedValue=Object(j.c)(t.fields[h])||0}else p[e].FormattedValue=Object(j.c)(t.fields[h])||0;this.attachAggregators(p[e],t,u)}const y=w();a?(y.Enabled=!0,y.LabelFormatter=V):c&&(y.Enabled=!0,y.LabelFormatter=B(g)),y.Color=this.chartPresentationSeries[r].LabelForeColor,t[r].DataLabels=y,t[r].DataPoints=p,t[r].Title=this.getChartTitleFromPresentationSeries(d,r),t[r].XAxisNumber=e,t[r].HideInLegend=this.chartPresentationSeries[r].HideInLegend,t[r].Stack=this.chartPresentationSeries[r].Stack}const r=Object(m.w)(this.getState()),n=Object(b.d)(r),i=this.chartPresentationSeries[0].IsValueShownAsLabel,a=this.chartPresentationSeries[0].LabelFormat;if(i&&X(this.chartPresentationSeries[0].ChartType)&&Object(R.e)(a)){const e=U(a,n);for(let r=0;r<t[0].DataPoints.length;r++)e(0,r,0,t)}return t}getChartTitleFromPresentationSeries(e,t=0){return Object(L.b)(this.chartPresentationSeries[t].LegendText)?Object(L.b)(this.chartPresentationSeries[t].Name)?e:this.chartPresentationSeries[t].Name:this.chartPresentationSeries[t].LegendText}shouldDisableAllowDecimals(e){const t=this.chartDataDescription.category.measureCollections[e].measures[0].measureAttribute;return"count"===t.aggregateType||"countcolumn"===t.aggregateType}cloneBlueprintSeriesStyle(e){const t={DataPoints:r&&r.DataPoints||null,DataLabels:r&&r.DataLabels||null,ChartType:r&&r.ChartType||"line",YAxisNumber:r&&r.YAxisNumber||0,XAxisNumber:r&&r.XAxisNumber||0,Title:r&&r.Title||"",Color:r&&r.Color||"",BorderColor:r&&r.BorderColor||"",BorderWidth:r&&r.BorderWidth||0,CustomProperties:r&&r.CustomProperties||null,Stack:r&&r.Stack||null};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;return t.ChartType=e.ChartType,t.Color=e.Color,t.BorderColor=e.BorderColor,t.BorderWidth=e.BorderWidth,t.CustomProperties=e.CustomProperties,t}attachAggregators(e,t,r){if(r){const n=new d;for(let e=0;e<r.length;e++){const i=r[e],a=new Array;i.entity.baseEntity&&i.entity.baseEntity.linkedEntities&&i.entity.baseEntity.linkedEntities.forEach(e=>{const t={name:r&&r.name||null,from:r&&r.from||null,to:r&&r.to||null,linkType:r&&r.linkType||null,alias:r&&r.alias||null};var r;t.name=e.entityName,t.from=e.linkFromAttribute,t.to=e.linkToAttribute,t.linkType=e.joinType.toString(),t.alias=e.alias,a.push(t)}),n.addAggregator(i.attributeName,Object(j.e)(t.fields[G._getFieldName(i)]),i.dateTimeGrouping?i.dateTimeGrouping.groupingType:-1,i.entity.entityName,a)}const i=Object(m.w)(this.getState()),a=this._getFirstDayOfWeekFromUserSettings(i),o=this._getCalendarWeekRuleFromUserSettings(i);e.Aggregators=n.getAggregators(a,o)}}_getFirstDayOfWeekFromUserSettings(e){var t;return(null===(t=e.dateFormatInfo)||void 0===t?void 0:t.FirstDayOfWeek)||0}_getCalendarWeekRuleFromUserSettings(e){var t;return(null===(t=e.dateFormatInfo)||void 0===t?void 0:t.CalendarWeekRule)||0}getFormatterPropertiesForAttribute(e){return Object(b.z)(this.getState(),Object(v.a)(this.getState(),e.entity.entityName,e.attributeName))}static _getFieldName(e){return e.aliasName&&e.aliasName.trim()?e.aliasName:e.attributeName}isChartDrillable(){if(!this._isGroupByDrillable(this.chartDataDescription.category.primaryGroupBy))return!1;for(const e of this.chartDataDescription.category.measureCollections)for(const t of e.secondaryGroupBys)if(!this._isGroupByDrillable(t))return!1;return!!this.chartDataDescription.entityExpression.hasAggregate}_isGroupByDrillable(e){return!this.chartDataDescription.isGroupByFromNestedLinkEntity()&&(!(!e||!e.groupAttribute.hasGroupBy)&&this._isAttributeDrillable(e.groupAttribute))}_isAttributeDrillable(e){var t;const r=null===(t=null==e?void 0:e.entity)||void 0===t?void 0:t.entityName,n=null==e?void 0:e.attributeName;return"memo"!==Object(v.b)(n,r,this.getState())}_validateChartAggregateAttributes(){var e,t,r,n;for(let i=0;i<(null===(r=null===(t=null===(e=this.chartDataDescription)||void 0===e?void 0:e.entityExpression)||void 0===t?void 0:t.aggregateAttributes)||void 0===r?void 0:r.length);i++){const e=this.chartDataDescription.entityExpression.aggregateAttributes[i],t=null===(n=null==e?void 0:e.entity)||void 0===n?void 0:n.entityName,r=null==e?void 0:e.attributeName,a=Object(v.b)(r,t,this.getState());if(!("date"!==a&&"datetime"!==a||"min"!==e.aggregateType&&"max"!==e.aggregateType)){const e=String.format(Object(h.b)(this.getState(),g.h),r);throw new N("ChartError",e,e)}}}}function X(e){return!!e&&("stackedbar100"===e.toLowerCase()||"stackedcolumn100"===e.toLowerCase()||"stackedarea100"===e.toLowerCase())}function U(e,t){return function r(n,i,a,o){if(n===o.length)return a;const s=o[n].DataPoints[i];return a=r(++n,i,a+(s&&s.Value?s.Value:0),o),s&&s.Value&&(s.FormattedValue=Object(R.a)(s.Value/a*100,Object(R.g)(e),t)),a}}var z=r("iZ7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class H extends G{parse(){var e,t,r,n;if(!this.isInitialized)throw new Error("The instance of the ComparisonChartDataParser class is not properly initialized.");const i=new Array(0),a=new Map,o=this.chartDataDescription.category,s=o.measureCollections[0];if(s.secondaryGroupBys.length<=0)throw new Error("Comparison chart can only be plotted with secondary groups's");if(s.measures&&s.measures.length>0&&s.measures[0].parentCategory&&s.measures[0].parentCategory.primaryGroupBy&&(s.measures[0].parentCategory.primaryGroupBy.groupAttribute&&i.push(s.measures[0].parentCategory.primaryGroupBy.groupAttribute),s.measures[0].parentCategory.primaryGroupBy.extendedGroupBys))for(let e=0;e<s.measures[0].parentCategory.primaryGroupBy.extendedGroupBys.length;e++)i.push(s.measures[0].parentCategory.primaryGroupBy.extendedGroupBys[e]);if(1!==this.chartPresentationSeries.length)throw new Error("Comparison chart should have only one series");const c=this._addSecondaryGroupByToFieldAggregators(s,i),l=s.measures[0].measureAttribute,u=l.aliasName?l.aliasName:l.attributeName,d=u,p=o.primaryGroupBy.groupAttribute,h=E(this.getState(),this._getGroupByAttribute(p,o.primaryGroupBy),o.primaryGroupBy),g=new Array,y=new Array,f=new Map;for(let e=0;e<this.chartData.length;e++){const t=this.chartData[e],r=x(h,t);let n,i=x(c,t);null==i?(i=T(this.getState()),n=i):n=A(c,t),a.set(n,i),y.indexOf(r)<0&&y.push(r),g.indexOf(n)<0&&g.push(n)}g.forEach(e=>{const t=new Array(y.length);f.set(e,t)});const v=Object(m.w)(this.getState()),C=this.chartPresentationSeries[0].LabelFormat;let S=!1;this.chartPresentationSeries[0].Label&&"#percent"===this.chartPresentationSeries[0].Label.toLowerCase()&&(S=!0);let I=!1;C&&X(this.chartPresentationSeries[0].ChartType)&&Object(R.e)(C)&&(I=!0);for(let e=0;e<this.chartData.length;e++){const t=this.chartData[e];let r=A(c,t);Object(P.a)(r)&&(r=T(this.getState()));const n=f.get(r),a=x(h,t),o=y.indexOf(a);if(this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString&&(y[o]=Object(R.c)(Object(j.e)(t.fields[h.aliasName]),Object(b.d)(v),this.chartPresentationXAxis[0].FormatString)),n[o]=F(),n[o].Value=Object(j.e)(t.fields[u]),C){const r=Object(b.d)(v);Object(R.f)(C)?n[o].FormattedValue=Object(M.b)(n[e].Value,C,r):Object(R.d)(C)&&!I?n[o].FormattedValue=Object(R.a)(n[o].Value,Object(R.g)(C),r):n[o].FormattedValue=Object(j.c)(t.fields[d])||0}else n[o].FormattedValue=Object(j.c)(t.fields[d])||0;this.attachAggregators(n[o],t,i)}g.forEach(e=>{const t=f.get(e);for(let e=0;e<y.length;e++)t[e]||(t[e]=F())});const _=new Array(1);_[0]={},_[0].Title=this.retrieveChartCategoryTitle(h),_[0].Values=y,_[0].LabelForeColor=null===(e=this.chartPresentationXAxis[0])||void 0===e?void 0:e.LabelForeColor,_[0].AxisLineColor=null===(t=this.chartPresentationXAxis[0])||void 0===t?void 0:t.AxisLineColor,_[0].AxisTitleForeColor=null===(r=this.chartPresentationXAxis[0])||void 0===r?void 0:r.AxisTitleForeColor,_[0].LabelDisabled=null===(n=this.chartPresentationXAxis[0])||void 0===n?void 0:n.LabelDisabled,_[0]=this.setXAxisMajorGridAndMajorTickProperties(_[0]),_[0]=this.setXAxisIsReversedProperty(_[0]),this._sortComparisonCodes(s,g);const O=new Array(g.length),N=this.chartPresentationSeries[0]&&this.chartPresentationSeries[0].IsValueShownAsLabel,k=this.chartPresentationSeries[0]?this.chartPresentationSeries[0].LabelForeColor:null,D=this.chartPresentationSeries[0]&&this.chartPresentationSeries[0].HideInLegend,L=this.getChartTitleFromPresentationSeries(this.chartPresentationSeries[0].Name);for(let e=0;e<g.length;e++){const t=g[e];if(O[e]=this.cloneBlueprintSeriesStyle(this.chartPresentationSeries[0]),O[e].Title=L||a.get(t),O[e].DataPoints=f.get(t),O[e].HideInLegend=D,N){const t=w();t.Enabled=!0,t.LabelFormatter=V,O[e].DataLabels=t,t.Color=k}else if(S){let t=0;O[e].DataPoints.forEach(e=>{t+=e&&e.Value?e.Value:0});const r=w();r.Enabled=!0,r.LabelFormatter=B(t),O[e].DataLabels=r,r.Color=k}}if(N&&I){const e=U(C,Object(b.d)(v));for(let t=0;t<_[0].Values.length;t++)e(0,t,0,O)}this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=_,this.queryModel.YAxes=this._retrieveChartYAxis(l),this.queryModel.SeriesList=O,this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations()}_sortComparisonCodes(e,t){e.secondaryGroupBys[0].descending?t.sort((e,t)=>"number"==typeof e&&"number"==typeof t?t-e:t.localeCompare(e)):t.sort((e,t)=>"number"==typeof e&&"number"==typeof t?e-t:e.localeCompare(t))}_getGroupByAttribute(e,t){return e.attributeName!==Object(z.h)(this.getState(),e.entity.entityName).PrimaryIdAttribute?e:t.extendedGroupBys&&t.extendedGroupBys.length>0?t.extendedGroupBys[0]:e}_addSecondaryGroupByToFieldAggregators(e,t){const r=e.secondaryGroupBys[0].groupAttribute,n=E(this.getState(),this._getGroupByAttribute(r,e.secondaryGroupBys[0]),e.secondaryGroupBys[0]);if(r&&t.push(r),e.secondaryGroupBys[0].extendedGroupBys)for(let r=0;r<e.secondaryGroupBys[0].extendedGroupBys.length;r++)t.push(e.secondaryGroupBys[0].extendedGroupBys[r]);return n}_retrieveChartYAxis(e){var t,r,n,i,a,o,s,c;const l=new Array(1);return l[0]={},this.chartPresentationYAxis&&this.chartPresentationYAxis.length>0&&this.chartPresentationYAxis[0].Title?l[0].Title=this.chartPresentationYAxis[0].Title:l[0].Title=I(this.getState(),e),this.chartPresentationYAxis[0].FormatString?l[0].FormatString=this.chartPresentationYAxis[0].FormatString:l[0].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[0].measures[0].measureAttribute),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelForeColor&&(l[0].LabelForeColor=this.chartPresentationYAxis[0].LabelForeColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].AxisLineColor&&(l[0].AxisLineColor=this.chartPresentationYAxis[0].AxisLineColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].AxisTitleForeColor&&(l[0].AxisTitleForeColor=this.chartPresentationYAxis[0].AxisTitleForeColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelDisabled&&(l[0].LabelDisabled=null===(r=null===(t=this.chartPresentationYAxis)||void 0===t?void 0:t[0])||void 0===r?void 0:r.LabelDisabled),l[0].AxisInterval=null===(i=null===(n=this.chartPresentationYAxis)||void 0===n?void 0:n[0])||void 0===i?void 0:i.AxisInterval,l[0].AxisMinimum=null===(o=null===(a=this.chartPresentationYAxis)||void 0===a?void 0:a[0])||void 0===o?void 0:o.AxisMinimum,l[0].AxisMaximum=null===(c=null===(s=this.chartPresentationYAxis)||void 0===s?void 0:s[0])||void 0===c?void 0:c.AxisMaximum,this.shouldDisableAllowDecimals(0)&&(l[0].AllowDecimals=!1),l[0]=this.setYAxisMajorGridAndMajorTickProperties(l[0]),l[0]=this.setYAxisOppositeProperty(l[0]),l}}class q extends G{parse(){if(!this.isInitialized)throw new Error("The instance of the DateTimeChartDataParser class is not properly initialized.");this.categoryColumn&&0!==this.categoryColumn.length&&(this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=this.retrieveChartCategory(),this.queryModel.SeriesList=this.retrieveChartSeries(0),this.queryModel.YAxes=this.retrieveChartYAxis(),this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations())}retrieveChartCategory(){var e,t,r,n,i,a,o,s;const c=new Array(1);if(this.chartData.length<1)return c;const l=this.primaryGroupBy.groupAttribute;c[0]={};const u=new Array(this.chartData.length),d=E(this.getState(),l,this.primaryGroupBy);c[0].Title=this.retrieveChartCategoryTitle(d),c[0].LabelForeColor=null===(t=null===(e=this.chartPresentationXAxis)||void 0===e?void 0:e[0])||void 0===t?void 0:t.LabelForeColor,c[0].AxisLineColor=null===(n=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[0])||void 0===n?void 0:n.AxisLineColor,c[0].AxisTitleForeColor=null===(a=null===(i=this.chartPresentationXAxis)||void 0===i?void 0:i[0])||void 0===a?void 0:a.AxisTitleForeColor,c[0].LabelDisabled=null===(s=null===(o=this.chartPresentationXAxis)||void 0===o?void 0:o[0])||void 0===s?void 0:s.LabelDisabled,c[0]=this.setXAxisMajorGridAndMajorTickProperties(c[0]),c[0]=this.setXAxisIsReversedProperty(c[0]);for(let e=0;e<this.chartData.length;e++){const t=this.chartData[e];u[e]=x(d,t),d.isDateTimeChart&&this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString&&u[e]!==Object(h.b)(d.state,g.v)&&(u[e]=Object(R.b)(new Date(u[e]),Object(b.d)(Object(m.w)(this.getState())),this.chartPresentationXAxis[0].FormatString))}return c[0].Values=u,c}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class W extends G{parse(){if(!this.isInitialized)throw new Error("The instance of the NormalChartDataParser class is not properly initialized.");this.categoryColumn&&0!==this.categoryColumn.length&&(this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=this.retrieveChartCategory(),this.queryModel.SeriesList=this.retrieveChartSeries(0),this.queryModel.YAxes=this.retrieveChartYAxis(),this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations())}}var Y=r("DAWX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Q(e){const t={};try{if(e){const r=/\w+=\w+/;e.split(/\s*,\s*/).forEach(e=>{if(e&&r.test(e)){const[r,n]=e.split("=");t[r]=n}})}}catch(t){throw`Failed to parse chart custom properties, value: ${e} `}return{FunnelNeckHeight:t&&Number(t.FunnelNeckHeight)||0,FunnelNeckWidth:t&&Number(t.FunnelNeckWidth)||10,StackedGroupName:t&&t.StackedGroupName||null}}var K=r("S2mk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const J=["COLUMN","STACKEDCOLUMN","STACKEDCOLUMN100","BAR","STACKEDBAR","STACKEDBAR100","AREA","STACKEDAREA","STACKEDAREA100","LINE","PIE","FUNNEL","TAG","DOUGHNUT","POINT"];function Z(e,t,r){const n=(new DOMParser).parseFromString(t,"text/xml");!function(e,t){const r=e.getElementsByTagName("parsererror");if(r&&r.length>0)throw new N("ChartError",Object(h.b)(t,g.t),Object(h.b)(t,g.s))}(n,e);return{chartPresentationSeries:$(e,n,r),chartPresentationLegendList:re(n),colorsList:te(n),chartPresentationArea3DStyle:se(n),chartPresentationAreaGradientStyle:ce(n),chartPresentationXAxis:ie(n),chartPresentationYAxis:ae(n),chartPresentationAnnotationList:ne(n)}}function $(e,t,r){const n=new Array,i=t.querySelectorAll("Chart Series Series"),a=new XMLSerializer;for(let t=0;t<i.length;t++){const o=i[t],s={},c=o.getAttribute("ChartType")||"Column";if(-1===J.indexOf(c.toUpperCase()))throw new N("ChartError",Object(h.b)(e,g.t),Object(h.b)(e,g.t));s.ChartType=c;const l=o.getAttribute("Color");s.Color=l?le(l):null;const u=o.getAttribute("LegendText");s.LegendText=u||null;const d=o.getAttribute("CustomProperties");s.CustomProperties=Q(d);const p=o.getAttribute("BorderColor");s.BorderColor=p?le(p):null;const m=o.getAttribute("BorderWidth");s.BorderWidth=m?Number(m):null;const b=o.getAttribute("IsValueShownAsLabel");s.IsValueShownAsLabel=b&&"true"===b.toLowerCase()||!1,s.Label=o.getAttribute("Label");const y=o.getAttribute("YAxisType");s.SecondaryYAxis=y&&"secondary"===y.toLowerCase();const f=o.getAttribute("IsVisibleInLegend");s.HideInLegend=f&&"false"===f.toLowerCase();const v=o.getAttribute("LabelForeColor");s.LabelForeColor=v?le(v):null,s.LabelFormat=o.getAttribute("LabelFormat");const C=ee(e,o.outerHTML||a.serializeToString(o),r);s.Name=C||null,s.Stack=s.CustomProperties.StackedGroupName,n.push(s)}return n}function ee(e,t,r){const n=Object(o.a)(t);if(Object(K.j)(n)||n.length<5)return"";const i=n[2].toLowerCase(),a=n[4];let s="";const c=i.substring(0,r.length);if(c!==r)return"";const l=i.substring(r.length+1,i.length),u=Object(v.a)(e,c,l);return u&&u.OptionSet&&(s=u.OptionSet.filter(e=>e.Value.toString().toLowerCase()===a.toLowerCase())[0].Label),s}function te(e){const t=new Array,r=e.querySelector("Chart").getAttribute("PaletteCustomColors");return null!==r&&r.split(";").forEach(e=>{if(e){const r=le(e);t.push(r)}}),t}function re(e){const t=new Array,r=e.querySelectorAll("Chart Legends Legend");for(let e=0;e<r.length;e++){const n={},i=r[e].getAttribute("Enabled");n.Enabled=null===i||"True"===i,t.push(n)}return t}function ne(e){const t=new Array,r=e.querySelectorAll("Chart Annotations TextAnnotation");for(let e=0;e<r.length;e++){const n=r[e],i={},a=n.getAttribute("X");i.X=a?Number(a):null;const o=n.getAttribute("Y");i.Y=o?Number(o):null,i.Text=n.getAttribute("Text");const s=n.getAttribute("ForeColor");i.ForeColor=s?le(s):null,t.push(i)}return t}function ie(e){const t=new Array,r=e.querySelectorAll("Chart ChartAreas ChartArea AxisX");for(let n=0;n<r.length;n++){const i=r[n],a={};oe(a,e.querySelectorAll("Chart ChartAreas ChartArea AxisX MajorGrid")[0],e.querySelectorAll("Chart ChartAreas ChartArea AxisX MajorTickMark")[0]),a.Title=i.getAttribute("Title");const o=e.querySelectorAll("Chart ChartAreas ChartArea AxisX LabelStyle")[0];if(o){const e=null==o?void 0:o.getAttribute("ForeColor"),t=null==o?void 0:o.getAttribute("Enabled");a.LabelForeColor=e?le(e):null,a.LabelDisabled=t&&"false"===t.toLowerCase(),a.FormatString=o.getAttribute("Format")}const s=i.getAttribute("Enabled"),c=i.getAttribute("LineColor"),l=i.getAttribute("TitleForeColor");a.Disabled=s&&"false"===s.toLowerCase(),a.AxisLineColor=c?le(c):null,a.AxisTitleForeColor=l?le(l):null,a.Disabled=s&&"false"===s.toLowerCase();const u=i.getAttribute("IsReversed");a.IsReversed=u&&"true"===u.toLowerCase(),t.push(a)}return t}function ae(e){const t=new Array,r=(e,r)=>{var n,i;const a={};if(!e)return void t.splice(r,0,a);const o=e;a.Title=o.getAttribute("Title");oe(a,o.querySelectorAll("MajorGrid")[0],o.querySelectorAll("MajorTickMark")[0]);const s=o.getAttribute("Enabled");a.Disabled=s&&"false"===s.toLowerCase();const c=o.getAttribute("Interval"),l=o.getAttribute("Minimum"),u=o.getAttribute("Maximum");a.AxisInterval=c?Number(c):null,a.AxisMinimum=l?Number(l):null,a.AxisMaximum=u?Number(u):null;const d=o.querySelectorAll("LabelStyle");d&&d[0]&&d[0].getAttribute("Format")&&(a.FormatString=d[0].getAttribute("Format"));const p=null===(n=null==d?void 0:d[0])||void 0===n?void 0:n.getAttribute("ForeColor");a.LabelForeColor=p?le(p):null;const h=null===(i=null==d?void 0:d[0])||void 0===i?void 0:i.getAttribute("Enabled");a.LabelDisabled=h&&"false"===h.toLowerCase();const g=o.getAttribute("LineColor");a.AxisLineColor=g?le(g):null;const m=o.getAttribute("TitleForeColor");a.AxisTitleForeColor=m?le(m):null,t.splice(r,0,a)};let n=e.querySelectorAll("Chart ChartAreas ChartArea AxisY");return n&&r(n[0],0),n=e.querySelectorAll("Chart ChartAreas ChartArea AxisY2"),n&&r(n[0],1),t}function oe(e,t,r){if(e){if(t){const r=t.getAttribute("LineColor"),n=t.getAttribute("Enabled");e.AxisMajorGridColor=r?le(r):null,e.AxisMajorGridEnabled=n&&"true"===n.toLowerCase()}if(r){const t=r.getAttribute("LineColor"),n=r.getAttribute("Enabled");e.AxisMajorTickMarkColor=t?le(t):null,e.AxisMajorTickMarkEnabled=n&&"true"===n.toLowerCase()}return e}}function se(e){const t=e.querySelector("Chart ChartAreas ChartArea Area3DStyle"),r={};return r.Enable3D=!!t&&"true"===t.getAttribute("Enable3D").toLowerCase(),r}function ce(e){const t=e.querySelector("Chart ChartAreas ChartArea"),r={};return r.BackColor=t?t.getAttribute("BackColor"):"",r.BackSecondaryColor=t?t.getAttribute("BackSecondaryColor"):"",r.BackGradientStyle=t?t.getAttribute("BackGradientStyle"):"",r}function le(e){if(!e)return null;if(function(e){return/^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$/.test(e)}(e=e.trim()))return String.format("rgb({0})",e);if(function(e){return/#[0-9a-fA-F]{6}/.test(e)}(e))return e;if(function(e){return/^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,(\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,){2}\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$/.test(e)}(e)){const t=[];e.split(",").forEach(e=>t.push(e.trim()));const r=t.shift(),n=parseFloat(r)/255,i=t.slice();return i.push(n.toString()),String.format("rgba({0})",i.join(","))}return e}var ue=r("z8iZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function de(e){return{Text:e&&e.Text||"",HorizontalAlignment:e&&e.HorizontalAlignment||"center",VerticalAlignment:e&&e.VerticalAlignment||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class pe{constructor(e,t,r,n,i,a,o,s){this._getState=e,this._chartData=i,this._viewRecord=t,this._visualizationRecord=r,this._chartDataDescription=n,this._chartPresentationXML=a,this._drilldownChartType=o,this._entityLogicalName=s}buildChartModel(){if(this._chartQueryModel=Object(ue.a)(),this._chartData.length>0){this._buildChartHeading();try{this._buildChartPresentation(),this._buildChart()}catch(e){if(!(e instanceof N))throw e;this._buildErrorMessage(e)}}else this._buildDataEmptyMessage();return this._chartQueryModel}_buildDataEmptyMessage(){const e=Object(h.b)(this._getState(),g.m),t=de();t.Text=this._visualizationRecord&&this._visualizationRecord.get_DisplayName()?this._visualizationRecord.get_DisplayName():e,t.HorizontalAlignment="center",t.VerticalAlignment="middle",this._chartQueryModel.Title=t,this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName(),this._chartQueryModel.DisplayMode=1,this._chartQueryModel.ErrorInformation=new Y.a,this._chartQueryModel.ErrorInformation.set_ErrorType(null),this._chartQueryModel.ErrorInformation.set_ErrorDescription(e)}_buildErrorMessage(e){this._chartQueryModel.Title=de(),this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName(),this._chartQueryModel.DisplayMode=1,this._chartQueryModel.ErrorInformation=new Y.a,this._chartQueryModel.ErrorInformation.set_ErrorType(e.title),this._chartQueryModel.ErrorInformation.set_ErrorDescription(e.description)}_buildChartHeading(){const e=this._visualizationRecord.get_DisplayName();this._chartQueryModel.Title=de(),this._chartQueryModel.Title.Text=e,this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName()}_buildChartPresentation(){var e;this._chartPresentationParser=Z(this._getState(),this._chartPresentationXML,this._entityLogicalName),this._drilldownChartType&&this._chartPresentationParser.chartPresentationSeries.forEach(e=>{e.ChartType=this._drilldownChartType}),this._chartPresentationSeries=this._chartPresentationParser.chartPresentationSeries,this._chartPresentationXAxis=this._chartPresentationParser.chartPresentationXAxis,this._chartPresentationYAxis=this._chartPresentationParser.chartPresentationYAxis,this._chartPresentationAnnotationList=this._chartPresentationParser.chartPresentationAnnotationList,this._chartPresentationArea3DStyle=this._chartPresentationParser.chartPresentationArea3DStyle,this._chartPresentationAreaGradientStyle=this._chartPresentationParser.chartPresentationAreaGradientStyle,this._chartQueryModel.Legend={Enabled:e&&e.Enabled||!1},this._chartPresentationParser.chartPresentationLegendList.length>0?this._chartQueryModel.Legend.Enabled=this._chartPresentationParser.chartPresentationLegendList[0].Enabled:this._chartQueryModel.Legend.Enabled=!1,this._colors=this._chartPresentationParser.colorsList}_buildChart(){this._chartParserType=this._getChartParserType();const e=function(e){let t=null;switch(e){case 2:t=new H;break;case 3:t=new q;break;case 1:default:t=new W}return t}(this._chartParserType);e.initialize(this._getState,this._chartData,this._chartDataDescription,this._chartPresentationSeries,this._chartPresentationXAxis,this._chartPresentationYAxis,this._chartPresentationArea3DStyle,this._chartPresentationAreaGradientStyle,this._chartQueryModel,this._chartPresentationAnnotationList),this._chartQueryModel.Colors=this._colors,e.parse()}_getChartParserType(){return this._chartDataDescription.isComparisonChart?2:this._chartDataDescription.category.primaryGroupBy.groupAttribute.dateTimeGrouping?3:1}}var he=r("haag"),ge=r("0L4T"),me=r("nxXM"),be=r("ddoO"),ye=r("q/7h"),fe=r("Tezb"),ve=r("WF3G"),Ce=r("4r2D");function Se(e,t,r){return{type:"chartData.retrieve.core.async",execute({dispatch:n,getState:a},s,c){const l=[];try{const u=a();if(!Object(o.b)(a,n,s,l,e,t,r,!0))return Promise.resolve();const d=new ve.a(e.fetchXml);d.set_NoLock(!0),d.set_PageSize(e.dataDefinition.entityExpression.top);const p=function(e){const t={};if(null!=e){const r=new ve.a(e);r.set_PageSize(0),r.set_NoLock(!0),t[""]=r}return t}(e.viewXml);return function(e,t,r,n){const a=new Ce.a(i.a.toString(i.a.newGuid()),n&&n.isPreloadCall);return e.retrieveEntitiesForAggregateQuery(t,r,a).nativePromise()}(s.DataSource,d,p,c).then(s=>{const c=function(t,r,n){const i=new je(e.viewTitle,e.viewEntityLogicalName),a=new je(e.chartName,e.chartPrimaryEntityTypeCode),s=e.dataDefinition,c=Object(ye.a)(t);Object(o.e)(s,c,r());const l=e,u=new pe(r,i,a,s,c,e.presentationXml,l.drillDownChartType?l.drillDownChartType:null,n);return u.buildChartModel()}(s,a,t);Object(k.c)(u,D.rd)?(n(Te(e.getStorageKey(),c)),_e(u,n,e.getStorageKey(),r)):(n(Oe(i.a.toString(e.visualizationId),i.a.toString(e.viewId),c)),Ie(u,n,i.a.toString(e.visualizationId),i.a.toString(e.viewId),r))}).catch(t=>{Object(ge.c)(u,n,t,e,r)})}catch(e){return s.EventManager.ReportComponentFailure(o.f+".retrieveChartDataCore",Error(e),he.b,l),Promise.reject(e)}}}}function Ie(e,t,r,a,o){if(e){const s=new i.a(r),c=i.a.toString(s),l=new i.a(a),u=i.a.toString(l),d={},p={};if(p[u]=function(e,t,r,i){if(!e)return null;if(i&&""!==i){const a=Object(be.c)(e,t,r),o=a&&a.slice();return Object(n.a)(o,i)}return null}(e,c,u,o),p[u]){d[c]=p;const e={entities:null,lists:null,charts:d};t(Object(me.b)(e))}}}function _e(e,t,r,i){if(e){const a={};if(a[r]=function(e,t,r){if(!e)return null;if(r){const i=Object(be.b)(e,t),a=i&&i.slice();return Object(n.a)(a,r)}return null}(e,r,i),a[r]){const e={entities:null,lists:null,charts:null,chartData:a};t(Object(me.b)(e))}}}function Oe(e,t,r){const n=new i.a(e),o=i.a.toString(n),s=new i.a(t),c={charts:{[o]:{[i.a.toString(s)]:{initialized:a.a.Initialized,chartConfigObject:r}}}};return{type:fe.d,payload:c}}function Te(e,t){const r={chartData:{[e]:{initialized:a.a.Initialized,chartConfigObject:t}}};return{type:fe.d,payload:r}}class je{constructor(e,t){this._displayName=e,this._associatedEntityLogicalName=t,Object.freeze(this)}get_DisplayName(){return this._displayName}get_AssociatedEntityLogicalName(){return this._associatedEntityLogicalName}}},jsFU:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return a}));var n=r("BFlg"),i=r("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="control.update.formlessControlOutputs";function o(e,t,r){return{type:"control.update.formlessControlOutputs.async",execute({dispatch:o,getState:s},c){const l=c.TraceManager.getTracer(n.z),u=n.x+".formlessControlOutputsIdAction";try{if(!Object.keys(r).length)return Promise.resolve();const n=s(),d=Object(i.a)(n,e),p=Object.assign({},d.formlessControlOutputs);let h=!1;l.info("Updating the unbound output.");for(const e in r){const n=r[e],i=t+"."+e;p[i]!==n&&(p[i]=n,h=!0)}return h&&o(function(e,t){return{type:a,payload:{formlessControlOutputs:t},meta:{pageId:e}}}(e,p)),c.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){const t="Updating the outbound outputs for the grid failed with error : "+e.message;c.EventManager.ReportComponentFailure(u,Error(t))}}}}},kC0I:function(e,t,r){"use strict";r.d(t,"i",(function(){return de})),r.d(t,"g",(function(){return re})),r.d(t,"e",(function(){return ne})),r.d(t,"d",(function(){return ie})),r.d(t,"f",(function(){return he})),r.d(t,"h",(function(){return ge})),r.d(t,"c",(function(){return oe})),r.d(t,"a",(function(){return ue})),r.d(t,"b",(function(){return le}));var n=r("SAYH"),i=r("eOoD"),a=r("w1eR"),o=r("eXjw"),s=r("S2mk"),c=r("jRy5"),l=r("ILmX"),u=r("d0w6"),d=r("iZ7K"),p=r("IqkD"),h=r("NjDY"),g=r("YxC/"),m=r("KBcj"),b=r("BzGi"),y=r("BFlg"),f=r("P6DH"),v=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function C(){let e=null,t=null,r=null;return(n,i)=>{const a=i.parentContextToken,o=i.contextString,s=function(e,t){const r=t.parentContextToken;switch(t.contextString){case y.h.ASSOCIATEDGRID:const n=Object(f.gb)(e,t,r);return v.a(r,n.relationshipName,n.ordinal);case y.h.SUBGRID:if(t.descriptor&&t.descriptor.StreamId)return v.o(r,t.descriptor.Name,t.descriptor.StreamId,!!t.descriptor.IsTile);const i=v.p(r,t.descriptor.Name),a=i&&i.parentContextToken?i.parentContextToken.entityTypeName:null;return i.relationshipType=oe(e,t,a,i),i;case y.h.GRID:return v.k(e,t.id);case y.h.CUSTOM:return v.c(r,t.controlId);default:return r}}(n,i);return(r!==o||S(e,s)||S(t,a))&&(e=s,t=a,r=o),e}}function S(e,t){return e&&t?e.entityTypeName!==t.entityTypeName||e.controlName!==t.controlName||(e.formId&&e.formId.guid)!==(t.formId&&t.formId.guid)||(e.recordId&&e.recordId.guid)!==(t.recordId&&t.recordId.guid)||e.relationshipName!==t.relationshipName||e.roleOrd!==t.roleOrd:e!==t}var I=r("5O6t"),_=r("XvLr"),O=r("LzVy"),T=r("sclX"),j=r("unFF"),P=r("GYEz"),E=r("o0iw"),x=r("504W"),A=r("3hnk"),w=r("sZ+8"),F=r("69Qu"),N=r("3/02"),k=r("Lyxw"),D=r("kt5S"),M=r("jAuy"),R=r("arV0"),L=r("pEXn"),V=r("5R5s"),B=r("VnpK"),G=r("85o3"),X=r("lEp6"),U=r("YPtO"),z=r("0kGT"),H=r("Z/4N"),q=r("nIfK"),W=r("8nT0"),Y=r("CbNq"),Q=r("b41/"),K=r("7+p5"),J=r("37s6"),Z=r("LbMF"),$=r("SJlc"),ee=r("AVDU"),te=r("H4dV");function re(e){return e===y.h.SUBGRID}function ne(e){return e===y.h.GRID}function ie(e){return e===y.h.ASSOCIATEDGRID}function ae(e){switch(e){case y.h.ASSOCIATEDGRID:case y.h.SUBGRID:return"div";case y.h.GRID:default:return"section"}}function oe(e,t,r,n){let i=r?Object(d.G)(e,r,n.relationshipName):null;if(null===i&&t.descriptor&&t.descriptor.Parameters){const n=t.descriptor.Parameters[y.F.RELATIONSHIP_NAME],a=t.descriptor.Parameters[y.F.TARGET_ENTITY_TYPE];n&&r?i=Object(d.G)(e,r,n):n&&a&&(i=Object(d.G)(e,a,n))}return i}function se(){let e=null,t=null;return r=>(e!==r.contextString&&(e=r.contextString,t=function(e){switch(e.contextString){case y.h.ASSOCIATEDGRID:case y.h.SUBGRID:return[u.a.SUB_GRID,u.a.MAIN_APPLICATION_VIEW];case y.h.GRID:return e.isAdvancedFindView?[u.a.ADVANCED_SEARCH]:[u.a.MAIN_APPLICATION_VIEW];default:return[u.a.MAIN_APPLICATION_VIEW]}}(r)),t)}function ce(e){return e&&[e.CustomControlId,e.Name].some(e=>-1!==q.a.indexOf(e))}function le(e,t,r){if(!e||!e.contextTokenType||e.contextTokenType!==c.a.AssociatedGrid&&e.contextTokenType!==c.a.MainGrid)return null;switch(t){case"displayChart":return!1;case"displayCommandBar":return!0;case"displayIndex":return ce(r);case"displayQuickFind":case"displayViewSelector":return!0}return null}function ue(){let e=null,t=null;return(r,n,i)=>{if(e&&t===n.CustomControlId)return e;const a=n&&n.CustomControlId?n.CustomControlId:null;if(!a)return null;const o=Object(f.ab)(r,a),s=Object(H.e)(r,a);if(o&&s&&s.Properties.DataSetDefinitions&&s.Properties.DataSetDefinitions[o]&&s.Properties.DataSetDefinitions[o].CDSDataSetOptions){const r=s.Properties.DataSetDefinitions[o].CDSDataSetOptions;e={displayChart:r.hasOwnProperty("displayChart")?r.displayChart:le(i,"displayChart",n),displayCommandBar:r.hasOwnProperty("displayCommandBar")?r.displayCommandBar:le(i,"displayCommandBar",n),displayIndex:r.hasOwnProperty("displayIndex")?r.displayIndex:le(i,"displayIndex",n),displayQuickFind:r.hasOwnProperty("displayQuickFind")?r.displayQuickFind:le(i,"displayQuickFind",n),displayViewSelector:r.hasOwnProperty("displayViewSelector")?r.displayViewSelector:le(i,"displayViewSelector",n)},t=n.CustomControlId}return e}}function de(){let e,t=null,r=null,c=null,v=null,S="",B=null,H=null,q=null,le=null,ue=null,de=null,he=null,ye=null;const fe=function(){let e=null;return(t,r,n,i)=>{let a=e;switch(Object(x.b)(i)&&(i=r.contextString),i){case y.h.ASSOCIATEDGRID:a=Object(l.b)(n);break;case y.h.SUBGRID:a=Object(l.l)(n);break;case y.h.GRID:default:a=Object(l.h)(n)}return a!==e&&(e=a),e}}(),ve=Object(I.a)(),Ce=C(),Se=function(){let e=null;const t=function(){let e=null;return(t,r,i)=>{let o,c,l,u,d;if(Object(f.ib)(t,r.id,i)){o=Object(f.T)(t,r.id,i);const e=Object(f.qb)(t,o,r.id);c=e&&e.entityLogicalName,d=e&&e.isUserView,l=Object(f.r)(t,r.id,i,c),u=Object(f.s)(t,r.id,i)!==b.a.savedvisualization}else{const e=Object(f.ab)(t,r.configuration.CustomControlId);if(e){const t=r.configuration.Parameters[e];t&&(o=t.ViewId&&new n.a(t.ViewId),c=t.TargetEntityType,l=t.VisualizationId&&new n.a(t.VisualizationId),u=!(!t.IsUserChart||"true"!==t.IsUserChart),d=!(!t.IsUserView||"true"!==t.IsUserView))}}if(!n.a.isNullOrEmpty(o)&&l&&c){const p=Object(f.q)(t,r.id,i),h=Object(f.p)(t,r.id,i),g=Object(f.C)(t,r.id,i),m=pe(t,r,i,g,!0),b=Object(f.N)(t,r.id,i),v=t.user&&t.user.userId,C=Object(k.c)(t,N.Zc),S=Object(V.a)(c,v,i,C),I=S&&S.getFilterAndLinkedEntities(g&&g.activityOrQueueFilterValue?g.activityOrQueueFilterValue:void 0),_=I&&null!==I.linkEntities?JSON.stringify(I.linkEntities):null,O=Object(k.a)(t,N.Od,N.h),T=!O||O&&Object(P.a)(t)===a.a.MobileApplication,j=O,E=ie(r.contextString)?Object(s.p)(y.d,c,n.a.toString(o),n.a.toString(l),i.relationshipName,b,u,d,m,_,j):Object(s.t)(y.d,c,n.a.toString(o),n.a.toString(l),b,p,u,h,d,m,_,T,j);if(e){const r=E&&E.CustomControlId?E.CustomControlId:null,n=Object(f.ab)(t,r);if(n&&E.Parameters[n]){const t=E.Parameters[n],r=e.Parameters[n];t.ViewId===r.ViewId&&t.VisualizationId===r.VisualizationId&&t.EntityName===r.EntityName&&t.HighchartFilterExpression===r.HighchartFilterExpression&&t.ChartDrillDownParameters===r.ChartDrillDownParameters&&t.ExtraFilters===r.ExtraFilters||(e=E)}}else e=E}else if(e&&c&&!l){const r=e.CustomControlId,n=Object(f.ab)(t,r);n&&e.Parameters[n]&&c!==e.Parameters[n].EntityName&&(e=null)}return e}}();return(r,n,i)=>{const a=t(r,n,i),o=n.id;return e&&e.configuration===a&&e.id===o||(e={configuration:a,id:o,chartId:y.d,showChart:!0,contextToken:i}),e}}(),Ie=function(){let e=null;return(t,r,n,i,a,o)=>{const s=o.commandBarStyle,c=r.id,l=oe(t,r,n&&n.parentContextToken?n.parentContextToken.entityTypeName:null,n),u=Object(f.w)(t,c,n);return e&&e.commandManagerId===u&&e.pageId===c&&e.ribbonId===a&&e.relationshipType===l&&e.contextToken===n&&e.style===s||(e={commandManagerId:u,pageId:c,ribbonId:a,relationshipType:l,contextToken:n,style:s}),e}}(),_e=function(){let e=null;const t=se();return(r,i,a,o,s,c)=>{var l;const d=c.viewSelectorStyle,h=n.a.toString(s),g=t(i),b=Object(f.nb)(i.id,h),y=ne(i.contextString),v=y,C=i.contextString,S=Object(f.Z)(r),I=Object(p.g)(r),_=Object(f.qb)(r,s,i.id),O=_?_.title:null;let T=u.a.MAIN_APPLICATION_VIEW;re(C)?T=u.a.SUB_GRID:y&&i.isAdvancedFindView&&(T=u.a.ADVANCED_SEARCH);const j=Object(m.a)(r,o,T),P=j||n.a.EMPTY,E=Object(R.g)(r,null==i?void 0:i.id),x=Object(f.rb)(r,null===(l=null==E?void 0:E.pageToEditedViewMapId)||void 0===l?void 0:l.guid,null==s?void 0:s.guid);return e&&e.id===b&&e.entityTypeName===o&&e.selectedViewId===h&&e.queryViewSelectorTypes===g&&e.shouldDisplayNestedViewSelector===v&&e.isRTL===I&&e.defaultViewId===P&&e.isEdited===!!x||(e={id:b,pageId:i.id,title:O,entityTypeName:o,selectedViewId:h,style:d,queryViewSelectorTypes:g,shouldDisplayNestedViewSelector:v,contextString:C,pinnedActivityView:S,isRTL:I,defaultViewId:P,isAdvancedFindView:i.isQueryMode&&i.isAdvancedFindView,isEdited:!!x,pageToEditedViewMapId:null==E?void 0:E.pageToEditedViewMapId}),e}}(),Oe=function(){let e=null;return(t,r,n,i,a)=>{const o=r.id,s=Object(f.G)(t,r),c=Object(p.w)(t),l=a.filterComboStyle,u=Object(R.g)(t,o).entityFilterValue;return e&&e.id===o&&e.entityTypeName===i&&e.filterOptions===s&&e.comboBoxStyle===l&&e.userSetting===c&&u===e.previousValue||(e={id:o,filterOptions:s,entityTypeName:i,updateFilterValue:null,onFilterChange:null,resourceStrings:null,userSetting:c,style:null,comboBoxStyle:l,previousValue:u}),e}}(),Te=function(){let e=null;return(t,r,n,i,a)=>{const o=r.id,s=Object(f.G)(t,r,i),c=Object(Y.a)(t),l=a.filterComboStyle,u=a.dueDateComboBoxStyles,d=a.activityTypeComboBoxStyles,h=Object(M.h)(t,n.relationshipName,ie(r.contextString)),g=!Object(F.b)(t),m=Object(f.kb)(t,o,n),b=Object(p.g)(t),y=Object(j.a)(t),v=Object(R.g)(t,o),C=v.entityFilterValue,S=v.activityTypeFilterValue,I=Object(k.a)(t,N.a,N.h),O=Object(k.a)(t,N.a,N.Lc),T=Object(f.ub)(t,i),P=Object(k.c)(t,N.Zc),E=Object(V.a)(i,t.user.userId,n,P,T),x=E&&E.getFilterLabelResourceKey(),A=_.ACTIVITY_MGMT_ACTIVITY_TYPE_LABEL,w=_.ACTIVITY_MGMT_DUE_DATE_LABEL;if(!e||e.id!==o||e.entityTypeName!==i||e.filterOptions!==s||e.comboBoxStyle!==l||e.dueDatecomboBoxStyle!==u||e.activityTypecomboBoxStyle!==d||e.labelStyle!==a.filterLabelStyle||e.activityMgmtLabelStyle!==a.activityMgmtLabelStyle||e.isActivityManagementFeatureEnabled!==I||e.filterOptionsForActivityType!==c||e.isRollupViewSupported!==h||e.isOffline!==g||e.toggleValue!==m||e.isRTL!==b||e.theme!==y||e.previousValue!==C||e.activityTypePreviousValues!==S||e.isActivityFilterSelectAllEnabled!==O||e.entityIsActivityType!==T){const t={isRollupViewSupported:h,isOffline:g,toggleValue:m,onToggleChange:null,isRTL:b,theme:y};e=Object.assign({id:o,filterOptions:s,filterOptionsForActivityType:c,entityTypeName:i,onFilterChange:null,onActivityTypeChange:null,onActivityTypeFilterClear:null,gridEntityName:null,resourceStrings:null,comboBoxStyle:l,dueDatecomboBoxStyle:u,activityTypecomboBoxStyle:d,containerStyle:null,activityTypeContainerStyle:null,labelStyle:a.filterLabelStyle,activityMgmtLabelStyle:a.activityMgmtLabelStyle,previousValue:C,activityTypePreviousValues:S,isActivityManagementFeatureEnabled:I,activityViewContainerStyle:a.activityViewContainerStyle,entityFilterLabelResourceString:x,activityTypeFilterLabelResourceString:A,dueDateFilterLabelResourceString:w,isActivityFilterSelectAllEnabled:O,isRTL:b,entityIsActivityType:T},t)}return e}}(),je=function(){let e=null;const t=[1041,2052,3076,1028,1042];return(r,n,i,a,o,s)=>{const c=r.id,l=r.descriptor&&r.descriptor.Id?r.descriptor.Id:null,u=o?JSON.parse(o).conditions[0]:null,d=function(e,t){if(t=t?t.value.replace("%","").toUpperCase():null,e){const r=ge(e.split(",")[0]),n=r[1].split("|");if(n&&t===n[0])return r[1]}return t}(Object(g.c)(s,_.JUMPBAR_ALPHABET),u);return t.indexOf(a)>-1?e=null:e&&e.id===c&&e.contextToken===n&&e.entityTypeName===i&&e.selectedFilter===d||(e={id:c,uniqueId:l,contextToken:n,entityTypeName:i,selectedFilter:d,languageId:a}),e}}(),Pe=function(){let e=null;return(t,r,n,i)=>{const{id:a,contextString:o}=t;return e&&e.id===a&&e.contextToken===r&&e.entityTypeName===n&&e.gridInput===i||(e={id:a,contextToken:r,entityTypeName:n,contextString:o,gridInput:i}),e}}(),Ee=function(){let e=null;return(t,r,n)=>{const{id:i,contextString:a}=t;return e&&e.id===i&&e.contextToken===r||(e={id:i,contextToken:r,contextString:a}),e}}(),xe=Object(g.h)(),Ae=function(){let e=null,t=null;const r={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},n={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1};let o=null;const s={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},c={Type:"WholeNumber.None",Usage:1,Static:!0,Value:!1,Primary:!1},l={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},u={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},d={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},p={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},g={Type:"TwoOptions",Usage:1,Static:!0,Value:!1,Primary:!1},m={Type:"TwoOptions",Usage:1,Static:!0,Value:!1,Primary:!1};let b,y,v={useSkypeProtocol:r,gridPageNumber:n,isNewPageRequested:s,enhancedPagingDisabled:c,isActivityTypeFilterDisabled:l,showAddNewCommand:u,emptySubgridIconAndTextChanges:d,emptyGridChangesIfQuickFindImprovementsEnabled:p,headerDialogOnTop:g,headerDialogPreventDismissOnScroll:m};return(C,S,I)=>{const _=Object(P.e)(C),j=Object(h.x)(C).useSkypeProtocol,E=Object(f.x)(C,S.id,I),x=Object(f.X)(C,S.id,I);x||o===E||(o=E),b||(b=Object(O.a)(C),y=null!=b&&b===T.b.Native);const A=!y,w=Object(k.a)(C,N.a,N.h),{systemDefinedProperties:F}=S,D=E!==o&&x,M=A!==c.Value;let R=!1;w&&(ie(S.contextString)||ne(S.contextString))&&(R=!0);let L=!1;Object(z.a)(C)&&re(S.contextString)&&(L=!0);let V=!1;Object(z.a)(C)&&Object(k.c)(C,N.Md)&&re(S.contextString)&&Object(P.a)(C)===a.a.MobileApplication&&(V=!0);let B=!1;if(Object(z.a)(C)&&Object(k.c)(C,N.ad)&&ne(S.contextString)&&Object(P.a)(C)===a.a.MobileApplication){const e=Object(f.C)(C,S.id,I);(null==e?void 0:e.quickFind)&&(B=!0)}const G=!ne(S.contextString)&&i.a.Tablet===_,X=i.a.Tablet===_&&!ie(S.contextString)||"Web"===Object(P.k)(C)&&!te.a.getInstance().get_IsAndroid()&&!te.a.getInstance().get_IsWindows()&&!te.a.getInstance().get_isIPhone();if(_!==e||j!==t||D||M||x!==s.Value||R!==l.Value||L!==u.Value||V!==d.Value||B!==p.Value||G!==g.Value||X!==m.Value){e=_,t=j,n.Value=E,o=E,s.Value=x,c.Value=A,l.Value=R,u.Value=L,d.Value=V,p.Value=B,g.Value=G,m.Value=X;const i=null==e?j:null;(i!==r.Value||D||M)&&(r.Value=i,v=Object.assign(Object.assign({},F),{useSkypeProtocol:r,gridPageNumber:n,isNewPageRequested:s,enhancedPagingDisabled:c,isActivityTypeFilterDisabled:l,showAddNewCommand:u,emptySubgridIconAndTextChanges:d,emptyGridChangesIfQuickFindImprovementsEnabled:p,headerDialogOnTop:g,headerDialogPreventDismissOnScroll:m}))}return v}}(),we=function(){let e=null,t=null;return(r,n,i)=>(r&&(t&&e===r&&!i||(t=Object.assign({},r),r.Parameters&&(t.Parameters=Object.assign({},r.Parameters),n&&r.Parameters[n]&&(t.Parameters[n]=Object.assign({},r.Parameters[n]),r.Parameters[n].Columns&&(t.Parameters[n].Columns=r.Parameters[n].Columns.slice(0)))),e=r)),t)}(),Fe=Object(E.s)(),Ne=function(){const e=[];return(t,r,n,i,a,o,s,c,l,u,d)=>(e&&e.length&&e.splice(0,e.length),e.push({name:L.b.IsGridRoot,value:t},{name:L.b.IsSubGrid,value:r},{name:L.b.IsAssociatedGrid,value:n},{name:L.b.EntityName,value:i},{name:L.b.ViewId,value:a},{name:L.b.IsEmptyFetch,value:o},{name:L.b.IsEmptyOfflineSqlQuery,value:s},{name:L.b.IsValidFetchXmlForOfflineUsage,value:c},{name:L.b.IsEntityAvailableForOfflineUsage,value:l},{name:L.b.OfflineConfigurationErrorCode,value:u},{name:L.b.RelatedEntityUnavailableOffline,value:d}),e)}(),ke=function(){let e=null;return t=>(e||(e={isGridPaginationStateFeatureEnabled:Object(k.a)(t,N.zb),isAssociatedGridHeightEnabled:Object(M.e)(t),isChartOnAssociatedGridEnabled:Object(k.a)(t,N.x,N.h,N.i),isGridProgressIndicatorFeatureEnabled:Object(k.a)(t,N.Ab),isInMobileModeForOct2019:Object(z.b)(t),isJumpBarShouldHonorSortingFeatureEnabled:Object(k.a)(t,N.ac),isJumpbarFeatureForMobileEnabled:Object(k.c)(t,N.Kb),isSuiterChartEnabled:Object(k.a)(t,N.Od,N.h),isSuiterDashboardEnabled:Object(k.a)(t,N.Pd,N.h),isAdvancedFindEnabled:Object(K.a)(t),isDisableEditableGridControlOnPhoneFeatureEnabled:Object(k.c)(t,N.O),isInMobileModeForApril2020:Object(z.a)(t),isSubgridImprovementsEnabled:Object(k.c)(t,N.Md),isSubGridAutoCollapseEnabled:Object(k.a)(t,N.Jd,N.Lc),isSubGridRemoveMinHeightEnabled:Object(k.a)(t,N.Ld,N.Lc),isQuickFindImprovementsEnabled:Object(k.c)(t,N.ad),isShowAsButtonFirstEnabled:Object(k.c)(t,N.Bd),isColumnEditorButtonEnabled:Object(f.tb)(t),isQueueFilterPerfUCIEnabled:Object(k.c)(t,N.Zc)}),e)}(),De=function(){let e={fetchXML:null,entityName:null,isOffline:null},t={error:!1,errorCode:null,relatedEntityUnavailableOffline:null};return function(r,n,i,a){if(e.entityName!==i||e.fetchXML!==n||e.isOffline!==a)if(Object(w.k)(i)){const o=Object(w.b)(r,n);t={error:o.error,errorCode:o.error?_.LINKED_ENTITY_NOT_SUPPORTED:null,relatedEntityUnavailableOffline:o.relatedEntityUnavailableOffline},e={fetchXML:n,entityName:i,isOffline:a}}else t={error:!0,errorCode:_.ACTIVITY_ENTITY_NOT_SUPPORTED_OFFLINE},e={fetchXML:n,entityName:i,isOffline:a};return t}}();return function(i,a){var s;const l=Object(p.w)(i),b=Ce(i,a),C=Object(f.v)(i,a.id,b),I=b.relationshipName,E=b.roleOrd,L=Object(f.N)(i,a.id,b),z=Object(f.I)(i,a.id,b),Y=Object(f.x)(i,a.id,b),K=a.descriptor,te=be.bind(null,a,K),oe=a.configuration,se=oe&&oe.CustomControlId?oe.CustomControlId:null,ge=Object(O.a)(i),Me=Object(P.e)(i),Re=Object(f.ab)(i,se)||(a.contextString===y.h.CUSTOM?y.g:null),Le=ne(a.contextString),Ve=ke(i),Be=Object(f.A)(i,b,a);let Ge=null,Xe=!1,Ue=null;const ze=Object(f.t)(i,a.id,b),He=Object(f.C)(i,a.id,b);Le&&(Ge=Object(R.g)(i,a.id),Ve.isGridPaginationStateFeatureEnabled&&(Ue=Ge.gridSortingInfo,Ue&&(Object(x.a)(le)||le!==Ue)&&(le=Ue,Xe=!0),ze&&(Object(x.a)(ue)||ue!==ze.customFilterXml)&&(ue=ze.customFilterXml,Xe=!0)),(He&&Object(x.a)(de)||de!==He)&&(de=He,Xe=!0));const qe=we(oe,Re,Xe),We=qe&&qe.Parameters?qe.Parameters[Re]:null,Ye=ie(a.contextString),Qe=re(a.contextString),Ke=!Object(F.b)(i),Je=Object(f.jb)(i,b,a),Ze=We&&!!We.DataProvider,$e=We&&!!We.BoundViewParams,et=Object(h.x)(i),tt=et&&et.gridTotalRecordCountLimit?et.gridTotalRecordCountLimit:5e3,rt=Object(f.ib)(i,a.id,b),nt=ce(a.configuration),it=ce(a.configuration);if(null!=a.nonCompositionProps){const e=oe&&oe.FormFactor&&oe.FormFactor.toString(),t=Object(D.c)(a.nonCompositionProps.gridConfigurations,a.nonCompositionProps.viewConfigurations,oe,null,y.h.GRID,e).map(e=>e.configuration.DisplayNameKey),r=xe(i,t);(!q&&""!==Object(g.c)(r,t[0])||q!==r)&&(q=r)}let at=!!C;let ot=Object(f.T)(i,a.id,b)||(K&&K.Parameters&&K.Parameters.ViewId?n.a.parse(K.Parameters.ViewId):null);const st=Object(f.qb)(i,ot,a.id),ct=(null==st?void 0:st.isUserView)?u.b.userview:u.b.savedview,lt=null==st?void 0:st.queryType,ut=null==st?void 0:st.entityLogicalName;ut&&ut!==c&&(c=ut);const dt=Object(d.h)(i,c),pt=!Ke&&ge===T.b.Web&&Le&&Ve.isAdvancedFindEnabled&&(null==dt?void 0:dt.IsValidForAdvancedFind);if(!H||e!==pt){let t=[..._.labelList];pt&&(t=[...t,Q.c.OpenAdvancedFiltersTitleAndAria]);const r=xe(i,t);""!==Object(g.c)(r,_.JUMPBAR_ALL_TITLE)?(H=r,e=pt):at=!1}const ht=Object(f.W)(i,se);ht&&ht!==B&&(B=ht);const gt=ve(i,a);ce(a.configuration)&&(Object.assign(gt.bodyStyle,{flexDirection:"column"}),Object.assign(gt.bodyMobileStyle,{flexDirection:"column"}));let mt=Object(f.F)(i,a.id,b)||(K&&K.Parameters&&K.Parameters[y.u]?K.Parameters[y.u]:null),bt=mt;Le&&(bt=Ge.entityTypeName);const yt=Object(A.b)(i,mt);dt&&dt.Initialized===o.a.Initialized||Ze||$e||(at=!1);const ft=dt?dt.DisplayName:"",vt=Object(h.t)(i),Ct=Object(d.i)(i,mt),St=!(st&&st.fetchXML),It=st&&st.viewId,_t=De(i,St?"":st.fetchXML,c,Ke),Ot=!St&&!_t.error,Tt=null!=st&&Object(x.b)(st.offlineSqlQuery),jt=Object(w.l)(i,c),Pt=Ne(Le,Qe,Ye,c,It?It.guid:null,St,Tt,Ot,jt,_t.error&&_t.errorCode||"",_t.error&&_t.relatedEntityUnavailableOffline||""),Et=!((Le||Ye||Qe)&&st&&st.fetchXML&&Ke&&jt)||!Tt&&Ot;let xt="";if(Et?jt||(xt=_.ENTITY_NOT_AVAILABLE_IN_PROFILE):Tt?xt=_.SQL_QUERY_NOT_AVAILABLE:_t.error&&(xt=_t.errorCode),We){We.TargetEntityType&&mt!==We.TargetEntityType&&(mt=We.TargetEntityType),We.ExtraFilters=pe(i,a,b,He,!1);const e=function(e,t,r,n,i){let a=[];const o=Object(f.q)(e,t.id,r);if(o){const e=JSON.parse(o);if(e.conditions)for(const t of e.conditions)t.linkEntityExpressions&&(a=a.concat(t.linkEntityExpressions))}const s=e.user&&e.user.userId,c=Object(k.c)(e,N.Zc),l=Object(f.ub)(e,n),u=Object(V.a)(n,s,r,c,l);let d=u&&u.getFilterAndLinkedEntities(i&&void 0!==i.activityOrQueueFilterValue?i.activityOrQueueFilterValue:G.a,i&&!i.activityOrQueue);d&&d.linkEntities&&(a=a.concat(d.linkEntities));return d=d||{filter:null,linkEntities:null},d.linkEntities=a,d}(i,a,b,mt,He);if(e&&e.filter&&(We.ExtraFilters?We.ExtraFilters.push(JSON.stringify(e.filter)):We.ExtraFilters=[JSON.stringify(e.filter)]),e&&e.linkEntities&&e.linkEntities.length>0){let t={Static:!0,Value:Object(X.b)(e.linkEntities)};if(We.LinkingInput){t=We.LinkingInput;const r=Object(X.a)(We.LinkingInput.Value);if(r){const n=new U.a;r.forEach(e=>{n.addLinkedEntity(e)}),e.linkEntities.forEach(e=>{n.addLinkedEntity(e)}),t.Value=Object(X.b)(n.getLinkedEntities())}}We.LinkingInput=t}if(ot){const e=n.a.toString(ot);e!==We.ViewId&&(We.ViewId=e)}else ot=n.a.tryParseOrNull(We.ViewId);(K&&K.Parameters?"false"===K.Parameters[y.F.ENABLE_CONTEXTUALACTIONS]:null)&&(qe.Parameters[y.i]={Usage:1,Static:!0,Type:"Enum",Value:!1,Primary:!1})}mt&&mt!==v&&(v=mt);const At=Object(d.r)(i,mt)&&a.contextString===y.h.GRID?f.a:mt,wt=We&&We.CommandBarContext,Ft=fe(i,a,At,wt),Nt=function(e,t,r){const n=Object(f.qb)(e,t,r);return n&&n.grid&&n.grid.rows&&n.grid.rows[0]&&n.grid.rows[0].cells}(i,ot,a.id),kt=null==Nt?void 0:Nt.map(e=>e.name),Dt=null==r?void 0:r.map(e=>e.name);(JSON.stringify(kt)!==JSON.stringify(Dt)||(ot&&ot.guid)!==(t&&t.guid)||I===he&&E!==ye)&&(t=ot,ye=E,S=(K&&K.Id?K.Id:"")+(new Date).getTime(),r=Nt),I&&I!==he&&(he=I);const Mt=Object(f.o)(i,mt),Rt=Mt?Mt.lookupAttribute:null;We&&(function(e,t,r,n,i,a,o){const s=Object(d.h)(e,n);if(s&&ce(t.configuration)){const c=y.b;r.Columns||(r.Columns=[]),n!==f.a||i&&i.some(e=>e.name===c)||r.Columns.find(e=>e.Name===c)||r.Columns.push({Alias:c,DataType:"",Type:"",Name:c});const l=s&&s.PrimaryNameAttribute,u=i&&i.some(e=>e.name===l);if(!l||u||r.Columns.some(e=>e.Name===l)||r.Columns.push({Alias:l,DataType:"",Type:"",Name:l}),!Object(f.vb)(t.configuration.Parameters)){const t=Object(M.a)(s.PrimaryImageAttribute);t&&!r.Columns.find(e=>e.Name===t)&&r.Columns.push({Alias:W.d,DataType:"SingleLine.Text",Type:"",Name:t}),Object(k.a)(e,N.ub)&&a&&o&&(r.Columns.find(e=>e.Name===f.c)||r.Columns.push({Alias:f.c,DataType:"Whole.None",Type:"",Name:f.c,PreventMetadataRequest:!0}),r.Columns.find(e=>e.Name===a)||r.Columns.push({Alias:a,DataType:"Lookup.Simple",Type:"",Name:a}))}}}(i,a,We,mt,r,Rt,!Object(x.a)(Ge)),function(e,t,r,n,i){if(!Object(f.vb)(t.configuration.Parameters))return;(null==i?void 0:i.some(t=>{var r;return(null===(r=Object(Z.a)(e,n,t.name))||void 0===r?void 0:r.Type)===$.a.moneyType}))&&(r.Columns.some(e=>e.Alias===y.A)||r.Columns.push({Alias:y.A,DataType:"Lookup.Simple",Type:"",Name:W.w}))}(i,a,We,mt,r));const Lt=!mt||(Object(A.i)(mt)||Object(A.g)(i,mt,2,0)&&function(e,t){let r=!0;t&&t.forEach(t=>{if(t.relatedEntityName&&(r=Object(A.g)(e,t.relatedEntityName,2,0),!r))return!1});return r}(i,r)),Vt=Object(f.Y)(i,a.id,b),Bt=Vt?JSON.parse(Vt):null,Gt=Bt?Bt.totalResultCount:null,Xt=Bt?Bt.pageSize:null,Ut=null!==Gt&&Gt>-1?0===Gt?Object(g.c)(H,_.NO_DATA_AVAILABLE):String.format(_.X_RECORDS_PRESENT,Gt):"",zt=Fe(i,Le),Ht=!(null!=ge&&ge===T.b.Native),qt=Object(f.rb)(i,null===(s=null==Ge?void 0:Ge.pageToEditedViewMapId)||void 0===s?void 0:s.guid,null==ot?void 0:ot.guid),Wt={isEmptyOfflineSqlQuery:Tt,isEntityAvailableForOffline:jt,isOfflineSqlQueryAvailable:Et,offlineErrorMessageKey:xt,isOfflineAvailableForUse:Object(J.w)(i),offlineGridErrorTelemetryParams:Pt},Yt=Object(ee.d)(i),Qt=Object(m.c)(i,t),Kt=!Ke&&ge===T.b.Web&&Le&&Ve.isColumnEditorButtonEnabled&&!Ye&&!Qe,Jt=Object(f.ub)(i,mt);return{showAdvancedFilter:pt,isViewEdited:!!qt,isInitialized:at,viewId:t,customFilter:ze,gridEntityTypeName:c,chartEntityTypeName:c,isUCIEntity:yt,totalRecordCountLimitExceeded:Je,chartProps:rt?Se(i,a,b):null,viewDescriptor:st,commandBarProps:te(y.E.COMMANDBAR_ENABLED,!0,y.F.ENABLE_CONTEXTUALACTIONS,Re,!0)?Ie(i,a,b,K,Ft,gt):null,viewSelectorProps:bt&&te(y.E.VIEWSELECTOR_ENABLED,!0,y.F.ENABLE_VIEW_PICKER,Re)?_e(i,a,b,bt,t,gt):null,queueFilterProps:oe&&te(null,!0,y.F.ENABLE_QUEUEFILTER,Re)?Oe(i,a,b,mt,gt):null,entityFilterProps:Ke||!Jt&&!Object(M.h)(i,he,Ye)?null:Te(i,a,b,mt,gt),jumpBarProps:te(y.E.JUMPBAR_ENABLED,nt,y.F.ENABLE_JUMPBAR,Re)&&me(a)?je(a,b,mt,l.languageId,He?He.jumpBar:null,H):null,quickFindProps:te(y.E.QUICKFIND_ENABLED,!0,y.F.ENABLE_QUICKFIND,Re)?Pe(a,b,mt,Ge):null,pagingProps:te(y.E.PAGING_ENABLED,it,null,Re)?Ee(a,b,mt):null,contextToken:b,controlKey:S,styles:gt,refreshCounter:L,pagingRefreshInput:z,pageNumber:Y,ribbonId:Ft,semanticTag:ae(a.contextString),recordsPerPageSetting:Object(p.h)(i),userSetting:l,hasReadRolePrivilege:Lt,resourceStrings:H,switchVisualizationResourceStrings:q,entityTypeName:v,primaryDataSetName:Re,nestedGridDatasetName:B,viewportSm:Object(j.a)(i).sizes.Breakpoints.DimensionS,viewportM:Object(j.a)(i).sizes.Breakpoints.DimensionM,systemDefinedProperties:Ae(i,a,b),platformType:Object(O.a)(i),isGridEditable:Object(f.vb)(oe?oe.Parameters:null),notificationMessage:Ut,totalResultCount:Gt,pageSize:Xt,offlineProps:Wt,isRTL:Object(p.g)(i),entityDisplayName:ft,isOffline:Ke,showChart:rt,entityIconVectorName:Ct,webResourceUrl:vt,hasCustomDataProvider:Ze,commandBarRefreshProps:zt,updatedConfiguration:qe,offlineGridErrorTelemetryParams:Pt,gridInput:Ge,gridTotalRecordsCountLimit:tt,gridSortingInfo:Ue,nativeFilterExpression:Ve.isGridPaginationStateFeatureEnabled&&Ge?Ge.nativeFilterExpression:null,pageNumberForEnhancedPaging:Ve.isGridPaginationStateFeatureEnabled&&!Ht&&Ge?Ge.gridPageNumber:null,userId:i.user&&i.user.userId||null,lookupAttributeForRecordHierarchy:Rt,fetchXML:Be,viewType:ct,savedQueryType:lt,featureControlProps:Ve,clientHostSubtype:Me,backButtonEnabled:Yt,originalView:Qt,showColumnEditor:Kt,entityIsActivityType:Jt}}}function pe(e,t,r,n,i){if(!n)return[];const a=ne(t.contextString),o=ie(t.contextString),s=re(t.contextString)&&Object(k.c)(e,N.bd),c=[];for(const e in n)c.push([e,n[e]]);const l=c.reduce((e,[t,r])=>((a||o||s)&&"quickFind"===t||("activityOrQueueFilterValue"===t||"activityTypeSelectedValues"===t)||!r||e.push(r),e),[]);if(i){const n=Object(f.t)(e,t.id,r);if(n&&n.customFilterXml){const e=Object(B.i)(n.customFilterXml),t=JSON.stringify(e);t&&l.push(t)}}else{const n=Object(f.q)(e,t.id,r);n&&l.push(n)}return l}function he(e){let t=e.configuration&&"MscrmControls.SharepointAssociatedGrid.SharepointControl"===e.configuration.CustomControlId;return t||(t=e.configuration&&"MscrmControls.SharepointAssociatedGrid.SharepointControl"===e.configuration.Name),t}function ge(e){if(!e&&"("!==e[0]||")"!==e[e.length-1])throw new Error(String.format("Resource string group must be in the format (A:a).  The format {0} is invalid.",e));const t=(e=(e=e.replace("(","")).replace(")","")).split(":");if(2!==t.length)throw new Error("Resource string group must have a search list defined.  E.g : (A:a).");return t}function me(e){var t,r,n;return"no"!==(null===(n=null===(r=null===(t=e.configuration)||void 0===t?void 0:t.Parameters)||void 0===r?void 0:r.EnableJumpBar)||void 0===n?void 0:n.Value)}function be(e,t,r,n,i,a,o){let s=e.dataSetUIOptions,c=n;if(o=!!Object(x.a)(o)||o,!s&&e.configuration&&e.configuration.Parameters){const t=e.configuration.Parameters[a];t&&t[y.f]&&(s=t[y.f])}const l=t&&t.Parameters&&t.Parameters[i]?"true"===t.Parameters[i]:o;return s&&r&&!Object(x.a)(s[r])&&(c=s[r]),c&&l}},kt5S:function(e,t,r){"use strict";r.d(t,"g",(function(){return v})),r.d(t,"i",(function(){return C})),r.d(t,"h",(function(){return S})),r.d(t,"e",(function(){return I})),r.d(t,"f",(function(){return _})),r.d(t,"a",(function(){return O})),r.d(t,"c",(function(){return j})),r.d(t,"b",(function(){return E})),r.d(t,"d",(function(){return T}));var n=r("BFlg"),i=r("P6DH"),a=r("arV0");function o(e,t,r,n){return{type:"update.grid.configuration",payload:{[t]:{[r]:e}},meta:{pageId:n}}}function s(e,t,r){return{type:"update.views.configuration",payload:{[t]:e},meta:{pageId:r}}}var c=r("oOvK"),l=r("9fGf"),u=r("Z/4N"),d=r("y60j"),p=r("SAYH"),h=r("KBcj"),g=r("S2mk"),m=r("5ZBI"),b=r("j6Db"),y=r("zmL5");function f(e,t){const r=Object.assign({},e.CustomControls);if(e.CustomControls[t]&&!e.CustomControls[t].isDefaultConfig){let n=!1;for(const r in e.CustomControls)if(O(e.CustomControls[r],e.CustomControls[t])&&r!==t.toString()){n=!0;break}if(!n){let n=-1;r[n]?n--:r[n.toString()]=e.CustomControls[t]}}return r[t]=null,r}function v(e,t,r,n,u){return{type:"customcontrol.changevisualization.homepage",sync:!0,execute({dispatch:d,getState:p},h){const g=p(),y=Object(l.b)(g),f=Object(i.k)(g,e,t),v={UniqueId:f?f.UniqueId:null,CustomControls:{[y]:Object.assign(Object.assign({},r),{FormFactor:y})},FormLibraries:f?f.FormLibraries:null,EventHandlers:f?f.EventHandlers:null},{entityTypeName:C}=Object(a.g)(g,e);if(u){const r=Object(i.T)(g,e,t);d(s({UniqueId:null,CustomControls:{[y]:null},FormLibraries:null,EventHandlers:null},r.guid,e))}d(Object(c.c)(r.CustomControlId)).then(()=>{d(o(v,C,n,e))},t=>{const i=Object(m.b)(p(),r.CustomControlId);h.EventManager.ReportComponentFailure(i+".CustomControl.retrieveControlManifest",t,"retrieveControlManifest failure error message",[{name:"APIName",value:b.a+".Actions.SwitchVisualization"},{name:"entityTypeName",value:C},{name:"customControlId",value:r.CustomControlId},{name:"pageId",value:e},{name:"controlId",value:n},{name:"config",value:JSON.stringify(r)}])})}}}function C(e,t,r,n,u){return{type:"customcontrol.changevisualization.homepage",sync:!0,execute({dispatch:d,getState:p}){const g=p(),m=Object(l.b)(g),b=Object(i.T)(g,e,t),y=Object(h.d)(g,b),v={UniqueId:y?y.UniqueId:null,CustomControls:{[m]:Object.assign(Object.assign({},r),{FormFactor:m})},FormLibraries:y?y.FormLibraries:null,EventHandlers:y?y.EventHandlers:null},{entityTypeName:C}=Object(a.g)(g,e);if(u){const r=Object(i.k)(g,e,t);if(r&&r.CustomControls&&r.CustomControls[m]){const t={UniqueId:r.UniqueId,CustomControls:f(r,m),FormLibraries:r.FormLibraries,EventHandlers:r.EventHandlers};d(o(t,C,n,e))}}d(Object(c.c)(r.CustomControlId)).then(()=>{d(s(v,b.guid,e))})}}}function S(e,t,r){return{type:"customcontrol.changevisualization.subgrid",sync:!0,execute({dispatch:n,getState:i}){const a=i(),s=Object(l.b)(a),p=Object(y.b)(a,e),h=Object(d.b)(a,e,p,r),g=Object(u.b)(a,h.UniqueId,p);if(!g||!g.CustomControls)return;const m={UniqueId:h.UniqueId,CustomControls:{[s]:Object.assign(Object.assign({},t),{FormFactor:s})},FormLibraries:g.FormLibraries,EventHandlers:g.EventHandlers};n(Object(c.c)(t.CustomControlId)).then(()=>{n(o(m,p.guid,g.UniqueId,e))})}}}function I(e,t,r,n,i){return{type:"customcontrol.changevisualization.associatedgrid.grid",sync:!0,execute({dispatch:a,getState:s}){const u=s(),d=Object(l.b)(u),p={UniqueId:i.UniqueId,CustomControls:{[d]:Object.assign(Object.assign({},n),{FormFactor:d})},FormLibraries:i.FormLibraries,EventHandlers:i.EventHandlers};a(Object(c.c)(n.CustomControlId)).then(()=>{a(o(p,t,r,e))})}}}function _(e,t,r,n,i,a,u){return{type:"customcontrol.changevisualization.associatedgrid.view",sync:!0,execute({dispatch:d,getState:p}){const h=p(),g=Object(l.b)(h),m={UniqueId:a.UniqueId,CustomControls:{[g]:Object.assign(Object.assign({},i),{FormFactor:g})},FormLibraries:a.FormLibraries,EventHandlers:a.EventHandlers};if(u&&u.CustomControls&&u.CustomControls[g]){const n={UniqueId:u.UniqueId,CustomControls:f(u,g),FormLibraries:u.FormLibraries,EventHandlers:u.EventHandlers};d(o(n,t,r,e))}d(Object(c.c)(i.CustomControlId)).then(()=>{d(s(m,n.guid,e))})}}}function O(e,t){if(e&&t){let r=!!e==!!t&&e.CustomControlId===t.CustomControlId&&e.Name===t.Name&&e.ShouldOverrideControlVisible===t.ShouldOverrideControlVisible&&e.Version===t.Version&&e.isDefaultConfig===t.isDefaultConfig&&function e(t,r){var n,i;if(t&&r&&t!==r){if(t instanceof Array&&r instanceof Array&&t.length!==r.length)return!1;for(const a in t)if(t[a]!==r[a]){if("function"==typeof t[a])continue;if(t[a]&&r[a]&&"object"==typeof t[a]&&"object"==typeof r[a]){if(e(t[a],r[a]))continue;return!1}if("EnableViewPicker"===a)return(null===(n=t[a])||void 0===n?void 0:n.toString())===(null===(i=r[a])||void 0===i?void 0:i.toString());if("ExtraFilters"!==a&&"PagingInput"!==a&&"FilteringInput"!==a&&"RefreshInput"!==a&&"ViewId"!==a&&"EntityName"!==a&&"LinkingInput"!==a&&"FirstDataRequestType"!==a&&"NativeFilterExpressionToRestore"!==a&&"LookupAttributeNameForHierarchy"!==a&&"SortingInput"!==a&&"function"!=typeof t[a])return!1}}return!0}(e.Parameters,t.Parameters);if(e.Children&&t.Children){if(Object.keys(e.Children).length===Object.keys(t.Children).length){for(const n in e.Children)r=r&&O(e.Children[n],t.Children[n]);return r}return!1}return r&&e.Children===t.Children}return!!e==!!t}function T(e,t,r,n,i,a,o,s){const c=t?t.TraceManager.getTracer("customcontrol"):null;return e(j(r,n,a.configuration,a,a.contextString,s).map(e=>e.configuration.DisplayNameKey)).catch(e=>(c&&c.info("Resource retrieve failed: "+e.message),Promise.resolve()))}function j(e,t,r,i,a,o){const s=[];if(null==o)return s;if(a===n.h.CUSTOM&&i.configuration.isDefaultConfig)return s;const c=a===n.h.GRID||a===n.h.ASSOCIATEDGRID?Object(g.u)(i&&i.controlId,i&&i.gridEntityTypeName,i&&p.a.toString(i.viewId)):Object(g.x)(i&&i.controlId,i&&i.descriptor.Parameters);return s.push({configuration:c,formFactor:o,configurationType:null}),e&&e.CustomControls&&P(s,e,"GRID_CONFIG"),t&&t.CustomControls&&P(s,t,"VIEW_CONFIG"),s}function P(e,t,r){for(const n in t.CustomControls)if(t.CustomControls[n]&&!t.CustomControls[n].isDefaultConfig){let i=!1;for(let r=0;r<e.length;r++)if(O(e[r].configuration,t.CustomControls[n])){i=!0;break}i||e.push({configuration:t.CustomControls[n],formFactor:n,configurationType:r})}}function E(e,t){return null!=t.DisplayNameKey?null!=e&&null!=e[t.DisplayNameKey]?e[t.DisplayNameKey]:t.DisplayNameKey:"Grid"}},lEp6:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(e){let t=null;try{t=JSON.parse(e)}catch(e){}return t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e){let t="";try{t=JSON.stringify(e)}catch(e){}return t}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}))},"lIi+":function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("WLAV"),i=r("ruPX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function a(e,t,r,a,o,s,c,l){const u={powerBIEmbedUrl:t,powerBIGroupId:r,powerBIDashboardId:a,powerBITileId:o,powerBIReportId:s,powerBIReportUrl:c,powerBIComponentTypeCode:l};return Object(i.a)(n.a,u,e,{target:"dialog"})}},ldWj:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n=r("0nOn"),i=r("ScMg"),a=r("i1f0"),o=r("Sbn7"),s=r("16wZ"),c=r("vlcQ"),l=r("3MuQ"),u=r("qshH"),d=r("ZIjf"),p=r("IaGr");let h;class g extends i.a{constructor(e,t,r,i,a,o){super(e,t,r,i),this._parent=a,h=e,this._formContext=o,this._iConnectedSectionProp={sectionName:this.name,id:this.pageId},this._clientApiExecutorTabSection=new n.a(e,"ClientApi.XrmTabSection.",r,t),this.clientApiExecutor.addEventParameter({name:"controlName",value:i,isEventParam:!0})}get clientApiExecutor(){return this._clientApiExecutorTabSection}get controls(){return this.clientApiExecutor.execute("controls",(e,t)=>{if(!this._controls){const r=h.getState();this._controls=new o.a(e);const n=this.getControlsDescriptor(r);if(!n)return this._controls;for(const r in n){const n=this._formContext.ui.controls.get(r);if(n)this._controls.add(n.getName(),n);else{const n=t.slice();n.push({name:"controlKey",value:r}),p.a.getInstance().traceManager.getTracer(e).warn("Section control was not found in the form controls collection",n)}}}return this._controls})}getParent(){return d.a.instance.reportUsage("ClientApi.XrmTabSection.getParent"),this._parent}getVisible(){const e="ClientApi.XrmTabSection.getVisible";try{d.a.instance.reportCall(e);const t=Object(a.tc)(h.getState(),this._iConnectedSectionProp,this.contextToken),r=Object(s.a)(t)?this._getSectionDescriptorValues().Visible:t;return d.a.instance.reportSuccess(e),r}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(e,t,null,r),t}}getLabel(){const e="ClientApi.XrmTabSection.getLabel";try{d.a.instance.reportCall(e);const t=Object(a.rc)(h.getState(),this._iConnectedSectionProp,this.contextToken),r=Object(s.a)(t)?this._getSectionDescriptorValues().Label?this._getSectionDescriptorValues().Label:"":t;return d.a.instance.reportSuccess(e),r}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(e,t,null,r),t}}_getSectionDescriptorValues(){try{return Object(a.qc)(h.getState(),this._iConnectedSectionProp,this.contextToken)}catch(e){const t=u.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure("ClientApi.XrmTabSection._getSectionDescriptorValues",e,null,t),e}}getControlsDescriptor(e){try{return Object(a.H)(e,this._iConnectedSectionProp,this.contextToken)}catch(e){const t=u.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure("ClientApi.XrmTabSection.getControlsDescriptor",e,null,t),e}}setVisible(e){const t="ClientApi.XrmTabSection.setVisible";try{d.a.instance.reportCall(t),h.dispatch(Object(c.b)(this.pageId,this.contextToken,this.name,!0===e)),d.a.instance.reportSuccess(t)}catch(e){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(t,e,null,r),e}}setLabel(e){const t="ClientApi.XrmTabSection.setLabel";Object(s.a)(e)&&Object(s.j)(t,"label");try{d.a.instance.reportCall(t),h.dispatch(Object(l.b)(this.pageId,this.contextToken,this.name,e)),d.a.instance.reportSuccess(t)}catch(e){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(t,e,null,r),e}}}},"m+2h":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="footer.visible";function a(e,t,r){const a=Object(n.v)(t);return{type:i,payload:r,meta:{pageId:e,contextKey:a}}}},meVR:function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n=r("+zjj"),i=r("+Ajx"),a=r("6Qf/"),o=r("P6DH"),s=r("d0w6"),c=r("KBcj"),l=r("vNXc"),u=r("a72m"),d=r("BFlg"),p=r("pEXn"),h=r("5R5s"),g=r("hSDL"),m=r("aF0N"),b=r("Ii8m"),y=r("69Qu"),f=r("jAuy"),v=r("eXjw"),C=r("Lyxw"),S=r("3/02"),I=r("fyfl"),_=r("FZDd");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const O=`${d.x}.${d.v}`;function T(e,t,r,n,i,s,u,d,p,m){const b=P(n,u,p),v=Object(c.c)(t,r);if(!v)return Promise.resolve(null);const I=l.a.fromXmlAndSql(v.fetchXML,v.offlineSqlQuery,r).getQueryState(),_=m||Object(o.db)(t,n,u),O=Object(f.c)(i,s);let T=!1;Object(y.b)(t)&&Object(f.h)(t,s.relationshipName,!0)&&(T=!0);const E=Object(o.ub)(t,n);if(E||"activitypointer"===n||T){const r=t.user&&t.user.userId,o=Object(C.c)(t,S.Zc),c=Object(h.a)(n,r,s,o,E);return e(c.getFilterOptionsAction()).then(r=>{if(r&&r.length>0){const t=r.filter(e=>e.isDefault);if(t&&t.length>0){const r=c.getFilterExpression(t[0].value);e(Object(g.l)(r,i,s))}}return e(Object(a.d)(I,n,i,s,null,u,_,T,O)).then(r=>j(e,r,t,n,i,b,d))})}return e(Object(a.d)(I,n,i,s,null,u,_,void 0,O)).then(r=>j(e,r,t,n,i,b,d))}function j(e,t,r,n,i,s,c){const l=Object(m.c)(r),u=Object(m.b)(r);return(l||u)&&Object(o.sb)(r,n)&&Object(a.e)(c,e,n,i),c.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid.initializeRelatedGrid",s),c.EventManager.ReportComponentSuccess(O,s),t}function P(e,t,r){return[{name:p.a.CorrelationId,value:r.correlationId},{name:p.a.ContextId,value:r.contextId},{name:p.a.ActionStack,value:r.stack},{name:"entityName",value:e},{name:"relationshipName",value:t}]}function E(e,t,r){const a=[{name:"EntityName",value:r.entityName}];return{type:"form.related.openGrid",execute({dispatch:a,getState:l},d,h){const g=l(),m=Object(n.e)(g,{id:e},t.parentContextToken),y=P(r.entityName,r.relationshipName,h);if(a(Object(i.b)(e,t,r)),null!==m&&m.id===r.id&&m.isSelected===r.isSelected&&m.relationshipName===r.relationshipName||a(Object(i.b)(e,t.parentContextToken,r)),a(Object(b.a)(e,r)),r&&!r.url){const n=function(e,t){return[{name:p.a.CorrelationId,value:e.correlationId},{name:p.a.ContextId,value:e.contextId},{name:p.a.ActionStack,value:e.stack},{name:"hasViewId",value:!0},{name:"entityName",value:t}]}(h,r.entityName);if(!Object(o.v)(g,e,t)){a(Object(u.b)(r.entityName,s.a.MAIN_APPLICATION_VIEW));const i=Object(c.a)(g,r.entityName,s.a.SUB_GRID),o=Object(c.c)(g,i),p=Object(C.c)(g,S.Xc),m=!p||function(e,t){var r,n,i;if(!(null===(n=null===(r=null==t?void 0:t.grid)||void 0===r?void 0:r.rows)||void 0===n?void 0:n.length)||!(null===(i=e.metadata)||void 0===i?void 0:i.entities))return!0;const a=t.grid.rows[0].cells;if(!(null==a?void 0:a.length))return!0;for(let t=0;t<a.length;t++)if(a[t].relatedEntityName&&!e.metadata.entities[a[t].relatedEntityName])return!1;return!0}(g,o);return o&&o.initialized===v.a.Initialized&&m?(T(a,g,i,r.entityName,e,t,r.relationshipName,d,h,r.ordinal).catch(e=>{d.EventManager.ReportComponentFailure(O,e,null,y)}),d.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid",n),Promise.resolve(i)):a(Object(u.a)(r.entityName,s.a.SUB_GRID)).then(i=>{let o=Promise.resolve();if(p){const t=Object(I.a)(g,i,e);o=a(Object(_.e)(t))}return o.then(()=>{const o=l();return T(a,o,i,r.entityName,e,t,r.relationshipName,d,h,r.ordinal).catch(e=>{d.EventManager.ReportComponentFailure(O,e,null,y)}),d.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid",n),i})},e=>{d.EventManager.ReportComponentFailure(O,e,null,y)})}}return Promise.resolve(null)},getFailureParameters:(e,t)=>a}}},mhYf:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return p}));var n=r("dHD5"),i=r("i1f0"),a=r("TYIz"),o=r("+zjj"),s=r("wL2W"),c=r("4aOd"),l=r("pEXn"),u=r("tWr6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d="tab.visible";function p(e,t,r,p){return{type:"tab.visible.sync",sync:!0,execute({dispatch:h,getState:g},m){var b;const y=g();h(function(e,t,r,i){const a=Object(n.v)(r);return{type:d,payload:i,meta:{pageId:e,tabId:t,contextKey:a}}}(e,t,r,p));const f=Object(i.wc)(y,{id:e},r),v=Object(o.e)(y,{id:e},r);if(f||(null==v?void 0:v.isSelected)||!p){if(f===t&&!p){const n=Object(i.fb)(y,{id:e},r);let o=!1;if(n){const s=Object(i.m)(y,n);for(const n of s)if(n.Id!==t&&Object(i.Kc)(y,n.Id,e,r)){o=!0,h(Object(a.b)(e,n.Id,r));break}}o||h(Object(a.b)(e,void 0,r))}}else h(Object(a.b)(e,t,r));if(Object(s.a)()){const n=g(),a=null===(b=null==m?void 0:m.TraceManager)||void 0===b?void 0:b.getTracer(`${l.k}${l.r}`),o=Object(i.Kc)(y,t,e,r),s=Object(i.Kc)(n,t,e,r),d=Object(u.a)(n,e);d.push({name:"tabId",value:t}),d.push({name:"tabName",value:Object(i.Ic)(n,t,e,r)}),d.push({name:"tabLabel",value:Object(i.Hc)(n,t,e,r)}),d.push({name:"visible state before change",value:null==o?void 0:o.toString()}),d.push({name:"visible state after change",value:null==s?void 0:s.toString()}),d.push({name:"callstack",value:new c.a(new Error).getStackTrace()}),null==a||a.warn(l.n,[{name:l.v,value:l.r+".visible"},{name:l.r,value:JSON.stringify(d)}])}}}}},mlKL:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return p}));var n=r("arV0"),i=r("jRy5"),a=r("dHD5"),o=r("ApeL"),s=r("i1f0"),c=r("mIxf"),l=r("bT7G"),u=r("WPtp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d="attribute.requiredLevel";function p(e,t,r,p){return{type:"attribute.requiredLevel.validation",sync:!0,execute(h,g){const m=h.getState();if(p!==Object(s.pc)(m,e,t,r)){h.dispatch(function(e,t,r,n){if(t&&t.contextTokenType&&t.contextTokenType===i.a.GridRow)return Object(o.f)(e,t,r,n);const s=Object(a.x)(t);return{type:d,payload:n,meta:{pageId:e,contextKey:s,dataFieldName:r}}}(e,t,r,p));const g=Object(s.ac)(m,e,t),b=Object(l.b)(m,g);if((0===p||3===p)&&b&&b.activeChanges&&b.activeChanges[r]||t&&t.contextTokenType&&t.contextTokenType===i.a.GridRow){let o=null,d=null,p=null,b=null;if(t&&t.contextTokenType&&t.contextTokenType===i.a.GridRow)o=t.entityTypeName?t.entityTypeName:null,d=t.recordId?t.recordId:null,p=Object(a.t)(t),b=Object(a.r)(t);else{const r=Object(n.g)(m,e);o=r&&r.entityTypeName?r.entityTypeName:null,d=r&&r.id?r.id:null,p=null,b=t}const y=Object(l.d)(m,g,{etn:o,id:d},r);if(Object(s.Uc)(y)){const t={[r]:{fieldName:r,value:y?y.formatted?y:Object(u.e)(y):y}};h.dispatch(Object(c.a)(e,t,!0,!0,o,d?d.guid:null,p,b))}}}}}}},nIfK:function(e,t,r){"use strict";r.d(t,"a",(function(){return N})),r.d(t,"e",(function(){return D})),r.d(t,"d",(function(){return L})),r.d(t,"b",(function(){return R})),r.d(t,"c",(function(){return M}));var n=r("Yx7Y"),i=r("SAYH"),a=r("vNXc"),o=r("9fGf"),s=r("Z/4N"),c=r("P6DH"),l=r("p/2N"),u=r("iZ7K"),d=r("sn0j"),p=r("y60j"),h=r("BJ7u"),g=r("JwRZ"),m=r("504W"),b=r("IqkD"),y=r("CB5L"),f=r("odYE"),v=r("i1f0"),C=r("bT7G"),S=r("00VO"),I=r("YGjz"),_=r("LbMF"),O=r("BFlg"),T=r("Lyxw"),j=r("3/02"),P=r("jAuy"),E=r("/Zy9"),x=r("arV0"),A=r("z+5+"),w=r("d0w6"),F=r("AF/G");const N=["MscrmControls.Grid.ReadOnlyGrid","MscrmControls.Grid.GridControl","MscrmControls.SharepointAssociatedGrid.SharepointControl","MscrmControls.MailApp.MailAppListControl"],k=["Opportunity_ActivityPointers"];function D(e){const t=e&&e.control&&e.control.Parameters&&e.control.Parameters.hasOwnProperty(O.r)&&e.control.Parameters[O.r],r=[e.viewId,t,e.recordsPerPage,(n=e,n&&n.controlParameters&&n.controlParameters.ChartDrillDownParameters&&n.controlParameters.ChartDrillDownParameters.length>0)];var n;return e.customQueryStateKeyParts&&r.push(...e.customQueryStateKeyParts),r.join("")}function M(e,t,r,n,i){const o=R(e,t,r,n,i);return t=>{const r=o(t);return r&&r.getQueryState(r instanceof a.a?void 0:e)}}function R(e,t,r,n,s){const l={};return u=>{const d=new i.a(u.viewId),p=Object(c.qb)(e(),d,t);if(!p)return null;const h=function(e,t,r){let n=t.fetchXML,i=null;const a="TeamTemplateId";if(t.entityLogicalName===I.a&&e.controlParameters[a]){const t=e.controlParameters[a];if(n&&n.indexOf(t)<0){const e=r?r.guid:"",a=Object(S.a)(n,t,e);n=a.updatedFetchXml,i=a.filterString}}return{fetchXML:n,filterString:i}}(u,p,n);let O=h.fetchXML;if(!O&&p.queryApi)return null;if(Object(P.l)(e())&&u.quickFindViewId){const r=new i.a(u.quickFindViewId),n=i.a.isNullOrEmpty(r)?null:Object(c.qb)(e(),r,t);Object(m.a)(n)||(O=function(e,t){const r=new DOMParser;if(e){const n=r.parseFromString(e.fetchXML,"text/xml"),i=r.parseFromString(t.fetchXML,"text/xml"),a=n.getElementsByTagName("filter");for(let e=0;e<a.length;e++)a[e].attributes&&a[e].attributes.getNamedItem("isquickfindfields")&&i.getElementsByTagName("entity")[0].appendChild(a[e]);return(new XMLSerializer).serializeToString(i)}return t.fetchXML}(n,p))}const N=e(),D=u.entityLogicalName,M=u.getCustomFilter&&u.getCustomFilter(),R=function(e,t,r,n,a){const o=a.controlParameters.RelationshipName;if(o){let s=n,l=null,u=null;if(a.controlParameters.DependentAttributeName){u=a.controlParameters.DependentAttributeName;l=u.split(".")[1]||u}if(a.controlParameters.IsDataSetLookup&&(s=null==a.controlParameters.ParentRecordId?i.a.EMPTY:new i.a(a.controlParameters.ParentRecordId),a.controlParameters.DependentAttributeName)){u=a.controlParameters.DependentAttributeName;l=u.split(".")[1]||u}const d=Object(v.ac)(e,t,a.contextToken),p=new f.a(r,s);let h=null,g=!1;Object(_.a)(e,r,l)?h=Object(C.d)(e,d,p,l):a.controlParameters.DependentAttributeType&&(g=a.controlParameters.DependentAttributeType===r&&a.controlParameters.DependentAttributeType!==a.entityLogicalName);const m=h;m&&m.reference?s=m.reference.id:!a.controlParameters.IsDataSetLookup&&null===l||null!==m&&null!==m.reference||!p||null===p.id||g||(s=null);const b=Object(c.kb)(e,t,a.contextToken);let S=0,I=y.h.None;return b?(S=1,-1===k.indexOf(o)&&(I=y.h.Related)):(a.controlParameters.ShouldApplyContextFilter&&a.controlParameters.IsDataSetLookup||!a.controlParameters.IsDataSetLookup)&&(S=2),{type:S,rollupType:I,entityReference:p,contextId:s,relationshipName:o}}return null}(N,t,s||r&&r.EntityLogicalName,n,u),V=Object(g.p)(e(),D),B=function(e,t,r,n,a,o,s){var l;const u=Object(x.g)(e,o),d=!(!(null==u?void 0:u.pageToEditedViewMapId)||!Object(c.rb)(e,u.pageToEditedViewMapId.guid,s.guid)),p=Object(c.qb)(e,s,o),h=t.hasGrid&&(1===t.gridType||void 0===t.gridType&&i.a.equals(null===(l=t.control)||void 0===l?void 0:l.ClassId,F.E));return Object(A.e)(e)&&(h||Object(A.f)(e))&&!(1===(null==r?void 0:r.type))&&!(2===(null==r?void 0:r.type))&&!(n&&n.linkEntities&&Array.isArray(n.linkEntities)&&n.linkEntities.length>0)&&!a&&!(n&&n.filter&&Array.isArray(n.filter)&&n.filter.length>0)&&!d&&(null==p?void 0:p.queryType)!==w.a.QUICKFIND_SEARCH&&!t.quickFindViewId}(N,u,R,M,V,t,d)?E.a.fromView(d,u.quickFindSearchString):a.a.fromXmlAndSql(O,p.offlineSqlQuery,d,u.quickFindSearchString,D,e);(null==h?void 0:h.filterString)&&n&&B.addExistingContextFilterToKey(i.a.toString(n),h.filterString);const G=Object(c.x)(e(),t,u.contextToken);G&&(B.pageNumber=G);const X=L(e(),t,r,u,p,D);X.length&&B.select(...X);const U=function(e,t,r,n,i,a){let s=null;if(!Object(T.a)(e,j.ub)||!a.hasGrid||1!==a.gridType)return null;const l=Object(c.j)(n)(e,t,a.contextToken),u=Object(o.b)(e),d=l&&l.CustomControls&&l.CustomControls[u]&&l.CustomControls[u].Parameters;if(!Object(c.vb)(d)&&(s=Object(c.o)(e,r),s)){const e=[],t=i&&i.grid&&i.grid.rows&&i.grid.rows[0]&&i.grid.rows[0].cells;if(t)for(const r in t)t.hasOwnProperty(r)&&e.push(t[r].name);-1!==e.indexOf(s.lookupAttribute)&&(s.lookupAttribute=null),i&&i.fetchXML&&Object(P.b)(i.fetchXML)&&(s.primaryAttribute=null)}return s}(e(),t,D,d,p,u);U&&(U.lookupAttribute&&B.select(U.lookupAttribute),U.primaryAttribute&&B.addChildCountAttribute(U.primaryAttribute));const z=u.getCustomSorting&&u.getCustomSorting(p,l);if(z)for(const e of z)B.orderBy(e.name,1===e.sortDirection);if(R)switch(R.type){case 1:B.applyRollupContextFilter(R.entityReference,R.rollupType);break;case 2:const e=Object(c.v)(N,t,u.contextToken);B.applyContextFilter(R.relationshipName,R.contextId,N,e?e.relationshipRoleOrdinal:void 0)}if(V&&B.where(V),M&&M.filter)if(Array.isArray(M.filter)){const e=M.filter;for(const t of e)B.where(t,t.shouldReplace)}else{const e=M.filter;!function(e){return!!(e&&e.operator&&e.terms)}(e)?B.where(Object(g.n)(M.filter,null)):B.where(e,e.shouldReplace)}if(M&&M.linkEntities)for(const e of M.linkEntities)B.addLinkedEntity(e,e.attributes||[]);const H=u.recordsPerPage;if(H)B.pageSize=H;else{const t=Object(b.h)(e());u.hasChart||Object(m.a)(t)?B instanceof a.a&&B.setDefaultPageSize():B.pageSize=t}return B}}function L(e,t,r,n,i,a){const o=[...V(e,r,n,i.viewId),...B(e,n,a,i.viewId),...G(e,r,n,a),...X(e,n,a),...U(e,t,n,a),...n.getCustomColumns?n.getCustomColumns():[]];if(o.length){const e=[],t=[],r=i&&i.grid&&i.grid.rows&&i.grid.rows[0]&&i.grid.rows[0].cells;if(r)for(const e in r)r.hasOwnProperty(e)&&t.push(r[e].name);for(const r in o){const n=o[r];-1===t.indexOf(n)&&-1===e.indexOf(n)&&e.push(n)}return e}return o}function V(e,t,r,n){if(0!==r.gridType)return[];let i="Grid";const a=Object(o.b)(e),u=t&&Object(s.a)(r.control,t,a);return u&&(i=Object(c.ab)(e,u.CustomControlId)),Object(l.b)(e,r.control.UniqueId,i,t&&t.Id,null,null,n)||[]}function B(e,t,r,n){return 1!==t.gridType?[]:Object(l.a)(e,r,n)||[]}function G(e,t,r,n){const i=[],a=Object(u.h)(e,n);return a&&(function(e,t,r){const n=Object(o.b)(e),i=t&&Object(s.a)(r.control,t,n);return i&&[i.CustomControlId&&i.Name].some(e=>-1!==N.indexOf(e))}(e,t,r)||r.hasGrid)&&("activitypointer"===n&&i.push("activitytypecode"),a.PrimaryNameAttribute&&i.push(a.PrimaryNameAttribute),Object(c.vb)(r.controlParameters)||a.PrimaryImageAttribute&&i.push(Object(P.a)(a.PrimaryImageAttribute))),i}function X(e,t,r){const n=[];if(4&t.streamMode){n.push("modifiedon");const t=Object(_.d)(e,r);if(t)for(const i in t){const a=t[i];a.IsSortableEnabled&&"image"!==a.Type&&"multiselectpicklist"!==a.Type&&Object(d.b)(e,r,a.LogicalName,a)&&n.push(a.LogicalName)}}else 2&t.streamMode&&n.push("modifiedon");return n}function U(e,t,r,a){const o=[],s=r.cardFormId;if(s)if("activitypointer"===a)o.push(...d.a);else{const r=i.a.equals(s,n.a)?Object(p.h)(e,a,Object(h.a)(11)):s,c=Object(p.d)(e,r,t);if(c)for(const e in c){const t=c[e];t.DataFieldName&&o.push(t.DataFieldName)}}return o}},ojtV:function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return v}));var n=r("dHD5"),i=r("BFlg"),a=r("dQnL"),o=r("KBcj"),s=r("SAYH"),c=r("P6DH"),l=r("CngE"),u=r("iZ7K"),d=r("qwRa"),p=r("WK+4"),h=r("BzGi"),g=r("EY5k"),m=r("GEBM"),b=r("69Qu"),y=r("LAGg");const f="chart.showChart.update";function v(e,t,r){return{type:"chart.showChart.update.async",execute({dispatch:f,getState:v},S){const I=S.TraceManager.getTracer(i.z),_=i.x+".updateShowChartAction";try{I.info("Updating the show chart"),t||(t=Object(n.k)(v(),e));const i=v(),O=Object(n.v)(t),T=Object(c.T)(i,e,t),j=Object(o.c)(i,T),P=j&&j.entityLogicalName;let E=Object(c.r)(i,e,t,P),x=Object(c.s)(i,e,t);const A=Object(l.a)(i,E),w=A&&A.PrimaryEntityTypeCode,F=w&&Object(u.m)(i,parseInt(w,10));P&&F&&P!==F&&(E=null,x=h.a.savedvisualization);const N=Object(l.i)(i,P);if(E&&N&&N.chartTypes&&Object.keys(N.chartTypes).length>0){const e=s.a.toString(E);x=e in N.chartTypes[h.a[h.a.savedvisualization]]?h.a.savedvisualization:h.a.uservisualization}if(!r)return f(C(e,O,r)),S.EventManager.ReportComponentSuccess(_),Promise.resolve();if(!Object(b.b)(v()))return Promise.resolve();return f(Object(g.e)(m.A)).then(()=>{f(Object(a.a)(P,x,E)).then(r=>s.a.isNullOrEmpty(r)?(x=h.a.uservisualization,f(Object(d.b)(e,t,x)).then(()=>f(Object(a.a)(P,x,E)).then(e=>Promise.resolve(e)))):Promise.resolve(r)).then(n=>{const i=s.a.toString(n);Promise.all([f(Object(p.b)(e,t,i)),f(Object(d.b)(e,t,x)),f(C(e,O,r))]).then(()=>(S.EventManager.ReportComponentSuccess(_),f(Object(y.b)(e,t)),Promise.resolve()))})}).catch(e=>(S.EventManager.ReportComponentFailure(_,Error("Retrieve resource strings for chart failed")),Promise.reject(e))),Promise.resolve()}catch(e){const t="Update the show chart failed with error : "+e.message;S.EventManager.ReportComponentFailure(_,Error(t))}}}}function C(e,t,r){return{type:f,payload:{name:"showChart",value:r},meta:{pageId:e,dataSetContextKey:t}}}},pp6D:function(e,t,r){"use strict";r.d(t,"b",(function(){return N})),r.d(t,"a",(function(){return F})),r.d(t,"c",(function(){return D})),r.d(t,"e",(function(){return M})),r.d(t,"d",(function(){return R}));var n=r("2yvP"),i=r("jRy5"),a=r("IaGr"),o=r("9ksH"),s=r("tpZ5"),c=r("G0J3"),l=r("COKI"),u=r("uOtn"),d=r("OtHk"),p=r("SAYH"),h=r("Zw8F"),g=r("pnQK"),m=r("0nOn"),b=r("+baL");let y;class f extends h.a{constructor(e,t,r,n){super(e,t,r,n),this._dashboardId=e,y=r,this._clientApiExecutor=new m.a(r,"ClientApi.XrmDashboardSelectorItem.",n)}_getEventParams(){return this._commonEventParams||(this._commonEventParams=[{name:"dashboardId",value:p.a.toString(this._dashboardId),isRequired:!1,isEventParam:!0}])}get isBoundDashboard(){return this._clientApiExecutor.execute("isBoundDashboard_get",()=>{const e=Object(g.a)(y.getState(),this._dashboardId);return!e||1032==+e.Type},this._getEventParams())}get isUserDashboard(){return this._clientApiExecutor.execute("isUserDashboard_get",()=>{const e=Object(g.a)(y.getState(),this._dashboardId);return Object(g.c)(e)},this._getEventParams())}navigate(){this._clientApiExecutor.executeAsync("navigate",()=>y.dispatch(Object(b.a)(null,this._dashboardId,null,null,null,null,this.getPageId())),this._getEventParams())}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class v extends u.b{constructor(e,t,r,n,i){let a=d.c;if(n){const t=e.getState(),i=Object(d.g)(t,n);i&&i[r.guid]&&(a=d.g)}super(e,t,r,n,i,a,f)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class C extends l.a{constructor(e,t,r,n,i,a){super(e,t,r,n,i,a,v)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let S;class I extends c.a{constructor(e,t,r,n,i,a){super(e,t&&t.etn,n,i,()=>C,r),S=e,this._getCommands=a,this._apiExecutor=new m.a(e,"ClientApi.XrmDashboard.",i,n)}get commands(){return this._apiExecutor.execute("commands_get",()=>this._commands||(this._commands=this._getCommands(S,this.contextToken,this.pageId)))}}var _=r("HAeo"),O=r("zgeC"),T=r("ywwS"),j=r("ghNp"),P=r("i1f0"),E=r("qshH"),x=r("E7fB"),A=r("16wZ"),w=r("T6Zt");function F(e,t,r,n){return k((r,i)=>new I(r,i,new o.b(r,t),e,t,n),"clientapi.create.xrmdashboard","ClientApi.XrmCommandObjectFactory.createXrmDashboard",e,t,r,!1)}function N(e,t,r,n){return k((r,n)=>new s.a(r,n,new o.b(r,t),e,t),"clientapi.create.xrmform","ClientApi.XrmCommandObjectFactory.createXrmForm",e,t,r,!0,n)}function k(e,t,r,i,o,s,c,l){return{type:t,sync:!0,execute(t,u){Object(A.g)(i,r,"contextToken"),Object(A.g)(o,r,"pageId"),c&&Object(A.g)(s,r,"entityTypeName");try{let r=t.dispatch(Object(j.b)(o,i));if(!r){r=e(t,{etn:s,id:l}),r.applicationContext=u;const a=new x.a(t,o);if(r.context=a,!i.parentContextToken){const e=u.ClientApiManager.getClientApiEntry(o);Object(n.b)("form.initialization",()=>{e.xrmInstance.Page=r}),e.primaryContextToken=i}}return r}catch(e){const t=E.a.getInstance().getEventParameters(i);throw t.push({name:"entityTypeName",value:s}),a.a.getInstance().eventManager.ReportComponentFailure(r,e,null,t),e}}}}function D(e,t,r,n,o){const s="ClientApi.XrmCommandObjectFactory.createXrmGrid";return{type:"clientapi.create.xrmgrid",sync:!0,execute(c,l){Object(A.g)(e,s,"contextToken"),Object(A.g)(t,s,"pageId");try{let u=c.dispatch(Object(j.c)(t,e));if(!u){if(3===n){const i=Object(P.s)(c.getState(),{id:t,controlName:o},e.parentContextToken);if(i){const n=c.dispatch(Object(j.b)(t,e.parentContextToken));return new O.a(c,e.parentContextToken,t,o,r,n,i,l)}const u=E.a.getInstance().getEventParameters(e);u.push({name:"controlName",value:o}),u.push({name:"gridType",value:n}),a.a.getInstance().eventManager.ReportComponentFailure(s,new Error("Control descriptor could not be found for subgrid control"),null,u)}if(u=new _.a(c,e,t,r,n,!1,l,o),!e.parentContextToken&&e.contextTokenType===i.a.MainGrid){l.ClientApiManager.getClientApiEntry(t).primaryContextToken=e}}return u}catch(t){const r=E.a.getInstance().getEventParameters(e);throw r.push({name:"controlName",value:o}),r.push({name:"gridType",value:n}),a.a.getInstance().eventManager.ReportComponentFailure(s,t,null,r),t}}}}function M(e,t,r,n){const i="ClientApi.XrmCommandObjectFactory.registerNewControl";return{type:"clientapi.create.xrmTimeline",sync:!0,execute(o,s){Object(A.g)(e,i,"contextToken"),Object(A.g)(t,i,"pageId"),Object(A.g)(r,i,"controlName"),Object(A.g)(n,i,"controlId");try{const c=o.dispatch(Object(j.b)(t,e.parentContextToken));let l=null;switch(r){case"notescontrol":if(l=o.dispatch(Object(j.f)(t,e)),!l){const i=Object(P.s)(o.getState(),{id:t,controlName:r},e.parentContextToken);l=new T.a(o,e.parentContextToken,t,i,r,n,c,s)}break;default:const u=E.a.getInstance().getEventParameters(e);u.push({name:"controlName",value:r}),a.a.getInstance().eventManager.ReportComponentFailure(i,new Error("Failed to create and return the control"),null,u)}return l}catch(t){const n=E.a.getInstance().getEventParameters(e);throw n.push({name:"controlName",value:r}),a.a.getInstance().eventManager.ReportComponentFailure(i,t,null,n),t}}}}function R(e,t){const r="ClientApi.XrmCommandObjectFactory.createXrmKBSearch";return{type:"clientapi.create.xrmkbsearch",sync:!0,execute(n,i){Object(A.g)(e,r,"contextToken"),Object(A.g)(t,r,"pageId");try{let r=n.dispatch(Object(j.g)(t,e));if(!r&&(r=new w.a(n,e,t),!e.parentContextToken)){const n=i.ClientApiManager.getClientApiEntry(t);n.xrmInstance.Page=r,n.primaryContextToken=e}return r}catch(t){const n=E.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(r,t,null,n),t}}}}},qwRa:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o}));var n=r("dHD5"),i=r("BFlg");const a="chart.visualizationtype.update";function o(e,t,r){return{type:"chart.visualizationtype.update.async",execute({dispatch:o,getState:s},c){const l=c.TraceManager.getTracer(i.z),u=i.x+".updateVisualizationTypeAction";try{l.info("Update the chart visualization type"),t||(t=Object(n.k)(s(),e));const i=Object(n.v)(t);return o(function(e,t,r){return{type:a,payload:{name:"chartVisualizationType",value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,i,r)),c.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){const t="Update the chart visualization type failed with error : "+e.message;c.EventManager.ReportComponentFailure(u,Error(t))}}}}},"r/aD":function(e,t,r){"use strict";r.d(t,"d",(function(){return u})),r.d(t,"c",(function(){return d})),r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return h}));var n=r("i1f0"),i=r("arV0"),a=r("PUjk"),o=r("IaGr"),s=r("2Ct/"),c=r("odYE"),l=r("g6bs");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(e,t,r,a=!1){if(!e)return o.a.getInstance().traceManager.getTracer(r).error("isXrmProcessControlClientApiSupportedOnForm invoked with unexpected null state object"),!1;if(!t)return o.a.getInstance().traceManager.getTracer(r).error("isXrmProcessControlClientApiSupportedOnForm invoked with unexpected null pageId object"),!1;const u=function(e,t){const r=Object(i.g)(e,t);if(!r)return null;const{entityTypeName:n,id:a}=r;return new c.a(n,a)}(e,t),d=!Object(n.Kb)(e,t)&&(Object(s.d)(e)||!Object(s.g)(e))&&(a||!Object(l.d)(e,u,t)),p=g(t,e);return p.push({name:"xrmProcessControlClientApiIsSupported",value:d}),o.a.getInstance().eventManager.ReportComponentSuccess(r,p),d}function d(e,t,r,n){if(!e&&(o.a.getInstance().traceManager.getTracer(n).error("getProcessManagerWithJitInitIfNeeded invoked with unexpected null processManager",g(r,t.getState())),u(t.getState(),r,n))){o.a.getInstance().traceManager.getTracer(n).error("getProcessManagerWithJitInitIfNeeded invoking JIT initialization of process manager",g(r,t.getState()));const e=Object(i.g)(t.getState(),r);return Object(a.b)(r,e)}return e}function p(e,t,r,n){return[{name:"pageId",value:e},{name:"formType",value:Object(i.l)(t,e)},{name:"InitialXrmProcessControlIsNotNull",value:r},{name:"XrmEntityIsNotNull",value:n}]}function h(e,t,r){return[{name:"pageId",value:e},{name:"formType",value:Object(i.l)(t,e)},{name:"getProcessManagerInvoked",value:r}]}function g(e,t){return[{name:"pageId",value:e},{name:"formType",value:Object(i.l)(t,e)}]}},rs6x:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r("SAYH"),i=r("arV0"),a=r("ruPX"),o=r("kX6F"),s=r("Nb1E"),c=r("odYE"),l=r("iZ7K"),u=r("504W"),d=r("lEFU"),p=r("IqkD"),h=r("69Qu"),g=r("i1f0"),m=r("E8F2");function b(e,t,r,c){const b=[{name:"formId",value:e},{name:"pageName",value:r}];return{type:"form.change",execute({dispatch:f,getState:v},C,S){const I=v();if(Object(g.Eb)(I,t))return Promise.reject(Object(m.b)(I,t,2200000016));const{entityTypeName:_,id:O,recordSetQueryKey:T,data:j,createFromRelationship:P,initWithEntity:E}=Object(i.g)(I,t);b.push({name:"entityTypeName",value:_});const x=n.a.tryParse(e),A={entityTypeName:_,formId:x,id:c?n.a.tryParse(c):O,recordSetQueryKey:T,data:j,createFromRelationship:P,initWithEntity:E},w=x.guid.toString(),F=`<MRUForm><Form Type="Main" Id="${w}" /></MRUForm>`,N=Object(d.c)(I,_);return f(Object(a.a)(r,A,t,{replaceState:!0})).then(e=>{var t,r;if(0===e.status)if(Object(h.b)(v()))null==N||N===n.a.EMPTY?function(e,t,r,i,a,c,d,h){const g=Object(l.p)(i,e),m=Object(p.q)(i),b="?$select=userentityuisettingsid&$filter=objecttypecode eq {0} and _ownerid_value eq '{1}'&$top=1",f=String.format(b,g.toString(),m.guid.toString());a(Object(s.e)("userentityuisettings",f)).then(p=>{p.value&&p.value.length>0&&(r=p.value[0].userentityuisettingsid?new n.a(p.value[0].userentityuisettingsid):n.a.EMPTY),Object(u.a)(r)||Object(u.a)(c)||Object(u.a)(e)||0===e.length||n.a.isNullOrEmpty(r)?null!=r&&r!==n.a.EMPTY||function(e,t,r,i,a,c,d){let p=n.a.EMPTY;const h=Object(l.p)(r,e),g="userentityuisettings";i(Object(s.b)(g,{objecttypecode:h,lastviewedformxml:t})).then(t=>{if(p=t,!(Object(u.a)(p)||Object(u.a)(a)||Object(u.a)(e)||0===e.length||n.a.isNullOrEmpty(p))){const t=d.TraceManager.getTracer("Forms.FormSelectorChange"),r="Created an entry for selected form successfully formid : "+a;t.info(r),i(Object(o.b)(e,a,p))}}).catch(t=>{if(-2147093999===t.errorCode)return Object(u.a)(a)||Object(u.a)(e)||0===e.length||i(Object(o.b)(e,a,p)),{};const r=[{name:"CorrelationId",value:c.correlationId},{name:"ContextId",value:c.contextId},{name:"ActionStack",value:c.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],n="Catch block of ChangeForm.oDataCreate, for formid: "+a;d.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(n),void 0,r),d.TraceManager.getTracer("Forms.FormSelectorChange").error(n,r)})}(e,t,i,a,c,d,h):y(e,t,r,i,a,c,d,h)}).catch(t=>{if(-2147093999===t.errorCode)return Object(u.a)(c)||Object(u.a)(e)||0===e.length||a(Object(o.b)(e,c,r)),{};const n=[{name:"CorrelationId",value:d.correlationId},{name:"ContextId",value:d.contextId},{name:"ActionStack",value:d.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],i="Catch block of ChangeForm.oDataRetrieve, for formid: "+c;h.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(i),void 0,n),h.TraceManager.getTracer("Forms.FormSelectorChange").error(i,n)})}(_,F,N,v(),f,x,S,C):y(_,F,N,v(),f,x,S,C);else{Object(u.a)(x)||Object(u.a)(_)||0===_.length||f(Object(o.b)(_,x,N));const e=null===(t=null==C?void 0:C.TraceManager)||void 0===t?void 0:t.getTracer("Forms.FormSelectorChange"),r="Selected form did not save in the UserEntityUiSetting table, for formid: "+x;null==e||e.info(r)}else if(1===e.status){const e=null===(r=null==C?void 0:C.TraceManager)||void 0===r?void 0:r.getTracer("Forms.FormSelectorChange"),t=`Could not change to form with id ${w} due to a navigation failure or because navigation was cancelled`;null==e||e.info(t,b)}return e})},getFailureParameters:(e,t)=>b}}function y(e,t,r,i,a,l,d,p){const h=new c.a("userentityuisettings",r);a(Object(s.f)(h,{lastviewedformxml:t})).then(()=>{if(!(Object(u.a)(r)||Object(u.a)(l)||Object(u.a)(e)||0===e.length||n.a.isNullOrEmpty(r))){const t=p.TraceManager.getTracer("Forms.FormSelectorChange"),n="Updated selected form successfully to : "+l;t.info(n),a(Object(o.b)(e,l,r))}}).catch(t=>{if(-2147093999===t.errorCode)return Object(u.a)(l)||Object(u.a)(e)||0===e.length||a(Object(o.b)(e,l,r)),{};const n=[{name:"CorrelationId",value:d.correlationId},{name:"ContextId",value:d.contextId},{name:"ActionStack",value:d.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],i="Catch block of ChangeForm.oDataUpdate, for formid: "+l;p.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(i),void 0,n),p.TraceManager.getTracer("Forms.FormSelectorChange").error(i,n)})}},"s+OO":function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return o})),r.d(t,"c",(function(){return s}));var n=r("dHD5"),i=r("BFlg");const a="chart.filterexpression.update",o="ChartFilterExpression";function s(e,t,r){return{type:"chart.filterexpression.update.async",execute({dispatch:s,getState:c},l){const u=l.TraceManager.getTracer(i.z),d=i.x+".updateFilterExpressionAction";try{u.info("Updating the chart filter expression"),t||(t=Object(n.k)(c(),e));const i=Object(n.v)(t);return s(function(e,t,r){return{type:a,payload:{name:o,value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,i,r)),l.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){const t="Updatation of the chart filter expression failed with error : "+e.message;l.EventManager.ReportComponentFailure(d,Error(t))}}}}},sn0j:function(e,t,r){"use strict";r.d(t,"c",(function(){return p})),r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return h}));var n=r("SAYH"),i=r("Lohl"),a=r("y60j"),o=r("LbMF"),s=r("FZDd"),c=r("3hnk"),l=r("j6Db"),u=r("qLnS");const d=["activitytypecode","prioritycode","scheduledend","subject","description","regardingobjectid","ownerid","createdon","statecode","modifiedon"];function p(e,t,r){return{type:"formandattribute.retrieve.async",execute({dispatch:c,getState:u},p){const m="Card"===r;return e.etn&&"activitypointer"===e.etn&&m?c(Object(s.f)("activitypointer",!1,d)).then(()=>{const t=u(),r={};for(const n of d){const i=Object(o.a)(t,e.etn,n);i&&h(t,e.etn,n,i)&&(r[n]=i)}return g(t,e.etn,r,Object(o.d)(t,e.etn)),{formDescriptor:null,attributeDescriptors:r}}):c(Object(i.b)(e,t,r)).then(i=>{const d={};let b=null;return e.etn?c(Object(s.f)(e.etn,!0,[])).then(()=>{const t=u();if(!n.a.isNullOrEmpty(i)&&(b=Object(a.j)(t,i),b&&b.Attributes))for(const r in b.Attributes){const n=b.Attributes[r],i=Object(o.a)(t,e.etn,n);i&&h(t,e.etn,n,i)&&(d[n]=i)}return m&&g(t,e.etn,d,Object(o.d)(t,e.etn)),{formDescriptor:b,attributeDescriptors:d}}):(p.EventManager.ReportComponentSuccess("Form.CustomControl.retrieveFormWithAttributes",[{name:"APIName",value:l.a+".Actions.RetrieveFormWithAttributesAction"},{name:"formId",value:n.a.toString(t)},{name:"formType",value:r}]),null)},e=>{const i=e.get_message();p.EventManager.ReportComponentFailure("Form.CustomControl.retrieveFormWithAttributes",new Error(i),i,[{name:"APIName",value:l.a+".Actions.RetrieveFormWithAttributesAction"},{name:"formId",value:n.a.toString(t)},{name:"formType",value:r}])})}}}function h(e,t,r,n){return Object(c.f)(e,t,r,u.a.CanRead)&&n&&n.IsValidForRead}function g(e,t,r,n){if(n)for(const i in n){const a=n[i];!a.IsSortableEnabled&&"modifiedon"!==a.LogicalName||r[i]||!h(e,t,a.LogicalName,a)||"image"===a.Type||"multiselectpicklist"===a.Type||(r[i]=a)}}},tpZ5:function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var n=r("0nOn"),i=r("OQLa"),a=r("arV0"),o=r("UqyN"),s=r("L8zx"),c=r("ZIjf"),l=r("3yqi"),u=r("EOIL"),d=r("i1f0"),p=r("Bo7t"),h=r("Tg1Y"),g=r("16wZ"),m=r("qshH");let b;class y extends u.a{constructor(e,t,r,n,i,a){super(e,t,r,n,i,a),b=e}getDefaultNextPageName(){const e="ClientApi.XrmNavigableFormUi.getDefaultNextPageName";try{c.a.instance.reportCall(e);const t=Object(d.M)(b.getState(),this.pageId,this.contextToken);return c.a.instance.reportSuccess(e),t}catch(t){const r=m.a.getInstance().getEventParameters(this.contextToken);throw m.a.getInstance().reportFailure(e,t,null,r),t}}movePrevious(){const e="ClientApi.XrmNavigableFormUi.movePrevious";try{c.a.instance.reportCall(e),b.dispatch(Object(h.b)(this.pageId,this.contextToken)),c.a.instance.reportSuccess(e)}catch(t){const r=m.a.getInstance().getEventParameters(this.contextToken);throw m.a.getInstance().reportFailure(e,t,null,r),t}}moveTo(e){const t="ClientApi.XrmNavigableFormUi.moveTo";let r;try{if(c.a.instance.reportCall(t),e&&this.tabs){const t=Object(d.Gc)(b.getState(),this.pageId,e,this.contextToken);r=this.tabs.get(null==t?void 0:t.Name),r&&b.dispatch(Object(p.b)(this.pageId,this.contextToken,null==t?void 0:t.Id))}c.a.instance.reportSuccess(t)}catch(e){const r=m.a.getInstance().getEventParameters(this.contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}r||Object(g.h)(t,"pageName",e)}get taskProcess(){return c.a.instance.reportUsage("ClientApi.XrmNavigableFormUi.taskProcess"),this}}var f=r("SAYH"),v=r("n6Qt"),C=r("deGN"),S=r("G0J3"),I=r("504W");let _;class O extends S.a{constructor(e,t,r,i,a){super(e,t&&t.etn,i,a,e=>10===e||12===e?y:u.a,r);const o=[{name:"pageId",value:a,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];this._clientApiExecutorForm=new n.a(e,"ClientApi.XrmForm.",a,i,o),_=e,this._entityReference=t}get applicationContext(){return this._applicationContext}set applicationContext(e){this._applicationContext=e}get context(){try{return c.a.instance.reportCall("ClientApi.XrmForm.context"),c.a.instance.reportSuccess("ClientApi.XrmForm.context"),this._globalContext}catch(e){throw this._reportFailure("ClientApi.XrmForm.context",e)}}set context(e){this._globalContext=e}get entityReference(){return this._clientApiExecutorForm.execute("entityReference_get",()=>({id:f.a.externalGuid(this._entityReference.id),entityType:this._entityReference.etn}))}get data(){try{if(c.a.instance.reportCall("ClientApi.XrmForm.data"),!this._data){let e;const t=Object(a.l)(_.getState(),this.pageId);t!==l.a.Dialog&&t!==l.a.ModalDialog&&this._entityReference&&(e=new o.a(_,this.contextToken,this.pageId,this,this._entityReference.etn,this._entityReference.id,T,this._applicationContext)),this._data=new s.a(_,this.contextToken,this.pageId,this,e)}return c.a.instance.reportSuccess("ClientApi.XrmForm.data"),this._data}catch(e){throw this._reportFailure("ClientApi.XrmForm.data",e)}}getAttribute(e){return this._clientApiExecutorForm.execute("getAttribute",()=>{var t,r;let n=null;return this.data&&this.data.entity&&(n=this.data.entity.attributes.get(e)),n?Object(I.a)(e)&&(n=n.concat(this.data.attributes.get(e))):n=null===(r=null===(t=this.data)||void 0===t?void 0:t.attributes)||void 0===r?void 0:r.get(e),n})}getUrl(e){try{c.a.instance.reportCall("ClientApi.XrmForm.getUrl");let t=null,r=null;if(this.contextToken.parentContextToken){const e=this.data.entity.getEntityReference(),n={entityTypeName:e.entityType,etn:e.name,id:f.a.fromExternalGuid(e.id)};t=l.a.EditForm,r=n}else t=Object(a.l)(_.getState(),this.pageId),r=Object(a.g)(_.getState(),this.pageId);switch(t){case l.a.EditForm:{const e=new v.a(_,this.applicationContext,this.context,this.pageId);r={entityTypeName:r.entityTypeName,etn:r.etn,id:r.id,entityTypeCode:e.getEntityCode(r.entityTypeName),languageId:this._globalContext.userSettings.languageId,recordSetQueryKey:r.recordSetQueryKey};break}case l.a.Grid:{const e=new v.a(_,this.applicationContext,this.context,this.pageId);r={entityTypeName:r.entityTypeName,pageType:r.pageType,entityTypeCode:e.getEntityCode(r.entityTypeName)};break}}let n=null;if(1===e)n=_.dispatch(Object(i.a)(t,r));else{const e=Object(C.a)(_,this.pageId);n=_.dispatch(Object(i.c)(e,t,r))}return c.a.instance.reportSuccess("ClientApi.XrmForm.getUrl"),n}catch(e){throw this._reportFailure("ClientApi.XrmForm.getUrl",e)}}_reportFailure(e,t){const r=m.a.getInstance().getEventParameters(this.contextToken);return r.push({name:"entityName",value:this._entityReference.etn}),m.a.getInstance().reportFailure(e,t,null,r),t}}function T(e,t,r){const n=Object(d.bb)(_.getState(),r,t);return n||e.TraceManager.getTracer("ClientApi.XrmForm.getAttributeNames").error("Form attributes was null"),n}},tvJg:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="attribute.options.clear";function a(e,t,r){const a=Object(n.x)(t);return{type:i,payload:void 0,meta:{pageId:e,contextKey:a,dataFieldName:r}}}},uOtn:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return l}));var n=r("Sbn7"),i=r("Zw8F"),a=r("y60j"),o=r("SAYH"),s=r("0nOn");let c;class l{constructor(e,t,r,n,o,l=a.n,u=i.a){this._formId=r,c=e,this._entityName=n,this._pageId=o,this._getSelectorItems=l,this._selectorItemType=u,this._clientApiExecutor=new s.a(e,"ClientApi.XrmControlFormSelector.",o,t)}get items(){return this._clientApiExecutor.execute("items_get",e=>{if(!this._items){this._items=new n.a(e);const t=this._getSelectorItems(c.getState(),this._entityName);if(t)for(const e in t){const r=t[e],n=r.name||r.DisplayName,i=new this._selectorItemType(new o.a(e),n,c,this._pageId);this._items.add(i.getId(),i)}}return this._items})}getCurrentItem(){return this._clientApiExecutor.execute("getCurrentItem",()=>{const e=this.items;for(let t=0;t<e.getLength();t++){const r=e.get(t);if(r.getId()===o.a.toString(this._formId))return r}return null})}}class u extends l{}},"uPT+":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));const n="powerbi.signedin.state";function i(e,t){return{type:n,payload:t,meta:{pageId:e}}}},ujVH:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return d}));var n=r("dHD5"),i=r("BFlg"),a=r("P6DH"),o=r("3hnk"),s=r("kWiz"),c=r("WePp"),l=r("qLnS");const u="dataset.dependentoptionset.column.status";function d(e,t){const r=[];return{type:"dependentoptionset.column.status",sync:!0,execute({dispatch:o,getState:l},d,m){const b=d.TraceManager.getTracer(i.z),y=i.x+".SetDependentOptionSetColumnStatusAction";d.TraceManager.setLogLevel(s.a.Info,y);try{const i=Object(n.v)(t),s=l();let f=null;const v=Object(a.Q)(l(),e,t),C={};if(v)f=v;else{const r=Object(a.S)(l(),{id:e},t);r&&r.entityLogicalName&&(f=r.entityLogicalName)}if(f){r.push({name:"CorrelationId",value:m.correlationId},{name:"ContextId",value:m.contextId},{name:"ActionStack",value:m.stack},{name:"PageId",value:e},{name:"EntityTypeName",value:f}),b.info("Executing initialize dependent option set column status action in grid.",r);const n={name:"NumPartialDependentOptionSetChainAttributesInGrid",value:0},i=[];let o=0;const l=Object(a.z)(s,t,f,e);for(const r in l){const a=l[r];if(null===a.ParentPicklistLogicalName){const a={name:r,value:0};p(s,t,e,f,l,r,a)?h(l,r,C,n):(g(l,r,C),o++,i.push(a))}else void 0===l[a.ParentPicklistLogicalName]&&h(l,r,C,n)}const u={name:"NumCompleteDependentOptionSetChainsInGrid",value:o},v={name:"CompleteChainsMaxDepthInGrid",value:i};r.push(u,n,v);const S=new c.a(y);S.addEventParameter("NumCompleteDependentOptionSetChainsInGrid",o),S.addEventParameter("NumPartialDependentOptionSetChainAttributesInGrid",n.value),S.addEventParameter("CompleteChainsMaxDepthInGrid",i),d.EventManager.ReportEvent(S),d.EventManager.ReportComponentSuccess(y),b.info("Executed initialize dependent option set column status action successfully.",r)}Object.keys(C).length>0&&o(function(e,t,r){return{type:u,payload:r,meta:{pageId:e,dataSetContextKey:t}}}(e,i,C))}catch(e){const t="creating dependent option set column status node in state tree failed.";d.EventManager.ReportComponentFailure(y,Error(t))}}}}function p(e,t,r,n,i,a,s){if(void 0===i[a])return!0;if(function(e,t,r,n,i){if(!Object(o.f)(e,i,n,l.a.CanUpdate)||!r[n].IsValidForUpdate)return!0;return!1}(e,0,i,a,n))return!0;const c=i[a].ChildPicklistLogicalNames;if(null!==c)for(let o=0;o<c.length;o++){const l={name:a,value:0};if(p(e,t,r,n,i,c[o],l))return!0;s.value=Math.max(s.value,l.value)}return s.value=s.value+1,!1}function h(e,t,r,n){if(void 0===e[t])return;r[t]=0,n.value=n.value+1;const i=e[t].ChildPicklistLogicalNames;if(i)for(let t=0;t<i.length;t++)h(e,i[t],r,n)}function g(e,t,r){r[t]=1;const n=e[t].ChildPicklistLogicalNames;if(n)for(let t=0;t<n.length;t++)g(e,n[t],r)}},wFY3:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n="polite",i="assertive"},wZxB:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return p}));var n=r("4r2D"),i=r("SAYH"),a=r("iZ7K"),o=r("FZDd"),s=r("pEXn"),c=r("Nb1E"),l=r("fU7K");const u=s.b.AdvancedFindLookupResolverParameters;function d(e,t,r){const c=[];return{type:"advancedFind.lookup.retrieve.async",execute({dispatch:l,getState:d},p,g){const m=new n.a(i.a.newGuid().guid,g&&g.isPreloadCall);c.push({name:s.b.ActionType,value:"advancedFind.lookup.retrieve.async"},{name:s.b.ClientRequestId,value:m.RequestId()},{name:u.PrimaryEntity,value:e},{name:u.Targets,value:t.join(",")});const b=t.reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:[]}),{});return l(Object(o.e)(b)).then(()=>{const e=function(e,t,r,n){return(i,o)=>{const s=Object(a.h)(r,o);if(!s||!s.EntityLogicalName||!s.PrimaryNameAttribute)return n.push({name:u.EntityMetadataUnavailable,value:o}),i;const c=`<fetch version="1.0" mapping="logical" no-lock="false"><entity name="${s.EntityLogicalName}"><attribute name="${s.PrimaryNameAttribute}"/><attribute name="${s.PrimaryIdAttribute}"/><order attribute="${s.PrimaryNameAttribute}" descending="false" /><filter type="or"><condition attribute="${s.PrimaryNameAttribute}" operator="like" value="%${t||""}%" /></filter></entity></fetch>`,l=h(e,s,c,n);return i.push(l),i}}(l,r,d(),c),n=t.reduce(e,[]);return Promise.all(n).then(e=>Promise.resolve([].concat(...e)))})},getSuccessParameters:()=>c,getFailureParameters:(e,t)=>c}}function p(e,t,r){const c=[];return{type:"advancedFind.lookup.retrieve.by.id.async",execute({dispatch:l,getState:d},p,g){const m=new n.a(i.a.newGuid().guid,g&&g.isPreloadCall);c.push({name:s.b.ActionType,value:"advancedFind.lookup.retrieve.async"},{name:s.b.ClientRequestId,value:m.RequestId()},{name:u.PrimaryEntity,value:e},{name:u.Targets,value:t.join(",")});const b=t.reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:[]}),{});return l(Object(o.e)(b)).then(()=>{const e=function(e,t,r,n){return(i,o)=>{const s=Object(a.h)(r,o);if(!s||!s.EntityLogicalName||!s.PrimaryNameAttribute)return n.push({name:u.EntityMetadataUnavailable,value:o}),i;const c=t.filter(e=>!!e).map(e=>`<condition attribute="${s.PrimaryIdAttribute}" operator="eq" value="${e}" />`),l=`<fetch version="1.0" mapping="logical" no-lock="false"><entity name="${s.EntityLogicalName}"><attribute name="${s.PrimaryNameAttribute}"/><attribute name="${s.PrimaryIdAttribute}"/><order attribute="${s.PrimaryNameAttribute}" descending="false" /><filter type="or">${c}</filter></entity></fetch>`,d=h(e,s,l,n);return i.push(d),i}}(l,r,d(),c),n=t.reduce(e,[]);return Promise.all(n).then(e=>Promise.resolve([].concat(...e)))})},getSuccessParameters:()=>c,getFailureParameters:(e,t)=>c}}function h(e,t,r,n){const i="?fetchXml="+Object(l.CrmUrlEncode)(r);return new Promise((r,a)=>{e(Object(c.e)(t.EntityLogicalName,i,100)).then(e=>{const i=function(e,t){const r=[];t.value&&t.value.length>0&&t.value.forEach(t=>{r.push({id:t[e.PrimaryIdAttribute],displayName:t[e.PrimaryNameAttribute],entityLogicalName:(null==e?void 0:e.EntityLogicalName)||void 0,entityDisplayName:(null==e?void 0:e.DisplayName)||void 0})});return r}(t,e);n.push({name:u.RetrieveRequestSuccess,value:`Retrieve Seccuess for ${t.EntityLogicalName} Count: ${i.length}`}),r(i)},e=>{n.push({name:u.RetrieveRequestFail,value:`Failed to retrieve records for ${t.EntityLogicalName} Error: ${e}`}),r([])})})}},waMg:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="grid.updatequerykey";function a(e,t,r){const a=Object(n.y)(r),o=Object(n.v)(r);return{type:i,payload:e,meta:{pageId:t,contextKey:a,dataSetContextKey:o}}}},xorU:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"d",(function(){return s})),r.d(t,"c",(function(){return a})),r.d(t,"f",(function(){return c})),r.d(t,"b",(function(){return o})),r.d(t,"e",(function(){return l}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="controls.addCustomFilter",a="controls.startCustomFilter",o="controls.endCustomFilter";function s(e,t,r,a,o){const s=Object(n.v)(a);return{type:i,payload:{customFilter:o,entityLogicalName:r},meta:{pageId:e,controlName:t,contextKey:s}}}function c(e,t,r){const i=Object(n.v)(r);return{type:a,payload:{},meta:{pageId:e,controlName:t,contextKey:i}}}function l(e,t,r){const i=Object(n.v)(r);return{type:o,payload:{},meta:{pageId:e,controlName:t,contextKey:i}}}},yl9a:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="control.setSrc";function a(e,t,r,a){const o=Object(n.v)(r);return{type:i,payload:{Url:a,isCustomSrc:!0},meta:{pageId:e,controlName:t,contextKey:o}}}},ywwS:function(e,t,r){"use strict";r.d(t,"a",(function(){return C}));var n=r("0nOn"),i=r("P6DH"),a=r("HcnX"),o=r("AbXy"),s=r("FETf"),c=r("LE5i"),l=r("16wZ"),u=r("NAAR"),d=r("qshH"),p=r("HAeo"),h=r("ghNp"),g=r("dHD5"),m=r("ZIjf"),b=r("FZDd"),y=r("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const f="ClientApi.XrmControlTimeline.";let v;class C extends a.a{constructor(e,t,r,i,a,o,s,c){super(e,t,r,i,a,s),this._defaultLabel=u.u.Timeline,v=e,this._applicationContext=c,this._controlId=o,this._traceManager=c.TraceManager,this._subgridToken=Object(g.p)(t,a),this._clientApiExecutorTimeline=new n.a(e,f,r,t),this._clientApiExecutorTimeline.addEventParameter({name:"controlName",value:a,isEventParam:!0,expectedDataType:"string"}),this._clientApiExecutorTimeline.addEventParameter({name:"controlId",value:o,isEventParam:!0,expectedDataType:"string"}),this._gridControl=new p.a(e,this._subgridToken,r,!1,3,!0,c,a),e.dispatch(Object(h.a)(this,r,this._subgridToken))}getControlType(){return m.a.instance.reportUsage(f+"getControlType"),"timelinewall"}getName(){return this.clientApiExecutor.execute("getName",()=>this.controlDescriptor&&this.controlDescriptor.Parameters&&this.controlDescriptor.Parameters[u.s.UClientUniqueName]?this.controlDescriptor.Parameters[u.s.UClientUniqueName]:u.u.Timeline)}getLabel(){const e=f+"getLabel";try{m.a.instance.reportCall(e);const t=this.controlDescriptor&&this.controlDescriptor.Parameters&&!Object(l.a)(this.controlDescriptor.Parameters[u.s.Label])?this.controlDescriptor.Parameters[u.s.Label]:this._defaultLabel?this._defaultLabel:"";return m.a.instance.reportSuccess(e),t}catch(t){const r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,r),t}}setLabel(e){const t=f+"setLabel";try{m.a.instance.reportCall(t),super.setLabel(e),this.controlDescriptor&&this.controlDescriptor.Parameters?this.controlDescriptor.Parameters[u.s.Label]=e:this._defaultLabel=e,m.a.instance.reportSuccess(t)}catch(e){const r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(t,e,null,r),e}}openEmail(e){const t=f+"openEmail";try{m.a.instance.reportCall(t),v.dispatch(Object(s.t)(this._controlId,e)),v.dispatch(Object(s.o)(this._controlId,c.a.ContextualDialogEntity,2,y.a.toString(y.a.newGuid()))),m.a.instance.reportSuccess(t)}catch(e){const r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(t,e,null,r),e}}refresh(e){let t=f+"refresh";e&&e.modules&&(t+="-modules"),e&&e.activities&&(t+="-activities");try{m.a.instance.reportCall(t),e&&this.controlDescriptor&&this.controlDescriptor.Parameters&&(e.modules&&(this.controlDescriptor.Parameters[u.s.UClientModules]=e.modules),e.activities&&(this.controlDescriptor.Parameters[u.s.UClientActivities]=e.activities)),v.dispatch(Object(s.o)(this._controlId,c.a.InitiateRefresh,1,y.a.toString(y.a.newGuid()))),m.a.instance.reportSuccess(t)}catch(e){const r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(t,e,null,r),e}}setTargetEntity(e,t,r=!0){const n=f+"setTargetEntity";try{m.a.instance.reportCall(n);const i={etn:e,id:t,isAPI:!0},a={};return a[e]=[],v.dispatch(Object(s.v)(this._controlId,i)),v.dispatch(Object(b.e)(a)).catch(t=>{const r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),r.push({name:"entityName",value:e}),d.a.getInstance().reportFailure(n+"-retrieveEntities",t,null,r),t}).then(()=>{r&&v.dispatch(Object(s.o)(this._controlId,c.a.InitiateRefresh,1,y.a.toString(y.a.newGuid()))),m.a.instance.reportSuccess(n)})}catch(e){const t=d.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(n,e,null,t),e}}getGrid(){const e=f+"getGrid";try{return m.a.instance.reportCall(e),this._grid||(this._grid=new o.a(v,this._applicationContext,this._subgridToken,this.pageId,this.getEntityName(),!1,this.name)),m.a.instance.reportSuccess(e),this._grid}catch(t){const r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,r),t}}getRecordSetQueryKey(){return this.clientApiExecutor.execute("getRecordSetQueryKey",()=>Object(i.cb)(v.getState(),this._subgridToken,{id:this.pageId}))}getGridType(){return m.a.instance.reportUsage(f+"getGridType"),3}getRollupType(){return this.clientApiExecutor.execute("getRollupType",()=>Object(i.eb)(v.getState(),this.pageId,this.contextToken))}getParentForm(){const e=f+"getParentForm";try{m.a.instance.reportCall(e);const t=this._gridControl.getParentForm();return m.a.instance.reportSuccess(e),t}catch(t){const r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,r),t}}refreshRibbon(){const e=f+"refreshRibbon";try{m.a.instance.reportCall(e),this._gridControl.refreshRibbon(),m.a.instance.reportSuccess(e)}catch(t){const r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,r),t}}getEntityName(){return m.a.instance.reportUsage(f+"getEntityName"),"activitypointer"}getUrl(){const e=d.a.getInstance().getEventParameters(this.contextToken);return e.push({name:"controlName",value:this.getName()}),e.push({name:"validationError",value:"true"}),this._traceManager.getTracer("ClientApi.XrmControlTimeline.getUrl").warn("Not Supported in Timeline control",e),m.a.instance.reportUsage("ClientApi.XrmControlTimeline.getUrl"),""}getFilterXml(){const e=f+"getFilterXml",t=d.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),m.a.instance.reportUsage(e),""}getFetchXml(){const e=f+"getFetchXml",t=d.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),m.a.instance.reportUsage(e),""}getViewSelector(){const e=f+"getViewSelector",t=d.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),m.a.instance.reportUsage(e),null}getTeamTemplateId(){return null}getRelationship(){const e=f+"getRelationship",t=d.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),m.a.instance.reportUsage(e),null}setFilterXml(e){const t=f+"setFilterXml",r=d.a.getInstance().getEventParameters(this.contextToken);r.push({name:"controlName",value:this.getName()}),r.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",r),m.a.instance.reportUsage(t)}addOnLoad(e){const t=d.a.getInstance().getEventParameters(this.contextToken);t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer("ClientApi.XrmControlTimeline.addOnLoad").warn("Not Supported in Timeline control",t),m.a.instance.reportUsage("ClientApi.XrmControlTimeline.addOnLoad")}removeOnLoad(e){const t=f+"removeOnLoad",r=d.a.getInstance().getEventParameters(this.contextToken);r.push({name:"controlName",value:this.getName()}),r.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",r),m.a.instance.reportUsage(t)}openRelatedGrid(){const e=f+"openRelatedGrid",t=d.a.getInstance().getEventParameters(this.contextToken);t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),m.a.instance.reportUsage(e)}}},z5LE:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r("jRy5"),i=r("dHD5"),a=r("ApeL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="attribute.notification.update";function s(e,t,r,s,c){return{type:"attribute.notification.add.clear.form.notification",sync:!0,execute(e,l){e.dispatch(function(e,t,r,s){if(s&&s.contextTokenType&&s.contextTokenType===n.a.GridRow)return Object(a.d)(e,s,t,r);const c=Object(i.x)(s);return{type:o,payload:r,meta:{pageId:e,contextKey:c,dataFieldName:t}}}(t,r,s,c))}}}},z8iZ:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(e){return{Title:e&&e.Title||null,Legend:e&&e.Legend||null,Area3DStyle:e&&e.Area3DStyle||null,AreaGradientStyle:e&&e.AreaGradientStyle||null,XAxes:e&&e.XAxes||null,YAxes:e&&e.YAxes||null,SeriesList:e&&e.SeriesList||null,SubTitle:e&&e.SubTitle||null,Colors:e&&e.Colors||null,DisplayMode:e&&e.DisplayMode||0,ErrorInformation:e&&e.ErrorInformation||null,EnableDrilldown:e&&e.EnableDrilldown||!0,Annotations:e&&e.Annotations||null}}r.d(t,"a",(function(){return n}))},zFtG:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o}));var n=r("dHD5"),i=r("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="dataset.update.pagingdata";function o(e,t,r){return{type:"dataset.update.pagingdata.async",execute({dispatch:o,getState:s},c){const l=c.TraceManager.getTracer(i.z),u=i.x+".updatePagingDataAction";try{return l.info("Updating the paging data for the grid."),o(function(e,t,r){const i=Object(n.y)(t),o=Object(n.v)(t);return{type:a,payload:r,meta:{pageId:e,contextKey:i,dataSetContextKey:o}}}(e,t,r)),c.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){const t="Updation of paging data for the grid failed with error : "+e.message;c.EventManager.ReportComponentFailure(u,Error(t))}}}}},zgeC:function(e,t,r){"use strict";r.d(t,"a",(function(){return C}));var n=r("0nOn"),i=r("P6DH"),a=r("SAYH"),o=r("HcnX"),s=r("1kth"),c=r("dHD5"),l=r("meVR"),u=r("qshH"),d=r("+zjj"),p=r("w92Z"),h=r("whN/"),g=r("HAeo"),m=r("ghNp"),b=r("ZIjf"),y=r("IaGr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const f="ClientApi.XrmControlSubGrid.";let v;class C extends o.a{constructor(e,t,r,i,a,o,s,l){super(e,t,r,s,i,o),this._relationship=null,v=e,this._subgridToken=Object(c.p)(t,i),this._clientApiExecutorSubGrid=new n.a(e,f,r,this._subgridToken),this.clientApiExecutor.addEventParameter({name:"controlName",value:i,isEventParam:!0}),this.clientApiExecutor.addEventParameter({name:"isEditable",value:a,isEventParam:!0}),this._gridControl=new g.a(e,this._subgridToken,r,a,3,!0,l,i),e.dispatch(Object(m.a)(this,r,this._subgridToken))}get clientApiExecutor(){return this._clientApiExecutorSubGrid}setFilterXml(e){const t=f+"setFilterXml";try{b.a.instance.reportCall(t),this._gridControl.setFilterXml(e),b.a.instance.reportSuccess(t)}catch(e){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,r),e}}getFilterXml(){const e=f+"getFilterXml";try{b.a.instance.reportCall(e);const t=this._gridControl.getFilterXml();return b.a.instance.reportSuccess(e),t}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,r),t}}refresh(){const e=f+"refresh";try{b.a.instance.reportCall(e),this._gridControl.refresh(),b.a.instance.reportSuccess(e)}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,r),t}}getFetchXml(){const e=f+"getFetchXml";try{b.a.instance.reportCall(e);const t=this._gridControl.getFetchXml();return b.a.instance.reportSuccess(e),t}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,r),t}}getGrid(){const e=f+"getGrid";try{b.a.instance.reportCall(e);const t=this._gridControl.getGrid();return b.a.instance.reportSuccess(e),t}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,r),t}}getViewSelector(){const e=f+"getViewSelector";try{b.a.instance.reportCall(e);const t=this._gridControl.getViewSelector();return b.a.instance.reportSuccess(e),t}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,r),t}}getTeamTemplateId(){const e=f+"getTeamTemplateId";try{b.a.instance.reportCall(e);const t=this._gridControl.getTeamTemplateId();return b.a.instance.reportSuccess(e),t}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(e,t,null,r),t}}addOnLoad(e){this.clientApiExecutor.execute("addOnLoad",()=>{v.dispatch(Object(s.d)(this._subgridToken,this.pageId,e,this.name))},[{name:"handler",value:e,isRequired:!0,isEventParam:!1}])}removeOnLoad(e){this.clientApiExecutor.execute("removeOnLoad",()=>{v.dispatch(Object(s.y)(this._subgridToken,this.pageId,e,this.name))},[{name:"handler",value:e,isRequired:!0,isEventParam:!1}])}getEntityName(){const e=f+"getEntityName";try{b.a.instance.reportCall(e);const t=this._gridControl.getEntityName();return b.a.instance.reportSuccess(e),t}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,r),t}}getControlType(){return this.clientApiExecutor.execute("getControlType",()=>{const e=Object(p.a)(v.getState(),this.controlDescriptor,this.pageId,this.contextToken);return e?"customsubgrid:"+e.Name:"subgrid"})}getRelationship(){return this.clientApiExecutor.execute("getRelationship",(e,t)=>{var r,n;if(!this._relationship){if(null===(n=null===(r=this.controlDescriptor)||void 0===r?void 0:r.Parameters)||void 0===n?void 0:n.RelationshipName){const e=this.controlDescriptor.Parameters.RelationshipName,t=this.controlDescriptor.Parameters.RelationshipRoleOrdinal,r=this.controlDescriptor.Parameters.TargetEntityType;this._relationship=Object(g.b)(e,r),this._relationship.roleType=t}this._relationship||(this._relationship=this._gridControl.getRelationship())}return this._relationship})}getRecordSetQueryKey(){return this.clientApiExecutor.execute("getRecordSetQueryKey",()=>Object(i.cb)(v.getState(),this._subgridToken,{id:this.pageId}))}getGridType(){return b.a.instance.reportUsage(f+"getGridType"),3}getRollupType(){return this.clientApiExecutor.execute("getRollupType",()=>Object(i.eb)(v.getState(),this.pageId,this.contextToken))}openRelatedGrid(){this.clientApiExecutor.executeAsync("openRelatedGrid",(e,t)=>{const r=this.getRelationship();if(!r)return y.a.getInstance().traceManager.getTracer(e).error("Can't open related grid: the relationship was not retrieved from the inner grid.",t),Promise.resolve(a.a.EMPTY);const n=Object(d.c)(v.getState(),this.pageId);let i=null;for(let e=0;e<n.length;e++)if(n[e].relationshipName===r.name){i=n[e];break}if(!i)return t.push({name:"relationshipName",value:r.name}),y.a.getInstance().traceManager.getTracer(e).error("Can't open related grid: no relationship was found with the specified name.",t),Promise.resolve(a.a.EMPTY);const o={id:i.id,title:i.title,entityName:this.getEntityName(),relationshipName:r.name,isSelected:!0,show:i.show},s=Object(c.a)(this._subgridToken.parentContextToken,r.name,r.roleType?1===r.roleType?h.a.Referencing:h.a.AssociationEntity:void 0);return v.dispatch(Object(l.a)(this.pageId,s,o))})}refreshRibbon(){const e=f+"refreshRibbon";try{b.a.instance.reportCall(e),this._gridControl.refreshRibbon(),b.a.instance.reportSuccess(e)}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,r),t}}getUrl(){const e=f+"getUrl";try{b.a.instance.reportCall(e);const t=this._gridControl.getUrl();return b.a.instance.reportSuccess(e),t}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,r),t}}getParentForm(){const e=f+"getParentForm";try{b.a.instance.reportCall(e);const t=this._gridControl.getParentForm();return b.a.instance.reportSuccess(e),t}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,r),t}}}}}]),window.bundleExecutionMarkers["scripts/powerbifullscreenpage.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();