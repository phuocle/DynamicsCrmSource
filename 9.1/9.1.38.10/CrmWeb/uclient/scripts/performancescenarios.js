(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/performancescenarios.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[25],{"6dVr":function(e,t,n){"use strict";n.r(t),n.d(t,"PerformanceScenarioTypeId",(function(){return Ge})),n.d(t,"scenarioMap",(function(){return He})),n.d(t,"initializePerformanceAutomationScenariosOnBoot",(function(){return ct})),n.d(t,"closeAllDialogs",(function(){return Je})),n.d(t,"confirmDialog",(function(){return Ye})),n.d(t,"validateEditForm",(function(){return Ke})),n.d(t,"validateGrid",(function(){return Ze})),n.d(t,"redesignedSitemap",(function(){return qe}));var o=n("NjDY"),i=n("GYEz");var a=n("s5g6"),r=n("VnJU"),s=n("ruPX"),c=n("STW0"),l=n("zmaG"),d=n.n(l),u=n("0her"),m=n("GWSs"),p=n("dUiZ"),g=n("fU4N"),C=n("d6Hx"),f=n("OU7F"),y=n("mpSO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function h(e,t=!0){const n=b(e,t);return!!n&&(n.trigger("click"),!0)}function v(e,t,n=!0,o=!1){const i=b(e,n);if(i){const e=o?i.length:1;for(let n=0;n<e;n++){const e=i[n],o=Object.getOwnPropertyDescriptor(e,"value").set,a=Object.getPrototypeOf(e),r=Object.getOwnPropertyDescriptor(a,"value").set;o&&o!==r?r.call(e,t):o.call(e,t);const s=i.is("input")?"input":"change";e.dispatchEvent(new CustomEvent(s,{bubbles:!0}))}return!0}return!1}function b(e,t=!0){const n=$(e);if(n&&n.length>0)return n;if(t)throw new Error("Failed to find "+e);return null}function S(e,t=!0){return h(`[data-id="${e}"]`,t)}function N(e,t,n){return{action:(t,o)=>(S(e,n),Promise.resolve()),displayName:t||"Clicking on button with data-id: "+e}}const P={action:(e,t)=>(qe||h("#"+C.g),Promise.resolve()),displayName:"Open sitemap"},I={action:(e,t)=>(h("#"+C.g),Promise.resolve()),displayName:"Toggle sitemap"};function O(e){return{action:(t,n)=>{if(!qe){return S("sitemap-module-"+e,!1)?Promise.resolve():(S("sitemap-areaBar-more-btn"),t.waitForIdle().then(()=>{S("areabar-overflow-"+e)}))}S("sitemap-areaSwitcher-expand-btn"),t.waitForIdle().then(()=>{S("areaswitcherflyout-"+e)})},displayName:"Open sitemap module: "+e}}function A(e){return N("sitemap-entity-"+e,"Click sitemap entity "+e)}const T={action(e,t){const n=document.createEvent("MouseEvents");n.initMouseEvent("dblclick",!0,!0,window,2,0,0,0,0,!1,!1,!1,!1,0,null);let o=document.querySelectorAll('[data-id="cell-0-2"]')[0];if(!o){const e="entity_control-ListItem_",t="entity_control-ListCardContainer_";let n=document.querySelectorAll(`[id^="${e}"]`);if(n=n&&n.length>0?n:document.querySelectorAll(`[id^="${t}"]`),n&&n.length>0){o=n[0],o=o.firstChild;const e=new PointerEvent("pointerdown",{pointerId:1,bubbles:!0,cancelable:!0,pointerType:"mouse",width:1,height:1,isPrimary:!0}),t=new PointerEvent("pointerup",{pointerId:1,bubbles:!0,cancelable:!0,pointerType:"mouse",width:1,height:1,isPrimary:!0});return o.dispatchEvent(e),o.click(),o.dispatchEvent(t),Promise.resolve()}throw new Error(`Failed to find cell-0-2 for grid or ${e} for list`)}return o.dispatchEvent(n),Promise.resolve()},displayName:"Open first grid item"};function w(e){return Object(u.makeCompositeAction)([P,O(e)],"Open sitemap module: "+e)}const k={action:(e,t)=>S(C.h,!1)?Promise.resolve():(S(y.f),e.waitForIdle().then(()=>{S(C.h)})),displayName:"Open quick create menu"};function F(e){return N(`${C.i}_${e}`,`Open ${e} quick create form`,!1)}function E(){return{action:(e,t)=>(h("#formSaveAndEditButtonIcon",!1),b(`[data-id=${y.g}]`,!1)&&S(y.f),Promise.resolve()),displayName:"Close create form"}}const D={action:(e,t)=>(b('[id^="MscrmControls.Containers.ProcessBreadCrumb-headerStageContainer"] li')[0].click(),Promise.resolve()),displayName:"Open Business Process Stage Flyout (first stage)"};function M(e,t){return{action:(n,o)=>(b(`[data-id="${e}"]`,!1)||h(`[data-lp-id='Form:${t}-${y.f}'`),Promise.resolve()),displayName:"Ensure assign dialog is visible"}}function j(e){return N(e,"Click On AssignDialog successfully",!1)}const B=N("MscrmControls.Containers.ProcessStageControl-stageDockModeButton1","Pin Business Process Stage Flyout"),L=N("MscrmControls.Containers.ProcessStageControl-nextButtonContainer","Click next stage on BPF"),_=N("MscrmControls.Containers.ProcessStageControl-previousButtonContainer","click previous stage on BPF"),x=N("MscrmControls.Containers.ProcessStageControl-stageDockCancelButton","Close pinned stage flyout");function V(e){return Object(u.makeCompositeAction)([R,U(e),z(e)],e===g.a.RelevanceSearch?"Do Relevance Search":"Do Categorized Search")}const R={action:(e,t)=>(h("#"+C.j),Promise.resolve()),displayName:"Open search page"};function U(e){return{action:(t,n)=>(v("#"+f.f,e.toString()),Promise.resolve()),displayName:e===g.a.RelevanceSearch?"Select Relevance Search":"Select Categorized Search"}}function z(e){return{action:(t,n)=>{switch(e){case g.a.RelevanceSearch:const e="#MscrmControls\\.Containers\\.RelevanceSearchControl-text-input-props",t=$(e);if(!(t&&t.length>0))throw new Error("Failed to find "+e);t.val("*"),t[0].dispatchEvent(function(e){const t=document.createEvent("HTMLEvents");return t.initEvent(e,!0,!0),t}("input"));break;case g.a.CategorizedSearch:v("#"+f.d,"*")}return Promise.resolve()},displayName:e===g.a.RelevanceSearch?"Set relevance search text to *":"Set categorized search text to *"}}function W(e){return{action:(t,n)=>{switch(e){case g.a.RelevanceSearch:const e="#MscrmControls\\.Containers\\.RelevanceSearchControl-microsoftIcon_searchButton",t=$(e);if(!(t&&t.length>0))throw new Error("Failed to find "+e);t.trigger("click");break;case g.a.CategorizedSearch:h("#"+f.c)}return Promise.resolve()},displayName:e===g.a.RelevanceSearch?"Click relevance search button":"Click categorized search button"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function q(e,t,n){const o=Object(u.makeCompositeAction)([n,X(t),K],`Navigate to ${t} grid, open new form, fill in required fields`),i=Object(u.makeCompositeAction)([Q(t),Ye,X(t),K],"Delete record, open new form, fill in required fields"),a=Object(u.makeCompositeAction)([Q(t),Ye],"Delete record");return{displayName:e+" create record from new form",typeId:Ge.Create,setupAction:o,action:Y,postIterationAction:i,cleanupAction:a,validation:Ke}}function G(e,t,n){let o,i="[data-fieldrequirement=1] input";const a={action:(e,t)=>(o=J(i,"Test",!1),null===o&&(i="[data-fieldrequirement=2] input",o=J(i,"Test",!1)),Promise.resolve()),displayName:"Set field value"},r={action:(e,t)=>(J(i,o),Promise.resolve()),displayName:"Revert field to previous value"},s=Object(u.makeCompositeAction)([n,T,a],`Navigate to ${t} grid, open first row, update field`),c=Object(u.makeCompositeAction)([r,Y,n,T,a],"Revert field to previous value and save record, navigate to grid, open first row, update field"),l=Object(u.makeCompositeAction)([r,Y],"Revert field to previous value and save record");return{displayName:e+" update record",typeId:Ge.Update,setupAction:s,action:Y,postIterationAction:c,cleanupAction:l,validation:Ke}}function H(e,t,n){const o=Object(u.makeCompositeAction)([n,X(t),K,Y,Q(t)],`Navigate to ${t} grid, open new form, fill in required fields, save record, click delete button`),i=Object(u.makeCompositeAction)([X(t),K,Y,Q(t)],"Open new form, fill in required fields, create record");return{displayName:e+" delete record from form",typeId:Ge.Delete,setupAction:o,action:Ye,postIterationAction:i,validation:Ze}}function J(e,t,n=!0,o=!1){const i=b(e,n);if(i){const a=i.val();return i.focus(),v(e,t,n,o),i.blur(),a}return null}function X(e){return{action(t,n){const o=`${e}|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.${e}.NewRecord`;return S(o,!1)?Promise.resolve():(S(y.f),t.waitForIdle().then(()=>{S(o)}))},displayName:`Open ${e} new form`}}const Y={action:(e,t)=>(Xrm.Page.data.save(),Promise.resolve()),displayName:"Save edit form"};function Q(e){return{action(t,n){const o=`${e}|NoRelationship|Form|Mscrm.Form.${e}.Delete`;return S(o,!1)?(t.incrementDialogCount(),Promise.resolve()):(S(y.f),t.waitForIdle().then(()=>{S(o),t.incrementDialogCount()}))},displayName:`Click delete button on ${e} form`}}const K={action:(e,t)=>(J("[data-fieldrequirement=1] input","Test",!1,!0),J("[data-fieldrequirement=2] input","Test",!1,!0),Promise.resolve()),displayName:"Fill in required fields"},Z={action:e=>(window.location.reload(!1),new Promise(e=>{})),displayName:"Reload page with cache",isBoot:!0},ee={action:e=>(window.location.reload(!0),new Promise(e=>{})),displayName:"Reload page without cache",isBoot:!0};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function te(e,t,n){const o=t?Ge.Boot:Ge.ColdBoot;return{displayName:`Boot ${t?"warm":"cold"} into ${e.displayName}`,typeId:o,isBoot:!0,setupAction:e,action:t?Z:ee,validation:n}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ne=N("notescontrol-action_bar_more_command","Open timelinewall menu"),oe=N("notescontrol-action_bar_open_filter_pane","Open filter pane"),ie=Object(u.makeCompositeAction)([ne,oe],"Open timeline wall menu and filter pane"),ae=Object(u.makeCompositeAction)([ne,N("notescontrol-action_bar_close_filter_pane","Close filter pane")],"Close filter pane");function re(e,t){const n=(o=[{dataId:"notescontrol-TL_TextFilter_3_select.fieldControl-option-set-select",value:"5"},{dataId:"notescontrol-TL_TextFilter_4_select.fieldControl-option-set-select",value:"5"}],{action:(e,t)=>(o.forEach(e=>{S(e.dataId),v(`[data-id="${e.dataId}"]`,e.value)}),Promise.resolve()),displayName:"Apply timeline filters"});var o;const i=Object(u.makeCompositeAction)([t,ie],"Open form and timeline filter menu");return{displayName:e+" timeline filter test",typeId:Ge.TimelineWall,setupAction:i,action:n,postIterationAction:i,cleanupAction:ae,validation:()=>$("[data-id=notescontrol]").length>0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function se(e,t){return{displayName:"Test skype presence and contact card status on "+e,typeId:Ge.SkypeChannel,setupAction:t,action:ce("skypechannel-presence"),postIterationAction:t,validation:()=>$("[data-id=skypechannel-presence]").length>0}}function ce(e){return N(e,"Open skype contact card: "+e)}var le=n("7Mzt"),de=n("pEXn");function ue(e,t,n){const o={};o[de.b.CommandingParameters.EntityName]=n;return{action:n=>(t&&d.a.addKeyPerformanceIndicatorOnIdle("Commanding.renderCommandBar",o),e(Object(le.b)(t)),Promise.resolve()),displayName:"Command bar rendering in edit form is turned "+(t?"on":"off")}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function me(){return $(`[data-id=${y.c}]`).length>1}function pe(e,t,n){const o=Object(u.makeCompositeAction)([ue(n,!1,e),t,T],"Disable cmd bar, navigate to grid and open first item");return{displayName:e+" edit form render command bar in isolation",typeId:Ge.Commanding,setupAction:o,action:ue(n,!0,e),postIterationAction:o,validation:me}}var ge=n("txA/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Ce={action:(e,t)=>(Xrm.App.sessions.getFocusedSession().close(),e.incrementDialogCount(),Promise.resolve()),displayName:"Trigger closing the focused session"},fe={action(e,t){const n=Xrm.App.sessions.getFocusedSession().tabs.getAll();let o=Promise.resolve();for(let t=0;t<n.getLength();t++)o=o.then(()=>(n.get(t).focus(),e.waitForIdle()));return o},displayName:"Cycle opened tabs"},ye=N(ge.W,"Open new tab flyout");function he(e){const t=Object(u.makeCompositeAction)([ye,N("new-tab-item-"+e)],`Open ${e} tab`);return{displayName:`Open ${e} edit form tab`,typeId:Ge.MultiSession,setupAction:t,action:T,postIterationAction:t,validation:()=>!0}}var ve=n("SAYH"),be=n("lcRi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Se={action:(e,t)=>(e.navigateTo(be.a,{}),Promise.resolve()),displayName:"Navigate to Benchmark Page"};function Ne(e,t,n,o,i,a,r,s){return{displayName:s||`${e.Name}(${t})`,typeId:Ge.Benchmark,setupAction:o,action:i,postIterationAction:a,cleanupAction:r,validation:n}}function Pe(e,t,n,o,i,a){return Ne(e,n,i,Se,{action:(i,a)=>(i.navigateTo(be.a,{controlName:e.CustomControlId,configuration:e,descriptor:t,elementNumber:n,entityTypeName:o}),Promise.resolve()),displayName:`Render ${n} `},Se,null,a)}function Ie(e,t,n,o,i,a,r,s,c){const l={action:(i,a)=>(i.navigateTo(be.a,{controlName:e.CustomControlId,configuration:e,descriptor:t,elementNumber:n,entityTypeName:o}),Promise.resolve()),displayName:`Render ${n} `},d=s?Object(u.makeCompositeAction)([l,...s],"Render the control, and perform necessary work to initialize"):l;return Ne(e,n,a,d,i,c,null,r)}function Oe(e,t,n,o){return()=>$(`[data-lp-id~="${e.CustomControlId}|${t.Id}|${o}"]`).length===n&&0===$(".inError").length}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Ae={TwoOptions:"MscrmControls.FieldControls.CheckboxControl",Currency:"MscrmControls.FieldControls.CurrencyControl",Decimal:"MscrmControls.FieldControls.DecimalNumberControl","SingleLine.Email":"MscrmControls.FieldControls.EmailAddressControl",FP:"MscrmControls.FieldControls.FloatingPointNumberInput","Whole.Language":"MscrmControls.FieldControls.LanguagePickerControl",OptionSet:"MscrmControls.FieldControls.OptionSet",StatusOptionSet:"MscrmControls.FieldControls.PicklistStatusControl","SingleLine.Phone":"MscrmControls.FieldControls.PhoneNumberControl","SingleLine.Text":"MscrmControls.FieldControls.TextBoxControl",Multiple:"MscrmControls.FieldControls.TextBoxControl","SingleLine.Ticker":"MscrmControls.FieldControls.TickerSymbolControl","Whole.TimeZone":"MscrmControls.FieldControls.TimeZonePickListControl","SingleLine.URL":"MscrmControls.FieldControls.UrlControl","Whole.None":"MscrmControls.FieldControls.WholeNumberControl","Whole.Duration":"MscrmControls.FieldControls.DurationControl","Lookup.Simple":"MscrmControls.FieldControls.SimpleLookupControl",MultiSelectPicklist:"MscrmControls.MultiSelectPicklist.MultiSelectPicklistControl","DateAndTime.DateOnly":"MscrmControls.FieldControls.DateTimeControl","DateAndTime.DateAndTime":"MscrmControls.FieldControls.DateTimeControl",Timer:"MscrmControls.FieldControls.TimerControl","SearchWidget.SearchWidget":"MscrmControls.KbSearchControl.KbSearchControl",Dummy:"MscrmControls.FieldControls.DummyControl",RelationshipAssistantContainer:"MscrmControls.CardFeedContainerWrapper.CardFeedContainerWrapper"},Te={Id:"testControl",Label:"",Name:"text",ShowLabel:!0,Visible:!0,Disabled:!1},we={DisplayName:"Test",LogicalName:"test",Type:"PLACEHOLDER MANIFEST",IsSecured:!1,RequiredLevel:0,EntityLogicalName:"fakeEntity",Precision:2,Behavior:null,Options:[{Label:"Active",Value:0},{Label:"Inactive",Value:1}],SourceType:0,Description:"Test Field",MaxValue:1e4,MinValue:0,TimeZoneByCode:{1e3:"testTimezone1",1001:"testTimezone2",1002:"testTimezone3",1003:"testTimezone4"},LanguageByCode:{1033:"English",1034:"language2",1035:"language3",1036:"language4"},Targets:["account"]},ke={value:{Usage:3,Static:!0,Type:"FOO",Value:null,Primary:!0,Attributes:we,Security:null,Callback:()=>{}},controlMode:{Usage:3,Static:!0,Type:"Enum",Value:2,Primary:!1},valueSpecification:{Usage:3,Static:!0,Type:"SingleLine.Text",Value:'{"Usage":3,"Static":false,"Type":"SingleLine.Text","Value":"test","Primary":true}',Primary:!1},deviceSizeMode:{Usage:1,Static:!0,Type:"WholeNumber.None",Value:0,Primary:!1}},Fe={FormFactor:2,CustomControlId:"FOO",Name:"FOO",Version:"1.0.0",Parameters:null,ShouldOverrideControlVisible:!1};function Ee(e,t,n){const o=Object.assign(Object.assign({},we),{Type:"SingleLine.Text"}),i=Object.assign(Object.assign({},ke),{value:{Usage:3,Static:!0,Type:"SingleLine.Text",Value:null,Primary:!0,Attributes:o}}),a={FormFactor:2,CustomControlId:"MscrmControls.Containers.FieldSectionItem",Name:e.Name+" in FieldSectionItem",Version:"1.0.0",Parameters:i,ShouldOverrideControlVisible:!1,Children:{[e.Name]:e}},r={Id:"TestControl",Label:"TESTLABEL",Name:"TestControl",ShowLabel:!0,Visible:!0,ClassId:new ve.a("4273edbd-ac1d-40d3-9fb2-095c621b552d"),Disabled:!1,Parameters:[],ControlLayout:0,UniqueId:"00000000-0000-0000-0000-000000000000",LabelId:"8b98a55e-a345-b20e-d46e-801e79d5c1c1",DomId:"id-8448b78f-8f42-454e-8e2a-f8196b0419af-3",DataFieldName:"TestControl",ParentSectionName:"-",ParentTabId:"-"};return Pe(a,r,1,n,function(e,t,n,o){return()=>{let i=0===$(".inError").length;for(const a in e.Children){const r=e.Children[a];i=i&&$(`[data-lp-id~="${r.CustomControlId}|${t.Id}.${r.Name}|${o}"]`).length===n}return i}}(e,r,1,n))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const De={Grid:["MscrmControls.Grid.GridControl","MscrmControls.Grid.ReadOnlyGrid"],Calendar:["MscrmControls.Calendar.CalendarControl"]},Me={Id:"testControl",Label:"",Name:"testControl",ShowLabel:!0,Visible:!0,Disabled:!1},$e={Grid:{Type:"Grid",EntityName:"account",ViewId:"00000000-0000-0000-00aa-000010001001",Columns:[{Alias:"entityimage_url",DataType:"SingleLine.Text",Type:"",Name:"entityimage_url"}],ExtraFilters:[],PagingInput:{Static:!0,Value:'{"firstPageNumber":1,"lastPageNumber":1,"pageSize":50}'}},Calendar:{Type:"Grid",EntityName:"account",ViewId:"00000000-0000-0000-00aa-000010001001",Columns:[{Alias:"StartDate",DisplayName:null,DataType:"DateAndTime.DateAndTime",Name:"createdon",Type:""},{Alias:"Description",DisplayName:null,DataType:"SingleLine.Text",Name:"name",Type:""}]}},je={controlMode:{Usage:3,Static:!0,Type:"Enum",Value:2,Primary:!1},valueSpecification:{Usage:1,Static:!0,Type:"SingleLine.Text",Value:'{"Usage":3,"Static":false,"Type":"SingleLine.Text","Value":"test","Primary":true}',Primary:!1}},Be={FormFactor:2,CustomControlId:"FOO",Name:"FOO",Version:"1.0.0",Parameters:null,ShouldOverrideControlVisible:!1};const Le={action:(e,t)=>(h("#telephone1"),Promise.resolve()),displayName:"sort action"};function _e(e,t,n,o){return()=>{const i=function(e){for(const t in e.Parameters)if("Grid"===e.Parameters[t].Type)return e.Parameters[t];return null}(e);return $(`[data-lp-id~="${e.CustomControlId}|${t.Id}|${o}|${i.ViewId}|${i.EntityName}"]`).length===n&&0===$(".inError").length}}var xe=n("zzhk"),Ve=n("N6E8"),Re=n("Yg7q"),Ue=n("5hnz"),ze=n("OhNP");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const We={};let qe=!1;var Ge;!function(e){e[e.Page=0]="Page",e[e.Benchmark=1]="Benchmark",e[e.Grid=2]="Grid",e[e.QuickCreateForm=3]="QuickCreateForm",e[e.Boot=4]="Boot",e[e.ColdBoot=5]="ColdBoot",e[e.Interaction=6]="Interaction",e[e.EditForm=7]="EditForm",e[e.EditFormCold=8]="EditFormCold",e[e.SearchPage=9]="SearchPage",e[e.BusinessProcessFlow=10]="BusinessProcessFlow",e[e.TimelineWall=11]="TimelineWall",e[e.SkypeChannel=12]="SkypeChannel",e[e.MetadataDrivenDialogs=13]="MetadataDrivenDialogs",e[e.Create=14]="Create",e[e.Update=15]="Update",e[e.Delete=16]="Delete",e[e.Commanding=17]="Commanding",e[e.MultiSession=18]="MultiSession"}(Ge||(Ge={}));const He=new class{constructor(e){this._scenarios=[],this._types=[];for(let t=0;t<e.length-1;t++)for(let n=t;n<e.length;n++){const o=e[t],i=e[n];if(t!==n&&(o.id===i.id||o.displayName===i.displayName))throw new Error("Duplicate performance scenario types found: "+o.id)}this._types=e}addScenario(e){if(!this.getType(e.typeId))throw new Error(`Type ${e.typeId} for scenario ${e.displayName} is not defined.`);this.getScenario(e.displayName)||this._scenarios.push(e)}getTypes(){return this._types}getType(e){const t=this._types.filter(t=>t.id===e);return t.length>0?t[0]:null}getScenario(e){return this._scenarios.filter(t=>t.displayName===e)[0]}getScenariosOfType(e){return this._scenarios.filter(t=>t.typeId===e)}validate(){const e=$("[data-id$=dialog]");for(let t=0;t<e.length;t++)d.a.logPerformanceIssue({type:c.PerformanceIssueType.ErrorDuringAutomation,level:c.PerformanceIssueLevel.Error,message:"Dialog found",parameters:[e[t].getAttribute("data-id")]});!function(){const e=We.iframe,t=$("iframe").length;e&&t>e&&d.a.logPerformanceIssue({type:c.PerformanceIssueType.ObjectCountIncrease,level:c.PerformanceIssueLevel.Warning,message:"Object count increased",parameters:["Iframe",e.toString(),t.toString()]}),We.iframe=t}()}}([{id:Ge.Page,displayName:"Page"},{id:Ge.Benchmark,displayName:"Benchmark"},{id:Ge.Grid,displayName:"Grid"},{id:Ge.EditForm,displayName:"Edit form"},{id:Ge.EditFormCold,displayName:"Edit form cold"},{id:Ge.Boot,displayName:"Boot"},{id:Ge.ColdBoot,displayName:"Cold boot"},{id:Ge.Interaction,displayName:"Interaction"},{id:Ge.QuickCreateForm,displayName:"Quick create form"},{id:Ge.SearchPage,displayName:"Search"},{id:Ge.BusinessProcessFlow,displayName:"Business Process Flow"},{id:Ge.TimelineWall,displayName:"Timeline Wall"},{id:Ge.SkypeChannel,displayName:"Skype for Business"},{id:Ge.MetadataDrivenDialogs,displayName:"Metadata Driven Dialogs"},{id:Ge.Create,displayName:"Create record"},{id:Ge.Update,displayName:"Update record"},{id:Ge.Delete,displayName:"Delete record"},{id:Ge.Commanding,displayName:"Commanding"},{id:Ge.MultiSession,displayName:"MultiSession"}]);function Je(){const e=$("[data-id$=dialog]");for(let t=0;t<e.length;t++)Xe()}function Xe(){S(Ue.a,!1)}const Ye={action:(e,t)=>(S(Ue.b,!1),e.decrementDialogCount(),Promise.resolve()),displayName:"Confirm dialog"};function Qe(){return!0}function Ke(){return $(`[data-id^=${Ve.a}]`).length>0}function Ze(){return $(`[data-id=${ze.a}]`).length>0}function et(e,t,n){return{displayName:e+" grid",typeId:Ge.Grid,setupAction:n,action:A(t),postIterationAction:n,validation:Ze}}function tt(e,t){return{displayName:e+" edit form",typeId:Ge.EditForm,setupAction:t,action:T,postIterationAction:t,validation:Ke}}function nt(e,t){const n=Object(u.makeCompositeAction)([t,Z],"Navigate to grid and reboot");return n.isBoot=!0,{displayName:e+" edit form cold from grid boot",typeId:Ge.EditFormCold,setupAction:n,action:T,postIterationAction:n,validation:Ke}}function ot(e,t){const n=function(e){return Object(u.makeCompositeAction)([e,T,D,B],"Navigate to form and pin first BPF stage")}(t),o=Object(u.makeCompositeAction)([_,x],"Move Previous Stage and close pinned stage"),i=Object(u.makeCompositeAction)([_,x,D,B],"Move Previous Stage and close pinned stage, reopen and pin stage");return{displayName:e+" BPF navigation",typeId:Ge.BusinessProcessFlow,setupAction:n,action:L,postIterationAction:i,cleanupAction:o,validation:()=>$('[data-id="MscrmControls.Containers.ProcessBreadCrumb-processControlContainer"]').length>0}}function it(e,t,n){const o=`${t}|NoRelationship|Form|Mscrm.Form.${t}.Assign`,i=Object(u.makeCompositeAction)([n,M(o,t)],`Navigate to ${t} form and ensure assign button is visible`),a={action:(e,t)=>(Xe(),Promise.resolve()),displayName:"MDD is closed successfully"},r=Object(u.makeCompositeAction)([a,M(o,t)],"Close dialog and ensure button is visible");return{displayName:e+" MDD navigation",typeId:Ge.MetadataDrivenDialogs,setupAction:i,action:j(o),postIterationAction:r,cleanupAction:a,validation:()=>$("[data-id=Assign]").length>0}}function at(e,t,n){const o=Object(u.makeCompositeAction)([n,k],`Navigate to ${t} grid and open quick create menu`),i=Object(u.makeCompositeAction)([E(),k],"Close quick create form and open quick create menu");return{displayName:e+" quick create form",typeId:Ge.QuickCreateForm,setupAction:o,action:F(t),postIterationAction:i,validation:()=>$(`[data-id=${Re.a}]`).length>0,cleanupAction:E()}}function rt(e){const t=f.b,n=f.e+"-recordsContainer";return{displayName:e===g.a.RelevanceSearch?"Relevance Search":"Categorized Search",typeId:Ge.SearchPage,setupAction:V(e),action:W(e),validation:()=>e===g.a.CategorizedSearch?$("#"+t).length>0:$(`[data-id='${n}']`).length>0}}function st(e){const t=e.getState(),n=Object(m.k)(t);var o;qe=Object(xe.b)(t),He.addScenario({displayName:`Boot ${(o=!0)?"warm":"cold"} into current page`,typeId:o?Ge.Boot:Ge.ColdBoot,isBoot:!0,action:o?Z:ee,validation:()=>!0}),[{displayName:"Open new session",typeId:Ge.MultiSession,action:{action:()=>Xrm.App.sessions.createSession({pageInput:{pageType:"search"}}),displayName:"Open new session with search page"},validation:()=>!0},{displayName:"Close focused session",typeId:Ge.MultiSession,setupAction:Ce,action:Ye,postIterationAction:Ce,validation:()=>!0},{displayName:"Cycle opened session tabs",typeId:Ge.MultiSession,action:fe,validation:()=>!0}].forEach(e=>He.addScenario(e));const i=Object(p.a)(t);if(n&&n.AreaIds)for(const t of n.AreaIds){if(t===C.d)continue;const o=n.Areas[t],l=w(t);for(const t of o.GroupIds){const n=o.Groups[t];for(const t of n.SubAreaIds){const o=n.SubAreas[t];let d=t;if(o.Titles&&o.Titles.length>0){const e=o.Titles.filter(e=>"1033"===e.LCID);d=e.length>0?e[0].Title:o.Titles[0].Title}const m=(s=t,c=l,Object(u.makeCompositeAction)([c,A(s)],"Navigate to sitemap item "+s));if(o.Entity){He.addScenario(et(d,t,l)),He.addScenario(tt(d,m)),He.addScenario(pe(d,m,e.dispatch)),He.addScenario(nt(d,m)),He.addScenario(ot(d,m)),He.addScenario(q(d,o.Entity,m)),He.addScenario(G(d,o.Entity,m)),He.addScenario(H(d,o.Entity,m)),He.addScenario({displayName:"Open tab "+(r=d),typeId:Ge.MultiSession,setupAction:ye,action:N("new-tab-item-"+r),postIterationAction:ye,validation:()=>!0}),He.addScenario(he(d));const n=Object(u.makeCompositeAction)([m,T],`Navigate to ${d} form`),s=()=>$(`[data-id^=${Ve.a}]`).length>0;He.addScenario(te(n,!0,s)),He.addScenario(it(d,o.Entity,n)),He.addScenario(re(d,n)),He.addScenario(se(d,n)),He.addScenario({displayName:"Toggle site map on page "+(a=n).displayName,typeId:Ge.Interaction,setupAction:a,action:I,postIterationAction:I,cleanupAction:I,validation:()=>$('[data-id="navbar-container"]').length>0}),i&&i.quickCreateMenuItems&&i.quickCreateMenuItems[o.Entity]&&He.addScenario(at(d,o.Entity,m))}else He.addScenario({displayName:d,typeId:Ge.Page,setupAction:l,action:A(t),validation:Qe,postIterationAction:Object(u.makeCompositeAction)([R,l],"Go to search page and open sitemap")});He.addScenario(te(m,!0,Qe))}}}var a,r,s,c;t.organization.organizationSettings.isExternalSearchIndexEnabled&&He.addScenario(rt(g.a.RelevanceSearch)),He.addScenario(rt(g.a.CategorizedSearch));const l=function(){const e=[];for(const t in Ae){const n=Ae[t];if(n){const o=n.split("."),i=Object.assign(Object.assign({},we),{Type:t}),a=Object.assign(Object.assign({},ke),{value:{Usage:3,Static:!0,Type:t,Value:null,Primary:!0,Attributes:i,ViewId:"a2d479c5-53e3-4c69-addd-802327e67a0d"}}),r=Object.assign(Object.assign({},Fe),{CustomControlId:n,Name:o[o.length-1],Parameters:a}),s=Te;"SearchWidget.SearchWidget"===t&&(s.Parameters={ShowContextualActions:"ShowAll"}),e.push(Pe(r,s,1,"incident",Oe(r,s,1,"incident"))),e.push(Pe(r,s,10,"incident",Oe(r,s,10,"incident"))),e.push(Ee(r,0,"account"))}}return e}().concat(function(){const e=[];for(const t in De){const n=De[t];for(let o=0;o<n.length;o++){const i=n[o];if(i){const n=Object.assign({},Be);n.CustomControlId=i;const o=i.split(".");n.Name=o[o.length-1],n.Parameters=Object.assign(Object.assign({},je),{[t]:$e[t]}),e.push(Pe(n,Me,1,"account",_e(n,Me,1,"account"))),e.push(Pe(n,Me,10,"account",_e(n,Me,10,"account"))),"Grid"===t&&e.push(Ie(n,Me,1,"account",Le,_e(n,Me,1,"account"),n.Name+" click action",[Le]))}}}return e}());for(let e=0;e<l.length;e++)He.addScenario(l[e]);!function(){if("function"==typeof window.CustomEvent)return!1;function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=Event.prototype,window.CustomEvent=e}()}function ct(e,t){d.a.initializeOnBoot(()=>{d.a.setCommonTimelineMetadata(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){const n=Object(o.y)(e),a=Object(o.x)(e),r=Object(i.d)(e),s=Object(i.f)(e),c=Object(i.i)(e);return{userAgent:window.navigator.userAgent,clientVersion:window.VERSION_NUMERIC_VALUE,serverVersion:n.serverVersion,serverDatabaseVersion:n.serverDatabaseVersion,languageCode:a.languageCode?a.languageCode.toString():"",clientHost:r,clientHostSubtype:s,clientHostVersion:JSON.stringify(c),telemetrySessionId:t}}(e.getState(),t)),st(e),Object(a.checkForContinuingPerformanceAutomation)(He,new r.a((t,n)=>{e.dispatch(Object(s.a)(t,n))}))})}},OU7F:function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return l}));var o=n("nJrx");
/**
 * Constants for the search page
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i="search-root-select",a="CategorizedSearchResultsScrollWrapper",r=Object(o.a)(),s=Object(o.a)(),c=Object(o.a)(),l="MscrmControls.Containers.RelevanceSearchControl"},OhNP:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));
/**
 * Constants for the grid page.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="GridRoot"},VnJU:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var o=n("iDqy"),i=n.n(o),a=n("zmaG"),r=n.n(a),s=n("FdKt"),c=n("6dVr"),l=n("t6P7"),d=n("STW0"),u=n("bfoP");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function m(){const e=[];return Object(s.c)().length>0&&e.push({type:d.PerformanceIssueType.IdleTaskAddedFromIdleTask,level:d.PerformanceIssueLevel.Warning,message:"New idle task(s) were added while executing previous idle tasks",parameters:Object(s.c)().map(e=>e.diagnosticId)}),e}function p(){if(0===Object(s.c)().length)return Promise.resolve([]);const e=[],t=Object(u.a)();return Object(s.b)(()=>{e.push(...m())},"Idle task validation"),Object(s.a)(),new Promise(n=>{r.a.onNextPerfData(()=>{e.push(...m()),e.push(...function(e){const t=[];return e.length>0&&t.push({type:d.PerformanceIssueType.ComponentUpdateDuringIdleTask,level:d.PerformanceIssueLevel.Warning,message:"Component(s) were rendered during idle tasks",parameters:e}),t}(t())),n(e)})})}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class g{constructor(e){this._intentionalDialogCount=0,this.DELAY_BETWEEN_ACTIONS=100,this._navigateToFunction=e}navigateTo(e,t){this._navigateToFunction(e,t)}waitForIdle(){return i.a.isAppIdle()?Promise.resolve():new Promise(e=>r.a.onNextPerfData(e))}executeIdleTasks(){return Object(s.a)(),this.waitForIdle()}logPerformanceIssue(e){r.a.logPerformanceIssue(e)}addMetadataToTimeline(e){r.a.addMetadataToTimeline(e)}processNextWorkBlock(e,t,n){return r.a.processNextWorkBlock(e,t,n).then(p).then(e=>Object(l.a)().then(t=>(e.push(...t),e)))}preActionCallback(){0===this._intentionalDialogCount&&Object(c.closeAllDialogs)()}incrementDialogCount(){this._intentionalDialogCount++}decrementDialogCount(){this._intentionalDialogCount>0&&this._intentionalDialogCount--}}},Yg7q:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));
/**
 * Constants for the quick create form page.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="quickCreateRoot"}}]),window.bundleExecutionMarkers["scripts/performancescenarios.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();