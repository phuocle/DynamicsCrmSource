(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/113.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[113],{"+//z":function(e,t,r){"use strict";var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.KeyQuery=void 0;var i=r("UZ+8"),o=r("GSc/"),s=r("Sh+4"),u=function(e){function t(t,r){var n=e.call(this,t)||this;return n._overrideKey=null,n._sourceId=r,n}return a(t,e),t.prototype.get_key=function(){if(!i.IsNullOrUndefinedOrEmptyString(this._overrideKey))return this._overrideKey;var e,t=s.LegacyGuid.tryCreate(this._sourceId);return e=t.equals(s.LegacyGuid.get_empty())?this._sourceId:t.toString(),this.get_EntityLogicalName()+","+e+","+this.get_returnTotalRecordCount()},t.prototype.get_DataLayerInternalCachingKey=function(){return this.get_key()+"::"+this.get_PageNumber()},t.prototype.get_SourceId=function(){return this._sourceId},t.prototype.get_OverrideKey=function(){return this._overrideKey},t.prototype.get_PublicKey=function(){return this._publicKey},t.prototype.set_OverrideKey=function(e){return this._overrideKey=e,e},t.prototype.set_PublicKey=function(e){return this._publicKey=e,this._publicKey},t.prototype.generateNorSyncAttributeName=function(e,t,r){return t},t.prototype.get_id=function(){return this.get_key()},t}(o.LegacyQuery);t.KeyQuery=u},"+QHC":function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var n,a,i,o,s,u,l,c,d,p,f,y,m,h,g;r.r(t),r.d(t,"OptionSetType",(function(){return n})),r.d(t,"DateTimeFormat",(function(){return a})),r.d(t,"ImeMode",(function(){return i})),r.d(t,"StringFormat",(function(){return o})),r.d(t,"AttributeTypeCode",(function(){return s})),r.d(t,"AttributeRequiredLevel",(function(){return u})),r.d(t,"SecurityTypes",(function(){return l})),r.d(t,"RelationshipType",(function(){return c})),r.d(t,"AssociatedMenuBehavior",(function(){return d})),r.d(t,"AssociatedMenuGroup",(function(){return p})),r.d(t,"OwnershipTypes",(function(){return f})),r.d(t,"CascadeType",(function(){return y})),r.d(t,"PrivilegeType",(function(){return m})),r.d(t,"EntityKeyIndexStatus",(function(){return h})),r.d(t,"AttributeType",(function(){return g})),function(e){e[e.Picklist=0]="Picklist",e[e.State=1]="State",e[e.Status=2]="Status",e[e.Boolean=3]="Boolean"}(n||(n={})),function(e){e[e.DateOnly=0]="DateOnly",e[e.DateAndTime=1]="DateAndTime"}(a||(a={})),function(e){e[e.Auto=0]="Auto",e[e.Inactive=1]="Inactive",e[e.Active=2]="Active",e[e.Disabled=3]="Disabled"}(i||(i={})),function(e){e[e.Email=0]="Email",e[e.Text=1]="Text",e[e.TextArea=2]="TextArea",e[e.Url=3]="Url",e[e.TickerSymbol=4]="TickerSymbol",e[e.PhoneticGuide=5]="PhoneticGuide",e[e.VersionNumber=6]="VersionNumber",e[e.Phone=7]="Phone"}(o||(o={})),function(e){e[e.Boolean=0]="Boolean",e[e.Customer=1]="Customer",e[e.DateTime=2]="DateTime",e[e.Decimal=3]="Decimal",e[e.Double=4]="Double",e[e.Integer=5]="Integer",e[e.Lookup=6]="Lookup",e[e.Memo=7]="Memo",e[e.Money=8]="Money",e[e.Owner=9]="Owner",e[e.PartyList=10]="PartyList",e[e.Picklist=11]="Picklist",e[e.State=12]="State",e[e.Status=13]="Status",e[e.String=14]="String",e[e.Uniqueidentifier=15]="Uniqueidentifier",e[e.CalendarRules=16]="CalendarRules",e[e.Virtual=17]="Virtual",e[e.BigInt=18]="BigInt",e[e.ManagedProperty=19]="ManagedProperty",e[e.EntityName=20]="EntityName",e[e.AliasedValue=21]="AliasedValue",e[e.ArrayOfString=22]="ArrayOfString",e[e.EntityImage=23]="EntityImage",e[e.MultiSelectPicklist=24]="MultiSelectPicklist",e[e.File=25]="File",e[e.NavigationProperty=26]="NavigationProperty"}(s||(s={})),function(e){e[e.None=0]="None",e[e.SystemRequired=1]="SystemRequired",e[e.ApplicationRequired=2]="ApplicationRequired",e[e.Recommended=3]="Recommended",e[e.Unknown=-1]="Unknown"}(u||(u={})),function(e){e[e.None=0]="None",e[e.Append=1]="Append",e[e.ParentChild=2]="ParentChild",e[e.Pointer=4]="Pointer",e[e.Inheritance=8]="Inheritance"}(l||(l={})),function(e){e[e.OneToManyRelationship=0]="OneToManyRelationship",e[e.ManyToManyRelationship=1]="ManyToManyRelationship",e[e.ManyToOneRelationship=2]="ManyToOneRelationship",e[e.None=-1]="None"}(c||(c={})),function(e){e[e.UseCollectionName=0]="UseCollectionName",e[e.UseLabel=1]="UseLabel",e[e.DoNotDisplay=2]="DoNotDisplay"}(d||(d={})),function(e){e[e.Details=0]="Details",e[e.Sales=1]="Sales",e[e.Service=2]="Service",e[e.Marketing=3]="Marketing"}(p||(p={})),function(e){e[e.None=0]="None",e[e.UserOwned=1]="UserOwned",e[e.TeamOwned=2]="TeamOwned",e[e.BusinessOwned=4]="BusinessOwned",e[e.OrganizationOwned=8]="OrganizationOwned",e[e.BusinessParented=16]="BusinessParented"}(f||(f={})),function(e){e[e.NoCascade=0]="NoCascade",e[e.Cascade=1]="Cascade",e[e.Active=2]="Active",e[e.UserOwned=3]="UserOwned",e[e.RemoveLink=4]="RemoveLink",e[e.Restrict=5]="Restrict"}(y||(y={})),function(e){e[e.None=0]="None",e[e.Create=1]="Create",e[e.Read=2]="Read",e[e.Write=3]="Write",e[e.Delete=4]="Delete",e[e.Assign=5]="Assign",e[e.Share=6]="Share",e[e.Append=7]="Append",e[e.AppendTo=8]="AppendTo"}(m||(m={})),function(e){e[e.Pending=0]="Pending",e[e.InProgress=1]="InProgress",e[e.Active=2]="Active",e[e.Failed=3]="Failed"}(h||(h={})),function(e){e.Boolean="boolean",e.Unknown="unknown",e.Customer="customer",e.Date="date",e.DateTime="datetime",e.Decimal="decimal",e.Double="double",e.Image="image",e.Integer="integer",e.Lookup="lookup",e.ManagedProperty="managedproperty",e.Memo="memo",e.Money="money",e.OptionSet="optionset",e.Owner="owner",e.PartyList="partylist",e.PickList="picklist",e.State="state",e.Status="status",e.String="string",e.UniqueIdentifier="uniqueidentifier",e.CalendarRules="calendarrules",e.Virtual="virtual",e.BigInt="bigint",e.EntityName="entityname",e.EntityImage="entityimage",e.AliasedValue="aliasedvalue",e.Regarding="regarding",e.MultiSelectPickList="multiselectpicklist",e.File="file",e.NavigationProperty="navigationproperty"}(g||(g={}))},"+u6Z":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n;Object.defineProperty(t,"__esModule",{value:!0}),t.getPartyListAttributeNames=t.getParticipationTypeMask=t.ParticipationTypeMask=void 0,function(e){e[e.Sender=1]="Sender",e[e.ToRecipient=2]="ToRecipient",e[e.CCRecipient=3]="CCRecipient",e[e.BccRecipient=4]="BccRecipient",e[e.RequiredAttendee=5]="RequiredAttendee",e[e.OptionalAttendee=6]="OptionalAttendee",e[e.Organizer=7]="Organizer",e[e.Regarding=8]="Regarding",e[e.Owner=9]="Owner",e[e.Resource=10]="Resource",e[e.Customer=11]="Customer",e[e.Partner=12]="Partner"}(n||(n={})),t.ParticipationTypeMask=n,t.getPartyListAttributeNames=function(e){switch(e){case"campaignactivity":return["partners","from"];case"fax":return["from","to"];case"email":case"letter":return["from","to","cc","bcc"];case"phonecall":return["from","to"];case"appointment":return["optionalattendees","organizer","requiredattendees"];case"campaignresponse":return["customer","partner","from"];case"recurringappointmentmaster":return["optionalattendees","organizer","requiredattendees"];case"serviceappointment":return["customers","resources"];default:return["bcc","cc","customers","optionalattendees","organizer","requiredattendees","resources","sendermailboxid","to","from"]}},t.getParticipationTypeMask=function(e,t){switch((e+"."+t).toLowerCase()){case"campaignactivity.from":case"campaignresponse.from":case"fax.from":case"email.from":case"letter.from":case"phonecall.from":return n.Sender;case"email.to":case"fax.to":case"letter.to":case"phonecall.to":return n.ToRecipient;case"email.cc":return n.CCRecipient;case"email.bcc":case"letter.bcc":return n.BccRecipient;case"appointment.optionalattendees":case"recurringappointmentmaster.optionalattendees":return n.OptionalAttendee;case"appointment.organizer":case"recurringappointmentmaster.organizer":return n.Organizer;case"appointment.requiredattendees":case"recurringappointmentmaster.requiredattendees":return n.RequiredAttendee;case"campaignresponse.customer":case"serviceappointment.customer":return n.Customer;case"serviceappointment.resources":return n.Resource;case"campaignactivity.partners":case"campaignresponse.partner":return n.Partner;default:return function(e){switch(e){case"bcc":return n.BccRecipient;case"cc":return n.CCRecipient;case"customers":return n.Customer;case"partners":return n.Partner;case"optionalattendees":return n.OptionalAttendee;case"organizer":return n.Organizer;case"requiredattendees":return n.RequiredAttendee;case"resources":return n.Resource;case"sendermailboxid":case"from":return n.Sender;case"to":return n.ToRecipient;case"regarding":return n.Regarding;case"owner":return n.Owner;default:return}}(t)}}},"/vtY":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeSnapshotWrapper=void 0;var n=r("1LmJ"),a=r("fr82"),i=r("UZ+8"),o=function(){function e(e,t,r){if(n.assert(!i.IsNullOrUndefined(e),"XPathEvaluator should not be null"),n.assert(!i.IsNullOrUndefined(t),"Node list obj should not be null"),this._list=[],t instanceof XPathResult)for(var o=t,s=0;s<o.snapshotLength;s++)this._list.push(new a.XPathEvaluatorWrapper(e,o.snapshotItem(s),r));else{var u=t;for(s=0;s<u.length;s++)this._list.push(new a.XPathEvaluatorWrapper(e,u[s],r))}}return e.prototype.get_count=function(){return this._list.length},e.prototype.get_item=function(e){return this._list[e]},e}();t.NodeSnapshotWrapper=o},"0DNP":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallingContext=void 0;var n=r("UZ+8"),a=function(){function e(t,r,a){this._callerPriority=0,this._callerName=n.IsNullOrUndefinedOrEmptyString(r)?e.unknown:r,this._callerPriority=a}return e.prototype.get_callerName=function(){return this._callerName},e.prototype.get_Stack=function(){return this._stack},e.prototype.AppendCallStack=function(e){n.IsNullOrUndefined(e)||(n.IsNullOrUndefined(this._stack)?this._stack=e:this._stack=this._stack+":"+e)},e.prototype.get_callerPriority=function(){return this._callerPriority},e.prototype.IsPreloadCall=function(){return!1},e.unknown="unknown",e}();
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */t.CallingContext=a},"0f0B":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XmlEvaluatorType=void 0,function(e){e[e[void 0]=-1]="undefined",e[e.xPath=0]="xPath",e[e.domParser=1]="domParser"}(t.XmlEvaluatorType||(t.XmlEvaluatorType={}))},"0fKB":function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return s}));var n=r("17Cn"),a=r("OhA8"),i=r("gmsG");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
async function o(e,t,r){const o=e.TraceManager.getTracer(i.COMPONENT_NAMES.MetadataCache),s=[];o.info(u()+" Starting getSqlResults");const l={sqlStatements:[],sqlParameters:new Array,additionalParameters:{}};return l.sqlStatements.push(t),l.sqlParameters.push(r),e.SqlExecutor.ExecuteSqlStatementsOnMetadataDB(l).then(e=>(o.info(u()+" Completed getSqlResults"),e)).catch(e=>{const t=Object(a.e)(e);return s.push({name:n.STRING_CONSTANTS.Message,value:t.message}),s.push({name:n.STRING_CONSTANTS.ErrorCode,value:t.code?t.code:n.UNKNOWN}),s.push({name:n.STRING_CONSTANTS.StackTrace,value:t.stack?t.stack:n.UNKNOWN}),o.error(`${u()} Exception in getSqlResults. Error message = ${e.message}`,s),Promise.reject(t)})}async function s(e,t){const r=e.TraceManager.getTracer(i.COMPONENT_NAMES.MetadataCache),o=[];return o.push({name:"NoOfSQLStatements",value:t&&t.sqlStatements?t.sqlStatements.length:0}),r.info(u()+" Starting getBatchSqlResults. ",o),e.SqlExecutor.ExecuteSqlStatementsOnMetadataDB(t).then(e=>(r.info(u()+" Completed getBatchSqlResults",o),e)).catch(e=>{const t=Object(a.e)(e);return o.push({name:n.STRING_CONSTANTS.Message,value:t.message}),o.push({name:n.STRING_CONSTANTS.ErrorCode,value:t.code?t.code:n.UNKNOWN}),o.push({name:n.STRING_CONSTANTS.StackTrace,value:t.stack?t.stack:n.UNKNOWN}),r.error(`${u()} Exception in getBatchSqlResults. Error message = ${e.message}`,o),Promise.reject(t)})}function u(e){return e?`[${e}]`:`[${i.FILE_PREFIX.GetSqlResults}]`}},"0hOr":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.getAttributeType=t.isDependentOptionSetAttribute=t.getEntityAttributesByType=t.getDependentOptionSetAttributes=t.getPrimaryAttributeName=t.getSelectedAttributesForEntity=t.getAttributeTypes=t.getMissingAttributes=t.getAttributeDescriptor=t.getUnboundAttributes=t.getAttributesForEntity=void 0;var n=r("cvWF"),a=r("Mx+d");function i(e,t){var r,n;return e&&(null==e?void 0:e.metadata)&&(null===(r=null==e?void 0:e.metadata)||void 0===r?void 0:r.attributes)?null===(n=null==e?void 0:e.metadata)||void 0===n?void 0:n.attributes[t]:null}function o(e,t,r){var n=i(e,t);if(!n)return null;if(0===r.length)return n;var a={};return r.forEach((function(e){n.hasOwnProperty(e)&&(a[e]=n[e])})),a}function s(e,t,r){var n=i(e,t);return n&&n.hasOwnProperty(r)?n[r]:null}t.getAttributesForEntity=i,t.getMissingAttributes=function(e,t,r){if(!r||!r.length)return[];var n=i(e,t);if(!n)return r;for(var a=[],o=0;o<r.length;o++)n[r[o]]||a.push(r[o]);return a},t.getSelectedAttributesForEntity=o,t.getUnboundAttributes=function(e,t){return i(e,t)},t.getAttributeDescriptor=s,t.getAttributeTypes=function(e,t,r){var n={},a=i(r,t);return a&&(e&&e.length?e.forEach((function(e){a[e]&&(n[e]=a[e].Type)})):Object.keys(a).forEach((function(e){n[e]=a[e].Type}))),n},t.getAttributeType=function(e,t,r){var n=i(r,t);return n&&n[e]?n[e].Type:null},t.getPrimaryAttributeName=function(e,t){var r=a.getEntityDescriptor(e,t);return r&&r.PrimaryNameAttribute?r.PrimaryNameAttribute:null},t.getDependentOptionSetAttributes=function(e,t,r){if(!r||0===r.length)return null;var a=o(e,t,r);if(!a)return null;var i={};for(var s in a){var u=a[s];u.Type!==n.AttributeType.PickList&&u.Type!==n.AttributeType.MultiSelectPickList||!(u.ParentPicklistLogicalName||u.ChildPicklistLogicalNames&&u.ChildPicklistLogicalNames.length>0)||(i[s]=u)}return i},t.getEntityAttributesByType=function(e,t,r){var n,a,i={};if((null==e?void 0:e.metadata)&&(null===(n=null==e?void 0:e.metadata)||void 0===n?void 0:n.attributes)){var o=null===(a=null==e?void 0:e.metadata)||void 0===a?void 0:a.attributes[t];for(var s in o)o[s].Type===r&&(i[s]=o[s])}return i},t.isDependentOptionSetAttribute=function(e,t,r){var n=s(e,t,r);return!(!n||!(n.ParentPicklistLogicalName||n.ChildPicklistLogicalNames&&n.ChildPicklistLogicalNames.length>0))}},"17Cn":function(e,t,r){"use strict";r.r(t),r.d(t,"UNEXPECTED_STATUS_CODE",(function(){return u})),r.d(t,"HINT",(function(){return c})),r.d(t,"HEADER",(function(){return d})),r.d(t,"HEADER_VALUES",(function(){return p})),r.d(t,"ErrorCode",(function(){return f})),r.d(t,"APP_ENTITY",(function(){return y})),r.d(t,"WEB_API_URL_FRAGMENT",(function(){return m})),r.d(t,"STRING_CONSTANTS",(function(){return h})),r.d(t,"COMPOSITE_INDEX_DELIMITER",(function(){return g})),r.d(t,"UNKNOWN",(function(){return E})),r.d(t,"CLIENT_TYPE",(function(){return b})),r.d(t,"EXECUTION_HINTS",(function(){return _})),r.d(t,"OPERATION",(function(){return n})),r.d(t,"HTTP_REQUEST_METHOD",(function(){return a})),r.d(t,"HTTP_STATUS_CODES",(function(){return s})),r.d(t,"SQLQuerySupportedList",(function(){return i})),r.d(t,"FileQuerySupportedList",(function(){return o})),r.d(t,"ADDITIONAL_PARAMETERS",(function(){return l})),r.d(t,"EXPAND_VALUES",(function(){return v})),r.d(t,"EXPAND_PROPERTIES",(function(){return T})),r.d(t,"FILE_ATTACHMENT",(function(){return O})),r.d(t,"DEVICE_FILE_PATH",(function(){return S}));
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
const n={Create:"Create",Batch:"Batch",Retrieve:"Retrieve",RetrieveMultiple:"RetrieveMultiple",GetClientMetadata:"GetClientMetadata",Update:"Update",Delete:"Delete",Download:"Download",Upload:"Upload"},a={Post:"POST",Get:"GET",Patch:"PATCH",Delete:"DELETE"},i=[n.Create,n.Delete,n.Batch,n.GetClientMetadata,n.Update,n.Retrieve,n.RetrieveMultiple],o=[n.Download,n.Upload],s={Ok:200,Accepted:202,NoContent:204,PartialContent:206,BadRequest:400,Unauthorized:401,NotFound:404,Unknown:420,InternalServerError:500,ServiceUnavailable:503},u=[s.BadRequest,s.InternalServerError,s.NotFound,s.ServiceUnavailable],l={RecordId:"RecordId",PageSize:"PageSize",MetadataTypes:"MetadataTypes"},c={select:"x-ms-mdl-select",pageSize:"x-ms-mdl-pageSize",pageNumber:"x-ms-mdl-pageNumber",filter:"x-ms-mdl-filter",linkEntity:"x-ms-mdl-link",viewId:"x-ms-mdl-viewId",rawFetch:"x-ms-mdl-rawFetchXml",mergeQuickFind:"x-ms-mdl-mergeQuickFind",contextFilter:"x-ms-mdl-contextFilter",executionStrategy:"x-ms-mdl-execution-hints",search:"x-ms-mdl-search",orderBy:"x-ms-mdl-orderby"},d={ACCEPT:"Accept",PREFER:"Prefer",AUTO_DISASSOCIATE:"AutoDisassociate",IF_MATCH:"If-match",MSCRM_SUPPRESS_DUPLICATION_DETECTION:"MSCRM.SuppressDuplicateDetection",MSCRM_RETURN_NOTIFICATIONS:"MSCRM.ReturnNotifications",APP_ENTITY:"appmodules",AUTHORIZATION:"Authorization",CONTENT_TYPE:"Content-Type",ODADTA_ENTITY_ID:"OData-EntityId",CONTENT_LENGTH:"Content-Length",CLIENT_REQUEST_ID:"x-ms-client-request-id",SERVER_REQUEST_ID:"x-ms-service-request-id",SESSION_ID:"x-ms-client-session-id",ACTIVITY_ID:"x-ms-correlation-id",SOURCE_ID:"x-ms-source-id",USER_AGENT:"x-ms-user-agent",APP_ID:"x-ms-app-id",APP_NAME:"x-ms-app-name",OBJECT_ID:"x-ms-sw-objectid",TENANT_ID:"x-ms-sw-tenantid",CONTENT_ID:"Content-ID",CONTENT_TRANSFER_ENCODING:"Content-Transfer-Encoding",PREFERENCE_APPLIED:"Preference-Applied",LOCATION:"Location",REQ_ID:"REQ_ID"},p={APPLICATION_JSON:"application/json",APPLICATION_HTTP:"application/http",BINARY:"binary",ANNOTATIONS:'odata.include-annotations="*"',PREFER_REPRESENTATION:"return=representation"},f={CannotUpdateOnlineRecord:-2147093980,CannotDeleteOnlineRecord:-2147093944,DataSourceOfflineErrorCode:-2147093999,UnknownUnexpectedGenericError:-2147015414,UnknownBadRequestError:-2147015424},y="appmodules",m="/api/data/v9.0/",h={ErrorCode:"code",Message:"message",StackTrace:"stacktrace",InnerError:"innererror"},g="_",E="Unknown",b={local:"local",remote:"remote"},_={ONLINE:"Online",OFFLINE:"Offline"},v={MULTI_VALUE:"MultiValue",SINGLE_VALUE:"SingleValue"},T="ExpandProperties",O="fileattachment",S="devicefilepath"},"1LmJ":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.assert=void 0,t.assert=function(e,t){}},"3Cvv":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DescriptorSet=void 0;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n=r("rfM3"),a=r("UZ+8"),i=r("IUwF"),o=r("8c4H"),s=function(){function e(){this._descriptors={}}return e.prototype.get_descriptors=function(){return this._descriptors},e.prototype.tryGetDescriptor=function(e){return a.IsNullOrUndefined(this._descriptors[o.DescriptorFormat[e]])?"":this._descriptors[o.DescriptorFormat[e]].Data},e.prototype.updateDescriptorSet=function(e,t){o.DescriptorFormat[e]in this.get_descriptors()?this._descriptors[o.DescriptorFormat[e]].Data=t:this._descriptors[o.DescriptorFormat[e]]=new i.DescriptorData(e,t)},e.createFromFetchXml=function(t){var r=new e;return r._descriptors[o.DescriptorFormat[o.DescriptorFormat.FetchXml]]=new i.DescriptorData(o.DescriptorFormat.FetchXml,t),r},e.createDescriptorSet=function(t,r,a){var s=new e;if(r===n.MetadataType.fetchXml)if(t instanceof Array)for(var u=0;u<t.length;u++){var l=t[u];(l.Format!==o.DescriptorFormat.Sql||a)&&(s.get_descriptors()[o.DescriptorFormat[l.Format]]=new i.DescriptorData(l.Format,l.Data))}else"string"==typeof t&&(s.get_descriptors()[o.DescriptorFormat[o.DescriptorFormat.FetchXml]]=new i.DescriptorData(o.DescriptorFormat.FetchXml,t));else s.get_descriptors()[o.DescriptorFormat[0]]=new i.DescriptorData(0,t);return s},e}();t.DescriptorSet=s},"3v6g":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return o},s=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.parseResponseForRowVersion=t._splitByBoundary=t.parseBatchResponse=t.getEntityIdFromResponse=t.parseResponseAsGuid=void 0;var u=r("FDNG"),l=r("5vhp"),c=r("mE2v");function d(e){var t=c.getHttpHeader(e.headers,"OData-EntityId");if(t){var r=t.indexOf("(")+1,n=t.substring(r,t.length-1);return u.Guid.tryParse(n)}return null}function p(e,t){if(!t)return[];var r="--"+e+"\r\n";0===t.indexOf(r)||(r="--"+e+"\n");var n=t.split(r);if(n.splice(0,1),n.length>0){var a=n[n.length-1],i=a.indexOf("--"+e);n[n.length-1]=a.substring(0,i)}return n}function f(e,t){var r=t.indexOf(":");if(r>=0){var n=t.substring(0,r),a=t.substring(r+1).trim();e[n]=a}return e}function y(e){var t,r,n=-1!==e.indexOf("\r\n\r\n"),a=e.trim().split(n?"\r\n\r\n":"\n\n"),o=-1,s=null,u=null,c="",d="";if(a.length>0){var p=null;a.length>1&&(p=a[1].split(n?"\r\n":"\n"));var y=null;null!=p&&(y=p.slice(1),u=/(HTTP\/\d\.\d) (\d+) (.*)/gi.exec(p[0]));var h=a[0].split(n?"\r\n":"\n");if(null!=h)try{for(var g=i(h),E=g.next();!E.done;E=g.next()){var b=E.value;0===b.toLowerCase().indexOf("content-id:")&&(null==y||y.push(b))}}catch(e){t={error:e}}finally{try{E&&!E.done&&(r=g.return)&&r.call(g)}finally{if(t)throw t.error}}if(o=u&&u.length>=3?Number(u[2]):0,y){var _=y.reduce(f,{});s=new l.FetchLikeHeaders(_)}a.length>1&&(d=a[2]),null!=u&&u.length>2&&(c=u[3])}return m(o,c,s,d)}function m(e,t,r,n){return{status:e,ok:200<=e&&299>=e,statusText:t,headers:r,clone:function(){return Object.assign({},this)},json:function(){return Promise.resolve(n?JSON.parse(n):null)},text:function(){return Promise.resolve(n)}}}t.parseResponseAsGuid=d,t.getEntityIdFromResponse=function(e,t){return n(this,void 0,void 0,(function(){var r,n;return a(this,(function(a){switch(a.label){case 0:return(r=d(t))?[3,2]:[4,t.json()];case 1:return n=a.sent(),[2,u.Guid.tryParse(n[e])];case 2:return[2,r]}}))}))},t._splitByBoundary=p,t.parseBatchResponse=function(e,t){return n(this,void 0,void 0,(function(){var r,n,o,u,l,d,f,h,g,E,b,_,v,T,O,S,N,R,M;return a(this,(function(a){switch(a.label){case 0:return null==t||t.AppendCallStack("Parsers.parseBatchResponse"),[4,e.text()];case 1:r=a.sent(),n=[],e.headers?(u=/boundary=(.*)/,l=c.getHttpHeader(e.headers,"Content-Type"),d=l&&u.test(l)&&u&&l.match(u),o=d&&d.length>1?d[1]:""):o=r.substr(r.indexOf("batchresponse"),r.indexOf("\r\n")-2),f=p(o,r);try{for(h=i(f),g=h.next();!g.done;g=h.next())E=g.value,(b=/^\s*Content-Type: .*boundary=(.*)\r?\n/gi.exec(E))?(_=b[1],v=E.indexOf("--"+_),T=E.slice(v),O=p(_,T),S=O.map(y),n.push.apply(n,s(S))):(N=y(E),n.push(N))}catch(e){R={error:e}}finally{try{g&&!g.done&&(M=h.return)&&M.call(h)}finally{if(R)throw R.error}}return 0===n.length&&(N=m(e.status,e.statusText,e.headers,r),n.push(N)),[2,n]}}))}))},t.parseResponseForRowVersion=function(e){var t=c.getHttpHeader(e.headers,"ETag");if(!t)return null;var r=t.indexOf('"')+1;return t.substring(r,t.length-1)}},"4/PP":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.deserializeErrorResponse=void 0;var n=r("17Cn"),a=r("UZ+8"),i=r("RHls"),o=r("mE2v"),s=r("vqTk"),u=r("n8WZ"),l=r("8xE/");function c(e,t,r){var n,o,s,u,l,p,f,y=null===(n=e.code)||void 0===n?void 0:n.toString();if(a.IsNullOrUndefinedOrEmptyString(y)&&(y=null===(o=e.ErrorCode)||void 0===o?void 0:o.toString(),a.IsNullOrUndefinedOrEmptyString(y)?r.error("Unexpected server error response - no error code"):r.error("Unexpected server error response - error code provided as ErrorCode")),!a.IsNullOrUndefinedOrEmptyString(y)){var m=y.toLowerCase().startsWith("0x")?16:10;f=parseInt(y.toString(),m)}var h=null===(s=e.message)||void 0===s?void 0:s.toString();a.IsNullOrUndefinedOrEmptyString(h)&&(h=null===(u=e.Message)||void 0===u?void 0:u.toString(),a.IsNullOrUndefinedOrEmptyString(h)?r.error("Unexpected server error response - no message"):r.error("Unexpected server error response - message provided as Message"));var g=null===(l=e.stacktrace)||void 0===l?void 0:l.toString();a.IsNullOrUndefinedOrEmptyString(g)&&(g=null===(p=e.StackTrace)||void 0===p?void 0:p.toString(),a.IsNullOrUndefinedOrEmptyString(g)||r.error("Unexpected server error response - message provided as Message"));var E=e.innererror,b=null;a.IsNullOrUndefined(E)||(b=c(E,t,r));var _=d(f,t.status);return new i.ErrorStatus(h,_,null,b,null,null,null,null,null,null,g)}function d(e,t){if(0!==e)return e;switch(t){case 400:return l.ErrorCodes.unknownBadRequestError;case 401:return l.ErrorCodes.UnknownUnauthorizedError;case 403:return l.ErrorCodes.unknownForbiddenError;case 404:return l.ErrorCodes.unknownNotFoundError;case 429:return l.ErrorCodes.UnknownTooManyRequestsError;case 500:return l.ErrorCodes.unknownInternalServerError;case 501:return l.ErrorCodes.unknownNotImplementedServerError;case 502:return l.ErrorCodes.unknownBadGatewayError;case 503:return l.ErrorCodes.unknownServiceUnavailableError;case 504:return l.ErrorCodes.unknownGatewayTimeoutError;default:return l.ErrorCodes.UnknownUnexpectedGenericError}}t.deserializeErrorResponse=function(e,t,r,l){var p,f=e&&e.toLowerCase().indexOf("<!doctype html")>-1;(p=f?function(e,t,r){var n=d(0,t.status);return new i.ErrorStatus(e,n)}(e,t):function(e,t,r){try{var n=JSON.parse(e),o=n.error,s=void 0;return a.IsNullOrUndefined(o)?(r.error("Unexpected server error response - no error at top level"),s=c(n,t,r)):s=c(o,t,r),s}catch(o){return r.error("Failure during error parsing: "+o.message),new i.ErrorStatus(e)}}(e,t,l)).httpStatusCode=t.status;var y=t.headers?o.getHttpHeader(t.headers,s.HEADER.RETRY_AFTER):null;p.retryAfter=y;var m=t.headers?o.getHttpHeader(t.headers,s.HEADER.CONTENT_ID):null;if(m){var h=Number.parseInt(m,10);h>-1&&(p.faultedRequestIndex=h)}var g=t.headers?o.getHttpHeader(t.headers,s.HEADER.SERVER_REQUEST_ID):n.UNKNOWN,E=t.headers?o.getHttpHeader(t.headers,s.HEADER.CLIENT_REQUEST_ID):n.UNKNOWN;p.serverResponseId=g,p.clientRequestId=E;var b=t&&0===t.status;return r.push({name:u.MDS_EVENT_PARAMETERS.ODATA_ERROR_RESPONSE_IS_HTML_TYPE,value:f}),r.push({name:u.MDS_EVENT_PARAMETERS.IS_ERROR_IN_OFFLINE,value:b}),p}},"54+h":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.buildFunctionRequest=void 0;var n=r("vqTk"),a=r("u+qd");t.buildFunctionRequest=function(e,t){var r;try{return{urlParameters:a.getODataUrlForFunction(e,t),additionalHeaders:(r={},r[n.HEADER.ACCEPT]=n.HEADER_VALUES.APPLICATION_JSON,r[n.HEADER.PREFER]=n.HEADER_VALUES.ANNOTATIONS,r),method:"GET"}}catch(e){return{serializationFailure:e.message}}}},"5vhp":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.FetchLikeHeaders=void 0;var n=function(){function e(e){this._headers=e}return e.prototype[Symbol.iterator]=function(){throw new Error("Method not implemented.")},e.prototype.entries=function(){throw new Error("Method not implemented.")},e.prototype.keys=function(){throw new Error("Method not implemented.")},e.prototype.values=function(){throw new Error("Method not implemented.")},e.prototype.append=function(e,t){this._headers[e]=t},e.prototype.get=function(e){return this._headers[e]},e.prototype.has=function(e){return this._headers.hasOwnProperty(e)},e.prototype.delete=function(e){delete this._headers[e]},e.prototype.set=function(e,t){this._headers[e]=t},e.prototype.forEach=function(e){for(var t in this._headers)e(this._headers[t],t,this)},e}();t.FetchLikeHeaders=n},"6/7M":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.GC_UPDATE_DATA_ACTION=t.GC_REMOVE_DATA_ACTION=t.garbageCollectorDataReducer=void 0;var n=r("MXGD"),a=r("8s0g");t.GC_REMOVE_DATA_ACTION="gc.data.remove";t.GC_UPDATE_DATA_ACTION="gc.data.update";var i={},o=["gc.data.update","gc.data.remove"],s=["gc.data.update","gc.data.remove"],u={};function l(e,t){if(0===Object.keys(t).length)return e;var r=Object.assign({},e);for(var n in t){var a=t[n];for(var i in a)r[n]||(r[n]=t[n]),r[n][i]=t[n][i]}return Object.freeze(r)}function c(e,t){if(0===Object.keys(t).length)return e;var r={};for(var n in e){var a=e[n];if(void 0===t[n])r[n]=e[n];else for(var i in a)void 0===t[n][i]&&(r[n]||(r[n]={}),r[n][i]=t[n][i])}return Object.freeze(r)}var d=["gc.data.update","gc.data.remove"];var p={entities:function(e,t){return void 0===e&&(e=u),-1!==o.indexOf(t.type)&&t&&t.payload&&t.payload.entities?"gc.data.remove"===t.type?c(e,t.payload.entities):l(e,t.payload.entities):e},lists:function(e,t){return void 0===e&&(e=i),-1!==d.indexOf(t.type)&&t&&t.payload&&t.payload.lists?"gc.data.remove"===t.type?a.gcGenericRemoveItems(e,t.payload.lists):a.gcGenericAddItems(e,t.payload.lists):e},charts:function(e,t){return void 0===e&&(e=u),-1!==s.indexOf(t.type)&&t&&t.payload&&t.payload.charts?"gc.data.remove"===t.type?c(e,t.payload.charts):l(e,t.payload.charts):e},chartData:function(e,t){return void 0===e&&(e=i),-1!==s.indexOf(t.type)&&t&&t.payload&&t.payload.chartData?"gc.data.remove"===t.type?a.gcGenericRemoveItems(e,t.payload.chartData):a.gcGenericAddItems(e,t.payload.chartData):e}},f=n.combineReducers(p);t.garbageCollectorDataReducer=f},"8c4H":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DescriptorFormat=void 0,function(e){e[e.Json=0]="Json",e[e.FetchXml=1]="FetchXml",e[e.Sql=2]="Sql",e[e.LayoutXml=3]="LayoutXml"}(t.DescriptorFormat||(t.DescriptorFormat={}))},"8s0g":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.gcGenericRemoveItems=t.gcGenericAddItems=t.gcMetadataRibbonsReducer=t.gcMetadataEntitiesReducer=void 0;var n=r("wEu3"),a=[n.UPDATE_GC_METADATA_REFCOUNT_ACTION,n.GC_REMOVE_METADATA],i={};function o(e,t){if(0===Object.keys(t).length)return e;var r=Object.assign({},e);for(var n in t)r[n]=Object.freeze(t[n]);return Object.freeze(r)}function s(e,t){if(0===Object.keys(t).length)return e;var r={};for(var n in e)void 0===t[n]&&(r[n]=e[n]);return Object.freeze(r)}t.gcMetadataEntitiesReducer=function(e,t){return void 0===e&&(e=i),-1!==a.indexOf(t.type)&&t&&t.payload&&t.payload.entities?t.type===n.GC_REMOVE_METADATA?s(e,t.payload.entities):o(e,t.payload.entities):e},t.gcMetadataRibbonsReducer=function(e,t){return void 0===e&&(e=i),-1!==a.indexOf(t.type)&&t&&t.payload&&t.payload.ribbons?t.type===n.GC_REMOVE_METADATA?s(e,t.payload.ribbons):o(e,t.payload.ribbons):e},t.gcGenericAddItems=o,t.gcGenericRemoveItems=s},"8xE/":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n;Object.defineProperty(t,"__esModule",{value:!0}),t.isNonReportableErrorCode=t.ErrorCodes=void 0,function(e){e[e.MetadataNoMapping=2147749377]="MetadataNoMapping",e[e.ObjectDoesNotExist=2147746327]="ObjectDoesNotExist"}(n||(n={})),function(e){e[e.InvalidEntity=2147868684]="InvalidEntity",e[e.unknownBadRequestError=2147951697]="unknownBadRequestError",e[e.UnknownUnauthorizedError=2147951872]="UnknownUnauthorizedError",e[e.unknownForbiddenError=2147951873]="unknownForbiddenError",e[e.unknownNotFoundError=2147951874]="unknownNotFoundError",e[e.UnknownTooManyRequestsError=2147951875]="UnknownTooManyRequestsError",e[e.unknownInternalServerError=2147951876]="unknownInternalServerError",e[e.unknownNotImplementedServerError=2147951877]="unknownNotImplementedServerError",e[e.unknownBadGatewayError=2147951878]="unknownBadGatewayError",e[e.unknownServiceUnavailableError=2147951879]="unknownServiceUnavailableError",e[e.unknownGatewayTimeoutError=2147951880]="unknownGatewayTimeoutError",e[e.UnknownUnexpectedGenericError=2147951881]="UnknownUnexpectedGenericError"}(t.ErrorCodes||(t.ErrorCodes={})),t.isNonReportableErrorCode=function(e){e<0&&(e=4294967295+e+1);var t=[n.MetadataNoMapping,n.ObjectDoesNotExist];return null!=e&&t.indexOf(e)>-1}},A64d:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.addRequestId=t.fromODataContract=t.fromQueryState=void 0;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var i=r("17Cn"),o=r("FDNG"),s=r("UZ+8"),u=r("l7wu"),l=r("oMGx"),c=r("Mx+d"),d=r("vqTk"),p=r("a5Wk");function f(e){return{type:"odatabuilder.fromodatacontract.async",execute:function(t,r){var i=t.getState,o=t.dispatch;return n(this,void 0,void 0,(function(){var t,s,c;return a(this,(function(d){switch(d.label){case 0:return(t=r.TraceManager.getTracer(u.MDL_COMPONENT_NAMES.ODataBuilder)).info(h()+" Create a SerializedRequest from OData Contract."),s=i(),"ExecuteMultiple"!==e.getMetadata().operationName?[3,2]:[4,o((m=e,{type:"odatabuilder.fromexecutemutipleodatacontract.async",execute:function(e,t){var r=e.dispatch;return n(this,void 0,void 0,(function(){var e,i,o,s=this;return a(this,(function(u){switch(u.label){case 0:return e=m.requests,i=e.map((function(e){return n(s,void 0,void 0,(function(){var t=this;return a(this,(function(i){switch(i.label){case 0:return l.isODataContract(e)?[4,r(f(e))]:[3,2];case 1:return[2,i.sent()];case 2:return l.isChangeSet(e)?[4,Promise.all(e.map((function(e){return n(t,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,r(f(e))];case 1:return[2,t.sent()]}}))}))})))]:[3,4];case 3:return[2,i.sent()];case 4:throw Error("value should be of type OData contract or Changeset")}}))}))})),[4,Promise.all(i)];case 1:return o=u.sent(),[2,p.buildBatchRequest(o,t)]}}))}))}}))];case 1:return c=d.sent(),[3,3];case 2:c=l.buildRequest(s,e),d.label=3;case 3:return[2,y(s,r,c,t)]}var m}))}))}}}function y(e,t,r,i){return n(this,void 0,void 0,(function(){var n,u,l,c;return a(this,(function(a){switch(a.label){case 0:return null==i||i.info(h()+" Add Headers to Serialized Request"),s.IsNullOrUndefined(r.additionalHeaders)&&(r.additionalHeaders={}),[4,m(e,t,r,i)];case 1:return a.sent(),r&&r.additionalHeaders&&!r.additionalHeaders.hasOwnProperty(d.HEADER.CONTENT_TYPE)&&(r.additionalHeaders[d.HEADER.CONTENT_TYPE]=d.HEADER_VALUES.APPLICATION_JSON),t.DataLayerConfiguration.useConsistencyStrong&&(r.additionalHeaders[d.HEADER.CONSISTENCY]=d.HEADER_VALUES.STRONG),r&&r.additionalHeaders&&!r.additionalHeaders.hasOwnProperty(d.HEADER.CLIENT_REQUEST_ID)&&(r.additionalHeaders[d.HEADER.CLIENT_REQUEST_ID]=o.Guid.newGuid().guid),(c={})[d.HEADER.SESSION_ID]=t.EventManager.getCurrentSessionId(),c[d.HEADER.ACTIVITY_ID]=t.EventManager.getActivityId(),n=c,Object.assign(r.additionalHeaders,n),s.IsNullOrUndefined(r.urlParameters)||(u=r.endpoint||d.WEB_API_URL_FRAGMENT,l=t.DataLayerConfiguration.baseUri.replace(/\/$/,""),r.urlParameters=""+l+u+r.urlParameters,r.urlParameters=r.urlParameters.replace(/\t|\r|\n/g,"")),[2,r]}}))}))}function m(e,t,r,i){var o;return n(this,void 0,void 0,(function(){var e,n;return a(this,(function(a){switch(a.label){case 0:return[4,null===(o=t.DataLayerConfiguration.AuthenticationProvider)||void 0===o?void 0:o.getAuthToken()];case 1:return(e=a.sent())&&r&&r.additionalHeaders?(n="Bearer "+e,r.additionalHeaders[d.HEADER.AUTHORIZATION_HEADER]=n):null==i||i.warn(h()+" Authorization token is null or empty "),[2,r]}}))}))}function h(e){return"["+(e||u.PREFIX.ODataBuilder)+"]"}t.fromQueryState=function(e){return{type:"odatabuilder.fromquerystate.async",execute:function(t,r){var s=t.getState;return n(this,void 0,void 0,(function(){var t,n,l,p,f,m;return a(this,(function(a){return(t=r.TraceManager.getTracer(u.MDL_COMPONENT_NAMES.ODataBuilder)).info(h()+" Create a SerializedRequest from Query State."),n=e.viewId&&o.Guid.toString(e.viewId),l=c.getEntitySetName(s(),e.entityLogicalName),p=e.fetchXml?encodeURIComponent(e.fetchXml):"",function(e,t,r){e&&e.additionalHeaders&&(t.viewId&&(e.additionalHeaders[d.HEADER.VIEW_ID_HINT]=o.Guid.toString(t.viewId)),t.pageSize&&(e.additionalHeaders[d.HEADER.PAGESIZE_HINT]=t.pageSize.toFixed()),t.pageNumber&&(e.additionalHeaders[d.HEADER.PAGE_NUMBER_HINT]=t.pageNumber.toFixed()),t.searchString&&(e.additionalHeaders[d.HEADER.SEARCH_HINT]=t.searchString),t.wheres&&t.wheres.length>0&&(e.additionalHeaders[d.HEADER.FILTER_HINT]=t.wheres.toString()),t.sorts&&t.sorts.length>0&&(e.additionalHeaders[d.HEADER.ORDERBY_HINT]=t.sorts.toString()),t.selects&&t.selects.length>0&&(e.additionalHeaders[d.HEADER.SELECT_HINT]=t.selects.toString()),t.linkEntities&&t.linkEntities.length>0&&(e.additionalHeaders[d.HEADER.LINK_HINT]=t.linkEntities.toString()))}(f={urlParameters:l+"?fetchXml="+p,additionalHeaders:(m={},m[d.HEADER.PREFER]=d.HEADER_VALUES.ANNOTATIONS,m[d.HEADER.ACCEPT]=d.HEADER_VALUES.APPLICATION_JSON,m[d.HEADER.SOURCE_ID]=null!=n?n:i.UNKNOWN,m),method:"GET"},e),[2,y(s(),r,f,t)]}))}))}}},t.fromODataContract=f,t.addRequestId=function(e,t){null!=e&&null!=t&&(null==e.additionalHeaders||e.additionalHeaders.hasOwnProperty(d.HEADER.CLIENT_REQUEST_ID)||(e.additionalHeaders[d.HEADER.CLIENT_REQUEST_ID]=t))}},AHn5:function(e,t,r){"use strict";var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.RelatedEntityCollection=void 0;var a=r("WPdH"),i=r("JH5K"),o=function(){function e(e){i.throwOnNullOrUndefinedArgument(e,"entityCollections"),this._entityCollections=e,this._relatedEntityQueries=this._entityCollections.map((function(e){return e.get_value().get_query()}))}return e.prototype.get_entityCollections=function(){return this._entityCollections},e.prototype.get_relatedEntityQueries=function(){return this._relatedEntityQueries},e.prototype.getObjectData=function(){var e,t,r={},a=[];try{for(var i=n(this._entityCollections),o=i.next();!o.done;o=i.next()){var s=o.value,u={};u.key=s.get_key().getObjectData(),u.value=s.get_value().getObjectData(),a.push(u)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r.entitycollections=a,r},e.prototype.getByRelationship=function(e){var t,r;try{for(var a=n(this._entityCollections),i=a.next();!i.done;i=a.next()){var o=i.value;if(o.get_key().equals(e))return o.get_value()}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return null},e.prototype.addRelationship=function(e,t){for(var r=0;r<this._entityCollections.length;r++)if(this._entityCollections[r].get_key().equals(e))return void(this._entityCollections[r]=new a.KeyValuePair(e,t));this._entityCollections.push(new a.KeyValuePair(e,t))},e}();t.RelatedEntityCollection=o},AYBo:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntityCollection=void 0;var n=r("VmZv"),a=r("UZ+8"),i=r("PVp+"),o=r("JH5K"),s=function(){function e(e,t,r,n,a,i){var s,u;if(this._moreRecords=!1,this._totalRecordCount=0,this._totalRecordCountLimitExceeded=!1,o.throwOnNullOrUndefinedArgument(e,"entities"),this._moreRecords=t,this._totalRecordCount=r,this._totalRecordCountLimitExceeded=n,this._entities=e,this._query=a,i){var l=null===(u=null===(s=this._entities)||void 0===s?void 0:s[0])||void 0===u?void 0:u.get_clientRetrieveOptions();l&&this.set_clientRetrieveOptions(l)}}return e.prototype.get_entities=function(){return this._entities},e.prototype.get_moreRecords=function(){return this._moreRecords},e.prototype.get_totalRecordCountLimitExceeded=function(){return this._totalRecordCountLimitExceeded},e.prototype.get_totalRecordCount=function(){return this._totalRecordCount},e.prototype.get_count=function(){return this.get_entities().length},e.prototype.get_query=function(){return this._query},e.prototype.set_query=function(e){this._query=e},e.prototype.get_key=function(){return!a.IsNullOrUndefined(this._query)&&this._query.get_key?this._query.get_key():""},e.prototype.get_clientRetrieveOptions=function(){return this._clientRetrieveOptions},e.prototype.set_clientRetrieveOptions=function(e){if(this._clientRetrieveOptions=e,!a.IsNullOrUndefined(this._clientRetrieveOptions))for(var t=0;t<this._entities.length;t++)a.IsNullOrUndefined(this._entities[t].get_clientRetrieveOptions())&&this._entities[t].set_clientRetrieveOptions(this._clientRetrieveOptions)},e.prototype.get_item=function(e){return this.get_entities()[e]},e.prototype.getObjectData=function(){for(var e={},t=new Array(this.get_entities().length),r=0;r<this.get_entities().length;r++)t[r]=this.get_entities()[r].getObjectData();return e.entities=t,e.morerecords=this._moreRecords,e.totalrecordcount=this._totalRecordCount,e.totalRecordCountLimitExceeded=this._totalRecordCountLimitExceeded,a.IsNullOrUndefined(this._clientRetrieveOptions)||(e.clientretrieveoptions=this._clientRetrieveOptions.getObjectData()),e},e.prototype.add=function(e){this._entities.push(e)},e.createFromObjectData=function(t){for(var r=new Array(0),a=t.entities,o=0;o<a.length;o++)r[o]=n.EntityRecord.createFromObjectData(a[o]);return new e(r,t.morerecords,t.totalrecordcount,"totalRecordCountLimitExceeded"in t&&t.totalRecordCountLimitExceeded,null,"clientretrieveoptions"in t?i.ClientRetrieveOptions.createFromObjectData(t.clientretrieveoptions):null)},e}();t.EntityCollection=s,s.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityCollection"},BpGS:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyEntityReference=void 0;var n=r("JH5K"),a=r("UZ+8"),i=r("Sh+4"),o=function(){function e(e,t,r,i){this.TypeCode=0,n.throwOnNullOrUndefinedArgument(e,"logicalName"),n.throwOnNullOrUndefinedArgument(t,"id"),this.LogicalName=e,t&&(this.Id=t),a.IsNullOrUndefined(r)||(this.Name=r),a.IsNullOrUndefined(i)||this.set_rowVersion(i),this.TypeName=e,this.TypeDisplayName=e}return e.prototype.get_key=function(){return this.Id.toString()},e.prototype.get_identifier=function(){return this.Id.toString()},e.prototype.get_modelType=function(){return this.LogicalName},e.prototype.get_rowVersion=function(){return this.__RowVersion},e.prototype.set_rowVersion=function(e){return this.__RowVersion=e,e},e.prototype.getObjectData=function(){return{logicalname:this.LogicalName,id:this.Id.getObjectData(),name:this.Name,rowversion:!a.IsNullOrUndefined(this.get_rowVersion())&&this.get_rowVersion()}},e.prototype.equals=function(t){if(t instanceof e){var r=t;return r.LogicalName===this.LogicalName&&this.Id.equals(r.Id)&&this.Name===r.Name}return!1},e.prototype.toString=function(){return this.LogicalName+this.Id.toString()},e.prototype.getValue=function(t){return this[e._UppercaseFirstCharacter(t)]},e.prototype.setValue=function(t,r){this[e._UppercaseFirstCharacter(t)]=r},e.get_empty=function(){return e._empty||(e._empty=new e("",i.LegacyGuid.get_empty(),""))},e.createFromObjectData=function(t){var r=t.logicalname,n=i.LegacyGuid.createFromObjectData(t.id),a=t.name;return t.rowversion?new e(r,n,a,t.rowversion):new e(r,n,a)},e._UppercaseFirstCharacter=function(e){return e.substr(0,1).toUpperCase()+e.substr(1)},e}();t.LegacyEntityReference=o},Bt9n:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isExpression=t.isEntityNameTerm=t.isValueTerm=t.isAttributeTerm=void 0,t.isAttributeTerm=function(e){return!!e.attributeName},t.isValueTerm=function(e){return!!e.value},t.isEntityNameTerm=function(e){return!!e.entityName},t.isExpression=function(e){return!!e.terms}},CGvr:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.extractIfMatchHeaderForConcurrency=t.buildUpdateRequest=void 0;var n=r("Mx+d"),a=r("vqTk"),i=r("qIJm"),o=r("evga");t.extractIfMatchHeaderForConcurrency=function(e,t){return e===i.ConcurrencyBehavior.IfRowVersionMatches&&t?'W/"'+t+'"':"*"},t.buildUpdateRequest=function(e,t,r,i,s,u,l,c,d,p){var f;void 0===s&&(s=!0);var y=n.getEntitySetName(e,t)+"("+r+")";c&&(y+=c);var m={urlParameters:y,method:"PATCH",additionalHeaders:(f={},f[a.HEADER.MSCRM_SUPPRESS_DUPLICATION_DETECTION]=s.toString(),f[a.HEADER.IF_MATCH]=u||"*",f[a.HEADER.AUTO_DISASSOCIATE]="true",f),body:p?i:JSON.stringify(i)};return d&&Object.assign(m.additionalHeaders,d),l&&m.additionalHeaders&&(m.additionalHeaders[o.RETRIEVE_ROW_VERSION_HEADER]="true"),m}},DCxx:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.urlEncode=t.xmlEncode=t.xmlAttributeEncode=void 0;var n=r("UZ+8");function a(e){return"CRMEntityReferenceOpen"+(1024*(e.charCodeAt(0)-55296)+(1023&e.charCodeAt(1))+65536).toString(16)+"CRMEntityReferenceClose"}function i(e,t){if(n.IsNullOrUndefinedOrEmptyString(e))return e;if("string"!=typeof e&&(e=e),null!=t){t.length>1&&(t=t.charAt(0));var r=o(t),i=new RegExp(t,"g");return e.replace(i,r)}return function(e,t){return(e=(e=t(e=(e=e.replace(new RegExp("([\\uD800-\\uDBFF][\\uDC00-\\uDFFF])","g"),a)).replace(new RegExp("[\\uD800-\\uDFFF]","g"),"�"))).replace(/CRMEntityReferenceOpen/g,"&#x")).replace(/CRMEntityReferenceClose/g,";")}(e,o)}function o(e){return function(e){var t,r="",n="",a=0;if(null===e)return null;if(""===e)return"";for(var i=0;i<e.length;i++)n+=(t=e.charCodeAt(i))>96&&t<123||t>64&&t<91||32===t||t>47&&t<58||46===t||44===t||45===t||95===t?String.fromCharCode(t):"&#"+t+";",500==++a&&(r+=n,n="",a=0);return n.length&&(r+=n),r}(e)}t.xmlAttributeEncode=function(e){return n.IsNullOrUndefined(e)?"":i(e)},t.xmlEncode=function(e){return n.IsNullOrUndefined(e)?"":i(e)},t.urlEncode=function(e){return""}},DVFg:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Condition=void 0;var n=r("UZ+8"),a=function(){function e(e,t,r){this._set_attributeName(e),this.set_operator(t),this.set_value(r)}return e.prototype.get_entityName=function(){return n.IsNullOrUndefined(this._entityName)&&(this._entityName=""),this._entityName},e.prototype.set_entityName=function(e){return this._entityName=e,e},e.prototype.get_attributeName=function(){return this._AttributeName},e.prototype._set_attributeName=function(e){return this._AttributeName=e,e},e.prototype.get_operator=function(){return this._Operator},e.prototype.set_operator=function(e){return this._Operator=e,e},e.prototype.get_value=function(){return this._Value},e.prototype.set_value=function(e){this._Value=e},e.prototype._get_conditionName=function(){return this._ConditionName},e.prototype.set_conditionName=function(e){return this._ConditionName=e,e},e.prototype.clone=function(){var t=new e(this.get_attributeName(),this.get_operator(),this.get_value());return t.set_entityName(this.get_entityName()),t.set_conditionName(this._get_conditionName()),t},e}();t.Condition=a},DepX:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.buildDeleteRequest=void 0;var n=r("Mx+d"),a=r("vqTk");t.buildDeleteRequest=function(e,t,r,i){var o=n.getEntitySetName(e,t.etn)+"("+t.id.guid+")";i&&(o=o+"/"+i);var s={urlParameters:o,method:"DELETE"};return i||(void 0!==s.additionalHeaders&&null!==s.additionalHeaders||(s.additionalHeaders={}),s.additionalHeaders[a.HEADER.IF_MATCH]=r||"*"),s}},EY1R:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},u=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.addAttributes=t.requestAdditionalMetadataForRequest=t.executeOData=t.EXECUTE_ODATA_OPERATION=void 0;var l=r("gmsG"),c=r("FDNG"),d=r("nRuH"),p=r("n8WZ"),f=i(r("bMRw")),y=r("gkFy"),m=r("geC1"),h=r("RHls"),g=r("oMGx"),E=r("RslU");t.EXECUTE_ODATA_OPERATION="executeOData.execute";function b(e,t,r){e.hasOwnProperty(t)?e[t]&&(e[t]=r?Array.from(new Set(e[t].concat(r))):null):e[t]=r}function _(e,t){var r,n;if(g.isChangeSet(t))return t.reduce(_,{});if(g.isODataContract(t)){var a=null;if(!t||"function"!=typeof t.getMetadata||!(a=t.getMetadata()))return e;if("Create"===a.operationName){var i=t,o=y.determineReturnedColumns(i.payload);b(e,i.etn,o)}else if("Update"===a.operationName){var s=t;o=y.determineReturnedColumns(s.payload);b(e,s.etn,o)}else if("Delete"===a.operationName){b(e,t.entityReference.entityType,[])}else{var l=function e(t){var r,n,a,i,o,s,l=null,c=null;if(!t||"function"!=typeof t.getMetadata||!(l=t.getMetadata())||!(c=l.parameterTypes))return[];var d=new Set;try{for(var p=u(Object.keys(t)),y=p.next();!y.done;y=p.next()){var h=y.value,g=t[h];if(null!=g)if(l.boundParameter===h)c[h].structuralProperty===f.ODataStructuralProperty.Collection?d.add(g):d.add(g.entityType);else if(c[h])switch(c[h].structuralProperty){case f.ODataStructuralProperty.Collection:if(g&&g.length)if(g[0].getMetadata){var E=g;try{for(var b=(a=void 0,u(E)),_=b.next();!_.done;_=b.next()){e(_.value).forEach((function(e){return d.add(e)}))}}catch(e){a={error:e}}finally{try{_&&!_.done&&(i=b.return)&&i.call(b)}finally{if(a)throw a.error}}}else if(-1===m.ODataPrimitives.indexOf(c[h].typeName)){var v=g;try{for(var T=(o=void 0,u(v)),O=T.next();!O.done;O=T.next()){var S=O.value;"object"==typeof S&&"entityType"in S&&"id"in S&&d.add(S.entityType)}}catch(e){o={error:e}}finally{try{O&&!O.done&&(s=T.return)&&s.call(T)}finally{if(o)throw o.error}}}break;case f.ODataStructuralProperty.EntityType:"object"==typeof g&&"entityType"in g&&"id"in g&&d.add(g.entityType);break;case f.ODataStructuralProperty.ComplexType:e(g).forEach((function(e){return d.add(e)}))}}}catch(e){r={error:e}}finally{try{y&&!y.done&&(n=p.return)&&n.call(p)}finally{if(r)throw r.error}}return Array.from(d)}(t);try{for(var c=u(l),d=c.next();!d.done;d=c.next()){b(e,d.value,[])}}catch(e){r={error:e}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}}return e}throw new h.ErrorStatus("unsupported request")}t.executeOData=function(e,r){var n=[];return{type:t.EXECUTE_ODATA_OPERATION,execute:function(t){var a=t.dispatch;return o(this,void 0,void 0,(function(){var t;return s(this,(function(i){return t=new d.UCIContext(c.Guid.newGuid().guid),n.push({name:l.EVENT_PARAMETERS.CLIENT_REQUEST_ID,value:t.RequestId()}),r&&r.push({name:l.EVENT_PARAMETERS.CLIENT_REQUEST_ID,value:t.RequestId()}),[2,a(p.execute(e,n))]}))}))},getFailureParameters:function(){return n}}},t.requestAdditionalMetadataForRequest=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{type:"executeOData.requestAdditionalMetadata.async",execute:function(t,r){var n=t.dispatch;t.getState;return o(this,void 0,void 0,(function(){var t;return s(this,(function(r){switch(r.label){case 0:return e?(t=e.reduce(_,{}),[4,n(E.retrieveEntities(t))]):[2];case 1:return r.sent(),[2]}}))}))}}},t.addAttributes=b},FDNG:function(e,t,r){"use strict";r.r(t),r.d(t,"Guid",(function(){return u}));var n=r("gmsG"),a=r("cvWF"),i=r("Sh+4");const o=/^({?)((\d|[a-fA-F]){8}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){12})(}?)$/,s=/^([a-fA-F\d]{8})([a-fA-F\d]{4})([a-fA-F\d]{4})([a-fA-F\d]{4})([a-fA-F\d]{12})$/;class u{constructor(e,t=!1){if(t)this.guid=e;else{const t=u._formatGuidString(e);if(!t)throw new Error(e+" is not a valid Guid value.");this.guid=t}Object.freeze(this)}static externalGuid(e){return e&&e.guid?"{"+e.guid.toUpperCase()+"}":u.EMPTYSTRING}static fromExternalGuid(e,t){return typeof e===a.AttributeType.String&&e.trim().length>0?new u(e.replace(/[\{\}]/gi,"")):(t&&t.warn(n.FILE_PREFIX.Common+" Empty string or invalid object used to form GUID. Returning empty GUID."),u.EMPTY)}static validate(e){return null!=e&&null!==o.exec(e)}static toString(e){return e?e.guid:null}static tryParse(e){return u.tryParseOrNull(e)||u.EMPTY}static tryParseOrNull(e){const t=u._formatGuidString(e);return t?new u(t,!0):null}static parse(e){return new u(e)}static toLegacyGuid(e){return e?i.LegacyGuid.createFromFormattedGuidStringAndSkipParsing(e.guid):null}static fromLegacyGuid(e){if(e){const t=e.toString();if(t)return new u(t,!0)}return null}static equals(e,t){return null==e||null==t?e===t:u.toString(e)===u.toString(t)}static isNullOrEmpty(e){return!e||u.equals(e,u.EMPTY)}static newGuid(){let e="";for(let t=0;t<36;t++)if(14===t)e+="4";else if(8===t||13===t||18===t||23===t)e+="-";else if(19===t){const t=Math.floor(16*Math.random());e+="0123456789abcdef".substr(3&t|8,1)}else e+="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return new u(e,!0)}static _formatGuidString(e){if(!e||"string"!=typeof e)return null;e=e.toLowerCase();const t=o.exec(e);if(t)return t[1].length!==t[8].length?null:t[2];{const t=s.exec(e);if(t)return t.filter((e,t)=>t>0).join("-")}return null}}u.EMPTYGUIDSTRING="00000000-0000-0000-0000-000000000000",u.EMPTY=new u(u.EMPTYGUIDSTRING,!0),u.EMPTYSTRING=""},FHhg:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.EntityReference=void 0;var n=r("FDNG"),a=r("BpGS"),i=function(){function e(e,t,r){this.etn=e,this.id=t||n.Guid.EMPTY,this.name=r,Object.freeze(this)}return e.toString=function(e){return e.etn+":"+n.Guid.toString(e.id)},e.equals=function(t,r){var n=e.equalsIgnoreName(t,r);return t&&r?(t.name&&r.name&&(n=n&&t.name===r.name),n):n},e.equalsIgnoreName=function(e,t){return!e&&!t||!(!e||!t)&&(e.etn===t.etn&&n.Guid.equals(e.id,t.id))},e.toLegacyEntityReference=function(e){return new a.LegacyEntityReference(e.etn,n.Guid.toLegacyGuid(e.id),e.name)},e.fromLegacyEntityReference=function(t){return new e(t.LogicalName,n.Guid.fromLegacyGuid(t.Id),t.Name)},e.fromExternalEntityReference=function(t){return new e(t.entityType,n.Guid.fromExternalGuid(t.id))},e.legacyToExternalEntityReference=function(e){return{id:n.Guid.externalGuid(n.Guid.fromLegacyGuid(e.Id)),entityType:e.LogicalName}},e.toExternalEntityReference=function(e){return{id:n.Guid.externalGuid(e.id),entityType:e.etn}},e.EMPTY=new e(""),e}();t.EntityReference=i},"GSc/":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyQuery=void 0;var n=r("mVtf"),a=r("iWcK"),i=r("iDsU"),o=r("8c4H"),s=r("IUwF"),u=r("lqZx"),l=r("3Cvv"),c=r("UZ+8"),d=r("SJSp"),p=function(){function e(e){this._columnSet=null,this._descriptorSet=null,this._noLock=!1,this._pageNumber=1,this._pageSize=1,this._entityLogicalName=null,this._returnTotalRecordCount=!1,this._status=[],this._pagingCookie="",c.IsNullOrUndefined(e)||this._CreateQuery(e)}return e.prototype.get_ColumnSet=function(){return this._columnSet},e.prototype.set_ColumnSet=function(e){return this._columnSet=e,e},e.prototype.set_ColumnNames=function(e){return this._columnNames=e,e},e.prototype.get_DescriptorSet=function(){return this._descriptorSet},Object.defineProperty(e.prototype,"queryStatus",{get:function(){return this._status},enumerable:!1,configurable:!0}),e.prototype._set_DescriptorSet=function(e){return this._descriptorSet=e,e},e.prototype.get_FetchXml=function(){var t,r,a,i=this.rawFetchXmlDoc;return i&&i.firstChild&&(null===(t=i.firstChild)||void 0===t?void 0:t.nodeName)&&(null===(r=i.firstChild)||void 0===r?void 0:r.nodeName)!==e._FetchXmlNodeName?this.get_rawFetchXml():(d.setFetchXmlParameters(this.rawFetchXmlDoc,this.get_PageSize(),this.get_PageNumber(),!0,this._get_NoLock()),i&&!c.IsNullOrUndefinedOrEmptyString(this.get_PagingCookie())&&i.firstChild.attributes.setNamedItem(u.XmlNode.createAttribute(i,e._PagingCookieXmlAttributeName,this.get_PagingCookie())),null===(a=n.create(i))||void 0===a?void 0:a.get_outerXml())},e.prototype.set_FetchXml=function(t){if(c.IsNullOrUndefinedOrEmptyString(t)||"<"!==t.substr(0,1))this.set_ColumnSet(new i.LegacyColumnSet(new Array(0)));else{var r=n.parseXmlDocument(t);if(this.rawFetchXmlDoc=r,!c.IsNullOrUndefined(r)){var o=n.create(r),s=null==o?void 0:o.selectSingleNode("/"+e._FetchXmlNodeName);if(s&&!c.IsNullOrUndefined(s)){var u=s.getAttribute(e._PageNumberXmlAttributeName);c.IsNullOrUndefined(u)||this.set_PageNumber(+u),u=s.getAttribute(e._PageSizeXmlAttributeName),c.IsNullOrUndefined(u)||this.set_PageSize(+u),u=s.getAttribute(e._PagingCookieXmlAttributeName),c.IsNullOrUndefined(u)||this.set_PagingCookie(u);var l=null==o?void 0:o.selectSingleNode("/fetch/entity");if(l&&!c.IsNullOrUndefined(l)&&this.set_EntityLogicalName(l.getAttribute("name")),o&&!c.IsNullOrUndefined(o.selectSingleNode("/fetch/entity/all-attributes")))this.set_ColumnSet(a.AllColumns.get_instance());else{var d=[],p=null==o?void 0:o.selectNodes("/fetch/entity/attribute");if(p)for(var f=0;f<p.get_count();f++){var y=p.get_item(f);if(y&&y.getAttribute("name")){var m=y.getAttribute("name");d.push(m)}}this.set_ColumnSet(new i.LegacyColumnSet(d))}var h=!!r&&r.firstChild.attributes.getNamedItem(e._ReturnTotalRecordCountAttributeName);this._returnTotalRecordCount=c.IsNullOrUndefined(h)?e._DefaultReturnTotalRecordCountValue:"true"===h}}}return t},e.prototype.get_PageNumber=function(){return this._pageNumber},e.prototype.set_PageNumber=function(e){if(e<1)throw Error("PageNumber cannot be less than 1");return this._pageNumber=e,e},e.prototype._get_NoLock=function(){return this._noLock},e.prototype.set_NoLock=function(e){return this._noLock=e,e},e.prototype.get_PageSize=function(){return this._pageSize},e.prototype.set_PageSize=function(e){return this._pageSize=e,e},e.prototype.get_PagingCookie=function(){return this._pagingCookie},e.prototype.set_PagingCookie=function(e){return c.IsNullOrUndefinedOrEmptyString(e)&&(this._pagingCookie=""),this._pagingCookie=e,e},e.prototype.get_EntityLogicalName=function(){return this._entityLogicalName},e.prototype.set_EntityLogicalName=function(e){return this._entityLogicalName=e,e},e.prototype.get_returnTotalRecordCount=function(){return this._returnTotalRecordCount},e.prototype.get_id=function(){return this.get_rawFetchXml()},e.prototype.get_RawSql=function(){var e;return null===(e=this.get_DescriptorSet())||void 0===e?void 0:e.tryGetDescriptor(o.DescriptorFormat.Sql)},e.prototype.set_RawSql=function(e){var t;return c.IsNullOrUndefined(this._descriptorSet)||null===(t=this._descriptorSet)||void 0===t||t.updateDescriptorSet(o.DescriptorFormat.Sql,e),e},e.prototype.get_rawFetchXml=function(){var e;return this.rawFetchXmlDoc?null===(e=n.create(this.rawFetchXmlDoc))||void 0===e?void 0:e.get_outerXml():""},e.prototype.get_FetchXmlForAliasedValues=function(){return this._fetchXmlForAliasedValues},e.prototype.set_FetchXmlForAliasedValues=function(e){this._fetchXmlForAliasedValues=e},e.prototype._CreateQuery=function(e){if(e instanceof l.DescriptorSet)for(var t in this._descriptorSet=new l.DescriptorSet,e.get_descriptors()){var r=e.get_descriptors()[t];this._descriptorSet.get_descriptors()[o.DescriptorFormat[r.Format]]=new s.DescriptorData(r.Format,r.Data),r.Format===o.DescriptorFormat.FetchXml&&this.set_FetchXml(r.Data)}else this.set_FetchXml(e.toString()),this._set_DescriptorSet(l.DescriptorSet.createFromFetchXml(e.toString()))},e.prototype.toString=function(){return"Query: "+this.get_rawFetchXml()},e.prototype.GetColumnNamesFromFetch=function(){return c.IsNullOrUndefined(this._columnNames)?d.getColumnNamesFromFetch(this.rawFetchXmlDoc):this._columnNames},e.prototype.generateNorSyncAttributeName=function(e,t,r){return t},e.get_empty=function(){return new e("")},e._PageNumberXmlAttributeName="page",e._PageSizeXmlAttributeName="count",e._PagingCookieXmlAttributeName="paging-cookie",e._ReturnTotalRecordCountAttributeName="returntotalrecordcount",e._FetchXmlNodeName="fetch",e._DefaultReturnTotalRecordCountValue=!0,e}();t.LegacyQuery=p},Gvsb:function(e,t,r){"use strict";var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.Expression=void 0;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a=r("Bt9n"),i=r("SV4j"),o=r("Z7iH"),s=r("FDNG"),u=function(){function e(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._hint="",this._operator=e,this._terms=t}return Object.defineProperty(e.prototype,"operator",{get:function(){return this._operator},set:function(e){this._operator=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hint",{get:function(){return this._hint},set:function(e){this._hint=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"terms",{get:function(){return this._terms},set:function(e){this._terms=e},enumerable:!1,configurable:!0}),e._isSimpleCondition=function(e){return e.terms.every((function(e){return!a.isExpression(e)}))},e._toLegacyConditionParameters=function(e){var t,r,i,o="",s="";try{for(var u=n(e.terms),l=u.next();!l.done;l=u.next()){var c=l.value;a.isAttributeTerm(c)?o=c.attributeName:a.isValueTerm(c)?i=c.value:a.isEntityNameTerm(c)&&(s=c.entityName)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(t)throw t.error}}return{attributeName:o,operator:e.operator,value:i,entityName:s}},e.toLegacyFilterExpression=function(t,r){var a,u,l="or"===t.operator?i.LogicalOperator.Or:i.LogicalOperator.And,c=s.Guid.newGuid().guid,d=new o.FilterExpression(l,c,null,r?null:t.hint);if(e._isSimpleCondition(t)){var p=e._toLegacyConditionParameters(t),f=p.attributeName,y=p.operator,m=p.value,h=p.entityName;d.addCondition(f,y,m,h)}else{var g=r;try{for(var E=n(t.terms),b=E.next();!b.done;b=E.next()){var _=b.value;d.addFilterExpression(e.toLegacyFilterExpression(_,g)),g=g||!!_.hint}}catch(e){a={error:e}}finally{try{b&&!b.done&&(u=E.return)&&u.call(E)}finally{if(a)throw a.error}}}return d},e}();t.Expression=u},HPMC:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
class n{constructor(e,t,r,n){this.message=e,this.code=t,this.stack=r,this.name=n}}},ILcb:function(e,t,r){"use strict";var n=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.buildContextFilter=t.ModernQueryBuilder=void 0;var i=r("SJSp"),o=r("FDNG"),s=r("KIVe"),u=r("SXiu"),l=r("Gvsb"),c=function(){function e(e){this._query=e?Object.assign({},e):{},this._query.selects=this._query.selects||[],this._selectsInKey=this._query.selects?this._query.selects.map((function(e){return!0})):[],this._query.linkEntities=this._query.linkEntities||[],this._query.sorts=this._query.sorts||[],this._query.wheres=this._query.wheres||[],this._query.contextFiltersAndIds=this._query.contextFiltersAndIds||[],this._query.searchString=this._query.searchString||"",this._query.isQuickFindSearch=this._query.isQuickFindSearch||!1,this._childCountAttributes=[],this._isFetchXmlParsed=!1,this._query.isFetchXmlModified=this._query.isFetchXmlModified||!1,this._resetSort=!1}return Object.defineProperty(e.prototype,"fetchDocument",{get:function(){return this._isFetchXmlParsed||this._parseFetchXmlFromString(this._query.fetchXml),this._fetchDocument},enumerable:!1,configurable:!0}),e.prototype._parseFetchXmlFromString=function(e){e&&(this._fetchDocument=i.parseFetchXmlFromString(e),this._isFetchXmlParsed=!0)},e.fromView=function(t,r){var n=new e;return n._query.viewId=t,n._query.searchString=r||"",n},e.fromXml=function(t,r,n){var a=new e;return a._query.fetchXml=t,a._query.viewId=r,a._query.searchString=n,a},e.fromState=function(t){return new e(t)},e.prototype.select=function(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];for(var i=[],o=0;o<r.length;o++)this._query.selects&&-1===this._query.selects.indexOf(r[o])&&i.push(r[o]);return this._query.selects&&(e=this._query.selects).push.apply(e,a(i)),(t=this._selectsInKey).push.apply(t,a(i.map((function(e){return!0})))),this},e.prototype.selectInternal=function(e,t){return void 0===t&&(t=!0),this._query.selects&&-1===this._query.selects.indexOf(e)&&(this._query.selects.push(e),this._selectsInKey.push(t)),this},e.prototype.addLinkedEntity=function(e,t){var r=i.buildLinkedEntityNode(e,t);return this._query.linkEntities&&this._query.linkEntities.push(r),this},e.prototype.orderBy=function(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=!0),this._query.sorts&&this._query.sorts.push(e+(t?" desc":" asc")),this._resetSort=r,this},e.prototype.addChildCountAttribute=function(e){return this._childCountAttributes.push(e),this},e.prototype.applyContextFilter=function(e,t,r,n){void 0===n&&(n=s.RelationshipRoleOrdinal.Referencing);var a=d(e,this._query.entityLogicalName||i.getEntityFromFetch(this.fetchDocument),n,r),u=o.Guid.toString(t);return this._query.contextFiltersAndIds&&this._query.contextFiltersAndIds.push(u+"="+a),this},e.prototype.toFetchXml=function(e){if(function(e){e&&!e.pageNumber&&(e.pageNumber=1);e&&!e.pageSize&&(e.pageSize=25);e&&(e.useModernQueryBuilder=!0)}(this._query),!this.fetchDocument){if(!e)throw u.createUciError("ModernQueryBuilder: getState function not provided");if(!this._query.viewId)throw Error("ModernQueryBuilder: view id not provided to retrieve fetch xml for the view")}if(!this.fetchDocument)throw Error("ModernQueryBuilder: fetch xml not provided");return this._query.isFetchXmlModified||this._applyModificationsToFetchXml(),i.setFetchXmlParameters(this.fetchDocument,this._query.pageSize,this._query.pageNumber,true,false),(new XMLSerializer).serializeToString(this.fetchDocument)},e.prototype.getQueryState=function(e){return this._query.fetchXml=this.toFetchXml(e),this._query.entityLogicalName||(this._query.entityLogicalName=i.getEntityFromFetch(this.fetchDocument)),this._query.key=this.getKey(),this._query},Object.defineProperty(e.prototype,"pageSize",{get:function(){return this._query.pageSize},set:function(e){this._query.pageSize=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageNumber",{get:function(){return this._query.pageNumber},set:function(e){this._query.pageNumber=e},enumerable:!1,configurable:!0}),e.prototype.getKey=function(){var e=this;return this._query.selects?this._getBaseKey()+": "+this._query.selects.filter((function(t,r){return e._selectsInKey[r]}))+": "+this._query.wheres+": "+this._query.sorts+": "+this._query.contextFiltersAndIds+": "+this._query.linkEntities+": "+this._query.isQuickFindSearch+": "+this._query.searchString+": "+this._query.pageSize:null},e.prototype.getPublicKey=function(){var e=this;return this._query.selects?this._getBaseKey()+": "+this._query.selects.filter((function(t,r){return e._selectsInKey[r]}))+": "+this._query.sorts+": "+this._query.contextFiltersAndIds+": "+this._query.linkEntities+": "+this._query.pageSize:null},e.prototype._getBaseKey=function(){return this._query.viewId?this._query.entityLogicalName+"-"+o.Guid.toString(this._query.viewId):o.Guid.toString(this._query.viewId)},e.prototype._applyModificationsToFetchXml=function(){var e=this;this._query.selects&&this._query.selects.length>0&&(i.isFetchAll(this.fetchDocument)||i.addColumns(this.fetchDocument,this._query.selects)),this._query.linkEntities&&this._query.linkEntities.length>0&&this._query.linkEntities.forEach((function(t){return i.addLinkedEntity(e.fetchDocument,t)})),this._query.wheres&&this._query.wheres.length>0&&this._query.wheres.forEach((function(t){return i.addFilters(e.fetchDocument,t)})),this._resetSort&&i.removeOrderElements(this.fetchDocument),this._query.sorts&&this._query.sorts.length>0&&this._query.sorts.forEach((function(t){var r=t.split(" ");i.addSort(e.fetchDocument,r[0],"desc"===r[1])})),this._childCountAttributes.length>0&&this._childCountAttributes.forEach((function(t){return i.addChildCountAttribute(e.fetchDocument,t)})),this._query.contextFiltersAndIds&&this._query.contextFiltersAndIds.length>0&&this._query.contextFiltersAndIds.forEach((function(t){var r=t.indexOf("="),n=t.substring(0,r),a=t.substring(r+1,t.length);i.addContextFilter(e.fetchDocument,a,n)})),this._query.isFetchXmlModified=!0},e.prototype.applyRollupContextFilter=function(){throw new Error("Not implemented")},e.prototype.where=function(e,t,r){var n=l.Expression.toLegacyFilterExpression(e,r).toFetchXml();return this._query&&(t?this._query.wheres=[n]:this._query.wheres&&this._query.wheres.push(n)),this},e.prototype.setDefaultPageSize=function(){throw new Error("Not implemented")},e.prototype.getFirstError=function(){throw new Error("Not implemented")},e.prototype.addExistingContextFilterToKey=function(){throw new Error("Not implemented")},e.prototype.validateLinkedEntity=function(){throw new Error("Not implemented")},Object.defineProperty(e.prototype,"fetchXml",{get:function(){throw new Error("Not implemented")},enumerable:!1,configurable:!0}),e}();function d(e,t,r,n){return null}t.ModernQueryBuilder=c,t.buildContextFilter=d},IUwF:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.DescriptorData=void 0;var n=function(e,t){this.Format=0,this.Format=e,this.Data=t};t.DescriptorData=n},IvJe:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.FieldValueRetrievalBehavior=t.getFormattedFieldValue=t.getRelatedEntityRecordByNavigationProperty=t.getRelatedEntityRecordsByNavigationProperty=t.isEmptyField=t.getRelatedEntityLogicalNames=t.getAttributeNamesWithNoMetadata=t.getListPageSize=t.getLegacyValueForField=t.getListTotalRecordsCount=t.getPagingCookie=t.getListInitializedState=t.getList=t.getListPageRecords=t.getFieldValue=t.getRecordInitState=t.getCurrentBusinessProcessFlowInstanceId=t.getCurrentBusinessProcessFlowId=t.createRecordSelector=t.getListPageRecordIds=t.getEntityRecordById=t.getEntityRecords=t.getData=void 0;var s,u=r("cvWF"),l=i(r("+QHC")),c=r("FDNG"),d=r("RXHd"),p=r("FHhg"),f=r("pdzI"),y=r("UZ+8"),m=r("AYBo"),h=r("VmZv"),g=r("WSZO"),E=r("AHn5"),b=r("NV9l"),_=r("0hOr"),v=r("Mx+d");function T(e){return e?e.data:null}function O(e,t){var r=T(e);return r&&r.entities&&r.entities.hasOwnProperty(t)?r.entities[t]:null}function S(e,t,r){var n=O(e,t);return n?n[r]:null}function N(e,t,r){var n=S(e,t.etn,c.Guid.toString(t.id));if(n&&n.fields&&n.fields.hasOwnProperty(r)){var a=n.fields[r];if(a)return a.list}return null}function R(e){return function(t){var r=O(t,e.etn);if(r){var n=c.Guid.toString(e.id);if(r.hasOwnProperty(n))return r[n]}return null}}function M(e,t){var r=T(e);return r&&r.lists&&r.lists.hasOwnProperty(t)?r.lists[t]:null}function A(e,t,r,n){var a=M(e,t);if(a){if(n)return a.records;if(a.pages&&r&&r>0){var i=a.pages[r];if(i&&a.records)return a.records.slice(i.startIndex,i.startIndex+a.pageSize)}}return null}function C(e,t,r,n){var a,i,s,u={initialized:t.initialized,identifier:r,fields:{}};if(t&&u&&u.fields)if(n&&n.length)try{for(var l=o(n),c=l.next();!c.done;c=l.next()){var d=c.value;u.fields[d]=null===(s=t.fields)||void 0===s?void 0:s[d]}}catch(e){a={error:e}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(a)throw a.error}}else u.fields=t.fields;return u}function P(e,t){return void 0===t&&(t=s.LatestEntered),t===s.LastValid?e.value:e.validationResult.userInput||e.value}function I(e,t,r,n){var a,i;switch(void 0===n&&(n=s.LatestEntered),r){case u.AttributeType.PartyList:var l=[],f=t;try{for(var y=o(f.list),g=y.next();!g.done;g=y.next()){var v=g.value,T={},O={},S={},N={};for(var R in v.fields){var M=v.fields[R],A=w(e,"activityparty",R,M);if(A){T[R]=A;var C=_.getAttributeDescriptor(e,"activityparty",R);if(C&&(O[R]=C.Type,b.isPlainValue(M))){var I=M;S[R]=I.formatted||null,N[R]=I.formatted||null}}}var D=new h.EntityRecord(p.EntityReference.toLegacyEntityReference(v.identifier),T,O,S,N,new E.RelatedEntityCollection([]));l.push(D)}}catch(e){a={error:e}}finally{try{g&&!g.done&&(i=y.return)&&i.call(y)}finally{if(a)throw a.error}}return new m.EntityCollection(l,!1,l.length,!1,null,null);case u.AttributeType.Date:case u.AttributeType.DateTime:var F=P(t,n),L=Date.parse(F);return isNaN(L)?F:new Date(L);case u.AttributeType.PickList:case u.AttributeType.Boolean:case u.AttributeType.State:case u.AttributeType.Status:var k=t,x=k?k.label:null,j=k?parseInt(k.valueString,10):null;return j&&isNaN(j)&&(j=null),new d.OptionMetadata(x,j,-1,-1,[],null,null);case u.AttributeType.Customer:case u.AttributeType.Lookup:case u.AttributeType.Owner:var U=t;return U&&U.reference?p.EntityReference.toLegacyEntityReference(U.reference):null;case u.AttributeType.UniqueIdentifier:var V=t;return c.Guid.toLegacyGuid(V.id);case u.AttributeType.MultiSelectPickList:var q=P(t,n);return-1===q||null===q?null:Array.isArray(q)?q:q.split(",").map((function(e){return parseInt(e,10)}));case u.AttributeType.Decimal:case u.AttributeType.Double:case u.AttributeType.Integer:case u.AttributeType.String:case u.AttributeType.BigInt:case u.AttributeType.Unknown:case u.AttributeType.Memo:case u.AttributeType.Money:case u.AttributeType.CalendarRules:case u.AttributeType.Virtual:default:return P(t,n)}}function w(e,t,r,n,a){if(void 0===a&&(a=s.LatestEntered),b.isAliasedValue(n)){var i=new g.LegacyAliasedValue(n.entityLogicalName,n.attributeLogicalName,u.AttributeType.AliasedValue);return n.innerType===u.AttributeType.Integer?i.set_value(I(e,n.innerValue,u.AttributeType.Integer,a)):i.set_value(w(e,n.entityLogicalName,n.attributeLogicalName,n.innerValue)),i}var o=_.getAttributeDescriptor(e,t,r);if(!o||!o.Type)return null;var l=o.Type;return n?I(e,n,l,a):l===u.AttributeType.PartyList?new m.EntityCollection([],!1,0,!1):null}t.getData=T,t.getEntityRecords=O,t.getEntityRecordById=S,t.getRelatedEntityRecordsByNavigationProperty=N,t.getRelatedEntityRecordByNavigationProperty=function(e,t,r,n){var a,i,s=N(e,t,r);if(s){var u=v.getRelationshipTypeByNavigationProperty(e,t.etn,r);if(u===l.RelationshipType.OneToManyRelationship)try{for(var c=o(s),d=c.next();!d.done;d=c.next()){var p=d.value;if(p&&p.fields){var f=p.fields.hasOwnProperty("regardingfieldname")?p.fields.regardingfieldname:null;if(n===b.getFormattedValueFromField(f))return p}}}catch(e){a={error:e}}finally{try{d&&!d.done&&(i=c.return)&&i.call(c)}finally{if(a)throw a.error}}else if(u===l.RelationshipType.ManyToOneRelationship)return s[0]}return null},t.createRecordSelector=R,t.getRecordInitState=function(e,t){var r;if(R(t)){var n=null===(r=R(t))||void 0===r?void 0:r(e,t.etn);return n&&n.hasOwnProperty("initialized")?n.initialized:null}return null},t.getFieldValue=function(e,t,r){var n;if(t&&R(t)){var a=null===(n=R(t))||void 0===n?void 0:n(e,t.etn);if(a&&a.fields){if(a.fields.hasOwnProperty(r))return a.fields[r];if("productidname"===r&&-1!==["opportunityproduct","quotedetail","salesorderdetail","invoicedetail"].indexOf(t.etn)){var i=a.fields.productid;if(i){var o=i.reference;if(o&&o.hasOwnProperty("name"))return o.name}}}}return null},t.getFormattedFieldValue=function(e,t,r){return{value:e,timestamp:t||new Date,validationResult:r||{isValueValid:!0,errorMessage:null,errorId:null,userInput:""}}},t.getCurrentBusinessProcessFlowId=function(e,t){var r;if(R(t)){var n=null===(r=R(t))||void 0===r?void 0:r(e,t.etn);if(n&&n.businessProcessFlowId)return n.businessProcessFlowId}return null},t.getCurrentBusinessProcessFlowInstanceId=function(e,t){var r;if(R(t)){var n=null===(r=R(t))||void 0===r?void 0:r(e,t.etn);if(n&&n.businessProcessFlowInstanceId)return n.businessProcessFlowInstanceId}return null},t.getList=M,t.getListInitializedState=function(e,t){var r=M(e,t);return r?r.initialized:f.InitState.Uninitialized},t.getListPageRecordIds=A,t.getListPageRecords=function(e,t,r,n,a){var i,s,u=A(e,t,r,a),l=[];if(!u)return null;try{for(var c=o(u),d=c.next();!d.done;d=c.next()){var p=d.value,f=R(p);if(f){var y=f(e,p.etn);if(y){var m=C(0,y,p,n);l.push(m)}}}}catch(e){i={error:e}}finally{try{d&&!d.done&&(s=c.return)&&s.call(c)}finally{if(i)throw i.error}}return l},t.getListTotalRecordsCount=function(e,t){var r=M(e,t);return r?r.totalRecordCount:null},t.getPagingCookie=function(e,t,r){var n=M(e,t);return n&&n.pages&&n.pages[r]&&n.pages[r].pagingCookie?n.pages[r].pagingCookie:null},function(e){e[e.LatestEntered=0]="LatestEntered",e[e.LastValid=1]="LastValid"}(s||(s={})),t.FieldValueRetrievalBehavior=s,t.isEmptyField=function e(t,r,n,a,i){if(void 0===i&&(i=s.LatestEntered),!t)return!0;if(b.isAliasedValue(t))return e(t.innerValue,r,n,a,i);var o=_.getAttributeDescriptor(r,n,a);if(!o||!o.Type)return function e(t){return b.isPicklistValue(t)?!t.valueString:b.isGuidValue(t)?c.Guid.isNullOrEmpty(t.id):b.isReferenceValue(t)?!t.reference:b.isPlainValue(t)?!t.value:b.isAliasedValue(t)?e(t.innerValue):!!b.isPartylistValue(t)&&!t.list}(t);var l=!1;switch(o.Type){case u.AttributeType.PartyList:var d=t;d&&d.list&&d.list.length>0&&(l=!0);break;case u.AttributeType.Boolean:var p=t;!p||"1"!==p.valueString&&"0"!==p.valueString||(l=!0);break;case u.AttributeType.PickList:case u.AttributeType.State:case u.AttributeType.Status:var f=t;f&&"-1"!==f.valueString&&!y.IsNullOrUndefinedOrEmptyString(f.valueString)&&(l=!0);break;case u.AttributeType.MultiSelectPickList:var m=P(t,i);-1===m||y.IsNullOrUndefinedOrEmptyString(m)||(l=!0);break;case u.AttributeType.Customer:case u.AttributeType.Lookup:case u.AttributeType.Owner:var h=t;h&&!y.IsNullOrUndefinedOrEmptyString(h.reference)&&(l=!0);break;case u.AttributeType.UniqueIdentifier:var g=t;g&&!y.IsNullOrUndefinedOrEmptyString(g.id)&&(l=!0);break;case u.AttributeType.Date:case u.AttributeType.DateTime:case u.AttributeType.Decimal:case u.AttributeType.Double:case u.AttributeType.Integer:case u.AttributeType.String:case u.AttributeType.BigInt:case u.AttributeType.Unknown:case u.AttributeType.Memo:case u.AttributeType.Money:case u.AttributeType.CalendarRules:case u.AttributeType.Virtual:default:var E=P(t,i);y.IsNullOrUndefinedOrEmptyString(E)||(l=!0)}return!l},t.getLegacyValueForField=w,t.getListPageSize=function(e,t){var r=M(e,t);return r&&r.pageSize?r.pageSize:null},t.getAttributeNamesWithNoMetadata=function(e,t){var r=t.get_identifier(),n=_.getAttributesForEntity(e,r.LogicalName);if(n){var a=Object.keys(n);return t.get_fieldNames().filter((function(e){return a&&-1===a.indexOf(e)}))}return t.get_fieldNames()},t.getRelatedEntityLogicalNames=function(e,t){var r,n,a,i,s=t.get_identifier(),l=t.get_fieldNames(),c=_.getAttributesForEntity(e,s.LogicalName),d=new Set;try{for(var p=o(l),f=p.next();!f.done;f=p.next()){var y=f.value,m=c[y];if(!m)throw new Error("The metadata for "+y+" attribute is missing in the state tree.");if(m.Type===u.AttributeType.PartyList){var h=t.getValue(y).get_entities();try{for(var g=(a=void 0,o(h)),E=g.next();!E.done;E=g.next()){var b=E.value;d.add(b.get_identifier().LogicalName)}}catch(e){a={error:e}}finally{try{E&&!E.done&&(i=g.return)&&i.call(g)}finally{if(a)throw a.error}}}if(m.Type===u.AttributeType.Lookup||m.Type===u.AttributeType.Customer||m.Type===u.AttributeType.Owner){var v=t.getValue(y);v&&v.LogicalName&&d.add(v.LogicalName)}}}catch(e){r={error:e}}finally{try{f&&!f.done&&(n=p.return)&&n.call(p)}finally{if(r)throw r.error}}return Array.from(d)}},JH5K:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throwOnAssert=t.throwOnOutOfRange=t.throwOnNotEquals=t.throwOnNullOrEmptyArgument=t.throwOnUndefinedArgument=t.throwOnNullOrUndefinedArgument=t.throwOnNullArgument=void 0;var n=r("UZ+8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */t.throwOnNullArgument=function(e,t){if(null===e)throw Error(t+"Argument can't be null")},t.throwOnNullOrUndefinedArgument=function(e,t){if(n.IsNullOrUndefined(e))throw Error(t+"Argument can't be null or undefined")},t.throwOnUndefinedArgument=function(e,t){if(void 0===e)throw Error(t+"Argument can't be undefined")},t.throwOnNullOrEmptyArgument=function(e,t){if(!e||!e.length)throw Error(t+"Argument can't be null or empty")},t.throwOnNotEquals=function(e,t,r){if(e!==t)throw Error(r+"Argument is "+e+"but should be equal to "+t)},t.throwOnOutOfRange=function(e,t,r,n){if(e<t||e>r)throw Error(n)},t.throwOnAssert=function(e,t){if(!e)throw Error("ExceptionHelpers.ThrowOnAssert("+t+")")}},KIVe:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n;Object.defineProperty(t,"__esModule",{value:!0}),t.RelationshipRoleOrdinal=void 0,function(e){e[e.Referencing=1]="Referencing",e[e.AssociationEntity=2]="AssociationEntity"}(n||(n={})),t.RelationshipRoleOrdinal=n},"Kz3/":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.removeReference=t.addReference=void 0,t.addReference=function(e,t){if(e||(e=[]),-1===e.indexOf(t))return e.push(t),e},t.removeReference=function(e,t){if(e){var r=e.indexOf(t);return-1!==r?1===e.length?[]:(e.splice(r,1),e):void 0}}},LEFC:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.MetadataQuery=void 0;var o=i(r("bMRw")),s=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{MetadataType:{typeName:"Edm.String",structuralProperty:o.ODataStructuralProperty.PrimitiveType},MetadataSubtype:{typeName:"Edm.String",structuralProperty:o.ODataStructuralProperty.PrimitiveType},EntityLogicalName:{typeName:"Edm.String",structuralProperty:o.ODataStructuralProperty.PrimitiveType},MetadataId:{typeName:"Edm.Guid",structuralProperty:o.ODataStructuralProperty.PrimitiveType},MetadataName:{typeName:"Edm.String",structuralProperty:o.ODataStructuralProperty.PrimitiveType},MetadataNames:{typeName:"Edm.String",structuralProperty:o.ODataStructuralProperty.Collection},GetDefault:{typeName:"Edm.Boolean",structuralProperty:o.ODataStructuralProperty.PrimitiveType},DependencyDepth:{typeName:"Microsoft.Dynamics.CRM.DependencyDepth",structuralProperty:o.ODataStructuralProperty.EnumerationType,enumProperties:[,{name:"Unknown",value:0},{name:"OnDemandWithContext",value:1},{name:"OnDemandWithoutContext",value:2},{name:"OnDemandContextOnly",value:3},{name:"Offline",value:4},{name:"Mobile",value:5},{name:"UserContext",value:6}]},ChangedAfter:{typeName:"Edm.String",structuralProperty:o.ODataStructuralProperty.PrimitiveType},Exclude:{typeName:"Edm.Guid",structuralProperty:o.ODataStructuralProperty.Collection},AppId:{typeName:"Edm.Guid",structuralProperty:o.ODataStructuralProperty.PrimitiveType}}}},e}();t.MetadataQuery=s},MMlZ:function(e,t,r){"use strict";r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return l})),r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return d})),r.d(t,"c",(function(){return m}));var n=r("17Cn"),a=r("OhA8"),i=r("gmsG"),o=r("cvWF"),s=r("xiVN");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
function u(e){return!!(e&&e.additionalHeaders&&e.additionalHeaders.Prefer&&-1!==e.additionalHeaders.Prefer.indexOf(n.HEADER_VALUES.ANNOTATIONS))}function l(e){return!!(e&&e.additionalHeaders&&e.additionalHeaders.Prefer&&-1!==e.additionalHeaders.Prefer.indexOf(n.HEADER_VALUES.PREFER_REPRESENTATION))}function c(e,t,r,n){return{status:e,ok:(a=e,a>=200&&a<=299),statusText:"",headers:r,url:t,clone(){return Object.assign({},this)},json:()=>Promise.resolve(n?JSON.parse(n):null),text:()=>Promise.resolve(n||"")};var a}function d(e,t,r,i){const o={},s={};s[n.STRING_CONSTANTS.ErrorCode]=r.code?r.code:n.ErrorCode.DataSourceOfflineErrorCode,s[n.STRING_CONSTANTS.Message]=r.message,s[n.STRING_CONSTANTS.StackTrace]=r.stack;const u={};u[n.STRING_CONSTANTS.ErrorCode]=r.code,u[n.STRING_CONSTANTS.Message]=r.message,u[n.STRING_CONSTANTS.StackTrace]=r.stack,s[n.STRING_CONSTANTS.InnerError]=u,o.error=s;const l=JSON.stringify(o);return Object(a.m)(i)&&(i=new Headers),c(e,t,i,l)}function p(e){return e+"@OData.Community.Display.V1.FormattedValue"}function f(e){if(-1!==e.search("!")){const t=e.split("!"),r=t[0],n=t[1],a=`_${r}_value`;return"id"===n?a:"name"===n?p(a):"logicalname"===n?function(e){return e+"@Microsoft.Dynamics.CRM.lookuplogicalname"}(a):e}return e}function y(e,t){return e.find(e=>e.Value===t)}async function m(e,t,r,n,u=[]){const l=e.TraceManager.getTracer(i.COMPONENT_NAMES.ResponseHandler),c=await Object(s.a)(e,[],r),d=await Object(s.b)(e,r,[]),m={};for(const i in t)if(i){const s=t[i];if(!Object(a.m)(s))if(-1!==i.search("!")){m[f(i)]=s}else{const f=c[i],h=p(i);switch(f){case o.AttributeType.Decimal:case o.AttributeType.Integer:case o.AttributeType.BigInt:case o.AttributeType.DateTime:case o.AttributeType.Double:case o.AttributeType.Money:m[i]=s;let c=null;f===o.AttributeType.Money&&t["transactioncurrencyid!id"]&&(c=t["transactioncurrencyid!id"]),n&&(e.Formatter?m[h]=e.Formatter.getFormattedvalue(r,i,f,s,c):(l.error("Formatter is not available when returnAnnotationsFormat = true",u),m[h]=s));break;case o.AttributeType.MultiSelectPickList:if(m[i]=s,n&&!Object(a.m)(d[i])&&!Object(a.m)(d[i].OptionSet)){const e=d[i].OptionSet,t=s.split(","),r=[];t.forEach(t=>{const n=e.find(e=>String(e.Value)===t.trim());n&&n.Label&&r.push(n.Label)});const n=r.length>0?r.join("; "):void 0;m[h]=n}break;case o.AttributeType.Status:case o.AttributeType.State:case o.AttributeType.Boolean:case o.AttributeType.PickList:if(Object(a.m)(s)||f!==o.AttributeType.Boolean?m[i]=s:m[i]=0!==s,!Object(a.m)(s)&&n&&!Object(a.m)(d[i])&&!Object(a.m)(d[i].OptionSet)){const e=d[i].OptionSet;if(!Object(a.m)(e)&&e.length>0){const t=y(e,s);Object(a.m)(t)||(m[h]=t.Label)}}break;case o.AttributeType.PartyList:m[i]=s;break;case o.AttributeType.String:case o.AttributeType.UniqueIdentifier:case o.AttributeType.Memo:m[i]=s;break;default:m[i]=s,l.warn("Default case for formatter values. key = "+i+", attributeType = "+f)}}}return m}},MXGD:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.combineReducers=void 0,t.combineReducers=function(e){return function(e){return function(t,r){var a,i,o=void 0===t?{}:t,s={},u=!1,l=Object.keys(e);try{for(var c=n(l),d=c.next();!d.done;d=c.next()){var p=d.value,f=e[p],y=o[p],m=f(y,r);s[p]=m,u=u||m!==y}}catch(e){a={error:e}}finally{try{d&&!d.done&&(i=c.return)&&i.call(c)}finally{if(a)throw a.error}}var h=u?s:o;return Object.freeze(h)}}(function(e){var t,r,a={},i=Object.keys(e);try{for(var o=n(i),s=o.next();!s.done;s=o.next()){var u=s.value;a[u]=e[u]}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return a}(e))}},"Mx+d":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.getRelationShipByNavigationProperty=t.getRelationshipTypeByNavigationProperty=t.getEntityIconVectorName=t.getManyToManyRelationships=t.getPrimaryNameAttribute=t.getAttributeNamesFromEntityMetadata=t.getPrimaryIdAttribute=t.getRelationshipType=t.getManyToManyRelationship=t.getManyToOneRelationship=t.getManyToOneRelationshipByNavigationProperty=t.getManyToOneRelationshipByReferencedEntity=t.getOnetoManyRelationShipByNavigationProperty=t.getAllOneToManyRelationshipByReferencingEntity=t.getManyToOneRelationShipByNavigationProperty=t.getActivityPartyNavigationPropertyRelationship=t.getOneToManyRelationship=t.getHasStateCode=t.getManyToOneRelationships=t.getOneToManyRelationships=t.getDisplayName=t.getDisplayCollectionName=t.getIsIntersectFlag=t.getIsActivityFlag=t.getActivities=t.getEntitySetName=t.getEntitiesDescriptors=t.getEntityDescriptor=t.getEntityTypeCode=t.getEntityInitState=t.getEntityLogicalNameFromSetName=void 0;var s=r("pdzI"),u=i(r("+QHC")),l={systemuser:"systemusers",team:"teams"};function c(e,t){return e&&(null==e?void 0:e.metadata)&&(null==e?void 0:e.metadata.entities)?null==e?void 0:e.metadata.entities[t]:null}function d(e,t){var r=c(e,t);return!(!r||!r.hasOwnProperty("IsActivity"))&&r.IsActivity}function p(e){return e&&(null==e?void 0:e.metadata)?null==e?void 0:e.metadata.entities:null}function f(e,t){var r=c(e,t);return r&&r.OneToManyRelationships?r.OneToManyRelationships:null}function y(e,t){var r=c(e,t);return r?r.ManyToOneRelationships:null}function m(e,t,r){var n=f(e,t);return n&&n.hasOwnProperty(r)?n[r]:null}function h(e,t,r){var n=c(e,t);return n&&n.ManyToOneRelationships&&n.ManyToOneRelationships.hasOwnProperty(r)?n.ManyToOneRelationships[r]:null}function g(e,t,r,n){var a=c(e,t);if(a&&a.ManyToOneRelationships)for(var i in a.ManyToOneRelationships){var o=a.ManyToOneRelationships[i];if(o.ReferencedEntity===r&&o.ReferencingAttribute===n)return o}return null}function E(e,t,r){var n=c(e,t);return n&&n.ManyToManyRelationships&&n.ManyToManyRelationships.hasOwnProperty(r)?n.ManyToManyRelationships[r]:null}function b(e,t,r){var n,a,i=f(e,t);if(i)try{for(var s=o(Object.keys(i)),u=s.next();!u.done;u=s.next()){var l=i[u.value];if(l.ReferencedEntityNavigationPropertyName===r)return l}}catch(e){n={error:e}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}return null}function _(e,t,r){var n,a,i=y(e,t);if(i)try{for(var s=o(Object.keys(i)),u=s.next();!u.done;u=s.next()){var l=i[u.value];if(l.ReferencingEntityNavigationPropertyName===r)return l}}catch(e){n={error:e}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}return null}t.getEntityDescriptor=c,t.getEntityInitState=function(e,t){var r=c(e,t);return r?r.Initialized:s.InitState.Uninitialized},t.getEntityLogicalNameFromSetName=function(e,t){if(!e||!(null==e?void 0:e.metadata)||!(null==e?void 0:e.metadata.entities))return null;var r=null==e?void 0:e.metadata.entities;for(var n in r)if(r[n].EntitySetName===t)return r[n].EntityLogicalName;return null},t.getEntityTypeCode=function(e,t){var r;return null==c(e,t)?null:null===(r=c(e,t))||void 0===r?void 0:r.ObjectTypeCode},t.getEntitySetName=function(e,t){var r=c(e,t);if(r&&r.EntitySetName)return r.EntitySetName;var n=l[t];return n||null},t.getActivities=function(e){var t=p(e),r={};for(var n in t)d(e,n)&&(r[n]=t[n]);return r},t.getIsActivityFlag=d,t.getHasStateCode=function(e,t){var r=c(e,t);return!(!r||!r.hasOwnProperty("HasStateCode"))&&r.HasStateCode},t.getIsIntersectFlag=function(e,t){var r=c(e,t);return!(!r||!r.hasOwnProperty("IsIntersect"))&&r.IsIntersect},t.getEntitiesDescriptors=p,t.getDisplayCollectionName=function(e,t){var r=c(e,t);return r&&r.DisplayCollectionName?r.DisplayCollectionName:null},t.getDisplayName=function(e,t){var r=c(e,t);return r&&r.DisplayName?r.DisplayName:null},t.getOneToManyRelationships=f,t.getManyToOneRelationships=y,t.getOneToManyRelationship=m,t.getAllOneToManyRelationshipByReferencingEntity=function(e,t,r){var n=f(e,t);if(!n)return null;var a=[];for(var i in n){var o=n[i];o.ReferencedEntity===t&&o.ReferencingEntity===r&&a.push(o)}return a},t.getManyToOneRelationship=h,t.getManyToOneRelationshipByReferencedEntity=function(e,t,r,n){var a=g(e,t,r,n);if(!a){var i=c(e,t);i&&i.ManyToOneRelationships&&i.IsActivity&&(a=g(e,"activitypointer",r,n))}return a},t.getActivityPartyNavigationPropertyRelationship=function(e,t){var r=f(e,t);if(!r)return null;var n=[];for(var a in r){var i=r[a];if(i.ReferencedEntity===t&&"activityparty"===i.ReferencingEntity){if("campaignactivity"===t&&"campaignactivity_activity_parties"!==a||"bulkoperation"===t&&"bulkoperation_activity_parties"!==a)continue;n.push(i)}}return 1===n.length?n[0]:null},t.getManyToOneRelationshipByNavigationProperty=function(e,t,r){var n=c(e,t);if(n&&n.ManyToOneRelationships)for(var a in n.ManyToOneRelationships){var i=n.ManyToOneRelationships[a];if(i.ReferencingEntityNavigationPropertyName===r)return i}return null},t.getManyToManyRelationship=E,t.getRelationshipType=function(e,t,r){return m(e,t,r)?u.RelationshipType.OneToManyRelationship:E(e,t,r)?u.RelationshipType.ManyToManyRelationship:h(e,t,r)?u.RelationshipType.None:null},t.getOnetoManyRelationShipByNavigationProperty=b,t.getManyToOneRelationShipByNavigationProperty=_,t.getRelationShipByNavigationProperty=function(e,t,r){var n=_(e,t,r);return n||b(e,t,r)},t.getRelationshipTypeByNavigationProperty=function(e,t,r){return b(e,t,r)?u.RelationshipType.OneToManyRelationship:_(e,t,r)?u.RelationshipType.ManyToOneRelationship:u.RelationshipType.None},t.getPrimaryIdAttribute=function(e,t){return e&&(null==e?void 0:e.metadata)&&(null==e?void 0:e.metadata.entities)&&t&&(null==e?void 0:e.metadata.entities[t])?null==e?void 0:e.metadata.entities[t].PrimaryIdAttribute:null},t.getAttributeNamesFromEntityMetadata=function(e,t){var r=c(e,t);return r?new Set(r.AttributeNames):null},t.getPrimaryNameAttribute=function(e,t){var r=t?c(e,t):null;return r&&r.PrimaryNameAttribute?r.PrimaryNameAttribute:null},t.getManyToManyRelationships=function(e,t){var r=c(e,t);return r&&r.ManyToManyRelationships?r.ManyToManyRelationships:null},t.getEntityIconVectorName=function(e,t){var r=c(e,t);return r&&r.IconVectorName?r.IconVectorName:null}},"N/D8":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OptionMetadata=void 0;var n=function(){function e(e,t,r,n,a,i,o){this._val=0,this._state=0,this._defaultStatus=0,this._allowedStatusTransitions=null,this._color=null,this._invariantName=null,this._label=e,this._val=t,this._state=r,this._defaultStatus=n,this._allowedStatusTransitions=a,this._color=i,this._invariantName=o}return e.prototype.get_Label=function(){return this._label},e.prototype.set_Label=function(e){return this._label=e,e},e.prototype.get_ValueString=function(){return this._val.toString()},e.prototype.get_allowedStatusTransitions=function(){return this._allowedStatusTransitions},e.prototype.get_color=function(){return this._color},e.prototype.get_value=function(){return this._val},e.prototype.get_state=function(){return this._state},e.prototype.get_defaultStatus=function(){return this._defaultStatus},e.prototype.get_invariantName=function(){return this._invariantName},e.prototype.getObjectData=function(){return{label:this._label,value:this._val,state:this._state,defaultstatus:this._defaultStatus,allowedstatustransitions:this._allowedStatusTransitions,color:this._color,invariantname:this._invariantName}},e.prototype.getODataObject=function(){return{Value:this._val,Color:this._color,Label:this._label,DefaultStatus:this._defaultStatus,State:this._state,TransitionData:this._allowedStatusTransitions,InvariantName:this._invariantName}},e.createFromPicklistItem=function(t){if(t instanceof e)return t;return new e(t.get_Label(),+t,-1,-1,null,null,null)},e.createFromObjectData=function(t){return new e(t.label,t.value,"state"in t?t.state:-1,"defaultstatus"in t?t.defaultstatus:-1,"allowedstatustransitions"in t?t.allowedstatustransitions:null,"color"in t?t.color:null,t.invariantname)},e.createFromOData=function(t){return new e(t.Label,t.Value,"State"in t?t.State:-1,"DefaultStatus"in t?t.DefaultStatus:-1,"TransitionData"in t?t.TransitionData:null,"Color"in t?t.Color:null,t.Description)},e}();t.OptionMetadata=n,n.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.OptionMetadata"},NV9l:function(e,t,r){"use strict";var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.getEntityReferenceFromField=t.getEntityReferenceIdFromField=t.getRawValueFromField=t.getPickListValueFromField=t.getFormattedValueFromField=t.isPartylistValue=t.isAliasedValue=t.isPlainValue=t.isReferenceValue=t.isGuidValue=t.isPicklistValue=void 0;var a=r("FDNG");function i(e){return!!e&&e.hasOwnProperty("label")}function o(e){return!!e&&e.hasOwnProperty("id")}function s(e){return!!e&&e.hasOwnProperty("reference")}function u(e){return!!e&&e.hasOwnProperty("value")}function l(e){return!!e&&e.hasOwnProperty("innerValue")}function c(e){return!!e&&e.hasOwnProperty("list")}function d(e){return e?e.toString():null}function p(e){return e&&i(e)?e.valueString:null}t.getFormattedValueFromField=function e(t){var r,p;if(t){if(u(t)){if(t.validationResult&&!t.validationResult.isValueValid){var f=t.validationResult.userInput;return f&&(null==f?void 0:f.toString())}return t.formatted||t.value&&t.value.toString()}if(i(t))return t.label;if(o(t))return a.Guid.toString(t.id);if(s(t))return t.reference&&t.reference.name||null;if(l(t))return e(t.innerValue);if(c(t)){var y="";try{for(var m=n(t.list),h=m.next();!h.done;h=m.next()){var g=h.value,E=void 0;g.fields&&(E=g.fields.partyid?g.fields.partyid:g.fields.addressused?g.fields.addressused:null)&&(y=""!==y?y+", "+e(E):e(E))}}catch(e){r={error:e}}finally{try{h&&!h.done&&(p=m.return)&&p.call(m)}finally{if(r)throw r.error}}return y}return d(t)}return null},t.getRawValueFromField=function e(t){return t?u(t)?t.value:i(t)?p(t):o(t)?t.id:s(t)?t.reference:l(t)?e(t.innerValue):c(t)?t.list:d(t):null},t.isPicklistValue=i,t.isGuidValue=o,t.isReferenceValue=s,t.isPlainValue=u,t.isAliasedValue=l,t.isPartylistValue=c,t.getPickListValueFromField=p,t.getEntityReferenceIdFromField=function(e){return e&&s(e)&&e.reference&&e.reference.id||null},t.getEntityReferenceFromField=function(e){return s(e)&&e.reference||null}},NgZN:function(e,t,r){"use strict";var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return o},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.DOMParserNodeWrapper=void 0;var s=r("lqZx"),u=r("1LmJ"),l=r("xvCR"),c=r("UZ+8"),d=function(e){function t(t,r){var n=e.call(this)||this;return u.assert(!c.IsNullOrUndefined(t),"The element should not be null"),n._element=t,n._namespaces=c.IsNullOrUndefined(r)?{}:r,n}return a(t,e),t.prototype.get_innerText=function(){return this._element.hasChildNodes()?this._element.firstChild.nodeValue:null},t.prototype.get_outerXml=function(){return(new XMLSerializer).serializeToString(this._element)},t.prototype.get_tagName=function(){return this._element.nodeName},t.prototype.get_domParserElement=function(){return this._element},t.prototype.getAttribute=function(e){return this._element.getAttribute(e)},t.prototype.addNamespace=function(e,t){this._namespaces[e]=t},t.prototype.selectSingleNode=function(e){var t=this._SelectDOMParserElements(e,!0);if(t.get_count())return t.get_item(0)},t.prototype.selectNodes=function(e){return this._SelectDOMParserElements(e,!1)},t.prototype.getElementsByTagName=function(e){var r,n=this;r=c.IsNullOrUndefined(this._element.ownerDocument)?this._element.getElementsByTagName(e):this._element.ownerDocument.getElementsByTagName(e);for(var a=[],i=0;i<r.length;i++)a.push(r[i]);var s=this._GetElementsByTagNameWithDefaultNamespace(e);a.push.apply(a,o(s));var u=a.map((function(e){return new t(e,n._namespaces)}));return new l.DOMParserNodeListWrapper(u)},t.prototype.childNodes=function(){for(var e=[],r=0,n=this._element.childNodes.length;r<n;r++)e.push(new t(this._element.childNodes[r],this._namespaces));return new l.DOMParserNodeListWrapper(e)},t.prototype.hasChildNodes=function(){return this._element.hasChildNodes()},t.prototype._SelectDOMParserElements=function(e,r){var n=this,a=[];if(e.startsWith("// ")||e.startsWith(".// ")){var i=2,s=!1;e.startsWith(".")&&(i++,s=!0);var u=(e=e.substr(i)).indexOf("/"),d=void 0,p=void 0;u<0?(d=e,p=null):(d=e.substr(0,u),p=e.substr(u+1));var f=void 0,y=void 0;(u=d.indexOf("["))<0?(f=d,y=null):(f=d.substr(0,u),u=(y=d.substr(u+1)).indexOf("]"),y=y.substr(0,u));var m=void 0;m=s||c.IsNullOrUndefined(this._element.ownerDocument)?this._element.getElementsByTagName(f):this._element.ownerDocument.getElementsByTagName(f);for(var h=[],g=0;g<m.length;g++)h.push(m[g]);var E=this._GetElementsByTagNameWithDefaultNamespace(f);h.push.apply(h,o(E));var b=h;h.length>0&&null!==y&&(b=this._FilterDOMParserElementList(h,y)),a=b.length&&null!==p?this._SearchDOMParserElementList(b,p,r):b}else e.startsWith("/")?(c.IsNullOrUndefined(this._element.ownerDocument)?a.push(this._element):a.push(this._element.ownerDocument),a=this._SearchDOMParserElementList(a,e.substr(1),r)):(a.push(this._element),a=this._SearchDOMParserElementList(a,e,r));var _=a.map((function(e){return new t(e,n._namespaces)}));return new l.DOMParserNodeListWrapper(_)},t.prototype._SearchDOMParserElementList=function(e,t,r){return r?this._SearchSingleNodeDOMParserElementList(e,t):this._SearchNodesDOMParserElementList(e,t)},t.prototype._SearchSingleNodeDOMParserElementList=function(e,t){if(c.IsNullOrUndefined(t)||t.length<1)return e;for(var r=[],n=0;n<e.length;n++){var a=this._SearchSingleNodeDOMParserElement(e[n],t);if(a){r.push(a);break}}return r},t.prototype._SearchSingleNodeDOMParserElement=function(e,t){if(c.IsNullOrUndefined(t)||t.length<1)return e;var r,n,a,i,o=t.indexOf("/");o<0?(r=t,n=null):(r=t.substr(0,o),n=t.substr(o+1)),(o=r.indexOf("["))<0?(a=r,i=null):(a=r.substr(0,o),o=(i=r.substr(o+1)).indexOf("]"),i=i.substr(0,o));for(var s=null,u=0,l=e.childNodes.length;u<l;u++)if(this._IsNodeNameEqual(e.childNodes[u],a)){var d=[e.childNodes[u]],p=d;if(null!==i&&(p=this._FilterDOMParserElementList(d,i)),p.length>0){if(null===n){s=p[0];break}if(s=this._SearchSingleNodeDOMParserElement(p[0],n))break}}return s},t.prototype._SearchNodesDOMParserElementList=function(e,t){if(c.IsNullOrUndefined(t)||t.length<1)return e;var r,n,a=t.indexOf("/");a<0?(r=t,n=null):(r=t.substr(0,a),n=t.substr(a+1));for(var i,s=[],u=0;u<e.length;u++)(i=this._SearchDOMParserElement(e[u],r)).length>0&&s.push.apply(s,o(i));return s.length&&null!==n?this._SearchNodesDOMParserElementList(s,n):s},t.prototype._SearchDOMParserElement=function(e,t){var r,n,a=t.indexOf("[");a<0?(r=t,n=null):(r=t.substr(0,a),a=(n=t.substr(a+1)).indexOf("]"),n=n.substr(0,a));for(var i=[],o=0,s=e.childNodes.length;o<s;o++)this._IsNodeNameEqual(e.childNodes[o],r)&&i.push(e.childNodes[o]);var u=i;return i.length>0&&null!==n&&(u=this._FilterDOMParserElementList(i,n)),u},t.prototype._FilterDOMParserElementList=function(e,t){var r=t.startsWith("@");r&&(t=t.substr(1));var n,a,i=t.indexOf("=");i<0?(n=t,a=null):(n=t.substr(0,i),a=(a=(a=t.substr(i+1)).substr(1)).substr(0,a.length-1));for(var o=[],s=0;s<e.length;s++){var u=e[s];(r&&this._FilterDOMParserElementAttribute(u,n,a)||this._FilterDOMParserElementChildElement(u,n,a))&&o.push(u)}return o},t.prototype._FilterDOMParserElementAttribute=function(e,t,r){return null===r?e.hasAttribute(t):r===e.getAttribute(t)},t.prototype._FilterDOMParserElementChildElement=function(e,t,r){for(var n,a,i,o=0,s=null===(n=null==e?void 0:e.childNodes)||void 0===n?void 0:n.length;o<s;o++)if(this._IsNodeNameEqual(e.childNodes[o],t)){if(null===r)return!0;if((null===(i=null===(a=e.childNodes[o])||void 0===a?void 0:a.firstChild)||void 0===i?void 0:i.nodeValue)===r)return!0}return!1},t.prototype._GetElementsByTagNameWithDefaultNamespace=function(e){var t=[],r=this._GetNamespaceForFullName(e);if(c.IsNullOrUndefined(r)||r.length<1)return t;var n,a=this._GetLocalNameForFullName(e);n=c.IsNullOrUndefined(this._element.ownerDocument)?this._element.getElementsByTagName(a):this._element.ownerDocument.getElementsByTagName(a);for(var i=0;i<n.length;i++)n[i].namespaceURI===r&&t.push(n[i]);return t},t.prototype._GetNamespaceForFullName=function(e){var t=e.indexOf(":");if(t<0)return"";var r=e.substr(0,t);return this._namespaces[r]},t.prototype._GetLocalNameForFullName=function(e){var t=e.indexOf(":");return t<0?e:e.substr(t+1)},t.prototype._IsNodeNameEqual=function(e,t){if(e.nodeName===t||"*"===t)return!0;var r=this._GetNamespaceForFullName(t);if(c.IsNullOrUndefined(r)||r.length<1)return!1;var n=this._GetLocalNameForFullName(t);return e.namespaceURI===r&&e.localName===n},t}(s.XmlNode);t.DOMParserNodeWrapper=d},OMC6:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveEntityMetadata=t.RETRIEVE_ENTITY_METADATA=void 0;t.RETRIEVE_ENTITY_METADATA="entityMetadata.retrieve",t.retrieveEntityMetadata=function(e){return{type:"entityMetadata.retrieve",payload:e}}},OhA8:function(e,t,r){"use strict";r.d(t,"s",(function(){return c})),r.d(t,"u",(function(){return d})),r.d(t,"q",(function(){return p})),r.d(t,"b",(function(){return f})),r.d(t,"r",(function(){return y})),r.d(t,"h",(function(){return N})),r.d(t,"i",(function(){return A})),r.d(t,"f",(function(){return C})),r.d(t,"l",(function(){return P})),r.d(t,"v",(function(){return I})),r.d(t,"a",(function(){return s.COMPOSITE_INDEX_DELIMITER})),r.d(t,"g",(function(){return m})),r.d(t,"c",(function(){return h})),r.d(t,"t",(function(){return g})),r.d(t,"j",(function(){return E})),r.d(t,"m",(function(){return b})),r.d(t,"o",(function(){return v})),r.d(t,"d",(function(){return O})),r.d(t,"n",(function(){return _})),r.d(t,"k",(function(){return T})),r.d(t,"p",(function(){return S})),r.d(t,"e",(function(){return R}));var n,a=r("cvWF"),i=r("f03v");!function(e){e[e.unknown=-1]="unknown",e[e.none=0]="none",e[e.systemRequired=1]="systemRequired",e[e.applicationRequired=2]="applicationRequired",e[e.recommended=3]="recommended"}(n||(n={}));var o=r("MMlZ"),s=r("17Cn"),u=r("HPMC"),l=r("rfM3");function c(e,t){return e?Object.keys(e).reduce((r,n)=>(r[n]=t(e[n]),r),{}):{}}function d(e,t){if(b(e))throw Error("Argument = ${argumentName} can't be null or undefined")}function p(e){switch(e){case"None":return i.DateTimeFieldBehavior.None;case"UserLocal":return i.DateTimeFieldBehavior.UserLocal;case"DateOnly":return i.DateTimeFieldBehavior.DateOnly;case"TimeZoneIndependent":return i.DateTimeFieldBehavior.TimeZoneIndependent;default:return i.DateTimeFieldBehavior.UserLocal}}function f(e){switch(e){case i.DateTimeFieldBehavior.None:return"None";case i.DateTimeFieldBehavior.UserLocal:return"UserLocal";case i.DateTimeFieldBehavior.DateOnly:return"DateOnly";case i.DateTimeFieldBehavior.TimeZoneIndependent:return"TimeZoneIndependent";default:return"UserLocal"}}function y(e){switch(e){case"None":return n.none;case"ApplicationRequired":return n.applicationRequired;case"Recommended":return n.recommended;case"SystemRequired":return n.systemRequired;default:return n.unknown}}function m(e){return e}function h(e){return e[0]}async function g(e){return[e]}function E(e,t){if(!e)return null;let r=e.get(t);return r||(r=e.get(t.toLowerCase())),r}function b(e){return null==e}function _(e){return b(e)||v(e)||0===Object.keys(e).length}function v(e){return!!b(e)||typeof e===a.AttributeType.String&&""===e.trim()}function T(e){return l.MetadataType.savedView+s.COMPOSITE_INDEX_DELIMITER+e}function O(e,t,r){const n=r||0,a=e?e.message:"Unknown Error",i=e?e.stack:void 0,s=e?e.name:void 0;return Object(o.a)(n,t,new u.a(a,void 0,i,s))}function S(e){return!(b(e)||!b(e.MetadataType)||b(e.DependencyDepth)||"usercontext"!==e.DependencyDepth.toLowerCase())}function N(e,t,r=[]){let n=s.CLIENT_TYPE.remote;return e&&e.additionalHeaders?e.additionalHeaders.clientType&&[s.CLIENT_TYPE.local,s.CLIENT_TYPE.remote].includes(e.additionalHeaders.clientType)?n=e.additionalHeaders.clientType:e.additionalHeaders[s.HINT.executionStrategy]&&[s.EXECUTION_HINTS.OFFLINE,s.EXECUTION_HINTS.ONLINE].includes(e.additionalHeaders[s.HINT.executionStrategy])?n=e.additionalHeaders[s.HINT.executionStrategy]===s.EXECUTION_HINTS.OFFLINE?s.CLIENT_TYPE.local:s.CLIENT_TYPE.remote:t&&t.warn("[Utils.getClientType] Unsupported execution strategy, default to remote client",r):t&&t.warn("[Utils.getClientType] No execution strategy provided, default to remote client",r),n}function R(e){let t=s.UNKNOWN,r=s.ErrorCode.UnknownUnexpectedGenericError,n=s.UNKNOWN;return b(e)||(M(e)?(t=v(e._message)?t:e._message,r=v(e._errorCode)?r:e._errorCode,n=v(e._stack)?n:e._stack):(t=v(e.message)?t:e.message,n=v(e.stack)?n:e.stack)),new u.a(t,r,n)}function M(e){return!_(e)&&void 0!==e.get_Message}function A(e){return M(e)?e._message?e._message:null:e?e.message?e.message:e:null}function C(e){const t=[];for(let r=0;r<e.length;r++)switch(e.charAt(r)){case"[":t.push("[[]");break;case"_":t.push("[_]");break;case"%":t.push("[%]");break;case"*":t.push("%");break;default:t.push(e.charAt(r))}return e.length&&e.endsWith("*")||t.push("%"),t.join("")}function P(e){return e.replace("'","''")}function I(e){let t=e;if(!t)return t;"*"===t[0]&&(t=t.substring(1));return"*"===t[t.length-1]&&(t=t.substring(0,t.length-1)),t}},"PVp+":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClientRetrieveOptions=void 0;var n=r("ink8"),a=r("ugCW"),i=r("UZ+8"),o=function(){function e(e,t,r){this._cachePriority=0,this._retrievalStrategy=0,this._cachePriority=e,this._retrievalStrategy=t,this._timestamp=r||new Date}return e.prototype.get_timestamp=function(){return this._timestamp},e.prototype.get_cachePriority=function(){return this._cachePriority},e.prototype.set_cachePriority=function(e){return this._cachePriority=e,e},e.prototype.get_retrievalStrategy=function(){return this._retrievalStrategy},e.prototype.set_retrievalStrategy=function(e){return this._retrievalStrategy=e,e},e.prototype.get_sortableTimestamp=function(){return e.getSortableString(this._timestamp)},e.prototype.getObjectData=function(){var t={};return t[e.timestampPath]=this.get_sortableTimestamp(),t.priority_timestamp=e.priorityTimestampKey(this._cachePriority,this._timestamp),t},e.prototype.update=function(e){i.IsNullOrUndefined(e)||(this._timestamp=e._timestamp,e._cachePriority<this._cachePriority&&(this._cachePriority=e._cachePriority))},e.shouldBeCached=function(e){return!i.IsNullOrUndefined(e)&&e.get_cachePriority()!==n.CachePriority.NotCached},e.getSortableString=function(e){return e.toDateString()},e.priorityTimestampKey=function(t,r){return t+"|"+e.getSortableString(r)},e.createFromObjectData=function(t){var r=new Date(t[e.timestampPath]);return new e(+t.priority_timestamp.substr(0,1),a.RetrievalStrategy.LocalAndRemote,r)},e.timestampPath="timestamp",e.embeddedPriorityTimestampPath="clientretrieveoptions.priority_timestamp",e}();t.ClientRetrieveOptions=o},Q6jc:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DependencyType=t.EncodeRule=t.RollupType=t.TargetFieldType=t.OrderType=t.LogicalOperator=t.JoinOperator=t.DependencyDepth=t.ConditionOperator=void 0,function(e){e[e.Equal=0]="Equal",e[e.NotEqual=1]="NotEqual",e[e.GreaterThan=2]="GreaterThan",e[e.LessThan=3]="LessThan",e[e.GreaterEqual=4]="GreaterEqual",e[e.LessEqual=5]="LessEqual",e[e.Like=6]="Like",e[e.NotLike=7]="NotLike",e[e.In=8]="In",e[e.NotIn=9]="NotIn",e[e.Between=10]="Between",e[e.NotBetween=11]="NotBetween",e[e.Null=12]="Null",e[e.NotNull=13]="NotNull",e[e.Yesterday=14]="Yesterday",e[e.Today=15]="Today",e[e.Tomorrow=16]="Tomorrow",e[e.Last7Days=17]="Last7Days",e[e.Next7Days=18]="Next7Days",e[e.LastWeek=19]="LastWeek",e[e.ThisWeek=20]="ThisWeek",e[e.NextWeek=21]="NextWeek",e[e.LastMonth=22]="LastMonth",e[e.ThisMonth=23]="ThisMonth",e[e.NextMonth=24]="NextMonth",e[e.On=25]="On",e[e.OnOrBefore=26]="OnOrBefore",e[e.OnOrAfter=27]="OnOrAfter",e[e.LastYear=28]="LastYear",e[e.ThisYear=29]="ThisYear",e[e.NextYear=30]="NextYear",e[e.LastXHours=31]="LastXHours",e[e.NextXHours=32]="NextXHours",e[e.LastXDays=33]="LastXDays",e[e.NextXDays=34]="NextXDays",e[e.LastXWeeks=35]="LastXWeeks",e[e.NextXWeeks=36]="NextXWeeks",e[e.LastXMonths=37]="LastXMonths",e[e.NextXMonths=38]="NextXMonths",e[e.LastXYears=39]="LastXYears",e[e.NextXYears=40]="NextXYears",e[e.EqualUserId=41]="EqualUserId",e[e.NotEqualUserId=42]="NotEqualUserId",e[e.EqualBusinessId=43]="EqualBusinessId",e[e.NotEqualBusinessId=44]="NotEqualBusinessId",e[e.ChildOf=45]="ChildOf",e[e.Mask=46]="Mask",e[e.NotMask=47]="NotMask",e[e.MasksSelect=48]="MasksSelect",e[e.Contains=49]="Contains",e[e.DoesNotContain=50]="DoesNotContain",e[e.EqualUserLanguage=51]="EqualUserLanguage",e[e.NotOn=52]="NotOn",e[e.OlderThanXMonths=53]="OlderThanXMonths",e[e.BeginsWith=54]="BeginsWith",e[e.DoesNotBeginWith=55]="DoesNotBeginWith",e[e.EndsWith=56]="EndsWith",e[e.DoesNotEndWith=57]="DoesNotEndWith",e[e.ThisFiscalYear=58]="ThisFiscalYear",e[e.ThisFiscalPeriod=59]="ThisFiscalPeriod",e[e.NextFiscalYear=60]="NextFiscalYear",e[e.NextFiscalPeriod=61]="NextFiscalPeriod",e[e.LastFiscalYear=62]="LastFiscalYear",e[e.LastFiscalPeriod=63]="LastFiscalPeriod",e[e.LastXFiscalYears=64]="LastXFiscalYears",e[e.LastXFiscalPeriods=65]="LastXFiscalPeriods",e[e.NextXFiscalYears=66]="NextXFiscalYears",e[e.NextXFiscalPeriods=67]="NextXFiscalPeriods",e[e.InFiscalYear=68]="InFiscalYear",e[e.InFiscalPeriod=69]="InFiscalPeriod",e[e.InFiscalPeriodAndYear=70]="InFiscalPeriodAndYear",e[e.InOrBeforeFiscalPeriodAndYear=71]="InOrBeforeFiscalPeriodAndYear",e[e.InOrAfterFiscalPeriodAndYear=72]="InOrAfterFiscalPeriodAndYear",e[e.EqualUserTeams=73]="EqualUserTeams",e[e.EqualUserOrUserTeams=74]="EqualUserOrUserTeams",e[e.Under=75]="Under",e[e.NotUnder=76]="NotUnder",e[e.UnderOrEqual=77]="UnderOrEqual",e[e.Above=78]="Above",e[e.AboveOrEqual=79]="AboveOrEqual",e[e.EqualUserOrUserHierarchy=80]="EqualUserOrUserHierarchy",e[e.EqualUserOrUserHierarchyAndTeams=81]="EqualUserOrUserHierarchyAndTeams",e[e.OlderThanXYears=82]="OlderThanXYears",e[e.OlderThanXWeeks=83]="OlderThanXWeeks",e[e.OlderThanXDays=84]="OlderThanXDays",e[e.OlderThanXHours=85]="OlderThanXHours",e[e.OlderThanXMinutes=86]="OlderThanXMinutes"}(t.ConditionOperator||(t.ConditionOperator={})),function(e){e[e.Unknown=0]="Unknown",e[e.OnDemandWithContext=1]="OnDemandWithContext",e[e.OnDemandWithoutContext=2]="OnDemandWithoutContext",e[e.OnDemandContextOnly=3]="OnDemandContextOnly",e[e.Offline=4]="Offline",e[e.Mobile=5]="Mobile",e[e.UserContext=6]="UserContext"}(t.DependencyDepth||(t.DependencyDepth={})),function(e){e[e.Inner=0]="Inner",e[e.LeftOuter=1]="LeftOuter",e[e.Natural=2]="Natural",e[e.MatchFirstRowUsingCrossApply=3]="MatchFirstRowUsingCrossApply",e[e.In=4]="In",e[e.Exists=5]="Exists"}(t.JoinOperator||(t.JoinOperator={})),function(e){e[e.And=0]="And",e[e.Or=1]="Or",e[e.Not=2]="Not"}(t.LogicalOperator||(t.LogicalOperator={})),function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending"}(t.OrderType||(t.OrderType={})),function(e){e[e.All=0]="All",e[e.ValidForCreate=1]="ValidForCreate",e[e.ValidForUpdate=2]="ValidForUpdate",e[e.ValidForRead=3]="ValidForRead"}(t.TargetFieldType||(t.TargetFieldType={})),function(e){e[e.None=0]="None",e[e.Related=1]="Related",e[e.Extended=2]="Extended"}(t.RollupType||(t.RollupType={})),function(e){e[e.None=0]="None",e[e.SingleQuotesURL=1]="SingleQuotesURL",e[e.DoubleQuotesURL=2]="DoubleQuotesURL",e[e.NoQuotesURL=3]="NoQuotesURL",e[e.Contract=4]="Contract",e[e.JsonifyURL=5]="JsonifyURL"}(t.EncodeRule||(t.EncodeRule={})),function(e){e[e.NewData=1]="NewData",e[e.ExistingData=2]="ExistingData"}(t.DependencyType||(t.DependencyType={}))},RHls:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.convertErrorAndRethrow=t.convertToErrorStatus=t.ErrorStatus=void 0;var a=r("SXiu"),i=function(){function e(t,r,n,i,o,s,u,l,c,d,p,f,y,m,h,g,E,b){void 0===f&&(f=!1),void 0===y&&(y=-1),void 0===m&&(m=null);var _=r||e.DEFAULT_ERROR_CODE,v=d,T=a.createUciError(t,_,l,c,v,p,f);return T.message||(T.message=_.toString()),T.errorParameters||(T.errorParameters=[]),u&&T.errorParameters.push({name:"ErrorDetails",value:u}),s&&T.errorParameters.push({name:"ErrorFault",value:s}),o&&T.errorParameters.push({name:"ErrorSource",value:o}),n&&T.errorParameters.push({name:"Exception",value:n.message}),p&&T.errorParameters.push({name:"ErrorStack",value:p}),T._errorSource=o,T._exception=n,T._innerError=i,T._errorFault=s,T._details=u,T.blockErrorReporting=f,T.faultedRequestIndex=y,T.faultedSnapshotId=m,T.httpStatusCode=h,T.clientRequestId=g,T.serverResponseId=E,T.retryAfter=b,e._addErrorStatusProps(T),T}return e.fromErrorCode=function(t,r){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];var i=e._getErrorMessage(t,r,n),o=new e(i,r);return o},e.fromExistingError=function(t){var r=t;return r.name||(r.name=a.UCI_ERROR_NAME),void 0===r.errorCode&&(r.errorCode=e.DEFAULT_ERROR_CODE),void 0===r.blockErrorReporting&&(r.blockErrorReporting=!1),void 0===r.faultedRequestIndex&&(r.faultedRequestIndex=-1),e._addErrorStatusProps(r),r},e._addErrorStatusProps=function(t){var r,a,i=Object.getOwnPropertyNames(e.prototype);try{for(var o=n(i),s=o.next();!s.done;s=o.next()){var u=s.value,l=Object.getOwnPropertyDescriptor(e.prototype,u);Object.defineProperty(t,u,l)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(a=o.return)&&a.call(o)}finally{if(r)throw r.error}}},e.createEmpty=function(){return new e("ErrorStatus created with no information",this.DEFAULT_ERROR_CODE)},e._getErrorMessageResourceId=function(e){var t=e;return t<0&&(t=t+4294967295+1),"Error_Message_0x"+t.toString(16)},e._getErrorMessage=function(t,r){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];return e._getErrorMessageResourceId(r)},Object.defineProperty(e.prototype,"errorFault",{get:function(){return this._errorFault},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"details",{get:function(){return this._details},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exception",{get:function(){return this._exception},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"innerError",{get:function(){return this._innerError},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"errorSource",{get:function(){return this._errorSource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localizedMessage",{get:function(){if(this.message){var e=/, Error details: (.*)$/gi.exec(this.message);if(e&&e.length>1){var t=e[1];return"'"===t[0]&&"'"===t[t.length-1]?t.substring(1,t.length-1):t}}return null},enumerable:!1,configurable:!0}),e.prototype.containsErrorCode=function(e){return this.getNegativeErrorCode()===e||!!this._innerError&&this._innerError.containsErrorCode(e)},e.prototype.getNegativeErrorCode=function(){return function(e){var t=e;e>0&&(t=~~e);return t}(this.errorCode)},e.DEFAULT_ERROR_MESSAGE_ID="Error_Message_Generic_Mobile_Client",e.DEFAULT_ERROR_CODE=0,e}();function o(e){return e?e instanceof Error?i.fromExistingError(e):e:i.createEmpty()}t.ErrorStatus=i,t.convertErrorAndRethrow=function(e){throw o(e)},t.convertToErrorStatus=o},RXHd:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var n;r.r(t),r.d(t,"OptionMetadata",(function(){return d})),function(e){e[e.Raw=0]="Raw",e[e.Numeric=1]="Numeric",e[e.Label=2]="Label",e[e.Value=3]="Value",e[e.State=4]="State",e[e.Id=5]="Id",e[e.Name=6]="Name",e[e.LogicalName=7]="LogicalName",e[e.AllowedStatusTransitions=8]="AllowedStatusTransitions",e[e.DefaultStatus=9]="DefaultStatus",e[e.Color=10]="Color"}(n||(n={}));
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
const a=c(n.Label),i=c(n.Value),o=c(n.State),s=c(n.DefaultStatus),u=c(n.AllowedStatusTransitions),l=c(n.Color);function c(e){return"!"+n[e]}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class d{constructor(e,t,r,n,a,i,o){this._val=0,this._state=0,this._defaultStatus=0,this._label=e,this._val=t,this._state=r,this._defaultStatus=n,this._allowedStatusTransitions=a,this._color=i,this._invariantName=o}static createFromPicklistItem(e){if(e instanceof d)return e;{const t=e.get_Label(),r=Number(e.get_ValueString());return new d(t,r,-1,-1,[],"","")}}static createFromObjectData(e){const t=e.label,r=e.value,n="state"in e?e.state:-1,a="defaultstatus"in e?e.defaultstatus:-1,i="allowedstatustransitions"in e?e.allowedstatustransitions:[],o="color"in e?e.color:"",s=e.invariantname;return new d(t,r,n,a,i,o,s)}static createFromOData(e){const t=e.Label,r=e.Value,n="State"in e?e.State:-1,a="DefaultStatus"in e?e.DefaultStatus:-1,i="TransitionData"in e?e.TransitionData:[],o="Color"in e?e.Color:"",s=e.Description;return new d(t,r,n,a,i,o,s)}get_Label(){return this._label}set_Label(e){return this._label=e,e}get_ValueString(){return this._val.toString()}get_allowedStatusTransitions(){return this._allowedStatusTransitions}get_color(){return this._color}get_value(){return this._val}get_state(){return this._state}get_defaultStatus(){return this._defaultStatus}get_invariantName(){return this._invariantName}getObjectData(){return{label:this._label,value:this._val,state:this._state,defaultstatus:this._defaultStatus,allowedstatustransitions:this._allowedStatusTransitions,color:this._color,invariantname:this._invariantName}}getODataObject(){return{Value:this._val,Color:this._color,Label:this._label,DefaultStatus:this._defaultStatus,State:this._state,TransitionData:this._allowedStatusTransitions,InvariantName:this._invariantName}}getValue(e){if(e===a||"label"===e)return this.get_Label();if(e===i||"value"===e)return this.get_value();if(e===o||"state"===e)return this.get_state();if(e===s||"defaultstatus"===e)return this._defaultStatus;if(e===u||"allowedstatustransitions"===e)return this.get_allowedStatusTransitions();if(e===l||"color"===e)return this.get_color();throw new Error("fieldName = ${fieldName} is out of range")}}d.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.OptionMetadata"},RncB:function(e,t,r){"use strict";r.r(t),r.d(t,"ODataExecutor",(function(){return vr}));var n=r("17Cn"),a=r("r1Gy"),i=r("OhA8");class o{constructor(){this._startMarker=new Map,this._perfMeasure=new Map,this._perfStatistic=new Map}startMarker(e){this._startMarker.set(e,this.getTimeNow())}endMarker(e){const t=this.getTimeNow();let r=0;try{this._startMarker.has(e)&&(r=this._startMarker.get(e)||r);const n=t-r,a={name:e,startTime:r,endTime:t,duration:n};this.updatedStatistic(e,n),this._perfMeasure.set(e,a)}catch{return}}getTimeNow(){return performance.now()}getPerformanceEntry(e){try{if(this._perfMeasure.has(e)&&this._perfStatistic.has(e)){const t=this._perfMeasure.get(e),r=this._perfStatistic.get(e);if(t&&r)return{name:e,performanceMeasure:t,performanceStatistic:r}}}catch{return null}return null}updatedStatistic(e,t){let r=t,n=1,a=t,i={};try{if(this._perfStatistic.has(e)){const i=this._perfStatistic.get(e);n=i?i.count+n:n,r=i?i.totalDuration+t:t,a=r/n}i={name:e,count:n,totalDuration:r,averageDuration:a},this._perfStatistic.set(e,i)}catch{return}}}var s=r("gmsG"),u=r("lWap");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
class l{constructor(e,t){this._policies=[],t&&this.addRetryPolicies(t),this._tracer=e.TraceManager.getTracer(s.COMPONENT_NAMES.ODataExecutor)}addRetryPolicy(e){e.action||(e.action=async e=>e),this._policies.push(e)}addRetryPolicies(e){e&&e.length>0&&e.forEach(e=>{this.addRetryPolicy(e)})}getRetryPolicy(e){for(let r=0;r<this._policies.length;r++){const n=this._policies[r];if(n.condition(e)&&n.action)return this._tracer.info(`${t=void 0,t?`[${t}]`:`[${s.FILE_PREFIX.PolicyManager}]`} Fit Policy ${n.name}`),n}var t;
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */return null}}class c{constructor(e){this._promiseCache={},this._tracer=e.TraceManager.getTracer(s.COMPONENT_NAMES.ODataExecutor)}contains(e){return this._promiseCache[e]?(this._tracer.info(d()+" Promise in cache"),!0):(this._tracer.info(d()+" Promise not in cache"),!1)}get(e){return this._tracer.info(d()+" --- Get Promise Key"),this._promiseCache[e]}put(e,t){this._tracer.info(d()+" --- Put Promise key"),this._promiseCache[e]=t}remove(e){this._tracer.info(d()+" --- Remove Promise key"),delete this._promiseCache[e]}}function d(e){return e?`[${e}]`:`[${s.FILE_PREFIX.PromiseCache}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class p{constructor(e,t,r,n,a){this._applicationContext=e,this._interceptors=t,this._index=n||0,this._call=0,this.request=r,this.executionContext=a||{}}async proceed(e){if(this._index<this._interceptors.length){e||(e=this.request),this._call+=1;const t=new p(this._applicationContext,this._interceptors,e,this._index+1,this.executionContext),r=this._interceptors[this._index],n=await r.intercept(t);return 1!==t._call&&this._index+1!==this._interceptors.length?Promise.reject(new Error("interceptor "+r.constructor.name+" must call proceed() at least once")):n}return Promise.reject(new Error("Interceptor out of range"))}clone(e){return new p(this._applicationContext,this._interceptors,e||this.request,this._index,this.executionContext)}terminate(){this._call+=1}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class f{constructor(e){this.applicationContext=e,this.tracer=e.TraceManager.getTracer(s.COMPONENT_NAMES.ODataExecutor)}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class y extends f{constructor(e,t,r){super(r),this._retryCount=t,this._policyManager=e}async intercept(e){return await this.executeWithPolicy(e)}async executeWithPolicy(e){let t=e,r=0,n=0;for(;;){await this.timeout(n);const a=t.request;try{const i=await t.proceed();if(!(r<this._retryCount))return i;{const o=this._policyManager.getRetryPolicy(i);if(null==o)return i;{const i=o.action?await o.action(a):a;t=e.clone(i),r++,this.tracer.info(`${this.getPolicyRetryInterceptorPrefix()} Retry with count ${r}`),n=o.delay||0}}}catch(e){const t="Retry with count "+r+" failed";return e.message=e&&e.message?`${e.message}.${t}`:t,this.tracer.info(`${this.getPolicyRetryInterceptorPrefix()} ${t}`),Object(i.d)(e,a.url)}}}getPolicyRetryInterceptorPrefix(e){return e?`[${e}]`:`[${s.FILE_PREFIX.PolicyRetryInterceptor}]`}async timeout(e){return new Promise(t=>{setTimeout(()=>{t()},e)})}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class m extends f{constructor(e,t){super(t),this._promiseCache=e}async intercept(e){const t=e.request;if(this._promiseCache.contains(t.url))return e.terminate(),this._promiseCache.get(t.url);{const r=e.proceed();return this._promiseCache.put(t.url,r),r.then(()=>{this._promiseCache.remove(t.url)},()=>{this._promiseCache.remove(t.url)}),r}}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class h extends f{constructor(e,t){super(t),this._t=e,this._timeout=0,this._eventParameters=[]}intercept(e){this._eventParameters=e.executionContext?e.executionContext.commonEventParameters:this._eventParameters;const t=Promise.race([this.timeOut(),e.proceed()]);return t.then(()=>{clearTimeout(this._timeout)},()=>{clearTimeout(this._timeout)}),t}timeOut(){return new Promise((e,t)=>{this.tracer.info(`${this.getTimeoutInterceptorPrefix()} Set time out with time ${this._t}`);const r=this;this._timeout=window.setTimeout(()=>{this.tracer.error(`${this.getTimeoutInterceptorPrefix()} Timeout with time ${r._t}`,this._eventParameters),t(new Error("request failed with timeout"))},this._t)})}getTimeoutInterceptorPrefix(e){return e?`[${e}]`:`[${s.FILE_PREFIX.TimeoutInterceptor}]`}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class g{constructor(e,t){this.applicationContext=t,this._timeout=e&&e.timeout||3e5,this._policyManager=e&&e.PolicyManager||new l(this.applicationContext),this._retryCount=e&&e.RetryCount||3,this._promiseCache=new c(this.applicationContext),this._customizedInterceptors=[],this.interceptors=[]}build(){return this.interceptors.push(new m(this._promiseCache,this.applicationContext)),this.interceptors.push(new h(this._timeout,this.applicationContext)),this.interceptors=this.interceptors.concat(this._customizedInterceptors),this.interceptors.push(new y(this._policyManager,this._retryCount,this.applicationContext)),this.interceptors.push(this.executeRequestInterceptor),this}describe(){const e=[];return this.interceptors.forEach(t=>{e.push(t.constructor.name)}),e}setExecuteRequestInterceptor(e){return this.executeRequestInterceptor=e,this}addInterceptor(e){return this._customizedInterceptors.push(e),this}execute(e,t){return new p(this.applicationContext,this.interceptors,e,0,t).proceed()}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function E(e){return e?`[${e}]`:`[${s.FILE_PREFIX.FileExecutor}]`}var b=r("MMlZ");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function _(e,t){let r="";t||(t="batch_"+(new Date).getTime());for(let a=0;a<e.length;a++){const i=e[a];r+="--"+t+"\n";let o="";if(Array.isArray(i)){const e=i,s=`changeset_${t}-${a}`;o=await v(s,e),r+=`${n.HEADER.CONTENT_TYPE}: multipart/mixed;boundary=${s}\n`}else{const e=i;o=await T(e),r+=`${n.HEADER.CONTENT_TYPE}: ${n.HEADER_VALUES.APPLICATION_HTTP}\n${n.HEADER.CONTENT_TRANSFER_ENCODING}: ${n.HEADER_VALUES.BINARY}\n`}r+="\n",r+=o,r+="\n"}const a=`--${t}--\r\n\0`;r.endsWith(a+"\n")?r=r.substr(0,r.length-1):r+=a;return function(e,t,r){const a=[];a.concat(e.filter(e=>!e.ok&&e.status!==n.HTTP_STATUS_CODES.Unknown));let i=!0;a.length>0&&(i=!1);const o=new Headers;return o.set(n.HEADER.CONTENT_TYPE,"multipart/mixed;boundary="+r),Object(b.b)(i?n.HTTP_STATUS_CODES.Ok:n.HTTP_STATUS_CODES.InternalServerError,"$batch",o,t)}(e,r,t)}async function v(e,t){let r="",a=1;for(const i of t)r+="--"+e+"\n",r+=`${n.HEADER.CONTENT_TYPE}: ${n.HEADER_VALUES.APPLICATION_HTTP}\n${n.HEADER.CONTENT_TRANSFER_ENCODING}: ${n.HEADER_VALUES.BINARY}\n`,i.ok?r+=`${n.HEADER.CONTENT_ID}: ${a}\n`:r+=`${n.HEADER.CONTENT_ID}: ${i.headers.get(n.HEADER.CONTENT_ID)}`,a++,r+="\n",r+=await T(i),r+="\n";return r+="--"+e+"--\n",r}async function T(e){let t=`HTTP/1.1 ${e.status} ${e.statusText}\n`;if([n.HEADER.REQ_ID,n.HEADER.CONTENT_TYPE,n.HEADER.PREFERENCE_APPLIED,n.HEADER.ODADTA_ENTITY_ID,n.HEADER.LOCATION].forEach(r=>{e.headers.has(r)&&(t+=`${r}: ${e.headers.get(r)}`)}),e.headers.get(n.HEADER.CONTENT_TYPE)===n.HEADER_VALUES.APPLICATION_JSON){const r=await e.json();t+="\n\n"+JSON.stringify(r)}return t}var O=r("HPMC");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function S(e,t,r,o,s,u=[],l){let c;const d=new Headers;r.info(N()+" Processing the retrieve response",u),d.set(n.HEADER.CONTENT_TYPE,n.HEADER_VALUES.APPLICATION_JSON);const p=o;if(p&&p.length>0){const o=await async function(e,t,r,n,i,o=[],s){let u="",l={};const c=[],d=s?s.BPFEntityLogicalName:"";if(!d||0===d.length)return"";c.push({name:"EntityLogicalName",value:d});const p=n[0].rows.item(0);if(p){let r=!1;Object(b.d)(e)&&(r=!0),l=await Object(b.c)(t,p,d,r),t.EventManager.ReportComponentSuccess(N(),Object(a.b)(o,c));const n={};l["@odata.type"]=d,n.GlobalNavigationData=l,i&&(n.Entity=i),n["@odata.context"]=e.url,u=JSON.stringify(n)}return u}(e,t,0,p,s,u,l);Object(i.o)(o)?(r.error(N()+" No response retrieved from offline DB for this request",u),c=Object(b.a)(n.HTTP_STATUS_CODES.Unknown,e.url,new O.a("No response retrieved from offline DB for this request"),d)):c=Object(b.b)(n.HTTP_STATUS_CODES.Ok,e.url,d,o)}else r.error(N()+" No response retrieved from offline DB for this request",u),c=Object(b.a)(n.HTTP_STATUS_CODES.Unknown,e.url,new O.a("No response retrieved from offline DB for this request"),d);return c}function N(e){return e?`[${e}]`:`[${s.FILE_PREFIX.BPFResponseHandler}]`}var R,M=r("cvWF"),A=r("FDNG"),C=r("xiVN");!function(e){e[e.None=0]="None",e[e.UserOwned=1]="UserOwned",e[e.TeamOwned=2]="TeamOwned",e[e.BusinessOwned=4]="BusinessOwned",e[e.OrganizationOwned=8]="OrganizationOwned",e[e.BusinessParented=16]="BusinessParented"}(R||(R={}));async function P(e,t,r,o={}){const u=t.TraceManager.getTracer(s.COMPONENT_NAMES.SQLExecutor),l=o.commonEventParameters||[],c=[];c.push({name:"NoOfSQLStatements",value:e&&e.sqlStatements?e.sqlStatements.length:0}),u.info(I()+" ExecuteSQLBatch - starting ExecuteSQLBatch",Object(a.b)(l,c));let d=null;return r===n.OPERATION.GetClientMetadata?(o.performanceControl&&o.performanceControl.startMarker(s.FILE_PREFIX.MetadataSQLExecutor),d=t.SqlExecutor.ExecuteSqlStatementsOnMetadataDB(e)):(o.performanceControl&&o.performanceControl.startMarker(s.FILE_PREFIX.DataSQLExecutor),d=t.SqlExecutor.ExecuteSqlStatementsOnOfflineDB(e)),d.then(e=>(u.info(I()+" SQL Executor successfully completed",c),o.performanceControl&&(r===n.OPERATION.GetClientMetadata?o.performanceControl.endMarker(s.FILE_PREFIX.MetadataSQLExecutor):o.performanceControl.endMarker(s.FILE_PREFIX.DataSQLExecutor)),Promise.resolve(e))).catch(e=>{const t=Object(i.e)(e),r=t.message;return t.message=Object(a.g)(r),Object(a.a)(e,c),c.push({name:s.EVENT_PARAMETERS.SQL_ERROR_CODE,value:t.code||n.ErrorCode.UnknownUnexpectedGenericError}),c.push({name:s.EVENT_PARAMETERS.SQL_ERROR_MESSAGE,value:r}),u.error(I()+" Error on SQL Executor rejecting with data source offline error code",Object(a.b)(l,c)),Promise.reject(t)})}function I(e){return e?`[${e}]`:`[${s.FILE_PREFIX.SQLExecutor}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */const w="activityid",D=["firstname","middlename","lastname"],F="participationtypemask",L={from:"1",to:"2",cc:"3",bcc:"4",requiredattendees:"5",optionalattendees:"6",organizer:"7",regarding:"8",owner:"9",resources:"10",customer:"11",partner:"12"},k={1:"from",2:"to",3:"cc",4:"bcc",5:"requiredattendees",6:"optionalattendees",7:"organizer",8:"regarding",9:"owner",10:"resources",11:"customer",12:"partner"},x=["createdon","createdby","ownerid","modifiedon","modifiedby"],j=["statecode","statuscode"],U=["modifiedon","modifiedby"];var V=r("TvxW"),q=r("0fKB"),$=r("rfM3");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
const G={};var B,H;G.form=[{metadataType:$.MetadataType.formSelector,uniqueKey:"Id",payloadKey:"FormSelectors"},{metadataType:$.MetadataType.form,uniqueKey:"FormId",payloadKey:"Forms"}],G.savedview=[{metadataType:$.MetadataType.viewSelector,uniqueKey:"ViewId",payloadKey:"ViewSelectors"},{metadataType:$.MetadataType.savedView,uniqueKey:"ViewId",payloadKey:"Views"}],G.workspace=[{metadataType:$.MetadataType.dashboardSelector,uniqueKey:"Id",payloadKey:"DashboardSelectors"},{metadataType:$.MetadataType.form,uniqueKey:"FormId",payloadKey:"Forms"},{metadataType:$.MetadataType.workspace,uniqueKey:"FormId",payloadKey:"Dashboards"},{metadataType:$.MetadataType.interactionCentricWorkspace,uniqueKey:"FormId",payloadKey:"Dashboards"}],G.systemworkspace=[{metadataType:$.MetadataType.dashboardSelector,uniqueKey:"Id",payloadKey:"DashboardSelectors"},{metadataType:$.MetadataType.form,uniqueKey:"FormId",payloadKey:"Forms"},{metadataType:$.MetadataType.workspace,uniqueKey:"FormId",payloadKey:"Dashboards"},{metadataType:$.MetadataType.interactionCentricWorkspace,uniqueKey:"FormId",payloadKey:"Dashboards"}],G.userworkspace=[{metadataType:$.MetadataType.dashboardSelector,uniqueKey:"Id",payloadKey:"DashboardSelectors"},{metadataType:$.MetadataType.form,uniqueKey:"FormId",payloadKey:"Forms"},{metadataType:$.MetadataType.workspace,uniqueKey:"FormId",payloadKey:"Dashboards"},{metadataType:$.MetadataType.interactionCentricWorkspace,uniqueKey:"FormId",payloadKey:"Dashboards"}],G.savedvisualization=[{metadataType:$.MetadataType.visualizationSelector,uniqueKey:"Id",payloadKey:"VisualizationSelectors"},{metadataType:$.MetadataType.savedQueryVisualization,uniqueKey:"Id",payloadKey:"SavedQueryVisualizations"}],function(e){e[e.Unknown=0]="Unknown",e[e.OnDemandWithContext=1]="OnDemandWithContext",e[e.OnDemandWithoutContext=2]="OnDemandWithoutContext",e[e.OnDemandContextOnly=3]="OnDemandContextOnly",e[e.Offline=4]="Offline",e[e.Mobile=5]="Mobile",e[e.UserContext=6]="UserContext"}(B||(B={})),function(e){e[e.None=0]="None",e[e.Slate=1]="Slate",e[e.Phone=2]="Phone",e[e.Desktop=3]="Desktop",e[e.MailApp=4]="MailApp"}(H||(H={}));var Q;!function(e){e.METADATA_TYPE="metadatatype",e.SOURCE_ID="sourceid",e.ASSOCIATED_ENTITY_LOGICAL_NAME="associatedentitylogicalname",e.METADATA_SUBTYPE="metadatasubtype",e.DISPLAY_NAME="displayname",e.JSON="json"}(Q||(Q={}));var X=r("Sh+4");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function z(e,t){switch(e){case"form":return{type:$.MetadataType.form,subtype:W("form",t)};case"workspace":case"systemworkspace":case"userworkspace":return{type:$.MetadataType.workspace,subtype:W(e,"dashboard")};case"formselector":return{type:$.MetadataType.formSelector,subtype:W(e,t)};case"bpfselector":return{type:$.MetadataType.bpfSelector,subtype:$.MetadataSubtype.none};case"dashboardselector":return{type:$.MetadataType.dashboardSelector,subtype:W(e,"dashboard")};case"search":return{type:$.MetadataType.searchConfiguration,subtype:$.MetadataSubtype.none};case"customcontrol":return{type:$.MetadataType.customControl,subtype:$.MetadataSubtype.none};case"resourcestring":return{type:$.MetadataType.resourceString,subtype:$.MetadataSubtype.none};case"visualizationselector":return{type:$.MetadataType.visualizationSelector,subtype:$.MetadataSubtype.none};case"savedvisualization":return{type:$.MetadataType.savedQueryVisualization,subtype:$.MetadataSubtype.none};case"uservisualization":return{type:$.MetadataType.userQueryVisualization,subtype:$.MetadataSubtype.none};case"label":return{type:$.MetadataType.label,subtype:$.MetadataSubtype.none};case"displaystring":return{type:$.MetadataType.displayString,subtype:$.MetadataSubtype.none};case"webresource":return{type:$.MetadataType.webResource,subtype:W(e,t)};case"webresourcedescriptor":return{type:$.MetadataType.webResourceDescriptor,subtype:$.MetadataSubtype.none};case"customcontroldefaultconfig":return{type:$.MetadataType.homePageConfiguration,subtype:$.MetadataSubtype.none};case"optionset":return{type:$.MetadataType.optionSet,subtype:$.MetadataSubtype.none};case"quickcreatemenu":return{type:$.MetadataType.quickCreateMenu,subtype:$.MetadataSubtype.none};case"businessprocessflow":return{type:$.MetadataType.businessProcessFlow,subtype:$.MetadataSubtype.none};case"dialog":return{type:$.MetadataType.dialog,subtype:$.MetadataSubtype.none};case"taskbasedflow":return{type:$.MetadataType.taskBasedFlow,subtype:$.MetadataSubtype.none};case"taskbasedflowglobalmenu":return{type:$.MetadataType.taskBasedFlowGlobalMenu,subtype:$.MetadataSubtype.none};case"sitemap":return{type:$.MetadataType.siteMap,subtype:$.MetadataSubtype.none};case"viewselector":return{type:$.MetadataType.viewSelector,subtype:W(e,t)};case"savedview":return{type:$.MetadataType.savedView,subtype:W(e,t)};case"userview":return{type:$.MetadataType.userView,subtype:W(e,t)};case"ribbon":return{type:$.MetadataType.command,subtype:$.MetadataSubtype.none};case"appmodules":return{type:$.MetadataType.appModule,subtype:$.MetadataSubtype.none};case"appmoduleselector":return{type:$.MetadataType.appModuleSelector,subtype:$.MetadataSubtype.none};case"metadataversion":return{type:$.MetadataType.overallMetadataVersion,subtype:$.MetadataSubtype.none};case"complexcontrol":return{type:$.MetadataType.complexControl,subtype:$.MetadataSubtype.none};case"isactivityflags":return{type:$.MetadataType.isActivityFlags,subtype:$.MetadataSubtype.none};case"appmoduleofflinemetadata":return{type:$.MetadataType.appModuleOfflineMetadata,subtype:$.MetadataSubtype.none};case"dependencies":return{type:$.MetadataType.dependencies,subtype:$.MetadataSubtype.none};default:return{type:$.MetadataType.none,subtype:$.MetadataSubtype.none}}}function W(e,t){let r;switch(e){case"form":case"formselector":case"dashboardselector":r=function(e){let t=$.MetadataSubtype.none;if(!Object(i.m)(e))switch(e.toLowerCase()){case"appointmentbook":t=$.MetadataSubtype.appointment;break;case"hardcoded":t=$.MetadataSubtype.hardcoded;break;case"main":t=$.MetadataSubtype.main;break;case"minicampaignbo":t=$.MetadataSubtype.miniCampaignBO;break;case"preview":t=$.MetadataSubtype.preview;break;case"dashboard":t=$.MetadataSubtype.dashboard;break;case"quick":t=$.MetadataSubtype.quick;break;case"mobile":t=$.MetadataSubtype.mobile;break;case"read":t=$.MetadataSubtype.read;break;case"quickcreate":t=$.MetadataSubtype.quickCreate;break;case"dialog":t=$.MetadataSubtype.dialog;break;case"card":t=$.MetadataSubtype.card;break;case"taskbasedform":t=$.MetadataSubtype.taskBased;break;case"interactioncentricdashboard":t=$.MetadataSubtype.interactionCentricDashboard;break;default:t=$.MetadataSubtype.none}return t}(t);break;case"viewselector":case"savedview":case"userview":r=function(e){let t=$.MetadataSubtype.none;if(!Object(i.m)(e))switch(e.toUpperCase()){case"MAIN_APPLICATION_VIEW":t=$.MetadataSubtype.main;break;case"ADVANCED_SEARCH":t=$.MetadataSubtype.advancedSearch;break;case"SUB_GRID":t=$.MetadataSubtype.subGrid;break;case"QUICKFIND_SEARCH":t=$.MetadataSubtype.quickFindSearch;break;case"REPORTING":t=$.MetadataSubtype.reporting;break;case"OFFLINE_FILTERS":t=$.MetadataSubtype.offlineFilters;break;case"MA_SEARCH":t=$.MetadataSubtype.maSearch;break;case"LOOKUP_VIEW":t=$.MetadataSubtype.lookup;break;case"SM_APPOINTMENTBOOK_VIEW":t=$.MetadataSubtype.smAppointmentBook;break;case"OUTLOOK_FILTERS":t=$.MetadataSubtype.outlookFilters;break;case"ADDRESSBOOK_FILTERS":t=$.MetadataSubtype.addressbookFilters;break;case"SAVEDQUERYTYPE_OTHER":t=$.MetadataSubtype.savedQueryTypeOther;break;case"INTERACTIVE_WORKFLOW_VIEW":t=$.MetadataSubtype.interactiveWorkFlow;break;case"OFFLINE_TEMPLATE":t=$.MetadataSubtype.offlineTemplate;break;case"OUTLOOK_TEMPLATE":t=$.MetadataSubtype.outlookTemplate;break;case"CUSTOM_DEFINED_VIEW":t=$.MetadataSubtype.customDefined;break;default:t=$.MetadataSubtype.none}return t}(t);break;case"workspace":case"systemworkspace":case"userworkspace":r=$.MetadataSubtype.dashboard;break;case"webresource":r=function(e){let t=0;if(!Object(i.m)(e))switch(e.toUpperCase()){case"HTML":t=10;break;case"CSS":t=6;break;case"JSCRIPT":t=5;break;case"XML":t=11;break;case"PNG":t=7;break;case"JPG":t=8;break;case"RESX":t=12;break;case"GIF":case"SILVERLIGHT":case"XSL":case"ICO":default:t=0}return t}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */(t);break;default:r=$.MetadataSubtype.none}return r}class Y{constructor(e){if(Object(i.o)(e))throw new Error("Undefined path parameter to KeyPath");this._path=e}static get_id(){return Y._id}get_path(){return this._path}}Y._id=new Y("id");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
const K=new Y(Q.METADATA_TYPE),J=(new Y(Q.SOURCE_ID),new Y(Q.METADATA_TYPE+i.a+Q.SOURCE_ID)),Z=new Y(Q.METADATA_TYPE+i.a+Q.ASSOCIATED_ENTITY_LOGICAL_NAME),ee=new Y(Q.METADATA_TYPE+i.a+Q.METADATA_SUBTYPE+i.a+Q.ASSOCIATED_ENTITY_LOGICAL_NAME),te=new Y(Q.METADATA_TYPE+i.a+Q.DISPLAY_NAME);
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class re{constructor(e,t,r,n,a,o,s,u){if(this._metadataType=0,this._metadataSubtype=0,this._formFactor=0,this._isDefault=!1,this._applicationMetadataType=0,this._isDefaultSpecified=!1,!e)throw new Error("Invalid application metadata type");this._metadataType=e,this._formFactor=t,this._associatedEntityLogicalName=r,this._applicationMetadataType=Object(i.m)(n)?$.ApplicationMetadataType.systemApplicationMetadata:n,this._isDefaultSpecified=!Object(i.m)(a),this._isDefault=!!this._isDefaultSpecified&&a,this._sourceId=o||"",this._metadataSubtype=s||0,this._normalizedDisplayName=u||""}checkApplicationMetadata(e){return(!this.get_metadataType()||e.metadatatype===this.get_metadataType())&&(!(!Object(i.m)(this.get_metadataSubtype())&&this.get_metadataSubtype()!==$.MetadataSubtype.none&&e.metadatasubtype!==this.get_metadataSubtype())&&(!(!Object(i.o)(this.get_sourceId())&&e.sourceid!==this.get_sourceId())&&(!(!Object(i.o)(this.get_associatedEntityLogicalName())&&e.associatedentitylogicalname!==this.get_associatedEntityLogicalName())&&(!(this.get_formFactor()>0&&e.formfactor!==this.get_formFactor())&&(!(this._isDefaultSpecified&&this._isDefault&&Object(i.m)(e.isdefault||!e.isdefault))&&(!(this._applicationMetadataType===$.ApplicationMetadataType.userApplicationMetadata&&!e.isuserrecord)&&!(!Object(i.o)(this.get_normalizedDisplayName())&&this.get_normalizedDisplayName()!==e.displayname.toUpperCase())))))))}get_keyPath(){return Object(i.o)(this.get_sourceId())?Object(i.o)(this.get_normalizedDisplayName())?Object(i.o)(this.get_associatedEntityLogicalName())||Object(i.m)(this.get_metadataSubtype())?Object(i.o)(this.get_associatedEntityLogicalName())?K:Z:ee:te:J}get_keyValue(){const e=this.get_metadataType().toString(),t=this.get_keyPath();if(t===J)return e+i.a+this.get_sourceId();if(t===Z)return e+i.a+this.get_associatedEntityLogicalName();if(t===ee){const t=this.get_metadataSubtype().toString();return e+i.a+t+i.a+this.get_associatedEntityLogicalName()}return t===te?e+i.a+this.get_normalizedDisplayName():this.get_metadataType()}get_metadataType(){return this._metadataType}get_metadataSubtype(){return this._metadataSubtype}get_formFactor(){return this._formFactor}get_associatedEntityLogicalName(){return this._associatedEntityLogicalName}get_sourceId(){return this._sourceId}get_normalizedDisplayName(){return this._normalizedDisplayName}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function ne(e,t,r,n,a,o){let s="";e=Object(i.m)(e)?"":e,r=Object(i.m)(r)?"":r,n=Object(i.m)(n)?"":n,o=Object(i.m)(o)?"":o;const u=Object(i.m)(a)?"":a.toString();switch(t){case $.MetadataType.overallMetadataVersion:s="applicationmetadataversionstamp";break;case $.MetadataType.quickCreateMenu:s=`${t}_quickcreatemenu_${o}`;break;case $.MetadataType.searchConfiguration:s=t+"_searchconfiguration";break;case $.MetadataType.taskBasedFlowGlobalMenu:s=t+"_taskbasedflowglobalmenu";break;case $.MetadataType.siteMap:s=`${t}_sitemap_${o}`;break;case $.MetadataType.appModule:s=`${t}_appmodules_${o}`;break;case $.MetadataType.appModuleOfflineMetadata:s=t+"_appmoduleofflinemetadata";break;case $.MetadataType.taskBasedFlow:case $.MetadataType.customControl:case $.MetadataType.resourceString:case $.MetadataType.complexControl:s=`${t}_${n}`;break;case $.MetadataType.dialog:s=`${t}_${n.toLowerCase()}`;break;case $.MetadataType.label:s=`${t}_${r}_${n}`;break;case $.MetadataType.homePageConfiguration:s=`${t}_${e}`;break;case $.MetadataType.optionSet:s=`${t}_${Object(i.o)(r)?n:r}`;break;case $.MetadataType.appModuleSelector:s=`${t}_${u}`;break;case $.MetadataType.viewSelector:case $.MetadataType.formSelector:case $.MetadataType.dashboardSelector:case $.MetadataType.visualizationSelector:s=`${t}_${e}_${u}_${o}`;break;case $.MetadataType.bpfSelector:s=`${t}_${e}_${o}`;break;case $.MetadataType.command:s=`${t}_${n}_${e}`;break;case $.MetadataType.isActivityFlags:case $.MetadataType.webResource:case $.MetadataType.webResourceDescriptor:s=`${t}_${n}`;break;case $.MetadataType.businessProcessFlow:case $.MetadataType.form:case $.MetadataType.savedQueryVisualization:case $.MetadataType.displayString:default:s=`${t}_${r}`}return s}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function ae(e,t,r,n=[]){const o=[];o.push({name:"ClientMetadataQuery",value:JSON.stringify(r)});try{const o=await async function(e,t,r,n=[]){const o=z(r.MetadataType,r.MetadataSubtype),s=o.subtype,u=o.type;let l="";r.MetadataId&&(l=r.MetadataId.toString());if(r.MetadataType===$.QueriedMetadataType.entity)return function(e,t){const r=t.MetadataSubtype.replace(/\\\"/g,'"'),n=JSON.parse(r),a=[];for(const t of Object.keys(n))a.push(Object(C.d)(e,t));return Promise.all(a)}(e,r);if(r.MetadataType===$.QueriedMetadataType.savedView||r.MetadataType===$.QueriedMetadataType.form||r.MetadataType===$.QueriedMetadataType.workspace||r.MetadataType===$.QueriedMetadataType.systemWorkspace||r.MetadataType===$.QueriedMetadataType.userWorkspace||r.MetadataType===$.QueriedMetadataType.savedVisualization)return async function(e,t,r,n=[]){const a=G[r.MetadataType];if(!Object(i.m)(r.MetadataId)||r.MetadataNames&&r.MetadataNames.length){if(B[r.DependencyDepth]===B.OnDemandWithContext)return Promise.all(oe(e,t,r,a,n)).then(e=>ue(t,e,a,n));{const i=a.slice(1,a.length),o=se(e,r,i);return Promise.all(o).then(e=>ue(t,e,i,n))}}if(Object(i.m)(r.GetDefault)||!r.GetDefault)throw new Error("A query with empty MetadataId and non-true GetDefault parameters is considered invalid.");if(Object(i.m)(r.EntityLogicalName)&&r.MetadataType!==$.QueriedMetadataType.workspace&&r.MetadataType!==$.QueriedMetadataType.systemWorkspace&&r.MetadataType!==$.QueriedMetadataType.userWorkspace)throw new Error("This query requests defaults and/or selectors, but does not specify the context. This query is considered invalid.");return Promise.all(oe(e,t,r,a,n)).then(e=>{if(Object(i.m)(e)||e.length<2)throw new Error("The local store does not contain metadata fragments or selectors for the specified query.");const t=e[0][0],n=a[0],o=function(e){const t=e.data.SelectorItems;if(!Object(i.m)(t)&&t.length>0){for(let e=0;e<t.length;e++){const r=t[e];if(r.IsDefault)return r}return t[0]}return{}}(t);if(Object(i.m)(o))throw new Error("The default selector item cannot be found.");const s=[];for(let t=1;t<e.length;++t){const r=e[t],i=a[t];for(let e=0;e<r.length;e++){const t=r[e];o[n.uniqueKey]===t.data[i.uniqueKey]&&s.push(t)}}return B[r.DependencyDepth]===B.OnDemandWithContext&&s.push(t),s})}(e,t,r,n);if(r.MetadataType===$.QueriedMetadataType.dialog||r.MetadataType===$.QueriedMetadataType.taskBasedFlow)return async function(e,t,r,n,o=[]){const s=[];let u=[];if(!Object(i.m)(r.MetadataNames)&&r.MetadataNames.length>0){const i=r.MetadataNames;for(let r=0;r<i.length;++r){const l=ne("",t,"",i[r]),c=await Nt(e,l);if(u=[],u.push({name:"MetadataType",value:$.MetadataType[t]}),u.push({name:"DialogKey",value:l}),c){s.push(c);const r=c.data.FormId,i=ne("",$.MetadataType.form,r,""),d=await Nt(e,i);d?s.push(d):(u.push({name:"FormKey",value:i}),n.warn(`${le()} Unable to find dependent form metadata for dialog: ${l} form: ${i} for type ${$.MetadataType[t]}`,Object(a.b)(o,u)))}else n.error(`${le()} Unable to find the dialog root ${l} for type ${$.MetadataType[t]}`,Object(a.b)(o,u))}}else n.error(le()+" Dialog metadata requested without MetadataNames",Object(a.b)(o,u));return s}(e,u,r,t,n);if((u===$.MetadataType.resourceString||u===$.MetadataType.label)&&r.MetadataNames&&r.MetadataNames.length>0)return async function(e,t,r,n,o=[]){let s=[];r.MetadataNames=function(e){e.sort();const t=[];let r="";for(const n of e)n!==r&&(r=n,t.push(n));return t}(r.MetadataNames);const u=[];for(const e of r.MetadataNames)if(s=[],t===$.MetadataType.label){const r=e.split(":");r&&2===r.length?u.push(ne("",t,r[0],r[1])):(s.push({name:"MetadataName",value:e}),n.error(`${le()} Invalid label name ${e}`,Object(a.b)(o,s)))}else u.push(ne("",t,"",e));const l=t===$.MetadataType.resourceString;if(0===u.length)return[];{const c=await async function(e,t,r){const n=[];let a="";for(let e=0;e<r.length;e++)a+=" ?,";a.length>0&&(a=a.substr(0,a.length-1));const o={sqlStatements:[],sqlParameters:[]},s=`SELECT ${Q.JSON} FROM applicationmetadata WHERE ${t.get_path()} IN (${a})`;o.sqlStatements.push(s),o.sqlParameters.push([...r]);const u=await Object(q.a)(e,o);if(Mt(e,u),!Object(i.m)(u)&&u.length>0)for(let e=0;e<u[0].rows.length;e++){const t=JSON.parse(u[0].rows.item(e)[Q.JSON]);n.push(t)}return n}(e,Y.get_id(),u);if(l&&c.length!==u.length){const e=function(e,t){const r=t.filter(e=>e).map(e=>e.data.Key);let n="";for(const t of e.MetadataNames){let e=!1;for(const n of r)if(t===n){e=!0;break}e||(n=Object(i.o)(n)?t:n+", "+t)}return n}(r,c);s.push({name:"MissingKeys",value:e}),n.error(`${le()} Not able to find ${u.length-c.length} keys out of ${u.length} of type ${$.MetadataType[t]}, Missing Keys ${e}`,Object(a.b)(o,s))}return c}}(e,u,r,t,n);if((u===$.MetadataType.optionSet||u===$.MetadataType.webResource||u===$.MetadataType.webResourceDescriptor||u===$.MetadataType.complexControl)&&r.MetadataNames&&r.MetadataNames.length>0)return async function(e,t,r,n,o=[]){const s=[];for(const u of r.MetadataNames){const l=ne(r.EntityLogicalName,t,"",u),c=[];c.push({name:"MetadataIdString",value:l});try{const r=await Nt(e,l);c.push({name:"MetadataType",value:$.MetadataType[t]}),Object(i.n)(r)?n.error(`${le()} Not able to find some of the keys for type ${$.MetadataType[t]} ${l}`,Object(a.b)(o,c)):s.push(r)}catch(e){throw n.error(`${le()} ${e.message||"Failed to Retrieve resource metadata"}`,Object(a.b)(o,c)),e}}return s}(e,u,r,t,n);if(u===$.MetadataType.command&&r.MetadataNames&&r.MetadataNames.length>0)return async function(e,t,r,n=[]){const o=ne(t.EntityLogicalName,$.MetadataType.command,"",t.MetadataNames[0]),s=[];s.push({name:"MetadataIdString",value:o});try{const t=await Nt(e,o);return Object(i.n)(t)?(r.error(`${le()} Not able to find the key ${o} for type ${$.MetadataType[$.MetadataType.command]}`,Object(a.b)(n,s)),[]):[t]}catch(e){throw r.error(`${le()} Error when retrieving command metadata ${t.MetadataNames[0]}`,Object(a.b)(n,s)),e}}(e,r,t,n);if(u!==$.MetadataType.appModule||Object(i.o)(l)){if(u===$.MetadataType.appModuleOfflineMetadata)return async function(e,t,r=[]){const n=ne("",$.MetadataType.appModuleOfflineMetadata,"","",0);try{const t=await Nt(e,n);return t?[t]:[]}catch(e){throw t.error(`${le()} Error when attempting to retrieve application metadata for type ${$.MetadataType[$.MetadataType.appModuleOfflineMetadata]} ${n} ${e.message}`,r),e}}(e,t,n);if(!Object(i.o)(l)||u!==$.MetadataType.resourceString&&r.MetadataNames&&r.MetadataNames.length>0||u===$.MetadataType.taskBasedFlowGlobalMenu||u===$.MetadataType.quickCreateMenu||u===$.MetadataType.searchConfiguration||u===$.MetadataType.siteMap)return async function(e,t,r,n,o=[]){let s="";const u=[];r.MetadataId&&(s=r.MetadataId.toString());const l=r.AppId&&r.AppId!==X.LegacyGuid.get_empty().toString()?r.AppId.toString():void 0;s=ne(r.EntityLogicalName,t,s,Object(i.m)(r.MetadataNames)?"":r.MetadataNames[0],0,l),u.push({name:"MetadataIdString",value:s}),u.push({name:"AppId",value:l||""});try{const r=await Nt(e,s);return Object(i.n)(r)?(n.error(`${le()} Not able to find the key ${s} for type ${$.MetadataType[t]}`,Object(a.b)(o,u)),[]):[r]}catch(e){throw n.error(`${le()} Error when attempting to retrieve application metadata for type ${$.MetadataType[t]} ${s} ${e.message}`,Object(a.b)(o,u)),e}}(e,u,r,t,n);if(u===$.MetadataType.isActivityFlags)return async function(e,t,r=[]){const n=ne("",$.MetadataType.isActivityFlags,"","entitydefinitionstype"),o=[];o.push({name:"MetadataIdString",value:n});try{const s=await Nt(e,n);if(Object(i.n)(s)){const e=`GetClientMetadata: Not able to find the key ${n} for type ${$.MetadataType[$.MetadataType.isActivityFlags]}`;throw t.error(`${le()} ${e}`,Object(a.b)(r,o)),new Error(e)}return[s]}catch(e){throw t.error(`${le()} Error when retrieving activity flag metadata. ${e.message}`,Object(a.b)(r,o)),e}}(e,t,n);if(u===$.MetadataType.viewSelector)return async function(e,t,r,n,o,s=[]){const u=[],l=n.AppId&&n.AppId!==X.LegacyGuid.get_empty().toString()?n.AppId.toString():n.MetadataId?n.MetadataId.toString():void 0,c=ne(n.EntityLogicalName,$.MetadataType.viewSelector,"","",r,l);u.push({name:"MetadataIdString",value:c}),u.push({name:"AppId",value:l||""});try{const r=await Nt(e,c);return Object(i.n)(r)?(o.error(`${le()} Not able to find the key ${c} for type ${$.MetadataType[t]}`,Object(a.b)(s,u)),[]):[r]}catch(e){throw o.error(`${le()} Error when retrieving view selector metadata for entity ${n.EntityLogicalName} and appid ${l}. ${e.message}`,Object(a.b)(s,u)),e}}(e,u,s,r,t,n);if(u===$.MetadataType.homePageConfiguration)return async function(e,t,r,n=[]){const o=ne(t.EntityLogicalName,$.MetadataType.homePageConfiguration,"","",0,""),s=[];s.push({name:"MetadataIdString",value:o});try{const t=await Nt(e,o);return Object(i.n)(t)?(r.error(`${le()} Not able to find the key ${o} for type ${$.MetadataType[$.MetadataType.homePageConfiguration]}`,Object(a.b)(n,s)),[]):[t]}catch(e){throw r.error(`${le()} Error when retrieving home page configuration metadata. ${e.message}`,Object(a.b)(n,s)),e}}(e,r,t,n);if(u===$.MetadataType.none&&s===$.MetadataSubtype.none&&Object(i.o)(r.EntityLogicalName)&&B[r.DependencyDepth]===B.UserContext){return[{userid:A.Guid.EMPTY}]}return async function(e,t,r,n,a,i=[]){let o="";n.MetadataId&&(o=n.MetadataId.toString());const s=new re(t,H.Desktop,n.EntityLogicalName,0,n.GetDefault,o,r,void 0);try{const r=await Rt(e,s);return r&&r.length?r:(a.warn(`${le()} Not able to find the key ${o} for type ${$.MetadataType[t]}`,i),[])}catch(e){throw a.error(`${le()} error retrieving metadata by query for ${o}. ${e.message}`,i),e}}(e,u,s,r,t,n)}return async function(e,t,r,n=[]){const o=t.AppId&&t.AppId!==X.LegacyGuid.get_empty().toString()?t.AppId.toString():t.MetadataId.toString(),s=ne(t.EntityLogicalName,$.MetadataType.appModule,Object(i.o)(t.MetadataId)?"":t.MetadataId.toString(),Object(i.m)(t.MetadataNames)?"":t.MetadataNames[0],0,o),u=[];u.push({name:"MetadataIdString",value:s});try{const t=await Nt(e,s);return Object(i.n)(t)?(r.error(`${le()} Not able to find the key ${s} for type ${$.MetadataType[$.MetadataType.appModule]}`,Object(a.b)(n,u)),[]):[t]}catch(e){throw r.error(`${le()} Error when retrieving app module metadata for appID: ${o}. ${e.message}`,Object(a.b)(n,u)),e}}(e,r,t,n)}(e,t,r,n);return function(e,t,r,n=[]){const a={};for(const r of t)if(Array.isArray(r))for(const t of r)ie(e,t,a,n);else ie(e,r,a,n);return e.info(`${le()} found ${Object.keys(a).length} root nodes for ${r.MetadataType}:${r.MetadataSubtype}`),a}(t,o,r,n)}catch(e){Object(a.a)(e,o),t.error(le()+" Error when attempting to find root nodes.",Object(a.b)(n,o))}return{}}function ie(e,t,r,n=[]){let a="",o="",s=$.MetadataType.none,u=!0;if(function(e){return Object.keys(e).indexOf("metadatatype")>=0}(t))s=(t=t).metadatatype,o=t.id,Object(i.o)(t.sourceid)||(u=!1,a=t.sourceid);else if(function(e){return Object.keys(e).indexOf("userid")>=0}(t))o="contextkey",s=$.MetadataType.userContext;else{if(t=t,Object(i.m)(t.Id))return void e.error(le()+" Entity Descriptor with missing ID found",n);o=Object(i.m)(t.EntityLogicalName)?"":t.EntityLogicalName,s=$.MetadataType.entity}r[o]={dependenciesFetched:u,queryGenerated:!1,sourceId:a,id:o,metadataType:s}}function oe(e,t,r,n,a=[]){const o=W(r.MetadataType,r.MetadataSubtype),s=n[0];let u=[];if(Object(i.m)(r.EntityLogicalName)&&r.MetadataType!==$.QueriedMetadataType.workspace&&r.MetadataType!==$.QueriedMetadataType.systemWorkspace&&r.MetadataType!==$.QueriedMetadataType.userWorkspace){const t=Rt(e,new re(s.metadataType,H.Desktop,"",0,!1,"",o));u.push(t)}else{const n=ne(r.EntityLogicalName,s.metadataType,"","",o,r.AppId&&r.AppId!==X.LegacyGuid.get_empty().toString()?r.AppId.toString():void 0);u.push(async function(e,t,r,n,a=[]){try{const o=await Nt(e,r);return Object(i.n)(o)?(t.error(`${le()} Not able to find the key ${r} for type ${$.MetadataType[n]}`,a),[]):[o]}catch(e){throw t.error(`${le()} Error when retrieving application metadata for id ${r}. ${e.message}`,a),e}}(e,t,n,s.metadataType,a))}return u=se(e,r,n.slice(1,n.length),u),u}function se(e,t,r,n){Object(i.m)(n)&&(n=[]);const a=W(t.MetadataType,t.MetadataSubtype);for(let i=0;i<r.length;++i){const o=r[i].metadataType,s=t.MetadataId?new re(o,H.Desktop,t.EntityLogicalName,0,!1,t.MetadataId.toString()):new re(o,H.Desktop,t.EntityLogicalName,0,!1,void 0,a);n.push(Rt(e,s))}return n}function ue(e,t,r,n=[]){let o=[];if(Object(i.m)(t)||!t.length)return e.error(le()+" The local store does not contain metadata fragments or selectors for the specified query.",Object(a.b)(n,o)),[];const s=[],u=[];for(let e=0;e<t.length;++e){const n=t[e],a=r[e];for(let e=0;e<n.length;e++){const t=n[e];s.push(t),u.push(a.payloadKey)}}for(let t=0;t<r.length;++t){const i=r[t];if(o=[],o.push({name:"PayLoadKey",value:i.payloadKey}),-1===u.indexOf(i.payloadKey)){const t=new Error(`The local store does not contain ${i.payloadKey} requested metadata.`);throw e.warn(`${le()} ${t.message}`,Object(a.b)(n,o)),t}}return s}function le(e){return e?`[${e}]`:`[${s.FILE_PREFIX.RootFinder}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function ce(e,t,r,n={}){const a=n.commonEventParameters||[],o=de(e,r,a),s=await ae(t,r,o,a);r.info(`${he()} found root nodes ${Object.keys(s)} for ${o.MetadataType}`);const u=t.AdditionalParameters&&t.AdditionalParameters.EnableDependency;if(u&&-1!==[$.QueriedMetadataType.form.toString(),$.QueriedMetadataType.entity.toString()].indexOf(o.MetadataType))for(;fe(s);)await pe(t,s,o.EntityLogicalName,r,n);return Object(i.n)(s)?{sqlStatements:[],sqlParameters:[]}:await function(e,t,r=[],n){const a={sqlStatements:[],sqlParameters:[]},o=[];for(const s in e)if(!Object(i.m)(e[s])){const i=e[s];n?me(i,a,t,r):ye(i,a,o,t,r)}t.info(`${he()} Returning ${a.sqlStatements.length} queries`),Object(i.m)(a.additionalParameters)&&(a.additionalParameters={});return a.additionalParameters[Q.METADATA_TYPE]=o,a}(s,r,a,u)}function de(e,t,r=[]){const n=[],o=e.url.match(/@ClientMetadataQuery=(.*\})/i);if(n.push({name:"url",value:e.url}),Object(i.m)(o)){const e="URL does not have a ClientMetadataQuery param";throw t.error(`${he()} ${e}`,Object(a.b)(r,n)),new Error(e)}return JSON.parse(decodeURIComponent(o[1]))}async function pe(e,t,r,a,o={}){const s=Object.keys(t).filter(e=>!t[e].dependenciesFetched),u=s.map(e=>ne(r,$.MetadataType.dependencies,t[e].sourceId,"")),l=await async function(e,t,r,a={}){const o={sqlStatements:[],sqlParameters:[]},s=[],u=Object(i.o)(r)?Y.get_id().get_path():r;for(const e of t)Ot(o,u,e);const l=await P(o,e,n.OPERATION.GetClientMetadata,a);Mt(e,l);for(const e of l)e.rows.length>0&&s.push(JSON.parse(e.rows.item(0)[Q.JSON]));return s}(e,u,void 0,o);if(l.length<u.length){const e=l.map(e=>e.id),t=u.filter(t=>-1===e.indexOf(t));a.info(`${he()} Some requested nodes do not have dependency records ${t}`)}for(const e of s)t[e].dependenciesFetched=!0;for(const e in l)if(!Object(i.n)(l[e])&&!Object(i.n)(l[e].data)){const r=l[e];for(const e of r.data.children)t.hasOwnProperty(e)||(t[e]={dependenciesFetched:!1,queryGenerated:!1,sourceId:e,metadataType:$.MetadataType.none})}}function fe(e){return Object.keys(e).some(t=>!e[t].dependenciesFetched)}function ye(e,t,r,n,a=[]){e.metadataType===$.MetadataType.userContext?(r.push(e.metadataType),t.sqlStatements.push(`SELECT ${Q.JSON} FROM usercontext WHERE id = ?`),t.sqlParameters.push([e.id?e.id:"contextkey"])):e.metadataType===$.MetadataType.entity?Object(i.o)(e.id)?n.warn(he()+" No ID found for candidate of type entity metadata. Skipping query generation",a):(r.push(e.metadataType),t.sqlStatements.push(`SELECT id, ${Q.JSON} FROM [entitymetadata] WHERE [logicalname] = ?`),t.sqlParameters.push([e.id])):Object(i.o)(e.id)?n.warn(`${he()} Invalid candidate - no ID found for candidate ${e.metadataType}. Skipping query generation`,a):(r.push(e.metadataType),t.sqlStatements.push(`SELECT ${Q.METADATA_TYPE}, ${Q.JSON} FROM applicationmetadata WHERE id = ?`),t.sqlParameters.push([e.id]))}function me(e,t,r,n=[]){e.metadataType===$.MetadataType.userContext?(t.sqlStatements.push(`SELECT ${Q.JSON} FROM usercontext WHERE id = ?`),t.sqlParameters.push([e.id?e.id:"contextkey"])):Object(i.o)(e.sourceId)?Object(i.o)(e.id)?r.error(`${he()} Invalid candidate - no ID or source ID for candidate ${e.metadataType}. Skipping query generation`,n):(t.sqlStatements.push(`SELECT ${Q.METADATA_TYPE}, ${Q.JSON} FROM metadatadependency WHERE id = ? AND ${Q.METADATA_TYPE} <> ?`),t.sqlParameters.push([e.id,$.MetadataType.dependencies.toString()])):(t.sqlStatements.push(`SELECT ${Q.METADATA_TYPE}, ${Q.JSON} FROM metadatadependency WHERE id = ? AND ${Q.METADATA_TYPE} <> ?`),t.sqlParameters.push([e.sourceId,$.MetadataType.dependencies.toString()]))}function he(e){return e?`[${e}]`:`[${s.FILE_PREFIX.GCMGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
async function ge(e,t,r,n,a){const o=await async function(e,t,r){const n=await Object(C.b)(r,e,[]);let a=null;const o=[];o.push("createdby"),o.push("modifiedby"),o.push("createdonbehalfbyname"),o.push("modifiedonbehalfbyname");for(const e of Object.keys(n)){const r=n[e];if(!(o.indexOf(r.LogicalName)>=0)&&(r.Type===M.AttributeType.Lookup&&!Object(i.m)(r.Targets)&&1===r.Targets.length&&r.Targets[0]===t)){if(!r.IsCustomAttribute){a=r;break}r.LogicalName.startsWith("bpf_")&&(Object(i.m)(a)||a.ColumnNumber&&r.ColumnNumber&&a.ColumnNumber>r.ColumnNumber)&&(a=r)}}if(Object(i.m)(a))throw Error("OfflineDataStore.getEntityIdAttributeFromBpfEntity.Fail : Cannot find an attribute that matches the lookup target in the entity ");return a.LogicalName}(t,e.entityLogicalName,r),s=`${V.c.where} ${V.n.openSQBracket}${o+"!id"}${V.n.closeSQBracket} ${V.n.equal} ${V.n.question} ${V.c.orderBy} modifiedon ${V.q.DESC}`,u=await Ee(t,s,[e.id.guid],r);if(!Object(i.m)(u.rows)&&u.rows.length>0){n.info(`${ve()} BPF data present for ${t}`,a);return be(t,u.rows.item(0),r,a)}return n.info(`${ve()} No BPF instance found for ${t}`,a),null}async function Ee(e,t,r,a){const o=`${V.c.select} ${V.n.asterisk} ${V.c.from} ${e} ${t}`,s={sqlStatements:[],sqlParameters:[]};s.sqlStatements.push(o),s.sqlParameters.push(r);const u=await P(s,a,n.OPERATION.Retrieve);if(!Object(i.m)(u)&&u.length>0)return u[0];throw new Error("results is null")}async function be(e,t,r,n){if(!Object(i.m)(t))try{const a=await Object(C.d)(r,e,n),i=a.PrimaryIdAttribute?a.PrimaryIdAttribute:"",o=A.Guid.tryParse(t["processid!id"]);return{entityLogicalName:e,id:o,modifiedon:new Date(t.modifiedon),primaryIdAttribute:i,primaryIdValue:A.Guid.tryParse(t[i])}}catch(e){throw new Error("Error when forming a BPF record")}throw new Error("Error when forming a BPF record")}async function _e(e,t,r,n=[]){const a=z(t.MetadataType,t.MetadataSubtype),i=a.subtype,o=a.type;let s="";t.MetadataId&&(s=t.MetadataId.toString());const u=new re(o,H.Desktop,t.EntityLogicalName,0,t.GetDefault,s,i,void 0);try{const t=await Rt(e,u);return t&&t.length?t:(r.warn(`${ve()} Not able to find the key ${s} for type ${$.MetadataType[o]}`,n),[])}catch(e){throw r.error(`${ve()} error retrieving metadata by query for ${s}. ${e.message}`,n),e}}function ve(e){return e?`[${e}]`:`[${s.FILE_PREFIX.RetrieveGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function Te(e,t,r,n,a,o,s){try{const u=await async function(e,t,r,n,a){if(!await Object(C.k)(r,"EnableBPFOffline")||!t||Object(i.m)(e))return null;const o=await async function(e,t,r){const n={target:{entityLogicalName:"",id:A.Guid.EMPTY},processId:A.Guid.EMPTY,processInstanceId:A.Guid.EMPTY};if(Object(i.m)(e.url.match("/api/data/(.*)/RetrieveProcessControlData"))||-1===e.url.indexOf("?"))throw new Error("Incorrect BPF request url");const a=e.url.split(/\?(.+)/),o=a[0].match(/\/api\/data\/.*\/RetrieveProcessControlData\((.*)\)/);if(!o||o.length<2)throw new Error("Incorrect BPF request url");const s=o[1].split(","),u={};for(const e of s){const t=e.split("=");u[t[0]]=t[1]}const l=new URLSearchParams(a[1]),c=l.get(u.ProcessId);c&&(n.processId=A.Guid.tryParse(c));const d=l.get(u.ProcessInstanceId);d&&(n.processInstanceId=A.Guid.tryParse(d));const p=l.get(u.Target);if(p){const e=p.split(":")[1].match(/\"(.*)\((.*)\)\"/);e&&3===e.length&&(n.target.entityLogicalName=await Object(C.c)(t,e[1],r),n.target.id=A.Guid.tryParse(e[2]))}return n}(e,r,a),s=await async function(e,t,r,n){if(Object(i.m)(e))return[];if(null!==e.processId&&!A.Guid.isNullOrEmpty(e.processId))try{const a=await async function(e,t,r,n){const a={MetadataType:"businessprocessflow",MetadataSubtype:null,EntityLogicalName:"workflow",MetadataId:e.guid,MetadataNames:[],GetDefault:!1,DependencyDepth:"OnDemandWithContext",ChangedAfter:null,Exclude:[],AppId:null,IsPreloadCall:!1};try{const o=await _e(t,a,r,n)[0];let s=null;const u=o.data;return Object(i.m)(u)||Object(i.m)(u.BusinessProcessFlowUniqueName)||(s=u.BusinessProcessFlowUniqueName),r.info(`${Se()} Successfully retrieve uniquename for BPF  ${e.guid}`),s}catch(e){return null}}(e.processId,r,t,n);return Object(i.o)(a)?(t.warn(`${Se()} Unique name not found for ${e.processId}`,n),[]):[a]}catch(r){t.warn(`${Se()} Error while retriving bpf unique names by process id ${e.processId}`,n)}if(Object(i.m)(e.target)||Object(i.o)(e.target))return t.warn(Se()+" BPF request must have participating entity logical name",n),[];const a=function(e){return Object(i.m)(e.AdditionalParameters)||Object(i.m)(e.AdditionalParameters.AppId)?A.Guid.EMPTY:A.Guid.tryParse(e.AdditionalParameters.AppId)}(r),o={MetadataType:"bpfselector",MetadataSubtype:null,EntityLogicalName:e.target.entityLogicalName,MetadataId:null,MetadataNames:[],GetDefault:!1,DependencyDepth:"OnDemandWithContext",ChangedAfter:null,Exclude:[],AppId:a.guid,IsPreloadCall:!1},s=await _e(r,o,t,n);if(Object(i.m)(s)||0===s.length)return[];const u=s[0].data;if(!Object(i.m)(u)&&u.SelectorItems){const r=u.SelectorItems;if(!Object(i.m)(r)&&r.length>0){const n=r.map(e=>e.UniqueName);return t.info(`${Se()} Successfully retrieve all BPF uniquenames for participating entity ${e.target}`),n}}return[]}(o,n,r,a);if(Object(i.m)(s)||!s.length)return null;const u=[];null===o.processId||A.Guid.isNullOrEmpty(o.processId)||null===o.processInstanceId||A.Guid.isNullOrEmpty(o.processInstanceId)?s.forEach(e=>{u.push(ge(o.target,e,r,n,a)),n.info(`${Se()}  'Retriev multiple BPF instances ${JSON.stringify(o)}`,a)}):(u.push(async function(e,t,r,n,a){const o="WHERE [businessprocessflowinstanceid]="+V.n.question,s=await Ee(t,o,[e.guid],n);if(!Object(i.m)(s.rows)&&s.rows.length>0)return r.info(`${ve()} data present for ${t}`,a),await be(t,s.rows.item(0),n,a);return r.info(`${ve()} No BPF instance found for ${t}`,a),null}(o.processInstanceId,s[0],n,r,a)),n.info(`${Se()} Retrieve BPF instance from ${s[0]} ${JSON.stringify(o)}`,a));try{const e=await Promise.all(u);let t=new Date("1700-01-01T00:00:00Z"),r={entityLogicalName:"",id:A.Guid.EMPTY,modifiedon:t,primaryIdAttribute:"",primaryIdValue:A.Guid.EMPTY};return e.forEach(e=>{if(null!==e){const n=e.modifiedon;(null===t||n>t)&&(r=e,t=n)}}),n.error(Se()+" Successfully retrieved multiple BPF instances",a),r}catch(e){throw n.error(Se()+" Error when attempting to retrieve global navigation data",a),e}}(r,!!n.IsBusinessProcessEnabled&&n.IsBusinessProcessEnabled,a,o,s),l=Object(i.m)(u)||A.Guid.isNullOrEmpty(u.id)?null:u.id,c=await async function(e,t,r,n,a){const o=[];if(!e)return r.info(Se()+" processID is null in get business process flow control data"),o;const s=await async function(e,t,r,n,a,o){let s;if(A.Guid.isNullOrEmpty(e)){if(t&&r||n.error(Se()+" The entityLogicalName must be either Workflow or participating entity name."),!await Object(C.k)(a,"EnableBPFOffline"))return Promise.resolve(null);s=async function(e,t,r,n){const a=(await async function(e,t,r){const n={MetadataType:"bpfselector",MetadataSubtype:null,EntityLogicalName:null,MetadataId:null,GetDefault:!1,DependencyDepth:"OnDemandWithoutContext",ChangedAfter:null,Exclude:[],MetadataNames:[],AppId:null,IsPreloadCall:!1},a=await _e(t,n,e,r);if(Object(i.m)(a)||0===a.length)throw e.error(Se()+" error when fetching bpf selector",r),new Error("error when fetching bpf selector");return a[0]}(t,r,n)).data;if(!a||!a.SelectorItems||!a.SelectorItems[0]||A.Guid.isNullOrEmpty(a.SelectorItems[0].Id))throw t.error(`${Se()} unable to find default BPF step for ${e}`,n),new Error("Unable to find default bpf step for "+e);const o=a.SelectorItems[0].Id;return Oe("workflow",o,t,r,n)}(t,n,a,o)}else s=Oe(t="workflow",e,n,a,o);return await s}(e,t,A.Guid.EMPTY,r,n,a);if(Object(i.m)(s)||Object(i.m)(s.data))throw new Error("Retrieved empty BPF metadata for");const u=s.data;for(const e of u.BusinessProcessFlowEntities)if(e.EntityLogicalName===t)for(const t of e.Stage.Steps)Object(i.o)(t.Name)||o.push(t.Name);return o}(l,e,o,a,s);if(!Object(i.m)(c)&&c.length)for(const e of c)-1===t.indexOf(e)&&t.push(e);return u}catch(e){return o.error(`${Se()} something went wrong when adding BPF columns ${e.message}`,s),null}}async function Oe(e,t,r,n,a){const o={MetadataType:"businessprocessflow",MetadataSubtype:null,EntityLogicalName:null,MetadataId:t.guid,GetDefault:!1,DependencyDepth:"OnDemandWithoutContext",ChangedAfter:null,Exclude:[],MetadataNames:[],AppId:null,IsPreloadCall:!1},s=await _e(n,o,r,a);if(Object(i.m)(s)||0===s.length)throw r.error(Se()+" error when fetching bpf",a),new Error("error when fetching bpf");return s[0]}function Se(e){return e?`[${e}]`:`[${s.FILE_PREFIX.RetrieveGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function Ne(e){return e?`[${e}]`:`[${s.FILE_PREFIX.RetrieveGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function Re(e,t,r,a={},o){const s=a.commonEventParameters||[],u=await xt(e.url,t,r,s),l=jt(e.url,r,s);if(Object(i.m)(l)){const e=new Error("Retrieve Generator was unable to extract GUID from url");throw r.error(`${Ie()} ${e.message}`,s),e}const c=await Object(C.d)(t,u),d=await Object(C.a)(t,[],u,s),p=await async function(e,t,r,n){const a=[];let o=[];if(Object(i.o)(e))throw r.error(Ne()+" Empty URL for retrieve request",n),new Error("Empty url for retrieve request");if(-1===e.indexOf("?"))r.info(Ne()+" No $select parameter. Returning all columns for entity",n);else{const t=new URLSearchParams(e.split(/\?(.+)/)[1]).get("$select");Object(i.o)(t)?r.info(Ne()+" No $select parameter. Returning all columns for entity",n):o=t.split(",")}o&&0!==o.length||r.info(Ne()+" No $select parameter. Returning all columns for entity",n);for(const e of o){const r=It(e);t[r]===M.AttributeType.Owner||t[r]===M.AttributeType.Lookup||t[r]===M.AttributeType.Customer?(a.push(r+"!id"),a.push(r+"!name"),a.push(r+"!logicalname")):a.push(r)}return r.info(`${Ne()} requested for ${a.length} columns`,n),a}(e.url,d,r,s);await function(e,t){if(Object(i.m)(t)||0===t.length)return t;const r=[e.PrimaryIdAttribute,e.PrimaryNameAttribute];for(const e of r)Object(i.m)(e)||-1!==t.indexOf(e)||t.push(e);return t}(c,p);let f=null;Object(i.m)(o)||(f=await Te(u,p,o,c,t,r,s));let y=await async function(e,t,r,n,a,o,s){const u={sqlStatements:[],sqlParameters:new Array,additionalParameters:{}},l=t.PrimaryIdAttribute,c=await Object(C.a)(s,[],e,o);if(Object(i.o)(l))throw a.error(Ie()+" Invalid parameters when generating RETRIEVE query",o),new Error("Invalid primary id attribute");let d="";d=Object(i.m)(n)||0===n.length?V.n.asterisk:n.map(e=>`[${Pe(c,e)}]`).join(`${V.n.comma}${V.n.space}`);return u.sqlStatements.push(V.c.select+V.n.space+d+V.n.space+V.c.from+V.n.space+V.n.openSQBracket+e+V.n.closeSQBracket+V.n.space+V.c.where+V.n.space+V.n.openSQBracket+l+V.n.closeSQBracket+V.n.equal+V.n.space+V.n.question+V.n.space+V.c.collateNoCase),u.sqlParameters.push([r.guid]),u}(u,c,l,p,r,s,t);Object(i.m)(f)||(y=await async function(e,t){if(!Object(i.o)(e.entityLogicalName)){const r=`${V.c.select} ${V.n.asterisk} ${V.c.from} [${e.entityLogicalName}] ${V.c.where} [${e.primaryIdAttribute}]${V.n.equal}${V.c.placeholder}`;t.sqlStatements.push(r),t.sqlParameters.push([e.primaryIdValue.guid]),Object(i.m)(t.additionalParameters)&&(t.additionalParameters={}),t.additionalParameters.BPFEntityLogicalName=e.entityLogicalName,t.additionalParameters.BPFQueryIndex=t.sqlStatements.length-1}return t}(f,y)),c.IsActivity&&(y=await async function(e,t,r,n,a){let o=!1;const s={};for(const e in t)t[e]===M.AttributeType.PartyList&&(s[L[e]]=e,o=!0);if(!o)return n.warn(Ie()+" Activity entity does not have party type attributes",a.commonEventParameters),r;n.info(`${Ie()} Attempting to retrieve ${s.length} activity parties`,a.commonEventParameters);const u=["participationtypemask","activityid"+V.n.exclamation+"id","activityid"+V.n.exclamation+"name","activityid"+V.n.exclamation+"logicalname","activitypartyid","partyid"+V.n.exclamation+"id","partyid"+V.n.exclamation+"name","partyid"+V.n.exclamation+"logicalname","ispartydeleted","partyobjecttypecode","addressused"];return function(e,t,r,n,a,o){if(Object(i.m)(t)||0===t.length)return a.error(Ie()+" Empty list of columns received. Not generating activity party query",o.commonEventParameters),n;let s="";for(let e=0;e<t.length;e++)s+=V.n.openSQBracket+t[e]+V.n.closeSQBracket+V.n.comma;s=s.substr(0,s.length-1);let u=`${V.c.placeholder}${V.n.comma}`.repeat(Object.keys(r).length);u=u.substr(0,u.length-1);const l=V.n.openSQBracket+w+"!id"+V.n.closeSQBracket+V.n.equal+V.n.question+V.n.space+V.c.and+V.n.space+V.n.openSQBracket+F+V.n.closeSQBracket+V.n.space+V.c.in+V.n.space+V.n.openParenthesis+u+V.n.closeParenthesis,c=V.c.select+V.n.space+s+V.n.space+V.c.from+V.n.space+V.n.openSQBracket+"activityparty"+V.n.closeSQBracket+V.n.space+V.c.where+V.n.space+l+V.c.collateNoCase+V.n.space+V.c.orderBy+V.n.space+V.n.openSQBracket+F+V.n.closeSQBracket;n.sqlStatements.push(c),n.sqlParameters.push([e.guid.toString(),...Object.keys(r)]),Object(i.m)(n.additionalParameters)&&(n.additionalParameters={});return n.additionalParameters.ContainsActivityPartyQuery=!0,n.additionalParameters.ParticipationMasks=r,n.additionalParameters.ActivityPartyQueryIndex=n.sqlStatements.length-1,n}(e,u,s,r,n,a)}(l,d,y,r,a));const m=await async function(e,t,r){const n={};if(!e||-1===e.indexOf("?")||-1===e.indexOf("$expand"))return t.info(Ne()+" Url is empty or does not contain $expand parameter",r),n;const a=new URLSearchParams(e.split(/\?(.+)/)[1]).get("$expand");if(Object(i.o)(a))return n;const o=/([a-zA-Z0-9_]+)\(\$filter=Microsoft\.Dynamics\.CRM\.In\(PropertyName='([a-z0-9_,]+)',PropertyValues=\[(.*)\]\)\)?/,s=/([a-zA-Z0-9_]+)(\(\$select=([a-z0-9_,]+)\)?)?/,u=a.split("),");for(const e of u){let t=e.match(o);Object(i.m)(t)?(t=e.match(s),Object(i.m)(t)||(t.length<3||Object(i.o)(t[3])?n[t[1]]={values:[],clause:V.c.select}:n[t[1]]={values:t[3].split(","),clause:V.c.select})):n[t[1]]={values:t[3].split(",").map(e=>e.replace(/['"]+/g,"")),clause:V.c.in,propertyName:t[2]}}return n}(e.url,r,s);return Object.keys(m).length>0&&(y=await async function(e,t,r,a,o,s,u){if(Object.keys(r).length>0){Object(i.m)(a.additionalParameters)&&(a.additionalParameters={}),a.additionalParameters[n.EXPAND_PROPERTIES]=[],o.info(Ie()+" Requested for expansions",s);for(const n in r)a=await Me(e,n,r[n],t,a,u)}return a}(l,c,m,y,r,s,t)),y}async function Me(e,t,r,n,a,o){Object(i.m)(a.additionalParameters)&&(a.additionalParameters={});let s=!1;if(n.OneToManyRelationships)for(const i in n.OneToManyRelationships){const u=n.OneToManyRelationships[i];u.ReferencedEntityNavigationPropertyName===t&&(s=!0,await Ae(u,e,t,r,n,a,o))}if(!s&&n.ManyToOneRelationships)for(const i in n.ManyToOneRelationships){const s=n.ManyToOneRelationships[i];s.ReferencingEntityNavigationPropertyName===t&&await Ce(s,e,t,r,n,a,o)}return a}async function Ae(e,t,r,a,o,s,u){Object(i.m)(s.additionalParameters)&&(s.additionalParameters={}),Object(i.m)(s.additionalParameters[n.EXPAND_PROPERTIES])&&(s.additionalParameters[n.EXPAND_PROPERTIES]=[]);const l=e.ReferencedAttribute,c=e.ReferencingAttribute,d=e.ReferencingEntity,p=await Object(C.a)(u,[],d),f=Pe(p,c),y={ExpandValueType:n.EXPAND_VALUES.MULTI_VALUE,ExpandPropertyName:r,ExpandQueryIndex:s.sqlStatements.length,ReferencedOrReferencingEntityName:d};if(s.additionalParameters[n.EXPAND_PROPERTIES].push(y),a.clause===V.c.select){let e="*";if(a.values.length>0){const t=(await Object(C.d)(u,d)).PrimaryIdAttribute;t&&a.values.push(t),d===n.FILE_ATTACHMENT&&a.values.push(n.DEVICE_FILE_PATH),e=a.values.map(e=>`[${Pe(p,e)}]`).join(",")}s.sqlStatements.push(`SELECT ${e} FROM [${d}] WHERE [${f}] = (SELECT [${l}] FROM [${o.EntityLogicalName}] WHERE [${o.PrimaryIdAttribute}]=?)`),s.sqlParameters.push([t.guid])}else if(a.clause===V.c.in){let e="?,".repeat(a.values.length);e=e.substring(0,e.length-1),s.sqlStatements.push(`SELECT * FROM [${d}] WHERE [${a.propertyName}] IN (${e}) AND [${f}]=(SELECT [${l}] FROM [${o.EntityLogicalName}] WHERE [${o.PrimaryIdAttribute}]=?)`),s.sqlParameters.push([...a.values,t.guid])}}async function Ce(e,t,r,a,o,s,u){Object(i.m)(s.additionalParameters)&&(s.additionalParameters={}),Object(i.m)(s.additionalParameters[n.EXPAND_PROPERTIES])&&(s.additionalParameters[n.EXPAND_PROPERTIES]=[]);const l=e.ReferencedAttribute,c=e.ReferencingAttribute,d=e.ReferencedEntity,p=await Object(C.a)(u,[],d),f=Pe(p,l),y={ExpandValueType:n.EXPAND_VALUES.SINGLE_VALUE,ExpandPropertyName:r,ExpandQueryIndex:s.sqlStatements.length,ReferencedOrReferencingEntityName:d};if(s.additionalParameters[n.EXPAND_PROPERTIES].push(y),a.clause===V.c.select){let e="*";if(a.values.length>0){const t=(await Object(C.d)(u,d)).PrimaryIdAttribute;t&&a.values.push(t),e=a.values.map(e=>`[${Pe(p,e)}]`).join(",")}s.sqlStatements.push(`SELECT ${e} FROM [${d}] WHERE [${f}] = (SELECT [${c}] FROM [${o.EntityLogicalName}] WHERE [${o.PrimaryIdAttribute}]=?)`),s.sqlParameters.push([t.guid])}else if(a.clause===V.c.in){let e="?,".repeat(a.values.length);e=e.substring(0,e.length-1),s.sqlStatements.push(`SELECT * FROM [${d}] WHERE [${f}] = (SELECT [${c}] FROM [${o.EntityLogicalName}] WHERE [${o.PrimaryIdAttribute}]=?) AND [${a.propertyName}] IN (${e})`),s.sqlParameters.push([t.guid,...a.values])}}function Pe(e,t){const r=It(t),n=e[r];return n===M.AttributeType.Owner||n===M.AttributeType.Lookup||n===M.AttributeType.Customer?r+"!id":r}function Ie(e){return e?`[${e}]`:`[${s.FILE_PREFIX.RetrieveGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */const we=/--batch_.*/;async function De(e,t,r,a={}){const o=function(e){const t=e.body,r=[];if(Object(i.o)(t))return r;const n=t.split(we);for(const e of n){let t="",n="";const a={};if(0===e.trim().length)continue;const o=e.split("\n");for(let e of o)if(0!==e.trim().length&&/\S/.test(e.trim()))if(e=e.trim(),e.startsWith("GET")||e.startsWith("PUT")||e.startsWith("PATCH")||e.startsWith("POST")||e.startsWith("DELETE")){const r=e.split(/\s+/);t=r[0],n=r[1]}else{const t=e.split(":");if(Object(i.m)(t)||t.length<2)continue;a[t[0].trim()]=t[1].trim()}Object(i.o)(n)||Object(i.o)(t)||r.push({url:n,method:t,additionalHeaders:a})}return r}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */(e);if(function(e,t){for(const r of e){if(Object(u.getRequestType)(r,t)===n.OPERATION.Retrieve)return!0}return!1}(o,t))return await async function(e,t,r,n){const a=e&&e.length>0?e[0]:void 0,i=e&&e.length>1?e[1]:void 0;if(!a)throw new Error("Unsupported offline batch request");return Re(a,r,t,n,i)}(o,r,t,a);throw new Error("Unsupported offline batch request")}async function Fe(e,t,r,a={}){const o=a.commonEventParameters||[],s=await xt(e.url,t,r,o),u=await Object(C.a)(t,[],s,o),l=await Ut(e.body,u,s,t,r,o);return async function(e,t,r,a,i=[]){let o=function(e){const t={sqlStatements:[],sqlParameters:new Array,additionalParameters:{[n.ADDITIONAL_PARAMETERS.RecordId]:e.id.guid.toString()}};let r="",a="";const i=[];let o=0;for(const t in e.values)if(t){const n=o>0?",":"";r+=n+"["+t+"]",a+=n+"?",i.push(e.values[t]),o+=1}return t.sqlStatements.push(V.c.insert+V.n.space+V.c.into+V.n.space+V.n.openSQBracket+e.entityLogicalName+V.n.closeSQBracket+V.n.space+V.n.openParenthesis+r+V.n.closeParenthesis+V.n.space+V.c.values+V.n.space+V.n.openParenthesis+a+V.n.closeParenthesis),t.sqlParameters.push(i),t}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */(r);const s=await Object(C.d)(t,a);s.IsActivity&&(o=await Bt(t,r,o,i));s&&e&&e.additionalHeaders&&e.additionalHeaders.Prefer&&-1!==e.additionalHeaders.Prefer.indexOf(n.HEADER_VALUES.PREFER_REPRESENTATION)&&(o=Gt(t,o,a,r.id,s.PrimaryIdAttribute,i));return o}(e,t,await
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
async function(e,t,r,n,a,o,s={}){const u=await Object(C.a)(n,[],e,o),l=await async function(e,t,r,n=[]){const a={},o=await Object(C.b)(r,e,t,n);for(const e in o){if(Object(i.m)(o[e]))continue;const t=o[e];if(t.Type!==M.AttributeType.Boolean||Object(i.m)(t.DefaultValue)){if(t.Type===M.AttributeType.PickList&&!Object(i.m)(t.DefaultFormValue)){const e=t.DefaultFormValue;-1!==e&&(a[t.LogicalName]=e)}}else t.DefaultValue?a[t.LogicalName]=1:a[t.LogicalName]=0}return a}(e,[],n,o);let c={id:A.Guid.newGuid(),entityLogicalName:e,attributeTypes:u,values:l};c=await Pt(c,t,u,r,n,a,o,s);const d=await Object(C.d)(n,e);if(c=await Ft(n,c,d,r,o,s),e===V.a&&r===V.r.create&&Object.keys(c.values).indexOf("objectid")>=0){const e=c.values.objectid;Object(i.m)(e)||(c.values.objecttypecode=e)}if(c.values.versionnumber="0",r===V.r.create){if(!d.PrimaryIdAttribute){const e="entity metadata does not have primary id attribute";throw a.error(`${Ht()} ${e}`,o),new Error(e)}d.PrimaryIdAttribute in c.values||(c.values[d.PrimaryIdAttribute]=c.id.guid),!Object(i.m)(d)&&d.IsActivity&&(Object(i.m)(c.activityParties)&&(c.activityParties=[]),c.activityParties.push({partyId:await Object(C.f)(n,o),partyName:await Object(C.g)(n,o),partyLogicalName:"systemuser",participationType:L.owner}))}return c}(s,l,V.r.create,t,r,o,a),s,o)}function Le(e,t,r,n,o=[]){const u=[];if(u.push({name:"logicalName",value:e}),u.push({name:"attribute",value:t}),Object(i.o)(e)||Object(i.o)(t))throw n.error(`${l?`[${l}]`:`[${s.FILE_PREFIX.SQLModifier}]`} ${V.g.invalidParameter}`,Object(a.b)(o,u)),new Error(V.g.invalidParameter);var l;
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */return V.c.select+V.n.space+V.n.openSQBracket+t+V.n.closeSQBracket+V.n.space+V.c.from+V.n.space+V.n.openSQBracket+e+V.n.closeSQBracket+V.n.space+V.c.where+V.n.space+V.n.openSQBracket+t+V.n.closeSQBracket+V.n.space+V.n.equal+V.n.space+V.n.question+V.n.space+V.c.collateNoCase}async function ke(e,t,r,n={}){const o=n.commonEventParameters||[],s=[],u=await xt(e.url,t,r,o),l=await Object(C.d)(t,u);if(!l||!l.PrimaryIdAttribute)throw r.error(`${je()} ${V.g.primaryIdAttribute}`,o),new Error(V.g.primaryIdAttribute);const c=function(e){let t="";Object(i.o)(e)||(t=e.substring(e.lastIndexOf("(")+1,e.length-1));return t}(e.url);if(s.push({name:c,value:c}),Object(i.o)(c))throw r.error(`${je()} ${V.g.referencedId}`,Object(a.b)(o,s)),new Error(V.g.referencedId);const d={sqlStatements:[],sqlParameters:[[c],[c]]};if(d.sqlStatements.push(Le(u,l.PrimaryIdAttribute,0,r,o)),d.sqlStatements.push(xe(u,l.PrimaryIdAttribute,t,r,o)),l.IsActivity){const e=w+V.n.exclamation+"id";d.sqlStatements.push(xe("activityparty",e,t,r,o)),d.sqlParameters.push([c])}return r.info(`${je()} SQL Query Request: \n  SQL Statement: ${d.sqlStatements}`),Promise.resolve(d)}function xe(e,t,r,n,o=[]){const s=[];if(s.push({name:"logicalName",value:e}),s.push({name:"attribute",value:t}),Object(i.o)(e)||Object(i.o)(t))throw n.error(`${je()} ${V.g.invalidParameter}`,Object(a.b)(o,s)),new Error(V.g.invalidParameter);return V.c.delete+V.n.space+V.c.from+V.n.space+V.n.openSQBracket+e+V.n.closeSQBracket+V.n.space+V.c.where+V.n.space+V.n.openSQBracket+t+V.n.closeSQBracket+V.n.space+V.n.equal+V.n.space+V.n.question+V.n.space+V.c.collateNoCase}function je(e){return e?`[${e}]`:`[${s.FILE_PREFIX.DeleteGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function Ue(e,t){if(!t||0===t.length)return e;let r=e;return t.forEach(e=>{const t=new RegExp("\\"+e,"g");r=r.replace(t,"\\"+e)}),r}function Ve(e,t){const r=Ue(e,["/","*"])+"([\\S\\s]*)"+Ue(t,["/","*"]);return new RegExp(r,"i")}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var qe;!function(e){e[e.string=0]="string",e[e.integer=1]="integer",e[e.currency=2]="currency",e[e.dateTime=3]="dateTime",e[e.float=4]="float"}(qe||(qe={}));async function $e(e,t,r,n,a,o){const s=o.commonEventParameters;let u=function(e,t,r,n){const a=Ve(V.k.QUICKFIND_START,V.k.QUICKFIND_END),i=e.match(a);if(i&&i.length>0)return i[1];const o="Could not locate the QuickFind tokens in SQL query";throw r.error(`${Xe()} ${o}`,n.commonEventParameters),new Error(o)}(e,0,a,o);if(!u){const t="No internal QuickFind query found:\n"+e;return a.error(`${Xe()} ${t}`,s),Promise.reject(t)}const l=await Object(C.d)(n,r,s),c=u.split("UNION"),d=function(e){const t=new RegExp("SELECT [\\S\\s]* FROM [\\S\\s]* WHERE [\\S\\s]* IN \\(SELECT [\\S\\s]* FROM [\\S\\s]* WHERE ([\\S\\s]*)\\)","i"),r=new RegExp("SELECT [\\S\\s]* FROM [\\S\\s]* WHERE ([\\S\\s]*)","i"),n=[],a=[],i={};let o=e[e.length-1].match(r);o&&a.push(...o[1].split("OR"));for(let a=0;a<e.length-1;a++)o=e[a].match(t),o||(o=e[a].match(r)),o?n.push(o[1]):n.push("");return i.lookup=n,i.other=a,i}(c),p=d.lookup?d.lookup:[],f=d.other?d.other:[];if(!p.length&&!f.length){if(!l.PrimaryNameAttribute)return a.warn(`${Xe()} Could not extract search conditions from the QuickFind query:\n${e}`,s),e;u=`SELECT ${l.PrimaryNameAttribute} FROM ${r} WHERE ${l.PrimaryNameAttribute} LIKE {0}`}return"*"===t?(c.splice(0,p.length),p.length=0,f.length=0,Ge(e,c,f,n,a,s)):(function(e,t,r,n,a,o,s){const u=Object(i.v)(e);e=Object(i.f)(e),e=Object(i.l)(e);const l={};if(l[qe[0]]=`'${e}'`,!a.Formatter){const e="Formatter is not available";throw o.error(`${Xe()} ${e}`,s),new Error(e)}{const e=a.Formatter.parseIntegerValue(u);!isNaN(e)&&isFinite(e)&&e.toString()===u&&(l[qe[qe.integer]]=e.toString());const i=a.Formatter.parseDecimalValue(u);!isNaN(i)&&isFinite(i)&&(l[qe[qe.float]]=l[qe[qe.currency]]=i.toString());const o=a.Formatter?a.Formatter.parseInvariant(u):new Date(u);o&&(l[qe[qe.dateTime]]=`'${o.toString()}'`),Be(t,!0,r,l),Be(t,!1,n,l)}}(t,c,p,f,n,a,s),Ge(e,c,f,n,a,s))}function Ge(e,t,r,n,a,i){if(0===t.length){const e="Could not locate the QuickFInd tokens in SQL query";throw a.error(`${Xe()} ${e}`,i),new Error(e)}ze(t),ze(r);const o=t[t.length-1].split("where");if(0===o.length){const e="The QuickFind query does not contain 'WHERE' clause";throw a.error(`${Xe()} ${e}`,i),new Error(e)}const s=o[0]+(r.length>0?" where "+r.join(" OR "):"");return e.replace(t[t.length-1],s)}function Be(e,t,r,n){for(let a=0;a<r.length;a++){const i=r[a].match(new RegExp("({\\d})"));if(!i)continue;const o=He(i[1]);Qe(t,r,e,a,i[1],o in n,o in n?n[o].toString():null)}}function He(e){let t="";switch(e){case"{4}":t=qe[qe.float];break;case"{3}":t=qe[qe.dateTime];break;case"{2}":t=qe[qe.currency];break;case"{1}":t=qe[qe.integer];break;case"{0}":t=qe[0]}return t}function Qe(e,t,r,n,a,i,o){if(i){const i=a?a.replace("}","\\}").replace("{","\\{"):a,s=new RegExp(i,"g"),u=t[n].replace(s,o);e&&(r[n]=r[n].replace(t[n],u)),t[n]=u}else t[n]="",e&&(r[n]="")}function Xe(e){return e?`[${e}]`:`[${s.FILE_PREFIX.QuickFindSQLGenerator}]`}function ze(e){for(let t=0;t<e.length;t++)Object(i.o)(e[t])&&(e.splice(t,1),t--)}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function We(e,t,r,n=!0){const a=Ve(t,r),i=e.match(a);return i&&i.length>0?n?`${t}${i[1]}${r}`:i[1]:null}function Ye(e){return e?`[${e}]`:`[${s.FILE_PREFIX.MergeQuickFindSQLGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function Ke(e,t,r,n,o,s=[]){const u=[];if(u.push({name:"SQLStatement",value:t}),u.push({name:"columnNames",value:r?r.toString():""}),Object(i.o)(t)||!r||0===r.length)throw o.error(`${Ze()} ${V.g.invalidParameter}`,Object(a.b)(s,u)),new Error(V.g.invalidParameter);const l=t.lastIndexOf(V.k.SELECT_START),c=t.lastIndexOf(V.k.SELECT_END);if(-1===l&&-1===c){const e="Cannot find Select SQL Token - Execute SQL Query Processing Sort Without Tokens";throw o.error(`${Ze()} ${e}`,Object(a.b)(s,u)),new Error(e)}const d=t.substr(0,l),p=t.substr(l,c-l),f=t.lastIndexOf(V.k.FROM_START);let y="";-1!==f&&(y=t.substr(f));return t=d+await async function(e,t,r,n,a,i=[]){for(const o of r){t.length>0&&(t+=V.n.comma+V.n.space+V.n.doubleQuote);const r=n+"0";await Qt(e,n,o,a,i)?t=Je(t,r,o):t+=r+V.n.doubleQuote+V.n.dot+V.n.openSQBracket+o+V.n.closeSQBracket+V.n.space+V.c.as+V.n.space+V.n.doubleQuote+o+V.n.doubleQuote}return t}(e,p,r,n,o,s)+V.k.SELECT_END+V.n.space+V.n.space+y,o.info(`${Ze()} SQL Query with SELECT Clause:\n ${t}`),t}function Je(e,t,r){const n=["id","logicalname","name"];for(let a=0;a<n.length;a++){const i=`${r}${V.n.exclamation}${n[a]}`;e+=t+V.n.doubleQuote+V.n.dot+V.n.openSQBracket+i+V.n.closeSQBracket+V.n.space+V.c.as+V.n.space+V.n.doubleQuote+i+V.n.doubleQuote,a<n.length-1&&(e+=V.n.comma+V.n.space+V.n.doubleQuote)}return e}function Ze(e){return e?`[${e}]`:`[${s.FILE_PREFIX.ApplySelectSQLGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function et(e,t,r,n,o,s=[]){const u=[];if(u.push({name:"SQLStatement",value:t}),u.push({name:"columnNames",value:r?r.toString():""}),Object(i.o)(t)||!r||0===r.length)throw o.error(`${tt()} ${V.g.invalidParameter}`,Object(a.b)(s,u)),new Error(V.g.invalidParameter);const l=t.lastIndexOf(V.k.ORDERBY_START),c=t.lastIndexOf(V.k.ORDERBY_END);if(-1===l&&-1===c){const e="Cannot find SORT SQL Token - Execute SQL Query Processing Sort Without Tokens";throw o.error(`${tt()} ${e}`,Object(a.b)(s,u)),new Error(e)}const d=t.substr(0,l),p=await async function(e,t,r,n,i=[]){let o="",s="",u="";for(const l of t){const t=[];t.push({name:"ColumnSortPair",value:l}),o.length>0&&(o+=V.n.comma+V.n.space+V.n.doubleQuote);const c=l.trim().split(V.n.space);let d=r+"0";if(2!==c.length){const e="OrderBy hint contain invalid format";throw n.error(`${tt} ${e}`,Object(a.b)(i,t)),new Error(e)}{s=c[0];const t=s.split(V.n.dot);2===t.length&&(d=t[0],s=t[1]);s=await Qt(e,r,s,n,i)?V.n.openSQBracket+s+V.n.exclamation+"name"+V.n.closeSQBracket:s,u=c[1].toUpperCase()}o+=d+V.n.doubleQuote+V.n.dot+s+V.n.space+u}return o}(e,r,n,o,s);return t=d+V.k.ORDERBY_START+V.c.orderBy+V.n.space+V.n.doubleQuote+p+V.k.ORDERBY_END,o.info(`${tt()} SQL Query with Modified SORT Clause:\n ${t}`),t}function tt(e){return e?`[${e}]`:`[${s.FILE_PREFIX.ApplyOrderBySQLGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function rt(e){const t=function(e){const t=new Date(Date.now()),r=6e4*t.getTimezoneOffset(),n=6e4*e.timezoneutcoffsetminutes;return new Date(t.getTime()+r+n)}(e),r=nt(t,ot(e.timezoneadjusters));return new Date(t.getTime()+r)}function nt(e,t){if(!t)return 0;let r=null;const n=new Date(e.getTime());n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0);for(let e=0;e<t.length;e++){const a=t[e].datestart,i=t[e].dateend;if(n>=a&&n<=i){r=t[e];break}}return r?function(e,t){const r=t.getFullYear(),n=at(e.daylightstart,r),a=at(e.daylightend,r);if(a<n){if(t>n||t<a)return e.delta}else if(t>n&&t<a)return e.delta;return 0}(r,e):0}function at(e,t){if(e.isfixeddaterule)return new Date(t,e.month,e.day,e.timeofday.getHours(),e.timeofday.getMinutes(),e.timeofday.getSeconds());const r=7*e.week-6,n=new Date(t,e.month,1).getDay();let a;return a=n>e.dayofweek?r+(7-n+e.dayofweek):r+(e.dayofweek-n),a>function(e,t){if(/8|3|5|10/.test(e.toString()))return 30;if(1!==e)return 31;return function(e){return e%4==0&&e%100!=0||e%400==0}(t)?29:28}(e.month,t)&&(a-=7),new Date(t,e.month,a,e.timeofday.getHours(),e.timeofday.getMinutes(),e.timeofday.getSeconds())}function it(e,t){return r=function(e,t){let r=6e4*e.timezoneutcoffsetminutes;const n=e.timezoneadjusters;return r+=nt(t,ot(n)),new Date(t.getTime()-r)}(e,t),n=r.getFullYear(),a=r.getMonth()+1,i=r.getDate(),o=r.getHours(),s=r.getMinutes(),u=r.getSeconds(),l=r.getMilliseconds(),`'${n}-${a<10?"0"+a:a}-${i<10?"0"+i:i} ${o<10?"0"+o:o}:${s<10?"0"+s:s}:${u<10?"0"+u:u}.${l<100?l<10?"00"+l:"0"+l:l}'`;var r,n,a,i,o,s,u,l}function ot(e){return e.map(e=>({datestart:new Date(e.datestart),dateend:new Date(e.dateend),daylightstart:{day:e.daylightstart.day,month:e.daylightstart.month,dayofweek:e.daylightstart.dayofweek,week:e.daylightstart.week,timeofday:new Date(e.daylightstart.timeofday),isfixeddaterule:e.daylightstart.isfixeddaterule},delta:e.delta,daylightend:{day:e.daylightend.day,month:e.daylightend.month,dayofweek:e.daylightend.dayofweek,week:e.daylightend.week,timeofday:new Date(e.daylightend.timeofday),isfixeddaterule:e.daylightend.isfixeddaterule}}))}function st(e){return e.setHours(0,0,0,0),e}function ut(e){const t=st(e);return t.setDate(1),t}function lt(e){return Math.trunc(e.timezoneutcoffsetminutes/60)}function ct(e){return e.timezoneutcoffsetminutes%60}function dt(e,t){const r=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());return r.setDate(e.getDate()+t),r}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function pt(e,t,r,n=[]){try{const r=await Object(C.h)(e,n),a=rt(r);return t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(V.d.startOfCurrentHourUTC,it(r,function(e){return e.setMinutes(0,0,0),e}(a)))).replace(V.d.startOfTodayUTC,it(r,st(a)))).replace(V.d.startOfWorkWeekUTC,it(r,function(e,t){try{const r=e.datetimeformatinfo.FirstDayOfWeek;return(t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0)).getDay()<r?dt(t,r-t.getDay()-7):dt(t,r-t.getDay())}catch(e){throw new Error("Failed to getWorkWeekStartDateFromUserSettings "+e)}}(r,a)))).replace(V.d.startOfMonthUTC,it(r,ut(a)))).replace(V.d.startOfYearUTC,it(r,function(e){const t=ut(e);return t.setMonth(0),t}(a)))).replace(V.d.userTimezoneHourOffset,lt(r).toString())).replace(V.d.userTimezoneMinuteOffset,ct(r).toString())).replace(V.d.UTCHourOffset,function(e){return-1*lt(e)}(r).toString())).replace(V.d.UTCMinuteOffset,function(e){return-1*ct(e)}(r).toString())}catch(e){const t=Object(i.i)(e)||"Failed to substitute date time placeholder";throw r.warn(`${ft()} ${t}`,n),new Error(t)}}function ft(e){return e?`[${e}]`:`[${s.FILE_PREFIX.ApplyFinalModifiedSQLGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function yt(e,t,r,o={}){const s=o.commonEventParameters||[],u=[];r.info(mt()+" Building SQL Query For RetrieveMultipleRecords is processing",Object(a.b)(s,u));const l=await xt(e.url,t,r,s),c=await Object(C.k)(t,V.h.SqlTokensAvailable,s);if(u.push({name:"sqlTokensSwitch",value:c}),!c){const e="Offline SQL Token Switch is OFF - Legacy SQL generator is not supported in Modern Data Layer";return r.error(`${mt()} ${e}`,Object(a.b)(s,u)),Promise.reject(new O.a(e))}if(e.additionalHeaders){let c;const d={sqlStatements:[],sqlParameters:[],additionalParameters:{[n.ADDITIONAL_PARAMETERS.PageSize]:e.additionalHeaders[n.HINT.pageSize]||V.e.PageSize}};if(!e.additionalHeaders[n.HINT.viewId]){const e="Retrieve Multiple For Client Api are not supported yet";return r.error(`${mt()} ${e}}`,Object(a.b)(s,u)),Promise.reject(new O.a(e))}{const i=e.additionalHeaders[n.HINT.viewId];if(c=(await Object(C.i)(t,i,s)).offlineSqlQuery,!c){u.push({name:"ViewId",value:i});const e="Raw offline sql from metadata cache is null";return r.error(`${mt()} ${e}`,Object(a.b)(s,u)),Promise.reject(new O.a(e))}if(e.additionalHeaders[n.HINT.mergeQuickFind]){const i=e.additionalHeaders[n.HINT.mergeQuickFind],l=(await Object(C.i)(t,i,s)).offlineSqlQuery;if(!l){u.push({name:"mergeQuickFindViewId",value:i});const e="Failed to merge offline lookup since quick find sql from metadata cache is null for this view id "+i;return r.error(`${mt()} ${e}`,Object(a.b)(s,u)),Promise.reject(new O.a(e))}c=await async function(e,t,r,n,a){const i=a.commonEventParameters||[];if(!e||!t){const e="Lookup view sql query or quick find sql query is empty";return n.error(`${Ye()} ${e}`,i),Promise.reject(new O.a(e))}let o;const s=We(e,V.k.SELECT_START,V.k.FROM_END);if(!s){const r=`Failed to merge lookup query:\n${e}\nwith quick find query:\n${t}\nsince no viewQuerySelectPart found`;return n.error(`${Ye()} ${r}`,i),Promise.reject(new O.a(r))}const u=We(t,V.k.CTE_START,V.k.CTE_END);let l=We(t,V.k.WHERE_START,V.k.WHERE_END,!1),c=We(e,V.k.WHERE_START,V.k.WHERE_END,!1);c?(c=c.toLowerCase().replace("where",""),l=`${V.k.WHERE_START}${l}`):l=`${V.k.WHERE_START}${l}${V.k.WHERE_END}`;const d=We(t,V.k.ORDERBY_START,V.k.ORDERBY_END);return o=u?`${u} ${s} ${l}`:`${s} ${l}`,c&&(o+=` and (${c})${V.k.WHERE_END}`),d&&(o+=" "+d),o}(c,l,0,r,o)}if(e.additionalHeaders[n.HINT.search]){const a=e.additionalHeaders[n.HINT.search];c=await $e(c,a,l,t,r,o)}e.additionalHeaders[n.HINT.select]&&(c=await Ke(t,c,kt(e.additionalHeaders[n.HINT.select]),l,r,s)),e.additionalHeaders[n.HINT.orderBy]&&(c=await et(t,c,kt(e.additionalHeaders[n.HINT.orderBy]),l,r,s))}return c=await async function(e,t,r,o,s,u=[]){const l=[];e=function(e,t,r){const n=1+t,a=t*(r-1);return e+V.n.space+V.c.limit+V.n.space+n+V.n.space+V.c.offset+V.n.space+a}(e,Number(o[n.HINT.pageSize]||V.e.PageSize),Number(o[n.HINT.pageNumber]||V.e.PageNumber));const c=await Object(C.f)(r,u);l.push({name:"UserId",value:c}),Object(i.o)(c)?s.warn(mt()+" userId is null or empty",Object(a.b)(u,l)):e=function(e,t,r,n=[]){if(typeof t===M.AttributeType.String&&t.trim().length>0)return t.replace('"!eq-userid!"',V.n.singleQuote+e+V.n.singleQuote+V.n.space+V.c.collateNoCase);{const e=ft()+" attempted to substitute user id placeholder in empty sql statement";throw r.error(e,n),new Error(e)}}(c,e,s,u);try{e=await pt(r,e,s,u)}catch(e){const t=Object(i.i)(e)||"Failed to substitute date time placeholder";s.warn(`${mt()} ${t}`,Object(a.b)(u,l))}return e=await async function(e,t,r,n=[]){try{const r=await Object(C.h)(e,n),a=await Object(C.e)(e,n);t=(t=(t=(t=t.replace("@LanguageId0",r.languageid.toString())).replace("@LanguageId1",a.toString())).replace("@ObjectColumnName0","6")).replace("@ObjectColumnName1","6")}catch(e){const t="Failed to substitueUserLanguage with "+(Object(i.i)(e)||"Unknown");r.warn(`${ft()} ${t}`,n)}return t}(r,e,s,u)}(c,0,t,e.additionalHeaders,r,s),d.sqlStatements.push(c),d}{const e="Failed to build the SQL Query For RetrieveMultiple - Cannot find request additional headers";return r.error(`${mt()} ${e}`,Object(a.b)(s,u)),Promise.reject(new O.a(e))}}function mt(e){return e?`[${e}]`:`[${s.FILE_PREFIX.RetrieveMultipleGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function ht(e,t,r,a={}){const o=a.commonEventParameters||[],s=await xt(e.url,t,r,o),u=await Object(C.a)(t,[],s,o),l=await Ut(e.body,u,s,t,r,o),c=jt(e.url,r,o);if(Object(i.m)(c)){const e=new Error("Update Generator was unable to extract GUID from url");throw r.error(`${gt()} ${e.message}`,o),e}let d={id:c,entityLogicalName:s,attributeTypes:u,values:{}};const p=await Object(C.d)(t,s);return d=await Pt(d,l,u,V.r.update,t,r,o,a),d=await Ft(t,d,p,V.r.update,o,a),async function(e,t,r,a,o,s,u=[]){if(!a||!a.PrimaryIdAttribute)throw new Error(V.g.primaryIdAttribute);let l={sqlStatements:[],sqlParameters:[],additionalParameters:{[n.ADDITIONAL_PARAMETERS.RecordId]:r.id.guid.toString()}};l.sqlStatements.push(Le(o,a.PrimaryIdAttribute,0,s,u)),l.sqlParameters.push([r.id.guid]),l=function(e,t,r,n,a,o=[]){if(Object(i.o)(a)||Object(i.m)(t))throw n.error(gt()+" Invalid parameters when creating update query",o),new Error("Invalid parameters for update query generation");let s="";const u=[];let l=0;for(const e in t.values)if(!Object(i.o)(e)){s+=`${l>0?",":""}[${e}] = ?`,u.push(t.values[e]),l+=1}!Object(i.o)(s)&&u.length>0&&(e.sqlStatements.push(V.c.update+V.n.space+t.entityLogicalName+V.n.space+V.c.set+V.n.space+s+V.n.space+V.c.where+V.n.space+a+V.n.equal+V.n.question+V.n.space+V.c.collateNoCase),u.push(t.id.guid),e.sqlParameters.push(u));return e}(l,r,0,s,a.PrimaryIdAttribute,u),a.IsActivity&&(l=await async function(e,t,r,n=[]){Object(i.m)(t.activityParties)||(r=function(e,t){if(Object(i.m)(e.activityParties))return t;return t.sqlStatements.push(V.c.delete+V.n.space+V.c.from+V.n.space+V.n.openSQBracket+"activityparty"+V.n.closeSQBracket+V.n.space+V.c.where+V.n.space+V.n.openSQBracket+w+"!id"+V.n.closeSQBracket+V.n.space+V.n.equal+V.n.space+V.n.question+V.n.space+V.c.collateNoCase),t.sqlParameters.push([e.id.guid]),t}(t,r),r=await Bt(e,t,r,n));return r}(t,r,l,u));a&&e&&e.additionalHeaders&&e.additionalHeaders.Prefer&&-1!==e.additionalHeaders.Prefer.indexOf(n.HEADER_VALUES.PREFER_REPRESENTATION)&&(l=Gt(t,l,o,r.id,a.PrimaryIdAttribute,u));return l}(e,t,d,p,s,r,o)}function gt(e){return e?`[${e}]`:`[${s.FILE_PREFIX.UpdateGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function Et(e){return e?`[${e}]`:`[${s.FILE_PREFIX.SQLGenerator}]`}function bt(e,t,r={}){return async function(e,t,r={}){const a=t.TraceManager.getTracer(s.COMPONENT_NAMES.SQLGenerator),i=r.commonEventParameters||[];switch(a.info(Et()+" Query Generator start processing.",i),Object(u.getRequestType)(e,t)){case n.OPERATION.Create:return Fe(e,t,a,r);case n.OPERATION.RetrieveMultiple:return yt(e,t,a,r);case n.OPERATION.Update:return ht(e,t,a,r);case n.OPERATION.Delete:return ke(e,t,a,r);case n.OPERATION.GetClientMetadata:return ce(e,t,a,r);case n.OPERATION.Retrieve:return Re(e,t,a,r);case n.OPERATION.Batch:return De(e,t,a,r);default:const o="Unsupported request type";throw a.error(`${Et()} Query Generator Failed with ${o}`,i),new Error(o)}}(e,t,r)}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class _t extends f{async intercept(e){const t=e.executionContext||{},r=e.request,o=t.requestType||Object(u.getRequestType)(r,this.applicationContext),l=this.applicationContext.TraceManager.getTracer(s.COMPONENT_NAMES.LocalODataExecutor);let c,d,p,f="Query Generator",y="",m=null;const h=t.commonEventParameters||[],g=[];let E;if(o===n.OPERATION.GetClientMetadata){E=de(r,l,h).MetadataType,g.push({name:"MetadataType",value:E})}try{t.performanceControl&&t.performanceControl.startMarker(s.FILE_PREFIX.SQLGenerator),c=await bt(r,this.applicationContext,t),t.performanceControl&&t.performanceControl.endMarker(s.FILE_PREFIX.SQLGenerator),c&&c.sqlStatements&&c.sqlStatements.length>0?(f="SQL Executor",l.info(vt()+" Query Generator Completed. SQL Executor is processing",Object(a.b)(h,g)),m=c.additionalParameters,d=!function(e,t,r){if(Object(i.o)(r)||Object(i.n)(e)||Object(i.o)(t))return!1;const a=$.QueriedMetadataType[r.toLowerCase()],o=[$.QueriedMetadataType.customControl,$.QueriedMetadataType.complexControl,$.QueriedMetadataType.formSelector,$.QueriedMetadataType.viewSelector,$.QueriedMetadataType.ribbon];return t===n.OPERATION.GetClientMetadata&&Tt(e)&&!Object(i.m)(e.AdditionalParameters)&&e.AdditionalParameters.response&&-1!==o.indexOf(a)}(this.applicationContext,o,E)||Object(i.m)(this.applicationContext.AdditionalParameters)?await P(c,this.applicationContext,o,t):this.applicationContext.AdditionalParameters.response,d?(f="Response Handler",l.info(vt()+" SQL Executor Completed.Response Handler is processing",g),p=await lr(r,o,this.applicationContext,d,void 0,m,t)):(y="ExecuteSQLBatch returned empty sql response",l.warn(`${vt()} ${y}`,Object(a.b)(h,g)),p=await lr(r,o,this.applicationContext,void 0,void 0,void 0,t))):(l.warn(vt()+" ExecuteOfflineSqlGenerator returned empty query, So will return empty response",Object(a.b)(h,g)),p=await lr(r,o,this.applicationContext,void 0,void 0,void 0,t))}catch(e){y=e.message?e.message:"Exception in SQLRequestInterceptor at operationStep - "+f;const n=e.code;g.push({name:"OperationStep",value:f}),Object(a.a)(e,g),l.error(vt()+" Exception in SQLRequestInterceptor",Object(a.b)(h,g)),p=await lr(r,o,this.applicationContext,void 0,new O.a(y,n,e.stack,f),void 0,t)}return l.info(vt()+" Exiting SQLRequestInterceptor and returning local OData response",Object(a.b)(h,g)),p}}function vt(e){return e?`[${e}]`:`[${s.FILE_PREFIX.SQLRequestInterceptor}]`}function Tt(e){return!Object(i.m)(e.AdditionalParameters)&&!0!==e.AdditionalParameters.EnableDependency}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function Ot(e,t,r){const n=`SELECT ${Q.METADATA_TYPE}, ${Q.JSON} from applicationmetadata where ${t} = ?`;e.sqlStatements.push(n),e.sqlParameters.push([r])}async function St(e,t,r,a={}){const i=await Object(C.d)(e,t),o=i.PrimaryNameAttribute,s=i.PrimaryIdAttribute;if(!o||!s)return"";const u={sqlStatements:[`SELECT ${o} FROM ${t} WHERE ${s} = ?`],sqlParameters:[[r]]},l=await P(u,e,n.OPERATION.Retrieve,a);if(!l||l.length<=0||!l[0].rows||!l[0].rows.item||l[0].rows.item.length<=0||!o)return"";return l[0].rows.item(0)[o]}async function Nt(e,t,r){const n=`SELECT ${Q.METADATA_TYPE}, ${Q.JSON} FROM applicationmetadata WHERE ${Object(i.o)(r)?Y.get_id().get_path():r} = ?`,a=await Object(q.b)(e,n,[t]);Mt(e,a);for(const e of a)if(e.rows.length>0)return JSON.parse(e.rows.item(0)[Q.JSON]);return{}}async function Rt(e,t){const r={sqlStatements:[],sqlParameters:[]};Ot(r,t.get_keyPath().get_path(),t.get_keyValue().toString());const n=await Object(q.a)(e,r);Mt(e,n);const a=[];for(let e=0;e<n.length;e++)if(n[e].rows.length>0)for(let r=0;r<n[e].rows.length;r++){const i=JSON.parse(n[e].rows.item(r)[Q.JSON]);t.checkApplicationMetadata(i)&&a.push(i)}return a}function Mt(e,t){Tt(e)&&!Object(i.m)(t)&&Array.isArray(t)&&t.length>0&&(Object(i.m)(e.AdditionalParameters)&&(e.AdditionalParameters={}),!Object(i.m)(e.AdditionalParameters.response)&&Array.isArray(e.AdditionalParameters.response)?e.AdditionalParameters.response=e.AdditionalParameters.response.push(...t):e.AdditionalParameters.response=t)}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function At(e,t,r,n){t=t?t.trim():"",r=r?r.trim():"",n=n?n.trim():"";let a="";r.length>0&&(a=r.substring(0,1));let i="";switch(e){case 0:i=n.length>0&&t.length>0?n+", "+t:n+" "+t;break;case V.i.firstLast:i=t+" "+n;break;case V.i.lastFirstMiddleInitial:i=function(e,t,r){let n="";t.length>0&&(n=t);t.length>0&&(e.length>0||r.length>0)&&(n+=",");e.length>0&&(n=n+" "+e);r.length>0&&(n=n+" "+r+".");return n.toString().trim()}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */(t,n,a);break;case V.i.firstMiddleInitialLast:i=t,r.length>0&&(i=i+" "+a+"."),i=i+" "+n;break;case V.i.lastFirstMiddle:n.length>0&&(i=n),n.length>0&&(t.length>0||r.length>0)&&(i+=","),t.length>0&&(i=i+" "+t),r.length>0&&(i=i+" "+r);break;case V.i.firstMiddleLast:i=t,r.length>0&&(i=i+" "+r),i=i+" "+n;break;case V.i.lastSpaceFirst:i=n+" "+t;break;case V.i.lastNoSpaceFirst:i=n+t;break;default:i=n}return i.toString().trim()}function Ct(e,t,r,n){e.values[t]=r,t in e.attributeTypes||(e.attributeTypes[t]=n)}async function Pt(e,t,r,n,a,o,s,u={}){for(let n=0;n<t.columnNames.length;n++){const l=It(t.columnNames[n]);if(r[l]===M.AttributeType.PartyList){Object(i.m)(e.activityParties)&&(e.activityParties=[]);const r=t.columnValues[n].match(/([a-z_]+)\((.*)\)/i);if(null===r){const e=`Parsing a party list attribute ${t.columnNames[n]} failed: ${t.columnValues[n]}`;throw o.error(`${Ht()} ${e}`,s),new Error(e)}const c=await Object(C.c)(a,r[1],s);e.activityParties.push({partyId:r[2],partyName:await St(a,c,r[2],u),partyLogicalName:c,participationType:L[l]})}else if(r[l]===M.AttributeType.Owner||r[l]===M.AttributeType.Lookup||r[l]===M.AttributeType.Customer)if(t.columnValues[n]&&""!==t.columnValues[n].trim()){const u=t.columnValues[n].match(/([a-z_]+)\((.*)\)(\/(.*)):?/i);if(null===u){const e=`Parsing a lookup or customer reference attribute ${t.columnNames[n]} failed: ${t.columnValues[n]}`;throw o.error(`${Ht()} ${e}`,s),new Error(e)}Ct(e,l+"!id",Lt(M.AttributeType.UniqueIdentifier,u[2]),M.AttributeType.UniqueIdentifier),Ct(e,l+"!logicalname",await Object(C.c)(a,u[1],s),M.AttributeType.String);let c=V.e.EmptyString;5!==u.length||Object(i.o)(u[4])?o.warn(`{${Ht()}} Display name not passed for ${l} of type ${r[l]}. Setting it as empty string`,s):c=u[4],Ct(e,l+"!name",c,M.AttributeType.String)}else Ct(e,l+"!id",V.e.EmptyString,M.AttributeType.UniqueIdentifier),Ct(e,l+"!logicalname",V.e.EmptyString,M.AttributeType.String),Ct(e,l+"!name",V.e.EmptyString,M.AttributeType.String);else Ct(e,l,Lt(r[l],t.columnValues[n]),r[l])}return e}function It(e){let t=e;return e.startsWith("_")&&e.endsWith("_value")&&(t=e.substr(1,e.length-7)),t}async function wt(e,t,r,n,a=[],o={}){const s=[];if(t===V.r.create){const t=x;t.push(...j);const n=t.indexOf("ownerid");n>=0&&!Object(i.m)(r)&&!Object(i.m)(r.OwnershipType)&&r.OwnershipType.valueOf()===R.OrganizationOwned&&t.splice(n,1);for(const r of t)e.values[r]||s.push(r);!Object(i.m)(r)&&r.IsActivity&&(e.values.activitytypecode||Ct(e,"activitytypecode",r.EntityLogicalName,M.AttributeType.String),e.values.isregularactivity||Ct(e,"isregularactivity",function(e,t){switch(e){case V.l:case V.m:case V.o:case V.j:case V.b:case V.p:return!1;default:return!!t}}(r.ObjectTypeCode,r.ActivityTypeMask)?"1":"0",M.AttributeType.Boolean))}if(t===V.r.create||t===V.r.update){for(const t of U)e.values[t]||(s[s.length]=t);const u=await Object(C.b)(n,e.entityLogicalName,[],a);if(!Object(i.m)(u)&&function(e,t){if(e[t])return!0;return!1}(u,"fullname"))for(const s in e.values)if(D.indexOf(s)>=0&&!e.values.fullname){let s={};t===V.r.update&&(s=await Dt(n,e,r,o,a)),s.firstname=Object(i.o)(e.values.firstname)?s.firstname:e.values.firstname,s.middlename=Object(i.o)(e.values.middlename)?s.middlename:e.values.middlename,s.lastname=Object(i.o)(e.values.lastname)?s.lastname:e.values.lastname,Ct(e,"fullname",At(await Object(C.j)(n,a),s.firstname,s.middlename,s.lastname),M.AttributeType.String);break}if(t===V.r.create){const t=Object.keys(u);for(const r of t)if(u[r]){const t=u[r];(!Object(i.m)(t.DefaultValue)||!Object(i.m)(t.DefaultFormValue))&&Object(i.m)(e.values[t.LogicalName])&&s.indexOf(t.LogicalName)<0&&(s[s.length]=t.LogicalName)}}return s}return s}async function Dt(e,t,r,n={},a=[]){const o=e.TraceManager.getTracer(s.COMPONENT_NAMES.SQLGenerator),u={sqlStatements:[V.c.select+V.n.space+"firstname"+V.n.comma+"middlename"+V.n.comma+"lastname"+V.n.space+V.c.from+V.n.space+t.entityLogicalName+V.n.space+V.c.where+V.n.space+r.PrimaryIdAttribute+V.n.equal+V.c.placeholder],sqlParameters:[[t.id.guid]]};try{const t=await P(u,e,void 0,n);if(!Object(i.m)(t)&&1===t.length)return t[0].rows.item(0)}catch(e){o.error(`${Ht()} Unable to get name parts for ${t.entityLogicalName} from DB. Error: ${e.errorMessage}`,a)}return{}}async function Ft(e,t,r,n,a=[],o={}){const s=await wt(t,n,r,e,a,o);return t=await async function(e,t,r,n,a=[]){const o=await Object(C.b)(n,e.entityLogicalName,t,a);for(const s in o){if(Object(i.m)(o[s]))continue;const u=o[s];if(!Object(i.m)(u))switch(u.LogicalName){case"statecode":if(r.HasStateCode&&Ct(e,u.LogicalName,Object(i.m)(u.DefaultFormValue)?0:u.DefaultFormValue,M.AttributeType.State),-1!==t.indexOf("statuscode")&&!Object(i.m)(e.values.statecode)){const t=e.values.statecode.value;let r=0;if(u&&u.OptionSet&&Object.keys(u.OptionSet).length>0){const e=u.OptionSet.find(e=>e.Value===t);r=e?e.DefaultStatus:0}Ct(e,"statuscode",r,M.AttributeType.Status)}break;case"statuscode":break;case"createdon":case"modifiedon":Ct(e,u.LogicalName,new Date(Date.now()),M.AttributeType.DateTime);break;case"createdby":case"modifiedby":case"ownerid":if("ownerid"!==u.LogicalName||!Object(i.m)(r.OwnershipType)&&r.OwnershipType.valueOf()===R.UserOwned){const t=await Object(C.f)(n,a),r=await Object(C.g)(n,a);if(Object(i.n)(t))throw new Error("User ID fetched from metadata cache was empty");if(Object(i.n)(r))throw new Error("User Name fetched from metadata cache was empty");Ct(e,u.LogicalName+"!id",Object(i.n)(t)?null:t,M.AttributeType.UniqueIdentifier),Ct(e,u.LogicalName+"!logicalname","systemuser",M.AttributeType.String),Ct(e,u.LogicalName+"!name",Object(i.n)(r)?null:r,M.AttributeType.String)}break;default:u.Type!==M.AttributeType.PickList||Object(i.m)(u.DefaultFormValue)||Ct(e,u.LogicalName,u.DefaultFormValue,u.Type),u.Type||!u.DefaultFormValue&&!u.DefaultValue||Ct(e,u.LogicalName,Object(i.m)(u.DefaultFormValue)?u.DefaultValue?1:0:u.DefaultFormValue,u.Type)}}return e}(t,s,r,e,a)}function Lt(e,t){switch(e){case M.AttributeType.UniqueIdentifier:return A.Guid.parse(t).guid;case M.AttributeType.PickList:case M.AttributeType.State:case M.AttributeType.Status:return t;case M.AttributeType.Boolean:return!0===t?"1":"0";case M.AttributeType.DateTime:return t;case M.AttributeType.PartyList:throw Error("No SQL representation for party list");case M.AttributeType.Owner:case M.AttributeType.Lookup:case M.AttributeType.Customer:throw Error("No SQL representation for complex types");default:return t}}function kt(e){return e.split(",")}async function xt(e,t,r,n=[]){if(!e)throw r.error(Ht()+" Error when attempting to extract entity name from URL",n),new Error("Empty url is not valid");const a=e.split("/"),i=a[a.length-1].split("(")[0].split("?")[0];return await Object(C.c)(t,i,n)}function jt(e,t,r=[]){if(!e)throw t.error(Ht()+" Error when attempting to extract entity name from URL",r),new Error("Empty url is not valid");const n=e.split("/"),a=n[n.length-1].split("(")[1];if(Object(i.o)(a))return null;const o=a.split(")")[0];return A.Guid.parse(o)}async function Ut(e,t,r,n,a,o=[]){if(Object(i.o)(e)||Object(i.n)(t)){const e="Invalid request. Empty request body";throw a.error(`${Ht()} ${e}`,o),new Error(e)}const s=JSON.parse(e),u=[],l=[],c=await Object(C.d)(n,r);for(const e in s)e.indexOf("@odata.bind")>0?$t(e,s,c,t,u,l,a,o):e.indexOf("activity_parties")>0?qt(e,s,u,l,a,o):-1===e.toLowerCase().indexOf("@odata")&&(u.push(e),l.push(Object(i.m)(s[e])?Vt(t[e]):s[e]));return{columnNames:u,columnValues:l}}function Vt(e){switch(e){case M.AttributeType.PickList:return null;default:return V.e.EmptyString}}function qt(e,t,r,n,a,i){const o=t[e];a.info(`${Ht} Found ${o.length} activity parties`,i);for(const e of o)for(const t in e)t.indexOf("@odata.bind")>0?n.push(e[t]):"participationtypemask"===t&&r.push(k[e[t]])}function $t(e,t,r,a,o,s,u,l){const c=e.split("@odata.bind")[0],d=Object(i.o)(t[e])?t[e]:t[e]+"/"+(t[c+"@OData.Community.Display.V1.FormattedValue"]||V.e.EmptyString);let p=!1;if(r&&r.ManyToOneRelationships)for(const e in r.ManyToOneRelationships){const t=r.ManyToOneRelationships[e];if(t.ReferencingEntityNavigationPropertyName===c&&t.ReferencingAttribute){o.push(t.ReferencingAttribute),s.push(d),p=!0;break}}if(!p){const e=new O.a(`${Ht()} No navigation properties found for attribute ${c} in entity ${r.EntityLogicalName}`,n.ErrorCode.UnknownBadRequestError,(new Error).stack);throw u.error(e.message,l),e}}function Gt(e,t,r,a,o,u=[]){const l=e.TraceManager.getTracer(s.COMPONENT_NAMES.SQLGenerator);if(Object(i.o)(o)||A.Guid.equals(a,A.Guid.EMPTY))return l.error(`${Ht()} Invalid parameters when creating query for ${n.HEADER_VALUES.PREFER_REPRESENTATION}`,u),t;const c=`select * from ${r} where ${o}=?`;t.sqlStatements.push(c);const d=[];return d.push(a.guid.toString()),t.sqlParameters.push(d),t}async function Bt(e,t,r,n=[]){if(!Object(i.m)(t.activityParties)){const a=await Object(C.b)(e,"activityparty",["ispartydeleted"],n),o=Object(i.m)(a)||Object(i.m)(a.ispartydeleted)?"0":a.ispartydeleted.DefaultValue?"1":"0";for(const e of t.activityParties)r.sqlStatements.push(V.c.insert+V.n.space+V.c.into+V.n.space+V.n.openSQBracket+"activityparty"+V.n.closeSQBracket+V.n.space+V.n.openParenthesis+V.n.openSQBracket+"activitypartyid"+V.n.closeSQBracket+V.n.comma+V.n.openSQBracket+w+V.n.exclamation+"id"+V.n.closeSQBracket+V.n.comma+V.n.openSQBracket+w+V.n.exclamation+"name"+V.n.closeSQBracket+V.n.comma+V.n.openSQBracket+w+V.n.exclamation+"logicalname"+V.n.closeSQBracket+V.n.comma+V.n.openSQBracket+F+V.n.closeSQBracket+V.n.comma+V.n.openSQBracket+"partyid"+V.n.exclamation+"id"+V.n.closeSQBracket+V.n.comma+V.n.openSQBracket+"partyid"+V.n.exclamation+"name"+V.n.closeSQBracket+V.n.comma+V.n.openSQBracket+"partyid"+V.n.exclamation+"logicalname"+V.n.closeSQBracket+V.n.comma+V.n.openSQBracket+"ispartydeleted"+V.n.closeSQBracket+V.n.closeParenthesis+V.n.space+V.c.values+V.n.space+V.n.openParenthesis+V.n.question+V.n.comma+V.n.question+V.n.comma+V.n.question+V.n.comma+V.n.question+V.n.comma+V.n.question+V.n.comma+V.n.question+V.n.comma+V.n.question+V.n.comma+V.n.question+V.n.comma+V.n.question+V.n.closeParenthesis),r.sqlParameters.push([A.Guid.newGuid().guid,t.id.guid,Object(i.o)(t.values.name)?"":t.values.name,t.entityLogicalName,e.participationType,e.partyId,e.partyName,e.partyLogicalName,o])}return r}function Ht(e){return e?`[${e}]`:`[${s.FILE_PREFIX.Common}]`}async function Qt(e,t,r,n,a=[]){const o=await Object(C.b)(e,t,[],a);if(Object(i.n)(o)){const e="Unable to get attribute metadata descriptor that associated to entity: "+t;return n.warn(`${Ht()} ${e}`,a),Promise.reject(e)}return!(!o[r]||o[r].Type!==M.AttributeType.Lookup&&o[r].Type!==M.AttributeType.Customer&&o[r].Type!==M.AttributeType.Owner)}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function Xt(e,t,r,a,i=[],o){let s;const u=new Headers;u.set(n.HEADER.CONTENT_TYPE,n.HEADER_VALUES.APPLICATION_JSON),r.info(Wt()+" Processing the retrieve response",i);const l=a;if(l&&l.length>0){const a=await async function(e,t,r,n,a=[],i){let o="";const s=await zt(e,t,r,n,a,i);return s["@odata.context"]=e.url,o=JSON.stringify(s),o}(e,t,r,l,i,o);s=Object(b.b)(n.HTTP_STATUS_CODES.Ok,e.url,u,a)}else r.error(Wt()+" No response retrieved from offline DB for this request",i),s=Object(b.a)(n.HTTP_STATUS_CODES.Unknown,e.url,new O.a("No response retrieved from offline DB for this request"));return s}async function zt(e,t,r,i,o=[],s){let u={};const l=[],c=await xt(e.url,t,r,o);l.push({name:"EntityLogicalName",value:c});const d=i[0].rows.item(0);if(d){let r=!1;Object(b.d)(e)&&(r=!0),u=await Object(b.c)(t,d,c,r),u["@odata.type"]=c,s&&s.ContainsActivityPartyQuery&&async function(e,t,r,n,a){if(t.length>0){const i={};for(let e=0;e<t.length;e++){const r=await Object(b.c)(a,t.item(e),"activityparty",n);i[r[F]]?i[r[F]].push(r):i[r[F]]=[r]}for(const t in i)if(i[t]&&r[+t]){const n=i[t];e[r[+t]]={entities:n,morerecords:!1,totalrecordcount:n.length,totalRecordCountLimitExceeded:!1}}}}(u,i[s.ActivityPartyQueryIndex].rows,s.ParticipationMasks,r,t),s&&s[n.EXPAND_PROPERTIES]&&await async function(e,t,r,a,i){let o=0;for(;o<i[n.EXPAND_PROPERTIES].length;){const s=i[n.EXPAND_PROPERTIES][o],u=s.ExpandPropertyName,l=s.ExpandValueType,c=s.ExpandQueryIndex,d=s.ReferencedOrReferencingEntityName,p=t[c].rows;if(p)if(l===n.EXPAND_VALUES.MULTI_VALUE){let t=0;const n=[];for(;t<p.length;){const e=p.item(t),i=await Object(b.c)(a,e,d,r);n.push(i),t++}e[u]=n}else{const t=p.item(0),n=await Object(b.c)(a,t,d,r);e[u]=n}o++}}(u,i,r,t,s),t.EventManager.ReportComponentSuccess(Wt(),Object(a.b)(o,l))}else r.error(Wt()+" No response retrieved from offline DB for this request",o);return u}function Wt(e){return e?`[${e}]`:`[${s.FILE_PREFIX.BPFResponseHandler}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */const Yt=/--batch_.*/;async function Kt(e,t,r,a,o=[],s){const l=e.url;let c;const d=function(e){const t=e.body,r=[];if(Object(i.o)(t))return r;const n=t.split(Yt);for(const e of n){let t="",n="";const a={};if(0===e.trim().length)continue;const o=e.split("\n");for(let e of o)if(0!==e.trim().length&&/\S/.test(e.trim()))if(e=e.trim(),e.startsWith("GET")||e.startsWith("PUT")||e.startsWith("PATCH")||e.startsWith("POST")||e.startsWith("DELETE")){const r=e.split(/\s+/);t=r[0],n=r[1]}else{const t=e.split(":");if(Object(i.m)(t)||t.length<2)continue;a[t[0].trim()]=t[1].trim()}Object(i.o)(n)||Object(i.o)(t)||r.push({url:n,method:t,additionalHeaders:a})}return r}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */(e);return function(e,t){for(const r of e){if(Object(u.getRequestType)(r,t)===n.OPERATION.Retrieve)return!0}return!1}(d,t)?(c=await async function(e,t,r,n,a=[],i){const o=e&&e.length>0?e[0]:void 0;let s;if(i&&i.BPFEntityLogicalName){const t=i&&i.BPFQueryIndex?i.BPFQueryIndex:1;s=e&&e.length>1?e[t]:void 0}if(!o)throw new Error("Unsupported offline batch request");const u=await zt(o,t,r,n,a,i),l=await Xt(o,t,r,n,a,i);if(s){const e=i&&i.BPFQueryIndex?i.BPFQueryIndex:1,o=await S(s,t,r,n&&n.length>e?n.slice(e,e+1):[],u,a,i);return await _([l,o])}return await _([l])}(d,t,r,a,o,s),c):(c=Object(b.b)(n.HTTP_STATUS_CODES.NoContent,l),c)}async function Jt(e,t,r,a,i,o=[]){const s=e.url;let u,l="",c=null;i&&i[n.ADDITIONAL_PARAMETERS.RecordId]&&(c=i[n.ADDITIONAL_PARAMETERS.RecordId]);const d=new Headers;if(null!=c){const i=e.url+"("+c+")";d.append(n.HEADER.ODADTA_ENTITY_ID,i),r.info(Zt()+" Processing the create response"),l=await async function(e,t,r,n,a=[]){let i="";const o=n;let s={};if(Object(b.e)(e)&&o&&o.length>1&&o[1].rows.length>0){const n=o[1].rows.item(0);if(n){const o=await xt(e.url,t,r,a);let u=!1;Object(b.d)(e)&&(u=!0),s=await Object(b.c)(t,n,o,u),i=JSON.stringify(s)}}return i}(e,t,r,a,o),u=Object(b.b)(n.HTTP_STATUS_CODES.NoContent,s,d,l)}else r.error(Zt()+" Guid returned from sql executor is null",o),u=Object(b.a)(n.HTTP_STATUS_CODES.Unknown,s,new O.a("Guid returned from sql executor is null"));return u}function Zt(e){return e?`[${e}]`:`[${s.FILE_PREFIX.CreateResponseHandler}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function er(e,t,r,o,u=[]){const l=e.url,c=[];let d;if(Object(i.m)(o)||!Object(i.m)(o[0])&&o[0].rows.length)d=Object(b.b)(n.HTTP_STATUS_CODES.NoContent,l,new Headers);else{const t=new O.a("You cannot delete this record because it doesn't exist in the offline mode",n.ErrorCode.CannotDeleteOnlineRecord);Object(a.a)(t,c),r.error((p?`[${p}]`:`[${s.FILE_PREFIX.DeleteResponseHandler}]`)+" You cannot delete this record because it doesn't exist in the offline mode",Object(a.b)(u,c)),d=Object(b.a)(n.HTTP_STATUS_CODES.BadRequest,e.url,t)}var p;
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */return d}async function tr(e,t,r,o,s=[],u){const l=e.url;let c;r.info(or()+" Executing getClientMetadataResponseHandler.");const d=await async function(e,t,r,n,o=[],s){let u="";const l=n,c={},d={};let p=[];const f=de(t,r);if(p.push({name:"RequestUrl",value:t.url}),p.push({name:"MetadataType",value:f.MetadataType}),p.push({name:"DependencyDepth",value:f.DependencyDepth}),p.push({name:"MetadataSubtype",value:f.MetadataSubtype}),r.info(or()+" Executing getGCMOperationResponseData",Object(a.b)(o,p)),l&&l.length>0)for(let e=0;e<l.length;e++)if(p=[],p.push({name:"NoOfResponsesReturnedFromDb",value:l.length}),p.push({name:"Index",value:e}),p.push({name:"RequestUrl",value:t.url}),l[e]&&l[e].rows.length>0)for(let t=0;t<l[e].rows.length;t++){const n=l[e].rows.item(t);if(n&&n.json){const t=n.json;let u;const l=ir(n,JSON.parse(t),e,s);if(u=rr(l,f),p.push({name:"MetadataType",value:l}),Object(i.m)(u))r.error(or()+" MetadataTypeKey evaluated to be null or empty",Object(a.b)(o,p));else{p.push({name:"MetadataTypeKey",value:u});const e=nr(t,l,f);if(ar(l))r.info(or()+" Creating response node for current MetaDataType."+u+". Taking response as it is as the response is already in required format",Object(a.b)(o,p)),d[u]=e;else if(d[u]){if(l===$.MetadataType.resourceString){const t=d[u][0];t.push(e),d[u]=[t]}else d[u].push(e);p.push({name:"NoOfMetadataForThisMetadataTypeKey",value:d[u].length}),r.info(or()+" Adding response for current MetaDataType."+u,Object(a.b)(o,p))}else d[u]=[e],l===$.MetadataType.resourceString&&(d[u]=[d[u]]),p.push({name:"NoOfMetadataForThisMetadataTypeKey",value:1}),r.info(or()+" Creating new response node for current MetaDataType."+u,Object(a.b)(o,p))}}else r.warn(or()+" Response returned from offline db has empty json.",Object(a.b)(o,p))}else r.warn(or()+" Response returned from offline db is empty at current index.",Object(a.b)(o,p));else r.warn(or()+" Response returned from offline db is empty",Object(a.b)(o,p));return c.Metadata=JSON.stringify(d),u=JSON.stringify(c),u}(0,e,r,o,s,u);return c=Object(b.b)(n.HTTP_STATUS_CODES.Ok,l,new Headers,d),c}function rr(e,t){let r;if(Object(i.p)(t))r="UserContext";else switch(e){case $.MetadataType.none:r="none";break;case $.MetadataType.workspace:r="Dashboards";break;case $.MetadataType.form:r="Forms";break;case $.MetadataType.component:r="Component";break;case $.MetadataType.entityCard:r="EntityCard";break;case $.MetadataType.quickCreateForm:r="QuickCreateForm";break;case $.MetadataType.customization:r="Customization";break;case $.MetadataType.listQuery:r="ListQuery";break;case $.MetadataType.grid:r="Grid";break;case $.MetadataType.command:r="Ribbons";break;case $.MetadataType.siteMap:r="Sitemap";break;case $.MetadataType.list:r="List";break;case $.MetadataType.dialog:r="Dialogs";break;case $.MetadataType.gridForm:r="GridForm";break;case $.MetadataType.inlineCreateForm:r="InlineCreateForm";break;case $.MetadataType.processControl:r="ProcessControl";break;case $.MetadataType.fetchXml:r="FetchXml";break;case $.MetadataType.chartDrilldownForm:r="ChartDrilldownForm";break;case $.MetadataType.entity:r="Entities";break;case $.MetadataType.attribute:r="Attributes";break;case $.MetadataType.webResource:r="WebResourcesContent";break;case $.MetadataType.applicationMetadata:r="ApplicationMetadata";break;case $.MetadataType.mainFormDialog:r="QuickEditForm";break;case $.MetadataType.chart:r="Chart";break;case $.MetadataType.uiStrings:r="UIStrings";break;case $.MetadataType.businessLogic:r="BusinessLogic";break;case $.MetadataType.searchPage:r="SearchPage";break;case $.MetadataType.globalApplicationMetadata:r="GlobalApplicationMetadata";break;case $.MetadataType.applicationMetadataUserContext:r="ApplicationMetadataUserContext";break;case $.MetadataType.staticJSFile:r="StaticJSFile";break;case $.MetadataType.layoutXml:r="LayoutXml";break;case $.MetadataType.draftsPage:r="DraftsPage";break;case $.MetadataType.duplicateRecordsPage:r="DuplicateRecordsPage";break;case $.MetadataType.applicationMetadataSettings:r="ApplicationMetadataSettings";break;case $.MetadataType.senderFormPage:r="SenderFormPage";break;case $.MetadataType.setRegarding:r="SetRegarding";break;case $.MetadataType.senderCreateFormPage:r="SenderCreateFormPage";break;case $.MetadataType.interactionCentricWorkspace:r="Dashboards";break;case $.MetadataType.taskBasedFlowGlobalMenu:r="TaskBasedFlowGlobalMenu";break;case $.MetadataType.taskBasedFlow:r="TaskBasedFlows";break;case $.MetadataType.interactionCentricForm:r="InteractionCentricForm";break;case $.MetadataType.cardForm:r="CardForm";break;case $.MetadataType.controlConfiguration:r="ControlConfiguration";break;case $.MetadataType.commandXaml:r="CommandXaml";break;case $.MetadataType.documentTemplate:r="DocumentTemplate";break;case $.MetadataType.viewSelector:r="ViewSelectors";break;case $.MetadataType.customControl:r="CustomControls";break;case $.MetadataType.formSelector:r="FormSelectors";break;case $.MetadataType.resourceString:r="ResourceStrings";break;case $.MetadataType.savedQueryVisualization:r="SavedQueryVisualizations";break;case $.MetadataType.label:r="Labels";break;case $.MetadataType.userView:case $.MetadataType.savedView:r="Views";break;case $.MetadataType.viewDefault:r="ViewDefault";break;case $.MetadataType.homePageConfiguration:r="CustomControlConfigurations";break;case $.MetadataType.optionSet:r="OptionSets";break;case $.MetadataType.quickCreateMenu:r="QuickCreateMenu";break;case $.MetadataType.userContext:r="UserContext";break;case $.MetadataType.businessProcessFlow:r="BusinessProcessFlowMetadata";break;case $.MetadataType.searchConfiguration:r="Search";break;case $.MetadataType.userQueryVisualization:r="UserQueryVisualizations";break;case $.MetadataType.visualizationSelector:r="VisualizationSelectors";break;case $.MetadataType.dashboardSelector:r="DashboardSelectors";break;case $.MetadataType.overallMetadataVersion:r="MetadataVersion";break;case $.MetadataType.appModule:r="AppModulePublished";break;case $.MetadataType.complexControl:r="ComplexControls";break;case $.MetadataType.displayString:r="DisplayStrings";break;case $.MetadataType.webResourceDescriptor:r="WebResources";break;case $.MetadataType.isActivityFlags:r="IsActivityFlags";break;case $.MetadataType.appModuleOfflineMetadata:r="AppModules";break;case $.MetadataType.appModuleSelector:r="AppModuleSelector";break;case $.MetadataType.bpfSelector:r="BPFSelectors";break;case $.MetadataType.dependencies:r="dependencies"}return r}function nr(e,t,r){let n;const a=JSON.parse(e);if(Object(i.p)(r))n=a;else switch(t){case $.MetadataType.attribute:case $.MetadataType.entity:n=a;break;case $.MetadataType.searchConfiguration:n=a.data.Search;break;case $.MetadataType.quickCreateMenu:n=a.data.QuickCreateMenu;break;default:n=a.data}return n}function ar(e){switch(e){case $.MetadataType.quickCreateMenu:case $.MetadataType.searchConfiguration:return!0;default:return!1}}function ir(e,t,r,n){let a=$.MetadataType.none;return a=e.metadatatype?e.metadatatype:t.metadatatype?t.metadatatype:n&&n[Q.METADATA_TYPE]&&Array.isArray(n[Q.METADATA_TYPE])&&r<n[Q.METADATA_TYPE].length?n[Q.METADATA_TYPE][r]:$.MetadataType.entity,a}function or(e){return e?`[${e}]`:`[${s.FILE_PREFIX.GetClientMetadataResponseHandler}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function sr(e){return e?`[${e}]`:`[${s.FILE_PREFIX.RetrieveMultipleResponseHandler}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function ur(e,t,r,a,o=[]){let u;if(Object(i.m)(a)||!Object(i.m)(a[0])&&a[0].rows.length){const t=new Headers;t.append(n.HEADER.ODADTA_ENTITY_ID,e.url),u=Object(b.b)(n.HTTP_STATUS_CODES.NoContent,e.url,t)}else r.error((l?`[${l}]`:`[${s.FILE_PREFIX.UpdateResponseHandler}]`)+" You cannot update this record because it doesn't exist in the offline mode",o),u=Object(b.a)(n.HTTP_STATUS_CODES.BadRequest,e.url,new O.a("You cannot update this record because it doesn't exist in the offline mode",n.ErrorCode.CannotUpdateOnlineRecord));var l;
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */return u}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
async function lr(e,t,r,i,o,u,l={}){let c;l.performanceControl&&l.performanceControl.startMarker(s.FILE_PREFIX.ResponseHandler);const d=r.TraceManager.getTracer(s.COMPONENT_NAMES.ResponseHandler),p=l.commonEventParameters||[];if(o)d.info((f?`[${f}]`:`[${s.FILE_PREFIX.ResponseHandler}]`)+" Executing error response handler",p),c=Object(b.a)(n.HTTP_STATUS_CODES.InternalServerError,e.url,o);else switch(t){case n.OPERATION.Create:c=await Jt(e,r,d,i,u,p);break;case n.OPERATION.Batch:c=await Kt(e,r,d,i,p,u);break;case n.OPERATION.Update:c=ur(e,0,d,i,p);break;case n.OPERATION.Retrieve:c=await Xt(e,r,d,i,p,u);break;case n.OPERATION.RetrieveMultiple:c=await async function(e,t,r,i,o,s=[]){const u=e.url;let l;const c=[];let d="";const p=await xt(e.url,t,r,s);let f=0,y=0,m=!1,h=!1;const g=i,E={};if(g&&g.length>0){const i=[];o&&o[n.ADDITIONAL_PARAMETERS.PageSize]?f=o[n.ADDITIONAL_PARAMETERS.PageSize]:r.warn(sr()+" Paging size is not passed in additional parameters",Object(a.b)(s,c)),g[0].rows.length>f&&(m=!0,h=!0),y=g[0].rows.length;for(let r=0;r<g[0].rows.length;r++){const n=g[0].rows.item(r);let a={},o=!1;Object(b.d)(e)&&(o=!0),n&&(a=await Object(b.c)(t,n,p,o),i.push(a))}E["@Microsoft.Dynamics.CRM.totalrecordcount"]=g[0].rows.length,E["@Microsoft.Dynamics.CRM.totalrecordcountlimitexceeded"]=h,E["@Microsoft.Dynamics.CRM.morerecords"]=m,E.value=i,d=JSON.stringify(E)}return c.push({name:"NoOfRecordsReturned",value:y}),c.push({name:"TotalRecordCountLimitExceeded",value:h}),c.push({name:"MoreRecords",value:m}),c.push({name:"PageSize",value:f}),t.EventManager.ReportComponentSuccess(sr(),Object(a.b)(s,c)),l=Object(b.b)(n.HTTP_STATUS_CODES.Ok,u,new Headers,d),l}(e,r,d,i,u,p);break;case n.OPERATION.GetClientMetadata:c=await tr(e,0,d,i,p,u);break;case n.OPERATION.Delete:c=er(e,0,d,i,p);break;case n.OPERATION.Upload:c=function(e,t,r,a,i){const o=e.url;let s;return s=Object(b.b)(n.HTTP_STATUS_CODES.NoContent,o),s}(e);break;default:c=Object(b.b)(n.HTTP_STATUS_CODES.BadRequest,e.url)}var f;
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */return l.performanceControl&&l.performanceControl.endMarker(s.FILE_PREFIX.ResponseHandler),c}class cr extends f{async intercept(e){const t=e.executionContext||{},r=e.request,n=t.requestType||Object(u.getRequestType)(r,this.applicationContext),a=this.applicationContext.TraceManager.getTracer(s.COMPONENT_NAMES.LocalODataExecutor),i=t.commonEventParameters||[];let o,l;a.info(dr()+" File Executor is processing");try{o=await function(e,t,r={}){const n=t.TraceManager.getTracer(s.COMPONENT_NAMES.FileExecutor);return new Promise((e,t)=>{try{return n.info(E()+" ExecuteFileRequest - File Executor successfully completed"),e({})}catch{return n.error(E()+" ExecuteFileRequest - Failed to get query from File Executor"),t(new Error("Query Generation throws error"))}})}(0,this.applicationContext,t)}catch(e){const o={name:e.name?e.name:"File Executor",message:e.message?e.message:JSON.stringify(e)};return l=await lr(r,n,this.applicationContext,void 0,o,void 0,t),a.error(`${dr()} File Local OData Client return back error response \n status code: ${l.status}\n error message: ${l.statusText}`,i),l}return a.info(dr()+" Response Handler is processing"),l=await lr(r,n,this.applicationContext,o,void 0,void 0,t),a.info(`${dr()} File Local OData Client return back response\n status code: ${l.status}\n url: ${l.url}`),l}}function dr(e){return e?`[${e}]`:`[${s.FILE_PREFIX.FileRequestInterceptor}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class pr extends g{constructor(e,t){super(e,t),this.setExecuteRequestInterceptor(new cr(this.applicationContext)).build()}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class fr extends g{constructor(e,t){super(e,t),this.setExecuteRequestInterceptor(new _t(this.applicationContext)).build()}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class yr{constructor(e,t){this._applicationContext=t,this._sqlLocalODataClient=new fr(e,t),this._fileLocalODataClient=new pr(e,t)}getLocalODataClient(e,t=[]){let r="";const a=this._applicationContext.TraceManager.getTracer(s.COMPONENT_NAMES.ODataExecutor);if(r=Object(u.getRequestType)(e,this._applicationContext),a.info(`${mr()} URL Parser Handler returns ${r} request type`),n.SQLQuerySupportedList.indexOf(r)>-1)return a.info(mr()+" Local OData Client Manager called SQL Local Client"),this._sqlLocalODataClient;if(n.FileQuerySupportedList.indexOf(r)>-1)return a.info(mr()+" Local OData Client Manager called File Local Client"),this._fileLocalODataClient;{const e="No LocalODataClient type matched with request";throw a.error(`${mr()} ${e}`,t),new Error(e)}}}function mr(e){return e?`[${e}]`:`[${s.FILE_PREFIX.LocalODataClientManager}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class hr extends f{async execute(e){throw new Error("execute function is not implemented")}async preprocessing(e){return e}async postprocessing(e,t){return e}async intercept(e){const t=e.request,r=await this.preprocessing(t);this.tracer.info(`${this.getExecuteRequestInterceptorPrefix()} Execute request start ${r.url}`);const n=await this.execute(r);this.tracer.info(`${this.getExecuteRequestInterceptorPrefix()} Execute request finish ${n.status}`);return await this.postprocessing(n,t)}getExecuteRequestInterceptorPrefix(e){return e?`[${e}]`:`[${s.FILE_PREFIX.ExecuteRequestInterceptor}]`}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class gr extends hr{async execute(e){const t=new Headers,r=e.additionalHeaders,n=this.applicationContext.TraceManager.getTracer(s.COMPONENT_NAMES.RemoteODataExecutor),o=[];if(Object(a.d)(e,o),r)for(const e in r)Object(i.j)(t,e)&&t.delete(e),t.append(e,r[e]);const u=new Request(e.url,{method:e.method,credentials:"same-origin",headers:t,body:e.body});try{return await fetch(u)}catch(t){const r=t&&t.message?t.message:"failed to fetch";return t.message=r,Object(a.a)(t,o),n.error(`${this.getHttpExecutorInterceptorPrefix()} ${r}`,o),Object(i.d)(t,e.url)}}getHttpExecutorInterceptorPrefix(e){return e?`[${e}]`:`[${s.FILE_PREFIX.HttpExecutorInterceptor}]`}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class Er extends f{async intercept(e){let t=e.request;const r=Object(i.g)(t.url),n="GET"===t.method&&r.length>1800,o=this.applicationContext.TraceManager.getTracer(s.COMPONENT_NAMES.RemoteODataExecutor),u=e.executionContext?e.executionContext.commonEventParameters:[],l=[];l.push({name:"UrlRequestLength",value:r.length}),o.info(this.getLongRequestInterceptorPrefix()+" Start Execute Remote Request ",Object(a.b)(u,l)),n&&(t=Object(i.c)([t]),o.warn(this.getLongRequestInterceptorPrefix()+" Built batch request for long request",Object(a.b)(u,l)));let c=await e.proceed(t);if(n){c=(await Object(i.t)(c))[0],o.warn(this.getLongRequestInterceptorPrefix()+" Parsed batch request for long request",Object(a.b)(u,l))}return o.info(this.getLongRequestInterceptorPrefix()+" Finish Execute Remote Request",Object(a.b)(u,l)),c}getLongRequestInterceptorPrefix(e){return e?`[${e}]`:`[${s.FILE_PREFIX.LongRequestInterceptor}]`}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class br{constructor(e,t){this._applicationContext=t,this._HttpODataClient=new g(e,this._applicationContext).addInterceptor(new Er(this._applicationContext)).setExecuteRequestInterceptor(new gr(this._applicationContext)).build()}getRemoteODataClient(e){return this._HttpODataClient}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class _r{constructor(e,t){this._remoteODataClient=new br(e,t),this._localODataClient=new yr(e,t),this._applicationContext=t}getODataClient(e){const t=this._applicationContext.TraceManager.getTracer(s.COMPONENT_NAMES.ODataExecutor),r=[];Object(a.d)(e,r);return Object(i.h)(e,t,r)===n.CLIENT_TYPE.local?(t.warn(this.getODataClientManagerPrefix()+" Execute request with local ODataClient",r),this._localODataClient.getLocalODataClient(e,r)):(t.warn(this.getODataClientManagerPrefix()+" Execute request with remote ODataClient",r),this._remoteODataClient.getRemoteODataClient(e))}getODataClientManagerPrefix(e){return e?`[${e}]`:`[${s.FILE_PREFIX.ODataClientManager}]`}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class vr{constructor(e,t){this._applicationContext=t,this._oDataClientManager=new _r(e||{},this._applicationContext)}async execute(e){const t=new o;t.startMarker(s.FILE_PREFIX.ODataExecutor);const r=this._applicationContext.TraceManager.getTracer(s.COMPONENT_NAMES.ODataExecutor);let l=[];Object(a.d)(e,l);try{const o=this._oDataClientManager.getODataClient(e),c={requestType:Object(u.getRequestType)(e,this._applicationContext),commonEventParameters:l,performanceControl:t},d=await o.execute(e,c),p=d.clone();if(t.endMarker(s.FILE_PREFIX.ODataExecutor),d.ok){Object(a.e)(p,l);const o=Object(i.h)(e,r,l);let u=[s.FILE_PREFIX.ODataExecutor,s.FILE_PREFIX.ResponseHandler];o===n.CLIENT_TYPE.local&&(u=u.concat([s.FILE_PREFIX.SQLGenerator,s.FILE_PREFIX.MetadataSQLExecutor,s.FILE_PREFIX.DataSQLExecutor])),Object(a.c)(t,u,l),this._applicationContext.EventManager.ReportComponentSuccess(s.COMPONENT_NAMES.ODataExecutor,l)}else{l=await Object(a.f)(p,l);const e=d.status;if(r.warn(`[${s.FILE_PREFIX.ODataExecutor}] Request returns Error Response with status code: ${e}`,l),n.UNEXPECTED_STATUS_CODE.includes(e)){let e="Request Failed",t=0;for(;t<l.length;t++)if(l[t].name===s.EVENT_PARAMETERS.ERROR_MESSAGE&&l[t].value!==s.EVENT_PARAMETERS.EMPTY_STRING){e=l[t].value;break}this._applicationContext.EventManager.ReportComponentFailure(s.COMPONENT_NAMES.ODataExecutor,new Error(e),void 0,l)}}return d}catch(t){const n=t&&t.message?t.message:"OData Request Failed";return t&&(t.message=n),Object(a.a)(t,l),r.error(`[${s.FILE_PREFIX.ODataExecutor}] ${n}`,l),this._applicationContext.EventManager.ReportComponentFailure(s.COMPONENT_NAMES.ODataExecutor,new Error(n),void 0,l),Object(i.d)(t,e.url)}}}},RslU:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveEntityMetadataErrorEnd=t.retrieveEntities=t.retrieveEntity=t.getUpdatedEntityRefCount=t.RETRIEVE_ENTITY_ACTION=t.ENTITY_TYPE=t.RETRIEVE_ENTITY_ASYNC=void 0;var o=r("pdzI"),s=r("f6dx"),u=r("0hOr"),l=r("Mx+d"),c=r("RHls"),d=r("wEu3"),p=r("Kz3/"),f=r("c7Ce"),y=r("OMC6");t.RETRIEVE_ENTITY_ASYNC="entity.retrieve.async";var m=["activityparty"];function h(e,t,r){return n(this,void 0,void 0,(function(){var n,i,o;return a(this,(function(a){switch(a.label){case 0:if(!(n=t.DataLayerConfiguration.MetadataProvider))return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,n.retrieveEntities(r)];case 2:return i=a.sent(),e((u=i,{type:s.GET_CLIENT_METADATA,payload:u})),[2,i];case 3:throw o=a.sent(),e(v(Object.keys(r))),o;case 4:return[3,6];case 5:throw new c.ErrorStatus("No metadata provider, GCM scenario is not yet supported");case 6:return[2]}var u}))}))}function g(e,t,r,n,a){var i,s,c={},p={};for(var f in r){var y=void 0,m=r[f],h=l.getEntityDescriptor(e,f);if(E(f)){var g=b(e,f,n,a,null===(i=n.DataLayerConfiguration.GarbageCollectionProvider)||void 0===i?void 0:i.getCurrentPage());g&&(p[f]=g)}h&&h.Initialized!==o.InitState.Uninitialized&&h.Initialized!==o.InitState.Partial?(y=u.getMissingAttributes(e,f,null!==(s=null!=m?m:h.AttributeNames)&&void 0!==s?s:[])).length>0&&(c[f]=y&&y.sort().filter((function(e,t,r){return r.indexOf(e)===t}))):c[f]=m&&m.sort().filter((function(e,t,r){return r.indexOf(e)===t}))}return Object.keys(p).length>0&&t(d.updateGCMetadataRefCount(p)),c}function E(e){return-1===m.indexOf(e)}function b(e,t,r,n,a){var i,o;if(!e)return null;if(!a&&(a=null===(i=r.DataLayerConfiguration.GarbageCollectionProvider)||void 0===i?void 0:i.getCurrentPage(),n)){var s=r.TraceManager.getTracer("RetrieveEntity"),u="getUpdatedEntityRefCount() called without pageId, action stack is : "+n.stack;s.info(u);var l=[];l.push({name:"errorString",value:u}),r.EventManager.ReportComponentSuccess("RetrieveEntity",l)}if(a&&""!==a){var c=f.getGCEntityMetadataRefCount(e,t),d=null==c?void 0:c.slice();return null!==(o=p.addReference(d,a))&&void 0!==o?o:null}return null}function _(e,t){var r,n,a={entities:{},attributes:{}};try{for(var o=i(t),s=o.next();!s.done;s=o.next()){var c=s.value;a.entities&&(a.entities[c]=l.getEntityDescriptor(e,c)),a.attributes&&(a.attributes[c]=u.getAttributesForEntity(e,c))}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a}function v(e){var t={};e.forEach((function(e){t[e]={Initialized:o.InitState.Error}}));var r={entities:t};return y.retrieveEntityMetadata(r)}t.ENTITY_TYPE="entity",t.RETRIEVE_ENTITY_ACTION="entity.retrieve",t.getUpdatedEntityRefCount=b,t.retrieveEntity=function(e,r,i){return{type:t.RETRIEVE_ENTITY_ASYNC,execute:function(t,o,s){var u=t.dispatch,l=t.getState;return n(this,void 0,void 0,(function(){var t,n,c;return a(this,(function(a){return(c={})[e]=r?null:null!=i?i:[],t=c,n=g(l(),u,t,o,s),0===Object.keys(n).length?[2,_(l(),[e])]:[2,h(u,o,n)]}))}))}}},t.retrieveEntities=function(e){return{type:t.RETRIEVE_ENTITY_ASYNC,execute:function(t,r,i){var o=t.dispatch,s=t.getState;return n(this,void 0,void 0,(function(){var t;return a(this,(function(n){try{return e&&0!==Object.keys(e).length?(t=g(s(),o,e,r,i),0===Object.keys(t).length?[2,_(s(),Object.keys(e))]:[2,h(o,r,t)]):[2,Promise.resolve({})]}catch(e){c.convertErrorAndRethrow(e)}return[2]}))}))}}},t.retrieveEntityMetadataErrorEnd=v},SJSp:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addFilters=t.ParseXml=t.getAttributesMapFromFetch=t.getColumnSetFromFetch=t.setFetchXmlParameters=t.addContextFilter=t.createManyToManyContextFilter=t.createOneToManyContextFilter=t.removeOrderElements=t.createOrderElement=t.findLinkEntitySort=t.addSort=t.addChildCountAttribute=t.buildLinkedEntityNode=t.addLinkedEntity=t.addColumns=t.isFetchAll=t.getEntityFromFetch=t.getColumnNamesFromFetch=t.getNodeAttributeValueByName=t.parseFetchXmlFromString=t.compress=void 0;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n=r("UZ+8"),a=r("iWcK"),i=r("iDsU"),o=r("mVtf"),s=r("EY1R");function u(e){return(new DOMParser).parseFromString(e,"text/xml")}function l(e,t){if(!n.IsNullOrUndefined(e)&&!n.IsNullOrUndefined(e.attributes)){var r=e.attributes.getNamedItem(t);if(!n.IsNullOrUndefined(r))return null==r?void 0:r.nodeValue}return null}function c(e,t,r){var n=e.createAttribute(t);return n.value=r,n}function d(e,t,r){return l(e,r)===l(t,r)}function p(e){var t,r,a;if(n.IsNullOrUndefined(e)||null==e)return null;if(f(e))return null;for(var i=[],o=e.getElementsByTagName("attribute"),s=0;s<o.length;s++){var u=o[s],l=null===(t=u.attributes.getNamedItem("name"))||void 0===t?void 0:t.nodeValue;if("link-entity"!==(null===(r=u.parentNode)||void 0===r?void 0:r.nodeName)||n.IsNullOrUndefined(u.parentNode.attributes.getNamedItem("alias")))i[s]=l;else{var c=null===(a=u.parentNode.attributes.getNamedItem("alias"))||void 0===a?void 0:a.nodeValue;i[s]=c+"."+l}}return i}function f(e){return!!e&&e.getElementsByTagName("all-attributes").length>0}function y(e,t,r){for(var n,a,i=e.getElementsByTagName("link-entity"),o=0;o<i.length;o++){var s=i[o];if(s.attributes.getNamedItem("alias")&&(null===(n=s.attributes.getNamedItem("alias"))||void 0===n?void 0:n.nodeValue)===t)for(var u=s.childNodes,l=0;l<u.length;l++){var c=u[l];if("attribute"===c.nodeName&&(null===(a=c.attributes.getNamedItem("name"))||void 0===a?void 0:a.nodeValue)===r)return s}}return null}function m(e,t,r){var n=e.createElement("order");return n.attributes.setNamedItem(c(e,"attribute",t)),n.attributes.setNamedItem(c(e,"descending",r.toString())),n}function h(e,t,r,n){return'<link-entity name="'+e+'" from="'+t+'" to="'+r+'" alias="bb">\n\t<filter type="and">\n\t\t<condition attribute="'+(n||t)+'" operator="eq" uitype="'+e+'" />\n\t</filter>\n\t</link-entity>'}t.compress=function(e){return e.replace(/[\r\n\t]/g,"").replace(/ \/>/g,"/>")},t.parseFetchXmlFromString=u,t.getNodeAttributeValueByName=l,t.getAttributesMapFromFetch=function(e){var t,r,a=o.parseXmlDocument(e);if(!a)return{};for(var i=a.getElementsByTagName("entity")[0].getAttribute("name"),u=((t={})[i]=[],t),l=a.getElementsByTagName("attribute"),c=0;c<l.length;c++){var d=l[c],p=null===(r=d.attributes.getNamedItem("name"))||void 0===r?void 0:r.nodeValue;if(d&&d.parentNode&&"link-entity"===d.parentNode.nodeName&&!n.IsNullOrUndefined(d.parentNode.getAttribute("name"))){var f=d.parentNode.getAttribute("name"),y=d.getAttribute("name");f&&y&&s.addAttributes(u,f,[y])}else i&&s.addAttributes(u,i,[p])}return u},t.getColumnNamesFromFetch=p,t.getEntityFromFetch=function(e){var t=e.getElementsByTagName("entity");return n.IsNullOrUndefined(t)||n.IsNullOrUndefined(t[0])?null:t[0].getAttribute("name")},t.isFetchAll=f,t.addColumns=function(e,t){if(!n.IsNullOrUndefined(t)&&t.length&&!n.IsNullOrUndefined(e)){var r=p(e),a=e.getElementsByTagName("entity");if(a&&a[0])for(var i=a[0].firstChild,o=0;o<t.length;o++)if(-1===(null==r?void 0:r.indexOf(t[o]))){var s=e.createElement("attribute");s.attributes.setNamedItem(c(e,"name",t[o])),a[0].insertBefore(s,i)}}},t.buildLinkedEntityNode=function(e,t){var r='<link-entity name="'+e.name+'" from="'+e.from+'" to="'+e.to+'"';if(r+=e.linkType?' link-type="'+e.linkType+'"':"",r+=e.alias?' alias="'+e.alias+'"':"",0===t.length)return r+=" />";r+=">";for(var n=0;n<t.length;n++)r+='<attribute name="'+t[n]+'" />';return r+="</link-entity>"},t.addLinkedEntity=function(e,t){if(!n.IsNullOrUndefinedOrEmptyString(t)){var r=e.getElementsByTagName("entity")[0],a=!1,i=u(t),o=e.getElementsByTagName("link-entity");if(!n.IsNullOrUndefined(o))for(var s=["alias","name","from","to","link-type"],l=function(e){if(s.every((function(t){return d(o[e],i.documentElement,t)}))){for(var t=0;t<i.documentElement.childNodes.length;t++)o[e].appendChild(i.documentElement.childNodes[t].cloneNode());a=!0}},c=0;c<o.length;c++)l(c);a||n.IsNullOrUndefined(r)||r.appendChild(i.documentElement)}},t.addChildCountAttribute=function(e,t){var r=e.createElement("attribute");r.attributes.setNamedItem(c(e,"name",t)),r.attributes.setNamedItem(c(e,"rowaggregate","CountChildren")),r.attributes.setNamedItem(c(e,"alias","HierarchyDataChildCount6dcd9e4c001441b09237d51a34853d55")),e.getElementsByTagName("entity")[0].appendChild(r)},t.addFilters=function(e,t){if(!e)throw new Error("Invalid fetch xml document is passed");var r=o.parseXmlDocument(t),n=e.getElementsByTagName("entity")[0];r&&n.appendChild(r.firstChild)},t.addSort=function(e,t,r){var n;if(-1===t.indexOf("."))n=e.getElementsByTagName("entity")[0];else{var a=t.split(".");if(2===a.length)n=y(e,a[0],t=a[1])}if(n){for(var i=n.getElementsByTagName("order"),o=m(e,t,r),s=!1,u=0;u<i.length;u++)if(d(i[u],o,"attribute")){s=!0,i[u].setAttribute("descending",r?"true":"false");break}s||n.appendChild(o)}},t.findLinkEntitySort=y,t.createOrderElement=m,t.removeOrderElements=function(e){for(var t,r=e.getElementsByTagName("order");r.length;){var n=r[0];null===(t=n.parentNode)||void 0===t||t.removeChild(n)}},t.createOneToManyContextFilter=h,t.createManyToManyContextFilter=function(e,t,r,n,a,i){return'<link-entity name="'+e+'" intersect="true" visible="false" to="'+t+'" from="'+i+'">\n\t'+h(n,a,r)+"\n</link-entity>"},t.addContextFilter=function(e,t,r){if(!n.IsNullOrUndefinedOrEmptyString(r)&&!n.IsNullOrUndefinedOrEmptyString(t)){var a=e.getElementsByTagName("entity")[0],i=u(t),o=i.getElementsByTagName("condition")[0];n.IsNullOrUndefined(o)||o.attributes.setNamedItem(c(i,"value",r)),n.IsNullOrUndefined(a)||a.appendChild(i.firstChild)}},t.setFetchXmlParameters=function(e,t,r,a,i){if(e){if(e&&e.firstChild&&"fetch"!==e.firstChild.nodeName)return;n.IsNullOrUndefined(e.firstChild.attributes.getNamedItem("returntotalrecordcount"))&&e.firstChild.attributes.setNamedItem(c(e,"returntotalrecordcount",a.toString())),e.firstChild.attributes.setNamedItem(c(e,"page",r.toString())),e.firstChild.attributes.setNamedItem(c(e,"count",t.toString())),e.firstChild.attributes.setNamedItem(c(e,"no-lock",i.toString()))}},t.getColumnSetFromFetch=function(e){if(f(e))return a.AllColumns.get_instance();var t=o.create(e),r=[],n=null==t?void 0:t.selectNodes("/fetch/entity/attribute");if(n&&n.get_count())for(var s=0;s<n.get_count();s++){var u=n.get_item(s);u&&r.push(u.getAttribute("name"))}return new i.LegacyColumnSet(r)},t.ParseXml=function(e){if(window.hasOwnProperty("DOMParser"))return(new DOMParser).parseFromString(e,"text/xml");if(window.hasOwnProperty("ActiveXObject")){var t=new window.ActiveXObject("Microsoft.XMLDOM");return t.async=!1,t.loadXML(e),t}return null}},SV4j:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogicalOperator=void 0,function(e){e[e.And=0]="And",e[e.Or=1]="Or",e[e.Not=2]="Not"}(t.LogicalOperator||(t.LogicalOperator={}))},SXiu:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.isINavigationErrorStatus=t.addErrorParameters=t.cloneUciError=t.createUciError=t.UCI_ERROR_NAME=void 0;t.UCI_ERROR_NAME="UciError";t.createUciError=function(e,t,r,n,a,i,o){void 0===o&&(o=!1);var s=new Error(e);return s.name="UciError",s.errorCode=t,s.errorParameters=r,s.displayTitle=n,s.displayMessage=a,s.blockErrorReporting=o,i&&(s.stack=i),s},t.cloneUciError=function(e){if(!e){var t=new Error("Received blank error object");return t.name="UciError",t.errorCode=2147746581,t}var r=new Error(e.message);return r.name="UciError",r.errorCode=e.errorCode||2147746581,r.errorParameters=e.errorParameters,r.displayTitle=e.displayTitle,r.displayMessage=e.displayMessage,r.blockErrorReporting=e.blockErrorReporting,r.innerError=e.innerError,e.stack&&(r.stack=e.stack),r},t.addErrorParameters=function(e,t){e&&t&&(e.errorParameters?e.errorParameters=e.errorParameters.concat(t):e.errorParameters=t)},t.isINavigationErrorStatus=function(e){return e&&e.errorCode}},"Sh+4":function(e,t,r){"use strict";r.r(t),r.d(t,"LegacyGuid",(function(){return i}));var n=r("OhA8"),a=r("cvWF");class i{constructor(e,t){if(this._formattedGuid="",t)this._rawGuid=e;else if(this._rawGuid=i._GetParsedString(e),Object(n.o)(this._rawGuid))throw new Error("Not a valid guid")}static get_empty(){return i._empty||(i._empty=new i("00000000000000000000000000000000",!0))}static createFromObjectData(e){return new i(e.rawguid)}static tryCreate(e){const t=i._GetParsedString(e);return Object(n.o)(t)?i.get_empty():new i(t)}static createFromFormattedGuidStringAndSkipParsing(e){return typeof e!==a.AttributeType.String||Object(n.o)(e)?i.get_empty():new i(e.replace(i._get_GuidStripperPattern(),""),!0)}static isNullOrEmpty(e){return!(!Object(n.m)(e)&&e.length)||!!new i(e).equals(i._empty)}static newGuid(){for(let e=0;e<36;e++)if(14!==e){if(8!==e&&13!==e&&18!==e&&23!==e){if(19===e){const e=Math.floor(16*Math.random());"0123456789abcdef".substr(3&e|8,1)}"".concat("0123456789abcdef".substr(Math.floor(16*Math.random()),1))}}else"".concat("4");return new i("".toString(),!0)}static _get_BraceAndHyphenGuidVerifierPattern(){return i._braceAndHyphenGuidVerifierPattern||(i._braceAndHyphenGuidVerifierPattern=new RegExp("^{(\\d|[a-f]){8}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){12}}$"))}static _get_GuidStripperPattern(){return i._guidStripperPattern||(i._guidStripperPattern=new RegExp("{|}|-","g"))}static _get_HyphenGuidVerifierPattern(){return i._hyphenGuidVerifierPattern||(i._hyphenGuidVerifierPattern=new RegExp("^(\\d|[a-f]){8}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){12}$"))}static _get_ContiguousGuidVerifierPattern(){return i._contiguousGuidVerifierPattern||(i._contiguousGuidVerifierPattern=new RegExp("^(\\d|[a-f]){32}$"))}static _GetParsedString(e){return Object(n.o)(e)?"":(e=e.toLowerCase(),i._get_HyphenGuidVerifierPattern().test(e)||i._get_BraceAndHyphenGuidVerifierPattern().test(e)?e.replace(i._get_GuidStripperPattern(),""):i._get_ContiguousGuidVerifierPattern().test(e)?e:"")}getObjectData(){return{rawguid:this._rawGuid}}equals(e){if(e instanceof i)return e._rawGuid===this._rawGuid;if("string"==typeof e)try{return new i(e)._rawGuid===this._rawGuid}catch(e){return!1}return!1}toString(){return this._formattedGuid||(this._formattedGuid=this._rawGuid.substring(0,8)+"-"+this._rawGuid.substring(8,12)+"-"+this._rawGuid.substring(12,16)+"-"+this._rawGuid.substring(16,20)+"-"+this._rawGuid.substring(20,32)),this._formattedGuid}}i.__typeName="Microsoft.Crm.Client.Core.Framework.Guid"},SywK:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.QUERYBUILDER_TRACE_CATEGORY_ID=t.queryStateToTelemetryParameters=t.QueryBuilderTelemetryHelper=void 0;var n=r("FDNG");t.QUERYBUILDER_TRACE_CATEGORY_ID="QueryBuilder";var a=function(){function e(){this._telemetryMessage="",this._telemetryParameters=[],this._operations=[]}return e.prototype.addOperation=function(e,t){this._telemetryMessage="to"===e||"from"===e?this._telemetryMessage?this._telemetryMessage+", "+t:t:this._telemetryMessage?this._telemetryMessage+", "+e:e,t&&this._operations.push({name:e,value:t})},e.prototype.addQueryInfoAndSendLog=function(t,r){e.tracer&&(this._addTelemetryParameter("viewId",t),this._addTelemetryParameter("entityLogicalName",r),this._addTelemetryParameter("operations",this._operations),e.tracer.info("[QueryBuilder] "+r+"-"+t+": "+this._telemetryMessage,this._telemetryParameters))},e.prototype._addTelemetryParameter=function(e,t){t&&this._telemetryParameters.push({name:e,value:t})},e}();t.QueryBuilderTelemetryHelper=a,t.queryStateToTelemetryParameters=function(e){var t,r,a,i,o,s,u,l,c,d=[];if(e){(null==e?void 0:e.viewId)&&d.push({name:"viewId",value:n.Guid.toString(null==e?void 0:e.viewId)}),(null==e?void 0:e.entityLogicalName)&&d.push({name:"entityLogicalName",value:null==e?void 0:e.entityLogicalName}),(null==e?void 0:e.useModernQueryBuilder)&&d.push({name:"useModernQueryBuilder",value:null==e?void 0:e.useModernQueryBuilder});var p=[];p.push({name:"isQuickFindSearch",value:null==e?void 0:e.isQuickFindSearch}),null===(t=null==e?void 0:e.sorts)||void 0===t||t.forEach((function(e){p.push({name:"orderBy",value:e})})),(null===(r=null==e?void 0:e.wheres)||void 0===r?void 0:r.length)&&(null===(a=null==e?void 0:e.wheres)||void 0===a?void 0:a.length)>0&&p.push({name:"where",value:null===(i=null==e?void 0:e.wheres)||void 0===i?void 0:i.length}),(null===(o=null==e?void 0:e.selects)||void 0===o?void 0:o.length)&&(null===(s=null==e?void 0:e.selects)||void 0===s?void 0:s.length)>0&&p.push({name:"select",value:null===(u=null==e?void 0:e.selects)||void 0===u?void 0:u.toString()}),null===(l=null==e?void 0:e.linkEntities)||void 0===l||l.forEach((function(e){p.push({name:"addLinkedEntity",value:e})})),null===(c=null==e?void 0:e.contextFiltersAndIds)||void 0===c||c.forEach((function(e){p.push({name:"applyContextFilter",value:e})})),(null==e?void 0:e.rollupType)&&p.push({name:"applyRollupContextFilter",value:null==e?void 0:e.rollupType.toString()}),d.push({name:"operations",value:p})}return d}},TvxW:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var n,a;r.d(t,"a",(function(){return i})),r.d(t,"i",(function(){return o})),r.d(t,"r",(function(){return s})),r.d(t,"f",(function(){return u})),r.d(t,"b",(function(){return l})),r.d(t,"j",(function(){return c})),r.d(t,"l",(function(){return d})),r.d(t,"m",(function(){return p})),r.d(t,"o",(function(){return f})),r.d(t,"p",(function(){return y})),r.d(t,"q",(function(){return m})),r.d(t,"n",(function(){return h})),r.d(t,"k",(function(){return g})),r.d(t,"e",(function(){return E})),r.d(t,"h",(function(){return b})),r.d(t,"g",(function(){return _})),r.d(t,"c",(function(){return v})),r.d(t,"d",(function(){return T})),function(e){e[e.Raw=0]="Raw",e[e.Numeric=1]="Numeric",e[e.Label=2]="Label",e[e.Value=3]="Value",e[e.State=4]="State",e[e.Id=5]="Id",e[e.Name=6]="Name",e[e.LogicalName=7]="LogicalName",e[e.AllowedStatusTransitions=8]="AllowedStatusTransitions",e[e.DefaultStatus=9]="DefaultStatus",e[e.Color=10]="Color"}(n||(n={})),function(e){e[e.Unknown=-1]="Unknown",e[e.Boolean=0]="Boolean",e[e.Customer=1]="Customer",e[e.DateTime=2]="DateTime",e[e.Decimal=3]="Decimal",e[e.Double=4]="Double",e[e.Integer=5]="Integer",e[e.Lookup=6]="Lookup",e[e.Memo=7]="Memo",e[e.Money=8]="Money",e[e.Owner=9]="Owner",e[e.PartyList=10]="PartyList",e[e.Picklist=11]="Picklist",e[e.State=12]="State",e[e.Status=13]="Status",e[e.String=14]="String",e[e.UniqueIdentifier=15]="UniqueIdentifier",e[e.CalendarRules=16]="CalendarRules",e[e.Virtual=17]="Virtual",e[e.BigInt=18]="BigInt",e[e.ManagedProperty=19]="ManagedProperty",e[e.EntityName=20]="EntityName",e[e.AliasedValue=21]="AliasedValue",e[e.EntityImage=23]="EntityImage",e[e.MultiSelectPicklist=24]="MultiSelectPicklist",e[e.File=25]="File",e[e.NavigationProperty=26]="NavigationProperty"}(a||(a={}));const i="annotation";var o,s,u;!function(e){e[e.lastFirst=0]="lastFirst",e[e.firstLast=1]="firstLast",e[e.lastFirstMiddleInitial=2]="lastFirstMiddleInitial",e[e.firstMiddleInitialLast=3]="firstMiddleInitialLast",e[e.lastFirstMiddle=4]="lastFirstMiddle",e[e.firstMiddleLast=5]="firstMiddleLast",e[e.lastSpaceFirst=6]="lastSpaceFirst",e[e.lastNoSpaceFirst=7]="lastNoSpaceFirst"}(o||(o={})),function(e){e[e.create=0]="create",e[e.update=1]="update",e[e.delete=3]="delete"}(s||(s={})),function(e){e[e.DateOnly=0]="DateOnly",e[e.DateAndTime=1]="DateAndTime"}(u||(u={}));const l=4406,c=4206,d=4208,p=4209,f=4211,y=4251,m={ASC:"asc",DESC:"desc"},h={dot:".",closeSQBracket:"]",comma:",",doubleQuote:'"',openSQBracket:"[",singleQuote:"'",space:" ",exclamation:"!",equal:"=",question:"?",openParenthesis:"(",closeParenthesis:")",asterisk:"*"},g={QUICKFIND_START:"/*QuickFindStart*/",QUICKFIND_END:"/*QuickFindEnd*/",SELECT_START:"/*SelectStart*/",SELECT_END:"/*SelectEnd*/",FROM_START:"/*FromStart*/",FROM_END:"/*FromEnd*/",CTE_START:"/*CTEStart*/",CTE_END:"/*CTEEnd*/",WHERE_START:"/*WhereStart*/",WHERE_END:"/*WhereEnd*/",ORDERBY_START:"/*OrderByStart*/",ORDERBY_END:"/*OrderByEnd*/"},E={PageSize:"25",PageNumber:"1",EmptyString:""},b={SqlTokensAvailable:"UseOfflineSqlTokens",MdlUsesDependencyInformation:"MDLUsesDependencyInformation"},_={primaryIdAttribute:"Entity metadata does not have primary id attribute",referencedId:"Missing ID of the referenced entity record.",invalidParameter:"Invalid parameters"},v={insert:"INSERT",select:"SELECT",update:"UPDATE",set:"SET",where:"WHERE",delete:"DELETE",orderBy:"ORDER BY",collateNoCase:"COLLATE NOCASE",limit:"LIMIT",offset:"OFFSET",from:"FROM",as:"AS",in:"IN",and:"AND",into:"INTO",values:"VALUES",placeholder:"?"},T={startOfCurrentHourUTC:"'!start-of-current-hour-utc!'",startOfTodayUTC:"'!start-of-today-utc!'",startOfWorkWeekUTC:"'!start-of-work-week-utc!'",startOfMonthUTC:"'!start-of-month-utc!'",startOfYearUTC:"'!start-of-year-utc!'",userTimezoneHourOffset:"!user-timezone-hour-offset!",userTimezoneMinuteOffset:"!user-timezone-minute-offset!",UTCHourOffset:"!utc-hour-offset!",UTCMinuteOffset:"!utc-minute-offset!"}},"UZ+8":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.isUrl=t.IsNullOrUndefinedOrEmptyString=t.IsNullOrUndefined=void 0;var n=/(http|https):\/\/(\w+:{0,1}\w*)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%!\-\/]))?/,a=/(dynamicsxrm):\/\/(\w+:{0,1}\w*)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%!\-\/]))?/,i=/^\/([0-9a-zA-Z_]+\/)?main.aspx/;function o(e){return null==e}t.IsNullOrUndefined=o,t.IsNullOrUndefinedOrEmptyString=function(e){return!!o(e)||"string"==typeof e&&""===e.trim()},t.isUrl=function(e){return n.test(e)||a.test(e)||i.test(e)}},VmZv:function(e,t,r){"use strict";var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.EntityRecord=void 0;var a=r("cvWF"),i=r("Sh+4"),o=r("FHhg"),s=r("UZ+8"),u=r("0hOr"),l=r("IvJe"),c=r("W2pJ"),d=r("JH5K"),p=r("iWcK"),f=r("iDsU"),y=r("PVp+"),m=r("AYBo"),h=r("WSZO"),g=r("BpGS"),E=r("N/D8"),b=r("AHn5"),_=function(){function e(t,r,n,a,i,o,u,l){this._accessRights=0,t instanceof e?(r=t._fields,n=t._fieldTypes,a=t._formattedValues,i=t._numericFormattedValues,o=t._relatedEntities,l=t._clientRetrieveOptions,this._identifier=t._identifier):this._identifier=t,d.throwOnNullOrUndefinedArgument(this._identifier,"identifier"),d.throwOnNullOrUndefinedArgument(r,"fields"),d.throwOnNullOrUndefinedArgument(n,"fieldTypes"),d.throwOnNullOrUndefinedArgument(a,"formattedValues"),d.throwOnNullOrUndefinedArgument(i,"numericFormattedValues"),d.throwOnNullOrUndefinedArgument(o,"relatedEntities"),this._fields=r,this._fieldTypes=n,this._formattedValues=a,this._numericFormattedValues=i,this._relatedEntities=o,this._columnSet=s.IsNullOrUndefined(u)?new f.LegacyColumnSet(new Array(0)):u,this.updateColumnSet(this.get_fieldNames()),this._changedFieldNames=[],this._cleanFields={},this._clientRetrieveOptions=l,this._accessRights=0;var c=this.getValue("activitytypecode");"activitypointer"===this._identifier.LogicalName&&c?this._actionableIdentifier=new g.LegacyEntityReference(c,this._identifier.Id):this._actionableIdentifier=this._identifier,this._userSharedAttributePrivileges={}}return Object.defineProperty(e.prototype,"fields",{get:function(){return this._fields},enumerable:!1,configurable:!0}),e.prototype.get_identifier=function(){return this._identifier},e.prototype.get_actionableIdentifier=function(){return this._actionableIdentifier},e.prototype.get_fieldTypes=function(){return this._fieldTypes},e.prototype.get_formattedValues=function(){return this._formattedValues},e.prototype.get_numericFormattedValues=function(){return this._numericFormattedValues},e.prototype.get_relatedEntities=function(){return this._relatedEntities},e.prototype.get_fieldNames=function(){var e=[],t=this._fields;for(var r in t){var n={key:r,value:t[r]};e.push(n.key)}return e},e.prototype.get_changedFieldNames=function(){return this._changedFieldNames},e.prototype.get_columnSet=function(){return this._columnSet},e.prototype.get_key=function(){return this.get_identifier().get_key()},e.prototype.get_clientRetrieveOptions=function(){return this._clientRetrieveOptions},e.prototype.set_clientRetrieveOptions=function(e){var t,r;this._clientRetrieveOptions=e;try{for(var a=n(this._relatedEntities.get_entityCollections()),i=a.next();!i.done;i=a.next()){i.value.get_value().set_clientRetrieveOptions(e)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}},e.prototype.get_accessRights=function(){return this._accessRights},e.prototype.set_accessRights=function(e){this._accessRights=e},e.prototype.get_userSharedAttributePrivileges=function(){return this._userSharedAttributePrivileges},e.prototype.set_userSharedAttributePrivileges=function(e){this._userSharedAttributePrivileges=e},e.prototype.get_entityRecordForProcess=function(){return this._entityRecordForProcess},e.prototype.set_entityRecordForProcess=function(e){return this._entityRecordForProcess=e,e},e.prototype.get_globalNavigationData=function(){return this._globalNavigationData},e.prototype.set_globalNavigationData=function(e){this._globalNavigationData=e},e.prototype.isDirty=function(){return this.get_changedFieldNames().length>0},e.prototype.clone=function(){var t=this.getObjectData(),r=t.columnset;s.IsNullOrUndefined(r)||(r.columns=r.columns.slice());var n=t.formattedfields,a={};for(var i in n){a[(c={key:i,value:n[i]}).key]=c.value}var o=t.numericformattedfields,u={};for(var l in o){var c;u[(c={key:l,value:o[l]}).key]=c.value}return t.formattedfields=a,t.numericformattedfields=u,e.createFromObjectData(t)},e.prototype.getObjectData=function(){var e=this._columnSet instanceof p.AllColumns;return{identifier:this._identifier.getObjectData(),fields:this._GetFieldsObjectData(),fieldtypes:{},formattedfields:this._formattedValues,numericformattedfields:this._numericFormattedValues,allcolumns:e,columnset:e?void 0:this._columnSet.getObjectData(),clientretrieveoptions:s.IsNullOrUndefined(this._clientRetrieveOptions)?void 0:this._clientRetrieveOptions.getObjectData(),accessrights:this._accessRights,sharedattributeprivileges:{},entityrecordforprocess:s.IsNullOrUndefined(this.get_entityRecordForProcess())?void 0:this.get_entityRecordForProcess().getObjectData(),globalnavigationdata:s.IsNullOrUndefined(this.get_globalNavigationData())?void 0:this.get_globalNavigationData().getObjectData()}},e.prototype._GetFieldsObjectData=function(){var e=this;return Object.keys(this._fields).reduce((function(t,r){return t[r]=e.getFieldObjectData(r),t}),{})},e.prototype.getFieldObjectData=function(t){return e.InternalGetFieldObjectData(this.getValue(t),this._fieldTypes[t])},e.prototype.getFields=function(){return this._GetFieldsObjectData()},e.prototype.hasValue=function(e){return e in this._fields},e.prototype.hasField=function(e){return e in this._fieldTypes},e.prototype.getValue=function(e){return this._fields[e]},e.prototype.getFormattedValue=function(e){return s.IsNullOrUndefined(this.get_formattedValues()[e])?this.get_fieldTypes()[e]===a.AttributeType.AliasedValue?this.getValue(e).get_value():this.getValue(e):this.get_formattedValues()[e]},e.prototype.getNumericFormattedValue=function(e){return this._numericFormattedValues[e]||this.getFormattedValue(e)},e.prototype.setValue=function(e,t){if(!(e in this.get_fieldTypes()))throw Error(e);t&&t.get_Label&&t.get_ValueString?this._fields[e]=E.OptionMetadata.createFromPicklistItem(t):this._fields[e]=t,this.updateColumnSet([e])},e.prototype.markFieldChanged=function(e){var t,r;if(this.get_changedFieldNames().indexOf(e)<0&&(this._cleanFields[e]=this._fields[e],this.get_changedFieldNames().push(e),this._fields[e]instanceof m.EntityCollection))try{for(var a=n(this._fields[e].get_entities()),i=a.next();!i.done;i=a.next()){i.value._MarkAllFieldsChanged()}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}},e.prototype._MarkAllFieldsChanged=function(){var e,t;try{for(var r=n(this.get_fieldNames()),a=r.next();!a.done;a=r.next()){var i=a.value;this.markFieldChanged(i)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},e.prototype.resetChanges=function(){this._changedFieldNames=[],this._cleanFields={}},e.prototype.mergeChanges=function(e){s.IsNullOrUndefined(this._clientRetrieveOptions)?this._clientRetrieveOptions=e._clientRetrieveOptions:this._clientRetrieveOptions.update(e._clientRetrieveOptions),this.set_accessRights(e.get_accessRights()),this.mergeEntityRecordFields(e),this._entityRecordForProcess=e._entityRecordForProcess,this._globalNavigationData=e._globalNavigationData},e.prototype.mergeEntityRecordFields=function(e){var t=e._fields;for(var r in t){(u={key:r,value:t[r]}).key in this._fields&&c.areValuesEqual(this._fields[u.key],u.value)||(this._fields[u.key]=u.value)}var n=e._fieldTypes;for(var a in n){var i=(u={key:a,value:n[a]}).key;i in this._fieldTypes||(this._fieldTypes[i]=e._fieldTypes[i]),i in this._fields&&!(i in e._fields)&&(delete this._fields[i],delete this._formattedValues[i],delete this._numericFormattedValues[i])}var o=e._formattedValues;for(var s in o){var u;(u={key:s,value:o[s]}).key in this._formattedValues&&c.areValuesEqual(this._formattedValues[u.key],u.value)||(this._formattedValues[u.key]=u.value)}e.get_columnSet()instanceof p.AllColumns?this.updateColumnSet(e.get_columnSet()):this.updateColumnSet(this.get_fieldNames())},e.prototype.initializeValue=function(e,t,r){this._fields[e]=t,e in this._fieldTypes||(this._fieldTypes[e]=r),this.updateColumnSet([e])},e.prototype.updateColumnSet=function(e,t){var r,a,i,o,u,l;if(e=e,!(this.get_columnSet()instanceof p.AllColumns)){if(e instanceof p.AllColumns)this._columnSet=p.AllColumns.get_instance();else{var c=void 0;c=e instanceof f.LegacyColumnSet?e.get_Columns():e;var d=this._columnSet;try{for(var y=n(c),m=y.next();!m.done;m=y.next()){var h=m.value;d.get_Columns().indexOf(h)<0&&d.get_Columns().push(h)}}catch(e){r={error:e}}finally{try{m&&!m.done&&(a=y.return)&&a.call(y)}finally{if(r)throw r.error}}}if(!s.IsNullOrUndefined(t)&&t&&(null==t?void 0:t.length)>0)try{for(var g=n(t),E=g.next();!E.done;E=g.next()){var b=E.value,_=this.get_relatedEntities().getByRelationship(b.get_relationship());if(_)try{for(var v=(u=void 0,n(_.get_entities())),T=v.next();!T.done;T=v.next()){T.value.updateColumnSet(b.get_ColumnSet())}}catch(e){u={error:e}}finally{try{T&&!T.done&&(l=v.return)&&l.call(v)}finally{if(u)throw u.error}}}}catch(e){i={error:e}}finally{try{E&&!E.done&&(o=g.return)&&o.call(g)}finally{if(i)throw i.error}}}},e.createFromObjectData=function(t){var r,n,a={},i=t.identifier&&g.LegacyEntityReference.createFromObjectData(t.identifier),o=e.createFieldsFromObjectData(t.fields,a);r=t.allcolumns?p.AllColumns.get_instance():f.LegacyColumnSet.createFromObjectData(t.columnset),t.clientretrieveoptions&&(n=y.ClientRetrieveOptions.createFromObjectData(t.clientretrieveoptions));var u=new e(i,o,a,t.formattedfields,t.numericformattedfields,new b.RelatedEntityCollection(new Array(0)),r,n);u.set_accessRights(t.accessrights);var l=t.entityrecordforprocess;s.IsNullOrUndefined(l)||u.set_entityRecordForProcess(e.createFromObjectData(l));var c=t.globalnavigationdata;return s.IsNullOrUndefined(c)||u.set_globalNavigationData(e.createFromObjectData(c)),u},e.createSingleFieldFromObjectData=function(t,r){return e.InternalCreateFieldFromObjectData(t,r)},e.createFieldsFromObjectData=function(t,r){var n={};for(var a in t){var i={key:a,value:t[a]};n[i.key]=e.InternalCreateFieldFromObjectData(i.value,r[i.key])}return n},e.InternalCreateFieldFromObjectData=function(e,t){if(s.IsNullOrUndefined(e))return null;switch(t){case a.AttributeType.AliasedValue:return h.LegacyAliasedValue.createFromObjectData(e);case a.AttributeType.Customer:case a.AttributeType.Lookup:case a.AttributeType.Owner:return g.LegacyEntityReference.createFromObjectData(e);case a.AttributeType.UniqueIdentifier:return i.LegacyGuid.createFromObjectData(e);case a.AttributeType.DateTime:return new Date(Date.parse(e));case a.AttributeType.Status:case a.AttributeType.State:case a.AttributeType.Boolean:case a.AttributeType.PickList:return E.OptionMetadata.createFromObjectData(e);case a.AttributeType.PartyList:return m.EntityCollection.createFromObjectData(e);default:return e}},e.InternalGetFieldObjectData=function(e,t){if(s.IsNullOrUndefined(e))return null;switch(t){case a.AttributeType.AliasedValue:return e.getObjectData();case a.AttributeType.Customer:case a.AttributeType.Lookup:case a.AttributeType.Owner:case a.AttributeType.UniqueIdentifier:return e.getObjectData();case a.AttributeType.DateTime:return e.toString();case a.AttributeType.Status:case a.AttributeType.State:case a.AttributeType.Boolean:case a.AttributeType.PickList:case a.AttributeType.PartyList:return e.getObjectData();default:return e}},e.recordDataToLegacyEntityRecord=function(t,r,n,a,i,s){void 0===s&&(s=l.FieldValueRetrievalBehavior.LatestEntered);var c=new e(o.EntityReference.toLegacyEntityReference(r),{},{},{},{},new b.RelatedEntityCollection([]));for(var d in n){var p=u.getAttributeDescriptor(t,r.etn,d);if(p){var f=l.getLegacyValueForField(t,r.etn,d,n[d],s);c.initializeValue(d,f,p.Type),c.markFieldChanged(d)}else{var y="Attribute "+d+" for entity "+r.etn+" could not be found.";i.warn("EntityRecord "+y)}}return c},e}();t.EntityRecord=_},W2pJ:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.areValuesEqual=void 0;var n=r("Sh+4");t.areValuesEqual=function e(t,r){return!t&&!r||!(!t&&r||t&&!r)&&(t instanceof n.LegacyGuid&&r instanceof n.LegacyGuid||t.equals&&r.equals?t.equals(r):t.get_ValueString&&t.get_Label&&r.get_ValueString&&r.get_Label?t.get_ValueString()===r.get_ValueString()&&t.get_Label()===r.get_Label():t.get_value&&r.get_value?e(t.get_value(),r.get_value()):(t instanceof Date&&r instanceof Date&&(t=t.valueOf(),r=r.valueOf()),t===r))}},WPdH:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeyValuePair=void 0;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n=function(){function e(e,t){this._key=e,this._value=t}return e.prototype.get_key=function(){return this._key},e.prototype.get_value=function(){return this._value},e}();t.KeyValuePair=n},WSZO:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyAliasedValue=void 0;var n=r("VmZv"),a=function(){function e(e,t,r){this._entityLogicalName=e,this._attributeLogicalName=t,this._attributeType=r}return e.prototype.get_entityLogicalName=function(){return this._entityLogicalName},e.prototype.get_attributeLogicalName=function(){return this._attributeLogicalName},e.prototype.get_attributeType=function(){return this._attributeType},e.prototype.get_value=function(){return this._innerValue},e.prototype.set_value=function(e){return this._innerValue=e,e},e.prototype.getObjectData=function(){return{entityLogicalName:this._entityLogicalName,attributeLogicalName:this._attributeLogicalName,attributeType:this._attributeType,value:n.EntityRecord.InternalGetFieldObjectData(this._innerValue,this._attributeType)}},e.createFromObjectData=function(t){var r=t.attributeLogicalName,a=t.entityLogicalName,i=t.attributeType,o=t.value,s=i,u=new e(a,r,s);return u.set_value(n.EntityRecord.InternalCreateFieldFromObjectData(o,s)),u},e}();t.LegacyAliasedValue=a,a.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.AliasedValue"},Z7iH:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilterExpression=void 0;var n=r("DVFg"),a=r("SV4j"),i=r("DCxx"),o=r("UZ+8"),s=function(){function e(e,t,r,n){this._FilterOperator=0,this._IsQuickFindFields=!1,this._set_filterOperator(e),this.set_filterExpressionId(t),this._set_filterExpressions([]),o.IsNullOrUndefined(r)?this._set_isQuickFindFields(!1):this._set_isQuickFindFields(r),o.IsNullOrUndefined(n)?this._set_hint(null):this._set_hint(n)}return e.prototype.get_filterExpressionId=function(){return this._FilterExpressionId},e.prototype.set_filterExpressionId=function(e){this._FilterExpressionId=e},e.prototype.get_filterOperator=function(){return this._FilterOperator},e.prototype._set_filterOperator=function(e){return this._FilterOperator=e,e},e.prototype.get_isQuickFindFields=function(){return this._IsQuickFindFields},e.prototype._set_isQuickFindFields=function(e){return this._IsQuickFindFields=e,e},e.prototype.get_hint=function(){return this._Hint},e.prototype._set_hint=function(e){this._Hint=e},e.prototype.get_conditions=function(){return this._Conditions},e.prototype._set_conditions=function(e){return this._Conditions=e,e},e.prototype.get_filterExpressions=function(){return this._FilterExpressions},e.prototype._set_filterExpressions=function(e){return this._FilterExpressions=e,e},e.prototype.addCondition=function(e,t,r,a,i){r=r,i=o.IsNullOrUndefined(i)?"":i;var s=new n.Condition(e,t,r);return s.set_entityName(a),s.set_conditionName(i),this.get_conditions()||this._set_conditions([]),this.get_conditions().push(s),this},e.prototype.addFilterExpression=function(e){return e?(this.get_filterExpressions()||this._set_filterExpressions([]),this.get_filterExpressions().push(e),this):this},e.prototype.clone=function(){var t=new e(this.get_filterOperator(),this.get_filterExpressionId());if(this.get_conditions()){t._set_conditions([]);for(var r=0;r<this.get_conditions().length;r++)t.get_conditions().push(this.get_conditions()[r].clone())}else t._set_conditions(null);if(this.get_filterExpressions()){t._set_filterExpressions([]);for(r=0;r<this.get_filterExpressions().length;r++)t.get_filterExpressions().push(this.get_filterExpressions()[r].clone())}else t._set_filterExpressions(null);return t},e.prototype.toFetchXml=function(){return e._CreateXmlFilter(this)},e._CreateXmlFilter=function(t){var r="";if(!t||!(t.get_filterExpressions()&&t.get_filterExpressions().length||t.get_conditions()&&t.get_conditions().length))return r;if(t.get_conditions()){t.get_conditions().length>0&&(r+='<filter type="'+a.LogicalOperator[t.get_filterOperator()].toLowerCase()+'"',t.get_isQuickFindFields()&&(r+=' isquickfindfields="1"'),r+=">",o.IsNullOrUndefinedOrEmptyString(t.get_hint())||(r+=' hint="'+t.get_hint().toLowerCase()+'"'));for(var n=0;n<t.get_conditions().length;n++){var s=t.get_conditions()[n];if(r+="<condition ",o.IsNullOrUndefinedOrEmptyString(s.get_entityName())||(r+='entityname="'+s.get_entityName()+'" '),s.get_value())if("string"==typeof s.get_value())r+='attribute="'+s.get_attributeName()+'" operator="'+s.get_operator()+'" value="'+i.xmlAttributeEncode(s.get_value())+'" />';else{var u=s.get_value();r+='attribute="'+s.get_attributeName()+'" operator="'+s.get_operator()+'">';for(var l=0;l<u.length;l++)r+="<value>"+i.xmlEncode(u[l])+"</value>";r+="</condition>"}else r+='attribute="'+s.get_attributeName()+'" operator="'+s.get_operator()+'"/>'}t.get_conditions().length>0&&(r+="</filter>")}else{t.get_filterExpressions().length>1&&(r+='<filter type="'+a.LogicalOperator[t.get_filterOperator()].toLowerCase()+'"',t.get_hint()&&(r+=' hint="'+t.get_hint().toLowerCase()+'"'),r+=">");for(n=0;n<t.get_filterExpressions().length;n++)r+=e._CreateXmlFilter(t.get_filterExpressions()[n]);t.get_filterExpressions().length>1&&(r+="</filter>")}return r},e}();t.FilterExpression=s},a5Wk:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.buildBatchRequest=void 0;var a=r("17Cn"),i=r("vqTk");function o(e,t,r){var a,i,o="",u=1;try{for(var l=n(r),c=l.next();!c.done;c=l.next()){var d=c.value;if(d.serializationFailure)throw d.serializationFailure;o+="--"+t+"\n",o+="Content-Type: application/http\nContent-Transfer-Encoding: binary\n",o+="Content-ID: "+u+++"\n",o+="\n",o+=s(e,d)}}catch(e){a={error:e}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(a)throw a.error}}return o+="--"+t+"--\n"}function s(e,t){var r=t.method+" "+e+t.urlParameters+" HTTP/1.1\n";for(var n in t.additionalHeaders)n!==a.HEADER.CONTENT_TYPE&&"GET"!==t.method&&(r+=n+": "+t.additionalHeaders[n]+"\n");return"GET"!==t.method&&(r+=a.HEADER.CONTENT_TYPE+": application/json;type=entry\n"),r+="\n",t.body&&(r+=t.body),r}function u(e){return e+"_"+new Date(Date.now()).getTime()}t.buildBatchRequest=function(e,t,r){var l,c,d;if(!e||!e.length)return{serializationFailure:"Attempted to create an OData batch with empty list of requests"};var p="";r||(r=u("batch"));var f=t.DataLayerConfiguration.useAbsolutePaths?"":""+t.DataLayerConfiguration.baseUri+i.WEB_API_URL_FRAGMENT;try{for(var y=n(e),m=y.next();!m.done;m=y.next()){var h=m.value;p+="--"+r+"\n";var g="";if(Array.isArray(h)){var E=h,b=u("changeset");g=o(f,b,E),p+="Content-Type: multipart/mixed;boundary="+b+"\n"}else{var _=h;if(_.serializationFailure)return _;g=s(f,_),p+="Content-Type: application/http\nContent-Transfer-Encoding: binary\n"}p+="\n",p+=g,p+="\n"}}catch(e){l={error:e}}finally{try{m&&!m.done&&(c=y.return)&&c.call(y)}finally{if(l)throw l.error}}var v="--"+r+"--\r\n\0";return p.endsWith(v+"\n")?p=p.substr(0,p.length-1):p+=v,{urlParameters:"$batch",additionalHeaders:(d={},d[a.HEADER.CONTENT_TYPE]="multipart/mixed;boundary="+r,d.Accept=i.HEADER_VALUES.APPLICATION_JSON,d),body:p,method:"POST"}}},aiEo:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFetchXmlForAliasedValues=t.deserializeEntityCollection=t.parseQueryForAliasedValues=void 0;var n=r("UZ+8"),a=r("AYBo"),i=r("mVtf"),o=r("GSc/"),s=r("EY1R"),u=r("0hOr"),l=r("Mx+d"),c=r("SJSp"),d=r("gkFy");function p(e){for(var t={},r={},n=(new DOMParser).parseFromString(e,"text/xml"),a=n.getElementsByTagName("link-entity"),i=0;i<a.length;++i){var o=a[i],u=o.getAttribute("alias"),l=o.getAttribute("name"),c=o.getElementsByTagName("attribute");if(c.length)for(var d=0;d<c.length;++d){var p=c.item(d),f=u+"."+(b=p?p.getAttribute("name"):null),y=u+"_x002e_"+b;t[f]={alias:u,aliasedEtn:l,aliasedValueFieldName:b,oDataAlias:[f,y],oDataSeparator:[".","_x002e_"]},t[y]={alias:u,aliasedEtn:l,aliasedValueFieldName:b,oDataAlias:[y,f],oDataSeparator:["_x002e_","."]},s.addAttributes(r,l,[b])}}var m=n.querySelectorAll("entity > attribute[alias]"),h=n.getElementsByTagName("entity"),g=h&&h[0]?h[0].getAttribute("name"):"";for(i=0;i<m.length;++i){var E=m[i],b=(u=E.getAttribute("alias"),E.getAttribute("name")),_=E.getAttribute("rowaggregate");t[""+b]={alias:u,aliasedValueEtn:g,aliasedValueFieldName:b,oDataAlias:[""+u],oDataSeparator:[""],isAttributeAlias:!0,rowaggregate:_}}return{aliasedValueDescriptors:t,entity2AttributesMap:r}}t.deserializeEntityCollection=function(e,t,r,s,p,f,y,m,h,g){void 0===m&&(m=d.PayloadFormat.OData);var E=t instanceof o.LegacyQuery?null==t?void 0:t.get_EntityLogicalName():null==t?void 0:t.entityLogicalName,b=l.getEntityDescriptor(e,E),_=u.getAttributesForEntity(e,E),v=i.parseXmlDocument(t instanceof o.LegacyQuery?null==t?void 0:t.get_FetchXml():null==t?void 0:t.fetchXml),T=t instanceof o.LegacyQuery?null==t?void 0:t.GetColumnNamesFromFetch():c.getColumnNamesFromFetch(v),O=function(e,t){var r=[];if(t===d.PayloadFormat.SQL&&e.rows&&e.rows.length){r=[];for(var n=0;n<e.rows.length;n++)r.push(e.rows.item(n))}else r=t===d.PayloadFormat.OData&&e&&e.value&&e.value.length?e.value:[];return r}(s,m).map((function(n){return d.createEntityRecordFromResponse(e,n,b,_,T,t instanceof o.LegacyQuery?null==t?void 0:t.get_ColumnSet():c.getColumnSetFromFetch(v),null,r,y,m)}));return function(e,t,r,i,s,u,l){n.IsNullOrUndefined(l)&&(l=e["@Microsoft.Dynamics.CRM.totalrecordcountlimitexceeded"]||!1);l?i=-1:n.IsNullOrUndefined(i)&&(i=e["@Microsoft.Dynamics.CRM.totalrecordcount"]||r.length);n.IsNullOrUndefined(u)&&(u=e["@Microsoft.Dynamics.CRM.morerecords"]);s&&t instanceof o.LegacyQuery&&(null==t||t.set_PagingCookie(s));return new a.EntityCollection(r,u,i,l,t instanceof o.LegacyQuery?t:null)}(s,t,O,p,f,h,g)},t.parseQueryForAliasedValues=function(e){return p(null==e?void 0:e.get_FetchXml())},t.parseFetchXmlForAliasedValues=p},atuF:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.serializeEntityRecord=void 0;var a=r("cvWF"),i=r("FDNG"),o=r("FHhg"),s=r("pdzI"),u=r("jLS2");function l(e){var t,r;if(!e)throw new Error("Legacy entity record is null");var a=e.get_fieldNames(),i=e.get_fieldTypes(),l={},d=new Date;if(a)try{for(var p=n(a),f=p.next();!f.done;f=p.next()){var y=f.value,m=i[y],h=e.getValue(y);null!==h?l[y]=c(y,m,h,e,d):l[y]=null}}catch(e){t={error:e}}finally{try{f&&!f.done&&(r=p.return)&&r.call(p)}finally{if(t)throw t.error}}var g,E,b=e.get_globalNavigationData();if(b){var _=o.EntityReference.fromLegacyEntityReference(b.get_identifier());_&&(E=_.id);var v=b.getValue("processid");if(v)g=o.EntityReference.fromLegacyEntityReference(v).id}return{initialized:s.InitState.Initialized,identifier:o.EntityReference.fromLegacyEntityReference(e.get_identifier()),accessRights:u.serializeAccessRights(e),fields:l,businessProcessFlowId:g,businessProcessFlowInstanceId:E}}function c(e,t,r,s,u){var d,p,f,y,m={errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1};switch(t){case a.AttributeType.Boolean:case a.AttributeType.PickList:case a.AttributeType.State:case a.AttributeType.Status:var h=r;return{label:h.get_Label(),valueString:h.get_ValueString(),timestamp:u,validationResult:m};case a.AttributeType.UniqueIdentifier:var g=r;return{id:i.Guid.fromLegacyGuid(g),timestamp:u,validationResult:m};case a.AttributeType.Customer:case a.AttributeType.Lookup:case a.AttributeType.Owner:var E=r;return{reference:o.EntityReference.fromLegacyEntityReference(E),timestamp:u,validationResult:m};case a.AttributeType.AliasedValue:var b=r,_=b.get_entityLogicalName(),v=b.get_attributeLogicalName(),T=b.get_attributeType();return{attributeLogicalName:v,entityLogicalName:_,innerValue:c(e,T,b.get_value(),s,u),timestamp:u,validationResult:m,innerType:T};case a.AttributeType.PartyList:var O=r,S=[];try{for(var N=n(O.get_entities()),R=N.next();!R.done;R=N.next()){var M=R.value;S.push(l(M))}}catch(e){d={error:e}}finally{try{R&&!R.done&&(p=N.return)&&p.call(N)}finally{if(d)throw d.error}}return{list:S,timestamp:u,validationResult:m};case a.AttributeType.NavigationProperty:var A=r,C=[];try{for(var P=n(A),I=P.next();!I.done;I=P.next()){var w=I.value;C.push(l(w))}}catch(e){f={error:e}}finally{try{I&&!I.done&&(y=P.return)&&y.call(P)}finally{if(f)throw f.error}}return{list:C,timestamp:u,validationResult:m};default:t===a.AttributeType.DateTime&&(r=r&&r.toISOString());var D=s.get_formattedValues();if(D.hasOwnProperty(e))return{value:r,formatted:D[e],timestamp:u,validationResult:m};var F=s.get_numericFormattedValues();return F.hasOwnProperty(e)?{value:r,formatted:F[e],timestamp:u,validationResult:m}:{value:r,timestamp:u,validationResult:m}}}t.serializeEntityRecord=l},bMRw:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.ODataOperationType=t.ODataStructuralProperty=void 0,function(e){e[e.Unknown=0]="Unknown",e[e.PrimitiveType=1]="PrimitiveType",e[e.ComplexType=2]="ComplexType",e[e.EnumerationType=3]="EnumerationType",e[e.Collection=4]="Collection",e[e.EntityType=5]="EntityType"}(t.ODataStructuralProperty||(t.ODataStructuralProperty={})),function(e){e[e.Action=0]="Action",e[e.Function=1]="Function",e[e.CRUD=2]="CRUD",e[e.ExecuteMultiple=3]="ExecuteMultiple"}(t.ODataOperationType||(t.ODataOperationType={}))},c5ne:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveGridDataSucceeded=t.getUpdatedRefCount=t.GRID_CLASS_ID=t.retrieveGridData=t.RETRIEVE_GRID_DATA_ACTION=void 0;var i=r("gmsG"),o=r("FDNG"),s=r("Kz3/"),u=r("pdzI"),l=r("nRuH"),c=r("+//z"),d=r("n8WZ"),p=r("SywK"),f=r("UZ+8"),y=r("f6dx");Object.defineProperty(t,"RETRIEVE_GRID_DATA_ACTION",{enumerable:!0,get:function(){return y.RETRIEVE_GRID_DATA_ACTION}});var m=r("l7wu"),h=r("ILcb"),g=r("Mx+d"),E=r("c7Ce"),b=r("e3wK"),_=r("RHls"),v=r("djz1"),T=r("RslU");function O(e){return{type:y.RETRIEVE_GRID_DATA_ACTION,payload:e}}function S(e,t,r,n,a,i){for(var s,l,c,d,p,y,m=v.serializeEntityCollection(a),h={},g=[],E={},_=0;_<m.length;_++){var T=null===(d=m[_].identifier)||void 0===d?void 0:d.etn;if(T){var O=o.Guid.toString(null===(p=m[_].identifier)||void 0===p?void 0:p.id);if(f.IsNullOrUndefined(T)||f.IsNullOrUndefined(O)||h[T]||(h[T]={}),h[T][O]=m[_],g.push(null===(y=m[_])||void 0===y?void 0:y.identifier),e){var S=N(e,T,i,O);if(T&&S)if(E[T])E[T][O]=S;else{var R=((s={})[O]=S,s);E[T]=R}}}}var M={entities:h,lists:(l={},l[r]={initialized:u.InitState.Initialized,lastRetrieved:new Date,records:g,pages:(c={},c[n.pageNumber]={pagingCookie:null==n?void 0:n.pagingCookie,startGuid:g&&g.length&&g[0].id,startIndex:0,moreRecords:a.get_moreRecords()},c),pageSize:null==n?void 0:n.pageSize,totalRecordCount:a.get_totalRecordCount(),totalRecordCountLimitExceeded:a.get_totalRecordCountLimitExceeded()},l)};return function(e,t,r,n,a,i,o){var s={},u=N(e,r,n,a,i);a&&u&&(s[a]=u);if(o&&Object.keys(o).length>0||s&&Object.keys(s).length>0){var l={entities:o,lists:s};t(b.gcUpdateData(l))}}(e,t,i,null,null,r,E),M}function N(e,t,r,n,a){var i,o;if(!e)return null;if(n&&""!==n)if(a){var u=E.getGCListQueryDataRefCount(e,a),l=null==u?void 0:u.slice();if(l)return null!==(i=s.addReference(l,n))&&void 0!==i?i:null}else if(t&&r){var c=E.getGCEntityRecordDataRefCount(e,t,r),d=null==c?void 0:c.slice();if(d)return null!==(o=s.addReference(d,n))&&void 0!==o?o:null}return null}t.GRID_CLASS_ID="E7A81278-8635-4D9E-8D4D-59480B391C5B",t.retrieveGridData=function(e,t){void 0===t&&(t=!1);var r=[];return{type:"gridData.retrieve.async",execute:function(s,f,E){var b,v=s.getState,N=s.dispatch;return n(this,void 0,void 0,(function(){var n,s,R,M,A,C,P,I,w,D,F;return a(this,(function(a){switch(a.label){case 0:if(a.trys.push([0,3,,4]),n=new l.UCIContext(o.Guid.newGuid().guid,null==E?void 0:E.isPreloadCall),r.push({name:i.EVENT_PARAMETERS.CLIENT_REQUEST_ID,value:n.RequestId()}),r.push({name:"isRefresh",value:t}),s=(null==e?void 0:e.key)||"query",!(R=null==e?void 0:e.entityLogicalName))throw new _.ErrorStatus("Unable to execute query without entity logical name");return M=h.ModernQueryBuilder.fromState(e),[4,N(T.retrieveEntity(R,!1))];case 1:if(a.sent(),A=v(),!(C=g.getPrimaryIdAttribute(A,R)))throw new _.ErrorStatus("Unable to identify primary id of entity "+R);return M.selectInternal(C,!1),P=M.getQueryState(v),r.push({name:p.QUERYBUILDER_TRACE_CATEGORY_ID,value:p.queryStateToTelemetryParameters(e)}),N(function(e,t,r){var n;void 0===r&&(r=!1);var a=t instanceof c.KeyQuery?null==t?void 0:t.get_PageSize():null==t?void 0:t.pageSize,i={lists:(n={},n[e]={initialized:r?u.InitState.Refreshing:u.InitState.Initializing,pageSize:a},n)};return{type:y.RETRIEVE_GRID_DATA_ACTION,payload:i}}(s,P,t)),[4,N(d.retrieveMultiple(e))];case 2:return I=a.sent(),w=null===(b=f.DataLayerConfiguration.GarbageCollectionProvider)||void 0===b?void 0:b.getCurrentPage(),D=S(A,N,s,e,I,w),N(O(D)),f.EventManager.ReportComponentSuccess(m.RETRIEVE_GRID_DATA,r),[2,D];case 3:return F=a.sent(),f.EventManager.ReportComponentFailure(m.RETRIEVE_GRID_DATA,r),_.convertErrorAndRethrow(F),[3,4];case 4:return[2]}}))}))},getFailureParameters:function(){return r},getSuccessParameters:function(){return r}}},t.retrieveGridDataSucceeded=function(e,t,r,n,a,i){return O(S(e,t,n,a,i,r))},t.getUpdatedRefCount=N},c7Ce:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function n(e){return e&&e.garbageCollector?e.garbageCollector.metadata:null}function a(e){return e&&e.garbageCollector?e.garbageCollector.data:null}Object.defineProperty(t,"__esModule",{value:!0}),t.getGCListQueryDataRefCount=t.getGCListsData=t.getGCChartStorageKeyRefCount=t.getGCChartVisualizationViewRefCount=t.getGCChartDataByStorageKey=t.getGCChartsData=t.getGCEntityRecordDataRefCount=t.getGCEntitiesData=t.getGCEntityMetadataRefCount=t.getGCEntitiesMetadata=t.getGCRibbonMetadataRefCount=t.getGCRibbonsMetadata=void 0,t.getGCRibbonsMetadata=function(e){var t,r=n(e);return r&&null!==(t=r.ribbons)&&void 0!==t?t:null},t.getGCRibbonMetadataRefCount=function(e,t){var r=n(e);return r&&r.ribbons?r.ribbons[t]:null},t.getGCEntitiesMetadata=function(e){var t,r=n(e);return r&&null!==(t=r.entities)&&void 0!==t?t:null},t.getGCEntityMetadataRefCount=function(e,t){var r=n(e);return r&&r.entities?r.entities[t]:null},t.getGCEntitiesData=function(e){var t=a(e);return t&&t.entities?t.entities:null},t.getGCEntityRecordDataRefCount=function(e,t,r){var n=a(e);return n&&n.entities&&n.entities[t]?n.entities[t][r]:null},t.getGCChartsData=function(e){var t=a(e);return t&&t.charts?t.charts:null},t.getGCChartDataByStorageKey=function(e){var t=a(e);return t&&t.chartData?t.chartData:null},t.getGCChartVisualizationViewRefCount=function(e,t,r){var n=a(e);return n&&n.charts&&n.charts[t]?n.charts[t][r]:null},t.getGCChartStorageKeyRefCount=function(e,t){var r=a(e);return r&&r.chartData&&r.chartData[t]?r.chartData[t]:null},t.getGCListsData=function(e){var t=a(e);return t&&t.lists?t.lists:null},t.getGCListQueryDataRefCount=function(e,t){var r=a(e);return r&&r.lists&&r.lists[t]?r.lists[t]:null}},cvWF:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var n;r.r(t),r.d(t,"AttributeType",(function(){return n})),function(e){e.Boolean="boolean",e.Unknown="unknown",e.Customer="customer",e.Date="date",e.DateTime="datetime",e.Decimal="decimal",e.Double="double",e.Image="image",e.Integer="integer",e.Lookup="lookup",e.ManagedProperty="managedproperty",e.Memo="memo",e.Money="money",e.Owner="owner",e.PartyList="partylist",e.PickList="picklist",e.State="state",e.Status="status",e.String="string",e.UniqueIdentifier="uniqueidentifier",e.CalendarRules="calendarrules",e.Virtual="virtual",e.BigInt="bigint",e.EntityName="entityname",e.EntityImage="entityimage",e.AliasedValue="aliasedvalue",e.Regarding="regarding",e.MultiSelectPickList="multiselectpicklist",e.File="file",e.NavigationProperty="navigationproperty"}(n||(n={}))},djz1:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.serializeEntityCollection=void 0;var n=r("atuF");t.serializeEntityCollection=function(e){var t=e.get_entities(),r=e.get_query(),a=[];r&&(null==r?void 0:r.GetColumnNamesFromFetch)&&(a=null==r?void 0:r.GetColumnNamesFromFetch());for(var i=[],o=0;o<t.length;o++){var s=n.serializeEntityRecord(t[o]);s.queryColumnNames=a,delete s.accessRights,i.push(s)}return i}},e3wK:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.gcUpdateDataEntities=t.gcUpdateData=t.garbageCollectDataNode=void 0;var n=r("FDNG"),a=r("Kz3/"),i=r("f6dx"),o=r("6/7M"),s=r("c7Ce"),u=r("c5ne");function l(e){return{type:o.GC_UPDATE_DATA_ACTION,payload:e}}t.garbageCollectDataNode=function(e){return{type:"garbage.collect.data.sync",sync:!0,execute:function(t,r){var n,o,u,c=t.dispatch,d=(0,t.getState)(),p={},f={},y=s.getGCEntitiesData(d);for(var m in y){var h=y[m];for(var g in h){var E=(S=null===(o=h[g])||void 0===o?void 0:o.slice())&&a.removeReference(S,e);if(E)if(0===E.length)if(f[m])f[m][g]=null;else{var b=((n={})[g]=null,n);f[m]=b}else p[m]||(p[m]={}),p[m][g]=E}}var _={},v={},T=s.getGCListsData(d);for(var O in T){var S,N=(S=null===(u=T[O])||void 0===u?void 0:u.slice())&&a.removeReference(S,e);N&&(0===N.length?v[O]=null:_[O]=N)}var R,M={},A={},C={},P={};(Object.keys(p).length>0||Object.keys(_).length>0||Object.keys(M).length>0||Object.keys(C).length>0)&&c(l({entities:p,lists:_,charts:M,chartData:C}));(Object.keys(f).length>0||Object.keys(v).length>0||Object.keys(A).length>0||Object.keys(P).length>0)&&c((R={entities:f,lists:v,charts:A,chartData:P},{type:i.GC_REMOVE_DATA_ACTION,payload:R}))}}},t.gcUpdateDataEntities=function(e){return{type:"garbage.collector.update.data.entities.sync",sync:!0,execute:function(t,r){for(var a,i,o=t.dispatch,s=t.getState,c=null===(i=r.DataLayerConfiguration.GarbageCollectionProvider)||void 0===i?void 0:i.getCurrentPage(),d={},p=0;p<e.length;p++){var f=n.Guid.toString(e[p].id),y=e[p].etn,m=u.getUpdatedRefCount(s(),y,f,c);if(m)if(d[y])d[y][f]=m;else{var h=((a={})[f]=m,a);d[y]=h}}Object.keys(d).length>0&&o(l({entities:d}))}}},t.gcUpdateData=l},e9z0:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.buildRetrieveRequestWithURLParams=t.buildRetrieveContract=void 0;var s=r("cvWF"),u=i(r("+QHC")),l=r("FDNG"),c=r("UZ+8"),d=r("+u6Z"),p=r("Mx+d"),f=r("RHls"),y=r("xl8k"),m=r("vqTk"),h=r("uzdi"),g=r("0hOr");t.buildRetrieveContract=function(e,t,r,n,a){var i,E,b,_,v,T=[],O=[];try{for(var S=o(r),N=S.next();!N.done;N=S.next()){var R=N.value,M=g.getAttributeDescriptor(e,t.etn,R);if(!M)throw new f.ErrorStatus("Cannot serialize a request with no attribute metadata for "+t.etn+"."+R);if(M.Type===s.AttributeType.PartyList){if(!(v=p.getActivityPartyNavigationPropertyRelationship(e,t.etn))){_="The relationship for the partylist attribute "+R+" is not found in the state tree or is invalid";break}var A=d.getParticipationTypeMask(t.etn,R);if(void 0===A)throw new f.ErrorStatus("Unknown participation type mask for attribute "+R);O.push(A)}else M&&-1!==y.SupportedLookupProperties.indexOf(M.Type)?T.push("_"+R+"_value"):T.push(R)}}catch(e){i={error:e}}finally{try{N&&!N.done&&(E=S.return)&&E.call(S)}finally{if(i)throw i.error}}var C="";if(O.length){var P="$filter=Microsoft.Dynamics.CRM.In(PropertyName='participationtypemask',PropertyValues=["+O.map((function(e){return"'"+e+"'"}))+"])";C="&$expand="+v.ReferencedEntityNavigationPropertyName+"("+P+")"}var I=function(e,t,r,n){var a,i,l,f,m,h="",E=[];if(n){var b="";try{for(var _=o(n),v=_.next();!v.done;v=_.next()){var T=v.value,O=T.get_relationShipName(),S=T.get_columnNames(),N=[],R=p.getRelationShipByNavigationProperty(e,t.etn,O);if(R){var M=p.getRelationshipTypeByNavigationProperty(e,t.etn,O)===u.RelationshipType.OneToManyRelationship?R.ReferencingEntity:R.ReferencedEntity;try{for(var A=(l=void 0,o(S)),C=A.next();!C.done;C=A.next()){var P=C.value,I=g.getAttributeDescriptor(e,M,P);if(!I){m="Cannot serialize a request with no attribute metadata for "+M+"."+P;break}if(I.Type===s.AttributeType.PartyList){if(!p.getActivityPartyNavigationPropertyRelationship(e,M)){m="The relationship for the partylist attribute "+P+" is not found in the state tree or is invalid";break}var w=d.getParticipationTypeMask(M,P);if(void 0===w){m="Unknown participation type mask for attribute "+P;break}E.push(w)}else I&&-1!==y.SupportedLookupProperties.indexOf(I.Type)?N.push("_"+P+"_value"):N.push(P)}}catch(e){l={error:e}}finally{try{C&&!C.done&&(f=A.return)&&f.call(A)}finally{if(l)throw l.error}}}N&&N.length>0&&(b=c.IsNullOrUndefinedOrEmptyString(b)?O+"($select="+N.join(",")+")":b+","+O+"($select="+N.join(",")+")")}}catch(e){a={error:e}}finally{try{v&&!v.done&&(i=_.return)&&i.call(_)}finally{if(a)throw a.error}}h="&$expand="+b}if(m&&r){r.TraceManager.getTracer("RetrieveRequestSerializer").error(m)}return h}(e,t,n,a),w=new h.ODataRetrieveWithUrlParamsRequest(t.etn,l.Guid.toString(t.id),"?$select="+T.join(",")+C+I,((b={})[m.HEADER.PREFER]=m.HEADER_VALUES.ANNOTATIONS,b[m.HEADER.ACCEPT]=m.HEADER_VALUES.APPLICATION_JSON,b[m.HEADER.MSCRM_RETURN_NOTIFICATIONS]="true",b));return _&&n&&n.TraceManager.getTracer("RetrieveRequestSerializer").error(_),w},t.buildRetrieveRequestWithURLParams=function(e,t,r,n,a,i){var o,s=a&&"number"==typeof a?",odata.maxpagesize="+a:"",u={urlParameters:""+p.getEntitySetName(e,t)+(l.Guid.isNullOrEmpty(l.Guid.tryParse(r))?"":"("+r+")")+(n||""),additionalHeaders:(o={},o[m.HEADER.PREFER]=""+m.HEADER_VALUES.ANNOTATIONS+s,o[m.HEADER.ACCEPT]=m.HEADER_VALUES.APPLICATION_JSON,o[m.HEADER.MSCRM_RETURN_NOTIFICATIONS]="true",o),method:"GET"};return i&&"object"==typeof i&&Object.assign(u.additionalHeaders,i),u}},evga:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.RETRIEVE_ROW_VERSION_HEADER=t.requestAdditionalMetadataForEntityRecord=t.buildCreateRequest=void 0;var i=r("RslU"),o=r("IvJe"),s=r("Mx+d"),u=r("vqTk");t.RETRIEVE_ROW_VERSION_HEADER="ReturnRowVersion",t.buildCreateRequest=function(e,t,r,n,a){var i;void 0===n&&(n=!0);var o={urlParameters:""+s.getEntitySetName(e,t),body:JSON.stringify(r),additionalHeaders:(i={},i[u.HEADER.ACCEPT]=u.HEADER_VALUES.APPLICATION_JSON,i[u.HEADER.MSCRM_SUPPRESS_DUPLICATION_DETECTION]=n.toString(),i),method:"POST"};return o&&o.additionalHeaders&&a&&(o.additionalHeaders.ReturnRowVersion="true"),o},t.requestAdditionalMetadataForEntityRecord=function(e){return{type:"REQUEST_ADDITIONAL_METADATA_FOR_ENTITY_RECORD",execute:function(t,r){var s=t.dispatch,u=t.getState;return n(this,void 0,void 0,(function(){var t;return a(this,(function(r){switch(r.label){case 0:return(t=o.getRelatedEntityLogicalNames(u(),e).reduce((function(e,t){return e[t]=[],e}),{}))[e.get_identifier().LogicalName]=o.getAttributeNamesWithNoMetadata(u(),e),[4,s(i.retrieveEntities(t))];case 1:return r.sent(),[2]}}))}))}}}},f03v:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var n;r.r(t),r.d(t,"DateTimeFieldBehavior",(function(){return n})),function(e){e[e.None=0]="None",e[e.UserLocal=1]="UserLocal",e[e.DateOnly=2]="DateOnly",e[e.TimeZoneIndependent=3]="TimeZoneIndependent"}(n||(n={}))},f6dx:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.REMOVE_ENTITY_RECORD_ACTION=t.REFRESH_RECORD_DATA_ACTION=t.RETRIEVE_RECORD_DATA_ACTION=t.RETRIEVE_LOOKUP_DATA_ACTION=t.GET_CLIENT_METADATA=t.GC_REMOVE_DATA_ACTION=t.RETRIEVE_ENTITY_METADATA=t.RETRIEVE_GRID_DATA_ACTION=void 0,t.RETRIEVE_GRID_DATA_ACTION="retrieve.grid.data.action",t.RETRIEVE_ENTITY_METADATA="retrieve.entity.metadata",t.GC_REMOVE_DATA_ACTION="gc.remove.data.action",t.GET_CLIENT_METADATA="get.client.metadata",t.RETRIEVE_LOOKUP_DATA_ACTION="retrieve.lookup.data.action",t.RETRIEVE_RECORD_DATA_ACTION="retrieve.record.data.action",t.REFRESH_RECORD_DATA_ACTION="refresh.record.data.action",t.REMOVE_ENTITY_RECORD_ACTION="remove.entity.record.action"},fr82:function(e,t,r){"use strict";var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.XPathEvaluatorWrapper=void 0;var i=r("lqZx"),o=r("1LmJ"),s=r("s1MM"),u=r("/vtY"),l=r("UZ+8"),c=function(e){function t(t,r,n){var a=e.call(this)||this;return a._namespaces=null,a._evaluator=null,a._element=null,o.assert(!l.IsNullOrUndefined(t),"The XPathEvaluator should not be null"),a._evaluator=t,a._element=l.IsNullOrUndefined(r)?t:r,a._namespaces=l.IsNullOrUndefined(n)?{}:n,a}return a(t,e),t.prototype.get_innerText=function(){var e,t,r;return(null===(e=this._element)||void 0===e?void 0:e.hasChildNodes())?null===(r=null===(t=this._element)||void 0===t?void 0:t.firstChild)||void 0===r?void 0:r.nodeValue:null},t.prototype.get_outerXml=function(){return(new XMLSerializer).serializeToString(this._element)},t.prototype.get_tagName=function(){var e;return null===(e=this._element)||void 0===e?void 0:e.tagName},t.prototype.get_domParserElement=function(){return this._element},t.prototype.addNamespace=function(e,t){this._namespaces&&(this._namespaces[e]=t)},t.prototype.selectSingleNode=function(e){var r,n=null===(r=this._evaluator)||void 0===r?void 0:r.evaluate(e,this._element,null,s.XPathResultType.FIRST_ORDERED_NODE_TYPE,null);return l.IsNullOrUndefined(null==n?void 0:n.singleNodeValue)?null:new t(this._evaluator,null==n?void 0:n.singleNodeValue,this._namespaces)},t.prototype.selectNodes=function(e){var t;return new u.NodeSnapshotWrapper(this._evaluator,null===(t=this._evaluator)||void 0===t?void 0:t.evaluate(e,this._element,null,s.XPathResultType.ORDERED_NODE_SNAPSHOT_TYPE,null),this._namespaces)},t.prototype.getAttribute=function(e){var t;return null===(t=this._element)||void 0===t?void 0:t.getAttribute(e)},t.prototype.getElementsByTagName=function(e){var t;return new u.NodeSnapshotWrapper(this._evaluator,null===(t=this._element)||void 0===t?void 0:t.getElementsByTagName(e),this._namespaces)},t.prototype.childNodes=function(){var e;return new u.NodeSnapshotWrapper(this._evaluator,null===(e=this._element)||void 0===e?void 0:e.childNodes,this._namespaces)},t.prototype.hasChildNodes=function(){var e;return null===(e=this._element)||void 0===e?void 0:e.hasChildNodes()},t}(i.XmlNode);t.XPathEvaluatorWrapper=c},geC1:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return o},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(a(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.getAttributeBindForOData=t.encodeURIComponentForOData=t.getEnumValueMetadata=t.serializeEntityType=t.transformToODataValue=t.buildEntityPayload=t.OutputFormat=t.ODataPrimitives=void 0;var o,s=r("cvWF"),u=r("f03v"),l=r("FDNG"),c=r("FHhg"),d=r("UZ+8"),p=r("gkFy"),f=r("+u6Z"),y=r("0hOr"),m=r("IvJe"),h=r("Mx+d");function g(e){var t=encodeURIComponent(e);if(-1!==t.indexOf("'")){return t.replace(/\'/g,"''")}return t}function E(e,t){var r=h.getActivityPartyNavigationPropertyRelationship(e,t);if(r&&r.ReferencedEntityNavigationPropertyName)return r.ReferencedEntityNavigationPropertyName}function b(e,t,r,n,a){var i,m,g,b;void 0===a&&(a=o.Server);var T=n.getValue(r);if(!e||!t||!r||void 0===T||a===o.Client&&null===T)return{};var O=null,S={},N=n.get_fieldTypes(),R=null;if(N[r]===s.AttributeType.AliasedValue){var M=T;O=M.get_attributeType(),S[r+"@OData.Community.Display.V1.AttributeName"]=M.get_attributeLogicalName(),R=y.getAttributeDescriptor(e,M.get_entityLogicalName(),M.get_attributeLogicalName()),T=M.get_value()}else{if(!(R=y.getAttributeDescriptor(e,t,r)))return{};O=R.Type}switch(O){case s.AttributeType.MultiSelectPickList:if(d.IsNullOrUndefined(T))return{};var A=T.length>0?T.join(","):null;if(A&&a===o.Client){var C=R.OptionSet?null==R?void 0:R.OptionSet.length:0;S[p.getFormattedValueAnnotation(r)]=T.map((function(e){for(var t,r,n,a,i=0;i<C;i++)if(e===(null===(r=null===(t=null==R?void 0:R.OptionSet)||void 0===t?void 0:t[i])||void 0===r?void 0:r.Value))return null===(a=null===(n=null==R?void 0:R.OptionSet)||void 0===n?void 0:n[i])||void 0===a?void 0:a.Label;return""})).join(";")}return S[r]=A,S;case s.AttributeType.PartyList:if(d.IsNullOrUndefined(T))return{};var P=T.get_entities(),I=E(e,t);if(!I)return{};var w=f.getParticipationTypeMask(t,r),D=P.map((function(t){var r=t.getValue("partyid"),n=t.getValue("activitypartyid"),a=n?n.toString():null,i=c.EntityReference.fromLegacyEntityReference(r);return v(e,w,i,a)}));return S[I]=D,S;case s.AttributeType.Boolean:if(d.IsNullOrUndefined(T))return{};var F=T.get_ValueString();return a===o.Client&&(S[p.getFormattedValueAnnotation(r)]=T.get_Label()),S[r]="0"===F||"1"===F?"1"===F:null,S;case s.AttributeType.PickList:case s.AttributeType.State:case s.AttributeType.Status:return d.IsNullOrUndefined(T)?{}:(a===o.Client&&(S[p.getFormattedValueAnnotation(r)]=T.get_Label()),S[r]=T.getValue("value"),S);case s.AttributeType.Customer:case s.AttributeType.Lookup:case s.AttributeType.Owner:var L=p.getLookupPropertyName(r);if(d.IsNullOrUndefined(T))return(i={})[L]=null,i;var k=T,x=h.getEntitySetName(e,k.LogicalName),j=null===(g=l.Guid.fromLegacyGuid(k.Id))||void 0===g?void 0:g.guid,U=null;if(O===s.AttributeType.Owner&&(U=h.getManyToOneRelationshipByReferencedEntity(e,t,"owner",r)),d.IsNullOrUndefined(U)&&(U=h.getManyToOneRelationshipByReferencedEntity(e,t,k.LogicalName,r)),O===s.AttributeType.Owner&&d.IsNullOrUndefined(U))return{};if(d.IsNullOrUndefined(U))throw new Error("Unable to find many-to-one relationship, entity: "+t+", referenced entity: "+k.LogicalName+", field: "+r);return a===o.Server?S[_(U.ReferencingEntityNavigationPropertyName)]="/"+x+"("+j+")":(S[p.getFormattedValueAnnotation(L)]=k.Name,S[p.getLookupLogicalNameAnnotation(L)]=k.LogicalName,S[L]=j),S;case s.AttributeType.UniqueIdentifier:return d.IsNullOrUndefined(T)?{}:(S[r]=null===(b=l.Guid.fromLegacyGuid(T))||void 0===b?void 0:b.guid,S);case s.AttributeType.Date:case s.AttributeType.DateTime:if(d.IsNullOrUndefined(T))return(m={})[r]=null,m;if(R.Behavior===u.DateTimeFieldBehavior.DateOnly&&"function"==typeof T.toISOString){var V=T.toISOString().match(/(\d{4}-\d{2}-\d{2})T\d{2}\:\d{2}\:\d{2}\.\d{3}[+-Z]/i);V[1]&&(a===o.Client&&(S[p.getFormattedValueAnnotation(r)]=n.getFormattedValue(r)),S[r]=V[1])}else a===o.Client?(S[p.getFormattedValueAnnotation(r)]=n.getFormattedValue(r),S[r]=T.toISOString().replace(/.\d{3}Z/,"Z")):S[r]=T;return S;case s.AttributeType.Money:case s.AttributeType.Decimal:case s.AttributeType.Double:case s.AttributeType.Integer:case s.AttributeType.BigInt:if(a===o.Client){if(d.IsNullOrUndefined(T))return{};S[p.getFormattedValueAnnotation(r)]=n.getNumericFormattedValue(r)}return S[r]=T,S;default:return S[r]=T,S}}function _(e){return e+"@odata.bind"}function v(e,t,r,n){var a,i=r.id.guid,o=r.etn;if("unresolvedaddress"===o){var s={addressused:r.name,participationtypemask:t};return d.IsNullOrUndefined(n)||(s.activitypartyid=n),s}var u=h.getEntitySetName(e,o),l=h.getActivityPartyNavigationPropertyRelationship(e,o);if(d.IsNullOrUndefined(l))throw new Error("Unable to find one-to-many relationship, entity: "+o+", referencing entity: activityparty");var c=((a={})[l.ReferencingEntityNavigationPropertyName+"@odata.bind"]="/"+u+"("+i+")",a.participationtypemask=t,a);return d.IsNullOrUndefined(n)||(c.activitypartyid=n),c}t.ODataPrimitives=["Edm.Boolean","Edm.String","Edm.Byte","Edm.Decimal","Edm.Double","Edm.Int16","Edm.Int32","Edm.Int64","Edm.SByte","Edm.Single","Edm.Date","Edm.Guid","Edm.DateTimeOffset","Edm.Duration","Edm.Stream","Edm.Binary","Edm.TimeOfDay","Edm.Geography","Edm.GeographyPoint","Edm.GeographyLineString","Edm.GeographyPolygon","Edm.GeographyMultiPoint","Edm.GeographyMultiLineString","Edm.GeographyMultiPolygon","Edm.GeographyCollection","Edm.Geometry","Edm.GeometryPoint","Edm.GeometryLineString","Edm.GeometryPolygon","Edm.GeometryMultiPoint","Edm.GeometryMultiLineString","Edm.GeometryMultiPolygon","Edm.GeometryCollection"],function(e){e[e.Server=0]="Server",e[e.Client=1]="Client"}(o||(o={})),t.OutputFormat=o,t.serializeEntityType=function(e,t,r,n){if(void 0===r&&(r=!1),void 0===n&&(n=!1),d.IsNullOrUndefined(t))return"null";if("object"==typeof t&&"entityType"in t&&"id"in t){var a=function(e,t,r){var n;if(r){var a=h.getEntityDescriptor(e,t.entityType);return(n={"@odata.type":"Microsoft.Dynamics.CRM."+t.entityType})[a.PrimaryKeyName]=l.Guid.fromExternalGuid(t.id).guid,n}return{"@odata.id":h.getEntitySetName(e,t.entityType)+"("+l.Guid.fromExternalGuid(t.id).guid+")"}}(e,t,r),i=JSON.stringify(a);return n?g(i):i}var o=JSON.stringify(t);return n?g(o):o},t.encodeURIComponentForOData=g,t.getEnumValueMetadata=function(e,t){return null!=e&&t&&t.enumProperties&&t.enumProperties.length?t.enumProperties.filter((function(t){return t.value===e}))[0]:null},t.buildEntityPayload=function e(t,r,a){var s,u,d,p;void 0===a&&(a=o.Server);var y=r.get_identifier(),g=y.LogicalName,_=[];if(r)if(a===o.Server){var T=r.get_changedFieldNames();T&&(_=T)}else _=r.get_fieldNames();var O=_.reduce((function(e,n){var i=b(t,g,n,r,a),o=Object.keys(e),s=Object.keys(i)[0];return o&&-1!==o.indexOf(s)&&i[s]&&i[s].length?(e[s]=e[s].concat(i[s]),e):Object.assign(i,e)}),{}),S=h.getEntityDescriptor(t,g);if(S&&S.IsActivity){var N=f.getPartyListAttributeNames(g),R=_.filter((function(e){return N.indexOf(e)>-1})),M=N.filter((function(e){return-1===R.indexOf(e)}));if(R.length&&M.length){var A=[],C=null===(p=m.createRecordSelector(c.EntityReference.fromLegacyEntityReference(y)))||void 0===p?void 0:p(t,g);if(C&&C.fields){try{for(var P=n(M),I=P.next();!I.done;I=P.next()){var w=I.value;if(w in C.fields){var D=C.fields[w].list.map((function(e){var r,n,a,i,o,s=(null===(r=e.fields)||void 0===r?void 0:r.participationtypemask)?Number((null===(n=e.fields)||void 0===n?void 0:n.participationtypemask).valueString):0,u=null===(a=e.fields)||void 0===a?void 0:a.partyid,d=null===(i=e.fields)||void 0===i?void 0:i.activitypartyid,p=d&&!l.Guid.isNullOrEmpty(d.id)?l.Guid.toString(d.id):void 0,f=u?u.reference:new c.EntityReference("unresolvedaddress",l.Guid.EMPTY,(null===(o=e.fields)||void 0===o?void 0:o.addressused).value);return v(t,s,f,p)}));A.push.apply(A,i(D))}}}catch(e){s={error:e}}finally{try{I&&!I.done&&(u=P.return)&&u.call(P)}finally{if(s)throw s.error}}}var F=E(t,g);F&&(O[F]?(d=O[F]).push.apply(d,i(A)):0!==A.length&&(O[F]=A))}}var L=r.get_relatedEntities();return a===o.Client&&L&&L.get_entityCollections()&&L.get_entityCollections().forEach((function(r){var n=r.get_value().get_entities().map((function(r){return e(t,r,a)})),i=n&&1===n.length&&h.getManyToOneRelationshipByNavigationProperty(t,g,r.get_key().get_schemaName())?n[0]:n;O[r.get_key().get_schemaName()]=i})),O},t.transformToODataValue=b,t.getAttributeBindForOData=_},gkFy:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},u=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.uniqueMerge=t.PayloadFormat=t.getFormattedValueAnnotation=t.getLookupLogicalNameAnnotation=t.getLookupPropertyName=t.determineReturnedColumn=t.determineReturnedColumns=t.createEntityRecordFromResponseAsync=t.createEntityRecordFromResponse=t.REMOVE_NOTIFICATIONS=t.ADD_NOTIFICATIONS=void 0;var l,c=r("cvWF"),d=i(r("+QHC")),p=r("FDNG"),f=r("EY1R"),y=r("RslU"),m=r("FHhg"),h=r("UZ+8"),g=r("AYBo"),E=r("VmZv"),b=r("WSZO"),_=r("N/D8"),v=r("AHn5"),T=r("+u6Z"),O=r("0hOr"),S=r("Mx+d"),N=r("f03v");function R(e,t,r,n,a,i,o,s,f,y,g){void 0===y&&(y=l.OData);var b=o||r?r.PrimaryIdAttribute:void 0;a||(a=A(t,y)),-1===a.indexOf("versionnumber")&&t.hasOwnProperty("@odata.etag")&&a.push("versionnumber");var _=b&&"string"==typeof t[b]?new p.Guid(t[b]):p.Guid.EMPTY,N=new m.EntityReference(r.EntityLogicalName,_),R=m.EntityReference.toLegacyEntityReference(N),M=null;s&&!h.IsNullOrUndefined(s)&&(M=s.aliasedValueDescriptors);var C=function(e,t,r,n,a,i,o,s,f){var y,g,b;void 0===f&&(f=l.OData);var _={fieldTypes:{},formattedValues:{},numericFormattedValues:{},fields:{}},N=function(t){if(h.IsNullOrUndefinedOrEmptyString(t)){var y=[{name:"EntityLogicalName",value:null!=r?r.EntityLogicalName:"null"}];return o&&o.warn("Empty field name encountered while trying to construct entity record",y),"continue"}if("versionnumber"===t){var g=c.AttributeType.BigInt;_.fields[t]=D(e,a,t,g,r,n,!1,i,o,f),_.fieldTypes[t]=g}else if(s&&a&&a.hasOwnProperty(t)&&a[t]&&s.filter((function(e){return e.get_relationShipName()===t})).length>0)!function(e,t,r,n,a,i,o){var s,l,f,y,h,g,b,_;if(o)try{for(var T=u(o),N=T.next();!N.done;N=T.next()){var R=N.value,M=void 0,A=R.get_relationShipName();if(A===t){var C=S.getRelationShipByNavigationProperty(e,r.EntityLogicalName,A);if(C){var P=S.getRelationshipTypeByNavigationProperty(e,r.EntityLogicalName,A),I=P===d.RelationshipType.OneToManyRelationship?C.ReferencingEntity:C.ReferencedEntity,w=R.get_columnNames(),F=O.getAttributesForEntity(e,I);if(F){var L=[],k=S.getEntityDescriptor(e,I),x=null==k?void 0:k.PrimaryKeyName;if(P===d.RelationshipType.OneToManyRelationship){var j=n[A];try{for(var U=(f=void 0,u(j)),V=U.next();!V.done;V=U.next()){var q=V.value,$={fieldTypes:{},formattedValues:{},numericFormattedValues:{},fields:{}},G=new p.Guid(q[x]),B=new m.EntityReference(null==k?void 0:k.EntityLogicalName,G),H=m.EntityReference.toLegacyEntityReference(B);if(w)try{for(var Q=(h=void 0,u(w)),X=Q.next();!X.done;X=Q.next()){var z=X.value;if(F.hasOwnProperty(z)){var W=D(e,q,z,M=F[z].Type,k,F,!1,null,i);$.fields[z]=W,$.fieldTypes[z]=M}}}catch(e){h={error:e}}finally{try{X&&!X.done&&(g=Q.return)&&g.call(Q)}finally{if(h)throw h.error}}var Y=new E.EntityRecord(H,$.fields,$.fieldTypes,$.formattedValues,$.numericFormattedValues,new v.RelatedEntityCollection([]));L.push(Y)}}catch(e){f={error:e}}finally{try{V&&!V.done&&(y=U.return)&&y.call(U)}finally{if(f)throw f.error}}}else if(P===d.RelationshipType.ManyToOneRelationship){q=n[A],$={fieldTypes:{},formattedValues:{},numericFormattedValues:{},fields:{}},G=new p.Guid(q[x]),B=new m.EntityReference(null==k?void 0:k.EntityLogicalName,G),H=m.EntityReference.toLegacyEntityReference(B);if(w)try{for(var K=(b=void 0,u(w)),J=K.next();!J.done;J=K.next()){z=J.value;if(F.hasOwnProperty(z)){M=F[z].Type;W=D(e,n[t],z,M,k,F,!1,null,i);$.fields[z]=W,$.fieldTypes[z]=M}}}catch(e){b={error:e}}finally{try{J&&!J.done&&(_=K.return)&&_.call(K)}finally{if(b)throw b.error}}Y=new E.EntityRecord(H,$.fields,$.fieldTypes,$.formattedValues,$.numericFormattedValues,new v.RelatedEntityCollection([]));L.push(Y)}a.fields[A]=L,a.fieldTypes[A]=c.AttributeType.NavigationProperty}}}}}catch(e){s={error:e}}finally{try{N&&!N.done&&(l=T.return)&&l.call(T)}finally{if(s)throw s.error}}}(e,t,r,a,_,o,s);else{var N=!1,R=!!i&&i.hasOwnProperty(t);if(!R&&null==n[t])return"continue";var M=a.hasOwnProperty(F(t,a,i,R));if(M||(M=a.hasOwnProperty(k(t,f,R))),!M){var A=L(e,t,r,a,i,R);N=M=A&&a.hasOwnProperty(A)&&a[A].filter((function(e){return e.participationtypemask===T.getParticipationTypeMask(R&&i?i[t].aliasedValueEtn:r.EntityLogicalName,R&&i?i[t].aliasedValueFieldName:t)})).length>0}if(M){g=R?c.AttributeType.AliasedValue:n[t].Type;var C=!(!i||!(null===(b=i[t])||void 0===b?void 0:b.isAttributeAlias)),P=F(t,a,i,R&&C),I=!!(R&&i&&i[t]&&i[t].oDataAlias.length>1),x=F(t,a,i,I);_.fields[P]=D(e,a,x,g,r,n,N,R?i:null,o,f),_.fieldTypes[P]=g,function(e,t,r,n,a,i,o){if(a===l.OData){var s=w(t);n.hasOwnProperty(s)&&(r.formattedValues[t]=n[s])}}(0,x,_,a,f)}}};try{for(var R=u(t),M=R.next();!M.done;M=R.next()){N(M.value)}}catch(e){y={error:e}}finally{try{M&&!M.done&&(g=R.return)&&g.call(R)}finally{if(y)throw y.error}}return _}(e,a,r,n,t,M,f,g,y);return new E.EntityRecord(R,C.fields,C.fieldTypes,C.formattedValues,C.numericFormattedValues,new v.RelatedEntityCollection([]),i)}function M(e,t){var r,n,a=new Set(e||[]),i=e&&e.slice(0)?e.slice(0):[];if(t)try{for(var o=u(t),s=o.next();!s.done;s=o.next()){var l=s.value;a.has(l)||i.push(l)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i}function A(e,t){void 0===t&&(t=l.OData);var r=Object.keys(e).reduce((function(e,r){return-1===r.indexOf("@")&&e.add(C(r,t)),e}),new Set);return Array.from(r)}function C(e,t){void 0===t&&(t=l.OData);var r=null;return(r=t===l.OData?e.match(/_(\w+)_value/i):e.match(/(\w+\.?\w+)!(id|name|logicalname)$/i))&&r[1]?r[1]:e}!function(e){e[e.OData=0]="OData",e[e.SQL=1]="SQL"}(l||(l={})),t.PayloadFormat=l,t.createEntityRecordFromResponse=R,t.createEntityRecordFromResponseAsync=function(e,t,r,n,a,i,c,p,m){return void 0===p&&(p=l.OData),{type:"CREATE_ENTITY_RECORD_FROM_RESPONSE_ASYNC",execute:function(l,h){var g=l.getState,E=l.dispatch;return o(this,void 0,void 0,(function(){var o,l,h,b,_;return s(this,(function(s){switch(s.label){case 0:return o=A(e,p),l=function(e,t,r,n,a,i){var o,s,l,c,p=M(r,n).filter((function(e){return-1===e.indexOf(".")}));p&&p.length>0?a?(c=a.entity2AttributesMap?a.entity2AttributesMap:{},f.addAttributes(c,t,p)):((o={})[t]=p,c=o):c={};if(i)try{for(var y=u(i),m=y.next();!m.done;m=y.next()){var h=m.value,g=h.get_relationShipName(),E=S.getRelationShipByNavigationProperty(e,t,g);if(E){var b=S.getRelationshipTypeByNavigationProperty(e,t,g)===d.RelationshipType.OneToManyRelationship?E.ReferencingEntity:E.ReferencedEntity,_=h.get_columnNames();f.addAttributes(c,b,_)}}}catch(e){s={error:e}}finally{try{m&&!m.done&&(l=y.return)&&l.call(y)}finally{if(s)throw s.error}}return c}(g(),t,r,o,i,m),[4,E(y.retrieveEntities(l))];case 1:return s.sent(),h=O.getAttributesForEntity(g(),t),b=S.getEntityDescriptor(g(),t),_=(r||[]).concat(l[t]?l[t].filter((function(e){return h.hasOwnProperty(e)})):[]),[2,R(g(),e,b,h,_,n,a,i,c,p,m)]}}))}))}}},t.uniqueMerge=M,t.determineReturnedColumns=A,t.determineReturnedColumn=C;t.ADD_NOTIFICATIONS="notifications.add";function P(e){return"_"+e+"_value"}function I(e){return e+"@Microsoft.Dynamics.CRM.lookuplogicalname"}function w(e){return e+"@OData.Community.Display.V1.FormattedValue"}function D(e,t,r,n,a,i,o,s,u,d){var f;void 0===d&&(d=l.OData);var y,E=k(r,d);if("versionnumber"===r&&d===l.OData&&t["@odata.etag"]){var v=t["@odata.etag"].match(/W\/\"([0-9a-zA-Z]+)\"/);if(v&&v[1])return v[1]}if(!(o||t.hasOwnProperty(r)||t.hasOwnProperty(E)||s))return null;var M=null;if(i&&i[r]&&-1!==[c.AttributeType.Lookup,c.AttributeType.Customer,c.AttributeType.Owner].indexOf(i[r].Type))s&&s.hasOwnProperty(r)&&(E=k(r,d,!0)),y=t[E];else if(i&&i[r]){var A=x(s,t,r),C=s&&s[r]&&s[r].oDataAlias&&s[r].oDataAlias[A]||r;if(M=s&&s[r]&&s[r].rowaggregate||null,y=t[C],s&&s[r]&&s[r].isAttributeAlias&&h.IsNullOrUndefined(M))return y}else y=t[r];if(!o&&null===y)return null;switch(n){case c.AttributeType.AliasedValue:if(s){var P=s[r],F=P.aliasedValueEtn,j=P.aliasedValueFieldName,U=S.getEntityDescriptor(e,F),V=O.getAttributeDescriptor(e,F,j),q=void 0;q=M&&"CountChildren"===M?c.AttributeType.Integer:null==V?void 0:V.Type;var $=new b.LegacyAliasedValue(F,j,q);return null==(y=D(e,t,r,q,U,((f={})[r]=V,f),o,s,u,d))?null:($.set_value(y),$)}return null;case c.AttributeType.Customer:case c.AttributeType.Lookup:case c.AttributeType.Owner:var G=t[function(e,t,r){void 0===r&&(r=l.OData);return r===l.OData?I(t):e+"!logicalname"}(r,E,d)],B=t[function(e,t,r){void 0===r&&(r=l.OData);return r===l.OData?w(t):e+"!name"}(r,E,d)];if(G&&y)return m.EntityReference.toLegacyEntityReference(new m.EntityReference(G,new p.Guid(y),B));var H=[];return H.push({name:"EntityLogicalName",value:null==i[r]?"null":i[r].EntityLogicalName}),H.push({name:"Attribute Name",value:null==i[r]?"null":i[r].LogicalName}),H.push({name:"Lookup Field EntityLogicalName",value:null==G?"null":G}),H.push({name:"FieldValue",value:null==y?"null":y}),H.push({name:"lookupFormattedValue",value:null==B?"null":B}),function(e,t,r){null==r||r.error(e,t)}("_constructFieldValue: Lookup Field EntityLogicalName or FieldValue is null",H),null;case c.AttributeType.UniqueIdentifier:var Q=p.Guid.tryParseOrNull(y);return Q?p.Guid.toLegacyGuid(Q):null;case c.AttributeType.DateTime:var X=void 0;return d===l.OData&&(X=i&&i[r]&&i[r].Behavior===N.DateTimeFieldBehavior.TimeZoneIndependent?y.replace(/-\d{2}:\d{2}$/,"Z"):y),h.IsNullOrUndefinedOrEmptyString(y)?null:new Date(Date.parse(X));case c.AttributeType.Status:case c.AttributeType.State:case c.AttributeType.Boolean:case c.AttributeType.PickList:var z=t[w(r)],W=void 0,Y=i[r].OptionSet;return Y&&(null==y&&Y.DefaultValue&&-1!==Y.DefaultValue&&(y=Y.DefaultValue),null!=y&&(W=Y.find((function(e){return Number(e.Value)===Number(y)})))),W?new _.OptionMetadata(z||W.Label,W.Value,null,null,null,W.Color,null):new _.OptionMetadata(z,y,null,null,null,null,null);case c.AttributeType.PartyList:return function(e,t,r,n,a,i){void 0===i&&(i=!1);if(n&&n.OneToManyRelationships){var o=L(e,t,n,r,a,i);if(!o)return null;var s=r[o];if(!s)return null;var u=S.getEntityDescriptor(e,"activityparty"),l=O.getAttributesForEntity(e,"activityparty"),c=Object.keys(l),d=s.filter((function(e){return e.participationtypemask===T.getParticipationTypeMask(i?a[t].aliasedValueEtn:n.EntityLogicalName,i?a[t].aliasedValueFieldName:t)})).map((function(t){return R(e,t,u,l,c)}));return new g.EntityCollection(d,!1,d.length,!1,null,null)}return new g.EntityCollection([],!1,0,!1,null,null)}(e,r,t,a,s,null!=s&&null!=s[r]);default:return y}}function F(e,t,r,n){if(void 0===n&&(n=!1),n&&r&&r[e]){var a=x(r,t,e);return r[e].oDataAlias[a]}return e}function L(e,t,r,n,a,i){void 0===i&&(i=!1);var o=i?a[t].aliasedValueEtn:r.EntityLogicalName,s=S.getActivityPartyNavigationPropertyRelationship(e,o);if(!s)return null;if(i){var u=x(a,n,t);return""+a[t].alias+a[t].oDataSeparator[u]+s.ReferencedEntityNavigationPropertyName}return""+s.ReferencedEntityNavigationPropertyName}function k(e,t,r){return void 0===t&&(t=l.OData),void 0===r&&(r=!1),t===l.OData?r?e:P(e):e+"!id"}function x(e,t,r){if(e&&e.hasOwnProperty(r)&&e[r].oDataAlias.length>0)for(var n=0;n<e[r].oDataAlias.length;n++)if(t.hasOwnProperty(e[r].oDataAlias[n]))return n;return 0}t.REMOVE_NOTIFICATIONS="notification.remove",t.getLookupPropertyName=P,t.getLookupLogicalNameAnnotation=I,t.getFormattedValueAnnotation=w},gmsG:function(e,t,r){"use strict";r.r(t),r.d(t,"MDL_COMPONENT_NAME",(function(){return n})),r.d(t,"FILE_PREFIX",(function(){return a})),r.d(t,"COMPONENT_NAMES",(function(){return i})),r.d(t,"EVENT_PARAMETERS",(function(){return o})),r.d(t,"ScenarioType",(function(){return s}));
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
const n="ModernDataLayer",a={GetSqlResults:"GetSqlResults",MetadataCache:"MetadataCache",SQLGenerator:"SQLGenerator",PolicyManager:"PolicyManager",PromiseCache:"PromiseCache",CreateResponseHandler:"CreateResponseHandler",DeleteResponseHandler:"DeleteResponseHandler",GetClientMetadataResponseHandler:"GetClientMetadataResponseHandler",UpdateResponseHandler:"UpdateResponseHandler",RetrieveResponseHandler:"RetrieveResponseHandler",BPFResponseHandler:"BPFResponseHandler",RetrieveMultipleResponseHandler:"RetrieveMultipleResponseHandler",FileExecutor:"FileExecutor",QueryGenerator:"QueryGenerator",ResponseHandler:"ResponseHandler",SQLExecutor:"SQLExecutor",UrlParserHandler:"UrlParserHandler",LocalODataClientManager:"LocalODataClientManager",ODataClientManager:"ODataClientManager",ODataExecutor:"ODataExecutor",DeleteGenerator:"DeleteGenerator",RetrieveMultipleGenerator:"RetrieveMultipleGenerator",SQLModifier:"SQLModifier",UpdateGenerator:"UpdateGenerator",PolicyRetryInterceptor:"PolicyRetryInterceptor",TimeoutInterceptor:"TimeoutInterceptor",ExecuteRequestInterceptor:"ExecuteRequestInterceptor",RequestResponseInterceptor:"RequestResponseInterceptor",LongRequestInterceptor:"LongRequestInterceptor",FileRequestInterceptor:"FileRequestInterceptor",SQLRequestInterceptor:"SQLRequestInterceptor",HttpExecutorInterceptor:"HttpExecutorInterceptor",PromiseCacheInterceptor:"PromiseCacheInterceptor",GCMGenerator:"GCMGenerator",Common:"Common",RootFinder:"RootFinder",MetadataSQLExecutor:"MetadataSQLExecutor",DataSQLExecutor:"DataSQLExecutor",CreateGenerator:"CreateGenerator",QuickFindSQLGenerator:"QuickFindSQLGenerator",MergeQuickFindSQLGenerator:"MergeQuickFindSQLGenerator",RetrieveGenerator:"RetrieveGenerator",ApplyFilterSQLGenerator:"ApplyFilterSQLGenerator",ApplyFinalModifiedSQLGenerator:"ApplyFinalModifiedSQLGenerator",ApplySelectSQLGenerator:"ApplySelectSQLGenerator",ApplyOrderBySQLGenerator:"ApplyOrderBySQLGenerator"},i={ODataExecutor:`${n}.${a.ODataExecutor}`,RemoteODataExecutor:n+".RemoteODataExecutor",LocalODataExecutor:n+".LocalODataExecutor",SQLExecutor:`${n}.${a.SQLExecutor}`,FileExecutor:`${n}.${a.FileExecutor}`,SQLGenerator:`${n}.${a.QueryGenerator}`,ResponseHandler:`${n}.${a.ResponseHandler}`,UrlParserHandler:`${n}.${a.UrlParserHandler}`,MetadataCache:`${n}.${a.MetadataCache}`},o={HTTP_STATUS_CODE:"HTTP-Status-Code",HTTP_RESPONSE_TYPE:"HTTP-Response-Type",HTTP_RESPONSE_STATUS_TEXT:"HTTP-Response-Status-Text",RESPONSE_URL:"Response-Url",RESPONSE_SIZE_IN_BYTES:"Response-Size-In-Bytes",ERROR_CODE:"Error-Code",ERROR_MESSAGE:"Error-Message",ERROR_STACK:"Error-Stack",ERROR_COMPLETE_TEXT:"Error-Complete-Text",CLIENT_TYPE:"Client-Type",RESPONSE_TIME:"Response-Time",CLIENT_REQUEST_ID:"Client-Request-Id",SERVER_REQUEST_ID:"Server-Request-Id",OPERATION_TYPE:"Operation-Type",END_POINT:"EndPoint",METHOD:"Method",EMPTY_STRING:"",SQL_ERROR_CODE:"SqlErrorCode",SQL_ERROR_MESSAGE:"SqlErrorMessage"};var s;!function(e){e.Create="Create",e.Delete="Delete",e.Load="Load",e.Update="Update"}(s||(s={}))},iDsU:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyColumnSet=void 0;var n=r("iWcK"),a=function(){function e(e){this._columns=e}return e.prototype.get_Columns=function(){return this._columns},e.prototype.get_isEmpty=function(){return!(this._columns.length>0)},e.prototype.getObjectData=function(){var e={};return e.columns=this._columns,e},e.prototype.getDifference=function(t){var r=this;return t instanceof n.AllColumns?t:new e(t.get_Columns().filter((function(e){return r.get_Columns().indexOf(e)<0})))},e.createFromObjectData=function(t){return new e(t.columns)},e}();t.LegacyColumnSet=a},iWcK:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AllColumns=void 0;var n=r("iDsU"),a=function(){function e(){}return e.prototype.get_isEmpty=function(){return!1},e.prototype.getDifference=function(e){return new n.LegacyColumnSet(new Array(0))},e.get_instance=function(){return e._instance||(e._instance=new e)},e._instance=null,e}();t.AllColumns=a},ink8:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CachePriority=void 0,function(e){e[e.Workspace=0]="Workspace",e[e.Medium=1]="Medium",e[e.NotCached=2]="NotCached"}(t.CachePriority||(t.CachePriority={}))},jLS2:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.serializeAccessRights=void 0;var n=r("FDNG");t.serializeAccessRights=function(e){var t={recordPrivileges:e.get_accessRights()},r=e.get_userSharedAttributePrivileges();if(r){var a={};for(var i in r){var o=r[i];a[i]={accessRightsMask:o.get_AccessRightsMask(),attributeId:n.Guid.fromLegacyGuid(o.get_AttributeId()),canCreate:o.get_CanCreate(),canRead:o.get_CanRead(),canUpdate:o.get_CanUpdate()}}t.attributePrivileges=a}return t}},l7wu:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.RETRIEVE_GRID_DATA=t.PREFIX=t.MDL_COMPONENT_NAMES=t.MDL_ID=void 0,t.MDL_ID="ModernDataLayer",t.MDL_COMPONENT_NAMES={ODataBuilder:t.MDL_ID+".ODataBuilder",ModernDataSource:t.MDL_ID+".ModernDataSource",ExpressionRuntime:t.MDL_ID+".ExpressionRuntime",QueryBuilder:t.MDL_ID+".QueryBuilder",UserContext:t.MDL_ID+".UserContext",AuthenticationProvider:t.MDL_ID+".AuthenticationProvider"},t.PREFIX={ODataBuilder:"ODataBuilder",ModernDataSource:"ModernDataSource",ExpressionRuntimeHost:"ExpressionRuntimeHost",ModernQueryBuilder:"ModernQueryBuilder"},t.RETRIEVE_GRID_DATA="RetrieveGridData"},lWap:function(e,t,r){"use strict";r.r(t),r.d(t,"getRequestType",(function(){return s}));var n=r("17Cn"),a=r("r1Gy"),i=r("gmsG");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
const o={};function s(e,t){const r=t?t.TraceManager.getTracer(i.COMPONENT_NAMES.UrlParserHandler):null,s=[];Object(a.d)(e,s,n.UNKNOWN);let u="";switch(e.method){case n.HTTP_REQUEST_METHOD.Post:u=-1!==e.url.indexOf("/$batch")?o[e.method].Batch:o[e.method].Create;break;case n.HTTP_REQUEST_METHOD.Get:if(e.url.match("/GetClientMetadata"))u=o[e.method].GetClientMetadata;else{const t=e.url.indexOf("("),r=e.url.indexOf("?");-1===t&&-1===r&&(u=o[e.method].RetrieveMultiple),u=-1!==t&&-1!==r?t<r?o[e.method].Retrieve:o[e.method].RetrieveMultiple:-1===t?o[e.method].RetrieveMultiple:o[e.method].Retrieve}break;case n.HTTP_REQUEST_METHOD.Patch:u=o[e.method].Patch;break;case n.HTTP_REQUEST_METHOD.Delete:u=o[e.method].Delete;break;default:const t="Request type is not supported";if(r)throw r.error(`${l?`[${l}]`:`[${i.FILE_PREFIX.UrlParserHandler}]`} ${t}`,s),new Error(t);u=n.UNKNOWN}var l;return u}o[n.HTTP_REQUEST_METHOD.Post]={Batch:n.OPERATION.Batch,Create:n.OPERATION.Create},o[n.HTTP_REQUEST_METHOD.Get]={GetClientMetadata:n.OPERATION.GetClientMetadata,RetrieveMultiple:n.OPERATION.RetrieveMultiple,Retrieve:n.OPERATION.Retrieve},o[n.HTTP_REQUEST_METHOD.Patch]={Patch:n.OPERATION.Update},o[n.HTTP_REQUEST_METHOD.Delete]={Delete:n.OPERATION.Delete}},lqZx:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XmlNode=void 0;var n=function(){function e(){}return e.createAttribute=function(e,t,r){if(e){var n=e.createAttribute(t);return n.value=r,n}return null},e}();t.XmlNode=n},mE2v:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.getHttpHeader=void 0,t.getHttpHeader=function(e,t){if(!e)return null;var r=e.get(t);return r||(r=e.get(t.toLowerCase())),r}},mVtf:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseXmlDocument=t.create=void 0;var n=r("JH5K"),a=r("NgZN"),i=r("fr82"),o=r("0f0B"),s=r("UZ+8"),u=r("SJSp"),l=o.XmlEvaluatorType.undefined;function c(){return l}function d(e){return l=e,e}t.create=function(e){return s.IsNullOrUndefined(e)?null:(c()===o.XmlEvaluatorType.undefined&&function(e){if(function(e){var t=document.evaluate,r=document.createNSResolver&&document.createNSResolver(e),n=!1;return!s.IsNullOrUndefined(t)&&r&&!n}(e)){var t=new i.XPathEvaluatorWrapper(e);try{t.selectSingleNode("/root"),d(0)}catch(e){}}c()===o.XmlEvaluatorType.undefined&&(r=window.DOMParser,s.IsNullOrUndefined(r)||d(o.XmlEvaluatorType.domParser));var r;c()===o.XmlEvaluatorType.undefined&&n.throwOnNullOrUndefinedArgument(c(),"PreferredXmlEvaluator")}(e),c()?new a.DOMParserNodeWrapper(e):new i.XPathEvaluatorWrapper(e))},t.parseXmlDocument=function(e){var t=u.ParseXml(e);if(null!=t){var r=t.getElementsByTagName("parsererror");!s.IsNullOrUndefined(r)&&r.length>0&&(t=null)}return t}},n8WZ:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.parseJsonResponse=t.retrieve=t.retrieveMultiple=t.execute=t.MDS_EVENT_PARAMETERS=void 0;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var i=r("17Cn"),o=r("gmsG"),s=r("lWap"),u=r("RncB"),l=r("EY1R"),c=r("RslU"),d=r("vqTk"),p=r("A64d"),f=r("4/PP"),y=r("3v6g"),m=r("aiEo"),h=r("e9z0"),g=r("gkFy"),E=r("rRZs"),b=r("RHls"),_=r("SJSp"),v=r("mE2v"),T=r("8xE/"),O=r("l7wu");function S(e,t,r){return n(this,void 0,void 0,(function(){var n,i;return a(this,(function(a){switch(a.label){case 0:return n={TraceManager:r.TraceManager,EventManager:r.EventManager,SqlExecutor:{}},i=A(e),null==t||t.info(P()+" Execute the request in Modern Data Layer Component"),[4,new u.ODataExecutor({},n).execute(i)];case 1:return[2,a.sent()]}}))}))}function N(e,t,r,i){var u,l;return n(this,void 0,void 0,(function(){var n,c,d;return a(this,(function(a){switch(a.label){case 0:return n=performance.now(),c=null===(l=(u=i.EventManager).getScenarioTracker)||void 0===l?void 0:l.call(u,o.ScenarioType.Load,"Storage:ModernDataLayer"),function(e,t){t.push({name:o.EVENT_PARAMETERS.CLIENT_REQUEST_ID,value:I(e)}),t.push({name:o.EVENT_PARAMETERS.CLIENT_TYPE,value:"remote"});var r=s.getRequestType(A(e));t.push({name:o.EVENT_PARAMETERS.OPERATION_TYPE,value:r})}(e,[]),[4,S(e,r,i)];case 1:return d=a.sent(),[2,R(t(),d,e,n,i,r,!1,c)]}}))}))}function R(e,r,s,u,l,c,p,f){return n(this,void 0,void 0,(function(){var e,n,m,h;return a(this,(function(a){switch(a.label){case 0:return e=performance.now()-u,(n=[]).push({name:o.EVENT_PARAMETERS.RESPONSE_TIME,value:e}),function(e,r,n,a){void 0===a&&(a=!1);var s=e.headers?v.getHttpHeader(e.headers,d.HEADER.SERVER_REQUEST_ID):i.UNKNOWN,u=e.status?e.status:null,l=e.type?e.type:null,c=e.statusText?e.statusText:i.UNKNOWN,p=e.url?E.trimUrl(e.url):i.UNKNOWN,f=e.headers?v.getHttpHeader(e.headers,d.HEADER.CONTENT_LENGTH):i.UNKNOWN;E.canLogDetailsOfRequest(e.url)&&r.push({name:o.EVENT_PARAMETERS.RESPONSE_URL,value:p});r.push({name:o.EVENT_PARAMETERS.HTTP_STATUS_CODE,value:u}),r.push({name:o.EVENT_PARAMETERS.HTTP_RESPONSE_TYPE,value:l}),r.push({name:o.EVENT_PARAMETERS.HTTP_RESPONSE_STATUS_TEXT,value:c}),r.push({name:o.EVENT_PARAMETERS.SERVER_REQUEST_ID,value:s||i.UNKNOWN}),r.push({name:o.EVENT_PARAMETERS.RESPONSE_SIZE_IN_BYTES,value:f||i.UNKNOWN}),r.push({name:t.MDS_EVENT_PARAMETERS.IS_BATCH_REQUEST,value:a}),r.push({name:t.MDS_EVENT_PARAMETERS.IS_EXPRESSION_RUNTIME_REQUEST,value:n})}(r,n,p,"$batch"===s.urlParameters),r.ok?(null==f||f.complete(n),l.EventManager.ReportComponentSuccess("Storage:ModernDataLayer",n),[2,r]):[3,1];case 1:return r.url&&-1!==r.url.indexOf("$batch")||s&&s.urlParameters&&-1!==s.urlParameters.indexOf("$batch")?[4,y.parseBatchResponse(r)]:[3,3];case 2:return(m=a.sent()).length>0&&(h=m.find((function(e){return!e.ok})))?[2,M(h,l,n,c,f)]:(c&&c.error("Batch response parsing has failed",n),[2,M(r,l,n,c,f)]);case 3:return null==c||c.error(P()+" Modern Data Layer component returns Error Response - Convert error to CRM Error.",n),[2,M(r,l,n,c,f)]}}))}))}function M(e,r,o,s,u){return n(this,void 0,void 0,(function(){var n,l,c,d,p,y;return a(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,e.text()];case 1:return l=a.sent(),n=f.deserializeErrorResponse(l,e,o,s),E.canLogDetailsOfRequest(e.url)&&(o.push({name:"Odata-Error-Response-Complete-text",value:l}),o.push({name:"Crm-Error-Response-From-OdataResponse",value:JSON.stringify(n)})),c=n.message||"Request Failure",o.push({name:t.MDS_EVENT_PARAMETERS.CRM_ERROR_CODE,value:n.errorCode}),n.stack&&o.push({name:t.MDS_EVENT_PARAMETERS.CRM_CALL_STACK,value:n.stack}),o.push({name:t.MDS_EVENT_PARAMETERS.CRM_ERROR_MESSAGE,value:c}),d=e?e.status:null,[400,404,500,503].indexOf(d)>-1&&!T.isNonReportableErrorCode(n.errorCode)?(p=new b.ErrorStatus(c,n.errorCode,void 0,null,null,null,null,o,null,null,null,!1,-1,null,d,n.clientRequestId,n.serverResponseId),null==u||u.failure(o),r.EventManager.ReportComponentFailure("Storage:ModernDataLayer",p,void 0,o)):null==s||s.error(c,o),[3,3];case 2:throw a.sent(),null==s||s.error(P()+" Modern Data Layer component : Exception occurred while creating error response.",o),y=T.ErrorCodes.unknownInternalServerError,new b.ErrorStatus(i.UNKNOWN,y);case 3:throw n}}))}))}function A(e){return{url:e.urlParameters,method:e.method,additionalHeaders:e.additionalHeaders,body:e.body}}function C(e,t,r){return n(this,void 0,void 0,(function(){var n;return a(this,(function(a){if(null==r||r.AppendCallStack("WebAPIService.parseJsonResponse"),e)return(n=v.getHttpHeader(e.headers,d.HEADER.CONTENT_TYPE))&&n.indexOf("text/html")>-1?(null==r||r.AppendCallStack("WebAPIService.response.text"),[2,e.text().then((function(r){throw f.deserializeErrorResponse(r,e,[],t)}))]):(null==r||r.AppendCallStack("WebAPIService.response.json"),[2,e.json()]);throw new b.ErrorStatus("Null response from server")}))}))}function P(e){return"["+(e||O.PREFIX.ModernDataSource)+"]"}function I(e){var t;return(null===(t=null==e?void 0:e.additionalHeaders)||void 0===t?void 0:t[d.HEADER.CLIENT_REQUEST_ID])||i.UNKNOWN}t.MDS_EVENT_PARAMETERS={CRM_ERROR_CODE:"Crm-Error-Code",CRM_ERROR_MESSAGE:"Crm-Error-Message",CRM_CALL_STACK:"Crm-Call-Stack",IS_BATCH_REQUEST:"IsBatchRequest",IS_EXPRESSION_RUNTIME_REQUEST:"IS_EXPRESSION_RUNTIME_REQUEST",IS_ERROR_IN_OFFLINE:"ErrorInOffline",ODATA_ERROR_RESPONSE_IS_HTML_TYPE:"Odata-Error-Response-Is-Html-Type"},t.execute=function(e,t,r){return{type:"modernDataSource.execute.odata.async",execute:function(t,r){var i=t.getState,o=t.dispatch;return n(this,void 0,void 0,(function(){var t;return a(this,(function(n){switch(n.label){case 0:return(t=r.TraceManager.getTracer(O.MDL_COMPONENT_NAMES.ModernDataSource)).info(P()+" Execute legacy request."),[4,o(l.requestAdditionalMetadataForRequest(e))];case 1:return n.sent(),[4,o(p.fromODataContract(e))];case 2:return[2,N(n.sent(),i,t,r)]}}))}))}}},t.retrieveMultiple=function(e){return{type:"moderndatasource.retrievemultiple.async",execute:function(t,r){var i=t.getState,o=t.dispatch;return n(this,void 0,void 0,(function(){var t,n,s,u,l;return a(this,(function(a){switch(a.label){case 0:return(t=r.TraceManager.getTracer(O.MDL_COMPONENT_NAMES.ModernDataSource)).info(P()+" Retrieve multiple is executing"),n=_.getAttributesMapFromFetch(null==e?void 0:e.fetchXml),[4,o(c.retrieveEntities(n))];case 1:return a.sent(),[4,o(p.fromQueryState(e))];case 2:return s=a.sent(),u=m.parseFetchXmlForAliasedValues(null==e?void 0:e.fetchXml),[4,N(s,i,t,r)];case 3:return[4,C(a.sent(),t)];case 4:return l=a.sent(),[2,m.deserializeEntityCollection(i(),e,u,l)]}}))}))}}},t.retrieve=function(e,t){return{type:"moderndatasource.retrieve.async",execute:function(r,i){var o=r.getState,s=r.dispatch;return n(this,void 0,void 0,(function(){var r,n;return a(this,(function(a){switch(a.label){case 0:return(r=i.TraceManager.getTracer(O.MDL_COMPONENT_NAMES.ModernDataSource)).info(P()+" Retrieve is executing"),[4,s(c.retrieveEntity(e.etn,!0))];case 1:return a.sent(),[4,s(p.fromODataContract(h.buildRetrieveContract(o(),e,t)))];case 2:return[4,N(a.sent(),o,r,i)];case 3:return[4,C(a.sent(),r)];case 4:return n=a.sent(),[4,s(g.createEntityRecordFromResponseAsync(n,e.etn,t,void 0,void 0,void 0,r))];case 5:return[2,a.sent()]}}))}))}}},t.parseJsonResponse=C},nRuH:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.UCIContext=void 0;var i=function(e){function t(t,r){void 0===r&&(r=!1);var n=e.call(this,t)||this;return n._isPreloadCall=!1,n.requestId=t,n._isPreloadCall=r,n}return a(t,e),t.prototype.RequestId=function(){return this.requestId},t.prototype.IsPreloadCall=function(){return this._isPreloadCall},t.prototype.toString=function(){return"["+this.RequestId()+"]"},t}(r("0DNP").CallingContext);t.UCIContext=i},oMGx:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.isODataContract=t.isChangeSet=t.buildRequest=t.executeMultiple=void 0;var u=r("FHhg"),l=r("n8WZ"),c=r("evga"),d=r("DepX"),p=i(r("bMRw")),f=r("uzdi"),y=r("3v6g"),m=r("e9z0"),h=r("CGvr"),g=r("54+h");t.executeMultiple=function(e){return{type:"executeOData.batch.async",execute:function(t){var r=t.dispatch;return o(this,void 0,void 0,(function(){var t,n;return s(this,(function(a){switch(a.label){case 0:return t=new f.ODataExecuteMultipleRequest(e),[4,r(l.execute(t))];case 1:return n=a.sent(),[2,y.parseBatchResponse(n)]}}))}))}}},t.buildRequest=function(e,t){if(!t)return{serializationFailure:"Cannot build the serialized request: the request object is empty"};if(!t.getMetadata())return{serializationFailure:"Cannot build the serialized request: the request object does not contain metadata definition"};switch(t.getMetadata().operationType){case p.ODataOperationType.Function:return g.buildFunctionRequest(e,t);case p.ODataOperationType.CRUD:return function(e,t){switch(t.getMetadata().operationName){case"Create":var r=t;return c.buildCreateRequest(e,r.etn,r.payload,r.suppressDupeDetection);case"RetrieveWithUrlParams":var n=t;return m.buildRetrieveRequestWithURLParams(e,n.etn,n.id,n.urlParams,n.maxPageSize,n.headers);case"Update":var a=t;return h.buildUpdateRequest(e,a.etn,a.id,a.payload,a.suppressDupeDetection,null,!1,a.urlParams,a.headers,a.isBinaryPayload);case"Delete":var i=t,o=u.EntityReference.fromExternalEntityReference(i.entityReference);return d.buildDeleteRequest(e,o,null,i.attributeName);default:return{serializationFailure:"Cannot convert ODataContract with "+t.getMetadata().operationName+" operation into a serialized request"}}}(e,t);default:return{serializationFailure:"Cannot build the serialized request: the operation type is not supported"}}},t.isODataContract=function(e){return e&&e.getMetadata},t.isChangeSet=function(e){return e&&Array.isArray(e)&&e.length>0&&e[0].getMetadata}},pdzI:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n;Object.defineProperty(t,"__esModule",{value:!0}),t.isDataUsable=t.InitState=void 0,function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized",e[e.Refreshing=3]="Refreshing",e[e.Error=4]="Error",e[e.Partial=5]="Partial"}(n||(n={})),t.InitState=n,t.isDataUsable=function(e){return e===n.Initialized||e===n.Refreshing}},qIJm:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConcurrencyBehavior=void 0,function(e){e[e.Default=0]="Default",e[e.IfRowVersionMatches=1]="IfRowVersionMatches",e[e.AlwaysOverwrite=2]="AlwaysOverwrite"}(t.ConcurrencyBehavior||(t.ConcurrencyBehavior={}))},r1Gy:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return l})),r.d(t,"a",(function(){return c})),r.d(t,"f",(function(){return d})),r.d(t,"c",(function(){return p})),r.d(t,"g",(function(){return f}));var n=r("lWap"),a=r("17Cn"),i=r("gmsG"),o=r("OhA8");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
function s(e,t=[]){return t.concat(e)}function u(e,t,r){const s=e&&e.additionalHeaders?e.additionalHeaders[a.HEADER.CLIENT_REQUEST_ID]:i.EVENT_PARAMETERS.EMPTY_STRING;t.push({name:i.EVENT_PARAMETERS.CLIENT_REQUEST_ID,value:s}),t.push({name:i.EVENT_PARAMETERS.END_POINT,value:e.endpoint||a.UNKNOWN}),t.push({name:i.EVENT_PARAMETERS.METHOD,value:e.method||a.UNKNOWN});const u=Object(o.h)(e);t.push({name:i.EVENT_PARAMETERS.CLIENT_TYPE,value:u}),r=r||Object(n.getRequestType)(e),t.push({name:i.EVENT_PARAMETERS.OPERATION_TYPE,value:""+r})}function l(e,t){const r=e.status||i.EVENT_PARAMETERS.EMPTY_STRING,n=e.statusText||i.EVENT_PARAMETERS.EMPTY_STRING;if(!Object(o.m)(e.headers)){const r=e.headers,n=Object(o.j)(r,a.HEADER.SERVER_REQUEST_ID)||i.EVENT_PARAMETERS.EMPTY_STRING;t.push({name:i.EVENT_PARAMETERS.SERVER_REQUEST_ID,value:n});const s=Object(o.j)(r,a.HEADER.CONTENT_LENGTH)||i.EVENT_PARAMETERS.EMPTY_STRING;t.push({name:i.EVENT_PARAMETERS.RESPONSE_SIZE_IN_BYTES,value:s})}t.push({name:i.EVENT_PARAMETERS.HTTP_STATUS_CODE,value:r}),t.push({name:i.EVENT_PARAMETERS.HTTP_RESPONSE_STATUS_TEXT,value:n})}function c(e,t,r=!1){Object(o.m)(e)||(t.push({name:i.EVENT_PARAMETERS.ERROR_CODE,value:e[a.STRING_CONSTANTS.ErrorCode]||i.EVENT_PARAMETERS.EMPTY_STRING}),t.push({name:i.EVENT_PARAMETERS.ERROR_STACK,value:e[a.STRING_CONSTANTS.StackTrace]||i.EVENT_PARAMETERS.EMPTY_STRING}),t.push({name:i.EVENT_PARAMETERS.ERROR_MESSAGE,value:e[a.STRING_CONSTANTS.Message]||i.EVENT_PARAMETERS.EMPTY_STRING}),r&&t.push({name:i.EVENT_PARAMETERS.ERROR_COMPLETE_TEXT,value:JSON.stringify(e)}))}async function d(e,t){try{const r=await e.text(),n=JSON.parse(r).error||{};return c(n,t,function(e){if(Object(o.o)(e))return!1;if(-1!==e.indexOf("GetClientMetadata")||-1!==e.indexOf("EntityDefinitions")||-1!==e.indexOf("SyncClientMetadata"))return!0;return!1}(e.url)),l(e,t),t}catch(e){return t}}function p(e,t,r){for(const n in t){const a=e.getPerformanceEntry(t[n]);a&&a.performanceMeasure&&a.performanceStatistic&&(1===a.performanceStatistic.count?(r.push({name:t[n]+"-startTime",value:a.performanceMeasure.startTime||0}),r.push({name:t[n]+"-endTime",value:a.performanceMeasure.endTime||0})):a.performanceStatistic.count>1&&(r.push({name:t[n]+"-totalDuration",value:a.performanceStatistic.totalDuration||0}),r.push({name:t[n]+"-averageDuration",value:a.performanceStatistic.averageDuration||0}),r.push({name:t[n]+"-executionCount",value:a.performanceStatistic.count||0})))}}function f(e){let t="";try{if(!Object(o.o)(e)){const r=JSON.parse(e);if(!Object(o.n)(r.results))for(const e of r.results)e.result&&(Array.isArray(e.result)&&e.result.length>0&&!Object(o.o)(e.result[0].message)?t=t+e.result[0].message+";\n":Object(o.o)(e.result.message)||(t=t+e.result.message+";\n"))}}catch(r){t=e}return t}},rRZs:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.canLogDetailsOfRequest=t.trimUrl=void 0;var n=r("UZ+8");function a(e){return!n.IsNullOrUndefined(e)&&(-1!==e.indexOf("GetClientMetadata")||-1!==e.indexOf("EntityDefinitions")||-1!==e.indexOf("SyncClientMetadata"))}t.trimUrl=function(e){if(n.IsNullOrUndefined(e))return e;if(a(e))return e;if(-1!==e.indexOf("fetchXml=")){var t=e.indexOf("fetchXml="),r=decodeURIComponent(e.substring(e.indexOf("fetchXml=")+"fetchXml=".length,e.length));return e.substring(0,t+"fetchXml=".length)+function(e){var t=new DOMParser,r=new XMLSerializer,n="X";if(e){var a=t.parseFromString(e,"text/xml");if(a){var i=Array.prototype.slice.call(a.getElementsByTagName("condition"));return i&&i.forEach((function(e){e.getAttribute("value")&&e.setAttribute("value",n),e.getAttribute("uiname")&&e.setAttribute("uiname",n);var t=Array.prototype.slice.call(e.getElementsByTagName("value"));t&&t.forEach((function(e){e.getAttribute("uiname")&&e.setAttribute("uiname",n),e.textContent=n}))})),r.serializeToString(a)}return null}return null}(r)}var i=e.indexOf("?");if(-1===i){var o=e.indexOf("=");return-1===o?e:e.substring(0,o)}return e.substring(0,i)},t.canLogDetailsOfRequest=a},rfM3:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var n,a,i,o;r.r(t),r.d(t,"ApplicationMetadataType",(function(){return n})),r.d(t,"MetadataType",(function(){return a})),r.d(t,"MetadataSubtype",(function(){return o})),r.d(t,"QueriedMetadataType",(function(){return i})),function(e){e[e.all=0]="all",e[e.systemApplicationMetadata=1]="systemApplicationMetadata",e[e.userApplicationMetadata=2]="userApplicationMetadata"}(n||(n={})),function(e){e[e.none=0]="none",e[e.workspace=1]="workspace",e[e.form=2]="form",e[e.component=3]="component",e[e.entityCard=4]="entityCard",e[e.quickCreateForm=5]="quickCreateForm",e[e.customization=6]="customization",e[e.listQuery=7]="listQuery",e[e.grid=8]="grid",e[e.command=9]="command",e[e.siteMap=10]="siteMap",e[e.list=11]="list",e[e.dialog=12]="dialog",e[e.gridForm=13]="gridForm",e[e.inlineCreateForm=14]="inlineCreateForm",e[e.processControl=15]="processControl",e[e.fetchXml=16]="fetchXml",e[e.chartDrilldownForm=17]="chartDrilldownForm",e[e.entity=18]="entity",e[e.attribute=19]="attribute",e[e.webResource=20]="webResource",e[e.applicationMetadata=21]="applicationMetadata",e[e.mainFormDialog=22]="mainFormDialog",e[e.chart=23]="chart",e[e.uiStrings=24]="uiStrings",e[e.businessLogic=25]="businessLogic",e[e.searchPage=26]="searchPage",e[e.globalApplicationMetadata=27]="globalApplicationMetadata",e[e.applicationMetadataUserContext=28]="applicationMetadataUserContext",e[e.staticJSFile=29]="staticJSFile",e[e.layoutXml=30]="layoutXml",e[e.draftsPage=31]="draftsPage",e[e.duplicateRecordsPage=32]="duplicateRecordsPage",e[e.applicationMetadataSettings=33]="applicationMetadataSettings",e[e.senderFormPage=34]="senderFormPage",e[e.setRegarding=35]="setRegarding",e[e.senderCreateFormPage=36]="senderCreateFormPage",e[e.interactionCentricWorkspace=37]="interactionCentricWorkspace",e[e.taskBasedFlowGlobalMenu=38]="taskBasedFlowGlobalMenu",e[e.taskBasedFlow=39]="taskBasedFlow",e[e.interactionCentricForm=40]="interactionCentricForm",e[e.cardForm=41]="cardForm",e[e.controlConfiguration=42]="controlConfiguration",e[e.commandXaml=43]="commandXaml",e[e.documentTemplate=44]="documentTemplate",e[e.viewSelector=45]="viewSelector",e[e.customControl=46]="customControl",e[e.formSelector=47]="formSelector",e[e.resourceString=48]="resourceString",e[e.savedQueryVisualization=49]="savedQueryVisualization",e[e.label=50]="label",e[e.userView=51]="userView",e[e.savedView=52]="savedView",e[e.viewDefault=53]="viewDefault",e[e.homePageConfiguration=54]="homePageConfiguration",e[e.optionSet=56]="optionSet",e[e.quickCreateMenu=57]="quickCreateMenu",e[e.userContext=58]="userContext",e[e.businessProcessFlow=59]="businessProcessFlow",e[e.searchConfiguration=60]="searchConfiguration",e[e.userQueryVisualization=61]="userQueryVisualization",e[e.visualizationSelector=62]="visualizationSelector",e[e.dashboardSelector=63]="dashboardSelector",e[e.overallMetadataVersion=64]="overallMetadataVersion",e[e.appModule=65]="appModule",e[e.complexControl=66]="complexControl",e[e.displayString=67]="displayString",e[e.webResourceDescriptor=68]="webResourceDescriptor",e[e.isActivityFlags=69]="isActivityFlags",e[e.appModuleOfflineMetadata=70]="appModuleOfflineMetadata",e[e.appModuleSelector=71]="appModuleSelector",e[e.bpfSelector=72]="bpfSelector",e[e.dependencies=73]="dependencies"}(a||(a={})),function(e){e.entity="entity",e.savedView="savedview",e.form="form",e.workspace="workspace",e.systemWorkspace="systemworkspace",e.userWorkspace="userworkspace",e.savedVisualization="savedvisualization",e.dialog="dialog",e.taskBasedFlow="taskbasedflow",e.customControl="customcontrol",e.complexControl="complexcontrol",e.formSelector="formselector",e.viewSelector="viewselector",e.ribbon="ribbon"}(i||(i={})),function(e){e[e.none=0]="none",e[e.main=1]="main",e[e.appointment=2]="appointment",e[e.hardcoded=3]="hardcoded",e[e.miniCampaignBO=4]="miniCampaignBO",e[e.preview=5]="preview",e[e.dashboard=6]="dashboard",e[e.quick=7]="quick",e[e.quickCreate=8]="quickCreate",e[e.mobile=9]="mobile",e[e.read=10]="read",e[e.card=11]="card",e[e.dialog=12]="dialog",e[e.taskBased=14]="taskBased",e[e.interactionCentricDashboard=15]="interactionCentricDashboard",e[e.advancedSearch=16]="advancedSearch",e[e.subGrid=17]="subGrid",e[e.quickFindSearch=18]="quickFindSearch",e[e.reporting=19]="reporting",e[e.offlineFilters=20]="offlineFilters",e[e.maSearch=21]="maSearch",e[e.lookup=22]="lookup",e[e.smAppointmentBook=23]="smAppointmentBook",e[e.outlookFilters=24]="outlookFilters",e[e.addressbookFilters=25]="addressbookFilters",e[e.savedQueryTypeOther=26]="savedQueryTypeOther",e[e.interactiveWorkFlow=27]="interactiveWorkFlow",e[e.offlineTemplate=28]="offlineTemplate",e[e.outlookTemplate=29]="outlookTemplate",e[e.customDefined=30]="customDefined",e[e.jScript=31]="jScript",e[e.css=32]="css",e[e.png=33]="png",e[e.jpg=34]="jpg",e[e.gif=35]="gif",e[e.advancedFind=36]="advancedFind"}(o||(o={}))},s1MM:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XPathResultType=void 0,function(e){e[e.ANY_TYPE=0]="ANY_TYPE",e[e.NUMBER_TYPE=1]="NUMBER_TYPE",e[e.STRING_TYPE=2]="STRING_TYPE",e[e.BOOLEAN_TYPE=3]="BOOLEAN_TYPE",e[e.UNORDERED_NODE_ITERATOR_TYPE=4]="UNORDERED_NODE_ITERATOR_TYPE",e[e.ORDERED_NODE_ITERATOR_TYPE=5]="ORDERED_NODE_ITERATOR_TYPE",e[e.UNORDERED_NODE_SNAPSHOT_TYPE=6]="UNORDERED_NODE_SNAPSHOT_TYPE",e[e.ORDERED_NODE_SNAPSHOT_TYPE=7]="ORDERED_NODE_SNAPSHOT_TYPE",e[e.ANY_UNORDERED_NODE_TYPE=8]="ANY_UNORDERED_NODE_TYPE",e[e.FIRST_ORDERED_NODE_TYPE=9]="FIRST_ORDERED_NODE_TYPE"}(t.XPathResultType||(t.XPathResultType={}))},"u+qd":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.serializeComplexTypeParameter=t.serializeIntoURLFragment=t.getODataUrlForFunction=t.serializeContract=void 0;var o=i(r("bMRw")),s=r("FDNG"),u=r("Mx+d"),l=r("Q6jc"),c=r("geC1"),d=r("LEFC"),p={COLON:encodeURIComponent(":"),OPEN_BRACKET:encodeURIComponent("{"),CLOSED_BRACKET:encodeURIComponent("}"),COMMA:encodeURIComponent(","),EQUAL:encodeURIComponent("=")};function f(e,t){var r=t.getMetadata().boundParameter,n=[],a=Object.keys(t).filter((function(e){return e!==r})).map((function(r){var a=t.getMetadata().parameterTypes[r],i=b(e,t,r,!1,!0);return void 0!==a&&o.ODataStructuralProperty.EnumerationType===a.structuralProperty?r+"="+i:(n.push("@"+r+"="+i),r+"=@"+r)}));return n.length?"("+a.join(",")+")?"+n.join("&"):"("+a.join(",")+")"}function y(e,t,r,n){switch(e){case"Edm.String":return m(e,t,r,n);case"Edm.Guid":return m(e,t.guid,r,n);case"Edm.DateTimeOffset":if("object"==typeof t&&"function"==typeof t.toISOString)return m(e,t.toISOString(),r,n);default:return m("Edm.UndefinedType",t,r,n)}}function m(e,t,r,n){switch(function(e,t,r){var n=r?t?l.EncodeRule.DoubleQuotesURL:l.EncodeRule.NoQuotesURL:l.EncodeRule.Contract;return n===l.EncodeRule.Contract?"Edm.UndefinedType"===e?n=l.EncodeRule.None:"Edm.String"===e&&(n=l.EncodeRule.JsonifyURL):n===l.EncodeRule.NoQuotesURL&&"Edm.String"===e?n=l.EncodeRule.SingleQuotesURL:n===l.EncodeRule.DoubleQuotesURL&&"Edm.UndefinedType"===e&&(n=l.EncodeRule.NoQuotesURL),n}(e,r,n)){case l.EncodeRule.JsonifyURL:return JSON.stringify(t);case l.EncodeRule.SingleQuotesURL:return"'"+c.encodeURIComponentForOData(t)+"'";case l.EncodeRule.DoubleQuotesURL:return'"'+c.encodeURIComponentForOData(t)+'"';case l.EncodeRule.NoQuotesURL:return c.encodeURIComponentForOData(t);case l.EncodeRule.Contract:return'"'+t+'"';default:return t}}function h(e,t,r,n){if(void 0===n&&(n=!1),t){var a="{",i="",o=n?p.COLON:":";if(r){var s=t.getMetadata().typeName;s&&r.typeName!==s&&(a+='"@odata.type"'+o+'"'+s+'"',i=",")}for(var u in t)if("function"!=typeof t[u]){var l=b(e,t,u,!0,n);if(g(t,u,l))continue;a+=i+'"'+u+'"'+o+l,i||(i=",")}return a+"}"}return"null"}function g(e,t,r){if(e instanceof d.MetadataQuery){if([null,"null","[]",""].indexOf(r)>=0)return!0;if("DependencyDepth"===t&&e[t]===l.DependencyDepth.OnDemandWithoutContext)return!0}return!1}function E(e,t,r,n){var a=c.getEnumValueMetadata(e,t);return null==a?"":r?m(t.typeName,a.name,r,n):t.typeName+"'"+a.name+"'"}function b(e,t,r,n,a){void 0===n&&(n=!1),void 0===a&&(a=!1);var i=t.getMetadata(),s=t[r];if(r&&0===r.indexOf("@odata."))return'"'+s+'"';var u=i.parameterTypes[r];if(void 0===u)return null;switch(u.structuralProperty){case o.ODataStructuralProperty.PrimitiveType:return null==s?null:"MetadataSubtype"===r&&"Edm.String"===u.typeName?'"'+s+'"':y(u.typeName,s,n,a);case o.ODataStructuralProperty.EntityType:return c.serializeEntityType(e,s,n,a);case o.ODataStructuralProperty.ComplexType:return h(e,s,u,a);case o.ODataStructuralProperty.EnumerationType:return E(s,u,n,a);case o.ODataStructuralProperty.Collection:return s?s.length?s[0].getMetadata?"["+s.map((function(t){return h(e,t,void 0,a)})).join(",")+"]":-1!==c.ODataPrimitives.indexOf(u.typeName)?"["+s.map((function(e){return y(u.typeName,e,n,a)})).join(",")+"]":u.enumProperties?"["+s.map((function(e){return E(e,u,n,a)})).join(",")+"]":"number"==typeof s[0]?"["+s.map((function(e){return y("Edm.String",e,n,a)})).join(",")+"]":"["+s.map((function(t){return c.serializeEntityType(e,t,n,a)})).join(",")+"]":"[]":"null";default:return null}}t.serializeIntoURLFragment=f,t.serializeContract=h,t.serializeComplexTypeParameter=b,t.getODataUrlForFunction=function(e,t){return""+function(e,t,r){if(!t)throw new Error("Cannot generate base URL for the OData call: the routine name is empty.");if(!r)throw new Error("Cannot generate base URL for the OData call: the request is empty.");if(!r.getMetadata())throw new Error("Cannot generate base URL for the OData call: the request metadata is empty.");var n=r.getMetadata().boundParameter;if(n){var a=r.getMetadata();if(!a||!a.parameterTypes||!a.parameterTypes[n])return null;if(a.parameterTypes[n].structuralProperty===o.ODataStructuralProperty.Collection){var i=a.parameterTypes[n].typeName&&a.parameterTypes[n].typeName.split(".").pop();return i&&(l=u.getEntitySetName(e,i))?l+"/Microsoft.Dynamics.CRM."+t:null}var l,c=r[n];return(l=u.getEntitySetName(e,c.entityType))+"("+s.Guid.fromExternalGuid(c.id).guid+")/Microsoft.Dynamics.CRM."+t}return""+t}(e,t.getMetadata().operationName,t)+f(e,t)}},ugCW:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RetrievalStrategy=void 0,function(e){e[e.Local=0]="Local",e[e.Remote=1]="Remote",e[e.LocalAndRemote=2]="LocalAndRemote"}(t.RetrievalStrategy||(t.RetrievalStrategy={}))},uzdi:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ODataExecuteMultipleRequest=t.ODataRetrieveWithUrlParamsRequest=t.ODataDeleteRequest=t.ODataUpdateRequest=t.ODataCreateRequest=void 0;var o=i(r("bMRw")),s=function(){function e(e,t,r){void 0===r&&(r=!0),this.etn=e,this.payload=t,this.suppressDupeDetection=r}return e.prototype.getMetadata=function(){return{boundParameter:void 0,parameterTypes:{},operationName:"Create",operationType:o.ODataOperationType.CRUD}},e}();t.ODataCreateRequest=s;var u=function(){function e(e,t,r,n,a,i,o){this.etn=e,this.id=t,this.payload=r,this.urlParams=n,this.headers=a,this.isBinaryPayload=i,this.suppressDupeDetection=o}return e.prototype.getMetadata=function(){return{boundParameter:void 0,parameterTypes:{},operationName:"Update",operationType:o.ODataOperationType.CRUD}},e}();t.ODataUpdateRequest=u;var l=function(){function e(e,t){this.entityReference=e,this.attributeName=t}return e.prototype.getMetadata=function(){return{boundParameter:void 0,parameterTypes:{entityReference:{typeName:"mscrm.crmbaseentity",structuralProperty:o.ODataStructuralProperty.EntityType}},operationName:"Delete",operationType:o.ODataOperationType.CRUD}},e}();t.ODataDeleteRequest=l;var c=function(){function e(e,t,r,n,a){this.etn=e,this.id=t,this.urlParams=r,this.headers=n,this.maxPageSize=a}return e.prototype.getMetadata=function(){return{boundParameter:void 0,parameterTypes:{},operationName:"RetrieveWithUrlParams",operationType:o.ODataOperationType.CRUD}},e}();t.ODataRetrieveWithUrlParamsRequest=c;var d=function(){function e(e){this.requests=e}return e.prototype.getMetadata=function(){return{boundParameter:void 0,parameterTypes:{},operationName:"ExecuteMultiple",operationType:o.ODataOperationType.ExecuteMultiple}},e}();t.ODataExecuteMultipleRequest=d},vqTk:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.APP_ENTITY=t.WEB_API_URL_FRAGMENT=t.HEADER_VALUES=t.HEADER=void 0,
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
t.HEADER={ACCEPT:"Accept",PREFER:"Prefer",AUTO_DISASSOCIATE:"AutoDisassociate",IF_MATCH:"If-match",AUTHORIZATION_HEADER:"Authorization",CONSISTENCY:"Consistency",CONTENT_LENGTH:"Content-Length",CONTENT_TYPE:"Content-Type",CONTENT_ID:"Content-Id",RETRY_AFTER:"Retry-After",MSCRM_SUPPRESS_DUPLICATION_DETECTION:"MSCRM.SuppressDuplicateDetection",MSCRM_RETURN_NOTIFICATIONS:"MSCRM.ReturnNotifications",CLIENT_REQUEST_ID:"x-ms-client-request-id",SERVER_REQUEST_ID:"x-ms-service-request-id",SESSION_ID:"x-ms-client-session-id",ACTIVITY_ID:"x-ms-client-activity-id",SOURCE_ID:"x-ms-source-id",CORRELATION_ID:"x-ms-correlation-id",MS_USER_AGENT:"x-ms-user-agent",VIEW_ID_HINT:"x-ms-mdl-viewId",PAGESIZE_HINT:"x-ms-mdl-pageSize",PAGE_NUMBER_HINT:"x-ms-mdl-pageNumber",SEARCH_HINT:"x-ms-mdl-search",FILTER_HINT:"x-ms-mdl-filter",ORDERBY_HINT:"x-ms-mdl-orderby",SELECT_HINT:"x-ms-mdl-select",LINK_HINT:"x-ms-mdl-link",EXECUTION_HINT:"x-ms-mdl-execution-hints"},t.HEADER_VALUES={APPLICATION_JSON:"application/json",TEXT_HTML:"text/html",ANNOTATIONS:'odata.include-annotations="*"',STRONG:"Strong"},t.WEB_API_URL_FRAGMENT="/api/data/v9.0/",t.APP_ENTITY="appmodules"},wEu3:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.GARBAGE_COLLECT_METADATA_ACTION_SYNC=t.UPDATE_GC_METADATA_REFCOUNT_ACTION=t.updateGCMetadataRefCount=t.GC_REMOVE_METADATA=t.replaceEntityWithPlaceholder=t.gcRemoveMetadata=t.garbageCollectMetadata=void 0;var n=r("Kz3/"),a=r("pdzI"),i=r("Mx+d"),o=r("c7Ce");t.GARBAGE_COLLECT_METADATA_ACTION_SYNC="garbage.collect.metadata.sync";t.GC_REMOVE_METADATA="gc.metadata.remove";function s(e,t,r,n){var o=i.getEntityDescriptor(e,t);if(o){var s={Initialized:a.InitState.Uninitialized,EntityLogicalName:o.EntityLogicalName,IsActivity:o.IsActivity};r[t]=s,n[t]=null}}function u(e){return{type:"gc.metadata.remove",payload:e}}function l(e,t){return{type:"gc.metadata.update.refcount",payload:{entities:e,ribbons:t}}}t.UPDATE_GC_METADATA_REFCOUNT_ACTION="gc.metadata.update.refcount",t.garbageCollectMetadata=function(e){return{type:"garbage.collect.metadata.sync",sync:!0,execute:function(t,r){var a,i=t.dispatch,c=(0,t.getState)(),d={},p={},f={},y=o.getGCEntitiesMetadata(c);for(var m in y){var h=null===(a=y[m])||void 0===a?void 0:a.slice(),g=h&&n.removeReference(h,e);g&&(0===g.length?s(c,m,d,p):f[m]=g)}var E={};((Object.keys(E).length>0||Object.keys(f).length>0)&&i(l(f,E)),Object.keys(d).length>0)&&i(u({entities:d,attributes:p}))}}},t.replaceEntityWithPlaceholder=s,t.gcRemoveMetadata=u,t.updateGCMetadataRefCount=l},xiVN:function(e,t,r){"use strict";r.d(t,"c",(function(){return O})),r.d(t,"a",(function(){return S})),r.d(t,"h",(function(){return N})),r.d(t,"j",(function(){return R})),r.d(t,"e",(function(){return M})),r.d(t,"f",(function(){return A})),r.d(t,"g",(function(){return C})),r.d(t,"k",(function(){return P})),r.d(t,"i",(function(){return I})),r.d(t,"d",(function(){return w})),r.d(t,"b",(function(){return D}));var n,a=r("OhA8"),i=r("HPMC"),o=r("gmsG"),s=r("TvxW"),u=r("cvWF"),l=r("Sh+4");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
class c{constructor(e,t,r,n,i,o,s){this._privilegeType=0,this._canBeBasic=!1,this._canBeLocal=!1,this._canBeDeep=!1,this._canBeGlobal=!1,Object(a.u)(e,"name"),Object(a.u)(t,"privilegeId"),this._name=e,this._privilegeId=t,this._privilegeType=r,this._canBeBasic=n,this._canBeLocal=i,this._canBeDeep=o,this._canBeGlobal=s}static getPrivilegeTypeKey(e){return e.toString()}static createFromObjectData(e){const t=e.name,r=l.LegacyGuid.createFromObjectData(e.privilegeid),n=e.privilegetype,a=e.canbebasic,i=e.canbelocal,o=e.canbedeep,s=e.canbeglobal;return new c(t,r,n,a,i,o,s)}static createFromOData(e){const t=e.Name,r=l.LegacyGuid.tryCreate(e.PrivilegeId),n=e.PrivilegeType,a=e.CanBeBasic,i=e.CanBeLocal,o=e.CanBeDeep,s=e.CanBeGlobal;return new c(t,r,n,a,i,o,s)}get_privilegeId(){return this._privilegeId}get_privilegeType(){return this._privilegeType}get_privilegeTypeKey(){return c.getPrivilegeTypeKey(this.get_privilegeType())}get_canBeGlobal(){return this._canBeGlobal}getObjectData(){const e={};return e.name=this._name,e.privilegeid=this._privilegeId.getObjectData(),e.privilegetype=this._privilegeType,e.canbebasic=this._canBeBasic,e.canbelocal=this._canBeLocal,e.canbedeep=this._canBeDeep,e.canbeglobal=this.get_canBeGlobal(),e}getODataObject(){const e={};return e.Name=this._name,e.PrivilegeId=this._privilegeId.toString(),e.PrivilegeType=this._privilegeType,e.CanBeBasic=this._canBeBasic,e.CanBeLocal=this._canBeLocal,e.CanBeDeep=this._canBeDeep,e.CanBeGlobal=this.get_canBeGlobal(),e}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class d{constructor(e,t,r,n,i,o,s,u,c,d,p,f,y,m,h,g,E,b,_,v,T,O,S,N,R,M,A,C,P,I,w,D,F,L,k,x,j,U,V,q,$,G,B,H,Q,X,z,W,Y,K,J,Z){this._objectTypeCode=0,this._hasChanged=!1,this._isActivity=!1,this._isReadOnlyForMobileClient=!1,this._isVisibleInMobileClient=!1,this._isOfflineInMobileClient=!1,this._isOptimisticConcurrencyEnabled=!1,this._isChildEntity=!1,this._primaryKeyName="",this._autoRouteToOwnerQueue=!1,this._canTriggerWorkflow=!1,this._displayCollectionName="",this._description="",this._isValidForAdvancedFind=!1,this._isMailMergeEnabled=!1,this._isConnectionsEnabled=!1,this._isCustomizable=!1,this._isActivityParty=!1,this._isImportable=!1,this._isEnabledForCharts=!1,this._isCustomEntity=!1,this._isStateModelAware=!1,this._enforceStateTransitions=!1,this._activityTypeMask=0,this._ownershipType=0,this._isCollaboration=!1,this._hasSecuredAttributes=!1,this._hasStateCode=!1,this._isBusinessProcessEnabled=!1,this._isDocumentManagementEnabled=!1,this._isOneNoteIntegrationEnabled=!1,this._isMSTeamsIntegrationEnabled=!1,this._isIntersect=!1,this._hasActivities=!1,this._isInteractionCentricEnabled=!1,this._isQuickCreateEnabled=!1,this._entityClientSetting={AllowMainFormDialogForCreate:!1,AllowMainFormDialogForEdit:!1},this._isKnowledgeManagementEnabled=!1,this._isDocumentRecommendationsEnabled=!1,this._hasNotes=!1,this._usesBusinessDataLabelTable=!1,this._isBPFEntity=!1,this._oneToManyRelationships=[],this._manyToOneRelationships=[],this._manyToManyRelationships=[],this._dataProviderId=l.LegacyGuid.get_empty(),this._versionNumber=0,this._overallVersionNumber=0,Object(a.u)(e,"id"),Object(a.u)(t,"logicalName"),this._id=e,this._logicalName=t,this._displayName=r,this._entitySetName=n,this._objectTypeCode=i,this._primaryIdAttribute=o,this._primaryNameAttribute=s,this._primaryImageAttribute=u,this._isReadOnlyForMobileClient=d,this._isVisibleInMobileClient=p,this._isOfflineInMobileClient=f,this._isOptimisticConcurrencyEnabled=y,this._hasChanged=m,this._isActivity=h,this._isChildEntity=g,this._parentEntityLogicalName=E,this._parentEntityReferencingAttribute=b,this._isValidForAdvancedFind=_,this._isMailMergeEnabled=v,this._isConnectionsEnabled=T,this._isCustomizable=O,this._isActivityParty=S,this._isImportable=N,this._isEnabledForCharts=R,this._isCustomEntity=M,this._isStateModelAware=A,this._enforceStateTransitions=C,this._isCollaboration=P,this._activityTypeMask=I,this._ownershipType=w,this._hasSecuredAttributes=D,this._hasStateCode=F,this._isBusinessProcessEnabled=L,this._isDocumentManagementEnabled=k,this._isOneNoteIntegrationEnabled=x,this._isMSTeamsIntegrationEnabled=j,this._hasActivities=U,this._entityColor=V,this._isInteractionCentricEnabled=q,this._isQuickCreateEnabled=$,this._entityClientSetting=G,this._isKnowledgeManagementEnabled=B,this._isDocumentRecommendationsEnabled=H,this._isIntersect=Q,this._hasNotes=X,this._usesBusinessDataLabelTable=z,this._iconVectorName=W,this._isBPFEntity=Y,this._versionNumber=K,this._overallVersionNumber=J,this._attributeNames=Z,this._privilegesByType={};for(const e of c)this._privilegesByType[e.get_privilegeTypeKey()]=e}static extractKey(e){return l.LegacyGuid.createFromObjectData(e[d._idPath]).toString()}static createFromObjectData(e){if(!Object(a.o)(e.MetadataId)){e=d.createFromOData(e).getObjectData()}const t=l.LegacyGuid.createFromObjectData(e[d._idPath]),r=e[d.logicalNamePath],n=e.displayname,i=e.entitysetname,o=e.objecttypecode,s=e.primaryidattribute,u=e.primarynameattribute,p=e.primaryimageattribute,f=e.isreadonlyformobileclient,y=e.isvisibleinmobileclient,m=e.isofflineinmobileclient,h=e.isoptimisticconcurrencyenabled,g=e.haschanged,E=e.isactivity,b=e.ischildentity,_=e.parententitylogicalname,v=e.parententityreferencingattribute,T=e.isvalidforadvancedfind,O=e.ismailmergeenabled,S=e.isconnectionsenabled,N=e.iscustomizable,R=e.isactivityparty,M=e.isimportable,A=e.isenabledforcharts,C=e.iscustomentity,P=e.isstatemodelaware,I=e.enforcestatetransitions,w=e.iscollaboration,D=e.activitytypemask,F=e.ownershiptype,L=e.hassecuredattributes,k=e.hasstatecode,x=e.isbusinessprocessenabled,j=e.isdocumentmanagementenabled,U=e.isonenoteintegrationenabled,V=e.ismsteamsintegrationenabled,q=e.hasactivities,$=e.entitycolor,G=e.isinteractioncentricenabled,B=e.isQuickCreateEnabled,H=e.entityClientSetting,Q=e.isKnowledgeManagementEnabled,X=e.IsDocumentRecommendationsEnabled,z=e.isIntersect,W=e.hasnotes,Y=e.usesBusinessDataLabelTable,K=e.iconVectorName,J=e.isbpfentity,Z=Object(a.o)(e.dataProviderId)?l.LegacyGuid.get_empty():l.LegacyGuid.tryCreate(e.dataProviderId),ee=e.primaryKeyName,te=e.autoRouteToOwnerQueue,re=e.canTriggerWorkflow,ne=e.displayCollectionName,ae=e.description,ie=e.oneToManyRelationships,oe=e.manyToOneRelationships,se=e.manyToManyRelationships;let ue=-1,le=-1;e.VersionNumber&&(ue=e.VersionNumber),e.OverallVersionNumber&&(le=e.OverallVersionNumber);const ce=e.AttributeNames,de=e.privileges.map(e=>c.createFromObjectData(e)),pe=new d(t,r,n,i,o,s,u,p,de,f,y,m,h,g,E,b,_,v,T,O,S,N,R,M,A,C,P,I,w,D,F,L,k,x,j,U,V,q,$,G,B,H,Q,X,z,W,Y,K,J,ue,le,ce);return pe._primaryKeyName=ee,pe._autoRouteToOwnerQueue=te,pe._canTriggerWorkflow=re,pe._displayCollectionName=ne,pe._description=ae,pe._dataProviderId=Z,pe._oneToManyRelationships=ie,pe._manyToManyRelationships=se,pe._manyToOneRelationships=oe,pe}static getLabelString(e){return Object(a.m)(e.UserLocalizedLabel)?"":e.UserLocalizedLabel.Label}static convertToLabel(e){const t={UserLocalizedLabel:{}};return t.UserLocalizedLabel.Label=e,t}static createFromOData(e){const t=l.LegacyGuid.tryCreate(e.MetadataId),r=e.LogicalName,n=d.getLabelString(e.DisplayName),i=e.EntitySetName,o=e.ObjectTypeCode,s=e.PrimaryIdAttribute,u=e.IconVectorName,p=e.PrimaryKeyName,f=e.AutoRouteToOwnerQueue,y=e.CanTriggerWorkflow,m=e.PrimaryNameAttribute,h=e.PrimaryImageAttribute,g=e.IsReadOnlyInMobileClient,E=e.IsVisibleInMobileClient,b=e.IsOfflineInMobileClient,_=e.IsOptimisticConcurrencyEnabled,v=e.HasChanged,T=e.IsActivity,O=e.IsChildEntity,S=e.ParentEntityLogicalName,N=e.ParentEntityReferencingAttribute,R=e.IsValidForAdvancedFind,M=e.IsMailMergeEnabled,A=e.IsConnectionsEnabled,C=e.IsCustomizable,P=e.IsActivityParty,I=e.IsImportable,w=e.IsEnabledForCharts,D=e.IsCustomEntity,F=e.IsStateModelAware,L=e.EnforceStateTransitions,k=e.IsValidForQueue,x=e.ActivityTypeMask,j=e.OwnershipType,U=e.IsBusinessProcessEnabled,V=e.IsDocumentManagementEnabled,q=e.IsOneNoteIntegrationEnabled,$=e.IsMSTeamsIntegrationEnabled,G=e.EntityColor,B=e.IsInteractionCentricEnabled,H=e.IsQuickCreateEnabled,Q=e.entityClientSetting,X=e.IsKnowledgeManagementEnabled,z=e.IsDocumentManagementEnabled,W=e.IsBPFEntity,Y=e.OneToManyRelationships,K=e.ManyToOneRelationships,J=e.ManyToManyRelationships,Z=d.getLabelString(e.DisplayCollectionName),ee=d.getLabelString(e.Description),te=Object(a.o)(e.DataProviderId)?l.LegacyGuid.get_empty():l.LegacyGuid.tryCreate(e.DataProviderId);let re=-1,ne=-1;e.VersionNumber&&(re=e.VersionNumber),e.OverallVersionNumber&&(ne=e.OverallVersionNumber);let ae=!1;const ie=e.AttributeNames;for(let e=0;e<ie.length;e++)if("statecode"===ie[e]){ae=!0;break}const oe=e.IsIntersect,se=e.Privileges.map(e=>c.createFromOData(e)),ue=new d(t,r,n,i,o,s,m,h,se,g,E,b,_,v,T,O,S,N,R,M,A,C,P,I,w,D,F,L,k,x,j,!1,ae,U,V,q,$,!1,G,B,H,Q,X,z,oe,!1,!1,u,W,re,ne,ie);return ue._primaryKeyName=p,ue._autoRouteToOwnerQueue=f,ue._canTriggerWorkflow=y,ue._displayCollectionName=Z,ue._description=ee,ue._dataProviderId=te,ue._oneToManyRelationships=Y,ue._manyToOneRelationships=K,ue._manyToManyRelationships=J,ue}get_attributeNames(){return this._attributeNames}get_id(){return this._id}get_logicalName(){return this._logicalName}get_displayName(){return this._displayName}set_entitySetName(e){return this._entitySetName=e,e}get_objectTypeCode(){return this._objectTypeCode}get_primaryIdAttribute(){return this._primaryIdAttribute}get_primaryNameAttribute(){return this._primaryNameAttribute}get_isOptimisticConcurrencyEnabled(){return this._isOptimisticConcurrencyEnabled}get_isActivity(){switch(this._logicalName){case"phonecall":case"email":case"task":case"appointment":case"activitypointer":return!0;default:return this._isActivity}}get_isChildEntity(){return this._isChildEntity}get_parentEntityLogicalName(){return this._parentEntityLogicalName}get_parentEntityReferencingAttribute(){return this._parentEntityReferencingAttribute}get_isCustomEntity(){return this._isCustomEntity}get_activityTypeMask(){return this._activityTypeMask}get_ownershipType(){return this._ownershipType}get_hasSecuredAttributes(){return this._hasSecuredAttributes}get_hasStateCode(){return this._hasStateCode}get_isBusinessProcessEnabled(){return this._isBusinessProcessEnabled}get_isIntersect(){return this._isIntersect}get_usesBusinessDataLabelTable(){return this._usesBusinessDataLabelTable}get_isBPFEntity(){return this._isBPFEntity}getEntityCanBeUsedInBusinessProcess(){return this._isBusinessProcessEnabled||this._isBPFEntity}getODataObject(){const e={},t=this._id.toString();e.Id=t,e.MetadataId=t,e.LogicalName=this._logicalName,e.DisplayName=d.convertToLabel(this._displayName),e.EntitySetName=this._entitySetName,e.ObjectTypeCode=this._objectTypeCode,e.PrimaryKeyName=this._primaryKeyName,e.AutoRouteToOwnerQueue=this._autoRouteToOwnerQueue,e.CanTriggerWorkflow=this._canTriggerWorkflow,e.Description=d.convertToLabel(this._description),e.DisplayCollectionName=d.convertToLabel(this._displayCollectionName),e.PrimaryIdAttribute=this._primaryIdAttribute,e.PrimaryNameAttribute=this._primaryNameAttribute,e.PrimaryImageAttribute=this._primaryImageAttribute,e.IsReadOnlyInMobileClient=this._isReadOnlyForMobileClient,e.IsVisibleInMobileClient=this._isVisibleInMobileClient,e.IsOfflineInMobileClient=this._isOfflineInMobileClient,e.IsOptimisticConcurrencyEnabled=this._isOptimisticConcurrencyEnabled,e.HasChanged=this._hasChanged,e.IsActivity=this._isActivity,e.IsChildEntity=this._isChildEntity,e.ParentEntityLogicalName=this._parentEntityLogicalName,e.ParentEntityReferencingAttribute=this._parentEntityReferencingAttribute,e.IsValidForAdvancedFind=this._isValidForAdvancedFind,e.IsMailMergeEnabled=this._isMailMergeEnabled,e.IsConnectionsEnabled=this._isConnectionsEnabled,e.IsCustomizable=this._isCustomizable,e.IsActivityParty=this._isActivityParty,e.IsImportable=this._isImportable,e.IsEnabledForCharts=this._isEnabledForCharts,e.IsCustomEntity=this._isCustomEntity,e.IsStateModelAware=this._isStateModelAware,e.EnforceStateTransitions=this._enforceStateTransitions,e.IsValidForQueue=this._isCollaboration,e.ActivityTypeMask=this._activityTypeMask,e.OwnershipType=this._ownershipType,e.HasStateCode=this._hasStateCode,e.IsBusinessProcessEnabled=this._isBusinessProcessEnabled,e.IsDocumentManagementEnabled=this._isDocumentManagementEnabled,e.EntityColor=this._entityColor,e.IsInteractionCentricEnabled=this._isInteractionCentricEnabled,e.isQuickCreateEnabled=this._isQuickCreateEnabled,e.entityClientSetting=this._entityClientSetting,e.IsKnowledgeManagementEnabled=this._isKnowledgeManagementEnabled,e.OneToManyRelationships=this._oneToManyRelationships,e.ManyToOneRelationships=this._manyToOneRelationships,e.ManyToManyRelationships=this._manyToManyRelationships,e.IconVectorName=this._iconVectorName,e.IsBPFEntity=this._isBPFEntity,e.DataProviderId=this._dataProviderId?this._dataProviderId.toString():"",e.IsDocumentRecommendationsEnabled=this._isDocumentRecommendationsEnabled,e.IsIntersect=this._isIntersect,e.IsMSTeamsIntegrationEnabled=this._isMSTeamsIntegrationEnabled,e.VersionNumber=this._versionNumber,e.OverallVersionNumber=this._overallVersionNumber,e.AttributeNames=this._attributeNames,e.Privileges=[];for(const t in this._privilegesByType)this._privilegesByType.hasOwnProperty(t)&&e.Privileges.push(this._privilegesByType[t].getODataObject());return e}getObjectData(){const e={};e[d._idPath]=this._id.getObjectData(),e[d.logicalNamePath]=this._logicalName,e.displayname=this._displayName,e.entitysetname=this._entitySetName,e.objecttypecode=this._objectTypeCode,e.primaryidattribute=this._primaryIdAttribute,e.primarykeyname=this._primaryKeyName,e.displayCollectionName=this._displayCollectionName,e.autoRouteToOwnerQueue=this._autoRouteToOwnerQueue,e.canTriggerWorkflow=this._canTriggerWorkflow,e.primarynameattribute=this._primaryNameAttribute,e.primaryimageattribute=this._primaryImageAttribute,e.description=this._description,e.oneToManyRelationships=this._oneToManyRelationships,e.manyToOneRelationships=this._manyToOneRelationships,e.manyToManyRelationships=this._manyToManyRelationships,e.isreadonlyformobileclient=this._isReadOnlyForMobileClient,e.isvisibleinmobileclient=this._isVisibleInMobileClient,e.isofflineinmobileclient=this._isOfflineInMobileClient,e.isoptimisticconcurrencyenabled=this._isOptimisticConcurrencyEnabled,e.haschanged=this._hasChanged,e.isactivity=this._isActivity,e.ischildentity=this._isChildEntity,e.parententitylogicalname=this._parentEntityLogicalName,e.parententityreferencingattribute=this._parentEntityReferencingAttribute,e.isvalidforadvancedfind=this._isValidForAdvancedFind,e.ismailmergeenabled=this._isMailMergeEnabled,e.isconnectionsenabled=this._isConnectionsEnabled,e.iscustomizable=this._isCustomizable,e.isactivityparty=this._isActivityParty,e.isimportable=this._isImportable,e.isenabledforcharts=this._isEnabledForCharts,e.iscustomentity=this._isCustomEntity,e.isstatemodelaware=this._isStateModelAware,e.enforcestatetransitions=this._enforceStateTransitions,e.iscollaboration=this._isCollaboration,e.activitytypemask=this._activityTypeMask,e.ownershiptype=this._ownershipType,e.hassecuredattributes=this._hasSecuredAttributes,e.hasstatecode=this._hasStateCode,e.isbusinessprocessenabled=this._isBusinessProcessEnabled,e.isdocumentmanagementenabled=this._isDocumentManagementEnabled,e.isonenoteintegrationenabled=this._isOneNoteIntegrationEnabled,e.ismsteamsintegrationenabled=this._isMSTeamsIntegrationEnabled,e.hasactivities=this._hasActivities,e.entitycolor=this._entityColor,e.isinteractioncentricenabled=this._isInteractionCentricEnabled,e.isQuickCreateEnabled=this._isQuickCreateEnabled,e.entityClientSetting=this._entityClientSetting,e.isKnowledgeManagementEnabled=this._isKnowledgeManagementEnabled,e.isDocumentRecommendationsEnabled=this._isDocumentRecommendationsEnabled,e.isIntersect=this._isIntersect,e.hasnotes=this._hasNotes,e.iconVectorName=this._iconVectorName,e.usesBusinessDataLabelTable=this._usesBusinessDataLabelTable,e.isbpfentity=this._isBPFEntity,e.dataProviderId=this._dataProviderId?this._dataProviderId.toString():"",e.VersionNumber=this._versionNumber,e.OverallVersionNumber=this._overallVersionNumber,e.AttributeNames=this._attributeNames;const t=[],r=this._privilegesByType;for(const e in r)if(r.hasOwnProperty(e)){const n={key:e,value:r[e]};t.push(n.value.getObjectData())}return e.privileges=t,e}}function p(e){switch(e){case n.Boolean:return u.AttributeType.Boolean;case n.Customer:return u.AttributeType.Customer;case n.DateTime:return u.AttributeType.DateTime;case n.Decimal:return u.AttributeType.Decimal;case n.Double:return u.AttributeType.Double;case n.Integer:return u.AttributeType.Integer;case n.Lookup:return u.AttributeType.Lookup;case n.Memo:return u.AttributeType.Memo;case n.Money:return u.AttributeType.Money;case n.Owner:return u.AttributeType.Owner;case n.PartyList:return u.AttributeType.PartyList;case n.Picklist:return u.AttributeType.PickList;case n.State:return u.AttributeType.State;case n.Status:return u.AttributeType.Status;case n.String:return u.AttributeType.String;case n.UniqueIdentifier:return u.AttributeType.UniqueIdentifier;case n.CalendarRules:return u.AttributeType.CalendarRules;case n.Virtual:return u.AttributeType.Virtual;case n.BigInt:return u.AttributeType.BigInt;case n.ManagedProperty:return u.AttributeType.ManagedProperty;case n.EntityName:return u.AttributeType.EntityName;case n.AliasedValue:return u.AttributeType.AliasedValue;case n.EntityImage:return u.AttributeType.EntityImage;case n.MultiSelectPicklist:return u.AttributeType.MultiSelectPickList;case n.File:return u.AttributeType.File;case n.NavigationProperty:return u.AttributeType.NavigationProperty;default:return u.AttributeType.Unknown}}function f(e){switch(e){case u.AttributeType.Boolean:return n.Boolean;case u.AttributeType.Customer:return n.Customer;case u.AttributeType.DateTime:return n.DateTime;case u.AttributeType.Decimal:return n.Decimal;case u.AttributeType.Double:return n.Double;case u.AttributeType.Integer:return n.Integer;case u.AttributeType.Lookup:return n.Lookup;case u.AttributeType.Memo:return n.Memo;case u.AttributeType.Money:return n.Money;case u.AttributeType.Owner:return n.Owner;case u.AttributeType.PartyList:return n.PartyList;case u.AttributeType.PickList:return n.Picklist;case u.AttributeType.State:return n.State;case u.AttributeType.Status:return n.Status;case u.AttributeType.String:return n.String;case u.AttributeType.UniqueIdentifier:return n.UniqueIdentifier;case u.AttributeType.CalendarRules:return n.CalendarRules;case u.AttributeType.Virtual:return n.Virtual;case u.AttributeType.BigInt:return n.BigInt;case u.AttributeType.ManagedProperty:return n.ManagedProperty;case u.AttributeType.EntityName:return n.EntityName;case u.AttributeType.AliasedValue:return n.AliasedValue;case u.AttributeType.EntityImage:return n.EntityImage;case u.AttributeType.MultiSelectPickList:return n.MultiSelectPicklist;case u.AttributeType.File:return n.File;case u.AttributeType.NavigationProperty:return n.NavigationProperty;default:return n.Unknown}}d.logicalNamePath="logicalname",d._idPath="id",function(e){e[e.Unknown=-1]="Unknown",e[e.Boolean=0]="Boolean",e[e.Customer=1]="Customer",e[e.DateTime=2]="DateTime",e[e.Decimal=3]="Decimal",e[e.Double=4]="Double",e[e.Integer=5]="Integer",e[e.Lookup=6]="Lookup",e[e.Memo=7]="Memo",e[e.Money=8]="Money",e[e.Owner=9]="Owner",e[e.PartyList=10]="PartyList",e[e.Picklist=11]="Picklist",e[e.State=12]="State",e[e.Status=13]="Status",e[e.String=14]="String",e[e.UniqueIdentifier=15]="UniqueIdentifier",e[e.CalendarRules=16]="CalendarRules",e[e.Virtual=17]="Virtual",e[e.BigInt=18]="BigInt",e[e.ManagedProperty=19]="ManagedProperty",e[e.EntityName=20]="EntityName",e[e.AliasedValue=21]="AliasedValue",e[e.EntityImage=23]="EntityImage",e[e.MultiSelectPicklist=24]="MultiSelectPicklist",e[e.File=25]="File",e[e.NavigationProperty=26]="NavigationProperty"}(n||(n={}));var y=r("RXHd");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class m{constructor(e){this._optionsInDisplayOrder=e,this._options=m._CreateDictionaryFromOptionsInDisplayOrder(e)}static createFromObjectData(e){const t=e&&e.optionsindisplayorder?e.optionsindisplayorder:{};return new m(Object(a.s)(t,e=>y.OptionMetadata.createFromObjectData(e)))}static createFromOData(e){const t={};for(let r=0;r<e.length;++r){const n=y.OptionMetadata.createFromOData(e[r]);t[r.toString()]=n}return new m(t)}static _CreateDictionaryFromOptionsInDisplayOrder(e){const t={};for(const r in e)if(e.hasOwnProperty(r)){const n={key:r,value:e[r]}.value;t[n.get_ValueString()]=n}return t}get_options(){return this._options}get_optionsInDisplayOrder(){return this._optionsInDisplayOrder}getObjectData(){return Object(a.m)(this._optionsInDisplayOrder)?{}:{optionsindisplayorder:Object(a.s)(this._optionsInDisplayOrder,e=>e.getObjectData())}}getODataObject(){if(Object(a.m)(this.get_optionsInDisplayOrder()))return{};const e={},t=[],r=this.get_optionsInDisplayOrder();for(const e in r)if(r.hasOwnProperty(e)){const n={key:e,value:r[e]};t.push(n.value.getODataObject())}return e.Options=t,e}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class h{constructor(e,t,r,n,i,o,s,l,c,d,p,f,y,m,h,g,E,b,_,v,T,O,S,N,R,M,A,C,P,I,w){this._type=u.AttributeType.Boolean,this._sourceType=0,this._formatName="",this._attributeTypeName="",this._description="",this._columnNumber=0,this._sourceTypeMask=0,this._isSecured=!1,this._isValidForCreate=!1,this._isValidForRead=!1,this._isValidForUpdate=!1,this._requiredLevel=0,this._maxLength=0,this._minValue=0,this._maxValue=0,this._precision=0,this._precisionSource=0,this._behavior=0,this._defaultFormValue=0,this._defaultValue=!1,this._isBaseCurrency=!1,this._hasChanged=!1,this._isSortableEnabled=!1,this._imeMode=0,this._isLocalizable=!1,this._isCustomAttribute=!1,Object(a.u)(e,"logicalName"),Object(a.u)(t,"id"),Object(a.u)(n,"type"),Object(a.u)(d,"requiredLevel"),Object(a.u)(o,"isSecured"),Object(a.u)(s,"isValidForCreate"),Object(a.u)(l,"isValidForRead"),Object(a.u)(c,"isValidForUpdate"),this._logicalName=e,this._id=t,this._entityLogicalName=r,this._type=n,this._sourceType=C||0,this._displayName=i,this._isSecured=o,this._isValidForCreate=s,this._isValidForRead=l,this._isValidForUpdate=c,this._requiredLevel=d,this._maxLength=p,this._minValue=f,this._maxValue=y,this._precision=m,this._precisionSource=h,this._format=g,this._behavior=E,this._defaultFormValue=b,this._defaultValue=_,this._optionSet=v,this._targets=O,this._isBaseCurrency=T,this._attributeOf=S,this._hasChanged=N,this._isSortableEnabled=M||!1,this._imeMode=R||0,this._inheritsFrom=A||"",this._isLocalizable=P||!1,this._isCustomAttribute=I||!1,this._columnNumber=w||0}static extractKey(e){return l.LegacyGuid.createFromObjectData(e.id).toString()}static addValueWrapper(e){const t={};return t.Value=e,t}static removeValueWrapper(e){return e?e.Value:null}static createFromObjectData(e){if(!Object(a.o)(e.MetadataId)){e=h.createFromODataResponse(e).getObjectData()}const t=new h(e.logicalname,l.LegacyGuid.createFromObjectData(e.id),e.entitylogicalname,p(e.type),e.displayname,e.issecured,e.isvalidforcreate,e.isvalidforread,e.isvalidforupdate,e.requiredlevel,e.maxlength,e.minvalue,e.maxvalue,e.precision,e.precisionsource,e.format,e.behavior,e.defaultformvalue,e.defaultvalue,m.createFromObjectData(e.optionset),e.isbasecurrency,e.targets,e.attributeof,e.haschanged,e.imemode,e.issortableenabled,e.inheritsfrom,e.sourcetype,e.islocalizable,e.IsCustomAttribute,e.columnNumber);return t._formatName=e.formatName,t._description=e.description,t._sourceTypeMask=e.sourceTypeMask,t._attributeTypeName=e.attributeTypeName,t}static createFromODataResponse(e){const t=e.LogicalName,r=l.LegacyGuid.tryCreate(e.MetadataId),n=e.EntityLogicalName,i=p(e.AttributeType);let o=h.removeValueWrapper(e.AttributeTypeName);const s=new RegExp("Type","g");if(Object(a.o)(o))throw new Error(`Null or empty attribute type name in attribute metadata for entity ${n} attribute type ${i}`);o=o.replace(s,"").toLowerCase(),"float"===o&&(o="double");const u=e.SourceType,c=d.getLabelString(e.Description),f=d.getLabelString(e.DisplayName),y=h.removeValueWrapper(e.RequiredLevel);let g;g="string"==typeof y?Object(a.r)(y):y;const E=e.IsSecured,b=e.IsValidForCreate,_=e.IsValidForUpdate,v=e.IsValidForRead,T=e.ColumnNumber,O=e.SourceTypeMask,S=e.MaxLength,N=e.MinValue,R=e.MaxValue,M=e.Precision,A=e.PrecisionSource,C=e.Format;let P=null;Object(a.m)(C)||(P=C.toString());const I=h.removeValueWrapper(e.FormatName),w=h.removeValueWrapper(e.DateTimeBehavior);let D=0;Object(a.m)(w)||(D=Object(a.q)(w));const F=e.DefaultFormValue,L=e.DefaultValue,k=e.IsBaseCurrency,x=e.AttributeOf,j=e.HasChanged,U=h.removeValueWrapper(e.IsSortableEnabled),V=e.ImeMode,q=e.InheritsFrom,$=e.IsLocalizable,G=e.IsCustomAttribute;let B=null;const H=e.OptionSet;if(!Object(a.m)(H)){const e=H.Options;if(Object(a.m)(e)){const e=H.TrueOption,t=[H.FalseOption,e];B=m.createFromOData(t)}else B=m.createFromOData(e)}const Q=e.Targets,X=new h(t,r,n,i,f,E,b,v,_,g,S,N,R,M,A,P,D,F,L,B,k,Q,x,j,V,U,q,u,$,G,T);return X._formatName=I,X._description=c,X._sourceTypeMask=O,X._attributeTypeName=o,X}get_id(){return this._id}get_logicalName(){return this._logicalName}get_entityLogicalName(){return this._entityLogicalName}get_type(){return this._type}get_sourceType(){return this._sourceType}get_displayName(){return this._displayName}get_isValidForCreate(){return this._isValidForCreate}get_isSecured(){return this._isSecured}get_isValidForUpdate(){return this._isValidForUpdate}get_isValidForRead(){return this._isValidForRead}get_requiredLevel(){return this._requiredLevel}get_maxLength(){return this._maxLength}get_minValue(){return this._minValue}get_maxValue(){return this._maxValue}get_precision(){return this._precision}get_precisionSource(){return this._precisionSource}get_format(){return this._format}get_formatName(){return this._formatName}get_behavior(){return this._behavior}get_isBaseCurrency(){return this._isBaseCurrency}get_defaultFormValue(){return this._defaultFormValue}get_defaultValue(){return this._defaultValue}get_optionSet(){return this._optionSet}get_targets(){return this._targets}get_attributeOf(){return this._attributeOf}get_hasChanged(){return this._hasChanged}get_isSortableEnabled(){return this._isSortableEnabled}get_imeMode(){return this._imeMode}get_inheritsFrom(){return this._inheritsFrom}get_isLocalizable(){return this._isLocalizable}get_isCustomAttribute(){return this._isCustomAttribute}get_columnNumber(){return this._columnNumber}getObjectData(){return{[h.logicalNamePath]:this._logicalName,id:this._id.getObjectData(),[h.entityLogicalNamePath]:this._entityLogicalName,[h.entityAttributeLogicalNamesPath]:this._entityLogicalName+a.a+this._logicalName,type:f(this._type),sourcetype:this._sourceType,displayname:this._displayName,issecured:this._isSecured,issortableenabled:this._isSortableEnabled,isvalidforcreate:this._isValidForCreate,isvalidforupdate:this._isValidForUpdate,isvalidforread:this._isValidForRead,requiredlevel:this._requiredLevel,maxlength:this._maxLength,minvalue:this._minValue,maxvalue:this._maxValue,precision:this._precision,precisionsource:this._precisionSource,defaultformvalue:this._defaultFormValue,defaultvalue:this._defaultValue,format:this._format,behavior:this._behavior,isbasecurrency:this._isBaseCurrency,attributeof:this._attributeOf,haschanged:this._hasChanged,imemode:this._imeMode,inheritsfrom:this._inheritsFrom,islocalizable:this._isLocalizable,formatName:this._formatName,description:this._description,columnNumber:this._columnNumber,sourceTypeMask:this._sourceTypeMask,attributeTypeName:this._attributeTypeName,IsCustomAttribute:this._isCustomAttribute,optionset:Object(a.m)(this._optionSet)?void 0:this._optionSet.getObjectData(),targets:Object(a.m)(this._targets)?void 0:this._targets}}getODataObject(){return{LogicalName:this._logicalName,MetadataId:this._id.toString(),EntityLogicalName:this._entityLogicalName,EntityAttributeLogicalNames:this._entityLogicalName+a.a+this._logicalName,AttributeType:f(this._type),AttributeTypeName:h.addValueWrapper(("double"===this._attributeTypeName?"Float":this._attributeTypeName)+"Type"),Description:d.convertToLabel(this._description),ColumnNumber:this._columnNumber,FormatName:h.addValueWrapper(this._formatName),SourceTypeMask:this._sourceTypeMask,OptionSet:!Object(a.m)(this._optionSet)&&this._optionSet.getODataObject(),SourceType:this._sourceType,DisplayName:d.convertToLabel(this._displayName),IsSecured:this._isSecured,IsSortableEnabled:h.addValueWrapper(this._isSortableEnabled),IsValidForCreate:this._isValidForCreate,IsValidForUpdate:this._isValidForUpdate,IsValidForRead:this._isValidForRead,RequiredLevel:h.addValueWrapper(this._requiredLevel),MaxLength:this._maxLength,MinValue:this._minValue,MaxValue:this._maxValue,Precision:this._precision,PrecisionSource:this._precisionSource,DefaultFormValue:this._defaultFormValue,DefaultValue:this._defaultValue,Format:!Object(a.m)(this._format)&&parseInt(this._format,10),DateTimeBehavior:h.addValueWrapper(Object(a.b)(this._behavior)),IsBaseCurrency:this._isBaseCurrency,AttributeOf:this._attributeOf,HasChanged:this._hasChanged,ImeMode:this._imeMode,InheritsFrom:this._inheritsFrom,IsLocalizable:this._isLocalizable,IsCustomAttribute:this._isCustomAttribute,Targets:!Object(a.m)(this._targets)&&this._targets}}}h.entityLogicalNamePath="entitylogicalname",h.logicalNamePath="logicalname",h.entityAttributeLogicalNamesPath="entitylogicalname_logicalname";var g=r("+QHC"),E=r("f03v"),b=r("0fKB"),_=r("FDNG");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
const v={views:{},entities:{},attributes:{},userContext:{}};function T(e,t,r=[]){if(!Object(a.m)(e))for(const r in e)if(r){const n=e[r];if(n&&n.EntitySetName===t)return n.EntityLogicalName}return null}async function O(e,t,r=[]){const n=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache);let s=v.entities,u=T(s,t,r);if(Object(a.m)(u)){if(await async function(e,t=[]){const r=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache),n=await async function(e,t=[]){const r=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache),n="select logicalname from entitymetadata",a=[],i=await Object(b.b)(e,n,a);if(!i||!i.length){const e="requested  metadata not found for entity";throw r.error(`${ne()} ${e}`,t),new Error(e)}return i[0].rows}(e,t);let s=0;const u={sqlStatements:[],sqlParameters:new Array,additionalParameters:{}},l="SELECT id, json FROM [entitymetadata] WHERE [logicalname] = ?";if(!Object(a.m)(n)&&n.length>0){for(s=0;s<n.length;s++){const e=[n.item(s).logicalname];u.sqlStatements.push(l),u.sqlParameters.push(e)}const a=await Object(b.a)(e,u);if(!a||!a.length){const e="requested entity metadata not found";throw r.error(`${ne()} ${e}`,t),new Error(e)}for(s=0;s<a.length;s++){const e=a[s].rows.item(0),t=JSON.parse(e.json),r=d.createFromObjectData(t).getODataObject();q(r,r.LogicalName)}return v.entities}{const e="No entities returned from entity metadata db when populating all entity metadata";return r.error(`${ne()} ${e}`,t),Promise.reject(new i.a(e))}}(e,r),s=v.entities,u=T(s,t,r),Object(a.m)(u)){const e=`Entity ${t} not found in offline metadata`;return n.error(`${ne()} ${e}`,r),Promise.reject(new i.a(e))}return u}return u}async function S(e,t,r,n=[]){const i=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache),s={},u=await D(e,r,t,n);if(Object(a.m)(u))i.warn(ne()+" Retrieved null or undefined attribute metadata",n);else if(u&&Object.keys(u).length>0)if(t.length>0){for(const e of t)if(u[e]){const t=u[e];s[e]=t.Type}}else{const e=Object.keys(u);for(const t of e)if(u[t]){const e=u[t];s[t]=e.Type}}return s}async function N(e,t=[]){const r=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache);try{return v.userContext&&v.userContext.userSettings&&v.userContext.userSettings.timezoneutcoffsetminutes&&v.userContext.userSettings.languageid&&!Object(a.n)(v.userContext.userSettings.datetimeformatinfo)&&!Object(a.n)(v.userContext.userSettings.timezoneadjusters)?v.userContext.userSettings:async function(e,t=[]){const r=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache);if(await re(e,t),Object(a.m)(v.userContext.userSettings)||Object(a.m)(v.userContext.userSettings.timezoneutcoffsetminutes)||Object(a.n)(v.userContext.userSettings.datetimeformatinfo)||Object(a.n)(v.userContext.userSettings.timezoneadjusters)||Object(a.m)(v.userContext.userSettings.languageid)){const e="UserSettings is empty or does not contains all required dependencies";return r.error(`${ne()} ${e}`,t),Promise.reject(new i.a(e))}return v.userContext.userSettings}(e,t)}catch(e){return r.error(`${ne()} ${e.message}`,t),Promise.reject(e)}}async function R(e,t=[]){const r=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache);try{return v.userContext&&v.userContext.organizationSettings&&v.userContext.organizationSettings.fullnameconventioncode?v.userContext.organizationSettings.fullnameconventioncode:async function(e,t=[]){const r=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache);if(await re(e,t),Object(a.m)(v.userContext.organizationSettings)||Object(a.m)(v.userContext.organizationSettings.fullnameconventioncode)){const e="fullnameconventioncode is empty";return r.error(`${ne()} ${e}`,t),Promise.reject(new i.a(e))}return v.userContext.organizationSettings.fullnameconventioncode}(e,t)}catch(e){return r.error(`${ne()} ${e.message}`,t),Promise.reject(e)}}async function M(e,t=[]){const r=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache);try{return v.userContext&&v.userContext.organizationSettings&&v.userContext.organizationSettings.languageCode?v.userContext.organizationSettings.languageCode:async function(e,t=[]){const r=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache);if(await re(e,t),Object(a.m)(v.userContext.organizationSettings)||Object(a.m)(v.userContext.organizationSettings.languageCode)){const e="languageCode is empty";return r.warn(`${ne()} ${e}`,t),Promise.reject(new i.a(e))}return v.userContext.organizationSettings.languageCode}(e,t)}catch(e){return r.error(`${ne()} ${e.message}`,t),Promise.reject(e)}}async function A(e,t=[]){const r=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache);try{return v.userContext&&v.userContext.userid?_.Guid.toString(v.userContext.userid):async function(e,t=[]){const r=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache);if(await re(e,t),Object(a.m)(v.userContext.userid)){const e="userid is empty";return r.error(`${ne()} ${e}`,t),Promise.reject(new i.a(e))}return _.Guid.toString(v.userContext.userid)}(e,t)}catch(e){return r.error(`${ne()} ${e.message}`,t),Promise.reject(e)}}async function C(e,t=[]){const r=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache);try{return v.userContext&&v.userContext.username?v.userContext.username:async function(e,t=[]){const r=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache);if(await re(e,t),Object(a.m)(v.userContext.username)){const e="username is empty";return r.error(`${ne()} ${e}`,t),Promise.reject(new i.a(e))}return v.userContext.username}(e,t)}catch(e){return r.error(`${ne()} ${e.message}`,t),Promise.reject(e)}}async function P(e,t,r=[]){const n=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache);let i;return i=v.userContext&&v.userContext.fcbContext&&v.userContext.fcbContext[t]?v.userContext.fcbContext[t].value:await async function(e,t,r=[]){const n=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache);return await re(e,r),Object(a.m)(v.userContext.fcbContext)||Object(a.m)(v.userContext.fcbContext[t])?(n.error(`${ne()} The fcbContext for ${t} is empty, return False value.`,r),!1):v.userContext.fcbContext[t].value}(e,t,r),n.info(`${ne()} The fcbContext for ${t} return ${i} value.`),i}async function I(e,t,r=[]){const n=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache);try{return v.views&&v.views[t]?v.views[t]:async function(e,t,r=[]){const n=await async function(e,t,r=[]){const n=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache),i=await async function(e,t){const r="select * from applicationmetadata where id = ?",n=[Object(a.k)(t)];return await Object(b.b)(e,r,n)}(e,t);if(!i||!i.length){const e="requested view metadata not found, ViewId = "+t;throw n.error(`${ne()} ${e}`,r),new Error(e)}const s=i[0].rows.item(0),u=JSON.parse(s.json);return u.data}(e,t,r),i={viewId:new _.Guid(n.ViewId),fetchXML:n.FetchXml,entityLogicalName:n.EntityLogicalName,queryApi:n.QueryApi,columnXML:n.ColumnXml,title:n.Title,idColumName:n.IdColumnName,queryType:n.QueryType,layoutXML:n.LayoutXml,offlineSqlQuery:n.OfflineSqlQuery?n.OfflineSqlQuery:null,versionNumber:n.VersionNumber,OverallVersionNumber:n.OverallVersionNumber,OverallUserVersionNumber:n.OverallUserVersionNumber,isUserView:n.IsUserView};return v.views=Object.assign({},v.views,{[t]:i}),i}(e,t,r)}catch(e){return n.error(`${ne()} ${e.message}`,r),Promise.reject(e)}}async function w(e,t,r=[]){r.push({name:"entity",value:t});const n=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache);try{if(v.entities&&v.entities[t])return v.entities[t];if(await async function(e,t,r=[]){const n=await async function(e,t,r=[]){const n=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache),a=await async function(e,t){const r="SELECT id, json FROM [entitymetadata] WHERE [logicalname] = ?",n=[t];return await Object(b.b)(e,r,n)}(e,t);if(!a||!a.length){const e="requested entity metadata not found for entity = "+t;throw n.error(`${ne()} ${e}`,r),new Error(e)}let i;if(a[0].rows&&a[0].rows.length>0){const e=a[0].rows.item(0),t=JSON.parse(e.json);i=d.createFromObjectData(t).getODataObject()}return i}(e,t,r);let a;n&&(a=await q(n,t));return a}(e,t,r),!v.entities||!v.entities[t]){const e="Entity metadata is not available";return n.error(`${ne()} ${e}`,r),Promise.reject(new i.a(e))}return v.entities[t]}catch(e){return n.error(`${ne()} ${e.message}`,r),Promise.reject(e)}}async function D(e,t,r,n=[]){const a=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache);try{return async function(e,t,r){let n=[...r];const a=(await w(e,t)).AttributeNames;r&&r.length||(n=a);a.indexOf("statecode")>=0&&n.indexOf("statecode")<0&&n.push("statecode");a.indexOf("statuscode")>=0&&n.indexOf("statuscode")<0&&n.push("statuscode");const i=v.attributes&&v.attributes[t]?v.attributes[t]:{},o=[];for(let e=0;e<n.length;e++)i[n[e]]||o.push(n[e]);return o}(e,t,r).then(a=>async function(e,t,r,n=[]){const a={};if(r.length){const i=await async function(e,t,r,n=[]){const a=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache),i=await async function(e,t,r){let n="select * from attributemetadata where entitylogicalname = ? and logicalname in (";for(let e=0;e<r.length-1;e++)n+="?,";n+="?)";const a=[t,...r];return await Object(b.b)(e,n,a)}(e,t,r);if(!i||!i.length){const e=`requested attributes metadata not found for entity = ${t}, attributes = ${r.join()}`;throw a.error(`${ne()} ${e}`,n),new Error(e)}if(i.length>1){const e="Results[] returned from getAttributesSqlResults() has length = "+i.length;a.error(`${ne()} ${e}`,n)}const s={},u=i[0];for(let e=0;e<u.rows.length;e++){const i=u.rows.item(e),o=JSON.parse(i.json);try{const e=h.createFromObjectData(o);s[e.get_logicalName()]=e.getODataObject()}catch(i){const o=`Error when fetching attribute '${r[e]}' metadata for ${t} ${i.message}`;throw a.error(`${ne()} ${o}`,n),i}}return s}(e,t,r,n);if(i&&Object.keys(i).length>0)for(const e in i)if(i.hasOwnProperty(e)){const t=F(i[e]);a[e]=t}}return a}(e,t,a,n).then(e=>{if(v.attributes[t]=Object.assign({},v.attributes[t],e),r&&r.length){const e={};return r.forEach(r=>{e[r]=v.attributes[t][r]}),e}return v.attributes[t]}))}catch(e){return a.error(`${ne()} Error when fetching attribute metadata for ${t} ${e.message}`,n),Promise.reject(e)}}function F(e){const t=e;let r=E.DateTimeFieldBehavior.None;if(t.DateTimeBehavior)for(const e in t.DateTimeBehavior)if(t.DateTimeBehavior.hasOwnProperty(e))switch(t.DateTimeBehavior[e]){case"None":r=E.DateTimeFieldBehavior.None;break;case"DateOnly":r=E.DateTimeFieldBehavior.DateOnly;break;case"TimeZoneIndependent":r=E.DateTimeFieldBehavior.TimeZoneIndependent;break;case"UserLocal":r=E.DateTimeFieldBehavior.UserLocal;break;default:r=E.DateTimeFieldBehavior.None}return{LogicalName:e.LogicalName,Id:_.Guid.tryParseOrNull(e.MetadataId),EntityLogicalName:t.EntityLogicalName,Type:U(e),DisplayName:ee(t.DisplayName),Description:ee(t.Description),IsGlobalFilterEnabled:!!t.IsGlobalFilterEnabled&&t.IsGlobalFilterEnabled.Value,IsSecured:t.IsSecured,IsSortableEnabled:!!t.IsSortableEnabled&&t.IsSortableEnabled.Value,IsEntityReferenceStored:t.IsEntityReferenceStored,IsValidForAdvancedFind:!!t.IsValidForAdvancedFind&&t.IsValidForAdvancedFind.Value,IsValidForCreate:t.IsValidForCreate,IsValidForRead:t.IsValidForRead,IsValidForUpdate:t.IsValidForUpdate,IsRetrievable:t.IsRetrievable,IsCustomAttribute:t.IsCustomAttribute,ColumnNumber:t.ColumnNumber,MaxLength:t.MaxLength,MinValue:t.MinValue,MaxValue:t.MaxValue,Precision:t.Precision,PrecisionSource:t.PrecisionSource,Format:j(t),Behavior:r,DefaultFormValue:t.DefaultFormValue,DefaultValue:"boolean"==typeof t.DefaultValue?t.DefaultValue:t.DefaultFormValue,IsBaseCurrency:t.IsBaseCurrency,Targets:t.Targets,AttributeOf:t.AttributeOf,HasChanged:t.HasChanged,ImeMode:x(t.ImeMode),OptionSetId:t.OptionSet&&t.OptionSet.MetadataId?t.OptionSet.MetadataId:null,OptionSetName:t.OptionSet&&t.OptionSet.Name?t.OptionSet.Name:null,OptionSetType:t.OptionSet?t.OptionSet.OptionSetType:null,OptionSet:L(t.OptionSet),ParentPicklistLogicalName:t.OptionSet&&t.ParentPicklistLogicalName?t.ParentPicklistLogicalName:null,ChildPicklistLogicalNames:t.OptionSet&&t.ChildPicklistLogicalNames?t.ChildPicklistLogicalNames:null,RequiredLevel:V(t.RequiredLevel),SourceType:t.SourceType,SourceTypeMask:t.SourceTypeMask,InheritsFrom:t.InheritsFrom,CanBeSecuredForCreate:t.CanBeSecuredForCreate,CanBeSecuredForRead:t.CanBeSecuredForRead,CanBeSecuredForUpdate:t.CanBeSecuredForUpdate}}function L(e){let t=[];if(e&&(t=[],e.FalseOption&&t.push(k(e.FalseOption)),e.TrueOption&&t.push(k(e.TrueOption)),e.Options)){const r=e.Options;for(const e of r)t.push(k(e))}return t}function k(e){const t=e.TransitionData;return{Color:e.Color,Label:ee(e.Label),Value:e.Value,DefaultStatus:e.DefaultStatus,State:e.State,TransitionData:t?[]:null,InvariantName:e.InvariantName,ParentValues:e.ParentValues}}function x(e){if("string"!=typeof e)return"number"==typeof e?e:null;switch(e){case"Auto":return 0;case"Inactive":return 1;case"Active":return 2;case"Disabled":return 3;default:return null}}function j(e){const t=e,r=t.FormatName?t.FormatName.Value:null;return function(e,t,r){if(t)return t;let n="";if(null==r)n=r;else if(e&&e===u.AttributeType.DateTime)switch(r){case s.f.DateOnly:n=u.AttributeType.Date;break;case s.f.DateAndTime:n=u.AttributeType.DateTime;break;default:n=r.toString()}else n=r.toString();return n}(function(e){switch(e){case n.Boolean:return u.AttributeType.Boolean;case n.Customer:return u.AttributeType.Customer;case n.DateTime:return u.AttributeType.DateTime;case n.Decimal:return u.AttributeType.Decimal;case n.Double:return u.AttributeType.Double;case n.Integer:return u.AttributeType.Integer;case n.Lookup:return u.AttributeType.Lookup;case n.Memo:return u.AttributeType.Memo;case n.Money:return u.AttributeType.Money;case n.Owner:return u.AttributeType.Owner;case n.PartyList:return u.AttributeType.PartyList;case n.Picklist:return u.AttributeType.PickList;case n.State:return u.AttributeType.State;case n.Status:return u.AttributeType.Status;case n.String:return u.AttributeType.String;case n.UniqueIdentifier:return u.AttributeType.UniqueIdentifier;case n.CalendarRules:return u.AttributeType.CalendarRules;case n.Virtual:return u.AttributeType.Virtual;case n.BigInt:return u.AttributeType.BigInt;case n.ManagedProperty:return u.AttributeType.ManagedProperty;case n.EntityName:return u.AttributeType.EntityName;case n.AliasedValue:return u.AttributeType.AliasedValue;case n.EntityImage:return u.AttributeType.EntityImage;case n.MultiSelectPicklist:return u.AttributeType.MultiSelectPickList;case n.File:return u.AttributeType.File;case n.NavigationProperty:return u.AttributeType.NavigationProperty;default:return u.AttributeType.Unknown}}(t.AttributeType),r,t.Format)}function U(e){if(!e)return u.AttributeType.Unknown;let t=u.AttributeType.Unknown;return"AttributeTypeName"in e&&e.AttributeTypeName.Value?t=e.AttributeTypeName.Value.replace(/Type/g,""):"AttributeType"in e&&e.AttributeType&&"string"==typeof e.AttributeType&&(t=e.AttributeType),t?"Float"===t?u.AttributeType.Double:t.toLowerCase():u.AttributeType.Unknown}function V(e){if(!Object(a.m)(e)){let t;if(t=Object(a.m)(e.Value)?e:e.Value,"string"==typeof t)switch(e){case"None":return g.AttributeRequiredLevel.None;case"SystemRequired":return g.AttributeRequiredLevel.SystemRequired;case"ApplicationRequired":return g.AttributeRequiredLevel.ApplicationRequired;case"Recommended":return g.AttributeRequiredLevel.Recommended;default:return g.AttributeRequiredLevel.Unknown}if("number"==typeof t)return t}return-1}async function q(e,t){const r={Id:_.Guid.tryParseOrNull(e.Id),EntityLogicalName:e.LogicalName,DisplayName:ee(e.DisplayName),EntitySetName:e.EntitySetName,PrimaryKeyName:e.PrimaryIdAttribute,ObjectTypeCode:e.ObjectTypeCode,PrimaryIdAttribute:e.PrimaryIdAttribute,PrimaryNameAttribute:e.PrimaryNameAttribute,PrimaryImageAttribute:e.PrimaryImageAttribute,EntityColor:e.EntityColor,ActivityTypeMask:e.ActivityTypeMask,AutoRouteToOwnerQueue:e.AutoRouteToOwnerQueue,DisplayCollectionName:ee(e.DisplayCollectionName),CanTriggerWorkflow:e.CanTriggerWorkflow,Description:ee(e.Description),IsDocumentManagementEnabled:e.IsDocumentManagementEnabled,IsOneNoteIntegrationEnabled:e.IsOneNoteIntegrationEnabled,IsMSTeamsIntegrationEnabled:e.IsMSTeamsIntegrationEnabled,IsDocumentRecommendationsEnabled:e.IsDocumentRecommendationsEnabled,IsInteractionCentricEnabled:e.IsInteractionCentricEnabled,IsKnowledgeManagementEnabled:e.IsKnowledgeManagementEnabled,IsActivity:e.IsActivity,IsActivityParty:e.IsActivityParty,IsChildEntity:e.IsChildEntity,IsCollaboration:te(e.IsValidForQueue),IsConnectionsEnabled:te(e.IsConnectionsEnabled),IsCustomEntity:e.IsCustomEntity,IsBusinessProcessEnabled:e.IsBusinessProcessEnabled,IsCustomizable:te(e.IsCustomizable),IsOptimisticConcurrencyEnabled:e.IsOptimisticConcurrencyEnabled,IsImportable:e.IsImportable,IsIntersect:e.IsIntersect,IsMailMergeEnabled:te(e.IsMailMergeEnabled),IsEnabledForCharts:e.IsEnabledForCharts,IsValidForAdvancedFind:e.IsValidForAdvancedFind,IsVisibleInMobileClient:te(e.IsVisibleInMobileClient),IsReadOnlyInMobileClient:te(e.IsReadOnlyInMobileClient),IsOfflineInMobileClient:te(e.IsOfflineInMobileClient),IsQuickCreateEnabled:e.IsQuickCreateEnabled,EntityClientSetting:e.EntityClientSetting,OwnershipType:e.OwnershipType,HasChanged:e.HasChanged,HasStateCode:Z(e),IsStateModelAware:e.IsStateModelAware,EnforceStateTransitions:e.EnforceStateTransitions,Privileges:e.Privileges||[],IconVectorName:e.IconVectorName,IsBPFEntity:e.IsBPFEntity,DataProviderId:_.Guid.tryParseOrNull(e.DataProviderId),IsEnabledInUnifiedInterface:!!Object(a.m)(e.IsVisibleInMobileClient)||(e.IsVisibleInMobileClient.Value||e.IsVisibleInMobileClient.CanBeChanged),VersionNumber:e.VersionNumber,OverallVersionNumber:e.OverallVersionNumber,AttributeNames:e.AttributeNames,IsAuditEnabled:e.IsAuditEnabled};return e.OneToManyRelationships&&(r.OneToManyRelationships=J(e.OneToManyRelationships,!1,Y),r.HasActivities=$(e.OneToManyRelationships,"activitypointer","regardingobjectid"),r.HasNotes=$(e.OneToManyRelationships,"annotation","objectid")),e.ManyToOneRelationships&&(r.ManyToOneRelationships=J(e.ManyToOneRelationships,!1,Y)),e.ManyToManyRelationships&&(r.ManyToManyRelationships=J(e.ManyToManyRelationships,!1,K)),v.entities=Object.assign({},v.entities,{[t]:r}),r}function $(e,t,r){for(const n of e)if(n.ReferencingEntity===t&&n.ReferencingAttribute===r)return!0;return!1}function G(e,t){if(Object(a.m)(e))return null;return{Behavior:t?B(e.Behavior):e.Behavior,Group:t?H(e.Group):e.Group,Label:ee(e.Label),Order:e.Order,AvailableOffline:e.AvailableOffline,Icon:e.Icon,IsCustomizable:e.IsCustomizable,MenuId:e.MenuId,QueryApi:e.QueryApi,ViewId:_.Guid.tryParseOrNull(e.ViewId),ExtensionData:e.ExtensionData}}function B(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"UseCollectionName":return 0;case"UseLabel":return 1;case"DoNotDisplay":return 2;default:return 0}}function H(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"Details":return 0;case"Sales":return 1;case"Service":return 2;case"Marketing":return 3;default:return 0}}function Q(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"NoCascade":return 0;case"Cascade":return 1;case"Active":return 2;case"UserOwned":return 3;case"RemoveLink":return 4;case"Restrict":return 5;default:return 0}}function X(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"None":return 0;case"Append":return 1;case"ParentChild":return 2;case"Pointer":return 4;case"Inheritance":return 8;default:return 0}}function z(e){if("string"!=typeof e)return"number"==typeof e?e:-1;switch(e){case"OneToManyRelationship":return 0;case"ManyToManyRelationship":return 1;default:return-1}}function W(e,t){return{IsCustomRelationship:e.IsCustomRelationship,IsCustomizable:te(e.IsCustomizable),IsValidForAdvancedFind:e.IsValidForAdvancedFind,SchemaName:e.SchemaName,SecurityTypes:t?X(e.SecurityTypes):e.SecurityTypes,IsManaged:e.IsManaged,RelationshipType:t?z(e.RelationshipType):e.RelationshipType,IntroducedVersion:e.IntroducedVersion}}function Y(e,t){const r=G(e.AssociatedMenuConfiguration,t),n=function(e,t){return t?{Assign:Q(e.Assign),Delete:Q(e.Delete),Merge:Q(e.Merge),Reparent:Q(e.Reparent),Share:Q(e.Share),Unshare:Q(e.Unshare),ExtensionData:Q(e.ExtensionData)}:{Assign:e.Assign,Delete:e.Delete,Merge:e.Merge,Reparent:e.Reparent,Share:e.Share,Unshare:e.Unshare,ExtensionData:e.ExtensionData}}(e.CascadeConfiguration,t);return Object.assign({AssociatedMenuConfiguration:r,CascadeConfiguration:n,ReferencedAttribute:e.ReferencedAttribute,ReferencedEntity:e.ReferencedEntity,ReferencingAttribute:e.ReferencingAttribute,ReferencingEntity:e.ReferencingEntity,IsHierarchical:e.IsHierarchical,ReferencedEntityNavigationPropertyName:e.ReferencedEntityNavigationPropertyName,ReferencingEntityNavigationPropertyName:e.ReferencingEntityNavigationPropertyName},W(e,t))}function K(e,t){return Object.assign({Entity1AssociatedMenuConfiguration:G(e.Entity1AssociatedMenuConfiguration,t),Entity2AssociatedMenuConfiguration:G(e.Entity2AssociatedMenuConfiguration,t),Entity1LogicalName:e.Entity1LogicalName,Entity2LogicalName:e.Entity2LogicalName,IntersectEntityName:e.IntersectEntityName,Entity1IntersectAttribute:e.Entity1IntersectAttribute,Entity2IntersectAttribute:e.Entity2IntersectAttribute,Entity1NavigationPropertyName:e.Entity1NavigationPropertyName,Entity2NavigationPropertyName:e.Entity2NavigationPropertyName},W(e,t))}function J(e,t,r){if(!e)return null;const n={};for(const a of e){const e=r(a,t);n[a.SchemaName]=e}return n}function Z(e){if(!e||!e.AttributeNames)return!1;for(const t of e.AttributeNames)if("statecode"===t.toLowerCase())return!0;return!1}function ee(e){return e&&e.UserLocalizedLabel?e.UserLocalizedLabel.Label:null}function te(e){return e?e.Value:null}async function re(e,t=[]){const r=await async function(e){const t="select * from usercontext",r=[];return await Object(b.b)(e,t,r)}(e),n=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache);if(Object(a.m)(r)||Object(a.m)(r[0])||Object(a.m)(r[0].rows)||Object(a.m)(r[0].rows.item(0))){const e="user context returned from Database is empty";return n.error(`${ne()} ${e}`,t),Promise.reject(new i.a(e))}{const e=r[0].rows.item(0),t=JSON.parse(e.json);return v.userContext=Object.assign({},v.userContext,{userid:new _.Guid(t.userid.rawguid),username:t.username,fcbContext:t.fcbcontext,userSettings:t.usersettings,organizationSettings:t.organizationsettings}),t}}function ne(e){return e?`[${e}]`:`[${o.FILE_PREFIX.MetadataCache}]`}},xl8k:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.SupportedLookupProperties=void 0;var n=r("cvWF");t.SupportedLookupProperties=[n.AttributeType.Owner,n.AttributeType.Customer,n.AttributeType.Lookup]},xvCR:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DOMParserNodeListWrapper=void 0;var n=r("1LmJ"),a=r("UZ+8"),i=function(){function e(e){n.assert(!a.IsNullOrUndefined(e),"Node list obj should not be null"),this._list=e}return e.prototype.get_count=function(){return this._list.length},e.prototype.get_item=function(e){return this._list[e]},e}();t.DOMParserNodeListWrapper=i}}]),window.bundleExecutionMarkers["scripts/113.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();