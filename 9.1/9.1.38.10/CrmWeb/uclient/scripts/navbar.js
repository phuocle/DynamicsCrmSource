(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/navbar.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[86],{"3mNF":function(e,t,s){"use strict";s.d(t,"a",(function(){return h})),s.d(t,"b",(function(){return o})),s.d(t,"d",(function(){return c})),s.d(t,"c",(function(){return l}));var i=s("4fxQ"),r=s("d6Hx"),n=s("3rse"),a=s("cz9j");function o(e){const t=e.target;switch(Object(a.e)(e.nativeEvent)){case n.a.DownArrow:const s=t.nextElementSibling;return s&&s.focus(),!0;case n.a.UpArrow:const i=t.previousElementSibling;return i&&i.focus(),!0;case n.a.Tab:return e.preventDefault(),!0;case n.a.Enter:return t.click(),!1;case n.a.Escape:return!1;default:return!0}}function l(e){requestAnimationFrame(()=>{if(!e)return;const t=i.findDOMNode(e);t&&t.firstElementChild&&t.firstElementChild.focus()})}function c(){const e=document.getElementById(r.f);if(!e)return;const t=e.children;for(let e=0;e<t.length;e++){const s=t[e];if(0===s.tabIndex){s.focus();break}}}class h{constructor(e=null){this._entityNavBar=document.getElementById(r.k),this._navBar=document.getElementById(r.f),this._currElement=e}_isElementExpanded(e){return!(!e||"true"!==e.getAttribute("aria-expanded")&&"true"!==e.getAttribute("data-expanded"))}_getParents(e){const t=[];let s=e;for(;s&&s.parentElement;)s=s.parentElement,t.push(s);return t}getNextSibling(e=this._currElement,t=!0){if(!e)return null;let s=e.nextElementSibling;const i=this._getParents(e);if(e.getAttribute("role")&&-1!==e.getAttribute("role").indexOf("tab")&&s)return s;if(t&&this._isElementExpanded(e))s=e.getElementsByTagName("li")[0];else if(!s&&this._isElementExpanded(i[2]))s=this.getNextSibling(i[2],!1);else if(!s&&i[1]){const e=i[1].nextElementSibling,t=e?e.getElementsByTagName("li"):null;s=t?t[0]:null}return s}getPrevSibling(e=this._currElement){if(!e)return null;const t=e.previousElementSibling,s=this._getParents(e);if(e.getAttribute("role")&&-1!==e.getAttribute("role").indexOf("tab")&&t)return t;if(this._isElementExpanded(t)){const e=t.getElementsByTagName("li");if(e.length)return e[e.length-1]}if(t)return t;if(this._isElementExpanded(s[2]))return s[2];if(s[1]){const e=s[1].previousElementSibling,t=e?e.getElementsByTagName("li"):null;if(t&&t.length)return t[t.length-1]}return null}getFirstItemOfEntityNavBar(){const e=this._entityNavBar?this._entityNavBar.firstChild:null,t=e?e.getElementsByTagName("li"):null;return t?t[0]:null}getLastItemofEntityNavBar(){const e=this._entityNavBar?this._entityNavBar.lastChild:null,t=e?e.getElementsByTagName("li"):null;return t&&t.length?t[t.length-1]:null}findNextMatchingListItem(e){if(!this._entityNavBar||!this._entityNavBar.firstChild)return null;const t=this._navBar.contains(this._currElement)?this.getLastItemofEntityNavBar():this._currElement;let s=t,i=!1;do{const t=s;if(i?(s=this.getFirstItemOfEntityNavBar(),i=!1):s=this.getNextSibling(t),s){const t=s.getAttribute("data-text");if(t&&t.toLowerCase().startsWith(e))return s}else i=!0}while(s!==t);return null}}},"7Xh3":function(e,t,s){"use strict";s.d(t,"b",(function(){return y})),s.d(t,"a",(function(){return I}));var i=s("nuS9"),r=s("uTTW"),n=s("S6oQ"),a=s("u+q+"),o=s("37s6"),l=s("69Qu"),c=s("NjDY"),h=s("UwOy"),p=s("IqkD"),u=s("NvOS");var d=s("QBtP"),m=s("bK23"),f=s("4N6w"),b=s("Lyxw"),g=s("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function y(e){return i.createElement(_,{imgSrc:e.source,render:t=>i.createElement(n.a,Object.assign({focusable:"false"},e,{source:t,altText:e.altText}))})}function I(e){return i.createElement(_,{imgSrc:e.source,render:t=>i.createElement(r.a,Object.assign({},e,{source:t,altText:e.altText}))})}function _({imgSrc:e,render:t}){const s=i.useContext(d.a).AssetLoader,[r,n]=i.useState(e);let y;const I=function(e,t){return Object(a.d)(s=>
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,s){const i=Object(o.w)(e),r=!Object(l.b)(e),n=Object(c.t)(e),a=Object(h.d)(e);return(i&&r||a)&&function(e,t="",s){const i="$webresource:",r="/webresources/",n=t.toLowerCase();return n.startsWith(i)?(s(t.substr(i.length)),!0):n.startsWith(r)?(s(t.substr(r.length)),!0):!!n.startsWith(e)&&(s(t.substr(e.length)),!0)}(n,t,s)}(s,e,t))}(e,e=>y=e),_=function(e){return Object(a.d)(t=>function(e,t){var s;if((null===(s=Object(p.w)(e))||void 0===s?void 0:s.usePathBasedUrls)&&t.toLowerCase().startsWith("/webresources/"))return Object(u.a)(e,t)}(t,e))}(e),M=Object(a.d)(e=>Object(b.b)(e,g.b)),O=Object(a.d)(f.a);return i.useEffect(()=>{I?s.loadOfflineWebResource(y).then(e=>{e&&n(m.a.createDataUri(m.b.Svg,e).toString())}):n(_||e)},[I,_,e,y,s]),t(r,M&&O)}},"VJ/u":function(e,t,s){"use strict";s.d(t,"a",(function(){return I})),s.d(t,"b",(function(){return y}));var i=s("nuS9"),r=s("evW+"),n=s("H/hG"),a=s("3rse"),o=s("YWpA"),l=s("RiHV"),c=s("znb3"),h=s("XIN1"),p=s("eD3A"),u=s("hoir"),d=s("d6Hx"),m=s("QBtP"),f=s("H4dV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const b={height:"100%",width:"100%",justifyContent:"center",alignItems:"center"};class g extends i.Component{constructor(e,t){super(e),this.onClickHandler=this.onClickHandler.bind(this),this.onKeyDownHandler=this.onKeyDownHandler.bind(this),t.hiddenAction&&(this._hiddenActionTriggerCallback=Object(u.a)(t.hiddenAction))}onClickHandler(){this.context.toggleSiteMap(),this._hiddenActionTriggerCallback&&this._hiddenActionTriggerCallback()}onKeyDownHandler(e){e.keyCode===a.a.Enter&&e.preventDefault()}render(){const e=this.props.isOpened?d.e:null,t=this.props.isOpened?d.f:null,s=this.props.label,a=this.props.label;return i.createElement(r.a,{id:d.g,style:this.props.buttonStyle,onClick:this.onClickHandler,accessibilityLabel:s,title:Object(p.d)(a,a,null),ownsElementId:t,accessibilityExpanded:this.props.isOpened,controlsElementId:e,accessibilityHasPopup:!0,onKeyDown:this.onKeyDownHandler,testhooks:{id:"navbutton",[l.a.LearningPathDOMAttributeSuffix]:"sitemap-launcher"}},i.createElement(o.a,{style:b},i.createElement(n.a,{style:this.props.iconStyle},i.createElement(h.b,{type:c.a.SiteMap}))))}}function y(e,t,s){const i=s?d.e:null,r=s?d.f:null;return f.a.getInstance().get_IsBrowserIE()?{DisplayText:e,WillOpenFlyout:!0,ownsElementId:r,controlsElementId:i,Icon:"SiteMap",DataId:"navbutton",dataLPId:"sitemap-launcher",Id:d.g,Tooltip:Object(p.d)(e,e,null),execute:t}:{DisplayText:e,WillOpenFlyout:!0,ownsElementId:r,controlsElementId:i,Icon:"SiteMap",accessibilityExpanded:s,DataId:"navbutton",dataLPId:"sitemap-launcher",Id:d.g,Tooltip:Object(p.d)(e,e,null),execute:t}}g.contextType=m.b;const I=g},"j+uO":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var i=s("nuS9"),r=s("H4dV"),n=s("7Xh3");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function a(e){const{source:t,style:s}=e;if(r.a.getInstance().get_IsBrowserIE()&&!e.useImgInIE||e.highContrast){const r=Object.assign(Object.assign(Object.assign({},s),e.invert?{fill:"white"}:{}),e.highContrast?{fill:"windowText"}:{});return i.createElement(n.b,{source:t,style:r,fallbackToImage:!0,title:e.title,role:e.role,altText:e.altText})}const a=Object.assign(Object.assign({},s),e.invert?{filter:"invert(100%)"}:{});return i.createElement(n.a,{source:t,style:a,title:e.title,role:e.role,altText:e.altText})}},nidR:function(e,t,s){"use strict";s.r(t),s.d(t,"ConnectedNavBar",(function(){return De}));var i=s("nuS9"),r=s("4fxQ"),n=s("YWpA"),a=s("u+q+"),o=s("2FbK"),l=s("3mNF"),c=s("1AYO"),h=s("Afz2"),p=s("3rse"),u=s("cz9j"),d=s("d6Hx"),m=s("evW+"),f=s("gvL4"),b=s("7HpW"),g=s("nJrx"),y=s("H/hG"),I=s("dIye"),_=s("q43A"),M=s("Smta"),O=s("RiHV"),S=s("uTTW"),v=s("SocB"),E=s("j+uO"),w=s("VnpK");function A(e,t){return{width:"16px",height:"16px",flex:"0 0 16px",fontFamily:"Dyn CRM Symbol, Segoe MDL2 Assets",textAlign:"center",fontSize:"16px",marginLeft:t?"16px":e.sizes.Measures.Measure025,marginRight:t?"16px":"0px"}}function B(e,t){return{whiteSpace:"nowrap",textOverflow:"ellipsis",overflowX:"hidden",marginLeft:t?"0px":e.sizes.Measures.Measure050,marginRight:t?"0px":e.sizes.Measures.Measure025,fontSize:e.fontSizes.Font100,fontFamily:e.fontFamilies.Regular}}const k={width:"100%"},x={justifyContent:"space-between"},L={display:"inline-block",width:"100%"};class j extends i.Component{constructor(e){super(e),this.selectItem=this.selectItem.bind(this),this.onKeyDownHandler=this.onKeyDownHandler.bind(this)}selectItem(){this.props.selectArea(this.props.itemId)}onKeyDownHandler(e){e.keyCode===p.a.Enter&&this.selectItem()}render(){const{itemId:e,selectedItemId:t,title:s,theme:r,maxWidth:a,icon:o,hideOverflowButton:l,visibleItems:c,isWeb:p}=this.props,u=e===t,m=this.props.itemId===d.d,f=function(e,t){let s="",i=null;void 0!==I.a[t]&&(s=I.a[t]);e&&(s=e,i=S.a);return{type:i,value:s}}(o,e),b=p?function(e,t,s){return e?{width:"calc((100% - "+s.sizes.NavButtonHeight+")/"+t+")"}:{}}(l,c,r):{},g=Object.assign(Object.assign(Object.assign({},
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,s,i){return Object(_.e)({color:Object(v.e)(s.colors.SiteMap.AreaBar),backgroundColor:"transparent",cursor:"pointer",padding:0,borderBottomColor:s.colors.SiteMap.AreaItemBorder,borderBottomWidth:e?s.sizes.SiteMap.AreaItemBorder:0,borderTopColor:"transparent",borderTopWidth:e?s.sizes.SiteMap.AreaItemBorder:0,borderStyle:"solid",maxWidth:t||"100%",display:"flex",alignItems:"center",height:s.sizes.NavButtonHeight,boxSizing:"border-box",paddingLeft:i?"0px":s.sizes.Measures.Measure050,paddingRight:i?"0px":s.sizes.Measures.Measure050},s.colors.NavBar.NavBar1.Fill)}(u,a,r,m)),b),function(e){return e?{flex:"0 0 auto"}:{}}(m));return i.createElement(M.a,{key:"sitemap-navItem-listItem",style:this._addContrastRule(g,f,r,!0),onClick:this.selectItem,accessibilityLabel:s,dataText:s,role:h.t,accessibilityExpanded:u,ownsElementId:d.k,tabIndex:u?0:-1,onKeyDown:this.onKeyDownHandler,isSelected:u,testhooks:{id:"sitemap-module-"+e,[O.a.LearningPathDOMAttributeSuffix]:"sitemap-navItem-"+e}},i.createElement(n.a,{key:"sitemap-navItem-inlineBlock",style:L,accessibilityHidden:!0},i.createElement(n.a,{key:"sitemap-navItem-innerView",style:x},i.createElement(n.a,{key:"sitemap-navItem-iconContainer",style:k,title:s},i.createElement(y.a,{key:"sitemap-navItem-icon",className:"svgIcon",style:this._addContrastRule(A(r,m),f,r),testhooks:{id:"sitemap-navItem-icon-"+e}},function(e,t){const s=e.type,r=e.value,n=Object(w.n)();switch(s){case S.a:const e={width:t.sizes.Icon.MinWidth,height:t.sizes.Icon.MinHeight};return i.createElement(E.a,{source:r,style:e,highContrast:n});case null:return r}}(f,r)),i.createElement(y.a,{key:"sitemap-navItem-label",style:B(r,m),testhooks:{id:"sitemap-navItem-text-"+e}},m?null:s)))))}_addContrastRule(e,t,s,i){if(t.type!==S.a||Object(w.n)())return e;const r=i?s.colors.NavBar.NavBar1.Fill.toString():s.colors.SiteMap.AreaBar;return Object(_.b)(e,r,i)}}var T=s("znb3"),F=s("XIN1"),R=s("sclX"),N=s("IqkD"),C=s("unFF");function D(e,t){return{whiteSpace:"nowrap",textOverflow:"ellipsis",overflowX:"hidden",marginLeft:t?"0px":e.sizes.Measures.Measure100,marginRight:t?e.sizes.Measures.Measure100:"0px",fontSize:e.fontSizes.Font100,fontFamily:e.fontFamilies.Regular,height:e.sizes.Measures.Measure150,lineHeight:e.sizes.Measures.Measure150,display:"inline-block",alignItems:"center"}}function z(e){return{fontFamily:"CRM MDL2",fontSize:"16px",width:"16px",height:e.sizes.Measures.Measure150,display:"flex",alignItems:"center"}}const H=Object(a.a)((function(){return function(e,t){return{theme:Object(C.a)(e),isRTL:Object(N.g)(e)}}}))((function(e){return i.createElement(c.a,{key:"flyout",positionType:"relative",relativeToElementId:e.relativeToElementId,flyoutDirection:e.isRTL?c.b.left:c.b.right,flyoutStyle:(t=e.theme,s=e.isRTL,{backgroundColor:t.colors.SiteMap.AreaBar,marginTop:t.sizes.Measures.Measure025,marginBottom:t.sizes.Measures.Measure025,marginRight:s?"-"+t.sizes.Measures.Measure025:t.sizes.Measures.Measure025,marginLeft:s?"-"+t.sizes.Measures.Measure025:t.sizes.Measures.Measure025,opacity:.95,boxShadow:t.shadows.Shadow01,maxHeight:"23.75em",overFlowY:"auto"}),onOutsideClick:e.closeFlyout,id:e.id,testhooks:e.isQuickLaunchBar?{[O.a.LearningPathDOMAttributeSuffix]:"sitemap-areabar-overflow-flyout"}:null},i.createElement(f.a,{style:(e.theme,{display:"initial",listStyleType:"none",width:"19.29em"}),onKeyDown:e.keyDownHandler,ref:l.c,role:h.m},function(e,t,s){return(t=t.filter(e=>e.Id!==d.d))&&t.length?t.map((t,r)=>{return i.createElement(M.a,{key:r,style:(n=e.theme,Object(_.e)({color:Object(v.e)(n.colors.SiteMap.AreaBar),cursor:"pointer",padding:n.sizes.Measures.Measure100,display:"flex",flexDirection:"row"},n.colors.NavBar.NavBar1.Fill)),tabIndex:-1,isSelected:s===t.Id,role:h.n,testhooks:{id:(e.isQuickLaunchBar?"quick-launch-overflow-area-":"areabar-overflow-")+t.Id,[O.a.LearningPathDOMAttributeSuffix]:e.isQuickLaunchBar?null:"sitemap-areabar-overflow-"+t.Id},onClick:s=>{e.selectArea(t.Id),e.closeFlyout(s),e.setFocusToFirstEntity()}},i.createElement(y.a,{style:z(e.theme)},s===t.Id?i.createElement(F.b,{type:T.a.CheckMark}):null),i.createElement(y.a,{style:D(e.theme,e.isRTL)},t.Titles[0].Title));var n}):[]}(e,e.siteMapItems,e.selectedAreaId)));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var t,s}));var W=s("YxC/"),P=s("oLPm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const G=Object(g.a)();function Q(e){return{flexDirection:"row",flex:"0 1 100%",width:`calc(100% - ${e.sizes.NavButtonHeight})`,minWidth:"0"}}const K={flexDirection:"row",justifyContent:"space-between",width:"100%"};function q(e){return{color:e.colors.SiteMap.AreaBarItemIcon,fontFamily:"Dyn CRM Symbol, Segoe MDL2 Assets",fontSize:"16px",textAlign:"center",width:"100%"}}const V={flexShrink:0};class U extends i.Component{constructor(e){super(e),this._visibleItems=[],this._siteMapItems=[],this._areaListId=Object(g.a)(),this._overflowButtonId=Object(g.a)(),this._overflowFlyoutId=Object(g.a)(),this._overFlowButtonRef=null,this._shouldSelectFirstArea=!1,this._shouldSelectFirstAreaOnReRender=!1,this._hideOverflowButton=!1,this._list=null,this._maxWidth=0,this._getOverflowButtonRef=this._getOverflowButtonRef.bind(this),this._focusOnFirstSubArea=this._focusOnFirstSubArea.bind(this),this._toggleOverFlowFlyout=this._toggleOverFlowFlyout.bind(this),this._selectMruButton=this._selectMruButton.bind(this),this._getListRef=this._getListRef.bind(this),this.keyDownHandler=this.keyDownHandler.bind(this),this.state={isPreRenderStep:!0}}_getListRef(e){this._list=e}_selectMruButton(){this.props.selectArea(d.d)}_toggleOverFlowFlyout(){this.setState({isOverflowFlyoutVisible:!this.state.isOverflowFlyoutVisible})}componentDidMount(){this.setState({isPreRenderStep:!0}),this._shouldSelectFirstArea=!0}componentDidUpdate(e,t){e.selectedAreaId!==this.props.selectedAreaId?this.setState({isPreRenderStep:!0}):(this._calculateOverflowItems(this._shouldSelectFirstArea),this._shouldSelectFirstArea?(this._shouldSelectFirstArea=!1,this._shouldSelectFirstAreaOnReRender||Object(l.d)()):this._shouldSelectFirstAreaOnReRender&&(this._shouldSelectFirstAreaOnReRender=!1,Object(l.d)()))}_calculateOverflowItems(e){const t=document.getElementById(this._areaListId);t&&t.clientWidth<t.scrollWidth?this.state.isPreRenderStep&&(this.setState({isPreRenderStep:!1}),e&&(this._shouldSelectFirstAreaOnReRender=!0),this._assignOverFlowItems()):this._visibleItems.length===this._siteMapItems.length&&(this._hideOverflowButton=!0,this.state.isPreRenderStep&&this.setState({isPreRenderStep:!1}))}_assignOverFlowItems(){const{siteMap:e}=this.props;let t=e?Object(b.a)(e):[];if(t=t.filter(e=>e.Id!==d.d),this.props.platformType!==R.b.Web)return this._hideOverflowButton=!0,void(this._visibleItems=t);if(t&&t.length&&this._list){const e=r.findDOMNode(this._list);if(!e)return;const s=e.children;if(s.length!==t.length+1)return;this._visibleItems=[];let i=document.getElementById(this._areaListId).clientWidth;i-=X(s.item(0));let n=0;if(this.props.selectedAreaId&&this.props.selectedAreaId!==d.d)for(let e=0;e<t.length;e++){const r=t[e];if(r.Id===this.props.selectedAreaId){n=e,this._visibleItems.push(r),i-=X(s.item(e+1));break}}for(let e=0;e<t.length&&!(i<=0);e++){const r=X(s.item(e+1)),a=t[e];if(a.Id!==this.props.selectedAreaId){if(r>i)continue;this._visibleItems.length&&e<n?this._visibleItems.splice(this._visibleItems.length-1,0,a):this._visibleItems.push(a),i-=r}}if(this._hideOverflowButton=!1,this._visibleItems.length===t.length)this._hideOverflowButton=!0;else if(this._visibleItems.length+1===t.length){document.getElementById(this._overflowButtonId).offsetWidth+i>60&&(this._visibleItems=t,this._hideOverflowButton=!0)}if(this._maxWidth=0,i<0)if(this._visibleItems.length){const e=this._visibleItems[this._visibleItems.length-1];for(let r=0;r<t.length;r++){if(t[r].Id===e.Id){this._maxWidth=s.item(r+1).offsetWidth+i;break}}}else this._maxWidth=s.item(0).offsetWidth+i;if(this._hideOverflowButton&&this._maxWidth){const e=document.getElementById(this._overflowButtonId).offsetWidth;this._maxWidth=this._maxWidth+e}}}_renderItems(){if(this.props.isAreaBarEmpty)return null;const e=this._visibleItems&&this._visibleItems.length?this._visibleItems.map((e,t)=>i.createElement(j,{key:t,isWeb:this.props.platformType===R.b.Web,itemId:e.Id,title:e.Titles[0].Title,selectArea:this.props.selectArea,selectedItemId:this.props.selectedAreaId,icon:e.VectorIcon,maxWidth:this._visibleItems.length===t+1?this._maxWidth:0,hideOverflowButton:this._hideOverflowButton,visibleItems:this._visibleItems.length,theme:this.props.theme})):[];return e.unshift(i.createElement(j,{key:"mru-button",itemId:d.d,title:Object(W.c)(this.props.resourceStrings,P.d),selectArea:this.props.selectArea,selectedItemId:this.props.selectedAreaId,theme:this.props.theme})),e}keyDownHandler(e){if(Object(l.b)(e)||this.setState({isOverflowFlyoutVisible:!1}),e.keyCode===p.a.Enter)this._focusOnFirstSubArea();else if(e.keyCode===p.a.Escape&&this._overFlowButtonRef){const e=r.findDOMNode(this._overFlowButtonRef);e&&e.focus()}}_focusOnFirstSubArea(){requestAnimationFrame(()=>{const e=new l.a(null).getFirstItemOfEntityNavBar();e&&e.focus()})}_getOverflowButtonRef(e){this._overFlowButtonRef=e}_renderOverFlowButton(){if(this._hideOverflowButton)return null;let e=null,t=null;const s=Object(b.a)(this.props.siteMap);return this.state.isOverflowFlyoutVisible&&(t=this._overflowFlyoutId,e=i.createElement(H,{id:this._overflowFlyoutId,setFocusToFirstEntity:this._focusOnFirstSubArea,siteMapItems:s,selectArea:this.props.selectArea,selectedAreaId:this.props.selectedAreaId,relativeToElementId:G,closeFlyout:this._toggleOverFlowFlyout,isQuickLaunchBar:!1,keyDownHandler:this.keyDownHandler})),i.createElement(n.a,{key:"more-options",style:V},i.createElement(m.a,{key:"more-options-button",accessibilityLabel:Object(W.c)(this.props.resourceStrings,P.a),onClick:this._toggleOverFlowFlyout,style:(r=this.props.theme,Object(_.e)({backgroundColor:"transparent",borderStyle:"none",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",color:r.colors.SiteMap.AreaBarItemIcon,paddingLeft:r.sizes.Measures.Measure050,paddingRight:r.sizes.Measures.Measure050,width:r.sizes.NavButtonHeight,height:r.sizes.NavButtonHeight},r.colors.SiteMap.AreaBarItemActive)),id:this._overflowButtonId,accessibilityExpanded:!!this.state.isOverflowFlyoutVisible,accessibilityHasPopup:!0,controlsElementId:t,ownsElementId:t,ref:this._getOverflowButtonRef,testhooks:{id:"sitemap-areaBar-more-btn",[O.a.LearningPathDOMAttributeSuffix]:"sitemap-areaBar-more-btn"}},i.createElement(y.a,{style:q(this.props.theme)},i.createElement(F.b,{type:T.a.More}))),e);var r}_renderCloseButton(){if(this.props.platformType===R.b.Web)return i.createElement(n.a,{key:"close-button",style:V},i.createElement(m.a,{key:"cancel",style:(e=this.props.theme,Object(_.e)({backgroundColor:"transparent",borderStyle:"none",cursor:"pointer",width:e.sizes.NavButtonHeight,height:e.sizes.NavButtonHeight,paddingLeft:e.sizes.Measures.Measure050,paddingRight:e.sizes.Measures.Measure050,display:"flex",justifyContent:"center",alignItems:"center"},e.colors.SiteMap.AreaBarItemActive)),id:G,onClick:this.props.closeSiteMap,accessibilityLabel:Object(W.c)(this.props.resourceStrings,P.c)},i.createElement(y.a,{style:q(this.props.theme)},i.createElement(F.b,{type:T.a.Close}))));var e}render(){if(this.props.platformType!==R.b.Web||this.state.isPreRenderStep||!this._visibleItems){let e=this.props.siteMap?Object(b.a)(this.props.siteMap):[];e=e.filter(e=>e.Id!==d.d),this._siteMapItems=e,this._visibleItems=e,this._maxWidth=0,this._hideOverflowButton=!1,(this.props.platformType!==R.b.Web||this.props.isAreaBarEmpty)&&(this._hideOverflowButton=!0)}return i.createElement(n.a,{style:(s=this.props.theme,{width:"100%",display:"block",backgroundColor:s.colors.SiteMap.AreaBar,minHeight:s.sizes.NavButtonHeight})},i.createElement(n.a,{style:K},i.createElement(n.a,{style:Q(this.props.theme)},i.createElement(n.a,{style:(t=this.props.platformType,{overflowX:t===R.b.Web?"hidden":"auto",justifyContent:"flex-start"}),id:this._areaListId},i.createElement(f.a,{key:d.f,ref:this._getListRef,id:d.f,role:h.u,style:(e=this.state.isPreRenderStep,{flexDirection:"row",listStyleType:"none",display:"inline-flex",width:"100%","& *":e?{flexShrink:0}:void 0}),accessibilityLabel:Object(W.c)(this.props.resourceStrings,P.h)},this._renderItems())),this._renderOverFlowButton()),this._renderCloseButton()));var e,t,s}}function X(e){const t=e,s=t.currentStyle||window.getComputedStyle(t),i=parseFloat(s.marginLeft)+parseFloat(s.marginRight);return t.offsetWidth+(i||0)}var Y=s("14bW"),J=s("GWSs"),Z=s("VJ/u"),$=s("Xi8U"),ee=s("1S8a");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const te=Object(g.a)();function se(e,t,s){return Object(_.e)({display:"block",cursor:"pointer",backgroundColor:"transparent",height:e.sizes.NavbarHeight,width:e.sizes.NavbarHeight,color:Object(v.e)(e.colors.QuickLaunchBar),borderTopWidth:0,borderBottomWidth:0,borderLeftColor:t?"transparent":e.colors.QuickLaunchBarButtonBorderColor,borderLeftWidth:s?e.sizes.QuickLaunchBar.ButtonBorderSize:0,borderRightColor:t?e.colors.QuickLaunchBarButtonBorderColor:"transparent",borderRightWidth:s?e.sizes.QuickLaunchBar.ButtonBorderSize:0,borderStyle:"solid"},e.colors.NavBar.NavBar1.Fill)}function ie(e,t){const s=se(e,t);return s.height=e.sizes.NavButtonHeight,s.backgroundColor=e.colors.NavBar.NavBar1.Fill,s.color=e.colors.NavBar.NavBar1.Text,s}function re(e){const t=ne(e);return t.color=e.colors.NavBar.NavBar1.Text,t}function ne(e){return{fontFamily:"Dyn CRM Symbol",fontSize:e.fontSizes.QuickLaunchBarIcon}}const ae={display:"block",height:"100%",width:"100%"};function oe(e){return{height:"100%",justifyContent:"center","border-top":e.borders.Border04}}const le={height:"100%",width:"100%",justifyContent:"center",alignItems:"center"};class ce extends i.Component{constructor(e){super(e),this._moreOptionsButtonId=Object(g.a)(),this._moreOptionsFlyoutId=Object(g.a)(),this._defaultEntitiesInList=10,this._onMeasureHandler=this._onMeasureHandler.bind(this),this._calculateMaxListItems=this._calculateMaxListItems.bind(this),this._getMoreOptionsButtonRef=this._getMoreOptionsButtonRef.bind(this),this._setFocusToFirstEntity=this._setFocusToFirstEntity.bind(this),this._getEntityListRef=this._getEntityListRef.bind(this),this._handleKeyDownInEntityList=this._handleKeyDownInEntityList.bind(this),this._toggleMoreOptionsFlyout=this._toggleMoreOptionsFlyout.bind(this),this._getOpenSiteMapButtonRef=this._getOpenSiteMapButtonRef.bind(this),this._selectAreaForFlyout=this._selectAreaForFlyout.bind(this),this.keyDownHandler=this.keyDownHandler.bind(this),this.state={}}componentDidMount(){requestAnimationFrame(()=>{this._openSiteMapButton&&r.findDOMNode(this._openSiteMapButton).focus()})}_getOpenSiteMapButtonRef(e){this._openSiteMapButton=e}_toggleMoreOptionsFlyout(){this.setState({moreOptionsFlyoutDisplay:!this.state.moreOptionsFlyoutDisplay})}_handleKeyDownInEntityList(e){const t=e.target;if(e.keyCode===p.a.DownArrow){const e=t.nextElementSibling;e&&e.focus()}else if(e.keyCode===p.a.UpArrow){const e=t.previousElementSibling;e&&e.focus()}}_getEntityListRef(e){this._entityListRef=e}_setFocusToFirstEntity(){requestAnimationFrame(()=>{if(this._entityListRef){const e=r.findDOMNode(this._entityListRef);e.firstChild&&e.firstChild.focus()}})}_renderSitemapAreaEntries(){const{sitemapEntries:e}=this.props;return e.length?e.map((e,t)=>i.createElement(Y.a,{key:t,entry:e,isQuickLaunchBar:!0,isTabIndexZero:0===t})):[]}_renderMruButton(){return this.props.shouldRenderMRU?i.createElement(n.a,{key:Object(W.c)(this.props.resourceStrings,P.d)},i.createElement(m.a,{accessibilityLabel:Object(W.c)(this.props.resourceStrings,P.d),role:h.t,style:se(this.props.theme,this.props.isRTL,this.props.selectedAreaId===d.d),title:Object(W.c)(this.props.resourceStrings,P.d),onClick:()=>this.props.selectArea(d.d),isSelected:this.props.selectedAreaId===d.d,testhooks:{id:"quick-launch-mru-btn",[O.a.LearningPathDOMAttributeSuffix]:"sitemap-navItem-"+d.d}},i.createElement(n.a,{style:le},i.createElement(y.a,{style:ne(this.props.theme)},i.createElement(F.b,{type:T.a.History}))))):null}_renderAreaButton(){const e=this.props.selectedAreaId===d.d?this.props.lastNonMruAreaId:this.props.selectedAreaId,t=function(e,t){if(e&&e.Areas&&e.Areas[t])return e.Areas[t].Titles[0].Title;return null}(this.props.siteMap,e),s=function(e,t){let s="",i=null;void 0!==I.a[t]&&(s=I.a[t]);if(e&&e.Areas&&e.Areas[t]){const r=e.Areas[t];r.VectorIcon&&(s=r.VectorIcon,i=S.a)}return{type:i,value:s}}(this.props.siteMap,e);return i.createElement(n.a,{key:"selected-area"},i.createElement(m.a,{accessibilityLabel:t,role:h.t,style:this._addContrastRule(se(this.props.theme,this.props.isRTL,this.props.selectedAreaId!==d.d),s,this.props.theme,!0),title:t,onClick:()=>this.props.selectArea(e),isSelected:this.props.selectedAreaId===e,testhooks:{id:"quick-launch-mru-btn",[O.a.LearningPathDOMAttributeSuffix]:"sitemap-navItem-"+this.props.selectedAreaId}},i.createElement(n.a,{style:le},i.createElement(y.a,{className:"svgIcon",style:this._addContrastRule(ne(this.props.theme),s,this.props.theme)},this._getIcon(s)))))}_addContrastRule(e,t,s,i){const r=t.type;if(!r||r!==S.a||Object(w.n)())return e;const n=i?s.colors.NavBar.NavBar1.Fill.toString():s.colors.QuickLaunchBar;return Object(_.b)(e,n,i)}_getIcon(e){const t=e.type,s=e.value;switch(t){case S.a:const e=this.props,t=Object(w.n)(),r={width:e.theme.sizes.Icon.MinWidth,height:e.theme.sizes.Icon.MinHeight};return i.createElement(E.a,{source:s,style:r,highContrast:t});case null:return s}}_getMoreOptionsButtonRef(e){this._moreOptionsButton=e}_selectAreaForFlyout(e){this.props.selectArea(e,!0)}keyDownHandler(e){if(Object(l.b)(e)||this.setState({moreOptionsFlyoutDisplay:!1}),e.keyCode===p.a.Escape&&this._moreOptionsButton){const e=r.findDOMNode(this._moreOptionsButton);e&&e.focus()}}_calculateMaxListItems(){const e=this._entityListRef&&r.findDOMNode(this._entityListRef),t=r.findDOMNode(this),s=t&&t.clientHeight;if(!s||!e||!e.offsetWidth)return 0;const i=(s-e.offsetTop)/e.offsetWidth;return Math.floor(i)}_onMeasureHandler(e){const t=this._calculateMaxListItems();this.state.maxListItems!==t&&this.setState({maxListItems:t})}_renderMoreOptionsButton(){const e=this.props.siteMap?Object(b.a)(this.props.siteMap):[];let t=null,s=null;if(!e.length||1===e.length)return null;const r=e=>{const t=e.target,s=document.getElementById(this._moreOptionsButtonId);t&&!s.contains(t)&&s!==t&&this._toggleMoreOptionsFlyout()};return this.state.moreOptionsFlyoutDisplay&&(t=this._moreOptionsFlyoutId,s=i.createElement(H,{id:this._moreOptionsFlyoutId,siteMapItems:e,setFocusToFirstEntity:this._setFocusToFirstEntity,selectedAreaId:this.props.selectedAreaId,selectArea:this._selectAreaForFlyout,keyDownHandler:this.keyDownHandler,relativeToElementId:this._moreOptionsButtonId,closeFlyout:r,isQuickLaunchBar:!0})),i.createElement(n.a,{key:"more-options"},i.createElement(m.a,{key:"button",accessibilityLabel:Object(W.c)(this.props.resourceStrings,P.a),style:se(this.props.theme,this.props.isRTL),id:this._moreOptionsButtonId,onClick:this._toggleMoreOptionsFlyout,accessibilityHasPopup:!0,ownsElementId:t,controlsElementId:t,accessibilityExpanded:!!this.state.moreOptionsFlyoutDisplay,ref:this._getMoreOptionsButtonRef,testhooks:{id:"quick-launch-more-options-btn",[O.a.LearningPathDOMAttributeSuffix]:"sitemap-areaBar-more-btn"}},i.createElement(n.a,{style:le},i.createElement(y.a,{style:ne(this.props.theme)},i.createElement(F.b,{type:T.a.More})))),s)}render(){let e=this.state.maxListItems?this.state.maxListItems:this._calculateMaxListItems();const t=this._renderSitemapAreaEntries();return e=Math.min(e,this._defaultEntitiesInList),e=e>0?e:0,t.length>e&&(t.length=e),i.createElement(n.a,{style:(r=this.props,{top:r.theme.sizes.NavbarHeight,left:r.isRTL?"initial":0,right:r.isRTL?0:"initial",bottom:0,overflow:"hidden",position:"absolute"}),testhooks:{id:"quick-launch-bar"},role:h.p,isRequestedMeasuring:!0,onMeasuring:this._onMeasureHandler,accessibilityHidden:!!this.props.isSiteMapOpen},i.createElement(n.a,{style:(s=this.props.theme,{flexDirection:"column",width:s.sizes.NavbarHeight,backgroundColor:s.colors.QuickLaunchBar})},i.createElement(n.a,{key:"Open Site Map"},i.createElement(Z.a,{buttonStyle:Object(_.e)(ie(this.props.theme,this.props.isRTL),this.props.theme.colors.NavBar.NavBar2.Fill),iconStyle:re(this.props.theme),isMobileMode:!1,isOpened:this.props.isSiteMapOpen,label:Object(W.c)(this.props.resourceStrings,P.k)})),this.props.shouldHideSiteMapItems?null:i.createElement(n.a,null,i.createElement(n.a,{role:h.u,accessibilityLabel:Object(W.c)(this.props.resourceStrings,P.f)},this._renderMruButton(),this._renderAreaButton()),this._renderMoreOptionsButton(),i.createElement(n.a,{style:oe(this.props.theme),role:h.v},i.createElement(y.a,{id:te,style:{display:"none"}},Object(W.c)(this.props.resourceStrings,P.f)),i.createElement(f.a,{key:"Sitemap Area Entries List",style:ae,ref:this._getEntityListRef,onKeyDown:this._handleKeyDownInEntityList},t)))));var s,r}}const he=Object(a.a)((function(){let e,t=[],s=null;return(i,r)=>{const n=Object(N.g)(i),a=Object($.g)(i),o=a&&a.length>0,l=Object(ee.c)(i),c=Object(J.j)(i);if(s!==r.selectedAreaId||r.selectedAreaId===d.d||e!==c){s=r.selectedAreaId;const n=[],a=Object(J.l)(i,r.selectedAreaId);if(r.selectedAreaId===d.d&&a&&(a.length=o?1:0,!a.length&&!r.isSiteMapOpen&&r.siteMap&&r.siteMap.AreaIds)){const e=r.siteMap.AreaIds,t=e[0]!==d.d?e[0]:e[1];t&&r.selectArea(t)}a&&a.forEach(e=>{for(const t of e.entries)n.push(t)});let l=!0;r.selectedAreaId===d.d&&n.length===t.length&&(l=n.some((e,s)=>e.title!==t[s].title)),c!==e&&(e=c,l=!0),l&&(t=n)}return{sitemapEntries:t,isRTL:n,shouldRenderMRU:o,shouldHideSiteMapItems:l}}}))(ce);var pe=s("wRZP"),ue=s("QBtP");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function de(e){const{theme:t,platformType:s}=e,i=s===R.b.Web;return{display:"block",width:"100%",height:t.sizes.Measures.Measure300,minHeight:t.sizes.Measures.Measure300,backgroundColor:t.colors.SiteMap.AppLauncherBar,borderColor:t.colors.SiteMap.AppLauncherBorder,borderStyle:"solid",borderLeftWidth:0,borderRightWidth:0,borderTopWidth:i?t.sizes.SiteMap.AppLauncherBorder:0,borderBottomWidth:i?0:t.sizes.SiteMap.AppLauncherBorder}}function me(e){return{marginRight:"5px",fontSize:e.fontSizes.Font100,height:e.sizes.Measures.Measure150,width:e.sizes.Measures.Measure100,display:"flex",alignItems:"center",paddingLeft:e.sizes.Measures.Measure050,paddingRight:e.sizes.Measures.Measure050}}function fe(e){return{fontSize:e.fontSizes.Font100,height:e.sizes.Measures.Measure150,display:"inline-block",whiteSpace:"nowrap",overflowX:"hidden",textOverflow:"ellipsis"}}class be extends i.Component{constructor(e){super(e),this._onClickHandler=this._onClickHandler.bind(this)}_onClickHandler(){this.props.skipOpenAppLandingPage||this.props.openAppLandingPage(),this.context.toggleSiteMap()}render(){return i.createElement(n.a,{key:"appLauncherView",style:de(this.props)},i.createElement(m.a,{accessibilityLabel:Object(W.c)(this.props.resourceStrings,P.j),key:"appLauncherButton",onClick:this._onClickHandler,style:Object(_.e)((e=this.props.theme,{height:e.sizes.Measures.Measure300,width:"100%",minHeight:e.sizes.Measures.Measure300,cursor:"pointer",alignItems:"center",backgroundColor:"transparent",color:e.colors.SiteMap.AppLauncherText,borderWidth:0,paddingTop:e.sizes.Measures.Measure075,paddingBottom:e.sizes.Measures.Measure075}),this.props.theme.colors.SiteMap.AreaBarItemActive),testhooks:{id:"sitemap-app-launcher-btn",[O.a.LearningPathDOMAttributeSuffix]:"sitemap-app-launcher-btn"}},i.createElement(F.b,{key:"appLauncherIcon",type:T.a.LeftArrowHead,style:me(this.props.theme)}),i.createElement(y.a,{key:"appLauncherText",style:fe(this.props.theme)},this.props.appName||Object(W.c)(this.props.resourceStrings,P.j))));var e}}be.contextType=ue.b;const ge=Object(a.a)(null,(function(e,t){return{openAppLandingPage:()=>{e(Object(pe.a)())}}}))(be);var ye=s("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Ie extends i.Component{constructor(e){super(e),this._uniqueId=ye.a.newGuid().guid,this._labelId="sitemap-sitemapAreaGroup-group-"+this._uniqueId,this._describeAreaId=this._labelId+"-narrator"}_getGroupTitleStyle(e,t){return{color:e.colors.SiteMap.GroupText,display:"flex",fontSize:e.fontSizes.Font100,fontFamily:e.fontFamilies.Semibold,height:e.sizes.Measures.Measure150,marginTop:e.sizes.Measures.Measure025,marginBottom:e.sizes.Measures.Measure025,alignItems:"center",justifyContent:"flex-start",marginLeft:t?e.sizes.Measures.Measure050:e.sizes.Measures.Measure150,marginRight:t?e.sizes.Measures.Measure150:e.sizes.Measures.Measure050}}_getGroupStyle(e,t){const s={};return t||(s.marginBottom=e.sizes.Measures.Measure175),s}_getInnerListStyle(){return{listStyleType:"none",flexDirection:"column"}}_getTabletInnerListStyle(){return{listStyleType:"none",flexDirection:"column",width:"270px"}}_renderSitemapAreaEntries(){const{sitemapGroup:e,index:t}=this.props,s=0===t;let r=!1;const{toggleSiteMap:n}=this.context;return e.entries.map((e,t)=>e.subActionDescriptor&&!r?(r=!0,i.createElement(Y.a,{key:t,entry:e,toggleSiteMap:n,isTabIndexZero:s&&0===t,describedByElementId:this._describeAreaId})):i.createElement(Y.a,{key:t,entry:e,toggleSiteMap:n,isTabIndexZero:s&&0===t}))}render(){const{sitemapGroup:e,theme:t,isRTL:s,isTablet:r,isLastGroup:n}=this.props,a=e.title,o=r?this._getTabletInnerListStyle():this._getInnerListStyle(),l=this._getGroupStyle(t,n),c=a.replace(" ","");return i.createElement(M.a,{key:"sitemap-sitemapAreaGroup-listItem",style:l},i.createElement(y.a,{key:this._labelId,testhooks:{id:"sitemap-sitemapAreaGroup-"+c},style:this._getGroupTitleStyle(t,s),role:h.r}," ",a),i.createElement(y.a,{key:this._describeAreaId,id:this._describeAreaId,style:{display:"none"},accessibilityLabel:e.narratorTitle||""}," ",e.narratorTitle||""," "),i.createElement(f.a,{key:"sitemap-sitemapAreaGroup-groupList",accessibilityLabel:a,style:o},this._renderSitemapAreaEntries()))}}Ie.contextType=ue.b;var _e=s("69Qu"),Me=s("LzVy"),Oe=s("b8TU");const Se={overflowY:"auto",flexGrow:1};class ve extends i.Component{_renderGroups(){const e=this.props,{entryGroups:t,isRTL:s,isTablet:r}=e;if(!t)return null;const n=t.length;return t.map((t,a)=>i.createElement(Ie,{key:a,sitemapGroup:t,index:a,theme:e.theme,isRTL:s,isLastGroup:a===n-1,isTablet:r}))}componentDidUpdate(e){const t=r.findDOMNode(this);if(t){const e=this.props;this._lastAreaId||e.areaId===this._lastAreaId||(t.scrollTop=0),this._lastAreaId=e.areaId}}render(){return i.createElement(n.a,{style:Se},i.createElement(f.a,{key:d.k,id:d.k,style:(e=this.props,{display:"block",overflowY:"auto",overflowX:"hidden",width:"100%",listStyleType:"none",paddingTop:e.theme.sizes.Measures.Measure150,paddingBottom:e.theme.sizes.Measures.Measure150}),accessibilityLabel:Object(W.c)(this.props.resourceStrings,P.h),role:h.h},this._renderGroups()));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var e}}function Ee(e,t){if(e===t)return!0;if(!e||!t)return!1;if(e.title===t.title){const s=e.subActionDescriptor||null,i=t.subActionDescriptor||null;return JSON.stringify(s)===JSON.stringify(i)}return!1}const we=Object(a.a)(()=>{let e=null,t=null,s=null;return(i,r)=>{const n=Object(_e.b)(i),a=Object(Me.a)(i),o=Object(Oe.c)(i),l=Object(C.a)(i);if(!t||!e||s!==n)return t=r.areaId,s=n,e={entryGroups:Object(J.l)(i,r.areaId),isRTL:Object(N.g)(i),isTablet:a===R.b.Native&&o>l.sizes.Breakpoints.DimensionS},e;let c;if(r.areaId===t){c=Object(J.l)(i,r.areaId);let t=!1;for(let s=0;s<c.length;s++){const i=e.entryGroups.find(e=>e.title===c[s].title);if(!i||c[s].entries.length!==i.entries.length){t=!0;break}for(let e=0;e<c[s].entries.length;e++){if(!Ee(c[s].entries[e],i.entries[e])){t=!0;break}}}if(!t)return e}return t=r.areaId,s=n,e={entryGroups:c||Object(J.l)(i,r.areaId),isRTL:Object(N.g)(i),isTablet:a===R.b.Native&&o>l.sizes.Breakpoints.DimensionS},e}})(ve);var Ae=s("E5IU"),Be=s("EY5k"),ke=s("GYEz"),xe=s("w1eR"),Le=s("RiEM"),je=s("fWyz"),Te=s("4leG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Fe(e,t){return{height:"100%",width:t?"100%":e.sizes.SiteMap.Width,flexDirection:"column",backgroundColor:e.colors.SiteMap.Default,boxShadow:t?"none":e.shadows.Shadow01}}function Re(e,t,s,i,r,n){const a=t!==R.b.Web||i||n?e.sizes.NavBarHeightMobile:e.sizes.NavbarHeight;if((t===R.b.Web||r===xe.a.MailApp)&&!n){const e={top:a,bottom:0};return i||r===xe.a.MailApp?(e.right=0,e.left=0):s?e.right=0:e.left=0,e}return{top:0,bottom:a,left:0,right:0}}function Ne(e){e&&e.focus()}class Ce extends i.Component{constructor(e){super(e),this._closeSiteMap=this._closeSiteMap.bind(this),this._getAppLauncherRef=this._getAppLauncherRef.bind(this),this.selectArea=this.selectArea.bind(this),this.selectAreaNavigatToSubArea=this.selectAreaNavigatToSubArea.bind(this),this.onOutsideClickHandler=this.onOutsideClickHandler.bind(this),this.keyDownHandler=this.keyDownHandler.bind(this),this.state={},P.e.some(t=>!Object(W.c)(e.resourceStrings,t))&&e.retrieveResourceStrings(P.e)}componentDidMount(){this._selectAreaWithNewSitemapState(this.props.siteMap)}componentWillUpdate(e){this._selectAreaWithNewSitemapState(e.siteMap),this.props.areaId!==d.d&&e.areaId===d.d&&this.setState({lastNonMruAreaId:this.props.areaId})}_selectAreaWithNewSitemapState(e){if((!this.state.lastNonMruAreaId||!this.props.areaId)&&e){const t=e.AreaIds&&e.AreaIds[0];t!==this.state.lastNonMruAreaId&&this.setState({lastNonMruAreaId:t}),t&&this.props.selectArea(t)}}_getAppLauncherRef(e){this._appLauncherRef=e}selectArea(e){this.props.areaId!==e&&this.props.selectArea(e)}selectAreaNavigatToSubArea(e,t){if(this.selectArea(e),t||e!==d.d&&this.props.areaId!==d.d){const t=this.props.siteMap&&Object(Le.c)(this.props.siteMap,e);t&&this.props.navigateToSubArea(t)}}_closeSiteMap(){this.props.isOpened&&this.props.toggleSiteMap()}keyDownHandler(e){const t=e.target,s=new l.a(t),i=document.getElementById(d.k),n=document.getElementById(d.f);if(t&&n)switch(Object(u.e)(e.nativeEvent)){case p.a.DownArrow:i&&i.contains(t)&&(Ne(s.getNextSibling()),e.preventDefault());break;case p.a.UpArrow:i.contains(t)&&(Ne(s.getPrevSibling()),e.preventDefault());break;case p.a.RightArrow:n.contains(t)&&Ne(s.getNextSibling());break;case p.a.LeftArrow:n.contains(t)&&Ne(s.getPrevSibling());break;case p.a.Enter:n.contains(t)&&Ne(s.getFirstItemOfEntityNavBar());break;case p.a.Escape:this._closeSiteMap();break;case p.a.Home:i.contains(t)&&Ne(s.getFirstItemOfEntityNavBar());break;case p.a.End:i.contains(t)&&Ne(s.getLastItemofEntityNavBar());break;case p.a.Tab:const a=this.props.platformType===R.b.Web,o=this.props.clientHost===xe.a.MailApp;if(a||o)if(e.shiftKey){if(n.contains(t)){if(this._appLauncherRef){const e=r.findDOMNode(this._appLauncherRef);e&&Ne(e.firstChild)}else Ne(s.getFirstItemOfEntityNavBar());e.preventDefault()}}else if(this._appLauncherRef){const s=r.findDOMNode(this._appLauncherRef);s&&s.contains(t)&&(Object(l.d)(),e.preventDefault())}else i.contains(t)&&(Object(l.d)(),e.preventDefault());else if(e.shiftKey){const s=r.findDOMNode(this._appLauncherRef);s&&s.contains(t)&&(Object(l.d)(),e.preventDefault())}else if(n.contains(t)){const t=r.findDOMNode(this._appLauncherRef);t&&Ne(t.firstChild),e.preventDefault()}break;default:if(i.contains(t)&&e.keyCode>=p.a.A&&e.keyCode<=p.a.Z){const t=e.keyCode-p.a.A,i=String.fromCharCode("a".charCodeAt(0)+t);Ne(s.findNextMatchingListItem(i))}}}componentDidUpdate(e,t){e.areaId&&e.areaId!==this.props.areaId&&this.props.isOpened&&requestAnimationFrame(()=>{Ne((new l.a).getFirstItemOfEntityNavBar())})}onOutsideClickHandler(e){const t=e.target,s=document.getElementById(d.g);t&&!s.contains(t)&&s!==t&&this.props.toggleSiteMap()}_renderQuickLaunchBar(e){return this.props.platformType===R.b.Native||e||this.props.shouldHideSideBar||this.props.isEmbedded?null:i.createElement(he,{key:"quick-launch-bar",siteMap:this.props.siteMap,selectedAreaId:this.props.areaId,lastNonMruAreaId:this.state.lastNonMruAreaId,selectArea:this.selectAreaNavigatToSubArea,theme:this.props.theme,isSiteMapOpen:this.props.isOpened,resourceStrings:this.props.resourceStrings})}_renderSiteMap(e){const{siteMap:t}=this.props,s=this.props.clientHost!==xe.a.MobileApplication,r=this.props.platformType===R.b.Native||e;if(!this.props.isOpened)return null;const a=i.createElement(U,{siteMap:t,platformType:this.props.platformType,theme:this.props.theme,selectedAreaId:this.props.areaId,selectArea:this.selectArea,closeSiteMap:this._closeSiteMap,resourceStrings:this.props.resourceStrings,isAreaBarEmpty:this.props.shouldHideSiteMapItems}),o=this.props.shouldHideSiteMapItems?i.createElement(n.a,{style:{flexGrow:1}}):i.createElement(we,{key:"sitemap-navBar-areaPaneNavBar",areaId:this.props.areaId,theme:this.props.theme,resourceStrings:this.props.resourceStrings}),l=this.props.isEmbedded?null:i.createElement(ge,{appName:this.props.appName,theme:this.props.theme,platformType:this.props.platformType,skipOpenAppLandingPage:this.props.clientHost===xe.a.MailApp,ref:this._getAppLauncherRef,resourceStrings:this.props.resourceStrings});return i.createElement(c.a,{key:"sitemap-navBar-flyout",positionType:"absolute",position:Re(this.props.theme,this.props.platformType,this.props.isRTL,e,this.props.clientHost,this.props.isEmbedded),onOutsideClick:this.onOutsideClickHandler},i.createElement(n.a,{id:d.e,key:d.e,testhooks:{id:"navbar-container"},onKeyDown:this.keyDownHandler,semanticTag:"nav",role:h.p,accessibilityLabel:Object(W.c)(this.props.resourceStrings,P.h),style:Fe(this.props.theme,r)},s?a:l,o,s?l:a))}render(){const e=this.props.theme.sizes.Breakpoints.DimensionS,t=this.props.viewportWidth<=e;return i.createElement(n.a,null,this._renderSiteMap(t),this._renderQuickLaunchBar(t))}}Ce.displayName="NavBar";const De=Object(a.a)((function(){const e=Object(W.h)();return(t,s)=>{const i=Object(o.b)(t),r=Object(Me.a)(t);return{siteMap:i,theme:Object(C.a)(t),platformType:r,resourceStrings:e(t,P.e),isRTL:Object(N.g)(t),appName:Object(Ae.j)(t),viewportWidth:Object(Oe.c)(t),clientHost:Object(ke.a)(t),shouldHideSideBar:Object(ee.b)(t),shouldHideSiteMapItems:Object(ee.c)(t),isEmbedded:Object(Te.c)(t)}}}),(function(e,t){return{retrieveResourceStrings:t=>e(Object(Be.e)(t)),navigateToSubArea:t=>{e(Object(je.c)(t,!1,null))}}}))(Ce)}}]),window.bundleExecutionMarkers["scripts/navbar.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();