(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/OfflineStatusFileDownloadStatusList.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[38],{bEpu:function(e,t,r){"use strict";r.r(t),r.d(t,"OfflineStatusFileDownloadStatusList",(function(){return D}));var o=r("nuS9"),n=r("WziN"),a=r("dD0b"),i=r("RQTs"),l=r("pyUm"),s=r("EZ4w"),c=r("NdUn"),u=r("G0lj"),d=r("pUMQ"),m=r("8f6m"),p=r("2o7a"),w=r("Jcgi");const E=e=>{let t,r;switch(e.statusCode){case m.a:t=d.a.CheckMark,r="#6BB700";break;case m.c:t=d.a.Error,r="#C50F1F";break;case m.e:t=d.a.Warning,r="#323130"}const n=()=>{e.setErrorPopupVisible(!1)};return o.createElement(o.Fragment,null,e.isErrorPopupVisible&&o.createElement(p.a,{title:g(e.entityErrorCode,e.errorLabels),message:f(e.entityErrorCode,e.errorLabels),contentHeight:120,buttons:t=>o.createElement(w.a,{title:e.closeButtonLabel,style:S.popupButton,onPress:()=>t(n)})}),o.createElement(u.a,{role:"cell",style:S.rowItemIcon},t===d.a.Error&&o.createElement(c.b,{icon:t,size:16,color:r,onPress:()=>{e.setErrorPopupVisible(!0)}}),t!==d.a.Error&&o.createElement(c.a,{icon:t,size:16,color:r,type:0})))},b=e=>o.createElement(u.a,{role:"cell",style:S.rowItem},o.createElement(l.a,{style:S.rowItemText},e.text));function g(e,t){switch(e){case"NotEnoughSpace":return t.insufficientStorageErrorTitle;case"ServerError":return t.serviceErrorErrorTitle;case"ConnectionError":return t.networkConnectivityErrorTitle}}function f(e,t){switch(e){case"NotEnoughSpace":return t.insufficientStorageErrorMessage;case"ServerError":return t.serviceErrorErrorMessage;case"ConnectionError":return t.networkConnectivityErrorMessage}}const S=s.a.create({row:{flexDirection:"row",marginBottom:8,paddingBottom:8,borderBottomWidth:1,borderBottomColor:"#D8D8D8"},rowItem:{flex:6,flexDirection:"column",alignSelf:"stretch",minWidth:0,paddingRight:5},rowItemText:{fontSize:14,color:"#333333",lineHeight:16},summaryLineLabel:{paddingLeft:20,paddingRight:20,fontSize:20},rowItemIcon:{flexDirection:"row",flex:1},popupButton:{alignSelf:"flex-end",height:30,paddingRight:25,paddingLeft:25}}),y=o.memo((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function({entityName:e,progress:t,status:r,entityErrorCode:n,entityErrorCount:a,globalStatus:i,statusLabels:l,errorLabels:s,closeButtonLabel:c}){const{downloadStatusString:d,iconCode:p}=function(e,t,r,o){if(t>0)return{downloadStatusString:o.error,iconCode:m.c};switch(e){case m.a:return{downloadStatusString:o.completed,iconCode:m.a};case m.b:return{downloadStatusString:o.downloading,iconCode:m.b};case m.f:return r===m.e?{downloadStatusString:o.suspended,iconCode:m.e}:{downloadStatusString:o.pending,iconCode:m.b};default:return{downloadStatusString:o.error,iconCode:m.c}}}(r,a,i,l),[w,g]=o.useState(!1);return o.createElement(u.a,{role:"row",style:S.row,key:e},o.createElement(b,{text:e}),o.createElement(b,{text:t}),o.createElement(E,{entityErrorCode:n,statusCode:p,isErrorPopupVisible:w,errorLabels:s,closeButtonLabel:c,setErrorPopupVisible:g}),o.createElement(b,{text:d}))}));const h=e=>o.createElement(u.a,{role:"columnheader",style:"icon_header"!==e.text?L.headerRowItem:L.iconHeaderItem},o.createElement(l.a,{style:L.headerRowItemText,numberOfLines:1,ellipsizeMode:"tail"},"icon_header"!==e.text?e.text:"")),L=s.a.create({table:{flexShrink:1},headerRowGroup:{flexDirection:"row",marginBottom:6,paddingBottom:6,borderBottomWidth:1,borderBottomColor:"#D8D8D8"},headerRowItem:{flex:6,alignSelf:"stretch"},iconHeaderItem:{flex:1,alignSelf:"stretch"},headerRowItemText:{fontSize:12,lineHeight:14,color:"#666666"},entitiesRowGroup:{flexShrink:1,overflowY:"auto"}}),x=o.memo((function({headerLabels:e,data:t,statusLabels:r,errorLabels:n,closeButtonLabel:a}){return o.createElement(u.a,{role:"table",style:L.table},o.createElement(u.a,{role:"rowgroup"},o.createElement(u.a,{role:"row",style:L.headerRowGroup},o.createElement(h,{text:e.entity}),o.createElement(h,{text:e.progress}),o.createElement(h,{text:"icon_header"}),o.createElement(h,{text:e.status}))),o.createElement(u.a,{role:"rowgroup",style:L.entitiesRowGroup},t.entities.map(e=>o.createElement(y,{key:e.entityName,entityName:e.entityName,progress:`${e.downloadedFileCount}/${e.totalFileCount}`,status:e.downloadStatus,entityErrorCode:e.errorCode,entityErrorCount:e.totalErrorCount,globalStatus:t.totalProgress,statusLabels:r,errorLabels:n,closeButtonLabel:a}))))}));function C(e,t){switch(e){case m.a:return t>0?d.a.Error:d.a.CheckMark;case m.e:return d.a.Warning;case m.c:return d.a.Error}}const B=s.a.create({container:{flexDirection:"column",flexGrow:0,flexShrink:1,flexBasis:"auto"},summaryLine:{flexDirection:"row",paddingTop:15,paddingBottom:10,alignItems:"center"},summaryLineLabel:{paddingLeft:13,paddingRight:13,flex:1,fontSize:16},collapseButton:{alignContent:"flex-end"}}),D=o.memo((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function({isCollapsedDefault:e,data:t,listHeaderLabels:r,headerLabels:s,statusLabels:u,errorLabels:p,closeButtonLabel:w}){const[E,b]=o.useState(e),g=o.useCallback(()=>b(!E),[E]),f=t.totalProgress,S=f===m.b?String.format(r.downloadedFileCount,t.downloadedFileCount.toString(),t.totalFileCount.toString()):String.format(r.availableFileCount,t.downloadedFileCount.toString()),y=t.totalErrorCount;return o.createElement(n.a,{style:[B.container,{minHeight:E?"46px":"150px"}]},o.createElement(a.a,{style:B.summaryLine,onPress:g,accessibilityRole:"button","aria-expanded":!E,"aria-haspopup":"true","aria-label":S},f===m.b?o.createElement(i.a,{size:"small",color:"#A8A8AC",accessibilityComponentType:"none",style:[{transform:[{scale:.8}]}]}):o.createElement(c.a,{icon:C(f,y),size:B.summaryLineLabel.fontSize,color:"#000000",type:0}),o.createElement(l.a,{style:B.summaryLineLabel,numberOfLines:1,ellipsizeMode:"tail"},S),o.createElement(n.a,{style:B.collapseButton},o.createElement(c.a,{icon:E?d.a.DropdownArrow:d.a.ChevronUp,size:B.summaryLineLabel.fontSize,color:"#333333",type:0}))),!E&&o.createElement(x,{headerLabels:s,data:t,statusLabels:u,errorLabels:p,closeButtonLabel:w}))}))}}]),window.bundleExecutionMarkers["scripts/OfflineStatusFileDownloadStatusList.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();