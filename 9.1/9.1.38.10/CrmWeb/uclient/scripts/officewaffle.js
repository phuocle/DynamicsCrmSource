(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/officewaffle.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[91],{"7Xh3":function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return O}));var s=n("nuS9"),a=n("uTTW"),r=n("S6oQ"),i=n("u+q+"),o=n("37s6"),c=n("69Qu"),l=n("NjDY"),f=n("UwOy"),u=n("IqkD"),h=n("NvOS");var d=n("QBtP"),p=n("bK23"),b=n("4N6w"),g=n("Lyxw"),m=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function v(e){return s.createElement(w,{imgSrc:e.source,render:t=>s.createElement(r.a,Object.assign({focusable:"false"},e,{source:t,altText:e.altText}))})}function O(e){return s.createElement(w,{imgSrc:e.source,render:t=>s.createElement(a.a,Object.assign({},e,{source:t,altText:e.altText}))})}function w({imgSrc:e,render:t}){const n=s.useContext(d.a).AssetLoader,[a,r]=s.useState(e);let v;const O=function(e,t){return Object(i.d)(n=>
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,n){const s=Object(o.w)(e),a=!Object(c.b)(e),r=Object(l.t)(e),i=Object(f.d)(e);return(s&&a||i)&&function(e,t="",n){const s="$webresource:",a="/webresources/",r=t.toLowerCase();return r.startsWith(s)?(n(t.substr(s.length)),!0):r.startsWith(a)?(n(t.substr(a.length)),!0):!!r.startsWith(e)&&(n(t.substr(e.length)),!0)}(r,t,n)}(n,e,t))}(e,e=>v=e),w=function(e){return Object(i.d)(t=>function(e,t){var n;if((null===(n=Object(u.w)(e))||void 0===n?void 0:n.usePathBasedUrls)&&t.toLowerCase().startsWith("/webresources/"))return Object(h.a)(e,t)}(t,e))}(e),_=Object(i.d)(e=>Object(g.b)(e,m.b)),W=Object(i.d)(b.a);return s.useEffect(()=>{O?n.loadOfflineWebResource(v).then(e=>{e&&r(p.a.createDataUri(p.b.Svg,e).toString())}):r(w||e)},[O,w,e,v,n]),t(a,_&&W)}},fPgq:function(e,t,n){"use strict";n.r(t),n.d(t,"OfficeWaffle",(function(){return L}));var s=n("nuS9"),a=n("evW+"),r=n("H/hG"),i=n("znb3"),o=n("XIN1"),c=n("u+q+"),l=n("unFF"),f=n("YWpA"),u=n("nJrx"),h=n("q43A"),d=n("3rse"),p=n("EY5k"),b=n("YxC/"),g=n("d4He"),m=n("Lyxw"),v=n("NjDY"),O=n("IqkD");var w=n("QBtP"),_=n("hEjd"),W=n("GWSs"),T=n("VnpK"),j=n("j+uO"),E=n("tJ+6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const S=Object(u.a)(),C=Object(u.a)(),x=Object(u.a)(),y=Object(u.a)(),k="Web.NavBar.AppSwitcher_Caption",H=[k];function M(e,t){const{backgroundColor:n,backgroundHoverColor:s}=function(e){const t=e.isPowerappsThemeEnabled,n=t?e.theme.colors.NavBar.NavBar1.Fill:"#00b7c3",s=t?e.theme.colors.NavBar.NavBar2.Fill:"#006e75";return{backgroundColor:n,backgroundHoverColor:s}}(e);return Object(h.e)({cursor:"pointer",borderWidth:0,backgroundColor:t?"#333333":n,width:e.theme.sizes.NavbarHeight,height:e.theme.sizes.NavbarHeight,display:"flex",alignItems:"center",justifyContent:"center",":focus":Object(h.d)(e.theme,e.designLanguage)},s)}const D={color:"#FFF",fontSize:"16px",width:"100%",textAlign:"center"};class I extends s.Component{constructor(e,t){super(e),this._waffleToggleTimer=null,this._isOfficeDataLoaded=!1,this._keyDownHandler=this._keyDownHandler.bind(this),this._onMouseEnterHandler=this._onMouseEnterHandler.bind(this),this._onMouseLeaveHandler=this._onMouseLeaveHandler.bind(this),this._clearWaffleTimer=this._clearWaffleTimer.bind(this),this._onClickHandler=this._onClickHandler.bind(this),this._activateWaffle=this._activateWaffle.bind(this),this._deactivateWaffle=this._deactivateWaffle.bind(this),this._eventManager=t.EventManager,this.state={isWidgetOpen:!1},Object(b.c)(e.resourceStrings,k)||e.retrieveResourceStrings(H)}componentDidMount(){this.props.isOfficeWaffleFCBEnabled&&this._loadOfficeData().then(e=>{try{const t=e&&JSON.parse(e);if(t)return this.context.AssetLoader.loadScript(t.js).then(()=>{var e,n,s;e=t.navBarData,n=this._deactivateWaffle,s=this.props.setUserCultureInfo,window.O365Shell.SetData(JSON.parse(e)),window.O365Shell.RenderAsync({launcher:C,switcher:S},()=>{s()},()=>{if(n){const e=document.getElementsByClassName("o365cs-nav-closeButton");e&&e.length&&e.item(0).addEventListener("click",()=>{n()})}}),this._isOfficeDataLoaded=!0});throw new Error("Failed to parse officeWaffleDataString")}catch(t){const n=[{name:"OfficeWaffleDataString",value:e}];this.context.EventManager.ReportComponentFailure("OfficeWaffle",t,void 0,n)}}).catch(e=>{const t=[];t.push({name:"Status",value:e.status}),t.push({name:"StatusText",value:e.statusText}),t.push({name:"ResponseText",value:e.responseText}),this.context.EventManager.ReportComponentFailure("OfficeWaffle",e,void 0,t)})}_loadOfficeData(){return new Promise((e,t)=>{const n=new XMLHttpRequest;n.onreadystatechange=()=>{n.readyState===XMLHttpRequest.DONE&&(200===n.status?e(n.responseText):t({statusText:n.statusText,status:n.status,responseText:n.responseText}))},n.open("GET","/Handlers/OfficeWaffleInfo.ashx",!0),n.send()})}_deactivateWaffle(){this.setState({isWidgetOpen:!1})}_activateWaffle(){this.setState({isWidgetOpen:!0})}_onClickHandler(){this._isOfficeDataLoaded?this.state.isWidgetOpen?(this._deactivateWaffle(),this._eventManager.ReportComponentSuccess("OfficeWaffle.Hide")):(this._activateWaffle(),this._eventManager.ReportComponentSuccess("OfficeWaffle.Show")):this.props.officePortalUrl?(this.props.openUrl(this.props.officePortalUrl),this._eventManager.ReportComponentSuccess("OfficeWaffle.NavigateOfficePortal.SiteWide")):(this.props.openUrl("https://go.microsoft.com/fwlink/?LinkID=246804"),this._eventManager.ReportComponentSuccess("OfficeWaffle.NavigateOfficePortal"))}_clearWaffleTimer(){this._waffleToggleTimer&&(clearTimeout(this._waffleToggleTimer),this._waffleToggleTimer=null)}_startWaffleTimer(e){null===this._waffleToggleTimer&&(this._waffleToggleTimer=setTimeout(()=>{this._waffleToggleTimer=null,this._waffleActive?this._startWaffleTimer(e):this._deactivateWaffle()},e))}_onMouseLeaveHandler(){this._waffleActive=!1,this._startWaffleTimer(500)}_onMouseEnterHandler(){this._clearWaffleTimer(),this._waffleActive=!0}_keyDownHandler(e){if(e.keyCode===d.a.Escape){this._deactivateWaffle();const e=document.getElementById(y);e&&e.focus()}}_renderOfficeWaffle(e){const t={width:"1.143rem",height:"1.286rem"},n=Object.assign(Object.assign({},D),e?t:{});let a;return a=e?s.createElement(j.a,{source:_.a,style:t,highContrast:this.props.isHighContrast,invert:!0}):s.createElement(o.b,{type:i.a.OfficeWaffle}),s.createElement(r.a,{style:n},a)}render(){const e=Object(b.c)(this.props.resourceStrings,k);return s.createElement(f.a,{onMouseLeave:this._onMouseLeaveHandler,onMouseEnter:this._onMouseEnterHandler,onKeyDown:this._keyDownHandler},s.createElement(a.a,{key:"button",id:y,testhooks:{id:"officewaffle"},style:M(this.props,this.state.isWidgetOpen),title:e,accessibilityLabel:e,onClick:this._onClickHandler},this._renderOfficeWaffle(this.props.isPowerappsThemeEnabled)),s.createElement(f.a,{key:"widget",id:x,style:(t=this.state.isWidgetOpen,{display:"block",position:"absolute",top:0,zIndex:2567,transition:`visibility 0s linear ${t?0:.5}s,opacity 0.5s linear`,visibility:t?"visible":"hidden",opacity:t?1:0})},s.createElement(f.a,{id:S},s.createElement(f.a,{id:C}))));var t}}I.contextType=w.a;const L=Object(c.a)((function(){const e=Object(b.h)();return t=>{const n=Object(l.a)(t),s=Object(E.b)(t)?Object(E.a)(t):null,a=e(t,H),r=Object(v.D)(t);return{theme:n,designLanguage:s,resourceStrings:a,isOfficeWaffleFCBEnabled:Object(m.b)(t,"OfficeWaffleMenu"),officePortalUrl:r,isPowerappsThemeEnabled:Object(W.h)(t),isHighContrast:Object(T.n)()}}}),(function(e){return{retrieveResourceStrings:t=>e(Object(p.e)(t)),openUrl:t=>{e(Object(g.a)(t))},setUserCultureInfo:()=>{e({type:"set.user.culture.info",sync:!0,execute(e,t){try{const n=Object(O.w)(e.getState());if(!n)throw new Error("user Settings are not defined");const{formatInfoCultureName:s,numberFormatInfo:a,dateFormatInfo:r}=n;t.DataSource.setCurrentCultureInfo(s,a,r),t.EventManager.ReportComponentSuccess("SetUserCultureInfo",[{name:"formatInfoCultureName",value:s}])}catch(e){t.EventManager.ReportComponentFailure("SetUserCultureInfo",e)}}})}}}))(I)},hEjd:function(e,t,n){"use strict";t.a=n.p+"resources/images/OfficeWaffle.svg?v=1.4.9962-v91onpremise"},"j+uO":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var s=n("nuS9"),a=n("H4dV"),r=n("7Xh3");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e){const{source:t,style:n}=e;if(a.a.getInstance().get_IsBrowserIE()&&!e.useImgInIE||e.highContrast){const a=Object.assign(Object.assign(Object.assign({},n),e.invert?{fill:"white"}:{}),e.highContrast?{fill:"windowText"}:{});return s.createElement(r.b,{source:t,style:a,fallbackToImage:!0,title:e.title,role:e.role,altText:e.altText})}const i=Object.assign(Object.assign({},n),e.invert?{filter:"invert(100%)"}:{});return s.createElement(r.a,{source:t,style:i,title:e.title,role:e.role,altText:e.altText})}}}]),window.bundleExecutionMarkers["scripts/officewaffle.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();