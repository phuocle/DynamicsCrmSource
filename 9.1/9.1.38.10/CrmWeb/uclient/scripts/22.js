(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/22.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[22,69],{"28qD":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="offline.set.entity.plural.name";function a(e){return{type:i,payload:{entityPluralName:e}}}},"3bXk":function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n("QSjj"),a=n("TBkx"),r=n("iZ7K"),o=n("sZ+8"),c=n("504W"),s=n("Nzmy"),l=n("FZDd");function f(e,t){return{type:"offline.disabled.info",execute({dispatch:n,getState:f},u){if(Object(c.a)(e))return Promise.resolve();const b=[];for(const t of e)b.push(n(Object(l.f)(t,!1,null)));return Promise.all(b).then(()=>{const a=f(),l=[],u=Object(o.g)(a);for(const t of e){const e=Object(r.h)(a,t);Object(c.a)(e)||Object(c.a)(e.EntityLogicalName)||Object(c.a)(u)||Object(c.a)(u[e.EntityLogicalName])||l.push(e.EntityLogicalName)}return s.c.warn("Offline.createOfflineDisabledInfoUpdateAction: Primary entities disabled for offline, entities are not in primary available entities or we don't have metadata: "+l.toString()),n(Object(i.b)(e,t,l)),Promise.resolve()}).catch(e=>(s.c.error("Offline: offlineDisabledUpdateInfoAsyncAction: createOfflineDisabledInfoUpdateAction: failed with error "+Object(a.e)(e)),Promise.reject(e)))}}}},"6u68":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));var i=n("/D1P");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="offline.upsync.pending";function r(){const e={upSyncStatus:i.a.Pending};return{type:a,payload:e}}},"9bCE":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="offline.database.cleanup";function a(e){return{type:i,payload:{isDbCleanupNeeded:e}}}},"Eh/Y":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="offline.database.update";function a(e){return{type:i,payload:{existingDatabaseName:e}}}},GLaK:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="set.user.offline.status";function a(e){return{type:i,payload:{isUserSelectOffline:e}}}},GUh4:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="offline.set.client.version";function a(e){return{type:i,payload:{clientVersion:e}}}},Nt68:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var i;n.d(t,"a",(function(){return i})),function(e){e.LogicalName="LogicalName",e.Id="id",e.Reference="@",e.NullString="null",e.GuidString="@GUID",e.CommandString="Command",e.CommandOperationString="CommandOperation",e.DotSeperator=".",e.CommaSeperator=",",e.DefaultIndex=0,e.FirstIndex=1,e.NegatedReference="!@",e.DateTimeNowString="@DateTime.Now",e.OppCloseDateString="@OpportunityClose.actualend",e.CreateStep="Create",e.RetrieveStep="Retrieve",e.UpdateStep="Update",e.DeleteStep="Delete",e.SetValueStep="SetValue",e.ConditionStep="Condition",e.FailureStep="Failure",e.ActivityString="activity",e.BusinessProcessFlowInstance="businessprocessflowinstance",e.OfflineData="OfflineData",e.tag="tag",e.OfflinePlayback="offlinePlayback",e.OfflinePlaybackUrlParameter="?"+e.tag+"="+e.OfflinePlayback}(i||(i={}))},QSjj:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="offline.disabled.entities.update";function a(e,t,n){return{type:i,payload:{offlineDisabledEntities:e,lastMetadataVersionUsedForValidation:t,offlineDisabledPrimaryEntities:n}}}},VKvO:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));var i=n("/D1P");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="offline.upsync.completed";function r(){const e={upSyncStatus:i.a.Completed};return{type:a,payload:e}}},"e+ib":function(e,t,n){"use strict";n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return d}));var i=n("8Mff"),a=n("9bCE"),r=n("Rj8P"),o=n("qjwL"),c=n("Nzmy"),s=n("eZ32"),l=n("8CLP");var f=n("kQA8"),u=n("37s6"),b=n("69Qu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const O="offline.opt.status";function d(e){return{type:"offline.opt.status.save",execute({dispatch:t,getState:n}){const O=n(),d=Object(u.p)(O)===i.a.Enabled;if(e!==d)if(e)t(p(i.a.Enabled));else{if(!Object(b.b)(O))return t(Object(f.a)("Settings_Offline_DisableSync_Information_Message",void 0));!
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){e(Object(a.b)(!0)),e(p(i.a.Disabled)),c.c.info("Offline: OfflineDisable: disableOffline: The offline feature status is disabled"),e(Object(r.c)(s.a.NotAvailable,l.a.None)),c.c.info("Offline: OfflineDisable: disableOffline: The offline status is set to "+s.a.NotAvailable),e(Object(o.b)(!0)),c.c.info("Offline: offlineDisable: disableOffline: Completed")}(t)}return Promise.resolve()}}}function p(e){return{type:O,payload:{offlineFeatureStatus:e}}}},iEoY:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="offline.fcb.set";function a(e){return{type:i,payload:{isMocaOfflineFeatureEnabled:e}}}},iOI1:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="offline.available.primary.entities.update";function a(e){return{type:i,payload:{offlineAvailablePrimaryEntities:e}}}},"j/Rx":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="offline.is.trial.organization.set";function a(e){return{type:i,payload:{isTrialOrganization:e}}}},kQA8:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n("TBkx"),a=n("YxC/"),r=n("69Qu"),o=n("Nzmy"),c=n("EY5k"),s=n("si7p"),l=n("pgSX");function f(e,t){return{type:"offline.alert.dialog.async",execute({dispatch:n,getState:f},u){if(Object(r.b)(f()))return o.c.info("Offline: Server is available"),Promise.resolve();const b=["Dialog_Button_Ok",e];return n(Object(c.e)(b)).then(()=>{const r=Object(a.b)(f(),"Dialog_Button_Ok"),c=Object(a.b)(f(),e);return n(Object(l.a)(s.a,c,null,r,null,void 0,void 0,void 0,void 0,void 0,t)).then(e=>0===e.status?(o.c.info("Offline: Alert dialog is created successfully with message "+c),Promise.resolve()):(o.c.error("Offline: Error in Sync error dialog creation "+Object(i.e)(e.error)),Promise.reject(e.error)))}).catch(e=>(o.c.error("Offline: Error in alert dialog creation "+Object(i.e)(e)),Promise.reject(e)))}}}},nr11:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="offline.norsync.server.connection.string.set";function a(e){return{type:i,payload:{norsyncServerConnectionString:e}}}},qjwL:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="offline.set.reinitializeoffline";function a(e){return{type:i,payload:{reInitializeOffline:e}}}},t9aj:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="offline.first.time.sync.completed";function a(e){return{type:i,payload:{isOfflineFirstTimeSyncCompleted:e}}}},vWyY:function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var i=n("yRo8"),a=n("Eh/Y"),r=n("3bXk"),o=n("28qD"),c=n("iEoY"),s=n("j/Rx"),l=n("e+ib"),f=n("iOI1"),u=n("wTHG"),b=n("nr11"),O=n("TBkx"),d=n("SAYH"),p=n("504W"),y=n("Nzmy"),j=n("+5Bq"),S=n("ml6Y"),m=n("Py/t"),v=n("o1og"),g=n("t9aj"),D=n("iF9X"),h=n("8Mff"),_=n("GUh4"),P=n("GLaK"),w=n("Lyxw"),E=n("3/02");function C(){return{type:"offline.retrieve.sessionstate",execute({dispatch:e,getState:t},n){const C=[],I=t(),K=Object(D.e)(I),F=Object(w.c)(I,E.je);let T,U,A,M,N;return C.push(n.DataSource.retrieveSessionState(S.a.isMobileOfflineOptedInKey)),C.push(n.DataSource.retrieveSessionState(S.a.OfflineProfileDataKey)),C.push(n.DataSource.retrieveSessionState(S.a.offlineDatabaseInformationKey)),C.push(n.DataSource.retrieveSessionState(S.a.OfflineDatabaseKey)),C.push(n.DataSource.retrieveSessionState(S.a.OfflinePrimaryAvailableEntitiesKey)),C.push(n.DataSource.retrieveSessionState(S.a.OfflineEntityPluralNamesKey)),C.push(n.DataSource.retrieveSessionState(i.a)),C.push(n.DataSource.retrieveSessionState(i.d)),C.push(n.DataSource.retrieveSessionState(i.c)),C.push(n.DataSource.retrieveSessionState(S.a.OfflineDisabledInfoKey)),K&&(C.push(n.DataSource.retrieveSessionState(S.a.OfflineApplyApplicationMetadataChangesKey)),T=C.length-1,C.push(n.DataSource.retrieveSessionState(S.a.ClientVersionKey)),U=C.length-1,C.push(n.DataSource.retrieveSessionState(S.a.IsOfflineFirstTimeSyncCompletedKey)),A=C.length-1,C.push(n.DataSource.retrieveSessionState(S.a.IsFirstApplyApplicationMetadataChangesDoneKey)),M=C.length-1),F&&(C.push(n.DataSource.retrieveSessionState(S.a.IsUserSelectOffline)),N=C.length-1),Promise.all(C).then(t=>{const O=Object(p.a)(t[0])?null:t[0],D=Object(p.a)(t[1])?null:t[1],w=Object(p.a)(t[2])?null:t[2],E=Object(p.a)(t[3])?null:t[3],C=Object(p.a)(t[4])?null:t[4],I=Object(p.a)(t[5])?null:t[5],x=Object(p.a)(t[6])?null:t[6],k=Object(p.a)(t[7])?null:t[7],L=Object(p.a)(t[8])?null:t[8],R=Object(p.a)(t[9])?null:t[9],V=Object(p.a)(O)||Object(p.a)(O[S.a.isMobileOfflineOptedInKey])?h.a.Default:parseInt(O[S.a.isMobileOfflineOptedInKey],10),B=Object(p.a)(D)||Object(p.a)(D[S.a.OfflineProfileIdKey])?d.a.EMPTY:d.a.parse(D[S.a.OfflineProfileIdKey]),z=Object(p.a)(D)||Object(p.a)(D[S.a.OfflineProfileVersionKey])?"":D[S.a.OfflineProfileVersionKey],H=Object(p.a)(D)||Object(p.a)(D[S.a.OfflineProfileAvailableEntitiesKey])?null:D[S.a.OfflineProfileAvailableEntitiesKey],Y=Object(p.a)(w)||Object(p.a)(w[S.a.norsyncServerConnectionStringKey])?"":w[S.a.norsyncServerConnectionStringKey],G=!Object(p.a)(w)&&!Object(p.a)(w[S.a.isTrialOrganizationKey])&&w[S.a.isTrialOrganizationKey],q=!(!Object(p.a)(w)&&!Object(p.a)(w[S.a.isMocaOfflineFCBEnabledKey]))||Object(j.a)(w[S.a.isMocaOfflineFCBEnabledKey]),Q=Object(p.a)(E)||Object(p.a)(E[S.a.OfflineDatabaseKey])?"":E[S.a.OfflineDatabaseKey],W=Object(p.a)(R)||Object(p.a)(R[S.a.OfflineDisabledEntitiesKey])?null:R[S.a.OfflineDisabledEntitiesKey],X=Object(p.a)(R)||Object(p.a)(R[S.a.MetadataVersionUsedKey])?null:R[S.a.MetadataVersionUsedKey],Z=Object(p.a)(k)||Object(p.a)(k[i.d])?null:k[i.d],J=!Object(p.a)(L)&&!Object(p.a)(L[i.c])&&L[i.c];if(F){const i=Object(p.a)(t[N])?null:t[N],a=!Object(p.a)(i)&&!Object(p.a)(i[S.a.IsUserSelectOffline])&&i[S.a.IsUserSelectOffline];a&&(y.c.warn("offlineUpdateStateTreeFromSessionState:Setting IsServerAvailable= false as user selected to work in offline mode"),n.DataSource.set_IsServerAvailable(!1)),e(Object(P.b)(a))}if(e(Object(l.b)(V)),e(Object(u.b)(B,z,H)),e(Object(b.b)(Y)),e(Object(s.b)(G)),e(Object(c.b)(q)),e(Object(a.b)(Q)),e(Object(f.b)(C)),e(Object(r.a)(W,X)),e(Object(o.b)(I)),e(Object(m.b)(x)),e(Object(i.i)({syncStatus:Z,metadataAvailable:J})),K){const n=Object(p.a)(t[T])?null:t[T],i=!Object(p.a)(n)&&!Object(p.a)(n[S.a.OfflineApplyApplicationMetadataChangesKey])&&n[S.a.OfflineApplyApplicationMetadataChangesKey];e(Object(v.d)(i));const a=Object(p.a)(t[U])?null:t[U],r=Object(p.a)(a)||Object(p.a)(a[S.a.ClientVersionKey])?"":a[S.a.ClientVersionKey];e(Object(_.b)(r));const o=Object(p.a)(t[A])?null:t[A],c=!Object(p.a)(o)&&!Object(p.a)(o[S.a.IsOfflineFirstTimeSyncCompletedKey])&&o[S.a.IsOfflineFirstTimeSyncCompletedKey];e(Object(g.b)(c));const s=Object(p.a)(t[M])?null:t[M],l=!Object(p.a)(s)&&!Object(p.a)(s[S.a.IsFirstApplyApplicationMetadataChangesDoneKey])&&s[S.a.IsFirstApplyApplicationMetadataChangesDoneKey];e(Object(v.f)(l))}return y.c.info("Offline: offlineUpdateStateTreeFromSessionState: RetrieveMobileofflineInformation: Success"),Promise.resolve(!0)}).catch(e=>(y.c.error("Offline: offlineUpdateStateTreeFromSessionState: RetrieveMobileofflineInformation: Failed"+Object(O.e)(e)),Promise.reject(e)))}}}},wTHG:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="offline.profile.set";function a(e,t,n){return{type:i,payload:{profileId:e,profileVersion:t,profileAvailableEntities:n}}}},wje5:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));var i=n("/D1P");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="offline.upsync.start";function r(){const e={upSyncStatus:i.a.InProgress};return{type:a,payload:e}}},zmAS:function(e,t,n){"use strict";n.r(t),n.d(t,"OFFLINE_UPSYNC_HANDLE_ACTION",(function(){return _})),n.d(t,"initializeOfflineUpsyncProcessAsyncAction",(function(){return w}));var i=n("6u68"),a=n("TBkx"),r=n("YxC/"),o=n("Nzmy"),c=n("0uKS"),s=n("pgSX"),l=n("tICD"),f=n("EY5k"),u=n("si7p"),b=n("vONk"),O=n("504W");var d=n("wje5"),p=n("VKvO"),y=n("ybGo"),j=n("/D1P"),S=n("umme"),m=n("bvqZ"),v=n("Lyxw"),g=n("3/02"),D=n("xM/W"),h=n("6fj+");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const _="offline.upsync.process.async";let P=null;function w(e=!1){return{type:_,async execute({dispatch:t,getState:n},m){const v=Object(y.b)(n());if(!e&&v===j.a.Completed)return Promise.resolve();if(null!=P)await P;else try{await(P=async function(e,t,n){const y=new Date,j="Offline: Upsync";try{if(await n.OfflineProvider.hasItemsToUpsync().nativePromise()){o.c.info("OFFLINE : OfflineUpsyncHandler : Has Items To Upsync"),t(Object(d.b)());try{const i=await n.OfflineProvider.startPlayback().nativePromise();return t(Object(p.b)()),Object(O.a)(i)||0!==i.get_errorCount()?(o.c.warn("OFFLINE : OfflineUpsyncHandler : Upsync done with conflict"),t((S=String(i.get_lastSuccessfulSaveOnCrm()),{type:"offline.syncerror.dialog.async",execute({dispatch:e,getState:t},n){const i=["L_Show_Details_Text","Sync_Status_Error_Message","L_Last_Save_To_CRM_Server_Text","Sync_Status_Dialog_Title","Dialog_Button_Ok"];return e(Object(f.e)(i)).then(()=>{const n=Object(r.e)(t(),i),f=Object(r.c)(n,"L_Show_Details_Text"),d=Object(r.c)(n,"Sync_Status_Error_Message"),p=Object(r.c)(n,"L_Last_Save_To_CRM_Server_Text"),y=Object(r.c)(n,"Sync_Status_Dialog_Title"),j=Object(r.c)(n,"Dialog_Button_Ok"),m=d+"\n"+p;let v="";return v=Object(O.b)(b.a.get_OverallSyncErrorMessage())?m.replace("{0}",S):b.a.get_OverallSyncErrorMessage(),e(Object(s.a)(u.c,v,{},f,y,"",j)).then(t=>0===t.status?e(Object(l.a)(t.pageId)).then(n=>{n.value.confirmed&&e(Object(c.a)("syncerror",t.pageId,null,null,null,null,null))}):(o.c.error("Offline: Error in Sync error dialog creation "+Object(a.e)(t.error)),Promise.reject(t.error)))}).catch(e=>(o.c.error("Offline: Error in Sync error dialog creation "+Object(a.e)(e)),Promise.reject(e)))}}))):(await E(e,t),o.c.info("OFFLINE : OfflineUpsyncHandler : Upsync done without conflict")),n.EventManager.ReportComponentSuccess(j),void n.EventManager.ReportComponentPerformance(j,"Time Taken in ms",+new Date-+y)}catch(e){return o.c.error("OFFLINE : OfflineUpsyncHandler : Upsync Error"),t(Object(i.b)()),n.EventManager.ReportComponentFailure(j,e),n.EventManager.ReportComponentPerformance(j,"Time Taken in ms",+new Date-+y),Promise.reject(e)}}o.c.info("OFFLINE : OfflineUpsyncHandler : Upsync has no items to sync"),t(Object(p.b)()),await E(e,t)}catch(e){return o.c.error("OFFLINE : OfflineUpsyncHandler : hasItemsToUpsync Handler Failed"),Promise.reject(e)}var S}(n,t,m))}catch(e){if(!(e instanceof S.a)){const t=(null==e?void 0:e.message)||"Unexpected upsync error";e=S.a.FromMessage(t)}throw e}finally{P=null}}}}async function E(e,t){if(Object(v.c)(e(),g.l)&&Object(h.e)(e())){const n=["offline_notification_reconnect_success_text"];await t(Object(f.e)(n));const i={id:"upsync_complete_toast",level:1,message:Object(r.b)(e(),n[0]),title:null,type:1,onCloseHandler:null};t(Object(D.b)(!1)),t(Object(m.b)(i))}}}}]),window.bundleExecutionMarkers["scripts/22.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();