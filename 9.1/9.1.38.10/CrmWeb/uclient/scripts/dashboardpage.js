(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/dashboardpage.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[56],{"+Ljw":function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"c",(function(){return c})),r.d(t,"b",(function(){return l}));var n=r("SAYH"),a=r("jq7Z"),i=r("arV0"),s=r("y60j");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t,r=!1){var n;const{entityTypeName:o}=Object(i.g)(e,t),c=Object(s.n)(e,o);if(!r)return c;const l=Object(a.a)(e,t),u=null===(n=null==l?void 0:l.formSelector)||void 0===n?void 0:n.forms;let d=c;if(u&&Object.keys(u).length>0){d=new Object;for(const e in c)u[e]&&!u[e].visible||(d[e]=c[e])}return d}function c(e,t,r){var o,c;const l=Object(a.a)(e,t),u=n.a.toString(r);if(null===(c=null===(o=null==l?void 0:l.formSelector)||void 0===o?void 0:o.forms)||void 0===c?void 0:c[u])return l.formSelector.forms[u].visible;const{entityTypeName:d}=Object(i.g)(e,t);return!!Object(s.m)(e,d,r)||null}function l(e,t){var r;const n=Object(a.a)(e,t);return null===(r=null==n?void 0:n.formSelector)||void 0===r?void 0:r.selectedFormId}},"+Vem":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n="form.referenceinformationbyrelationship";function a(e,t){return{type:n,payload:t,meta:{pageId:e}}}},"+aj2":function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return a}));var n=r("bq0x");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="quickCreateForm.output";function i(e,t){return{type:"quickCreateForm.output.async",execute({dispatch:r,getState:i}){const s=Object(n.a)(i(),e)||[];return s.push(t),r(function(e,t){return{type:a,payload:{reason:"close",value:t},meta:{pageId:e}}}(e,s)),Promise.resolve(e)}}}},"/5se":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="controls.DefaultView";function i(e,t,r,i){const s=Object(n.v)(r);return{type:a,payload:i.guid,meta:{pageId:e,controlName:t,contextKey:s}}}},"/q/W":function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r("SoKF"),a=r("RrRQ"),i=r("i1f0"),s=r("4UCL"),o=r("zmL5"),c=r("dHD5"),l=r("bT7G"),u=r("jTSi"),d=r("O7zD");function h(e){return{type:"handle.unsaved.changes.async",execute:({dispatch:t,getState:r},h,p)=>t(Object(n.a)(e)).then(n=>{if(n){const n=Object(o.a)(r(),e),h=n.map(e=>Object(c.j)(r(),e));for(let e=0;e<n.length;e++){const o=n[e],c=h[e],p=Object(i.ac)(r(),o,c),g=Object(l.b)(r(),p),m=(null==g?void 0:g.activeChanges)?Object.keys(g.activeChanges):[];for(const e of m)t(Object(u.b)(c,o,Object(d.d)(o,e)));t(Object(a.c)(o,p,c)),t(Object(s.d)(o,c))}return!0}return!1})}}},"/q65":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="attribute.targets.set";function i(e,t,r,i){const s=Object(n.x)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:s,dataFieldName:r}}}},"0L4T":function(e,t,r){"use strict";r.d(t,"c",(function(){return d})),r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return p}));var n=r("j2fa"),a=r("YxC/"),i=r("GEBM"),s=r("z8iZ"),o=r("DAWX"),c=r("3/02"),l=r("Lyxw"),u=r("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function d(e,t,r,n,s){let o=null;if(o=Object(a.b)(e,i.q),"function"==typeof r.get_ErrorCode)switch(r.get_ErrorCode()){case-2147093999:o=Object(a.b)(e,i.r);break;case-2147220960:o=Object(a.b)(e,i.o);break;case-2147164125:o=Object(a.b)(e,i.a);break;case-2147164130:case-2147164126:o=Object(a.b)(e,i.j);break;case-2147217149:o=Object(a.b)(e,i.i);break;case-2147217098:o=Object(a.b)(e,i.x);break;case-2147220969:case-2147187962:o=Object(a.b)(e,i.p);break;default:r.get_Message()&&(o=o+" "+r.get_Message())}h(e,t,o,n,s)}function h(e,t,r,a,i){let d=null;d=function(e){const t=Object(s.a)();return t.ErrorInformation=new o.a,t.ErrorInformation.set_ErrorDescription(e),t}(r),Object(l.c)(e,c.rd)?(t(Object(n.a)(a.getStorageKey(),d)),Object(n.e)(e,t,a.getStorageKey(),i)):(t(Object(n.c)(u.a.toString(a.visualizationId)||u.a.EMPTYGUIDSTRING,u.a.toString(a.viewId)||u.a.EMPTYGUIDSTRING,d)),Object(n.d)(e,t,u.a.toString(a.visualizationId)||u.a.EMPTYGUIDSTRING,u.a.toString(a.viewId)||u.a.EMPTYGUIDSTRING,i))}function p(e,t,r,n,s,o){h(t,r,-2147220960===e?Object(a.b)(t,i.o):n,s,o)}},"0PSL":function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var n,a=r("SAYH"),i=r("hvSt");!function(e){e[e.Active=0]="Active",e[e.Inactive=1]="Inactive",e[e.Completed=2]="Completed"}(n||(n={}));var s=r("CPoS"),o=r("xMtD"),c=r("odYE"),l=r("VnpK"),u=r("S2mk"),d=r("LbMF"),h=r("+nNZ"),p=r("i1f0"),g=r("dHD5"),m=r("iZ7K"),b=r("504W"),f=r("Lyxw"),y=r("9fGf"),_=r("arV0"),v=r("WRF3"),S=r("fU7K");class O{constructor(e,t,r){this._memorizedExtraFilters=[],this._getState=e,this._businessProcessFlowWrapperIdentifierFactory=t,this._context=r}generate(e,t){return t?this._getBusinessProcessFlowWrapper(e,t):null}_getBusinessProcessFlowWrapper(e,t){const r=this._getState(),n=this._businessProcessFlowWrapperIdentifierFactory.generate(e,t);if(!n||!t||!t.getProcessId())return null;const i=t.getCurrentFormEntity(),c=Object(_.g)(r,e);this._navigationEntities=t.getNavigationEntities();const l=Object(h.f)(r,i);return{id:t.getProcessId(),instanceId:t.getProcessInstanceId(),name:Object(s.c)(r,t.getProcessId()),bpfEntityLogicalName:t.getBpfEntityLogicalName(),stages:this._getStages(n.data.activePath,n.activeStageId,n.data.selectedStageId,e,t),relationships:Object(o.e)(this._getState(),t.getProcessId()),activeStageId:n.activeStageId,selectedStageId:n.data.selectedStageId,activePath:n.data.activePath,displayState:n.displayState,currentEntity:new v.a(i.etn,a.a.toLegacyGuid(i.id)),processState:t.getProcessState(),state:t.getState(),status:t.getStatus(),statusName:t.getStatusName(),isFormInactive:Object(p.Lb)(r,c.entityTypeName,c.id),delegates:this._getActions(t),isVisible:t.isVisible(),actionLogs:n.data.actionLogCollection,instanceModifiedTimestamp:l,instanceName:t.getProcessInstanceName(),isCustomControlsPresent:t.getCustomControlIndicator(),isRenderedFromFormXml:t.getFormXmlRenderingIndicator(),isImmersiveBPF:t.isImmersiveBPF()}}_getStages(e,t,r,n,i){if(!e||0===e.length)return null;const s={},o=[];return e.forEach((e,c)=>{s[e.guid]=c;const l=a.a.equals(e,r),u=this._getStageWrapper(e,l,t,s,n,i);u&&o.push(u)}),o}_getStageWrapper(e,t,r,n,i,s){const c=Object(o.c)(this._getState(),s.getProcessId(),e);if(!c)return null;let l=t&&this._getSteps(c,i,s)||[];if(Object(f.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){const e="BusinessProcessFlow.CustomControlConfiguration",t=this._context.TraceManager.getTracer(e),r=Object(o.a)(this._getState(),s.getProcessId(),t);if(!Object(b.a)(r)&&!Object(b.a)(r.ControlConfigurations)){const n=s.getTelemetryParams();if(n.push({name:"BPFEntityFormId",value:r.Id.guid},{name:"BPFEntityFormType",value:r.FormType}),Object(b.a)(r.ControlConfigurations)||n.push({name:"CustomControls",value:Object.keys(r.ControlConfigurations).length}),s.isBpfFormDescriptorValid(this._getState(),s.getProcessId(),r,t))try{if(!Object(b.a)(r.ControlConfigurations)){const u=Object(o.b)(r,t),d=r.ControlConfigurations,h=this._getNonDefaultControlConfiguration(d);if(Object(f.c)(this._getState(),"FCB.EnableBPFCCPhase3")){const t=this._buildStepsFromFormXml(c,r,h,n,i,s);t&&t.length>0&&(l=t,s.setFormXmlRenderingIndicator(!0),this._context.EventManager.ReportComponentSuccess(e,n))}else Object(b.a)(u)||Object.keys(u).forEach(r=>{if(u[r].ParentCellId){const i=new a.a(u[r].ParentCellId);if((c&&c.stage&&c.stage.steps?c.stage.steps.map(e=>e.stepId.guid).indexOf(i.guid):-1)>=0&&i){const o=[];o.push({name:"StepId",value:i.guid},{name:"NonDefaultControlUniqueId",value:u[r].UniqueId}),t.info("Non-default control found for step",o);let d=null;h&&u[r].UniqueId&&(s.setFormXmlRenderingIndicator(!0),d=h[u[r].UniqueId]?h[u[r].UniqueId]:null);const p={attributeName:u[r].DataFieldName,isRequired:this._getIsStepRequired(i.guid,c),name:u[r].Label,stepId:new a.a(i.guid),stepType:"field",attributeType:this._getMetadataTypeByAttribute(c.entityLogicalName,u[r].DataFieldName),controlName:"header_process_"+u[r].Label,isVisible:u[r].Visible,isControlDisabled:u[r].Disabled,nonDefaultConfiguration:d};l.push(p),Object(b.a)(p.stepId.guid)||p.stepId.guid===a.a.EMPTY.guid||n.push({name:"StepId",value:p.stepId.guid}),n.push({name:"AttributeName",value:p.attributeName},{name:"AttributeType",value:p.attributeType},{name:"IsRequired",value:p.isRequired},{name:"NonDefaultControlUniqueId",value:u[r].UniqueId}),Object(b.a)(d)?this._context.EventManager.ReportComponentFailure(e,new Error("CustomControlConfiguration is null or undefined even though the BPF entity form XML is valid and contains non-default custom control descriptors"),null,n):(s.setCustomControlIndicator(!0),n.push({name:"CustomControlId",value:d.CustomControlId}),!Object(b.a)(d.Name)&&d.Name.indexOf("MscrmControls")>=0&&n.push({name:"CustomControlName",value:d.Name}),this._context.EventManager.ReportComponentSuccess(e,n))}}})}}catch(r){t.error(`Message: ${r.message}, Stack: ${r.stack}`,n),this._context.EventManager.ReportComponentFailure(e,r,null,n)}else this._context.EventManager.ReportComponentFailure(e,new Error("Invalid FormXML - Fallback invoked"),null,n)}}return{id:c.stage.stageId,name:c.stage.stageDisplayName,entityName:c.entityLogicalName,entityDisplayName:Object(m.f)(this._getState(),c.entityLogicalName)||c.entityDisplayName,relatedEntityReference:this._getRelatedEntityReference(c.entityLogicalName),referencingAttributeName:c.referencingAttributeName,status:this._getStageStatus(n[e.guid],n[r.guid],s),steps:l}}_buildStepsFromFormXml(e,t,r,n,i,s){const o=[],c=t.Controls;return!Object(b.a)(c)&&this._areStepsValid(e,t,n)&&Object.keys(c).forEach(l=>{if(!Object(b.a)(c[l])&&c[l].ParentCellId){const u=new a.a(c[l].ParentCellId),d=t.Tabs.find(e=>e.Id===c[l].ParentTabId);if(d&&!Object(b.a)(d.RawTabId)&&e.stage.stageId.guid===new a.a(d.RawTabId).guid){let d=null;r&&c[l].UniqueId!==a.a.EMPTY.guid&&(d=r[c[l].UniqueId]?r[c[l].UniqueId]:null);const h=this._retrieveControlName(c[l],e.stage.steps),g=this._getUIControl(i,h),m={attributeName:c[l].DataFieldName,isRequired:c[l].IsRequired,name:this._retrieveStepLabel(c[l],g,e.stage.steps),stepId:new a.a(u.guid),stepType:this._getStepTypeFromControlKey(l),attributeType:this._getMetadataTypeByAttribute(e.entityLogicalName,c[l].DataFieldName),controlName:h,isVisible:g&&!Object(b.a)(g.visible)?g.visible:c[l].Visible,isControlDisabled:c[l].Disabled||Object(p.t)(this._getState(),{id:i,controlName:h},s.getContextToken()),viewId:g&&g.parameters&&g.parameters.defaultviewid?g.parameters.defaultviewid:null,nonDefaultConfiguration:Object(b.a)(d)?null:d};m.config=this._getConfig(t,s,c[l],i,n),m.viewId&&m.config&&m.config.Parameters&&m.config.Parameters.value&&(m.config.Parameters.value.ViewId=m.viewId,g&&g.customFilter&&g.customFilter.length>0&&(this._applyLookupFilter(m,g),m.config.Parameters.value.ExtraFilters=m.extraFilters)),o.push(m),n.push({name:"StepId",value:m.stepId.guid},{name:"AttributeName",value:m.attributeName},{name:"AttributeType",value:m.attributeType},{name:"IsRequired",value:m.isRequired},{name:"NonDefaultControlUniqueId",value:c[l].UniqueId}),Object(b.a)(d)||c[l].UniqueId===a.a.EMPTY.guid||(s.setCustomControlIndicator(!0),n.push({name:"CustomControlId",value:d.CustomControlId}),!Object(b.a)(d.Name)&&d.Name.indexOf("MscrmControls")>=0&&n.push({name:"CustomControlName",value:d.Name}))}}}),o}_areStepsValid(e,t,r){if(!(Object(b.a)(t)||Object(b.a)(e)||Object(b.a)(e.stage)||Object(b.a)(e.stage.stageId))){const n=t.Controls,i=e.stage.stageId.guid.toLowerCase(),s=e.stage.steps,o=[];if(!Object(b.a)(n)){if(Object.keys(n).forEach(e=>{if(!Object(b.a)(n[e].ParentCellId)){const r=new a.a(n[e].ParentCellId).guid.toLowerCase(),s=t.Tabs.find(t=>t.Id===n[e].ParentTabId);if(!Object(b.a)(s)&&!Object(b.a)(s.RawTabId)){const e=new a.a(s.RawTabId).guid.toLowerCase();i===e&&o.indexOf(r)<0&&o.push(r)}}}),s.length!==o.length)return r.push({name:"StepFallback",value:"No. of steps in BPF stage don't match no. of cells in corresponding tab"},{name:"BPFStageStepCount",value:s.length},{name:"TabCellCount",value:o.length}),!1;for(let e=0;e<s.length;e++)if(o.indexOf(s[e].stepId.guid.toLowerCase())<0)return r.push({name:"StepFallback",value:"BPF stage stepId does not match corresponding tab's cellId"},{name:"MissingBPFStepId",value:s[e].stepId.guid.toLowerCase()}),!1;return!0}}return!1}_retrieveStepLabel(e,t,r){if(!Object(b.a)(t)&&!Object(b.a)(t.label)&&""!==t.label)return t.label;if(!Object(b.a)(e.Label)&&""!==e.Label)return e.Label;if(!Object(b.a)(r)&&r.length>0)for(const t of r)if(t.stepId.guid===new a.a(e.ParentCellId).guid&&!Object(b.a)(t.label)&&""!==t.label)return t.label;return""}_retrieveControlName(e,t){if(!Object(b.a)(t)&&t.length>0)for(const r of t)if(r.stepId.guid===new a.a(e.ParentCellId).guid&&!Object(b.b)(r.controlName))return r.controlName;return Object(b.a)(e.DataFieldName)||""===e.DataFieldName?"":"header_process_"+e.DataFieldName}_getConfig(e,t,r,n,a){try{const i=Object(p.h)(),s=e&&e.Id,o=t.getCurrentFormEntity();a.push({name:"ControlDescriptorName",value:r&&r.Name});const c=i(this._getState(),r,n,s,o&&o.name,!1);return a.push({name:"CCFControlConfigID",value:c&&c.CustomControlId},{name:"CCFControlConfigName",value:c&&c.Name},{name:"CCFControlConfigParams",value:c&&c.Parameters&&Object.keys(c.Parameters).join(",")}),c}catch(e){a.push({name:"CCFControlConfigError",value:e})}return null}_getStageStatus(e,t,r){if(null==t||e<t)return n.Completed;if(e===t){return r.getStatus()===i.a.Finished?n.Completed:n.Active}return n.Inactive}_getSteps(e,t,r){const n=[];if(!e.stage||!e.stage.steps||0===e.stage.steps.length)return null;for(const a of e.stage.steps){const i=this._getUIControl(t,a.controlName);let s=null;if(a.name&&a.stepType&&"field"===a.stepType.toLowerCase()){if(s=this._getMetadataTypeByAttribute(e.entityLogicalName,a.name),!s)continue;if(Object(f.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){const e="BpfCustomControlSupport",t=this._context.TraceManager.getTracer(e),n=Object(o.a)(this._getState(),r.getProcessId(),t);if(!Object(b.a)(n)&&!Object(b.a)(n.ControlConfigurations)&&r.isBpfFormDescriptorValid(this._getState(),r.getProcessId(),n,t)){const e=Object(o.b)(n,t),r=this._getNonDefaultControlStepIds(e);if(!Object(b.a)(r)&&r.map(e=>e.guid).indexOf(a.stepId.guid)>=0)continue}}}const c=this._getState(),l={attributeName:a.name,controlName:a.controlName,isRequired:a.required,isVisible:!i||i.visible,name:i?i.label:a.label,stepId:a.stepId,stepType:a.stepType,attributeType:s,viewId:i&&i.parameters&&i.parameters.defaultviewid?i.parameters.defaultviewid:a.viewId,isControlDisabled:Object(p.t)(c,{id:t,controlName:a.controlName},r.getContextToken())};l.viewId&&i&&i.customFilter&&i.customFilter&&i.customFilter.length>0&&this._applyLookupFilter(l,i),n.push(l)}return n}_applyLookupFilter(e,t){let r;r=!1;const n=[];if(e&&t){for(let e=0;e<t.customFilter.length;e++){if("END_FLAG"===t.customFilter[e].customFilter){r=!0;break}if("START_FLAG"!==t.customFilter[e].customFilter){const r=Object(l.i)(Object(S.CrmHtmlDecode)(t.customFilter[e].customFilter));r&&(r.conditions&&r.conditions.length>0||r.filters&&r.filters.length>0)&&n.push(JSON.stringify(r))}}r?(this._memorizedExtraFilters=n,e.extraFilters=this._memorizedExtraFilters):e.extraFilters=this._memorizedExtraFilters?this._memorizedExtraFilters:[]}}_getMetadataTypeByAttribute(e,t){const r=this._getState(),n=Object(d.a)(r,e,t);if(!n)return null;const a=`${n.Type}.${n.Format}`;return Object(u.n)(a)}_getActions(e){return{completeProcess:()=>e.completeProcess(),moveNext:()=>e.moveToNextStage(),movePrevious:()=>e.moveToPreviousStage(),setActiveStage:t=>e.setActiveStage(t.guid),setSelectedStage:(t,r=!1)=>{e.setSelectedStage(t?t.guid:null,r)},triggerActionStepClick:t=>{e.triggerActionStepClick(t)},triggerFlowStepClick:(t,r)=>{e.triggerFlowStepClick(t,r)},refreshFlowStepClick:t=>{e.refreshFlowStepClick(t)},setDisplayState:t=>{e.setDisplayState(t)},getForwardNavigationEntities:(t,r,n,a)=>e.getForwardNavigationEntities(t,r,n,a),navigateToNextEntity:(t,r,n,a)=>e.navigateToNextEntity(c.a.fromLegacyEntityReference(t),c.a.fromLegacyEntityReference(r),n,a),executePreEvent:(t,r,n,a)=>e.executePreEvent(t,r,n,a),validateRequiredFieldsForNavigation:()=>e.ValidateRequiredFieldsForNavigation(),waitForOngoingWork:()=>e.waitForOngoingWork(),getActiveStageActiveFor:()=>e.getActiveStageActiveFor(),getBpfInstanceActiveFor:()=>e.getBpfInstanceActiveFor(),getBpfInstanceCompletedIn:()=>e.getBpfInstanceCompletedIn(),getBpfNavigationBehavior:()=>e.getBpfNavigationBehavior(),setBpfNavigationBehavior:t=>{e.setBpfNavigationBehavior(t)},getBpfNavigationBehaviorAllowCreateNew:t=>e.getBpfNavigationBehaviorAllowCreateNew(t),getActiveStage:()=>{const t=e.getContextToken(),r=e.getScriptContainer().getEventManager().getClientApiForm(t);return r?r.data.process.getActiveStage():null}}}_getRelatedEntityReference(e){if(!this._navigationEntities)return null;const t=this._navigationEntities.find(t=>t.entityLogicalName===e);return t?new v.a(t.entityLogicalName,a.a.toLegacyGuid(a.a.parse(t.id))):null}_getUIControl(e,t){if(t){const r=this._getState(),n=Object(g.j)(r,e),a={controlName:t,id:e};return Object(p.Mc)(this._getState(),a,n)}return null}_getNonDefaultControlConfiguration(e){const t={};if(e){const r=Object.keys(e);for(let n=0;n<r.length;n++){let a=null;const i=Object(y.b)(this._getState());a=e[r[n]].CustomControls[i],a&&(t[r[n]]={FormFactor:a.FormFactor,CustomControlId:a.CustomControlId,Name:a.Name,Version:a.Version,Parameters:a.Parameters,ShouldOverrideControlVisible:a.ShouldOverrideControlVisible,DisplayNameKey:a.DisplayNameKey})}}return t}_getNonDefaultControlStepIds(e){const t=[];return e&&Object.keys(e).forEach(r=>{e[r].ParentCellId&&t.push(new a.a(e[r].ParentCellId))}),t}_getIsStepRequired(e,t){const r=t.stage.steps,n=r?r.map(e=>e.stepId.guid).indexOf(e):-1;return n>=0&&!Object(b.a)(r[n].required)&&r[n].required}_getStepTypeFromControlKey(e){return e.endsWith("_actionstep")?"action":e.endsWith("_flowstep")?"modernflow":"field"}}},"0bz+":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("WY/A"),a=r("RrRQ"),i=r("qTme");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e=null,t){if(t.type===n.a){return t.payload.snapshotId}return t.type===i.a?t.payload:t.type===a.a?null:e}},"223Y":function(e,t,r){"use strict";r.d(t,"b",(function(){return lr})),r.d(t,"a",(function(){return ur})),r.d(t,"d",(function(){return hr})),r.d(t,"c",(function(){return cr}));var n=r("u+q+"),a=r("QBtP"),i=r("nuS9"),s=r("93Ls"),o=r("kGA3"),c=r("VnpK"),l=r("S2mk"),u=r("DRVD"),d=r.n(u),h=r("SZCI"),p=r("SAYH"),g=r("504W"),m=r("arV0"),b=r("xHmU"),f=r("i1f0"),y=r("lEFU"),_=r("Z/4N"),v=r("5ZBI"),S=r("dHD5"),O=r("jRy5"),I=r("odYE"),C=r("bT7G"),j=r("pnQK"),P=r("OtHk"),T=r("3/02"),E=r("Lyxw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const w="CustomControlFramework.Selectors.CustomControlHostContextTokenSelectors";function F(){let e=null,t=null,r=null;return(n,a)=>{v.a.info(a.controlId+"."+w+": createGetContextTokenSelector started");const i=a.parentContextToken,s=a.contextString,o=function(e,t){const r=t.parentContextToken,n=t.contextString;let a;const i=t.configuration,s=Object(_.e)(e,t.configuration.CustomControlId);if(Object(E.c)(e,T.J)&&Object(c.s)(s)&&function e(t,r){if(!r)return!1;if(r.contextTokenType===O.a.UnboundForm&&r.formId)return!(!Object(j.a)(t,r.formId)&&!Object(P.a)(t,r.formId));return e(t,r.parentContextToken)}(e,r))return a=S.p(r.parentContextToken,t.controlId),a;if("default"===n&&Object(c.s)(s)&&!Object(c.r)(t.configuration.Parameters)||Object(c.r)(t.configuration.Parameters)&&function(e){if(e.indexOf("ClientContextGridControl")>-1||e.indexOf("activeProcessGridControlContainer")>-1||e.indexOf("ManageDuplicatesGrid")>-1||e.indexOf("archivedProcessGridControlContainer")>-1)return!0;return!1}(t.controlId))return a=S.e(r,t.controlId),a;if(!t.formInfo&&i&&i.Parameters&&i.Parameters.value&&"TimelineWall"===i.Parameters.value.Type)return a=S.p(r,t.controlId),a;if(!t.formInfo&&Object(c.t)(t.configuration)){const n=function(e,t){const r=Object(m.g)(e,t.id),n=new I.a(r.entityTypeName,r.id||p.a.EMPTY),a=Object(f.ac)(e,t.id,t.parentContextToken),i=Object(C.d)(e,a,n,t.descriptor.DataFieldName),s=i?i.reference:null;return s?s.etn:Object(c.m)(t.descriptor)}(e,t);return a=S.l(r,t.controlId,n),a}a=r;const o=t.descriptor&&t.descriptor.Relationship;o&&(a=S.m(a,o));return a}(n,a);return(r!==s||x(e,o)||x(t,i))&&(e=o,t=i,r=s),v.a.info(a.controlId+"."+w+": createGetContextTokenSelector finished"),e}}function x(e,t){return e&&t?e.entityTypeName!==t.entityTypeName||e.controlName!==t.controlName||(e.formId&&e.formId.guid)!==(t.formId&&t.formId.guid)||(e.recordId&&e.recordId.guid)!==(t.recordId&&t.recordId.guid)||e.relationshipName!==t.relationshipName:e!==t}var A=r("p8cR"),N=r("P6DH"),D=r("zmL5"),k=r("OKVy"),M=r("FdB0"),R=r("fILV");function L(){let e={},t=!1;return(r,n,a,i,s,o)=>{v.a.info(n.controlId+".CustomControlFramework.Selectors.CustomControlHostPersonalizationInfoSelectors: createGetPersonalizationConfiguration started");const c=Object(m.a)(r,n),l=c&&c.id,u=e&&l&&l.guid&&(!e.recordGuid||e.recordGuid&&l.guid!==e.recordGuid.guid);if(!t||u){const c=Object(D.b)(r,n.id),l=p.a.equals(p.a.tryParse(a.UniqueId),p.a.EMPTY)?n.controlId:a.UniqueId;e=c&&o===k.a?function(e,t,r,n){return{areaType:"dashboard",entityTypeName:null,recordGuid:null,formGuid:r,controlUniqueId:n,viewId:void 0}}(0,0,c,l):c&&o===M.a?function(e,t,r,n){const{entityTypeName:a,recordSetQueryKey:i}=Object(m.a)(e,t);return{areaType:"dialog",entityTypeName:a,formGuid:r,controlUniqueId:n,viewId:i?i.split(",")[1]:void 0}}(r,n,c,l):c?function(e,t,r,n){const{entityTypeName:a,recordSetQueryKey:i,id:s}=Object(m.a)(e,t);return{areaType:"form",entityTypeName:a,recordGuid:s,formGuid:r,controlUniqueId:n,viewId:i?i.split(",")[1]:void 0}}(r,n,c,l):o===R.a?function(e,t,r,n){const a=Object(N.cb)(e,n,t);return{areaType:"grid",entityTypeName:r,viewId:a?a.split(",")[1]:void 0}}(r,n,i.entityTypeName,s):{areaType:null,entityTypeName:null,controlUniqueId:l,viewId:void 0},t=!0}return v.a.info(n.controlId+".CustomControlFramework.Selectors.CustomControlHostPersonalizationInfoSelectors: createGetPersonalizationConfiguration finished"),e}}var B=r("q6Ks"),V=r("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function G(e,t,r,n,a){const i=Object(V.a)(e,t),s=a?"__hiddenCommandManagerIds":"__pendingCommandManagerIds",o=Object(S.v)(n);return i&&i[s]&&i[s][o]&&i[s][o][r]?i[s][o][r]:null}var U=r("GT4X"),X=r("tJ+6"),z=r("cfbi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const q=d.a.createEvent("CustomControlHostSelectors.mapStateToProps",h.c);var H=r("r/9v"),W=r("OmkB"),Y=r("tOh6"),Q=r("BJ7u"),K=r("5DN6"),J=r("iZ7K"),Z=r("lY/Z"),$=r("Lohl"),ee=r("y60j"),te=r("XlXz");function re(e,t){return{type:te.a,payload:e,meta:{pageId:t}}}function ne(e){return{type:"execute.cleanreferencepanelstate.async",execute:({dispatch:t,getState:r},n)=>(t(function(e){return{type:te.b,payload:{},meta:{pageId:e}}}(e)),Promise.resolve())}}function ae(e){return{type:"execute.closeallsessiontabs.async",execute({dispatch:t,getState:r},n){const a=r();return t(function(e,t){return{type:te.c,payload:e,meta:{pageId:t}}}({sessionTabs:[],activeTabId:Object(K.b)(a,e)},e)),Promise.resolve()}}}function ie(e,t){return{type:"execute.closesessiontab.async",execute({dispatch:r,getState:n},a){const i=n(),s=Object(K.d)(i,t),o=Object(K.a)(i,e,t);return s.splice(e,1),r(function(e,t){return{type:te.d,payload:e,meta:{pageId:t}}}({sessionTabs:s,activeTabId:o},t)),Promise.resolve()}}}function se(e){return{type:"execute.dismissmessage.async",execute:({dispatch:t,getState:r},n)=>(t(function(e,t){return{type:te.e,payload:{referencePanelState:t},meta:{pageId:e}}}(e,{messageId:""})),Promise.resolve())}}function oe(e,t){return{type:"execute.initializereferencepanelcontrol.async",execute({dispatch:r,getState:n},a){const i=Object(K.c)(n(),t);if(e&&!(i.activeTabId&&i.controlNames.length>0))return r(function(e,t){return{type:te.f,payload:e,meta:{pageId:t}}}({controlNames:e.map(e=>e.Name),activeTabId:e[0].Id},t)),Promise.resolve()}}}var ce=r("SWZ5");function le(e,t){return{type:"execute.addsessiontab.async",execute({dispatch:r,getState:n},a){const i=Object(K.d)(n(),t),s=[];for(let t=0;t<i.length;t++)i[t].id===e.id?s.push(e):s.push(i[t]);return r(function(e,t){return{type:te.h,payload:e,meta:{pageId:t}}}({sessionTabs:s},t)),Promise.resolve()}}}var ue=r("IaGr"),de=r("1kth");var he=r("Or4W"),pe=r("BMZr"),ge=r("uPT+"),me=r("mIxf"),be=r("sX6v"),fe=r("WY/A"),ye=r("JP46"),_e=r("Dea/");var ve=r("ghNp"),Se=r("yRo8"),Oe=r("oOvK"),Ie=r("FZDd"),Ce=r("HfZT"),je=r("6Qf/"),Pe=r("a72m"),Te=r("YYhu"),Ee=r("Tf+h"),we=r("ZUzm"),Fe=r("0uKS"),xe=r("lIi+"),Ae=r("lYcl"),Ne=r("4fxQ"),De=r("VCkP");var ke=r("DU8S");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Me{constructor(e,t){this.Target=e,this.FieldName=t}getMetadata(){return{boundParameter:null,operationName:"CalculateRollupField",operationType:1,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},FieldName:{typeName:"Edm.String",structuralProperty:1}}}}}var Re=r("srnJ"),Le=r("UR8A"),Be=r("j6Db");var Ve=r("NjDY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Ge=r("969l"),Ue=r("EY5k"),Xe=r("YxC/");var ze=r("VpHT");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function qe(e,t){return{type:"customcontrol.loadresources.async",execute:({dispatch:r,getState:n},a)=>function(e,t,r,n){const a=Object(Ve.t)(t);return r.initializeContainerForClientApi(n).then(t=>t.loadWebResources([Object(Ve.a)(a,e)]).then(()=>({container:t,webResourcePath:a})))}(e,n(),a.ScriptManager,t)}}var He=r("kWiz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var We=r("Khp3"),Ye=r("3tOH"),Qe=r("Qn2w"),Ke=r("LbMF");var Je=r("dQnL"),Ze=r("d0Pd"),$e=r("0L4T"),et=r("NbYl"),tt=r("NYBK"),rt=r("7fV9"),nt=r("Z+6x"),at=r("Nse0"),it=r("WK+4"),st=r("qwRa"),ot=r("s+OO"),ct=r("7k+e"),lt=r("eXjw"),ut=r("Uv1Y"),dt=r("vNXc"),ht=r("5Oca");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class pt{constructor(e,t,r){this.Target=e,this.Query=t,this.RollupType=r}getMetadata(){return{boundParameter:null,operationName:"Rollup",operationType:1,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},Query:{typeName:"Microsoft.Dynamics.CRM.QueryBase",structuralProperty:2},RollupType:{typeName:"Microsoft.Dynamics.CRM.RollupType",structuralProperty:3,enumProperties:[,{name:"None",value:0},{name:"Related",value:1},{name:"Extended",value:2}]}}}}}var gt=r("sNgR"),mt=r("tHtE"),bt=r("SRlt"),ft=r("fYtF");function yt(e,t=!1){const r=[];return{type:"gridData.retrieve.rollup.async",execute({dispatch:n,getState:a},i){let s=a();const o=e.key,c=dt.a.fromState(e,a),l=Object(ht.u)(s,o,c.pageNumber-1);return l&&(c.pagingCookie=l),r.push({name:ft.a,value:Object(ft.e)(e)}),r.push({name:"isRefresh",value:t}),n(function(e,t,r=!1){const n={lists:{[e]:{initialized:r?lt.a.Refreshing:lt.a.Initializing,pageSize:t}}};return{type:"gridData.retrieve.rollup",payload:n}}(o,c.pageSize,t)),function(e,t,r){return r.toQueryExpression(e,t).then(n=>t(Object(gt.b)(new pt(I.a.toExternalEntityReference(r.target),n,r.rollupType))).then(n=>Object(bt.g)(n).then(n=>function(e,t,r,n){const a=r.getKeyQuery(),i=Object(mt.e)(a),s=Object(Ie.e)(i.entity2AttributesMap);return t(s).then(()=>{const t=e();return Object(mt.a)(t,a,i,n)})}(e,t,r,n))))}(a,n,c).then(e=>{s=a(),n(Object(Ce.e)(s,n,o,c,e))}).catch(e=>{Object(ut.b)(e)})},getFailureParameters:(e,t)=>r,getSuccessParameters:(e,t,n)=>r}}var _t=r("fREn"),vt=r("ngeo"),St=r("xorU");function Ot(e,t,r,n,a){let i="",s="";if(n&&n.message&&(i=n.message),n&&n.errorCode){const o=a||Be.a,c=e=>(r.EventManager.ReportComponentFailure(o,e,null,[{name:"hexErrorCode",value:s},{name:"errorStatus",value:JSON.stringify(n)},{name:"customControlId",value:a},{name:"APIName",value:Be.a+".Actions.RefreshDataSetParameter.getErrorMessage"}]),Promise.resolve(`${s} ${i}`));try{s="0x"+vt.a.getHexErrorCodeFromInt(n.errorCode);const r="Error_Title_"+s,a="Error_Message_"+s,i=`Localized resource strings not found for neither ${r} nor ${a}.  Please add error resources for error code ${s}`,o=e(Object(Ue.e)([r])).catch(()=>{}),l=e(Object(Ue.e)([a])).catch(()=>{});return Promise.all([o,l]).then(()=>{const e=Object(Xe.e)(t(),[r,a]),n=Object(Xe.c)(e,r),o=Object(Xe.c)(e,a);let l="";return l=function(e){return"0x8005f211"===(null==e?void 0:e.toLowerCase())}(s)?`${n}${n&&o?": ":""}${o}`:n||o,l?Promise.resolve(`${s} ${l}`):c(i)})}catch(e){return c(e)}}return Promise.resolve(`${s} ${i}`)}function It(e,t){if(e instanceof rt.a){e.getLatestData().loading=!0,e.setRefreshingStart()}else if(e instanceof nt.a||e instanceof tt.a){const t=e.getLatestData();t&&(t.working=!0,nt.a,e.setWrapperLoadingFlag(!0))}return{type:"customcontrol.refreshDataSetParameter.async",execute({dispatch:r,getState:n},a){if(e instanceof et.a){const i={retrieveGridDataAction:e=>r(Object(Ce.d)(e)),retrieveViewAction:(e,t,n,a)=>r(Object(Pe.a)(e,t,n,a)),retrieveViewSelectorAction:(e,t)=>r(Object(Pe.b)(e,t)),runPreSearch:(e,n,a)=>r(Object(de.W)(t,e,n,a)),runSetAdditionalParams:(e,n,a)=>r(Object(de.X)(t,e,n,a)),refreshCustomDataProviderAction:(e,t,n,a)=>r(Object(at.b)(e,t,n,a)),retreiveChartAction:(e,t,n)=>r(Object(Je.a)(e,t,n)),retreiveChartDataAction:(e,t,n,a=!0)=>r(Object(Ze.a)(e,t,n,a)),updateDataSetChartVisualizationId:(e,t,n)=>r(Object(it.b)(e,t,n)),updateDataSetChartVisualizationType:(e,t,n)=>r(Object(st.b)(e,t,n)),getEntityMetadataAction:(e,t)=>r(Object(Ie.f)(e,!1,t)),getLocalizedErrorMessage:(e,t)=>Ot(r,n,a,e,t),updateChartFilterExpression:(e,t,n)=>r(Object(ot.c)(e,t,n)),updateChartDrillDownParameters:(e,t,n)=>r(Object(ct.c)(e,t,n)),updateChartErrorInformation:(e,t,n,a)=>{Object($e.a)(e,r,t,n,a)}};return e.refreshDataSet(n,i,a)}const i={retrieveGridDataAction:e=>Object(g.a)(e.rollupType)?r(Object(Ce.d)(e)):r(yt(e)),retrieveViewAction:(e,t,n,a)=>r(Object(Pe.a)(e,t,n,a)),retrieveViewSelectorAction:(e,t)=>r(Object(Pe.b)(e,t)),runPreSearch:(e,n,a)=>r(Object(de.W)(t,e,n,a)),runSetAdditionalParams:(e,n,a)=>r(Object(de.X)(t,e,n,a)),startCustomFilter:(e,t,n)=>r(Object(St.f)(e,t,n)),endCustomFilter:(e,t,n)=>r(Object(St.e)(e,t,n)),refreshCustomDataProviderAction:(e,t,n,a)=>r(Object(at.b)(e,t,n,a)),getEntityMetadataAction:(e,t)=>r(Object(Ie.f)(e,!1,t)),getLocalizedErrorMessage:e=>Ot(r,n,a,e),getAdditionalResourceStrings:e=>r(Object(Ue.e)(e)),addCustomViewAction:(e,t,n,a,i,s,o,c)=>r(Object(_t.a)(e,t,n,a,i,s,o,c)),setOfflineQueryAction:e=>r(Object(_t.b)(e))};return e.refreshDataSet(n,i,a)}}}var Ct=r("7Sr4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var jt=r("sn0j"),Pt=r("KVHF");var Tt=r("mFPv"),Et=r("AE7n"),wt=r("pp6D"),Ft=r("9i5P");var xt=r("Q1Tc"),At=r("jsFU"),Nt=r("455M");var Dt=r("BFlg"),kt=r("7p56");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Mt(e,t,r){if(r.dataSetUIOptions){const n=e+t.id;let a=t.contextString;switch(t.contextString){case Dt.h.ASSOCIATEDGRID:case Dt.h.SUBGRID:case Dt.h.GRID:break;case Dt.h.CUSTOM:default:a=Dt.h.CUSTOM}return i.createElement(kt.a,{key:n,id:t.id,systemDefinedProperties:t.systemDefinedProperties,controlId:t.controlId,configuration:t.configuration,descriptor:t.descriptor,formInfo:t.formInfo,themingData:t.themingData,parentDefinedControlProps:t.parentDefinedControlProps,children:t.children,rowSpan:t.rowSpan,contextString:a,parentContextToken:t.parentContextToken,dataSetUIOptions:r.dataSetUIOptions})}return i.createElement(cr,{key:e,id:t.id,systemDefinedProperties:t.systemDefinedProperties,controlId:t.controlId,configuration:t.configuration,descriptor:t.descriptor,formInfo:t.formInfo,themingData:t.themingData,parentDefinedControlProps:t.parentDefinedControlProps,children:t.children,rowSpan:t.rowSpan,contextString:t.contextString,parentContextToken:t.parentContextToken})}var Rt=r("iWfp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Lt(e){if(!e)return;if(e instanceof I.a)return e;const t=e.entityName||e.LogicalName;let r;return r=p.a.fromLegacyGuid(e.Id),p.a.isNullOrEmpty(r)&&(r=new p.a(e.id||e.Id)),new I.a(t,r,Object(g.a)(e.name)?e.Name:e.name)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Bt(e,t,r,n){return n&&n.DisplayName&&"partylist"!==n.Type&&Object(jt.b)(e,t,r,n)&&n.IsValidForAdvancedFind}var Vt=r("thZs"),Gt=r("R5Qn"),Ut=r("E3i9"),Xt=r("KBcj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class zt{convert(e,t,r){const n=(new DOMParser).parseFromString(e,"text/xml"),a=this._firstElementChild(n),i=this._childElements(a);if(!i)return null;const s=[];for(const e of i){const t=[],r=this._childElements(e);for(const e of r)t.push(this._getGridCellDescriptor(e));s.push(this._getGridRowDescriptor(e,t))}const o=this._getGridDescriptor(a,s,r);return this._populateRelationshipInformation(o,t),o}_attributeValueBoolean(e,t){return"1"===this._attributeValueString(e,t,"")}_attributeValueString(e,t,r){const n=e.attributes.getNamedItem(t);return n&&n.value||r}_attributeValueInt(e,t,r){const n=this._attributeValueString(e,t,r+"");return parseInt(n,10)}_childElements(e){if(!e)return null;if(e.children)return Array.from(e.children);if(e.childNodes){return Array.from(e.childNodes).filter(e=>e.nodeType===Node.ELEMENT_NODE).map(e=>e)}return null}_getGridCellDescriptor(e){return{name:this._attributeValueString(e,"name",""),width:this._attributeValueInt(e,"width",0),relatedEntityName:this._attributeValueString(e,"relatedentityname",""),disableMetaDataBinding:this._attributeValueBoolean(e,"disableMetaDataBinding"),labelId:this._attributeValueString(e,"LabelId",""),isHidden:this._attributeValueBoolean(e,"ishidden"),disableSorting:this._attributeValueBoolean(e,"disableSorting"),addedBy:this._attributeValueString(e,"addedby",""),desc:this._attributeValueString(e,"desc",""),cellType:this._attributeValueString(e,"cellType",""),imageProviderWebresource:this._attributeValueString(e,"imageproviderwebresource",""),imageProviderFunctionName:this._attributeValueString(e,"imageproviderfunctionname","")}}_getGridRowDescriptor(e,t){return{name:this._attributeValueString(e,"name",""),id:this._attributeValueString(e,"id",""),cells:t,multiObjectIdField:this._attributeValueString(e,"multiobjectidfield",""),layoutStyle:this._attributeValueString(e,"layoutstyle","")}}_getGridDescriptor(e,t,r){return{name:this._attributeValueString(e,"name",""),object:r,rows:t,customControlDescriptions:null,jump:this._attributeValueString(e,"jump",""),select:this._attributeValueBoolean(e,"select"),icon:this._attributeValueBoolean(e,"icon"),preview:this._attributeValueBoolean(e,"preview"),iconrenderer:this._attributeValueString(e,"iconrenderer","")}}_firstElementChild(e){if(!e)return null;if(e.firstElementChild)return e.firstElementChild;const t=this._childElements(e);return t&&t[0]}_populateRelationshipInformation(e,t){const r=(new DOMParser).parseFromString(t,"text/xml"),n=this._firstElementChild(r),a=this._firstElementChild(n),i=this._childElements(a);if(i)for(const t of i)"link-entity"===t.nodeName&&this._attributeValueString(t,"alias","")&&this._attributeValueString(t,"name","")&&this._setRelatedEntityName(e,this._attributeValueString(t,"alias",""),this._attributeValueString(t,"name",""))}_setRelatedEntityName(e,t,r){for(let n=0;n<e.rows.length;n++)for(let a=0;a<e.rows[n].cells.length;a++){const i=e.rows[n].cells[a].name;(i?i.substring(0,i.indexOf(".")):void 0)===t&&(e.rows[n].cells[a].relatedEntityName=r)}}}var qt=r("DU5H"),Ht=r("fU7K");function Wt(e,t=!1,r,n,a,i,s,o){return{type:"populateAndSend.LookupData.Action",sync:!0,execute({dispatch:c,getState:l},u){const d=l(),h=a||e.LookupEntityByName[0].EntityLogicalName,g=Object(Gt.f)(d,h,s,n),b=[];if(o){const t=o.split("."),a=Object(m.g)(d,n);let i;const s=Object(f.ac)(d,n,r),c=Object(C.b)(d,s);i=c&&c.activeChanges&&c.activeChanges[t[1]]?c.activeChanges[t[1]]:Object(ht.j)(d,new I.a(t[0],a.id),t[1]),e.RelatedRecordId=i&&i.reference&&i.reference.id}if(e.LookupEntityByName&&e.LookupEntityByName.length){const t=Object(f.eb)(d,n,r),a=t&&t[i];for(const t of e.LookupEntityByName){const e=Object(qt.b)(d,n,r,i,t.EntityLogicalName);if(e&&(t.CustomFilter=Object(Ht.CrmHtmlDecode)(e).replace(/"/g,"'")),g){const e=Object(Ut.a)(d,g,t.EntityLogicalName);e&&e.view&&(p.a.equals(e.view.viewId,t.ViewId)||Object(Xt.c)(d,t.ViewId))||b.push(c(Object(Pe.a)(t.EntityLogicalName,null,null,t.ViewId)))}const s=a&&a.parameters&&a.parameters.defaultviewid;if(a&&a.views&&a.views[s]&&a.views[s].entityLogicalName===t.EntityLogicalName){t.ViewId=null,t.FetchXml=a.views[s].fetchXML.replace(/"/g,"'");const e=Object(J.h)(d,t.EntityLogicalName),r=new zt;t.LayoutJson=JSON.stringify(r.convert(a.views[s].layoutXML,a.views[s].fetchXML,e.ObjectTypeCode)).replace(/"/g,"'")}}}const y=Object(Vt.b)(d,h,e),_=Object(ht.o)(d,y);t=t||_===lt.a.Initialized,b.push(c(Object(Vt.d)(e,t)));const v=function(e,t,r,n,a){const i={};let s=n||r.EntityAndAttribute&&r.EntityAndAttribute.EntityName;const o=a||r.EntityAndAttribute&&r.EntityAndAttribute.AttributeName;if(!s&&!o)return null;s||(s="placeholderEtn");if(r.LookupEntityByName)for(const t of r.LookupEntityByName)i[t.EntityLogicalName]=Object(Vt.b)(e,t.EntityLogicalName,r);const c=Object(Vt.c)(e,r);return{type:"update.lookupRequestDataKey",payload:{[s]:{[o]:{metadataKey:c,dataKeys:i}}},meta:{pageId:t}}}(d,n,e,a,s);return v&&c(v),Promise.all(b)}}}var Yt=r("mpSO"),Qt=r("F1Lu");var Kt=r("+pAH"),Jt=r("wZxB");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let Zt,$t,er,tr;function rr(e,t){return{openEditForm:(r,n,a,i,s)=>{const o=Lt(r);e(n?Object(we.a)(o,t.id,void 0,void 0,n,a,i,s):Object(we.a)(o,t.id))},openGridPage:(r,n,a,i,s,o,c,l)=>{e(Object(Fe.a)(r,t.id,p.a.tryParseOrNull(n),a,i,p.a.tryParseOrNull(s),o,null,l,c))},openCreateForm:(r,n,a)=>{e(Object($.b)(new I.a(r),null,"QuickCreate")).then(i=>{e(Object(pe.b)(r,t.id,null,n,Lt(a)))}).catch(a=>{e(Object(we.a)(new I.a(r),t.id,void 0,n))})},openSearch:r=>{e(Object(Ae.a)(r,null,t.id))},openPowerBIFullScreenPage:(r,n,a,i,s,o,c)=>{e(Object(xe.a)(t.id,r,n,a,i,s,o,c))},openDashboard:e=>{},openUrl:(e,t)=>{},openUrlWithProtocol:(e,t)=>{},openPhoneNumber:(r,n,a,i,s,o,c,l,u,d=!1,h=!0)=>e(function(e,t,r,n,a,i,s,o,c,l,u=!1,d=!0){return{type:"customcontrol.openphonecall",execute(h,g){let m=e.trim();const b=Object(Ve.x)(h.getState()).defaultCountryCode;0!==m.indexOf("tel:")?(b&&(m=b+m),m="tel:"+m):b&&(m=m.slice(0,4)+b+m.slice(4));const f=new Qt.a(g,h);let y;g.ScriptManager.containerExists(Yt.d)&&(y=g.GlobalCustomEventManager);const _=()=>{if(u){let c=null;const l={};if(t){c=new I.a(r,new p.a(t));const a={id:t,entityType:r,name:n};let u=a;i&&(u={id:i,entityType:s,name:o}),l.contactinfo=e,l.to=[a],l.regardingobjectid=u}return h.dispatch(Object(pe.b)("phonecall",a,null,l,c,null,{entityName:"phonecall",showDialog:!0}))}};return f.canOpenUri(m).then(e=>{if(d&&y&&h.dispatch(y.runOnOpenUrl(a,m,l,c)))return null;const t=Object(E.c)(h.getState(),T.C);e?(f.openUri(m),t&&_()):u&&t&&_()},()=>null)},shouldReceiveFullStore:!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(r,a,n,i,t.id,o,s,c,l,u,d,h)),openMaps:e=>{},openMap:e=>{}}}var nr=r("Ki7F"),ar=r("nJrx"),ir=r("o0iw"),sr=r("llMO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const or=Object(n.a)(()=>{let e,t={},r=null,n={},a={},i={},s=!1,o="",u=null,d={},h=!1,S="",O=!1,I={stateToPropsMappingError:!1,dynamicData:null,manifest:null,personalizationState:null,propBagData:null,pageType:null,popupStack:null,contextToken:null,portalFlyoutToDialogId:null,designLanguage:null,inactive:!1},C=-1,j=-1;const P=Object(A.a)(),T=Object(B.a)(),E=L(),w=F();return(F,x)=>{v.a.info(x.configuration.CustomControlId+".CustomControlFramework.Selectors.CustomControlHostSelectors: makeMapStateToProps started");const A=q.startStopwatch({controlId:x.controlId,parentId:Object(c.p)(x),level:(0).toString()});let N,D,k,M,R,L=[],B=!1,V=null,H=null,W=null,Y=null,Q=null,K=null,J=null,Z=null,$=null,ee=null,te=!1,re=null,ne=null,ae=null,ie=!1;try{let e=null;x.formInfo?(u&&d.EntityName===x.formInfo.EntityName&&d.RecordId===x.formInfo.RecordId&&d.FormId===x.formInfo.FormId||(u={id:x.formInfo.RecordId?new p.a(x.formInfo.RecordId):null,formId:x.formInfo.FormId?new p.a(x.formInfo.FormId):null,entityTypeName:x.formInfo.EntityName},d=x.formInfo),e=u):e=Object(m.g)(F,x.id),H=x.descriptor,W=x.configuration,k=Object(b.b)(F),N=Object(m.l)(F,x.id),Object(m.f)(F,x.id)&&(R="DialogContainer__"+x.id),!R&&x.parentDefinedControlProps&&x.parentDefinedControlProps.parentFlyoutId&&(R=x.parentDefinedControlProps.parentFlyoutId),N&&(D=w(F,x));const t=Object(f.kb)(F,x,D);let r=W;if(null!==x.systemDefinedProperties){const e=Object.assign(Object.assign({},W.Parameters),x.systemDefinedProperties);r=Object.assign(Object.assign({},W),{Parameters:e})}if(Y=Object(_.e)(F,W.CustomControlId)||Object(_.e)(F,W.Name),!Y||!Y.ConstructorName){Y=null;const e=Object(l.h)(W.CustomControlId);e!==W.CustomControlId&&(Y=Object(_.e)(F,e))}Y&&(Z=T(F,Y,e,t,x.contextHelper),J=Z.response,K=P(r,H,x,F,e,D),Q=K.response,ee=Q&&Q.dataReady?E(F,x,H,e,D,N):null,$=Object(y.a)(F,ee,Y.CustomControlId,x.id));const n=G(F,x.id,x.controlId,D);n&&(te=n.every(e=>Object(U.b)(F,e))),M=G(F,x.id,x.controlId,D,!0),ne=x.parentDefinedControlProps&&!Object(g.a)(x.parentDefinedControlProps.height)?x.parentDefinedControlProps.height:-1,re=x.parentDefinedControlProps&&!Object(g.a)(x.parentDefinedControlProps.width)?x.parentDefinedControlProps.width:-1,ae=Object(X.b)(F)?Object(X.a)(F):null,ie=((e,t,r,n)=>Object(m.l)(e,t)===z.a&&!Object(f.Fb)(e,t,r,n))(F,x.id,D,x.descriptor.Name)}catch(e){const t=Y.ConstructorName;v.a.error(t+": makeMapStateToProps encountered error, err "+e,[{name:"ApiName",value:"CustomControlFramework.Selectors.CustomControlHostSelectors"},{name:"controlId",value:x.controlId},{name:"customControlId",value:Y.CustomControlId},{name:"manifest",value:JSON.stringify(Y)},{name:"descriptor",value:JSON.stringify(H)},{name:"configuration",value:JSON.stringify(W)},{name:"error.Stack",value:JSON.stringify(e.stack)}]),B=!0,V=e.toString()+". Stack: "+e.Stack}return r&&(L=L.concat(((e,t)=>{const r=[];return e.Disabled!==t.Disabled&&r.push("IsControlDisabled"),e.Label!==t.Label&&r.push("Label"),r})(H,r))),r=x.descriptor,Q!==n||Y!==t||J!==a||ee!==i||B!==s||N!==o||te!==h||M!==e||ne!==j||re!==C||R!==S||ae!==I.designLanguage||ie!==O?(ne===j&&re===C||L.push("layout"),K&&(L=L.concat(K.updatedProperties)),Z&&(L=L.concat(Z.updatedProperties)),ae!==I.designLanguage&&L.push("design"),I={stateToPropsMappingError:B,stateToPropsMappingErrorMessage:V,dynamicData:Q,manifest:Y,personalizationState:$,propBagData:J,children:W&&W.Children,personalizationConfiguration:ee,pageType:N,popupStack:k,contextToken:D,updatedProperties:L,globalCommandManagerInitialized:te,internalCommandManagerIds:M,portalFlyoutToDialogId:R,designLanguage:ae,inactive:ie},h=te,e=M,S=R,s=B,a=J,t=Y,n=Q,i=ee,o=N,j=ne,C=re,O=ie):I.updatedProperties=L,A({updatedProperties:JSON.stringify(L)}),v.a.info(x.configuration.CustomControlId+".CustomControlFramework.Selectors.CustomControlHostSelectors: makeMapStateToProps finished"),I}},(function(){let e;return function(t,r){if(e)return e;const n=rr(t,r);return Zt={setNotification:(e,r,n,a,i,s,o)=>t(function(e,t,r,n,a,i,s){return{type:"customcontrol.propertybag.mode.setnotification",execute({dispatch:o,getState:c},l){const u={uniqueId:t||"",messages:[e],priority:0,notificationLevel:Ye.a.error,actions:[{actions:[function(){}],message:""}]};o(Object(We.b)(r,n,u,a));const d=c(),h=new I.a(i,p.a.fromExternalGuid(s)),g=Object(Ke.a)(d,h.etn,n);return h&&g&&(2===g.RequiredLevel||1===g.RequiredLevel)&&o(Object(Qe.b)(r,n,!1,a)),!0},sync:!0}}(e,r,n,a,i,s,o)),clearNotification:(e,r,n,a,i,s)=>t(function(e,t,r,n,a,i){return{type:"customcontrol.propertybag.mode.clearnotification",execute({dispatch:n,getState:a},s){const o=Object(f.A)(a(),{controlName:t,id:e},r);if(o){i=i||"";const a=Object.keys(o);let s=null;for(let c=a.length-1;c>-1;--c)a[c]===i&&(s=o[a[c]],s.actions=null,s.messages=null,s.notificationLevel=null,n(Object(We.b)(e,t,s,r)))}return!0},sync:!0}}(e,r,n,0,0,s))},er={setState:e=>!0,logMessage:(e,r,n)=>{t(function(e,t,r){return{type:"customcontrol.log",execute({dispatch:n,getState:a},i){const s=i.TraceManager.getTracer("customcontrol"),o=e+": "+t;switch(r){case He.a.Error:s.error(o);break;case He.a.Info:s.info(o);break;case He.a.Warning:s.warn(o);break;case He.a.Verbose:s.debug(o)}},sync:!0}}(e,r,n))}},$t={isGetBarcodeValueOperationAvailable:()=>t(Object(ke.c)()),isTakePictureOperationAvailable:()=>t(Object(ke.e)()),isCaptureVideoOperationAvailable:()=>t(Object(ke.b)()),isCaptureAudioOperationAvailable:()=>t(Object(ke.a)()),isOpenARViewerAvailable:()=>t(Object(ke.d)())},tr={clearNestedChild:e=>!0,createAccessibilityComponent:Rt.a,createCommandManagerUXComponent:()=>{let e=null;return t=>{const r=ur(t);return hr(e,t.selectedRecords)?r.selectedRecords=e:e=r.selectedRecords,lr(r)}},createKeyboardShortcut:Rt.b,createXrmForm:(e,r,n,a)=>function(e,t,r,n,a){return!!e(Object(wt.b)(t,r,n,new p.a(a)))}(t,e,r,n,a),createXrmGrid:(e,r,n,a)=>{const i=[O.a.AssociatedGrid,O.a.CustomGrid,O.a.SubGrid,O.a.MainGrid];if(e&&-1===i.indexOf(e.contextTokenType))for(const a in n)if("Grid"===n[a].Type){const i=n[a];t(Object(je.c)(i.TargetEntityType||i.EntityName,i.ViewId,r,e));break}return function(e,t,r,n,a){const i=Object(N.vb)(n);if(t){let n;switch(t.contextTokenType){case O.a.SubGrid:n=3;break;case O.a.AssociatedGrid:n=2;break;case O.a.MainGrid:case O.a.CustomGrid:n=1;break;default:const e=[{name:"contextToken",value:JSON.stringify(t)},{name:"controlName",value:a},{name:"isEditableGrid",value:i}];ue.a.getInstance().eventManager.ReportComponentFailure("ClientApi.XrmCommandObjectWrapper.createXrmGridWrapper",new Error("Unknown context token type for grid"),null,e),n=1}return!!e(Object(wt.c)(t,r,i,n,a))}return!0}(t,e,r,n,a)},registerNewControl:(e,r,n,a)=>function(e,t,r,n,a){return!!e(Object(wt.e)(t,r,n,a))}(t,e,r,n,a),executeAddOnLoad:(e,r)=>{t(function(e,t){return{type:"customcontrol.executeAddOnLoad.async",sync:!0,execute({dispatch:r,getState:n},a){e.gridRunOnLoad((e,n,i)=>{if(a.ScriptManager.containerExists(e)){const s=a.ScriptManager.getContainer(e).getEventManager();r(s.runOnGridDataLoad(t,1,i,n))}})}}}(e,r))},addSessionTab:(e,r)=>t(function(e,t){return{type:"execute.addsessiontab.async",execute({dispatch:r,getState:n},a){const i=n(),s=Object(K.d)(i,t);let o=!0;if(e){if(s.forEach(t=>{e.id===t.id&&(o=!1)}),o){if("quickViewFormTab"===e.type){let n=!1;const a=e,o=Object(Q.a)(6),c=Object(J.E)(i,a.entityFormOptions.entityName),l="activitypointer";let u;u=i.data.entities[l]&&i.data.entities[l].hasOwnProperty(a.entityFormOptions.entityId)?Object(f.ec)(i,l,new p.a(a.entityFormOptions.entityId)):Object(f.ec)(i,a.entityFormOptions.entityName,new p.a(a.entityFormOptions.entityId));const d=new I.a(a.entityFormOptions.entityName,new p.a(a.entityFormOptions.entityId)),h=[];if(!u){const e=r(Object(Z.d)(d,[c]));h.push(e)}let g=Object(ee.h)(i,a.entityFormOptions.entityName,o);if(p.a.isNullOrEmpty(g)){const e=r(Object($.b)(d,null,o)).then(e=>{g=e,p.a.isNullOrEmpty(g)||g===$.a||(n=!0)});h.push(e)}else n=!0,a.entityFormOptions.formId=g.guid;Promise.all(h).then(()=>{a.entityFormOptions.formId=n?g.guid:"",a.entityMetadata={DisplayName:i.metadata.entities[a.entityFormOptions.entityName].DisplayName},i.data.entities[l]&&i.data.entities[l].hasOwnProperty(a.entityFormOptions.entityId)?a.title=Object(f.ec)(i,l,new p.a(a.entityFormOptions.entityId)):a.title=Object(f.ec)(i,a.entityFormOptions.entityName,new p.a(a.entityFormOptions.entityId)),s.unshift(a),r(re({sessionTabs:s,activeTabId:a.id,messageId:n?"":"quick_view_form_not_exist_message"},t))})}else s.unshift(e),r(re({sessionTabs:s,activeTabId:e.id},t));return Promise.resolve()}r(re({sessionTabs:s,activeTabId:e.id},t))}}}}(e,r)),closeSessionTab:(e,r)=>t(ie(e,r)),updateSessionTab:(e,r)=>t(le(e,r)),closeAllSessionTabs:e=>t(ae(e)),dismissMessage:e=>t(se(e)),markActiveTab:(e,r,n)=>t(Object(ce.b)(e,r,n)),initializeReferencePanelControl:(e,r)=>t(oe(e,r)),cleanReferencePanelState:e=>t(ne(e)),executeNotifyHandlersThatEventOccurred:e=>t(function(e){return{type:"execute.notifyhandlersthatevenoccurred.async",execute({dispatch:t,getState:r},n){let a=null;try{switch(e.eventName){case"onresultopened":t(Object(de.U)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onselection":t(Object(de.V)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onpostsearch":t(Object(de.S)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onlookuptagclick":const i="ClientApi.ExecuteNotifyHandlersThatEventOccurred.runOnLookupTagClick",s=e.contextToken,o=e.fieldName,c=e.record;let l=!1;const u=Object(de.u)(i,r(),n,e.pageId,c);u&&(l=t(u.runOnLookupTagClick(s,o,null,c,r()))),a=l}return Promise.resolve(a)}catch(e){throw ue.a.getInstance().eventManager.ReportComponentFailure("ClientApi.ExecuteNotifyHandlersThatEventOccurred.executeNotifyHandlersThatEventOccurred",e),e}}}}(e)),getConnectorsApi:e=>null,executeRollupRequest:(e,r,n)=>t(function(e,t,r){return{type:"customcontrol.executeRollupRequest.async",execute({dispatch:n,getState:a},i){if(e&&t){const a=new Me(e,t),s=Le.a.execute(a).then(e=>e.json()).then(a=>{if(a){const s=[];for(const e in a)-1!==e.indexOf("@")||e.startsWith("_")||s.push(e);const o=new I.a(e.entityType,p.a.fromExternalGuid(e.id));return n(Object(Re.a)(r,o,s)).then(()=>{i.EventManager.ReportComponentSuccess(Be.a+".Action",[{name:"APIName",value:Be.a+".Action.ExecuteRollupRequest"},{name:"target.entityType",value:e.entityType}])},r=>{i.EventManager.ReportComponentFailure(Be.a+".Actions",r,"refreshRecordData failure error message",[{name:"APIName",value:Be.a+".Actions.ExecuteRollupRequest"},{name:"target.entityType",value:e.entityType},{name:"target.id",value:e.id},{name:"fieldName",value:t},{name:"jsonResponse",value:a}])})}});return Le.a.Diagnostics.traceInfo(Be.a+".refreshRecordData","refresh record data return promise"),s}return Promise.resolve()}}}(e,r,n)),getResource:e=>t(function(e){return{type:"customcontrol.getresources.async",execute({dispatch:t,getState:r},n){const a=n.AssetLoader,i=r(),s=Object(Ve.t)(i);if(3===e.Type||2===e.Type)return a.loadRawData(s+e.Name)}}}(e)),getRecordSetQueryKey:e=>e?e.getPreviousQueryKey():null,loadResources:e=>t(Object(ze.a)(e)),triggerOfflineMetadataSync:()=>t(Object(Se.h)()),retrieveFormWithAttributes:(e,r,n)=>t(Object(jt.c)(new I.a(e),p.a.tryParse(r),n)),loadManifest:(e,r)=>t(Object(Oe.c)(e,r)),updateOutputs:(e,r,n,a,i,s,o)=>t(function(e,t,r,n,a,i,s){return{type:"outputs.update",execute({dispatch:o,getState:c},l){try{const l={},u={};if(i)for(const e of Object.keys(i)){const t=i[e];let r=e;switch(t.fieldName&&(r=t.fieldName),(t.paramType===Nt.a.LookupSimple||t.paramType===Nt.a.LookupCustomer||t.paramType===Nt.a.LookupOwner||t.paramType===Nt.a.LookupRegarding||t.paramType===Nt.a.LookupMultiEntity)&&t.value&&t.value instanceof Array&&(t.value.length>0?t.value=t.value[0]:t.value=null),t.type){case 0:l[r]=i[e];break;case 2:u[r]=i[e]}}const d=new Array,h=o(Object(me.a)(e,l,!1,!1,t,r,a,s));if(d.push(h),Object(V.a)(c(),e).forms){const t=o(Object(xt.b)(e,n,s,u));d.push(t)}else{const t=o(Object(At.b)(e,n,u));d.push(t)}return Promise.all(d)}catch(a){const s=n+" failed at updating its outputs",o=Object(v.b)(c(),n);return l.EventManager.ReportComponentFailure(o+".CustomControl.updateOutputs",a,s,[{name:"APIName",value:Be.a+".Actions.UpdateOutputs"},{name:"customControlId",value:n},{name:"pageId",value:e},{name:"entityTypeName",value:t},{name:"recordId",value:r},{name:"outputs",value:JSON.stringify(i)}]),l.TraceManager.getTracer("customcontrol").warn(o+" failed at updating its outputs"),null}},sync:!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,r,n,a,i,s,o)),updateFieldValue:(e,r,n,a,i,s,o)=>t(Object(me.a)(e,r,!1,n,a,i,s,o)),runCustomOpenRecord:(e,r,n,a)=>t(function(e,t,r,n){return{type:"record.open",execute(a,i){const s=i.ScriptManager.getContainer(e).getEventManager(),o=new p.a(r),c=Object(S.f)(n,o,t);let l=a.dispatch(Object(wt.b)(c,e,t,o));return l=new Ft.a(a,i,c,e,t,o),a.dispatch(s.runOnRecordOpen(n,r,l))}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,r,n,a)),getBoundFileObject:(e,r,n,a)=>{if(null==e||null==r||null==r.id||null==n)return null;const i={id:new p.a(r.id),etn:r.entityType};return t(Object(Kt.c)(e,i,n,a,"full"))},saveEmbeddedEntity:(e,r,n,a,i,s,o=!1,c)=>t(Object(Et.a)(e,r,n,a,i,s,o,c)),renderNestedCustomControl:Mt,renderReactSubtree:Ne.createPortal,retrieveView:(e,r,n,a)=>t(Object(Pe.a)(e,r,n,a)),retrieveViewSelector:(e,r)=>t(Object(Pe.b)(e,r)),retrieveGridData:e=>t(Object(Ce.d)(e)),retrieveRecordDataForForm:(e,r,n,a,i)=>t(Object(Z.e)(Lt(e),p.a.tryParse(r),n,a,i)),retrieveForm:(e,r,n)=>{const a=p.a.tryParse(r),i=Lt(e);return t(Object($.b)(i,a,n)).then(e=>t(Object(he.c)(a,i.etn)).then(()=>e))},retrieveEntityData:e=>t(Object(Ie.f)(e,!1,[])),retrieveChartDrilldownAttributes:e=>{return t((r=e,{type:"customcontrol.charts.attributes.retrieve.async",execute:({dispatch:e,getState:t},n)=>e(Object(Ie.f)(r,!0,[])).then(()=>{const e=t(),n=Object(Ke.d)(e,r);if(n&&Object.keys(n).length>0){const t={};for(const a in n){const i=n[a];Bt(e,r,a,i)&&(t[a]=i)}return t}return null},e=>{const t=e.get_message();return n.EventManager.ReportComponentFailure(Be.a+".CustomControl.retrieveChartDrilldownAttributes",new Error(t),t,[{name:"APIName",value:Be.a+".Actions.RetrieveChartDrilldownAttributes"},{name:"Entity",value:r}]),null})}));var r},refreshDataSetParameter:(e,r)=>t(It(e,r)),retrieveLookupMetadataAction:e=>{return t((r=e,{type:"customcontrol.retrieveLookupMetaData.async",execute({dispatch:e,getState:t},n){if(r instanceof Pt.a){const n={retrieveGridDataAction:t=>e(Object(Ce.d)(t)),retrieveViewAction:(t,r,n,a)=>e(Object(Pe.a)(t,r,n,a)),retrieveViewSelectorAction:(t,r)=>e(Object(Pe.b)(t,r)),runPreSearch:(r,n,a)=>e(Object(de.W)(Object(S.j)(t(),r),r,n,a)),runSetAdditionalParams:(r,n,a)=>e(Object(de.X)(Object(S.j)(t(),r),r,n,a)),refreshCustomDataProviderAction:(t,r,n,a)=>e(Object(at.b)(t,r,n,a)),getEntityMetadataAction:(t,r)=>e(Object(Ie.f)(t,!1,r))};return r.retrieveLookupMetadata(t,n)}}}));var r},retrieveDataSetLookupCellParameter:(e,r,n)=>t(function(e,t,r){return{type:"customcontrol.retrieveDataSetLookupCellParameter.async",execute:({dispatch:n,getState:a},i)=>n(It(t,r)).then(()=>{const r=t.retrieveDataSetObject(a(),e,i);return Promise.resolve(r)}).catch(e=>{i.EventManager.ReportComponentFailure(Be.a+".Actions",{name:"error",message:e.get_message()},null,[{name:"APIName",value:Be.a+".Actions.RetrieveDataSetLookupCellParameter"}])})}}(e,r,n)),updateControlMemoizedDataSet:(e,r,n)=>t(function(e,t,r){return{type:"customcontrol.updateControlMemoizedDataSet",sync:!0,execute({dispatch:n,getState:a},i){const s=a(),o=e.retrieveDataSetObject(s,null,null,null,i);e.linkToParameter(o,t),e.updateControlMemoizedParameter(s,o,!0,r)}}}(e,r,n)),loadResourceStrings:e=>{return t((r=e,{type:"customcontrol.loadresourcestrings.async",execute({dispatch:e,getState:t},n){const a=r.CustomControlId;if(!a)return Promise.resolve();const i=t(),s=Ge.a.getControlsResourceKeyList(a);if(!s)return Promise.resolve();const o=Object(Xe.d)(i);if(!o)return e(Object(Ue.e)(s));const c=[];for(const e of s)o.hasOwnProperty(e)||c.push(e);return 0===c.length?Promise.resolve():e(Object(Ue.e)(c))}}));var r},retrieveLookupData:e=>t(Object(Ce.d)(e)),setFieldControlPersonalization:(e,r,n)=>t(Object(Ee.j)(e,r,n)),setGridControlPersonalization:(e,r,n)=>t(Object(Ee.m)(e,r,n)),setDashboardControlPersonalization:(e,r,n)=>t(Object(Ee.i)(e,r,n)),setGenericControlPersonalization:(e,r,n)=>t(Object(Ee.k)(e,r,n)),setGlobalControlPersonalization:(e,r)=>t(Object(Ee.l)(e,r)),setPowerBISignedInState:(e,r)=>t(Object(ge.b)(e,r)),beginSecureSessionForResource:(e,r,n,a)=>t(function(e,t,r,n){return{type:"customcontrol.beginsecuresessionforresource",execute(a,i){const s=new De.a(i,a);return n?s.beginSecureSessionForResource(e,t,r):s.beginSecureSessionForResourceSilent(e,t,r)},shouldReceiveFullStore:!0}}(e,r,n,a)),setXrmObject:e=>{},addPendingCommandManagerId:(e,r,n,a)=>{let i;t(Object(Tt.a)(e,r,n,a));return{promise:new Promise(e=>{i=e}),resolve:i}},initializeCommandManager:(e,r,n,a,i)=>{let s;t(Object(Tt.b)(e,r,n,a,i));return{promise:new Promise(e=>{s=e}),resolve:s}},retrieveRecordCommand:(e,r,n,a,i,s,o,c,l,u)=>t(Object(Tt.c)(u,e,r,n,a,i,s,o,c,l)),setValue:(e,r,n,a)=>e&&r?t(function(e,t,r,n){const a=[{name:"snapshotId",value:n},{name:"entityTypeName",value:t.etn},{name:"attributeNameValuePairs.length",value:r?Object.keys(r).length:null}];return{type:"control.update.value.by.snapshot.async",execute({dispatch:i,getState:s},o,c){const l=s(),u=Object(S.j)(l,e),d=Object(S.x)(u),h=Object(ye.a)(l,n,t,r,!1,u,o.TraceManager.getTracer("Forms.UpdateValue")),g=p.a.isNullOrEmpty(t.id)?_e.a.Create:_e.a.Update;if(a.push({name:"CorrelationId",value:c.correlationId},{name:"ContextId",value:c.contextId},{name:"ActionStack",value:c.stack},{name:"mode",value:g}),n)return i(Object(be.b)(l,n,h)),o.EventManager.ReportComponentSuccess("Forms.UpdateValue.updateDataSnapshot",a),Promise.resolve();const m=Object(fe.b)(l,t,h,d,g),b=m.payload.snapshotId;return i(m),a.push({name:"newSnapshotId",value:b}),o.EventManager.ReportComponentSuccess("Forms.UpdateValue.createDataSnapshotAction",a),Promise.resolve(b)},getFailureParameters:(e,t)=>a}}(a,e,r,n)).then(e=>Promise.resolve(e||n)):Promise.reject("setValue: entityReference and controlKeyValuePairs parameters are required"),save:(e,r=[])=>t(Object(Te.c)(e,!1,r)),openPopup:e=>t(Object(Y.a)(e)),closePopup:e=>t(Object(W.a)(e)),loadWebResource:(e,r)=>t(qe(e,r)),registerOngoingWork:(e,r,n,a)=>t(function(e,t,r,n){return{type:"customcontrol.registerworkoutstanding",execute:({dispatch:a,getState:i},s)=>(Ct.a.getInstance().addWorkOutstandingPromise(e,t,r,n),Promise.resolve())}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,r,n,a)),isPresenceEnabledEntity:e=>Object(H.b)(e),getPresenceMappedField:e=>Object(H.a)(e),fireXrmEvent:(e,r,n,a,i)=>{const s=t(Object(ve.b)(r,n));let o=null;if(s&&s.ui&&s.ui.controls&&(o=s.ui.controls.get(e)),o)switch(a){case 0:o.fireOnKeyPress&&o.fireOnKeyPress()}},sendLookupRequest:(e,r,n,a,i,s,o)=>t(Wt(e,!0,r,n,a,i,s,o)),runPreSearch:(e,r,n)=>{t(function(e,t,r){return{type:"CCF.RunPreSearch",execute({dispatch:n,getState:a}){n(Object(St.f)(r,t,e)),n(Object(de.W)(e,r,t)),n(Object(de.X)(e,r,t)),n(Object(St.e)(r,t,e))},sync:!0}}(e,r,n))},runOnReadyStateComplete:(e,r,n)=>{t(function(e,t,r){return{type:"CCF.RunOnReadyStateComplete",execute({dispatch:n,getState:a},i){i.ScriptManager.containerExists(t)&&n(i.ScriptManager.getContainer(t).getEventManager().runOnReadyStateComplete(e,null,r))},sync:!0}}(e,r,n))},retrieveLookupRecordsBySearchString:(e,r,n)=>t(Object(Jt.a)(e,r,n)),retrieveLookupRecordsByIds:(e,r,n)=>t(Object(Jt.b)(e,r,n))},e={actions:tr,propBagMethods:{utils:er,navigation:n,device:$t,mode:Zt}},e}}))(s.a);class cr extends i.Component{constructor(e,t){super(e),this._updateCounter=0,this._isUpdateScheduled=!1,this._reRunMapStateToProps=()=>{this._isUpdateScheduled||(this._isUpdateScheduled=!0,Object(sr.c)(()=>{this._isUpdateScheduled=!1,this._updateCounter++,this.forceUpdate()}))},this._reRunMapStateToProps=this._reRunMapStateToProps.bind(this)}render(){let e=null,t=null;return this.context&&this.context.CustomControlGlobalHelper&&(e=this.context.CustomControlGlobalHelper,t=this.context.TraceManager.getLogLevel()),i.createElement(o.a.Provider,{value:this.context},i.createElement(or,Object.assign({},this.props,{contextHelper:e,logLevel:t,updateCounter:this._updateCounter,reRunMapStateMainProps:this._reRunMapStateToProps})))}}function lr(e){const t="cm"+Object(ar.a)();return i.createElement(nr.a,{commandbarDisplayMode:e.commandbarDisplayMode,addedCommandList:e.addedCommandList,key:e.key,iconPosition:e.iconPosition,id:e.id,commandManagerId:e.commandManagerId||t,ribbonId:e.ribbonId,selectedRecords:e.selectedRecords,width:e.width,metaDataLoadedResolve:e.metaDataLoadedResolve,isHidden:e.isHidden,commandBarStyle:e.commandBarStyle,customCommandManagerStyle:e.customCommandManagerStyle,contextToken:e.contextToken,rootZIndex:e.rootZIndex,customControlType:e.customControlType})}function ur(e){return{commandbarDisplayMode:void 0!==e.commandbarDisplayMode&&null!==e.commandbarDisplayMode?e.commandbarDisplayMode:ir.a.IconLabel,id:e.id,commandManagerId:e.commandManagerId,ribbonId:e.ribbonId,mainMenuLength:e.mainMenuLength,iconPosition:e.iconPosition,selectedRecords:dr(e.selectedRecords),key:e.key,commandBarStyle:e.commandBarStyle,customCommandManagerStyle:e.customCommandManagerStyle,isHidden:e.isHidden,width:e.width,metaDataLoadedResolve:e.metaDataLoadedResolve,addedCommandList:e.addedCommandList,contextToken:e.contextToken,rootZIndex:e.rootZIndex,customControlType:e.customControlType}}function dr(e){const t=[];if(e)for(const r of e)t.push(Lt(r));return t}function hr(e,t){if(e===t)return!0;if(e&&t&&e.length===t.length){const r=e.length;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}return!1}cr.contextType=a.a},"23K5":function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a{generate(e,t){if(!t||!t.getProcessId())return null;return{businessProcessFlowInstanceId:t.getProcessInstanceId(),activeStageId:n.a.tryParseOrNull(t.getActiveStageId()),displayState:t.getDisplayState(),processState:t.getProcessState(),state:t.getState(),status:t.getStatus(),isVisible:t.isVisible(),data:{activePath:t.getActivePath(),selectedStageId:n.a.tryParseOrNull(t.getSelectedStageId()),businessProcessFlowId:t.getProcessId(),actionLogCollection:t.getActionLogCollection(),processNavigationBehavior:{navigationBehavior:t.getBpfNavigationBehavior()}}}}}},"3MuQ":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="section.label";function i(e,t,r,i){const s=Object(n.v)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:s,sectionName:r}}}},"3c9R":function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return d}));var n=r("jRy5"),a=r("dHD5"),i=r("i1f0"),s=r("mIxf"),o=r("bT7G"),c=r("arV0"),l=r("ApeL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const u="attribute.precision";function d(e,t,r,d){return{type:"attribute.precision.update",sync:!0,execute({dispatch:h,getState:p},g){let m=p();h(function(e,t,r,i){if(t&&t.contextTokenType&&t.contextTokenType===n.a.GridRow)return Object(l.e)(e,t,r,i);const s=Object(a.x)(t);return{type:u,payload:i,meta:{pageId:e,contextKey:s,dataFieldName:r}}}(e,t,r,d)),m=p();let b=null,f=null,y=null,_=null;if(t&&t.contextTokenType&&t.contextTokenType===n.a.GridRow)b=t.entityTypeName?t.entityTypeName:null,f=t.recordId?t.recordId:null,y=Object(a.t)(t),_=Object(a.r)(t);else{const r=Object(c.g)(m,e);b=r&&r.entityTypeName?r.entityTypeName:null,f=r&&r.id?r.id:null,y=null,_=t}const v=Object(i.ac)(m,e,t),S=Object(o.d)(m,v,{etn:b,id:f},r),O={[r]:S};h(Object(s.a)(e,O,!0,!0,b,f?f.guid:null,y,_))}}}},"49Nd":function(e,t,r){"use strict";r.d(t,"g",(function(){return n})),r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return o})),r.d(t,"f",(function(){return c})),r.d(t,"e",(function(){return l})),r.d(t,"j",(function(){return u})),r.d(t,"h",(function(){return d})),r.d(t,"i",(function(){return h})),r.d(t,"k",(function(){return p}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n="Grid_Paging_Mask",a="Grid_StatusMessage_Mask",i="Grid_ItemsSelected_Mask",s="Grid_TotalCount_Mask",o="Grid_ToolTip_FirstPage",c="Grid_ToolTip_PreviousPage",l="Grid_ToolTip_NextPage",u="Grid_TotalCount_SpaceMask",d="Grid_TotalCount_Approximate",h="Grid_TotalCount_Exact",p=[n,a,i,s,o,c,l,u,d,h]},"4U8P":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="header.commandbarvisible";function i(e,t,r){const i=Object(n.v)(t);return{type:a,payload:r,meta:{pageId:e,contextKey:i}}}},"4XwW":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n="form.setSelectedFormId";function a(e,t){return{type:n,payload:{formId:t},meta:{pageId:e}}}},"4rWj":function(e,t,r){"use strict";r.d(t,"a",(function(){return lt}));var n=r("c/eZ"),a=r("OWbt"),i=r("SAYH"),s=r("dMZy"),o=r("TYIz"),c=r("mhYf"),l=r("PbI6"),u=r("FHmp"),d=r("2YQW");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const h=Object(d.d)({[o.a]:function(e,t){return Object.assign(Object.assign({},e),{collapsed:t.payload})},[c.a]:function(e,t){return Object.assign(Object.assign({},e),{visible:t.payload})},[l.a]:function(e,t){return Object.assign(Object.assign({},e),{contentType:t.payload})},[u.a]:function(e,t){return Object.assign(Object.assign({},e),{label:t.payload})}},{collapsed:!1,visible:!0,label:"",sectionNames:[],domId:null,showLabel:!0,contentType:"cardSections"});var p=r("vlcQ"),g=r("3MuQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const m=Object(d.d)({[p.a]:function(e,t){return Object.assign(Object.assign({},e),{visible:t.payload})},[g.a]:function(e,t){return Object.assign(Object.assign({},e),{label:t.payload})}},{parentTabId:null,visible:!0,label:"",controlNames:[],domId:null,semanticZoomDomId:null});var b=r("lju1"),f=r("e3W2"),y=r("ZMWz"),_=r("Zpd/"),v=r("hA8P"),S=r("yl9a"),O=r("/5se"),I=r("Khp3"),C=r("xorU"),j=r("BoVI"),P=r("TsER");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const T=Object(d.d)({[f.a]:function(e,t){return Object.assign(Object.assign({},e),{visible:t.payload})},[y.a]:function(e,t){return Object.assign(Object.assign({},e),{label:t.payload,labelSource:b.a.ClientAPI})},[_.a]:function(e,t){return null!==t.payload?Object.assign(Object.assign({},e),{disabledByClientApi:t.payload}):e},[S.a]:function(e,t){const r=Object.assign(Object.assign({},e.parameters),t.payload);return Object.assign(Object.assign({},e),{parameters:r})},[O.a]:function(e,t){const r=Object.assign(Object.assign({},e.parameters),{defaultviewid:t.payload});return Object.assign(Object.assign({},e),{parameters:r})},[j.a]:function(e,t){const r=Object.assign(Object.assign({},e.views),t.payload.views);return Object.assign(Object.assign({},e),{views:r})},[C.a]:function(e,t){const r=e.customFilter?e.customFilter:[];for(let n=r.length-1;n>=0;n--)if(r[n].entityLogicalName===t.payload.entityLogicalName){if(r[n].customFilter===t.payload.customFilter)return e;break}return r.push(t.payload),Object.assign(Object.assign({},e),{customFilter:r})},[C.c]:function(e,t){const r=[];return r.push({customFilter:"START_FLAG",entityLogicalName:""}),Object.assign(Object.assign({},e),{customFilter:r})},[C.b]:function(e,t){const r=e.customFilter?e.customFilter:[];if(r.length>0&&"END_FLAG"===r[r.length-1].customFilter)return e;return r.push({customFilter:"END_FLAG",entityLogicalName:""}),Object.assign(Object.assign({},e),{customFilter:r})},[I.a]:function(e,t){if(t.payload)return Object.assign(Object.assign({},e),{notifications:Object.assign(Object.assign({},e.notifications),t.payload)});return Object.assign(Object.assign({},e),{notifications:t.payload})},[v.a]:function(e,t){const r=[].concat(e.parameters);let n=e;null!==t.payload&&(r.DisableMru=t.payload?"true":"false",n=Object.assign(Object.assign({},n),{parameters:r}));return n},[P.a]:
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){return Object.assign({},e)},[j.d]:function(e,t){return Object.assign(Object.assign({},e),{initializationIntent:t.payload})}},{parentSectionName:null,visible:!0,label:"",valid:!0,domId:null,notifications:null,dataFieldName:null});var E=r("Qn2w");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function w(e,t,r){const n=Object.assign({},e),a=Object.keys(n).length,i={};return r?(n.hasOwnProperty(t)&&delete n[t],Object.assign({},n)):a>0?n.hasOwnProperty(t)?n:(i[t]=!0,Object.assign(Object.assign({},e),i)):(i[t]=!0,i)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const F=Object(d.d)({[E.a]:function(e,t){return Object.assign({},w(e,t.meta.controlName,t.payload.isValid))}},{});var x=r("Bo7t"),A=r("Tg1Y"),N=r("+Ajx"),D=r("ofgb"),k=r("1HWW"),M=r("9NSo"),R=r("+hq9"),L=r("Q1Tc");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const B=Object(d.d)({[L.a]:function(e,t){return Object.assign({},t.payload.controlUnboundOutputs)}},{});var V=r("lxh6"),G=r("Y5AI"),U=r("MgYC"),X=r("3HPu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const z=Object(d.d)({[X.a]:function(e,t){return Object.assign({},w(e,t.meta.attributeName,t.payload.isValid))}},{});var q=r("FhIR"),H=r("NtHU"),W=r("4U8P"),Y=r("m+2h");const Q={tabs:Object(d.b)("tabId",h),sections:Object(d.b)("sectionName",m),controls:Object(d.b)("controlName",T),selectedTab:function(e=Object(s.a)(),t){if(t.type===A.a){if(e.navigationStack&&e.navigationStack.length>0)return Object.assign(Object.assign({},e),{tabId:e.navigationStack[e.navigationStack.length-1],navigationStack:e.navigationStack.slice(0,e.navigationStack.length-1)})}else if(t.type===x.a){const r=(e.navigationStack||[]).slice(0);return e.tabId&&e.tabId!==t.payload&&r.push(e.tabId),Object.assign(Object.assign({},e),{tabId:t.payload,navigationStack:r})}return e},selectedRelatedEntity:function(e=null,t){return t.type===N.a?t.payload:e},xrmReady:function(e=!1,t){return t.type===a.b?t.payload.xrmReady:e},isSaving:function(e=!1,t){return t.type===D.a?t.payload.savingState:e},controlUnboundOutputs:B,inlineQuickForms:function(e=null,t){return t.type===a.a?t.payload.formUIState.inlineQuickForms:e},invalidControls:F,invalidAttributes:z,label:function(e="",t){return t.type===M.a?t.payload.label:e},hasOfflineChanges:function(e=!1,t){return t.type===k.a?t.payload.hasOfflineChanges:e},viewportWidth:function(e=0,t){return t.type===V.a?t.payload.viewportWidth:e},viewportHeight:function(e=0,t){return t.type===V.a?t.payload.viewportHeight:e},formId:function(e=i.a.EMPTY,t){return e},showHeaderFieldsInSection:function(e=!1,t){return t.type===G.a?t.payload.showHeaderFieldsInSection:e},headerFieldsInFlyout:function(e,t){if(t.type===U.a){const e=new Set,r=t.payload.headerFieldsInFlyout;for(let t=0;t<r.length;t++)e.add(r[t].Name);return e}return e},isAutoSaving:function(e=!1,t){return t.type===R.a?t.payload.isAutoSaving:e},header:function(e=null,t){switch(null==e&&(e={bodyVisible:!0,commandBarVisible:!0,tabNavigatorVisible:!0}),t.type){case H.a:return Object.assign(Object.assign({},e),{bodyVisible:t.payload});case W.a:return Object.assign(Object.assign({},e),{commandBarVisible:t.payload});case q.a:return Object.assign(Object.assign({},e),{tabNavigatorVisible:t.payload})}return e},footer:function(e=null,t){switch(null==e&&(e={visible:!0}),t.type){case Y.a:return Object.assign(Object.assign({},e),{visible:t.payload})}return e},formScrollAndFocusState:function(e,t){return t.type===j.e?t.payload:e}},K=Object(d.a)(Q),J=Object(d.b)("contextKey",K);var Z=r("0bz+"),$=r("4UCL"),ee=r("WKRf");const te={snapshotId:Z.a,updatedFields:
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){if(t.type===$.a){const r={},n=t.payload.fieldValues;if(!n)return e;for(const t in n)e&&e.hasOwnProperty(t)||(r[t]=n[t]);return Object.keys(r).length>0?Object.assign(Object.assign({},e),r):e}if(t.type===$.b){const r={};if(t.payload.keepFields)for(const n of t.payload.keepFields)e[n]&&(r[n]=e[n]);return r}return e},isDeleted:function(e=!1,t){return t.type===ee.a?t.payload:e}},re=Object(d.a)(te),ne=Object(d.b)("contextKey",re);var ae=r("3c9R"),ie=r("mlKL"),se=r("cf3Y"),oe=r("/q65"),ce=r("91Ew"),le=r("KnyI"),ue=r("tvJg"),de=r("TAgK"),he=r("RREX"),pe=r("z5LE");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ge=Object(d.d)({[ae.a]:function(e,t){return Object.assign(Object.assign({},e),{Precision:t.payload,PrecisionSource:he.a.attribute})},[ie.a]:function(e,t){return Object.assign(Object.assign({},e),{RequiredLevel:t.payload})},[se.a]:function(e,t){return Object.assign(Object.assign({},e),{Format:t.payload})},[oe.a]:function(e,t){return Object.assign(Object.assign({},e),{Targets:t.payload})},[ce.a]:function(e,t){let r=e.OptionSet;const n=t.payload.option;if(!r||!n)return e;const a=t.payload.index;r=r.slice(0),a>=0&&a<r.length?r.splice(a,0,n):r.push(n);return Object.assign(Object.assign({},e),{OptionSet:r})},[le.a]:function(e,t){let r=e.OptionSet;if(!r)return e;const n=t.payload;let a;r=r.slice(0);for(let t=0;t<r.length;t++)if(a=r[t],a.Value===n)return r.splice(t,1),Object.assign(Object.assign({},e),{OptionSet:r});return e},[ue.a]:function(e,t){if(!e.OptionSet)return e;return Object.assign(Object.assign({},e),{OptionSet:[]})},[de.a]:function(e,t){if(!e.OptionSet)return e;const r=t.payload;return Object.assign(Object.assign({},e),{OptionSet:r||[]})},[pe.a]:function(e,t){if(t.payload)return Object.assign(Object.assign({},e),{notifications:Object.assign(Object.assign({},e.notifications),t.payload)});return Object.assign(Object.assign({},e),{notifications:t.payload})}},{Precision:null,PrecisionSource:null,RequiredLevel:null,Format:null,OptionSet:null,IsValidForCreate:null,IsValidForUpdate:null,notifications:null,Targets:null});var me=r("BvQu"),be=r("LLfG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const fe=Object(d.d)({[be.a]:function(e,t){if(t.payload===me.a.Dirty){const r={};if(t.meta.dataFieldName&&Object.keys(e).lastIndexOf(t.meta.dataFieldName)>-1){for(const n of Object.keys(e))n!==t.meta.dataFieldName&&(r[n]=e[n]);return Object.freeze(r)}return e}return Object.assign(Object.assign({},e),{[t.meta.dataFieldName]:t.payload})}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},{});const ye={attributes:Object(d.b)("dataFieldName",ge),submitModes:fe},_e=Object(d.a)(ye),ve=Object(d.b)("contextKey",_e);var Se=r("+aj2"),Oe=r("NDmk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Ie=Object(d.d)({[Se.a]:function(e,t){return Object.assign(Object.assign({},e),{value:t.payload.value})},[Oe.a]:function(e,t){return Object.assign(Object.assign({},e),{value:t.payload.value})}},{reason:"",value:""});var Ce=r("f/sd"),je=r("SVnG"),Pe=r("GodX"),Te=r("N+Ya"),Ee=r("dIqG"),we=r("hK10");const Fe=Object(d.d)({[Te.a]:function(e,t){const r=Object.assign({},e);return xe(r,t.payload.label,t.payload.currentLanguageId),r.labelSetByClientAPI=!0,Object.freeze(r)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */,[Ee.a]:function(e,t){const r=t.payload;return Object.freeze(Object.assign(Object.assign(Object.assign({},e),r),{showSetByClientAPI:!0}))}},{titles:{},tooltipTitles:{},privileges:[],relationshipName:"",id:"",area:"",titleResourceId:"",client:"",availableOffline:!1,icon:"",sequence:"",show:!0,viewId:""});function xe(e,t,r){const n=Object(we.b)(e,r);if(n)n.Value=t;else{const n=null===r?"":r.toString();e.titles[""]={Name:n,Value:t}}return e}const Ae=Object(d.d)({},{}),Ne=Object(d.d)({},{}),De=Object(d.d)({},{});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var ke=r("dtbk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Me=Object(d.b)("navigationItemId",Fe);const Re={navBarAreas:Ae,navPaneIsvItems:Ne,navBarByRelationshipItems:function(e,t){if(t.type===ke.a){if(t.payload.allNavBarByRelationshipItems&&t.payload.allNavBarByRelationshipItems.length>0){const r=Object.assign({},e);return t.payload.allNavBarByRelationshipItems.forEach(e=>{e&&e.id&&(r[e.id]||(r[e.id]=Object.assign(Object.assign({},{titles:{},tooltipTitles:{},privileges:[],relationshipName:"",id:"",area:"",titleResourceId:"",client:"",availableOffline:!1,icon:"",sequence:"",show:!0,viewId:""}),{id:e.id})),xe(r[e.id],e.title,t.payload.currentLanguageId))}),Object.freeze(r)}return e}return Me(e,t)},navBarItems:De},Le=Object(d.a)(Re);var Be=r("Bj/n"),Ve=r("jTSi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Ge=Object(d.d)({[Be.a]:function(e,t){const r={Message:t.payload.message,Level:t.payload.level,UniqueId:t.payload.uniqueId,Buttons:t.payload.buttons,MessagePlaceholders:t.payload.placeholders,ControlName:t.payload.controlName,ComponentId:t.payload.componentId};return Object.assign(Object.assign({},e),{[t.payload.uniqueId]:r})},[Ve.a]:function(e,t){if(Object.keys(e).length<1)return e;const r={};if(t.payload.uniqueId)for(const n of Object.keys(e))n!==t.payload.uniqueId&&(r[n]=e[n]);return r}},{});var Ue=r("jR7L"),Xe=r("TD3W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ze=Object(d.d)({[Ue.a]:function(e,t){if(t.type===Ue.a)return Object.assign(Object.assign({},e),t.payload);return e},[Xe.a]:function(e,t){const r=Object.assign({},e);return delete r[t.payload.relationship],Object.freeze(r)}},{});var qe=r("MktZ"),He=r("uPT+"),We=r("LAcd"),Ye=r("rdSB"),Qe=r("+Vem"),Ke=r("iHOm"),Je=r("6Qf/"),Ze=r("jRy5"),$e=r("dHD5"),et=r("59++"),tt=r("QiMq"),rt=r("9wSR"),nt=r("7TDv");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const at={selectedFormId:null,forms:{}};var it=r("gDO8"),st=r("XlXz");var ot=r("4XwW");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const ct=Object(d.a)({loadingState:function(e=Ce.a.Initial,t){return t.type===qe.a?t.payload:e},formId:function(e=null,t){return t.type===a.a?t.payload.formId:e},navigation:Le,notifications:Ge,powerBISignedInState:function(e="NotSignedIn",t){return t.type===He.a?t.payload:e},suppressDuplicateDetection:function(e=!1,t){return t.type===We.a?t.payload.suppressDuplicateDetection:e},customDataProviderOutputs:je.a,formlessControlOutputs:Pe.a,output:Ie,datasets:Ke.a,metadata:ve,records:ne,forms:J,entityReferenceByRelationship:ze,referenceInformationByRelationship:function(e={},t){return t.type===Qe.a?t.payload:e},primaryEntity:function(e="",t){return"set.primary.entity"===t.type?t.payload:e},visitedTabNames:function(e=null,t){if(t.type===tt.a){const r=t.payload;if(!e)return r?new Set([r]):null;if(!r||e.has(r))return new Set(e);const n=new Set(e);return n.add(r),n}return e},autoSaveInterval:function(e=rt.a,t){return t.type===rt.d?e=rt.a:t.type===rt.b&&e<rt.c&&(e+=rt.a),e},formInstances:function(e={list:[],formInstanceIdByControlName:{},controlNameByFormInstanceId:{}},t){if(t.type===j.b){const r=t.payload.formInstanceId,n=t.payload.controlName,a=[...e.list,r],i=Object.assign(Object.assign({},e.formInstanceIdByControlName),{[n]:r}),s=Object.assign(Object.assign({},e.controlNameByFormInstanceId),{[r]:n});e=Object.assign(Object.assign({},e),{list:a,formInstanceIdByControlName:i,controlNameByFormInstanceId:s})}else if(t.type===j.g){const r=t.payload.formInstanceId,a=t.payload.controlName,i=e.list.filter(e=>e!==r);if(e.formInstanceIdByControlName[a]&&e.controlNameByFormInstanceId[r]){const t=a,s=e.formInstanceIdByControlName,o=t,c=(s[o],Object(n.__rest)(s,["symbol"==typeof o?o:o+""])),l=r,u=e.controlNameByFormInstanceId,d=l,h=(u[d],Object(n.__rest)(u,["symbol"==typeof d?d:d+""]));e=Object.assign(Object.assign({},e),{list:i,formInstanceIdByControlName:c,controlNameByFormInstanceId:h})}}return e},formSelector:function(e=at,t){return t.type===nt.a?Object.assign(Object.assign({},e),{forms:Object.assign(Object.assign({},e.forms),{[t.meta.formId]:{visible:t.payload.visible}})}):t.type===ot.a?Object.assign(Object.assign({},e),{selectedFormId:t.payload.formId}):e},parentComponentId:function(e="",t){return t.type===j.c?t.payload.parentComponentId:e},referencePanel:function(e={sessionTabs:[],controlNames:[],activeTabId:"",messageId:""},t){switch(t.type){case st.a:return t.payload.messageId?Object.freeze(Object.assign(Object.assign({},e),{sessionTabs:t.payload.sessionTabs,activeTabId:t.payload.activeTabId,messageId:t.payload.messageId})):Object.freeze(Object.assign(Object.assign({},e),{sessionTabs:t.payload.sessionTabs,activeTabId:t.payload.activeTabId}));case st.d:case st.c:return Object.freeze(Object.assign(Object.assign({},e),{sessionTabs:t.payload.sessionTabs,activeTabId:t.payload.activeTabId}));case st.e:return Object.freeze(Object.assign(Object.assign({},e),{messageId:t.payload.messageId}));case st.g:return Object.freeze(Object.assign(Object.assign({},e),{sessionTabs:t.payload.sessionTabs,controlNames:t.payload.controlNames,activeTabId:t.payload.activeTabId}));case st.f:return Object.freeze(Object.assign(Object.assign({},e),{controlNames:t.payload.controlNames,activeTabId:t.payload.activeTabId}));case st.b:return Object.freeze({sessionTabs:[],controlNames:[],activeTabId:"",messageId:""});case st.h:return Object.freeze(Object.assign(Object.assign({},e),{sessionTabs:t.payload.sessionTabs}));default:return e}},formLoadError:function(e=null,t){return t.type===it.a?t.payload.error:e}});function lt(e,t){if(void 0===e){const r=ct(e,t);return Object.freeze(r)}let r;if(t.type===a.a){const n=t.meta.contextToken,a=Object($e.v)(n),i=ut(a),s="NotSignedIn",o=!1,c=e.forms[a];let l=e.metadata;t.payload.relatedEntityMetadataState&&(l=Object.assign({},l,t.payload.relatedEntityMetadataState));const u=Object.assign(Object.assign({},e.forms),{[a]:Object.assign(Object.assign({},c),t.payload.formUIState)});l=Object.assign(Object.assign({},l),{[a]:Object.assign(Object.assign({},l[a]),t.payload.formMetadataState)});const d=Object.assign(Object.assign({},e.navigation),u&&n.contextTokenType===Ze.a.MainForm?u[a].navigation:e.navigation);if(d.navBarByRelationshipItems){const e=d.navBarByRelationshipItems;d.navBarByRelationshipItems={};const r=Object.keys(e);for(let n=0;n<r.length;n++){const a=r[n];d.navBarByRelationshipItems[a]=Object(we.a)(e[a],t.payload.currentLanguageId)}}r=Object.assign(Object.assign({},e),{formId:t.payload.formId,forms:u,metadata:l,records:i,powerBISignedInState:s,suppressDuplicateDetection:o,navigation:d})}else if(t.type===Ye.a&&e.metadata[t.meta.contextKey]){const n=e.metadata[t.meta.contextKey];r=Object.assign(Object.assign({},e),{metadata:Object.assign(Object.assign({},e.metadata),{[t.meta.contextKey]:Object.assign(Object.assign({},n),{attributes:Object.assign(Object.assign({},null==n?void 0:n.attributes),t.payload.attributes)})})})}else if(t.type===Ye.b){const n=e.forms[t.meta.contextKey];r=Object.assign(Object.assign({},e),{forms:Object.assign(Object.assign({},e.forms),{[t.meta.contextKey]:Object.assign(Object.assign({},n),{controls:Object.assign(Object.assign({},e.forms[t.meta.contextKey].controls),t.payload.controls)})})})}else if(t.type===Je.a){const n=t.payload,a=Object.assign(Object.assign({},e.datasets),{[n.contextKey]:n.initialDataSetState});r=Object.assign(Object.assign({},e),{datasets:a})}else if(t.type===et.a){const n=t.meta.contextToken,a=Object($e.v)(n),i=e.forms[a],s=Object.assign({},i),o=i.selectedTab.tabId;if(!t.payload.formUIState.tabs[o]){const e=i.tabs[o];if(e){const r=e.domId;let n;for(const e in t.payload.formUIState.tabs){if(t.payload.formUIState.tabs[e].domId===r){n=e;break}}i.selectedTab.tabId=n||""}}s.controls=t.payload.formUIState.controls,s.sections=t.payload.formUIState.sections,s.tabs=t.payload.formUIState.tabs,s.label=t.payload.formUIState.label,s.inlineQuickForms=t.payload.formUIState.inlineQuickForms,r=Object.assign(Object.assign({},e),{forms:Object.assign(Object.assign({},e.forms),{[a]:s})})}else if(t.type===j.h){const n=t.meta.contextToken,a=ut(Object($e.v)(n));r=Object.assign(Object.assign({},e),{records:a})}else r=ct(e,t);return Object.freeze(r)}function ut(e){return{[e]:{snapshotId:"",isDeleted:!1}}}},"53SR":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("SAYH"),a=r("Kvn0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t){const r={dataById:{[n.a.toString(t.id)]:e}};return{type:a.a,payload:r}}},"59++":function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return i}));var n=r("y60j"),a=r("OWbt");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="form.ui.metadata.update";function s(e,t,r){return{type:"form.ui.metadata.update.async",execute({dispatch:s,getState:o},c,l){const u=o(),d=Object(n.j)(u,e),h=Object(a.g)(u,d,e);return s(function(e,t,r,n){return{type:i,payload:{formId:e,formUIState:t},meta:{pageId:r,contextToken:n}}}(e,h,t,r)),Promise.resolve()}}}},"5UPV":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="dataset.set.newPageRequested";function i(e,t,r){const i=Object(n.y)(t),s=Object(n.v)(t);return{type:a,payload:r,meta:{pageId:e,contextKey:i,dataSetContextKey:s}}}},"5iTp":function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r){const a=Object(n.cb)(e,t,r);return a?a.footer:null}},"6Qf/":function(e,t,r){"use strict";r.d(t,"f",(function(){return g})),r.d(t,"d",(function(){return m})),r.d(t,"e",(function(){return y})),r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return f}));var n=r("SAYH"),a=r("dHD5"),i=r("BFlg"),s=r("ZJsz"),o=r("P6DH"),c=r("3/02"),l=r("Lyxw"),u=r("ujVH"),d=r("jAuy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const h="grid.initialize",p="grid.initialize.xrmready";function g(e,t,r){return{type:"grid.preinitialize.sync",sync:!0,execute({dispatch:n,getState:a},s){const o=i.x+".gridPreInitializedAction";try{n(b(null,e,t,r,void 0,void 0,void 0,void 0,null));const a=[{name:"entityTypeName",value:e}];return s.EventManager.ReportComponentSuccess(o,a),Promise.resolve(void 0)}catch(t){const r="Failed for "+e+" with error "+t.message;return s.EventManager.ReportComponentFailure(o,Error(r)),Promise.resolve(void 0)}}}}function m(e,t,r,n,a,d,h,p,g){return e?{type:"grid.initialize.async",execute({dispatch:m,getState:f},y){const _=i.x+".gridInitializedAction";try{let i=null;Object(l.c)(f(),c.zb)&&(i=function(e,t,r){const n=Object(o.v)(e,t,r),a=Object.assign({},s.a);return n&&(n.filters&&(a.filters=n.filters),n.customFilter&&(a.customFilter=n.customFilter),n.pageNumber&&(a.pageNumber=n.pageNumber),n.pagingRefreshInput&&(a.pagingRefreshInput=n.pagingRefreshInput)),a}(f(),r,n)),m(b(e,t,r,n,a,d,h,p,i,g));const v=[];v.push({name:"entityTypeName",value:t}),y.EventManager.ReportComponentSuccess(_,v);return Object(l.c)(f(),c.L)&&m(Object(u.b)(r,n)),Promise.resolve(void 0)}catch(e){const r="Grid initialized failed for entity type "+t;return y.EventManager.ReportComponentFailure(_,Error(r)),Promise.reject(void 0)}}}:null}function b(e,t,r,o,c,l,u,p,g,m){const b=c&&c.Parameters?c.Parameters[i.j]:null;try{let c=!0;b&&(c="true"===b);const f=Object(a.u)(o),y={contextKey:f,initialDataSetState:Object.assign(Object.assign(Object.assign({},s.a),g),{viewId:e?e.viewId:null,fetchXml:e?e.fetchXml:null,relationshipName:l,relationshipRoleOrdinal:u,useRollupView:p||!1,commandManagerId:m||Object(d.d)(r,o),controls:{homepageGrid:{parameters:{0:{Name:i.C,Value:e&&e.viewId?n.a.toString(e.viewId):null},1:{Name:i.j,Value:c},2:{Name:i.u,Value:t}}}}})};return{type:h,payload:y,meta:{pageId:r,contextKey:f}}}catch(e){throw Error(e)}}function f(e,t,r,o){const c=Object(a.u)(o),l=n.a.tryParseOrNull(t),u={contextKey:c,initialDataSetState:Object.assign(Object.assign({},s.a),{viewId:l||null,fetchXml:null,commandManagerId:Object(d.d)(r,o),controls:{homepageGrid:{parameters:{0:{Name:i.C,Value:t||null},1:{Name:i.j,Value:!1},2:{Name:i.u,Value:e}}}}})};return{type:h,payload:u,meta:{pageId:r,contextKey:c}}}function y(e,t,r,n){return t(e.ScriptManager.getContainer(n).getEventManager().loadGridScripts(r,n))}},"7+p5":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("Lyxw"),a=r("3/02"),i=r("IqkD");function s(e){if(Object(n.a)(e,a.S,a.h)){return!!Object(n.a)(e,a.d,a.Lc)||1033===Object(i.s)(e)}return!1}},"7TDv":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n="formSelector.visible";function a(e,t,r){return{type:n,payload:{visible:r},meta:{pageId:e,formId:t}}}},"7k+e":function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return s})),r.d(t,"c",(function(){return o}));var n=r("dHD5"),a=r("BFlg");const i="chart.drilldownparameters.update",s="ChartDrillDownParameters";function o(e,t,r){return{type:"chart.drilldownparameters.update.async",execute({dispatch:o,getState:c},l){const u=l.TraceManager.getTracer(a.z),d=a.x+".updateChartDrillDownParametersAction";try{u.info("Updating the chart drilldown parameters"),t||(t=Object(n.k)(c(),e));const a=Object(n.v)(t);return o(function(e,t,r){return{type:i,payload:{name:s,value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,a,r)),l.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){const t="Updatation of the chart drilldown parameters failed with error : "+e.message;l.EventManager.ReportComponentFailure(d,Error(t))}}}}},"7p56":function(e,t,r){"use strict";r.d(t,"a",(function(){return qt}));var n=r("nuS9"),a=r("4fxQ"),i=r("D9ys"),s=r("u+q+"),o=r("YWpA"),c=r("hPFj"),l=r("H/hG"),u=r("e9UD"),d=r("znb3"),h=r("223Y"),p=r("VnpK"),g=r("POU9"),m=r("vP/5"),b=r("sclX"),f=r("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const y=2/(1+Math.sqrt(5));class _ extends n.Component{constructor(e){super(e),this._memorizedDescriptor=null,this.onMeasuring=this.onMeasuring.bind(this),this.state={width:0,height:0}}_getGoldenRatioHeight(e){return y*e}onMeasuring(e,t){let r=!1;const n={};e!==this.state.width&&(n.width=e,r=!0),t!==this.state.height&&(n.height=t,r=!0),r&&this.setState(n)}render(){const e=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(f.z):null;if(!this.props||!this.props.showChart||!this.props.configuration)return e&&e.info("Chart not rendered because the configuration is missing or show chart is set to false"),null;this._memorizedDescriptor&&this.props.chartId===this._memorizedDescriptor.Id||(this._memorizedDescriptor={Id:this.props.chartId,Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1});const t=parseFloat(getComputedStyle(document.documentElement).fontSize),r=this._getTopAndBottomAdjustment(t),a=this._getLeftAndRightAdjustment(t);let i,s;this.props.isLayoutVertical?(i=this.state.width-a,s=this._getGoldenRatioHeight(i),this.props.style.minHeight=s+r):(i=Math.max(this.state.width,320)-a,s=this.state.height-r);const c={minWidth:i.toString()+"px",minHeight:s.toString()+"px"},l={width:i>0?i:-1,height:s>0?s:-1,eventListeners:[{eventname:"onChartPaneClose",eventhandler:[this._closeChartPane.bind(this)]}]};return n.createElement(o.a,{key:"pageChart_"+this.props.id,testhooks:{id:"pageChart_"+this.props.id},style:this.props.style,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0},n.createElement(o.a,{key:"pageChart_"+this.props.id+"_container",style:c},n.createElement(h.c,{key:this.props.chartId,controlId:this.props.chartId,id:this.props.id,configuration:this.props.configuration,descriptor:this._memorizedDescriptor,parentDefinedControlProps:l,parentContextToken:this.props.contextToken})))}_closeChartPane(){this.props.closeChartPaneHandler(this.props.id,this.props.contextToken,!1)}_getTopAndBottomAdjustment(e){let t=0;return this.props.style.borderTopWidth&&(t+=e*("string"==typeof this.props.style.borderTopWidth?parseFloat(this.props.style.borderTopWidth||"0px"):this.props.style.borderTopWidth)),this.props.style.paddingTop&&(t+=e*("string"==typeof this.props.style.paddingTop?parseFloat(this.props.style.paddingTop||"0px"):this.props.style.paddingTop)),this.props.style.borderTop&&(t+=1),this.props.style.borderBottom&&(t+=1),t}_getLeftAndRightAdjustment(e){let t=0;return this.props.style.paddingLeft&&(t+=e*("string"==typeof this.props.style.paddingLeft?parseFloat(this.props.style.paddingLeft||"0px"):this.props.style.paddingLeft)),this.props.style.paddingRight&&(t+=e*("string"==typeof this.props.style.paddingRight?parseFloat(this.props.style.paddingRight||"0px"):this.props.style.paddingRight)),this.props.style.borderLeft&&(t+=1),this.props.style.borderRight&&(t+=1),t}}var v=r("SAYH"),S=r("ah4O"),O=r("KBcj"),I=r("d0w6"),C=r("iWfp"),j=r("XvLr"),P=r("P6DH"),T=r("b6Tl"),E=r("a72m"),w=r("EY5k"),F=r("YxC/"),x=r("FZDd"),A=r("iZ7K"),N=r("eXjw"),D=r("OmkB"),k=r("tOh6"),M=r("sZ+8"),R=r("69Qu"),L=r("RJiR"),B=r("0kGT"),V=r("3/02"),G=r("Lyxw"),U=r("PMTb");let X=[];class z extends n.Component{constructor(e){super(e),this._onItemIconPointerDown=this._onItemIconPointerDown.bind(this),this._onChange=this._onChange.bind(this),this.props.entityTypeName.toLowerCase()===P.a&&(this.props.loadAllActivityTypes(e.activities),this.props.loadAllActivityResourceString())}_getEntityTypeNameFromViewId(e){return e&&this.props.gridViewSelectorItems&&this.props.gridViewSelectorItems[e]&&this.props.gridViewSelectorItems[e].relatedEntityName?this.props.gridViewSelectorItems[e].relatedEntityName:null}_onChange(e){var t;this.props.isGridRoot&&this.props.pageToEditedViewMapId&&this.props.selectedViewId!==e&&this.props.removeEditedViewPageMap(null===(t=this.props.pageToEditedViewMapId)||void 0===t?void 0:t.guid,new v.a(this.props.selectedViewId)),this.props.onChange(e,this.props.entityTypeName===P.a?this._getEntityTypeNameFromViewId(e):this.props.entityTypeName)}_isViewSelectorHidden(){return!(this.props.gridViewSelectorItems&&this.props.viewCategories&&this.props.selectedViewId)}render(){const e=Object(F.c)(this.props.resourceStrings,j.VIEWSELECTOR_TOOLTIP),t=this.props.contextString===f.h.GRID,r=t?this._onItemIconPointerDown:null,a=this.props.useViewSelectorV2?this.props.isPhone:this.props.isTablet,i=a?this.props.styleProps.textStyleMobile:this.props.styleProps.textStyle,s=a?this.props.styleProps.viewSelectorMobileStyle:this.props.styleProps.viewSelectorStyle,o=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(f.z):null;if(this._isViewSelectorHidden())return o&&o.info("View Selector not rendered because view selector items or view categories or selected view is not available."),null;const c=[];let l=!1;for(const e in this.props.gridViewSelectorItems){const r=this.props.gridViewSelectorItems[e];if(!r)continue;const n=r.isUserView;let a;if(n&&(l=!0),this.props.entityTypeName===P.a&&this.props.pinnedActivityView){const e=r;a=e.isPinned&&this.props.pinnedActivityView.PinnedEntity===e.relatedEntityName}else a=r.isPinned;const i=t?a?d.a.Pinned:d.a.Pin:null,s='""',o='""',u={":hover":{"::before":{content:a?s:o}}};this.props.useViewSelectorV2&&Object.assign(u,{marginLeft:"8px",marginRight:"8px"});const h=t?u:null,p=Object(F.c)(this.props.resourceStrings,j.VIEWSELECTOR_DEFAULTVIEW),g=Object(F.c)(this.props.resourceStrings,j.VIEWSELECTOR_SETDEFAULTVIEW),m=t?a?p:g:null;let b="";b=this.props.entityTypeName===P.a&&this.props.allActivitiesString&&this.props.shouldDisplayNestedViewSelector?(X.indexOf(r.relatedEntityName)+1).toString():n?I.b.userview.toString():I.b.savedview.toString();let f=r.name;e===this.props.selectedViewId&&this.props.isEdited&&(this.props.isRTL?f="*"+f:f+="*"),c.push({value:e,text:f,categoryId:b,iconType:i,iconTitle:m,iconStyle:h})}if(this.props.selectedViewId&&this.props.quickFindViewId&&this.props.quickFindViewId===this.props.selectedViewId){const e=Object(F.c)(this.props.resourceStrings,j.QUICK_FIND_VIEWS_LABEL_ID);c.push({value:this.props.selectedViewId,text:e,categoryId:I.b.savedview.toString()})}const u=l?this.props.viewCategories:this.props.viewCategories.filter(e=>e.id!==I.b.userview.toString());return this.props.isGridRoot&&this.props.isInMobileModeForOct2019?n.createElement(L.c,{pageId:this.props.pageId},this.props.isAdvancedFindView?n.createElement(U.a,null,"New view"):n.createElement(L.k,{items:c,selectedItemId:this.props.selectedViewId,onChange:this._onChange})):this.props.isAdvancedFindView?n.createElement(U.a,{style:i},"New view"):n.createElement(S.a,{id:this.props.id,testhooks:{id:"ViewSelector_"+this.props.selectedViewId},value:this.props.selectedViewId,role:"presentation",title:e,categories:u,options:c,style:this.props.style,caretType:d.a.ChevronDownMed,caretStyle:this.props.styleProps.caretStyle,textStyle:i,viewSelectorStyle:s,onChange:this._onChange,onItemIconPointerDown:r,createAccessibilityComponent:C.a,createKeyboardShortcut:C.b,parentCustomControlId:this.props.id,rootZIndex:this.props.rootZIndex,isRTL:this.props.isRTL,useViewSelectorV2:this.props.useViewSelectorV2,placeItemIconOnRight:!0,useHeader:this.props.isGridRoot})}componentDidMount(){if(this.props.viewIds?this.props.loadGridViewsByViewId(this.props.viewIds,this.props.entityTypeName):this.props.loadViewsByType(this.props.queryViewSelectorTypes,this.props.entityTypeName,this.props.gridViewSelectorItems),this._isViewSelectorHidden())return;let e=!1;if(this.props.selectedViewId&&""!==this.props.selectedViewId&&(this.props.gridViewSelectorItems&&this.props.gridViewSelectorItems[this.props.selectedViewId]||this.props.quickFindViewId&&this.props.quickFindViewId===this.props.selectedViewId)&&(e=!0),!e){if(this.props.viewIds){this.props.viewIds.find(e=>e.guid===this.props.selectedViewId)&&(e=!0)}this.props.defaultViewId&&this.props.defaultViewId.guid!==v.a.EMPTYSTRING&&this.props.onChange(this.props.defaultViewId.guid,this.props.entityTypeName)}}_onItemIconPointerDown(e){const t=e,r=e.iconType===d.a.Pinned,n=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(f.z):null;let a=e.categoryId,i=this.props.entityTypeName;if(this.props.entityTypeName===P.a){const t=this.props.gridViewSelectorItems;i=t&&t[e.value]?t[e.value].relatedEntityName:i;a=!(!t||!t[e.value])&&t[e.value].isUserView?I.b.userview.toString():I.b.savedview.toString()}n&&n.info(`Toggle the the pin status for ${e.value} for ${i} entity`),this.props.onItemIconPointerDown(i,e.value,a,"",r).then(()=>{if(n&&n.info("Resetting the pin status of all the options and toggle the pin status of the recently selected item"),!r&&this.props.entityTypeName===P.a){const r=this.props.gridViewSelectorItems[t.value];this.props.pinnedActivityView.PinnedEntity=r.relatedEntityName,this.props.pinnedActivityView.ViewId=new v.a(e.value),this.props.pinnedActivityView.ViewType=r.isUserView?I.b.userview:I.b.savedview}for(const e in this.props.gridViewSelectorItems)this.props.gridViewSelectorItems[e].isPinned=e===t.value&&!r;this.forceUpdate()},e=>{n&&n.error("Could not pin the selected view, pinning action failed with error "+e)})}}function q(e,t,r,n){let a=[];if(t===P.a&&n){let t=1;X.forEach(r=>{a.push({id:t.toString(),name:Object(A.f)(e,r)}),t++})}else a=Object(P.mb)(e,r);return a}function H(e,t,r){let n;return t.forEach((t,a)=>{const i=function(e,t,r){let n=Object(O.f)(e,t,r);n&&!Object(R.b)(e)&&Object(M.l)(e,t)&&(n=Object.keys(n).reduce((a,i)=>((n[i].isAvailableInOffline||i===v.a.toString(Object(O.a)(e,t,r)))&&(a[i]=n[i]),a),{}));return n}(e,r,t);i&&(n=Object.assign(Object.assign({},n),i))}),n}z.displayName="DataSetViewSelector";const W=Object(s.a)((function(){let e=null,t=null,r=null,n={gridViewSelectorItems:null,viewCategories:null,allActivitiesString:null,activities:null,activityOptions:null,resourceStrings:null,quickFindViewId:null,styleProps:null};const a=Object(T.a)(),i=Object(F.h)();return(s,o)=>{const c=i(s,j.labelList),l=v.a.toString(Object(O.a)(s,o.entityTypeName,I.a.QUICKFIND_SEARCH));let u=null;let d=null;const h=a(s,o.contextString);X=Object(P.B)(s);let p=!1;if(o.queryViewSelectorTypes&&o.queryViewSelectorTypes.length>0&&!o.viewIds){if(o.entityTypeName===P.a&&o.shouldDisplayNestedViewSelector?(X.forEach(e=>{const t=H(s,o.queryViewSelectorTypes,e);t&&(u=Object.assign(Object.assign({},u),t))}),d=Object(F.e)(s,["ViewSelectorAllActivities"])):u=H(s,o.queryViewSelectorTypes,o.entityTypeName),e)for(const t in u)if(!e[t]||e[t]!==u[t]){p=!0;break}}else if(o.viewIds){const t={};for(let r=0;r<o.viewIds.length;r++){const n=Object(P.qb)(s,o.viewIds[r],o.id);if(n&&n.grid&&n.grid.rows){const r=e?e[n.viewId.guid]:void 0,a=!r||r.name!==n.title||r.queryType!==n.queryType,i=a?{name:n.title,queryType:n.queryType,isDefault:!1,isQuickFindQuery:!1,isUserView:n.isUserView}:r;Object.assign(t,{[n.viewId.guid]:i}),p=p||a}}t&&(u=t)}return!u||e&&Object.keys(e).length===Object.keys(u).length||(p=!0),d&&n.allActivitiesString!==d.ViewSelectorAllActivities&&(p=!0),t!==l&&(p=!0),r!==h&&(p=!0),p&&(e=u,t=l,r=h,n={gridViewSelectorItems:e,viewCategories:q(s,o.entityTypeName,j,o.shouldDisplayNestedViewSelector),allActivitiesString:d&&d.ViewSelectorAllActivities,activities:null,activityOptions:null,resourceStrings:c,quickFindViewId:t,styleProps:r,isInMobileModeForOct2019:Object(B.b)(s),useViewSelectorV2:Object(G.a)(s,V.le,V.h)}),n}}),(function(e){return{loadViewsByType:(t,r,n)=>{const a=[];return t.forEach((t,i)=>{t===I.a.MAIN_APPLICATION_VIEW&&n&&0!==Object.keys(n).length||a.push(e(Object(E.a)(r,t,void 0,void 0)))}),Promise.all(a)},loadAllActivityResourceString:()=>e(Object(w.e)(["ViewSelectorAllActivities"])),loadAllActivityTypes:t=>{let r=null;for(const e in t)t[e].Initialized!==N.a.Initialized&&(r||(r={}),r[e]=["DisplayName","ActivityTypeMask","IsVisibleInMobileClient"]);return r?e(Object(x.e)(r)):Promise.resolve()},loadGridViewsByViewId:(t,r)=>{const n=[];return t.forEach((t,a)=>{n.push(e(Object(E.a)(r,void 0,void 0,t)))}),Promise.all(n)},openPopup:t=>e(Object(k.a)(t)),closePopup:t=>e(Object(D.a)(t))}}))(z);var Y=r("Ki7F"),Q=r("o0iw"),K=r("XIN1"),J=r("Wdaq"),Z=r("/aHX"),$=r("ZGH+"),ee=r("AVDU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const te=42;class re extends n.Component{constructor(e){super(e),this.onMeasuring=this.onMeasuring.bind(this),this.state={commandbarWidth:0},this._lastCommandManagerId=e.commandManagerId}onMeasuring(e){const t=e-((this.props.style.paddingLeft?"string"==typeof this.props.style.paddingLeft?Object($.e)(this.props.style.paddingLeft):this.props.style.paddingLeft:0)+(this.props.style.paddingRight?"string"==typeof this.props.style.paddingRight?Object($.e)(this.props.style.paddingRight):this.props.style.paddingRight:0))-(this.props.backButtonEnabled?te:0);t!==this.state.commandbarWidth&&this.setState({commandbarWidth:t})}componentDidUpdate(){this.props.commandManagerId!==this._lastCommandManagerId&&(this._lastCommandManagerId=this.props.commandManagerId,this.props.setCommandManagerId(this.props.pageId,this.props.commandManagerId,this.props.contextToken))}_renderConsoleAppBackButton(){return this.props.backButtonEnabled?n.createElement(Z.a,{pageId:this.props.pageId}):null}_renderNativeSubgridCommandBar(){return this.props.isNativeMode?n.createElement(L.e,{commandManagerId:this.props.commandManagerId,pageId:this.props.pageId}):null}render(){if(!this.props.pageId||!this.props.ribbonId||!this.props.commandManagerId)return null;const e=!this.state.commandbarWidth,t=n.createElement(Y.a,{commandBarStyle:this.props.commandbarStyles,width:this.state.commandbarWidth,commandbarDisplayMode:Q.a.IconLabel,key:this.props.pageId,iconPosition:K.a.Left,commandManagerId:this.props.commandManagerId,id:this.props.pageId,ribbonId:this.props.ribbonId,relationshipType:this.props.relationshipType,addedCommandList:this.props.addedCommandList,appendedCommandList:this.props.appendedCommandList,contextToken:this.props.contextToken,metaDataLoadedResolve:this.props.metaDataLoadedResolve,isHidden:e,rootZIndex:this.props.rootZIndex,customControlType:this.props.customControlType,isNativeMode:this.props.isNativeMode});return this.props.isInMobileModeForOct2019&&this.props.isGridRoot?t:n.createElement(o.a,{key:"commandBar_"+this.props.pageId,testhooks:{id:"commandBar_"+this.props.pageId},style:this.props.style,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0},this._renderConsoleAppBackButton(),t,this._renderNativeSubgridCommandBar())}}re.displayName="DataSetCommandBar";const ne=Object(s.a)((function(){return(e,t)=>{const r=Object(B.b)(e);return{commandManagerId:Object(P.w)(e,t.pageId,t.contextToken)||t.commandManagerId,backButtonEnabled:Object(ee.d)(e)&&t.isGridRoot&&!t.collapsed,isInMobileModeForOct2019:r}}}),(function(e){return{setCommandManagerId:(t,r,n)=>{t&&r&&n&&e(Object(J.b)(t,r,n))}}}))(re);var ae=r("A6np"),ie=r("jAuy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function se(e){if(e){const t=e.split(":");if(2===t.length){return t[1].split(",")}}return[]}function oe(e){if(e&&e.filterOptions&&e.filterOptions.length>0){let t=e.filterOptions.filter(e=>e.isDefault);const r=e.userSetting,a=r&&r.defaultGridViews&&r.defaultGridViews[e.entityTypeName];let i,s;a&&""!==a.QueueId&&(t=e.filterOptions.filter(e=>Object(P.bb)(a.QueueId).sort().join(",")===se(e.value).sort().join(","))),e.isGridPaginationStateFeatureEnabled&&null!=e.previousValue&&(i=Object(ie.f)(e.filterOptions,e.previousValue),s=e.previousValue),i||(t.length>0?(i=t[0].text,s=t[0].value):(i=e.filterOptions[0].text,s=e.filterOptions[0].value)),e.updateFilterValue(s);const c=Object(F.c)(e.resourceStrings,j.QUEUE_FILTER_LABEL),l=n.createElement(ae.a,{key:"gridFilter",testhooks:{id:"gridFilter_"+e},title:c,accessibilityLabel:c,defaultValue:i,options:e.filterOptions,onChange:e.onFilterChange,createAccessibilityComponent:C.a,style:e.comboBoxStyle,createKeyboardShortcut:C.b,freeTextMode:!0,suppressFreeTextChangeCallback:!0});return n.createElement(o.a,{key:"GridFilterView",style:e.style},l)}const t=e.TraceManager&&e.TraceManager.getTracer?e.TraceManager.getTracer(f.z):null;return t&&t.info("Queue Filter not rendered because there are no filter options available"),null}var ce=r("KOTC"),le=r("CbNq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ue={Id:"toggleButtonControl",Label:null,Name:"toggleButtonControl",ShowLabel:!1,Visible:!0,Disabled:!1},de={FormFactor:2,CustomControlId:"MscrmControls.FlipSwitch.FlipSwitchControl",Name:"MscrmControls.FlipSwitch.FlipSwitchControl",Version:"1.0.0",Parameters:{value:{Usage:3,Static:!1,Value:0,Type:"TwoOptions",Attributes:{DefaultValue:0,Options:null},Callback:null}},ShouldOverrideControlVisible:!1};function he(e,t){if(!e.isRollupViewSupported)return null;const r=function(e){const t=[];if(!Array.isArray(e))return t;for(let r=0;r<e.length;++r)t.push({Label:e[r],Value:r});return t}([Object(F.c)(e.resourceStrings,j.ROLLUPVIEW_SWITCH_OFF),Object(F.c)(e.resourceStrings,j.ROLLUPVIEW_SWITCH_ON)]),a=e.isOffline,i=(s=e.toggleValue,o=t,c=e.onToggleChange,l=r,Object.assign(Object.assign({},de),{Parameters:{value:{Usage:3,Static:!1,Type:"TwoOptions",Value:s?1:0,Attributes:{DefaultValue:0,Options:l,DisplayName:o},Callback:c}}}));var s,o,c,l;const u=function(e,t){return Object.assign(Object.assign({},ue),{Label:e,Disabled:t})}(t,a),d="rollup_view_switch_"+e.id;return n.createElement(h.c,{key:d,controlId:d,id:e.id,systemDefinedProperties:null,descriptor:u,configuration:i,formInfo:void 0,shouldRender:!0,parentContextToken:null,parentDefinedControlProps:void 0})}function pe(e,t,r,a,i){const s=e.theme,c=e.isRTL,l=e.isActivityManagementFeatureEnabled&&e.entityIsActivityType;return n.createElement(o.a,{key:"ActivityViewContainer",role:"presentation",style:e.activityViewContainerStyle},n.createElement(o.a,{key:"ActivityDueDateFilterView",style:l?e.activityTypeContainerStyle:e.containerStyle},[t,r]),i?n.createElement(o.a,{key:"ActivityTypeFilterView",style:e.activityTypeContainerStyle},[a,i]):null,function(e,t,r,a){if(!t)return;const i=Object(F.c)(e.resourceStrings,j.ROLLUPVIEW_SWITCH_LABEL),s={flex:"1 1 auto",marginLeft:r.sizes.Measures.Measure200,marginRight:r.sizes.Measures.Measure200,marginTop:r.sizes.Measures.Measure050,minWidth:"15rem"},c={whiteSpace:"nowrap",flex:"1 0 auto",marginRight:a?0:r.sizes.Measures.Measure100,marginLeft:a?r.sizes.Measures.Measure100:0};return n.createElement(o.a,{key:"RollupViewControlContainer",style:s},n.createElement(o.a,{key:"rollupViewFilterLabelView",style:c},i),he(e,i))}(e,e.isRollupViewSupported,s,c))}const ge=Object(s.a)(void 0,(function(e){return{openPopup:t=>e(Object(k.a)(t)),closePopup:t=>e(Object(D.a)(t))}}))((function(e){const t=e.TraceManager&&e.TraceManager.getTracer?e.TraceManager.getTracer(f.z):null;let a,i="";const s=e.isActivityManagementFeatureEnabled&&e.entityIsActivityType;if(e&&e.filterOptions&&e.filterOptions.length>0){const t=e.filterOptions.filter(e=>e.isDefault);s&&(a=Object(le.d)(e.filterOptions)),e.isGridPaginationStateFeatureEnabled&&null!=e.previousValue&&(i=s?e.previousValue:Object(ie.f)(e.filterOptions,e.previousValue)),i||(i=t.length>0?s?t[0].value:t[0].text:s?e.filterOptions[0].value:e.filterOptions[0].text)}const[c,u]=n.useState(i);if(e&&e.filterOptions&&e.filterOptions.length>0){const d={flex:"1 0 auto",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",width:"0px"},h=s?Object(F.c)(e.resourceStrings,e.dueDateFilterLabelResourceString):Object(F.c)(e.resourceStrings,e.entityFilterLabelResourceString);let p=null;h&&(p=n.createElement(l.a,{key:"activityDueDateFilterLabel",style:s?e.activityMgmtLabelStyle:e.labelStyle}," ",h," "));const g=n.createElement(o.a,{key:"activityDueDateFilterLabelView",style:{alignItems:"center",justifyContent:"center"}},p);let m=n.createElement(ae.a,{key:"activityDueDateFilterComboBox",testhooks:{id:"activityDueDateFilterComboBox_"+e.id},id:"activityDueDateFilterComboBox",defaultValue:i,options:e.filterOptions,onChange:e.onFilterChange,createAccessibilityComponent:C.a,style:e.comboBoxStyle,textStyle:d,createKeyboardShortcut:C.b,openPopup:e.openPopup,closePopup:e.closePopup,parentCustomControlId:"activityDueDateFilterComboBox",rootZIndex:e.rootZIndex,accessibilityLabel:h,freeTextMode:!0,suppressFreeTextChangeCallback:!0});s&&(m=n.createElement(ce.a,{key:"activityDueDateFilterComboBox",loader:()=>Promise.all([r.e(10),r.e(11),r.e(13),r.e(12),r.e(14),r.e(15),r.e(17),r.e(21),r.e(28),r.e(90)]).then(r.bind(null,"YDph")).then(e=>e.ComboBox),props:{selectedKey:c,key:"activityDueDateFilterComboBox",id:"activityDueDateFilterComboBox",options:a,onChange:(t,r)=>{u(r.key),e.onFilterChange(r.key)},style:e.dueDatecomboBoxStyle,ariaLabel:h,useComboBoxAsMenuWidth:!0,allowFreeform:!0}}));if(e.isActivityManagementFeatureEnabled&&!e.isOffline&&!e.isMobile&&e.gridEntityName===f.a){let a=null;const i=Object(F.c)(e.resourceStrings,e.activityTypeFilterLabelResourceString);i&&(a=n.createElement(l.a,{key:"activityTypeFilterLabel",style:e.activityMgmtLabelStyle}," ",i," "));const s=n.createElement(o.a,{key:"activityTypeFilterLabelView",style:{alignItems:"center",justifyContent:"center"}},a);let c;if(e.filterOptionsForActivityType&&e.filterOptionsForActivityType.length>0){t&&t.info("Activity Management Filter - Activity Type Filter Rendered with no. of options "+e.filterOptionsForActivityType.length);let a=Object(le.c)(e.filterOptionsForActivityType);if(e.isActivityFilterSelectAllEnabled){const t=Object(F.c)(e.resourceStrings,j.ACTIVITYTYPE_SELECTALL),r=[];r.push({key:"selectAllKey",text:t}),a=r.concat(a)}let s=[];e.isGridPaginationStateFeatureEnabled&&null!=e.activityTypePreviousValues&&(s=Object(le.b)(e.activityTypePreviousValues)),c=n.createElement(ce.a,{key:"activityTypeFilterBox",loader:()=>Promise.all([r.e(10),r.e(28),r.e(40)]).then(r.bind(null,"yiyP")).then(e=>e.ActivityTypeCombobox),props:{key:"activityTypeFilterBox",id:"activityTypeFilterBox",selectedOptionKeys:s,onActivityTypeFilterClear:()=>{e.onActivityTypeFilterClear()},onActivityTypeMenuDismissed:t=>{e.onActivityTypeChange(t)},options:a,ariaLabel:i,isRTL:e.isRTL,style:e.activityTypeContainerStyle,resourceStrings:e.resourceStrings,selectAllEnabled:e.isActivityFilterSelectAllEnabled}})}return pe(e,g,m,s,c)}return pe(e,g,m,null,null)}return t&&t.info("Activity Filter not rendered because there are no filter options available"),null}));var me=r("nJrx"),be=r("gvL4"),fe=r("Smta"),ye=r("vTeb"),_e=r("evW+"),ve=r("1AYO"),Se=r("hSDL"),Oe=r("unFF"),Ie=r("tJ+6");var Ce=r("kC0I"),je=r("3rse"),Pe=r("00VO"),Te=r("FhVi"),Ee=r("Afz2"),we=r("Gilj"),Fe=r("cz9j"),xe=r("L4PC"),Ae=r("H4dV");class Ne extends n.Component{constructor(e){super(e),this._cachedSelectedFilter="",this._onFilterChange=this._onFilterChange.bind(this),this._toggleJumpBarFlyout=this._toggleJumpBarFlyout.bind(this),this._closeJumpBarDomId="close-jumpbar-"+Object(me.a)(),this._selectedFilterDomId="selected-filter-"+Object(me.a)(),this.state={isFlyoutOpened:!1}}_onOutsideClickHandler(e,t){const r=t.target,n=document.getElementById(e);r&&!n.contains(r)&&n!==r&&this._toggleJumpBarFlyout()}keyDownHandler(e){switch(e.EVENT.keyCode){case je.a.Escape:this._setIsFlyoutOpenedState(!1)}}_toggleJumpBarFlyout(){this._setIsFlyoutOpenedState(!this.state.isFlyoutOpened)}_setIsFlyoutOpenedState(e){this.setState({isFlyoutOpened:e}),Object(Fe.g)(e)}_filterGrid(e){let t,r=e.getAttribute("data-value");if(r!==this._cachedSelectedFilter&&(this.props.updateDataSetLoadingState(1),this._cachedSelectedFilter=r),1033===this.props.languageId&&r){const t=e.getAttribute("data-value").toUpperCase();t!==r&&(r=`${r}|${t}`)}t=this.props.dataSetFetchXml?Object(Pe.c)(this.props.dataSetFetchXml,this.props.entityAttributeMetadata,this.props.primaryNameAttribute):this.props.primaryNameAttribute,this.props.applyGridFilter(Object(Pe.b)(r,t),this.props.isGridRoot,this.props.contextToken),this._setIsFlyoutOpenedState(this.props.renderMobile&&!this.state.isFlyoutOpened)}_onFilterChange(e){let t=e.target;const r=e;("click"===e.type||r&&r.keyCode===je.a.Enter)&&(e.preventDefault(),t&&"a"===t.tagName.toLowerCase()&&(t=t.parentElement),this._filterGrid(t))}_renderListItem(e,t,r){let a=Object.assign({},this.props.renderMobile?this.props.styles.listItemStyleMobile:this.props.styles.listItemStyle),i=Object.assign(Object.assign({},this.props.styles.hyperlinkStyle),this.props.renderMobile?this.props.styles.hyperlinkStyleMobile:null);return r.describedByElementId&&(a=Object.assign(a,this.props.renderMobile?this.props.styles.listItemSelectedStyleMobile:this.props.styles.listItemSelectedStyle),i=Object.assign(i,this.props.renderMobile?this.props.styles.hyperlinkSelectedStyleMobile:null)),n.createElement(fe.a,Object.assign({},r,{style:a}),n.createElement(ye.a,Object.assign({},e,{style:i}),t))}_createKeyboardShortcuts(){const e=Object(F.c)(this.props.resourceStrings,j.CLOSE_JUMPBAR_ARIALABEL),t=this.keyDownHandler.bind(this),r=[],n=new we.a([je.a.Escape],t,!0,"",e);return r.push(n),r}_renderJumpBarAlphabet(){const e=[],t=Object(F.c)(this.props.resourceStrings,j.JUMPBAR_ALPHABET),r=Object(F.c)(this.props.resourceStrings,j.JUMPBAR_NUMBER_INDICATOR),n=Object(F.c)(this.props.resourceStrings,j.JUMPBAR_NUMBER_TOOLTIP),a=Ae.a.getInstance(),i=!!a&&a.get_IsIOS();return t.split(",").forEach(t=>{const a=Object(Ce.h)(t),s=a[0],o=a[1],c=s+"_listItem",l=s+"_link",u={id:c,key:c,accessibilityLabel:String.format(j.FILTERBY_ARIALABEL,o),role:Ee.q,onClick:this._onFilterChange,onKeyDown:this._onFilterChange,tabIndex:-1},d={id:l,key:l,testhooks:{id:l},tabIndex:-1,role:Ee.r,accessibilityHidden:!i,accessibilityLabel:i?String.format(j.FILTERBY_ARIALABEL,o):void 0};s===r&&(d.title=n,d.accessibilityLabel=j.NUMBER_ARIALABEL),this.props.selectedFilter!==s&&this.props.selectedFilter!==o||(u.describedByElementId=this._selectedFilterDomId,u.isSelected=!0,u.tabIndex=0),o&&(u.dataValue=o),e.push(this._renderListItem(d,s,u))}),e}_renderJumpBarAll(){const e=Object(F.c)(this.props.resourceStrings,j.JUMPBAR_ALL),t=Object(F.c)(this.props.resourceStrings,j.JUMPBAR_ALL_TITLE);this._allListItemDomId=e+"_listItem";const r=e+"_link",n=Ae.a.getInstance(),a=!!n&&n.get_IsIOS(),i={id:this._allListItemDomId,key:this._allListItemDomId,onClick:this._onFilterChange,onKeyDown:this._onFilterChange,role:Ee.q,tabIndex:-1,accessibilityLabel:String.format(j.FILTERBY_ARIALABEL,e)},s={id:r,key:r,testhooks:{id:r},tabIndex:-1,role:Ee.r,accessibilityHidden:!a,accessibilityLabel:a?String.format(j.FILTERBY_ARIALABEL,e):void 0,title:t};return this.props.selectedFilter&&this.props.selectedFilter!==e||(i.describedByElementId=this._selectedFilterDomId,i.isSelected=!0,i.tabIndex=0),this._renderListItem(s,e,i)}_renderList(){const e=Object(F.c)(this.props.resourceStrings,j.JUMPBAR_LETTER_TITLE);return n.createElement(be.a,{id:"JumpBarItemsList",key:"JumpBarItemsList",testhooks:{id:"JumpBarItemsList"},title:e,role:Ee.j,onKeyDown:this._onJumpbarKeyDown.bind(this),style:Object.assign(Object.assign({},this.props.styles.jumpBarStyle),this.props.renderMobile?this.props.styles.jumpBarStyleMobile:null),accessibilityLabel:j.JUMPBAR_ARIALABEL},this._renderJumpBarAll(),this._renderJumpBarAlphabet())}_onJumpbarKeyDown(e){const t=e.target;if(this.state.isFlyoutOpened){const r=9===e.keyCode,n=e.shiftKey;if(r){if(e.stopPropagation(),e.preventDefault(),n){if(t.id===this._closeJumpBarDomId)return void document.querySelector("#JumpBarItemsList").lastElementChild.focus();const e=t.previousElementSibling;e?e.focus():t.id===this._allListItemDomId&&document.getElementById(this._closeJumpBarDomId).focus()}else{if(t.id===this._closeJumpBarDomId)return void document.getElementById(this._allListItemDomId).focus();if(t.parentElement&&t.parentElement.lastElementChild&&t.id===t.parentElement.lastElementChild.getAttribute("id"))return void document.getElementById(this._closeJumpBarDomId).focus();const e=t.nextElementSibling;e&&e.focus()}return}}if(e.keyCode===je.a.UpArrow||e.keyCode===je.a.DownArrow||e.keyCode===je.a.LeftArrow||e.keyCode===je.a.RightArrow){e.stopPropagation(),e.preventDefault();const r=e.keyCode===je.a.DownArrow||e.keyCode===je.a.RightArrow,n=e.keyCode===je.a.UpArrow||e.keyCode===je.a.LeftArrow;if(r){const e=t.nextElementSibling;return void(e&&e.focus())}if(n){const e=t.previousElementSibling;return void(e&&e.focus())}}}_renderJumpBarFlyout(e,t){const r="jumpbar-flyout_"+this.props.id,a=r+"Accessibility",i=[];return i.push(n.createElement(Te.a,{key:a,rootElementId:r,shouldManageFocus:!0,isModal:!0,keyboardShortcuts:this._createKeyboardShortcuts(),defaultFocusId:this._closeJumpBarDomId})),n.createElement(o.a,{role:Ee.e},n.createElement(ve.a,{id:r,testhooks:{id:r},key:r,rootZIndex:this.props.rootZIndex,positionType:"relative",relativeToElementId:t,flyoutStyle:this.props.styles.jumpBarFlyoutStyle,flyoutDirection:this.props.isRTL?ve.b.upleft:ve.b.rightup,onOutsideClick:this._onOutsideClickHandler.bind(this,e)},n.createElement(_e.a,{key:"cancel",style:this.props.styles.closeButtonStyle,id:this._closeJumpBarDomId,onClick:this._toggleJumpBarFlyout,onKeyDown:this._onJumpbarKeyDown.bind(this),accessibilityLabel:j.CLOSE_JUMPBAR_ARIALABEL},n.createElement(l.a,{style:this.props.styles.closeButtonTextStyle},n.createElement(K.b,{type:d.a.Close}))),this._renderList()),i)}_renderFlyoutButton(e){const t=Object(F.c)(this.props.resourceStrings,j.JUMPBAR_LETTER_TITLE),r=Object(F.c)(this.props.resourceStrings,j.JUMPBAR_ALPHABET).split(",");let a="";for(let e=0;e<3;e++){a+=Object(Ce.h)(r[e+1])[0]}return n.createElement(_e.a,{id:e,accessibilityLabel:t,title:t,style:this.props.isMobile?this.props.styles.jumpBarButtonMobileStyle:this.props.styles.jumpBarButtonStyle,onClick:this._toggleJumpBarFlyout,testhooks:{id:e}},n.createElement(l.a,{style:this.props.styles.jumpBarButtonTextStyle},a))}render(){try{if(this.props.resourceStrings){const e="jumpBarRoot_"+this.props.id,t=`${e}_${this.props.uniqueId}`,r="jumpbarBtn_"+(this.props.uniqueId||this.props.id),a={position:"relative"};this.props.renderMobile&&Object.assign(a,{maxWidth:"100%"});const i={height:"0",width:"0"},s="flyoutRelativeElement"+this.props.controlKey;return n.createElement(o.a,{id:t,key:t,testhooks:{id:e},style:a},this.props.isRTL?null:n.createElement(o.a,{id:s,style:i,role:"presentation","aria-hidden":"true"}),this.props.renderMobile?this._renderFlyoutButton(r):this._renderList(),this.state.isFlyoutOpened?this._renderJumpBarFlyout(r,s):null,n.createElement(o.a,{style:{display:"none"},id:this._selectedFilterDomId,key:this._selectedFilterDomId,role:" "},j.SELECTEDFILTER_TEXT),this.props.isRTL?n.createElement(o.a,{id:s,style:i,role:"presentation","aria-hidden":"true"}):null)}return null}catch(e){return console.error(e.message),null}}}const De=Object(s.a)((function(){let e=null,t=null,r=null;const n=Object(F.h)(),a=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e=null,t=null;return function(r,n){var a,i,s,o,c,l,u,d,h,p,g,m,b,f,y,_,v,S,O,I,C,j,P,T,E,w,F,x,A,N,D,k,M,R;const L=Object(Oe.a)(r),B=Object(Ie.b)(r)&&Object(G.a)(r,V.Fb,V.Lc)&&(null===(a=Object(Ie.a)(r))||void 0===a?void 0:a.Components)?Object(Ie.a)(r).Components:null;return t!==L&&(t=L,e={jumpBarStyle:{width:"100%",height:L.sizes.Measures.Measure300,display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",listStyleType:"none",backgroundColor:(null===(o=null===(s=null===(i=null==B?void 0:B.Grid)||void 0===i?void 0:i.Footer)||void 0===s?void 0:s.JumpBar)||void 0===o?void 0:o.BackgroundColor)||L.colors.BaseColor.Grey.Grey1,border:"1px solid transparent"},jumpBarButtonStyle:{display:"flex",fontSize:L.fontSizes.Font085,fontFamily:L.fontFamilies.Regular,color:(null===(u=null===(l=null===(c=null==B?void 0:B.Grid)||void 0===c?void 0:c.Footer)||void 0===l?void 0:l.JumpBar)||void 0===u?void 0:u.TextColor)||L.colors.MainThemeColor.MainColor1.Fill,cursor:L.display.PointerCursorStyle,borderStyle:"none",backgroundColor:"transparent",padding:"0",marginLeft:L.sizes.Measures.Measure100,marginRight:L.sizes.Measures.Measure100,marginTop:L.sizes.Measures.Measure050,marginBottom:L.sizes.Measures.Measure050,maxWidth:"100%"},jumpBarButtonMobileStyle:{display:"flex",fontSize:L.fontSizes.Font100,fontFamily:L.fontFamilies.Regular,color:(null===(p=null===(h=null===(d=null==B?void 0:B.Grid)||void 0===d?void 0:d.Footer)||void 0===h?void 0:h.JumpBar)||void 0===p?void 0:p.TextColor)||L.colors.MainThemeColor.MainColor1.Fill,cursor:L.display.PointerCursorStyle,borderStyle:"none",backgroundColor:"transparent",padding:"0",marginLeft:L.sizes.Measures.Measure100,marginRight:L.sizes.Measures.Measure100,marginTop:L.sizes.Measures.Measure050,marginBottom:L.sizes.Measures.Measure050,maxWidth:"100%"},jumpBarButtonTextStyle:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},jumpBarFlyoutStyle:{border:L.borders.Border02,backgroundColor:L.colors.BaseColor.Grey.Grey1,overflowY:"auto",overflowX:"hidden"},closeButtonStyle:{position:"absolute",top:"0",right:"0",borderStyle:"none",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"transparent",cursor:L.display.PointerCursorStyle,padding:L.sizes.Measures.Measure100,width:L.sizes.Measures.Measure300,height:L.sizes.Measures.Measure300},closeButtonTextStyle:{fontSize:"16px",color:L.colors.BaseColor.Grey.Grey7},jumpBarStyleMobile:{height:"auto",flexWrap:"wrap",display:"flex",alignItems:"center",justifyContent:"flex-start",paddingTop:L.sizes.Measures.Measure300,paddingRight:L.sizes.Measures.Measure050,paddingBottom:L.sizes.Measures.Measure150,paddingLeft:L.sizes.Measures.Measure300,maxWidth:"20rem"},listItemStyle:{textAlign:"center",position:"relative",height:L.sizes.Measures.Measure125},listItemSelectedStyle:{borderStyle:"solid",borderBottomColor:(null===(b=null===(m=null===(g=null==B?void 0:B.Grid)||void 0===g?void 0:g.Footer)||void 0===m?void 0:m.JumpBar)||void 0===b?void 0:b.SelectedColor)||L.colors.MainThemeColor.MainColor1.Fill,borderBottomWidth:L.sizes.Measures.Measure025},listItemStyleMobile:{display:"flex",alignItems:"center",justifyContent:"center",cursor:L.display.PointerCursorStyle,marginRight:L.sizes.Measures.Measure150,marginBottom:L.sizes.Measures.Measure150,width:L.sizes.Measures.Measure300,height:L.sizes.Measures.Measure300,border:L.borders.Border01,borderColor:(null===(_=null===(y=null===(f=null==B?void 0:B.Grid)||void 0===f?void 0:f.Footer)||void 0===y?void 0:y.JumpBar)||void 0===_?void 0:_.BorderColor)||L.colors.BaseColor.Blue.Blue3,backgroundColor:(null===(O=null===(S=null===(v=null==B?void 0:B.Grid)||void 0===v?void 0:v.Footer)||void 0===S?void 0:S.JumpBar)||void 0===O?void 0:O.BackgroundColorMobile)||L.colors.BaseColor.White,":nth-child(2)":{marginRight:"50%"},outlineOffset:"0px !important"},listItemSelectedStyleMobile:{borderColor:(null===(j=null===(C=null===(I=null==B?void 0:B.Grid)||void 0===I?void 0:I.Footer)||void 0===C?void 0:C.JumpBar)||void 0===j?void 0:j.SelectedBorderColor)||L.colors.BaseColor.Transparent,backgroundColor:(null===(E=null===(T=null===(P=null==B?void 0:B.Grid)||void 0===P?void 0:P.Footer)||void 0===T?void 0:T.JumpBar)||void 0===E?void 0:E.SelectedColorMobile)||L.colors.BaseColor.Grey.Grey2},hyperlinkStyle:{textDecoration:"none",textAlign:"center",fontSize:L.fontSizes.Font085,fontFamily:L.fontFamilies.Regular,whiteSpace:"nowrap",color:(null===(x=null===(F=null===(w=null==B?void 0:B.Grid)||void 0===w?void 0:w.Footer)||void 0===F?void 0:F.JumpBar)||void 0===x?void 0:x.LinkColor)||L.colors.BaseColor.Grey.Grey7},hyperlinkStyleMobile:{color:(null===(D=null===(N=null===(A=null==B?void 0:B.Grid)||void 0===A?void 0:A.Footer)||void 0===N?void 0:N.JumpBar)||void 0===D?void 0:D.LinkColor)||L.colors.BaseColor.Blue.Blue3},hyperlinkSelectedStyleMobile:{color:(null===(R=null===(M=null===(k=null==B?void 0:B.Grid)||void 0===k?void 0:k.Footer)||void 0===M?void 0:M.JumpBar)||void 0===R?void 0:R.SelectedBorderColor)||L.colors.BaseColor.Grey.Grey7}}),e}}();return(i,s)=>{const o=a(i,s);if(null===e&&(e=Object(A.E)(i,s.entityTypeName)),null==t&&(t=i.metadata.attributes[s.entityTypeName]),Object(G.a)(i,V.ac)){const e=Object(P.v)(i,s.id,s.contextToken);r=e&&e.fetchXml}return{resourceStrings:n(i,j.labelList),primaryNameAttribute:e,dataSetFetchXml:r,entityAttributeMetadata:t,styles:o}}}),(function(e,t){return{applyGridFilter:(r,n,a)=>{if(e(Object(Se.m)(r,t.id,a)),e(Object(xe.b)(t.id,a,1)),n){const e=[{filterType:4,filterExpressionOrValue:r}];t.updateGridPaginationStateHandler(e,t.id),t.setResetPagingInfoForEnhancedPaging()}}}}))(Ne);var ke=r("49Nd");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Me=r("5UPV"),Re=r("RrRu"),Le=r("jRHm"),Be=r("lEp6"),Ve=r("wFY3"),Ge=r("LAGg"),Ue=r("fU7K");class Xe extends n.Component{constructor(e){super(e),this._goToFirstPage=this._goToFirstPage.bind(this),this._goToPreviousPage=this._goToPreviousPage.bind(this),this._goToNextPage=this._goToNextPage.bind(this),Object(F.c)(e.resourceStrings,ke.d)||e.retrieveResourceStrings(ke.k)}_firstButtonEnabled(e){return this.props.currentPage>1}_nextButtonEnabled(e){return(!(this.props.currentPage===Math.floor(e.totalResultCount/e.pageSize))||!this.props.pagingInfo.isGridScrolledToBottom)&&e.hasNextPage}_previousButtonEnabled(e){return this.props.currentPage>1}_goToNextPage(e){this.props.updateDataSetLoadingState(1),this.props.incrementLastPage(),this.props.setNewPageRequested(!0),this.props.updatePageNumber(this.props.currentPage+1),this._setFooterButtonsFocus(e,!0)}_goToPreviousPage(e){this.props.updateDataSetLoadingState(1),this.props.setNewPageRequested(!0),this.props.updatePageNumber(this.props.currentPage-1),this._setFooterButtonsFocus(e,!1)}_goToFirstPage(e){this.props.updateDataSetLoadingState(1),this.props.setNewPageRequested(!0),this.props.setFirstPage(1),this.props.updatePageNumber(1),this._setFooterButtonsFocus(e,!1)}_setFooterButtonsFocus(e,t){if(null!==e&&null!==e.currentTarget&&null!==e.currentTarget.parentElement&&null!==e.currentTarget.parentElement.children)if(t&&e.currentTarget.parentElement.children.length>=2&&null!==e.currentTarget.parentElement.children[1]){const t=e.currentTarget,r=e.currentTarget.parentElement.children[1];setTimeout(()=>{t.disabled&&r.focus()},500)}else if(!t&&null!==e.currentTarget.parentElement.lastElementChild){const t=e.currentTarget,r=e.currentTarget.parentElement.lastElementChild;setTimeout(()=>{t.disabled&&r.focus()},500)}}_getResources(){if(this._loadFirstPage=this._loadFirstPage||Object(F.c)(this.props.resourceStrings,ke.d),this._loadNextPage=this._loadNextPage||Object(F.c)(this.props.resourceStrings,ke.e),this._loadPreviousPage=this._loadPreviousPage||Object(F.c)(this.props.resourceStrings,ke.f),!this._spaceResource){const e=Object(F.c)(this.props.resourceStrings,ke.j);this._spaceResource=Object(Ue.CrmHtmlDecode)(e)}this._gridInfoResource=this._gridInfoResource||Object(F.c)(this.props.resourceStrings,ke.a),this._gridTotalCount=this._gridTotalCount||Object(F.c)(this.props.resourceStrings,ke.c),this._itemSelected=this._itemSelected||Object(F.c)(this.props.resourceStrings,ke.b),this._totalApproximate=this._totalApproximate||Object(F.c)(this.props.resourceStrings,ke.h),this._totalExact=this._totalExact||Object(F.c)(this.props.resourceStrings,ke.i)}render(){if(!this.props.pagingData)return null;const e=Object(Be.a)(this.props.pagingData);let t=0,r=0;e.totalResultCount&&(this.props.enhancedPagingDisabled?(t=e.pageSize*(this.props.currentPage-1)+1,r=this.props.currentPage*e.pageSize,-1!==e.totalResultCount&&this.props.currentPage*e.pageSize>e.totalResultCount&&(r=e.totalResultCount,this.props.isServerOffline&&this.props.currentPage>1&&(r=e.pageSize*(this.props.currentPage-1)+e.totalResultCount))):(t=e.pageSize*(this.props.pagingInfo.firstPageNumber-1)+1,r=this.props.pagingInfo.lastPageNumber*e.pageSize,this.props.pagingInfo.pageShift>0&&(t+=this.props.pagingInfo.pageShift,r+=this.props.pagingInfo.pageShift),-1!==e.totalResultCount&&this.props.pagingInfo.lastPageNumber*e.pageSize>e.totalResultCount&&(r=e.totalResultCount,this.props.isServerOffline&&this.props.currentPage>1&&(r=e.pageSize*(this.props.currentPage-1)+e.totalResultCount))));const a=e.totalResultCount,i=this._firstButtonEnabled(e),s=this._nextButtonEnabled(e),c=this._previousButtonEnabled(e);this._getResources();let l=a;-1===a&&(l=r<this.props.gridTotalRecordsCountLimit?this.props.gridTotalRecordsCountLimit:r);let u="";u=-1===a?String.format(this._totalApproximate,this.props.isServerOffline?r:l):this.props.isServerOffline&&a>e.pageSize?String.format(this._totalApproximate,r):String.format(this._totalExact,this.props.isServerOffline?r:a);const d=String.format(this._gridTotalCount,this._spaceResource,u),h=this.props.selectedRowCount>0?String.format(this._itemSelected,this._spaceResource,this.props.selectedRowCount):null,p=Object(F.c)(this.props.resourceStrings,ke.g),g=String.format(p,this.props.currentPage);let m=a/e.pageSize;return this.props.isServerOffline&&0!==this.props.currentPage&&(m=-1/e.pageSize),n.createElement(o.a,{style:this.props.styleProps.containerStyle},this._renderPagingText(t,r,d,h),this._renderPagingButtons(i,s,c,g,m))}_renderPagingButtons(e,t,r,a,i){return(i<0||i>1)&&this.props.enhancedPagingDisabled?n.createElement(o.a,{style:this.props.styleProps.navigationPanelStyle},n.createElement(_e.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"loadFirstPage_"+this.props.id},accessibilityLabel:this._loadFirstPage,disabled:!e,tabIndex:0,onClick:this._goToFirstPage},n.createElement(K.b,{type:d.a.FirstPageButton})),n.createElement(_e.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"moveToPreviousPage_"+this.props.id},accessibilityLabel:this._loadPreviousPage,disabled:!r,tabIndex:0,onClick:this._goToPreviousPage},n.createElement(K.b,{type:d.a.BackButton})),n.createElement(l.a,{style:this.props.styleProps.pageNumberStyle,testhooks:{id:"pageNumber_"+this.props.id},role:Ee.a,notificationType:Ve.b},null!==this.props.currentPage?String.format(a,this.props.currentPage):null),n.createElement(_e.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"moveToNextPage_"+this.props.id},accessibilityLabel:this._loadNextPage,disabled:!t,tabIndex:0,onClick:this._goToNextPage},n.createElement(K.b,{type:d.a.Forward}))):null}_renderPagingText(e,t,r,a){if(!this.props.pagingTextDisabled&&this.props.shouldPagingTextRender&&this.props.gridTotalRecordsCountLimit)return n.createElement(o.a,{style:this.props.styleProps.pagingTextStyle,testhooks:{id:"pagingText"}},n.createElement(l.a,null,String.format(this._gridInfoResource,e,t,r,a)))}}const ze=Object(s.a)((function(){let e=null;const t=Object(F.h)(),r=function(){let e=null,t=null;const r={containerStyle:{justifyContent:"space-between",alignItems:"center",width:"100%"},navigationPanelStyle:{flexDirection:"row"},pageNumberStyle:{whiteSpace:"nowrap"},pagingButton:{borderStyle:"none",display:"inline-block",backgroundColor:"transparent",fontSize:"16px"}};return function(n,a){var i,s,o,c,l,u,d,h,p,g;const m=Object(Ie.b)(n)&&Object(G.a)(n,V.Fb,V.Lc)&&(null===(i=Object(Ie.a)(n))||void 0===i?void 0:i.Components)?Object(Ie.a)(n).Components:null;if(e!==a){e=a;const i=Object(Oe.a)(n),{isRTL:b}=n.user.userSettings,f=Object.assign(Object.assign({},r.containerStyle),{marginRight:i.sizes.Measures.Measure100,marginLeft:i.sizes.Measures.Measure100}),y=Object.assign(Object.assign({},r.navigationPanelStyle),{["margin"+(b?"Right":"Left")]:"auto"}),_=Object.assign(Object.assign({},r.pageNumberStyle),{marginRight:i.sizes.Measures.Measure100,marginLeft:i.sizes.Measures.Measure100,fontSize:i.fontSizes.Font085,fontFamily:i.fontFamilies.Regular,color:(null===(o=null===(s=null==m?void 0:m.Grid)||void 0===s?void 0:s.Footer)||void 0===o?void 0:o.TextColor)||i.colors.BaseColor.Grey.Grey7}),v=Object.assign(Object.assign(Object.assign({},r.pagingButton),{color:(null===(l=null===(c=null==m?void 0:m.Grid)||void 0===c?void 0:c.Footer)||void 0===l?void 0:l.IconColor)||i.colors.BaseColor.Blue.Blue3,marginLeft:i.sizes.Measures.Measure050,marginRight:i.sizes.Measures.Measure050,width:"0px",fontSize:i.fontSizes.Font085,"[disabled]":{color:(null===(h=null===(d=null===(u=null==m?void 0:m.Grid)||void 0===u?void 0:u.Footer)||void 0===d?void 0:d.Disabled)||void 0===h?void 0:h.IconColor)||i.colors.BaseColor.Grey.Grey5}}),b&&{transform:"scaleX(-1)"}),S={["margin"+(b?"Left":"Right")]:"auto",fontSize:i.fontSizes.Font085,fontFamily:i.fontFamilies.Regular,color:(null===(g=null===(p=null==m?void 0:m.Grid)||void 0===p?void 0:p.Footer)||void 0===g?void 0:g.TextColor)||i.colors.BaseColor.Grey.Grey7};t=Object.assign(Object.assign({},r),{containerStyle:f,navigationPanelStyle:y,pagingButton:v,pageNumberStyle:_,pagingTextStyle:S})}return t}}();return(n,a)=>{const i=r(n,a.contextString),s=Object(P.fb)(n,a.id,a.contextToken),o=s?s.length:0,c=t(n,ke.k),l=Object(P.Y)(n,a.id,a.contextToken),u=Object(P.x)(n,a.id,a.contextToken);return e!==i&&(e=i),{selectedRowCount:o,resourceStrings:c,pagingData:l,currentPage:null===u?1:u,styleProps:e}}}),(function(e,t){return{retrieveResourceStrings:t=>e(Object(w.e)(t)),updatePageNumber:r=>{if(e(Object(xe.b)(t.id,t.contextToken,r)),1===r&&t.enhancedPagingDisabled&&e(Object(Ge.b)(t.id,t.contextToken)),t.isGridRoot){const e=[{filterType:12,filterExpressionOrValue:r}];t.updateGridPaginationStateHandler(e,t.id)}return e(Object(Le.b)(t.id,t.contextToken,null)),e(Object(Re.b)(t.id,t.contextToken,[]))},setNewPageRequested:r=>{e(Object(Me.b)(t.id,t.contextToken,r))}}}))(Xe);var qe=r("PBKq"),He=r("Yexl"),We=r("IqkD");var Ye=r("5O6t"),Qe=r("b8TU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Ke extends n.Component{constructor(e){super(e),this._quickFindInnerTextRef=null,this._searchBarFocusTriggered=!1,this._onTextInputChange=this._onTextInputChange.bind(this),this._onkeyDown=this._onkeyDown.bind(this),this._onButtonClick=this._onButtonClick.bind(this),this._focusTextInput=this._focusTextInput.bind(this),this.updateSearchTextAndFind=this.updateSearchTextAndFind.bind(this),this.props.isGridPaginationStateFeatureEnabled&&this.props&&this.props.gridInput&&this.props.gridInput.quickFindExpression?this.state={quickFindText:this.props.gridInput.quickFindExpression.trim(),currentViewId:this.props.currentViewIdToRestore,clearQuickFind:!0}:this.state={quickFindText:null,currentViewId:null,clearQuickFind:!1}}clearSearchBar(){this.setState({quickFindText:null,clearQuickFind:!1})}updateSearchTextAndFind(e,t){this.setState({quickFindText:e},()=>{t&&this._applyQuickFind()})}_onButtonClick(e){this.props.updateDataSetLoadingState(1),this.state.clearQuickFind?this._clearQuickFind():this._applyQuickFind()}_onkeyDown(e){e.keyCode===je.a.Enter&&(this.props.updateDataSetLoadingState(1),this._applyQuickFind())}_onTextInputChange(e){const t=""===e;this.setState({quickFindText:e,clearQuickFind:t})}_applyFilter(){const e=this._formatQuickFindText(),t=Object(Pe.b)(e,this.props.primaryNameAttribute);this.props.applyGridFilter(t,this.props.contextToken)}_clearFilter(){this.setState({quickFindText:""},()=>{this._applyFilter()})}_formatQuickFindText(){return this.state.quickFindText.split("*").join("%").replace(/%?\s*$/,"%")}_applyQuickFind(){this.state.quickFindText&&""!==this.state.quickFindText.trim()?this.props.shouldUseFilter?(this._applyFilter(),this.setState({clearQuickFind:!0})):this.props.applyQuickFind(this.state.quickFindText,this.props.id,this.props.gridInput,this.props.contextToken,this.props.controlName,this.props.isGridPaginationStateFeatureEnabled).then(e=>{this.setState({clearQuickFind:!0}),this.state.currentViewId||this.setState({currentViewId:e})}):this._clearQuickFind()}_clearQuickFind(){this.props.shouldUseFilter?(this._clearFilter(),this.setState({clearQuickFind:!1})):this.props.clearQuickFind(this.state.currentViewId,this.props.id,this.props.gridInput,this.props.contextToken,this.props.controlName).then(()=>{this.setState({quickFindText:"",currentViewId:null,clearQuickFind:!1})})}_getPlaceholderText(){return this.props.isGridSearchCanUseCurrentViewFeatureEnabled?this.props.shouldGridSearchUseCurrentView?Object(F.c)(this.props.resourceStrings,j.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT_SEARCH_THIS_VIEW):Object(F.c)(this.props.resourceStrings,j.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT_QUICK_FIND_VIEW):Object(F.c)(this.props.resourceStrings,j.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT)}_createUniqueId(e){const{contextToken:t,id:r}=this.props;return t.controlName?`${e}_${t.controlName}_${r}`:`${e}_${r}`}render(){const e=this._getPlaceholderText(),t=Object(F.c)(this.props.resourceStrings,j.QUICK_FIND_TOOLTIP_CLEAR_BUTTON);if(this.props.showNewQuickFindSearchBarForMobile)return n.createElement(o.a,null,n.createElement(L.i,{placeholder:e,cancelText:Object(F.c)(this.props.resourceStrings,j.QUICK_FIND_CANCEL_LABEL_ID),clearText:t,applyQuickFind:this._applyQuickFind,windowWidth:this.props.viewPortWidth,updateSearchTextAndFind:this.updateSearchTextAndFind,value:this.state.quickFindText,quickFindRNStyleProps:this.props.quickFindRNStyleProps}));const r=this._createUniqueId("quickFind_text"),a=this._createUniqueId("quickFind_button"),i=this._createUniqueId("quickFind_button_icon"),s=Object(F.c)(this.props.resourceStrings,j.QUICK_FIND_TOOLTIP_APPLY_BUTTON),c=this.state&&this.state.clearQuickFind?t:s;return n.createElement(o.a,{style:this.props.styleProps.quickFindStyle,testhooks:{id:"data-set-quickFind-container"}},n.createElement(qe.a,{id:r,key:r,ref:e=>{this._quickFindInnerTextRef=e},testhooks:{id:r},value:this.state&&this.state.quickFindText?this.state.quickFindText:null,accessibilityLabel:e,onChangeText:this._onTextInputChange,onKeyDown:this._onkeyDown,style:this.props.styleProps.inputStyle,placeholder:e}),n.createElement(_e.a,{id:a,key:a,testhooks:{id:a},accessibilityLabel:c,title:c,onClick:this._onButtonClick,tabIndex:0,style:this.props.styleProps.buttonStyle},n.createElement(K.b,{id:i,key:i,type:this.state&&this.state.clearQuickFind?d.a.Cancel:d.a.SearchButton,style:this.props.styleProps.buttonIconStyle})))}_focusTextInput(){if(this.props.focusSearchBoxAfterRender&&!this._searchBarFocusTriggered){const e=a.findDOMNode(this._quickFindInnerTextRef);e&&(e.focus(),this._searchBarFocusTriggered=!0)}}componentDidMount(){this._focusTextInput()}}Ke.displayName="DataSetQuickFind";const Je=Object(s.a)((function(){let e=null,t=null,r=null,n={quickFindText:null,currentViewId:null,clearQuickFind:null,primaryNameAttribute:null,styleProps:null,quickFindRNStyleProps:null,shouldUseFilter:!1,resourceStrings:null,isGridPaginationStateFeatureEnabled:null,currentViewIdToRestore:null,shouldGridSearchUseCurrentView:null,isGridSearchCanUseCurrentViewFeatureEnabled:null,isQuickFindImprovementsFeatureEnabled:null,viewPortWidth:null};const a=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e,t=null,r=null,n={buttonStyle:{border:"none",padding:"0",backgroundColor:"transparent",flexDirection:"column","-webkit-appearance":"none"},inputStyle:{border:"none",backgroundColor:"transparent",width:"100%",minWidth:"0px","-webkit-appearance":"none","::-ms-clear":{display:"none"}},quickFindStyle:{borderWidth:"1px",borderStyle:"solid",display:"flex",flexDirection:"row",width:"100%"},buttonIconStyle:{fontWeight:"bold",marginTop:"auto",marginBottom:"auto",width:"100%"}};return function(a,i){var s,o,c,l,u,d,h,p,g,m,b,f,y,_,v,S;const O=Object(We.g)(a),I=Object(Ie.b)(a)&&Object(G.a)(a,V.Fb,V.Lc)&&(null===(s=Object(Ie.a)(a))||void 0===s?void 0:s.Components)?Object(Ie.a)(a).Components:null;if(I&&(n=Object.assign(n,{inputStyle:{color:null===(l=null===(c=null===(o=null==I?void 0:I.Grid)||void 0===o?void 0:o.ColumnHeader)||void 0===c?void 0:c.QuickFind)||void 0===l?void 0:l.TextColor,backgroundColor:null===(h=null===(d=null===(u=null==I?void 0:I.Grid)||void 0===u?void 0:u.ColumnHeader)||void 0===d?void 0:d.QuickFind)||void 0===h?void 0:h.BackgroundColor,borderColor:"transparent"},searchIconStyle:{color:null===(m=null===(g=null===(p=null==I?void 0:I.Grid)||void 0===p?void 0:p.ColumnHeader)||void 0===g?void 0:g.QuickFind)||void 0===m?void 0:m.IconColor},buttonIconStyle:{color:null===(y=null===(f=null===(b=null==I?void 0:I.Grid)||void 0===b?void 0:b.ColumnHeader)||void 0===f?void 0:f.QuickFind)||void 0===y?void 0:y.IconColor}})),t!==i||e!==O){t=i,e=O;const s=Object(Oe.a)(a),o=Object.assign(Object.assign({},n.buttonStyle),{":before":{content:"''",display:"inline-block",width:s.sizes.Measures.Measure250}}),c=Object.assign(Object.assign({},n.quickFindStyle),{borderColor:(null===(S=null===(v=null===(_=null==I?void 0:I.Grid)||void 0===_?void 0:_.ColumnHeader)||void 0===v?void 0:v.QuickFind)||void 0===S?void 0:S.BorderColor)||s.colors.BaseColor.Grey.Grey3,["padding"+(O?"Right":"Left")]:s.sizes.Measures.Measure025});r=Object.assign(Object.assign({},n),{buttonStyle:o,quickFindStyle:c})}return r}}(),i=Object(Ye.a)(),s=Object(F.h)();let o=null;return(c,l)=>{const u=a(c,l.contextString),d=i(c,l);r||(r=s(c,j.labelList)),e!==u&&(e=u),t!==d&&(t=d),o||(o=Object(G.c)(c,V.bd));const h=Object(G.a)(c,V.zb);let p=null;if(h&&l.gridInput){p=(l.gridInput&&l.gridInput.viewId&&!v.a.isNullOrEmpty(l.gridInput.viewId)?l.gridInput.viewId:null)||Object(O.a)(c,l.entityTypeName,I.a.MAIN_APPLICATION_VIEW)}return n={quickFindText:"",currentViewId:null,clearQuickFind:!1,primaryNameAttribute:Object(A.E)(c,l.entityTypeName),styleProps:e,quickFindRNStyleProps:t,shouldUseFilter:!(Object(Ce.e)(l.contextString)||Object(Ce.d)(l.contextString)||Object(Ce.g)(l.contextString)&&o),resourceStrings:r,isGridPaginationStateFeatureEnabled:h,currentViewIdToRestore:p,shouldGridSearchUseCurrentView:Object(ie.l)(c),isGridSearchCanUseCurrentViewFeatureEnabled:Object(G.a)(c,V.Db,V.h),isQuickFindImprovementsFeatureEnabled:Object(G.a)(c,V.ad,V.tc),viewPortWidth:Object(Qe.c)(c)},n}}),(function(e,t){return{applyQuickFind:(r,n,a,i,s,o)=>{if(a&&o){const e=[{filterType:1,filterExpressionOrValue:r}];a.entityTypeName===f.a&&e.push({filterType:2,filterExpressionOrValue:t.entityTypeName}),t.updateGridPaginationStateHandler(e,t.id),t.resetPagingInfoForEnhancedPaging()}return e(Object(He.a)(r,n,i,s))},clearQuickFind:(r,n,a,i,s)=>{if(a){const e=[{filterType:1,filterExpressionOrValue:null}];t.updateGridPaginationStateHandler(e,t.id)}return e(Object(He.b)(r,n,i,s))},applyGridFilter:(r,n)=>{e(Object(Se.n)(r,t.id,n))}}}),null,{forwardRef:!0})(Ke);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Ze=({onSeeMoreClick:e,resourceStrings:t,containerStyle:r,buttonStyle:a,seeMoreTextStyle:i,localizedStrings:s})=>function(e,t,r,a,i,s){const c=(null==s?void 0:s.seeMoreTooltip)||Object(F.c)(t,j.SEE_MORE_TOOL_TIP),u=(null==s?void 0:s.seeMoreLabel)||Object(F.c)(t,j.SEE_MORE_LABEL);let d=c;return(null==s?void 0:s.uniqueLabel)&&(d+=" "+s.uniqueLabel),n.createElement(o.a,{style:r},n.createElement(_e.a,{key:"seeMoreBtn",id:"seemore-btn",title:c,style:a,onClick:e,tabIndex:0,accessibilityLabel:d,describedByElementId:null},n.createElement(l.a,{style:i},u)))}(e,t,r,a,i,s)
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */;var $e=r("5R5s"),et=r("kKLx"),tt=r("vNXc"),rt=r("504W"),nt=r("aF0N");var at=r("iOrn"),it=r("zFtG"),st=r("waMg"),ot=r("6Qf/"),ct=r("B9jE"),lt=r("Jpj4"),ut=r("E6o7"),dt=r("QXpm"),ht=r("rQHy"),pt=r("kt5S"),gt=r("Nb1E"),mt=r("odYE"),bt=r("wyQO");var ft=r("fyfl"),yt=r("ojtV"),_t=r("2YQW"),vt=r("ngeo"),St=r("WZ96"),Ot=r("QBtP"),It=r("1uZV"),Ct=r("tICD"),jt=r("uNu9"),Pt=r("PVDM"),Tt=r("PZ34");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Et(e){return n.createElement(ce.a,{loader:()=>Promise.all([r.e(9),r.e(10),r.e(11),r.e(13),r.e(12),r.e(14),r.e(15),r.e(17),r.e(21),r.e(33)]).then(r.bind(null,"BvEH")).then(e=>e.DataSetExpressionBuilder),props:e})}Et.displayName="DataSetExpressionBuilderLazyLoadComponent";var wt=r("b41/"),Ft=r("p/Kg"),xt=r("Tz6o"),At=r("BkgE"),Nt=r("+HfF"),Dt=r("Uv1Y"),kt=r("VcAV"),Mt=r("eOoD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Rt(e){return n.createElement(ce.a,{loader:()=>Promise.all([r.e(9),r.e(10),r.e(11),r.e(13),r.e(12),r.e(14),r.e(16),r.e(112),r.e(32)]).then(r.bind(null,"12bH")).then(e=>e.ColumnEditor),props:e})}Rt.displayName="ColumnEditorLazyLoadComponent";var Lt=r("2Sll"),Bt=r("ozuu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
Object(Lt.a)();const Vt=f.x+".DataSetHost",Gt=Vt+".AdvancedFind.Open",Ut=Vt+".AdvancedFind.Discard";class Xt extends n.Component{constructor(e){super(e),this._quickFindCommandBarId="showQuickFind",this._changeVisualizationCommandBarId="changeVisualization",this._savedDefault=null,this._savedFormInfo=null,this._currentFilterValue=null,this._addedCommandListFromHost=[],this._addedCommandListFromControl=[],this._addedCommandListFromHostParent=[],this._memoizedConfiguration=null,this._memoizedResourceStrings=null,this._memoizedViewConfigurations=null,this._memoizedButtonList=null,this._parentSwitchVisualizationButton=null,this._keyIndex=0,this._width=0,this._height=0,this._isFirstRequestComplete=!1,this._isPreNavigationEventAttached=!1,this._offlineSqlQueryRetrieveState=0,this._dataSetQuickFindRef=n.createRef(),this._isSubGridFirstLoad=!1,this._minWidthForChartPlusGridReflow=640,this._isReflowLayoutVertical=!1,this._isSwitchVisualizationInitialized=!1,this._accessibilityId=1,this._incrementLastPage=()=>{this.props.pageNumber===this.state.pagingInfo.lastPageNumber&&this.setState({pagingInfo:Object.assign(Object.assign({},this.state.pagingInfo),{lastPageNumber:this.state.pagingInfo.lastPageNumber+1})})},this._setFirstPage=e=>{this.setState({pagingInfo:Object.assign(Object.assign({},this.state.pagingInfo),{firstPageNumber:e})})},this._seeMorePopup=this._seeMorePopup.bind(this),this._onSendControlCommandsEventFired=this._onSendControlCommandsEventFired.bind(this),this._onSelectedOrderColumnChangeFired=this._onSelectedOrderColumnChangeFired.bind(this),this._onParentPagePreNavigationEventFired=this._onParentPagePreNavigationEventFired.bind(this),this._onFilterChange=this._onFilterChange.bind(this),this._onActivityTypeMenuDismissed=this._onActivityTypeMenuDismissed.bind(this),this._updateDataSetLoadingStateEvent=this._updateDataSetLoadingStateEvent.bind(this),this._updateFilterValue=this._updateFilterValue.bind(this),this._onRollupViewToggleChanged=this._onRollupViewToggleChanged.bind(this),this._onQuickFind=this._onQuickFind.bind(this),this._onItemIconPointerDown=this._onItemIconPointerDown.bind(this),this._onViewChanged=this._onViewChanged.bind(this),this._onControlLoadedError=this._onControlLoadedError.bind(this),this._updatePagingInfo=this._updatePagingInfo.bind(this),this._updateFilterExpressionStrings=this._updateFilterExpressionStrings.bind(this),this._configureDataSetControlParams=this._configureDataSetControlParams.bind(this),this._openManageDuplicatesDialog=this._openManageDuplicatesDialog.bind(this),this._showInnerError=this._showInnerError.bind(this),this._isInSeeMoreState=this._isInSeeMoreState.bind(this),this._getChartPaneText=this._getChartPaneText.bind(this),this.onMeasuring=this.onMeasuring.bind(this),this.closeFilterPanel=this.closeFilterPanel.bind(this),this._clearActivityTypeFilter=this._clearActivityTypeFilter.bind(this),this._updateCurrentPageNumber=this._updateCurrentPageNumber.bind(this),this._isNativePlatform=null!=e.platformType&&e.platformType===b.b.Native,this._currentPagingString=null,this._preSeeMoreCachedPagingString=null,this._boundOnRecordsSelected=null,this._pageNumberToRestoreForEnhancedPaging=this.props.pageNumberForEnhancedPaging,this._shouldResetPagingForEnhancedPaging=!1,this._previousSortingInfo=null,this._resetProcessedForEnhancedPaging=!0,this.state={quickFindVisibility:!1,addedCommandList:[],inSeeMoreState:!1,pagingInfo:{firstPageNumber:Object(rt.a)(this.props.pageNumberForEnhancedPaging)?1:this.props.pageNumberForEnhancedPaging,lastPageNumber:Object(rt.a)(this.props.pageNumberForEnhancedPaging)?1:this.props.pageNumberForEnhancedPaging,currentPageNumber:Object(rt.a)(this.props.pageNumberForEnhancedPaging)?1:this.props.pageNumberForEnhancedPaging,pageShift:0,isGridScrolledToBottom:!1},compositeControlInitState:N.a.Uninitialized,controlLoadErrorMessage:null,controlLoadInnerErrorMessage:null,loadingState:0,isFilterPanelOpen:!1,columnEditorPanelOpen:!1,isAdvancedFilterEdited:!1},this._parentDefinedProps={eventListeners:[{eventname:"sendgridcontrolcommandstohostcommandbar",eventhandler:[this._onSendControlCommandsEventFired]},{eventname:"onselectedordercolumnchange",eventhandler:[this._onSelectedOrderColumnChangeFired]},{eventname:"parentPagePreNavigation",eventhandler:[this._onParentPagePreNavigationEventFired]},{eventname:"sendpaginginfotopagingcontrol",eventhandler:[this._updatePagingInfo]},{eventname:"sendfilterexpressionstringstodatasethost",eventhandler:[this._updateFilterExpressionStrings]},{eventname:"updatedatasethostloadingstate",eventhandler:[this._updateDataSetLoadingStateEvent]},{eventname:"openmanageduplicatesdialog",eventhandler:[this._openManageDuplicatesDialog]},{eventname:"showinnererror",eventhandler:[this._showInnerError]},{eventname:"sendcurrentpagenumber",eventhandler:[this._updateCurrentPageNumber]}],containerStyleOverrides:{rootContainer:{flex:Object(Ce.e)(e.contextString)?"1 1 100%":"1 1 auto",minHeight:"0"}},onControlLoadedError:this._onControlLoadedError},this._seeMoreHelper=new m.a}_logInfo(e){this._tracer&&this._tracer.info(e)}_updateDataSetLoadingStateEvent(e){this._updateDataSetLoadingState(e.value)}_updateDataSetLoadingState(e,t={}){(1===e&&this.props.featureControlProps.isGridProgressIndicatorFeatureEnabled||1!==e)&&(this.setState(Object.assign(t,{loadingState:e})),this._currentLoadingTimeoutIdentifier&&clearTimeout(this._currentLoadingTimeoutIdentifier),this._currentLoadingTimeoutIdentifier=null,1===e&&(this._currentLoadingTimeoutIdentifier=setTimeout(()=>{this._updateDataSetLoadingState(2)},3e4)))}_openManageDuplicatesDialog(e){!this.props.isOffline&&e&&e.entityReference&&e.reject&&this.props.openManageDuplicatesDialog(e)}_showInnerError(e){this.props.showInnerError(e)}_updatePagingInfo(e){e&&e.currentPageNumber>0&&(this.props.setNewPageRequested(this.props.id,this.props.contextToken,!1),this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&(this._resetProcessedForEnhancedPaging||1!==e.currentPageNumber||(this._resetProcessedForEnhancedPaging=!0,this._pageNumberToRestoreForEnhancedPaging=1),this.props.pageNumberForEnhancedPaging!==e.currentPageNumber&&this.props.updatePageNumberForEnhancedPaging(e.currentPageNumber,this.props.contextToken)),Object(_t.e)(this.state.pagingInfo,e)||this.setState({pagingInfo:e}))}_updateCurrentPageNumber(e){e&&e.currentPageNumber>0&&this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,e.currentPageNumber)}_updateFilterExpressionStrings(e){if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&e&&(e.nativeFilterExpressionString||e.dataSetFilterExpressionString)){const t=[{filterType:5,filterExpressionOrValue:e.nativeFilterExpressionString},{filterType:6,filterExpressionOrValue:e.dataSetFilterExpressionString}];this.props.updateGridPaginationStateHandler(t,this.props.id),this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1)}}_setResetPagingInfoForEnhancedPaging(){this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&this._isNativePlatform&&(this._shouldResetPagingForEnhancedPaging=!0)}_resetPagingInfoForEnhancedPaging(){this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&this._isNativePlatform&&(this.setState({pagingInfo:{firstPageNumber:1,lastPageNumber:1,currentPageNumber:1,pageShift:0,isGridScrolledToBottom:!1}}),this._pageNumberToRestoreForEnhancedPaging=1)}_onControlLoadedError(e){const t=e?e.message:null;this._logTelemetryData(t),this._setControlLoadError()}_setControlLoadError(e=j.GRID_CONTROL_LOAD_ERROR){this.setState({controlLoadErrorMessage:Object(F.c)(this.props.resourceStrings,e)})}_logTelemetryData(e){this._tracer&&this._tracer.error("Loading for the grid failed because of error :"+(e||"CustomControl_Calendar_ErrorView_DefaultMessage"))}_renderTitle(){if(!this.props.descriptor)return null;const{ShowLabel:e,Name:t,Label:r}=this.props.descriptor,a=this._isWidthLessThanViewportSm()?this.props.styles.titleMobileStyle:this.props.styles.titleStyle;return e&&r?n.createElement(l.a,{key:t,semanticTag:"div",style:a},r):null}onMeasuring(e,t){if(this._height=t,Math.abs(this._width-e)<50)return;if(this._width=e,this._getCachedSize()&&e===this._getCachedSize().width&&(!t||t===this._getCachedSize().height))return;const r={},n=this._seeMoreHelper.shouldGivePoppedOutDimensions(!0),a=this._seeMoreHelper.getSeeMorePopupInfo(),i=n?a.endWidthInner:e,s=[];!this._isWidthInitialized()&&e>0&&(r.isWidthInitialized=!0,s.push("isWidthInitialized:"+r.isWidthInitialized));const o=i<=this.props.viewportSm;o!==this._isWidthLessThanViewportSm()&&(r.isWidthLessThanViewportSm=o,s.push("isWidthLessThanViewportSm:"+o));const c=i<=this.props.viewportM;c!==this._isWidthLessThanViewportM()&&(r.isWidthLessThanViewportM=c,s.push("isWidthLessThanViewportM:"+c));const l=i<this._minWidthForChartPlusGridReflow;l!==this._isWidthLessThanMinWidthForChartPlusGridReflow()&&(r.isWidthLessThanMinWidthForChartPlusGridReflow=l,s.push("isWidthLessThanMinWidthForChartPlusGridReflow:"+l));const u=this._jumpBarShouldRenderAsFlyout(i);u!==this._isJumpBarRenderingAsFlyout()&&(r.isJumpBarRenderingAsFlyout=u,s.push("isJumpBarRenderingAsFlyout:"+u));const d=i>480;d!==this._isWidthGreaterThan480()&&(r.isWidthGreaterThan480=d,s.push("isWidthGreaterThan480:"+d));const h=n?a.endHeightInner:t,p=h>240;p!==this._isHeightGreaterThan240()&&(r.isHeightGreaterThan240=p,s.push("isHeightGreaterThan240:"+p)),0!==e&&0!==t||this._tracer&&this._tracer.warn(`The measuring service returned width or height as 0. The new dimensions are width is ${e} and height is ${t}`);let g=!1;const m=this.props.quickFindProps&&o&&!this._checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot();m!==this._showCommandBarButtonSearch()&&(r.showCommandBarButtonSearch=m,s.push("showCommandBarButtonSearch:"+m),g=!0);const b=Object(Ce.e)(this.props.contextString)||Object(Ce.d)(this.props.contextString)&&this.props.featureControlProps.isChartOnAssociatedGridEnabled;if(b!==this._showCommandBarButtonShowChart()&&(r.showCommandBarButtonShowChart=b,s.push("showCommandBarButtonShowChart:"+b),g=!0),s.length>0){s.push("currentWidth:"+e),s.push("currentHeight:"+t),s.push("usePoppedOutDimensions:"+n),s.push("newWidth:"+i),s.push("newHeight:"+h),s.push("commandBarNeedsUpdate:"+g);const r=s.join(",");this._logInfo("onMeasuring change: "+r)}this._getCachedSize()&&this._getCachedSize().update&&(this._cachedSize=this._getCachedSize().update({width:e,height:t,isWidthInitialized:e>0,isWidthLessThanViewportSm:o,isWidthLessThanViewportM:c,isWidthLessThanMinWidthForChartPlusGridReflow:l,isJumpBarRenderingAsFlyout:u,isWidthGreaterThan480:d,isHeightGreaterThan240:p,showCommandBarButtonSearch:m,showCommandBarButtonShowChart:b}));let f=r;g&&(f=Object.assign(f,this._getUpdateAddedCommandList(m,b))),Object.keys(f).length&&this.setState(f)}_getUpdateAddedCommandList(e,t){if(this._addedCommandListFromHost=[],e&&(this._logInfo("Adding search button to commandbar for DataSethost."),this._addedCommandListFromHost.push({Icon:"SearchButton",DisplayText:Object(F.c)(this.props.resourceStrings,j.QUICK_FIND_COMMANDBAR_TEXT),Id:this._quickFindCommandBarId,execute:this._onQuickFind})),this.props.isQueryMode){this._logInfo("Adding clear query button to commandbar for DataSethost.");const e=this._getClearQueryText();this._addedCommandListFromHost.push({Icon:"ClearDefault",DisplayText:e,Tooltip:{title:e},Id:"ClearQuery",execute:()=>this.props.clearQuery()})}if(!this.props.isOffline&&t){this._logInfo("Adding show chart button to commandbar for DataSethost.");const e=this._getChartPaneText();this._addedCommandListFromHost.push({Icon:"SelectChart",DisplayText:e,Tooltip:{title:e},Id:"ShowChartPane",execute:()=>this.props.toggleChartPane(this.props.id,this.props.contextToken,!this.props.showChart)})}return this._onAddedCommandListChange(!1)}_onViewChanged(e,t,r=!0){var n;r&&this._updateDataSetLoadingState(1);const a=this.props.descriptor?this.props.descriptor.Id:null;this._logInfo("The view for the grid changed. The new view parameters for the view are - NewViewId : "+e+", EntityTypeName : "+t+"and ControlName : "+a),this._resetPagingInfoForEnhancedPaging(),null===(n=this._dataSetQuickFindRef.current)||void 0===n||n.clearSearchBar();const i=this.props.gridInput&&this.props.gridInput.entityTypeName.toLowerCase()===P.a;this.props.updateView(this.props.id,a,e,t,this.props.commandBarProps&&this.props.commandBarProps.commandManagerId,this.props.contextToken,this.props.userId,this.props.featureControlProps&&this.props.featureControlProps.isQueueFilterPerfUCIEnabled,i).then(()=>{this.props.nonCompositionProps&&this.props.nonCompositionProps.setPageInputViewId&&this.props.nonCompositionProps.setPageInputViewId(e),this.state.controlLoadErrorMessage&&this.setState({controlLoadErrorMessage:null})},e=>{this._logInfo(e.message),this._setControlLoadError()})}_onItemIconPointerDown(e,t,r,n,a){this._logInfo("Trying to set default view for user. The new view parameters for the view are - NewViewId : "+t+", EntityTypeName : "+e+", ViewType : "+r+"and Unpin  : "+a);const i=se(this._currentFilterValue);return this.props.updateUserDefaultGridView(e,t,r,n,i,a)}_onQuickFind(){this.setState({quickFindVisibility:!this.state.quickFindVisibility})}_getChartPaneText(){const{resourceStrings:e,showChart:t}=this.props;return t?Object(F.c)(e,j.CHARTS_HIDE_CHART_PANE_LABEL):Object(F.c)(e,j.CHARTS_SHOW_CHART_PANE_LABEL)}_getClearQueryText(){return"Clear query"}_updateFilterValue(e){this._currentFilterValue=e}_onFilterChange(e,t=this.props.gridEntityTypeName){this._logInfo("Applying grid filter, the new value received is "+e),2===this.state.loadingState&&this._updateDataSetLoadingState(1),this._updateFilterValue(e);const r=Object($e.a)(this.props.viewSelectorProps.entityTypeName,this.props.userId,this.props.contextToken,this.props.featureControlProps.isQueueFilterPerfUCIEnabled,this.props.entityIsActivityType).getFilterExpression(e,this.props.userSetting,t);this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1),this._setResetPagingInfoForEnhancedPaging(),this.props.applyGridFilter(r,e,this.props.contextToken)}_clearActivityTypeFilter(){this.props.applyActivityTypeFilter("","",this.props.contextToken)}_onActivityTypeMenuDismissed(e){if(!this.props.isOffline){const t=e.join(","),r=function(e,t){if(null!=e){if(e.indexOf("selectAllKey")>-1||0===e.length||null!=t&&t.length===e.length)return null;let r=null;const n=[];for(let t=0;t<e.length;t++)n.push({attributeName:"activitytypecode",conditionOperator:0,value:e[t]});return n&&n.length>0&&(r={conditions:n,filterOperator:1}),r}}(e,this.props.entityFilterProps.filterOptionsForActivityType),n=r?JSON.stringify(r):"";void 0===this.props.entityFilterProps.activityTypePreviousValues?this.props.applyActivityTypeFilter(n,t,this.props.contextToken):t!==this.props.entityFilterProps.activityTypePreviousValues&&this._shouldActivitySelectAllFilterFire(t,this.props.entityFilterProps.activityTypePreviousValues,this.props.entityFilterProps.isActivityFilterSelectAllEnabled)&&(this._logInfo("Applying activity type grid filter, the new value received is "+t),2===this.state.loadingState&&this._updateDataSetLoadingState(1),this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1),this._setResetPagingInfoForEnhancedPaging(),this.props.applyActivityTypeFilter(n,t,this.props.contextToken));const a=[{name:"ActivityTypeFilterUsage",value:"Initiated"},{name:"SelectedActivityTypeFilterCount",value:e.length},{name:"ActivityTypeFilterDropDownCount",value:this.props.entityFilterProps.filterOptionsForActivityType.length}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentSuccess&&this.context.EventManager.ReportComponentSuccess(Vt,a)}}_shouldActivitySelectAllFilterFire(e,t,r){if(r){let r=!1,n=!1;return(t.indexOf("selectAllKey")>-1||""===t)&&(r=!0),(e.indexOf("selectAllKey")>-1||""===e)&&(n=!0),!(r&&n)}return!0}_onRollupViewToggleChanged(e){this._logInfo("Toggling rollupView control, the new value received is "+e),this.props.toggleGridRollupView(e,this.props.contextToken)}_updateFilterOnViewSelectorChange(e){this._logInfo("Updating dataset with the existing filter selection for activity pointer"),this._onFilterChange(this._currentFilterValue,e)}_onSendControlCommandsEventFired(e){this._logInfo("Adding control commands to command bar. The command to be added are : "+e),e!==this._addedCommandListFromControl&&(this._addedCommandListFromControl=e,this._onAddedCommandListChange())}_onSelectedOrderColumnChangeFired(e){if(this._logInfo("Updating jumpbar filter based on the selected order column"),this.props.featureControlProps.isJumpBarShouldHonorSortingFeatureEnabled&&this.props.jumpBarProps){let t=e.columnSortingName;t=Object(Pe.d)(t,e.columnSortingType,e.primaryNameAttribute);const r=Object(Pe.b)(this.props.jumpBarProps.selectedFilter,t);this.props.onSelectedOrderColumnChange(r,this.props.contextToken)}}_onParentPagePreNavigationEventFired(e){e&&Array.isArray(e)&&e.length>0&&!this._isPreNavigationEventAttached&&this.context&&this.context.Router&&this.context.Router.registerPreNavigationHandler&&(this._tracer&&this._tracer.info("Adding control preNavigation handlers to the router"),e.forEach(e=>this.context.Router.registerPreNavigationHandler(()=>{try{return e()}catch(e){const t=[{name:"subComponent",value:"onPreNavigation"}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentFailure&&this.context.EventManager.ReportComponentFailure(Vt,e,null,t)}return Promise.resolve(!0)})),this._isPreNavigationEventAttached=!0)}_createSwitchVisualization(e,t){return()=>{switch(this._keyIndex++,this.props.contextString){case f.h.ASSOCIATEDGRID:this.props.switchAssociatedGridVisualization(this.props.id,this.props.entityTypeName,this.props.controlId,this.props.viewId,e,this.props.nonCompositionProps&&this.props.nonCompositionProps.viewConfigurations,this.props.nonCompositionProps&&this.props.nonCompositionProps.gridConfigurations,"VIEW_CONFIG"===t);break;case f.h.SUBGRID:this.props.switchSubgridVisualization(this.props.id,e,this.props.controlId);break;case f.h.GRID:default:if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput){const e=[{filterType:3,filterExpressionOrValue:null}];this.props.updateGridPaginationStateHandler(e,this.props.id),this.props.setCustomFilter("",0,this.props.id,this.props.contextToken)}"VIEW_CONFIG"===t?this.props.switchViewConfiguration(this.props.id,this.props.contextToken,e,this.props.controlId,!1):this.props.switchHomepageConfiguration(this.props.id,this.props.contextToken,e,this.props.controlId,!0)}}}_updateChangeVisualizationButtons(e){let t=[];const r=this.props.nonCompositionProps&&this.props.nonCompositionProps.gridConfigurations,n=this.props.nonCompositionProps&&this.props.nonCompositionProps.viewConfigurations;let a=!1;this._parentSwitchVisualizationButton||(this._parentSwitchVisualizationButton={Icon:"SelectChart",DisplayText:Object(F.c)(this.props.resourceStrings,j.SWITCH_VISUALIZATION_BUTTON_LABEL),Id:this._changeVisualizationCommandBarId+"-Parent",WillOpenFlyout:!0,Children:null}),this._memoizedConfiguration===this.props.updatedConfiguration&&this._memoizedViewConfigurations===n&&this._memoizedResourceStrings===this.props.switchVisualizationResourceStrings||this.props.switchVisualizationResourceStrings&&(this._memoizedConfiguration=this.props.updatedConfiguration,this._memoizedViewConfigurations=n,this._memoizedResourceStrings=this.props.switchVisualizationResourceStrings,this._memoizedButtonList=[],t=Object(pt.c)(r,n,this.props.updatedConfiguration,this.props,this.props.contextString,e),t.forEach(t=>{if(Object(pt.a)(this.props.updatedConfiguration,t.configuration)||t.configuration.isDefaultConfig&&this.props.updatedConfiguration.isDefaultConfig||this.props.featureControlProps.isDisableEditableGridControlOnPhoneFeatureEnabled&&Object(ie.g)(t.configuration,parseInt(e,10)))return;const r={Icon:"SelectChart",DisplayText:""+Object(pt.b)(this.props.switchVisualizationResourceStrings,t.configuration),Id:`${this._changeVisualizationCommandBarId}-${t.configuration.Name}-${t.formFactor}`,execute:this._createSwitchVisualization(t.configuration,t.configurationType),IsInFlyout:!0};this._memoizedButtonList.push(r),a=!0})),!this._isSwitchVisualizationInitialized&&this.props.commandBarProps&&(Object(pt.d)(this.props.retrieveControlResourceStringsForSwitchVisualization,this.context,r,n,this.props.updatedConfiguration,this.props,this.props.contextString,e),this._isSwitchVisualizationInitialized=!0),this._parentSwitchVisualizationButton.Children=this._memoizedButtonList,a&&this._onAddedCommandListChange()}_onAddedCommandListChange(e=!0){var t,r,n,a;const i=[],s=[],o=(null===(r=null===(t=this._parentSwitchVisualizationButton)||void 0===t?void 0:t.Children)||void 0===r?void 0:r.length)>0;if(this.props.featureControlProps.isShowAsButtonFirstEnabled&&o&&s.push(this._parentSwitchVisualizationButton),s.push(...this._addedCommandListFromControl),s.push(...this._addedCommandListFromHost),(null===(a=null===(n=this.props.nonCompositionProps)||void 0===n?void 0:n.addedCommandListFromHostParent)||void 0===a?void 0:a.length)>0&&i.push(...this.props.nonCompositionProps.addedCommandListFromHostParent),!this.props.featureControlProps.isShowAsButtonFirstEnabled&&o&&i.push(this._parentSwitchVisualizationButton),!e)return{addedCommandList:s,appendedCommandList:i};this&&this.setState&&this.setState({addedCommandList:s,appendedCommandList:i})}_seeMoreCallback(e){this.setState({inSeeMoreState:!this.state.inSeeMoreState})}_seeMorePopup(e,t=!1){!0===e?(this._preSeeMoreCachedPagingString=this._currentPagingString,this._currentPagingString=null):(this._currentPagingString=this._preSeeMoreCachedPagingString,this._preSeeMoreCachedPagingString=null),this._keyIndex++,this._seeMoreHelper.seeMorePopup(this._getDataSetHostRootElement(),this._seeMoreCallback.bind(this),e,t,this.props.isRTL)}_getDataSetHostRootElement(){return a.findDOMNode(this)}_onRecordsSelectedCallback(e,t){this._logInfo("onRecordsSelected for DataSetHost. New selected rows are "+t);const r=[];for(const e of t)r.push(new v.a(e));if(this.props.markSelectedRows(this.props.id,this.props.contextToken,r),e){const e=this.props.updatedConfiguration.Parameters[this.props.nestedGridDatasetName];this.props.markSelectedRelatedEntity(this.props.id,this.props.contextToken,e.TargetEntityType)}else this.props.markSelectedRelatedEntity(this.props.id,this.props.contextToken,null);this.props.isGridEditable&&t.length>0&&this.props.rowProperties(this.props.id,this.props.contextToken,r),this.props.isGridEditable&&(this._logInfo("Running onRecordSelect for EditableGrid"),this.props.runOnRecordSelect(this.props.id,this.props.contextToken,r)),!e&&this._onRecordsSelectedParent&&(this._logInfo("onRecordsSelected: Calling onRecordsSelected callback for the parent control"),this._onRecordsSelectedParent(t))}markGridFirstRequestComplete(){this._isFirstRequestComplete=!0}_isDataSetHostKnownError(e){return!(!e||""===e)&&(-1!==e.indexOf(vt.a.getHexErrorCodeFromInt(2415919120))||!(-1===e.indexOf(vt.a.getHexErrorCodeFromInt(-2147093999))||this.props.offlineProps.isEntityAvailableForOffline&&this.props.offlineProps.isOfflineAvailableForUse))}_onDataSetUpdateCallback(e){this._logInfo("DataSetUpdated for DataSetHost control");const t=[{name:"currentPagingString",value:e&&e.existedPagingString||""}];this.markGridFirstRequestComplete(),this._currentPagingString!==e.existedPagingString&&t.push({name:"previousPagingString",value:this._currentPagingString});let r=!1;e.error?(r=this._isDataSetHostKnownError(e.errorMessage)||!Object(kt.b)(e.innerError),e.innerError&&t.push({name:"InnerErrorMessage",value:e.innerError}),this.context.EventManager.ReportComponentFailure(Vt,new Error(e.errorMessage||""),null,t)):this.context.EventManager.ReportComponentSuccess(Vt,t);let n={};if(r)n={compositeControlInitState:N.a.Error,controlLoadErrorMessage:e.errorMessage},e.innerError&&(n.controlLoadInnerErrorMessage=e.innerError);else{this.props.updateFetchXml(this.props.id,this.props.contextToken,e.fetchXmlInUse);let t=null;if(e.existedFilteringString){const r=JSON.parse(e.existedFilteringString);t=Object(p.j)(r,Ue.CrmXmlEncode),this.props.setCustomFilter(t,0,this.props.id,this.props.contextToken)}if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled){const t=[];let r=!1,n=null;e.existedValidSortingArrayString&&(n=e.existedValidSortingArrayString);const a=!Object(rt.a)(n)&&JSON.parse(n);if(a&&a instanceof Array&&a.length>0&&n!==this.props.gridSortingInfo&&(this.props.gridInput&&t.push({filterType:7,filterExpressionOrValue:n}),r=!0),r){if(e.existedPagingString){const t=JSON.parse(e.existedPagingString);t.firstPageNumber&&(this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,t.firstPageNumber),this.props.gridInput&&this._setResetPagingInfoForEnhancedPaging())}this.props.gridInput&&this.props.updateGridPaginationStateHandler(t,this.props.id)}}this.props.updateQueryKey(e.newQueryKey,this.props.id,this.props.contextToken),this.props.updatePagingData(this.props.id,this.props.contextToken,e.existedPagingString),this.props.setNewPageRequested(this.props.id,this.props.contextToken,!1),this._logInfo("onDataSetUpdate: eventPagingString: "+e.existedPagingString),this._currentPagingString=e.existedPagingString}2!==this.state.loadingState?this._updateDataSetLoadingState(2,n):this.setState(n),this._accessibilityId++}_configureDataSetControlParams(){if(!this.props.updatedConfiguration)return;const e=this.props.updatedConfiguration.Parameters[this.props.primaryDataSetName];if(e){!Object(rt.a)(e.onRecordsSelected)&&Object(rt.a)(this._onRecordsSelectedParent)&&e.onRecordsSelected!==this._boundOnRecordsSelected&&(this._onRecordsSelectedParent=e.onRecordsSelected),this._isFirstRequestComplete&&(e.FirstDataRequestType=0),Object(rt.a)(this._boundOnRecordsSelected)&&(this._boundOnRecordsSelected=this._onRecordsSelectedCallback.bind(this,!1)),e.onRecordsSelected=this._boundOnRecordsSelected,e.onDataSetUpdate=this._onDataSetUpdateCallback.bind(this);const t=this.props.descriptor;let r=1,n=this.state.pagingInfo.lastPageNumber;this.props.isGridEditable||this._isNativePlatform?this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this._isNativePlatform&&(r=this.state.pagingInfo.firstPageNumber):(r=this.props.pageNumber,n=this.props.pageNumber);const a={firstPageNumber:r,lastPageNumber:n,pageSize:!this._isInSeeMoreState()&&t&&t.Parameters&&t.Parameters[f.q]&&parseInt(t.Parameters[f.q],10)||this.props.recordsPerPageSetting,pagingRefreshInput:this.props.pagingRefreshInput?this.props.pagingRefreshInput.toString():""},i=Object(Be.a)(this._currentPagingString);if(i&&i.pageSize&&(this._logInfo("Updating pageSize based on _receivedPagingStringData.pageSize to "+i.pageSize),a.pageSize=i.pageSize),e.PagingInput={Static:!0,Value:JSON.stringify(a)},this.props.refreshCounter){const t=this.props.refreshCounter.toString();if(e.RefreshInput={Value:parseInt(t,10),Static:!0},!Object(rt.a)(this.props.customFilter)&&!Object(rt.a)(this.props.customFilter.customFilterXml)&&this.props.customFilter.source&&1===this.props.customFilter.source){const t=Object(p.i)(this.props.customFilter.customFilterXml);e.FilteringInput={Static:!0,Value:JSON.stringify(t)}}}if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput){if(!Object(rt.a)(this.props.customFilter)&&!Object(rt.a)(this.props.customFilter.customFilterXml)){const t=Object(p.i)(this.props.customFilter.customFilterXml);e.FilteringInput={Static:!0,Value:JSON.stringify(t)}}const t=!Object(rt.a)(this.props.gridSortingInfo)&&JSON.parse(this.props.gridSortingInfo),r=t&&t instanceof Array&&t.length>0,n=!Object(rt.a)(this._previousSortingInfo)&&JSON.parse(this._previousSortingInfo),a=n&&n instanceof Array&&n.length>0;(r||a&&this.props.gridSortingInfo!==this._previousSortingInfo)&&(this._previousSortingInfo=this.props.gridSortingInfo,e.SortingInput={Static:!0,Value:this.props.gridSortingInfo})}this.props.gridEntityTypeName&&(e.EntityName=this.props.gridEntityTypeName)}this._addExtraParametersToConfiguration();const t=this.props.updatedConfiguration.Parameters[this.props.nestedGridDatasetName];if(t&&(t.onRecordsSelected=this._onRecordsSelectedCallback.bind(this,!0),this.props.refreshCounter)){const e=this.props.refreshCounter.toString();t.RefreshInput={Value:parseInt(e,10),Static:!0}}}_addExtraParametersToConfiguration(){if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&(this.props.updatedConfiguration.Parameters.NativeFilterExpressionToRestore={Usage:1,Static:!0,Value:this.props.nativeFilterExpression},!Object(rt.a)(this._pageNumberToRestoreForEnhancedPaging))){let e=this._pageNumberToRestoreForEnhancedPaging;this._pageNumberToRestoreForEnhancedPaging>1&&(this._shouldResetPagingForEnhancedPaging||!this._resetProcessedForEnhancedPaging)&&(this._shouldResetPagingForEnhancedPaging=!1,this._resetProcessedForEnhancedPaging=!1,e=-1),this.props.updatedConfiguration.Parameters.PageNumberToRestore={Usage:1,Static:!0,Value:e}}this.props.lookupAttributeForRecordHierarchy&&this.props.gridInput&&(this.props.updatedConfiguration.Parameters.LookupAttributeNameForHierarchy={Usage:1,Static:!0,Value:this.props.lookupAttributeForRecordHierarchy})}_renderAccessibilityNotification(e){var t;const r=e+"_accessibility",a={left:"-3000%",width:"0%",height:"0%",position:"absolute"};this.props.featureControlProps.isAssociatedGridHeightEnabled&&(a.overflow="hidden");const i=Object(F.c)(this.props.resourceStrings,j.GRID_LOADING_PLACEHOLDER).replace("{0}",this.props.entityDisplayName),s=2===this.state.loadingState?null!==(t=this.props.notificationMessage)&&void 0!==t?t:"":i;return n.createElement(o.a,{key:`${r}_${this._accessibilityId}`,id:r,style:a,role:Ee.s,notificationType:Ve.b},s)}_renderQuickFind(){const e=this._showNewQuickFindSearchBarForMobile();if(this.props.quickFindProps&&this._isWidthInitialized()){if(this._isWidthLessThanViewportSm()&&(this.state.quickFindVisibility||e)){const t=Object.assign(this.props.quickFindProps,{focusSearchBoxAfterRender:!0});return n.createElement(o.a,{key:"quickFind",style:this.props.styles.quickFindMobileStyle},n.createElement(Je,Object.assign({},t,{updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,resetPagingInfoForEnhancedPaging:this._resetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),ref:this._dataSetQuickFindRef,showNewQuickFindSearchBarForMobile:e})))}if(!this._isWidthLessThanViewportSm())return Object(Ce.g)(this.props.contextString)?n.createElement(o.a,{style:this.props.styles.quickFindContainerStyle},this._getQuickFind()):this._getQuickFind()}return null}_renderAdvancedFilter(){return this._isWidthInitialized()&&this.props.showAdvancedFilter&&this.props.quickFindProps&&n.createElement(_e.a,{key:"openAdvancedFilter",id:"open-advanced-filter",iconType:"filter",title:Object(F.c)(this.props.resourceStrings,wt.c.OpenAdvancedFiltersTitleAndAria),style:this.props.styles.advancedFilterButtonStyles,onClick:()=>{this._renderAdvancedFindPanel()},tabIndex:0,accessibilityLabel:Object(F.c)(this.props.resourceStrings,wt.c.OpenAdvancedFiltersTitleAndAria)},n.createElement(K.b,{id:"filter",accessibilityHidden:!0,type:d.a.Filter}))}_renderAdvancedFindPanel(){var e;this._updateDataSetLoadingState(1);const t=[{name:"entityName",value:this.props.entityTypeName},{name:"ViewId",value:null===(e=this.props.viewId)||void 0===e?void 0:e.guid}];this.props.retrieveRelatedEntitiesMetadata(this.props.entityTypeName).then(()=>{this.setState({isFilterPanelOpen:!0}),this._updateDataSetLoadingState(2),this.context.EventManager.ReportComponentSuccess(Gt,t)},e=>{this._tracer.error(null==e?void 0:e.message),this._updateDataSetLoadingState(2),this.context.EventManager.ReportComponentFailure(Gt,new Error(e),t)})}_renderDiscardChanges(){if(this.props.showAdvancedFilter&&this.props.isViewEdited&&this._isWidthInitialized()&&!this.props.showColumnEditor)return n.createElement(_e.a,{key:"clearAdvancedFilter",id:"clear-advanced-filter",iconType:"clearFilter",title:Object(F.c)(this.props.resourceStrings,j.AdvancedFind_DiscardButton_Title),style:this.props.styles.advancedFilterButtonStyles,onClick:()=>{var e;this.props.removeEditedViewPageMap(this.props.gridInput.pageToEditedViewMapId.guid,this.props.viewId),this._clearCustomFilterAndUpdateControlKeyIndex();const t=[{name:"entityName",value:this.props.entityTypeName},{name:"ViewId",value:null===(e=this.props.viewId)||void 0===e?void 0:e.guid}];this.context.EventManager.ReportComponentSuccess(Ut,t)},tabIndex:0,accessibilityLabel:Object(F.c)(this.props.resourceStrings,j.AdvancedFilter_DiscardButton_AccessibilityLabel)},n.createElement(K.b,{id:"clearFilter",type:d.a.GlobalFilterClearAll}))}_renderColumnEditor(){if(this.props.showColumnEditor&&this._isWidthInitialized()){const e=Object(F.c)(this.props.resourceStrings,j.ColumnEditorButton);return n.createElement(Bt.a,{key:"columnEditorBtn",id:"columnEditor-btn",iconProps:{iconName:"ColumnOptions",style:{color:"black"}},title:e,"aria-label":e,onClick:()=>this.setState({columnEditorPanelOpen:!0}),style:this.props.styles.columnEditorButtonStyle})}}_clearCustomFilterAndUpdateControlKeyIndex(){this.props.setCustomFilter("",0,this.props.id,this.props.contextToken).then(()=>{this._keyIndex++,this._onViewChanged(this.props.viewId.guid,this.props.entityTypeName,!1)})}_getQuickFind(){return n.createElement(o.a,{key:"quickFind",style:this.props.styles.quickFindStyle},n.createElement(Je,Object.assign({},this.props.quickFindProps,{updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,resetPagingInfoForEnhancedPaging:this._resetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),ref:this._dataSetQuickFindRef})))}_renderViewSelector(){if(this.props.viewSelectorProps&&this._isWidthInitialized()){const e=this._isWidthLessThanViewportSm()?this.props.styles.viewSelectorOuterMobileStyle:this.props.styles.viewSelectorOuterStyle;return n.createElement(o.a,{key:"viewSelector",style:e},n.createElement(W,Object.assign({isGridRoot:Object(Ce.e)(this.props.contextString)},this.props.viewSelectorProps,{isTablet:this._isWidthLessThanViewportM(),isPhone:this._isWidthLessThanViewportSm(),key:"dataSetHostView",onChange:this._onViewChanged,onItemIconPointerDown:this._onItemIconPointerDown,rootZIndex:this._isInSeeMoreState(),isRTL:this.props.isRTL,removeEditedViewPageMap:this.props.removeEditedViewPageMap})))}return this._renderTitle()}_renderQueueFilter(){if((this.props.entityTypeName===jt.Bb||this.props.entityTypeName===Pt.a)&&this.props.queueFilterProps&&this._isWidthInitialized()){const e=this._isWidthLessThanViewportSm()?this.props.styles.filterContainerMobileStyle:this.props.styles.filterContainerStyle;return n.createElement(oe,Object.assign({},this.props.queueFilterProps,{key:"queueFilter",onFilterChange:this._onFilterChange,updateFilterValue:this._updateFilterValue,resourceStrings:this.props.resourceStrings,style:e,isGridPaginationStateFeatureEnabled:this.props.featureControlProps.isGridPaginationStateFeatureEnabled}))}return null}_renderEntityFilter(){if(this.props.entityFilterProps&&this._isWidthInitialized()){const e=this._isWidthLessThanViewportSm(),t=e?this.props.styles.filterContainerMobileStyle:this.props.styles.filterContainerStyle,r=this.props.styles.activityTypeFilterContainerStyle;return n.createElement(ge,Object.assign({},this.props.entityFilterProps,{onToggleChange:this._onRollupViewToggleChanged,key:"EntityFilterDataSet",onFilterChange:this._onFilterChange,onActivityTypeChange:this._onActivityTypeMenuDismissed,onActivityTypeFilterClear:this._clearActivityTypeFilter,gridEntityName:this.props.gridEntityTypeName,resourceStrings:this.props.resourceStrings,containerStyle:t,activityTypeContainerStyle:r,rootZIndex:this._isInSeeMoreState(),isGridPaginationStateFeatureEnabled:this.props.featureControlProps.isGridPaginationStateFeatureEnabled,isMobile:e}))}return null}_renderDataSetChart(){return this.props.chartProps&&this._isWidthInitialized()?(this.props.chartProps.isLayoutVertical=this._isReflowLayoutVertical,n.createElement(_,Object.assign({},this.props.chartProps,{style:this._isReflowLayoutVertical?this._isWidthLessThanViewportSm()?this.props.styles.reflowChartMobileStyle:this.props.styles.reflowChartStyle:this.props.styles.chartStyle,key:"pageChartDataSet",closeChartPaneHandler:this.props.toggleChartPane}))):null}_renderBackButtonForGridInMobile(){return this.props.commandBarProps&&this._isWidthInitialized()&&Object(Ce.e)(this.props.contextString)&&this._isWidthLessThanViewportSm()&&this.props.backButtonEnabled?n.createElement(Z.a,{pageId:this.props.id,overwriteStyle:{borderWidth:0,height:"auto",padding:0,margin:"-8px 0"}}):null}_renderCommandBar(){if(!this.props.commandBarProps||!this._isWidthInitialized())return null;this._commandBarLoadedPromise||(this._commandBarLoadedPromise=new Promise(e=>{this._commandBarLoadedResolve=e})),this._commandManagerId=this._commandManagerId||this.props.commandBarProps.commandManagerId||Object(me.a)();let e=this.props.styles.commandManagerContainerStyle,t=this.props.styles.commandBarStyle;this._isWidthLessThanViewportSm()&&(e=this.props.styles.commandManagerContainerMobileStyle,t=this.props.styles.commandBarMobileInnerStyle);const r=Object(Ce.e)(this.props.contextString);return Object(Q.b)(this.props.commandBarRefreshProps,t,this._isWidthLessThanViewportSm(),e),n.createElement(ne,Object.assign({},this.props.commandBarProps,{key:"commandBarDataSet",addedCommandList:this.state.addedCommandList,appendedCommandList:this.state.appendedCommandList,metaDataLoadedResolve:this._commandBarLoadedResolve,commandManagerId:this._commandManagerId,style:e,commandbarStyles:t,rootZIndex:this._isInSeeMoreState(),customControlType:this.props.updatedConfiguration.CustomControlId,isGridRoot:r,collapsed:this._isWidthLessThanViewportSm(),isNativeMode:this._isNativeSubgrid()}))}_renderFooter(){let e=!1;if(this.props.totalResultCount<=this.props.pageSize&&!this.props.totalRecordCountLimitExceeded&&Object(Ce.g)(this.props.contextString)&&!this._isInSeeMoreState()&&!this.props.jumpBarProps&&(e=this._shouldRenderSeeMoreButton(),!e))return this._logInfo("Hiding the footer for the subgrid because there is less than 2 pages of data"),null;if(this._isWidthInitialized()&&(this.props.jumpBarProps||this.props.pagingProps)){const t=this._isJumpBarRenderingAsFlyout()?this.props.styles.footerMobileStyle:this.props.isGridEditable?this.props.styles.footerEditableGridStyle:Object.assign(Object.assign({},this.props.styles.footerOuterStyle),this.props.jumpBarProps?this.props.styles.defaultFooterHeightStyle:this.props.styles.jumpBarLessFooterHeightStyle);if(!this.props.isGridEditable)return this._hideJumpbarForMobile()?null:n.createElement(o.a,{key:"dataSetFooter_"+this.props.id,style:t},!e&&this._renderJumpBar(),n.createElement(o.a,{key:"dataSetPagingContainer_"+this.props.id,style:this.props.styles.footerPagingContainer},this._renderPaging(e),this._renderSeeMoreButton()));if(this.props.jumpBarProps)return n.createElement(o.a,{key:"dataSetFooter_"+this.props.id,style:t},this._renderJumpBar());this._logInfo("Hiding the footer for the editable grid because the jump bar props is null")}return this._logInfo("Hiding the footer for the grid because the width for the controld is 0 or the jump bar props is null or paging props is null"),null}_jumpBarShouldRenderAsFlyout(e){const t=Object(F.c)(this.props.resourceStrings,j.JUMPBAR_ALPHABET);if(t){const r=t.split(","),n=e-100,a=this._isJumpBarRenderingAsFlyout()?.5:-.5;return!!r&&n/r.length<=32+a}return!1}_renderJumpBar(){let e=null;return this._isJumpBarRenderingAsFlyout()&&(e=this.props.styles.jumpBarButtonContainerStyle),this.props.jumpBarProps?n.createElement(o.a,{key:"jumpBar_"+this.props.id,style:e},n.createElement(De,Object.assign({},this.props.jumpBarProps,{rootZIndex:this._isInSeeMoreState(),controlKey:this.props.controlKey,renderMobile:this._isJumpBarRenderingAsFlyout(),isDeviceSizeSmall:!this._isWidthGreaterThan480(),isRTL:this.props.isRTL,isGridRoot:Object(Ce.e)(this.props.contextString),updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,setResetPagingInfoForEnhancedPaging:this._setResetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),isMobile:this._isWidthLessThanViewportM()}))):null}_renderPaging(e){const t=Object(Ce.f)(this.props),r=!this.props.hasCustomDataProvider&&Object(rt.a)(this.props.totalRecordCountLimitExceeded);return t&&this._logInfo("Hiding the paging button for the grid because the sharepoint grid does not support paging"),this.props.pagingProps?n.createElement(ze,Object.assign({},this.props.pagingProps,{pagingInfo:this.state.pagingInfo,shouldPagingTextRender:!e,incrementLastPage:this._incrementLastPage,setFirstPage:this._setFirstPage,enhancedPagingDisabled:!e&&!t&&!this._isNativePlatform,pagingTextDisabled:r,gridTotalRecordsCountLimit:this.props.gridTotalRecordsCountLimit,isGridRoot:Object(Ce.e)(this.props.contextString),updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),isServerOffline:this.props.isOffline})):null}renderDataSetHostComponent(e,t,r,a,i){var s,l,u;let p=[];const m=this._isWidthLessThanViewportSm();this._isReflowLayoutVertical=!(!this._isWidthLessThanMinWidthForChartPlusGridReflow()||!this.props.chartProps);try{const b=this._getDataSetHostErrorMessage();if(Object(rt.a)(b)||this.state.compositeControlInitState===N.a.Initializing){if(this._isWidthInitialized()||Object(Ce.g)(this.props.contextString)&&this.state.compositeControlInitState!==N.a.Initializing){this._isShowChartChanged&&(this._getUpdateAddedCommandList(this._showCommandBarButtonSearch(),this._showCommandBarButtonShowChart()),this._onAddedCommandListChange(),this._isShowChartChanged=!1);const t=(Object(Ce.e)(this.props.contextString)||Object(Ce.d)(this.props.contextString))&&this.props.entityIsActivityType;m||Object(Ce.g)(this.props.contextString)?(this.props.viewSelectorProps||this.props.quickFindProps||this.props.entityFilterProps||this.props.queueFilterProps||this.props.commandBarProps)&&(this.props.featureControlProps.isInMobileModeForOct2019&&Object(Ce.e)(this.props.contextString)&&(i=Object.assign(Object.assign({},i),{display:"none"})),p.push(n.createElement(o.a,{key:"dataSetHeader_"+this.props.id,style:r},this._renderHeader([this._renderBackButtonForGridInMobile(),this._renderViewSelector(),this._renderCommandBar()],i),this._renderQuickFind(),t||this.props.entityFilterProps&&this.props.entityFilterProps.isRollupViewSupported&&this.props.contextString===f.h.ASSOCIATEDGRID?this._renderEntityFilter():this._renderQueueFilter()))):(p.push(this._renderCommandBar()),(this.props.viewSelectorProps||this.props.quickFindProps||this.props.entityFilterProps||this.props.queueFilterProps)&&p.push(n.createElement(o.a,{key:"dataSetHeader_"+this.props.id,style:r},this._renderHeader([this._renderViewSelector(),this._renderDiscardChanges(),this._renderColumnEditor(),this._renderAdvancedFilter(),this._renderQuickFind()],i),t||this.props.entityFilterProps&&this.props.entityFilterProps.isRollupViewSupported&&this.props.contextString===f.h.ASSOCIATEDGRID?this._renderEntityFilter():this._renderQueueFilter())));let c=this.props.chartProps&&this._isReflowLayoutVertical?this.props.styles.reflowdataSetContentBodyStyle:this.props.styles.dataSetContentBodyStyle;this.props.featureControlProps.isAssociatedGridHeightEnabled&&Object(Ce.d)(this.props.contextString)&&(c=Object.assign(Object.assign({},c),{flexBasis:"0px"}));if(this.props.chartProps&&!this._isReflowLayoutVertical&&this.props.featureControlProps.isSuiterChartEnabled||this._showNewQuickFindSearchBarForMobile()){const e="1px solid #d8d8d8";c=Object.assign(Object.assign({},c),{borderTop:e})}const d=(null===(u=null===(l=null===(s=this.props)||void 0===s?void 0:s.configuration)||void 0===l?void 0:l.Parameters)||void 0===u?void 0:u.EnableSubGridAutoCollapse)&&this.props.configuration.Parameters.EnableSubGridAutoCollapse,b=d&&d.Value,y=this.props.featureControlProps.isSubGridAutoCollapseEnabled&&Object(Ce.g)(this.props.contextString)&&"true"===b;y&&0===this.props.totalResultCount&&(c=Object.assign(Object.assign({},c),{display:"none"})),this.props.featureControlProps.isSubGridRemoveMinHeightEnabled&&y&&(c=Object.assign(Object.assign({},c),{minHeight:"0px"}));const _=m&&Object(Ce.e)(this.props.contextString),v=this._parentDefinedProps;this.props.parentDefinedControlProps&&(v.height=this.props.parentDefinedControlProps.height>0&&this._seeMoreHelper.getSeeMorePopupStatus()===g.b.NotInUse?this.props.parentDefinedControlProps.height:void 0,v.width=this.props.parentDefinedControlProps.width>0&&this._seeMoreHelper.getSeeMorePopupStatus()===g.b.NotInUse?this.props.parentDefinedControlProps.width:void 0,v.decorators=this.props.parentDefinedControlProps.decorators,v.propertyBagOverrides=this.props.parentDefinedControlProps.propertyBagOverrides),v.parentInSeeMoreMode=this._seeMoreHelper.getSeeMorePopupStatus()!==g.b.NotInUse,v.containerStyleOverrides=this._getCombinedContainerStyleOverrides();const S="data-set-body-container";let O=null;this.props.chartProps&&this._isWidthInitialized()&&(O={width:"70%"});const I=Ae.a.getInstance().get_IsBrowserIE()?Object.assign(a,{flex:"1 1 100%"}):a;p.push(n.createElement(o.a,{key:"dataSetContentBody_"+this.props.id,style:c},this._renderDataSetChart(),n.createElement(o.a,{key:"dataSetBody_"+this.props.id,style:!0===this._isReflowLayoutVertical?this.props.styles.reflowGridStyle:Object.assign(I,O),className:this._isInSeeMoreState()?"seeMore":void 0,testhooks:{id:S}},n.createElement(h.c,{key:this.props.controlKey+this._keyIndex,controlId:this.props.controlId,id:this.props.id,formInfo:this._savedFormInfo,configuration:this.props.updatedConfiguration,descriptor:this.props.descriptor?this.props.descriptor:this._savedDefault,systemDefinedProperties:this.props.systemDefinedProperties,rowSpan:this.props.rowSpan,parentDefinedControlProps:v,parentContextToken:this.props.contextToken,contextString:this.props.contextString,externalCommandManagerId:this._commandManagerId,externalCommandPromise:this._commandBarLoadedPromise,shouldRender:this.props.nonCompositionProps?this.props.nonCompositionProps.shouldRender:void 0}),_?null:this._renderFooter()))),_&&p.push(this._renderFooter()),p.push(this._renderAccessibilityNotification(e)),p=p.concat(this._renderAccessibilityComponent(e))}}else if(2!==this.state.loadingState&&this._updateDataSetLoadingState(2),p.push(n.createElement(o.a,{key:"dataSetHeader_"+this.props.id,style:r},this._renderHeader([this._renderViewSelector()],i))),this._isWidthInitialized()){const e={fontSize:this._isHeightGreaterThan240()&&this._isWidthGreaterThan480()?"4.5em":"2em",color:"red"},t={display:"flex",justifyContent:"center"},r=Object(F.c)(this.props.resourceStrings,j.SEE_MORE_DETAILS);p.push(n.createElement(o.a,null,n.createElement(c.a,{id:"gridErrorContainer"+this.props.id,text:b,icon:d.a.DetailsPageClose,iconStyle:e}),this.state.controlLoadInnerErrorMessage&&!this._isDataSetHostKnownError(this.state.controlLoadErrorMessage)&&n.createElement(o.a,{style:t},n.createElement(ye.a,{key:"gridInnerErrorMessage",href:"#",accessibilityLabel:r,onClick:()=>{this.props.showInnerError(this.state.controlLoadInnerErrorMessage)}},r))))}const y=Object.assign(Object.assign({},t),this.state.controlLoadInnerErrorMessage&&{backgroundColor:"#FFFFFF"});return n.createElement(o.a,{style:y,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0,id:e,key:e,testhooks:{id:e,[St.b]:this.props.previewId,[St.c]:20},semanticTag:this.props.semanticTag},p)}catch(e){this._onControlLoadedError(e)}}_getDataSetHostErrorMessage(){var e;let t=null;if(this.props.hasReadRolePrivilege)if(this.props.isUCIEntity||this.props.hasCustomDataProvider)if(this.props.offlineProps.isOfflineSqlQueryAvailable)t=this.props.isOffline&&this.state.controlLoadErrorMessage&&!this.props.hasCustomDataProvider?this.props.offlineProps.isEntityAvailableForOffline?this.props.offlineProps.isOfflineAvailableForUse?this.state.controlLoadErrorMessage:Object(F.c)(this.props.resourceStrings,j.OFFLINE_NOT_READY_FOR_USE):Object(F.c)(this.props.resourceStrings,j.ENTITY_NOT_AVAILABLE_IN_PROFILE):this.state.controlLoadErrorMessage;else{let e="";this.props.offlineProps.offlineErrorMessageKey&&(e=Object(F.c)(this.props.resourceStrings,this.props.offlineProps.offlineErrorMessageKey)),e||(e=Object(F.c)(this.props.resourceStrings,j.VIEW_NOTAVAILABLE_IN_OFFLINE)),t=e}else{const e=this.props.entityDisplayName?this.props.entityDisplayName:this.props.entityTypeName,r=Object(F.c)(this.props.resourceStrings,j.UCI_DISABLED_ENTITY_ERROR);t=String.format(r,e)}else t=Object(F.c)(this.props.resourceStrings,j.READ_PRIVILEGE_VIOLATION_KEY);return Object(rt.a)(t)||null===(e=this._tracer)||void 0===e||e.error(`${Vt}._getDataSetHostErrorMessage : ${t}`,this.props.isOffline&&this.props.offlineProps.offlineGridErrorTelemetryParams),t}_renderHeader(e=[],t){const r=(e||[]).filter(e=>!!e);return r.length?n.createElement(o.a,{key:"dataSetHeaderInner_"+this.props.id,style:t},r):null}_getParentDefinedPropsDecoratorValue(e){return this.props.parentDefinedControlProps&&this.props.parentDefinedControlProps.decorators&&this.props.parentDefinedControlProps.decorators[e]}_shouldRenderSeeMoreButton(){return this._getParentDefinedPropsDecoratorValue("ShowSeeMore")&&!!this.props.totalResultCount}_renderSeeMoreButton(){const e=Object(Ce.g)(this.props.contextString),t=Object(Ce.d)(this.props.contextString),r=this._seeMoreHelper.getSeeMorePopupStatus(),a=Object(Ce.f)(this.props);return!((e||t)&&!a)||r===g.b.PopFadeIn||r===g.b.PoppedOut||r===g.b.ReturnFadeOutAndMove||this.props.totalResultCount>=0&&this.props.totalResultCount<=this.props.pageSize&&!this._shouldRenderSeeMoreButton()||!this._isNativePlatform?(this._logInfo("Hiding the See more button for the grid because the grid does not support see more or there is less than 2 pages of data"),null):n.createElement(Ze,{onSeeMoreClick:this._seeMorePopup.bind(this,!0,!1),resourceStrings:this.props.resourceStrings,containerStyle:this.props.styles.seeMoreButtonContainerStyle,buttonStyle:this.props.styles.seeMoreButtonStyle,seeMoreTextStyle:this.props.styles.seeMoreButtonTextStyle,localizedStrings:this._getSeeMoreLocalizedStrings()})}_getSeeMoreLocalizedStrings(){let e=null;return this.props.viewSelectorProps&&this.props.viewSelectorProps.title?e=this.props.viewSelectorProps.title:this.props.descriptor.ShowLabel&&this.props.descriptor.Label?e=this.props.descriptor.Label:this.props.entityDisplayName&&(e=this.props.entityDisplayName),this._isNativeSubgrid()?{uniqueLabel:e,seeMoreLabel:Object(F.c)(this.props.resourceStrings,j.SEE_ALL_LABEL),seeMoreTooltip:Object(F.c)(this.props.resourceStrings,j.SEE_ALL_TOOL_TIP)}:{uniqueLabel:e}}_isStreamOnSuiterDashboard(){return this.props.featureControlProps.isSuiterDashboardEnabled&&Object(Ce.g)(this.props.contextString)&&this.props.configuration&&this.props.configuration.Parameters&&this.props.configuration.Parameters.UseDefaultCardFormForList&&this.props.configuration.Parameters.UseDefaultCardFormForList.Value}_renderProgressIndicator(){let e="datasethost-progress-indicator";this.props.descriptor&&(e+="-"+this.props.descriptor.Id);const t=Object.assign({},this.props.styles.dataSetChangingProgressIndicatorContainerStyle);let r=this.props.styles.progressIndicatorContainerStyle;return 1===this.state.loadingState?(t.width=this._width,t.height=Math.max(this._height,100)):0===this.state.loadingState&&this._isStreamOnSuiterDashboard()&&(r=Object.assign(Object.assign({},r),{borderBottom:"none"})),n.createElement(o.a,{key:"progressIndicatorContainer",id:"progressIndicatorContainer",style:0===this.state.loadingState?r:t},n.createElement(o.a,{key:"progressIndicator",id:"progressIndicator",style:0===this.state.loadingState?this.props.styles.progressIndicatorStyle:this.props.styles.dataSetChangingProgressIndicatorStyle},n.createElement(u.a,{key:e,id:e,testhooks:{id:e},style:this.props.styles.datasethostProgressIndicatorStyle,progressType:"ring",displayDelay:0===this.state.loadingState&&2e3,active:!0})))}componentWillUnmount(){this._seeMoreHelper&&this._seeMoreHelper.destroy(),clearTimeout(this._statusTimeout),this._statusTimeout=null}get _tracer(){return this.context?this.context.TraceManager.getTracer(f.z):null}_updateStatus(e){this.state.statusMessage===e||this._isSubGridFirstLoad||(clearTimeout(this._statusTimeout),this._statusTimeout=setTimeout(()=>this.setState({statusMessage:e}),1e3))}render(){var e,t,r,a,i;if(Object(rt.a)(this.props.updatedConfiguration))return this._logInfo("DataSetHost not rendered. Configuration is null"),null;if(!this.props.isInitialized&&this.props.contextToken&&this.props.primaryDataSetName&&this.state.compositeControlInitState!==N.a.Error){const e=this.props.updatedConfiguration.Parameters[this.props.primaryDataSetName];if(!e)return this._logInfo("DataSetHost not rendered. DataSet is not initialized and configuration does not contain primary dataset name."),null;if(this.state.compositeControlInitState===N.a.Uninitialized){this.setState({compositeControlInitState:N.a.Initializing});const t=this.props.viewId?this.props.viewId:e.ViewId?v.a.parse(e.ViewId):null,r=this.props.gridEntityTypeName||e.TargetEntityType||e.EntityName;if(!r&&!this.props.hasCustomDataProvider)return this._tracer&&this._tracer.error("DataSetHost not rendered. Reason: entityName unknown"),null;this.props&&this.props.hasCustomDataProvider&&this._logInfo("render: Initializing DataSetHost, id "+this.props.controlId+", for custom data provider"),this._logInfo(`Initializing grid for ${t} view and ${r} entity.`),this.props.initializeGrid(t,r,this.props.commandBarProps&&this.props.commandBarProps.commandManagerId,this.props.contextToken).then(()=>{this._logInfo(`Initialized grid for ${t} view and ${r} entity.`),this.setState({compositeControlInitState:N.a.Initialized})},e=>{const t=e instanceof Error?e.message:e;-1!==et.c.indexOf(t)?this._setControlLoadError(t):this._tracer&&this._tracer.error("Grid initialization failed. Reason: "+t),this.setState({compositeControlInitState:N.a.Error})})}return this._logInfo("DataSetHost not rendered. Either state is not initialized or resource strings are not initialized"),null}if(this.props&&this.props.nonCompositionProps&&this.props.nonCompositionProps.addedCommandListFromHostParent&&this._addedCommandListFromHostParent!==this.props.nonCompositionProps.addedCommandListFromHostParent&&(this._addedCommandListFromHostParent=this.props.nonCompositionProps.addedCommandListFromHostParent,this._onAddedCommandListChange()),this.props.descriptor&&this.props.descriptor.Parameters){const e=this.props.descriptor.Parameters[f.c];if(this._isWidthLessThanViewportSm()&&e&&"false"===e)return this._logInfo("DataSetHost not rendered. Available on phone is set to false"),null}this._configureDataSetControlParams(),this._updateViewSelectorProps(this.props),!this.props.viewId||!(null===(e=this.props.nonCompositionProps)||void 0===e?void 0:e.setPageInputViewId)||this.props.viewId.guid===(null===(r=null===(t=this.props.gridInput)||void 0===t?void 0:t.viewId)||void 0===r?void 0:r.guid)&&(null===(a=this.props.gridInput)||void 0===a?void 0:a.viewType)||this.props.savedQueryType===I.a.QUICKFIND_SEARCH||this.props.nonCompositionProps.setPageInputViewId(this.props.viewId.guid),this._savedDefault&&this.props.controlId===this._savedDefault.Id||(this._savedDefault={Id:this.props.controlId,HasContext:!0,Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1}),this.props.formInfo&&(this._savedFormInfo=this.props.formInfo,null!=this.props.ribbonId&&(this._savedFormInfo.RibbonId=this.props.ribbonId));const s=this.props.descriptor&&this.props.descriptor.DomId&&this.props.descriptor.Id?this.props.descriptor.DomId.includes(this.props.descriptor.Id)?this.props.descriptor.DomId:this.props.descriptor.Id:this.props.id,c="dataSetRoot_"+s,{containerStyle:u,headerStyle:d}=this.props.styles;let{rootStyle:h,headerInnerStyle:p,bodyStyle:m}=this.props.styles;this._updateChangeVisualizationButtons(this.props.updatedConfiguration.FormFactor.toString());let b=u,y={shadowStyle:null,innerStyle:null,outerStyle:null};this._isWidthLessThanViewportSm()&&(m=this.props.styles.bodyMobileStyle,p=this.props.styles.headerInnerMobileStyle);const _=this._seeMoreHelper.getSeeMorePopupStatus(),S=this._seeMoreHelper.getSeeMorePopupInfo();_!==g.b.NotInUse&&(y=g.a.getCustomControlFancyPopoutStyles(this.props.renderer,_,S),_!==g.b.ReturnFadeIn&&(b={height:S.startHeight,width:S.startWidth},h=Object.assign(Object.assign({},h),{height:S.endHeightInner-48})));const O=this.renderDataSetHostComponent(c,h,d,m,p),C=(this._getDataSetHostRootElement(),this._seeMorePopup.bind(this,!1)),j=this.props.isRTL,P=function(e,t,r,a,i,s,c,l=!1){const u=i||s,d="DataSetHostContainer";return n.createElement(o.a,{key:d,id:`${d}_${c}`,style:u,testhooks:{id:d}},e.renderCloseButton(a,!0,!1,l),e.renderSpacer(!0,!1),t)}(this._seeMoreHelper,O,0,C,y.innerStyle,h,c,j);let T=Object.assign({},y.outerStyle?y.outerStyle:h);0===this.state.loadingState?(T.visibility="hidden",T.maxHeight="0"):1===this.state.loadingState&&(T=Object.assign(Object.assign({},T),{opacity:"0.6",pointerEvents:"none",minHeight:this._height}));const E=function(e,t,r,a){const i=t||{width:"100%"},s=a?Ee.e:null;return n.createElement(o.a,{key:"DataSetHostOuterContainer",id:r+"_outer",style:i,role:s},e)}(P,T,c,(null===(i=this._seeMoreHelper)||void 0===i?void 0:i.getSeeMorePopupStatus())!==g.b.NotInUse),w=function(e,t){return t=t||{display:"none"},n.createElement(o.a,{key:"shadow",id:e?e+"shadow":null,style:t})}(c,y.shadowStyle),F=`datassethost_root_view_${s}_${c}`,x=Ae.a.getInstance().get_IsBrowserIE()&&Object(Ce.g)(this.props.contextString)?{overflow:"visible"}:{},{mobileSubGridContainerStyles:A}=this.props.styles;let D=Object.assign(b,x);return this._isNativePlatform&&Object(Ce.g)(this.props.contextString)&&this.props.featureControlProps.isInMobileModeForApril2020&&this.props.featureControlProps.isSubgridImprovementsEnabled&&(D=Object.assign(Object.assign({},D),A)),n.createElement(o.a,{key:F,style:D},n.createElement(l.a,{role:Ee.s,notificationType:Ve.b,style:{left:"-3000%",width:"0%",height:"0%",position:"absolute"}},this.state.statusMessage),w,E,this.props.showAdvancedFilter&&this.state.isFilterPanelOpen&&n.createElement(Et,{controlId:this.props.controlId,controlKey:this.props.controlKey,id:this.props.id,contextToken:this.props.contextToken,entityTypeName:this.props.entityTypeName,fetchXML:this.props.fetchXML,filterPanelOpen:this.state.isFilterPanelOpen,viewId:this.props.viewId,gridInput:this.props.gridInput,updateFetchXml:this.props.updateFetchXml,updatePageInput:this.props.updatePageInput,closeFilterPanel:this.closeFilterPanel,onViewChanged:this._onViewChanged,setAdvancedPanelApplyClick:()=>{this._clearCustomFilterAndUpdateControlKeyIndex(),this.setState({isAdvancedFilterEdited:!0})},originalView:this.props.originalView,resourceStrings:this.props.resourceStrings,telemetryMonitorAdvancedFindDiscard:Ut,resetAdvancedFilter:()=>this.setState({isAdvancedFilterEdited:!1})}),this.props.showColumnEditor&&n.createElement(Rt,{entityTypeName:this.props.entityTypeName,onViewChanged:this._onViewChanged,columnEditorPanelOpen:this.state.columnEditorPanelOpen,columnEditorPanelDismiss:()=>this.setState({columnEditorPanelOpen:!1}),viewId:this.props.viewId,pageId:this.props.id,gridInput:this.props.gridInput,updatePageInput:this.props.updatePageInput,fetchXML:this.props.fetchXML,isAdvancedFindFilterEdited:this.state.isAdvancedFilterEdited}),2!==this.state.loadingState?this._renderProgressIndicator():null)}componentDidMount(){this._getUpdateAddedCommandList(this._showCommandBarButtonSearch(),this._showCommandBarButtonShowChart())}closeFilterPanel(){this.setState({isFilterPanelOpen:!1})}componentWillReceiveProps(e){(Object(Ce.e)(this.props.contextString)||Object(Ce.g)(this.props.contextString)||Object(Ce.d)(this.props.contextString))&&!this.props.isOffline&&e.isOffline&&0===this._offlineSqlQueryRetrieveState&&this.props.offlineProps.isEmptyOfflineSqlQuery&&(this._offlineSqlQueryRetrieveState=1,this.props.retrieveView(this.props.entityTypeName,this.props.savedQueryType,this.props.viewType,this.props.viewId,!1).then(()=>{this._offlineSqlQueryRetrieveState=2;const e=[{name:"scenario",value:"Called retrieveView"},{name:"entityTypeName",value:this.props.entityTypeName},{name:"viewId",value:v.a.toString(this.props.viewId)}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentSuccess&&this.context.EventManager.ReportComponentSuccess(Vt+".componentWillReceiveProps",e)}).catch(e=>{this._offlineSqlQueryRetrieveState=2;const t=[{name:"scenario",value:"Called retrieveView"},{name:"error",value:e&&e.message},{name:"entityTypeName",value:this.props.entityTypeName},{name:"viewId",value:v.a.toString(this.props.viewId)},{name:"viewType",value:this.props.viewType},{name:"savedQueryType",value:this.props.savedQueryType}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentFailure&&this.context.EventManager.ReportComponentFailure(Vt+".componentWillReceiveProps",e,null,t)})),this._isShowChartChanged=this.props.showChart!==e.showChart}shouldComponentUpdate(e){return this.props.entityTypeName===P.a&&this.props.gridEntityTypeName!==e.gridEntityTypeName&&this._currentFilterValue?(this._updateFilterOnViewSelectorChange(e.gridEntityTypeName),!1):1!==this._offlineSqlQueryRetrieveState&&(0!==e.refreshCounter&&this.props.refreshCounter!==e.refreshCounter&&2===this.state.loadingState&&this._updateDataSetLoadingState(1),!0)}componentDidUpdate(){this._seeMoreHelper.getSeeMorePopupStatus()!==g.b.NotInUse&&this._seeMoreHelper.checkOnPopupStatus(!0,!1,this._getDataSetHostRootElement());const e=Object(F.c)(this.props.resourceStrings,j.GRID_LOADING_PLACEHOLDER).replace("{0}",this.props.entityDisplayName),t=2===this.state.loadingState?this.props.notificationMessage:e;Object(Ce.g)(this.props.contextString)&&(0===this.state.loadingState?this._isSubGridFirstLoad=!0:1===this.state.loadingState&&(this._isSubGridFirstLoad=!1)),this._updateStatus(t)}_renderAccessibilityComponent(e){const t=e+"Accessibility";if(Object(Ce.e)(this.props.contextString)){const r=[];if(this.props.viewSelectorProps){const a=this.props.viewSelectorProps.id;r.push(n.createElement(Te.a,{key:t,rootElementId:e,isModal:!1,shouldManageFocus:!0,defaultFocusId:a}))}else r.push(n.createElement(Te.a,{key:t,rootElementId:e,isModal:!1,shouldManageFocus:!0}));return r}return null}_isInSeeMoreState(){const e=this._seeMoreHelper.getSeeMorePopupStatus();return e!==g.b.NotInUse&&e!==g.b.ReturnFadeOutAndMove&&e!==g.b.ReturnFadeIn}_isNativeSubgrid(){return Object(Ce.g)(this.props.contextString)&&this.props.clientHostSubtype===Mt.a.Phone&&this.props.featureControlProps.isInMobileModeForOct2019&&this.props.featureControlProps.isInMobileModeForApril2020&&this.props.featureControlProps.isSubgridImprovementsEnabled}_getCombinedContainerStyleOverrides(){const{containerStyleOverrides:e}=this._parentDefinedProps,t=this.props.parentDefinedControlProps&&this.props.parentDefinedControlProps.containerStyleOverrides;return Object.assign(e,t,{rootContainer:Object.assign(e.rootContainer,{flex:Object(Ce.e)(this.props.contextString)||this._isInSeeMoreState()?"1 1 100%":"1 1 auto"},t&&t.rootContainer),primaryInnerContainer:this._isInSeeMoreState()?{flex:"1 1 100%",minHeight:"0"}:{}})}_updateViewSelectorProps(e){if(e.descriptor&&e.viewSelectorProps&&e.descriptor.Parameters){const t=e.descriptor.Parameters[f.B],r=t?t.toString().split(","):null,n=r?r.map(e=>v.a.tryParse(e)):null;e.viewSelectorProps.viewIds=n||null}}_getCachedSize(){return this._cachedSize||(this._cachedSize=this.props.cachedSize),this._cachedSize}_isWidthInitialized(){return this.state.isWidthInitialized||this._getCachedSize()&&this._getCachedSize().isWidthInitialized||!1}_isWidthLessThanViewportSm(){return this.state.isWidthLessThanViewportSm||this._getCachedSize()&&this._getCachedSize().isWidthLessThanViewportSm||!1}_isWidthLessThanViewportM(){return this.state.isWidthLessThanViewportM||this._getCachedSize()&&this._getCachedSize().isWidthLessThanViewportM||!1}_isWidthLessThanMinWidthForChartPlusGridReflow(){return this.state.isWidthLessThanMinWidthForChartPlusGridReflow||this._getCachedSize()&&this._getCachedSize().isWidthLessThanMinWidthForChartPlusGridReflow||!1}_isWidthGreaterThan480(){return this.state.isWidthGreaterThan480||this._getCachedSize()&&this._getCachedSize().isWidthGreaterThan480||!1}_isHeightGreaterThan240(){return this.state.isHeightGreaterThan240||this._getCachedSize()&&this._getCachedSize().isHeightGreaterThan240||!1}_showCommandBarButtonSearch(){return this.state.showCommandBarButtonSearch||this._getCachedSize()&&this._getCachedSize().showCommandBarButtonSearch||!1}_showCommandBarButtonShowChart(){return this.state.showCommandBarButtonShowChart||this._getCachedSize()&&this._getCachedSize().showCommandBarButtonShowChart||!1}_isJumpBarRenderingAsFlyout(){return this.state.isJumpBarRenderingAsFlyout||this._getCachedSize()&&this._getCachedSize().isJumpBarRenderingAsFlyout||!1}_hideJumpbarForMobile(){return this.props.featureControlProps.isJumpbarFeatureForMobileEnabled&&this._isWidthLessThanViewportSm()&&(Object(Ce.e)(this.props.contextString)||Object(Ce.d)(this.props.contextString))&&this.props.featureControlProps.isInMobileModeForApril2020}_showNewQuickFindSearchBarForMobile(){var e,t;return this._checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot()&&this._isWidthLessThanViewportSm()&&((null===(e=this.props.configuration)||void 0===e?void 0:e.CustomControlId)===f.p||(null===(t=this.props.configuration)||void 0===t?void 0:t.Name)===f.m)}_checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot(){return this.props.featureControlProps.isQuickFindImprovementsEnabled&&this.props.featureControlProps.isInMobileModeForApril2020&&Object(Ce.e)(this.props.contextString)}}function zt(e,t){return n.createElement(Xt,Object.assign({},e,{renderer:t.renderer}))}Xt.displayName="DataSetHost",Xt.contextType=Ot.a,zt.contextTypes={renderer:i.object};const qt=Object(s.a)(Ce.i,(function(e,t){return{initializeGrid:(r,n,a,i)=>{const s=tt.a.fromXmlAndSql("","",r).getQueryState(),o=t.descriptor&&t.descriptor.Parameters?t.descriptor.Parameters[f.r]:null,c=t.descriptor&&t.descriptor.Parameters&&t.descriptor.Parameters[f.s]?parseInt(t.descriptor.Parameters[f.s],10):null;a||(a=Object(ie.c)(t.id,i));const l=e(Object(ot.d)(s,n,t.id,i,t.descriptor,o,c,void 0,a)),u=e(Object(ft.b)(n,r,t.id)),d=e(Object(w.e)(j.labelList));return Promise.all([l,d,u])},removeEditedViewPageMap:(t,r)=>e(Object(Ft.c)(t,r.guid)),updatePageInput:(t,r)=>e(Object(xt.b)(t,r)),updateView:(r,n,a,i,s,o,c,l,u)=>{const d=e(Object(ct.a)(r,o,n,a,i)).then(()=>e(Object(ht.a)(r,s))),h=v.a.tryParseOrNull(a),p=e(Object(ft.b)(i,h,r));let g=Promise.resolve(null);if(u){const t=Object($e.a)(i,c,o,l,!0);g=e(t.getFilterOptionsAction())}return Promise.all([d,p,g]).then(()=>{if(Object(Ce.e)(t.contextString)){const e=[{filterType:0,filterExpressionOrValue:null}];t.updateGridPaginationStateHandler(e,t.id)}e(Object(Se.m)("",r,o)),e(Object(Se.n)("",r,o)),e(Object(Se.j)("",r,o)),e(Object(at.b)("",0,r,o))})},retrieveView:(t,r,n,a,i)=>e(Object(E.a)(t,r,n,a,!1)),markSelectedRows:(t,r,n)=>e(Object(Re.b)(t,r,n)),markSelectedRelatedEntity:(t,r,n)=>e(Object(Le.b)(t,r,n)),rowProperties:(t,r,n)=>e(Object(lt.b)(t,r,n)),updateFetchXml:(t,r,n)=>e(Object(ut.b)(t,r,n)),applyGridFilter:(r,n,a)=>{if(Object(Ce.e)(t.contextString)){const e=[{filterType:8,filterExpressionOrValue:r},{filterType:11,filterExpressionOrValue:n}];t.updateGridPaginationStateHandler(e,t.id)}e(Object(Se.k)(n,t.id,a)),e(Object(Se.l)(r,t.id,a))},applyActivityTypeFilter:(r,n,a)=>{if(Object(Ce.e)(t.contextString)){const e=[{filterType:9,filterExpressionOrValue:r},{filterType:10,filterExpressionOrValue:n}];t.updateGridPaginationStateHandler(e,t.id)}e(Object(Se.h)(n,t.id,a)),e(Object(Se.i)(r,t.id,a))},onSelectedOrderColumnChange:(r,n)=>{e(Object(Se.o)(r,t.id,n))},toggleGridRollupView:(r,n)=>{e(Object(dt.b)(r,t.id,n))},updatePagingData:(t,r,n)=>e(Object(it.b)(t,r,n)),updateQueryKey:(t,r,n)=>{e(Object(st.b)(t,r,n))},setCustomFilter:(t,r,n,a)=>e(Object(at.b)(t,r,n,a)),runOnRecordSelect:(r,n,a)=>{e(function(e,t,r,n,a){return{type:"dataset.run.on.record.select",sync:!0,execute({dispatch:a,getState:i},s){const o=s.TraceManager.getTracer(f.z),c=f.x+".RunOnRecordAction";try{if(s&&s.ScriptManager){const l=s.ScriptManager.getContainer(e);if(l&&n&&1===n.length){const e=Object(nt.c)(i()),u=Object(nt.b)(i());e&&(a(l.getEventManager().addGridOnRecordSelectHandlers(t)),a(l.getEventManager().addGridOnChangeHandlers(t))),(e||u)&&a(l.getEventManager().runOnRecordSelect(t,r)),o.info("Triggered the action for {0} selected records"+n.length),s.EventManager.ReportComponentSuccess(c)}}}catch(e){const t="Triggered action for selected records failed with error : "+e.message;s.EventManager.ReportComponentFailure(c,Error(t))}}}}(r,n,n.controlName?n.controlName:"entity_control",a,Object(Ce.e)(t.contextString)||Object(Ce.g)(t.contextString)))},retrieveRelatedEntitiesMetadata:t=>e(Object(At.a)(t)),switchHomepageConfiguration:(t,r,n,a,i)=>{e(Object(pt.g)(t,r,n,a,i))},switchViewConfiguration:(t,r,n,a,i)=>{e(Object(pt.i)(t,r,n,a,i))},switchSubgridVisualization:(t,r,n)=>{e(Object(pt.h)(t,r,n))},switchAssociatedGridVisualization:(t,r,n,a,i,s,o,c)=>{e(c?Object(pt.f)(t,r,n,a,i,s,o):Object(pt.e)(t,r,n,i,o))},toggleChartPane:(t,r,n)=>{e(Object(yt.b)(t,r,n))},clearQuery:()=>{e(Object(Tt.a)())},updateUserDefaultGridView:(t,r,n,a,i,s)=>e(function(e,t,r,n,a,i){return{type:"grid.update.userdefaultview",execute(s,o){const c=o.TraceManager.getTracer(f.z),l=f.x+".updateUserDefaultGridViewAction";try{c.info("Updating the user default view for the grid.");const u=s.getState(),d="usersettings",h=new mt.a(d,Object(We.q)(u)),p=Object(A.h)(u,e);if(!h||!p.ObjectTypeCode)return Promise.resolve();const g="<DefaultGridViews><DefaultGridView><EntityTypeCode>{0}</EntityTypeCode><ChildEntityName>{1}</ChildEntityName><QueueId>{2}</QueueId><ViewId>{3}</ViewId><ViewType>{4}</ViewType></DefaultGridView></DefaultGridViews>";i&&(t="",r="",a=[],n="");const m=[];for(const e of a){const t=v.a.tryParse(e),r=v.a.externalGuid(t);m.push(r)}const b=String.format(g,p.ObjectTypeCode,n||"",1===m.length?m.toString():"",v.a.externalGuid(v.a.tryParse(t)),r);s.dispatch(Object(gt.f)(h,{personalizationsettings:b}));const f={ViewId:t,ViewType:+r,QueueId:a.toString()};return s.dispatch(Object(bt.f)(f,e)),o.EventManager.ReportComponentSuccess(l),Promise.resolve()}catch(e){const t="Failed to update user default grid view with error : "+e.message;o.EventManager.ReportComponentFailure(l,Error(t))}}}}(t,r,n,a,i,s)),updateCurrentPageNumber:(t,r,n)=>e(Object(xe.b)(t,r,n)),setNewPageRequested:(t,r,n)=>{e(Object(Me.b)(t,r,n))},retrieveControlResourceStringsForSwitchVisualization:t=>{const r=t.filter(e=>null!=e);return e(Object(w.e)(r))},updatePageNumberForEnhancedPaging:e=>{if(Object(Ce.e)(t.contextString)){const r=[{filterType:12,filterExpressionOrValue:e}];t.updateGridPaginationStateHandler(r,t.id)}},openManageDuplicatesDialog:t=>{e(Object(It.a)(null,null,mt.a.fromExternalEntityReference(t.entityReference))).then(r=>{if(0===r.status)return e(Object(Ct.a)(r.pageId)).then(e=>{"ignore_save"===e.value.param_lastButtonClicked&&t.reject()})})},showInnerError:r=>{const n=new Dt.a(r,null,null,null,null,{stack:`${r} ${(new Error).stack}`,message:r});e(Object(Nt.a)(t.id,n))}}}))(zt)},"8O0c":function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n=r("Lyxw"),a=r("53SR"),i=r("Nb1E"),s=r("7tM0"),o=r("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c="ProcessControl_ActionExecuter_ExecutionTimeTooltip",l="ProcessControl_ActionExecuter_ErrorMessageTooltip",u="cc_MscrmControls.Containers.ProcessBreadCrumb/strings/ProcessControlResources";var d;function h(e){switch(e){case d.InProgress:case d.Waiting:return 1;case d.Succeeded:return 2;case d.Failed:case d.Canceled:return 3;default:return 0}}function p(e,t,r,n){let a="";if(Object(o.b)(e)||(a=String.format(n[c],new Date(e).toLocaleString())),r===d.Failed){const e=Object(o.b)(t)?n.Crm_GenericErrorMessage:t;a+="\n"+String.format(n[l],e)}return""===a?t:a}function g(e,t){return{type:"businessProcessFlow.actionLogs.retrieve",execute({dispatch:r,getState:o},d){const g=String.format("?$select=workflowlogid,message,status,modifiedon,stepname,activityname,_asyncoperationid_value&$filter=activityname%20eq%20'{0}'%20and%20_asyncoperationid_value%20eq%20{1}&$orderby=modifiedon%20desc&$top=500",e.guid,t.id.guid),m=o();if(function(e){return Object(n.b)(e,"BpfActionSupportActionQuerying")}(m))return r(Object(i.e)("workflowlog",g)).then(e=>{if(e.value&&e.value.length){const n={};n[c]=Object(s.a)(m,u,c),n[l]=Object(s.a)(m,u,l),n.Crm_GenericErrorMessage=Object(s.a)(m,u,"Crm_GenericErrorMessage");const i={};e.value.forEach(e=>{if(e.stepname&&-1===Object.keys(i).indexOf(e.stepname)){const t={actionLogId:e.workflowlogid,status:h(e.status),modifiedOn:e.modifiedon,stepId:e.stepname,processDefinitionid:e.activityname,processInstanceid:e._asyncoperationid_value,message:p(e.modifiedon,e.message,e.status,n)};i[e.stepname]=t}});const o={actionLogCollection:i};return r(Object(a.a)(o,t))}})}}}!function(e){e[e.InProgress=1]="InProgress",e[e.Succeeded=2]="Succeeded",e[e.Failed=3]="Failed",e[e.Canceled=4]="Canceled",e[e.Waiting=5]="Waiting"}(d||(d={}))},"91Ew":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="attribute.option.add";function i(e,t,r,i,s){const o=Object(n.x)(t);return{type:a,payload:{option:i,index:s},meta:{pageId:e,contextKey:o,dataFieldName:r}}}},"95wm":function(e,t,r){"use strict";r.d(t,"f",(function(){return p})),r.d(t,"c",(function(){return m})),r.d(t,"d",(function(){return b})),r.d(t,"b",(function(){return g})),r.d(t,"e",(function(){return f})),r.d(t,"a",(function(){return y}));var n=r("SAYH"),a=r("eXjw"),i=r("GEBM"),s=r("haag"),o=r("0L4T"),c=r("iZ7K"),l=r("YxC/"),u=r("69Qu"),d=r("WPtp"),h=r("LbMF");const p=s.a;function g(e,t,r,a,d,h,g,m=!1){return function(e,t,r){if(!n.a.toString(r.viewId)){const r="viewid is required to call retrieve chart data";throw e.EventManager.ReportComponentFailure(p+".retrieveChartData",Error(r),s.d,t),new Error(r)}return!0}(r,a,d)&&function(e,t,r,a,s){if(!n.a.toString(r.visualizationId)||n.a.toString(r.visualizationId)===n.a.EMPTYGUIDSTRING){const n=e(),u=Object(l.b)(n,i.n),d=Object(c.f)(n,a)||a,h=String.format(u,d);return Object(o.a)(n,t,h,r,s),!1}return!0}(e,t,d,h,g)&&function(e,t,r,n){const a=e();if(!Object(u.b)(a)){const e=Object(l.b)(a,i.r);return Object(o.a)(a,t,e,r,n),!1}return!0}(e,t,d,g)&&function(e,t,r,n){if(r.isRollUpView){const a=e(),s=Object(l.b)(a,i.j);return Object(o.a)(a,t,s,r,n),!1}return!0}(e,t,d,g)&&(!m||function(e,t,r,n){if(!r.viewXml){const a=Object(l.b)(e(),i.g);return Object(o.a)(e(),t,a,r,n),!1}return!0}(e,t,d,g)&&function(e,t,r,n){if(!r.fetchXml){const a=Object(l.b)(e(),i.o);return Object(o.a)(e(),t,a,r,n),!1}return!0}(e,t,d,g))}function m(e,t,r){const i=new n.a(e),s=n.a.toString(i),o=new n.a(t);return{type:r,payload:{charts:{[s]:{[n.a.toString(o)]:{initialized:a.a.Initializing}}}}}}function b(e,t){return{type:t,payload:{chartData:{[e]:{initialized:a.a.Initializing}}}}}function f(e,t,r){var n;const a=null===(n=null==e?void 0:e.category)||void 0===n?void 0:n.primaryGroupBy,i=null==a?void 0:a.groupAttribute;if(!function(e,t){var r;if(!e)return!1;const n=null===(r=null==e?void 0:e.entity)||void 0===r?void 0:r.entityName,a=null==e?void 0:e.attributeName,i=Object(h.b)(a,n,t);return"picklist"===i||"state"===i||"status"===i}(i,r))return;if(!e.isOrderPresentOnPrimaryGroupBy())return;const s=i.aliasName,o=new _(s);t.sort(o.comparator),a.descending&&t.reverse()}function y(e){const t=/(Name=\"o\:)(\w+)(,)(\d+)(\")/,r=e.match(new RegExp(t,"g"));let n=[];return r&&r.forEach(e=>{n=e.match(new RegExp(t,"m"))}),n}class _{constructor(e){this._primaryGroupByAttributeAlias=null,this.comparator=(e,t)=>this._getRawValue(e)-this._getRawValue(t),this._primaryGroupByAttributeAlias=e}_getRawValue(e){if(this._primaryGroupByAttributeAlias in e.fields){const t=e.fields[this._primaryGroupByAttributeAlias],r=Object(d.e)(t);return parseInt(r,10)}return-1}}},"9NSo":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="form.setLabel";function i(e,t,r){const i=Object(n.v)(t);return{type:a,payload:{label:r},meta:{pageId:e,contextKey:i}}}},"9i5P":function(e,t,r){"use strict";r.d(t,"a",(function(){return _}));var n=r("OQLa"),a=r("SAYH"),i=r("16wZ"),s=r("UqyN"),o=r("L8zx"),c=r("3yqi"),l=r("EOIL"),u=r("P6DH"),d=r("qshH"),h=r("9ksH"),p=r("E7fB"),g=r("n6Qt"),m=r("arV0"),b=r("deGN"),f=r("ZIjf");let y;class _{constructor(e,t,r,n,a,s){const o="ClientApi.XrmGridRow.constructor";e||Object(i.j)(o,"store"),n||Object(i.j)(o,"pageId"),r||Object(i.j)(o,"contextToken"),a||Object(i.j)(o,"entityType"),s||Object(i.j)(o,"entityId"),y=e,this._applicationContext=t,this._pageId=n,this._contextToken=r,this._entityType=a,this._entityId=s}get applicationContext(){return f.a.instance.reportUsage("ClientApi.XrmGridRow.applicationContext_get"),this._applicationContext}get context(){const e="ClientApi.XrmGridRow.context";try{return f.a.instance.reportCall(e),this._globalContext||(this._globalContext=new p.a(y,this._pageId)),f.a.instance.reportSuccess(e),this._globalContext}catch(t){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(e,t,null,r),t}}get data(){const e="ClientApi.XrmGridRow.data";try{if(f.a.instance.reportCall(e),!this._data){const t=new s.a(y,this._contextToken,this._pageId,this,this._entityType,this._entityId,v,this._applicationContext);this._data=new o.a(y,this._contextToken,this._pageId,this,t);const r=new h.b(y,this._pageId),n=[],i={isEventParam:!0,name:"attributeName",value:""};n.push(i),t.attributes.forEach(t=>{const s=t.getName();i.value=s;const o={Id:s,Label:null,Name:s,ShowLabel:!1,Visible:!0,ClassId:new a.a(h.a),Disabled:!1,DataFieldName:s},c=r.createXrmControl(this._contextToken,o,this,e,n);c&&t.controls.add(c.getName(),c)})}return f.a.instance.reportSuccess(e),this._data}catch(t){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(e,t,null,r),t}}getData(){try{return f.a.instance.reportUsage("ClientApi.XrmGridRow.getData"),this.data}catch(e){const t=d.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.getData",e,null,t),e}}get ui(){try{if(f.a.instance.reportCall("ClientApi.XrmGridRow.ui"),!this._ui){const e=new h.b(y,this._pageId);this._ui=new l.a(y,this._contextToken,this._pageId,this,this._entityType,e)}return f.a.instance.reportSuccess("ClientApi.XrmGridRow.ui"),this._ui}catch(e){const t=d.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.ui",e,null,t),e}}getControl(e){const t="ClientApi.XrmGridRow.getControl";try{f.a.instance.reportCall(t);const r=this.ui.controls.get(e);return f.a.instance.reportSuccess(t),r}catch(e){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,r),e}}getAttribute(e){const t="ClientApi.XrmGridRow.getAttribute";try{if(f.a.instance.reportCall(t),this.data.entity){const r=this.data.entity.attributes.get(e);return f.a.instance.reportSuccess(t),r}return f.a.instance.reportSuccess(t),null}catch(e){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,r),e}}getUrl(e){const t="ClientApi.XrmGridRow.getUrl";try{f.a.instance.reportCall(t);const r=this.data.entity.getEntityReference();this._internal=new g.a(y,this._applicationContext,this.context,this._pageId);const i=Object(m.g)(y.getState(),this._pageId),s={entityTypeName:r.entityType,etn:r.name,id:a.a.fromExternalGuid(r.id),entityTypeCode:this._internal.getEntityCode(r.entityType),languageId:this.context.userSettings.languageId,recordSetQueryKey:i.recordSetQueryKey};if(1===e){const e=y.dispatch(Object(n.a)(c.a.EditForm,s));return f.a.instance.reportSuccess(t),e}const o=Object(b.a)(y,this._pageId),l=y.dispatch(Object(n.c)(o,c.a.EditForm,s));return f.a.instance.reportSuccess(t),l}catch(e){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,r),e}}get entityReference(){try{return this.data.entity.getEntityReference()}catch(e){const t=d.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.entityReference",e,null,t),e}}}function v(e,t,r){const n=Object(u.D)(y.getState(),{id:r},t.parentContextToken);return n||(e.TraceManager.getTracer("ClientApi.XrmGridRow.getAttributeNames").error("Grid attributes was null"),[])}},"9ksH":function(e,t,r){"use strict";r.d(t,"b",(function(){return Ee})),r.d(t,"a",(function(){return Pe}));var n=r("AF/G"),a=r("arV0"),i=r("HcnX"),s=r("i1f0"),o=r("TsER"),c=r("qshH"),l=r("ZIjf");let u;class d extends i.a{constructor(e,t,r,n,a,i){super(e,t,r,n,a,i),u=e}refresh(){const e="ClientApi.XrmControlTimer.refresh";try{l.a.instance.reportCall(e),u.dispatch(Object(o.b)(this.pageId,this.contextToken,this.name)),l.a.instance.reportSuccess(e)}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,r),t}}getState(){const e="ClientApi.XrmControlTimer.getState";try{l.a.instance.reportCall(e);const t=Object(s.cb)(u.getState(),this.pageId,this.contextToken),r=t.controls[this.getName()].parameters.timerState;return l.a.instance.reportSuccess(e),r}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,r),t}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlTimer.getControlType"),"timercontrol"}}var h=r("lJW1"),p=r("1kth"),g=r("16wZ"),m=r("PUjk");let b;class f extends i.a{constructor(e,t,r,n,a,i){super(e,t,r,n,a,i),b=e,this.registerObserversForControlStateChange()}addOnClick(e){const t="ClientApi.XrmControlButton.addOnClick";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),b.dispatch(Object(p.b)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,r),e}}removeOnClick(e){const t="ClientApi.XrmControlButton.removeOnClick";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),b.dispatch(Object(p.w)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,r),e}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlButton.getControlType"),"button"}registerObserversForControlStateChange(){if(this.getName().startsWith("header_process")){const e=Object(m.a)(this.pageId);e&&this.controlStateObservable.registerObserver(e)}}}var y=r("0nOn"),_=r("yl9a"),v=r("NjDY"),S=r("3mEc");let O;class I extends i.a{constructor(e,t,r,n,a,i){super(e,t,r,n,a,i),O=e;const s=[{name:"controlName",value:a,isEventParam:!0}];this._clientApiExecutorWebResource=new y.a(e,"ClientApi.XrmControlWebResource.",r,t,s)}getSrc(){return this._clientApiExecutorWebResource.execute("getSrc",()=>{const e=O.getState(),t=Object(v.t)(e)+Object(s.wb)(e,{controlName:this.name,id:this.pageId},this.contextToken);return Object(S.c)(e,this.pageId,this.name,this.contextToken,t)})}getContentWindow(){return this._clientApiExecutorWebResource.executeAsync("getContentWindow",(e,t)=>{const r=this.formContext.applicationContext.TraceManager.getTracer(e),n=()=>{const e=Object(s.xb)(O.getState(),this.pageId,this.getName());if(e){let n=null;try{return n=e.contentWindow,"complete"===n.document.readyState?Promise.resolve(n):(t.push({name:"readyState",value:n.document.readyState}),r.info("Frame content window not ready",t),Promise.reject({message:"Frame element not ready.",errorCode:111,contentWindow:n}))}catch(e){return n?(t.push({name:"Error",value:e.message}),r.warn("Error getting Frame content window readyState",t),Promise.resolve(n)):Promise.reject(e)}}else r.info("Frame DOM element not ready",t);return Promise.reject({message:"Frame element could not be found.",errorCode:111})};return n().then(e=>Promise.resolve(e)).catch(e=>{if(111!==e.errorCode)return Promise.reject(e);const a=this.contextToken,i=this.pageId,s=this.getName();return new Promise((e,o)=>{const c=()=>{Object(p.G)(a,i,c,s),n().then(t=>{e(t)}).catch(n=>{n.contentWindow?(r.err("Frame content window readyState should be complete after OnReadyStateComplete",t),e(n.contentWindow)):o&&(111===n.errorCode?(r.err("Frame Element not found after OnReadyStateComplete",t),o(new Error("Frame element could not be found."))):o(n))})};O.dispatch(Object(p.l)(a,i,c,s))})})})}getObject(){return this._clientApiExecutorWebResource.execute("getObject",()=>Object(s.xb)(O.getState(),this.pageId,this.name))}setSrc(e){return this._clientApiExecutorWebResource.execute("getControlType",()=>{Object(g.a)(e)||O.dispatch(Object(_.b)(this.pageId,this.name,this.contextToken,e))})}getControlType(){return this._clientApiExecutorWebResource.execute("getControlType",()=>"webresource")}addOnReadyStateComplete(e){return this._clientApiExecutorWebResource.execute("addOnReadyStateComplete",()=>{O.dispatch(Object(p.l)(this.contextToken,this.pageId,e,this.getName()))},[{name:"handler",value:e,isRequired:!0}])}removeOnReadyStateComplete(e){return this._clientApiExecutorWebResource.execute("removeOnReadyStateComplete",()=>{O.dispatch(Object(p.G)(this.contextToken,this.pageId,e,this.getName()))},[{name:"handler",value:e,isRequired:!0}])}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let C;class j extends I{constructor(e,t,r,n,a,i){super(e,t,r,n,a,i),C=e}getInitialUrl(){const e="ClientApi.XrmControlIFrame.getInitialUrl";try{l.a.instance.reportCall(e);const t=Object(s.sb)(C.getState(),{controlName:this.name,id:this.pageId},this.contextToken);return l.a.instance.reportSuccess(e),t}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,r),t}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlIFrame.getControlType"),"iframe"}getSrc(){const e="ClientApi.XrmControlIFrame.getSrc";try{l.a.instance.reportCall(e);const t=C.getState(),r=this.getInitialUrl(),n=Object(S.c)(t,this.pageId,this.name,this.contextToken,r);return l.a.instance.reportSuccess(e),n}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,r),t}}}var P=r("bGh0"),T=r("/5se"),E=r("xorU"),w=r("fREn"),F=r("hA8P"),x=r("SAYH"),A=r("/q65");let N;class D extends P.a{constructor(e,t,r,n,a,i){super(e,t,r,n,a,i),N=e,this._clientApiExecutorLookup=new y.a(e,"ClientApi.XrmControlLookup.",r,t,[{name:"controlName",value:a,isEventParam:!0}])}addCustomView(e,t,r,n,a,i){this._clientApiExecutorLookup.execute("addCustomView",(s,o)=>{const c=x.a.tryParseOrNull(e);c||Object(g.k)(s,"guid","viewId",o),N.dispatch(Object(w.a)(this.pageId,this.name,c,t,this.contextToken,r,n,a)),i&&this.setDefaultView(e)},[{name:"viewId",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"guid"},{name:"entityLogicalName",value:t,isRequired:!0,isEventParam:!0},{name:"viewDisplayName",value:r,isRequired:!0},{name:"fetchXml",value:n,isRequired:!0},{name:"layoutXml",value:a,isRequired:!0},{name:"isDefault",value:i,isRequired:!0}])}addCustomFilter(e,t){const r="ClientApi.XrmControlLookup.addCustomFilter";Object(g.a)(e)&&Object(g.j)(r,"fetchXmlFilter"),Object(g.b)(e)||Object(g.l)(r);try{l.a.instance.reportCall(r),N.dispatch(Object(E.d)(this.pageId,this.name,t,this.contextToken,e)),this.controlStateObservable.notifyObservers(this.controlDescriptor),l.a.instance.reportSuccess(r)}catch(e){const t=c.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(r,e,null,t),e}}get disableMru(){const e="ClientApi.XrmControlLookup.getDisableMru";try{l.a.instance.reportCall(e);const t=Object(s.x)(N.getState(),{id:this.pageId,controlName:this.name},this.contextToken);return l.a.instance.reportSuccess(e),t}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,r),t}}set disableMru(e){const t="ClientApi.XrmControlLookup.setDisableMru";try{l.a.instance.reportCall(t),N.dispatch(Object(F.b)(N.getState(),this.pageId,this.name,this.contextToken,e)),l.a.instance.reportSuccess(t)}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,r),e}}startCustomFilter(){const e="ClientApi.XrmControlLookup.startCustomFilter";try{l.a.instance.reportCall(e),N.dispatch(Object(E.f)(this.pageId,this.name,this.contextToken)),this.controlStateObservable.notifyObservers(this.controlDescriptor),l.a.instance.reportSuccess(e)}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,r),t}}endCustomFilter(){const e="ClientApi.XrmControlLookup.endCustomFilter";try{l.a.instance.reportCall(e),N.dispatch(Object(E.e)(this.pageId,this.name,this.contextToken)),this.controlStateObservable.notifyObservers(this.controlDescriptor),l.a.instance.reportSuccess(e)}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,r),t}}getDefaultView(){return this._clientApiExecutorLookup.execute("getDefaultView",()=>{const e=Object(s.O)(N.getState(),this.pageId,this.name,this.contextToken);return e?x.a.externalGuid(new x.a(e)):null})}setDefaultView(e){this._clientApiExecutorLookup.execute("setDefaultView",(t,r)=>{const n=x.a.tryParseOrNull(e);n||Object(g.k)(t,"guid","id",r),N.dispatch(Object(T.b)(this.pageId,this.name,this.contextToken,n))},[{name:"defaultViewId",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"guid"}])}addOnLookupTagClick(e){const t="ClientApi.XrmControlLookup.addOnLookupTagClick";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),N.dispatch(Object(p.g)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,r),e}}addPreSearch(e){const t="ClientApi.XrmControlLookup.addPreSearch";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),N.dispatch(Object(p.t)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,r),e}}removeOnLookupTagClick(e){const t="ClientApi.XrmControlLookup.removeOnLookupTagClick";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),N.dispatch(Object(p.B)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,r),e}}removePreSearch(e){const t="ClientApi.XrmControlLookup.removePreSearch";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),N.dispatch(Object(p.O)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,r),e}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlLookup.getControlType"),"lookup"}getEntityTypes(){const e="ClientApi.XrmControlLookup.getEntityTypes";try{l.a.instance.reportCall(e);const t=Object(s.Ob)(N.getState(),this.pageId,this.contextToken,this._dataFieldName);return l.a.instance.reportSuccess(e),t}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,r),t}}setEntityTypes(e){const t="ClientApi.XrmControlLookup.setEntityTypes";e||Object(g.j)(t,"entityTypes");const r=[];try{l.a.instance.reportCall(t),e=Array.from(new Set(e));const n=Object(s.Pb)(N.getState(),this.pageId,this.contextToken,this._dataFieldName),a={};n.forEach(e=>{a[e]=!0}),e.forEach(e=>{a[e]||r.push(e)})}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t+".validation",e,null,r),e}r.length>0&&Object(g.h)(t,"entityType",r[0]);try{N.dispatch(Object(A.b)(this.pageId,this.contextToken,this._dataFieldName,e)),l.a.instance.reportSuccess(t)}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,r),e}}get _dataFieldName(){return this.controlDescriptor&&this.controlDescriptor.DataFieldName?this.controlDescriptor.DataFieldName:this.name}}var k=r("91Ew"),M=r("KnyI"),R=r("tvJg");let L;class B extends P.a{constructor(e,t,r,n,a,i){super(e,t,r,n,a,i),L=e;const s=[{name:"controlName",value:a,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];this._clientApiExecutorOptionsetBase=new y.a(e,"ClientApi.XrmControlOptionSetBase.",r,t,s)}addOption(e,t){this._clientApiExecutorOptionsetBase.execute("addOption",()=>{const r=this._options.length;Object(g.a)(t)||isNaN(t)||t>=r?t=r:t<=0?t=0:t-=1,L.dispatch(Object(k.b)(this.pageId,this.contextToken,this.controlDescriptor.DataFieldName,{Color:null,Label:e.text,Value:e.value},t))},[{name:"optionSetItem",value:e,isRequired:!0},{name:"optionSetItem.value",value:null==e?void 0:e.value,isRequired:!0,expectedDataType:"number"}])}clearOptions(){this._clientApiExecutorOptionsetBase.execute("clearOptions",()=>{L.dispatch(Object(R.b)(this.pageId,this.contextToken,this.controlDescriptor.DataFieldName))})}removeOption(e){return this._clientApiExecutorOptionsetBase.execute("removeOption",()=>{L.dispatch(Object(M.b)(this.pageId,this.contextToken,this.controlDescriptor.DataFieldName,e))},[{name:"value",value:e,isRequired:!0}])}getOptions(){return this._clientApiExecutorOptionsetBase.execute("getOptions",()=>this._options)}get _options(){const e=new Array,t=Object(s.B)(L.getState(),this.pageId,this.contextToken,this.name);if(t){t.length&&e.push({text:"",value:NaN});for(const r in t)e.push({text:t[r].Label,value:t[r].Value})}return e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class V extends B{getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlOptionSet.getControlType"),"optionset"}}var G=r("cf3Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let U;class X extends P.a{constructor(e,t,r,n,a,i){super(e,t,r,n,a,i),this._isDateFormatDateTime=!1,U=e,this._clientApiExecutorDateTime=new y.a(e,"ClientApi.XrmControlDateTime.",r,t,[{name:"controlName",value:a,isEventParam:!0}]),this._clientApiExecutorDateTime.execute("constructor",(e,t)=>{this._isDateFormatDateTime=this._getShowTime(e,t)},null,!1)}getShowTime(){return this._clientApiExecutorDateTime.execute("getShowTime",(e,t)=>this._getShowTime(e,t))}setShowTime(e){this._clientApiExecutorDateTime.execute("setShowTime",(t,r)=>{if(this._getShowTime(t,r)!==e){const t=e&&this._isDateFormatDateTime?"datetime":"date";U.dispatch(Object(G.b)(this.pageId,this.contextToken,this.name,t))}})}_getShowTime(e,t){const r=this.getAttrDescriptor(e,t,this._clientApiExecutorDateTime);return!r||"datetime"===r.Format}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class z extends B{getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlMultiSelectOptionSet.getControlType"),"multiselectoptionset"}}var q=r("455M"),H=r("zgeC"),W=r("dHD5"),Y=r("HAeo"),Q=r("ghNp"),K=r("P6DH");let J;class Z extends i.a{constructor(e,t,r,n,a){super(e,t,r,n,n.Name,a);const i=Object(W.e)(t,n.Name);e.dispatch(Object(Q.a)(this,r,i)),J=e,this._clientApiExecutorControlstream=new y.a(e,"ClientApi.XrmControlStream.",r,t)}get clientApiExecutor(){return this._clientApiExecutorControlstream}_getGridControls(){if(!this._underlyingGridControls){this._underlyingGridControls=[];const e=this.controlDescriptor.Parameters&&this.controlDescriptor.Parameters[0]&&this.controlDescriptor.Parameters[0].StreamObjects;if(e){const t=e.StreamObjectCollection;if(t){const e=t.ShowAsTiles?[!0,!1]:[!0];for(const r of t)for(const t of e){const e=Object(W.o)(this.contextToken,this.getName(),r.Id,t),n=new Y.a(J,e,this.pageId,!1,3,!0,this.formContext.applicationContext,e.controlName);this._underlyingGridControls.push({contextToken:e,gridControl:n})}}}}return this._underlyingGridControls}refresh(){this.clientApiExecutor.execute("refresh",()=>{const e=[];for(const{contextToken:t,gridControl:r}of this._getGridControls()){if(Object(K.hb)(J.getState(),this.pageId,t,t.controlName))try{r.refresh()}catch(t){e.push(t)}}if(e.length>0){const t=[...c.a.getInstance().getEventParameters(this.contextToken),{name:"count",value:e.length}];Object(g.e)(this.clientApiExecutor.getComponentName("refresh"),"Some grids in stream failed to refresh",null,t)}})}}var $=r("odYE"),ee=r("6QGX"),te=r("tpZ5"),re=r("E7fB"),ne=r("jq7Z"),ae=r("zsAz"),ie=r("IaGr");let se;class oe extends i.a{constructor(e,t,r,n,a,i){super(e,t,r,n,n.Name,a),se=e,this._clientApiExecutor=new y.a(e,"ClientApi.XrmControlSubFormBase.",r,t,[{name:"controlName",value:null==n?void 0:n.Name,isEventParam:!0}]),this._xrmControlFactory=i}getParentComponent(){return Object(ne.a)(se.getState(),this.pageId)}get context(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.context",()=>this._form?this._form.context:null)}get _parentFormContext(){return this.formContext}get _form(){if(this._tryGetSubFormInstanceId(),!this._isSubFormMetadataLoaded())throw Object(ae.d)("SUBFORM_METADATA_NOT_LOADED",2415919107);const e=this._subFormControlContextToken;if(e&&this._formInstance)return this._formInstance;const t=this._getValueInternal(),r=Object(ee.d)(t);if(e)return this._formInstance=se.dispatch(Object(Q.b)(this._subFormInstanceId,e)),this._formInstance||r&&r.length>0&&(this._formInstance=se.dispatch(this._createXrmForm(e,this._subFormInstanceId,r[0].entityType,new x.a(r[0].id)))),this._formInstance&&!this._formInstance.context&&(this._formInstance.context=this._parentFormContext.context),this._formInstance;return c.a.getInstance().getEventParameters(this.contextToken).push({name:"controlName",value:this.getName()}),ie.a.getInstance().traceManager.getTracer("ClientApi.XrmControlSubFormBase._form").info("XrmControlSubForm._form is null"),null}_createXrmForm(e,t,r,n){const a=this._xrmControlFactory;return{type:"clientapi.create.xrmform",sync:!0,execute(i,s){const o=new te.a(i,{etn:r,id:n},a,e,t);o.applicationContext=s;const c=new re.a(i,t);return o.context=c,o}}}get _subFormControlContextToken(){const e=this._getValueInternal(),t=Object(ee.d)(e);return t&&t[0]&&t[0].id?this._entityRecordId!==t[0].id&&(this._entityType=t[0].entityType,this._entityRecordId=t[0].id,this._subFormContextToken&&se.dispatch(Object(Q.h)(this._subFormInstanceId,this._subFormContextToken)),this._subFormContextToken=this._getSubFormContextToken(this.contextToken,this.name,this._entityType),this._formInstance=null):this._subFormContextToken&&(se.dispatch(Object(Q.h)(this._subFormInstanceId,this._subFormContextToken)),this._subFormContextToken=void 0,this._entityType=void 0,this._entityRecordId=void 0,this._formInstance=null),this._subFormContextToken}get data(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.data",()=>this._form?this._form.data:null)}get ui(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.ui",()=>this._form?this._form.ui:null)}get entityReference(){return l.a.instance.reportUsage("ClientApi.XrmControlSubFormBase.entityReference"),null}getControl(e){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getControl",()=>this._form?this._form.getControl(e):null)}getAttribute(e){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getAttribute",()=>this._form?this._form.getAttribute(e):null)}getUrl(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getUrl",()=>this._form?this._form.getUrl():null)}refresh(){this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.refresh",()=>{this.data&&this.data.refresh()})}_getValueInternal(){const e=this._parentFormContext.data.entity.getEntityName(),t=this._parentFormContext.data.entity.getId(),r=t?new $.a(e,new x.a(t)):new $.a(e),n=Object(s.ac)(se.getState(),this._subFormInstanceId,this.contextToken);return Object(s.X)(se.getState(),this._subFormInstanceId,this._subFormContextToken,n,r,this.controlDescriptor.DataFieldName)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let ce;class le extends oe{constructor(e,t,r,n,a,i){super(e,t,r,n,a,i),ce=e}_getSubFormContextToken(e,t,r){return Object(W.l)(this.contextToken,this.name,this._entityType)}getSubFormInstanceId(){return this.pageId}_isSubFormMetadataLoaded(){return!!this._subFormInstanceId}_tryGetSubFormInstanceId(){}get _subFormInstanceId(){return this.pageId}isLoaded(){const e="ClientApi.XrmControlQuickForm.isLoaded";try{l.a.instance.reportCall(e);const t=Object(s.ic)(ce.getState(),this.getSubFormInstanceId(),this._subFormControlContextToken);return l.a.instance.reportSuccess(e),!!t}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,r),t}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlQuickForm.getControlType"),"quickform"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let ue;class de extends P.a{constructor(e,t,r,n,a,i){e||Object(g.j)("ClientApi.XrmStandardDataControl.constructor","store"),super(e,t,r,n,a,i),ue=e}getValue(){const e="ClientApi.XrmStandardDataControl.getValue";try{l.a.instance.reportCall(e);const t=Object(s.F)(ue.getState(),{controlName:this.name,id:this.pageId},this.contextToken);return l.a.instance.reportSuccess(e),t}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(e,t,null,r),t}}addOnKeyPress(e){const t="ClientApi.XrmStandardDataControl.addOnKeyPress";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),ue.dispatch(Object(p.e)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(t,e,null,r),e}}removeOnKeyPress(e){const t="ClientApi.XrmStandardDataControl.removeOnKeyPress";e||Object(g.j)(t,"handler");try{l.a.instance.reportCall(t),ue.dispatch(Object(p.z)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(t,e,null,r),e}}fireOnKeyPress(){const e="ClientApi.XrmStandardDataControl.fireOnKeyPress";try{l.a.instance.reportCall(e),ue.dispatch(Object(p.R)(this.contextToken,this.pageId,this.name,this)),l.a.instance.reportSuccess(e)}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(e,t,null,r),t}}}var he=r("ywwS"),pe=r("VqBP"),ge=r("w92Z");class me extends V{constructor(e,t,r,n,a,i){super(e,t,r,n,a,i),this._clientApiExecutorDependentOptionSet=new y.a(e,"ClientApi.XrmControlDependentOptionSet.",r,t,[{name:"controlName",value:a,isEventParam:!0}])}addOption(e,t){return this._clientApiExecutorDependentOptionSet.execute("addOption",(e,t)=>{Object(g.i)(e,"DependentOptionSet.addOption",t)})}clearOptions(){return this._clientApiExecutorDependentOptionSet.execute("clearOptions",(e,t)=>{Object(g.i)(e,"DependentOptionSet.clearOptions",t)})}removeOption(e){return this._clientApiExecutorDependentOptionSet.execute("removeOption",(e,t)=>{Object(g.i)(e,"DependentOptionSet.removeOption",t)})}setDisabled(e){return this._clientApiExecutorDependentOptionSet.execute("setDisabled",(e,t)=>{Object(g.i)(e,"DependentOptionSet.setDisabled",t)})}setVisible(e){return this._clientApiExecutorDependentOptionSet.execute("setVisible",(e,t)=>{Object(g.i)(e,"DependentOptionSet.setVisible",t)})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class be extends z{constructor(e,t,r,n,a,i){super(e,t,r,n,a,i),this._clientApiExecutorDependentOptionSet=new y.a(e,"ClientApi.XrmControlMultiSelectDependentOptionSet.",r,t,[{name:"controlName",value:a,isEventParam:!0}])}addOption(e,t){return this._clientApiExecutorDependentOptionSet.execute("addOption",(e,t)=>{Object(g.i)(e,"MultiSelectDependentOptionSet.addOption",t)})}clearOptions(){return this._clientApiExecutorDependentOptionSet.execute("clearOptions",(e,t)=>{Object(g.i)(e,"MultiSelectDependentOptionSet.clearOptions",t)})}removeOption(e){return this._clientApiExecutorDependentOptionSet.execute("removeOption",(e,t)=>{Object(g.i)(e,"MultiSelectDependentOptionSet.removeOption",t)})}setDisabled(e){return this._clientApiExecutorDependentOptionSet.execute("setDisabled",(e,t)=>{Object(g.i)(e,"MultiSelectDependentOptionSet.setDisabled",t)})}setVisible(e){return this._clientApiExecutorDependentOptionSet.execute("setVisible",(e,t)=>{Object(g.i)(e,"MultiSelectDependentOptionSet.setVisible",t)})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class fe extends de{setDisabled(e){const t="ClientApi.XrmDependentOptionSetGridControl.setDisabled";l.a.instance.reportUsage(t),Object(g.e)(t,String.format("Can not execute {0} for dependent option set control","setDisabled"))}}var ye=r("LbMF"),_e=r("3/02"),ve=r("Lyxw"),Se=r("Z/4N"),Oe=r("BoVI");let Ie;class Ce extends oe{constructor(e,t,r,n,a,i){var s,o;super(e,t,r,n,a,i),this._formInstanceId=null===(o=null===(s=this.getParentComponent())||void 0===s?void 0:s.formInstances)||void 0===o?void 0:o.formInstanceIdByControlName[this.controlDescriptor.Name],this._formComponentClientApiExecutor=new y.a(e,"ClientApi.XrmControlFormComponent.",this._formInstanceId),this._formComponentClientApiExecutor.addEventParameter({name:"controlName",value:n.Name,isEventParam:!0}),Ie=e}_tryGetSubFormInstanceId(){var e,t;this._formInstanceId||(this._formInstanceId=null===(t=null===(e=this.getParentComponent())||void 0===e?void 0:e.formInstances)||void 0===t?void 0:t.formInstanceIdByControlName[this.controlDescriptor.Name])}_isSubFormMetadataLoaded(){return!!this._subFormInstanceId}_getSubFormContextToken(e,t,r){return Object(W.h)(r)}get _subFormInstanceId(){return this._formInstanceId}isLoaded(){return this._isSubFormMetadataLoaded()&&this._formComponentClientApiExecutor.execute("ClientApi.XrmControlFormComponent.isLoaded",()=>!!Object(s.yc)(Ie.getState(),this._subFormInstanceId,this._subFormControlContextToken))}setInitializationIntent(e="fullload"){this._formComponentClientApiExecutor.execute("setInitializationIntent",t=>{"nothing"!==e&&"fullload"!==e&&Object(g.h)(t,e,"intent"),Ie.dispatch(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,r,n){const a=Object(W.v)(r);return{type:Oe.d,payload:n,meta:{pageId:e,controlName:t,contextKey:a}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(this.pageId,this.name,this.contextToken,e))},[{name:"intent",value:e,isEventParam:!0,expectedDataType:"string"}])}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlFormComponent.getControlType"),"formcomponent"}}var je=r("CYtR");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Pe="3d180de6-b456-4d90-9d5a-9899936baf44";let Te;class Ee{constructor(e,t){this._pageId=t,Te=e}createXrmControl(e,t,r,s,o){Object(g.g)(t,s,"control");try{o.push({name:"controlClassId",value:t&&t.ClassId?t.ClassId.guid:""}),o.push({name:"controlName",value:t?t.Name:""}),o.push({name:"controlDataFieldName",value:t?t.DataFieldName:""}),o.push({name:"pageId",value:this._pageId});const l=Object(a.l)(Te.getState(),this._pageId);o.push({name:"pageType",value:l});let u=!1,p=null,g=!1;const m=this._getControlType(t,r,e,s,o);switch(m){case n.i.guid:p=new f(Te,e,this._pageId,t,t.Name,r);break;case q.a.KbContent:case q.a.KbArticle:case n.C.guid:case n.I.guid:p=new j(Te,e,this._pageId,t,t.Name,r);break;case q.a.LookupRegarding:case q.a.LookupCustomer:case q.a.LookupMultiEntity:case q.a.LookupOwner:case q.a.LookupSimple:case q.a.LookupPartyList:case n.M.guid:case n.fb.guid:case n.S.guid:case n.l.guid:if(Object(ve.c)(Te.getState(),_e.jb)){const n=Object(ne.b)(Te.getState(),this._pageId,e);if(Object(Se.c)(Te.getState(),t.UniqueId,n)===je.d){p=new Ce(Te,e,this._pageId,t,r,this);break}}p=new D(Te,e,this._pageId,t,t.Name,r);break;case q.a.OptionSet:case n.U.guid:if(g=Object(ve.c)(Te.getState(),_e.L),1==g){const n=this._getEntityNameForControl(t,r);if(Object(ye.l)(Te.getState(),n,t.DataFieldName)){p=new me(Te,e,this._pageId,t,t.Name,r);break}}case q.a.EntityNameOptionSet:case q.a.TwoOptions:case q.a.StatusOptionSet:case n.sb.guid:case n.K.guid:case n.W.guid:case n.V.guid:case n.hb.guid:case n.n.guid:case n.N.guid:p=new V(Te,e,this._pageId,t,t.Name,r);break;case q.a.MultiSelectPicklist:case n.Q.guid:if(g=Object(ve.c)(Te.getState(),_e.L),g){const n=this._getEntityNameForControl(t,r);if(Object(ye.l)(Te.getState(),n,t.DataFieldName)){p=new be(Te,e,this._pageId,t,t.Name,r);break}}p=new z(Te,e,this._pageId,t,t.Name,r);break;case q.a.QuickForm:case n.cb.guid:case n.ab.guid:case n.Z.guid:const a=new le(Te,e,this._pageId,t,r,this);r.ui.quickForms.add(t.Name,a);break;case q.a.SearchWidget:case q.a.ReferencePanelSearchWidget:case n.db.guid:case n.kb.guid:p=new h.a(Te,e,this._pageId,t,t.Name,r);break;case q.a.TimelineWall:case n.qb.guid:p=Te.dispatch(Object(Q.f)(this._pageId,Object(W.p)(e,t.Name))),p||(p=new he.a(Te,e,this._pageId,t,t.Name,t.LabelId,r,r.applicationContext));break;case q.a.DateAndTimeDateOnly:case q.a.DateAndTimeDateAndTime:case n.q.guid:p=new X(Te,e,this._pageId,t,t.Name,r);break;case q.a.Grid:case n.eb.guid:case n.E.guid:const l=Object(W.p)(e,t.Name),b=Te.dispatch(Object(Q.c)(this._pageId,l));b&&(b.getName||3!==b.getGridType()?p=b:(c.a.getInstance().reportFailure(s,new Error("Main grid found in cache - converting to a subgrid."),null,o),Te.dispatch(Object(Q.h)(this._pageId,l)))),p||(p=new H.a(Te,e,this._pageId,t.Name,Object(K.wb)(Te.getState(),this._pageId,e,t.Name),r,t,r.applicationContext));break;case q.a.Timer:case n.rb.guid:p=new d(Te,e,this._pageId,t,t.Name,r);break;case q.a.WebResourceHtmlControl:case n.ub.guid:case n.vb.guid:p=new I(Te,e,this._pageId,t,t.Name,r);break;case n.mb.guid:p=new Z(Te,e,this._pageId,t,r);break;case n.z.guid:case n.G.guid:break;case Pe:if(g=Object(ve.c)(Te.getState(),_e.L),g&&Object(ye.l)(Te.getState(),e.entityTypeName,t.Name)){p=new fe(Te,e,this._pageId,t,t.Name,r);break}case q.a.AppliedFilters:case q.a.BusinessProcessFlow:case q.a.Card:case q.a.Currency:case q.a.Dashboard:case q.a.Decimal:case q.a.EmailEngagementActions:case q.a.EmailEngagementRecipientActivity:case q.a.FP:case q.a.GlobalFilter:case q.a.MicrosoftFlow:case q.a.Multiple:case q.a.PowerBI:case q.a.ReferencePanel:case q.a.Search:case q.a.SingleLineAddress:case q.a.SingleLineEmail:case q.a.SingleLinePhone:case q.a.SingleLineText:case q.a.SingleLineTextArea:case q.a.SingleLineTickerSymbol:case q.a.SingleLineURL:case q.a.SocialInsightsControl:case q.a.WholeDuration:case q.a.WholeLanguage:case q.a.WholeNone:case q.a.WholeTimeZone:case n.a.guid:case n.b.guid:case n.c.guid:case n.d.guid:case n.e.guid:case n.f.guid:case n.g.guid:case n.h.guid:case n.j.guid:case n.k.guid:case n.m.guid:case n.p.guid:case n.r.guid:case n.s.guid:case n.t.guid:case n.u.guid:case n.v.guid:case n.w.guid:case n.x.guid:case n.y.guid:case n.A.guid:case n.B.guid:case n.D.guid:case n.H.guid:case n.J.guid:case n.L.guid:case n.O.guid:case n.P.guid:case n.R.guid:case n.T.guid:case n.X.guid:case n.Y.guid:case n.bb.guid:case n.gb.guid:case n.ib.guid:case n.jb.guid:case n.lb.guid:case n.mb.guid:case n.nb.guid:case n.ob.guid:case n.pb.guid:case n.tb.guid:case n.wb.guid:u=!0;default:p=t.DataFieldName?new de(Te,e,this._pageId,t,t.Name,r):new i.a(Te,e,this._pageId,t,t.Name,r),u||(o.push({name:"controlType",value:m}),ie.a.getInstance().traceManager.getTracer(s).error("Unknown Form Control",o))}return p}catch(e){return c.a.getInstance().reportFailure(s+".createXrmControl",e,null,o),null}}_getControlType(e,t,r,a,i){if(x.a.equals(e.ClassId,n.o)){const n=this._getCustomControlType(e,t,r);return n||ie.a.getInstance().traceManager.getTracer(a+".controlPrimaryType").error("Control primary type could not be determined",i),i.push({name:"manifestControlType",value:n}),n}return e.ClassId.guid}_getCustomControlType(e,t,r){var n,a,i;const o=Object(ne.b)(Te.getState(),this._pageId,r);let c=Object(pe.c)(Te.getState(),e,o);if(!c){const l=Object(s.h)(),u=(null===(a=null===(n=t.data)||void 0===n?void 0:n.entity)||void 0===a?void 0:a.getEntityName())||"";let d=l(Te.getState(),e,this._pageId,o,u);if(d||(d=Object(ge.a)(Te.getState(),e,this._pageId,r)),null==d?void 0:d.Parameters)for(const e in d.Parameters)if(null===(i=d.Parameters[e])||void 0===i?void 0:i.Primary){c=d.Parameters[e].Type;break}}return c}_getEntityNameForControl(e,t){let r="";if(e.Relationship)r=Object(s.T)(Te.getState(),this._pageId,e.Relationship);else{const n=t.getAttribute(e.DataFieldName);n&&n.getParent()&&(r=n.getParent().getEntityName())}return r}}},AE7n:function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n=r("YYhu"),a=r("iZ7K"),i=r("vNXc"),s=r("q/4y"),o=r("GxhD"),c=r("hQd/"),l=r("SAYH"),u=r("i1f0"),d=r("dHD5"),h=r("arV0"),p=r("P6DH"),g=r("fILV"),m=r("aF0N"),b=r("P+kM"),f=r("3/02"),y=r("Lyxw"),_=r("HfZT"),v=r("E8F2");function S(e,t,r,S,O,I,C=!1,j){return{type:"embeddedEntity.save",execute(S,P){const T=S.getState(),E=new l.a(r),w=Object(d.f)(j,E,t);let F;switch(Object(h.l)(T,e)){case g.a:F=Object(p.R)(T,e,w);break;default:F=Object(u.ac)(T,e,w)}const x=Object(m.c)(T),A=Object(m.b)(T);if((x||A)&&"Dashboard"!==Object(h.l)(T,e)){const t=P.ScriptManager.getContainer(e).getEventManager();if(S.dispatch(t.runOnSave(j,1,null,r)))return Promise.reject(Object(v.b)(T,e,2200000005,""))}return S.dispatch(Object(n.c)(F,C,O)).then(n=>{const u=Object(p.qb)(T,new l.a(I),e),d=Object(a.h)(T,t),h=i.a.fromXmlAndSql(u.fetchXML,u.offlineSqlQuery,u.viewId,null,u.entityLogicalName,S.getState);return h.where(new s.a("eq",new o.a(t,d.PrimaryIdAttribute),new c.a(r))),S.dispatch(Object(_.d)(h.getQueryState())).then(()=>n)}).catch(e=>(Object(y.a)(T,f.xb)&&F&&S.dispatch(Object(b.b)(F,!1)),Promise.reject(e)))}}}},ATZz:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return o}));var n=r("SAYH"),a=r("y60j");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i=new n.a("8c54228c-1b25-4909-a12a-f2b968bb0d62");function s(e,t){const r=Object(a.d)(e,t,null);if(!r||1!==Object.keys(r).length)return null;const s=r[Object.keys(r)[0]];return s&&n.a.equals(s.ClassId,i)?s.Parameters:null}function o(e,t){const r=s(e,t),n=null==r?void 0:r.Type;return n&&-1!==["1","2"].indexOf(n)}},AbXy:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r("P6DH"),a=r("Sbn7"),i=r("9i5P"),s=r("16wZ"),o=r("dHD5"),c=r("SAYH"),l=r("5Oca"),u=r("odYE"),d=r("WPtp"),h=r("qshH"),p=r("1kth"),g=r("ZIjf"),m=r("Uv1Y"),b=r("IaGr");let f;class y{constructor(e,t,r,n,a,i,o){const c="ClientApi.XrmControlGrid.constructor";if(n||Object(s.j)(c,"pageId"),r||Object(s.j)(c,"contextToken"),e||Object(s.j)(c,"store"),a||Object(s.j)(c,"gridEntity"),Object(s.a)(i)&&Object(s.j)(c,"isEditable"),f=e,this._applicationContext=t,this._contextToken=r,this._pageId=n,this._gridEntityName=a,this.controlName=o,this._isEditable=i,!this._contextToken.contextTokenType){const e=h.a.getInstance().getEventParameters(this._contextToken);e.push({name:"controlName",value:this.controlName}),e.push({name:"gridEntityName",value:this._gridEntityName}),h.a.getInstance().reportFailure(c,new m.a("context token passed to grids with empty context token type"),null,e)}}get _isEditable(){const e=Object(n.V)(f.getState(),this._pageId,this._gridEntityName,this._contextToken,this.controlName);if(null===e){const e="ClientApi.XrmControlGrid._isEditable_get",t=h.a.getInstance().getEventParameters(this._contextToken);return t.push({name:"controlName",value:this.controlName}),t.push({name:"gridEntityName",value:this._gridEntityName}),b.a.getInstance().eventManager.ReportComponentFailure(e,new m.a("control configuration parameters not found"),null,t),this._isGridEditable}return e}set _isEditable(e){this._isGridEditable=e}get applicationContext(){return g.a.instance.reportUsage("ClientApi.XrmControlGrid.applicationContext_get"),this._applicationContext}set applicationContext(e){g.a.instance.reportUsage("ClientApi.XrmControlGrid.applicationContext_set")}getTotalRecordCount(){const e="ClientApi.XrmControlGrid.getTotalRecordCount";try{g.a.instance.reportCall(e);const t=Object(n.Y)(f.getState(),this._pageId,this._contextToken);if(t){const r=JSON.parse(t),n=r&&r.totalResultCount?r.totalResultCount:0;return g.a.instance.reportSuccess(e),n}return g.a.instance.reportSuccess(e),0}catch(t){const r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(e,t,null,r),t}}getRows(){const e="ClientApi.XrmControlGrid.getRows";try{g.a.instance.reportCall(e);const t=new a.a(e),r=f.getState(),s=Object(n.H)(r,this.contextToken,{id:this.pageId});if(s)for(let e=0;e<s.length;e++){const r=s[e].identifier.id,n=this._getRowEntityName(s[e],r),a=new i.a(f,this._applicationContext,Object(o.f)(this.contextToken,r,n),this.pageId,n,r),c=s[e].identifier.id.guid;t.add(c,a)}return g.a.instance.reportSuccess(e),t}catch(t){const r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(e,t,null,r),t}}getSelectedRows(){const e="ClientApi.XrmControlGrid.getSelectedRows";try{g.a.instance.reportCall(e);const t=new a.a(e),r=Object(n.fb)(f.getState(),this.pageId,this.contextToken);if(r){const e=Object(n.Q)(f.getState(),this.pageId,this.contextToken);for(let a=0;a<r.length;a++){let s;if(e)s=e;else{const e=f.getState(),t=Object(n.v)(e,this.pageId,this.contextToken),i=(t&&t.queryKey&&Object(l.q)(e,t.queryKey,null,null,!0)||[]).find(e=>e.identifier&&c.a.equals(e.identifier.id,r[a]));s=this._getRowEntityName(i,r[a])}const u=new i.a(f,this._applicationContext,Object(o.f)(this.contextToken,r[a],s),this.pageId,s,r[a]),d=r[a].guid;t.add(d,u)}}return g.a.instance.reportSuccess(e),t}catch(t){const r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(e,t,null,r),t}}addOnRecordSelect(e){const t="ClientApi.XrmControlGrid.addOnRecordSelect";if(this._isEditable){e||Object(s.j)(t,"handler");try{g.a.instance.reportCall(t),f.dispatch(Object(p.m)(this.contextToken,this.pageId,e,this.controlName)),g.a.instance.reportSuccess(t)}catch(e){const r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(t,e,null,r),e}}}removeOnRecordSelect(e){const t="ClientApi.XrmControlGrid.removeOnRecordSelect";if(this._isEditable){e||Object(s.j)(t,"handler");try{g.a.instance.reportCall(t),f.dispatch(Object(p.H)(this.contextToken,this.pageId,e,this.controlName)),g.a.instance.reportSuccess(t)}catch(e){const r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(t,e,null,r),e}}}runOnRecordSelect(e){const t="ClientApi.XrmControlGrid.runOnRecordSelect";try{g.a.instance.reportCall(t),this._isEditable&&f.dispatch(Object(p.T)(this.contextToken,this.pageId,e,this.controlName)),g.a.instance.reportSuccess(t)}catch(e){const r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(t,e,null,r),e}}_getRowEntityName(e,t){const r=e&&e.identifier?e.identifier.etn:this._gridEntityName;if("activitypointer"===r){const e="activitytypecode",r=Object(l.j)(f.getState(),new u.a(this._gridEntityName,t),e);if(Object(d.j)(r))return r.value}return r}get pageId(){return this._pageId}get contextToken(){return this._contextToken}}},B9jE:function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n=r("P6DH"),a=r("Utin");var i=r("Uv1Y"),s=r("SAYH"),o=r("eXjw"),c=r("a72m"),l=r("KBcj"),u=r("d0w6"),d=r("dQnL"),h=r("WK+4"),p=r("CngE"),g=r("iZ7K"),m=r("69Qu"),b=r("BzGi"),f=r("BFlg"),y=r("s+OO"),_=r("7k+e");var v=r("LAGg"),S=r("RrRu"),O=r("jRHm"),I=r("uCpV"),C=r("X37l"),j=r("ujVH"),P=r("3/02"),T=r("Lyxw"),E=r("VcAV");function w(e,t,r,w,x,A){return{type:"grid.refresh.async",execute({dispatch:N,getState:D},k){const M=k.TraceManager.getTracer(f.z),R=f.x+".refreshGridAction";try{const L=D(),B=s.a.tryParseOrNull(w);if(B){const V=A||(r?u.a.SUB_GRID:u.a.MAIN_APPLICATION_VIEW);return function(e,t,r,a,d,h,p,g){const b=Object(n.qb)(t,g,r);if(b&&b.initialized===o.a.Initialized&&(Object(m.b)(t)||!Object(E.b)(b.offlineSqlQuery)))return Promise.resolve(g);const f=h||Object(n.F)(t,r,a,d),y=Object(l.f)(t,f,p),_=Object(l.f)(t,f,u.a.MAIN_APPLICATION_VIEW);let v=y&&y[s.a.toString(g)]&&y[s.a.toString(g)].isUserView?u.b.userview:u.b.savedview;_&&_[s.a.toString(g)]&&_[s.a.toString(g)].isUserView&&(v=u.b.userview);return e(Object(c.a)(f,p,v,g)).then(e=>{if(!e)throw new i.a("View retrieval failed");return e})}(N,L,e,t,r,x,V,B).then(i=>{M.info("Refreshing the grid with new view id - {0}"+B);const c=Object(n.T)(L,e,t);N(function(e,t,r,n){return Object(a.b)(e,t,"ViewId",r,n)}(e,r,w,t)),function(e,t,r,a,i,c,u,d,h){let p=function(e,t,r,a,i){return e||Object(n.F)(t,r,a,i)}(r,e,i,c,u);const g=Object(n.qb)(e,a,i);if(g&&g.initialized===o.a.Initialized){const r=Object(l.f)(e,p,d),n=r&&r[s.a.toString(a)]&&r[s.a.toString(a)].isUserView;if(p===f.a&&(p=g.entityLogicalName?g.entityLogicalName:p),!g.title){const e=[];e.push({name:"view.title",value:"View title doesn't contains value"}),e.push({name:"ViewId",value:"ViewId: "+a}),e.push({name:"View",value:F(g)}),e.push({name:"entityTypeName",value:p}),h.EventManager.ReportComponentFailure("RefreshGrid",new Error("Title for recent item is null or empty."),"Analyze event parameters to understand why title is empty.",e)}const i={RecordType:C.a.Grid,EntityTypeName:p,LastAccessed:new Date,ObjectId:a,IsUserView:n,Title:g.title};t(Object(I.b)(i))}}(D(),N,x,i,e,t,r,V,k);Object(T.c)(D(),P.L)&&N(Object(j.b)(e,t)),x&&N(function(e,t,r,n){return Object(a.b)(e,t,"TargetEntityType",r,n)}(e,r,x,t)),N(Object(v.b)(e,t)),N(Object(S.b)(e,t,[])),N(Object(O.b)(e,t,null));const E=[];if(x&&E.push({name:"entityName",value:x}),!Object(n.ib)(L,e,t))return k.EventManager.ReportComponentSuccess(R,E),Promise.resolve();N(function(e,t,r,a,i,o){return{type:"chart.refresh.async",execute({dispatch:c,getState:v},S){const O=f.x+".refreshChartAction",I=v();if(!r)return Promise.resolve();if(!Object(m.b)(I))return Promise.resolve();const C=Object(l.c)(I,r);if(!(i=C&&C.entityLogicalName?C.entityLogicalName:null))return Promise.resolve();if(o===u.a.QUICKFIND_SEARCH&&(c(Object(_.c)(e,t,[])),c(Object(y.c)(e,t,"{}"))),!s.a.equals(a,r)){c(Object(_.c)(e,t,[])),c(Object(y.c)(e,t,"{}"));const r=Object(n.r)(I,e,t,i),a=Object(p.a)(I,r),o=a&&a.PrimaryEntityTypeCode,l=o&&Object(g.m)(I,parseInt(o,10));if(l&&i!==l)return c(Object(d.a)(i,b.a.savedvisualization)).then(r=>{let n=s.a.toString(r);return n||(n=s.a.EMPTYGUIDSTRING),c(Object(h.b)(e,t,n)).then(()=>{S.EventManager.ReportComponentSuccess(O)})})}return S.EventManager.ReportComponentSuccess(O),Promise.resolve()}}}(e,t,B,c,x,A)).then(()=>(N(Object(v.b)(e,t)),k.EventManager.ReportComponentSuccess(R,E),Promise.resolve())).catch(e=>(k.EventManager.ReportComponentFailure(R,Error(e)),Promise.resolve()))})}if(Object(n.v)(D(),e,t)){M.info("Refreshing the grid."),N(Object(v.b)(e,t)),N(Object(S.b)(e,t,[])),N(Object(O.b)(e,t,null));const r=[];x&&r.push({name:"entityName",value:x}),k.EventManager.ReportComponentSuccess(R,r)}return Promise.resolve()}catch(e){let t="Refresh action for grid failed";e&&e.message&&(t+="with the error message as : "+e.message),k.EventManager.ReportComponentFailure(R,Error(t))}}}}function F(e){if(!e)return"View is "+e;const t={initialized:e.initialized,viewId:e.viewId,entityLogicalName:e.entityLogicalName,queryApi:e.queryApi,columnXML:e.columnXML,idColumName:e.idColumName,queryType:e.queryType,layoutXML:e.layoutXML,isUserView:e.isUserView,versionNumber:e.versionNumber,OverallVersionNumber:e.OverallVersionNumber,OverallUserVersionNumber:e.OverallUserVersionNumber};return JSON.stringify(t)}},BkgE:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return l}));var n=r("FZDd"),a=r("iZ7K"),i=r("BFlg"),s=r("F7qm"),o=r("LbMF");function c(e){return{type:"grid.retrieveRelatedEntityMetadata.async",execute({dispatch:t,getState:r},i){try{const s=Object(a.h)(r(),e),o={};return u(o,e),Object.keys(s.ManyToManyRelationships).forEach(t=>{const r=s.ManyToManyRelationships[t];if(r.IsValidForAdvancedFind){let t=r.Entity1LogicalName;t===e&&(t=r.Entity2LogicalName),u(o,t)}}),Object.keys(s.OneToManyRelationships).forEach(e=>{const t=s.OneToManyRelationships[e];t.IsValidForAdvancedFind&&u(o,t.ReferencingEntity,t.ReferencingAttribute)}),Object.keys(s.ManyToOneRelationships).forEach(e=>{const t=s.ManyToOneRelationships[e];t.IsValidForAdvancedFind&&(u(o,t.ReferencedEntity),u(o,t.ReferencingEntity,t.ReferencingAttribute))}),t(Object(n.e)(o)).catch(t=>p(e,i,t,"retrieveRelatedEntityMetadata.async","retrieveRelatedEntityMetadata"))}catch(t){return p(e,i,t,"retrieveRelatedEntityMetadata.async","retrieveRelatedEntityMetadata")}}}}function l(e){return{type:"grid.retrieveRelatedEntityRelationshipMetadata.async",execute({getState:t},r){try{let r=[];const n=t(),i=Object(a.h)(n,e),c=[];Object.keys(i.OneToManyRelationships).forEach(e=>{var t,r;const l=i.OneToManyRelationships[e];if(l.IsValidForAdvancedFind){const e=l.ReferencingEntity,i=Object(a.h)(n,e),u=Object(o.a)(n,e,l.ReferencingAttribute);if(i){const e=d(i,1===l.AssociatedMenuConfiguration.Behavior?null!==(t=l.AssociatedMenuConfiguration.Label)&&void 0!==t?t:"":null!==(r=null==u?void 0:u.DisplayName)&&void 0!==r?r:i.DisplayCollectionName),n=h(l,i.DisplayCollectionName,s.RelationshipType.OneToMany);c.push([e,n])}}}),Object.keys(i.ManyToManyRelationships).forEach(e=>{var t,r;const o=i.ManyToManyRelationships[e];if(o.IsValidForAdvancedFind){let e,l,u=!0,h=o.Entity1LogicalName,p=!0;if(h===i.EntityLogicalName?(h=o.Entity2LogicalName,o.IsCustomRelationship&&(u=2!==o.Entity2AssociatedMenuConfiguration.Behavior),l=o.Entity2AssociatedMenuConfiguration.Behavior,e=null!==(t=o.Entity2AssociatedMenuConfiguration.Label)&&void 0!==t?t:"",p=!1):(o.IsCustomRelationship&&(u=2!==o.Entity1AssociatedMenuConfiguration.Behavior),l=o.Entity1AssociatedMenuConfiguration.Behavior,e=null!==(r=o.Entity1AssociatedMenuConfiguration.Label)&&void 0!==r?r:""),u){const t=Object(a.h)(n,h);if(t){const r=d(t,1===l?e:t.DisplayCollectionName);let n;n=p?{displayName:t.DisplayCollectionName,referencedFieldName:i.PrimaryIdAttribute,referencingFieldName:t.PrimaryIdAttribute,relationshipType:s.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:o.IntersectEntityName,entityIntersectIdAttribute:o.Entity2IntersectAttribute,relatedEntityIntersectIdAttribute:o.Entity1IntersectAttribute}:{displayName:t.DisplayCollectionName,referencedFieldName:i.PrimaryIdAttribute,referencingFieldName:t.PrimaryIdAttribute,relationshipType:s.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:o.IntersectEntityName,entityIntersectIdAttribute:o.Entity1IntersectAttribute,relatedEntityIntersectIdAttribute:o.Entity2IntersectAttribute},c.push([r,n])}}if(o.Entity1LogicalName===o.Entity2LogicalName){const e=Object(a.h)(n,o.Entity2LogicalName);if(2!==o.Entity1AssociatedMenuConfiguration.Behavior){const t=d(e,1===o.Entity1AssociatedMenuConfiguration.Behavior?o.Entity1AssociatedMenuConfiguration.Label:e.DisplayCollectionName),r={displayName:e.DisplayCollectionName,referencedFieldName:i.PrimaryIdAttribute,referencingFieldName:e.PrimaryIdAttribute,relationshipType:s.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:o.IntersectEntityName,entityIntersectIdAttribute:o.Entity2IntersectAttribute,relatedEntityIntersectIdAttribute:o.Entity1IntersectAttribute};c.push([t,r])}}}}),Object.keys(i.ManyToOneRelationships).forEach(e=>{var t,r;const l=i.ManyToOneRelationships[e];if(l.IsValidForAdvancedFind){const e=l.ReferencedEntity,u=l.ReferencingAttribute,p=Object(a.h)(n,e),g=Object(o.a)(n,i.EntityLogicalName,u);if(p){const e=h(l,1===l.AssociatedMenuConfiguration.Behavior?null!==(t=l.AssociatedMenuConfiguration.Label)&&void 0!==t?t:"":null!==(r=null==g?void 0:g.DisplayName)&&void 0!==r?r:p.DisplayCollectionName,s.RelationshipType.ManyToOne);c.push([d(p,p.DisplayCollectionName),e])}}});return r=c.sort((e,t)=>{var r,n,a,i;if(!(null===(r=e[1])||void 0===r?void 0:r.displayName)||!(null===(n=t[1])||void 0===n?void 0:n.displayName))return 0;const s=e[1].displayName.localeCompare(t[1].displayName);return 0===s?(null===(a=e[0])||void 0===a?void 0:a.displayName)&&(null===(i=t[0])||void 0===i?void 0:i.displayName)?e[0].displayName.localeCompare(t[0].displayName):0:s}),Promise.resolve(r)}catch(t){return p(e,r,t,"retrieveRelatedEntityRelationshipMetadata.async","retrieveRelationshipMetadata")}}}}function u(e,t,r){e[t]||(e[t]=[]),r&&-1===e[t].indexOf(r)&&e[t].push(r)}function d(e,t){var r;return{metadataId:null===(r=e.Id)||void 0===r?void 0:r.guid,displayName:t,primaryIdField:e.PrimaryIdAttribute,primaryNameField:e.PrimaryNameAttribute,name:e.EntityLogicalName}}function h(e,t,r){return{displayName:t,referencingFieldName:e.ReferencingAttribute,isHierarchical:e.IsHierarchical,relationshipType:r,referencedFieldName:e.ReferencedAttribute}}function p(e,t,r,n,a){const s=[{name:i.k,value:e}];return t.EventManager.ReportComponentFailure(Object(i.G)(n,a),r,null,s),Promise.resolve(null)}},COKI:function(e,t,r){"use strict";r.d(t,"a",(function(){return F}));var n=r("i1f0"),a=r("pF61"),i=r("Sbn7"),s=r("ScMg"),o=r("ldWj"),c=r("TYIz"),l=r("16wZ"),u=r("1kth"),d=r("mhYf"),h=r("PbI6"),p=r("FHmp"),g=r("qshH"),m=r("ZIjf"),b=r("ABCl");let f;class y extends s.a{constructor(e,t,r,n,a,i){Object(l.g)(a,"ClientApi.XrmTab.constructor","parent"),Object(l.g)(e,"ClientApi.XrmTab.constructor","store"),super(e,t,n,r),f=e,this._parent=a,this._formContext=i,this._iConnectedTabProps={tabName:this.name,tabId:this._getTabId(),id:this.pageId,showTab:!0},this._clientApiExecutor=new b.b(f,"ClientApi.XrmTab.",t)}get sections(){const e="ClientApi.XrmTab.sections";try{if(m.a.instance.reportCall(e),!this._sections){this._sections=new i.a(e);const t=f.getState(),r=Object(n.Gc)(t,this.pageId,this.name,this.contextToken);for(let e=0;e<r.Columns.length;e++){const a=Object(n.p)(t,{id:this.pageId,tabName:r.Id,columnIndex:e},this.contextToken);let i=null;for(let e=0;e<a.SectionNames.length;e++)i=new o.a(f,this.contextToken,this.pageId,a.SectionNames[e],this,this._formContext),this._sections.add(i.getName(),i)}}return m.a.instance.reportSuccess(e),this._sections}catch(t){const r=g.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(e,t,null,r),t}}addTabStateChange(e){const t="ClientApi.XrmTab.addTabStateChange";Object(l.g)(e,t,"handler");try{m.a.instance.reportCall(t),f.dispatch(Object(u.s)(this.contextToken,this.pageId,this.name,e)),m.a.instance.reportSuccess(t)}catch(e){const r=g.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(t,e,null,r),e}}removeTabStateChange(e){const t="ClientApi.XrmTab.removeTabStateChange";Object(l.g)(e,t,"handler");try{m.a.instance.reportCall(t),f.dispatch(Object(u.N)(this.contextToken,this.pageId,this.name,e)),m.a.instance.reportSuccess(t)}catch(e){const r=g.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(t,e,null,r),e}}getDisplayState(){const e="ClientApi.XrmTab.getDisplayState";try{m.a.instance.reportCall(e);const t=Object(n.Dc)(f.getState(),this._getTabId(),this.pageId,this.contextToken)?"collapsed":"expanded";return m.a.instance.reportSuccess(e),t}catch(t){const r=g.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(e,t,null,r),t}}getParent(){return m.a.instance.reportUsage("ClientApi.XrmTab.getParent"),this._parent}setDisplayState(e){const t="ClientApi.XrmTab.setDisplayState";try{m.a.instance.reportCall(t);let r=!1;switch(e){case"collapsed":r=!0;break;case"expanded":r=!1;break;default:Object(l.h)(t,"TabDisplayState",e)}r||f.dispatch(Object(c.b)(this.pageId,this._getTabId(),this.contextToken)),m.a.instance.reportSuccess(t)}catch(e){const r=g.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(t,e,null,r),e}}setFocus(){try{m.a.instance.reportCall("ClientApi.XrmTab.setFocus"),f.dispatch(Object(c.b)(this.pageId,this._getTabId(),this.contextToken)),m.a.instance.reportSuccess("ClientApi.XrmTab.setFocus")}catch(e){const t=g.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure("ClientApi.XrmTab.setFocus",e,null,t),e}}setVisible(e){const t="ClientApi.XrmTab.setVisible";try{m.a.instance.reportCall(t),f.dispatch(Object(d.b)(this.pageId,this._getTabId(),this.contextToken,!0===e)),m.a.instance.reportSuccess(t)}catch(e){const r=g.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(t,e,null,r),e}}getLabel(){try{m.a.instance.reportCall("ClientApi.XrmTab.getLabel");const e=Object(n.Hc)(f.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken)||"";return m.a.instance.reportSuccess("ClientApi.XrmTab.getLabel"),e}catch(e){const t=g.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure("ClientApi.XrmTab.getLabel",e,null,t),e}}getVisible(){const e="ClientApi.XrmTab.getVisible";try{m.a.instance.reportCall(e);const t=Object(n.Kc)(f.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken);return m.a.instance.reportSuccess(e),t}catch(t){const r=g.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(e,t,null,r),t}}setLabel(e){const t="ClientApi.XrmTab.setLabel";Object(l.g)(e,t,"label");try{m.a.instance.reportCall(t),f.dispatch(Object(p.b)(this.pageId,this.contextToken,this._getTabId(),e)),m.a.instance.reportSuccess(t)}catch(e){const r=g.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),g.a.getInstance().reportFailure(t,e,null,r),e}}_getTabId(){const e=f.getState(),t=Object(n.Gc)(e,this.pageId,this.name,this.contextToken);if(t&&t.Id)return t.Id}setContentType(e){return this._clientApiExecutor.execute("setContentType",()=>{let t;switch(e){case"default":case"cardSections":t="cardSections";break;case"expandAvailableSpace":case"singleComponent":t="singleComponent";break;default:Object(l.h)("setContentType","TabContentType",e)}f.dispatch(Object(h.b)(this.pageId,this._getTabId(),this.contextToken,t))},[{name:"tabContentType",value:e,isRequired:!0,expectedDataType:"string"}])}getContentType(){return this._clientApiExecutor.execute("getContentType",()=>{var e;return null===(e=Object(n.Jc)(f.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken))||void 0===e?void 0:e.contentType})}}var _=r("SAYH"),v=r("rQHy"),S=r("jRy5"),O=r("y60j"),I=r("arV0"),C=r("3yqi"),j=r("0nOn"),P=r("zmL5"),T=r("jq7Z"),E=r("IaGr");let w;class F{constructor(e,t,r,n,a,i,s){const o=Object(I.l)(e.getState(),r),c=[{name:"store",value:e,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"pageId",value:r,isRequired:!0,isEventParam:!0},{name:"pageType",value:o,isEventParam:!0},{name:"formContext",value:n,isRequired:!0},{name:"entityName",value:a,isEventParam:!0},{name:"formSelectorType",value:s,isRequired:!0}];this._clientApiExecutor=new j.a(e,"ClientApi.XrmFormUIBase.",r,t,c),this._pageId=r,w=e,this._formContext=n,this._entityName=a,this._contextToken=t,this._formSelectorType=s,this.xrmControlFactory=i}get controls(){return this._clientApiExecutor.execute("controls_get",(e,t)=>{if(!this._controls){this._controls=new i.a(e);const r=function(e,t,r){const a=Object(T.b)(w.getState(),e,t),i=Object(P.b)(w.getState(),e),s=_.a.equals(a,i),o=Object(I.l)(w.getState(),e)===C.a.Dialog,c=Object(O.y)(w.getState(),a),l=c&&c.reduce((e,t)=>(e.add(t),e),new Set);return(a,i)=>{const c=Object(n.s)(w.getState(),{controlName:a,id:e},t),u=Object(n.Rc)(w.getState(),e,c);s&&u&&!o?l&&l.has(c.DataFieldName)&&Object(n.fd)(w.getState(),e,c,t)&&r.add(a,i):r.add(a,i)}}(this.pageId,this.contextToken,this._controls),a=this.getFormDescriptor(e,t);if(a){const n={isEventParam:!0,name:"controlName",value:""},i={isEventParam:!0,name:"controlType",value:""};t.push(n),t.push(i);for(const s in a.Controls){const o=a.Controls[s];n.value=s,i.value=o&&o.ClassId?o.ClassId.guid:"";const c=this.xrmControlFactory.createXrmControl(this.contextToken,o,this._formContext,e,t);c&&r(c.getName(),c)}}}return this._controls})}get formSelector(){return this._clientApiExecutor.execute("formSelector_get",(e,t)=>{if(!this._formSelector){const r=this.getFormDescriptor(e,t);r&&(this._formSelector=new this._formSelectorType(w,this._contextToken,r.Id,this._entityName,this._pageId))}return this._formSelector})}get tabs(){return this._clientApiExecutor.execute("tabs_get",(e,t)=>{if(!this._tabs){this._tabs=new i.a(e);const r=this.getFormDescriptor(e,t);if(r){const e=r.Tabs;for(const t in e){const r=new y(w,this._contextToken,e[t].Name,this._pageId,this,this._formContext);this._tabs.add(r.getName(),r)}}}return this._tabs})}get pageId(){return this._pageId}refreshRibbon(e=!1){this._clientApiExecutor.executeAsync("refreshRibbon",()=>w.dispatch(Object(v.a)(this._pageId,null,e)))}get contextToken(){return this._contextToken}get formContext(){return this._clientApiExecutor.execute("formContext",()=>this._formContext)}getControls(){if(!this._controls&&this.contextToken.contextTokenType===S.a.GridRow){const e=this._clientApiExecutor.getComponentName("getControls");return this._controls=new i.a(e),this._controls}return this.controls}getFormDescriptor(e,t){const r=Object(n.fb)(w.getState(),{id:this._pageId},this._contextToken);if(!r){const r="Form descriptor not found";if(Object(a.n)(w.getState(),this._pageId))E.a.getInstance().traceManager.getTracer(e).error(r+": Page is dead",t);else if(this.contextToken.contextTokenType===S.a.GridRow)E.a.getInstance().traceManager.getTracer(e).error(r,t);else{if(!this._clientApiExecutor.isPageReadyForClientAPIAccess())return null;const n=new Error(r);this._clientApiExecutor.reportFailure(e,n,t)}}return r}}},CbNq:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"c",(function(){return s})),r.d(t,"b",(function(){return o})),r.d(t,"d",(function(){return c}));var n=r("P6DH");function a(e){const t=Object(n.m)(e),r=e&&e.metadata?e.metadata.entities:null,a=[];return r?(t.forEach(e=>{if(4200!==r[e].ObjectTypeCode){const t=function(e){const t=e.DisplayName,r=e.ObjectTypeCode.toString();return{entityDisplayName:t,objectTypeCode:r}}(r[e]);a.push(t)}}),a.sort(i)):a}function i(e,t){const r=e.entityDisplayName,n=t.entityDisplayName;let a=0;return r>n?a=1:r<n&&(a=-1),a}function s(e){const t=[];for(let r=0;r<e.length;r++){const n={key:e[r].objectTypeCode,text:e[r].entityDisplayName};t.push(n)}return t}function o(e){return e?e.split(","):[]}function c(e){return e?e.map(e=>({key:e.value,text:e.text})):[]}},Co7m:function(e,t,r){"use strict";r.d(t,"a",(function(){return F}));var n=r("TAjd"),a=r("SAYH"),i=r("504W"),s=r("WPtp"),o=r("CPoS"),c=r("5Oca"),l=r("+nNZ"),u=r("odYE"),d=r("0PSL"),h=r("23K5"),p=r("bJaF"),g=r("KGWS"),m=r("ccIw"),b=r("arV0"),f=r("rodW"),y=r("eXjw"),_=r("k1f1"),v=r("AFlp"),S=r("c7jw"),O=r("53SR"),I=r("PUjk"),C=r("i1f0"),j=r("7LBy"),P=r("2Ct/"),T=r("iZ7K"),E=r("D4Jo"),w=r("JF0K");class F{static get Instance(){return F._instance||(F._instance=new F,Object(I.c)(F._instance)),F._instance}init(e,t,n){return this._getState&&this._businessProcessPerPageWrapper?Promise.resolve():(this._applicationContext=e,this._reloadDataCount=0,this._getState=t,this._dispatch=n,this._processManager=new p.a(e,t,n,new m.a,new g.a),this._businessProcessFlowWrapperIdentifierFactory=new h.a,this._businessProcessFlowWrapperFactory=new d.a(t,this._businessProcessFlowWrapperIdentifierFactory,e),r.e(48).then(r.bind(null,"esKF")).then(({BusinessProcessPageWrapper:e})=>(this._businessProcessPerPageWrapper=new e(this._applicationContext,this._getState,this._dispatch),Promise.resolve())))}getBusinessProcessFlowWrapper(e,t){return Object(P.f)(this._getState())?this._businessProcessPerPageWrapper.getBusinessProcessFlowWrapper(e,t):(this._reloadDataIfRequired(e,t),this._businessProcessFlowWrapperFactory.generate(e,this._processManager))}getProcessManager(e,t){return Object(P.f)(this._getState())?this._businessProcessPerPageWrapper.getProcessManager(e,t):(this._reloadDataIfRequired(e,t),this._processManager)}getCurrentProcessManagerWithoutInit(e){if(!Object(P.f)(this._getState()))return this._processManager;if(this._businessProcessPerPageWrapper)return this._businessProcessPerPageWrapper.getCurrentProcessManagerWithoutInit(e);const t=Object(b.g)(this._getState(),e),r=t&&t.entityTypeName?new u.a(t.entityTypeName,t.id):null,n=this._applicationContext.TraceManager.getTracer("BusinessProcessWrapperManager.GetProcessManagerWithoutinit"),a=Object(E.a)(this._getState(),r,e,this._applicationContext);return n.warn("BusinessProcessWrapperManager: BusinessProcessPerPageWrapper is not initialized",a),null}hasChanged(e,t,r,n){if(!Object(P.f)(this._getState())){if(Object(P.g)(e)&&(!Object(P.d)(e)||Object(P.c)(e,n)))return!0;if(!t)return!1;const a=new u.a(t.entityTypeName,t.id),s=Object(l.f)(e,a);return!Object(i.a)(s)&&(!r||s>r.instanceModifiedTimestamp)||this._needsDockedModeRefresh(r,t)}return this._businessProcessPerPageWrapper.hasChanged(e,t,r,n)}_needsDockedModeRefresh(e,t){return this._processManager.getDisplayState()===n.a.expanded&&e.isFormInactive!==Object(C.Lb)(this._getState(),t.entityTypeName,t.id)}_reloadData(e,t){const r=this._getState();this._pageId=e,this._pageInfo=t;const n=Object(b.g)(r,e);if(!n)return;const d=n.id,h=new u.a(n.entityTypeName,d);if(this._processIdInState=Object(c.e)(r,h),Object(P.g)(r)&&(!Object(P.d)(r)||Object(P.c)(r,e))){const t=this._processManager.getTelemetryParams();return this._processManager.isVisible()&&this._processManager.setVisible(!1),this._processManager.initilaizeWithFormEntityOnly(h,e),void Object(E.c)(w.e,t,this._applicationContext)}const p=Object(j.a)(n),g=Object(j.b)(n);if(a.a.equals(h.id,a.a.EMPTY)&&p&&g){const t=Object(o.b)(r,p),a=new u.a(t.businessProcessFlowUniqueName,g),s=Object(l.b)(r,a);return Object(i.a)(this._lastPageEntityFromCrossEntity)||Object(i.a)(h)||this._lastPageEntityFromCrossEntity.etn===h.etn||this._moveToNextStageForCrossEntityBPF(s,n),void this._processManager.initilaizeWithProcessAndFormEntity(s,t,h,p,a,e)}if(this._processIdInState){const t=Object(o.b)(r,this._processIdInState);if(!Object(i.a)(t)&&Object(y.b)(t.initialized)){const n=new u.a(t.businessProcessFlowUniqueName,Object(c.f)(r,h)),o=Object(l.b)(r,n);if(a.a.equals(h.id,a.a.EMPTY)){const r=Object(P.b)(t);if(this._lastPageIdInNewForm!==e&&(this._lastPageIdInNewForm=e,this._dispatch(Object(O.a)(null,n))),r&&r.stage&&r.stage.stageId){const a=Object(P.a)(r);return this._dispatch(Object(S.b)(n,a)),void this._processManager.initilaizeWithProcessAndFormEntity(a.fields,t,h,this._processIdInState,n,e)}}else if(Object(i.a)(o))return;const d=Object(T.h)(r,h.etn);if(d&&d.IsBPFEntity)return void this._processManager.initilaizeWithProcessAndFormEntity(o,t,h,this._processIdInState,n,e);for(const r in o)if(Object(s.k)(o[r])&&o[r].reference&&o[r].reference.id&&o[r].reference.etn===h.etn&&(a.a.equals(o[r].reference.id,h.id)||a.a.equals(o[r].reference.id,a.a.EMPTY))&&Object(P.e)(r))return void this._processManager.initilaizeWithProcessAndFormEntity(o,t,h,this._processIdInState,n,e);const p=this._dispatch(Object(_.b)(a.a.EMPTY,h)),g=this._dispatch(Object(v.b)(a.a.EMPTY,h));Promise.all([p,g]).then(t=>{this._processManager.initilaizeWithFormEntityOnly(h,e)})}else this._processManager.initilaizeWithFormEntityOnly(h,e)}else this._processManager.initilaizeWithFormEntityOnly(h,e)}_reloadDataIfRequired(e,t){const r=this._getState(),n=this._processManager.getCurrentFormEntity();this._lastPageEntityFromCrossEntity=n;let i=null,s=!1;if(n&&(i=Object(c.b)(n)(r,n.etn),i&&(s=i.refreshGlobalNavigationData)),!Object(P.g)(r)&&(!this._pageInfo||!a.a.equals(this._pageInfo.id,t.id)||this._pageId!==e||this._hasProcessChanged(t)||s)||Object(P.g)(r)&&this._processManager.getProcessId()){if(i&&i.refreshGlobalNavigationData&&this._dispatch(Object(f.b)(!1,n)),this._reloadDataCount<30)this._reloadData(e,t);else if(this._pageId!==e&&(this._reloadDataCount=0),30===this._reloadDataCount){const e=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ReachMaxBpfReloadDataCount"),t=this._processManager.getTelemetryParams();e.error("Max BPF reloadData count reached limit of 30. Root cause may be infinite loop when rendering the ProcessControl.",t)}this._reloadDataCount++}else this._reloadDataCount=0}_hasProcessChanged(e){const t=this._processIdInState||a.a.EMPTY,r=this._getState(),n=new u.a(e.entityTypeName,e.id),i=Object(b.g)(r,this._pageId),s=Object(j.a)(i),l=a.a.equals(n.id,a.a.EMPTY)&&s?s:Object(c.e)(r,n)||a.a.EMPTY;if(!a.a.equals(l,t))return!0;if(a.a.equals(l,a.a.EMPTY))return!1;const d=Object(o.b)(r,l);return!!d&&this._processManager.getVersion()<d.businessProcessFlowProcessVersion}_moveToNextStageForCrossEntityBPF(e,t){const r=e.activestageid,n=e.traversedpath;let i=t.data.nextStageId;if(!i){const e=Object(j.a)(t),r=Object(j.b)(t);if(!a.a.equals(e,this._processManager.getProcessId())||!a.a.equals(r,this._processManager.getProcessInstanceId()))return;i=this._processManager.getStageMetadata().getNextStageId(this._processManager.getActiveStageId())}if(!a.a.equals(r.reference.id,new a.a(i))){r.reference=new u.a("processstage",new a.a(i)),n.value=n.value+","+i;e.activestagestartedon.value=new Date}}}},D4Jo:function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"c",(function(){return p})),r.d(t,"b",(function(){return g}));var n=r("VcAV"),a=r("Uv1Y"),i=r("bT7G"),s=r("JF0K"),o=r("SAYH"),c=r("5Oca"),l=r("+nNZ"),u=r("arV0"),d=r("504W");function h(e,t,r,n){const a=[];try{const n=t&&Object(c.e)(e,t)?Object(c.e)(e,t):o.a.EMPTY,i=t&&Object(c.f)(e,t)?Object(c.f)(e,t):o.a.EMPTY,s=n&&!o.a.equals(n,o.a.EMPTY)?function(e,t){const r=Object(l.a)(e,t);if(r)return r.businessProcessFlowProcessState;return null}(e,n):0,d=Object(u.l)(e,r),h={name:"ProcessId",value:n?o.a.toString(n):o.a.EMPTYGUIDSTRING},p={name:"ProcessInstanceId",value:i?o.a.toString(i):o.a.EMPTYGUIDSTRING},g={name:"CurrentFormEntityType",value:t&&t.etn?t.etn:""},m={name:"CurrentFormEntityId",value:t&&t.id?o.a.toString(t.id):""},b={name:"ProcessState",value:s},f={name:"PageId",value:r||""},y={name:"PageType",value:d};a.push(h),a.push(p),a.push(g),a.push(m),a.push(b),a.push(f),a.push(y)}catch(e){n.TraceManager.getTracer("BusinessProcessFlow.TelemetryGeneration").error("Exception while generating businessprocess telemetry parameters: "+e.message,a)}return a}function p(e,t,r){r.EventManager.ReportComponentSuccess(e,t)}function g(e,t,r,o,c,l,u){!function(e,t){if(!Object(n.c)(e)){const r=Object(a.c)(e);if(!Object(n.c)(r)){const e=r.errorCode;if(!Object(n.c)(e)){const r={name:"ErrorCode",value:"0x"+e.toString(16)};t.push(r)}}}}(t,o),function(e,t,r,o){if(!Object(n.c)(e)){const c=Object(a.c)(e);if(!Object(n.c)(c)&&!Object(n.c)(c.FaultedSnapshotId)){const e={name:s.p,value:c.FaultedSnapshotId};if(t.push(e),!Object(n.c)(r)&&!Object(n.c)(o)){const e=Object(i.c)(o,r);if(!Object(n.c)(e)){const r=e.snapshotId;if(!Object(n.c)(r)&&!Object(d.b)(r)&&r===c.FaultedSnapshotId){const e={name:s.q,value:"serverSideCurrentForm"};t.push(e)}}}}}}(t,o,l,u),c.EventManager.ReportComponentFailure(e,t,r,o)}},DAWX:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class n{get_ErrorType(){return this._errorType}set_ErrorType(e){this._errorType=e}get_ErrorDescription(){return this._errorDescription}set_ErrorDescription(e){this._errorDescription=e}}},DU8S:function(e,t,r){"use strict";r.d(t,"c",(function(){return o})),r.d(t,"e",(function(){return c})),r.d(t,"b",(function(){return l})),r.d(t,"a",(function(){return u})),r.d(t,"d",(function(){return d}));var n=r("9A3e"),a=r("VDDv"),i=r("VkXQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="customcontrol.propertybag.device.isoperationavailable";function o(){return{type:s,execute:(e,t)=>new n.a(t,e).isOperationAvailable(i.b.getBarcodeValue.name),sync:!0}}function c(){return{type:s,execute:(e,t)=>new a.a(t,e).isOperationAvailable(i.f.takePicture.name),sync:!0}}function l(){return{type:s,execute:(e,t)=>new a.a(t,e).isOperationAvailable(i.f.captureVideo.name),sync:!0}}function u(){return{type:s,execute:(e,t)=>new a.a(t,e).isOperationAvailable(i.f.captureAudio.name),sync:!0}}function d(){return{type:s,execute:()=>!1,sync:!0}}},E6o7:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return o}));var n=r("dHD5"),a=r("jAuy"),i=r("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="dataset.update.fetchxml";function o(e,t,r){return{type:"dataset.update.fetchxml.async",execute({dispatch:o,getState:c},l){const u=l.TraceManager.getTracer(i.z),d=i.x+".updateFetchXMLAction";try{u.info("Updating the fetch xml for the grid."),o(function(e,t,r){const a=Object(n.y)(t),i=Object(n.v)(t);return{type:s,payload:r,meta:{pageId:e,contextKey:a,dataSetContextKey:i}}}(e,t,r));const i=Object(a.j)(r),c=[];return c.push({name:"fetchXML",value:i}),l.EventManager.ReportComponentSuccess(d,c),Promise.resolve()}catch(e){const r="Updating the fetchxml for the grid with contextKey : "+Object(n.v)(t)+" failed with the error : "+e.message;l.EventManager.ReportComponentFailure(d,Error(r))}}}}},EOIL:function(e,t,r){"use strict";r.d(t,"a",(function(){return ee}));var n=r("0nOn"),a=r("i1f0"),i=r("ZIjf"),s=r("Sbn7"),o=r("Bj/n"),c=r("jTSi"),l=r("9NSo"),u=r("SAYH"),d=r("uOtn"),h=r("+zjj"),p=r("N+Ya"),g=r("dIqG"),m=r("16wZ"),b=r("qshH"),f=r("meVR"),y=r("TYIz"),_=r("dHD5");var v=r("IqkD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let S;class O{constructor(e,t,r,n){const a="ClientApi.XrmNavigationItem.constructor";e||Object(m.j)(a,"store"),r||Object(m.j)(a,"pageId"),t||Object(m.j)(a,"contextToken"),Object(m.a)(n)&&Object(m.j)(a,"id"),S=e,this._pageId=r,this._id=n,this._contextToken=t}getId(){return i.a.instance.reportUsage("ClientApi.XrmNavigationItem.getId"),this._id}getLabel(){const e="ClientApi.XrmNavigationItem.getLabel";try{i.a.instance.reportCall(e);const t=Object(a.Rb)(S.getState(),this._pageId,this._id);return i.a.instance.reportSuccess(e),t}catch(t){const r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}}getVisible(){const e="ClientApi.XrmNavigationItem.getVisible";try{i.a.instance.reportCall(e);const t=Object(a.Ub)(S.getState(),this._pageId,this._id);return i.a.instance.reportSuccess(e),t}catch(t){const r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}}setFocus(){const e="ClientApi.XrmNavigationItem.setFocus";try{i.a.instance.reportCall(e),S.dispatch((t=this._pageId,r=this._contextToken,n=this._id,{type:"forms.selectnavigationtab",sync:!0,execute({dispatch:e,getState:a},i,s){const o=Object(h.d)(a(),t,n);if(o){o.isSelected=!0;const n=Object(_.a)(r,o.relationshipName,o.ordinal);e(Object(y.b)(t,void 0,r)),e(Object(f.a)(t,n,o))}else i.TraceManager.getTracer("Forms.SelectNavigationTab").error("Could not find relatedEntityInfo to select")}})),i.a.instance.reportSuccess(e)}catch(t){const r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}var t,r,n}setLabel(e){const t="ClientApi.XrmNavigationItem.setLabel";try{if(i.a.instance.reportCall(t),!Object(m.a)(e)){const t=Object(v.s)(S.getState());S.dispatch(Object(p.b)(this._pageId,this._id,e,t))}i.a.instance.reportSuccess(t)}catch(e){const r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,r),e}}setVisible(e){const t="ClientApi.XrmNavigationItem.setVisible";try{i.a.instance.reportCall(t),S.dispatch(Object(g.b)(this._pageId,this._id,!0===e)),i.a.instance.reportSuccess(t)}catch(e){const r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,r),e}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let I;class C{constructor(e,t,r){r||Object(m.j)("ClientApi.XrmFormNavigation.constructor","pageId"),e||Object(m.j)("ClientApi.XrmFormNavigation.constructor","store"),I=e,this._pageId=r,this._contextToken=t}get items(){const e="ClientApi.XrmFormNavigation.items";try{if(i.a.instance.reportCall(e),!this._items){this._items=new s.a(e);const t=Object(h.f)()(I.getState(),{id:this._pageId});t&&t.forEach(e=>{e&&e.relatedItems&&e.relatedItems.forEach(e=>{e&&e.id&&this._items.add(e.id,new O(I,this._contextToken,this._pageId,e.id))})})}return i.a.instance.reportSuccess(e),this._items}catch(t){const r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}}}var j=r("ldWj"),P=r("PidC"),T=r("4U8P"),E=r("NtHU"),w=r("FhIR"),F=r("ABCl");let x;class A extends j.a{constructor(e,t,r,n){super(e,t,r,A.NAME,null,n),x=e,this._clientApiExecutor=new F.b(x,"ClientApi.XrmHeaderSection.",t)}getLabel(){return i.a.instance.reportUsage("ClientApi.XrmHeaderSection.getLabel"),""}getVisible(){return i.a.instance.reportUsage("ClientApi.XrmHeaderSection.getVisible"),!0}setLabel(e){i.a.instance.reportUsage("ClientApi.XrmHeaderSection.setLabel")}setVisible(e){i.a.instance.reportUsage("ClientApi.XrmHeaderSection.setVisible")}getControlsDescriptor(e){const t=Object(a.tb)(e,{id:this.pageId},this.contextToken),r={};if(t)for(let e=0;e<t.length;e++){const n=t[e];r[n.Name]=n}return r}setCommandBarVisible(e){this._clientApiExecutor.execute("setCommandBarVisible",()=>{x.dispatch(Object(T.b)(this.pageId,this.contextToken,e))},[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])}getCommandBarVisible(){return this._clientApiExecutor.execute("getCommandBarVisible",()=>{var e;return null===(e=Object(P.f)(x.getState(),this.pageId,this.contextToken))||void 0===e?void 0:e.commandBarVisible})}setBodyVisible(e){this._clientApiExecutor.execute("setBodyVisible",()=>{x.dispatch(Object(E.b)(this.pageId,this.contextToken,e))},[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])}getBodyVisible(){return this._clientApiExecutor.execute("getCommandBarVisible",()=>{var e;return null===(e=Object(P.f)(x.getState(),this.pageId,this.contextToken))||void 0===e?void 0:e.bodyVisible})}setTabNavigatorVisible(e){this._clientApiExecutor.execute("setTabNavigatorVisible",()=>{x.dispatch(Object(w.b)(this.pageId,this.contextToken,e))},[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])}getTabNavigatorVisible(){return this._clientApiExecutor.execute("getTabNavigatorVisible",()=>{var e;return null===(e=Object(P.f)(x.getState(),this.pageId,this.contextToken))||void 0===e?void 0:e.tabNavigatorVisible})}}A.NAME="Header";var N=r("5iTp"),D=r("m+2h");let k;class M extends j.a{constructor(e,t,r,n){super(e,t,r,M.NAME,null,n),k=e,this._clientApiExecutor=new F.b(k,"ClientApi.XrmFooterSection.",t)}getLabel(){return i.a.instance.reportUsage("ClientApi.XrmFooterSection.getLabel"),""}getVisible(){return this._clientApiExecutor.execute("getVisible",()=>{var e;return null===(e=Object(N.a)(k.getState(),this.pageId,this.contextToken))||void 0===e?void 0:e.visible})}setLabel(e){i.a.instance.reportUsage("ClientApi.XrmFooterSection.setLabel")}setVisible(e){this._clientApiExecutor.execute("setVisible",()=>{k.dispatch(Object(D.b)(this.pageId,this.contextToken,e))},[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])}getControlsDescriptor(e){const t=Object(a.Z)(e,{id:this.pageId},this.contextToken),r={};if(t)for(let e=0;e<t.length;e++){const n=t[e];r[n.Name]=n}return r}}M.NAME="Footer";var R=r("gQ5I"),L=r("arV0"),B=r("PUjk"),V=r("r/aD"),G=r("bpBl"),U=r("IaGr");let X;class z{constructor(e,t,r,n){const a="ClientApi.XrmProcessControlUI.constructor";n||Object(m.j)(a,"entity"),t||Object(m.j)(a,"contextToken"),r||Object(m.j)(a,"pageId"),e||Object(m.j)(a,"store"),X=e,this._pageId=r;let i=!1;if(Object(V.d)(X.getState(),this._pageId,a)){const e=Object(L.g)(X.getState(),this._pageId);this._processManager=Object(B.b)(this._pageId,e),i=!0}this._contextToken=t;const s=Object(V.b)(r,e.getState(),i);U.a.getInstance().eventManager.ReportComponentSuccess(a,s)}getDisplayState(){const e="ClientApi.XrmProcessControlUI.getDisplayState";try{if(i.a.instance.reportCall(e),!Object(V.d)(X.getState(),this._pageId,e))return i.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getDisplayState();return i.a.instance.reportSuccess(e),t}catch(t){const r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}}getVisible(){const e="ClientApi.XrmProcessControlUI.getVisible";try{if(i.a.instance.reportCall(e),!Object(V.d)(X.getState(),this._pageId,e))return i.a.instance.reportSuccess(e),!1;const t=this._getProcessManager().isVisible();return i.a.instance.reportSuccess(e),t}catch(t){const r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}}setDisplayState(e){const t="ClientApi.XrmProcessControlUI.setDisplayState";try{if(i.a.instance.reportCall(t),!Object(V.d)(X.getState(),this._pageId,t))return void i.a.instance.reportSuccess(t);e!==G.a.collapsed&&e!==G.a.expanded&&e!==G.a.floating||this._getProcessManager().setDisplayState(e),i.a.instance.reportSuccess(t)}catch(e){const r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,r),e}}setVisible(e){const t="ClientApi.XrmProcessControlUI.setVisible";try{if(i.a.instance.reportCall(t),!Object(V.d)(X.getState(),this._pageId,t))return void i.a.instance.reportSuccess(t);this._getProcessManager().setVisible(e),i.a.instance.reportSuccess(t)}catch(e){const r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,r),e}}reflow(e,t,r){const n="ClientApi.XrmProcessControlUI.reflow";try{if(i.a.instance.reportCall(n),!Object(V.d)(X.getState(),this._pageId,n))return void i.a.instance.reportSuccess(n);this._getProcessManager().reflow(e,t,r),i.a.instance.reportSuccess(n)}catch(e){const t=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(n,e,null,t),e}}_getProcessManager(){return this._processManager||(this._processManager=Object(V.c)(this._processManager,X,this._pageId,"ClientApi.XrmProcessControlUI.getProcessManager")),this._processManager}}var q=r("1kth"),H=r("uNLT"),W=r("bT7G"),Y=r("Dea/"),Q=r("Fij2"),K=r("pF61"),J=r("COKI"),Z=r("zJiL");let $;class ee extends J.a{constructor(e,t,r,a,i,s){$=e,super(e,t,r,a,i,s,d.a),this._clientApiExecutorFormUI=new n.a(e,"ClientApi.XrmFormUI.",r,t),this._clientApiExecutorFormUI.addEventParameter({name:"entityName",value:i,isEventParam:!0})}get headerSection(){const e="ClientApi.XrmFormUI.headerSection";try{return i.a.instance.reportCall(e),this._headerSection||(this._headerSection=new A($,this.contextToken,this.pageId,this.formContext)),i.a.instance.reportSuccess(e),this._headerSection}catch(t){throw this._reportFailure(e,t)}}get footerSection(){const e="ClientApi.XrmFormUI.footerSection";try{return i.a.instance.reportCall(e),this._footerSection||(this._footerSection=new M($,this.contextToken,this.pageId,this.formContext)),i.a.instance.reportSuccess(e),this._footerSection}catch(t){throw this._reportFailure(e,t)}}addControls(e){const t=b.a.getInstance().getEventParameters(this.contextToken),r={name:"controlName",value:""};t.push(r);for(const n in e)if(e[n]){r.value=n;const a=this.xrmControlFactory.createXrmControl(this.contextToken,e[n],this.formContext,"ClientApi.XrmFormUI.addControls",t);a&&this.controls.add(a.getName(),a)}}get navigation(){const e="ClientApi.XrmFormUI.navigation";try{return i.a.instance.reportCall(e),this._navigation||(this._navigation=new C($,this.contextToken,this.pageId)),i.a.instance.reportSuccess(e),this._navigation}catch(t){throw this._reportFailure(e,t)}}get process(){const e="ClientApi.XrmFormUI.process_get";try{i.a.instance.reportCall(e);const t=!!this._process;!this._process&&this.formContext.data&&this.formContext.data.entity&&(this._process=new z($,this.contextToken,this.pageId,this.formContext.data.entity));const r=Object(V.a)(this.pageId,$.getState(),t,!(!this.formContext.data||!this.formContext.data.entity));return U.a.getInstance().eventManager.ReportComponentSuccess(e,r),i.a.instance.reportSuccess(e),this._process}catch(t){throw this._reportFailure(e,t)}}set process(e){const t=Object(V.a)(this.pageId,$.getState(),!!this._process,!(!this.formContext.data||!this.formContext.data.entity));U.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmFormUI.process_set",t),this._process=e}get quickForms(){const e="ClientApi.XrmFormUI.quickForms";try{return i.a.instance.reportCall(e),this._quickForms||(this._quickForms=new s.a(e),this.controls),i.a.instance.reportSuccess(e),this._quickForms}catch(t){throw this._reportFailure(e,t)}}clearFormNotification(e){const t="ClientApi.XrmFormUI.clearFormNotification";try{i.a.instance.reportCall(t);const r=$.dispatch(Object(c.b)(this.contextToken,this.pageId,e));return i.a.instance.reportSuccess(t),r}catch(e){throw this._reportFailure(t,e)}}close(){try{i.a.instance.reportCall("ClientApi.XrmFormUI.close"),Object(Q.a)(Object(K.b)($.getState())===this.pageId)||$.dispatch(Object(R.e)(this.pageId)),i.a.instance.reportSuccess("ClientApi.XrmFormUI.close")}catch(e){throw this._reportFailure("ClientApi.XrmFormUI.close",e)}}getFormType(){return this._clientApiExecutorFormUI.execute("getFormType",(e,t)=>{const r=this.getFormDescriptor(e,t);if(r){const n=this.formContext;if(n&&n.data&&n.data.entity&&Object(a.Lb)($.getState(),n.data.entity.getEntityName(),u.a.tryParse(n.data.entity.getId())))return 4;if(Object(a.kb)($.getState(),{id:this.pageId},this.contextToken))return 3;if(6===r.FormType)return 3;const i=Object(a.ac)($.getState(),this.pageId,this.contextToken);if(i){const r=Object(W.b)($.getState(),i);return r?r.mode===Y.a.Create?1:2:(t.push({name:"snapshotID",value:i}),this._clientApiExecutorFormUI.reportFailure(e+".getSnapshot",new Error("Snapshot is null or undefined"),t),0)}return n&&n.data&&n.data.entity&&!u.a.tryParseOrNull(n.data.entity.getId())?1:2}return 0})}isDialog(){return this._clientApiExecutorFormUI.execute("isDialog",()=>Object(L.f)($.getState(),this.pageId))}getViewPortHeight(){const e="ClientApi.XrmFormUI.getViewPortHeight";try{i.a.instance.reportCall(e);const t=Object(a.qb)($.getState(),{id:this.pageId},this.contextToken);return i.a.instance.reportSuccess(e),t}catch(t){throw this._reportFailure(e,t)}}getViewPortWidth(){const e="ClientApi.XrmFormUI.getViewPortWidth";try{i.a.instance.reportCall(e);const t=Object(a.rb)($.getState(),{id:this.pageId},this.contextToken);return i.a.instance.reportSuccess(e),t}catch(t){throw this._reportFailure(e,t)}}setFormEntityName(e){const t="ClientApi.XrmFormUI.setFormEntityName";Object(m.g)(e,t,"name");try{i.a.instance.reportCall(t),$.dispatch(Object(l.b)(this.pageId,this.contextToken,e)),i.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}}setFormNotification(e,t,r,n,a){return this._clientApiExecutorFormUI.execute("setFormNotification",(i,s)=>{let c;switch(Object(m.a)(r)&&(r="Random_String_"+Math.random()),t){case"ERROR":c=Z.a;break;case"WARNING":c=Z.e;break;case"INFORMATION":case"INFO":c=Z.b;break;default:Object(m.h)(i,"notificationLevel",t,s)}return!Object(m.a)(e)&&"string"==typeof e&&($.dispatch(Object(o.c)(this.contextToken,this.pageId,e,c,r,n,a)),!0)})}addOnLoad(e){const t="ClientApi.XrmFormUI.addOnLoad";Object(m.g)(e,t,"handler");try{i.a.instance.reportCall(t),$.dispatch(Object(q.f)(this.contextToken,this.pageId,e)),i.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}}removeOnLoad(e){const t="ClientApi.XrmFormUI.removeOnLoad";Object(m.g)(e,t,"handler");try{i.a.instance.reportCall(t),$.dispatch(Object(q.A)(this.contextToken,this.pageId,e)),i.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}}refresh(){const e="ClientApi.XrmFormUI.refresh";try{i.a.instance.reportCall(e);const t=Object(L.l)($.getState(),this.pageId);return $.dispatch(Object(H.f)(this.pageId,t,!0,1,!0,!0)).then(t=>(Object(Q.b)(this.formContext.data.entity),i.a.instance.reportSuccess(e),t)).catch(t=>{const r=b.a.getInstance().getEventParameters(this.contextToken);return Object(m.d)($,t,e+".saveFormAndNavigate",r)})}catch(t){const r=b.a.getInstance().getEventParameters(this.contextToken);return Object(m.d)($,t,e,r)}}_reportFailure(e,t){const r=b.a.getInstance().getEventParameters(this.contextToken);return b.a.getInstance().reportFailure(e,t,null,r),t}}},EOZU:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return l}));var n=r("d4He"),a=r("ATZz"),i=r("fU7K"),s=r("9eA9");const o=["app.powerbi.com","msit.powerbi.com","app.powerbigov.us","app.high.powerbigov.us","app.mil.powerbigov.us","app.powerbi.cn","powerbi-df.analysis-df.windows.net"];function c(e){return{type:"dashboard.openinpowerbi",execute({dispatch:t,getState:r}){const n=Object(a.a)(r(),e);return n?t(l(n.TileUrl,n.Type,n.PowerBIGroupId,n.PowerBIDashboardId,null,n.PowerBIReportId)):Promise.resolve()}}}function l(e,t,r,a,c,l){return{type:"powerbi.openInPowerBICore",execute({dispatch:u},d){const h=d.TraceManager.getTracer("PowerBI"),{hostname:p,pathname:g,searchParams:m}=new s.a(e);let b="app.powerbi.com";-1!==o.indexOf(p)?b=p:h.error("Invalid PowerBI domain, using "+b,[{name:"PowerBIDomain",value:p}]);const f=new s.a(`https://${b}/MobileRedirect.html`),y=f.searchParams;let _;switch(t){case"0":_="OpenTile",y.set("tileObjectId",Object(i.CrmUrlEncode)(c));case"1":_=_||"OpenDashboard",y.set("dashboardObjectId",Object(i.CrmUrlEncode)(a));break;case"2":_=(null==g?void 0:g.endsWith("rdlEmbed"))?"OpenRdlReport":"OpenReport",y.set("reportObjectId",Object(i.CrmUrlEncode)(l));const e=m.get("pageName");e&&y.set("reportPage",Object(i.CrmUrlEncode)(e));break;default:return h.error("Invalid PowerBIObjectType",[{name:"PowerBIObjectType",value:t}]),Promise.reject("Invalid PowerBIObjectType: "+t)}return y.set("action",_),r&&y.set("groupObjectId",Object(i.CrmUrlEncode)(r)),u(Object(n.a)(f.toString())),Promise.resolve()}}}},FHmp:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="tab.setlabel";function i(e,t,r,i){const s=Object(n.v)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:s,tabId:r}}}},FhIR:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="header.tabnavigatorvisible";function i(e,t,r){const i=Object(n.v)(t);return{type:a,payload:r,meta:{pageId:e,contextKey:i}}}},G0J3:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("ghNp"),a=r("i1f0"),i=r("0nOn");let s;class o{constructor(e,t,r,a,o,c){this._clientApiExecutor=new i.a(e,"ClientApi.XrmFormBase.",a,r,[{name:"store",value:e,isRequired:!0},{name:"entityName",value:this._entityName,isEventParam:!0},{name:"pageId",value:a,isRequired:!0,isEventParam:!0},{name:"contextToken",value:r,isRequired:!0},{name:"getUiType",value:o,isRequired:!0}]),s=e,this.pageId=a,this.contextToken=r,this._entityName=t,this._getUiType=o,this._xrmControlFactory=c,s.dispatch(Object(n.a)(this,a,r))}get ui(){return this._clientApiExecutor.execute("ui_get",()=>{if(!this._ui){const e={id:this.pageId},t=Object(a.fb)(s.getState(),e,this.contextToken),r=t&&t.FormType,n=this._getUiType(r);this._ui=new n(s,this.contextToken,this.pageId,this,this._entityName,this._xrmControlFactory)}return this._ui})}getControl(e){const t=[{name:"entityName",value:this._entityName,isRequired:!1,isEventParam:!0}];return this._clientApiExecutor.execute("getControl",()=>this.ui.controls.get(e),t)}}},GodX:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("2YQW"),a=r("jsFU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i=Object(n.d)({[a.a]:function(e,t){return Object.assign({},t.payload.formlessControlOutputs)}},{})},GxhD:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e,t){this._etn=null,this._attributeName=null,this._etn=e,this._attributeName=t}get etn(){return this._etn}set etn(e){this._etn=e}get attributeName(){return this._attributeName}set attributeName(e){this._attributeName=e}}},HAeo:function(e,t,r){"use strict";r.d(t,"a",(function(){return F})),r.d(t,"b",(function(){return x}));var n=r("0nOn"),a=r("arV0"),i=r("3yqi"),s=r("AbXy"),o=r("SAYH"),c=r("B9jE"),l=r("16wZ"),u=r("P6DH"),d=r("qshH"),h=r("i1f0"),p=r("Uv1Y"),g=r("dHD5"),m=r("ZIjf"),b=r("IaGr");let f;class y{constructor(e,t,r,a,i){this._pageId=r,f=e,this._contextToken=t,this._controlName=a,this._gridType=i,this._clientApiExecutor=new n.a(e,"ClientApi.XrmViewSelector.",r,t,[{name:"controlName",value:a,isEventParam:!0},{name:"gridType",value:i,isEventParam:!0,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"store",value:e,isRequired:!0}])}setCurrentView(e){this._clientApiExecutor.executeAsync("setCurrentView",(t,r)=>e&&e.id?f.dispatch(Object(c.a)(this._pageId,this._contextToken,this._controlName,e.id)):(r.push({name:"validationError",value:"true"}),b.a.getInstance().traceManager.getTracer(t).error("View ID is required",r),Promise.resolve()))}getCurrentView(){const e="ClientApi.XrmViewSelector.getCurrentView";try{m.a.instance.reportCall(e);const t=Object(u.hb)(f.getState(),this._pageId,this._contextToken,this._controlName);let r=null,n=null;if(t)n=t.ViewId;else if(3===this._gridType){const t={id:this._pageId},r=Object(h.fb)(f.getState(),t,this._contextToken.parentContextToken),a="ViewId";if(!(r&&r.Controls&&r.Controls[this._controlName]&&r.Controls[this._controlName].Parameters&&r.Controls[this._controlName].Parameters[a])){let t;r?r.Controls?r.Controls[this._controlName]?r.Controls[this._controlName].Parameters?r.Controls[this._controlName].Parameters[a]||(t="formDescriptor.Controls[this._controlName].Parameters[propertyViewId] is null or undefined"):t="formDescriptor.Controls[this._controlName].Parameters is null or undefined":t="formDescriptor.Controls[this._controlName] is null or undefined":t="formDescriptor.Controls is null or undefined":t="formDescriptor is null or undefined";const n=d.a.getInstance().getEventParameters(this._contextToken);return n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,new p.a(t),null,n),null}n=r.Controls[this._controlName].Parameters[a]}if(n){if(r=Object(u.qb)(f.getState(),o.a.parse(n),this._pageId),r){const t={entityType:Object(u.ob)(f.getState(),n,this._pageId),id:o.a.externalGuid(r.viewId),name:r.title};return m.a.instance.reportSuccess(e),t}const t=[];return t.push({name:"controlName",value:this._controlName}),t.push({name:"contextKey",value:Object(g.v)(this._contextToken)}),d.a.getInstance().reportFailure(e,new Error("ViewDescriptor is coming as null"),null,t),null}const a=[];return a.push({name:"controlName",value:this._controlName}),a.push({name:"contextKey",value:Object(g.v)(this._contextToken)}),d.a.getInstance().reportFailure(e,new Error("viewId is coming as null or undefined"),null,a),null}catch(t){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,r),t}}isVisible(){const e="ClientApi.XrmViewSelector.isVisible";try{if(m.a.instance.reportCall(e),Object(l.a)(this._isVisible)){const t=Object(u.hb)(f.getState(),this._pageId,this._contextToken,this._controlName);if(t)this._isVisible=t.EnableViewPicker;else{const t={id:this._pageId},r=Object(h.fb)(f.getState(),t,this._contextToken.parentContextToken),n="EnableViewPicker";if(!(r&&r.Controls&&r.Controls[this._controlName]&&r.Controls[this._controlName].Parameters&&r.Controls[this._controlName].Parameters[n])){const t=d.a.getInstance().getEventParameters(this._contextToken);return t.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,new p.a("FormDescriptor is null"),null,t),!1}this._isVisible=r.Controls[this._controlName].Parameters[n]}}return m.a.instance.reportSuccess(e),this._isVisible}catch(t){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,r),t}}}var _=r("ghNp"),v=r("OQLa"),S=r("rQHy"),O=r("iOrn"),I=r("iZ7K"),C=r("d0w6"),j=r("deGN"),P=r("Lyxw"),T=r("3/02"),E=r("whN/");let w;class F{constructor(e,t,r,a,i,s,o,c){this._relationship=null;const u="ClientApi.XrmGridControl.constructor";e||Object(l.j)(u,"store"),t||Object(l.j)(u,"contextToken"),r||Object(l.j)(u,"pageId"),w=e,this._pageId=r,this._contextToken=t,this._controlName=c,this._isEditable=a,this._gridType=i,this._applicationContext=o,s||w.dispatch(Object(_.a)(this,r,t)),this._clientApiExecutor=new n.a(e,"ClientApi.XrmGridControl.",r,t),this._clientApiExecutor.addEventParameter({name:"controlName",value:c,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"isEditable",value:a,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"isCallFromSubgrid",value:s,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"gridType",value:i,isEventParam:!0})}get _connectedControlProps(){return{controlName:this._controlName,id:this._pageId}}setFilterXml(e){this._clientApiExecutor.executeAsync("setFilterXml",()=>{const t=(new Date).getTime();return w.dispatch(Object(O.b)(e,1,this._pageId,this._contextToken,t))})}getFilterXml(){const e="ClientApi.XrmGridControl.getFilterXml";try{m.a.instance.reportCall(e);const t=Object(u.u)(w.getState(),this._pageId,this._contextToken);return m.a.instance.reportSuccess(e),t}catch(t){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,r),t}}getFetchXml(){const e="ClientApi.XrmGridControl.getFetchXml";try{m.a.instance.reportCall(e);const t=Object(u.A)(w.getState(),this._contextToken,{id:this._pageId});return m.a.instance.reportSuccess(e),t}catch(t){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,r),t}}getGrid(){const e="ClientApi.XrmGridControl.getGrid";try{return m.a.instance.reportCall(e),!this._grid&&this.getEntityName()&&(this._grid=new s.a(w,this._applicationContext,this._contextToken,this._pageId,this.getEntityName(),this._isEditable,this._controlName)),m.a.instance.reportSuccess(e),this._grid}catch(t){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,r),t}}getViewSelector(){const e="ClientApi.XrmGridControl.getViewSelector";try{return m.a.instance.reportCall(e),this._viewSelector||(this._viewSelector=new y(w,this._contextToken,this._pageId,this._controlName,this._gridType)),m.a.instance.reportSuccess(e),this._viewSelector}catch(t){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,r),t}}getTeamTemplateId(){const e="ClientApi.XrmGridControl.getTeamTemplateId";try{m.a.instance.reportCall(e);let t=null;const r=w.getState();if(Object(P.c)(r,T.c)){if(this.getEntityName()&&3===this._gridType){const e=Object(h.fb)(r,this._connectedControlProps,this._contextToken.parentContextToken),n="TeamTemplateId";e&&e.Controls&&e.Controls[this._controlName]&&e.Controls[this._controlName].Parameters&&e.Controls[this._controlName].Parameters[n]&&(t=e.Controls[this._controlName].Parameters[n])}}return m.a.instance.reportSuccess(e),t}catch(t){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,r),t}}getEntityName(){return this._clientApiExecutor.execute("getEntityName",(e,t)=>{if(!this._entityName){if(this._entityName=Object(u.F)(w.getState(),this._pageId,this._contextToken,this._controlName),!this._entityName&&3===this._gridType){const r=Object(h.fb)(w.getState(),this._connectedControlProps,this._contextToken.parentContextToken),n="TargetEntityType";if(!(r&&r.Controls&&r.Controls[this._controlName]&&r.Controls[this._controlName].Parameters&&r.Controls[this._controlName].Parameters[n])){let a;return r?r.Controls?r.Controls[this._controlName]?r.Controls[this._controlName].Parameters?r.Controls[this._controlName].Parameters[n]||(a="formDescriptor.Controls[this.name].Parameters[targetEntityType] is null or undefined"):a="formDescriptor.Controls[this.name].Parameters is null or undefined":a="formDescriptor.Controls[this.name] is null or undefined":a="formDescriptor.Controls is null or undefined":a="formDescriptor is null or undefined",this._clientApiExecutor.reportFailure(e,new p.a(a),t),null}this._entityName=r.Controls[this._controlName].Parameters[n]}if(!this._entityName)return this._clientApiExecutor.reportFailure(e,new p.a("Logical name of the entity type is coming as null or undefined."),t),null}return this._entityName})}refresh(){this._clientApiExecutor.executeAsync("refresh",()=>w.dispatch(Object(c.a)(this._pageId,this._contextToken,this._controlName)))}refreshRibbon(){this._clientApiExecutor.executeAsync("refreshRibbon",()=>w.dispatch(Object(S.a)(this._pageId,Object(u.w)(w.getState(),this._pageId,this._contextToken))))}getUrl(e){const t="ClientApi.XrmGridControl.getUrl";try{m.a.instance.reportCall(t);let r=null,n=null;const a=this._getCurrentView();n={entityTypeName:this.getEntityName()},a&&(n.viewType="savedquery"===a.entityType?C.b.savedview:C.b.userview,n.viewId=new o.a(a.id)),r=i.a.Grid;let s=null;if(1===e)s=w.dispatch(Object(v.a)(r,n));else{const e=Object(j.a)(w,this._pageId);s=w.dispatch(Object(v.c)(e,r,n))}return m.a.instance.reportSuccess(t),s}catch(e){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,e,null,r),e}}getRecordSetQueryKey(){return this._clientApiExecutor.execute("getRecordSetQueryKey",()=>Object(u.cb)(w.getState(),this._contextToken,{id:this._pageId}))}getGridType(){return m.a.instance.reportUsage("ClientApi.XrmGridControl.getGridType"),this._gridType}getRelationship(){return this._clientApiExecutor.execute("getRelationship",(e,t)=>{if(!this._relationship){const r=Object(u.v)(w.getState(),this._pageId,this._contextToken);if(r){const e=r.relationshipName;if(e&&(this._relationship=x(e,this.getEntityName()),r.relationshipRoleOrdinal)){const e=r.relationshipRoleOrdinal===E.a.Referencing?1:2;this._relationship.roleType=e}}else b.a.getInstance().traceManager.getTracer(e).error("Grid dataset was null",t)}return this._relationship})}getParentForm(){const e="ClientApi.XrmGridControl.getParentForm";try{m.a.instance.reportCall(e);const t=this._contextToken&&this._contextToken.parentContextToken?w.dispatch(Object(_.b)(this._pageId,this._contextToken.parentContextToken)):null;return m.a.instance.reportSuccess(e),t}catch(t){const r=d.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,r),t}}getRollupType(){return this._clientApiExecutor.execute("getRollupType",()=>Object(u.eb)(w.getState(),this._pageId,this._contextToken))}_getCurrentView(){let e=null;const t=this.getViewSelector().getCurrentView();if(t)return e="savedquery"===t.entityType?"savedquery":"userquery",{entityType:e,id:t.id};const r=Object(a.g)(w.getState(),this._pageId);if(r.viewType&&r.viewId){const t=r.viewId?o.a.externalGuid(r.viewId):void 0;if(e=r.viewType===C.b.savedview?"savedquery":"userquery",e&&t)return{entityType:e,id:t}}return null}}function x(e,t){const r={};r.name=e;const n=Object(I.h)(w.getState(),t);if(n){let t;if(n.OneToManyRelationships&&n.OneToManyRelationships[e]?t=n.OneToManyRelationships[e]:n.ManyToOneRelationships&&n.ManyToOneRelationships[e]&&(t=n.ManyToOneRelationships[e]),t)r.attributeName=t.ReferencingAttribute,r.relationshipType=0,r.navigationPropertyName=t.ReferencingEntityNavigationPropertyName;else if(n.ManyToManyRelationships&&n.ManyToManyRelationships[e]){const t=n.ManyToManyRelationships[e];r.relationshipType=1,1===r.roleType?(r.attributeName=t.Entity1IntersectAttribute,r.navigationPropertyName=t.Entity1NavigationPropertyName):(r.attributeName=t.Entity2IntersectAttribute,r.navigationPropertyName=t.Entity2NavigationPropertyName)}}return r}},HhsT:function(e,t,r){"use strict";r.d(t,"a",(function(){return _}));var n=r("uNLT"),a=r("Uv1Y"),i=r("cUbT"),s=r("gQ5I"),o=r("+aj2"),c=r("YxC/"),l=r("ZUzm"),u=r("sHzf"),d=r("bvqZ"),h=r("FdXt"),p=r("dHD5"),g=r("i1f0"),m=r("bT7G"),b=r("3tOH"),f=r("Bj/n"),y=r("O7zD");function _(e){return{type:"saveAndClose.saveAndCloseFormDialogAction.async",execute({dispatch:t,getState:r},_,v){const S=r(),O=Object(p.j)(S,e),I=Object(g.zb)(S,e,O),C=Object(g.ac)(S,e,O);if(!(!Object(m.g)(S,C)&&I&&Object.keys(I).length>0))return t(Object(n.e)(e,2)).then(r=>{const n=Object(g.Ib)(S,e),p=n?"Forms.MainFormDialogRoot.SaveAndClose":"Forms.QuickCreateFormRoot.SaveAndClose";if(r){const a=[{name:"isEntityRefNull",value:!1},{name:"entityTypeName",value:r.etn}];_.EventManager.ReportComponentSuccess(p,a);return(n?Promise.resolve(e):t(Object(o.b)(e,r))).then(e=>(t(Object(i.a)(r.etn)),function(e,t,r){const n="quickcreate_",a=Object(c.e)(t,[h.g,h.c]),i={actionLabel:Object(c.c)(a,h.g),eventHandler:()=>{e(Object(l.a)(r)),e(Object(u.removeToastNotification)(n+r.id.guid))}},s=null,o={id:n+r.id.guid,type:1,level:1,message:Object(c.c)(a,h.c),title:null,action:i,onCloseHandler:s};e(Object(d.b)(o))}(t,S,r),t(Object(s.e)(e,"save")).then(()=>r)))}return _.EventManager.ReportComponentSuccess(p,[{name:"isEntityRefNull",value:!0}]),Promise.reject(new a.a("Record is not created"))});for(const r in I){const n=I[r].label,a=I[r].errorMessage,i=t(Object(f.b)(n,a));t(Object(f.c)(O,e,i,b.a.error,Object(y.d)(e,r)))}}}}},JF0K:function(e,t,r){"use strict";r.d(t,"h",(function(){return n})),r.d(t,"i",(function(){return a})),r.d(t,"o",(function(){return i})),r.d(t,"a",(function(){return s})),r.d(t,"j",(function(){return o})),r.d(t,"c",(function(){return c})),r.d(t,"f",(function(){return l})),r.d(t,"g",(function(){return u})),r.d(t,"b",(function(){return p})),r.d(t,"d",(function(){return g})),r.d(t,"k",(function(){return m})),r.d(t,"l",(function(){return b})),r.d(t,"e",(function(){return f})),r.d(t,"q",(function(){return y})),r.d(t,"p",(function(){return _})),r.d(t,"m",(function(){return d})),r.d(t,"n",(function(){return h}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n="BusinessProcessFlow.MoveToNextStage",a="BusinessProcessFlow.MoveToPreviousStage",i="BusinessProcessFlow.SetActiveStage",s="BusinessProcessFlow.AbandonProcess",o="BusinessProcessFlow.ReactivateProcess",c="BusinessProcessFlow.CompleteProcess",l="BusinessProcessFlow.InitilaizeWithFormEntityOnly",u="BusinessProcessFlow.InitilaizeWithProcessAndFormEntity",d="BusinessProcessFlow.SetActiveProcess",h="BusinessProcessFlow.SetActiveProcessInstance",p="BusinessProcessFlow.ActionStep",g="BusinessProcessFlow.FlowStepWidget",m="BusinessProcessFlow.RefreshFlowStep",b="BusinessProcessFlow.RenderProcessControl",f="BusinessProcessFlow.HideProcessControlForUciOffline",y="SaveFailureReason",_="faultedSnapshotId"},Jpj4:function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return b}));var n=r("SAYH"),a=r("dHD5"),i=r("BFlg"),s=r("P6DH"),o=r("LbMF"),c=r("3hnk"),l=r("NUHF"),u=r("odYE"),d=r("3/02"),h=r("Lyxw"),p=r("bT7G"),g=r("qLnS");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const m="dataset.row.properties";function b(e,t,r){return{type:"row.properties.async",execute({dispatch:l,getState:p},b){const y=b.TraceManager.getTracer(i.z),_=i.x+".RowPropertiesAction",v=Object(h.c)(p(),d.L);try{const i=Object(a.v)(t),d=Object(s.P)(p(),t,{id:e});if(d){let h=null;const I=Object(s.Q)(p(),e,t);if(I)h=I;else{const r=Object(s.S)(p(),{id:e},t);r&&r.entityLogicalName&&(h=r.entityLogicalName)}if(h){const a=Object(o.d)(p(),h),i=Object(s.y)(p(),t,e);if(a){const e=[];for(const t of Object.keys(a)){const r=a[t],n=Object(c.f)(p(),h,r.LogicalName,g.a.CanUpdate);let s=!0;v&&i&&0===i[r.LogicalName]&&(s=!1),e.push({[r.LogicalName]:{requiredLevel:r.RequiredLevel,isDisabled:!(r.IsValidForUpdate&&n&&s),notifications:{}}})}for(const t of r)if(0===d.records.filter(e=>Object.keys(e)[0]===n.a.toString(t)).length)d.records.push({[n.a.toString(t)]:e});else{const r=d.records.find(e=>Object.keys(e)[0]===n.a.toString(t))[n.a.toString(t)],a=JSON.parse(JSON.stringify(e));r&&r.forEach(e=>{const t=e[Object.keys(e)[0]];t&&Object.keys(t.notifications).length>0&&(a.find(t=>Object.keys(t)[0]===Object.keys(e)[0])[Object.keys(e)[0]].notifications=t.notifications)}),d.records.find(e=>Object.keys(e)[0]===n.a.toString(t))[n.a.toString(t)]=a}}}if(l(function(e,t,r){return{type:m,payload:r,meta:{pageId:e,dataSetContextKey:t}}}(e,i,d)),v&&h){const n=Object(o.d)(p(),h),i=Object(s.y)(p(),t,e);for(const s of r){const r=(p(),S=s,O=h,new u.a(O,S)),o=Object(a.f)(t,s,h);if(n)for(const t of Object.keys(n)){const a=n[t];i&&1===i[a.LogicalName]&&null===a.ParentPicklistLogicalName&&f(p(),l,e,r,a.LogicalName,o)}}}y.info("creating the rowproperties for {0} rows"+r.length),b.EventManager.ReportComponentSuccess(_)}return Promise.resolve()}catch(e){const t="creating the rowproperties for {0} rows"+r.length+"failed";b.EventManager.ReportComponentFailure(_,Error(t))}var S,O}}}function f(e,t,r,n,a,i){const o={},c=Object(s.R)(e,r,i),u=Object(p.d)(e,c,n,a);o[a]=u,Object.keys(o).length>0&&t(Object(l.b)(r,i,!1,o))}},KGWS:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class n{constructor(e,t){this._traversedPath=e,this._stageId=t}get traversedPath(){return this._traversedPath}set traversedPath(e){this._traversedPath=e}get stageId(){return this._stageId}set stageId(e){this._stageId=e}}var a=r("sxfa"),i=r("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class s{get globalPathAndActiveStage(){return this._globalPathAndActiveStage}get navigationEntities(){return this._navigationEntities}get navigationEntityIdsByEntityLogicalName(){return this._navigationEntityIdsByEntityLogicalName}set globalPathAndActiveStage(e){(e||this._globalPathAndActiveStage||this._globalPathAndActiveStage.stageId===e.stageId)&&(this._globalPathAndActiveStage=e)}InitGlobalPathAndActiveStage(e){this._updateNavigationDictionary(e.navigationEntities),this.UpdateGlobalPathAndActiveStage(e.traversedPath,e.activeStageId)}UpdateGlobalPathAndActiveStage(e,t){this.globalPathAndActiveStage=new n(new a.a(e),t)}_updateNavigationDictionary(e){if(e){this._navigationEntities=e,this._navigationEntityIdsByEntityLogicalName={};for(let t=0;t<e.length;t++)this._navigationEntityIdsByEntityLogicalName[e[t].entityLogicalName]=new i.a(e[t].id)}}}},KnyI:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="attribute.removeOption";function i(e,t,r,i){const s=Object(n.x)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:s,dataFieldName:r}}}},L8zx:function(e,t,r){"use strict";r.d(t,"a",(function(){return K})),r.d(t,"b",(function(){return J}));var n=r("SAYH"),a=r("i1f0"),i=r("UqyN"),s=r("ABCl"),o=r("0nOn"),c=r("odYE"),l=r("hvSt"),u=r("5Oca"),d=r("CPoS"),h=r("qshH"),p=r("16wZ"),g=r("ZIjf");class m{constructor(e,t,r){const n="ClientApi.XrmProcessStep.constructor";t||Object(p.j)(n,"step"),r||Object(p.j)(n,"processManager"),e||Object(p.j)(n,"store"),this._step=t,this._processManager=r}isRequired(){const e="ClientApi.XrmProcessStep.isRequired";try{g.a.instance.reportCall(e);const t=this._step.get_isProcessRequired();return g.a.instance.reportSuccess(e),t}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}getAttribute(){const e="ClientApi.XrmProcessStep.getAttribute";try{if(g.a.instance.reportCall(e),!this._attribute){const e=this._step.get_Steps().get_item(0);this._attribute=!e||e.get_isSystemControl()?null:e.get_dataFieldName()}return g.a.instance.reportSuccess(e),this._attribute}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}getName(){const e="ClientApi.XrmProcessStep.getName";try{g.a.instance.reportCall(e);const t=this._step.get_Name();return g.a.instance.reportSuccess(e),t}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}getProgress(){const e="ClientApi.XrmProcessStep.getProgress";try{g.a.instance.reportCall(e);let t=4;if(this._step.get_Steps()&&this._step.get_Steps().get_item(0)){if(this._step.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep&&this._processManager){const e=this._processManager.getActionLog(new n.a(this._step.get_Id()));e&&(t=e.status),t=0}}return g.a.instance.reportSuccess(e),t}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}setProgress(e,t){const r="ClientApi.XrmProcessStep.setProgress";try{g.a.instance.reportCall(r);let n="invalid";switch(e){case 0:case 1:case 2:case 3:case 4:n=this._setProgressInternal(e,t)}return g.a.instance.reportSuccess(r),n}catch(e){throw h.a.getInstance().reportFailure(r,e),e}}_setProgressInternal(e,t){if(this._step.get_Steps()&&this._step.get_Steps().get_item(0)){if(this._step.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep){const r=this._processManager.UpdateActionLog(new n.a(this._step.get_Id()),e,t);if(r)return r}}return"invalid"}}var b=r("Sbn7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class f{constructor(e,t){this._processManager=t,null!=this._processManager&&this._processManager.shouldReInitializeNavigationBehavior()&&this._processManager.setBpfNavigationBehavior(this)}get allowCreateNew(){return g.a.instance.reportUsage("ClientApi.XrmProcessNavigationBehavior.getAllowCreateNew"),this._allowCreateNew}set allowCreateNew(e){const t="ClientApi.XrmProcessNavigationBehavior.setAllowCreateNew";try{g.a.instance.reportCall(t),this._allowCreateNew=e,null!=this._processManager&&this._processManager.setBpfNavigationBehavior(this),g.a.instance.reportSuccess(t)}catch(e){throw h.a.getInstance().reportFailure(t,e),e}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let y;class _{constructor(e,t,r,n,a){y=e,this._entityTypeName=r,this._activeStageId=n,this._stageStep=t,new f(e,a),a&&(this._processManager=a)}getCategory(){const e="ClientApi.XrmProcessStage.getCategory";try{g.a.instance.reportCall(e);const t=this._stageStep.get_stageCategory(),r={getValue(){let e=parseInt(t,10);return Number.isNaN(e)&&(e=-1),e}};return g.a.instance.reportSuccess(e),r}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}getId(){const e="ClientApi.XrmProcessStage.getId";try{g.a.instance.reportCall(e);const t=this._stageStep.get_Id();return g.a.instance.reportSuccess(e),t}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}getEntityName(){return g.a.instance.reportUsage("ClientApi.XrmProcessStage.getEntityName"),this._entityTypeName}getStatus(){const e="ClientApi.XrmProcessStage.getStatus";try{g.a.instance.reportCall(e);const t=this.getId()===this._activeStageId?"active":"inactive";return g.a.instance.reportSuccess(e),t}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}getName(){const e="ClientApi.XrmProcessStage.getName";try{g.a.instance.reportCall(e);const t=this._stageStep.get_Description();return g.a.instance.reportSuccess(e),t}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}getSteps(){const e="ClientApi.XrmProcessStage.getSteps";try{if(g.a.instance.reportCall(e),!this._steps&&(this._steps=new b.a(e),null!=this._stageStep.get_Steps()&&this._stageStep.get_Steps().get_Count()>0))for(let e=0;e<this._stageStep.get_Steps().get_Count();e++){const t=this._stageStep.get_Steps().get_item(e);if(t instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){const e=t.get_Steps().get_item(0);e&&(e instanceof Microsoft.Crm.Workflow.ObjectModel.ControlStep||e instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep||e instanceof Microsoft.Crm.Workflow.ObjectModel.FlowStep)&&this._steps.add(t.get_Id(),new m(y,t,this._processManager))}}return g.a.instance.reportSuccess(e),this._steps}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}getNavigationBehavior(){const e="ClientApi.XrmProcessStage.getNavigationBehavior";try{g.a.instance.reportCall(e);const t=this._processManager.getBpfNavigationBehavior();return g.a.instance.reportSuccess(e),t}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let v;class S{constructor(e,t,r,n,a){const i="ClientApi.XrmBusinessProcessFlow.constructor";t||Object(p.j)(i,"workflowStep"),n||Object(p.j)(i,"activeStageId"),a||Object(p.j)(i,"processManager"),e||Object(p.j)(i,"store"),Object(p.a)(r)&&Object(p.j)(i,"isRendered"),v=e,this._isRendered=r,this._workflowStep=t,this._activeStageId=n,this._processManager=a}getName(){const e="ClientApi.XrmBusinessProcessFlow.getName";try{g.a.instance.reportCall(e);const t=this._workflowStep.get_Name();return g.a.instance.reportSuccess(e),t}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}getId(){const e="ClientApi.XrmBusinessProcessFlow.getId";try{g.a.instance.reportCall(e);const t=this._workflowStep.get_Id();return g.a.instance.reportSuccess(e),t}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}isRendered(){return g.a.instance.reportUsage("ClientApi.XrmBusinessProcessFlow.isRendered"),this._isRendered}getStages(){const e="ClientApi.XrmBusinessProcessFlow.getStages";try{if(g.a.instance.reportCall(e),!this._stages){this._stages=new b.a(e);for(let e=0;e<this._workflowStep.get_Steps().get_Count();e++){const t=this._workflowStep.get_Steps().get_item(e);if(t instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep){const e=t;for(let t=0;t<e.get_Steps().get_Count();t++){const r=e.get_Steps().get_item(t);this._stages.add(r.get_Id(),new _(v,r,e.get_EntityLogicalName(),this._activeStageId,this._processManager))}}}}return g.a.instance.reportSuccess(e),this._stages}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}}var O,I=r("1kth"),C=r("cZbt"),j=r("blB4"),P=r("UuJw");!function(e){e.success="success",e.invalid="invalid"}(O||(O={}));var T=r("r/aD"),E=r("iF9X"),w=r("37s6"),F=r("69Qu"),x=r("IaGr"),A=r("arV0"),N=r("2Ct/"),D=r("ycdb"),k=r("ruPX"),M=r("cfbi");let R;class L{constructor(e,t,r,a,i){this._clientApiExecutor=new o.a(e,"ClientApi.XrmProcessControlData.",r,t);const s=this._clientApiExecutor.getComponentName("constructor");r||Object(p.j)(s,"pageId"),a||Object(p.j)(s,"entity"),t||Object(p.j)(s,"contextToken"),e||Object(p.j)(s,"store"),R=e,this._pageId=r,this._entity=a;let l=!1;Object(T.d)(R.getState(),this._pageId,s,!0)&&(this._processManager=i,l=!0),this._contextToken=t;const u=a.getEntityReference();this._entityRef=new c.a(u.entityType,n.a.tryParseOrNull(u.id),u.name);const d=Object(T.b)(r,e.getState(),l);x.a.getInstance().eventManager.ReportComponentSuccess(s,d)}getActiveProcess(){const e="ClientApi.XrmProcessControlData.getActiveProcess";try{if(g.a.instance.reportCall(e),!Object(T.d)(R.getState(),this._pageId,e))return g.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getProcess();let r=null;if(t){const e=this._getProcessManager().getActiveStageId();r=new S(R,t,!0,e,this._getProcessManager())}return g.a.instance.reportSuccess(e),r}catch(t){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,r),t}}setStatus(e,t){const r="ClientApi.XrmProcessControlData.setStatus";try{if(g.a.instance.reportCall(r),!Object(T.d)(R.getState(),this._pageId,r))return void g.a.instance.reportSuccess(r);if(!e||this.getStatus()&&e===this.getStatus())return void g.a.instance.reportSuccess(r);let n;if(e===C.a.active)n=l.a.Active;else if(e===C.a.finished)n=l.a.Finished;else{if(e!==C.a.aborted)return void g.a.instance.reportSuccess(r);n=l.a.Aborted}this._getProcessManager().setStatus(n).then(()=>{this._callback(t,e,r),g.a.instance.reportSuccess(r)}).catch(t=>{const n=h.a.getInstance().getEventParameters(this._contextToken);return n.push({name:"newStatus",value:e}),Object(p.d)(R,t,r,n)})}catch(e){const t=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(r,e,null,t),e}}getStatus(){const e="ClientApi.XrmProcessControlData.getStatus";try{if(g.a.instance.reportCall(e),!Object(T.d)(R.getState(),this._pageId,e))return g.a.instance.reportSuccess(e),null;const t=this._convertToXrmProcessInstanceStatus(this._getProcessManager().getStatus());return g.a.instance.reportSuccess(e),t}catch(t){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,r),t}}getInstanceName(){const e="ClientApi.XrmProcessControlData.getInstanceName";try{if(g.a.instance.reportCall(e),!Object(T.d)(R.getState(),this._pageId,e))return g.a.instance.reportSuccess(e),null;let t=this._getProcessManager().getProcessInstanceName();if(!t){const e=Object(u.e)(R.getState(),this._entityRef);t=Object(d.c)(R.getState(),e)}return g.a.instance.reportSuccess(e),t}catch(t){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,r),t}}getInstanceId(){const e="ClientApi.XrmProcessControlData.getInstanceId";try{if(g.a.instance.reportCall(e),!Object(T.d)(R.getState(),this._pageId,e))return g.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getProcessInstanceId(),r=t?n.a.toString(t):null;return g.a.instance.reportSuccess(e),r}catch(t){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,r),t}}getProcessInstances(e){const t="ClientApi.XrmProcessControlData.getProcessInstances";try{if(g.a.instance.reportCall(t),!Object(T.d)(R.getState(),this._pageId,t)||Object(N.g)(R.getState()))return;"function"==typeof e&&this._getProcessManager().getProcessInstances().then(r=>{if(r&&r.value&&r.value.length>0){const n={};r.value.forEach(e=>{e.businessprocessflowinstanceid&&(n[e.businessprocessflowinstanceid]={CreatedOnDate:e.createdon?new Date(e.createdon):null,ProcessDefinitionID:e._processid_value,ProcessDefinitionName:e.name,ProcessInstanceID:e.businessprocessflowinstanceid,ProcessInstanceName:e.name,StatusCodeName:this._convertToXrmProcessInstanceStatus(e.Process_x002e_statuscode),CreatedOn:e.createdon?new Date(e.createdon).toLocaleDateString():"",ProcessDefintionID:e._processid_value,ProcessDefintionName:e.name})}),Object(s.c)(t,[],()=>{e(n)})}g.a.instance.reportSuccess(t)}).catch(e=>{const r=h.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(R,e,t+".getProcessInstances",r)})}catch(e){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,r),e}}setActiveProcess(e,t){this._clientApiExecutor.executeAsync("setActiveProcess",(r,a)=>{const i=n.a.tryParseOrNull(e),s=Object(A.m)(R.getState(),this._pageId);if(i&&n.a.equals(i,n.a.EMPTY)){if(s){const e=new c.a(this._entity.getEntityName(),n.a.EMPTY);return R.dispatch(Object(D.b)(!0,e)),x.a.getInstance().eventManager.ReportComponentSuccess(r,a),Promise.resolve().then(()=>(this._callback(t,O.success,r,a),Promise.resolve())).catch(e=>(this._callback(t,O.invalid,r,a),Promise.reject(e)))}return Promise.resolve().then(()=>(this._callback(t,O.invalid,r,a),Promise.resolve()))}if(!Object(T.d)(R.getState(),this._pageId,r,!0)||Object(N.g)(R.getState()))return Promise.resolve();let o=null;return o=s?Promise.resolve():this._getProcessManager().setActiveProcess(e),o.then(()=>{this._callback(t,O.success,r,a);const n=this.getActiveProcess();return n&&n.getId().toUpperCase()===e.toUpperCase()||this._reloadPage(r,this._getProcessManager().getCurrentFormEntity(),e),Promise.resolve()}).catch(e=>(this._callback(t,O.invalid,r,a),Promise.reject(e)))},[{name:"processId",value:e,isRequired:!0,expectedDataType:"guid"}])}setActiveProcessInstance(e,t){this._clientApiExecutor.executeAsync("setActiveProcessInstance",(r,n)=>!Object(T.d)(R.getState(),this._pageId,r)||Object(N.g)(R.getState())?Promise.resolve():this._getProcessManager().setActiveProcessInstance(e).then(a=>{this._callback(t,O.success,r,n);return this.getInstanceId()!==e&&this._reloadPage(r,this._getProcessManager().getCurrentFormEntity(),a,e),Promise.resolve()}).catch(e=>(this._callback(t,O.invalid,r,n),Promise.reject(e))),[{name:"processInstanceId",value:e,isRequired:!0,expectedDataType:"guid"}])}getEnabledProcesses(e){const t="ClientApi.XrmProcessControlData.getEnabledProcesses";try{if(g.a.instance.reportCall(t),!Object(T.d)(R.getState(),this._pageId,t,!0))return void g.a.instance.reportSuccess(t);const r=R.getState();if(Object(E.g)(r)&&Object(w.w)(r)&&!Object(F.b)(r)){const r={};return void("function"==typeof e&&Object(s.c)(t,[],()=>{e(r)}))}this._getProcessManager().getEnabledProcesses().then(r=>{const n={};r&&r.length>0&&r.forEach(e=>{n[e.workflowId]=e.name}),"function"==typeof e&&Object(s.c)(t,[],()=>{e(n)}),g.a.instance.reportSuccess(t)}).catch(e=>{const r=h.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(R,e,t+".getEnabledProcesses",r)})}catch(e){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,r),e}}switchProcess(){const e="ClientApi.XrmProcessControlData.switchProcess";try{if(g.a.instance.reportCall(e),!Object(T.d)(R.getState(),this._pageId,e)||Object(N.g)(R.getState()))return;this._getProcessManager().switchProcess(),g.a.instance.reportSuccess(e)}catch(t){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,r),t}}abandonProcess(){const e="ClientApi.XrmProcessControlData.abandonProcess";try{if(g.a.instance.reportCall(e),!Object(T.d)(R.getState(),this._pageId,e)||Object(A.m)(R.getState(),this._pageId))return void g.a.instance.reportSuccess(e);this._getProcessManager().abandonProcess().then(()=>{g.a.instance.reportSuccess(e)}).catch(t=>{const r=h.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(R,t,e+".abandonProcess",r)})}catch(t){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,r),t}}reactivateProcess(){const e="ClientApi.XrmProcessControlData.reactivateProcess";try{if(g.a.instance.reportCall(e),!Object(T.d)(R.getState(),this._pageId,e)||Object(A.m)(R.getState(),this._pageId))return void g.a.instance.reportSuccess(e);this._getProcessManager().reactivateProcess().then(()=>{g.a.instance.reportSuccess(e)}).catch(t=>{const r=h.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(R,t,e+".reactivateProcess",r)})}catch(t){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,r),t}}completeProcess(){const e="ClientApi.XrmProcessControlData.completeProcess";try{if(g.a.instance.reportCall(e),!Object(T.d)(R.getState(),this._pageId,e)||Object(A.m)(R.getState(),this._pageId))return void g.a.instance.reportSuccess(e);this._getProcessManager().completeProcess().then(()=>{g.a.instance.reportSuccess(e)}).catch(t=>{const r=h.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(R,t,e+".completeProcess",r)})}catch(t){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,r),t}}getActiveStage(){const e="ClientApi.XrmProcessControlData.getActiveStage";try{if(g.a.instance.reportCall(e),!Object(T.d)(R.getState(),this._pageId,e))return g.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getActiveStage();let r=null;return t&&(r=new _(R,t,this._getProcessManager().getCurrentFormEntity().etn,t.get_Id(),this._getProcessManager())),g.a.instance.reportSuccess(e),r}catch(t){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,r),t}}getActivePath(){const e="ClientApi.XrmProcessControlData.getActivePath";try{if(g.a.instance.reportCall(e),!Object(T.d)(R.getState(),this._pageId,e))return g.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getActivePathStages();let r=null;if(t){const n=this._getProcessManager().getActiveStageId(),a=new b.a(e);t.forEach(e=>{const t=e.get_parent().get_EntityLogicalName();a.add(e.get_stageId(),new _(R,e,t,n,this._getProcessManager()))}),r=a}return g.a.instance.reportSuccess(e),r}catch(t){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,r),t}}setActiveStage(e,t){const r="ClientApi.XrmProcessControlData.setActiveStage";try{if(g.a.instance.reportCall(r),this._entity.getIsDirty()||Object(A.m)(R.getState(),this._pageId))g.a.instance.reportSuccess(r),this._callback(t,j.a.dirtyForm,r);else{if(!Object(T.d)(R.getState(),this._pageId,r))return void g.a.instance.reportSuccess(r);this._getProcessManager().setActiveStage(e).then(()=>{this._callback(t,this._getStageInvalidReason(null),r),this._loadActiveStageEntity(r),g.a.instance.reportSuccess(r)}).catch(e=>{this._callback(t,e?this._getStageInvalidReason(e):P.a.invalid,r)})}}catch(e){const t=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(r,e,null,t),e}}moveNext(e){const t="ClientApi.XrmProcessControlData.moveNext";try{const r=!0;if(g.a.instance.reportCall(t),this._entity.getIsDirty()||Object(A.m)(R.getState(),this._pageId))g.a.instance.reportSuccess(t),this._callback(e,j.a.dirtyForm,t);else{if(!Object(T.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);if(this._getProcessManager().isCrossEntityNavigation(r))return this._callback(e,j.a.crossEntity,t),void g.a.instance.reportSuccess(t);this._getProcessManager().moveToNextStage().then(()=>{this._callback(e,this._getNavigationStatus(null),t),g.a.instance.reportSuccess(t)}).catch(r=>{const n=r?this._getNavigationStatus(r):j.a.invalid;if(this._callback(e,n,t),n===j.a.invalid){const e=h.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(R,r,t+".moveToNextStage",e)}g.a.instance.reportSuccess(t)})}}catch(e){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,r),e}}movePrevious(e){const t="ClientApi.XrmProcessControlData.movePrevious";try{const r=!0;if(g.a.instance.reportCall(t),this._entity.getIsDirty()||Object(A.m)(R.getState(),this._pageId))g.a.instance.reportSuccess(t),this._callback(e,j.a.dirtyForm,t);else{if(!Object(T.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);if(Object(N.g)(R.getState())&&this._getProcessManager().isCrossEntityNavigation(!r))return this._callback(e,j.a.crossEntity,t),void g.a.instance.reportSuccess(t);this._getProcessManager().moveToPreviousStage().then(()=>{this._callback(e,this._getNavigationStatus(null),t),this._loadActiveStageEntity(t),g.a.instance.reportSuccess(t)}).catch(r=>{const n=r?this._getNavigationStatus(r):j.a.invalid;if(this._callback(e,n,t),n===j.a.invalid){const e=h.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(R,r,t+".moveToPreviousStage",e)}g.a.instance.reportSuccess(t)})}}catch(e){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,r),e}}getSelectedStage(){const e="ClientApi.XrmProcessControlData.getSelectedStage";try{if(g.a.instance.reportCall(e),!Object(T.d)(R.getState(),this._pageId,e))return g.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getSelectedStage();let r=null;if(t){const e=this._getProcessManager().getActiveStageId();r=new _(R,t,this._getProcessManager().getCurrentFormEntity().etn,e,this._getProcessManager())}return g.a.instance.reportSuccess(e),r}catch(t){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,r),t}}addOnStageChange(e){const t="ClientApi.XrmProcessControlData.addOnStageChange";e||Object(p.j)(t,"handler");try{if(g.a.instance.reportCall(t),!Object(T.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(I.q)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,r),e}}addOnPreStageChange(e){const t="ClientApi.XrmProcessControlData.addOnPreStageChange";Object(p.g)(e,t,"handler");try{if(g.a.instance.reportCall(t),!Object(T.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(I.j)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,r),e}}removeOnStageChange(e){const t="ClientApi.XrmProcessControlData.removeOnStageChange";e||Object(p.j)(t,"handler");try{if(g.a.instance.reportCall(t),!Object(T.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(I.L)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,r),e}}removeOnPreStageChange(e){const t="ClientApi.XrmProcessControlData.removeOnPreStageChange";Object(p.g)(e,t,"handler");try{if(g.a.instance.reportCall(t),!Object(T.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(I.E)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,r),e}}addOnStageSelected(e){const t="ClientApi.XrmProcessControlData.addOnStageSelected";e||Object(p.j)(t,"handler");try{if(g.a.instance.reportCall(t),!Object(T.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(I.r)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,r),e}}removeOnStageSelected(e){const t="ClientApi.XrmProcessControlData.removeOnStageSelected";e||Object(p.j)(t,"handler");try{if(g.a.instance.reportCall(t),!Object(T.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(I.M)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,r),e}}addOnProcessStatusChange(e){const t="ClientApi.XrmProcessControlData.addOnProcessStatusChange";e||Object(p.j)(t,"handler");try{if(g.a.instance.reportCall(t),!Object(T.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(I.k)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,r),e}}addOnPreProcessStatusChange(e){const t="ClientApi.XrmProcessControlData.addOnPreProcessStatusChange";Object(p.g)(e,t,"handler");try{if(g.a.instance.reportCall(t),!Object(T.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(I.i)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,r),e}}removeOnProcessStatusChange(e){const t="ClientApi.XrmProcessControlData.removeOnProcessStatusChange";e||Object(p.j)(t,"handler");try{if(g.a.instance.reportCall(t),!Object(T.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(I.F)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,r),e}}removeOnPreProcessStatusChange(e){const t="ClientApi.XrmProcessControlData.removeOnPreProcessStatusChange";Object(p.g)(e,t,"handler");try{if(g.a.instance.reportCall(t),!Object(T.d)(R.getState(),this._pageId,t))return void g.a.instance.reportSuccess(t);R.dispatch(Object(I.D)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,r),e}}_getStageInvalidReason(e){return e?e.stageInvalidReason||P.a.invalid:j.a.success}_getNavigationStatus(e){return e?e.navigationStatus||j.a.invalid:j.a.success}_convertToXrmProcessInstanceStatus(e){if(e){if(e===l.a.Active)return C.a.active;if(e===l.a.Finished)return C.a.finished;if(e===l.a.Aborted)return C.a.aborted}return null}_callback(e,t,r,n){const a=r+".Callback";n||(n=h.a.getInstance().getEventParameters(this._contextToken)),n.push({name:"Status",value:t}),Object(s.c)(a,n,()=>{"function"==typeof e&&e(t)})}_reloadPage(e,t,r,n){if(t){const a=Object(A.m)(R.getState(),this._pageId),i={entityTypeName:t.etn,id:a?void 0:t.id,processId:r,processInstanceId:n},s={target:"inline"};R.dispatch(Object(k.a)(M.a,i,this._pageId,s)).then(t=>{if(0!==t.status)return Object(p.d)(R,t.error,e+".navigateTo.INavigationFailure")}).catch(t=>Object(p.d)(R,t,e+".navigateTo."))}}_loadActiveStageEntity(e){const t=this._getProcessManager().getActiveStageEntityRef();t&&t.etn!==this._getProcessManager().getCurrentFormEntity().etn&&this._reloadPage(e,t,this.getActiveProcess().getId(),this.getInstanceId())}_getProcessManager(){return this._processManager||(this._processManager=Object(T.c)(this._processManager,R,this._pageId,"ClientApi.XrmProcessControlData.getProcessManager")),this._processManager}}var B=r("uNLT"),V=r("/q/W"),G=r("jRy5"),U=r("Uv1Y"),X=r("Fij2"),z=r("mIxf"),q=r("HhsT"),H=r("PUjk"),W=r("AE7n"),Y=r("P6DH");let Q;class K{constructor(e,t,r,n,a){this._entity=null;const i="ClientApi.XrmFormData.constructor";e||Object(p.j)(i,"store"),r||Object(p.j)(i,"pageId"),t||Object(p.j)(i,"contextToken"),n||Object(p.j)(i,"formContext"),Q=e,this._pageId=r,this._formContext=n,this._contextToken=t,this._entity=a}get entity(){return g.a.instance.reportUsage("ClientApi.XrmFormData.entity"),this._entity}get process(){const e="ClientApi.XrmFormData.process_get";try{const t=Object(N.f)(Q.getState());g.a.instance.reportCall(e);const r=!!this._process;if((!t&&!this._process||t)&&this._entity){const e=Object(A.g)(Q.getState(),this._pageId),t=Object(H.b)(this._pageId,e);this._entity&&(this._process=new L(Q,this._contextToken,this._pageId,this.entity,t))}g.a.instance.reportSuccess(e);const n=Object(T.a)(this._pageId,Q.getState(),r,!!this._entity);return x.a.getInstance().eventManager.ReportComponentSuccess(e,n),this._process}catch(t){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,r),t}}set process(e){const t=Object(T.a)(this._pageId,Q.getState(),!!this._process,!!this._entity);x.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmFormData.process_set",t),this._process=e}getEntity(){return g.a.instance.reportUsage("ClientApi.XrmFormData.getEntity"),this._entity}getIsDirty(){var e,t,r;const n="ClientApi.XrmFormData.getIsDirty";try{g.a.instance.reportCall(n);let a=!1;if(this._entity&&this._entity.getIsDirty())a=!0;else{for(let e=0;e<this.attributes.getLength();e++){const t=this.attributes.get(e);if("never"!==t.getSubmitMode()&&t.getIsDirty()){a=!0;break}}if(!a&&(null===(t=null===(e=this._formContext)||void 0===e?void 0:e.ui)||void 0===t?void 0:t.controls))for(let e=0;e<this._formContext.ui.controls.getLength();e++){const t=this._formContext.ui.controls.get(e);if("formcomponent"===t.getControlType()&&t.isLoaded()&&(null===(r=t.data)||void 0===r?void 0:r.getIsDirty())){a=!0;break}}}return g.a.instance.reportSuccess(n),a}catch(e){const t=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(n,e,null,t),e}}get attributes(){const e="ClientApi.XrmFormData.attributes";try{if(g.a.instance.reportCall(e),!this._unboundAttributes){this._unboundAttributes=new b.a(e);const t=Object(a.Oc)(Q.getState(),this._pageId);if(t)for(const e in t){const r=t[e],n=e,a=Object(i.b)(Q,this._contextToken,this._pageId,n,this.entity,this._formContext.ui,r);this._unboundAttributes.add(a.getName(),a)}}return g.a.instance.reportSuccess(e),this._unboundAttributes}catch(t){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,r),t}}_refreshEntity(e){return this.entity.refresh().then(()=>{Object(B.d)(Q.dispatch,this._contextToken,this._pageId),e&&Q.dispatch(Object(I.Q)(this._contextToken,this._pageId,3,this.entity)),Object(X.b)(this.entity)})}refresh(e){const t="ClientApi.XrmFormData.refresh";try{if(g.a.instance.reportCall(t),this.entity){const r=Object(a.kb)(Q.getState(),{id:this._pageId},this._contextToken);return!r&&e&&this.entity.getIsDirty()?this.save().then(e=>(g.a.instance.reportSuccess(t),{})).catch(e=>{const r=h.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(Q,e,t+".save",r)}):!r&&this.entity.getIsDirty()?Q.dispatch(Object(V.a)(this._pageId)).then(e=>{if(e)return this._refreshEntity(!0).then(()=>(g.a.instance.reportSuccess(t),{})).catch(e=>{const r=h.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(Q,e,t+".handleUnsavedChanges.refreshEntity",r)})}).catch(e=>{const r=h.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(Q,e,t+".handleUnsavedChanges",r)}):this._refreshEntity(!0).then(()=>(g.a.instance.reportSuccess(t),{})).catch(e=>{const r=h.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(Q,e,t+".handleUnsavedChanges.refreshEntity",r)})}const r=new U.a("Refresh action cannot be executed since form entity is null",2147746581);return x.a.getInstance().traceManager.getTracer(t).info("Refreshing on a non entity page"),Object(p.d)(Q,r,t+".entity")}catch(e){const r=h.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(Q,e,t,r)}}save(e){const t="ClientApi.XrmFormData.save",r=h.a.getInstance().getEventParameters(this._contextToken);if(!this._entity){const e=new U.a("Save action cannot be executed since form entity is null",2147746581);return Object(p.d)(Q,e,t+".entity")}try{g.a.instance.reportCall(t);let i=1;e&&e.saveMode&&(i=e.saveMode);return J(this._pageId,Q,i,r,this._contextToken,this.entity,!0,!0).then(e=>{if(e){const i={entityType:e.etn,id:n.a.toString(e.id),name:e.name};return Object(a.Kb)(Q.getState(),this._pageId)?(g.a.instance.reportSuccess(t),{savedEntityReference:i}):this._refreshEntity(!1).then(()=>(g.a.instance.reportSuccess(t),{savedEntityReference:i})).catch(e=>Object(p.d)(Q,e,t+".refresh",r))}if(Object(a.kb)(Q.getState(),{id:this._pageId},this._contextToken)||!this.entity.getIsDirty()){const e=this.entity.getEntityReference();return g.a.instance.reportSuccess(t),{savedEntityReference:e}}const i=new U.a("Save action was not executed and the form is dirty.",2147879192);return Object(p.d)(Q,i,t+".NoReference",null,!1)}).catch(e=>{if(e&&(2200000006===e.errorCode||2200000004===e.errorCode)){const e=this.entity.getEntityReference();return g.a.instance.reportSuccess(t),Promise.resolve({savedEntityReference:e})}return Object(p.d)(Q,e,t,r)})}catch(e){return Object(p.d)(Q,e,t,r)}}isValid(){var e,t,r;const n="ClientApi.XrmFormData.isValid";try{g.a.instance.reportCall(n);let a=!0;if(this.entity&&!this.entity.isValid())a=!1;else if(this.attributes)for(let e=0;e<this.attributes.getLength();e++)if(!this.attributes.get(e).isValid()){a=!1;break}if(a&&(null===(t=null===(e=this._formContext)||void 0===e?void 0:e.ui)||void 0===t?void 0:t.controls))for(let e=0;e<this._formContext.ui.controls.getLength();e++){const t=this._formContext.ui.controls.get(e);if("formcomponent"===t.getControlType()&&t.isLoaded()&&!(null===(r=t.data)||void 0===r?void 0:r.isValid())){a=!1;break}}return a||Q.dispatch(Object(z.b)(this._pageId,this._contextToken)),g.a.instance.reportSuccess(n),a}catch(e){const t=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(n,e,null,t),e}}addOnLoad(e){const t="ClientApi.XrmFormData.addOnLoad";e||Object(p.j)(t,"handler");try{g.a.instance.reportCall(t),Q.dispatch(Object(I.c)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,r),e}}removeOnLoad(e){const t="ClientApi.XrmFormData.removeOnLoad";e||Object(p.j)(t,"handler");try{g.a.instance.reportCall(t),Q.dispatch(Object(I.x)(this._contextToken,this._pageId,e)),g.a.instance.reportSuccess(t)}catch(e){const r=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,r),e}}}function J(e,t,r,i,s,o,c,l){const u=t.getState(),d=n.a.tryParseOrNull(o.getId());if(s.contextTokenType===G.a.GridRow){const r=[],n=Object(Y.T)(u,e,s.parentContextToken,s.parentContextToken.controlName);return o.attributes.forEach(e=>r.push(e.getName())),i.push({name:"functionName",value:"saveEmbeddedEntity"}),t.dispatch(Object(W.a)(e,o.getEntityName(),null==d?void 0:d.guid,null,r,null==n?void 0:n.guid,!1,s.parentContextToken))}if(Object(a.Kb)(u,e))return i.push({name:"functionName",value:"saveAndCloseFormDialogAction"}),t.dispatch(Object(q.a)(e));if(d&&!n.a.equals(d,n.a.EMPTY))return i.push({name:"functionName",value:"saveForm"}),t.dispatch(Object(B.e)(e,r));const h=Object(A.l)(t.getState(),e);return i.push({name:"functionName",value:"saveFormAndNavigate"}),t.dispatch(Object(B.f)(e,h,l,r,!1,c))}},LLfG:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="attribute.submitmode";function i(e,t,r,i){const s=Object(n.x)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:s,dataFieldName:r}}}},MgYC:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="form.ShowHeaderFieldsInFlyout.set";function i(e,t,r){const i=Object(n.v)(t);return{type:a,payload:{headerFieldsInFlyout:r},meta:{pageId:e,contextKey:i}}}},MoY7:function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n=r("arV0"),a=r("xhhr"),i=r("dHD5"),s=r("odYE"),o=r("i1f0"),c=r("Lyxw"),l=r("3/02"),u=r("NjDY"),d=r("b8TU"),h=r("unFF"),p=r("bT7G"),g=r("WPtp"),m=r("SAYH"),b=r("6QGX"),f=r("uhZ3"),y=r("jq7Z"),_=r("zmL5"),v=r("5ZBI"),S=r("pEXn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class O{constructor(e){this.previousReturn={EnableInMobile:!1,PowerBIGroupId:"",PowerBIDashboardId:"",PowerBIReportId:"",PowerBIFilter:"",TileId:"",TileUrl:"",PowerBIType:0,IsPowerBIEnabled:!1,FirstPartyIntegrationSiteUrl:"",PowerBISignedInState:"",setPowerBISignedInState:P,beginSecureSessionForResource:P},this._propKey=e}linkToParameter(e,t){const r=t.setPowerBISignedInState;e.setPowerBISignedInState=e=>r(this._pageId,e);const n=t.beginSecureSessionForResource;e.beginSecureSessionForResource=n}retrievePowerBIObject(e,t,r,g){var m,b;this._pageId=t.id;const f=t.descriptor.Parameters,O=Object(a.b)(e),T=r.Parameters[this._propKey],E=Object(u.z)(e);let w,F,x;Object(c.c)(e,l.Wc)&&(F=f.PowerBIReportId,x=T.PowerBIReportId,f.PowerBIFilter&&(w=function(e,t,r){const{entityTypeName:a,id:c}=Object(n.g)(e,t),l=Object(i.j)(e,t),u=Object(o.ac)(e,t,l),d=new s.a(a,c);try{const t=JSON.parse(r);let n=t.Filter;const a=t.Alias;for(const t in a){const r=a[t],i=Object(p.d)(e,u,d,r),s=i&&j(i)||null;if(Array.isArray(s)){const e=s.map(e=>C(e,!1)).join(",");n=n.split(t).join(e)}else n=I(n,[{placeholder:`"${t}"`,value:C(s,!0)},{placeholder:`'${t}'`,value:null===s?C(s,!0):`'${encodeURIComponent(s)}'`},{placeholder:t,value:C(s,!1)}])}return n}catch(e){return void v.a.error(S.w,[{name:"errorCategory",value:"PowerBIFilter"},{name:"errorMessage",value:null==e?void 0:e.message},{name:"callstack",value:null==e?void 0:e.stack},{name:"filter",value:r}])}}(e,this._pageId,f.PowerBIFilter)));const A=Object(y.a)(e,this._pageId).powerBISignedInState,N=Object(_.b)(e,this._pageId),D=Object(d.c)(e),k=Object(h.a)(e);return this.previousReturn={EnableInMobile:"true"===(null===(m=T.EnableInMobile)||void 0===m?void 0:m.toString().toLowerCase())||"true"===(null===(b=f.EnableInMobile)||void 0===b?void 0:b.toString().toLowerCase()),PowerBIGroupId:T.PowerBIGroupId||f.PowerBIGroupId,PowerBIDashboardId:T.PowerBIDashboardId||f.PowerBIDashboardId,PowerBIReportId:x||F,PowerBIFilter:w,TileId:T.TileId||f.TileId,TileUrl:T.TileUrl||f.TileUrl,PowerBIType:parseInt(T.PowerBIType,10)||parseInt(f.Type,10)||0,IsPowerBIEnabled:O.isPowerBIEnabled,FirstPartyIntegrationSiteUrl:O.firstPartyIntegrationSiteUrl,PowerBISignedInState:A,Tenant:E,ForceMobile:D<=k.sizes.Breakpoints.DimensionS,FormId:N,setPowerBISignedInState:P,beginSecureSessionForResource:P},this.previousReturn}getLatestData(){return this.previousReturn}}function I(e,t,r=0){const{placeholder:n,value:a}=t[r],i=e.split(n),s=r+1;if(s<t.length)for(const e in i)i[e]=I(i[e],t,s);return e=i.join(a)}function C(e,t){if(!t&&(null==e?void 0:e.length)>0){const t=Number(e);if(!isNaN(t)&&t.toString()===e)return JSON.stringify(t)}return JSON.stringify(e)}function j(e){if(Object(g.i)(e))return e.valueString;if(Object(g.g)(e))return m.a.toString(e.id);if(Object(g.k)(e))return e.reference&&m.a.toString(e.reference.id);if(Object(g.j)(e))return!Object(f.a)(e.value)&&e.value.toString();if(Object(g.h)(e)){const t=Object(b.h)(e);if(t){return t.map(e=>m.a.toString(m.a.fromExternalGuid(e.id)))}}else if(Object(g.f)(e)&&e.innerValue)return j(e.innerValue)}function P(){throw new Error("Not Replaced")}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const T="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlPowerBISelector";function E(){return(e,t,r,n,a)=>{v.a.info(r.controlId+"."+T+": createGetPowerBIData started");const i=new O(e);return i.retrievePowerBIObject(t,r,n,a),v.a.info(r.controlId+"."+T+": createGetPowerBIData finished"),i}}},"N+Ya":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n="navigation.item.label";function a(e,t,r,a){return{type:n,payload:{label:r,currentLanguageId:a},meta:{pageId:e,navigationItemId:t}}}},Nse0:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return s}));var n=r("BFlg"),a=r("Uv1Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="customcontrol.refreshCustomDataProvider";function s(e,t,r,s){return{type:"customcontrol.refreshCustomDataProvider.async",execute({dispatch:o,getState:c},l){const u=n.x+".refreshCustomDataProviderAction";return s().then(n=>(o(function(e,t,r,n){let a=new Array;n&&n.length>0&&(a=n.slice());return{type:i,payload:a,meta:{pageId:e,customControlId:t,dataSetParameterName:r}}}(e,t,r,n)),l.EventManager.ReportComponentSuccess(u),n)).catch(e=>(l.EventManager.ReportComponentFailure(u,Error(e)),Promise.reject(new a.a(e))))}}}},NtHU:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="header.bodyvisible";function i(e,t,r){const i=Object(n.v)(t);return{type:a,payload:r,meta:{pageId:e,contextKey:i}}}},OWbt:function(e,t,r){"use strict";r.d(t,"f",(function(){return ve})),r.d(t,"h",(function(){return ne})),r.d(t,"i",(function(){return de})),r.d(t,"j",(function(){return he})),r.d(t,"k",(function(){return pe})),r.d(t,"c",(function(){return se})),r.d(t,"d",(function(){return oe})),r.d(t,"a",(function(){return te})),r.d(t,"b",(function(){return re})),r.d(t,"e",(function(){return ae})),r.d(t,"g",(function(){return _e}));var n=r("4leG"),a=r("SAYH"),i=r("y60j"),s=r("Uv1Y"),o=r("i1f0"),c=r("Z/4N"),l=r("arV0"),u=r("odYE"),d=r("LbMF"),h=r("IqkD"),p=r("mIxf"),g=r("1qQb"),m=r("FZDd"),b=r("WY/A"),f=r("Dea/"),y=r("iZ7K"),_=r("5Oca"),v=r("Jj4w"),S=r("IVVt");var O=r("3hnk"),I=r("qTme"),C=r("dMZy"),j=r("lLEV"),P=r("5ZBI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const T="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlTimelineWallSelector";var E=r("E5qG"),w=r("dHD5"),F=r("EY5k"),x=r("YGjz"),A=r("3mEc"),N=r("8nT0"),D=r("Co7m"),k=r("bT7G"),M=r("AF/G"),R=r("1usl"),L=r("4Us1"),B=r("99zj"),V=r("E8F2"),G=r("YxC/"),U=r("HfZT"),X=r("74Tm"),z=r("9fGf"),q=r("/qEh"),H=r("ldGr"),W=r("NUHF"),Y=r("3/02"),Q=r("Lyxw"),K=r("N6E8"),J=r("455M"),Z=r("p8cR"),$=r("pF61"),ee=r("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const te="form.initialize",re="form.xrmready";function ne(e,t,r,n,c){const g=[{name:"formId",value:a.a.toString(e)},{name:"pageId",value:t},{name:"contextKey",value:Object(w.v)(r)}];return{type:"form.initialize.async",execute({dispatch:m,getState:b},f,_){const v=b(),S=Object(l.g)(v,t),{entityTypeName:I,data:C,recordSetQueryKey:F}=S,x=f.TraceManager.getTracer("Forms.InitializeForm"),k=[];let L;if(g.push({name:"isPreview",value:S&&S.isPreview}),g.push({name:"EntityName",value:S&&S.entityTypeName}),x.info("initializeForm started.",g),Object(Z.b)(function(e){return()=>{const t={},r={},n={};return(a,i,s,o,c)=>{P.a.info(T+s.controlId+": createGetTimelineWallData started");let l=!1;r.hasOwnProperty(a)&&r[a]||(r[a]=new j.a(e,a,s.id));const u=r[a],d=u.retrieveTimelineWallObject(i,s,o,c,e);n.hasOwnProperty(a)&&n[a]&&d===n[a]||(n[a]=d,l=!0);const h=u;return l&&(t[a]=h),P.a.info(T+s.controlId+": createGetTimelineWallData finished"),t[a]}}}(m),J.a.TimelineWall),x.info("BusinessProcessWrapperManager.Instance.init started.",g),k.push(D.a.Instance.init(f,b,m).then(()=>x.info("BusinessProcessWrapperManager.Instance.init completed.",g))),Object(O.a)(v,e))if(Object(l.m)(v,t)){if(!Object(O.g)(v,I,1,0)&&!(null==S?void 0:S.isPreview))return ie(22e8,m,x,_,v,t)}else{if(!Object(O.g)(v,I,2,0))return ie(2147746342,m,x,_,v,t)}const G=Object(i.j)(v,e),z=_e(v,G,e),$=be(v,I,G),ee=function(e,t,r,n){const a={};if(t&&t.RelatedEntityAttributes&&n)for(const i in t.RelatedEntityAttributes){const s=Object(y.x)(e,n,i);if(s&&s.ReferencedEntity){const n={},o=fe(e,s.ReferencedEntity,t.RelatedEntityAttributes[i]),c=Object(w.m)(r,i);a[Object(w.v)(c)]={attributes:o,submitModes:n}}}return a}(v,G,r,I),te=Object(X.a)(v),re=Object(h.s)(v);Se(v,m,e,z,$,t,r,ee,re),F&&!te&&m(Object(U.g)(t,F)),x.info("Update quick view forms started.",g);for(const n in G.InlineQuickForms){const a=G.InlineQuickForms[n];for(const s in a){const o=a[s],c=Object(i.j)(v,o),l=_e(v,c,o),u=be(v,s,c),d=Object(w.l)(r,n,s);Se(v,m,e,l,u,t,d,null,re)}}if(x.info("Update quick view forms completed.",g),C&&0!==Object.keys(C).length){const{createFromEntity:n,createFromRelationship:i}=S,{initWithEntity:c}=S;let h=n;!h&&c&&(h=c),L=function(e,t,r,n,i,c,h,g,m,b,f){r&&r.info("initializeFormWithDefaultValue started.",n);const _=Object(d.d)(e,c);let v=null;const S={},O=Object(l.m)(e,i),I=a.a.toString(g);let C,j;const P=[];I&&(v=Object(d.k)(e,I));for(const s of Object.keys(h)){if("processid"===s)continue;let l=_[s];if(!l&&v&&(l=v[s]),l&&!l.AttributeOf){const o=l.Type;switch(o){case"customer":case"owner":case"lookup":case"regarding":if("string"==typeof h[s]){const u=ce(h,s,l);if(!u){ue(r,s);continue}if(S[s]=u,!a.a.equals(a.a.EMPTY,u.id)&&"owner"!==o&&O&&(b||f))if(j){const e=j.then(()=>t(Object(q.b)(i,g)).then(()=>{r&&r.info("updateSnapshotWithOptions completed (1).",n)}));P.push(e)}else j=me(e,t,u,c,i,r,n,b,f),P.push(j)}else{let e;e=Array.isArray(h[s])?h[s][0]:h[s],e&&e.id&&a.a.tryParseOrNull(e.id)&&e.entityType&&(S[s]=new u.a(e.entityType,new a.a(e.id),e.name))}break;case"partylist":const d=h[s];let p=d;const m=[];try{"string"==typeof d&&(p=JSON.parse(d));for(const e of p)m.push(new u.a(e.entityType,new a.a(e.id),e.name))}catch(e){ue(r,s,"partylist")}S[s]=m;break;case"boolean":case"picklist":case"status":S[s]=h[s];break;case"uniqueidentifier":S[s]=new a.a(h[s]);break;default:S[s]=h[s]}}else if(-1!==s.indexOf(K.d)||"_CreateFromId"===s){let a=null;if(-1!==s.indexOf(K.d)&&(a=ce(h,K.d,l)),!a&&"_CreateFromId"===s){const t=Object(y.m)(e,h._CreateFromType),r=Object(y.h)(e,t);r&&(a=le(t,h._CreateFromId,r.DisplayName))}if(!a){ue(r,K.d);continue}if(!C&&(C=a,O))if(j){const e=j.then(()=>t(Object(q.b)(i,g)).then(()=>{r&&r.info("updateSnapshotWithOptions completed (2).",n)}));P.push(e)}else j=me(e,t,C,c,i,r,n,b,f),P.push(j);if(Object(y.h)(e,c).IsActivity&&-1===Object.keys(S).indexOf(N.t)&&Object(y.z)(e,c,C.etn,N.t)){const t=Object(o.ab)(e,i,m);t&&t[N.t]&&(S[N.t]=a)}}else{ue(r,s);if(Object(Q.c)(e,Y.Rc))return Promise.reject(Object(V.b)(e,i,2200000009))}}const T=Object(Q.c)(e,Y.L);let E=S;T&&(E=function(e,t,r,n,a){const i={},s=Object(w.w)(n),c=Object(o.P)(e,s,t,r);for(const s in a){if(!c||!c.hasOwnProperty(s)){i[s]=a[s];continue}const o=Object(d.a)(e,t,s);if(!(o&&o.ParentPicklistLogicalName)&&!Object(H.a)(e,n,r,t,c,s,{name:s,value:0})){i[s]=a[s];let c=[];for(o&&o.ChildPicklistLogicalNames&&(c=c.concat(o.ChildPicklistLogicalNames));c&&c.length>0;){const s=c.pop();if(a.hasOwnProperty(s)){const o=Object(d.a)(e,t,s),l=JSON.parse(a[o.ParentPicklistLogicalName]),u=JSON.parse(a[s]);Object(W.a)(e,r,n,o,t,l,u)&&(i[s]=a[s],o.ChildPicklistLogicalNames&&o.ChildPicklistLogicalNames.length>0&&(c=c.concat(o.ChildPicklistLogicalNames)))}}}}return i}(e,c,i,m,S));const F=ge(E);if(P.length>0)return Promise.all(P).catch(e=>{if(2147749377===e.errorCode||-2147093999===e.errorCode)return Promise.resolve(null);Object(s.b)(e)}).then(()=>(t(Object(p.a)(i,F,!0,!0)),r&&r.info("initializeFormWithDefaultValue completed at snapshotPromiseList.length > 0.",n),Promise.resolve(null)));return t(Object(p.a)(i,F,!0,!0)),r&&r.info("initializeFormWithDefaultValue completed at snapshotPromiseList.length == 0.",n),Promise.resolve(null)}(b(),m,x,g,t,I,C,e,r,h,i)}if(G&&G.Controls&&G.Controls.notescontrol){const e=Object(l.g)(v,t);x.info("loadTimelineConfigAndMetaData started.",g),m(Object(E.b)(G.Controls.notescontrol,e,n)).then(()=>{x.info("loadTimelineConfigAndMetaData completed.",g)})}if(G&&G.Controls)for(const e in G.Controls)if(G.Controls[e]){if(G.Controls[e].Id&&G.Controls[e].Id.startsWith("WebResource"))for(const t of G.Controls[e].Parameters)if("Url"===t.Name){let e=!1;if(c)for(const r of c){const n=t.Value&&t.Value.toLowerCase()||"";if(n.length>=r.length&&n.length-r.length===n.lastIndexOf(r)){e=!0;break}}if(!e){const e=Object(A.j)(v,t.Value);e&&!e.Name&&(x.info("retrieveWebResourceDescriptorByName started.",g),m(Object(B.c)(t.Value)).then(()=>{x.info("retrieveWebResourceDescriptorByName completed.",g)}))}}a.a.equals(G.Controls[e].ClassId,M.rb)&&v&&void 0===v.currentServerTime.serverTimeDiffInSeconds&&(x.info("retrieveServerTime started.",g),m(Object(R.b)(new u.a(I))).then(()=>{x.info("retrieveServerTime completed.",g)}))}return null!=L?L:(x.info("initializeForm completed.",g),Promise.all(k))},getFailureParameters:(e,t)=>g}}function ae(e,t,r,a,i,s,o){const c=t(Object(m.f)(s,!1,[])).then(()=>{const r=Object(y.h)(e(),s);if(r.IsChildEntity){const n=Object(O.d)(e(),r);return t(Object(m.f)(n.EntityLogicalName,!1,[]))}}),u=()=>{const i=e();if(!Object(O.b)(i,s))return ie(2200000001,t,r,a,i,o);const c=Object(O.c)(i,s),u=Object(n.d)(i);return c&&Object(l.m)(i,o)&&!u?ie(2200000002,t,r,a,i,o):void 0};return c?c.then(u):Promise.resolve(u())}function ie(e,t,r,n,a,i){const s=Object(V.d)(e);return t(Object(F.e)(s)).then(()=>{const t=Object(V.c)(e);if(r){const e=[{name:"CorrelationId",value:n.correlationId},{name:"ContextId",value:n.contextId},{name:"ActionStack",value:n.stack}];r.debug(t,e)}const o=Object(G.e)(a,s),c=Object(G.c)(o,s[0]),l=Object(G.c)(o,s[1]);throw Object(V.b)(a,i,e,t,c,l)})}function se(e,t,r,n,a,i,s,c,g){g.push({name:"AutoPopulateFieldsTimeStamp",value:Date.now()}),c&&c.info("autoPopulateFields started.",g);const m=Object(d.d)(e,r);if(!m)return void(c&&c.warn("attributes is null.",g));const b=e=>e&&e.OptionSet&&Object.keys(e.OptionSet).length>0,{id:f}=Object(l.g)(e,n),y=new u.a(r,f),_={},v=Object(o.ac)(e,n,s);for(const t of a.concat(i)){const r=m[t];if(r&&(a.indexOf(t)>=0&&i.indexOf(t)>=0||b(r))){if(!Object(o.X)(e,n,s,v,y,r.LogicalName)){switch(t){case N.q:const r=Object(h.q)(e),n=Object(h.t)(e);if(r&&n){const e=new u.a(x.a,r,n);_[t]=e}break;case N.w:if(!Object(k.d)(e,v,null,N.w)){const r=Object(h.b)(e);if(r){const e=new u.a(x.b,r.transactionCurrencyId,r.currencyName);_[t]=e}}}if(b(r)){const n=Object(k.d)(e,v,new u.a(r.EntityLogicalName),t),i=n?parseInt(n.valueString,10):null!=r.DefaultValue?r.DefaultValue:t===N.u?0:void 0;if(void 0===i||i<0||(_[t]=i),t===N.u&&-1!==a.indexOf(N.v)){const e=m[t];if(e&&e.OptionSet&&Object.keys(e.OptionSet).length>0){const e=r.OptionSet.find(e=>e.Value===i),t=e?e.DefaultStatus:m[N.v].DefaultValue||0;t<0||(_[N.v]=t)}}}}}}const S=ge(_);t(Object(p.a)(n,S,!0,!0)),c.info("autoPopulateFields completed.",g)}function oe(e,t,r,n,i,s,o){const{id:c}=Object(l.g)(e,n),d=new u.a(r,c),h={};if(a.a.isNullOrEmpty(d.id)&&!o)return function(e,t,r,n,i){const s=Object(_.d)(e,r);if(null!=s)return Promise.resolve(s);return t(Object(L.a)(a.a.EMPTY,new u.a(r,a.a.EMPTY))).then(e=>e&&e.businessProcessFlows?Promise.resolve(a.a.tryParse(Object.keys(e.businessProcessFlows)[0])):Promise.resolve(null)).catch(e=>{const t=[{name:"CorrelationId",value:i.correlationId},{name:"ContextId",value:i.contextId},{name:"ActionStack",value:i.stack},{name:"entityName",value:r},{name:"reason",value:e&&e.message?e.message:JSON.stringify(e)}];return n.EventManager.ReportComponentFailure("Forms.InitializeForm",Error("Catch block of InitializeForm.retrieveBusinessProcessFlow"),void 0,t),n.TraceManager.getTracer("Forms.InitializeForm").error("Error while executing getBusinessProcessFlowDefaultIdForEntity in the retrieveBusinessProcessFlow promise.",t),Promise.resolve(null)})}(e,t,r,i,s).then(e=>{e&&(h.processid=e.guid);const r=ge(h);return t(Object(p.a)(n,r,!0,!0)),Promise.resolve()});o&&(h.processid=o);const g=ge(h);return t(Object(p.a)(n,g,!0,!0)),Promise.resolve()}function ce(e,t,r){let n=t;!t.match(/id$/i)&&t.indexOf(K.d)>-1&&(n+="id");const i=e[n];if(null!=i){if(a.a.validate(i)){const n=i,a=e[t+"name"];let s=e[t+"type"]||e[t+"target"];return!s&&r.Targets&&r.Targets.length>0&&(s=r.Targets[0]),le(s,n,a)}try{const e=JSON.parse(i);if(e)return le(e.entityType,e.id,e.name)}catch(e){}}return null}function le(e,t,r){if(e&&t&&a.a.validate(t)){const n=new a.a(t);if(!a.a.isNullOrEmpty(n))return new u.a(e,n,r)}return null}function ue(e,t,r){if(e){const n=[{name:"key",value:t},{name:"source",value:r}];e.warn("Value passed is not in correct syntax.",n)}}function de(e,t,r,n,a,i,s,o){return he(e,t,r,n,i,s,o).then(()=>pe(e,t,r,a,i,s,o))}function he(e,t,r,n,a,i,s){if(!Object(o.Eb)(e,a)&&Object($.n)(e,a))return i&&i.warn("pageId"+a+" is dead so rejecting loadScripts"),Promise.reject(Object(V.b)(e,a,2200000008,"Page has expired."));i&&i.info("loadScripts started.",s);return r(t.ScriptManager.getContainer(a).getEventManager().loadScripts(n,a)).then(()=>{i&&i.info("loadScripts completed",s)})}function pe(e,t,r,n,a,i,s){if(!Object(o.Eb)(e,a)&&Object($.n)(e,a))return void(i&&i.warn("pageId "+a+" is dead so won't run runFormOnLoadScripts",s));i&&i.info("runFormOnLoadScripts started.",s);const c=t.ScriptManager.getContainer(a).getEventManager();r(c.addPblEvent(n)),r(c.runOnLoad(n,1)),r(c.runOnDataLoad(n,1)),i&&i.info("runFormOnLoadScripts completed.",s)}function ge(e){const t={};for(const r in e){const n={fieldName:r,value:e[r]};t[r]=n}return t}function me(e,t,r,n,a,i,o,c,l){const d=Object(w.j)(e,a),h=Object(w.x)(d);return i&&i.info("createAndSetDataSnapshotFrom started.",o),t(function(e,t,r,n,a){return{type:"snapshot.from.async",execute({dispatch:i,getState:o},c){const l=c.DataSource,d=u.a.toLegacyEntityReference(e),h=new v.a(d,t,S.a.All),p=l.execute(h,null).nativePromise();let O=null,I=null,C=null;return p.then(e=>{const r=e.get_entity();return O=Object(g.a)(r),I=O.fields,C=O.identifier,i(Object(m.f)(t,!1,Object.keys(O.fields)))},e=>{const r=Object(s.c)(e);if(e&&e.get_ErrorCode&&(-2147093999===e.get_ErrorCode()||r&&-2147217919===r.getNegativeErrorCode())&&n){const e=[];if(I={},n.etn){const r=Object(y.c)(o(),n.etn,t);if(r)for(const t of r)t.ReferencingAttribute&&e.push(t.ReferencingAttribute)}else a&&e.push(a.attributeName);for(const t of e){if(!n.name&&n.id){const e=Object(_.h)(o(),n.etn,n.id.guid);if(e&&e.fields){const t=Object(y.E)(o(),n.etn);let r=e.fields[t];r&&r.value||(r=e.fields.name),r&&r.value&&(n={etn:n.etn,id:n.id,name:r.value})}}I[t]={reference:n,timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}}}return C=new u.a(t),i(Object(m.f)(t,!1,e))}Object(s.b)(e)}).then(()=>{const e=Object(b.b)(o(),C,I,r,f.a.Create),t=e.payload.snapshotId;return i(e),t})}}}(r,n,h,c,l)).then(e=>{i&&(o.push({name:"newSnapshotId",value:e?e.toString():"<null>"}),i.info("initializeCreateDataSnapshotFrom completed.",o)),t(Object(I.b)(a,e,d)).then(()=>{i&&i.info("createAndSetDataSnapshotFrom completed.",o)})})}function be(e,t,r){let n={};if(r&&r.Attributes&&t){const a=Object(A.d)(e,r.FormLibraries,[t]);if(r.Attributes||a){const i=[].concat(r.Attributes,a);-1===i.indexOf(N.u)&&i.push(N.u),n=fe(e,t,i)}}return{attributes:n,submitModes:{}}}function fe(e,t,r){const n={};if(r&&t)for(let a=0;a<r.length;a++){const i=r[a];if(i){const r=Object(o.L)(e,t,i);r&&(n[i]=r)}}return n}function ye(e){return Array.isArray(e)?e:e.Controls?e.Controls:null}function _e(e,t,r){const n={},a={},i={},s={bodyVisible:!0,commandBarVisible:!0,tabNavigatorVisible:!0},l={visible:!0};let u={navBarAreas:{},navPaneIsvItems:{},navBarByRelationshipItems:{},navBarItems:{}};if(t&&t.Tabs&&t.TabNames){const r=Object(o.m)(e,t);let s=!1;for(const o of r){const r={collapsed:!!s||!(o.Expanded&&o.Visible),visible:o.Visible,label:o.Label,sectionNames:[],domId:o.DomId,showLabel:o.ShowLabel,contentType:null};switch(o.ContentType){case"expandAvailableSpace":case"singleComponent":r.contentType="singleComponent";break;default:r.contentType="cardSections"}s=s||o.Expanded&&o.Visible;const l=[];if(o.Columns)for(let r=0;r<o.Columns.length;r++){const n=o.Columns[r];if(n.SectionNames)for(let r=0;r<n.SectionNames.length;r++){const s=n.SectionNames[r];if(t.Sections[s]){const r=t.Sections[s];l.push(s);const n=[];for(const e of t.Sections[s].Rows)for(const t of e.Cells)t.ControlName&&n.push(t.ControlName);const u={parentTabId:o.Id,visible:r.Visible,label:r.Label,controlNames:n,domId:r.DomId,semanticZoomDomId:r.SemanticZoomDomId};a[s]=u;for(let r=0;r<n.length;r++){const a=n[r];if(t.Controls[a]){const r=t.Controls[a],n=ve(r,s,!0),o=Object(c.a)(r,t,Object(z.b)(e));null!=o&&(n.visible=n.visible||o.ShouldOverrideControlVisible),Oe(n),i[a]=n}}}}}if(o.Header)for(const e of o.Header)i[e.Name]=ve(e,null,!0);if(o.Footer)for(const e of o.Footer)i[e.Name]=ve(e,null,!0);r.sectionNames=l,n[o.Id]=r}}if(t&&t.Navigation&&(u=t.Navigation),t&&t.Header){const e=ye(t.Header);if(e)for(const t of e)i[t.Name]=ve(t,null,!0),Oe(i[t.Name]);s.bodyVisible=!1!==t.Header.BodyVisible,s.commandBarVisible=!1!==t.Header.CommandBarVisible,s.tabNavigatorVisible=!1!==t.Header.TabNavigatorVisible}if(t&&t.Footer){const e=ye(t.Footer);if(e)for(const t of e)i[t.Name]=ve(t,null,!0),Oe(i[t.Name]);l.visible=!1!==t.Footer.Visible}return{formId:r,tabs:n,sections:a,controls:i,selectedTab:Object(C.a)(),selectedRelatedEntity:null,isSaving:!1,invalidControls:{},invalidAttributes:{},controlUnboundOutputs:{},inlineQuickForms:t&&t.InlineQuickForms?t.InlineQuickForms:null,xrmReady:!1,label:"",navigation:u,viewportWidth:0,viewportHeight:0,showHeaderFieldsInSection:!1,headerFieldsInFlyout:new Set,isAutoSaving:!1,header:s,footer:l}}function ve(e,t,r){return e?{parentSectionName:t,visible:e.Visible,label:e.Label,valid:r,labelSource:e.LabelSource,domId:e.DomId,parameters:e.Parameters,dataFieldName:e.DataFieldName,relationship:e.Relationship}:null}function Se(e,t,r,n,i,s,c,l=null,u){const d=Object(o.cb)(e,s,c),h=Object(ee.a)(e,s);a.a.equals(null==d?void 0:d.formId,null==n?void 0:n.formId)&&a.a.equals(r,null==h?void 0:h.formId)||t(function(e,t,r,n,a,i=null,s){return{type:te,payload:{formId:e,formUIState:t,formMetadataState:r,relatedEntityMetadataState:i,currentLanguageId:s},meta:{pageId:n,contextToken:a}}}(r,n,i,s,c,l,u))}function Oe(e){e&&e.parameters&&e.parameters.DefaultViewId&&(e.parameters.defaultviewid=e.parameters.DefaultViewId)}},PZ34:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("ruPX"),a=r("baQL");function i(e,t){return Object(n.a)(a.a,{},t,e)}},PbI6:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="tab.contentType";function i(e,t,r,i){const s=Object(n.v)(r);return{type:a,payload:i,meta:{pageId:e,tabId:t,contextKey:s}}}},Q1Tc:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return i}));var n=r("dHD5"),a=r("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="control.update.unboundOutputs";function s(e,t,r,s){return{type:"control.update.unboundOutputs.async",execute({dispatch:o,getState:c}){if(!Object.keys(s).length)return Promise.resolve();const l=c(),u=Object(a.a)(l,e);let d=!1;const h=Object(n.v)(r),p=Object.assign({},u.forms[h].controlUnboundOutputs);for(const e in s){const r=s[e],n=t+"."+e;p[n]!==r&&(p[n]=r,d=!0)}return d&&o(function(e,t,r){return{type:i,payload:{controlUnboundOutputs:r},meta:{pageId:e,contextKey:t}}}(e,h,p)),Promise.resolve()}}}},QXpm:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return o}));var n=r("dHD5"),a=r("BFlg"),i=r("LAGg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="grid.toggleRollupView";const o=(e,t,r)=>function(e,t,r,s){return{type:"grid.toggleRollupView.async",execute({dispatch:o},c){const l=c.TraceManager.getTracer(a.z),u=a.x+".toggleRollupViewAction";try{l.info(`Setting Toggle value to ${t} for the grid.`);const a=Object(n.v)(s);o(function(e,t,r,n){return{type:e,payload:t,meta:{pageId:r,dataSetContextKey:n}}}(e,t,r,a)),o(Object(i.b)(r,s));const d=[{name:"newValue",value:t}];return c.EventManager.ReportComponentSuccess(u,d),Promise.resolve()}catch(e){const t="Setting Toggle value to the grid failed";c.EventManager.ReportComponentFailure(u,Error(t))}}}}(s,e,t,r)},SVnG:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("+aBC"),a=r("Nse0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i={};function s(e=i,t){return t.type===a.a?Object.assign(Object.assign({},e),{[Object(n.a)(t.meta.customControlId,t.meta.dataSetParameterName)]:t.payload}):e}},TAjd:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n;r.d(t,"a",(function(){return n})),function(e){e.collapsed="collapsed",e.expanded="expanded",e.floating="floating",e.getDefaultDisplayState=function(){return e.collapsed}}(n||(n={}))},TD3W:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n="form.relationship.clear";function a(e,t){return{type:n,payload:{relationship:t},meta:{pageId:e}}}},Tg1Y:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="form.tab.selectPrevious";function i(e,t){const r=Object(n.v)(t);return{type:a,payload:null,meta:{pageId:e,contextKey:r}}}},TsER:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="refresh.timer";function i(e,t,r){const i=Object(n.x)(t);return{type:a,payload:null,meta:{pageId:e,contextKey:i,controlName:r}}}},UqyN:function(e,t,r){"use strict";r.d(t,"a",(function(){return De})),r.d(t,"b",(function(){return ke}));var n=r("0nOn"),a=r("SAYH"),i=r("WPtp"),s=r("odYE"),o=r("ZIjf"),c=r("LbMF"),l=r("UJfx"),u=r("bT7G"),d=r("mlKL"),h=r("LLfG"),p=r("i1f0"),g=r("BvQu"),m=r("Sbn7"),b=r("mIxf"),f=r("1kth"),y=r("16wZ"),_=r("qshH"),v=r("dHD5"),S=r("iZ7K"),O=r("3tOH"),I=r("z5LE"),C=r("3HPu"),j=r("jTSi"),P=r("jq7Z"),T=r("fU7K"),E=r("O7zD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const w="ClientApi.XrmEntityAttribute.";let F;class x{constructor(e,t,r,a,i,s){F=e,this._clientApiExecutorAttribute=new n.a(e,w,r,t),this._clientApiExecutorAttribute.addEventParameter({name:"attributeName",value:a,isEventParam:!0});const o=this._clientApiExecutorAttribute.getComponentName("constructor");a||Object(y.j)(o,"attributeName"),e||Object(y.j)(o,"store"),r||Object(y.j)(o,"pageId"),t||Object(y.j)(o,"contextToken"),s||Object(y.j)(o,"xrmFormUi"),this._attributeName=a,this._parentEntity=i,this._pageId=r,this.xrmFormUi=s,this._contextToken=t}get controls(){return this._clientApiExecutorAttribute.execute("controls",(e,t)=>{if(!this._controls){this._controls=new m.a(e);const t=Object(p.z)(F.getState(),this._pageId,this.contextToken,this._attributeName);if(t){this.xrmFormUi.getControls();const e=this.xrmFormUi.controls;for(let r=0;r<t.length;r++){const n=t[r],a=e.get(n);a&&this._controls.add(n,a)}}}return this._controls})}addOnChange(e){const t=w+"addOnChange";e||Object(y.j)(t,"handler");try{o.a.instance.reportCall(t),F.dispatch(Object(f.a)(this.contextToken,this._pageId,this.getName(),e)),o.a.instance.reportSuccess(t)}catch(e){const r=_.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),_.a.getInstance().reportFailure(t,e,null,r),e}}fireOnChange(){const e=w+"fireOnChange";try{o.a.instance.reportCall(e),F.dispatch(Object(f.P)(this.contextToken,this._pageId,this.getName())),o.a.instance.reportSuccess(e)}catch(t){const r=_.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),_.a.getInstance().reportFailure(e,t,null,r),t}}getAttributeType(){const e=w+"getAttributeType";try{o.a.instance.reportCall(e);const t=this.getAttrDescriptor().Type;return o.a.instance.reportSuccess(e),t}catch(t){const r=_.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),_.a.getInstance().reportFailure(e,t,null,r),t}}getFormat(){return this._clientApiExecutorAttribute.execute("getFormat",()=>{const e=this.getAttrDescriptor();if(!e||!e.Format)return null;const t=e.Format.toLowerCase();let r=t;switch(this.getAttrDescriptor().Type){case"string":"text"===r||"email"===r||"phone"===r||"url"===r||"tickersymbol"===r||"1"!==t&&"2"!==t||(r="textarea");break;case"integer":"duration"!==r&&(r="none");break;case"lookup":"0"===t&&(r="none");break;case"memo":"2"!==t&&"1"!==t||(r="textarea");break;default:"0"===t?r="none":void 0===r&&(r=null)}return r})}getIsDirty(){const e=w+"getIsDirty";try{o.a.instance.reportCall(e);const t=Object(p.Jb)(F.getState(),this.getPageId(),this.dataContextToken,this.getName())&&Object(u.e)(F.getState(),Object(p.ac)(F.getState(),this.getPageId(),this.dataContextToken),this.getName());return o.a.instance.reportSuccess(e),t}catch(t){const r=_.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),_.a.getInstance().reportFailure(e,t,null,r),t}}getName(){return o.a.instance.reportUsage(w+"getName"),this._attributeName}getParent(){return o.a.instance.reportUsage(w+"getParent"),this._parentEntity}getRequiredLevel(){const e=w+"getRequiredLevel";try{o.a.instance.reportCall(e);const t=Object(p.pc)(F.getState(),this._pageId,this.dataContextToken,this.getName());let r;switch(t){case 2:case 1:r="required";break;case-1:case 0:r="none";break;case 3:r="recommended";break;default:Object(y.h)(e,"RequiredLevel",t)}return o.a.instance.reportSuccess(e),r}catch(t){const r=_.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),_.a.getInstance().reportFailure(e,t,null,r),t}}getSubmitMode(){const e=w+"getSubmitMode";try{o.a.instance.reportCall(e);const t=Object(p.zc)(F.getState(),this._pageId,this.contextToken,this.getName());let r;switch(t){case g.a.Dirty:r="dirty";break;case g.a.Always:r="always";break;case g.a.Never:r="never";break;default:Object(y.h)(e,"SubmitMode",t)}return o.a.instance.reportSuccess(e),r}catch(t){const r=_.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),_.a.getInstance().reportFailure(e,t,null,r),t}}getUserPrivilege(){const e=w+"getUserPrivilege";try{o.a.instance.reportCall(e);let t=null;if(F.getState()&&this._parentEntity&&this._attributeName){const e=Object(l.a)(F.getState(),this._parentEntity.getEntityName(),a.a.fromExternalGuid(this._parentEntity.getId()),this._attributeName);e&&(t={canCreate:e.canCreate,canRead:e.canRead,canUpdate:e.canUpdate})}return o.a.instance.reportSuccess(e),t}catch(t){const r=_.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),_.a.getInstance().reportFailure(e,t,null,r),t}}getValue(){const e=w+"getValue";try{o.a.instance.reportCall(e);const t=this.getValueInternal();let r=null;return Object(y.a)(t)||(Object(i.j)(t)?r=t.value:Object(y.k)(e,"isPlainValue","value")),o.a.instance.reportSuccess(e),r}catch(t){const r=_.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),_.a.getInstance().reportFailure(e,t,null,r),t}}removeOnChange(e){const t=w+"removeOnChange";e||Object(y.j)(t,"handler");try{o.a.instance.reportCall(t),F.dispatch(Object(f.v)(this.contextToken,this._pageId,this.getName(),e)),o.a.instance.reportSuccess(t)}catch(e){const r=_.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),_.a.getInstance().reportFailure(t,e,null,r),e}}setRequiredLevel(e){const t=w+"setRequiredLevel";e||Object(y.j)(t,"requiredLevel"),"none"!==e&&"recommended"!==e&&"required"!==e&&Object(y.h)(t,"RequiredLevel",e);try{let r;switch(o.a.instance.reportCall(t),e){case"none":r=0;break;case"recommended":r=3;break;case"required":r=2}F.dispatch(Object(d.b)(this._pageId,this.dataContextToken,this._attributeName,r)),o.a.instance.reportSuccess(t)}catch(e){const r=_.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),_.a.getInstance().reportFailure(t,e,null,r),e}}setSubmitMode(e){const t=w+"setSubmitMode";e||Object(y.j)(t,"mode"),"dirty"!==e&&"always"!==e&&"never"!==e&&Object(y.h)(t,"SubmitMode",e);try{let r;switch(o.a.instance.reportCall(t),e){case"dirty":r=g.a.Dirty;break;case"always":r=g.a.Always;break;case"never":r=g.a.Never}F.dispatch(Object(h.b)(this._pageId,this.contextToken,this.getName(),r)),o.a.instance.reportSuccess(t)}catch(e){const r=_.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),_.a.getInstance().reportFailure(t,e,null,r),e}}setValue(e){const t=w+"setValue";try{o.a.instance.reportCall(t),this.setValueInternal(e),o.a.instance.reportSuccess(t)}catch(e){const r=_.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),_.a.getInstance().reportFailure(t,e,null,r),e}}setIsValid(e,t){return this._clientApiExecutorAttribute.execute("setIsValid",(r,n)=>{e?(F.dispatch(Object(C.b)(this._pageId,this._attributeName,!0,this.contextToken)),F.dispatch(Object(j.b)(this.contextToken,this._pageId,Object(E.d)(this._pageId,this._attributeName))),F.dispatch(Object(I.b)(F.getState(),this._pageId,this._attributeName,null,this.contextToken))):this._addNotification(t)})}_addNotification(e){F.dispatch(Object(C.b)(this._pageId,this._attributeName,!1,this.contextToken));const t={messages:[e],notificationLevel:O.a.error};F.dispatch(Object(I.b)(F.getState(),this._pageId,this._attributeName,t,this.contextToken))}isValid(){const e=w+"isValid";try{o.a.instance.reportCall(e);const t=this.getValueInternal(),r=this.getParent();if(r){const n=Object(S.h)(F.getState(),r.getEntityName());if(n&&n.PrimaryIdAttribute!==this.getName()&&r.getId()!==a.a.EMPTYSTRING&&"required"===this.getRequiredLevel()&&Object(y.a)(t))return o.a.instance.reportSuccess(e),!1}let n=!0;return this.hasErrorNotification()?n=!1:t&&t.validationResult&&(n=t.validationResult.isValueValid),o.a.instance.reportSuccess(e),n}catch(t){const r=_.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),_.a.getInstance().reportFailure(e,t,null,r),t}}hasErrorNotification(){const e=Object(v.v)(this.contextToken),t=F.getState(),r=Object(P.a)(t,this._pageId);if(r.forms&&r.forms[e]&&(r.forms[e].invalidControls||r.forms[e].invalidAttributes)){return!0===r.forms[e].invalidControls[this.getName()]||!0===r.forms[e].invalidAttributes[this.getName()]}return!1}getPageId(){return this._pageId}getAttrDescriptor(){if(this.getParent()){let e=Object(p.r)(F.getState(),this.getParent().getEntityName(),this.getName(),this._pageId,this.contextToken);return e||(e=Object(c.a)(F.getState(),this.getParent().getEntityName(),this.getName())),e}return Object(p.Nc)(F.getState(),this.getPageId(),this.getName())}getDataXmlInternal(){let e="";return e=e+"<"+Object(T.CrmXmlEncode)(this.getName())+">"+Object(T.CrmXmlEncode)(this.getValue())+"</"+Object(T.CrmXmlEncode)(this.getName())+">",e}setValueInternal(e){const t=this.getName(),r={};r[t]={fieldName:t,value:e},F.dispatch(Object(b.a)(this._pageId,r,!1,!0,this.getParent()?this.getParent().getEntityName():null,this.getParent()?this.getParent().getId():null,Object(v.t)(this._contextToken),this.contextToken))}get parentEntityReference(){let e,t;return this.getParent()?(e=this.getParent().getEntityName(),t=this.getParent().getId()):this.contextToken.formId&&(e=this.contextToken.formId.guid),t?new s.a(e,new a.a(t)):new s.a(e)}getValueInternal(){const e=Object(p.ac)(F.getState(),this.getPageId(),this.dataContextToken);return Object(p.X)(F.getState(),this._pageId,this._contextToken,e,this.parentEntityReference,this._attributeName,F.dispatch)}get contextToken(){return Object(v.r)(this._contextToken)}get dataContextToken(){return this._contextToken}}var A=r("5Oca"),N=r("6QGX");class D extends x{getOption(e){const t="ClientApi.XrmEntityAttributeOptionSetBase.getOption";if(Object(y.a)(e))return null;const r="number"==typeof e?e:parseInt(e,10);isNaN(r)&&Object(y.k)(t,"number","value");try{o.a.instance.reportCall(t);const r=this.getAttrDescriptor().OptionSet;let n=null;for(let t=0;t<r.length;t++)r[t].Value===e&&(n={text:r[t].Label,value:r[t].Value});return o.a.instance.reportSuccess(t),n}catch(e){throw _.a.getInstance().getEventParameters(this.contextToken).push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(t,e),e}}getOptions(){const e="ClientApi.XrmEntityAttributeOptionSetBase.getOptions";try{o.a.instance.reportCall(e);const t=this.getAttrDescriptor().OptionSet.map(e=>({text:e.Label,value:e.Value}));return o.a.instance.reportSuccess(e),t}catch(t){throw _.a.getInstance().getEventParameters(this.contextToken).push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(e,t),t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let k,M;class R extends D{constructor(e,t,r,n,a,i){super(e,t,r,n,a,i),k=e}getInitialValue(){const e="ClientApi.XrmEntityAttributeBoolean.getInitialValue";try{o.a.instance.reportCall(e);const t=Object(A.j)(k.getState(),this.parentEntityReference,this.getName()),r=t?parseInt(t.valueString,10):null;return o.a.instance.reportSuccess(e),r}catch(t){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}getValue(){const e="ClientApi.XrmEntityAttributeBoolean.getValue";try{o.a.instance.reportCall(e);const t=this.getValueInternal(),r=Object(N.a)(t);return o.a.instance.reportSuccess(e),r}catch(t){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}setValue(e){const t="ClientApi.XrmEntityAttributeBoolean.setValue";Object(y.a)(e)||"boolean"!=typeof e&&Object(y.k)(t,"boolean","value");try{o.a.instance.reportCall(t),this.setValueInternal(e),o.a.instance.reportSuccess(t)}catch(e){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}}getAttributeType(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributeBoolean.getAttributeType"),"boolean"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class L extends D{constructor(e,t,r,n,a,i){super(e,t,r,n,a,i),M=e}getInitialValue(){const e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getInitialValue";try{o.a.instance.reportCall(e);const t=Object(A.j)(M.getState(),this.parentEntityReference,this.getName()),r=Object(N.e)(t);return o.a.instance.reportSuccess(e),r}catch(t){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}getSelectedOption(){const e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getSelectedOption";try{o.a.instance.reportCall(e);let t=null;const r=this.getValue();return r&&(t=[],r.forEach(e=>{const r=this.getOption(e);r&&t.push(r)})),o.a.instance.reportSuccess(e),t}catch(t){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}getText(){const e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getText";try{o.a.instance.reportCall(e);let t=null;const r=this.getSelectedOption();return r&&(t=[],r.forEach(e=>{t.push(e.text)})),o.a.instance.reportSuccess(e),t}catch(t){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}getValue(){const e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getValue";try{o.a.instance.reportCall(e);const t=this.getValueInternal();let r=null;return t&&(r=Object(N.e)(t)),o.a.instance.reportSuccess(e),r}catch(t){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}getAttributeType(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributeMultiSelectOptionSet.getAttributeType"),"multiselectoptionset"}setValue(e){const t="ClientApi.XrmEntityAttributeMultiSelectOptionSet.setValue";try{o.a.instance.reportCall(t),Array.isArray(e)?this.setValueInternal(e):this.setValueInternal([]),o.a.instance.reportSuccess(t)}catch(e){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}}}var B=r("Xd5/"),V=r("xkcG"),G=r("MXaZ"),U=r("Ae6N");let X;class z extends x{constructor(e,t,r,n,a,i){super(e,t,r,n,a,i),X=e}getDataXmlInternal(){let e=this.getValue();null!==e&&(e=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes()));const t=Object(T.CrmXmlEncode)(this.getName());let r="";return r+=`<${t}>`,r+=""+(null===e?"":Object(T.CrmXmlEncode)(e.format("s"))),r+=`</${t}>`,r}getValue(){const e="ClientApi.XrmEntityAttributeDateTime.getValue";try{o.a.instance.reportCall(e);const t=this.getValueInternal();let r=null;if(Object(i.j)(t)&&!Object(y.a)(t.formatted)){const e=this.getAttrDescriptor();r=Object(N.b)(X.getState(),e,t)}return o.a.instance.reportSuccess(e),r}catch(t){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}_userSettings(){return this.xrmFormUi.formContext.context?this.xrmFormUi.formContext.context.userSettings:new V.a(X)}getUtcValue(){const e="ClientApi.XrmEntityAttributeDateTime.getUtcValue";try{o.a.instance.reportCall(e);const t=this.getValue();return o.a.instance.reportSuccess(e),t}catch(t){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}setValue(e){const t="ClientApi.XrmEntityAttributeDateTime.setValue";Object(y.a)(e)||"[object Date]"!==Object.prototype.toString.call(e)&&Object(y.k)(t,"Date","value");try{if(o.a.instance.reportCall(t),Object(y.a)(e))this.setValueInternal(e);else if("[object Date]"===Object.prototype.toString.call(e)){const t=new Date,r=this.getAttrDescriptor(),n=Object(B.z)(X.getState(),r),a=6e4*this._userSettings().getTimeZoneOffsetMinutes(),i=Object(G.o)(new Date(t.getFullYear(),t.getMonth(),t.getDate()),n.userSettings.timeZoneAdjusters)-Object(G.o)(e,n.userSettings.timeZoneAdjusters),s=6e4*e.getTimezoneOffset();let o=null;switch(n.controlAttributes.Behavior){case U.a.UserLocal:o=new Date(e.getTime()+s+a-i);break;default:o=new Date(e.getTime())}this.setValueInternal(o)}o.a.instance.reportSuccess(t)}catch(e){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}}setUtcValue(e){const t="ClientApi.XrmEntityAttributeDateTime.setUtcValue";try{o.a.instance.reportCall(t),this.setValue(e),o.a.instance.reportSuccess(t)}catch(e){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}}getAttributeType(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributeDateTime.getAttributeType"),"datetime"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let q;class H extends x{constructor(e,t,r,n,a,i){super(e,t,r,n,a,i),q=e}getIsPartyList(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributeLookup.getIsPartyList"),!1}getDataXmlInternal(){const e=this.getValue();let t="";if(null!==e&&e.length>0)t+=this.getLookupDataXml(this.getName(),e[0]);else{const e=Object(T.CrmXmlEncode)(this.getName());t+=`<${e}>`,t+=`</${e}>`}return t.toString()}getLookupDataXml(e,t){const r=Object(T.CrmXmlEncode)(e);let n="<"+r;const a=this.getEntityTypeCode(t.entityType);return a>0&&(n+=` type="${Object(T.CrmXmlAttributeEncode)(a.toString())}"`),t.entityType&&(n+=` typeName="${Object(T.CrmXmlAttributeEncode)(t.entityType)}"`),Object(y.a)(t.name)||(n+=` name="${Object(T.CrmXmlAttributeEncode)(t.name)}"`),n+=`>${Object(T.CrmXmlEncode)(t.id)}</${r}>`,n}getEntityTypeCode(e){return Object(S.p)(q.getState(),e)}setValue(e){const t="ClientApi.XrmEntityAttributeLookup.setValue";let r=null;if(e&&Array.isArray(e)&&e.length>0){let n;e.length>1?Object(y.k)(t,"LookupValue[] of size not more than one.","value"):e[0].entityType?e[0].id?a.a.tryParseOrNull(e[0].id)||Object(y.h)(t,"guid",e[0].id):Object(y.j)(t,"value[0].id"):Object(y.j)(t,"value[0].entityType");try{n=Object(p.Ob)(q.getState(),this.getPageId(),this.dataContextToken,this.getName())}catch(e){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(t+".getLookupTargets",e,null,r),e}if(n&&!(n.indexOf(e[0].entityType)>-1)){const r=_.a.getInstance().getEventParameters(this.contextToken);r.push({name:"attributeName",value:this.getName()}),r.push({name:"actualValue",value:e[0].entityType}),Object(y.k)(t,"entityType","value[0].entityType",r)}try{o.a.instance.reportCall(t),n?n.indexOf(e[0].entityType)>-1&&(r=new s.a(e[0].entityType,new a.a(e[0].id),e[0].name),this.setValueInternal(r)):this.setValueInternal(r),o.a.instance.reportSuccess(t)}catch(e){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}}else this.setValueInternal(r)}getValue(){const e="ClientApi.XrmEntityAttributeLookup.getValue";try{o.a.instance.reportCall(e);const t=this.getValueInternal(),r=Object(N.d)(t);return o.a.instance.reportSuccess(e),r}catch(t){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}getAttributeType(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributeLookup.getAttributeType"),"lookup"}}var W=r("3c9R"),Y=r("IaGr");let Q;class K extends x{constructor(e,t,r,a,i,s){super(e,t,r,a,i,s),Q=e,this._clientApiExecutorAttributeNumber=new n.a(e,"ClientApi.XrmEntityAttributeNumber.",r,t,[{name:"attributeName",value:a,isEventParam:!0}])}getMax(){return this._clientApiExecutorAttributeNumber.execute("getMax",()=>this.getAttrDescriptor().MaxValue)}getMin(){return this._clientApiExecutorAttributeNumber.execute("getMin",()=>this.getAttrDescriptor().MinValue)}getPrecision(){return this._clientApiExecutorAttributeNumber.execute("getPrecision",()=>Object(p.k)(Q.getState(),this.getPageId(),this.dataContextToken,this.getName()))}setPrecision(e){return this._clientApiExecutorAttributeNumber.execute("setPrecision",(t,r)=>{"integer"===this.getAttributeType()&&Object(y.e)(t,"setPrecision is not valid on integer attributes",void 0,r);const n=Object(c.a)(Q.getState(),this.getParent().getEntityName(),this.getName());(e<0||e>n.Precision)&&(r.push({name:"metadataPrecision",value:n.Precision}),Object(y.h)(t,"precision",e.toString(),r)),Q.dispatch(Object(W.b)(this.getPageId(),this.dataContextToken,this.getName(),e))},[{name:"precision",value:e,isRequired:!0,expectedDataType:"number"}])}getValue(){return this._clientApiExecutorAttributeNumber.execute("getValue",()=>{const e=this.getValueInternal();return Object(N.f)(e,this.getAttributeType(),this.getPrecision())})}setValue(e){return this._clientApiExecutorAttributeNumber.execute("setValue",()=>{this.setValueInternal(e)},[{name:"value",value:e,expectedDataType:"number"}])}getAttributeType(){return this._clientApiExecutorAttributeNumber.execute("getAttributeType",(e,t)=>{const r=this.getAttrDescriptor().Type;switch(r){case"decimal":return"decimal";case"double":return"double";case"integer":return"integer";case"money":return"money";default:return t.push({name:"attributeType",value:r}),r?this._clientApiExecutorAttributeNumber.reportFailure(e,new Error("Unexpected number attribute type."),t):Y.a.getInstance().traceManager.getTracer(e).error("Number attribute type was not defined in metadata.",t),super.getAttributeType()}})}}var J=r("arV0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let Z;class $ extends D{constructor(e,t,r,n,a,i){super(e,t,r,n,a,i),Z=e}getInitialValue(){const e="ClientApi.XrmEntityAttributeOptionSet.getInitialValue";try{o.a.instance.reportCall(e);const t=Object(A.j)(Z.getState(),this.parentEntityReference,this.getName());let r;if(Object(J.m)(Z.getState(),this.getPageId())){const e=this.getAttrDescriptor();r=Object(N.g)(t)||e&&e.DefaultFormValue?e.DefaultFormValue:null}else r=Object(N.g)(t);return o.a.instance.reportSuccess(e),r}catch(t){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}getSelectedOption(){const e="ClientApi.XrmEntityAttributeOptionSet.getSelectedOption";try{o.a.instance.reportCall(e);const t=this.getOption(this.getValue());return o.a.instance.reportSuccess(e),t}catch(t){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}getText(){const e="ClientApi.XrmEntityAttributeOptionSet.getText";try{o.a.instance.reportCall(e);const t=this.getSelectedOption();let r=null;return t&&(r=t.text),o.a.instance.reportSuccess(e),r}catch(t){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}getValue(){const e="ClientApi.XrmEntityAttributeOptionSet.getValue";try{o.a.instance.reportCall(e);const t=this.getValueInternal(),r=Object(N.g)(t),n=Object(y.a)(r)?Object(N.f)(t,this.getAttributeType(),0):r;return o.a.instance.reportSuccess(e),n}catch(t){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}setValue(e){const t="ClientApi.XrmEntityAttributeOptionSet.setValue";e&&isNaN(e)&&Object(y.k)(t,"number","value");let r=!1;try{if(e&&this.getParent()){const t=this.getAttrDescriptor();for(const n in t.OptionSet)if(e===t.OptionSet[n].Value){r=!0;break}}else r=!0}catch(e){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(t+".getAttributeDescriptor",e,null,r),e}r||Object(y.h)(t,"OptionSetValue",e);try{o.a.instance.reportCall(t),this.setValueInternal(e),o.a.instance.reportSuccess(t)}catch(e){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}}getAttributeType(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributeOptionSet.getAttributeType"),"optionset"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ee extends x{getMaxLength(){const e="ClientApi.XrmEntityAttributeString.getMaxLength";try{o.a.instance.reportCall(e);const t=this.getAttrDescriptor().MaxLength;return o.a.instance.reportSuccess(e),t}catch(t){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}getValue(){const e="ClientApi.XrmEntityAttributeString.getValue";try{o.a.instance.reportCall(e);const t=this.getValueInternal(),r=Object(N.i)(t);return o.a.instance.reportSuccess(e),r}catch(t){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}setValue(e){const t="ClientApi.XrmEntityAttributeString.setValue";Object(y.a)(e)||"string"!=typeof e&&Object(y.k)(t,"string","value");try{o.a.instance.reportCall(t),this.setValueInternal(e),o.a.instance.reportSuccess(t)}catch(e){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}}getAttributeType(){const e="ClientApi.XrmEntityAttributeString.getAttributeType";try{let t;o.a.instance.reportCall(e);const r=this.getAttrDescriptor().Type;switch(r){case"memo":t="memo";break;case"string":t="string";break;default:const n=_.a.getInstance().getEventParameters(this.contextToken);n.push({name:"attributeName",value:this.getName()}),n.push({name:"attributeType",value:r}),_.a.getInstance().reportFailure(e,new Error("Unexpected string attribute type."),null,n),t=super.getAttributeType()}return o.a.instance.reportSuccess(e),t}catch(t){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class te extends x{constructor(e,t,r,a,i,s){super(e,t,r,a,i,s),this._clientApiExecutor=new n.a(e,"ClientApi.XrmEntityAttributeUniqueIdentifier.",r,t),this._clientApiExecutor.addEventParameter({name:"attributeName",value:a,isEventParam:!0})}setValue(e){this._clientApiExecutor.execute("setValue",()=>{this.setValueInternal(a.a.tryParseOrNull(e))},[{name:"value",value:e,expectedDataType:"guid"}])}getValue(){return this._clientApiExecutor.execute("getValue",()=>{const e=this.getValueInternal();return Object(N.j)(e)})}getAttributeType(){return this._clientApiExecutor.execute("getAttributeType",()=>"string")}}var re=r("nVTU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let ne;class ae extends H{constructor(e,t,r,n,a,i){super(e,t,r,n,a,i),ne=e}getDataXmlInternal(){const e=Object(T.CrmXmlEncode)(this.getName()),t=this.getValue();let r="";return r+=`<${e}>`,t.forEach(e=>{r+="<activityparty>",r+=this.getLookupDataXml("partyid",e),r+="</activityparty>"}),r+=`</${e}>`,r.toString()}setValue(e){const t="ClientApi.XrmEntityAttributePartyList.setValue",r=_.a.getInstance().getEventParameters(this.contextToken);let n;r.push({name:"attributeName",value:this.getName()}),e&&(Array.isArray(e)||Object(y.k)(t,"LookupValue[]","value",r));const a=new Array;try{n=Object(p.Ob)(ne.getState(),this.getPageId(),this.dataContextToken,this.getName())}catch(e){throw _.a.getInstance().reportFailure(t+".getLookupTargets",e,null,r),e}e&&n&&(n.push("unresolvedaddress"),e.forEach(e=>{n.indexOf(e.entityType)>-1||(r.push({name:"entityType",value:e.entityType}),Object(y.e)(t,`LookupValue[] with invalid entity type. Entity type "${e.entityType}" is invalid.`,"LookupValue[] with invalid entity type",r))}));try{o.a.instance.reportCall(t),e?(n?e.forEach(e=>{n.indexOf(e.entityType)>-1&&a.push(new re.a(e.entityType,e.id,e.name))}):e.forEach(e=>{a.push(new re.a(e.entityType,e.id,e.name))}),this.setValueInternal(a)):this.setValueInternal([]),o.a.instance.reportSuccess(t)}catch(e){throw _.a.getInstance().reportFailure(t,e,null,r),e}}getValue(){const e="ClientApi.XrmEntityAttributePartyList.getValue";try{o.a.instance.reportCall(e);const t=this.getValueInternal(),r=Object(N.h)(t);return o.a.instance.reportSuccess(e),r}catch(t){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}getIsPartyList(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributePartyList.getIsPartyList"),!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ie extends x{constructor(e,t,r,a,i,s){super(e,t,r,a,i,s),this._clientApiExecutorAttributeFile=new n.a(e,"ClientApi.XrmEntityFile.",r,t,[{name:"attributeName",value:a,isEventParam:!0}])}getValue(){return this._clientApiExecutorAttributeFile.execute("getValue",()=>{const e=this.getValueInternal();return Object(N.c)(e)})}setValue(e){this._clientApiExecutorAttributeFile.execute("setValue",()=>{this.setValueInternal(e)})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let se;class oe extends x{constructor(e,t,r,n,a,i){super(e,t,r,n,a,i),se=e}getValue(){const e="ClientApi.XrmEntityAttributeEntityName.getValue";try{o.a.instance.reportCall(e);const t=this.getValueInternal(),r=Object(c.a)(se.getState(),this.getParent().getEntityName(),this.getName());let n=null;return r.IsEntityReferenceStored&&Object(i.j)(t)&&(n=t.value),o.a.instance.reportSuccess(e),n}catch(t){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}setValue(e){const t="ClientApi.XrmEntityAttributeEntityName.setvalue";Object(y.a)(e)||"string"==typeof e||Object(y.k)(t,"string","value");try{o.a.instance.reportCall(t),this.setValueInternal(e),o.a.instance.reportSuccess(t)}catch(e){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}}getAttributeType(){return o.a.instance.reportUsage("ClientApi.XrmEntityAttributeEntityName.getAttributeType"),"entityname"}}var ce=r("aOhN"),le=r("Pcet"),ue=r("WY/A"),de=r("qTme"),he=r("Dea/"),pe=r("NPZ3"),ge=r("bGh0"),me=r("srnJ"),be=r("Fij2"),fe=r("pF61"),ye=r("ruPX"),_e=r("cfbi"),ve=r("P6DH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Se(e,t,r,n){const a=Object(p.z)(e,t,r,n,r.relationshipName);if(!a||0===a.length)return!0;for(let n=0;n<a.length;n++)if(!Object(p.t)(e,{controlName:a[n],id:t},r))return!0;return!1}function Oe(e,t,r,n,a,i){if(!Object(ve.K)(e,t,r,n,null==i?void 0:i.id))return!1;const s=Object(ve.y)(e,r,t);if(!a||!s)return!1;if(s&&0===s[n])return!1;if(null===a.ParentPicklistLogicalName)return!0;const o=Object(p.ac)(e,t,r),c=Object(p.X)(e,t,r,o,i,a.ParentPicklistLogicalName);return!(!c||!c.label)}var Ie=r("jRy5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let Ce;class je extends ${constructor(e,t,r,n,a,i){super(e,t,r,n,a,i),Ce=e}setValue(e){const t="ClientApi.XrmEntityAttributeDependentOptionSet.setValue";let r;try{o.a.instance.reportCall(t),r=this.contextToken.contextTokenType===Ie.a.MainGrid||this.contextToken.contextTokenType===Ie.a.SubGrid||this.contextToken.contextTokenType===Ie.a.AssociatedGrid?Oe(Ce.getState(),this.getPageId(),this.contextToken,this.getName(),this.getAttrDescriptor(),this.parentEntityReference):Se(Ce.getState(),this.getPageId(),this.contextToken,this.getName()),o.a.instance.reportSuccess(t)}catch(e){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}r?super.setValue(e):Object(y.e)("ClientApi.XrmEntityAttributeDependentOptionSet.setValue","Can not execute setValue for dependent option set attribute since it is disabled.")}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let Pe;class Te extends L{constructor(e,t,r,n,a,i){super(e,t,r,n,a,i),Pe=e}setValue(e){const t="ClientApi.XrmEntityAttributeMultiSelectDependentOptionSet.setValue";let r;try{o.a.instance.reportCall(t),r=this.contextToken.contextTokenType===Ie.a.MainGrid||this.contextToken.contextTokenType===Ie.a.SubGrid||this.contextToken.contextTokenType===Ie.a.AssociatedGrid?Oe(Pe.getState(),this.getPageId(),this.contextToken,this.getName(),this.getAttrDescriptor(),this.parentEntityReference):Se(Pe.getState(),this.getPageId(),this.contextToken,this.getName()),o.a.instance.reportSuccess(t)}catch(e){const r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}r?super.setValue(e):Object(y.e)(t,"Can not execute setValue for dependent option set attribute since it is disabled.")}}var Ee=r("3/02"),we=r("Lyxw"),Fe=r("QHx/"),xe=r("L8zx"),Ae=r("Exmh");let Ne;class De{constructor(e,t,r,a,i,s,o,c){Ne=e;const l=[{name:"pageId",value:r,isEventParam:!0,isRequired:!0,expectedDataType:"string"},{name:"entityType",value:i,isEventParam:!0,isRequired:!1,expectedDataType:"string"},{name:"store",value:e,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"xrmForm",value:a,isRequired:!0}];this._clientApiExecutor=new n.a(e,"ClientApi.XrmEntity.",r,t,l),this._pageId=r,this._xrmForm=a,this._contextToken=t,this._entityType=i,this._entityId=s,this._getAttributeNames=o,this._applicationContext=c}get attributes(){return this._clientApiExecutor.execute("attributes",(e,t)=>{if(!this._attributes){this._attributes=new m.a(e);const r=this._getAttributeNames(this._applicationContext,this._contextToken,this._pageId);if(!r)return this._clientApiExecutor.reportFailure(e,new Error("Entity attribute names array was null or undefined"),t),this._attributes;0===r.length&&this._clientApiExecutor.reportFailure(e,new Error("Entity attribute names array was empty."),t),r.forEach(e=>{const t=Object(c.a)(Ne.getState(),this.getEntityName(),e);if(t){const r=ke(Ne,this._contextToken,this._pageId,e,this,this._xrmForm.ui,t);this._attributes.add(e,r)}})}return this._attributes})}get relatedEntities(){const e="ClientApi.XrmEntity.relatedEntities";try{if(o.a.instance.reportCall(e),!this._relatedEntities){this._relatedEntities=new m.a(e);const t=Object(p.oc)(Ne.getState(),{id:this._pageId},this._contextToken);for(const e in t)if(t[e]){const r=Object(v.m)(this._contextToken,e),n=new De(Ne,r,this._pageId,this._xrmForm,t[e].etn,t[e].id,this._getAttributeNames,this._applicationContext);this._relatedEntities.add(e,n),this._updateControl(n,e)}const r=Object(p.nc)(Ne.getState(),{id:this._pageId}),n={};for(const e in r){const t=r[e];n[t.referencingAttribute]||(n[t.referencingAttribute]={}),n[t.referencingAttribute][t.referencedEntity]=e}for(const e in n)Ne.dispatch(Object(f.a)(this._contextToken,this._pageId,e,t=>{for(const t in n[e]){const r=this._relatedEntities.get(n[e][t]);r&&this._relatedEntities.remove(r)}const r=t.getEventSource().getValue();if(r&&r.length>0){const t=r[0],i=n[e][t.entityType],s=Object(v.m)(this._contextToken,i),o=new De(Ne,s,this._pageId,this._xrmForm,t.entityType,a.a.tryParse(t.id),this._getAttributeNames,this._applicationContext);this._relatedEntities.add(i,o),this._updateControl(o,i)}},!0))}return o.a.instance.reportSuccess(e),this._relatedEntities}catch(t){const r=_.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}_updateControl(e,t){this._xrmForm&&this._xrmForm.ui&&this._xrmForm.ui.controls&&this._xrmForm.ui.controls.forEach(r=>{r instanceof ge.a&&r.updateAttribute(e,t)})}addOnSave(e){const t="ClientApi.XrmEntity.addOnSave";e||Object(y.j)(t,"handler");try{o.a.instance.reportCall(t),Ne.dispatch(Object(f.o)(this._contextToken,this._pageId,e)),o.a.instance.reportSuccess(t)}catch(e){const r=_.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),_.a.getInstance().reportFailure(t,e,null,r),e}}getDataXml(){const e="ClientApi.XrmEntity.getDataXml";try{o.a.instance.reportCall(e);let t="";return this.attributes.forEach(e=>{e.getIsDirty()&&(t+=e.getDataXmlInternal())}),t="<"+Object(T.CrmXmlEncode)(this.getEntityName())+">"+t+"</"+Object(T.CrmXmlEncode)(this.getEntityName())+">",o.a.instance.reportSuccess(e),t}catch(t){const r=_.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}getEntityReference(){const e="ClientApi.XrmEntity.getEntityReference";try{o.a.instance.reportCall(e);const t={entityType:this.getEntityName(),id:this.getId(),name:this.getPrimaryAttributeValue()};return o.a.instance.reportSuccess(e),t}catch(t){const r=_.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}getEntityName(){const e="ClientApi.XrmEntity.getEntityName";try{return o.a.instance.reportCall(e),o.a.instance.reportSuccess(e),this._entityType}catch(t){const r=_.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}getId(){const e="ClientApi.XrmEntity.getId";try{if(o.a.instance.reportCall(e),!this._entityId||this._entityId&&this._entityId.guid===a.a.EMPTYGUIDSTRING){const e=Object(J.i)(Ne.getState(),this._pageId);if(e&&e.value){const t=e.value;this._entityId=t.id}else{const e=Object(p.ac)(Ne.getState(),this._pageId,this._contextToken);if(e){const t=Object(u.b)(Ne.getState(),e);t&&t.identifier&&(this._entityId=t.identifier.id)}}}return this._entityId&&this._entityId.guid===a.a.EMPTYGUIDSTRING?(o.a.instance.reportSuccess(e),a.a.EMPTYSTRING):(o.a.instance.reportSuccess(e),a.a.externalGuid(this._entityId))}catch(t){const r=_.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}getPrimaryAttributeValue(){return this._clientApiExecutor.execute("getPrimaryAttributeValue",(e,t)=>{let r="";const n=Object(S.h)(Ne.getState(),this.getEntityName());if(n){if(!n.PrimaryNameAttribute)return r="PrimaryNameAttribute was not defined",Y.a.getInstance().traceManager.getTracer(e).error(r,t),"";{const e=Object(p.ac)(Ne.getState(),this._pageId,this._contextToken),t=this.getId()?new s.a(this.getEntityName(),new a.a(this.getId())):new s.a(this.getEntityName()),o=Object(p.X)(Ne.getState(),this._pageId,this._contextToken,e,t,n.PrimaryNameAttribute);if(!o)return"";if(Object(i.j)(o))return o.value;r="PrimaryAttribute value was not an IPlainValue"}}else r="Entity descriptor could not be retrieved.";return _.a.getInstance().reportFailure(e,new Error(r),null,t),""})}getIsDirty(){const e="ClientApi.XrmEntity.getIsDirty";try{o.a.instance.reportCall(e);for(let t=0;t<this.attributes.getLength();t++){const r=this.attributes.get(t);if("never"!==r.getSubmitMode()&&r.getIsDirty())return o.a.instance.reportSuccess(e),!0}for(let t=0;t<this.relatedEntities.getLength();t++){if(this.relatedEntities.get(t).getIsDirty())return o.a.instance.reportSuccess(e),!0}return o.a.instance.reportSuccess(e),!1}catch(t){const r=_.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}removeOnSave(e){const t="ClientApi.XrmEntity.removeOnSave";e||Object(y.j)(t,"handler");try{o.a.instance.reportCall(t),Ne.dispatch(Object(f.J)(this._contextToken,this._pageId,e)),o.a.instance.reportSuccess(t)}catch(e){const r=_.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),_.a.getInstance().reportFailure(t,e,null,r),e}}save(e){this._clientApiExecutor.executeAsync("save",(t,r)=>{let n=1;if(e)if("string"==typeof e)switch(e){case"save":n=1;break;case"saveandclose":n=2;break;case"saveandnew":n=59}else e.saveMode&&(n=e.saveMode);const a=Ne.getState();return Object(xe.b)(this._pageId,Ne,n,r,this._contextToken,this,!1,"saveandclose"!==e).then(t=>this._performAfterSaveLogic(a,t,e))})}isValid(){const e="ClientApi.XrmEntity.isValid";try{if(o.a.instance.reportCall(e),this.attributes)for(let t=0;t<this.attributes.getLength();t++){const r=this.attributes.get(t);if(this._attributeHasActiveControl(r)&&!r.isValid()||r.hasErrorNotification())return o.a.instance.reportSuccess(e),!1}if(this.relatedEntities)for(let t=0;t<this.relatedEntities.getLength();t++)if(!this.relatedEntities.get(t).isValid())return o.a.instance.reportSuccess(e),!1;return o.a.instance.reportSuccess(e),!0}catch(t){const r=_.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),_.a.getInstance().reportFailure(e,t,null,r),t}}setRecordId(e){const t="ClientApi.XrmEntity.setRecordId";e||Object(y.j)(t,"id");try{if(o.a.instance.reportCall(t),this.getId()&&this._entityId.guid!==a.a.EMPTYGUIDSTRING)o.a.instance.reportSuccess(t);else{const r=a.a.tryParse(e);a.a.isNullOrEmpty(r)&&Object(y.j)(t,"id");const n={},i=Ne.getState(),c=Object(p.ac)(i,this._pageId,this._contextToken),l=Object(v.x)(this._contextToken);if(c){const e=new s.a(this.getEntityName(),r);Ne.dispatch(Object(le.b)(c,e)),o.a.instance.reportSuccess(t)}else{const e=Object(ue.b)(i,new s.a(this.getEntityName(),r),n,l,he.a.Create),a=e.payload.snapshotId;Ne.dispatch(e),Ne.dispatch(Object(de.b)(this._pageId,a,this._contextToken)).then(()=>{o.a.instance.reportSuccess(t)}).catch(e=>{const r=_.a.getInstance().getEventParameters(this._contextToken);r.push({name:"entityName",value:this.getEntityName()}),_.a.getInstance().reportFailure(t+".setDataSnapshotId",e,null,r)})}}}catch(e){const r=_.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),_.a.getInstance().reportFailure(t,e,null,r),e}}refresh(){const e="ClientApi.XrmEntity.refresh";try{if(o.a.instance.reportCall(e),this.getId()){const t=new s.a(this.getEntityName(),new a.a(this.getId())),r=[],n=[];for(let e=0;e<this.attributes.getLength();e++)n.push(this.attributes.get(e).getName());const i=Object(pe.a)(Ne.getState(),t.etn);if(i&&n.push(...i),r.push(Ne.dispatch(Object(me.a)(this._pageId,t,n,new Ae.a(s.a.toLegacyEntityReference(t),null,null)))),this.relatedEntities)for(let e=0;e<this.relatedEntities.getLength();e++)r.push(this.relatedEntities.get(e).refresh());return Promise.all(r).then(()=>{Object(be.b)(this),o.a.instance.reportSuccess(e)}).catch(t=>{const r=_.a.getInstance().getEventParameters(this._contextToken);return r.push({name:"entityName",value:this.getEntityName()}),Object(y.d)(Ne,t,e,r)})}return o.a.instance.reportSuccess(e),Promise.resolve(null)}catch(t){const r=_.a.getInstance().getEventParameters(this._contextToken);return r.push({name:"entityName",value:this.getEntityName()}),Object(y.d)(Ne,t,e,r)}}_attributeHasActiveControl(e){if(e&&e.controls){const t=e.controls.getLength();for(let r=0;r<t;r++)if(!e.controls.get(r).getDisabled())return!0}return!1}_performAfterSaveLogic(e,t,r){const n=Object(p.kb)(Ne.getState(),{id:this._pageId},this._contextToken);if(t||!this.getIsDirty()||n)if(Object(be.b)(this),"saveandclose"===r){if(!Object(be.a)(Object(fe.b)(Ne.getState())===this._pageId)){const t=Object(p.Kb)(e,this._pageId),r=Object(p.Ib)(e,this._pageId);if(!t&&!r){const e=Object(Fe.a)(Ne.getState(),this._pageId);return Ne.dispatch(Object(ce.b)(e))}}}else if("saveandnew"===r){const e={entityTypeName:this.getEntityName()};return Ne.dispatch(Object(ye.a)(_e.a,e,this._pageId))}return Promise.resolve()}}function ke(e,t,r,n,a,i,s){let o=null,l=!1;switch(s.Type){case"datetime":o=new z(e,t,r,n,a,i);break;case"decimal":case"double":case"integer":case"money":o=new K(e,t,r,n,a,i);break;case"lookup":case"owner":case"customer":o=new H(e,t,r,n,a,i);break;case"partylist":o=new ae(e,t,r,n,a,i);break;case"memo":case"string":o=new ee(e,t,r,n,a,i);break;case"picklist":if(l=Object(we.c)(e.getState(),Ee.L),l&&Object(c.l)(e.getState(),s.EntityLogicalName,n)){o=new je(e,t,r,n,a,i);break}case"optionset":case"state":case"status":o=new $(e,t,r,n,a,i);break;case"boolean":o=new R(e,t,r,n,a,i);break;case"entityname":o=new oe(e,t,r,n,a,i);break;case"uniqueidentifier":o=new te(e,t,r,n,a,i);break;case"multiselectpicklist":l=Object(we.c)(e.getState(),Ee.L),o=l&&Object(c.l)(e.getState(),s.EntityLogicalName,n)?new Te(e,t,r,n,a,i):new L(e,t,r,n,a,i);break;case"file":o=new ie(e,t,r,n,a,i);break;default:o=new x(e,t,r,n,a,i)}return o}},Utin:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return i}));var n=r("dHD5"),a=r("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="control.update.parameter";function s(e,t,r,s,o){return{type:"control.update.parameter.async",execute({dispatch:c,getState:l},u){const d=a.x+".updateControlParameterAction";c(function(e,t,r,s,o){const c=Object(n.v)(o);return{type:i,payload:{name:r,value:s},meta:{pageId:e,dataSetContextKey:c,controlName:a.o}}}(e,0,r,s,o));const h=[];return h.push({name:"controlName",value:t}),h.push({name:"paramName",value:""+r}),u.EventManager.ReportComponentSuccess(d,h),Promise.resolve()}}}},VpHT:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r("NjDY"),a=r("99zj"),i=r("V6aM"),s=r("3mEc"),o=r("69Qu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c=["JQUERY","JQUERY.JS"];let l,u,d;function h(e){return{type:"customcontrol.loadresources",execute({dispatch:t,getState:r},h){const p=[],g=r(),m=Object(n.t)(g),b=e.Properties.Resources.filter((e,t,r)=>(0===e.Type||4===e.Type||1===e.Type)&&!(e.LibraryName&&-1!==c.indexOf(e.LibraryName.toUpperCase())||h.AssetLoader.isResourceLoaded(m+e.Name))).sort((e,t)=>e.LoadOrder-t.LoadOrder),f=e.Properties.Resources.filter((e,t,r)=>5===e.Type);if(b.length>0){let e;const r=()=>function(e,t,r,n,a){const s=[];for(let o=0;o<a.length;o++){const c=a[o];let u,d=c.Name,h=r;if(l&&l[c.Name])h=window.__public_path__+"control",d=l[c.Name];else if(0===c.Type){const e=c.LibraryName+".js";l&&l[e]&&(h=window.__public_path__+"control",d=l[e])}switch(c.Type){case 0:case 4:u=n.loadWebResource(d,h,3,t=>e(Object(i.a)(t)),t,!1);break;case 1:u=u=n.loadWebResource(d,h,2,t=>e(Object(i.a)(t)),t);break;default:u=null}u&&s.push(u)}return Promise.all(s)}(t,!Object(o.b)(g),m,h.AssetLoader,b);e=!function(){null==d&&(d=window.location.search.toLocaleLowerCase().indexOf("uselocal=true")>=0);return d}()||l?r():function(){if(u)return u;if("/uclient/"!==window.__public_path__){if(!l){const e=window.__public_path__+"controlFileMap.json";u=-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0?new Promise(t=>{const r=new XMLHttpRequest;r.addEventListener("load",(function(){let e={};try{e=JSON.parse(this.responseText)}catch(e){}t(e)})),r.addEventListener("error",()=>{t({})}),r.open("GET",e),r.send()}):fetch(e).then(e=>e.json(),()=>Promise.resolve({})),u.then(e=>{l=e},()=>{l={}})}}else l={},u=Promise.resolve({});return u}().then(r,r),e&&p.push(e)}const y=Object(s.k)(g);for(let e=0;e<f.length;e++)if(!y||!y.hasOwnProperty(f[e].Name)){const r=t(Object(a.c)(f[e].Name)).then(r=>{let n=!1;for(const t of r)t&&t.webResourceDescriptorsByName&&t.webResourceDescriptorsByName.hasOwnProperty(f[e].Name)&&(n=!0);!n&&t(Object(a.b)(f[e].Name))});p.push(r)}return p.length>0?Promise.all(p):null},sync:!0}}},WA3M:function(e,t,r){"use strict";r.d(t,"a",(function(){return V}));var n=r("Yx7Y"),a=r("SAYH"),i=r("eXjw"),s=r("arV0"),o=r("69Qu"),c=r("FZDd"),l=r("iZ7K"),u=r("3hnk"),d=r("nmJf"),h=r("odYE"),p=r("Lohl"),g=r("BJ7u"),m=r("a72m"),b=r("BFlg"),f=r("d0w6"),y=r("nIfK"),_=r("HfZT"),v=r("6Qf/"),S=r("P6DH"),O=r("jAuy"),I=r("dQnL"),C=r("d0Pd"),j=r("3/02"),P=r("Lyxw"),T=r("ANW1"),E=r("fSnw"),w=r("CngE"),F=r("ngeo"),x=r("S2mk"),A=r("5R5s"),N=r("G4xW"),D=r("85o3"),k=r("IqkD"),M=r("pEXn"),R=r("Uv1Y");var L=r("vNXc"),B=r("fYtF");function V(e,t,r,V,U,X,z,q,H=(()=>7),W,Y,Q=!0,K=!1){const J=[],Z=[],$=function(e,t,r,N,V,U,X,z,q,H=!0,W=!1){const Y=Object(s.l)(e(),N),Q={},K=function(e,t,r){const n=[],i=[],s={},o={};return(c,l,u)=>{const d=[],h=l.controlParameters,p=a.a.tryParseOrNull(l.viewId)?a.a.tryParseOrNull(l.viewId):a.a.tryParseOrNull(h.ViewId),g=a.a.toString(p),b=a.a.tryParseOrNull(h.VisualizationId),y=a.a.toString(b);if("true"===h.EnableChartPicker&&-1===n.indexOf(l.entityLogicalName)){n.push(l.entityLogicalName);const e=c(Object(I.a)(l.entityLogicalName,l.chartType)),a=[{name:"TargetEntityType",value:l.entityLogicalName}];t.info(r+" page, chart control, retrieve chart dispatched",a),d.push(e)}if(Object(P.c)(e(),j.B)&&"true"===h.EnableViewPicker&&-1===i.indexOf(l.entityLogicalName)){i.push(l.entityLogicalName);const e=c(Object(m.a)(l.entityLogicalName,f.a.MAIN_APPLICATION_VIEW,void 0,void 0,!0)),n=[{name:"TargetEntityType",value:l.entityLogicalName}];t.info(r+" page, chart control, retrieve view dispatched",n),d.push(e)}return y&&(s[y]||(s[y]=c(Object(I.a)(l.entityLogicalName,l.chartType,b)).catch(e=>{const n=e&&e.getNegativeErrorCode&&e.getNegativeErrorCode(),a=[{name:"TargetEntityType",value:l.entityLogicalName},{name:"VisualizationId",value:y},{name:"ChartType",value:l.chartType},{name:"ErrorCode",value:Object(x.j)(n)?"":"0x"+F.a.getHexErrorCodeFromInt(n)},{name:"ErrorMessage",value:e.message?e.message:""},{name:"ErrorDetails",value:e.details?e.details:""}];t.info(r+" page, retrieve Chart Control metadata failed.",a)})),u.push(s[y]),d.push(s[y])),g&&(o[g]||(o[g]=c(Object(m.a)(l.entityLogicalName,void 0,l.viewType,p)).catch(e=>{const n=e&&e.getNegativeErrorCode&&e.getNegativeErrorCode(),a=[{name:"TargetEntityType",value:l.entityLogicalName},{name:"ViewId",value:g},{name:"ViewType",value:l.viewType},{name:"ErrorCode",value:Object(x.j)(n)?"":"0x"+F.a.getHexErrorCodeFromInt(n)},{name:"ErrorMessage",value:e.message?e.message:""},{name:"ErrorDetails",value:e.details?e.details:""}];t.info(r+" page, retrieve Chart Control metadata failed.",a)})),u.push(o[g]),d.push(o[g])),d}}(e,t,Y),J=function(e,t,r,n,i,s){const o=[],c={},l=Object(y.c)(e,n,i,s);return(i,s)=>{const u=s.controlParameters,d=Object(y.e)(s);let h,p=c[d];if(!p){const t=e(),r=s.entityLogicalName,n=Object(k.q)(t);if(t&&r&&n){const e=Object(P.c)(t,j.Zc),a=Object(A.a)(r,n,s.contextToken,e).getFilterAndLinkedEntities(D.a,!0);if(a){if(s.getCustomFilter){const e=s.getCustomFilter();if(e&&e.filter){const t=a.filter,r={conditions:[],filterOperator:0,filters:[e.filter,t]};a.filter=r}e&&e.linkEntities&&a.linkEntities.push(...e.linkEntities)}s.getCustomFilter=()=>a}}p=l(s),c[d]=p}const g=u.ChartDrillDownParameters;if(g&&g.length>0){const n=g[g.length-1];h=new T.a(e,a.a.tryParse(u.VisualizationId),a.a.tryParse(s.viewId),s.chartType,s.viewType,n.groupByAttribute.name,n.groupByAttribute.relatedEntityName,n.chartType);const i=[{name:"TargetEntityType",value:s.entityLogicalName},{name:"ViewId",value:s.viewId},{name:"VisualizationId",value:u.VisualizationId},{name:"DrilldownAttributeName",value:n.groupByAttribute.name},{name:"DrilldownChartType",value:n.chartType}];t.info(r+" page, retrieve chart drilldown data dispatched",i)}else{h=new E.a(e,a.a.tryParse(u.VisualizationId),a.a.tryParse(s.viewId),s.chartType,s.viewType);const n=[{name:"TargetEntityType",value:s.entityLogicalName},{name:"ViewId",value:s.viewId},{name:"VisualizationId",value:u.VisualizationId}];t.info(r+" page, retrieve chart data dispatched",n)}const m=Object(S.qb)(e(),a.a.tryParse(s.viewId),n),b=Object(w.a)(e(),a.a.tryParse(u.VisualizationId));return b&&b.DataDescription&&(p&&p.fetchXml||m&&m.fetchXML)&&(h.initialize(b.DataDescription,p.fetchXml?p.fetchXml:m.fetchXML,b.PresentationDescription,m.title,m.entityLogicalName,b.Name,b.PrimaryEntityTypeCode,!a.a.isNullOrEmpty(b.WebResourceId)),h.setupAggregationQueries()),-1===o.indexOf(h.getStorageKey())?(o.push(h.getStorageKey()),i(Object(C.a)(h,s.entityLogicalName,n,!1))):null}}(e,t,Y,N,V,U),Z=function(e,t,r,i){const s=[],o={},c={},l={};return(u,b,y)=>{const _=[],v=b.entityLogicalName,S=b.controlParameters;if(b.ribbonContext){const r=b.ribbonContext+v;if(-1===s.indexOf(r)){s.push(r);const n=u(Object(d.a)(r));_.push(n);const a=[{name:"TargetEntityType",value:v},{name:"RibbonContext",value:b.ribbonContext}];e.info(t+" page, retrieve ribbon dispatched",a)}}const O=b.cardFormId;if(O&&(!a.a.equals(O,n.a)||"activitypointer"!==v)){const r=a.a.equals(O,n.a)?null:O,i=r?r.guid:b.entityLogicalName;if(!o[i]){const n=u(Object(p.b)(new h.a(v),r,Object(g.a)(11)));o[i]=n,_.push(n);const a=[{name:"TargetEntityType",value:v},{name:"FormId",value:O&&O.guid}];e.info(t+" page, retrieve card form dispatched",a)}y.push(o[i])}if(!(1===b.gridType||"true"!==S.EnableViewPicker||l[v]&&l[v].allViews)){l[v]||(l[v]={allViews:!1,viewIds:[]});const r=l[v],n=S.ViewIds,s=n&&n.split(",");if(s&&0!==s.length){for(const n of s)if(-1===r.viewIds.indexOf(n)){r.viewIds.push(n);const s=a.a.tryParseOrNull(n);if(s){const r=u(Object(m.a)(v,void 0,void 0,s,void 0,i));_.push(r);const a=[{name:"TargetEntityType",value:v},{name:"ViewId",value:n}];e.info(t+" page, retrieve view dispatched",a)}}}else{if(r.allViews=!0,0===b.gridType){const e=u(Object(m.a)(v,f.a.SUB_GRID,void 0,void 0,void 0,i));_.push(e)}const n=u(Object(m.a)(v,f.a.MAIN_APPLICATION_VIEW,void 0,void 0,void 0,i));_.push(n);const a=[{name:"TargetEntityType",value:v}];e.info(t+" page, retrieve all views dispatched",a)}}const I=b.viewId;if(c[I])b.viewId=c[I];else{const n="true"===S.IsUserView?f.b.userview:f.b.savedview,i=b.pinnedEntityLogicalName;let s=0===b.gridType?f.a.SUB_GRID:f.a.MAIN_APPLICATION_VIEW,o=i||v;b.quickFindSearchString&&(s=f.a.QUICKFIND_SEARCH,o=b.quickFindEntityIfActivity||o);const l=u(function(e,t,r,n){return{type:"view.retrieveornull.async",execute({dispatch:a,getState:i},s,o){const c=a(Object(m.a)(e,t,r,n));return new Promise(a=>{c.then(e=>a(e),i=>{const o=s.TraceManager.getTracer("view.retrieveornull.async"),c=[{name:M.b.EntityName,value:e},{name:M.b.ViewId,value:n&&n.guid||""},{name:"ViewType",value:r},{name:"SavedQueryType",value:t}];return o.warn("Retrieve view or null : retrieve of view failed : "+Object(R.d)(i),c),a(null)})})}}}(o,s,n,a.a.tryParseOrNull(I))).then(t=>{if(I&&!t&&r){e.warn("Pinned view retrieval failed. Loading default view.");return u(Object(m.a)(v,f.a.MAIN_APPLICATION_VIEW)).then(e=>n(e))}return n(t);function n(e){const t=e&&e.guid;if(b.viewId=t,c[I]=t,b.onViewRetrieve)return b.onViewRetrieve(e)}});_.push(l),y.push(l);const d=[{name:"TargetEntityType",value:v},{name:"ViewId",value:I}];e.info(t+" page, retrieve view dispatched from retrieveControlMetadataAndData",d)}return _}}(t,Y,H,W),$=function(e,t,r,n,a,s){const o={},c=Object(y.b)(e,n,a,s);return(a,s,l,u,d)=>{var h,p;const g=[],m=s.entityLogicalName,b=s.viewId;if(b){const f=Object(y.e)(s);let O=o[f];if(!O){const n=c(s);if(O=O instanceof L.a?n&&n.getQueryState():n&&n.getQueryState(e),!O)return g;if(o[f]=O,Object(B.c)(O,null===(h=s.contextToken)||void 0===h?void 0:h.contextTokenType,null===(p=s.control)||void 0===p?void 0:p.Id),u){a(Object(_.d)(O)).catch(()=>{const e={lists:{[O.key]:{initialized:i.a.Error,lastRetrieved:new Date,pageSize:n.pageSize}}};a({type:_.b,payload:e})});const e=[{name:"TargetEntityType",value:m},{name:"ViewId",value:b}];t.info(r+" page, retrieve grid data dispatched",e)}}if(d){const t=s.controlParameters.RelationshipName,r=Object(S.db)(e(),m,t),i=a(Object(v.d)(O,m,n,s.contextToken,s.control,t,r,void 0,l));if(g.push(i),s.onInitializeGrid){const e=i.then(s.onInitializeGrid);g.push(e)}}else if(s.onInitializeGrid){const e=s.onInitializeGrid();g.push(e)}const I=[{name:"TargetEntityType",value:m},{name:"ViewId",value:b}];return t.info(r+" page, initialize grid dispatched",I),g}}}(e,t,Y,N,V,U),ee=function(e){if(e&&e.FormType){const t=Object(g.a)(e.FormType);return`${b.x}.${b.y}.${t}`}return""}(V),te=G(X,2),re=G(X,4);return t=>({type:"retrieveControlMetadataAndData.loadControl",execute:({dispatch:n})=>{const s=function(e,t){if(e&&t&&t.hasGrid&&t.control&&t.controlParameters){const r=[];return r.push({name:"FormId",value:a.a.toString(e.Id)}),r.push({name:"ViewId",value:t.viewId}),r.push({name:"IsUserView",value:t.controlParameters.IsUserView}),r.push({name:"ControlId",value:t.control.Id}),r}return null}(V,t),d=re(t)&&Object(o.b)(e()),h=[],p=[],g=t.hasGrid&&t.ribbonContext&&t.contextToken&&Object(O.c)(N,t.contextToken),m=t.entityLogicalName;let b=Q[m];if(!b){const e=z&&z(m);b=n(Object(c.f)(m,e,[])),Q[m]=b}const f=[],y=t.hasChart&&d&&K(n,t,f);p.push(...f),y&&h.push(...y);const _=[],v=t.hasGrid&&Z(n,t,_);p.push(..._),v&&(h.push(...v),0===t.gridType&&Promise.all(_).catch(e=>{r.ReportComponentFailure(ee,e,null,s)}));const S=q&&q(t,p);S&&h.push(...S);const I=Promise.all([b,...p]).then(()=>{const a=Object(l.h)(e(),m);if(a&&a.Initialized===i.a.Initialized&&(!a.IsEnabledInUnifiedInterface||!Object(u.g)(e(),m,2,0)))return;const c=Object(o.b)(e())&&d,h=[],p=t.hasChart&&c&&J(n,t);p&&h.push(p);const b=t.hasGrid&&$(n,t,g,re(t),te(t));return b&&(h.push(...b),0===t.gridType&&Promise.all(b).then(()=>{r.ReportComponentSuccess(ee,s)},e=>{r.ReportComponentFailure(ee,e,null,s)})),Promise.all(h)});return h.push(I),Promise.all(h)}})}(e,r,V,U,X,z,H,W,Y,Q,K),ee=G(H,1),te=G(H,0);for(const e in q){const r=q[e];if(ee(r))J.push(t($(r)));else if(!te(r)){const e=Object(N.a)($(r));Z.push(t(e))}}return{inProgress:J,preload:Z}}function G(e,t){return 0===t?t=>0===e(t):r=>!!(e(r)&t)}},"WK+4":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return s}));var n=r("dHD5"),a=r("BFlg");const i="chart.visualizationid.update";function s(e,t,r){return{type:"chart.visualizationid.update.async",execute({dispatch:s,getState:o},c){const l=c.TraceManager.getTracer(a.z),u=a.x+".updateVisualizationIdAction";try{l.info("Updating the chart visualization id"),t||(t=Object(n.k)(o(),e));const a=Object(n.v)(t);return s(function(e,t,r){return{type:i,payload:{name:"VisualizationId",value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,a,r)),c.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){const t="Updatation of the chart visualization id failed with error : "+e.message;c.EventManager.ReportComponentFailure(u,Error(t))}}}}},WRDA:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return Object(n.b)(e)?null:("{"===(e=e.trim())[0]&&"}"===e[e.length-1]&&(e=e.substring(1,e.length-1)),e.toLowerCase())}},Wdaq:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return s}));var n=r("dHD5"),a=r("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="grid.setCommandManagerId";function s(e,t,r){return{type:"grid.setCommandManagerId.async",execute({dispatch:s,getState:o},c){const l=c.TraceManager.getTracer(a.z),u=a.x+".setCommandManagerIdAction";try{l.info("Updating the command manager id for the grid.");const a=Object(n.v)(r);return s(function(e,t,r){return{type:i,payload:t,meta:{pageId:e,dataSetContextKey:r}}}(e,t,a)),c.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){const t="Updating the command manager id for the grid failed with error : "+e.message;c.EventManager.ReportComponentFailure(u,Error(t))}}}}},XVX7:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return o}));var n=r("OWbt"),a=r("6Qf/"),i=r("dHD5");function s(e,t,r){const a=Object(i.v)(r),s={xrmReady:e};return{type:n.b,payload:s,meta:{pageId:t,contextKey:a}}}function o(e,t,r){const n=Object(i.u)(r),s={xrmReady:e};return{type:a.b,payload:s,meta:{pageId:t,contextKey:n}}}},Y5AI:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="form.ShowHeaderFieldsInSection.set";function i(e,t,r){const i=Object(n.v)(t);return{type:a,payload:{showHeaderFieldsInSection:r},meta:{pageId:e,contextKey:i}}}},Yexl:function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return b}));var n=r("3/02"),a=r("SAYH"),i=r("P6DH"),s=r("Lyxw"),o=r("B9jE"),c=r("jRy5"),l=r("a72m"),u=r("KBcj"),d=r("d0w6"),h=r("BFlg"),p=r("hSDL"),g=r("jAuy");function m(e,t,r,m){return{type:"grid.quickfind.apply.async",execute({dispatch:b,getState:f},y){const _=y.TraceManager.getTracer(h.z),v=h.x+".QuickFilterAction";try{const h=f(),S=Object(i.F)(h,t,r,m);return function(e,t,r){return new Promise(n=>{const a=Object(u.a)(e,r,d.a.QUICKFIND_SEARCH);a?n(a):t(Object(l.a)(r,d.a.QUICKFIND_SEARCH,d.b.savedview)).then(e=>{n(e)})})}(h,b,S).then(l=>{_.info("Performing quick find on the grid ");const u=Object(i.T)(h,t,r,m);let S=u;const O=r.contextTokenType===c.a.SubGrid;let I=!1;if(O&&r.controlName){const e=Object(i.hb)(f(),t,r,r.controlName);e&&(I=e.EnableViewPicker)}return Object(s.a)(f(),n.Nd)&&O&&!I||Object(g.l)(h)||(S=l),b(Object(p.n)(e,t,r)),b(Object(o.a)(t,r,m,a.a.toString(S),null,d.a.QUICKFIND_SEARCH)).then(()=>(y.EventManager.ReportComponentSuccess(v),u))})}catch(e){const t="Unable to perform a quick find on the grid";y.EventManager.ReportComponentFailure(v,Error(t))}}}}function b(e,t,r,n){return{type:"grid.quickfind.clear.async",execute({dispatch:i,getState:s},c){const l=c.TraceManager.getTracer(h.z),u=h.x+".QuickFilterAction";try{return l.info("Clearing quick find from the grid."),i(Object(p.n)("",t,r)),i(Object(o.a)(t,r,n,a.a.toString(e))).then(()=>{c.EventManager.ReportComponentSuccess(u)})}catch(e){const t="Unable to clear quick find value for grid";c.EventManager.ReportComponentFailure(u,Error(t))}}}}},ZJsz:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n={queryKey:null,pageNumber:1,isNewPageRequested:!1,selectedRows:[],selectedRelatedEntity:null,filters:{},rowProperties:{records:[]},fetchXml:"",controls:{},refreshCounter:0,pagingRefreshInput:0,pagingData:"",relationshipName:null,relationshipRoleOrdinal:null,showChart:null,useRollupView:!1,chartVisualizationType:null,dependentOptionSetColumnStatus:{},chartDrillDownParameters:[]}},ZUzm:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("cfbi"),a=r("ruPX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t,r,i,s,o,c,l,u){const d={entityTypeName:e.etn,id:e.id,formId:r,data:i,processId:s,processInstanceId:o,selectedStageId:c,isCrossEntityNavigate:l,recordSetQueryKey:u};return Object(a.a)(n.a,d,t)}},Zw8F:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r("SAYH"),a=r("qshH"),i=r("arV0"),s=r("16wZ"),o=r("ZIjf"),c=r("rs6x"),l=r("7TDv"),u=r("+Ljw");let d;class h{constructor(e,t,r,n){this._id=e,this._label=t,d=r,this._pageId=n}getId(){const e="ClientApi.XrmFormSelectorItem.getId";try{o.a.instance.reportCall(e);const t=n.a.toString(this._id);return o.a.instance.reportSuccess(e),t}catch(t){throw a.a.getInstance().reportFailure(e,t),t}}getLabel(){return o.a.instance.reportUsage("ClientApi.XrmFormSelectorItem.getLabel"),this._label}getPageId(){return o.a.instance.reportUsage("ClientApi.XrmFormSelectorItem.getPageId"),this._pageId}setVisible(e){const t="ClientApi.XrmFormSelectorItem.setVisible";try{o.a.instance.reportCall(t),d.dispatch(Object(l.b)(this._pageId,n.a.toString(this._id),e)),o.a.instance.reportSuccess(t)}catch(e){throw a.a.getInstance().reportFailure(t,e),e}}getVisible(){const e="ClientApi.XrmFormSelectorItem.getVisible";try{o.a.instance.reportCall(e);const t=Object(u.c)(d.getState(),this._pageId,this._id);return o.a.instance.reportSuccess(e),t}catch(t){throw a.a.getInstance().reportFailure(e,t),t}}navigate(){const e="ClientApi.XrmFormSelectorItem.navigate";try{this._pageId||Object(s.j)(e,"PageId"),o.a.instance.reportCall(e);const t=Object(i.g)(d.getState(),this._pageId),r=t&&t.id?t.id.guid:"",n=Object(i.l)(d.getState(),this._pageId);d.dispatch(Object(c.a)(this._id.guid,this._pageId,n,r)).then(()=>{o.a.instance.reportSuccess(e)}).catch(t=>Object(s.d)(d,t,e+".changeForm"))}catch(t){throw a.a.getInstance().reportFailure(e,t),t}}}},aTYF:function(e,t,r){"use strict";r.r(t),r.d(t,"Dashboard",(function(){return Ha}));var n={};r.r(n),r.d(n,"GLOBAL_FILTER_CANCEL",(function(){return ze})),r.d(n,"GLOBAL_FILTER_CLEAR",(function(){return qe})),r.d(n,"GLOBAL_FILTER_CLOSE_FILTER_PANEL",(function(){return He})),r.d(n,"GLOBAL_FILTER_FILTERS",(function(){return We})),r.d(n,"GLOBAL_FILTER_OPEN_FILTER_PANEL",(function(){return Ye})),r.d(n,"GLOBAL_FILTER_NO_ATTRIBUTES",(function(){return Ke})),r.d(n,"GLOBAL_FILTER_EXPAND_ALL",(function(){return Je})),r.d(n,"GLOBAL_FILTER_COLLAPSE_ALL",(function(){return Ze})),r.d(n,"GLOBAL_FILTER_APPLY",(function(){return $e})),r.d(n,"GLOBAL_FILTER_CLEAR_BUTTON",(function(){return et})),r.d(n,"GLOBAL_FILTER_CLOSE_FILTER_PANEL_BUTTON",(function(){return Qe})),r.d(n,"GLOBAL_FILTER_SAVEFILTER_TOAST_DELETE_SUCCESS",(function(){return tt})),r.d(n,"GLOBAL_FILTER_SAVEFILTER_TOAST_DELETE_ERROR",(function(){return rt})),r.d(n,"globalFilterLabelList",(function(){return nt}));var a={};r.r(a),r.d(a,"visualFilterLabelList",(function(){return st})),r.d(a,"VISUAL_FILTER_EXPAND",(function(){return at})),r.d(a,"VISUAL_FILTER_COLLAPSE",(function(){return it}));var i={};r.r(i),r.d(i,"streamTileSwitcherLabelList",(function(){return lt})),r.d(i,"SWITCH_TO_TILE_VIEW",(function(){return ot})),r.d(i,"SWITCH_TO_STREAM_VIEW",(function(){return ct}));var s={};r.r(s),r.d(s,"REFRESH",(function(){return ut})),r.d(s,"OPEN_IN_POWERBI",(function(){return dt})),r.d(s,"SET_AS_DEFAULT",(function(){return ht})),r.d(s,"UNSET_DEFAULT",(function(){return pt})),r.d(s,"OPEN_ENTITY_GRID_LABEL",(function(){return gt})),r.d(s,"YAMMER_LABEL_IN_DASHBOARDS",(function(){return mt})),r.d(s,"EDIT_DASHBOARD",(function(){return bt})),r.d(s,"DELETE_DASHBOARD",(function(){return ft})),r.d(s,"SHARE_DASHBOARD",(function(){return yt})),r.d(s,"ASSIGN_DASHBOARD",(function(){return _t})),r.d(s,"CREATE_NEW_DASHBOARD",(function(){return vt})),r.d(s,"CREATE_NEW_DASHBOARD_TOOLTIP",(function(){return St})),r.d(s,"CREATE_POWERBI_DASHBOARD",(function(){return Ot})),r.d(s,"CREATE_POWERBI_DASHBOARD_TOOLTIP",(function(){return It})),r.d(s,"CREATE_DYNAMICS_DASHBOARD",(function(){return Ct})),r.d(s,"CREATE_DYNAMICS_DASHBOARD_TOOLTIP",(function(){return jt})),r.d(s,"SAVE_AS_DASHBOARD",(function(){return Pt})),r.d(s,"dashboardRibbonLabelList",(function(){return Tt}));var o=r("OKVy"),c=r("nuS9"),l=r("SAYH"),u=r("u+q+"),d=r("YWpA"),h=r("vf7d"),p=r("arV0"),g=r("223Y"),m=r("S2mk"),b=r("OtHk"),f=r("YxC/"),y=r("y60j"),_=r("HfZT"),v=r("dHD5"),S=r("WIoD"),O=r("LbMF"),I=r("iZ7K"),C=r("eXjw"),j=r("znb3"),P=r("tWl5"),T=r("jS4H"),E=r("504W"),w=r("i1f0"),F=r("Z/4N"),x=r("b8TU"),A=r("unFF"),N=r("MQTY"),D=r("3hnk"),k=r("NjDY"),M=r("85o3"),R=r("uNu9"),L=r("5R5s"),B=r("P6DH"),V=r("zmL5"),G=r("Lyxw"),U=r("3/02");const X="5850fc36-8596-45fe-b607-fe81d0c453fd";class z{constructor(e,t,r){this._descriptor=e,this.Id=this._descriptor.Id,this._pageId=r,this._descriptor.LogicalEntityName!==R.Bb&&0!==this._descriptor.Type&&2!==this._descriptor.Type||(this._appState=t)}get EntityLogicalName(){switch(this._descriptor.Type){case 0:case 2:return R.Bb}return this._descriptor.LogicalEntityName}get ViewId(){switch(this._descriptor.Type){case 0:return this._descriptor.QueueViewId;case 2:return this._descriptor.QueueViewIdForSavedQuery}return this._descriptor.EntityViewId}get SavedQueueFilterId(){return 2===this._descriptor.Type&&this._descriptor.SavedQueryId?this._descriptor.SavedQueryId.toLowerCase()!==X?this._descriptor.SavedQueryId.toLowerCase():M.a:0===this._descriptor.Type&&this._descriptor.QueueId?this._descriptor.QueueId:this._descriptor.LogicalEntityName===R.Bb?M.a:null}get _queueStreamType(){switch(this._descriptor.Type){case 0:return 1;case 1:return 0}switch(this._descriptor.SavedQueryId.toLowerCase()){case X:return 2;case"e611d950-6bab-477c-a5a3-7e9a447b326d":return 3;case"436e2293-da8f-4ef9-a1e6-fff25a5beb22":return 4}return 0}static create(e,t,r){const n=new z(t,e,r);switch(t.Type){case 0:case 2:const r=Object(I.h)(e,t.LogicalEntityName);n._queueObjectTypeCode=r&&""+r.ObjectTypeCode||"0"}return n}static makeCreate(e,t,r){return n=>{const a=new z(n,e,r);switch(n.Type){case 0:case 2:a._queueObjectTypeCode=t[n.LogicalEntityName]||"0"}return a}}createStreamFilter(e,t,r,n,a,i){var s;const o=this._getFilterConditions(),c=r&&n&&a&&this._getEntityViewQueueItemConditions(r,n,a,i);if(o.length>0&&o.length>0&&(e=Object.assign(Object.assign({},e),{conditions:e.conditions.concat(o)})),c){const r=c.filter;r&&((e=Object.assign({},e)).filters?e.filters=e.filters.concat([r]):e.filters=[r]),(null===(s=c.linkEntities)||void 0===s?void 0:s.length)>0&&(t=t.concat(c.linkEntities))}return{filter:e,linkEntities:t}}_getEntityViewQueueItemConditions(e,t,r,n){var a;if(n=this._clearOldState(n),r&&n){let i;if(1===this._descriptor.Type&&this._descriptor.LogicalEntityName===R.Bb)i=this._descriptor.LogicalEntityName;else{if(0!==this._descriptor.Type&&2!==this._descriptor.Type)return this._filterAndLinkEntities;i=R.Bb}const s=Object(V.b)(n,this._pageId),o=Object(v.d)(n,s),c=Object(v.o)(o,e,t,r),l=Object(B.C)(n,this._pageId,c),u=Object(G.c)(n,U.Zc),d=Object(L.a)(i,null===(a=n.user)||void 0===a?void 0:a.userId,c,u),h=d&&d.getFilterAndLinkedEntities(l&&void 0!==l.activityOrQueueFilterValue?l.activityOrQueueFilterValue:M.a,l&&!l.activityOrQueue);this._filterAndLinkEntities=h}return this._filterAndLinkEntities}_clearOldState(e){return e?this._appState=null:e=this._appState,e}_getFilterConditions(){const e=[];switch(this._descriptor.Type){case 0:case 2:e.push({attributeName:"objecttypecode",conditionOperator:0,value:this._queueObjectTypeCode})}return e}getQueryStateKey(){const e=this._queueStreamType,t=[this._descriptor.LogicalEntityName,e];return 1===e&&t.push(this._descriptor.QueueId),t}}var q=r("txdA"),H=r("M0zh"),W=r("KBcj"),Y=r("JwRZ"),Q=r("BJ7u"),K=r("IqkD"),J=r("nIfK"),Z=r("Yx7Y");function $(e){return!(e.hasChart&&!e.hasGrid)}function ee(e,t,r,n){if(!r)return!1;if(t.hasGrid||4&t.streamMode){const t=Object(I.h)(e,n);if(!t||t.Initialized!==C.a.Initialized)return!1}if(t.cardFormId&&(!t.streamMode||4&t.streamMode)&&"activitypointer"!==n){const r=l.a.equals(t.cardFormId,Z.a)?Object(y.h)(e,n,Object(Q.a)(11)):t.cardFormId;if(!r||!l.a.isNullOrEmpty(r)&&!Object(y.j)(e,r))return!1}return!0}function te(e,t,r,n,a,i,s){const{appliedFilter:o,dateRangeTimeFrame:c,dateRangeStartDate:l,dateRangeEndDate:u}=Object(p.g)(e,t),d=o&&JSON.parse(o),h={conditions:[...ne(d,n),...re(e,n),...ae(e,r,n,c,l,u)],filterOperator:0,filters:function e(t,r){const n=[];if(t&&t.filters)for(const a of t.filters){const t=ne(a,r),i=e(a,r);(t.length||i.length)&&n.push({conditions:t,filterOperator:a.filterOperator,filters:i})}return n}(d,n)};if(a){const r=z.create(e,a,t).createStreamFilter(h,[],i,a.Id,s,e),n=r&&r.filter;if(n&&(n.conditions.length>0||n.filters.length>0))return r}else if(h.conditions.length>0||h.conditions.length>0)return{filter:h,linkEntities:null};return null}function re(e,t){let r=[];const n=Object(K.a)(e);return n&&n.FilterExpression&&n.FilterExpression.conditions&&n.FilterExpression.conditions.length>0&&n.EntityLogicalName===t&&(r=ne(n.FilterExpression,t)),r}function ne(e,t){const r=[];if(e&&e.conditions)for(const n in e.conditions){const a=e.conditions[n];a.entityName===t&&r.push(a)}return r}function ae(e,t,r,n,a,i){const s=Object(b.a)(e,t),o=je(e,t);if(s!==r||!o)return[];if("9"===n){return[{attributeName:o,conditionOperator:27,value:a},{attributeName:o,conditionOperator:26,value:i}]}const c=n||Ce(e,t),{startDate:l,endDate:u}=function(e){const t=new Date;let r=new Date;switch(e){case"0":r=t;break;case"1":t.setDate(t.getDate()-1),r=t;break;case"2":t.setDate(0===t.getDay()?t.getDate()-6:t.getDate()-t.getDay()+1),0!==r.getDay()&&r.setDate(r.getDate()+7-r.getDay());break;case"3":t.setDate(0===t.getDay()?t.getDate()-13:t.getDate()-t.getDay()-6),r.setDate(0===r.getDay()?r.getDate()-7:r.getDate()-r.getDay());break;case"4":t.setDate(1),r.setMonth(r.getMonth()+1),r.setDate(0);break;case"5":t.setDate(1),t.setMonth(t.getMonth()-1),r.setDate(0);break;case"6":t.setDate(1);break;case"7":t.setDate(1),t.setMonth(3*Math.floor(t.getMonth()/3)),r.setDate(1),r.setMonth(t.getMonth()+3),r.setDate(0);break;case"8":t.setDate(1),t.setMonth(3*Math.floor(t.getMonth()/3)-3),r.setDate(1),r.setMonth(t.getMonth()+3),r.setDate(0),r.setFullYear(t.getFullYear())}return{startDate:t,endDate:r}}(c);return[{attributeName:o,conditionOperator:27,value:`${l.getFullYear()}-${l.getMonth()+1}-${l.getDate()}`},{attributeName:o,conditionOperator:26,value:`${u.getFullYear()}-${u.getMonth()+1}-${u.getDate()}`}]}function ie(e,t,r){const n=[{name:"modifiedon",sortDirection:1}],a=Object(Y.x)(e,t,r);if(!Object(Y.c)(n,a))return n}function se(e,t,r,n){const a=Object(K.q)(e);let i=null;if(t&&a&&r){const n=Object(G.c)(e,U.Zc);i=Object(L.a)(t,a,null,n).getFilterAndLinkedEntities(r,!0)}if(!i&&n)return n;if(i&&n){if(n.filter){const e=n.filter,t={conditions:[],filterOperator:0,filters:[i.filter,e]};i.filter=t}n.linkEntities&&i.linkEntities.push(...n.linkEntities)}return i}var oe=r("69Qu"),ce=r("bwbe"),le=r("ATZz"),ue=r("pnQK"),de=r("Y2Yg"),he=r("qLnS"),pe=r("xhhr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ge="EE9078C8-6946-4E2C-B8F8-35E65F4BE6A8",me=new l.a("06375649-c143-495e-a496-c962e5b4488e"),be=new l.a("FD2A7985-3187-444e-908D-6624B21F69C0"),fe=new l.a("9FDF5F91-88B1-47f4-AD53-C11EFC01A01D"),ye=S.a.guid.toUpperCase(),_e="MscrmControls.Containers.DashboardControl",ve="MscrmControls.Containers.BoundDashboardControl",Se=["msdyn_/personalwall.htm"];function Oe(e,t){const r=Object(y.j)(e,t);return r&&r.TabAttributes&&r.TabAttributes.DashboardCategory&&0===r.TabAttributes.DashboardCategory.indexOf("1")}function Ie(e,t){const r=Object(y.j)(e,t);return r&&r.TabAttributes&&r.TabAttributes.DashboardCategory&&0===r.TabAttributes.DashboardCategory.indexOf("2")}function Ce(e,t){const r=Object(y.j)(e,t);return r&&r.TabAttributes&&r.TabAttributes.TimeFrame}function je(e,t){const r=Object(y.j)(e,t);return r&&r.TabAttributes&&r.TabAttributes.FilterBy}function Pe(e,t,r,n=!1,a=!1,i=!1){const s=Object(y.j)(e(),r),{updatedControlParameters:o}=Object(p.g)(e(),t),c=Object(v.d)(e(),r),u=!!Object(b.a)(e(),r);return Object(q.b)(e(),t,r,{[ye]:t=>!i&&Object(q.h)(e(),s,t),[_.a]:()=>!i,[ge]:()=>!0},i=>{const d=function(e,t){if(t&&t[e.Name])return Object.assign(Object.assign({},e.Parameters),t[e.Name]);return e.Parameters}(i,o),h=d&&d[0]&&d[0].StreamObjects&&d[0].StreamObjects.StreamObjectCollection;if(h){const n=d[0].StreamObjects.ShowAsTiles,a=[];for(const o of h){const l=i.Name+o.Id,u=z.create(e(),o,t),h=u.EntityLogicalName,p=o,g=te(e(),t,r,h,p,i.Name,!0),m={hasChart:!1,hasGrid:!0,gridType:0,recordsPerPage:25,customQueryStateKeyParts:u.getQueryStateKey(),getCustomSorting:(t,r)=>ie(e(),t,r),getCustomFilter:()=>se(e(),h,u.SavedQueueFilterId,g),contextToken:Object(v.o)(c,i.Name,o.Id,!0),streamMode:2|(n?0:1),streamId:o.Id,control:i,controlParameters:d,entityLogicalName:h,viewId:u.ViewId,savedQueueFilterId:u.SavedQueueFilterId};if(a.push({name:l+!0,control:m}),!n){const t=Object.assign(Object.assign({},m),{ribbonContext:H.i,cardFormId:Object(q.a)(e(),s,i),customQueryStateKeyParts:m.customQueryStateKeyParts.concat("x"),contextToken:Object(v.o)(c,i.Name,o.Id,!1),streamMode:5});a.push({name:l+!1,control:t})}}return a}const p=n&&Object(q.i)(e(),s,i,d),g=n&&Object(q.g)(e(),s,i,d),m=g&&(u?()=>te(e(),t,r,d.TargetEntityType):()=>function(e){if(e&&e.ChartDrillDownParameters&&e.ChartDrillDownParameters.length>0){const t=e.ChartDrillDownParameters,r=t[t.length-1].filterExpression,n=JSON.parse(r);let a=[];n&&n.conditions&&(a=n.conditions);let i=[];if(a)for(const e of a)e.linkEntityExpressions&&(i=i.concat(e.linkEntityExpressions));return{filter:{conditions:a,filterOperator:0},linkEntities:i}}return null}(d));let b,f;return p&&(b=d.SavedQueryOnQueue,b=b?l.a.fromExternalGuid(b).guid:M.a,f=()=>se(e(),d.TargetEntityType,b)),{hasChart:g,chartType:Object(q.f)(d),viewType:Object(q.e)(d),sectionIndex:g&&a&&Te(s,i.Name),getCustomFilter:g?m:f,hasGrid:p,recordsPerPage:p&&d.RecordsPerPage&&+d.RecordsPerPage,cardFormId:p&&Object(q.a)(e(),s,i),ribbonContext:p&&H.i,contextToken:Object(v.p)(c,i.Name),control:i,controlParameters:d,entityLogicalName:d.TargetEntityType,viewId:d.ViewId,savedQueueFilterId:b}})}function Te(e,t){if(e.Sections)for(const r in e.Sections){const n=e.Sections[r];let a=0;if(n.Rows)for(const e of n.Rows)if(e.Cells)for(const r of e.Cells){if(r.ControlName===t)return a;a++}}}function Ee(e,t,r){const n=Pe(()=>e,r,t),a={};for(const e in n){const t=n[e];a[e]=t.contextToken}return a}function we(e,t,r,n){var a,i,s;const o=Object(y.d)(e,t,r),c=Object(y.j)(e,t);if(o)for(const t in o){const r=o[t];switch(r.ClassId.guid.toUpperCase()){case ye:if(!Object(q.h)(e,c,r))break;case _.a:n(r.Parameters.TargetEntityType,r);break;case ge:const t=null===(s=null===(i=null===(a=r.Parameters)||void 0===a?void 0:a[0])||void 0===i?void 0:i.StreamObjects)||void 0===s?void 0:s.StreamObjectCollection;if(t)for(const e in t){const r=t[e];n(r.LogicalEntityName,r)}}}}function Fe(e,t,r,n=!0){const a=[];return we(e,t,r,(t,{Id:r})=>{(function(e,t,r){const n=Object(I.h)(e,t);if((null==n?void 0:n.Initialized)===C.a.Initialized&&!n.IsEnabledInUnifiedInterface)return!0;if(!r){return!n||n.Initialized===C.a.Error}return!1})(e,t,n)&&a.push(r)}),a}function xe(e,t,r,...n){const a=Object(y.d)(e,t,r);if(!a)return[];const i=[];for(const e in a){const t=a[e];n.find(e=>l.a.equals(t.ClassId,e))&&i.push(t)}return i}function Ae(e,t){if(e&&e.options){const r=l.a.toString(t);for(const t of e.options)if(t.value===r)return t}}function Ne(){let e=null,t=null;const r=1031..toString(),n=1030..toString(),a=1032..toString(),i=1035..toString(),s=1034..toString(),o=[s,i],c=function(){let e=null,t=null;const r=Object(f.h)();return function(n,a){const i=r(n,a.labelList);if(i!==e){e=i;const r=[{id:1030..toString(),name:Object(f.c)(i,a.SYSTEM_DASHBOARD_LABEL_ID)},{id:1031..toString(),name:Object(f.c)(i,a.USER_DASHBOARD_LABEL_ID)}];t=Object(G.a)(n,U.Uc,U.h)?r.reverse():r}return t}}();return(i,u,d)=>{const h=u?Object(b.g)(i,u):Object(b.c)(i),p=h?Object.keys(h):[];if(p.length>0&&(!e||t!==h)){const u=c(i,N);if(u&&u.length>0){t=h;const c=p.sort((e,t)=>{const r=h[e].DisplayName.toUpperCase(),n=h[t].DisplayName.toUpperCase();return r<n?-1:r>n?1:0});let g=!1;const m={},f=!Object(G.a)(i,U.Zb,U.h)||Object(pe.a)(i);for(const e of c){const t=h[e];if(t.Id&&Object(b.i)(t.Id))continue;if(t.Type===s&&!f&&!l.a.equals(d,new l.a(e)))continue;const i=Object(ue.c)(t);g=g||i;const c=i?r:n;m[c]||(m[c]=[]);const u={value:e,text:t.DisplayName,categoryId:c};t.Type===a?u.iconType=j.a.InteractiveDashboard:-1!==o.indexOf(t.Type)?u.iconType=j.a.OpenInPowerBI:(u.iconCategory=0,u.iconType=P.a.Dashboard),m[c].push(u)}const y=[],_=Object(G.a)(i,U.Uc,U.h),v=_?m[r]:m[n],S=_?m[n]:m[r];v&&y.push(...v),S&&y.push(...S);let O=u;g||(O=O.filter(e=>e.id!==r)),e={options:y,categories:O}}}else if(e){const t=e.categories,r=[];for(const e of t)e.name||r.push(e.id);if(r.length>0){const n={},a=c(i,N);if(a&&a.length>0)for(const e of a)-1!==r.indexOf(e.id)&&(n[e.id]=e.name);const s=[];for(const e of t)s.push({id:e.id,name:n[e.id]||e.name});e={options:e.options,categories:s}}}return e}}function De(e,t){const r=[],n=Object(O.d)(e,t);if(n)for(const a in n){const i=n[a];i&&i.IsGlobalFilterEnabled&&i.IsValidForRead&&Object(D.f)(e,t,i.LogicalName,he.a.CanRead)&&r.push(i)}return r}function ke(e){switch(e.Type){case"entityname":case"picklist":case"multiselectpicklist":case"boolean":case"status":case"state":return"MscrmControls.MultiSelectPicklist.UpdMSPicklistControl";case"decimal":case"double":case"integer":case"money":return"MscrmControls.Slider.LinearRangeSliderControl";case"customer":case"lookup":case"owner":case"partylist":return"MscrmControls.FieldControls.SimpleLookupControl"}return null}function Me(e,t,r,n){let a={};const i=Object(F.e)(e,_e);i&&(a[_e]=i),a=Object.assign(a,Object(w.db)(e,t,r,!0,c(3)),function(e,t,r){const n={},a=Oe(e,r),i=Ie(e,r);if(a||i){const r=[ve,"MscrmControls.DateRangeControl.DateRangeFilterControl"];if(function(e,t){const{appliedFilter:r}=Object(p.g)(e,t),n=r&&JSON.parse(r);if(n&&(n.conditions&&n.conditions.length||n.filters&&n.filters.length))return!0;return!1}(e,t)&&r.push("MscrmControls.AppliedFilters.AppliedFilters"),i){Object(x.c)(e)<Object(A.a)(e).sizes.Breakpoints.DimensionL&&r.push("MscrmControls.CarouselControl.GenericCarouselControl")}for(const t of r){const r=Object(F.e)(e,t);r&&(n[r.CustomControlId]=r)}}return n}(e,t,r));const s=Object(w.db)(e,t,r,!0,c(2)),o={};for(const e in s)a[e]||(o[e]=s[e]);return Re(e,t,r,a),Re(e,t,r,o),{inViewManifests:a,outOfViewManifests:o};function c(e){return(t,r,a)=>{const i=Object(y.d)(t,r,a),s={};for(const t in i){const r=i[t];if(!l.a.equals(l.a.EMPTY,r.ClassId)){let a=!1;if(r.ClassId.guid.toUpperCase()===ge){const t=r.Parameters&&r.Parameters[0]&&r.Parameters[0].StreamObjects&&r.Parameters[0].StreamObjects.StreamObjectCollection;if(t)for(const i in t){const s=t[i];if(a=(n({control:r,streamId:s.Id})&e)===e,a)break}}else a=(n({control:r})&e)===e;a&&(s[t]=r)}}return s}}}function Re(e,t,r,n){n.hasOwnProperty("MscrmControls.WebResource.WebResourceHtmlControl")&&0===function(e,t,r){const n=[],a=Object(y.d)(e,r,t);for(const e in a){const t=a[e],{isSupported:r,isWebResource:i}=Be(t);r&&i&&n.push(t.Id)}return n}(e,t,r).length&&delete n["MscrmControls.WebResource.WebResourceHtmlControl"],n.hasOwnProperty("MscrmControls.FieldControls.DummyControl")&&delete n["MscrmControls.FieldControls.DummyControl"];const a=Oe(e,r),i=Ie(e,r);if(a||i){Object(x.c)(e)<Object(A.a)(e).sizes.Breakpoints.DimensionS?delete n["MscrmControls.Grid.ReadOnlyGrid"]:a&&delete n["MscrmControls.KPICard.KPICardControl"],a&&delete n["MscrmControls.Chart.ChartControl"]}}function Le(e,t,r,n=!0){const a=Fe(e,t,r,n),i=Object(y.d)(e,t,r),s=[];let o=[];if(i)for(const e in i){const t=i[e];Object(E.a)(t.Id)||s.push(t.Id)}return o=s.filter(e=>a.indexOf(e)<0).filter(n=>function(e,t,r){const n=[],a=Object(y.d)(e,t,r);for(const e in a){const t=a[e],{isSupported:r,isWebResource:i}=Be(t);!r&&i&&n.push(t.Id)}return n}(e,t,r).indexOf(n)<0),o.length}function Be(e){let t=e.Parameters&&e.Parameters.Url;if(t=t&&t.toLowerCase(),t){for(const e of Se)if(t.length>=e.length&&t.length-e.length===t.lastIndexOf(e))return{isSupported:!1,isWebResource:!0};return{isSupported:!0,isWebResource:!0}}return{isWebResource:!1}}function Ve(e){return Object(oe.b)(e)&&Object(G.c)(e,U.J)}var Ge=r("Ki7F"),Ue=r("o0iw"),Xe=r("XIN1");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ze="GlobalFilter_Cancel",qe="GlobalFilter_Clear",He="GlobalFilter_CloseFilterPanel",We="GlobalFilter_Filters",Ye="GlobalFilter_OpenFilterPanel_UClient",Qe="GlobalFilter_CloseFilterPanel_UClient",Ke="GlobalFilter_No_Attributes",Je="GlobalFilter_ExpandAll",Ze="GlobalFilter_CollapseAll",$e="GlobalFilter_Apply",et="SliderControl_ClearButton",tt="GlobalFilter_SaveFilter_Toast_Delete_Success",rt="GlobalFilter_SaveFilter_Toast_Delete_Error",nt=[ze,qe,He,We,Ye,Ke,Je,Ze,$e,et,Qe,tt,rt],at="VisualFilter_Expand_UClient",it="VisualFilter_Collapse_UClient",st=[at,it],ot="Queue_Panel_Switch_TileView_Text",ct="Queue_Panel_Switch_StreamView_Text",lt=[ot,ct],ut="Ribbon.DashboardTab.Actions.Refresh.Label",dt="Ribbon.DashboardTab.Actions.OpenInPbi.Label",ht="Ribbon.DashboardTab.Actions.UserDefault.Label",pt="Ribbon.DashboardTab.Actions.ClearDefault.Label",gt="Display_Entity_Grid_Page",mt="Ribbon.DashboardTab.Actions.YammerButton",bt="Ribbon.DashboardTab.Management.Edit.Label",ft="Ribbon.DashboardTab.Management.Delete.Label",yt="Ribbon.DashboardTab.Actions.Share.Label",_t="Ribbon.DashboardTab.Actions.Assign.Label",vt="Ribbon.DashboardTab.Management.New.Label",St="Ribbon.DashboardTab.Management.New.ToolTipDescription",Ot="Ribbon.DashboardTab.Management.PowerBIDashboard.Label",It="Ribbon.DashboardTab.Management.PowerBIDashboard.ToolTipDescription",Ct="Ribbon.DashboardTab.Management.CRMDashboard.Label",jt="Ribbon.DashboardTab.Management.CRMDashboard.ToolTipDescription",Pt="Ribbon.DashboardTab.Management.SaveAs.Label",Tt=[ut,dt,ht,pt,gt,mt,bt,ft,yt,_t,vt,St,Ot,It,Ct,jt,Pt];var Et=r("zVFX"),wt=r("tJ+6");function Ft(e){return(t,r)=>e&&r?Object.assign(Object.assign({},t),r):t}function xt(e){return parseFloat(window.getComputedStyle(document.documentElement).fontSize)*parseFloat(e)}var At=r("fQ3D"),Nt=r("FhVi"),Dt=r("0uKS"),kt=r("odYE"),Mt=r("DRVD"),Rt=r.n(Mt),Lt=r("Nb1E"),Bt=r("VIXY"),Vt=r("bvqZ"),Gt=r("wyQO"),Ut=r("pEXn"),Xt=r("WePp"),zt=r("VnpK");function qt(e){return{type:"userquery.retrievefilterstate.async",execute({dispatch:t,getState:r},n){const a="?$filter=querytype eq 524288 and returnedtypecode eq '"+e+"'&$select=userqueryid,fetchxml,name",i=l.a.toString(Object(K.j)(r()));return t(Object(Lt.e)("userquery",a)).then(n=>{const a=n;let s=null;n&&n.value&&i&&n.value.forEach(e=>{if(e.userqueryid!==i);else{const t=e.fetchxml;s=Object(zt.i)(t)}});const o={EntityLogicalName:e,FilterExpression:s};t(function(e,t,r,n){const a=Object(K.x)(e),i=Object.assign({},a);let s=null;t&&t.value&&(s=t.value);let o=i.userSettings.savedFilters;o||(o={});o[n]=s,i.userSettings.savedFilters=o,r&&r.FilterExpression&&(i.userSettings.defaultSavedFilter=r);const c={userState:i};return{type:Gt.b,payload:c}}(r(),a,o,e))},e=>{n.EventManager.ReportComponentFailure("SaveFilterRetrieveMultiple",e)})},getFailureParameters:(e,t)=>[{name:Ut.b.DashboardId,value:"RetrieveSavedFilters"}]}}function Ht(e){return{type:"userquery.deletefilterstate.async",execute({dispatch:t,getState:r},a){const i=Rt.a.createEvent("savedFilterDelete","DeleteSavedFilters.Actions").startStopwatch(),s=new kt.a("userquery",new l.a(e.userQueryId)),o=t(Object(Lt.c)(s)),c=function(e,t){const r=Object(f.e)(e,t.globalFilterLabelList);return{deleteSuccessMessage:Object(f.c)(r,t.GLOBAL_FILTER_SAVEFILTER_TOAST_DELETE_SUCCESS),deleteErrorMessage:Object(f.c)(r,t.GLOBAL_FILTER_SAVEFILTER_TOAST_DELETE_ERROR)}}(r(),n),u=new Xt.a("uci_globalfilter_savefilter_delete");return o.then(n=>{i(),t(function(e,t){const r=Object(K.x)(e),n=Object.assign({},r),a=t.entityName,i=n.userSettings.savedFilters;i[a]=i&&i[a]&&i[a].filter(e=>e.userqueryid!==t.userQueryId),n.userSettings.savedFilters[a]=i[a];const s={userState:n};return{type:Gt.b,payload:s}}(r(),e)),Wt(t,s,!0,Object(Bt.a)(c.deleteSuccessMessage,e.filterName)),u.addEventParameter("SaveFilters",`${e.filterName} - ${e.userQueryId}`),a.EventManager.ReportEvent(u)},r=>{i(),Wt(t,s,!1,Object(Bt.a)(c.deleteErrorMessage,e.filterName)),a.EventManager.ReportComponentFailure("SaveFilterDelete",`${e.userQueryId} - ${r}`)})}}}function Wt(e,t,r,n){const a={id:"savedFilterDelete_"+t.id.guid,type:1,level:r?1:2,message:n};e(Object(Vt.b)(a))}function Yt(e){return{type:"userquery.updatefilterstate.async",execute({dispatch:t,getState:r},n){const a=Rt.a.createEvent("setDefaultSavedFilter","DefaultSavedFiltersUpdate.Actions").startStopwatch(),i=Object(K.q)(r()),s=new kt.a("usersettings",i),o=e.userSettingData,c=t(Object(Lt.f)(s,o.data));let u=o&&o.data&&o.data.selectedglobalfilterid;u=u||"";const d=new Xt.a("uci_globalfilter_savefilter_pin_unpin");return c.then(e=>{a(),t(function(e,t,r){const n=Object(K.x)(e),a=Object.assign({},n),i=a.userSettings.savedFilters,s=i&&i[r]&&i[r].find(e=>e.userqueryid===t),o=s&&s.fetchxml;a.userSettings.selectedGlobalFilterId=t?new l.a(t):l.a.EMPTY,a.userSettings.defaultSavedFilter||(a.userSettings.defaultSavedFilter={});a.userSettings.defaultSavedFilter.EntityLogicalName=r,a.userSettings.defaultSavedFilter.FilterExpression=Object(zt.i)(o);const c={userState:a};return{type:Gt.b,payload:c}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(r(),u,o.entityName)),d.addEventParameter("SaveFilters",u),n.EventManager.ReportEvent(d)},e=>{a(),n.EventManager.ReportComponentFailure("SaveFilterDefault",`${u} - ${e}`)})},getFailureParameters:(t,r)=>[{name:Ut.b.DashboardId,value:e.userSettingData.data.selectedglobalfilterid}]}}function Qt(e){return{type:"dashboard.setdefault.async",execute({dispatch:t,getState:r}){e||(e=l.a.EMPTY);const n=Object(K.q)(r()),a=new kt.a("usersettings",n);return t(Object(Lt.f)(a,{defaultdashboardid:e===l.a.EMPTY?null:e.guid.toUpperCase()})).then(()=>t(function(e,t){const r=Object(K.x)(t),n=Object.assign({},r);n.userSettings.defaultDashboardId=e===l.a.EMPTY?null:e;const a={userState:n};return{type:Gt.b,payload:a}}(e,r())))},getFailureParameters:(t,r)=>[{name:Ut.b.DashboardId,value:e&&e.guid}]}}var Kt=r("w1eR"),Jt=r("zu1I");var Zt,$t=r("Tz6o"),er=r("VpHT"),tr=r("FZDd");function rr(e){return{type:"loadGlobalFilterCustomControlResources.dashboardAction.async",getFailureParameters:()=>[{name:Ut.b.EntityName,value:e}],execute({dispatch:t,getState:r},n){const a=function(e,t){const r={},n=Object(F.e)(e,"MscrmControls.GlobalFilter.GlobalFilterControl");n&&(r["MscrmControls.GlobalFilter.GlobalFilterControl"]=n);const a=De(e,t);for(const t of a){const n=ke(t),a=n&&Object(F.e)(e,n);a&&(r[n]=a)}return Object.keys(r).map(e=>r[e])}(r(),e);for(const e of a)t(Object(er.a)(e));const i=[],s=function(e,t){const r=[],n=De(e,t);for(const e of n)if("MscrmControls.FieldControls.SimpleLookupControl"===ke(e)&&e.Targets)for(const t of e.Targets)-1===r.indexOf(t)&&r.push(t);return r}(r(),e);for(const r of s)r!==e&&-1===i.indexOf(r)&&t(Object(tr.f)(r,!0,[]));return Promise.resolve()}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.Unbound=0]="Unbound",e[e.Bound=1]="Bound",e[e.TierOne=2]="TierOne",e[e.TierTwo=4]="TierTwo"}(Zt||(Zt={}));class nr{constructor(){this._firstGlobalFilterOpen=!0}haveResourceStringsChanged(e){return!(this._globalFilterCommandLabels&&this._visualFilterCommandLabels&&this._streamTileSwitcherCommandLabels&&this._globalFilterCommandLabels.expand===e.globalFilterCommandLabels.expand&&this._globalFilterCommandLabels.collapse===e.globalFilterCommandLabels.collapse&&this._visualFilterCommandLabels.expand===e.visualFilterCommandLabels.expand&&this._visualFilterCommandLabels.collapse===e.visualFilterCommandLabels.collapse&&this._streamTileSwitcherCommandLabels.switchToTileView===e.streamTileSwitcherCommandLabels.switchToTileView&&this._streamTileSwitcherCommandLabels.switchToStreamView===e.streamTileSwitcherCommandLabels.switchToStreamView)}updateResourceStrings(e){this._globalFilterCommandLabels=e.globalFilterCommandLabels,this._visualFilterCommandLabels=e.visualFilterCommandLabels,this._streamTileSwitcherCommandLabels=e.streamTileSwitcherCommandLabels}resetCommands(e,t,r,n){t.ShowVisualFilters=!1,t.ToggleGlobalFilterFlyout=void 0,t.TileView=!1,r.ShowVisualFilters=!1,r.ToggleGlobalFilterFlyout=!1,r.TileView=!1,this._firstGlobalFilterOpen=!0,e.dashboardType&Zt.Bound&&n()}needsRefresh(e){return this._currentCommandBarType!==e.dashboardType}getCommandButtons(e,t,r,n,a,i){const s=e();this._currentCommandBarType=s.dashboardType;const o=[];if(s.isServerOffline)return o;let c=!!(this._currentCommandBarType&Zt.Bound);const u=l.a.isNullOrEmpty(s.formId)&&!l.a.isNullOrEmpty(s.selectedDashboardId)&&Ae(s.dashboardSelectorItems,s.selectedDashboardId);if(u&&(c=u.iconType===j.a.InteractiveDashboard),c){const c=s.isEntityBoundDashboard,l=this._currentCommandBarType&Zt.TierOne||c&&!(this._currentCommandBarType&Zt.TierTwo);l&&o.push(this._createToggleVisualFiltersButton(e,t,a)),o.push(this._createGlobalFilterButton(e,t,r,n,a)),l&&!i&&o.push(this._createStreamTileSwitcherButton(e,t,a)),c&&o.push({Icon:"Default",DisplayText:s.openEntityGrid,Id:"OpenEntityGrid",execute:()=>e().openGridPage(e().entityLogicalName)})}return o}_createToggleVisualFiltersButton(e,t,r){let n=e().dashboardInput;const a=e().visualFilterCommandLabels,i=a&&(n&&n.showVisualFilters?a.collapse:a.expand)||"",s=n&&n.showVisualFilters?"HideVisualFilter":"VisualFilter";return t.ShowVisualFilters=n&&n.showVisualFilters,{Icon:s,DisplayText:i,Tooltip:{title:i},Id:"ShowVisualFilters",execute:{type:"dashboard.visualfilter",execute:({dispatch:a})=>{r(),n=e().dashboardInput,t.ShowVisualFilters=!(n&&n.showVisualFilters);const i=Object.assign(Object.assign({},n),{showVisualFilters:t.ShowVisualFilters});return a(Object($t.b)(i,e().id)),Promise.resolve()}}}}_createGlobalFilterButton(e,t,r,n,a){t.GlobalFilterFlyoutAnchorId="DashboardGlobalFilterAnchor";const i=e().globalFilterCommandLabels,s=i&&(r().ToggleGlobalFilterFlyout?i.collapse:i.expand)||"";return{Icon:"GlobalFilter",DisplayText:s,Tooltip:{title:s},Id:"GlobalFilterCommandBarButton",execute:{type:"dashboard.globalfilter",execute:({dispatch:i,getState:s})=>(this._firstGlobalFilterOpen&&(this._firstGlobalFilterOpen=!1,i(rr(Object(b.a)(s(),e().formId)))),a(),t.ToggleGlobalFilterFlyout=!r().ToggleGlobalFilterFlyout,n({ToggleGlobalFilterFlyout:t.ToggleGlobalFilterFlyout}),Promise.resolve())}}}_createStreamTileSwitcherButton(e,t,r){let n=e().dashboardInput;const a=n&&n.showTileView?"TripleColumn":"Tiles",i=e().streamTileSwitcherCommandLabels,s=i&&(n&&n.showTileView?i.switchToStreamView:i.switchToTileView)||"";return t.TileView=n&&n.showTileView,{Icon:a,DisplayText:s,Tooltip:{title:s},Id:"StreamTileViewSwitcher",execute:{type:"dashboard.tileview",execute:({dispatch:a})=>{r(),n=e().dashboardInput,t.TileView=!(n&&n.showTileView);const i=Object.assign(Object.assign({},n),{showTileView:t.TileView});return a(Object($t.b)(i,e().id)),Promise.resolve()}}}}}var ar=r("9eA9"),ir=r("NvOS"),sr=r("BlGn"),or=r("tICD"),cr=r("d5N6"),lr=r("KdpX"),ur=r("+baL"),dr=r("tT9w"),hr=r("Uv1Y"),pr=r("jCkl"),gr=r("yJdb");function mr(e,t){const r="DashboardCommands.SaveAsDashboard",n=[];return n.push({name:Ut.g.ComponentName,value:r}),n.push({name:Ut.b.DashboardId,value:l.a.toString(e)}),{type:"dashboard.saveas",execute({dispatch:a,getState:i},s,o){const c=i();n.push({name:Ut.a.CorrelationId,value:o.correlationId},{name:Ut.a.ContextId,value:o.contextId});const u=Object(ue.a)(c,e);if(u){const e={telemetryParameters:n,reportFailure:(e,t=!0,i=null)=>{t&&a(Object(gr.b)()),n.push({name:Ut.a.ActionStack,value:o.stack}),s.EventManager.ReportComponentFailure(r,i||e,"",n),a(Object(dr.b)(e||{}))}};(function(e,t,r,n,a){const i=`${Object(ar.b)()}${Object(ir.a)(t,"/AdvancedFind/QueryProperties.aspx")}?dType=1&feature=dashboard`;r.telemetryParameters.push({name:"url",value:i});const s={windowPosition:"center",width:500,height:310},o={sName:n.DisplayName,sDescription:n.Description,sIsTabletEnabled:n.IsTabledEnabled};return e(Object(pr.b)(null)),e(Object(sr.a)(i,s,o,a)).then(t=>(e(Object(gr.b)()),0===t.status?e(Object(or.a)(t.pageId)).then(e=>e&&e.reason===cr.b&&e.value?e.value:null):(r.reportFailure(t.error,!1),null)))})(a,c,e,u,t).then(i=>{i&&function(e,t,r,n,{sName:a,sDescription:i,sIsTabletEnabled:s}){e(Object(pr.b)(null));const o=Object(ue.c)(n)?"userform":"systemform",c=new kt.a(o,n.Id);return e(Object(Lt.d)(c)).then(n=>{const o=function(e,t,r){var n;const a=(new DOMParser).parseFromString(r,"text/xml");if(!Object(G.c)(e,"FCB.DisableUserFormXmlLabelTransform")){const r=Object(K.s)(e),i=null===(n=Object(k.x)(e))||void 0===n?void 0:n.languageCode;if(t.telemetryParameters.push({name:"userLcid",value:r},{name:"orgLcid",value:i}),!i)return t.reportFailure(null,!0,new hr.a("No org lcid")),null;!function(e,t,r){const n=r.querySelectorAll("labels");for(let r=0;r<n.length;r++){const a=n[r],i=a.querySelectorAll("label");let s;if(i.length>1?(e&&(s=a.querySelector(`label[languagecode='${e}']`)),s||e===t||(s=a.querySelector(`label[languagecode='${t}']`)),s||(s=i[0])):1===i.length&&(s=i[0]),s){s.setAttribute("languagecode",t.toString());for(let e=0;e<i.length;e++){const t=i[e];a.removeChild(t)}a.appendChild(s)}}}(r,i,a)}!function(e){const t=e.querySelectorAll("control");for(let r=0;r<t.length;r++){const n=t[r],a=l.a.tryParseOrNull(n.getAttribute("classid"));if(l.a.equals(a,be)){const t=n.querySelector("Security");if(t)t.textContent="true";else{let t=n.querySelector("parameters");t||(t=e.createElement("parameters"),n.appendChild(t));const r=e.createElement("<Security>true</Security>");t.appendChild(r)}}}}(a);const i=new XMLSerializer;return i.serializeToString(a)}(t,r,n.formxml);if(!o)return null;const c={name:a,description:i,istabletenabled:s,type:n.type,formxml:o};return e(Object(Lt.b)("userform",c)).then(t=>(e(Object(gr.b)()),t))}).catch(r.reportFailure)}(a,c,e,u,i).then(e=>{n.push({name:"newDashboardId",value:l.a.toString(e)}),l.a.isNullOrEmpty(e)||a(Object(ur.a)(null,e,null,null,lr.b,!1,t)).then(()=>{s.EventManager.ReportComponentSuccess(r)})})})}return Promise.resolve()},getFailureParameters:(e,t)=>(n.push({name:Ut.b.DashboardCommandsParameters.Error,value:e},{name:Ut.b.DashboardCommandsParameters.Failure,value:t}),n)}}var br=r("E5IU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const fr=["Dashboard_LiveRegion_DateRangeFilter_Message","Dashboard_LiveRegion_Filter_Removed_Message","Dashboard_LiveRegion_GlobalFilter_Applied","Dashboard_LiveRegion_Initial_Message","Dashboard_LiveRegion_StreamView","Dashboard_LiveRegion_TileView","Dashboard_LiveRegion_VisualFilter_Applied","Dashboard_Tier2_TilesView_Title","Error.ReadOnlyEntity","Error.BoundDashboardOffline","Error.DashboardNoComponents","Error.DashboardUnsupportedComponents","Dashboard_Editor_Open_Title","Dashboard_Editor_Open_Message","Dashboard_Editor_Open_Confirm_Button","Dashboard_Header_Label"];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function yr(e,t){const r="DashboardCommands.EditPowerBIDashboard",n=[];return n.push({name:Ut.g.ComponentName,value:r}),n.push({name:Ut.b.DashboardId,value:l.a.toString(t)}),{type:"powerbidashboard.edit",execute({dispatch:a,getState:i},s,o){try{n.push({name:Ut.a.CorrelationId,value:o.correlationId},{name:Ut.a.ContextId,value:o.contextId},{name:Ut.b.DashboardCommandsParameters.IsPowerBIDashboard,value:!0});const c=l.a.isNullOrEmpty(t),u={uciCallback:r=>{const n=c?new l.a(r):t;a(Qn(e,n,c))}};if(!c){const e=Object(le.a)(i(),t);if(e){const r=Object(ue.a)(i(),t).IsTabledEnabled;Object.assign(u,{DashboardId:e.PowerBIDashboardId,GroupId:e.PowerBIGroupId,isTabletEnabled:r,CrmDashboardId:l.a.toString(t)}),n.push({name:Ut.b.DashboardCommandsParameters.PowerBIDashboardId,value:e.PowerBIDashboardId},{name:Ut.b.DashboardCommandsParameters.PowerBIGroupId,value:e.PowerBIGroupId})}}const d=`${Object(ar.b)()}${Object(ir.a)(i(),"/tools/dashboardeditor/dialogs/Powerbidashboard.aspx")}?dType=1&mode=edit`,h={width:800,height:480};return n.push({name:Ut.b.LegacyDialogUrl,value:d}),Object(pr.b)(null),a(Object(sr.a)(d,h,u,e)).then(e=>(Object(gr.b)(),s.EventManager.ReportComponentSuccess(r),e))}catch(e){return n.push({name:Ut.a.ActionStack,value:o.stack}),s.EventManager.ReportComponentFailure(r,e,"",n),Promise.reject(e)}},getFailureParameters:(e,t)=>(n.push({name:Ut.b.DashboardCommandsParameters.Error,value:e},{name:Ut.b.DashboardCommandsParameters.Failure,value:t}),n)}}var _r=r("nzu+"),vr=r("gQ5I"),Sr=r("EY5k"),Or=r("XvLr"),Ir=r("zsAz");function Cr(e,t){return{type:"dashboard.setLoadStatus",payload:t,meta:{pageId:e}}}class jr{constructor(e,t,r,n){this._finalResult={status:5},this._resultPromises=[],this._context=e,this._pageId=t,this._dispatch=r,this._getTelemetryParameters=n}setDashboardLoadResult(e,t){if(null==e)return;("number"==typeof e||e instanceof Number)&&(e={status:e,error:t});const r=e;if(r.then){const e=r.then(e=>this._setDashboardLoadResultInternal(e)).catch(e=>this._setDashboardLoadResultInternal({status:-1,error:e}));this._resultPromises.push(e)}else{const t=e;this._setDashboardLoadResultInternal(t)}}_setDashboardLoadResultInternal(e){e&&5!==e.status&&(this._finalResult=e)}finalizeDashboardLoadResult(){return 0===this._resultPromises.length?this._finalizeDashboardLoadResultInternal():Promise.all(this._resultPromises).then(()=>this._finalizeDashboardLoadResultInternal())}_finalizeDashboardLoadResultInternal(){const{status:e,error:t}=this._finalResult;return this._reportDashboardLoadResult(e,t),this._setErrorInfoInState(e),Promise.resolve()}_reportDashboardLoadResult(e,t){const r=this._getTelemetryParameters&&this._getTelemetryParameters();if(-1===e){let e=t;t&&("string"==typeof t||t instanceof String)&&(e=Object(Ir.d)(t?t.toString():"Error in finalize dashboard load result internal",2415919107));const n=r&&0!==r.length?void 0:"Supply telemetry parameters";this._context.EventManager.ReportComponentFailure("Dashboard.initializeAction",Error(e&&e.message),n,r)}else this._context.EventManager.ReportComponentSuccess("Dashboard.initializeAction",r)}_setErrorInfoInState(e){if(this._dispatch(Cr(this._pageId,e)),5!==e)switch(e){case 0:this._dispatch(Object(Sr.e)([Or.UCI_DISABLED_ENTITY_ERROR]));break;case 1:this._dispatch(Object(Sr.e)(["Error.ReadOnlyEntity"]));break;case 2:this._dispatch(Object(Sr.e)(["Error.BoundDashboardOffline"]));break;case 3:this._dispatch(Object(Sr.e)(["Error.DashboardNoComponents"]));break;case 4:this._dispatch(Object(Sr.e)(["Error.DashboardUnsupportedComponents"]))}}}var Pr=r("XVX7"),Tr=r("zmaG"),Er=r.n(Tr),wr=r("Lohl"),Fr=r("CfSh"),xr=r("f07+"),Ar=r("aRLb");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Nr={systemuser:[null],lead:["d228d73e-e56e-48b3-ab95-0a06b1397b03","95192c4e-f96e-4771-b10a-e6421c908533"],contact:["3d22ab88-96c8-4b3f-a533-d4827e2925c9","cdbb9298-3b2e-41f3-8f4a-0168d6b09fc4"],account:["fb65cc73-181c-468b-9bb3-82ecde306991","76b81f10-2a08-4f1a-9454-ee38bea94eb5"]},Dr=Object(Q.a)(6);function kr(e,t){if(t&&Object(b.i)(t))return{type:"mailApp.prefetchRegardingForm",execute:(t,r)=>(new Fr.a(r,t).getExternalContextProperty("MAIL_CONTEXT","TRACK_STATUS").then(r=>{const{dispatch:n,getState:a}=t;r&&r.crmRegardingObjectType&&function(e,t,r){const n=Object(I.m)(t(),r);if(n)return Promise.resolve(n);const a="LogicalName",i="$filter=ObjectTypeCode eq "+r,s=new xr.e(i,[a]);return e(Object(Ar.b)(s)).then(e=>e.json().then(e=>{var t,r;const n=null===(r=null===(t=null==e?void 0:e.value)||void 0===t?void 0:t[0])||void 0===r?void 0:r[a];return n?Promise.resolve(n):Promise.reject(new Error("Entity name is null"))}))}(n,a,r.crmRegardingObjectType).then(t=>{t&&!Nr[t]&&Mr(a,e,n,t,null,Dr)})}),Promise.resolve())}}function Mr(e,t,r,n,a,i){r(Object(wr.b)(new kt.a(n),a,i)).then(n=>{const a=Object(w.db)(e(),t,n,!0);for(const e in a){const t=a[e];r(Object(er.a)(t))}})}var Rr=r("OWbt"),Lr=r("9fGf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Br=2/(1+Math.sqrt(5));class Vr{constructor(){this._columns=-1,this._desiredColumns={}}getSectionRowCount(e,t){return e}isReflow(e,t){return e&&e.requiresReflow||this._columns<this.getDesiredColumnCount(t)}getRowHeight(e){return this._defaultRowHeight}static create(e,t,r,n,a){const i=new Vr;return i._form=e,i._formFactor=r,i._forbiddenControlIds=n||[],i._defaultRowHeight=a,i.setColumns(t),i}createDashboardLayout(e){const t=[];let r=0;for(const n of this._form.TabNames){const a=this._form.Tabs.find(e=>e.Name===n);let i=0;for(const n of a.Columns)for(const a of n.SectionNames){const n=this._form.Sections[a],s=this.createSectionLayout(n,e);s.offsetTop=r,t.push(s),i=Math.max(i,s.rowCount*this.getRowHeight(n))}r+=i}return t}createSectionLayout(e,t){let r=this._createControlsInDesiredLayout(e);return this.isReflow(r,e)&&(r=this.reflowLayout(r.controls,e,t)),r}setColumns(e){const t=e!==this._columns;return this._columns=e,t&&(this._desiredColumns={}),t}getDesiredColumnCount(e){const t=e.Id.guid;if(!this._desiredColumns[t]){let r=0;const n=e.Rows;if(n)for(let e=0;e<n.length;e++){const t=n[e];let a=0;for(let e=0;e<t.Cells.length;e++){a+=t.Cells[e].ColSpan}a>r&&(r=a)}this._desiredColumns[t]=Math.max(1,r)}return this._desiredColumns[t]}_createControlsInDesiredLayout(e){const t=e.Rows,r=[];let n=!1,a=t.length;for(let e=0;e<t.length;e++){const i=t[e];if(i.Visible){let t=0;for(let s=0;s<i.Cells.length;s++){const o=i.Cells[s];if("auto"===i.Height&&(o.RowSpan=1),o.ControlName&&this._form.Controls[o.ControlName]){const s=this._form.Controls[o.ControlName];if(!o.Visible&&5===this._form.FormType){const e=Object(F.a)(s,this._form,this._formFactor);if(!e||!e.ShouldOverrideControlVisible)continue;o.Visible=!0,s.Visible=!0}const{isSupported:c,isWebResource:l}=Be(s);if(c&&l||!l&&-1===this._forbiddenControlIds.indexOf(s.Id)){const c=this._getSubControls(s),l=Math.max(1,Math.floor(o.ColSpan/c.length));for(const a in c){if(!n)for(let a=0;a<l&&(n=this._cellIsOccupied(r,e,t+a),!n);a++);r.push({id:`${o.ControlName}${1===c.length?"":a}`,name:o.ControlName,componentIndex:+a,cell:o,row:e,rowHeight:i.Height,column:t,rowSpan:o.RowSpan,colSpan:l,canMemoize:!0}),t+=l}a=Math.max(a,e+o.RowSpan)}else n=!0}}}}return{controls:r,rowCount:this.getSectionRowCount(a,e),requiresReflow:n}}reflowLayout(e,t,r){const n=[];let a=0,i=0,s=0;const o=Math.min(this._columns,this.getDesiredColumnCount(t)),c=r/o;for(let r=0;r<e.length;r++){const l=e[r],u=r===e.length-1;if(l.row=a,l.column=i,l.colSpan>1){let e=!0;if(l.colSpan>o&&(l.colSpan=o),l.colSpan+l.column>o&&(e=!1),e)for(let t=l.colSpan;t>0;t--)if(this._cellIsOccupied(n,l.row,l.column+t)){e=!1;break}if(!e)for(;!e;){a++,l.row=a;for(let t=0;t<=o-l.colSpan;t++){l.column=t,e=!0;for(let t=l.colSpan;t>=0;t--)if(this._cellIsOccupied(n,l.row,l.column+t)){e=!1;break}if(e)break}}}if(n.push(l),this._useGoldenRatio(l)){const e=this._getGoldenRatioHeight(t,l,c);l.rowSpan=Math.round(e/this.getRowHeight(t))}else l.rowSpan=this._getRowSpan(o,l,t);if(s=Math.max(s,l.row+l.rowSpan),!u&&(i=l.column+l.colSpan,i>=o||this._cellIsOccupied(n,a,i))){for(;i<o&&this._cellIsOccupied(n,a,i);)i++;if(i>=o||this._cellIsOccupied(n,a,i))for(i=0,a++;this._cellIsOccupied(n,a,i);)i++,i>=o&&(i=0,a++)}}for(let t=0;t<e.length;t++){const r=e[t];for(;r.colSpan+r.column<o&&!this._cellIsOccupied(n,r.row,r.column+r.colSpan);)r.colSpan++}return{controls:n,rowCount:this.getSectionRowCount(s,t)}}_useGoldenRatio(e){const t=this._form.Controls[e.id];return t&&t.Parameters&&"Chart"===t.Parameters.ChartGridMode}_getRowSpan(e,t,r){return t.rowSpan+0}_getGoldenRatioHeight(e,t,r){const n=t.colSpan*r,a=t.rowSpan*this.getRowHeight(e);return a<n?a/n<n/(n+a)?Br*n:a/n*n:n/a>=a/(n+a)?1/(n/a)*n:1/Br*n}_cellIsOccupied(e,t,r){for(const n in e){const a=e[n];if(t>=a.row&&t<a.row+a.rowSpan&&r>=a.column&&r<a.column+a.colSpan)return!0}return!1}_getSubControls(e){if(l.a.equals(e.ClassId,new l.a(ge))){const t=e.Parameters&&e.Parameters[0]&&e.Parameters[0].StreamObjects&&e.Parameters[0].StreamObjects.StreamObjectCollection;if(t){const e=[];for(const r in t){const n=t[r];-1===this._forbiddenControlIds.indexOf(n.Id)&&e.push(n)}return e}}return[e]}}function Gr(e,t,r,n,a){const i=!!Object(b.a)(t,r.Id),s=Oe(t,r.Id);let o,c,l,u=!1,d=!1;const h=Fe(t,r.Id,e);let p;if(i){const e=Object(x.c)(t),r=Object(A.a)(t);d=e>=r.sizes.Breakpoints.DimensionS&&!a,!s&&e<r.sizes.Breakpoints.DimensionL&&(p=e>=r.sizes.Breakpoints.DimensionM?2:1)}else if(u=Object(b.i)(r.Id),!u){const e=Object(x.c)(t);let n=Object(Lr.b)(t);switch(n){case Lr.a.Phone:n=3;break;case Lr.a.Tablet:n=2;break;case Lr.a.Web:n=1}const a=Object(A.a)(t),i=Ur(a,e),s=(1===i?0:xt(a.sizes.Measures.Measure300))+(2*xt(a.sizes.Measures.Measure125)+xt(a.sizes.Measures.Measure300))+xt(a.sizes.Measures.Measure100);l=Object(x.b)(t)-s,o=Vr.create(r,i,n,h,xt(""+a.sizes.Section.cellHeightInRem)),c=o.createDashboardLayout(e)}return e=>{const t={};return r=>{const a=r.streamId?r.streamId+r.streamMode:r.control.Id;return t.hasOwnProperty(a)||(t[a]=function(e,t){if(s&&!n&&"VisualFilters"===e.control.ParentSectionName)return 2;if(e.streamId&&-1!==h.indexOf(e.streamId))return 0;if(u)return 7;if(i)return e.hasOwnProperty("streamMode")?!(1&e.streamMode)||d&&4&e.streamMode||s&&!d&&2&e.streamMode?7:0:e.hasOwnProperty("sectionIndex")&&(!s||n)&&(void 0===p||e.sectionIndex<p)?7:3;for(const r of c)for(const n of r.controls)if(n.name===e.control.Name)return r.offsetTop+n.row*o.getRowHeight(null)<l?e.hasGrid||e.hasChart?7:3:t;return 0}(r,e)),t[a]}}}function Ur(e,t){const r=xt(e.sizes.Measures.Measure150),n=r;return Math.max(1,Math.floor((t-n)/(320+r)))}var Xr=r("WA3M"),zr=r("hSDL"),qr=r("SZCI");let Hr;class Wr{constructor(e,t,r,n,a){this._callback=a,this._callbackCalled=!1,this._controlTypeCounts={},this._viewportRenderTime=0,this._controlsShouldRender=[],this._controlsShouldRenderCount=0,this._renderedControls=[];const i=Object(y.d)(e,r,t);if(i){const a=Pe(()=>e,t,r,!1,!1,!0),s={};for(const e in a){const t=a[e],r=t.control.Id;s[r]||(s[r]=[]),s[r].push(t)}for(const e in i){const t=i[e];if(e&&t&&!l.a.isNullOrEmpty(t.ClassId)&&t.Visible){const r=s[t.Id];if(r&&r.length>0){const t=[];for(const a of r)1&n(a)&&(-1===t.indexOf(a.streamId)&&(this._controlsShouldRenderCount++,t.push(a.streamId)),this._controlsShouldRender.push(`${e}_${a.streamId}_${!!(2&a.streamMode)}`))}else 1&n({control:t})&&(this._controlsShouldRender.push(e),this._controlsShouldRenderCount++)}}}}writeMarker(e,t,r){this._receivedEvent(e,t,r)}writeRetroactiveTimespan(e,t,r,n){this._receivedEvent(e,t+r,n)}startTimespan(e,t,r){return(n,a)=>{this._receivedEvent(e,t+n,r)}}_receivedEvent(e,t,r){if(this._callbackCalled)return;const n=e.getName();if(n===qr.o){const e=this._getControlParameter(r,qr.l);if(this._controlsShouldRender.indexOf(e)>=0&&-1===this._renderedControls.indexOf(e)){this._viewportRenderTime<t&&(this._viewportRenderTime=t);const n=this._getControlParameter(r,qr.n);this._controlTypeCounts[n]?this._controlTypeCounts[n]++:this._controlTypeCounts[n]=1,this._renderedControls.push(e),this._renderedControls.length===this._controlsShouldRenderCount&&(this._callbackCalled=!0,this._callback(this._viewportRenderTime,this._controlTypeCounts))}}else 0===this._controlsShouldRenderCount&&n===qr.i&&(this._callbackCalled=!0,this._callback(t,this._controlTypeCounts))}_getControlParameter(e,t){const r=e[t];return r||null}}var Yr=r("oOvK");var Qr=r("0nOn"),Kr=r("16wZ");function Jr(e){const t=[];return{type:"powerbidashboard.create",execute:({dispatch:r},n,a)=>(t.push({name:Ut.a.CorrelationId,value:a.correlationId},{name:Ut.a.ContextId,value:a.contextId}),r(yr(e)).then(e=>{e&&0===e.status?r(Object(or.a)(e.pageId)).then(()=>{n.EventManager.ReportComponentSuccess("DashboardCommand.PowerBiDialog")}):(t.push({name:Ut.a.ActionStack,value:a.stack}),n.EventManager.ReportComponentFailure("DashboardCommand.PowerBiDialog",e.error,"",t))})),getFailureParameters:()=>t}}var Zr=r("LAGg"),$r=r("FETf"),en=r("LE5i"),tn=r("uPT+");function rn(e,t){return{type:"dashboard.refresh",execute({dispatch:r,getState:n},a){const i=n(),s=Ee(i,e,t);for(const e in s){const n=s[e];r(Object(Zr.b)(t,n))}const o=function(e,t,r){return xe(e,t,r,me)}(i,e,t);for(const e of o)r(Object($r.o)(e.LabelId,en.a.InitiateRefresh,1,null));const c=function(e,t,r){return xe(e,t,r,be,fe)}(i,e,t),l=Object(y.j)(i,e);for(const e of c){const{isSupported:r,isWebResource:n}=Be(e);n&&!r||nn(i,a,t,l,e)}return r(Object(tn.b)(t,"Refresh")),Promise.resolve()}}}function nn(e,t,r,n,a){let i=Object(w.xb)(e,r,a.Name);if(!i){const t=n.Sections[a.ParentSectionName],s=l.a.toString(null==t?void 0:t.Id);i=Object(w.xb)(e,r,`${s}_${a.Name}`)}i?i.src=i.src:t.TraceManager.getTracer("dashboard.refresh").warn("Could not find iframe to refresh",[{name:"ControlName",value:a.Name},{name:"DashboardId",value:l.a.toString(n.Id)}])}var an=r("hBJV"),sn=r("K7RF"),on=r("x/aW"),cn=r("iJGp"),ln=r("/oKV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const un=["Button_Label_Delete","Button_Label_Cancel","Button_Label_Assign","Dialog_Delete_Title","Dialog_Delete_Description","Dialog_Assign_Title","Dialog_Assign_DescriptionSingular","RelatedInformation_Category_FollowUp_Label_AssignTo","SystemCustomization.OwnershipType.UserOwned"];var dn=r("+BIz"),hn=r("uWQm"),pn=r("SnEr"),gn=r("WKRf");function mn(e,t){const r=[],n="DashboardCommand.DeleteDashboard";return r.push({name:Ut.g.ComponentName,value:n}),r.push({name:Ut.b.DashboardId,value:l.a.toString(e)}),{type:"dashboard.delete",execute({dispatch:a,getState:i},s,o){r.push({name:Ut.a.CorrelationId,value:o.correlationId},{name:Ut.a.ContextId,value:o.contextId});const c=i(),l=Object(f.b)(c,"Dialog_Delete_Title"),u=Object(I.h)(c,"userform"),d=String.format(Object(f.b)(c,"Dialog_Delete_Description"),(null==u?void 0:u.DisplayName)||"User Dashboard"),h=Object(f.b)(c,"Button_Label_Delete"),p=Object(f.b)(c,"Button_Label_Cancel");return a(Object(dn.a)(d,{},l,t,"",h,p)).then(c=>0===c.status?a(Object(or.a)(c.pageId)).then(c=>{var l;if(null===(l=null==c?void 0:c.value)||void 0===l?void 0:l.confirmed){a(Object(pr.b)(null));const c=new kt.a("userform",e);a(Object(Lt.c)(c)).then(()=>{const r=Object(v.d)(i(),e);a(Object(gn.b)(t,!0,r)),a(Object(hn.c)(e,Object(oe.b)(i()))),a(Object(pn.b)(c)),Promise.all([a(Object(an.a)()),a({type:"usermetadataversion.retrieve.async",execute:({dispatch:e,getState:t},r)=>e(Object(sn.b)(on.a.UserMetadataVersion,null,null,null,!1,cn.a.OnDemandWithoutContext,null,null,[],null,ln.a.Remote)).catch(hr.b)})]).then(()=>{a(Object(lr.d)(null,void 0,void 0,void 0,!0,!0)).then(e=>{a(Object(gr.b)()),a(Object(ur.a)(null,e,void 0,void 0,void 0,!0,t)),s.EventManager.ReportComponentSuccess(n)})})},i=>{a(Object(ur.a)(null,e,void 0,void 0,void 0,!1,t)),a(Object(gr.b)()),r.push({name:Ut.a.ActionStack,value:o.stack}),s.EventManager.ReportComponentFailure(n,i,"",r);const c=new hr.a(i.message,i.errorCode);a(Object(dr.b)(c,!0,t))})}else s.EventManager.ReportComponentSuccess(n)}):Promise.reject(c.error))},getFailureParameters:(e,t)=>(r.push({name:Ut.b.DashboardCommandsParameters.Error,value:e},{name:Ut.b.DashboardCommandsParameters.Failure,value:t}),r)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function bn(e,t){const r="DashboardCommand.ShareDashboard",n=[];return n.push({name:Ut.g.ComponentName,value:r}),n.push({name:Ut.b.DashboardId,value:l.a.toString(e)}),{type:"dashboard.share",execute({dispatch:a,getState:i},s,o){const c=i(),u=Object(br.i)(c);let d=`${Object(ar.b)()}${Object(ir.a)(c,"/_grid/cmds/dlg_share.aspx")}?dType=1&iObjType=${1031..toString()}&iTotal=1&sIds={${l.a.toString(e)}}`;return u&&(d+="&appid="+u),new Promise(i=>{n.push({name:Ut.b.LegacyDialogUrl,value:d},{name:Ut.a.CorrelationId,value:o.correlationId},{name:Ut.a.ContextId,value:o.contextId});const c=[l.a.toString(e)];a(Object(pr.b)(null)),a(Object(sr.a)(d,{windowPosition:"center",width:885,height:500},c,t)).then(e=>{a(Object(gr.b)()),0===e.status?s.EventManager.ReportComponentSuccess(r):(n.push({name:Ut.a.ActionStack,value:o.stack}),s.EventManager.ReportComponentFailure(r,e.error,"",n))}),i()})},getFailureParameters:(e,t)=>(n.push({name:Ut.b.DashboardCommandsParameters.Error,value:e},{name:Ut.b.DashboardCommandsParameters.Failure,value:t}),n)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class fn{getMetadata(){return{boundParameter:null,operationName:"Assign",operationType:0,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},Assignee:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const yn="entity_id",_n="entity_name",vn="owner_id",Sn="owner_type";function On(e,t){const r=[],n="DashboardCommand.AssignDashboard";return r.push({name:Ut.g.ComponentName,value:n}),r.push({name:Ut.b.DashboardId,value:l.a.toString(e)}),{type:"dashboard.assign",execute({dispatch:a},i,s){r.push({name:Ut.a.CorrelationId,value:s.correlationId},{name:Ut.a.ContextId,value:s.contextId});const o=[new kt.a("userform",e)],c={[yn]:l.a.toString(e),[_n]:"userform",entityTypeCode:1031..toString(),entity_records:o,selected_records_count:1,last_button_clicked:"",[vn]:"",[Sn]:""};return a(Object(Jt.b)("Assign",{},c,t)).then(o=>0===o.status?a(Object(or.a)(o.pageId)).then(o=>{var c;if("ok_id"===(null===(c=null==o?void 0:o.value)||void 0===c?void 0:c.last_button_clicked)){const{[vn]:c,[Sn]:l,[_n]:u,[yn]:d}=o.value,h=new fn;h.Target={id:d,entityType:u},h.Assignee={id:c,entityType:l},a(Object(pr.b)(null)),a(Object(Ar.b)(h)).then(e=>{e.ok&&a(Object(lr.d)(null,void 0,void 0,void 0,!0,!0)).then(e=>{a(Object(ur.a)(null,e,void 0,void 0,void 0,!0,t)),a(Object(gr.b)())}),i.EventManager.ReportComponentSuccess(n)},o=>{a(Object(ur.a)(null,e,void 0,void 0,void 0,!1,t)),a(Object(gr.b)()),r.push({name:Ut.a.ActionStack,value:s.stack}),i.EventManager.ReportComponentFailure(n,o,"",r);const c=new hr.a(o.message,o.errorCode);a(Object(dr.b)(c,!0,t))})}else i.EventManager.ReportComponentSuccess(n)}):Promise.reject(o.error))},getFailureParameters:(e,t)=>(r.push({name:Ut.b.DashboardCommandsParameters.Error,value:e},{name:Ut.b.DashboardCommandsParameters.Failure,value:t}),r)}}var In=r("EOZU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let Cn;class jn{constructor(e,t,r){const n=[{name:"store",value:e,isRequired:!0},{name:"pageId",value:r,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];this._clientApiExecutor=new Qr.a(e,"ClientApi.XrmDashboardCommands.",r,t,n),Cn=e,this._pageId=r}_executeCommand(e,t,r){return this._clientApiExecutor.executeAsync(e,()=>{const e=t();return Cn.dispatch(e)},r)}_executeDashboardIdCommand(e,t,r,n=!1,a){const i=l.a.tryParseOrNull(t),s=[{name:"dashboardId",value:i&&t,isRequired:!0,isEventParam:!0,expectedDataType:"string"},...a||[]];this._executeCommand(e,()=>{if(!n&&Object(b.a)(Cn.getState(),i)){const t=this._clientApiExecutor.getComponentName(e);Object(Kr.j)(t,"isBoundDashboard")}return r(i)},s)}createNewDashboard(){this._executeCommand("createNewDashboard",()=>Kn(this._pageId))}createNewPowerBIDashboard(){this._executeCommand("createNewPowerBIDashboard",()=>Jr(this._pageId))}setUserDefaultDashboard(e){return this._executeCommand("setUserDefaultDashboard",()=>Qt(l.a.tryParseOrNull(e)||l.a.EMPTY))}refreshDashboard(e){this._executeDashboardIdCommand("refreshDashboard",e,e=>rn(e,this._pageId),!0)}saveDashboardAs(e){this._executeDashboardIdCommand("saveDashboardAs",e,e=>mr(e,this._pageId),!1)}editDashboard(e){this._executeDashboardIdCommand("editDashboard",e,e=>Yn(this._pageId,e))}deleteDashboard(e){this._executeDashboardIdCommand("deleteDashboard",e,e=>mn(e,this._pageId),!1)}shareDashboard(e){this._executeDashboardIdCommand("shareDashboard",e,e=>bn(e,this._pageId),!1)}assignDashboard(e){this._executeDashboardIdCommand("assignDashboard",e,e=>On(e,this._pageId),!1)}openInPowerBI(e){this._executeDashboardIdCommand("openInPowerBI",e,e=>Object(In.a)(e))}}var Pn=r("pp6D"),Tn=r("11K9"),En=r("mlvZ");function wn(e,t,r=!1){return{type:"dashboard.setUpdatedControlParameters",sync:!0,execute:({getState:n,dispatch:a})=>{const i=Object(p.g)(n(),e),s=i.updatedControlParameters||{},o=Object.assign({},t),c=[];for(const e in o){c.push(e);const t=s[e],n=o[e];r?o[e]=Object.assign(Object.assign({},t),n):!Fn(n)&&Fn(t)&&(o[e]=Object.assign(Object.assign({},n),xn(t)))}for(const e in s)if(-1===c.indexOf(e)){const t=s[e];r?o[e]=t:Fn(t)&&(o[e]=xn(t))}const l=Object.assign(Object.assign({},i),{updatedControlParameters:o});a(Object($t.b)(l,e))}}}function Fn(e){return e&&e.hasOwnProperty("FirstDataRequestType")}function xn(e){return{FirstDataRequestType:e.FirstDataRequestType}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function An(e,t,r){return wn(e,{[t]:{FirstDataRequestType:r}},!0)}function Nn(e,t,r,n,a,i){const{parameters:s,initializeParameters:c,getTelemetryParameters:u,getCommonKPIParameters:d}=function(e){const t={},r=()=>[{name:Ut.b.RetrievedDashboardId,value:l.a.toString(t.retrievedId)},{name:Ut.b.DashboardTypeFlags,value:t.dashboardTypeFlags},{name:Ut.b.BoundDashboardEntity,value:t.boundDashboardEntity}];return{parameters:t,initializeParameters:(e,r)=>(e&&Object.assign(t,e),r&&Object.assign(t,r),t),getTelemetryParameters:()=>[...Object(Tn.a)(t,e),...r()],getCommonKPIParameters:e=>(t.boundDashboardEntity=Object(b.a)(e,t.retrievedId),t.dashboardTypeFlags=function(e,t){if(Object(b.i)(t))return 4;let r=0;const n=Object(b.a)(e,t);let a=Object(ue.a)(e,t);if(n&&(r|=2,a||(a=Object(ue.a)(e,t,n),a&&(r|=64)),Oe(e,t)?r|=128:Ie(e,t)&&(r|=256)),a){if(!n){if(Object(le.b)(e,t)){r|=32;const n=Object(le.a)(e,t);"1"===n.Type?r|=512:"2"===n.Type&&(r|=1024)}r|=1}Object(ue.c)(a)?r|=8:r|=16}return r}(e,t.retrievedId),Object(En.c)(r()))}}(e),h=`dashboard.${e}.async`,g=()=>r(e=>({type:h,getFailureParameters:u,execute:({dispatch:r,getState:i},g)=>{const m=e=>e&&r(e),f=new jr(g,t,m,u),_=f.setDashboardLoadResult.bind(f),S=()=>f.finalizeDashboardLoadResult(),O=Object(p.g)(i(),t),{dashboardId:j,retrievedId:P,error:T}=c(O,e);l.a.isNullOrEmpty(P)||l.a.equals(j,P)||m(Object($t.b)(Object.assign(Object.assign({},O),{dashboardId:P}),t));const w=Object(v.d)(i(),P),x=n(i,m,g,t,w,s);if(T)return x(j),_(-1,T),S();const A=d(i());Er.a.addCommonKpiParameters(A,!0);const N=Object(y.j)(i(),P);return function(e,t,{retrievedId:r,boundDashboardEntity:n},a){const i=!r||!t;if(Object(oe.b)(e)){if(i)return a(-1,"Could not retrieve dashboard."),!1}else if(i||n)return a(2,n?"Bound dashboard is not available while user is offline":"Sorry, Dashboard is not available while you're offline. Reconnect to see updated results"),!1;return!0}(i(),N,s,_)?(function(e,t,r,n,a,i,s,{dashboardId:c,retrievedId:u,etn:d,showVisualFilters:h,showTileView:p},g,m,f){d||(d=Object(b.a)(t(),u));const y=!!d;r(function(e,t){if(t&&Object(b.i)(t))return{type:"mailApp.prefetchRecipientForms",execute:({dispatch:t,getState:r})=>{const n=Object(br.c)(r()),a=(n?n.entities:[]).map(e=>e&&e.LogicalName);for(const n in Nr)if(-1!==a.indexOf(n))for(const a of Nr[n])Mr(r,e,t,n,a&&new l.a(a),Dr);return Promise.resolve()}}}(a,c));const _=r(function(e){if(e)return{type:"dashboard.checkEntity",execute:({dispatch:t,getState:r})=>t(Object(tr.f)(e,!1,[])).then(()=>{const t=Object(I.h)(r(),e),n={status:5};if(t&&t.Initialized===C.a.Initialized){const a=!t.IsEnabledInUnifiedInterface,i=!Object(D.g)(r(),e,2,0);a?(n.status=0,n.error=e+" is not enabled for UCI"):i&&(n.status=1,n.error=`User does not have ${e} read privilege in UCI`)}return n})}}(d));f(_);const v=r(Object(Rr.h)(u,a,i,null,Se)).then(()=>(m().then(()=>r(kr(a,c))),null)).catch(e=>(m(),Promise.reject(e)));f(v);const S=Gr(a,t(),s,h,p),O=S(7),j=S(6),P=function(e,t,r,n){const a=Pe(e,r,n,!0,!0);for(const e in a){const n=a[e];n.savedQueueFilterId&&t(Object(zr.k)(n.savedQueueFilterId,r,n.contextToken))}return a}(t,r,a,u),T=y&&(e=>{for(const t in P){const r=P[t];if(e===r.entityLogicalName&&4&r.streamMode)return!0}return!1}),w=y&&function(e,t,r){if(!Object(G.c)(e(),U.q))return null;let n,a=!1;return(i,s)=>{if(i.entityLogicalName!==r||a)return null;if(!n){const i=Object(K.i)(e());i&&i[r]?a=!0:n=t(qt(r))}return n?(s.push(n),[n]):void 0}}(t,r,d);(function(e,t,r,n,a){const i=Object(oe.b)(e);for(const e in a){const s=a[e];if(s.hasChart){const e=4&n(s)&&i?2:1;t(An(r,s.control.Name,e))}}})(t(),r,a,j,P),Object(Xr.a)(t,r,n.TraceManager.getTracer(e),n.EventManager,a,s,null,P,j,T,w,!1,!0),r(function(e,t,r){return{type:"dashboard.loadControlResources",execute:({dispatch:n,getState:a})=>{let i;return i=je(a(),t)&&!Object(F.e)(a(),ve)?e=>n(Object(Yr.c)(ve,null,!1)).then(e):e=>e(),i(()=>{const{inViewManifests:i,outOfViewManifests:s}=Me(a(),e,t,r),o=e=>{for(const t in e){const r=e[t];r&&r.Properties&&r.Properties.Resources&&n(Object(er.a)(r))}};o(i),o(s)}),Promise.resolve()}}}(a,u,O)),function(e,t,r,n,a){Hr&&Rt.a.removeTransport(Hr),Hr=new Wr(e,t,r,n,(e,t)=>{Rt.a.removeTransport(Hr),Hr=null;const r=a(),n={PageName:o.a};n[Ut.b.PageInfraReadyParameters.RenderedControls]=t;for(const e of r)Object(E.a)(e.value)||(n[e.name]=e.value);Er.a.addKeyPerformanceIndicator("PageInfraReady",n,e)}),Rt.a.registerTransport(Hr,[Tr.KPI_ZONE,"PageInfraReady",qr.d])}(t(),a,u,j,g),function(e,t,r,n){if(0===Le(e,r,t)){n(Fe(e,r,t).length>0?4:3)}}(t(),a,u,f)}(h,i,m,g,t,w,N,s,u,x,_),a&&a(m,t,s),S()):(x(P||j),S())}}));return()=>({type:`dashboard.${e}Wrapper.async`,getFailureParameters:u,execute:({getState:e,dispatch:t})=>(g(),i(e,t))})}function Dn(e,t,r,n,a,i,...s){return o=>{const c=Ve(e());return(c&&!n&&!o&&s?Promise.all([...s,i]):i).then(()=>{c&&(n||(o||(o=Object(ue.b)(e(),a)),n=Object(v.d)(e(),o)),t(function(e,t,r){const n=(e,t,r)=>new jn(e,t,r);return Object(Pn.a)(e,t,r,n)}(n,r,a))),t(Object(Pr.a)(!0,r,n))})}}var kn=r("6kq6"),Mn=r("ZFRl");function Rn(e,t,r){return{type:"dashboard.setTitle",sync:!0,execute:({dispatch:n,getState:a})=>{const i=Object(b.b)(a(),t,null,r);let s=i&&i.Name;if(!s){const e=Object(ue.a)(a(),t,r);s=e&&e.DisplayName}n(Object(Mn.c)(e,s))}}}var Ln=r("uCpV"),Bn=r("X37l");function Vn(e,t){return{type:"dashboard.addToMRU",execute:({dispatch:r,getState:n})=>{const a=Object(ue.a)(n(),e,t);if(t&&!e&&(e=a&&a.Id),a){let t=1030;Object(ue.c)(a)&&(t=1031);const i=Object(I.m)(n(),t),s={RecordType:Bn.a.Entity,EntityTypeName:i,LastAccessed:new Date,ObjectId:e,Title:a.DisplayName,IconPath:Object(I.j)(n(),i,e)};r(Object(Ln.b)(s))}return Promise.resolve()}}}var Gn=r("lq82"),Un=r("wF0i"),Xn=r("bsQO"),zn=r("rQHy");let qn=0;function Hn(e,t){let r;const n=new Promise(e=>r=e);t=Object.assign(Object.assign({},t),{pageType:"dashboard"});return Nn("SwitchDashboard",e,e=>n.then(([t,r])=>t(e(r))),Wn,null,(n,a)=>{Object(Un.d)(o.a,Object(En.c)(Object(Tn.a)(t,"SwitchDashboard")));const{dashboardId:i,etn:s}=t;if(qn++,1===qn){const e=!!Object(b.b)(n(),i,null,s);Er.a.onNextIdleProcessing(function(e){return()=>{const t={[Ut.x.PageName]:o.a,[Ut.x.LoadType]:(e?3:1).toString(),[Ut.b.PageLoadParameters.NavigationOrigin]:o.a};Er.a.addCommonKpiParameters(t),Er.a.addMetadataToTimeline(t),e&&Object(Xn.b)(),qn=0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e))}return a(Object(Gn.a)(t)),a(Object($t.b)(t,e)),a(Object(kn.a)(t)).then(e=>r([a,e])),a(Rn(e,i,s)),a(Vn(i,s)),Promise.resolve()})()}function Wn(e,t,r,n,a,{etn:i}){r.ScriptManager.removeContainer(n,!0);const s=r.ScriptManager.initializeContainerForClientApi(n),o=Dn(e,t,n,a,i,s);return Ve?e=>o(e).then(()=>{t(Object(zn.a)(n))}):o}function Yn(e,t,r){const n=[];return n.push({name:Ut.g.ComponentName,value:"DashboardCommands.EditDashboard"}),n.push({name:Ut.b.DashboardId,value:l.a.toString(t)}),{type:"dashboard.edit",execute({getState:a,dispatch:i},s,o){try{const s=a(),c=l.a.isNullOrEmpty(t);if(!c&&Object(le.b)(s,t))return i(yr(e,t));n.push({name:Ut.a.CorrelationId,value:o.correlationId},{name:Ut.a.ContextId,value:o.contextId},{name:Ut.b.DashboardCommandsParameters.IsPowerBIDashboard,value:!1});const u=`/main.aspx?extraqs=%26${c?"layoutId="+r:"formId="+l.a.toString(t)}%26dashboardType=1031&pagetype=dashboardeditor`,d=Object(ir.a)(a(),u);n.push({name:Ut.b.LegacyDialogUrl,value:d});const h=Object(x.c)(s),p=Object(x.b)(s),g={},m={height:180,width:360},b=Object(f.b)(s,"Dashboard_Editor_Open_Title"),y=Object(f.b)(s,"Dashboard_Editor_Open_Message"),_=Object(f.b)(s,"Dashboard_Editor_Open_Confirm_Button");g.text=b+"\n"+y,g.confirmButtonLabel=_;const v=window.open(d,"_blank",`width=${h}, height=${p}, resizable=1, align-item=center, justify-content=center`);let S;v.IsHybridAF=!0;const O=r=>{var n;(n=r)&&n.origin===window.location.origin&&n.data&&n.data.formId&&(window.top.removeEventListener("message",O),S&&(v.close(),i(Object(vr.e)(S)).then(()=>{const n=c?new l.a(r.data.formId):t;i(Qn(e,n,c))})))};return i(Object(_r.a)(g,m,e)).then(e=>{0===e.status&&(S=e.pageId,i(Object(or.a)(S)).then(()=>{S=null,window.top.removeEventListener("message",O)}))}),window.top.addEventListener("message",O),Promise.resolve()}catch(e){return n.push({name:Ut.a.ActionStack,value:o.stack}),s.EventManager.ReportComponentFailure("DashboardCommands.EditDashboard",e,"",n),Promise.reject(e)}},getFailureParameters:(e,t)=>(n.push({name:Ut.b.DashboardCommandsParameters.Error,value:e},{name:Ut.b.DashboardCommandsParameters.Failure,value:t}),n)}}function Qn(e,t,r){return{type:"dashboard.edit.navigate",execute:({dispatch:n})=>{if(r)return n(Object(ur.a)(null,t,null,null,lr.b,!1,e));return n(Object(lr.d)(null,t,null,lr.b,!1,!0)).then(t=>n(Hn(e,{dashboardId:t,type:lr.b})))}}}function Kn(e){const t=[];return{type:"dashboard.create",execute({dispatch:r,getState:n},a,i){t.push({name:Ut.a.CorrelationId,value:i.correlationId},{name:Ut.a.ContextId,value:i.contextId});const s=Object(br.i)(n());let o=`${Object(ar.b)()}${Object(ir.a)(n(),"/tools/dashboardeditor/dialogs/dashboardlayoutdialog.aspx")}?dType=1`;s&&(o+="&appid="+s);return r(Object(sr.a)(o,{width:800,height:480},{uciCallback:t=>r(Yn(e,null,t))},e)).then(e=>{e&&0===e.status?a.EventManager.ReportComponentSuccess("DashboardCommand.NewDashboardDialog"):(t.push({name:Ut.a.ActionStack,value:i.stack}),a.EventManager.ReportComponentFailure("DashboardCommand.NewDashboardDialog",e.error,"",t))})},getFailureParameters:()=>t}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Jn{constructor(){this._showSetAsDefaultButton=!1,this._isUserDashboard=!1}haveResourceStringsChanged(e){return!this._ribbonLabels||this._ribbonLabels.refresh!==e.ribbonLabels.refresh||this._ribbonLabels.setAsDefault!==e.ribbonLabels.setAsDefault||this._ribbonLabels.unsetDefault!==e.ribbonLabels.unsetDefault||this._ribbonLabels.yammerLabelInDashboards!==e.ribbonLabels.yammerLabelInDashboards||this._ribbonLabels.editDashboard!==e.ribbonLabels.editDashboard||this._ribbonLabels.deleteDashboard!==e.ribbonLabels.deleteDashboard||this._ribbonLabels.shareDashboard!==e.ribbonLabels.shareDashboard||this._ribbonLabels.assignDashboard!==e.ribbonLabels.assignDashboard||this._ribbonLabels.createNewDashboard!==e.ribbonLabels.createNewDashboard||this._ribbonLabels.createNewDashboardTooltip!==e.ribbonLabels.createNewDashboardTooltip||this._ribbonLabels.createDynamicsDashboard!==e.ribbonLabels.createDynamicsDashboard||this._ribbonLabels.createDynamicsDashboardTooltip!==e.ribbonLabels.createDynamicsDashboardTooltip||this._ribbonLabels.createPowerBIDashboard!==e.ribbonLabels.createPowerBIDashboard||this._ribbonLabels.createPowerBIDashboardToolTip!==e.ribbonLabels.createPowerBIDashboardToolTip}updateResourceStrings(e){this._ribbonLabels=e.ribbonLabels}needsRefresh(e){if(this._memoizedDashboardId&&!l.a.equals(this._memoizedDashboardId,this._getDashboardId(e)))return!0;const{hasPossibleDashboardId:t}=this._checkForDashboardIds(e);if(this._isUserDashboard!==this._getIsUserDashboard(e,t))return!0;const r=!(e.isServerOffline||e.isEntityBoundDashboard||e.defaultDashboardId&&l.a.equals(e.defaultDashboardId,e.formId||l.a.EMPTY)),n=e.defaultDashboardId&&e.defaultDashboardId.guid;if(this._showSetAsDefaultButton!==r||this._defaultDashboardId!==n)return!0;const a=e.userDashboardPrivileges;if(this._memoizedUserDashboardPrivileges&&a){if(Object.keys(this._memoizedUserDashboardPrivileges).length!==Object.keys(a).length)return!0;for(const e in a)if(a[e]!==this._memoizedUserDashboardPrivileges[e])return!0}return!1}getCommandButtons(e,t){const r=[],n=e(),{hasActualDashboardId:a,hasPossibleDashboardId:i}=this._checkForDashboardIds(n);this._memoizedDashboardId=this._getDashboardId(n);const s=n.isEntityBoundDashboard;this._showSetAsDefaultButton=!(n.isServerOffline||s||n.defaultDashboardId&&l.a.equals(n.defaultDashboardId,this._getDashboardId(n))),this._defaultDashboardId=n.defaultDashboardId&&n.defaultDashboardId.guid,this._isUserDashboard=this._getIsUserDashboard(n,i);const o=e=>n.userDashboardPrivileges&&n.userDashboardPrivileges[e];if(this._memoizedUserDashboardPrivileges=n.userDashboardPrivileges,!n.isRibbonCustomizable){const c=a||i;n.hybridButtonsOnUCIEnabled&&o(1)&&(c&&this._isUnboundDashboard(n,i)&&r.push(this._createSaveAsButton(e)),r.push(this._createNewDashboardFlyoutButton(e))),c&&(n.hybridButtonsOnUCIEnabled&&this._isUserDashboard&&(o(3)&&r.push(this._createEditButton(e)),o(4)&&r.push(this._createDeleteButton(e))),this._showSetAsDefaultButton?r.push(this._createTogglesetDefaultButton(e,t,!0)):n.isServerOffline||s||!n.isUnsetDefaultDashboardFeatureEnabled||r.push(this._createTogglesetDefaultButton(e,t,!1)),n.hybridButtonsOnUCIEnabled&&this._isUserDashboard&&(o(6)&&r.push(this._createShareButton(e)),o(5)&&r.push(this._createAssignButton(e))),r.push(this._createRefreshButton(e)))}return function(e){return!(e.isServerOffline||e.clientHostType!==Kt.a.Browser||e.isOnPremise||!e.yammerPostsOnUCIEnabled||null===e.yammerNetworkName||void 0===e.yammerNetworkName||null===e.yammerGroupId||void 0===e.yammerGroupId||null===e.yammerOAuthAccessTokenExpired||void 0===e.yammerOAuthAccessTokenExpired||!0===e.yammerOAuthAccessTokenExpired)}(n)&&r.push(this._createYammerButton(e)),r}_checkForDashboardIds(e){const t=!l.a.isNullOrEmpty(e.formId);return{hasActualDashboardId:t,hasPossibleDashboardId:!t&&!l.a.isNullOrEmpty(e.selectedDashboardId)}}_getDashboardId(e){if(!l.a.isNullOrEmpty(e.formId))return e.formId;return!l.a.isNullOrEmpty(e.selectedDashboardId)?e.selectedDashboardId:l.a.EMPTY}_isUnboundDashboard(e,t){const r=t&&Ae(e.dashboardSelectorItems,e.selectedDashboardId);return r?r.iconType!==j.a.InteractiveDashboard:e.dashboardType===Zt.Unbound}_getIsUserDashboard(e,t){const r=t&&Ae(e.dashboardSelectorItems,e.selectedDashboardId);return r?r.categoryId===1031..toString():!e.isServerOffline&&e.isUserDashboard}_createNewDashboardFlyoutButton(e){const t=[];return t.push(this._createNewDynamicsDashboardButton(e)),e().isPowerBiEnabled&&t.push(this._createNewPowerBIDashboard(e)),{Icon:"New",DisplayText:e().ribbonLabels.createNewDashboard,Tooltip:{title:e().ribbonLabels.createNewDashboardTooltip},Id:"CreateNewDashboardFlyout",WillOpenFlyout:!0,Children:t}}_createNewDynamicsDashboardButton(e){return{Icon:"CardsDashboard",DisplayText:e().ribbonLabels.createDynamicsDashboard,Tooltip:{title:e().ribbonLabels.createDynamicsDashboardTooltip},Id:"CreateDynamicsDashboard",execute:Kn(e().id)}}_createNewPowerBIDashboard(e){return{Icon:"OpenInPowerBI",DisplayText:e().ribbonLabels.createPowerBIDashboard,Tooltip:{title:e().ribbonLabels.createPowerBIDashboardToolTip},Id:"CreatePowerBiDashboard",execute:Jr(e().id)}}_createTogglesetDefaultButton(e,t,r){const n=r?e().isUnsetDefaultDashboardFeatureEnabled?"SetDefault":"Pin":"ClearDefault",a=r?e().ribbonLabels.setAsDefault:e().ribbonLabels.unsetDefault,i=r?this._getDashboardId(e()):l.a.EMPTY;return{Icon:n,DisplayText:a,Tooltip:{title:a},Id:"SetDefaultDashboard",execute:{type:"dashboard.setdefault.async",execute:({dispatch:e})=>e(Qt(i)).then(()=>(t(),Promise.resolve()))}}}_createYammerButton(e){return{Icon:"YammerIcon",DisplayText:e().ribbonLabels.yammerLabelInDashboards,Tooltip:{title:e().ribbonLabels.yammerLabelInDashboards},Id:"YammerDashboard",execute:{type:"dashboard.yammer",execute({dispatch:t}){var r,n,a,i;return t((r=e().yammerGroupId,n=e().yammerNetworkName,a=e().yammerPostMethod,i=e().id,{type:"dashboard.yammer",execute({dispatch:e}){let t="",s="";null!=r&&(t=r.toString()),null!=a&&(s=a.toString());const o={param_feedType:"group",param_yammerNetwork:n,param_yammerGroupId:t,param_yammerPostMethod:s};e(Object(Jt.b)("YammerDialog",{height:2e3,width:500,windowPosition:"side"},o,i))}})),Promise.resolve(!0)}}}}_createRefreshButton(e){return{Icon:"Refresh",DisplayText:e().ribbonLabels.refresh,Tooltip:{title:e().ribbonLabels.refresh},Id:"RefreshDashboard",execute:rn(this._getDashboardId(e()),e().id)}}_createEditButton(e){return{Icon:"Edit",DisplayText:e().ribbonLabels.editDashboard,Tooltip:{title:e().ribbonLabels.editDashboard},Id:"EditDashboard",execute:e().isPowerBIDashboard?yr(e().id,this._getDashboardId(e())):Yn(e().id,this._getDashboardId(e()))}}_createDeleteButton(e){return{Icon:"Delete",DisplayText:e().ribbonLabels.deleteDashboard,Tooltip:{title:e().ribbonLabels.deleteDashboard},Id:"DeleteDashboard",execute:mn(this._getDashboardId(e()),e().id)}}_createShareButton(e){return{Icon:"Share",DisplayText:e().ribbonLabels.shareDashboard,Tooltip:{title:e().ribbonLabels.shareDashboard},Id:"ShareDashboard",execute:bn(this._getDashboardId(e()),e().id)}}_createAssignButton(e){return{Icon:"Assign",DisplayText:e().ribbonLabels.assignDashboard,Tooltip:{title:e().ribbonLabels.assignDashboard},Id:"AssignDashboard",execute:On(this._getDashboardId(e()),e().id)}}_createSaveAsButton(e){return{Icon:"SaveAndEdit",DisplayText:e().ribbonLabels.saveAsDashboard,Tooltip:{title:e().ribbonLabels.saveAsDashboard},Id:"SaveAsDashboard",execute:mr(this._getDashboardId(e()),e().id)}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Zn{constructor(){this._isPowerBIDashboard=!1}haveResourceStringsChanged(e){return!this._ribbonLabels||this._ribbonLabels.openInPowerBI!==e.ribbonLabels.openInPowerBI}updateResourceStrings(e){this._ribbonLabels=e.ribbonLabels}needsRefresh(e){return this._isPowerBIDashboard!==e.isPowerBIDashboard||this._isPowerBIDashboard&&!l.a.equals(this._dashboardId,e.formId)}getCommandButtons(e){const t=e();this._isPowerBIDashboard=t.isPowerBIDashboard,this._dashboardId=t.formId;const r=[],n=l.a.isNullOrEmpty(t.formId)&&!l.a.isNullOrEmpty(t.selectedDashboardId)&&Ae(t.dashboardSelectorItems,t.selectedDashboardId);return n&&(this._isPowerBIDashboard=n.iconType===j.a.OpenInPowerBI),!t.isRibbonCustomizable&&this._isPowerBIDashboard&&r.push(this._createOpenInPowerBIButton(e)),r}_createOpenInPowerBIButton(e){return{Icon:"OpenInPowerBI",DisplayText:e().ribbonLabels.openInPowerBI,Tooltip:{title:e().ribbonLabels.openInPowerBI},Id:"OpenInPowerBI",execute:Object(In.a)(e().formId)}}}var $n=r("bUa6"),ea=r("hPFj"),ta=r("e9UD"),ra=r("GYEz"),na=r("Afz2"),aa=r("QJW6"),ia=r("/aHX"),sa=r("zzhk"),oa=r("H4dV"),ca=r("0kGT"),la=r("ah4O"),ua=r("RJiR"),da=r("iWfp"),ha=r("RiHV");function pa({isSingleColumnLayout:e,items:t,selectedId:r,style:n,entityLogicalName:a,pageId:i,onBeforeSwitch:s}){const o=Object(u.c)(),d=Object(u.d)(ca.b),h=Object(u.d)(K.g),p=Object(u.d)(e=>function(e,t){const r=Object(f.e)(e,t.labelList);return Object(f.c)(r,t.DASHBOARD_SELECTOR_TOOLTIP)}(e,N)),g=Object(u.d)(e=>d||Object(G.c)(e,"FCB.AllowSwitchDashboard")),m=Object(u.d)(e=>Object(G.a)(e,U.le,U.h)),b=e=>{if(e===r)return;const n=new l.a(e);let c=lr.a;for(const r of t.options)if(r.value===e){r.categoryId===1031..toString()&&(c=lr.b);break}g?(s&&s(n),o(Hn(i,{dashboardId:n,etn:a,type:c}))):o(Object(ur.a)(null,n,null,a,c,!1,i))};return t&&t.options.length>0&&t.categories?d?c.createElement(ua.c,{pageId:i},c.createElement(ua.k,{items:t.options,selectedItemId:r,onChange:b})):c.createElement(la.a,Object.assign({key:"DashboardSelector",id:"Dashboard_Selector",value:r,title:p,categories:t.categories,options:t.options,style:n.dashboardSelectorStyle,caretType:j.a.ChevronDownMed,caretStyle:e?n.dashboardSelectorCaretStyleMobile:n.dashboardSelectorCaretStyle,textStyle:e?n.dashboardSelectorTextStyleMobile:n.dashboardSelectorTextStyle,viewSelectorStyle:e?n.dashboardSelectorViewSelectorStyleMobile:n.dashboardSelectorViewSelectorStyle,onChange:b,createAccessibilityComponent:da.a,createKeyboardShortcut:da.b,parentCustomControlId:_e,isRTL:h,useHeader:!0},{[ha.a.LearningPathDOMAttributeName]:"Dashboard_Selector"},{useViewSelectorV2:m})):null}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const ga={Id:"Dashboard_DateRangeFilter",DomId:"Dashboard_DateRangeFilter",Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1},ma={FormFactor:2,CustomControlId:"MscrmControls.DateRangeControl.DateRangeFilterControl",Name:name,Version:"1.0.0",ShouldOverrideControlVisible:!1,Parameters:{value:{Type:"DateRange"}}};function ba({children:e}){const t=Object(u.d)(ca.b),r=function(){const e=Object(u.d)(A.a);return{display:"flex",flexDirection:"row",backgroundColor:e.colors.BaseColor.White,paddingTop:e.sizes.Measures.Measure100,paddingBottom:e.sizes.Measures.Measure100,justifyContent:"space-between",width:"auto",minWidth:"0",paddingLeft:e.sizes.Measures.Measure100,paddingRight:e.sizes.Measures.Measure100}}();return t?c.createElement(d.a,{key:"dataRangeFilterContainer",id:"dataRangeFilterContainer",style:r},e):null}function fa({id:e,formId:t,isSingleColumnLayout:r,dashboardCachedColumns:n,dashboardCachedWdith:a,contextToken:i}){const s=Object(u.c)(),o=Object(u.d)(ca.b),l=Object(u.d)(x.c),h=Object(u.d)(t=>Object(p.g)(t,e)),m=Object(u.d)(e=>je(e,t)),f=Object(u.d)(e=>function(e,t){const r=je(e,t),n=Object(b.a)(e,t);if(r&&n){const t=Object(O.a)(e,n,r);if(t&&t.DisplayName)return t.DisplayName}return null}(e,t)),y=Object(u.d)(e=>Ce(e,t)),_=Object(u.d)(e=>Object(G.a)(e,U.Pd,U.h)),v=Object(u.d)(K.g),S=Object.assign({display:"flex",alignItems:"center"},!r&&_&&{[v?"marginLeft":"marginRight"]:"24px"});return Object.assign(ma.Parameters,{DateRangeAttribute:{Type:"SingleLine.Text",Value:m,Usage:1,Static:!0},DateRangeTimeframe:{Type:"SingleLine.Text",Value:h.dateRangeTimeFrame?h.dateRangeTimeFrame:y,Usage:1,Static:!0},CustomTimeFrameStartDate:{Type:"SingleLine.Text",Value:h.dateRangeStartDate,Usage:1,Static:!0},CustomTimeFrameEndDate:{Type:"SingleLine.Text",Value:h.dateRangeEndDate,Usage:1,Static:!0},DisplayName:{Type:"SingleLine.Text",Value:f,Usage:1,Static:!0},DashboardColumns:{Type:"Whole.None",Value:r?1:n,Usage:1,Static:!0},DashboardWidth:{Type:"Whole.None",Value:a||l,Usage:1,Static:!0},NotifyOutputOnInitialRender:{Type:"Enum",Value:"no",Usage:1,Static:!0},DateRangeOutput:{Type:"SingleLine.Text",Primary:!0,Static:!1,Usage:2},TimeFrameOutput:{Type:"SingleLine.Text",Primary:!0,Static:!1,Usage:2}}),o&&(delete ma.Parameters.DashboardWidth,delete ma.Parameters.DashboardColumns),c.createElement(d.a,{key:"Dashboard_DateRangeFilterWrapper",style:S},c.createElement(g.c,{key:"Dashboard_DateRangeFilter",controlId:"Dashboard_DateRangeFilter",id:e,configuration:ma,descriptor:ga,parentDefinedControlProps:ya(t=>{const r=t&&t.timeFrame,n=t&&t.filter,a=function(e){if(e&&e.length>=2){const t=27===e[0].conditionOperator?0:1;return e[t]&&e[t].value}}(n),i=function(e){if(e&&e.length>=2){const t=26===e[0].conditionOperator?0:1;return e[t]&&e[t].value}}(n),o=Object.assign(Object.assign({},h),{dateRangeTimeFrame:r,dateRangeStartDate:a,dateRangeEndDate:i});s(Object($t.b)(o,e))}),parentContextToken:i}))}function ya(e){return{eventListeners:[{eventname:"onFilterChanged",eventhandler:[e]}]}}var _a=r("DPfD");var va=r("2jAf");function Sa(e,t){return{type:"dashboard.retrieveEntityMetadataForDashboardControlsWithErrorEntityMetadata",execute:({getState:r,dispatch:n})=>{const a=function(e,t,r){const n=[];return we(e,t,r,t=>{if(-1===n.indexOf(t)){const r=Object(I.h)(e,t);(null==r?void 0:r.Initialized)===C.a.Error&&n.push(t)}}),n}(r(),e,t);if(a.length>0){const e={},t={entities:{}};for(const r of a)e[r]=[],t.entities[r]={Initialized:C.a.Uninitialized};n(Object(va.d)(t)),n(Object(tr.e)(e))}return Promise.resolve()}}}var Oa=r("AVDU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Ia={width:0,height:0,columns:-1,deviceWidth:0,deviceHeight:0};class Ca extends c.Component{constructor(e){super(e),this._CCF_descriptor={Id:"",Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1,Parameters:{Dashboard:"",Width:Ia.width,Height:Ia.height,Columns:Ia.columns,StringIds:fr,StreamRecordsPerPage:25,CreateDashboardLayoutBuilder:Vr.create,ToggleGlobalFilterFlyout:!1,CreateStreamControl:z.makeCreate}},this._dashboardCommands=new Jn,this._boundDashboardCommands=new nr,this._powerBIDashboardCommands=new Zn,this._hadAnyDashboardIdForCommandBar=!1,this._onScroll=this._onScroll.bind(this),this.onMeasuring=this.onMeasuring.bind(this),this._resetForDashboardSwitch=this._resetForDashboardSwitch.bind(this),this.state=this._getDefaultState()}_getDefaultState(){return{columns:Ia.columns,allControlsRendered:!1,width:Ia.width,height:Ia.height,hideProgressIndicator:-1!==Ia.columns}}_getDashboardIdForHeaderComponents(e){return e||(e=this.props),!l.a.isNullOrEmpty(this.state.nextDashboardId)&&this.state.nextDashboardId||!l.a.isNullOrEmpty(e.formId)&&e.formId||e.selectedDashboardId}_hasNextDashboardId(){return!l.a.isNullOrEmpty(this.state.nextDashboardId)&&!l.a.equals(this.state.nextDashboardId,this.props.formId)}_resetForDashboardSwitch(e){Object.assign(this._CCF_descriptor.Parameters,{ScrollTop:0,ToggleGlobalFilterFlyout:void 0,ShowVisualFilters:!1,TileView:!1}),this.setState(Object.assign(this._getDefaultState(),{scrollTop:0,ToggleGlobalFilterFlyout:!1,ShowVisualFilters:!1,TileView:!1,nextDashboardId:e}))}get _controlId(){return this.props.isBoundDashboardControlSupported&&this.props.dashboardType&Zt.Bound?ve:_e}componentWillReceiveProps(e){this._hasNextDashboardId()&&!l.a.equals(this.props.formId,e.formId)?this.setState({nextDashboardId:null}):(!Object(E.a)(this._currentPageId)&&this._currentPageId!==this.props.id&&this.state.allControlsRendered&&this.setState({allControlsRendered:!1}),(this._currentPageId===this.props.id&&this.props.dashboardType&Zt.Bound&&ja(this.props.refreshCounters,e.refreshCounters,!0)||this.props.id!==e.id&&l.a.equals(this.props.formId,e.formId))&&this.props.refreshDashboard(this.props.formId));let t=!!(e.dashboardType&Zt.Bound);if(!t){const r=this._getSelectedDashboardSelectorOption(e);t=r&&r.iconType===j.a.InteractiveDashboard}this.props.isServerOffline&&!e.isServerOffline?(e.retrieveUserDashboardPrivileges(),e.retrieveErroredEntityMetadata(e.formId),t&&2===e.dashboardLoadStatus&&e.switchDashboard(e.dashboardInput)):!this.props.isServerOffline&&e.isServerOffline&&t&&5===e.dashboardLoadStatus&&e.setDashboardOfflineError()}render(){const e=this._renderDashboardAccessibilityComponent("DashboardView"),t=oa.a.getInstance().get_IsBrowserIE()?"":na.r;if(this._isErrorPage=null!==this.props.dashboardLoadStatus&&void 0!==this.props.dashboardLoadStatus&&5!==this.props.dashboardLoadStatus,this._isErrorPage){const t=this._isErrorPage?this.props.dashboardErrorMessage||c.createElement($n.a,null):null,r={fontSize:"4.5em",color:"red"};return c.createElement(d.a,{key:"dashboardRootError",id:"DashboardView",isRequestedMeasuring:!0,onMeasuring:this.onMeasuring,style:this.props.dashboardViewStyle.dashboardErrorStyle},this._renderPageHeaderButtons(),this._isErrorPage&&this.props.dashboardErrorMessage?c.createElement(ea.a,{id:"dashboardErrorContainer"+this.props.id,text:t,icon:j.a.DetailsPageClose,iconStyle:r}):t,e)}const r=l.a.isNullOrEmpty(this.props.formId)||this._hasNextDashboardId();r||(this._CCF_config=Object(m.y)(this._controlId),this._setOutputLinking(),this._setForbiddenControls(),this.props.dashboardType&Zt.Bound&&this._setAppliedFilterInput(),this._setAdditionalDescriptorParameters());const n=aa.a.getInstance().getDisableScrollStyle()||!this._isEdge()?"forceNewStackContextInert":"forceNewStackContext";return c.createElement(d.a,{key:"dashboardRoot",id:"DashboardView",testhooks:{id:"DashboardView"},isRequestedMeasuring:!0,onMeasuring:this.onMeasuring,style:this._getDashboardViewStyle(),explicitStyles:n},this._renderPageHeaderButtons(),c.createElement(h.a,{id:"DashboardScrollView",style:this.props.dashboardViewStyle.dashboardScrollViewStyle,role:t,onScroll:this._onScroll},this.props.isInMobileModeForOct2019&&c.createElement(ua.b,{id:"DashboardScrollView"}),!r&&this.state.hideProgressIndicator?this._renderDashboardControl():this._renderProgressIndicator(),e))}_isEdge(){return oa.a.getInstance().get_IsBrowserEdge()}_renderProgressIndicator(){return c.createElement(d.a,{key:"dashboardProgressIndicatorContainer",id:"dashboardProgressIndicatorContainer",style:this.props.dashboardProgressIndicatorStyle.progressIndicatorContainerStyleInternal},c.createElement(ta.a,{key:"dashboard-progress-indicator",id:"dashboard-progress-indicator",testhooks:{id:"dashboard-progress-indicator"},style:this.props.dashboardProgressIndicatorStyle.dashboardProgressIndicatorStyle,progressType:"ring",displayDelay:2e3,active:!0}))}_renderDashboardAccessibilityComponent(e){const t=e+"Accessibility",r=[];return this.props?r.push(c.createElement(Nt.a,{key:t,rootElementId:e,isModal:!1,shouldManageFocus:!0,defaultFocusId:"Dashboard_Selector"})):r.push(c.createElement(Nt.a,{key:t,rootElementId:e,isModal:!1,shouldManageFocus:!0})),r}_getDashboardViewStyle(){return this.props.dashboardViewStyle.dashboardViewStyle}_renderDashboardControl(){const e=this._controlId;this._CCF_descriptor.Id=e,this._CCF_descriptor.Parameters.Dashboard=e;const t=c.createElement(g.c,{key:e,controlId:_e,id:this.props.id,configuration:this._CCF_config,descriptor:this._CCF_descriptor,parentContextToken:this.props.contextToken,parentDefinedControlProps:this._getParentDefinedProps(),themingData:this._getThemingData()});return this.props.dashboardType&Zt.Bound||this.props.isPowerBIDashboard?c.createElement(c.Fragment,null,c.createElement(ba,null,this._renderDateRangeControl()),c.createElement(d.a,{key:"boundDashboardRoot",id:"BoundDashboardView",style:this.props.dashboardViewStyle.boundDashboardViewStyle},t)):t}_getThemingData(){return this._themingData&&this._themingData.defaultThemingData.cellHeightInRem===this.props.theme.sizes.Section.cellHeightInRem||(this._themingData={defaultThemingData:{cellHeightInRem:this.props.theme.sizes.Section.cellHeightInRem}}),this._themingData}_getParentDefinedProps(){return this._parentDefinedProps||(this._parentDefinedProps={eventListeners:[{eventname:"globalfilterclose",eventhandler:[this._closeGlobalFlyout.bind(this)]},{eventname:"allControlsRendered",eventhandler:[this._allControlsRendered.bind(this)]},{eventname:"filtersApplied",eventhandler:[this._filtersApplied.bind(this)]},{eventname:"savedFilterDelete",eventhandler:[this._deleteSavedFilter.bind(this)]},{eventname:"defaultSavedFilterUpdate",eventhandler:[this._updateDefaultSavedFilter.bind(this)]},{eventname:"onFilterSaved",eventhandler:[this._onFilterSaved.bind(this)]},{eventname:"parametersUpdated",eventhandler:[this._parametersUpdated.bind(this)]}]}),this._parentDefinedProps}_filtersApplied(e){this.props.setDashboardAppliedFilterAndLinkingInput(this.props.dashboardInput,e.appliedFilters,e.linkingInput)}_deleteSavedFilter(e){this.props.savedFilterDelete(e)}_updateDefaultSavedFilter(e){this.props.defaultSavedFilterUpdate(e)}_onFilterSaved(e){this.props.filterSaved(e)}_parametersUpdated(e){this.props.setUpdatedControlParameters(e)}_closeGlobalFlyout(){this._setCommandBarNeedsRefresh(),this._CCF_descriptor.Parameters.ToggleGlobalFilterFlyout=void 0,this.setState({ToggleGlobalFilterFlyout:!1})}_setOutputLinking(){this._CCF_config.Parameters.DateRangeCondition={Type:"SingleLine.Text",Primary:!0,ControlLinked:!0,Static:!1,Usage:1,Value:"Dashboard_DateRangeFilter.DateRangeOutput"};this._CCF_config.Parameters.DateRangeTimeFrame={Type:"SingleLine.Text",Primary:!0,ControlLinked:!0,Static:!1,Usage:1,Value:"Dashboard_DateRangeFilter.TimeFrameOutput"}}_setForbiddenControls(){this._CCF_config.Parameters.ForbiddenControlIdList={Type:"SingleLine.Text",Primary:!0,ControlLinked:!1,Static:!0,Usage:1,Value:JSON.stringify(this.props.forbiddenUCIControls)}}_setAppliedFilterInput(){const e={};e.appliedFilters=this.props.dashboardInput&&this.props.dashboardInput.appliedFilter,e.linkingInput=this.props.dashboardInput&&this.props.dashboardInput.linkingInput,this._CCF_config.Parameters.AppliedFilter={Type:"SingleLine.Text",Primary:!0,ControlLinked:!1,Static:!0,Usage:1,Value:JSON.stringify(e)}}_setAdditionalDescriptorParameters(){this._CCF_descriptor.Parameters.RefreshCounters=this.props.refreshCounters,this._CCF_descriptor.Parameters.DataSetColumns=this.props.dataSetColumns}_getColumns(e){let t=Ur(this.props.theme,e);return 1===t&&this.props.dashboardType&Zt.Bound&&!this._isSingleColumnLayout()&&(t=2),t}_allControlsRendered(e){const t=!!e.allControlsRendered;this.state.allControlsRendered!==t&&(t&&(this._CCF_descriptor.Parameters.ScrollTop=0),this.setState({allControlsRendered:t}))}_onScroll(e){const t=e.target;this.state.allControlsRendered||this.props.dashboardType&Zt.Bound||!t||"DashboardScrollView"!==t.id||!Object(E.a)(this._handleOnScroll)||(this._handleOnScroll=setTimeout(()=>{this._handleOnScroll=void 0;const e=t.scrollTop;Object(E.a)(e)||e===this.state.scrollTop||(this._CCF_descriptor.Parameters.ScrollTop=e,this.setState({scrollTop:e}))},200))}onMeasuring(e,t){const r=document.getElementById("DashboardScrollView");let n=0;Object(E.a)(r)||(n=r.offsetWidth-r.clientWidth),e=Math.floor(e)-n,t=Math.floor(t);const a=!(Ia.width!==e||this.props.dashboardType&Zt.Bound&&Ia.height!==t);if(Ia.width=e,Ia.height=t,a)return;let i=!1;const s={},o=this._getColumns(e);Ia.columns=o,s.hideProgressIndicator=!0,o!==this.state.columns&&(this._CCF_descriptor.Parameters.Columns=o,s.columns=o,i=!0),e!==this.state.width&&(this._CCF_descriptor.Parameters.Width=e,s.width=e,i=!0),t!==this.state.height&&(this._CCF_descriptor.Parameters.Height=t,s.height=t,this.props.dashboardType&Zt.Bound&&(i=!0)),i&&this.setState(s)}_renderConsoleAppBackButton(e){if(!this.props.shouldRenderBackButton)return null;let t={height:"3rem",borderWidth:"0 1px 0 0"};return e&&(t=Object.assign(Object.assign({},t),{borderWidth:0,backgroundColor:"transparent"})),c.createElement(ia.a,{pageId:this.props.id,overwriteStyle:t})}_renderCommandBar(){if(this._initializeCommandBar(),this.props.isInMobileModeForOct2019)return c.createElement(Ge.a,{commandbarDisplayMode:Ue.a.IconLabel,key:"DashboardCommandBar",addedCommandList:this._addedCommandList,iconPosition:Xe.a.Left,id:this.props.id,ribbonId:this.props.isRibbonCustomizable?"Dashboard:null":null,commandManagerId:this.props.id,isDashboardCommandBar:!0});const e=this._isSingleColumnLayout(),t=e?16:this.state.width,r=this.props.dashboardCommandBarStyle,n=e?r.dashboardCommandBarMobileStyle:r.dashboardCommandBarStyle,a=e?r.commandBarWrapperMobileStyle:r.commandBarWrapperStyle;return Object(Ue.b)(this.props.commandBarRefreshProps,n,this._isSingleColumnLayout()),c.createElement(d.a,{id:"DashboardGlobalFilterAnchor",key:"DashboardGlobalFilterAnchor",style:a},this._isSingleColumnLayout()?null:this._renderConsoleAppBackButton(!1),c.createElement(Ge.a,{commandbarDisplayMode:Ue.a.IconLabel,key:"DashboardCommandBar",addedCommandList:this._addedCommandList,iconPosition:Xe.a.Left,id:this.props.id,width:t,ribbonId:this.props.isRibbonCustomizable?"Dashboard:null":null,commandManagerId:this.props.id,commandBarStyle:n,customCommandManagerStyle:r.customCommandManagerStyle,isDashboardCommandBar:!0}))}_haveResourceStringsForCommandBarChanged(){return!!(this._dashboardCommands.haveResourceStringsChanged(this.props)||this._boundDashboardCommands.haveResourceStringsChanged(this.props)||this._powerBIDashboardCommands.haveResourceStringsChanged(this.props))&&(this._dashboardCommands.updateResourceStrings(this.props),this._boundDashboardCommands.updateResourceStrings(this.props),this._powerBIDashboardCommands.updateResourceStrings(this.props),!0)}_initializeCommandBar(){const e=!l.a.isNullOrEmpty(this._getDashboardIdForHeaderComponents());if((this._haveResourceStringsForCommandBarChanged()||this._currentPageId!==this.props.id||this._hadAnyDashboardIdForCommandBar!==e)&&(this._currentPageId=this.props.id,this._hadAnyDashboardIdForCommandBar=e,this._commandBarNeedsRefresh=!0,this._boundDashboardCommands.resetCommands(this.props,this._CCF_descriptor.Parameters,this.state,this._setCommandBarNeedsRefresh.bind(this))),!this._addedCommandList||this._commandBarNeedsRefresh||this._dashboardCommands.needsRefresh(this.props)||this._boundDashboardCommands.needsRefresh(this.props)||this._powerBIDashboardCommands.needsRefresh(this.props)){this._commandBarNeedsRefresh=!1,this._addedCommandList=[];const e=this._boundDashboardCommands.getCommandButtons(()=>this.props,this._CCF_descriptor.Parameters,()=>this.state,this.setState.bind(this),this._setCommandBarNeedsRefresh.bind(this),this._isSingleColumnLayout());this._addedCommandList.push(...e);const t=this._dashboardCommands.getCommandButtons(()=>this.props,this._setCommandBarNeedsRefresh.bind(this));this._addedCommandList.push(...t);const r=this._powerBIDashboardCommands.getCommandButtons(()=>this.props);this._addedCommandList.push(...r)}}_setCommandBarNeedsRefresh(){this._commandBarNeedsRefresh=!0}_renderSelectorRow(){if(this._isErrorPage&&(!this.props.dashboardSelectorItems||0===Object.keys(this.props.dashboardSelectorItems).length))return null;let e;const t=this._getSelectedDashboardSelectorOption();if(t&&(this._memoizedViewSelectorText&&this._memoizedViewSelectorText!==t.text&&(this._wrapViewSelector=!this._wrapViewSelector),this._memoizedViewSelectorText=t.text,e=c.createElement(pa,{style:this.props.dashboardSelectorStyle,isSingleColumnLayout:this._isSingleColumnLayout(),items:this.props.dashboardSelectorItems,selectedId:l.a.toString(this._getDashboardIdForHeaderComponents())||l.a.EMPTYSTRING,entityLogicalName:this.props.entityLogicalName,pageId:this.props.id,onBeforeSwitch:this._resetForDashboardSwitch})),this.props.isInMobileModeForOct2019)return e;this._wrapViewSelector&&(e=c.createElement(d.a,null,e));const r=[e];if(!this.props.isSuiterDashboard){const e=this._renderSelectorImage(t);r.unshift(e)}const n=[c.createElement(d.a,{key:"DashboardSelector",style:{display:"flex",flexDirection:"row",flex:"1 1 auto",minWidth:this._isSingleColumnLayout()?"0":void 0}},r)];return!this._isErrorPage&&this.props.dashboardType&Zt.Bound&&n.push(this._renderDateRangeControl()),c.createElement(d.a,{key:"selectorRow",style:this._isSingleColumnLayout()?this.props.dashboardSelectorStyle.dashboardSelectorRowStyleMobile:this.props.dashboardSelectorStyle.dashboardSelectorRowStyle},n)}_getSelectedDashboardSelectorOption(e){return Ae((e||this.props).dashboardSelectorItems,this._getDashboardIdForHeaderComponents(e))}_renderDateRangeControl(){return c.createElement(fa,{id:this.props.id,formId:this.props.formId,isSingleColumnLayout:this._isSingleColumnLayout(),dashboardCachedColumns:this.state.columns,dashboardCachedWdith:this.state.width,contextToken:this.props.contextToken})}_renderSelectorImage(e){let t=null;return e&&(t=e.iconType===P.a.Dashboard?c.createElement(At.a,{type:e.iconType}):c.createElement(Xe.b,{type:e.iconType})),c.createElement(d.a,{key:"selectorImage",role:"img",accessibilityLabel:this.props.dashboardHeaderIcon,style:this._isSingleColumnLayout()?this.props.dashboardSelectorStyle.dashboardSelectorImageStyleMobile:this.props.dashboardSelectorStyle.dashboardSelectorImageStyle},t)}_isSingleColumnLayout(){if(this.props.dashboardType&Zt.Bound)return this.props.deviceWidth<this.props.theme.sizes.Breakpoints.DimensionS||this.state.width&&this.state.width<this.props.theme.sizes.Breakpoints.DimensionS;return 1===this._getColumns(this.props.deviceWidth)||1===this.state.columns}_renderPageHeaderButtons(){if(!this._isErrorPage&&Object(b.i)(this._getDashboardIdForHeaderComponents()))return null;let e=[this._renderCommandBar(),this._renderSelectorRow()],t=this.props.dashboardViewStyle.dashboardHeaderStyle;return this._isSingleColumnLayout()&&(t=this.props.dashboardViewStyle.dashboardHeaderMobileStyle,e=e.reverse(),e.unshift(this._renderConsoleAppBackButton(!0))),this.props.isInMobileModeForOct2019?c.createElement(c.Fragment,null,e):c.createElement(d.a,{key:"headerButtonsWrapper"},c.createElement(d.a,{key:"headerButtons",style:t},e))}}function ja(e,t,r=!1){const n=Object.keys(t).length;if(n!==Object.keys(e).length)return!0;let a=0;for(const n in t)if(!e[n]&&0!==e[n]||e[n]!==t[n]){if(!r)return!0;a++}return!!r&&(0!==a&&a!==n)}Ca.displayName="DashboardRoot";const Pa=Object(u.a)(function(){let e,t,r,o,c,u,d,h,g,m,_,S,O,I;const C=function(){let e=null;return function(t,r,n,a){if(!e){const i=Ft(n),s=(e,t,r,n)=>({base:i(e,r),mobile:i(Object.assign(Object.assign({},e),t),Object.assign(Object.assign({},r),n))}),o=Object(wt.b)(a)?Object(wt.a)(a):null,c="#323130",l=i({backgroundColor:t.colors.BaseColor.White},{backgroundColor:void 0}),{base:u,mobile:d}=s({display:"flex",flexDirection:"row",backgroundColor:t.colors.BaseColor.White,paddingTop:t.sizes.Measures.Measure125,paddingBottom:t.sizes.Measures.Measure125,justifyContent:"space-between",width:"100%"},{paddingTop:t.sizes.Measures.Measure100,paddingBottom:t.sizes.Measures.Measure100,minWidth:"0"},{backgroundColor:void 0,paddingTop:"16px",paddingBottom:"16px",height:"24px"}),{base:h,mobile:p}=s({maxWidth:t.sizes.Measures.Measure300,width:"100%",height:t.sizes.Measures.Measure300,borderRadius:"50%",backgroundColor:"#3b79b7",justifyContent:"center",alignItems:"center",fontSize:"16px",color:t.colors.BaseColor.White,alignSelf:"center",marginRight:t.sizes.Measures.Measure100,marginLeft:t.sizes.Measures.Measure150},{maxWidth:t.sizes.Measures.Measure200,height:t.sizes.Measures.Measure200,marginRight:t.sizes.Measures.Measure050,marginLeft:t.sizes.Measures.Measure050}),{base:g,mobile:m}=s({whiteSpace:"nowrap",minWidth:"0",fontFamily:t.fontFamilies.Semilight,color:t.colors.BaseColor.Grey.Grey7,fontWeight:"normal",fontSize:t.fontSizes.Font200},{fontWeight:void 0,fontSize:t.fontSizes.Font150},{fontFamily:t.fontFamilies.Semibold,color:o?o.Components.Dashboard.ViewSelector.TextColor:c,backgroundColor:o?o.Components.Dashboard.ViewSelector.ChevronBackgroundColor:void 0,fontSize:"20px",lineHeight:"37px",cursor:"pointer",marginBottom:"-8px",marginTop:"-8px"}),{base:b,mobile:f}=s({fontSize:"16px",display:"flex",flexDirection:"column",justifyContent:"center",minWidth:"16px",marginLeft:t.sizes.Measures.Measure125,marginRight:t.sizes.Measures.Measure150},{marginLeft:t.sizes.Measures.Measure100,marginRight:void 0},{fontSize:"12px",color:o?o.Components.Dashboard.ViewSelector.ChevronColor:c,fontWeight:"bold",lineHeight:"24px",maxHeight:"16px",marginTop:"8px",marginBottom:"10px",marginLeft:r?"-5px":"8px",marginRight:r?"8px":"-5px",justifyContent:void 0}),{base:y,mobile:_}=s({cursor:"pointer",minWidth:"0",maxWidth:"calc( 7 * "+t.sizes.Measures.Measure500+" )",width:"auto",height:"100%"},{maxWidth:"100%",height:void 0,[r?"paddingLeft":"paddingRight"]:t.sizes.Measures.Measure050},{cursor:"default",marginTop:"-8px",marginBottom:"-8px",paddingTop:"8px",paddingBottom:"8px",[r?"marginRight":"marginLeft"]:"12px"},{[r?"marginRight":"marginLeft"]:void 0});e={dashboardSelectorStyle:l,dashboardSelectorRowStyle:u,dashboardSelectorRowStyleMobile:d,dashboardSelectorImageStyle:h,dashboardSelectorImageStyleMobile:p,dashboardSelectorTextStyle:g,dashboardSelectorTextStyleMobile:m,dashboardSelectorCaretStyle:b,dashboardSelectorCaretStyleMobile:f,dashboardSelectorViewSelectorStyle:y,dashboardSelectorViewSelectorStyleMobile:_}}return e}}(),j=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e=null;return function(t,r,n,a){if(!e){const i=Object(Ue.p)(r,null);i.container.marginLeft="0px",i.container.marginRight="0px",i.container.width="100%",i.container.backgroundColor=t.colors.MainThemeColor.MainColor1.Fill,i.listItemBody.text.color=Et.a.colors.MainThemeColor.MainColor1.Text,i.listItemBody.icon.color=Et.a.colors.MainThemeColor.MainColor1.Text,i.listItemBody.icon.fontSize="16px",i.listItemBody.iconWrapperStyles.color=Et.a.colors.MainThemeColor.MainColor1.Text,i.moreIcon.color=Et.a.colors.MainThemeColor.MainColor1.Text,i.splitbuttonicon.color=Et.a.colors.MainThemeColor.MainColor1.Text;const s={":hover":{backgroundColor:t.colors.MainThemeColor.MainColor3.Fill}},o={"[aria-expanded=true]":{backgroundColor:t.colors.MainThemeColor.MainColor3.Fill},"[data-expanded=true]":{backgroundColor:t.colors.MainThemeColor.MainColor3.Fill}};i.listItem=Object.assign(Object.assign({},i.listItem),o),i.splitbuttonOverflowButton=Object.assign(Object.assign({},i.splitbuttonOverflowButton),o),i.listItemBody.button=Object.assign(Object.assign({},i.listItemBody.button),s),i.overflowFlyoutMoreButton=Object.assign(Object.assign({},i.overflowFlyoutMoreButton),s),i.listItemBody.splitButtonChevronIconWrapper.borderLeftColor=r?void 0:t.colors.MainThemeColor.MainColor1.Text,i.listItemBody.splitButtonChevronIconWrapper.borderRightColor=r?t.colors.MainThemeColor.MainColor1.Text:void 0;const c=Object(Ue.p)(r,null);c.container.marginLeft="0px",c.container.marginRight="0px",c.container.width="100%",c.container.backgroundColor=a?void 0:t.colors.BaseColor.White,c.listItemBody.text.color=Et.a.colors.BaseColor.Grey.Grey7,c.listItemBody.icon.color=Et.a.colors.BaseColor.Grey.Grey7,c.listItemBody.icon.fontSize="16px",c.listItemBody.iconWrapperStyles.color=Et.a.colors.BaseColor.Grey.Grey7,c.moreIcon.color=Et.a.colors.BaseColor.Grey.Grey7,c.splitbuttonicon.color=Et.a.colors.BaseColor.Grey.Grey7,c.container.height=xt(t.sizes.Measures.Measure200),c.listItemBody.button=Object.assign(Object.assign({},i.listItemBody.button),{":hover":{backgroundColor:Et.a.colors.BaseColor.White}}),c.list.marginTop="0rem",c.list.marginBottom="0rem",c.listItem.height="100%",c.listItem.display="flex",c.listItem.alignItems="center",c.listItemBody.button.width="16px",c.moreIcon.marginRight="0rem",c.moreIcon.marginLeft="0rem",c.container.borderStyle="none",c.list.marginLeft="0rem",c.list.marginRight="0rem",c.listItem.marginLeft=0,c.container.height=xt(t.sizes.Measures.Measure200);const l={minHeight:t.sizes.Measures.Measure300,backgroundColor:t.colors.MainThemeColor.MainColor1.Fill,display:"flex"};if(n){const e=Object(Ue.m)(null),t=`${e.border.width} ${e.border.style} ${e.colors.border} !important`,r=xt(l.minHeight)+parseInt(e.border.width,10)+"px";Object.assign(l,{backgroundColor:e.colors.background,borderBottom:t,minHeight:r,maxHeight:r,boxSizing:"border-box"})}const u=Ft(a)({minHeight:t.sizes.Measures.Measure200,display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:r?t.sizes.Measures.Measure150:t.sizes.Measures.Measure100,paddingRight:r?t.sizes.Measures.Measure100:t.sizes.Measures.Measure150,paddingBottom:t.sizes.Measures.Measure100,paddingTop:t.sizes.Measures.Measure100},{paddingTop:"16px",paddingBottom:"16px",minHeight:"24px",maxHeight:"24px"});e={dashboardCommandBarStyle:i,dashboardCommandBarMobileStyle:c,customCommandManagerStyle:{width:"100%"},commandBarWrapperStyle:l,commandBarWrapperMobileStyle:u}}return e}}(),P=function(){let e=null;return function(t,r,n){if(!e){const a="#FAF9F8",i=n?a:t.colors.BaseColor.Grey.Grey1,s={dashboardErrorStyle:{display:"flex",flexDirection:"column",flex:"0 0 auto",backgroundColor:i,width:"100%",height:"100%"},dashboardViewStyle:{display:"flex",flexDirection:"column",backgroundColor:i,width:"100%",height:"100%"},dashboardScrollViewStyle:{height:"100%",overflow:"auto",backgroundColor:i,paddingTop:"1px",marginTop:"-1px",flex:"1 1 0px"},boundDashboardViewStyle:{display:"flex",flex:"1"},dashboardHeaderStyle:{display:"flex",flex:"1 0 auto",flexDirection:"column",justifyContent:"space-between"},dashboardHeaderMobileStyle:{display:"flex",flex:"1 0 auto",backgroundColor:n?a:t.colors.BaseColor.White,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},tabBackButtonStyle:{height:"43px",borderWidth:r?"0 0 1px 1px":"0 1px 1px 0"}};e=s}return e}}(),E=Ne(),w=function(){let e=null;return function(t,r){if(!e){const t={progressIndicatorContainerStyleFull:{flex:"1",display:"flex",alignItems:"center",position:"relative"},progressIndicatorContainerStyleInternal:{display:"flex",flexDirection:"row-reverse",alignItems:"flex-end",height:Object(x.b)(r)/2,width:Object(x.c)(r)/2},progressIndicatorStyle:{width:"100%",height:"100%",alignContent:"center",display:"flex",position:"relative",flexDirection:"column",justifyContent:"center"},dashboardProgressIndicatorStyle:{width:"50px",height:"50px"}};e=t}return e}}(),N=function(){let e,t={},r={};return(n,a,i)=>{l.a.equals(e,i)||(e=i,r={});let s=!1;const o=Object(y.j)(n,i),c=Pe(()=>n,a,i,!0),u={};for(const e in c){const t=c[e];if(!$(t))continue;const{entityLogicalName:i,viewId:d}=t,h=Object(W.c)(n,l.a.tryParseOrNull(d));let p=null,g=null;if(ee(n,t,h,i)){g=[],p=Object(J.d)(n,a,o,t,h,i);for(const e of p){const t={Alias:e,Name:e};g.push(t)}}u[e]=g,s||r.hasOwnProperty(e)&&(null!==r[e]||null===p)&&(null===r[e]||null!==p&&r[e].length===p.length&&!r[e].some(e=>-1===p.indexOf(e)))||(s=!0),r[e]=p}return s&&(t=u),t}}(),M=Object(Ue.s)(),R=function(){const e=[1,2],t=[{accessRight:de.a.WriteAccess,privilege:3},{accessRight:de.a.DeleteAccess,privilege:4},{accessRight:de.a.AssignAccess,privilege:5},{accessRight:de.a.ShareAccess,privilege:6}];let r;return(n,a)=>{const i={};let s=!1;for(const t of e)o(t,!1);for(const e of t)o(e,!0);return s&&(r=i),r;function o(e,t){const o=e,c=t?o.privilege:e;let l=Object(D.g)(n,ce.c,c,0);if(l&&t){const e=o.accessRight;l=Object(D.h)(n,ce.c,a,e)}i[c]=l,r&&r[c]===l||(s=!0)}}}();return(y,D)=>{var L,X;let z=Object(V.b)(y,D.id);const q=Object(p.g)(y,D.id),H=!Object(oe.b)(y),W=Object(ra.a)(y),Y=function(e){const t=Object(k.x)(e);return t&&null!==t.yammerNetworkName&&void 0!==t.yammerNetworkName&&t.yammerNetworkName?t.yammerNetworkName:null}(y),Q=function(e){const t=Object(k.x)(e);return t&&null!==t.yammerGroupId&&void 0!==t.yammerGroupId?t.yammerGroupId:null}(y),J=function(e){const t=Object(k.x)(e);return t&&null!==t.yammerOAuthAccessTokenExpired&&void 0!==t.yammerOAuthAccessTokenExpired?t.yammerOAuthAccessTokenExpired:null}(y),Z=function(e){const t=Object(k.x)(e);return t&&null!==t.yammerPostMethod&&void 0!==t.yammerPostMethod?t.yammerPostMethod:null}(y),$=Object(G.b)(y,"YammerPostsOnUCI"),ee=function(e){return Object(ra.a)(e)!==Kt.a.MobileApplication&&!function(e){const t=Object(_a.a)(e);return!(!t||!t.MAIL_CONTEXT)}(e)&&Object(oe.b)(e)&&Object(k.c)(e)&&Object(G.c)(e,U.f)&&Object(G.c)(e,U.Nb)}(y),te=q.dashboardId,re=q.etn,ne=Object(Oa.d)(y);z||te||!re||(z=Object(b.e)(y,re));const ae=Object(K.w)(y),ie=ae&&ae.usePathBasedUrls,se=ae&&ae.defaultDashboardId;let ce=Object(b.a)(y,z);const de=!!ce,he=de&&Object(F.e)(y,ve),ge=he&&he.ConstructorName===ve,me=de&&Oe(y,z),be=function(e,t){const r=Object(f.e)(e,t.globalFilterLabelList);return{expand:Object(f.c)(r,t.GLOBAL_FILTER_OPEN_FILTER_PANEL),collapse:Object(f.c)(r,t.GLOBAL_FILTER_CLOSE_FILTER_PANEL_BUTTON)}}(y,n);S&&S.expand===be.expand&&S.collapse===be.collapse||(S=be);const fe=function(e,t){const r=Object(f.e)(e,t.visualFilterLabelList);return{expand:Object(f.c)(r,t.VISUAL_FILTER_EXPAND),collapse:Object(f.c)(r,t.VISUAL_FILTER_COLLAPSE)}}(y,a);O&&O.expand===fe.expand&&O.collapse===fe.collapse||(O=fe);const ye=function(e,t){const r=Object(f.e)(e,t.streamTileSwitcherLabelList);return{switchToTileView:Object(f.c)(r,t.SWITCH_TO_TILE_VIEW),switchToStreamView:Object(f.c)(r,t.SWITCH_TO_STREAM_VIEW)}}(y,i);I&&I.switchToTileView===ye.switchToTileView&&I.switchToStreamView===ye.switchToStreamView||(I=ye);const _e=function(e,t){const r=Object(f.e)(e,t.dashboardRibbonLabelList);return{refresh:Object(f.c)(r,t.REFRESH),yammerLabelInDashboards:Object(f.c)(r,t.YAMMER_LABEL_IN_DASHBOARDS),setAsDefault:Object(f.c)(r,t.SET_AS_DEFAULT),unsetDefault:Object(f.c)(r,t.UNSET_DEFAULT),openInPowerBI:Object(f.c)(r,t.OPEN_IN_POWERBI),openEntityGrid:Object(f.c)(r,t.OPEN_ENTITY_GRID_LABEL),editDashboard:Object(f.c)(r,t.EDIT_DASHBOARD),deleteDashboard:Object(f.c)(r,t.DELETE_DASHBOARD),shareDashboard:Object(f.c)(r,t.SHARE_DASHBOARD),assignDashboard:Object(f.c)(r,t.ASSIGN_DASHBOARD),createNewDashboard:Object(f.c)(r,t.CREATE_NEW_DASHBOARD),createNewDashboardTooltip:Object(f.c)(r,t.CREATE_NEW_DASHBOARD_TOOLTIP),createDynamicsDashboard:Object(f.c)(r,t.CREATE_DYNAMICS_DASHBOARD),createDynamicsDashboardTooltip:Object(f.c)(r,t.CREATE_DYNAMICS_DASHBOARD_TOOLTIP),createPowerBIDashboard:Object(f.c)(r,t.CREATE_POWERBI_DASHBOARD),createPowerBIDashboardToolTip:Object(f.c)(r,t.CREATE_POWERBI_DASHBOARD_TOOLTIP),saveAsDashboard:Object(f.c)(r,t.SAVE_AS_DASHBOARD)}}(y,s);_&&_.refresh===_e.refresh&&_.setAsDefault===_e.setAsDefault&&_.unsetDefault===_e.unsetDefault&&_.openInPowerBI===_e.openInPowerBI&&_.editDashboard===_e.editDashboard&&_.deleteDashboard===_e.deleteDashboard&&_.shareDashboard===_e.shareDashboard&&_.assignDashboard===_e.assignDashboard&&_.createNewDashboard===_e.createNewDashboard&&_.createDynamicsDashboard===_e.createDynamicsDashboard&&_.createPowerBIDashboard===_e.createPowerBIDashboard&&_.saveAsDashboard===_e.saveAsDashboard||(_=_e);const Se=Object(A.a)(y),Ce=Object(K.g)(y);!ce&&te&&(ce=Object(b.a)(y,te));const je=re||ce||null,Pe=R(y,l.a.toString(te)),Te=!l.a.isNullOrEmpty(z)&&z||!l.a.isNullOrEmpty(te)&&te,we=E(y,re,Te),xe=Te||l.a.tryParseOrNull(null===(X=null===(L=null==we?void 0:we.options)||void 0===L?void 0:L[0])||void 0===X?void 0:X.value),Ae=xe;(!u||!d||Ae&&d!==Ae.guid)&&(u=Object(v.d)(y,Ae),d=Ae&&Ae.guid);const Ne=Object(G.a)(y,U.Pd,U.h);e=C(Se,Ce,Ne,y),t=j(Se,Ce,Object(sa.a)(y),Ne),r=P(Se,Ce,Ne),o=w(Se,y);const De=Object(pe.a)(y),ke=function(e,t,r){const n={},a=Ee(e,t,r);for(const t in a)n[a[t].controlName]=Object(B.N)(e,r,a[t]);return n}(y,z,D.id);c&&!ja(c,ke)||(c=ke);const Me=Fe(y,z,D.id,!1);g&&!function(e,t){if(!t)return!0;if(e.length!==t.length)return!0;for(const r of t)if(-1===e.indexOf(r))return!0;return!1}(g,Me)||(g=Me);let Re=function(e,t){const r=Object(T.a)(e,t);return r&&r.dashboardLoadStatus}(y,D.id);5===Re&&0===Le(y,z,D.id,!1)&&(Re=4);const Be=function(e,t,r){let n;switch(t){case 0:return n=Object(f.e)(e,[Or.UCI_DISABLED_ENTITY_ERROR]),String.format(Object(f.c)(n,Or.UCI_DISABLED_ENTITY_ERROR),r);case 1:return n=Object(f.e)(e,["Error.ReadOnlyEntity"]),String.format(Object(f.c)(n,"Error.ReadOnlyEntity"),r);case 2:return n=Object(f.e)(e,["Error.BoundDashboardOffline"]),Object(f.c)(n,"Error.BoundDashboardOffline");case 3:return n=Object(f.e)(e,["Error.DashboardNoComponents"]),Object(f.c)(n,"Error.DashboardNoComponents");case 4:return n=Object(f.e)(e,["Error.DashboardUnsupportedComponents"]),Object(f.c)(n,"Error.DashboardUnsupportedComponents")}}(y,Re,je),Ge=N(y,D.id,z),Ue=h&&h!==D.id;(!1!==m||Ue)&&(m=Ve(y));const Xe=Object(x.c)(y),ze=Object(x.b)(y);Ue&&(Ia.deviceWidth!==Xe||de&&Ia.deviceHeight!==ze)&&(Ia.columns=-1,Ia.width=0,Ia.height=0),h=D.id,Ia.deviceWidth=Xe,Ia.deviceHeight=ze;const qe=M(y),He=Object(ue.c)(Object(ue.a)(y,z,re)),We=Object(f.c)(Object(f.e)(y,["Dashboard_Editor_Open_Title"]),"Dashboard_Editor_Open_Title"),Ye=Object(f.c)(Object(f.e)(y,["Dashboard_Editor_Open_Message"]),"Dashboard_Editor_Open_Message"),Qe=Object(f.c)(Object(f.e)(y,["Dashboard_Editor_Open_Confirm_Button"]),"Dashboard_Editor_Open_Confirm_Button"),Ke=Object(f.c)(Object(f.e)(y,["Dashboard_Header_Label"]),"Dashboard_Header_Label"),Je=Object(G.c)(y,U.fe),Ze=(de&&Zt.Bound)|(me&&Zt.TierOne)|(Ie(y,z)&&Zt.TierTwo),$e=Object(ca.b)(y);return{formId:z,entityLogicalName:re,isUserDashboard:He,dashboardSelectorItems:we,dashboardType:Ze,dashboardInput:q,globalFilterCommandLabels:S,visualFilterCommandLabels:O,streamTileSwitcherCommandLabels:I,dashboardSelectorStyle:e,dashboardCommandBarStyle:t,dashboardViewStyle:r,dashboardProgressIndicatorStyle:o,isPowerBiEnabled:De,userDashboardPrivileges:Pe,isPowerBIDashboard:Object(le.b)(y,z),theme:Se,refreshCounters:c,isEntityBoundDashboard:!!re,isBoundDashboardControlSupported:ge,contextToken:u,ribbonLabels:_,defaultDashboardId:se,openEntityGrid:_e.openEntityGrid,forbiddenUCIControls:g,selectedDashboardId:xe,deviceWidth:Xe,dataSetColumns:Ge,dashboardLoadStatus:Re,dashboardErrorMessage:Be,isServerOffline:H,isOnPremise:ie,clientHostType:W,isRibbonCustomizable:m,yammerNetworkName:Y,yammerGroupId:Q,yammerOAuthAccessTokenExpired:J,yammerPostMethod:Z,yammerPostsOnUCIEnabled:$,hybridButtonsOnUCIEnabled:ee,commandBarRefreshProps:qe,dashboardEditorButtonText:Qe,dashboardEditorOpenMessage:Ye,dashboardEditorOpenTitle:We,dashboardHeaderIcon:Ke,shouldRenderBackButton:ne,isUnsetDefaultDashboardFeatureEnabled:Je,isInMobileModeForOct2019:$e,isSuiterDashboard:Ne}}}(),(function(e,t){return{openGridPage:r=>{e(Object(Dt.a)(r,t.id))},refreshDashboard:r=>e(rn(r,t.id)),setDashboardAppliedFilterAndLinkingInput:(r,n,a)=>{const i=Object.assign(Object.assign({},r),{appliedFilter:n,linkingInput:a});e(Object($t.b)(i,t.id))},setUpdatedControlParameters:r=>{e(wn(t.id,r))},savedFilterDelete:t=>{e(Ht(t))},defaultSavedFilterUpdate:t=>{e(Yt(t))},filterSaved:t=>{e(qt(t.entityName))},retrieveUserDashboardPrivileges:()=>{e(Object(tr.f)(ce.c,!1,[]))},setDashboardOfflineError:()=>{e(Cr(t.id,2)),e(Object(Sr.e)(["Error.BoundDashboardOffline"]))},switchDashboard:r=>{e(Hn(t.id,r))},retrieveErroredEntityMetadata:r=>{e(Sa(r,t.id))}}}))(Ca);var Ta=r("GEBM"),Ea=r("49Nd"),wa=r("CpcI"),Fa=r("455M"),xa=r("p8cR"),Aa=r("5ZBI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Na="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlDashboardSelector";let Da=!1;function ka(){let e,t={};const r=Object(f.h)();return(n,a,i,s,o)=>{Aa.a.info(i.controlId+"."+Na+": createGetDashboardData started");if(s.Parameters[n].Type===Fa.a.Dashboard){const s={};let o=!1,c=Object(V.b)(a,i.id);const{dashboardId:l,etn:u,updatedControlParameters:d,dateRangeTimeFrame:h,dateRangeStartDate:g,dateRangeEndDate:m}=Object(p.g)(a,i.id);c||l||!u||(c=Object(b.e)(a,u));const f=Object(y.j)(a,c),_="ToggleGlobalFilterFlyout";if(f){const l="Columns",u="Width",p="Height",y="ShowVisualFilters",v="TileView",S="RefreshCounters",C="ScrollTop",j="StringIds",P="DataSetColumns",T="StreamRecordsPerPage",E="CreateDashboardLayoutBuilder",w="CreateStreamControl",F=Object(b.a)(a,c),A=F&&Object(I.e)(a,F),N=f.TabAttributes&&f.TabAttributes.FilterBy,D=N&&Object(O.a)(a,F,N),k=D&&D.DisplayName,M=Object(b.h)(a,c),R=Object(G.a)(a,U.Zb,U.h),L=Object(ue.a)(a,c,F),B=R&&Object(ue.c)(L)&&!Object(pe.a)(a);s[n]={FormDescriptor:f,Columns:i.descriptor.Parameters[l],Width:i.descriptor.Parameters[u],Height:i.descriptor.Parameters[p],DeviceHeight:Object(x.b)(a),ShowVisualFilters:i.descriptor.Parameters[y],TileView:i.descriptor.Parameters[v],PrimaryEntity:F,PrimaryEntityPluralName:A,FilterByDisplayName:k,InitDateRangeTimeFrame:h,InitDateRangeStartDate:g,InitDateRangeEndDate:m,QueueEntityObjectTypeCodeByName:M,RefreshCounters:i.descriptor.Parameters[S],ScrollTop:i.descriptor.Parameters[C]||0,Strings:r(a,i.descriptor.Parameters[j]),UpdatedControlParameters:d,DataSetColumns:i.descriptor.Parameters[P],StreamRecordsPerPage:i.descriptor.Parameters[T],CreateDashboardLayoutBuilder:i.descriptor.Parameters[E],ShouldCreateGlobalFilter:Da||(Da=void 0!==i.descriptor.Parameters[_]),CreateStreamControl:i.descriptor.Parameters[w](a,M,i.id),DisablePowerBIEmbedding:B,Type:Fa.a.Dashboard,DefaultSavedFilter:Object(K.a)(a)};let V=!1;f&&(t.hasOwnProperty(n)&&t[n].FormDescriptor&&t[n].FormDescriptor.initialized===f.initialized&&t[n].FormDescriptor.Id.guid===f.Id.guid&&t[n].Columns===s[n].Columns&&t[n].Width===s[n].Width&&t[n].Height===s[n].Height&&t[n].DeviceHeight===s[n].DeviceHeight&&t[n].ShowVisualFilters===s[n].ShowVisualFilters&&t[n].TileView===s[n].TileView&&t[n].PrimaryEntity===s[n].PrimaryEntity&&t[n].PrimaryEntityPluralName===s[n].PrimaryEntityPluralName&&t[n].FilterByDisplayName===s[n].FilterByDisplayName&&t[n].ScrollTop===s[n].ScrollTop&&t[n].Strings===s[n].Strings&&t[n].UpdatedControlParameters===s[n].UpdatedControlParameters&&t[n].DataSetColumns===s[n].DataSetColumns&&t[n].StreamRecordsPerPage===s[n].StreamRecordsPerPage&&t[n].CreateDashboardLayoutBuilder===s[n].CreateDashboardLayoutBuilder&&t[n].ShouldCreateGlobalFilter===s[n].ShouldCreateGlobalFilter&&e===i.descriptor.Parameters[_]&&t[n].DefaultSavedFilter===s[n].DefaultSavedFilter&&t[n].DisablePowerBIEmbedding===s[n].DisablePowerBIEmbedding&&!Ma(t[n].QueueEntityObjectTypeCodeByName,s[n].QueueEntityObjectTypeCodeByName)&&!Ma(t[n].RefreshCounters,s[n].RefreshCounters)||(V=!0)),o=V}return o&&(t=Object.assign(Object.assign({},t),s),e=i.descriptor.Parameters[_]),Aa.a.info(i.controlId+"."+Na+": createGetDashboardData finished"),t[n]}}}function Ma(e,t){if(Object.keys(t).length!==Object.keys(e).length)return!0;for(const r in t){if(!e[r]&&0!==e[r])return!0;if(e[r]!==t[r])return!0}return!1}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ra(){let e={};return(t,r,n,a,i)=>{Aa.a.info(n.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlGlobalFilterSelector: createGetGlobalFilterData started");const s=a.Parameters[t],o=n.descriptor.Parameters,c={};let l=!1;const u={},d={},h=s?s.Entities:null,p=s?s.DashboardWidth:null;if(h){for(const e of h){const t=Object(I.f)(r,e);t&&(d[e]=t);const n=Object(O.d)(r,e);if(n)if(u[e]||(u[e]={}),s.AttributesByEntity&&s.AttributesByEntity[e])for(const t of s.AttributesByEntity[e])u[e][t]=n[t];else for(const t in n){const a=n[t];a&&La(r,e,t,a)&&a.IsGlobalFilterEnabled&&(u[e][t]=a)}}c[t]={Entities:h,DashboardWidth:p,PrimaryEntity:s.PrimaryEntity,EntityDisplayNames:d,AttributeDescriptorsByEntity:u,ToggleGlobalFilterFlyout:o&&o.ToggleGlobalFilterFlyout,GlobalFilterFlyoutAnchorId:o&&o.GlobalFilterFlyoutAnchorId,Type:Fa.a.GlobalFilter,ConvertFilterExpressionToFetchXml:zt.j,ConvertFetchXmlToFilterExpression:zt.i,SavedFilters:Object(K.i)(r),SelectedGlobalFilterId:Object(K.j)(r),DefaultSavedFilter:Object(K.a)(r)},e.hasOwnProperty(t)&&e[t].Entities&&!function(e,t){if(e.length!==t.length)return!0;for(const r of t)if(e.indexOf(r)<0)return!0;return!1}(e[t].Entities,h)&&e[t].DashboardWidth===p&&e[t].ToggleGlobalFilterFlyout===c[t].ToggleGlobalFilterFlyout&&e[t].GlobalFilterFlyoutAnchorId===c[t].GlobalFilterFlyoutAnchorId&&!function(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!0;for(const r in t){if(!(r in e))return!0;if(Object.keys(e[r]).length!==Object.keys(t[r]).length)return!0;for(const n in t[r])if(!(n in e[r]))return!0}return!1}(e[t].AttributeDescriptorsByEntity,u)||(l=!0)}return l&&(e=Object.assign(Object.assign({},e),c)),Aa.a.info(n.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlGlobalFilterSelector: createGetGlobalFilterData finished"),e[t]}}function La(e,t,r,n){return Object(D.f)(e,t,r,he.a.CanRead)&&n&&n.IsValidForRead}var Ba=r("MoY7");function Va(e){return{type:"dashboard.retrieveDashboardSelectors.async",execute:({dispatch:t,getState:r})=>{const n=r();let a=2;const i=e?Object(b.g)(n,e):Object(b.c)(n),s=i&&Object.keys(i);if(s&&s.length>0){const e=i[s[0]];a=Object(sn.d)(n,!0,e,()=>e)}return 0!==a?t(function(e){return Object(sn.b)("dashboardselector",null,e,null,!0,cn.a.OnDemandWithContext,null,null,[],null,ln.a.LocalAndRemote)}(e)):Promise.resolve()}}}var Ga=r("nmJf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ua(e,t,r,n,a,{etn:i}){const s=t(Va(i)),o=t(function(){const e=[...N.labelList,...Tt,...un,...fr,...st,...lt,...nt,...Ta.A,...Or.labelList,...Ea.k,...wa.g,"ViewSelectorAllActivities"];return Object(Sr.e)(e)}());!function(e,t){Ve(t)&&e(Object(Ga.a)("Dashboard:null"));const r=Object(I.h)(t,ce.c);(r&&r.Privileges||Object(oe.b)(t))&&e(Object(tr.f)(ce.c,!1,[]))}(t,e());return Dn(e,t,n,a,i,r.ScriptManager.initializeContainerForClientApi(n),s,o)}function Xa(e,t,{retrievedId:r,etn:n}){e(Rn(t,r,n)),e(Vn(r,n)),Object(xa.b)(ka,Fa.a.Dashboard),Object(xa.b)(Ra,Fa.a.GlobalFilter,Fa.a.AppliedFilters),Object(xa.b)(Ba.a,Fa.a.PowerBI)}var za=r("4rWj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function qa(e,t){const r=e?"dashboard.setLoadStatus"===t.type?t.payload:e.dashboardLoadStatus:void 0,n=Object.assign(Object.assign({},Object(za.a)(e,t)),{dashboardLoadStatus:r});return Object.freeze(n)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Ha{constructor(e,t){this._id=e,this._initializeAction=function(e,t){return Nn("PageNavigation",e,t,Ua,Xa,()=>Promise.resolve())}(this._id,t)}getName(){return o.a}getId(){return this._id}getInitializationAction(e){return this._initializeAction(e)}getRootReducer(){return qa}getRootComponent(){return Pa}getCloseAction(e){}}},"b41/":function(e,t,r){"use strict";r.d(t,"f",(function(){return n})),r.d(t,"g",(function(){return a})),r.d(t,"h",(function(){return i})),r.d(t,"i",(function(){return s})),r.d(t,"a",(function(){return o})),r.d(t,"e",(function(){return c})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return u})),r.d(t,"b",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n={advancedFilters:"Grid_AdvancedFilter_AdvancedFilters",cancel:"GlobalFilter_Cancel",apply:"Button_Label_Apply",addButton:"Web.SFA.Workflow.Variables.Add",addRow:"MenuItem_Label_AddRow_SentenceCase",addGroup:"MenuItem_Label_AddGroup_SentenceCase",deleteExpression:"Web.SFA.Workflow.Variables.Delete",moveUpExpression:"Web._controls.listedit.buttons.MoveUp",moveDownExpression:"Web._controls.listedit.buttons.MoveDown_SentenceCas",makeGroup:"Grid_AdvancedFilter_MakeGroup",ungroup:"AF_MenuItem_UnGroup",andGroup:"AF_Text_And",orGroup:"AF_Text_Or_SentenceCase",addRelatedEntity:"MenuItem_Label_AddRelatedEntity_SentenceCase",relatedEntityPlaceholder:"Grid_AdvancedFilter_RelatedEntityPlaceholder",fieldPlaceholder:"Audit.Incontext.Filters.AttributesGroup",containsData:"Web._tools.search.search.js_12_8_SentenceCase",doesNotContainData:"Web._tools.search.search.js_12_9_SentenceCase",doesNotContainDataWarning:"Grid_AdvancedFilter_DoesNotContainDataWarning",manyToOne:"Grid_AdvancedFilter_ManyToOne",oneToMany:"Grid_AdvancedFilter_OneToMany",manyToMany:"Grid_AdvancedFilter_ManyToMany",noRelationships:"Grid_AdvancedFilter_NoRelationships",moreCommandsAriaLabel:"AF_Aria_MoreCommands",rowSelectorAriaLabel:"AF_Aria_RowSelector",groupSelectorAriaLabel:"AF_Aria_GroupSelector",groupExpandAriaLabel:"AF_MenuItem_Expand",groupCollapseAriaLabel:"AF_MenuItem_Collapse",groupExpandAriaDescription:"AF_Aria_GroupExpand",groupCollapseAriaDescription:"AF_Aria_GroupCollapse",errorQuickFind:"AF_Error_QuickFindView",errorMalformed:"Grid_AdvancedFilter_ErrorMalformed",invalidField:"Grid_AdvancedFilter_InvalidField",fieldSelectorControlLabel:"Grid_AdvancedFilter_FieldSelector",operatorSelectorControlLabel:"Web.SFA.Workflow.AssignValueDialog.Operator",errorFailedToLoad:"Grid_AdvancedFilter_FailedToLoad",fetchXmlConditionWarning:"Grid_AdvancedFilter_FetchXmlConditionWarning"},a=Object.values(n),i={contains:"SystemCustomization.BusinessRules.ConditionOperator.CONTAINS",doesNotContain:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTCONTAIN",beginsWith:"SystemCustomization.BusinessRules.ConditionOperator.BEGINSWITH",doesNotBeginWith:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTBEGINWITH",endsWith:"SystemCustomization.BusinessRules.ConditionOperator.ENDSWITH",doesNotEndWith:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTENDWITH",containsData:"SystemCustomization.BusinessRules.ConditionOperator.NOTNULL",doesNotContainData:"SystemCustomization.BusinessRules.ConditionOperator.ISNULL",equals:"CustomControl_Grid_Filtering_ConditionOperator_Equals",doesNotEqual:"CustomControl_Grid_Filtering_ConditionOperator_DoesNotEqual",greaterThan:"CustomControl_Grid_Filtering_ConditionOperator_Greater",greaterThanOrEqualTo:"CustomControl_Grid_Filtering_ConditionOperator_GreaterOrEqual",lessThan:"CustomControl_Grid_Filtering_ConditionOperator_Less",lessThanOrEqualTo:"CustomControl_Grid_Filtering_ConditionOperator_LessOrEqual",dateQuarter:"ViewDesigner.RecordFilter.quarter",dateFiscalYear:"FiscalYear_Format_String_NoSpace",on:"Web._tools.search.search.js_16_0",onOrAfter:"CustomControl_Grid_Filtering_ConditionOperator_OnOrAfter",onOrBefore:"ViewDesigner.RecordFilter.on_or_before",yesterday:"Web._tools.search.search.js_16_3",today:"Web._tools.search.search.js_16_4",tomorrow:"Web._tools.search.search.js_16_5",nextSevenDays:"Web._tools.search.search.js_16_6",lastSevenDays:"Web._tools.search.search.js_16_7_SentenceCase",nextWeek:"Web._tools.search.search.js_16_8_SentenceCase",lastWeek:"Web._tools.search.search.js_16_9_SentenceCase",thisWeek:"Web._tools.search.search.js_16_10_SentenceCase",nextMonth:"Web._tools.search.search.js_16_11_SentenceCase",lastMonth:"Web._tools.search.search.js_16_12_SentenceCase",thisMonth:"Web._tools.search.search.js_16_13_SentenceCase",nextYear:"Web._tools.search.search.js_16_14_SentenceCase",lastYear:"Web._tools.search.search.js_16_15_SentenceCase",thisYear:"Web._tools.search.search.js_16_16_SentenceCase",lastXHours:"AF_Option_LastXHours_SentenceCase",nextXHours:"AF_Option_NextXHours_SentenceCase",lastXDays:"AF_Option_LastXDays_SentenceCase",nextXDays:"AF_Option_NextXDays_SentenceCase",lastXWeeks:"AF_Option_LastXWeeks_SentenceCase",nextXWeeks:"AF_Option_NextXWeeks_SentenceCase",lastXMonths:"AF_Option_LastXMonths_SentenceCase",nextXMonths:"AF_Option_NextXMonths_SentenceCase",lastXYears:"AF_Option_LastXYears_SentenceCase",nextXYears:"AF_Option_NextXYears_SentenceCase",anyTime:"Search.Time.Range.Anytime",olderThanXMinutes:"AF_Option_OlderThanXMinutes_SentenceCase",olderThanXHours:"AF_Option_OlderThanXHours_SentenceCase",olderThanXDays:"AF_Option_OlderThanXDays_SentenceCase",olderThanXWeeks:"AF_Option_OlderThanXWeeks_SentenceCase",olderThanXMonths:"AF_Option_OlderThanXMonths_SentenceCase",olderThanXYears:"AF_Option_OlderThanXYears_SentenceCase",inFiscalYear:"AF_Option_InFiscalYear_SentenceCase",lastFiscalYear:"AF_Option_LastFiscalYear_SentenceCase",thisFiscalYear:"AF_Option_ThisFiscalYear_SentenceCase",nextFiscalYear:"AF_Option_NextFiscalYear_SentenceCase",lastXFiscalYears:"AF_Option_LastXFiscalYears_SentenceCase",nextXFiscalYears:"AF_Option_NextXFiscalYears_SentenceCase",inFiscalPeriod:"AF_Option_InFiscalPeriod_SentenceCase",lastFiscalPeriod:"AF_Option_LastFiscalPeriod_SentenceCase",thisFiscalPeriod:"AF_Option_ThisFiscalPeriod_SentenceCase",nextFiscalPeriod:"AF_Option_NextFiscalPeriod_SentenceCase",lastXFiscalPeriods:"AF_Option_LastXFiscalPeriods_SentenceCase",nextXFiscalPeriods:"AF_Option_NextXFiscalPeriods_SentenceCase",inFiscalPeriodAndYear:"AF_Option_InFiscalPeriodAndYear_SentenceCase",inOrAfterFiscalPeriodAndYear:"AF_Option_InOrAfterFiscalPeriod_SentenceCase",inOrBeforeFiscalPeriodAndYear:"AF_Option_InOrBeforeFiscalPeriod_SentenceCase",containValues:"Web._tools.search.search.js_17_4_SentenceCase",doesNotContainValues:"Web._tools.search.search.js_17_5_SentenceCase",equalsCurrentUserLanguage:"AF_Option_EqUserLanguage_SentenceCase",isCurrentUser:"Web._tools.search.search.js_17_0_SentenceCase",notCurrentUser:"Web._tools.search.search.js_17_1_SentenceCase",isCurrentBusinessUnit:"Web._tools.search.search.js_19_1_SentenceCase",notCurrentBusinessUnit:"Web._tools.search.search.js_19_2_SentenceCase",under:"Web.SFA.Workflow.UnderOperator",notUnder:"Web.SFA.Workflow.NotUnderOperator",above:"ViewDesigner.RecordFilter.above",viewAll:"CustomControl_Calendar_ViewMore",aboveOrEqual:"ViewDesigner.RecordFilter.eq_or_above_SentenceCase",underOrEqual:"ViewDesigner.RecordFilter.eq_or_under_SentenceCase",isCurrentUserOrReportingHierarchy:"OwnershipOperator_EqualsCurrentUserOrHierarchy_SentenceCase",isCurrentUserAndTeamsOrReportingHierarchyAndTeams:"OwnershipOperator_EqualsCurrentUserOrHierarchyAndTeams_SentenceCase",isCurrentUserTeams:"OwnershipOperator_EqualsCurrentUserTeams_SentenceCase",isCurrentUserOrTeams:"OwnershipOperator_EqualsCurrentUserOrUserTeams_SentenceCase",loadingResults:"Grid_AdvancedFilter_LoadingResults",noResults:"KMControl.SearchKMArticles.NoResults",errorNoValues:"AF_Error_NoValues",inputControlLabel:"Web.SFA.Workflow.AssignValueDialog.Value",removeButtonAriaLabel:"Dialog_Disassociate_Header",noValue:"Grid_AdvancedFilter_NoValue",minValue:"Grid_AdvancedFilter_MinValue",maxValue:"Grid_AdvancedFilter_MaxValue",maxPrecision:"Grid_AdvancedFilter_MaxPrecision",maxLength:"Grid_AdvancedFilter_MaxLength",incorrectDataType:"Grid_AdvancedFilter_IncorrectDataType",durationUnit:"Grid_AdvancedFilter_durationUnit"},s=Object.values(i),o={dropDownOptionsAll:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsAll",dropDownOptionsDefault:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsDefault",dropDownOptionsCustom:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsCustom",fieldContextMenuRemove:"Grid_AdvancedFilter_ColumnEditor_FieldContextMenuRemove",addColumn:"Grid_AdvancedFilter_ColumnEditor_AddColumn",editColumns:"Grid_AdvancedFilter_ColumnEditor_EditColumns",apply:"Grid_AdvancedFilter_ColumnEditor_Apply",cancel:"Grid_AdvancedFilter_ColumnEditor_Cancel",search:"Grid_AdvancedFilter_ColumnEditor_Search",related:"Grid_AdvancedFilter_ColumnEditor_Related",moveUp:"Grid_AdvancedFilter_ColumnEditor_MoveUp",moveDown:"Grid_AdvancedFilter_ColumnEditor_MoveDown",resetToDefault:"Grid_AdvancedFilter_ColumnEditor_ResetToDefault",close:"Grid_AdvancedFilter_ColumnEditor_Close",listAriaLabel:"Grid_AdvancedFilter_ColumnEditor_AttributesListLabel",columnEditor:"Grid_AdvancedFilter_ColumnEditor_ColumnEditor",saveAsNewView:"Grid_AdvancedFilter_ColumnEditor_SaveAsNewView",saveChangesToCurrentView:"Grid_AdvancedFilter_ColumnEditor_SaveChangesToCurrentView",noFieldsToDisplay:"Grid_AdvancedFilter_ColumnEditor_NoFieldsToDisplay",moreOptions:"Grid_AdvancedFilter_ColumnEditor_MoreOptions",dropdown:"Grid_AdvancedFilter_ColumnEditor_Dropdown"},c=Object.values(o),l={ApplyAdvancedFiltersTitle:"Grid_AdvancedFilter_ApplyAdvancedFiltersTitle",ApplyAdvancedFiltersAria:"Grid_AdvancedFilter_ApplyAdvancedFiltersAriaLabel",CancelEditingFiltersAria:"Grid_AdvancedFilter_CancelEditingAdvancedFiltersAriaLabel",OpenAdvancedFiltersTitleAndAria:"Grid_AdvancedFilter_OpenAdvancedFilterTitleAndAria",resetToDefault:"Grid_AdvancedFilter_ColumnEditor_ResetToDefault"},u=Object.values(l),d=[...a,...s,...u]},bGh0:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r("PUjk"),a=r("HcnX"),i=r("odYE"),s=r("Khp3");class o{constructor(e,t,r,n){this.eventName="BusinessRuleRecommendation_"+e,this.eventParameters=[{name:"EntityTypeName",value:t},{name:"FieldName",value:r},{name:"Title",value:n}]}}var c=r("qshH"),l=r("16wZ"),u=r("i1f0"),d=r("LbMF"),h=r("Qn2w"),p=r("SAYH"),g=r("uhZ3"),m=r("IaGr");var b=r("ZIjf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let f;class y extends a.a{constructor(e,t,r,n,a,i){super(e,t,r,n,a,i),this._entityAttribute=null,f=e,this.registerObserversForControlStateChange()}getAttribute(){const e="ClientApi.XrmDataControl.getAttribute";try{if(b.a.instance.reportCall(e),!this._entityAttribute){let e;if(this.formContext&&this.formContext.data&&this.formContext.data.entity&&(e=this.controlDescriptor&&this.controlDescriptor.Relationship?this.formContext.data.entity.relatedEntities.get(this.controlDescriptor.Relationship):this.formContext.data.entity),this.controlDescriptor&&this.controlDescriptor.DataFieldName&&this.formContext&&this.formContext.data)if(this.controlDescriptor.IsUnbound)this._entityAttribute=this.formContext.data.attributes.get(this.controlDescriptor.DataFieldName);else{const t=e?e.attributes:this.formContext.data.attributes;this._entityAttribute=t.get(this.controlDescriptor.DataFieldName)}}return b.a.instance.reportSuccess(e),this._entityAttribute}catch(t){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,r),t}}updateAttribute(e,t){const r="ClientApi.XrmDataControl.updateAttribute";try{if(b.a.instance.reportCall(r),e&&t&&this.controlDescriptor&&this.controlDescriptor.Relationship===t){this._entityAttribute=null;const t=e.attributes;t&&(this._entityAttribute=t.get(this.controlDescriptor.DataFieldName))}this._entityAttribute&&this._entityAttribute.controls.add(this.name,this),b.a.instance.reportSuccess(r)}catch(e){const t=c.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(r,e,null,t),e}}addNotification(e){const t="ClientApi.XrmDataControl.addNotification";try{if(b.a.instance.reportCall(t),this._isValidNotification(e)&&this.getVisible()){const r={uniqueId:e.uniqueId?e.uniqueId:"",messages:e.messages,notificationLevel:e.notificationLevel,actions:e.actions};return"RECOMMENDATION"===e.notificationLevel?this._reportAddNotificationEvent(e):f.dispatch(Object(h.b)(this.pageId,this.getName(),!1,this.contextToken)),f.dispatch(Object(s.b)(this.pageId,this.getName(),r,this.contextToken)),b.a.instance.reportSuccess(t),!0}return b.a.instance.reportSuccess(t),!1}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,r),e}}_clearControlNotification(e){const t=Object(u.A)(f.getState(),{controlName:this.name,id:this.pageId},this.contextToken);if(t){const r=Object.keys(t);let n=null;if(e){if(n=t[e],!(n&&n.messages&&n.notificationLevel))return!1;this._clearNotification(n)}else(Object(l.a)(e)||0===e.trim().length)&&r.forEach(e=>{n=t[e],this._clearNotification(n)});return!0}return!1}_clearNotification(e){e.actions=null,e.messages=null,e.notificationLevel=null,f.dispatch(Object(s.b)(this.pageId,this.name,e,this.contextToken))}clearNotification(e){const t="ClientApi.XrmDataControl.clearNotification";try{b.a.instance.reportCall(t);const r=!!this._clearControlNotification(e);return b.a.instance.reportSuccess(t),r}catch(e){const r=c.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,r),e}}setNotification(e,t){const r="ClientApi.XrmDataControl.setNotification";try{b.a.instance.reportCall(r);const n={uniqueId:t,messages:[e],priority:0,notificationLevel:"ERROR",actions:[{actions:[function(){}],message:""}]};return b.a.instance.reportSuccess(r),this.addNotification(n)}catch(e){const t=c.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(r,e,null,t),e}}_isValidNotification(e){return!(!e||!e.messages||Object(g.b)(e.messages[0]))&&("RECOMMENDATION"===e.notificationLevel||"ERROR"===e.notificationLevel)}_reportAddNotificationEvent(e){if(!this._isValidNotification(e))return;const t=e.messages[0],r=new o("Added",this.contextToken.entityTypeName,this.getName(),t);var n;f.dispatch((n=r,{type:"report.xrm.event",execute(e,t){try{c.a.getInstance().reportEvent(n)}catch(e){const t="ClientApi.ReportXrmEventAction.reportXrmEvent";m.a.getInstance().eventManager.ReportComponentFailure(t,e),Object(l.j)(t,"XrmReporting")}return Promise.resolve()}}))}getEntityReference(){const e=this.formContext.entityReference,t=e.id?new p.a(e.id):null;return new i.a(e.entityType,t)}registerObserversForControlStateChange(){if(this.getName().startsWith("header_process")){const e=Object(n.a)(this.pageId);e&&this.controlStateObservable.registerObserver(e)}}getAttrDescriptor(e,t,r){const n=this.getEntityReference().etn;let a=Object(u.r)(f.getState(),n,this.name,this.pageId,this.contextToken);return a||(this.controlDescriptor?this.controlDescriptor.DataFieldName?(m.a.getInstance().traceManager.getTracer(e).warn("ControlAttributeDescriptor was not found, falling back to the attribute descriptor.",t),a=Object(d.a)(f.getState(),n,this.controlDescriptor.DataFieldName),a||(t.push({name:"attributeName",value:this.controlDescriptor.DataFieldName}),t.push({name:"entityName",value:n}),r.reportFailure(e,new Error("Attribute descriptor was not found"),t))):r.reportFailure(e,new Error("Control descriptor did not have a DataFieldName"),t):r.reportFailure(e,new Error("Control descriptor was not found"),t)),a}}},bJaF:function(e,t,r){"use strict";r.d(t,"a",(function(){return ot}));var n,a=r("DRVD"),i=r.n(a),s=r("arV0"),o=r("TAjd"),c=r("uNu9"),l=r("uNLT"),u=r("tT9w"),d=r("ofgb"),h=r("+hq9"),p=r("Uv1Y"),g=r("SAYH"),m=r("+nNZ"),b=r("7tM0");!function(e){e[e.None=0]="None",e[e.Processing=1]="Processing",e[e.Completed=2]="Completed",e[e.Failure=3]="Failure",e[e.Invalid=4]="Invalid"}(n||(n={}));class f{constructor(e,t){this._getState=e,this._processId=t}GenerateMessageForAction(e){let t="";const r="cc_MscrmControls.Containers.ProcessBreadCrumb/strings/ProcessControlResources",a=this._getState(),i=Object(b.a)(a,r,"ProcessControl_ActionExecuter_ExecutionTimeTooltip"),s=Object(b.a)(a,r,"ProcessControl_ActionExecuter_ErrorMessageTooltip"),o=Object(b.a)(a,r,"Crm_GenericErrorMessage");switch(e){case n.Completed:t=String.format(i,(new Date).toLocaleString());break;case n.Failure:t=String.format(i,(new Date).toLocaleString())+"\n"+String.format(s,o)}return t}GetActionMetadata(e){const t=Object(m.a)(this._getState(),new g.a(this._processId.guid));let r;return t&&t.businessProcessFlowActions&&t.businessProcessFlowActions[e]&&(r=t.businessProcessFlowActions[e]),r}InvokeProcessAction(e,t,r){return Xrm.Utility.invokeProcessActionInternal(e,r,t)}}var y=r("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function _(e){if(!e)return null;const t=function(e){const t=[];return e.forEach(e=>{const r={id:g.a.tryParse(e.Id),primaryField:e.PrimaryField,entityTypeCode:e.EntityTypeCode,entityLogicalName:e.EntityLogicalName,primaryKeyName:e.PrimaryKeyName};t.push(r)}),t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e.NavigationEntities);return{entityDisplayName:e.EntityDisplayName,entityLogicalName:e.EntityLogicalName,entityTypeCode:e.entityTypeCode,showCreate:e.ShowCreate,navigationEntities:t}}function v(e,t,r,n){return{type:"businessProcessFlow.retrieveNavigationEntities.async",execute:({dispatch:a,getState:i},s)=>function(e,t,r,n,a){return e.retrieveNavigationEntities(t,r,n,a,null).nativePromise().then(_,p.b)}(s.DataSource,e,t,r,n)}}var S=r("rodW"),O=r("bCAK"),I=r("LFkE");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class C{constructor(e,t){this.Target=e,this.NewProcess=t}getMetadata(){return{boundParameter:null,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcess:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}},operationName:"SetProcess",operationType:0}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class j{constructor(e,t,r){this.Target=e,this.NewProcess=t,this.NewProcessInstance=r}getMetadata(){return{boundParameter:null,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcess:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcessInstance:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}},operationName:"SetProcess",operationType:0}}}var P=r("w72X"),T=r("EHQq");function E(e,t,r,n,a,i){return{type:"businessProcessFlow.navigateToNextEntity.async",execute:({dispatch:s,getState:o},c)=>function(e,t,r,n,a,i,s){const o=new T.a(g.a.toLegacyGuid(t.id),t.etn,g.a.toLegacyGuid(r.id),r.etn,g.a.toLegacyGuid(n),a,g.a.toLegacyGuid(i),g.a.toLegacyGuid(s));return e.execute(o,null).nativePromise()}(c.DataSource,e,t,r,n,a,i)}}var w=r("sNgR");class F{constructor(e,t){this.EntityId=e,this.EntityLogicalName=t}getMetadata(){return{boundParameter:null,parameterTypes:{EntityId:{typeName:"Edm.Guid",structuralProperty:1},EntityLogicalName:{typeName:"Edm.String",structuralProperty:1}},operationName:"RetrieveProcessInstances",operationType:1}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class x{constructor(e,t){this.EntityLogicalName=e,this.AppModuleId=t}getMetadata(){return{boundParameter:null,parameterTypes:{EntityLogicalName:{typeName:"Edm.String",structuralProperty:1},AppModuleId:{typeName:"Edm.Guid",structuralProperty:1}},operationName:"RetrieveFilteredProcesses",operationType:1}}}var A=r("E5IU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class N{constructor(e,t,r){this._name=e,this._uniqueName=t,this._workflowId=r}get workflowId(){return this._workflowId}set workflowId(e){this._workflowId=e}get uniqueName(){return this._uniqueName}set uniqueName(e){this._uniqueName=e}get name(){return this._name}set name(e){this._name=e}}var D=r("WPtp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class k{get activeStageId(){return this._activeStageId}set activeStageId(e){this._activeStageId=e}set businessProcessInstanceId(e){this._businessProcessInstanceId=e}get businessProcessInstanceId(){return this._businessProcessInstanceId}get businessProcessInstanceName(){return this._businessProcessInstanceName}set businessProcessInstanceName(e){this._businessProcessInstanceName=e}get businessProcessState(){return this._businessProcessState}set businessProcessState(e){this._businessProcessState=e}get businessProcessStatus(){return this._businessProcessStatus}set businessProcessStatus(e){this._businessProcessStatus=e}get navigationEntities(){return this._navigationEntities}set navigationEntities(e){this._navigationEntities=e}get traversedPath(){return this._traversedPath}set traversedPath(e){this._traversedPath=e}get bpfDefinitionVersionNumber(){return this._bpfDefinitionVersionNumber}set bpfDefinitionVersionNumber(e){this._bpfDefinitionVersionNumber=e}}var M=r("sxfa");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class R{get id(){return this._id}set id(e){this._id=e}get primaryField(){return this._primaryField}set primaryField(e){this._primaryField=e}get entityTypeCode(){return this._entityTypeCode}set entityTypeCode(e){this._entityTypeCode=e}get entityLogicalName(){return this._entityLogicalName}set entityLogicalName(e){this._entityLogicalName=e}get primaryKeyName(){return this._primaryKeyName}set primaryKeyName(e){this._primaryKeyName=e}}var L,B=r("hvSt");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.Active=0]="Active",e[e.Inactive=1]="Inactive"}(L||(L={}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class V{constructor(e){this._stageManager=e,this._populateTraversedPath()}getTraversedPath(){return this._traversedPath}_populateTraversedPath(){this._traversedPath=this._stageManager.globalPathAndActiveStage.traversedPath.path}}var G=r("blB4"),U=r("UuJw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class X extends Error{constructor(e){super(e),this.navigationStatus=G.a.invalid,this.stageInvalidReason=U.a.invalid,Object.setPrototypeOf(this,X.prototype)}}Error;class z extends Error{constructor(e){super(e),this.stageInvalidReason=U.a.unreachable,Object.setPrototypeOf(this,z.prototype)}}class q extends Error{constructor(e){super(e),this.navigationStatus=G.a.dirtyForm,this.stageInvalidReason=U.a.dirtyForm,Object.setPrototypeOf(this,q.prototype)}}class H extends Error{constructor(e){super(e),this.navigationStatus=G.a.end,Object.setPrototypeOf(this,H.prototype)}}class W extends Error{constructor(e){super(e),this.navigationStatus=G.a.beginning,Object.setPrototypeOf(this,W.prototype)}}class Y extends Error{constructor(e){super(e),this.navigationStatus=G.a.stageGate,Object.setPrototypeOf(this,Y.prototype)}}class Q extends Error{constructor(e){super(e),this.navigationStatus=G.a.invalidProcess,this.stageInvalidReason=U.a.invalidProcess,Object.setPrototypeOf(this,Q.prototype)}}class K extends Error{constructor(e){super(e),this.navigationStatus=G.a.dirtyForm,this.stageInvalidReason=U.a.dirtyForm,Object.setPrototypeOf(this,K.prototype)}}var J=r("odYE"),Z=r("mL5Q"),$=r("f/sd"),ee=r("53SR"),te=r("nexV"),re=r("quej"),ne=r("ijzp"),ae=r("WY/A"),ie=r("sX6v"),se=r("P+kM"),oe=r("YYhu"),ce=r("srnJ"),le=r("5Oca"),ue=r("Dea/"),de=r("dHD5"),he=r("bT7G"),pe=r("e3W2"),ge=r("WePp");class me extends ge.a{constructor(e,t,r){super("BusinessProcessFlow_"+e),this.addEventParameter("ProcessId",t),this.addEventParameter("ProcessInstanceId",r)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class be extends me{constructor(e,t){super("Initialized",e,t)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class fe extends me{constructor(e,t,r){super("SetActiveStageEvent",e,t),this.addEventParameter("ActiveStageId",r)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ye extends me{constructor(e,t,r){super("DisplayStateEvent",e,t),this.addEventParameter("CurrentDisplayState",r)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class _e extends me{constructor(e,t,r,n){super("StatusEvent",e,t),this.addEventParameter("ProcessStatus",r),this.addEventParameter("CurrentDisplayState",n)}}var ve=r("uzi5"),Se=r("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Oe{getMetadata(){return{boundParameter:"entity",operationName:"ExecuteWorkflow",operationType:0,parameterTypes:{entity:{typeName:"Microsoft.Dynamics.CRM.workflow",structuralProperty:5},EntityId:{typeName:"Edm.Guid",structuralProperty:1},InputArguments:{typeName:"Microsoft.Dynamics.CRM.InputArgumentCollection",structuralProperty:2}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Ie{getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Type:{typeName:"Edm.String",structuralProperty:1},Value:{typeName:"Edm.String",structuralProperty:1}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Ce{getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Count:{typeName:"Edm.Int32",structuralProperty:1},IsReadOnly:{typeName:"Edm.Boolean",structuralProperty:1},Keys:{typeName:"Edm.String",structuralProperty:4},Values:{typeName:"mscrm.AnyComplexType",structuralProperty:4}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class je{getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Arguments:{typeName:"Microsoft.Dynamics.CRM.InputArgument",structuralProperty:2}}}}}var Pe,Te=r("+XGO"),Ee=r("mIxf"),we=r("AFlp"),Fe=r("k1f1");!function(e){e[e.ProcessAction=0]="ProcessAction",e[e.TaskFlow=1]="TaskFlow",e[e.SyncWorkflow=2]="SyncWorkflow",e[e.AsyncWorkflow=3]="AsyncWorkflow",e[e.MessageAction=4]="MessageAction"}(Pe||(Pe={}));var xe=r("D4Jo"),Ae=r("JF0K"),Ne=r("iZ7K"),De=r("JP46");var ke=r("ghNp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Me=r("VcAV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Re{constructor(e,t){this._getState=e,this._applicationContext=t}setBpfInstance(e){return this._processInstance=e,this}setBpfInstanceName(e){return this._processInstanceName=e,this}setProcess(e){return this._process=e,this}setProcessId(e){return this._processId=e,this}setFormEntity(e){return this._formEntity=e,this}GetFlowStepMetadata(e,t){const r=t.TraceManager.getTracer("businessProcessFlow.flowStepManager"),n=this._processId&&this._processId.guid||null,a=Object(m.a)(this._getState(),g.a.tryParse(n));if(Object(Me.c)(a))return r.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined bpfDescriptor: "+a),null;const i=a.businessProcessFlowFlows;if(Object(Me.c)(i))return r.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined businessProcessFlowFlows: "+i),null;const s=i[e];return Object(Me.c)(i)?(r.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined flowStepDescriptor: "+s),null):s}openFlowWidget(e,t){if(g.a.tryParse(e.flowStepId)===g.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty flowStepId: "+e.flowStepId);const r=this._populateFlowDialogParams(e,t),n={height:600,width:600};Xrm.Navigation.openDialog("MicrosoftFlowsDialog",n,r)}_populateFlowDialogParams(e,t){const r=this.GetFlowStepMetadata(e.flowStepId,this._applicationContext);if(Object(Me.c)(r))throw new Error("BPF Flow Step Failure: null metadata");const n={},a=r.flowId;if(Object(Me.c)(a))throw new Error("BPF Flow Step Failure: null metadata.flowId");if(!this._processInstance&&!this._processInstance.id){const e=[];e.push(this._processInstance.id.guid);const t=JSON.stringify(e);n.entity_ids=t}n.flow_id=a,n.org_unique_name=Xrm.Utility.getGlobalContext().getOrgUniqueName(),n.bpf_step_id=e.flowStepId;const i=Xrm.Page.data.entity.getEntityName(),s=this._getState().metadata.entities[i].EntitySetName,o=Xrm.Utility.getGlobalContext().getAdvancedConfigSetting("MicrosoftFlowDestinationUrl");n.entity_logical_collection_name=s,n.entity_logical_name=i,n.flows_destination_url=o,n.dynamics365_access_token=sessionStorage.getItem("dynamics365AccessToken");const c=Xrm.Utility.getGlobalContext().getAdvancedConfigSetting("MicrosoftFlowFirstPartyIntegrationSiteUrl");n.flows_fpi_site_url=c+"&flowsEnableWidgetV2=true",n.flows_authentication_string=this._getLocalizedLabel("SystemCustomization.SystemSettingsDialog.PreviewTab.IsMicrosoftFlowEnabled.AuthenticateButton.Text"),n.flows_enable_widget_v2=!0,Re.UpdateEventParameter(t,"flows_destination_url",o),Re.UpdateEventParameter(t,"flow_id",a),Object(Me.c)(e.workflowLogId)||e.workflowLogId===g.a.EMPTY||(n.flows_wflog_id=g.a.toString(e.workflowLogId));const l=this._processInstance&&this._processInstance.id;if(Object(Me.c)(l)||l===g.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty processInstanceId: "+l);n.bpf_instance_id=g.a.toString(l);const u=this._processInstance&&this._processInstance.etn;if(Object(Se.b)(u))throw new Error("BPF Flow Step On-Click Failure: null or empty processInstanceEntityLogicalName: "+u);n.bpf_instance_entity_name=u;const d=this._processId&&this._processId.guid||null;if(g.a.tryParse(d)===g.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty processId: "+d);n.bpf_definition_id=d,n.bpf_definition_entity_name="workflow";const h=this._process&&this._process.get_Name();if(Object(Se.b)(h))throw new Error("BPF Flow Step On-Click Failure: null or undefined bpfDefinitionName: "+h);if(n.bpf_definition_name=h,Object(Se.b)(this._processInstanceName))throw new Error("BPF Flow Step On-Click Failure: null or undefined processInstanceName: "+this._processInstanceName);n.bpf_instance_name=this._processInstanceName;const p=e.selectedStage&&e.selectedStage.get_Description();if(Object(Se.b)(p))throw new Error("BPF Flow Step On-Click Failure: null or undefined flowStageName: "+p);n.bpf_flowstage_localized_name=p,n.bpf_flowstage_entity_name=i,n.bpf_flowstage_entity_collection_name=s;const m=this._formEntity&&this._formEntity.id;if(Object(Me.c)(m)||m===g.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty flowStageRecordId: "+m);n.bpf_flowstage_entity_record_id=g.a.toString(m);const b=g.a.tryParseOrNull(e.activeStage&&e.activeStage.get_Id()||"");if(Object(Me.c)(b)||b===g.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty activeStageId: "+b);n.bpf_activestage_id=g.a.toString(b);const f=e.activeStage&&e.activeStage.get_Description();if(Object(Se.b)(f))throw new Error("BPF Flow Step On-Click Failure: null or undefined activeStageName: "+f);return n.bpf_activestage_localized_name=f,n.bpf_activestageentity_name="processstage",n}_getLocalizedLabel(e){return Xrm.Utility.getResourceString("Main_system_library",e)}static getTelemetryParamsForFlowStep(e,t,r,n,a){const i=a||[],s={name:"flow_id",value:e},o={name:"environment_id",value:t},c={name:"flows_destination_url",value:r},l={name:"bpf_step_id",value:n};return i.push(s),i.push(o),i.push(c),i.push(l),i}static UpdateEventParameter(e,t,r){e&&0!==e.length&&e.some(e=>{if(e.name===t)return e.value=r,!0})}}var Le=r("Lyxw"),Be=r("7LBy"),Ve=r("ftQm"),Ge=r("2Ct/"),Ue=r("84PK"),Xe=r("Exmh"),ze=r("cfbi"),qe=r("pF61");var He=r("8O0c"),We=r("g6bs"),Ye=r("zmL5"),Qe=r("jq7Z"),Ke=r("xMtD"),Je=r("7Sr4"),Ze=r("1uZV"),$e=r("tICD"),et=r("E8F2"),tt=r("UqQu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const rt=i.a.createEvent("Initialize","BusinessProcessFlow.ProcessManager"),nt=i.a.createEvent("SetActiveStage","BusinessProcessFlow.ProcessManager"),at=i.a.createEvent("ValidateRequiredFields","BusinessProcessFlow.ProcessManager"),it=i.a.createEvent("CreateActiveStageSnapshot","BusinessProcessFlow.ProcessManager"),st=i.a.createEvent("SaveFormAndActiveStage","BusinessProcessFlow.ProcessManager");class ot{constructor(e,t,r,n,a){this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isUserSelectedStage=!1,this._isBpfFormValid=null,this._applicationContext=e,this._getState=t,this._dispatch=r,this._stageMetadata=n,this._activeStageManager=a}initilaizeWithProcessAndFormEntity(e,t,r,n,a,i){const s=rt.startStopwatch({processId:g.a.toString(n),processInstanceId:g.a.toString(a.id)});this._currentPageId=i,this._processId=n,this._version=t.businessProcessFlowProcessVersion,this._currentFormEntity=r,this._currentBpfInstance=a,this._stageMetadata.setPrimaryModel(this._currentFormEntity.etn),this._stageMetadata.setObjectModel(t);const o=this._createGlobalNavigationData(e);this._activeStageManager.InitGlobalPathAndActiveStage(o),this._stageMetadata.initializeDefaultPathManager(new V(this._activeStageManager),this),this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isBpfFormValid=null;const c={};if(this._isUserSelectedStage)c.selectedStageId=g.a.tryParseOrNull(this.getSelectedStageId());else{const e=this.getActiveStageId();this._isActiveStageInCurrentEntity(e)?c.selectedStageId=g.a.tryParseOrNull(e):c.selectedStageId=this._getDefaultSelectedStageId()||g.a.tryParseOrNull(e)}this._dispatch(Object(ee.a)(c,this._currentBpfInstance));const l=new be(g.a.toString(n),g.a.toString(a.id));this._applicationContext.EventManager.ReportEvent(l),this._savedPageId!==i&&(this._savedPageId=i,this.getScriptContainerPromise().then(e=>{e&&e.getEventManager().addOnProcessChangeEvent(this.getContextToken(),()=>{this._saveCrossEntityBpf()})})),Object(Ge.f)(this._getState())||this._updateProcessInstanceModifiedTime(),this._actionStepManager=new f(this._getState,n),this._flowStepManager=new Re(this._getState,this._applicationContext).setBpfInstance(this._currentBpfInstance).setProcess(this.getProcess()).setProcessId(this.getProcessId()).setFormEntity(this._currentFormEntity).setBpfInstanceName(this.getProcessInstanceName()),this._instanceModifiedTimestamp=Object(m.f)(this._getState(),this._currentFormEntity),this._instanceModifiedTimestamp||(this._instanceModifiedTimestamp=(new Date).getTime()),Object(Ge.f)(this._getState())&&Ve.a.Instance.setProcessManagerByPageId(this._currentPageId,this);const u=this.getTelemetryParams();if(!this._currentFormEntity){this._applicationContext.TraceManager.getTracer(Ae.g).error("ProcessManager is initialized with current entity as null",u)}Object(xe.c)(Ae.g,u,this._applicationContext),s()}_saveCrossEntityBpf(){const e=this._getState(),t=Object(s.g)(e,this._currentPageId),r=Object(Be.a)(t),n=Object(Be.b)(t);if(r&&n){const e=new J.a(t.data.parentrecordtype,new g.a(t.data.parentrecordid)),a=new J.a(t.entityTypeName,t.id);this._dispatch(Object(we.b)(r,a)),this._dispatch(Object(Fe.b)(n,a)),this.navigateToNextEntityForCrossEntityBpf(e,a,r,n)}}initilaizeWithFormEntityOnly(e,t){this._currentPageId=t,this._currentFormEntity=e,this._processId=null,this._version=-1,this._currentBpfInstance=null,this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isBpfFormValid=null,Object(Ge.f)(this._getState())||this._updateProcessInstanceModifiedTime(),Object(Ge.f)(this._getState())&&Ve.a.Instance.setProcessManagerByPageId(this._currentPageId,this);const r=this.getTelemetryParams();if(!this._currentFormEntity){this._applicationContext.TraceManager.getTracer(Ae.f).error("ProcessManager is initialized with current entity as null",r)}Object(xe.c)(Ae.f,r,this._applicationContext)}setActiveProcess(e){return new Promise((t,r)=>{const n=this.getTelemetryParams();if(!this.getCurrentFormEntity()){const e=new p.a("Current form entity is not initialized.",2147877745);return Object(xe.b)(Ae.m,e,null,n,this._applicationContext,null,this._getState()),void r(new p.a("Current form entity is not initialized",2147877745))}const a=g.a.tryParseOrNull(e);if(!a)return Object(xe.c)(Ae.m,n,this._applicationContext),void r(new Error("Invalid process id"));if(g.a.isNullOrEmpty(this.getCurrentFormEntity().id))return Object(xe.c)(Ae.m,n,this._applicationContext),void r(new p.a("Not supported on new records",2147877748));const i=new C({id:g.a.toString(this.getCurrentFormEntity().id),entityType:this.getCurrentFormEntity().etn},{id:g.a.toString(a),entityType:c.fc});this._dispatch(Object(P.b)(i)).then(()=>{this._executePostEvent("runOnProcessChange","setActiveProcess"),Object(xe.c)(Ae.m,n,this._applicationContext),t()},e=>{this._dispatch(Object(u.b)(e,!0)).then(()=>r(e)),Object(xe.b)(Ae.m,e,null,n,this._applicationContext,null,this._getState())})})}setActiveProcessInstance(e){return new Promise((t,r)=>{const n=this.getTelemetryParams();if(!this.getCurrentFormEntity()){const e=new p.a("Current form entity is not initialized.",2147877745);return Object(xe.b)(Ae.n,e,null,n,this._applicationContext,null,this._getState()),void r(new p.a("Current form entity is not initialized",2147877745))}const a=g.a.tryParseOrNull(e);a?this.getProcessInstances().then(e=>{if(!e||!e.value)return void r(new Error("No process instances found for current entity"));let n="";for(const t of e.value)if(t&&t.businessprocessflowinstanceid&&t.businessprocessflowinstanceid.toLowerCase()===g.a.toString(a).toLowerCase()){n=t["a_processid_value".substring(1)];break}if(Object(Se.b)(n))return void r(new p.a("Supplied process instance does not match any existing instance on this entity",2147877744));const i=g.a.tryParseOrNull(n);if(!i)return void r(new Error("Invalid process id"));const s=new j({id:g.a.toString(this.getCurrentFormEntity().id),entityType:this.getCurrentFormEntity().etn},{id:g.a.toString(i),entityType:c.fc},{id:g.a.toString(a),entityType:c.fc});this._dispatch(Object(P.b)(s)).then(()=>{this._executePostEvent("runOnProcessChange","setActiveProcessInstance"),t(n)},e=>{this._dispatch(Object(u.b)(e,!0)).then(()=>r(e))})},e=>{this._dispatch(Object(u.b)(e,!0)).then(()=>r(e))}):r(new Error("Invalid process instance id"))})}setCurrentInstance(e){this._currentBpfInstance=e}setStatus(e){return new Promise((t,r)=>{let n;if(e||r(new Error("setStatus can only be called with a valid status (active, finished, aborted")),e===B.a.Active)n=this.reactivateProcess();else if(e===B.a.Finished)n=this.completeProcess();else{if(e!==B.a.Aborted)return r(new Error("Invalid status passed to setStatus"));n=this.abandonProcess()}n.then(()=>{const r=new _e(g.a.toString(this._processId),g.a.toString(this.getProcessInstanceId()),e,this.getDisplayState());this._applicationContext.EventManager.ReportEvent(r),t()},e=>{r(e)})})}setVisible(e){if(Object(Se.a)(this._currentBpfInstance)||Object(Se.a)(this._currentFormEntity)||Object(Se.a)(this._currentFormEntity.etn))return;const t=Object(de.h)(this._currentFormEntity.etn);this._dispatch(Object(pe.b)(this._currentPageId,ve.a,t,!0===e)),this._updateProcessInstanceModifiedTime()}isVisible(){if(!this._currentBpfInstance)return!1;const e=Object(de.h)(this._currentFormEntity.etn);return!0===Object(y.G)(this._getState(),{id:this._currentPageId,controlName:ve.a},e)}getCurrentFormEntity(){return this._currentFormEntity}getActiveStageEntityRef(){const e=this._getStage(this.getActiveStageId()),t=e&&e.get_parent()&&e.get_parent().get_Name()||null,r=this._getNavigationEntityIdsByEntityLogicalName();return t&&r&&r.hasOwnProperty(t)?new J.a(t,r[t]):null}getProcess(){return this._currentBpfInstance&&this._stageMetadata.getProcessObjectModel()}getProcessInstanceName(){return this._currentBpfInstance&&Object(O.e)(this._getState(),this._currentBpfInstance)}getTraversedPath(){return Object(O.h)(this._getState(),this._currentBpfInstance)}getProcessId(){return this._processId}getVersion(){return this._version}getProcessInstanceId(){return this._currentBpfInstance&&this._currentBpfInstance.id}getBpfEntityLogicalName(){return this._currentBpfInstance&&this._currentBpfInstance.etn}getEntityStages(){return this._stageMetadata.getEntityStages()}getActiveStage(){return this._getStage(this.getActiveStageId())}getProcessInstances(){return new Promise((e,t)=>{var r,n;this._dispatch((r=this._currentFormEntity.id,n=this._currentFormEntity.etn,{type:"businessProcessFlow.retrieveProcessInstancesRequest.async",execute({dispatch:e,getState:t},a){const i=a.DataSource.get_WebAPIService(),s=new F(r,n),o=Object(w.a)(t(),s);return i.sendRequest(o).then(e=>e.json(),p.b)}})).then(t=>{e(t)},e=>{t(e)})})}getSelectedStage(){return this._getStage(this.getSelectedStageId())}isCrossEntityNavigation(e){const t=e?this._stageMetadata.getNextStageId(this.getActiveStageId()):this._stageMetadata.getPreviousStageId(this.getActiveStageId());if(!t)return!1;const r=this._stageMetadata.getStage(t);if(!r)return!1;const n=r.get_parent();return this._currentFormEntity&&this._currentFormEntity.etn&&n&&n.get_EntityLogicalName()!==this._currentFormEntity.etn}_isStageOnPath(e,t){for(const r of t)if(g.a.equals(r,e))return!0;return!1}getProcessState(){const e=Object(m.a)(this._getState(),this.getProcessId());return e?e.businessProcessFlowProcessState:null}getState(){if(this._currentBpfInstance){const e=Object(O.f)(this._getState(),this._currentBpfInstance);if(e){const t=parseInt(e.valueString,10);return isNaN(t)?null:t}}return null}getStatusName(){if(this._currentBpfInstance){const e=Object(O.g)(this._getState(),this._currentBpfInstance);if(e){return e.label}}return null}getStatus(){if(this._currentBpfInstance){const e=Object(O.g)(this._getState(),this._currentBpfInstance);if(e){const t=parseInt(e.valueString,10);return isNaN(t)?null:t}}return null}getActiveStageId(){if(this._currentBpfInstance){let e=this._currentBpfInstance&&Object(O.a)(this._getState(),this._currentBpfInstance);if(g.a.isNullOrEmpty(e)&&this._currentBpfInstance&&this._activeStageManager&&this._activeStageManager.globalPathAndActiveStage){const t=this._activeStageManager.globalPathAndActiveStage.stageId;t&&(e=g.a.tryParseOrNull(t))}if(!g.a.isNullOrEmpty(e)){const t=this.getActivePath();if(t&&t.length>0)return this._isStageOnPath(e,t)?e.guid:t[0].guid}}return null}getActivePathStages(){const e=this.getActivePath();if(e){const t=new Array(e.length);for(let r=0;r<e.length;r++)t[r]=this._getStage(e[r].guid);return t}return null}getActivePath(){if(!this._currentBpfInstance)return null;let e=Object(I.c)(this._getState(),this.getProcessInstanceId());return e||(e=this._getDefaultActivePath()),e}getDisplayState(){return this._currentBpfInstance?Object(I.d)(this._getState())||o.a.getDefaultDisplayState():null}getSelectedStageId(){if(!this._currentBpfInstance)return null;const e=Object(I.g)(this._getState(),this.getProcessInstanceId());return e?e.guid:this.getActiveStageId()}_getDefaultSelectedStageId(){if(!this._currentBpfInstance)return null;const e=Object(I.g)(this._getState(),g.a.EMPTY);return e&&!this._stageMetadata.getStage(e.guid)?null:e}_isActiveStageInCurrentEntity(e){try{return this._stageMetadata.getStage(e).get_parent().get_Name()===this._currentFormEntity.etn}catch(e){this._applicationContext.EventManager.ReportComponentFailure("ProcessManager._isActiveStageInCurrentEntity",e)}return!0}getStageMetadata(){return this._stageMetadata}isBusinessProcessAborted(){return this.getStatus()===B.a.Aborted}isBusinessProcessCompleted(){return this.getStatus()===B.a.Finished}moveToNextStage(){const e=this.getTelemetryParams(),t=new Promise((e,t)=>{if(Object(Se.a)(this._currentBpfInstance))return t(new p.a("Process Control does not exist on form.",2147877746));const r=this._stageMetadata.getNextStageId(this.getActiveStageId());if(!r)return void t(new H("Last stage in the active path reached. Next stage does not exist."));e(this._saveMainFormIfImmersiveBpfAndNewRecord().then(()=>this._saveFormDataAndActiveStage(g.a.tryParseOrNull(r),0,"MoveToNextStage")))});return t.then(()=>{Object(xe.c)(Ae.h,e,this._applicationContext)},t=>{this._shouldReportErrorAsSuccess(t)?Object(xe.c)(Ae.h,e,this._applicationContext):Object(xe.b)(Ae.h,t,null,e,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),t}moveToPreviousStage(){const e=this.getTelemetryParams(),t=new Promise((e,t)=>{if(Object(Se.a)(this._currentBpfInstance))return t(new p.a("Process Control does not exist on form.",2147877746));const r=this._stageMetadata.getPreviousStageId(this.getActiveStageId());if(!r)return t(new W("The first stage in the traversed path reached. Previous stage does not exist."));e(this._saveFormDataAndActiveStage(g.a.tryParseOrNull(r),1,"MoveToPreviousStage"))}).then(()=>{this._stageMetadata.getDefaultPathManager().triggerSubsequentDefaultPathCalculation(this.getActiveStageId())});return t.then(()=>{Object(xe.c)(Ae.i,e,this._applicationContext)},t=>{this._shouldReportErrorAsSuccess(t)?Object(xe.c)(Ae.i,e,this._applicationContext):Object(xe.b)(Ae.i,t,null,e,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),t}setActiveStage(e){const t=nt.startStopwatch({processId:g.a.toString(this.getProcessId()),processInstanceId:g.a.toString(this.getProcessInstanceId()),stageId:e}),r=this.getTelemetryParams(),n=new Promise((t,r)=>{const n=g.a.tryParseOrNull(e),a=this.getTraversedPath();if(Object(Se.a)(this._currentBpfInstance))return r(new p.a("Process Control does not exist on form.",2147877746));if(!n)return r(new X("setActiveStage can only be called with a valid stage id"));if(!this._stageMetadata.getStage(n.guid))return r(new X("stage id does not exist on any path of the instance"));if(!a)return r(new X("Traversed Path is not present"));if(this.getActiveStageId()===n.guid)return t();const i=new M.a(a);if(!i||!i.isInTraversedPath(e)){return r(this.getActivePath().some(e=>g.a.equals(e,n))?new X("The stage is not in traversed path. Only navigating backwards is supported."):new z("stage id does not exist on the current acitve path of the instance."))}t(this._saveFormDataAndActiveStage(n,1,"SetActiveStage"))}).then(()=>{const t=new fe(g.a.toString(this._processId),g.a.toString(this.getProcessInstanceId()),e);this._applicationContext.EventManager.ReportEvent(t),this._stageMetadata.getDefaultPathManager().triggerSubsequentDefaultPathCalculation(e)});return n.then(()=>{t(),Object(xe.c)(Ae.o,r,this._applicationContext)},e=>{t(),this._shouldReportErrorAsSuccess(e)?Object(xe.c)(Ae.o,r,this._applicationContext):Object(xe.b)(Ae.o,e,null,r,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),n}switchProcess(){}abandonProcess(){const e=this.getTelemetryParams(),t=new Promise((e,t)=>Object(Se.a)(this._currentBpfInstance)?t(new p.a("Process Control does not exist on form.",2147877746)):this.isBusinessProcessAborted()?e():void e(this._updateStateAndStatusOfProcess(B.a.Aborted,L.Inactive,"AbandonProcess")));return t.then(()=>{Object(xe.c)(Ae.a,e,this._applicationContext)},t=>{this._shouldReportErrorAsSuccess(t)?Object(xe.c)(Ae.a,e,this._applicationContext):Object(xe.b)(Ae.a,t,null,e,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),t}reactivateProcess(){const e=this.getTelemetryParams(),t=new Promise((e,t)=>Object(Se.a)(this._currentBpfInstance)?t(new p.a("Process Control does not exist on form.",2147877746)):this.getStatus()===B.a.Active?e():void e(this._updateStateAndStatusOfProcess(B.a.Active,L.Active,"ReactivateProcess")));return t.then(()=>{Object(xe.c)(Ae.j,e,this._applicationContext)},t=>{this._shouldReportErrorAsSuccess(t)?Object(xe.c)(Ae.j,e,this._applicationContext):Object(xe.b)(Ae.j,t,null,e,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),t}completeProcess(){const e=this.getTelemetryParams(),t=new Promise((e,t)=>Object(Se.a)(this._currentBpfInstance)?t(new p.a("Process Control does not exist on form.",2147877746)):this.isBusinessProcessCompleted()?e():g.a.tryParseOrNull(this._stageMetadata.getNextStageId(this.getActiveStageId()))?t(new p.a("Attempt to finish a process not on last stage.",2148081666)):void e(this._saveMainFormIfImmersiveBpfAndNewRecord().then(()=>this._updateStateAndStatusOfProcess(B.a.Finished,L.Inactive,"CompleteProcess"))));return t.then(()=>{Object(xe.c)(Ae.c,e,this._applicationContext)},t=>{this._shouldReportErrorAsSuccess(t)?Object(xe.c)(Ae.c,e,this._applicationContext):Object(xe.b)(Ae.c,t,null,e,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),t}_shouldReportErrorAsSuccess(e){return e instanceof Q||(e instanceof Y||(e instanceof H||(e instanceof W||(e instanceof X||(e instanceof z||e instanceof K)))))}triggerActionStepClick(e){if(Object(Se.b)(e)){const e=new Error("BPF Action Step Failure: null ControlId");throw Object(xe.b)(Ae.b,e,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),e}const t=this._actionStepManager.GetActionMetadata(e);if(Object(Se.a)(t)){const e=new Error("BPF Action Step Failure: null metadata");throw Object(xe.b)(Ae.b,e,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),e}const r=this._getState();if(Object(Se.a)(r)){const e=new Error("BPF Action Step Failure: null state");throw Object(xe.b)(Ae.b,e,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),e}let n=this._getTelemetryParamsForActionStep(t.actionType,e,t.actionId);try{const r=new g.a(t.actionId);if(t.actionType===Pe.AsyncWorkflow||t.actionType===Pe.SyncWorkflow){const a=["BusinessProcessFlowId","BusinessProcessFlowInstanceId","ActionStepId"],i=[this._processId.guid,g.a.toString(this.getProcessInstanceId()),r.guid].map(e=>{const t=new Ie;return t.Type="System.String",t.Value=e,t}),s=new Ce;s.Keys=a,s.Values=i,s.Count=3,s.IsReadOnly=!0;const o=new je;o.Arguments=s;const c=new Oe;c.EntityId=this._currentFormEntity.id,c.InputArguments=o,c.entity={id:t.workflowId,entityType:"workflow"},this.UpdateActionLog(r,1),this._dispatch(Object(P.b)(c)).then(()=>{Object(Te.a)(this._currentPageId,this.getContextToken(),e),this.UpdateActionLog(r,2,this._actionStepManager.GenerateMessageForAction(2)),Object(xe.c)(Ae.b,n,this._applicationContext)},t=>{Object(Te.a)(this._currentPageId,this.getContextToken(),e),this.UpdateActionLog(r,3,this._actionStepManager.GenerateMessageForAction(3)),Object(xe.b)(Ae.b,t,null,n,this._applicationContext,this.getCurrentFormEntity(),this._getState()),this._dispatch(Object(u.b)(t,!0)).then()})}else if(t.actionType===Pe.ProcessAction){const a=t=>{Object(Te.a)(this._currentPageId,this.getContextToken(),e),this.UpdateActionLog(r,3,this._actionStepManager.GenerateMessageForAction(3)),Object(xe.b)(Ae.b,t,null,n,this._applicationContext,this.getCurrentFormEntity(),this._getState()),this._dispatch(Object(u.b)(t,!0)).then()},i=a=>{Object(Te.a)(this._currentPageId,this.getContextToken(),e),this.UpdateActionLog(r,2,this._actionStepManager.GenerateMessageForAction(2));const i=a.get_outputParameters();t.outputBindings.forEach(e=>{if(e.parameterName in i){const t=i[e.parameterName],r=e.boundAttributeName,n={};n[r]={key:r,value:t},this._dispatch(Object(Ee.a)(this._currentPageId,n,!1,!0,this._currentFormEntity.etn,this._currentFormEntity.id.guid,null,this.getContextToken()))}}),Object(xe.c)(Ae.b,n,this._applicationContext)},s=n=>{if(n=n?n.parameters:{},this._filterInputArguments(n)){const e={id:g.a.toString(this.getCurrentFormEntity().id),entityType:this.getCurrentFormEntity().etn};n.Target=e,n.BusinessProcessFlowId=this._processId.guid,n.BusinessProcessFlowInstanceId=g.a.toString(this.getProcessInstanceId()),n.ActionStepId=t.actionId,this._actionStepManager.InvokeProcessAction(t.uniqueName,t,n).then(i,a)}else Object(Te.a)(this._currentPageId,this.getContextToken(),e),this.UpdateActionLog(r,3,this._actionStepManager.GenerateMessageForAction(3))},o={};t.inputBindings.forEach(e=>{const t=Object(D.c)(Object(le.j)(this._getState(),this.getCurrentFormEntity(),e.boundAttributeName));o["ProcessUnification_Arguments_"+e.parameterName]=t}),this._addInputParametersToParamList(t.inputParameters,o),this.UpdateActionLog(r,1),Xrm.Navigation.openDialog(t.workflowId,this._getDialogOptions(),o).then(s,a)}}catch(e){throw 0===n.length&&(n=this.getTelemetryParams()),Object(xe.b)(Ae.b,e,null,n,this._applicationContext,this.getCurrentFormEntity(),this._getState()),e}}triggerFlowStepClick(e,t){t=t;const r=Re.getTelemetryParamsForFlowStep(null,null,null,e,this.getTelemetryParams());try{const t=g.a.newGuid(),n={activeStage:this.getActiveStage(),selectedStage:this.getSelectedStage(),flowStepId:e,workflowLogId:t};this._flowStepManager.openFlowWidget(n,r),this.UpdateActionLog(new g.a(e),1,void 0,t);const a=this.getActionLog(new g.a(e));this.createWorkflowLogRecord(a),Object(xe.c)(Ae.d,r,this._applicationContext)}catch(e){Object(xe.b)(Ae.d,e,null,r,this._applicationContext,this.getCurrentFormEntity(),this._getState())}}refreshFlowStepClick(e){const t=Re.getTelemetryParamsForFlowStep(null,null,null,e,this.getTelemetryParams()),r=this._dispatch(Object(He.a)(this._processId,this._currentBpfInstance));Promise.resolve(r).then(()=>{this._updateProcessInstanceModifiedTime(),Object(xe.c)(Ae.k,t,this._applicationContext)}).catch(e=>{Object(xe.b)(Ae.k,e,null,t,this._applicationContext,this.getCurrentFormEntity(),this._getState())})}_addInputParametersToParamList(e,t){for(const r of Object.keys(e))"ProcessUnification_Arguments_"+e[r].parameterName in t||(t["ProcessUnification_Arguments_"+e[r].parameterName]=null)}_filterInputArguments(e){if(e&&"last_button_clicked"in e&&"ok_id"===e.last_button_clicked){const t="ProcessUnification_Arguments_";for(const r in e){const n=e[r];if(r.startsWith(t)){e[r.substring(t.length,r.length)]=n}delete e[r]}return!0}return!1}_getDialogOptions(){return{height:450,width:450,position:1}}_createSnapshotRequest(e,t){if(!e)throw new Error("Active stage cannot be null or undefined.");const r=new J.a("processstage",e),n=this._calculateNewTraversedPath(e),a={activestageid:{reference:r,timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:e.guid}},traversedpath:{value:n,timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:""}}};return this._addFieldsToBPFSnapshotForCreate(a,t)}_addFieldsToBPFSnapshotForCreate(e,t){if(!e||!this._hasBpfInstance())return e;const r=Object(We.b)(this._getState(),this._currentFormEntity.etn,this._currentBpfInstance.etn);return r&&(e[r.ReferencingAttribute]={reference:new J.a(this._currentFormEntity.etn,t),timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}}),e.processid={reference:new J.a("workflow",this.getProcessId()),timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}},e}generateBPFInstanceSnapshotId(){if(this.isImmersiveBPF()||!Object(Le.c)(this._getState(),"FCB.SplitBPFEntityAndParticipatingEntityCreates"))return null;let e=[],t=null;try{const r=Object(y.ac)(this._getState(),this._currentPageId,this.getContextToken()),n=Object(he.b)(this._getState(),r);let a=n.identifier&&n.identifier.id||this._currentFormEntity.id;const i=Object(s.g)(this._getState(),this._currentPageId);if(Object(We.e)(i))return Object(We.f)(this._getState(),r,a,this._dispatch),null;if(!this._hasBpfInstance()||g.a.isNullOrEmpty(this.getProcessId()))return null;if(e=this.getTelemetryParams(),Object(We.d)(this._getState(),n.identifier,this._currentPageId))return Object(We.f)(this._getState(),r,a,this._dispatch),null;g.a.isNullOrEmpty(a)&&(a=g.a.newGuid(),Object(We.f)(this._getState(),r,a,this._dispatch)),t=this._createActiveStageSnapshot(g.a.tryParse(this.getActiveStageId()),a);const o=Object(he.b)(this._getState(),t);e.push({name:"SnapshotId",value:t}),e.push({name:"Snapshot active changes",value:o&&o.activeChanges&&Object.keys(o.activeChanges).map(e=>"Property: "+e).join("; ")}),this._applicationContext.EventManager.ReportComponentSuccess("ProcessManager.generateBPFInstanceSnapshotId",e)}catch(t){this._applicationContext.EventManager.ReportComponentFailure("ProcessManager.generateBPFInstanceSnapshotId",t,null,e)}return t}_calculateNewTraversedPath(e){let t="";for(const r of this.getActivePath())if(t+=","+r.guid,g.a.equals(r,e))return t.substring(1);return t+=","+e.guid,t.substring(1)}_createActiveStageSnapshot(e,t){const r=this._createSnapshotRequest(e,t),n=it.startStopwatch({processId:g.a.toString(this.getProcessId()),processInstanceId:g.a.toString(this.getProcessInstanceId())});let a=Object(he.c)(this._getState(),this.getCurrentFormEntity());if(this.isImmersiveBPF()&&!Object(Se.a)(a)){const e=Object(ie.b)(this._getState(),a.snapshotId,r);return this._dispatch(e),a=Object(he.c)(this._getState(),this.getCurrentFormEntity()),n(),a.snapshotId}const i=Object(de.h)(this._currentFormEntity.etn),s=Object(de.x)(i),o=Object(ae.b)(this._getState(),this._currentBpfInstance,r,s,this._hasBpfInstance()?ue.a.Create:ue.a.Update),c=o.payload.snapshotId;return this._dispatch(o),n(),c}_hasBpfInstance(){return!this._currentBpfInstance||g.a.isNullOrEmpty(this._currentBpfInstance.id)}_updateStateAndStatusOfProcess(e,t,r){return new Promise((n,a)=>{const i=this._createStatusAndStateUpdateRequest(e,t);let s=Object(he.c)(this._getState(),this.getCurrentFormEntity()),o=null;if(this.isImmersiveBPF()&&!Object(Se.a)(s)){const e=Object(ie.b)(this._getState(),s.snapshotId,i);this._dispatch(e),s=Object(he.c)(this._getState(),this.getCurrentFormEntity())}else{const e=Object(de.h)(this.getCurrentFormEntity().etn),t=Object(de.x)(e),r=Object(ae.b)(this._getState(),this._currentBpfInstance,i,t);o=r.payload.snapshotId,this._dispatch(r)}if(!this.executePreEvent("runOnPreProcessStatusChange",r,null,e))if(this._shouldPerformFormSave()){const t=this._validateSnapshot(s).then(()=>this._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(r)).then(()=>this._saveFormEntityAndBPFEntitySnapshots(o,s,!1)).then(()=>{this._executePostEvent("runOnProcessStatusChange",r,null,e)}).catch(e=>{const t=Object(p.c)(e);return this._handleDuplicateDetection(t,o)}).catch(e=>{throw this._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(e),e}).catch(e=>{this._dispatch(Object(u.b)(e,!0)).then(()=>a(e))});n(t)}else this._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(r).then(()=>{let t=null;t=this.isImmersiveBPF()&&!Object(Se.a)(s)?s.snapshotId:o;this._dispatch(Object(oe.c)(t,!0,["statuscode","statecode","activestagestartedon","completedon"])).then(()=>{this._dispatch(Object(ce.a)(this._currentPageId,this.getCurrentFormEntity(),this._getColumnsToRefresh())).then(()=>{this._updateProcessInstanceModifiedTime(),this._executePostEvent("runOnProcessStatusChange",r,null,e)}),n()}).catch(e=>{this._dispatch(Object(u.b)(e,!0)).then(()=>a(e))})});n()})}_validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(e){return new Promise((t,r)=>{if("CompleteProcess"===e||"MoveToNextStage"===e){const t=this.ValidateRequiredFieldsForNavigation();if(t&&!t.isValid)if("MoveToNextStage"===e)r(new Y("Unable to navigate to next stage as required fields have not been set"));else{if("CompleteProcess"===e)return r(new Y("Unable to complete process as required fields have not been set"));r(new Error("validation failed for unexpected BPF operation: "+e))}}return t()})}_saveFormChangesBeforeNavigation(){if(this._shouldPerformFormSave()){const e=Object(he.c)(this._getState(),this.getCurrentFormEntity());return this._validateSnapshot(e).then(()=>this._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures("MoveToNextStage")).then(()=>{const t=this._getColumnsToRefresh();return this._dispatch(Object(oe.c)(e.snapshotId,!0,t))}).catch(t=>(this._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(t,e.snapshotId),this._dispatch(Object(u.b)(t,!0))))}return Promise.resolve()}_shouldPerformFormSave(){const e=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ShouldPerformFormSave"),t=this.getTelemetryParams(),r=this._getState();if(Object(y.kb)(r,{id:this._currentPageId},this.getContextToken()))return e.info("Skip main form save for BPF state or stage change due to read only form",t),!1;const n=this._dispatch(Object(ke.b)(this._currentPageId,this.getContextToken()));if(n&&n.data&&n.data.getIsDirty){const r=n.data.getIsDirty(),a={name:"shouldPerformMainFormSave",value:r};return t.push(a),e.info("Checking if main form save should be performed due to dirty form",t),r}return e.error("Unable to determine dirty state of main form - skipping save of main form",t),!1}_saveMainFormIfImmersiveBpfAndNewRecord(){const e=Object(s.l)(this._getState(),this._currentPageId);if(this.isImmersiveBPF()&&e===ze.a&&g.a.isNullOrEmpty(this.getCurrentFormEntity().id)){const t=1;return this._dispatch(Object(l.f)(this._currentPageId,e,!1,t,!1,!1)).then(e=>{this._currentFormEntity=e})}return Promise.resolve(void 0)}_validateSnapshot(e){return new Promise((t,r)=>{const n=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SnapshotValidation"),a=this._getSnapshotStateTelemetryParams(e),i=this._currentPageId,s=this.getContextToken();this._dispatch(this._getEventManager().runOnSave(s,1))&&(this._dispatch(Object(d.b)(i,s,2)),this._dispatch(Object(h.b)(i,s,!1)),n.warn("BPF ProcessManager: Unable to save form data due to web resource registered onSave invoking preventDefault",a),r(new p.a("Unable to save form data due to web resource registered onSave invoking preventDefault",2147877737)));for(const t in e.activeChanges){const i=e.activeChanges[t],s=this._applicationContext.DataSource.get_MetadataCache().getAttributeMetadata(e.identifier.etn,t),o=Object(Se.a)(s)?null:s.get_logicalName(),c=Object(Se.a)(s)?Ue.a.get_empty():s.get_id();if(Object(Se.a)(i))return n.error("BPF ProcessManager: unexpected null or undefined fieldValue for attribute "+o+" with ID: "+c,a),r(new Error("Internal Client Error - null fieldValue"));const l=i.validationResult;if(Object(Se.a)(l)){if(o===De.c){n.info("BPF ProcessManager: skipping formEntitySnapshot validation for atttribute: "+o+" with ID: "+c,a);continue}return n.error("BPF ProcessManager: unexpected null or undefined validationResult for atttribute: "+o+" with ID: "+c,a),r(new Error("Internal Client Error - null validatorResult"))}const u=l.isValueValid;if(Object(Se.a)(u))return n.error("BPF ProcessManager: unexpected null or undefined validationResult.isValidValue for atttribute: "+o+" with ID: "+c,a),r(new Error("Internal Client Error - null validationResult.isValidValue"));if(!u){const e={name:Ae.q,value:"clientSideCurrentForm"};return a.push(e),n.warn("BPF ProcessManager: unable to save form due to invalid value for attribute: "+o+" with ID: "+c,a),r(new q("Unable to save form data due to validation errors"))}}return t(!0)})}_createStatusAndStateUpdateRequest(e,t){return{statuscode:{label:B.a[e],valueString:e.toString(),timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null}},statecode:{label:L[t],valueString:t.toString(),timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null}}}}ValidateRequiredFieldsForNavigation(){const e=at.startStopwatch({processId:g.a.toString(this.getProcessId()),processInstanceId:g.a.toString(this.getProcessInstanceId())}),t=this._getState(),r=this._stageMetadata.getRequiredAttributesForStage(this.getActiveStageId(),this._currentPageId,this.getContextToken(),t),n=this._stageMetadata.getRequiredFlowStepsForStage(this.getActiveStageId(),this._currentPageId,this.getContextToken(),t),a={emptySteps:[],errorSteps:[]},i=Object(he.c)(this._getState(),this.getCurrentFormEntity()),o=this._getSnapshotStateTelemetryParams(i),c=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SnapshotValidation");for(const e of r){c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: validating attribute: "+e,o);let t=Object(le.j)(this._getState(),this.getCurrentFormEntity(),e);i&&i.activeChanges&&e in i.activeChanges&&(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: fieldIsDirty: "+e,o),t=i.activeChanges[e]);Object(I.h)(t,this._getState(),this.getCurrentFormEntity().etn,e)?(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: emptyField: "+e,o),a.emptySteps.push(e)):t.validationResult.isValueValid||(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: !fieldValue.validationResult.isValueValid: "+e,o),a.errorSteps.push(e))}for(const e of n){const t=g.a.tryParse(e);if(g.a.isNullOrEmpty(t)){c.error("BPF ProcessManager ValidateRequiredFieldsForNavigation: invalid Flow Step ID GUID: "+e,o);continue}const r=this.getActionLog(t);if(r){const t=r.status;2!==t&&(c.info("BPF ProcessManager ValidateRequiredFieldsForNavigation: Required Flow Step not completed for stepId "+e+". The Flow Step Action Log has stauts of : "+t,o),a.errorSteps.push(e))}else c.info("BPF ProcessManager ValidateRequiredFieldsForNavigation: Required Flow Step not completed for stepId "+e+". No action logs were found for this Flow Step",o),a.errorSteps.push(e)}a.isValid=0===a.emptySteps.length&&0===a.errorSteps.length;const u=Object(Qe.a)(t,this._currentPageId);if(!Object(y.Gb)(u,t,this._currentPageId,this.getContextToken())){c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: form is not valid - "+this._currentPageId,o);const e=Object(s.l)(this._getState(),this._currentPageId);this._dispatch(Object(l.f)(this._currentPageId,e,!1,1,!1,!1)),a.isValid=!1}if(!a.isValid){const e=String.format("BPF ProcessManager: ValidateRequiredFieldsForNavigation returned invalid");c.warn(e,o)}return e(),a}setSelectedStage(e,t=!1){return new Promise((r,n)=>{const a=g.a.tryParseOrNull(e);if(!a)return n("setSelectedStage can only be called with a valid stage id");const i={selectedStageId:a};this._updateBusinessProcessFlowData(this._currentBpfInstance,i),this._isUserSelectedStage=t,t&&this._executePostEvent("runOnStageSelected","setSelectedStage"),r()})}setDisplayState(e){if(this._currentBpfInstance&&(e===o.a.collapsed||e===o.a.expanded||e===o.a.floating)){this._updateDisplayState(this._currentBpfInstance,e);const t=new ye(g.a.toString(this._processId),g.a.toString(this.getProcessInstanceId()),e);this._applicationContext.EventManager.ReportEvent(t)}}setActivePath(e){if(!e||0===e.length)return;const t=[];for(let r=0;r<e.length;r++)t[r]=new g.a(e[r]);const r={activePath:t};this._updateBusinessProcessFlowData(this._currentBpfInstance,r)}setBpfNavigationBehavior(e){const t={processNavigationBehavior:{navigationBehavior:e,navigationBehaviorPageId:this._currentPageId}};this._updateBusinessProcessFlowData(this._currentBpfInstance,t)}getBpfNavigationBehavior(){return this._currentBpfInstance&&Object(I.e)(this._getState(),this.getProcessInstanceId())}shouldReInitializeNavigationBehavior(){return!(!this._currentBpfInstance||!(null==this.getBpfNavigationBehavior()&&Object(Se.a)(Object(I.b)(this._getState(),this.getProcessInstanceId()))||Object(I.f)(this._getState(),this.getProcessInstanceId())!==this._currentPageId))}getBpfNavigationBehaviorAllowCreateNew(e){const t=this._currentBpfInstance&&Object(I.b)(this._getState(),this.getProcessInstanceId());return!t||!e||t(e)}createWorkflowLogRecord(e){if(Object(Se.a)(e))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined actionLog");const t=this._getState();if(Object(Se.a)(t))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined state");const r=t.metadata;if(Object(Se.a)(r))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined metadata");const n=r.entities;if(Object(Se.a)(n))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined entities");const a=this._currentBpfInstance.etn;if(Object(Se.b)(a))throw new Error("BPF Create WorkflowLog Record Failure: null or empty entityLogicalName");const i=n[a];if(Object(Se.a)(i))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined bpfEntity");const s=i.EntitySetName;if(Object(Se.b)(s))throw new Error("BPF Create WorkflowLog Record Failure: null or empty entitySetName");const o=Object(Ne.z)(t,"workflowlog",i.EntityLogicalName,"asyncoperationid");if(Object(Se.a)(o))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined relationshipMetadata");if(Object(Se.b)(o.ReferencingEntityNavigationPropertyName))throw new Error("BPF Create WorkflowLog Record Failure: null or empty relationshipMetadata.ReferencingEntityNavigationPropertyName");const c=o.ReferencingEntityNavigationPropertyName+"@odata.bind",l="/"+s+"("+e.processInstanceid.guid+")",u={workflowlogid:e.actionLogId.guid,stepname:e.stepId.guid,[c]:l,activityname:e.processDefinitionid.guid,status:e.status};Xrm.WebApi.createRecord("workflowlog",u)}_getTracer(){return Object(Se.a)(this._applicationContext)||Object(Se.a)(this._applicationContext.TraceManager)?null:this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ProcessManager")}_getDefaultActivePath(){const e=this._getTracer();if(Object(Se.a)(this._stageMetadata))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined _stageMetadata"),null;const t=this._stageMetadata.getDefaultPathManager();if(Object(Se.a)(t))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined defaultPathManager"),null;const r=t.getDefaultPath();if(Object(Se.a)(r))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined stringPath"),null;const n=[];for(const e in r){const t=g.a.parse(r[e]);n.push(t)}return n}_updateBusinessProcessFlowData(e,t){e&&(this._dispatch(Object(ee.a)(t,e)),this._updateProcessInstanceModifiedTime())}_updateDisplayState(e,t){this._dispatch(Object(te.a)(t,e)),this._updateProcessInstanceModifiedTime()}getForwardNavigationEntities(e,t,r,n){return this._saveFormChangesBeforeNavigation().then(()=>this._dispatch(v(e,t,r,n||null)))}navigateToNextEntity(e,t,r,n){return new Promise((a,i)=>{const s=this.ValidateRequiredFieldsForNavigation();if(s&&!s.isValid)return i(new Y("Unable to navigate to next stage as required fields have not been set"));const o=this._stageMetadata.getNextStageId(this.getActiveStageId());if(!o)return i(new H("Last stage in the active path reached. Next stage does not exist."));const c=new g.a(o),l=this.getTraversedPath()+","+o;return this._saveFormChangesBeforeNavigation().then(()=>this._dispatch(E(e,t,c,l,r,n))).then(()=>this.setSelectedStage(o)).then(()=>{this._executePostEvent("runOnStageChange","navigateToNextEntity",0),a()}).catch(e=>{this._dispatch(Object(u.b)(e,!0)).then(()=>i(e))})})}navigateToNextEntityForCrossEntityBpf(e,t,r,n){return new Promise((a,i)=>{this._dispatch(E(e,t,new g.a(this.getActiveStageId()),this.getTraversedPath(),r,n)).then(()=>{this._dispatch(Object(ne.b)(t,this._currentBpfInstance)),this._executePostEvent("runOnStageChange","navigateToNextEntityForCrossEntityBpf",0),a()}).catch(e=>{this._dispatch(Object(u.b)(e,!0)).then(()=>i(e))})})}getActiveStageActiveFor(){if(this._currentBpfInstance){const e=Object(O.b)(this._getState(),this._currentBpfInstance);if(e){return(new Date).valueOf()-e.valueOf()}}return null}getBpfInstanceActiveFor(){if(this._currentBpfInstance){const e=Object(O.d)(this._getState(),this._currentBpfInstance);if(e)return(new Date).valueOf()-e.valueOf()}return null}getBpfInstanceCompletedIn(){if(this._currentBpfInstance){const e=Object(O.d)(this._getState(),this._currentBpfInstance),t=Object(O.c)(this._getState(),this._currentBpfInstance);if(t&&e)return t.valueOf()-e.valueOf()}return null}getActionLogCollection(){return this._currentBpfInstance?Object(I.a)(this._getState(),this.getProcessInstanceId()):null}getActionLog(e){const t=this.getActionLogCollection();return t&&t[e.guid]?t[e.guid]:null}UpdateActionLog(e,t,r,n){if(!this._currentBpfInstance)return null;const a=Object(I.a)(this._getState(),this.getProcessInstanceId()),i=a&&a[e.guid]?a[e.guid]:null;let s=g.a.EMPTY;s=Object(Se.a)(n)||n===g.a.EMPTY?i?i.actionLogId:g.a.newGuid():n;const o={actionLogId:s,status:t,modifiedOn:(new Date).toLocaleString(),stepId:e,processDefinitionid:this._processId,processInstanceid:this.getProcessInstanceId(),message:r},c=Object.assign({},a);c[e.guid]=o;const l={actionLogCollection:c};return this._updateBusinessProcessFlowData(this._currentBpfInstance,l),"success"}getEnabledProcesses(){const e=[];return new Promise((t,r)=>{var n;this._currentFormEntity&&this._currentFormEntity.etn?this._dispatch((n=this._currentFormEntity.etn,{type:"businessProcessFlow.retrieveFilteredProcesses.async",execute({dispatch:e,getState:t},r){const a=r.DataSource.get_WebAPIService(),i=t(),s=g.a.tryParse(Object(A.i)(i)),o=new x(n,s),c=Object(w.a)(t(),o);return a.sendRequest(c).then(e=>e.json(),p.b)}})).then(r=>{for(const t of r.value)e.push(new N(t.name,t.uniquename,t.workflowid));t(e)},e=>{r(e)}):r(new p.a("Current Form Entity cannot be NULL",2147877745))})}getNavigationEntities(){return this._activeStageManager.navigationEntities}_getNavigationEntityIdsByEntityLogicalName(){return this._activeStageManager.navigationEntityIdsByEntityLogicalName}_updateGlobalActiveStage(e,t){this._activeStageManager.UpdateGlobalPathAndActiveStage(e,t)}_createGlobalNavigationData(e){const t=new k,r=Object(D.b)(e.activestageid);t.activeStageId=g.a.toString(r);let n=Object(D.c)(e.traversedpath);Object(Se.b)(n)&&(n=M.a.getCandidateTraversedPathFromStagStep(this._stageMetadata.businessProcessFlowVisitor.get_stages(),t.activeStageId)),t.traversedPath=n,t.navigationEntities=[];const a=this._getNavigationEntityTypesFromWorkflowObjectModel();for(const r of a){const n=new R;n.entityLogicalName=r,n.id=g.a.EMPTY.guid;for(const t in e)if(Object(D.k)(e[t])){const a=e[t],i=[],s="NULL";if(Object(Se.a)(a.reference)||Object(Se.a)(a.reference.etn)){i.push({name:"entityReference.reference",value:s});this._applicationContext.TraceManager.getTracer("CreateGlobalNavigationData").info("Navigation entity should not be null .",i)}a&&a.reference&&a.reference.etn===r&&(n.id=a.reference.id.guid)}t.navigationEntities.push(n)}e.hasOwnProperty("businessprocessflowinstanceid")&&(t.businessProcessInstanceId=Object(D.c)(e.businessprocessflowinstanceid));e.hasOwnProperty("name")&&(t.businessProcessInstanceName=Object(D.c)(e.name));e.hasOwnProperty("statecode")&&(t.businessProcessState=Object(D.c)(e.statecode));e.hasOwnProperty("statuscode")&&(t.businessProcessStatus=Object(D.c)(e.statuscode));return e.hasOwnProperty("bpfDefinitionVersioNumber")&&(t.bpfDefinitionVersionNumber=Object(D.c)(e.bpfDefinitionVersioNumber)),t}_getNavigationEntityTypesFromWorkflowObjectModel(){const e={};if(!Object(Se.a)(this.getProcess()))for(let t=0;t<this.getProcess().get_Steps().get_Count();t++){const r=this.getProcess().get_Steps().get_item(t);if(!(r instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep))continue;const n=r.get_Description();e[n]||(e[n]=n)}return Object.keys(e)}reflow(e,t,r){const n=this._stageMetadata.getDefaultPathManager();if(!t&&!r)return void this._reflowInternal();if(!t)return;t=new g.a(t).guid;const a=this.getTraversedPath(),i=this.getActiveStageId();a&&i&&(i===t||a.indexOf(t)<0)&&(n.updateDefaultPath(t,r),this._updateProcessInstanceModifiedTime())}_reflowInternal(e,t){const r=this._stageMetadata.getDefaultPathManager();e||t||(t=this.getActiveStageId(),e=this._stageMetadata.getPreviousStageId(t)),e&&(r.updateDefaultPath(e,t),this._updateProcessInstanceModifiedTime())}callPblToEvaluateBranching(e){const t=this._getState();if(!this._currentPageId)throw new Error("The current page Id should not be null when callPblToEvaluateBranching has been called. Because the reflow logic should be triggered for a particular page.");const r=Object(Z.a)(t,this._currentPageId);this.getScriptContainerPromise().then(t=>{r<$.a.EditReady&&t.getEventManager().addOnLoadEvent(this.getContextToken(),()=>{t.execute(e,[])}),r>=$.a.OnLoadReady&&t.execute(e,[])})}update(e){!Object(Se.a)(this._currentBpfInstance)&&this._isSelectedStageControl(e.Id)&&this._updateProcessInstanceModifiedTime()}waitForOngoingWork(){return Je.a.getInstance().checkForOutstandingWork(this._getState())}_getEventManager(){const e=this.getScriptContainer();return e?e.getEventManager():null}getScriptContainer(){if(!this._applicationContext||!this._applicationContext.ScriptManager)return null;let e=null;try{e=this._applicationContext.ScriptManager.getContainer(this._currentPageId)}catch(e){this._logTraceFailureForScriptContainer()}return e}getScriptContainerPromise(){return this._applicationContext&&this._applicationContext.ScriptManager?this._applicationContext.ScriptManager.initializeContainer(this._currentPageId):Promise.reject("The current container should be created before invoking handlers.")}_executePostEvent(e,t,r=null,n=null){if(Object(qe.n)(this._getState(),this._currentPageId)||!this._getEventManager())this._logTraceFailureForProcessEvent(t,e,e);else switch(e){case"runOnProcessChange":this._dispatch(this._getEventManager().runOnProcessChange(this.getContextToken(),this));break;case"runOnProcessStatusChange":this._dispatch(this._getEventManager().runOnProcessStatusChange(this.getContextToken(),B.a[n],this));break;case"runOnStageChange":this._dispatch(this._getEventManager().runOnStageChange(this.getContextToken(),this,r));break;case"runOnStageSelected":this._dispatch(this._getEventManager().runOnStageSelected(this.getContextToken(),this))}}executePreEvent(e,t,r=null,n=null){let a=!1;if(!Object(qe.n)(this._getState(),this._currentPageId)&&this._getEventManager()){switch(e){case"runOnPreProcessStatusChange":a=this._dispatch(this._getEventManager().runOnPreProcessStatusChange(this.getContextToken(),B.a[n],this));break;case"runOnPreStageChange":a=this._dispatch(this._getEventManager().runOnPreStageChange(this.getContextToken(),this,r))}return this._logTraceInfoForProcessPreEvent(a,e,t,t),a}return this._logTraceFailureForProcessEvent(t,e,e),a}_saveFormDataAndActiveStage(e,t,r){const n=st.startStopwatch({processId:g.a.toString(this.getProcessId()),processInstanceId:g.a.toString(this.getProcessInstanceId())}),a=this.executePreEvent("runOnPreStageChange",r,t),i=Object(he.c)(this._getState(),this.getCurrentFormEntity());if(!a){const n=new Promise((t,n)=>{if(!e)return n(new X("Attemping to save invalid stage id"));const a=["traversedpath","activestageid","activestagestartedon","completedon"],s=this.getNavigationEntities(),o=Object(m.b)(this._getState(),this._currentBpfInstance);for(const e of s)for(const t in o)if(t.includes(e.entityLogicalName)){a.push(t);break}let c,l;if(this._shouldPerformFormSave()){const t=this._getState();c=this._validateSnapshot(i).then(()=>this._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(r)).then(()=>(l=this._createActiveStageSnapshot(e),this._saveFormEntityAndBPFEntitySnapshots(l,i,!1))).then(()=>{const e=this.getCurrentFormEntity();this._dispatch(Object(tt.a)(this._currentPageId,t,this.getContextToken(),e.etn,e.id))}).catch(e=>{const t=Object(p.c)(e);return this._handleDuplicateDetection(t,l)})}else c=this._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(r).then(()=>(l=this._createActiveStageSnapshot(e),this._dispatch(Object(oe.c)(l,!0,a,this._getRetrieveProcessControlDataRequest())).then(()=>{this._dispatch(Object(ce.a)(this._currentPageId,this.getCurrentFormEntity(),this._getColumnsToRefresh(),this._getRetrieveProcessControlDataRequest())),this._dispatch(Object(S.b)(!0,this._currentFormEntity))})));t(c)}).then(()=>{const e=this.getTraversedPath(),n=this.getActiveStageId();this._updateGlobalActiveStage(e,n),this.setSelectedStage(n),this._executePostEvent("runOnStageChange",r,t)},e=>{throw this._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(e),e});return n.then(s,s),n}function s(){n()}}_handleDuplicateDetection(e,t){if(Object(et.e)(e)){return this._dispatch(Object(Ze.a)(this._currentPageId,e,this._currentFormEntity)).then(e=>0===e.status?this._dispatch(Object($e.a)(e.pageId)).then(e=>e.value.param_lastButtonClicked===l.a?Promise.resolve("success"):Promise.resolve("aborted")):Promise.resolve("noop")).then(e=>{if("success"===e){const e=Object(he.c)(this._getState(),this.getCurrentFormEntity());return this._saveFormEntityAndBPFEntitySnapshots(t,e,!0)}})}throw e}_saveFormEntityAndBPFEntitySnapshots(e,t,r){const n={};n[t.identifier.etn]=this._getColumnsToRefresh();let a=null;return a=this.isImmersiveBPF()?[t.snapshotId]:[t.snapshotId,e],this._dispatch(Object(oe.d)(a,r,n,this._getRetrieveProcessControlDataRequest()))}_logTraceInfoForProcessPreEvent(e,t,r,n){const a=this._applicationContext.TraceManager.getTracer(n),i=this.getTelemetryParams(),s={name:"BpfOperationName",value:r};i.push(s);const o={name:"eventName",value:t};i.push(o);const c={name:"preventDefaultInvokedByWebResource",value:e};i.push(c),a.info("BPF ProcessManager executed scripts registered to event "+t,i)}_logTraceFailureForProcessEvent(e,t,r){const n=this._applicationContext.TraceManager.getTracer(r),a=this.getTelemetryParams(),i={name:"BpfOperationName",value:e};a.push(i);a.push({name:"preventDefaultInvokedByWebResource",value:null});const s={name:"eventName",value:t};a.push(s);const o={name:"isPageDead",value:Object(qe.n)(this._getState(),this._currentPageId)};a.push(o);const c={name:"currentPageId",value:this._currentPageId};a.push(c),n.error(`BPF ProcessManager not able to to execute scripts registered on event ${t} does not exist`,a)}_logTraceFailureForScriptContainer(){const e=this._applicationContext.TraceManager.getTracer("GET_SCRIPT_CONTAINER"),t=this.getTelemetryParams();t.push({name:"BpfOperationName",value:"GetScriptContainer"});const r={name:"IsPageDead",value:Object(qe.n)(this._getState(),this._currentPageId)};t.push(r);t.push({name:"IsSciptContainerAvailable",value:!1}),e.error("BPF ProcessManager not able to to execute scripts as the script container does not exist",t)}_getStage(e){let t=null;if(e){const r=this.getEntityStages();r&&r.some(r=>{for(let n=0;n<r.get_Steps().get_Count();n++){const a=r.get_Steps().get_item(n);if(this._equalsIgnoreCase(e,a.get_Id()))return t=a,!0}})}return t}getContextToken(){return Object(de.j)(this._getState(),this._currentPageId)}_updateProcessInstanceModifiedTime(){this._dispatch(Object(re.b)(this.getCurrentFormEntity()))}_isSelectedStageControl(e){if(!Object(Se.a)(this.getSelectedStage())){const t=this.getSelectedStage().get_Steps();for(let r=0;r<t.get_Count();r++)if(this._equalsIgnoreCase(t.get_item(r).get_Id(),e))return!0}return!1}_equalsIgnoreCase(e,t){return!!e&&!!t&&e.toUpperCase()===t.toUpperCase()}_getSnapshotStateTelemetryParams(e){const t=[];if(Object(Se.a)(e))return t;const r={name:"mode",value:e.mode},n={name:"identifierId",value:Object(Se.a)(e.identifier)||Object(Se.a)(e.identifier.id)?null:g.a.toString(e.identifier.id)},a=this._applicationContext.DataSource.get_MetadataCache().getEntityMetadata(e.identifier.etn),i={name:"identifierEntityId",value:Object(Se.a)(a)?null:g.a.fromLegacyGuid(a.get_id()).guid},s={name:"identifierEntityObjectTypeCode",value:Object(Se.a)(a)?null:a.get_objectTypeCode()},o={name:"activeChanges",value:Object(Se.a)(a)?null:this._getIFieldValuesString(e.activeChanges,a.get_logicalName())},c={name:"lockedChanges",value:Object(Se.a)(a)?null:this._getIFieldValuesString(e.lockedChanges,a.get_logicalName())};return t.push(r),t.push(i),t.push(s),t.push(n),t.push(o),t.push(c),t}_getTelemetryParamsForActionStep(e,t,r){const n=this.getTelemetryParams(),a={name:"ActionStepType",value:e},i={name:"ControlId",value:t},s={name:"ActionStepId",value:r};return n.push(a),n.push(i),n.push(s),n}getTelemetryParams(){const e=[];try{const t={name:"ProcessId",value:g.a.toString(this.getProcessId())},r={name:"ProcessInstanceId",value:g.a.toString(this.getProcessInstanceId())},n={name:"ActiveStageId",value:this.getActiveStageId()},a={name:"SelectedStageId",value:this.getSelectedStageId()},i={name:"TraversedPath",value:this.getTraversedPath()},o={name:"ActivePath",value:this._getActivePathString()},c={name:"CurrentFormEntityType",value:this.getCurrentFormEntity()&&this.getCurrentFormEntity().etn?this.getCurrentFormEntity().etn:""},l={name:"CurrentFormEntityId",value:this.getCurrentFormEntity()&&this.getCurrentFormEntity().id?g.a.toString(this.getCurrentFormEntity().id):""},u={name:"ProcessState",value:this.getProcessState()},d={name:"PageId",value:this._currentPageId},h={name:"PageType",value:Object(s.l)(this._getState(),this._currentPageId)},p={name:"SavedPageId",value:this._savedPageId},m={name:"SavedPageType",value:Object(s.l)(this._getState(),this._savedPageId)};if(Object(Le.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){const t={name:"CustomControlsPresent",value:this.getCustomControlIndicator()},r={name:"RenderedFromFormXML",value:this.getFormXmlRenderingIndicator()};e.push(t),e.push(r)}const b={name:"IsImmersiveBPF",value:this.isImmersiveBPF()};e.push(t),e.push(r),e.push(n),e.push(i),e.push(o),e.push(a),e.push(c),e.push(l),e.push(u),e.push(d),e.push(h),e.push(p),e.push(m),e.push(b)}catch(t){this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ProcessManagerTelemetryGeneration").error("Exception while generating Process Manager telemetry parameters: "+t.message,e)}return e}_getIFieldValuesString(e,t){let r="";if(!Object(Se.a)(e))for(const n in e)if(Object(Se.a)(n))r+=String.format("[fieldName: {0}]",null);else{const a=this._applicationContext.DataSource.get_MetadataCache().getAttributeMetadata(t,n),i=e[n];if(Object(Se.a)(i)||Object(Se.a)(a))r+=String.format("[attributeId is null: {0}, attributeMetadata is null: {1}]",Object(Se.a)(i),Object(Se.a)(a));else{let e="";Object(Se.a)(i.timestamp)||(e=i.timestamp.toUTCString());let t="",n="",s=null,o=null;Object(Se.a)(i.validationResult)||(t=i.validationResult.errorId,n=i.validationResult.errorMessage,s=i.validationResult.isOfflineSyncError,o=i.validationResult.isValueValid);const c=a.get_id();r+=String.format("[attributeId: {0}, timeStamp: {1}, validationResultErrorId: {2}, validationResultErrorMessage: {3}, validationResultIsOfflineSyncError: {4}, validationResultIsValueValid: {5}]",c,e,t,n,s,o)}}return r}_getActivePathString(){const e=this.getActivePath();let t="";if(e&&e.length>0){for(let r=0;r<e.length-1;r++)t=t+e[r].guid+",";t+=e[e.length-1].guid}return t}isImmersiveBPF(){return this.getCurrentFormEntity()&&this._currentBpfInstance&&this.getCurrentFormEntity().etn===this._currentBpfInstance.etn}_getColumnsToRefresh(){const e=Object(Ye.b)(this._getState(),this._currentPageId),t=Object(s.g)(this._getState(),this._currentPageId);if(Object(Se.a)(t)){const e=Object(he.c)(this._getState(),this.getCurrentFormEntity()),t=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SaveAndRefresh"),r=this._getSnapshotStateTelemetryParams(e);return t.warn("Columns To Refresh is not set as PageInput is null. Primary entity not refreshed after save",r),[]}const r=Object(Ne.E)(this._getState(),t.entityTypeName),n=Object(l.g)(this._getState(),e,t,r,null);return n&&n.hasOwnProperty(t.entityTypeName)?n[t.entityTypeName]:[]}_getRetrieveProcessControlDataRequest(){const e=this.getProcessId()&&!g.a.equals(this.getProcessId(),g.a.EMPTY)?J.a.toLegacyEntityReference(new J.a("businessprocessflowinstance",this.getProcessId())):null,t=this.getProcessInstanceId()&&!g.a.equals(this.getProcessInstanceId(),g.a.EMPTY)?J.a.toLegacyEntityReference(new J.a("businessprocessflowinstance",this.getProcessInstanceId())):null;return this.getCurrentFormEntity()&&e&&t?new Xe.a(J.a.toLegacyEntityReference(this.getCurrentFormEntity()),e,t):this.getCurrentFormEntity()?new Xe.a(J.a.toLegacyEntityReference(this.getCurrentFormEntity()),null,null):null}getCustomControlIndicator(){return this._customControlsPresent}setCustomControlIndicator(e){this._customControlsPresent=e}getFormXmlRenderingIndicator(){return this._renderedFromFormXml}setFormXmlRenderingIndicator(e){this._renderedFromFormXml=e}getInstanceModifiedTimestamp(){return this._instanceModifiedTimestamp}isBpfFormDescriptorValid(e,t,r,n){return null===this._isBpfFormValid&&(this._isBpfFormValid=Object(Ke.f)(e,t,r,n)),this._isBpfFormValid}_unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(e,t){let r=t;if(Object(Se.a)(t)){const t=Object(p.c)(e);r=!Object(Se.a)(t)&&t.FaultedSnapshotId}!Object(Se.b)(r)&&this._dispatch(Object(se.b)(r,!1));const n=Object(he.c)(this._getState(),this.getCurrentFormEntity());n&&!Object(Se.a)(n.snapshotId)&&n.snapshotId!==r&&this._dispatch(Object(se.b)(n.snapshotId,!1))}}},bq0x:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){const r=Object(n.Zb)(e,t);return r&&r.output?r.output.value:null}},ccIw:function(e,t,r){"use strict";r.d(t,"a",(function(){return C}));var n=r("WRDA"),a=r("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i{get invocationSource(){return this._invocationSource}set invocationSource(e){this._invocationSource=e}get workflowStep(){return this._workflowStep}set workflowStep(e){this._workflowStep=e}get businessProcessFlowVisitor(){return this._businessProcessFlowVisitor}set businessProcessFlowVisitor(e){this._businessProcessFlowVisitor=e}get currentEntityName(){return this._currentEntityName}set currentEntityName(e){this._currentEntityName=e}get processManager(){return this._processManager}set processManager(e){this._processManager=e}getStageStep(e){if(Object(a.b)(e)||!this._businessProcessFlowVisitor)return null;const t=this._businessProcessFlowVisitor.get_stagesById()[Object(n.a)(e)];return t||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class s extends
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class{constructor(e){this.value=e,this._next=null}get value(){return this._value}set value(e){this._value=e}getNext(){return this._next}setNext(e){this._next=e}}{constructor(e){super(Object(n.a)(e))}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class o{constructor(){this._latestDefaultPathCalculated=!1,this._rootNodes=[],this._rootNodesValue=[],this._lastDefaultPathCalculatedTimeHash=this._generateDefaultPathCalculatedTimeHash()}find(e,t){if(e=Object(n.a)(e),t){for(const t in this._rootNodesValue)if(e===this._rootNodesValue[t])return this._rootNodes[t];return null}for(const t in this._rootNodes){let r=this._rootNodes[t];if(r.value===e)return r;for(;null!=r.getNext();)if(r=r.getNext(),r.value===e)return r}return null}getNode(e){return this._rootNodes[e]}setNode(e,t){this._latestDefaultPathCalculated=!1,this._rootNodes[e]=t,this._rootNodesValue[e]=t.value}getDefaultPath(){return this._ensureLatestDefaultPathIsCalculated(),this._defaultPathArray}addAfter(e,t){this.find(t.value,!0)?this._addAfterInternal(e,new s(null)):this._addAfterInternal(e,t)}getDefaultPathHash(){return this._ensureLatestDefaultPathIsCalculated(),this._lastDefaultPathCalculatedTimeHash}_ensureLatestDefaultPathIsCalculated(){this._latestDefaultPathCalculated||(this._defaultPathArray=this._recaculateDefaultPath(),this._latestDefaultPathCalculated=!0,this._lastDefaultPathCalculatedTimeHash=this._generateDefaultPathCalculatedTimeHash())}_recaculateDefaultPath(){this._defaultPathArray=[];for(let e=0;e<this._rootNodes.length;e++){let t=this._rootNodes[e];for(this._defaultPathArray[this._defaultPathArray.length]=t.value;t.getNext();){const e=t.getNext();e.value&&(this._defaultPathArray[this._defaultPathArray.length]=e.value),t=e}}return this._defaultPathArray}_addAfterInternal(e,t){e.setNext(t),this._latestDefaultPathCalculated=!1}_generateDefaultPathCalculatedTimeHash(){let e=Math.floor(1e4*Math.random());try{e=crypto.getRandomValues(new Uint32Array(1))[0]}catch(e){}return Date.now().toString()+e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class c{pathChanged(e){this._handler&&!Object(a.b)(e.parentStage)&&this._handler.handleChange(e.parentStage,e.nextStage)}getHandler(){return this._handler}setHandler(e){this._handler=e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class l{constructor(e,t){this._nextStage=t,this._parentStage=e}get parentStage(){return this._parentStage}get nextStage(){return this._nextStage}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class u{constructor(e,t,r){this._context=e,this._defaultPath=t,this._staticPath=r}calculate(){let e=this._startingNodeInDefaultPath();for(let t=0;t<this._staticPath.length;t++){const r=this._staticPath[t];if(!this._context.businessProcessFlowVisitor.get_stagesById().hasOwnProperty(r))continue;const n=this._defaultPath.find(r,!0);n?e=n:(this._defaultPath.addAfter(e,new s(r)),e=e.getNext())}this._lastEvaluatedNode=e}getLastEvaluatedNodeInDefaultPath(){return this._lastEvaluatedNode}getDefaultPath(){return this._defaultPath}_startingNodeInDefaultPath(){return this._startNode||(this._startNode=this._defaultPath.getNode(0)),this._startNode}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class d{constructor(e,t){this._defaultPath=t,this._context=e}calculate(){this._staticPathToDefaultPathCalculator.calculate(),this._defaultPath=this._staticPathToDefaultPathCalculator.getDefaultPath()}getLastDefaultNode(){return this._staticPathToDefaultPathCalculator.getLastEvaluatedNodeInDefaultPath()}get traversedPath(){return this._traversedPath||(this._traversedPath=[]),this._traversedPath}set traversedPath(e){this._traversedPath=e}getDefaultPath(){return this._defaultPath}get _staticPathToDefaultPathCalculator(){return this.__staticPathToDefaultPathCalculator||(this.__staticPathToDefaultPathCalculator=new u(this._context,this._defaultPath,this._traversedPath)),this.__staticPathToDefaultPathCalculator}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class h{constructor(e,t){this._context=e,this._defaultPath=t}calculate(){this._context.businessProcessFlowVisitor.get_areConditionsPresent()&&this._calculateForTraveresedStages()}get traversedPath(){return this._traversedPath}set traversedPath(e){this._traversedPath=e}getLastCalculatedDefaultNode(){return this._traversedDefaultPathCalculator?this._traversedDefaultPathCalculator.getLastDefaultNode():null}getDefaultPath(){return this._defaultPath}_calculateForTraveresedStages(){this._traversedDefaultPathCalculator.traversedPath=this._traversedPath.split(","),this._traversedDefaultPathCalculator.calculate()}get _traversedDefaultPathCalculator(){return this.__traversedDefaultPathCalculator||(this.__traversedDefaultPathCalculator=new d(this._context,this._defaultPath)),this.__traversedDefaultPathCalculator}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class p{constructor(e){this.context=e}get stage(){return this._stageStep}set stage(e){this._stageStep=e}tryExecute(){const e=Object(n.a)(this.stage.get_stageId());return!!this.context.businessProcessFlowVisitor.get_conditionsByParentStageId()[e]&&(this.executeCondition(),!0)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class g extends p{executeCondition(){const e="bpf_"+this._sanitizeGuidForFunctionName(this.stage.get_stageId());this.context.processManager.callPblToEvaluateBranching(e)}_sanitizeGuidForFunctionName(e){if(Object(a.b)(e))return e;for(e=Object(n.a)(e);e.indexOf("-")>-1;)e=e.replace("-","");return e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class m extends p{executeCondition(){const e=Object(n.a)(this.stage.get_stageId()),t=this.context.businessProcessFlowVisitor.get_conditionsByParentStageId()[e];if(!t)return;const r=t.findElseBranch();let a=null;if(r&&r.get_Steps().get_Count()>0){a=r.get_Steps().get_item(0).get_stageId()}this._invokeReflowFunction(e,a)}_invokeReflowFunction(e,t){this.context.processManager.reflow(!1,e,t)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class b{getStageCommand(e,t){const r=e.businessProcessFlowVisitor.get_parentEntityStepByStageId()[Object(n.a)(t.get_stageId())];return e.currentEntityName!==r.get_EntityLogicalName()?new m(e):new g(e)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class f{constructor(e,t,r){this._defaultPath=t,this._cascadeUpdate=r,this._context=e,this._businessRuleCommandFactory=new b}handleChange(e,t){const r=this._defaultPath.find(e,!1);if(null!=r){const e=Object(a.b)(t)?null:t,n=new s(e);this._defaultPath.addAfter(r,n),e&&this.triggerSubsequentDefaultPathCalculation(n)}}triggerSubsequentDefaultPathCalculation(e){if(!e)return;const t=e.value;if(t&&!this._tryExecuteConditionForStage(e)){const r=this._context.getStageStep(t).get_nextStageId();if(!r)return;const n=this._defaultPath.find(r,!0);if(n)return void(this._cascadeUpdate&&this.triggerSubsequentDefaultPathCalculation(n));this._defaultPath.addAfter(e,new s(r)),this.triggerSubsequentDefaultPathCalculation(e.getNext())}}_tryExecuteConditionForStage(e){const t=this._context.invocationSource;try{this._context.invocationSource="internal";const r=this._context.getStageStep(e.value),n=this._businessRuleCommandFactory.getStageCommand(this._context,r);if(n.stage=r,!n.tryExecute())return!1;if(e.getNext())return!0}finally{this._context.invocationSource=t}return!1}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class y{constructor(e,t,r){this._context=e,this._listener=t,this._defaultPath=r}calculate(){const e=this._pathChangeHandler;this._listener.setHandler(e),e.triggerSubsequentDefaultPathCalculation(this._startNode)}get startingNodeInDefaultPath(){return this._startNode}set startingNodeInDefaultPath(e){this._startNode=e}getDefaultPath(){return this._defaultPath}get _pathChangeHandler(){return this.__pathChangeHandler||(this.__pathChangeHandler=new f(this._context,this._defaultPath,!0)),this.__pathChangeHandler}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class _{constructor(e,t,r){this._context=e,this._listener=t,this._initialDefaultPath=r}calculate(){this._context.businessProcessFlowVisitor.get_areConditionsPresent()||(this._defaultPath=this._initialDefaultPath),this._calculateForTraversedStages(),this._calculateForNonTraversedStages()}get startingNodeInDefaultPath(){return this._startingNodeInDefaultPath}set startingNodeInDefaultPath(e){this._startingNodeInDefaultPath=e}getDefaultPath(){return this._defaultPath}_calculateForTraversedStages(){this._defaultPath=this._initialDefaultPath}_calculateForNonTraversedStages(){this._nonTraversedDefaultPathCalculator.startingNodeInDefaultPath=this.startingNodeInDefaultPath,this._nonTraversedDefaultPathCalculator.calculate()}get _nonTraversedDefaultPathCalculator(){return this.__nonTraversedDefaultPathCalculator||(this.__nonTraversedDefaultPathCalculator=new y(this._context,this._listener,this._defaultPath)),this.__nonTraversedDefaultPathCalculator}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class v{constructor(e,t,r){this._context=e,this._changeListener=t,this._defaultPath=r}calculate(){const e=this._pathChangeHandler;this._changeListener.setHandler(e)}getDefaultPath(){return this._defaultPath}get _pathChangeHandler(){return this.__pathChangeHandler||(this.__pathChangeHandler=new f(this._context,this._defaultPath,!1)),this.__pathChangeHandler}}var S=r("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class O{constructor(e,t){this._context=t,this._traversedPathProvider=e,this._changeListener=new c,this._initializeDefaultPathFromRootStages()}initializeComplete(){const e=this.defaultPathHash();this._initializeTraversedPath(),this._initializeNonTraversedPath();const t=this._context.processManager.getSelectedStageId(),r=this._context.processManager.getActivePath(),n=!Object(a.a)(t)&&!Object(a.a)(r),i=n&&r.findIndex(e=>e.guid.toString()===t)<0,s=n&&this.getDefaultPath().indexOf(t)>=0;this.getDefaultPath()&&(e!==this.defaultPathHash()||i&&s)&&this._context.processManager.setActivePath(this.getDefaultPath())}updateDefaultPath(e,t){if(!e)return;let r=null;if("internal"!==this._context.invocationSource&&(r=this.defaultPathHash()),this._changeListener.pathChanged(new l(e,t)),"internal"!==this._context.invocationSource){if(r!==this.defaultPathHash()){const e=this.getDefaultPath();this._context.processManager.setActivePath(e)}}}triggerSubsequentDefaultPathCalculation(e){if(!(!!S.a.tryParseOrNull(e)&&!!this.getDefaultPath().find(t=>t.toLowerCase()===e.toLowerCase())))return;let t=null;if("internal"!==this._context.invocationSource&&(t=this.defaultPathHash()),this._changeListener.getHandler().triggerSubsequentDefaultPathCalculation(new s(e)),"internal"!==this._context.invocationSource){if(t!==this.defaultPathHash()){const e=this.getDefaultPath();this._context.processManager.setActivePath(e)}}}getDefaultPath(){return this._defaultPath.getDefaultPath()}defaultPathHash(){return this._defaultPath.getDefaultPathHash()}getNextStage(e){const t=this.getDefaultPath(),r=t.indexOf(Object(n.a)(e));return-1!==r&&r<t.length-1?t[r+1]:null}getPreviousStage(e){const t=this.getDefaultPath(),r=t.indexOf(Object(n.a)(e));return r<=0?null:t[r-1]}_initializeDefaultPathFromRootStages(){this._defaultPath=new o;const e=this._context.businessProcessFlowVisitor.get_firstLevelStages();let t=0;for(const r in e)this._defaultPath.setNode(t,new s(r)),t++}_initializeTraversedPath(){this._loadTimeDefaultPathCalculator.traversedPath=this._traversedPathProvider.getTraversedPath(),this._loadTimeDefaultPathCalculator.calculate(),this._defaultPath=this._loadTimeDefaultPathCalculator.getDefaultPath()}_initializeNonTraversedPath(){this._afterLoadPathCalculator.startingNodeInDefaultPath=this._loadTimeDefaultPathCalculator.getLastCalculatedDefaultNode(),this._afterLoadPathCalculator.calculate(),this._defaultPath=this._afterLoadPathCalculator.getDefaultPath(),this._runTimePathCalculator.calculate()}get _loadTimeDefaultPathCalculator(){return this._loadTimePathCalculator||(this._loadTimePathCalculator=new h(this._context,this._defaultPath)),this._loadTimePathCalculator}get _afterLoadPathCalculator(){return this.__afterLoadPathCalculator||(this.__afterLoadPathCalculator=new _(this._context,this._changeListener,this._defaultPath)),this.__afterLoadPathCalculator}get _runTimePathCalculator(){return this.__runTimePathCalculator||(this.__runTimePathCalculator=new v(this._context,this._changeListener,this._defaultPath)),this.__runTimePathCalculator}}var I=r("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class C{setPrimaryModel(e){this._primaryModelName=e}getDefaultPathManager(){return this._defaultPathManager}setObjectModel(e){const t=new Microsoft.Crm.Workflow.ObjectModel.WorkflowStep("",0),r={};e.businessProcessFlowEntities.forEach(e=>{if(this._isRelationshipStep(e)){const r=this._createRelationshipCollectionStep(t,e);r&&t.appendStep(r)}else{const n=this._createEntity(t,e);n&&(t.appendStep(n),r.hasOwnProperty(n.get_EntityLogicalName())||(r[n.get_EntityLogicalName()]=!0))}}),t.set_Name(e.businessProcessFlowName),t.set_Id(e.businessProcessFlowId?e.businessProcessFlowId.guid:""),this._processObjectModel=t,this._initializeVisitor()}initializeDefaultPathManager(e,t){const r=new i;r.processManager=t,r.businessProcessFlowVisitor=this._businessProcessFlowVisitor,r.workflowStep=this._processObjectModel,r.currentEntityName=this._primaryModelName,this._defaultPathManager=new O(e,r),this._defaultPathManager.initializeComplete()}get businessProcessFlowVisitor(){return this._businessProcessFlowVisitor}getEntityStages(){if(!this._processObjectModel)return null;const e=this._processObjectModel.get_Steps(),t=[];if(e){for(let r=0;r<e.get_Count();r++){const n=e.get_item(r);n&&n instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep&&(t[t.length]=e.get_item(r))}return t}return null}getRequiredFlowStepsForStage(e,t,r,n){const a=[],i=this.getStage(e);if(!i)throw new Error(e+" is not a valid stage id.");const s=i.get_Steps();if(!s)throw new Error(e+" does not include valid steps");for(let e=0;e<s.get_Count();e++)if(s.get_item(e)instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){const t=s.get_item(e);this._isFlowStep(t)&&t.get_isProcessRequired()&&a.push(t.get_Id())}return a}getRequiredAttributesForStage(e,t,r,n){const a=[],i=this.getStage(e);if(!i)throw new Error(e+" is not a valid stage id.");const s=i.get_Steps();if(!s)throw new Error(e+" does not include valid steps");for(let e=0;e<s.get_Count();e++)if(s.get_item(e)instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){const i=s.get_item(e);if(!this._isActionStep(i)&&!this._isFlowStep(i))if(i.get_isProcessRequired())a.push(i.get_Description());else{const e=this._getDataFieldNameFromStepStep(i);e&&this._isRequiredAttribute(e,t,r,n)&&a.push(i.get_Description())}}return a}_getDataFieldNameFromStepStep(e){if(this._isActionStep(e)||this._isFlowStep(e))return null;if(this._isControlStep(e)){const t=e.get_Steps().get_item(0);return!t||t.get_isSystemControl()?null:t.get_dataFieldName()}return null}_isRequiredAttribute(e,t,r,n){if(null!=e){return 2===Object(I.pc)(n,t,r,e)}return!1}_isFlowStep(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0){if(e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.FlowStep)return!0}return!1}_isActionStep(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0){if(e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep)return!0}return!1}_isControlStep(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0){if(e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ControlStep)return!0}return!1}_initializeVisitor(){this._businessProcessFlowVisitor=new ProcessObjectModel.Visitors.BusinessProcessFlowVisitor,this._businessProcessFlowVisitor.visit(this._processObjectModel)}_isRelationshipStep(e){return!(!e||!e.hasOwnProperty("relationships"))}_createEntity(e,t){const r=new Microsoft.Crm.Workflow.ObjectModel.EntityStep(e,t.entityLogicalName);r.set_Name(t.entityLogicalName),r.set_Description(t.entityDisplayName),r.set_relationshipName(t.relationshipName),r.set_attributeName(t.referencingAttributeName),r.set_parent(e);const n=this._createStage(e,t.stage);r&&n&&r.appendStep(n);for(let r=0;r<t.stage.steps.length;r++){const a=this._createStep(e,t.stage.steps[r]);a&&n.appendStep(a)}const a=this._createConditionStep(e,n,t.stage);return a&&n.appendStep(a),r}_createRelationshipCollectionStep(e,t){const r=new Microsoft.Crm.Workflow.ObjectModel.RelationshipCollectionStep(e);if(r.set_workflow(e),t.relationships)for(let n=0;n<t.relationships.length;n++){const a=this._createRelationshipStep(e,t.relationships[n]);r.appendStep(a)}return r}_createRelationshipStep(e,t){const r=new Microsoft.Crm.Workflow.ObjectModel.RelationshipStep(e);return r.set_workflow(e),r.set_sourceStageId(t.sourceStageId.guid),r.set_targetStageId(t.targetStageId.guid),r.set_attributeName(t.attributeName),r.set_relationshipName(t.relationshipName),r}_createStage(e,t){const r=new Microsoft.Crm.Workflow.ObjectModel.StageStep(e,t.stageDisplayName||"dummy");return r.set_Id(t.stageId.guid),r.set_stageId(t.stageId.guid),r.set_nextStageId(t.nextStageId?t.nextStageId.guid:""),r.set_stageCategory(t.stageCategory),r}_createStep(e,t){const r="action"===t.stepType.toLowerCase()?t.label:t.name,n=new Microsoft.Crm.Workflow.ObjectModel.StepStep(e,r||"dummy");n.set_isProcessRequired(t.required),n.set_Name(t.label),n.set_Id(t.stepId?t.stepId.guid:""),n.set_workflow(e);const a=new Microsoft.Crm.Workflow.ObjectModel.ControlStep(e);if(a.set_dataFieldName(r),"action"===t.stepType.toLowerCase()){const t=new Microsoft.Crm.Workflow.ObjectModel.ActionStep(e);t.set_Name(r),t.set_actionControl(a),n.appendStep(t)}else if("modernflow"===t.stepType.toLowerCase()){const t=new Microsoft.Crm.Workflow.ObjectModel.FlowStep(e);t.set_Name(r),t.set_flowControl(a),n.appendStep(t)}else n.appendStep(a);return n}_createConditionStep(e,t,r){if(!r.conditionJson)return null;const n=new Microsoft.Crm.Workflow.ObjectModel.ConditionStep(e);return n.set_parent(t),n.initializeFromDynamic(JSON.parse(r.conditionJson)),n.fixLinks(),n}getProcessObjectModel(){return this._processObjectModel}getStage(e){return Object(a.a)(e)||!this._processObjectModel?null:this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(e)?this._businessProcessFlowVisitor.get_stagesById()[e]:null}getPreviousStageId(e){if(this._defaultPathManager&&this._businessProcessFlowVisitor){const t=this._defaultPathManager.getPreviousStage(e);if(this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(t))return t}return null}getNextStageId(e){if(this._defaultPathManager&&this._businessProcessFlowVisitor){const t=this._defaultPathManager.getNextStage(e);if(this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(t))return t}return null}}},cf3Y:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="attribute.format";function i(e,t,r,i){const s=Object(n.x)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:s,dataFieldName:r}}}},d0Pd:function(e,t,r){"use strict";r.d(t,"a",(function(){return P}));var n=r("3/02"),a=r("SAYH"),i=r("eXjw"),s=r("j2fa"),o=r("dQnL"),c=r("CngE"),l=r("GEBM"),u=r("0L4T"),d=r("FZDd"),h=r("EY5k"),p=r("a72m"),g=r("YxC/"),m=r("KBcj"),b=r("p/2N"),f=r("16wZ"),y=r("K3gL"),_=r("ngeo"),v=r("504W"),S=r("95wm"),O=r("haag");function I(e,t,r){return{type:"chartData.retrieve.preReq_async",execute({dispatch:n,getState:I},C){let j=I();const P=O.b+".chartData.retrieve.preReq_async",T=e.visualizationId,E=e.viewId;return n(Object(p.a)(t,void 0,e.viewType,E)).then(()=>{j=I();const p=Object(m.c)(j,E);if(!function(e,t,n,a){if(!n||!n.fetchXML)return Object(u.a)(e,t,Object(g.b)(e,l.g),a,r),!1;return!0}(j,n,p,e))return Promise.resolve(null);const f=n(Object(o.a)(t,e.visualizationType,T)),_=n(Object(h.e)(l.A));return Promise.all([f,_]).then(()=>{j=I();const t=Object(c.a)(j,T);if(function(e){if(e&&e.WebResourceId)return!0;return!1}(t))return Object(s.d)(j,n,a.a.toString(e.visualizationId),a.a.toString(e.viewId),r),Promise.resolve(e);if(!function(e,t,n,a){if(n){if(n.initialized===i.a.Error){const i=Object(y.a)(n.errorCode)||l.u;return t(Object(h.e)([i])).then(()=>{const n=Object(g.b)(e,i);Object(u.a)(e,t,n,a,r)},()=>{Object(u.a)(e,t,Object(g.b)(e,l.u),a,r)}),!1}return!!n.DataDescription||(Object(u.a)(e,t,Object(g.b)(e,l.o),a,r),!1)}return!1}(j,n,t,e))return Promise.resolve(null);e.initialized||(e.initialize(t.DataDescription,p.fetchXML,t.PresentationDescription,p.title,p.entityLogicalName,t.Name,t.PrimaryEntityTypeCode,!1),e.setupAggregationQueries());const o={},m=e.dataDefinition.allAttributeNamesByEntity;Array.from(m.keys()).map(e=>{const t=Array.from(m.get(e).keys());o[e]=t});const f=Object(b.c)(p).filter(e=>-1===e.indexOf("."));if(f&&f.length>0){const e=p.entityLogicalName;e in o?o[e].push(...f):o[e]=f}try{const e=t.PresentationDescription,r=Object(S.a)(e);if(!Object(v.b)(e)&&r.length>0){const e=p.entityLogicalName,t=[];t.push(function(e,t){const r=t[2]?t[2].toLowerCase():"";if(r.substring(0,e.length)!==e)return"";return r.substring(e.length+1,r.length)}(e,r)),e in o?o[e].push(...t):o[e]=t}}catch(e){const t="Failed to retrieve entity metadata attributes for Chart Series with error : "+e.message;C.EventManager.ReportComponentFailure(P,Error(t))}return n(Object(d.e)(o)).then(()=>e)},t=>(Object(u.b)(t.getNegativeErrorCode(),I(),n,Object(g.b)(I(),l.q),e,r),Promise.resolve(null)))},t=>{const a=t&&!Object(f.a)(t.errorCode)&&t.errorCode,i=Object(y.a)(a),s=i?Object(g.b)(j,i):"retrieve chart failed. error code: "+_.a.getHexErrorCodeFromInt(a);return Object(u.a)(j,n,s,e,r),Promise.resolve(null)})}}}var C=r("Tezb"),j=r("Lyxw");function P(e,t,r,o=!1){return{type:"chartData.retrieve.async",execute({dispatch:l,getState:u},d){const h=[];try{h.push({name:O.g,value:a.a.toString(e.viewId)}),h.push({name:O.h,value:a.a.toString(e.visualizationId)});const p=u(),g=e.visualizationId,m=a.a.toString(g),b=e.viewId,f=a.a.toString(b);if(!Object(S.b)(u,l,d,h,e,t,r))return Promise.resolve();let y;const _=Object(j.c)(p,n.rd);return y=_?Object(c.e)(p,e.getStorageKey()):Object(c.d)(p,m,f),(y===i.a.Initialized&&Object(c.b)(p,m,f)||y===i.a.Initializing)&&!o?Promise.resolve():(l(_?Object(S.d)(e.getStorageKey(),C.c):Object(S.c)(m,f,C.c)),l(I(e,t,r)).then(e=>{if(!e||e.isWebResourceChart)return Promise.resolve();const n=e;return l(Object(s.b)(n,t,r))}))}catch(e){return d.EventManager.ReportComponentFailure(S.f+".retrieveChartData",Error(e),O.b,h),Promise.reject(e)}}}}},dIqG:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n="navigation.item.visibility";function a(e,t,r){return{type:n,payload:{show:r},meta:{pageId:e,navigationItemId:t}}}},dMZy:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(){return{tabId:"",navigationStack:[]}}r.d(t,"a",(function(){return n}))},dQnL:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r("SAYH"),a=r("eXjw"),i=r("95wm"),s=r("CngE"),o=r("haag"),c=r("BzGi"),l=r("K7RF"),u=r("Nb1E"),d=r("odYE"),h=r("2XFH"),p=r("Uv1Y"),g=r("Tezb"),m=r("/oKV"),b=r("iJGp"),f=r("S2mk"),y=r("3/02"),_=r("Lyxw");function v(e,t=c.a.savedvisualization,r){const h=[];return h.push({name:o.f,value:e}),h.push({name:o.i,value:t}),h.push({name:o.h,value:n.a.toString(r)}),{type:"chart.retrieve.async",execute({dispatch:g,getState:f},v){try{let S=m.a.LocalAndRemote;const I=v.TraceManager.getTracer(o.d),P=v.DataSource,w=f();let F=r;if(I.info(o.d+"entityTypeName:"+e+"visualizationType:"+t+"visualizationId:"+r),!e){const e="entityTypeName is null";return v.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error(e),o.d,h),Promise.reject(e)}n.a.isNullOrEmpty(F)&&(F=Object(s.j)(w,e));const x=Object(_.c)(f(),y.A);if(!n.a.isNullOrEmpty(F)){const r=Object(s.f)(w,F),n=Object(s.g)(w,F),f=()=>{const r=Object(s.a)(w,F),n=function(e,t,r,n){const a=c.a[r],i=Object(s.i)(e,t);return i&&i.chartTypes&&i.chartTypes[a]&&i.chartTypes[a][n.guid]}(w,e,t,F),a=n&&!n.IsUserChart;switch(Object(l.d)(w,a,r,()=>n)){case 1:S=m.a.Remote;break;case 2:g(function(e,t,r){const n=[];return n.push({name:"entityTypeName",value:t}),n.push({name:"visualizationType",value:r}),{type:"chartselector.retrieve.async",execute({dispatch:e,getState:a},s){try{return e(Object(l.b)(c.a[r],null,t,null,!0,b.a.OnDemandWithContext,null,null,[],null,m.a.LocalAndRemote)).catch(p.b)}catch(e){throw s.EventManager.ReportComponentFailure(i.f+"._retrieveChartSelector",Error(e),o.e,n),e}}}}(0,e,t))}};if(r===a.a.Initialized){if(f(),S!==m.a.LocalAndRemote)return C(g,P,e,F,t,S,v,h);if(x&&n===a.a.Uninitialized){const e=new d.a(t===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",F),r=Object(s.a)(w,F);return g(O(F,a.a.Initialized)),g(Object(u.d)(e)).catch(p.b).then(e=>(j(r,e),g(T(e)),v.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData"),Promise.resolve(F)),e=>(E(g,e,F.guid,r,v,h),Promise.resolve(F)))}return Promise.resolve(F)}return C(g,P,e,F,t,S,v,h)}return C(g,P,e,F,t,S,v,h)}catch(e){throw v.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error(e),o.d,h),e}}}}function S(e){return{type:"chart.dependencies.update.async",execute({dispatch:t,getState:r},a){const i=[];for(const t in e)i.push(e[t]+":name");if(i.length>0){return t(Object(h.a)(i)).then(()=>{const a=new Map,i=r();for(const t in e){const r=e[t],o=Object(s.a)(i,new n.a(r));o&&r&&i.metadata.labels&&i.metadata.labels[r]&&i.metadata.labels[r].name&&(o.Name=i.metadata.labels[r].name,a.set(r,o))}a.size>0&&t(function(e){const t={};e.forEach((e,r)=>{t[r]=e});return{type:"chart.descriptor.update",payload:{charts:t}}}(a))},p.b)}return Promise.resolve()}}}function O(e,t){const r=n.a.isNullOrEmpty(e)?null:{charts:{[n.a.toString(e)]:{initialized:t,oDataInitialized:a.a.Initializing}}};return{type:g.f,payload:r}}function I(e,t,r,s=c.a.savedvisualization,h){const g=[];return g.push({name:o.f,value:t}),g.push({name:o.i,value:s}),g.push({name:o.h,value:n.a.toString(r)}),{type:"chart.retrieve.async",execute:({dispatch:e,getState:o},m)=>Object(_.c)(o(),y.A)?r?function(e,t,r,s,o,h,g){const m=new d.a(s===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",r);return e(O(r,a.a.Initializing)),Promise.all([e(Object(l.b)(c.a[s],null,t,n.a.toLegacyGuid(r),!0,b.a.OnDemandWithContext,null,null,[],null,o)).catch(p.b),e(Object(u.d)(m)).catch(p.c)]).then(t=>(t[1].constructor===p.a?E(e,t[1],r.guid,t[0].charts[r.guid],h,g):(j(t[0].charts[r.guid],t[1]),e(T(t[1])),h.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData")),t[0]))}(e,t,r,s,h,m,g):function(e,t,r,s,o,h,g){return e(Object(l.b)(c.a[s],null,t,n.a.toLegacyGuid(r),!0,b.a.OnDemandWithContext,null,null,[],null,o)).catch(p.b).then(t=>{const r=new n.a(Object.keys(t.charts)[0]),o=new d.a(s===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",r);return e(O(r,a.a.Initializing)),e(Object(u.d)(o)).catch(p.b).then(n=>(j(t.charts[r.guid],n),e(T(n)),h.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData"),t),n=>(E(e,n,r.guid,t.charts[r.guid],h,g),t))})}(e,t,r,s,h,m,g):function(e,t,r,a,i){return e(Object(l.b)(c.a[a],null,t,n.a.toLegacyGuid(r),!0,b.a.OnDemandWithContext,null,null,[],null,i)).catch(p.b)}(e,t,r,s,h)}}function C(e,t,r,s,c,l,u,d){return e(function(e){const t=n.a.isNullOrEmpty(e)?null:{charts:{[n.a.toString(e)]:{initialized:a.a.Initializing}}};return{type:g.b,payload:t}}(s)),e(I(0,r,s,c,l)).then(t=>{t&&t.chartSelectors&&!t.chartSelectors[r]&&(t.chartSelectors[r]={initialized:a.a.Initialized,chartTypes:{}});const o=[];for(const e in t.charts)o.push(e);return e(S(o)).then(()=>(e(P(t)),n.a.isNullOrEmpty(s)&&(s=t.chartDefaults[r]),u.EventManager.ReportComponentSuccess(i.f+".retrieveChart"),s),p.b)},t=>{const c=t&&!Object(f.j)(t.errorCode)&&t.errorCode,l={chartSelectors:{[r]:{initialized:a.a.Initialized,chartTypes:{}}}};if(e(P(l)),Object(f.j)(c))return u.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error(t),o.d,d),Object(p.b)(t);{const t={charts:{[n.a.toString(s)]:{initialized:a.a.Error,errorCode:c}}};e(P(t))}})}function j(e,t){e.PresentationDescription=t.presentationdescription.replace(/(\r\n\s*)/g,""),e.oDataInitialized=a.a.Initialized}function P(e){return{type:g.b,payload:e}}function T(e){return{type:g.f,payload:e}}function E(e,t,r,n,s,c){e(T({charts:{[r]:{initialized:n.initialized,oDataInitialized:a.a.Error}}})),s.EventManager.ReportComponentFailure(i.f+".retrieveChartOData",Error(t),o.c,c)}},dtbk:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n="navigation.item.defaultvalues";function a(e,t,r){return{type:n,payload:{allNavBarByRelationshipItems:t,currentLanguageId:r},meta:{pageId:e}}}},fREn:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return u}));var n=r("eXjw"),a=r("dHD5"),i=r("37s6"),s=r("a8zb"),o=r("BoVI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e,t,r,i,s,c,u,d){const h=Object(a.v)(s),p=function(e,t){if(!e)return null;const r=new DOMParser,n=e?r.parseFromString(e,"text/xml"):null;if(!n)return null;const a=n.documentElement?n.documentElement.children?n.documentElement.children:n.documentElement.childNodes:void 0;if(!a)return null;const i=a,s=[];for(let e=0;e<i.length;e++){if(!i[e].getAttribute)continue;const n=i[e]?i[e].children?i[e].children:i[e].childNodes:void 0,a=[];let o=null;for(let e=0;e<n.length;e++){const i=n[e];if(!i.getAttribute)continue;const s=i.getAttribute("name");let c;({relatedEntityName:c,fetchXmlDocument:o}=l(s,o,r,t)),a.push({name:s,width:parseInt(i.getAttribute("width"),10),relatedEntityName:c,disableMetaDataBinding:"1"===i.getAttribute("disableMetaDataBinding"),labelId:i.getAttribute("labelId"),isHidden:"1"===i.getAttribute("isHidden"),disableSorting:"1"===i.getAttribute("disableSorting"),addedBy:i.getAttribute("addedBy"),desc:i.getAttribute("desc"),cellType:i.getAttribute("cellType"),imageProviderWebresource:i.getAttribute("imageProviderWebresource"),imageProviderFunctionName:i.getAttribute("imageProviderFunctionName")})}const c={name:i[e].getAttribute("name"),id:i[e].getAttribute("id"),cells:a,multiObjectIdField:i[e].getAttribute("multiObjectIdField"),layoutStyle:i[e].getAttribute("multiObjectIdField")};s.push(c)}return{name:n.documentElement.getAttribute("name"),object:parseInt(n.documentElement.getAttribute("object"),10),rows:s,customControlDescriptions:null,jump:n.documentElement.getAttribute("jump"),select:"1"===n.documentElement.getAttribute("select"),icon:"1"===n.documentElement.getAttribute("icon"),preview:"1"===n.documentElement.getAttribute("preview"),iconRenderer:null}}(d,u),g={initialized:n.a.Initialized,viewId:r,fetchXML:u,entityLogicalName:i,title:c,layoutXML:d,grid:p,isCustomView:!0};return{type:o.a,payload:{views:{[r.guid]:g}},meta:{pageId:e,controlName:t,contextKey:h}}}function l(e,t,r,n){let a="";if(e.indexOf(".")>0){const i=e.split(".")[0];t||(t=r.parseFromString(n,"text/xml"));const s=t.querySelector('link-entity[alias="'+i+'"]');s&&(a=s.getAttribute("name")||"")}return{relatedEntityName:a,fetchXmlDocument:t}}function u(e){return{type:o.f,execute:(t,r)=>(Object(i.w)(t.getState())?s.a.createSqlfromFetchXMLAsync(t,e.fetchXML):Promise.resolve(null)).then(t=>e.offlineSqlQuery=t)}}},fyfl:function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return d}));var n=r("SAYH"),a=r("FZDd"),i=r("d0w6"),s=r("Uv1Y"),o=r("a72m"),c=r("BFlg"),l=r("kKLx"),u=r("P6DH");function d(e,t,r){return{type:"datasethost.dependencies.retrieve.async",execute({dispatch:d,getState:p},g){const m=g.TraceManager.getTracer(c.z),b=c.x+".loadDataSetHostDependenciesAction";m.info(`Retrieving view with ID ${n.a.toString(t)} for ${e} entity.`);const f=Object(u.pb)(p(),e,t);return d(Object(o.a)(e,i.a.MAIN_APPLICATION_VIEW,f,t)).then(i=>{if(!i){const r=`Unable to retrieve DataSetHost dependencies for the grid. Failed to retrieve view with ID ${n.a.toString(t)} for ${e}`;return g.EventManager.ReportComponentFailure(b,Error(r)),Promise.reject(new s.a(l.b))}const o=h(p(),t,r);return d(Object(a.e)(o)).then(()=>{const r=[{name:"entityTypeName",value:e},{name:"viewId",value:n.a.toString(t)}];return g.EventManager.ReportComponentSuccess(b,r),Promise.resolve()}).catch(r=>{let a=[];for(const e in o)o[e].length&&(a=[...o[e],...a]);const i=`Unable to retrieve DataSetHost dependencies for the grid for view with ID ${n.a.toString(t)}. Failed to retrieve entity with attributes ${a.join()} for ${e}`;return g.EventManager.ReportComponentFailure(b,Error(i)),Promise.reject(new s.a(l.a))})})}}}function h(e,t,r){const n=Object(u.qb)(e,t,r),a={};if(n&&n.grid&&n.grid.rows&&n.grid.rows[0]&&n.grid.rows[0].cells){const e=[];n.grid.rows[0].cells.forEach(t=>{if(!t.disableMetaDataBinding)if(t.relatedEntityName){if(t.name&&-1!==t.name.indexOf(".")){const e=t.name.split(".")[1];a[t.relatedEntityName]||(a[t.relatedEntityName]=[]),-1===a[t.relatedEntityName].indexOf(e)&&e&&a[t.relatedEntityName].push(e)}}else-1===e.indexOf(t.name)&&e.push(t.name)}),e.length>0&&(a[n.entityLogicalName]=e)}return a}},gDO8:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n="form.setFormLoadError";function a(e,t){return{type:n,payload:{error:t},meta:{pageId:e}}}},hA8P:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="control.mrudisabled";function i(e,t,r,i,s){const o=Object(n.v)(i);return{type:a,payload:s,meta:{pageId:t,controlName:r,contextKey:o}}}},"hQd/":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e){this._value=null,this._value=e}get value(){return this._value}set value(e){this._value=e}}},hSDL:function(e,t,r){"use strict";r.d(t,"e",(function(){return s})),r.d(t,"b",(function(){return o})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return l})),r.d(t,"d",(function(){return u})),r.d(t,"c",(function(){return h})),r.d(t,"a",(function(){return d})),r.d(t,"l",(function(){return m})),r.d(t,"i",(function(){return b})),r.d(t,"m",(function(){return f})),r.d(t,"n",(function(){return y})),r.d(t,"k",(function(){return _})),r.d(t,"h",(function(){return v})),r.d(t,"o",(function(){return g})),r.d(t,"j",(function(){return S}));var n=r("dHD5"),a=r("BFlg"),i=r("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="grid.applyFilter",o="grid.applyActivityTypeFilter",c="grid.applyJumpBarFilter",l="grid.applyQuickFindFilter",u="grid.applyFilterCurrentValue",d="grid.applyActivityTypeFilterCurrentValue",h="grid.applyAdvancedFindFilter";function p(e,t,r,i){return{type:"grid.applyFilter.async",execute({dispatch:s},o){const c=o.TraceManager.getTracer(a.z),l=a.x+".applyGridFilterAction",u=Object(n.v)(i),d=[];d.push({name:a.n,value:e}),d.push({name:a.e,value:u});try{return c.info("Applying the filter expression to the grid. "),s(function(e,t,r,n){return{type:e,payload:t,meta:{pageId:r,dataSetContextKey:n}}}(e,t,r,u)),o.EventManager.ReportComponentSuccess(l,d),Promise.resolve()}catch(e){const t="Applying the filter expression to the grid failed ";o.EventManager.ReportComponentFailure(l,Error(t),"",d)}}}}function g(e,t,r){const a=Object(n.v)(r);return{type:c,payload:e,meta:{pageId:t,dataSetContextKey:a}}}const m=(e,t,r)=>p(s,e,t,r),b=(e,t,r)=>p(o,e,t,r),f=(e,t,r)=>p(c,e,t,r),y=(e,t,r)=>p(l,Object(i.a)(e)?e:e.trim(),t,r),_=(e,t,r)=>p(u,e,t,r),v=(e,t,r)=>p(d,e,t,r),S=(e,t,r)=>p(h,e,t,r)},haag:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"g",(function(){return a})),r.d(t,"h",(function(){return i})),r.d(t,"f",(function(){return s})),r.d(t,"i",(function(){return o})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return l})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n="Chart.Component",a="ViewId",i="visualizationId",s="entity Type",o="chart visualization type",c="RETRIEVECHART",l="RETRIEVECHARTTS_RETRIEVECHARTSELECTOR",u="RETRIEVECHARTTS_RETRIEVECHARTDATA",d="RETRIEVECHARTTS_RETRIEVECHARTODATA"},iHOm:function(e,t,r){"use strict";r.d(t,"a",(function(){return ae}));var n=r("2YQW"),a=r("ZJsz"),i=r("RrRu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s=[],o=Object(n.d)({[i.a]:function(e=s,t){return t.payload?t.payload:e}},s);var c=r("jRHm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const l=Object(n.d)({[c.a]:function(e=null,t){return t?t.payload:e}},null);var u=r("Jpj4"),d=r("ApeL"),h=r("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const p=Object(n.d)({[u.a]:function(e=null,t){return t.payload?t.payload:e},[d.b]:function(e=null,t){if(e&&e.records){const r=e.records.filter(e=>Object.keys(e)[0]===h.a.toString(t.payload.recordId));if(r&&r.length){const e=r[0];e&&e[h.a.toString(t.payload.recordId)]&&e[h.a.toString(t.payload.recordId)].filter(e=>Object.keys(e)[0]===t.payload.attributeName)&&(void 0!==t.payload.requiredLevel&&(e[h.a.toString(t.payload.recordId)].filter(e=>Object.keys(e)[0]===t.payload.attributeName)[0][t.payload.attributeName].requiredLevel=t.payload.requiredLevel),void 0!==t.payload.isDisabled&&(e[h.a.toString(t.payload.recordId)].filter(e=>Object.keys(e)[0]===t.payload.attributeName)[0][t.payload.attributeName].isDisabled=t.payload.isDisabled),void 0!==t.payload.notifications&&(e[h.a.toString(t.payload.recordId)].filter(e=>Object.keys(e)[0]===t.payload.attributeName)[0][t.payload.attributeName].notifications=t.payload.notifications))}}return e},[d.a]:function(e=null,t){return e}},null);var g=r("hSDL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const m={activityOrQueue:null,jumpBar:null,quickFind:null,advancedFindFilter:null,activityOrQueueFilterValue:null,activityTypeFilter:null,activityTypeSelectedValues:null},b=function(e=m,t){switch(t.type){case g.e:return Object.assign(Object.assign({},e),{activityOrQueue:t.payload});case g.b:return Object.assign(Object.assign({},e),{activityTypeFilter:t.payload});case g.f:return Object.assign(Object.assign({},e),{jumpBar:t.payload});case g.g:return Object.assign(Object.assign({},e),{quickFind:t.payload});case g.d:return Object.assign(Object.assign({},e),{activityOrQueueFilterValue:t.payload});case g.c:return Object.assign(Object.assign({},e),{advancedFindFilter:t.payload});case g.a:return Object.assign(Object.assign({},e),{activityTypeSelectedValues:t.payload});default:return e}},f=Object(n.d)({[g.e]:b,[g.f]:b,[g.g]:b,[g.d]:b,[g.c]:b,[g.b]:b,[g.a]:b},m);var y=r("QXpm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const _=Object(n.d)({[y.a]:function(e=false,t){return e!==t.payload?t.payload:e}},false);var v=r("E6o7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const S=Object(n.d)({[v.a]:function(e="",t){return t.payload?t.payload:e}},"");var O=r("ojtV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const I=Object(n.d)({[O.a]:function(e=false,t){return t.payload&&"showChart"===t.payload.name?t.payload.value:e}},false);var C=r("iOrn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const j={customFilterXml:null,source:null,timeStamp:null},P=Object(n.d)({[C.a]:function(e=j,t){return null!=t.payload?t.payload:e}},j);var T=r("LAGg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const E=Object(n.d)({[T.a]:function(e,t){if(t.payload)return t.payload;return e}},0);var w=r("mLMm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const F=Object(n.d)({[w.a]:function(e,t){if(t.payload)return t.payload;return e}},0);var x=r("waMg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const A=Object(n.d)({[x.a]:function(e=null,t){return t.payload?t.payload:e}},null);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function N(e,t){return t.payload?t.payload:e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function D(e=!1,t){return e!==t.payload?t.payload:e}var k=r("Utin");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const M=Object(n.d)({[k.a]:function(e=null,t){return t.payload&&"ViewId"===t.payload.name?h.a.tryParseOrNull(t.payload.value):e}},null);var R=r("WK+4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const L=Object(n.d)({[R.a]:function(e=null,t){return t.payload&&"VisualizationId"===t.payload.name?h.a.tryParseOrNull(t.payload.value):e}},null);var B=r("qwRa");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const V=r("BzGi").a.savedvisualization,G=Object(n.d)({[B.a]:function(e=V,t){return t.payload&&"chartVisualizationType"===t.payload.name?t.payload.value:e}},V),U={parameters:{}};const X=Object(n.d)({[k.a]:function(e=U,t){const r=t.payload.name,n=e.parameters;let a;for(const e in n)n[e].Name===r&&(a=e);const i=Object.assign(Object.assign({},e.parameters[a]),{Value:t.payload.value}),s=Object.assign(Object.assign({},e.parameters),{[a]:i});return s[r]&&(s[r]=t.payload.value),Object.assign(Object.assign({},e),{parameters:s})}},U),z=Object(n.b)("controlName",X);var q=r("s+OO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const H=Object(n.d)({[q.b]:(e="",t)=>t.payload&&t.payload.name===q.a?t.payload.value:e},"");var W=r("7k+e");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Y=[],Q=Object(n.d)({[W.b]:(e=Y,t)=>t.payload&&t.payload.name===W.a?t.payload.value:e},Y);var K=r("L4PC"),J=r("5UPV"),Z=r("zFtG"),$=r("Wdaq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function ee(e,t){return t.payload?t.payload:e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const te=Object(n.d)({[$.a]:function(e,t){if(t)return t.payload;return e}},"");var re=r("ujVH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const ne=Object(n.d)({[re.a]:function(e=null,t){return t.payload?t.payload:e}},null),ae=Object(n.b)("dataSetContextKey",(e=a.a,t)=>{switch(t.type){case i.a:return Object.assign(Object.assign({},e),{selectedRows:o(e.selectedRows,t)});case c.a:return Object.assign(Object.assign({},e),{selectedRelatedEntity:l(e.selectedRelatedEntity,t)});case u.a:return Object.assign(Object.assign({},e),{rowProperties:p(e.rowProperties,t)});case T.a:return Object.assign(Object.assign({},e),{refreshCounter:E(e.refreshCounter,t)});case w.a:return Object.assign(Object.assign({},e),{pagingRefreshInput:F(e.pagingRefreshInput,t)});case x.a:return Object.assign(Object.assign({},e),{queryKey:A(e.queryKey,t)});case C.a:return Object.assign(Object.assign({},e),{customFilter:P(e.customFilter,t)});case g.e:case g.b:case g.f:case g.g:case g.d:case g.c:case g.a:return Object.assign(Object.assign({},e),{filters:f(e.filters,t)});case y.a:return Object.assign(Object.assign({},e),{useRollupView:_(e.useRollupView,t)});case v.a:return Object.assign(Object.assign({},e),{fetchXml:S(e.fetchXml,t)});case k.a:return Object.assign(Object.assign({},e),{viewId:M(e.viewId,t),controls:z(e.controls,t)});case R.a:return Object.assign(Object.assign({},e),{visualizationId:L(e.visualizationId,t)});case B.a:return Object.assign(Object.assign({},e),{chartVisualizationType:G(e.chartVisualizationType,t)});case d.b:case d.a:return Object.assign(Object.assign({},e),{rowProperties:p(e.rowProperties,t)});case K.a:return Object.assign(Object.assign({},e),{pageNumber:N(e.pageNumber,t)});case J.a:return Object.assign(Object.assign({},e),{isNewPageRequested:D(e.isNewPageRequested,t)});case Z.a:return Object.assign(Object.assign({},e),{pagingData:ee(e.pagingData,t)});case $.a:return Object.assign(Object.assign({},e),{commandManagerId:te(e.commandManagerId,t)});case q.b:return Object.assign(Object.assign({},e),{chartFilterExpression:H(e.chartFilterExpression,t)});case W.b:return Object.assign(Object.assign({},e),{chartDrillDownParameters:Q(e.chartDrillDownParameters,t)});case O.a:return Object.assign(Object.assign({},e),{showChart:I(e.showChart,t)});case re.a:return Object.assign(Object.assign({},e),{dependentOptionSetColumnStatus:ne(e.dependentOptionSetColumnStatus,t)});default:return e}})},iOrn:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return s}));var n=r("dHD5"),a=r("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="grid.setCustomFilter";function s(e,t,r,s,o){return{type:"grid.setCustomFilter.async",execute({dispatch:c,getState:l},u){const d=u.TraceManager.getTracer(a.z),h=a.x+".setCustomFilterAction";try{return d.info("Adding a custom filter for the grid. "),c(function(e,t,r,a,s){let o=null;if(null!=e){o={customFilterXml:e,source:t,timeStamp:s||null}}const c=Object(n.y)(a),l=Object(n.v)(a);return{type:i,payload:o,meta:{pageId:r,contextKey:c,dataSetContextKey:l}}}(e,t,r,s,o)),u.EventManager.ReportComponentSuccess(h),Promise.resolve()}catch(e){const t="Adding a custom filter for the grid failed";u.EventManager.ReportComponentFailure(h,Error(t))}}}}},iWfp:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return o}));var n=r("nuS9"),a=r("Gilj"),i=r("FhVi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t,r,n,i,s){return new a.a(e,e=>{t(e.EVENT)},r,n,i,s)}function o(e){return n.createElement(i.a,{key:e.id,keyboardShortcuts:e.keyboardShortcuts,defaultFocusId:e.defaultFocusId,rootElementId:e.rootElementId,isModal:e.isModal,shouldManageFocus:e.shouldManageFocus||!1})}},j2fa:function(e,t,r){"use strict";r.d(t,"b",(function(){return Se})),r.d(t,"d",(function(){return Oe})),r.d(t,"e",(function(){return Ie})),r.d(t,"c",(function(){return Ce})),r.d(t,"a",(function(){return je}));var n=r("Wgxh"),a=r("SAYH"),i=r("eXjw"),s=r("95wm");var o=r("fKWG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var c=r("odYE"),l=r("VcAV"),u=r("MXaZ");class d{constructor(){this._dataPointAggregators=new Array(0),this._dataPointDateTimeRangeAggregatorInfoMap=new Map,this._dataPointFiscalPeriodAggregators=new Array(0),this._dataPointFiscalYearAggregators=new Array(0)}addAggregator(e,t,r,n,i){if(r>=o.a.DAY&&r<o.a.FISCAL_PERIOD)this._addDateTimeRangeAggregatorInfo(e,t,r,n,i);else if(r===o.a.FISCAL_PERIOD)this._addDataPointFiscalPeriodAggregator(e,t,n,i);else if(r===o.a.FISCAL_YEAR)this._addDataPointFiscalYearAggregator(e,t,n,i);else{const r=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,Value:e&&e.Value||null,DisplayName:e&&e.DisplayName||null,EntityLogicalName:e&&e.EntityLogicalName||null}}();if(r.FieldName=e,r.EntityName=n,r.LinkEntityExpressionArray=i,Object(l.c)(t))r.Value=null;else if(t instanceof c.a){const e=t;r.Value=e.id.guid,r.DisplayName=e.name,r.EntityLogicalName=e.etn}else t instanceof a.a?r.Value=a.a.toString(t):r.Value=t.toString();this._dataPointAggregators.push(r)}}static _daysInMonth(e,t){return new Date(e,t,0).getDate()}_addDataPointFiscalPeriodAggregator(e,t,r,n){const a=function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,FiscalType:e&&e.FiscalType||null,Year:e&&e.Year||0,Period:e&&e.Period||0}}();if(a.FiscalType="in-fiscal-period-and-year",a.FieldName=e,a.EntityName=r,a.LinkEntityExpressionArray=n,!t)return void this._dataPointFiscalPeriodAggregators.push(a);if("string"!=typeof t)throw new Error("value should be string");if(t.indexOf("-")<=0)throw new Error("value should have xxxx-yy format");const i=t.split("-");a.Year=Number(i[0]),a.Period=Number(i[1]),this._dataPointFiscalPeriodAggregators.push(a)}_addDataPointFiscalYearAggregator(e,t,r,n){const a=function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,FiscalType:e&&e.FiscalType||null,Year:e&&e.Year||0}}();if(a.FiscalType="in-fiscal-year",a.FieldName=e,a.EntityName=r,a.LinkEntityExpressionArray=n,t){if("number"!=typeof t)throw new Error("value should be number");a.Year=Number(t),this._dataPointFiscalYearAggregators.push(a)}else this._dataPointFiscalYearAggregators.push(a)}_addDateTimeRangeAggregatorInfo(e,t,r,n,a){let i=null;switch(this._dataPointDateTimeRangeAggregatorInfoMap.has(e)?i=this._dataPointDateTimeRangeAggregatorInfoMap.get(e):(i=function(e){return{dateTimeAggregatorDay:(null==e?void 0:e.dateTimeAggregatorDay)||null,dateTimeAggregatorWeek:(null==e?void 0:e.dateTimeAggregatorWeek)||null,dateTimeAggregatorMonth:(null==e?void 0:e.dateTimeAggregatorMonth)||null,dateTimeAggregatorYear:(null==e?void 0:e.dateTimeAggregatorYear)||null,dateTimeAggregatorFieldName:(null==e?void 0:e.dateTimeAggregatorFieldName)||null,dateTimeAggregatorEntityName:(null==e?void 0:e.dateTimeAggregatorEntityName)||null,dateTimeAggregatorLinkEntityExpressionArr:(null==e?void 0:e.dateTimeAggregatorLinkEntityExpressionArr)||null,dateTimeAggregatorPrecision:(null==e?void 0:e.dateTimeAggregatorPrecision)||o.a.YEAR}}({dateTimeAggregatorFieldName:e}),this._dataPointDateTimeRangeAggregatorInfoMap.set(e,i)),i.dateTimeAggregatorEntityName||(i.dateTimeAggregatorEntityName=n),i.dateTimeAggregatorLinkEntityExpressionArr||(i.dateTimeAggregatorLinkEntityExpressionArr=a),r){case o.a.DAY:i.dateTimeAggregatorDay=Number(t);break;case o.a.WEEK:i.dateTimeAggregatorWeek=Number(t);break;case o.a.MONTH:i.dateTimeAggregatorMonth=Number(t);break;case o.a.QUARTER:i.dateTimeAggregatorMonth=3*Number(t);break;case o.a.YEAR:i.dateTimeAggregatorYear=Number(t);break;default:throw new Error("DateTime Group type not supported")}i.dateTimeAggregatorPrecision=Math.min(r,i.dateTimeAggregatorPrecision)}_getDataPointDateTimeRangeAggregators(e,t){const r=new Array(0);return 0===this._dataPointDateTimeRangeAggregatorInfoMap.size||this._dataPointDateTimeRangeAggregatorInfoMap.forEach((n,a)=>{const i={FieldName:(null==s?void 0:s.FieldName)||null,EntityName:(null==s?void 0:s.EntityName)||null,LinkEntityExpressionArray:(null==s?void 0:s.LinkEntityExpressionArray)||null,MinDate:(null==s?void 0:s.MinDate)||null,MaxDate:(null==s?void 0:s.MaxDate)||null};var s;if(i.FieldName=n.dateTimeAggregatorFieldName,i.EntityName=n.dateTimeAggregatorEntityName,i.LinkEntityExpressionArray=n.dateTimeAggregatorLinkEntityExpressionArr,n.dateTimeAggregatorYear){switch(n.dateTimeAggregatorMonth=n.dateTimeAggregatorMonth?n.dateTimeAggregatorMonth:12,n.dateTimeAggregatorDay=n.dateTimeAggregatorDay?n.dateTimeAggregatorDay:d._daysInMonth(n.dateTimeAggregatorYear,n.dateTimeAggregatorMonth),i.MaxDate=new Date(n.dateTimeAggregatorYear,n.dateTimeAggregatorMonth-1,n.dateTimeAggregatorDay),n.dateTimeAggregatorPrecision){case o.a.DAY:h(i.MaxDate),i.MinDate=new Date(i.MaxDate.getFullYear(),i.MaxDate.getMonth(),i.MaxDate.getDate());break;case o.a.WEEK:{t===u.a.FirstFullWeekOfTheYear&&(t=u.a.FirstDayOfTheYear);let r=Object(u.s)(n.dateTimeAggregatorYear,n.dateTimeAggregatorWeek,e,t),a=Object(u.s)(n.dateTimeAggregatorYear,n.dateTimeAggregatorWeek+1,e,t);if(a.setDate(a.getDate()-1),t===u.a.FirstDayOfTheYear){if(a>=new Date(n.dateTimeAggregatorYear+1,0,1))a=new Date(n.dateTimeAggregatorYear+1,0,0);else if(1===n.dateTimeAggregatorWeek){const e=new Date(n.dateTimeAggregatorYear,0,1);r<e&&(r=e)}}i.MinDate=r,i.MaxDate=a,h(i.MaxDate),h(i.MinDate);break}case o.a.MONTH:i.MinDate=new Date(i.MaxDate.getFullYear(),i.MaxDate.getMonth()-1,d._daysInMonth(n.dateTimeAggregatorYear,i.MaxDate.getMonth())+1),h(i.MaxDate),h(i.MinDate);break;case o.a.QUARTER:i.MinDate=new Date(i.MaxDate.getFullYear(),i.MaxDate.getMonth()-3,d._daysInMonth(n.dateTimeAggregatorYear,i.MaxDate.getMonth()-2)+1),h(i.MaxDate),h(i.MinDate);break;case o.a.YEAR:h(i.MaxDate),i.MinDate=new Date(i.MaxDate.getFullYear()-1,i.MaxDate.getMonth(),i.MaxDate.getDate()+1);break;default:throw new Error("DateTime Group type not supported")}r.push(i)}else r.push(i)}),r}getAggregators(e,t){let r=this._dataPointAggregators;const n=this._getDataPointDateTimeRangeAggregators(e,t);return n&&n.length>0&&(r=r.concat(n)),this._dataPointFiscalPeriodAggregators&&this._dataPointFiscalPeriodAggregators.length>0&&(r=r.concat(this._dataPointFiscalPeriodAggregators)),this._dataPointFiscalYearAggregators&&this._dataPointFiscalYearAggregators.length>0&&(r=r.concat(this._dataPointFiscalYearAggregators)),r}}function h(e){e.getTimezoneOffset()<0&&e.setDate(e.getDate()+1)}var p=r("YxC/"),g=r("GEBM"),m=r("IqkD"),b=r("Xd5/"),f=r("nfCs"),y=r("NjDY"),_=r("LbMF"),v=r("S70w"),S=r("Ae6N");function O(e,t){const r=Object(_.a)(e,t.entity.entityName,t.attributeName);let n=r?r.DisplayName:null;n||(n=t.attributeName);let a=n;if(t.dateTimeGrouping){const r=f.c(t.dateTimeGrouping.groupingType).replace("-","").toUpperCase();a=String.format(Object(p.b)(e,g.c),Object(p.b)(e,`${g.c}.${r.toUpperCase()}`),n)}else t.hasAggregate&&t.aggregateType&&(a=String.format(Object(p.b)(e,g.d),Object(p.b)(e,`${g.d}.${t.aggregateType.toUpperCase()}`),n));if(r&&"money"===r.Type){let n="",i=null;const s=Object(y.x)(e);r.IsBaseCurrency?s&&s.baseCurrencyId&&s.transactionCurrencyById&&(i=s.transactionCurrencyById[s.baseCurrencyId.guid]):t.hasAggregate&&(i=Object(m.b)(e)),i&&(n=s&&s.currencyDisplayOption===v.a.CurrencyCode?i.currencyCode:i.currencySymbol),n&&(a=String.format(Object(p.b)(e,g.b),a,n))}return a}function I(e,t,r){return r>0?String.format(Object(p.b)(e,g.y),r,t):String.format(Object(p.b)(e,g.w),t)}function C(e,t,r,n,a){const i=a<1&&n>=1&&r<1,s=a<1&&n<1&&r>=1,o=n<1&&r<1;if(a>=1&&n<1&&r>=1){const n=new Date(t,r-1,a),{formatInfoCultureName:i,numberFormatInfo:s,dateFormatInfo:o}=Object(m.w)(e),c=new Sys.CultureInfo(i,s,o);return Object(b.s)(n,c,S.a.None)}return i?String.format(Object(p.b)(e,g.z),n,t):s?String.format("{0} {1}",function(e){const t=Object(p.b)(e,g.e).split(",");if(!t||12!==t.length)throw new Error("Expect 12 months! Actual: "+t.length);return t}(e)[r-1],t):o?String(t):""}function j(e){return Object(p.b)(e,g.v)}var P=r("WPtp"),T=r("16wZ");function E(e,t,r){let n=!1;r&&r.groupAttribute&&r.groupAttribute.dateTimeGrouping&&(n=!0);return{attribute:t,primaryGroupBy:r,aliasName:t.aliasName||t.attributeName,state:e,isDateTimeChart:n}}function w(e,t){let r=e.isDateTimeChart?function(e,t){if(!t.fields||!Object(P.c)(t.fields[e.aliasName]))return"";switch(e.attribute.dateTimeGrouping.groupingType){case o.a.DAY:return function(e,t){const r=Object(P.e)(t.fields[e.aliasName]),n=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]),a=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[1].aliasName]);return C(e.state,a,n,-1,r)}(e,t);case o.a.WEEK:return function(e,t){const r=Object(P.e)(t.fields[e.aliasName]),n=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return C(e.state,n,-1,r,-1)}(e,t);case o.a.MONTH:return function(e,t){const r=Object(P.e)(t.fields[e.aliasName]),n=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return C(e.state,n,r,-1,-1)}(e,t);case o.a.QUARTER:return function(e,t){const r=Object(P.e)(t.fields[e.aliasName]),n=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return I(e.state,n,r)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,t);case o.a.FISCAL_PERIOD:return function(e,t){return Object(P.e)(t.fields[e.aliasName])}(e,t);case o.a.YEAR:return function(e,t){const r=Object(P.e)(t.fields[e.aliasName]);return C(e.state,r,-1,-1,-1)}(e,t);case o.a.FISCAL_YEAR:return function(e,t){const r=Object(P.e)(t.fields[e.aliasName]);return I(e.state,r,-1)}(e,t);default:return Object(P.c)(t.fields[e.attribute.attributeName])}}(e,t):null;return r||(r=Object(P.c)(t.fields[e.aliasName]),r=r||""),0===r.length?Object(p.b)(e.state,g.v):r}function F(e,t){if(!e.attribute||!Object(_.a)(e.state,e.attribute.entity.entityName,e.attribute.attributeName))return w(e,t);switch(Object(_.a)(e.state,e.attribute.entity.entityName,e.attribute.attributeName).Type){case"picklist":case"status":case"state":case"boolean":{let r=Object(P.e)(t.fields[e.aliasName]);return r=Object(T.a)(r)?-1:Number(r),r}case"datetime":return function(e,t){let r=-1,n=-1,a=-1;switch(e.attribute.dateTimeGrouping.groupingType){case o.a.DAY:r=Object(P.e)(t.fields[e.aliasName]),n=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]),a=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[1].aliasName]);break;case o.a.MONTH:n=Object(P.e)(t.fields[e.aliasName]),a=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;case o.a.YEAR:a=Object(P.e)(t.fields[e.aliasName]);break;case o.a.QUARTER:n=Object(P.e)(t.fields[e.aliasName]),a=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;case o.a.WEEK:r=1+7*(Object(P.e)(t.fields[e.aliasName])-1),a=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;default:return w(e,t)}return new Date(a,n-1,r).getTime()}(e,t);default:return w(e,t)}}function x(e){return{Enabled:e&&e.Enabled||!1,X:e&&e.X||0,Y:e&&e.Y||0,Align:e&&e.Align||"left",VerticalAlign:e&&e.VerticalAlign||"middle",LabelFormatter:e&&e.LabelFormatter||null,Color:e&&e.Color||""}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function A(e){return{Value:e&&e.Value||0,FormattedValue:e&&e.FormattedValue||null,Aggregators:e&&e.Aggregators||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class N extends Error{constructor(e,t,r){super(e),Object.setPrototypeOf(this,N.prototype),this.title=t,this.description=r}}var D=r("Lyxw"),k=r("3/02"),M=r("zh0k"),R=r("hwt8"),L=r("504W");function B(){return this.point.formattedValue}function V(e){return function(){return Highcharts.numberFormat(parseFloat(this.point.y)/e*100)+"%"}}class G{constructor(){this.isInitialized=!1}get primaryGroupBy(){return this.chartDataDescription&&this.chartDataDescription.category&&this.chartDataDescription.category.primaryGroupBy}get queryModel(){return this._queryModel}initialize(e,t,r,n,a,i,s,o,c,l){this.getState=e,this.chartData=t,this.chartDataDescription=r,this.categoryColumn=this.chartDataDescription.categoryColumns,this.chartPresentationSeries=n,this.chartPresentationXAxis=a,this.chartPresentationYAxis=i,this.chartPresentationArea3DStyle=s,this.chartPresentationAreaGradientStyle=o,this._queryModel=c,this.chartPresentationAnnotationList=l,this._isChartCustomizationParityFCBEnabled()&&this._validateChartAggregateAttributes(),this.isInitialized=!0}setXAxisMajorGridAndMajorTickProperties(e,t=0){var r,n,a,i,s,o,c,l;return e.AxisMajorGridColor=null===(n=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[t])||void 0===n?void 0:n.AxisMajorGridColor,e.AxisMajorGridEnabled=null===(i=null===(a=this.chartPresentationXAxis)||void 0===a?void 0:a[t])||void 0===i?void 0:i.AxisMajorGridEnabled,e.AxisMajorTickMarkColor=null===(o=null===(s=this.chartPresentationXAxis)||void 0===s?void 0:s[t])||void 0===o?void 0:o.AxisMajorTickMarkColor,e.AxisMajorTickMarkEnabled=null===(l=null===(c=this.chartPresentationXAxis)||void 0===c?void 0:c[t])||void 0===l?void 0:l.AxisMajorTickMarkEnabled,e}setYAxisMajorGridAndMajorTickProperties(e,t=0){var r,n,a,i,s,o,c,l;return e.AxisMajorGridColor=null===(n=null===(r=this.chartPresentationYAxis)||void 0===r?void 0:r[t])||void 0===n?void 0:n.AxisMajorGridColor,e.AxisMajorGridEnabled=null===(i=null===(a=this.chartPresentationYAxis)||void 0===a?void 0:a[t])||void 0===i?void 0:i.AxisMajorGridEnabled,e.AxisMajorTickMarkColor=null===(o=null===(s=this.chartPresentationYAxis)||void 0===s?void 0:s[t])||void 0===o?void 0:o.AxisMajorTickMarkColor,e.AxisMajorTickMarkEnabled=null===(l=null===(c=this.chartPresentationYAxis)||void 0===c?void 0:c[t])||void 0===l?void 0:l.AxisMajorTickMarkEnabled,e}retrieveChartArea3DStyle(){const e={};return e.Enable3D=this.chartPresentationArea3DStyle.Enable3D,e}retrieveChartAreaGradientStyle(){const e={};return e.BackColor=this.chartPresentationAreaGradientStyle.BackColor,e.BackSecondaryColor=this.chartPresentationAreaGradientStyle.BackSecondaryColor,e.BackGradientStyle=this.chartPresentationAreaGradientStyle.BackGradientStyle,e}setYAxisOppositeProperty(e){var t,r,n,a;return this._isChartCustomizationParityFCBEnabled()&&(null===(r=null===(t=this.chartPresentationXAxis)||void 0===t?void 0:t[0])||void 0===r?void 0:r.IsReversed)&&(e.Opposite=null===(a=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[0])||void 0===a?void 0:a.IsReversed),e}setXAxisIsReversedProperty(e){var t,r,n,a;return this._isChartCustomizationParityFCBEnabled()&&(null===(r=null===(t=this.chartPresentationXAxis)||void 0===t?void 0:t[0])||void 0===r?void 0:r.IsReversed)&&(e.IsReversed=null===(a=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[0])||void 0===a?void 0:a.IsReversed),e}retrieveChartYAxis(){const e=new Array(1);if(e[0]={},!this._queryModel.SeriesList)return e;const t=(e,t,r)=>{this.chartPresentationYAxis&&this.chartPresentationYAxis.length>t&&this.chartPresentationYAxis[t]&&this.chartPresentationYAxis[t].Title?e.Title=this.chartPresentationYAxis[t].Title:1===r&&(e.Title=this._queryModel.SeriesList[t].Title)};let r=0,n=-1,a=-1,i=!1,s=!1;for(let e=0;e<this.chartPresentationSeries.length;e++)this.chartPresentationSeries[e].SecondaryYAxis?(r++,a=-1===a?e:a,s=s||this.shouldDisableAllowDecimals(e)):(n=-1===n?e:n,i=i||this.shouldDisableAllowDecimals(e));return t(e[0],n,this.chartPresentationSeries.length-r),e[0].Opposite=!1,i&&(e[0].AllowDecimals=!1),0===r&&(e[0]=this.setYAxisOppositeProperty(e[0])),r>0&&(e[1]={},t(e[1],a,r),e[1].Opposite=!0,s&&(e[1].AllowDecimals=!1)),e.forEach((e,t)=>{var r,n,a,i,s,o,c,l,u,d,h,p,g,m;e.Disabled=this.chartPresentationYAxis&&this.chartPresentationYAxis[t]&&this.chartPresentationYAxis[t].Disabled,e.LabelForeColor=null===(n=null===(r=this.chartPresentationYAxis)||void 0===r?void 0:r[t])||void 0===n?void 0:n.LabelForeColor,e.AxisLineColor=null===(i=null===(a=this.chartPresentationYAxis)||void 0===a?void 0:a[t])||void 0===i?void 0:i.AxisLineColor,e.AxisTitleForeColor=null===(o=null===(s=this.chartPresentationYAxis)||void 0===s?void 0:s[t])||void 0===o?void 0:o.AxisTitleForeColor,e.LabelDisabled=null===(l=null===(c=this.chartPresentationYAxis)||void 0===c?void 0:c[t])||void 0===l?void 0:l.LabelDisabled,e.AxisInterval=null===(d=null===(u=this.chartPresentationYAxis)||void 0===u?void 0:u[t])||void 0===d?void 0:d.AxisInterval,e.AxisMinimum=null===(p=null===(h=this.chartPresentationYAxis)||void 0===h?void 0:h[t])||void 0===p?void 0:p.AxisMinimum,e.AxisMaximum=null===(m=null===(g=this.chartPresentationYAxis)||void 0===g?void 0:g[t])||void 0===m?void 0:m.AxisMaximum,e=this.setYAxisMajorGridAndMajorTickProperties(e,t)}),this.chartPresentationYAxis&&this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].FormatString?e[0].FormatString=this.chartPresentationYAxis[0].FormatString:e[0].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[0].measures[0].measureAttribute),r>0&&(this.chartPresentationYAxis&&this.chartPresentationYAxis[1]&&this.chartPresentationYAxis[1].FormatString?e[1].FormatString=this.chartPresentationYAxis[1].FormatString:e[1].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[a].measures[0].measureAttribute)),e}_isChartCustomizationParityFCBEnabled(){return Object(D.a)(this.getState(),k.s,k.Lc,k.w)}retrieveChartAnnotations(){const e=new Array(this.chartPresentationAnnotationList.length);for(let t=0;t<this.chartPresentationAnnotationList.length;t++){const r={};r.X=this.chartPresentationAnnotationList[t].X,r.Y=this.chartPresentationAnnotationList[t].Y,r.Text=this.chartPresentationAnnotationList[t].Text,r.ForeColor=this.chartPresentationAnnotationList[t].ForeColor,e[t]=r}return e}retrieveChartCategory(){var e,t,r,n,a,i;const s=new Array(1);let o=null;this.categoryColumn.length>0&&(o=E(this.getState(),this.categoryColumn[0],this.chartDataDescription.category.primaryGroupBy)),s[0]={};const c=new Array(this.chartData.length);for(let e=0;e<this.chartData.length;e++){const t=this.chartData[e];if(o){if(c[e]=w(o,t),"-1"===c[e])c[e]=Object(p.b)(this.getState(),g.f);else if(!o.isDateTimeChart&&"number"==typeof Object(P.e)(t.fields[o.aliasName])&&this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString){const r=Object(m.w)(this.getState());c[e]=Object(R.c)(Object(P.e)(t.fields[o.aliasName]),Object(b.d)(r),this.chartPresentationXAxis[0].FormatString)}}else c[e]=j(this.getState())}return s[0].Title=this.retrieveChartCategoryTitle(o),s[0].Values=c,s[0].Disabled=this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].Disabled,s[0].LabelForeColor=null===(t=null===(e=this.chartPresentationXAxis)||void 0===e?void 0:e[0])||void 0===t?void 0:t.LabelForeColor,s[0].AxisLineColor=null===(n=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[0])||void 0===n?void 0:n.AxisLineColor,s[0].AxisTitleForeColor=null===(i=null===(a=this.chartPresentationXAxis)||void 0===a?void 0:a[0])||void 0===i?void 0:i.AxisTitleForeColor,s[0].LabelDisabled=this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].LabelDisabled,s[0]=this.setXAxisMajorGridAndMajorTickProperties(s[0]),s[0]=this.setXAxisIsReversedProperty(s[0]),s}retrieveChartCategoryTitle(e){return this.chartPresentationXAxis&&this.chartPresentationXAxis.length>0&&this.chartPresentationXAxis[0].Title?this.chartPresentationXAxis[0].Title:e?O((t=e).state,t.attribute):"";var t}retrieveChartSeries(e){const t=new Array(this.chartPresentationSeries.length);for(let r=0;r<this.chartPresentationSeries.length;r++){const n=this.chartDataDescription.category.measureCollections[r].measures[0].measureAttribute,a=n.aliasName?n.aliasName:n.attributeName,i=this.chartPresentationSeries[r].IsValueShownAsLabel,s=this.chartPresentationSeries[r].LabelFormat;let o=null;s&&Object(R.d)(s)&&(o=Object(R.g)(s));let c=!1;this.chartPresentationSeries[r].Label&&"#percent"===this.chartPresentationSeries[r].Label.toLowerCase()&&(c=!0);let l=!1;s&&U(this.chartPresentationSeries[r].ChartType)&&Object(R.e)(s)&&(l=!0);let u=null;const d=O(this.getState(),n);t[r]=this.cloneBlueprintSeriesStyle(this.chartPresentationSeries[r]),this.chartPresentationSeries[r].SecondaryYAxis&&(t[r].YAxisNumber=1),this.primaryGroupBy&&(u=[],u.push(this.primaryGroupBy.groupAttribute),this.primaryGroupBy.extendedGroupBys&&this.primaryGroupBy.extendedGroupBys.forEach(e=>{u.push(e)}));const h=new Array(this.chartData.length),p=a;let g=0;for(let e=0;e<this.chartData.length;e++){const t=this.chartData[e];h[e]=A();const n=Object(P.e)(t.fields[a]);if(h[e].Value=n||0,g+=n||0,s){const n=Object(m.w)(this.getState()),a=Object(b.d)(n);Object(R.f)(s)?h[e].FormattedValue=Object(M.b)(h[e].Value,this.chartPresentationSeries[r].LabelFormat,a):Object(R.d)(s)&&!l?h[e].FormattedValue=Object(R.a)(h[e].Value,o,a):h[e].FormattedValue=Object(P.c)(t.fields[p])||0}else h[e].FormattedValue=Object(P.c)(t.fields[p])||0;this.attachAggregators(h[e],t,u)}const f=x();i?(f.Enabled=!0,f.LabelFormatter=B):c&&(f.Enabled=!0,f.LabelFormatter=V(g)),f.Color=this.chartPresentationSeries[r].LabelForeColor,t[r].DataLabels=f,t[r].DataPoints=h,t[r].Title=this.getChartTitleFromPresentationSeries(d,r),t[r].XAxisNumber=e,t[r].HideInLegend=this.chartPresentationSeries[r].HideInLegend,t[r].Stack=this.chartPresentationSeries[r].Stack}const r=Object(m.w)(this.getState()),n=Object(b.d)(r),a=this.chartPresentationSeries[0].IsValueShownAsLabel,i=this.chartPresentationSeries[0].LabelFormat;if(a&&U(this.chartPresentationSeries[0].ChartType)&&Object(R.e)(i)){const e=X(i,n);for(let r=0;r<t[0].DataPoints.length;r++)e(0,r,0,t)}return t}getChartTitleFromPresentationSeries(e,t=0){return Object(L.b)(this.chartPresentationSeries[t].LegendText)?Object(L.b)(this.chartPresentationSeries[t].Name)?e:this.chartPresentationSeries[t].Name:this.chartPresentationSeries[t].LegendText}shouldDisableAllowDecimals(e){const t=this.chartDataDescription.category.measureCollections[e].measures[0].measureAttribute;return"count"===t.aggregateType||"countcolumn"===t.aggregateType}cloneBlueprintSeriesStyle(e){const t={DataPoints:r&&r.DataPoints||null,DataLabels:r&&r.DataLabels||null,ChartType:r&&r.ChartType||"line",YAxisNumber:r&&r.YAxisNumber||0,XAxisNumber:r&&r.XAxisNumber||0,Title:r&&r.Title||"",Color:r&&r.Color||"",BorderColor:r&&r.BorderColor||"",BorderWidth:r&&r.BorderWidth||0,CustomProperties:r&&r.CustomProperties||null,Stack:r&&r.Stack||null};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;return t.ChartType=e.ChartType,t.Color=e.Color,t.BorderColor=e.BorderColor,t.BorderWidth=e.BorderWidth,t.CustomProperties=e.CustomProperties,t}attachAggregators(e,t,r){if(r){const n=new d;for(let e=0;e<r.length;e++){const a=r[e],i=new Array;a.entity.baseEntity&&a.entity.baseEntity.linkedEntities&&a.entity.baseEntity.linkedEntities.forEach(e=>{const t={name:r&&r.name||null,from:r&&r.from||null,to:r&&r.to||null,linkType:r&&r.linkType||null,alias:r&&r.alias||null};var r;t.name=e.entityName,t.from=e.linkFromAttribute,t.to=e.linkToAttribute,t.linkType=e.joinType.toString(),t.alias=e.alias,i.push(t)}),n.addAggregator(a.attributeName,Object(P.e)(t.fields[G._getFieldName(a)]),a.dateTimeGrouping?a.dateTimeGrouping.groupingType:-1,a.entity.entityName,i)}const a=Object(m.w)(this.getState()),i=this._getFirstDayOfWeekFromUserSettings(a),s=this._getCalendarWeekRuleFromUserSettings(a);e.Aggregators=n.getAggregators(i,s)}}_getFirstDayOfWeekFromUserSettings(e){var t;return(null===(t=e.dateFormatInfo)||void 0===t?void 0:t.FirstDayOfWeek)||0}_getCalendarWeekRuleFromUserSettings(e){var t;return(null===(t=e.dateFormatInfo)||void 0===t?void 0:t.CalendarWeekRule)||0}getFormatterPropertiesForAttribute(e){return Object(b.z)(this.getState(),Object(_.a)(this.getState(),e.entity.entityName,e.attributeName))}static _getFieldName(e){return e.aliasName&&e.aliasName.trim()?e.aliasName:e.attributeName}isChartDrillable(){if(!this._isGroupByDrillable(this.chartDataDescription.category.primaryGroupBy))return!1;for(const e of this.chartDataDescription.category.measureCollections)for(const t of e.secondaryGroupBys)if(!this._isGroupByDrillable(t))return!1;return!!this.chartDataDescription.entityExpression.hasAggregate}_isGroupByDrillable(e){return!this.chartDataDescription.isGroupByFromNestedLinkEntity()&&(!(!e||!e.groupAttribute.hasGroupBy)&&this._isAttributeDrillable(e.groupAttribute))}_isAttributeDrillable(e){var t;const r=null===(t=null==e?void 0:e.entity)||void 0===t?void 0:t.entityName,n=null==e?void 0:e.attributeName;return"memo"!==Object(_.b)(n,r,this.getState())}_validateChartAggregateAttributes(){var e,t,r,n;for(let a=0;a<(null===(r=null===(t=null===(e=this.chartDataDescription)||void 0===e?void 0:e.entityExpression)||void 0===t?void 0:t.aggregateAttributes)||void 0===r?void 0:r.length);a++){const e=this.chartDataDescription.entityExpression.aggregateAttributes[a],t=null===(n=null==e?void 0:e.entity)||void 0===n?void 0:n.entityName,r=null==e?void 0:e.attributeName,i=Object(_.b)(r,t,this.getState());if(!("date"!==i&&"datetime"!==i||"min"!==e.aggregateType&&"max"!==e.aggregateType)){const e=String.format(Object(p.b)(this.getState(),g.h),r);throw new N("ChartError",e,e)}}}}function U(e){return!!e&&("stackedbar100"===e.toLowerCase()||"stackedcolumn100"===e.toLowerCase()||"stackedarea100"===e.toLowerCase())}function X(e,t){return function r(n,a,i,s){if(n===s.length)return i;const o=s[n].DataPoints[a];return i=r(++n,a,i+(o&&o.Value?o.Value:0),s),o&&o.Value&&(o.FormattedValue=Object(R.a)(o.Value/i*100,Object(R.g)(e),t)),i}}var z=r("iZ7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class q extends G{parse(){var e,t,r,n;if(!this.isInitialized)throw new Error("The instance of the ComparisonChartDataParser class is not properly initialized.");const a=new Array(0),i=new Map,s=this.chartDataDescription.category,o=s.measureCollections[0];if(o.secondaryGroupBys.length<=0)throw new Error("Comparison chart can only be plotted with secondary groups's");if(o.measures&&o.measures.length>0&&o.measures[0].parentCategory&&o.measures[0].parentCategory.primaryGroupBy&&(o.measures[0].parentCategory.primaryGroupBy.groupAttribute&&a.push(o.measures[0].parentCategory.primaryGroupBy.groupAttribute),o.measures[0].parentCategory.primaryGroupBy.extendedGroupBys))for(let e=0;e<o.measures[0].parentCategory.primaryGroupBy.extendedGroupBys.length;e++)a.push(o.measures[0].parentCategory.primaryGroupBy.extendedGroupBys[e]);if(1!==this.chartPresentationSeries.length)throw new Error("Comparison chart should have only one series");const c=this._addSecondaryGroupByToFieldAggregators(o,a),l=o.measures[0].measureAttribute,u=l.aliasName?l.aliasName:l.attributeName,d=u,h=s.primaryGroupBy.groupAttribute,p=E(this.getState(),this._getGroupByAttribute(h,s.primaryGroupBy),s.primaryGroupBy),g=new Array,f=new Array,y=new Map;for(let e=0;e<this.chartData.length;e++){const t=this.chartData[e],r=w(p,t);let n,a=w(c,t);null==a?(a=j(this.getState()),n=a):n=F(c,t),i.set(n,a),f.indexOf(r)<0&&f.push(r),g.indexOf(n)<0&&g.push(n)}g.forEach(e=>{const t=new Array(f.length);y.set(e,t)});const _=Object(m.w)(this.getState()),v=this.chartPresentationSeries[0].LabelFormat;let S=!1;this.chartPresentationSeries[0].Label&&"#percent"===this.chartPresentationSeries[0].Label.toLowerCase()&&(S=!0);let O=!1;v&&U(this.chartPresentationSeries[0].ChartType)&&Object(R.e)(v)&&(O=!0);for(let e=0;e<this.chartData.length;e++){const t=this.chartData[e];let r=F(c,t);Object(T.a)(r)&&(r=j(this.getState()));const n=y.get(r),i=w(p,t),s=f.indexOf(i);if(this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString&&(f[s]=Object(R.c)(Object(P.e)(t.fields[p.aliasName]),Object(b.d)(_),this.chartPresentationXAxis[0].FormatString)),n[s]=A(),n[s].Value=Object(P.e)(t.fields[u]),v){const r=Object(b.d)(_);Object(R.f)(v)?n[s].FormattedValue=Object(M.b)(n[e].Value,v,r):Object(R.d)(v)&&!O?n[s].FormattedValue=Object(R.a)(n[s].Value,Object(R.g)(v),r):n[s].FormattedValue=Object(P.c)(t.fields[d])||0}else n[s].FormattedValue=Object(P.c)(t.fields[d])||0;this.attachAggregators(n[s],t,a)}g.forEach(e=>{const t=y.get(e);for(let e=0;e<f.length;e++)t[e]||(t[e]=A())});const I=new Array(1);I[0]={},I[0].Title=this.retrieveChartCategoryTitle(p),I[0].Values=f,I[0].LabelForeColor=null===(e=this.chartPresentationXAxis[0])||void 0===e?void 0:e.LabelForeColor,I[0].AxisLineColor=null===(t=this.chartPresentationXAxis[0])||void 0===t?void 0:t.AxisLineColor,I[0].AxisTitleForeColor=null===(r=this.chartPresentationXAxis[0])||void 0===r?void 0:r.AxisTitleForeColor,I[0].LabelDisabled=null===(n=this.chartPresentationXAxis[0])||void 0===n?void 0:n.LabelDisabled,I[0]=this.setXAxisMajorGridAndMajorTickProperties(I[0]),I[0]=this.setXAxisIsReversedProperty(I[0]),this._sortComparisonCodes(o,g);const C=new Array(g.length),N=this.chartPresentationSeries[0]&&this.chartPresentationSeries[0].IsValueShownAsLabel,D=this.chartPresentationSeries[0]?this.chartPresentationSeries[0].LabelForeColor:null,k=this.chartPresentationSeries[0]&&this.chartPresentationSeries[0].HideInLegend,L=this.getChartTitleFromPresentationSeries(this.chartPresentationSeries[0].Name);for(let e=0;e<g.length;e++){const t=g[e];if(C[e]=this.cloneBlueprintSeriesStyle(this.chartPresentationSeries[0]),C[e].Title=L||i.get(t),C[e].DataPoints=y.get(t),C[e].HideInLegend=k,N){const t=x();t.Enabled=!0,t.LabelFormatter=B,C[e].DataLabels=t,t.Color=D}else if(S){let t=0;C[e].DataPoints.forEach(e=>{t+=e&&e.Value?e.Value:0});const r=x();r.Enabled=!0,r.LabelFormatter=V(t),C[e].DataLabels=r,r.Color=D}}if(N&&O){const e=X(v,Object(b.d)(_));for(let t=0;t<I[0].Values.length;t++)e(0,t,0,C)}this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=I,this.queryModel.YAxes=this._retrieveChartYAxis(l),this.queryModel.SeriesList=C,this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations()}_sortComparisonCodes(e,t){e.secondaryGroupBys[0].descending?t.sort((e,t)=>"number"==typeof e&&"number"==typeof t?t-e:t.localeCompare(e)):t.sort((e,t)=>"number"==typeof e&&"number"==typeof t?e-t:e.localeCompare(t))}_getGroupByAttribute(e,t){return e.attributeName!==Object(z.h)(this.getState(),e.entity.entityName).PrimaryIdAttribute?e:t.extendedGroupBys&&t.extendedGroupBys.length>0?t.extendedGroupBys[0]:e}_addSecondaryGroupByToFieldAggregators(e,t){const r=e.secondaryGroupBys[0].groupAttribute,n=E(this.getState(),this._getGroupByAttribute(r,e.secondaryGroupBys[0]),e.secondaryGroupBys[0]);if(r&&t.push(r),e.secondaryGroupBys[0].extendedGroupBys)for(let r=0;r<e.secondaryGroupBys[0].extendedGroupBys.length;r++)t.push(e.secondaryGroupBys[0].extendedGroupBys[r]);return n}_retrieveChartYAxis(e){var t,r,n,a,i,s,o,c;const l=new Array(1);return l[0]={},this.chartPresentationYAxis&&this.chartPresentationYAxis.length>0&&this.chartPresentationYAxis[0].Title?l[0].Title=this.chartPresentationYAxis[0].Title:l[0].Title=O(this.getState(),e),this.chartPresentationYAxis[0].FormatString?l[0].FormatString=this.chartPresentationYAxis[0].FormatString:l[0].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[0].measures[0].measureAttribute),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelForeColor&&(l[0].LabelForeColor=this.chartPresentationYAxis[0].LabelForeColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].AxisLineColor&&(l[0].AxisLineColor=this.chartPresentationYAxis[0].AxisLineColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].AxisTitleForeColor&&(l[0].AxisTitleForeColor=this.chartPresentationYAxis[0].AxisTitleForeColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelDisabled&&(l[0].LabelDisabled=null===(r=null===(t=this.chartPresentationYAxis)||void 0===t?void 0:t[0])||void 0===r?void 0:r.LabelDisabled),l[0].AxisInterval=null===(a=null===(n=this.chartPresentationYAxis)||void 0===n?void 0:n[0])||void 0===a?void 0:a.AxisInterval,l[0].AxisMinimum=null===(s=null===(i=this.chartPresentationYAxis)||void 0===i?void 0:i[0])||void 0===s?void 0:s.AxisMinimum,l[0].AxisMaximum=null===(c=null===(o=this.chartPresentationYAxis)||void 0===o?void 0:o[0])||void 0===c?void 0:c.AxisMaximum,this.shouldDisableAllowDecimals(0)&&(l[0].AllowDecimals=!1),l[0]=this.setYAxisMajorGridAndMajorTickProperties(l[0]),l[0]=this.setYAxisOppositeProperty(l[0]),l}}class H extends G{parse(){if(!this.isInitialized)throw new Error("The instance of the DateTimeChartDataParser class is not properly initialized.");this.categoryColumn&&0!==this.categoryColumn.length&&(this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=this.retrieveChartCategory(),this.queryModel.SeriesList=this.retrieveChartSeries(0),this.queryModel.YAxes=this.retrieveChartYAxis(),this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations())}retrieveChartCategory(){var e,t,r,n,a,i,s,o;const c=new Array(1);if(this.chartData.length<1)return c;const l=this.primaryGroupBy.groupAttribute;c[0]={};const u=new Array(this.chartData.length),d=E(this.getState(),l,this.primaryGroupBy);c[0].Title=this.retrieveChartCategoryTitle(d),c[0].LabelForeColor=null===(t=null===(e=this.chartPresentationXAxis)||void 0===e?void 0:e[0])||void 0===t?void 0:t.LabelForeColor,c[0].AxisLineColor=null===(n=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[0])||void 0===n?void 0:n.AxisLineColor,c[0].AxisTitleForeColor=null===(i=null===(a=this.chartPresentationXAxis)||void 0===a?void 0:a[0])||void 0===i?void 0:i.AxisTitleForeColor,c[0].LabelDisabled=null===(o=null===(s=this.chartPresentationXAxis)||void 0===s?void 0:s[0])||void 0===o?void 0:o.LabelDisabled,c[0]=this.setXAxisMajorGridAndMajorTickProperties(c[0]),c[0]=this.setXAxisIsReversedProperty(c[0]);for(let e=0;e<this.chartData.length;e++){const t=this.chartData[e];u[e]=w(d,t),d.isDateTimeChart&&this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString&&u[e]!==Object(p.b)(d.state,g.v)&&(u[e]=Object(R.b)(new Date(u[e]),Object(b.d)(Object(m.w)(this.getState())),this.chartPresentationXAxis[0].FormatString))}return c[0].Values=u,c}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class W extends G{parse(){if(!this.isInitialized)throw new Error("The instance of the NormalChartDataParser class is not properly initialized.");this.categoryColumn&&0!==this.categoryColumn.length&&(this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=this.retrieveChartCategory(),this.queryModel.SeriesList=this.retrieveChartSeries(0),this.queryModel.YAxes=this.retrieveChartYAxis(),this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations())}}var Y=r("DAWX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Q(e){const t={};try{if(e){const r=/\w+=\w+/;e.split(/\s*,\s*/).forEach(e=>{if(e&&r.test(e)){const[r,n]=e.split("=");t[r]=n}})}}catch(t){throw`Failed to parse chart custom properties, value: ${e} `}return{FunnelNeckHeight:t&&Number(t.FunnelNeckHeight)||0,FunnelNeckWidth:t&&Number(t.FunnelNeckWidth)||10,StackedGroupName:t&&t.StackedGroupName||null}}var K=r("S2mk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const J=["COLUMN","STACKEDCOLUMN","STACKEDCOLUMN100","BAR","STACKEDBAR","STACKEDBAR100","AREA","STACKEDAREA","STACKEDAREA100","LINE","PIE","FUNNEL","TAG","DOUGHNUT","POINT"];function Z(e,t,r){const n=(new DOMParser).parseFromString(t,"text/xml");!function(e,t){const r=e.getElementsByTagName("parsererror");if(r&&r.length>0)throw new N("ChartError",Object(p.b)(t,g.t),Object(p.b)(t,g.s))}(n,e);return{chartPresentationSeries:$(e,n,r),chartPresentationLegendList:re(n),colorsList:te(n),chartPresentationArea3DStyle:oe(n),chartPresentationAreaGradientStyle:ce(n),chartPresentationXAxis:ae(n),chartPresentationYAxis:ie(n),chartPresentationAnnotationList:ne(n)}}function $(e,t,r){const n=new Array,a=t.querySelectorAll("Chart Series Series"),i=new XMLSerializer;for(let t=0;t<a.length;t++){const s=a[t],o={},c=s.getAttribute("ChartType")||"Column";if(-1===J.indexOf(c.toUpperCase()))throw new N("ChartError",Object(p.b)(e,g.t),Object(p.b)(e,g.t));o.ChartType=c;const l=s.getAttribute("Color");o.Color=l?le(l):null;const u=s.getAttribute("LegendText");o.LegendText=u||null;const d=s.getAttribute("CustomProperties");o.CustomProperties=Q(d);const h=s.getAttribute("BorderColor");o.BorderColor=h?le(h):null;const m=s.getAttribute("BorderWidth");o.BorderWidth=m?Number(m):null;const b=s.getAttribute("IsValueShownAsLabel");o.IsValueShownAsLabel=b&&"true"===b.toLowerCase()||!1,o.Label=s.getAttribute("Label");const f=s.getAttribute("YAxisType");o.SecondaryYAxis=f&&"secondary"===f.toLowerCase();const y=s.getAttribute("IsVisibleInLegend");o.HideInLegend=y&&"false"===y.toLowerCase();const _=s.getAttribute("LabelForeColor");o.LabelForeColor=_?le(_):null,o.LabelFormat=s.getAttribute("LabelFormat");const v=ee(e,s.outerHTML||i.serializeToString(s),r);o.Name=v||null,o.Stack=o.CustomProperties.StackedGroupName,n.push(o)}return n}function ee(e,t,r){const n=Object(s.a)(t);if(Object(K.j)(n)||n.length<5)return"";const a=n[2].toLowerCase(),i=n[4];let o="";const c=a.substring(0,r.length);if(c!==r)return"";const l=a.substring(r.length+1,a.length),u=Object(_.a)(e,c,l);return u&&u.OptionSet&&(o=u.OptionSet.filter(e=>e.Value.toString().toLowerCase()===i.toLowerCase())[0].Label),o}function te(e){const t=new Array,r=e.querySelector("Chart").getAttribute("PaletteCustomColors");return null!==r&&r.split(";").forEach(e=>{if(e){const r=le(e);t.push(r)}}),t}function re(e){const t=new Array,r=e.querySelectorAll("Chart Legends Legend");for(let e=0;e<r.length;e++){const n={},a=r[e].getAttribute("Enabled");n.Enabled=null===a||"True"===a,t.push(n)}return t}function ne(e){const t=new Array,r=e.querySelectorAll("Chart Annotations TextAnnotation");for(let e=0;e<r.length;e++){const n=r[e],a={},i=n.getAttribute("X");a.X=i?Number(i):null;const s=n.getAttribute("Y");a.Y=s?Number(s):null,a.Text=n.getAttribute("Text");const o=n.getAttribute("ForeColor");a.ForeColor=o?le(o):null,t.push(a)}return t}function ae(e){const t=new Array,r=e.querySelectorAll("Chart ChartAreas ChartArea AxisX");for(let n=0;n<r.length;n++){const a=r[n],i={};se(i,e.querySelectorAll("Chart ChartAreas ChartArea AxisX MajorGrid")[0],e.querySelectorAll("Chart ChartAreas ChartArea AxisX MajorTickMark")[0]),i.Title=a.getAttribute("Title");const s=e.querySelectorAll("Chart ChartAreas ChartArea AxisX LabelStyle")[0];if(s){const e=null==s?void 0:s.getAttribute("ForeColor"),t=null==s?void 0:s.getAttribute("Enabled");i.LabelForeColor=e?le(e):null,i.LabelDisabled=t&&"false"===t.toLowerCase(),i.FormatString=s.getAttribute("Format")}const o=a.getAttribute("Enabled"),c=a.getAttribute("LineColor"),l=a.getAttribute("TitleForeColor");i.Disabled=o&&"false"===o.toLowerCase(),i.AxisLineColor=c?le(c):null,i.AxisTitleForeColor=l?le(l):null,i.Disabled=o&&"false"===o.toLowerCase();const u=a.getAttribute("IsReversed");i.IsReversed=u&&"true"===u.toLowerCase(),t.push(i)}return t}function ie(e){const t=new Array,r=(e,r)=>{var n,a;const i={};if(!e)return void t.splice(r,0,i);const s=e;i.Title=s.getAttribute("Title");se(i,s.querySelectorAll("MajorGrid")[0],s.querySelectorAll("MajorTickMark")[0]);const o=s.getAttribute("Enabled");i.Disabled=o&&"false"===o.toLowerCase();const c=s.getAttribute("Interval"),l=s.getAttribute("Minimum"),u=s.getAttribute("Maximum");i.AxisInterval=c?Number(c):null,i.AxisMinimum=l?Number(l):null,i.AxisMaximum=u?Number(u):null;const d=s.querySelectorAll("LabelStyle");d&&d[0]&&d[0].getAttribute("Format")&&(i.FormatString=d[0].getAttribute("Format"));const h=null===(n=null==d?void 0:d[0])||void 0===n?void 0:n.getAttribute("ForeColor");i.LabelForeColor=h?le(h):null;const p=null===(a=null==d?void 0:d[0])||void 0===a?void 0:a.getAttribute("Enabled");i.LabelDisabled=p&&"false"===p.toLowerCase();const g=s.getAttribute("LineColor");i.AxisLineColor=g?le(g):null;const m=s.getAttribute("TitleForeColor");i.AxisTitleForeColor=m?le(m):null,t.splice(r,0,i)};let n=e.querySelectorAll("Chart ChartAreas ChartArea AxisY");return n&&r(n[0],0),n=e.querySelectorAll("Chart ChartAreas ChartArea AxisY2"),n&&r(n[0],1),t}function se(e,t,r){if(e){if(t){const r=t.getAttribute("LineColor"),n=t.getAttribute("Enabled");e.AxisMajorGridColor=r?le(r):null,e.AxisMajorGridEnabled=n&&"true"===n.toLowerCase()}if(r){const t=r.getAttribute("LineColor"),n=r.getAttribute("Enabled");e.AxisMajorTickMarkColor=t?le(t):null,e.AxisMajorTickMarkEnabled=n&&"true"===n.toLowerCase()}return e}}function oe(e){const t=e.querySelector("Chart ChartAreas ChartArea Area3DStyle"),r={};return r.Enable3D=!!t&&"true"===t.getAttribute("Enable3D").toLowerCase(),r}function ce(e){const t=e.querySelector("Chart ChartAreas ChartArea"),r={};return r.BackColor=t?t.getAttribute("BackColor"):"",r.BackSecondaryColor=t?t.getAttribute("BackSecondaryColor"):"",r.BackGradientStyle=t?t.getAttribute("BackGradientStyle"):"",r}function le(e){if(!e)return null;if(function(e){return/^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$/.test(e)}(e=e.trim()))return String.format("rgb({0})",e);if(function(e){return/#[0-9a-fA-F]{6}/.test(e)}(e))return e;if(function(e){return/^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,(\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,){2}\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$/.test(e)}(e)){const t=[];e.split(",").forEach(e=>t.push(e.trim()));const r=t.shift(),n=parseFloat(r)/255,a=t.slice();return a.push(n.toString()),String.format("rgba({0})",a.join(","))}return e}var ue=r("z8iZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function de(e){return{Text:e&&e.Text||"",HorizontalAlignment:e&&e.HorizontalAlignment||"center",VerticalAlignment:e&&e.VerticalAlignment||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class he{constructor(e,t,r,n,a,i,s,o){this._getState=e,this._chartData=a,this._viewRecord=t,this._visualizationRecord=r,this._chartDataDescription=n,this._chartPresentationXML=i,this._drilldownChartType=s,this._entityLogicalName=o}buildChartModel(){if(this._chartQueryModel=Object(ue.a)(),this._chartData.length>0){this._buildChartHeading();try{this._buildChartPresentation(),this._buildChart()}catch(e){if(!(e instanceof N))throw e;this._buildErrorMessage(e)}}else this._buildDataEmptyMessage();return this._chartQueryModel}_buildDataEmptyMessage(){const e=Object(p.b)(this._getState(),g.m),t=de();t.Text=this._visualizationRecord&&this._visualizationRecord.get_DisplayName()?this._visualizationRecord.get_DisplayName():e,t.HorizontalAlignment="center",t.VerticalAlignment="middle",this._chartQueryModel.Title=t,this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName(),this._chartQueryModel.DisplayMode=1,this._chartQueryModel.ErrorInformation=new Y.a,this._chartQueryModel.ErrorInformation.set_ErrorType(null),this._chartQueryModel.ErrorInformation.set_ErrorDescription(e)}_buildErrorMessage(e){this._chartQueryModel.Title=de(),this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName(),this._chartQueryModel.DisplayMode=1,this._chartQueryModel.ErrorInformation=new Y.a,this._chartQueryModel.ErrorInformation.set_ErrorType(e.title),this._chartQueryModel.ErrorInformation.set_ErrorDescription(e.description)}_buildChartHeading(){const e=this._visualizationRecord.get_DisplayName();this._chartQueryModel.Title=de(),this._chartQueryModel.Title.Text=e,this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName()}_buildChartPresentation(){var e;this._chartPresentationParser=Z(this._getState(),this._chartPresentationXML,this._entityLogicalName),this._drilldownChartType&&this._chartPresentationParser.chartPresentationSeries.forEach(e=>{e.ChartType=this._drilldownChartType}),this._chartPresentationSeries=this._chartPresentationParser.chartPresentationSeries,this._chartPresentationXAxis=this._chartPresentationParser.chartPresentationXAxis,this._chartPresentationYAxis=this._chartPresentationParser.chartPresentationYAxis,this._chartPresentationAnnotationList=this._chartPresentationParser.chartPresentationAnnotationList,this._chartPresentationArea3DStyle=this._chartPresentationParser.chartPresentationArea3DStyle,this._chartPresentationAreaGradientStyle=this._chartPresentationParser.chartPresentationAreaGradientStyle,this._chartQueryModel.Legend={Enabled:e&&e.Enabled||!1},this._chartPresentationParser.chartPresentationLegendList.length>0?this._chartQueryModel.Legend.Enabled=this._chartPresentationParser.chartPresentationLegendList[0].Enabled:this._chartQueryModel.Legend.Enabled=!1,this._colors=this._chartPresentationParser.colorsList}_buildChart(){this._chartParserType=this._getChartParserType();const e=function(e){let t=null;switch(e){case 2:t=new q;break;case 3:t=new H;break;case 1:default:t=new W}return t}(this._chartParserType);e.initialize(this._getState,this._chartData,this._chartDataDescription,this._chartPresentationSeries,this._chartPresentationXAxis,this._chartPresentationYAxis,this._chartPresentationArea3DStyle,this._chartPresentationAreaGradientStyle,this._chartQueryModel,this._chartPresentationAnnotationList),this._chartQueryModel.Colors=this._colors,e.parse()}_getChartParserType(){return this._chartDataDescription.isComparisonChart?2:this._chartDataDescription.category.primaryGroupBy.groupAttribute.dateTimeGrouping?3:1}}var pe=r("haag"),ge=r("0L4T"),me=r("nxXM"),be=r("ddoO"),fe=r("q/7h"),ye=r("Tezb"),_e=r("WF3G"),ve=r("4r2D");function Se(e,t,r){return{type:"chartData.retrieve.core.async",execute({dispatch:n,getState:i},o,c){const l=[];try{const u=i();if(!Object(s.b)(i,n,o,l,e,t,r,!0))return Promise.resolve();const d=new _e.a(e.fetchXml);d.set_NoLock(!0),d.set_PageSize(e.dataDefinition.entityExpression.top);const h=function(e){const t={};if(null!=e){const r=new _e.a(e);r.set_PageSize(0),r.set_NoLock(!0),t[""]=r}return t}(e.viewXml);return function(e,t,r,n){const i=new ve.a(a.a.toString(a.a.newGuid()),n&&n.isPreloadCall);return e.retrieveEntitiesForAggregateQuery(t,r,i).nativePromise()}(o.DataSource,d,h,c).then(o=>{const c=function(t,r,n){const a=new Pe(e.viewTitle,e.viewEntityLogicalName),i=new Pe(e.chartName,e.chartPrimaryEntityTypeCode),o=e.dataDefinition,c=Object(fe.a)(t);Object(s.e)(o,c,r());const l=e,u=new he(r,a,i,o,c,e.presentationXml,l.drillDownChartType?l.drillDownChartType:null,n);return u.buildChartModel()}(o,i,t);Object(D.c)(u,k.rd)?(n(je(e.getStorageKey(),c)),Ie(u,n,e.getStorageKey(),r)):(n(Ce(a.a.toString(e.visualizationId),a.a.toString(e.viewId),c)),Oe(u,n,a.a.toString(e.visualizationId),a.a.toString(e.viewId),r))}).catch(t=>{Object(ge.c)(u,n,t,e,r)})}catch(e){return o.EventManager.ReportComponentFailure(s.f+".retrieveChartDataCore",Error(e),pe.b,l),Promise.reject(e)}}}}function Oe(e,t,r,i,s){if(e){const o=new a.a(r),c=a.a.toString(o),l=new a.a(i),u=a.a.toString(l),d={},h={};if(h[u]=function(e,t,r,a){if(!e)return null;if(a&&""!==a){const i=Object(be.c)(e,t,r),s=i&&i.slice();return Object(n.a)(s,a)}return null}(e,c,u,s),h[u]){d[c]=h;const e={entities:null,lists:null,charts:d};t(Object(me.b)(e))}}}function Ie(e,t,r,a){if(e){const i={};if(i[r]=function(e,t,r){if(!e)return null;if(r){const a=Object(be.b)(e,t),i=a&&a.slice();return Object(n.a)(i,r)}return null}(e,r,a),i[r]){const e={entities:null,lists:null,charts:null,chartData:i};t(Object(me.b)(e))}}}function Ce(e,t,r){const n=new a.a(e),s=a.a.toString(n),o=new a.a(t),c={charts:{[s]:{[a.a.toString(o)]:{initialized:i.a.Initialized,chartConfigObject:r}}}};return{type:ye.d,payload:c}}function je(e,t){const r={chartData:{[e]:{initialized:i.a.Initialized,chartConfigObject:t}}};return{type:ye.d,payload:r}}class Pe{constructor(e,t){this._displayName=e,this._associatedEntityLogicalName=t,Object.freeze(this)}get_DisplayName(){return this._displayName}get_AssociatedEntityLogicalName(){return this._associatedEntityLogicalName}}},jR7L:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n="form.entityreferencebyrelationship";function a(e,t){return{type:n,payload:t,meta:{pageId:e}}}},jsFU:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return i}));var n=r("BFlg"),a=r("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="control.update.formlessControlOutputs";function s(e,t,r){return{type:"control.update.formlessControlOutputs.async",execute({dispatch:s,getState:o},c){const l=c.TraceManager.getTracer(n.z),u=n.x+".formlessControlOutputsIdAction";try{if(!Object.keys(r).length)return Promise.resolve();const n=o(),d=Object(a.a)(n,e),h=Object.assign({},d.formlessControlOutputs);let p=!1;l.info("Updating the unbound output.");for(const e in r){const n=r[e],a=t+"."+e;h[a]!==n&&(h[a]=n,p=!0)}return p&&s(function(e,t){return{type:i,payload:{formlessControlOutputs:t},meta:{pageId:e}}}(e,h)),c.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){const t="Updating the outbound outputs for the grid failed with error : "+e.message;c.EventManager.ReportComponentFailure(u,Error(t))}}}}},kC0I:function(e,t,r){"use strict";r.d(t,"i",(function(){return de})),r.d(t,"g",(function(){return re})),r.d(t,"e",(function(){return ne})),r.d(t,"d",(function(){return ae})),r.d(t,"f",(function(){return pe})),r.d(t,"h",(function(){return ge})),r.d(t,"c",(function(){return se})),r.d(t,"a",(function(){return ue})),r.d(t,"b",(function(){return le}));var n=r("SAYH"),a=r("eOoD"),i=r("w1eR"),s=r("eXjw"),o=r("S2mk"),c=r("jRy5"),l=r("ILmX"),u=r("d0w6"),d=r("iZ7K"),h=r("IqkD"),p=r("NjDY"),g=r("YxC/"),m=r("KBcj"),b=r("BzGi"),f=r("BFlg"),y=r("P6DH"),_=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function v(){let e=null,t=null,r=null;return(n,a)=>{const i=a.parentContextToken,s=a.contextString,o=function(e,t){const r=t.parentContextToken;switch(t.contextString){case f.h.ASSOCIATEDGRID:const n=Object(y.gb)(e,t,r);return _.a(r,n.relationshipName,n.ordinal);case f.h.SUBGRID:if(t.descriptor&&t.descriptor.StreamId)return _.o(r,t.descriptor.Name,t.descriptor.StreamId,!!t.descriptor.IsTile);const a=_.p(r,t.descriptor.Name),i=a&&a.parentContextToken?a.parentContextToken.entityTypeName:null;return a.relationshipType=se(e,t,i,a),a;case f.h.GRID:return _.k(e,t.id);case f.h.CUSTOM:return _.c(r,t.controlId);default:return r}}(n,a);return(r!==s||S(e,o)||S(t,i))&&(e=o,t=i,r=s),e}}function S(e,t){return e&&t?e.entityTypeName!==t.entityTypeName||e.controlName!==t.controlName||(e.formId&&e.formId.guid)!==(t.formId&&t.formId.guid)||(e.recordId&&e.recordId.guid)!==(t.recordId&&t.recordId.guid)||e.relationshipName!==t.relationshipName||e.roleOrd!==t.roleOrd:e!==t}var O=r("5O6t"),I=r("XvLr"),C=r("LzVy"),j=r("sclX"),P=r("unFF"),T=r("GYEz"),E=r("o0iw"),w=r("504W"),F=r("3hnk"),x=r("sZ+8"),A=r("69Qu"),N=r("3/02"),D=r("Lyxw"),k=r("kt5S"),M=r("jAuy"),R=r("arV0"),L=r("pEXn"),B=r("5R5s"),V=r("VnpK"),G=r("85o3"),U=r("lEp6"),X=r("YPtO"),z=r("0kGT"),q=r("Z/4N"),H=r("nIfK"),W=r("8nT0"),Y=r("CbNq"),Q=r("b41/"),K=r("7+p5"),J=r("37s6"),Z=r("LbMF"),$=r("SJlc"),ee=r("AVDU"),te=r("H4dV");function re(e){return e===f.h.SUBGRID}function ne(e){return e===f.h.GRID}function ae(e){return e===f.h.ASSOCIATEDGRID}function ie(e){switch(e){case f.h.ASSOCIATEDGRID:case f.h.SUBGRID:return"div";case f.h.GRID:default:return"section"}}function se(e,t,r,n){let a=r?Object(d.G)(e,r,n.relationshipName):null;if(null===a&&t.descriptor&&t.descriptor.Parameters){const n=t.descriptor.Parameters[f.F.RELATIONSHIP_NAME],i=t.descriptor.Parameters[f.F.TARGET_ENTITY_TYPE];n&&r?a=Object(d.G)(e,r,n):n&&i&&(a=Object(d.G)(e,i,n))}return a}function oe(){let e=null,t=null;return r=>(e!==r.contextString&&(e=r.contextString,t=function(e){switch(e.contextString){case f.h.ASSOCIATEDGRID:case f.h.SUBGRID:return[u.a.SUB_GRID,u.a.MAIN_APPLICATION_VIEW];case f.h.GRID:return e.isAdvancedFindView?[u.a.ADVANCED_SEARCH]:[u.a.MAIN_APPLICATION_VIEW];default:return[u.a.MAIN_APPLICATION_VIEW]}}(r)),t)}function ce(e){return e&&[e.CustomControlId,e.Name].some(e=>-1!==H.a.indexOf(e))}function le(e,t,r){if(!e||!e.contextTokenType||e.contextTokenType!==c.a.AssociatedGrid&&e.contextTokenType!==c.a.MainGrid)return null;switch(t){case"displayChart":return!1;case"displayCommandBar":return!0;case"displayIndex":return ce(r);case"displayQuickFind":case"displayViewSelector":return!0}return null}function ue(){let e=null,t=null;return(r,n,a)=>{if(e&&t===n.CustomControlId)return e;const i=n&&n.CustomControlId?n.CustomControlId:null;if(!i)return null;const s=Object(y.ab)(r,i),o=Object(q.e)(r,i);if(s&&o&&o.Properties.DataSetDefinitions&&o.Properties.DataSetDefinitions[s]&&o.Properties.DataSetDefinitions[s].CDSDataSetOptions){const r=o.Properties.DataSetDefinitions[s].CDSDataSetOptions;e={displayChart:r.hasOwnProperty("displayChart")?r.displayChart:le(a,"displayChart",n),displayCommandBar:r.hasOwnProperty("displayCommandBar")?r.displayCommandBar:le(a,"displayCommandBar",n),displayIndex:r.hasOwnProperty("displayIndex")?r.displayIndex:le(a,"displayIndex",n),displayQuickFind:r.hasOwnProperty("displayQuickFind")?r.displayQuickFind:le(a,"displayQuickFind",n),displayViewSelector:r.hasOwnProperty("displayViewSelector")?r.displayViewSelector:le(a,"displayViewSelector",n)},t=n.CustomControlId}return e}}function de(){let e,t=null,r=null,c=null,_=null,S="",V=null,q=null,H=null,le=null,ue=null,de=null,pe=null,fe=null;const ye=function(){let e=null;return(t,r,n,a)=>{let i=e;switch(Object(w.b)(a)&&(a=r.contextString),a){case f.h.ASSOCIATEDGRID:i=Object(l.b)(n);break;case f.h.SUBGRID:i=Object(l.l)(n);break;case f.h.GRID:default:i=Object(l.h)(n)}return i!==e&&(e=i),e}}(),_e=Object(O.a)(),ve=v(),Se=function(){let e=null;const t=function(){let e=null;return(t,r,a)=>{let s,c,l,u,d;if(Object(y.ib)(t,r.id,a)){s=Object(y.T)(t,r.id,a);const e=Object(y.qb)(t,s,r.id);c=e&&e.entityLogicalName,d=e&&e.isUserView,l=Object(y.r)(t,r.id,a,c),u=Object(y.s)(t,r.id,a)!==b.a.savedvisualization}else{const e=Object(y.ab)(t,r.configuration.CustomControlId);if(e){const t=r.configuration.Parameters[e];t&&(s=t.ViewId&&new n.a(t.ViewId),c=t.TargetEntityType,l=t.VisualizationId&&new n.a(t.VisualizationId),u=!(!t.IsUserChart||"true"!==t.IsUserChart),d=!(!t.IsUserView||"true"!==t.IsUserView))}}if(!n.a.isNullOrEmpty(s)&&l&&c){const h=Object(y.q)(t,r.id,a),p=Object(y.p)(t,r.id,a),g=Object(y.C)(t,r.id,a),m=he(t,r,a,g,!0),b=Object(y.N)(t,r.id,a),_=t.user&&t.user.userId,v=Object(D.c)(t,N.Zc),S=Object(B.a)(c,_,a,v),O=S&&S.getFilterAndLinkedEntities(g&&g.activityOrQueueFilterValue?g.activityOrQueueFilterValue:void 0),I=O&&null!==O.linkEntities?JSON.stringify(O.linkEntities):null,C=Object(D.a)(t,N.Od,N.h),j=!C||C&&Object(T.a)(t)===i.a.MobileApplication,P=C,E=ae(r.contextString)?Object(o.p)(f.d,c,n.a.toString(s),n.a.toString(l),a.relationshipName,b,u,d,m,I,P):Object(o.t)(f.d,c,n.a.toString(s),n.a.toString(l),b,h,u,p,d,m,I,j,P);if(e){const r=E&&E.CustomControlId?E.CustomControlId:null,n=Object(y.ab)(t,r);if(n&&E.Parameters[n]){const t=E.Parameters[n],r=e.Parameters[n];t.ViewId===r.ViewId&&t.VisualizationId===r.VisualizationId&&t.EntityName===r.EntityName&&t.HighchartFilterExpression===r.HighchartFilterExpression&&t.ChartDrillDownParameters===r.ChartDrillDownParameters&&t.ExtraFilters===r.ExtraFilters||(e=E)}}else e=E}else if(e&&c&&!l){const r=e.CustomControlId,n=Object(y.ab)(t,r);n&&e.Parameters[n]&&c!==e.Parameters[n].EntityName&&(e=null)}return e}}();return(r,n,a)=>{const i=t(r,n,a),s=n.id;return e&&e.configuration===i&&e.id===s||(e={configuration:i,id:s,chartId:f.d,showChart:!0,contextToken:a}),e}}(),Oe=function(){let e=null;return(t,r,n,a,i,s)=>{const o=s.commandBarStyle,c=r.id,l=se(t,r,n&&n.parentContextToken?n.parentContextToken.entityTypeName:null,n),u=Object(y.w)(t,c,n);return e&&e.commandManagerId===u&&e.pageId===c&&e.ribbonId===i&&e.relationshipType===l&&e.contextToken===n&&e.style===o||(e={commandManagerId:u,pageId:c,ribbonId:i,relationshipType:l,contextToken:n,style:o}),e}}(),Ie=function(){let e=null;const t=oe();return(r,a,i,s,o,c)=>{var l;const d=c.viewSelectorStyle,p=n.a.toString(o),g=t(a),b=Object(y.nb)(a.id,p),f=ne(a.contextString),_=f,v=a.contextString,S=Object(y.Z)(r),O=Object(h.g)(r),I=Object(y.qb)(r,o,a.id),C=I?I.title:null;let j=u.a.MAIN_APPLICATION_VIEW;re(v)?j=u.a.SUB_GRID:f&&a.isAdvancedFindView&&(j=u.a.ADVANCED_SEARCH);const P=Object(m.a)(r,s,j),T=P||n.a.EMPTY,E=Object(R.g)(r,null==a?void 0:a.id),w=Object(y.rb)(r,null===(l=null==E?void 0:E.pageToEditedViewMapId)||void 0===l?void 0:l.guid,null==o?void 0:o.guid);return e&&e.id===b&&e.entityTypeName===s&&e.selectedViewId===p&&e.queryViewSelectorTypes===g&&e.shouldDisplayNestedViewSelector===_&&e.isRTL===O&&e.defaultViewId===T&&e.isEdited===!!w||(e={id:b,pageId:a.id,title:C,entityTypeName:s,selectedViewId:p,style:d,queryViewSelectorTypes:g,shouldDisplayNestedViewSelector:_,contextString:v,pinnedActivityView:S,isRTL:O,defaultViewId:T,isAdvancedFindView:a.isQueryMode&&a.isAdvancedFindView,isEdited:!!w,pageToEditedViewMapId:null==E?void 0:E.pageToEditedViewMapId}),e}}(),Ce=function(){let e=null;return(t,r,n,a,i)=>{const s=r.id,o=Object(y.G)(t,r),c=Object(h.w)(t),l=i.filterComboStyle,u=Object(R.g)(t,s).entityFilterValue;return e&&e.id===s&&e.entityTypeName===a&&e.filterOptions===o&&e.comboBoxStyle===l&&e.userSetting===c&&u===e.previousValue||(e={id:s,filterOptions:o,entityTypeName:a,updateFilterValue:null,onFilterChange:null,resourceStrings:null,userSetting:c,style:null,comboBoxStyle:l,previousValue:u}),e}}(),je=function(){let e=null;return(t,r,n,a,i)=>{const s=r.id,o=Object(y.G)(t,r,a),c=Object(Y.a)(t),l=i.filterComboStyle,u=i.dueDateComboBoxStyles,d=i.activityTypeComboBoxStyles,p=Object(M.h)(t,n.relationshipName,ae(r.contextString)),g=!Object(A.b)(t),m=Object(y.kb)(t,s,n),b=Object(h.g)(t),f=Object(P.a)(t),_=Object(R.g)(t,s),v=_.entityFilterValue,S=_.activityTypeFilterValue,O=Object(D.a)(t,N.a,N.h),C=Object(D.a)(t,N.a,N.Lc),j=Object(y.ub)(t,a),T=Object(D.c)(t,N.Zc),E=Object(B.a)(a,t.user.userId,n,T,j),w=E&&E.getFilterLabelResourceKey(),F=I.ACTIVITY_MGMT_ACTIVITY_TYPE_LABEL,x=I.ACTIVITY_MGMT_DUE_DATE_LABEL;if(!e||e.id!==s||e.entityTypeName!==a||e.filterOptions!==o||e.comboBoxStyle!==l||e.dueDatecomboBoxStyle!==u||e.activityTypecomboBoxStyle!==d||e.labelStyle!==i.filterLabelStyle||e.activityMgmtLabelStyle!==i.activityMgmtLabelStyle||e.isActivityManagementFeatureEnabled!==O||e.filterOptionsForActivityType!==c||e.isRollupViewSupported!==p||e.isOffline!==g||e.toggleValue!==m||e.isRTL!==b||e.theme!==f||e.previousValue!==v||e.activityTypePreviousValues!==S||e.isActivityFilterSelectAllEnabled!==C||e.entityIsActivityType!==j){const t={isRollupViewSupported:p,isOffline:g,toggleValue:m,onToggleChange:null,isRTL:b,theme:f};e=Object.assign({id:s,filterOptions:o,filterOptionsForActivityType:c,entityTypeName:a,onFilterChange:null,onActivityTypeChange:null,onActivityTypeFilterClear:null,gridEntityName:null,resourceStrings:null,comboBoxStyle:l,dueDatecomboBoxStyle:u,activityTypecomboBoxStyle:d,containerStyle:null,activityTypeContainerStyle:null,labelStyle:i.filterLabelStyle,activityMgmtLabelStyle:i.activityMgmtLabelStyle,previousValue:v,activityTypePreviousValues:S,isActivityManagementFeatureEnabled:O,activityViewContainerStyle:i.activityViewContainerStyle,entityFilterLabelResourceString:w,activityTypeFilterLabelResourceString:F,dueDateFilterLabelResourceString:x,isActivityFilterSelectAllEnabled:C,isRTL:b,entityIsActivityType:j},t)}return e}}(),Pe=function(){let e=null;const t=[1041,2052,3076,1028,1042];return(r,n,a,i,s,o)=>{const c=r.id,l=r.descriptor&&r.descriptor.Id?r.descriptor.Id:null,u=s?JSON.parse(s).conditions[0]:null,d=function(e,t){if(t=t?t.value.replace("%","").toUpperCase():null,e){const r=ge(e.split(",")[0]),n=r[1].split("|");if(n&&t===n[0])return r[1]}return t}(Object(g.c)(o,I.JUMPBAR_ALPHABET),u);return t.indexOf(i)>-1?e=null:e&&e.id===c&&e.contextToken===n&&e.entityTypeName===a&&e.selectedFilter===d||(e={id:c,uniqueId:l,contextToken:n,entityTypeName:a,selectedFilter:d,languageId:i}),e}}(),Te=function(){let e=null;return(t,r,n,a)=>{const{id:i,contextString:s}=t;return e&&e.id===i&&e.contextToken===r&&e.entityTypeName===n&&e.gridInput===a||(e={id:i,contextToken:r,entityTypeName:n,contextString:s,gridInput:a}),e}}(),Ee=function(){let e=null;return(t,r,n)=>{const{id:a,contextString:i}=t;return e&&e.id===a&&e.contextToken===r||(e={id:a,contextToken:r,contextString:i}),e}}(),we=Object(g.h)(),Fe=function(){let e=null,t=null;const r={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},n={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1};let s=null;const o={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},c={Type:"WholeNumber.None",Usage:1,Static:!0,Value:!1,Primary:!1},l={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},u={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},d={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},h={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},g={Type:"TwoOptions",Usage:1,Static:!0,Value:!1,Primary:!1},m={Type:"TwoOptions",Usage:1,Static:!0,Value:!1,Primary:!1};let b,f,_={useSkypeProtocol:r,gridPageNumber:n,isNewPageRequested:o,enhancedPagingDisabled:c,isActivityTypeFilterDisabled:l,showAddNewCommand:u,emptySubgridIconAndTextChanges:d,emptyGridChangesIfQuickFindImprovementsEnabled:h,headerDialogOnTop:g,headerDialogPreventDismissOnScroll:m};return(v,S,O)=>{const I=Object(T.e)(v),P=Object(p.x)(v).useSkypeProtocol,E=Object(y.x)(v,S.id,O),w=Object(y.X)(v,S.id,O);w||s===E||(s=E),b||(b=Object(C.a)(v),f=null!=b&&b===j.b.Native);const F=!f,x=Object(D.a)(v,N.a,N.h),{systemDefinedProperties:A}=S,k=E!==s&&w,M=F!==c.Value;let R=!1;x&&(ae(S.contextString)||ne(S.contextString))&&(R=!0);let L=!1;Object(z.a)(v)&&re(S.contextString)&&(L=!0);let B=!1;Object(z.a)(v)&&Object(D.c)(v,N.Md)&&re(S.contextString)&&Object(T.a)(v)===i.a.MobileApplication&&(B=!0);let V=!1;if(Object(z.a)(v)&&Object(D.c)(v,N.ad)&&ne(S.contextString)&&Object(T.a)(v)===i.a.MobileApplication){const e=Object(y.C)(v,S.id,O);(null==e?void 0:e.quickFind)&&(V=!0)}const G=!ne(S.contextString)&&a.a.Tablet===I,U=a.a.Tablet===I&&!ae(S.contextString)||"Web"===Object(T.k)(v)&&!te.a.getInstance().get_IsAndroid()&&!te.a.getInstance().get_IsWindows()&&!te.a.getInstance().get_isIPhone();if(I!==e||P!==t||k||M||w!==o.Value||R!==l.Value||L!==u.Value||B!==d.Value||V!==h.Value||G!==g.Value||U!==m.Value){e=I,t=P,n.Value=E,s=E,o.Value=w,c.Value=F,l.Value=R,u.Value=L,d.Value=B,h.Value=V,g.Value=G,m.Value=U;const a=null==e?P:null;(a!==r.Value||k||M)&&(r.Value=a,_=Object.assign(Object.assign({},A),{useSkypeProtocol:r,gridPageNumber:n,isNewPageRequested:o,enhancedPagingDisabled:c,isActivityTypeFilterDisabled:l,showAddNewCommand:u,emptySubgridIconAndTextChanges:d,emptyGridChangesIfQuickFindImprovementsEnabled:h,headerDialogOnTop:g,headerDialogPreventDismissOnScroll:m}))}return _}}(),xe=function(){let e=null,t=null;return(r,n,a)=>(r&&(t&&e===r&&!a||(t=Object.assign({},r),r.Parameters&&(t.Parameters=Object.assign({},r.Parameters),n&&r.Parameters[n]&&(t.Parameters[n]=Object.assign({},r.Parameters[n]),r.Parameters[n].Columns&&(t.Parameters[n].Columns=r.Parameters[n].Columns.slice(0)))),e=r)),t)}(),Ae=Object(E.s)(),Ne=function(){const e=[];return(t,r,n,a,i,s,o,c,l,u,d)=>(e&&e.length&&e.splice(0,e.length),e.push({name:L.b.IsGridRoot,value:t},{name:L.b.IsSubGrid,value:r},{name:L.b.IsAssociatedGrid,value:n},{name:L.b.EntityName,value:a},{name:L.b.ViewId,value:i},{name:L.b.IsEmptyFetch,value:s},{name:L.b.IsEmptyOfflineSqlQuery,value:o},{name:L.b.IsValidFetchXmlForOfflineUsage,value:c},{name:L.b.IsEntityAvailableForOfflineUsage,value:l},{name:L.b.OfflineConfigurationErrorCode,value:u},{name:L.b.RelatedEntityUnavailableOffline,value:d}),e)}(),De=function(){let e=null;return t=>(e||(e={isGridPaginationStateFeatureEnabled:Object(D.a)(t,N.zb),isAssociatedGridHeightEnabled:Object(M.e)(t),isChartOnAssociatedGridEnabled:Object(D.a)(t,N.x,N.h,N.i),isGridProgressIndicatorFeatureEnabled:Object(D.a)(t,N.Ab),isInMobileModeForOct2019:Object(z.b)(t),isJumpBarShouldHonorSortingFeatureEnabled:Object(D.a)(t,N.ac),isJumpbarFeatureForMobileEnabled:Object(D.c)(t,N.Kb),isSuiterChartEnabled:Object(D.a)(t,N.Od,N.h),isSuiterDashboardEnabled:Object(D.a)(t,N.Pd,N.h),isAdvancedFindEnabled:Object(K.a)(t),isDisableEditableGridControlOnPhoneFeatureEnabled:Object(D.c)(t,N.O),isInMobileModeForApril2020:Object(z.a)(t),isSubgridImprovementsEnabled:Object(D.c)(t,N.Md),isSubGridAutoCollapseEnabled:Object(D.a)(t,N.Jd,N.Lc),isSubGridRemoveMinHeightEnabled:Object(D.a)(t,N.Ld,N.Lc),isQuickFindImprovementsEnabled:Object(D.c)(t,N.ad),isShowAsButtonFirstEnabled:Object(D.c)(t,N.Bd),isColumnEditorButtonEnabled:Object(y.tb)(t),isQueueFilterPerfUCIEnabled:Object(D.c)(t,N.Zc)}),e)}(),ke=function(){let e={fetchXML:null,entityName:null,isOffline:null},t={error:!1,errorCode:null,relatedEntityUnavailableOffline:null};return function(r,n,a,i){if(e.entityName!==a||e.fetchXML!==n||e.isOffline!==i)if(Object(x.k)(a)){const s=Object(x.b)(r,n);t={error:s.error,errorCode:s.error?I.LINKED_ENTITY_NOT_SUPPORTED:null,relatedEntityUnavailableOffline:s.relatedEntityUnavailableOffline},e={fetchXML:n,entityName:a,isOffline:i}}else t={error:!0,errorCode:I.ACTIVITY_ENTITY_NOT_SUPPORTED_OFFLINE},e={fetchXML:n,entityName:a,isOffline:i};return t}}();return function(a,i){var o;const l=Object(h.w)(a),b=ve(a,i),v=Object(y.v)(a,i.id,b),O=b.relationshipName,E=b.roleOrd,L=Object(y.N)(a,i.id,b),z=Object(y.I)(a,i.id,b),Y=Object(y.x)(a,i.id,b),K=i.descriptor,te=be.bind(null,i,K),se=i.configuration,oe=se&&se.CustomControlId?se.CustomControlId:null,ge=Object(C.a)(a),Me=Object(T.e)(a),Re=Object(y.ab)(a,oe)||(i.contextString===f.h.CUSTOM?f.g:null),Le=ne(i.contextString),Be=De(a),Ve=Object(y.A)(a,b,i);let Ge=null,Ue=!1,Xe=null;const ze=Object(y.t)(a,i.id,b),qe=Object(y.C)(a,i.id,b);Le&&(Ge=Object(R.g)(a,i.id),Be.isGridPaginationStateFeatureEnabled&&(Xe=Ge.gridSortingInfo,Xe&&(Object(w.a)(le)||le!==Xe)&&(le=Xe,Ue=!0),ze&&(Object(w.a)(ue)||ue!==ze.customFilterXml)&&(ue=ze.customFilterXml,Ue=!0)),(qe&&Object(w.a)(de)||de!==qe)&&(de=qe,Ue=!0));const He=xe(se,Re,Ue),We=He&&He.Parameters?He.Parameters[Re]:null,Ye=ae(i.contextString),Qe=re(i.contextString),Ke=!Object(A.b)(a),Je=Object(y.jb)(a,b,i),Ze=We&&!!We.DataProvider,$e=We&&!!We.BoundViewParams,et=Object(p.x)(a),tt=et&&et.gridTotalRecordCountLimit?et.gridTotalRecordCountLimit:5e3,rt=Object(y.ib)(a,i.id,b),nt=ce(i.configuration),at=ce(i.configuration);if(null!=i.nonCompositionProps){const e=se&&se.FormFactor&&se.FormFactor.toString(),t=Object(k.c)(i.nonCompositionProps.gridConfigurations,i.nonCompositionProps.viewConfigurations,se,null,f.h.GRID,e).map(e=>e.configuration.DisplayNameKey),r=we(a,t);(!H&&""!==Object(g.c)(r,t[0])||H!==r)&&(H=r)}let it=!!v;let st=Object(y.T)(a,i.id,b)||(K&&K.Parameters&&K.Parameters.ViewId?n.a.parse(K.Parameters.ViewId):null);const ot=Object(y.qb)(a,st,i.id),ct=(null==ot?void 0:ot.isUserView)?u.b.userview:u.b.savedview,lt=null==ot?void 0:ot.queryType,ut=null==ot?void 0:ot.entityLogicalName;ut&&ut!==c&&(c=ut);const dt=Object(d.h)(a,c),ht=!Ke&&ge===j.b.Web&&Le&&Be.isAdvancedFindEnabled&&(null==dt?void 0:dt.IsValidForAdvancedFind);if(!q||e!==ht){let t=[...I.labelList];ht&&(t=[...t,Q.c.OpenAdvancedFiltersTitleAndAria]);const r=we(a,t);""!==Object(g.c)(r,I.JUMPBAR_ALL_TITLE)?(q=r,e=ht):it=!1}const pt=Object(y.W)(a,oe);pt&&pt!==V&&(V=pt);const gt=_e(a,i);ce(i.configuration)&&(Object.assign(gt.bodyStyle,{flexDirection:"column"}),Object.assign(gt.bodyMobileStyle,{flexDirection:"column"}));let mt=Object(y.F)(a,i.id,b)||(K&&K.Parameters&&K.Parameters[f.u]?K.Parameters[f.u]:null),bt=mt;Le&&(bt=Ge.entityTypeName);const ft=Object(F.b)(a,mt);dt&&dt.Initialized===s.a.Initialized||Ze||$e||(it=!1);const yt=dt?dt.DisplayName:"",_t=Object(p.t)(a),vt=Object(d.i)(a,mt),St=!(ot&&ot.fetchXML),Ot=ot&&ot.viewId,It=ke(a,St?"":ot.fetchXML,c,Ke),Ct=!St&&!It.error,jt=null!=ot&&Object(w.b)(ot.offlineSqlQuery),Pt=Object(x.l)(a,c),Tt=Ne(Le,Qe,Ye,c,Ot?Ot.guid:null,St,jt,Ct,Pt,It.error&&It.errorCode||"",It.error&&It.relatedEntityUnavailableOffline||""),Et=!((Le||Ye||Qe)&&ot&&ot.fetchXML&&Ke&&Pt)||!jt&&Ct;let wt="";if(Et?Pt||(wt=I.ENTITY_NOT_AVAILABLE_IN_PROFILE):jt?wt=I.SQL_QUERY_NOT_AVAILABLE:It.error&&(wt=It.errorCode),We){We.TargetEntityType&&mt!==We.TargetEntityType&&(mt=We.TargetEntityType),We.ExtraFilters=he(a,i,b,qe,!1);const e=function(e,t,r,n,a){let i=[];const s=Object(y.q)(e,t.id,r);if(s){const e=JSON.parse(s);if(e.conditions)for(const t of e.conditions)t.linkEntityExpressions&&(i=i.concat(t.linkEntityExpressions))}const o=e.user&&e.user.userId,c=Object(D.c)(e,N.Zc),l=Object(y.ub)(e,n),u=Object(B.a)(n,o,r,c,l);let d=u&&u.getFilterAndLinkedEntities(a&&void 0!==a.activityOrQueueFilterValue?a.activityOrQueueFilterValue:G.a,a&&!a.activityOrQueue);d&&d.linkEntities&&(i=i.concat(d.linkEntities));return d=d||{filter:null,linkEntities:null},d.linkEntities=i,d}(a,i,b,mt,qe);if(e&&e.filter&&(We.ExtraFilters?We.ExtraFilters.push(JSON.stringify(e.filter)):We.ExtraFilters=[JSON.stringify(e.filter)]),e&&e.linkEntities&&e.linkEntities.length>0){let t={Static:!0,Value:Object(U.b)(e.linkEntities)};if(We.LinkingInput){t=We.LinkingInput;const r=Object(U.a)(We.LinkingInput.Value);if(r){const n=new X.a;r.forEach(e=>{n.addLinkedEntity(e)}),e.linkEntities.forEach(e=>{n.addLinkedEntity(e)}),t.Value=Object(U.b)(n.getLinkedEntities())}}We.LinkingInput=t}if(st){const e=n.a.toString(st);e!==We.ViewId&&(We.ViewId=e)}else st=n.a.tryParseOrNull(We.ViewId);(K&&K.Parameters?"false"===K.Parameters[f.F.ENABLE_CONTEXTUALACTIONS]:null)&&(He.Parameters[f.i]={Usage:1,Static:!0,Type:"Enum",Value:!1,Primary:!1})}mt&&mt!==_&&(_=mt);const Ft=Object(d.r)(a,mt)&&i.contextString===f.h.GRID?y.a:mt,xt=We&&We.CommandBarContext,At=ye(a,i,Ft,xt),Nt=function(e,t,r){const n=Object(y.qb)(e,t,r);return n&&n.grid&&n.grid.rows&&n.grid.rows[0]&&n.grid.rows[0].cells}(a,st,i.id),Dt=null==Nt?void 0:Nt.map(e=>e.name),kt=null==r?void 0:r.map(e=>e.name);(JSON.stringify(Dt)!==JSON.stringify(kt)||(st&&st.guid)!==(t&&t.guid)||O===pe&&E!==fe)&&(t=st,fe=E,S=(K&&K.Id?K.Id:"")+(new Date).getTime(),r=Nt),O&&O!==pe&&(pe=O);const Mt=Object(y.o)(a,mt),Rt=Mt?Mt.lookupAttribute:null;We&&(function(e,t,r,n,a,i,s){const o=Object(d.h)(e,n);if(o&&ce(t.configuration)){const c=f.b;r.Columns||(r.Columns=[]),n!==y.a||a&&a.some(e=>e.name===c)||r.Columns.find(e=>e.Name===c)||r.Columns.push({Alias:c,DataType:"",Type:"",Name:c});const l=o&&o.PrimaryNameAttribute,u=a&&a.some(e=>e.name===l);if(!l||u||r.Columns.some(e=>e.Name===l)||r.Columns.push({Alias:l,DataType:"",Type:"",Name:l}),!Object(y.vb)(t.configuration.Parameters)){const t=Object(M.a)(o.PrimaryImageAttribute);t&&!r.Columns.find(e=>e.Name===t)&&r.Columns.push({Alias:W.d,DataType:"SingleLine.Text",Type:"",Name:t}),Object(D.a)(e,N.ub)&&i&&s&&(r.Columns.find(e=>e.Name===y.c)||r.Columns.push({Alias:y.c,DataType:"Whole.None",Type:"",Name:y.c,PreventMetadataRequest:!0}),r.Columns.find(e=>e.Name===i)||r.Columns.push({Alias:i,DataType:"Lookup.Simple",Type:"",Name:i}))}}}(a,i,We,mt,r,Rt,!Object(w.a)(Ge)),function(e,t,r,n,a){if(!Object(y.vb)(t.configuration.Parameters))return;(null==a?void 0:a.some(t=>{var r;return(null===(r=Object(Z.a)(e,n,t.name))||void 0===r?void 0:r.Type)===$.a.moneyType}))&&(r.Columns.some(e=>e.Alias===f.A)||r.Columns.push({Alias:f.A,DataType:"Lookup.Simple",Type:"",Name:W.w}))}(a,i,We,mt,r));const Lt=!mt||(Object(F.i)(mt)||Object(F.g)(a,mt,2,0)&&function(e,t){let r=!0;t&&t.forEach(t=>{if(t.relatedEntityName&&(r=Object(F.g)(e,t.relatedEntityName,2,0),!r))return!1});return r}(a,r)),Bt=Object(y.Y)(a,i.id,b),Vt=Bt?JSON.parse(Bt):null,Gt=Vt?Vt.totalResultCount:null,Ut=Vt?Vt.pageSize:null,Xt=null!==Gt&&Gt>-1?0===Gt?Object(g.c)(q,I.NO_DATA_AVAILABLE):String.format(I.X_RECORDS_PRESENT,Gt):"",zt=Ae(a,Le),qt=!(null!=ge&&ge===j.b.Native),Ht=Object(y.rb)(a,null===(o=null==Ge?void 0:Ge.pageToEditedViewMapId)||void 0===o?void 0:o.guid,null==st?void 0:st.guid),Wt={isEmptyOfflineSqlQuery:jt,isEntityAvailableForOffline:Pt,isOfflineSqlQueryAvailable:Et,offlineErrorMessageKey:wt,isOfflineAvailableForUse:Object(J.w)(a),offlineGridErrorTelemetryParams:Tt},Yt=Object(ee.d)(a),Qt=Object(m.c)(a,t),Kt=!Ke&&ge===j.b.Web&&Le&&Be.isColumnEditorButtonEnabled&&!Ye&&!Qe,Jt=Object(y.ub)(a,mt);return{showAdvancedFilter:ht,isViewEdited:!!Ht,isInitialized:it,viewId:t,customFilter:ze,gridEntityTypeName:c,chartEntityTypeName:c,isUCIEntity:ft,totalRecordCountLimitExceeded:Je,chartProps:rt?Se(a,i,b):null,viewDescriptor:ot,commandBarProps:te(f.E.COMMANDBAR_ENABLED,!0,f.F.ENABLE_CONTEXTUALACTIONS,Re,!0)?Oe(a,i,b,K,At,gt):null,viewSelectorProps:bt&&te(f.E.VIEWSELECTOR_ENABLED,!0,f.F.ENABLE_VIEW_PICKER,Re)?Ie(a,i,b,bt,t,gt):null,queueFilterProps:se&&te(null,!0,f.F.ENABLE_QUEUEFILTER,Re)?Ce(a,i,b,mt,gt):null,entityFilterProps:Ke||!Jt&&!Object(M.h)(a,pe,Ye)?null:je(a,i,b,mt,gt),jumpBarProps:te(f.E.JUMPBAR_ENABLED,nt,f.F.ENABLE_JUMPBAR,Re)&&me(i)?Pe(i,b,mt,l.languageId,qe?qe.jumpBar:null,q):null,quickFindProps:te(f.E.QUICKFIND_ENABLED,!0,f.F.ENABLE_QUICKFIND,Re)?Te(i,b,mt,Ge):null,pagingProps:te(f.E.PAGING_ENABLED,at,null,Re)?Ee(i,b,mt):null,contextToken:b,controlKey:S,styles:gt,refreshCounter:L,pagingRefreshInput:z,pageNumber:Y,ribbonId:At,semanticTag:ie(i.contextString),recordsPerPageSetting:Object(h.h)(a),userSetting:l,hasReadRolePrivilege:Lt,resourceStrings:q,switchVisualizationResourceStrings:H,entityTypeName:_,primaryDataSetName:Re,nestedGridDatasetName:V,viewportSm:Object(P.a)(a).sizes.Breakpoints.DimensionS,viewportM:Object(P.a)(a).sizes.Breakpoints.DimensionM,systemDefinedProperties:Fe(a,i,b),platformType:Object(C.a)(a),isGridEditable:Object(y.vb)(se?se.Parameters:null),notificationMessage:Xt,totalResultCount:Gt,pageSize:Ut,offlineProps:Wt,isRTL:Object(h.g)(a),entityDisplayName:yt,isOffline:Ke,showChart:rt,entityIconVectorName:vt,webResourceUrl:_t,hasCustomDataProvider:Ze,commandBarRefreshProps:zt,updatedConfiguration:He,offlineGridErrorTelemetryParams:Tt,gridInput:Ge,gridTotalRecordsCountLimit:tt,gridSortingInfo:Xe,nativeFilterExpression:Be.isGridPaginationStateFeatureEnabled&&Ge?Ge.nativeFilterExpression:null,pageNumberForEnhancedPaging:Be.isGridPaginationStateFeatureEnabled&&!qt&&Ge?Ge.gridPageNumber:null,userId:a.user&&a.user.userId||null,lookupAttributeForRecordHierarchy:Rt,fetchXML:Ve,viewType:ct,savedQueryType:lt,featureControlProps:Be,clientHostSubtype:Me,backButtonEnabled:Yt,originalView:Qt,showColumnEditor:Kt,entityIsActivityType:Jt}}}function he(e,t,r,n,a){if(!n)return[];const i=ne(t.contextString),s=ae(t.contextString),o=re(t.contextString)&&Object(D.c)(e,N.bd),c=[];for(const e in n)c.push([e,n[e]]);const l=c.reduce((e,[t,r])=>((i||s||o)&&"quickFind"===t||("activityOrQueueFilterValue"===t||"activityTypeSelectedValues"===t)||!r||e.push(r),e),[]);if(a){const n=Object(y.t)(e,t.id,r);if(n&&n.customFilterXml){const e=Object(V.i)(n.customFilterXml),t=JSON.stringify(e);t&&l.push(t)}}else{const n=Object(y.q)(e,t.id,r);n&&l.push(n)}return l}function pe(e){let t=e.configuration&&"MscrmControls.SharepointAssociatedGrid.SharepointControl"===e.configuration.CustomControlId;return t||(t=e.configuration&&"MscrmControls.SharepointAssociatedGrid.SharepointControl"===e.configuration.Name),t}function ge(e){if(!e&&"("!==e[0]||")"!==e[e.length-1])throw new Error(String.format("Resource string group must be in the format (A:a).  The format {0} is invalid.",e));const t=(e=(e=e.replace("(","")).replace(")","")).split(":");if(2!==t.length)throw new Error("Resource string group must have a search list defined.  E.g : (A:a).");return t}function me(e){var t,r,n;return"no"!==(null===(n=null===(r=null===(t=e.configuration)||void 0===t?void 0:t.Parameters)||void 0===r?void 0:r.EnableJumpBar)||void 0===n?void 0:n.Value)}function be(e,t,r,n,a,i,s){let o=e.dataSetUIOptions,c=n;if(s=!!Object(w.a)(s)||s,!o&&e.configuration&&e.configuration.Parameters){const t=e.configuration.Parameters[i];t&&t[f.f]&&(o=t[f.f])}const l=t&&t.Parameters&&t.Parameters[a]?"true"===t.Parameters[a]:s;return o&&r&&!Object(w.a)(o[r])&&(c=o[r]),c&&l}},kt5S:function(e,t,r){"use strict";r.d(t,"g",(function(){return _})),r.d(t,"i",(function(){return v})),r.d(t,"h",(function(){return S})),r.d(t,"e",(function(){return O})),r.d(t,"f",(function(){return I})),r.d(t,"a",(function(){return C})),r.d(t,"c",(function(){return P})),r.d(t,"b",(function(){return E})),r.d(t,"d",(function(){return j}));var n=r("BFlg"),a=r("P6DH"),i=r("arV0");function s(e,t,r,n){return{type:"update.grid.configuration",payload:{[t]:{[r]:e}},meta:{pageId:n}}}function o(e,t,r){return{type:"update.views.configuration",payload:{[t]:e},meta:{pageId:r}}}var c=r("oOvK"),l=r("9fGf"),u=r("Z/4N"),d=r("y60j"),h=r("SAYH"),p=r("KBcj"),g=r("S2mk"),m=r("5ZBI"),b=r("j6Db"),f=r("zmL5");function y(e,t){const r=Object.assign({},e.CustomControls);if(e.CustomControls[t]&&!e.CustomControls[t].isDefaultConfig){let n=!1;for(const r in e.CustomControls)if(C(e.CustomControls[r],e.CustomControls[t])&&r!==t.toString()){n=!0;break}if(!n){let n=-1;r[n]?n--:r[n.toString()]=e.CustomControls[t]}}return r[t]=null,r}function _(e,t,r,n,u){return{type:"customcontrol.changevisualization.homepage",sync:!0,execute({dispatch:d,getState:h},p){const g=h(),f=Object(l.b)(g),y=Object(a.k)(g,e,t),_={UniqueId:y?y.UniqueId:null,CustomControls:{[f]:Object.assign(Object.assign({},r),{FormFactor:f})},FormLibraries:y?y.FormLibraries:null,EventHandlers:y?y.EventHandlers:null},{entityTypeName:v}=Object(i.g)(g,e);if(u){const r=Object(a.T)(g,e,t);d(o({UniqueId:null,CustomControls:{[f]:null},FormLibraries:null,EventHandlers:null},r.guid,e))}d(Object(c.c)(r.CustomControlId)).then(()=>{d(s(_,v,n,e))},t=>{const a=Object(m.b)(h(),r.CustomControlId);p.EventManager.ReportComponentFailure(a+".CustomControl.retrieveControlManifest",t,"retrieveControlManifest failure error message",[{name:"APIName",value:b.a+".Actions.SwitchVisualization"},{name:"entityTypeName",value:v},{name:"customControlId",value:r.CustomControlId},{name:"pageId",value:e},{name:"controlId",value:n},{name:"config",value:JSON.stringify(r)}])})}}}function v(e,t,r,n,u){return{type:"customcontrol.changevisualization.homepage",sync:!0,execute({dispatch:d,getState:h}){const g=h(),m=Object(l.b)(g),b=Object(a.T)(g,e,t),f=Object(p.d)(g,b),_={UniqueId:f?f.UniqueId:null,CustomControls:{[m]:Object.assign(Object.assign({},r),{FormFactor:m})},FormLibraries:f?f.FormLibraries:null,EventHandlers:f?f.EventHandlers:null},{entityTypeName:v}=Object(i.g)(g,e);if(u){const r=Object(a.k)(g,e,t);if(r&&r.CustomControls&&r.CustomControls[m]){const t={UniqueId:r.UniqueId,CustomControls:y(r,m),FormLibraries:r.FormLibraries,EventHandlers:r.EventHandlers};d(s(t,v,n,e))}}d(Object(c.c)(r.CustomControlId)).then(()=>{d(o(_,b.guid,e))})}}}function S(e,t,r){return{type:"customcontrol.changevisualization.subgrid",sync:!0,execute({dispatch:n,getState:a}){const i=a(),o=Object(l.b)(i),h=Object(f.b)(i,e),p=Object(d.b)(i,e,h,r),g=Object(u.b)(i,p.UniqueId,h);if(!g||!g.CustomControls)return;const m={UniqueId:p.UniqueId,CustomControls:{[o]:Object.assign(Object.assign({},t),{FormFactor:o})},FormLibraries:g.FormLibraries,EventHandlers:g.EventHandlers};n(Object(c.c)(t.CustomControlId)).then(()=>{n(s(m,h.guid,g.UniqueId,e))})}}}function O(e,t,r,n,a){return{type:"customcontrol.changevisualization.associatedgrid.grid",sync:!0,execute({dispatch:i,getState:o}){const u=o(),d=Object(l.b)(u),h={UniqueId:a.UniqueId,CustomControls:{[d]:Object.assign(Object.assign({},n),{FormFactor:d})},FormLibraries:a.FormLibraries,EventHandlers:a.EventHandlers};i(Object(c.c)(n.CustomControlId)).then(()=>{i(s(h,t,r,e))})}}}function I(e,t,r,n,a,i,u){return{type:"customcontrol.changevisualization.associatedgrid.view",sync:!0,execute({dispatch:d,getState:h}){const p=h(),g=Object(l.b)(p),m={UniqueId:i.UniqueId,CustomControls:{[g]:Object.assign(Object.assign({},a),{FormFactor:g})},FormLibraries:i.FormLibraries,EventHandlers:i.EventHandlers};if(u&&u.CustomControls&&u.CustomControls[g]){const n={UniqueId:u.UniqueId,CustomControls:y(u,g),FormLibraries:u.FormLibraries,EventHandlers:u.EventHandlers};d(s(n,t,r,e))}d(Object(c.c)(a.CustomControlId)).then(()=>{d(o(m,n.guid,e))})}}}function C(e,t){if(e&&t){let r=!!e==!!t&&e.CustomControlId===t.CustomControlId&&e.Name===t.Name&&e.ShouldOverrideControlVisible===t.ShouldOverrideControlVisible&&e.Version===t.Version&&e.isDefaultConfig===t.isDefaultConfig&&function e(t,r){var n,a;if(t&&r&&t!==r){if(t instanceof Array&&r instanceof Array&&t.length!==r.length)return!1;for(const i in t)if(t[i]!==r[i]){if("function"==typeof t[i])continue;if(t[i]&&r[i]&&"object"==typeof t[i]&&"object"==typeof r[i]){if(e(t[i],r[i]))continue;return!1}if("EnableViewPicker"===i)return(null===(n=t[i])||void 0===n?void 0:n.toString())===(null===(a=r[i])||void 0===a?void 0:a.toString());if("ExtraFilters"!==i&&"PagingInput"!==i&&"FilteringInput"!==i&&"RefreshInput"!==i&&"ViewId"!==i&&"EntityName"!==i&&"LinkingInput"!==i&&"FirstDataRequestType"!==i&&"NativeFilterExpressionToRestore"!==i&&"LookupAttributeNameForHierarchy"!==i&&"SortingInput"!==i&&"function"!=typeof t[i])return!1}}return!0}(e.Parameters,t.Parameters);if(e.Children&&t.Children){if(Object.keys(e.Children).length===Object.keys(t.Children).length){for(const n in e.Children)r=r&&C(e.Children[n],t.Children[n]);return r}return!1}return r&&e.Children===t.Children}return!!e==!!t}function j(e,t,r,n,a,i,s,o){const c=t?t.TraceManager.getTracer("customcontrol"):null;return e(P(r,n,i.configuration,i,i.contextString,o).map(e=>e.configuration.DisplayNameKey)).catch(e=>(c&&c.info("Resource retrieve failed: "+e.message),Promise.resolve()))}function P(e,t,r,a,i,s){const o=[];if(null==s)return o;if(i===n.h.CUSTOM&&a.configuration.isDefaultConfig)return o;const c=i===n.h.GRID||i===n.h.ASSOCIATEDGRID?Object(g.u)(a&&a.controlId,a&&a.gridEntityTypeName,a&&h.a.toString(a.viewId)):Object(g.x)(a&&a.controlId,a&&a.descriptor.Parameters);return o.push({configuration:c,formFactor:s,configurationType:null}),e&&e.CustomControls&&T(o,e,"GRID_CONFIG"),t&&t.CustomControls&&T(o,t,"VIEW_CONFIG"),o}function T(e,t,r){for(const n in t.CustomControls)if(t.CustomControls[n]&&!t.CustomControls[n].isDefaultConfig){let a=!1;for(let r=0;r<e.length;r++)if(C(e[r].configuration,t.CustomControls[n])){a=!0;break}a||e.push({configuration:t.CustomControls[n],formFactor:n,configurationType:r})}}function E(e,t){return null!=t.DisplayNameKey?null!=e&&null!=e[t.DisplayNameKey]?e[t.DisplayNameKey]:t.DisplayNameKey:"Grid"}},lEp6:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(e){let t=null;try{t=JSON.parse(e)}catch(e){}return t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){let t="";try{t=JSON.stringify(e)}catch(e){}return t}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}))},"lIi+":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("WLAV"),a=r("ruPX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t,r,i,s,o,c,l){const u={powerBIEmbedUrl:t,powerBIGroupId:r,powerBIDashboardId:i,powerBITileId:s,powerBIReportId:o,powerBIReportUrl:c,powerBIComponentTypeCode:l};return Object(a.a)(n.a,u,e,{target:"dialog"})}},ldWj:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n=r("0nOn"),a=r("ScMg"),i=r("i1f0"),s=r("Sbn7"),o=r("16wZ"),c=r("vlcQ"),l=r("3MuQ"),u=r("qshH"),d=r("ZIjf"),h=r("IaGr");let p;class g extends a.a{constructor(e,t,r,a,i,s){super(e,t,r,a),this._parent=i,p=e,this._formContext=s,this._iConnectedSectionProp={sectionName:this.name,id:this.pageId},this._clientApiExecutorTabSection=new n.a(e,"ClientApi.XrmTabSection.",r,t),this.clientApiExecutor.addEventParameter({name:"controlName",value:a,isEventParam:!0})}get clientApiExecutor(){return this._clientApiExecutorTabSection}get controls(){return this.clientApiExecutor.execute("controls",(e,t)=>{if(!this._controls){const r=p.getState();this._controls=new s.a(e);const n=this.getControlsDescriptor(r);if(!n)return this._controls;for(const r in n){const n=this._formContext.ui.controls.get(r);if(n)this._controls.add(n.getName(),n);else{const n=t.slice();n.push({name:"controlKey",value:r}),h.a.getInstance().traceManager.getTracer(e).warn("Section control was not found in the form controls collection",n)}}}return this._controls})}getParent(){return d.a.instance.reportUsage("ClientApi.XrmTabSection.getParent"),this._parent}getVisible(){const e="ClientApi.XrmTabSection.getVisible";try{d.a.instance.reportCall(e);const t=Object(i.tc)(p.getState(),this._iConnectedSectionProp,this.contextToken),r=Object(o.a)(t)?this._getSectionDescriptorValues().Visible:t;return d.a.instance.reportSuccess(e),r}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(e,t,null,r),t}}getLabel(){const e="ClientApi.XrmTabSection.getLabel";try{d.a.instance.reportCall(e);const t=Object(i.rc)(p.getState(),this._iConnectedSectionProp,this.contextToken),r=Object(o.a)(t)?this._getSectionDescriptorValues().Label?this._getSectionDescriptorValues().Label:"":t;return d.a.instance.reportSuccess(e),r}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(e,t,null,r),t}}_getSectionDescriptorValues(){try{return Object(i.qc)(p.getState(),this._iConnectedSectionProp,this.contextToken)}catch(e){const t=u.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure("ClientApi.XrmTabSection._getSectionDescriptorValues",e,null,t),e}}getControlsDescriptor(e){try{return Object(i.H)(e,this._iConnectedSectionProp,this.contextToken)}catch(e){const t=u.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure("ClientApi.XrmTabSection.getControlsDescriptor",e,null,t),e}}setVisible(e){const t="ClientApi.XrmTabSection.setVisible";try{d.a.instance.reportCall(t),p.dispatch(Object(c.b)(this.pageId,this.contextToken,this.name,!0===e)),d.a.instance.reportSuccess(t)}catch(e){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(t,e,null,r),e}}setLabel(e){const t="ClientApi.XrmTabSection.setLabel";Object(o.a)(e)&&Object(o.j)(t,"label");try{d.a.instance.reportCall(t),p.dispatch(Object(l.b)(this.pageId,this.contextToken,this.name,e)),d.a.instance.reportSuccess(t)}catch(e){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(t,e,null,r),e}}}},lxh6:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="form.ViewPortSizes.set";function i(e,t,r,i){const s=Object(n.v)(t);return{type:a,payload:{viewportWidth:r,viewportHeight:i},meta:{pageId:e,contextKey:s}}}},"m+2h":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="footer.visible";function i(e,t,r){const i=Object(n.v)(t);return{type:a,payload:r,meta:{pageId:e,contextKey:i}}}},mLMm:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return s}));var n=r("dHD5"),a=r("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="update.grid.paging.refresh.input";function s(e,t){return{type:"update.grid.paging.refresh.input.async",execute({dispatch:r,getState:s},o){const c=o.TraceManager.getTracer(a.z),l=a.x+".updateGridPagingRefreshInputAction";try{const a=Object(n.u)(t);return r(function(e,t){return{type:i,payload:Math.floor(1e3*Math.random()),meta:{pageId:e,dataSetContextKey:t}}}(e,a)),c.info("Updating the grid pagingRefreshInput"),o.EventManager.ReportComponentSuccess(l),Promise.resolve()}catch(e){const t="Updating the grid pagingRefreshInput failed with error : "+e.message;o.EventManager.ReportComponentFailure(l,Error(t))}}}}},meVR:function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n=r("+zjj"),a=r("+Ajx"),i=r("6Qf/"),s=r("P6DH"),o=r("d0w6"),c=r("KBcj"),l=r("vNXc"),u=r("a72m"),d=r("BFlg"),h=r("pEXn"),p=r("5R5s"),g=r("hSDL"),m=r("aF0N"),b=r("Ii8m"),f=r("69Qu"),y=r("jAuy"),_=r("eXjw"),v=r("Lyxw"),S=r("3/02"),O=r("fyfl"),I=r("FZDd");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const C=`${d.x}.${d.v}`;function j(e,t,r,n,a,o,u,d,h,m){const b=T(n,u,h),_=Object(c.c)(t,r);if(!_)return Promise.resolve(null);const O=l.a.fromXmlAndSql(_.fetchXML,_.offlineSqlQuery,r).getQueryState(),I=m||Object(s.db)(t,n,u),C=Object(y.c)(a,o);let j=!1;Object(f.b)(t)&&Object(y.h)(t,o.relationshipName,!0)&&(j=!0);const E=Object(s.ub)(t,n);if(E||"activitypointer"===n||j){const r=t.user&&t.user.userId,s=Object(v.c)(t,S.Zc),c=Object(p.a)(n,r,o,s,E);return e(c.getFilterOptionsAction()).then(r=>{if(r&&r.length>0){const t=r.filter(e=>e.isDefault);if(t&&t.length>0){const r=c.getFilterExpression(t[0].value);e(Object(g.l)(r,a,o))}}return e(Object(i.d)(O,n,a,o,null,u,I,j,C)).then(r=>P(e,r,t,n,a,b,d))})}return e(Object(i.d)(O,n,a,o,null,u,I,void 0,C)).then(r=>P(e,r,t,n,a,b,d))}function P(e,t,r,n,a,o,c){const l=Object(m.c)(r),u=Object(m.b)(r);return(l||u)&&Object(s.sb)(r,n)&&Object(i.e)(c,e,n,a),c.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid.initializeRelatedGrid",o),c.EventManager.ReportComponentSuccess(C,o),t}function T(e,t,r){return[{name:h.a.CorrelationId,value:r.correlationId},{name:h.a.ContextId,value:r.contextId},{name:h.a.ActionStack,value:r.stack},{name:"entityName",value:e},{name:"relationshipName",value:t}]}function E(e,t,r){const i=[{name:"EntityName",value:r.entityName}];return{type:"form.related.openGrid",execute({dispatch:i,getState:l},d,p){const g=l(),m=Object(n.e)(g,{id:e},t.parentContextToken),f=T(r.entityName,r.relationshipName,p);if(i(Object(a.b)(e,t,r)),null!==m&&m.id===r.id&&m.isSelected===r.isSelected&&m.relationshipName===r.relationshipName||i(Object(a.b)(e,t.parentContextToken,r)),i(Object(b.a)(e,r)),r&&!r.url){const n=function(e,t){return[{name:h.a.CorrelationId,value:e.correlationId},{name:h.a.ContextId,value:e.contextId},{name:h.a.ActionStack,value:e.stack},{name:"hasViewId",value:!0},{name:"entityName",value:t}]}(p,r.entityName);if(!Object(s.v)(g,e,t)){i(Object(u.b)(r.entityName,o.a.MAIN_APPLICATION_VIEW));const a=Object(c.a)(g,r.entityName,o.a.SUB_GRID),s=Object(c.c)(g,a),h=Object(v.c)(g,S.Xc),m=!h||function(e,t){var r,n,a;if(!(null===(n=null===(r=null==t?void 0:t.grid)||void 0===r?void 0:r.rows)||void 0===n?void 0:n.length)||!(null===(a=e.metadata)||void 0===a?void 0:a.entities))return!0;const i=t.grid.rows[0].cells;if(!(null==i?void 0:i.length))return!0;for(let t=0;t<i.length;t++)if(i[t].relatedEntityName&&!e.metadata.entities[i[t].relatedEntityName])return!1;return!0}(g,s);return s&&s.initialized===_.a.Initialized&&m?(j(i,g,a,r.entityName,e,t,r.relationshipName,d,p,r.ordinal).catch(e=>{d.EventManager.ReportComponentFailure(C,e,null,f)}),d.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid",n),Promise.resolve(a)):i(Object(u.a)(r.entityName,o.a.SUB_GRID)).then(a=>{let s=Promise.resolve();if(h){const t=Object(O.a)(g,a,e);s=i(Object(I.e)(t))}return s.then(()=>{const s=l();return j(i,s,a,r.entityName,e,t,r.relationshipName,d,p,r.ordinal).catch(e=>{d.EventManager.ReportComponentFailure(C,e,null,f)}),d.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid",n),a})},e=>{d.EventManager.ReportComponentFailure(C,e,null,f)})}}return Promise.resolve(null)},getFailureParameters:(e,t)=>i}}},mhYf:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return h}));var n=r("dHD5"),a=r("i1f0"),i=r("TYIz"),s=r("+zjj"),o=r("wL2W"),c=r("4aOd"),l=r("pEXn"),u=r("tWr6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d="tab.visible";function h(e,t,r,h){return{type:"tab.visible.sync",sync:!0,execute({dispatch:p,getState:g},m){var b;const f=g();p(function(e,t,r,a){const i=Object(n.v)(r);return{type:d,payload:a,meta:{pageId:e,tabId:t,contextKey:i}}}(e,t,r,h));const y=Object(a.wc)(f,{id:e},r),_=Object(s.e)(f,{id:e},r);if(y||(null==_?void 0:_.isSelected)||!h){if(y===t&&!h){const n=Object(a.fb)(f,{id:e},r);let s=!1;if(n){const o=Object(a.m)(f,n);for(const n of o)if(n.Id!==t&&Object(a.Kc)(f,n.Id,e,r)){s=!0,p(Object(i.b)(e,n.Id,r));break}}s||p(Object(i.b)(e,void 0,r))}}else p(Object(i.b)(e,t,r));if(Object(o.a)()){const n=g(),i=null===(b=null==m?void 0:m.TraceManager)||void 0===b?void 0:b.getTracer(`${l.k}${l.r}`),s=Object(a.Kc)(f,t,e,r),o=Object(a.Kc)(n,t,e,r),d=Object(u.a)(n,e);d.push({name:"tabId",value:t}),d.push({name:"tabName",value:Object(a.Ic)(n,t,e,r)}),d.push({name:"tabLabel",value:Object(a.Hc)(n,t,e,r)}),d.push({name:"visible state before change",value:null==s?void 0:s.toString()}),d.push({name:"visible state after change",value:null==o?void 0:o.toString()}),d.push({name:"callstack",value:new c.a(new Error).getStackTrace()}),null==i||i.warn(l.n,[{name:l.v,value:l.r+".visible"},{name:l.r,value:JSON.stringify(d)}])}}}}},mlKL:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return h}));var n=r("arV0"),a=r("jRy5"),i=r("dHD5"),s=r("ApeL"),o=r("i1f0"),c=r("mIxf"),l=r("bT7G"),u=r("WPtp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d="attribute.requiredLevel";function h(e,t,r,h){return{type:"attribute.requiredLevel.validation",sync:!0,execute(p,g){const m=p.getState();if(h!==Object(o.pc)(m,e,t,r)){p.dispatch(function(e,t,r,n){if(t&&t.contextTokenType&&t.contextTokenType===a.a.GridRow)return Object(s.f)(e,t,r,n);const o=Object(i.x)(t);return{type:d,payload:n,meta:{pageId:e,contextKey:o,dataFieldName:r}}}(e,t,r,h));const g=Object(o.ac)(m,e,t),b=Object(l.b)(m,g);if((0===h||3===h)&&b&&b.activeChanges&&b.activeChanges[r]||t&&t.contextTokenType&&t.contextTokenType===a.a.GridRow){let s=null,d=null,h=null,b=null;if(t&&t.contextTokenType&&t.contextTokenType===a.a.GridRow)s=t.entityTypeName?t.entityTypeName:null,d=t.recordId?t.recordId:null,h=Object(i.t)(t),b=Object(i.r)(t);else{const r=Object(n.g)(m,e);s=r&&r.entityTypeName?r.entityTypeName:null,d=r&&r.id?r.id:null,h=null,b=t}const f=Object(l.d)(m,g,{etn:s,id:d},r);if(Object(o.Uc)(f)){const t={[r]:{fieldName:r,value:f?f.formatted?f:Object(u.e)(f):f}};p.dispatch(Object(c.a)(e,t,!0,!0,s,d?d.guid:null,h,b))}}}}}}},nIfK:function(e,t,r){"use strict";r.d(t,"a",(function(){return N})),r.d(t,"e",(function(){return k})),r.d(t,"d",(function(){return L})),r.d(t,"b",(function(){return R})),r.d(t,"c",(function(){return M}));var n=r("Yx7Y"),a=r("SAYH"),i=r("vNXc"),s=r("9fGf"),o=r("Z/4N"),c=r("P6DH"),l=r("p/2N"),u=r("iZ7K"),d=r("sn0j"),h=r("y60j"),p=r("BJ7u"),g=r("JwRZ"),m=r("504W"),b=r("IqkD"),f=r("CB5L"),y=r("odYE"),_=r("i1f0"),v=r("bT7G"),S=r("00VO"),O=r("YGjz"),I=r("LbMF"),C=r("BFlg"),j=r("Lyxw"),P=r("3/02"),T=r("jAuy"),E=r("/Zy9"),w=r("arV0"),F=r("z+5+"),x=r("d0w6"),A=r("AF/G");const N=["MscrmControls.Grid.ReadOnlyGrid","MscrmControls.Grid.GridControl","MscrmControls.SharepointAssociatedGrid.SharepointControl","MscrmControls.MailApp.MailAppListControl"],D=["Opportunity_ActivityPointers"];function k(e){const t=e&&e.control&&e.control.Parameters&&e.control.Parameters.hasOwnProperty(C.r)&&e.control.Parameters[C.r],r=[e.viewId,t,e.recordsPerPage,(n=e,n&&n.controlParameters&&n.controlParameters.ChartDrillDownParameters&&n.controlParameters.ChartDrillDownParameters.length>0)];var n;return e.customQueryStateKeyParts&&r.push(...e.customQueryStateKeyParts),r.join("")}function M(e,t,r,n,a){const s=R(e,t,r,n,a);return t=>{const r=s(t);return r&&r.getQueryState(r instanceof i.a?void 0:e)}}function R(e,t,r,n,o){const l={};return u=>{const d=new a.a(u.viewId),h=Object(c.qb)(e(),d,t);if(!h)return null;const p=function(e,t,r){let n=t.fetchXML,a=null;const i="TeamTemplateId";if(t.entityLogicalName===O.a&&e.controlParameters[i]){const t=e.controlParameters[i];if(n&&n.indexOf(t)<0){const e=r?r.guid:"",i=Object(S.a)(n,t,e);n=i.updatedFetchXml,a=i.filterString}}return{fetchXML:n,filterString:a}}(u,h,n);let C=p.fetchXML;if(!C&&h.queryApi)return null;if(Object(T.l)(e())&&u.quickFindViewId){const r=new a.a(u.quickFindViewId),n=a.a.isNullOrEmpty(r)?null:Object(c.qb)(e(),r,t);Object(m.a)(n)||(C=function(e,t){const r=new DOMParser;if(e){const n=r.parseFromString(e.fetchXML,"text/xml"),a=r.parseFromString(t.fetchXML,"text/xml"),i=n.getElementsByTagName("filter");for(let e=0;e<i.length;e++)i[e].attributes&&i[e].attributes.getNamedItem("isquickfindfields")&&a.getElementsByTagName("entity")[0].appendChild(i[e]);return(new XMLSerializer).serializeToString(a)}return t.fetchXML}(n,h))}const N=e(),k=u.entityLogicalName,M=u.getCustomFilter&&u.getCustomFilter(),R=function(e,t,r,n,i){const s=i.controlParameters.RelationshipName;if(s){let o=n,l=null,u=null;if(i.controlParameters.DependentAttributeName){u=i.controlParameters.DependentAttributeName;l=u.split(".")[1]||u}if(i.controlParameters.IsDataSetLookup&&(o=null==i.controlParameters.ParentRecordId?a.a.EMPTY:new a.a(i.controlParameters.ParentRecordId),i.controlParameters.DependentAttributeName)){u=i.controlParameters.DependentAttributeName;l=u.split(".")[1]||u}const d=Object(_.ac)(e,t,i.contextToken),h=new y.a(r,o);let p=null,g=!1;Object(I.a)(e,r,l)?p=Object(v.d)(e,d,h,l):i.controlParameters.DependentAttributeType&&(g=i.controlParameters.DependentAttributeType===r&&i.controlParameters.DependentAttributeType!==i.entityLogicalName);const m=p;m&&m.reference?o=m.reference.id:!i.controlParameters.IsDataSetLookup&&null===l||null!==m&&null!==m.reference||!h||null===h.id||g||(o=null);const b=Object(c.kb)(e,t,i.contextToken);let S=0,O=f.h.None;return b?(S=1,-1===D.indexOf(s)&&(O=f.h.Related)):(i.controlParameters.ShouldApplyContextFilter&&i.controlParameters.IsDataSetLookup||!i.controlParameters.IsDataSetLookup)&&(S=2),{type:S,rollupType:O,entityReference:h,contextId:o,relationshipName:s}}return null}(N,t,o||r&&r.EntityLogicalName,n,u),B=Object(g.p)(e(),k),V=function(e,t,r,n,i,s,o){var l;const u=Object(w.g)(e,s),d=!(!(null==u?void 0:u.pageToEditedViewMapId)||!Object(c.rb)(e,u.pageToEditedViewMapId.guid,o.guid)),h=Object(c.qb)(e,o,s),p=t.hasGrid&&(1===t.gridType||void 0===t.gridType&&a.a.equals(null===(l=t.control)||void 0===l?void 0:l.ClassId,A.E));return Object(F.e)(e)&&(p||Object(F.f)(e))&&!(1===(null==r?void 0:r.type))&&!(2===(null==r?void 0:r.type))&&!(n&&n.linkEntities&&Array.isArray(n.linkEntities)&&n.linkEntities.length>0)&&!i&&!(n&&n.filter&&Array.isArray(n.filter)&&n.filter.length>0)&&!d&&(null==h?void 0:h.queryType)!==x.a.QUICKFIND_SEARCH&&!t.quickFindViewId}(N,u,R,M,B,t,d)?E.a.fromView(d,u.quickFindSearchString):i.a.fromXmlAndSql(C,h.offlineSqlQuery,d,u.quickFindSearchString,k,e);(null==p?void 0:p.filterString)&&n&&V.addExistingContextFilterToKey(a.a.toString(n),p.filterString);const G=Object(c.x)(e(),t,u.contextToken);G&&(V.pageNumber=G);const U=L(e(),t,r,u,h,k);U.length&&V.select(...U);const X=function(e,t,r,n,a,i){let o=null;if(!Object(j.a)(e,P.ub)||!i.hasGrid||1!==i.gridType)return null;const l=Object(c.j)(n)(e,t,i.contextToken),u=Object(s.b)(e),d=l&&l.CustomControls&&l.CustomControls[u]&&l.CustomControls[u].Parameters;if(!Object(c.vb)(d)&&(o=Object(c.o)(e,r),o)){const e=[],t=a&&a.grid&&a.grid.rows&&a.grid.rows[0]&&a.grid.rows[0].cells;if(t)for(const r in t)t.hasOwnProperty(r)&&e.push(t[r].name);-1!==e.indexOf(o.lookupAttribute)&&(o.lookupAttribute=null),a&&a.fetchXML&&Object(T.b)(a.fetchXML)&&(o.primaryAttribute=null)}return o}(e(),t,k,d,h,u);X&&(X.lookupAttribute&&V.select(X.lookupAttribute),X.primaryAttribute&&V.addChildCountAttribute(X.primaryAttribute));const z=u.getCustomSorting&&u.getCustomSorting(h,l);if(z)for(const e of z)V.orderBy(e.name,1===e.sortDirection);if(R)switch(R.type){case 1:V.applyRollupContextFilter(R.entityReference,R.rollupType);break;case 2:const e=Object(c.v)(N,t,u.contextToken);V.applyContextFilter(R.relationshipName,R.contextId,N,e?e.relationshipRoleOrdinal:void 0)}if(B&&V.where(B),M&&M.filter)if(Array.isArray(M.filter)){const e=M.filter;for(const t of e)V.where(t,t.shouldReplace)}else{const e=M.filter;!function(e){return!!(e&&e.operator&&e.terms)}(e)?V.where(Object(g.n)(M.filter,null)):V.where(e,e.shouldReplace)}if(M&&M.linkEntities)for(const e of M.linkEntities)V.addLinkedEntity(e,e.attributes||[]);const q=u.recordsPerPage;if(q)V.pageSize=q;else{const t=Object(b.h)(e());u.hasChart||Object(m.a)(t)?V instanceof i.a&&V.setDefaultPageSize():V.pageSize=t}return V}}function L(e,t,r,n,a,i){const s=[...B(e,r,n,a.viewId),...V(e,n,i,a.viewId),...G(e,r,n,i),...U(e,n,i),...X(e,t,n,i),...n.getCustomColumns?n.getCustomColumns():[]];if(s.length){const e=[],t=[],r=a&&a.grid&&a.grid.rows&&a.grid.rows[0]&&a.grid.rows[0].cells;if(r)for(const e in r)r.hasOwnProperty(e)&&t.push(r[e].name);for(const r in s){const n=s[r];-1===t.indexOf(n)&&-1===e.indexOf(n)&&e.push(n)}return e}return s}function B(e,t,r,n){if(0!==r.gridType)return[];let a="Grid";const i=Object(s.b)(e),u=t&&Object(o.a)(r.control,t,i);return u&&(a=Object(c.ab)(e,u.CustomControlId)),Object(l.b)(e,r.control.UniqueId,a,t&&t.Id,null,null,n)||[]}function V(e,t,r,n){return 1!==t.gridType?[]:Object(l.a)(e,r,n)||[]}function G(e,t,r,n){const a=[],i=Object(u.h)(e,n);return i&&(function(e,t,r){const n=Object(s.b)(e),a=t&&Object(o.a)(r.control,t,n);return a&&[a.CustomControlId&&a.Name].some(e=>-1!==N.indexOf(e))}(e,t,r)||r.hasGrid)&&("activitypointer"===n&&a.push("activitytypecode"),i.PrimaryNameAttribute&&a.push(i.PrimaryNameAttribute),Object(c.vb)(r.controlParameters)||i.PrimaryImageAttribute&&a.push(Object(T.a)(i.PrimaryImageAttribute))),a}function U(e,t,r){const n=[];if(4&t.streamMode){n.push("modifiedon");const t=Object(I.d)(e,r);if(t)for(const a in t){const i=t[a];i.IsSortableEnabled&&"image"!==i.Type&&"multiselectpicklist"!==i.Type&&Object(d.b)(e,r,i.LogicalName,i)&&n.push(i.LogicalName)}}else 2&t.streamMode&&n.push("modifiedon");return n}function X(e,t,r,i){const s=[],o=r.cardFormId;if(o)if("activitypointer"===i)s.push(...d.a);else{const r=a.a.equals(o,n.a)?Object(h.h)(e,i,Object(p.a)(11)):o,c=Object(h.d)(e,r,t);if(c)for(const e in c){const t=c[e];t.DataFieldName&&s.push(t.DataFieldName)}}return s}},nexV:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("Kvn0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){const r={displayState:e};return{type:n.c,payload:r}}},ojtV:function(e,t,r){"use strict";r.d(t,"a",(function(){return y})),r.d(t,"b",(function(){return _}));var n=r("dHD5"),a=r("BFlg"),i=r("dQnL"),s=r("KBcj"),o=r("SAYH"),c=r("P6DH"),l=r("CngE"),u=r("iZ7K"),d=r("qwRa"),h=r("WK+4"),p=r("BzGi"),g=r("EY5k"),m=r("GEBM"),b=r("69Qu"),f=r("LAGg");const y="chart.showChart.update";function _(e,t,r){return{type:"chart.showChart.update.async",execute({dispatch:y,getState:_},S){const O=S.TraceManager.getTracer(a.z),I=a.x+".updateShowChartAction";try{O.info("Updating the show chart"),t||(t=Object(n.k)(_(),e));const a=_(),C=Object(n.v)(t),j=Object(c.T)(a,e,t),P=Object(s.c)(a,j),T=P&&P.entityLogicalName;let E=Object(c.r)(a,e,t,T),w=Object(c.s)(a,e,t);const F=Object(l.a)(a,E),x=F&&F.PrimaryEntityTypeCode,A=x&&Object(u.m)(a,parseInt(x,10));T&&A&&T!==A&&(E=null,w=p.a.savedvisualization);const N=Object(l.i)(a,T);if(E&&N&&N.chartTypes&&Object.keys(N.chartTypes).length>0){const e=o.a.toString(E);w=e in N.chartTypes[p.a[p.a.savedvisualization]]?p.a.savedvisualization:p.a.uservisualization}if(!r)return y(v(e,C,r)),S.EventManager.ReportComponentSuccess(I),Promise.resolve();if(!Object(b.b)(_()))return Promise.resolve();return y(Object(g.e)(m.A)).then(()=>{y(Object(i.a)(T,w,E)).then(r=>o.a.isNullOrEmpty(r)?(w=p.a.uservisualization,y(Object(d.b)(e,t,w)).then(()=>y(Object(i.a)(T,w,E)).then(e=>Promise.resolve(e)))):Promise.resolve(r)).then(n=>{const a=o.a.toString(n);Promise.all([y(Object(h.b)(e,t,a)),y(Object(d.b)(e,t,w)),y(v(e,C,r))]).then(()=>(S.EventManager.ReportComponentSuccess(I),y(Object(f.b)(e,t)),Promise.resolve()))})}).catch(e=>(S.EventManager.ReportComponentFailure(I,Error("Retrieve resource strings for chart failed")),Promise.reject(e))),Promise.resolve()}catch(e){const t="Update the show chart failed with error : "+e.message;S.EventManager.ReportComponentFailure(I,Error(t))}}}}function v(e,t,r){return{type:y,payload:{name:"showChart",value:r},meta:{pageId:e,dataSetContextKey:t}}}},pp6D:function(e,t,r){"use strict";r.d(t,"b",(function(){return N})),r.d(t,"a",(function(){return A})),r.d(t,"c",(function(){return k})),r.d(t,"e",(function(){return M})),r.d(t,"d",(function(){return R}));var n=r("2yvP"),a=r("jRy5"),i=r("IaGr"),s=r("9ksH"),o=r("tpZ5"),c=r("G0J3"),l=r("COKI"),u=r("uOtn"),d=r("OtHk"),h=r("SAYH"),p=r("Zw8F"),g=r("pnQK"),m=r("0nOn"),b=r("+baL");let f;class y extends p.a{constructor(e,t,r,n){super(e,t,r,n),this._dashboardId=e,f=r,this._clientApiExecutor=new m.a(r,"ClientApi.XrmDashboardSelectorItem.",n)}_getEventParams(){return this._commonEventParams||(this._commonEventParams=[{name:"dashboardId",value:h.a.toString(this._dashboardId),isRequired:!1,isEventParam:!0}])}get isBoundDashboard(){return this._clientApiExecutor.execute("isBoundDashboard_get",()=>{const e=Object(g.a)(f.getState(),this._dashboardId);return!e||1032==+e.Type},this._getEventParams())}get isUserDashboard(){return this._clientApiExecutor.execute("isUserDashboard_get",()=>{const e=Object(g.a)(f.getState(),this._dashboardId);return Object(g.c)(e)},this._getEventParams())}navigate(){this._clientApiExecutor.executeAsync("navigate",()=>f.dispatch(Object(b.a)(null,this._dashboardId,null,null,null,null,this.getPageId())),this._getEventParams())}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class _ extends u.b{constructor(e,t,r,n,a){let i=d.c;if(n){const t=e.getState(),a=Object(d.g)(t,n);a&&a[r.guid]&&(i=d.g)}super(e,t,r,n,a,i,y)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class v extends l.a{constructor(e,t,r,n,a,i){super(e,t,r,n,a,i,_)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let S;class O extends c.a{constructor(e,t,r,n,a,i){super(e,t&&t.etn,n,a,()=>v,r),S=e,this._getCommands=i,this._apiExecutor=new m.a(e,"ClientApi.XrmDashboard.",a,n)}get commands(){return this._apiExecutor.execute("commands_get",()=>this._commands||(this._commands=this._getCommands(S,this.contextToken,this.pageId)))}}var I=r("HAeo"),C=r("zgeC"),j=r("ywwS"),P=r("ghNp"),T=r("i1f0"),E=r("qshH"),w=r("E7fB"),F=r("16wZ"),x=r("T6Zt");function A(e,t,r,n){return D((r,a)=>new O(r,a,new s.b(r,t),e,t,n),"clientapi.create.xrmdashboard","ClientApi.XrmCommandObjectFactory.createXrmDashboard",e,t,r,!1)}function N(e,t,r,n){return D((r,n)=>new o.a(r,n,new s.b(r,t),e,t),"clientapi.create.xrmform","ClientApi.XrmCommandObjectFactory.createXrmForm",e,t,r,!0,n)}function D(e,t,r,a,s,o,c,l){return{type:t,sync:!0,execute(t,u){Object(F.g)(a,r,"contextToken"),Object(F.g)(s,r,"pageId"),c&&Object(F.g)(o,r,"entityTypeName");try{let r=t.dispatch(Object(P.b)(s,a));if(!r){r=e(t,{etn:o,id:l}),r.applicationContext=u;const i=new w.a(t,s);if(r.context=i,!a.parentContextToken){const e=u.ClientApiManager.getClientApiEntry(s);Object(n.b)("form.initialization",()=>{e.xrmInstance.Page=r}),e.primaryContextToken=a}}return r}catch(e){const t=E.a.getInstance().getEventParameters(a);throw t.push({name:"entityTypeName",value:o}),i.a.getInstance().eventManager.ReportComponentFailure(r,e,null,t),e}}}}function k(e,t,r,n,s){const o="ClientApi.XrmCommandObjectFactory.createXrmGrid";return{type:"clientapi.create.xrmgrid",sync:!0,execute(c,l){Object(F.g)(e,o,"contextToken"),Object(F.g)(t,o,"pageId");try{let u=c.dispatch(Object(P.c)(t,e));if(!u){if(3===n){const a=Object(T.s)(c.getState(),{id:t,controlName:s},e.parentContextToken);if(a){const n=c.dispatch(Object(P.b)(t,e.parentContextToken));return new C.a(c,e.parentContextToken,t,s,r,n,a,l)}const u=E.a.getInstance().getEventParameters(e);u.push({name:"controlName",value:s}),u.push({name:"gridType",value:n}),i.a.getInstance().eventManager.ReportComponentFailure(o,new Error("Control descriptor could not be found for subgrid control"),null,u)}if(u=new I.a(c,e,t,r,n,!1,l,s),!e.parentContextToken&&e.contextTokenType===a.a.MainGrid){l.ClientApiManager.getClientApiEntry(t).primaryContextToken=e}}return u}catch(t){const r=E.a.getInstance().getEventParameters(e);throw r.push({name:"controlName",value:s}),r.push({name:"gridType",value:n}),i.a.getInstance().eventManager.ReportComponentFailure(o,t,null,r),t}}}}function M(e,t,r,n){const a="ClientApi.XrmCommandObjectFactory.registerNewControl";return{type:"clientapi.create.xrmTimeline",sync:!0,execute(s,o){Object(F.g)(e,a,"contextToken"),Object(F.g)(t,a,"pageId"),Object(F.g)(r,a,"controlName"),Object(F.g)(n,a,"controlId");try{const c=s.dispatch(Object(P.b)(t,e.parentContextToken));let l=null;switch(r){case"notescontrol":if(l=s.dispatch(Object(P.f)(t,e)),!l){const a=Object(T.s)(s.getState(),{id:t,controlName:r},e.parentContextToken);l=new j.a(s,e.parentContextToken,t,a,r,n,c,o)}break;default:const u=E.a.getInstance().getEventParameters(e);u.push({name:"controlName",value:r}),i.a.getInstance().eventManager.ReportComponentFailure(a,new Error("Failed to create and return the control"),null,u)}return l}catch(t){const n=E.a.getInstance().getEventParameters(e);throw n.push({name:"controlName",value:r}),i.a.getInstance().eventManager.ReportComponentFailure(a,t,null,n),t}}}}function R(e,t){const r="ClientApi.XrmCommandObjectFactory.createXrmKBSearch";return{type:"clientapi.create.xrmkbsearch",sync:!0,execute(n,a){Object(F.g)(e,r,"contextToken"),Object(F.g)(t,r,"pageId");try{let r=n.dispatch(Object(P.g)(t,e));if(!r&&(r=new x.a(n,e,t),!e.parentContextToken)){const n=a.ClientApiManager.getClientApiEntry(t);n.xrmInstance.Page=r,n.primaryContextToken=e}return r}catch(t){const n=E.a.getInstance().getEventParameters(e);throw i.a.getInstance().eventManager.ReportComponentFailure(r,t,null,n),t}}}}},qwRa:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return s}));var n=r("dHD5"),a=r("BFlg");const i="chart.visualizationtype.update";function s(e,t,r){return{type:"chart.visualizationtype.update.async",execute({dispatch:s,getState:o},c){const l=c.TraceManager.getTracer(a.z),u=a.x+".updateVisualizationTypeAction";try{l.info("Update the chart visualization type"),t||(t=Object(n.k)(o(),e));const a=Object(n.v)(t);return s(function(e,t,r){return{type:i,payload:{name:"chartVisualizationType",value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,a,r)),c.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){const t="Update the chart visualization type failed with error : "+e.message;c.EventManager.ReportComponentFailure(u,Error(t))}}}}},"r/aD":function(e,t,r){"use strict";r.d(t,"d",(function(){return u})),r.d(t,"c",(function(){return d})),r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return p}));var n=r("i1f0"),a=r("arV0"),i=r("PUjk"),s=r("IaGr"),o=r("2Ct/"),c=r("odYE"),l=r("g6bs");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(e,t,r,i=!1){if(!e)return s.a.getInstance().traceManager.getTracer(r).error("isXrmProcessControlClientApiSupportedOnForm invoked with unexpected null state object"),!1;if(!t)return s.a.getInstance().traceManager.getTracer(r).error("isXrmProcessControlClientApiSupportedOnForm invoked with unexpected null pageId object"),!1;const u=function(e,t){const r=Object(a.g)(e,t);if(!r)return null;const{entityTypeName:n,id:i}=r;return new c.a(n,i)}(e,t),d=!Object(n.Kb)(e,t)&&(Object(o.d)(e)||!Object(o.g)(e))&&(i||!Object(l.d)(e,u,t)),h=g(t,e);return h.push({name:"xrmProcessControlClientApiIsSupported",value:d}),s.a.getInstance().eventManager.ReportComponentSuccess(r,h),d}function d(e,t,r,n){if(!e&&(s.a.getInstance().traceManager.getTracer(n).error("getProcessManagerWithJitInitIfNeeded invoked with unexpected null processManager",g(r,t.getState())),u(t.getState(),r,n))){s.a.getInstance().traceManager.getTracer(n).error("getProcessManagerWithJitInitIfNeeded invoking JIT initialization of process manager",g(r,t.getState()));const e=Object(a.g)(t.getState(),r);return Object(i.b)(r,e)}return e}function h(e,t,r,n){return[{name:"pageId",value:e},{name:"formType",value:Object(a.l)(t,e)},{name:"InitialXrmProcessControlIsNotNull",value:r},{name:"XrmEntityIsNotNull",value:n}]}function p(e,t,r){return[{name:"pageId",value:e},{name:"formType",value:Object(a.l)(t,e)},{name:"getProcessManagerInvoked",value:r}]}function g(e,t){return[{name:"pageId",value:e},{name:"formType",value:Object(a.l)(t,e)}]}},rdSB:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return l}));var n=r("SAYH"),a=r("OWbt"),i=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="businessProcessFlow.attributes.add",o="businessProcessFlow.controls.add";function c(e,t,r){const n=Object(i.v)(e);return{type:s,payload:{attributes:d(r)},meta:{pageId:t,contextKey:n}}}function l(e,t,r){const n=Object(i.v)(e);return{type:o,payload:{controls:u(r)},meta:{pageId:t,contextKey:n}}}function u(e){const t={};e&&!e.header_process&&(e.header_process={Id:null,Label:null,Name:"header_process",ShowLabel:!1,Visible:!0,Disabled:!1,DataFieldName:null,UniqueId:null,ClassId:n.a.tryParse("06E9F7AF-1F54-4681-8EEC-1E21A1CEB465")});for(const r in e){const n=Object(a.f)(e[r],null,!0);n&&(t[r]=n)}return t}function d(e){const t={};for(const r in e){const n=e[r],a={Precision:n.Precision,PrecisionSource:n.PrecisionSource,RequiredLevel:n.RequiredLevel,Format:n.Format,OptionSet:n.OptionSet,IsValidForCreate:n.IsValidForCreate,IsValidForUpdate:n.IsValidForUpdate,Targets:n.Targets};t[n.LogicalName]=a}return t}},rs6x:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r("SAYH"),a=r("arV0"),i=r("ruPX"),s=r("kX6F"),o=r("Nb1E"),c=r("odYE"),l=r("iZ7K"),u=r("504W"),d=r("lEFU"),h=r("IqkD"),p=r("69Qu"),g=r("i1f0"),m=r("E8F2");function b(e,t,r,c){const b=[{name:"formId",value:e},{name:"pageName",value:r}];return{type:"form.change",execute({dispatch:y,getState:_},v,S){const O=_();if(Object(g.Eb)(O,t))return Promise.reject(Object(m.b)(O,t,2200000016));const{entityTypeName:I,id:C,recordSetQueryKey:j,data:P,createFromRelationship:T,initWithEntity:E}=Object(a.g)(O,t);b.push({name:"entityTypeName",value:I});const w=n.a.tryParse(e),F={entityTypeName:I,formId:w,id:c?n.a.tryParse(c):C,recordSetQueryKey:j,data:P,createFromRelationship:T,initWithEntity:E},x=w.guid.toString(),A=`<MRUForm><Form Type="Main" Id="${x}" /></MRUForm>`,N=Object(d.c)(O,I);return y(Object(i.a)(r,F,t,{replaceState:!0})).then(e=>{var t,r;if(0===e.status)if(Object(p.b)(_()))null==N||N===n.a.EMPTY?function(e,t,r,a,i,c,d,p){const g=Object(l.p)(a,e),m=Object(h.q)(a),b="?$select=userentityuisettingsid&$filter=objecttypecode eq {0} and _ownerid_value eq '{1}'&$top=1",y=String.format(b,g.toString(),m.guid.toString());i(Object(o.e)("userentityuisettings",y)).then(h=>{h.value&&h.value.length>0&&(r=h.value[0].userentityuisettingsid?new n.a(h.value[0].userentityuisettingsid):n.a.EMPTY),Object(u.a)(r)||Object(u.a)(c)||Object(u.a)(e)||0===e.length||n.a.isNullOrEmpty(r)?null!=r&&r!==n.a.EMPTY||function(e,t,r,a,i,c,d){let h=n.a.EMPTY;const p=Object(l.p)(r,e),g="userentityuisettings";a(Object(o.b)(g,{objecttypecode:p,lastviewedformxml:t})).then(t=>{if(h=t,!(Object(u.a)(h)||Object(u.a)(i)||Object(u.a)(e)||0===e.length||n.a.isNullOrEmpty(h))){const t=d.TraceManager.getTracer("Forms.FormSelectorChange"),r="Created an entry for selected form successfully formid : "+i;t.info(r),a(Object(s.b)(e,i,h))}}).catch(t=>{if(-2147093999===t.errorCode)return Object(u.a)(i)||Object(u.a)(e)||0===e.length||a(Object(s.b)(e,i,h)),{};const r=[{name:"CorrelationId",value:c.correlationId},{name:"ContextId",value:c.contextId},{name:"ActionStack",value:c.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],n="Catch block of ChangeForm.oDataCreate, for formid: "+i;d.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(n),void 0,r),d.TraceManager.getTracer("Forms.FormSelectorChange").error(n,r)})}(e,t,a,i,c,d,p):f(e,t,r,a,i,c,d,p)}).catch(t=>{if(-2147093999===t.errorCode)return Object(u.a)(c)||Object(u.a)(e)||0===e.length||i(Object(s.b)(e,c,r)),{};const n=[{name:"CorrelationId",value:d.correlationId},{name:"ContextId",value:d.contextId},{name:"ActionStack",value:d.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],a="Catch block of ChangeForm.oDataRetrieve, for formid: "+c;p.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(a),void 0,n),p.TraceManager.getTracer("Forms.FormSelectorChange").error(a,n)})}(I,A,N,_(),y,w,S,v):f(I,A,N,_(),y,w,S,v);else{Object(u.a)(w)||Object(u.a)(I)||0===I.length||y(Object(s.b)(I,w,N));const e=null===(t=null==v?void 0:v.TraceManager)||void 0===t?void 0:t.getTracer("Forms.FormSelectorChange"),r="Selected form did not save in the UserEntityUiSetting table, for formid: "+w;null==e||e.info(r)}else if(1===e.status){const e=null===(r=null==v?void 0:v.TraceManager)||void 0===r?void 0:r.getTracer("Forms.FormSelectorChange"),t=`Could not change to form with id ${x} due to a navigation failure or because navigation was cancelled`;null==e||e.info(t,b)}return e})},getFailureParameters:(e,t)=>b}}function f(e,t,r,a,i,l,d,h){const p=new c.a("userentityuisettings",r);i(Object(o.f)(p,{lastviewedformxml:t})).then(()=>{if(!(Object(u.a)(r)||Object(u.a)(l)||Object(u.a)(e)||0===e.length||n.a.isNullOrEmpty(r))){const t=h.TraceManager.getTracer("Forms.FormSelectorChange"),n="Updated selected form successfully to : "+l;t.info(n),i(Object(s.b)(e,l,r))}}).catch(t=>{if(-2147093999===t.errorCode)return Object(u.a)(l)||Object(u.a)(e)||0===e.length||i(Object(s.b)(e,l,r)),{};const n=[{name:"CorrelationId",value:d.correlationId},{name:"ContextId",value:d.contextId},{name:"ActionStack",value:d.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],a="Catch block of ChangeForm.oDataUpdate, for formid: "+l;h.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(a),void 0,n),h.TraceManager.getTracer("Forms.FormSelectorChange").error(a,n)})}},"s+OO":function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return s})),r.d(t,"c",(function(){return o}));var n=r("dHD5"),a=r("BFlg");const i="chart.filterexpression.update",s="ChartFilterExpression";function o(e,t,r){return{type:"chart.filterexpression.update.async",execute({dispatch:o,getState:c},l){const u=l.TraceManager.getTracer(a.z),d=a.x+".updateFilterExpressionAction";try{u.info("Updating the chart filter expression"),t||(t=Object(n.k)(c(),e));const a=Object(n.v)(t);return o(function(e,t,r){return{type:i,payload:{name:s,value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,a,r)),l.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){const t="Updatation of the chart filter expression failed with error : "+e.message;l.EventManager.ReportComponentFailure(d,Error(t))}}}}},sn0j:function(e,t,r){"use strict";r.d(t,"c",(function(){return h})),r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return p}));var n=r("SAYH"),a=r("Lohl"),i=r("y60j"),s=r("LbMF"),o=r("FZDd"),c=r("3hnk"),l=r("j6Db"),u=r("qLnS");const d=["activitytypecode","prioritycode","scheduledend","subject","description","regardingobjectid","ownerid","createdon","statecode","modifiedon"];function h(e,t,r){return{type:"formandattribute.retrieve.async",execute({dispatch:c,getState:u},h){const m="Card"===r;return e.etn&&"activitypointer"===e.etn&&m?c(Object(o.f)("activitypointer",!1,d)).then(()=>{const t=u(),r={};for(const n of d){const a=Object(s.a)(t,e.etn,n);a&&p(t,e.etn,n,a)&&(r[n]=a)}return g(t,e.etn,r,Object(s.d)(t,e.etn)),{formDescriptor:null,attributeDescriptors:r}}):c(Object(a.b)(e,t,r)).then(a=>{const d={};let b=null;return e.etn?c(Object(o.f)(e.etn,!0,[])).then(()=>{const t=u();if(!n.a.isNullOrEmpty(a)&&(b=Object(i.j)(t,a),b&&b.Attributes))for(const r in b.Attributes){const n=b.Attributes[r],a=Object(s.a)(t,e.etn,n);a&&p(t,e.etn,n,a)&&(d[n]=a)}return m&&g(t,e.etn,d,Object(s.d)(t,e.etn)),{formDescriptor:b,attributeDescriptors:d}}):(h.EventManager.ReportComponentSuccess("Form.CustomControl.retrieveFormWithAttributes",[{name:"APIName",value:l.a+".Actions.RetrieveFormWithAttributesAction"},{name:"formId",value:n.a.toString(t)},{name:"formType",value:r}]),null)},e=>{const a=e.get_message();h.EventManager.ReportComponentFailure("Form.CustomControl.retrieveFormWithAttributes",new Error(a),a,[{name:"APIName",value:l.a+".Actions.RetrieveFormWithAttributesAction"},{name:"formId",value:n.a.toString(t)},{name:"formType",value:r}])})}}}function p(e,t,r,n){return Object(c.f)(e,t,r,u.a.CanRead)&&n&&n.IsValidForRead}function g(e,t,r,n){if(n)for(const a in n){const i=n[a];!i.IsSortableEnabled&&"modifiedon"!==i.LogicalName||r[a]||!p(e,t,i.LogicalName,i)||"image"===i.Type||"multiselectpicklist"===i.Type||(r[a]=i)}}},sxfa:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("WRDA"),a=r("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i{constructor(e){this.path=e}get path(){return this._traversedPath}set path(e){for(this._traversedPath=Object(n.a)(e);this._traversedPath&&this._traversedPath.indexOf("}")>0;)this._traversedPath=Object(n.a)(this._traversedPath)}static getCandidateTraversedPathFromStagStep(e,t){t=Object(n.a)(t);let r=!1;if(!e||e.length)return null;for(let a=0;a<e.length;a++){const i=Object(n.a)(e[a].get_stageId());if("".concat(i,","),t===i){r=!0;break}}return r?"".substring(0,"".length-2):null}isInTraversedPath(e){return!Object(a.b)(e)&&this._traversedPath.indexOf(Object(n.a)(e))>-1}}},tpZ5:function(e,t,r){"use strict";r.d(t,"a",(function(){return C}));var n=r("0nOn"),a=r("OQLa"),i=r("arV0"),s=r("UqyN"),o=r("L8zx"),c=r("ZIjf"),l=r("3yqi"),u=r("EOIL"),d=r("i1f0"),h=r("Bo7t"),p=r("Tg1Y"),g=r("16wZ"),m=r("qshH");let b;class f extends u.a{constructor(e,t,r,n,a,i){super(e,t,r,n,a,i),b=e}getDefaultNextPageName(){const e="ClientApi.XrmNavigableFormUi.getDefaultNextPageName";try{c.a.instance.reportCall(e);const t=Object(d.M)(b.getState(),this.pageId,this.contextToken);return c.a.instance.reportSuccess(e),t}catch(t){const r=m.a.getInstance().getEventParameters(this.contextToken);throw m.a.getInstance().reportFailure(e,t,null,r),t}}movePrevious(){const e="ClientApi.XrmNavigableFormUi.movePrevious";try{c.a.instance.reportCall(e),b.dispatch(Object(p.b)(this.pageId,this.contextToken)),c.a.instance.reportSuccess(e)}catch(t){const r=m.a.getInstance().getEventParameters(this.contextToken);throw m.a.getInstance().reportFailure(e,t,null,r),t}}moveTo(e){const t="ClientApi.XrmNavigableFormUi.moveTo";let r;try{if(c.a.instance.reportCall(t),e&&this.tabs){const t=Object(d.Gc)(b.getState(),this.pageId,e,this.contextToken);r=this.tabs.get(null==t?void 0:t.Name),r&&b.dispatch(Object(h.b)(this.pageId,this.contextToken,null==t?void 0:t.Id))}c.a.instance.reportSuccess(t)}catch(e){const r=m.a.getInstance().getEventParameters(this.contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}r||Object(g.h)(t,"pageName",e)}get taskProcess(){return c.a.instance.reportUsage("ClientApi.XrmNavigableFormUi.taskProcess"),this}}var y=r("SAYH"),_=r("n6Qt"),v=r("deGN"),S=r("G0J3"),O=r("504W");let I;class C extends S.a{constructor(e,t,r,a,i){super(e,t&&t.etn,a,i,e=>10===e||12===e?f:u.a,r);const s=[{name:"pageId",value:i,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];this._clientApiExecutorForm=new n.a(e,"ClientApi.XrmForm.",i,a,s),I=e,this._entityReference=t}get applicationContext(){return this._applicationContext}set applicationContext(e){this._applicationContext=e}get context(){try{return c.a.instance.reportCall("ClientApi.XrmForm.context"),c.a.instance.reportSuccess("ClientApi.XrmForm.context"),this._globalContext}catch(e){throw this._reportFailure("ClientApi.XrmForm.context",e)}}set context(e){this._globalContext=e}get entityReference(){return this._clientApiExecutorForm.execute("entityReference_get",()=>({id:y.a.externalGuid(this._entityReference.id),entityType:this._entityReference.etn}))}get data(){try{if(c.a.instance.reportCall("ClientApi.XrmForm.data"),!this._data){let e;const t=Object(i.l)(I.getState(),this.pageId);t!==l.a.Dialog&&t!==l.a.ModalDialog&&this._entityReference&&(e=new s.a(I,this.contextToken,this.pageId,this,this._entityReference.etn,this._entityReference.id,j,this._applicationContext)),this._data=new o.a(I,this.contextToken,this.pageId,this,e)}return c.a.instance.reportSuccess("ClientApi.XrmForm.data"),this._data}catch(e){throw this._reportFailure("ClientApi.XrmForm.data",e)}}getAttribute(e){return this._clientApiExecutorForm.execute("getAttribute",()=>{var t,r;let n=null;return this.data&&this.data.entity&&(n=this.data.entity.attributes.get(e)),n?Object(O.a)(e)&&(n=n.concat(this.data.attributes.get(e))):n=null===(r=null===(t=this.data)||void 0===t?void 0:t.attributes)||void 0===r?void 0:r.get(e),n})}getUrl(e){try{c.a.instance.reportCall("ClientApi.XrmForm.getUrl");let t=null,r=null;if(this.contextToken.parentContextToken){const e=this.data.entity.getEntityReference(),n={entityTypeName:e.entityType,etn:e.name,id:y.a.fromExternalGuid(e.id)};t=l.a.EditForm,r=n}else t=Object(i.l)(I.getState(),this.pageId),r=Object(i.g)(I.getState(),this.pageId);switch(t){case l.a.EditForm:{const e=new _.a(I,this.applicationContext,this.context,this.pageId);r={entityTypeName:r.entityTypeName,etn:r.etn,id:r.id,entityTypeCode:e.getEntityCode(r.entityTypeName),languageId:this._globalContext.userSettings.languageId,recordSetQueryKey:r.recordSetQueryKey};break}case l.a.Grid:{const e=new _.a(I,this.applicationContext,this.context,this.pageId);r={entityTypeName:r.entityTypeName,pageType:r.pageType,entityTypeCode:e.getEntityCode(r.entityTypeName)};break}}let n=null;if(1===e)n=I.dispatch(Object(a.a)(t,r));else{const e=Object(v.a)(I,this.pageId);n=I.dispatch(Object(a.c)(e,t,r))}return c.a.instance.reportSuccess("ClientApi.XrmForm.getUrl"),n}catch(e){throw this._reportFailure("ClientApi.XrmForm.getUrl",e)}}_reportFailure(e,t){const r=m.a.getInstance().getEventParameters(this.contextToken);return r.push({name:"entityName",value:this._entityReference.etn}),m.a.getInstance().reportFailure(e,t,null,r),t}}function j(e,t,r){const n=Object(d.bb)(I.getState(),r,t);return n||e.TraceManager.getTracer("ClientApi.XrmForm.getAttributeNames").error("Form attributes was null"),n}},tvJg:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="attribute.options.clear";function i(e,t,r){const i=Object(n.x)(t);return{type:a,payload:void 0,meta:{pageId:e,contextKey:i,dataFieldName:r}}}},uOtn:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return l}));var n=r("Sbn7"),a=r("Zw8F"),i=r("y60j"),s=r("SAYH"),o=r("0nOn");let c;class l{constructor(e,t,r,n,s,l=i.n,u=a.a){this._formId=r,c=e,this._entityName=n,this._pageId=s,this._getSelectorItems=l,this._selectorItemType=u,this._clientApiExecutor=new o.a(e,"ClientApi.XrmControlFormSelector.",s,t)}get items(){return this._clientApiExecutor.execute("items_get",e=>{if(!this._items){this._items=new n.a(e);const t=this._getSelectorItems(c.getState(),this._entityName);if(t)for(const e in t){const r=t[e],n=r.name||r.DisplayName,a=new this._selectorItemType(new s.a(e),n,c,this._pageId);this._items.add(a.getId(),a)}}return this._items})}getCurrentItem(){return this._clientApiExecutor.execute("getCurrentItem",()=>{const e=this.items;for(let t=0;t<e.getLength();t++){const r=e.get(t);if(r.getId()===s.a.toString(this._formId))return r}return null})}}class u extends l{}},"uPT+":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));const n="powerbi.signedin.state";function a(e,t){return{type:n,payload:t,meta:{pageId:e}}}},ujVH:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return d}));var n=r("dHD5"),a=r("BFlg"),i=r("P6DH"),s=r("3hnk"),o=r("kWiz"),c=r("WePp"),l=r("qLnS");const u="dataset.dependentoptionset.column.status";function d(e,t){const r=[];return{type:"dependentoptionset.column.status",sync:!0,execute({dispatch:s,getState:l},d,m){const b=d.TraceManager.getTracer(a.z),f=a.x+".SetDependentOptionSetColumnStatusAction";d.TraceManager.setLogLevel(o.a.Info,f);try{const a=Object(n.v)(t),o=l();let y=null;const _=Object(i.Q)(l(),e,t),v={};if(_)y=_;else{const r=Object(i.S)(l(),{id:e},t);r&&r.entityLogicalName&&(y=r.entityLogicalName)}if(y){r.push({name:"CorrelationId",value:m.correlationId},{name:"ContextId",value:m.contextId},{name:"ActionStack",value:m.stack},{name:"PageId",value:e},{name:"EntityTypeName",value:y}),b.info("Executing initialize dependent option set column status action in grid.",r);const n={name:"NumPartialDependentOptionSetChainAttributesInGrid",value:0},a=[];let s=0;const l=Object(i.z)(o,t,y,e);for(const r in l){const i=l[r];if(null===i.ParentPicklistLogicalName){const i={name:r,value:0};h(o,t,e,y,l,r,i)?p(l,r,v,n):(g(l,r,v),s++,a.push(i))}else void 0===l[i.ParentPicklistLogicalName]&&p(l,r,v,n)}const u={name:"NumCompleteDependentOptionSetChainsInGrid",value:s},_={name:"CompleteChainsMaxDepthInGrid",value:a};r.push(u,n,_);const S=new c.a(f);S.addEventParameter("NumCompleteDependentOptionSetChainsInGrid",s),S.addEventParameter("NumPartialDependentOptionSetChainAttributesInGrid",n.value),S.addEventParameter("CompleteChainsMaxDepthInGrid",a),d.EventManager.ReportEvent(S),d.EventManager.ReportComponentSuccess(f),b.info("Executed initialize dependent option set column status action successfully.",r)}Object.keys(v).length>0&&s(function(e,t,r){return{type:u,payload:r,meta:{pageId:e,dataSetContextKey:t}}}(e,a,v))}catch(e){const t="creating dependent option set column status node in state tree failed.";d.EventManager.ReportComponentFailure(f,Error(t))}}}}function h(e,t,r,n,a,i,o){if(void 0===a[i])return!0;if(function(e,t,r,n,a){if(!Object(s.f)(e,a,n,l.a.CanUpdate)||!r[n].IsValidForUpdate)return!0;return!1}(e,0,a,i,n))return!0;const c=a[i].ChildPicklistLogicalNames;if(null!==c)for(let s=0;s<c.length;s++){const l={name:i,value:0};if(h(e,t,r,n,a,c[s],l))return!0;o.value=Math.max(o.value,l.value)}return o.value=o.value+1,!1}function p(e,t,r,n){if(void 0===e[t])return;r[t]=0,n.value=n.value+1;const a=e[t].ChildPicklistLogicalNames;if(a)for(let t=0;t<a.length;t++)p(e,a[t],r,n)}function g(e,t,r){r[t]=1;const n=e[t].ChildPicklistLogicalNames;if(n)for(let t=0;t<n.length;t++)g(e,n[t],r)}},wFY3:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n="polite",a="assertive"},wZxB:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return h}));var n=r("4r2D"),a=r("SAYH"),i=r("iZ7K"),s=r("FZDd"),o=r("pEXn"),c=r("Nb1E"),l=r("fU7K");const u=o.b.AdvancedFindLookupResolverParameters;function d(e,t,r){const c=[];return{type:"advancedFind.lookup.retrieve.async",execute({dispatch:l,getState:d},h,g){const m=new n.a(a.a.newGuid().guid,g&&g.isPreloadCall);c.push({name:o.b.ActionType,value:"advancedFind.lookup.retrieve.async"},{name:o.b.ClientRequestId,value:m.RequestId()},{name:u.PrimaryEntity,value:e},{name:u.Targets,value:t.join(",")});const b=t.reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:[]}),{});return l(Object(s.e)(b)).then(()=>{const e=function(e,t,r,n){return(a,s)=>{const o=Object(i.h)(r,s);if(!o||!o.EntityLogicalName||!o.PrimaryNameAttribute)return n.push({name:u.EntityMetadataUnavailable,value:s}),a;const c=`<fetch version="1.0" mapping="logical" no-lock="false"><entity name="${o.EntityLogicalName}"><attribute name="${o.PrimaryNameAttribute}"/><attribute name="${o.PrimaryIdAttribute}"/><order attribute="${o.PrimaryNameAttribute}" descending="false" /><filter type="or"><condition attribute="${o.PrimaryNameAttribute}" operator="like" value="%${t||""}%" /></filter></entity></fetch>`,l=p(e,o,c,n);return a.push(l),a}}(l,r,d(),c),n=t.reduce(e,[]);return Promise.all(n).then(e=>Promise.resolve([].concat(...e)))})},getSuccessParameters:()=>c,getFailureParameters:(e,t)=>c}}function h(e,t,r){const c=[];return{type:"advancedFind.lookup.retrieve.by.id.async",execute({dispatch:l,getState:d},h,g){const m=new n.a(a.a.newGuid().guid,g&&g.isPreloadCall);c.push({name:o.b.ActionType,value:"advancedFind.lookup.retrieve.async"},{name:o.b.ClientRequestId,value:m.RequestId()},{name:u.PrimaryEntity,value:e},{name:u.Targets,value:t.join(",")});const b=t.reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:[]}),{});return l(Object(s.e)(b)).then(()=>{const e=function(e,t,r,n){return(a,s)=>{const o=Object(i.h)(r,s);if(!o||!o.EntityLogicalName||!o.PrimaryNameAttribute)return n.push({name:u.EntityMetadataUnavailable,value:s}),a;const c=t.filter(e=>!!e).map(e=>`<condition attribute="${o.PrimaryIdAttribute}" operator="eq" value="${e}" />`),l=`<fetch version="1.0" mapping="logical" no-lock="false"><entity name="${o.EntityLogicalName}"><attribute name="${o.PrimaryNameAttribute}"/><attribute name="${o.PrimaryIdAttribute}"/><order attribute="${o.PrimaryNameAttribute}" descending="false" /><filter type="or">${c}</filter></entity></fetch>`,d=p(e,o,l,n);return a.push(d),a}}(l,r,d(),c),n=t.reduce(e,[]);return Promise.all(n).then(e=>Promise.resolve([].concat(...e)))})},getSuccessParameters:()=>c,getFailureParameters:(e,t)=>c}}function p(e,t,r,n){const a="?fetchXml="+Object(l.CrmUrlEncode)(r);return new Promise((r,i)=>{e(Object(c.e)(t.EntityLogicalName,a,100)).then(e=>{const a=function(e,t){const r=[];t.value&&t.value.length>0&&t.value.forEach(t=>{r.push({id:t[e.PrimaryIdAttribute],displayName:t[e.PrimaryNameAttribute],entityLogicalName:(null==e?void 0:e.EntityLogicalName)||void 0,entityDisplayName:(null==e?void 0:e.DisplayName)||void 0})});return r}(t,e);n.push({name:u.RetrieveRequestSuccess,value:`Retrieve Seccuess for ${t.EntityLogicalName} Count: ${a.length}`}),r(a)},e=>{n.push({name:u.RetrieveRequestFail,value:`Failed to retrieve records for ${t.EntityLogicalName} Error: ${e}`}),r([])})})}},waMg:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="grid.updatequerykey";function i(e,t,r){const i=Object(n.y)(r),s=Object(n.v)(r);return{type:a,payload:e,meta:{pageId:t,contextKey:i,dataSetContextKey:s}}}},xorU:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"d",(function(){return o})),r.d(t,"c",(function(){return i})),r.d(t,"f",(function(){return c})),r.d(t,"b",(function(){return s})),r.d(t,"e",(function(){return l}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="controls.addCustomFilter",i="controls.startCustomFilter",s="controls.endCustomFilter";function o(e,t,r,i,s){const o=Object(n.v)(i);return{type:a,payload:{customFilter:s,entityLogicalName:r},meta:{pageId:e,controlName:t,contextKey:o}}}function c(e,t,r){const a=Object(n.v)(r);return{type:i,payload:{},meta:{pageId:e,controlName:t,contextKey:a}}}function l(e,t,r){const a=Object(n.v)(r);return{type:s,payload:{},meta:{pageId:e,controlName:t,contextKey:a}}}},yl9a:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="control.setSrc";function i(e,t,r,i){const s=Object(n.v)(r);return{type:a,payload:{Url:i,isCustomSrc:!0},meta:{pageId:e,controlName:t,contextKey:s}}}},ywwS:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r("0nOn"),a=r("P6DH"),i=r("HcnX"),s=r("AbXy"),o=r("FETf"),c=r("LE5i"),l=r("16wZ"),u=r("NAAR"),d=r("qshH"),h=r("HAeo"),p=r("ghNp"),g=r("dHD5"),m=r("ZIjf"),b=r("FZDd"),f=r("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const y="ClientApi.XrmControlTimeline.";let _;class v extends i.a{constructor(e,t,r,a,i,s,o,c){super(e,t,r,a,i,o),this._defaultLabel=u.u.Timeline,_=e,this._applicationContext=c,this._controlId=s,this._traceManager=c.TraceManager,this._subgridToken=Object(g.p)(t,i),this._clientApiExecutorTimeline=new n.a(e,y,r,t),this._clientApiExecutorTimeline.addEventParameter({name:"controlName",value:i,isEventParam:!0,expectedDataType:"string"}),this._clientApiExecutorTimeline.addEventParameter({name:"controlId",value:s,isEventParam:!0,expectedDataType:"string"}),this._gridControl=new h.a(e,this._subgridToken,r,!1,3,!0,c,i),e.dispatch(Object(p.a)(this,r,this._subgridToken))}getControlType(){return m.a.instance.reportUsage(y+"getControlType"),"timelinewall"}getName(){return this.clientApiExecutor.execute("getName",()=>this.controlDescriptor&&this.controlDescriptor.Parameters&&this.controlDescriptor.Parameters[u.s.UClientUniqueName]?this.controlDescriptor.Parameters[u.s.UClientUniqueName]:u.u.Timeline)}getLabel(){const e=y+"getLabel";try{m.a.instance.reportCall(e);const t=this.controlDescriptor&&this.controlDescriptor.Parameters&&!Object(l.a)(this.controlDescriptor.Parameters[u.s.Label])?this.controlDescriptor.Parameters[u.s.Label]:this._defaultLabel?this._defaultLabel:"";return m.a.instance.reportSuccess(e),t}catch(t){const r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,r),t}}setLabel(e){const t=y+"setLabel";try{m.a.instance.reportCall(t),super.setLabel(e),this.controlDescriptor&&this.controlDescriptor.Parameters?this.controlDescriptor.Parameters[u.s.Label]=e:this._defaultLabel=e,m.a.instance.reportSuccess(t)}catch(e){const r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(t,e,null,r),e}}openEmail(e){const t=y+"openEmail";try{m.a.instance.reportCall(t),_.dispatch(Object(o.t)(this._controlId,e)),_.dispatch(Object(o.o)(this._controlId,c.a.ContextualDialogEntity,2,f.a.toString(f.a.newGuid()))),m.a.instance.reportSuccess(t)}catch(e){const r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(t,e,null,r),e}}refresh(e){let t=y+"refresh";e&&e.modules&&(t+="-modules"),e&&e.activities&&(t+="-activities");try{m.a.instance.reportCall(t),e&&this.controlDescriptor&&this.controlDescriptor.Parameters&&(e.modules&&(this.controlDescriptor.Parameters[u.s.UClientModules]=e.modules),e.activities&&(this.controlDescriptor.Parameters[u.s.UClientActivities]=e.activities)),_.dispatch(Object(o.o)(this._controlId,c.a.InitiateRefresh,1,f.a.toString(f.a.newGuid()))),m.a.instance.reportSuccess(t)}catch(e){const r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(t,e,null,r),e}}setTargetEntity(e,t,r=!0){const n=y+"setTargetEntity";try{m.a.instance.reportCall(n);const a={etn:e,id:t,isAPI:!0},i={};return i[e]=[],_.dispatch(Object(o.v)(this._controlId,a)),_.dispatch(Object(b.e)(i)).catch(t=>{const r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),r.push({name:"entityName",value:e}),d.a.getInstance().reportFailure(n+"-retrieveEntities",t,null,r),t}).then(()=>{r&&_.dispatch(Object(o.o)(this._controlId,c.a.InitiateRefresh,1,f.a.toString(f.a.newGuid()))),m.a.instance.reportSuccess(n)})}catch(e){const t=d.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(n,e,null,t),e}}getGrid(){const e=y+"getGrid";try{return m.a.instance.reportCall(e),this._grid||(this._grid=new s.a(_,this._applicationContext,this._subgridToken,this.pageId,this.getEntityName(),!1,this.name)),m.a.instance.reportSuccess(e),this._grid}catch(t){const r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,r),t}}getRecordSetQueryKey(){return this.clientApiExecutor.execute("getRecordSetQueryKey",()=>Object(a.cb)(_.getState(),this._subgridToken,{id:this.pageId}))}getGridType(){return m.a.instance.reportUsage(y+"getGridType"),3}getRollupType(){return this.clientApiExecutor.execute("getRollupType",()=>Object(a.eb)(_.getState(),this.pageId,this.contextToken))}getParentForm(){const e=y+"getParentForm";try{m.a.instance.reportCall(e);const t=this._gridControl.getParentForm();return m.a.instance.reportSuccess(e),t}catch(t){const r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,r),t}}refreshRibbon(){const e=y+"refreshRibbon";try{m.a.instance.reportCall(e),this._gridControl.refreshRibbon(),m.a.instance.reportSuccess(e)}catch(t){const r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,r),t}}getEntityName(){return m.a.instance.reportUsage(y+"getEntityName"),"activitypointer"}getUrl(){const e=d.a.getInstance().getEventParameters(this.contextToken);return e.push({name:"controlName",value:this.getName()}),e.push({name:"validationError",value:"true"}),this._traceManager.getTracer("ClientApi.XrmControlTimeline.getUrl").warn("Not Supported in Timeline control",e),m.a.instance.reportUsage("ClientApi.XrmControlTimeline.getUrl"),""}getFilterXml(){const e=y+"getFilterXml",t=d.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),m.a.instance.reportUsage(e),""}getFetchXml(){const e=y+"getFetchXml",t=d.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),m.a.instance.reportUsage(e),""}getViewSelector(){const e=y+"getViewSelector",t=d.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),m.a.instance.reportUsage(e),null}getTeamTemplateId(){return null}getRelationship(){const e=y+"getRelationship",t=d.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),m.a.instance.reportUsage(e),null}setFilterXml(e){const t=y+"setFilterXml",r=d.a.getInstance().getEventParameters(this.contextToken);r.push({name:"controlName",value:this.getName()}),r.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",r),m.a.instance.reportUsage(t)}addOnLoad(e){const t=d.a.getInstance().getEventParameters(this.contextToken);t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer("ClientApi.XrmControlTimeline.addOnLoad").warn("Not Supported in Timeline control",t),m.a.instance.reportUsage("ClientApi.XrmControlTimeline.addOnLoad")}removeOnLoad(e){const t=y+"removeOnLoad",r=d.a.getInstance().getEventParameters(this.contextToken);r.push({name:"controlName",value:this.getName()}),r.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",r),m.a.instance.reportUsage(t)}openRelatedGrid(){const e=y+"openRelatedGrid",t=d.a.getInstance().getEventParameters(this.contextToken);t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),m.a.instance.reportUsage(e)}}},z5LE:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return o}));var n=r("jRy5"),a=r("dHD5"),i=r("ApeL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="attribute.notification.update";function o(e,t,r,o,c){return{type:"attribute.notification.add.clear.form.notification",sync:!0,execute(e,l){e.dispatch(function(e,t,r,o){if(o&&o.contextTokenType&&o.contextTokenType===n.a.GridRow)return Object(i.d)(e,o,t,r);const c=Object(a.x)(o);return{type:s,payload:r,meta:{pageId:e,contextKey:c,dataFieldName:t}}}(t,r,o,c))}}}},z8iZ:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(e){return{Title:e&&e.Title||null,Legend:e&&e.Legend||null,Area3DStyle:e&&e.Area3DStyle||null,AreaGradientStyle:e&&e.AreaGradientStyle||null,XAxes:e&&e.XAxes||null,YAxes:e&&e.YAxes||null,SeriesList:e&&e.SeriesList||null,SubTitle:e&&e.SubTitle||null,Colors:e&&e.Colors||null,DisplayMode:e&&e.DisplayMode||0,ErrorInformation:e&&e.ErrorInformation||null,EnableDrilldown:e&&e.EnableDrilldown||!0,Annotations:e&&e.Annotations||null}}r.d(t,"a",(function(){return n}))},zFtG:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return s}));var n=r("dHD5"),a=r("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="dataset.update.pagingdata";function s(e,t,r){return{type:"dataset.update.pagingdata.async",execute({dispatch:s,getState:o},c){const l=c.TraceManager.getTracer(a.z),u=a.x+".updatePagingDataAction";try{return l.info("Updating the paging data for the grid."),s(function(e,t,r){const a=Object(n.y)(t),s=Object(n.v)(t);return{type:i,payload:r,meta:{pageId:e,contextKey:a,dataSetContextKey:s}}}(e,t,r)),c.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){const t="Updation of paging data for the grid failed with error : "+e.message;c.EventManager.ReportComponentFailure(u,Error(t))}}}}},zgeC:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r("0nOn"),a=r("P6DH"),i=r("SAYH"),s=r("HcnX"),o=r("1kth"),c=r("dHD5"),l=r("meVR"),u=r("qshH"),d=r("+zjj"),h=r("w92Z"),p=r("whN/"),g=r("HAeo"),m=r("ghNp"),b=r("ZIjf"),f=r("IaGr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const y="ClientApi.XrmControlSubGrid.";let _;class v extends s.a{constructor(e,t,r,a,i,s,o,l){super(e,t,r,o,a,s),this._relationship=null,_=e,this._subgridToken=Object(c.p)(t,a),this._clientApiExecutorSubGrid=new n.a(e,y,r,this._subgridToken),this.clientApiExecutor.addEventParameter({name:"controlName",value:a,isEventParam:!0}),this.clientApiExecutor.addEventParameter({name:"isEditable",value:i,isEventParam:!0}),this._gridControl=new g.a(e,this._subgridToken,r,i,3,!0,l,a),e.dispatch(Object(m.a)(this,r,this._subgridToken))}get clientApiExecutor(){return this._clientApiExecutorSubGrid}setFilterXml(e){const t=y+"setFilterXml";try{b.a.instance.reportCall(t),this._gridControl.setFilterXml(e),b.a.instance.reportSuccess(t)}catch(e){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,r),e}}getFilterXml(){const e=y+"getFilterXml";try{b.a.instance.reportCall(e);const t=this._gridControl.getFilterXml();return b.a.instance.reportSuccess(e),t}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,r),t}}refresh(){const e=y+"refresh";try{b.a.instance.reportCall(e),this._gridControl.refresh(),b.a.instance.reportSuccess(e)}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,r),t}}getFetchXml(){const e=y+"getFetchXml";try{b.a.instance.reportCall(e);const t=this._gridControl.getFetchXml();return b.a.instance.reportSuccess(e),t}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,r),t}}getGrid(){const e=y+"getGrid";try{b.a.instance.reportCall(e);const t=this._gridControl.getGrid();return b.a.instance.reportSuccess(e),t}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,r),t}}getViewSelector(){const e=y+"getViewSelector";try{b.a.instance.reportCall(e);const t=this._gridControl.getViewSelector();return b.a.instance.reportSuccess(e),t}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,r),t}}getTeamTemplateId(){const e=y+"getTeamTemplateId";try{b.a.instance.reportCall(e);const t=this._gridControl.getTeamTemplateId();return b.a.instance.reportSuccess(e),t}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(e,t,null,r),t}}addOnLoad(e){this.clientApiExecutor.execute("addOnLoad",()=>{_.dispatch(Object(o.d)(this._subgridToken,this.pageId,e,this.name))},[{name:"handler",value:e,isRequired:!0,isEventParam:!1}])}removeOnLoad(e){this.clientApiExecutor.execute("removeOnLoad",()=>{_.dispatch(Object(o.y)(this._subgridToken,this.pageId,e,this.name))},[{name:"handler",value:e,isRequired:!0,isEventParam:!1}])}getEntityName(){const e=y+"getEntityName";try{b.a.instance.reportCall(e);const t=this._gridControl.getEntityName();return b.a.instance.reportSuccess(e),t}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,r),t}}getControlType(){return this.clientApiExecutor.execute("getControlType",()=>{const e=Object(h.a)(_.getState(),this.controlDescriptor,this.pageId,this.contextToken);return e?"customsubgrid:"+e.Name:"subgrid"})}getRelationship(){return this.clientApiExecutor.execute("getRelationship",(e,t)=>{var r,n;if(!this._relationship){if(null===(n=null===(r=this.controlDescriptor)||void 0===r?void 0:r.Parameters)||void 0===n?void 0:n.RelationshipName){const e=this.controlDescriptor.Parameters.RelationshipName,t=this.controlDescriptor.Parameters.RelationshipRoleOrdinal,r=this.controlDescriptor.Parameters.TargetEntityType;this._relationship=Object(g.b)(e,r),this._relationship.roleType=t}this._relationship||(this._relationship=this._gridControl.getRelationship())}return this._relationship})}getRecordSetQueryKey(){return this.clientApiExecutor.execute("getRecordSetQueryKey",()=>Object(a.cb)(_.getState(),this._subgridToken,{id:this.pageId}))}getGridType(){return b.a.instance.reportUsage(y+"getGridType"),3}getRollupType(){return this.clientApiExecutor.execute("getRollupType",()=>Object(a.eb)(_.getState(),this.pageId,this.contextToken))}openRelatedGrid(){this.clientApiExecutor.executeAsync("openRelatedGrid",(e,t)=>{const r=this.getRelationship();if(!r)return f.a.getInstance().traceManager.getTracer(e).error("Can't open related grid: the relationship was not retrieved from the inner grid.",t),Promise.resolve(i.a.EMPTY);const n=Object(d.c)(_.getState(),this.pageId);let a=null;for(let e=0;e<n.length;e++)if(n[e].relationshipName===r.name){a=n[e];break}if(!a)return t.push({name:"relationshipName",value:r.name}),f.a.getInstance().traceManager.getTracer(e).error("Can't open related grid: no relationship was found with the specified name.",t),Promise.resolve(i.a.EMPTY);const s={id:a.id,title:a.title,entityName:this.getEntityName(),relationshipName:r.name,isSelected:!0,show:a.show},o=Object(c.a)(this._subgridToken.parentContextToken,r.name,r.roleType?1===r.roleType?p.a.Referencing:p.a.AssociationEntity:void 0);return _.dispatch(Object(l.a)(this.pageId,o,s))})}refreshRibbon(){const e=y+"refreshRibbon";try{b.a.instance.reportCall(e),this._gridControl.refreshRibbon(),b.a.instance.reportSuccess(e)}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,r),t}}getUrl(){const e=y+"getUrl";try{b.a.instance.reportCall(e);const t=this._gridControl.getUrl();return b.a.instance.reportSuccess(e),t}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,r),t}}getParentForm(){const e=y+"getParentForm";try{b.a.instance.reportCall(e);const t=this._gridControl.getParentForm();return b.a.instance.reportSuccess(e),t}catch(t){const r=u.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,r),t}}}}}]),window.bundleExecutionMarkers["scripts/dashboardpage.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();