(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/4.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[4],{TUxu:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n("MLbG"),a=n("Vm/X"),o=n("Z46F"),i=n("Ww2r"),u=n("mGpW"),l=n("+D0h"),c=n("F/wp");function m(e,t){return{type:"commanding.script.error.dialog",execute:function(n,m,s){var d=t.errorCode?t.errorCode:-2140991205,p=t.errorFault.message,b=t.errorFault.stack,g="0x"+o.a.getHexErrorCodeFromInt(d),h="Error_Title_"+g,v="Error_Message_"+g,f=[h,v,"SolutionWizard.Button.Export.Tooltip","Button_Label_OK","Web.Dialog.ErrorCode_Caption","Error_Title_0x8004b056","Error_Title_0x80700000","L_Show_Details_Text","L_Client_Session_Id","L_Current_Time","L_Correlation_Id"];return n.dispatch(Object(u.e)(f)).then((function(){var t=Object(i.e)(n.getState(),f),o=Object(i.c)(t,h),u=Object(i.c)(t,v),d=Object(i.c)(t,"SolutionWizard.Button.Export.Tooltip"),g=Object(i.c)(t,"Button_Label_OK"),_=Object(i.c)(t,"L_Show_Details_Text"),I=Object(i.c)(t,"L_Client_Session_Id"),C=Object(i.c)(t,"L_Current_Time"),y=Object(i.c)(t,"L_Correlation_Id");u=u.replace("\\r\\n{0}","");var E=I.replace("{0}",m.EventManager.getCurrentSessionId()),N=C.replace("{0}",""+new Date),L=y.replace("{0}",s.correlationId);n.dispatch(Object(r.a)(a.d,p,{type:"error"},d,o,u,g,_,[p,E,L,N],void 0,e)).then((function(e){if(0===e.status)return n.dispatch(Object(l.a)(e.pageId)).then((function(e){if(e&&e.value&&e.value.confirmed){var t={mimeType:"text/plain",fileName:"ErrorDetails.txt",fileContent:btoa(b),fileSize:b.length};new c.a(m,n).openFile(t,{openMode:2})}}));m.EventManager.ReportComponentFailure("Commanding.Actions.OpenJavaScriptErrorDialog",e.error)}))}))}}}},e2pn:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var r=n("TJkj"),a=n("aZHW"),o=n("EGsq"),i=n("7EJx"),u=n("4pqm"),l=n("lMVv"),c=n("9r0m"),m=function(){function e(){}return e.prototype.openUrl=function(e,t,n,r){var a,m;if(e&&e.Address){var s=Object(o.x)(n),d=Object(o.w)(n),p=Object(i.w)(n),b=new u.a(e.Address);if(t.forEach((function(e){e.name&&b.searchParams.set(e.name,e.value)})),e.PassParameters&&(b.searchParams.set("orgname",d),b.searchParams.set("userlcid",p.languageId.toString()),b.searchParams.set("orglcid",s.languageCode.toString()),2===r.ContextType||5===r.ContextType)){var g=Object(l.p)(n,r.ContextEntityLogicalName).toString();b.searchParams.set("typename",r.ContextEntityLogicalName),b.searchParams.set("type",g);var h=(null===(a=null==r?void 0:r.EntityId)||void 0===a?void 0:a.guid)?null===(m=null==r?void 0:r.EntityId)||void 0===m?void 0:m.guid.toString():c.a.EMPTYGUIDSTRING;b.searchParams.set("id",h)}return window.open(b.href," ",e.WinParameters)}return null},e}(),s=n("JECh");var d=n("WACO"),p=n("Eoze"),b=n("c/eZ"),g=n("BFwB"),h=function(e){function t(t,n,r,a,o,i,u){var l=e.call(this,"uci_commanding_command_execution")||this;return e.prototype.addEventParameter.call(l,"TimeTaken",new Date),e.prototype.addEventParameter.call(l,"CommandType",t),e.prototype.addEventParameter.call(l,"CommandId",n),e.prototype.addEventParameter.call(l,"ControlId",r),e.prototype.addEventParameter.call(l,"CommandManagerId",a),e.prototype.addEventParameter.call(l,"PageId",o),e.prototype.addEventParameter.call(l,"EntityName",i),e.prototype.addEventParameter.call(l,"SelectedItemsCount",u),l}return Object(b.__extends)(t,e),t}(g.a),v=n("7pqb"),f=n("/j9Z"),_=n("TUxu"),I=n("3pZv"),C=n("Ev4I"),y=n("KVkm"),E=n("zmaG"),N=n.n(E),L=n("NUwQ"),T=function(){this.Items=null},w=function(){this.Alt=null,this.ControlType=null,this.Command=null,this.LabelText=null,this.Id=null,this.ModernImage=null,this.Menu=null},A=function(){this.Item=null,this.Title=null},F=function(){this.MenuSection=null,this.Id=null},M=n("+Iuh"),P=function(){function e(e){this._parsedXml=null,this._parsedXml=this._parseXMLFromString(e)}return e.prototype._parseXMLFromString=function(e){var t=Object(M.b)(e),n=Object(M.a)(t),r=null;return n.hasChildNodes()&&(r=this.parseMenuFromXML(n.childNodes().get_item(0))),r},e.prototype.getParsedXml=function(){return this._parsedXml},e.prototype.parseMenuFromXML=function(t){var n=new F;if(t.get_tagName()===e._MENU_TAG){if(n.Id=t.getAttribute(e._ID_FIELD),n.MenuSection=new Array(0),t.hasChildNodes())for(var r=t.childNodes(),a=0;a<r.get_count();a++)n.MenuSection.push(this.parseMenuSectionFromXML(r.get_item(a)))}else n=null;return n},e.prototype.parseMenuSectionFromXML=function(t){var n=new A;return t.get_tagName()===e._MENUSECTION_TAG?(n.Title=t.getAttribute(e._TITLE_FIELD),t.hasChildNodes()?n.Item=this.parseItemFieldFromXML(t.childNodes().get_item(0)):n.Item=null):n=null,n},e.prototype.parseItemFieldFromXML=function(t){var n=new T;if(t.get_tagName()===e._CONTROL_TAG){if(n.Items=new Array(0),t.hasChildNodes())for(var r=t.childNodes(),a=0;a<r.get_count();a++)n.Items.push(this.parseItemFromXML(r.get_item(a)))}else n=null;return n},e.prototype.parseItemFromXML=function(t){var n=new w;switch(n.Alt=t.getAttribute(e._ALT_FIELD),n.ControlType=t.get_tagName(),n.Command=t.getAttribute(e._COMMAND_FIELD),n.LabelText=t.getAttribute(e._LABELTEXT_FIELD),n.Id=t.getAttribute(e._ID_FIELD),n.ModernImage=t.getAttribute(e._MODERNIMAGE_FIELD),t.get_tagName()){case e._BUTTON_TAG:n.Menu=null;break;case e._FLYOUTANCHOR_TAG:case e._SPLITBUTTON_TAG:t.hasChildNodes()?n.Menu=this.parseMenuFromXML(t.childNodes().get_item(0)):n.Menu=null;break;default:n=null}return n},e._MENU_TAG="Menu",e._MENUSECTION_TAG="MenuSection",e._CONTROL_TAG="Controls",e._BUTTON_TAG="Button",e._FLYOUTANCHOR_TAG="FlyoutAnchor",e._SPLITBUTTON_TAG="SplitButton",e._COMMAND_FIELD="Command",e._LABELTEXT_FIELD="LabelText",e._ID_FIELD="Id",e._MODERNIMAGE_FIELD="ModernImage",e._TITLE_FIELD="Title",e._ALT_FIELD="Alt",e}();
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function x(e,t,n,o,i,u,l,c,b,g){return{type:"runCommand",execute:function(E,T){var w=E.dispatch,A=E.getState,F=[];F.push({name:v.b.CommandingParameters.CommandType,value:n}),F.push({name:v.b.CommandingParameters.CommandId,value:o}),F.push({name:v.b.CommandingParameters.ControlId,value:i}),F.push({name:v.b.CommandingParameters.CommandManagerId,value:l});var M=null,x=-1,O=!1,S=T.TraceManager.getTracer("Commanding"),j="commandId: "+o+", commandType: "+n+", controlId: "+i+", commandManagerId: "+l+", pageId: "+u+", entityName: "+M+", selectedItems: "+x+".";try{if(M=t&&t.EntityLogicalName?t.EntityLogicalName:null,x=t&&t.SelectedItems?t.SelectedItems.length:-1,F.push({name:v.b.CommandingParameters.PageId,value:u}),u||S.warn("Can't detect PageId for "+j),F.push({name:v.b.CommandingParameters.ExecuteWarningEntityName,value:M}),M||b||S.warn("Can't detect EntityName for "+j),F.push({name:v.b.CommandingParameters.SelectedItemsCount,value:x}),x>=0||b||S.warn("Can't calculate selectedItemsCount for "+j),S.debug("Executing "+j),T.EventManager.ReportEvent(new h(n,o,i,l,u,M,x)),e&&e.Commands&&!b){var D=e.Commands,R=D[n]?D[n][o]:null;if(!R&&D[s.c]&&(R=D[s.c][o]),R){var U=R.Actions,G=U.filter((function(e){return 1===e.ActionType}));S.debug("Found "+G.length+" Url Actions."),F.push({name:v.b.CommandingParameters.UrlActionCount,value:G.length}),G.forEach((function(e){var n=e.Attributes;S.debug("Opening Url: "+n.Address+" for url action.");var r=(new a.a).evaluateParameters(e.Parameters,e.ActionType,t,u,i,A(),T,c,l);(new m).openUrl(n,r,A(),t)}));var X=U.filter((function(e){return 3===e.ActionType}));S.debug("Found "+X.length+" Javascript Actions."),F.push({name:v.b.CommandingParameters.JavascriptActionCount,value:X.length});var B=/^\$webresource:/i,W=X.map((function(e){var t=e.Attributes;if(t.Library&&-1!==t.Library.search(B))return S.debug("Found JavaScript action: "+t.FunctionName+" on library: "+t.Library+"."),t.Library;throw S.error("JavaScript Action Library: "+t.Library+" is not a web resource and is not supported."),F.push({name:"IsCustomizationError",value:"true"}),F.push({name:"ScriptActionFunctionName",value:t.FunctionName}),F.push({name:"ScriptActionLibraryName",value:t.Library}),O=!0,new Error("Invalid JavaScript Action Library: "+t.Library+" is not a web resource and is not supported.")}));F.push({name:v.b.CommandingParameters.LibraryCount,value:W.length}),S.debug("Getting dependent web resources for "+W.length+" libraries."),W=Object(d.e)(A(),W),S.debug("Total "+W.length+" libraries found including dependent web resources.");for(var k=0;k<W.length;++k){var J=W[k];W[k]=W[k].replace(B,""),S.debug("Resolved library: "+J+" to url: "+W[k]+".")}var z=w(Object(p.f)(W)),V=Object(I.c)(T,w,l,u);S.debug("Loading libraries "+W.join(",")+" for pageId: "+u+".");var Z=V.then((function(e){return e.loadWebResourcesForAllContexts(W,t.WebResourcePath,3,(function(e){return w(Object(y.a)(e))}),!t.IsServerAvailable).then((function(){S.debug("Finished loading "+W.length+" libraries for pageId: "+u+".")}))}));return N.a.addKeyPerformanceIndicatorOnIdle("Commanding.Actions.ExecuteCommand",Object(L.c)(F)),Promise.all([z,Z,V]).then((function(e){var m=e[2];X.forEach((function(e){var p=e.Attributes;S.debug("Beginning execution of action: "+p.FunctionName+" of library: "+p.Library+".");var b=e.Parameters;S.debug("Evaluating "+b.length+" parameters of action: "+p.FunctionName+" of library: "+p.Library+"."),F.push({name:"ScriptActionFunctionName",value:p.FunctionName}),F.push({name:"ScriptActionLibraryName",value:p.Library});var g=new a.a,h=[];g.evaluateParameters(b,e.ActionType,t,u,i,A(),T,c,l).forEach((function(e){return h.push(e.value)})),S.debug("Executing action: "+p.FunctionName+" of library: "+p.Library+".");try{var I=Object(d.j)(A(),p.Library),y={sourceName:"ribbon.command"};y.eventParameters=[{name:v.b.CommandingParameters.ControlId,value:i},{name:v.b.WebResourceParameterNames.FunctionName,value:p.FunctionName},{name:v.b.WebResourceParameterNames.WebResourceName,value:null==I?void 0:I.name},{name:v.b.WebResourceParameterNames.SolutionName,value:null==I?void 0:I.solutionName},{name:v.b.WebResourceParameterNames.PublisherName,value:null==I?void 0:I.publisherName}],Object(r.b)(y,(function(){m.execute(p.FunctionName,h,!1,{webResourceName:I&&I.name,solutionName:I&&I.solutionName,solutionVersion:I&&I.solutionVersion,publisherName:I&&I.publisherName,type:"CommandExecution"}),F.push({name:"ScriptActionSolutionName",value:null==I?void 0:I.solutionName}),F.push({name:"ScriptActionPublisherName",value:null==I?void 0:I.publisherName})}))}catch(e){F.push({name:"IsCustomizationError",value:"true"}),S.error("Failed to execute action: "+p.FunctionName+" of library: "+p.Library+" for commandId: "+o+", commandType: "+n+", controlId: "+i+", commandManagerId: "+l+", pageId: "+u+", entityName: "+M+", selectedItems: "+x+" with error: "+e.Message+".",F);var E=new f.a("",null,null,null,null,e);throw w(Object(_.a)(u,E)),e}var N=b.findIndex((function(e){return 17===e.ParameterType}));if(N>=0){S.debug("Found xml injection parameter for action: "+p.FunctionName+" of library: "+p.Library+" at index: "+N+".");var L=h[N];S.debug("Injecting xml for action: "+p.FunctionName+" of library: "+p.Library+".");var O=L.PopulationXML;Promise.resolve(O).then((function(e){S.debug("Processing injected xml for action: "+p.FunctionName+" of library: "+p.Library+".");var t=null;if("string"==typeof e)try{t=new P(e).getParsedXml()}catch(t){throw S.error("Unable to parse injected xml: "+e+" for action: "+p.FunctionName+" of library: "+p.Library+"."),F.push({name:"IsCustomizationError",value:"true"}),t}else t=e;t?Object(s.v)(A,w,t,M,C.l).then((function(t){S.info("Storing injected xml: "+e+" for action: "+p.FunctionName+" of library: "+p.Library+"."),w(function(e,t,n){var r={injectedXML:n};return{type:s.p,payload:r,meta:{commandManagerId:e,flyoutControlId:t}}}(l,i,t))})):S.warn("Storing injected xml skipped as menu was invalid for action: "+p.FunctionName+" of library: "+p.Library+".")}))}})),S.debug("Finished executing "+j),T.EventManager.ReportComponentSuccess("Commanding.Actions.ExecuteCommand",F)}))}throw new Error("Invalid RibbonCommandDefinition")}if(!b||!g)throw new Error("Invalid RibbonDescriptor or RibbonDescriptor.Commands or injected command");F.push({name:"IsInjectedCommand",value:"true"}),g.type&&g.execute?w(g):g()}catch(e){if(S.error("Command execution failed for "+j),O){var H=new f.a("",null,null,null,null,e);w(Object(_.a)(u,H)),T.EventManager.ReportComponentSuccess("Commanding.Actions.ExecuteCommand",F)}else T.EventManager.ReportComponentFailure("Commanding.Actions.ExecuteCommand",e,"Check error details to know why execution failed.",F);throw e}}}}}}]),window.bundleExecutionMarkers["scripts/es5/4.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();