(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/legacydialogpage.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[73],{"0XQA":function(e,t,n){"use strict";n.r(t),n.d(t,"LegacyDialog",(function(){return f}));var o=n("v/3l");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var i=n("c/eZ"),r=n("nuS9"),s=n("YWpA"),a=n("4E+q"),l=n("aHX0"),d=n("RYq1"),c=n("sOTk");var p=n("9rQ4"),u=n("akzq"),m=n("90WD"),g=function(e){function t(t){var n=e.call(this,t)||this;return n._postMessageHandler=n._postMessageHandler.bind(n),n._onloadHandler=n._onloadHandler.bind(n),n._keyDownHandler=n._keyDownHandler.bind(n),window.addEventListener("message",n._postMessageHandler),n}return Object(i.__extends)(t,e),t.prototype._postMessageHandler=function(e){if(e.data){var t=null;(t="string"==typeof e.data?JSON.parse(e.data):e.data).command===m.c||t.message===m.c?this.props.closeDialog("close"):t.command!==m.b&&t.message!==m.b||(window.parent&&t.params&&(window.parent.LegacyDialogReturnValue=t.params),this.props.closeDialog(m.b))}},t.prototype._onloadHandler=function(e){if(this._iframe){var t=this._iframe.contentWindow.document||this._iframe.contentDocument,n=void 0;if(t)this._iframe.contentWindow.isUciLegacyDialog="true",t.querySelector(".ms-crm-RefreshDialog-Header")&&(n=t.querySelector(".ms-crm-RefreshDialog-Header-Title")),n&&n.focus(),t.body.addEventListener("keydown",this._keyDownHandler);var o=window.document.getElementById(m.f);o&&n&&t.getElementById(n.id)&&o.setAttribute("title",t.getElementById(n.id).innerText)}},t.prototype._keyDownHandler=function(e){e.keyCode!==p.a.LeftArrow&&e.keyCode!==p.a.UpArrow&&e.keyCode!==p.a.RightArrow&&e.keyCode!==p.a.DownArrow&&(e.keyCode===p.a.Escape&&(e.stopImmediatePropagation(),this.props.closeDialog("close")),this._firstFocusableElement&&this._lastFocusableElement||this._getFirstAndLastElement(),e.target===this._firstFocusableElement&&e.keyCode===p.a.Tab&&e.shiftKey?(e.stopPropagation(),e.preventDefault(),this._lastFocusableElement&&this._lastFocusableElement.focus()):e.target!==this._lastFocusableElement||e.keyCode!==p.a.Tab||e.shiftKey||(e.stopPropagation(),e.preventDefault(),this._firstFocusableElement.focus()))},t.prototype._getFirstAndLastElement=function(){var e=null;this._iframe&&(e=this._iframe.contentDocument||this._iframe.contentWindow.document),this._firstFocusableElement=this._getFirstFocusableElement(e),this._lastFocusableElement=this._getLastFocusableElement(e)},t.prototype._getFirstFocusableElement=function(e){var t;return e&&(t=e.querySelector(".ms-crm-RefreshDialog-FirstTopButton")),e&&!t&&(t=e.getElementById(m.g)),e&&!t&&(t=e.querySelector(".ms-crm-RefreshDialog-Header-Title")),t},t.prototype._getLastFocusableElement=function(e){var t;if(e&&(t=e.getElementById("cmdDialogClear")),e&&!t)if(e.getElementById(m.a)&&"none"!==e.getElementById(m.a).style.display)t=e.getElementById(m.a);else{for(var n=void 0,o=e.querySelectorAll("#tdDialogFooter"),i=0;i<o.length;i++)"none"!==o[i].parentElement.style.display&&(n=o[i]);if(n&&n.lastElementChild){var r=n.lastElementChild.id;t=n.parentElement.querySelector("#"+r)}}return e&&e.getElementById("btnRemoveValue")&&(t=e.getElementById("btnRemoveValue")),t},t.prototype.componentDidMount=function(){this.props.dialogArguments&&(window.InlineDialog_childDialogArguments=this.props.dialogArguments),window.parent?window.parent.IsUCI=!0:window.IsUCI=!0,this._iframe=document.getElementById(m.f),this._iframe.addEventListener("load",this._onloadHandler)},t.prototype.componentWillUnmount=function(){if(window.removeEventListener("message",this._postMessageHandler),this._iframe.removeEventListener("load",this._onloadHandler),window.parent?window.parent.IsUCI=void 0:window.IsUCI=void 0,this._iframe){var e=this._iframe.contentWindow&&this._iframe.contentWindow.document||this._iframe.contentDocument;e&&e.body.removeEventListener("keydown",this._keyDownHandler)}},t.prototype.render=function(){var e=[];return e.push(r.createElement(u.a,{key:"legacyDialogAccessibility",rootElementId:m.e,isModal:!1,shouldManageFocus:!0,defaultFocusId:m.e,overrideFocusId:m.e})),e.push(r.createElement(l.a,{src:this.props.url,id:m.f,style:{width:"100%",height:"100%"}})),r.createElement(s.a,{style:{height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},r.createElement(s.a,{key:"Inline_legacyDialog",role:"dialog",id:m.e,style:{width:this.props.dialogOptions.width,height:this.props.dialogOptions.height,maxHeight:"95%",maxWidth:"95%",borderWidth:"1px",borderColor:"transparent",borderStyle:"solid"}},e))},t}(r.Component);var h=Object(a.a)((function(){return function(e,t){var n=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){return Object(c.g)(e,t.id).dialogOptions}(e,t);return{url:function(e,t){return Object(c.g)(e,t.id).url}(e,t),dialogOptions:n,dialogArguments:function(e,t){return Object(c.g)(e,t.id).dialogArguments}(e,t)}}}),(function(e,t){return{closeDialog:function(n){e(Object(d.e)(t.id,n))}}}))(g);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var f=function(){function e(e){this._id=e}return e.prototype.getName=function(){return o.a},e.prototype.getId=function(){return this._id},e.prototype.getInitializationAction=function(){return this._id,{type:"legacydialog.initialize.async",execute:function(e,t){return e.dispatch,e.getState,Promise.resolve()}}},e.prototype.getRootReducer=function(){return function(e){return e}},e.prototype.getRootComponent=function(){return h},e.prototype.getCloseAction=function(e){return{type:"close.legacyDialogAction.async",execute:function(e){e.dispatch,e.getState;var t=window;if(t&&t.LegacyDialogReturnValue){var n=t.LegacyDialogReturnValue;return t.LegacyDialogReturnValue=void 0,Promise.resolve(n)}return Promise.resolve()}}},e}()},aHX0:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var o,i=n("CGM5"),r=n("HMYz"),s=n("iDZS"),a=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=function(e){function t(t){var n=e.call(this,t)||this;return n._iframeElement=null,n._origin=null,n._onLoad=n._onLoad.bind(n),n._origin=n._normalizeUrl(t.src),n}return a(t,e),t.prototype._normalizeUrl=function(e){var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host},t.prototype._onLoad=function(){this.props.onLoad&&this.props.onLoad(),this.props.onReadyStateComplete&&this.props.onReadyStateComplete()},t.prototype.getElementName=function(){return"iframe"},t.prototype.getElementProps=function(){var e={src:this.props.src,title:this.props.title,onLoad:this._onLoad};return this.props.security&&(e.security=this.props.security,e.sandbox=""),this.props.scrolling&&(e.scrolling=this.props.scrolling),this.props.allow&&(e.allow=this.props.allow),this.props.name&&(e.name=this.props.name),e.ref=this._registerIframeElement.bind(this),e},t.prototype.componentWillReceiveProps=function(){this._resetEventHandlers()},t.prototype._resetEventHandlers=function(){window.removeEventListener("message",this._receiveMessageHandler,!1),this._receiveMessageHandler=null,this.props.registerSendMessageHandler&&this.props.registerSendMessageHandler(void 0)},t.prototype._registerIframeElement=function(e){this._iframeElement=e,this._iframeElement?(this._receiveMessageHandler=this._receiveMessage.bind(this),window.addEventListener("message",this._receiveMessageHandler,!1),this.props.registerSendMessageHandler&&this.props.registerSendMessageHandler(this._sendMessage.bind(this))):this._resetEventHandlers()},t.prototype.componentWillUnmount=function(){this._resetEventHandlers()},t.prototype._receiveMessage=function(e){this._iframeElement&&e.source===this._iframeElement.contentWindow&&this._normalizeUrl(e.origin)===this._origin&&this.props.onMessage&&this.props.onMessage(e)},t.prototype._sendMessage=function(e){this._iframeElement&&this._iframeElement.contentWindow.postMessage(e,this._origin)},t.displayName="IFrame",t}(i.a),d=r.connect(s.a)(l)}}]),window.bundleExecutionMarkers["scripts/es5/legacydialogpage.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();