(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/initializeOfflineUpsyncProcessAsyncAction.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[70],{"96h0":function(e,n,t){"use strict";t.r(n),t.d(n,"OFFLINE_UPSYNC_HANDLE_ACTION",(function(){return U})),t.d(n,"initializeOfflineUpsyncProcessAsyncAction",(function(){return P}));var r=t("c/eZ"),c=t("H9DM"),s=t("GUnN"),a=t("Ww2r"),o=t("kh6f"),i=t("evh6"),u=t("MLbG"),l=t("+D0h"),f=t("mGpW"),p=t("Vm/X"),_=t("KjDZ"),d=t("WS0f");var y=t("hzb9"),b=t("pkDq"),O=t("rcZN"),v=t("ygXU"),g=t("iJR5"),j=t("VnuK"),m=t("qC0c"),w=t("cZkS"),S=t("US37"),h=t("ZaNp"),U="offline.upsync.process.async",E=null;function P(e){return void 0===e&&(e=!1),{type:U,execute:function(n,t){var c=n.dispatch,s=n.getState;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(O.b)(s()),e||n!==v.a.Completed?null==E?[3,2]:[4,E]:[2,Promise.resolve()];case 1:return r.sent(),[3,6];case 2:return r.trys.push([2,4,5,6]),[4,E=F(s,c,t)];case 3:return r.sent(),[3,6];case 4:throw(a=r.sent())instanceof g.a||(o=(null==a?void 0:a.message)||"Unexpected upsync error",a=g.a.FromMessage(o)),a;case 5:return E=null,[7];case 6:return[2]}}))}))}}}function T(e,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,c,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(m.c)(e(),w.l)&&Object(h.e)(e())?(t=["offline_notification_reconnect_success_text"],[4,n(Object(f.e)(t))]):[3,2];case 1:r.sent(),c=Object(a.b)(e(),t[0]),s={id:"upsync_complete_toast",level:1,message:c,title:null,type:1,onCloseHandler:null},n(Object(S.b)(!1)),n(Object(j.b)(s)),r.label=2;case 2:return[2]}}))}))}function F(e,n,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var O,v,g,j,m;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:O=new Date,v="Offline: Upsync",r.label=1;case 1:return r.trys.push([1,11,,12]),[4,t.OfflineProvider.hasItemsToUpsync().nativePromise()];case 2:if(!r.sent())return[3,9];o.c.info("OFFLINE : OfflineUpsyncHandler : Has Items To Upsync"),n(Object(y.b)()),r.label=3;case 3:return r.trys.push([3,8,,9]),[4,t.OfflineProvider.startPlayback().nativePromise()];case 4:return g=r.sent(),n(Object(b.b)()),Object(d.a)(g)||0!==g.get_errorCount()?[3,6]:[4,T(e,n)];case 5:return r.sent(),o.c.info("OFFLINE : OfflineUpsyncHandler : Upsync done without conflict"),[3,7];case 6:o.c.warn("OFFLINE : OfflineUpsyncHandler : Upsync done with conflict"),n((w=String(g.get_lastSuccessfulSaveOnCrm()),{type:"offline.syncerror.dialog.async",execute:function(e,n){var t=e.dispatch,r=e.getState,c=["L_Show_Details_Text","Sync_Status_Error_Message","L_Last_Save_To_CRM_Server_Text","Sync_Status_Dialog_Title","Dialog_Button_Ok"];return t(Object(f.e)(c)).then((function(){var e=Object(a.e)(r(),c),n=Object(a.c)(e,"L_Show_Details_Text"),f=Object(a.c)(e,"Sync_Status_Error_Message"),y=Object(a.c)(e,"L_Last_Save_To_CRM_Server_Text"),b=Object(a.c)(e,"Sync_Status_Dialog_Title"),O=Object(a.c)(e,"Dialog_Button_Ok"),v=f+"\n"+y,g="";return g=Object(d.b)(_.a.get_OverallSyncErrorMessage())?v.replace("{0}",w):_.a.get_OverallSyncErrorMessage(),t(Object(u.a)(p.c,g,{},n,b,"",O)).then((function(e){return 0===e.status?t(Object(l.a)(e.pageId)).then((function(n){n.value.confirmed&&t(Object(i.a)("syncerror",e.pageId,null,null,null,null,null))})):(o.c.error("Offline: Error in Sync error dialog creation "+Object(s.e)(e.error)),Promise.reject(e.error))}))})).catch((function(e){return o.c.error("Offline: Error in Sync error dialog creation "+Object(s.e)(e)),Promise.reject(e)}))}})),r.label=7;case 7:return t.EventManager.ReportComponentSuccess(v),t.EventManager.ReportComponentPerformance(v,"Time Taken in ms",+new Date-+O),[2];case 8:return j=r.sent(),o.c.error("OFFLINE : OfflineUpsyncHandler : Upsync Error"),n(Object(c.b)()),t.EventManager.ReportComponentFailure(v,j),t.EventManager.ReportComponentPerformance(v,"Time Taken in ms",+new Date-+O),[2,Promise.reject(j)];case 9:return o.c.info("OFFLINE : OfflineUpsyncHandler : Upsync has no items to sync"),n(Object(b.b)()),[4,T(e,n)];case 10:return r.sent(),[3,12];case 11:return m=r.sent(),o.c.error("OFFLINE : OfflineUpsyncHandler : hasItemsToUpsync Handler Failed"),[2,Promise.reject(m)];case 12:return[2]}var w}))}))}},H9DM:function(e,n,t){"use strict";t.d(n,"a",(function(){return c})),t.d(n,"b",(function(){return s}));var r=t("ygXU"),c="offline.upsync.pending";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function s(){var e={upSyncStatus:r.a.Pending};return{type:c,payload:e}}},hzb9:function(e,n,t){"use strict";t.d(n,"a",(function(){return c})),t.d(n,"b",(function(){return s}));var r=t("ygXU"),c="offline.upsync.start";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function s(){var e={upSyncStatus:r.a.InProgress};return{type:c,payload:e}}},pkDq:function(e,n,t){"use strict";t.d(n,"a",(function(){return c})),t.d(n,"b",(function(){return s}));var r=t("ygXU"),c="offline.upsync.completed";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function s(){var e={upSyncStatus:r.a.Completed};return{type:c,payload:e}}}}]),window.bundleExecutionMarkers["scripts/es5/initializeOfflineUpsyncProcessAsyncAction.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();