(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/querypage.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[100],{"b/Dj":function(e,t,o){"use strict";o.r(t),o.d(t,"Query",(function(){return re}));var i=o("c/eZ"),r=o("4E+q"),n=o("nuS9"),s=o("YWpA"),a=o("Wg6j"),l=o("2Sll"),c=o("42hY"),d=o("igP1"),u=o("YO7l"),y=o("PMTb"),p=o("smWO"),h=o("yZTI"),m=function(){function e(){}return e.prototype.getCommandButtons=function(e){return[this._createRunQueryButton(e),this._createSwitchToClassicButton(e)]},e.prototype._createRunQueryButton=function(e){return{Icon:"Play",DisplayText:e().ribbonLabels.runQuery,Tooltip:{title:e().ribbonLabels.runQuery},Id:"RunQuery",execute:{type:"query.runquery",execute:function(t){t.dispatch;return e().runQuery()}}}},e.prototype._createSwitchToClassicButton=function(e){return{Icon:"OpenPane",DisplayText:e().ribbonLabels.switchToClassic,Tooltip:{title:e().ribbonLabels.switchToClassic},Id:"SwitchToClassic",execute:{type:"query.switchtoclassic",execute:function(t){t.dispatch;return e().switchToClassic()}}}},e}(),w=o("UA/f"),b=o("6Cai"),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={query:void 0},t}return Object(i.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.state.query,o=this.props.options.filter((function(e){return!t||e.text.toLowerCase().indexOf(t.toLowerCase())>=0}));return n.createElement(w.a,Object(i.__assign)({},this.props,{options:o,onRenderList:function(o,i){return n.createElement(n.Fragment,null,n.createElement(b.a,{value:t,underlined:!0,onChange:function(t,o){return e.setState({query:o})}}),i(o))}}))},t}(n.Component),C=o("6Tlt"),v=o("XIN1"),_=o("r2h9"),f=o("9r0m"),S=o("0OS1"),M=o("jf1O"),I=o("uO/V"),x=o("5olG");function B(e){return Object(x.c)()*parseFloat(e)}var T=o("pWlk"),O=o("sOTk"),V=o("wV3W"),j=o("7EJx"),E=o("9S+1"),L=o("RlP9"),k=o("aPRd"),R=o("4pqm"),z=o("olrR"),D=o("evh6"),A=o("lMVv");Object(l.a)();var Q,N,q,P,W,F,H,G,U,J,Y,Z,X,K,$=function(e){function t(t){var o,i=e.call(this,t)||this;for(var r in i._queryCommands=new m,i._entityDropdownList=[],i._onRenderOption=function(e){return n.createElement(s.a,null,e.data&&e.data.icon&&n.createElement(c.a,{style:i.props.queryStyles.viewStyle.dropdownIconStyle,iconName:e.data.icon,"aria-hidden":"true",title:i.props.localizedLabels.addNewView}),n.createElement(y.a,null,e.text))},i._onChangeEntitySelection=i._onChangeEntitySelection.bind(i),i._onChangeViewSelection=i._onChangeViewSelection.bind(i),i._onRunQuery=i._onRunQuery.bind(i),i._onSwitchToClassic=i._onSwitchToClassic.bind(i),i._collectSelectedViewDetails=i._collectSelectedViewDetails.bind(i),i._onRenderOption=i._onRenderOption.bind(i),t.entities){var a,l=(a=t.entities[r]).DisplayName;l&&i._entityDropdownList.push({key:r,text:l,data:{entityId:a.Id,entityTypeName:r,entityTypeCode:a.ObjectTypeCode}})}i._entityDropdownList.length&&(i._entityDropdownList.sort((function(e,t){return e.key.localeCompare(t.key)})),(a=i._entityDropdownList[0]).selected=!0,o=a.key,i.props.fetchViews(o));return i.state={selectedEntityName:o,selectedViewId:i._entityDropdownList.length?"add_new_view":void 0},i}return Object(i.__extends)(t,e),t.prototype.render=function(){var e=this.props.queryStyles.viewStyle,t=this._generateViewDropdownOptions(),o=t.options,i=t.shouldDisable;return n.createElement(s.a,{key:"queryRoot",id:"QueryView",testhooks:{id:"QueryView"},style:e.viewStyle},this._renderPageHeaderButtons(),n.createElement(s.a,{key:"queryPageContents",style:e.viewContentsStyle},n.createElement(g,{label:this.props.localizedLabels.entity,options:this._entityDropdownList,onChange:this._onChangeEntitySelection,styles:e.dropdownStyle}),n.createElement(g,{label:this.props.localizedLabels.view,selectedKey:this.state.selectedViewId,disabled:i,options:o,onChange:this._onChangeViewSelection,styles:e.dropdownStyle,onRenderOption:this._onRenderOption}),n.createElement(d.a,{text:this.props.localizedLabels.runQuery,styles:e.buttonStyle,onClick:this._onRunQuery,disabled:!this.state.selectedEntityName||!this.state.selectedViewId})))},t.prototype._renderPageHeaderButtons=function(){var e=[this._renderCommandBar(),this._renderSelectorRow()],t=this._isMobileStyle()?this.props.queryStyles.viewStyle.headerContainerMobileStyle:this.props.queryStyles.viewStyle.headerContainerStyle;return n.createElement(s.a,{key:"headerButtonsWrapper"},n.createElement(s.a,{key:"headerButtons",style:t},e))},t.prototype._renderCommandBar=function(){this._initializeCommandBar();var e=this.props.queryStyles.commandBarStyles,t=this._isMobileStyle()?e.commandBarMobileStyle:e.commandBarStyle,o=this._isMobileStyle()?e.commandBarWrapperMobileStyle:e.commandBarWrapperStyle;return Object(a.b)(this.props.commandBarRefreshProps,t,!1),n.createElement(s.a,{id:"Query:null",key:"Query:null",style:o},n.createElement(C.a,{commandbarDisplayMode:a.a.IconLabel,key:"QueryCommandBar",addedCommandList:this._addedCommandList,iconPosition:v.a.Left,id:this.props.id,ribbonId:null,commandManagerId:this.props.id,commandBarStyle:t,customCommandManagerStyle:e.customCommandManagerStyle,isDashboardCommandBar:!0}))},t.prototype._renderSelectorRow=function(){var e=this.props.queryStyles.headerStyle,t=this._isMobileStyle()?e.headerInnerMobileStyle:e.headerInnerStyle;return n.createElement(s.a,{key:"selectorRow",style:e.headerStyle},n.createElement(s.a,{key:"selectorRow",style:t},n.createElement(y.a,{style:this.props.queryStyles.viewSelectorStyle.textStyle},"Query")))},t.prototype._initializeCommandBar=function(){var e,t=this;this._addedCommandList=[];var o=this._queryCommands.getCommandButtons((function(){return{ribbonLabels:t.props.ribbonLabels,runQuery:t._onRunQuery,switchToClassic:t._onSwitchToClassic}}));(e=this._addedCommandList).push.apply(e,o)},t.prototype._onChangeEntitySelection=function(e,t,o){this.props.viewSelectors&&this.props.viewSelectors[t.key]||this.props.fetchViews(t.key),this.setState({selectedEntityName:t.key,selectedViewId:"add_new_view"})},t.prototype._onChangeViewSelection=function(e,t,o){this.setState({selectedViewId:t.key})},t.prototype._onRunQuery=function(){var e=this._collectSelectedViewDetails();if(e)return this.props.runQuery(this.state.selectedEntityName,e);console.error("No view selected!")},t.prototype._onSwitchToClassic=function(){var e=this,t=this._collectSelectedViewDetails();if(t){var o=this._entityDropdownList.find((function(t){return t.key===e.state.selectedEntityName}));return this.props.openClassicAdvancedFind(o.data,t,this.props.viewPortWidth,this.props.viewPortHeight,this.props.crmBaseUrl)}console.error("No view selected!")},t.prototype._generateViewDropdownOptions=function(){var e=this.state.selectedEntityName;if(!this.state||!e)return{options:[],shouldDisable:!0};var t=this.props.viewSelectors&&this.props.viewSelectors[e];if(!t||!("MAIN_APPLICATION_VIEW"in t)||!("ADVANCED_SEARCH"in t))return{options:[{key:"loading_views",text:this.props.localizedLabels.loadingViews}],shouldDisable:!0};var o=[];o.push({key:"add_new_view",text:this.props.localizedLabels.addNewView,data:{icon:"Add"}});var i=t&&t[_.a[_.a.MAIN_APPLICATION_VIEW]],r=this._getViewDropdownOptions(i),n=r.myViews,s=r.systemViews;return n.length&&(o.push({key:"divider_1",text:"-",itemType:u.a.Divider}),o.push({key:"my_views",text:this.props.localizedLabels.myViews,itemType:u.a.Header}),o.push.apply(o,n)),s.length&&(o.push({key:"divider_1",text:"-",itemType:u.a.Divider}),o.push({key:"system_views",text:this.props.localizedLabels.systemViews,itemType:u.a.Header}),o.push.apply(o,s)),{options:o,shouldDisable:!1}},t.prototype._getViewDropdownOptions=function(e){var t=[],o=[];for(var i in e){var r=e[i],n=r.name;n&&(r.isUserView?t.push({key:i,text:n}):o.push({key:i,text:n}))}return{myViews:t,systemViews:o}},t.prototype._collectSelectedViewDetails=function(){if(this.state.selectedViewId){var e=this.state.selectedEntityName,t=this.props.viewSelectors&&this.props.viewSelectors[e],o=t&&t[_.a[_.a.MAIN_APPLICATION_VIEW]];if("add_new_view"===this.state.selectedViewId){var i=this.props.defaultViewSelectors[e].ADVANCED_SEARCH;return{viewId:i,viewType:1039,isAdvancedFindView:!!i}}var r=o[this.state.selectedViewId];return{viewId:new f.a(this.state.selectedViewId),viewType:r.queryType,isAdvancedFindView:!1}}},t.prototype._isMobileStyle=function(){return!1},t}(n.Component),ee=Object(r.a)((K=null,H=function(e,t,o){if(!K){var r=Object(a.p)(t,null);r.container.marginLeft="0px",r.container.marginRight="0px",r.container.width="100%",r.container.backgroundColor=e.colors.MainThemeColor.MainColor1.Fill,r.listItemBody.text.color=S.a.colors.MainThemeColor.MainColor1.Text,r.listItemBody.icon.color=S.a.colors.MainThemeColor.MainColor1.Text,r.listItemBody.icon.fontSize="16px",r.listItemBody.iconWrapperStyles.color=S.a.colors.MainThemeColor.MainColor1.Text,r.moreIcon.color=S.a.colors.MainThemeColor.MainColor1.Text,r.splitbuttonicon.color=S.a.colors.MainThemeColor.MainColor1.Text;var n={":hover":{backgroundColor:e.colors.MainThemeColor.MainColor3.Fill}},s={"[aria-expanded=true]":{backgroundColor:e.colors.MainThemeColor.MainColor3.Fill},"[data-expanded=true]":{backgroundColor:e.colors.MainThemeColor.MainColor3.Fill}};r.listItem=Object(i.__assign)(Object(i.__assign)({},r.listItem),s),r.splitbuttonOverflowButton=Object(i.__assign)(Object(i.__assign)({},r.splitbuttonOverflowButton),s),r.listItemBody.button=Object(i.__assign)(Object(i.__assign)({},r.listItemBody.button),n),r.overflowFlyoutMoreButton=Object(i.__assign)(Object(i.__assign)({},r.overflowFlyoutMoreButton),n),r.listItemBody.splitButtonChevronIconWrapper.borderLeftColor=t?void 0:e.colors.MainThemeColor.MainColor1.Text,r.listItemBody.splitButtonChevronIconWrapper.borderRightColor=t?e.colors.MainThemeColor.MainColor1.Text:void 0;var l=Object(a.p)(t,null);l.container.marginLeft="0px",l.container.marginRight="0px",l.container.width="100%",l.container.backgroundColor=e.colors.BaseColor.White,l.listItemBody.text.color=S.a.colors.BaseColor.Grey.Grey7,l.listItemBody.icon.color=S.a.colors.BaseColor.Grey.Grey7,l.listItemBody.icon.fontSize="16px",l.listItemBody.iconWrapperStyles.color=S.a.colors.BaseColor.Grey.Grey7,l.moreIcon.color=S.a.colors.BaseColor.Grey.Grey7,l.splitbuttonicon.color=S.a.colors.BaseColor.Grey.Grey7,l.container.height=B(e.sizes.Measures.Measure200),l.listItemBody.button=Object(i.__assign)(Object(i.__assign)({},r.listItemBody.button),{":hover":{backgroundColor:S.a.colors.BaseColor.White}}),l.list.marginTop="0rem",l.list.marginBottom="0rem",l.listItem.height="100%",l.listItem.display="flex",l.listItem.alignItems="center",l.listItemBody.button.width="16px",l.moreIcon.marginRight="0rem",l.moreIcon.marginLeft="0rem",l.container.borderStyle="none",l.list.marginLeft="0rem",l.list.marginRight="0rem",l.listItem.marginLeft=0,l.container.height=B(e.sizes.Measures.Measure200);var c={minHeight:e.sizes.Measures.Measure300,backgroundColor:e.colors.MainThemeColor.MainColor1.Fill,display:"flex"};if(o){var d=Object(a.m)(null),u=d.border.width+" "+d.border.style+" "+d.colors.border+" !important",y=B(c.minHeight)+parseInt(d.border.width,10)+"px";Object.assign(c,{backgroundColor:d.colors.background,borderBottom:u,minHeight:y,maxHeight:y,boxSizing:"border-box"})}var p={minHeight:e.sizes.Measures.Measure200,display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:t?e.sizes.Measures.Measure150:e.sizes.Measures.Measure100,paddingRight:t?e.sizes.Measures.Measure100:e.sizes.Measures.Measure150,paddingBottom:e.sizes.Measures.Measure100,paddingTop:e.sizes.Measures.Measure100};K={commandBarStyle:r,commandBarMobileStyle:l,customCommandManagerStyle:{width:"100%"},commandBarWrapperStyle:c,commandBarWrapperMobileStyle:p}}return K},X=null,G=function(e,t){if(!X){var o={errorStyle:{display:"flex",flexDirection:"column",flex:"0 0 auto",backgroundColor:e.colors.BaseColor.Grey.Grey1,width:"100%",height:"100%"},viewStyle:{display:"flex",flexDirection:"column",backgroundColor:e.colors.BaseColor.White,width:"100%",height:"100%"},viewContentsStyle:{display:"flex",flexDirection:"column",width:"100%",height:"100%",marginLeft:t?e.sizes.Measures.Measure150:e.sizes.Measures.Measure100,marginRight:t?e.sizes.Measures.Measure100:e.sizes.Measures.Measure150},headerContainerStyle:{display:"flex",flex:"1 0 auto",flexDirection:"column",justifyContent:"space-between"},headerContainerMobileStyle:{display:"flex",flex:"1 0 auto",backgroundColor:e.colors.BaseColor.White,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},dropdownStyle:{root:{width:"80%",maxWidth:"250px",paddingLeft:t?e.sizes.Measures.Measure150:e.sizes.Measures.Measure100,paddingRight:t?e.sizes.Measures.Measure100:e.sizes.Measures.Measure150,paddingBottom:e.sizes.Measures.Measure100},caretDown:{color:"black"}},dropdownIconStyle:{marginRight:"8px",color:"rgb(0, 120, 212)"},buttonStyle:{root:{backgroundColor:e.colors.MainThemeColor.MainColor1.Fill,color:S.a.colors.MainThemeColor.MainColor1.Text,marginLeft:t?e.sizes.Measures.Measure150:e.sizes.Measures.Measure100,marginRight:t?e.sizes.Measures.Measure100:e.sizes.Measures.Measure150,marginTop:e.sizes.Measures.Measure150,maxWidth:"150px"}}};X=o}return X},U=Object(T.a)(),Z=Object(M.a)(),J=function(e,t){var o=Z(e,{contextString:I.h.GRID});return{headerStyle:o.headerStyle,headerInnerStyle:o.headerInnerStyle,headerInnerMobileStyle:o.headerInnerMobileStyle}},Y=Object(a.s)(),function(e,t){var o=Object(O.g)(e,t.id),i={runQuery:"Run query",switchToClassic:"Switch to classic"},r={runQuery:"Run query",entity:"Entities",view:"Views",loadingViews:"Loading views...",addNewView:"Add new view",systemViews:"System views",myViews:"My views"};q&&q.runQuery===i.runQuery&&q.switchToClassic===i.switchToClassic||(q=i),P&&P.runQuery===r.runQuery&&P.entity===r.entity&&P.view===r.view&&P.loadingViews===r.loadingViews||(P=r);var n=Object(V.a)(e),s=Object(j.g)(e);Q=H(n,s,Object(E.a)(e)),N=G(n,s),W=U(e,I.h.GRID),F=J(e,t);var a=Y(e);return{queryInput:o,queryStyles:{commandBarStyles:Q,headerStyle:F,viewStyle:N,viewSelectorStyle:W},ribbonLabels:q,localizedLabels:P,entities:Object(A.g)(e),viewSelectors:Object(L.h)(e),defaultViewSelectors:Object(L.b)(e),commandBarRefreshProps:a,viewPortWidth:Object(k.c)(e),viewPortHeight:Object(k.b)(e),crmBaseUrl:new R.a(Object(h.a)(e))}}),(function(e,t){return{fetchViews:function(t){e(Object(z.b)(t,_.a.MAIN_APPLICATION_VIEW)),e(Object(z.b)(t,_.a.ADVANCED_SEARCH))},runQuery:function(o,i){return e(Object(D.a)(o,t.id,void 0,void 0,void 0,void 0,void 0,void 0,i.viewType,void 0,{isQueryMode:!0,isAdvancedFindView:i.isAdvancedFindView}))},openClassicAdvancedFind:function(e,t,o,i,r){var n=o<=1e3?1:(o-1e3)/2,s=i<=1e3?1:(i-700)/2,a=r.searchParams,l=encodeURI("?&EntityCode="+e.entityTypeCode+"&QueryId={"+t.viewId.guid+"}&"+p.Z+"=1039");return a.set(p.v,l),a.set(p.H,"AdvancedFind"),window.open(r.href,"_blank","width=1000, height=700, left="+n+", top="+s+", resizable=1, align-item=center, justify-content=center").IsHybridAF=!0,Promise.resolve()}}}))($);ee.displayName="QueryRoot";var te=o("XNwl");function oe(e,t){t(Object(te.c)(e,"Query"))}var ie=o("45T4"),re=function(){function e(e){var t;this._id=e,this._initializeAction=(t=this._id,{type:"initialize.queryAction.async",execute:function(e,o){var i=e.dispatch;return e.getState,Promise.all([void 0,oe(t,i)])}})}return e.prototype.getName=function(){return ie.a},e.prototype.getId=function(){return this._id},e.prototype.getInitializationAction=function(){return this._initializeAction},e.prototype.getRootReducer=function(){return function(e){return e}},e.prototype.getRootComponent=function(){return ee},e.prototype.getCloseAction=function(e){},e}();
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */}}]),window.bundleExecutionMarkers["scripts/es5/querypage.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();