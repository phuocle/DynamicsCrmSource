(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/modelformcomponent.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[82,30],{"+6eZ":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(e){var t=null;try{t=JSON.parse(e)}catch(e){}return t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e){var t="";try{t=JSON.stringify(e)}catch(e){}return t}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}))},"+P1Q":function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r("c/eZ"),i=r("gk6Q"),a=r("YCDx"),o=r("QAhb"),s=r("n1Ju"),c=function(e,t,r,n){this.eventName="BusinessRuleRecommendation_"+e,this.eventParameters=[{name:"EntityTypeName",value:t},{name:"FieldName",value:r},{name:"Title",value:n}]},l=r("IiPO"),u=r("+Z9T"),d=r("HSdq"),p=r("F2uj"),h=r("c7nC"),g=r("9r0m"),m=r("H9Ho"),f=r("kvLG");var b,y=r("ezfI"),v=function(e){function t(t,r,n,i,a,o){var s=e.call(this,t,r,n,i,a,o)||this;return s._entityAttribute=null,b=t,s.registerObserversForControlStateChange(),s}return Object(n.__extends)(t,e),t.prototype.getAttribute=function(){var e="ClientApi.XrmDataControl.getAttribute";try{if(y.a.instance.reportCall(e),!this._entityAttribute){var t=void 0;if(this.formContext&&this.formContext.data&&this.formContext.data.entity&&(t=this.controlDescriptor&&this.controlDescriptor.Relationship?this.formContext.data.entity.relatedEntities.get(this.controlDescriptor.Relationship):this.formContext.data.entity),this.controlDescriptor&&this.controlDescriptor.DataFieldName&&this.formContext&&this.formContext.data)if(this.controlDescriptor.IsUnbound)this._entityAttribute=this.formContext.data.attributes.get(this.controlDescriptor.DataFieldName);else{var r=t?t.attributes:this.formContext.data.attributes;this._entityAttribute=r.get(this.controlDescriptor.DataFieldName)}}return y.a.instance.reportSuccess(e),this._entityAttribute}catch(t){var n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.updateAttribute=function(e,t){var r="ClientApi.XrmDataControl.updateAttribute";try{if(y.a.instance.reportCall(r),e&&t&&this.controlDescriptor&&this.controlDescriptor.Relationship===t){this._entityAttribute=null;var n=e.attributes;n&&(this._entityAttribute=n.get(this.controlDescriptor.DataFieldName))}this._entityAttribute&&this._entityAttribute.controls.add(this.name,this),y.a.instance.reportSuccess(r)}catch(e){var i=l.a.getInstance().getEventParameters(this.contextToken);throw i.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(r,e,null,i),e}},t.prototype.addNotification=function(e){var t="ClientApi.XrmDataControl.addNotification";try{if(y.a.instance.reportCall(t),this._isValidNotification(e)&&this.getVisible()){var r={uniqueId:e.uniqueId?e.uniqueId:"",messages:e.messages,notificationLevel:e.notificationLevel,actions:e.actions};return"RECOMMENDATION"===e.notificationLevel?this._reportAddNotificationEvent(e):b.dispatch(Object(h.b)(this.pageId,this.getName(),!1,this.contextToken)),b.dispatch(Object(s.b)(this.pageId,this.getName(),r,this.contextToken)),y.a.instance.reportSuccess(t),!0}return y.a.instance.reportSuccess(t),!1}catch(e){var n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype._clearControlNotification=function(e){var t=this,r=Object(d.A)(b.getState(),{controlName:this.name,id:this.pageId},this.contextToken);if(r){var n=Object.keys(r),i=null;if(e){if(!((i=r[e])&&i.messages&&i.notificationLevel))return!1;this._clearNotification(i)}else(Object(u.a)(e)||0===e.trim().length)&&n.forEach((function(e){i=r[e],t._clearNotification(i)}));return!0}return!1},t.prototype._clearNotification=function(e){e.actions=null,e.messages=null,e.notificationLevel=null,b.dispatch(Object(s.b)(this.pageId,this.name,e,this.contextToken))},t.prototype.clearNotification=function(e){var t="ClientApi.XrmDataControl.clearNotification";try{y.a.instance.reportCall(t);var r=!!this._clearControlNotification(e);return y.a.instance.reportSuccess(t),r}catch(e){var n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype.setNotification=function(e,t){var r="ClientApi.XrmDataControl.setNotification";try{y.a.instance.reportCall(r);var n={uniqueId:t,messages:[e],priority:0,notificationLevel:"ERROR",actions:[{actions:[function(){}],message:""}]};return y.a.instance.reportSuccess(r),this.addNotification(n)}catch(e){var i=l.a.getInstance().getEventParameters(this.contextToken);throw i.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(r,e,null,i),e}},t.prototype._isValidNotification=function(e){return!(!e||!e.messages||Object(m.b)(e.messages[0]))&&("RECOMMENDATION"===e.notificationLevel||"ERROR"===e.notificationLevel)},t.prototype._reportAddNotificationEvent=function(e){if(this._isValidNotification(e)){var t,r=e.messages[0],n=new c("Added",this.contextToken.entityTypeName,this.getName(),r);b.dispatch((t=n,{type:"report.xrm.event",execute:function(e,r){try{l.a.getInstance().reportEvent(t)}catch(e){var n="ClientApi.ReportXrmEventAction.reportXrmEvent";f.a.getInstance().eventManager.ReportComponentFailure(n,e),Object(u.j)(n,"XrmReporting")}return Promise.resolve()}}))}},t.prototype.getEntityReference=function(){var e=this.formContext.entityReference,t=e.id?new g.a(e.id):null;return new o.a(e.entityType,t)},t.prototype.registerObserversForControlStateChange=function(){if(this.getName().startsWith("header_process")){var e=Object(i.a)(this.pageId);e&&this.controlStateObservable.registerObserver(e)}},t.prototype.getAttrDescriptor=function(e,t,r){var n=this.getEntityReference().etn,i=Object(d.r)(b.getState(),n,this.name,this.pageId,this.contextToken);return i||(this.controlDescriptor?this.controlDescriptor.DataFieldName?(f.a.getInstance().traceManager.getTracer(e).warn("ControlAttributeDescriptor was not found, falling back to the attribute descriptor.",t),(i=Object(p.a)(b.getState(),n,this.controlDescriptor.DataFieldName))||(t.push({name:"attributeName",value:this.controlDescriptor.DataFieldName}),t.push({name:"entityName",value:n}),r.reportFailure(e,new Error("Attribute descriptor was not found"),t))):r.reportFailure(e,new Error("Control descriptor did not have a DataFieldName"),t):r.reportFailure(e,new Error("Control descriptor was not found"),t)),i},t}(a.a);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},"+ulc":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="form.ShowHeaderFieldsInFlyout.set";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r){var a=Object(n.v)(t);return{type:i,payload:{headerFieldsInFlyout:r},meta:{pageId:e,contextKey:a}}}},"/0Gr":function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return l}));var n=r("gBKR"),i=r("lMVv"),a=r("uO/V"),o=r("F7qm"),s=r("F2uj");function c(e){return{type:"grid.retrieveRelatedEntityMetadata.async",execute:function(t,r){var a=t.dispatch,o=t.getState;try{var s=Object(i.h)(o(),e),c={};return u(c,e),Object.keys(s.ManyToManyRelationships).forEach((function(t){var r=s.ManyToManyRelationships[t];if(r.IsValidForAdvancedFind){var n=r.Entity1LogicalName;n===e&&(n=r.Entity2LogicalName),u(c,n)}})),Object.keys(s.OneToManyRelationships).forEach((function(e){var t=s.OneToManyRelationships[e];t.IsValidForAdvancedFind&&u(c,t.ReferencingEntity,t.ReferencingAttribute)})),Object.keys(s.ManyToOneRelationships).forEach((function(e){var t=s.ManyToOneRelationships[e];t.IsValidForAdvancedFind&&(u(c,t.ReferencedEntity),u(c,t.ReferencingEntity,t.ReferencingAttribute))})),a(Object(n.e)(c)).catch((function(t){return h(e,r,t,"retrieveRelatedEntityMetadata.async","retrieveRelatedEntityMetadata")}))}catch(t){return h(e,r,t,"retrieveRelatedEntityMetadata.async","retrieveRelatedEntityMetadata")}}}}function l(e){return{type:"grid.retrieveRelatedEntityRelationshipMetadata.async",execute:function(t,r){var n=t.getState;try{var a,c=n(),l=Object(i.h)(c,e),u=[];return Object.keys(l.OneToManyRelationships).forEach((function(e){var t,r,n=l.OneToManyRelationships[e];if(n.IsValidForAdvancedFind){var a=n.ReferencingEntity,h=Object(i.h)(c,a),g=Object(s.a)(c,a,n.ReferencingAttribute);if(h){var m=d(h,1===n.AssociatedMenuConfiguration.Behavior?null!==(t=n.AssociatedMenuConfiguration.Label)&&void 0!==t?t:"":null!==(r=null==g?void 0:g.DisplayName)&&void 0!==r?r:h.DisplayCollectionName),f=p(n,h.DisplayCollectionName,o.RelationshipType.OneToMany);u.push([m,f])}}})),Object.keys(l.ManyToManyRelationships).forEach((function(e){var t,r,n=l.ManyToManyRelationships[e];if(n.IsValidForAdvancedFind){var a=!0,s=n.Entity1LogicalName,p=void 0,h=void 0,g=!0;if(s===l.EntityLogicalName?(s=n.Entity2LogicalName,n.IsCustomRelationship&&(a=2!==n.Entity2AssociatedMenuConfiguration.Behavior),h=n.Entity2AssociatedMenuConfiguration.Behavior,p=null!==(t=n.Entity2AssociatedMenuConfiguration.Label)&&void 0!==t?t:"",g=!1):(n.IsCustomRelationship&&(a=2!==n.Entity1AssociatedMenuConfiguration.Behavior),h=n.Entity1AssociatedMenuConfiguration.Behavior,p=null!==(r=n.Entity1AssociatedMenuConfiguration.Label)&&void 0!==r?r:""),a)if(b=Object(i.h)(c,s)){var m=d(b,1===h?p:b.DisplayCollectionName),f=void 0;f=g?{displayName:b.DisplayCollectionName,referencedFieldName:l.PrimaryIdAttribute,referencingFieldName:b.PrimaryIdAttribute,relationshipType:o.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:n.IntersectEntityName,entityIntersectIdAttribute:n.Entity2IntersectAttribute,relatedEntityIntersectIdAttribute:n.Entity1IntersectAttribute}:{displayName:b.DisplayCollectionName,referencedFieldName:l.PrimaryIdAttribute,referencingFieldName:b.PrimaryIdAttribute,relationshipType:o.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:n.IntersectEntityName,entityIntersectIdAttribute:n.Entity1IntersectAttribute,relatedEntityIntersectIdAttribute:n.Entity2IntersectAttribute},u.push([m,f])}if(n.Entity1LogicalName===n.Entity2LogicalName){var b=Object(i.h)(c,n.Entity2LogicalName);if(2!==n.Entity1AssociatedMenuConfiguration.Behavior){m=d(b,1===n.Entity1AssociatedMenuConfiguration.Behavior?n.Entity1AssociatedMenuConfiguration.Label:b.DisplayCollectionName),f={displayName:b.DisplayCollectionName,referencedFieldName:l.PrimaryIdAttribute,referencingFieldName:b.PrimaryIdAttribute,relationshipType:o.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:n.IntersectEntityName,entityIntersectIdAttribute:n.Entity2IntersectAttribute,relatedEntityIntersectIdAttribute:n.Entity1IntersectAttribute};u.push([m,f])}}}})),Object.keys(l.ManyToOneRelationships).forEach((function(e){var t,r,n=l.ManyToOneRelationships[e];if(n.IsValidForAdvancedFind){var a=n.ReferencedEntity,h=n.ReferencingAttribute,g=Object(i.h)(c,a),m=Object(s.a)(c,l.EntityLogicalName,h);if(g){var f=p(n,1===n.AssociatedMenuConfiguration.Behavior?null!==(t=n.AssociatedMenuConfiguration.Label)&&void 0!==t?t:"":null!==(r=null==m?void 0:m.DisplayName)&&void 0!==r?r:g.DisplayCollectionName,o.RelationshipType.ManyToOne);u.push([d(g,g.DisplayCollectionName),f])}}})),a=u.sort((function(e,t){var r,n,i,a;if(!(null===(r=e[1])||void 0===r?void 0:r.displayName)||!(null===(n=t[1])||void 0===n?void 0:n.displayName))return 0;var o=e[1].displayName.localeCompare(t[1].displayName);return 0===o?(null===(i=e[0])||void 0===i?void 0:i.displayName)&&(null===(a=t[0])||void 0===a?void 0:a.displayName)?e[0].displayName.localeCompare(t[0].displayName):0:o})),Promise.resolve(a)}catch(t){return h(e,r,t,"retrieveRelatedEntityRelationshipMetadata.async","retrieveRelationshipMetadata")}}}}function u(e,t,r){e[t]||(e[t]=[]),r&&-1===e[t].indexOf(r)&&e[t].push(r)}function d(e,t){var r;return{metadataId:null===(r=e.Id)||void 0===r?void 0:r.guid,displayName:t,primaryIdField:e.PrimaryIdAttribute,primaryNameField:e.PrimaryNameAttribute,name:e.EntityLogicalName}}function p(e,t,r){return{displayName:t,referencingFieldName:e.ReferencingAttribute,isHierarchical:e.IsHierarchical,relationshipType:r,referencedFieldName:e.ReferencedAttribute}}function h(e,t,r,n,i){var o=[{name:a.k,value:e}];return t.EventManager.ReportComponentFailure(Object(a.G)(n,i),r,null,o),Promise.resolve(null)}},"/CqC":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="form.relationship.clear";function i(e,t){return{type:n,payload:{relationship:t},meta:{pageId:e}}}},"/U1C":function(e,t,r){"use strict";r.d(t,"f",(function(){return i})),r.d(t,"g",(function(){return a})),r.d(t,"h",(function(){return o})),r.d(t,"i",(function(){return s})),r.d(t,"a",(function(){return c})),r.d(t,"e",(function(){return l})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return d})),r.d(t,"b",(function(){return p}));var n=r("c/eZ"),i={advancedFilters:"Grid_AdvancedFilter_AdvancedFilters",cancel:"GlobalFilter_Cancel",apply:"Button_Label_Apply",addButton:"Web.SFA.Workflow.Variables.Add",addRow:"MenuItem_Label_AddRow_SentenceCase",addGroup:"MenuItem_Label_AddGroup_SentenceCase",deleteExpression:"Web.SFA.Workflow.Variables.Delete",moveUpExpression:"Web._controls.listedit.buttons.MoveUp",moveDownExpression:"Web._controls.listedit.buttons.MoveDown_SentenceCas",makeGroup:"Grid_AdvancedFilter_MakeGroup",ungroup:"AF_MenuItem_UnGroup",andGroup:"AF_Text_And",orGroup:"AF_Text_Or_SentenceCase",addRelatedEntity:"MenuItem_Label_AddRelatedEntity_SentenceCase",relatedEntityPlaceholder:"Grid_AdvancedFilter_RelatedEntityPlaceholder",fieldPlaceholder:"Audit.Incontext.Filters.AttributesGroup",containsData:"Web._tools.search.search.js_12_8_SentenceCase",doesNotContainData:"Web._tools.search.search.js_12_9_SentenceCase",doesNotContainDataWarning:"Grid_AdvancedFilter_DoesNotContainDataWarning",manyToOne:"Grid_AdvancedFilter_ManyToOne",oneToMany:"Grid_AdvancedFilter_OneToMany",manyToMany:"Grid_AdvancedFilter_ManyToMany",noRelationships:"Grid_AdvancedFilter_NoRelationships",moreCommandsAriaLabel:"AF_Aria_MoreCommands",rowSelectorAriaLabel:"AF_Aria_RowSelector",groupSelectorAriaLabel:"AF_Aria_GroupSelector",groupExpandAriaLabel:"AF_MenuItem_Expand",groupCollapseAriaLabel:"AF_MenuItem_Collapse",groupExpandAriaDescription:"AF_Aria_GroupExpand",groupCollapseAriaDescription:"AF_Aria_GroupCollapse",errorQuickFind:"AF_Error_QuickFindView",errorMalformed:"Grid_AdvancedFilter_ErrorMalformed",invalidField:"Grid_AdvancedFilter_InvalidField",fieldSelectorControlLabel:"Grid_AdvancedFilter_FieldSelector",operatorSelectorControlLabel:"Web.SFA.Workflow.AssignValueDialog.Operator",errorFailedToLoad:"Grid_AdvancedFilter_FailedToLoad",fetchXmlConditionWarning:"Grid_AdvancedFilter_FetchXmlConditionWarning"},a=Object.values(i),o={contains:"SystemCustomization.BusinessRules.ConditionOperator.CONTAINS",doesNotContain:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTCONTAIN",beginsWith:"SystemCustomization.BusinessRules.ConditionOperator.BEGINSWITH",doesNotBeginWith:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTBEGINWITH",endsWith:"SystemCustomization.BusinessRules.ConditionOperator.ENDSWITH",doesNotEndWith:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTENDWITH",containsData:"SystemCustomization.BusinessRules.ConditionOperator.NOTNULL",doesNotContainData:"SystemCustomization.BusinessRules.ConditionOperator.ISNULL",equals:"CustomControl_Grid_Filtering_ConditionOperator_Equals",doesNotEqual:"CustomControl_Grid_Filtering_ConditionOperator_DoesNotEqual",greaterThan:"CustomControl_Grid_Filtering_ConditionOperator_Greater",greaterThanOrEqualTo:"CustomControl_Grid_Filtering_ConditionOperator_GreaterOrEqual",lessThan:"CustomControl_Grid_Filtering_ConditionOperator_Less",lessThanOrEqualTo:"CustomControl_Grid_Filtering_ConditionOperator_LessOrEqual",dateQuarter:"ViewDesigner.RecordFilter.quarter",dateFiscalYear:"FiscalYear_Format_String_NoSpace",on:"Web._tools.search.search.js_16_0",onOrAfter:"CustomControl_Grid_Filtering_ConditionOperator_OnOrAfter",onOrBefore:"ViewDesigner.RecordFilter.on_or_before",yesterday:"Web._tools.search.search.js_16_3",today:"Web._tools.search.search.js_16_4",tomorrow:"Web._tools.search.search.js_16_5",nextSevenDays:"Web._tools.search.search.js_16_6",lastSevenDays:"Web._tools.search.search.js_16_7_SentenceCase",nextWeek:"Web._tools.search.search.js_16_8_SentenceCase",lastWeek:"Web._tools.search.search.js_16_9_SentenceCase",thisWeek:"Web._tools.search.search.js_16_10_SentenceCase",nextMonth:"Web._tools.search.search.js_16_11_SentenceCase",lastMonth:"Web._tools.search.search.js_16_12_SentenceCase",thisMonth:"Web._tools.search.search.js_16_13_SentenceCase",nextYear:"Web._tools.search.search.js_16_14_SentenceCase",lastYear:"Web._tools.search.search.js_16_15_SentenceCase",thisYear:"Web._tools.search.search.js_16_16_SentenceCase",lastXHours:"AF_Option_LastXHours_SentenceCase",nextXHours:"AF_Option_NextXHours_SentenceCase",lastXDays:"AF_Option_LastXDays_SentenceCase",nextXDays:"AF_Option_NextXDays_SentenceCase",lastXWeeks:"AF_Option_LastXWeeks_SentenceCase",nextXWeeks:"AF_Option_NextXWeeks_SentenceCase",lastXMonths:"AF_Option_LastXMonths_SentenceCase",nextXMonths:"AF_Option_NextXMonths_SentenceCase",lastXYears:"AF_Option_LastXYears_SentenceCase",nextXYears:"AF_Option_NextXYears_SentenceCase",anyTime:"Search.Time.Range.Anytime",olderThanXMinutes:"AF_Option_OlderThanXMinutes_SentenceCase",olderThanXHours:"AF_Option_OlderThanXHours_SentenceCase",olderThanXDays:"AF_Option_OlderThanXDays_SentenceCase",olderThanXWeeks:"AF_Option_OlderThanXWeeks_SentenceCase",olderThanXMonths:"AF_Option_OlderThanXMonths_SentenceCase",olderThanXYears:"AF_Option_OlderThanXYears_SentenceCase",inFiscalYear:"AF_Option_InFiscalYear_SentenceCase",lastFiscalYear:"AF_Option_LastFiscalYear_SentenceCase",thisFiscalYear:"AF_Option_ThisFiscalYear_SentenceCase",nextFiscalYear:"AF_Option_NextFiscalYear_SentenceCase",lastXFiscalYears:"AF_Option_LastXFiscalYears_SentenceCase",nextXFiscalYears:"AF_Option_NextXFiscalYears_SentenceCase",inFiscalPeriod:"AF_Option_InFiscalPeriod_SentenceCase",lastFiscalPeriod:"AF_Option_LastFiscalPeriod_SentenceCase",thisFiscalPeriod:"AF_Option_ThisFiscalPeriod_SentenceCase",nextFiscalPeriod:"AF_Option_NextFiscalPeriod_SentenceCase",lastXFiscalPeriods:"AF_Option_LastXFiscalPeriods_SentenceCase",nextXFiscalPeriods:"AF_Option_NextXFiscalPeriods_SentenceCase",inFiscalPeriodAndYear:"AF_Option_InFiscalPeriodAndYear_SentenceCase",inOrAfterFiscalPeriodAndYear:"AF_Option_InOrAfterFiscalPeriod_SentenceCase",inOrBeforeFiscalPeriodAndYear:"AF_Option_InOrBeforeFiscalPeriod_SentenceCase",containValues:"Web._tools.search.search.js_17_4_SentenceCase",doesNotContainValues:"Web._tools.search.search.js_17_5_SentenceCase",equalsCurrentUserLanguage:"AF_Option_EqUserLanguage_SentenceCase",isCurrentUser:"Web._tools.search.search.js_17_0_SentenceCase",notCurrentUser:"Web._tools.search.search.js_17_1_SentenceCase",isCurrentBusinessUnit:"Web._tools.search.search.js_19_1_SentenceCase",notCurrentBusinessUnit:"Web._tools.search.search.js_19_2_SentenceCase",under:"Web.SFA.Workflow.UnderOperator",notUnder:"Web.SFA.Workflow.NotUnderOperator",above:"ViewDesigner.RecordFilter.above",viewAll:"CustomControl_Calendar_ViewMore",aboveOrEqual:"ViewDesigner.RecordFilter.eq_or_above_SentenceCase",underOrEqual:"ViewDesigner.RecordFilter.eq_or_under_SentenceCase",isCurrentUserOrReportingHierarchy:"OwnershipOperator_EqualsCurrentUserOrHierarchy_SentenceCase",isCurrentUserAndTeamsOrReportingHierarchyAndTeams:"OwnershipOperator_EqualsCurrentUserOrHierarchyAndTeams_SentenceCase",isCurrentUserTeams:"OwnershipOperator_EqualsCurrentUserTeams_SentenceCase",isCurrentUserOrTeams:"OwnershipOperator_EqualsCurrentUserOrUserTeams_SentenceCase",loadingResults:"Grid_AdvancedFilter_LoadingResults",noResults:"KMControl.SearchKMArticles.NoResults",errorNoValues:"AF_Error_NoValues",inputControlLabel:"Web.SFA.Workflow.AssignValueDialog.Value",removeButtonAriaLabel:"Dialog_Disassociate_Header",noValue:"Grid_AdvancedFilter_NoValue",minValue:"Grid_AdvancedFilter_MinValue",maxValue:"Grid_AdvancedFilter_MaxValue",maxPrecision:"Grid_AdvancedFilter_MaxPrecision",maxLength:"Grid_AdvancedFilter_MaxLength",incorrectDataType:"Grid_AdvancedFilter_IncorrectDataType",durationUnit:"Grid_AdvancedFilter_durationUnit"},s=Object.values(o),c={dropDownOptionsAll:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsAll",dropDownOptionsDefault:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsDefault",dropDownOptionsCustom:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsCustom",fieldContextMenuRemove:"Grid_AdvancedFilter_ColumnEditor_FieldContextMenuRemove",addColumn:"Grid_AdvancedFilter_ColumnEditor_AddColumn",editColumns:"Grid_AdvancedFilter_ColumnEditor_EditColumns",apply:"Grid_AdvancedFilter_ColumnEditor_Apply",cancel:"Grid_AdvancedFilter_ColumnEditor_Cancel",search:"Grid_AdvancedFilter_ColumnEditor_Search",related:"Grid_AdvancedFilter_ColumnEditor_Related",moveUp:"Grid_AdvancedFilter_ColumnEditor_MoveUp",moveDown:"Grid_AdvancedFilter_ColumnEditor_MoveDown",resetToDefault:"Grid_AdvancedFilter_ColumnEditor_ResetToDefault",close:"Grid_AdvancedFilter_ColumnEditor_Close",listAriaLabel:"Grid_AdvancedFilter_ColumnEditor_AttributesListLabel",columnEditor:"Grid_AdvancedFilter_ColumnEditor_ColumnEditor",saveAsNewView:"Grid_AdvancedFilter_ColumnEditor_SaveAsNewView",saveChangesToCurrentView:"Grid_AdvancedFilter_ColumnEditor_SaveChangesToCurrentView",noFieldsToDisplay:"Grid_AdvancedFilter_ColumnEditor_NoFieldsToDisplay",moreOptions:"Grid_AdvancedFilter_ColumnEditor_MoreOptions",dropdown:"Grid_AdvancedFilter_ColumnEditor_Dropdown"},l=Object.values(c),u={ApplyAdvancedFiltersTitle:"Grid_AdvancedFilter_ApplyAdvancedFiltersTitle",ApplyAdvancedFiltersAria:"Grid_AdvancedFilter_ApplyAdvancedFiltersAriaLabel",CancelEditingFiltersAria:"Grid_AdvancedFilter_CancelEditingAdvancedFiltersAriaLabel",OpenAdvancedFiltersTitleAndAria:"Grid_AdvancedFilter_OpenAdvancedFilterTitleAndAria",resetToDefault:"Grid_AdvancedFilter_ColumnEditor_ResetToDefault"},d=Object.values(u),p=Object(n.__spreadArrays)(a,s,d);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},"/V8d":function(e,t,r){"use strict";r.d(t,"a",(function(){return k})),r.d(t,"e",(function(){return D})),r.d(t,"d",(function(){return L})),r.d(t,"b",(function(){return B})),r.d(t,"c",(function(){return R}));var n=r("c/eZ"),i=r("pOv+"),a=r("9r0m"),o=r("sgPk"),s=r("U0B9"),c=r("2OIc"),l=r("Gemh"),u=r("kl3Z"),d=r("lMVv"),p=r("bH46"),h=r("i8/j"),g=r("PQ2H"),m=r("8xrh"),f=r("WS0f"),b=r("7EJx"),y=r("vt+k"),v=r("QAhb"),_=r("HSdq"),S=r("yHpA"),O=r("hl8w"),C=r("RNNy"),I=r("F2uj"),j=r("uO/V"),P=r("qC0c"),F=r("cZkS"),T=r("jigW"),w=r("i2G7"),E=r("sOTk"),x=r("xkx/"),N=r("r2h9"),A=r("+l2M"),k=["MscrmControls.Grid.ReadOnlyGrid","MscrmControls.Grid.GridControl","MscrmControls.SharepointAssociatedGrid.SharepointControl","MscrmControls.MailApp.MailAppListControl"],M=["Opportunity_ActivityPointers"];function D(e){var t,r=e&&e.control&&e.control.Parameters&&e.control.Parameters.hasOwnProperty(j.r)&&e.control.Parameters[j.r],n=[e.viewId,r,e.recordsPerPage,(t=e,t&&t.controlParameters&&t.controlParameters.ChartDrillDownParameters&&t.controlParameters.ChartDrillDownParameters.length>0)];return e.customQueryStateKeyParts&&n.push.apply(n,e.customQueryStateKeyParts),n.join("")}function R(e,t,r,n,i){var a=B(e,t,r,n,i);return function(t){var r=a(t);return r&&r.getQueryState(r instanceof o.a?void 0:e)}}function B(e,t,r,n,i){var c={};return function(u){var d=new a.a(u.viewId),p=Object(l.qb)(e(),d,t);if(!p)return null;var h=function(e,t,r){var n=t.fetchXML,i=null,a="TeamTemplateId";if(t.entityLogicalName===C.a&&e.controlParameters[a]){var o=e.controlParameters[a];if(n&&n.indexOf(o)<0){var s=r?r.guid:"",c=Object(O.a)(n,o,s);n=c.updatedFetchXml,i=c.filterString}}return{fetchXML:n,filterString:i}}(u,p,n),g=h.fetchXML;if(!g&&p.queryApi)return null;if(Object(T.l)(e())&&u.quickFindViewId){var j=new a.a(u.quickFindViewId),k=a.a.isNullOrEmpty(j)?null:Object(l.qb)(e(),j,t);Object(f.a)(k)||(g=function(e,t){var r=new DOMParser;if(e){for(var n=r.parseFromString(e.fetchXML,"text/xml"),i=r.parseFromString(t.fetchXML,"text/xml"),a=n.getElementsByTagName("filter"),o=0;o<a.length;o++)a[o].attributes&&a[o].attributes.getNamedItem("isquickfindfields")&&i.getElementsByTagName("entity")[0].appendChild(a[o]);return(new XMLSerializer).serializeToString(i)}return t.fetchXML}(k,p))}var D=e(),R=u.entityLogicalName,B=u.getCustomFilter&&u.getCustomFilter(),V=function(e,t,r,n,i){var o=i.controlParameters.RelationshipName;if(o){var s=n,c=null,u=null;if(i.controlParameters.DependentAttributeName)c=(u=i.controlParameters.DependentAttributeName).split(".")[1]||u;if(i.controlParameters.IsDataSetLookup)if(s=null==i.controlParameters.ParentRecordId?a.a.EMPTY:new a.a(i.controlParameters.ParentRecordId),i.controlParameters.DependentAttributeName)c=(u=i.controlParameters.DependentAttributeName).split(".")[1]||u;var d=Object(_.ac)(e,t,i.contextToken),p=new v.a(r,s),h=null,g=!1;Object(I.a)(e,r,c)?h=Object(S.d)(e,d,p,c):i.controlParameters.DependentAttributeType&&(g=i.controlParameters.DependentAttributeType===r&&i.controlParameters.DependentAttributeType!==i.entityLogicalName);var m=h;m&&m.reference?s=m.reference.id:!i.controlParameters.IsDataSetLookup&&null===c||null!==m&&null!==m.reference||!p||null===p.id||g||(s=null);var f=Object(l.kb)(e,t,i.contextToken),b=0,O=y.h.None;return f?(b=1,-1===M.indexOf(o)&&(O=y.h.Related)):(i.controlParameters.ShouldApplyContextFilter&&i.controlParameters.IsDataSetLookup||!i.controlParameters.IsDataSetLookup)&&(b=2),{type:b,rollupType:O,entityReference:p,contextId:s,relationshipName:o}}return null}(D,t,i||r&&r.EntityLogicalName,n,u),z=Object(m.p)(e(),R),G=function(e,t,r,n,i,o,s){var c,u=Object(E.g)(e,o),d=!(!(null==u?void 0:u.pageToEditedViewMapId)||!Object(l.rb)(e,u.pageToEditedViewMapId.guid,s.guid)),p=Object(l.qb)(e,s,o),h=t.hasGrid&&(1===t.gridType||void 0===t.gridType&&a.a.equals(null===(c=t.control)||void 0===c?void 0:c.ClassId,A.E));return Object(x.e)(e)&&(h||Object(x.f)(e))&&!(1===(null==r?void 0:r.type))&&!(2===(null==r?void 0:r.type))&&!(n&&n.linkEntities&&Array.isArray(n.linkEntities)&&n.linkEntities.length>0)&&!i&&!(n&&n.filter&&Array.isArray(n.filter)&&n.filter.length>0)&&!d&&(null==p?void 0:p.queryType)!==N.a.QUICKFIND_SEARCH&&!t.quickFindViewId}(D,u,V,B,z,t,d)?w.a.fromView(d,u.quickFindSearchString):o.a.fromXmlAndSql(g,p.offlineSqlQuery,d,u.quickFindSearchString,R,e);(null==h?void 0:h.filterString)&&n&&G.addExistingContextFilterToKey(a.a.toString(n),h.filterString);var W=Object(l.x)(e(),t,u.contextToken);W&&(G.pageNumber=W);var H=L(e(),t,r,u,p,R);H.length&&G.select.apply(G,H);var U=function(e,t,r,n,i,a){var o=null;if(!Object(P.a)(e,F.ub)||!a.hasGrid||1!==a.gridType)return null;var c=Object(l.j)(n)(e,t,a.contextToken),u=Object(s.b)(e),d=c&&c.CustomControls&&c.CustomControls[u]&&c.CustomControls[u].Parameters;if(!Object(l.vb)(d)&&(o=Object(l.o)(e,r))){var p=[],h=i&&i.grid&&i.grid.rows&&i.grid.rows[0]&&i.grid.rows[0].cells;if(h)for(var g in h)h.hasOwnProperty(g)&&p.push(h[g].name);-1!==p.indexOf(o.lookupAttribute)&&(o.lookupAttribute=null),i&&i.fetchXML&&Object(T.b)(i.fetchXML)&&(o.primaryAttribute=null)}return o}(e(),t,R,d,p,u);U&&(U.lookupAttribute&&G.select(U.lookupAttribute),U.primaryAttribute&&G.addChildCountAttribute(U.primaryAttribute));var q=u.getCustomSorting&&u.getCustomSorting(p,c);if(q)for(var X=0,K=q;X<K.length;X++){var Q=K[X];G.orderBy(Q.name,1===Q.sortDirection)}if(V)switch(V.type){case 1:G.applyRollupContextFilter(V.entityReference,V.rollupType);break;case 2:var Y=Object(l.v)(D,t,u.contextToken);G.applyContextFilter(V.relationshipName,V.contextId,D,Y?Y.relationshipRoleOrdinal:void 0)}if(z&&G.where(z),B&&B.filter)if(Array.isArray(B.filter))for(var Z=0,J=B.filter;Z<J.length;Z++){var $=J[Z];G.where($,$.shouldReplace)}else!function(e){return!!(e&&e.operator&&e.terms)}($=B.filter)?G.where(Object(m.n)(B.filter,null)):G.where($,$.shouldReplace);if(B&&B.linkEntities)for(var ee=0,te=B.linkEntities;ee<te.length;ee++){var re=te[ee];G.addLinkedEntity(re,re.attributes||[])}var ne=u.recordsPerPage;if(ne)G.pageSize=ne;else{var ie=Object(b.h)(e());u.hasChart||Object(f.a)(ie)?G instanceof o.a&&G.setDefaultPageSize():G.pageSize=ie}return G}}function L(e,t,r,o,m,f){var b=Object(n.__spreadArrays)(function(e,t,r,n){if(0!==r.gridType)return[];var i="Grid",a=Object(s.b)(e),o=t&&Object(c.a)(r.control,t,a);o&&(i=Object(l.ab)(e,o.CustomControlId));return Object(u.b)(e,r.control.UniqueId,i,t&&t.Id,null,null,n)||[]}(e,r,o,m.viewId),function(e,t,r,n){if(1!==t.gridType)return[];return Object(u.a)(e,r,n)||[]}(e,o,f,m.viewId),function(e,t,r,n){var i=[],a=Object(d.h)(e,n);a&&(function(e,t,r){var n=Object(s.b)(e),i=t&&Object(c.a)(r.control,t,n);return i&&[i.CustomControlId&&i.Name].some((function(e){return-1!==k.indexOf(e)}))}(e,t,r)||r.hasGrid)&&("activitypointer"===n&&i.push("activitytypecode"),a.PrimaryNameAttribute&&i.push(a.PrimaryNameAttribute),Object(l.vb)(r.controlParameters)||a.PrimaryImageAttribute&&i.push(Object(T.a)(a.PrimaryImageAttribute)));return i}(e,r,o,f),function(e,t,r){var n=[];if(4&t.streamMode){n.push("modifiedon");var i=Object(I.d)(e,r);if(i)for(var a in i){var o=i[a];o.IsSortableEnabled&&"image"!==o.Type&&"multiselectpicklist"!==o.Type&&Object(p.b)(e,r,o.LogicalName,o)&&n.push(o.LogicalName)}}else 2&t.streamMode&&n.push("modifiedon");return n}(e,o,f),function(e,t,r,n){var o=[],s=r.cardFormId;if(s)if("activitypointer"===n)o.push.apply(o,p.a);else{var c=a.a.equals(s,i.a)?Object(h.h)(e,n,Object(g.a)(11)):s,l=Object(h.d)(e,c,t);if(l)for(var u in l){var d=l[u];d.DataFieldName&&o.push(d.DataFieldName)}}return o}(e,t,o,f),o.getCustomColumns?o.getCustomColumns():[]);if(b.length){var y=[],v=[],_=m&&m.grid&&m.grid.rows&&m.grid.rows[0]&&m.grid.rows[0].cells;if(_)for(var S in _)_.hasOwnProperty(S)&&v.push(_[S].name);for(var O in b){var C=b[O];-1===v.indexOf(C)&&-1===y.indexOf(C)&&y.push(C)}return y}return b}},"/W63":function(e,t,r){"use strict";r.d(t,"a",(function(){return T}));var n=r("ar+e"),i=r("VlhU"),a=r("bCrZ"),o=r("Gemh"),s=r("r2h9"),c=r("RlP9"),l=r("sgPk"),u=r("olrR"),d=r("uO/V"),p=r("7pqb"),h=r("s2by"),g=r("19Zc"),m=r("fE8x"),f=r("YrcW"),b=r("JlqV"),y=r("jigW"),v=r("G7N+"),_=r("qC0c"),S=r("cZkS"),O=r("5cS+"),C=r("gBKR"),I=d.x+"."+d.v;function j(e,t,r,n,i,s,u,d,p,m){var f=F(n,u,p),v=Object(c.c)(t,r);if(!v)return Promise.resolve(null);var O=l.a.fromXmlAndSql(v.fetchXML,v.offlineSqlQuery,r).getQueryState(),C=m||Object(o.db)(t,n,u),I=Object(y.c)(i,s),j=!1;Object(b.b)(t)&&Object(y.h)(t,s.relationshipName,!0)&&(j=!0);var T=Object(o.ub)(t,n);if(T||"activitypointer"===n||j){var w=t.user&&t.user.userId,E=Object(_.c)(t,S.Zc),x=Object(h.a)(n,w,s,E,T);return e(x.getFilterOptionsAction()).then((function(r){if(r&&r.length>0){var o=r.filter((function(e){return e.isDefault}));if(o&&o.length>0){var c=x.getFilterExpression(o[0].value);e(Object(g.l)(c,i,s))}}return e(Object(a.d)(O,n,i,s,null,u,C,j,I)).then((function(r){return P(e,r,t,n,i,f,d)}))}))}return e(Object(a.d)(O,n,i,s,null,u,C,void 0,I)).then((function(r){return P(e,r,t,n,i,f,d)}))}function P(e,t,r,n,i,s,c){var l=Object(m.c)(r),u=Object(m.b)(r);return(l||u)&&Object(o.sb)(r,n)&&Object(a.e)(c,e,n,i),c.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid.initializeRelatedGrid",s),c.EventManager.ReportComponentSuccess(I,s),t}function F(e,t,r){return[{name:p.a.CorrelationId,value:r.correlationId},{name:p.a.ContextId,value:r.contextId},{name:p.a.ActionStack,value:r.stack},{name:"entityName",value:e},{name:"relationshipName",value:t}]}function T(e,t,r){var a=[{name:"EntityName",value:r.entityName}];return{type:"form.related.openGrid",execute:function(a,l,d){var h=a.dispatch,g=a.getState,m=g(),b=Object(n.e)(m,{id:e},t.parentContextToken),y=F(r.entityName,r.relationshipName,d);if(h(Object(i.b)(e,t,r)),null!==b&&b.id===r.id&&b.isSelected===r.isSelected&&b.relationshipName===r.relationshipName||h(Object(i.b)(e,t.parentContextToken,r)),h(Object(f.a)(e,r)),r&&!r.url){var P=function(e,t){return[{name:p.a.CorrelationId,value:e.correlationId},{name:p.a.ContextId,value:e.contextId},{name:p.a.ActionStack,value:e.stack},{name:"hasViewId",value:!0},{name:"entityName",value:t}]}(d,r.entityName);if(!Object(o.v)(m,e,t)){h(Object(u.b)(r.entityName,s.a.MAIN_APPLICATION_VIEW));var T=Object(c.a)(m,r.entityName,s.a.SUB_GRID),w=Object(c.c)(m,T),E=Object(_.c)(m,S.Xc),x=!E||function(e,t){var r,n,i;if(!(null===(n=null===(r=null==t?void 0:t.grid)||void 0===r?void 0:r.rows)||void 0===n?void 0:n.length)||!(null===(i=e.metadata)||void 0===i?void 0:i.entities))return!0;var a=t.grid.rows[0].cells;if(!(null==a?void 0:a.length))return!0;for(var o=0;o<a.length;o++)if(a[o].relatedEntityName&&!e.metadata.entities[a[o].relatedEntityName])return!1;return!0}(m,w);return w&&w.initialized===v.a.Initialized&&x?(j(h,m,T,r.entityName,e,t,r.relationshipName,l,d,r.ordinal).catch((function(e){l.EventManager.ReportComponentFailure(I,e,null,y)})),l.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid",P),Promise.resolve(T)):h(Object(u.a)(r.entityName,s.a.SUB_GRID)).then((function(n){var i=Promise.resolve();if(E){var a=Object(O.a)(m,n,e);i=h(Object(C.e)(a))}return i.then((function(){var i=g();return j(h,i,n,r.entityName,e,t,r.relationshipName,l,d,r.ordinal).catch((function(e){l.EventManager.ReportComponentFailure(I,e,null,y)})),l.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid",P),n}))}),(function(e){l.EventManager.ReportComponentFailure(I,e,null,y)}))}}return Promise.resolve(null)},getFailureParameters:function(e,t){return a}}}},"/lKk":function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r("UGbr"),i=r("/j9Z"),a=r("71iK"),o=r("RYq1"),s=r("LFYt"),c=r("Ww2r"),l=r("HfRC"),u=r("yOMg"),d=r("VnuK"),p=r("rIXY"),h=r("Sscr"),g=r("HSdq"),m=r("yHpA"),f=r("zsi3"),b=r("+ieV"),y=r("Srej");function v(e){return{type:"saveAndClose.saveAndCloseFormDialogAction.async",execute:function(t,r,v){var _=t.dispatch,S=(0,t.getState)(),O=Object(h.j)(S,e),C=Object(g.zb)(S,e,O),I=Object(g.ac)(S,e,O);if(!(!Object(m.g)(S,I)&&C&&Object.keys(C).length>0))return _(Object(n.e)(e,2)).then((function(t){var n=Object(g.Ib)(S,e),h=n?"Forms.MainFormDialogRoot.SaveAndClose":"Forms.QuickCreateFormRoot.SaveAndClose";if(t){var m=[{name:"isEntityRefNull",value:!1},{name:"entityTypeName",value:t.etn}];return r.EventManager.ReportComponentSuccess(h,m),(n?Promise.resolve(e):_(Object(s.b)(e,t))).then((function(e){return _(Object(a.a)(t.etn)),function(e,t,r){var n="quickcreate_",i=Object(c.e)(t,[p.g,p.c]),a={actionLabel:Object(c.c)(i,p.g),eventHandler:function(){e(Object(l.a)(r)),e(Object(u.removeToastNotification)(n+r.id.guid))}},o=null,s={id:n+r.id.guid,type:1,level:1,message:Object(c.c)(i,p.c),title:null,action:a,onCloseHandler:o};e(Object(d.b)(s))}(_,S,t),_(Object(o.e)(e,"save")).then((function(){return t}))}))}return r.EventManager.ReportComponentSuccess(h,[{name:"isEntityRefNull",value:!0}]),Promise.reject(new i.a("Record is not created"))}));for(var j in C){var P=C[j].label,F=C[j].errorMessage,T=_(Object(b.b)(P,F));_(Object(b.c)(O,e,T,f.a.error,Object(y.d)(e,j)))}}}}},"/wtJ":function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return d}));var n=r("UOiB"),i=r("Sscr"),a=r("HSdq"),o=r("ObKm"),s=r("yHpA"),c=r("sOTk"),l=r("krRo"),u="attribute.precision";function d(e,t,r,d){return{type:"attribute.precision.update",sync:!0,execute:function(p,h){var g,m=p.dispatch,f=p.getState,b=f();m(function(e,t,r,a){if(t&&t.contextTokenType&&t.contextTokenType===n.a.GridRow)return Object(l.e)(e,t,r,a);var o=Object(i.x)(t);return{type:u,payload:a,meta:{pageId:e,contextKey:o,dataFieldName:r}}}(e,t,r,d)),b=f();var y=null,v=null,_=null,S=null;if(t&&t.contextTokenType&&t.contextTokenType===n.a.GridRow)y=t.entityTypeName?t.entityTypeName:null,v=t.recordId?t.recordId:null,_=Object(i.t)(t),S=Object(i.r)(t);else{var O=Object(c.g)(b,e);y=O&&O.entityTypeName?O.entityTypeName:null,v=O&&O.id?O.id:null,_=null,S=t}var C=Object(a.ac)(b,e,t),I=Object(s.d)(b,C,{etn:y,id:v},r),j=((g={})[r]=I,g);m(Object(o.a)(e,j,!0,!0,y,v?v.guid:null,_,S))}}}},"0MLN":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="form.setLabel";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r){var a=Object(n.v)(t);return{type:i,payload:{label:r},meta:{pageId:e,contextKey:a}}}},"0bF2":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="grid.updatequerykey";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r){var a=Object(n.y)(r),o=Object(n.v)(r);return{type:i,payload:e,meta:{pageId:t,contextKey:a,dataSetContextKey:o}}}},"0hCf":function(e,t,r){"use strict";r.d(t,"a",(function(){return x}));var n,i,a=r("HSdq"),o=r("yZTI"),s=r("Zy0S"),c=r("c/eZ"),l=r("FlW1"),u=r("ll2N"),d=r("s0Zj"),p=r("+Z9T"),h=r("w/nD"),g=r("ksD2"),m=r("A8fJ"),f=r("PLtI"),b=r("IiPO"),y=r("ezfI"),v=r("7ipg"),_=function(e){function t(t,r,i,a,o,s){var c=this;return Object(p.g)(o,"ClientApi.XrmTab.constructor","parent"),Object(p.g)(t,"ClientApi.XrmTab.constructor","store"),c=e.call(this,t,r,a,i)||this,n=t,c._parent=o,c._formContext=s,c._iConnectedTabProps={tabName:c.name,tabId:c._getTabId(),id:c.pageId,showTab:!0},c._clientApiExecutor=new v.b(n,"ClientApi.XrmTab.",r),c}return Object(c.__extends)(t,e),Object.defineProperty(t.prototype,"sections",{get:function(){var e="ClientApi.XrmTab.sections";try{if(y.a.instance.reportCall(e),!this._sections){this._sections=new s.a(e);for(var t=n.getState(),r=Object(a.Gc)(t,this.pageId,this.name,this.contextToken),i=0;i<r.Columns.length;i++)for(var o=Object(a.p)(t,{id:this.pageId,tabName:r.Id,columnIndex:i},this.contextToken),c=null,l=0;l<o.SectionNames.length;l++)c=new u.a(n,this.contextToken,this.pageId,o.SectionNames[l],this,this._formContext),this._sections.add(c.getName(),c)}return y.a.instance.reportSuccess(e),this._sections}catch(t){var d=b.a.getInstance().getEventParameters(this.contextToken);throw d.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(e,t,null,d),t}},enumerable:!1,configurable:!0}),t.prototype.addTabStateChange=function(e){var t="ClientApi.XrmTab.addTabStateChange";Object(p.g)(e,t,"handler");try{y.a.instance.reportCall(t),n.dispatch(Object(h.s)(this.contextToken,this.pageId,this.name,e)),y.a.instance.reportSuccess(t)}catch(e){var r=b.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.removeTabStateChange=function(e){var t="ClientApi.XrmTab.removeTabStateChange";Object(p.g)(e,t,"handler");try{y.a.instance.reportCall(t),n.dispatch(Object(h.N)(this.contextToken,this.pageId,this.name,e)),y.a.instance.reportSuccess(t)}catch(e){var r=b.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getDisplayState=function(){var e="ClientApi.XrmTab.getDisplayState";try{y.a.instance.reportCall(e);var t=Object(a.Dc)(n.getState(),this._getTabId(),this.pageId,this.contextToken)?"collapsed":"expanded";return y.a.instance.reportSuccess(e),t}catch(t){var r=b.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getParent=function(){return y.a.instance.reportUsage("ClientApi.XrmTab.getParent"),this._parent},t.prototype.setDisplayState=function(e){var t="ClientApi.XrmTab.setDisplayState";try{y.a.instance.reportCall(t);var r=!1;switch(e){case"collapsed":r=!0;break;case"expanded":r=!1;break;default:Object(p.h)(t,"TabDisplayState",e)}r||n.dispatch(Object(d.b)(this.pageId,this._getTabId(),this.contextToken)),y.a.instance.reportSuccess(t)}catch(e){var i=b.a.getInstance().getEventParameters(this.contextToken);throw i.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(t,e,null,i),e}},t.prototype.setFocus=function(){try{y.a.instance.reportCall("ClientApi.XrmTab.setFocus"),n.dispatch(Object(d.b)(this.pageId,this._getTabId(),this.contextToken)),y.a.instance.reportSuccess("ClientApi.XrmTab.setFocus")}catch(t){var e=b.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure("ClientApi.XrmTab.setFocus",t,null,e),t}},t.prototype.setVisible=function(e){var t="ClientApi.XrmTab.setVisible";try{y.a.instance.reportCall(t),n.dispatch(Object(g.b)(this.pageId,this._getTabId(),this.contextToken,!0===e)),y.a.instance.reportSuccess(t)}catch(e){var r=b.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getLabel=function(){try{y.a.instance.reportCall("ClientApi.XrmTab.getLabel");var e=Object(a.Hc)(n.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken)||"";return y.a.instance.reportSuccess("ClientApi.XrmTab.getLabel"),e}catch(e){var t=b.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure("ClientApi.XrmTab.getLabel",e,null,t),e}},t.prototype.getVisible=function(){var e="ClientApi.XrmTab.getVisible";try{y.a.instance.reportCall(e);var t=Object(a.Kc)(n.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken);return y.a.instance.reportSuccess(e),t}catch(t){var r=b.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.setLabel=function(e){var t="ClientApi.XrmTab.setLabel";Object(p.g)(e,t,"label");try{y.a.instance.reportCall(t),n.dispatch(Object(f.b)(this.pageId,this.contextToken,this._getTabId(),e)),y.a.instance.reportSuccess(t)}catch(e){var r=b.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype._getTabId=function(){var e=n.getState(),t=Object(a.Gc)(e,this.pageId,this.name,this.contextToken);if(t&&t.Id)return t.Id},t.prototype.setContentType=function(e){var t=this;return this._clientApiExecutor.execute("setContentType",(function(){var r;switch(e){case"default":case"cardSections":r="cardSections";break;case"expandAvailableSpace":case"singleComponent":r="singleComponent";break;default:Object(p.h)("setContentType","TabContentType",e)}n.dispatch(Object(m.b)(t.pageId,t._getTabId(),t.contextToken,r))}),[{name:"tabContentType",value:e,isRequired:!0,expectedDataType:"string"}])},t.prototype.getContentType=function(){var e=this;return this._clientApiExecutor.execute("getContentType",(function(){var t;return null===(t=Object(a.Jc)(n.getState(),e._getTabId(),e._iConnectedTabProps.id,e.contextToken))||void 0===t?void 0:t.contentType}))},t}(l.a),S=r("9r0m"),O=r("tcXs"),C=r("UOiB"),I=r("i8/j"),j=r("sOTk"),P=r("/zIU"),F=r("1z64"),T=r("OTOS"),w=r("uQP8"),E=r("kvLG"),x=function(){function e(e,t,r,n,a,o,s){var c=Object(j.l)(e.getState(),r),l=[{name:"store",value:e,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"pageId",value:r,isRequired:!0,isEventParam:!0},{name:"pageType",value:c,isEventParam:!0},{name:"formContext",value:n,isRequired:!0},{name:"entityName",value:a,isEventParam:!0},{name:"formSelectorType",value:s,isRequired:!0}];this._clientApiExecutor=new F.a(e,"ClientApi.XrmFormUIBase.",r,t,l),this._pageId=r,i=e,this._formContext=n,this._entityName=a,this._contextToken=t,this._formSelectorType=s,this.xrmControlFactory=o}return Object.defineProperty(e.prototype,"controls",{get:function(){var e=this;return this._clientApiExecutor.execute("controls_get",(function(t,r){if(!e._controls){e._controls=new s.a(t);var n=(h=e.pageId,g=e.contextToken,m=e._controls,f=Object(w.b)(i.getState(),h,g),b=Object(T.b)(i.getState(),h),y=S.a.equals(f,b),v=Object(j.l)(i.getState(),h)===P.a.Dialog,_=Object(I.y)(i.getState(),f),O=_&&_.reduce((function(e,t){return e.add(t),e}),new Set),function(e,t){var r=Object(a.s)(i.getState(),{controlName:e,id:h},g),n=Object(a.Rc)(i.getState(),h,r);y&&n&&!v?O&&O.has(r.DataFieldName)&&Object(a.fd)(i.getState(),h,r,g)&&m.add(e,t):m.add(e,t)}),o=e.getFormDescriptor(t,r);if(o){var c={isEventParam:!0,name:"controlName",value:""},l={isEventParam:!0,name:"controlType",value:""};for(var u in r.push(c),r.push(l),o.Controls){var d=o.Controls[u];c.value=u,l.value=d&&d.ClassId?d.ClassId.guid:"";var p=e.xrmControlFactory.createXrmControl(e.contextToken,d,e._formContext,t,r);p&&n(p.getName(),p)}}}var h,g,m,f,b,y,v,_,O;return e._controls}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formSelector",{get:function(){var e=this;return this._clientApiExecutor.execute("formSelector_get",(function(t,r){if(!e._formSelector){var n=e.getFormDescriptor(t,r);n&&(e._formSelector=new e._formSelectorType(i,e._contextToken,n.Id,e._entityName,e._pageId))}return e._formSelector}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tabs",{get:function(){var e=this;return this._clientApiExecutor.execute("tabs_get",(function(t,r){if(!e._tabs){e._tabs=new s.a(t);var n=e.getFormDescriptor(t,r);if(n){var a=n.Tabs;for(var o in a){var c=new _(i,e._contextToken,a[o].Name,e._pageId,e,e._formContext);e._tabs.add(c.getName(),c)}}}return e._tabs}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageId",{get:function(){return this._pageId},enumerable:!1,configurable:!0}),e.prototype.refreshRibbon=function(e){var t=this;void 0===e&&(e=!1),this._clientApiExecutor.executeAsync("refreshRibbon",(function(){return i.dispatch(Object(O.a)(t._pageId,null,e))}))},Object.defineProperty(e.prototype,"contextToken",{get:function(){return this._contextToken},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formContext",{get:function(){var e=this;return this._clientApiExecutor.execute("formContext",(function(){return e._formContext}))},enumerable:!1,configurable:!0}),e.prototype.getControls=function(){if(!this._controls&&this.contextToken.contextTokenType===C.a.GridRow){var e=this._clientApiExecutor.getComponentName("getControls");return this._controls=new s.a(e),this._controls}return this.controls},e.prototype.getFormDescriptor=function(e,t){var r=Object(a.fb)(i.getState(),{id:this._pageId},this._contextToken);if(!r){var n="Form descriptor not found";if(Object(o.n)(i.getState(),this._pageId))E.a.getInstance().traceManager.getTracer(e).error(n+": Page is dead",t);else if(this.contextToken.contextTokenType===C.a.GridRow)E.a.getInstance().traceManager.getTracer(e).error(n,t);else{if(!this._clientApiExecutor.isPageReadyForClientAPIAccess())return null;var s=new Error(n);this._clientApiExecutor.reportFailure(e,s,t)}}return r},e}()},"0rak":function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return o})),r.d(t,"c",(function(){return s}));var n=r("Sscr"),i=r("uO/V"),a="chart.drilldownparameters.update",o="ChartDrillDownParameters";function s(e,t,r){return{type:"chart.drilldownparameters.update.async",execute:function(s,c){var l=s.dispatch,u=s.getState,d=c.TraceManager.getTracer(i.z),p=i.x+".updateChartDrillDownParametersAction";try{d.info("Updating the chart drilldown parameters"),t||(t=Object(n.k)(u(),e));var h=Object(n.v)(t);return l(function(e,t,r){return{type:a,payload:{name:o,value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,h,r)),c.EventManager.ReportComponentSuccess(p),Promise.resolve()}catch(e){var g="Updatation of the chart drilldown parameters failed with error : "+e.message;c.EventManager.ReportComponentFailure(p,Error(g))}}}}},"0z0R":function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r("GUnN"),i=r("Ww2r"),a=r("JlqV"),o=r("kh6f"),s=r("mGpW"),c=r("Vm/X"),l=r("MLbG");function u(e,t){return{type:"offline.alert.dialog.async",execute:function(r,u){var d=r.dispatch,p=r.getState;if(Object(a.b)(p()))return o.c.info("Offline: Server is available"),Promise.resolve();var h=["Dialog_Button_Ok",e];return d(Object(s.e)(h)).then((function(){var r=Object(i.b)(p(),"Dialog_Button_Ok"),a=Object(i.b)(p(),e);return d(Object(l.a)(c.a,a,null,r,null,void 0,void 0,void 0,void 0,void 0,t)).then((function(e){return 0===e.status?(o.c.info("Offline: Alert dialog is created successfully with message "+a),Promise.resolve()):(o.c.error("Offline: Error in Sync error dialog creation "+Object(n.e)(e.error)),Promise.reject(e.error))}))})).catch((function(e){return o.c.error("Offline: Error in alert dialog creation "+Object(n.e)(e)),Promise.reject(e)}))}}}},"19Zc":function(e,t,r){"use strict";r.d(t,"e",(function(){return o})),r.d(t,"b",(function(){return s})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return l})),r.d(t,"d",(function(){return u})),r.d(t,"c",(function(){return p})),r.d(t,"a",(function(){return d})),r.d(t,"l",(function(){return m})),r.d(t,"i",(function(){return f})),r.d(t,"m",(function(){return b})),r.d(t,"n",(function(){return y})),r.d(t,"k",(function(){return v})),r.d(t,"h",(function(){return _})),r.d(t,"o",(function(){return g})),r.d(t,"j",(function(){return S}));var n=r("Sscr"),i=r("uO/V"),a=r("WS0f"),o="grid.applyFilter",s="grid.applyActivityTypeFilter",c="grid.applyJumpBarFilter",l="grid.applyQuickFindFilter",u="grid.applyFilterCurrentValue",d="grid.applyActivityTypeFilterCurrentValue",p="grid.applyAdvancedFindFilter";function h(e,t,r,a){return{type:"grid.applyFilter.async",execute:function(o,s){var c=o.dispatch,l=s.TraceManager.getTracer(i.z),u=i.x+".applyGridFilterAction",d=Object(n.v)(a),p=[];p.push({name:i.n,value:e}),p.push({name:i.e,value:d});try{return l.info("Applying the filter expression to the grid. "),c(function(e,t,r,n){return{type:e,payload:t,meta:{pageId:r,dataSetContextKey:n}}}(e,t,r,d)),s.EventManager.ReportComponentSuccess(u,p),Promise.resolve()}catch(e){s.EventManager.ReportComponentFailure(u,Error("Applying the filter expression to the grid failed "),"",p)}}}}function g(e,t,r){var i=Object(n.v)(r);return{type:c,payload:e,meta:{pageId:t,dataSetContextKey:i}}}var m=function(e,t,r){return h(o,e,t,r)},f=function(e,t,r){return h(s,e,t,r)},b=function(e,t,r){return h(c,e,t,r)},y=function(e,t,r){return h(l,Object(a.a)(e)?e:e.trim(),t,r)},v=function(e,t,r){return h(u,e,t,r)},_=function(e,t,r){return h(d,e,t,r)},S=function(e,t,r){return h(p,e,t,r)}},"1Dls":function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r("Sscr"),i=r("bICk"),a=r("sjzJ"),o=function(){function e(e){Object.assign(this,e)}return e.prototype.executeNotifyHandlersThatEventOccurred=function(e){throw new Error("Not Replaced")},e.prototype.executeUpdateCurrentSearchText=function(e){throw new Error("Not Replaced")},e.prototype.executeUpdateSearchResults=function(e){throw new Error("Not Replaced")},e.prototype.executeUpdateSelectedResult=function(e){throw new Error("Not Replaced")},e}(),s=r("+Z9T"),c=function(){function e(e,t){this.objectWrapperType=2,this.previousReturn=new o({pageId:null,controlId:null,contextToken:null,showLabel:!1,isOnPremises:!1,label:"",records:null,isKnowledgeManagementEnabled:!1,currentSearchText:"",entityDisplayName:"",isControlDisabled:!1,urlQueryParams:null,filterQueryParams:null,entityReference:null,searchWidgetActionResult:null,hideSearchOnRecordLoad:!1,blockClick:!1,descriptors:{numberOfResults:10,showArticleStatusFilter:!1,articleStatusFilter:"",showLanguageFilter:!1,languageFilter:"",isAutoSuggestionsEnabled:!1,enableRating:"",showRatingUsing:"",selectDefaultLanguage:"",selectPrimaryCustomer:"",mappedFields:[],enableMDF:!1,allowDisablingMDFOnUI:!1,showContextualActions:"",actionList:[]},executeNotifyHandlersThatEventOccurred:null,executeUpdateCurrentSearchText:null,executeUpdateSearchResults:null,executeUpdateSelectedResult:null}),this._previousControlStateId={},this._propKey=t,this._executeUpdateCurrentSearchText=function(t,r){return e(Object(a.d)(t,r))},this._executeUpdateSearchResults=function(t,r){return e(Object(a.f)(t,r))},this._executeUpdateSelectedResult=function(t,r){return e(Object(a.g)(t,r))}}return e.prototype.linkToParameter=function(e,t){var r=t.executeNotifyHandlersThatEventOccurred;e.executeNotifyHandlersThatEventOccurred=this.executeNotifyHandlersThatEventOccurred.bind(this,r),e.executeUpdateCurrentSearchText=this._executeUpdateCurrentSearchText,e.executeUpdateSearchResults=this._executeUpdateSearchResults,e.executeUpdateSelectedResult=this._executeUpdateSelectedResult},e.prototype.retrieveSearchWidgetObject=function(e,t,r,a,c){var l="hideSearchOnRecordLoad"in t.descriptor&&!!t.descriptor.hideSearchOnRecordLoad,u={},d=!1,p=l?t.descriptor.contextToken:Object(n.n)(c,t.controlId),h=Object(n.v)(p),g=e.searchWidget.list&&e.searchWidget.list[h];this._searchWidgetDescriptor=t.descriptor;var m=Object(i.j)(a);if(t.descriptor){u[this._propKey]=new o({pageId:t.id,controlId:t.controlId,contextToken:p,records:g?e.searchWidget.list[h].records:null,label:this._searchWidgetDescriptor.Label,showLabel:this._searchWidgetDescriptor.ShowLabel,isOnPremises:Object(i.i)(e),urlQueryParams:m?null:this._getUrlQueryParams(a),filterQueryParams:g?e.searchWidget.list[h].filterQueryParams:null,blockClick:m?!!g&&e.searchWidget.list[h].blockClick:g&&!Object(s.a)(e.searchWidget.list[h].blockClick)?e.searchWidget.list[h].blockClick:a.blockClick,descriptors:l?t.descriptor.descriptors:{articleStatusFilter:this._searchWidgetDescriptor.Parameters.FilterResults,showArticleStatusFilter:"true"===this._searchWidgetDescriptor.Parameters.AllowChangingFiltersOnUI,languageFilter:this._searchWidgetDescriptor.Parameters.SelectDefaultLanguage,showLanguageFilter:"true"===this._searchWidgetDescriptor.Parameters.ShowLanguageFilter,numberOfResults:this._searchWidgetDescriptor.Parameters.NumberOfResults,isAutoSuggestionsEnabled:this._searchWidgetDescriptor.Parameters.EnableAutoSuggestions,enableRating:this._searchWidgetDescriptor.Parameters.EnableRating,showRatingUsing:this._searchWidgetDescriptor.Parameters.ShowRatingUsing,selectDefaultLanguage:this._searchWidgetDescriptor.Parameters.SelectDefaultLanguage,selectPrimaryCustomer:this._searchWidgetDescriptor.Parameters.SelectPrimaryCustomer,mappedFields:this._searchWidgetDescriptor.Parameters.hasOwnProperty("MappedFields")?JSON.parse(this._searchWidgetDescriptor.Parameters.MappedFields):[],enableMDF:!!this._searchWidgetDescriptor.Parameters.hasOwnProperty("EnableMDF")&&"true"===this._searchWidgetDescriptor.Parameters.EnableMDF.toLowerCase(),allowDisablingMDFOnUI:!!this._searchWidgetDescriptor.Parameters.hasOwnProperty("AllowDisablingMDFOnUI")&&"true"===this._searchWidgetDescriptor.Parameters.AllowDisablingMDFOnUI.toLowerCase(),showContextualActions:this._searchWidgetDescriptor.Parameters.hasOwnProperty("ShowContextualActions")?this._searchWidgetDescriptor.Parameters.ShowContextualActions:"",actionList:this._searchWidgetDescriptor.Parameters.hasOwnProperty("ActionList")&&this._searchWidgetDescriptor.Parameters.ActionList?this._searchWidgetDescriptor.Parameters.ActionList.split(",").map((function(e){return parseInt(e,10)})):[]},isKnowledgeManagementEnabled:!m||Object(i.h)(e,a.entityTypeName),entityDisplayName:m?Object(i.b)(e,a.entityTypeName):"",isControlDisabled:!!g&&e.searchWidget.list[h].isControlDisabled,hideSearchOnRecordLoad:!1,currentSearchText:g?e.searchWidget.list[h].currentSearchText:null,entityReference:{Id:m?a.id:"",Name:m&&e.metadata.entities[a.entityTypeName]?e.metadata.entities[a.entityTypeName].PrimaryNameAttribute:null,LogicalName:m?a.entityTypeName:""},searchWidgetActionResult:g?e.searchWidget.list[h].searchWidgetActionResult:null,executeNotifyHandlersThatEventOccurred:function(e){},executeUpdateCurrentSearchText:function(e){},executeUpdateSearchResults:function(e){},executeUpdateSelectedResult:function(e){}});var f=!1;"hideSearchOnRecordLoad"in t.descriptor&&t.descriptor.hideSearchOnRecordLoad&&g&&(u[this._propKey].hideSearchOnRecordLoad=t.descriptor.hideSearchOnRecordLoad,u[this._propKey].kbSearchResultActions=t.descriptor.kbSearchResultActions,u[this._propKey].records=[],u[this._propKey].records.push(t.descriptor.records[0]),f=!0),this._searchWidgetDescriptor&&(!this.previousReturn||!g||this._previousControlStateId[h]!==e.searchWidget.list[h].controlStateId||this.previousReturn.label!==u[this._propKey].label||this.previousReturn.showLabel!==u[this._propKey].showLabel||this.previousReturn.currentSearchText!==u[this._propKey].currentSearchText||this._filterQueryParamsHaveChanged(u[this._propKey].filterQueryParams)||this.previousReturn.blockClick!==u[this._propKey].blockClick||this._descriptorsHaveChanged(u[this._propKey].descriptors)||!this.previousReturn.entityReference&&u[this._propKey].entityReference||this.previousReturn.entityReference&&!u[this._propKey].entityReference||this.previousReturn.entityReference&&u[this._propKey].entityReference&&this.previousReturn.entityReference.Id!==u[this._propKey].entityReference.Id||this.previousReturn.searchWidgetActionResult!==u[this._propKey].searchWidgetActionResult)&&(f=!0),d=f}return d&&(this.previousReturn=u[this._propKey],g&&(this._previousControlStateId[h]=e.searchWidget.list[h].controlStateId)),this.previousReturn},e.prototype.getLatestData=function(){return this.previousReturn},e.prototype.executeNotifyHandlersThatEventOccurred=function(e,t,r){e(t,r)},e.prototype._getUrlQueryParams=function(e){return{queryString:e.query,sort:e.sort,enableSelection:e.enableSelection,enableContextualActions:e.enableContextualActions}},e.prototype._filterQueryParamsHaveChanged=function(e){return!this.previousReturn.filterQueryParams&&!!e||!!this.previousReturn.filterQueryParams&&!e||!!this.previousReturn&&!!e&&(this.previousReturn.filterQueryParams.command!==e.command||this.previousReturn.filterQueryParams.value!==e.value)},e.prototype._descriptorsHaveChanged=function(e){return this.previousReturn.descriptors.articleStatusFilter!==e.articleStatusFilter||this.previousReturn.descriptors.showArticleStatusFilter!==e.showArticleStatusFilter||this.previousReturn.descriptors.languageFilter!==e.languageFilter||this.previousReturn.descriptors.showLanguageFilter!==e.showLanguageFilter||this.previousReturn.descriptors.numberOfResults!==e.numberOfResults},e}(),l=r("T2Xs"),u="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlSearchWidgetSelector";function d(e){return function(){var t={},r={},n={};return function(i,a,o,s,d,p){l.a.info(o.controlId+"."+u+": createGetSearchWidgetData started");var h=!1;n.hasOwnProperty(i)&&n[i]||(n[i]=new c(e,i));var g=n[i],m=g.retrieveSearchWidgetObject(a,o,s,d,p);return r.hasOwnProperty(i)&&r[i]&&m===r[i]||(r[i]=m,h=!0),h&&(t[i]=g),l.a.info(o.controlId+"."+u+": createGetSearchWidgetData finished"),t[i]}}}},"1PXy":function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n,i=r("c/eZ"),a=r("1z64"),o=r("Gemh"),s=r("YCDx"),c=r("PZxu"),l=r("ildB"),u=r("3OsR"),d=r("+Z9T"),p=r("ME4N"),h=r("IiPO"),g=r("7bez"),m=r("h82J"),f=r("Sscr"),b=r("ezfI"),y=r("gBKR"),v=r("9r0m"),_="ClientApi.XrmControlTimeline.",S=function(e){function t(t,r,i,o,s,c,l,u){var d=e.call(this,t,r,i,o,s,l)||this;return d._defaultLabel=p.u.Timeline,n=t,d._applicationContext=u,d._controlId=c,d._traceManager=u.TraceManager,d._subgridToken=Object(f.p)(r,s),d._clientApiExecutorTimeline=new a.a(t,_,i,r),d._clientApiExecutorTimeline.addEventParameter({name:"controlName",value:s,isEventParam:!0,expectedDataType:"string"}),d._clientApiExecutorTimeline.addEventParameter({name:"controlId",value:c,isEventParam:!0,expectedDataType:"string"}),d._gridControl=new g.a(t,d._subgridToken,i,!1,3,!0,u,s),t.dispatch(Object(m.a)(d,i,d._subgridToken)),d}return Object(i.__extends)(t,e),t.prototype.getControlType=function(){return b.a.instance.reportUsage(_+"getControlType"),"timelinewall"},t.prototype.getName=function(){var e=this;return this.clientApiExecutor.execute("getName",(function(){return e.controlDescriptor&&e.controlDescriptor.Parameters&&e.controlDescriptor.Parameters[p.s.UClientUniqueName]?e.controlDescriptor.Parameters[p.s.UClientUniqueName]:p.u.Timeline}))},t.prototype.getLabel=function(){var e=_+"getLabel";try{b.a.instance.reportCall(e);var t=this.controlDescriptor&&this.controlDescriptor.Parameters&&!Object(d.a)(this.controlDescriptor.Parameters[p.s.Label])?this.controlDescriptor.Parameters[p.s.Label]:this._defaultLabel?this._defaultLabel:"";return b.a.instance.reportSuccess(e),t}catch(t){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.setLabel=function(t){var r=_+"setLabel";try{b.a.instance.reportCall(r),e.prototype.setLabel.call(this,t),this.controlDescriptor&&this.controlDescriptor.Parameters?this.controlDescriptor.Parameters[p.s.Label]=t:this._defaultLabel=t,b.a.instance.reportSuccess(r)}catch(e){var n=h.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(r,e,null,n),e}},t.prototype.openEmail=function(e){var t=_+"openEmail";try{b.a.instance.reportCall(t),n.dispatch(Object(l.t)(this._controlId,e)),n.dispatch(Object(l.o)(this._controlId,u.a.ContextualDialogEntity,2,v.a.toString(v.a.newGuid()))),b.a.instance.reportSuccess(t)}catch(e){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.refresh=function(e){var t=_+"refresh";e&&e.modules&&(t+="-modules"),e&&e.activities&&(t+="-activities");try{b.a.instance.reportCall(t),e&&this.controlDescriptor&&this.controlDescriptor.Parameters&&(e.modules&&(this.controlDescriptor.Parameters[p.s.UClientModules]=e.modules),e.activities&&(this.controlDescriptor.Parameters[p.s.UClientActivities]=e.activities)),n.dispatch(Object(l.o)(this._controlId,u.a.InitiateRefresh,1,v.a.toString(v.a.newGuid()))),b.a.instance.reportSuccess(t)}catch(e){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.setTargetEntity=function(e,t,r){var i=this;void 0===r&&(r=!0);var a=_+"setTargetEntity";try{b.a.instance.reportCall(a);var o={etn:e,id:t,isAPI:!0},s={};return s[e]=[],n.dispatch(Object(l.v)(this._controlId,o)),n.dispatch(Object(y.e)(s)).catch((function(t){var r=h.a.getInstance().getEventParameters(i.contextToken);throw r.push({name:"controlName",value:i.getName()}),r.push({name:"entityName",value:e}),h.a.getInstance().reportFailure(a+"-retrieveEntities",t,null,r),t})).then((function(){r&&n.dispatch(Object(l.o)(i._controlId,u.a.InitiateRefresh,1,v.a.toString(v.a.newGuid()))),b.a.instance.reportSuccess(a)}))}catch(e){var c=h.a.getInstance().getEventParameters(this.contextToken);throw c.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(a,e,null,c),e}},t.prototype.getGrid=function(){var e=_+"getGrid";try{return b.a.instance.reportCall(e),this._grid||(this._grid=new c.a(n,this._applicationContext,this._subgridToken,this.pageId,this.getEntityName(),!1,this.name)),b.a.instance.reportSuccess(e),this._grid}catch(r){var t=h.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getRecordSetQueryKey=function(){var e=this;return this.clientApiExecutor.execute("getRecordSetQueryKey",(function(){return Object(o.cb)(n.getState(),e._subgridToken,{id:e.pageId})}))},t.prototype.getGridType=function(){return b.a.instance.reportUsage(_+"getGridType"),3},t.prototype.getRollupType=function(){var e=this;return this.clientApiExecutor.execute("getRollupType",(function(){return Object(o.eb)(n.getState(),e.pageId,e.contextToken)}))},t.prototype.getParentForm=function(){var e=_+"getParentForm";try{b.a.instance.reportCall(e);var t=this._gridControl.getParentForm();return b.a.instance.reportSuccess(e),t}catch(t){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.refreshRibbon=function(){var e=_+"refreshRibbon";try{b.a.instance.reportCall(e),this._gridControl.refreshRibbon(),b.a.instance.reportSuccess(e)}catch(r){var t=h.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getEntityName=function(){return b.a.instance.reportUsage(_+"getEntityName"),"activitypointer"},t.prototype.getUrl=function(){var e=h.a.getInstance().getEventParameters(this.contextToken);return e.push({name:"controlName",value:this.getName()}),e.push({name:"validationError",value:"true"}),this._traceManager.getTracer("ClientApi.XrmControlTimeline.getUrl").warn("Not Supported in Timeline control",e),b.a.instance.reportUsage("ClientApi.XrmControlTimeline.getUrl"),""},t.prototype.getFilterXml=function(){var e=_+"getFilterXml",t=h.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),b.a.instance.reportUsage(e),""},t.prototype.getFetchXml=function(){var e=_+"getFetchXml",t=h.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),b.a.instance.reportUsage(e),""},t.prototype.getViewSelector=function(){var e=_+"getViewSelector",t=h.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),b.a.instance.reportUsage(e),null},t.prototype.getTeamTemplateId=function(){return null},t.prototype.getRelationship=function(){var e=_+"getRelationship",t=h.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),b.a.instance.reportUsage(e),null},t.prototype.setFilterXml=function(e){var t=_+"setFilterXml",r=h.a.getInstance().getEventParameters(this.contextToken);r.push({name:"controlName",value:this.getName()}),r.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",r),b.a.instance.reportUsage(t)},t.prototype.addOnLoad=function(e){var t=h.a.getInstance().getEventParameters(this.contextToken);t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer("ClientApi.XrmControlTimeline.addOnLoad").warn("Not Supported in Timeline control",t),b.a.instance.reportUsage("ClientApi.XrmControlTimeline.addOnLoad")},t.prototype.removeOnLoad=function(e){var t=_+"removeOnLoad",r=h.a.getInstance().getEventParameters(this.contextToken);r.push({name:"controlName",value:this.getName()}),r.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",r),b.a.instance.reportUsage(t)},t.prototype.openRelatedGrid=function(){var e=_+"openRelatedGrid",t=h.a.getInstance().getEventParameters(this.contextToken);t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),b.a.instance.reportUsage(e)},t}(s.a)},"22IK":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("gBKR"),i=r("TyhV"),a=r("JlqV"),o=r("HSdq");function s(e){var t=[{name:"parentEntity",value:e}];return{type:"relatedEntity.loadMetaData.async",execute:function(r,s,c){var l=r.dispatch,u=(0,r.getState)(),d=Object(i.b)(u,e),p=!Object(a.b)(u),h=p?{}:d;if(p&&d){var g=Object(o.Wb)(u,Object.keys(d));g&&g.forEach((function(e){h[e]=d[e]})),t.push({name:"all_related_entities_filtered_by_offline_profile",value:h?Object.keys(h).toString():null})}t.push({name:"all_related_entities",value:d?Object.keys(d).toString():null});var m=function(e){return s.EventManager.ReportComponentFailure("relatedEntity.loadMetaData",e,void 0,t),!0};return l(Object(n.e)(h)).then((function(){return p&&s.EventManager.ReportComponentSuccess("relatedEntity.loadMetaData",t),!0}),m).catch(m)},getFailureParameters:function(e,r){return t}}}},"2MsE":function(e,t,r){"use strict";r.d(t,"a",(function(){return B})),r.d(t,"b",(function(){return L}));var n=r("c/eZ"),i=r("nuS9"),a=r("ASFs"),o=r("H/hG"),s=r("YWpA"),c=r("evW+"),l=r("4E+q"),u=r("HSdq"),d=r("sOTk"),p=r("Sscr"),h=r("aPRd"),g=r("MGMD"),m=r("Ww2r"),f=r("wV3W"),b=r("7EJx"),y=r("TCzx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function v(){var e=null,t=null,r=null,i=null,a=null,o=null;return function(s,c){var l=Object(f.a)(s),u=function(e,t){var r=Object(h.c)(e);return r<t?r:t}(s,500),d=Object(h.b)(s),p=Object(h.c)(s),g=Object(b.g)(s);if(t!==l||r!==u||i!==d||a!==p||o!==g){t=l,r=u,i=d,o=g;var m=(a=p)<l.sizes.Breakpoints.DimensionS?"0px":l.sizes.Measures.Measure050,v=y.a.getInstance().get_IsBrowserIE();e={formButtonWrapperStyle:{marginTop:l.sizes.Measures.Measure125,marginLeft:0,marginRight:0,marginBottom:0,width:"100%",display:"flex",flex:"0 0 auto",flexDirection:a<l.sizes.Breakpoints.DimensionS?"column":"row",justifyContent:"flex-end",alignItems:"center"},saveAndCloseButtonStyle:Object(n.__assign)(Object(n.__assign)({},l.buttons.Button01Primary),{marginTop:0,marginBottom:0,marginLeft:0,width:a<l.sizes.Breakpoints.DimensionS?"100%":"auto"}),splitButtonStyle:{marginTop:0,marginBottom:0,marginLeft:0,fontSize:"14px",fontStyle:"normal",fontFamily:l.fontFamilies.Normal,width:a<l.sizes.Breakpoints.DimensionS?"100%":"auto",borderColor:"transparent",height:l.sizes.Measures.Measure250,paddingLeft:l.sizes.Measures.Measure100,paddingRight:l.sizes.Measures.Measure100},splitStyle:{width:a<l.sizes.Breakpoints.DimensionS?"100%":"auto"},splitButtonMenuStyle:{marginTop:0,marginBottom:0,marginLeft:0,fontSize:"14px",fontStyle:"normal",fontFamily:l.fontFamilies.Normal,width:"32px",minWidth:"32px",height:l.sizes.Measures.Measure250,flexDirection:v?"column":"inherit"},customSplitButtonStyles:{splitButtonMenuButton:{backgroundColor:"#4979B2",height:l.sizes.Measures.Measure250},root:{backgroundColor:"#4979B2"}},cancelButtonStyle:Object(n.__assign)(Object(n.__assign)({},l.buttons.Button01Secondary),{marginTop:a<l.sizes.Breakpoints.DimensionS?l.sizes.Measures.Measure050:0,marginLeft:g?void 0:m,marginRight:g?m:void 0,paddingLeft:l.sizes.Measures.Measure100,paddingRight:l.sizes.Measures.Measure100,width:a<l.sizes.Breakpoints.DimensionS?"100%":"auto"}),saveAndCloseButtonLabelStyle:Object(n.__assign)(Object(n.__assign)({},l.buttons.ButtonPrimaryText),{width:"100%",margin:"0 auto",maxWidth:"100%",cursor:"pointer"}),cancelButtonLabelStyle:Object(n.__assign)(Object(n.__assign)({},l.buttons.ButtonSecondaryText),{width:"100%",maxWidth:"100%",margin:"0 auto",cursor:"pointer"})}}return e}}var _=r("KZbu"),S=r("rIXY"),O=r("Wi7Z"),C=r("mVnn"),I=r("yHpA"),j=r("/lKk"),P=r("cZkS"),F=r("qC0c"),T=r("SgZb"),w=r("2Sll"),E=r("Mjry"),x=r("9rQ4"),N=r("cGlR"),A={flexDirection:"row",justifyContent:"flex-end",width:"100%"},k={display:"flex",alignItems:"center",justifyContent:"center"},M={position:"relative",borderLeft:"1px solid white",right:"100%",height:"19px"},D=function(e){var t=e.primaryButtonProps,r=e.menuButtonProps,a=e.viewStyles,o=e.separatorStyles;return i.createElement(s.a,{key:"_splitButtonView",style:Object(n.__assign)(Object(n.__assign)({},A),a)},i.createElement(N.a,Object(n.__assign)({key:t.id||"primaryButtonKey","data-id":t.dataId},t)),i.createElement(s.a,{key:"_splitButtonMenuView",style:Object(n.__assign)({},k)},i.createElement(N.a,Object(n.__assign)({key:r.id||"menuButtonKey","data-id":r.dataId},r)),i.createElement(s.a,{style:Object(n.__assign)(Object(n.__assign)({},M),o)})))},R=function(e){function t(t){var r=e.call(this,t)||this;return r._onCancelButtonClick=r._onCancelButtonClick.bind(r),r._onSaveAndCloseButtonClick=r._onSaveAndCloseButtonClick.bind(r),r._onSaveAndNewButtonClick=r._onSaveAndNewButtonClick.bind(r),r}return Object(n.__extends)(t,e),t.prototype.render=function(){return i.createElement(s.a,{semanticTag:"section",style:this.props.formButtonWrapperStyle,role:O.r,className:"dialogButtons"},this.props.quickCreateSplitButtonEnabled?this._renderSplitButton():this._renderSaveAndCloseButton(),this._renderCancelButton())},t.prototype._renderSplitButton=function(){var e=Object(m.c)(this.props.resourceStrings,S.f),t=Object(m.c)(this.props.resourceStrings,S.e),r=Object(m.c)(this.props.resourceStrings,S.b),a=Object(m.c)(this.props.resourceStrings,S.e)+" "+Object(m.c)(this.props.resourceStrings,S.d);Object(w.a)();var o=y.a.getInstance().get_IsBrowserIE(),s={primary:!0,id:"quickCreateSaveAndCloseBtn",dataId:"quickCreateSaveAndCloseBtn",text:t,styles:this.props.customSplitButtonStyles,ariaLabel:t,accessKey:"S",style:this.props.splitButtonStyle,onClick:this._onSaveAndCloseButtonClick,tabIndex:0,disabled:this.props.isSaving},c=Object(n.__assign)({primary:!0,styles:this.props.customSplitButtonStyles,ariaLabel:a,ariaRoleDescription:a,role:O.d,splitButtonAriaLabel:r,dataId:"quickCreateSaveAndNewBtn",id:"quickCreateSaveAndNewBtn",style:this.props.splitButtonMenuStyle,tabIndex:0,menuTriggerKeyCode:x.a.Space,menuProps:{directionalHint:E.a.topAutoEdge,items:[{key:"saveandnew",text:e,accessibilityLabel:e,style:{":hover":{backgroundColor:"#D8D8D8"},textAlign:"center"},onClick:this._onSaveAndNewButtonClick}]}},o?{menuIconProps:{style:{position:"absolute",top:0,left:0,transform:"translate(50%, 50%)"}}}:{});return i.createElement(D,{primaryButtonProps:s,menuButtonProps:c})},t.prototype._renderSaveAndCloseButton=function(){var e,t=Object(m.c)(this.props.resourceStrings,S.e);return i.createElement(c.a,{testhooks:(e={id:"quickCreateSaveAndCloseBtn"},e[g.a.LearningPathDOMAttributeSuffix]="quick-create|quickCreateSaveAndCloseBtn",e),id:"quickCreateSaveAndCloseBtn",accessKey:"S",ref:"quickCreateSaveAndCloseBtn",onClick:this._onSaveAndCloseButtonClick,disabled:this.props.isSaving,accessibilityLabel:t,style:this.props.saveAndCloseButtonStyle},i.createElement(o.a,{style:this.props.saveAndCloseButtonLabelStyle},t))},t.prototype._renderCancelButton=function(){var e,t=Object(m.c)(this.props.resourceStrings,S.a);return i.createElement(c.a,{id:L(this.props.id),testhooks:(e={id:"quickCreateCancelBtn"},e[g.a.LearningPathDOMAttributeSuffix]="quick-create|quickCreateCancelBtn",e),ref:"quickCreateCancelBtn",accessKey:"C",onClick:this._onCancelButtonClick,disabled:this.props.isSaving,accessibilityLabel:t,style:this.props.cancelButtonStyle},i.createElement(o.a,{style:this.props.cancelButtonLabelStyle},t))},t.prototype._onSaveAndCloseButtonClick=function(){this.props.saveAndCloseForm()},t.prototype._onSaveAndNewButtonClick=function(){this.props.saveFormAndNew(this.props.pageInput)},t.prototype._onCancelButtonClick=function(e){this.props.cancelForm(this.props.output)},t}(i.Component);R.displayName="QuickCreateFormFooter";var B=Object(l.a)((function(){var e=v(),t=Object(u.dd)(),r=Object(m.h)(),i=null;return function(o,s){var c=Object(p.j)(o,s.id),l=Object(F.a)(o,P.cd);Object(a.e)(i,c)||(i=c);var g=Object(d.g)(o,s.id),m=Object(u.mb)(o,s,i),f=t(o,{id:s.id,contextToken:c}),b=Object(h.c)(o),y=e(o,Object(n.__assign)(Object(n.__assign)({},s),{viewPortWidth:b,hasFooterFields:f&&f.length>0})),v=Object(C.a)(o,s.id),_=r(o,S.h),O=Object(u.ac)(o,s.id,i),j=Object(I.g)(o,O);return{isSaving:m,splitStyle:y.splitStyle,formButtonWrapperStyle:y.formButtonWrapperStyle,saveAndCloseButtonStyle:y.saveAndCloseButtonStyle,cancelButtonStyle:y.cancelButtonStyle,splitButtonMenuStyle:y.splitButtonMenuStyle,customSplitButtonStyles:y.customSplitButtonStyles,saveAndCloseButtonLabelStyle:y.saveAndCloseButtonLabelStyle,splitButtonStyle:y.splitButtonStyle,cancelButtonLabelStyle:y.cancelButtonLabelStyle,pageInput:g,contextToken:i,resourceStrings:_,output:v,formDirty:j,quickCreateSplitButtonEnabled:l}}}),(function(e,t){return{saveAndCloseForm:function(){e(Object(j.a)(t.id))},cancelForm:function(r){e(Object(_.a)(t.id,r))},saveFormAndNew:function(r){e(Object(T.a)(r,t.id))}}}))(R);function L(e){return"quickCreateCancelBtn"+e}},"2ojE":function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"c",(function(){return h})),r.d(t,"b",(function(){return g}));var n=r("VcAV"),i=r("/j9Z"),a=r("yHpA"),o=r("LhJP"),s=r("9r0m"),c=r("TCcM"),l=r("T576"),u=r("sOTk"),d=r("WS0f");function p(e,t,r,n){var i=[];try{var a=t&&Object(c.e)(e,t)?Object(c.e)(e,t):s.a.EMPTY,o=t&&Object(c.f)(e,t)?Object(c.f)(e,t):s.a.EMPTY,d=a&&!s.a.equals(a,s.a.EMPTY)?function(e,t){var r=Object(l.a)(e,t);if(r)return r.businessProcessFlowProcessState;return null}(e,a):0,p=Object(u.l)(e,r),h={name:"ProcessId",value:a?s.a.toString(a):s.a.EMPTYGUIDSTRING},g={name:"ProcessInstanceId",value:o?s.a.toString(o):s.a.EMPTYGUIDSTRING},m={name:"CurrentFormEntityType",value:t&&t.etn?t.etn:""},f={name:"CurrentFormEntityId",value:t&&t.id?s.a.toString(t.id):""},b={name:"ProcessState",value:d},y={name:"PageId",value:r||""},v={name:"PageType",value:p};i.push(h),i.push(g),i.push(m),i.push(f),i.push(b),i.push(y),i.push(v)}catch(e){n.TraceManager.getTracer("BusinessProcessFlow.TelemetryGeneration").error("Exception while generating businessprocess telemetry parameters: "+e.message,i)}return i}function h(e,t,r){r.EventManager.ReportComponentSuccess(e,t)}function g(e,t,r,s,c,l,u){!function(e,t){if(!Object(n.c)(e)){var r=Object(i.c)(e);if(!Object(n.c)(r)){var a=r.errorCode;if(!Object(n.c)(a)){var o={name:"ErrorCode",value:"0x"+a.toString(16)};t.push(o)}}}}(t,s),function(e,t,r,s){if(!Object(n.c)(e)){var c=Object(i.c)(e);if(!Object(n.c)(c)&&!Object(n.c)(c.FaultedSnapshotId)){var l={name:o.p,value:c.FaultedSnapshotId};if(t.push(l),!Object(n.c)(r)&&!Object(n.c)(s)){var u=Object(a.c)(s,r);if(!Object(n.c)(u)){var p=u.snapshotId;if(!Object(n.c)(p)&&!Object(d.b)(p)&&p===c.FaultedSnapshotId){var h={name:o.q,value:"serverSideCurrentForm"};t.push(h)}}}}}}(t,s,l,u),c.EventManager.ReportComponentFailure(e,t,r,s)}},"36WT":function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r("c/eZ"),i=r("nuS9"),a=r("4E+q"),o=r("HSdq"),s=r("ah4O"),c=r("bJYk"),l=r("RB3d"),u=r("lMVv"),d=r("cZkS"),p=r("Sscr"),h=r("ASFs"),g=r("bhC+"),m=r("grpZ");function f(e){var t,r=null!==(t=e.selectedFormId)&&void 0!==t?t:e.defaultFormId;var a=e.formNavigatorOptions,o={id:e.id,value:r,onChange:function(t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var i;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return i=r,e.setSelectedFormId(t),[4,e.changeForm(t)];case 1:return 1===n.sent().status&&e.setSelectedFormId(i),[2]}}))}))},options:a,createAccessibilityComponent:l.a,createKeyboardShortcut:l.b,testhooks:{id:"form-selector"},viewSelectorStyle:e.viewSelectorStyle,caretStyle:e.viewSelectorArrowStyle,textStyle:e.viewSelectorTextStyle,readOnly:!0===e.readOnly||void 0,overrideTextContainerStyle:e.overrideTextContainerStyle,expandedBackgroundColor:e.expandedBackgroundColor,hoveredStyle:e.viewSelectorCaretHoveredStyle,useViewSelectorV2:e.enabledFormFCBs.has(d.le)};return i.createElement(s.a,o)}f.displayName="FormNavigator";var b=Object(a.a)((function(){var e,t=Object(o.cd)(),r=null,n=(e={},function(t,r,n,i){var a=Object(m.a)(t,r,!0),o=[];for(var s in a){var c=a[s].name,l={id:s,value:s,text:n.has(d.mb)?c:i?i+": "+c:c};s in e&&e[s].text===l.text||(e[s]=l),o.push(e[s])}return o});return function(e,i){var a=Object(p.j)(e,i.id);Object(h.e)(r,a)||(r=a);var o=Object(u.h)(e,i.entityLogicalName),s=t(e,i,r),c=o&&o.DisplayName;return{enabledFormFCBs:s,formNavigatorOptions:n(e,i.id,s,c),selectedFormId:Object(m.b)(e,i.id)}}}),(function(e,t){return{changeForm:function(r){return e(Object(c.a)(r,t.id,t.pageName))},setSelectedFormId:function(r){e(Object(g.b)(t.id,r))}}}))(f)},"3INI":function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("90Ov"),i=r("WS0f"),a=function(){function e(e){this.path=e}return Object.defineProperty(e.prototype,"path",{get:function(){return this._traversedPath},set:function(e){for(this._traversedPath=Object(n.a)(e);this._traversedPath&&this._traversedPath.indexOf("}")>0;)this._traversedPath=Object(n.a)(this._traversedPath)},enumerable:!1,configurable:!0}),e.getCandidateTraversedPathFromStagStep=function(e,t){t=Object(n.a)(t);var r=!1;if(!e||e.length)return null;for(var i=0;i<e.length;i++){var a=Object(n.a)(e[i].get_stageId());if("".concat(a,","),t===a){r=!0;break}}return r?"".substring(0,"".length-2):null},e.prototype.isInTraversedPath=function(e){return!Object(i.b)(e)&&this._traversedPath.indexOf(Object(n.a)(e))>-1},e}()},"3JmW":function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return p})),r.d(t,"g",(function(){return h})),r.d(t,"d",(function(){return g})),r.d(t,"e",(function(){return m})),r.d(t,"f",(function(){return f}));var n=r("c/eZ"),i=r("ar+e"),a=r("Ww2r"),o=r("HSdq"),s=r("Sscr"),c=r("5Hhq"),l=r("LWFb"),u="related_entity",d="related_tab",p="tablist";function h(e,t){if(e&&e.length&&t.length)return e.substr(0,e.length-t.length-"_".length)}function g(e){return e.find((function(e){return e.id===d}))}function m(e,t){var r;return e&&t?Object(n.__assign)(Object(n.__assign)({},e),((r={})[l.b]=t+"-"+l.d+"-tabHeader",r[l.c]=25..toString(),r)):e}function f(){var e=null;return function(t,r){for(var n=r.props,l=r.resourceStrings,p=r.selectedRelatedEntity,h=r.isInCreateMode,g=Object(a.c)(l,c.e),m=[],f=Object(s.j)(t,n.id),b=0,y=n.availableTabs;b<y.length;b++){var v=y[b];m.push({name:v.Name,label:Object(o.Hc)(t,v.Id,n.id,f),id:v.Id,visible:Object(o.Kc)(t,v.Id,n.id,f),previewId:v.PreviewId})}p&&m.push({name:p.id,label:p.title,id:u,visible:!0});var _=Object(i.h)(t,n);!h&&_&&m.push({name:"tab_related3b554255-7717-4d17-bb7f-9936fb1e75ca",label:g,id:d,visible:!0});var S=e&&e.every((function(e,t){return m[t]&&e.label===m[t].label})),O=e&&e.every((function(e,t){return m[t]&&e.name===m[t].name})),C=e&&e.every((function(e,t){return m[t]&&e.id===m[t].id})),I=e&&e.every((function(e,t){return m[t]&&e.visible===m[t].visible}));return O&&S&&C&&I&&e.length===m.length||(e=m),e}}},"3Ng8":function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return u}));var n=r("FlM9"),i=r("CUpQ"),a=r("HSdq"),o=r("ar+e"),s=r("l9yF");var c=[n.b];function l(e,t){var r=Object(a.Ib)(e,t)?i.u:i.t;return r=r.concat(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){var r=[];if(c)for(var n=0,i=c;n<i.length;n++){var a=i[n];r=r.concat(a(e,t))}return r}(e,t))}function u(){var e=[];return e=(e=(e=(e=e.concat(Object.values(o.a).map((function(e){return e.reason})))).concat(Object.values(o.b))).concat(Object.values(s.a))).concat(Object.values(a.b).map((function(e){return e.reason})))}},"49kd":function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n=r("6FBX"),i=r("nuS9"),a=r("4E+q"),o=r("oY7N"),s=r("Sscr"),c=r("Gemh"),l=r("uO/V"),u=r("RlP9"),d=r("ar+e"),p=r("Ka9P"),h=r("jigW"),g=r("rbxJ"),m=r("U0B9");function f(){var e=null;return function(t,r,n,i,a){var o=Object(c.n)(t,i,r,n,a);return((e?!o:o)||function(t,r){if(e&&r){var n=Object(c.ab)(t,r.CustomControlId);if(!n)return!0;if(e.CustomControlId!==r.CustomControlId)return!0;var i=r.Parameters[n],a=e.Parameters[n];return!a||!i||a.RelationshipName!==i.RelationshipName||a.ViewId!==i.ViewId||a.TargetEntityType!==i.TargetEntityType}}(t,o))&&(e=o),e}}var b=Object(a.a)((function(){var e=null,t=null,r=f(),n=Object(g.a)();return function(i,a){var o=a.id,l=a.formInfo,h=Object(d.e)(i,a,a.parentContextToken);t!==h&&(t=h);var g=Object(s.a)(a.parentContextToken,h.relationshipName,h.ordinal),f=Object(c.T)(i,o,g),b=t&&t.relationshipName,y=t&&t.ordinal?t.ordinal:p.a.Referencing;e||(e=Object(s.j)(i,o));var v=null;t&&t.entityName&&t.relationshipName&&f&&(v=r(i,t.entityName,t.relationshipName,f,o));var _=null,S=Object(u.d)(i,f);h&&h.entityName&&(_=Object(c.l)(i,h.entityName));var O=v&&n(i,v,g),C=Object(m.b)(i);return{subgridConfiguration:v,id:o,viewId:f,relationshipName:b,parentContextToken:e,formInfo:l,homePageConfigurations:_,viewConfigurations:S,roleOrd:y,dataSetUIOptions:O,deviceFormFactor:C}}}))((function(e){if(e.viewId&&e.relationshipName){var t=e.homePageConfigurations&&e.homePageConfigurations.CustomControls&&e.homePageConfigurations.CustomControls[e.deviceFormFactor];Object(h.m)(t);var r={gridConfigurations:e.homePageConfigurations,viewConfigurations:e.viewConfigurations};return i.createElement(o.a,{key:e.id+e.relationshipName,id:e.id,controlId:"entity_control",contextString:l.h.ASSOCIATEDGRID,configuration:e.subgridConfiguration,nonCompositionProps:r,descriptor:null,parentContextToken:e.parentContextToken,dataSetUIOptions:e.dataSetUIOptions})}return null})),y=r("YWpA"),v=r("NJzV"),_=r("2OIc"),S=r("WACO"),O=r("455M"),C=r("lMVv"),I=r("sOTk"),j=r("EGsq"),P=r("7EJx"),F="MscrmControls.WebResource.WebResourceHtmlControl";var T=Object(a.a)((function(){var e={manifest:null,entityTypeCode:null,orgName:null,userSettings:null,orgSettings:null};return function(t,r){var n=Object(_.e)(t,F),i=Object(I.g)(t,r.id),a=Object(C.p)(t,i.entityTypeName),o=Object(j.x)(t),s=Object(j.w)(t),c=Object(P.w)(t);return null===n&&null===i&&null===a&&null===c&&null===o||(e={manifest:n,entityTypeCode:a,orgName:s,userSettings:c,orgSettings:o}),e}}))((function(e){var t=function(e){var t={formId:e.formId,id:e.recordId,orglcid:e.orgSettings.languageCode.toString(),orgname:e.orgName,pagemode:"iframe",type:e.entityTypeCode.toString(),typename:e.entityName,userlcid:e.userSettings.languageId.toString()},r=Object.keys(t).map((function(e){return[e,t[e]].map(encodeURIComponent).join("=")})).join("&");return e.url+"?"+r}(e),r={FormFactor:2,CustomControlId:F,Name:S.a,Version:"1.0.0",Parameters:{value:{Usage:0,Type:O.a.WebResourceHtmlControl}},ShouldOverrideControlVisible:!1},n={Id:F,Label:"",Name:S.a,ShowLabel:!1,Visible:!0,Disabled:!1,Url:t,Parameters:{Url:t,Security:"false",Border:"false"}};return i.createElement(y.a,{key:"WebResourceGanttGridRoot",style:{display:"flex",flexDirection:"row",flex:"auto"}},i.createElement(v.c,{key:F,id:e.id,controlId:F,configuration:r,descriptor:n,parentContextToken:e.parentContextToken}))}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var w=Object(a.a)((function(){var e={manifest:null,entityTypeCode:null,orgName:null,userSettings:null,orgSettings:null};return function(t,r){var n=Object(_.e)(t,"MscrmControls.AuditAssociatedGrid.AuditControl"),i=Object(I.g)(t,r.id),a=Object(C.p)(t,i.entityTypeName),o=Object(j.x)(t),s=Object(j.w)(t),c=Object(P.w)(t);return null===n&&null===i&&null===a&&null===c&&null===o||(e={manifest:n,entityTypeCode:a,orgName:s,userSettings:c,orgSettings:o}),e}}))((function(e){var t=function(e){var t={formId:e.formId,id:e.recordId,orglcid:e.orgSettings.languageCode.toString(),orgname:e.orgName,pagemode:"iframe",type:e.entityTypeCode.toString(),typename:e.entityName,userlcid:e.userSettings.languageId.toString()},r=Object.keys(t).map((function(e){return[e,t[e]].map(encodeURIComponent).join("=")})).join("&");return e.url+"?"+r}(e),r={FormFactor:2,CustomControlId:"MscrmControls.AuditAssociatedGrid.AuditControl",Name:S.a,Version:"1.0.0",Parameters:{FormId:{Usage:1,Static:!0,Type:O.a.SingleLineText,Value:e.formId},OType:{Usage:1,Static:!0,Type:O.a.SingleLineText,Value:e.entityTypeCode},value:{Usage:0,Type:O.a.WebResourceHtmlControl}},ShouldOverrideControlVisible:!1},n={Id:"MscrmControls.AuditAssociatedGrid.AuditControl",Label:"",Name:S.a,ShowLabel:!1,Visible:!0,Disabled:!1,Url:t,Parameters:{Url:t,Security:"false",Border:"false"}},a="AuditHistoryGrid";return i.createElement(y.a,{key:a+"-container",style:{display:"flex",flexDirection:"column",flex:1}},i.createElement(v.c,{key:a+"-customControlHost",id:e.id,controlId:"MscrmControls.AuditAssociatedGrid.AuditControl",configuration:r,descriptor:n,parentContextToken:e.parentContextToken,parentDefinedControlProps:{containerStyleOverrides:{rootContainer:{height:"100%"}}}}))})),E=function(e){var t=e.selectedRelatedEntity;if(!(null==t?void 0:t.isSelected))return null;if(t.entityName===n.g&&e.isAuditFeatureEnabled)return i.createElement(w,{id:e.id,parentContextToken:e.contextToken,formId:e.formId,entityName:e.entityName,recordId:e.recordId,url:t.url});if(!t.url){var r={EntityName:e.entityName,RecordId:e.recordId};return i.createElement(y.a,{style:e.style},i.createElement(b,{parentContextToken:e.contextToken,id:e.id,formInfo:r}))}return i.createElement(T,{id:e.id,parentContextToken:e.contextToken,formId:e.formId,entityName:e.entityName,recordId:e.recordId,url:t.url})};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},"4HtA":function(e,t,r){"use strict";r.d(t,"a",(function(){return ct}));var n,i=r("c/eZ"),a=r("DRVD"),o=r.n(a),s=r("sOTk"),c=r("r0tX"),l=r("6FBX"),u=r("UGbr"),d=r("UTiY"),p=r("c3W+"),h=r("EGdP"),g=r("/j9Z"),m=r("9r0m"),f=r("T576"),b=r("Y70o");!function(e){e[e.None=0]="None",e[e.Processing=1]="Processing",e[e.Completed=2]="Completed",e[e.Failure=3]="Failure",e[e.Invalid=4]="Invalid"}(n||(n={}));var y=function(){function e(e,t){this._getState=e,this._processId=t}return e.prototype.GenerateMessageForAction=function(e){var t="",r="cc_MscrmControls.Containers.ProcessBreadCrumb/strings/ProcessControlResources",i=this._getState(),a=Object(b.a)(i,r,"ProcessControl_ActionExecuter_ExecutionTimeTooltip"),o=Object(b.a)(i,r,"ProcessControl_ActionExecuter_ErrorMessageTooltip"),s=Object(b.a)(i,r,"Crm_GenericErrorMessage");switch(e){case n.Completed:t=String.format(a,(new Date).toLocaleString());break;case n.Failure:t=String.format(a,(new Date).toLocaleString())+"\n"+String.format(o,s)}return t},e.prototype.GetActionMetadata=function(e){var t,r=Object(f.a)(this._getState(),new m.a(this._processId.guid));return r&&r.businessProcessFlowActions&&r.businessProcessFlowActions[e]&&(t=r.businessProcessFlowActions[e]),t},e.prototype.InvokeProcessAction=function(e,t,r){return Xrm.Utility.invokeProcessActionInternal(e,r,t)},e}(),v=r("HSdq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function _(e){if(!e)return null;var t=function(e){var t=[];return e.forEach((function(e){var r={id:m.a.tryParse(e.Id),primaryField:e.PrimaryField,entityTypeCode:e.EntityTypeCode,entityLogicalName:e.EntityLogicalName,primaryKeyName:e.PrimaryKeyName};t.push(r)})),t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e.NavigationEntities);return{entityDisplayName:e.EntityDisplayName,entityLogicalName:e.EntityLogicalName,entityTypeCode:e.entityTypeCode,showCreate:e.ShowCreate,navigationEntities:t}}function S(e,t,r,n){return{type:"businessProcessFlow.retrieveNavigationEntities.async",execute:function(i,a){i.dispatch,i.getState;return function(e,t,r,n,i){return e.retrieveNavigationEntities(t,r,n,i,null).nativePromise().then(_,g.b)}(a.DataSource,e,t,r,n)}}}var O=r("mLFd"),C=r("GWjq"),I=r("phfH"),j=function(){function e(e,t){this.Target=e,this.NewProcess=t}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcess:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}},operationName:"SetProcess",operationType:0}},e}(),P=function(){function e(e,t,r){this.Target=e,this.NewProcess=t,this.NewProcessInstance=r}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcess:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcessInstance:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}},operationName:"SetProcess",operationType:0}},e}(),F=r("RVz9"),T=r("IBKq");function w(e,t,r,n,i,a){return{type:"businessProcessFlow.navigateToNextEntity.async",execute:function(o,s){o.dispatch,o.getState;return function(e,t,r,n,i,a,o){var s=new T.a(m.a.toLegacyGuid(t.id),t.etn,m.a.toLegacyGuid(r.id),r.etn,m.a.toLegacyGuid(n),i,m.a.toLegacyGuid(a),m.a.toLegacyGuid(o));return e.execute(s,null).nativePromise()}(s.DataSource,e,t,r,n,i,a)}}}var E=r("Ia1G"),x=function(){function e(e,t){this.EntityId=e,this.EntityLogicalName=t}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{EntityId:{typeName:"Edm.Guid",structuralProperty:1},EntityLogicalName:{typeName:"Edm.String",structuralProperty:1}},operationName:"RetrieveProcessInstances",operationType:1}},e}();var N=function(){function e(e,t){this.EntityLogicalName=e,this.AppModuleId=t}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{EntityLogicalName:{typeName:"Edm.String",structuralProperty:1},AppModuleId:{typeName:"Edm.Guid",structuralProperty:1}},operationName:"RetrieveFilteredProcesses",operationType:1}},e}(),A=r("4tno");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var k,M=function(){function e(e,t,r){this._name=e,this._uniqueName=t,this._workflowId=r}return Object.defineProperty(e.prototype,"workflowId",{get:function(){return this._workflowId},set:function(e){this._workflowId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uniqueName",{get:function(){return this._uniqueName},set:function(e){this._uniqueName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!1,configurable:!0}),e}(),D=r("9rlF"),R=function(){function e(){}return Object.defineProperty(e.prototype,"activeStageId",{get:function(){return this._activeStageId},set:function(e){this._activeStageId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessInstanceId",{get:function(){return this._businessProcessInstanceId},set:function(e){this._businessProcessInstanceId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessInstanceName",{get:function(){return this._businessProcessInstanceName},set:function(e){this._businessProcessInstanceName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessState",{get:function(){return this._businessProcessState},set:function(e){this._businessProcessState=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessStatus",{get:function(){return this._businessProcessStatus},set:function(e){this._businessProcessStatus=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"navigationEntities",{get:function(){return this._navigationEntities},set:function(e){this._navigationEntities=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"traversedPath",{get:function(){return this._traversedPath},set:function(e){this._traversedPath=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bpfDefinitionVersionNumber",{get:function(){return this._bpfDefinitionVersionNumber},set:function(e){this._bpfDefinitionVersionNumber=e},enumerable:!1,configurable:!0}),e}(),B=r("3INI"),L=function(){function e(){}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"primaryField",{get:function(){return this._primaryField},set:function(e){this._primaryField=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"entityTypeCode",{get:function(){return this._entityTypeCode},set:function(e){this._entityTypeCode=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"entityLogicalName",{get:function(){return this._entityLogicalName},set:function(e){this._entityLogicalName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"primaryKeyName",{get:function(){return this._primaryKeyName},set:function(e){this._primaryKeyName=e},enumerable:!1,configurable:!0}),e}(),V=r("/eCp");!function(e){e[e.Active=0]="Active",e[e.Inactive=1]="Inactive"}(k||(k={}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var z,G=function(){function e(e){this._stageManager=e,this._populateTraversedPath()}return e.prototype.getTraversedPath=function(){return this._traversedPath},e.prototype._populateTraversedPath=function(){this._traversedPath=this._stageManager.globalPathAndActiveStage.traversedPath.path},e}(),W=r("7kKV"),H=r("AqA3"),U=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=W.a.invalid,n.stageInvalidReason=H.a.invalid,Object.setPrototypeOf(n,t.prototype),n}return Object(i.__extends)(t,e),t}(Error),q=(function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=W.a.crossEntity,n.stageInvalidReason=H.a.crossEntity,Object.setPrototypeOf(n,t.prototype),n}Object(i.__extends)(t,e)}(Error),function(e){function t(r){var n=e.call(this,r)||this;return n.stageInvalidReason=H.a.unreachable,Object.setPrototypeOf(n,t.prototype),n}return Object(i.__extends)(t,e),t}(Error)),X=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=W.a.dirtyForm,n.stageInvalidReason=H.a.dirtyForm,Object.setPrototypeOf(n,t.prototype),n}return Object(i.__extends)(t,e),t}(Error),K=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=W.a.end,Object.setPrototypeOf(n,t.prototype),n}return Object(i.__extends)(t,e),t}(Error),Q=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=W.a.beginning,Object.setPrototypeOf(n,t.prototype),n}return Object(i.__extends)(t,e),t}(Error),Y=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=W.a.stageGate,Object.setPrototypeOf(n,t.prototype),n}return Object(i.__extends)(t,e),t}(Error),Z=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=W.a.invalidProcess,n.stageInvalidReason=H.a.invalidProcess,Object.setPrototypeOf(n,t.prototype),n}return Object(i.__extends)(t,e),t}(Error),J=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=W.a.dirtyForm,n.stageInvalidReason=H.a.dirtyForm,Object.setPrototypeOf(n,t.prototype),n}return Object(i.__extends)(t,e),t}(Error),$=r("QAhb"),ee=r("TVue"),te=r("rQCE"),re=r("lFQy"),ne=r("Jcuz"),ie=r("690X"),ae=r("eA/s"),oe=r("jJRu"),se=r("g9bv"),ce=r("r454"),le=r("OROb"),ue=r("qYad"),de=r("TCcM"),pe=r("cAHA"),he=r("Sscr"),ge=r("yHpA"),me=r("LteD"),fe=r("BFwB"),be=function(e){function t(t,r,n){var i=e.call(this,"BusinessProcessFlow_"+t)||this;return i.addEventParameter("ProcessId",r),i.addEventParameter("ProcessInstanceId",n),i}return Object(i.__extends)(t,e),t}(fe.a),ye=function(e){function t(t,r){return e.call(this,"Initialized",t,r)||this}return Object(i.__extends)(t,e),t}(be),ve=function(e){function t(t,r,n){var i=e.call(this,"SetActiveStageEvent",t,r)||this;return i.addEventParameter("ActiveStageId",n),i}return Object(i.__extends)(t,e),t}(be),_e=function(e){function t(t,r,n){var i=e.call(this,"DisplayStateEvent",t,r)||this;return i.addEventParameter("CurrentDisplayState",n),i}return Object(i.__extends)(t,e),t}(be),Se=function(e){function t(t,r,n,i){var a=e.call(this,"StatusEvent",t,r)||this;return a.addEventParameter("ProcessStatus",n),a.addEventParameter("CurrentDisplayState",i),a}return Object(i.__extends)(t,e),t}(be),Oe=r("txwV"),Ce=r("WS0f"),Ie=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:"entity",operationName:"ExecuteWorkflow",operationType:0,parameterTypes:{entity:{typeName:"Microsoft.Dynamics.CRM.workflow",structuralProperty:5},EntityId:{typeName:"Edm.Guid",structuralProperty:1},InputArguments:{typeName:"Microsoft.Dynamics.CRM.InputArgumentCollection",structuralProperty:2}}}},e}(),je=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Type:{typeName:"Edm.String",structuralProperty:1},Value:{typeName:"Edm.String",structuralProperty:1}}}},e}(),Pe=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Count:{typeName:"Edm.Int32",structuralProperty:1},IsReadOnly:{typeName:"Edm.Boolean",structuralProperty:1},Keys:{typeName:"Edm.String",structuralProperty:4},Values:{typeName:"mscrm.AnyComplexType",structuralProperty:4}}}},e}(),Fe=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Arguments:{typeName:"Microsoft.Dynamics.CRM.InputArgument",structuralProperty:2}}}},e}(),Te=r("K1ho"),we=r("ObKm"),Ee=r("uwKl"),xe=r("ed60");!function(e){e[e.ProcessAction=0]="ProcessAction",e[e.TaskFlow=1]="TaskFlow",e[e.SyncWorkflow=2]="SyncWorkflow",e[e.AsyncWorkflow=3]="AsyncWorkflow",e[e.MessageAction=4]="MessageAction"}(z||(z={}));var Ne=r("2ojE"),Ae=r("LhJP"),ke=r("lMVv"),Me=r("GHPx"),De=r("h82J"),Re=r("VcAV"),Be=function(){function e(e,t){this._getState=e,this._applicationContext=t}return e.prototype.setBpfInstance=function(e){return this._processInstance=e,this},e.prototype.setBpfInstanceName=function(e){return this._processInstanceName=e,this},e.prototype.setProcess=function(e){return this._process=e,this},e.prototype.setProcessId=function(e){return this._processId=e,this},e.prototype.setFormEntity=function(e){return this._formEntity=e,this},e.prototype.GetFlowStepMetadata=function(e,t){var r=t.TraceManager.getTracer("businessProcessFlow.flowStepManager"),n=this._processId&&this._processId.guid||null,i=Object(f.a)(this._getState(),m.a.tryParse(n));if(Object(Re.c)(i))return r.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined bpfDescriptor: "+i),null;var a=i.businessProcessFlowFlows;if(Object(Re.c)(a))return r.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined businessProcessFlowFlows: "+a),null;var o=a[e];return Object(Re.c)(a)?(r.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined flowStepDescriptor: "+o),null):o},e.prototype.openFlowWidget=function(e,t){if(m.a.tryParse(e.flowStepId)===m.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty flowStepId: "+e.flowStepId);var r=this._populateFlowDialogParams(e,t),n={height:600,width:600};Xrm.Navigation.openDialog("MicrosoftFlowsDialog",n,r)},e.prototype._populateFlowDialogParams=function(t,r){var n=this.GetFlowStepMetadata(t.flowStepId,this._applicationContext);if(Object(Re.c)(n))throw new Error("BPF Flow Step Failure: null metadata");var i={},a=n.flowId;if(Object(Re.c)(a))throw new Error("BPF Flow Step Failure: null metadata.flowId");if(!this._processInstance&&!this._processInstance.id){var o=[];o.push(this._processInstance.id.guid);var s=JSON.stringify(o);i.entity_ids=s}i.flow_id=a,i.org_unique_name=Xrm.Utility.getGlobalContext().getOrgUniqueName(),i.bpf_step_id=t.flowStepId;var c=Xrm.Page.data.entity.getEntityName(),l=this._getState().metadata.entities[c].EntitySetName,u=Xrm.Utility.getGlobalContext().getAdvancedConfigSetting("MicrosoftFlowDestinationUrl");i.entity_logical_collection_name=l,i.entity_logical_name=c,i.flows_destination_url=u,i.dynamics365_access_token=sessionStorage.getItem("dynamics365AccessToken");var d=Xrm.Utility.getGlobalContext().getAdvancedConfigSetting("MicrosoftFlowFirstPartyIntegrationSiteUrl");i.flows_fpi_site_url=d+"&flowsEnableWidgetV2=true",i.flows_authentication_string=this._getLocalizedLabel("SystemCustomization.SystemSettingsDialog.PreviewTab.IsMicrosoftFlowEnabled.AuthenticateButton.Text"),i.flows_enable_widget_v2=!0,e.UpdateEventParameter(r,"flows_destination_url",u),e.UpdateEventParameter(r,"flow_id",a),Object(Re.c)(t.workflowLogId)||t.workflowLogId===m.a.EMPTY||(i.flows_wflog_id=m.a.toString(t.workflowLogId));var p=this._processInstance&&this._processInstance.id;if(Object(Re.c)(p)||p===m.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty processInstanceId: "+p);i.bpf_instance_id=m.a.toString(p);var h=this._processInstance&&this._processInstance.etn;if(Object(Ce.b)(h))throw new Error("BPF Flow Step On-Click Failure: null or empty processInstanceEntityLogicalName: "+h);i.bpf_instance_entity_name=h;var g=this._processId&&this._processId.guid||null;if(m.a.tryParse(g)===m.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty processId: "+g);i.bpf_definition_id=g,i.bpf_definition_entity_name="workflow";var f=this._process&&this._process.get_Name();if(Object(Ce.b)(f))throw new Error("BPF Flow Step On-Click Failure: null or undefined bpfDefinitionName: "+f);if(i.bpf_definition_name=f,Object(Ce.b)(this._processInstanceName))throw new Error("BPF Flow Step On-Click Failure: null or undefined processInstanceName: "+this._processInstanceName);i.bpf_instance_name=this._processInstanceName;var b=t.selectedStage&&t.selectedStage.get_Description();if(Object(Ce.b)(b))throw new Error("BPF Flow Step On-Click Failure: null or undefined flowStageName: "+b);i.bpf_flowstage_localized_name=b,i.bpf_flowstage_entity_name=c,i.bpf_flowstage_entity_collection_name=l;var y=this._formEntity&&this._formEntity.id;if(Object(Re.c)(y)||y===m.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty flowStageRecordId: "+y);i.bpf_flowstage_entity_record_id=m.a.toString(y);var v=m.a.tryParseOrNull(t.activeStage&&t.activeStage.get_Id()||"");if(Object(Re.c)(v)||v===m.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty activeStageId: "+v);i.bpf_activestage_id=m.a.toString(v);var _=t.activeStage&&t.activeStage.get_Description();if(Object(Ce.b)(_))throw new Error("BPF Flow Step On-Click Failure: null or undefined activeStageName: "+_);return i.bpf_activestage_localized_name=_,i.bpf_activestageentity_name="processstage",i},e.prototype._getLocalizedLabel=function(e){return Xrm.Utility.getResourceString("Main_system_library",e)},e.getTelemetryParamsForFlowStep=function(e,t,r,n,i){var a=i||[],o={name:"flow_id",value:e},s={name:"environment_id",value:t},c={name:"flows_destination_url",value:r},l={name:"bpf_step_id",value:n};return a.push(o),a.push(s),a.push(c),a.push(l),a},e.UpdateEventParameter=function(e,t,r){e&&0!==e.length&&e.some((function(e){if(e.name===t)return e.value=r,!0}))},e}(),Le=r("qC0c"),Ve=r("pflg"),ze=r("UWFM"),Ge=r("b1hT"),We=r("tvev"),He=r("RK8T"),Ue=r("xc1f"),qe=r("yZTI"),Xe=r("UVKb"),Ke=r("j+yI"),Qe=r("OTOS"),Ye=r("uQP8"),Ze=r("lKeh"),Je=r("IQF2"),$e=r("buKK"),et=r("+D0h"),tt=r("YEEA"),rt=r("2nMH"),nt=o.a.createEvent("Initialize","BusinessProcessFlow.ProcessManager"),it=o.a.createEvent("SetActiveStage","BusinessProcessFlow.ProcessManager"),at=o.a.createEvent("ValidateRequiredFields","BusinessProcessFlow.ProcessManager"),ot=o.a.createEvent("CreateActiveStageSnapshot","BusinessProcessFlow.ProcessManager"),st=o.a.createEvent("SaveFormAndActiveStage","BusinessProcessFlow.ProcessManager"),ct=function(){function e(e,t,r,n,i){this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isUserSelectedStage=!1,this._isBpfFormValid=null,this._applicationContext=e,this._getState=t,this._dispatch=r,this._stageMetadata=n,this._activeStageManager=i}return e.prototype.initilaizeWithProcessAndFormEntity=function(e,t,r,n,i,a){var o=this,s=nt.startStopwatch({processId:m.a.toString(n),processInstanceId:m.a.toString(i.id)});this._currentPageId=a,this._processId=n,this._version=t.businessProcessFlowProcessVersion,this._currentFormEntity=r,this._currentBpfInstance=i,this._stageMetadata.setPrimaryModel(this._currentFormEntity.etn),this._stageMetadata.setObjectModel(t);var c=this._createGlobalNavigationData(e);this._activeStageManager.InitGlobalPathAndActiveStage(c),this._stageMetadata.initializeDefaultPathManager(new G(this._activeStageManager),this),this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isBpfFormValid=null;var l={};if(this._isUserSelectedStage)l.selectedStageId=m.a.tryParseOrNull(this.getSelectedStageId());else{var u=this.getActiveStageId();this._isActiveStageInCurrentEntity(u)?l.selectedStageId=m.a.tryParseOrNull(u):l.selectedStageId=this._getDefaultSelectedStageId()||m.a.tryParseOrNull(u)}this._dispatch(Object(re.a)(l,this._currentBpfInstance));var d=new ye(m.a.toString(n),m.a.toString(i.id));this._applicationContext.EventManager.ReportEvent(d),this._savedPageId!==a&&(this._savedPageId=a,this.getScriptContainerPromise().then((function(e){e&&e.getEventManager().addOnProcessChangeEvent(o.getContextToken(),(function(){o._saveCrossEntityBpf()}))}))),Object(Ge.f)(this._getState())||this._updateProcessInstanceModifiedTime(),this._actionStepManager=new y(this._getState,n),this._flowStepManager=new Be(this._getState,this._applicationContext).setBpfInstance(this._currentBpfInstance).setProcess(this.getProcess()).setProcessId(this.getProcessId()).setFormEntity(this._currentFormEntity).setBpfInstanceName(this.getProcessInstanceName()),this._instanceModifiedTimestamp=Object(f.f)(this._getState(),this._currentFormEntity),this._instanceModifiedTimestamp||(this._instanceModifiedTimestamp=(new Date).getTime()),Object(Ge.f)(this._getState())&&ze.a.Instance.setProcessManagerByPageId(this._currentPageId,this);var p=this.getTelemetryParams();this._currentFormEntity||this._applicationContext.TraceManager.getTracer(Ae.g).error("ProcessManager is initialized with current entity as null",p);Object(Ne.c)(Ae.g,p,this._applicationContext),s()},e.prototype._saveCrossEntityBpf=function(){var e=this._getState(),t=Object(s.g)(e,this._currentPageId),r=Object(Ve.a)(t),n=Object(Ve.b)(t);if(r&&n){var i=new $.a(t.data.parentrecordtype,new m.a(t.data.parentrecordid)),a=new $.a(t.entityTypeName,t.id);this._dispatch(Object(Ee.b)(r,a)),this._dispatch(Object(xe.b)(n,a)),this.navigateToNextEntityForCrossEntityBpf(i,a,r,n)}},e.prototype.initilaizeWithFormEntityOnly=function(e,t){this._currentPageId=t,this._currentFormEntity=e,this._processId=null,this._version=-1,this._currentBpfInstance=null,this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isBpfFormValid=null,Object(Ge.f)(this._getState())||this._updateProcessInstanceModifiedTime(),Object(Ge.f)(this._getState())&&ze.a.Instance.setProcessManagerByPageId(this._currentPageId,this);var r=this.getTelemetryParams();this._currentFormEntity||this._applicationContext.TraceManager.getTracer(Ae.f).error("ProcessManager is initialized with current entity as null",r);Object(Ne.c)(Ae.f,r,this._applicationContext)},e.prototype.setActiveProcess=function(e){var t=this;return new Promise((function(r,n){var i=t.getTelemetryParams();if(!t.getCurrentFormEntity()){var a=new g.a("Current form entity is not initialized.",2147877745);return Object(Ne.b)(Ae.m,a,null,i,t._applicationContext,null,t._getState()),void n(new g.a("Current form entity is not initialized",2147877745))}var o=m.a.tryParseOrNull(e);if(!o)return Object(Ne.c)(Ae.m,i,t._applicationContext),void n(new Error("Invalid process id"));if(m.a.isNullOrEmpty(t.getCurrentFormEntity().id))return Object(Ne.c)(Ae.m,i,t._applicationContext),void n(new g.a("Not supported on new records",2147877748));var s=new j({id:m.a.toString(t.getCurrentFormEntity().id),entityType:t.getCurrentFormEntity().etn},{id:m.a.toString(o),entityType:l.fc});t._dispatch(Object(F.b)(s)).then((function(){t._executePostEvent("runOnProcessChange","setActiveProcess"),Object(Ne.c)(Ae.m,i,t._applicationContext),r()}),(function(e){t._dispatch(Object(d.b)(e,!0)).then((function(){return n(e)})),Object(Ne.b)(Ae.m,e,null,i,t._applicationContext,null,t._getState())}))}))},e.prototype.setActiveProcessInstance=function(e){var t=this;return new Promise((function(r,n){var i=t.getTelemetryParams();if(!t.getCurrentFormEntity()){var a=new g.a("Current form entity is not initialized.",2147877745);return Object(Ne.b)(Ae.n,a,null,i,t._applicationContext,null,t._getState()),void n(new g.a("Current form entity is not initialized",2147877745))}var o=m.a.tryParseOrNull(e);o?t.getProcessInstances().then((function(e){if(e&&e.value){for(var i="",a=0,s=e.value;a<s.length;a++){var c=s[a];if(c&&c.businessprocessflowinstanceid&&c.businessprocessflowinstanceid.toLowerCase()===m.a.toString(o).toLowerCase()){i=c["a_processid_value".substring(1)];break}}if(Object(Ce.b)(i))n(new g.a("Supplied process instance does not match any existing instance on this entity",2147877744));else{var u=m.a.tryParseOrNull(i);if(u){var p=new P({id:m.a.toString(t.getCurrentFormEntity().id),entityType:t.getCurrentFormEntity().etn},{id:m.a.toString(u),entityType:l.fc},{id:m.a.toString(o),entityType:l.fc});t._dispatch(Object(F.b)(p)).then((function(){t._executePostEvent("runOnProcessChange","setActiveProcessInstance"),r(i)}),(function(e){t._dispatch(Object(d.b)(e,!0)).then((function(){return n(e)}))}))}else n(new Error("Invalid process id"))}}else n(new Error("No process instances found for current entity"))}),(function(e){t._dispatch(Object(d.b)(e,!0)).then((function(){return n(e)}))})):n(new Error("Invalid process instance id"))}))},e.prototype.setCurrentInstance=function(e){this._currentBpfInstance=e},e.prototype.setStatus=function(e){var t=this;return new Promise((function(r,n){var i;if(e||n(new Error("setStatus can only be called with a valid status (active, finished, aborted")),e===V.a.Active)i=t.reactivateProcess();else if(e===V.a.Finished)i=t.completeProcess();else{if(e!==V.a.Aborted)return n(new Error("Invalid status passed to setStatus"));i=t.abandonProcess()}i.then((function(){var n=new Se(m.a.toString(t._processId),m.a.toString(t.getProcessInstanceId()),e,t.getDisplayState());t._applicationContext.EventManager.ReportEvent(n),r()}),(function(e){n(e)}))}))},e.prototype.setVisible=function(e){if(!(Object(Ce.a)(this._currentBpfInstance)||Object(Ce.a)(this._currentFormEntity)||Object(Ce.a)(this._currentFormEntity.etn))){var t=Object(he.h)(this._currentFormEntity.etn);this._dispatch(Object(me.b)(this._currentPageId,Oe.a,t,!0===e)),this._updateProcessInstanceModifiedTime()}},e.prototype.isVisible=function(){if(!this._currentBpfInstance)return!1;var e=Object(he.h)(this._currentFormEntity.etn);return!0===Object(v.G)(this._getState(),{id:this._currentPageId,controlName:Oe.a},e)},e.prototype.getCurrentFormEntity=function(){return this._currentFormEntity},e.prototype.getActiveStageEntityRef=function(){var e=this._getStage(this.getActiveStageId()),t=e&&e.get_parent()&&e.get_parent().get_Name()||null,r=this._getNavigationEntityIdsByEntityLogicalName();return t&&r&&r.hasOwnProperty(t)?new $.a(t,r[t]):null},e.prototype.getProcess=function(){return this._currentBpfInstance&&this._stageMetadata.getProcessObjectModel()},e.prototype.getProcessInstanceName=function(){return this._currentBpfInstance&&Object(C.e)(this._getState(),this._currentBpfInstance)},e.prototype.getTraversedPath=function(){return Object(C.h)(this._getState(),this._currentBpfInstance)},e.prototype.getProcessId=function(){return this._processId},e.prototype.getVersion=function(){return this._version},e.prototype.getProcessInstanceId=function(){return this._currentBpfInstance&&this._currentBpfInstance.id},e.prototype.getBpfEntityLogicalName=function(){return this._currentBpfInstance&&this._currentBpfInstance.etn},e.prototype.getEntityStages=function(){return this._stageMetadata.getEntityStages()},e.prototype.getActiveStage=function(){return this._getStage(this.getActiveStageId())},e.prototype.getProcessInstances=function(){var e=this;return new Promise((function(t,r){var n,i;e._dispatch((n=e._currentFormEntity.id,i=e._currentFormEntity.etn,{type:"businessProcessFlow.retrieveProcessInstancesRequest.async",execute:function(e,t){e.dispatch;var r=e.getState,a=t.DataSource.get_WebAPIService(),o=new x(n,i),s=Object(E.a)(r(),o);return a.sendRequest(s).then((function(e){return e.json()}),g.b)}})).then((function(e){t(e)}),(function(e){r(e)}))}))},e.prototype.getSelectedStage=function(){return this._getStage(this.getSelectedStageId())},e.prototype.isCrossEntityNavigation=function(e){var t=e?this._stageMetadata.getNextStageId(this.getActiveStageId()):this._stageMetadata.getPreviousStageId(this.getActiveStageId());if(!t)return!1;var r=this._stageMetadata.getStage(t);if(!r)return!1;var n=r.get_parent();return this._currentFormEntity&&this._currentFormEntity.etn&&n&&n.get_EntityLogicalName()!==this._currentFormEntity.etn},e.prototype._isStageOnPath=function(e,t){for(var r=0,n=t;r<n.length;r++){var i=n[r];if(m.a.equals(i,e))return!0}return!1},e.prototype.getProcessState=function(){var e=Object(f.a)(this._getState(),this.getProcessId());return e?e.businessProcessFlowProcessState:null},e.prototype.getState=function(){if(this._currentBpfInstance){var e=Object(C.f)(this._getState(),this._currentBpfInstance);if(e){var t=parseInt(e.valueString,10);return isNaN(t)?null:t}}return null},e.prototype.getStatusName=function(){if(this._currentBpfInstance){var e=Object(C.g)(this._getState(),this._currentBpfInstance);if(e)return e.label}return null},e.prototype.getStatus=function(){if(this._currentBpfInstance){var e=Object(C.g)(this._getState(),this._currentBpfInstance);if(e){var t=parseInt(e.valueString,10);return isNaN(t)?null:t}}return null},e.prototype.getActiveStageId=function(){if(this._currentBpfInstance){var e=this._currentBpfInstance&&Object(C.a)(this._getState(),this._currentBpfInstance);if(m.a.isNullOrEmpty(e)&&this._currentBpfInstance&&this._activeStageManager&&this._activeStageManager.globalPathAndActiveStage){var t=this._activeStageManager.globalPathAndActiveStage.stageId;t&&(e=m.a.tryParseOrNull(t))}if(!m.a.isNullOrEmpty(e)){var r=this.getActivePath();if(r&&r.length>0)return this._isStageOnPath(e,r)?e.guid:r[0].guid}}return null},e.prototype.getActivePathStages=function(){var e=this.getActivePath();if(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=this._getStage(e[r].guid);return t}return null},e.prototype.getActivePath=function(){if(!this._currentBpfInstance)return null;var e=Object(I.c)(this._getState(),this.getProcessInstanceId());return e||(e=this._getDefaultActivePath()),e},e.prototype.getDisplayState=function(){return this._currentBpfInstance?Object(I.d)(this._getState())||c.a.getDefaultDisplayState():null},e.prototype.getSelectedStageId=function(){if(!this._currentBpfInstance)return null;var e=Object(I.g)(this._getState(),this.getProcessInstanceId());return e?e.guid:this.getActiveStageId()},e.prototype._getDefaultSelectedStageId=function(){if(!this._currentBpfInstance)return null;var e=Object(I.g)(this._getState(),m.a.EMPTY);return e&&!this._stageMetadata.getStage(e.guid)?null:e},e.prototype._isActiveStageInCurrentEntity=function(e){try{return this._stageMetadata.getStage(e).get_parent().get_Name()===this._currentFormEntity.etn}catch(e){this._applicationContext.EventManager.ReportComponentFailure("ProcessManager._isActiveStageInCurrentEntity",e)}return!0},e.prototype.getStageMetadata=function(){return this._stageMetadata},e.prototype.isBusinessProcessAborted=function(){return this.getStatus()===V.a.Aborted},e.prototype.isBusinessProcessCompleted=function(){return this.getStatus()===V.a.Finished},e.prototype.moveToNextStage=function(){var e=this,t=this.getTelemetryParams(),r=new Promise((function(t,r){if(Object(Ce.a)(e._currentBpfInstance))return r(new g.a("Process Control does not exist on form.",2147877746));var n=e._stageMetadata.getNextStageId(e.getActiveStageId());if(n){t(e._saveMainFormIfImmersiveBpfAndNewRecord().then((function(){return e._saveFormDataAndActiveStage(m.a.tryParseOrNull(n),0,"MoveToNextStage")})))}else r(new K("Last stage in the active path reached. Next stage does not exist."))}));return r.then((function(){Object(Ne.c)(Ae.h,t,e._applicationContext)}),(function(r){e._shouldReportErrorAsSuccess(r)?Object(Ne.c)(Ae.h,t,e._applicationContext):Object(Ne.b)(Ae.h,r,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),r},e.prototype.moveToPreviousStage=function(){var e=this,t=this.getTelemetryParams(),r=new Promise((function(t,r){if(Object(Ce.a)(e._currentBpfInstance))return r(new g.a("Process Control does not exist on form.",2147877746));var n=e._stageMetadata.getPreviousStageId(e.getActiveStageId());if(!n)return r(new Q("The first stage in the traversed path reached. Previous stage does not exist."));t(e._saveFormDataAndActiveStage(m.a.tryParseOrNull(n),1,"MoveToPreviousStage"))})).then((function(){e._stageMetadata.getDefaultPathManager().triggerSubsequentDefaultPathCalculation(e.getActiveStageId())}));return r.then((function(){Object(Ne.c)(Ae.i,t,e._applicationContext)}),(function(r){e._shouldReportErrorAsSuccess(r)?Object(Ne.c)(Ae.i,t,e._applicationContext):Object(Ne.b)(Ae.i,r,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),r},e.prototype.setActiveStage=function(e){var t=this,r=it.startStopwatch({processId:m.a.toString(this.getProcessId()),processInstanceId:m.a.toString(this.getProcessInstanceId()),stageId:e}),n=this.getTelemetryParams(),i=new Promise((function(r,n){var i=m.a.tryParseOrNull(e),a=t.getTraversedPath();if(Object(Ce.a)(t._currentBpfInstance))return n(new g.a("Process Control does not exist on form.",2147877746));if(!i)return n(new U("setActiveStage can only be called with a valid stage id"));if(!t._stageMetadata.getStage(i.guid))return n(new U("stage id does not exist on any path of the instance"));if(!a)return n(new U("Traversed Path is not present"));if(t.getActiveStageId()===i.guid)return r();var o=new B.a(a);if(!o||!o.isInTraversedPath(e))return n(t.getActivePath().some((function(e){return m.a.equals(e,i)}))?new U("The stage is not in traversed path. Only navigating backwards is supported."):new q("stage id does not exist on the current acitve path of the instance."));r(t._saveFormDataAndActiveStage(i,1,"SetActiveStage"))})).then((function(){var r=new ve(m.a.toString(t._processId),m.a.toString(t.getProcessInstanceId()),e);t._applicationContext.EventManager.ReportEvent(r),t._stageMetadata.getDefaultPathManager().triggerSubsequentDefaultPathCalculation(e)}));return i.then((function(){r(),Object(Ne.c)(Ae.o,n,t._applicationContext)}),(function(e){r(),t._shouldReportErrorAsSuccess(e)?Object(Ne.c)(Ae.o,n,t._applicationContext):Object(Ne.b)(Ae.o,e,null,n,t._applicationContext,t.getCurrentFormEntity(),t._getState())})),i},e.prototype.switchProcess=function(){},e.prototype.abandonProcess=function(){var e=this,t=this.getTelemetryParams(),r=new Promise((function(t,r){return Object(Ce.a)(e._currentBpfInstance)?r(new g.a("Process Control does not exist on form.",2147877746)):e.isBusinessProcessAborted()?t():void t(e._updateStateAndStatusOfProcess(V.a.Aborted,k.Inactive,"AbandonProcess"))}));return r.then((function(){Object(Ne.c)(Ae.a,t,e._applicationContext)}),(function(r){e._shouldReportErrorAsSuccess(r)?Object(Ne.c)(Ae.a,t,e._applicationContext):Object(Ne.b)(Ae.a,r,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),r},e.prototype.reactivateProcess=function(){var e=this,t=this.getTelemetryParams(),r=new Promise((function(t,r){return Object(Ce.a)(e._currentBpfInstance)?r(new g.a("Process Control does not exist on form.",2147877746)):e.getStatus()===V.a.Active?t():void t(e._updateStateAndStatusOfProcess(V.a.Active,k.Active,"ReactivateProcess"))}));return r.then((function(){Object(Ne.c)(Ae.j,t,e._applicationContext)}),(function(r){e._shouldReportErrorAsSuccess(r)?Object(Ne.c)(Ae.j,t,e._applicationContext):Object(Ne.b)(Ae.j,r,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),r},e.prototype.completeProcess=function(){var e=this,t=this.getTelemetryParams(),r=new Promise((function(t,r){return Object(Ce.a)(e._currentBpfInstance)?r(new g.a("Process Control does not exist on form.",2147877746)):e.isBusinessProcessCompleted()?t():m.a.tryParseOrNull(e._stageMetadata.getNextStageId(e.getActiveStageId()))?r(new g.a("Attempt to finish a process not on last stage.",2148081666)):void t(e._saveMainFormIfImmersiveBpfAndNewRecord().then((function(){return e._updateStateAndStatusOfProcess(V.a.Finished,k.Inactive,"CompleteProcess")})))}));return r.then((function(){Object(Ne.c)(Ae.c,t,e._applicationContext)}),(function(r){e._shouldReportErrorAsSuccess(r)?Object(Ne.c)(Ae.c,t,e._applicationContext):Object(Ne.b)(Ae.c,r,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),r},e.prototype._shouldReportErrorAsSuccess=function(e){return e instanceof Z||(e instanceof Y||(e instanceof K||(e instanceof Q||(e instanceof U||(e instanceof q||e instanceof J)))))},e.prototype.triggerActionStepClick=function(e){var t=this;if(Object(Ce.b)(e)){var r=new Error("BPF Action Step Failure: null ControlId");throw Object(Ne.b)(Ae.b,r,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),r}var n=this._actionStepManager.GetActionMetadata(e);if(Object(Ce.a)(n)){r=new Error("BPF Action Step Failure: null metadata");throw Object(Ne.b)(Ae.b,r,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),r}var i=this._getState();if(Object(Ce.a)(i)){r=new Error("BPF Action Step Failure: null state");throw Object(Ne.b)(Ae.b,r,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),r}var a=this._getTelemetryParamsForActionStep(n.actionType,e,n.actionId);try{var o=new m.a(n.actionId);if(n.actionType===z.AsyncWorkflow||n.actionType===z.SyncWorkflow){var s=[this._processId.guid,m.a.toString(this.getProcessInstanceId()),o.guid].map((function(e){var t=new je;return t.Type="System.String",t.Value=e,t})),c=new Pe;c.Keys=["BusinessProcessFlowId","BusinessProcessFlowInstanceId","ActionStepId"],c.Values=s,c.Count=3,c.IsReadOnly=!0;var l=new Fe;l.Arguments=c;var u=new Ie;u.EntityId=this._currentFormEntity.id,u.InputArguments=l,u.entity={id:n.workflowId,entityType:"workflow"},this.UpdateActionLog(o,1),this._dispatch(Object(F.b)(u)).then((function(){Object(Te.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,2,t._actionStepManager.GenerateMessageForAction(2)),Object(Ne.c)(Ae.b,a,t._applicationContext)}),(function(r){Object(Te.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,3,t._actionStepManager.GenerateMessageForAction(3)),Object(Ne.b)(Ae.b,r,null,a,t._applicationContext,t.getCurrentFormEntity(),t._getState()),t._dispatch(Object(d.b)(r,!0)).then()}))}else if(n.actionType===z.ProcessAction){var p=function(r){Object(Te.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,3,t._actionStepManager.GenerateMessageForAction(3)),Object(Ne.b)(Ae.b,r,null,a,t._applicationContext,t.getCurrentFormEntity(),t._getState()),t._dispatch(Object(d.b)(r,!0)).then()},h=function(r){Object(Te.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,2,t._actionStepManager.GenerateMessageForAction(2));var i=r.get_outputParameters();n.outputBindings.forEach((function(e){if(e.parameterName in i){var r=i[e.parameterName],n=e.boundAttributeName,a={};a[n]={key:n,value:r},t._dispatch(Object(we.a)(t._currentPageId,a,!1,!0,t._currentFormEntity.etn,t._currentFormEntity.id.guid,null,t.getContextToken()))}})),Object(Ne.c)(Ae.b,a,t._applicationContext)},g={};n.inputBindings.forEach((function(e){var r=Object(D.c)(Object(de.j)(t._getState(),t.getCurrentFormEntity(),e.boundAttributeName));g["ProcessUnification_Arguments_"+e.parameterName]=r})),this._addInputParametersToParamList(n.inputParameters,g),this.UpdateActionLog(o,1),Xrm.Navigation.openDialog(n.workflowId,this._getDialogOptions(),g).then((function(r){if(r=r?r.parameters:{},t._filterInputArguments(r)){var i={id:m.a.toString(t.getCurrentFormEntity().id),entityType:t.getCurrentFormEntity().etn};r.Target=i,r.BusinessProcessFlowId=t._processId.guid,r.BusinessProcessFlowInstanceId=m.a.toString(t.getProcessInstanceId()),r.ActionStepId=n.actionId,t._actionStepManager.InvokeProcessAction(n.uniqueName,n,r).then(h,p)}else Object(Te.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,3,t._actionStepManager.GenerateMessageForAction(3))}),p)}}catch(e){throw 0===a.length&&(a=this.getTelemetryParams()),Object(Ne.b)(Ae.b,e,null,a,this._applicationContext,this.getCurrentFormEntity(),this._getState()),e}},e.prototype.triggerFlowStepClick=function(e,t){t=t;var r=Be.getTelemetryParamsForFlowStep(null,null,null,e,this.getTelemetryParams());try{var n=m.a.newGuid(),i={activeStage:this.getActiveStage(),selectedStage:this.getSelectedStage(),flowStepId:e,workflowLogId:n};this._flowStepManager.openFlowWidget(i,r),this.UpdateActionLog(new m.a(e),1,void 0,n);var a=this.getActionLog(new m.a(e));this.createWorkflowLogRecord(a),Object(Ne.c)(Ae.d,r,this._applicationContext)}catch(e){Object(Ne.b)(Ae.d,e,null,r,this._applicationContext,this.getCurrentFormEntity(),this._getState())}},e.prototype.refreshFlowStepClick=function(e){var t=this,r=Be.getTelemetryParamsForFlowStep(null,null,null,e,this.getTelemetryParams()),n=this._dispatch(Object(Xe.a)(this._processId,this._currentBpfInstance));Promise.resolve(n).then((function(){t._updateProcessInstanceModifiedTime(),Object(Ne.c)(Ae.k,r,t._applicationContext)})).catch((function(e){Object(Ne.b)(Ae.k,e,null,r,t._applicationContext,t.getCurrentFormEntity(),t._getState())}))},e.prototype._addInputParametersToParamList=function(e,t){for(var r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];"ProcessUnification_Arguments_"+e[i].parameterName in t||(t["ProcessUnification_Arguments_"+e[i].parameterName]=null)}},e.prototype._filterInputArguments=function(e){if(e&&"last_button_clicked"in e&&"ok_id"===e.last_button_clicked){for(var t in e){var r=e[t];if(t.startsWith("ProcessUnification_Arguments_"))e[t.substring("ProcessUnification_Arguments_".length,t.length)]=r;delete e[t]}return!0}return!1},e.prototype._getDialogOptions=function(){return{height:450,width:450,position:1}},e.prototype._createSnapshotRequest=function(e,t){if(!e)throw new Error("Active stage cannot be null or undefined.");var r=new $.a("processstage",e),n=this._calculateNewTraversedPath(e),i={activestageid:{reference:r,timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:e.guid}},traversedpath:{value:n,timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:""}}};return this._addFieldsToBPFSnapshotForCreate(i,t)},e.prototype._addFieldsToBPFSnapshotForCreate=function(e,t){if(!e||!this._hasBpfInstance())return e;var r=Object(Ke.b)(this._getState(),this._currentFormEntity.etn,this._currentBpfInstance.etn);return r&&(e[r.ReferencingAttribute]={reference:new $.a(this._currentFormEntity.etn,t),timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}}),e.processid={reference:new $.a("workflow",this.getProcessId()),timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}},e},e.prototype.generateBPFInstanceSnapshotId=function(){if(this.isImmersiveBPF()||!Object(Le.c)(this._getState(),"FCB.SplitBPFEntityAndParticipatingEntityCreates"))return null;var e=[],t=null;try{var r=Object(v.ac)(this._getState(),this._currentPageId,this.getContextToken()),n=Object(ge.b)(this._getState(),r),i=n.identifier&&n.identifier.id||this._currentFormEntity.id,a=Object(s.g)(this._getState(),this._currentPageId);if(Object(Ke.e)(a))return Object(Ke.f)(this._getState(),r,i,this._dispatch),null;if(!this._hasBpfInstance()||m.a.isNullOrEmpty(this.getProcessId()))return null;if(e=this.getTelemetryParams(),Object(Ke.d)(this._getState(),n.identifier,this._currentPageId))return Object(Ke.f)(this._getState(),r,i,this._dispatch),null;m.a.isNullOrEmpty(i)&&(i=m.a.newGuid(),Object(Ke.f)(this._getState(),r,i,this._dispatch)),t=this._createActiveStageSnapshot(m.a.tryParse(this.getActiveStageId()),i);var o=Object(ge.b)(this._getState(),t);e.push({name:"SnapshotId",value:t}),e.push({name:"Snapshot active changes",value:o&&o.activeChanges&&Object.keys(o.activeChanges).map((function(e){return"Property: "+e})).join("; ")}),this._applicationContext.EventManager.ReportComponentSuccess("ProcessManager.generateBPFInstanceSnapshotId",e)}catch(t){this._applicationContext.EventManager.ReportComponentFailure("ProcessManager.generateBPFInstanceSnapshotId",t,null,e)}return t},e.prototype._calculateNewTraversedPath=function(e){for(var t="",r=0,n=this.getActivePath();r<n.length;r++){var i=n[r];if(t+=","+i.guid,m.a.equals(i,e))return t.substring(1)}return(t+=","+e.guid).substring(1)},e.prototype._createActiveStageSnapshot=function(e,t){var r=this._createSnapshotRequest(e,t),n=ot.startStopwatch({processId:m.a.toString(this.getProcessId()),processInstanceId:m.a.toString(this.getProcessInstanceId())}),i=Object(ge.c)(this._getState(),this.getCurrentFormEntity());if(this.isImmersiveBPF()&&!Object(Ce.a)(i)){var a=Object(se.b)(this._getState(),i.snapshotId,r);return this._dispatch(a),i=Object(ge.c)(this._getState(),this.getCurrentFormEntity()),n(),i.snapshotId}var o=Object(he.h)(this._currentFormEntity.etn),s=Object(he.x)(o),c=Object(oe.b)(this._getState(),this._currentBpfInstance,r,s,this._hasBpfInstance()?pe.a.Create:pe.a.Update),l=c.payload.snapshotId;return this._dispatch(c),n(),l},e.prototype._hasBpfInstance=function(){return!this._currentBpfInstance||m.a.isNullOrEmpty(this._currentBpfInstance.id)},e.prototype._updateStateAndStatusOfProcess=function(e,t,r){var n=this;return new Promise((function(i,a){var o=n._createStatusAndStateUpdateRequest(e,t),s=Object(ge.c)(n._getState(),n.getCurrentFormEntity()),c=null;if(n.isImmersiveBPF()&&!Object(Ce.a)(s)){var l=Object(se.b)(n._getState(),s.snapshotId,o);n._dispatch(l),s=Object(ge.c)(n._getState(),n.getCurrentFormEntity())}else{var u=Object(he.h)(n.getCurrentFormEntity().etn),p=Object(he.x)(u),h=Object(oe.b)(n._getState(),n._currentBpfInstance,o,p);c=h.payload.snapshotId,n._dispatch(h)}if(!n.executePreEvent("runOnPreProcessStatusChange",r,null,e))if(n._shouldPerformFormSave()){var m=n._validateSnapshot(s).then((function(){return n._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(r)})).then((function(){return n._saveFormEntityAndBPFEntitySnapshots(c,s,!1)})).then((function(){n._executePostEvent("runOnProcessStatusChange",r,null,e)})).catch((function(e){var t=Object(g.c)(e);return n._handleDuplicateDetection(t,c)})).catch((function(e){throw n._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(e),e})).catch((function(e){n._dispatch(Object(d.b)(e,!0)).then((function(){return a(e)}))}));i(m)}else n._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(r).then((function(){var t=null;t=n.isImmersiveBPF()&&!Object(Ce.a)(s)?s.snapshotId:c;n._dispatch(Object(le.c)(t,!0,["statuscode","statecode","activestagestartedon","completedon"])).then((function(){n._dispatch(Object(ue.a)(n._currentPageId,n.getCurrentFormEntity(),n._getColumnsToRefresh())).then((function(){n._updateProcessInstanceModifiedTime(),n._executePostEvent("runOnProcessStatusChange",r,null,e)})),i()})).catch((function(e){n._dispatch(Object(d.b)(e,!0)).then((function(){return a(e)}))}))}));i()}))},e.prototype._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures=function(e){var t=this;return new Promise((function(r,n){if("CompleteProcess"===e||"MoveToNextStage"===e){var i=t.ValidateRequiredFieldsForNavigation();if(i&&!i.isValid)if("MoveToNextStage"===e)n(new Y("Unable to navigate to next stage as required fields have not been set"));else{if("CompleteProcess"===e)return n(new Y("Unable to complete process as required fields have not been set"));n(new Error("validation failed for unexpected BPF operation: "+e))}}return r()}))},e.prototype._saveFormChangesBeforeNavigation=function(){var e=this;if(this._shouldPerformFormSave()){var t=Object(ge.c)(this._getState(),this.getCurrentFormEntity());return this._validateSnapshot(t).then((function(){return e._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures("MoveToNextStage")})).then((function(){var r=e._getColumnsToRefresh();return e._dispatch(Object(le.c)(t.snapshotId,!0,r))})).catch((function(r){return e._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(r,t.snapshotId),e._dispatch(Object(d.b)(r,!0))}))}return Promise.resolve()},e.prototype._shouldPerformFormSave=function(){var e=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ShouldPerformFormSave"),t=this.getTelemetryParams(),r=this._getState();if(Object(v.kb)(r,{id:this._currentPageId},this.getContextToken()))return e.info("Skip main form save for BPF state or stage change due to read only form",t),!1;var n=this._dispatch(Object(De.b)(this._currentPageId,this.getContextToken()));if(n&&n.data&&n.data.getIsDirty){var i=n.data.getIsDirty(),a={name:"shouldPerformMainFormSave",value:i};return t.push(a),e.info("Checking if main form save should be performed due to dirty form",t),i}return e.error("Unable to determine dirty state of main form - skipping save of main form",t),!1},e.prototype._saveMainFormIfImmersiveBpfAndNewRecord=function(){var e=this,t=Object(s.l)(this._getState(),this._currentPageId);if(this.isImmersiveBPF()&&t===Ue.a&&m.a.isNullOrEmpty(this.getCurrentFormEntity().id)){return this._dispatch(Object(u.f)(this._currentPageId,t,!1,1,!1,!1)).then((function(t){e._currentFormEntity=t}))}return Promise.resolve(void 0)},e.prototype._validateSnapshot=function(e){var t=this;return new Promise((function(r,n){var i=t._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SnapshotValidation"),a=t._getSnapshotStateTelemetryParams(e),o=t._currentPageId,s=t.getContextToken(),c=t._dispatch(t._getEventManager().runOnSave(s,1));for(var l in c&&(t._dispatch(Object(p.b)(o,s,2)),t._dispatch(Object(h.b)(o,s,!1)),i.warn("BPF ProcessManager: Unable to save form data due to web resource registered onSave invoking preventDefault",a),n(new g.a("Unable to save form data due to web resource registered onSave invoking preventDefault",2147877737))),e.activeChanges){var u=e.activeChanges[l],d=t._applicationContext.DataSource.get_MetadataCache().getAttributeMetadata(e.identifier.etn,l),m=Object(Ce.a)(d)?null:d.get_logicalName(),f=Object(Ce.a)(d)?We.a.get_empty():d.get_id();if(Object(Ce.a)(u))return i.error("BPF ProcessManager: unexpected null or undefined fieldValue for attribute "+m+" with ID: "+f,a),n(new Error("Internal Client Error - null fieldValue"));var b=u.validationResult;if(Object(Ce.a)(b)){if(m===Me.c){i.info("BPF ProcessManager: skipping formEntitySnapshot validation for atttribute: "+m+" with ID: "+f,a);continue}return i.error("BPF ProcessManager: unexpected null or undefined validationResult for atttribute: "+m+" with ID: "+f,a),n(new Error("Internal Client Error - null validatorResult"))}var y=b.isValueValid;if(Object(Ce.a)(y))return i.error("BPF ProcessManager: unexpected null or undefined validationResult.isValidValue for atttribute: "+m+" with ID: "+f,a),n(new Error("Internal Client Error - null validationResult.isValidValue"));if(!y){var v={name:Ae.q,value:"clientSideCurrentForm"};return a.push(v),i.warn("BPF ProcessManager: unable to save form due to invalid value for attribute: "+m+" with ID: "+f,a),n(new X("Unable to save form data due to validation errors"))}}return r(!0)}))},e.prototype._createStatusAndStateUpdateRequest=function(e,t){var r;return(r={}).statuscode={label:V.a[e],valueString:e.toString(),timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null}},r.statecode={label:k[t],valueString:t.toString(),timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null}},r},e.prototype.ValidateRequiredFieldsForNavigation=function(){for(var e=at.startStopwatch({processId:m.a.toString(this.getProcessId()),processInstanceId:m.a.toString(this.getProcessInstanceId())}),t=this._getState(),r=this._stageMetadata.getRequiredAttributesForStage(this.getActiveStageId(),this._currentPageId,this.getContextToken(),t),n=this._stageMetadata.getRequiredFlowStepsForStage(this.getActiveStageId(),this._currentPageId,this.getContextToken(),t),i={emptySteps:[],errorSteps:[]},a=Object(ge.c)(this._getState(),this.getCurrentFormEntity()),o=this._getSnapshotStateTelemetryParams(a),c=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SnapshotValidation"),l=0,d=r;l<d.length;l++){var p=d[l];c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: validating attribute: "+p,o);var h=Object(de.j)(this._getState(),this.getCurrentFormEntity(),p);a&&a.activeChanges&&p in a.activeChanges&&(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: fieldIsDirty: "+p,o),h=a.activeChanges[p]),Object(I.h)(h,this._getState(),this.getCurrentFormEntity().etn,p)?(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: emptyField: "+p,o),i.emptySteps.push(p)):h.validationResult.isValueValid||(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: !fieldValue.validationResult.isValueValid: "+p,o),i.errorSteps.push(p))}for(var g=0,f=n;g<f.length;g++){var b=f[g],y=m.a.tryParse(b);if(m.a.isNullOrEmpty(y))c.error("BPF ProcessManager ValidateRequiredFieldsForNavigation: invalid Flow Step ID GUID: "+b,o);else{var _=this.getActionLog(y);if(_){var S=_.status;2!==S&&(c.info("BPF ProcessManager ValidateRequiredFieldsForNavigation: Required Flow Step not completed for stepId "+b+". The Flow Step Action Log has stauts of : "+S,o),i.errorSteps.push(b))}else c.info("BPF ProcessManager ValidateRequiredFieldsForNavigation: Required Flow Step not completed for stepId "+b+". No action logs were found for this Flow Step",o),i.errorSteps.push(b)}}i.isValid=0===i.emptySteps.length&&0===i.errorSteps.length;var O=Object(Ye.a)(t,this._currentPageId);if(!Object(v.Gb)(O,t,this._currentPageId,this.getContextToken())){c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: form is not valid - "+this._currentPageId,o);var C=Object(s.l)(this._getState(),this._currentPageId);this._dispatch(Object(u.f)(this._currentPageId,C,!1,1,!1,!1)),i.isValid=!1}if(!i.isValid){var j=String.format("BPF ProcessManager: ValidateRequiredFieldsForNavigation returned invalid");c.warn(j,o)}return e(),i},e.prototype.setSelectedStage=function(e,t){var r=this;return void 0===t&&(t=!1),new Promise((function(n,i){var a=m.a.tryParseOrNull(e);if(!a)return i("setSelectedStage can only be called with a valid stage id");var o={selectedStageId:a};r._updateBusinessProcessFlowData(r._currentBpfInstance,o),r._isUserSelectedStage=t,t&&r._executePostEvent("runOnStageSelected","setSelectedStage"),n()}))},e.prototype.setDisplayState=function(e){if(this._currentBpfInstance&&(e===c.a.collapsed||e===c.a.expanded||e===c.a.floating)){this._updateDisplayState(this._currentBpfInstance,e);var t=new _e(m.a.toString(this._processId),m.a.toString(this.getProcessInstanceId()),e);this._applicationContext.EventManager.ReportEvent(t)}},e.prototype.setActivePath=function(e){if(e&&0!==e.length){for(var t=[],r=0;r<e.length;r++)t[r]=new m.a(e[r]);var n={activePath:t};this._updateBusinessProcessFlowData(this._currentBpfInstance,n)}},e.prototype.setBpfNavigationBehavior=function(e){var t={processNavigationBehavior:{navigationBehavior:e,navigationBehaviorPageId:this._currentPageId}};this._updateBusinessProcessFlowData(this._currentBpfInstance,t)},e.prototype.getBpfNavigationBehavior=function(){return this._currentBpfInstance&&Object(I.e)(this._getState(),this.getProcessInstanceId())},e.prototype.shouldReInitializeNavigationBehavior=function(){return!(!this._currentBpfInstance||!(null==this.getBpfNavigationBehavior()&&Object(Ce.a)(Object(I.b)(this._getState(),this.getProcessInstanceId()))||Object(I.f)(this._getState(),this.getProcessInstanceId())!==this._currentPageId))},e.prototype.getBpfNavigationBehaviorAllowCreateNew=function(e){var t=this._currentBpfInstance&&Object(I.b)(this._getState(),this.getProcessInstanceId());return!t||!e||t(e)},e.prototype.createWorkflowLogRecord=function(e){var t;if(Object(Ce.a)(e))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined actionLog");var r=this._getState();if(Object(Ce.a)(r))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined state");var n=r.metadata;if(Object(Ce.a)(n))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined metadata");var i=n.entities;if(Object(Ce.a)(i))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined entities");var a=this._currentBpfInstance.etn;if(Object(Ce.b)(a))throw new Error("BPF Create WorkflowLog Record Failure: null or empty entityLogicalName");var o=i[a];if(Object(Ce.a)(o))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined bpfEntity");var s=o.EntitySetName;if(Object(Ce.b)(s))throw new Error("BPF Create WorkflowLog Record Failure: null or empty entitySetName");var c=Object(ke.z)(r,"workflowlog",o.EntityLogicalName,"asyncoperationid");if(Object(Ce.a)(c))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined relationshipMetadata");if(Object(Ce.b)(c.ReferencingEntityNavigationPropertyName))throw new Error("BPF Create WorkflowLog Record Failure: null or empty relationshipMetadata.ReferencingEntityNavigationPropertyName");var l=c.ReferencingEntityNavigationPropertyName+"@odata.bind",u="/"+s+"("+e.processInstanceid.guid+")",d=((t={workflowlogid:e.actionLogId.guid,stepname:e.stepId.guid})[l]=u,t.activityname=e.processDefinitionid.guid,t.status=e.status,t);Xrm.WebApi.createRecord("workflowlog",d)},e.prototype._getTracer=function(){return Object(Ce.a)(this._applicationContext)||Object(Ce.a)(this._applicationContext.TraceManager)?null:this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ProcessManager")},e.prototype._getDefaultActivePath=function(){var e=this._getTracer();if(Object(Ce.a)(this._stageMetadata))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined _stageMetadata"),null;var t=this._stageMetadata.getDefaultPathManager();if(Object(Ce.a)(t))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined defaultPathManager"),null;var r=t.getDefaultPath();if(Object(Ce.a)(r))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined stringPath"),null;var n=[];for(var i in r){var a=m.a.parse(r[i]);n.push(a)}return n},e.prototype._updateBusinessProcessFlowData=function(e,t){e&&(this._dispatch(Object(re.a)(t,e)),this._updateProcessInstanceModifiedTime())},e.prototype._updateDisplayState=function(e,t){this._dispatch(Object(ne.a)(t,e)),this._updateProcessInstanceModifiedTime()},e.prototype.getForwardNavigationEntities=function(e,t,r,n){var i=this;return this._saveFormChangesBeforeNavigation().then((function(){return i._dispatch(S(e,t,r,n||null))}))},e.prototype.navigateToNextEntity=function(e,t,r,n){var i=this;return new Promise((function(a,o){var s=i.ValidateRequiredFieldsForNavigation();if(s&&!s.isValid)return o(new Y("Unable to navigate to next stage as required fields have not been set"));var c=i._stageMetadata.getNextStageId(i.getActiveStageId());if(!c)return o(new K("Last stage in the active path reached. Next stage does not exist."));var l=new m.a(c),u=i.getTraversedPath()+","+c;return i._saveFormChangesBeforeNavigation().then((function(){return i._dispatch(w(e,t,l,u,r,n))})).then((function(){return i.setSelectedStage(c)})).then((function(){i._executePostEvent("runOnStageChange","navigateToNextEntity",0),a()})).catch((function(e){i._dispatch(Object(d.b)(e,!0)).then((function(){return o(e)}))}))}))},e.prototype.navigateToNextEntityForCrossEntityBpf=function(e,t,r,n){var i=this;return new Promise((function(a,o){i._dispatch(w(e,t,new m.a(i.getActiveStageId()),i.getTraversedPath(),r,n)).then((function(){i._dispatch(Object(ae.b)(t,i._currentBpfInstance)),i._executePostEvent("runOnStageChange","navigateToNextEntityForCrossEntityBpf",0),a()})).catch((function(e){i._dispatch(Object(d.b)(e,!0)).then((function(){return o(e)}))}))}))},e.prototype.getActiveStageActiveFor=function(){if(this._currentBpfInstance){var e=Object(C.b)(this._getState(),this._currentBpfInstance);if(e)return(new Date).valueOf()-e.valueOf()}return null},e.prototype.getBpfInstanceActiveFor=function(){if(this._currentBpfInstance){var e=Object(C.d)(this._getState(),this._currentBpfInstance);if(e)return(new Date).valueOf()-e.valueOf()}return null},e.prototype.getBpfInstanceCompletedIn=function(){if(this._currentBpfInstance){var e=Object(C.d)(this._getState(),this._currentBpfInstance),t=Object(C.c)(this._getState(),this._currentBpfInstance);if(t&&e)return t.valueOf()-e.valueOf()}return null},e.prototype.getActionLogCollection=function(){return this._currentBpfInstance?Object(I.a)(this._getState(),this.getProcessInstanceId()):null},e.prototype.getActionLog=function(e){var t=this.getActionLogCollection();return t&&t[e.guid]?t[e.guid]:null},e.prototype.UpdateActionLog=function(e,t,r,n){if(!this._currentBpfInstance)return null;var a=Object(I.a)(this._getState(),this.getProcessInstanceId()),o=a&&a[e.guid]?a[e.guid]:null,s=(m.a.EMPTY,{actionLogId:Object(Ce.a)(n)||n===m.a.EMPTY?o?o.actionLogId:m.a.newGuid():n,status:t,modifiedOn:(new Date).toLocaleString(),stepId:e,processDefinitionid:this._processId,processInstanceid:this.getProcessInstanceId(),message:r}),c=Object(i.__assign)({},a);c[e.guid]=s;var l={actionLogCollection:c};return this._updateBusinessProcessFlowData(this._currentBpfInstance,l),"success"},e.prototype.getEnabledProcesses=function(){var e=this,t=[];return new Promise((function(r,n){var i;e._currentFormEntity&&e._currentFormEntity.etn?e._dispatch((i=e._currentFormEntity.etn,{type:"businessProcessFlow.retrieveFilteredProcesses.async",execute:function(e,t){e.dispatch;var r=e.getState,n=t.DataSource.get_WebAPIService(),a=r(),o=m.a.tryParse(Object(A.i)(a)),s=new N(i,o),c=Object(E.a)(r(),s);return n.sendRequest(c).then((function(e){return e.json()}),g.b)}})).then((function(e){for(var n=0,i=e.value;n<i.length;n++){var a=i[n];t.push(new M(a.name,a.uniquename,a.workflowid))}r(t)}),(function(e){n(e)})):n(new g.a("Current Form Entity cannot be NULL",2147877745))}))},e.prototype.getNavigationEntities=function(){return this._activeStageManager.navigationEntities},e.prototype._getNavigationEntityIdsByEntityLogicalName=function(){return this._activeStageManager.navigationEntityIdsByEntityLogicalName},e.prototype._updateGlobalActiveStage=function(e,t){this._activeStageManager.UpdateGlobalPathAndActiveStage(e,t)},e.prototype._createGlobalNavigationData=function(e){var t=new R,r=Object(D.b)(e.activestageid);t.activeStageId=m.a.toString(r);var n=Object(D.c)(e.traversedpath);Object(Ce.b)(n)&&(n=B.a.getCandidateTraversedPathFromStagStep(this._stageMetadata.businessProcessFlowVisitor.get_stages(),t.activeStageId)),t.traversedPath=n,t.navigationEntities=[];for(var i=0,a=this._getNavigationEntityTypesFromWorkflowObjectModel();i<a.length;i++){var o=a[i],s=new L;for(var c in s.entityLogicalName=o,s.id=m.a.EMPTY.guid,e)if(Object(D.k)(e[c])){var l=e[c],u=[];if(Object(Ce.a)(l.reference)||Object(Ce.a)(l.reference.etn))u.push({name:"entityReference.reference",value:"NULL"}),this._applicationContext.TraceManager.getTracer("CreateGlobalNavigationData").info("Navigation entity should not be null .",u);l&&l.reference&&l.reference.etn===o&&(s.id=l.reference.id.guid)}t.navigationEntities.push(s)}e.hasOwnProperty("businessprocessflowinstanceid")&&(t.businessProcessInstanceId=Object(D.c)(e.businessprocessflowinstanceid));e.hasOwnProperty("name")&&(t.businessProcessInstanceName=Object(D.c)(e.name));e.hasOwnProperty("statecode")&&(t.businessProcessState=Object(D.c)(e.statecode));e.hasOwnProperty("statuscode")&&(t.businessProcessStatus=Object(D.c)(e.statuscode));return e.hasOwnProperty("bpfDefinitionVersioNumber")&&(t.bpfDefinitionVersionNumber=Object(D.c)(e.bpfDefinitionVersioNumber)),t},e.prototype._getNavigationEntityTypesFromWorkflowObjectModel=function(){var e={};if(!Object(Ce.a)(this.getProcess()))for(var t=0;t<this.getProcess().get_Steps().get_Count();t++){var r=this.getProcess().get_Steps().get_item(t);if(r instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep){var n=r.get_Description();e[n]||(e[n]=n)}}return Object.keys(e)},e.prototype.reflow=function(e,t,r){var n=this._stageMetadata.getDefaultPathManager();if(t||r){if(t){t=new m.a(t).guid;var i=this.getTraversedPath(),a=this.getActiveStageId();i&&a&&(a===t||i.indexOf(t)<0)&&(n.updateDefaultPath(t,r),this._updateProcessInstanceModifiedTime())}}else this._reflowInternal()},e.prototype._reflowInternal=function(e,t){var r=this._stageMetadata.getDefaultPathManager();e||t||(t=this.getActiveStageId(),e=this._stageMetadata.getPreviousStageId(t)),e&&(r.updateDefaultPath(e,t),this._updateProcessInstanceModifiedTime())},e.prototype.callPblToEvaluateBranching=function(e){var t=this,r=this._getState();if(!this._currentPageId)throw new Error("The current page Id should not be null when callPblToEvaluateBranching has been called. Because the reflow logic should be triggered for a particular page.");var n=Object(ee.a)(r,this._currentPageId);this.getScriptContainerPromise().then((function(r){n<te.a.EditReady&&r.getEventManager().addOnLoadEvent(t.getContextToken(),(function(){r.execute(e,[])})),n>=te.a.OnLoadReady&&r.execute(e,[])}))},e.prototype.update=function(e){!Object(Ce.a)(this._currentBpfInstance)&&this._isSelectedStageControl(e.Id)&&this._updateProcessInstanceModifiedTime()},e.prototype.waitForOngoingWork=function(){return Je.a.getInstance().checkForOutstandingWork(this._getState())},e.prototype._getEventManager=function(){var e=this.getScriptContainer();return e?e.getEventManager():null},e.prototype.getScriptContainer=function(){if(!this._applicationContext||!this._applicationContext.ScriptManager)return null;var e=null;try{e=this._applicationContext.ScriptManager.getContainer(this._currentPageId)}catch(e){this._logTraceFailureForScriptContainer()}return e},e.prototype.getScriptContainerPromise=function(){return this._applicationContext&&this._applicationContext.ScriptManager?this._applicationContext.ScriptManager.initializeContainer(this._currentPageId):Promise.reject("The current container should be created before invoking handlers.")},e.prototype._executePostEvent=function(e,t,r,n){if(void 0===r&&(r=null),void 0===n&&(n=null),Object(qe.n)(this._getState(),this._currentPageId)||!this._getEventManager())this._logTraceFailureForProcessEvent(t,e,e);else switch(e){case"runOnProcessChange":this._dispatch(this._getEventManager().runOnProcessChange(this.getContextToken(),this));break;case"runOnProcessStatusChange":this._dispatch(this._getEventManager().runOnProcessStatusChange(this.getContextToken(),V.a[n],this));break;case"runOnStageChange":this._dispatch(this._getEventManager().runOnStageChange(this.getContextToken(),this,r));break;case"runOnStageSelected":this._dispatch(this._getEventManager().runOnStageSelected(this.getContextToken(),this))}},e.prototype.executePreEvent=function(e,t,r,n){void 0===r&&(r=null),void 0===n&&(n=null);var i=!1;if(!Object(qe.n)(this._getState(),this._currentPageId)&&this._getEventManager()){switch(e){case"runOnPreProcessStatusChange":i=this._dispatch(this._getEventManager().runOnPreProcessStatusChange(this.getContextToken(),V.a[n],this));break;case"runOnPreStageChange":i=this._dispatch(this._getEventManager().runOnPreStageChange(this.getContextToken(),this,r))}return this._logTraceInfoForProcessPreEvent(i,e,t,t),i}return this._logTraceFailureForProcessEvent(t,e,e),i},e.prototype._saveFormDataAndActiveStage=function(e,t,r){var n=this,i=st.startStopwatch({processId:m.a.toString(this.getProcessId()),processInstanceId:m.a.toString(this.getProcessInstanceId())}),a=this.executePreEvent("runOnPreStageChange",r,t),o=Object(ge.c)(this._getState(),this.getCurrentFormEntity());if(!a){var s=new Promise((function(t,i){if(!e)return i(new U("Attemping to save invalid stage id"));for(var a,s,c=["traversedpath","activestageid","activestagestartedon","completedon"],l=n.getNavigationEntities(),u=Object(f.b)(n._getState(),n._currentBpfInstance),d=0,p=l;d<p.length;d++){var h=p[d];for(var m in u)if(m.includes(h.entityLogicalName)){c.push(m);break}}if(n._shouldPerformFormSave()){var b=n._getState();a=n._validateSnapshot(o).then((function(){return n._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(r)})).then((function(){return s=n._createActiveStageSnapshot(e),n._saveFormEntityAndBPFEntitySnapshots(s,o,!1)})).then((function(){var e=n.getCurrentFormEntity();n._dispatch(Object(rt.a)(n._currentPageId,b,n.getContextToken(),e.etn,e.id))})).catch((function(e){var t=Object(g.c)(e);return n._handleDuplicateDetection(t,s)}))}else a=n._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(r).then((function(){return s=n._createActiveStageSnapshot(e),n._dispatch(Object(le.c)(s,!0,c,n._getRetrieveProcessControlDataRequest())).then((function(){n._dispatch(Object(ue.a)(n._currentPageId,n.getCurrentFormEntity(),n._getColumnsToRefresh(),n._getRetrieveProcessControlDataRequest())),n._dispatch(Object(O.b)(!0,n._currentFormEntity))}))}));t(a)})).then((function(){var e=n.getTraversedPath(),i=n.getActiveStageId();n._updateGlobalActiveStage(e,i),n.setSelectedStage(i),n._executePostEvent("runOnStageChange",r,t)}),(function(e){throw n._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(e),e}));return s.then(c,c),s}function c(){i()}},e.prototype._handleDuplicateDetection=function(e,t){var r=this;if(Object(tt.e)(e))return this._dispatch(Object($e.a)(this._currentPageId,e,this._currentFormEntity)).then((function(e){return 0===e.status?r._dispatch(Object(et.a)(e.pageId)).then((function(e){return e.value.param_lastButtonClicked===u.a?Promise.resolve("success"):Promise.resolve("aborted")})):Promise.resolve("noop")})).then((function(e){if("success"===e){var n=Object(ge.c)(r._getState(),r.getCurrentFormEntity());return r._saveFormEntityAndBPFEntitySnapshots(t,n,!0)}}));throw e},e.prototype._saveFormEntityAndBPFEntitySnapshots=function(e,t,r){var n={};n[t.identifier.etn]=this._getColumnsToRefresh();var i=null;return i=this.isImmersiveBPF()?[t.snapshotId]:[t.snapshotId,e],this._dispatch(Object(le.d)(i,r,n,this._getRetrieveProcessControlDataRequest()))},e.prototype._logTraceInfoForProcessPreEvent=function(e,t,r,n){var i=this._applicationContext.TraceManager.getTracer(n),a=this.getTelemetryParams(),o={name:"BpfOperationName",value:r};a.push(o);var s={name:"eventName",value:t};a.push(s);var c={name:"preventDefaultInvokedByWebResource",value:e};a.push(c),i.info("BPF ProcessManager executed scripts registered to event "+t,a)},e.prototype._logTraceFailureForProcessEvent=function(e,t,r){var n=this._applicationContext.TraceManager.getTracer(r),i=this.getTelemetryParams(),a={name:"BpfOperationName",value:e};i.push(a);i.push({name:"preventDefaultInvokedByWebResource",value:null});var o={name:"eventName",value:t};i.push(o);var s={name:"isPageDead",value:Object(qe.n)(this._getState(),this._currentPageId)};i.push(s);var c={name:"currentPageId",value:this._currentPageId};i.push(c),n.error("BPF ProcessManager not able to to execute scripts registered on event "+t+" does not exist",i)},e.prototype._logTraceFailureForScriptContainer=function(){var e=this._applicationContext.TraceManager.getTracer("GET_SCRIPT_CONTAINER"),t=this.getTelemetryParams();t.push({name:"BpfOperationName",value:"GetScriptContainer"});var r={name:"IsPageDead",value:Object(qe.n)(this._getState(),this._currentPageId)};t.push(r);t.push({name:"IsSciptContainerAvailable",value:!1}),e.error("BPF ProcessManager not able to to execute scripts as the script container does not exist",t)},e.prototype._getStage=function(e){var t=this,r=null;if(e){var n=this.getEntityStages();n&&n.some((function(n){for(var i=0;i<n.get_Steps().get_Count();i++){var a=n.get_Steps().get_item(i);if(t._equalsIgnoreCase(e,a.get_Id()))return r=a,!0}}))}return r},e.prototype.getContextToken=function(){return Object(he.j)(this._getState(),this._currentPageId)},e.prototype._updateProcessInstanceModifiedTime=function(){this._dispatch(Object(ie.b)(this.getCurrentFormEntity()))},e.prototype._isSelectedStageControl=function(e){if(!Object(Ce.a)(this.getSelectedStage()))for(var t=this.getSelectedStage().get_Steps(),r=0;r<t.get_Count();r++)if(this._equalsIgnoreCase(t.get_item(r).get_Id(),e))return!0;return!1},e.prototype._equalsIgnoreCase=function(e,t){return!!e&&!!t&&e.toUpperCase()===t.toUpperCase()},e.prototype._getSnapshotStateTelemetryParams=function(e){var t=[];if(Object(Ce.a)(e))return t;var r={name:"mode",value:e.mode},n={name:"identifierId",value:Object(Ce.a)(e.identifier)||Object(Ce.a)(e.identifier.id)?null:m.a.toString(e.identifier.id)},i=this._applicationContext.DataSource.get_MetadataCache().getEntityMetadata(e.identifier.etn),a={name:"identifierEntityId",value:Object(Ce.a)(i)?null:m.a.fromLegacyGuid(i.get_id()).guid},o={name:"identifierEntityObjectTypeCode",value:Object(Ce.a)(i)?null:i.get_objectTypeCode()},s={name:"activeChanges",value:Object(Ce.a)(i)?null:this._getIFieldValuesString(e.activeChanges,i.get_logicalName())},c={name:"lockedChanges",value:Object(Ce.a)(i)?null:this._getIFieldValuesString(e.lockedChanges,i.get_logicalName())};return t.push(r),t.push(a),t.push(o),t.push(n),t.push(s),t.push(c),t},e.prototype._getTelemetryParamsForActionStep=function(e,t,r){var n=this.getTelemetryParams(),i={name:"ActionStepType",value:e},a={name:"ControlId",value:t},o={name:"ActionStepId",value:r};return n.push(i),n.push(a),n.push(o),n},e.prototype.getTelemetryParams=function(){var e=[];try{var t={name:"ProcessId",value:m.a.toString(this.getProcessId())},r={name:"ProcessInstanceId",value:m.a.toString(this.getProcessInstanceId())},n={name:"ActiveStageId",value:this.getActiveStageId()},i={name:"SelectedStageId",value:this.getSelectedStageId()},a={name:"TraversedPath",value:this.getTraversedPath()},o={name:"ActivePath",value:this._getActivePathString()},c={name:"CurrentFormEntityType",value:this.getCurrentFormEntity()&&this.getCurrentFormEntity().etn?this.getCurrentFormEntity().etn:""},l={name:"CurrentFormEntityId",value:this.getCurrentFormEntity()&&this.getCurrentFormEntity().id?m.a.toString(this.getCurrentFormEntity().id):""},u={name:"ProcessState",value:this.getProcessState()},d={name:"PageId",value:this._currentPageId},p={name:"PageType",value:Object(s.l)(this._getState(),this._currentPageId)},h={name:"SavedPageId",value:this._savedPageId},g={name:"SavedPageType",value:Object(s.l)(this._getState(),this._savedPageId)};if(Object(Le.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){var f={name:"CustomControlsPresent",value:this.getCustomControlIndicator()},b={name:"RenderedFromFormXML",value:this.getFormXmlRenderingIndicator()};e.push(f),e.push(b)}var y={name:"IsImmersiveBPF",value:this.isImmersiveBPF()};e.push(t),e.push(r),e.push(n),e.push(a),e.push(o),e.push(i),e.push(c),e.push(l),e.push(u),e.push(d),e.push(p),e.push(h),e.push(g),e.push(y)}catch(t){this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ProcessManagerTelemetryGeneration").error("Exception while generating Process Manager telemetry parameters: "+t.message,e)}return e},e.prototype._getIFieldValuesString=function(e,t){var r="";if(!Object(Ce.a)(e))for(var n in e)if(Object(Ce.a)(n))r+=String.format("[fieldName: {0}]",null);else{var i=this._applicationContext.DataSource.get_MetadataCache().getAttributeMetadata(t,n),a=e[n];if(Object(Ce.a)(a)||Object(Ce.a)(i))r+=String.format("[attributeId is null: {0}, attributeMetadata is null: {1}]",Object(Ce.a)(a),Object(Ce.a)(i));else{var o="";Object(Ce.a)(a.timestamp)||(o=a.timestamp.toUTCString());var s="",c="",l=null,u=null;Object(Ce.a)(a.validationResult)||(s=a.validationResult.errorId,c=a.validationResult.errorMessage,l=a.validationResult.isOfflineSyncError,u=a.validationResult.isValueValid);var d=i.get_id();r+=String.format("[attributeId: {0}, timeStamp: {1}, validationResultErrorId: {2}, validationResultErrorMessage: {3}, validationResultIsOfflineSyncError: {4}, validationResultIsValueValid: {5}]",d,o,s,c,l,u)}}return r},e.prototype._getActivePathString=function(){var e=this.getActivePath(),t="";if(e&&e.length>0){for(var r=0;r<e.length-1;r++)t=t+e[r].guid+",";t+=e[e.length-1].guid}return t},e.prototype.isImmersiveBPF=function(){return this.getCurrentFormEntity()&&this._currentBpfInstance&&this.getCurrentFormEntity().etn===this._currentBpfInstance.etn},e.prototype._getColumnsToRefresh=function(){var e=Object(Qe.b)(this._getState(),this._currentPageId),t=Object(s.g)(this._getState(),this._currentPageId);if(Object(Ce.a)(t)){var r=Object(ge.c)(this._getState(),this.getCurrentFormEntity()),n=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SaveAndRefresh"),i=this._getSnapshotStateTelemetryParams(r);return n.warn("Columns To Refresh is not set as PageInput is null. Primary entity not refreshed after save",i),[]}var a=Object(ke.E)(this._getState(),t.entityTypeName),o=Object(u.g)(this._getState(),e,t,a,null);return o&&o.hasOwnProperty(t.entityTypeName)?o[t.entityTypeName]:[]},e.prototype._getRetrieveProcessControlDataRequest=function(){var e=this.getProcessId()&&!m.a.equals(this.getProcessId(),m.a.EMPTY)?$.a.toLegacyEntityReference(new $.a("businessprocessflowinstance",this.getProcessId())):null,t=this.getProcessInstanceId()&&!m.a.equals(this.getProcessInstanceId(),m.a.EMPTY)?$.a.toLegacyEntityReference(new $.a("businessprocessflowinstance",this.getProcessInstanceId())):null;return this.getCurrentFormEntity()&&e&&t?new He.a($.a.toLegacyEntityReference(this.getCurrentFormEntity()),e,t):this.getCurrentFormEntity()?new He.a($.a.toLegacyEntityReference(this.getCurrentFormEntity()),null,null):null},e.prototype.getCustomControlIndicator=function(){return this._customControlsPresent},e.prototype.setCustomControlIndicator=function(e){this._customControlsPresent=e},e.prototype.getFormXmlRenderingIndicator=function(){return this._renderedFromFormXml},e.prototype.setFormXmlRenderingIndicator=function(e){this._renderedFromFormXml=e},e.prototype.getInstanceModifiedTimestamp=function(){return this._instanceModifiedTimestamp},e.prototype.isBpfFormDescriptorValid=function(e,t,r,n){return null===this._isBpfFormValid&&(this._isBpfFormValid=Object(Ze.f)(e,t,r,n)),this._isBpfFormValid},e.prototype._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure=function(e,t){var r=t;if(Object(Ce.a)(t)){var n=Object(g.c)(e);r=!Object(Ce.a)(n)&&n.FaultedSnapshotId}!Object(Ce.b)(r)&&this._dispatch(Object(ce.b)(r,!1));var i=Object(ge.c)(this._getState(),this.getCurrentFormEntity());i&&!Object(Ce.a)(i.snapshotId)&&i.snapshotId!==r&&this._dispatch(Object(ce.b)(i.snapshotId,!1))},e}()},"4Q7K":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="dataset.set.newPageRequested";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r){var a=Object(n.y)(t),o=Object(n.v)(t);return{type:i,payload:r,meta:{pageId:e,contextKey:a,dataSetContextKey:o}}}},"52Se":function(e,t,r){"use strict";r.d(t,"a",(function(){return St}));var n,i=r("c/eZ"),a=r("7z0H"),o=r("9r0m"),s=r("Qeyq"),c=r("s0Zj"),l=r("ksD2"),u=r("A8fJ"),d=r("PLtI"),p=r("ASFs"),h=Object(p.d)(((n={})[c.a]=function(e,t){return Object(i.__assign)(Object(i.__assign)({},e),{collapsed:t.payload})},n[l.a]=function(e,t){return Object(i.__assign)(Object(i.__assign)({},e),{visible:t.payload})},n[u.a]=function(e,t){return Object(i.__assign)(Object(i.__assign)({},e),{contentType:t.payload})},n[d.a]=function(e,t){return Object(i.__assign)(Object(i.__assign)({},e),{label:t.payload})},n),{collapsed:!1,visible:!0,label:"",sectionNames:[],domId:null,showLabel:!0,contentType:"cardSections"});var g,m=r("JCHT"),f=r("OmYs"),b=Object(p.d)(((g={})[m.a]=function(e,t){return Object(i.__assign)(Object(i.__assign)({},e),{visible:t.payload})},g[f.a]=function(e,t){return Object(i.__assign)(Object(i.__assign)({},e),{label:t.payload})},g),{parentTabId:null,visible:!0,label:"",controlNames:[],domId:null,semanticZoomDomId:null});var y,v=r("l9yF"),_=r("LteD"),S=r("jT7O"),O=r("kr+h"),C=r("QItn"),I=r("hE7j"),j=r("Q60c"),P=r("n1Ju"),F=r("slAZ"),T=r("tNVD"),w=r("x6Ak");var E=Object(p.d)(((y={})[_.a]=function(e,t){return Object(i.__assign)(Object(i.__assign)({},e),{visible:t.payload})},y[S.a]=function(e,t){return Object(i.__assign)(Object(i.__assign)({},e),{label:t.payload,labelSource:v.a.ClientAPI})},y[O.a]=function(e,t){return null!==t.payload?Object(i.__assign)(Object(i.__assign)({},e),{disabledByClientApi:t.payload}):e},y[I.a]=function(e,t){var r=Object(i.__assign)(Object(i.__assign)({},e.parameters),t.payload);return Object(i.__assign)(Object(i.__assign)({},e),{parameters:r})},y[j.a]=function(e,t){var r=Object(i.__assign)(Object(i.__assign)({},e.parameters),{defaultviewid:t.payload});return Object(i.__assign)(Object(i.__assign)({},e),{parameters:r})},y[T.a]=function(e,t){var r=Object(i.__assign)(Object(i.__assign)({},e.views),t.payload.views);return Object(i.__assign)(Object(i.__assign)({},e),{views:r})},y[F.a]=function(e,t){for(var r=e.customFilter?e.customFilter:[],n=r.length-1;n>=0;n--)if(r[n].entityLogicalName===t.payload.entityLogicalName){if(r[n].customFilter===t.payload.customFilter)return e;break}return r.push(t.payload),Object(i.__assign)(Object(i.__assign)({},e),{customFilter:r})},y[F.c]=function(e,t){var r=[];return r.push({customFilter:"START_FLAG",entityLogicalName:""}),Object(i.__assign)(Object(i.__assign)({},e),{customFilter:r})},y[F.b]=function(e,t){var r=e.customFilter?e.customFilter:[];if(r.length>0&&"END_FLAG"===r[r.length-1].customFilter)return e;return r.push({customFilter:"END_FLAG",entityLogicalName:""}),Object(i.__assign)(Object(i.__assign)({},e),{customFilter:r})},y[P.a]=function(e,t){if(t.payload)return Object(i.__assign)(Object(i.__assign)({},e),{notifications:Object(i.__assign)(Object(i.__assign)({},e.notifications),t.payload)});return Object(i.__assign)(Object(i.__assign)({},e),{notifications:t.payload})},y[C.a]=function(e,t){var r=[].concat(e.parameters),n=e;null!==t.payload&&(r.DisableMru=t.payload?"true":"false",n=Object(i.__assign)(Object(i.__assign)({},n),{parameters:r}));return n},y[w.a]=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){return Object(i.__assign)({},e)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */,y[T.d]=function(e,t){return Object(i.__assign)(Object(i.__assign)({},e),{initializationIntent:t.payload})},y),{parentSectionName:null,visible:!0,label:"",valid:!0,domId:null,notifications:null,dataFieldName:null});var x,N=r("c7nC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function A(e,t,r){var n=Object(i.__assign)({},e),a=Object.keys(n).length,o={};return r?(n.hasOwnProperty(t)&&delete n[t],Object(i.__assign)({},n)):a>0?n.hasOwnProperty(t)?n:(o[t]=!0,Object(i.__assign)(Object(i.__assign)({},e),o)):(o[t]=!0,o)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var k=Object(p.d)(((x={})[N.a]=function(e,t){return Object(i.__assign)({},A(e,t.meta.controlName,t.payload.isValid))},x),{});var M,D=r("3NtJ"),R=r("fTYK"),B=r("VlhU"),L=r("c3W+"),V=r("UOUy"),z=r("0MLN"),G=r("EGdP"),W=r("zvr0"),H=Object(p.d)(((M={})[W.a]=function(e,t){return Object(i.__assign)({},t.payload.controlUnboundOutputs)},M),{});var U,q=r("n4BT"),X=r("enCe"),K=r("+ulc"),Q=r("hCnb"),Y=Object(p.d)(((U={})[Q.a]=function(e,t){return Object(i.__assign)({},A(e,t.meta.attributeName,t.payload.isValid))},U),{});var Z=r("lwSE"),J=r("SdPQ"),$=r("e2rP"),ee=r("uCYK");var te={tabs:Object(p.b)("tabId",h),sections:Object(p.b)("sectionName",b),controls:Object(p.b)("controlName",E),selectedTab:function(e,t){if(void 0===e&&(e=Object(s.a)()),t.type===R.a){if(e.navigationStack&&e.navigationStack.length>0)return Object(i.__assign)(Object(i.__assign)({},e),{tabId:e.navigationStack[e.navigationStack.length-1],navigationStack:e.navigationStack.slice(0,e.navigationStack.length-1)})}else if(t.type===D.a){var r=(e.navigationStack||[]).slice(0);return e.tabId&&e.tabId!==t.payload&&r.push(e.tabId),Object(i.__assign)(Object(i.__assign)({},e),{tabId:t.payload,navigationStack:r})}return e},selectedRelatedEntity:function(e,t){return void 0===e&&(e=null),t.type===B.a?t.payload:e},xrmReady:function(e,t){return void 0===e&&(e=!1),t.type===a.b?t.payload.xrmReady:e},isSaving:function(e,t){return void 0===e&&(e=!1),t.type===L.a?t.payload.savingState:e},controlUnboundOutputs:H,inlineQuickForms:function(e,t){return void 0===e&&(e=null),t.type===a.a?t.payload.formUIState.inlineQuickForms:e},invalidControls:k,invalidAttributes:Y,label:function(e,t){return void 0===e&&(e=""),t.type===z.a?t.payload.label:e},hasOfflineChanges:function(e,t){return void 0===e&&(e=!1),t.type===V.a?t.payload.hasOfflineChanges:e},viewportWidth:function(e,t){return void 0===e&&(e=0),t.type===q.a?t.payload.viewportWidth:e},viewportHeight:function(e,t){return void 0===e&&(e=0),t.type===q.a?t.payload.viewportHeight:e},formId:function(e,t){return void 0===e&&(e=o.a.EMPTY),e},showHeaderFieldsInSection:function(e,t){return void 0===e&&(e=!1),t.type===X.a?t.payload.showHeaderFieldsInSection:e},headerFieldsInFlyout:function(e,t){if(t.type===K.a){for(var r=new Set,n=t.payload.headerFieldsInFlyout,i=0;i<n.length;i++)r.add(n[i].Name);return r}return e},isAutoSaving:function(e,t){return void 0===e&&(e=!1),t.type===G.a?t.payload.isAutoSaving:e},header:function(e,t){switch(void 0===e&&(e=null),null==e&&(e={bodyVisible:!0,commandBarVisible:!0,tabNavigatorVisible:!0}),t.type){case J.a:return Object(i.__assign)(Object(i.__assign)({},e),{bodyVisible:t.payload});case $.a:return Object(i.__assign)(Object(i.__assign)({},e),{commandBarVisible:t.payload});case Z.a:return Object(i.__assign)(Object(i.__assign)({},e),{tabNavigatorVisible:t.payload})}return e},footer:function(e,t){switch(void 0===e&&(e=null),null==e&&(e={visible:!0}),t.type){case ee.a:return Object(i.__assign)(Object(i.__assign)({},e),{visible:t.payload})}return e},formScrollAndFocusState:function(e,t){return t.type===T.e?t.payload:e}},re=Object(p.a)(te),ne=Object(p.b)("contextKey",re),ie=r("g24L"),ae=r("kk/C"),oe=r("d/U0");var se,ce={snapshotId:ie.a,updatedFields:
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){if(t.type===ae.a){var r={},n=t.payload.fieldValues;if(!n)return e;for(var a in n)e&&e.hasOwnProperty(a)||(r[a]=n[a]);return Object.keys(r).length>0?Object(i.__assign)(Object(i.__assign)({},e),r):e}if(t.type===ae.b){r={};if(t.payload.keepFields)for(var o=0,s=t.payload.keepFields;o<s.length;o++){e[a=s[o]]&&(r[a]=e[a])}return r}return e},isDeleted:function(e,t){return void 0===e&&(e=!1),t.type===oe.a?t.payload:e}},le=Object(p.a)(ce),ue=Object(p.b)("contextKey",le),de=r("/wtJ"),pe=r("FuJ2"),he=r("ABRM"),ge=r("YdIa"),me=r("JFej"),fe=r("Ini7"),be=r("FGem"),ye=r("E0SJ"),ve=r("NuVc"),_e=r("xirW"),Se=Object(p.d)(((se={})[de.a]=function(e,t){return Object(i.__assign)(Object(i.__assign)({},e),{Precision:t.payload,PrecisionSource:ve.a.attribute})},se[pe.a]=function(e,t){return Object(i.__assign)(Object(i.__assign)({},e),{RequiredLevel:t.payload})},se[he.a]=function(e,t){return Object(i.__assign)(Object(i.__assign)({},e),{Format:t.payload})},se[ge.a]=function(e,t){return Object(i.__assign)(Object(i.__assign)({},e),{Targets:t.payload})},se[me.a]=function(e,t){var r=e.OptionSet,n=t.payload.option;if(!r||!n)return e;var a=t.payload.index;r=r.slice(0),a>=0&&a<r.length?r.splice(a,0,n):r.push(n);return Object(i.__assign)(Object(i.__assign)({},e),{OptionSet:r})},se[fe.a]=function(e,t){var r=e.OptionSet;if(!r)return e;var n=t.payload;r=r.slice(0);for(var a=0;a<r.length;a++)if(r[a].Value===n)return r.splice(a,1),Object(i.__assign)(Object(i.__assign)({},e),{OptionSet:r});return e},se[be.a]=function(e,t){if(!e.OptionSet)return e;return Object(i.__assign)(Object(i.__assign)({},e),{OptionSet:[]})},se[ye.a]=function(e,t){if(!e.OptionSet)return e;var r=t.payload;return Object(i.__assign)(Object(i.__assign)({},e),{OptionSet:r||[]})},se[_e.a]=function(e,t){if(t.payload)return Object(i.__assign)(Object(i.__assign)({},e),{notifications:Object(i.__assign)(Object(i.__assign)({},e.notifications),t.payload)});return Object(i.__assign)(Object(i.__assign)({},e),{notifications:t.payload})},se),{Precision:null,PrecisionSource:null,RequiredLevel:null,Format:null,OptionSet:null,IsValidForCreate:null,IsValidForUpdate:null,notifications:null,Targets:null});var Oe,Ce=r("5jMY"),Ie=r("o0+l"),je=Object(p.d)(((Oe={})[Ie.a]=function(e,t){var r;if(t.payload===Ce.a.Dirty){var n={};if(t.meta.dataFieldName&&Object.keys(e).lastIndexOf(t.meta.dataFieldName)>-1){for(var a=0,o=Object.keys(e);a<o.length;a++){var s=o[a];s!==t.meta.dataFieldName&&(n[s]=e[s])}return Object.freeze(n)}return e}return Object(i.__assign)(Object(i.__assign)({},e),((r={})[t.meta.dataFieldName]=t.payload,r))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */,Oe),{});var Pe,Fe={attributes:Object(p.b)("dataFieldName",Se),submitModes:je},Te=Object(p.a)(Fe),we=Object(p.b)("contextKey",Te),Ee=r("LFYt"),xe=r("Uhhf"),Ne=Object(p.d)(((Pe={})[Ee.a]=function(e,t){return Object(i.__assign)(Object(i.__assign)({},e),{value:t.payload.value})},Pe[xe.a]=function(e,t){return Object(i.__assign)(Object(i.__assign)({},e),{value:t.payload.value})},Pe),{reason:"",value:""});var Ae,ke=r("rQCE"),Me=r("LiB6"),De=r("dWLV"),Re=r("PhZR"),Be=r("YOvo"),Le=r("VQYK");var Ve=Object(p.d)(((Ae={})[Re.a]=function(e,t){var r=Object(i.__assign)({},e);return ze(r,t.payload.label,t.payload.currentLanguageId),r.labelSetByClientAPI=!0,Object.freeze(r)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */,Ae[Be.a]=function(e,t){var r=t.payload;return Object.freeze(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},e),r),{showSetByClientAPI:!0}))},Ae),{titles:{},tooltipTitles:{},privileges:[],relationshipName:"",id:"",area:"",titleResourceId:"",client:"",availableOffline:!1,icon:"",sequence:"",show:!0,viewId:""});function ze(e,t,r){var n=Object(Le.b)(e,r);if(n)n.Value=t;else{var i=null===r?"":r.toString();e.titles[""]={Name:i,Value:t}}return e}var Ge=Object(p.d)({},{}),We=Object(p.d)({},{}),He=Object(p.d)({},{}),Ue=r("jWor"),qe=Object(p.b)("navigationItemId",Ve);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Xe,Ke={navBarAreas:Ge,navPaneIsvItems:We,navBarByRelationshipItems:function(e,t){if(t.type===Ue.a){if(t.payload.allNavBarByRelationshipItems&&t.payload.allNavBarByRelationshipItems.length>0){var r=Object(i.__assign)({},e);return t.payload.allNavBarByRelationshipItems.forEach((function(e){e&&e.id&&(r[e.id]||(r[e.id]=Object(i.__assign)(Object(i.__assign)({},{titles:{},tooltipTitles:{},privileges:[],relationshipName:"",id:"",area:"",titleResourceId:"",client:"",availableOffline:!1,icon:"",sequence:"",show:!0,viewId:""}),{id:e.id})),ze(r[e.id],e.title,t.payload.currentLanguageId))})),Object.freeze(r)}return e}return qe(e,t)},navBarItems:He},Qe=Object(p.a)(Ke),Ye=r("+ieV"),Ze=r("2p2B"),Je=Object(p.d)(((Xe={})[Ye.a]=function(e,t){var r,n={Message:t.payload.message,Level:t.payload.level,UniqueId:t.payload.uniqueId,Buttons:t.payload.buttons,MessagePlaceholders:t.payload.placeholders,ControlName:t.payload.controlName,ComponentId:t.payload.componentId};return Object(i.__assign)(Object(i.__assign)({},e),((r={})[t.payload.uniqueId]=n,r))},Xe[Ze.a]=function(e,t){if(Object.keys(e).length<1)return e;var r={};if(t.payload.uniqueId)for(var n=0,i=Object.keys(e);n<i.length;n++){var a=i[n];a!==t.payload.uniqueId&&(r[a]=e[a])}return r},Xe),{});var $e,et=r("KbPJ"),tt=r("/CqC"),rt=Object(p.d)((($e={})[et.a]=function(e,t){if(t.type===et.a)return Object(i.__assign)(Object(i.__assign)({},e),t.payload);return e},$e[tt.a]=function(e,t){var r=Object(i.__assign)({},e);return delete r[t.payload.relationship],Object.freeze(r)},$e),{});var nt=r("NWJ/"),it=r("I6xF"),at=r("+hGu"),ot=r("ApiM"),st=r("NfcN"),ct=r("VHYb"),lt=r("bCrZ"),ut=r("UOiB"),dt=r("Sscr"),pt=r("oUmu"),ht=r("Axwz"),gt=r("vm7t"),mt=r("gRWC"),ft={selectedFormId:null,forms:{}},bt=r("Gt1u"),yt=r("9KTg");var vt=r("bhC+");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var _t=Object(p.a)({loadingState:function(e,t){return void 0===e&&(e=ke.a.Initial),t.type===nt.a?t.payload:e},formId:function(e,t){return void 0===e&&(e=null),t.type===a.a?t.payload.formId:e},navigation:Qe,notifications:Je,powerBISignedInState:function(e,t){return void 0===e&&(e="NotSignedIn"),t.type===it.a?t.payload:e},suppressDuplicateDetection:function(e,t){return void 0===e&&(e=!1),t.type===at.a?t.payload.suppressDuplicateDetection:e},customDataProviderOutputs:Me.a,formlessControlOutputs:De.a,output:Ne,datasets:ct.a,metadata:we,records:ue,forms:ne,entityReferenceByRelationship:rt,referenceInformationByRelationship:function(e,t){return void 0===e&&(e={}),t.type===st.a?t.payload:e},primaryEntity:function(e,t){return void 0===e&&(e=""),"set.primary.entity"===t.type?t.payload:e},visitedTabNames:function(e,t){if(void 0===e&&(e=null),t.type===ht.a){var r=t.payload;if(!e)return r?new Set([r]):null;if(!r||e.has(r))return new Set(e);var n=new Set(e);return n.add(r),n}return e},autoSaveInterval:function(e,t){return void 0===e&&(e=gt.a),t.type===gt.d?e=gt.a:t.type===gt.b&&e<gt.c&&(e+=gt.a),e},formInstances:function(e,t){var r,n;if(void 0===e&&(e={list:[],formInstanceIdByControlName:{},controlNameByFormInstanceId:{}}),t.type===T.b){var a=t.payload.formInstanceId,o=t.payload.controlName,s=Object(i.__spreadArrays)(e.list,[a]),c=Object(i.__assign)(Object(i.__assign)({},e.formInstanceIdByControlName),((r={})[o]=a,r)),l=Object(i.__assign)(Object(i.__assign)({},e.controlNameByFormInstanceId),((n={})[a]=o,n));e=Object(i.__assign)(Object(i.__assign)({},e),{list:s,formInstanceIdByControlName:c,controlNameByFormInstanceId:l})}else if(t.type===T.g){var u=t.payload.formInstanceId;o=t.payload.controlName,s=e.list.filter((function(e){return e!==u}));if(e.formInstanceIdByControlName[o]&&e.controlNameByFormInstanceId[u]){var d=o,p=e.formInstanceIdByControlName,h=d,g=(p[h],c=Object(i.__rest)(p,["symbol"==typeof h?h:h+""]),u),m=e.controlNameByFormInstanceId,f=g;m[f],l=Object(i.__rest)(m,["symbol"==typeof f?f:f+""]);e=Object(i.__assign)(Object(i.__assign)({},e),{list:s,formInstanceIdByControlName:c,controlNameByFormInstanceId:l})}}return e},formSelector:function(e,t){var r;return void 0===e&&(e=ft),t.type===mt.a?Object(i.__assign)(Object(i.__assign)({},e),{forms:Object(i.__assign)(Object(i.__assign)({},e.forms),(r={},r[t.meta.formId]={visible:t.payload.visible},r))}):t.type===vt.a?Object(i.__assign)(Object(i.__assign)({},e),{selectedFormId:t.payload.formId}):e},parentComponentId:function(e,t){return void 0===e&&(e=""),t.type===T.c?t.payload.parentComponentId:e},referencePanel:function(e,t){switch(void 0===e&&(e={sessionTabs:[],controlNames:[],activeTabId:"",messageId:""}),t.type){case yt.a:return t.payload.messageId?Object.freeze(Object(i.__assign)(Object(i.__assign)({},e),{sessionTabs:t.payload.sessionTabs,activeTabId:t.payload.activeTabId,messageId:t.payload.messageId})):Object.freeze(Object(i.__assign)(Object(i.__assign)({},e),{sessionTabs:t.payload.sessionTabs,activeTabId:t.payload.activeTabId}));case yt.d:case yt.c:return Object.freeze(Object(i.__assign)(Object(i.__assign)({},e),{sessionTabs:t.payload.sessionTabs,activeTabId:t.payload.activeTabId}));case yt.e:return Object.freeze(Object(i.__assign)(Object(i.__assign)({},e),{messageId:t.payload.messageId}));case yt.g:return Object.freeze(Object(i.__assign)(Object(i.__assign)({},e),{sessionTabs:t.payload.sessionTabs,controlNames:t.payload.controlNames,activeTabId:t.payload.activeTabId}));case yt.f:return Object.freeze(Object(i.__assign)(Object(i.__assign)({},e),{controlNames:t.payload.controlNames,activeTabId:t.payload.activeTabId}));case yt.b:return Object.freeze({sessionTabs:[],controlNames:[],activeTabId:"",messageId:""});case yt.h:return Object.freeze(Object(i.__assign)(Object(i.__assign)({},e),{sessionTabs:t.payload.sessionTabs}));default:return e}},formLoadError:function(e,t){return void 0===e&&(e=null),t.type===bt.a?t.payload.error:e}});function St(e,t){var r,n,o,s,c,l,u;if(void 0===e){var d=_t(e,t);return Object.freeze(d)}if(t.type===a.a){var p=t.meta.contextToken,h=Ot(P=Object(dt.v)(p)),g=e.forms[P],m=O=e.metadata;t.payload.relatedEntityMetadataState&&(m=Object.assign.apply(Object,Object(i.__spreadArrays)([{},m],[t.payload.relatedEntityMetadataState])));var f=Object(i.__assign)(Object(i.__assign)({},e.forms),((r={})[P]=Object(i.__assign)(Object(i.__assign)({},g),t.payload.formUIState),r));m=Object(i.__assign)(Object(i.__assign)({},m),((n={})[P]=Object(i.__assign)(Object(i.__assign)({},m[P]),t.payload.formMetadataState),n));var b=Object(i.__assign)(Object(i.__assign)({},e.navigation),f&&p.contextTokenType===ut.a.MainForm?f[P].navigation:e.navigation);if(b.navBarByRelationshipItems){var y=b.navBarByRelationshipItems;b.navBarByRelationshipItems={};for(var v=Object.keys(y),_=0;_<v.length;_++){var S=v[_];b.navBarByRelationshipItems[S]=Object(Le.a)(y[S],t.payload.currentLanguageId)}}u=Object(i.__assign)(Object(i.__assign)({},e),{formId:t.payload.formId,forms:f,metadata:m,records:h,powerBISignedInState:"NotSignedIn",suppressDuplicateDetection:!1,navigation:b})}else if(t.type===ot.a&&e.metadata[t.meta.contextKey]){var O=e.metadata[t.meta.contextKey];u=Object(i.__assign)(Object(i.__assign)({},e),{metadata:Object(i.__assign)(Object(i.__assign)({},e.metadata),(o={},o[t.meta.contextKey]=Object(i.__assign)(Object(i.__assign)({},O),{attributes:Object(i.__assign)(Object(i.__assign)({},null==O?void 0:O.attributes),t.payload.attributes)}),o))})}else if(t.type===ot.b){var C=e.forms[t.meta.contextKey];u=Object(i.__assign)(Object(i.__assign)({},e),{forms:Object(i.__assign)(Object(i.__assign)({},e.forms),(s={},s[t.meta.contextKey]=Object(i.__assign)(Object(i.__assign)({},C),{controls:Object(i.__assign)(Object(i.__assign)({},e.forms[t.meta.contextKey].controls),t.payload.controls)}),s))})}else if(t.type===lt.a){var I=t.payload,j=Object(i.__assign)(Object(i.__assign)({},e.datasets),((c={})[I.contextKey]=I.initialDataSetState,c));u=Object(i.__assign)(Object(i.__assign)({},e),{datasets:j})}else if(t.type===pt.a){p=t.meta.contextToken;var P=Object(dt.v)(p),F=(C=e.forms[P],Object(i.__assign)({},C)),w=C.selectedTab.tabId;if(!t.payload.formUIState.tabs[w]){var E=C.tabs[w];if(E){var x=E.domId,N=void 0;for(var A in t.payload.formUIState.tabs){if(t.payload.formUIState.tabs[A].domId===x){N=A;break}}C.selectedTab.tabId=N||""}}F.controls=t.payload.formUIState.controls,F.sections=t.payload.formUIState.sections,F.tabs=t.payload.formUIState.tabs,F.label=t.payload.formUIState.label,F.inlineQuickForms=t.payload.formUIState.inlineQuickForms,u=Object(i.__assign)(Object(i.__assign)({},e),{forms:Object(i.__assign)(Object(i.__assign)({},e.forms),(l={},l[P]=F,l))})}else if(t.type===T.h){p=t.meta.contextToken,h=Ot(P=Object(dt.v)(p));u=Object(i.__assign)(Object(i.__assign)({},e),{records:h})}else u=_t(e,t);return Object.freeze(u)}function Ot(e){var t;return(t={})[e]={snapshotId:"",isDeleted:!1},t}},"5cS+":function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return p}));var n=r("c/eZ"),i=r("9r0m"),a=r("gBKR"),o=r("r2h9"),s=r("/j9Z"),c=r("olrR"),l=r("uO/V"),u=r("/45f"),d=r("Gemh");function p(e,t,r){return{type:"datasethost.dependencies.retrieve.async",execute:function(p,g){var m=p.dispatch,f=p.getState,b=g.TraceManager.getTracer(l.z),y=l.x+".loadDataSetHostDependenciesAction";b.info("Retrieving view with ID "+i.a.toString(t)+" for "+e+" entity.");var v=Object(d.pb)(f(),e,t);return m(Object(c.a)(e,o.a.MAIN_APPLICATION_VIEW,v,t)).then((function(o){if(!o){var c="Unable to retrieve DataSetHost dependencies for the grid. Failed to retrieve view with ID "+i.a.toString(t)+" for "+e;return g.EventManager.ReportComponentFailure(y,Error(c)),Promise.reject(new s.a(u.b))}var l=h(f(),t,r);return m(Object(a.e)(l)).then((function(){var r=[{name:"entityTypeName",value:e},{name:"viewId",value:i.a.toString(t)}];return g.EventManager.ReportComponentSuccess(y,r),Promise.resolve()})).catch((function(r){var a=[];for(var o in l)l[o].length&&(a=Object(n.__spreadArrays)(l[o],a));var c="Unable to retrieve DataSetHost dependencies for the grid for view with ID "+i.a.toString(t)+". Failed to retrieve entity with attributes "+a.join()+" for "+e;return g.EventManager.ReportComponentFailure(y,Error(c)),Promise.reject(new s.a(u.a))}))}))}}}function h(e,t,r){var n=Object(d.qb)(e,t,r),i={};if(n&&n.grid&&n.grid.rows&&n.grid.rows[0]&&n.grid.rows[0].cells){var a=[];n.grid.rows[0].cells.forEach((function(e){if(!e.disableMetaDataBinding)if(e.relatedEntityName){if(e.name&&-1!==e.name.indexOf(".")){var t=e.name.split(".")[1];i[e.relatedEntityName]||(i[e.relatedEntityName]=[]),-1===i[e.relatedEntityName].indexOf(t)&&t&&i[e.relatedEntityName].push(t)}}else-1===a.indexOf(e.name)&&a.push(e.name)})),a.length>0&&(i[n.entityLogicalName]=a)}return i}},"7bez":function(e,t,r){"use strict";r.d(t,"a",(function(){return E})),r.d(t,"b",(function(){return x}));var n,i,a=r("1z64"),o=r("sOTk"),s=r("/zIU"),c=r("PZxu"),l=r("9r0m"),u=r("Wye+"),d=r("+Z9T"),p=r("Gemh"),h=r("IiPO"),g=r("HSdq"),m=r("/j9Z"),f=r("Sscr"),b=r("ezfI"),y=r("kvLG"),v=function(){function e(e,t,r,i,o){this._pageId=r,n=e,this._contextToken=t,this._controlName=i,this._gridType=o,this._clientApiExecutor=new a.a(e,"ClientApi.XrmViewSelector.",r,t,[{name:"controlName",value:i,isEventParam:!0},{name:"gridType",value:o,isEventParam:!0,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"store",value:e,isRequired:!0}])}return e.prototype.setCurrentView=function(e){var t=this;this._clientApiExecutor.executeAsync("setCurrentView",(function(r,i){return e&&e.id?n.dispatch(Object(u.a)(t._pageId,t._contextToken,t._controlName,e.id)):(i.push({name:"validationError",value:"true"}),y.a.getInstance().traceManager.getTracer(r).error("View ID is required",i),Promise.resolve())}))},e.prototype.getCurrentView=function(){var e="ClientApi.XrmViewSelector.getCurrentView";try{b.a.instance.reportCall(e);var t=Object(p.hb)(n.getState(),this._pageId,this._contextToken,this._controlName),r=null,i=null;if(t)i=t.ViewId;else if(3===this._gridType){var a={id:this._pageId},o=Object(g.fb)(n.getState(),a,this._contextToken.parentContextToken);if(!(o&&o.Controls&&o.Controls[this._controlName]&&o.Controls[this._controlName].Parameters&&o.Controls[this._controlName].Parameters.ViewId)){var s=void 0;return o?o.Controls?o.Controls[this._controlName]?o.Controls[this._controlName].Parameters?o.Controls[this._controlName].Parameters.ViewId||(s="formDescriptor.Controls[this._controlName].Parameters[propertyViewId] is null or undefined"):s="formDescriptor.Controls[this._controlName].Parameters is null or undefined":s="formDescriptor.Controls[this._controlName] is null or undefined":s="formDescriptor.Controls is null or undefined":s="formDescriptor is null or undefined",(y=h.a.getInstance().getEventParameters(this._contextToken)).push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,new m.a(s),null,y),null}i=o.Controls[this._controlName].Parameters.ViewId}if(i){if(r=Object(p.qb)(n.getState(),l.a.parse(i),this._pageId)){var c={entityType:Object(p.ob)(n.getState(),i,this._pageId),id:l.a.externalGuid(r.viewId),name:r.title};return b.a.instance.reportSuccess(e),c}var u=[];return u.push({name:"controlName",value:this._controlName}),u.push({name:"contextKey",value:Object(f.v)(this._contextToken)}),h.a.getInstance().reportFailure(e,new Error("ViewDescriptor is coming as null"),null,u),null}var d=[];return d.push({name:"controlName",value:this._controlName}),d.push({name:"contextKey",value:Object(f.v)(this._contextToken)}),h.a.getInstance().reportFailure(e,new Error("viewId is coming as null or undefined"),null,d),null}catch(t){var y;throw(y=h.a.getInstance().getEventParameters(this._contextToken)).push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,y),t}},e.prototype.isVisible=function(){var e="ClientApi.XrmViewSelector.isVisible";try{if(b.a.instance.reportCall(e),Object(d.a)(this._isVisible)){var t=Object(p.hb)(n.getState(),this._pageId,this._contextToken,this._controlName);if(t)this._isVisible=t.EnableViewPicker;else{var r={id:this._pageId},i=Object(g.fb)(n.getState(),r,this._contextToken.parentContextToken);if(!(i&&i.Controls&&i.Controls[this._controlName]&&i.Controls[this._controlName].Parameters&&i.Controls[this._controlName].Parameters.EnableViewPicker))return(a=h.a.getInstance().getEventParameters(this._contextToken)).push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,new m.a("FormDescriptor is null"),null,a),!1;this._isVisible=i.Controls[this._controlName].Parameters.EnableViewPicker}}return b.a.instance.reportSuccess(e),this._isVisible}catch(t){var a;throw(a=h.a.getInstance().getEventParameters(this._contextToken)).push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,a),t}},e}(),_=r("h82J"),S=r("fW82"),O=r("tcXs"),C=r("Cgjg"),I=r("lMVv"),j=r("r2h9"),P=r("gLMt"),F=r("qC0c"),T=r("cZkS"),w=r("Ka9P"),E=function(){function e(e,t,r,n,o,s,c,l){this._relationship=null;var u="ClientApi.XrmGridControl.constructor";e||Object(d.j)(u,"store"),t||Object(d.j)(u,"contextToken"),r||Object(d.j)(u,"pageId"),i=e,this._pageId=r,this._contextToken=t,this._controlName=l,this._isEditable=n,this._gridType=o,this._applicationContext=c,s||i.dispatch(Object(_.a)(this,r,t)),this._clientApiExecutor=new a.a(e,"ClientApi.XrmGridControl.",r,t),this._clientApiExecutor.addEventParameter({name:"controlName",value:l,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"isEditable",value:n,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"isCallFromSubgrid",value:s,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"gridType",value:o,isEventParam:!0})}return Object.defineProperty(e.prototype,"_connectedControlProps",{get:function(){return{controlName:this._controlName,id:this._pageId}},enumerable:!1,configurable:!0}),e.prototype.setFilterXml=function(e){var t=this;this._clientApiExecutor.executeAsync("setFilterXml",(function(){var r=(new Date).getTime();return i.dispatch(Object(C.b)(e,1,t._pageId,t._contextToken,r))}))},e.prototype.getFilterXml=function(){var e="ClientApi.XrmGridControl.getFilterXml";try{b.a.instance.reportCall(e);var t=Object(p.u)(i.getState(),this._pageId,this._contextToken);return b.a.instance.reportSuccess(e),t}catch(t){var r=h.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getFetchXml=function(){var e="ClientApi.XrmGridControl.getFetchXml";try{b.a.instance.reportCall(e);var t=Object(p.A)(i.getState(),this._contextToken,{id:this._pageId});return b.a.instance.reportSuccess(e),t}catch(t){var r=h.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getGrid=function(){var e="ClientApi.XrmGridControl.getGrid";try{return b.a.instance.reportCall(e),!this._grid&&this.getEntityName()&&(this._grid=new c.a(i,this._applicationContext,this._contextToken,this._pageId,this.getEntityName(),this._isEditable,this._controlName)),b.a.instance.reportSuccess(e),this._grid}catch(r){var t=h.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,r,null,t),r}},e.prototype.getViewSelector=function(){var e="ClientApi.XrmGridControl.getViewSelector";try{return b.a.instance.reportCall(e),this._viewSelector||(this._viewSelector=new v(i,this._contextToken,this._pageId,this._controlName,this._gridType)),b.a.instance.reportSuccess(e),this._viewSelector}catch(r){var t=h.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,r,null,t),r}},e.prototype.getTeamTemplateId=function(){var e="ClientApi.XrmGridControl.getTeamTemplateId";try{b.a.instance.reportCall(e);var t=null,r=i.getState();if(Object(F.c)(r,T.c))if(this.getEntityName()&&3===this._gridType){var n=Object(g.fb)(r,this._connectedControlProps,this._contextToken.parentContextToken);n&&n.Controls&&n.Controls[this._controlName]&&n.Controls[this._controlName].Parameters&&n.Controls[this._controlName].Parameters.TeamTemplateId&&(t=n.Controls[this._controlName].Parameters.TeamTemplateId)}return b.a.instance.reportSuccess(e),t}catch(t){var a=h.a.getInstance().getEventParameters(this._contextToken);throw a.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,a),t}},e.prototype.getEntityName=function(){var e=this;return this._clientApiExecutor.execute("getEntityName",(function(t,r){if(!e._entityName){if(e._entityName=Object(p.F)(i.getState(),e._pageId,e._contextToken,e._controlName),!e._entityName&&3===e._gridType){var n=Object(g.fb)(i.getState(),e._connectedControlProps,e._contextToken.parentContextToken);if(!(n&&n.Controls&&n.Controls[e._controlName]&&n.Controls[e._controlName].Parameters&&n.Controls[e._controlName].Parameters.TargetEntityType)){var a=void 0;return n?n.Controls?n.Controls[e._controlName]?n.Controls[e._controlName].Parameters?n.Controls[e._controlName].Parameters.TargetEntityType||(a="formDescriptor.Controls[this.name].Parameters[targetEntityType] is null or undefined"):a="formDescriptor.Controls[this.name].Parameters is null or undefined":a="formDescriptor.Controls[this.name] is null or undefined":a="formDescriptor.Controls is null or undefined":a="formDescriptor is null or undefined",e._clientApiExecutor.reportFailure(t,new m.a(a),r),null}e._entityName=n.Controls[e._controlName].Parameters.TargetEntityType}if(!e._entityName)return e._clientApiExecutor.reportFailure(t,new m.a("Logical name of the entity type is coming as null or undefined."),r),null}return e._entityName}))},e.prototype.refresh=function(){var e=this;this._clientApiExecutor.executeAsync("refresh",(function(){return i.dispatch(Object(u.a)(e._pageId,e._contextToken,e._controlName))}))},e.prototype.refreshRibbon=function(){var e=this;this._clientApiExecutor.executeAsync("refreshRibbon",(function(){return i.dispatch(Object(O.a)(e._pageId,Object(p.w)(i.getState(),e._pageId,e._contextToken)))}))},e.prototype.getUrl=function(e){var t="ClientApi.XrmGridControl.getUrl";try{b.a.instance.reportCall(t);var r,n=null,a=this._getCurrentView();n={entityTypeName:this.getEntityName()},a&&(n.viewType="savedquery"===a.entityType?j.b.savedview:j.b.userview,n.viewId=new l.a(a.id)),r=s.a.Grid;var o=null;if(1===e)o=i.dispatch(Object(S.a)(r,n));else{var c=Object(P.a)(i,this._pageId);o=i.dispatch(Object(S.c)(c,r,n))}return b.a.instance.reportSuccess(t),o}catch(e){var u=h.a.getInstance().getEventParameters(this._contextToken);throw u.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(t,e,null,u),e}},e.prototype.getRecordSetQueryKey=function(){var e=this;return this._clientApiExecutor.execute("getRecordSetQueryKey",(function(){return Object(p.cb)(i.getState(),e._contextToken,{id:e._pageId})}))},e.prototype.getGridType=function(){return b.a.instance.reportUsage("ClientApi.XrmGridControl.getGridType"),this._gridType},e.prototype.getRelationship=function(){var e=this;return this._clientApiExecutor.execute("getRelationship",(function(t,r){if(!e._relationship){var n=Object(p.v)(i.getState(),e._pageId,e._contextToken);if(n){var a=n.relationshipName;if(a&&(e._relationship=x(a,e.getEntityName()),n.relationshipRoleOrdinal)){var o=n.relationshipRoleOrdinal===w.a.Referencing?1:2;e._relationship.roleType=o}}else y.a.getInstance().traceManager.getTracer(t).error("Grid dataset was null",r)}return e._relationship}))},e.prototype.getParentForm=function(){var e="ClientApi.XrmGridControl.getParentForm";try{b.a.instance.reportCall(e);var t=this._contextToken&&this._contextToken.parentContextToken?i.dispatch(Object(_.b)(this._pageId,this._contextToken.parentContextToken)):null;return b.a.instance.reportSuccess(e),t}catch(t){var r=h.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getRollupType=function(){var e=this;return this._clientApiExecutor.execute("getRollupType",(function(){return Object(p.eb)(i.getState(),e._pageId,e._contextToken)}))},e.prototype._getCurrentView=function(){var e=null,t=this.getViewSelector().getCurrentView();if(t)return{entityType:e="savedquery"===t.entityType?"savedquery":"userquery",id:t.id};var r=Object(o.g)(i.getState(),this._pageId);if(r.viewType&&r.viewId){var n=r.viewId?l.a.externalGuid(r.viewId):void 0;if((e=r.viewType===j.b.savedview?"savedquery":"userquery")&&n)return{entityType:e,id:n}}return null},e}();function x(e,t){var r={};r.name=e;var n=Object(I.h)(i.getState(),t);if(n){var a=void 0;if(n.OneToManyRelationships&&n.OneToManyRelationships[e]?a=n.OneToManyRelationships[e]:n.ManyToOneRelationships&&n.ManyToOneRelationships[e]&&(a=n.ManyToOneRelationships[e]),a)r.attributeName=a.ReferencingAttribute,r.relationshipType=0,r.navigationPropertyName=a.ReferencingEntityNavigationPropertyName;else if(n.ManyToManyRelationships&&n.ManyToManyRelationships[e]){var o=n.ManyToManyRelationships[e];r.relationshipType=1,1===r.roleType?(r.attributeName=o.Entity1IntersectAttribute,r.navigationPropertyName=o.Entity1NavigationPropertyName):(r.attributeName=o.Entity2IntersectAttribute,r.navigationPropertyName=o.Entity2NavigationPropertyName)}}return r}},"7oc5":function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r("Sscr"),i=r("uO/V"),a=r("zETL"),o="grid.toggleRollupView";var s=function(e,t,r){return function(e,t,r,o){return{type:"grid.toggleRollupView.async",execute:function(s,c){var l=s.dispatch,u=c.TraceManager.getTracer(i.z),d=i.x+".toggleRollupViewAction";try{u.info("Setting Toggle value to "+t+" for the grid.");var p=Object(n.v)(o);l(function(e,t,r,n){return{type:e,payload:t,meta:{pageId:r,dataSetContextKey:n}}}(e,t,r,p)),l(Object(a.b)(r,o));var h=[{name:"newValue",value:t}];return c.EventManager.ReportComponentSuccess(d,h),Promise.resolve()}catch(e){c.EventManager.ReportComponentFailure(d,Error("Setting Toggle value to the grid failed"))}}}}(o,e,t,r)}},"7z0H":function(e,t,r){"use strict";r.d(t,"f",(function(){return _e})),r.d(t,"h",(function(){return ne})),r.d(t,"i",(function(){return de})),r.d(t,"j",(function(){return pe})),r.d(t,"k",(function(){return he})),r.d(t,"c",(function(){return oe})),r.d(t,"d",(function(){return se})),r.d(t,"a",(function(){return te})),r.d(t,"b",(function(){return re})),r.d(t,"e",(function(){return ie})),r.d(t,"g",(function(){return ve}));var n=r("wQXd"),i=r("9r0m"),a=r("i8/j"),o=r("/j9Z"),s=r("HSdq"),c=r("2OIc"),l=r("sOTk"),u=r("QAhb"),d=r("F2uj"),p=r("7EJx"),h=r("ObKm"),g=r("CpQy"),m=r("gBKR"),f=r("jJRu"),b=r("cAHA"),y=r("lMVv"),v=r("TCcM"),_=r("GWjY"),S=r("DJ9D");var O=r("VWqI"),C=r("Cfob"),I=r("Qeyq"),j=r("r4Uk"),P=r("T2Xs"),F="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlTimelineWallSelector";var T=r("aUuu"),w=r("Sscr"),E=r("mGpW"),x=r("RNNy"),N=r("WACO"),A=r("M6d0"),k=r("n+eO"),M=r("yHpA"),D=r("+l2M"),R=r("YHw6"),B=r("IfuP"),L=r("cL6R"),V=r("YEEA"),z=r("Ww2r"),G=r("EcZf"),W=r("BRt1"),H=r("U0B9"),U=r("jm5F"),q=r("TiXY"),X=r("wUng"),K=r("cZkS"),Q=r("qC0c"),Y=r("AfKB"),Z=r("455M"),J=r("ZEX9"),$=r("yZTI"),ee=r("uQP8"),te="form.initialize",re="form.xrmready";function ne(e,t,r,n,c){var g=[{name:"formId",value:i.a.toString(e)},{name:"pageId",value:t},{name:"contextKey",value:Object(w.v)(r)}];return{type:"form.initialize.async",execute:function(m,f,b){var v,_=m.dispatch,S=m.getState,C=S(),I=Object(l.g)(C,t),E=I.entityTypeName,x=I.data,M=I.recordSetQueryKey,B=f.TraceManager.getTracer("Forms.InitializeForm"),z=[];if(g.push({name:"isPreview",value:I&&I.isPreview}),g.push({name:"EntityName",value:I&&I.entityTypeName}),B.info("initializeForm started.",g),Object(J.b)(function(e){return function(){var t={},r={},n={};return function(i,a,o,s,c){P.a.info(F+o.controlId+": createGetTimelineWallData started");var l=!1;r.hasOwnProperty(i)&&r[i]||(r[i]=new j.a(e,i,o.id));var u=r[i],d=u.retrieveTimelineWallObject(a,o,s,c,e);n.hasOwnProperty(i)&&n[i]&&d===n[i]||(n[i]=d,l=!0);var p=u;return l&&(t[i]=p),P.a.info(F+o.controlId+": createGetTimelineWallData finished"),t[i]}}}(_),Z.a.TimelineWall),B.info("BusinessProcessWrapperManager.Instance.init started.",g),z.push(k.a.Instance.init(f,S,_).then((function(){return B.info("BusinessProcessWrapperManager.Instance.init completed.",g)}))),Object(O.a)(C,e))if(Object(l.m)(C,t)){if(!Object(O.g)(C,E,1,0)&&!(null==I?void 0:I.isPreview))return ae(22e8,_,B,b,C,t)}else if(!Object(O.g)(C,E,2,0))return ae(2147746342,_,B,b,C,t);var H=Object(a.j)(C,e),$=ve(C,H,e),ee=fe(C,E,H),te=function(e,t,r,n){var i={};if(t&&t.RelatedEntityAttributes&&n)for(var a in t.RelatedEntityAttributes){var o=Object(y.x)(e,n,a);if(o&&o.ReferencedEntity){var s={},c=be(e,o.ReferencedEntity,t.RelatedEntityAttributes[a]),l=Object(w.m)(r,a);i[Object(w.v)(l)]={attributes:c,submitModes:s}}}return i}(C,H,r,E),re=Object(W.a)(C),ne=Object(p.s)(C);for(var ie in Se(C,_,e,$,ee,t,r,te,ne),M&&!re&&_(Object(G.g)(t,M)),B.info("Update quick view forms started.",g),H.InlineQuickForms){var oe=H.InlineQuickForms[ie];for(var se in oe){var de=oe[se],pe=Object(a.j)(C,de),he=ve(C,pe,de),ye=fe(C,se,pe),_e=Object(w.l)(r,ie,se);Se(C,_,e,he,ye,t,_e,null,ne)}}if(B.info("Update quick view forms completed.",g),x&&0!==Object.keys(x).length){var Oe=I,Ce=Oe.createFromEntity,Ie=Oe.createFromRelationship,je=I.initWithEntity,Pe=Ce;!Pe&&je&&(Pe=je),v=function(e,t,r,n,a,c,p,g,m,f,b){r&&r.info("initializeFormWithDefaultValue started.",n);var v,_,S=Object(d.d)(e,c),O=null,C={},I=Object(l.m)(e,a),j=i.a.toString(g),P=[];j&&(O=Object(d.k)(e,j));for(var F=0,T=Object.keys(p);F<T.length;F++){var E=T[F];if("processid"!==E){var x=S[E];if(!x&&O&&(x=O[E]),x&&!x.AttributeOf){var N=x.Type;switch(N){case"customer":case"owner":case"lookup":case"regarding":if("string"==typeof p[E]){var k=ce(p,E,x);if(!k){ue(r,E);continue}if(C[E]=k,!i.a.equals(i.a.EMPTY,k.id)&&"owner"!==N&&I&&(f||b))if(_){var M=_.then((function(){return t(Object(U.b)(a,g)).then((function(){r&&r.info("updateSnapshotWithOptions completed (1).",n)}))}));P.push(M)}else _=me(e,t,k,c,a,r,n,f,b),P.push(_)}else{var D=void 0;(D=Array.isArray(p[E])?p[E][0]:p[E])&&D.id&&i.a.tryParseOrNull(D.id)&&D.entityType&&(C[E]=new u.a(D.entityType,new i.a(D.id),D.name))}break;case"partylist":var R=p[E],B=R,L=[];try{"string"==typeof R&&(B=JSON.parse(R));for(var z=0,G=B;z<G.length;z++){var W=G[z];L.push(new u.a(W.entityType,new i.a(W.id),W.name))}}catch(e){ue(r,E,"partylist")}C[E]=L;break;case"boolean":case"picklist":case"status":C[E]=p[E];break;case"uniqueidentifier":C[E]=new i.a(p[E]);break;default:C[E]=p[E]}}else if(-1!==E.indexOf(Y.d)||"_CreateFromId"===E){var H=null;if(-1!==E.indexOf(Y.d)&&(H=ce(p,Y.d,x)),!H&&"_CreateFromId"===E){var Z=Object(y.m)(e,p._CreateFromType),J=Object(y.h)(e,Z);J&&(H=le(Z,p._CreateFromId,J.DisplayName))}if(!H){ue(r,Y.d);continue}if(!v&&(v=H,I))if(_){M=_.then((function(){return t(Object(U.b)(a,g)).then((function(){r&&r.info("updateSnapshotWithOptions completed (2).",n)}))}));P.push(M)}else _=me(e,t,v,c,a,r,n,f,b),P.push(_);if(Object(y.h)(e,c).IsActivity&&-1===Object.keys(C).indexOf(A.t)&&Object(y.z)(e,c,v.etn,A.t)){var $=Object(s.ab)(e,a,m);$&&$[A.t]&&(C[A.t]=H)}}else{if(ue(r,E),Object(Q.c)(e,K.Rc))return Promise.reject(Object(V.b)(e,a,2200000009))}}}var ee=Object(Q.c)(e,K.L),te=C;ee&&(te=function(e,t,r,n,i){var a={},o=Object(w.w)(n),c=Object(s.P)(e,o,t,r);for(var l in i)if(c&&c.hasOwnProperty(l)){var u=Object(d.a)(e,t,l);if(!(u&&u.ParentPicklistLogicalName)&&!Object(q.a)(e,n,r,t,c,l,{name:l,value:0})){a[l]=i[l];var p=[];for(u&&u.ChildPicklistLogicalNames&&(p=p.concat(u.ChildPicklistLogicalNames));p&&p.length>0;){var h=p.pop();if(i.hasOwnProperty(h)){var g=Object(d.a)(e,t,h),m=JSON.parse(i[g.ParentPicklistLogicalName]),f=JSON.parse(i[h]);Object(X.a)(e,r,n,g,t,m,f)&&(a[h]=i[h],g.ChildPicklistLogicalNames&&g.ChildPicklistLogicalNames.length>0&&(p=p.concat(g.ChildPicklistLogicalNames)))}}}}else a[l]=i[l];return a}(e,c,a,m,C));var re=ge(te);if(P.length>0)return Promise.all(P).catch((function(e){if(2147749377===e.errorCode||-2147093999===e.errorCode)return Promise.resolve(null);Object(o.b)(e)})).then((function(){return t(Object(h.a)(a,re,!0,!0)),r&&r.info("initializeFormWithDefaultValue completed at snapshotPromiseList.length > 0.",n),Promise.resolve(null)}));return t(Object(h.a)(a,re,!0,!0)),r&&r.info("initializeFormWithDefaultValue completed at snapshotPromiseList.length == 0.",n),Promise.resolve(null)}(S(),_,B,g,t,E,x,e,r,Pe,Ie)}if(H&&H.Controls&&H.Controls.notescontrol){var Fe=Object(l.g)(C,t);B.info("loadTimelineConfigAndMetaData started.",g),_(Object(T.b)(H.Controls.notescontrol,Fe,n)).then((function(){B.info("loadTimelineConfigAndMetaData completed.",g)}))}if(H&&H.Controls)for(var Te in H.Controls)if(H.Controls[Te]){if(H.Controls[Te].Id&&H.Controls[Te].Id.startsWith("WebResource"))for(var we=0,Ee=H.Controls[Te].Parameters;we<Ee.length;we++){var xe=Ee[we];if("Url"===xe.Name){var Ne=!1;if(c)for(var Ae=0,ke=c;Ae<ke.length;Ae++){var Me=ke[Ae],De=xe.Value&&xe.Value.toLowerCase()||"";if(De.length>=Me.length&&De.length-Me.length===De.lastIndexOf(Me)){Ne=!0;break}}if(!Ne){var Re=Object(N.j)(C,xe.Value);Re&&!Re.Name&&(B.info("retrieveWebResourceDescriptorByName started.",g),_(Object(L.c)(xe.Value)).then((function(){B.info("retrieveWebResourceDescriptorByName completed.",g)})))}}}i.a.equals(H.Controls[Te].ClassId,D.rb)&&C&&void 0===C.currentServerTime.serverTimeDiffInSeconds&&(B.info("retrieveServerTime started.",g),_(Object(R.b)(new u.a(E))).then((function(){B.info("retrieveServerTime completed.",g)})))}return null!=v?v:(B.info("initializeForm completed.",g),Promise.all(z))},getFailureParameters:function(e,t){return g}}}function ie(e,t,r,i,a,o,s){var c=t(Object(m.f)(o,!1,[])).then((function(){var r=Object(y.h)(e(),o);if(r.IsChildEntity){var n=Object(O.d)(e(),r);return t(Object(m.f)(n.EntityLogicalName,!1,[]))}})),u=function(){var a=e();if(!Object(O.b)(a,o))return ae(2200000001,t,r,i,a,s);var c=Object(O.c)(a,o),u=Object(n.d)(a);return c&&Object(l.m)(a,s)&&!u?ae(2200000002,t,r,i,a,s):void 0};return c?c.then(u):Promise.resolve(u())}function ae(e,t,r,n,i,a){var o=Object(V.d)(e);return t(Object(E.e)(o)).then((function(){var t=Object(V.c)(e);if(r){var s=[{name:"CorrelationId",value:n.correlationId},{name:"ContextId",value:n.contextId},{name:"ActionStack",value:n.stack}];r.debug(t,s)}var c=Object(z.e)(i,o),l=Object(z.c)(c,o[0]),u=Object(z.c)(c,o[1]);throw Object(V.b)(i,a,e,t,l,u)}))}function oe(e,t,r,n,i,a,o,c,g){g.push({name:"AutoPopulateFieldsTimeStamp",value:Date.now()}),c&&c.info("autoPopulateFields started.",g);var m=Object(d.d)(e,r);if(m){for(var f=function(e){return e&&e.OptionSet&&Object.keys(e.OptionSet).length>0},b=Object(l.g)(e,n).id,y=new u.a(r,b),v={},_=Object(s.ac)(e,n,o),S=function(t){var r=m[t];if(r&&(i.indexOf(t)>=0&&a.indexOf(t)>=0||f(r))&&!Object(s.X)(e,n,o,_,y,r.LogicalName)){switch(t){case A.q:var c=Object(p.q)(e),l=Object(p.t)(e);if(c&&l){var d=new u.a(x.a,c,l);v[t]=d}break;case A.w:if(!Object(M.d)(e,_,null,A.w)){var h=Object(p.b)(e);if(h){var g=new u.a(x.b,h.transactionCurrencyId,h.currencyName);v[t]=g}}}if(f(r)){var b=Object(M.d)(e,_,new u.a(r.EntityLogicalName),t),S=b?parseInt(b.valueString,10):null!=r.DefaultValue?r.DefaultValue:t===A.u?0:void 0;if(void 0===S||S<0||(v[t]=S),t===A.u&&-1!==i.indexOf(A.v)){var O=m[t];if(O&&O.OptionSet&&Object.keys(O.OptionSet).length>0){var C=r.OptionSet.find((function(e){return e.Value===S})),I=C?C.DefaultStatus:m[A.v].DefaultValue||0;I<0||(v[A.v]=I)}}}}},O=0,C=i.concat(a);O<C.length;O++){S(C[O])}var I=ge(v);t(Object(h.a)(n,I,!0,!0)),c.info("autoPopulateFields completed.",g)}else c&&c.warn("attributes is null.",g)}function se(e,t,r,n,a,o,s){var c=Object(l.g)(e,n).id,d=new u.a(r,c),p={};if(i.a.isNullOrEmpty(d.id)&&!s)return function(e,t,r,n,a){var o=Object(v.d)(e,r);if(null!=o)return Promise.resolve(o);return t(Object(B.a)(i.a.EMPTY,new u.a(r,i.a.EMPTY))).then((function(e){return e&&e.businessProcessFlows?Promise.resolve(i.a.tryParse(Object.keys(e.businessProcessFlows)[0])):Promise.resolve(null)})).catch((function(e){var t=[{name:"CorrelationId",value:a.correlationId},{name:"ContextId",value:a.contextId},{name:"ActionStack",value:a.stack},{name:"entityName",value:r},{name:"reason",value:e&&e.message?e.message:JSON.stringify(e)}];return n.EventManager.ReportComponentFailure("Forms.InitializeForm",Error("Catch block of InitializeForm.retrieveBusinessProcessFlow"),void 0,t),n.TraceManager.getTracer("Forms.InitializeForm").error("Error while executing getBusinessProcessFlowDefaultIdForEntity in the retrieveBusinessProcessFlow promise.",t),Promise.resolve(null)}))}(e,t,r,a,o).then((function(e){e&&(p.processid=e.guid);var r=ge(p);return t(Object(h.a)(n,r,!0,!0)),Promise.resolve()}));s&&(p.processid=s);var g=ge(p);return t(Object(h.a)(n,g,!0,!0)),Promise.resolve()}function ce(e,t,r){var n=t;!t.match(/id$/i)&&t.indexOf(Y.d)>-1&&(n+="id");var a=e[n];if(null!=a){if(i.a.validate(a)){var o=a,s=e[t+"name"],c=e[t+"type"]||e[t+"target"];return!c&&r.Targets&&r.Targets.length>0&&(c=r.Targets[0]),le(c,o,s)}try{var l=JSON.parse(a);if(l)return le(l.entityType,l.id,l.name)}catch(e){}}return null}function le(e,t,r){if(e&&t&&i.a.validate(t)){var n=new i.a(t);if(!i.a.isNullOrEmpty(n))return new u.a(e,n,r)}return null}function ue(e,t,r){if(e){var n=[{name:"key",value:t},{name:"source",value:r}];e.warn("Value passed is not in correct syntax.",n)}}function de(e,t,r,n,i,a,o,s){return pe(e,t,r,n,a,o,s).then((function(){return he(e,t,r,i,a,o,s)}))}function pe(e,t,r,n,i,a,o){return!Object(s.Eb)(e,i)&&Object($.n)(e,i)?(a&&a.warn("pageId"+i+" is dead so rejecting loadScripts"),Promise.reject(Object(V.b)(e,i,2200000008,"Page has expired."))):(a&&a.info("loadScripts started.",o),r(t.ScriptManager.getContainer(i).getEventManager().loadScripts(n,i)).then((function(){a&&a.info("loadScripts completed",o)})))}function he(e,t,r,n,i,a,o){if(Object(s.Eb)(e,i)||!Object($.n)(e,i)){a&&a.info("runFormOnLoadScripts started.",o);var c=t.ScriptManager.getContainer(i).getEventManager();r(c.addPblEvent(n)),r(c.runOnLoad(n,1)),r(c.runOnDataLoad(n,1)),a&&a.info("runFormOnLoadScripts completed.",o)}else a&&a.warn("pageId "+i+" is dead so won't run runFormOnLoadScripts",o)}function ge(e){var t={};for(var r in e){var n={fieldName:r,value:e[r]};t[r]=n}return t}function me(e,t,r,n,i,a,s,c,l){var d=Object(w.j)(e,i),p=Object(w.x)(d);return a&&a.info("createAndSetDataSnapshotFrom started.",s),t(function(e,t,r,n,i){return{type:"snapshot.from.async",execute:function(a,s){var c=a.dispatch,l=a.getState,d=s.DataSource,p=u.a.toLegacyEntityReference(e),h=new _.a(p,t,S.a.All),O=d.execute(h,null).nativePromise(),C=null,I=null,j=null;return O.then((function(e){var r=e.get_entity();return C=Object(g.a)(r),I=C.fields,j=C.identifier,c(Object(m.f)(t,!1,Object.keys(C.fields)))}),(function(e){var r=Object(o.c)(e);if(e&&e.get_ErrorCode&&(-2147093999===e.get_ErrorCode()||r&&-2147217919===r.getNegativeErrorCode())&&n){var a=[];if(I={},n.etn){var s=Object(y.c)(l(),n.etn,t);if(s)for(var d=0,p=s;d<p.length;d++){var h=p[d];h.ReferencingAttribute&&a.push(h.ReferencingAttribute)}}else i&&a.push(i.attributeName);for(var g=0,f=a;g<f.length;g++){var b=f[g];if(!n.name&&n.id){var _=Object(v.h)(l(),n.etn,n.id.guid);if(_&&_.fields){var S=Object(y.E)(l(),n.etn),O=_.fields[S];O&&O.value||(O=_.fields.name),O&&O.value&&(n={etn:n.etn,id:n.id,name:O.value})}}I[b]={reference:n,timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}}}return j=new u.a(t),c(Object(m.f)(t,!1,a))}Object(o.b)(e)})).then((function(){var e=Object(f.b)(l(),j,I,r,b.a.Create),t=e.payload.snapshotId;return c(e),t}))}}}(r,n,p,c,l)).then((function(e){a&&(s.push({name:"newSnapshotId",value:e?e.toString():"<null>"}),a.info("initializeCreateDataSnapshotFrom completed.",s)),t(Object(C.b)(i,e,d)).then((function(){a&&a.info("createAndSetDataSnapshotFrom completed.",s)}))}))}function fe(e,t,r){var n={};if(r&&r.Attributes&&t){var i=Object(N.d)(e,r.FormLibraries,[t]);if(r.Attributes||i){var a=[].concat(r.Attributes,i);-1===a.indexOf(A.u)&&a.push(A.u),n=be(e,t,a)}}return{attributes:n,submitModes:{}}}function be(e,t,r){var n={};if(r&&t)for(var i=0;i<r.length;i++){var a=r[i];if(a){var o=Object(s.L)(e,t,a);o&&(n[a]=o)}}return n}function ye(e){return Array.isArray(e)?e:e.Controls?e.Controls:null}function ve(e,t,r){var n={},i={},a={},o={bodyVisible:!0,commandBarVisible:!0,tabNavigatorVisible:!0},l={visible:!0},u={navBarAreas:{},navPaneIsvItems:{},navBarByRelationshipItems:{},navBarItems:{}};if(t&&t.Tabs&&t.TabNames)for(var d=!1,p=0,h=Object(s.m)(e,t);p<h.length;p++){var g=h[p],m={collapsed:!!d||!(g.Expanded&&g.Visible),visible:g.Visible,label:g.Label,sectionNames:[],domId:g.DomId,showLabel:g.ShowLabel,contentType:null};switch(g.ContentType){case"expandAvailableSpace":case"singleComponent":m.contentType="singleComponent";break;default:m.contentType="cardSections"}d=d||g.Expanded&&g.Visible;var f=[];if(g.Columns)for(var b=0;b<g.Columns.length;b++){var y=g.Columns[b];if(y.SectionNames)for(var v=0;v<y.SectionNames.length;v++){var _=y.SectionNames[v];if(t.Sections[_]){var S=t.Sections[_];f.push(_);for(var O=[],C=0,j=t.Sections[_].Rows;C<j.length;C++)for(var P=0,F=j[C].Cells;P<F.length;P++){var T=F[P];T.ControlName&&O.push(T.ControlName)}var w={parentTabId:g.Id,visible:S.Visible,label:S.Label,controlNames:O,domId:S.DomId,semanticZoomDomId:S.SemanticZoomDomId};i[_]=w;for(var E=0;E<O.length;E++){var x=O[E];if(t.Controls[x]){var N=t.Controls[x],A=_e(N,_,!0),k=Object(c.a)(N,t,Object(H.b)(e));null!=k&&(A.visible=A.visible||k.ShouldOverrideControlVisible),Oe(A),a[x]=A}}}}}if(g.Header)for(var M=0,D=g.Header;M<D.length;M++){a[(G=D[M]).Name]=_e(G,null,!0)}if(g.Footer)for(var R=0,B=g.Footer;R<B.length;R++){a[(X=B[R]).Name]=_e(X,null,!0)}m.sectionNames=f,n[g.Id]=m}if(t&&t.Navigation&&(u=t.Navigation),t&&t.Header){var L=ye(t.Header);if(L)for(var V=0,z=L;V<z.length;V++){var G;a[(G=z[V]).Name]=_e(G,null,!0),Oe(a[G.Name])}o.bodyVisible=!1!==t.Header.BodyVisible,o.commandBarVisible=!1!==t.Header.CommandBarVisible,o.tabNavigatorVisible=!1!==t.Header.TabNavigatorVisible}if(t&&t.Footer){var W=ye(t.Footer);if(W)for(var U=0,q=W;U<q.length;U++){var X;a[(X=q[U]).Name]=_e(X,null,!0),Oe(a[X.Name])}l.visible=!1!==t.Footer.Visible}return{formId:r,tabs:n,sections:i,controls:a,selectedTab:Object(I.a)(),selectedRelatedEntity:null,isSaving:!1,invalidControls:{},invalidAttributes:{},controlUnboundOutputs:{},inlineQuickForms:t&&t.InlineQuickForms?t.InlineQuickForms:null,xrmReady:!1,label:"",navigation:u,viewportWidth:0,viewportHeight:0,showHeaderFieldsInSection:!1,headerFieldsInFlyout:new Set,isAutoSaving:!1,header:o,footer:l}}function _e(e,t,r){return e?{parentSectionName:t,visible:e.Visible,label:e.Label,valid:r,labelSource:e.LabelSource,domId:e.DomId,parameters:e.Parameters,dataFieldName:e.DataFieldName,relationship:e.Relationship}:null}function Se(e,t,r,n,a,o,c,l,u){void 0===l&&(l=null);var d=Object(s.cb)(e,o,c),p=Object(ee.a)(e,o);i.a.equals(null==d?void 0:d.formId,null==n?void 0:n.formId)&&i.a.equals(r,null==p?void 0:p.formId)||t(function(e,t,r,n,i,a,o){void 0===a&&(a=null);return{type:te,payload:{formId:e,formUIState:t,formMetadataState:r,relatedEntityMetadataState:a,currentLanguageId:o},meta:{pageId:n,contextToken:i}}}(r,n,a,o,c,l,u))}function Oe(e){e&&e.parameters&&e.parameters.DefaultViewId&&(e.parameters.defaultviewid=e.parameters.DefaultViewId)}},"8//c":function(e,t,r){"use strict";r.d(t,"a",(function(){return A})),r.d(t,"b",(function(){return k}));var n=r("sOTk"),i=r("mGpW"),a=r("7z0H"),o=r("Pm+b"),s=r("jw+s"),c=r("Sscr"),l=r("NWJ/"),u=r("rQCE"),d=r("i8/j"),p=r("M6d0"),h=r("XNwl"),g=r("oj0s"),m=r("Srej"),f=r("Eoze"),b=r("9r0m"),y=r("lMVv");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function v(e,t,r,n,i){!function(e,t,r){var n=Object(y.h)(e,t);n&&r.push({name:"IsCustomEntity",value:n.IsCustomEntity},{name:"IsActivityEntity",value:n.IsActivity})}(e,n,i),function(e,t,r,n){var i=Object(d.d)(e,r,t);if(i){var a=Object.keys(i);n.push({name:"NumControls",value:a.length})}}(e,t,r,i)}var _=r("/j9Z"),S=r("YEEA"),O=r("LBS5"),C=r("HSdq"),I=r("3NtJ"),j=r("GUnN"),P=r("TiXY"),F=r("cZkS"),T=r("qC0c"),w=r("OTOS"),E=r("j+yI"),x=r("dcAs"),N=r("B188");function A(e,t){return function(r){return M(e,t,r,"initialize.quickCreateFormAction.async")}}function k(e,t){return M(e,t,null,"initialize.quickCreateFormActionsaveandnew.async")}function M(e,t,r,y){var A=[{name:"RemoveScriptContainer",value:t}];return{type:y,execute:function(k,M,D){var R=k.dispatch,B=k.getState,L=B(),V=Object(n.g)(L,e),z=V.entityTypeName,G=V.formId,W=V.id,H=M.TraceManager.getTracer("Forms.QuickCreate.InitializeAction");A.push({name:"CorrelationId",value:D.correlationId},{name:"ContextId",value:D.contextId},{name:"ActionStack",value:D.stack},{name:"InitialFormId",value:b.a.toString(G)},{name:"EntityName",value:z},{name:"PageId",value:e},{name:"updatedFormId",value:b.a.toString(r&&r.updatedFormId)}),H.info("_initializeAction started.",A);var U=Object(c.j)(L,e);t&&M.ScriptManager.removeContainer(e,!0);var q=function(e,t,r,n,i,a,o){if(o){var s=Object(w.b)(i,a);return n.push({name:"skippedPreInitCodePath",value:o},{name:"newFormId",value:b.a.toString(s)}),s}if(n.push({name:"preInitResult",value:JSON.stringify(e)}),!e){var c="PreInitResult during QuickCreateForm is invalid for entity '"+t+"'";throw r.error(c,n),new _.a(c)}if(e.error)throw e.error;var l=e.updatedFormId;if(!l||b.a.equals(l,b.a.EMPTY)){c="Form descriptor is null or not defined";throw r.error(c,n),new _.a(c)}return n.push({name:"newFormId",value:b.a.toString(l)}),l}(r,z,H,A,L,e,"initialize.quickCreateFormActionsaveandnew.async"===y);return H.info("parallelizablePromises started.",A),function(e,t,r,n,o,c,l,u,d,p,h,m){h.info("retrieveResourceStrings started.",m);var f=e(Object(i.e)(s.d)).then((function(){h&&(m.push({name:"RetrievedResourceStringsTimeStamp",value:Date.now()}),h.info("retrieveResourceStrings completed.",m))})).catch((function(e){m.push({name:"loadResourceStringsPromise.Reason",value:Object(j.e)(e)}),Object(_.b)(e)}));h&&h.info("initializeContainerForClientApi started.",m);var b=u.ScriptManager.initializeContainerForClientApi(n).then((function(){h&&h.info("initializeContainerForClientApi completed.",m),e(Object(O.b)(r,n,p,o))})).catch((function(e){m.push({name:"initializeClientApiContainerPromise.Reason",value:Object(j.e)(e)}),Object(_.b)(e)}));h&&h.info("checkEntityEnabledForUCI started.",m);var y=Object(a.e)(t,e,h,l,o,p,n).then((function(){h&&h.info("checkEntityEnabledForUCI completed.",m)})).catch((function(e){m.push({name:"checkEntityEnabledForUCIPromise.Reason",value:Object(j.e)(e)}),Object(_.b)(e)}));h&&h.info("loadFormDependencies started.",m);var v=e(Object(g.c)(c,p)).then((function(){h&&h.info("loadFormDependencies completed.",m)})).catch((function(e){m.push({name:"loadFormDependencies.Reason",value:Object(j.e)(e)}),Object(_.b)(e)})),S=Object(E.c)(t(),e,u,p,h,m);return Promise.all([f,b,y,v,S])}(R,B,U,e,W,q,D,M,0,z,H,A).then((function(){return H.info("parallelizablePromises completed.",A),R(Object(a.h)(q,e,U)).then((function(){var t=Object(d.j)(B(),q),r=Object(C.N)(B(),q);return R(Object(I.b)(e,U,r)),H.info("retrieveRecordDataForOrganization started.",A),R(Object(f.f)(t.FormLibraries)).then((function(){H.info("retrieveRecordDataForOrganization completed.",A),R(Object(o.a)(!0,e,U))})).then((function(){var r=[p.q,p.u,p.v,p.w];Object(a.c)(B(),R,z,e,r,t.Attributes,U,H,A)})).then((function(){return Object(T.c)(B(),F.L)&&R(Object(P.c)(z,e,U)),Object(T.c)(B(),F.nd)&&R(Object(l.b)(e,u.a.OnLoadReady)),Object(a.i)(B(),M,R,q,U,e,H,A)})).catch((function(e){A.push({name:"retrieveRecordDataForOrganization.Reason",value:Object(j.e)(e)}),Object(_.b)(e)}))})).catch((function(e){A.push({name:"initializeForm.Reason",value:Object(j.e)(e)}),Object(_.b)(e)}))})).catch((function(e){A.push({name:"initializeActionPromise.Reason",value:Object(j.e)(e)}),Object(_.b)(e)})).then((function(){v(B(),e,G,z,A),M.EventManager.ReportComponentSuccess("Forms.QuickCreate.InitializeAction",A),H.info("_initializeAction completed.",A),R(Object(l.b)(e,u.a.FullLoad));var t=Object(m.c)(e,z,B(),U);t&&R(Object(h.c)(e,t)),function(e,t,r,n){Object(N.a)()&&e(Object(x.a)(t,r,n))}(R,e,U,z)})).catch((function(t){v(B(),e,G,z,A),Object(S.h)(B(),e,t,A,M,"Forms.QuickCreate.InitializeAction"),Object(_.b)(t)}))},getFailureParameters:function(e,t){return Object(S.a)(e,A),A}}}},"8ADW":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"g",(function(){return i})),r.d(t,"h",(function(){return a})),r.d(t,"f",(function(){return o})),r.d(t,"i",(function(){return s})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return l})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="Chart.Component",i="ViewId",a="visualizationId",o="entity Type",s="chart visualization type",c="RETRIEVECHART",l="RETRIEVECHARTTS_RETRIEVECHARTSELECTOR",u="RETRIEVECHARTTS_RETRIEVECHARTDATA",d="RETRIEVECHARTTS_RETRIEVECHARTODATA"},"8Fmj":function(e,t,r){"use strict";r.d(t,"a",(function(){return _}));var n=r("9r0m"),i=r("G7N+"),a=r("KDdL"),o=r("7dGM"),s=r("8ADW"),c=r("z9yS"),l=r("Xlzu"),u=r("t8f4"),d=r("QAhb"),p=r("xhI+"),h=r("/j9Z"),g=r("Fpc+"),m=r("Kn4q"),f=r("zEjV"),b=r("S2mk"),y=r("cZkS"),v=r("qC0c");function _(e,t,r){void 0===t&&(t=c.a.savedvisualization);var p=[];return p.push({name:s.f,value:e}),p.push({name:s.i,value:t}),p.push({name:s.h,value:n.a.toString(r)}),{type:"chart.retrieve.async",execute:function(g,b){var _=g.dispatch,S=g.getState;try{var C=m.a.LocalAndRemote,P=b.TraceManager.getTracer(s.d),w=b.DataSource,E=S(),x=r;if(P.info(s.d+"entityTypeName:"+e+"visualizationType:"+t+"visualizationId:"+r),!e){return b.EventManager.ReportComponentFailure(a.f+".retrieveChart",Error("entityTypeName is null"),s.d,p),Promise.reject("entityTypeName is null")}n.a.isNullOrEmpty(x)&&(x=Object(o.j)(E,e));var N=Object(v.c)(S(),y.A);if(!n.a.isNullOrEmpty(x)){var A=Object(o.f)(E,x),k=Object(o.g)(E,x);if(A===i.a.Initialized){if(function(){var r=Object(o.a)(E,x),n=function(e,t,r,n){var i=c.a[r],a=Object(o.i)(e,t);return a&&a.chartTypes&&a.chartTypes[i]&&a.chartTypes[i][n.guid]}(E,e,t,x),i=n&&!n.IsUserChart;switch(Object(l.d)(E,i,r,(function(){return n}))){case 1:C=m.a.Remote;break;case 2:_(function(e,t,r){var n=[];return n.push({name:"entityTypeName",value:t}),n.push({name:"visualizationType",value:r}),{type:"chartselector.retrieve.async",execute:function(e,i){var o=e.dispatch;e.getState;try{return o(Object(l.b)(c.a[r],null,t,null,!0,f.a.OnDemandWithContext,null,null,[],null,m.a.LocalAndRemote)).catch(h.b)}catch(e){throw i.EventManager.ReportComponentFailure(a.f+"._retrieveChartSelector",Error(e),s.e,n),e}}}}(0,e,t))}}(),C!==m.a.LocalAndRemote)return I(_,w,e,x,t,C,b,p);if(N&&k===i.a.Uninitialized){var M=new d.a(t===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",x),D=Object(o.a)(E,x);return _(O(x,i.a.Initialized)),_(Object(u.d)(M)).catch(h.b).then((function(e){return j(D,e),_(F(e)),b.EventManager.ReportComponentSuccess(a.f+".retrieveChartOData"),Promise.resolve(x)}),(function(e){return T(_,e,x.guid,D,b,p),Promise.resolve(x)}))}return Promise.resolve(x)}return I(_,w,e,x,t,C,b,p)}return I(_,w,e,x,t,C,b,p)}catch(e){throw b.EventManager.ReportComponentFailure(a.f+".retrieveChart",Error(e),s.d,p),e}}}}function S(e){return{type:"chart.dependencies.update.async",execute:function(t,r){var i=t.dispatch,a=t.getState,s=[];for(var c in e)s.push(e[c]+":name");return s.length>0?i(Object(p.a)(s)).then((function(){var t=new Map,r=a();for(var s in e){var c=e[s],l=Object(o.a)(r,new n.a(c));l&&c&&r.metadata.labels&&r.metadata.labels[c]&&r.metadata.labels[c].name&&(l.Name=r.metadata.labels[c].name,t.set(c,l))}t.size>0&&i(function(e){var t={};return e.forEach((function(e,r){t[r]=e})),{type:"chart.descriptor.update",payload:{charts:t}}}(t))}),h.b):Promise.resolve()}}}function O(e,t){var r,a=n.a.isNullOrEmpty(e)?null:{charts:(r={},r[n.a.toString(e)]={initialized:t,oDataInitialized:i.a.Initializing},r)};return{type:g.f,payload:a}}function C(e,t,r,o,p){void 0===o&&(o=c.a.savedvisualization);var g=[];return g.push({name:s.f,value:t}),g.push({name:s.i,value:o}),g.push({name:s.h,value:n.a.toString(r)}),{type:"chart.retrieve.async",execute:function(e,s){var m=e.dispatch,b=e.getState;return Object(v.c)(b(),y.A)?r?function(e,t,r,o,s,p,g){var m=new d.a(o===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",r);return e(O(r,i.a.Initializing)),Promise.all([e(Object(l.b)(c.a[o],null,t,n.a.toLegacyGuid(r),!0,f.a.OnDemandWithContext,null,null,[],null,s)).catch(h.b),e(Object(u.d)(m)).catch(h.c)]).then((function(t){return t[1].constructor===h.a?T(e,t[1],r.guid,t[0].charts[r.guid],p,g):(j(t[0].charts[r.guid],t[1]),e(F(t[1])),p.EventManager.ReportComponentSuccess(a.f+".retrieveChartOData")),t[0]}))}(m,t,r,o,p,s,g):function(e,t,r,o,s,p,g){return e(Object(l.b)(c.a[o],null,t,n.a.toLegacyGuid(r),!0,f.a.OnDemandWithContext,null,null,[],null,s)).catch(h.b).then((function(t){var r=new n.a(Object.keys(t.charts)[0]),s=new d.a(o===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",r);return e(O(r,i.a.Initializing)),e(Object(u.d)(s)).catch(h.b).then((function(n){return j(t.charts[r.guid],n),e(F(n)),p.EventManager.ReportComponentSuccess(a.f+".retrieveChartOData"),t}),(function(n){return T(e,n,r.guid,t.charts[r.guid],p,g),t}))}))}(m,t,r,o,p,s,g):function(e,t,r,i,a){return e(Object(l.b)(c.a[i],null,t,n.a.toLegacyGuid(r),!0,f.a.OnDemandWithContext,null,null,[],null,a)).catch(h.b)}(m,t,r,o,p)}}}function I(e,t,r,o,c,l,u,d){var p,m,f;return e((p=o,f=n.a.isNullOrEmpty(p)?null:{charts:(m={},m[n.a.toString(p)]={initialized:i.a.Initializing},m)},{type:g.b,payload:f})),e(C(0,r,o,c,l)).then((function(t){t&&t.chartSelectors&&!t.chartSelectors[r]&&(t.chartSelectors[r]={initialized:i.a.Initialized,chartTypes:{}});var s=[];for(var c in t.charts)s.push(c);return e(S(s)).then((function(){return e(P(t)),n.a.isNullOrEmpty(o)&&(o=t.chartDefaults[r]),u.EventManager.ReportComponentSuccess(a.f+".retrieveChart"),o}),h.b)}),(function(t){var c,l,p=t&&!Object(b.j)(t.errorCode)&&t.errorCode,g={chartSelectors:(c={},c[r]={initialized:i.a.Initialized,chartTypes:{}},c)};if(e(P(g)),Object(b.j)(p))return u.EventManager.ReportComponentFailure(a.f+".retrieveChart",Error(t),s.d,d),Object(h.b)(t);var m={charts:(l={},l[n.a.toString(o)]={initialized:i.a.Error,errorCode:p},l)};e(P(m))}))}function j(e,t){e.PresentationDescription=t.presentationdescription.replace(/(\r\n\s*)/g,""),e.oDataInitialized=i.a.Initialized}function P(e){return{type:g.b,payload:e}}function F(e){return{type:g.f,payload:e}}function T(e,t,r,n,o,c){var l;e(F({charts:(l={},l[r]={initialized:n.initialized,oDataInitialized:i.a.Error},l)})),o.EventManager.ReportComponentFailure(a.f+".retrieveChartOData",Error(t),s.c,c)}},"8VL5":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o}));var n=r("uO/V"),i=r("/j9Z"),a="customcontrol.refreshCustomDataProvider";function o(e,t,r,o){return{type:"customcontrol.refreshCustomDataProvider.async",execute:function(s,c){var l=s.dispatch,u=(s.getState,n.x+".refreshCustomDataProviderAction");return o().then((function(n){return l(function(e,t,r,n){var i=new Array;n&&n.length>0&&(i=n.slice());return{type:a,payload:i,meta:{pageId:e,customControlId:t,dataSetParameterName:r}}}(e,t,r,n)),c.EventManager.ReportComponentSuccess(u),n})).catch((function(e){return c.EventManager.ReportComponentFailure(u,Error(e)),Promise.reject(new i.a(e))}))}}}},"8wET":function(e,t,r){"use strict";function n(e,t){if(e&&e.indexOf("<QuickFormId")>0)
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
return function(e){if(e){for(var t={},r=e.match(/(?!entityname=")[A-Za-z0-9_]+(?=".*<\/QuickFormId>)/g),n=e.match(/[A-Za-z0-9]+-[A-Za-z0-9]+-[A-Za-z0-9]+-[A-Za-z0-9]+-[A-Za-z0-9]+(?=<\/QuickFormId>)/g),i=0;i<r.length;i++)t[r[i]]=n[i];return t}return null}(e);var r={};return r[t]=e,r}r.d(t,"a",(function(){return n}))},"90Ov":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("WS0f");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e){return Object(n.b)(e)?null:("{"===(e=e.trim())[0]&&"}"===e[e.length-1]&&(e=e.substring(1,e.length-1)),e.toLowerCase())}},"9LTA":function(e,t,r){"use strict";r.d(t,"b",(function(){return Oe})),r.d(t,"d",(function(){return Ce})),r.d(t,"e",(function(){return Ie})),r.d(t,"c",(function(){return je})),r.d(t,"a",(function(){return Pe}));var n=r("0RbL"),i=r("9r0m"),a=r("G7N+"),o=r("KDdL"),s=r("c/eZ");var c=r("70DF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var l=r("QAhb"),u=r("VcAV"),d=r("+h4s"),p=function(){function e(){this._dataPointAggregators=new Array(0),this._dataPointDateTimeRangeAggregatorInfoMap=new Map,this._dataPointFiscalPeriodAggregators=new Array(0),this._dataPointFiscalYearAggregators=new Array(0)}return e.prototype.addAggregator=function(e,t,r,n,a){if(r>=c.a.DAY&&r<c.a.FISCAL_PERIOD)this._addDateTimeRangeAggregatorInfo(e,t,r,n,a);else if(r===c.a.FISCAL_PERIOD)this._addDataPointFiscalPeriodAggregator(e,t,n,a);else if(r===c.a.FISCAL_YEAR)this._addDataPointFiscalYearAggregator(e,t,n,a);else{var o=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,Value:e&&e.Value||null,DisplayName:e&&e.DisplayName||null,EntityLogicalName:e&&e.EntityLogicalName||null}}();if(o.FieldName=e,o.EntityName=n,o.LinkEntityExpressionArray=a,Object(u.c)(t))o.Value=null;else if(t instanceof l.a){var s=t;o.Value=s.id.guid,o.DisplayName=s.name,o.EntityLogicalName=s.etn}else t instanceof i.a?o.Value=i.a.toString(t):o.Value=t.toString();this._dataPointAggregators.push(o)}},e._daysInMonth=function(e,t){return new Date(e,t,0).getDate()},e.prototype._addDataPointFiscalPeriodAggregator=function(e,t,r,n){var i=function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,FiscalType:e&&e.FiscalType||null,Year:e&&e.Year||0,Period:e&&e.Period||0}}();if(i.FiscalType="in-fiscal-period-and-year",i.FieldName=e,i.EntityName=r,i.LinkEntityExpressionArray=n,t){if("string"!=typeof t)throw new Error("value should be string");if(t.indexOf("-")<=0)throw new Error("value should have xxxx-yy format");var a=t.split("-");i.Year=Number(a[0]),i.Period=Number(a[1]),this._dataPointFiscalPeriodAggregators.push(i)}else this._dataPointFiscalPeriodAggregators.push(i)},e.prototype._addDataPointFiscalYearAggregator=function(e,t,r,n){var i=function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,FiscalType:e&&e.FiscalType||null,Year:e&&e.Year||0}}();if(i.FiscalType="in-fiscal-year",i.FieldName=e,i.EntityName=r,i.LinkEntityExpressionArray=n,t){if("number"!=typeof t)throw new Error("value should be number");i.Year=Number(t),this._dataPointFiscalYearAggregators.push(i)}else this._dataPointFiscalYearAggregators.push(i)},e.prototype._addDateTimeRangeAggregatorInfo=function(e,t,r,n,i){var a=null;switch(this._dataPointDateTimeRangeAggregatorInfoMap.has(e)?a=this._dataPointDateTimeRangeAggregatorInfoMap.get(e):(a=function(e){return{dateTimeAggregatorDay:(null==e?void 0:e.dateTimeAggregatorDay)||null,dateTimeAggregatorWeek:(null==e?void 0:e.dateTimeAggregatorWeek)||null,dateTimeAggregatorMonth:(null==e?void 0:e.dateTimeAggregatorMonth)||null,dateTimeAggregatorYear:(null==e?void 0:e.dateTimeAggregatorYear)||null,dateTimeAggregatorFieldName:(null==e?void 0:e.dateTimeAggregatorFieldName)||null,dateTimeAggregatorEntityName:(null==e?void 0:e.dateTimeAggregatorEntityName)||null,dateTimeAggregatorLinkEntityExpressionArr:(null==e?void 0:e.dateTimeAggregatorLinkEntityExpressionArr)||null,dateTimeAggregatorPrecision:(null==e?void 0:e.dateTimeAggregatorPrecision)||c.a.YEAR}}({dateTimeAggregatorFieldName:e}),this._dataPointDateTimeRangeAggregatorInfoMap.set(e,a)),a.dateTimeAggregatorEntityName||(a.dateTimeAggregatorEntityName=n),a.dateTimeAggregatorLinkEntityExpressionArr||(a.dateTimeAggregatorLinkEntityExpressionArr=i),r){case c.a.DAY:a.dateTimeAggregatorDay=Number(t);break;case c.a.WEEK:a.dateTimeAggregatorWeek=Number(t);break;case c.a.MONTH:a.dateTimeAggregatorMonth=Number(t);break;case c.a.QUARTER:a.dateTimeAggregatorMonth=3*Number(t);break;case c.a.YEAR:a.dateTimeAggregatorYear=Number(t);break;default:throw new Error("DateTime Group type not supported")}a.dateTimeAggregatorPrecision=Math.min(r,a.dateTimeAggregatorPrecision)},e.prototype._getDataPointDateTimeRangeAggregators=function(t,r){var n=new Array(0);return 0===this._dataPointDateTimeRangeAggregatorInfoMap.size||this._dataPointDateTimeRangeAggregatorInfoMap.forEach((function(i,a){var o,s={FieldName:(null==o?void 0:o.FieldName)||null,EntityName:(null==o?void 0:o.EntityName)||null,LinkEntityExpressionArray:(null==o?void 0:o.LinkEntityExpressionArray)||null,MinDate:(null==o?void 0:o.MinDate)||null,MaxDate:(null==o?void 0:o.MaxDate)||null};if(s.FieldName=i.dateTimeAggregatorFieldName,s.EntityName=i.dateTimeAggregatorEntityName,s.LinkEntityExpressionArray=i.dateTimeAggregatorLinkEntityExpressionArr,i.dateTimeAggregatorYear){switch(i.dateTimeAggregatorMonth=i.dateTimeAggregatorMonth?i.dateTimeAggregatorMonth:12,i.dateTimeAggregatorDay=i.dateTimeAggregatorDay?i.dateTimeAggregatorDay:e._daysInMonth(i.dateTimeAggregatorYear,i.dateTimeAggregatorMonth),s.MaxDate=new Date(i.dateTimeAggregatorYear,i.dateTimeAggregatorMonth-1,i.dateTimeAggregatorDay),i.dateTimeAggregatorPrecision){case c.a.DAY:h(s.MaxDate),s.MinDate=new Date(s.MaxDate.getFullYear(),s.MaxDate.getMonth(),s.MaxDate.getDate());break;case c.a.WEEK:r===d.a.FirstFullWeekOfTheYear&&(r=d.a.FirstDayOfTheYear);var l=Object(d.s)(i.dateTimeAggregatorYear,i.dateTimeAggregatorWeek,t,r),u=Object(d.s)(i.dateTimeAggregatorYear,i.dateTimeAggregatorWeek+1,t,r);if(u.setDate(u.getDate()-1),r===d.a.FirstDayOfTheYear)if(u>=new Date(i.dateTimeAggregatorYear+1,0,1))u=new Date(i.dateTimeAggregatorYear+1,0,0);else if(1===i.dateTimeAggregatorWeek){var p=new Date(i.dateTimeAggregatorYear,0,1);l<p&&(l=p)}s.MinDate=l,s.MaxDate=u,h(s.MaxDate),h(s.MinDate);break;case c.a.MONTH:s.MinDate=new Date(s.MaxDate.getFullYear(),s.MaxDate.getMonth()-1,e._daysInMonth(i.dateTimeAggregatorYear,s.MaxDate.getMonth())+1),h(s.MaxDate),h(s.MinDate);break;case c.a.QUARTER:s.MinDate=new Date(s.MaxDate.getFullYear(),s.MaxDate.getMonth()-3,e._daysInMonth(i.dateTimeAggregatorYear,s.MaxDate.getMonth()-2)+1),h(s.MaxDate),h(s.MinDate);break;case c.a.YEAR:h(s.MaxDate),s.MinDate=new Date(s.MaxDate.getFullYear()-1,s.MaxDate.getMonth(),s.MaxDate.getDate()+1);break;default:throw new Error("DateTime Group type not supported")}n.push(s)}else n.push(s)})),n},e.prototype.getAggregators=function(e,t){var r=this._dataPointAggregators,n=this._getDataPointDateTimeRangeAggregators(e,t);return n&&n.length>0&&(r=r.concat(n)),this._dataPointFiscalPeriodAggregators&&this._dataPointFiscalPeriodAggregators.length>0&&(r=r.concat(this._dataPointFiscalPeriodAggregators)),this._dataPointFiscalYearAggregators&&this._dataPointFiscalYearAggregators.length>0&&(r=r.concat(this._dataPointFiscalYearAggregators)),r},e}();function h(e){e.getTimezoneOffset()<0&&e.setDate(e.getDate()+1)}var g=r("Ww2r"),m=r("dUXI"),f=r("7EJx"),b=r("otJc"),y=r("yGoS"),v=r("EGsq"),_=r("F2uj"),S=r("uXKh"),O=r("sRkF");function C(e,t){var r=Object(_.a)(e,t.entity.entityName,t.attributeName),n=r?r.DisplayName:null;n||(n=t.attributeName);var i=n;if(t.dateTimeGrouping){var a=y.c(t.dateTimeGrouping.groupingType).replace("-","").toUpperCase();i=String.format(Object(g.b)(e,m.c),Object(g.b)(e,m.c+"."+a.toUpperCase()),n)}else t.hasAggregate&&t.aggregateType&&(i=String.format(Object(g.b)(e,m.d),Object(g.b)(e,m.d+"."+t.aggregateType.toUpperCase()),n));if(r&&"money"===r.Type){var o="",s=null,c=Object(v.x)(e);r.IsBaseCurrency?c&&c.baseCurrencyId&&c.transactionCurrencyById&&(s=c.transactionCurrencyById[c.baseCurrencyId.guid]):t.hasAggregate&&(s=Object(f.b)(e)),s&&(o=c&&c.currencyDisplayOption===S.a.CurrencyCode?s.currencyCode:s.currencySymbol),o&&(i=String.format(Object(g.b)(e,m.b),i,o))}return i}function I(e,t,r){return r>0?String.format(Object(g.b)(e,m.y),r,t):String.format(Object(g.b)(e,m.w),t)}function j(e,t,r,n,i){var a=i<1&&n>=1&&r<1,o=i<1&&n<1&&r>=1,s=n<1&&r<1;if(i>=1&&n<1&&r>=1){var c=new Date(t,r-1,i),l=Object(f.w)(e),u=l.formatInfoCultureName,d=l.numberFormatInfo,p=l.dateFormatInfo,h=new Sys.CultureInfo(u,d,p);return Object(b.s)(c,h,O.a.None)}return a?String.format(Object(g.b)(e,m.z),n,t):o?String.format("{0} {1}",function(e){var t=Object(g.b)(e,m.e).split(",");if(!t||12!==t.length)throw new Error("Expect 12 months! Actual: "+t.length);return t}(e)[r-1],t):s?String(t):""}function P(e){return Object(g.b)(e,m.v)}var F=r("9rlF"),T=r("+Z9T");function w(e,t,r){var n=!1;return r&&r.groupAttribute&&r.groupAttribute.dateTimeGrouping&&(n=!0),{attribute:t,primaryGroupBy:r,aliasName:t.aliasName||t.attributeName,state:e,isDateTimeChart:n}}function E(e,t){var r=e.isDateTimeChart?function(e,t){if(!t.fields||!Object(F.c)(t.fields[e.aliasName]))return"";switch(e.attribute.dateTimeGrouping.groupingType){case c.a.DAY:return function(e,t){var r=Object(F.e)(t.fields[e.aliasName]),n=Object(F.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]),i=Object(F.e)(t.fields[e.primaryGroupBy.extendedGroupBys[1].aliasName]);return j(e.state,i,n,-1,r)}(e,t);case c.a.WEEK:return function(e,t){var r=Object(F.e)(t.fields[e.aliasName]),n=Object(F.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return j(e.state,n,-1,r,-1)}(e,t);case c.a.MONTH:return function(e,t){var r=Object(F.e)(t.fields[e.aliasName]),n=Object(F.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return j(e.state,n,r,-1,-1)}(e,t);case c.a.QUARTER:return function(e,t){var r=Object(F.e)(t.fields[e.aliasName]),n=Object(F.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return I(e.state,n,r)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,t);case c.a.FISCAL_PERIOD:return function(e,t){return Object(F.e)(t.fields[e.aliasName])}(e,t);case c.a.YEAR:return function(e,t){var r=Object(F.e)(t.fields[e.aliasName]);return j(e.state,r,-1,-1,-1)}(e,t);case c.a.FISCAL_YEAR:return function(e,t){var r=Object(F.e)(t.fields[e.aliasName]);return I(e.state,r,-1)}(e,t);default:return Object(F.c)(t.fields[e.attribute.attributeName])}}(e,t):null;return r||(r=(r=Object(F.c)(t.fields[e.aliasName]))||""),0===r.length?Object(g.b)(e.state,m.v):r}function x(e,t){if(!e.attribute||!Object(_.a)(e.state,e.attribute.entity.entityName,e.attribute.attributeName))return E(e,t);switch(Object(_.a)(e.state,e.attribute.entity.entityName,e.attribute.attributeName).Type){case"picklist":case"status":case"state":case"boolean":var r=Object(F.e)(t.fields[e.aliasName]);return r=Object(T.a)(r)?-1:Number(r);case"datetime":return function(e,t){var r=-1,n=-1,i=-1;switch(e.attribute.dateTimeGrouping.groupingType){case c.a.DAY:r=Object(F.e)(t.fields[e.aliasName]),n=Object(F.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]),i=Object(F.e)(t.fields[e.primaryGroupBy.extendedGroupBys[1].aliasName]);break;case c.a.MONTH:n=Object(F.e)(t.fields[e.aliasName]),i=Object(F.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;case c.a.YEAR:i=Object(F.e)(t.fields[e.aliasName]);break;case c.a.QUARTER:n=Object(F.e)(t.fields[e.aliasName]),i=Object(F.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;case c.a.WEEK:r=1+7*(Object(F.e)(t.fields[e.aliasName])-1),i=Object(F.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;default:return E(e,t)}return new Date(i,n-1,r).getTime()}(e,t);default:return E(e,t)}}function N(e){return{Enabled:e&&e.Enabled||!1,X:e&&e.X||0,Y:e&&e.Y||0,Align:e&&e.Align||"left",VerticalAlign:e&&e.VerticalAlign||"middle",LabelFormatter:e&&e.LabelFormatter||null,Color:e&&e.Color||""}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function A(e){return{Value:e&&e.Value||0,FormattedValue:e&&e.FormattedValue||null,Aggregators:e&&e.Aggregators||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var k=function(e){function t(r,n,i){var a=e.call(this,r)||this;return Object.setPrototypeOf(a,t.prototype),a.title=n,a.description=i,a}return Object(s.__extends)(t,e),t}(Error),M=r("qC0c"),D=r("cZkS"),R=r("glw0"),B=r("scgP"),L=r("WS0f");function V(){return this.point.formattedValue}function z(e){return function(){return Highcharts.numberFormat(parseFloat(this.point.y)/e*100)+"%"}}var G=function(){function e(){this.isInitialized=!1}return Object.defineProperty(e.prototype,"primaryGroupBy",{get:function(){return this.chartDataDescription&&this.chartDataDescription.category&&this.chartDataDescription.category.primaryGroupBy},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"queryModel",{get:function(){return this._queryModel},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e,t,r,n,i,a,o,s,c,l){this.getState=e,this.chartData=t,this.chartDataDescription=r,this.categoryColumn=this.chartDataDescription.categoryColumns,this.chartPresentationSeries=n,this.chartPresentationXAxis=i,this.chartPresentationYAxis=a,this.chartPresentationArea3DStyle=o,this.chartPresentationAreaGradientStyle=s,this._queryModel=c,this.chartPresentationAnnotationList=l,this._isChartCustomizationParityFCBEnabled()&&this._validateChartAggregateAttributes(),this.isInitialized=!0},e.prototype.setXAxisMajorGridAndMajorTickProperties=function(e,t){var r,n,i,a,o,s,c,l;return void 0===t&&(t=0),e.AxisMajorGridColor=null===(n=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[t])||void 0===n?void 0:n.AxisMajorGridColor,e.AxisMajorGridEnabled=null===(a=null===(i=this.chartPresentationXAxis)||void 0===i?void 0:i[t])||void 0===a?void 0:a.AxisMajorGridEnabled,e.AxisMajorTickMarkColor=null===(s=null===(o=this.chartPresentationXAxis)||void 0===o?void 0:o[t])||void 0===s?void 0:s.AxisMajorTickMarkColor,e.AxisMajorTickMarkEnabled=null===(l=null===(c=this.chartPresentationXAxis)||void 0===c?void 0:c[t])||void 0===l?void 0:l.AxisMajorTickMarkEnabled,e},e.prototype.setYAxisMajorGridAndMajorTickProperties=function(e,t){var r,n,i,a,o,s,c,l;return void 0===t&&(t=0),e.AxisMajorGridColor=null===(n=null===(r=this.chartPresentationYAxis)||void 0===r?void 0:r[t])||void 0===n?void 0:n.AxisMajorGridColor,e.AxisMajorGridEnabled=null===(a=null===(i=this.chartPresentationYAxis)||void 0===i?void 0:i[t])||void 0===a?void 0:a.AxisMajorGridEnabled,e.AxisMajorTickMarkColor=null===(s=null===(o=this.chartPresentationYAxis)||void 0===o?void 0:o[t])||void 0===s?void 0:s.AxisMajorTickMarkColor,e.AxisMajorTickMarkEnabled=null===(l=null===(c=this.chartPresentationYAxis)||void 0===c?void 0:c[t])||void 0===l?void 0:l.AxisMajorTickMarkEnabled,e},e.prototype.retrieveChartArea3DStyle=function(){var e={};return e.Enable3D=this.chartPresentationArea3DStyle.Enable3D,e},e.prototype.retrieveChartAreaGradientStyle=function(){var e={};return e.BackColor=this.chartPresentationAreaGradientStyle.BackColor,e.BackSecondaryColor=this.chartPresentationAreaGradientStyle.BackSecondaryColor,e.BackGradientStyle=this.chartPresentationAreaGradientStyle.BackGradientStyle,e},e.prototype.setYAxisOppositeProperty=function(e){var t,r,n,i;return this._isChartCustomizationParityFCBEnabled()&&(null===(r=null===(t=this.chartPresentationXAxis)||void 0===t?void 0:t[0])||void 0===r?void 0:r.IsReversed)&&(e.Opposite=null===(i=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[0])||void 0===i?void 0:i.IsReversed),e},e.prototype.setXAxisIsReversedProperty=function(e){var t,r,n,i;return this._isChartCustomizationParityFCBEnabled()&&(null===(r=null===(t=this.chartPresentationXAxis)||void 0===t?void 0:t[0])||void 0===r?void 0:r.IsReversed)&&(e.IsReversed=null===(i=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[0])||void 0===i?void 0:i.IsReversed),e},e.prototype.retrieveChartYAxis=function(){var e=this,t=new Array(1);if(t[0]={},!this._queryModel.SeriesList)return t;for(var r=function(t,r,n){e.chartPresentationYAxis&&e.chartPresentationYAxis.length>r&&e.chartPresentationYAxis[r]&&e.chartPresentationYAxis[r].Title?t.Title=e.chartPresentationYAxis[r].Title:1===n&&(t.Title=e._queryModel.SeriesList[r].Title)},n=0,i=-1,a=-1,o=!1,s=!1,c=0;c<this.chartPresentationSeries.length;c++)this.chartPresentationSeries[c].SecondaryYAxis?(n++,a=-1===a?c:a,s=s||this.shouldDisableAllowDecimals(c)):(i=-1===i?c:i,o=o||this.shouldDisableAllowDecimals(c));return r(t[0],i,this.chartPresentationSeries.length-n),t[0].Opposite=!1,o&&(t[0].AllowDecimals=!1),0===n&&(t[0]=this.setYAxisOppositeProperty(t[0])),n>0&&(t[1]={},r(t[1],a,n),t[1].Opposite=!0,s&&(t[1].AllowDecimals=!1)),t.forEach((function(t,r){var n,i,a,o,s,c,l,u,d,p,h,g,m,f;t.Disabled=e.chartPresentationYAxis&&e.chartPresentationYAxis[r]&&e.chartPresentationYAxis[r].Disabled,t.LabelForeColor=null===(i=null===(n=e.chartPresentationYAxis)||void 0===n?void 0:n[r])||void 0===i?void 0:i.LabelForeColor,t.AxisLineColor=null===(o=null===(a=e.chartPresentationYAxis)||void 0===a?void 0:a[r])||void 0===o?void 0:o.AxisLineColor,t.AxisTitleForeColor=null===(c=null===(s=e.chartPresentationYAxis)||void 0===s?void 0:s[r])||void 0===c?void 0:c.AxisTitleForeColor,t.LabelDisabled=null===(u=null===(l=e.chartPresentationYAxis)||void 0===l?void 0:l[r])||void 0===u?void 0:u.LabelDisabled,t.AxisInterval=null===(p=null===(d=e.chartPresentationYAxis)||void 0===d?void 0:d[r])||void 0===p?void 0:p.AxisInterval,t.AxisMinimum=null===(g=null===(h=e.chartPresentationYAxis)||void 0===h?void 0:h[r])||void 0===g?void 0:g.AxisMinimum,t.AxisMaximum=null===(f=null===(m=e.chartPresentationYAxis)||void 0===m?void 0:m[r])||void 0===f?void 0:f.AxisMaximum,t=e.setYAxisMajorGridAndMajorTickProperties(t,r)})),this.chartPresentationYAxis&&this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].FormatString?t[0].FormatString=this.chartPresentationYAxis[0].FormatString:t[0].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[0].measures[0].measureAttribute),n>0&&(this.chartPresentationYAxis&&this.chartPresentationYAxis[1]&&this.chartPresentationYAxis[1].FormatString?t[1].FormatString=this.chartPresentationYAxis[1].FormatString:t[1].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[a].measures[0].measureAttribute)),t},e.prototype._isChartCustomizationParityFCBEnabled=function(){return Object(M.a)(this.getState(),D.s,D.Lc,D.w)},e.prototype.retrieveChartAnnotations=function(){for(var e=new Array(this.chartPresentationAnnotationList.length),t=0;t<this.chartPresentationAnnotationList.length;t++){var r={};r.X=this.chartPresentationAnnotationList[t].X,r.Y=this.chartPresentationAnnotationList[t].Y,r.Text=this.chartPresentationAnnotationList[t].Text,r.ForeColor=this.chartPresentationAnnotationList[t].ForeColor,e[t]=r}return e},e.prototype.retrieveChartCategory=function(){var e,t,r,n,i,a,o=new Array(1),s=null;this.categoryColumn.length>0&&(s=w(this.getState(),this.categoryColumn[0],this.chartDataDescription.category.primaryGroupBy)),o[0]={};for(var c=new Array(this.chartData.length),l=0;l<this.chartData.length;l++){var u=this.chartData[l];if(s){if(c[l]=E(s,u),"-1"===c[l])c[l]=Object(g.b)(this.getState(),m.f);else if(!s.isDateTimeChart&&"number"==typeof Object(F.e)(u.fields[s.aliasName])&&this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString){var d=Object(f.w)(this.getState());c[l]=Object(B.c)(Object(F.e)(u.fields[s.aliasName]),Object(b.d)(d),this.chartPresentationXAxis[0].FormatString)}}else c[l]=P(this.getState())}return o[0].Title=this.retrieveChartCategoryTitle(s),o[0].Values=c,o[0].Disabled=this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].Disabled,o[0].LabelForeColor=null===(t=null===(e=this.chartPresentationXAxis)||void 0===e?void 0:e[0])||void 0===t?void 0:t.LabelForeColor,o[0].AxisLineColor=null===(n=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[0])||void 0===n?void 0:n.AxisLineColor,o[0].AxisTitleForeColor=null===(a=null===(i=this.chartPresentationXAxis)||void 0===i?void 0:i[0])||void 0===a?void 0:a.AxisTitleForeColor,o[0].LabelDisabled=this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].LabelDisabled,o[0]=this.setXAxisMajorGridAndMajorTickProperties(o[0]),o[0]=this.setXAxisIsReversedProperty(o[0]),o},e.prototype.retrieveChartCategoryTitle=function(e){return this.chartPresentationXAxis&&this.chartPresentationXAxis.length>0&&this.chartPresentationXAxis[0].Title?this.chartPresentationXAxis[0].Title:e?C((t=e).state,t.attribute):"";var t},e.prototype.retrieveChartSeries=function(e){for(var t=new Array(this.chartPresentationSeries.length),r=function(r){var i=n.chartDataDescription.category.measureCollections[r].measures[0].measureAttribute,a=i.aliasName?i.aliasName:i.attributeName,o=n.chartPresentationSeries[r].IsValueShownAsLabel,s=n.chartPresentationSeries[r].LabelFormat,c=null;s&&Object(B.d)(s)&&(c=Object(B.g)(s));var l=!1;n.chartPresentationSeries[r].Label&&"#percent"===n.chartPresentationSeries[r].Label.toLowerCase()&&(l=!0);var u=!1;s&&W(n.chartPresentationSeries[r].ChartType)&&Object(B.e)(s)&&(u=!0);var d=null,p=C(n.getState(),i);t[r]=n.cloneBlueprintSeriesStyle(n.chartPresentationSeries[r]),n.chartPresentationSeries[r].SecondaryYAxis&&(t[r].YAxisNumber=1),n.primaryGroupBy&&((d=[]).push(n.primaryGroupBy.groupAttribute),n.primaryGroupBy.extendedGroupBys&&n.primaryGroupBy.extendedGroupBys.forEach((function(e){d.push(e)})));for(var h=new Array(n.chartData.length),g=a,m=0,y=0;y<n.chartData.length;y++){var v=n.chartData[y];h[y]=A();var _=Object(F.e)(v.fields[a]);if(h[y].Value=_||0,m+=_||0,s){var S=Object(f.w)(n.getState()),O=Object(b.d)(S);Object(B.f)(s)?h[y].FormattedValue=Object(R.b)(h[y].Value,n.chartPresentationSeries[r].LabelFormat,O):Object(B.d)(s)&&!u?h[y].FormattedValue=Object(B.a)(h[y].Value,c,O):h[y].FormattedValue=Object(F.c)(v.fields[g])||0}else h[y].FormattedValue=Object(F.c)(v.fields[g])||0;n.attachAggregators(h[y],v,d)}var I=N();o?(I.Enabled=!0,I.LabelFormatter=V):l&&(I.Enabled=!0,I.LabelFormatter=z(m)),I.Color=n.chartPresentationSeries[r].LabelForeColor,t[r].DataLabels=I,t[r].DataPoints=h,t[r].Title=n.getChartTitleFromPresentationSeries(p,r),t[r].XAxisNumber=e,t[r].HideInLegend=n.chartPresentationSeries[r].HideInLegend,t[r].Stack=n.chartPresentationSeries[r].Stack},n=this,i=0;i<this.chartPresentationSeries.length;i++)r(i);var a=Object(f.w)(this.getState()),o=Object(b.d)(a),s=this.chartPresentationSeries[0].IsValueShownAsLabel,c=this.chartPresentationSeries[0].LabelFormat;if(s&&W(this.chartPresentationSeries[0].ChartType)&&Object(B.e)(c))for(var l=H(c,o),u=0;u<t[0].DataPoints.length;u++)l(0,u,0,t);return t},e.prototype.getChartTitleFromPresentationSeries=function(e,t){return void 0===t&&(t=0),Object(L.b)(this.chartPresentationSeries[t].LegendText)?Object(L.b)(this.chartPresentationSeries[t].Name)?e:this.chartPresentationSeries[t].Name:this.chartPresentationSeries[t].LegendText},e.prototype.shouldDisableAllowDecimals=function(e){var t=this.chartDataDescription.category.measureCollections[e].measures[0].measureAttribute;return"count"===t.aggregateType||"countcolumn"===t.aggregateType},e.prototype.cloneBlueprintSeriesStyle=function(e){var t,r={DataPoints:t&&t.DataPoints||null,DataLabels:t&&t.DataLabels||null,ChartType:t&&t.ChartType||"line",YAxisNumber:t&&t.YAxisNumber||0,XAxisNumber:t&&t.XAxisNumber||0,Title:t&&t.Title||"",Color:t&&t.Color||"",BorderColor:t&&t.BorderColor||"",BorderWidth:t&&t.BorderWidth||0,CustomProperties:t&&t.CustomProperties||null,Stack:t&&t.Stack||null};return r.ChartType=e.ChartType,r.Color=e.Color,r.BorderColor=e.BorderColor,r.BorderWidth=e.BorderWidth,r.CustomProperties=e.CustomProperties,r},e.prototype.attachAggregators=function(t,r,n){if(n){for(var i=new p,a=function(t){var a=n[t],o=new Array;a.entity.baseEntity&&a.entity.baseEntity.linkedEntities&&a.entity.baseEntity.linkedEntities.forEach((function(e){var t,r={name:t&&t.name||null,from:t&&t.from||null,to:t&&t.to||null,linkType:t&&t.linkType||null,alias:t&&t.alias||null};r.name=e.entityName,r.from=e.linkFromAttribute,r.to=e.linkToAttribute,r.linkType=e.joinType.toString(),r.alias=e.alias,o.push(r)})),i.addAggregator(a.attributeName,Object(F.e)(r.fields[e._getFieldName(a)]),a.dateTimeGrouping?a.dateTimeGrouping.groupingType:-1,a.entity.entityName,o)},o=0;o<n.length;o++)a(o);var s=Object(f.w)(this.getState()),c=this._getFirstDayOfWeekFromUserSettings(s),l=this._getCalendarWeekRuleFromUserSettings(s);t.Aggregators=i.getAggregators(c,l)}},e.prototype._getFirstDayOfWeekFromUserSettings=function(e){var t;return(null===(t=e.dateFormatInfo)||void 0===t?void 0:t.FirstDayOfWeek)||0},e.prototype._getCalendarWeekRuleFromUserSettings=function(e){var t;return(null===(t=e.dateFormatInfo)||void 0===t?void 0:t.CalendarWeekRule)||0},e.prototype.getFormatterPropertiesForAttribute=function(e){return Object(b.z)(this.getState(),Object(_.a)(this.getState(),e.entity.entityName,e.attributeName))},e._getFieldName=function(e){return e.aliasName&&e.aliasName.trim()?e.aliasName:e.attributeName},e.prototype.isChartDrillable=function(){if(!this._isGroupByDrillable(this.chartDataDescription.category.primaryGroupBy))return!1;for(var e=0,t=this.chartDataDescription.category.measureCollections;e<t.length;e++)for(var r=0,n=t[e].secondaryGroupBys;r<n.length;r++){var i=n[r];if(!this._isGroupByDrillable(i))return!1}return!!this.chartDataDescription.entityExpression.hasAggregate},e.prototype._isGroupByDrillable=function(e){return!this.chartDataDescription.isGroupByFromNestedLinkEntity()&&(!(!e||!e.groupAttribute.hasGroupBy)&&this._isAttributeDrillable(e.groupAttribute))},e.prototype._isAttributeDrillable=function(e){var t,r=null===(t=null==e?void 0:e.entity)||void 0===t?void 0:t.entityName,n=null==e?void 0:e.attributeName;return"memo"!==Object(_.b)(n,r,this.getState())},e.prototype._validateChartAggregateAttributes=function(){for(var e,t,r,n,i=0;i<(null===(r=null===(t=null===(e=this.chartDataDescription)||void 0===e?void 0:e.entityExpression)||void 0===t?void 0:t.aggregateAttributes)||void 0===r?void 0:r.length);i++){var a=this.chartDataDescription.entityExpression.aggregateAttributes[i],o=null===(n=null==a?void 0:a.entity)||void 0===n?void 0:n.entityName,s=null==a?void 0:a.attributeName,c=Object(_.b)(s,o,this.getState());if(!("date"!==c&&"datetime"!==c||"min"!==a.aggregateType&&"max"!==a.aggregateType)){var l=String.format(Object(g.b)(this.getState(),m.h),s);throw new k("ChartError",l,l)}}},e}();function W(e){return!!e&&("stackedbar100"===e.toLowerCase()||"stackedcolumn100"===e.toLowerCase()||"stackedarea100"===e.toLowerCase())}function H(e,t){return function r(n,i,a,o){if(n===o.length)return a;var s=o[n].DataPoints[i];return a=r(++n,i,a+(s&&s.Value?s.Value:0),o),s&&s.Value&&(s.FormattedValue=Object(B.a)(s.Value/a*100,Object(B.g)(e),t)),a}}var U=r("lMVv"),q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.parse=function(){var e,t,r,n;if(!this.isInitialized)throw new Error("The instance of the ComparisonChartDataParser class is not properly initialized.");var i=new Array(0),a=new Map,o=this.chartDataDescription.category,s=o.measureCollections[0];if(s.secondaryGroupBys.length<=0)throw new Error("Comparison chart can only be plotted with secondary groups's");if(s.measures&&s.measures.length>0&&s.measures[0].parentCategory&&s.measures[0].parentCategory.primaryGroupBy&&(s.measures[0].parentCategory.primaryGroupBy.groupAttribute&&i.push(s.measures[0].parentCategory.primaryGroupBy.groupAttribute),s.measures[0].parentCategory.primaryGroupBy.extendedGroupBys))for(var c=0;c<s.measures[0].parentCategory.primaryGroupBy.extendedGroupBys.length;c++)i.push(s.measures[0].parentCategory.primaryGroupBy.extendedGroupBys[c]);if(1!==this.chartPresentationSeries.length)throw new Error("Comparison chart should have only one series");for(var l=this._addSecondaryGroupByToFieldAggregators(s,i),u=s.measures[0].measureAttribute,d=u.aliasName?u.aliasName:u.attributeName,p=d,h=o.primaryGroupBy.groupAttribute,g=w(this.getState(),this._getGroupByAttribute(h,o.primaryGroupBy),o.primaryGroupBy),m=new Array,y=new Array,v=new Map,_=0;_<this.chartData.length;_++){var S=E(g,D=this.chartData[_]),O=E(l,D),C=void 0;C=null==O?O=P(this.getState()):x(l,D),a.set(C,O),y.indexOf(S)<0&&y.push(S),m.indexOf(C)<0&&m.push(C)}m.forEach((function(e){var t=new Array(y.length);v.set(e,t)}));var I=Object(f.w)(this.getState()),j=this.chartPresentationSeries[0].LabelFormat,k=!1;this.chartPresentationSeries[0].Label&&"#percent"===this.chartPresentationSeries[0].Label.toLowerCase()&&(k=!0);var M=!1;j&&W(this.chartPresentationSeries[0].ChartType)&&Object(B.e)(j)&&(M=!0);for(_=0;_<this.chartData.length;_++){var D,L=x(l,D=this.chartData[_]);Object(T.a)(L)&&(L=P(this.getState()));var G=v.get(L),U=(S=E(g,D),y.indexOf(S));if(this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString&&(y[U]=Object(B.c)(Object(F.e)(D.fields[g.aliasName]),Object(b.d)(I),this.chartPresentationXAxis[0].FormatString)),G[U]=A(),G[U].Value=Object(F.e)(D.fields[d]),j){var q=Object(b.d)(I);Object(B.f)(j)?G[U].FormattedValue=Object(R.b)(G[_].Value,j,q):Object(B.d)(j)&&!M?G[U].FormattedValue=Object(B.a)(G[U].Value,Object(B.g)(j),q):G[U].FormattedValue=Object(F.c)(D.fields[p])||0}else G[U].FormattedValue=Object(F.c)(D.fields[p])||0;this.attachAggregators(G[U],D,i)}m.forEach((function(e){for(var t=v.get(e),r=0;r<y.length;r++)t[r]||(t[r]=A())}));var X=new Array(1);X[0]={},X[0].Title=this.retrieveChartCategoryTitle(g),X[0].Values=y,X[0].LabelForeColor=null===(e=this.chartPresentationXAxis[0])||void 0===e?void 0:e.LabelForeColor,X[0].AxisLineColor=null===(t=this.chartPresentationXAxis[0])||void 0===t?void 0:t.AxisLineColor,X[0].AxisTitleForeColor=null===(r=this.chartPresentationXAxis[0])||void 0===r?void 0:r.AxisTitleForeColor,X[0].LabelDisabled=null===(n=this.chartPresentationXAxis[0])||void 0===n?void 0:n.LabelDisabled,X[0]=this.setXAxisMajorGridAndMajorTickProperties(X[0]),X[0]=this.setXAxisIsReversedProperty(X[0]),this._sortComparisonCodes(s,m);for(var K=new Array(m.length),Q=this.chartPresentationSeries[0]&&this.chartPresentationSeries[0].IsValueShownAsLabel,Y=this.chartPresentationSeries[0]?this.chartPresentationSeries[0].LabelForeColor:null,Z=this.chartPresentationSeries[0]&&this.chartPresentationSeries[0].HideInLegend,J=this.getChartTitleFromPresentationSeries(this.chartPresentationSeries[0].Name),$=function(e){var t=m[e];if(K[e]=ee.cloneBlueprintSeriesStyle(ee.chartPresentationSeries[0]),K[e].Title=J||a.get(t),K[e].DataPoints=v.get(t),K[e].HideInLegend=Z,Q)(r=N()).Enabled=!0,r.LabelFormatter=V,K[e].DataLabels=r,r.Color=Y;else if(k){var r,n=0;K[e].DataPoints.forEach((function(e){n+=e&&e.Value?e.Value:0})),(r=N()).Enabled=!0,r.LabelFormatter=z(n),K[e].DataLabels=r,r.Color=Y}},ee=this,te=0;te<m.length;te++)$(te);if(Q&&M)for(var re=H(j,q=Object(b.d)(I)),ne=0;ne<X[0].Values.length;ne++)re(0,ne,0,K);this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=X,this.queryModel.YAxes=this._retrieveChartYAxis(u),this.queryModel.SeriesList=K,this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations()},t.prototype._sortComparisonCodes=function(e,t){e.secondaryGroupBys[0].descending?t.sort((function(e,t){return"number"==typeof e&&"number"==typeof t?t-e:t.localeCompare(e)})):t.sort((function(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e.localeCompare(t)}))},t.prototype._getGroupByAttribute=function(e,t){return e.attributeName!==Object(U.h)(this.getState(),e.entity.entityName).PrimaryIdAttribute?e:t.extendedGroupBys&&t.extendedGroupBys.length>0?t.extendedGroupBys[0]:e},t.prototype._addSecondaryGroupByToFieldAggregators=function(e,t){var r=e.secondaryGroupBys[0].groupAttribute,n=w(this.getState(),this._getGroupByAttribute(r,e.secondaryGroupBys[0]),e.secondaryGroupBys[0]);if(r&&t.push(r),e.secondaryGroupBys[0].extendedGroupBys)for(var i=0;i<e.secondaryGroupBys[0].extendedGroupBys.length;i++)t.push(e.secondaryGroupBys[0].extendedGroupBys[i]);return n},t.prototype._retrieveChartYAxis=function(e){var t,r,n,i,a,o,s,c,l=new Array(1);return l[0]={},this.chartPresentationYAxis&&this.chartPresentationYAxis.length>0&&this.chartPresentationYAxis[0].Title?l[0].Title=this.chartPresentationYAxis[0].Title:l[0].Title=C(this.getState(),e),this.chartPresentationYAxis[0].FormatString?l[0].FormatString=this.chartPresentationYAxis[0].FormatString:l[0].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[0].measures[0].measureAttribute),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelForeColor&&(l[0].LabelForeColor=this.chartPresentationYAxis[0].LabelForeColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].AxisLineColor&&(l[0].AxisLineColor=this.chartPresentationYAxis[0].AxisLineColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].AxisTitleForeColor&&(l[0].AxisTitleForeColor=this.chartPresentationYAxis[0].AxisTitleForeColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelDisabled&&(l[0].LabelDisabled=null===(r=null===(t=this.chartPresentationYAxis)||void 0===t?void 0:t[0])||void 0===r?void 0:r.LabelDisabled),l[0].AxisInterval=null===(i=null===(n=this.chartPresentationYAxis)||void 0===n?void 0:n[0])||void 0===i?void 0:i.AxisInterval,l[0].AxisMinimum=null===(o=null===(a=this.chartPresentationYAxis)||void 0===a?void 0:a[0])||void 0===o?void 0:o.AxisMinimum,l[0].AxisMaximum=null===(c=null===(s=this.chartPresentationYAxis)||void 0===s?void 0:s[0])||void 0===c?void 0:c.AxisMaximum,this.shouldDisableAllowDecimals(0)&&(l[0].AllowDecimals=!1),l[0]=this.setYAxisMajorGridAndMajorTickProperties(l[0]),l[0]=this.setYAxisOppositeProperty(l[0]),l},t}(G),X=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.parse=function(){if(!this.isInitialized)throw new Error("The instance of the DateTimeChartDataParser class is not properly initialized.");this.categoryColumn&&0!==this.categoryColumn.length&&(this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=this.retrieveChartCategory(),this.queryModel.SeriesList=this.retrieveChartSeries(0),this.queryModel.YAxes=this.retrieveChartYAxis(),this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations())},t.prototype.retrieveChartCategory=function(){var e,t,r,n,i,a,o,s,c=new Array(1);if(this.chartData.length<1)return c;var l=this.primaryGroupBy.groupAttribute;c[0]={};var u=new Array(this.chartData.length),d=w(this.getState(),l,this.primaryGroupBy);c[0].Title=this.retrieveChartCategoryTitle(d),c[0].LabelForeColor=null===(t=null===(e=this.chartPresentationXAxis)||void 0===e?void 0:e[0])||void 0===t?void 0:t.LabelForeColor,c[0].AxisLineColor=null===(n=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[0])||void 0===n?void 0:n.AxisLineColor,c[0].AxisTitleForeColor=null===(a=null===(i=this.chartPresentationXAxis)||void 0===i?void 0:i[0])||void 0===a?void 0:a.AxisTitleForeColor,c[0].LabelDisabled=null===(s=null===(o=this.chartPresentationXAxis)||void 0===o?void 0:o[0])||void 0===s?void 0:s.LabelDisabled,c[0]=this.setXAxisMajorGridAndMajorTickProperties(c[0]),c[0]=this.setXAxisIsReversedProperty(c[0]);for(var p=0;p<this.chartData.length;p++){var h=this.chartData[p];u[p]=E(d,h),d.isDateTimeChart&&this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString&&u[p]!==Object(g.b)(d.state,m.v)&&(u[p]=Object(B.b)(new Date(u[p]),Object(b.d)(Object(f.w)(this.getState())),this.chartPresentationXAxis[0].FormatString))}return c[0].Values=u,c},t}(G),K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.parse=function(){if(!this.isInitialized)throw new Error("The instance of the NormalChartDataParser class is not properly initialized.");this.categoryColumn&&0!==this.categoryColumn.length&&(this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=this.retrieveChartCategory(),this.queryModel.SeriesList=this.retrieveChartSeries(0),this.queryModel.YAxes=this.retrieveChartYAxis(),this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations())},t}(G);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Q=r("Je7O");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Y(e){var t={};try{if(e){var r=/\w+=\w+/;e.split(/\s*,\s*/).forEach((function(e){if(e&&r.test(e)){var n=e.split("="),i=n[0],a=n[1];t[i]=a}}))}}catch(t){throw"Failed to parse chart custom properties, value: "+e+" "}return{FunnelNeckHeight:t&&Number(t.FunnelNeckHeight)||0,FunnelNeckWidth:t&&Number(t.FunnelNeckWidth)||10,StackedGroupName:t&&t.StackedGroupName||null}}var Z=r("S2mk"),J=["COLUMN","STACKEDCOLUMN","STACKEDCOLUMN100","BAR","STACKEDBAR","STACKEDBAR100","AREA","STACKEDAREA","STACKEDAREA100","LINE","PIE","FUNNEL","TAG","DOUGHNUT","POINT"];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function $(e,t,r){var n=(new DOMParser).parseFromString(t,"text/xml");return function(e,t){var r=e.getElementsByTagName("parsererror");if(r&&r.length>0)throw new k("ChartError",Object(g.b)(t,m.t),Object(g.b)(t,m.s))}(n,e),{chartPresentationSeries:ee(e,n,r),chartPresentationLegendList:ne(n),colorsList:re(n),chartPresentationArea3DStyle:ce(n),chartPresentationAreaGradientStyle:le(n),chartPresentationXAxis:ae(n),chartPresentationYAxis:oe(n),chartPresentationAnnotationList:ie(n)}}function ee(e,t,r){for(var n=new Array,i=t.querySelectorAll("Chart Series Series"),a=new XMLSerializer,o=0;o<i.length;o++){var s=i[o],c={},l=s.getAttribute("ChartType")||"Column";if(-1===J.indexOf(l.toUpperCase()))throw new k("ChartError",Object(g.b)(e,m.t),Object(g.b)(e,m.t));c.ChartType=l;var u=s.getAttribute("Color");c.Color=u?ue(u):null;var d=s.getAttribute("LegendText");c.LegendText=d||null;var p=s.getAttribute("CustomProperties");c.CustomProperties=Y(p);var h=s.getAttribute("BorderColor");c.BorderColor=h?ue(h):null;var f=s.getAttribute("BorderWidth");c.BorderWidth=f?Number(f):null;var b=s.getAttribute("IsValueShownAsLabel");c.IsValueShownAsLabel=b&&"true"===b.toLowerCase()||!1,c.Label=s.getAttribute("Label");var y=s.getAttribute("YAxisType");c.SecondaryYAxis=y&&"secondary"===y.toLowerCase();var v=s.getAttribute("IsVisibleInLegend");c.HideInLegend=v&&"false"===v.toLowerCase();var _=s.getAttribute("LabelForeColor");c.LabelForeColor=_?ue(_):null,c.LabelFormat=s.getAttribute("LabelFormat");var S=te(e,s.outerHTML||a.serializeToString(s),r);c.Name=S||null,c.Stack=c.CustomProperties.StackedGroupName,n.push(c)}return n}function te(e,t,r){var n=Object(o.a)(t);if(Object(Z.j)(n)||n.length<5)return"";var i=n[2].toLowerCase(),a=n[4],s="",c=i.substring(0,r.length);if(c!==r)return"";var l=i.substring(r.length+1,i.length),u=Object(_.a)(e,c,l);return u&&u.OptionSet&&(s=u.OptionSet.filter((function(e){return e.Value.toString().toLowerCase()===a.toLowerCase()}))[0].Label),s}function re(e){var t=new Array,r=e.querySelector("Chart").getAttribute("PaletteCustomColors");return null!==r&&r.split(";").forEach((function(e){if(e){var r=ue(e);t.push(r)}})),t}function ne(e){for(var t=new Array,r=e.querySelectorAll("Chart Legends Legend"),n=0;n<r.length;n++){var i={},a=r[n].getAttribute("Enabled");i.Enabled=null===a||"True"===a,t.push(i)}return t}function ie(e){for(var t=new Array,r=e.querySelectorAll("Chart Annotations TextAnnotation"),n=0;n<r.length;n++){var i=r[n],a={},o=i.getAttribute("X");a.X=o?Number(o):null;var s=i.getAttribute("Y");a.Y=s?Number(s):null,a.Text=i.getAttribute("Text");var c=i.getAttribute("ForeColor");a.ForeColor=c?ue(c):null,t.push(a)}return t}function ae(e){for(var t=new Array,r=e.querySelectorAll("Chart ChartAreas ChartArea AxisX"),n=0;n<r.length;n++){var i=r[n],a={};se(a,e.querySelectorAll("Chart ChartAreas ChartArea AxisX MajorGrid")[0],e.querySelectorAll("Chart ChartAreas ChartArea AxisX MajorTickMark")[0]),a.Title=i.getAttribute("Title");var o=e.querySelectorAll("Chart ChartAreas ChartArea AxisX LabelStyle")[0];if(o){var s=null==o?void 0:o.getAttribute("ForeColor"),c=null==o?void 0:o.getAttribute("Enabled");a.LabelForeColor=s?ue(s):null,a.LabelDisabled=c&&"false"===c.toLowerCase(),a.FormatString=o.getAttribute("Format")}var l=i.getAttribute("Enabled"),u=i.getAttribute("LineColor"),d=i.getAttribute("TitleForeColor");a.Disabled=l&&"false"===l.toLowerCase(),a.AxisLineColor=u?ue(u):null,a.AxisTitleForeColor=d?ue(d):null,a.Disabled=l&&"false"===l.toLowerCase();var p=i.getAttribute("IsReversed");a.IsReversed=p&&"true"===p.toLowerCase(),t.push(a)}return t}function oe(e){var t=new Array,r=function(e,r){var n,i,a={};if(e){var o=e;a.Title=o.getAttribute("Title"),se(a,o.querySelectorAll("MajorGrid")[0],o.querySelectorAll("MajorTickMark")[0]);var s=o.getAttribute("Enabled");a.Disabled=s&&"false"===s.toLowerCase();var c=o.getAttribute("Interval"),l=o.getAttribute("Minimum"),u=o.getAttribute("Maximum");a.AxisInterval=c?Number(c):null,a.AxisMinimum=l?Number(l):null,a.AxisMaximum=u?Number(u):null;var d=o.querySelectorAll("LabelStyle");d&&d[0]&&d[0].getAttribute("Format")&&(a.FormatString=d[0].getAttribute("Format"));var p=null===(n=null==d?void 0:d[0])||void 0===n?void 0:n.getAttribute("ForeColor");a.LabelForeColor=p?ue(p):null;var h=null===(i=null==d?void 0:d[0])||void 0===i?void 0:i.getAttribute("Enabled");a.LabelDisabled=h&&"false"===h.toLowerCase();var g=o.getAttribute("LineColor");a.AxisLineColor=g?ue(g):null;var m=o.getAttribute("TitleForeColor");a.AxisTitleForeColor=m?ue(m):null,t.splice(r,0,a)}else t.splice(r,0,a)},n=e.querySelectorAll("Chart ChartAreas ChartArea AxisY");return n&&r(n[0],0),(n=e.querySelectorAll("Chart ChartAreas ChartArea AxisY2"))&&r(n[0],1),t}function se(e,t,r){if(e){if(t){var n=t.getAttribute("LineColor"),i=t.getAttribute("Enabled");e.AxisMajorGridColor=n?ue(n):null,e.AxisMajorGridEnabled=i&&"true"===i.toLowerCase()}if(r){var a=r.getAttribute("LineColor"),o=r.getAttribute("Enabled");e.AxisMajorTickMarkColor=a?ue(a):null,e.AxisMajorTickMarkEnabled=o&&"true"===o.toLowerCase()}return e}}function ce(e){var t=e.querySelector("Chart ChartAreas ChartArea Area3DStyle"),r={};return r.Enable3D=!!t&&"true"===t.getAttribute("Enable3D").toLowerCase(),r}function le(e){var t=e.querySelector("Chart ChartAreas ChartArea"),r={};return r.BackColor=t?t.getAttribute("BackColor"):"",r.BackSecondaryColor=t?t.getAttribute("BackSecondaryColor"):"",r.BackGradientStyle=t?t.getAttribute("BackGradientStyle"):"",r}function ue(e){if(!e)return null;if(function(e){return/^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$/.test(e)}(e=e.trim()))return String.format("rgb({0})",e);if(function(e){return/#[0-9a-fA-F]{6}/.test(e)}(e))return e;if(function(e){return/^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,(\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,){2}\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$/.test(e)}(e)){var t=[];e.split(",").forEach((function(e){return t.push(e.trim())}));var r=t.shift(),n=parseFloat(r)/255,i=t.slice();return i.push(n.toString()),String.format("rgba({0})",i.join(","))}return e}var de=r("BuSU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function pe(e){return{Text:e&&e.Text||"",HorizontalAlignment:e&&e.HorizontalAlignment||"center",VerticalAlignment:e&&e.VerticalAlignment||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var he=function(){function e(e,t,r,n,i,a,o,s){this._getState=e,this._chartData=i,this._viewRecord=t,this._visualizationRecord=r,this._chartDataDescription=n,this._chartPresentationXML=a,this._drilldownChartType=o,this._entityLogicalName=s}return e.prototype.buildChartModel=function(){if(this._chartQueryModel=Object(de.a)(),this._chartData.length>0){this._buildChartHeading();try{this._buildChartPresentation(),this._buildChart()}catch(e){if(!(e instanceof k))throw e;this._buildErrorMessage(e)}}else this._buildDataEmptyMessage();return this._chartQueryModel},e.prototype._buildDataEmptyMessage=function(){var e=Object(g.b)(this._getState(),m.m),t=pe();t.Text=this._visualizationRecord&&this._visualizationRecord.get_DisplayName()?this._visualizationRecord.get_DisplayName():e,t.HorizontalAlignment="center",t.VerticalAlignment="middle",this._chartQueryModel.Title=t,this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName(),this._chartQueryModel.DisplayMode=1,this._chartQueryModel.ErrorInformation=new Q.a,this._chartQueryModel.ErrorInformation.set_ErrorType(null),this._chartQueryModel.ErrorInformation.set_ErrorDescription(e)},e.prototype._buildErrorMessage=function(e){this._chartQueryModel.Title=pe(),this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName(),this._chartQueryModel.DisplayMode=1,this._chartQueryModel.ErrorInformation=new Q.a,this._chartQueryModel.ErrorInformation.set_ErrorType(e.title),this._chartQueryModel.ErrorInformation.set_ErrorDescription(e.description)},e.prototype._buildChartHeading=function(){var e=this._visualizationRecord.get_DisplayName();this._chartQueryModel.Title=pe(),this._chartQueryModel.Title.Text=e,this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName()},e.prototype._buildChartPresentation=function(){var e,t=this;this._chartPresentationParser=$(this._getState(),this._chartPresentationXML,this._entityLogicalName),this._drilldownChartType&&this._chartPresentationParser.chartPresentationSeries.forEach((function(e){e.ChartType=t._drilldownChartType})),this._chartPresentationSeries=this._chartPresentationParser.chartPresentationSeries,this._chartPresentationXAxis=this._chartPresentationParser.chartPresentationXAxis,this._chartPresentationYAxis=this._chartPresentationParser.chartPresentationYAxis,this._chartPresentationAnnotationList=this._chartPresentationParser.chartPresentationAnnotationList,this._chartPresentationArea3DStyle=this._chartPresentationParser.chartPresentationArea3DStyle,this._chartPresentationAreaGradientStyle=this._chartPresentationParser.chartPresentationAreaGradientStyle,this._chartQueryModel.Legend={Enabled:e&&e.Enabled||!1},this._chartPresentationParser.chartPresentationLegendList.length>0?this._chartQueryModel.Legend.Enabled=this._chartPresentationParser.chartPresentationLegendList[0].Enabled:this._chartQueryModel.Legend.Enabled=!1,this._colors=this._chartPresentationParser.colorsList},e.prototype._buildChart=function(){this._chartParserType=this._getChartParserType();var e=function(e){var t=null;switch(e){case 2:t=new q;break;case 3:t=new X;break;case 1:default:t=new K}return t}(this._chartParserType);e.initialize(this._getState,this._chartData,this._chartDataDescription,this._chartPresentationSeries,this._chartPresentationXAxis,this._chartPresentationYAxis,this._chartPresentationArea3DStyle,this._chartPresentationAreaGradientStyle,this._chartQueryModel,this._chartPresentationAnnotationList),this._chartQueryModel.Colors=this._colors,e.parse()},e.prototype._getChartParserType=function(){return this._chartDataDescription.isComparisonChart?2:this._chartDataDescription.category.primaryGroupBy.groupAttribute.dateTimeGrouping?3:1},e}(),ge=r("8ADW"),me=r("y5DA"),fe=r("kKaT"),be=r("TbLg"),ye=r("z8lM"),ve=r("Fpc+"),_e=r("ZZrQ"),Se=r("AhDg");function Oe(e,t,r){return{type:"chartData.retrieve.core.async",execute:function(n,a,s){var c=n.dispatch,l=n.getState,u=[];try{var d=l();if(!Object(o.b)(l,c,a,u,e,t,r,!0))return Promise.resolve();var p=new _e.a(e.fetchXml);p.set_NoLock(!0),p.set_PageSize(e.dataDefinition.entityExpression.top);var h=function(e){var t={};if(null!=e){var r=new _e.a(e);r.set_PageSize(0),r.set_NoLock(!0),t[""]=r}return t}(e.viewXml);return function(e,t,r,n){var a=new Se.a(i.a.toString(i.a.newGuid()),n&&n.isPreloadCall);return e.retrieveEntitiesForAggregateQuery(t,r,a).nativePromise()}(a.DataSource,p,h,s).then((function(n){var a=function(t,r,n){var i=new Fe(e.viewTitle,e.viewEntityLogicalName),a=new Fe(e.chartName,e.chartPrimaryEntityTypeCode),s=e.dataDefinition,c=Object(ye.a)(t);Object(o.e)(s,c,r());var l=e;return new he(r,i,a,s,c,e.presentationXml,l.drillDownChartType?l.drillDownChartType:null,n).buildChartModel()}(n,l,t);Object(M.c)(d,D.rd)?(c(Pe(e.getStorageKey(),a)),Ie(d,c,e.getStorageKey(),r)):(c(je(i.a.toString(e.visualizationId),i.a.toString(e.viewId),a)),Ce(d,c,i.a.toString(e.visualizationId),i.a.toString(e.viewId),r))})).catch((function(t){Object(me.c)(d,c,t,e,r)}))}catch(e){return a.EventManager.ReportComponentFailure(o.f+".retrieveChartDataCore",Error(e),ge.b,u),Promise.reject(e)}}}}function Ce(e,t,r,a,o){if(e){var s=new i.a(r),c=i.a.toString(s),l=new i.a(a),u=i.a.toString(l),d={},p={};if(p[u]=function(e,t,r,i){if(!e)return null;if(i&&""!==i){var a=Object(be.c)(e,t,r),o=a&&a.slice();return Object(n.a)(o,i)}return null}(e,c,u,o),p[u]){d[c]=p;var h={entities:null,lists:null,charts:d};t(Object(fe.b)(h))}}}function Ie(e,t,r,i){if(e){var a={};if(a[r]=function(e,t,r){if(!e)return null;if(r){var i=Object(be.b)(e,t),a=i&&i.slice();return Object(n.a)(a,r)}return null}(e,r,i),a[r]){var o={entities:null,lists:null,charts:null,chartData:a};t(Object(fe.b)(o))}}}function je(e,t,r){var n,o,s=new i.a(e),c=i.a.toString(s),l=new i.a(t),u=i.a.toString(l),d={charts:(n={},n[c]=(o={},o[u]={initialized:a.a.Initialized,chartConfigObject:r},o),n)};return{type:ve.d,payload:d}}function Pe(e,t){var r,n={chartData:(r={},r[e]={initialized:a.a.Initialized,chartConfigObject:t},r)};return{type:ve.d,payload:n}}var Fe=function(){function e(e,t){this._displayName=e,this._associatedEntityLogicalName=t,Object.freeze(this)}return e.prototype.get_DisplayName=function(){return this._displayName},e.prototype.get_AssociatedEntityLogicalName=function(){return this._associatedEntityLogicalName},e}()},"9kE/":function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r("c/eZ"),i=r("nuS9"),a=r("Gh4N"),o=r("UdPG"),s=r("ptNh"),c=r("Ss07"),l=Object(o.a)(),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.type,r=e.size,o=e.ariaLabel,u=e.ariaLive,d=e.styles,p=e.label,h=e.theme,g=e.className,m=e.labelPosition,f=o,b=Object(s.j)(this.props,s.h,["size"]),y=r;void 0===y&&void 0!==t&&(y=t===a.b.large?a.a.large:a.a.medium);var v=l(d,{theme:h,size:y,className:g,labelPosition:m});return i.createElement("div",Object(n.__assign)({},b,{className:v.root}),i.createElement("div",{className:v.circle}),p&&i.createElement("div",{className:v.label},p),f&&i.createElement("div",{role:"status","aria-live":u},i.createElement(c.a,null,i.createElement("div",{className:v.screenReaderText},f))))},t.defaultProps={size:a.a.medium,ariaLive:"polite",labelPosition:"bottom"},t}(i.Component)},"A/RO":function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var n,i=r("9r0m"),a=r("/eCp");!function(e){e[e.Active=0]="Active",e[e.Inactive=1]="Inactive",e[e.Completed=2]="Completed"}(n||(n={}));var o=r("nbQV"),s=r("lKeh"),c=r("QAhb"),l=r("VnpK"),u=r("S2mk"),d=r("F2uj"),p=r("T576"),h=r("HSdq"),g=r("Sscr"),m=r("lMVv"),f=r("WS0f"),b=r("qC0c"),y=r("U0B9"),v=r("sOTk"),_=r("MSdU"),S=r("r0s4"),O=function(){function e(e,t,r){this._memorizedExtraFilters=[],this._getState=e,this._businessProcessFlowWrapperIdentifierFactory=t,this._context=r}return e.prototype.generate=function(e,t){return t?this._getBusinessProcessFlowWrapper(e,t):null},e.prototype._getBusinessProcessFlowWrapper=function(e,t){var r=this._getState(),n=this._businessProcessFlowWrapperIdentifierFactory.generate(e,t);if(!n||!t||!t.getProcessId())return null;var a=t.getCurrentFormEntity(),c=Object(v.g)(r,e);this._navigationEntities=t.getNavigationEntities();var l=Object(p.f)(r,a);return{id:t.getProcessId(),instanceId:t.getProcessInstanceId(),name:Object(o.c)(r,t.getProcessId()),bpfEntityLogicalName:t.getBpfEntityLogicalName(),stages:this._getStages(n.data.activePath,n.activeStageId,n.data.selectedStageId,e,t),relationships:Object(s.e)(this._getState(),t.getProcessId()),activeStageId:n.activeStageId,selectedStageId:n.data.selectedStageId,activePath:n.data.activePath,displayState:n.displayState,currentEntity:new _.a(a.etn,i.a.toLegacyGuid(a.id)),processState:t.getProcessState(),state:t.getState(),status:t.getStatus(),statusName:t.getStatusName(),isFormInactive:Object(h.Lb)(r,c.entityTypeName,c.id),delegates:this._getActions(t),isVisible:t.isVisible(),actionLogs:n.data.actionLogCollection,instanceModifiedTimestamp:l,instanceName:t.getProcessInstanceName(),isCustomControlsPresent:t.getCustomControlIndicator(),isRenderedFromFormXml:t.getFormXmlRenderingIndicator(),isImmersiveBPF:t.isImmersiveBPF()}},e.prototype._getStages=function(e,t,r,n,a){var o=this;if(!e||0===e.length)return null;var s={},c=[];return e.forEach((function(e,l){s[e.guid]=l;var u=i.a.equals(e,r),d=o._getStageWrapper(e,u,t,s,n,a);d&&c.push(d)})),c},e.prototype._getStageWrapper=function(e,t,r,n,a,o){var c=this,l=Object(s.c)(this._getState(),o.getProcessId(),e);if(!l)return null;var u=t&&this._getSteps(l,a,o)||[];if(Object(b.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){var d="BusinessProcessFlow.CustomControlConfiguration",p=this._context.TraceManager.getTracer(d),h=Object(s.a)(this._getState(),o.getProcessId(),p);if(!Object(f.a)(h)&&!Object(f.a)(h.ControlConfigurations)){var g=o.getTelemetryParams();if(g.push({name:"BPFEntityFormId",value:h.Id.guid},{name:"BPFEntityFormType",value:h.FormType}),Object(f.a)(h.ControlConfigurations)||g.push({name:"CustomControls",value:Object.keys(h.ControlConfigurations).length}),o.isBpfFormDescriptorValid(this._getState(),o.getProcessId(),h,p))try{if(!Object(f.a)(h.ControlConfigurations)){var y=Object(s.b)(h,p),v=h.ControlConfigurations,_=this._getNonDefaultControlConfiguration(v);if(Object(b.c)(this._getState(),"FCB.EnableBPFCCPhase3")){var S=this._buildStepsFromFormXml(l,h,_,g,a,o);S&&S.length>0&&(u=S,o.setFormXmlRenderingIndicator(!0),this._context.EventManager.ReportComponentSuccess(d,g))}else Object(f.a)(y)||Object.keys(y).forEach((function(e){if(y[e].ParentCellId){var t=new i.a(y[e].ParentCellId);if((l&&l.stage&&l.stage.steps?l.stage.steps.map((function(e){return e.stepId.guid})).indexOf(t.guid):-1)>=0&&t){var r=[];r.push({name:"StepId",value:t.guid},{name:"NonDefaultControlUniqueId",value:y[e].UniqueId}),p.info("Non-default control found for step",r);var n=null;_&&y[e].UniqueId&&(o.setFormXmlRenderingIndicator(!0),n=_[y[e].UniqueId]?_[y[e].UniqueId]:null);var a={attributeName:y[e].DataFieldName,isRequired:c._getIsStepRequired(t.guid,l),name:y[e].Label,stepId:new i.a(t.guid),stepType:"field",attributeType:c._getMetadataTypeByAttribute(l.entityLogicalName,y[e].DataFieldName),controlName:"header_process_"+y[e].Label,isVisible:y[e].Visible,isControlDisabled:y[e].Disabled,nonDefaultConfiguration:n};u.push(a),Object(f.a)(a.stepId.guid)||a.stepId.guid===i.a.EMPTY.guid||g.push({name:"StepId",value:a.stepId.guid}),g.push({name:"AttributeName",value:a.attributeName},{name:"AttributeType",value:a.attributeType},{name:"IsRequired",value:a.isRequired},{name:"NonDefaultControlUniqueId",value:y[e].UniqueId}),Object(f.a)(n)?c._context.EventManager.ReportComponentFailure(d,new Error("CustomControlConfiguration is null or undefined even though the BPF entity form XML is valid and contains non-default custom control descriptors"),null,g):(o.setCustomControlIndicator(!0),g.push({name:"CustomControlId",value:n.CustomControlId}),!Object(f.a)(n.Name)&&n.Name.indexOf("MscrmControls")>=0&&g.push({name:"CustomControlName",value:n.Name}),c._context.EventManager.ReportComponentSuccess(d,g))}}}))}}catch(e){p.error("Message: "+e.message+", Stack: "+e.stack,g),this._context.EventManager.ReportComponentFailure(d,e,null,g)}else this._context.EventManager.ReportComponentFailure(d,new Error("Invalid FormXML - Fallback invoked"),null,g)}}return{id:l.stage.stageId,name:l.stage.stageDisplayName,entityName:l.entityLogicalName,entityDisplayName:Object(m.f)(this._getState(),l.entityLogicalName)||l.entityDisplayName,relatedEntityReference:this._getRelatedEntityReference(l.entityLogicalName),referencingAttributeName:l.referencingAttributeName,status:this._getStageStatus(n[e.guid],n[r.guid],o),steps:u}},e.prototype._buildStepsFromFormXml=function(e,t,r,n,a,o){var s=this,c=[],l=t.Controls;return!Object(f.a)(l)&&this._areStepsValid(e,t,n)&&Object.keys(l).forEach((function(u){if(!Object(f.a)(l[u])&&l[u].ParentCellId){var d=new i.a(l[u].ParentCellId),p=t.Tabs.find((function(e){return e.Id===l[u].ParentTabId}));if(p&&!Object(f.a)(p.RawTabId)&&e.stage.stageId.guid===new i.a(p.RawTabId).guid){var g=null;r&&l[u].UniqueId!==i.a.EMPTY.guid&&(g=r[l[u].UniqueId]?r[l[u].UniqueId]:null);var m=s._retrieveControlName(l[u],e.stage.steps),b=s._getUIControl(a,m),y={attributeName:l[u].DataFieldName,isRequired:l[u].IsRequired,name:s._retrieveStepLabel(l[u],b,e.stage.steps),stepId:new i.a(d.guid),stepType:s._getStepTypeFromControlKey(u),attributeType:s._getMetadataTypeByAttribute(e.entityLogicalName,l[u].DataFieldName),controlName:m,isVisible:b&&!Object(f.a)(b.visible)?b.visible:l[u].Visible,isControlDisabled:l[u].Disabled||Object(h.t)(s._getState(),{id:a,controlName:m},o.getContextToken()),viewId:b&&b.parameters&&b.parameters.defaultviewid?b.parameters.defaultviewid:null,nonDefaultConfiguration:Object(f.a)(g)?null:g};y.config=s._getConfig(t,o,l[u],a,n),y.viewId&&y.config&&y.config.Parameters&&y.config.Parameters.value&&(y.config.Parameters.value.ViewId=y.viewId,b&&b.customFilter&&b.customFilter.length>0&&(s._applyLookupFilter(y,b),y.config.Parameters.value.ExtraFilters=y.extraFilters)),c.push(y),n.push({name:"StepId",value:y.stepId.guid},{name:"AttributeName",value:y.attributeName},{name:"AttributeType",value:y.attributeType},{name:"IsRequired",value:y.isRequired},{name:"NonDefaultControlUniqueId",value:l[u].UniqueId}),Object(f.a)(g)||l[u].UniqueId===i.a.EMPTY.guid||(o.setCustomControlIndicator(!0),n.push({name:"CustomControlId",value:g.CustomControlId}),!Object(f.a)(g.Name)&&g.Name.indexOf("MscrmControls")>=0&&n.push({name:"CustomControlName",value:g.Name}))}}})),c},e.prototype._areStepsValid=function(e,t,r){if(!(Object(f.a)(t)||Object(f.a)(e)||Object(f.a)(e.stage)||Object(f.a)(e.stage.stageId))){var n=t.Controls,a=e.stage.stageId.guid.toLowerCase(),o=e.stage.steps,s=[];if(!Object(f.a)(n)){if(Object.keys(n).forEach((function(e){if(!Object(f.a)(n[e].ParentCellId)){var r=new i.a(n[e].ParentCellId).guid.toLowerCase(),o=t.Tabs.find((function(t){return t.Id===n[e].ParentTabId}));if(!Object(f.a)(o)&&!Object(f.a)(o.RawTabId)){var c=new i.a(o.RawTabId).guid.toLowerCase();a===c&&s.indexOf(r)<0&&s.push(r)}}})),o.length!==s.length)return r.push({name:"StepFallback",value:"No. of steps in BPF stage don't match no. of cells in corresponding tab"},{name:"BPFStageStepCount",value:o.length},{name:"TabCellCount",value:s.length}),!1;for(var c=0;c<o.length;c++)if(s.indexOf(o[c].stepId.guid.toLowerCase())<0)return r.push({name:"StepFallback",value:"BPF stage stepId does not match corresponding tab's cellId"},{name:"MissingBPFStepId",value:o[c].stepId.guid.toLowerCase()}),!1;return!0}}return!1},e.prototype._retrieveStepLabel=function(e,t,r){if(!Object(f.a)(t)&&!Object(f.a)(t.label)&&""!==t.label)return t.label;if(!Object(f.a)(e.Label)&&""!==e.Label)return e.Label;if(!Object(f.a)(r)&&r.length>0)for(var n=0,a=r;n<a.length;n++){var o=a[n];if(o.stepId.guid===new i.a(e.ParentCellId).guid&&!Object(f.a)(o.label)&&""!==o.label)return o.label}return""},e.prototype._retrieveControlName=function(e,t){if(!Object(f.a)(t)&&t.length>0)for(var r=0,n=t;r<n.length;r++){var a=n[r];if(a.stepId.guid===new i.a(e.ParentCellId).guid&&!Object(f.b)(a.controlName))return a.controlName}return Object(f.a)(e.DataFieldName)||""===e.DataFieldName?"":"header_process_"+e.DataFieldName},e.prototype._getConfig=function(e,t,r,n,i){try{var a=Object(h.h)(),o=e&&e.Id,s=t.getCurrentFormEntity();i.push({name:"ControlDescriptorName",value:r&&r.Name});var c=a(this._getState(),r,n,o,s&&s.name,!1);return i.push({name:"CCFControlConfigID",value:c&&c.CustomControlId},{name:"CCFControlConfigName",value:c&&c.Name},{name:"CCFControlConfigParams",value:c&&c.Parameters&&Object.keys(c.Parameters).join(",")}),c}catch(e){i.push({name:"CCFControlConfigError",value:e})}return null},e.prototype._getStageStatus=function(e,t,r){return null==t||e<t?n.Completed:e===t?r.getStatus()===a.a.Finished?n.Completed:n.Active:n.Inactive},e.prototype._getSteps=function(e,t,r){var n=[];if(!e.stage||!e.stage.steps||0===e.stage.steps.length)return null;for(var i=0,a=e.stage.steps;i<a.length;i++){var o=a[i],c=this._getUIControl(t,o.controlName),l=null;if(o.name&&o.stepType&&"field"===o.stepType.toLowerCase()){if(!(l=this._getMetadataTypeByAttribute(e.entityLogicalName,o.name)))continue;if(Object(b.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){var u=this._context.TraceManager.getTracer("BpfCustomControlSupport"),d=Object(s.a)(this._getState(),r.getProcessId(),u);if(!Object(f.a)(d)&&!Object(f.a)(d.ControlConfigurations)&&r.isBpfFormDescriptorValid(this._getState(),r.getProcessId(),d,u)){var p=Object(s.b)(d,u),g=this._getNonDefaultControlStepIds(p);if(!Object(f.a)(g)&&g.map((function(e){return e.guid})).indexOf(o.stepId.guid)>=0)continue}}}var m=this._getState(),y={attributeName:o.name,controlName:o.controlName,isRequired:o.required,isVisible:!c||c.visible,name:c?c.label:o.label,stepId:o.stepId,stepType:o.stepType,attributeType:l,viewId:c&&c.parameters&&c.parameters.defaultviewid?c.parameters.defaultviewid:o.viewId,isControlDisabled:Object(h.t)(m,{id:t,controlName:o.controlName},r.getContextToken())};y.viewId&&c&&c.customFilter&&c.customFilter&&c.customFilter.length>0&&this._applyLookupFilter(y,c),n.push(y)}return n},e.prototype._applyLookupFilter=function(e,t){var r;r=!1;var n=[];if(e&&t){for(var i=0;i<t.customFilter.length;i++){if("END_FLAG"===t.customFilter[i].customFilter){r=!0;break}if("START_FLAG"!==t.customFilter[i].customFilter){var a=Object(l.i)(Object(S.CrmHtmlDecode)(t.customFilter[i].customFilter));a&&(a.conditions&&a.conditions.length>0||a.filters&&a.filters.length>0)&&n.push(JSON.stringify(a))}}r?(this._memorizedExtraFilters=n,e.extraFilters=this._memorizedExtraFilters):e.extraFilters=this._memorizedExtraFilters?this._memorizedExtraFilters:[]}},e.prototype._getMetadataTypeByAttribute=function(e,t){var r=this._getState(),n=Object(d.a)(r,e,t);if(!n)return null;var i=n.Type+"."+n.Format;return Object(u.n)(i)},e.prototype._getActions=function(e){return{completeProcess:function(){return e.completeProcess()},moveNext:function(){return e.moveToNextStage()},movePrevious:function(){return e.moveToPreviousStage()},setActiveStage:function(t){return e.setActiveStage(t.guid)},setSelectedStage:function(t,r){void 0===r&&(r=!1),e.setSelectedStage(t?t.guid:null,r)},triggerActionStepClick:function(t){e.triggerActionStepClick(t)},triggerFlowStepClick:function(t,r){e.triggerFlowStepClick(t,r)},refreshFlowStepClick:function(t){e.refreshFlowStepClick(t)},setDisplayState:function(t){e.setDisplayState(t)},getForwardNavigationEntities:function(t,r,n,i){return e.getForwardNavigationEntities(t,r,n,i)},navigateToNextEntity:function(t,r,n,i){return e.navigateToNextEntity(c.a.fromLegacyEntityReference(t),c.a.fromLegacyEntityReference(r),n,i)},executePreEvent:function(t,r,n,i){return e.executePreEvent(t,r,n,i)},validateRequiredFieldsForNavigation:function(){return e.ValidateRequiredFieldsForNavigation()},waitForOngoingWork:function(){return e.waitForOngoingWork()},getActiveStageActiveFor:function(){return e.getActiveStageActiveFor()},getBpfInstanceActiveFor:function(){return e.getBpfInstanceActiveFor()},getBpfInstanceCompletedIn:function(){return e.getBpfInstanceCompletedIn()},getBpfNavigationBehavior:function(){return e.getBpfNavigationBehavior()},setBpfNavigationBehavior:function(t){e.setBpfNavigationBehavior(t)},getBpfNavigationBehaviorAllowCreateNew:function(t){return e.getBpfNavigationBehaviorAllowCreateNew(t)},getActiveStage:function(){var t=e.getContextToken(),r=e.getScriptContainer().getEventManager().getClientApiForm(t);return r?r.data.process.getActiveStage():null}}},e.prototype._getRelatedEntityReference=function(e){if(!this._navigationEntities)return null;var t=this._navigationEntities.find((function(t){return t.entityLogicalName===e}));return t?new _.a(t.entityLogicalName,i.a.toLegacyGuid(i.a.parse(t.id))):null},e.prototype._getUIControl=function(e,t){if(t){var r=this._getState(),n=Object(g.j)(r,e),i={controlName:t,id:e};return Object(h.Mc)(this._getState(),i,n)}return null},e.prototype._getNonDefaultControlConfiguration=function(e){var t={};if(e)for(var r=Object.keys(e),n=0;n<r.length;n++){var i,a=Object(y.b)(this._getState());(i=e[r[n]].CustomControls[a])&&(t[r[n]]={FormFactor:i.FormFactor,CustomControlId:i.CustomControlId,Name:i.Name,Version:i.Version,Parameters:i.Parameters,ShouldOverrideControlVisible:i.ShouldOverrideControlVisible,DisplayNameKey:i.DisplayNameKey})}return t},e.prototype._getNonDefaultControlStepIds=function(e){var t=[];return e&&Object.keys(e).forEach((function(r){e[r].ParentCellId&&t.push(new i.a(e[r].ParentCellId))})),t},e.prototype._getIsStepRequired=function(e,t){var r=t.stage.steps,n=r?r.map((function(e){return e.stepId.guid})).indexOf(e):-1;return n>=0&&!Object(f.a)(r[n].required)&&r[n].required},e.prototype._getStepTypeFromControlKey=function(e){return e.endsWith("_actionstep")?"action":e.endsWith("_flowstep")?"modernflow":"field"},e}()},A8fJ:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="tab.contentType";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r,a){var o=Object(n.v)(r);return{type:i,payload:a,meta:{pageId:e,tabId:t,contextKey:o}}}},ABRM:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="attribute.format";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r,a){var o=Object(n.x)(t);return{type:i,payload:a,meta:{pageId:e,contextKey:o,dataFieldName:r}}}},AVer:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return u}));var n=r("G7N+"),i=r("Sscr"),a=r("c56u"),o=r("kJGL"),s=r("tNVD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e,t,r,a,o,c,u,d){var p,h=Object(i.v)(o),g=function(e,t){var r;if(!e)return null;var n=new DOMParser,i=e?n.parseFromString(e,"text/xml"):null;if(!i)return null;var a=i.documentElement?i.documentElement.children?i.documentElement.children:i.documentElement.childNodes:void 0;if(!a)return null;for(var o=a,s=[],c=0;c<o.length;c++)if(o[c].getAttribute){for(var u=o[c]?o[c].children?o[c].children:o[c].childNodes:void 0,d=[],p=null,h=0;h<u.length;h++){var g=u[h];if(g.getAttribute){var m=g.getAttribute("name"),f=void 0;f=(r=l(m,p,n,t)).relatedEntityName,p=r.fetchXmlDocument,d.push({name:m,width:parseInt(g.getAttribute("width"),10),relatedEntityName:f,disableMetaDataBinding:"1"===g.getAttribute("disableMetaDataBinding"),labelId:g.getAttribute("labelId"),isHidden:"1"===g.getAttribute("isHidden"),disableSorting:"1"===g.getAttribute("disableSorting"),addedBy:g.getAttribute("addedBy"),desc:g.getAttribute("desc"),cellType:g.getAttribute("cellType"),imageProviderWebresource:g.getAttribute("imageProviderWebresource"),imageProviderFunctionName:g.getAttribute("imageProviderFunctionName")})}}var b={name:o[c].getAttribute("name"),id:o[c].getAttribute("id"),cells:d,multiObjectIdField:o[c].getAttribute("multiObjectIdField"),layoutStyle:o[c].getAttribute("multiObjectIdField")};s.push(b)}return{name:i.documentElement.getAttribute("name"),object:parseInt(i.documentElement.getAttribute("object"),10),rows:s,customControlDescriptions:null,jump:i.documentElement.getAttribute("jump"),select:"1"===i.documentElement.getAttribute("select"),icon:"1"===i.documentElement.getAttribute("icon"),preview:"1"===i.documentElement.getAttribute("preview"),iconRenderer:null}}(d,u),m={initialized:n.a.Initialized,viewId:r,fetchXML:u,entityLogicalName:a,title:c,layoutXML:d,grid:g,isCustomView:!0};return{type:s.a,payload:{views:(p={},p[r.guid]=m,p)},meta:{pageId:e,controlName:t,contextKey:h}}}function l(e,t,r,n){var i="";if(e.indexOf(".")>0){var a=e.split(".")[0];t||(t=r.parseFromString(n,"text/xml"));var o=t.querySelector('link-entity[alias="'+a+'"]');o&&(i=o.getAttribute("name")||"")}return{relatedEntityName:i,fetchXmlDocument:t}}function u(e){return{type:s.f,execute:function(t,r){return(Object(a.w)(t.getState())?o.a.createSqlfromFetchXMLAsync(t,e.fetchXML):Promise.resolve(null)).then((function(t){return e.offlineSqlQuery=t}))}}}},ApiM:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return l}));var n=r("9r0m"),i=r("7z0H"),a=r("Sscr"),o="businessProcessFlow.attributes.add",s="businessProcessFlow.controls.add";function c(e,t,r){var n=Object(a.v)(e);return{type:o,payload:{attributes:d(r)},meta:{pageId:t,contextKey:n}}}function l(e,t,r){var n=Object(a.v)(e);return{type:s,payload:{controls:u(r)},meta:{pageId:t,contextKey:n}}}function u(e){var t={};for(var r in e&&!e.header_process&&(e.header_process={Id:null,Label:null,Name:"header_process",ShowLabel:!1,Visible:!0,Disabled:!1,DataFieldName:null,UniqueId:null,ClassId:n.a.tryParse("06E9F7AF-1F54-4681-8EEC-1E21A1CEB465")}),e){var a=Object(i.f)(e[r],null,!0);a&&(t[r]=a)}return t}function d(e){var t={};for(var r in e){var n=e[r],i={Precision:n.Precision,PrecisionSource:n.PrecisionSource,RequiredLevel:n.RequiredLevel,Format:n.Format,OptionSet:n.OptionSet,IsValidForCreate:n.IsValidForCreate,IsValidForUpdate:n.IsValidForUpdate,Targets:n.Targets};t[n.LogicalName]=i}return t}},AtAR:function(e,t,r){"use strict";r.d(t,"a",(function(){return Rr}));var n=r("4E+q"),i=r("c/eZ"),a=r("nuS9"),o=r("4fxQ"),s=r("zSKH"),c=r("jFO5"),l=r("ASFs"),u=r("HSdq"),d=r("ar+e"),p=r("s0Zj"),h=r("gvL4"),g=r("9rQ4"),m=r("ovDt"),f=r("sOTk"),b=r("5olG"),y=r("aPRd"),v=r("Sscr"),_=r("ePaV"),S=r("wV3W"),O=r("/W63"),C=r("Ww2r"),I=r("5Hhq"),j=r("gPjR"),P=r("22IK"),F=r("lMVv"),T=r("eoKI"),w=r("Axwz"),E=r("OTOS"),x=r("YWpA"),N=r("VlhU"),A=r("Srej"),k=r("3JmW"),M=r("49kd"),D=function(e){function t(t){var r=e.call(this,t)||this;return r._dataId="tablist-",r._displayedTabs=[],r._overflowTabs=[],r._previousTabItems=[],r._keyDownHandler=r._keyDownHandler.bind(r),r._selectRelatedEntityHandler=r._selectRelatedEntityHandler.bind(r),r._flyoutKeyDownHandler=r._flyoutKeyDownHandler.bind(r),r._ulRef=r._ulRef.bind(r),r._toggleFlyout=r._toggleFlyout.bind(r),r._closeFlyout=r._closeFlyout.bind(r),r.onMeasuring=r.onMeasuring.bind(r),r._backgroundCanvas=document.createElement("canvas"),r.state={isFlyoutOpened:!1,retrieveMissingRelatedEntitiesFinished:!1},r._previousHeaderCollapsed=t.headerCollapsed,r}return Object(i.__extends)(t,e),t.prototype.onMeasuring=function(e){this._previousWidth!==e&&(this._previousWidth=e),this._reflowTabs(e)},t.prototype.componentDidMount=function(){this._previousHeaderCollapsed=this.props.headerCollapsed},t.prototype.componentDidUpdate=function(){var e,t,r;if(this._tabNavigatorList)if(null===(e=this.props.selectedRelatedEntity)||void 0===e?void 0:e.isSelected){for(var n=null===(t=o.findDOMNode(this._tabNavigatorList))||void 0===t?void 0:t.childNodes,i=void 0,a=0;a<this.props.tabItems.length;a++)this.props.tabItems[a].name===this.props.selectedRelatedEntity.id&&this.props.tabItems[a].id===k.a&&(i=this.props.tabItems[a].id);if(i){var s=void 0;for(a=0;a<n.length;a++)if(Object(k.g)(n[a].id,this.props.id)===i){s=a;break}n[s]&&this._previousFocusedItem!==n[s]&&(n[s].focus(),this._previousFocusedItem=n[s],this.props.selectedTabId&&this.props.selectRelatedTab(this.props.selectedRelatedEntity,this.props.contextToken))}}else{for(n=null===(r=o.findDOMNode(this._tabNavigatorList))||void 0===r?void 0:r.childNodes,s=void 0,a=0;a<n.length;a++)if(Object(k.g)(n[a].id,this.props.id)===this.props.selectedTabId){s=a;break}n[s]&&this._previousFocusedItem!==n[s]&&(n[s].focus(),this._previousFocusedItem=n[s])}this._previousHeaderCollapsed=this.props.headerCollapsed},t.prototype.componentWillReceiveProps=function(e){e.headerCollapsed!==this._previousHeaderCollapsed&&this.state.isFlyoutOpened&&this._toggleFlyout()},t.prototype.componentWillUnmount=function(){this.props.updateVisitedTabNames(this.props.selectedTabId)},t.prototype._renderAssociativeOrGanttGrid=function(){return a.createElement(M.a,{id:this.props.id,selectedRelatedEntity:this.props.selectedRelatedEntity,isAuditFeatureEnabled:this.props.isAuditFeatureEnabled,contextToken:this.props.contextToken,formId:this.props.formId.guid,entityName:this.props.entityTypeName,recordId:this.props.entityId.guid,style:this.props.associatedGridContainerStyle})},t.prototype._createOnClick=function(e){var t=this;return function(){e===k.b||"more_tab"===e?(t.props.retrieveMissingRelatedEntities(t.props.entityTypeName).then((function(e){e&&t.setState({retrieveMissingRelatedEntitiesFinished:!0})})),t._toggleFlyout()):(t.props.selectTab(e,t.props.contextToken,t.props.selectedRelatedEntity),t._overflowTabs.findIndex((function(t){return t.id===e}))>-1&&t._toggleFlyout())}},t.prototype._keyDownHandler=function(e){var t,r,n=this,i=null===(t=e.target)||void 0===t?void 0:t.id;if(this._tabNavigatorList){var a=null===(r=o.findDOMNode(this._tabNavigatorList))||void 0===r?void 0:r.childNodes;if(a&&a.length>0){for(var s=void 0,c=0;c<a.length;c++)if(a[c].id===i){s=c;break}if(e.keyCode===g.a.LeftArrow)a[(s-1+a.length)%a.length].focus();else if(e.keyCode===g.a.RightArrow)a[(s+1+a.length)%a.length].focus();else if(e.keyCode===g.a.Enter||e.keyCode===g.a.Space)if(Object(k.g)(i,this.props.id)===k.b||"more_tab"===Object(k.g)(i,this.props.id))this.props.retrieveMissingRelatedEntities(this.props.entityTypeName).then((function(e){e&&n.setState({retrieveMissingRelatedEntitiesFinished:!0})})),this._toggleFlyout();else{var l=this.props.tabItems.find((function(e){return e.id===Object(k.g)(i,n.props.id)})),u=null==l?void 0:l.id;this.props.selectTab(u,this.props.contextToken,this.props.selectedRelatedEntity)}}}},t.prototype._flyoutKeyDownHandler=function(e){var t,r,n=Object(k.g)(null===(t=e.target)||void 0===t?void 0:t.id,this.props.id);if(e.keyCode===g.a.Enter||e.keyCode===g.a.Space){var i=null===(r=this.props.tabItems.find((function(e){return e.id===n})))||void 0===r?void 0:r.id;this.props.selectTab(i,this.props.contextToken,this.props.selectedRelatedEntity),this._toggleFlyout()}},t.prototype._toggleFlyout=function(){this.setState({isFlyoutOpened:!this.state.isFlyoutOpened})},t.prototype._renderTabFlyout=function(e){var t=this,r=this._overflowTabs.length>0?"more_tab":k.b,n=this.props.headerCollapsed===this._previousHeaderCollapsed&&this.state.isFlyoutOpened;return a.createElement(m.a,{key:Object(A.g)(k.a,this.props.id),id:this.props.id,relativeElementId:Object(A.g)(r,this.props.id),isFlyoutOpened:n,moreTabItems:e,selectTab:this._flyoutKeyDownHandler,selectRelatedEntity:this._selectRelatedEntityHandler,closeFlyout:function(e){return t._closeFlyout(e)},retrieveMissingRelatedEntitiesFinished:this.state.retrieveMissingRelatedEntitiesFinished,isInCreateMode:this.props.isInCreateMode,tabNavigatorList:this._tabNavigatorList})},t.prototype._renderTabList=function(e){var t=Object(C.c)(this.props.resourceStrings,I.b),r=t?String.format(t,this.props.entityDisplayName):"";return a.createElement(x.a,{isRequestedMeasuring:!0,onMeasuring:this.onMeasuring},a.createElement(h.a,{id:Object(A.g)(k.c,this.props.id),key:k.c+(e&&e.length),role:"tablist",ref:this._ulRef,style:this.props.tabListStyle,onKeyDown:this._keyDownHandler,accessibilityLabel:r},e))},t.prototype._renderTabContent=function(){var e;if(this.props.selectedTabId&&!(null===(e=this.props.selectedRelatedEntity)||void 0===e?void 0:e.isSelected)){for(var t=[],r=0,n=this.props.tabItems;r<n.length;r++){var o=n[r],c=this.props.selectedTabId===o.id;t.push(a.createElement(s.a,{renderHeaderFields:this.props.renderHeaderFields,renderFooterFields:this.props.renderFooterFields,key:"tab_"+o.id,id:this.props.id,tabId:o.id,tabName:o.name,showTab:c,labelledBy:o.id,columnStyle:this.props.columnStyle,sectionStyle:this.props.sectionStyle,cellStyle:this.props.cellStyle,cellContainerStyle:this.props.cellContainerStyle,style:Object(i.__assign)(Object(i.__assign)({},this.props.tabBasicStyle),c?this.props.selectedTabStyle:this.props.tabStyle),showFooterFieldsRenderInSection:this.props.showFooterFieldsRenderInSection,viewportElementId:this.props.viewportElementId}))}return a.createElement(x.a,{style:this.props.tabsContainerStyle},t)}return this.props.selectedRelatedEntity&&this.props.selectedRelatedEntity.isSelected?a.createElement(x.a,{style:this.props.containerStyle},this._renderAssociativeOrGanttGrid()):null},t.prototype._getTabLabelWidth=function(e){var t,r,n=this._backgroundCanvas.getContext("2d");if(this.props.tabListItemStyles&&this.props.tabListItemStyles.selectedTabStyle&&this.props.tabListItemStyles.selectedTabStyle.fontSize&&this.props.tabListItemStyles.selectedTabStyle.fontFamily?n.font=Object(b.a)(parseFloat(this.props.tabListItemStyles.selectedTabStyle.fontSize))+"px "+this.props.tabListItemStyles.selectedTabStyle.fontFamily:n.font="14px Segoe UI",this.props.tabListItemStyles&&this.props.tabListItemStyles.tabStyle&&this.props.tabListItemStyles.tabStyle.maxWidth&&(this.props.tabListItemStyles.tabStyle.marginLeft||this.props.tabListItemStyles.tabStyle.marginRight)){var i=this.props.tabListItemStyles.tabStyle.maxWidth.toString();i.length&&(t=Number(i.substr(0,i.length-2)));var a=this.props.tabListItemStyles.tabStyle.marginLeft?this.props.tabListItemStyles.tabStyle.marginLeft.toString():this.props.tabListItemStyles.tabStyle.marginRight.toString();r=Number(a.substr(0,a.length-2))}return e.length>t?n.measureText(e.substr(0,t)).width+r:n.measureText(e).width+r},t.prototype._reflowTabs=function(e){this._displayedTabs=[],this._overflowTabs=[];for(var t=this.props.tabListStyle?Object(b.e)(this.props.tabListStyle.paddingLeft.toString()):0,r=this.props.tabListStyle?Object(b.e)(this.props.tabListStyle.paddingRight.toString()):0,n=Object(k.d)(this.props.tabItems),i=(n?this._getTabLabelWidth(n.label):26)+r+t,a=Math.floor(e),o=0,s=this.props.tabItems;o<s.length;o++){var c=s[o],l=c.id,u=c.label;if(c.visible){var d=this._getTabLabelWidth(u);if(i+=d,c.id!==k.b)if(i<a)this._displayedTabs.push(c);else if(l===this.props.selectedTabId||l===k.a&&this.props.selectedRelatedEntity&&this.props.selectedRelatedEntity.isSelected){for(var p=this._numberOfTabsToRemove(this._displayedTabs,d),h=0,g=this._displayedTabs.splice(this._displayedTabs.length-p,p);h<g.length;h++){var m=g[h];this._overflowTabs.unshift(m)}this._displayedTabs.push(c)}else l!==k.a&&this._overflowTabs.push(c)}}},t.prototype._numberOfTabsToRemove=function(e,t){for(var r=0,n=0,i=e.length-1;i>=0;i--){if(t<=this._getTabLabelWidth(e[i].label)+r)return++n;r+=this._getTabLabelWidth(e[i].label),n++}return n},t.prototype.render=function(){var e=[],t=[];this._previousWidth&&this._displayedTabs.length>0&&(this._previousTabItems!==this.props.tabItems||this._previousSelectedTabId!==this.props.selectedTabId||this._previousSelectedRelatedEntity!==this.props.selectedRelatedEntity)&&(this._previousTabItems=this.props.tabItems,this._previousSelectedTabId=this.props.selectedTabId,this._previousSelectedRelatedEntity=this.props.selectedRelatedEntity,this._reflowTabs(this._previousWidth)),0===this._displayedTabs.length&&this.props.initialWidth&&this._reflowTabs(this.props.initialWidth);for(var r=0,n=this._displayedTabs;r<n.length;r++){var i=(j=n[r]).name,o=j.label,s=j.id,l=j.previewId,u=this._createOnClick(s),d=this.props.selectedRelatedEntity&&this.props.selectedRelatedEntity.isSelected?k.a===s:this.props.selectedTabId===s;e.push(a.createElement(c.a,{key:i,tabName:i,label:o,isSelected:d,relatedTabId:Object(A.g)(k.b,this.props.id),isFlyoutOpened:this.state.isFlyoutOpened,testhooks:Object(k.e)({id:this._dataId+i},l),id:Object(A.g)(s,this.props.id),tabLength:this.props.tabItems.length,onClick:u}))}if(this._overflowTabs.length>0){var p=Object(A.g)("more_tab",this.props.id),h=Object(C.c)(this.props.resourceStrings,I.c),g=this._createOnClick("more_tab");e.push(a.createElement(c.a,{key:Object(A.g)("more_tab",this.props.id),tabName:p,label:h,isSelected:!1,id:Object(A.g)("more_tab",this.props.id),testhooks:{id:Object(A.g)("more_tab",this.props.id)},style:this.props.overflowTabListItemStyle,isMoreTab:!0,isFlyoutOpened:this.state.isFlyoutOpened,tabLength:this.props.tabItems.length,onClick:g}))}else if(Object(k.d)(this.props.tabItems)){var m=Object(k.d)(this.props.tabItems),f=m.name,b=m.label,y=this.props.selectedTabId===k.b,v=m.previewId,_=this._createOnClick(k.b);e.push(a.createElement(c.a,{key:f,tabName:f,label:b,isSelected:y,relatedTabId:Object(A.g)(k.b,this.props.id),isFlyoutOpened:this.state.isFlyoutOpened,testhooks:Object(k.e)({id:this._dataId+f},v),id:Object(A.g)(k.b,this.props.id),tabLength:this.props.tabItems.length,onClick:_}))}for(var S=0,O=this._overflowTabs;S<O.length;S++){var j;i=(j=O[S]).name,o=j.label,s=j.id,l=j.previewId,u=this._createOnClick(s);t.push(a.createElement(c.a,{key:i,tabName:i,label:o,isSelected:!1,relatedTabId:Object(A.g)(k.b,this.props.id),isFlyoutOpened:this.state.isFlyoutOpened,testhooks:Object(k.e)({id:this._dataId+i},l),id:Object(A.g)(s,this.props.id),tabLength:this.props.tabItems.length,onClick:u,style:this.props.overflowTabListItemStyle}))}return this.props.returnTabsBody?this._renderTabContent():this.props.showTabNavigator?a.createElement(x.a,{style:this.props.headerStyle},this._renderTabList(e),this._renderTabFlyout(t)):null},t.prototype._closeFlyout=function(e){e&&e.target&&e.target.id!==k.b&&this._toggleFlyout()},t.prototype._ulRef=function(e){this._tabNavigatorList=e},t.prototype._selectRelatedEntityHandler=function(e){this._toggleFlyout(),this.props.selectRelatedTab(e,this.props.contextToken)},t}(a.Component);D.displayName="TabNavigator";var R=Object(n.a)((function(){var e=Object(k.f)(),t=Object(d.f)(),r=Object(_.a)(),n=Object(j.a)(),a=Object(C.h)(),o=null;return function(s,c){var p=a(s,I.f),h=Object(v.j)(s,c.id);Object(l.e)(o,h)||(o=h);for(var g=Object(f.g)(s,c.id),m=Object(y.c)(s),b=g,_=Object(f.m)(s,c.id),O=_?null:t(s,c),C=Object(d.e)(s,c,o),j=e(s,{props:c,resourceStrings:p,selectedRelatedEntity:C,isInCreateMode:_}),P=Object(u.wc)(s,c,o),w=!0,x=0,N=j;x<N.length;x++){P!==(M=N[x]).id||M.visible||(w=!1)}if(!w)for(var A=0,k=j;A<k.length;A++){var M;if((M=k[A]).visible){P=M.id;break}}var D=r(s,Object(i.__assign)(Object(i.__assign)({},c),{viewPortWidth:m}),c.headerCollapsed,c.enabledFormFCBs),R=Object(S.a)(s),B=Object(E.b)(s,c.id),L=n(s),V="",z=null,G=!0;b&&(V=b.entityTypeName,z=b.id,G=!b.bodyOnly);var W=Object(T.a)(s,V),H=Object(F.h)(s,V);return{selectedTabId:P,relatedEntities:O,tabItems:j,selectedRelatedEntity:C,entityTypeName:V,entityId:z,tabListStyle:D.tabListStyle,scrollableTabListStyle:D.scrollableTabListStyle,tabBasicStyle:D.tabBasicStyle,containerStyle:D.containerStyle,tabsContainerStyle:D.tabsContainerStyle,headerStyle:D.headerStyle,cellContainerStyle:D.cellContainerStyle,selectedTabStyle:D.selectedTabStyle,semanticZoomListItemStyle:D.semanticZoomListItemStyle,customSemanticZoomButtonStyle:D.customSemanticZoomButtonStyle,overflowTabListItemStyle:D.overflowTabListItemStyle,contextToken:o,associatedGridContainerStyle:D.associatedGridContainerStyle,semanticZoomTabListItemWidthInEm:R.sizes.TabNavigator.SemanticZoomTabListItemWidthInEm,overflowtItemWidthInEm:R.sizes.TabNavigator.OverflowtItemWidthInEm,tabListItemStyles:L,formId:B,resourceStrings:p,isInCreateMode:_,entityDisplayName:H.DisplayName,showTabNavigator:G,viewportElementId:c.viewportElementId,isAuditFeatureEnabled:W}}}),(function(e,t){return{selectTab:function(r,n,a){if(r===k.a){if(a){var o=Object(v.a)(n,a.relationshipName,a.ordinal),s=Object(i.__assign)(Object(i.__assign)({},a),{isSelected:!0});e(Object(p.b)(t.id,void 0,n)),e(Object(O.a)(t.id,o,s)),t.afterSelectTab()}}else{if(a&&a.isSelected){s=Object(i.__assign)(Object(i.__assign)({},a),{isSelected:!1});e(Object(N.b)(t.id,n,s))}e(Object(p.b)(t.id,r,n)),t.afterSelectTab()}},selectRelatedTab:function(r,n){if(r){var a=Object(v.a)(n,r.relationshipName,r.ordinal),o=Object(i.__assign)(Object(i.__assign)({},r),{isSelected:!0});e(Object(p.b)(t.id,void 0,n)),e(Object(O.a)(t.id,a,o)),t.afterSelectTab()}else e(Object(p.b)(t.id,void 0,n)),t.afterSelectTab()},updateVisitedTabNames:function(r){e(Object(w.b)(t.id,r))},retrieveMissingRelatedEntities:function(t){return e(Object(P.a)(t))}}}))(D),B=r("NxDw"),L=r("DgF7"),V=r("gUzs");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function z(e){var t=e.viewPortWidthLessThanOrEqualToSmallBreakpoint?11.85:17.15;return e.bpfControlRendered||(t-=4),e.clientHost===B.a.MobileApplication&&e.bpfControlRendered&&(t-=.5),!e.viewPortWidthLessThanOrEqualToSmallBreakpoint&&e.viewPortWidthLessThanOrEqualToMediumBreakpoint&&(t-=.25),e.formNotificationHeight&&(t+=Object(b.b)(e.formNotificationHeight)+.15),e.hasCmdBar||e.viewPortWidthLessThanOrEqualToSmallBreakpoint||(t-=3),t+"rem"}function G(e){if(!e.headerCollapsed)return"none";var t=e.viewPortWidthLessThanOrEqualToSmallBreakpoint?1.6:3;return e.bpfControlRendered&&(t+=.75),"translateY(-"+t+"rem)"}function W(e){return a.createElement(x.a,{id:"shadow",style:{position:"absolute",height:"4px",width:"100%",top:z(e),opacity:e.tabScrolledToTop?0:1,background:"linear-gradient(180deg, rgba(0,0,0,.35), rgba(0, 0, 0, 0))",transition:V.c,transform:G(e)}})}W.displayName="Shadow";var H=Object(n.a)((function(){return function(e,t){var r=Object(v.j)(e,t.id),n=Object(u.o)(e,t.id,r),i=Object(y.c)(e),a=Object(S.a)(e);return{bpfControlRendered:n,clientHost:Object(L.a)(e),viewPortWidthLessThanOrEqualToSmallBreakpoint:i<=a.sizes.Breakpoints.DimensionS,viewPortWidthLessThanOrEqualToMediumBreakpoint:i<=a.sizes.Breakpoints.DimensionM}}}),(function(e,t){return{}}))(W),U=r("NJzV"),q=r("QAhb"),X=r("9r0m"),K=r("G7N+"),Q=r("TCcM"),Y=r("T576"),Z=r("IfuP"),J=r("UVKb"),$=r("lFQy"),ee=r("Jcuz"),te=r("0z0R"),re=r("S2mk"),ne=r("t8f4"),ie=r("JQi7"),ae=r("VcAV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var oe,se;!function(e){e[e.BreadCrumb=0]="BreadCrumb",e[e.Stage=1]="Stage"}(oe||(oe={})),function(e){e[e.Initializing=0]="Initializing",e[e.MetadataReady=1]="MetadataReady",e[e.ReadyToRender=2]="ReadyToRender"}(se||(se={}));var ce=function(e){function t(t){var r=e.call(this,t)||this;r._flowStepInitInProgress=!1,r.state={status:se.Initializing};var n=t.renderingMode===oe.BreadCrumb?"MscrmControls.Containers.ProcessBreadCrumb":"MscrmControls.Containers.ProcessStageControl";return r._CCF_config=Object(re.o)(n),r}return Object(i.__extends)(t,e),t.prototype.render=function(){return!this.props.workflowObjectModelLibraryLoaded||!this.props.processInstanceId||this.props.descriptor&&!this.props.descriptor.hasOwnProperty("businessProcessFlowId")?null:this.props.renderingMode===oe.BreadCrumb&&this.props.processInstanceId&&this.state.status!==se.Initializing?a.createElement(x.a,{id:"bpfContainer",key:"bpfContainer",style:this.props.breadCrumbContainerStyle},a.createElement(U.c,{key:"businessProcessFlow",id:this.props.id,controlId:"MscrmControls.Containers.ProcessBreadCrumb",configuration:this._CCF_config,descriptor:t._CCF_BC_descriptor,parentContextToken:this.props.contextToken})):this.state.status===se.ReadyToRender?a.createElement(U.c,{key:"businessProcessFlowStage",id:this.props.id,controlId:"MscrmControls.Containers.ProcessStageControl",configuration:this._CCF_config,descriptor:t._CCF_STAGE_descriptor,parentContextToken:this.props.contextToken}):null},t.prototype.componentDidMount=function(){this._checkForStatusUpdate()},t.prototype.componentDidUpdate=function(){this._checkForStatusUpdate()},t.prototype._checkForStatusUpdate=function(){switch(this.state.status){case se.Initializing:this._loadDescriptorsIfUnavailable(),this._updateSelectedStageFromParams(),this._isMetadataReady()&&this.setState({status:se.MetadataReady});break;case se.MetadataReady:this._isProcessControlLoadable()&&(this._loadActionLogs(),this._loadFlowStepFlowIdsIfUnavailable(),this.setState({status:se.ReadyToRender}));break;case se.ReadyToRender:this._isProcessControlLoadable()&&this._loadFlowStepFlowIdsIfUnavailable()}},t.prototype._updateSelectedStageFromParams=function(){if(this.props.selectedStageId&&!X.a.equals(this.props.selectedStageId,X.a.EMPTY)){var e={selectedStageId:this.props.selectedStageId},t=new q.a("businessprocessflowinstance",this.props.processInstanceId);if(this.props.updateBusinessProcessFlowData(e,t),!this.props.displayState){this.props.updateDisplayState("floating",t)}}},t.prototype._loadDescriptorsIfUnavailable=function(){this.props.processDescriptorLoaded||this.props.processId||this.props.currentEntity||this.props.retrieveBusinessProcessFlowDescriptor(this.props.processId,this.props.currentEntity)},t.prototype._loadFlowStepFlowIdsIfUnavailable=function(){var e=this;if(this.props.descriptor&&this.props.descriptor.businessProcessFlowFlows&&!this._flowStepInitInProgress){var t=this.props.descriptor.businessProcessFlowFlows;for(var r in t){var n=t[r];if(n.workflowId&&!n.flowId)return this._flowStepInitInProgress=!0,void this.props.retrieveBusinessProcessFlowFlowStepFlowIds(this.props.processId).then((function(){e._flowStepInitInProgress=!1}),(function(t){e._flowStepInitInProgress=!1}))}}},t.prototype._loadActionLogs=function(){if(this.props.descriptor&&this.props.descriptor.businessProcessFlowEntities&&this.props.renderingMode===oe.Stage)for(var e=0,t=this.props.descriptor.businessProcessFlowEntities;e<t.length;e++){var r=t[e];if(r.stage)for(var n=0,i=r.stage.steps;n<i.length;n++){var a=i[n].stepType.toLowerCase();if("action"===a||"modernflow"===a)return void this.props.retrieveBusinessProcessFlowActionLogs(this.props.processId,new q.a(this.props.descriptor.businessProcessFlowUniqueName,this.props.processInstanceId))}}},t.prototype._isProcessControlLoadable=function(){return!!this.props.processInstanceId},t.prototype._isMetadataReady=function(){return!!this.props.processControlEnabled&&(!!this.props.currentEntity&&(!(!this.props.processId||X.a.equals(this.props.processId,X.a.EMPTY))&&!!this.props.processDescriptorLoaded))},t._CCF_BC_descriptor={Id:"MscrmControls.Containers.ProcessBreadCrumb",Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1},t._CCF_STAGE_descriptor={Id:"MscrmControls.Containers.ProcessStageControl",Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1},t}(a.Component);ce.displayName="BusinessProcessFlow";var le=Object(n.a)((function(){var e,t,r,n,i=function(e,t){if(void 0!==t.id||void 0!==t.processId){if(!t.id)return X.a.EMPTY;var r=Object(f.a)(e,t),n=new q.a(r.entityTypeName,r.id);return Object(Q.e)(e,n)}},a=function(e,t){if(void 0!==t.id||void 0!==t.processId){if(!t.id)return X.a.EMPTY;var r=Object(f.a)(e,t),n=new q.a(r.entityTypeName,r.id);return Object(Q.f)(e,n)}},o=function(e,t){return!!(e&&e.metadata&&e.metadata.controlManifests&&e.metadata.controlManifests.hasOwnProperty("MscrmControls.Containers.ProcessBreadCrumb")&&e.metadata.controlManifests.hasOwnProperty("MscrmControls.Containers.ProcessBreadCrumb"))},s=(e=!1,function(t,r){var n=Object(f.a)(t,r),i=new q.a(n.entityTypeName,n.id),a=Object(Q.e)(t,i),o=a?Object(Y.a)(t,a):null,s=null!==o&&o.initialized===K.a.Initialized;return s!==e&&(e=s),e}),c=function(e,t){var r=Object(f.a)(e,t),n=new q.a(r.entityTypeName,r.id),i=Object(Q.e)(e,n);return i?Object(Y.a)(e,i):null},l=(t=null,function(e,r){var n=Object(f.a)(e,r),i=new q.a(n.entityTypeName,n.id);return t||(t=i),i.id===t.id&&i.etn===t.etn||(t=i),t}),u=(r=null,function(e,t){var n=Object(f.a)(e,t);return n.selectedStageId&&!X.a.equals(r,X.a.tryParse(n.selectedStageId))&&(r=X.a.parse(n.selectedStageId)),r}),d=(n=null,function(e,t){var r=function(e){return e&&e.businessProcessFlowData&&e.businessProcessFlowData.displayState?e.businessProcessFlowData.displayState:null}(e);return n!==r&&(n=r),n});return function(e,t){var r=i(e,t),n=a(e,t),p=o(e,t),h=s(e,t),g=c(e,t),m=l(e,t),f=u(e,t),b=d(e,t),y=Object(Y.h)(e);return{processId:r,processControlEnabled:p,processInstanceId:n,processDescriptorLoaded:h,currentEntity:m,selectedStageId:f,displayState:b,descriptor:g,contextToken:t.contextToken,workflowObjectModelLibraryLoaded:y}}}),(function(e,t){return{retrieveBusinessProcessFlowDescriptor:function(t,r){return e(Object(Z.a)(t,r))},updateBusinessProcessFlowData:function(t,r){return e(Object($.a)(t,r))},updateDisplayState:function(t,r){return e(Object(ee.a)(t,r))},retrieveBusinessProcessFlowActionLogs:function(t,r){return e(Object(J.a)(t,r))},retrieveBusinessProcessFlowFlowStepFlowIds:function(t){return e(function(e){return{type:"businessprocessflow.flowstep.flowids.retrieve",execute:function(t,r){var n=t.dispatch,i=t.getState,a=r.TraceManager.getTracer("businessProcessFlow.retrieveBusinessProcessFlowFlowStepFlowIds"),o=i().metadata.businessProcessFlows;if(Object(ae.c)(o))a.warn("Skip retrieveBusinessProcessFlowFlowStepFlowIds: IsNullOrUndefined businessProcessFlowsById: "+o);else{var s=o[e.guid];if(Object(ae.c)(s))a.warn("Skip retrieveBusinessProcessFlowFlowStepFlowIds for processId: "+e.guid.toString()+". IsNullOrUndefined businessProcessFlowDescriptor: "+s);else{var c=s.businessProcessFlowFlows;if(!Object(ae.c)(c)){var l=[];for(var u in c){var d=c[u];if(Object(ae.c)(d))a.warn("failure in retrieveBusinessProcessFlowFlowStepFlowIds for processId: "+e.guid.toString()+". IsNullOrUndefined businessProcessFlowFlowDescriptor: "+d);else{var p=d.workflowId;Object(ae.c)(p)?a.warn("failure in retrieveBusinessProcessFlowFlowStepFlowIds for processId: "+e.guid.toString()+". IsNullOrUndefined workflowId: "+p):l.indexOf(p)<0&&l.push(p)}}for(var h="?$select=workflowidunique,workflowid&$filter=",g=!0,m=0;m<l.length;m++){var f=String.format("(workflowid%20eq%20({0}))",l[m]);g?(h+=f,g=!1):(h+="%20or%20",h+=f)}return a.info("retrieveBusinessProcessFlowFlowStepFlowIds OData RetrieveMultiple querystring: "+h),n(Object(ne.e)("workflow",h)).then((function(t){t.value&&t.value.length&&(t.value.forEach((function(t){for(var r in c){var n=c[r];Object(ae.c)(n)?a.warn("failure in retrieveBusinessProcessFlowFlowStepFlowIds for processId: "+e.guid.toString()+". IsNullOrUndefined businessProcessFlowFlowDescriptor: "+n):(a.info("retrieveBusinessProcessFlowFlowStepFlowIds comparing workflowid: "+n.workflowId+". workflowidunique: "+n.flowId),n.workflowId===t.workflowid&&(n.flowId=t.workflowidunique,a.info("set businessProcessFlowFlowDescriptor.flowId: "+n.flowId+". actionid: "+n.actionId)))}})),n(Object(ie.b)(o)))}))}a.warn("Skip retrieveBusinessProcessFlowFlowStepFlowIds for processId: "+e.guid.toString()+". IsNullOrUndefined businessProcessFlowFlowDescriptorDictionary: "+c)}}}}}(t))},offlineBPFMultipleInstancesAlert:function(r){return e(Object(te.a)(r,t.id))}}}))(ce),ue=r("xDkz"),de=r("XOZu"),pe=r("znb3"),he=r("XIN1"),ge=r("H/hG"),me=r("7sMj"),fe=r("tyZ/"),be=r("36WT"),ye=r("7EJx"),ve=V.c+",opacity 0.125s linear";function _e(e,t,r){var n={position:"relative",width:"100%",paddingLeft:t<=e.sizes.Breakpoints.DimensionS?e.sizes.Measures.Measure100:e.sizes.Measures.Measure150,paddingRight:t<=e.sizes.Breakpoints.DimensionS?e.sizes.Measures.Measure100:e.sizes.Measures.Measure150,display:"flex",justifyContent:"space-between",flex:"1 0 auto",flexWrap:"wrap",boxSizing:"border-box",backgroundColor:e.colors.WhiteBackground};return t>e.sizes.Breakpoints.DimensionS?n=Object(i.__assign)(Object(i.__assign)({},n),{paddingTop:e.sizes.Measures.Measure150,height:e.sizes.Measures.Measure675,maxHeight:e.sizes.Measures.Measure675}):t<=e.sizes.Breakpoints.DimensionS&&(n=Object(i.__assign)(Object(i.__assign)({},n),{paddingTop:e.sizes.Measures.Measure075,height:e.sizes.Measures.Measure450,maxHeight:e.sizes.Measures.Measure450})),r||(n.display="none"),n}function Se(e,t,r,n,i){var a=t<=e.sizes.Breakpoints.DimensionS?.5:1.15;n&&i&&(a+=.15);var o=a+"rem",s={border:"2px transparent solid",transition:V.c,transform:r?"scale(0.75) translateY(-"+o+")":"none",transformOrigin:"left"};return t>=e.sizes.Breakpoints.DimensionL||t<e.sizes.Breakpoints.DimensionL&&t>e.sizes.Breakpoints.DimensionS?Object.assign(s,{height:e.sizes.Measures.Measure350,width:e.sizes.Measures.Measure350,minWidth:e.sizes.Measures.Measure350,lineHeight:e.sizes.Measures.Measure350,fontSize:e.fontSizes.Font150,marginRight:e.sizes.Measures.Measure100}):Object.assign(s,{height:e.sizes.Measures.Measure250,width:e.sizes.Measures.Measure250,minWidth:e.sizes.Measures.Measure250,lineHeight:e.sizes.Measures.Measure250,fontSize:e.fontSizes.Font100,marginRight:e.sizes.Measures.Measure050}),s}function Oe(e,t){return t>=e.sizes.Breakpoints.DimensionL||t<e.sizes.Breakpoints.DimensionL&&t>e.sizes.Breakpoints.DimensionS?{height:e.sizes.Measures.Measure250,width:e.sizes.Measures.Measure250,minWidth:e.sizes.Measures.Measure250}:{height:e.sizes.Measures.Measure150,width:e.sizes.Measures.Measure150,minWidth:e.sizes.Measures.Measure150}}function Ce(e,t,r,n,a,o,s,c){var l={fontFamily:e.fontFamilies.Regular,maxWidth:"100%",opacity:1,transform:"translate(0rem,0rem)"},u={};if(t>=e.sizes.Breakpoints.DimensionL)u={height:r?n?e.sizes.Measures.Measure100:e.sizes.Measures.Measure175:a?e.sizes.Measures.Measure150:e.sizes.Measures.Measure200,lineHeight:r?n?e.sizes.Measures.Measure100:e.sizes.Measures.Measure150:a?e.sizes.Measures.Measure150:e.sizes.Measures.Measure200};else if(t<e.sizes.Breakpoints.DimensionL&&t>e.sizes.Breakpoints.DimensionS){u={opacity:1,height:r?n?e.sizes.Measures.Measure100:e.sizes.Measures.Measure175:a?e.sizes.Measures.Measure150:e.sizes.Measures.Measure200,lineHeight:r?n?e.sizes.Measures.Measure100:e.sizes.Measures.Measure150:a?e.sizes.Measures.Measure150:e.sizes.Measures.Measure200}}else u={fontSize:e.sizes.Measures.Measure100,height:n?e.sizes.Measures.Measure100:e.sizes.Measures.Measure175,lineHeight:n?e.sizes.Measures.Measure100:e.sizes.Measures.Measure150};if(o&&(n&&(u.transform="translate(-"+e.sizes.Measures.Measure100+", -"+e.sizes.Measures.Measure225+")",u.opacity=0),!n&&!a)){var d=t<=e.sizes.Breakpoints.DimensionS?"0rem":"1.4rem",p=t<=e.sizes.Breakpoints.DimensionS?1.15:r?1.5:2.25;s&&c&&(p+=.15);var h=p+"rem";u.transform="translate(-"+d+", -"+h+")"}return Object(i.__assign)(Object(i.__assign)({},l),u)}var Ie=r("9rlF"),je=r("TVue"),Pe=r("rQCE");var Fe=r("HRxj"),Te=r("jaaU"),we=r("Tr6b"),Ee=r("Wi7Z"),xe=r("i8/j"),Ne=r("swEE"),Ae=r("enCe"),ke=r("+ulc"),Me=r("EVAY"),De=r("kyRo"),Re=r("uQP8"),Be=function(e){function t(t){var r=e.call(this,t)||this;return r._nonOverflowControls=[],r._nonOverflowControlNames=new Set,r._overflowControls=[],r._minimumCellWidth=1,r._previousHeaderCollaped=!1,r.onMeasuring=r.onMeasuring.bind(r),r.state={previousWidth:0,maximumNumberOfControls:0},r}return Object(i.__extends)(t,e),t.prototype.componentWillMount=function(){this._minimumCellWidth=Object(b.a)(this.props.minimumCellWidth)},t.prototype.onMeasuring=function(e){var t=[{name:"currentWidth",value:e}];if(this._clearControls(),e!==this.state.previousWidth||0===e){var r=Math.floor((e-this.props.expandButtonWidth)/(this._minimumCellWidth+this.props.cellContainerSpacerWidth));t.push({name:"maximumNumberOfControls",value:r}),this.setState(Object(i.__assign)(Object(i.__assign)({},this.state),{previousWidth:e,maximumNumberOfControls:r}));var n=this.props.formWidthLessThanLargeBreakpoint||this.props.headerFields&&this.props.headerFields.length>0&&r<=0;this._showHeaderFieldsInSection=n,this.props.updateShowHeaderFieldsInSection(this.props.contextToken,n)}this.context.TraceManager.getTracer("Forms.HeaderFields").debug("Measuring Header Fields",t)},t.prototype._renderHeaderFields=function(){var e=this;if(this.props.headerCollapsed===this._previousHeaderCollaped||this.props.headerCollapsed||(this._overflowControls=this._overflowControls.slice(this.state.maximumNumberOfControls,this._overflowControls.length)),this.props.headerFields!==this._previousHeaderFields&&(this._previousHeaderFields=this.props.headerFields,this._clearControls()),this.props.headerFields.forEach((function(t,r){if(e.props.headerCollapsed!==e._previousHeaderCollaped&&e.props.headerCollapsed&&r<e.state.maximumNumberOfControls)e._overflowControls.unshift(t);else if(r<e.state.maximumNumberOfControls&&e._nonOverflowControls.length!==e.state.maximumNumberOfControls&&e._nonOverflowControls.length<e.props.headerFields.length&&!e._nonOverflowControlNames.has(t.Name)){var n=Object(i.__assign)(Object(i.__assign)({},e.props.cellWrapperStyle),r===e.state.maximumNumberOfControls||e.props.headerFields.length<e.state.maximumNumberOfControls&&r===e.props.headerFields.length-1?{marginRight:0}:{});e._nonOverflowControls.push(a.createElement(x.a,{style:n},a.createElement(Fe.a,{key:t.Id,id:e.props.id,previewId:t.PreviewId,controlName:t.Name,cellSizeMode:1,style:e.props.cellStyle,scope:we.a.Header}))),e._nonOverflowControlNames.add(t.Name)}else r>=e.state.maximumNumberOfControls&&e._overflowControls.length<e.props.headerFields.length-e.state.maximumNumberOfControls&&(e._overflowControls.push(t),e._nonOverflowControlNames.delete(t.Name))})),this.props.headerCollapsed!==this._previousHeaderCollaped)if(this.props.headerCollapsed)for(var t=0,r=this._nonOverflowControls;t<r.length;t++){(s=r[t]).props.style.visibility="hidden",s.props.style.transitionDelay=V.a}else for(var n=0,o=this._nonOverflowControls;n<o.length;n++){var s;(s=o[n]).props.style.visibility=void 0,s.props.style.transitionDelay="0s"}return this._headerFieldsinFlyout!==this._overflowControls&&(this._headerFieldsinFlyout=this._overflowControls,this.props.updateHeaderFieldsInFlyout(this.props.contextToken,this._headerFieldsinFlyout)),a.createElement(x.a,{style:{display:"flex",transition:V.b,opacity:this.props.headerCollapsed?0:1}},this._nonOverflowControls)},t.prototype._clearControls=function(){this._overflowControls=[],this._nonOverflowControls=[],this._nonOverflowControlNames.clear()},t.prototype._shouldHeaderFieldsFlyoutComponentsRender=function(){return this._overflowControls&&this._overflowControls.length>0&&!this.props.formWidthLessThanLargeBreakpoint},t.prototype.render=function(){return(this.props.clientHostSubtype!==Ne.a.Phone||null===this.props.isAvailableForPhone||void 0===this.props.isAvailableForPhone||this.props.isAvailableForPhone)&&this.props.headerFields&&this.props.headerFields.length>0?a.createElement(x.a,{onMeasuring:this.onMeasuring,isRequestedMeasuring:!0,key:"headerFieldsContainer",style:this.props.containerStyle,testhooks:{id:"header_fields_container"},role:Ee.r},this._renderHeaderFields(),a.createElement(Me.a,{headerCollapsed:this.props.headerCollapsed,id:this.props.id,isMainFormDialog:this.props.isMainFormDialog,isChevronVisible:this._shouldHeaderFieldsFlyoutComponentsRender(),headerFields:this._overflowControls,customStyle:this._showHeaderFieldsInSection?this.props.customChevronStyle:void 0,headerPreviewId:this.props.headerPreviewId})):null},t.prototype.componentDidUpdate=function(){this._previousHeaderCollaped=this.props.headerCollapsed},t}(a.Component);Be.displayName="HeaderFields";var Le=Object(n.a)((function(){var e,t,r=Object(C.h)(),n=(e=null,t=null,function(r,n){var i=Object(S.a)(r);return t!==i&&(t=i,e={containerStyle:{display:"flex",flexDirection:"row",flexGrow:1,justifyContent:"flex-end",flexWrap:"nowrap",height:"auto"},cellWrapperStyle:{whiteSpace:"nowrap",flex:"1 1 auto",width:i.sizes.HeaderFields.MaximumCellWidth,maxWidth:i.sizes.HeaderFields.MaximumCellWidth,maxHeight:"5.25rem",height:"5.25rem",marginRight:i.sizes.Measures.Measure300,overflowY:"hidden",transition:"visibility 0s linear"},cellStyle:{flex:"1 1 auto",width:"100%",borderWidth:0,color:"#000",overflowY:"hidden",maxHeight:"5.25rem",height:"5.25rem"},customChevronStyle:{width:0}}),e}),i=Object(u.ed)(),a=null;return function(e,t){var o=Object(v.j)(e,t.id);Object(l.e)(a,o)||(a=o);var s=i(e,{id:t.id,contextToken:a}),c=r(e,Te.e),u=n(e,t),d=Object(y.c)(e),p=Object(S.a)(e),h=d<p.sizes.Breakpoints.DimensionL,g=Object(Re.b)(e,t.id,a),m=Object(xe.q)(e,g),f=Object(L.e)(e);return{headerFields:s,resourceStrings:c,formWidthLessThanLargeBreakpoint:h,containerStyle:u.containerStyle,cellWrapperStyle:u.cellWrapperStyle,cellStyle:u.cellStyle,customChevronStyle:u.customChevronStyle,minimumCellWidth:p.sizes.HeaderFields.MinimumCellWidthEm+p.sizes.HeaderFields.HeaderFieldMarginEm,expandButtonWidth:p.sizes.HeaderFields.ExpandButtonWidthPx,cellContainerSpacerWidth:p.sizes.HeaderFields.CellContainerSpacerWidthPx,isAvailableForPhone:m,clientHostSubtype:f,contextToken:a}}}),(function(e,t){return{updateShowHeaderFieldsInSection:function(r,n){e(Object(Ae.b)(t.id,r,n))},updateHeaderFieldsInFlyout:function(r,n){e(Object(ke.b)(t.id,r,n))}}}))(Be);Be.contextType=De.a;var Ve=r("yPdn"),ze=r("EGsq"),Ge=r("MGMD"),We=r("6Tlt"),He=r("Wg6j"),Ue=r("Fas2"),qe=r("LWFb"),Xe=r("mccX"),Ke=r("qC0c"),Qe=r("cZkS"),Ye=r("ozeM"),Ze=r("grpZ"),Je=function(e){function t(t){var r=e.call(this,t)||this;return r._onEntityImageClick=r._onEntityImageClick.bind(r),r}return Object(i.__extends)(t,e),t.prototype._renderFormNavigator=function(){return a.createElement(x.a,{accessibilityHidden:this.props.headerCollapsed},a.createElement(be.a,{key:"FormNavigator_"+this.props.id,id:this.props.id,pageName:de.a.getName(),defaultFormId:X.a.toString(this.props.descriptor.Id),selectedTab:this.props.selectedTab,viewSelectorStyle:this.props.viewSelectorStyle,viewSelectorArrowStyle:this.props.viewSelectorArrowStyle,viewSelectorTextStyle:this.props.viewSelectorTextStyle,entityLogicalName:this.props.descriptor.EntityLogicalName,readOnly:this.props.headerCollapsed}))},t.prototype._renderFormHeader=function(){var e=this.props.entityDisplayName||"",t=this.props.formSelectorItems;return this.props.descriptor&&t&&Object.keys(t).length>1&&!this.props.isMainFormDialog?this._renderFormNavigator():a.createElement(ge.a,{key:"entityName",testhooks:{id:"entity_name_span"},style:this.props.headerEntityNameStyle},e.toLocaleUpperCase())},t.prototype._renderTitle=function(){if(!this.props.isTitleReady)return null;var e=Object(u.ob)(this.props.recordId,this.props.formHeaderTitle,this.props.newRecordTitle,this.props.formLabel);return a.createElement(ge.a,{semanticTag:"h1",testhooks:{id:"header_title"},key:"headerTitle",id:Object(A.g)(Ye.a,this.props.id),style:this.props.headerRecordNameStyle,title:e},e)},t.prototype._renderEntityImage=function(){var e;if(!this.props.isEntityImageVisible)return null;var t,r={entityName:this.props.inputs?this.props.inputs.entityTypeName:null,Id:this.props.inputs.id?this.props.inputs.id.guid:void 0},n={key:"entity_image",hasPrimaryImageField:this.props.hasPrimaryImageField,sipUrl:this.props.entitySipValue,presenceIndicatorSize:fe.b.Large,entityReference:r,imageSrc:this.props.entityImageUrl,customEntityIcon:this.props.entityIconVectorName?this.props.webResourceUrl+this.props.entityIconVectorName:null,alt:this.props.formHeaderTitle?this.props.formHeaderTitle:this.props.newRecordTitle,entityPrimaryField:this.props.formHeaderTitle,wrapperStyle:null,style:this.props.entityImageStyle},o=me.c.getMode(n);if(o===me.b.CustomEntityIcon||o===me.b.CustomImage){var s=n.style;n.style=this.props.entityImageCircleStyle,n.wrapperStyle=Object(i.__assign)(Object(i.__assign)({},s),{display:"flex"})}return t=a.createElement(me.a,Object(i.__assign)({},n,((e={})[Ge.a.LearningPathDOMAttributeName]="form-entityImage",e))),a.createElement(x.a,{key:"entityimageContainer",testhooks:{id:"entityImageContainer"},style:this.props.entityImageContainerStyle,onClick:this._onEntityImageClick,role:Ee.r},t)},t.prototype._renderReadOnlyIcon=function(){return a.createElement(ge.a,{style:this.props.readOnlyIconWrapperStyle},a.createElement(he.b,{style:this.props.readOnlyIconStyle,id:"readOnlyIcon",type:pe.a.Locked,testhooks:{id:"formReadOnlyIcon"}}))},t.prototype._renderReadOnlyStatus=function(){if(this.props.isReadOnly){var e=Object(C.c)(this.props.resourceStrings,ue.b),t=a.createElement(ge.a,{key:"readOnlyStatus",style:this.props.readOnlyTextStyle,testhooks:{id:"readOnlyStatus"}},e),r=this._renderReadOnlyIcon();return a.createElement(x.a,{style:this.props.readOnlyStatusContainerStyle},r,t)}return null},t.prototype._onEntityImageClick=function(e){this.props.isEntityImageUploadDialogOpenable&&this.props.openUploadEntityImageDialog(this.props.entityImageUrl,this.props.inputs.entityTypeName,this.props.inputs.id.guid,this.props.primaryNameAttributeValue,this.props.cameraEnabled,this.props.hasPrimaryImageField)},t.prototype._renderLoadingExperience=function(){return a.createElement(x.a,{testhooks:{id:"form-header"},key:"form-header",style:this.props.formHeaderPlaceHoldStyle,role:Ee.r},a.createElement(x.a,{key:"headerContainer",style:this.props.headerContainerViewStyle},a.createElement(x.a,{key:"entityImagePlacehold",style:this.props.entityImagePlaceholdStyle}),a.createElement(x.a,{key:"formHeaderTitlePlaceholdContainer",style:this.props.formHeaderTitlePlaceholdContainerStyle},a.createElement(x.a,{key:"formHeaderTitlePlacehold1",style:this.props.formHeaderTitlePlacehold1Style}),a.createElement(x.a,{key:"formHeaderTitlePlacehold2",style:this.props.formHeaderTitlePlacehold2Style}))))},t.prototype._renderCommandBarManager=function(){return this.props.ribbonId?a.createElement(We.a,{key:this.props.id,commandbarDisplayMode:He.a.IconOnly,iconPosition:he.a.Left,id:this.props.id,mainMenuLength:1,ribbonId:this.props.ribbonId,commandBarStyle:this.props.commandBarStyle,customCommandManagerStyle:this.props.commandManagerStyle,commandManagerId:this.props.id}):null},t.prototype._internalRender=function(){var e,t;return a.createElement(x.a,{id:this.props.domId,testhooks:(e={id:"form-header"},e[qe.b]=this.props.previewId,e[qe.c]=10,e),key:"formHeader",style:this.props.formHeaderStyle,onClick:this.props.onHeaderClick,role:Ee.r},a.createElement(x.a,{id:"headerContainer",key:"headerContainer",style:this.props.headerContainerViewStyle},this._renderEntityImage(),a.createElement(x.a,Object(i.__assign)({key:"formHeaderAndTitle",style:this.props.formHeaderAndTitleStyle},((t={})[Ge.a.LearningPathDOMAttributeName]="form-header-title",t)),this._renderFormHeader(),this._renderTitle(),this._renderReadOnlyStatus()),a.createElement(Le,{id:this.props.id,headerCollapsed:this.props.headerCollapsed,isMainFormDialog:this.props.isMainFormDialog,headerPreviewId:this.props.descriptor.Header.PreviewId}),this.props.formWidthLessThanOrEqualToSmallBreakpoint?this._renderCommandBarManager():null))},t.prototype.render=function(){return this.props.inputs&&this.props.inputs.bodyOnly?null:this.props.isReady?this._internalRender():this._renderLoadingExperience()},t}(a.Component);Je.displayName="FormHeader";var $e=Object(n.a)((function(){var e,t,r,n,a,o,s,c,d,p=Object(C.h)(),h=(e=null,t=null,r=0,n=null,a=null,o=null,s=null,c=null,d=null,function(l,p){var h=Object(S.a)(l),g=p.formWidth,m=p.isReadOnly,f=Object(ye.g)(l),b=p.headerCollapsed,y=Object(L.a)(l)===B.a.MobileApplication,_=Object(v.j)(l,p.id),O=Object(u.o)(l,p.id,_),C=!1!==p.visible;if(t!==h||r!==g||n!==m||o!==f||a!==b||c!==O||s!==y||d!==C){if(t=h,r=g,n=m,a=b,o=f,c=O,s=y,d=C,e={headerEntityNameStyle:Object(i.__assign)({fontSize:h.fontSizes.Font100,color:h.colors.BaseColor.Grey.Grey7,overflow:"hidden",textOverflow:"ellipsis"},Ce(h,g,m,!0,!0,b,y,O)),formHeaderStyle:_e(h,g,C),formHeaderPlaceHoldStyle:Object(i.__assign)(Object(i.__assign)({},_e(h,g,b)),{height:h.sizes.Measures.Measure750}),headerContainerViewStyle:{display:"flex",flexDirection:"row",height:"100%",width:"100%"},headerRecordNameStyle:Object(i.__assign)({fontSize:h.fontSizes.Font150,verticalAlign:"middle",fontWeight:"normal",color:h.colors.BaseColor.Grey.Grey7,overflow:"hidden",textOverflow:"ellipsis",paddingTop:"0em",transition:V.c},Ce(h,g,m,!1,!1,b,y,O)),formHeaderAndTitleStyle:{position:"relative",display:"flex",flexDirection:"column",padding:0,height:"auto",whiteSpace:"nowrap",width:"100%",minWidth:"auto",maxWidth:g<=h.sizes.Breakpoints.DimensionS?"none":g<h.sizes.Breakpoints.DimensionL?"60%":"25em",marginRight:f?0:h.sizes.Measures.Measure200,transition:V.c,transform:b&&g<=h.sizes.Breakpoints.DimensionS?"translateX(-"+h.sizes.Measures.Measure050+")":void 0},entityImageContainerStyle:Object(i.__assign)(Object(i.__assign)({},Se(h,g,b,y,O)),{marginTop:0,marginBottom:0,marginLeft:f?h.sizes.Measures.Measure150:0,border:0,backgroundColor:"transparent"}),entityImageCircleStyle:{},entityImageStyle:Object(i.__assign)(Object(i.__assign)({},Se(h,g,b,y,O)),{borderRadius:"50%",textAlign:"center",fontWeight:"bold",textTransform:"uppercase",color:"white",marginRight:0,fontSize:g>=h.sizes.Breakpoints.DimensionM?h.fontSizes.Font115:h.fontSizes.Font100}),entityImageInnerStyle:Object(i.__assign)(Object(i.__assign)({},Oe(h,g)),{margin:"auto"}),entityImagePlaceholdStyle:Object(i.__assign)(Object(i.__assign)({},Se(h,g,b,y,O)),{borderRadius:"50%",backgroundColor:h.colors.BaseColor.Grey.Grey3,marginTop:0,marginRight:h.sizes.Measures.Measure100}),selectedTabNameStyle:Object.assign(Ce(h,g,m,!1,!0,b,y,O),{verticalAlign:"middle",color:h.colors.BaseColor.Grey.Grey7,overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",marginRight:h.sizes.Measures.Measure050}),readOnlyStatusContainerStyle:{height:g<=h.sizes.Breakpoints.DimensionS?h.sizes.Measures.Measure075:h.sizes.Measures.Measure100,lineHeight:g<=h.sizes.Breakpoints.DimensionS?h.sizes.Measures.Measure075:h.sizes.Measures.Measure100,transition:V.c+",opacity 0.15s linear",transform:b?"translate(-"+h.sizes.Measures.Measure100+", -"+h.sizes.Measures.Measure225+")":"none",opacity:b?0:1,color:h.colors.BaseColor.Grey.Grey5},readOnlyTextStyle:{fontFamily:h.fontFamilies.Regular,fontSize:g<=h.sizes.Breakpoints.DimensionS?h.fontSizes.Font075:h.fontSizes.Font100,lineHeight:g<=h.sizes.Breakpoints.DimensionS?h.sizes.Measures.Measure075:h.sizes.Measures.Measure150},readOnlyIconWrapperStyle:{textAlign:"center",fontSize:g<=h.sizes.Breakpoints.DimensionS?h.fontSizes.Font075:h.fontSizes.Font100,marginRight:h.sizes.Measures.Measure050,color:h.colors.BaseColor.Red.Red3},readOnlyIconStyle:{display:"inline-block",color:h.colors.BaseColor.Grey.Grey5,height:g<=h.sizes.Breakpoints.DimensionS?h.sizes.Measures.Measure100:h.sizes.Measures.Measure150,width:g<=h.sizes.Breakpoints.DimensionS?h.sizes.Measures.Measure100:h.sizes.Measures.Measure150,lineHeight:g<=h.sizes.Breakpoints.DimensionS?h.sizes.Measures.Measure100:h.sizes.Measures.Measure150,fontSize:g<=h.sizes.Breakpoints.DimensionS?h.fontSizes.Font065:h.fontSizes.Font100,position:"relative",top:g<=h.sizes.Breakpoints.DimensionS?-2:null,borderRadius:"10px",textAlign:"center",verticalAlign:"middle"},selectedTabNameAndReadOnlyStatusContainerStyle:Object(i.__assign)({display:"flex",flexDirection:"row",overflow:"hidden",textOverflow:"ellipsis"},Ce(h,g,m,!1,!1,b,y,O)),viewSelectorStyle:Object(i.__assign)({color:h.colors.BaseColor.Grey.Grey7,overflow:"hidden",transition:ve},Ce(h,g,m,!0,!0,b,y,O)),viewSelectorArrowStyle:{fontSize:h.fontSizes.Font100,color:h.colors.BaseColor.Grey.Grey7,overflow:"hidden",textOverflow:"ellipsis",marginLeft:h.sizes.Measures.Measure075,marginRight:h.sizes.Measures.Measure075,minWidth:h.sizes.Measures.Measure100,transition:ve},viewSelectorTextStyle:Object(i.__assign)({padding:0,overflow:"hidden",textOverflow:"ellipsis",height:h.sizes.Measures.Measure100,lineHeight:h.sizes.Measures.Measure100,fontSize:h.fontSizes.Font100,transition:ve},Ce(h,g,m,!0,!0,b,y,O)),formHeaderTitlePlaceholdContainerStyle:{position:"relative",display:"block",padding:0,width:g<=h.sizes.Breakpoints.DimensionS?"60%":"35em",height:"100%",paddingBottom:m?"0":h.sizes.Measures.Measure150},formHeaderTitlePlacehold1Style:{backgroundColor:h.colors.BaseColor.Grey.Grey1,height:h.sizes.Measures.Measure100,marginBottom:g<=h.sizes.Breakpoints.DimensionS?h.sizes.Measures.Measure050:h.sizes.Measures.Measure150,width:"100%"},formHeaderTitlePlacehold2Style:{backgroundColor:h.colors.BaseColor.Grey.Grey1,height:h.sizes.Measures.Measure100,width:"50%"},commandBarStyle:{container:{marginLeft:0,marginRight:0,backgroundColor:"transparent",width:"100%",maxHeight:"100%",boxSizing:"border-box",flexDirection:"row-reverse",paddingBottom:h.sizes.Measures.Measure150},list:{margin:0,width:h.sizes.Measures.Measure400,height:h.sizes.Measures.Measure200,flexDirection:"row",justifyContent:"flex-end"},listItem:{margin:0,width:h.sizes.Measures.Measure200,height:h.sizes.Measures.Measure200,"[aria-expanded=true]":{backgroundColor:h.colors.BaseColor.Grey.Grey2},"[data-expanded=true]":{backgroundColor:h.colors.BaseColor.Grey.Grey2},":hover":{backgroundColor:h.colors.BaseColor.Grey.Grey2}},overflowFlyoutMoreButton:{backgroundColor:"transparent",lineHeight:h.sizes.Measures.Measure100,height:h.sizes.Measures.Measure100,borderWidth:0,padding:0,cursor:"pointer",alignItems:"center",marginRight:h.sizes.Measures.Measure050,marginLeft:h.sizes.Measures.Measure050,marginTop:h.sizes.Measures.Measure050},listItemBody:{text:{fontFamily:h.fontFamilies.Regular,color:h.colors.BaseColor.Black},button:{width:h.sizes.Measures.Measure200,height:h.sizes.Measures.Measure200,paddingBottom:0,paddingLeft:f?0:h.sizes.Measures.Measure050,paddingRight:f?h.sizes.Measures.Measure050:0,backgroundColor:"transparent",borderWidth:0},icon:{color:h.colors.BaseColor.Grey.Grey7}},moreIcon:{margin:"0 auto"}},commandManagerStyle:{right:"0",width:"1px",alignItems:"center",marginTop:h.sizes.Measures.Measure025,transition:V.c,transform:b?"translateY(-"+h.sizes.Measures.Measure050+")":"none",flexGrow:1}},g<=h.sizes.Breakpoints.DimensionS){var I={overflow:"hidden"},j={minWidth:h.sizes.Measures.Measure400,marginLeft:f?0:h.sizes.Measures.Measure100};f&&(I.marginLeft=h.sizes.Measures.Measure200,j.marginRight=h.sizes.Measures.Measure100,e.entityImageContainerStyle=Object(i.__assign)(Object(i.__assign)({},e.entityImageContainerStyle),{marginRight:0})),e.formHeaderAndTitleStyle=Object(i.__assign)(Object(i.__assign)({},e.formHeaderAndTitleStyle),I),e.commandManagerStyle=Object(i.__assign)(Object(i.__assign)({},e.commandManagerStyle),j)}e.entityImageCircleStyle=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},e.entityImageStyle),e.entityImageInnerStyle),e.entityImageContainerStyle)}return e}),g=null;return function(e,t){var r=Object(v.j)(e,t.id);Object(l.e)(g,r)||(g=r);var n,a=Object(S.a)(e),o=Object(Ue.f)(e,t),s=Object(u.fb)(e,t,r),c=Object(Ze.a)(e,t.id,!0),d=Object(u.hb)(e,t),m=Object(u.gb)(e,t),b=Object(u.Ib)(e,t.id),_=Object(y.c)(e),O=_<=a.sizes.Breakpoints.DimensionS,I=Object(u.V)(e,t),j=Object(f.a)(e,t),P=j.entityTypeName,T=p(e,ue.c),w=Object(u.wc)(e,t,g),E=Object(u.Fc)(e,t.id,w,r),x=Object(u.kb)(e,t,g),N=Object(F.h)(e,P),A=Object(je.a)(e,t.id),k=A>Pe.a.Loading,M=A>Pe.a.OnLoadReady,D=new q.a(P,j.id),R=Object(u.Yb)(e,t.id,g),B=h(e,Object(i.__assign)(Object(i.__assign)({},t),{formWidth:_,isReadOnly:x,hasCmdbar:Object(u.Bb)(e,t.id,g),headerCollapsed:t.headerCollapsed})),L=Object(F.i)(e,P),V=Object(ze.t)(e),z=Object(f.g)(e,t.id).id;if(N&&null!=N.PrimaryNameAttribute){var G=Object(Q.b)(D)(e,P);G&&G.fields&&G.fields[N.PrimaryNameAttribute]&&(n=Object(Ie.e)(G.fields[N.PrimaryNameAttribute]))}var W=N?N.DisplayName:"",H=Object(C.c)(T,ue.a),U=W&&H?String.format(H,W):"",X=N&&!!N.PrimaryImageAttribute,K=X&&!x&&!Object(f.m)(e,t.id),Y=!Object(Ke.a)(e,Qe.Dd,Qe.h)||!s||s.ShowEntityImage;return{isReady:k,isTitleReady:M,descriptor:s,formSelectorItems:c,formHeaderTitle:d,headerEntityNameStyle:B.headerEntityNameStyle,formHeaderStyle:B.formHeaderStyle,formHeaderPlaceHoldStyle:B.formHeaderPlaceHoldStyle,headerContainerViewStyle:B.headerContainerViewStyle,headerRecordNameStyle:B.headerRecordNameStyle,formHeaderAndTitleStyle:B.formHeaderAndTitleStyle,entityImageContainerStyle:B.entityImageContainerStyle,entityImageStyle:B.entityImageStyle,entityImageInnerStyle:B.entityImageInnerStyle,selectedTabNameStyle:B.selectedTabNameStyle,readOnlyStatusContainerStyle:B.readOnlyStatusContainerStyle,readOnlyTextStyle:B.readOnlyTextStyle,readOnlyIconWrapperStyle:B.readOnlyIconWrapperStyle,readOnlyIconStyle:B.readOnlyIconStyle,selectedTabNameAndReadOnlyStatusContainerStyle:B.selectedTabNameAndReadOnlyStatusContainerStyle,entityImagePlaceholdStyle:B.entityImagePlaceholdStyle,formHeaderTitlePlaceholdContainerStyle:B.formHeaderTitlePlaceholdContainerStyle,formHeaderTitlePlacehold1Style:B.formHeaderTitlePlacehold1Style,formHeaderTitlePlacehold2Style:B.formHeaderTitlePlacehold2Style,entityImageCircleStyle:B.entityImageCircleStyle,viewSelectorStyle:B.viewSelectorStyle,viewSelectorArrowStyle:B.viewSelectorArrowStyle,viewSelectorTextStyle:B.viewSelectorTextStyle,commandBarStyle:B.commandBarStyle,commandManagerStyle:B.commandManagerStyle,entityImageUrl:m,cameraEnabled:Object(Ve.e)(e,"camera"),hasPrimaryImageField:X,resourceStrings:T,selectedTabId:E?E.Label:"",isReadOnly:x,inputs:j,primaryNameAttributeValue:n,entityDisplayName:W,formLabel:R,contextToken:g,formWidthLessThanOrEqualToSmallBreakpoint:O,entitySipValue:I,ribbonId:o,entityIconVectorName:L,webResourceUrl:V,recordId:z,isMainFormDialog:b,newRecordTitle:U,isEntityImageUploadDialogOpenable:K,isEntityImageVisible:Y}}}),(function(e,t){return{openUploadEntityImageDialog:function(r,n,i,a,o,s){return e(Object(Xe.a)(r,n,i,a,o,s,t.id))}}}))(Je),et=r("akzq"),tt=r("l2WT"),rt=r("CUpQ"),nt=r("/yq9"),it=r("Baft");var at=r("exGN"),ot=r("evh6"),st=r("lU69"),ct=r("1AYO"),lt=r("B73A"),ut=r("evW+");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var dt=["ProcessControl.Configurator.Collapse","ProcessControl.Configurator.Expand","Web.Footer.MoreFields","FooterFields.KeyboardShortCut.Area","FooterFields.KeyboardShortCut.Escape","FooterFields.KeyboardShortCut.Down","FooterFields.KeyboardShortCut.Up","Flyout.KeyboardShortCut.Tab.NotAllowed"],pt=r("E705"),ht=Object(st.a)(),gt="footerFieldsFlyout",mt=Object(st.a)(),ft=Object(st.a)(),bt=Object(st.a)(),yt=function(e){function t(t){var r=e.call(this,t)||this;return r._onCellsDidMount=r._onCellsDidMount.bind(r),r._moveFocusToExpandButton=r._moveFocusToExpandButton.bind(r),r._moveFocus=r._moveFocus.bind(r),r._handleKeyCodeNavigation=r._handleKeyCodeNavigation.bind(r),r._flyoutOutsideClickHandler=r._flyoutOutsideClickHandler.bind(r),r._toggleFlyout=r._toggleFlyout.bind(r),r.state={isFlyoutOpened:!1,selectedIndex:-1,isCellRendered:!1},r}return Object(i.__extends)(t,e),t.prototype._toggleFlyout=function(){var e=this;this.setState(Object(i.__assign)(Object(i.__assign)({},this.state),{isFlyoutOpened:!this.state.isFlyoutOpened,selectedIndex:-1,isCellRendered:!1}),(function(){e.state.isFlyoutOpened||e._moveFocusToExpandButton()}))},t.prototype._flyoutOutsideClickHandler=function(e){e&&e.target&&(e.target.id!==ht&&this._toggleFlyout())},t.prototype._createKeyboardShortcuts=function(){var e=Object(C.c)(this.props.resourceStrings,"FooterFields.KeyboardShortCut.Area"),t=Object(C.c)(this.props.resourceStrings,"FooterFields.KeyboardShortCut.Escape"),r=Object(C.c)(this.props.resourceStrings,"FooterFields.KeyboardShortCut.Down"),n=Object(C.c)(this.props.resourceStrings,"FooterFields.KeyboardShortCut.Up"),i=Object(C.c)(this.props.resourceStrings,"Flyout.KeyboardShortCut.Tab.NotAllowed"),a=this._shortcutHandler.bind(this),o=[],s=new lt.a([g.a.UpArrow],a,!0,e,n),c=new lt.a([g.a.DownArrow],a,!0,e,r),l=new lt.a([g.a.Escape],a,!0,e,t),u=new lt.a([g.a.Tab],a,!0,e,i);return o.push(s),o.push(c),o.push(l),o.push(u),o},t.prototype._shortcutHandler=function(e){var t=e.EVENT,r=t.keyCode;r===g.a.Escape?this._toggleFlyout():r===g.a.UpArrow||r===g.a.DownArrow?this._handleKeyCodeNavigation(r):r===g.a.Tab&&(t.preventDefault(),t.stopPropagation())},t.prototype._handleKeyCodeNavigation=function(e){var t=g.a.DownArrow===e?this.state.selectedIndex+1:-1===this.state.selectedIndex?this.props.overFlownFooterFields.length-1:this.state.selectedIndex-1,r=this.props.overFlownFooterFields.length,n=(t+r)%r;this._moveFocus(n)},t.prototype._moveFocus=function(e){var t=this.props.overFlownFooterFields[e],r=o.findDOMNode(this.refs[t.Id]);if(r){var n=pt.b(r);(n.editableElement||n.focusableElement)&&(n.editableElement?n.editableElement.focus():n.focusableElement.focus(),this.setState(Object(i.__assign)(Object(i.__assign)({},this.state),{selectedIndex:e})))}},t.prototype._moveFocusToExpandButton=function(){var e=o.findDOMNode(this.refs[mt]);if(e){var t=pt.b(e);(t.editableElement||t.focusableElement)&&(t.editableElement?t.editableElement.focus():t.focusableElement.focus())}},t.prototype._onCellsDidMount=function(){-1===this.state.selectedIndex&&this.props.overFlownFooterFields&&this.state.isFlyoutOpened&&this.setState(Object(i.__assign)(Object(i.__assign)({},this.state),{isCellRendered:!0,selectedIndex:0}))},t.prototype._renderFooterFields=function(){var e=this;return this.props.overFlownFooterFields.map((function(t){return a.createElement(Fe.a,{key:t.Id,id:e.props.id,previewId:t.PreviewId,controlName:t.Name,ref:t.Id,cellSizeMode:0,shouldNotifyRenderComplete:!0,onRenderComplete:e._onCellsDidMount,style:e.props.cellStyle,scope:we.a.EditForm})}))},t.prototype.render=function(){var e,t,r={height:this.props.overFlownFooterFields&&this.props.overFlownFooterFields.length>0?50*this.props.overFlownFooterFields.length:0},n=Object(C.c)(this.props.resourceStrings,"Web.Footer.MoreFields");return this.state.isFlyoutOpened?(e=a.createElement(ct.a,{key:gt,id:gt,flyoutDirection:ct.b.upleft,relativeToElementId:ht,positionType:"relative",flyoutStyle:this.props.flyoutStyle,size:r,onOutsideClick:this._flyoutOutsideClickHandler,testhooks:{id:gt}},this._renderFooterFields()),t=this.state.isCellRendered?a.createElement(et.a,{key:"footerFieldsFlyoutAccessibility",rootElementId:gt,overrideFocusId:gt,shouldManageFocus:!0,waitForEditable:!1,keyboardShortcuts:this._createKeyboardShortcuts(),isModal:!0}):null):e=void 0,a.createElement(x.a,{key:mt,id:mt,ref:mt,role:Ee.r},a.createElement(ut.a,{key:ft,accessibilityLabel:n,tabIndex:0,onClick:this._toggleFlyout,style:this.props.expandButtonStyle,accessibilityExpanded:this.state.isFlyoutOpened,accessibilityHasPopup:!0,testhooks:{id:"footer_overflowButton"}},a.createElement(he.b,{style:this.props.expandButtonIconStyle,id:ht,type:this.state.isFlyoutOpened?pe.a.ChevronDown:pe.a.ChevronUp})),a.createElement(x.a,{key:bt,id:bt,ownsElementId:this.state.isFlyoutOpened?gt:""},e,t))},t}(a.Component);yt.displayName="FooterFieldsFlyout";var vt=Object(n.a)((function(){var e,t,r=(e=null,t=null,function(r,n){var i=Object(S.a)(r);return t!==i&&(t=i,e={flyoutStyle:{borderWidth:"1px",borderColor:i.colors.BaseColor.White,borderStyle:"solid",padding:i.sizes.Measures.Measure100,width:"30rem",height:"auto",maxHeight:"23.75rem",boxShadow:i.shadows.Shadow01,backgroundColor:i.colors.BaseColor.White,flexDirection:"column",overflowY:"auto"},expandButtonStyle:{cursor:"pointer",borderWidth:0,padding:0,height:i.sizes.Measures.Measure200,width:i.sizes.Measures.Measure200,lineHeight:i.sizes.Measures.Measure200,backgroundColor:"transparent"},expandButtonIconStyle:{width:"100%",height:"100%",textAlign:"center"},cellStyle:{width:"100%",flex:"0 0 auto"}}),e}),n=Object(C.h)();return function(e,t){var i=r(e,t);return{resourceStrings:n(e,dt),flyoutStyle:i.flyoutStyle,expandButtonStyle:i.expandButtonStyle,cellStyle:i.cellStyle,expandButtonIconStyle:i.expandButtonIconStyle}}}))(yt),_t=r("xc1f"),St=r("lokH"),Ot=r("1GLu"),Ct=r("v/Fs"),It=Object(st.a)();function jt(e){var t;return a.createElement(ut.a,{key:"saveBtn",testhooks:(t={id:"edit-form-save-btn"},t[Ge.a.LearningPathDOMAttributeSuffix]="form-footer-saveBtn",t),accessKey:"S",title:e.saveLabel,style:e.saveButtonStyle,onClick:e.save,accessibilityLabel:e.saveLabel,tabIndex:0},a.createElement(he.b,{key:"icon",style:e.saveButtonIconStyle,id:It,type:pe.a.Save}),a.createElement(ge.a,{key:"text",style:e.saveButtonLabelStyle},e.saveLabel))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Pt=Object(st.a)(),Ft=function(e){function t(t){var r=e.call(this,t)||this;return r._measuringFooter=r._measuringFooter.bind(r),r._onPopoutButtonClick=r._onPopoutButtonClick.bind(r),r.state={previousFooterFieldsWidth:0,maximumNumberOfControls:0,isSpaceAvailableForFields:!0,previousFooterHeight:0},r}return Object(i.__extends)(t,e),t.prototype.componentWillUpdate=function(e){this.props.isSaving&&!e.isSaving&&(this._saveStatusMessage=Object(C.c)(this.props.resourceStrings,nt.c))},t.prototype._onPopoutButtonClick=function(e){this.props.openGridPage(this.props.entityTypeName)},t.prototype._getFooterMessage=function(){return this.props.isSaving?this.props.savingChangesMessage:this.props.formDirty?this.props.unsavedChangesWarning:this.props.hasOfflineChanges?this.props.offlineChangesMessage:""},t.prototype._isPopoutHidden=function(){return!(this.props.viewPortWidth>this.props.breakPointS&&this.props.clienthost!==B.a.MobileApplication&&this.props.navigationType===St.a.SingleSession)},t.prototype._measuringFooter=function(e){var t=[{name:"currentWidth",value:e}];if(e>0&&e!==this.state.previousFooterFieldsWidth){var r=Math.floor(e/(this.props.footerFieldMinimumCellWidth+this.props.cellContainerSpacerWidth)),n=!(e<250);t.push({name:"maxNumberOfControlsToDisplay",value:r},{name:"enoughSpaceForControls",value:n}),this.setState(Object(i.__assign)(Object(i.__assign)({},this.state),{previousFooterFieldsWidth:e,maximumNumberOfControls:r,isSpaceAvailableForFields:n}))}this.context.TraceManager.getTracer("Forms.FormFooter").debug("Measuring Footer",t)},t.prototype._renderFooterFieldCells=function(){var e=this;return this.props.footerFields?(this._overFlownFooterFields=[],this.props.footerFields.map((function(t,r){if(t.Id&&r<e.state.maximumNumberOfControls&&e.state.isSpaceAvailableForFields||0===r&&!e.state.isSpaceAvailableForFields)return a.createElement(x.a,{style:e.props.cellWrapperStyle},a.createElement(Fe.a,{key:t.Id,id:e.props.id,previewId:t.PreviewId,controlName:t.Name,cellSizeMode:0,style:e.props.cellStyle,scope:we.a.Footer}));t.Id&&t.Visible&&e._overFlownFooterFields.push(t)}))):null},t.prototype._renderFooterFieldsFlyout=function(){return this._overFlownFooterFields&&this._overFlownFooterFields.length>0?a.createElement(vt,{overFlownFooterFields:this._overFlownFooterFields,id:this.props.id}):null},t.prototype._renderFooterFields=function(){if(this.props.footerFields&&this.props.footerFields.length>0){var e=a.createElement(x.a,{key:"footerFields",style:this.props.flyoutContainerStyle},this._renderFooterFieldCells(),this._renderFooterFieldsFlyout());return this.state.isSpaceAvailableForFields?e:a.createElement(x.a,{key:"footerFields",style:this.props.formFooterStyle,role:Ee.r,testhooks:{id:"FooterBar_ChildDiv"}},e)}return null},t.prototype._renderPopoutButton=function(){var e={entityTypeName:this.props.entityTypeName,id:this.props.entityId?X.a.parse(this.props.entityId.guid):null,newWindowOptions:{width:window.innerWidth,height:window.innerHeight}};return a.createElement(x.a,{key:"popoutButton",title:this.props.popoutButtonTooltip,style:this.props.popoutButtonWrapperStyle,role:Ee.r},a.createElement(at.a,{sourcePageId:this.props.id,pageName:_t.a,input:e,target:at.b,style:this.props.footerPopoutLinkStyle,accessibilityLabel:this.props.popoutButtonTooltip},a.createElement(x.a,{id:"popout-btn",style:this.props.popoutButtonStyle,onClick:this._onPopoutButtonClick,accessibilityHidden:!0,role:Ee.r,testhooks:{id:"popout_btn"}},a.createElement(ge.a,{style:this.props.popoutButtonIconStyle},a.createElement(he.b,{id:Pt,type:pe.a.ExpandButton})))))},t.prototype.render=function(){var e,t,r=this;if(this.props.clienthost===B.a.MobileApplication||this.props.clienthost===B.a.MailApp)return null;if(this._getFooterMessage()&&(t=this._getFooterMessage(),this._saveStatusMessage=""),!this.props.isReady)return a.createElement(x.a,{style:this.props.formFooterStyle,role:Ee.r});var n=Object(C.c)(this.props.resourceStrings,nt.d);return a.createElement(x.a,{style:this.props.customRootStyle,id:this.props.domId,testhooks:(e={id:"form-footer"},e[qe.b]=this.props.previewId,e[qe.c]=10,e)},a.createElement(et.a,{key:"formfooterAccessibility",shouldManageFocus:!1}),this.state.isSpaceAvailableForFields?null:this._renderFooterFields(),a.createElement(x.a,{key:"footerWrapper",id:"footerWrapper",style:this.props.formFooterWrapperStyle,testhooks:{id:"FooterBar_ParentDiv"}},a.createElement(x.a,{style:this.props.formFooterStyle},this._isPopoutHidden()?null:this._renderPopoutButton(),a.createElement(ge.a,{testhooks:{id:"edit-form-status-message"},style:this.props.footerStatusStyle,role:Ee.s,accessibilityLabel:this.props.recordStatusMessage,key:"footerStatus"},this.props.recordStatusMessage),a.createElement(x.a,{key:"footerDivider",id:"footerDivider",style:this.props.footerDividerStyle}),a.createElement(x.a,{key:"fields",id:"footerFieldsContainer",style:this.props.footerFieldStyle,onMeasuring:this._measuringFooter,isRequestedMeasuring:!0},this.state.isSpaceAvailableForFields?this._renderFooterFields():null),a.createElement(x.a,{key:"action",style:this.props.footerActionAndStatusWrapperStyle},a.createElement(x.a,{key:"message",style:this.props.footerMessageContainerStyle,role:Ee.a,notificationType:it.b},a.createElement(ge.a,{style:this.props.statusStyle}," ",t||this._saveStatusMessage," ")),a.createElement(ge.a,{key:"footerMessage",title:t,testhooks:{id:"edit-form-footer-message"},style:this.props.footerMessageStyle},t),a.createElement(Ct.a,{pageId:this.props.id},(function(e){return a.createElement(jt,{save:e,saveLabel:n,saveButtonStyle:r.props.saveButtonStyle,saveButtonIconStyle:r.props.saveButtonIconStyle,saveButtonLabelStyle:r.props.saveButtonLabelStyle})}))))))},t}(a.Component);Ft.displayName="FormFooter";var Tt=Object(n.a)((function(){var e,t,r,n,a,o=(e=null,t=null,r=!1,n=null,a=null,function(i,o){var s=Object(v.j)(i,o.id),c=Object(S.a)(i),l=Object(u.kb)(i,o,s),d=o.viewPortWidth,p=o.hasFooterFields;return t===c&&r===l&&n===d&&a===p||(t=c,r=l,n=d,a=p,e={formFooterWrapperStyle:{opacity:1,maxHeight:c.sizes.Measures.Measure200,display:"flex",flex:"0 1 2rem",borderTopWidth:"1px",borderTopColor:c.colors.BaseColor.Grey.Grey3,borderTopStyle:"solid"},formFooterStyle:{overflow:"hidden",display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"100%",borderWidth:0,backgroundColor:c.colors.BaseColor.Grey.Grey3,paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0,position:"relative",bottom:"0px",justifyContent:"space-between",boxSizing:"border-box",height:c.sizes.Measures.Measure200},footerStatusStyle:{flex:"0 1 auto",color:c.colors.BaseColor.Grey.Grey7,marginLeft:c.sizes.Measures.Measure100,paddingTop:c.sizes.Measures.Measure050,paddingBottom:c.sizes.Measures.Measure050,paddingLeft:0,paddingRight:0,lineHeight:c.sizes.Measures.Measure100,fontSize:c.fontSizes.Font085},footerMessageStyle:{position:"relative",flexGrow:0,color:c.colors.BaseColor.Grey.Grey7,paddingTop:c.sizes.Measures.Measure050,paddingBottom:c.sizes.Measures.Measure050,marginLeft:c.sizes.Measures.Measure100,marginRight:c.sizes.Measures.Measure100,lineHeight:c.sizes.Measures.Measure100,fontSize:c.fontSizes.Font085,width:Math.min(.132*d,Object(b.a)(15)).toString()+"px",textAlign:"right",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},saveButtonStyle:{position:"relative",borderStyle:"none",backgroundColor:"transparent",color:c.colors.BaseColor.Grey.Grey7,display:l?"none":"flex",cursor:"pointer",paddingLeft:c.sizes.Measures.Measure050,paddingRight:c.sizes.Measures.Measure100,paddingTop:0,paddingBottom:0,lineHeight:c.sizes.Measures.Measure200,flexGrow:0,float:"right"},popoutButtonWrapperStyle:{height:c.sizes.Measures.Measure200,width:c.sizes.Measures.Measure200,paddingLeft:c.sizes.Measures.Measure050,paddingRight:c.sizes.Measures.Measure050,marginLeft:0,boxSizing:"content-box"},popoutButtonStyle:{display:"flex",height:"100%",width:"100%",position:"relative",borderStyle:"none",backgroundColor:"transparent",padding:0,paddingTop:c.sizes.Measures.Measure050,paddingBottom:c.sizes.Measures.Measure050,color:c.colors.BaseColor.Grey.Grey7,cursor:"pointer"},popoutButtonIconStyle:{height:"100%",width:"100%"},footerFieldStyle:{display:"flex",flexDirection:"row",justifyContent:"flex-start",marginRight:c.sizes.Measures.Measure100,marginLeft:0,flexGrow:15,width:0},footerPopoutLinkStyle:{textDecoration:"none",flexGrow:1,height:"100%",width:"100%"},flyoutContainerStyle:{display:"flex",flex:"1 1 0px",justifyContent:"flex-start",alignItems:"center"},footerFieldsFlyoutStyle:{borderColor:"#ffffff",borderWidth:"1px",borderStyle:"solid",borderTopWidth:0,paddingLeft:"15px",width:"300px",overflow:"auto",right:"10px",boxShadow:"4px 4px 2px #808080",backgroundColor:c.colors.BaseColor.White},cellWrapperStyle:{whiteSpace:"nowrap",flexGrow:1,width:c.sizes.HeaderFields.MaximumCellWidth,minWidth:"22rem"},cellStyle:{width:"100%",flex:"1 1 auto",minHeight:0,overflowY:"hidden",marginRight:c.sizes.Measures.Measure100,marginLeft:c.sizes.Measures.Measure100,color:"#fff"},footerMessageContainerStyle:{opacity:0,height:0,width:0},footerActionAndStatusWrapperStyle:{display:"flex",flexDirection:"row",justifyContent:"flex-end"},statusStyle:{color:c.colors.BaseColor.Grey.Grey7,fontSize:c.fontSizes.Font100},disabledSaveButtonStyle:{backgroundColor:"transparent",color:c.colors.BaseColor.Grey.Grey5},footerDividerStyle:{display:d<c.sizes.Breakpoints.DimensionM?"none":"flex",flex:"0 1 auto",width:"0.5px",height:d<c.sizes.Breakpoints.DimensionL?"16px":c.sizes.Measures.Measure100,marginTop:d<c.sizes.Breakpoints.DimensionL?"6px":c.sizes.Measures.Measure050,marginBottom:d<c.sizes.Breakpoints.DimensionL?"6px":c.sizes.Measures.Measure050,marginLeft:c.sizes.Measures.Measure100,marginRight:0,backgroundColor:c.colors.BaseColor.Grey.Grey4},saveButtonIconStyle:{width:c.sizes.Measures.Measure200,height:c.sizes.Measures.Measure200},saveButtonLabelStyle:{fontSize:c.fontSizes.Font085}}),e}),s=Object(u.dd)(),c=Object(C.h)();return function(e,t){var r=Object(v.j)(e,t.id),n=Object(f.g)(e,t.id),a=Object(S.a)(e),l=n,d=Object(u.jb)(e,t.id),p=Object(u.Nb)(e,t.id,r),h=s(e,{id:t.id,contextToken:r}),g=Object(y.c)(e),m=o(e,Object(i.__assign)(Object(i.__assign)({},t),{viewPortWidth:g,hasFooterFields:h&&h.length>0})),_=Object(je.a)(e,t.id)>Pe.a.Loading,O=Object(u.Vb)(e,t,r),C=c(e,nt.e),I=Object(L.a)(e),j=Object(Ot.a)(e),P="",F=null;l&&(P=l.entityTypeName,F=l.id);var T=Object(u.mc)(e,t.id,C);return{isSaving:d,formDirty:p,footerFields:h,entityTypeName:P,entityId:F,formFooterWrapperStyle:m.formFooterWrapperStyle,formFooterStyle:m.formFooterStyle,footerStatusStyle:m.footerStatusStyle,footerMessageStyle:m.footerMessageStyle,saveButtonStyle:m.saveButtonStyle,footerFieldStyle:m.footerFieldStyle,cellWrapperStyle:m.cellWrapperStyle,cellStyle:m.cellStyle,footerMessageContainerStyle:m.footerMessageContainerStyle,popoutButtonWrapperStyle:m.popoutButtonWrapperStyle,popoutButtonStyle:m.popoutButtonStyle,popoutButtonIconStyle:m.popoutButtonIconStyle,footerFieldsFlyoutStyle:m.footerFieldsFlyoutStyle,flyoutContainerStyle:m.flyoutContainerStyle,footerPopoutLinkStyle:m.footerPopoutLinkStyle,footerActionAndStatusWrapperStyle:m.footerActionAndStatusWrapperStyle,statusStyle:m.statusStyle,disabledSaveButtonStyle:m.disabledSaveButtonStyle,footerDividerStyle:m.footerDividerStyle,saveButtonIconStyle:m.saveButtonIconStyle,saveButtonLabelStyle:m.saveButtonLabelStyle,isReady:_,hasOfflineChanges:O,recordStatusMessage:T,resourceStrings:C,viewPortWidth:g,breakPointS:a.sizes.Breakpoints.DimensionS,footerFieldMinimumCellWidth:Object(b.a)(a.sizes.FooterFields.MinimumCellWidthEm),clienthost:I,cellContainerSpacerWidth:a.sizes.FooterFields.CellContainerSpacerWidthPx,navigationType:j}}}),(function(e,t){return{openGridPage:function(r){e(Object(ot.a)(r,t.id))}}}))(Ft);Ft.contextType=De.a;var wt=r("2rJs"),Et=r("QJW6"),xt=r("AfKB"),Nt=r("3/Bp"),At=r("2MsE"),kt=r("zt+H"),Mt=r("np0M"),Dt=r("IF6v"),Rt=r("WmPI"),Bt=r("WcBa"),Lt=r("zPLw");function Vt(e){var t=Bt.c;switch(e.readOnlyState){case Rt.a.RecordPermissions:t=Bt.c;break;case Rt.a.EntityPermissions:t=Bt.b;break;case Rt.a.Offline:t=Bt.a;break;case Rt.a.RecordStatus:t=Bt.d}var r=Object(C.c)(e.resourceStrings,t);return t===Bt.d?r=r.replace("{0}",e.recordStatusMessage):t===Bt.b&&(r=r.replace("{0}",e.entityDisplayCollectionName)),r}var zt=Object(n.a)((function(){var e=Object(C.h)(),t=Object(u.cd)(),r=null;return function(n,i){var a=Object(v.j)(n,i.id);Object(l.e)(r,a)||(r=a);var o=e(n,Bt.e),s=t(n,i,r);return{readOnlyState:Object(u.lb)(n,i,r),recordStatusMessage:Object(u.mc)(n,i.id,o),resourceStrings:o,enabledFormFCBs:s}}}))((function(e){if(!e.enabledFormFCBs.has(Qe.mb)||e.readOnlyState===Rt.a.NotReadOnly)return null;var t={Message:Vt(e),Level:Lt.c,UniqueId:"formReadOnlyNotification"};return a.createElement(Dt.a,{key:"formReadOnlyNotification",domWidth:e.domWidth,id:e.id,notification:t,notificationType:t.Level,shouldNotifyRenderComplete:!0,displayFullMessage:!0,onlyNotification:!0,onRenderComplete:function(){}})})),Gt=r("TCzx"),Wt=r("oPeH"),Ht=r("odkg"),Ut=r("FlM9");var qt=[Ut.a],Xt=r("oVzJ"),Kt=r("miNs"),Qt=r("Md8f"),Yt=r("XdZx"),Zt=r("EcZf"),Jt=r("VnpK"),$t=r("c96h"),er=Object(st.a)();function tr(e){var t,r=e.id,s=e.recordSetNavigatorCollapsed,c=e.shouldRenderRecordSetNavigatorButton,l=e.onToggleRecordSetNavigator,u=e.commandBarStyle,d=e.collapseExpandButtonStyle,p=e.collapseExpandButtonTextStyle,h=a.useRef(),g=a.useCallback((function(e){l(),o.findDOMNode(h.current).focus()}),[l,h]),m=a.useContext(gr),f=Object(n.d)(ye.g),b=Object(C.c)(m,rt.l),y=s?f?pe.a.BackwardButton:pe.a.ForwardButton:f?pe.a.ForwardButton:pe.a.BackwardButton;Object(n.d)($t.d)&&(y=pe.a.CustomList);var v=u&&u.commandBarRefreshProps&&u.commandBarRefreshProps.isRefreshedCommandBarFCBEnabled&&!Object(Jt.n)(),_=Object(He.h)(pe.a[y],v,!1,null,null,Object(A.g)(er,r),{id:"recordSetNavExpandIcon"});return v&&(p.display="flex",p.alignItems="center",d.display="flex",d.alignItems="center"),c&&a.createElement(ut.a,Object(i.__assign)({id:Object(A.g)("collapseExpandBtn",r),ref:h,tabIndex:0,accessKey:s?"X":"L",accessibilityLabel:b,onClick:g,style:d,accessibilityExpanded:s},((t={})[Ge.a.LearningPathDOMAttributeName]="form-recordset-navigator",t)),a.createElement(ge.a,{style:p},_))}var rr=r("6FBX"),nr=42,ir=42;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function ar(e){var t=e.id,r=e.hasCmdbar,i=e.recordSetNavigatorCollapsed,o=e.viewPortWidth,s=e.smallBreakPoint,c=e.numberOfAvailableRecords,l=e.commandBarStyle,d=e.commandManagerStyle,p=e.commandManagerContainerStyle,h=e.tabBackButtonStyle,g=e.collapseExpandButtonWrapperStyle,m=e.collapseExpandButtonStyle,b=e.collapseExpandButtonTextStyle,y=a.useContext(gr),v=Object(n.d)(Xt.b),_=Object(n.d)((function(e){return Object(u.Ib)(e,t)})),S=Object(n.c)(),O=Object(n.d)((function(e){return Object(f.g)(e,t)})),C=Object(n.d)(Ot.a)===St.a.MultiSession,I=O&&O.recordSetQueryKey,j=I&&I.split("-")[0],P=Object(n.d)((function(e){return Object(Ke.c)(e,Qe.h)})),F=Object(n.d)((function(e){return Object(Ke.c)(e,Qe.Sc)})),T=Object(n.d)((function(e){return Object(Ke.c)(e,Qe.gd)})),w=F||T&&P,E=(j!==rr.Bb||j===rr.Bb&&w)&&c>1&&!C,x=a.useCallback((function(){S(Object(Yt.b)(!i)),I&&i&&S(Object(Zt.g)(null,I))}),[S,I,i]);return v&&!_?a.createElement(lr,{id:t,shouldRenderRecordSetNavigatorButton:E,commandBarStyle:l,commandManagerStyle:d}):r&&a.createElement(or,{id:t,recordSetNavigatorCollapsed:i,shouldRenderRecordSetNavigatorButton:E,viewPortWidth:o,smallBreakPoint:s,resourceStrings:y,onToggleRecordSetNavigator:x,commandManagerContainerStyle:p,collapseExpandButtonWrapperStyle:g,tabBackButtonStyle:h,commandBarStyle:l,commandManagerStyle:d,collapseExpandButtonStyle:m,collapseExpandButtonTextStyle:b})}function or(e){var t=e.id,r=e.recordSetNavigatorCollapsed,n=e.shouldRenderRecordSetNavigatorButton,i=e.viewPortWidth,o=e.smallBreakPoint,s=e.resourceStrings,c=e.onToggleRecordSetNavigator,l=e.commandManagerContainerStyle,u=e.collapseExpandButtonWrapperStyle,d=e.tabBackButtonStyle,p=e.commandBarStyle,h=e.commandManagerStyle,g=e.collapseExpandButtonStyle,m=e.collapseExpandButtonTextStyle;return a.createElement(x.a,{key:"commandBarContainer",style:l},a.createElement(cr,{id:t,tabBackButtonStyle:d}),a.createElement(x.a,{key:"recordSetNavBtnWrapper",title:r?Object(C.c)(s,rt.m):Object(C.c)(s,rt.k),style:u,onKeyDown:sr(c)},i>o&&a.createElement(tr,{id:t,recordSetNavigatorCollapsed:r,shouldRenderRecordSetNavigatorButton:n,onToggleRecordSetNavigator:c,commandBarStyle:p,collapseExpandButtonStyle:g,collapseExpandButtonTextStyle:m})),a.createElement(lr,{id:t,shouldRenderRecordSetNavigatorButton:n,commandBarStyle:p,commandManagerStyle:h}))}function sr(e){return function(t){t.keyCode===Kt.a.Enter&&e()}}function cr(e){var t=e.id,r=e.tabBackButtonStyle,i=Object(n.d)((function(e){return Object($t.d)(e)}));return!Object(n.d)((function(e){return Object(f.f)(e,t)}))&&i?a.createElement(Qt.a,{pageId:t,overwriteStyle:r}):null}function lr(e){var t=e.id,r=e.shouldRenderRecordSetNavigatorButton,i=e.commandBarStyle,o=e.commandManagerStyle,s=a.useContext(gr),c=Object(n.c)(),l={id:t},d=Object(n.d)((function(e){return Object(Ue.f)(e,l)})),p=Object(n.d)((function(e){return Object(f.g)(e,t)})).entityTypeName,h=a.useMemo((function(){var e={entityTypeName:p};return Object(v.i)(e)}),[p]),g=Object(n.d)(Ht.d),m=Object(n.d)((function(e){return Object(u.rb)(e,l,h)})),b=Object(n.d)($t.d),y=a.useMemo((function(){return c(function(e,t,r){return{type:"generate.injected.button",sync:!0,execute:function(n,i){var a=[];return qt.forEach((function(o){var s=o(n,i,e,t,r);s&&a.push(s)})),a}}}(t,h,s))}),[c,t,h,s]),_=Object(n.d)((function(e){return Object(u.Ib)(e,t)}));if(!g||!d)return null;var S=m;return b&&(S-=ir),r&&(S-=nr),a.createElement(We.a,{key:t,commandbarDisplayMode:He.a.IconLabel,iconPosition:he.a.Left,id:t,width:S,addedCommandList:y,ribbonId:d,commandBarStyle:i,customCommandManagerStyle:o,commandManagerId:t,isCommandBarRefreshForceEnabled:!0,isMainFormDialog:_})}var ur=r("pJ3X"),dr=0,pr=function(e){function t(t){var r=e.call(this,t)||this;return r._mainSectionElement=null,r._scrollHandlerAdded=!1,r._previousTabScrollTop=0,r._previousScrollingDown=!1,r._scheduledAnimationFrame=!1,r._lastScrollHandlerExecutionTime=0,r._focusInHandlerAdded=!1,r._mainElementFocusInHandlerAdded=!1,r._scrollPositionSet=!1,r._focusedElementSet=!1,r._getControlName=function(e){for(;null!=e;){var t=e.attributes.getNamedItem("data-control-name");if(t)return t.value;if("mainContent"===e.id)return null;e="HTML"===e.tagName&&null!==e.ownerDocument&&null!==e.ownerDocument.defaultView&&null!==e.ownerDocument.defaultView.frameElement?e.ownerDocument.defaultView.frameElement.parentElement:e.parentElement}},r._updateScrollBarVisible=function(){var e=document.getElementById(r.props.mainSectionId),t=e&&e.scrollHeight>e.clientHeight;t!==r.state.scrollBarVisible&&r.setState({scrollBarVisible:t})},r._mainSectionMountCallback=r._mainSectionMountCallback.bind(r),r._tabPlaceholdMeasuringCallback=r._tabPlaceholdMeasuringCallback.bind(r),r._outerheaderContainerOnMeasuring=r._outerheaderContainerOnMeasuring.bind(r),r._onKeyDownHandler=r._onKeyDownHandler.bind(r),r._mainSectionMeasuringCallback=r._mainSectionMeasuringCallback.bind(r),r._formNotificationMeasuringCallback=r._formNotificationMeasuringCallback.bind(r),r._setFormNotificationHeight=r._setFormNotificationHeight.bind(r),r._afterSelectTab=r._afterSelectTab.bind(r),r._onScrollThrottler=r._onScrollThrottler.bind(r),r._focusInHandler=r._focusInHandler.bind(r),r._iframeFocusInHandler=r._iframeFocusInHandler.bind(r),r._mainElementFocusHandler=r._mainElementFocusHandler.bind(r),r._showFooterFieldsRenderInSection=r._showFooterFieldsRenderInSection.bind(r),r.state={sizeMode:null!=t.initialSizeMode?t.initialSizeMode:null,numberOfRow:null,tabScrolledToTop:!0,tabScrolledToBottom:!1,headerCollapsed:!1,headerShadowVisible:!1,formNotificationSize:0,scrollBarVisible:!0},r._lastScrollHandlerExecutionTime=Date.now(),0!==dr||t.enabledFormFCBs.has(Qe.mb)||(dr=hr()),r._mainElementFocusInHandlerAdded=!r.props.enabledFormFCBs.has(Qe.kb),r._scrollPositionSet=!r.props.formScrollAndFocusState||null==r.props.formScrollAndFocusState.scrollTopPosition,r._focusedElementSet=!r.props.formScrollAndFocusState||null==r.props.formScrollAndFocusState.focusedControlName,r._currentScrollAndFocusState={},r._iframesWithFocusHandlerAdded={},r}return Object(i.__extends)(t,e),t.prototype._renderFormHeaderCommandBar=function(){return this.props.showCommandBar?a.createElement(ar,{id:this.props.id,hasCmdbar:this.props.hasCmdbar,recordSetNavigatorCollapsed:this.props.recordSetNavigatorCollapsed,viewPortWidth:this.props.viewPortWidth,smallBreakPoint:this.props.smallBreakPoint,numberOfAvailableRecords:this.props.numberOfAvailableRecords,commandBarStyle:this.props.commandBarStyle,commandManagerStyle:this.props.commandManagerStyle,commandManagerContainerStyle:this.props.commandManagerContainerStyle,tabBackButtonStyle:this.props.tabBackButtonStyle,collapseExpandButtonWrapperStyle:this.props.collapseExpandButtonWrapperStyle,collapseExpandButtonStyle:this.props.collapseExpandButtonStyle,collapseExpandButtonTextStyle:this.props.collapseExpandButtonTextStyle}):null},t.prototype._renderFormHeaderBody=function(){return this.props.enabledFormFCBs.has(Qe.mb)?a.createElement(Mt.a,{loader:function(){return r.e(64).then(r.bind(null,"Mmp8")).then((function(e){return e.FormHeaderV2}))},props:{id:this.props.id,headerCollapsed:this.state.headerCollapsed,domId:this.props.descriptor&&this.props.descriptor.Header&&this.props.descriptor.Header.DomId,previewId:this.props.descriptor&&this.props.descriptor.Header&&this.props.descriptor.Header.PreviewId,visible:this.props.showHeaderBody}}):a.createElement($e,{id:this.props.id,key:Object(A.g)("form-header",this.props.id),headerCollapsed:this.state.headerCollapsed,domId:Object(A.g)(this.props.descriptor&&this.props.descriptor.Header&&this.props.descriptor.Header.DomId,this.props.id),previewId:this.props.descriptor&&this.props.descriptor.Header&&this.props.descriptor.Header.PreviewId,visible:this.props.showHeaderBody})},t.prototype._renderFormHeaderTabNavigator=function(){var e;return this.props.showTabNavigator?this.props.enabledFormFCBs.has(Qe.sc)&&this.props.isInMobileNativeApr2020?a.createElement(Mt.a,{loader:function(){return r.e(80).then(r.bind(null,"4buJ")).then((function(e){return e.MobileScrollableTabs}))},props:{renderHeaderFields:this.props.hasHeaderFields,renderFooterFields:this.props.hasFooterFields,id:this.props.id,availableTabs:this.props.availableTabs,tabStyle:this.props.tabCustomStyle,columnStyle:this.props.columnStyle,sectionStyle:this.props.sectionStyle,cellStyle:this.props.cellStyle,showFooterFieldsRenderInSection:this._showFooterFieldsRenderInSection(),sizeMode:this.state.sizeMode,headerCollapsed:this.state.headerCollapsed,afterSelectTab:this._afterSelectTab,returnTabsBody:!1,enabledFormFCBs:this.props.enabledFormFCBs,isRTL:this.props.isRTL}}):a.createElement(R,{renderHeaderFields:this.props.hasHeaderFields,renderFooterFields:this.props.hasFooterFields,key:(null===(e=this.props.descriptor)||void 0===e?void 0:e.TabNames)+"_tabControl",id:this.props.id,ref:Object(A.g)("tablistRef",this.props.id),availableTabs:this.props.availableTabs,tabStyle:this.props.tabCustomStyle,columnStyle:this.props.columnStyle,sectionStyle:this.props.sectionStyle,cellStyle:this.props.cellStyle,showFooterFieldsRenderInSection:this._showFooterFieldsRenderInSection(),sizeMode:this.state.sizeMode,headerCollapsed:this.state.headerCollapsed,afterSelectTab:this._afterSelectTab,returnTabsBody:!1,enabledFormFCBs:this.props.enabledFormFCBs,initialWidth:this._previousMainSectionWidth}):null},t.prototype._renderFormHeader=function(){var e,t,r;if(this.props&&this.props.id){if(this.props.isFormComponentInstance)return;return this.props.showLoadingIndicator?a.createElement($e,{id:this.props.id,key:Object(A.g)("form-header",this.props.id)}):a.createElement(x.a,{id:Object(A.g)("outerHeaderContainer",this.props.id),style:this._getHeaderContainerStyle(),ref:Object(A.g)("outerHeaderContainer",this.props.id),onMeasuring:this._outerheaderContainerOnMeasuring,isRequestedMeasuring:!0},this._renderFormHeaderCommandBar(),this._renderFormNotifications(),this._renderFormHeaderBody(),(null===(e=this.props.pageInput)||void 0===e?void 0:e.bodyOnly)?null:this._renderBusinessProcessFlow(oe.BreadCrumb),this._renderFormHeaderTabNavigator(),(null===(t=this.props.pageInput)||void 0===t?void 0:t.bodyOnly)||this.props.enabledFormFCBs.has(Qe.mb)?null:a.createElement(H,{headerCollapsed:this.state.headerCollapsed,tabScrolledToTop:this.state.tabScrolledToTop,id:this.props.id,hasCmdBar:this.props.hasCmdbar,formNotificationHeight:this.state.formNotificationSize}),this.props.enabledFormFCBs.has(Qe.mb)&&this._isHeaderSticky&&this.state.headerShadowVisible&&!(null===(r=this.props.pageInput)||void 0===r?void 0:r.bodyOnly)?a.createElement(x.a,{id:"shadow",style:this.props.headerShadowV2Style}):null)}},t.prototype._renderFormFooter=function(){return this.props.isMainFormDialog||!this.props.showFooter?null:this.props.isFormComponentInstance?void 0:(this.props.showLoadingIndicator||null!==this.state.sizeMode&&this.props.viewPortWidth>0&&this.props.viewPortWidth>=this.props.largeBreakPoint)&&this.props&&this.props.id&&this.props.pageInput&&!this.props.pageInput.bodyOnly?a.createElement(Tt,{contextToken:this.props.contextToken,id:this.props.id,key:this.props.id,domId:Object(A.g)(this.props.descriptor&&this.props.descriptor.Footer&&this.props.descriptor.Footer.DomId,this.props.id),previewId:this.props.descriptor&&this.props.descriptor.Footer&&this.props.descriptor.Footer.PreviewId,formValid:this.props.isFormValid,saveLabel:Object(C.c)(this.props.resourceStrings,rt.p),readOnlyMessage:Object(C.c)(this.props.resourceStrings,rt.j),unsavedChangesWarning:Object(C.c)(this.props.resourceStrings,rt.s),offlineChangesMessage:Object(C.c)(this.props.resourceStrings,rt.h),savingChangesMessage:Object(C.c)(this.props.resourceStrings,rt.q),popoutButtonTooltip:Object(C.c)(this.props.resourceStrings,rt.i),saveErrorLabel:Object(C.c)(this.props.resourceStrings,wt.e)}):null},t.prototype._getHeaderContainerStyle=function(){if(this.props.enabledFormFCBs.has(Qe.mb))return this.props.headerContainerStyle;var e={};return dr>0&&this.state.scrollBarVisible&&(e.width="calc(100% - "+dr+"px)"),this.state.headerCollapsed&&(e.height=0),Object(i.__assign)(Object(i.__assign)({},this.props.headerContainerStyle),e)},t.prototype._renderFormNotifications=function(){if(this.props.shouldFormNotificationBarRender){return a.createElement(x.a,{style:{height:"auto",minHeight:this.state.formNotificationSize+"px",borderBottom:"1px solid rgb(216, 216, 216)",flexDirection:"column"}},a.createElement(zt,{id:this.props.id,domWidth:this._domWidth,entityDisplayCollectionName:this.props.entityDescriptor.DisplayCollectionName}),this.props.formNotificationIds&&this.props.formNotificationIds.length>0?a.createElement(tt.a,{key:"formNotificationList",id:this.props.id,domWidth:this._domWidth,component:this.props.rootElementId,customStyle:{marginTop:0},headerCollapsed:this.state.headerCollapsed,buttonMeasuringCallback:this._formNotificationMeasuringCallback,setFormNotificationHeight:this._setFormNotificationHeight}):null)}return 0!==this.state.formNotificationSize&&this.setState(Object(i.__assign)(Object(i.__assign)({},this.state),{formNotificationSize:0})),a.createElement(x.a,{style:{height:0},role:Ee.a,accessibilityLive:"assertive"})},t.prototype._renderBusinessProcessFlow=function(e){if(this.props.isFormComponentInstance||this.props.bpfDisabled)return null;if(this.props.descriptor){var t=this.props.viewPortWidth<=this.props.smallBreakPoint?"translateY(-2.25rem)":"translateY(-3.75rem)",r={"background-color":this.props.theme.colors.WhiteBackground,width:"100%",height:this.props.bpfControlRendered?"4em":"0rem",zIndex:2,transition:V.c,transform:this.state.headerCollapsed?t:"none"};return this.props.bpfControlRendered||(r.display="none"),a.createElement(x.a,{key:oe[e],style:{display:"flex",flexShrink:0},id:"processControl"+oe[e],accessibilityHidden:!!this.state.headerCollapsed||void 0},a.createElement(le,{renderingMode:e,id:this.props.id,key:"businessProcessFlow",contextToken:this.props.contextToken,breadCrumbContainerStyle:r}))}return null},t.prototype._focusInHandler=function(e){var t=e&&e.target&&e.target,r=e&&e.relatedTarget&&e.relatedTarget,n=o.findDOMNode(this.refs[Object(A.g)("outerHeaderContainer",this.props.id)]),i=r&&n&&n.contains(r),a=o.findDOMNode(this.refs[Object(A.g)("tablistRef",this.props.id)]);if(this.props.enabledFormFCBs.has(Qe.kb)&&(this._currentScrollAndFocusState.focusedControlName=this._getControlName(t)),t&&a&&t.getBoundingClientRect()&&a.getBoundingClientRect()&&t&&r&&t!==r&&!r.contains(t)&&!i){var s=t.getBoundingClientRect().top-a.getBoundingClientRect().bottom;if(s<0&&this._mainSectionElement){var c=this._mainSectionElement.scrollTop;(c+=Math.min(0,3*s))<25&&(c=0),this._mainSectionElement.scrollTop=c}}},t.prototype._onScrollThrottler=function(e){if(!this._scheduledAnimationFrame)if(Gt.a.getInstance().get_IsAndroid())requestAnimationFrame(this._scrollHandler.bind(this)),this._scheduledAnimationFrame=!0;else{var t=Date.now();t-this._lastScrollHandlerExecutionTime>=100&&(requestAnimationFrame(this._scrollHandler.bind(this)),this._scheduledAnimationFrame=!0,this._lastScrollHandlerExecutionTime=t)}},t.prototype._scrollHandler=function(){var e=this.state.headerCollapsed,t=this.state.headerShadowVisible,r=this._mainSectionElement,n=r.scrollTop;if(n!==this._previousTabScrollTop){var a=n<=0,o=r.scrollHeight-n<=r.offsetHeight,s=n>this._previousTabScrollTop;if(s!==this._previousScrollingDown){var c=n>=this.props.headerSpacerHeightInPx-this.props.headerCollapsedHeightInPx;(s&&c||!s)&&(s&&!a||!s&&!o)&&(this._previousScrollingDown=s,e=s)}s&&(t=!0);var l=a!==this.state.tabScrolledToTop,u=o!==this.state.tabScrolledToBottom,d=e!==this.state.headerCollapsed,p=t!==this.state.headerShadowVisible;if(l||u||d||p){var h={};a!==this.state.tabScrolledToTop&&(h.tabScrolledToTop=a),o&&!this.state.tabScrolledToBottom?(h.tabScrolledToBottom=!0,this.props.updateFormViewPortSizes(this.props.contextToken,this._previousMainSectionWidth,this._getNewViewPortHeight(this._previousMainSectionHeight))):!o&&this.state.tabScrolledToBottom&&(h.tabScrolledToBottom=!1,this.props.updateFormViewPortSizes(this.props.contextToken,this._previousMainSectionWidth,this._previousMainSectionHeight)),d&&!this.props.enabledFormFCBs.has(Qe.mb)&&(h.headerCollapsed=e),p&&this.props.enabledFormFCBs.has(Qe.mb)&&(h.headerShadowVisible=t),this.setState(Object(i.__assign)(Object(i.__assign)({},this.state),h))}}this._previousTabScrollTop=n,this._scheduledAnimationFrame=!1},t.prototype._renderTabs=function(){var e;return this.props.descriptor&&this.props.descriptor.TabNames?this.props.enabledFormFCBs.has(Qe.mb)||this.props.isFormComponentInstance?this._renderTabsBody():a.createElement(x.a,{semanticTag:"section",style:{width:"100%",display:"flex",flexDirection:"column",flex:"1 0 auto",position:"relative"}},(null===(e=this.props.pageInput)||void 0===e?void 0:e.bodyOnly)&&!this.props.hasCmdbar?null:a.createElement(x.a,{style:this._getTransformedHeaderSpacerStyle(this.props.headerSpacerStyle)}),this._renderTabsBody()):null},t.prototype._renderTabsBody=function(){var e;return this.props.enabledFormFCBs.has(Qe.sc)&&this.props.isInMobileNativeApr2020?a.createElement(Mt.a,{loader:function(){return r.e(80).then(r.bind(null,"4buJ")).then((function(e){return e.MobileScrollableTabs}))},props:{renderHeaderFields:this.props.hasHeaderFields,renderFooterFields:this.props.hasFooterFields,id:this.props.id,availableTabs:this.props.availableTabs,tabStyle:this.props.tabCustomStyle,columnStyle:this.props.columnStyle,sectionStyle:this.props.sectionStyle,cellStyle:this.props.cellStyle,showFooterFieldsRenderInSection:this._showFooterFieldsRenderInSection(),sizeMode:this.state.sizeMode,returnTabsBody:!0,viewportElementId:this.props.mainSectionId,enabledFormFCBs:this.props.enabledFormFCBs}}):a.createElement(R,{renderHeaderFields:this.props.hasHeaderFields,renderFooterFields:this.props.hasFooterFields,key:(null===(e=this.props.descriptor)||void 0===e?void 0:e.TabNames)+"_tabControl2",id:this.props.id,availableTabs:this.props.availableTabs,tabStyle:this.props.tabCustomStyle,columnStyle:this.props.columnStyle,sectionStyle:this.props.sectionStyle,cellStyle:this.props.cellStyle,showFooterFieldsRenderInSection:this._showFooterFieldsRenderInSection(),sizeMode:this.state.sizeMode,returnTabsBody:!0,viewportElementId:this.props.mainSectionId,enabledFormFCBs:this.props.enabledFormFCBs})},t.prototype._renderOverlay=function(){if(this.props.showSavingIndicator||this.props.isMainFormDialog&&this.props.showLoadingIndicator){var e=Object(C.c)(this.props.resourceStrings,this.props.showSavingIndicator?rt.r:rt.e);return this.props.isInMobileNative&&(e=null),a.createElement(x.a,{style:this.props.overlayStyle},a.createElement(ge.a,{style:this.props.overlayTextStyle},e))}return null},t.prototype._getTransformedHeaderSpacerStyle=function(e){if(!e||!e.height||!this.state.formNotificationSize)return e;var t=e.height.split("rem");return t&&0!==t.length?Object(i.__assign)(Object(i.__assign)({},e),{height:parseFloat(t[0])+Object(b.b)(this.state.formNotificationSize)/3+"rem"}):e},t.prototype._formNotificationMeasuringCallback=function(e,t){this.props.formNotificationIds&&1!==this.props.formNotificationIds.length||this._setFormNotificationHeight(t)},t.prototype._setFormNotificationHeight=function(e){Math.abs(e-this.state.formNotificationSize)>1&&(e<40&&(e=kt.a),this.setState(Object(i.__assign)(Object(i.__assign)({},this.state),{formNotificationSize:e})))},t.prototype._mainSectionMeasuringCallback=function(e,t){var r=e<this.props.mediumBreakPoint?2:e<=this.props.largeBreakPoint?1:0;r!==this.state.sizeMode&&this.setState({sizeMode:r}),this.props.enabledFormFCBs.has(Qe.mb)&&this._updateIsHeaderSticky(e,t),this._previousMainSectionHeight=t,this._previousMainSectionWidth=e,!this.props.isFormComponentInstance&&this.props.updateFormViewPortSizes(this.props.contextToken,e,this._getNewViewPortHeight(t)),this.props.enabledFormFCBs.has(Qe.mb)||(dr=hr())},t.prototype._updateIsHeaderSticky=function(e,t){(!this.props.isInMobileNative||this.props.isMainFormDialog)&&e>Wt.a?this._previousMainSectionWidth!==e&&(this._isHeaderSticky=!(e<=700&&t<=300&&0!==t)):this._isHeaderSticky=!1},t.prototype._getNewViewPortHeight=function(e){var t=e,r=this.props.clientHost===B.a.MobileApplication;return(!r&&2===this.state.sizeMode&&this.state.tabScrolledToBottom||r&&this.state.tabScrolledToBottom)&&(t-=Object(b.d)("footerWrapper")),(!this.props.enabledFormFCBs.has(Qe.mb)||this.props.enabledFormFCBs.has(Qe.mb)&&!this._isHeaderSticky)&&(t-=this._previousHeaderHeight),t},t.prototype._onKeyDownHandler=function(e){e&&e.keyCode&&e.keyCode===g.a.Escape&&this.props.cancelForm(this.props.pageInput,this.props.output)},t.prototype._getDefaultFocusId=function(){if(this.props.isMainFormDialog)return Object(At.b)(this.props.id);if(this.props.pageInput&&this.props.pageInput.bodyOnly&&this.props.selectedRelatedEntity)return this.props.viewSelectorDOMId;if(this.props.descriptor&&this.props.descriptor.Tabs&&this.props.selectedTab){for(var e=this.props.descriptor.Tabs,t=0;t<e.length;t++)if(e[t].Id===this.props.selectedTab)return Object(A.g)(e[t].Id,this.props.id)}else if(this.props.selectedRelatedEntity)return Object(A.g)(k.a,this.props.id)},t.prototype._tabPlaceholdMeasuringCallback=function(e,t){var r=parseInt((t/Object(b.a)(this.props.tabPlaceholdRowHeightEm)).toString(),10)-1;this.setState(Object(i.__assign)(Object(i.__assign)({},this.state),{numberOfRow:r}))},t.prototype._outerheaderContainerOnMeasuring=function(e,t){var r=document.getElementById(Object(A.g)("outerHeaderContainer",this.props.id));r&&(this._domWidth=r.offsetWidth,this._previousHeaderHeight!==t&&(this._previousHeaderHeight=t,!this.props.isFormComponentInstance&&this.props.updateFormViewPortSizes(this.props.contextToken,this._previousMainSectionWidth,this._getNewViewPortHeight(this._previousMainSectionHeight))))},t.prototype._renderRowPlacehold=function(){var e=[];if(!this.state||!this.state.numberOfRow)return e;for(var t=0;t<this.state.numberOfRow;t++)e.push(a.createElement(x.a,{style:this.props.rowPlaceholdContainerStyle},a.createElement(x.a,{key:"sectionColumn1Placehold",style:this.props.sectionColumn1PlaceholdStyle},a.createElement(x.a,{style:this.props.rowPlaceholdStyle})),a.createElement(x.a,{key:"sectionColumn2Placehold",style:this.props.sectionColumn2PlaceholdStyle},a.createElement(x.a,{style:this.props.rowPlaceholdStyle}))));return e},t.prototype._renderLoadingExperience=function(){return a.createElement(x.a,{testhooks:{id:xt.a},semanticTag:"form",id:this.props.rootElementId,style:this.props.formGeneralStyle,role:Ee.r},a.createElement(x.a,{style:this.props.formMainSectionStyle},a.createElement(x.a,{style:this.props.mainContentStyle},this.props.viewPortWidth<=this.props.smallBreakPoint||!this.props.hasCmdbar?null:a.createElement(x.a,{id:"commandBarPlacehold",key:Object(A.g)("commandBarPlacehold",this.props.id),style:this.props.commandBarPlaceholdStyle}),this._renderFormHeader(),a.createElement(x.a,{key:Object(A.g)("bpfPlacehold",this.props.id),id:Object(A.g)("bpfPlacehold",this.props.id),style:this.props.bpfPlaceholdStyle}),this.props.hasCmdbar?a.createElement(x.a,{key:Object(A.g)("tabNavPlacehold",this.props.id),id:Object(A.g)("tabNavPlacehold",this.props.id),style:this.props.tabNavPlaceholdStyle}):null,a.createElement(x.a,{id:Object(A.g)("tab-section-placeholder",this.props.id),key:Object(A.g)("tab-section-placeholder",this.props.id),style:this.props.mainSectionPlaceholdStyle},a.createElement(x.a,{key:"tabPlacehold",style:this.props.tabPlaceholdStyle,isRequestedMeasuring:!0,onMeasuring:this._tabPlaceholdMeasuringCallback},a.createElement(x.a,{key:"legendPlaceholdContainer",style:this.props.legendPlaceholdContainerStyle},a.createElement(x.a,{key:"legendPlacehold",style:this.props.legendPlaceholdStyle})),a.createElement(x.a,{key:"sectionContainerPlacehold",style:this.props.sectionContainerPlaceholdStyle},this._renderRowPlacehold()))))),this._renderFormFooter(),a.createElement(et.a,{key:Object(A.g)("editformAccessibility",this.props.id),rootElementId:Object(A.g)("editFormRoot",this.props.id),isModal:!1,shouldManageFocus:!0}),this._renderOverlay())},t.prototype._createKeyboardShortcuts=function(){var e=[];if(!this.props.isFormComponentInstance){var t=Object(C.c)(this.props.resourceStrings,nt.a),r=Object(C.c)(this.props.resourceStrings,nt.b),n=this._shortcutHandler.bind(this),i=new lt.a([g.a.Ctrl,g.a.S],n,!0,t,r);e.push(i)}return e},t.prototype._shortcutHandler=function(e){var t=e.EVENT;t.preventDefault(),t.ctrlKey&&t.keyCode===g.a.S&&!this.props.hasActiveDialogOnTop&&(this._clearFormNotification(Nt.b),this.props.saveForm(this.props.pageInput))},t.prototype._clearFormNotification=function(e){e&&this.props.formNotificationIds.indexOf(e)>=0&&this.props.clearFormNotification(this.props.contextToken,e)},t._addPreviewAttribute=function(e,t){e.setAttribute("data-"+qe.b,t)},t.prototype._mainSectionMountCallback=function(e){var r;e&&(this._scrollHandlerAdded&&this._focusInHandlerAdded&&this._mainElementFocusInHandlerAdded||(r=o.findDOMNode(e))&&(this._mainSectionElement=r,this._scrollHandlerAdded||(r.addEventListener("scroll",this._onScrollThrottler),this._scrollHandlerAdded=!0),this._focusInHandlerAdded||(r.addEventListener("focusin",this._focusInHandler),this._focusInHandlerAdded=!0),this._mainElementFocusInHandlerAdded||(document.getElementById("mainContent").addEventListener("focusin",this._mainElementFocusHandler),this._mainElementFocusInHandlerAdded=!0)),this.props.pageInput&&this.props.pageInput.isPreview&&(r||(r=o.findDOMNode(e)),r&&this.props.formId&&t._addPreviewAttribute(r,""+qe.a+this.props.formId.guid+"-"+qe.d+"-mainSection")))},t.prototype._rootMountCallback=function(e){if(e&&this.props.pageInput&&this.props.pageInput.isPreview){var r=o.findDOMNode(e);r&&this.props.formId&&t._addPreviewAttribute(r,""+qe.a+this.props.formId.guid)}},t.prototype._afterSelectTab=function(){this.setState(Object(i.__assign)(Object(i.__assign)({},this.state),{headerCollapsed:!1,tabScrolledToTop:!0})),this._mainSectionElement.scrollTop=0},t.prototype._showFooterFieldsRenderInSection=function(){return this.props.viewPortWidth<=this.props.largeBreakPoint&&!(this.props.clientHostSubtype===Ne.a.Phone&&!this.props.isFooterAvailableForPhone)},t.prototype._renderMainSection=function(){var e=this,t="backgroundContainer-"+this.props.id;return a.createElement(x.a,{id:this.props.mainSectionId,ref:function(t){return e._mainSectionMountCallback(t)},key:xt.c,style:this.props.tabGeneralStyle,isRequestedMeasuring:!0,onMeasuring:this._mainSectionMeasuringCallback},!this.props.isFormComponentInstance&&this.props.isInMobileNative&&!this.props.isMainFormDialog&&a.createElement(ur.b,{id:this.props.mainSectionId}),this.props.enabledFormFCBs.has(Qe.mb)&&!this._isHeaderSticky&&!this.props.isFormComponentInstance&&this._renderFormHeader(),null!==this.state.sizeMode&&a.createElement(x.a,{id:t,style:this.props.tabHeaderBodyContainerStyle},this._renderTabs()))},t.prototype.componentDidUpdate=function(){Gt.a.getInstance().get_IsBrowserFirefox()&&(null!=this._scrollBarVisibleInitialTimeoutId&&clearTimeout(this._scrollBarVisibleInitialTimeoutId),null!=this._scrollBarVisibleDelayedTimeoutId&&clearTimeout(this._scrollBarVisibleDelayedTimeoutId),this._scrollBarVisibleInitialTimeoutId=setTimeout(this._updateScrollBarVisible),this._scrollBarVisibleDelayedTimeoutId=setTimeout(this._updateScrollBarVisible,1e3)),this.props.enabledFormFCBs.has(Qe.kb)&&(this._focusedElementSet||null!=document.querySelector("[data-control-name="+this.props.formScrollAndFocusState.focusedControlName+"]")&&(this.props.setFocus(this.props.id,this.props.contextToken,this.props.formScrollAndFocusState.focusedControlName),this._focusedElementSet=!0),this._scrollPositionSet||(this._mainSectionElement.scrollTop=this.props.formScrollAndFocusState.scrollTopPosition,this._scrollPositionSet=this._mainSectionElement.scrollTop===this.props.formScrollAndFocusState.scrollTopPosition),null!=this._mainSectionElement&&this._addFocusHandlersForIframes(this._mainSectionElement.getElementsByTagName("iframe")))},t.prototype.componentWillUnmount=function(){this.props.enabledFormFCBs.has(Qe.kb)&&(this._currentScrollAndFocusState.scrollTopPosition=this._mainSectionElement.scrollTop,this.props.setFormScrollAndFocusState(this.props.id,this.props.contextToken,this._currentScrollAndFocusState),document.getElementById("mainContent").removeEventListener("focusin",this._mainElementFocusHandler),this._removeFocusHandlersForIFrames(this._mainSectionElement.getElementsByTagName("iframe")))},t.prototype._addFocusHandlersForIframes=function(e){for(var t,r=0;r<e.length;r++)null!=e[r].contentDocument&&(this._iframesWithFocusHandlerAdded[e[r].outerHTML]||(null===(t=e[r].contentDocument.body)||void 0===t||t.addEventListener("focusin",this._iframeFocusInHandler),this._iframesWithFocusHandlerAdded[e[r].outerHTML]=e[r]),this._addFocusHandlersForIframes(e[r].contentDocument.getElementsByTagName("iframe")))},t.prototype._removeFocusHandlersForIFrames=function(e){for(var t,r=0;r<e.length;r++)null!=e[r].contentDocument&&(null===(t=e[r].contentDocument.body)||void 0===t||t.removeEventListener("focusin",this._iframeFocusInHandler),this._removeFocusHandlersForIFrames(e[r].contentDocument.getElementsByTagName("iframe")))},t.prototype._iframeFocusInHandler=function(e){var t=e&&e.target&&e.target;this.props.enabledFormFCBs.has(Qe.kb)&&(this._currentScrollAndFocusState.focusedControlName=this._getControlName(t))},t.prototype._mainElementFocusHandler=function(e){var t=e&&e.target&&e.target;this.props.enabledFormFCBs.has(Qe.kb)&&"mainContent"===t.id&&(this._currentScrollAndFocusState.focusedControlName=null)},t.prototype.render=function(){var e=this;if(!this.props.pageInput)return null;if(this.props.showLoadingIndicator&&!this.props.isMainFormDialog)return this._renderLoadingExperience();var t=Et.a.getInstance().getDisableScrollStyle()?"forceNewStackContextInert":"forceNewStackContext";return a.createElement(gr.Provider,{value:this.props.resourceStrings},a.createElement(x.a,Object(i.__assign)({style:this.props.containerStyle,role:Ee.r},this.props.isMainFormDialog?{onKeyDown:this._onKeyDownHandler}:null),a.createElement(x.a,{testhooks:{id:this.props.isMainFormDialog?xt.b:xt.a},ref:function(t){return e._rootMountCallback(t)},role:this.props.isFormComponentInstance?null:Ee.g,id:this.props.rootElementId,style:this.props.formGeneralStyle,labelledByElementId:this.props.isFormComponentInstance?null:Object(A.g)(Ye.a,this.props.id),explicitStyles:t},a.createElement(x.a,{style:this.props.formMainSectionStyle},a.createElement(x.a,{style:this.props.mainContentStyle,explicitStyles:t},(!this.props.enabledFormFCBs.has(Qe.mb)||this.props.enabledFormFCBs.has(Qe.mb)&&this._isHeaderSticky)&&this._renderFormHeader(),this._renderMainSection()),null!==this.state.sizeMode&&this._renderBusinessProcessFlow(oe.Stage)),this._renderFormFooter(),this.props.isFormComponentInstance?null:a.createElement(et.a,{key:Object(A.g)("editformAccessibility",this.props.id),rootElementId:this.props.rootElementId,isModal:this.props.isMainFormDialog,shouldManageFocus:!0,waitForEditable:!1,overrideFocusId:this._getDefaultFocusId(),keyboardShortcuts:this._createKeyboardShortcuts()}),this._renderOverlay())))},t}(a.Component);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function hr(){var e=dr;if(!Gt.a.getInstance().get_IsAndroid()){var t=document.createElement("div");t.style.width="100px",t.style.height="100px",t.style.overflow="scroll",t.style.position="absolute",t.style.top="-10000px",t.style.visibility="hidden",document.body.appendChild(t),e=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return e}pr.displayName="EditFormRoot";var gr=a.createContext({}),mr=r("vO+w"),fr=r("LAsh");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function br(){var e=null,t=null,r=null,n=null,a=null,o=null,s=null,c=null,l=null,p=null,h=null,g=null,m=null,f=null,_=null;return function(O,C,I,j,P){var F,T,w=Object(S.a)(O),E=Object(mr.c)(O),x=Object(mr.a)(O),N=null==x?void 0:x.Colors,A=Object(y.c)(O),k=Object(y.b)(O),M=Object(ye.g)(O),D=Object(v.j)(O,C.id),R=Object(u.o)(O,C.id,D),B=Object(u.Bb)(O,C.id,D),L=function(e,t,r){var n=Object(d.e)(e,{id:t},r);return n&&!!n.url||yr.some((function(r){return r(e,t,n)}))}(O,C.id,D),V=function(e,t,r){var n=Object(d.e)(e,{id:t},r);return n&&!!n.entityName}(O,C.id,D),z=Object(u.Eb)(O,C.id);if(t!==w||a!==A||o!==k||s!==M||c!==R||l!==B||p!==I||h!==j||m!==P||g!==L||f!==V||_!==z||r!==E||n!==N){t=w,a=A,o=k,s=M,c=R,l=B,p=I,h=j,m=P,g=L,f=V,_=z,r=E,n=N;var G=function(e,t){if(!t)return e;var r={display:"block"};return Object(i.__assign)(Object(i.__assign)({},e),r)}({display:"flex",position:"relative",flexDirection:"column",flex:"1 0 0px",maxWidth:"100%",width:"100%",height:"100%",overflow:"hidden",backgroundColor:E?null===(F=null==N?void 0:N.Palette)||void 0===F?void 0:F.Primary01:w.colors.BaseColor.White},z),W=function(e,t){if(!t)return e;return Object(i.__assign)(Object(i.__assign)({},e),{overflowY:"auto"})}({display:"flex",position:"relative",flexDirection:"column",flex:"1 1 0px",width:"100%",height:"inherit",overflowY:"hidden",overflowX:"hidden"},z),H=function(e,t){if(!t)return e;var r={height:"auto",display:"block"};return Object(i.__assign)(Object(i.__assign)({},e),r)}({display:P.has(Qe.mb)?"inline-flex":"flex",flexDirection:"column",flexGrow:1,maxWidth:"100%",width:"100%",height:P.has(Qe.mb)?"auto":"100%",overflowX:"hidden"},z),U=function(e,t){if(!t)return e;var r={marginRight:0,marginLeft:0};return Object(i.__assign)(Object(i.__assign)({},e),r)}({boxSizing:"border-box",marginLeft:A<w.sizes.Breakpoints.DimensionS?0:w.sizes.Measures.Measure075,marginRight:A<w.sizes.Breakpoints.DimensionS?0:w.sizes.Measures.Measure075},z),q=Object(fr.a)(w),X={paddingTop:w.sizes.Measures.Measure025,paddingBottom:w.sizes.Measures.Measure225,paddingLeft:q.paddingLeft,paddingRight:q.paddingRight,borderStyle:"solid",borderWidth:"1px",borderColor:w.colors.SectionBorder,marginBottom:A<w.sizes.Breakpoints.DimensionS?w.sizes.Measures.Measure050:w.sizes.Measures.Measure150},K=function(e,t){if(!t)return e;var r={display:"block",flex:"1 0 auto",width:"100%",height:"auto",margin:0};return Object(i.__assign)(Object(i.__assign)({},e),r)}({display:"flex",flexDirection:"column",flex:"1 0",width:"100%",height:"100%",margin:0,overflowY:"auto"},z);(function(e,t,r,n,a){var o=Object(He.p)(r,null),s=!1;o.container.backgroundColor=s?t.colors.BaseColor.White:t.colors.MainThemeColor.MainColor1.Fill,o.container.marginLeft="0px",o.container.marginRight="0px",n&&(o.container.boxSizing="border-box");o.listItemBody.text.color=s?t.colors.BaseColor.Grey.Grey7:t.colors.MainThemeColor.MainColor1.Text,o.listItemBody.icon.color=s?t.colors.BaseColor.Grey.Grey7:t.colors.MainThemeColor.MainColor1.Text,o.listItemBody.iconWrapperStyles.color=s?t.colors.BaseColor.Grey.Grey7:t.colors.MainThemeColor.MainColor1.Text,o.moreIcon.color=s?t.colors.BaseColor.Grey.Grey7:t.colors.MainThemeColor.MainColor1.Text,o.splitbuttonicon.color=s?t.colors.BaseColor.Grey.Grey7:t.colors.MainThemeColor.MainColor1.Text;var c={":hover":{backgroundColor:s?t.colors.BaseColor.Grey.Grey2:t.colors.MainThemeColor.MainColor3.Fill}},l={"[aria-expanded=true]":{backgroundColor:s?t.colors.BaseColor.Grey.Grey2:t.colors.MainThemeColor.MainColor3.Fill},"[data-expanded=true]":{backgroundColor:s?t.colors.BaseColor.Grey.Grey2:t.colors.MainThemeColor.MainColor3.Fill}};o.listItemBody.button=Object(i.__assign)(Object(i.__assign)({},o.listItemBody.button),c),o.overflowFlyoutMoreButton=Object(i.__assign)(Object(i.__assign)({},o.overflowFlyoutMoreButton),c),o.listItem=Object(i.__assign)(Object(i.__assign)({},o.listItem),l),o.splitbuttonOverflowButton=Object(i.__assign)(Object(i.__assign)({},o.splitbuttonOverflowButton),l),e.commandBarStyle=o;var u=Object(He.s)()(a,null,!0);Object(He.b)(u,e.commandBarStyle,s,e.commandManagerStyle,e.commandManagerContainerStyle),function(e,t,r,n,i){var a={},o={};if(r&&!n){var s=Object(He.m)(null);o={color:s.colors.text,borderWidth:i?"0 0 "+s.border.width+" "+s.border.width:"0 "+s.border.width+" "+s.border.width+" 0",borderStyle:s.border.style,borderColor:s.colors.border+" !important"},a={backgroundColor:s.colors.background},Object.assign(t,o),Object.assign(e,a)}}(e.collapseExpandButtonWrapperStyle,e.collapseExpandButtonStyle,u.isRefreshedCommandBarFCBEnabled,s,r)})(e={containerStyle:{display:"block",flex:"1 0 0px",width:"100%",height:"100%",maxWidth:"100%",overflowX:"hidden"},formMainSectionStyle:{display:"flex",flexDirection:"row",flex:"1 1 0px",height:"inherit",maxWidth:"100%",minHeight:"0"},formGeneralStyle:G,tabGeneralStyle:W,tabHeaderBodyContainerStyle:K,tabCustomStyle:{overflowX:"visible",flex:"1 0 auto",width:"100%",boxSizing:"border-box",maxWidth:"100%",transform:"rotate(0deg)"},formButtonWrapper:{float:"right"},formButtonStyle:{borderStyle:"none",backgroundColor:"transparent",cursor:"pointer"},formButtonIconStyle:{color:"#000",width:"40px",backgroundColor:"transparent",fontSize:w.fontSizes.TextBox.FontIcon},formCloseViewStyle:{display:"flex",flex:"0 0 auto"},formCloseStyle:{borderWidth:"0px",alignSelf:"flex-end",cursor:"pointer",backgroundColor:"transparent"},saveButtonStyle:{margin:"7px",display:"flex",flex:"0 0 auto"},formCloseIconStyle:{color:"#000",fontFamily:"Dyn CRM Symbol, Segoe MDL2 Assets",fontSize:"12px",backgroundColor:"transparent"},temporaryButtonContainerStyle:{margin:w.sizes.SmallMargin,display:"flex",flex:"0 0 auto",flexWrap:"wrap"},recordSetNavigationContainerStyle:{width:w.sizes.RecordSetNavigator.width},mainContentStyle:H,overlayStyle:{opacity:.8,backgroundColor:E?null===(T=null==N?void 0:N.Palette)||void 0===T?void 0:T.Primary01:w.colors.BaseColor.White,position:"absolute",width:"100%",height:"100%",top:0,left:0},overlayTextStyle:{width:"100%",textAlign:"center",fontSize:w.fontSizes.Font100,color:w.colors.BaseColor.Grey.Grey7,lineHeight:o.toString()+"px"},commandManagerContainerStyle:{maxHeight:w.sizes.Measures.Measure300,height:w.sizes.Measures.Measure300,flex:"1 0 auto",backgroundColor:w.colors.WhiteBackground},commandManagerStyle:{right:"0",width:"100%",alignItems:"center",flexGrow:1,paddingTop:w.sizes.Measures.Measure075,paddingBottom:w.sizes.Measures.Measure075,paddingRight:w.sizes.Measures.Measure100,paddingLeft:w.sizes.Measures.Measure075,backgroundColor:w.colors.MainThemeColor.MainColor1.Fill,color:w.colors.BaseColor.White},commandBarStyle:{container:{backgroundColor:w.colors.MainThemeColor.MainColor1.Fill,width:"100%",maxHeight:"100%",height:"100%",boxSizing:"border-box"},list:{margin:0,height:w.sizes.Measures.Measure100},listItem:{marginRight:w.sizes.Measures.Measure200,marginLeft:0,height:w.sizes.Measures.Measure100,lineHeight:w.sizes.Measures.Measure100},listItemBody:{text:{fontFamily:w.fontFamilies.Regular,color:w.colors.BaseColor.White},button:{height:w.sizes.Measures.Measure150,lineHeight:w.sizes.Measures.Measure100,padding:0,backgroundColor:"transparent",borderStyle:"none",color:w.colors.BaseColor.White},icon:{color:w.colors.BaseColor.White,height:w.sizes.Measures.Measure100,lineHeight:w.sizes.Measures.Measure100,fontSize:"16px"}},overflowFlyoutMoreButton:{backgroundColor:"transparent",lineHeight:w.sizes.Measures.Measure100,height:w.sizes.Measures.Measure100,borderStyle:"none",padding:0,cursor:"pointer",color:w.colors.BaseColor.White}},collapseExpandButtonWrapperStyle:{backgroundColor:w.colors.MainThemeColor.MainColor1.Fill},collapseExpandButtonStyle:{display:"inline-block",borderStyle:"solid",backgroundColor:"transparent",cursor:"pointer",color:w.colors.MainThemeColor.MainColor1.Text,margin:0,width:w.sizes.Measures.Measure300,height:w.sizes.Measures.Measure300,borderWidth:M?"0 0 0 1px":"0 1px 0 0",borderRightColor:w.colors.MainThemeColor.MainColor1.Text},collapseExpandButtonTextStyle:{fontSize:"16px",margin:"0 auto"},commandBarPlaceholdStyle:{width:"100%",height:w.sizes.Measures.Measure400,backgroundColor:w.colors.BaseColor.Grey.Grey3},bpfPlaceholdStyle:{width:"100%",height:A<=w.sizes.Breakpoints.DimensionS?w.sizes.Measures.Measure400:w.sizes.Measures.Measure450},tabNavPlaceholdStyle:{width:"100%",height:(w.sizes.Breakpoints.DimensionS,w.sizes.Measures.Measure225),marginBottom:A<=w.sizes.Breakpoints.DimensionS?w.sizes.Measures.Measure050:w.sizes.Measures.Measure150},tabPlaceholdStyle:{display:"flex",flex:"1 1 auto",flexDirection:"column",borderStyle:"solid",borderTopWidth:w.sizes.Measures.Measure025,borderTopColor:w.colors.BaseColor.Grey.Grey3,backgroundColor:w.colors.BaseColor.White,borderLeftWidth:"1px",borderLeftColor:w.colors.SectionBorder,borderRightWidth:"1px",borderRightColor:w.colors.SectionBorder,borderBottomWidth:"1px",borderBottomColor:w.colors.SectionBorder,paddingLeft:w.sizes.Measures.Measure100,paddingRight:w.sizes.Measures.Measure100},mainSectionPlaceholdStyle:{flex:"1 1 auto",paddingLeft:A<=w.sizes.Breakpoints.DimensionS?w.sizes.Measures.Measure050:w.sizes.Measures.Measure150,paddingRight:A<=w.sizes.Breakpoints.DimensionS?w.sizes.Measures.Measure050:w.sizes.Measures.Measure150},legendPlaceholdContainerStyle:{display:A<=w.sizes.Breakpoints.DimensionS?"block":"flex",width:"100%",height:w.sizes.Measures.Measure300,borderStyle:"solid",borderBottomWidth:"1px",borderBottomColor:w.colors.BaseColor.Grey.Grey1,position:"relative"},legendPlaceholdStyle:{height:w.sizes.Measures.Measure100,backgroundColor:w.colors.BaseColor.Grey.Grey1,marginTop:w.sizes.Measures.Measure100,marginBottom:w.sizes.Measures.Measure100,width:"12%"},sectionContainerPlaceholdStyle:{display:"block",width:"100%",flex:"1 1 auto"},rowPlaceholdContainerStyle:{width:"100%",height:w.sizes.Measures.Measure300,borderStyle:"solid",borderBottomWidth:"1px",borderBottomColor:w.colors.BaseColor.Grey.Grey1,position:"relative"},rowPlaceholdStyle:{height:w.sizes.Measures.Measure100,backgroundColor:w.colors.BaseColor.Grey.Grey1,marginTop:w.sizes.Measures.Measure100,marginBottom:w.sizes.Measures.Measure100,width:"100%"},sectionColumn1PlaceholdStyle:{position:"relative",flexGrow:1,width:"25%",marginRight:"5%",height:"100%",display:"block"},sectionColumn2PlaceholdStyle:{position:"relative",flexGrow:3,width:"70%",height:"100%",display:"block"},columnStyle:U,sectionStyle:X,cellStyle:{flex:"0 1 auto"},headerSpacerStyle:{display:"block",height:A<=w.sizes.Breakpoints.DimensionM?w.sizes.Measures.Measure450:"16rem"},headerSpacerHeightInPx:224,headerCollapsedHeightInPx:112,headerContainerStyle:{display:"flex",flexDirection:"column",flex:"0 0 auto",width:"100%",margin:0,position:P.has(Qe.mb)?"static":"absolute",top:P.has(Qe.mb)?0:void 0,zIndex:1},headerShadowStyle:"rgba(0, 0, 0, 0.5) 0px 6px 4px -4px",headerShadowV2Style:{height:E?"0px":"4px",width:"100%",background:"linear-gradient(180deg, rgba(0,0,0,.35), rgba(0, 0, 0, 0))"},tabBackButtonStyle:{borderWidth:M?"0 0 1px 1px":"0 1px 1px 0"}},w,M,I,O),function(e,t,r,n,i,a,o){var s=r<=t.sizes.Breakpoints.DimensionS?14.5:16,c=8;n||(s-=4);o&&(s=r<=t.sizes.Breakpoints.DimensionS?0:3);!i&&s>=3&&(s-=3);a&&(s+=2.65);e.headerSpacerStyle.height=s+"rem",e.headerSpacerHeightInPx=Object(b.a)(s),e.headerCollapsedHeightInPx=Object(b.a)(c)}(e,w,A,R,B,I,j)}return e}}var yr=[function(e,t,r){return Object(T.b)(e,t,r)}];var vr=r("BRt1"),_r=r("n4BT"),Sr=r("JlqV"),Or=r("BvBP"),Cr=r("Ev4I"),Ir=r("VWqI"),jr=r("2p2B"),Pr=r("UGbr"),Fr=r("Gemh"),Tr=r("KZbu"),wr=r("mVnn"),Er=r("/lKk"),xr=r("3Ng8"),Nr=r("/SyX"),Ar=r("cQE4"),kr=r("Nw1z"),Mr=r("K1ho"),Dr=r("tNVD");var Rr=Object(n.a)((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){var e=Object(C.h)(),t=Object(u.Yc)(),r=br(),n=Object(u.ed)(),i=Object(u.dd)(),a=Object(u.ad)(),o=Object(u.cd)(),s=null;return function(c,p){var h=Object(v.j)(c,p.id);Object(l.e)(s,h)||(s=h);var g,m=xt.a+p.id,b=Object(S.a)(c),_=Object(f.g)(c,p.id),O=Object(Re.a)(c,p.id),C=Object(u.fb)(c,p,s),I=Object(u.wc)(c,p,s),j=Object(u.J)(c,p),P=Object(je.a)(c,p.id),T=Object(u.g)(O,c,p,s)||P<Pe.a.EditReady,w=t(c,p.id),E=Object(u.Ib)(c,p.id),x=Object(xr.a)(c,p.id),N=e(c,x),A=Object(y.c)(c),k=Object(F.h)(c,null==_?void 0:_.entityTypeName),M=o(c,p,h),D=Object(u.lb)(c,p,s),R=Object(u.Eb)(c,p.id),B=Object(u.nb)(c,p.id,s),V=Object(Wt.l)(c,p.id,s,w,D),z=r(c,p,V,_&&_.bodyOnly,M),G=Object(vr.a)(c),W=b.sizes.Breakpoints.DimensionXL,H=null==_?void 0:_.recordSetQueryKey,U=Object(L.a)(c),q=Object(L.e)(c),K=Object(d.e)(c,p,s),Y=n(c,{id:p.id,contextToken:s}),Z=i(c,{id:p.id,contextToken:s}),J=Object(u.dc)(c,_,p.id,s),$=Object(Sr.b)(c),ee=Object(Or.a)(c),te=Object(Cr.l)(c,null==_?void 0:_.entityTypeName),re=Object(u.Lb)(c,null==_?void 0:_.entityTypeName,null==_?void 0:_.id),ne=Object(Ir.h)(c,null==_?void 0:_.entityTypeName,X.a.toString(j),Nr.a.WriteAccess),ie=Object(Ir.g)(c,null==_?void 0:_.entityTypeName,3,0),ae=!R&&!Object(u.ib)(c,p.id)&&Object(u.jb)(c,p.id),oe=Object(ye.g)(c),se=Object(u.o)(c,p.id,h),ce=Object(u.Bb)(c,p.id,s),le=Object(wr.a)(c,p.id),ue=Object(Ot.a)(c)===St.a.MultiSession,de=Object(kr.a)(c),pe=!1;de&&de.length>0&&(pe=Object(u.Q)(c)!==p.id);var he=[];C&&(g=Object(xe.p)(c,C.Id),he=a(c,C));var ge,me=null;if(K&&_&&_.bodyOnly){var fe=Object(v.a)(h,K.relationshipName,K.ordinal);me=Object(Fr.nb)(p.id,X.a.toString(Object(Fr.T)(c,p.id,fe)))}k&&H&&(ge=Object(Q.q)(c,H,1,[k.PrimaryNameAttribute],!0));var be=ge&&ge.length>0?ge.length:0,ve=Object(Wt.f)(c,p.id,h),_e=Object(Ar.a)(c,p.id,h),Se=Object(u.n)(c);return{hasActiveDialogOnTop:pe,rootElementId:m,descriptor:C,selectedTab:I,currentEntityId:j,isFormValid:T,formNotificationIds:w,containerStyle:z.containerStyle,formMainSectionStyle:z.formMainSectionStyle,formGeneralStyle:z.formGeneralStyle,formButtonWrapper:z.formButtonWrapper,formButtonStyle:z.formButtonStyle,tabHeaderBodyContainerStyle:z.tabHeaderBodyContainerStyle,tabCustomStyle:z.tabCustomStyle,tabGeneralStyle:z.tabGeneralStyle,formButtonIconStyle:z.formButtonIconStyle,formCloseViewStyle:z.formCloseViewStyle,formCloseStyle:z.formCloseStyle,saveButtonStyle:z.saveButtonStyle,formCloseIconStyle:z.formCloseIconStyle,temporaryButtonContainerStyle:z.temporaryButtonContainerStyle,recordSetNavigationContainerStyle:z.recordSetNavigationContainerStyle,mainContentStyle:z.mainContentStyle,overlayStyle:z.overlayStyle,overlayTextStyle:z.overlayTextStyle,commandManagerContainerStyle:z.commandManagerContainerStyle,commandManagerStyle:z.commandManagerStyle,commandBarStyle:z.commandBarStyle,collapseExpandButtonStyle:z.collapseExpandButtonStyle,collapseExpandButtonTextStyle:z.collapseExpandButtonTextStyle,collapseExpandButtonWrapperStyle:z.collapseExpandButtonWrapperStyle,commandBarPlaceholdStyle:z.commandBarPlaceholdStyle,bpfPlaceholdStyle:z.bpfPlaceholdStyle,tabNavPlaceholdStyle:z.tabNavPlaceholdStyle,tabPlaceholdStyle:z.tabPlaceholdStyle,mainSectionPlaceholdStyle:z.mainSectionPlaceholdStyle,legendPlaceholdContainerStyle:z.legendPlaceholdContainerStyle,legendPlaceholdStyle:z.legendPlaceholdStyle,sectionContainerPlaceholdStyle:z.sectionContainerPlaceholdStyle,rowPlaceholdContainerStyle:z.rowPlaceholdContainerStyle,rowPlaceholdStyle:z.rowPlaceholdStyle,sectionColumn1PlaceholdStyle:z.sectionColumn1PlaceholdStyle,sectionColumn2PlaceholdStyle:z.sectionColumn2PlaceholdStyle,columnStyle:z.columnStyle,sectionStyle:z.sectionStyle,cellStyle:z.cellStyle,resourceStrings:N,viewPortWidth:A,entityDescriptor:k,pageInput:_,formId:C&&C.Id?C.Id:null,showLoadingIndicator:P===Pe.a.Initial||P===Pe.a.Loading,XLBreakPoint:b.sizes.Breakpoints.DimensionXL,largeBreakPoint:b.sizes.Breakpoints.DimensionL,mediumBreakPoint:b.sizes.Breakpoints.DimensionM,smallBreakPoint:b.sizes.Breakpoints.DimensionS,headerSpacerStyle:z.headerSpacerStyle,headerSpacerHeightInPx:z.headerSpacerHeightInPx,headerCollapsedHeightInPx:z.headerCollapsedHeightInPx,headerContainerStyle:z.headerContainerStyle,recordSetNavigatorCollapsed:G,recordSetNavBreakPoint:W,numberOfAvailableRecords:be,clientHost:U,clientHostSubtype:q,tabPlaceholdRowHeightEm:b.sizes.EditForm.TabPlaceholdRowHeightEm,primaryControlDomId:J,selectedRelatedEntity:K,hasHeaderFields:Y&&Y.length>0,hasFooterFields:Z&&Z.length>0,contextToken:s,headerShadowStyle:z.headerShadowStyle,headerShadowV2Style:z.headerShadowV2Style,serverIsAvailable:$,isMocaOfflineEnabled:ee,isEntityAvailableForOffline:te,isRecordStatusInactive:re,isEditableForSharedRecord:ne,hasWriteRolePrivilege:ie,showSavingIndicator:ae,isRTL:oe,bpfControlRendered:se,hasCmdbar:ce,multiSessionEnabled:ue,viewSelectorDOMId:me,theme:b,availableTabs:he,isFooterAvailableForPhone:g,isMainFormDialog:E,output:le,tabBackButtonStyle:z.tabBackButtonStyle,enabledFormFCBs:M,shouldFormNotificationBarRender:V,mainSectionId:xt.c+p.id,isInMobileNative:Object(Xt.b)(c),isInMobileNativeApr2020:Object(Xt.a)(c),isFormComponentInstance:R,showHeaderBody:null==ve?void 0:ve.bodyVisible,showCommandBar:null==ve?void 0:ve.commandBarVisible,showTabNavigator:null==ve?void 0:ve.tabNavigatorVisible,showFooter:null==_e?void 0:_e.visible,formScrollAndFocusState:B,bpfDisabled:Se}}}),(function(e,t){return{updateFormViewPortSizes:function(r,n,i){e(Object(_r.b)(t.id,r,n,i))},clearFormNotification:function(r,n){e(Object(jr.b)(r,t.id,n))},saveAndCloseForm:function(){e(Object(Er.a)(t.id))},saveForm:function(r){X.a.isNullOrEmpty(null==r?void 0:r.id)?e(Object(Pr.f)(t.id,_t.a,!0,1,!1,!0)):e(Object(Pr.e)(t.id,1))},cancelForm:function(r,n){e(Object(Tr.a)(t.id,n))},setFormScrollAndFocusState:function(t,r,n){e(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,r){var n=Object(v.v)(t),i=r;return{type:Dr.e,payload:i,meta:{pageId:e,contextKey:n}}}(t,r,n))},setFocus:function(t,r,n){e(Object(Mr.a)(t,r,n))}}}))(pr)},BWVO:function(e,t,r){"use strict";r.d(t,"a",(function(){return Me})),r.d(t,"b",(function(){return De}));var n,i,a,o,s,c,l,u,d,p=r("1z64"),h=r("9r0m"),g=r("9rlF"),m=r("QAhb"),f=r("ezfI"),b=r("F2uj"),y=r("iutC"),v=r("yHpA"),_=r("FuJ2"),S=r("o0+l"),O=r("HSdq"),C=r("5jMY"),I=r("Zy0S"),j=r("ObKm"),P=r("w/nD"),F=r("+Z9T"),T=r("IiPO"),w=r("Sscr"),E=r("lMVv"),x=r("zsi3"),N=r("xirW"),A=r("hCnb"),k=r("2p2B"),M=r("uQP8"),D=r("r0s4"),R=r("Srej"),B="ClientApi.XrmEntityAttribute.",L=function(){function e(e,t,r,i,a,o){n=e,this._clientApiExecutorAttribute=new p.a(e,B,r,t),this._clientApiExecutorAttribute.addEventParameter({name:"attributeName",value:i,isEventParam:!0});var s=this._clientApiExecutorAttribute.getComponentName("constructor");i||Object(F.j)(s,"attributeName"),e||Object(F.j)(s,"store"),r||Object(F.j)(s,"pageId"),t||Object(F.j)(s,"contextToken"),o||Object(F.j)(s,"xrmFormUi"),this._attributeName=i,this._parentEntity=a,this._pageId=r,this.xrmFormUi=o,this._contextToken=t}return Object.defineProperty(e.prototype,"controls",{get:function(){var e=this;return this._clientApiExecutorAttribute.execute("controls",(function(t,r){if(!e._controls){e._controls=new I.a(t);var i=Object(O.z)(n.getState(),e._pageId,e.contextToken,e._attributeName);if(i){e.xrmFormUi.getControls();for(var a=e.xrmFormUi.controls,o=0;o<i.length;o++){var s=i[o],c=a.get(s);c&&e._controls.add(s,c)}}}return e._controls}))},enumerable:!1,configurable:!0}),e.prototype.addOnChange=function(e){var t=B+"addOnChange";e||Object(F.j)(t,"handler");try{f.a.instance.reportCall(t),n.dispatch(Object(P.a)(this.contextToken,this._pageId,this.getName(),e)),f.a.instance.reportSuccess(t)}catch(e){var r=T.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),T.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.fireOnChange=function(){var e=B+"fireOnChange";try{f.a.instance.reportCall(e),n.dispatch(Object(P.P)(this.contextToken,this._pageId,this.getName())),f.a.instance.reportSuccess(e)}catch(r){var t=T.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"attributeName",value:this._attributeName}),T.a.getInstance().reportFailure(e,r,null,t),r}},e.prototype.getAttributeType=function(){var e=B+"getAttributeType";try{f.a.instance.reportCall(e);var t=this.getAttrDescriptor().Type;return f.a.instance.reportSuccess(e),t}catch(t){var r=T.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),T.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getFormat=function(){var e=this;return this._clientApiExecutorAttribute.execute("getFormat",(function(){var t=e.getAttrDescriptor();if(!t||!t.Format)return null;var r=t.Format.toLowerCase(),n=r;switch(e.getAttrDescriptor().Type){case"string":"text"===n||"email"===n||"phone"===n||"url"===n||"tickersymbol"===n||"1"!==r&&"2"!==r||(n="textarea");break;case"integer":"duration"!==n&&(n="none");break;case"lookup":"0"===r&&(n="none");break;case"memo":"2"!==r&&"1"!==r||(n="textarea");break;default:"0"===r?n="none":void 0===n&&(n=null)}return n}))},e.prototype.getIsDirty=function(){var e=B+"getIsDirty";try{f.a.instance.reportCall(e);var t=Object(O.Jb)(n.getState(),this.getPageId(),this.dataContextToken,this.getName())&&Object(v.e)(n.getState(),Object(O.ac)(n.getState(),this.getPageId(),this.dataContextToken),this.getName());return f.a.instance.reportSuccess(e),t}catch(t){var r=T.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),T.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getName=function(){return f.a.instance.reportUsage(B+"getName"),this._attributeName},e.prototype.getParent=function(){return f.a.instance.reportUsage(B+"getParent"),this._parentEntity},e.prototype.getRequiredLevel=function(){var e=B+"getRequiredLevel";try{f.a.instance.reportCall(e);var t=Object(O.pc)(n.getState(),this._pageId,this.dataContextToken,this.getName()),r=void 0;switch(t){case 2:case 1:r="required";break;case-1:case 0:r="none";break;case 3:r="recommended";break;default:Object(F.h)(e,"RequiredLevel",t)}return f.a.instance.reportSuccess(e),r}catch(t){var i=T.a.getInstance().getEventParameters(this._contextToken);throw i.push({name:"attributeName",value:this._attributeName}),T.a.getInstance().reportFailure(e,t,null,i),t}},e.prototype.getSubmitMode=function(){var e=B+"getSubmitMode";try{f.a.instance.reportCall(e);var t=Object(O.zc)(n.getState(),this._pageId,this.contextToken,this.getName()),r=void 0;switch(t){case C.a.Dirty:r="dirty";break;case C.a.Always:r="always";break;case C.a.Never:r="never";break;default:Object(F.h)(e,"SubmitMode",t)}return f.a.instance.reportSuccess(e),r}catch(t){var i=T.a.getInstance().getEventParameters(this._contextToken);throw i.push({name:"attributeName",value:this._attributeName}),T.a.getInstance().reportFailure(e,t,null,i),t}},e.prototype.getUserPrivilege=function(){var e=B+"getUserPrivilege";try{f.a.instance.reportCall(e);var t=null;if(n.getState()&&this._parentEntity&&this._attributeName){var r=Object(y.a)(n.getState(),this._parentEntity.getEntityName(),h.a.fromExternalGuid(this._parentEntity.getId()),this._attributeName);r&&(t={canCreate:r.canCreate,canRead:r.canRead,canUpdate:r.canUpdate})}return f.a.instance.reportSuccess(e),t}catch(t){var i=T.a.getInstance().getEventParameters(this._contextToken);throw i.push({name:"attributeName",value:this._attributeName}),T.a.getInstance().reportFailure(e,t,null,i),t}},e.prototype.getValue=function(){var e=B+"getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=null;return Object(F.a)(t)||(Object(g.j)(t)?r=t.value:Object(F.k)(e,"isPlainValue","value")),f.a.instance.reportSuccess(e),r}catch(t){var n=T.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),T.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.removeOnChange=function(e){var t=B+"removeOnChange";e||Object(F.j)(t,"handler");try{f.a.instance.reportCall(t),n.dispatch(Object(P.v)(this.contextToken,this._pageId,this.getName(),e)),f.a.instance.reportSuccess(t)}catch(e){var r=T.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),T.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.setRequiredLevel=function(e){var t=B+"setRequiredLevel";e||Object(F.j)(t,"requiredLevel"),"none"!==e&&"recommended"!==e&&"required"!==e&&Object(F.h)(t,"RequiredLevel",e);try{f.a.instance.reportCall(t);var r=void 0;switch(e){case"none":r=0;break;case"recommended":r=3;break;case"required":r=2}n.dispatch(Object(_.b)(this._pageId,this.dataContextToken,this._attributeName,r)),f.a.instance.reportSuccess(t)}catch(e){var i=T.a.getInstance().getEventParameters(this._contextToken);throw i.push({name:"attributeName",value:this._attributeName}),T.a.getInstance().reportFailure(t,e,null,i),e}},e.prototype.setSubmitMode=function(e){var t=B+"setSubmitMode";e||Object(F.j)(t,"mode"),"dirty"!==e&&"always"!==e&&"never"!==e&&Object(F.h)(t,"SubmitMode",e);try{f.a.instance.reportCall(t);var r=void 0;switch(e){case"dirty":r=C.a.Dirty;break;case"always":r=C.a.Always;break;case"never":r=C.a.Never}n.dispatch(Object(S.b)(this._pageId,this.contextToken,this.getName(),r)),f.a.instance.reportSuccess(t)}catch(e){var i=T.a.getInstance().getEventParameters(this._contextToken);throw i.push({name:"attributeName",value:this._attributeName}),T.a.getInstance().reportFailure(t,e,null,i),e}},e.prototype.setValue=function(e){var t=B+"setValue";try{f.a.instance.reportCall(t),this.setValueInternal(e),f.a.instance.reportSuccess(t)}catch(e){var r=T.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),T.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.setIsValid=function(e,t){var r=this;return this._clientApiExecutorAttribute.execute("setIsValid",(function(i,a){e?(n.dispatch(Object(A.b)(r._pageId,r._attributeName,!0,r.contextToken)),n.dispatch(Object(k.b)(r.contextToken,r._pageId,Object(R.d)(r._pageId,r._attributeName))),n.dispatch(Object(N.b)(n.getState(),r._pageId,r._attributeName,null,r.contextToken))):r._addNotification(t)}))},e.prototype._addNotification=function(e){n.dispatch(Object(A.b)(this._pageId,this._attributeName,!1,this.contextToken));var t={messages:[e],notificationLevel:x.a.error};n.dispatch(Object(N.b)(n.getState(),this._pageId,this._attributeName,t,this.contextToken))},e.prototype.isValid=function(){var e=B+"isValid";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=this.getParent();if(r){var i=Object(E.h)(n.getState(),r.getEntityName());if(i&&i.PrimaryIdAttribute!==this.getName()&&r.getId()!==h.a.EMPTYSTRING&&"required"===this.getRequiredLevel()&&Object(F.a)(t))return f.a.instance.reportSuccess(e),!1}var a=!0;return this.hasErrorNotification()?a=!1:t&&t.validationResult&&(a=t.validationResult.isValueValid),f.a.instance.reportSuccess(e),a}catch(t){var o=T.a.getInstance().getEventParameters(this._contextToken);throw o.push({name:"attributeName",value:this._attributeName}),T.a.getInstance().reportFailure(e,t,null,o),t}},e.prototype.hasErrorNotification=function(){var e=Object(w.v)(this.contextToken),t=n.getState(),r=Object(M.a)(t,this._pageId);return!(!r.forms||!r.forms[e]||!r.forms[e].invalidControls&&!r.forms[e].invalidAttributes)&&(!0===r.forms[e].invalidControls[this.getName()]||!0===r.forms[e].invalidAttributes[this.getName()])},e.prototype.getPageId=function(){return this._pageId},e.prototype.getAttrDescriptor=function(){if(this.getParent()){var e=Object(O.r)(n.getState(),this.getParent().getEntityName(),this.getName(),this._pageId,this.contextToken);return e||(e=Object(b.a)(n.getState(),this.getParent().getEntityName(),this.getName())),e}return Object(O.Nc)(n.getState(),this.getPageId(),this.getName())},e.prototype.getDataXmlInternal=function(){var e="";return e=e+"<"+Object(D.CrmXmlEncode)(this.getName())+">"+Object(D.CrmXmlEncode)(this.getValue())+"</"+Object(D.CrmXmlEncode)(this.getName())+">"},e.prototype.setValueInternal=function(e){var t=this.getName(),r={};r[t]={fieldName:t,value:e},n.dispatch(Object(j.a)(this._pageId,r,!1,!0,this.getParent()?this.getParent().getEntityName():null,this.getParent()?this.getParent().getId():null,Object(w.t)(this._contextToken),this.contextToken))},Object.defineProperty(e.prototype,"parentEntityReference",{get:function(){var e,t;return this.getParent()?(e=this.getParent().getEntityName(),t=this.getParent().getId()):this.contextToken.formId&&(e=this.contextToken.formId.guid),t?new m.a(e,new h.a(t)):new m.a(e)},enumerable:!1,configurable:!0}),e.prototype.getValueInternal=function(){var e=Object(O.ac)(n.getState(),this.getPageId(),this.dataContextToken);return Object(O.X)(n.getState(),this._pageId,this._contextToken,e,this.parentEntityReference,this._attributeName,n.dispatch)},Object.defineProperty(e.prototype,"contextToken",{get:function(){return Object(w.r)(this._contextToken)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataContextToken",{get:function(){return this._contextToken},enumerable:!1,configurable:!0}),e}(),V=r("c/eZ"),z=r("TCcM"),G=r("TV33"),W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(V.__extends)(t,e),t.prototype.getOption=function(e){var t="ClientApi.XrmEntityAttributeOptionSetBase.getOption";if(Object(F.a)(e))return null;var r="number"==typeof e?e:parseInt(e,10);isNaN(r)&&Object(F.k)(t,"number","value");try{f.a.instance.reportCall(t);for(var n=this.getAttrDescriptor().OptionSet,i=null,a=0;a<n.length;a++)n[a].Value===e&&(i={text:n[a].Label,value:n[a].Value});return f.a.instance.reportSuccess(t),i}catch(e){throw T.a.getInstance().getEventParameters(this.contextToken).push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(t,e),e}},t.prototype.getOptions=function(){var e="ClientApi.XrmEntityAttributeOptionSetBase.getOptions";try{f.a.instance.reportCall(e);var t=this.getAttrDescriptor().OptionSet.map((function(e){return{text:e.Label,value:e.Value}}));return f.a.instance.reportSuccess(e),t}catch(t){throw T.a.getInstance().getEventParameters(this.contextToken).push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(e,t),t}},t}(L),H=function(e){function t(t,r,n,a,o,s){var c=e.call(this,t,r,n,a,o,s)||this;return i=t,c}return Object(V.__extends)(t,e),t.prototype.getInitialValue=function(){var e="ClientApi.XrmEntityAttributeBoolean.getInitialValue";try{f.a.instance.reportCall(e);var t=Object(z.j)(i.getState(),this.parentEntityReference,this.getName()),r=t?parseInt(t.valueString,10):null;return f.a.instance.reportSuccess(e),r}catch(t){var n=T.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeBoolean.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(G.a)(t);return f.a.instance.reportSuccess(e),r}catch(t){var n=T.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeBoolean.setValue";Object(F.a)(e)||"boolean"!=typeof e&&Object(F.k)(t,"boolean","value");try{f.a.instance.reportCall(t),this.setValueInternal(e),f.a.instance.reportSuccess(t)}catch(e){var r=T.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeBoolean.getAttributeType"),"boolean"},t}(W),U=function(e){function t(t,r,n,i,o,s){var c=e.call(this,t,r,n,i,o,s)||this;return a=t,c}return Object(V.__extends)(t,e),t.prototype.getInitialValue=function(){var e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getInitialValue";try{f.a.instance.reportCall(e);var t=Object(z.j)(a.getState(),this.parentEntityReference,this.getName()),r=Object(G.e)(t);return f.a.instance.reportSuccess(e),r}catch(t){var n=T.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getSelectedOption=function(){var e=this,t="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getSelectedOption";try{f.a.instance.reportCall(t);var r=null,n=this.getValue();return n&&(r=[],n.forEach((function(t){var n=e.getOption(t);n&&r.push(n)}))),f.a.instance.reportSuccess(t),r}catch(e){var i=T.a.getInstance().getEventParameters(this.contextToken);throw i.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(t,e,null,i),e}},t.prototype.getText=function(){var e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getText";try{f.a.instance.reportCall(e);var t=null,r=this.getSelectedOption();return r&&(t=[],r.forEach((function(e){t.push(e.text)}))),f.a.instance.reportSuccess(e),t}catch(t){var n=T.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=null;return t&&(r=Object(G.e)(t)),f.a.instance.reportSuccess(e),r}catch(t){var n=T.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeMultiSelectOptionSet.getAttributeType"),"multiselectoptionset"},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeMultiSelectOptionSet.setValue";try{f.a.instance.reportCall(t),Array.isArray(e)?this.setValueInternal(e):this.setValueInternal([]),f.a.instance.reportSuccess(t)}catch(e){var r=T.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(t,e,null,r),e}},t}(W),q=r("otJc"),X=r("dl9j"),K=r("+h4s"),Q=r("sRkF"),Y=function(e){function t(t,r,n,i,a,s){var c=e.call(this,t,r,n,i,a,s)||this;return o=t,c}return Object(V.__extends)(t,e),t.prototype.getDataXmlInternal=function(){var e=this.getValue();null!==e&&(e=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes()));var t=Object(D.CrmXmlEncode)(this.getName()),r="";return r+="<"+t+">",r+=""+(null===e?"":Object(D.CrmXmlEncode)(e.format("s"))),r+="</"+t+">"},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeDateTime.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=null;if(Object(g.j)(t)&&!Object(F.a)(t.formatted)){var n=this.getAttrDescriptor();r=Object(G.b)(o.getState(),n,t)}return f.a.instance.reportSuccess(e),r}catch(t){var i=T.a.getInstance().getEventParameters(this.contextToken);throw i.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(e,t,null,i),t}},t.prototype._userSettings=function(){return this.xrmFormUi.formContext.context?this.xrmFormUi.formContext.context.userSettings:new X.a(o)},t.prototype.getUtcValue=function(){var e="ClientApi.XrmEntityAttributeDateTime.getUtcValue";try{f.a.instance.reportCall(e);var t=this.getValue();return f.a.instance.reportSuccess(e),t}catch(t){var r=T.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeDateTime.setValue";Object(F.a)(e)||"[object Date]"!==Object.prototype.toString.call(e)&&Object(F.k)(t,"Date","value");try{if(f.a.instance.reportCall(t),Object(F.a)(e))this.setValueInternal(e);else if("[object Date]"===Object.prototype.toString.call(e)){var r=new Date,n=this.getAttrDescriptor(),i=Object(q.z)(o.getState(),n),a=6e4*this._userSettings().getTimeZoneOffsetMinutes(),s=Object(K.o)(new Date(r.getFullYear(),r.getMonth(),r.getDate()),i.userSettings.timeZoneAdjusters)-Object(K.o)(e,i.userSettings.timeZoneAdjusters),c=6e4*e.getTimezoneOffset(),l=null;switch(i.controlAttributes.Behavior){case Q.a.UserLocal:l=new Date(e.getTime()+c+a-s);break;default:l=new Date(e.getTime())}this.setValueInternal(l)}f.a.instance.reportSuccess(t)}catch(e){var u=T.a.getInstance().getEventParameters(this.contextToken);throw u.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(t,e,null,u),e}},t.prototype.setUtcValue=function(e){var t="ClientApi.XrmEntityAttributeDateTime.setUtcValue";try{f.a.instance.reportCall(t),this.setValue(e),f.a.instance.reportSuccess(t)}catch(e){var r=T.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeDateTime.getAttributeType"),"datetime"},t}(L),Z=function(e){function t(t,r,n,i,a,o){var c=e.call(this,t,r,n,i,a,o)||this;return s=t,c}return Object(V.__extends)(t,e),t.prototype.getIsPartyList=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeLookup.getIsPartyList"),!1},t.prototype.getDataXmlInternal=function(){var e=this.getValue(),t="";if(null!==e&&e.length>0)t+=this.getLookupDataXml(this.getName(),e[0]);else{var r=Object(D.CrmXmlEncode)(this.getName());t+="<"+r+">",t+="</"+r+">"}return t.toString()},t.prototype.getLookupDataXml=function(e,t){var r=Object(D.CrmXmlEncode)(e),n="<"+r,i=this.getEntityTypeCode(t.entityType);return i>0&&(n+=' type="'+Object(D.CrmXmlAttributeEncode)(i.toString())+'"'),t.entityType&&(n+=' typeName="'+Object(D.CrmXmlAttributeEncode)(t.entityType)+'"'),Object(F.a)(t.name)||(n+=' name="'+Object(D.CrmXmlAttributeEncode)(t.name)+'"'),n+=">"+Object(D.CrmXmlEncode)(t.id)+"</"+r+">"},t.prototype.getEntityTypeCode=function(e){return Object(E.p)(s.getState(),e)},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeLookup.setValue",r=null;if(e&&Array.isArray(e)&&e.length>0){e.length>1?Object(F.k)(t,"LookupValue[] of size not more than one.","value"):e[0].entityType?e[0].id?h.a.tryParseOrNull(e[0].id)||Object(F.h)(t,"guid",e[0].id):Object(F.j)(t,"value[0].id"):Object(F.j)(t,"value[0].entityType");var n=void 0;try{n=Object(O.Ob)(s.getState(),this.getPageId(),this.dataContextToken,this.getName())}catch(e){throw(i=T.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(t+".getLookupTargets",e,null,i),e}if(n)if(!(n.indexOf(e[0].entityType)>-1))(i=T.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),i.push({name:"actualValue",value:e[0].entityType}),Object(F.k)(t,"entityType","value[0].entityType",i);try{f.a.instance.reportCall(t),n?n.indexOf(e[0].entityType)>-1&&(r=new m.a(e[0].entityType,new h.a(e[0].id),e[0].name),this.setValueInternal(r)):this.setValueInternal(r),f.a.instance.reportSuccess(t)}catch(e){var i;throw(i=T.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(t,e,null,i),e}}else this.setValueInternal(r)},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeLookup.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(G.d)(t);return f.a.instance.reportSuccess(e),r}catch(t){var n=T.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeLookup.getAttributeType"),"lookup"},t}(L),J=r("/wtJ"),$=r("kvLG"),ee=function(e){function t(t,r,n,i,a,o){var s=e.call(this,t,r,n,i,a,o)||this;return c=t,s._clientApiExecutorAttributeNumber=new p.a(t,"ClientApi.XrmEntityAttributeNumber.",n,r,[{name:"attributeName",value:i,isEventParam:!0}]),s}return Object(V.__extends)(t,e),t.prototype.getMax=function(){var e=this;return this._clientApiExecutorAttributeNumber.execute("getMax",(function(){return e.getAttrDescriptor().MaxValue}))},t.prototype.getMin=function(){var e=this;return this._clientApiExecutorAttributeNumber.execute("getMin",(function(){return e.getAttrDescriptor().MinValue}))},t.prototype.getPrecision=function(){var e=this;return this._clientApiExecutorAttributeNumber.execute("getPrecision",(function(){return Object(O.k)(c.getState(),e.getPageId(),e.dataContextToken,e.getName())}))},t.prototype.setPrecision=function(e){var t=this;return this._clientApiExecutorAttributeNumber.execute("setPrecision",(function(r,n){"integer"===t.getAttributeType()&&Object(F.e)(r,"setPrecision is not valid on integer attributes",void 0,n);var i=Object(b.a)(c.getState(),t.getParent().getEntityName(),t.getName());(e<0||e>i.Precision)&&(n.push({name:"metadataPrecision",value:i.Precision}),Object(F.h)(r,"precision",e.toString(),n)),c.dispatch(Object(J.b)(t.getPageId(),t.dataContextToken,t.getName(),e))}),[{name:"precision",value:e,isRequired:!0,expectedDataType:"number"}])},t.prototype.getValue=function(){var e=this;return this._clientApiExecutorAttributeNumber.execute("getValue",(function(){var t=e.getValueInternal();return Object(G.f)(t,e.getAttributeType(),e.getPrecision())}))},t.prototype.setValue=function(e){var t=this;return this._clientApiExecutorAttributeNumber.execute("setValue",(function(){t.setValueInternal(e)}),[{name:"value",value:e,expectedDataType:"number"}])},t.prototype.getAttributeType=function(){var t=this;return this._clientApiExecutorAttributeNumber.execute("getAttributeType",(function(r,n){var i=t.getAttrDescriptor().Type;switch(i){case"decimal":return"decimal";case"double":return"double";case"integer":return"integer";case"money":return"money";default:return n.push({name:"attributeType",value:i}),i?t._clientApiExecutorAttributeNumber.reportFailure(r,new Error("Unexpected number attribute type."),n):$.a.getInstance().traceManager.getTracer(r).error("Number attribute type was not defined in metadata.",n),e.prototype.getAttributeType.call(t)}}))},t}(L),te=r("sOTk"),re=function(e){function t(t,r,n,i,a,o){var s=e.call(this,t,r,n,i,a,o)||this;return l=t,s}return Object(V.__extends)(t,e),t.prototype.getInitialValue=function(){var e="ClientApi.XrmEntityAttributeOptionSet.getInitialValue";try{f.a.instance.reportCall(e);var t=Object(z.j)(l.getState(),this.parentEntityReference,this.getName()),r=Object(te.m)(l.getState(),this.getPageId()),n=void 0;if(r){var i=this.getAttrDescriptor();n=Object(G.g)(t)||i&&i.DefaultFormValue?i.DefaultFormValue:null}else n=Object(G.g)(t);return f.a.instance.reportSuccess(e),n}catch(t){var a=T.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(e,t,null,a),t}},t.prototype.getSelectedOption=function(){var e="ClientApi.XrmEntityAttributeOptionSet.getSelectedOption";try{f.a.instance.reportCall(e);var t=this.getOption(this.getValue());return f.a.instance.reportSuccess(e),t}catch(t){var r=T.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getText=function(){var e="ClientApi.XrmEntityAttributeOptionSet.getText";try{f.a.instance.reportCall(e);var t=this.getSelectedOption(),r=null;return t&&(r=t.text),f.a.instance.reportSuccess(e),r}catch(t){var n=T.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeOptionSet.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(G.g)(t),n=Object(F.a)(r)?Object(G.f)(t,this.getAttributeType(),0):r;return f.a.instance.reportSuccess(e),n}catch(t){var i=T.a.getInstance().getEventParameters(this.contextToken);throw i.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(e,t,null,i),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeOptionSet.setValue";e&&isNaN(e)&&Object(F.k)(t,"number","value");var r=!1;try{if(e&&this.getParent()){var n=this.getAttrDescriptor();for(var i in n.OptionSet)if(e===n.OptionSet[i].Value){r=!0;break}}else r=!0}catch(e){throw(a=T.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(t+".getAttributeDescriptor",e,null,a),e}r||Object(F.h)(t,"OptionSetValue",e);try{f.a.instance.reportCall(t),this.setValueInternal(e),f.a.instance.reportSuccess(t)}catch(e){var a;throw(a=T.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(t,e,null,a),e}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeOptionSet.getAttributeType"),"optionset"},t}(W),ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(V.__extends)(t,e),t.prototype.getMaxLength=function(){var e="ClientApi.XrmEntityAttributeString.getMaxLength";try{f.a.instance.reportCall(e);var t=this.getAttrDescriptor().MaxLength;return f.a.instance.reportSuccess(e),t}catch(t){var r=T.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeString.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(G.i)(t);return f.a.instance.reportSuccess(e),r}catch(t){var n=T.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeString.setValue";Object(F.a)(e)||"string"!=typeof e&&Object(F.k)(t,"string","value");try{f.a.instance.reportCall(t),this.setValueInternal(e),f.a.instance.reportSuccess(t)}catch(e){var r=T.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getAttributeType=function(){var t="ClientApi.XrmEntityAttributeString.getAttributeType";try{f.a.instance.reportCall(t);var r=void 0,n=this.getAttrDescriptor().Type;switch(n){case"memo":r="memo";break;case"string":r="string";break;default:(i=T.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),i.push({name:"attributeType",value:n}),T.a.getInstance().reportFailure(t,new Error("Unexpected string attribute type."),null,i),r=e.prototype.getAttributeType.call(this)}return f.a.instance.reportSuccess(t),r}catch(e){var i;throw(i=T.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(t,e,null,i),e}},t}(L),ie=function(e){function t(t,r,n,i,a,o){var s=e.call(this,t,r,n,i,a,o)||this;return s._clientApiExecutor=new p.a(t,"ClientApi.XrmEntityAttributeUniqueIdentifier.",n,r),s._clientApiExecutor.addEventParameter({name:"attributeName",value:i,isEventParam:!0}),s}return Object(V.__extends)(t,e),t.prototype.setValue=function(e){var t=this;this._clientApiExecutor.execute("setValue",(function(){t.setValueInternal(h.a.tryParseOrNull(e))}),[{name:"value",value:e,expectedDataType:"guid"}])},t.prototype.getValue=function(){var e=this;return this._clientApiExecutor.execute("getValue",(function(){var t=e.getValueInternal();return Object(G.j)(t)}))},t.prototype.getAttributeType=function(){return this._clientApiExecutor.execute("getAttributeType",(function(){return"string"}))},t}(L),ae=r("nVTU"),oe=function(e){function t(t,r,n,i,a,o){var s=e.call(this,t,r,n,i,a,o)||this;return u=t,s}return Object(V.__extends)(t,e),t.prototype.getDataXmlInternal=function(){var e=this,t=Object(D.CrmXmlEncode)(this.getName()),r=this.getValue(),n="";return n+="<"+t+">",r.forEach((function(t){n+="<activityparty>",n+=e.getLookupDataXml("partyid",t),n+="</activityparty>"})),(n+="</"+t+">").toString()},t.prototype.setValue=function(e){var t,r="ClientApi.XrmEntityAttributePartyList.setValue",n=T.a.getInstance().getEventParameters(this.contextToken);n.push({name:"attributeName",value:this.getName()}),e&&(Array.isArray(e)||Object(F.k)(r,"LookupValue[]","value",n));var i=new Array;try{t=Object(O.Ob)(u.getState(),this.getPageId(),this.dataContextToken,this.getName())}catch(e){throw T.a.getInstance().reportFailure(r+".getLookupTargets",e,null,n),e}e&&t&&(t.push("unresolvedaddress"),e.forEach((function(e){t.indexOf(e.entityType)>-1||(n.push({name:"entityType",value:e.entityType}),Object(F.e)(r,'LookupValue[] with invalid entity type. Entity type "'+e.entityType+'" is invalid.',"LookupValue[] with invalid entity type",n))})));try{f.a.instance.reportCall(r),e?(t?e.forEach((function(e){t.indexOf(e.entityType)>-1&&i.push(new ae.a(e.entityType,e.id,e.name))})):e.forEach((function(e){i.push(new ae.a(e.entityType,e.id,e.name))})),this.setValueInternal(i)):this.setValueInternal([]),f.a.instance.reportSuccess(r)}catch(e){throw T.a.getInstance().reportFailure(r,e,null,n),e}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributePartyList.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(G.h)(t);return f.a.instance.reportSuccess(e),r}catch(t){var n=T.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getIsPartyList=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributePartyList.getIsPartyList"),!0},t}(Z),se=function(e){function t(t,r,n,i,a,o){var s=e.call(this,t,r,n,i,a,o)||this;return s._clientApiExecutorAttributeFile=new p.a(t,"ClientApi.XrmEntityFile.",n,r,[{name:"attributeName",value:i,isEventParam:!0}]),s}return Object(V.__extends)(t,e),t.prototype.getValue=function(){var e=this;return this._clientApiExecutorAttributeFile.execute("getValue",(function(){var t=e.getValueInternal();return Object(G.c)(t)}))},t.prototype.setValue=function(e){var t=this;this._clientApiExecutorAttributeFile.execute("setValue",(function(){t.setValueInternal(e)}))},t}(L),ce=function(e){function t(t,r,n,i,a,o){var s=e.call(this,t,r,n,i,a,o)||this;return d=t,s}return Object(V.__extends)(t,e),t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeEntityName.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(b.a)(d.getState(),this.getParent().getEntityName(),this.getName()),n=null;return r.IsEntityReferenceStored&&Object(g.j)(t)&&(n=t.value),f.a.instance.reportSuccess(e),n}catch(t){var i=T.a.getInstance().getEventParameters(this.contextToken);throw i.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(e,t,null,i),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeEntityName.setvalue";Object(F.a)(e)||"string"==typeof e||Object(F.k)(t,"string","value");try{f.a.instance.reportCall(t),this.setValueInternal(e),f.a.instance.reportSuccess(t)}catch(e){var r=T.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeEntityName.getAttributeType"),"entityname"},t}(L),le=r("r529"),ue=r("Xia5"),de=r("jJRu"),pe=r("Cfob"),he=r("cAHA"),ge=r("8aRo"),me=r("+P1Q"),fe=r("qYad"),be=r("9qYn"),ye=r("yZTI"),ve=r("Z1aD"),_e=r("xc1f"),Se=r("Gemh");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Oe(e,t,r,n){var i=Object(O.z)(e,t,r,n,r.relationshipName);if(!i||0===i.length)return!0;for(var a=0;a<i.length;a++)if(!Object(O.t)(e,{controlName:i[a],id:t},r))return!0;return!1}function Ce(e,t,r,n,i,a){if(!Object(Se.K)(e,t,r,n,null==a?void 0:a.id))return!1;var o=Object(Se.y)(e,r,t);if(!i||!o)return!1;if(o&&0===o[n])return!1;if(null===i.ParentPicklistLogicalName)return!0;var s=Object(O.ac)(e,t,r),c=Object(O.X)(e,t,r,s,a,i.ParentPicklistLogicalName);return!(!c||!c.label)}var Ie,je,Pe,Fe=r("UOiB"),Te=function(e){function t(t,r,n,i,a,o){var s=e.call(this,t,r,n,i,a,o)||this;return Ie=t,s}return Object(V.__extends)(t,e),t.prototype.setValue=function(t){var r,n="ClientApi.XrmEntityAttributeDependentOptionSet.setValue";try{f.a.instance.reportCall(n),r=this.contextToken.contextTokenType===Fe.a.MainGrid||this.contextToken.contextTokenType===Fe.a.SubGrid||this.contextToken.contextTokenType===Fe.a.AssociatedGrid?Ce(Ie.getState(),this.getPageId(),this.contextToken,this.getName(),this.getAttrDescriptor(),this.parentEntityReference):Oe(Ie.getState(),this.getPageId(),this.contextToken,this.getName()),f.a.instance.reportSuccess(n)}catch(e){var i=T.a.getInstance().getEventParameters(this.contextToken);throw i.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(n,e,null,i),e}r?e.prototype.setValue.call(this,t):Object(F.e)("ClientApi.XrmEntityAttributeDependentOptionSet.setValue","Can not execute setValue for dependent option set attribute since it is disabled.")},t}(re),we=function(e){function t(t,r,n,i,a,o){var s=e.call(this,t,r,n,i,a,o)||this;return je=t,s}return Object(V.__extends)(t,e),t.prototype.setValue=function(t){var r,n="ClientApi.XrmEntityAttributeMultiSelectDependentOptionSet.setValue";try{f.a.instance.reportCall(n),r=this.contextToken.contextTokenType===Fe.a.MainGrid||this.contextToken.contextTokenType===Fe.a.SubGrid||this.contextToken.contextTokenType===Fe.a.AssociatedGrid?Ce(je.getState(),this.getPageId(),this.contextToken,this.getName(),this.getAttrDescriptor(),this.parentEntityReference):Oe(je.getState(),this.getPageId(),this.contextToken,this.getName()),f.a.instance.reportSuccess(n)}catch(e){var i=T.a.getInstance().getEventParameters(this.contextToken);throw i.push({name:"attributeName",value:this.getName()}),T.a.getInstance().reportFailure(n,e,null,i),e}r?e.prototype.setValue.call(this,t):Object(F.e)(n,"Can not execute setValue for dependent option set attribute since it is disabled.")},t}(U),Ee=r("cZkS"),xe=r("qC0c"),Ne=r("3ZuC"),Ae=r("WVwd"),ke=r("RK8T"),Me=function(){function e(e,t,r,n,i,a,o,s){Pe=e;var c=[{name:"pageId",value:r,isEventParam:!0,isRequired:!0,expectedDataType:"string"},{name:"entityType",value:i,isEventParam:!0,isRequired:!1,expectedDataType:"string"},{name:"store",value:e,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"xrmForm",value:n,isRequired:!0}];this._clientApiExecutor=new p.a(e,"ClientApi.XrmEntity.",r,t,c),this._pageId=r,this._xrmForm=n,this._contextToken=t,this._entityType=i,this._entityId=a,this._getAttributeNames=o,this._applicationContext=s}return Object.defineProperty(e.prototype,"attributes",{get:function(){var e=this;return this._clientApiExecutor.execute("attributes",(function(t,r){if(!e._attributes){e._attributes=new I.a(t);var n=e._getAttributeNames(e._applicationContext,e._contextToken,e._pageId);if(!n)return e._clientApiExecutor.reportFailure(t,new Error("Entity attribute names array was null or undefined"),r),e._attributes;0===n.length&&e._clientApiExecutor.reportFailure(t,new Error("Entity attribute names array was empty."),r),n.forEach((function(t){var r=Object(b.a)(Pe.getState(),e.getEntityName(),t);if(r){var n=De(Pe,e._contextToken,e._pageId,t,e,e._xrmForm.ui,r);e._attributes.add(t,n)}}))}return e._attributes}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"relatedEntities",{get:function(){var t=this,r="ClientApi.XrmEntity.relatedEntities";try{if(f.a.instance.reportCall(r),!this._relatedEntities){this._relatedEntities=new I.a(r);var n=Object(O.oc)(Pe.getState(),{id:this._pageId},this._contextToken);for(var i in n)if(n[i]){var a=Object(w.m)(this._contextToken,i),o=new e(Pe,a,this._pageId,this._xrmForm,n[i].etn,n[i].id,this._getAttributeNames,this._applicationContext);this._relatedEntities.add(i,o),this._updateControl(o,i)}var s=Object(O.nc)(Pe.getState(),{id:this._pageId}),c={};for(var i in s){var l=s[i];c[l.referencingAttribute]||(c[l.referencingAttribute]={}),c[l.referencingAttribute][l.referencedEntity]=i}var u=function(r){Pe.dispatch(Object(P.a)(d._contextToken,d._pageId,r,(function(n){for(var i in c[r]){var a=t._relatedEntities.get(c[r][i]);a&&t._relatedEntities.remove(a)}var o=n.getEventSource().getValue();if(o&&o.length>0){var s=o[0],l=c[r][s.entityType],u=Object(w.m)(t._contextToken,l),d=new e(Pe,u,t._pageId,t._xrmForm,s.entityType,h.a.tryParse(s.id),t._getAttributeNames,t._applicationContext);t._relatedEntities.add(l,d),t._updateControl(d,l)}}),!0))},d=this;for(var p in c)u(p)}return f.a.instance.reportSuccess(r),this._relatedEntities}catch(e){var g=T.a.getInstance().getEventParameters(this._contextToken);throw g.push({name:"entityName",value:this.getEntityName()}),T.a.getInstance().reportFailure(r,e,null,g),e}},enumerable:!1,configurable:!0}),e.prototype._updateControl=function(e,t){this._xrmForm&&this._xrmForm.ui&&this._xrmForm.ui.controls&&this._xrmForm.ui.controls.forEach((function(r){r instanceof me.a&&r.updateAttribute(e,t)}))},e.prototype.addOnSave=function(e){var t="ClientApi.XrmEntity.addOnSave";e||Object(F.j)(t,"handler");try{f.a.instance.reportCall(t),Pe.dispatch(Object(P.o)(this._contextToken,this._pageId,e)),f.a.instance.reportSuccess(t)}catch(e){var r=T.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),T.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.getDataXml=function(){var e="ClientApi.XrmEntity.getDataXml";try{f.a.instance.reportCall(e);var t="";return this.attributes.forEach((function(e){e.getIsDirty()&&(t+=e.getDataXmlInternal())})),t="<"+Object(D.CrmXmlEncode)(this.getEntityName())+">"+t+"</"+Object(D.CrmXmlEncode)(this.getEntityName())+">",f.a.instance.reportSuccess(e),t}catch(t){var r=T.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),T.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getEntityReference=function(){var e="ClientApi.XrmEntity.getEntityReference";try{f.a.instance.reportCall(e);var t={entityType:this.getEntityName(),id:this.getId(),name:this.getPrimaryAttributeValue()};return f.a.instance.reportSuccess(e),t}catch(t){var r=T.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),T.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getEntityName=function(){var e="ClientApi.XrmEntity.getEntityName";try{return f.a.instance.reportCall(e),f.a.instance.reportSuccess(e),this._entityType}catch(r){var t=T.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityName",value:this.getEntityName()}),T.a.getInstance().reportFailure(e,r,null,t),r}},e.prototype.getId=function(){var e="ClientApi.XrmEntity.getId";try{if(f.a.instance.reportCall(e),!this._entityId||this._entityId&&this._entityId.guid===h.a.EMPTYGUIDSTRING){var t=Object(te.i)(Pe.getState(),this._pageId);if(t&&t.value){var r=t.value;this._entityId=r.id}else{var n=Object(O.ac)(Pe.getState(),this._pageId,this._contextToken);if(n){var i=Object(v.b)(Pe.getState(),n);i&&i.identifier&&(this._entityId=i.identifier.id)}}}return this._entityId&&this._entityId.guid===h.a.EMPTYGUIDSTRING?(f.a.instance.reportSuccess(e),h.a.EMPTYSTRING):(f.a.instance.reportSuccess(e),h.a.externalGuid(this._entityId))}catch(t){var a=T.a.getInstance().getEventParameters(this._contextToken);throw a.push({name:"entityName",value:this.getEntityName()}),T.a.getInstance().reportFailure(e,t,null,a),t}},e.prototype.getPrimaryAttributeValue=function(){var e=this;return this._clientApiExecutor.execute("getPrimaryAttributeValue",(function(t,r){var n="",i=Object(E.h)(Pe.getState(),e.getEntityName());if(i){if(!i.PrimaryNameAttribute)return n="PrimaryNameAttribute was not defined",$.a.getInstance().traceManager.getTracer(t).error(n,r),"";var a=Object(O.ac)(Pe.getState(),e._pageId,e._contextToken),o=e.getId()?new m.a(e.getEntityName(),new h.a(e.getId())):new m.a(e.getEntityName()),s=Object(O.X)(Pe.getState(),e._pageId,e._contextToken,a,o,i.PrimaryNameAttribute);if(!s)return"";if(Object(g.j)(s))return s.value;n="PrimaryAttribute value was not an IPlainValue"}else n="Entity descriptor could not be retrieved.";return T.a.getInstance().reportFailure(t,new Error(n),null,r),""}))},e.prototype.getIsDirty=function(){var e="ClientApi.XrmEntity.getIsDirty";try{f.a.instance.reportCall(e);for(var t=0;t<this.attributes.getLength();t++){var r=this.attributes.get(t);if("never"!==r.getSubmitMode()&&r.getIsDirty())return f.a.instance.reportSuccess(e),!0}for(t=0;t<this.relatedEntities.getLength();t++){if(this.relatedEntities.get(t).getIsDirty())return f.a.instance.reportSuccess(e),!0}return f.a.instance.reportSuccess(e),!1}catch(t){var n=T.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),T.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.removeOnSave=function(e){var t="ClientApi.XrmEntity.removeOnSave";e||Object(F.j)(t,"handler");try{f.a.instance.reportCall(t),Pe.dispatch(Object(P.J)(this._contextToken,this._pageId,e)),f.a.instance.reportSuccess(t)}catch(e){var r=T.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),T.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.save=function(e){var t=this;this._clientApiExecutor.executeAsync("save",(function(r,n){var i=1;if(e)if("string"==typeof e)switch(e){case"save":i=1;break;case"saveandclose":i=2;break;case"saveandnew":i=59}else e.saveMode&&(i=e.saveMode);var a=Pe.getState();return Object(Ae.b)(t._pageId,Pe,i,n,t._contextToken,t,!1,"saveandclose"!==e).then((function(r){return t._performAfterSaveLogic(a,r,e)}))}))},e.prototype.isValid=function(){var e="ClientApi.XrmEntity.isValid";try{if(f.a.instance.reportCall(e),this.attributes)for(var t=0;t<this.attributes.getLength();t++){var r=this.attributes.get(t);if(this._attributeHasActiveControl(r)&&!r.isValid()||r.hasErrorNotification())return f.a.instance.reportSuccess(e),!1}if(this.relatedEntities)for(t=0;t<this.relatedEntities.getLength();t++)if(!this.relatedEntities.get(t).isValid())return f.a.instance.reportSuccess(e),!1;return f.a.instance.reportSuccess(e),!0}catch(t){var n=T.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),T.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.setRecordId=function(e){var t=this,r="ClientApi.XrmEntity.setRecordId";e||Object(F.j)(r,"id");try{if(f.a.instance.reportCall(r),this.getId()&&this._entityId.guid!==h.a.EMPTYGUIDSTRING)f.a.instance.reportSuccess(r);else{var n=h.a.tryParse(e);h.a.isNullOrEmpty(n)&&Object(F.j)(r,"id");var i=Pe.getState(),a=Object(O.ac)(i,this._pageId,this._contextToken),o=Object(w.x)(this._contextToken);if(a){var s=new m.a(this.getEntityName(),n);Pe.dispatch(Object(ue.b)(a,s)),f.a.instance.reportSuccess(r)}else{var c=Object(de.b)(i,new m.a(this.getEntityName(),n),{},o,he.a.Create),l=c.payload.snapshotId;Pe.dispatch(c),Pe.dispatch(Object(pe.b)(this._pageId,l,this._contextToken)).then((function(){f.a.instance.reportSuccess(r)})).catch((function(e){var n=T.a.getInstance().getEventParameters(t._contextToken);n.push({name:"entityName",value:t.getEntityName()}),T.a.getInstance().reportFailure(r+".setDataSnapshotId",e,null,n)}))}}}catch(e){var u=T.a.getInstance().getEventParameters(this._contextToken);throw u.push({name:"entityName",value:this.getEntityName()}),T.a.getInstance().reportFailure(r,e,null,u),e}},e.prototype.refresh=function(){var e=this,t="ClientApi.XrmEntity.refresh";try{if(f.a.instance.reportCall(t),this.getId()){for(var r=new m.a(this.getEntityName(),new h.a(this.getId())),n=[],i=[],a=0;a<this.attributes.getLength();a++)i.push(this.attributes.get(a).getName());var o=Object(ge.a)(Pe.getState(),r.etn);if(o&&i.push.apply(i,o),n.push(Pe.dispatch(Object(fe.a)(this._pageId,r,i,new ke.a(m.a.toLegacyEntityReference(r),null,null)))),this.relatedEntities)for(a=0;a<this.relatedEntities.getLength();a++)n.push(this.relatedEntities.get(a).refresh());return Promise.all(n).then((function(){Object(be.b)(e),f.a.instance.reportSuccess(t)})).catch((function(r){var n=T.a.getInstance().getEventParameters(e._contextToken);return n.push({name:"entityName",value:e.getEntityName()}),Object(F.d)(Pe,r,t,n)}))}return f.a.instance.reportSuccess(t),Promise.resolve(null)}catch(e){var s=T.a.getInstance().getEventParameters(this._contextToken);return s.push({name:"entityName",value:this.getEntityName()}),Object(F.d)(Pe,e,t,s)}},e.prototype._attributeHasActiveControl=function(e){if(e&&e.controls)for(var t=e.controls.getLength(),r=0;r<t;r++)if(!e.controls.get(r).getDisabled())return!0;return!1},e.prototype._performAfterSaveLogic=function(e,t,r){var n=Object(O.kb)(Pe.getState(),{id:this._pageId},this._contextToken);if(t||!this.getIsDirty()||n)if(Object(be.b)(this),"saveandclose"===r){if(!Object(be.a)(Object(ye.b)(Pe.getState())===this._pageId)){var i=Object(O.Kb)(e,this._pageId),a=Object(O.Ib)(e,this._pageId);if(!i&&!a){var o=Object(Ne.a)(Pe.getState(),this._pageId);return Pe.dispatch(Object(le.b)(o))}}}else if("saveandnew"===r){var s={entityTypeName:this.getEntityName()};return Pe.dispatch(Object(ve.a)(_e.a,s,this._pageId))}return Promise.resolve()},e}();
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function De(e,t,r,n,i,a,o){var s=null;switch(o.Type){case"datetime":s=new Y(e,t,r,n,i,a);break;case"decimal":case"double":case"integer":case"money":s=new ee(e,t,r,n,i,a);break;case"lookup":case"owner":case"customer":s=new Z(e,t,r,n,i,a);break;case"partylist":s=new oe(e,t,r,n,i,a);break;case"memo":case"string":s=new ne(e,t,r,n,i,a);break;case"picklist":if(Object(xe.c)(e.getState(),Ee.L)&&Object(b.l)(e.getState(),o.EntityLogicalName,n)){s=new Te(e,t,r,n,i,a);break}case"optionset":case"state":case"status":s=new re(e,t,r,n,i,a);break;case"boolean":s=new H(e,t,r,n,i,a);break;case"entityname":s=new ce(e,t,r,n,i,a);break;case"uniqueidentifier":s=new ie(e,t,r,n,i,a);break;case"multiselectpicklist":s=Object(xe.c)(e.getState(),Ee.L)&&Object(b.l)(e.getState(),o.EntityLogicalName,n)?new we(e,t,r,n,i,a):new U(e,t,r,n,i,a);break;case"file":s=new se(e,t,r,n,i,a);break;default:s=new L(e,t,r,n,i,a)}return s}},Baft:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="polite",i="assertive"},BuSU:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(e){return{Title:e&&e.Title||null,Legend:e&&e.Legend||null,Area3DStyle:e&&e.Area3DStyle||null,AreaGradientStyle:e&&e.AreaGradientStyle||null,XAxes:e&&e.XAxes||null,YAxes:e&&e.YAxes||null,SeriesList:e&&e.SeriesList||null,SubTitle:e&&e.SubTitle||null,Colors:e&&e.Colors||null,DisplayMode:e&&e.DisplayMode||0,ErrorInformation:e&&e.ErrorInformation||null,EnableDrilldown:e&&e.EnableDrilldown||!0,Annotations:e&&e.Annotations||null}}r.d(t,"a",(function(){return n}))},Cgjg:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o}));var n=r("Sscr"),i=r("uO/V"),a="grid.setCustomFilter";function o(e,t,r,o,s){return{type:"grid.setCustomFilter.async",execute:function(c,l){var u=c.dispatch,d=(c.getState,l.TraceManager.getTracer(i.z)),p=i.x+".setCustomFilterAction";try{return d.info("Adding a custom filter for the grid. "),u(function(e,t,r,i,o){var s=null;if(null!=e){s={customFilterXml:e,source:t,timeStamp:o||null}}var c=Object(n.y)(i),l=Object(n.v)(i);return{type:a,payload:s,meta:{pageId:r,contextKey:c,dataSetContextKey:l}}}(e,t,r,o,s)),l.EventManager.ReportComponentSuccess(p),Promise.resolve()}catch(e){l.EventManager.ReportComponentFailure(p,Error("Adding a custom filter for the grid failed"))}}}}},"Dlr/":function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n,i=r("c/eZ"),a=r("1z64"),o=r("Gemh"),s=r("9r0m"),c=r("YCDx"),l=r("w/nD"),u=r("Sscr"),d=r("/W63"),p=r("IiPO"),h=r("ar+e"),g=r("QUnS"),m=r("Ka9P"),f=r("7bez"),b=r("h82J"),y=r("ezfI"),v=r("kvLG"),_="ClientApi.XrmControlSubGrid.",S=function(e){function t(t,r,i,o,s,c,l,d){var p=e.call(this,t,r,i,l,o,c)||this;return p._relationship=null,n=t,p._subgridToken=Object(u.p)(r,o),p._clientApiExecutorSubGrid=new a.a(t,_,i,p._subgridToken),p.clientApiExecutor.addEventParameter({name:"controlName",value:o,isEventParam:!0}),p.clientApiExecutor.addEventParameter({name:"isEditable",value:s,isEventParam:!0}),p._gridControl=new f.a(t,p._subgridToken,i,s,3,!0,d,o),t.dispatch(Object(b.a)(p,i,p._subgridToken)),p}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"clientApiExecutor",{get:function(){return this._clientApiExecutorSubGrid},enumerable:!1,configurable:!0}),t.prototype.setFilterXml=function(e){var t=_+"setFilterXml";try{y.a.instance.reportCall(t),this._gridControl.setFilterXml(e),y.a.instance.reportSuccess(t)}catch(e){var r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getFilterXml=function(){var e=_+"getFilterXml";try{y.a.instance.reportCall(e);var t=this._gridControl.getFilterXml();return y.a.instance.reportSuccess(e),t}catch(t){var r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.refresh=function(){var e=_+"refresh";try{y.a.instance.reportCall(e),this._gridControl.refresh(),y.a.instance.reportSuccess(e)}catch(r){var t=p.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getFetchXml=function(){var e=_+"getFetchXml";try{y.a.instance.reportCall(e);var t=this._gridControl.getFetchXml();return y.a.instance.reportSuccess(e),t}catch(t){var r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getGrid=function(){var e=_+"getGrid";try{y.a.instance.reportCall(e);var t=this._gridControl.getGrid();return y.a.instance.reportSuccess(e),t}catch(t){var r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getViewSelector=function(){var e=_+"getViewSelector";try{y.a.instance.reportCall(e);var t=this._gridControl.getViewSelector();return y.a.instance.reportSuccess(e),t}catch(t){var r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getTeamTemplateId=function(){var e=_+"getTeamTemplateId";try{y.a.instance.reportCall(e);var t=this._gridControl.getTeamTemplateId();return y.a.instance.reportSuccess(e),t}catch(t){var r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.addOnLoad=function(e){var t=this;this.clientApiExecutor.execute("addOnLoad",(function(){n.dispatch(Object(l.d)(t._subgridToken,t.pageId,e,t.name))}),[{name:"handler",value:e,isRequired:!0,isEventParam:!1}])},t.prototype.removeOnLoad=function(e){var t=this;this.clientApiExecutor.execute("removeOnLoad",(function(){n.dispatch(Object(l.y)(t._subgridToken,t.pageId,e,t.name))}),[{name:"handler",value:e,isRequired:!0,isEventParam:!1}])},t.prototype.getEntityName=function(){var e=_+"getEntityName";try{y.a.instance.reportCall(e);var t=this._gridControl.getEntityName();return y.a.instance.reportSuccess(e),t}catch(t){var r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getControlType=function(){var e=this;return this.clientApiExecutor.execute("getControlType",(function(){var t=Object(g.a)(n.getState(),e.controlDescriptor,e.pageId,e.contextToken);return t?"customsubgrid:"+t.Name:"subgrid"}))},t.prototype.getRelationship=function(){var e=this;return this.clientApiExecutor.execute("getRelationship",(function(t,r){var n,i;if(!e._relationship){if(null===(i=null===(n=e.controlDescriptor)||void 0===n?void 0:n.Parameters)||void 0===i?void 0:i.RelationshipName){var a=e.controlDescriptor.Parameters.RelationshipName,o=e.controlDescriptor.Parameters.RelationshipRoleOrdinal,s=e.controlDescriptor.Parameters.TargetEntityType;e._relationship=Object(f.b)(a,s),e._relationship.roleType=o}e._relationship||(e._relationship=e._gridControl.getRelationship())}return e._relationship}))},t.prototype.getRecordSetQueryKey=function(){var e=this;return this.clientApiExecutor.execute("getRecordSetQueryKey",(function(){return Object(o.cb)(n.getState(),e._subgridToken,{id:e.pageId})}))},t.prototype.getGridType=function(){return y.a.instance.reportUsage(_+"getGridType"),3},t.prototype.getRollupType=function(){var e=this;return this.clientApiExecutor.execute("getRollupType",(function(){return Object(o.eb)(n.getState(),e.pageId,e.contextToken)}))},t.prototype.openRelatedGrid=function(){var e=this;this.clientApiExecutor.executeAsync("openRelatedGrid",(function(t,r){var i=e.getRelationship();if(!i)return v.a.getInstance().traceManager.getTracer(t).error("Can't open related grid: the relationship was not retrieved from the inner grid.",r),Promise.resolve(s.a.EMPTY);for(var a=Object(h.c)(n.getState(),e.pageId),o=null,c=0;c<a.length;c++)if(a[c].relationshipName===i.name){o=a[c];break}if(!o)return r.push({name:"relationshipName",value:i.name}),v.a.getInstance().traceManager.getTracer(t).error("Can't open related grid: no relationship was found with the specified name.",r),Promise.resolve(s.a.EMPTY);var l={id:o.id,title:o.title,entityName:e.getEntityName(),relationshipName:i.name,isSelected:!0,show:o.show},p=Object(u.a)(e._subgridToken.parentContextToken,i.name,i.roleType?1===i.roleType?m.a.Referencing:m.a.AssociationEntity:void 0);return n.dispatch(Object(d.a)(e.pageId,p,l))}))},t.prototype.refreshRibbon=function(){var e=_+"refreshRibbon";try{y.a.instance.reportCall(e),this._gridControl.refreshRibbon(),y.a.instance.reportSuccess(e)}catch(r){var t=p.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getUrl=function(){var e=_+"getUrl";try{y.a.instance.reportCall(e);var t=this._gridControl.getUrl();return y.a.instance.reportSuccess(e),t}catch(t){var r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getParentForm=function(){var e=_+"getParentForm";try{y.a.instance.reportCall(e);var t=this._gridControl.getParentForm();return y.a.instance.reportSuccess(e),t}catch(t){var r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,t,null,r),t}},t}(c.a)},Ds7n:function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return f}));var n=r("9r0m"),i=r("Sscr"),a=r("uO/V"),o=r("Gemh"),s=r("F2uj"),c=r("VWqI"),l=r("wUng"),u=r("QAhb"),d=r("cZkS"),p=r("qC0c"),h=r("yHpA"),g=r("+Xnp"),m="dataset.row.properties";function f(e,t,r){return{type:"row.properties.async",execute:function(l,h){var f,y,v,_=l.dispatch,S=l.getState,O=h.TraceManager.getTracer(a.z),C=a.x+".RowPropertiesAction",I=Object(p.c)(S(),d.L);try{var j=Object(i.v)(t),P=Object(o.P)(S(),t,{id:e});if(P){var F=null,T=Object(o.Q)(S(),e,t);if(T)F=T;else{var w=Object(o.S)(S(),{id:e},t);w&&w.entityLogicalName&&(F=w.entityLogicalName)}if(F){var E=Object(s.d)(S(),F),x=Object(o.y)(S(),t,e);if(E){for(var N=[],A=0,k=Object.keys(E);A<k.length;A++){var M=E[k[A]],D=Object(c.f)(S(),F,M.LogicalName,g.a.CanUpdate),R=!0;I&&x&&0===x[M.LogicalName]&&(R=!1),N.push(((f={})[M.LogicalName]={requiredLevel:M.RequiredLevel,isDisabled:!(M.IsValidForUpdate&&D&&R),notifications:{}},f))}for(var B=function(e){var t;if(0===P.records.filter((function(t){return Object.keys(t)[0]===n.a.toString(e)})).length)P.records.push(((t={})[n.a.toString(e)]=N,t));else{var r=P.records.find((function(t){return Object.keys(t)[0]===n.a.toString(e)}))[n.a.toString(e)],i=JSON.parse(JSON.stringify(N));r&&r.forEach((function(e){var t=e[Object.keys(e)[0]];t&&Object.keys(t.notifications).length>0&&(i.find((function(t){return Object.keys(t)[0]===Object.keys(e)[0]}))[Object.keys(e)[0]].notifications=t.notifications)})),P.records.find((function(t){return Object.keys(t)[0]===n.a.toString(e)}))[n.a.toString(e)]=i}},L=0,V=r;L<V.length;L++){B(V[L])}}}if(_(function(e,t,r){return{type:m,payload:r,meta:{pageId:e,dataSetContextKey:t}}}(e,j,P)),I&&F){E=Object(s.d)(S(),F),x=Object(o.y)(S(),t,e);for(var z=0,G=r;z<G.length;z++){var W=G[z],H=(S(),y=W,v=F,new u.a(v,y)),U=Object(i.f)(t,W,F);if(E)for(var q=0,X=Object.keys(E);q<X.length;q++){M=E[X[q]];x&&1===x[M.LogicalName]&&null===M.ParentPicklistLogicalName&&b(S(),_,e,H,M.LogicalName,U)}}}O.info("creating the rowproperties for {0} rows"+r.length),h.EventManager.ReportComponentSuccess(C)}return Promise.resolve()}catch(e){var K="creating the rowproperties for {0} rows"+r.length+"failed";h.EventManager.ReportComponentFailure(C,Error(K))}}}}function b(e,t,r,n,i,a){var s={},c=Object(o.R)(e,r,a),u=Object(h.d)(e,c,n,i);s[i]=u,Object.keys(s).length>0&&t(Object(l.b)(r,a,!1,s))}},EVAY:function(e,t,r){"use strict";r.d(t,"a",(function(){return G}));var n=r("c/eZ"),i=r("nuS9"),a=r("4fxQ"),o=r("ASFs"),s=r("4E+q"),c=r("Ww2r"),l=r("jaaU"),u=r("evW+"),d=r("XIN1"),p=r("znb3"),h=r("wV3W"),g=r("5olG"),m=r("vO+w");var f=r("1AYO"),b=r("YWpA"),y=r("HRxj"),v=r("akzq"),_=r("B73A"),S=r("9rQ4"),O=r("Tr6b"),C=r("Wi7Z"),I=r("LWFb"),j=r("wQXd"),P="headerFieldsFlyout",F=function(e){function t(t){var r=e.call(this,t)||this;return r._onCellsDidMount=r._onCellsDidMount.bind(r),r._handleCloseFlyout=r._handleCloseFlyout.bind(r),r._handleOutsideClick=r._handleOutsideClick.bind(r),r.state={isCellRendered:!1},r}return Object(n.__extends)(t,e),t.prototype._handleOutsideClick=function(e){var t=this;setTimeout((function(){t.props.handleOutsideClick(e),t.setState({isCellRendered:!1})}),0)},t.prototype._handleCloseFlyout=function(){this.props.closeFlyout(!0),this.setState({isCellRendered:!1})},t.prototype._shortcutHandler=function(e){if(e.EVENT.keyCode===S.a.Escape){var t=e.EVENT.target.closest("#__flyoutRootNode");t&&t.childNodes.length<=1&&this._handleCloseFlyout()}},t.prototype._createKeyboardShortcuts=function(){var e=Object(c.c)(this.props.resourceStrings,l.a),t=Object(c.c)(this.props.resourceStrings,l.b),r=this._shortcutHandler.bind(this),n=[],i=new _.a([S.a.Escape],r,!0,e,t);return n.push(i),n},t.prototype._onCellsDidMount=function(){this.props.headerFields&&this.props.isFlyoutOpened&&this.setState({isCellRendered:!0})},t.prototype._renderHeaderFields=function(e){var t=this,r=this.props.headerFields&&this.props.headerFields.map((function(r){return i.createElement(y.a,{key:r.Id,id:t.props.id,previewId:r.PreviewId,controlName:r.Name,ref:r.Id,cellSizeMode:0,shouldNotifyRenderComplete:!0,onRenderComplete:t._onCellsDidMount,style:t.props.cellStyle,scope:O.a.EditForm,parentFlyoutRoot:e})}));return this.props.showControlsInContainer?i.createElement(b.a,null,r):r},t.prototype.render=function(){var e;if(this.props.isFlyoutOpened){var t=i.createElement(f.a,{key:P,id:P,flyoutDirection:f.b.downleft,relativeToElementId:this.props.relativeElementId,positionType:"relative",flyoutStyle:this.props.flyoutStyle,onOutsideClick:this._handleOutsideClick,testhooks:(e={id:P},e[I.b]=this.props.headerPreviewId+"-"+I.d+"-"+P,e[I.c]=20..toString(),e),parentFlyoutRoot:"__flyoutRootNode"},this._renderHeaderFields("__flyoutRootNode")),r=this.state.isCellRendered?i.createElement(v.a,{key:"headerFieldsFlyoutAccessibility",rootElementId:P,overrideFocusId:P,shouldManageFocus:!this.props.isPreviewMode,waitForEditable:!1,keyboardShortcuts:this._createKeyboardShortcuts(),isModal:!0}):null;return i.createElement(b.a,{key:"headerFieldsFlyoutContainer",id:"headerFieldsFlyoutContainer",tabIndex:0,role:C.e},t,r)}return null},t}(i.Component);F.displayName="HeaderFields";var T=Object(s.a)((function(){var e,t,r,n,i=(e=null,t=null,r=null,n=null,function(i,a){var o,s=Object(h.a)(i),c=Object(m.c)(i),l=Object(m.a)(i),u=null==l?void 0:l.Colors;return t===s&&r===c&&n===u||(t=s,r=c,n=u,e={flyoutStyle:{borderColor:"#ffffff",borderWidth:"1px",borderStyle:"solid",borderTopWidth:0,padding:s.sizes.Measures.Measure100,width:"30rem",height:"auto",maxHeight:"23.75rem",boxShadow:s.shadows.Shadow01,backgroundColor:c?null===(o=null==u?void 0:u.Palette)||void 0===o?void 0:o.Primary01:s.colors.BaseColor.White,flexDirection:"column",overflowY:"auto"},cellStyle:{width:"100%",minHeight:Object(g.a)(s.sizes.Section.cellHeightInRem)}}),e}),a=Object(c.h)();return function(e,t){var r=i(e,t),n=a(e,l.e),o=Object(j.d)(e);return{flyoutStyle:r.flyoutStyle,cellStyle:r.cellStyle,resourceStrings:n,isPreviewMode:o}}}))(F),w=r("Sscr"),E=r("gUzs"),x=r("zt+H"),N=r("7EJx"),A=r("TCzx");var k=r("oPeH"),M=r("H/hG"),D=r("HSdq"),R=r("cZkS"),B=r("kyRo"),L=r("+spQ"),V=r("OTOS"),z=function(e){function t(t){var r=e.call(this,t)||this;return r._previousHeaderCollaped=!1,r._onExpandButtonClick=r._onExpandButtonClick.bind(r),r._flyoutOutsideClickHandler=r._flyoutOutsideClickHandler.bind(r),r._moveFocusToExpandButton=r._moveFocusToExpandButton.bind(r),r._toggleFlyout=r._toggleFlyout.bind(r),r.state={isFlyoutOpened:!1},r}return Object(n.__extends)(t,e),t.prototype._toggleFlyout=function(e){var t=this,r=e||this.state.isFlyoutOpened;if(this.setState({isFlyoutOpened:!r},(function(){t.state.isFlyoutOpened||t._moveFocusToExpandButton()})),!this.state.isFlyoutOpened){var n=[{name:"formId",value:this.props.formId}];this.context.EventManager.ReportComponentSuccess("Forms.HeaderFieldsChevron.buttonClicked",n)}},t.prototype._moveFocusToExpandButton=function(){var e=a.findDOMNode(this.refs[L.b]);e&&e.focus()},t.prototype._flyoutOutsideClickHandler=function(e){if(e&&e.target){var t=e.target.id;t===L.b||"expandIcon"===t||this.props.headerPreviewId||this._toggleFlyout(!0)}},t.prototype._onExpandButtonClick=function(e){this._toggleFlyout()},t.prototype._shortcutHandler=function(e){e.EVENT.keyCode===S.a.Escape&&this.state.isFlyoutOpened&&this._toggleFlyout()},t.prototype._createKeyboardShortcuts=function(){var e=Object(c.c)(this.props.resourceStrings,l.a),t=Object(c.c)(this.props.resourceStrings,l.b),r=this._shortcutHandler.bind(this),n=[],i=new _.a([S.a.Escape],r,!0,e,t);return n.push(i),n},t.prototype._renderExpandButton=function(){var e,t=this.props.isChevronVisible,r=Object(c.c)(this.props.resourceStrings,l.c),a=Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},this.props.styles.expandButtonStyle),{opacity:t?1:0,pointerEvents:t?void 0:"none"}),this.props.customStyle),o=i.createElement(u.a,{key:L.b,id:L.b,accessibilityLabel:r,title:this.props.hasInvalidControls?Object(c.c)(this.props.resourceStrings,l.d):r,onClick:this._onExpandButtonClick,style:this.props.enabledFormFCBs.has(R.mb)?this.props.styles.errorIconAndChevronInnerContainerStyle:a,accessibilityExpanded:this.state.isFlyoutOpened,accessibilityHasPopup:!0,describedByElementId:this.props.hasInvalidControls?"headerFieldsChevronError":void 0,ref:L.b,testhooks:(e={id:"header_overflowButton"},e[I.b]=this.props.headerPreviewId+"-"+I.d+"-header_overflowButton",e[I.c]=20,e),disabled:!t||void 0,accessibilityHidden:!t||void 0,tabIndex:t?void 0:-1},this._renderErrorIcon(),this._renderExpandIcon(a));return this.props.enabledFormFCBs.has(R.mb)?t?i.createElement(b.a,{style:this.props.styles.errorIconAndChevronOuterContainerStyle},o):null:o},t.prototype._renderErrorIcon=function(){return this.props.enabledFormFCBs.has(R.mb)&&this.props.hasInvalidControls?i.createElement(d.b,{type:p.a.MarkAsLost,style:this.props.styles.errorIconStyle}):null},t.prototype._renderExpandIcon=function(e){return i.createElement(d.b,{id:"expandIcon",style:this.props.enabledFormFCBs.has(R.mb)?e:this.props.styles.expandButtonIconStyle,type:this.state.isFlyoutOpened?p.a.ChevronUp:p.a.ChevronDown})},t.prototype._renderHeaderFieldsFlyout=function(){if(this.props.isChevronVisible){var e=this.props.headerCollapsed===this._previousHeaderCollaped&&this.state.isFlyoutOpened;return i.createElement(T,{key:"headerFieldsFlyout",id:this.props.id,relativeElementId:L.b,isFlyoutOpened:e,handleOutsideClick:this._flyoutOutsideClickHandler,closeFlyout:this._toggleFlyout,headerFields:this.props.headerFields,showControlsInContainer:this.props.enabledFormFCBs.has(R.mb),headerPreviewId:this.props.headerPreviewId})}return null},t.prototype._renderErrorString=function(){var e=Object(c.c)(this.props.resourceStrings,l.d);return i.createElement(M.a,{id:"headerFieldsChevronError",hidden:!0,role:C.a},e)},t.prototype.render=function(){return i.createElement(i.Fragment,null,this.props.hasInvalidControls?this._renderErrorString():null,this._renderExpandButton(),this._renderHeaderFieldsFlyout(),i.createElement(v.a,{key:"headerFieldsChevronAccessibility",rootElementId:"headerFieldsChevron",shouldManageFocus:!1,keyboardShortcuts:this._createKeyboardShortcuts()}))},t.prototype.componentWillReceiveProps=function(e){e.headerCollapsed!==this._previousHeaderCollaped&&this.state.isFlyoutOpened&&this._toggleFlyout(!0)},t.prototype.componentDidUpdate=function(){this._previousHeaderCollaped=this.props.headerCollapsed},t}(i.Component);z.displayName="HeaderFieldsChevron",z.contextType=B.a;var G=Object(s.a)((function(){var e,t,r,n,i,a,s=Object(c.h)(),u=(e=null,t=null,r=!1,n=!1,i=!1,a=!1,function(o,s,c,l){var u=Object(h.a)(o),d=Object(N.g)(o),p=s.headerCollapsed;return t===u&&r===p&&n===c&&i===d&&a===l||(t=u,r=p,n=c,i=d,a=l,e={expandButtonStyle:{cursor:"pointer",borderWidth:0,padding:0,height:u.sizes.Measures.Measure300,width:u.sizes.Measures.Measure300,marginTop:u.sizes.HeaderFields.ExpandButtonMarginTop,transition:E.b,transform:p?"translateY(-"+u.sizes.Measures.Measure175+")":"none",backgroundColor:"transparent",":hover":{backgroundColor:u.colors.BaseColor.Grey.Grey3}},expandButtonIconStyle:{margin:"0 auto",transform:A.a.getInstance().get_IsBrowserEdge()||A.a.getInstance().get_IsBrowserIE()?"translateY("+u.sizes.Measures.Measure100+")":void 0},errorIconStyle:{color:x.f,height:"16px",width:"16px",fontSize:"16px",lineHeight:"16px",marginLeft:"8px",marginRight:"8px"},errorIconAndChevronOuterContainerStyle:{display:"flex",alignItems:l?void 0:"center",marginLeft:d?void 0:l?"auto":"18px",marginRight:d?l?"auto":"18px":void 0,flexShrink:A.a.getInstance().get_IsBrowserIE()?0:void 0},errorIconAndChevronInnerContainerStyle:{borderWidth:0,padding:0,display:"flex",height:"32px",alignItems:"center",backgroundColor:c?x.b:"transparent",":hover":{backgroundColor:u.colors.BaseColor.Grey.Grey3}}}),e}),d=Object(D.cd)(),p=null;return function(e,t){var r=Object(w.j)(e,t.id);Object(o.e)(p,r)||(p=r);var n=s(e,l.e),i=Object(k.d)(e,t.id,t.headerFields,p),a=u(e,t,i,t.justifyEnd),c=d(e,t,p),h=Object(k.e)(e,t,r),g=Object(V.b)(e,t.id)?Object(V.b)(e,t.id).guid:"";return{resourceStrings:n,styles:a,contextToken:p,enabledFormFCBs:c,hasInvalidControls:i,headerPreviewId:h,formId:g}}}))(z)},F314:function(e,t,r){"use strict";r.d(t,"a",(function(){return z}));var n=r("c/eZ"),i=r("pOv+"),a=r("9r0m"),o=r("G7N+"),s=r("sOTk"),c=r("JlqV"),l=r("gBKR"),u=r("lMVv"),d=r("VWqI"),p=r("dEPU"),h=r("QAhb"),g=r("vYfn"),m=r("PQ2H"),f=r("olrR"),b=r("uO/V"),y=r("r2h9"),v=r("/V8d"),_=r("EcZf"),S=r("bCrZ"),O=r("Gemh"),C=r("jigW"),I=r("8Fmj"),j=r("w82B"),P=r("cZkS"),F=r("qC0c"),T=r("B0z9"),w=r("Ajgc"),E=r("7dGM"),x=r("Z46F"),N=r("S2mk"),A=r("s2by"),k=r("EN0n"),M=r("CIm2"),D=r("7EJx"),R=r("7pqb"),B=r("/j9Z");var L=r("sgPk"),V=r("ak18");function z(e,t,r,z,W,H,U,q,X,K,Q,Y,Z){void 0===X&&(X=function(){return 7}),void 0===Y&&(Y=!0),void 0===Z&&(Z=!1);var J=[],$=[],ee=function(e,t,r,k,z,W,H,U,q,X,K){void 0===X&&(X=!0);void 0===K&&(K=!1);var Q=Object(s.l)(e(),k),Y={},Z=function(e,t,r){var n=[],i=[],o={},s={};return function(c,l,u){var d=[],p=l.controlParameters,h=a.a.tryParseOrNull(l.viewId)?a.a.tryParseOrNull(l.viewId):a.a.tryParseOrNull(p.ViewId),g=a.a.toString(h),m=a.a.tryParseOrNull(p.VisualizationId),b=a.a.toString(m);if("true"===p.EnableChartPicker&&-1===n.indexOf(l.entityLogicalName)){n.push(l.entityLogicalName);var v=c(Object(I.a)(l.entityLogicalName,l.chartType)),_=[{name:"TargetEntityType",value:l.entityLogicalName}];t.info(r+" page, chart control, retrieve chart dispatched",_),d.push(v)}if(Object(F.c)(e(),P.B)&&"true"===p.EnableViewPicker&&-1===i.indexOf(l.entityLogicalName)){i.push(l.entityLogicalName);var S=c(Object(f.a)(l.entityLogicalName,y.a.MAIN_APPLICATION_VIEW,void 0,void 0,!0));_=[{name:"TargetEntityType",value:l.entityLogicalName}];t.info(r+" page, chart control, retrieve view dispatched",_),d.push(S)}return b&&(o[b]||(o[b]=c(Object(I.a)(l.entityLogicalName,l.chartType,m)).catch((function(e){var n=e&&e.getNegativeErrorCode&&e.getNegativeErrorCode(),i=[{name:"TargetEntityType",value:l.entityLogicalName},{name:"VisualizationId",value:b},{name:"ChartType",value:l.chartType},{name:"ErrorCode",value:Object(N.j)(n)?"":"0x"+x.a.getHexErrorCodeFromInt(n)},{name:"ErrorMessage",value:e.message?e.message:""},{name:"ErrorDetails",value:e.details?e.details:""}];t.info(r+" page, retrieve Chart Control metadata failed.",i)}))),u.push(o[b]),d.push(o[b])),g&&(s[g]||(s[g]=c(Object(f.a)(l.entityLogicalName,void 0,l.viewType,h)).catch((function(e){var n=e&&e.getNegativeErrorCode&&e.getNegativeErrorCode(),i=[{name:"TargetEntityType",value:l.entityLogicalName},{name:"ViewId",value:g},{name:"ViewType",value:l.viewType},{name:"ErrorCode",value:Object(N.j)(n)?"":"0x"+x.a.getHexErrorCodeFromInt(n)},{name:"ErrorMessage",value:e.message?e.message:""},{name:"ErrorDetails",value:e.details?e.details:""}];t.info(r+" page, retrieve Chart Control metadata failed.",i)}))),u.push(s[g]),d.push(s[g])),d}}(e,t,Q),J=function(e,t,r,n,i,o){var s=[],c={},l=Object(v.c)(e,n,i,o);return function(i,o){var u,d,p=o.controlParameters,h=Object(v.e)(o),g=c[h];if(!g){var m=e(),f=o.entityLogicalName,b=Object(D.q)(m);if(m&&f&&b){var y=Object(F.c)(m,P.Zc),_=Object(A.a)(f,b,o.contextToken,y).getFilterAndLinkedEntities(M.a,!0);if(_){if(o.getCustomFilter){var S=o.getCustomFilter();if(S&&S.filter){var C=_.filter,I={conditions:[],filterOperator:0,filters:[S.filter,C]};_.filter=I}S&&S.linkEntities&&(u=_.linkEntities).push.apply(u,S.linkEntities)}o.getCustomFilter=function(){return _}}}g=l(o),c[h]=g}var x=p.ChartDrillDownParameters;if(x&&x.length>0){var N=x[x.length-1];d=new T.a(e,a.a.tryParse(p.VisualizationId),a.a.tryParse(o.viewId),o.chartType,o.viewType,N.groupByAttribute.name,N.groupByAttribute.relatedEntityName,N.chartType);var k=[{name:"TargetEntityType",value:o.entityLogicalName},{name:"ViewId",value:o.viewId},{name:"VisualizationId",value:p.VisualizationId},{name:"DrilldownAttributeName",value:N.groupByAttribute.name},{name:"DrilldownChartType",value:N.chartType}];t.info(r+" page, retrieve chart drilldown data dispatched",k)}else{d=new w.a(e,a.a.tryParse(p.VisualizationId),a.a.tryParse(o.viewId),o.chartType,o.viewType);k=[{name:"TargetEntityType",value:o.entityLogicalName},{name:"ViewId",value:o.viewId},{name:"VisualizationId",value:p.VisualizationId}];t.info(r+" page, retrieve chart data dispatched",k)}var R=Object(O.qb)(e(),a.a.tryParse(o.viewId),n),B=Object(E.a)(e(),a.a.tryParse(p.VisualizationId));return B&&B.DataDescription&&(g&&g.fetchXml||R&&R.fetchXML)&&(d.initialize(B.DataDescription,g.fetchXml?g.fetchXml:R.fetchXML,B.PresentationDescription,R.title,R.entityLogicalName,B.Name,B.PrimaryEntityTypeCode,!a.a.isNullOrEmpty(B.WebResourceId)),d.setupAggregationQueries()),-1===s.indexOf(d.getStorageKey())?(s.push(d.getStorageKey()),i(Object(j.a)(d,o.entityLogicalName,n,!1))):null}}(e,t,Q,k,z,W),$=function(e,t,r,n){var o=[],s={},c={},l={};return function(u,d,b){var v=[],_=d.entityLogicalName,S=d.controlParameters;if(d.ribbonContext){var O=d.ribbonContext+_;if(-1===o.indexOf(O)){o.push(O);var C=u(Object(p.a)(O));v.push(C);var I=[{name:"TargetEntityType",value:_},{name:"RibbonContext",value:d.ribbonContext}];e.info(t+" page, retrieve ribbon dispatched",I)}}var j=d.cardFormId;if(j&&(!a.a.equals(j,i.a)||"activitypointer"!==_)){var P=a.a.equals(j,i.a)?null:j,F=P?P.guid:d.entityLogicalName;if(!s[F]){var T=u(Object(g.b)(new h.a(_),P,Object(m.a)(11)));s[F]=T,v.push(T);I=[{name:"TargetEntityType",value:_},{name:"FormId",value:j&&j.guid}];e.info(t+" page, retrieve card form dispatched",I)}b.push(s[F])}if(!(1===d.gridType||"true"!==S.EnableViewPicker||l[_]&&l[_].allViews)){l[_]||(l[_]={allViews:!1,viewIds:[]});var w=l[_],E=S.ViewIds,x=E&&E.split(",");if(x&&0!==x.length)for(var N=0,A=x;N<A.length;N++){var k=A[N];if(-1===w.viewIds.indexOf(k)){w.viewIds.push(k);var M=a.a.tryParseOrNull(k);if(M){var D=u(Object(f.a)(_,void 0,void 0,M,void 0,n));v.push(D);I=[{name:"TargetEntityType",value:_},{name:"ViewId",value:k}];e.info(t+" page, retrieve view dispatched",I)}}}else{if(w.allViews=!0,0===d.gridType){var L=u(Object(f.a)(_,y.a.SUB_GRID,void 0,void 0,void 0,n));v.push(L)}var V=u(Object(f.a)(_,y.a.MAIN_APPLICATION_VIEW,void 0,void 0,void 0,n));v.push(V);var I=[{name:"TargetEntityType",value:_}];e.info(t+" page, retrieve all views dispatched",I)}}var z=d.viewId;if(c[z])d.viewId=c[z];else{var G="true"===S.IsUserView?y.b.userview:y.b.savedview,W=d.pinnedEntityLogicalName,H=0===d.gridType?y.a.SUB_GRID:y.a.MAIN_APPLICATION_VIEW,U=W||_;d.quickFindSearchString&&(H=y.a.QUICKFIND_SEARCH,U=d.quickFindEntityIfActivity||U);D=u(function(e,t,r,n){return{type:"view.retrieveornull.async",execute:function(i,a,o){var s=i.dispatch,c=(i.getState,s(Object(f.a)(e,t,r,n)));return new Promise((function(i){c.then((function(e){return i(e)}),(function(o){var s=a.TraceManager.getTracer("view.retrieveornull.async"),c=[{name:R.b.EntityName,value:e},{name:R.b.ViewId,value:n&&n.guid||""},{name:"ViewType",value:r},{name:"SavedQueryType",value:t}];return s.warn("Retrieve view or null : retrieve of view failed : "+Object(B.d)(o),c),i(null)}))}))}}}(U,H,G,a.a.tryParseOrNull(z))).then((function(t){return z&&!t&&r?(e.warn("Pinned view retrieval failed. Loading default view."),u(Object(f.a)(_,y.a.MAIN_APPLICATION_VIEW)).then((function(e){return n(e)}))):n(t);function n(e){var t=e&&e.guid;if(d.viewId=t,c[z]=t,d.onViewRetrieve)return d.onViewRetrieve(e)}}));v.push(D),b.push(D);I=[{name:"TargetEntityType",value:_},{name:"ViewId",value:z}];e.info(t+" page, retrieve view dispatched from retrieveControlMetadataAndData",I)}return v}}(t,Q,X,K),ee=function(e,t,r,n,i,a){var s={},c=Object(v.b)(e,n,i,a);return function(i,a,l,u,d){var p,h,g=[],m=a.entityLogicalName,f=a.viewId;if(f){var b=Object(v.e)(a),y=s[b];if(!y){var C=c(a);if(!(y=y instanceof L.a?C&&C.getQueryState():C&&C.getQueryState(e)))return g;if(s[b]=y,Object(V.c)(y,null===(p=a.contextToken)||void 0===p?void 0:p.contextTokenType,null===(h=a.control)||void 0===h?void 0:h.Id),u){i(Object(_.d)(y)).catch((function(){var e,t={lists:(e={},e[y.key]={initialized:o.a.Error,lastRetrieved:new Date,pageSize:C.pageSize},e)};i({type:_.b,payload:t})}));var I=[{name:"TargetEntityType",value:m},{name:"ViewId",value:f}];t.info(r+" page, retrieve grid data dispatched",I)}}if(d){var j=a.controlParameters.RelationshipName,P=Object(O.db)(e(),m,j),F=i(Object(S.d)(y,m,n,a.contextToken,a.control,j,P,void 0,l));if(g.push(F),a.onInitializeGrid){var T=F.then(a.onInitializeGrid);g.push(T)}}else if(a.onInitializeGrid){T=a.onInitializeGrid();g.push(T)}var w=[{name:"TargetEntityType",value:m},{name:"ViewId",value:f}];return t.info(r+" page, initialize grid dispatched",w),g}}}(e,t,Q,k,z,W),te=function(e){if(e&&e.FormType){var t=Object(m.a)(e.FormType);return b.x+"."+b.y+"."+t}return""}(z),re=G(H,2),ne=G(H,4);return function(t){return{type:"retrieveControlMetadataAndData.loadControl",execute:function(i){var s=i.dispatch,p=function(e,t){if(e&&t&&t.hasGrid&&t.control&&t.controlParameters){var r=[];return r.push({name:"FormId",value:a.a.toString(e.Id)}),r.push({name:"ViewId",value:t.viewId}),r.push({name:"IsUserView",value:t.controlParameters.IsUserView}),r.push({name:"ControlId",value:t.control.Id}),r}return null}(z,t),h=ne(t)&&Object(c.b)(e()),g=[],m=[],f=t.hasGrid&&t.ribbonContext&&t.contextToken&&Object(C.c)(k,t.contextToken),b=t.entityLogicalName,y=Y[b];if(!y){var v=U&&U(b);y=s(Object(l.f)(b,v,[])),Y[b]=y}var _=[],S=t.hasChart&&h&&Z(s,t,_);m.push.apply(m,_),S&&g.push.apply(g,S);var O=[],I=t.hasGrid&&$(s,t,O);m.push.apply(m,O),I&&(g.push.apply(g,I),0===t.gridType&&Promise.all(O).catch((function(e){r.ReportComponentFailure(te,e,null,p)})));var j=q&&q(t,m);j&&g.push.apply(g,j);var P=Promise.all(Object(n.__spreadArrays)([y],m)).then((function(){var n=Object(u.h)(e(),b);if(!n||n.Initialized!==o.a.Initialized||n.IsEnabledInUnifiedInterface&&Object(d.g)(e(),b,2,0)){var i=Object(c.b)(e())&&h,a=[],l=t.hasChart&&i&&J(s,t);l&&a.push(l);var g=t.hasGrid&&ee(s,t,f,ne(t),re(t));return g&&(a.push.apply(a,g),0===t.gridType&&Promise.all(g).then((function(){r.ReportComponentSuccess(te,p)}),(function(e){r.ReportComponentFailure(te,e,null,p)}))),Promise.all(a)}}));return g.push(P),Promise.all(g)}}}}(e,r,z,W,H,U,X,K,Q,Y,Z),te=G(X,1),re=G(X,0);for(var ne in q){var ie=q[ne];if(te(ie))J.push(t(ee(ie)));else if(!re(ie)){var ae=Object(k.a)(ee(ie));$.push(t(ae))}}return{inProgress:J,preload:$}}function G(e,t){return 0===t?function(t){return 0===e(t)}:function(r){return!!(e(r)&t)}}},FGem:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="attribute.options.clear";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r){var a=Object(n.x)(t);return{type:i,payload:void 0,meta:{pageId:e,contextKey:a,dataFieldName:r}}}},FPMG:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o}));var n=r("Sscr"),i=r("uO/V"),a="dataset.update.pagingdata";function o(e,t,r){return{type:"dataset.update.pagingdata.async",execute:function(o,s){var c=o.dispatch,l=(o.getState,s.TraceManager.getTracer(i.z)),u=i.x+".updatePagingDataAction";try{return l.info("Updating the paging data for the grid."),c(function(e,t,r){var i=Object(n.y)(t),o=Object(n.v)(t);return{type:a,payload:r,meta:{pageId:e,contextKey:i,dataSetContextKey:o}}}(e,t,r)),s.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){var d="Updation of paging data for the grid failed with error : "+e.message;s.EventManager.ReportComponentFailure(u,Error(d))}}}}},FlM9:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return p}));var n=r("qC0c"),i=r("cZkS"),a=r("sOTk"),o=r("/eNh"),s=r("t8f4"),c=r("QAhb");var l=r("Ww2r"),u=r("JlqV");function d(e,t,r,d,p){var m=Object(n.a)(e.getState(),i.F)&&Object(u.b)(e.getState()),f=Object(a.g)(e.getState(),r);return m&&f&&"connectionrole"===f.entityTypeName&&f.id?{Icon:"ConnectionRoleManageRecordType",DisplayText:Object(l.c)(p,h),Tooltip:{title:Object(l.c)(p,g),description:Object(l.c)(p,g)},Id:"manageRecordTypes",execute:function(){return t=e.dispatch,n=f.id,t(function(e,t){return{type:"open.manage.resource.type.dialog",execute:function(r,n,i){var a=r.dispatch,l=(r.getState,new c.a("connectionrole",e)),u=[{name:"recordId",value:e.guid}];return a(Object(s.d)(l,"?$expand=connection_role_connection_role_object_type_codes")).then((function(r){if(r&&r.connection_role_connection_role_object_type_codes){var i=r.connection_role_connection_role_object_type_codes,s=[],c=r.statecode;i.map((function(e){s.push({LogicalName:e.associatedobjecttypecode,connectionroleobjecttypecodeid:e.connectionroleobjecttypecodeid})}));var l={param_recordId:e,param_selectedEntities:JSON.stringify(s),param_stateCode:c},d={height:480,width:320};return a(Object(o.b)("ConnectionRoleManageRecordTypesDialog",d,l,t)).then((function(e){n.EventManager.ReportComponentSuccess("ConnectionRoleManageRecordTypesDialog",u)}))}}),(function(e){n.EventManager.ReportComponentFailure("ConnectionRoleManageRecordTypesDialog",e,null,u)}))}}}(n,r)).then((function(){return{}}));var t,n}}:null}function p(e,t){var r=Object(n.a)(e,i.F)&&Object(u.b)(e),o=Object(a.g)(e,t);return r&&o&&"connectionrole"===o.entityTypeName?m:[]}var h="ConnectionRole_EntityPickerMDD_Button_Label",g="ConnectionRole_EntityPickerMDD_Button_Description",m=[h,g]},FuJ2:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return p}));var n=r("sOTk"),i=r("UOiB"),a=r("Sscr"),o=r("krRo"),s=r("HSdq"),c=r("ObKm"),l=r("yHpA"),u=r("9rlF"),d="attribute.requiredLevel";function p(e,t,r,p){return{type:"attribute.requiredLevel.validation",sync:!0,execute:function(h,g){var m,f=h.getState();if(p!==Object(s.pc)(f,e,t,r)){h.dispatch(function(e,t,r,n){if(t&&t.contextTokenType&&t.contextTokenType===i.a.GridRow)return Object(o.f)(e,t,r,n);var s=Object(a.x)(t);return{type:d,payload:n,meta:{pageId:e,contextKey:s,dataFieldName:r}}}(e,t,r,p));var b=Object(s.ac)(f,e,t),y=Object(l.b)(f,b);if((0===p||3===p)&&y&&y.activeChanges&&y.activeChanges[r]||t&&t.contextTokenType&&t.contextTokenType===i.a.GridRow){var v=null,_=null,S=null,O=null;if(t&&t.contextTokenType&&t.contextTokenType===i.a.GridRow)v=t.entityTypeName?t.entityTypeName:null,_=t.recordId?t.recordId:null,S=Object(a.t)(t),O=Object(a.r)(t);else{var C=Object(n.g)(f,e);v=C&&C.entityTypeName?C.entityTypeName:null,_=C&&C.id?C.id:null,S=null,O=t}var I=Object(l.d)(f,b,{etn:v,id:_},r);if(Object(s.Uc)(I)){var j=((m={})[r]={fieldName:r,value:I?I.formatted?I:Object(u.e)(I):I},m);h.dispatch(Object(c.a)(e,j,!0,!0,v,_?_.guid:null,S,O))}}}}}}},G9wF:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return u}));var n,i=r("c/eZ"),a=r("Zy0S"),o=r("ixd0"),s=r("i8/j"),c=r("9r0m"),l=r("1z64"),u=function(){function e(e,t,r,i,a,c,u){void 0===c&&(c=s.n),void 0===u&&(u=o.a),this._formId=r,n=e,this._entityName=i,this._pageId=a,this._getSelectorItems=c,this._selectorItemType=u,this._clientApiExecutor=new l.a(e,"ClientApi.XrmControlFormSelector.",a,t)}return Object.defineProperty(e.prototype,"items",{get:function(){var e=this;return this._clientApiExecutor.execute("items_get",(function(t){if(!e._items){e._items=new a.a(t);var r=e._getSelectorItems(n.getState(),e._entityName);if(r)for(var i in r){var o=r[i],s=o.name||o.DisplayName,l=new e._selectorItemType(new c.a(i),s,n,e._pageId);e._items.add(l.getId(),l)}}return e._items}))},enumerable:!1,configurable:!0}),e.prototype.getCurrentItem=function(){var e=this;return this._clientApiExecutor.execute("getCurrentItem",(function(){for(var t=e.items,r=0;r<t.getLength();r++){var n=t.get(r);if(n.getId()===c.a.toString(e._formId))return n}return null}))},e}(),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t}(u)},Gh4N:function(e,t,r){"use strict";var n,i;r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i})),function(e){e[e.xSmall=0]="xSmall",e[e.small=1]="small",e[e.medium=2]="medium",e[e.large=3]="large"}(n||(n={})),function(e){e[e.normal=0]="normal",e[e.large=1]="large"}(i||(i={}))},Gt1u:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="form.setFormLoadError";function i(e,t){return{type:n,payload:{error:t},meta:{pageId:e}}}},GueY:function(e,t,r){"use strict";r.d(t,"a",(function(){return te}));var n=r("c/eZ"),i=r("1z64"),a=r("HSdq"),o=r("ezfI"),s=r("Zy0S"),c=r("+ieV"),l=r("2p2B"),u=r("0MLN"),d=r("9r0m"),p=r("G9wF"),h=r("ar+e"),g=r("PhZR"),m=r("YOvo"),f=r("+Z9T"),b=r("IiPO"),y=r("/W63"),v=r("s0Zj"),_=r("Sscr");var S,O,C,I,j,P,F=r("7EJx"),T=function(){function e(e,t,r,n){var i="ClientApi.XrmNavigationItem.constructor";e||Object(f.j)(i,"store"),r||Object(f.j)(i,"pageId"),t||Object(f.j)(i,"contextToken"),Object(f.a)(n)&&Object(f.j)(i,"id"),S=e,this._pageId=r,this._id=n,this._contextToken=t}return e.prototype.getId=function(){return o.a.instance.reportUsage("ClientApi.XrmNavigationItem.getId"),this._id},e.prototype.getLabel=function(){var e="ClientApi.XrmNavigationItem.getLabel";try{o.a.instance.reportCall(e);var t=Object(a.Rb)(S.getState(),this._pageId,this._id);return o.a.instance.reportSuccess(e),t}catch(t){var r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getVisible=function(){var e="ClientApi.XrmNavigationItem.getVisible";try{o.a.instance.reportCall(e);var t=Object(a.Ub)(S.getState(),this._pageId,this._id);return o.a.instance.reportSuccess(e),t}catch(t){var r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.setFocus=function(){var e,t,r,n="ClientApi.XrmNavigationItem.setFocus";try{o.a.instance.reportCall(n),S.dispatch((e=this._pageId,t=this._contextToken,r=this._id,{type:"forms.selectnavigationtab",sync:!0,execute:function(n,i,a){var o=n.dispatch,s=n.getState,c=Object(h.d)(s(),e,r);if(c){c.isSelected=!0;var l=Object(_.a)(t,c.relationshipName,c.ordinal);o(Object(v.b)(e,void 0,t)),o(Object(y.a)(e,l,c))}else i.TraceManager.getTracer("Forms.SelectNavigationTab").error("Could not find relatedEntityInfo to select")}})),o.a.instance.reportSuccess(n)}catch(e){var i=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(n,e,null,i),e}},e.prototype.setLabel=function(e){var t="ClientApi.XrmNavigationItem.setLabel";try{if(o.a.instance.reportCall(t),!Object(f.a)(e)){var r=Object(F.s)(S.getState());S.dispatch(Object(g.b)(this._pageId,this._id,e,r))}o.a.instance.reportSuccess(t)}catch(e){var n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.setVisible=function(e){var t="ClientApi.XrmNavigationItem.setVisible";try{o.a.instance.reportCall(t),S.dispatch(Object(m.b)(this._pageId,this._id,!0===e)),o.a.instance.reportSuccess(t)}catch(e){var r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,r),e}},e}(),w=function(){function e(e,t,r){r||Object(f.j)("ClientApi.XrmFormNavigation.constructor","pageId"),e||Object(f.j)("ClientApi.XrmFormNavigation.constructor","store"),O=e,this._pageId=r,this._contextToken=t}return Object.defineProperty(e.prototype,"items",{get:function(){var e=this,t="ClientApi.XrmFormNavigation.items";try{if(o.a.instance.reportCall(t),!this._items){this._items=new s.a(t);var r=Object(h.f)()(O.getState(),{id:this._pageId});r&&r.forEach((function(t){t&&t.relatedItems&&t.relatedItems.forEach((function(t){t&&t.id&&e._items.add(t.id,new T(O,e._contextToken,e._pageId,t.id))}))}))}return o.a.instance.reportSuccess(t),this._items}catch(e){var n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}},enumerable:!1,configurable:!0}),e}(),E=r("ll2N"),x=r("oPeH"),N=r("e2rP"),A=r("SdPQ"),k=r("lwSE"),M=r("7ipg"),D=function(e){function t(r,n,i,a){var o=e.call(this,r,n,i,t.NAME,null,a)||this;return C=r,o._clientApiExecutor=new M.b(C,"ClientApi.XrmHeaderSection.",n),o}return Object(n.__extends)(t,e),t.prototype.getLabel=function(){return o.a.instance.reportUsage("ClientApi.XrmHeaderSection.getLabel"),""},t.prototype.getVisible=function(){return o.a.instance.reportUsage("ClientApi.XrmHeaderSection.getVisible"),!0},t.prototype.setLabel=function(e){o.a.instance.reportUsage("ClientApi.XrmHeaderSection.setLabel")},t.prototype.setVisible=function(e){o.a.instance.reportUsage("ClientApi.XrmHeaderSection.setVisible")},t.prototype.getControlsDescriptor=function(e){var t=Object(a.tb)(e,{id:this.pageId},this.contextToken),r={};if(t)for(var n=0;n<t.length;n++){var i=t[n];r[i.Name]=i}return r},t.prototype.setCommandBarVisible=function(e){var t=this;this._clientApiExecutor.execute("setCommandBarVisible",(function(){C.dispatch(Object(N.b)(t.pageId,t.contextToken,e))}),[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])},t.prototype.getCommandBarVisible=function(){var e=this;return this._clientApiExecutor.execute("getCommandBarVisible",(function(){var t;return null===(t=Object(x.f)(C.getState(),e.pageId,e.contextToken))||void 0===t?void 0:t.commandBarVisible}))},t.prototype.setBodyVisible=function(e){var t=this;this._clientApiExecutor.execute("setBodyVisible",(function(){C.dispatch(Object(A.b)(t.pageId,t.contextToken,e))}),[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])},t.prototype.getBodyVisible=function(){var e=this;return this._clientApiExecutor.execute("getCommandBarVisible",(function(){var t;return null===(t=Object(x.f)(C.getState(),e.pageId,e.contextToken))||void 0===t?void 0:t.bodyVisible}))},t.prototype.setTabNavigatorVisible=function(e){var t=this;this._clientApiExecutor.execute("setTabNavigatorVisible",(function(){C.dispatch(Object(k.b)(t.pageId,t.contextToken,e))}),[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])},t.prototype.getTabNavigatorVisible=function(){var e=this;return this._clientApiExecutor.execute("getTabNavigatorVisible",(function(){var t;return null===(t=Object(x.f)(C.getState(),e.pageId,e.contextToken))||void 0===t?void 0:t.tabNavigatorVisible}))},t.NAME="Header",t}(E.a),R=r("cQE4"),B=r("uCYK"),L=function(e){function t(r,n,i,a){var o=e.call(this,r,n,i,t.NAME,null,a)||this;return I=r,o._clientApiExecutor=new M.b(I,"ClientApi.XrmFooterSection.",n),o}return Object(n.__extends)(t,e),t.prototype.getLabel=function(){return o.a.instance.reportUsage("ClientApi.XrmFooterSection.getLabel"),""},t.prototype.getVisible=function(){var e=this;return this._clientApiExecutor.execute("getVisible",(function(){var t;return null===(t=Object(R.a)(I.getState(),e.pageId,e.contextToken))||void 0===t?void 0:t.visible}))},t.prototype.setLabel=function(e){o.a.instance.reportUsage("ClientApi.XrmFooterSection.setLabel")},t.prototype.setVisible=function(e){var t=this;this._clientApiExecutor.execute("setVisible",(function(){I.dispatch(Object(B.b)(t.pageId,t.contextToken,e))}),[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])},t.prototype.getControlsDescriptor=function(e){var t=Object(a.Z)(e,{id:this.pageId},this.contextToken),r={};if(t)for(var n=0;n<t.length;n++){var i=t[n];r[i.Name]=i}return r},t.NAME="Footer",t}(E.a),V=r("RYq1"),z=r("sOTk"),G=r("gk6Q"),W=r("m8A1"),H=r("03gN"),U=r("kvLG"),q=function(){function e(e,t,r,n){var i="ClientApi.XrmProcessControlUI.constructor";n||Object(f.j)(i,"entity"),t||Object(f.j)(i,"contextToken"),r||Object(f.j)(i,"pageId"),e||Object(f.j)(i,"store"),j=e,this._pageId=r;var a=!1;if(Object(W.d)(j.getState(),this._pageId,i)){var o=Object(z.g)(j.getState(),this._pageId);this._processManager=Object(G.b)(this._pageId,o),a=!0}this._contextToken=t;var s=Object(W.b)(r,e.getState(),a);U.a.getInstance().eventManager.ReportComponentSuccess(i,s)}return e.prototype.getDisplayState=function(){var e="ClientApi.XrmProcessControlUI.getDisplayState";try{if(o.a.instance.reportCall(e),!Object(W.d)(j.getState(),this._pageId,e))return o.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getDisplayState();return o.a.instance.reportSuccess(e),t}catch(t){var r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getVisible=function(){var e="ClientApi.XrmProcessControlUI.getVisible";try{if(o.a.instance.reportCall(e),!Object(W.d)(j.getState(),this._pageId,e))return o.a.instance.reportSuccess(e),!1;var t=this._getProcessManager().isVisible();return o.a.instance.reportSuccess(e),t}catch(t){var r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.setDisplayState=function(e){var t="ClientApi.XrmProcessControlUI.setDisplayState";try{if(o.a.instance.reportCall(t),!Object(W.d)(j.getState(),this._pageId,t))return void o.a.instance.reportSuccess(t);e!==H.a.collapsed&&e!==H.a.expanded&&e!==H.a.floating||this._getProcessManager().setDisplayState(e),o.a.instance.reportSuccess(t)}catch(e){var r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.setVisible=function(e){var t="ClientApi.XrmProcessControlUI.setVisible";try{if(o.a.instance.reportCall(t),!Object(W.d)(j.getState(),this._pageId,t))return void o.a.instance.reportSuccess(t);this._getProcessManager().setVisible(e),o.a.instance.reportSuccess(t)}catch(e){var r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.reflow=function(e,t,r){var n="ClientApi.XrmProcessControlUI.reflow";try{if(o.a.instance.reportCall(n),!Object(W.d)(j.getState(),this._pageId,n))return void o.a.instance.reportSuccess(n);this._getProcessManager().reflow(e,t,r),o.a.instance.reportSuccess(n)}catch(e){var i=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(n,e,null,i),e}},e.prototype._getProcessManager=function(){return this._processManager||(this._processManager=Object(W.c)(this._processManager,j,this._pageId,"ClientApi.XrmProcessControlUI.getProcessManager")),this._processManager},e}(),X=r("w/nD"),K=r("UGbr"),Q=r("yHpA"),Y=r("cAHA"),Z=r("9qYn"),J=r("yZTI"),$=r("0hCf"),ee=r("zPLw"),te=function(e){function t(t,r,n,a,o,s){var c=this;return P=t,(c=e.call(this,t,r,n,a,o,s,p.a)||this)._clientApiExecutorFormUI=new i.a(t,"ClientApi.XrmFormUI.",n,r),c._clientApiExecutorFormUI.addEventParameter({name:"entityName",value:o,isEventParam:!0}),c}return Object(n.__extends)(t,e),Object.defineProperty(t.prototype,"headerSection",{get:function(){var e="ClientApi.XrmFormUI.headerSection";try{return o.a.instance.reportCall(e),this._headerSection||(this._headerSection=new D(P,this.contextToken,this.pageId,this.formContext)),o.a.instance.reportSuccess(e),this._headerSection}catch(t){throw this._reportFailure(e,t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"footerSection",{get:function(){var e="ClientApi.XrmFormUI.footerSection";try{return o.a.instance.reportCall(e),this._footerSection||(this._footerSection=new L(P,this.contextToken,this.pageId,this.formContext)),o.a.instance.reportSuccess(e),this._footerSection}catch(t){throw this._reportFailure(e,t)}},enumerable:!1,configurable:!0}),t.prototype.addControls=function(e){var t=b.a.getInstance().getEventParameters(this.contextToken),r={name:"controlName",value:""};for(var n in t.push(r),e)if(e[n]){r.value=n;var i=this.xrmControlFactory.createXrmControl(this.contextToken,e[n],this.formContext,"ClientApi.XrmFormUI.addControls",t);i&&this.controls.add(i.getName(),i)}},Object.defineProperty(t.prototype,"navigation",{get:function(){var e="ClientApi.XrmFormUI.navigation";try{return o.a.instance.reportCall(e),this._navigation||(this._navigation=new w(P,this.contextToken,this.pageId)),o.a.instance.reportSuccess(e),this._navigation}catch(t){throw this._reportFailure(e,t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"process",{get:function(){var e="ClientApi.XrmFormUI.process_get";try{o.a.instance.reportCall(e);var t=!!this._process;!this._process&&this.formContext.data&&this.formContext.data.entity&&(this._process=new q(P,this.contextToken,this.pageId,this.formContext.data.entity));var r=Object(W.a)(this.pageId,P.getState(),t,!(!this.formContext.data||!this.formContext.data.entity));return U.a.getInstance().eventManager.ReportComponentSuccess(e,r),o.a.instance.reportSuccess(e),this._process}catch(t){throw this._reportFailure(e,t)}},set:function(e){var t=Object(W.a)(this.pageId,P.getState(),!!this._process,!(!this.formContext.data||!this.formContext.data.entity));U.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmFormUI.process_set",t),this._process=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"quickForms",{get:function(){var e="ClientApi.XrmFormUI.quickForms";try{return o.a.instance.reportCall(e),this._quickForms||(this._quickForms=new s.a(e),this.controls),o.a.instance.reportSuccess(e),this._quickForms}catch(t){throw this._reportFailure(e,t)}},enumerable:!1,configurable:!0}),t.prototype.clearFormNotification=function(e){var t="ClientApi.XrmFormUI.clearFormNotification";try{o.a.instance.reportCall(t);var r=P.dispatch(Object(l.b)(this.contextToken,this.pageId,e));return o.a.instance.reportSuccess(t),r}catch(e){throw this._reportFailure(t,e)}},t.prototype.close=function(){try{o.a.instance.reportCall("ClientApi.XrmFormUI.close"),Object(Z.a)(Object(J.b)(P.getState())===this.pageId)||P.dispatch(Object(V.e)(this.pageId)),o.a.instance.reportSuccess("ClientApi.XrmFormUI.close")}catch(e){throw this._reportFailure("ClientApi.XrmFormUI.close",e)}},t.prototype.getFormType=function(){var e=this;return this._clientApiExecutorFormUI.execute("getFormType",(function(t,r){var n=e.getFormDescriptor(t,r);if(n){var i=e.formContext;if(i&&i.data&&i.data.entity&&Object(a.Lb)(P.getState(),i.data.entity.getEntityName(),d.a.tryParse(i.data.entity.getId())))return 4;if(Object(a.kb)(P.getState(),{id:e.pageId},e.contextToken))return 3;if(6===n.FormType)return 3;var o=Object(a.ac)(P.getState(),e.pageId,e.contextToken);if(o){var s=Object(Q.b)(P.getState(),o);return s?s.mode===Y.a.Create?1:2:(r.push({name:"snapshotID",value:o}),e._clientApiExecutorFormUI.reportFailure(t+".getSnapshot",new Error("Snapshot is null or undefined"),r),0)}return i&&i.data&&i.data.entity&&!d.a.tryParseOrNull(i.data.entity.getId())?1:2}return 0}))},t.prototype.isDialog=function(){var e=this;return this._clientApiExecutorFormUI.execute("isDialog",(function(){return Object(z.f)(P.getState(),e.pageId)}))},t.prototype.getViewPortHeight=function(){var e="ClientApi.XrmFormUI.getViewPortHeight";try{o.a.instance.reportCall(e);var t=Object(a.qb)(P.getState(),{id:this.pageId},this.contextToken);return o.a.instance.reportSuccess(e),t}catch(t){throw this._reportFailure(e,t)}},t.prototype.getViewPortWidth=function(){var e="ClientApi.XrmFormUI.getViewPortWidth";try{o.a.instance.reportCall(e);var t=Object(a.rb)(P.getState(),{id:this.pageId},this.contextToken);return o.a.instance.reportSuccess(e),t}catch(t){throw this._reportFailure(e,t)}},t.prototype.setFormEntityName=function(e){var t="ClientApi.XrmFormUI.setFormEntityName";Object(f.g)(e,t,"name");try{o.a.instance.reportCall(t),P.dispatch(Object(u.b)(this.pageId,this.contextToken,e)),o.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}},t.prototype.setFormNotification=function(e,t,r,n,i){var a=this;return this._clientApiExecutorFormUI.execute("setFormNotification",(function(o,s){var l;switch(Object(f.a)(r)&&(r="Random_String_"+Math.random()),t){case"ERROR":l=ee.a;break;case"WARNING":l=ee.e;break;case"INFORMATION":case"INFO":l=ee.b;break;default:Object(f.h)(o,"notificationLevel",t,s)}return!Object(f.a)(e)&&"string"==typeof e&&(P.dispatch(Object(c.c)(a.contextToken,a.pageId,e,l,r,n,i)),!0)}))},t.prototype.addOnLoad=function(e){var t="ClientApi.XrmFormUI.addOnLoad";Object(f.g)(e,t,"handler");try{o.a.instance.reportCall(t),P.dispatch(Object(X.f)(this.contextToken,this.pageId,e)),o.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}},t.prototype.removeOnLoad=function(e){var t="ClientApi.XrmFormUI.removeOnLoad";Object(f.g)(e,t,"handler");try{o.a.instance.reportCall(t),P.dispatch(Object(X.A)(this.contextToken,this.pageId,e)),o.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}},t.prototype.refresh=function(){var e=this,t="ClientApi.XrmFormUI.refresh";try{o.a.instance.reportCall(t);var r=Object(z.l)(P.getState(),this.pageId);return P.dispatch(Object(K.f)(this.pageId,r,!0,1,!0,!0)).then((function(r){return Object(Z.b)(e.formContext.data.entity),o.a.instance.reportSuccess(t),r})).catch((function(r){var n=b.a.getInstance().getEventParameters(e.contextToken);return Object(f.d)(P,r,t+".saveFormAndNavigate",n)}))}catch(e){var n=b.a.getInstance().getEventParameters(this.contextToken);return Object(f.d)(P,e,t,n)}},t.prototype._reportFailure=function(e,t){var r=b.a.getInstance().getEventParameters(this.contextToken);return b.a.getInstance().reportFailure(e,t,null,r),t},t}($.a);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},HRxj:function(e,t,r){"use strict";r.d(t,"a",(function(){return X}));var n=r("c/eZ"),i=r("nuS9"),a=r("NJzV"),o=r("4E+q"),s=r("Tr6b"),c=r("YWpA"),l=r("wV3W"),u=r("5olG"),d=r("LWFb"),p=r("Sscr"),h=r("ar+e"),g=r("/W63"),m=r("MLbG"),f=r("Vm/X"),b=r("mGpW"),y=r("Ww2r");var v=r("kyRo"),_=r("Ka9P"),S=r("uO/V"),O=r("dUXI"),C=function(e){function t(t){var r=e.call(this,t)||this;return r.onMeasuring=r.onMeasuring.bind(r),r.state={width:0},r}return Object(n.__extends)(t,e),t.prototype.onMeasuring=function(e){e>0&&e!==this.state.width&&this.setState({width:e})},t.prototype.render=function(){var e;if(!this.props.configuration)return null;var t=this.state.width,r=this.props.rowSpan*this.props.rowHeight,n={minWidth:t.toString()+"px",minHeight:r.toString()+"px"},o={width:t>0?t:-1,height:r>0?r:-1,eventListeners:[{eventname:"navigateToAssociatedGrid",eventhandler:[this._navigateToAssociatedGrid.bind(this)]}]};return i.createElement(c.a,{key:"FormCellChart_"+this.props.id,testhooks:{id:"FormCellChart_"+this.props.id},style:this.props.style,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0},this.state.width>0&&i.createElement(c.a,{key:"FormCellChart_"+this.props.id+"_container",style:n,id:this.props.domId,testhooks:(e={},e[d.b]=this.props.previewId,e[d.c]=20,e)},i.createElement(a.c,{key:this.props.key,controlId:this.props.controlId,id:this.props.id,systemDefinedProperties:this.props.customControlPropertyBag,configuration:this.props.configuration,descriptor:this.props.descriptor,parentDefinedControlProps:o})))},t.prototype._navigateToAssociatedGrid=function(){var e=this,t=this._getRelatedEntityItemForChart(this.props),r="FormCellChart.navigateToAssociatedGrid",n=[];if(!t){var i=this.props.descriptor&&this.props.descriptor.Parameters?this.props.descriptor.Parameters[S.F.RELATIONSHIP_NAME]:null,a=String.format(this.props.chartNavigationErrorDetail,i);return r="FormCellChart.openErrorDialog",n=[{name:"pageEtn",value:this.props.contextToken.parentContextToken.entityTypeName},{name:"associatedGridRelationship",value:i}],this.props.openErrorDialog(this.props.chartNavigationError,[a],this.props.id,"https://docs.microsoft.com/en-us/powerapps/maker/model-driven-apps/add-edit-form-navigation-related-entities").then((function(){e.context.EventManager.ReportComponentSuccess(r,n)}),(function(t){e.context.EventManager.ReportComponentFailure(r,t,"",n)}))}var o=Object(p.a)(this.props.contextToken.parentContextToken,t.relationshipName,t.ordinal);return n=[{name:"pageEtn",value:this.props.contextToken.parentContextToken.entityTypeName},{name:"associatedGridRelationship",value:t.relationshipName},{name:"associatedGridEntityName",value:t.entityName}],this.props.openRelatedGrid(this.props.id,o,t).then((function(){e.context.EventManager.ReportComponentSuccess(r,n)}),(function(t){e.context.EventManager.ReportComponentFailure(r,t,"",n)}))},t.prototype._getRelatedEntityItemForChart=function(e){if(!e.associatedGridsRelationshipInfo||0===e.associatedGridsRelationshipInfo.length)return null;var t=e.descriptor&&e.descriptor.Parameters?e.descriptor.Parameters[S.F.RELATIONSHIP_NAME]:null;if(!t)return null;var r=null;return e.associatedGridsRelationshipInfo.forEach((function(e){!r&&e&&e.relatedItems&&e.relatedItems.forEach((function(e){!e||e.relationshipName!==t||e.ordinal&&e.ordinal!==_.a.Referencing||(r=e)}))})),r?{id:r.id,title:r.title,entityName:r.entityName,isSelected:!0,relationshipName:r.relationshipName,url:r.url,ordinal:r.ordinal}:null},t}(i.Component);var I=Object(o.a)((function(){var e,t,r=(e=null,t=Object(h.f)(),function(r,n){return e||(e=t(r,{id:n.id})),e});return function(e,t){var n=Object(l.a)(e),i=Object(u.a)(n.sizes.Section.cellHeightInRem),a=r(e,t),o=Object(y.b)(e,O.k),s=Object(y.b)(e,O.l);return{rowHeight:i,associatedGridsRelationshipInfo:a,chartNavigationError:o,chartNavigationErrorDetail:s}}}),(function(e,t){return{openRelatedGrid:function(t,r,n){return e(Object(g.a)(t,r,n))},openErrorDialog:function(t,r,n,i){return e(function(e,t,r,n){return{type:"form.openFormChartErrorDialog",execute:function(i,a,o){var s=["ErrorIconAltInformation","Button_Label_OK","L_Show_Details_Text","L_Help_Label_Text"];return i.dispatch(Object(b.e)(s)).then((function(){var a=Object(y.e)(i.getState(),s),o=Object(y.c)(a,"ErrorIconAltInformation"),c=Object(y.c)(a,"Button_Label_OK"),l=Object(y.c)(a,"L_Show_Details_Text"),u={dynamicHelpLabel:Object(y.c)(a,"L_Help_Label_Text"),dynamicHelpURL:n};return i.dispatch(Object(m.a)(f.d,void 0,{type:"information"},void 0,o,e,c,l,t,!0,r,u))}))}}}(t,r,n,i))}}}))(C);C.contextType=v.a;var j=Object(o.a)((function(e){return{cellHeightInRem:Object(l.a)(e).sizes.Section.cellHeightInRem}}))((function(e){var t=window.innerWidth<=381?1.32:0,r={height:Object(u.a)(t+e.cellHeightInRem)+"px"};return i.createElement(c.a,{id:e.domId,testhooks:{id:e.controlName},style:r},e.disableWebResourceControlsMessage)})),P=r("NxDw"),F=r("swEE"),T=r("9r0m"),w=r("RlP9"),E=r("qC0c"),x=r("2OIc"),N=r("Gemh"),A=r("cZkS"),k=r("HSdq");var M=r("oY7N"),D=r("6ebE"),R=["OpenAssociatedGridViewImageButtonTooltip","OpenAssociatedGridViewImageButtonText","OpenAllRecordsViewImageButtonText","OpenAllRecordsViewImageButtonToolTip"],B=r("Z1aD"),L=r("r2h9"),V=r("I0a0"),z=r("0hZT");function G(e){if(!e.associatedGridsRelationshipInfo||0===e.associatedGridsRelationshipInfo.length)return null;var t=e.descriptor&&e.descriptor.Parameters?e.descriptor.Parameters[S.F.RELATIONSHIP_NAME]:null;if(!t)return null;var r=null;return e.associatedGridsRelationshipInfo.forEach((function(e){!r&&e&&e.relatedItems&&e.relatedItems.forEach((function(e){!e||e.relationshipName!==t||e.ordinal&&e.ordinal!==_.a.Referencing||(r=e)}))})),r?{id:r.id,title:r.title,entityName:r.entityName,isSelected:!0,relationshipName:r.relationshipName,url:r.url,ordinal:r.ordinal}:null}var W=Object(o.a)((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){var e,t,r,n=(e=null,t=Object(h.f)(),function(r,n){return e||(e=t(r,{id:n.id})),e}),i=(r=null,function(e,t){if(r)return r;var n=t&&t.CustomControlId?t.CustomControlId:null;if(!n)return null;var i=Object(N.ab)(e,n),a=Object(x.e)(e,n);if(i&&a&&a.Properties.DataSetDefinitions&&a.Properties.DataSetDefinitions[i]&&a.Properties.DataSetDefinitions[i].CDSDataSetOptions){var o=a.Properties.DataSetDefinitions[i].CDSDataSetOptions;r={displayChart:!(!o.hasOwnProperty("displayChart")||!o.displayChart),displayCommandBar:!(!o.hasOwnProperty("displayCommandBar")||!o.displayCommandBar),displayIndex:!(!o.hasOwnProperty("displayIndex")||!o.displayIndex),displayQuickFind:!(!o.hasOwnProperty("displayQuickFind")||!o.displayQuickFind),displayViewSelector:!(!o.hasOwnProperty("displayViewSelector")||!o.displayViewSelector)}}return r});return function(e,t){var r=null,a=null;if(Object(E.c)(e,A.Fc)){var o=Object(w.c)(e,T.a.tryParse(t.descriptor.Parameters.ViewId));a="actioncard"===(a=o?o.entityLogicalName:null)?null:a,r=n(e,t)}var s=i(e,t.configuration),c=Object(k.Eb)(e,t.id);return{associatedGridsRelationshipInfo:r,gridEntityTypeName:a,subgridControlDataSetUIOptions:s,isInsideFormComponentInstance:c}}}),(function(e,t){return{openRelatedGrid:function(t,r,n){return e(Object(g.a)(t,r,n))},createXrm:function(t){return e(Object(D.b)(t))},openGrid:function(t,r){return e(Object(B.a)(z.a,r,t))}}}))((function(e){var t=e.controlName,r=e.id,n=e.rowSpan,a=i.useContext(v.a),o=Object(V.a)(R),s=!1,c=[],l=G(e);if(l&&!e.isInsideFormComponentInstance){var u={Icon:"TableLink",Tooltip:{title:Object(y.c)(o,"OpenAssociatedGridViewImageButtonTooltip")},DisplayText:Object(y.c)(o,"OpenAssociatedGridViewImageButtonText"),Id:"navigateToAssociatedGrid-"+l.relationshipName+"-"+e.id,WillOpenFlyout:!1,IsInFlyout:!0,Children:null,execute:function(){return function(e,t){var r=G(e);if(!r)return Promise.reject("related entity item not found for this button");var n=[{name:"pageEtn",value:e.contextToken.parentContextToken.entityTypeName},{name:"associatedGridRelationship",value:r.relationshipName},{name:"associatedGridEntityName",value:r.entityName}],i=Object(p.a)(e.contextToken.parentContextToken,r.relationshipName,r.ordinal);return e.openRelatedGrid(e.id,i,r).then((function(){t.EventManager.ReportComponentSuccess("ShowFullView.navigateToAssociatedGrid",n)}),(function(e){t.EventManager.ReportComponentFailure("ShowFullView.navigateToAssociatedGrid",e,"",n)}))}(e,a)}};c.push(u)}else if(e.gridEntityTypeName){var d={Icon:"TableGroup",Tooltip:{title:Object(y.c)(o,"OpenAllRecordsViewImageButtonToolTip")},DisplayText:Object(y.c)(o,"OpenAllRecordsViewImageButtonText"),Id:"navigateToGrid-"+e.id,WillOpenFlyout:!1,IsInFlyout:!0,Children:null,execute:function(){return function(e,t){var r={pageType:"entitylist",viewId:e.descriptor.Parameters.ViewId?new T.a(e.descriptor.Parameters.ViewId):null,entityTypeName:e.gridEntityTypeName,viewType:"true"===e.descriptor.Parameters.isUserView?L.b.userview:L.b.savedview},n=[{name:"pageEtn",value:e.contextToken.parentContextToken.entityTypeName},{name:"gridEtn",value:e.gridEntityTypeName},{name:"viewId",value:e.descriptor.Parameters.ViewId}];return e.openGrid(e.id,r).then((function(e){e&&0===e.status?t.EventManager.ReportComponentSuccess("ShowFullView.navigateToGrid",n):t.EventManager.ReportComponentFailure("ShowFullView.navigateToGrid",e.error,"",n)}))}(e,a)}};c.push(d)}var h={shouldRender:e.shouldRender,gridConfigurations:e.configurations,addedCommandListFromHostParent:c},g=null;return"MscrmControls.Grid.ReadOnlyGrid"===e.configuration.CustomControlId||"MscrmControls.Grid.GridControl"===e.configuration.CustomControlId||"MscrmControls.MailApp.MailAppListControl"===e.configuration.CustomControlId||"MscrmControls.Grid.ReadOnlyGrid"===e.configuration.Name||"MscrmControls.Grid.GridControl"===e.configuration.Name||"MscrmControls.MailApp.MailAppListControl"===e.configuration.Name?(g={displayChart:!0,displayCommandBar:!0,displayIndex:!0,displayQuickFind:!0,displayViewSelector:!0},s=!0):e.subgridControlDataSetUIOptions?(g=e.subgridControlDataSetUIOptions,e.subgridControlDataSetUIOptions.displayCommandBar&&(s=!0)):g={displayChart:!1,displayCommandBar:!1,displayIndex:!1,displayQuickFind:!1,displayViewSelector:!1},"MscrmControls.Calendar.CalendarControl"===e.configuration.Name&&(g.displayCommandBar=!0,s=!0),g.displayCommandBar=s,i.createElement(M.a,{key:r+t,id:r,previewId:e.previewId,controlId:t,contextString:S.h.SUBGRID,configuration:e.configuration,descriptor:e.descriptor,systemDefinedProperties:e.customControlPropertyBag,rowSpan:n,parentContextToken:e.parentContextToken,nonCompositionProps:h,formInfo:e.formInfo,dataSetUIOptions:g,parentDefinedControlProps:e.parentProps})})),H=r("uGUB"),U=r("HHlV"),q=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.onRenderCompleteCallback=n.onRenderCompleteCallback.bind(n),t.domId&&!r.AccessibilityManager.isClientAPISetFocusScheduled()&&(n._intersectionObserverHelper=t.intersectionObserverHelper),n.state={visibleToViewport:!n._intersectionObserverHelper||void 0},n}return Object(n.__extends)(t,e),t.prototype.componentDidMount=function(){this._observeCell(),this.onRenderCompleteCallback()},t.prototype.componentDidUpdate=function(){this._observeCell()},t.prototype._observeCell=function(){this._intersectionObserverHelper&&!this.state.visibleToViewport&&this._intersectionObserverHelper.observe(this)},t.prototype.componentWillUnmount=function(){this._intersectionObserverHelper&&this._intersectionObserverHelper.unobserve(this)},t.prototype.getDomId=function(){return this.props.domId},t.prototype.intersecting=function(){var e=this;this.state.visibleToViewport||Object(H.c)((function(){return e.setState({visibleToViewport:!0})}))},t.prototype.onRenderCompleteCallback=function(){this.props.shouldNotifyRenderComplete&&this.props.onRenderComplete()},t.prototype._transformStyle=function(){var e=this.props.defaultCellStyle;return this.props.style&&Object.keys(this.props.style).length>0&&(e=Object(n.__assign)(Object(n.__assign)({},e),this.props.style)),!1===this.props.isParentPaddingAdded&&1!==this.props.cellControlMode&&this.props.configuration.Name!==U.d&&(e=Object(n.__assign)(Object(n.__assign)({},e),this.props.extraSidePaddingStyle)),e},t.prototype.render=function(){return this.state.visibleToViewport&&!this.props.disableWebResourceControlsMessage?this._render():i.createElement(j,{controlName:this.props.controlName,domId:this.props.domId,disableWebResourceControlsMessage:this.props.disableWebResourceControlsMessage})},t.prototype._render=function(){var e,t,r,n;if(void 0!==this.props.overriddenVisibility&&!this.props.overriddenVisibility)return null;if(!this.props.descriptor||!this.props.informationAvailableToRender)return null;if(this.props.clientHost===P.a.MobileApplication&&void 0!==this.props.descriptor.Parameters.ShowOnMobileClient&&"false"===this.props.descriptor.Parameters.ShowOnMobileClient||this.props.clientHostSubtype===F.a.Phone&&null!==this.props.availableForPhone&&void 0!==this.props.availableForPhone&&!this.props.availableForPhone)return null;if(this.props.isCreateForm&&this.props.isRelatedDataSetControl&&!this.props.isPreviewMode)return null;var o=this.props,s=o.controlName,l=o.id,u=o.userSpacer,p=o.rowSpan;if(this._parentProps||(this._parentProps={parentInSeeMoreMode:this.props.inDialogWithZIndex,parentFlyoutId:this.props.parentFlyoutRoot}),u)return i.createElement(c.a,{id:this.props.domId,style:this.props.spacerCellStyle,testhooks:(e={},e[d.b]=this.props.previewId,e[d.c]=20,e["control-name"]=s,e)});if(!s)return null;if(2===this.props.cellControlMode)return i.createElement(c.a,{style:this._transformStyle(),testhooks:(t={},t["control-name"]=s,t),id:this.props.domId},i.createElement(I,{key:s+l,controlId:s,id:l,domId:this.props.domId,previewId:this.props.previewId,customControlPropertyBag:this.props.customControlPropertyBag,descriptor:this.props.descriptor,configuration:this.props.configuration,style:this._transformStyle(),rowSpan:p,contextToken:this.props.contextToken}));if(1===this.props.cellControlMode)return i.createElement(c.a,{style:this._transformStyle(),testhooks:(r={},r["control-name"]=s,r),id:this.props.domId},i.createElement(W,{key:s+l,controlName:s,id:l,previewId:this.props.previewId,customControlPropertyBag:this.props.customControlPropertyBag,descriptor:this.props.descriptor,configuration:this.props.configuration,configurations:this.props.configurations,rowSpan:p,isRemoteAvailable:this.props.isRemoteAvailable,isEntityEnabledForOffline:this.props.isEntityEnabledForOffline,parentProps:this._parentProps,contextToken:this.props.contextToken,parentContextToken:this.props.parentContextToken,shouldRender:this.props.shouldRender,formInfo:this.props.formInfo}));var h=this.props.configuration.Children&&this.props.configuration.Children.fieldControl,g=h?h.CustomControlId:this.props.configuration.CustomControlId,m=!1===this.props.useControlWrapper&&h?h:this.props.configuration;return i.createElement(c.a,{style:this._transformStyle(),testhooks:(n={id:s},n[d.b]=this.props.previewId,n[d.c]=20,n["control-name"]=s,n),id:this.props.domId},i.createElement(a.c,{key:s+l+g,controlId:s,id:l,systemDefinedProperties:this.props.customControlPropertyBag,descriptor:this.props.descriptor,configuration:m,rowSpan:p,formInfo:this.props.formInfo,shouldRender:this.props.shouldRender,parentContextToken:this.props.parentContextToken,parentDefinedControlProps:this._parentProps}))},t}(i.Component);q.displayName="Cell";var X=Object(o.a)(s.c)(q);q.contextType=v.a},HfRC:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("xc1f"),i=r("Z1aD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function a(e,t,r,a,o,s,c,l,u){var d={entityTypeName:e.etn,id:e.id,formId:r,data:a,processId:o,processInstanceId:s,selectedStageId:c,isCrossEntityNavigate:l,recordSetQueryKey:u};return Object(i.a)(n.a,d,t)}},I6xF:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));var n="powerbi.signedin.state";function i(e,t){return{type:n,payload:t,meta:{pageId:e}}}},IF6v:function(e,t,r){"use strict";r.d(t,"a",(function(){return F}));var n=r("c/eZ"),i=r("nuS9"),a=r("4E+q"),o=r("H/hG"),s=r("evW+"),c=r("pxbl"),l=r("Smta"),u=r("YWpA"),d=r("wV3W"),p=r("aPRd"),h=r("zt+H"),g=r("qC0c"),m=r("cZkS");var f=r("vTeb"),b=r("5aNC"),y=r("yotr"),v=r("XIN1"),_=r("znb3"),S=r("9rQ4"),O=r("Wi7Z"),C=r("zPLw"),I=r("Ww2r"),j=r("Ro59"),P=function(e){function t(t){var r=e.call(this,t)||this;return r._onButtonClick=r._onButtonClick.bind(r),r._onNotificationClick=r._onNotificationClick.bind(r),r.toggleExpandMessage=r.toggleExpandMessage.bind(r),r.onRenderCompleteCallback=r.onRenderCompleteCallback.bind(r),r.onKeyDownAnchorEvent=r.onKeyDownAnchorEvent.bind(r),r.onKeyDownEvent=r.onKeyDownEvent.bind(r),r.state={messageExpanded:!1},r._backgroundCanvas=document.createElement("canvas"),r}return Object(n.__extends)(t,e),t.prototype.toggleExpandMessage=function(e){e&&e.stopPropagation(),this.setState(Object(n.__assign)(Object(n.__assign)({},this.state),{messageExpanded:!this.state.messageExpanded}))},t.prototype._renderButtons=function(){var e=this.props.notification.Buttons,t=[];if(!e||0===e.length)return null;for(var r in e){var a=e[r],c=Object(b.b)(this.props.notification.UniqueId,r),l=0===t.length?this.props.buttonStyle:this.props.secondaryButtonStyle,d=Object(n.__assign)(Object(n.__assign)({},l),0===t.length?this.props.firstButtonStyle:{});if(t.push(i.createElement(s.a,{key:c,id:c,style:d,onClick:this._onButtonClick.bind(this,a),title:a.Label},i.createElement(o.a,{testhooks:{id:a.Label},style:0===t.length?this.props.buttonLabelStyle:this.props.secondaryButtonLabelStyle},a.Label))),t.length>2)break}return i.createElement(u.a,{key:"buttonWrapper",style:this.props.buttonWrapperStyle},t)},t.prototype._renderCloseButton=function(){return this.props.closeAction&&i.createElement(s.a,{onClick:this.props.closeAction,style:this.props.closeButtonStyle},i.createElement(v.b,{type:_.a.Cancel}))},t.prototype._renderMessage=function(e,t){var r=this.props.notification.MessagePlaceholders,n=[],a="",s=this.state.messageExpanded||!t?99:2;if(r&&r.length>0&&this._getPlacehoderCountInMessage()===r.length){var l=this.props.notification.Message.split(/{[0-9]+}/);for(var d in l){var p=l[d];if(n.push(p),a=a.concat(p),parseInt(d,10)<r.length){var h=r[parseInt(d,10)],g=Object(y.b)(this.props.notification.UniqueId,d);a=a.concat(h.Label),h.Handler?n.push(i.createElement(f.a,{key:g,id:g,style:this.props.placeHolderLinkStyle,href:null,onClick:this._onButtonClick.bind(this,h)},h.Label)):n.push(h.Label)}}}return i.createElement(u.a,{key:"message",style:this.props.notificationType===C.a?this.props.notificationErrorMessageStyle:this.props.notificationMessageStyle},i.createElement(c.a,{noExpandable:!0,truncatedlines:s,testhooks:{id:"warningNotification"}},n&&n.length>0?n:this.props.notification.Message,e&&this.state.messageExpanded?i.createElement(o.a,{onClick:this.toggleExpandMessage,style:this.props.notificationExpandTextStyle,tabIndex:0,onKeyDown:this.onKeyDownEvent},this._notificationLongMessageTruncate()):null),e&&!this.state.messageExpanded?i.createElement(o.a,{onClick:this.toggleExpandMessage,style:this.props.notificationExpandTextStyle,tabIndex:0,onKeyDown:this.onKeyDownEvent},this._notificationLongMessageExpand()):null)},t.prototype._getPlacehoderCountInMessage=function(){return(this.props.notification.Message.match(/{[0-9]+}/g)||[]).length},t.prototype._onButtonClick=function(e,t){t.preventDefault(),this.props.buttonOnClick(e)},t.prototype._notificationLongMessageTruncate=function(){return Object(I.c)(this.props.resourceStrings,j.c)},t.prototype._notificationLongMessageExpand=function(){return Object(I.c)(this.props.resourceStrings,j.b)},t.prototype._getMessageIcon=function(e,t){switch(e){case C.a:return i.createElement(u.a,{accessibilityHidden:!0,style:this.props.errorIconStyleWrapper},i.createElement(v.b,{style:this.props.notificationIconStyle,id:"notification_icon_"+t,type:_.a.MarkAsLost}));case C.e:return i.createElement(u.a,{accessibilityHidden:!0,style:this.props.warningIconStyleWrapper},i.createElement(v.b,{style:this.props.notificationIconStyle,id:"notification_icon_"+t,type:_.a.Warning}));case C.d:return i.createElement(u.a,{accessibilityHidden:!0,style:this.props.successIconStyleWrapper},i.createElement(v.b,{style:this.props.notificationIconStyle,id:"notification_icon_"+t,type:_.a.SuccessIcon}));case C.c:return i.createElement(u.a,{accessibilityHidden:!0,style:this.props.infoIconStyleWrapper},i.createElement(v.b,{style:this.props.notificationIconStyle,id:"notification_icon_"+t,type:_.a.Locked,testhooks:{id:"formReadOnlyIcon"}}));default:return i.createElement(u.a,{accessibilityHidden:!0,style:this.props.infoIconStyleWrapper},i.createElement(v.b,{style:this.props.notificationIconStyle,id:"notification_icon_"+t,type:_.a.InformationIcon}))}},t.prototype.onRenderCompleteCallback=function(){this.props.shouldNotifyRenderComplete&&this.props.onRenderComplete()},t.prototype.componentDidMount=function(){this.onRenderCompleteCallback()},t.prototype.onKeyDownEvent=function(e){e.keyCode===S.a.Escape?this.props.keyDownHandler(e):e.keyCode===S.a.Enter&&this.toggleExpandMessage()},t.prototype.onKeyDownAnchorEvent=function(e){e.keyCode===S.a.Escape?this.props.keyDownHandler(e):e.keyCode===S.a.Enter&&this._onNotificationClick()},t.prototype._onNotificationClick=function(){this.props.notification.OnNotificationClick&&(!this.props.onlyNotification&&this.props.toggleFlyout&&this.props.toggleFlyout(),this.props.notificationClick())},t.prototype._isLongMessage=function(){var e=this._backgroundCanvas.getContext("2d");return e.font=this.props.notificationMessageStyle.fontSize&&this.props.notificationMessageStyle.fontFamily,e.measureText(this.props.notification.Message).width/this.props.domWidth>=2},t.prototype.render=function(){var e=this._isLongMessage(),t=!this.props.useSeeMoreBtn&&e,r=Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},this.props.formNotificationStyle),this.props.displayFullMessage?{maxHeight:"none"}:{}),{":hover":{backgroundColor:this.props.notification.OnNotificationClick||t?"#F3F2F1":""},cursor:this.props.notification.OnNotificationClick||t?"pointer":"default"});return i.createElement(l.a,{key:"Notification_"+this.props.notification.UniqueId,style:r,onClick:this.props.notification.OnNotificationClick?this._onNotificationClick.bind(this):void 0,onKeyDown:this.props.notification.OnNotificationClick?this.onKeyDownAnchorEvent:this.onKeyDownEvent,role:!this.props.onlyNotification||"ERROR"!==this.props.notification.Level&&"INFORMATION"!==this.props.notification.Level&&"WARNING"!==this.props.notification.Level?void 0:O.a},i.createElement(o.a,{key:"text",style:this.props.messageIconWrapperStyle},i.createElement(o.a,{style:this.props.messageIconStyle,accessibilityHidden:!0},this._getMessageIcon(this.props.notification.Level,this.props.notification.Message))),i.createElement(u.a,{key:"notificationMessageAndButtons",id:"notificationMessageAndButtons",onClick:this.props.notification.OnNotificationClick||!t?void 0:this.toggleExpandMessage,style:this.props.notificationMessageAndButtonsStyle,isRequestedMeasuring:!!this.props.buttonMeasuringCallback,onMeasuring:this.props.buttonMeasuringCallback},this._renderMessage(this.props.useSeeMoreBtn&&e,e),this._renderButtons()),this._renderCloseButton())},t}(i.Component);P.displayName="FormNotification";var F=Object(a.a)((function(){var e,t,r,i,a,o=(e=null,t=null,r=null,i=!1,a=null,function(o,s){var c=Object(d.a)(o),l=Object(p.c)(o),u=Object(g.a)(o,m.ob);if(t!==c||r!==l||i!==s.onlyNotification||a!==s.notificationType){t=c,r=l,i=s.onlyNotification,a=s.notificationType;var f=s.notificationWidth<=c.sizes.Breakpoints.DimensionXS;e={formNotificationStyle:{display:"flex",width:"100%",flexDirection:"row",backgroundColor:s.onlyNotification?Object(h.d)(s.notificationType):"#FFFFFF",paddingRight:"10px",paddingLeft:"10px",minHeight:h.a+"px",height:"auto",lineHeight:c.sizes.Measures.Measure100,boxSizing:"border-box",overflow:"hidden",borderBottom:s.onlyNotification?"":"1px solid "+h.c},notificationMessageAndButtonsStyle:{display:"flex",flexDirection:"row",flexWrap:"wrap",width:"100%",paddingLeft:"9px",paddingRight:"9px"},notificationMessageStyle:{flexGrow:1,whiteSpace:"normal",padding:0,marginTop:"7px",marginBottom:"7px",lineHeight:"16px",overflow:"hidden",textOverflow:"ellipsis",fontSize:"12px",fontFamily:c.fontFamilies.Regular,color:"#1F2126"},notificationExpandTextStyle:{fontSize:"12px",whiteSpace:"nowrap",paddingTop:"16px",fontFamily:c.fontFamilies.Regular,color:"#0000FF",paddingLeft:"2px",paddingRight:"2px",cursor:"pointer"},notificationErrorMessageStyle:{flexGrow:1,whiteSpace:"normal",marginTop:"7px",marginBottom:"7px",lineHeight:"16px",overflow:"hidden",textOverflow:"ellipsis",fontSize:"12px",fontFamily:c.fontFamilies.Regular,color:"#1F2126"},buttonWrapperStyle:{marginBottom:"5px",maxWidth:"100%",flexWrap:f?"wrap":"nowrap",marginTop:"5px"},buttonStyle:{height:"21px",backgroundColor:"#6E6F77",border:"1px solid #6E6F77",boxSizing:"border-box",borderRadius:"2px",":hover":{border:"1px solid #3A3C42",boxSizing:"border-box",borderRadius:"2px",backgroundColor:"#3A3C42"}},secondaryButtonStyle:{height:"21px",backgroundColor:"#FFFFFF",border:"1px solid #6E6F77",boxSizing:"border-box",borderRadius:"2px",":hover":{border:"1px solid #A4A6AC",boxSizing:"border-box",backgroundColor:"#E8EAEC",borderRadius:"2px"}},buttonLabelStyle:Object(n.__assign)(Object(n.__assign)({},c.buttons.ButtonPrimaryText),{color:"#FFFFFF",lineHeight:"19px",fontSize:"12px"}),secondaryButtonLabelStyle:Object(n.__assign)(Object(n.__assign)({},c.buttons.ButtonSecondaryText),{color:"#1F2126",lineHeight:"19px",fontSize:"12px"}),placeHolderLinkStyle:{cursor:"pointer",color:c.colors.BaseColor.Blue.Blue3,padding:0},messageIconWrapperStyle:{boxSizing:"content-box",minWidth:u?"16px":"20px",height:u?"16px":"20px",position:"relative"},messageIconStyle:{position:"absolute",height:u?"16px":"20px",width:u?"16px":"20px",paddingTop:"9px"},firstButtonStyle:{marginRight:f?"0":"0.5rem"},errorIconStyleWrapper:{color:h.f},successIconStyleWrapper:{color:h.h},warningIconStyleWrapper:{color:h.i},infoIconStyleWrapper:{color:h.g},notificationIconStyle:{fontSize:"20px"},closeButtonStyle:{backgroundColor:"transparent",borderWidth:0,marginTop:"8px",height:"16px",fontSize:"16px",padding:0}}}return e}),s=Object(I.h)();return function(e,t){var r=o(e,t),i=s(e,j.f),a=Object(g.a)(e,m.ob);return Object(n.__assign)(Object(n.__assign)({},r),{resourceStrings:i,useSeeMoreBtn:a})}}),(function(e,t){return{buttonOnClick:function(t){t.Handler&&("function"==typeof t.Handler?t.Handler():e(t.Handler))},notificationClick:t.notification.OnNotificationClick&&function(){return e(t.notification.OnNotificationClick)},closeAction:t.notification.CloseAction&&function(){return e(t.notification.CloseAction)}}}))(P)},Ini7:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="attribute.removeOption";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r,a){var o=Object(n.x)(t);return{type:i,payload:a,meta:{pageId:e,contextKey:o,dataFieldName:r}}}},JFej:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="attribute.option.add";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r,a,o){var s=Object(n.x)(t);return{type:i,payload:{option:a,index:o},meta:{pageId:e,contextKey:s,dataFieldName:r}}}},JVfT:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o}));var n=r("Sscr"),i=r("uO/V"),a="update.grid.paging.refresh.input";function o(e,t){return{type:"update.grid.paging.refresh.input.async",execute:function(r,o){var s=r.dispatch,c=(r.getState,o.TraceManager.getTracer(i.z)),l=i.x+".updateGridPagingRefreshInputAction";try{var u=Object(n.u)(t);return s(function(e,t){return{type:a,payload:Math.floor(1e3*Math.random()),meta:{pageId:e,dataSetContextKey:t}}}(e,u)),c.info("Updating the grid pagingRefreshInput"),o.EventManager.ReportComponentSuccess(l),Promise.resolve()}catch(e){var d="Updating the grid pagingRefreshInput failed with error : "+e.message;o.EventManager.ReportComponentFailure(l,Error(d))}}}}},Jcuz:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("5fD4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t){var r={displayState:e};return{type:n.c,payload:r}}},Je7O:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n=function(){function e(){}return e.prototype.get_ErrorType=function(){return this._errorType},e.prototype.set_ErrorType=function(e){this._errorType=e},e.prototype.get_ErrorDescription=function(){return this._errorDescription},e.prototype.set_ErrorDescription=function(e){this._errorDescription=e},e}()},KDdL:function(e,t,r){"use strict";r.d(t,"f",(function(){return h})),r.d(t,"c",(function(){return m})),r.d(t,"d",(function(){return f})),r.d(t,"b",(function(){return g})),r.d(t,"e",(function(){return b})),r.d(t,"a",(function(){return y}));var n=r("9r0m"),i=r("G7N+"),a=r("dUXI"),o=r("8ADW"),s=r("y5DA"),c=r("lMVv"),l=r("Ww2r"),u=r("JlqV"),d=r("9rlF"),p=r("F2uj"),h=o.a;function g(e,t,r,i,d,p,g,m){return void 0===m&&(m=!1),function(e,t,r){if(!n.a.toString(r.viewId)){var i="viewid is required to call retrieve chart data";throw e.EventManager.ReportComponentFailure(h+".retrieveChartData",Error(i),o.d,t),new Error(i)}return!0}(r,i,d)&&function(e,t,r,i,o){if(!n.a.toString(r.visualizationId)||n.a.toString(r.visualizationId)===n.a.EMPTYGUIDSTRING){var u=e(),d=Object(l.b)(u,a.n),p=Object(c.f)(u,i)||i,h=String.format(d,p);return Object(s.a)(u,t,h,r,o),!1}return!0}(e,t,d,p,g)&&function(e,t,r,n){var i=e();if(!Object(u.b)(i)){var o=Object(l.b)(i,a.r);return Object(s.a)(i,t,o,r,n),!1}return!0}(e,t,d,g)&&function(e,t,r,n){if(r.isRollUpView){var i=e(),o=Object(l.b)(i,a.j);return Object(s.a)(i,t,o,r,n),!1}return!0}(e,t,d,g)&&(!m||function(e,t,r,n){if(!r.viewXml){var i=Object(l.b)(e(),a.g);return Object(s.a)(e(),t,i,r,n),!1}return!0}(e,t,d,g)&&function(e,t,r,n){if(!r.fetchXml){var i=Object(l.b)(e(),a.o);return Object(s.a)(e(),t,i,r,n),!1}return!0}(e,t,d,g))}function m(e,t,r){var a,o,s=new n.a(e),c=n.a.toString(s),l=new n.a(t),u=n.a.toString(l);return{type:r,payload:{charts:(a={},a[c]=(o={},o[u]={initialized:i.a.Initializing},o),a)}}}function f(e,t){var r;return{type:t,payload:{chartData:(r={},r[e]={initialized:i.a.Initializing},r)}}}function b(e,t,r){var n,i=null===(n=null==e?void 0:e.category)||void 0===n?void 0:n.primaryGroupBy,a=null==i?void 0:i.groupAttribute;if(function(e,t){var r;if(!e)return!1;var n=null===(r=null==e?void 0:e.entity)||void 0===r?void 0:r.entityName,i=null==e?void 0:e.attributeName,a=Object(p.b)(i,n,t);return"picklist"===a||"state"===a||"status"===a}(a,r)&&e.isOrderPresentOnPrimaryGroupBy()){var o=a.aliasName,s=new v(o);t.sort(s.comparator),i.descending&&t.reverse()}}function y(e){var t=/(Name=\"o\:)(\w+)(,)(\d+)(\")/,r=e.match(new RegExp(t,"g")),n=[];return r&&r.forEach((function(e){n=e.match(new RegExp(t,"m"))})),n}var v=function(){function e(e){var t=this;this._primaryGroupByAttributeAlias=null,this.comparator=function(e,r){return t._getRawValue(e)-t._getRawValue(r)},this._primaryGroupByAttributeAlias=e}return e.prototype._getRawValue=function(e){if(this._primaryGroupByAttributeAlias in e.fields){var t=e.fields[this._primaryGroupByAttributeAlias],r=Object(d.e)(t);return parseInt(r,10)}return-1},e}()},KZbu:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r("Sscr"),i=r("HSdq"),a=r("1Tfq"),o=r("RYq1"),s=r("71iK"),c=r("IQF2");function l(e,t){return{type:"cancel.quickCreateFormAction.async",execute:function(r,o){var s=r.dispatch,l=r.getState,d=l(),p=Object(n.j)(l(),e);return c.a.getInstance().checkForOutstandingWork(l()).then((function(){if(Object(i.Nb)(d,e,p))return s(Object(a.a)(e)).then((function(r){if(!r)return Promise.resolve({});u(s,e,t)}));u(s,e,t)}))}}}function u(e,t,r){if(r&&r.length>0){e(Object(o.e)(t,"save"));for(var n=[r[0].etn],i=1;i<r.length;i++){for(var a=!1,c=0;c<n.length;c++)n[c]===r[i].etn&&(a=!0);a||n.push(r[i].etn)}for(c=0;c<n.length;c++)e(Object(s.a)(n[c]))}else e(Object(o.e)(t))}},KbPJ:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="form.entityreferencebyrelationship";function i(e,t){return{type:n,payload:t,meta:{pageId:e}}}},Kdvm:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("9r0m"),i=function(){function e(){}return e.prototype.generate=function(e,t){return t&&t.getProcessId()?{businessProcessFlowInstanceId:t.getProcessInstanceId(),activeStageId:n.a.tryParseOrNull(t.getActiveStageId()),displayState:t.getDisplayState(),processState:t.getProcessState(),state:t.getState(),status:t.getStatus(),isVisible:t.isVisible(),data:{activePath:t.getActivePath(),selectedStageId:n.a.tryParseOrNull(t.getSelectedStageId()),businessProcessFlowId:t.getProcessId(),actionLogCollection:t.getActionLogCollection(),processNavigationBehavior:{navigationBehavior:t.getBpfNavigationBehavior()}}}:null},e}();
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},L4Zk:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r("c/eZ"),i=r("rFRM"),a=r("7JDo"),o=r("k6Yd"),s=r("1UTq"),c=Object(s.c)((function(e,t){var r,s,c,l,u,d,p,h,g,m,f=e.effects,b=e.palette,y=e.semanticColors,v={position:"absolute",width:1,right:31,top:8,bottom:8},_={splitButtonContainer:[Object(i.c)(e,{highContrastStyle:{left:-2,top:-2,bottom:-2,right:-2,border:"none"},inset:2}),{display:"inline-flex",selectors:{".ms-Button--default":{borderTopRightRadius:"0",borderBottomRightRadius:"0",borderRight:"none"},".ms-Button--primary":{borderTopRightRadius:"0",borderBottomRightRadius:"0",border:"none",selectors:(r={},r[a.b]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},r)},".ms-Button--primary + .ms-Button":{border:"none"}}}],splitButtonContainerHovered:{selectors:{".ms-Button--primary":{selectors:(s={},s[a.b]={color:"Window",backgroundColor:"Highlight"},s)},".ms-Button.is-disabled":{color:y.buttonTextDisabled,selectors:(c={},c[a.b]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},c)}}},splitButtonContainerChecked:{selectors:{".ms-Button--primary":{selectors:(l={},l[a.b]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},l)}}},splitButtonContainerCheckedHovered:{selectors:{".ms-Button--primary":{selectors:(u={},u[a.b]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},u)}}},splitButtonContainerFocused:{outline:"none!important"},splitButtonMenuButton:{padding:6,height:"auto",boxSizing:"border-box",borderRadius:0,borderTopRightRadius:f.roundedCorner2,borderBottomRightRadius:f.roundedCorner2,border:"1px solid "+b.neutralSecondaryAlt,borderLeft:"none",outline:"transparent",userSelect:"none",display:"inline-block",textDecoration:"none",textAlign:"center",cursor:"pointer",verticalAlign:"top",width:32,marginLeft:-1,marginTop:0,marginRight:0,marginBottom:0},splitButtonDivider:Object(n.__assign)(Object(n.__assign)({},v),{selectors:(d={},d[a.b]={backgroundColor:"WindowText"},d)}),splitButtonDividerDisabled:Object(n.__assign)(Object(n.__assign)({},v),{selectors:(p={},p[a.b]={backgroundColor:"GrayText"},p)}),splitButtonMenuButtonDisabled:{pointerEvents:"none",border:"none",selectors:(h={":hover":{cursor:"default"},".ms-Button--primary":{selectors:(g={},g[a.b]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},g)}},h[a.b]={border:"1px solid GrayText",color:"GrayText",backgroundColor:"Window"},h)},splitButtonFlexContainer:{display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"center",alignItems:"center"},splitButtonContainerDisabled:{outline:"none",border:"none",selectors:(m={},m[a.b]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},m)}};return Object(o.a)(_,t)}))},LAsh:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(e){return{paddingLeft:e.sizes.Measures.Measure100,paddingRight:e.sizes.Measures.Measure100}}r.d(t,"a",(function(){return n}))},LBS5:function(e,t,r){"use strict";r.d(t,"b",(function(){return k})),r.d(t,"a",(function(){return A})),r.d(t,"c",(function(){return D})),r.d(t,"e",(function(){return R})),r.d(t,"d",(function(){return B}));var n,i,a=r("TJkj"),o=r("UOiB"),s=r("kvLG"),c=r("mPpC"),l=r("Y+r4"),u=r("c/eZ"),d=r("ZOZo"),p=r("0hCf"),h=r("G9wF"),g=r("T4u8"),m=r("9r0m"),f=r("ixd0"),b=r("JX21"),y=r("1z64"),v=r("5KPK"),_=function(e){function t(t,r,i,a){var o=e.call(this,t,r,i,a)||this;return o._dashboardId=t,n=i,o._clientApiExecutor=new y.a(i,"ClientApi.XrmDashboardSelectorItem.",a),o}return Object(u.__extends)(t,e),t.prototype._getEventParams=function(){return this._commonEventParams||(this._commonEventParams=[{name:"dashboardId",value:m.a.toString(this._dashboardId),isRequired:!1,isEventParam:!0}])},Object.defineProperty(t.prototype,"isBoundDashboard",{get:function(){var e=this;return this._clientApiExecutor.execute("isBoundDashboard_get",(function(){var t=Object(b.a)(n.getState(),e._dashboardId);return!t||1032==+t.Type}),this._getEventParams())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUserDashboard",{get:function(){var e=this;return this._clientApiExecutor.execute("isUserDashboard_get",(function(){var t=Object(b.a)(n.getState(),e._dashboardId);return Object(b.c)(t)}),this._getEventParams())},enumerable:!1,configurable:!0}),t.prototype.navigate=function(){var e=this;this._clientApiExecutor.executeAsync("navigate",(function(){return n.dispatch(Object(v.a)(null,e._dashboardId,null,null,null,null,e.getPageId()))}),this._getEventParams())},t}(f.a),S=function(e){function t(t,r,n,i,a){var o=g.c;if(i){var s=t.getState(),c=Object(g.g)(s,i);c&&c[n.guid]&&(o=g.g)}return e.call(this,t,r,n,i,a,o,_)||this}return Object(u.__extends)(t,e),t}(h.b),O=function(e){function t(t,r,n,i,a,o){return e.call(this,t,r,n,i,a,o,S)||this}return Object(u.__extends)(t,e),t}(p.a),C=function(e){function t(t,r,n,a,o,s){var c=e.call(this,t,r&&r.etn,a,o,(function(){return O}),n)||this;return i=t,c._getCommands=s,c._apiExecutor=new y.a(t,"ClientApi.XrmDashboard.",o,a),c}return Object(u.__extends)(t,e),Object.defineProperty(t.prototype,"commands",{get:function(){var e=this;return this._apiExecutor.execute("commands_get",(function(){return e._commands||(e._commands=e._getCommands(i,e.contextToken,e.pageId))}))},enumerable:!1,configurable:!0}),t}(d.a),I=r("7bez"),j=r("Dlr/"),P=r("1PXy"),F=r("h82J"),T=r("HSdq"),w=r("IiPO"),E=r("ks02"),x=r("+Z9T"),N=r("W1TM");function A(e,t,r,n){return M((function(r,i){return new C(r,i,new c.b(r,t),e,t,n)}),"clientapi.create.xrmdashboard","ClientApi.XrmCommandObjectFactory.createXrmDashboard",e,t,r,!1)}function k(e,t,r,n){return M((function(r,n){return new l.a(r,n,new c.b(r,t),e,t)}),"clientapi.create.xrmform","ClientApi.XrmCommandObjectFactory.createXrmForm",e,t,r,!0,n)}function M(e,t,r,n,i,o,c,l){return{type:t,sync:!0,execute:function(t,u){Object(x.g)(n,r,"contextToken"),Object(x.g)(i,r,"pageId"),c&&Object(x.g)(o,r,"entityTypeName");try{var d=t.dispatch(Object(F.b)(i,n));if(!d){(d=e(t,{etn:o,id:l})).applicationContext=u;var p=new E.a(t,i);if(d.context=p,!n.parentContextToken){var h=u.ClientApiManager.getClientApiEntry(i);Object(a.b)("form.initialization",(function(){h.xrmInstance.Page=d})),h.primaryContextToken=n}}return d}catch(e){var g=w.a.getInstance().getEventParameters(n);throw g.push({name:"entityTypeName",value:o}),s.a.getInstance().eventManager.ReportComponentFailure(r,e,null,g),e}}}}function D(e,t,r,n,i){var a="ClientApi.XrmCommandObjectFactory.createXrmGrid";return{type:"clientapi.create.xrmgrid",sync:!0,execute:function(c,l){Object(x.g)(e,a,"contextToken"),Object(x.g)(t,a,"pageId");try{var u=c.dispatch(Object(F.c)(t,e));if(!u){if(3===n){var d=Object(T.s)(c.getState(),{id:t,controlName:i},e.parentContextToken);if(d){var p=c.dispatch(Object(F.b)(t,e.parentContextToken));return new j.a(c,e.parentContextToken,t,i,r,p,d,l)}(h=w.a.getInstance().getEventParameters(e)).push({name:"controlName",value:i}),h.push({name:"gridType",value:n}),s.a.getInstance().eventManager.ReportComponentFailure(a,new Error("Control descriptor could not be found for subgrid control"),null,h)}if(u=new I.a(c,e,t,r,n,!1,l,i),!e.parentContextToken&&e.contextTokenType===o.a.MainGrid)l.ClientApiManager.getClientApiEntry(t).primaryContextToken=e}return u}catch(t){var h;throw(h=w.a.getInstance().getEventParameters(e)).push({name:"controlName",value:i}),h.push({name:"gridType",value:n}),s.a.getInstance().eventManager.ReportComponentFailure(a,t,null,h),t}}}}function R(e,t,r,n){var i="ClientApi.XrmCommandObjectFactory.registerNewControl";return{type:"clientapi.create.xrmTimeline",sync:!0,execute:function(a,o){Object(x.g)(e,i,"contextToken"),Object(x.g)(t,i,"pageId"),Object(x.g)(r,i,"controlName"),Object(x.g)(n,i,"controlId");try{var c=a.dispatch(Object(F.b)(t,e.parentContextToken)),l=null;switch(r){case"notescontrol":if(!(l=a.dispatch(Object(F.f)(t,e)))){var u=Object(T.s)(a.getState(),{id:t,controlName:r},e.parentContextToken);l=new P.a(a,e.parentContextToken,t,u,r,n,c,o)}break;default:(d=w.a.getInstance().getEventParameters(e)).push({name:"controlName",value:r}),s.a.getInstance().eventManager.ReportComponentFailure(i,new Error("Failed to create and return the control"),null,d)}return l}catch(t){var d;throw(d=w.a.getInstance().getEventParameters(e)).push({name:"controlName",value:r}),s.a.getInstance().eventManager.ReportComponentFailure(i,t,null,d),t}}}}function B(e,t){var r="ClientApi.XrmCommandObjectFactory.createXrmKBSearch";return{type:"clientapi.create.xrmkbsearch",sync:!0,execute:function(n,i){Object(x.g)(e,r,"contextToken"),Object(x.g)(t,r,"pageId");try{var a=n.dispatch(Object(F.g)(t,e));if(!a&&(a=new N.a(n,e,t),!e.parentContextToken)){var o=i.ClientApiManager.getClientApiEntry(t);o.xrmInstance.Page=a,o.primaryContextToken=e}return a}catch(t){var c=w.a.getInstance().getEventParameters(e);throw s.a.getInstance().eventManager.ReportComponentFailure(r,t,null,c),t}}}}},LFYt:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return i}));var n=r("mVnn"),i="quickCreateForm.output";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){return{type:"quickCreateForm.output.async",execute:function(r){var a=r.dispatch,o=r.getState,s=Object(n.a)(o(),e)||[];return s.push(t),a(function(e,t){return{type:i,payload:{reason:"close",value:t},meta:{pageId:e}}}(e,s)),Promise.resolve(e)}}}},LdMy:function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var n=r("90Ov"),i=r("WS0f"),a=function(){function e(){}return Object.defineProperty(e.prototype,"invocationSource",{get:function(){return this._invocationSource},set:function(e){this._invocationSource=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"workflowStep",{get:function(){return this._workflowStep},set:function(e){this._workflowStep=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessFlowVisitor",{get:function(){return this._businessProcessFlowVisitor},set:function(e){this._businessProcessFlowVisitor=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentEntityName",{get:function(){return this._currentEntityName},set:function(e){this._currentEntityName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"processManager",{get:function(){return this._processManager},set:function(e){this._processManager=e},enumerable:!1,configurable:!0}),e.prototype.getStageStep=function(e){if(Object(i.b)(e)||!this._businessProcessFlowVisitor)return null;var t=this._businessProcessFlowVisitor.get_stagesById()[Object(n.a)(e)];return t||null},e}(),o=r("c/eZ"),s=function(e){function t(t){return e.call(this,Object(n.a)(t))||this}return Object(o.__extends)(t,e),t}(function(){function e(e){this.value=e,this._next=null}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!1,configurable:!0}),e.prototype.getNext=function(){return this._next},e.prototype.setNext=function(e){this._next=e},e}()),c=function(){function e(){this._latestDefaultPathCalculated=!1,this._rootNodes=[],this._rootNodesValue=[],this._lastDefaultPathCalculatedTimeHash=this._generateDefaultPathCalculatedTimeHash()}return e.prototype.find=function(e,t){if(e=Object(n.a)(e),t){for(var r in this._rootNodesValue)if(e===this._rootNodesValue[r])return this._rootNodes[r];return null}for(var r in this._rootNodes){var i=this._rootNodes[r];if(i.value===e)return i;for(;null!=i.getNext();)if((i=i.getNext()).value===e)return i}return null},e.prototype.getNode=function(e){return this._rootNodes[e]},e.prototype.setNode=function(e,t){this._latestDefaultPathCalculated=!1,this._rootNodes[e]=t,this._rootNodesValue[e]=t.value},e.prototype.getDefaultPath=function(){return this._ensureLatestDefaultPathIsCalculated(),this._defaultPathArray},e.prototype.addAfter=function(e,t){this.find(t.value,!0)?this._addAfterInternal(e,new s(null)):this._addAfterInternal(e,t)},e.prototype.getDefaultPathHash=function(){return this._ensureLatestDefaultPathIsCalculated(),this._lastDefaultPathCalculatedTimeHash},e.prototype._ensureLatestDefaultPathIsCalculated=function(){this._latestDefaultPathCalculated||(this._defaultPathArray=this._recaculateDefaultPath(),this._latestDefaultPathCalculated=!0,this._lastDefaultPathCalculatedTimeHash=this._generateDefaultPathCalculatedTimeHash())},e.prototype._recaculateDefaultPath=function(){this._defaultPathArray=[];for(var e=0;e<this._rootNodes.length;e++){var t=this._rootNodes[e];for(this._defaultPathArray[this._defaultPathArray.length]=t.value;t.getNext();){var r=t.getNext();r.value&&(this._defaultPathArray[this._defaultPathArray.length]=r.value),t=r}}return this._defaultPathArray},e.prototype._addAfterInternal=function(e,t){e.setNext(t),this._latestDefaultPathCalculated=!1},e.prototype._generateDefaultPathCalculatedTimeHash=function(){var e=Math.floor(1e4*Math.random());try{e=crypto.getRandomValues(new Uint32Array(1))[0]}catch(e){}return Date.now().toString()+e},e}(),l=function(){function e(){}return e.prototype.pathChanged=function(e){this._handler&&!Object(i.b)(e.parentStage)&&this._handler.handleChange(e.parentStage,e.nextStage)},e.prototype.getHandler=function(){return this._handler},e.prototype.setHandler=function(e){this._handler=e},e}(),u=function(){function e(e,t){this._nextStage=t,this._parentStage=e}return Object.defineProperty(e.prototype,"parentStage",{get:function(){return this._parentStage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextStage",{get:function(){return this._nextStage},enumerable:!1,configurable:!0}),e}(),d=function(){function e(e,t,r){this._context=e,this._defaultPath=t,this._staticPath=r}return e.prototype.calculate=function(){for(var e=this._startingNodeInDefaultPath(),t=0;t<this._staticPath.length;t++){var r=this._staticPath[t];if(this._context.businessProcessFlowVisitor.get_stagesById().hasOwnProperty(r)){var n=this._defaultPath.find(r,!0);n?e=n:(this._defaultPath.addAfter(e,new s(r)),e=e.getNext())}}this._lastEvaluatedNode=e},e.prototype.getLastEvaluatedNodeInDefaultPath=function(){return this._lastEvaluatedNode},e.prototype.getDefaultPath=function(){return this._defaultPath},e.prototype._startingNodeInDefaultPath=function(){return this._startNode||(this._startNode=this._defaultPath.getNode(0)),this._startNode},e}(),p=function(){function e(e,t){this._defaultPath=t,this._context=e}return e.prototype.calculate=function(){this._staticPathToDefaultPathCalculator.calculate(),this._defaultPath=this._staticPathToDefaultPathCalculator.getDefaultPath()},e.prototype.getLastDefaultNode=function(){return this._staticPathToDefaultPathCalculator.getLastEvaluatedNodeInDefaultPath()},Object.defineProperty(e.prototype,"traversedPath",{get:function(){return this._traversedPath||(this._traversedPath=[]),this._traversedPath},set:function(e){this._traversedPath=e},enumerable:!1,configurable:!0}),e.prototype.getDefaultPath=function(){return this._defaultPath},Object.defineProperty(e.prototype,"_staticPathToDefaultPathCalculator",{get:function(){return this.__staticPathToDefaultPathCalculator||(this.__staticPathToDefaultPathCalculator=new d(this._context,this._defaultPath,this._traversedPath)),this.__staticPathToDefaultPathCalculator},enumerable:!1,configurable:!0}),e}(),h=function(){function e(e,t){this._context=e,this._defaultPath=t}return e.prototype.calculate=function(){this._context.businessProcessFlowVisitor.get_areConditionsPresent()&&this._calculateForTraveresedStages()},Object.defineProperty(e.prototype,"traversedPath",{get:function(){return this._traversedPath},set:function(e){this._traversedPath=e},enumerable:!1,configurable:!0}),e.prototype.getLastCalculatedDefaultNode=function(){return this._traversedDefaultPathCalculator?this._traversedDefaultPathCalculator.getLastDefaultNode():null},e.prototype.getDefaultPath=function(){return this._defaultPath},e.prototype._calculateForTraveresedStages=function(){this._traversedDefaultPathCalculator.traversedPath=this._traversedPath.split(","),this._traversedDefaultPathCalculator.calculate()},Object.defineProperty(e.prototype,"_traversedDefaultPathCalculator",{get:function(){return this.__traversedDefaultPathCalculator||(this.__traversedDefaultPathCalculator=new p(this._context,this._defaultPath)),this.__traversedDefaultPathCalculator},enumerable:!1,configurable:!0}),e}(),g=function(){function e(e){this.context=e}return Object.defineProperty(e.prototype,"stage",{get:function(){return this._stageStep},set:function(e){this._stageStep=e},enumerable:!1,configurable:!0}),e.prototype.tryExecute=function(){var e=Object(n.a)(this.stage.get_stageId());return!!this.context.businessProcessFlowVisitor.get_conditionsByParentStageId()[e]&&(this.executeCondition(),!0)},e}(),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.executeCondition=function(){var e="bpf_"+this._sanitizeGuidForFunctionName(this.stage.get_stageId());this.context.processManager.callPblToEvaluateBranching(e)},t.prototype._sanitizeGuidForFunctionName=function(e){if(Object(i.b)(e))return e;for(e=Object(n.a)(e);e.indexOf("-")>-1;)e=e.replace("-","");return e},t}(g),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.executeCondition=function(){var e=Object(n.a)(this.stage.get_stageId()),t=this.context.businessProcessFlowVisitor.get_conditionsByParentStageId()[e];if(t){var r=t.findElseBranch(),i=null;if(r&&r.get_Steps().get_Count()>0)i=r.get_Steps().get_item(0).get_stageId();this._invokeReflowFunction(e,i)}},t.prototype._invokeReflowFunction=function(e,t){this.context.processManager.reflow(!1,e,t)},t}(g),b=function(){function e(){}return e.prototype.getStageCommand=function(e,t){var r=e.businessProcessFlowVisitor.get_parentEntityStepByStageId()[Object(n.a)(t.get_stageId())];return e.currentEntityName!==r.get_EntityLogicalName()?new f(e):new m(e)},e}(),y=function(){function e(e,t,r){this._defaultPath=t,this._cascadeUpdate=r,this._context=e,this._businessRuleCommandFactory=new b}return e.prototype.handleChange=function(e,t){var r=this._defaultPath.find(e,!1);if(null!=r){var n=Object(i.b)(t)?null:t,a=new s(n);this._defaultPath.addAfter(r,a),n&&this.triggerSubsequentDefaultPathCalculation(a)}},e.prototype.triggerSubsequentDefaultPathCalculation=function(e){if(e){var t=e.value;if(t&&!this._tryExecuteConditionForStage(e)){var r=this._context.getStageStep(t).get_nextStageId();if(!r)return;var n=this._defaultPath.find(r,!0);if(n)return void(this._cascadeUpdate&&this.triggerSubsequentDefaultPathCalculation(n));this._defaultPath.addAfter(e,new s(r)),this.triggerSubsequentDefaultPathCalculation(e.getNext())}}},e.prototype._tryExecuteConditionForStage=function(e){var t=this._context.invocationSource;try{this._context.invocationSource="internal";var r=this._context.getStageStep(e.value),n=this._businessRuleCommandFactory.getStageCommand(this._context,r);if(n.stage=r,!n.tryExecute())return!1;if(e.getNext())return!0}finally{this._context.invocationSource=t}return!1},e}(),v=function(){function e(e,t,r){this._context=e,this._listener=t,this._defaultPath=r}return e.prototype.calculate=function(){var e=this._pathChangeHandler;this._listener.setHandler(e),e.triggerSubsequentDefaultPathCalculation(this._startNode)},Object.defineProperty(e.prototype,"startingNodeInDefaultPath",{get:function(){return this._startNode},set:function(e){this._startNode=e},enumerable:!1,configurable:!0}),e.prototype.getDefaultPath=function(){return this._defaultPath},Object.defineProperty(e.prototype,"_pathChangeHandler",{get:function(){return this.__pathChangeHandler||(this.__pathChangeHandler=new y(this._context,this._defaultPath,!0)),this.__pathChangeHandler},enumerable:!1,configurable:!0}),e}(),_=function(){function e(e,t,r){this._context=e,this._listener=t,this._initialDefaultPath=r}return e.prototype.calculate=function(){this._context.businessProcessFlowVisitor.get_areConditionsPresent()||(this._defaultPath=this._initialDefaultPath),this._calculateForTraversedStages(),this._calculateForNonTraversedStages()},Object.defineProperty(e.prototype,"startingNodeInDefaultPath",{get:function(){return this._startingNodeInDefaultPath},set:function(e){this._startingNodeInDefaultPath=e},enumerable:!1,configurable:!0}),e.prototype.getDefaultPath=function(){return this._defaultPath},e.prototype._calculateForTraversedStages=function(){this._defaultPath=this._initialDefaultPath},e.prototype._calculateForNonTraversedStages=function(){this._nonTraversedDefaultPathCalculator.startingNodeInDefaultPath=this.startingNodeInDefaultPath,this._nonTraversedDefaultPathCalculator.calculate()},Object.defineProperty(e.prototype,"_nonTraversedDefaultPathCalculator",{get:function(){return this.__nonTraversedDefaultPathCalculator||(this.__nonTraversedDefaultPathCalculator=new v(this._context,this._listener,this._defaultPath)),this.__nonTraversedDefaultPathCalculator},enumerable:!1,configurable:!0}),e}(),S=function(){function e(e,t,r){this._context=e,this._changeListener=t,this._defaultPath=r}return e.prototype.calculate=function(){var e=this._pathChangeHandler;this._changeListener.setHandler(e)},e.prototype.getDefaultPath=function(){return this._defaultPath},Object.defineProperty(e.prototype,"_pathChangeHandler",{get:function(){return this.__pathChangeHandler||(this.__pathChangeHandler=new y(this._context,this._defaultPath,!1)),this.__pathChangeHandler},enumerable:!1,configurable:!0}),e}(),O=r("9r0m"),C=function(){function e(e,t){this._context=t,this._traversedPathProvider=e,this._changeListener=new l,this._initializeDefaultPathFromRootStages()}return e.prototype.initializeComplete=function(){var e=this.defaultPathHash();this._initializeTraversedPath(),this._initializeNonTraversedPath();var t=this._context.processManager.getSelectedStageId(),r=this._context.processManager.getActivePath(),n=!Object(i.a)(t)&&!Object(i.a)(r),a=n&&r.findIndex((function(e){return e.guid.toString()===t}))<0,o=n&&this.getDefaultPath().indexOf(t)>=0;this.getDefaultPath()&&(e!==this.defaultPathHash()||a&&o)&&this._context.processManager.setActivePath(this.getDefaultPath())},e.prototype.updateDefaultPath=function(e,t){if(e){var r=null;if("internal"!==this._context.invocationSource&&(r=this.defaultPathHash()),this._changeListener.pathChanged(new u(e,t)),"internal"!==this._context.invocationSource)if(r!==this.defaultPathHash()){var n=this.getDefaultPath();this._context.processManager.setActivePath(n)}}},e.prototype.triggerSubsequentDefaultPathCalculation=function(e){if(!!O.a.tryParseOrNull(e)&&!!this.getDefaultPath().find((function(t){return t.toLowerCase()===e.toLowerCase()}))){var t=null;if("internal"!==this._context.invocationSource&&(t=this.defaultPathHash()),this._changeListener.getHandler().triggerSubsequentDefaultPathCalculation(new s(e)),"internal"!==this._context.invocationSource)if(t!==this.defaultPathHash()){var r=this.getDefaultPath();this._context.processManager.setActivePath(r)}}},e.prototype.getDefaultPath=function(){return this._defaultPath.getDefaultPath()},e.prototype.defaultPathHash=function(){return this._defaultPath.getDefaultPathHash()},e.prototype.getNextStage=function(e){var t=this.getDefaultPath(),r=t.indexOf(Object(n.a)(e));return-1!==r&&r<t.length-1?t[r+1]:null},e.prototype.getPreviousStage=function(e){var t=this.getDefaultPath(),r=t.indexOf(Object(n.a)(e));return r<=0?null:t[r-1]},e.prototype._initializeDefaultPathFromRootStages=function(){this._defaultPath=new c;var e=this._context.businessProcessFlowVisitor.get_firstLevelStages(),t=0;for(var r in e)this._defaultPath.setNode(t,new s(r)),t++},e.prototype._initializeTraversedPath=function(){this._loadTimeDefaultPathCalculator.traversedPath=this._traversedPathProvider.getTraversedPath(),this._loadTimeDefaultPathCalculator.calculate(),this._defaultPath=this._loadTimeDefaultPathCalculator.getDefaultPath()},e.prototype._initializeNonTraversedPath=function(){this._afterLoadPathCalculator.startingNodeInDefaultPath=this._loadTimeDefaultPathCalculator.getLastCalculatedDefaultNode(),this._afterLoadPathCalculator.calculate(),this._defaultPath=this._afterLoadPathCalculator.getDefaultPath(),this._runTimePathCalculator.calculate()},Object.defineProperty(e.prototype,"_loadTimeDefaultPathCalculator",{get:function(){return this._loadTimePathCalculator||(this._loadTimePathCalculator=new h(this._context,this._defaultPath)),this._loadTimePathCalculator},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_afterLoadPathCalculator",{get:function(){return this.__afterLoadPathCalculator||(this.__afterLoadPathCalculator=new _(this._context,this._changeListener,this._defaultPath)),this.__afterLoadPathCalculator},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_runTimePathCalculator",{get:function(){return this.__runTimePathCalculator||(this.__runTimePathCalculator=new S(this._context,this._changeListener,this._defaultPath)),this.__runTimePathCalculator},enumerable:!1,configurable:!0}),e}(),I=r("HSdq"),j=function(){function e(){}return e.prototype.setPrimaryModel=function(e){this._primaryModelName=e},e.prototype.getDefaultPathManager=function(){return this._defaultPathManager},e.prototype.setObjectModel=function(e){var t=this,r=new Microsoft.Crm.Workflow.ObjectModel.WorkflowStep("",0),n={};e.businessProcessFlowEntities.forEach((function(e){if(t._isRelationshipStep(e)){var i=t._createRelationshipCollectionStep(r,e);i&&r.appendStep(i)}else{var a=t._createEntity(r,e);a&&(r.appendStep(a),n.hasOwnProperty(a.get_EntityLogicalName())||(n[a.get_EntityLogicalName()]=!0))}})),r.set_Name(e.businessProcessFlowName),r.set_Id(e.businessProcessFlowId?e.businessProcessFlowId.guid:""),this._processObjectModel=r,this._initializeVisitor()},e.prototype.initializeDefaultPathManager=function(e,t){var r=new a;r.processManager=t,r.businessProcessFlowVisitor=this._businessProcessFlowVisitor,r.workflowStep=this._processObjectModel,r.currentEntityName=this._primaryModelName,this._defaultPathManager=new C(e,r),this._defaultPathManager.initializeComplete()},Object.defineProperty(e.prototype,"businessProcessFlowVisitor",{get:function(){return this._businessProcessFlowVisitor},enumerable:!1,configurable:!0}),e.prototype.getEntityStages=function(){if(!this._processObjectModel)return null;var e=this._processObjectModel.get_Steps(),t=[];if(e){for(var r=0;r<e.get_Count();r++){var n=e.get_item(r);n&&n instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep&&(t[t.length]=e.get_item(r))}return t}return null},e.prototype.getRequiredFlowStepsForStage=function(e,t,r,n){var i=[],a=this.getStage(e);if(!a)throw new Error(e+" is not a valid stage id.");var o=a.get_Steps();if(!o)throw new Error(e+" does not include valid steps");for(var s=0;s<o.get_Count();s++)if(o.get_item(s)instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){var c=o.get_item(s);this._isFlowStep(c)&&c.get_isProcessRequired()&&i.push(c.get_Id())}return i},e.prototype.getRequiredAttributesForStage=function(e,t,r,n){var i=[],a=this.getStage(e);if(!a)throw new Error(e+" is not a valid stage id.");var o=a.get_Steps();if(!o)throw new Error(e+" does not include valid steps");for(var s=0;s<o.get_Count();s++)if(o.get_item(s)instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){var c=o.get_item(s);if(!this._isActionStep(c)&&!this._isFlowStep(c))if(c.get_isProcessRequired())i.push(c.get_Description());else{var l=this._getDataFieldNameFromStepStep(c);l&&this._isRequiredAttribute(l,t,r,n)&&i.push(c.get_Description())}}return i},e.prototype._getDataFieldNameFromStepStep=function(e){if(this._isActionStep(e)||this._isFlowStep(e))return null;if(this._isControlStep(e)){var t=e.get_Steps().get_item(0);return!t||t.get_isSystemControl()?null:t.get_dataFieldName()}return null},e.prototype._isRequiredAttribute=function(e,t,r,n){return null!=e&&2===Object(I.pc)(n,t,r,e)},e.prototype._isFlowStep=function(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0&&e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.FlowStep)return!0;return!1},e.prototype._isActionStep=function(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0&&e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep)return!0;return!1},e.prototype._isControlStep=function(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0&&e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ControlStep)return!0;return!1},e.prototype._initializeVisitor=function(){this._businessProcessFlowVisitor=new ProcessObjectModel.Visitors.BusinessProcessFlowVisitor,this._businessProcessFlowVisitor.visit(this._processObjectModel)},e.prototype._isRelationshipStep=function(e){return!(!e||!e.hasOwnProperty("relationships"))},e.prototype._createEntity=function(e,t){var r=new Microsoft.Crm.Workflow.ObjectModel.EntityStep(e,t.entityLogicalName);r.set_Name(t.entityLogicalName),r.set_Description(t.entityDisplayName),r.set_relationshipName(t.relationshipName),r.set_attributeName(t.referencingAttributeName),r.set_parent(e);var n=this._createStage(e,t.stage);r&&n&&r.appendStep(n);for(var i=0;i<t.stage.steps.length;i++){var a=this._createStep(e,t.stage.steps[i]);a&&n.appendStep(a)}var o=this._createConditionStep(e,n,t.stage);return o&&n.appendStep(o),r},e.prototype._createRelationshipCollectionStep=function(e,t){var r=new Microsoft.Crm.Workflow.ObjectModel.RelationshipCollectionStep(e);if(r.set_workflow(e),t.relationships)for(var n=0;n<t.relationships.length;n++){var i=this._createRelationshipStep(e,t.relationships[n]);r.appendStep(i)}return r},e.prototype._createRelationshipStep=function(e,t){var r=new Microsoft.Crm.Workflow.ObjectModel.RelationshipStep(e);return r.set_workflow(e),r.set_sourceStageId(t.sourceStageId.guid),r.set_targetStageId(t.targetStageId.guid),r.set_attributeName(t.attributeName),r.set_relationshipName(t.relationshipName),r},e.prototype._createStage=function(e,t){var r=new Microsoft.Crm.Workflow.ObjectModel.StageStep(e,t.stageDisplayName||"dummy");return r.set_Id(t.stageId.guid),r.set_stageId(t.stageId.guid),r.set_nextStageId(t.nextStageId?t.nextStageId.guid:""),r.set_stageCategory(t.stageCategory),r},e.prototype._createStep=function(e,t){var r="action"===t.stepType.toLowerCase()?t.label:t.name,n=new Microsoft.Crm.Workflow.ObjectModel.StepStep(e,r||"dummy");n.set_isProcessRequired(t.required),n.set_Name(t.label),n.set_Id(t.stepId?t.stepId.guid:""),n.set_workflow(e);var i=new Microsoft.Crm.Workflow.ObjectModel.ControlStep(e);if(i.set_dataFieldName(r),"action"===t.stepType.toLowerCase()){var a=new Microsoft.Crm.Workflow.ObjectModel.ActionStep(e);a.set_Name(r),a.set_actionControl(i),n.appendStep(a)}else if("modernflow"===t.stepType.toLowerCase()){var o=new Microsoft.Crm.Workflow.ObjectModel.FlowStep(e);o.set_Name(r),o.set_flowControl(i),n.appendStep(o)}else n.appendStep(i);return n},e.prototype._createConditionStep=function(e,t,r){if(!r.conditionJson)return null;var n=new Microsoft.Crm.Workflow.ObjectModel.ConditionStep(e);return n.set_parent(t),n.initializeFromDynamic(JSON.parse(r.conditionJson)),n.fixLinks(),n},e.prototype.getProcessObjectModel=function(){return this._processObjectModel},e.prototype.getStage=function(e){return Object(i.a)(e)||!this._processObjectModel?null:this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(e)?this._businessProcessFlowVisitor.get_stagesById()[e]:null},e.prototype.getPreviousStageId=function(e){if(this._defaultPathManager&&this._businessProcessFlowVisitor){var t=this._defaultPathManager.getPreviousStage(e);if(this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(t))return t}return null},e.prototype.getNextStageId=function(e){if(this._defaultPathManager&&this._businessProcessFlowVisitor){var t=this._defaultPathManager.getNextStage(e);if(this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(t))return t}return null},e}()},LhJP:function(e,t,r){"use strict";r.d(t,"h",(function(){return n})),r.d(t,"i",(function(){return i})),r.d(t,"o",(function(){return a})),r.d(t,"a",(function(){return o})),r.d(t,"j",(function(){return s})),r.d(t,"c",(function(){return c})),r.d(t,"f",(function(){return l})),r.d(t,"g",(function(){return u})),r.d(t,"b",(function(){return h})),r.d(t,"d",(function(){return g})),r.d(t,"k",(function(){return m})),r.d(t,"l",(function(){return f})),r.d(t,"e",(function(){return b})),r.d(t,"q",(function(){return y})),r.d(t,"p",(function(){return v})),r.d(t,"m",(function(){return d})),r.d(t,"n",(function(){return p}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="BusinessProcessFlow.MoveToNextStage",i="BusinessProcessFlow.MoveToPreviousStage",a="BusinessProcessFlow.SetActiveStage",o="BusinessProcessFlow.AbandonProcess",s="BusinessProcessFlow.ReactivateProcess",c="BusinessProcessFlow.CompleteProcess",l="BusinessProcessFlow.InitilaizeWithFormEntityOnly",u="BusinessProcessFlow.InitilaizeWithProcessAndFormEntity",d="BusinessProcessFlow.SetActiveProcess",p="BusinessProcessFlow.SetActiveProcessInstance",h="BusinessProcessFlow.ActionStep",g="BusinessProcessFlow.FlowStepWidget",m="BusinessProcessFlow.RefreshFlowStep",f="BusinessProcessFlow.RenderProcessControl",b="BusinessProcessFlow.HideProcessControlForUciOffline",y="SaveFailureReason",v="faultedSnapshotId"},LiB6:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("c/eZ"),i=r("UlLp"),a=r("8VL5"),o={};function s(e,t){var r;return void 0===e&&(e=o),t.type===a.a?Object(n.__assign)(Object(n.__assign)({},e),((r={})[Object(i.a)(t.meta.customControlId,t.meta.dataSetParameterName)]=t.payload,r)):e}},NJzV:function(e,t,r){"use strict";r.d(t,"b",(function(){return ur})),r.d(t,"a",(function(){return dr})),r.d(t,"d",(function(){return hr})),r.d(t,"c",(function(){return lr}));var n=r("c/eZ"),i=r("4E+q"),a=r("kyRo"),o=r("nuS9"),s=r("93Ls"),c=r("kGA3"),l=r("VnpK"),u=r("S2mk"),d=r("DRVD"),p=r.n(d),h=r("CCTC"),g=r("9r0m"),m=r("WS0f"),f=r("sOTk"),b=r("Nw1z"),y=r("HSdq"),v=r("riBC"),_=r("2OIc"),S=r("T2Xs"),O=r("Sscr"),C=r("UOiB"),I=r("QAhb"),j=r("yHpA"),P=r("JX21"),F=r("T4u8"),T=r("cZkS"),w=r("qC0c"),E="CustomControlFramework.Selectors.CustomControlHostContextTokenSelectors";function x(){var e=null,t=null,r=null;return function(n,i){S.a.info(i.controlId+"."+E+": createGetContextTokenSelector started");var a=i.parentContextToken,o=i.contextString,s=function(e,t){var r,n=t.parentContextToken,i=t.contextString,a=t.configuration,o=Object(_.e)(e,t.configuration.CustomControlId);if(Object(w.c)(e,T.J)&&Object(l.s)(o)&&function e(t,r){if(!r)return!1;if(r.contextTokenType===C.a.UnboundForm&&r.formId)return!(!Object(P.a)(t,r.formId)&&!Object(F.a)(t,r.formId));return e(t,r.parentContextToken)}(e,n))return r=O.p(n.parentContextToken,t.controlId);if("default"===i&&Object(l.s)(o)&&!Object(l.r)(t.configuration.Parameters)||Object(l.r)(t.configuration.Parameters)&&function(e){if(e.indexOf("ClientContextGridControl")>-1||e.indexOf("activeProcessGridControlContainer")>-1||e.indexOf("ManageDuplicatesGrid")>-1||e.indexOf("archivedProcessGridControlContainer")>-1)return!0;return!1}(t.controlId))return r=O.e(n,t.controlId);if(!t.formInfo&&a&&a.Parameters&&a.Parameters.value&&"TimelineWall"===a.Parameters.value.Type)return r=O.p(n,t.controlId);if(!t.formInfo&&Object(l.t)(t.configuration)){var s=function(e,t){var r=Object(f.g)(e,t.id),n=new I.a(r.entityTypeName,r.id||g.a.EMPTY),i=Object(y.ac)(e,t.id,t.parentContextToken),a=Object(j.d)(e,i,n,t.descriptor.DataFieldName),o=a?a.reference:null;return o?o.etn:Object(l.m)(t.descriptor)}(e,t);return r=O.l(n,t.controlId,s)}r=n;var c=t.descriptor&&t.descriptor.Relationship;c&&(r=O.m(r,c));return r}(n,i);return(r!==o||N(e,s)||N(t,a))&&(e=s,t=a,r=o),S.a.info(i.controlId+"."+E+": createGetContextTokenSelector finished"),e}}function N(e,t){return e&&t?e.entityTypeName!==t.entityTypeName||e.controlName!==t.controlName||(e.formId&&e.formId.guid)!==(t.formId&&t.formId.guid)||(e.recordId&&e.recordId.guid)!==(t.recordId&&t.recordId.guid)||e.relationshipName!==t.relationshipName:e!==t}var A=r("ZEX9"),k=r("Gemh"),M=r("OTOS"),D=r("WH9N"),R=r("L8Ie"),B=r("0hZT");function L(){var e={},t=!1;return function(r,n,i,a,o,s){S.a.info(n.controlId+".CustomControlFramework.Selectors.CustomControlHostPersonalizationInfoSelectors: createGetPersonalizationConfiguration started");var c=Object(f.a)(r,n),l=c&&c.id,u=e&&l&&l.guid&&(!e.recordGuid||e.recordGuid&&l.guid!==e.recordGuid.guid);if(!t||u){var d=Object(M.b)(r,n.id),p=g.a.equals(g.a.tryParse(i.UniqueId),g.a.EMPTY)?n.controlId:i.UniqueId;e=d&&s===D.a?function(e,t,r,n){return{areaType:"dashboard",entityTypeName:null,recordGuid:null,formGuid:r,controlUniqueId:n,viewId:void 0}}(0,0,d,p):d&&s===R.a?function(e,t,r,n){var i=Object(f.a)(e,t),a=i.entityTypeName,o=i.recordSetQueryKey;return{areaType:"dialog",entityTypeName:a,formGuid:r,controlUniqueId:n,viewId:o?o.split(",")[1]:void 0}}(r,n,d,p):d?function(e,t,r,n){var i=Object(f.a)(e,t),a=i.entityTypeName,o=i.recordSetQueryKey;return{areaType:"form",entityTypeName:a,recordGuid:i.id,formGuid:r,controlUniqueId:n,viewId:o?o.split(",")[1]:void 0}}(r,n,d,p):s===B.a?function(e,t,r,n){var i=Object(k.cb)(e,n,t);return{areaType:"grid",entityTypeName:r,viewId:i?i.split(",")[1]:void 0}}(r,n,a.entityTypeName,o):{areaType:null,entityTypeName:null,controlUniqueId:p,viewId:void 0},t=!0}return S.a.info(n.controlId+".CustomControlFramework.Selectors.CustomControlHostPersonalizationInfoSelectors: createGetPersonalizationConfiguration finished"),e}}var V=r("pmTS"),z=r("uQP8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function G(e,t,r,n,i){var a=Object(z.a)(e,t),o=i?"__hiddenCommandManagerIds":"__pendingCommandManagerIds",s=Object(O.v)(n);return a&&a[o]&&a[o][s]&&a[o][s][r]?a[o][s][r]:null}var W=r("pdGj"),H=r("vO+w"),U=r("xc1f"),q=p.a.createEvent("CustomControlHostSelectors.mapStateToProps",h.c),X=r("CSbt"),K=r("hXUt"),Q=r("5Fed"),Y=r("PQ2H"),Z=r("Oqm9"),J=r("lMVv"),$=r("Eoze"),ee=r("vYfn"),te=r("i8/j"),re=r("9KTg");function ne(e,t){return{type:re.a,payload:e,meta:{pageId:t}}}function ie(e){return{type:"execute.cleanreferencepanelstate.async",execute:function(t,r){var n=t.dispatch;t.getState;return n(function(e){return{type:re.b,payload:{},meta:{pageId:e}}}(e)),Promise.resolve()}}}function ae(e){return{type:"execute.closeallsessiontabs.async",execute:function(t,r){var n=t.dispatch,i=(0,t.getState)();return n(function(e,t){return{type:re.c,payload:e,meta:{pageId:t}}}({sessionTabs:[],activeTabId:Object(Z.b)(i,e)},e)),Promise.resolve()}}}function oe(e,t){return{type:"execute.closesessiontab.async",execute:function(r,n){var i=r.dispatch,a=(0,r.getState)(),o=Object(Z.d)(a,t),s=Object(Z.a)(a,e,t);return o.splice(e,1),i(function(e,t){return{type:re.d,payload:e,meta:{pageId:t}}}({sessionTabs:o,activeTabId:s},t)),Promise.resolve()}}}function se(e){return{type:"execute.dismissmessage.async",execute:function(t,r){var n=t.dispatch;t.getState;return n(function(e,t){return{type:re.e,payload:{referencePanelState:t},meta:{pageId:e}}}(e,{messageId:""})),Promise.resolve()}}}function ce(e,t){return{type:"execute.initializereferencepanelcontrol.async",execute:function(r,n){var i=r.dispatch,a=r.getState,o=Object(Z.c)(a(),t);if(e&&!(o.activeTabId&&o.controlNames.length>0))return i(function(e,t){return{type:re.f,payload:e,meta:{pageId:t}}}({controlNames:e.map((function(e){return e.Name})),activeTabId:e[0].Id},t)),Promise.resolve()}}}var le=r("sm1J");function ue(e,t){return{type:"execute.addsessiontab.async",execute:function(r,n){for(var i=r.dispatch,a=r.getState,o=Object(Z.d)(a(),t),s=[],c=0;c<o.length;c++)o[c].id===e.id?s.push(e):s.push(o[c]);return i(function(e,t){return{type:re.h,payload:e,meta:{pageId:t}}}({sessionTabs:s},t)),Promise.resolve()}}}var de=r("kvLG"),pe=r("w/nD");var he=r("oj0s"),ge=r("qIF7"),me=r("I6xF"),fe=r("ObKm"),be=r("g9bv"),ye=r("jJRu"),ve=r("GHPx"),_e=r("cAHA");var Se=r("h82J"),Oe=r("pdOk"),Ce=r("RXRQ"),Ie=r("gBKR"),je=r("EcZf"),Pe=r("bCrZ"),Fe=r("olrR"),Te=r("OROb"),we=r("HEkv"),Ee=r("HfRC"),xe=r("evh6"),Ne=r("ya7l"),Ae=r("12n8"),ke=r("4fxQ"),Me=r("wYyS");var De=r("otMa");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var Re=function(){function e(e,t){this.Target=e,this.FieldName=t}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:"CalculateRollupField",operationType:1,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},FieldName:{typeName:"Edm.String",structuralProperty:1}}}},e}(),Be=r("qYad"),Le=r("UR8A"),Ve=r("j6Db");var ze=r("EGsq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Ge=r("969l"),We=r("mGpW"),He=r("Ww2r");var Ue=r("XjtF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function qe(e,t){return{type:"customcontrol.loadresources.async",execute:function(r,n){r.dispatch;var i=r.getState;return function(e,t,r,n){var i=Object(ze.t)(t);return r.initializeContainerForClientApi(n).then((function(t){return t.loadWebResources([Object(ze.a)(i,e)]).then((function(){return{container:t,webResourcePath:i}}))}))}(e,i(),n.ScriptManager,t)}}}var Xe=r("EwXg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Ke=r("n1Ju"),Qe=r("zsi3"),Ye=r("c7nC"),Ze=r("F2uj");var Je=r("8Fmj"),$e=r("w82B"),et=r("y5DA"),tt=r("RwQN"),rt=r("T0dC"),nt=r("/SAa"),it=r("o5EQ"),at=r("8VL5"),ot=r("cqI9"),st=r("Zdrd"),ct=r("Yc9S"),lt=r("0rak"),ut=r("G7N+"),dt=r("/j9Z"),pt=r("sgPk"),ht=r("TCcM"),gt=function(){function e(e,t,r){this.Target=e,this.Query=t,this.RollupType=r}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:"Rollup",operationType:1,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},Query:{typeName:"Microsoft.Dynamics.CRM.QueryBase",structuralProperty:2},RollupType:{typeName:"Microsoft.Dynamics.CRM.RollupType",structuralProperty:3,enumProperties:[,{name:"None",value:0},{name:"Related",value:1},{name:"Extended",value:2}]}}}},e}(),mt=r("Ia1G"),ft=r("CO6B"),bt=r("2IT6"),yt=r("ak18");function vt(e,t){void 0===t&&(t=!1);var r=[];return{type:"gridData.retrieve.rollup.async",execute:function(n,i){var a=n.dispatch,o=n.getState,s=o(),c=e.key,l=pt.a.fromState(e,o),u=Object(ht.u)(s,c,l.pageNumber-1);return u&&(l.pagingCookie=u),r.push({name:yt.a,value:Object(yt.e)(e)}),r.push({name:"isRefresh",value:t}),a(function(e,t,r){var n;void 0===r&&(r=!1);var i={lists:(n={},n[e]={initialized:r?ut.a.Refreshing:ut.a.Initializing,pageSize:t},n)};return{type:"gridData.retrieve.rollup",payload:i}}(c,l.pageSize,t)),function(e,t,r){return r.toQueryExpression(e,t).then((function(n){return t(Object(mt.b)(new gt(I.a.toExternalEntityReference(r.target),n,r.rollupType))).then((function(n){return Object(bt.g)(n).then((function(n){return function(e,t,r,n){var i=r.getKeyQuery(),a=Object(ft.e)(i),o=Object(Ie.e)(a.entity2AttributesMap);return t(o).then((function(){var t=e();return Object(ft.a)(t,i,a,n)}))}(e,t,r,n)}))}))}))}(o,a,l).then((function(e){s=o(),a(Object(je.e)(s,a,c,l,e))})).catch((function(e){Object(dt.b)(e)}))},getFailureParameters:function(e,t){return r},getSuccessParameters:function(e,t,n){return r}}}var _t=r("AVer"),St=r("Z46F"),Ot=r("slAZ");function Ct(e,t,r,n,i){var a="",o="";if(n&&n.message&&(a=n.message),n&&n.errorCode){var s=i||Ve.a,c=function(e){return r.EventManager.ReportComponentFailure(s,e,null,[{name:"hexErrorCode",value:o},{name:"errorStatus",value:JSON.stringify(n)},{name:"customControlId",value:i},{name:"APIName",value:Ve.a+".Actions.RefreshDataSetParameter.getErrorMessage"}]),Promise.resolve(o+" "+a)};try{var l="Error_Title_"+(o="0x"+St.a.getHexErrorCodeFromInt(n.errorCode)),u="Error_Message_"+o,d="Localized resource strings not found for neither "+l+" nor "+u+".  Please add error resources for error code "+o,p=e(Object(We.e)([l])).catch((function(){})),h=e(Object(We.e)([u])).catch((function(){}));return Promise.all([p,h]).then((function(){var e=Object(He.e)(t(),[l,u]),r=Object(He.c)(e,l),n=Object(He.c)(e,u),i="";return(i=function(e){return"0x8005f211"===(null==e?void 0:e.toLowerCase())}(o)?r+(r&&n?": ":"")+n:r||n)?Promise.resolve(o+" "+i):c(d)}))}catch(e){return c(e)}}return Promise.resolve(o+" "+a)}function It(e,t){if(e instanceof nt.a)(r=e.getLatestData()).loading=!0,e.setRefreshingStart();else if(e instanceof it.a||e instanceof rt.a){var r;(r=e.getLatestData())&&(r.working=!0,it.a,e.setWrapperLoadingFlag(!0))}return{type:"customcontrol.refreshDataSetParameter.async",execute:function(r,n){var i=r.dispatch,a=r.getState;if(e instanceof tt.a){var o={retrieveGridDataAction:function(e){return i(Object(je.d)(e))},retrieveViewAction:function(e,t,r,n){return i(Object(Fe.a)(e,t,r,n))},retrieveViewSelectorAction:function(e,t){return i(Object(Fe.b)(e,t))},runPreSearch:function(e,r,n){return i(Object(pe.W)(t,e,r,n))},runSetAdditionalParams:function(e,r,n){return i(Object(pe.X)(t,e,r,n))},refreshCustomDataProviderAction:function(e,t,r,n){return i(Object(at.b)(e,t,r,n))},retreiveChartAction:function(e,t,r){return i(Object(Je.a)(e,t,r))},retreiveChartDataAction:function(e,t,r,n){return void 0===n&&(n=!0),i(Object($e.a)(e,t,r,n))},updateDataSetChartVisualizationId:function(e,t,r){return i(Object(ot.b)(e,t,r))},updateDataSetChartVisualizationType:function(e,t,r){return i(Object(st.b)(e,t,r))},getEntityMetadataAction:function(e,t){return i(Object(Ie.f)(e,!1,t))},getLocalizedErrorMessage:function(e,t){return Ct(i,a,n,e,t)},updateChartFilterExpression:function(e,t,r){return i(Object(ct.c)(e,t,r))},updateChartDrillDownParameters:function(e,t,r){return i(Object(lt.c)(e,t,r))},updateChartErrorInformation:function(e,t,r,n){Object(et.a)(e,i,t,r,n)}};return e.refreshDataSet(a,o,n)}var s={retrieveGridDataAction:function(e){return Object(m.a)(e.rollupType)?i(Object(je.d)(e)):i(vt(e))},retrieveViewAction:function(e,t,r,n){return i(Object(Fe.a)(e,t,r,n))},retrieveViewSelectorAction:function(e,t){return i(Object(Fe.b)(e,t))},runPreSearch:function(e,r,n){return i(Object(pe.W)(t,e,r,n))},runSetAdditionalParams:function(e,r,n){return i(Object(pe.X)(t,e,r,n))},startCustomFilter:function(e,t,r){return i(Object(Ot.f)(e,t,r))},endCustomFilter:function(e,t,r){return i(Object(Ot.e)(e,t,r))},refreshCustomDataProviderAction:function(e,t,r,n){return i(Object(at.b)(e,t,r,n))},getEntityMetadataAction:function(e,t){return i(Object(Ie.f)(e,!1,t))},getLocalizedErrorMessage:function(e){return Ct(i,a,n,e)},getAdditionalResourceStrings:function(e){return i(Object(We.e)(e))},addCustomViewAction:function(e,t,r,n,a,o,s,c){return i(Object(_t.a)(e,t,r,n,a,o,s,c))},setOfflineQueryAction:function(e){return i(Object(_t.b)(e))}};return e.refreshDataSet(a,s,n)}}}var jt=r("IQF2");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Pt=r("bH46"),Ft=r("VZmd");var Tt=r("yrP7"),wt=r("vqdi"),Et=r("LBS5"),xt=r("XJ3n");var Nt=r("zvr0"),At=r("nIt0"),kt=r("455M");var Mt=r("uO/V"),Dt=r("oY7N");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Rt(e,t,r){if(r.dataSetUIOptions){var n=e+t.id,i=t.contextString;switch(t.contextString){case Mt.h.ASSOCIATEDGRID:case Mt.h.SUBGRID:case Mt.h.GRID:break;case Mt.h.CUSTOM:default:i=Mt.h.CUSTOM}return o.createElement(Dt.a,{key:n,id:t.id,systemDefinedProperties:t.systemDefinedProperties,controlId:t.controlId,configuration:t.configuration,descriptor:t.descriptor,formInfo:t.formInfo,themingData:t.themingData,parentDefinedControlProps:t.parentDefinedControlProps,children:t.children,rowSpan:t.rowSpan,contextString:i,parentContextToken:t.parentContextToken,dataSetUIOptions:r.dataSetUIOptions})}return o.createElement(lr,{key:e,id:t.id,systemDefinedProperties:t.systemDefinedProperties,controlId:t.controlId,configuration:t.configuration,descriptor:t.descriptor,formInfo:t.formInfo,themingData:t.themingData,parentDefinedControlProps:t.parentDefinedControlProps,children:t.children,rowSpan:t.rowSpan,contextString:t.contextString,parentContextToken:t.parentContextToken})}var Bt=r("RB3d");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Lt(e){if(e){if(e instanceof I.a)return e;var t,r=e.entityName||e.LogicalName;return t=g.a.fromLegacyGuid(e.Id),g.a.isNullOrEmpty(t)&&(t=new g.a(e.id||e.Id)),new I.a(r,t,Object(m.a)(e.name)?e.Name:e.name)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Vt(e,t,r,n){return n&&n.DisplayName&&"partylist"!==n.Type&&Object(Pt.b)(e,t,r,n)&&n.IsValidForAdvancedFind}var zt=r("q6M9"),Gt=r("IUjT"),Wt=r("eYbs"),Ht=r("RlP9"),Ut=function(){function e(){}return e.prototype.convert=function(e,t,r){var n=(new DOMParser).parseFromString(e,"text/xml"),i=this._firstElementChild(n),a=this._childElements(i);if(!a)return null;for(var o=[],s=0,c=a;s<c.length;s++){for(var l=c[s],u=[],d=0,p=this._childElements(l);d<p.length;d++){var h=p[d];u.push(this._getGridCellDescriptor(h))}o.push(this._getGridRowDescriptor(l,u))}var g=this._getGridDescriptor(i,o,r);return this._populateRelationshipInformation(g,t),g},e.prototype._attributeValueBoolean=function(e,t){return"1"===this._attributeValueString(e,t,"")},e.prototype._attributeValueString=function(e,t,r){var n=e.attributes.getNamedItem(t);return n&&n.value||r},e.prototype._attributeValueInt=function(e,t,r){var n=this._attributeValueString(e,t,r+"");return parseInt(n,10)},e.prototype._childElements=function(e){return e?e.children?Array.from(e.children):e.childNodes?Array.from(e.childNodes).filter((function(e){return e.nodeType===Node.ELEMENT_NODE})).map((function(e){return e})):null:null},e.prototype._getGridCellDescriptor=function(e){return{name:this._attributeValueString(e,"name",""),width:this._attributeValueInt(e,"width",0),relatedEntityName:this._attributeValueString(e,"relatedentityname",""),disableMetaDataBinding:this._attributeValueBoolean(e,"disableMetaDataBinding"),labelId:this._attributeValueString(e,"LabelId",""),isHidden:this._attributeValueBoolean(e,"ishidden"),disableSorting:this._attributeValueBoolean(e,"disableSorting"),addedBy:this._attributeValueString(e,"addedby",""),desc:this._attributeValueString(e,"desc",""),cellType:this._attributeValueString(e,"cellType",""),imageProviderWebresource:this._attributeValueString(e,"imageproviderwebresource",""),imageProviderFunctionName:this._attributeValueString(e,"imageproviderfunctionname","")}},e.prototype._getGridRowDescriptor=function(e,t){return{name:this._attributeValueString(e,"name",""),id:this._attributeValueString(e,"id",""),cells:t,multiObjectIdField:this._attributeValueString(e,"multiobjectidfield",""),layoutStyle:this._attributeValueString(e,"layoutstyle","")}},e.prototype._getGridDescriptor=function(e,t,r){return{name:this._attributeValueString(e,"name",""),object:r,rows:t,customControlDescriptions:null,jump:this._attributeValueString(e,"jump",""),select:this._attributeValueBoolean(e,"select"),icon:this._attributeValueBoolean(e,"icon"),preview:this._attributeValueBoolean(e,"preview"),iconrenderer:this._attributeValueString(e,"iconrenderer","")}},e.prototype._firstElementChild=function(e){if(!e)return null;if(e.firstElementChild)return e.firstElementChild;var t=this._childElements(e);return t&&t[0]},e.prototype._populateRelationshipInformation=function(e,t){var r=(new DOMParser).parseFromString(t,"text/xml"),n=this._firstElementChild(r),i=this._firstElementChild(n),a=this._childElements(i);if(a)for(var o=0,s=a;o<s.length;o++){var c=s[o];"link-entity"===c.nodeName&&this._attributeValueString(c,"alias","")&&this._attributeValueString(c,"name","")&&this._setRelatedEntityName(e,this._attributeValueString(c,"alias",""),this._attributeValueString(c,"name",""))}},e.prototype._setRelatedEntityName=function(e,t,r){for(var n=0;n<e.rows.length;n++)for(var i=0;i<e.rows[n].cells.length;i++){var a=e.rows[n].cells[i].name;(a?a.substring(0,a.indexOf(".")):void 0)===t&&(e.rows[n].cells[i].relatedEntityName=r)}},e}(),qt=r("bIXa"),Xt=r("r0s4");function Kt(e,t,r,n,i,a,o,s){return void 0===t&&(t=!1),{type:"populateAndSend.LookupData.Action",sync:!0,execute:function(c,l){var u=c.dispatch,d=(0,c.getState)(),p=i||e.LookupEntityByName[0].EntityLogicalName,h=Object(Gt.f)(d,p,o,n),m=[];if(s){var b=s.split("."),v=Object(f.g)(d,n),_=void 0,S=Object(y.ac)(d,n,r),O=Object(j.b)(d,S);_=O&&O.activeChanges&&O.activeChanges[b[1]]?O.activeChanges[b[1]]:Object(ht.j)(d,new I.a(b[0],v.id),b[1]),e.RelatedRecordId=_&&_.reference&&_.reference.id}if(e.LookupEntityByName&&e.LookupEntityByName.length)for(var C=Object(y.eb)(d,n,r),P=C&&C[a],F=0,T=e.LookupEntityByName;F<T.length;F++){var w=T[F],E=Object(qt.b)(d,n,r,a,w.EntityLogicalName);if(E&&(w.CustomFilter=Object(Xt.CrmHtmlDecode)(E).replace(/"/g,"'")),h){var x=Object(Wt.a)(d,h,w.EntityLogicalName);x&&x.view&&(g.a.equals(x.view.viewId,w.ViewId)||Object(Ht.c)(d,w.ViewId))||m.push(u(Object(Fe.a)(w.EntityLogicalName,null,null,w.ViewId)))}var N=P&&P.parameters&&P.parameters.defaultviewid;if(P&&P.views&&P.views[N]&&P.views[N].entityLogicalName===w.EntityLogicalName){w.ViewId=null,w.FetchXml=P.views[N].fetchXML.replace(/"/g,"'");var A=Object(J.h)(d,w.EntityLogicalName),k=new Ut;w.LayoutJson=JSON.stringify(k.convert(P.views[N].layoutXML,P.views[N].fetchXML,A.ObjectTypeCode)).replace(/"/g,"'")}}var M=Object(zt.b)(d,p,e),D=Object(ht.o)(d,M);t=t||D===ut.a.Initialized,m.push(u(Object(zt.d)(e,t)));var R=function(e,t,r,n,i){var a,o,s={},c=n||r.EntityAndAttribute&&r.EntityAndAttribute.EntityName,l=i||r.EntityAndAttribute&&r.EntityAndAttribute.AttributeName;if(!c&&!l)return null;c||(c="placeholderEtn");if(r.LookupEntityByName)for(var u=0,d=r.LookupEntityByName;u<d.length;u++){var p=d[u];s[p.EntityLogicalName]=Object(zt.b)(e,p.EntityLogicalName,r)}var h=Object(zt.c)(e,r);return{type:"update.lookupRequestDataKey",payload:(a={},a[c]=(o={},o[l]={metadataKey:h,dataKeys:s},o),a),meta:{pageId:t}}}(d,n,e,i,o);return R&&u(R),Promise.all(m)}}}var Qt=r("kRDR"),Yt=r("CcDq");var Zt,Jt,$t,er,tr=r("feNe"),rr=r("aBa1");function nr(e,t){return{openEditForm:function(r,n,i,a,o){var s=Lt(r);e(n?Object(Ee.a)(s,t.id,void 0,void 0,n,i,a,o):Object(Ee.a)(s,t.id))},openGridPage:function(r,n,i,a,o,s,c,l){e(Object(xe.a)(r,t.id,g.a.tryParseOrNull(n),i,a,g.a.tryParseOrNull(o),s,null,l,c))},openCreateForm:function(r,n,i){e(Object(ee.b)(new I.a(r),null,"QuickCreate")).then((function(a){e(Object(ge.b)(r,t.id,null,n,Lt(i)))})).catch((function(i){e(Object(Ee.a)(new I.a(r),t.id,void 0,n))}))},openSearch:function(r){e(Object(Ae.a)(r,null,t.id))},openPowerBIFullScreenPage:function(r,n,i,a,o,s,c){e(Object(Ne.a)(t.id,r,n,i,a,o,s,c))},openDashboard:function(e){},openUrl:function(e,t){},openUrlWithProtocol:function(e,t){},openPhoneNumber:function(r,n,i,a,o,s,c,l,u,d,p){return void 0===d&&(d=!1),void 0===p&&(p=!0),e(function(e,t,r,n,i,a,o,s,c,l,u,d){return void 0===u&&(u=!1),void 0===d&&(d=!0),{type:"customcontrol.openphonecall",execute:function(p,h){var m=e.trim(),f=Object(ze.x)(p.getState()).defaultCountryCode;0!==m.indexOf("tel:")?(f&&(m=f+m),m="tel:"+m):f&&(m=m.slice(0,4)+f+m.slice(4));var b,y=new Yt.a(h,p);h.ScriptManager.containerExists(Qt.d)&&(b=h.GlobalCustomEventManager);var v=function(){if(u){var c=null,l={};if(t){c=new I.a(r,new g.a(t));var d={id:t,entityType:r,name:n},h=d;a&&(h={id:a,entityType:o,name:s}),l.contactinfo=e,l.to=[d],l.regardingobjectid=h}return p.dispatch(Object(ge.b)("phonecall",i,null,l,c,null,{entityName:"phonecall",showDialog:!0}))}};return y.canOpenUri(m).then((function(e){if(d&&b&&p.dispatch(b.runOnOpenUrl(i,m,l,c)))return null;var t=Object(w.c)(p.getState(),T.C);e?(y.openUri(m),t&&v()):u&&t&&v()}),(function(){return null}))},shouldReceiveFullStore:!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(r,i,n,a,t.id,s,o,c,l,u,d,p))},openMaps:function(e){},openMap:function(e){}}}var ir=r("6Tlt"),ar=r("lU69"),or=r("Wg6j"),sr=r("uGUB"),cr=Object(i.a)((function(){var e,t={},r=null,i={},a={},o={},s=!1,c="",d=null,p={},h=!1,O="",C=!1,I={stateToPropsMappingError:!1,dynamicData:null,manifest:null,personalizationState:null,propBagData:null,pageType:null,popupStack:null,contextToken:null,portalFlyoutToDialogId:null,designLanguage:null,inactive:!1},j=-1,P=-1,F=Object(A.a)(),T=Object(V.a)(),w=L(),E=x();return function(x,N){S.a.info(N.configuration.CustomControlId+".CustomControlFramework.Selectors.CustomControlHostSelectors: makeMapStateToProps started");var A,k,M,D,R,B=q.startStopwatch({controlId:N.controlId,parentId:Object(l.p)(N),level:(0).toString()}),L=[],V=!1,z=null,X=null,K=null,Q=null,Y=null,Z=null,J=null,$=null,ee=null,te=null,re=!1,ne=null,ie=null,ae=null,oe=!1;try{var se=null;N.formInfo?(d&&p.EntityName===N.formInfo.EntityName&&p.RecordId===N.formInfo.RecordId&&p.FormId===N.formInfo.FormId||(d={id:N.formInfo.RecordId?new g.a(N.formInfo.RecordId):null,formId:N.formInfo.FormId?new g.a(N.formInfo.FormId):null,entityTypeName:N.formInfo.EntityName},p=N.formInfo),se=d):se=Object(f.g)(x,N.id),X=N.descriptor,K=N.configuration,M=Object(b.b)(x),A=Object(f.l)(x,N.id),Object(f.f)(x,N.id)&&(R="DialogContainer__"+N.id),!R&&N.parentDefinedControlProps&&N.parentDefinedControlProps.parentFlyoutId&&(R=N.parentDefinedControlProps.parentFlyoutId),A&&(k=E(x,N));var ce=Object(y.kb)(x,N,k),le=K;if(null!==N.systemDefinedProperties){var ue=Object(n.__assign)(Object(n.__assign)({},K.Parameters),N.systemDefinedProperties);le=Object(n.__assign)(Object(n.__assign)({},K),{Parameters:ue})}if(!(Q=Object(_.e)(x,K.CustomControlId)||Object(_.e)(x,K.Name))||!Q.ConstructorName){Q=null;var de=Object(u.h)(K.CustomControlId);de!==K.CustomControlId&&(Q=Object(_.e)(x,de))}Q&&(J=($=T(x,Q,se,ce,N.contextHelper)).response,te=(Y=(Z=F(le,X,N,x,se,k)).response)&&Y.dataReady?w(x,N,X,se,k,A):null,ee=Object(v.a)(x,te,Q.CustomControlId,N.id));var pe=G(x,N.id,N.controlId,k);pe&&(re=pe.every((function(e){return Object(W.b)(x,e)}))),D=G(x,N.id,N.controlId,k,!0),ie=N.parentDefinedControlProps&&!Object(m.a)(N.parentDefinedControlProps.height)?N.parentDefinedControlProps.height:-1,ne=N.parentDefinedControlProps&&!Object(m.a)(N.parentDefinedControlProps.width)?N.parentDefinedControlProps.width:-1,ae=Object(H.b)(x)?Object(H.a)(x):null,oe=function(e,t,r,n){return Object(f.l)(e,t)===U.a&&!Object(y.Fb)(e,t,r,n)}(x,N.id,k,N.descriptor.Name)}catch(e){var he=Q.ConstructorName;S.a.error(he+": makeMapStateToProps encountered error, err "+e,[{name:"ApiName",value:"CustomControlFramework.Selectors.CustomControlHostSelectors"},{name:"controlId",value:N.controlId},{name:"customControlId",value:Q.CustomControlId},{name:"manifest",value:JSON.stringify(Q)},{name:"descriptor",value:JSON.stringify(X)},{name:"configuration",value:JSON.stringify(K)},{name:"error.Stack",value:JSON.stringify(e.stack)}]),V=!0,z=e.toString()+". Stack: "+e.Stack}return r&&(L=L.concat(function(e,t){var r=[];return e.Disabled!==t.Disabled&&r.push("IsControlDisabled"),e.Label!==t.Label&&r.push("Label"),r}(X,r))),r=N.descriptor,Y!==i||Q!==t||J!==a||te!==o||V!==s||A!==c||re!==h||D!==e||ie!==P||ne!==j||R!==O||ae!==I.designLanguage||oe!==C?(ie===P&&ne===j||L.push("layout"),Z&&(L=L.concat(Z.updatedProperties)),$&&(L=L.concat($.updatedProperties)),ae!==I.designLanguage&&L.push("design"),I={stateToPropsMappingError:V,stateToPropsMappingErrorMessage:z,dynamicData:Y,manifest:Q,personalizationState:ee,propBagData:J,children:K&&K.Children,personalizationConfiguration:te,pageType:A,popupStack:M,contextToken:k,updatedProperties:L,globalCommandManagerInitialized:re,internalCommandManagerIds:D,portalFlyoutToDialogId:R,designLanguage:ae,inactive:oe},h=re,e=D,O=R,s=V,a=J,t=Q,i=Y,o=te,c=A,P=ie,j=ne,C=oe):I.updatedProperties=L,B({updatedProperties:JSON.stringify(L)}),S.a.info(N.configuration.CustomControlId+".CustomControlFramework.Selectors.CustomControlHostSelectors: makeMapStateToProps finished"),I}}),(function(){var e;return function(t,r){if(e)return e;var n=nr(t,r);return Zt={setNotification:function(e,r,n,i,a,o,s){return t(function(e,t,r,n,i,a,o){return{type:"customcontrol.propertybag.mode.setnotification",execute:function(s,c){var l=s.dispatch,u=s.getState,d={uniqueId:t||"",messages:[e],priority:0,notificationLevel:Qe.a.error,actions:[{actions:[function(){}],message:""}]};l(Object(Ke.b)(r,n,d,i));var p=u(),h=new I.a(a,g.a.fromExternalGuid(o)),m=Object(Ze.a)(p,h.etn,n);return h&&m&&(2===m.RequiredLevel||1===m.RequiredLevel)&&l(Object(Ye.b)(r,n,!1,i)),!0},sync:!0}}(e,r,n,i,a,o,s))},clearNotification:function(e,r,n,i,a,o){return t(function(e,t,r,n,i,a){return{type:"customcontrol.propertybag.mode.clearnotification",execute:function(n,i){var o=n.dispatch,s=n.getState,c=Object(y.A)(s(),{controlName:t,id:e},r);if(c){a=a||"";for(var l=Object.keys(c),u=null,d=l.length-1;d>-1;--d)l[d]===a&&((u=c[l[d]]).actions=null,u.messages=null,u.notificationLevel=null,o(Object(Ke.b)(e,t,u,r)))}return!0},sync:!0}}(e,r,n,0,0,o))}},$t={setState:function(e){return!0},logMessage:function(e,r,n){t(function(e,t,r){return{type:"customcontrol.log",execute:function(n,i){n.dispatch,n.getState;var a=i.TraceManager.getTracer("customcontrol"),o=e+": "+t;switch(r){case Xe.a.Error:a.error(o);break;case Xe.a.Info:a.info(o);break;case Xe.a.Warning:a.warn(o);break;case Xe.a.Verbose:a.debug(o)}},sync:!0}}(e,r,n))}},Jt={isGetBarcodeValueOperationAvailable:function(){return t(Object(De.c)())},isTakePictureOperationAvailable:function(){return t(Object(De.e)())},isCaptureVideoOperationAvailable:function(){return t(Object(De.b)())},isCaptureAudioOperationAvailable:function(){return t(Object(De.a)())},isOpenARViewerAvailable:function(){return t(Object(De.d)())}},er={clearNestedChild:function(e){return!0},createAccessibilityComponent:Bt.a,createCommandManagerUXComponent:function(){var e=null;return function(t){var r=dr(t);return hr(e,t.selectedRecords)?r.selectedRecords=e:e=r.selectedRecords,ur(r)}},createKeyboardShortcut:Bt.b,createXrmForm:function(e,r,n,i){return function(e,t,r,n,i){return!!e(Object(Et.b)(t,r,n,new g.a(i)))}(t,e,r,n,i)},createXrmGrid:function(e,r,n,i){var a=[C.a.AssociatedGrid,C.a.CustomGrid,C.a.SubGrid,C.a.MainGrid];if(e&&-1===a.indexOf(e.contextTokenType))for(var o in n)if("Grid"===n[o].Type){var s=n[o];t(Object(Pe.c)(s.TargetEntityType||s.EntityName,s.ViewId,r,e));break}return function(e,t,r,n,i){var a=Object(k.vb)(n);if(t){var o=void 0;switch(t.contextTokenType){case C.a.SubGrid:o=3;break;case C.a.AssociatedGrid:o=2;break;case C.a.MainGrid:case C.a.CustomGrid:o=1;break;default:var s=[{name:"contextToken",value:JSON.stringify(t)},{name:"controlName",value:i},{name:"isEditableGrid",value:a}];de.a.getInstance().eventManager.ReportComponentFailure("ClientApi.XrmCommandObjectWrapper.createXrmGridWrapper",new Error("Unknown context token type for grid"),null,s),o=1}return!!e(Object(Et.c)(t,r,a,o,i))}return!0}(t,e,r,n,i)},registerNewControl:function(e,r,n,i){return function(e,t,r,n,i){return!!e(Object(Et.e)(t,r,n,i))}(t,e,r,n,i)},executeAddOnLoad:function(e,r){t(function(e,t){return{type:"customcontrol.executeAddOnLoad.async",sync:!0,execute:function(r,n){var i=r.dispatch;r.getState,e.gridRunOnLoad((function(e,r,a){if(n.ScriptManager.containerExists(e)){var o=n.ScriptManager.getContainer(e).getEventManager();i(o.runOnGridDataLoad(t,1,a,r))}}))}}}(e,r))},addSessionTab:function(e,r){return t(function(e,t){return{type:"execute.addsessiontab.async",execute:function(r,n){var i=r.dispatch,a=(0,r.getState)(),o=Object(Z.d)(a,t),s=!0;if(e){if(o.forEach((function(t){e.id===t.id&&(s=!1)})),s){if("quickViewFormTab"===e.type){var c=!1,l=e,u=Object(Y.a)(6),d=Object(J.E)(a,l.entityFormOptions.entityName),p=void 0;p=a.data.entities.activitypointer&&a.data.entities.activitypointer.hasOwnProperty(l.entityFormOptions.entityId)?Object(y.ec)(a,"activitypointer",new g.a(l.entityFormOptions.entityId)):Object(y.ec)(a,l.entityFormOptions.entityName,new g.a(l.entityFormOptions.entityId));var h=new I.a(l.entityFormOptions.entityName,new g.a(l.entityFormOptions.entityId)),m=[];if(!p){var f=i(Object($.d)(h,[d]));m.push(f)}var b=Object(te.h)(a,l.entityFormOptions.entityName,u);if(g.a.isNullOrEmpty(b)){var v=i(Object(ee.b)(h,null,u)).then((function(e){b=e,g.a.isNullOrEmpty(b)||b===ee.a||(c=!0)}));m.push(v)}else c=!0,l.entityFormOptions.formId=b.guid;Promise.all(m).then((function(){l.entityFormOptions.formId=c?b.guid:"",l.entityMetadata={DisplayName:a.metadata.entities[l.entityFormOptions.entityName].DisplayName},a.data.entities.activitypointer&&a.data.entities.activitypointer.hasOwnProperty(l.entityFormOptions.entityId)?l.title=Object(y.ec)(a,"activitypointer",new g.a(l.entityFormOptions.entityId)):l.title=Object(y.ec)(a,l.entityFormOptions.entityName,new g.a(l.entityFormOptions.entityId)),o.unshift(l),i(ne({sessionTabs:o,activeTabId:l.id,messageId:c?"":"quick_view_form_not_exist_message"},t))}))}else o.unshift(e),i(ne({sessionTabs:o,activeTabId:e.id},t));return Promise.resolve()}i(ne({sessionTabs:o,activeTabId:e.id},t))}}}}(e,r))},closeSessionTab:function(e,r){return t(oe(e,r))},updateSessionTab:function(e,r){return t(ue(e,r))},closeAllSessionTabs:function(e){return t(ae(e))},dismissMessage:function(e){return t(se(e))},markActiveTab:function(e,r,n){return t(Object(le.b)(e,r,n))},initializeReferencePanelControl:function(e,r){return t(ce(e,r))},cleanReferencePanelState:function(e){return t(ie(e))},executeNotifyHandlersThatEventOccurred:function(e){return t(function(e){return{type:"execute.notifyhandlersthatevenoccurred.async",execute:function(t,r){var n=t.dispatch,i=t.getState,a=null;try{switch(e.eventName){case"onresultopened":n(Object(pe.U)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onselection":n(Object(pe.V)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onpostsearch":n(Object(pe.S)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onlookuptagclick":var o=e.contextToken,s=e.fieldName,c=e.record,l=!1,u=Object(pe.u)("ClientApi.ExecuteNotifyHandlersThatEventOccurred.runOnLookupTagClick",i(),r,e.pageId,c);u&&(l=n(u.runOnLookupTagClick(o,s,null,c,i()))),a=l}return Promise.resolve(a)}catch(e){throw de.a.getInstance().eventManager.ReportComponentFailure("ClientApi.ExecuteNotifyHandlersThatEventOccurred.executeNotifyHandlersThatEventOccurred",e),e}}}}(e))},getConnectorsApi:function(e){return null},executeRollupRequest:function(e,r,n){return t(function(e,t,r){return{type:"customcontrol.executeRollupRequest.async",execute:function(n,i){var a=n.dispatch;if(n.getState,e&&t){var o=new Re(e,t),s=Le.a.execute(o).then((function(e){return e.json()})).then((function(n){if(n){var o=[];for(var s in n)-1!==s.indexOf("@")||s.startsWith("_")||o.push(s);var c=new I.a(e.entityType,g.a.fromExternalGuid(e.id));return a(Object(Be.a)(r,c,o)).then((function(){i.EventManager.ReportComponentSuccess(Ve.a+".Action",[{name:"APIName",value:Ve.a+".Action.ExecuteRollupRequest"},{name:"target.entityType",value:e.entityType}])}),(function(r){i.EventManager.ReportComponentFailure(Ve.a+".Actions",r,"refreshRecordData failure error message",[{name:"APIName",value:Ve.a+".Actions.ExecuteRollupRequest"},{name:"target.entityType",value:e.entityType},{name:"target.id",value:e.id},{name:"fieldName",value:t},{name:"jsonResponse",value:n}])}))}}));return Le.a.Diagnostics.traceInfo(Ve.a+".refreshRecordData","refresh record data return promise"),s}return Promise.resolve()}}}(e,r,n))},getResource:function(e){return t(function(e){return{type:"customcontrol.getresources.async",execute:function(t,r){t.dispatch;var n=t.getState,i=r.AssetLoader,a=n(),o=Object(ze.t)(a);if(3===e.Type||2===e.Type)return i.loadRawData(o+e.Name)}}}(e))},getRecordSetQueryKey:function(e){return e?e.getPreviousQueryKey():null},loadResources:function(e){return t(Object(Ue.a)(e))},triggerOfflineMetadataSync:function(){return t(Object(Oe.h)())},retrieveFormWithAttributes:function(e,r,n){return t(Object(Pt.c)(new I.a(e),g.a.tryParse(r),n))},loadManifest:function(e,r){return t(Object(Ce.c)(e,r))},updateOutputs:function(e,r,n,i,a,o,s){return t(function(e,t,r,n,i,a,o){return{type:"outputs.update",execute:function(s,c){var l=s.dispatch,u=s.getState;try{var d={},p={};if(a)for(var h=0,g=Object.keys(a);h<g.length;h++){var m=g[h],f=a[m],b=m;switch(f.fieldName&&(b=f.fieldName),(f.paramType===kt.a.LookupSimple||f.paramType===kt.a.LookupCustomer||f.paramType===kt.a.LookupOwner||f.paramType===kt.a.LookupRegarding||f.paramType===kt.a.LookupMultiEntity)&&f.value&&f.value instanceof Array&&(f.value.length>0?f.value=f.value[0]:f.value=null),f.type){case 0:d[b]=a[m];break;case 2:p[b]=a[m]}}var y=new Array,v=l(Object(fe.a)(e,d,!1,!1,t,r,i,o));if(y.push(v),Object(z.a)(u(),e).forms){var _=l(Object(Nt.b)(e,n,o,p));y.push(_)}else{var O=l(Object(At.b)(e,n,p));y.push(O)}return Promise.all(y)}catch(i){var C=n+" failed at updating its outputs",I=Object(S.b)(u(),n);return c.EventManager.ReportComponentFailure(I+".CustomControl.updateOutputs",i,C,[{name:"APIName",value:Ve.a+".Actions.UpdateOutputs"},{name:"customControlId",value:n},{name:"pageId",value:e},{name:"entityTypeName",value:t},{name:"recordId",value:r},{name:"outputs",value:JSON.stringify(a)}]),c.TraceManager.getTracer("customcontrol").warn(I+" failed at updating its outputs"),null}},sync:!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,r,n,i,a,o,s))},updateFieldValue:function(e,r,n,i,a,o,s){return t(Object(fe.a)(e,r,!1,n,i,a,o,s))},runCustomOpenRecord:function(e,r,n,i){return t(function(e,t,r,n){return{type:"record.open",execute:function(i,a){var o=a.ScriptManager.getContainer(e).getEventManager(),s=new g.a(r),c=Object(O.f)(n,s,t),l=i.dispatch(Object(Et.b)(c,e,t,s));return l=new xt.a(i,a,c,e,t,s),i.dispatch(o.runOnRecordOpen(n,r,l))}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,r,n,i))},getBoundFileObject:function(e,r,n,i){if(null==e||null==r||null==r.id||null==n)return null;var a={id:new g.a(r.id),etn:r.entityType};return t(Object(tr.c)(e,a,n,i,"full"))},saveEmbeddedEntity:function(e,r,n,i,a,o,s,c){return void 0===s&&(s=!1),t(Object(wt.a)(e,r,n,i,a,o,s,c))},renderNestedCustomControl:Rt,renderReactSubtree:ke.createPortal,retrieveView:function(e,r,n,i){return t(Object(Fe.a)(e,r,n,i))},retrieveViewSelector:function(e,r){return t(Object(Fe.b)(e,r))},retrieveGridData:function(e){return t(Object(je.d)(e))},retrieveRecordDataForForm:function(e,r,n,i,a){return t(Object($.e)(Lt(e),g.a.tryParse(r),n,i,a))},retrieveForm:function(e,r,n){var i=g.a.tryParse(r),a=Lt(e);return t(Object(ee.b)(a,i,n)).then((function(e){return t(Object(he.c)(i,a.etn)).then((function(){return e}))}))},retrieveEntityData:function(e){return t(Object(Ie.f)(e,!1,[]))},retrieveChartDrilldownAttributes:function(e){return t((r=e,{type:"customcontrol.charts.attributes.retrieve.async",execute:function(e,t){var n=e.dispatch,i=e.getState;return n(Object(Ie.f)(r,!0,[])).then((function(){var e=i(),t=Object(Ze.d)(e,r);if(t&&Object.keys(t).length>0){var n={};for(var a in t){var o=t[a];Vt(e,r,a,o)&&(n[a]=o)}return n}return null}),(function(e){var n=e.get_message();return t.EventManager.ReportComponentFailure(Ve.a+".CustomControl.retrieveChartDrilldownAttributes",new Error(n),n,[{name:"APIName",value:Ve.a+".Actions.RetrieveChartDrilldownAttributes"},{name:"Entity",value:r}]),null}))}}));var r},refreshDataSetParameter:function(e,r){return t(It(e,r))},retrieveLookupMetadataAction:function(e){return t((r=e,{type:"customcontrol.retrieveLookupMetaData.async",execute:function(e,t){var n=e.dispatch,i=e.getState;if(r instanceof Ft.a){var a={retrieveGridDataAction:function(e){return n(Object(je.d)(e))},retrieveViewAction:function(e,t,r,i){return n(Object(Fe.a)(e,t,r,i))},retrieveViewSelectorAction:function(e,t){return n(Object(Fe.b)(e,t))},runPreSearch:function(e,t,r){return n(Object(pe.W)(Object(O.j)(i(),e),e,t,r))},runSetAdditionalParams:function(e,t,r){return n(Object(pe.X)(Object(O.j)(i(),e),e,t,r))},refreshCustomDataProviderAction:function(e,t,r,i){return n(Object(at.b)(e,t,r,i))},getEntityMetadataAction:function(e,t){return n(Object(Ie.f)(e,!1,t))}};return r.retrieveLookupMetadata(i,a)}}}));var r},retrieveDataSetLookupCellParameter:function(e,r,n){return t(function(e,t,r){return{type:"customcontrol.retrieveDataSetLookupCellParameter.async",execute:function(n,i){var a=n.dispatch,o=n.getState;return a(It(t,r)).then((function(){var r=t.retrieveDataSetObject(o(),e,i);return Promise.resolve(r)})).catch((function(e){i.EventManager.ReportComponentFailure(Ve.a+".Actions",{name:"error",message:e.get_message()},null,[{name:"APIName",value:Ve.a+".Actions.RetrieveDataSetLookupCellParameter"}])}))}}}(e,r,n))},updateControlMemoizedDataSet:function(e,r,n){return t(function(e,t,r){return{type:"customcontrol.updateControlMemoizedDataSet",sync:!0,execute:function(n,i){n.dispatch;var a=(0,n.getState)(),o=e.retrieveDataSetObject(a,null,null,null,i);e.linkToParameter(o,t),e.updateControlMemoizedParameter(a,o,!0,r)}}}(e,r,n))},loadResourceStrings:function(e){return t((r=e,{type:"customcontrol.loadresourcestrings.async",execute:function(e,t){var n=e.dispatch,i=e.getState,a=r.CustomControlId;if(!a)return Promise.resolve();var o=i(),s=Ge.a.getControlsResourceKeyList(a);if(!s)return Promise.resolve();var c=Object(He.d)(o);if(!c)return n(Object(We.e)(s));for(var l=[],u=0,d=s;u<d.length;u++){var p=d[u];c.hasOwnProperty(p)||l.push(p)}return 0===l.length?Promise.resolve():n(Object(We.e)(l))}}));var r},retrieveLookupData:function(e){return t(Object(je.d)(e))},setFieldControlPersonalization:function(e,r,n){return t(Object(we.j)(e,r,n))},setGridControlPersonalization:function(e,r,n){return t(Object(we.m)(e,r,n))},setDashboardControlPersonalization:function(e,r,n){return t(Object(we.i)(e,r,n))},setGenericControlPersonalization:function(e,r,n){return t(Object(we.k)(e,r,n))},setGlobalControlPersonalization:function(e,r){return t(Object(we.l)(e,r))},setPowerBISignedInState:function(e,r){return t(Object(me.b)(e,r))},beginSecureSessionForResource:function(e,r,n,i){return t(function(e,t,r,n){return{type:"customcontrol.beginsecuresessionforresource",execute:function(i,a){var o=new Me.a(a,i);return n?o.beginSecureSessionForResource(e,t,r):o.beginSecureSessionForResourceSilent(e,t,r)},shouldReceiveFullStore:!0}}(e,r,n,i))},setXrmObject:function(e){},addPendingCommandManagerId:function(e,r,n,i){var a;return t(Object(Tt.a)(e,r,n,i)),{promise:new Promise((function(e){a=e})),resolve:a}},initializeCommandManager:function(e,r,n,i,a){var o;return t(Object(Tt.b)(e,r,n,i,a)),{promise:new Promise((function(e){o=e})),resolve:o}},retrieveRecordCommand:function(e,r,n,i,a,o,s,c,l,u){return t(Object(Tt.c)(u,e,r,n,i,a,o,s,c,l))},setValue:function(e,r,n,i){return e&&r?t(function(e,t,r,n){var i=[{name:"snapshotId",value:n},{name:"entityTypeName",value:t.etn},{name:"attributeNameValuePairs.length",value:r?Object.keys(r).length:null}];return{type:"control.update.value.by.snapshot.async",execute:function(a,o,s){var c=a.dispatch,l=(0,a.getState)(),u=Object(O.j)(l,e),d=Object(O.x)(u),p=Object(ve.a)(l,n,t,r,!1,u,o.TraceManager.getTracer("Forms.UpdateValue")),h=g.a.isNullOrEmpty(t.id)?_e.a.Create:_e.a.Update;if(i.push({name:"CorrelationId",value:s.correlationId},{name:"ContextId",value:s.contextId},{name:"ActionStack",value:s.stack},{name:"mode",value:h}),n)return c(Object(be.b)(l,n,p)),o.EventManager.ReportComponentSuccess("Forms.UpdateValue.updateDataSnapshot",i),Promise.resolve();var m=Object(ye.b)(l,t,p,d,h),f=m.payload.snapshotId;return c(m),i.push({name:"newSnapshotId",value:f}),o.EventManager.ReportComponentSuccess("Forms.UpdateValue.createDataSnapshotAction",i),Promise.resolve(f)},getFailureParameters:function(e,t){return i}}}(i,e,r,n)).then((function(e){return Promise.resolve(e||n)})):Promise.reject("setValue: entityReference and controlKeyValuePairs parameters are required")},save:function(e,r){return void 0===r&&(r=[]),t(Object(Te.c)(e,!1,r))},openPopup:function(e){return t(Object(Q.a)(e))},closePopup:function(e){return t(Object(K.a)(e))},loadWebResource:function(e,r){return t(qe(e,r))},registerOngoingWork:function(e,r,n,i){return t(function(e,t,r,n){return{type:"customcontrol.registerworkoutstanding",execute:function(i,a){return i.dispatch,i.getState,jt.a.getInstance().addWorkOutstandingPromise(e,t,r,n),Promise.resolve()}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,r,n,i))},isPresenceEnabledEntity:function(e){return Object(X.b)(e)},getPresenceMappedField:function(e){return Object(X.a)(e)},fireXrmEvent:function(e,r,n,i,a){var o=t(Object(Se.b)(r,n)),s=null;if(o&&o.ui&&o.ui.controls&&(s=o.ui.controls.get(e)),s)switch(i){case 0:s.fireOnKeyPress&&s.fireOnKeyPress()}},sendLookupRequest:function(e,r,n,i,a,o,s){return t(Kt(e,!0,r,n,i,a,o,s))},runPreSearch:function(e,r,n){t(function(e,t,r){return{type:"CCF.RunPreSearch",execute:function(n){var i=n.dispatch;n.getState,i(Object(Ot.f)(r,t,e)),i(Object(pe.W)(e,r,t)),i(Object(pe.X)(e,r,t)),i(Object(Ot.e)(r,t,e))},sync:!0}}(e,r,n))},runOnReadyStateComplete:function(e,r,n){t(function(e,t,r){return{type:"CCF.RunOnReadyStateComplete",execute:function(n,i){var a=n.dispatch;n.getState,i.ScriptManager.containerExists(t)&&a(i.ScriptManager.getContainer(t).getEventManager().runOnReadyStateComplete(e,null,r))},sync:!0}}(e,r,n))},retrieveLookupRecordsBySearchString:function(e,r,n){return t(Object(rr.a)(e,r,n))},retrieveLookupRecordsByIds:function(e,r,n){return t(Object(rr.b)(e,r,n))}},e={actions:er,propBagMethods:{utils:$t,navigation:n,device:Jt,mode:Zt}}}}))(s.a),lr=function(e){function t(t,r){var n=e.call(this,t)||this;return n._updateCounter=0,n._isUpdateScheduled=!1,n._reRunMapStateToProps=function(){n._isUpdateScheduled||(n._isUpdateScheduled=!0,Object(sr.c)((function(){n._isUpdateScheduled=!1,n._updateCounter++,n.forceUpdate()})))},n._reRunMapStateToProps=n._reRunMapStateToProps.bind(n),n}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=null,t=null;return this.context&&this.context.CustomControlGlobalHelper&&(e=this.context.CustomControlGlobalHelper,t=this.context.TraceManager.getLogLevel()),o.createElement(c.a.Provider,{value:this.context},o.createElement(cr,Object(n.__assign)({},this.props,{contextHelper:e,logLevel:t,updateCounter:this._updateCounter,reRunMapStateMainProps:this._reRunMapStateToProps})))},t}(o.Component);function ur(e){var t="cm"+Object(ar.a)();return o.createElement(ir.a,{commandbarDisplayMode:e.commandbarDisplayMode,addedCommandList:e.addedCommandList,key:e.key,iconPosition:e.iconPosition,id:e.id,commandManagerId:e.commandManagerId||t,ribbonId:e.ribbonId,selectedRecords:e.selectedRecords,width:e.width,metaDataLoadedResolve:e.metaDataLoadedResolve,isHidden:e.isHidden,commandBarStyle:e.commandBarStyle,customCommandManagerStyle:e.customCommandManagerStyle,contextToken:e.contextToken,rootZIndex:e.rootZIndex,customControlType:e.customControlType})}function dr(e){return{commandbarDisplayMode:void 0!==e.commandbarDisplayMode&&null!==e.commandbarDisplayMode?e.commandbarDisplayMode:or.a.IconLabel,id:e.id,commandManagerId:e.commandManagerId,ribbonId:e.ribbonId,mainMenuLength:e.mainMenuLength,iconPosition:e.iconPosition,selectedRecords:pr(e.selectedRecords),key:e.key,commandBarStyle:e.commandBarStyle,customCommandManagerStyle:e.customCommandManagerStyle,isHidden:e.isHidden,width:e.width,metaDataLoadedResolve:e.metaDataLoadedResolve,addedCommandList:e.addedCommandList,contextToken:e.contextToken,rootZIndex:e.rootZIndex,customControlType:e.customControlType}}function pr(e){var t=[];if(e)for(var r=0,n=e;r<n.length;r++){var i=n[r];t.push(Lt(i))}return t}function hr(e,t){if(e===t)return!0;if(e&&t&&e.length===t.length){for(var r=e.length,n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}return!1}lr.contextType=a.a},NfcN:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="form.referenceinformationbyrelationship";function i(e,t){return{type:n,payload:t,meta:{pageId:e}}}},Nhrb:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return a}));var n=r("Sscr"),i=r("uO/V"),a="control.update.parameter";function o(e,t,r,o,s){return{type:"control.update.parameter.async",execute:function(c,l){var u=c.dispatch,d=(c.getState,i.x+".updateControlParameterAction");u(function(e,t,r,o,s){var c=Object(n.v)(s);return{type:a,payload:{name:r,value:o},meta:{pageId:e,dataSetContextKey:c,controlName:i.o}}}(e,0,r,o,s));var p=[];return p.push({name:"controlName",value:t}),p.push({name:"paramName",value:""+r}),l.EventManager.ReportComponentSuccess(d,p),Promise.resolve()}}}},Oiu5:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return o})),r.d(t,"b",(function(){return s})),r.d(t,"d",(function(){return c}));var n=r("Gemh");function i(e){var t=Object(n.m)(e),r=e&&e.metadata?e.metadata.entities:null,i=[];return r?(t.forEach((function(e){if(4200!==r[e].ObjectTypeCode){var t=function(e){var t=e.DisplayName,r=e.ObjectTypeCode.toString();return{entityDisplayName:t,objectTypeCode:r}}(r[e]);i.push(t)}})),i.sort(a)):i}function a(e,t){var r=e.entityDisplayName,n=t.entityDisplayName,i=0;return r>n?i=1:r<n&&(i=-1),i}function o(e){for(var t=[],r=0;r<e.length;r++){var n={key:e[r].objectTypeCode,text:e[r].entityDisplayName};t.push(n)}return t}function s(e){return e?e.split(","):[]}function c(e){return e?e.map((function(e){return{key:e.value,text:e.text}})):[]}},OmYs:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="section.label";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r,a){var o=Object(n.v)(t);return{type:i,payload:a,meta:{pageId:e,contextKey:o,sectionName:r}}}},PLtI:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="tab.setlabel";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r,a){var o=Object(n.v)(t);return{type:i,payload:a,meta:{pageId:e,contextKey:o,tabId:r}}}},PZxu:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n,i=r("Gemh"),a=r("Zy0S"),o=r("XJ3n"),s=r("+Z9T"),c=r("Sscr"),l=r("9r0m"),u=r("TCcM"),d=r("QAhb"),p=r("9rlF"),h=r("IiPO"),g=r("w/nD"),m=r("ezfI"),f=r("/j9Z"),b=r("kvLG"),y=function(){function e(e,t,r,i,a,o,c){var l="ClientApi.XrmControlGrid.constructor";if(i||Object(s.j)(l,"pageId"),r||Object(s.j)(l,"contextToken"),e||Object(s.j)(l,"store"),a||Object(s.j)(l,"gridEntity"),Object(s.a)(o)&&Object(s.j)(l,"isEditable"),n=e,this._applicationContext=t,this._contextToken=r,this._pageId=i,this._gridEntityName=a,this.controlName=c,this._isEditable=o,!this._contextToken.contextTokenType){var u=h.a.getInstance().getEventParameters(this._contextToken);u.push({name:"controlName",value:this.controlName}),u.push({name:"gridEntityName",value:this._gridEntityName}),h.a.getInstance().reportFailure(l,new f.a("context token passed to grids with empty context token type"),null,u)}}return Object.defineProperty(e.prototype,"_isEditable",{get:function(){var e=Object(i.V)(n.getState(),this._pageId,this._gridEntityName,this._contextToken,this.controlName);if(null===e){var t=h.a.getInstance().getEventParameters(this._contextToken);return t.push({name:"controlName",value:this.controlName}),t.push({name:"gridEntityName",value:this._gridEntityName}),b.a.getInstance().eventManager.ReportComponentFailure("ClientApi.XrmControlGrid._isEditable_get",new f.a("control configuration parameters not found"),null,t),this._isGridEditable}return e},set:function(e){this._isGridEditable=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"applicationContext",{get:function(){return m.a.instance.reportUsage("ClientApi.XrmControlGrid.applicationContext_get"),this._applicationContext},set:function(e){m.a.instance.reportUsage("ClientApi.XrmControlGrid.applicationContext_set")},enumerable:!1,configurable:!0}),e.prototype.getTotalRecordCount=function(){var e="ClientApi.XrmControlGrid.getTotalRecordCount";try{m.a.instance.reportCall(e);var t=Object(i.Y)(n.getState(),this._pageId,this._contextToken);if(t){var r=JSON.parse(t),a=r&&r.totalResultCount?r.totalResultCount:0;return m.a.instance.reportSuccess(e),a}return m.a.instance.reportSuccess(e),0}catch(t){var o=h.a.getInstance().getEventParameters(this.contextToken);throw o.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(e,t,null,o),t}},e.prototype.getRows=function(){var e="ClientApi.XrmControlGrid.getRows";try{m.a.instance.reportCall(e);var t=new a.a(e),r=n.getState(),s=Object(i.H)(r,this.contextToken,{id:this.pageId});if(s)for(var l=0;l<s.length;l++){var u=s[l].identifier.id,d=this._getRowEntityName(s[l],u),p=new o.a(n,this._applicationContext,Object(c.f)(this.contextToken,u,d),this.pageId,d,u),g=s[l].identifier.id.guid;t.add(g,p)}return m.a.instance.reportSuccess(e),t}catch(t){var f=h.a.getInstance().getEventParameters(this.contextToken);throw f.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(e,t,null,f),t}},e.prototype.getSelectedRows=function(){var e="ClientApi.XrmControlGrid.getSelectedRows";try{m.a.instance.reportCall(e);var t=new a.a(e),r=Object(i.fb)(n.getState(),this.pageId,this.contextToken);if(r)for(var s=Object(i.Q)(n.getState(),this.pageId,this.contextToken),d=function(e){var a=void 0;if(s)a=s;else{var d=n.getState(),h=Object(i.v)(d,p.pageId,p.contextToken),g=(h&&h.queryKey&&Object(u.q)(d,h.queryKey,null,null,!0)||[]).find((function(t){return t.identifier&&l.a.equals(t.identifier.id,r[e])}));a=p._getRowEntityName(g,r[e])}var m=new o.a(n,p._applicationContext,Object(c.f)(p.contextToken,r[e],a),p.pageId,a,r[e]),f=r[e].guid;t.add(f,m)},p=this,g=0;g<r.length;g++)d(g);return m.a.instance.reportSuccess(e),t}catch(t){var f=h.a.getInstance().getEventParameters(this.contextToken);throw f.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(e,t,null,f),t}},e.prototype.addOnRecordSelect=function(e){var t="ClientApi.XrmControlGrid.addOnRecordSelect";if(this._isEditable){e||Object(s.j)(t,"handler");try{m.a.instance.reportCall(t),n.dispatch(Object(g.m)(this.contextToken,this.pageId,e,this.controlName)),m.a.instance.reportSuccess(t)}catch(e){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(t,e,null,r),e}}},e.prototype.removeOnRecordSelect=function(e){var t="ClientApi.XrmControlGrid.removeOnRecordSelect";if(this._isEditable){e||Object(s.j)(t,"handler");try{m.a.instance.reportCall(t),n.dispatch(Object(g.H)(this.contextToken,this.pageId,e,this.controlName)),m.a.instance.reportSuccess(t)}catch(e){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(t,e,null,r),e}}},e.prototype.runOnRecordSelect=function(e){var t="ClientApi.XrmControlGrid.runOnRecordSelect";try{m.a.instance.reportCall(t),this._isEditable&&n.dispatch(Object(g.T)(this.contextToken,this.pageId,e,this.controlName)),m.a.instance.reportSuccess(t)}catch(e){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype._getRowEntityName=function(e,t){var r=e&&e.identifier?e.identifier.etn:this._gridEntityName;if("activitypointer"===r){var i=Object(u.j)(n.getState(),new d.a(this._gridEntityName,t),"activitytypecode");if(Object(p.j)(i))return i.value}return r},Object.defineProperty(e.prototype,"pageId",{get:function(){return this._pageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"contextToken",{get:function(){return this._contextToken},enumerable:!1,configurable:!0}),e}()},PhZR:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="navigation.item.label";function i(e,t,r,i){return{type:n,payload:{label:r,currentLanguageId:i},meta:{pageId:e,navigationItemId:t}}}},"Pm+b":function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r("7z0H"),i=r("bCrZ"),a=r("Sscr");function o(e,t,r){var i=Object(a.v)(r),o={xrmReady:e};return{type:n.b,payload:o,meta:{pageId:t,contextKey:i}}}function s(e,t,r){var n=Object(a.u)(r),o={xrmReady:e};return{type:i.b,payload:o,meta:{pageId:t,contextKey:n}}}},Q60c:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="controls.DefaultView";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r,a){var o=Object(n.v)(r);return{type:i,payload:a.guid,meta:{pageId:e,controlName:t,contextKey:o}}}},QItn:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="control.mrudisabled";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r,a,o){var s=Object(n.v)(a);return{type:i,payload:o,meta:{pageId:t,controlName:r,contextKey:s}}}},Qeyq:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(){return{tabId:"",navigationStack:[]}}r.d(t,"a",(function(){return n}))},RB3d:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return s}));var n=r("nuS9"),i=r("B73A"),a=r("akzq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t,r,n,a,o){return new i.a(e,(function(e){t(e.EVENT)}),r,n,a,o)}function s(e){return n.createElement(a.a,{key:e.id,keyboardShortcuts:e.keyboardShortcuts,defaultFocusId:e.defaultFocusId,rootElementId:e.rootElementId,isModal:e.isModal,shouldManageFocus:e.shouldManageFocus||!1})}},SdPQ:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="header.bodyvisible";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r){var a=Object(n.v)(t);return{type:i,payload:r,meta:{pageId:e,contextKey:a}}}},SgZb:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r("c/eZ"),i=r("HSdq"),a=r("+ieV"),o=r("zsi3"),s=r("yHpA"),c=r("Sscr"),l=r("UGbr"),u=r("LFYt"),d=r("71iK"),p=r("p5Y6"),h=r("zpQF"),g=r("8//c"),m=r("Srej");function f(e,t){return{type:"saveAndNew.quickCreateFormAction.async",execute:function(r,f,b){var y=r.dispatch,v=(0,r.getState)(),_=Object(c.j)(v,t),S=Object(i.zb)(v,t,_),O=Object(i.ac)(v,t,_);if(Object(s.g)(v,O)||!S)return y(Object(l.e)(t,59)).then((function(r){var a=Object(i.Ib)(v,t),o=a?"Forms.MainFormDialogRoot.SaveAndNew":"Forms.QuickCreateFormRoot.SaveAndNew";if(r){var s=[{name:"isEntityRefNull",value:!1},{name:"entityTypeName",value:r.etn}];return f.EventManager.ReportComponentSuccess(o,s),(a?Promise.resolve(t):y(Object(u.b)(t,r))).then((function(i){return y(Object(d.a)(r.etn)),y(Object(p.a)(i)).then((function(){var i=Object(n.__assign)(Object(n.__assign)({},e),{id:null});return y(Object(h.b)(i,t)),y(Object(g.b)(t,!0)),r}))}))}f.TraceManager.getTracer().error("Record is not created",[{name:"isEntityRefNull",value:!0}])})).catch((function(e){f.TraceManager.getTracer().error("Record is not created",e)}));for(var C in S){var I=S[C].label,j=S[C].errorMessage,P=y(Object(a.b)(I,j));y(Object(a.c)(_,t,P,o.a.error,Object(m.d)(t,C)))}}}}},ShM1:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r("J1L+"),i=r("9kE/"),a=r("Gh4N"),o=r("Wv+H"),s=r("IrUg"),c=r("7JDo"),l=r("RoqB"),u={root:"ms-Spinner",circle:"ms-Spinner-circle",label:"ms-Spinner-label"},d=Object(o.a)({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}),p=Object(n.a)(i.a,(function(e){var t,r=e.theme,n=e.size,i=e.className,o=e.labelPosition,p=r.palette,h=Object(s.a)(u,r);return{root:[h.root,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},"top"===o&&{flexDirection:"column-reverse"},"right"===o&&{flexDirection:"row"},"left"===o&&{flexDirection:"row-reverse"},i],circle:[h.circle,{boxSizing:"border-box",borderRadius:"50%",border:"1.5px solid "+p.themeLight,borderTopColor:p.themePrimary,animationName:d,animationDuration:"1.3s",animationIterationCount:"infinite",animationTimingFunction:"cubic-bezier(.53,.21,.29,.67)",selectors:(t={},t[c.b]={borderTopColor:"Highlight"},t)},n===a.a.xSmall&&["ms-Spinner--xSmall",{width:12,height:12}],n===a.a.small&&["ms-Spinner--small",{width:16,height:16}],n===a.a.medium&&["ms-Spinner--medium",{width:20,height:20}],n===a.a.large&&["ms-Spinner--large",{width:28,height:28}]],label:[h.label,r.fonts.small,{color:p.themePrimary,margin:"8px 0 0",textAlign:"center"},"top"===o&&{margin:"0 0 8px"},"right"===o&&{margin:"0 0 0 8px"},"left"===o&&{margin:"0 8px 0 0"}],screenReaderText:l.a}}),void 0,{scope:"Spinner"})},Ss07:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("c/eZ"),i=r("nuS9"),a=function(e){function t(t){var r=e.call(this,t)||this;return r.state={isRendered:!1},r}return Object(n.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props.delay;this._timeoutId=window.setTimeout((function(){e.setState({isRendered:!0})}),t)},t.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)},t.prototype.render=function(){return this.state.isRendered?i.Children.only(this.props.children):null},t.defaultProps={delay:0},t}(i.Component)},TCDU:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r("1Tfq"),i=r("aGOT"),a=r("HSdq"),o=r("kk/C"),s=r("OTOS"),c=r("Sscr"),l=r("yHpA"),u=r("2p2B"),d=r("Srej");function p(e){return{type:"handle.unsaved.changes.async",execute:function(t,r,p){var h=t.dispatch,g=t.getState;return h(Object(n.a)(e)).then((function(t){if(t){for(var r=Object(s.a)(g(),e),n=r.map((function(e){return Object(c.j)(g(),e)})),p=0;p<r.length;p++){for(var m=r[p],f=n[p],b=Object(a.ac)(g(),m,f),y=Object(l.b)(g(),b),v=0,_=(null==y?void 0:y.activeChanges)?Object.keys(y.activeChanges):[];v<_.length;v++){var S=_[v];h(Object(u.b)(f,m,Object(d.d)(m,S)))}h(Object(i.c)(m,b,f)),h(Object(o.d)(m,f))}return!0}return!1}))}}}},Tr6b:function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"c",(function(){return M})),r.d(t,"b",(function(){return D}));var n=r("c/eZ"),i=r("ASFs"),a=r("VcAV"),o=r("i8/j"),s=r("HSdq"),c=r("2OIc"),l=r("sOTk"),u=r("hadW"),d=r("455M"),p=r("wV3W"),h=r("5olG"),g=r("LAsh");var m,f=r("UOiB"),b=r("Sscr"),y=r("lMVv"),v=r("JlqV"),_=r("uO/V"),S=r("Gemh"),O=r("aPRd"),C=r("DgF7"),I=r("9r0m"),j=r("Ev4I"),P=r("F2uj"),F=r("cZkS"),T=r("qC0c"),w=r("wQXd"),E=r("OTOS"),x=r("Ww2r"),N=r("CUpQ"),A=[d.a.LookupSimple,d.a.LookupPartyList,d.a.LookupRegarding,d.a.LookupOwner,d.a.LookupCustomer,d.a.LookupMultiEntity],k=[u.c,u.i,u.h];function M(){var e,t,r=null,m=null,O=null,M=null,R=null,B=null,L=null,V=null,z=null,G=null,W=null,H=null,U=!1,q=0,X=null,K={descriptor:null,configuration:null,configurations:null,contextKey:null,defaultCellStyle:null,spacerCellStyle:null,extraSidePaddingStyle:null,parentContextToken:null,formInfo:null,clientHost:null,clientHostSubtype:null,isRemoteAvailable:!1,isEntityEnabledForOffline:!1,informationAvailableToRender:!1,cellControlMode:0,isCreateForm:!1,isRelatedDataSetControl:!1,isPreviewMode:!1},Q=Object(s.h)(),Y=function(){var e=null,t=null,r=null,i=null;return function(c,u){if(!u.controlName)return t;null===i&&(i=Object(T.c)(c,F.bd));var d=Object(E.b)(c,u.id);if(d){var p=Object(b.j)(c,u.id),h=Object(o.b)(c,u.id,d,u.controlName);if(h){var g=h.Visible,m=h.Label,f=h.Disabled,y=h.Parameters&&h.Parameters.DisableMru,O=h.Url,C=Object(s.w)(c,u,p);a.c(C)||(m=C);var j=Object(s.G)(c,u,p);a.c(j)||(g=j);var P=Object(s.t)(c,u,p);a.c(P)||(f=P);var w=Object(s.D)(c,u,p);a.c(w)||(O=w);var x=Object(s.x)(c,u,p);a.c(x)||(y=x);var N=I.a.tryParseOrNull(Object(s.K)(c,u.id,u.controlName,p));if(N&&I.a.equals(N,r)){var A=Object(b.p)(p,u.controlName),k=Object(b.v)(A),M=Object(b.h)(k);N=Object(S.T)(c,u.id,M,u.controlName)||N}if(!I.a.equals(N,r)){for(var D in r=N,h.Parameters)if(h.Parameters[D].Name===_.C){h=Object(n.__assign)({},h),i&&(h.Parameters=Object(n.__assign)({},h.Parameters),h.Parameters[D]=Object(n.__assign)({},h.Parameters[D])),h.Parameters[D].Value=I.a.toString(N);break}h.Parameters[_.C]=I.a.toString(N)}if("TaskBasedFlow"!==Object(l.l)(c,u.id)||Object(v.b)(c)||(f=!0),h!==e||g!==t.Visible||m!==t.Label||f!==t.Disabled||O!==t.Url||y!==t.Parameters.DisableMru){e=h;var R=O?Object(n.__assign)(Object(n.__assign)({},e.Parameters),{Url:O,isCustomSrc:Object(s.E)(c,u,p),length:e.Parameters.length}):e.Parameters;(t=Object(n.__assign)(Object(n.__assign)({},h),{Visible:g,Label:m,Disabled:f,Url:O,Parameters:R})).Parameters.DisableMru=y}}else e=null,t=null}return t}}(),Z=function(){var e=null;return function(t,r,n){var i=n;if(i&&i.Relationship){var o=Object(s.U)(t,r,i.Relationship);if(o)e&&e.EntityName===o.etn&&e.RecordId===o.id.guid||(e={EntityName:o.etn,RecordId:o.id.guid});else{var c=Object(l.g)(t,r.id);if(c){var u=Object(y.x)(t,c.entityTypeName,i.Relationship);u&&u.ReferencedEntity&&(e&&e.EntityName===u.ReferencedEntity&&a.c(e.RecordId)||(e={EntityName:u.ReferencedEntity}))}}}return e}}(),J=D(),$=(e=null,t=null,function(r,n){var i=Object(p.a)(r),a=Object(h.a)(i.sizes.Section.cellHeightInRem);if(t!==i){t=i;var o=Object(g.a)(i);e={defaultCellStyle:{flex:"1 1 auto",width:"100%",whiteSpace:"nowrap",overflowX:"hidden",overflowY:"hidden",minHeight:a+"px"},spacerCellStyle:{height:i.sizes.Measures.Measure350},extraSidePaddingStyle:{paddingLeft:o.paddingLeft,paddingRight:o.paddingRight,width:"auto"}}}return e});return function(e,t){var n=Y(e,t),o=m,h=M,g=R,y=B,S=Z(e,t,n),D=Object(C.a)(e),ee=Object(C.e)(e),te=!0;n&&n.Relationship&&S&&a.c(S.RecordId)&&(n.Disabled=!0);var re=Object(E.b)(e,t.id),ne=n?Object(c.b)(e,n.UniqueId,re):null;if((n&&(n!==r||n.Parameters.hasOwnProperty(s.d))||0!==q)&&(o=Q(e,n,t.id,re,S&&S.EntityName,!1,g)),0===q&&o&&n&&n.Parameters&&Object(T.c)(e,F.y)){var ie=n.Parameters,ae=I.a.tryParse(ie.VisualizationId);I.a.isNullOrEmpty(ae)||"Chart"!==ie.ChartGridMode||(q=2)}!h&&o&&(y=Object(b.j)(e,t.id),g=Object(b.p)(y,t.controlName),h=Object(b.v)(g));var oe=Object(s.u)(e,{id:t.id,controlName:t.controlName},y)?Object(x.b)(e,N.d)||"The control has been disabled with a URL parameter":null;if(0===q&&o){var se=n&&n.ClassId&&n.ClassId.guid?n.ClassId.guid:null;se&&d.a.ClassIdControlMap[se.toLowerCase()]===_.t&&(q=1),0===q&&o&&o.Parameters&&Object.keys(o.Parameters).map((function(e){return o.Parameters[e]})).filter((function(e){return e.Type===d.a.Grid})).length>0&&(q=1)}if(1===q)g=Object(b.p)(y,n.Name),h=Object(b.v)(g);else if(o&&o.Parameters&&o.Parameters.value){var ce=o.Parameters.value;if(A.indexOf(ce.Type)>-1){var le=ce;if(le){var ue=Object(s.C)(e,t.id,o.Name,Object(b.j)(e,t.id)),de=ue&&ue.parameters&&ue.parameters.DefaultViewId,pe=ue&&ue.parameters&&ue.parameters.defaultviewid;pe?le.ViewId=pe:de&&(le.ViewId=de)}}}V=J(t,e,g);var he=Object(i.e)(B,y),ge=Object(i.e)(R,g),me=Object(v.b)(e),fe=!(!S||!S.EntityName)&&Object(j.l)(e,S.EntityName);if(g&&g.parentContextToken&&g.parentContextToken.contextTokenType===f.a.MainForm&&Object(s.Rc)(e,t.id,n)){var be=g.parentContextToken.entityTypeName;if(S&&S.EntityName)be=S.EntityName;else{var ye=Object(l.g)(e,t.id);ye&&ye.entityTypeName&&(be=ye.entityTypeName)}Object(P.a)(e,be,n.DataFieldName)||(te=!1)}var ve=Object(l.m)(e,t.id),_e=!1;if(1!==q&&2!==q||(_e=!!(n&&n.Parameters&&n.Parameters.RelationshipName)),n!==r||o!==m||S!==L||O!==ne||!he||!ge||z!==D||G!==ee||W!==me||H!==fe||U!==te||q!==K.cellControlMode||ve!==K.isCreateForm||_e!==K.isRelatedDataSetControl||X!==oe){var Se=$(e,t);if(n&&n.ClassId&&(I.a.equals(n.ClassId,u.e)&&(Se.defaultCellStyle.overflowX="visible",Se.defaultCellStyle.overflowY="visible"),function(e){return k.filter((function(t){return I.a.equals(e,t)})).length>0}(n.ClassId))){var Oe=Object(p.a)(e);Se.defaultCellStyle.minHeight=(t.rowSpan?t.rowSpan:1)*Oe.sizes.Section.cellHeightInRem+"rem"}K={descriptor:n,configuration:o,configurations:ne,contextKey:h,contextToken:g,defaultCellStyle:Se.defaultCellStyle,spacerCellStyle:Se.spacerCellStyle,extraSidePaddingStyle:Se.extraSidePaddingStyle,parentContextToken:y,customControlPropertyBag:V,formInfo:S,clientHost:D,clientHostSubtype:ee,isRemoteAvailable:me,isEntityEnabledForOffline:fe,informationAvailableToRender:te,cellControlMode:q,isCreateForm:ve,isRelatedDataSetControl:_e,isPreviewMode:Object(w.d)(e),disableWebResourceControlsMessage:oe},r=n,m=o,M=h,R=g,B=y,L=S,O=ne,z=D,G=ee,W=me,H=fe,U=te,X=oe}return K}}function D(){var e={Usage:1,Static:!0,Type:"WholeNumber.None",Value:0,Primary:!1},t={Usage:1,Static:!0,Type:"WholeNumber.None",Value:0,Primary:!1},r={Usage:1,Static:!0,Type:"WholeNumber.None",Value:m.EditForm,Primary:!1},n={Usage:1,Static:!0,Type:"TwoOptions",Value:!1,Primary:!1},i={Usage:1,Static:!0,Type:"TwoOptions",Value:!1,Primary:!1},a={Usage:1,Static:!0,Type:"TwoOptions",Value:!0,Primary:!1},o={Usage:1,Static:!0,Type:"TwoOptions",Value:!1,Primary:!1},c={deviceSizeMode:e,viewportSizeMode:t,syncError:n,isEmpty:a,scope:r,forceColumnLayout:i,autoExpand:o};return function(l,u,d){var h=Object(s.Cc)(u,l,d),g=function(e){var t=Object(p.a)(e),r=t.sizes.Breakpoints.DimensionM,n=t.sizes.Breakpoints.DimensionS,i=Object(O.c)(e);return i<n?2:i<r?1:0}(u),m=1===l.cellLabelPosition;return l.cellSizeMode===e.Value&&h===n.Value&&l.scope===r.Value&&g===t.Value&&m===i.Value&&l.autoExpand===o.Value||(e.Value=l.cellSizeMode,t.Value=g,r.Value=l.scope,n.Value=h,i.Value=m,o.Value=l.autoExpand,c={deviceSizeMode:e,viewportSizeMode:t,scope:r,isEmpty:a,syncError:n,forceColumnLayout:i,autoExpand:o}),c}}!function(e){e[e.Header=0]="Header",e[e.EditForm=1]="EditForm",e[e.Footer=2]="Footer"}(m||(m={}))},"U/bH":function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return d}));var n=r("Sscr"),i=r("uO/V"),a=r("Gemh"),o=r("VWqI"),s=r("EwXg"),c=r("BFwB"),l=r("+Xnp"),u="dataset.dependentoptionset.column.status";function d(e,t){var r=[];return{type:"dependentoptionset.column.status",sync:!0,execute:function(o,l,d){var m=o.dispatch,f=o.getState,b=l.TraceManager.getTracer(i.z),y=i.x+".SetDependentOptionSetColumnStatusAction";l.TraceManager.setLogLevel(s.a.Info,y);try{var v=Object(n.v)(t),_=f(),S=null,O=Object(a.Q)(f(),e,t),C={};if(O)S=O;else{var I=Object(a.S)(f(),{id:e},t);I&&I.entityLogicalName&&(S=I.entityLogicalName)}if(S){r.push({name:"CorrelationId",value:d.correlationId},{name:"ContextId",value:d.contextId},{name:"ActionStack",value:d.stack},{name:"PageId",value:e},{name:"EntityTypeName",value:S}),b.info("Executing initialize dependent option set column status action in grid.",r);var j={name:"NumPartialDependentOptionSetChainAttributesInGrid",value:0},P=[],F=0,T=Object(a.z)(_,t,S,e);for(var w in T){var E=T[w];if(null===E.ParentPicklistLogicalName){var x={name:w,value:0};p(_,t,e,S,T,w,x)?h(T,w,C,j):(g(T,w,C),F++,P.push(x))}else void 0===T[E.ParentPicklistLogicalName]&&h(T,w,C,j)}var N={name:"NumCompleteDependentOptionSetChainsInGrid",value:F},A={name:"CompleteChainsMaxDepthInGrid",value:P};r.push(N,j,A);var k=new c.a(y);k.addEventParameter("NumCompleteDependentOptionSetChainsInGrid",F),k.addEventParameter("NumPartialDependentOptionSetChainAttributesInGrid",j.value),k.addEventParameter("CompleteChainsMaxDepthInGrid",P),l.EventManager.ReportEvent(k),l.EventManager.ReportComponentSuccess(y),b.info("Executed initialize dependent option set column status action successfully.",r)}Object.keys(C).length>0&&m(function(e,t,r){return{type:u,payload:r,meta:{pageId:e,dataSetContextKey:t}}}(e,v,C))}catch(e){l.EventManager.ReportComponentFailure(y,Error("creating dependent option set column status node in state tree failed."))}}}}function p(e,t,r,n,i,a,s){if(void 0===i[a])return!0;if(function(e,t,r,n,i){if(!Object(o.f)(e,i,n,l.a.CanUpdate)||!r[n].IsValidForUpdate)return!0;return!1}(e,0,i,a,n))return!0;var c=i[a].ChildPicklistLogicalNames;if(null!==c)for(var u=0;u<c.length;u++){var d={name:a,value:0};if(p(e,t,r,n,i,c[u],d))return!0;s.value=Math.max(s.value,d.value)}return s.value=s.value+1,!1}function h(e,t,r,n){if(void 0!==e[t]){r[t]=0,n.value=n.value+1;var i=e[t].ChildPicklistLogicalNames;if(i)for(var a=0;a<i.length;a++)h(e,i[a],r,n)}}function g(e,t,r){r[t]=1;var n=e[t].ChildPicklistLogicalNames;if(n)for(var i=0;i<n.length;i++)g(e,n[i],r)}},UVKb:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n,i=r("qC0c"),a=r("lFQy"),o=r("t8f4"),s=r("Y70o"),c=r("WS0f"),l="ProcessControl_ActionExecuter_ExecutionTimeTooltip",u="ProcessControl_ActionExecuter_ErrorMessageTooltip",d="cc_MscrmControls.Containers.ProcessBreadCrumb/strings/ProcessControlResources";function p(e){switch(e){case n.InProgress:case n.Waiting:return 1;case n.Succeeded:return 2;case n.Failed:case n.Canceled:return 3;default:return 0}}function h(e,t,r,i){var a="";if(Object(c.b)(e)||(a=String.format(i[l],new Date(e).toLocaleString())),r===n.Failed){var o=Object(c.b)(t)?i.Crm_GenericErrorMessage:t;a+="\n"+String.format(i[u],o)}return""===a?t:a}function g(e,t){return{type:"businessProcessFlow.actionLogs.retrieve",execute:function(r,n){var c=r.dispatch,g=r.getState,m=String.format("?$select=workflowlogid,message,status,modifiedon,stepname,activityname,_asyncoperationid_value&$filter=activityname%20eq%20'{0}'%20and%20_asyncoperationid_value%20eq%20{1}&$orderby=modifiedon%20desc&$top=500",e.guid,t.id.guid),f=g();if(function(e){return Object(i.b)(e,"BpfActionSupportActionQuerying")}(f))return c(Object(o.e)("workflowlog",m)).then((function(e){if(e.value&&e.value.length){var r={};r[l]=Object(s.a)(f,d,l),r[u]=Object(s.a)(f,d,u),r.Crm_GenericErrorMessage=Object(s.a)(f,d,"Crm_GenericErrorMessage");var n={};e.value.forEach((function(e){if(e.stepname&&-1===Object.keys(n).indexOf(e.stepname)){var t={actionLogId:e.workflowlogid,status:p(e.status),modifiedOn:e.modifiedon,stepId:e.stepname,processDefinitionid:e.activityname,processInstanceid:e._asyncoperationid_value,message:h(e.modifiedon,e.message,e.status,r)};n[e.stepname]=t}}));var i={actionLogCollection:n};return c(Object(a.a)(i,t))}}))}}}!function(e){e[e.InProgress=1]="InProgress",e[e.Succeeded=2]="Succeeded",e[e.Failed=3]="Failed",e[e.Canceled=4]="Canceled",e[e.Waiting=5]="Waiting"}(n||(n={}))},VHYb:function(e,t,r){"use strict";r.d(t,"a",(function(){return Ie}));var n,i,a,o,s,c,l,u,d,p=r("c/eZ"),h=r("ASFs"),g=r("nn4v"),m=r("3IUl"),f=[],b=Object(h.d)(((n={})[m.a]=function(e,t){return void 0===e&&(e=f),t.payload?t.payload:e},n),f),y=r("bc+P"),v=Object(h.d)(((i={})[y.a]=function(e,t){return void 0===e&&(e=null),t?t.payload:e},i),null),_=r("Ds7n"),S=r("krRo"),O=r("9r0m"),C=Object(h.d)(((a={})[_.a]=function(e,t){return void 0===e&&(e=null),t.payload?t.payload:e},a[S.b]=function(e,t){if(void 0===e&&(e=null),e&&e.records){var r=e.records.filter((function(e){return Object.keys(e)[0]===O.a.toString(t.payload.recordId)}));if(r&&r.length){var n=r[0];n&&n[O.a.toString(t.payload.recordId)]&&n[O.a.toString(t.payload.recordId)].filter((function(e){return Object.keys(e)[0]===t.payload.attributeName}))&&(void 0!==t.payload.requiredLevel&&(n[O.a.toString(t.payload.recordId)].filter((function(e){return Object.keys(e)[0]===t.payload.attributeName}))[0][t.payload.attributeName].requiredLevel=t.payload.requiredLevel),void 0!==t.payload.isDisabled&&(n[O.a.toString(t.payload.recordId)].filter((function(e){return Object.keys(e)[0]===t.payload.attributeName}))[0][t.payload.attributeName].isDisabled=t.payload.isDisabled),void 0!==t.payload.notifications&&(n[O.a.toString(t.payload.recordId)].filter((function(e){return Object.keys(e)[0]===t.payload.attributeName}))[0][t.payload.attributeName].notifications=t.payload.notifications))}}return e},a[S.a]=function(e,t){return void 0===e&&(e=null),e},a),null),I=r("19Zc"),j={activityOrQueue:null,jumpBar:null,quickFind:null,advancedFindFilter:null,activityOrQueueFilterValue:null,activityTypeFilter:null,activityTypeSelectedValues:null},P=function(e,t){switch(void 0===e&&(e=j),t.type){case I.e:return Object(p.__assign)(Object(p.__assign)({},e),{activityOrQueue:t.payload});case I.b:return Object(p.__assign)(Object(p.__assign)({},e),{activityTypeFilter:t.payload});case I.f:return Object(p.__assign)(Object(p.__assign)({},e),{jumpBar:t.payload});case I.g:return Object(p.__assign)(Object(p.__assign)({},e),{quickFind:t.payload});case I.d:return Object(p.__assign)(Object(p.__assign)({},e),{activityOrQueueFilterValue:t.payload});case I.c:return Object(p.__assign)(Object(p.__assign)({},e),{advancedFindFilter:t.payload});case I.a:return Object(p.__assign)(Object(p.__assign)({},e),{activityTypeSelectedValues:t.payload});default:return e}},F=Object(h.d)(((o={})[I.e]=P,o[I.f]=P,o[I.g]=P,o[I.d]=P,o[I.c]=P,o[I.b]=P,o[I.a]=P,o),j),T=r("7oc5"),w=Object(h.d)(((s={})[T.a]=function(e,t){return void 0===e&&(e=false),e!==t.payload?t.payload:e},s),false),E=r("d26+"),x=Object(h.d)(((c={})[E.a]=function(e,t){return void 0===e&&(e=""),t.payload?t.payload:e},c),""),N=r("whwt"),A=Object(h.d)(((l={})[N.a]=function(e,t){return void 0===e&&(e=false),t.payload&&"showChart"===t.payload.name?t.payload.value:e},l),false),k=r("Cgjg"),M={customFilterXml:null,source:null,timeStamp:null},D=Object(h.d)(((u={})[k.a]=function(e,t){return void 0===e&&(e=M),null!=t.payload?t.payload:e},u),M),R=r("zETL"),B=Object(h.d)(((d={})[R.a]=function(e,t){if(t.payload)return t.payload;return e},d),0);var L,V=r("JVfT"),z=Object(h.d)(((L={})[V.a]=function(e,t){if(t.payload)return t.payload;return e},L),0);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var G,W=r("0bF2"),H=Object(h.d)(((G={})[W.a]=function(e,t){return void 0===e&&(e=null),t.payload?t.payload:e},G),null);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function U(e,t){return t.payload?t.payload:e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function q(e,t){return void 0===e&&(e=!1),e!==t.payload?t.payload:e}var X,K,Q,Y,Z=r("Nhrb"),J=Object(h.d)(((X={})[Z.a]=function(e,t){return void 0===e&&(e=null),t.payload&&"ViewId"===t.payload.name?O.a.tryParseOrNull(t.payload.value):e},X),null),$=r("cqI9"),ee=Object(h.d)(((K={})[$.a]=function(e,t){return void 0===e&&(e=null),t.payload&&"VisualizationId"===t.payload.name?O.a.tryParseOrNull(t.payload.value):e},K),null),te=r("Zdrd"),re=r("z9yS").a.savedvisualization,ne=Object(h.d)(((Q={})[te.a]=function(e,t){return void 0===e&&(e=re),t.payload&&"chartVisualizationType"===t.payload.name?t.payload.value:e},Q),re),ie={parameters:{}};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var ae,oe,se,ce=Object(h.d)(((Y={})[Z.a]=function(e,t){var r;void 0===e&&(e=ie);var n,i=t.payload.name,a=e.parameters;for(var o in a)a[o].Name===i&&(n=o);var s=Object(p.__assign)(Object(p.__assign)({},e.parameters[n]),{Value:t.payload.value}),c=Object(p.__assign)(Object(p.__assign)({},e.parameters),((r={})[n]=s,r));return c[i]&&(c[i]=t.payload.value),Object(p.__assign)(Object(p.__assign)({},e),{parameters:c})},Y),ie),le=Object(h.b)("controlName",ce),ue=r("Yc9S"),de=Object(h.d)(((ae={})[ue.b]=function(e,t){return void 0===e&&(e=""),t.payload&&t.payload.name===ue.a?t.payload.value:e},ae),""),pe=r("0rak"),he=[],ge=Object(h.d)(((oe={})[pe.b]=function(e,t){return void 0===e&&(e=he),t.payload&&t.payload.name===pe.a?t.payload.value:e},oe),he),me=r("YT7W"),fe=r("4Q7K"),be=r("FPMG"),ye=r("r7Ib");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function ve(e,t){return t.payload?t.payload:e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var _e=Object(h.d)(((se={})[ye.a]=function(e,t){if(t)return t.payload;return e},se),"");var Se,Oe=r("U/bH"),Ce=Object(h.d)(((Se={})[Oe.a]=function(e,t){return void 0===e&&(e=null),t.payload?t.payload:e},Se),null),Ie=Object(h.b)("dataSetContextKey",(function(e,t){switch(void 0===e&&(e=g.a),t.type){case m.a:return Object(p.__assign)(Object(p.__assign)({},e),{selectedRows:b(e.selectedRows,t)});case y.a:return Object(p.__assign)(Object(p.__assign)({},e),{selectedRelatedEntity:v(e.selectedRelatedEntity,t)});case _.a:return Object(p.__assign)(Object(p.__assign)({},e),{rowProperties:C(e.rowProperties,t)});case R.a:return Object(p.__assign)(Object(p.__assign)({},e),{refreshCounter:B(e.refreshCounter,t)});case V.a:return Object(p.__assign)(Object(p.__assign)({},e),{pagingRefreshInput:z(e.pagingRefreshInput,t)});case W.a:return Object(p.__assign)(Object(p.__assign)({},e),{queryKey:H(e.queryKey,t)});case k.a:return Object(p.__assign)(Object(p.__assign)({},e),{customFilter:D(e.customFilter,t)});case I.e:case I.b:case I.f:case I.g:case I.d:case I.c:case I.a:return Object(p.__assign)(Object(p.__assign)({},e),{filters:F(e.filters,t)});case T.a:return Object(p.__assign)(Object(p.__assign)({},e),{useRollupView:w(e.useRollupView,t)});case E.a:return Object(p.__assign)(Object(p.__assign)({},e),{fetchXml:x(e.fetchXml,t)});case Z.a:return Object(p.__assign)(Object(p.__assign)({},e),{viewId:J(e.viewId,t),controls:le(e.controls,t)});case $.a:return Object(p.__assign)(Object(p.__assign)({},e),{visualizationId:ee(e.visualizationId,t)});case te.a:return Object(p.__assign)(Object(p.__assign)({},e),{chartVisualizationType:ne(e.chartVisualizationType,t)});case S.b:case S.a:return Object(p.__assign)(Object(p.__assign)({},e),{rowProperties:C(e.rowProperties,t)});case me.a:return Object(p.__assign)(Object(p.__assign)({},e),{pageNumber:U(e.pageNumber,t)});case fe.a:return Object(p.__assign)(Object(p.__assign)({},e),{isNewPageRequested:q(e.isNewPageRequested,t)});case be.a:return Object(p.__assign)(Object(p.__assign)({},e),{pagingData:ve(e.pagingData,t)});case ye.a:return Object(p.__assign)(Object(p.__assign)({},e),{commandManagerId:_e(e.commandManagerId,t)});case ue.b:return Object(p.__assign)(Object(p.__assign)({},e),{chartFilterExpression:de(e.chartFilterExpression,t)});case pe.b:return Object(p.__assign)(Object(p.__assign)({},e),{chartDrillDownParameters:ge(e.chartDrillDownParameters,t)});case N.a:return Object(p.__assign)(Object(p.__assign)({},e),{showChart:A(e.showChart,t)});case Oe.a:return Object(p.__assign)(Object(p.__assign)({},e),{dependentOptionSetColumnStatus:Ce(e.dependentOptionSetColumnStatus,t)});default:return e}}))},W51q:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("qC0c"),i=r("cZkS"),a=r("7EJx");function o(e){return!!Object(n.a)(e,i.S,i.h)&&(!!Object(n.a)(e,i.d,i.Lc)||1033===Object(a.s)(e))}},WVwd:function(e,t,r){"use strict";r.d(t,"a",(function(){return Y})),r.d(t,"b",(function(){return Z}));var n,i,a,o=r("9r0m"),s=r("HSdq"),c=r("BWVO"),l=r("7ipg"),u=r("1z64"),d=r("QAhb"),p=r("/eCp"),h=r("TCcM"),g=r("nbQV"),m=r("IiPO"),f=r("+Z9T"),b=r("ezfI"),y=function(){function e(e,t,r){var n="ClientApi.XrmProcessStep.constructor";t||Object(f.j)(n,"step"),r||Object(f.j)(n,"processManager"),e||Object(f.j)(n,"store"),this._step=t,this._processManager=r}return e.prototype.isRequired=function(){var e="ClientApi.XrmProcessStep.isRequired";try{b.a.instance.reportCall(e);var t=this._step.get_isProcessRequired();return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getAttribute=function(){var e="ClientApi.XrmProcessStep.getAttribute";try{if(b.a.instance.reportCall(e),!this._attribute){var t=this._step.get_Steps().get_item(0);this._attribute=!t||t.get_isSystemControl()?null:t.get_dataFieldName()}return b.a.instance.reportSuccess(e),this._attribute}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getName=function(){var e="ClientApi.XrmProcessStep.getName";try{b.a.instance.reportCall(e);var t=this._step.get_Name();return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getProgress=function(){var e="ClientApi.XrmProcessStep.getProgress";try{b.a.instance.reportCall(e);var t=4;if(this._step.get_Steps()&&this._step.get_Steps().get_item(0))if(this._step.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep&&this._processManager){var r=this._processManager.getActionLog(new o.a(this._step.get_Id()));r&&(t=r.status),t=0}return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.setProgress=function(e,t){var r="ClientApi.XrmProcessStep.setProgress";try{b.a.instance.reportCall(r);var n="invalid";switch(e){case 0:case 1:case 2:case 3:case 4:n=this._setProgressInternal(e,t)}return b.a.instance.reportSuccess(r),n}catch(e){throw m.a.getInstance().reportFailure(r,e),e}},e.prototype._setProgressInternal=function(e,t){if(this._step.get_Steps()&&this._step.get_Steps().get_item(0)&&this._step.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep){var r=this._processManager.UpdateActionLog(new o.a(this._step.get_Id()),e,t);if(r)return r}return"invalid"},e}(),v=r("Zy0S"),_=function(){function e(e,t){this._processManager=t,null!=this._processManager&&this._processManager.shouldReInitializeNavigationBehavior()&&this._processManager.setBpfNavigationBehavior(this)}return Object.defineProperty(e.prototype,"allowCreateNew",{get:function(){return b.a.instance.reportUsage("ClientApi.XrmProcessNavigationBehavior.getAllowCreateNew"),this._allowCreateNew},set:function(e){var t="ClientApi.XrmProcessNavigationBehavior.setAllowCreateNew";try{b.a.instance.reportCall(t),this._allowCreateNew=e,null!=this._processManager&&this._processManager.setBpfNavigationBehavior(this),b.a.instance.reportSuccess(t)}catch(e){throw m.a.getInstance().reportFailure(t,e),e}},enumerable:!1,configurable:!0}),e}(),S=function(){function e(e,t,r,i,a){n=e,this._entityTypeName=r,this._activeStageId=i,this._stageStep=t,new _(e,a),a&&(this._processManager=a)}return e.prototype.getCategory=function(){var e="ClientApi.XrmProcessStage.getCategory";try{b.a.instance.reportCall(e);var t=this._stageStep.get_stageCategory(),r={getValue:function(){var e=parseInt(t,10);return Number.isNaN(e)&&(e=-1),e}};return b.a.instance.reportSuccess(e),r}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getId=function(){var e="ClientApi.XrmProcessStage.getId";try{b.a.instance.reportCall(e);var t=this._stageStep.get_Id();return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getEntityName=function(){return b.a.instance.reportUsage("ClientApi.XrmProcessStage.getEntityName"),this._entityTypeName},e.prototype.getStatus=function(){var e="ClientApi.XrmProcessStage.getStatus";try{b.a.instance.reportCall(e);var t=this.getId()===this._activeStageId?"active":"inactive";return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getName=function(){var e="ClientApi.XrmProcessStage.getName";try{b.a.instance.reportCall(e);var t=this._stageStep.get_Description();return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getSteps=function(){var e="ClientApi.XrmProcessStage.getSteps";try{if(b.a.instance.reportCall(e),!this._steps&&(this._steps=new v.a(e),null!=this._stageStep.get_Steps()&&this._stageStep.get_Steps().get_Count()>0))for(var t=0;t<this._stageStep.get_Steps().get_Count();t++){var r=this._stageStep.get_Steps().get_item(t);if(r instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){var i=r.get_Steps().get_item(0);i&&(i instanceof Microsoft.Crm.Workflow.ObjectModel.ControlStep||i instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep||i instanceof Microsoft.Crm.Workflow.ObjectModel.FlowStep)&&this._steps.add(r.get_Id(),new y(n,r,this._processManager))}}return b.a.instance.reportSuccess(e),this._steps}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getNavigationBehavior=function(){var e="ClientApi.XrmProcessStage.getNavigationBehavior";try{b.a.instance.reportCall(e);var t=this._processManager.getBpfNavigationBehavior();return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e}(),O=function(){function e(e,t,r,n,a){var o="ClientApi.XrmBusinessProcessFlow.constructor";t||Object(f.j)(o,"workflowStep"),n||Object(f.j)(o,"activeStageId"),a||Object(f.j)(o,"processManager"),e||Object(f.j)(o,"store"),Object(f.a)(r)&&Object(f.j)(o,"isRendered"),i=e,this._isRendered=r,this._workflowStep=t,this._activeStageId=n,this._processManager=a}return e.prototype.getName=function(){var e="ClientApi.XrmBusinessProcessFlow.getName";try{b.a.instance.reportCall(e);var t=this._workflowStep.get_Name();return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getId=function(){var e="ClientApi.XrmBusinessProcessFlow.getId";try{b.a.instance.reportCall(e);var t=this._workflowStep.get_Id();return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.isRendered=function(){return b.a.instance.reportUsage("ClientApi.XrmBusinessProcessFlow.isRendered"),this._isRendered},e.prototype.getStages=function(){var e="ClientApi.XrmBusinessProcessFlow.getStages";try{if(b.a.instance.reportCall(e),!this._stages){this._stages=new v.a(e);for(var t=0;t<this._workflowStep.get_Steps().get_Count();t++){var r=this._workflowStep.get_Steps().get_item(t);if(r instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep)for(var n=r,a=0;a<n.get_Steps().get_Count();a++){var o=n.get_Steps().get_item(a);this._stages.add(o.get_Id(),new S(i,o,n.get_EntityLogicalName(),this._activeStageId,this._processManager))}}}return b.a.instance.reportSuccess(e),this._stages}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e}(),C=r("w/nD"),I=r("JBkQ"),j=r("7kKV"),P=r("AqA3");!function(e){e.success="success",e.invalid="invalid"}(a||(a={}));var F,T,w=r("m8A1"),E=r("BvBP"),x=r("c56u"),N=r("JlqV"),A=r("kvLG"),k=r("sOTk"),M=r("b1hT"),D=r("l9h5"),R=r("Z1aD"),B=r("xc1f"),L=function(){function e(e,t,r,n,i){this._clientApiExecutor=new u.a(e,"ClientApi.XrmProcessControlData.",r,t);var a=this._clientApiExecutor.getComponentName("constructor");r||Object(f.j)(a,"pageId"),n||Object(f.j)(a,"entity"),t||Object(f.j)(a,"contextToken"),e||Object(f.j)(a,"store"),F=e,this._pageId=r,this._entity=n;var s=!1;Object(w.d)(F.getState(),this._pageId,a,!0)&&(this._processManager=i,s=!0),this._contextToken=t;var c=n.getEntityReference();this._entityRef=new d.a(c.entityType,o.a.tryParseOrNull(c.id),c.name);var l=Object(w.b)(r,e.getState(),s);A.a.getInstance().eventManager.ReportComponentSuccess(a,l)}return e.prototype.getActiveProcess=function(){var e="ClientApi.XrmProcessControlData.getActiveProcess";try{if(b.a.instance.reportCall(e),!Object(w.d)(F.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getProcess(),r=null;if(t){var n=this._getProcessManager().getActiveStageId();r=new O(F,t,!0,n,this._getProcessManager())}return b.a.instance.reportSuccess(e),r}catch(t){var i=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,i),t}},e.prototype.setStatus=function(e,t){var r=this,n="ClientApi.XrmProcessControlData.setStatus";try{if(b.a.instance.reportCall(n),!Object(w.d)(F.getState(),this._pageId,n))return void b.a.instance.reportSuccess(n);if(!e||this.getStatus()&&e===this.getStatus())return void b.a.instance.reportSuccess(n);var i;if(e===I.a.active)i=p.a.Active;else if(e===I.a.finished)i=p.a.Finished;else{if(e!==I.a.aborted)return void b.a.instance.reportSuccess(n);i=p.a.Aborted}this._getProcessManager().setStatus(i).then((function(){r._callback(t,e,n),b.a.instance.reportSuccess(n)})).catch((function(t){var i=m.a.getInstance().getEventParameters(r._contextToken);return i.push({name:"newStatus",value:e}),Object(f.d)(F,t,n,i)}))}catch(e){var a=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(n,e,null,a),e}},e.prototype.getStatus=function(){var e="ClientApi.XrmProcessControlData.getStatus";try{if(b.a.instance.reportCall(e),!Object(w.d)(F.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._convertToXrmProcessInstanceStatus(this._getProcessManager().getStatus());return b.a.instance.reportSuccess(e),t}catch(t){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getInstanceName=function(){var e="ClientApi.XrmProcessControlData.getInstanceName";try{if(b.a.instance.reportCall(e),!Object(w.d)(F.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getProcessInstanceName();if(!t){var r=Object(h.e)(F.getState(),this._entityRef);t=Object(g.c)(F.getState(),r)}return b.a.instance.reportSuccess(e),t}catch(t){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.getInstanceId=function(){var e="ClientApi.XrmProcessControlData.getInstanceId";try{if(b.a.instance.reportCall(e),!Object(w.d)(F.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getProcessInstanceId(),r=t?o.a.toString(t):null;return b.a.instance.reportSuccess(e),r}catch(t){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.getProcessInstances=function(e){var t=this,r="ClientApi.XrmProcessControlData.getProcessInstances";try{if(b.a.instance.reportCall(r),!Object(w.d)(F.getState(),this._pageId,r)||Object(M.g)(F.getState()))return;"function"==typeof e&&this._getProcessManager().getProcessInstances().then((function(n){if(n&&n.value&&n.value.length>0){var i={};n.value.forEach((function(e){e.businessprocessflowinstanceid&&(i[e.businessprocessflowinstanceid]={CreatedOnDate:e.createdon?new Date(e.createdon):null,ProcessDefinitionID:e._processid_value,ProcessDefinitionName:e.name,ProcessInstanceID:e.businessprocessflowinstanceid,ProcessInstanceName:e.name,StatusCodeName:t._convertToXrmProcessInstanceStatus(e.Process_x002e_statuscode),CreatedOn:e.createdon?new Date(e.createdon).toLocaleDateString():"",ProcessDefintionID:e._processid_value,ProcessDefintionName:e.name})})),Object(l.c)(r,[],(function(){e(i)}))}b.a.instance.reportSuccess(r)})).catch((function(e){var n=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(F,e,r+".getProcessInstances",n)}))}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(r,e,null,n),e}},e.prototype.setActiveProcess=function(e,t){var r=this;this._clientApiExecutor.executeAsync("setActiveProcess",(function(n,i){var s=o.a.tryParseOrNull(e),c=Object(k.m)(F.getState(),r._pageId);if(s&&o.a.equals(s,o.a.EMPTY)){if(c){var l=new d.a(r._entity.getEntityName(),o.a.EMPTY);return F.dispatch(Object(D.b)(!0,l)),A.a.getInstance().eventManager.ReportComponentSuccess(n,i),Promise.resolve().then((function(){return r._callback(t,a.success,n,i),Promise.resolve()})).catch((function(e){return r._callback(t,a.invalid,n,i),Promise.reject(e)}))}return Promise.resolve().then((function(){return r._callback(t,a.invalid,n,i),Promise.resolve()}))}if(!Object(w.d)(F.getState(),r._pageId,n,!0)||Object(M.g)(F.getState()))return Promise.resolve();return(c?Promise.resolve():r._getProcessManager().setActiveProcess(e)).then((function(){r._callback(t,a.success,n,i);var o=r.getActiveProcess();return o&&o.getId().toUpperCase()===e.toUpperCase()||r._reloadPage(n,r._getProcessManager().getCurrentFormEntity(),e),Promise.resolve()})).catch((function(e){return r._callback(t,a.invalid,n,i),Promise.reject(e)}))}),[{name:"processId",value:e,isRequired:!0,expectedDataType:"guid"}])},e.prototype.setActiveProcessInstance=function(e,t){var r=this;this._clientApiExecutor.executeAsync("setActiveProcessInstance",(function(n,i){return!Object(w.d)(F.getState(),r._pageId,n)||Object(M.g)(F.getState())?Promise.resolve():r._getProcessManager().setActiveProcessInstance(e).then((function(o){return r._callback(t,a.success,n,i),r.getInstanceId()!==e&&r._reloadPage(n,r._getProcessManager().getCurrentFormEntity(),o,e),Promise.resolve()})).catch((function(e){return r._callback(t,a.invalid,n,i),Promise.reject(e)}))}),[{name:"processInstanceId",value:e,isRequired:!0,expectedDataType:"guid"}])},e.prototype.getEnabledProcesses=function(e){var t=this,r="ClientApi.XrmProcessControlData.getEnabledProcesses";try{if(b.a.instance.reportCall(r),!Object(w.d)(F.getState(),this._pageId,r,!0))return void b.a.instance.reportSuccess(r);var n=F.getState();if(Object(E.g)(n)&&Object(x.w)(n)&&!Object(N.b)(n)){var i={};return void("function"==typeof e&&Object(l.c)(r,[],(function(){e(i)})))}this._getProcessManager().getEnabledProcesses().then((function(t){var n={};t&&t.length>0&&t.forEach((function(e){n[e.workflowId]=e.name})),"function"==typeof e&&Object(l.c)(r,[],(function(){e(n)})),b.a.instance.reportSuccess(r)})).catch((function(e){var n=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(F,e,r+".getEnabledProcesses",n)}))}catch(e){var a=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(r,e,null,a),e}},e.prototype.switchProcess=function(){var e="ClientApi.XrmProcessControlData.switchProcess";try{if(b.a.instance.reportCall(e),!Object(w.d)(F.getState(),this._pageId,e)||Object(M.g)(F.getState()))return;this._getProcessManager().switchProcess(),b.a.instance.reportSuccess(e)}catch(r){var t=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,r,null,t),r}},e.prototype.abandonProcess=function(){var e=this,t="ClientApi.XrmProcessControlData.abandonProcess";try{if(b.a.instance.reportCall(t),!Object(w.d)(F.getState(),this._pageId,t)||Object(k.m)(F.getState(),this._pageId))return void b.a.instance.reportSuccess(t);this._getProcessManager().abandonProcess().then((function(){b.a.instance.reportSuccess(t)})).catch((function(r){var n=m.a.getInstance().getEventParameters(e._contextToken);return Object(f.d)(F,r,t+".abandonProcess",n)}))}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.reactivateProcess=function(){var e=this,t="ClientApi.XrmProcessControlData.reactivateProcess";try{if(b.a.instance.reportCall(t),!Object(w.d)(F.getState(),this._pageId,t)||Object(k.m)(F.getState(),this._pageId))return void b.a.instance.reportSuccess(t);this._getProcessManager().reactivateProcess().then((function(){b.a.instance.reportSuccess(t)})).catch((function(r){var n=m.a.getInstance().getEventParameters(e._contextToken);return Object(f.d)(F,r,t+".reactivateProcess",n)}))}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.completeProcess=function(){var e=this,t="ClientApi.XrmProcessControlData.completeProcess";try{if(b.a.instance.reportCall(t),!Object(w.d)(F.getState(),this._pageId,t)||Object(k.m)(F.getState(),this._pageId))return void b.a.instance.reportSuccess(t);this._getProcessManager().completeProcess().then((function(){b.a.instance.reportSuccess(t)})).catch((function(r){var n=m.a.getInstance().getEventParameters(e._contextToken);return Object(f.d)(F,r,t+".completeProcess",n)}))}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.getActiveStage=function(){var e="ClientApi.XrmProcessControlData.getActiveStage";try{if(b.a.instance.reportCall(e),!Object(w.d)(F.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getActiveStage(),r=null;return t&&(r=new S(F,t,this._getProcessManager().getCurrentFormEntity().etn,t.get_Id(),this._getProcessManager())),b.a.instance.reportSuccess(e),r}catch(t){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.getActivePath=function(){var e=this,t="ClientApi.XrmProcessControlData.getActivePath";try{if(b.a.instance.reportCall(t),!Object(w.d)(F.getState(),this._pageId,t))return b.a.instance.reportSuccess(t),null;var r=this._getProcessManager().getActivePathStages(),n=null;if(r){var i=this._getProcessManager().getActiveStageId(),a=new v.a(t);r.forEach((function(t){var r=t.get_parent().get_EntityLogicalName();a.add(t.get_stageId(),new S(F,t,r,i,e._getProcessManager()))})),n=a}return b.a.instance.reportSuccess(t),n}catch(e){var o=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,o),e}},e.prototype.setActiveStage=function(e,t){var r=this,n="ClientApi.XrmProcessControlData.setActiveStage";try{if(b.a.instance.reportCall(n),this._entity.getIsDirty()||Object(k.m)(F.getState(),this._pageId))b.a.instance.reportSuccess(n),this._callback(t,j.a.dirtyForm,n);else{if(!Object(w.d)(F.getState(),this._pageId,n))return void b.a.instance.reportSuccess(n);this._getProcessManager().setActiveStage(e).then((function(){r._callback(t,r._getStageInvalidReason(null),n),r._loadActiveStageEntity(n),b.a.instance.reportSuccess(n)})).catch((function(e){r._callback(t,e?r._getStageInvalidReason(e):P.a.invalid,n)}))}}catch(e){var i=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(n,e,null,i),e}},e.prototype.moveNext=function(e){var t=this,r="ClientApi.XrmProcessControlData.moveNext";try{if(b.a.instance.reportCall(r),this._entity.getIsDirty()||Object(k.m)(F.getState(),this._pageId))b.a.instance.reportSuccess(r),this._callback(e,j.a.dirtyForm,r);else{if(!Object(w.d)(F.getState(),this._pageId,r))return void b.a.instance.reportSuccess(r);if(this._getProcessManager().isCrossEntityNavigation(!0))return this._callback(e,j.a.crossEntity,r),void b.a.instance.reportSuccess(r);this._getProcessManager().moveToNextStage().then((function(){t._callback(e,t._getNavigationStatus(null),r),b.a.instance.reportSuccess(r)})).catch((function(n){var i=n?t._getNavigationStatus(n):j.a.invalid;if(t._callback(e,i,r),i===j.a.invalid){var a=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(F,n,r+".moveToNextStage",a)}b.a.instance.reportSuccess(r)}))}}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(r,e,null,n),e}},e.prototype.movePrevious=function(e){var t=this,r="ClientApi.XrmProcessControlData.movePrevious";try{if(b.a.instance.reportCall(r),this._entity.getIsDirty()||Object(k.m)(F.getState(),this._pageId))b.a.instance.reportSuccess(r),this._callback(e,j.a.dirtyForm,r);else{if(!Object(w.d)(F.getState(),this._pageId,r))return void b.a.instance.reportSuccess(r);if(Object(M.g)(F.getState())&&this._getProcessManager().isCrossEntityNavigation(!1))return this._callback(e,j.a.crossEntity,r),void b.a.instance.reportSuccess(r);this._getProcessManager().moveToPreviousStage().then((function(){t._callback(e,t._getNavigationStatus(null),r),t._loadActiveStageEntity(r),b.a.instance.reportSuccess(r)})).catch((function(n){var i=n?t._getNavigationStatus(n):j.a.invalid;if(t._callback(e,i,r),i===j.a.invalid){var a=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(F,n,r+".moveToPreviousStage",a)}b.a.instance.reportSuccess(r)}))}}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(r,e,null,n),e}},e.prototype.getSelectedStage=function(){var e="ClientApi.XrmProcessControlData.getSelectedStage";try{if(b.a.instance.reportCall(e),!Object(w.d)(F.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getSelectedStage(),r=null;if(t){var n=this._getProcessManager().getActiveStageId();r=new S(F,t,this._getProcessManager().getCurrentFormEntity().etn,n,this._getProcessManager())}return b.a.instance.reportSuccess(e),r}catch(t){var i=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,i),t}},e.prototype.addOnStageChange=function(e){var t="ClientApi.XrmProcessControlData.addOnStageChange";e||Object(f.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(w.d)(F.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);F.dispatch(Object(C.q)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.addOnPreStageChange=function(e){var t="ClientApi.XrmProcessControlData.addOnPreStageChange";Object(f.g)(e,t,"handler");try{if(b.a.instance.reportCall(t),!Object(w.d)(F.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);F.dispatch(Object(C.j)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnStageChange=function(e){var t="ClientApi.XrmProcessControlData.removeOnStageChange";e||Object(f.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(w.d)(F.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);F.dispatch(Object(C.L)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnPreStageChange=function(e){var t="ClientApi.XrmProcessControlData.removeOnPreStageChange";Object(f.g)(e,t,"handler");try{if(b.a.instance.reportCall(t),!Object(w.d)(F.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);F.dispatch(Object(C.E)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.addOnStageSelected=function(e){var t="ClientApi.XrmProcessControlData.addOnStageSelected";e||Object(f.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(w.d)(F.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);F.dispatch(Object(C.r)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnStageSelected=function(e){var t="ClientApi.XrmProcessControlData.removeOnStageSelected";e||Object(f.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(w.d)(F.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);F.dispatch(Object(C.M)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.addOnProcessStatusChange=function(e){var t="ClientApi.XrmProcessControlData.addOnProcessStatusChange";e||Object(f.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(w.d)(F.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);F.dispatch(Object(C.k)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.addOnPreProcessStatusChange=function(e){var t="ClientApi.XrmProcessControlData.addOnPreProcessStatusChange";Object(f.g)(e,t,"handler");try{if(b.a.instance.reportCall(t),!Object(w.d)(F.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);F.dispatch(Object(C.i)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnProcessStatusChange=function(e){var t="ClientApi.XrmProcessControlData.removeOnProcessStatusChange";e||Object(f.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(w.d)(F.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);F.dispatch(Object(C.F)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnPreProcessStatusChange=function(e){var t="ClientApi.XrmProcessControlData.removeOnPreProcessStatusChange";Object(f.g)(e,t,"handler");try{if(b.a.instance.reportCall(t),!Object(w.d)(F.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);F.dispatch(Object(C.D)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype._getStageInvalidReason=function(e){return e?e.stageInvalidReason||P.a.invalid:j.a.success},e.prototype._getNavigationStatus=function(e){return e?e.navigationStatus||j.a.invalid:j.a.success},e.prototype._convertToXrmProcessInstanceStatus=function(e){if(e){if(e===p.a.Active)return I.a.active;if(e===p.a.Finished)return I.a.finished;if(e===p.a.Aborted)return I.a.aborted}return null},e.prototype._callback=function(e,t,r,n){var i=r+".Callback";n||(n=m.a.getInstance().getEventParameters(this._contextToken)),n.push({name:"Status",value:t}),Object(l.c)(i,n,(function(){"function"==typeof e&&e(t)}))},e.prototype._reloadPage=function(e,t,r,n){if(t){var i=Object(k.m)(F.getState(),this._pageId),a={entityTypeName:t.etn,id:i?void 0:t.id,processId:r,processInstanceId:n};F.dispatch(Object(R.a)(B.a,a,this._pageId,{target:"inline"})).then((function(t){if(0!==t.status)return Object(f.d)(F,t.error,e+".navigateTo.INavigationFailure")})).catch((function(t){return Object(f.d)(F,t,e+".navigateTo.")}))}},e.prototype._loadActiveStageEntity=function(e){var t=this._getProcessManager().getActiveStageEntityRef();t&&t.etn!==this._getProcessManager().getCurrentFormEntity().etn&&this._reloadPage(e,t,this.getActiveProcess().getId(),this.getInstanceId())},e.prototype._getProcessManager=function(){return this._processManager||(this._processManager=Object(w.c)(this._processManager,F,this._pageId,"ClientApi.XrmProcessControlData.getProcessManager")),this._processManager},e}(),V=r("UGbr"),z=r("TCDU"),G=r("UOiB"),W=r("/j9Z"),H=r("9qYn"),U=r("ObKm"),q=r("/lKk"),X=r("gk6Q"),K=r("vqdi"),Q=r("Gemh"),Y=function(){function e(e,t,r,n,i){this._entity=null;var a="ClientApi.XrmFormData.constructor";e||Object(f.j)(a,"store"),r||Object(f.j)(a,"pageId"),t||Object(f.j)(a,"contextToken"),n||Object(f.j)(a,"formContext"),T=e,this._pageId=r,this._formContext=n,this._contextToken=t,this._entity=i}return Object.defineProperty(e.prototype,"entity",{get:function(){return b.a.instance.reportUsage("ClientApi.XrmFormData.entity"),this._entity},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"process",{get:function(){var e="ClientApi.XrmFormData.process_get";try{var t=Object(M.f)(T.getState());b.a.instance.reportCall(e);var r=!!this._process;if((!t&&!this._process||t)&&this._entity){var n=Object(k.g)(T.getState(),this._pageId),i=Object(X.b)(this._pageId,n);this._entity&&(this._process=new L(T,this._contextToken,this._pageId,this.entity,i))}b.a.instance.reportSuccess(e);var a=Object(w.a)(this._pageId,T.getState(),r,!!this._entity);return A.a.getInstance().eventManager.ReportComponentSuccess(e,a),this._process}catch(t){var o=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,o),t}},set:function(e){var t=Object(w.a)(this._pageId,T.getState(),!!this._process,!!this._entity);A.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmFormData.process_set",t),this._process=e},enumerable:!1,configurable:!0}),e.prototype.getEntity=function(){return b.a.instance.reportUsage("ClientApi.XrmFormData.getEntity"),this._entity},e.prototype.getIsDirty=function(){var e,t,r,n="ClientApi.XrmFormData.getIsDirty";try{b.a.instance.reportCall(n);var i=!1;if(this._entity&&this._entity.getIsDirty())i=!0;else{for(var a=0;a<this.attributes.getLength();a++){var o=this.attributes.get(a);if("never"!==o.getSubmitMode()&&o.getIsDirty()){i=!0;break}}if(!i&&(null===(t=null===(e=this._formContext)||void 0===e?void 0:e.ui)||void 0===t?void 0:t.controls))for(a=0;a<this._formContext.ui.controls.getLength();a++){var s=this._formContext.ui.controls.get(a);if("formcomponent"===s.getControlType()&&s.isLoaded()&&(null===(r=s.data)||void 0===r?void 0:r.getIsDirty())){i=!0;break}}}return b.a.instance.reportSuccess(n),i}catch(e){var c=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(n,e,null,c),e}},Object.defineProperty(e.prototype,"attributes",{get:function(){var e="ClientApi.XrmFormData.attributes";try{if(b.a.instance.reportCall(e),!this._unboundAttributes){this._unboundAttributes=new v.a(e);var t=Object(s.Oc)(T.getState(),this._pageId);if(t)for(var r in t){var n=t[r],i=r,a=Object(c.b)(T,this._contextToken,this._pageId,i,this.entity,this._formContext.ui,n);this._unboundAttributes.add(a.getName(),a)}}return b.a.instance.reportSuccess(e),this._unboundAttributes}catch(t){var o=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,o),t}},enumerable:!1,configurable:!0}),e.prototype._refreshEntity=function(e){var t=this;return this.entity.refresh().then((function(){Object(V.d)(T.dispatch,t._contextToken,t._pageId),e&&T.dispatch(Object(C.Q)(t._contextToken,t._pageId,3,t.entity)),Object(H.b)(t.entity)}))},e.prototype.refresh=function(e){var t=this,r="ClientApi.XrmFormData.refresh";try{if(b.a.instance.reportCall(r),this.entity){var n=Object(s.kb)(T.getState(),{id:this._pageId},this._contextToken);return!n&&e&&this.entity.getIsDirty()?this.save().then((function(e){return b.a.instance.reportSuccess(r),{}})).catch((function(e){var n=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(T,e,r+".save",n)})):!n&&this.entity.getIsDirty()?T.dispatch(Object(z.a)(this._pageId)).then((function(e){if(e)return t._refreshEntity(!0).then((function(){return b.a.instance.reportSuccess(r),{}})).catch((function(e){var n=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(T,e,r+".handleUnsavedChanges.refreshEntity",n)}))})).catch((function(e){var n=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(T,e,r+".handleUnsavedChanges",n)})):this._refreshEntity(!0).then((function(){return b.a.instance.reportSuccess(r),{}})).catch((function(e){var n=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(T,e,r+".handleUnsavedChanges.refreshEntity",n)}))}var i=new W.a("Refresh action cannot be executed since form entity is null",2147746581);return A.a.getInstance().traceManager.getTracer(r).info("Refreshing on a non entity page"),Object(f.d)(T,i,r+".entity")}catch(e){var a=m.a.getInstance().getEventParameters(this._contextToken);return Object(f.d)(T,e,r,a)}},e.prototype.save=function(e){var t=this,r="ClientApi.XrmFormData.save",n=m.a.getInstance().getEventParameters(this._contextToken);if(!this._entity){var i=new W.a("Save action cannot be executed since form entity is null",2147746581);return Object(f.d)(T,i,r+".entity")}try{b.a.instance.reportCall(r);var a=1;return e&&e.saveMode&&(a=e.saveMode),Z(this._pageId,T,a,n,this._contextToken,this.entity,!0,!0).then((function(e){if(e){var i={entityType:e.etn,id:o.a.toString(e.id),name:e.name};return Object(s.Kb)(T.getState(),t._pageId)?(b.a.instance.reportSuccess(r),{savedEntityReference:i}):t._refreshEntity(!1).then((function(){return b.a.instance.reportSuccess(r),{savedEntityReference:i}})).catch((function(e){return Object(f.d)(T,e,r+".refresh",n)}))}if(Object(s.kb)(T.getState(),{id:t._pageId},t._contextToken)||!t.entity.getIsDirty()){var a=t.entity.getEntityReference();return b.a.instance.reportSuccess(r),{savedEntityReference:a}}var c=new W.a("Save action was not executed and the form is dirty.",2147879192);return Object(f.d)(T,c,r+".NoReference",null,!1)})).catch((function(e){if(e&&(2200000006===e.errorCode||2200000004===e.errorCode)){var i=t.entity.getEntityReference();return b.a.instance.reportSuccess(r),Promise.resolve({savedEntityReference:i})}return Object(f.d)(T,e,r,n)}))}catch(e){return Object(f.d)(T,e,r,n)}},e.prototype.isValid=function(){var e,t,r,n="ClientApi.XrmFormData.isValid";try{b.a.instance.reportCall(n);var i=!0;if(this.entity&&!this.entity.isValid())i=!1;else if(this.attributes)for(var a=0;a<this.attributes.getLength();a++)if(!this.attributes.get(a).isValid()){i=!1;break}if(i&&(null===(t=null===(e=this._formContext)||void 0===e?void 0:e.ui)||void 0===t?void 0:t.controls))for(var o=0;o<this._formContext.ui.controls.getLength();o++){var s=this._formContext.ui.controls.get(o);if("formcomponent"===s.getControlType()&&s.isLoaded()&&!(null===(r=s.data)||void 0===r?void 0:r.isValid())){i=!1;break}}return i||T.dispatch(Object(U.b)(this._pageId,this._contextToken)),b.a.instance.reportSuccess(n),i}catch(e){var c=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(n,e,null,c),e}},e.prototype.addOnLoad=function(e){var t="ClientApi.XrmFormData.addOnLoad";e||Object(f.j)(t,"handler");try{b.a.instance.reportCall(t),T.dispatch(Object(C.c)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnLoad=function(e){var t="ClientApi.XrmFormData.removeOnLoad";e||Object(f.j)(t,"handler");try{b.a.instance.reportCall(t),T.dispatch(Object(C.x)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e}();function Z(e,t,r,n,i,a,c,l){var u=t.getState(),d=o.a.tryParseOrNull(a.getId());if(i.contextTokenType===G.a.GridRow){var p=[],h=Object(Q.T)(u,e,i.parentContextToken,i.parentContextToken.controlName);return a.attributes.forEach((function(e){return p.push(e.getName())})),n.push({name:"functionName",value:"saveEmbeddedEntity"}),t.dispatch(Object(K.a)(e,a.getEntityName(),null==d?void 0:d.guid,null,p,null==h?void 0:h.guid,!1,i.parentContextToken))}if(Object(s.Kb)(u,e))return n.push({name:"functionName",value:"saveAndCloseFormDialogAction"}),t.dispatch(Object(q.a)(e));if(d&&!o.a.equals(d,o.a.EMPTY))return n.push({name:"functionName",value:"saveForm"}),t.dispatch(Object(V.e)(e,r));var g=Object(k.l)(t.getState(),e);return n.push({name:"functionName",value:"saveFormAndNavigate"}),t.dispatch(Object(V.f)(e,g,l,r,!1,c))}},"Wye+":function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n=r("Gemh"),i=r("Nhrb");var a=r("/j9Z"),o=r("9r0m"),s=r("G7N+"),c=r("olrR"),l=r("RlP9"),u=r("r2h9"),d=r("8Fmj"),p=r("cqI9"),h=r("7dGM"),g=r("lMVv"),m=r("JlqV"),f=r("z9yS"),b=r("uO/V"),y=r("Yc9S"),v=r("0rak");var _=r("zETL"),S=r("3IUl"),O=r("bc+P"),C=r("xm8q"),I=r("okRr"),j=r("U/bH"),P=r("cZkS"),F=r("qC0c"),T=r("VcAV");function w(e,t,r,w,x,N){return{type:"grid.refresh.async",execute:function(A,k){var M=A.dispatch,D=A.getState,R=k.TraceManager.getTracer(b.z),B=b.x+".refreshGridAction";try{var L=D(),V=o.a.tryParseOrNull(w);if(V){var z=N||(r?u.a.SUB_GRID:u.a.MAIN_APPLICATION_VIEW);return function(e,t,r,i,d,p,h,g){var f=Object(n.qb)(t,g,r);if(f&&f.initialized===s.a.Initialized&&(Object(m.b)(t)||!Object(T.b)(f.offlineSqlQuery)))return Promise.resolve(g);var b=p||Object(n.F)(t,r,i,d),y=Object(l.f)(t,b,h),v=Object(l.f)(t,b,u.a.MAIN_APPLICATION_VIEW),_=y&&y[o.a.toString(g)]&&y[o.a.toString(g)].isUserView?u.b.userview:u.b.savedview;v&&v[o.a.toString(g)]&&v[o.a.toString(g)].isUserView&&(_=u.b.userview);return e(Object(c.a)(b,h,_,g)).then((function(e){if(!e)throw new a.a("View retrieval failed");return e}))}(M,L,e,t,r,x,z,V).then((function(a){R.info("Refreshing the grid with new view id - {0}"+V);var c=Object(n.T)(L,e,t);M(function(e,t,r,n){return Object(i.b)(e,t,"ViewId",r,n)}(e,r,w,t)),function(e,t,r,i,a,c,u,d,p){var h=function(e,t,r,i,a){return e||Object(n.F)(t,r,i,a)}(r,e,a,c,u),g=Object(n.qb)(e,i,a);if(g&&g.initialized===s.a.Initialized){var m=Object(l.f)(e,h,d),f=m&&m[o.a.toString(i)]&&m[o.a.toString(i)].isUserView;if(h===b.a&&(h=g.entityLogicalName?g.entityLogicalName:h),!g.title){var y=[];y.push({name:"view.title",value:"View title doesn't contains value"}),y.push({name:"ViewId",value:"ViewId: "+i}),y.push({name:"View",value:E(g)}),y.push({name:"entityTypeName",value:h}),p.EventManager.ReportComponentFailure("RefreshGrid",new Error("Title for recent item is null or empty."),"Analyze event parameters to understand why title is empty.",y)}var v={RecordType:I.a.Grid,EntityTypeName:h,LastAccessed:new Date,ObjectId:i,IsUserView:f,Title:g.title};t(Object(C.b)(v))}}(D(),M,x,a,e,t,r,z,k),Object(F.c)(D(),P.L)&&M(Object(j.b)(e,t)),x&&M(function(e,t,r,n){return Object(i.b)(e,t,"TargetEntityType",r,n)}(e,r,x,t)),M(Object(_.b)(e,t)),M(Object(S.b)(e,t,[])),M(Object(O.b)(e,t,null));var T=[];if(x&&T.push({name:"entityName",value:x}),!Object(n.ib)(L,e,t))return k.EventManager.ReportComponentSuccess(B,T),Promise.resolve();M(function(e,t,r,i,a,s){return{type:"chart.refresh.async",execute:function(c,_){var S=c.dispatch,O=c.getState,C=b.x+".refreshChartAction",I=O();if(!r)return Promise.resolve();if(!Object(m.b)(I))return Promise.resolve();var j=Object(l.c)(I,r);if(!(a=j&&j.entityLogicalName?j.entityLogicalName:null))return Promise.resolve();if(s===u.a.QUICKFIND_SEARCH&&(S(Object(v.c)(e,t,[])),S(Object(y.c)(e,t,"{}"))),!o.a.equals(i,r)){S(Object(v.c)(e,t,[])),S(Object(y.c)(e,t,"{}"));var P=Object(n.r)(I,e,t,a),F=Object(h.a)(I,P),T=F&&F.PrimaryEntityTypeCode,w=T&&Object(g.m)(I,parseInt(T,10));if(w&&a!==w)return S(Object(d.a)(a,f.a.savedvisualization)).then((function(r){var n=o.a.toString(r);return n||(n=o.a.EMPTYGUIDSTRING),S(Object(p.b)(e,t,n)).then((function(){_.EventManager.ReportComponentSuccess(C)}))}))}return _.EventManager.ReportComponentSuccess(C),Promise.resolve()}}}(e,t,V,c,x,N)).then((function(){return M(Object(_.b)(e,t)),k.EventManager.ReportComponentSuccess(B,T),Promise.resolve()})).catch((function(e){return k.EventManager.ReportComponentFailure(B,Error(e)),Promise.resolve()}))}))}if(Object(n.v)(D(),e,t)){R.info("Refreshing the grid."),M(Object(_.b)(e,t)),M(Object(S.b)(e,t,[])),M(Object(O.b)(e,t,null));var G=[];x&&G.push({name:"entityName",value:x}),k.EventManager.ReportComponentSuccess(B,G)}return Promise.resolve()}catch(e){var W="Refresh action for grid failed";e&&e.message&&(W+="with the error message as : "+e.message),k.EventManager.ReportComponentFailure(B,Error(W))}}}}function E(e){if(!e)return"View is "+e;var t={initialized:e.initialized,viewId:e.viewId,entityLogicalName:e.entityLogicalName,queryApi:e.queryApi,columnXML:e.columnXML,idColumName:e.idColumName,queryType:e.queryType,layoutXML:e.layoutXML,isUserView:e.isUserView,versionNumber:e.versionNumber,OverallVersionNumber:e.OverallVersionNumber,OverallUserVersionNumber:e.OverallUserVersionNumber};return JSON.stringify(t)}},XJ3n:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n,i=r("fW82"),a=r("9r0m"),o=r("+Z9T"),s=r("BWVO"),c=r("WVwd"),l=r("/zIU"),u=r("GueY"),d=r("Gemh"),p=r("IiPO"),h=r("mPpC"),g=r("ks02"),m=r("FoZz"),f=r("sOTk"),b=r("gLMt"),y=r("ezfI"),v=function(){function e(e,t,r,i,a,s){var c="ClientApi.XrmGridRow.constructor";e||Object(o.j)(c,"store"),i||Object(o.j)(c,"pageId"),r||Object(o.j)(c,"contextToken"),a||Object(o.j)(c,"entityType"),s||Object(o.j)(c,"entityId"),n=e,this._applicationContext=t,this._pageId=i,this._contextToken=r,this._entityType=a,this._entityId=s}return Object.defineProperty(e.prototype,"applicationContext",{get:function(){return y.a.instance.reportUsage("ClientApi.XrmGridRow.applicationContext_get"),this._applicationContext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){var e="ClientApi.XrmGridRow.context";try{return y.a.instance.reportCall(e),this._globalContext||(this._globalContext=new g.a(n,this._pageId)),y.a.instance.reportSuccess(e),this._globalContext}catch(r){var t=p.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure(e,r,null,t),r}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){var e=this,t="ClientApi.XrmGridRow.data";try{if(y.a.instance.reportCall(t),!this._data){var r=new s.a(n,this._contextToken,this._pageId,this,this._entityType,this._entityId,_,this._applicationContext);this._data=new c.a(n,this._contextToken,this._pageId,this,r);var i=new h.b(n,this._pageId),o=[],l={isEventParam:!0,name:"attributeName",value:""};o.push(l),r.attributes.forEach((function(r){var n=r.getName();l.value=n;var s={Id:n,Label:null,Name:n,ShowLabel:!1,Visible:!0,ClassId:new a.a(h.a),Disabled:!1,DataFieldName:n},c=i.createXrmControl(e._contextToken,s,e,t,o);c&&r.controls.add(c.getName(),c)}))}return y.a.instance.reportSuccess(t),this._data}catch(e){var u=p.a.getInstance().getEventParameters(this._contextToken);throw u.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure(t,e,null,u),e}},enumerable:!1,configurable:!0}),e.prototype.getData=function(){try{return y.a.instance.reportUsage("ClientApi.XrmGridRow.getData"),this.data}catch(t){var e=p.a.getInstance().getEventParameters(this._contextToken);throw e.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure("ClientApi.XrmGridRow.getData",t,null,e),t}},Object.defineProperty(e.prototype,"ui",{get:function(){try{if(y.a.instance.reportCall("ClientApi.XrmGridRow.ui"),!this._ui){var e=new h.b(n,this._pageId);this._ui=new u.a(n,this._contextToken,this._pageId,this,this._entityType,e)}return y.a.instance.reportSuccess("ClientApi.XrmGridRow.ui"),this._ui}catch(e){var t=p.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure("ClientApi.XrmGridRow.ui",e,null,t),e}},enumerable:!1,configurable:!0}),e.prototype.getControl=function(e){var t="ClientApi.XrmGridRow.getControl";try{y.a.instance.reportCall(t);var r=this.ui.controls.get(e);return y.a.instance.reportSuccess(t),r}catch(e){var n=p.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.getAttribute=function(e){var t="ClientApi.XrmGridRow.getAttribute";try{if(y.a.instance.reportCall(t),this.data.entity){var r=this.data.entity.attributes.get(e);return y.a.instance.reportSuccess(t),r}return y.a.instance.reportSuccess(t),null}catch(e){var n=p.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.getUrl=function(e){var t="ClientApi.XrmGridRow.getUrl";try{y.a.instance.reportCall(t);var r=this.data.entity.getEntityReference();this._internal=new m.a(n,this._applicationContext,this.context,this._pageId);var o=Object(f.g)(n.getState(),this._pageId),s={entityTypeName:r.entityType,etn:r.name,id:a.a.fromExternalGuid(r.id),entityTypeCode:this._internal.getEntityCode(r.entityType),languageId:this.context.userSettings.languageId,recordSetQueryKey:o.recordSetQueryKey};if(1===e){var c=n.dispatch(Object(i.a)(l.a.EditForm,s));return y.a.instance.reportSuccess(t),c}var u=Object(b.a)(n,this._pageId),d=n.dispatch(Object(i.c)(u,l.a.EditForm,s));return y.a.instance.reportSuccess(t),d}catch(e){var h=p.a.getInstance().getEventParameters(this._contextToken);throw h.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure(t,e,null,h),e}},Object.defineProperty(e.prototype,"entityReference",{get:function(){try{return this.data.entity.getEntityReference()}catch(t){var e=p.a.getInstance().getEventParameters(this._contextToken);throw e.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure("ClientApi.XrmGridRow.entityReference",t,null,e),t}},enumerable:!1,configurable:!0}),e}();function _(e,t,r){var i=Object(d.D)(n.getState(),{id:r},t.parentContextToken);return i||(e.TraceManager.getTracer("ClientApi.XrmGridRow.getAttributeNames").error("Grid attributes was null"),[])}},XjtF:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n,i,a,o=r("EGsq"),s=r("cL6R"),c=r("KVkm"),l=r("WACO"),u=r("JlqV"),d=["JQUERY","JQUERY.JS"];function p(e){return{type:"customcontrol.loadresources",execute:function(t,r){var p=t.dispatch,h=t.getState,g=[],m=h(),f=Object(o.t)(m),b=e.Properties.Resources.filter((function(e,t,n){return(0===e.Type||4===e.Type||1===e.Type)&&!(e.LibraryName&&-1!==d.indexOf(e.LibraryName.toUpperCase())||r.AssetLoader.isResourceLoaded(f+e.Name))})).sort((function(e,t){return e.LoadOrder-t.LoadOrder})),y=e.Properties.Resources.filter((function(e,t,r){return 5===e.Type}));if(b.length>0){var v=void 0,_=function(){return function(e,t,r,i,a){for(var o=[],s=0;s<a.length;s++){var l=a[s],u=void 0,d=l.Name,p=r;if(n&&n[l.Name])p=window.__public_path__+"control",d=n[l.Name];else if(0===l.Type){var h=l.LibraryName+".js";n&&n[h]&&(p=window.__public_path__+"control",d=n[h])}switch(l.Type){case 0:case 4:u=i.loadWebResource(d,p,3,(function(t){return e(Object(c.a)(t))}),t,!1);break;case 1:u=u=i.loadWebResource(d,p,2,(function(t){return e(Object(c.a)(t))}),t);break;default:u=null}u&&o.push(u)}return Promise.all(o)}(p,!Object(u.b)(m),f,r.AssetLoader,b)};(v=!function(){null==a&&(a=window.location.search.toLocaleLowerCase().indexOf("uselocal=true")>=0);return a}()||n?_():function(){if(i)return i;if("/uclient/"!==window.__public_path__){if(!n){var e=window.__public_path__+"controlFileMap.json";(i=-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0?new Promise((function(t){var r=new XMLHttpRequest;r.addEventListener("load",(function(){var e={};try{e=JSON.parse(this.responseText)}catch(e){}t(e)})),r.addEventListener("error",(function(){t({})})),r.open("GET",e),r.send()})):fetch(e).then((function(e){return e.json()}),(function(){return Promise.resolve({})}))).then((function(e){n=e}),(function(){n={}}))}}else n={},i=Promise.resolve({});return i}().then(_,_))&&g.push(v)}for(var S=Object(l.k)(m),O=function(e){if(!S||!S.hasOwnProperty(y[e].Name)){var t=p(Object(s.c)(y[e].Name)).then((function(t){for(var r=!1,n=0,i=t;n<i.length;n++){var a=i[n];a&&a.webResourceDescriptorsByName&&a.webResourceDescriptorsByName.hasOwnProperty(y[e].Name)&&(r=!0)}!r&&p(Object(s.b)(y[e].Name))}));g.push(t)}},C=0;C<y.length;C++)O(C);return g.length>0?Promise.all(g):null},sync:!0}}},"Y+r4":function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var n,i,a=r("c/eZ"),o=r("1z64"),s=r("fW82"),c=r("sOTk"),l=r("BWVO"),u=r("WVwd"),d=r("ezfI"),p=r("/zIU"),h=r("GueY"),g=r("HSdq"),m=r("3NtJ"),f=r("fTYK"),b=r("+Z9T"),y=r("IiPO"),v=function(e){function t(t,r,i,a,o,s){var c=e.call(this,t,r,i,a,o,s)||this;return n=t,c}return Object(a.__extends)(t,e),t.prototype.getDefaultNextPageName=function(){var e="ClientApi.XrmNavigableFormUi.getDefaultNextPageName";try{d.a.instance.reportCall(e);var t=Object(g.M)(n.getState(),this.pageId,this.contextToken);return d.a.instance.reportSuccess(e),t}catch(t){var r=y.a.getInstance().getEventParameters(this.contextToken);throw y.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.movePrevious=function(){var e="ClientApi.XrmNavigableFormUi.movePrevious";try{d.a.instance.reportCall(e),n.dispatch(Object(f.b)(this.pageId,this.contextToken)),d.a.instance.reportSuccess(e)}catch(r){var t=y.a.getInstance().getEventParameters(this.contextToken);throw y.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.moveTo=function(e){var t,r="ClientApi.XrmNavigableFormUi.moveTo";try{if(d.a.instance.reportCall(r),e&&this.tabs){var i=Object(g.Gc)(n.getState(),this.pageId,e,this.contextToken);(t=this.tabs.get(null==i?void 0:i.Name))&&n.dispatch(Object(m.b)(this.pageId,this.contextToken,null==i?void 0:i.Id))}d.a.instance.reportSuccess(r)}catch(e){var a=y.a.getInstance().getEventParameters(this.contextToken);throw y.a.getInstance().reportFailure(r,e,null,a),e}t||Object(b.h)(r,"pageName",e)},Object.defineProperty(t.prototype,"taskProcess",{get:function(){return d.a.instance.reportUsage("ClientApi.XrmNavigableFormUi.taskProcess"),this},enumerable:!1,configurable:!0}),t}(h.a),_=r("9r0m"),S=r("FoZz"),O=r("gLMt"),C=r("ZOZo"),I=r("WS0f"),j=function(e){function t(t,r,n,a,s){var c=this,l=[{name:"pageId",value:s,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];return(c=e.call(this,t,r&&r.etn,a,s,(function(e){return 10===e||12===e?v:h.a}),n)||this)._clientApiExecutorForm=new o.a(t,"ClientApi.XrmForm.",s,a,l),i=t,c._entityReference=r,c}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"applicationContext",{get:function(){return this._applicationContext},set:function(e){this._applicationContext=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){try{return d.a.instance.reportCall("ClientApi.XrmForm.context"),d.a.instance.reportSuccess("ClientApi.XrmForm.context"),this._globalContext}catch(e){throw this._reportFailure("ClientApi.XrmForm.context",e)}},set:function(e){this._globalContext=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entityReference",{get:function(){var e=this;return this._clientApiExecutorForm.execute("entityReference_get",(function(){return{id:_.a.externalGuid(e._entityReference.id),entityType:e._entityReference.etn}}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){try{if(d.a.instance.reportCall("ClientApi.XrmForm.data"),!this._data){var e=void 0,t=Object(c.l)(i.getState(),this.pageId);t!==p.a.Dialog&&t!==p.a.ModalDialog&&this._entityReference&&(e=new l.a(i,this.contextToken,this.pageId,this,this._entityReference.etn,this._entityReference.id,P,this._applicationContext)),this._data=new u.a(i,this.contextToken,this.pageId,this,e)}return d.a.instance.reportSuccess("ClientApi.XrmForm.data"),this._data}catch(e){throw this._reportFailure("ClientApi.XrmForm.data",e)}},enumerable:!1,configurable:!0}),t.prototype.getAttribute=function(e){var t=this;return this._clientApiExecutorForm.execute("getAttribute",(function(){var r,n,i=null;return t.data&&t.data.entity&&(i=t.data.entity.attributes.get(e)),i?Object(I.a)(e)&&(i=i.concat(t.data.attributes.get(e))):i=null===(n=null===(r=t.data)||void 0===r?void 0:r.attributes)||void 0===n?void 0:n.get(e),i}))},t.prototype.getUrl=function(e){try{d.a.instance.reportCall("ClientApi.XrmForm.getUrl");var t=null,r=null;if(this.contextToken.parentContextToken){var n=this.data.entity.getEntityReference(),a={entityTypeName:n.entityType,etn:n.name,id:_.a.fromExternalGuid(n.id)};t=p.a.EditForm,r=a}else t=Object(c.l)(i.getState(),this.pageId),r=Object(c.g)(i.getState(),this.pageId);switch(t){case p.a.EditForm:var o=new S.a(i,this.applicationContext,this.context,this.pageId);r={entityTypeName:r.entityTypeName,etn:r.etn,id:r.id,entityTypeCode:o.getEntityCode(r.entityTypeName),languageId:this._globalContext.userSettings.languageId,recordSetQueryKey:r.recordSetQueryKey};break;case p.a.Grid:o=new S.a(i,this.applicationContext,this.context,this.pageId);r={entityTypeName:r.entityTypeName,pageType:r.pageType,entityTypeCode:o.getEntityCode(r.entityTypeName)}}var l=null;if(1===e)l=i.dispatch(Object(s.a)(t,r));else{var u=Object(O.a)(i,this.pageId);l=i.dispatch(Object(s.c)(u,t,r))}return d.a.instance.reportSuccess("ClientApi.XrmForm.getUrl"),l}catch(e){throw this._reportFailure("ClientApi.XrmForm.getUrl",e)}},t.prototype._reportFailure=function(e,t){var r=y.a.getInstance().getEventParameters(this.contextToken);return r.push({name:"entityName",value:this._entityReference.etn}),y.a.getInstance().reportFailure(e,t,null,r),t},t}(C.a);function P(e,t,r){var n=Object(g.bb)(i.getState(),r,t);return n||e.TraceManager.getTracer("ClientApi.XrmForm.getAttributeNames").error("Form attributes was null"),n}},YOvo:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="navigation.item.visibility";function i(e,t,r){return{type:n,payload:{show:r},meta:{pageId:e,navigationItemId:t}}}},Yc9S:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return o})),r.d(t,"c",(function(){return s}));var n=r("Sscr"),i=r("uO/V"),a="chart.filterexpression.update",o="ChartFilterExpression";function s(e,t,r){return{type:"chart.filterexpression.update.async",execute:function(s,c){var l=s.dispatch,u=s.getState,d=c.TraceManager.getTracer(i.z),p=i.x+".updateFilterExpressionAction";try{d.info("Updating the chart filter expression"),t||(t=Object(n.k)(u(),e));var h=Object(n.v)(t);return l(function(e,t,r){return{type:a,payload:{name:o,value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,h,r)),c.EventManager.ReportComponentSuccess(p),Promise.resolve()}catch(e){var g="Updatation of the chart filter expression failed with error : "+e.message;c.EventManager.ReportComponentFailure(p,Error(g))}}}}},YdIa:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="attribute.targets.set";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r,a){var o=Object(n.x)(t);return{type:i,payload:a,meta:{pageId:e,contextKey:o,dataFieldName:r}}}},ZOZo:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n,i=r("h82J"),a=r("HSdq"),o=r("1z64"),s=function(){function e(e,t,r,a,s,c){this._clientApiExecutor=new o.a(e,"ClientApi.XrmFormBase.",a,r,[{name:"store",value:e,isRequired:!0},{name:"entityName",value:this._entityName,isEventParam:!0},{name:"pageId",value:a,isRequired:!0,isEventParam:!0},{name:"contextToken",value:r,isRequired:!0},{name:"getUiType",value:s,isRequired:!0}]),n=e,this.pageId=a,this.contextToken=r,this._entityName=t,this._getUiType=s,this._xrmControlFactory=c,n.dispatch(Object(i.a)(this,a,r))}return Object.defineProperty(e.prototype,"ui",{get:function(){var e=this;return this._clientApiExecutor.execute("ui_get",(function(){if(!e._ui){var t={id:e.pageId},r=Object(a.fb)(n.getState(),t,e.contextToken),i=r&&r.FormType,o=e._getUiType(i);e._ui=new o(n,e.contextToken,e.pageId,e,e._entityName,e._xrmControlFactory)}return e._ui}))},enumerable:!1,configurable:!0}),e.prototype.getControl=function(e){var t=this,r=[{name:"entityName",value:this._entityName,isRequired:!1,isEventParam:!0}];return this._clientApiExecutor.execute("getControl",(function(){return t.ui.controls.get(e)}),r)},e}()},Zdrd:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o}));var n=r("Sscr"),i=r("uO/V"),a="chart.visualizationtype.update";function o(e,t,r){return{type:"chart.visualizationtype.update.async",execute:function(o,s){var c=o.dispatch,l=o.getState,u=s.TraceManager.getTracer(i.z),d=i.x+".updateVisualizationTypeAction";try{u.info("Update the chart visualization type"),t||(t=Object(n.k)(l(),e));var p=Object(n.v)(t);return c(function(e,t,r){return{type:a,payload:{name:"chartVisualizationType",value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,p,r)),s.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){var h="Update the chart visualization type failed with error : "+e.message;s.EventManager.ReportComponentFailure(d,Error(h))}}}}},aBa1:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return h}));var n=r("c/eZ"),i=r("AhDg"),a=r("9r0m"),o=r("lMVv"),s=r("gBKR"),c=r("7pqb"),l=r("t8f4"),u=r("r0s4"),d=c.b.AdvancedFindLookupResolverParameters;function p(e,t,r){var l=[];return{type:"advancedFind.lookup.retrieve.async",execute:function(u,p,h){var m=u.dispatch,f=u.getState,b=new i.a(a.a.newGuid().guid,h&&h.isPreloadCall);l.push({name:c.b.ActionType,value:"advancedFind.lookup.retrieve.async"},{name:c.b.ClientRequestId,value:b.RequestId()},{name:d.PrimaryEntity,value:e},{name:d.Targets,value:t.join(",")});var y=t.reduce((function(e,t){var r;return Object(n.__assign)(Object(n.__assign)({},e),((r={})[t]=[],r))}),{});return m(Object(s.e)(y)).then((function(){var e=function(e,t,r,n){return function(i,a){var s=Object(o.h)(r,a);if(!s||!s.EntityLogicalName||!s.PrimaryNameAttribute)return n.push({name:d.EntityMetadataUnavailable,value:a}),i;var c='<fetch version="1.0" mapping="logical" no-lock="false"><entity name="'+s.EntityLogicalName+'"><attribute name="'+s.PrimaryNameAttribute+'"/><attribute name="'+s.PrimaryIdAttribute+'"/><order attribute="'+s.PrimaryNameAttribute+'" descending="false" /><filter type="or"><condition attribute="'+s.PrimaryNameAttribute+'" operator="like" value="%'+(t||"")+'%" /></filter></entity></fetch>',l=g(e,s,c,n);return i.push(l),i}}(m,r,f(),l),n=t.reduce(e,[]);return Promise.all(n).then((function(e){return Promise.resolve([].concat.apply([],e))}))}))},getSuccessParameters:function(){return l},getFailureParameters:function(e,t){return l}}}function h(e,t,r){var l=[];return{type:"advancedFind.lookup.retrieve.by.id.async",execute:function(u,p,h){var m=u.dispatch,f=u.getState,b=new i.a(a.a.newGuid().guid,h&&h.isPreloadCall);l.push({name:c.b.ActionType,value:"advancedFind.lookup.retrieve.async"},{name:c.b.ClientRequestId,value:b.RequestId()},{name:d.PrimaryEntity,value:e},{name:d.Targets,value:t.join(",")});var y=t.reduce((function(e,t){var r;return Object(n.__assign)(Object(n.__assign)({},e),((r={})[t]=[],r))}),{});return m(Object(s.e)(y)).then((function(){var e=function(e,t,r,n){return function(i,a){var s=Object(o.h)(r,a);if(!s||!s.EntityLogicalName||!s.PrimaryNameAttribute)return n.push({name:d.EntityMetadataUnavailable,value:a}),i;var c=t.filter((function(e){return!!e})).map((function(e){return'<condition attribute="'+s.PrimaryIdAttribute+'" operator="eq" value="'+e+'" />'})),l='<fetch version="1.0" mapping="logical" no-lock="false"><entity name="'+s.EntityLogicalName+'"><attribute name="'+s.PrimaryNameAttribute+'"/><attribute name="'+s.PrimaryIdAttribute+'"/><order attribute="'+s.PrimaryNameAttribute+'" descending="false" /><filter type="or">'+c+"</filter></entity></fetch>",u=g(e,s,l,n);return i.push(u),i}}(m,r,f(),l),n=t.reduce(e,[]);return Promise.all(n).then((function(e){return Promise.resolve([].concat.apply([],e))}))}))},getSuccessParameters:function(){return l},getFailureParameters:function(e,t){return l}}}function g(e,t,r,n){var i="?fetchXml="+Object(u.CrmUrlEncode)(r);return new Promise((function(r,a){e(Object(l.e)(t.EntityLogicalName,i,100)).then((function(e){var i=function(e,t){var r=[];t.value&&t.value.length>0&&t.value.forEach((function(t){r.push({id:t[e.PrimaryIdAttribute],displayName:t[e.PrimaryNameAttribute],entityLogicalName:(null==e?void 0:e.EntityLogicalName)||void 0,entityDisplayName:(null==e?void 0:e.DisplayName)||void 0})}));return r}(t,e);n.push({name:d.RetrieveRequestSuccess,value:"Retrieve Seccuess for "+t.EntityLogicalName+" Count: "+i.length}),r(i)}),(function(e){n.push({name:d.RetrieveRequestFail,value:"Failed to retrieve records for "+t.EntityLogicalName+" Error: "+e}),r([])}))}))}},"b/oW":function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r("XOZu"),i=r("kOjA"),a=r("c/eZ"),o=r("ASFs");var s,c=r("jkQg"),l=r("xc1f");function u(e,t){var u=Object(c.a)();s||(s=function(e){return Promise.resolve().then(r.bind(null,"kOjA")).then((function(t){if(t){var r=Object(a.__assign)(Object(a.__assign)({},e.currentReducerMap),{formInstances:t.formInstancesReducer});e.replaceReducer(Object(o.a)(r)),e.currentReducerMap=r}}))}(u));var d=n.a.createPageModule(e);return s.then((function(){return u.dispatch(n.a.preInitializePage(t,e)).then((function(r){return d.then((function(n){if(n){u.dispatch(function(e,t,r){return{type:i.CREATE_FORM_INSTANCE,payload:{currentPage:e,error:null,input:r,__pageName:l.a},meta:{pageId:t}}}(n,e,t));var a=n.getInitializationAction(r);return u.dispatch(a)}}))}))}))}},bCrZ:function(e,t,r){"use strict";r.d(t,"f",(function(){return m})),r.d(t,"d",(function(){return f})),r.d(t,"e",(function(){return v})),r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return g})),r.d(t,"c",(function(){return y}));var n=r("c/eZ"),i=r("9r0m"),a=r("Sscr"),o=r("uO/V"),s=r("nn4v"),c=r("Gemh"),l=r("cZkS"),u=r("qC0c"),d=r("U/bH"),p=r("jigW"),h="grid.initialize",g="grid.initialize.xrmready";function m(e,t,r){return{type:"grid.preinitialize.sync",sync:!0,execute:function(n,i){var a=n.dispatch,s=(n.getState,o.x+".gridPreInitializedAction");try{a(b(null,e,t,r,void 0,void 0,void 0,void 0,null));var c=[{name:"entityTypeName",value:e}];return i.EventManager.ReportComponentSuccess(s,c),Promise.resolve(void 0)}catch(t){var l="Failed for "+e+" with error "+t.message;return i.EventManager.ReportComponentFailure(s,Error(l)),Promise.resolve(void 0)}}}}function f(e,t,r,i,a,p,h,g,m){return e?{type:"grid.initialize.async",execute:function(f,y){var v=f.dispatch,_=f.getState,S=o.x+".gridInitializedAction";try{var O=null;Object(u.c)(_(),l.zb)&&(O=function(e,t,r){var i=Object(c.v)(e,t,r),a=Object(n.__assign)({},s.a);return i&&(i.filters&&(a.filters=i.filters),i.customFilter&&(a.customFilter=i.customFilter),i.pageNumber&&(a.pageNumber=i.pageNumber),i.pagingRefreshInput&&(a.pagingRefreshInput=i.pagingRefreshInput)),a}(_(),r,i)),v(b(e,t,r,i,a,p,h,g,O,m));var C=[];return C.push({name:"entityTypeName",value:t}),y.EventManager.ReportComponentSuccess(S,C),Object(u.c)(_(),l.L)&&v(Object(d.b)(r,i)),Promise.resolve(void 0)}catch(e){var I="Grid initialized failed for entity type "+t;return y.EventManager.ReportComponentFailure(S,Error(I)),Promise.reject(void 0)}}}:null}function b(e,t,r,c,l,u,d,g,m,f){var b=l&&l.Parameters?l.Parameters[o.j]:null;try{var y=!0;b&&(y="true"===b);var v=Object(a.u)(c),_={contextKey:v,initialDataSetState:Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},s.a),m),{viewId:e?e.viewId:null,fetchXml:e?e.fetchXml:null,relationshipName:u,relationshipRoleOrdinal:d,useRollupView:g||!1,commandManagerId:f||Object(p.d)(r,c),controls:{homepageGrid:{parameters:{0:{Name:o.C,Value:e&&e.viewId?i.a.toString(e.viewId):null},1:{Name:o.j,Value:y},2:{Name:o.u,Value:t}}}}})};return{type:h,payload:_,meta:{pageId:r,contextKey:v}}}catch(e){throw Error(e)}}function y(e,t,r,c){var l=Object(a.u)(c),u=i.a.tryParseOrNull(t),d={contextKey:l,initialDataSetState:Object(n.__assign)(Object(n.__assign)({},s.a),{viewId:u||null,fetchXml:null,commandManagerId:Object(p.d)(r,c),controls:{homepageGrid:{parameters:{0:{Name:o.C,Value:t||null},1:{Name:o.j,Value:!1},2:{Name:o.u,Value:e}}}}})};return{type:h,payload:d,meta:{pageId:r,contextKey:l}}}function v(e,t,r,n){return t(e.ScriptManager.getContainer(n).getEventManager().loadGridScripts(r,n))}},bH46:function(e,t,r){"use strict";r.d(t,"c",(function(){return p})),r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return h}));var n=r("9r0m"),i=r("vYfn"),a=r("i8/j"),o=r("F2uj"),s=r("gBKR"),c=r("VWqI"),l=r("j6Db"),u=r("+Xnp"),d=["activitytypecode","prioritycode","scheduledend","subject","description","regardingobjectid","ownerid","createdon","statecode","modifiedon"];function p(e,t,r){return{type:"formandattribute.retrieve.async",execute:function(c,u){var p=c.dispatch,m=c.getState,f="Card"===r;return e.etn&&"activitypointer"===e.etn&&f?p(Object(s.f)("activitypointer",!1,d)).then((function(){for(var t=m(),r={},n=0,i=d;n<i.length;n++){var a=i[n],s=Object(o.a)(t,e.etn,a);s&&h(t,e.etn,a,s)&&(r[a]=s)}return g(t,e.etn,r,Object(o.d)(t,e.etn)),{formDescriptor:null,attributeDescriptors:r}})):p(Object(i.b)(e,t,r)).then((function(i){var c={},d=null;return e.etn?p(Object(s.f)(e.etn,!0,[])).then((function(){var t=m();if(!n.a.isNullOrEmpty(i)&&(d=Object(a.j)(t,i))&&d.Attributes)for(var r in d.Attributes){var s=d.Attributes[r],l=Object(o.a)(t,e.etn,s);l&&h(t,e.etn,s,l)&&(c[s]=l)}return f&&g(t,e.etn,c,Object(o.d)(t,e.etn)),{formDescriptor:d,attributeDescriptors:c}})):(u.EventManager.ReportComponentSuccess("Form.CustomControl.retrieveFormWithAttributes",[{name:"APIName",value:l.a+".Actions.RetrieveFormWithAttributesAction"},{name:"formId",value:n.a.toString(t)},{name:"formType",value:r}]),null)}),(function(e){var i=e.get_message();u.EventManager.ReportComponentFailure("Form.CustomControl.retrieveFormWithAttributes",new Error(i),i,[{name:"APIName",value:l.a+".Actions.RetrieveFormWithAttributesAction"},{name:"formId",value:n.a.toString(t)},{name:"formType",value:r}])}))}}}function h(e,t,r,n){return Object(c.f)(e,t,r,u.a.CanRead)&&n&&n.IsValidForRead}function g(e,t,r,n){if(n)for(var i in n){var a=n[i];!a.IsSortableEnabled&&"modifiedon"!==a.LogicalName||r[i]||!h(e,t,a.LogicalName,a)||"image"===a.Type||"multiselectpicklist"===a.Type||(r[i]=a)}}},bJYk:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r("9r0m"),i=r("sOTk"),a=r("Z1aD"),o=r("KQ+A"),s=r("t8f4"),c=r("QAhb"),l=r("lMVv"),u=r("WS0f"),d=r("riBC"),p=r("7EJx"),h=r("JlqV"),g=r("HSdq"),m=r("YEEA");function f(e,t,r,c){var f=[{name:"formId",value:e},{name:"pageName",value:r}];return{type:"form.change",execute:function(y,v,_){var S=y.dispatch,O=y.getState,C=O();if(Object(g.Eb)(C,t))return Promise.reject(Object(m.b)(C,t,2200000016));var I=Object(i.g)(C,t),j=I.entityTypeName,P=I.id,F=I.recordSetQueryKey,T=I.data,w=I.createFromRelationship,E=I.initWithEntity;f.push({name:"entityTypeName",value:j});var x=n.a.tryParse(e),N={entityTypeName:j,formId:x,id:c?n.a.tryParse(c):P,recordSetQueryKey:F,data:T,createFromRelationship:w,initWithEntity:E},A=x.guid.toString(),k='<MRUForm><Form Type="Main" Id="'+A+'" /></MRUForm>',M=Object(d.c)(C,j);return S(Object(a.a)(r,N,t,{replaceState:!0})).then((function(e){var t,r;if(0===e.status)if(Object(h.b)(O()))null==M||M===n.a.EMPTY?function(e,t,r,i,a,c,d,h){var g=Object(l.p)(i,e),m=Object(p.q)(i),f="?$select=userentityuisettingsid&$filter=objecttypecode eq {0} and _ownerid_value eq '{1}'&$top=1",y=String.format(f,g.toString(),m.guid.toString());a(Object(s.e)("userentityuisettings",y)).then((function(p){p.value&&p.value.length>0&&(r=p.value[0].userentityuisettingsid?new n.a(p.value[0].userentityuisettingsid):n.a.EMPTY),Object(u.a)(r)||Object(u.a)(c)||Object(u.a)(e)||0===e.length||n.a.isNullOrEmpty(r)?null!=r&&r!==n.a.EMPTY||function(e,t,r,i,a,c,d){var p=n.a.EMPTY,h=Object(l.p)(r,e),g="userentityuisettings";i(Object(s.b)(g,{objecttypecode:h,lastviewedformxml:t})).then((function(t){if(p=t,!(Object(u.a)(p)||Object(u.a)(a)||Object(u.a)(e)||0===e.length||n.a.isNullOrEmpty(p))){var r=d.TraceManager.getTracer("Forms.FormSelectorChange"),s="Created an entry for selected form successfully formid : "+a;r.info(s),i(Object(o.b)(e,a,p))}})).catch((function(t){if(-2147093999===t.errorCode)return Object(u.a)(a)||Object(u.a)(e)||0===e.length||i(Object(o.b)(e,a,p)),{};var r=[{name:"CorrelationId",value:c.correlationId},{name:"ContextId",value:c.contextId},{name:"ActionStack",value:c.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],n="Catch block of ChangeForm.oDataCreate, for formid: "+a;d.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(n),void 0,r),d.TraceManager.getTracer("Forms.FormSelectorChange").error(n,r)}))}(e,t,i,a,c,d,h):b(e,t,r,i,a,c,d,h)})).catch((function(t){if(-2147093999===t.errorCode)return Object(u.a)(c)||Object(u.a)(e)||0===e.length||a(Object(o.b)(e,c,r)),{};var n=[{name:"CorrelationId",value:d.correlationId},{name:"ContextId",value:d.contextId},{name:"ActionStack",value:d.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],i="Catch block of ChangeForm.oDataRetrieve, for formid: "+c;h.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(i),void 0,n),h.TraceManager.getTracer("Forms.FormSelectorChange").error(i,n)}))}(j,k,M,O(),S,x,_,v):b(j,k,M,O(),S,x,_,v);else{Object(u.a)(x)||Object(u.a)(j)||0===j.length||S(Object(o.b)(j,x,M));var i=null===(t=null==v?void 0:v.TraceManager)||void 0===t?void 0:t.getTracer("Forms.FormSelectorChange"),a="Selected form did not save in the UserEntityUiSetting table, for formid: "+x;null==i||i.info(a)}else if(1===e.status){i=null===(r=null==v?void 0:v.TraceManager)||void 0===r?void 0:r.getTracer("Forms.FormSelectorChange"),a="Could not change to form with id "+A+" due to a navigation failure or because navigation was cancelled";null==i||i.info(a,f)}return e}))},getFailureParameters:function(e,t){return f}}}function b(e,t,r,i,a,l,d,p){var h=new c.a("userentityuisettings",r);a(Object(s.f)(h,{lastviewedformxml:t})).then((function(){if(!(Object(u.a)(r)||Object(u.a)(l)||Object(u.a)(e)||0===e.length||n.a.isNullOrEmpty(r))){var t=p.TraceManager.getTracer("Forms.FormSelectorChange"),i="Updated selected form successfully to : "+l;t.info(i),a(Object(o.b)(e,l,r))}})).catch((function(t){if(-2147093999===t.errorCode)return Object(u.a)(l)||Object(u.a)(e)||0===e.length||a(Object(o.b)(e,l,r)),{};var n=[{name:"CorrelationId",value:d.correlationId},{name:"ContextId",value:d.contextId},{name:"ActionStack",value:d.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],i="Catch block of ChangeForm.oDataUpdate, for formid: "+l;p.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(i),void 0,n),p.TraceManager.getTracer("Forms.FormSelectorChange").error(i,n)}))}},"bhC+":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="form.setSelectedFormId";function i(e,t){return{type:n,payload:{formId:t},meta:{pageId:e}}}},c0jI:function(e,t,r){"use strict";r.d(t,"g",(function(){return _})),r.d(t,"i",(function(){return S})),r.d(t,"h",(function(){return O})),r.d(t,"e",(function(){return C})),r.d(t,"f",(function(){return I})),r.d(t,"a",(function(){return j})),r.d(t,"c",(function(){return F})),r.d(t,"b",(function(){return w})),r.d(t,"d",(function(){return P}));var n=r("c/eZ"),i=r("uO/V"),a=r("Gemh"),o=r("sOTk");function s(e,t,r,n){var i,a;return{type:"update.grid.configuration",payload:((i={})[t]=((a={})[r]=e,a),i),meta:{pageId:n}}}function c(e,t,r){var n;return{type:"update.views.configuration",payload:((n={})[t]=e,n),meta:{pageId:r}}}var l=r("RXRQ"),u=r("U0B9"),d=r("2OIc"),p=r("i8/j"),h=r("9r0m"),g=r("RlP9"),m=r("S2mk"),f=r("T2Xs"),b=r("j6Db"),y=r("OTOS");function v(e,t){var r=Object(n.__assign)({},e.CustomControls);if(e.CustomControls[t]&&!e.CustomControls[t].isDefaultConfig){var i=!1;for(var a in e.CustomControls)if(j(e.CustomControls[a],e.CustomControls[t])&&a!==t.toString()){i=!0;break}if(!i){var o=-1;r[o]?o--:r[o.toString()]=e.CustomControls[t]}}return r[t]=null,r}function _(e,t,r,i,d){return{type:"customcontrol.changevisualization.homepage",sync:!0,execute:function(p,h){var g,m,y=p.dispatch,v=p.getState,_=v(),S=Object(u.b)(_),O=Object(a.k)(_,e,t),C={UniqueId:O?O.UniqueId:null,CustomControls:(g={},g[S]=Object(n.__assign)(Object(n.__assign)({},r),{FormFactor:S}),g),FormLibraries:O?O.FormLibraries:null,EventHandlers:O?O.EventHandlers:null},I=Object(o.g)(_,e).entityTypeName;if(d){var j=Object(a.T)(_,e,t);y(c({UniqueId:null,CustomControls:(m={},m[S]=null,m),FormLibraries:null,EventHandlers:null},j.guid,e))}y(Object(l.c)(r.CustomControlId)).then((function(){y(s(C,I,i,e))}),(function(t){var n=Object(f.b)(v(),r.CustomControlId);h.EventManager.ReportComponentFailure(n+".CustomControl.retrieveControlManifest",t,"retrieveControlManifest failure error message",[{name:"APIName",value:b.a+".Actions.SwitchVisualization"},{name:"entityTypeName",value:I},{name:"customControlId",value:r.CustomControlId},{name:"pageId",value:e},{name:"controlId",value:i},{name:"config",value:JSON.stringify(r)}])}))}}}function S(e,t,r,i,d){return{type:"customcontrol.changevisualization.homepage",sync:!0,execute:function(p){var h,m=p.dispatch,f=(0,p.getState)(),b=Object(u.b)(f),y=Object(a.T)(f,e,t),_=Object(g.d)(f,y),S={UniqueId:_?_.UniqueId:null,CustomControls:(h={},h[b]=Object(n.__assign)(Object(n.__assign)({},r),{FormFactor:b}),h),FormLibraries:_?_.FormLibraries:null,EventHandlers:_?_.EventHandlers:null},O=Object(o.g)(f,e).entityTypeName;if(d){var C=Object(a.k)(f,e,t);if(C&&C.CustomControls&&C.CustomControls[b]){var I={UniqueId:C.UniqueId,CustomControls:v(C,b),FormLibraries:C.FormLibraries,EventHandlers:C.EventHandlers};m(s(I,O,i,e))}}m(Object(l.c)(r.CustomControlId)).then((function(){m(c(S,y.guid,e))}))}}}function O(e,t,r){return{type:"customcontrol.changevisualization.subgrid",sync:!0,execute:function(i){var a,o=i.dispatch,c=(0,i.getState)(),h=Object(u.b)(c),g=Object(y.b)(c,e),m=Object(p.b)(c,e,g,r),f=Object(d.b)(c,m.UniqueId,g);if(f&&f.CustomControls){var b={UniqueId:m.UniqueId,CustomControls:(a={},a[h]=Object(n.__assign)(Object(n.__assign)({},t),{FormFactor:h}),a),FormLibraries:f.FormLibraries,EventHandlers:f.EventHandlers};o(Object(l.c)(t.CustomControlId)).then((function(){o(s(b,g.guid,f.UniqueId,e))}))}}}}function C(e,t,r,i,a){return{type:"customcontrol.changevisualization.associatedgrid.grid",sync:!0,execute:function(o){var c,d=o.dispatch,p=(0,o.getState)(),h=Object(u.b)(p),g={UniqueId:a.UniqueId,CustomControls:(c={},c[h]=Object(n.__assign)(Object(n.__assign)({},i),{FormFactor:h}),c),FormLibraries:a.FormLibraries,EventHandlers:a.EventHandlers};d(Object(l.c)(i.CustomControlId)).then((function(){d(s(g,t,r,e))}))}}}function I(e,t,r,i,a,o,d){return{type:"customcontrol.changevisualization.associatedgrid.view",sync:!0,execute:function(p){var h,g=p.dispatch,m=(0,p.getState)(),f=Object(u.b)(m),b={UniqueId:o.UniqueId,CustomControls:(h={},h[f]=Object(n.__assign)(Object(n.__assign)({},a),{FormFactor:f}),h),FormLibraries:o.FormLibraries,EventHandlers:o.EventHandlers};if(d&&d.CustomControls&&d.CustomControls[f]){var y={UniqueId:d.UniqueId,CustomControls:v(d,f),FormLibraries:d.FormLibraries,EventHandlers:d.EventHandlers};g(s(y,t,r,e))}g(Object(l.c)(a.CustomControlId)).then((function(){g(c(b,i.guid,e))}))}}}function j(e,t){if(e&&t){var r=!!e==!!t&&e.CustomControlId===t.CustomControlId&&e.Name===t.Name&&e.ShouldOverrideControlVisible===t.ShouldOverrideControlVisible&&e.Version===t.Version&&e.isDefaultConfig===t.isDefaultConfig&&function e(t,r){var n,i;if(t&&r&&t!==r){if(t instanceof Array&&r instanceof Array&&t.length!==r.length)return!1;for(var a in t)if(t[a]!==r[a]){if("function"==typeof t[a])continue;if(t[a]&&r[a]&&"object"==typeof t[a]&&"object"==typeof r[a]){if(e(t[a],r[a]))continue;return!1}if("EnableViewPicker"===a)return(null===(n=t[a])||void 0===n?void 0:n.toString())===(null===(i=r[a])||void 0===i?void 0:i.toString());if("ExtraFilters"!==a&&"PagingInput"!==a&&"FilteringInput"!==a&&"RefreshInput"!==a&&"ViewId"!==a&&"EntityName"!==a&&"LinkingInput"!==a&&"FirstDataRequestType"!==a&&"NativeFilterExpressionToRestore"!==a&&"LookupAttributeNameForHierarchy"!==a&&"SortingInput"!==a&&"function"!=typeof t[a])return!1}}return!0}(e.Parameters,t.Parameters);if(e.Children&&t.Children){if(Object.keys(e.Children).length===Object.keys(t.Children).length){for(var n in e.Children)r=r&&j(e.Children[n],t.Children[n]);return r}return!1}return r&&e.Children===t.Children}return!!e==!!t}function P(e,t,r,n,i,a,o,s){var c=t?t.TraceManager.getTracer("customcontrol"):null;return e(F(r,n,a.configuration,a,a.contextString,s).map((function(e){return e.configuration.DisplayNameKey}))).catch((function(e){return c&&c.info("Resource retrieve failed: "+e.message),Promise.resolve()}))}function F(e,t,r,n,a,o){var s=[];if(null==o)return s;if(a===i.h.CUSTOM&&n.configuration.isDefaultConfig)return s;var c=a===i.h.GRID||a===i.h.ASSOCIATEDGRID?Object(m.u)(n&&n.controlId,n&&n.gridEntityTypeName,n&&h.a.toString(n.viewId)):Object(m.x)(n&&n.controlId,n&&n.descriptor.Parameters);return s.push({configuration:c,formFactor:o,configurationType:null}),e&&e.CustomControls&&T(s,e,"GRID_CONFIG"),t&&t.CustomControls&&T(s,t,"VIEW_CONFIG"),s}function T(e,t,r){for(var n in t.CustomControls)if(t.CustomControls[n]&&!t.CustomControls[n].isDefaultConfig){for(var i=!1,a=0;a<e.length;a++)if(j(e[a].configuration,t.CustomControls[n])){i=!0;break}i||e.push({configuration:t.CustomControls[n],formFactor:n,configurationType:r})}}function w(e,t){return null!=t.DisplayNameKey?null!=e&&null!=e[t.DisplayNameKey]?e[t.DisplayNameKey]:t.DisplayNameKey:"Grid"}},cGlR:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r("c/eZ"),i=r("nuS9"),a=r("UKHH"),o=r("Nubg"),s=r("KovS"),c=r("Bz7c"),l=r("k6Yd"),u=r("1UTq"),d=r("EOcA"),p=r("L4Zk"),h=r("lhDp"),g=Object(u.c)((function(e,t,r){var n=Object(d.a)(e),i=Object(p.a)(e),a={root:{minWidth:"80px",height:"32px"},label:{fontWeight:c.b.semibold}};return Object(l.a)(n,a,r?Object(h.a)(e):Object(h.b)(e),i,t)})),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.primary,r=void 0!==t&&t,s=e.styles,c=e.theme;return i.createElement(a.a,Object(n.__assign)({},this.props,{variantClassName:r?"ms-Button--primary":"ms-Button--default",styles:g(c,s,r),onRenderDescription:o.b}))},t=Object(n.__decorate)([Object(s.a)("DefaultButton",["theme","styles"],!0)],t)}(i.Component)},cQE4:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("HSdq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.cb)(e,t,r);return i?i.footer:null}},cm3g:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(e){this._value=null,this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!1,configurable:!0}),e}()},cqI9:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o}));var n=r("Sscr"),i=r("uO/V"),a="chart.visualizationid.update";function o(e,t,r){return{type:"chart.visualizationid.update.async",execute:function(o,s){var c=o.dispatch,l=o.getState,u=s.TraceManager.getTracer(i.z),d=i.x+".updateVisualizationIdAction";try{u.info("Updating the chart visualization id"),t||(t=Object(n.k)(l(),e));var p=Object(n.v)(t);return c(function(e,t,r){return{type:a,payload:{name:"VisualizationId",value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,p,r)),s.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){var h="Updatation of the chart visualization id failed with error : "+e.message;s.EventManager.ReportComponentFailure(d,Error(h))}}}}},"d26+":function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r("Sscr"),i=r("jigW"),a=r("uO/V"),o="dataset.update.fetchxml";function s(e,t,r){return{type:"dataset.update.fetchxml.async",execute:function(s,c){var l=s.dispatch,u=(s.getState,c.TraceManager.getTracer(a.z)),d=a.x+".updateFetchXMLAction";try{u.info("Updating the fetch xml for the grid."),l(function(e,t,r){var i=Object(n.y)(t),a=Object(n.v)(t);return{type:o,payload:r,meta:{pageId:e,contextKey:i,dataSetContextKey:a}}}(e,t,r));var p=Object(i.j)(r),h=[];return h.push({name:"fetchXML",value:p}),c.EventManager.ReportComponentSuccess(d,h),Promise.resolve()}catch(e){var g="Updating the fetchxml for the grid with contextKey : "+Object(n.v)(t)+" failed with the error : "+e.message;c.EventManager.ReportComponentFailure(d,Error(g))}}}}},dWLV:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n,i=r("c/eZ"),a=r("ASFs"),o=r("nIt0"),s=Object(a.d)(((n={})[o.a]=function(e,t){return Object(i.__assign)({},t.payload.formlessControlOutputs)},n),{})},dcAs:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r("c/eZ"),i=r("7pqb"),a=r("Ww2r"),o=r("3Ng8"),s=r("mGpW"),c=r("HSdq"),l=r("F2uj");function u(e,t,r){return{type:"formChecker.ControlState.async",execute:function(u,d){var p,h,g=u.dispatch,m=u.getState;return Object(n.__awaiter)(this,void 0,void 0,(function(){var u,f,b,y,v,_,S,O,C,I,j,P,F,T,w;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return u=m(),f=null===(p=null==d?void 0:d.TraceManager)||void 0===p?void 0:p.getTracer(""+i.k+i.l),b=Object(c.eb)(u,e,t),y=Object(o.b)(),b&&f?[4,g(Object(s.e)(y))]:[2,Promise.resolve()];case 1:for(O in n.sent(),v=m(),_=Object(a.e)(v,y),S=[],b)(C=b[O])&&(I={id:e,controlName:O},j=Object(c.v)(v,I,t),P=(null==j?void 0:j.reason)?Object(a.c)(_,j.reason):null,F=C.labelSource?Object(a.c)(_,C.labelSource):null,T=C.dataFieldName?Object(l.a)(v,r,null==C?void 0:C.dataFieldName):null,w={"Control Name":O,"Control Label":Object(c.w)(v,I,t),"Control Label Source":"["+C.labelSource+"]"+(F?": "+F:""),Attribute:null==T?void 0:T.LogicalName,Disabled:null===(h=null==j?void 0:j.disabled)||void 0===h?void 0:h.toString(),"Disabled State Reason":"["+(null==j?void 0:j.reason)+"]"+(P?": "+P:"")},S.push(w));return f.warn(i.n,[{name:i.v,value:i.l},{name:i.l,value:JSON.stringify(S)}]),[2]}}))}))}}}},e2rP:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="header.commandbarvisible";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r){var a=Object(n.v)(t);return{type:i,payload:r,meta:{pageId:e,contextKey:a}}}},ePaV:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r("c/eZ"),i=r("wV3W"),a=r("7EJx"),o=r("gUzs"),s=r("HSdq"),c=r("Sscr"),l=r("cZkS"),u=r("TCzx"),d=r("jigW"),p=r("vO+w");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function h(){var e=null,t=null,r=null,h=null,m=0,f=null,b=null,y=null,v=null,_=null,S=null;return function(O,C,I,j){var P,F,T=Object(i.a)(O),w=Object(p.c)(O),E=Object(p.a)(O),x=null==E?void 0:E.Colors,N=C.viewPortWidth,A=Object(a.g)(O),k=Object(c.j)(O,C.id),M=Object(s.o)(O,C.id,k),D=N<=T.sizes.Breakpoints.DimensionS,R=Object(d.e)(O),B=Object(s.Eb)(O,C.id);if(t!==T||m!==N||f!==A||b!==I||y!==M||v!==j||_!==D||S!==B||r!==w||h!==x){var L=function(e,t){var r={boxSizing:"border-box",overflowX:"hidden",position:"relative",paddingBottom:"0px",paddingLeft:"0px",paddingRight:"0px"};return t?Object(n.__assign)(Object(n.__assign)({},e),r):e}({boxSizing:"border-box",overflowX:"hidden",position:"relative",paddingBottom:N<=T.sizes.Breakpoints.DimensionS?T.sizes.Measures.Measure050:T.sizes.Measures.Measure150,paddingLeft:N<=T.sizes.Breakpoints.DimensionS?T.sizes.Measures.Measure050:T.sizes.Measures.Measure075,paddingRight:N<=T.sizes.Breakpoints.DimensionS?T.sizes.Measures.Measure050:T.sizes.Measures.Measure075},B),V=function(e,t){var r={paddingTop:"0px"};return t?Object(n.__assign)(Object(n.__assign)({},e),r):e}({paddingTop:j.has(l.mb)?"0px":N<=T.sizes.Breakpoints.DimensionS?"25px":"37px",flex:"1 0 auto",height:"inherit"},B);e={tabListStyle:{listStyleType:"none",paddingLeft:N<=T.sizes.Breakpoints.DimensionS?"16px":T.sizes.Measures.Measure150,paddingRight:T.sizes.Measures.Measure150,paddingTop:j.has(l.mb)?"14px":"18px",paddingBottom:"10px",height:"60px",lineHeight:"55px",boxSizing:"border-box",maxWidth:"100%",backgroundColor:w?null===(P=null==x?void 0:x.Palette)||void 0===P?void 0:P.Primary01:"#ffffff"},scrollableTabListStyle:{listStyleType:"none",boxSizing:"border-box",maxWidth:"100%",backgroundColor:w?null===(F=null==x?void 0:x.Palette)||void 0===F?void 0:F.Primary01:"#ffffff",textAlign:"center",overflowX:"scroll",scrollBehavior:u.a.getInstance().get_IsIOS()?"auto":"smooth","::-webkit-scrollbar":{display:"none"},"-webkit-user-select":"none"},associatedGridContainerStyle:{flexGrow:R?1:void 0},tabBasicStyle:L,containerStyle:{width:"100%",display:"flex",paddingTop:N<=T.sizes.Breakpoints.DimensionS||j.has(l.mb)?void 0:"1.25rem",flexDirection:"column",flex:"1 0 auto",position:"relative"},tabsContainerStyle:V,headerStyle:{display:"block",flex:"0 0 auto",backgroundColor:"#f8f7f6",transition:o.c,transform:g(T,N,I,M)},cellContainerStyle:{flex:"0 1 auto"},selectedTabStyle:{height:"inherit",fontFamily:T.fontFamilies.Semibold,overflowY:B?"hidden":"scroll"},semanticZoomListItemStyle:{marginLeft:A?T.sizes.Measures.Measure100:0,marginRight:A?0:T.sizes.Measures.Measure100,fontSize:T.fontSizes.Font100,cursor:"pointer",maxWidth:T.sizes.Measures.Measure900,color:T.colors.BaseColor.Grey.Grey5,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",width:T.sizes.Measures.Measure300,height:"100%",listStyleType:"none",paddingTop:N<=T.sizes.Breakpoints.DimensionS?T.sizes.Measures.Measure050:T.sizes.Measures.Measure150,paddingLeft:N<=T.sizes.Breakpoints.DimensionS?T.sizes.Measures.Measure050:T.sizes.Measures.Measure150,paddingRight:0,paddingBottom:N<=T.sizes.Breakpoints.DimensionS?0:T.sizes.Measures.Measure100,boxSizing:"border-box",float:"left"},customSemanticZoomButtonStyle:{height:"100%",width:"100%"},overflowTabListItemStyle:{marginRight:0,marginLeft:0}};var z=u.a.getInstance();if(A&&z.get_IsIOS()){e.containerStyle=Object(n.__assign)(Object(n.__assign)({},e.containerStyle),{overflow:"hidden"})}t=T,m=N,f=A,b=I,y=M,v=j,_=D,S=B,r=w,h=x}return e}}function g(e,t,r,n){if(!r)return"none";var i=t<=e.sizes.Breakpoints.DimensionS?1.6:3;return n&&(i+=.75),"translateY(-"+i+"rem)"}},enCe:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="form.ShowHeaderFieldsInSection.set";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r){var a=Object(n.v)(t);return{type:i,payload:{showHeaderFieldsInSection:r},meta:{pageId:e,contextKey:a}}}},exGN:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return l}));var n=r("c/eZ"),i=r("nuS9"),a=r("Z1aD"),o=r("vTeb"),s=r("4E+q"),c=r("kyRo"),l="_blank",u=function(e){function t(t){var r=e.call(this,t)||this;return r._onClick=r._onClick.bind(r),r}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=this.context.Router.createUrlForPage(this.props.pageName,this.props.input);return i.createElement(o.a,{tabIndex:this.props.tabIndex,id:this.props.id,href:e,target:this.props.target,onClick:this._onClick,style:this.props.style,role:this.props.role,accessibilityLabel:this.props.accessibilityLabel,describedByElementId:this.props.describedByElementId},this.props.children)},t.prototype._onClick=function(e){e.preventDefault(),this.props.target===l?this.props.navigateToNewWindow(this.props.pageName,this.props.input,this.props.target):this.props.navigateTo(this.props.pageName,this.props.input,this.props.sourcePageId)},t}(i.Component);u.contextType=c.a;var d=Object(s.a)(void 0,(function(e){return{navigateTo:function(t,r,n){e(Object(a.a)(t,r,n))},navigateToNewWindow:function(t,r,n){e(Object(a.c)(t,r,n))}}}))(u)},f5rQ:function(e,t,r){"use strict";r.r(t),r.d(t,"ModelFormComponent",(function(){return te}));var n=r("c/eZ"),i=r("9r0m"),a=r("zWnx"),o=r("QAhb"),s=r("UGbr"),c=r("i8/j"),l=r("Eoze"),u=r("4fxQ"),d=r("nuS9"),p=r("kyRo"),h=r("XOQQ"),g=r("HMYz"),m=r("clbQ"),f=r("AtAR"),b=r("TVue"),y=r("4E+q"),v=r("rQCE"),_=r("YWpA"),S=r("ShM1"),O=r("Gh4N"),C={containerStyle:{paddingTop:"2em",paddingBottom:"2em",display:"flex",justifyContent:"center",borderBottom:"1px solid "+r("QVns").d.Grey.Grey3}},I=r("Ww2r"),j=r("I0a0");var P=d.memo((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){var t=d.useState(!1),r=t[0],n=t[1];d.useEffect((function(){var e=setTimeout((function(){n(!0)}),500);return function(){return clearTimeout(e)}}),[]);var i="form-component-spinner-container-"+e.id,a="form-component-spinner-"+e.id,o=Object(j.a)(["Model_Form_Component_Loading_Message"]),s=Object(I.c)(o,"Model_Form_Component_Loading_Message"),c=s&&""!==s;return r?d.createElement(_.a,{key:i,id:i,style:C.containerStyle},d.createElement(S.a,{key:a,id:a,label:c?s:"Getting things ready...",labelPosition:"right",size:O.a.large})):null})),F=r("uQP8"),T=r("Sscr"),w=r("HSdq"),E=r("wV3W"),x=Object(y.a)((function(e,t){var r,n,i=Object(b.a)(e,t.id),a=null===(r=Object(F.a)(e,t.id))||void 0===r?void 0:r.parentComponentId,o=a?null===(n=Object(w.cb)(e,a,Object(T.j)(e,a)))||void 0===n?void 0:n.viewportWidth:void 0,s=Object(E.a)(e);return{loadingState:i,initialSizeMode:null!=o&&o<s.sizes.Breakpoints.DimensionM?2:void 0}}))((function(e){var t=e.id,r=e.loadingState;return!r||r<v.a.EditReady?d.createElement(P,{id:t}):d.createElement(f.a,{id:t,initialSizeMode:e.initialSizeMode})})),N=r("H/hG");var A=d.memo((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){var t=Object(j.a)([e.resourceStringId]),r=Object(I.c)(t,e.resourceStringId),n=r&&""!==r,i="form-component-error-container-"+e.id,a="form-component-error-text-"+e.id;return d.createElement(_.a,{key:i,id:i,style:C.containerStyle},d.createElement(N.a,{key:a,id:a},n?r:null==e?void 0:e.defaultString))})),k=r("bdny"),M=r("kOjA"),D=r("tNVD");var R=r("WfDX"),B=r("iN5/"),L=r("Z9iR"),V=r("aGOT");var z,G=r("b/oW"),W=r("zmaG"),H=r.n(W),U=r("8wET"),q=r("iFdD"),X=r("7pqb"),K=r("1Tfq"),Q=r("ObKm"),Y=r("OTOS"),Z=r("lMVv"),J=r("yHpA"),$=r("exUJ"),ee=r("YEEA");!function(e){e[e.uninitialized=0]="uninitialized",e[e.initializing=1]="initializing",e[e.initialized=2]="initialized",e[e.disposed=3]="disposed",e[e.error=4]="error"}(z||(z={}));var te=function(){function e(t,r,n,a){var s,c,l;this._boundOnce=!1,this._div=t,this._subForms=Object(U.a)(r,n),this._state=z.uninitialized;var u=this._subForms[n];n&&a&&(this._entityReference=new o.a(n,new i.a(a))),this._performanceParameters=((s={})[X.b.EntityName]=n,s[X.b.FormId]=u,s),H.a.addKeyPerformanceIndicatorOnIdle("Forms.FormComponent",this._performanceParameters),this._formInput={entityTypeName:this._entityReference&&this._entityReference.etn,pageType:"entityrecord",formId:u?new i.a(u):void 0,id:null!==(l=null===(c=this._entityReference)||void 0===c?void 0:c.id)&&void 0!==l?l:i.a.EMPTY},this._tracer=e._context.TraceManager.getTracer("Forms.FormComponent")}return e.prototype.render=function(t){return this._div&&e._context&&e._store?this._entityReference&&this._entityReference.etn&&this._entityReference.id&&this._formInput&&this._formInput.formId?this._renderInternal():(this._renderNoBoundRecord(),Promise.resolve()):Promise.reject("Invalid params")},e.prototype.bindRecord=function(e,t,r){if(e&&t){var n=this._entityReference&&this._entityReference.etn,a=this._entityReference&&this._entityReference.id;if(this._updateEntityReferenceAndFormInput(e,t),n&&this._entityReference.etn===n&&i.a.equals(this._entityReference.id,a))return;!n&&this._entityReference.etn&&this._entityReference.id?this._renderInternal():n!==this._entityReference.etn?this._disposeThenRender():i.a.equals(this._entityReference.id,a)||this._bindRecordInternal()}else this._checkForUnsavedChanges()},e.prototype._checkForUnsavedChanges=function(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,r,i,a,o,s,l,u,d,p,h;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return t=e._store.getState(),r=Object(T.j)(t,this._formComponentId),i=Object(w.ac)(t,this._formComponentId,r),(null==(a=Object(J.b)(t,i))?void 0:a.activeChanges)&&Object.keys(a.activeChanges).length>0?(o=this._getLocalizedUnsavedChangesStrings(t),s=o.title,l=o.message,[4,e._store.dispatch(Object(K.a)(this._formComponentId,l,s))]):[3,2];case 1:if(!n.sent())return u=Object(c.b)(t,this._sourcePageId,Object(Y.b)(t,this._sourcePageId),this._controlName),(d=null==u?void 0:u.DataFieldName)&&((h={})[d]={fieldName:d,value:this._entityReference},p=h,e._store.dispatch(Object(Q.a)(this._sourcePageId,p,!1,!1))),[2];n.label=2;case 2:return this._disposeThenRenderNoBound(),[2]}}))}))},e.prototype._getLocalizedUnsavedChangesStrings=function(e){var t,r=Object(I.e)(e,["Model_Form_Component_Unsaved_Linked_Data_Title","Model_Form_Component_Unsaved_Linked_Data_Message"]),n=null===(t=Object(Z.h)(e,this._entityReference.etn))||void 0===t?void 0:t.DisplayName,i=Object(I.c)(r,"Model_Form_Component_Unsaved_Linked_Data_Message")||"There is data linked to this field that hasn't been saved. If you change this record those changes will be lost",a=Object(I.c)(r,"Model_Form_Component_Unsaved_Linked_Data_Title")||"Unsaved Linked Data";return n&&(a+=": "+n),{title:a,message:i}},e.prototype.save=function(t){return this._checkInitializationState(),e._store.dispatch(Object(s.e)(this._formComponentId,1)).then((function(e){return{entityReference:e}}))},e.prototype.refreshData=function(){var t=this;this._checkInitializationState();var r=Object(c.y)(e._store.getState(),this._formInput.formId);return e._store.dispatch(Object(l.c)(this._entityReference,r)).catch((function(e){throw t._disposeThenRenderError(e),e}))},e.prototype.register=function(t,r){
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n,i;this._formComponentId?(e._store.dispatch(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,r){return{type:D.b,payload:{formInstanceId:t,controlName:r},meta:{pageId:e}}}(t,this._formComponentId,this._controlName)),e._store.dispatch((n=t,i=this._formComponentId,{type:D.c,payload:{parentComponentId:n},meta:{pageId:i}}))):(this._controlName=r,this._sourcePageId=t)},e.prototype._disposeThenRenderNoBound=function(){var e=this;this._entityReference=void 0,this.dispose(),Object(B.b)((function(){e._renderNoBoundRecord()}),"Render no bound record component after ModelFormComponent dispose")},e.prototype._disposeThenRenderError=function(e){var t=this;this._entityReference=void 0,this._state=z.error,this.dispose(),Object(B.b)((function(){t._renderErrorElement(e)}),"Render no bound record component after ModelFormComponent dispose")},e.prototype._disposeThenRender=function(){var e=this;this.dispose(),Object(B.b)((function(){e._renderInternal()}),"Re-render formComponent")},e.prototype.dispose=function(){var t=this;this._clearDataSnapshots(),this._state!==z.initialized&&this._state!==z.error||(Object(q.d)(this._sourcePageId,this._controlName),Object(B.b)((function(){var r,n,i,a;e._store.dispatch({type:M.REMOVE_FORM_INSTANCE,payload:void 0,meta:{pageId:t._formComponentId}}),e._store.dispatch(Object(R.a)(t._formComponentId)),Object(L.a)(t._formComponentId),e._store.dispatch((n=t._sourcePageId,i=t._formComponentId,a=t._controlName,{type:D.g,payload:{formInstanceId:i,controlName:a},meta:{pageId:n}})),u.unmountComponentAtNode(t._div);var o=null===(r=e._context)||void 0===r?void 0:r.MutationObserverHandler;null==o||o.removeObserverTarget(t._mutationObserver),t._mutationObserver=void 0,t._state=z.uninitialized,t._formComponentId=void 0}),"Dispose formComponent "+this._formComponentId))},e.prototype._clearDataSnapshots=function(){var t=Object(T.j)(e._store.getState(),this._formComponentId),r=Object(w.ac)(e._store.getState(),this._formComponentId,t);e._store.dispatch(Object(V.c)(this._formComponentId,r,t))},e.prototype._checkInitializationState=function(){if(this._state!==z.initialized)return this._tracer.warn("Form Component has not been initialized."),Promise.reject("Form Component has not been initialized.")},e.prototype._checkIsEntityAndFormBound=function(){if(!(this._entityReference&&this._entityReference.etn&&this._entityReference.id&&this._formInput&&this._formInput.formId))return Promise.reject("Cannot render as the FormComponent does not have bound entity or associated form")},e.prototype._bindRecordInternal=function(){var t=this;return this._checkIsEntityAndFormBound(),this._checkInitializationState(),this._clearDataSnapshots(),Object(a.b)(e._store.getState(),e._store.dispatch,this._formComponentId,this._tracer,this._entityReference,this._formInput.formId,this._formInput,[]).then((function(){var r,n,i,a,o;return e._store.dispatch((r=e._store.getState(),n=t._formComponentId,i=t._entityReference,a={entityReference:i},o=Object(T.j)(r,n),{type:D.h,payload:a,meta:{pageId:n,contextToken:o}})),Promise.resolve()})).catch((function(e){throw t._disposeThenRenderError(e),e}))},e.prototype._updateEntityReferenceAndFormInput=function(e,t){this._entityReference=new o.a(e,new i.a(t)),this._formInput.id=this._entityReference.id,this._formInput.entityTypeName=this._entityReference.etn,this._formInput.formId=this._subForms&&this._subForms[this._entityReference.etn]?new i.a(this._subForms[this._entityReference.etn]):void 0},e.prototype._renderFormElement=function(){var e=d.createElement(x,{id:this._formComponentId});return this._renderElement(e)},e.prototype._renderNoBoundRecord=function(){var e={id:this._formComponentId,resourceStringId:"Model_Form_Component_No_Bound_Record_Message",defaultString:"Source record not selected"},t=d.createElement(A,e);return this._renderElement(t)},e.prototype._renderErrorElement=function(e){var t,r={id:this._formComponentId,resourceStringId:(null==e?void 0:e.errorCode)?null===(t=Object(ee.d)(e.errorCode))||void 0===t?void 0:t[0]:null,defaultString:"Unexpected Error"},n=d.createElement(A,r);return this._renderElement(n)},e.prototype._renderElement=function(t){var r=d.createElement(p.a.Provider,{value:e._context},t),n=d.createElement(h.a,{store:e._store},r),i=d.createElement(g.Provider,k.a,n);u.render(i,this._div);var a=e._context.MutationObserverHandler,o=m.a.getInstance();return this._mutationObserver=new MutationObserver((function(){o.scheduleMeasuringUpdate()})),a.addObserverTarget(this._mutationObserver,this._div.id),Promise.resolve(!0)},e.prototype._renderInternal=function(){var t,r=this;if(this._checkIsEntityAndFormBound(),this._renderFormElement(),this._state===z.uninitialized){this._state=z.initializing,this._formComponentId=this._boundOnce?Object(q.c)(this._sourcePageId,this._controlName):Object(q.b)(this._sourcePageId,this._controlName);var n=null===(t=Object(F.a)(e._store.getState(),this._formComponentId))||void 0===t?void 0:t.formLoadError;if(n&&!this._boundOnce)return this._boundOnce=!0,this._disposeThenRenderError(n),Promise.resolve();var i=!this._boundOnce&&Object($.a)(e._store.getState(),this._sourcePageId,this._controlName),a=i?Promise.resolve():Object(G.a)(this._formComponentId,this._formInput);return this._performanceParameters[X.b.ModelFormComponent.IsPreInitialized]=i.toString(),a.then((function(){r._state=z.initialized,r.register(r._sourcePageId,r._controlName),r._renderFormElement()})).catch((function(e){throw r._disposeThenRenderError(e),e})),this._boundOnce=!0,a}return Promise.reject("FormComponent is already initialized. Cannot initialize again")},e}()},"fH/t":function(e,t,r){"use strict";r.d(t,"g",(function(){return n})),r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"f",(function(){return c})),r.d(t,"e",(function(){return l})),r.d(t,"j",(function(){return u})),r.d(t,"h",(function(){return d})),r.d(t,"i",(function(){return p})),r.d(t,"k",(function(){return h}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="Grid_Paging_Mask",i="Grid_StatusMessage_Mask",a="Grid_ItemsSelected_Mask",o="Grid_TotalCount_Mask",s="Grid_ToolTip_FirstPage",c="Grid_ToolTip_PreviousPage",l="Grid_ToolTip_NextPage",u="Grid_TotalCount_SpaceMask",d="Grid_TotalCount_Approximate",p="Grid_TotalCount_Exact",h=[n,i,a,o,s,c,l,u,d,p]},fTYK:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="form.tab.selectPrevious";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){var r=Object(n.v)(t);return{type:i,payload:null,meta:{pageId:e,contextKey:r}}}},g24L:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("jJRu"),i=r("aGOT"),a=r("Cfob");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t){return void 0===e&&(e=null),t.type===n.a?t.payload.snapshotId:t.type===a.a?t.payload:t.type===i.a?null:e}},gPjR:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("wV3W"),i=r("7EJx"),a=r("vO+w");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(){var e=null,t=null,r=null,o=null,s=null;return function(c,l){var u,d,p,h,g=Object(n.a)(c),m=Object(a.c)(c),f=Object(a.a)(c),b=null==f?void 0:f.Colors,y=Object(i.g)(c);return t===g&&s===y&&o===b&&r===m||(t=g,s=y,o=b,r=m,e={selectedTabUnderlineStyle:{height:"3px",width:"auto",backgroundColor:m?null===(u=null==b?void 0:b.Palette)||void 0===u?void 0:u.Primary02:g.colors.BaseColor.Blue.Blue9,borderRadius:"2px",opacity:1,transition:"opacity 200ms;",marginTop:"3px"},highContrastSelectedTabUnerlineStyle:{height:"3px",width:"auto",borderTop:"solid transparent",opacity:1,transition:"opacity 200ms;",marginTop:"3px"},selectedTabStyle:{marginLeft:y?g.sizes.EditForm.TabListItemMargin:0,marginRight:y?0:g.sizes.EditForm.TabListItemMargin,padding:0,display:"inline",fontSize:g.fontSizes.Font115,cursor:"pointer",color:g.colors.BaseColor.Black,paddingBottom:"5px",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontFamily:g.fontFamilies.Semibold,width:"auto",maxWidth:g.sizes.EditForm.TabListItemMaxWidth,lineHeight:"25px"},scrollableSelectedTabStyle:{paddingLeft:g.sizes.EditForm.ScrollableTabListItemPadding,paddingRight:g.sizes.EditForm.ScrollableTabListItemPadding,paddingTop:"12px",paddingBottom:"12px",marginBottom:"8px",borderBottom:"1.5px solid "+(m?null===(d=null==b?void 0:b.Palette)||void 0===d?void 0:d.Primary02:g.colors.BaseColor.Blue.Blue9),flexGrow:1,display:"inline",fontSize:g.fontSizes.Font115,cursor:"pointer",color:m?null===(p=null==b?void 0:b.Palette)||void 0===p?void 0:p.Primary02:g.colors.BaseColor.Blue.Blue9,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontFamily:g.fontFamilies.Semibold,minWidth:"min-content",maxWidth:g.sizes.EditForm.ScrollableTabListItemMaxWidth,lineHeight:"25px","-webkit-user-select":"none"},singleScrollableSelectedTabStyle:{paddingLeft:g.sizes.EditForm.ScrollableTabListItemPadding,paddingRight:g.sizes.EditForm.ScrollableTabListItemPadding,paddingTop:"12px",paddingBottom:"12px",display:"inline",fontSize:g.fontSizes.Font115,cursor:"pointer",color:g.colors.BaseColor.Black,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontFamily:g.fontFamilies.Semibold,minWidth:"min-content",maxWidth:"none",lineHeight:"25px","-webkit-user-select":"none"},tabStyle:{marginLeft:y?g.sizes.EditForm.TabListItemMargin:0,marginRight:y?0:g.sizes.EditForm.TabListItemMargin,fontSize:g.fontSizes.Font115,padding:0,cursor:"pointer",width:"auto",maxWidth:g.sizes.EditForm.TabListItemMaxWidth,color:g.colors.BaseColor.Black,paddingBottom:g.sizes.Measures.Measure075,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontFamily:g.fontFamilies.Regular,lineHeight:"25px",":hover":{fontFamily:g.fontFamilies.Semibold}},scrollableTabStyle:{paddingLeft:g.sizes.EditForm.ScrollableTabListItemPadding,paddingRight:g.sizes.EditForm.ScrollableTabListItemPadding,paddingTop:"12px",paddingBottom:"12px",marginBottom:"8px",borderBottom:"0.5px solid "+g.colors.BaseColor.Grey.Grey2,flexGrow:1,fontSize:g.fontSizes.Font115,cursor:"pointer",minWidth:"min-content",maxWidth:g.sizes.EditForm.ScrollableTabListItemMaxWidth,color:g.colors.BaseColor.Black,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontFamily:g.fontFamilies.Regular,lineHeight:"25px","-webkit-user-select":"none",":active":{color:g.colors.BaseColor.Grey.Grey2}},semiboldContainerStyle:{visibility:"hidden",fontFamily:g.fontFamilies.Semibold,height:0,overflow:"hidden"},overflowButtonStyle:{borderStyle:"none",backgroundColor:m?null===(h=null==b?void 0:b.Palette)||void 0===h?void 0:h.Primary01:g.colors.BaseColor.White,cursor:"pointer",display:"inline",verticalAlign:"middle"}}),e}}},gRWC:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="formSelector.visible";function i(e,t,r){return{type:n,payload:{visible:r},meta:{pageId:e,formId:t}}}},gUzs:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return o}));var n=r("TCzx"),i="0.3s",a=n.a.getInstance().get_IsBrowserIE()?void 0:"transform 0.25s linear",o=a+",opacity 0.25s linear";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},grpZ:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"c",(function(){return c})),r.d(t,"b",(function(){return l}));var n=r("9r0m"),i=r("uQP8"),a=r("sOTk"),o=r("i8/j");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t,r){var n;void 0===r&&(r=!1);var s=Object(a.g)(e,t).entityTypeName,c=Object(o.n)(e,s);if(!r)return c;var l=Object(i.a)(e,t),u=null===(n=null==l?void 0:l.formSelector)||void 0===n?void 0:n.forms,d=c;if(u&&Object.keys(u).length>0)for(var p in d=new Object,c)u[p]&&!u[p].visible||(d[p]=c[p]);return d}function c(e,t,r){var s,c,l=Object(i.a)(e,t),u=n.a.toString(r);if(null===(c=null===(s=null==l?void 0:l.formSelector)||void 0===s?void 0:s.forms)||void 0===c?void 0:c[u])return l.formSelector.forms[u].visible;var d=Object(a.g)(e,t).entityTypeName;return!!Object(o.m)(e,d,r)||null}function l(e,t){var r,n=Object(i.a)(e,t);return null===(r=null==n?void 0:n.formSelector)||void 0===r?void 0:r.selectedFormId}},hE7j:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="control.setSrc";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r,a){var o=Object(n.v)(r);return{type:i,payload:{Url:a,isCustomSrc:!0},meta:{pageId:e,controlName:t,contextKey:o}}}},hurf:function(e,t,r){"use strict";r.r(t),r.d(t,"BarNotificationList",(function(){return T}));var n=r("c/eZ"),i=r("nuS9"),a=r("4fxQ"),o=r("4E+q"),s=r("lU69"),c=r("wV3W"),l=r("aPRd"),u=r("zt+H");var d=r("Ww2r"),p=r("Ro59"),h=r("zPLw"),g=r("gvL4"),m=r("H/hG"),f=r("YWpA"),b=r("Wi7Z"),y=r("1AYO"),v=r("9rQ4"),_=r("B73A"),S=r("akzq"),O=r("+spQ"),C=r("XIN1"),I=r("znb3"),j=r("IF6v"),P=Object(s.a)(),F=function(e){function t(t){var r=e.call(this,t)||this;return r._flyoutOutsideClickHandler=r._flyoutOutsideClickHandler.bind(r),r._notificationKeyDownHandler=r._notificationKeyDownHandler.bind(r),r._onNotificationItemDidMount=r._onNotificationItemDidMount.bind(r),r._toggleFlyout=r._toggleFlyout.bind(r),r._notificationRef=r._notificationRef.bind(r),r.onMeasuring=r.onMeasuring.bind(r),r.state={isNotificationFlyoutOpened:!1,focusedIndex:-1,isNotificationRendered:!1},r._previousHeaderCollapsed=t.headerCollapsed,r}return Object(n.__extends)(t,e),t.prototype._toggleFlyout=function(){this._updateFlyoutWidth(),this.state.isNotificationFlyoutOpened?this.setState(Object(n.__assign)(Object(n.__assign)({},this.state),{isNotificationFlyoutOpened:!this.state.isNotificationFlyoutOpened,focusedIndex:-1,isNotificationRendered:!1})):this.setState(Object(n.__assign)(Object(n.__assign)({},this.state),{isNotificationFlyoutOpened:!this.state.isNotificationFlyoutOpened}))},t.prototype._notificationsCountMessage=function(){var e=Object(d.c)(this.props.resourceStrings,p.a);return e=e.replace("{0}",String(this.props.notificationList.length))},t.prototype._updateFlyoutWidth=function(){var e=a.findDOMNode(this.refs.notificationWrapper);e&&(this._clientWidth=e.clientWidth)},t.prototype._createKeyboardShortcuts=function(){var e="Notification Flyout "+this.props.component,t=this._shortcutHandler.bind(this),r=this._shiftTabShortcutHandler.bind(this),n=[],i=new _.a([v.a.Escape],t,!0,e,"Close Notification Flyout"),a=new _.a([v.a.Enter],t,!1,e,"Open Notification Flyout",this._getWrapperId()),o=new _.a([v.a.UpArrow],t,!0,e,"Move Up on Notifiation Flyout"),s=new _.a([v.a.DownArrow],t,!0,e,"Move Down on Notifiation Flyout"),c=new _.a([v.a.Tab],t,!0,e,"Tab on the Notification Flyout"),l=new _.a([v.a.Shift,v.a.Tab],r,!0,e,"Shift Tab on the Notification Flyout");return n.push(i),n.push(a),n.push(o),n.push(s),n.push(c),n.push(l),n},t.prototype._shiftTabShortcutHandler=function(e){var t=e.EVENT;this.state.isNotificationFlyoutOpened&&(t.preventDefault(),t.stopPropagation())},t.prototype._shortcutHandler=function(e){var t=e.EVENT;if(t.keyCode===v.a.Enter)this.state.isNotificationFlyoutOpened||this._toggleFlyout();else if(t.keyCode===v.a.DownArrow&&this.state.focusedIndex>-1){var r=(this.state.focusedIndex+1+this.props.notificationList.length)%this.props.notificationList.length;this._moveFocus(r)}else if(t.keyCode===v.a.UpArrow&&this.state.focusedIndex>-1){r=(this.state.focusedIndex-1+this.props.notificationList.length)%this.props.notificationList.length;this._moveFocus(r)}else t.keyCode===v.a.Tab&&this.state.isNotificationFlyoutOpened&&t.preventDefault()},t.prototype._moveFocus=function(e){var t=a.findDOMNode(this._notificationItemsList).childNodes[e];t&&(t.tabIndex=0,t.focus(),this.setState({focusedIndex:e}))},t.prototype._notificationRef=function(e){this._notificationItemsList=e},t.prototype._onNotificationItemDidMount=function(){-1===this.state.focusedIndex&&this.state.isNotificationFlyoutOpened&&this.setState(Object(n.__assign)(Object(n.__assign)({},this.state),{isNotificationRendered:!0}))},t.prototype._renderNotificationList=function(e){var t=this;if(e&&e.length){var r=1===e.length,n=e.map((function(e,n){return i.createElement(j.a,{key:e.UniqueId,id:t.props.id,domWidth:t.props.domWidth,notification:e,notificationType:e.Level,shouldNotifyRenderComplete:!0,onRenderComplete:t._onNotificationItemDidMount,displayFullMessage:t.props.displayFullMessage,keyDownHandler:t._notificationKeyDownHandler,notificationWidth:t._clientWidth,onlyNotification:r,buttonMeasuringCallback:t.props.buttonMeasuringCallback,toggleFlyout:t._toggleFlyout})}));return i.createElement(g.a,{testhooks:{id:"notificationList"},ref:this._notificationRef,style:this.props.formNotificationListStyle,role:r?b.r:void 0},n)}},t.prototype._flyoutOutsideClickHandler=function(e){if(e&&e.target){var t=e.target.id;t!==this._getWrapperId()&&t!==this._getWrapperId()+"_icon"&&t!==this._getWrapperId()+"_message"&&t!==this._getWrapperId()+"_expandIcon"&&"notificationIcon"!==t&&t!==O.a&&this._toggleFlyout()}},t.prototype._notificationKeyDownHandler=function(e){if(this.state.isNotificationFlyoutOpened&&e&&e.keyCode&&e.keyCode===v.a.Escape){this._toggleFlyout(),e.stopPropagation();var t=a.findDOMNode(this.refs.notificationWrapper);t&&t.focus()}},t.prototype._getWrapperId=function(){return"notificationWrapper"+this.props.id},t.prototype._getMessageIcon=function(e){switch(e){case h.a:return I.a.MarkAsLost;case h.e:return I.a.Warning;case h.d:return I.a.SuccessIcon;default:return I.a.InformationIcon}},t.prototype.onMeasuring=function(e){var t=a.findDOMNode(this.refs.notificationWrapper);if(t){var r=t.clientWidth,i=t.clientHeight;this._clientWidth!==r&&this.state.isNotificationFlyoutOpened&&(this._updateFlyoutWidth(),this.setState(Object(n.__assign)(Object(n.__assign)({},this.state),{isNotificationFlyoutOpened:this.state.isNotificationFlyoutOpened,focusedIndex:-1,isNotificationRendered:!0}))),this._clientHeight!==i&&(this.props.buttonMeasuringCallback&&this.props.buttonMeasuringCallback(r,i),this._clientHeight=t.clientHeight)}},t.prototype.componentWillReceiveProps=function(e){this.state.isNotificationFlyoutOpened&&this._previousHeaderCollapsed!==e.headerCollapsed&&this._toggleFlyout()},t.prototype.render=function(){return i.createElement(f.a,{key:"barnotificationlistAccessibility",id:"barnotificationlistAccessibility_"+Object(s.a)()},this._renderBarNotifications())},t.prototype._renderBarNotifications=function(){var e=this;if(this.props.notificationList.length>0){if(1===this.props.notificationList.length){var t=this._renderNotificationList(this.props.notificationList);return i.createElement(f.a,{ref:"notificationWrapper",style:Object(n.__assign)(Object(n.__assign)({},this.props.formNotificationWrapperStyle),this.props.customStyle),testhooks:{id:"notificationWrapper"}},i.createElement(S.a,{keyboardShortcuts:this._createKeyboardShortcuts(),shouldManageFocus:!0}),t)}var r=void 0;if(this.state.isNotificationFlyoutOpened){t=this._renderNotificationList(this.props.notificationList);r=i.createElement(y.a,{key:P,id:P,flyoutDirection:y.b.down,relativeToElementId:this._getWrapperId(),enforceDirection:!0,positionType:"relative",flyoutStyle:this.props.formNotificationFlyoutStyle,size:{width:this._clientWidth||500},onOutsideClick:this._flyoutOutsideClickHandler,testhooks:{id:"notificationFlyout"}},t)}else r=void 0;return this.props.setFormNotificationHeight&&this.props.setFormNotificationHeight(u.a),i.createElement(f.a,{isRequestedMeasuring:!0,onMeasuring:this.onMeasuring,style:Object(n.__assign)(Object(n.__assign)({},this.props.formNotificationWrapperStyle),this.props.customStyle),role:b.a},i.createElement(f.a,{ref:"notificationWrapper",style:this.props.formNotificationStyle,onClick:function(){return e._toggleFlyout()},role:b.d,controlsElementId:P,notificationType:"assertive",testhooks:{id:"notificationWrapper"},id:this._getWrapperId(),tabIndex:0,accessibilityExpanded:this.state.isNotificationFlyoutOpened},i.createElement(S.a,{key:"flyoutAccessibility",rootElementId:this._getWrapperId(),keyboardShortcuts:this._createKeyboardShortcuts(),shouldManageFocus:!1}),i.createElement(m.a,{id:this._getWrapperId()+"_icon",style:this.props.notificationList.some((function(e){return e.Level===h.a}))?this.props.notificationIconWrapperStyle:this.props.notificationNoErrorIconWrapperStyle},i.createElement(C.b,{style:this.props.notificationIconStyle,id:"notificationIcon",type:this._getMessageIcon(this.props.mostSevereLevel),testhooks:{id:"formNotificationIcon"}})),i.createElement(m.a,{id:this._getWrapperId()+"_message",announceAccessibilityNotification:!0,ownsElementId:this.state.isNotificationFlyoutOpened?P:void 0,style:this.props.notificationList.some((function(e){return e.Level===h.a}))?this.props.alertTextStyle:this.props.alertNoErrorTextStyle},this._notificationsCountMessage()),i.createElement(m.a,{id:this._getWrapperId()+"_expandIcon",style:this.props.notificationExpandIconWrapperStyle},i.createElement(C.b,{style:this.props.notificationExpandIconStyle,id:O.a,type:this.state.isNotificationFlyoutOpened?I.a.ChevronUp:I.a.ChevronDown,testhooks:{id:{NOTIFICATION_EXPAND_ICON_ID:O.a}}})),r))}return null},t.prototype.componentDidUpdate=function(){-1===this.state.focusedIndex&&this._notificationItemsList&&this.state.isNotificationFlyoutOpened&&this.state.isNotificationRendered&&this._moveFocus(0),this._previousHeaderCollapsed=this.props.headerCollapsed},t.prototype.componentDidMount=function(){this._previousHeaderCollapsed=this.props.headerCollapsed},t}(i.Component);F.displayName="BarNotificationList";var T=Object(o.a)((function(){var e,t,r,i,a,o=(e=null,t=null,r=null,i=null,a=null,function(n,o,s){var d=Object(c.a)(n),p=Object(l.b)(n),h=Object(l.c)(n);if(r!==d||i!==p||a!==h||t!==s){r=d,i=p,a=h,t=s;var g=Object(u.d)(s);e={formNotificationWrapperStyle:{display:"flex",width:"100%",boxSizing:"border-box",minHeight:u.a+"px",maxHeight:"100%",marginTop:d.sizes.Measures.Measure100},formNotificationStyle:{display:"flex",backgroundColor:g,flex:"1 1 auto",cursor:"pointer",boxSizing:"border-box"},formNotificationFlyoutStyle:{left:"15px",display:"flex",flexDirection:"column",boxShadow:"0px 1.2px 3.6px rgba(0, 0, 0, 0.12), 0px 6.4px 7.2px rgba(0, 0, 0, 0.1)"},formNotificationListStyle:{overflowY:"hidden",listStyleType:"none",width:"100%",display:"inline"},notificationIconWrapperStyle:{textAlign:"center",backgroundColor:"transparent",borderBottom:"1px solid transparent",height:"20px",paddingLeft:"10px",paddingRight:"10px",paddingTop:"6px"},notificationNoErrorIconWrapperStyle:{textAlign:"center",backgroundColor:"transparent",borderBottom:"1px solid transparent",height:"20px",paddingLeft:"10px",paddingRight:"10px",paddingTop:"6px",color:"#797673"},notificationIconStyle:{height:"20px",width:"20px",fontSize:"20px",color:Object(u.e)(s)},alertTextStyle:{flexGrow:1,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontSize:"12px",fontFamily:d.fontFamilies.Regular,color:"#1F2126",marginTop:"7px",lineHeight:"16px"},alertNoErrorTextStyle:{flexGrow:1,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontSize:"12px",fontFamily:d.fontFamilies.Regular,color:"#1F2126",marginTop:"7px",lineHeight:"16px"},notificationExpandIconWrapperStyle:{paddingTop:"9px",paddingRight:"10px",paddingLeft:"10px",textAlign:"center",backgroundColor:"transparent"},notificationExpandIconStyle:{height:"16px",width:"16px",fontSize:"16px",color:"#1F2126"}}}return e}),s=Object(d.h)();return function(e,t){var r=function(e){var t=h.b;if(!e||0===e.length)return t;for(var r=[h.a,h.e,h.b,h.d],n=e.map((function(e){return e.Level})),i=0,a=r;i<a.length;i++){var o=a[i];if(n.indexOf(o)>=0)return o}return t}(t.notificationList),i=o(e,t,r),a=s(e,p.f);return Object(n.__assign)(Object(n.__assign)({},i),{mostSevereLevel:r,resourceStrings:a})}}))(F)},i6iy:function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return f}));var n=r("cZkS"),i=r("9r0m"),a=r("Gemh"),o=r("qC0c"),s=r("Wye+"),c=r("UOiB"),l=r("olrR"),u=r("RlP9"),d=r("r2h9"),p=r("uO/V"),h=r("19Zc"),g=r("jigW");function m(e,t,r,m){return{type:"grid.quickfind.apply.async",execute:function(f,b){var y=f.dispatch,v=f.getState,_=b.TraceManager.getTracer(p.z),S=p.x+".QuickFilterAction";try{var O=v(),C=Object(a.F)(O,t,r,m);return function(e,t,r){return new Promise((function(n){var i=Object(u.a)(e,r,d.a.QUICKFIND_SEARCH);i?n(i):t(Object(l.a)(r,d.a.QUICKFIND_SEARCH,d.b.savedview)).then((function(e){n(e)}))}))}(O,y,C).then((function(l){_.info("Performing quick find on the grid ");var u=Object(a.T)(O,t,r,m),p=u,f=r.contextTokenType===c.a.SubGrid,C=!1;if(f&&r.controlName){var I=Object(a.hb)(v(),t,r,r.controlName);I&&(C=I.EnableViewPicker)}return Object(o.a)(v(),n.Nd)&&f&&!C||Object(g.l)(O)||(p=l),y(Object(h.n)(e,t,r)),y(Object(s.a)(t,r,m,i.a.toString(p),null,d.a.QUICKFIND_SEARCH)).then((function(){return b.EventManager.ReportComponentSuccess(S),u}))}))}catch(e){b.EventManager.ReportComponentFailure(S,Error("Unable to perform a quick find on the grid"))}}}}function f(e,t,r,n){return{type:"grid.quickfind.clear.async",execute:function(a,o){var c=a.dispatch,l=(a.getState,o.TraceManager.getTracer(p.z)),u=p.x+".QuickFilterAction";try{return l.info("Clearing quick find from the grid."),c(Object(h.n)("",t,r)),c(Object(s.a)(t,r,n,i.a.toString(e))).then((function(){o.EventManager.ReportComponentSuccess(u)}))}catch(e){o.EventManager.ReportComponentFailure(u,Error("Unable to clear quick find value for grid"))}}}}},ig6i:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(e,t){this._etn=null,this._attributeName=null,this._etn=e,this._attributeName=t}return Object.defineProperty(e.prototype,"etn",{get:function(){return this._etn},set:function(e){this._etn=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attributeName",{get:function(){return this._attributeName},set:function(e){this._attributeName=e},enumerable:!1,configurable:!0}),e}()},ixd0:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n,i=r("9r0m"),a=r("IiPO"),o=r("sOTk"),s=r("+Z9T"),c=r("ezfI"),l=r("bJYk"),u=r("gRWC"),d=r("grpZ"),p=function(){function e(e,t,r,i){this._id=e,this._label=t,n=r,this._pageId=i}return e.prototype.getId=function(){var e="ClientApi.XrmFormSelectorItem.getId";try{c.a.instance.reportCall(e);var t=i.a.toString(this._id);return c.a.instance.reportSuccess(e),t}catch(t){throw a.a.getInstance().reportFailure(e,t),t}},e.prototype.getLabel=function(){return c.a.instance.reportUsage("ClientApi.XrmFormSelectorItem.getLabel"),this._label},e.prototype.getPageId=function(){return c.a.instance.reportUsage("ClientApi.XrmFormSelectorItem.getPageId"),this._pageId},e.prototype.setVisible=function(e){var t="ClientApi.XrmFormSelectorItem.setVisible";try{c.a.instance.reportCall(t),n.dispatch(Object(u.b)(this._pageId,i.a.toString(this._id),e)),c.a.instance.reportSuccess(t)}catch(e){throw a.a.getInstance().reportFailure(t,e),e}},e.prototype.getVisible=function(){var e="ClientApi.XrmFormSelectorItem.getVisible";try{c.a.instance.reportCall(e);var t=Object(d.c)(n.getState(),this._pageId,this._id);return c.a.instance.reportSuccess(e),t}catch(t){throw a.a.getInstance().reportFailure(e,t),t}},e.prototype.navigate=function(){var e="ClientApi.XrmFormSelectorItem.navigate";try{this._pageId||Object(s.j)(e,"PageId"),c.a.instance.reportCall(e);var t=Object(o.g)(n.getState(),this._pageId),r=t&&t.id?t.id.guid:"",i=Object(o.l)(n.getState(),this._pageId);n.dispatch(Object(l.a)(this._id.guid,this._pageId,i,r)).then((function(){c.a.instance.reportSuccess(e)})).catch((function(t){return Object(s.d)(n,t,e+".changeForm")}))}catch(t){throw a.a.getInstance().reportFailure(e,t),t}},e}()},jFO5:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r("c/eZ"),i=r("nuS9"),a=r("4fxQ"),o=r("gPjR"),s=r("4E+q"),c=r("Smta"),l=r("H/hG"),u=r("YWpA"),d=r("XIN1"),p=r("znb3"),h=r("Wi7Z"),g=r("MGMD"),m=r("VnpK"),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.render=function(){var e,t=this.props.isScrollable?this.props.scrollableTabStyle:this.props.tabStyle;this.props.isSelected&&(t=this.props.isScrollable?1===this.props.tabLength?this.props.singleScrollableSelectedTabStyle:this.props.scrollableSelectedTabStyle:this.props.selectedTabStyle);var r,a=Object(n.__assign)(Object(n.__assign)({},t),this.props.style);if(this.props.isMoreTab)r=i.createElement(c.a,{style:a,id:this.props.id,role:h.t,tabIndex:this.props.isSelected&&this.props.tabLength>1?0:-1,testhooks:this.props.testhooks,accessibilityHasPopup:!0,accessibilityExpanded:!!this.props.isFlyoutOpened,onClick:this.props.onClick,accessibilityLabel:this.props.label},i.createElement(u.a,{style:this.props.overflowButtonStyle,id:"button_"+this.props.id,accessibilityHidden:!0,testhooks:{id:"more_button"}},i.createElement(l.a,null,i.createElement(d.b,{id:"icon_"+this.props.id,type:p.a.More}))));else{var o=this.props.relatedTabId===this.props.id,s=this.props.isFlyoutOpened?"relatedEntityContainer":"",f=Object(m.n)()?this.props.highContrastSelectedTabUnerlineStyle:this.props.selectedTabUnderlineStyle;r=i.createElement(c.a,Object(n.__assign)({style:a,id:this.props.id,testhooks:this.props.testhooks,"aria-controls":this.props.tabName,isSelected:this.props.isSelected,tabIndex:this.props.isSelected?0:-1,role:this.props.isOverFlowEnabled?h.n:h.t,ownsElementId:o?s:"",accessibilityHasPopup:!!o||null,accessibilityExpanded:o?!!this.props.isFlyoutOpened:null,title:this.props.label,accessibilityLabel:this.props.label,onClick:this.props.onClick},((e={})[g.a.LearningPathDOMAttributeName]="form-tab-"+this.props.id,e)),this.props.label,i.createElement(u.a,{style:this.props.isSelected&&!this.props.isScrollable?f:null,accessibilityHidden:!0}),i.createElement(u.a,{style:this.props.semiboldContainerStyle,accessibilityHidden:!0},this.props.label))}return r},t.prototype.componentDidUpdate=function(e){if(this.props.isSelected&&!e.isSelected){var t=a.findDOMNode(this);t&&t.focus()}},t}(i.Component);f.displayName="TabListItem";var b=Object(s.a)((function(){var e=Object(o.a)();return function(t,r){var n=e(t,r);return{selectedTabStyle:n.selectedTabStyle,scrollableSelectedTabStyle:n.scrollableSelectedTabStyle,singleScrollableSelectedTabStyle:n.singleScrollableSelectedTabStyle,tabStyle:n.tabStyle,scrollableTabStyle:n.scrollableTabStyle,selectedTabUnderlineStyle:n.selectedTabUnderlineStyle,highContrastSelectedTabUnerlineStyle:n.highContrastSelectedTabUnerlineStyle,semiboldContainerStyle:n.semiboldContainerStyle,overflowButtonStyle:n.overflowButtonStyle}}}))(f)},jWor:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="navigation.item.defaultvalues";function i(e,t,r){return{type:n,payload:{allNavBarByRelationshipItems:t,currentLanguageId:r},meta:{pageId:e}}}},jaaU:function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return a})),r.d(t,"d",(function(){return o})),r.d(t,"e",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="Web.Header.MoreFields",i="HeaderFields.KeyboardShortCut.Escape",a="Header_Fields_Label",o="HeaderFields.More.Error",s=["ProcessControl.Configurator.Collapse","ProcessControl.Configurator.Expand",n,i,"HeaderFields.KeyboardShortCut.Area",a,"Flyout.KeyboardShortCut.Tab.NotAllowed","HeaderFields.KeyboardShortCut.Down","HeaderFields.KeyboardShortCut.Up",o]},"jw+s":function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return h})),r.d(t,"d",(function(){return g}));var n=r("tIxw"),i=r("2rJs"),a=r("QSLN"),o=r("Ro59"),s=r("rIXY"),c=r("RndP"),l=r("/0Sa"),u=r("CUpQ"),d="Role_Editor_Row_Name_Quick_Create",p="PageLoadingMessage",h="SharePoint.Form.Saving",g=["Button_Label_Close",d,p,h].concat(n.g,i.m,a.o,o.f,c.c,s.h,l.b,[u.g,u.f],[u.d])},kOjA:function(e,t,r){"use strict";r.r(t),r.d(t,"formInstancesReducer",(function(){return u})),r.d(t,"CREATE_FORM_INSTANCE",(function(){return s})),r.d(t,"REMOVE_FORM_INSTANCE",(function(){return c}));var n=r("c/eZ"),i=r("52Se"),a=r("GRiv"),o=r("tNVD"),s="formInstance.create",c="formInstance.remove",l={};function u(e,t){var r,o;if(void 0===e&&(e=l),t.meta&&t.meta.pageId){var u=t.meta.pageId;if(void 0===e[u]){if(t.type===s){var p={},h=Object(n.__assign)(Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},p),Object(i.a)(p,t)),Object(a.b)(p,t)),d(p,t));e=Object.freeze(Object(n.__assign)(Object(n.__assign)({},e),((r={})[u]=h,r)))}}else{if(t.type===c){for(var g={},m=0,f=Object.keys(e);m<f.length;m++){var b=f[m];b!==u&&(g[b]=e[b])}return Object.freeze(g)}var y=e[u],v=Object(n.__assign)(Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},y),Object(i.a)(y,t)),Object(a.b)(y,t)),d(y,t));e=Object.freeze(Object(n.__assign)(Object(n.__assign)({},e),((o={})[u]=v,o)))}}return e}function d(e,t){return{input:function(e,t){void 0===e&&(e={});if(t.type===s)return Object.freeze(Object(n.__assign)({},t.payload.input));if(t.type===o.h)return Object(n.__assign)(Object(n.__assign)({},e),{id:t.payload.entityReference.id});return e}(e.input,t),__pageName:function(e,t){void 0===e&&(e=void 0);if(t.type===s)return t.payload.__pageName;return e}(e.__pageName,t)}}},ksD2:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return p}));var n=r("Sscr"),i=r("HSdq"),a=r("s0Zj"),o=r("ar+e"),s=r("B188"),c=r("4sax"),l=r("7pqb"),u=r("KzM6"),d="tab.visible";function p(e,t,r,p){return{type:"tab.visible.sync",sync:!0,execute:function(h,g){var m,f=h.dispatch,b=h.getState,y=b();f(function(e,t,r,i){var a=Object(n.v)(r);return{type:d,payload:i,meta:{pageId:e,tabId:t,contextKey:a}}}(e,t,r,p));var v=Object(i.wc)(y,{id:e},r),_=Object(o.e)(y,{id:e},r);if(v||(null==_?void 0:_.isSelected)||!p){if(v===t&&!p){var S=Object(i.fb)(y,{id:e},r),O=!1;if(S)for(var C=0,I=Object(i.m)(y,S);C<I.length;C++){var j=I[C];if(j.Id!==t&&Object(i.Kc)(y,j.Id,e,r)){O=!0,f(Object(a.b)(e,j.Id,r));break}}O||f(Object(a.b)(e,void 0,r))}}else f(Object(a.b)(e,t,r));if(Object(s.a)()){var P=b(),F=null===(m=null==g?void 0:g.TraceManager)||void 0===m?void 0:m.getTracer(""+l.k+l.r),T=Object(i.Kc)(y,t,e,r),w=Object(i.Kc)(P,t,e,r),E=Object(u.a)(P,e);E.push({name:"tabId",value:t}),E.push({name:"tabName",value:Object(i.Ic)(P,t,e,r)}),E.push({name:"tabLabel",value:Object(i.Hc)(P,t,e,r)}),E.push({name:"visible state before change",value:null==T?void 0:T.toString()}),E.push({name:"visible state after change",value:null==w?void 0:w.toString()}),E.push({name:"callstack",value:new c.a(new Error).getStackTrace()}),null==F||F.warn(l.n,[{name:l.v,value:l.r+".visible"},{name:l.r,value:JSON.stringify(E)}])}}}}},l2WT:function(e,t,r){"use strict";r.d(t,"a",(function(){return C}));var n=r("c/eZ"),i=r("nuS9"),a=r("HSdq"),o=r("4E+q"),s=r("hurf"),c=r("Sscr");function l(e,t,r){var n=[{name:"controlId",value:r}];return{type:"onClick.FormNotificationAction.sync",sync:!0,execute:function(i,a,o){var s=i.dispatch;i.getState;(n.push({name:"CorrelationId",value:o.correlationId},{name:"ContextId",value:o.contextId},{name:"ActionStack",value:o.stack}),r)?(s(a.ScriptManager.getContainer(t).getEventManager().runOnClick(e,r)),a.EventManager.ReportComponentSuccess("Forms.FormNotificationButtonOnClickAction",n)):a.TraceManager.getTracer("Forms.FormNotificationButtonOnClickAction").warn("Null/undefined controlId.",n)},getFailureParameters:function(e,t){return n}}}var u=r("K1ho"),d=r("qC0c"),p=r("cZkS"),h=r("zPLw"),g=r("Ww2r"),m=r("Ro59"),f=r("5aNC"),b=r("yotr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function y(e){return i.createElement(s.BarNotificationList,Object(n.__assign)({},e))}function v(e,t,r,n){if(e)return e.map((function(e,i){var a=Object(f.b)(n,i+"");return{Label:e.Label,Handler:l(t,r,a)}}))}function _(e,t,r,n){if(e)return e.map((function(e,i){var a=Object(b.b)(n,i+"");return{Label:e.Label,Handler:l(t,r,a)}}))}function S(e,t,r,n,i){return!t.ControlName&&r&&t.Level!==h.c&&n?(e||"")+" "+function(e){return Object(g.b)(e,m.d)}(i):e}function O(e){return{type:"set.focus.on.notification",execute:function(t,r){var n=t.dispatch,i=t.getState;if(e.ControlName){var a=[{name:"NotificationId",value:e.UniqueId}],o=Object(c.j)(i(),e.ComponentId);return n(Object(u.a)(e.ComponentId,o,e.ControlName)).then((function(){r.EventManager.ReportComponentSuccess("Forms.SetFocusAction.entered",a)}))}}}}y.displayName="FormNotificationList";var C=Object(o.a)((function(){var e={},t=[],r=Object(a.Zc)();return function(i,o){var s=r(i,o.id);return e!==s&&(t=function(e,t,r){var i=[];if(e)for(var o=Object(d.a)(r,p.ob),s=Object(c.j)(r,t),l=Object(a.zb)(r,t,s),u=0,h=Object.keys(e);u<h.length;u++){var g=e[h[u]],m=g.UniqueId in l,f=Object(n.__assign)(Object(n.__assign)({},g),{Buttons:v(g.Buttons,s,t,g.UniqueId),MessagePlaceholders:_(g.MessagePlaceholders,s,t,g.UniqueId),Message:S(g.Message,g,m,o,r),OnNotificationClick:g.ControlName&&o&&O(g)});i.push(f)}return i}(s,o.id,i),e=s),{notificationList:t}}}))(y)},lFQy:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("9r0m"),i=r("5fD4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function a(e,t){var r,a={dataById:(r={},r[n.a.toString(t.id)]=e,r)};return{type:i.a,payload:a}}},lhDp:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return s}));var n=r("c/eZ"),i=r("7JDo"),a=r("So1i");function o(e){var t,r,a,o,s,c=e.semanticColors,l=e.palette,u=c.buttonBackground,d=c.buttonBackgroundPressed,p=c.buttonBackgroundHovered,h=c.buttonText,g=c.buttonTextHovered,m=c.buttonTextChecked,f=c.buttonTextCheckedHovered;return{root:{backgroundColor:u,color:h},rootHovered:{backgroundColor:p,color:g,selectors:(t={},t[i.b]={borderColor:"Highlight",color:"Highlight"},t)},rootPressed:{backgroundColor:d,color:m},rootExpanded:{backgroundColor:d,color:m},rootChecked:{backgroundColor:d,color:m},rootCheckedHovered:{backgroundColor:d,color:f},rootDisabled:{selectors:(r={},r[i.b]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},r)},splitButtonContainer:{selectors:(a={},a[i.b]={border:"none"},a)},splitButtonMenuButton:{color:l.white,backgroundColor:"transparent",selectors:{":hover":{backgroundColor:l.neutralLight,selectors:(o={},o[i.b]={color:"Highlight"},o)}}},splitButtonMenuButtonDisabled:{backgroundColor:c.buttonBackgroundDisabled,selectors:{":hover":{backgroundColor:c.buttonBackgroundDisabled}}},splitButtonDivider:Object(n.__assign)(Object(n.__assign)({},{position:"absolute",width:1,right:31,top:8,bottom:8}),{backgroundColor:l.neutralTertiaryAlt,selectors:(s={},s[i.b]={backgroundColor:"WindowText"},s)}),splitButtonDividerDisabled:{backgroundColor:e.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:l.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:l.neutralQuaternaryAlt}}},splitButtonMenuButtonExpanded:{backgroundColor:l.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:l.neutralQuaternaryAlt}}},splitButtonMenuIcon:{color:c.buttonText},splitButtonMenuIconDisabled:{color:c.buttonTextDisabled}}}function s(e){var t,r,o,s,c,l,u,d,p,h=e.palette,g=e.semanticColors;return{root:{backgroundColor:g.primaryButtonBackground,border:"1px solid "+g.primaryButtonBackground,color:g.primaryButtonText,selectors:(t={},t[i.b]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},t["."+a.a+" &:focus"]={selectors:{":after":{border:"none",outlineColor:h.white}}},t)},rootHovered:{backgroundColor:g.primaryButtonBackgroundHovered,border:"1px solid "+g.primaryButtonBackgroundHovered,color:g.primaryButtonTextHovered,selectors:(r={},r[i.b]={color:"Window",backgroundColor:"Highlight",borderColor:"Highlight"},r)},rootPressed:{backgroundColor:g.primaryButtonBackgroundPressed,border:"1px solid "+g.primaryButtonBackgroundPressed,color:g.primaryButtonTextPressed,selectors:(o={},o[i.b]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},o)},rootExpanded:{backgroundColor:g.primaryButtonBackgroundPressed,color:g.primaryButtonTextPressed},rootChecked:{backgroundColor:g.primaryButtonBackgroundPressed,color:g.primaryButtonTextPressed},rootCheckedHovered:{backgroundColor:g.primaryButtonBackgroundPressed,color:g.primaryButtonTextPressed},rootDisabled:{selectors:(s={},s[i.b]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},s)},splitButtonContainer:{selectors:(c={},c[i.b]={border:"none"},c)},splitButtonDivider:Object(n.__assign)(Object(n.__assign)({},{position:"absolute",width:1,right:31,top:8,bottom:8}),{backgroundColor:h.white,selectors:(l={},l[i.b]={backgroundColor:"Window"},l)}),splitButtonMenuButton:{backgroundColor:g.primaryButtonBackground,color:g.primaryButtonText,selectors:(u={},u[i.b]={backgroundColor:"WindowText"},u[":hover"]={backgroundColor:g.primaryButtonBackgroundHovered,selectors:(d={},d[i.b]={color:"Highlight"},d)},u)},splitButtonMenuButtonDisabled:{backgroundColor:g.primaryButtonBackgroundDisabled,selectors:{":hover":{backgroundColor:g.primaryButtonBackgroundDisabled}}},splitButtonMenuButtonChecked:{backgroundColor:g.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:g.primaryButtonBackgroundPressed}}},splitButtonMenuButtonExpanded:{backgroundColor:g.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:g.primaryButtonBackgroundPressed}}},splitButtonMenuIcon:{color:g.primaryButtonText},splitButtonMenuIconDisabled:{color:h.neutralTertiary,selectors:(p={},p[i.b]={color:"GrayText"},p)}}}},ll2N:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n,i=r("c/eZ"),a=r("1z64"),o=r("FlW1"),s=r("HSdq"),c=r("Zy0S"),l=r("+Z9T"),u=r("JCHT"),d=r("OmYs"),p=r("IiPO"),h=r("ezfI"),g=r("kvLG"),m=function(e){function t(t,r,i,o,s,c){var l=e.call(this,t,r,i,o)||this;return l._parent=s,n=t,l._formContext=c,l._iConnectedSectionProp={sectionName:l.name,id:l.pageId},l._clientApiExecutorTabSection=new a.a(t,"ClientApi.XrmTabSection.",i,r),l.clientApiExecutor.addEventParameter({name:"controlName",value:o,isEventParam:!0}),l}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"clientApiExecutor",{get:function(){return this._clientApiExecutorTabSection},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"controls",{get:function(){var e=this;return this.clientApiExecutor.execute("controls",(function(t,r){if(!e._controls){var i=n.getState();e._controls=new c.a(t);var a=e.getControlsDescriptor(i);if(!a)return e._controls;for(var o in a){var s=e._formContext.ui.controls.get(o);if(s)e._controls.add(s.getName(),s);else{var l=r.slice();l.push({name:"controlKey",value:o}),g.a.getInstance().traceManager.getTracer(t).warn("Section control was not found in the form controls collection",l)}}}return e._controls}))},enumerable:!1,configurable:!0}),t.prototype.getParent=function(){return h.a.instance.reportUsage("ClientApi.XrmTabSection.getParent"),this._parent},t.prototype.getVisible=function(){var e="ClientApi.XrmTabSection.getVisible";try{h.a.instance.reportCall(e);var t=Object(s.tc)(n.getState(),this._iConnectedSectionProp,this.contextToken),r=Object(l.a)(t)?this._getSectionDescriptorValues().Visible:t;return h.a.instance.reportSuccess(e),r}catch(t){var i=p.a.getInstance().getEventParameters(this.contextToken);throw i.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(e,t,null,i),t}},t.prototype.getLabel=function(){var e="ClientApi.XrmTabSection.getLabel";try{h.a.instance.reportCall(e);var t=Object(s.rc)(n.getState(),this._iConnectedSectionProp,this.contextToken),r=Object(l.a)(t)?this._getSectionDescriptorValues().Label?this._getSectionDescriptorValues().Label:"":t;return h.a.instance.reportSuccess(e),r}catch(t){var i=p.a.getInstance().getEventParameters(this.contextToken);throw i.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(e,t,null,i),t}},t.prototype._getSectionDescriptorValues=function(){try{return Object(s.qc)(n.getState(),this._iConnectedSectionProp,this.contextToken)}catch(t){var e=p.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure("ClientApi.XrmTabSection._getSectionDescriptorValues",t,null,e),t}},t.prototype.getControlsDescriptor=function(e){try{return Object(s.H)(e,this._iConnectedSectionProp,this.contextToken)}catch(e){var t=p.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure("ClientApi.XrmTabSection.getControlsDescriptor",e,null,t),e}},t.prototype.setVisible=function(e){var t="ClientApi.XrmTabSection.setVisible";try{h.a.instance.reportCall(t),n.dispatch(Object(u.b)(this.pageId,this.contextToken,this.name,!0===e)),h.a.instance.reportSuccess(t)}catch(e){var r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.setLabel=function(e){var t="ClientApi.XrmTabSection.setLabel";Object(l.a)(e)&&Object(l.j)(t,"label");try{h.a.instance.reportCall(t),n.dispatch(Object(d.b)(this.pageId,this.contextToken,this.name,e)),h.a.instance.reportSuccess(t)}catch(e){var r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(t,e,null,r),e}},t}(o.a)},lwSE:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="header.tabnavigatorvisible";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r){var a=Object(n.v)(t);return{type:i,payload:r,meta:{pageId:e,contextKey:a}}}},m8A1:function(e,t,r){"use strict";r.d(t,"d",(function(){return u})),r.d(t,"c",(function(){return d})),r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return h}));var n=r("HSdq"),i=r("sOTk"),a=r("gk6Q"),o=r("kvLG"),s=r("b1hT"),c=r("QAhb"),l=r("j+yI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(e,t,r,a){if(void 0===a&&(a=!1),!e)return o.a.getInstance().traceManager.getTracer(r).error("isXrmProcessControlClientApiSupportedOnForm invoked with unexpected null state object"),!1;if(!t)return o.a.getInstance().traceManager.getTracer(r).error("isXrmProcessControlClientApiSupportedOnForm invoked with unexpected null pageId object"),!1;var u=function(e,t){var r=Object(i.g)(e,t);if(!r)return null;var n=r.entityTypeName,a=r.id;return new c.a(n,a)}(e,t),d=!Object(n.Kb)(e,t)&&(Object(s.d)(e)||!Object(s.g)(e))&&(a||!Object(l.d)(e,u,t)),p=g(t,e);return p.push({name:"xrmProcessControlClientApiIsSupported",value:d}),o.a.getInstance().eventManager.ReportComponentSuccess(r,p),d}function d(e,t,r,n){if(!e&&(o.a.getInstance().traceManager.getTracer(n).error("getProcessManagerWithJitInitIfNeeded invoked with unexpected null processManager",g(r,t.getState())),u(t.getState(),r,n))){o.a.getInstance().traceManager.getTracer(n).error("getProcessManagerWithJitInitIfNeeded invoking JIT initialization of process manager",g(r,t.getState()));var s=Object(i.g)(t.getState(),r);return Object(a.b)(r,s)}return e}function p(e,t,r,n){return[{name:"pageId",value:e},{name:"formType",value:Object(i.l)(t,e)},{name:"InitialXrmProcessControlIsNotNull",value:r},{name:"XrmEntityIsNotNull",value:n}]}function h(e,t,r){return[{name:"pageId",value:e},{name:"formType",value:Object(i.l)(t,e)},{name:"getProcessManagerInvoked",value:r}]}function g(e,t){return[{name:"pageId",value:e},{name:"formType",value:Object(i.l)(t,e)}]}},mPpC:function(e,t,r){"use strict";r.d(t,"b",(function(){return we})),r.d(t,"a",(function(){return Te}));var n,i,a,o,s,c,l,u,d,p,h,g=r("+l2M"),m=r("sOTk"),f=r("c/eZ"),b=r("YCDx"),y=r("HSdq"),v=r("x6Ak"),_=r("IiPO"),S=r("ezfI"),O=function(e){function t(t,r,i,a,o,s){var c=e.call(this,t,r,i,a,o,s)||this;return n=t,c}return Object(f.__extends)(t,e),t.prototype.refresh=function(){var e="ClientApi.XrmControlTimer.refresh";try{S.a.instance.reportCall(e),n.dispatch(Object(v.b)(this.pageId,this.contextToken,this.name)),S.a.instance.reportSuccess(e)}catch(r){var t=_.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getState=function(){var e="ClientApi.XrmControlTimer.getState";try{S.a.instance.reportCall(e);var t=Object(y.cb)(n.getState(),this.pageId,this.contextToken).controls[this.getName()].parameters.timerState;return S.a.instance.reportSuccess(e),t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlTimer.getControlType"),"timercontrol"},t}(b.a),C=r("Zz0a"),I=r("w/nD"),j=r("+Z9T"),P=r("gk6Q"),F=function(e){function t(t,r,n,a,o,s){var c=e.call(this,t,r,n,a,o,s)||this;return i=t,c.registerObserversForControlStateChange(),c}return Object(f.__extends)(t,e),t.prototype.addOnClick=function(e){var t="ClientApi.XrmControlButton.addOnClick";e||Object(j.j)(t,"handler");try{S.a.instance.reportCall(t),i.dispatch(Object(I.b)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.removeOnClick=function(e){var t="ClientApi.XrmControlButton.removeOnClick";e||Object(j.j)(t,"handler");try{S.a.instance.reportCall(t),i.dispatch(Object(I.w)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlButton.getControlType"),"button"},t.prototype.registerObserversForControlStateChange=function(){if(this.getName().startsWith("header_process")){var e=Object(P.a)(this.pageId);e&&this.controlStateObservable.registerObserver(e)}},t}(b.a),T=r("1z64"),w=r("hE7j"),E=r("EGsq"),x=r("WACO"),N=function(e){function t(t,r,n,i,o,s){var c=e.call(this,t,r,n,i,o,s)||this;a=t;var l=[{name:"controlName",value:o,isEventParam:!0}];return c._clientApiExecutorWebResource=new T.a(t,"ClientApi.XrmControlWebResource.",n,r,l),c}return Object(f.__extends)(t,e),t.prototype.getSrc=function(){var e=this;return this._clientApiExecutorWebResource.execute("getSrc",(function(){var t=a.getState(),r=Object(E.t)(t)+Object(y.wb)(t,{controlName:e.name,id:e.pageId},e.contextToken);return Object(x.c)(t,e.pageId,e.name,e.contextToken,r)}))},t.prototype.getContentWindow=function(){var e=this;return this._clientApiExecutorWebResource.executeAsync("getContentWindow",(function(t,r){var n=e.formContext.applicationContext.TraceManager.getTracer(t),i=function(){var t=Object(y.xb)(a.getState(),e.pageId,e.getName());if(t){var i=null;try{return"complete"===(i=t.contentWindow).document.readyState?Promise.resolve(i):(r.push({name:"readyState",value:i.document.readyState}),n.info("Frame content window not ready",r),Promise.reject({message:"Frame element not ready.",errorCode:111,contentWindow:i}))}catch(e){return i?(r.push({name:"Error",value:e.message}),n.warn("Error getting Frame content window readyState",r),Promise.resolve(i)):Promise.reject(e)}}else n.info("Frame DOM element not ready",r);return Promise.reject({message:"Frame element could not be found.",errorCode:111})};return i().then((function(e){return Promise.resolve(e)})).catch((function(t){if(111!==t.errorCode)return Promise.reject(t);var o=e.contextToken,s=e.pageId,c=e.getName();return new Promise((function(e,t){var l=function(){Object(I.G)(o,s,l,c),i().then((function(t){e(t)})).catch((function(i){i.contentWindow?(n.err("Frame content window readyState should be complete after OnReadyStateComplete",r),e(i.contentWindow)):t&&(111===i.errorCode?(n.err("Frame Element not found after OnReadyStateComplete",r),t(new Error("Frame element could not be found."))):t(i))}))};a.dispatch(Object(I.l)(o,s,l,c))}))}))}))},t.prototype.getObject=function(){var e=this;return this._clientApiExecutorWebResource.execute("getObject",(function(){return Object(y.xb)(a.getState(),e.pageId,e.name)}))},t.prototype.setSrc=function(e){var t=this;return this._clientApiExecutorWebResource.execute("getControlType",(function(){Object(j.a)(e)||a.dispatch(Object(w.b)(t.pageId,t.name,t.contextToken,e))}))},t.prototype.getControlType=function(){return this._clientApiExecutorWebResource.execute("getControlType",(function(){return"webresource"}))},t.prototype.addOnReadyStateComplete=function(e){var t=this;return this._clientApiExecutorWebResource.execute("addOnReadyStateComplete",(function(){a.dispatch(Object(I.l)(t.contextToken,t.pageId,e,t.getName()))}),[{name:"handler",value:e,isRequired:!0}])},t.prototype.removeOnReadyStateComplete=function(e){var t=this;return this._clientApiExecutorWebResource.execute("removeOnReadyStateComplete",(function(){a.dispatch(Object(I.G)(t.contextToken,t.pageId,e,t.getName()))}),[{name:"handler",value:e,isRequired:!0}])},t}(b.a),A=function(e){function t(t,r,n,i,a,s){var c=e.call(this,t,r,n,i,a,s)||this;return o=t,c}return Object(f.__extends)(t,e),t.prototype.getInitialUrl=function(){var e="ClientApi.XrmControlIFrame.getInitialUrl";try{S.a.instance.reportCall(e);var t=Object(y.sb)(o.getState(),{controlName:this.name,id:this.pageId},this.contextToken);return S.a.instance.reportSuccess(e),t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlIFrame.getControlType"),"iframe"},t.prototype.getSrc=function(){var e="ClientApi.XrmControlIFrame.getSrc";try{S.a.instance.reportCall(e);var t=o.getState(),r=this.getInitialUrl(),n=Object(x.c)(t,this.pageId,this.name,this.contextToken,r);return S.a.instance.reportSuccess(e),n}catch(t){var i=_.a.getInstance().getEventParameters(this.contextToken);throw i.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,i),t}},t}(N),k=r("+P1Q"),M=r("Q60c"),D=r("slAZ"),R=r("AVer"),B=r("QItn"),L=r("9r0m"),V=r("YdIa"),z=function(e){function t(t,r,n,i,a,o){var c=e.call(this,t,r,n,i,a,o)||this;return s=t,c._clientApiExecutorLookup=new T.a(t,"ClientApi.XrmControlLookup.",n,r,[{name:"controlName",value:a,isEventParam:!0}]),c}return Object(f.__extends)(t,e),t.prototype.addCustomView=function(e,t,r,n,i,a){var o=this;this._clientApiExecutorLookup.execute("addCustomView",(function(c,l){var u=L.a.tryParseOrNull(e);u||Object(j.k)(c,"guid","viewId",l),s.dispatch(Object(R.a)(o.pageId,o.name,u,t,o.contextToken,r,n,i)),a&&o.setDefaultView(e)}),[{name:"viewId",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"guid"},{name:"entityLogicalName",value:t,isRequired:!0,isEventParam:!0},{name:"viewDisplayName",value:r,isRequired:!0},{name:"fetchXml",value:n,isRequired:!0},{name:"layoutXml",value:i,isRequired:!0},{name:"isDefault",value:a,isRequired:!0}])},t.prototype.addCustomFilter=function(e,t){var r="ClientApi.XrmControlLookup.addCustomFilter";Object(j.a)(e)&&Object(j.j)(r,"fetchXmlFilter"),Object(j.b)(e)||Object(j.l)(r);try{S.a.instance.reportCall(r),s.dispatch(Object(D.d)(this.pageId,this.name,t,this.contextToken,e)),this.controlStateObservable.notifyObservers(this.controlDescriptor),S.a.instance.reportSuccess(r)}catch(e){var n=_.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(r,e,null,n),e}},Object.defineProperty(t.prototype,"disableMru",{get:function(){var e="ClientApi.XrmControlLookup.getDisableMru";try{S.a.instance.reportCall(e);var t=Object(y.x)(s.getState(),{id:this.pageId,controlName:this.name},this.contextToken);return S.a.instance.reportSuccess(e),t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}},set:function(e){var t="ClientApi.XrmControlLookup.setDisableMru";try{S.a.instance.reportCall(t),s.dispatch(Object(B.b)(s.getState(),this.pageId,this.name,this.contextToken,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},enumerable:!1,configurable:!0}),t.prototype.startCustomFilter=function(){var e="ClientApi.XrmControlLookup.startCustomFilter";try{S.a.instance.reportCall(e),s.dispatch(Object(D.f)(this.pageId,this.name,this.contextToken)),this.controlStateObservable.notifyObservers(this.controlDescriptor),S.a.instance.reportSuccess(e)}catch(r){var t=_.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.endCustomFilter=function(){var e="ClientApi.XrmControlLookup.endCustomFilter";try{S.a.instance.reportCall(e),s.dispatch(Object(D.e)(this.pageId,this.name,this.contextToken)),this.controlStateObservable.notifyObservers(this.controlDescriptor),S.a.instance.reportSuccess(e)}catch(r){var t=_.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getDefaultView=function(){var e=this;return this._clientApiExecutorLookup.execute("getDefaultView",(function(){var t=Object(y.O)(s.getState(),e.pageId,e.name,e.contextToken);return t?L.a.externalGuid(new L.a(t)):null}))},t.prototype.setDefaultView=function(e){var t=this;this._clientApiExecutorLookup.execute("setDefaultView",(function(r,n){var i=L.a.tryParseOrNull(e);i||Object(j.k)(r,"guid","id",n),s.dispatch(Object(M.b)(t.pageId,t.name,t.contextToken,i))}),[{name:"defaultViewId",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"guid"}])},t.prototype.addOnLookupTagClick=function(e){var t="ClientApi.XrmControlLookup.addOnLookupTagClick";e||Object(j.j)(t,"handler");try{S.a.instance.reportCall(t),s.dispatch(Object(I.g)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.addPreSearch=function(e){var t="ClientApi.XrmControlLookup.addPreSearch";e||Object(j.j)(t,"handler");try{S.a.instance.reportCall(t),s.dispatch(Object(I.t)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.removeOnLookupTagClick=function(e){var t="ClientApi.XrmControlLookup.removeOnLookupTagClick";e||Object(j.j)(t,"handler");try{S.a.instance.reportCall(t),s.dispatch(Object(I.B)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.removePreSearch=function(e){var t="ClientApi.XrmControlLookup.removePreSearch";e||Object(j.j)(t,"handler");try{S.a.instance.reportCall(t),s.dispatch(Object(I.O)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlLookup.getControlType"),"lookup"},t.prototype.getEntityTypes=function(){var e="ClientApi.XrmControlLookup.getEntityTypes";try{S.a.instance.reportCall(e);var t=Object(y.Ob)(s.getState(),this.pageId,this.contextToken,this._dataFieldName);return S.a.instance.reportSuccess(e),t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.setEntityTypes=function(e){var t="ClientApi.XrmControlLookup.setEntityTypes";e||Object(j.j)(t,"entityTypes");var r=[];try{S.a.instance.reportCall(t),e=Array.from(new Set(e));var n=Object(y.Pb)(s.getState(),this.pageId,this.contextToken,this._dataFieldName),i={};n.forEach((function(e){i[e]=!0})),e.forEach((function(e){i[e]||r.push(e)}))}catch(e){throw(a=_.a.getInstance().getEventParameters(this.contextToken)).push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t+".validation",e,null,a),e}r.length>0&&Object(j.h)(t,"entityType",r[0]);try{s.dispatch(Object(V.b)(this.pageId,this.contextToken,this._dataFieldName,e)),S.a.instance.reportSuccess(t)}catch(e){var a;throw(a=_.a.getInstance().getEventParameters(this.contextToken)).push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,a),e}},Object.defineProperty(t.prototype,"_dataFieldName",{get:function(){return this.controlDescriptor&&this.controlDescriptor.DataFieldName?this.controlDescriptor.DataFieldName:this.name},enumerable:!1,configurable:!0}),t}(k.a),G=r("JFej"),W=r("Ini7"),H=r("FGem"),U=function(e){function t(t,r,n,i,a,o){var s=e.call(this,t,r,n,i,a,o)||this;c=t;var l=[{name:"controlName",value:a,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];return s._clientApiExecutorOptionsetBase=new T.a(t,"ClientApi.XrmControlOptionSetBase.",n,r,l),s}return Object(f.__extends)(t,e),t.prototype.addOption=function(e,t){var r=this;this._clientApiExecutorOptionsetBase.execute("addOption",(function(){var n=r._options.length;Object(j.a)(t)||isNaN(t)||t>=n?t=n:t<=0?t=0:t-=1,c.dispatch(Object(G.b)(r.pageId,r.contextToken,r.controlDescriptor.DataFieldName,{Color:null,Label:e.text,Value:e.value},t))}),[{name:"optionSetItem",value:e,isRequired:!0},{name:"optionSetItem.value",value:null==e?void 0:e.value,isRequired:!0,expectedDataType:"number"}])},t.prototype.clearOptions=function(){var e=this;this._clientApiExecutorOptionsetBase.execute("clearOptions",(function(){c.dispatch(Object(H.b)(e.pageId,e.contextToken,e.controlDescriptor.DataFieldName))}))},t.prototype.removeOption=function(e){var t=this;return this._clientApiExecutorOptionsetBase.execute("removeOption",(function(){c.dispatch(Object(W.b)(t.pageId,t.contextToken,t.controlDescriptor.DataFieldName,e))}),[{name:"value",value:e,isRequired:!0}])},t.prototype.getOptions=function(){var e=this;return this._clientApiExecutorOptionsetBase.execute("getOptions",(function(){return e._options}))},Object.defineProperty(t.prototype,"_options",{get:function(){var e=new Array,t=Object(y.B)(c.getState(),this.pageId,this.contextToken,this.name);if(t)for(var r in t.length&&e.push({text:"",value:NaN}),t)e.push({text:t[r].Label,value:t[r].Value});return e},enumerable:!1,configurable:!0}),t}(k.a),q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(f.__extends)(t,e),t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlOptionSet.getControlType"),"optionset"},t}(U),X=r("ABRM"),K=function(e){function t(t,r,n,i,a,o){var s=e.call(this,t,r,n,i,a,o)||this;return s._isDateFormatDateTime=!1,l=t,s._clientApiExecutorDateTime=new T.a(t,"ClientApi.XrmControlDateTime.",n,r,[{name:"controlName",value:a,isEventParam:!0}]),s._clientApiExecutorDateTime.execute("constructor",(function(e,t){s._isDateFormatDateTime=s._getShowTime(e,t)}),null,!1),s}return Object(f.__extends)(t,e),t.prototype.getShowTime=function(){var e=this;return this._clientApiExecutorDateTime.execute("getShowTime",(function(t,r){return e._getShowTime(t,r)}))},t.prototype.setShowTime=function(e){var t=this;this._clientApiExecutorDateTime.execute("setShowTime",(function(r,n){if(t._getShowTime(r,n)!==e){var i=e&&t._isDateFormatDateTime?"datetime":"date";l.dispatch(Object(X.b)(t.pageId,t.contextToken,t.name,i))}}))},t.prototype._getShowTime=function(e,t){var r=this.getAttrDescriptor(e,t,this._clientApiExecutorDateTime);return!r||"datetime"===r.Format},t}(k.a),Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(f.__extends)(t,e),t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlMultiSelectOptionSet.getControlType"),"multiselectoptionset"},t}(U),Y=r("455M"),Z=r("Dlr/"),J=r("Sscr"),$=r("7bez"),ee=r("h82J"),te=r("Gemh"),re=function(e){function t(t,r,n,i,a){var o=e.call(this,t,r,n,i,i.Name,a)||this,s=Object(J.e)(r,i.Name);return t.dispatch(Object(ee.a)(o,n,s)),u=t,o._clientApiExecutorControlstream=new T.a(t,"ClientApi.XrmControlStream.",n,r),o}return Object(f.__extends)(t,e),Object.defineProperty(t.prototype,"clientApiExecutor",{get:function(){return this._clientApiExecutorControlstream},enumerable:!1,configurable:!0}),t.prototype._getGridControls=function(){if(!this._underlyingGridControls){this._underlyingGridControls=[];var e=this.controlDescriptor.Parameters&&this.controlDescriptor.Parameters[0]&&this.controlDescriptor.Parameters[0].StreamObjects;if(e){var t=e.StreamObjectCollection;if(t)for(var r=t.ShowAsTiles?[!0,!1]:[!0],n=0,i=t;n<i.length;n++)for(var a=i[n],o=0,s=r;o<s.length;o++){var c=s[o],l=Object(J.o)(this.contextToken,this.getName(),a.Id,c),d=new $.a(u,l,this.pageId,!1,3,!0,this.formContext.applicationContext,l.controlName);this._underlyingGridControls.push({contextToken:l,gridControl:d})}}}return this._underlyingGridControls},t.prototype.refresh=function(){var e=this;this.clientApiExecutor.execute("refresh",(function(){for(var t=[],r=0,n=e._getGridControls();r<n.length;r++){var i=n[r],a=i.contextToken,o=i.gridControl;if(Object(te.hb)(u.getState(),e.pageId,a,a.controlName))try{o.refresh()}catch(e){t.push(e)}}if(t.length>0){var s=Object(f.__spreadArrays)(_.a.getInstance().getEventParameters(e.contextToken),[{name:"count",value:t.length}]);Object(j.e)(e.clientApiExecutor.getComponentName("refresh"),"Some grids in stream failed to refresh",null,s)}}))},t}(b.a),ne=r("QAhb"),ie=r("TV33"),ae=r("Y+r4"),oe=r("ks02"),se=r("uQP8"),ce=r("6JRL"),le=r("kvLG"),ue=function(e){function t(t,r,n,i,a,o){var s=e.call(this,t,r,n,i,i.Name,a)||this;return d=t,s._clientApiExecutor=new T.a(t,"ClientApi.XrmControlSubFormBase.",n,r,[{name:"controlName",value:null==i?void 0:i.Name,isEventParam:!0}]),s._xrmControlFactory=o,s}return Object(f.__extends)(t,e),t.prototype.getParentComponent=function(){return Object(se.a)(d.getState(),this.pageId)},Object.defineProperty(t.prototype,"context",{get:function(){var e=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.context",(function(){return e._form?e._form.context:null}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_parentFormContext",{get:function(){return this.formContext},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_form",{get:function(){if(this._tryGetSubFormInstanceId(),!this._isSubFormMetadataLoaded())throw Object(ce.d)("SUBFORM_METADATA_NOT_LOADED",2415919107);var e=this._subFormControlContextToken;if(e&&this._formInstance)return this._formInstance;var t=this._getValueInternal(),r=Object(ie.d)(t);return e?(this._formInstance=d.dispatch(Object(ee.b)(this._subFormInstanceId,e)),this._formInstance||r&&r.length>0&&(this._formInstance=d.dispatch(this._createXrmForm(e,this._subFormInstanceId,r[0].entityType,new L.a(r[0].id)))),this._formInstance&&!this._formInstance.context&&(this._formInstance.context=this._parentFormContext.context),this._formInstance):(_.a.getInstance().getEventParameters(this.contextToken).push({name:"controlName",value:this.getName()}),le.a.getInstance().traceManager.getTracer("ClientApi.XrmControlSubFormBase._form").info("XrmControlSubForm._form is null"),null)},enumerable:!1,configurable:!0}),t.prototype._createXrmForm=function(e,t,r,n){var i=this._xrmControlFactory;return{type:"clientapi.create.xrmform",sync:!0,execute:function(a,o){var s=new ae.a(a,{etn:r,id:n},i,e,t);s.applicationContext=o;var c=new oe.a(a,t);return s.context=c,s}}},Object.defineProperty(t.prototype,"_subFormControlContextToken",{get:function(){var e=this._getValueInternal(),t=Object(ie.d)(e);return t&&t[0]&&t[0].id?this._entityRecordId!==t[0].id&&(this._entityType=t[0].entityType,this._entityRecordId=t[0].id,this._subFormContextToken&&d.dispatch(Object(ee.h)(this._subFormInstanceId,this._subFormContextToken)),this._subFormContextToken=this._getSubFormContextToken(this.contextToken,this.name,this._entityType),this._formInstance=null):this._subFormContextToken&&(d.dispatch(Object(ee.h)(this._subFormInstanceId,this._subFormContextToken)),this._subFormContextToken=void 0,this._entityType=void 0,this._entityRecordId=void 0,this._formInstance=null),this._subFormContextToken},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){var e=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.data",(function(){return e._form?e._form.data:null}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ui",{get:function(){var e=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.ui",(function(){return e._form?e._form.ui:null}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entityReference",{get:function(){return S.a.instance.reportUsage("ClientApi.XrmControlSubFormBase.entityReference"),null},enumerable:!1,configurable:!0}),t.prototype.getControl=function(e){var t=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getControl",(function(){return t._form?t._form.getControl(e):null}))},t.prototype.getAttribute=function(e){var t=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getAttribute",(function(){return t._form?t._form.getAttribute(e):null}))},t.prototype.getUrl=function(){var e=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getUrl",(function(){return e._form?e._form.getUrl():null}))},t.prototype.refresh=function(){var e=this;this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.refresh",(function(){e.data&&e.data.refresh()}))},t.prototype._getValueInternal=function(){var e=this._parentFormContext.data.entity.getEntityName(),t=this._parentFormContext.data.entity.getId(),r=t?new ne.a(e,new L.a(t)):new ne.a(e),n=Object(y.ac)(d.getState(),this._subFormInstanceId,this.contextToken);return Object(y.X)(d.getState(),this._subFormInstanceId,this._subFormContextToken,n,r,this.controlDescriptor.DataFieldName)},t}(b.a),de=function(e){function t(t,r,n,i,a,o){var s=e.call(this,t,r,n,i,a,o)||this;return p=t,s}return Object(f.__extends)(t,e),t.prototype._getSubFormContextToken=function(e,t,r){return Object(J.l)(this.contextToken,this.name,this._entityType)},t.prototype.getSubFormInstanceId=function(){return this.pageId},t.prototype._isSubFormMetadataLoaded=function(){return!!this._subFormInstanceId},t.prototype._tryGetSubFormInstanceId=function(){},Object.defineProperty(t.prototype,"_subFormInstanceId",{get:function(){return this.pageId},enumerable:!1,configurable:!0}),t.prototype.isLoaded=function(){var e="ClientApi.XrmControlQuickForm.isLoaded";try{S.a.instance.reportCall(e);var t=Object(y.ic)(p.getState(),this.getSubFormInstanceId(),this._subFormControlContextToken);return S.a.instance.reportSuccess(e),!!t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlQuickForm.getControlType"),"quickform"},t}(ue),pe=function(e){function t(t,r,n,i,a,o){var s;return t||Object(j.j)("ClientApi.XrmStandardDataControl.constructor","store"),s=e.call(this,t,r,n,i,a,o)||this,h=t,s}return Object(f.__extends)(t,e),t.prototype.getValue=function(){var e="ClientApi.XrmStandardDataControl.getValue";try{S.a.instance.reportCall(e);var t=Object(y.F)(h.getState(),{controlName:this.name,id:this.pageId},this.contextToken);return S.a.instance.reportSuccess(e),t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),_.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.addOnKeyPress=function(e){var t="ClientApi.XrmStandardDataControl.addOnKeyPress";e||Object(j.j)(t,"handler");try{S.a.instance.reportCall(t),h.dispatch(Object(I.e)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.removeOnKeyPress=function(e){var t="ClientApi.XrmStandardDataControl.removeOnKeyPress";e||Object(j.j)(t,"handler");try{S.a.instance.reportCall(t),h.dispatch(Object(I.z)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.fireOnKeyPress=function(){var e="ClientApi.XrmStandardDataControl.fireOnKeyPress";try{S.a.instance.reportCall(e),h.dispatch(Object(I.R)(this.contextToken,this.pageId,this.name,this)),S.a.instance.reportSuccess(e)}catch(r){var t=_.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),_.a.getInstance().reportFailure(e,r,null,t),r}},t}(k.a),he=r("1PXy"),ge=r("lRv2"),me=r("QUnS"),fe=function(e){function t(t,r,n,i,a,o){var s=e.call(this,t,r,n,i,a,o)||this;return s._clientApiExecutorDependentOptionSet=new T.a(t,"ClientApi.XrmControlDependentOptionSet.",n,r,[{name:"controlName",value:a,isEventParam:!0}]),s}return Object(f.__extends)(t,e),t.prototype.addOption=function(e,t){return this._clientApiExecutorDependentOptionSet.execute("addOption",(function(e,t){Object(j.i)(e,"DependentOptionSet.addOption",t)}))},t.prototype.clearOptions=function(){return this._clientApiExecutorDependentOptionSet.execute("clearOptions",(function(e,t){Object(j.i)(e,"DependentOptionSet.clearOptions",t)}))},t.prototype.removeOption=function(e){return this._clientApiExecutorDependentOptionSet.execute("removeOption",(function(e,t){Object(j.i)(e,"DependentOptionSet.removeOption",t)}))},t.prototype.setDisabled=function(e){return this._clientApiExecutorDependentOptionSet.execute("setDisabled",(function(e,t){Object(j.i)(e,"DependentOptionSet.setDisabled",t)}))},t.prototype.setVisible=function(e){return this._clientApiExecutorDependentOptionSet.execute("setVisible",(function(e,t){Object(j.i)(e,"DependentOptionSet.setVisible",t)}))},t}(q),be=function(e){function t(t,r,n,i,a,o){var s=e.call(this,t,r,n,i,a,o)||this;return s._clientApiExecutorDependentOptionSet=new T.a(t,"ClientApi.XrmControlMultiSelectDependentOptionSet.",n,r,[{name:"controlName",value:a,isEventParam:!0}]),s}return Object(f.__extends)(t,e),t.prototype.addOption=function(e,t){return this._clientApiExecutorDependentOptionSet.execute("addOption",(function(e,t){Object(j.i)(e,"MultiSelectDependentOptionSet.addOption",t)}))},t.prototype.clearOptions=function(){return this._clientApiExecutorDependentOptionSet.execute("clearOptions",(function(e,t){Object(j.i)(e,"MultiSelectDependentOptionSet.clearOptions",t)}))},t.prototype.removeOption=function(e){return this._clientApiExecutorDependentOptionSet.execute("removeOption",(function(e,t){Object(j.i)(e,"MultiSelectDependentOptionSet.removeOption",t)}))},t.prototype.setDisabled=function(e){return this._clientApiExecutorDependentOptionSet.execute("setDisabled",(function(e,t){Object(j.i)(e,"MultiSelectDependentOptionSet.setDisabled",t)}))},t.prototype.setVisible=function(e){return this._clientApiExecutorDependentOptionSet.execute("setVisible",(function(e,t){Object(j.i)(e,"MultiSelectDependentOptionSet.setVisible",t)}))},t}(Q),ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(f.__extends)(t,e),t.prototype.setDisabled=function(e){var t="ClientApi.XrmDependentOptionSetGridControl.setDisabled";S.a.instance.reportUsage(t),Object(j.e)(t,String.format("Can not execute {0} for dependent option set control","setDisabled"))},t}(pe),ve=r("F2uj"),_e=r("cZkS"),Se=r("qC0c"),Oe=r("2OIc"),Ce=r("tNVD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var Ie,je,Pe=function(e){function t(t,r,n,i,a,o){var s,c,l=e.call(this,t,r,n,i,a,o)||this;return l._formInstanceId=null===(c=null===(s=l.getParentComponent())||void 0===s?void 0:s.formInstances)||void 0===c?void 0:c.formInstanceIdByControlName[l.controlDescriptor.Name],l._formComponentClientApiExecutor=new T.a(t,"ClientApi.XrmControlFormComponent.",l._formInstanceId),l._formComponentClientApiExecutor.addEventParameter({name:"controlName",value:i.Name,isEventParam:!0}),Ie=t,l}return Object(f.__extends)(t,e),t.prototype._tryGetSubFormInstanceId=function(){var e,t;this._formInstanceId||(this._formInstanceId=null===(t=null===(e=this.getParentComponent())||void 0===e?void 0:e.formInstances)||void 0===t?void 0:t.formInstanceIdByControlName[this.controlDescriptor.Name])},t.prototype._isSubFormMetadataLoaded=function(){return!!this._subFormInstanceId},t.prototype._getSubFormContextToken=function(e,t,r){return Object(J.h)(r)},Object.defineProperty(t.prototype,"_subFormInstanceId",{get:function(){return this._formInstanceId},enumerable:!1,configurable:!0}),t.prototype.isLoaded=function(){var e=this;return this._isSubFormMetadataLoaded()&&this._formComponentClientApiExecutor.execute("ClientApi.XrmControlFormComponent.isLoaded",(function(){return!!Object(y.yc)(Ie.getState(),e._subFormInstanceId,e._subFormControlContextToken)}))},t.prototype.setInitializationIntent=function(e){var t=this;void 0===e&&(e="fullload"),this._formComponentClientApiExecutor.execute("setInitializationIntent",(function(r){
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n,i,a,o,s;"nothing"!==e&&"fullload"!==e&&Object(j.h)(r,e,"intent"),Ie.dispatch((n=t.pageId,i=t.name,a=t.contextToken,o=e,s=Object(J.v)(a),{type:Ce.d,payload:o,meta:{pageId:n,controlName:i,contextKey:s}}))}),[{name:"intent",value:e,isEventParam:!0,expectedDataType:"string"}])},t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlFormComponent.getControlType"),"formcomponent"},t}(ue),Fe=r("HHlV"),Te="3d180de6-b456-4d90-9d5a-9899936baf44",we=function(){function e(e,t){this._pageId=t,je=e}return e.prototype.createXrmControl=function(e,t,r,n,i){Object(j.g)(t,n,"control");try{i.push({name:"controlClassId",value:t&&t.ClassId?t.ClassId.guid:""}),i.push({name:"controlName",value:t?t.Name:""}),i.push({name:"controlDataFieldName",value:t?t.DataFieldName:""}),i.push({name:"pageId",value:this._pageId});var a=Object(m.l)(je.getState(),this._pageId);i.push({name:"pageType",value:a});var o=!1,s=null,c=this._getControlType(t,r,e,n,i);switch(c){case g.i.guid:s=new F(je,e,this._pageId,t,t.Name,r);break;case Y.a.KbContent:case Y.a.KbArticle:case g.C.guid:case g.I.guid:s=new A(je,e,this._pageId,t,t.Name,r);break;case Y.a.LookupRegarding:case Y.a.LookupCustomer:case Y.a.LookupMultiEntity:case Y.a.LookupOwner:case Y.a.LookupSimple:case Y.a.LookupPartyList:case g.M.guid:case g.fb.guid:case g.S.guid:case g.l.guid:if(Object(Se.c)(je.getState(),_e.jb)){var l=Object(se.b)(je.getState(),this._pageId,e);if(Object(Oe.c)(je.getState(),t.UniqueId,l)===Fe.d){s=new Pe(je,e,this._pageId,t,r,this);break}}s=new z(je,e,this._pageId,t,t.Name,r);break;case Y.a.OptionSet:case g.U.guid:if(1==Object(Se.c)(je.getState(),_e.L)){var u=this._getEntityNameForControl(t,r);if(Object(ve.l)(je.getState(),u,t.DataFieldName)){s=new fe(je,e,this._pageId,t,t.Name,r);break}}case Y.a.EntityNameOptionSet:case Y.a.TwoOptions:case Y.a.StatusOptionSet:case g.sb.guid:case g.K.guid:case g.W.guid:case g.V.guid:case g.hb.guid:case g.n.guid:case g.N.guid:s=new q(je,e,this._pageId,t,t.Name,r);break;case Y.a.MultiSelectPicklist:case g.Q.guid:if(Object(Se.c)(je.getState(),_e.L)){u=this._getEntityNameForControl(t,r);if(Object(ve.l)(je.getState(),u,t.DataFieldName)){s=new be(je,e,this._pageId,t,t.Name,r);break}}s=new Q(je,e,this._pageId,t,t.Name,r);break;case Y.a.QuickForm:case g.cb.guid:case g.ab.guid:case g.Z.guid:var d=new de(je,e,this._pageId,t,r,this);r.ui.quickForms.add(t.Name,d);break;case Y.a.SearchWidget:case Y.a.ReferencePanelSearchWidget:case g.db.guid:case g.kb.guid:s=new C.a(je,e,this._pageId,t,t.Name,r);break;case Y.a.TimelineWall:case g.qb.guid:(s=je.dispatch(Object(ee.f)(this._pageId,Object(J.p)(e,t.Name))))||(s=new he.a(je,e,this._pageId,t,t.Name,t.LabelId,r,r.applicationContext));break;case Y.a.DateAndTimeDateOnly:case Y.a.DateAndTimeDateAndTime:case g.q.guid:s=new K(je,e,this._pageId,t,t.Name,r);break;case Y.a.Grid:case g.eb.guid:case g.E.guid:var p=Object(J.p)(e,t.Name),h=je.dispatch(Object(ee.c)(this._pageId,p));h&&(h.getName||3!==h.getGridType()?s=h:(_.a.getInstance().reportFailure(n,new Error("Main grid found in cache - converting to a subgrid."),null,i),je.dispatch(Object(ee.h)(this._pageId,p)))),s||(s=new Z.a(je,e,this._pageId,t.Name,Object(te.wb)(je.getState(),this._pageId,e,t.Name),r,t,r.applicationContext));break;case Y.a.Timer:case g.rb.guid:s=new O(je,e,this._pageId,t,t.Name,r);break;case Y.a.WebResourceHtmlControl:case g.ub.guid:case g.vb.guid:s=new N(je,e,this._pageId,t,t.Name,r);break;case g.mb.guid:s=new re(je,e,this._pageId,t,r);break;case g.z.guid:case g.G.guid:break;case Te:if(Object(Se.c)(je.getState(),_e.L)&&Object(ve.l)(je.getState(),e.entityTypeName,t.Name)){s=new ye(je,e,this._pageId,t,t.Name,r);break}case Y.a.AppliedFilters:case Y.a.BusinessProcessFlow:case Y.a.Card:case Y.a.Currency:case Y.a.Dashboard:case Y.a.Decimal:case Y.a.EmailEngagementActions:case Y.a.EmailEngagementRecipientActivity:case Y.a.FP:case Y.a.GlobalFilter:case Y.a.MicrosoftFlow:case Y.a.Multiple:case Y.a.PowerBI:case Y.a.ReferencePanel:case Y.a.Search:case Y.a.SingleLineAddress:case Y.a.SingleLineEmail:case Y.a.SingleLinePhone:case Y.a.SingleLineText:case Y.a.SingleLineTextArea:case Y.a.SingleLineTickerSymbol:case Y.a.SingleLineURL:case Y.a.SocialInsightsControl:case Y.a.WholeDuration:case Y.a.WholeLanguage:case Y.a.WholeNone:case Y.a.WholeTimeZone:case g.a.guid:case g.b.guid:case g.c.guid:case g.d.guid:case g.e.guid:case g.f.guid:case g.g.guid:case g.h.guid:case g.j.guid:case g.k.guid:case g.m.guid:case g.p.guid:case g.r.guid:case g.s.guid:case g.t.guid:case g.u.guid:case g.v.guid:case g.w.guid:case g.x.guid:case g.y.guid:case g.A.guid:case g.B.guid:case g.D.guid:case g.H.guid:case g.J.guid:case g.L.guid:case g.O.guid:case g.P.guid:case g.R.guid:case g.T.guid:case g.X.guid:case g.Y.guid:case g.bb.guid:case g.gb.guid:case g.ib.guid:case g.jb.guid:case g.lb.guid:case g.mb.guid:case g.nb.guid:case g.ob.guid:case g.pb.guid:case g.tb.guid:case g.wb.guid:o=!0;default:s=t.DataFieldName?new pe(je,e,this._pageId,t,t.Name,r):new b.a(je,e,this._pageId,t,t.Name,r),o||(i.push({name:"controlType",value:c}),le.a.getInstance().traceManager.getTracer(n).error("Unknown Form Control",i))}return s}catch(e){return _.a.getInstance().reportFailure(n+".createXrmControl",e,null,i),null}},e.prototype._getControlType=function(e,t,r,n,i){if(L.a.equals(e.ClassId,g.o)){var a=this._getCustomControlType(e,t,r);return a||le.a.getInstance().traceManager.getTracer(n+".controlPrimaryType").error("Control primary type could not be determined",i),i.push({name:"manifestControlType",value:a}),a}return e.ClassId.guid},e.prototype._getCustomControlType=function(e,t,r){var n,i,a,o=Object(se.b)(je.getState(),this._pageId,r),s=Object(ge.c)(je.getState(),e,o);if(!s){var c=Object(y.h)(),l=(null===(i=null===(n=t.data)||void 0===n?void 0:n.entity)||void 0===i?void 0:i.getEntityName())||"",u=c(je.getState(),e,this._pageId,o,l);if(u||(u=Object(me.a)(je.getState(),e,this._pageId,r)),null==u?void 0:u.Parameters)for(var d in u.Parameters)if(null===(a=u.Parameters[d])||void 0===a?void 0:a.Primary){s=u.Parameters[d].Type;break}}return s},e.prototype._getEntityNameForControl=function(e,t){var r="";if(e.Relationship)r=Object(y.T)(je.getState(),this._pageId,e.Relationship);else{var n=t.getAttribute(e.DataFieldName);n&&n.getParent()&&(r=n.getParent().getEntityName())}return r},e}()},mVnn:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("HSdq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t){var r=Object(n.Zb)(e,t);return r&&r.output?r.output.value:null}},mccX:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r("/eNh"),i=r("QAhb"),a=r("9r0m"),o=r("Eoze"),s=r("+D0h"),c=r("TCzx"),l=r("Srej"),u=r("lMVv");function d(e,t,r,d,p,h,g){return{type:"form.openuploadentityimagedialog.async",execute:function(m){var f=m.dispatch,b=m.getState,y=Object(u.h)(b(),t),v={entityimageurl_id:e,entitylogicalname_id:t,entity_id:r,entityprimaryattribute_id:d,cameraenabled_id:p,formattedPrimaryImage_Attribute:y&&y.PrimaryImageAttribute?y.PrimaryImageAttribute:"entityimage"},_=c.a.getInstance().get_IsMobilePhone()?"35rem":"27rem";return f(Object(n.b)("EntityImageUpload",{height:_,width:"30rem"},v,g)).then((function(e){return 0===e.status?f(Object(s.a)(e.pageId)).then((function(e){return e})):Promise.reject(e.error)})).then((function(e){if(r&&t){var n=new i.a(t,a.a.tryParse(r)),s=Object(l.a)(null,b(),t),c=h&&s?[s]:null;f(Object(o.c)(n,c))}}))}}}},"n+eO":function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n=r("r0tX"),i=r("9r0m"),a=r("WS0f"),o=r("9rlF"),s=r("nbQV"),c=r("TCcM"),l=r("T576"),u=r("QAhb"),d=r("A/RO"),p=r("Kdvm"),h=r("4HtA"),g=r("r3Bs"),m=r("LdMy"),f=r("sOTk"),b=r("mLFd"),y=r("G7N+"),v=r("ed60"),_=r("uwKl"),S=r("DUDQ"),O=r("lFQy"),C=r("gk6Q"),I=r("HSdq"),j=r("pflg"),P=r("b1hT"),F=r("lMVv"),T=r("2ojE"),w=r("LhJP"),E=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return e._instance||(e._instance=new e,Object(C.c)(e._instance)),e._instance},enumerable:!1,configurable:!0}),e.prototype.init=function(e,t,n){var i=this;return this._getState&&this._businessProcessPerPageWrapper?Promise.resolve():(this._applicationContext=e,this._reloadDataCount=0,this._getState=t,this._dispatch=n,this._processManager=new h.a(e,t,n,new m.a,new g.a),this._businessProcessFlowWrapperIdentifierFactory=new p.a,this._businessProcessFlowWrapperFactory=new d.a(t,this._businessProcessFlowWrapperIdentifierFactory,e),r.e(49).then(r.bind(null,"pG8E")).then((function(e){var t=e.BusinessProcessPageWrapper;return i._businessProcessPerPageWrapper=new t(i._applicationContext,i._getState,i._dispatch),Promise.resolve()})))},e.prototype.getBusinessProcessFlowWrapper=function(e,t){return Object(P.f)(this._getState())?this._businessProcessPerPageWrapper.getBusinessProcessFlowWrapper(e,t):(this._reloadDataIfRequired(e,t),this._businessProcessFlowWrapperFactory.generate(e,this._processManager))},e.prototype.getProcessManager=function(e,t){return Object(P.f)(this._getState())?this._businessProcessPerPageWrapper.getProcessManager(e,t):(this._reloadDataIfRequired(e,t),this._processManager)},e.prototype.getCurrentProcessManagerWithoutInit=function(e){if(!Object(P.f)(this._getState()))return this._processManager;if(this._businessProcessPerPageWrapper)return this._businessProcessPerPageWrapper.getCurrentProcessManagerWithoutInit(e);var t=Object(f.g)(this._getState(),e),r=t&&t.entityTypeName?new u.a(t.entityTypeName,t.id):null,n=this._applicationContext.TraceManager.getTracer("BusinessProcessWrapperManager.GetProcessManagerWithoutinit"),i=Object(T.a)(this._getState(),r,e,this._applicationContext);return n.warn("BusinessProcessWrapperManager: BusinessProcessPerPageWrapper is not initialized",i),null},e.prototype.hasChanged=function(e,t,r,n){if(!Object(P.f)(this._getState())){if(Object(P.g)(e)&&(!Object(P.d)(e)||Object(P.c)(e,n)))return!0;if(!t)return!1;var i=new u.a(t.entityTypeName,t.id),o=Object(l.f)(e,i);return!Object(a.a)(o)&&(!r||o>r.instanceModifiedTimestamp)||this._needsDockedModeRefresh(r,t)}return this._businessProcessPerPageWrapper.hasChanged(e,t,r,n)},e.prototype._needsDockedModeRefresh=function(e,t){return this._processManager.getDisplayState()===n.a.expanded&&e.isFormInactive!==Object(I.Lb)(this._getState(),t.entityTypeName,t.id)},e.prototype._reloadData=function(e,t){var r=this,n=this._getState();this._pageId=e,this._pageInfo=t;var d=Object(f.g)(n,e);if(d){var p=d.id,h=new u.a(d.entityTypeName,p);if(this._processIdInState=Object(c.e)(n,h),Object(P.g)(n)&&(!Object(P.d)(n)||Object(P.c)(n,e))){var g=this._processManager.getTelemetryParams();return this._processManager.isVisible()&&this._processManager.setVisible(!1),this._processManager.initilaizeWithFormEntityOnly(h,e),void Object(T.c)(w.e,g,this._applicationContext)}var m=Object(j.a)(d),b=Object(j.b)(d);if(i.a.equals(h.id,i.a.EMPTY)&&m&&b){var C=Object(s.b)(n,m),I=new u.a(C.businessProcessFlowUniqueName,b),E=Object(l.b)(n,I);return Object(a.a)(this._lastPageEntityFromCrossEntity)||Object(a.a)(h)||this._lastPageEntityFromCrossEntity.etn===h.etn||this._moveToNextStageForCrossEntityBPF(E,d),void this._processManager.initilaizeWithProcessAndFormEntity(E,C,h,m,I,e)}if(this._processIdInState){C=Object(s.b)(n,this._processIdInState);if(!Object(a.a)(C)&&Object(y.b)(C.initialized)){I=new u.a(C.businessProcessFlowUniqueName,Object(c.f)(n,h)),E=Object(l.b)(n,I);if(i.a.equals(h.id,i.a.EMPTY)){var x=Object(P.b)(C);if(this._lastPageIdInNewForm!==e&&(this._lastPageIdInNewForm=e,this._dispatch(Object(O.a)(null,I))),x&&x.stage&&x.stage.stageId){var N=Object(P.a)(x);return this._dispatch(Object(S.b)(I,N)),void this._processManager.initilaizeWithProcessAndFormEntity(N.fields,C,h,this._processIdInState,I,e)}}else if(Object(a.a)(E))return;var A=Object(F.h)(n,h.etn);if(A&&A.IsBPFEntity)return void this._processManager.initilaizeWithProcessAndFormEntity(E,C,h,this._processIdInState,I,e);for(var k in E)if(Object(o.k)(E[k])&&E[k].reference&&E[k].reference.id&&E[k].reference.etn===h.etn&&(i.a.equals(E[k].reference.id,h.id)||i.a.equals(E[k].reference.id,i.a.EMPTY))&&Object(P.e)(k))return void this._processManager.initilaizeWithProcessAndFormEntity(E,C,h,this._processIdInState,I,e);var M=this._dispatch(Object(v.b)(i.a.EMPTY,h)),D=this._dispatch(Object(_.b)(i.a.EMPTY,h));Promise.all([M,D]).then((function(t){r._processManager.initilaizeWithFormEntityOnly(h,e)}))}else this._processManager.initilaizeWithFormEntityOnly(h,e)}else this._processManager.initilaizeWithFormEntityOnly(h,e)}},e.prototype._reloadDataIfRequired=function(e,t){var r=this._getState(),n=this._processManager.getCurrentFormEntity();this._lastPageEntityFromCrossEntity=n;var a=null,o=!1;if(n&&(a=Object(c.b)(n)(r,n.etn))&&(o=a.refreshGlobalNavigationData),!Object(P.g)(r)&&(!this._pageInfo||!i.a.equals(this._pageInfo.id,t.id)||this._pageId!==e||this._hasProcessChanged(t)||o)||Object(P.g)(r)&&this._processManager.getProcessId()){if(a&&a.refreshGlobalNavigationData&&this._dispatch(Object(b.b)(!1,n)),this._reloadDataCount<30)this._reloadData(e,t);else if(this._pageId!==e&&(this._reloadDataCount=0),30===this._reloadDataCount){var s=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ReachMaxBpfReloadDataCount"),l=this._processManager.getTelemetryParams();s.error("Max BPF reloadData count reached limit of 30. Root cause may be infinite loop when rendering the ProcessControl.",l)}this._reloadDataCount++}else this._reloadDataCount=0},e.prototype._hasProcessChanged=function(e){var t=this._processIdInState||i.a.EMPTY,r=this._getState(),n=new u.a(e.entityTypeName,e.id),a=Object(f.g)(r,this._pageId),o=Object(j.a)(a),l=i.a.equals(n.id,i.a.EMPTY)&&o?o:Object(c.e)(r,n)||i.a.EMPTY;if(!i.a.equals(l,t))return!0;if(i.a.equals(l,i.a.EMPTY))return!1;var d=Object(s.b)(r,l);return!!d&&this._processManager.getVersion()<d.businessProcessFlowProcessVersion},e.prototype._moveToNextStageForCrossEntityBPF=function(e,t){var r=e.activestageid,n=e.traversedpath,a=t.data.nextStageId;if(!a){var o=Object(j.a)(t),s=Object(j.b)(t);if(!i.a.equals(o,this._processManager.getProcessId())||!i.a.equals(s,this._processManager.getProcessInstanceId()))return;a=this._processManager.getStageMetadata().getNextStageId(this._processManager.getActiveStageId())}i.a.equals(r.reference.id,new i.a(a))||(r.reference=new u.a("processstage",new i.a(a)),n.value=n.value+","+a,e.activestagestartedon.value=new Date)},e}()},n4BT:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="form.ViewPortSizes.set";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r,a){var o=Object(n.v)(t);return{type:i,payload:{viewportWidth:r,viewportHeight:a},meta:{pageId:e,contextKey:o}}}},nIt0:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return o}));var n=r("c/eZ"),i=r("uO/V"),a=r("uQP8"),o="control.update.formlessControlOutputs";function s(e,t,r){return{type:"control.update.formlessControlOutputs.async",execute:function(s,c){var l=s.dispatch,u=s.getState,d=c.TraceManager.getTracer(i.z),p=i.x+".formlessControlOutputsIdAction";try{if(!Object.keys(r).length)return Promise.resolve();var h=u(),g=Object(a.a)(h,e),m=Object(n.__assign)({},g.formlessControlOutputs),f=!1;for(var b in d.info("Updating the unbound output."),r){var y=r[b],v=t+"."+b;m[v]!==y&&(m[v]=y,f=!0)}return f&&l(function(e,t){return{type:o,payload:{formlessControlOutputs:t},meta:{pageId:e}}}(e,m)),c.EventManager.ReportComponentSuccess(p),Promise.resolve()}catch(e){var _="Updating the outbound outputs for the grid failed with error : "+e.message;c.EventManager.ReportComponentFailure(p,Error(_))}}}}},nn4v:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n={queryKey:null,pageNumber:1,isNewPageRequested:!1,selectedRows:[],selectedRelatedEntity:null,filters:{},rowProperties:{records:[]},fetchXml:"",controls:{},refreshCounter:0,pagingRefreshInput:0,pagingData:"",relationshipName:null,relationshipRoleOrdinal:null,showChart:null,useRollupView:!1,chartVisualizationType:null,dependentOptionSetColumnStatus:{},chartDrillDownParameters:[]}},"o0+l":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="attribute.submitmode";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r,a){var o=Object(n.x)(t);return{type:i,payload:a,meta:{pageId:e,contextKey:o,dataFieldName:r}}}},oUmu:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return a}));var n=r("i8/j"),i=r("7z0H"),a="form.ui.metadata.update";function o(e,t,r){return{type:"form.ui.metadata.update.async",execute:function(o,s,c){var l=o.dispatch,u=(0,o.getState)(),d=Object(n.j)(u,e),p=Object(i.g)(u,d,e);return l(function(e,t,r,n){return{type:a,payload:{formId:e,formUIState:t},meta:{pageId:r,contextToken:n}}}(e,p,t,r)),Promise.resolve()}}}},oY7N:function(e,t,r){"use strict";r.d(t,"a",(function(){return qt}));var n=r("c/eZ"),i=r("nuS9"),a=r("4fxQ"),o=r("D9ys"),s=r("4E+q"),c=r("YWpA"),l=r("hPFj"),u=r("H/hG"),d=r("e9UD"),p=r("znb3"),h=r("NJzV"),g=r("VnpK"),m=r("POU9"),f=r("vP/5"),b=r("0u+G"),y=r("uO/V"),v=2/(1+Math.sqrt(5)),_=function(e){function t(t){var r=e.call(this,t)||this;return r._memorizedDescriptor=null,r.onMeasuring=r.onMeasuring.bind(r),r.state={width:0,height:0},r}return Object(n.__extends)(t,e),t.prototype._getGoldenRatioHeight=function(e){return v*e},t.prototype.onMeasuring=function(e,t){var r=!1,n={};e!==this.state.width&&(n.width=e,r=!0),t!==this.state.height&&(n.height=t,r=!0),r&&this.setState(n)},t.prototype.render=function(){var e=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(y.z):null;if(!this.props||!this.props.showChart||!this.props.configuration)return e&&e.info("Chart not rendered because the configuration is missing or show chart is set to false"),null;this._memorizedDescriptor&&this.props.chartId===this._memorizedDescriptor.Id||(this._memorizedDescriptor={Id:this.props.chartId,Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1});var t,r,n=parseFloat(getComputedStyle(document.documentElement).fontSize),a=this._getTopAndBottomAdjustment(n),o=this._getLeftAndRightAdjustment(n);this.props.isLayoutVertical?(t=this.state.width-o,r=this._getGoldenRatioHeight(t),this.props.style.minHeight=r+a):(t=Math.max(this.state.width,320)-o,r=this.state.height-a);var s={minWidth:t.toString()+"px",minHeight:r.toString()+"px"},l={width:t>0?t:-1,height:r>0?r:-1,eventListeners:[{eventname:"onChartPaneClose",eventhandler:[this._closeChartPane.bind(this)]}]};return i.createElement(c.a,{key:"pageChart_"+this.props.id,testhooks:{id:"pageChart_"+this.props.id},style:this.props.style,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0},i.createElement(c.a,{key:"pageChart_"+this.props.id+"_container",style:s},i.createElement(h.c,{key:this.props.chartId,controlId:this.props.chartId,id:this.props.id,configuration:this.props.configuration,descriptor:this._memorizedDescriptor,parentDefinedControlProps:l,parentContextToken:this.props.contextToken})))},t.prototype._closeChartPane=function(){this.props.closeChartPaneHandler(this.props.id,this.props.contextToken,!1)},t.prototype._getTopAndBottomAdjustment=function(e){var t=0;return this.props.style.borderTopWidth&&(t+=e*("string"==typeof this.props.style.borderTopWidth?parseFloat(this.props.style.borderTopWidth||"0px"):this.props.style.borderTopWidth)),this.props.style.paddingTop&&(t+=e*("string"==typeof this.props.style.paddingTop?parseFloat(this.props.style.paddingTop||"0px"):this.props.style.paddingTop)),this.props.style.borderTop&&(t+=1),this.props.style.borderBottom&&(t+=1),t},t.prototype._getLeftAndRightAdjustment=function(e){var t=0;return this.props.style.paddingLeft&&(t+=e*("string"==typeof this.props.style.paddingLeft?parseFloat(this.props.style.paddingLeft||"0px"):this.props.style.paddingLeft)),this.props.style.paddingRight&&(t+=e*("string"==typeof this.props.style.paddingRight?parseFloat(this.props.style.paddingRight||"0px"):this.props.style.paddingRight)),this.props.style.borderLeft&&(t+=1),this.props.style.borderRight&&(t+=1),t},t}(i.Component),S=r("9r0m"),O=r("ah4O"),C=r("RlP9"),I=r("r2h9"),j=r("RB3d"),P=r("perk"),F=r("Gemh"),T=r("pWlk"),w=r("olrR"),E=r("mGpW"),x=r("Ww2r"),N=r("gBKR"),A=r("lMVv"),k=r("G7N+"),M=r("hXUt"),D=r("5Fed"),R=r("Ev4I"),B=r("JlqV"),L=r("pJ3X"),V=r("oVzJ"),z=r("cZkS"),G=r("qC0c"),W=r("PMTb"),H=[],U=function(e){function t(t){var r=e.call(this,t)||this;return r._onItemIconPointerDown=r._onItemIconPointerDown.bind(r),r._onChange=r._onChange.bind(r),r.props.entityTypeName.toLowerCase()===F.a&&(r.props.loadAllActivityTypes(t.activities),r.props.loadAllActivityResourceString()),r}return Object(n.__extends)(t,e),t.prototype._getEntityTypeNameFromViewId=function(e){return e&&this.props.gridViewSelectorItems&&this.props.gridViewSelectorItems[e]&&this.props.gridViewSelectorItems[e].relatedEntityName?this.props.gridViewSelectorItems[e].relatedEntityName:null},t.prototype._onChange=function(e){var t;this.props.isGridRoot&&this.props.pageToEditedViewMapId&&this.props.selectedViewId!==e&&this.props.removeEditedViewPageMap(null===(t=this.props.pageToEditedViewMapId)||void 0===t?void 0:t.guid,new S.a(this.props.selectedViewId)),this.props.onChange(e,this.props.entityTypeName===F.a?this._getEntityTypeNameFromViewId(e):this.props.entityTypeName)},t.prototype._isViewSelectorHidden=function(){return!(this.props.gridViewSelectorItems&&this.props.viewCategories&&this.props.selectedViewId)},t.prototype.render=function(){var e=Object(x.c)(this.props.resourceStrings,P.VIEWSELECTOR_TOOLTIP),t=this.props.contextString===y.h.GRID,r=t?this._onItemIconPointerDown:null,n=this.props.useViewSelectorV2?this.props.isPhone:this.props.isTablet,a=n?this.props.styleProps.textStyleMobile:this.props.styleProps.textStyle,o=n?this.props.styleProps.viewSelectorMobileStyle:this.props.styleProps.viewSelectorStyle,s=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(y.z):null;if(this._isViewSelectorHidden())return s&&s.info("View Selector not rendered because view selector items or view categories or selected view is not available."),null;var c=[],l=!1;for(var u in this.props.gridViewSelectorItems){var d=this.props.gridViewSelectorItems[u];if(d){var h=d.isUserView;h&&(l=!0);var g=void 0;if(this.props.entityTypeName===F.a&&this.props.pinnedActivityView){var m=d;g=m.isPinned&&this.props.pinnedActivityView.PinnedEntity===m.relatedEntityName}else g=d.isPinned;var f=t?g?p.a.Pinned:p.a.Pin:null,b={":hover":{"::before":{content:g?'""':'""'}}};this.props.useViewSelectorV2&&Object.assign(b,{marginLeft:"8px",marginRight:"8px"});var v=t?b:null,_=Object(x.c)(this.props.resourceStrings,P.VIEWSELECTOR_DEFAULTVIEW),S=Object(x.c)(this.props.resourceStrings,P.VIEWSELECTOR_SETDEFAULTVIEW),C=t?g?_:S:null,T="";T=this.props.entityTypeName===F.a&&this.props.allActivitiesString&&this.props.shouldDisplayNestedViewSelector?(H.indexOf(d.relatedEntityName)+1).toString():h?I.b.userview.toString():I.b.savedview.toString();var w=d.name;u===this.props.selectedViewId&&this.props.isEdited&&(this.props.isRTL?w="*"+w:w+="*"),c.push({value:u,text:w,categoryId:T,iconType:f,iconTitle:C,iconStyle:v})}}if(this.props.selectedViewId&&this.props.quickFindViewId&&this.props.quickFindViewId===this.props.selectedViewId){var E=Object(x.c)(this.props.resourceStrings,P.QUICK_FIND_VIEWS_LABEL_ID);c.push({value:this.props.selectedViewId,text:E,categoryId:I.b.savedview.toString()})}var N=l?this.props.viewCategories:this.props.viewCategories.filter((function(e){return e.id!==I.b.userview.toString()}));return this.props.isGridRoot&&this.props.isInMobileModeForOct2019?i.createElement(L.c,{pageId:this.props.pageId},this.props.isAdvancedFindView?i.createElement(W.a,null,"New view"):i.createElement(L.k,{items:c,selectedItemId:this.props.selectedViewId,onChange:this._onChange})):this.props.isAdvancedFindView?i.createElement(W.a,{style:a},"New view"):i.createElement(O.a,{id:this.props.id,testhooks:{id:"ViewSelector_"+this.props.selectedViewId},value:this.props.selectedViewId,role:"presentation",title:e,categories:N,options:c,style:this.props.style,caretType:p.a.ChevronDownMed,caretStyle:this.props.styleProps.caretStyle,textStyle:a,viewSelectorStyle:o,onChange:this._onChange,onItemIconPointerDown:r,createAccessibilityComponent:j.a,createKeyboardShortcut:j.b,parentCustomControlId:this.props.id,rootZIndex:this.props.rootZIndex,isRTL:this.props.isRTL,useViewSelectorV2:this.props.useViewSelectorV2,placeItemIconOnRight:!0,useHeader:this.props.isGridRoot})},t.prototype.componentDidMount=function(){var e=this;if(this.props.viewIds?this.props.loadGridViewsByViewId(this.props.viewIds,this.props.entityTypeName):this.props.loadViewsByType(this.props.queryViewSelectorTypes,this.props.entityTypeName,this.props.gridViewSelectorItems),!this._isViewSelectorHidden()){var t=!1;if(this.props.selectedViewId&&""!==this.props.selectedViewId&&(this.props.gridViewSelectorItems&&this.props.gridViewSelectorItems[this.props.selectedViewId]||this.props.quickFindViewId&&this.props.quickFindViewId===this.props.selectedViewId)&&(t=!0),!t){if(this.props.viewIds)this.props.viewIds.find((function(t){return t.guid===e.props.selectedViewId}))&&(t=!0);this.props.defaultViewId&&this.props.defaultViewId.guid!==S.a.EMPTYSTRING&&this.props.onChange(this.props.defaultViewId.guid,this.props.entityTypeName)}}},t.prototype._onItemIconPointerDown=function(e){var t=this,r=e,n=e.iconType===p.a.Pinned,i=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(y.z):null,a=e.categoryId,o=this.props.entityTypeName;if(this.props.entityTypeName===F.a){var s=this.props.gridViewSelectorItems;o=s&&s[e.value]?s[e.value].relatedEntityName:o,a=!(!s||!s[e.value])&&s[e.value].isUserView?I.b.userview.toString():I.b.savedview.toString()}i&&i.info("Toggle the the pin status for "+e.value+" for "+o+" entity"),this.props.onItemIconPointerDown(o,e.value,a,"",n).then((function(){if(i&&i.info("Resetting the pin status of all the options and toggle the pin status of the recently selected item"),!n&&t.props.entityTypeName===F.a){var a=t.props.gridViewSelectorItems[r.value];t.props.pinnedActivityView.PinnedEntity=a.relatedEntityName,t.props.pinnedActivityView.ViewId=new S.a(e.value),t.props.pinnedActivityView.ViewType=a.isUserView?I.b.userview:I.b.savedview}for(var o in t.props.gridViewSelectorItems)t.props.gridViewSelectorItems[o].isPinned=o===r.value&&!n;t.forceUpdate()}),(function(e){i&&i.error("Could not pin the selected view, pinning action failed with error "+e)}))},t}(i.Component);function q(e,t,r,n){var i=[];if(t===F.a&&n){var a=1;H.forEach((function(t){i.push({id:a.toString(),name:Object(A.f)(e,t)}),a++}))}else i=Object(F.mb)(e,r);return i}function X(e,t,r){var i;return t.forEach((function(t,a){var o=function(e,t,r){var n=Object(C.f)(e,t,r);n&&!Object(B.b)(e)&&Object(R.l)(e,t)&&(n=Object.keys(n).reduce((function(i,a){return(n[a].isAvailableInOffline||a===S.a.toString(Object(C.a)(e,t,r)))&&(i[a]=n[a]),i}),{}));return n}(e,r,t);o&&(i=Object(n.__assign)(Object(n.__assign)({},i),o))})),i}U.displayName="DataSetViewSelector";var K=Object(s.a)((function(){var e=null,t=null,r=null,i={gridViewSelectorItems:null,viewCategories:null,allActivitiesString:null,activities:null,activityOptions:null,resourceStrings:null,quickFindViewId:null,styleProps:null},a=Object(T.a)(),o=Object(x.h)();return function(s,c){var l,u=o(s,P.labelList),d=S.a.toString(Object(C.a)(s,c.entityTypeName,I.a.QUICKFIND_SEARCH)),p=null,h=null,g=a(s,c.contextString);H=Object(F.B)(s);var m=!1;if(c.queryViewSelectorTypes&&c.queryViewSelectorTypes.length>0&&!c.viewIds){if(c.entityTypeName===F.a&&c.shouldDisplayNestedViewSelector?(H.forEach((function(e){var t=X(s,c.queryViewSelectorTypes,e);t&&(p=Object(n.__assign)(Object(n.__assign)({},p),t))})),h=Object(x.e)(s,["ViewSelectorAllActivities"])):p=X(s,c.queryViewSelectorTypes,c.entityTypeName),e)for(var f in p)if(!e[f]||e[f]!==p[f]){m=!0;break}}else if(c.viewIds){for(var b={},y=0;y<c.viewIds.length;y++){var v=Object(F.qb)(s,c.viewIds[y],c.id);if(v&&v.grid&&v.grid.rows){var _=e?e[v.viewId.guid]:void 0,O=!_||_.name!==v.title||_.queryType!==v.queryType;f=O?{name:v.title,queryType:v.queryType,isDefault:!1,isQuickFindQuery:!1,isUserView:v.isUserView}:_;Object.assign(b,((l={})[v.viewId.guid]=f,l)),m=m||O}}b&&(p=b)}return!p||e&&Object.keys(e).length===Object.keys(p).length||(m=!0),h&&i.allActivitiesString!==h.ViewSelectorAllActivities&&(m=!0),t!==d&&(m=!0),r!==g&&(m=!0),m&&(t=d,r=g,i={gridViewSelectorItems:e=p,viewCategories:q(s,c.entityTypeName,P,c.shouldDisplayNestedViewSelector),allActivitiesString:h&&h.ViewSelectorAllActivities,activities:null,activityOptions:null,resourceStrings:u,quickFindViewId:t,styleProps:r,isInMobileModeForOct2019:Object(V.b)(s),useViewSelectorV2:Object(G.a)(s,z.le,z.h)}),i}}),(function(e){return{loadViewsByType:function(t,r,n){var i=[];return t.forEach((function(t,a){t===I.a.MAIN_APPLICATION_VIEW&&n&&0!==Object.keys(n).length||i.push(e(Object(w.a)(r,t,void 0,void 0)))})),Promise.all(i)},loadAllActivityResourceString:function(){return e(Object(E.e)(["ViewSelectorAllActivities"]))},loadAllActivityTypes:function(t){var r=null;for(var n in t)t[n].Initialized!==k.a.Initialized&&(r||(r={}),r[n]=["DisplayName","ActivityTypeMask","IsVisibleInMobileClient"]);return r?e(Object(N.e)(r)):Promise.resolve()},loadGridViewsByViewId:function(t,r){var n=[];return t.forEach((function(t,i){n.push(e(Object(w.a)(r,void 0,void 0,t)))})),Promise.all(n)},openPopup:function(t){return e(Object(D.a)(t))},closePopup:function(t){return e(Object(M.a)(t))}}}))(U),Q=r("6Tlt"),Y=r("Wg6j"),Z=r("XIN1"),J=r("r7Ib"),$=r("Md8f"),ee=r("5olG"),te=r("c96h"),re=42,ne=function(e){function t(t){var r=e.call(this,t)||this;return r.onMeasuring=r.onMeasuring.bind(r),r.state={commandbarWidth:0},r._lastCommandManagerId=t.commandManagerId,r}return Object(n.__extends)(t,e),t.prototype.onMeasuring=function(e){var t=e-((this.props.style.paddingLeft?"string"==typeof this.props.style.paddingLeft?Object(ee.e)(this.props.style.paddingLeft):this.props.style.paddingLeft:0)+(this.props.style.paddingRight?"string"==typeof this.props.style.paddingRight?Object(ee.e)(this.props.style.paddingRight):this.props.style.paddingRight:0))-(this.props.backButtonEnabled?re:0);t!==this.state.commandbarWidth&&this.setState({commandbarWidth:t})},t.prototype.componentDidUpdate=function(){this.props.commandManagerId!==this._lastCommandManagerId&&(this._lastCommandManagerId=this.props.commandManagerId,this.props.setCommandManagerId(this.props.pageId,this.props.commandManagerId,this.props.contextToken))},t.prototype._renderConsoleAppBackButton=function(){return this.props.backButtonEnabled?i.createElement($.a,{pageId:this.props.pageId}):null},t.prototype._renderNativeSubgridCommandBar=function(){return this.props.isNativeMode?i.createElement(L.e,{commandManagerId:this.props.commandManagerId,pageId:this.props.pageId}):null},t.prototype.render=function(){if(!this.props.pageId||!this.props.ribbonId||!this.props.commandManagerId)return null;var e=!this.state.commandbarWidth,t=i.createElement(Q.a,{commandBarStyle:this.props.commandbarStyles,width:this.state.commandbarWidth,commandbarDisplayMode:Y.a.IconLabel,key:this.props.pageId,iconPosition:Z.a.Left,commandManagerId:this.props.commandManagerId,id:this.props.pageId,ribbonId:this.props.ribbonId,relationshipType:this.props.relationshipType,addedCommandList:this.props.addedCommandList,appendedCommandList:this.props.appendedCommandList,contextToken:this.props.contextToken,metaDataLoadedResolve:this.props.metaDataLoadedResolve,isHidden:e,rootZIndex:this.props.rootZIndex,customControlType:this.props.customControlType,isNativeMode:this.props.isNativeMode});return this.props.isInMobileModeForOct2019&&this.props.isGridRoot?t:i.createElement(c.a,{key:"commandBar_"+this.props.pageId,testhooks:{id:"commandBar_"+this.props.pageId},style:this.props.style,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0},this._renderConsoleAppBackButton(),t,this._renderNativeSubgridCommandBar())},t}(i.Component);ne.displayName="DataSetCommandBar";var ie=Object(s.a)((function(){return function(e,t){var r=Object(V.b)(e);return{commandManagerId:Object(F.w)(e,t.pageId,t.contextToken)||t.commandManagerId,backButtonEnabled:Object(te.d)(e)&&t.isGridRoot&&!t.collapsed,isInMobileModeForOct2019:r}}}),(function(e){return{setCommandManagerId:function(t,r,n){t&&r&&n&&e(Object(J.b)(t,r,n))}}}))(ne),ae=r("A6np"),oe=r("jigW");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function se(e){if(e){var t=e.split(":");if(2===t.length)return t[1].split(",")}return[]}function ce(e){if(e&&e.filterOptions&&e.filterOptions.length>0){var t=e.filterOptions.filter((function(e){return e.isDefault})),r=e.userSetting,n=r&&r.defaultGridViews&&r.defaultGridViews[e.entityTypeName];n&&""!==n.QueueId&&(t=e.filterOptions.filter((function(e){return Object(F.bb)(n.QueueId).sort().join(",")===se(e.value).sort().join(",")})));var a=void 0,o=void 0;e.isGridPaginationStateFeatureEnabled&&null!=e.previousValue&&(a=Object(oe.f)(e.filterOptions,e.previousValue),o=e.previousValue),a||(t.length>0?(a=t[0].text,o=t[0].value):(a=e.filterOptions[0].text,o=e.filterOptions[0].value)),e.updateFilterValue(o);var s=Object(x.c)(e.resourceStrings,P.QUEUE_FILTER_LABEL),l=i.createElement(ae.a,{key:"gridFilter",testhooks:{id:"gridFilter_"+e},title:s,accessibilityLabel:s,defaultValue:a,options:e.filterOptions,onChange:e.onFilterChange,createAccessibilityComponent:j.a,style:e.comboBoxStyle,createKeyboardShortcut:j.b,freeTextMode:!0,suppressFreeTextChangeCallback:!0});return i.createElement(c.a,{key:"GridFilterView",style:e.style},l)}var u=e.TraceManager&&e.TraceManager.getTracer?e.TraceManager.getTracer(y.z):null;return u&&u.info("Queue Filter not rendered because there are no filter options available"),null}var le=r("np0M"),ue=r("Oiu5"),de={Id:"toggleButtonControl",Label:null,Name:"toggleButtonControl",ShowLabel:!1,Visible:!0,Disabled:!1},pe={FormFactor:2,CustomControlId:"MscrmControls.FlipSwitch.FlipSwitchControl",Name:"MscrmControls.FlipSwitch.FlipSwitchControl",Version:"1.0.0",Parameters:{value:{Usage:3,Static:!1,Value:0,Type:"TwoOptions",Attributes:{DefaultValue:0,Options:null},Callback:null}},ShouldOverrideControlVisible:!1};function he(e,t){if(!e.isRollupViewSupported)return null;var r,a,o,s,c=function(e){var t=[];if(!Array.isArray(e))return t;for(var r=0;r<e.length;++r)t.push({Label:e[r],Value:r});return t}([Object(x.c)(e.resourceStrings,P.ROLLUPVIEW_SWITCH_OFF),Object(x.c)(e.resourceStrings,P.ROLLUPVIEW_SWITCH_ON)]),l=e.isOffline,u=(r=e.toggleValue,a=t,o=e.onToggleChange,s=c,Object(n.__assign)(Object(n.__assign)({},pe),{Parameters:{value:{Usage:3,Static:!1,Type:"TwoOptions",Value:r?1:0,Attributes:{DefaultValue:0,Options:s,DisplayName:a},Callback:o}}})),d=function(e,t){return Object(n.__assign)(Object(n.__assign)({},de),{Label:e,Disabled:t})}(t,l),p="rollup_view_switch_"+e.id;return i.createElement(h.c,{key:p,controlId:p,id:e.id,systemDefinedProperties:null,descriptor:d,configuration:u,formInfo:void 0,shouldRender:!0,parentContextToken:null,parentDefinedControlProps:void 0})}function ge(e,t,r,n,a){var o=e.theme,s=e.isRTL,l=e.isActivityManagementFeatureEnabled&&e.entityIsActivityType;return i.createElement(c.a,{key:"ActivityViewContainer",role:"presentation",style:e.activityViewContainerStyle},i.createElement(c.a,{key:"ActivityDueDateFilterView",style:l?e.activityTypeContainerStyle:e.containerStyle},[t,r]),a?i.createElement(c.a,{key:"ActivityTypeFilterView",style:e.activityTypeContainerStyle},[n,a]):null,function(e,t,r,n){if(!t)return;var a=Object(x.c)(e.resourceStrings,P.ROLLUPVIEW_SWITCH_LABEL),o={flex:"1 1 auto",marginLeft:r.sizes.Measures.Measure200,marginRight:r.sizes.Measures.Measure200,marginTop:r.sizes.Measures.Measure050,minWidth:"15rem"},s={whiteSpace:"nowrap",flex:"1 0 auto",marginRight:n?0:r.sizes.Measures.Measure100,marginLeft:n?r.sizes.Measures.Measure100:0};return i.createElement(c.a,{key:"RollupViewControlContainer",style:o},i.createElement(c.a,{key:"rollupViewFilterLabelView",style:s},a),he(e,a))}(e,e.isRollupViewSupported,o,s))}var me=Object(s.a)(void 0,(function(e){return{openPopup:function(t){return e(Object(D.a)(t))},closePopup:function(t){return e(Object(M.a)(t))}}}))((function(e){var t,n=e.TraceManager&&e.TraceManager.getTracer?e.TraceManager.getTracer(y.z):null,a="",o=e.isActivityManagementFeatureEnabled&&e.entityIsActivityType;if(e&&e.filterOptions&&e.filterOptions.length>0){var s=e.filterOptions.filter((function(e){return e.isDefault}));o&&(t=Object(ue.d)(e.filterOptions)),e.isGridPaginationStateFeatureEnabled&&null!=e.previousValue&&(a=o?e.previousValue:Object(oe.f)(e.filterOptions,e.previousValue)),a||(a=s.length>0?o?s[0].value:s[0].text:o?e.filterOptions[0].value:e.filterOptions[0].text)}var l=i.useState(a),d=l[0],p=l[1];if(e&&e.filterOptions&&e.filterOptions.length>0){var h=o?Object(x.c)(e.resourceStrings,e.dueDateFilterLabelResourceString):Object(x.c)(e.resourceStrings,e.entityFilterLabelResourceString),g=null;h&&(g=i.createElement(u.a,{key:"activityDueDateFilterLabel",style:o?e.activityMgmtLabelStyle:e.labelStyle}," ",h," "));var m=i.createElement(c.a,{key:"activityDueDateFilterLabelView",style:{alignItems:"center",justifyContent:"center"}},g),f=i.createElement(ae.a,{key:"activityDueDateFilterComboBox",testhooks:{id:"activityDueDateFilterComboBox_"+e.id},id:"activityDueDateFilterComboBox",defaultValue:a,options:e.filterOptions,onChange:e.onFilterChange,createAccessibilityComponent:j.a,style:e.comboBoxStyle,textStyle:{flex:"1 0 auto",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",width:"0px"},createKeyboardShortcut:j.b,openPopup:e.openPopup,closePopup:e.closePopup,parentCustomControlId:"activityDueDateFilterComboBox",rootZIndex:e.rootZIndex,accessibilityLabel:h,freeTextMode:!0,suppressFreeTextChangeCallback:!0});if(o&&(f=i.createElement(le.a,{key:"activityDueDateFilterComboBox",loader:function(){return Promise.all([r.e(10),r.e(11),r.e(13),r.e(12),r.e(14),r.e(15),r.e(17),r.e(21),r.e(29),r.e(91)]).then(r.bind(null,"YDph")).then((function(e){return e.ComboBox}))},props:{selectedKey:d,key:"activityDueDateFilterComboBox",id:"activityDueDateFilterComboBox",options:t,onChange:function(t,r){p(r.key),e.onFilterChange(r.key)},style:e.dueDatecomboBoxStyle,ariaLabel:h,useComboBoxAsMenuWidth:!0,allowFreeform:!0}})),e.isActivityManagementFeatureEnabled&&!e.isOffline&&!e.isMobile&&e.gridEntityName===y.a){var b=null,v=Object(x.c)(e.resourceStrings,e.activityTypeFilterLabelResourceString);v&&(b=i.createElement(u.a,{key:"activityTypeFilterLabel",style:e.activityMgmtLabelStyle}," ",v," "));var _=i.createElement(c.a,{key:"activityTypeFilterLabelView",style:{alignItems:"center",justifyContent:"center"}},b),S=void 0;if(e.filterOptionsForActivityType&&e.filterOptionsForActivityType.length>0){n&&n.info("Activity Management Filter - Activity Type Filter Rendered with no. of options "+e.filterOptionsForActivityType.length);var O=Object(ue.c)(e.filterOptionsForActivityType);if(e.isActivityFilterSelectAllEnabled){var C=Object(x.c)(e.resourceStrings,P.ACTIVITYTYPE_SELECTALL),I=[];I.push({key:"selectAllKey",text:C}),O=I.concat(O)}var F=[];e.isGridPaginationStateFeatureEnabled&&null!=e.activityTypePreviousValues&&(F=Object(ue.b)(e.activityTypePreviousValues)),S=i.createElement(le.a,{key:"activityTypeFilterBox",loader:function(){return Promise.all([r.e(10),r.e(29),r.e(41)]).then(r.bind(null,"x3Jg")).then((function(e){return e.ActivityTypeCombobox}))},props:{key:"activityTypeFilterBox",id:"activityTypeFilterBox",selectedOptionKeys:F,onActivityTypeFilterClear:function(){e.onActivityTypeFilterClear()},onActivityTypeMenuDismissed:function(t){e.onActivityTypeChange(t)},options:O,ariaLabel:v,isRTL:e.isRTL,style:e.activityTypeContainerStyle,resourceStrings:e.resourceStrings,selectAllEnabled:e.isActivityFilterSelectAllEnabled}})}return ge(e,m,f,_,S)}return ge(e,m,f,null,null)}return n&&n.info("Activity Filter not rendered because there are no filter options available"),null})),fe=r("lU69"),be=r("gvL4"),ye=r("Smta"),ve=r("vTeb"),_e=r("evW+"),Se=r("1AYO"),Oe=r("19Zc"),Ce=r("wV3W"),Ie=r("vO+w");var je=r("rbxJ"),Pe=r("9rQ4"),Fe=r("hl8w"),Te=r("akzq"),we=r("Wi7Z"),Ee=r("B73A"),xe=r("E705"),Ne=r("YT7W"),Ae=r("TCzx"),ke=function(e){function t(t){var r=e.call(this,t)||this;return r._cachedSelectedFilter="",r._onFilterChange=r._onFilterChange.bind(r),r._toggleJumpBarFlyout=r._toggleJumpBarFlyout.bind(r),r._closeJumpBarDomId="close-jumpbar-"+Object(fe.a)(),r._selectedFilterDomId="selected-filter-"+Object(fe.a)(),r.state={isFlyoutOpened:!1},r}return Object(n.__extends)(t,e),t.prototype._onOutsideClickHandler=function(e,t){var r=t.target,n=document.getElementById(e);r&&!n.contains(r)&&n!==r&&this._toggleJumpBarFlyout()},t.prototype.keyDownHandler=function(e){switch(e.EVENT.keyCode){case Pe.a.Escape:this._setIsFlyoutOpenedState(!1)}},t.prototype._toggleJumpBarFlyout=function(){this._setIsFlyoutOpenedState(!this.state.isFlyoutOpened)},t.prototype._setIsFlyoutOpenedState=function(e){this.setState({isFlyoutOpened:e}),Object(xe.g)(e)},t.prototype._filterGrid=function(e){var t,r=e.getAttribute("data-value");if(r!==this._cachedSelectedFilter&&(this.props.updateDataSetLoadingState(1),this._cachedSelectedFilter=r),1033===this.props.languageId&&r){var n=e.getAttribute("data-value").toUpperCase();n!==r&&(r=r+"|"+n)}t=this.props.dataSetFetchXml?Object(Fe.c)(this.props.dataSetFetchXml,this.props.entityAttributeMetadata,this.props.primaryNameAttribute):this.props.primaryNameAttribute,this.props.applyGridFilter(Object(Fe.b)(r,t),this.props.isGridRoot,this.props.contextToken),this._setIsFlyoutOpenedState(this.props.renderMobile&&!this.state.isFlyoutOpened)},t.prototype._onFilterChange=function(e){var t=e.target,r=e;("click"===e.type||r&&r.keyCode===Pe.a.Enter)&&(e.preventDefault(),t&&"a"===t.tagName.toLowerCase()&&(t=t.parentElement),this._filterGrid(t))},t.prototype._renderListItem=function(e,t,r){var a=Object(n.__assign)({},this.props.renderMobile?this.props.styles.listItemStyleMobile:this.props.styles.listItemStyle),o=Object(n.__assign)(Object(n.__assign)({},this.props.styles.hyperlinkStyle),this.props.renderMobile?this.props.styles.hyperlinkStyleMobile:null);return r.describedByElementId&&(a=Object.assign(a,this.props.renderMobile?this.props.styles.listItemSelectedStyleMobile:this.props.styles.listItemSelectedStyle),o=Object.assign(o,this.props.renderMobile?this.props.styles.hyperlinkSelectedStyleMobile:null)),i.createElement(ye.a,Object(n.__assign)({},r,{style:a}),i.createElement(ve.a,Object(n.__assign)({},e,{style:o}),t))},t.prototype._createKeyboardShortcuts=function(){var e=Object(x.c)(this.props.resourceStrings,P.CLOSE_JUMPBAR_ARIALABEL),t=this.keyDownHandler.bind(this),r=[],n=new Ee.a([Pe.a.Escape],t,!0,"",e);return r.push(n),r},t.prototype._renderJumpBarAlphabet=function(){var e=this,t=[],r=Object(x.c)(this.props.resourceStrings,P.JUMPBAR_ALPHABET),n=Object(x.c)(this.props.resourceStrings,P.JUMPBAR_NUMBER_INDICATOR),i=Object(x.c)(this.props.resourceStrings,P.JUMPBAR_NUMBER_TOOLTIP),a=Ae.a.getInstance(),o=!!a&&a.get_IsIOS();return r.split(",").forEach((function(r){var a=Object(je.h)(r),s=a[0],c=a[1],l=s+"_listItem",u=s+"_link",d={id:l,key:l,accessibilityLabel:String.format(P.FILTERBY_ARIALABEL,c),role:we.q,onClick:e._onFilterChange,onKeyDown:e._onFilterChange,tabIndex:-1},p={id:u,key:u,testhooks:{id:u},tabIndex:-1,role:we.r,accessibilityHidden:!o,accessibilityLabel:o?String.format(P.FILTERBY_ARIALABEL,c):void 0};s===n&&(p.title=i,p.accessibilityLabel=P.NUMBER_ARIALABEL),e.props.selectedFilter!==s&&e.props.selectedFilter!==c||(d.describedByElementId=e._selectedFilterDomId,d.isSelected=!0,d.tabIndex=0),c&&(d.dataValue=c),t.push(e._renderListItem(p,s,d))})),t},t.prototype._renderJumpBarAll=function(){var e=Object(x.c)(this.props.resourceStrings,P.JUMPBAR_ALL),t=Object(x.c)(this.props.resourceStrings,P.JUMPBAR_ALL_TITLE);this._allListItemDomId=e+"_listItem";var r=e+"_link",n=Ae.a.getInstance(),i=!!n&&n.get_IsIOS(),a={id:this._allListItemDomId,key:this._allListItemDomId,onClick:this._onFilterChange,onKeyDown:this._onFilterChange,role:we.q,tabIndex:-1,accessibilityLabel:String.format(P.FILTERBY_ARIALABEL,e)},o={id:r,key:r,testhooks:{id:r},tabIndex:-1,role:we.r,accessibilityHidden:!i,accessibilityLabel:i?String.format(P.FILTERBY_ARIALABEL,e):void 0,title:t};return this.props.selectedFilter&&this.props.selectedFilter!==e||(a.describedByElementId=this._selectedFilterDomId,a.isSelected=!0,a.tabIndex=0),this._renderListItem(o,e,a)},t.prototype._renderList=function(){var e=Object(x.c)(this.props.resourceStrings,P.JUMPBAR_LETTER_TITLE);return i.createElement(be.a,{id:"JumpBarItemsList",key:"JumpBarItemsList",testhooks:{id:"JumpBarItemsList"},title:e,role:we.j,onKeyDown:this._onJumpbarKeyDown.bind(this),style:Object(n.__assign)(Object(n.__assign)({},this.props.styles.jumpBarStyle),this.props.renderMobile?this.props.styles.jumpBarStyleMobile:null),accessibilityLabel:P.JUMPBAR_ARIALABEL},this._renderJumpBarAll(),this._renderJumpBarAlphabet())},t.prototype._onJumpbarKeyDown=function(e){var t=e.target;if(this.state.isFlyoutOpened){var r=9===e.keyCode,n=e.shiftKey;if(r){if(e.stopPropagation(),e.preventDefault(),n){if(t.id===this._closeJumpBarDomId)return void document.querySelector("#JumpBarItemsList").lastElementChild.focus();(a=t.previousElementSibling)?a.focus():t.id===this._allListItemDomId&&document.getElementById(this._closeJumpBarDomId).focus()}else{if(t.id===this._closeJumpBarDomId)return void document.getElementById(this._allListItemDomId).focus();if(t.parentElement&&t.parentElement.lastElementChild&&t.id===t.parentElement.lastElementChild.getAttribute("id"))return void document.getElementById(this._closeJumpBarDomId).focus();(i=t.nextElementSibling)&&i.focus()}return}}if(e.keyCode===Pe.a.UpArrow||e.keyCode===Pe.a.DownArrow||e.keyCode===Pe.a.LeftArrow||e.keyCode===Pe.a.RightArrow){e.stopPropagation(),e.preventDefault();var i,a,o=e.keyCode===Pe.a.DownArrow||e.keyCode===Pe.a.RightArrow,s=e.keyCode===Pe.a.UpArrow||e.keyCode===Pe.a.LeftArrow;if(o)return void((i=t.nextElementSibling)&&i.focus());if(s)return void((a=t.previousElementSibling)&&a.focus())}},t.prototype._renderJumpBarFlyout=function(e,t){var r="jumpbar-flyout_"+this.props.id,n=r+"Accessibility",a=[];return a.push(i.createElement(Te.a,{key:n,rootElementId:r,shouldManageFocus:!0,isModal:!0,keyboardShortcuts:this._createKeyboardShortcuts(),defaultFocusId:this._closeJumpBarDomId})),i.createElement(c.a,{role:we.e},i.createElement(Se.a,{id:r,testhooks:{id:r},key:r,rootZIndex:this.props.rootZIndex,positionType:"relative",relativeToElementId:t,flyoutStyle:this.props.styles.jumpBarFlyoutStyle,flyoutDirection:this.props.isRTL?Se.b.upleft:Se.b.rightup,onOutsideClick:this._onOutsideClickHandler.bind(this,e)},i.createElement(_e.a,{key:"cancel",style:this.props.styles.closeButtonStyle,id:this._closeJumpBarDomId,onClick:this._toggleJumpBarFlyout,onKeyDown:this._onJumpbarKeyDown.bind(this),accessibilityLabel:P.CLOSE_JUMPBAR_ARIALABEL},i.createElement(u.a,{style:this.props.styles.closeButtonTextStyle},i.createElement(Z.b,{type:p.a.Close}))),this._renderList()),a)},t.prototype._renderFlyoutButton=function(e){for(var t=Object(x.c)(this.props.resourceStrings,P.JUMPBAR_LETTER_TITLE),r=Object(x.c)(this.props.resourceStrings,P.JUMPBAR_ALPHABET).split(","),n="",a=0;a<3;a++){n+=Object(je.h)(r[a+1])[0]}return i.createElement(_e.a,{id:e,accessibilityLabel:t,title:t,style:this.props.isMobile?this.props.styles.jumpBarButtonMobileStyle:this.props.styles.jumpBarButtonStyle,onClick:this._toggleJumpBarFlyout,testhooks:{id:e}},i.createElement(u.a,{style:this.props.styles.jumpBarButtonTextStyle},n))},t.prototype.render=function(){try{if(this.props.resourceStrings){var e="jumpBarRoot_"+this.props.id,t=e+"_"+this.props.uniqueId,r="jumpbarBtn_"+(this.props.uniqueId||this.props.id),n={position:"relative"};this.props.renderMobile&&Object.assign(n,{maxWidth:"100%"});var a={height:"0",width:"0"},o="flyoutRelativeElement"+this.props.controlKey;return i.createElement(c.a,{id:t,key:t,testhooks:{id:e},style:n},this.props.isRTL?null:i.createElement(c.a,{id:o,style:a,role:"presentation","aria-hidden":"true"}),this.props.renderMobile?this._renderFlyoutButton(r):this._renderList(),this.state.isFlyoutOpened?this._renderJumpBarFlyout(r,o):null,i.createElement(c.a,{style:{display:"none"},id:this._selectedFilterDomId,key:this._selectedFilterDomId,role:" "},P.SELECTEDFILTER_TEXT),this.props.isRTL?i.createElement(c.a,{id:o,style:a,role:"presentation","aria-hidden":"true"}):null)}return null}catch(e){return console.error(e.message),null}},t}(i.Component);var Me=Object(s.a)((function(){var e,t,r=null,n=null,i=null,a=Object(x.h)(),o=(e=null,t=null,function(r,n){var i,a,o,s,c,l,u,d,p,h,g,m,f,b,y,v,_,S,O,C,I,j,P,F,T,w,E,x,N,A,k,M,D,R,B=Object(Ce.a)(r),L=Object(Ie.b)(r)&&Object(G.a)(r,z.Fb,z.Lc)&&(null===(i=Object(Ie.a)(r))||void 0===i?void 0:i.Components)?Object(Ie.a)(r).Components:null;return t!==B&&(t=B,e={jumpBarStyle:{width:"100%",height:B.sizes.Measures.Measure300,display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",listStyleType:"none",backgroundColor:(null===(s=null===(o=null===(a=null==L?void 0:L.Grid)||void 0===a?void 0:a.Footer)||void 0===o?void 0:o.JumpBar)||void 0===s?void 0:s.BackgroundColor)||B.colors.BaseColor.Grey.Grey1,border:"1px solid transparent"},jumpBarButtonStyle:{display:"flex",fontSize:B.fontSizes.Font085,fontFamily:B.fontFamilies.Regular,color:(null===(u=null===(l=null===(c=null==L?void 0:L.Grid)||void 0===c?void 0:c.Footer)||void 0===l?void 0:l.JumpBar)||void 0===u?void 0:u.TextColor)||B.colors.MainThemeColor.MainColor1.Fill,cursor:B.display.PointerCursorStyle,borderStyle:"none",backgroundColor:"transparent",padding:"0",marginLeft:B.sizes.Measures.Measure100,marginRight:B.sizes.Measures.Measure100,marginTop:B.sizes.Measures.Measure050,marginBottom:B.sizes.Measures.Measure050,maxWidth:"100%"},jumpBarButtonMobileStyle:{display:"flex",fontSize:B.fontSizes.Font100,fontFamily:B.fontFamilies.Regular,color:(null===(h=null===(p=null===(d=null==L?void 0:L.Grid)||void 0===d?void 0:d.Footer)||void 0===p?void 0:p.JumpBar)||void 0===h?void 0:h.TextColor)||B.colors.MainThemeColor.MainColor1.Fill,cursor:B.display.PointerCursorStyle,borderStyle:"none",backgroundColor:"transparent",padding:"0",marginLeft:B.sizes.Measures.Measure100,marginRight:B.sizes.Measures.Measure100,marginTop:B.sizes.Measures.Measure050,marginBottom:B.sizes.Measures.Measure050,maxWidth:"100%"},jumpBarButtonTextStyle:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},jumpBarFlyoutStyle:{border:B.borders.Border02,backgroundColor:B.colors.BaseColor.Grey.Grey1,overflowY:"auto",overflowX:"hidden"},closeButtonStyle:{position:"absolute",top:"0",right:"0",borderStyle:"none",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"transparent",cursor:B.display.PointerCursorStyle,padding:B.sizes.Measures.Measure100,width:B.sizes.Measures.Measure300,height:B.sizes.Measures.Measure300},closeButtonTextStyle:{fontSize:"16px",color:B.colors.BaseColor.Grey.Grey7},jumpBarStyleMobile:{height:"auto",flexWrap:"wrap",display:"flex",alignItems:"center",justifyContent:"flex-start",paddingTop:B.sizes.Measures.Measure300,paddingRight:B.sizes.Measures.Measure050,paddingBottom:B.sizes.Measures.Measure150,paddingLeft:B.sizes.Measures.Measure300,maxWidth:"20rem"},listItemStyle:{textAlign:"center",position:"relative",height:B.sizes.Measures.Measure125},listItemSelectedStyle:{borderStyle:"solid",borderBottomColor:(null===(f=null===(m=null===(g=null==L?void 0:L.Grid)||void 0===g?void 0:g.Footer)||void 0===m?void 0:m.JumpBar)||void 0===f?void 0:f.SelectedColor)||B.colors.MainThemeColor.MainColor1.Fill,borderBottomWidth:B.sizes.Measures.Measure025},listItemStyleMobile:{display:"flex",alignItems:"center",justifyContent:"center",cursor:B.display.PointerCursorStyle,marginRight:B.sizes.Measures.Measure150,marginBottom:B.sizes.Measures.Measure150,width:B.sizes.Measures.Measure300,height:B.sizes.Measures.Measure300,border:B.borders.Border01,borderColor:(null===(v=null===(y=null===(b=null==L?void 0:L.Grid)||void 0===b?void 0:b.Footer)||void 0===y?void 0:y.JumpBar)||void 0===v?void 0:v.BorderColor)||B.colors.BaseColor.Blue.Blue3,backgroundColor:(null===(O=null===(S=null===(_=null==L?void 0:L.Grid)||void 0===_?void 0:_.Footer)||void 0===S?void 0:S.JumpBar)||void 0===O?void 0:O.BackgroundColorMobile)||B.colors.BaseColor.White,":nth-child(2)":{marginRight:"50%"},outlineOffset:"0px !important"},listItemSelectedStyleMobile:{borderColor:(null===(j=null===(I=null===(C=null==L?void 0:L.Grid)||void 0===C?void 0:C.Footer)||void 0===I?void 0:I.JumpBar)||void 0===j?void 0:j.SelectedBorderColor)||B.colors.BaseColor.Transparent,backgroundColor:(null===(T=null===(F=null===(P=null==L?void 0:L.Grid)||void 0===P?void 0:P.Footer)||void 0===F?void 0:F.JumpBar)||void 0===T?void 0:T.SelectedColorMobile)||B.colors.BaseColor.Grey.Grey2},hyperlinkStyle:{textDecoration:"none",textAlign:"center",fontSize:B.fontSizes.Font085,fontFamily:B.fontFamilies.Regular,whiteSpace:"nowrap",color:(null===(x=null===(E=null===(w=null==L?void 0:L.Grid)||void 0===w?void 0:w.Footer)||void 0===E?void 0:E.JumpBar)||void 0===x?void 0:x.LinkColor)||B.colors.BaseColor.Grey.Grey7},hyperlinkStyleMobile:{color:(null===(k=null===(A=null===(N=null==L?void 0:L.Grid)||void 0===N?void 0:N.Footer)||void 0===A?void 0:A.JumpBar)||void 0===k?void 0:k.LinkColor)||B.colors.BaseColor.Blue.Blue3},hyperlinkSelectedStyleMobile:{color:(null===(R=null===(D=null===(M=null==L?void 0:L.Grid)||void 0===M?void 0:M.Footer)||void 0===D?void 0:D.JumpBar)||void 0===R?void 0:R.SelectedBorderColor)||B.colors.BaseColor.Grey.Grey7}}),e});return function(e,t){var s=o(e,t);if(null===r&&(r=Object(A.E)(e,t.entityTypeName)),null==n&&(n=e.metadata.attributes[t.entityTypeName]),Object(G.a)(e,z.ac)){var c=Object(F.v)(e,t.id,t.contextToken);i=c&&c.fetchXml}return{resourceStrings:a(e,P.labelList),primaryNameAttribute:r,dataSetFetchXml:i,entityAttributeMetadata:n,styles:s}}}),(function(e,t){return{applyGridFilter:function(r,n,i){if(e(Object(Oe.m)(r,t.id,i)),e(Object(Ne.b)(t.id,i,1)),n){var a=[{filterType:4,filterExpressionOrValue:r}];t.updateGridPaginationStateHandler(a,t.id),t.setResetPagingInfoForEnhancedPaging()}}}}))(ke),De=r("fH/t");var Re=r("4Q7K"),Be=r("3IUl"),Le=r("bc+P"),Ve=r("+6eZ"),ze=r("Baft"),Ge=r("zETL"),We=r("r0s4"),He=function(e){function t(t){var r=e.call(this,t)||this;return r._goToFirstPage=r._goToFirstPage.bind(r),r._goToPreviousPage=r._goToPreviousPage.bind(r),r._goToNextPage=r._goToNextPage.bind(r),Object(x.c)(t.resourceStrings,De.d)||t.retrieveResourceStrings(De.k),r}return Object(n.__extends)(t,e),t.prototype._firstButtonEnabled=function(e){return this.props.currentPage>1},t.prototype._nextButtonEnabled=function(e){return(!(this.props.currentPage===Math.floor(e.totalResultCount/e.pageSize))||!this.props.pagingInfo.isGridScrolledToBottom)&&e.hasNextPage},t.prototype._previousButtonEnabled=function(e){return this.props.currentPage>1},t.prototype._goToNextPage=function(e){this.props.updateDataSetLoadingState(1),this.props.incrementLastPage(),this.props.setNewPageRequested(!0),this.props.updatePageNumber(this.props.currentPage+1),this._setFooterButtonsFocus(e,!0)},t.prototype._goToPreviousPage=function(e){this.props.updateDataSetLoadingState(1),this.props.setNewPageRequested(!0),this.props.updatePageNumber(this.props.currentPage-1),this._setFooterButtonsFocus(e,!1)},t.prototype._goToFirstPage=function(e){this.props.updateDataSetLoadingState(1),this.props.setNewPageRequested(!0),this.props.setFirstPage(1),this.props.updatePageNumber(1),this._setFooterButtonsFocus(e,!1)},t.prototype._setFooterButtonsFocus=function(e,t){if(null!==e&&null!==e.currentTarget&&null!==e.currentTarget.parentElement&&null!==e.currentTarget.parentElement.children)if(t&&e.currentTarget.parentElement.children.length>=2&&null!==e.currentTarget.parentElement.children[1]){var r=e.currentTarget,n=e.currentTarget.parentElement.children[1];setTimeout((function(){r.disabled&&n.focus()}),500)}else if(!t&&null!==e.currentTarget.parentElement.lastElementChild){var i=e.currentTarget,a=e.currentTarget.parentElement.lastElementChild;setTimeout((function(){i.disabled&&a.focus()}),500)}},t.prototype._getResources=function(){if(this._loadFirstPage=this._loadFirstPage||Object(x.c)(this.props.resourceStrings,De.d),this._loadNextPage=this._loadNextPage||Object(x.c)(this.props.resourceStrings,De.e),this._loadPreviousPage=this._loadPreviousPage||Object(x.c)(this.props.resourceStrings,De.f),!this._spaceResource){var e=Object(x.c)(this.props.resourceStrings,De.j);this._spaceResource=Object(We.CrmHtmlDecode)(e)}this._gridInfoResource=this._gridInfoResource||Object(x.c)(this.props.resourceStrings,De.a),this._gridTotalCount=this._gridTotalCount||Object(x.c)(this.props.resourceStrings,De.c),this._itemSelected=this._itemSelected||Object(x.c)(this.props.resourceStrings,De.b),this._totalApproximate=this._totalApproximate||Object(x.c)(this.props.resourceStrings,De.h),this._totalExact=this._totalExact||Object(x.c)(this.props.resourceStrings,De.i)},t.prototype.render=function(){if(!this.props.pagingData)return null;var e=Object(Ve.a)(this.props.pagingData),t=0,r=0;e.totalResultCount&&(this.props.enhancedPagingDisabled?(t=e.pageSize*(this.props.currentPage-1)+1,r=this.props.currentPage*e.pageSize,-1!==e.totalResultCount&&this.props.currentPage*e.pageSize>e.totalResultCount&&(r=e.totalResultCount,this.props.isServerOffline&&this.props.currentPage>1&&(r=e.pageSize*(this.props.currentPage-1)+e.totalResultCount))):(t=e.pageSize*(this.props.pagingInfo.firstPageNumber-1)+1,r=this.props.pagingInfo.lastPageNumber*e.pageSize,this.props.pagingInfo.pageShift>0&&(t+=this.props.pagingInfo.pageShift,r+=this.props.pagingInfo.pageShift),-1!==e.totalResultCount&&this.props.pagingInfo.lastPageNumber*e.pageSize>e.totalResultCount&&(r=e.totalResultCount,this.props.isServerOffline&&this.props.currentPage>1&&(r=e.pageSize*(this.props.currentPage-1)+e.totalResultCount))));var n=e.totalResultCount,a=this._firstButtonEnabled(e),o=this._nextButtonEnabled(e),s=this._previousButtonEnabled(e);this._getResources();var l=n;-1===n&&(l=r<this.props.gridTotalRecordsCountLimit?this.props.gridTotalRecordsCountLimit:r);var u="";u=-1===n?String.format(this._totalApproximate,this.props.isServerOffline?r:l):this.props.isServerOffline&&n>e.pageSize?String.format(this._totalApproximate,r):String.format(this._totalExact,this.props.isServerOffline?r:n);var d=String.format(this._gridTotalCount,this._spaceResource,u),p=this.props.selectedRowCount>0?String.format(this._itemSelected,this._spaceResource,this.props.selectedRowCount):null,h=Object(x.c)(this.props.resourceStrings,De.g),g=String.format(h,this.props.currentPage),m=n/e.pageSize;return this.props.isServerOffline&&0!==this.props.currentPage&&(m=-1/e.pageSize),i.createElement(c.a,{style:this.props.styleProps.containerStyle},this._renderPagingText(t,r,d,p),this._renderPagingButtons(a,o,s,g,m))},t.prototype._renderPagingButtons=function(e,t,r,n,a){return(a<0||a>1)&&this.props.enhancedPagingDisabled?i.createElement(c.a,{style:this.props.styleProps.navigationPanelStyle},i.createElement(_e.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"loadFirstPage_"+this.props.id},accessibilityLabel:this._loadFirstPage,disabled:!e,tabIndex:0,onClick:this._goToFirstPage},i.createElement(Z.b,{type:p.a.FirstPageButton})),i.createElement(_e.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"moveToPreviousPage_"+this.props.id},accessibilityLabel:this._loadPreviousPage,disabled:!r,tabIndex:0,onClick:this._goToPreviousPage},i.createElement(Z.b,{type:p.a.BackButton})),i.createElement(u.a,{style:this.props.styleProps.pageNumberStyle,testhooks:{id:"pageNumber_"+this.props.id},role:we.a,notificationType:ze.b},null!==this.props.currentPage?String.format(n,this.props.currentPage):null),i.createElement(_e.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"moveToNextPage_"+this.props.id},accessibilityLabel:this._loadNextPage,disabled:!t,tabIndex:0,onClick:this._goToNextPage},i.createElement(Z.b,{type:p.a.Forward}))):null},t.prototype._renderPagingText=function(e,t,r,n){if(!this.props.pagingTextDisabled&&this.props.shouldPagingTextRender&&this.props.gridTotalRecordsCountLimit)return i.createElement(c.a,{style:this.props.styleProps.pagingTextStyle,testhooks:{id:"pagingText"}},i.createElement(u.a,null,String.format(this._gridInfoResource,e,t,r,n)))},t}(i.Component);var Ue=Object(s.a)((function(){var e,t,r,i=null,a=Object(x.h)(),o=(e=null,t=null,r={containerStyle:{justifyContent:"space-between",alignItems:"center",width:"100%"},navigationPanelStyle:{flexDirection:"row"},pageNumberStyle:{whiteSpace:"nowrap"},pagingButton:{borderStyle:"none",display:"inline-block",backgroundColor:"transparent",fontSize:"16px"}},function(i,a){var o,s,c,l,u,d,p,h,g,m,f,b,y=Object(Ie.b)(i)&&Object(G.a)(i,z.Fb,z.Lc)&&(null===(c=Object(Ie.a)(i))||void 0===c?void 0:c.Components)?Object(Ie.a)(i).Components:null;if(e!==a){e=a;var v=Object(Ce.a)(i),_=i.user.userSettings.isRTL,S=Object(n.__assign)(Object(n.__assign)({},r.containerStyle),{marginRight:v.sizes.Measures.Measure100,marginLeft:v.sizes.Measures.Measure100}),O=Object(n.__assign)(Object(n.__assign)({},r.navigationPanelStyle),((o={})["margin"+(_?"Right":"Left")]="auto",o)),C=Object(n.__assign)(Object(n.__assign)({},r.pageNumberStyle),{marginRight:v.sizes.Measures.Measure100,marginLeft:v.sizes.Measures.Measure100,fontSize:v.fontSizes.Font085,fontFamily:v.fontFamilies.Regular,color:(null===(u=null===(l=null==y?void 0:y.Grid)||void 0===l?void 0:l.Footer)||void 0===u?void 0:u.TextColor)||v.colors.BaseColor.Grey.Grey7}),I=Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},r.pagingButton),{color:(null===(p=null===(d=null==y?void 0:y.Grid)||void 0===d?void 0:d.Footer)||void 0===p?void 0:p.IconColor)||v.colors.BaseColor.Blue.Blue3,marginLeft:v.sizes.Measures.Measure050,marginRight:v.sizes.Measures.Measure050,width:"0px",fontSize:v.fontSizes.Font085,"[disabled]":{color:(null===(m=null===(g=null===(h=null==y?void 0:y.Grid)||void 0===h?void 0:h.Footer)||void 0===g?void 0:g.Disabled)||void 0===m?void 0:m.IconColor)||v.colors.BaseColor.Grey.Grey5}}),_&&{transform:"scaleX(-1)"}),j=((s={})["margin"+(_?"Left":"Right")]="auto",s.fontSize=v.fontSizes.Font085,s.fontFamily=v.fontFamilies.Regular,s.color=(null===(b=null===(f=null==y?void 0:y.Grid)||void 0===f?void 0:f.Footer)||void 0===b?void 0:b.TextColor)||v.colors.BaseColor.Grey.Grey7,s);t=Object(n.__assign)(Object(n.__assign)({},r),{containerStyle:S,navigationPanelStyle:O,pagingButton:I,pageNumberStyle:C,pagingTextStyle:j})}return t});return function(e,t){var r=o(e,t.contextString),n=Object(F.fb)(e,t.id,t.contextToken),s=n?n.length:0,c=a(e,De.k),l=Object(F.Y)(e,t.id,t.contextToken),u=Object(F.x)(e,t.id,t.contextToken);return i!==r&&(i=r),{selectedRowCount:s,resourceStrings:c,pagingData:l,currentPage:null===u?1:u,styleProps:i}}}),(function(e,t){return{retrieveResourceStrings:function(t){return e(Object(E.e)(t))},updatePageNumber:function(r){if(e(Object(Ne.b)(t.id,t.contextToken,r)),1===r&&t.enhancedPagingDisabled&&e(Object(Ge.b)(t.id,t.contextToken)),t.isGridRoot){var n=[{filterType:12,filterExpressionOrValue:r}];t.updateGridPaginationStateHandler(n,t.id)}return e(Object(Le.b)(t.id,t.contextToken,null)),e(Object(Be.b)(t.id,t.contextToken,[]))},setNewPageRequested:function(r){e(Object(Re.b)(t.id,t.contextToken,r))}}}))(He),qe=r("PBKq"),Xe=r("i6iy"),Ke=r("7EJx");var Qe=r("jf1O"),Ye=r("aPRd"),Ze=function(e){function t(t){var r=e.call(this,t)||this;return r._quickFindInnerTextRef=null,r._searchBarFocusTriggered=!1,r._onTextInputChange=r._onTextInputChange.bind(r),r._onkeyDown=r._onkeyDown.bind(r),r._onButtonClick=r._onButtonClick.bind(r),r._focusTextInput=r._focusTextInput.bind(r),r.updateSearchTextAndFind=r.updateSearchTextAndFind.bind(r),r.props.isGridPaginationStateFeatureEnabled&&r.props&&r.props.gridInput&&r.props.gridInput.quickFindExpression?r.state={quickFindText:r.props.gridInput.quickFindExpression.trim(),currentViewId:r.props.currentViewIdToRestore,clearQuickFind:!0}:r.state={quickFindText:null,currentViewId:null,clearQuickFind:!1},r}return Object(n.__extends)(t,e),t.prototype.clearSearchBar=function(){this.setState({quickFindText:null,clearQuickFind:!1})},t.prototype.updateSearchTextAndFind=function(e,t){var r=this;this.setState({quickFindText:e},(function(){t&&r._applyQuickFind()}))},t.prototype._onButtonClick=function(e){this.props.updateDataSetLoadingState(1),this.state.clearQuickFind?this._clearQuickFind():this._applyQuickFind()},t.prototype._onkeyDown=function(e){e.keyCode===Pe.a.Enter&&(this.props.updateDataSetLoadingState(1),this._applyQuickFind())},t.prototype._onTextInputChange=function(e){var t=""===e;this.setState({quickFindText:e,clearQuickFind:t})},t.prototype._applyFilter=function(){var e=this._formatQuickFindText(),t=Object(Fe.b)(e,this.props.primaryNameAttribute);this.props.applyGridFilter(t,this.props.contextToken)},t.prototype._clearFilter=function(){var e=this;this.setState({quickFindText:""},(function(){e._applyFilter()}))},t.prototype._formatQuickFindText=function(){return this.state.quickFindText.split("*").join("%").replace(/%?\s*$/,"%")},t.prototype._applyQuickFind=function(){var e=this;this.state.quickFindText&&""!==this.state.quickFindText.trim()?this.props.shouldUseFilter?(this._applyFilter(),this.setState({clearQuickFind:!0})):this.props.applyQuickFind(this.state.quickFindText,this.props.id,this.props.gridInput,this.props.contextToken,this.props.controlName,this.props.isGridPaginationStateFeatureEnabled).then((function(t){e.setState({clearQuickFind:!0}),e.state.currentViewId||e.setState({currentViewId:t})})):this._clearQuickFind()},t.prototype._clearQuickFind=function(){var e=this;this.props.shouldUseFilter?(this._clearFilter(),this.setState({clearQuickFind:!1})):this.props.clearQuickFind(this.state.currentViewId,this.props.id,this.props.gridInput,this.props.contextToken,this.props.controlName).then((function(){e.setState({quickFindText:"",currentViewId:null,clearQuickFind:!1})}))},t.prototype._getPlaceholderText=function(){return this.props.isGridSearchCanUseCurrentViewFeatureEnabled?this.props.shouldGridSearchUseCurrentView?Object(x.c)(this.props.resourceStrings,P.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT_SEARCH_THIS_VIEW):Object(x.c)(this.props.resourceStrings,P.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT_QUICK_FIND_VIEW):Object(x.c)(this.props.resourceStrings,P.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT)},t.prototype._createUniqueId=function(e){var t=this.props,r=t.contextToken,n=t.id;return r.controlName?e+"_"+r.controlName+"_"+n:e+"_"+n},t.prototype.render=function(){var e=this,t=this._getPlaceholderText(),r=Object(x.c)(this.props.resourceStrings,P.QUICK_FIND_TOOLTIP_CLEAR_BUTTON);if(this.props.showNewQuickFindSearchBarForMobile)return i.createElement(c.a,null,i.createElement(L.i,{placeholder:t,cancelText:Object(x.c)(this.props.resourceStrings,P.QUICK_FIND_CANCEL_LABEL_ID),clearText:r,applyQuickFind:this._applyQuickFind,windowWidth:this.props.viewPortWidth,updateSearchTextAndFind:this.updateSearchTextAndFind,value:this.state.quickFindText,quickFindRNStyleProps:this.props.quickFindRNStyleProps}));var n=this._createUniqueId("quickFind_text"),a=this._createUniqueId("quickFind_button"),o=this._createUniqueId("quickFind_button_icon"),s=Object(x.c)(this.props.resourceStrings,P.QUICK_FIND_TOOLTIP_APPLY_BUTTON),l=this.state&&this.state.clearQuickFind?r:s;return i.createElement(c.a,{style:this.props.styleProps.quickFindStyle,testhooks:{id:"data-set-quickFind-container"}},i.createElement(qe.a,{id:n,key:n,ref:function(t){e._quickFindInnerTextRef=t},testhooks:{id:n},value:this.state&&this.state.quickFindText?this.state.quickFindText:null,accessibilityLabel:t,onChangeText:this._onTextInputChange,onKeyDown:this._onkeyDown,style:this.props.styleProps.inputStyle,placeholder:t}),i.createElement(_e.a,{id:a,key:a,testhooks:{id:a},accessibilityLabel:l,title:l,onClick:this._onButtonClick,tabIndex:0,style:this.props.styleProps.buttonStyle},i.createElement(Z.b,{id:o,key:o,type:this.state&&this.state.clearQuickFind?p.a.Cancel:p.a.SearchButton,style:this.props.styleProps.buttonIconStyle})))},t.prototype._focusTextInput=function(){if(this.props.focusSearchBoxAfterRender&&!this._searchBarFocusTriggered){var e=a.findDOMNode(this._quickFindInnerTextRef);e&&(e.focus(),this._searchBarFocusTriggered=!0)}},t.prototype.componentDidMount=function(){this._focusTextInput()},t}(i.Component);Ze.displayName="DataSetQuickFind";var Je=Object(s.a)((function(){var e,t,r,i,a=null,o=null,s=null,c=(t=null,r=null,i={buttonStyle:{border:"none",padding:"0",backgroundColor:"transparent",flexDirection:"column","-webkit-appearance":"none"},inputStyle:{border:"none",backgroundColor:"transparent",width:"100%",minWidth:"0px","-webkit-appearance":"none","::-ms-clear":{display:"none"}},quickFindStyle:{borderWidth:"1px",borderStyle:"solid",display:"flex",flexDirection:"row",width:"100%"},buttonIconStyle:{fontWeight:"bold",marginTop:"auto",marginBottom:"auto",width:"100%"}},function(a,o){var s,c,l,u,d,p,h,g,m,f,b,y,v,_,S,O,C,I=Object(Ke.g)(a),j=Object(Ie.b)(a)&&Object(G.a)(a,z.Fb,z.Lc)&&(null===(c=Object(Ie.a)(a))||void 0===c?void 0:c.Components)?Object(Ie.a)(a).Components:null;if(j&&(i=Object.assign(i,{inputStyle:{color:null===(d=null===(u=null===(l=null==j?void 0:j.Grid)||void 0===l?void 0:l.ColumnHeader)||void 0===u?void 0:u.QuickFind)||void 0===d?void 0:d.TextColor,backgroundColor:null===(g=null===(h=null===(p=null==j?void 0:j.Grid)||void 0===p?void 0:p.ColumnHeader)||void 0===h?void 0:h.QuickFind)||void 0===g?void 0:g.BackgroundColor,borderColor:"transparent"},searchIconStyle:{color:null===(b=null===(f=null===(m=null==j?void 0:j.Grid)||void 0===m?void 0:m.ColumnHeader)||void 0===f?void 0:f.QuickFind)||void 0===b?void 0:b.IconColor},buttonIconStyle:{color:null===(_=null===(v=null===(y=null==j?void 0:j.Grid)||void 0===y?void 0:y.ColumnHeader)||void 0===v?void 0:v.QuickFind)||void 0===_?void 0:_.IconColor}})),t!==o||e!==I){t=o,e=I;var P=Object(Ce.a)(a),F=Object(n.__assign)(Object(n.__assign)({},i.buttonStyle),{":before":{content:"''",display:"inline-block",width:P.sizes.Measures.Measure250}}),T=Object(n.__assign)(Object(n.__assign)({},i.quickFindStyle),((s={borderColor:(null===(C=null===(O=null===(S=null==j?void 0:j.Grid)||void 0===S?void 0:S.ColumnHeader)||void 0===O?void 0:O.QuickFind)||void 0===C?void 0:C.BorderColor)||P.colors.BaseColor.Grey.Grey3})["padding"+(I?"Right":"Left")]=P.sizes.Measures.Measure025,s));r=Object(n.__assign)(Object(n.__assign)({},i),{buttonStyle:F,quickFindStyle:T})}return r}),l=Object(Qe.a)(),u=Object(x.h)(),d=null;return function(e,t){var r=c(e,t.contextString),n=l(e,t);s||(s=u(e,P.labelList)),a!==r&&(a=r),o!==n&&(o=n),d||(d=Object(G.c)(e,z.bd));var i=Object(G.a)(e,z.zb),p=null;i&&t.gridInput&&(p=(t.gridInput&&t.gridInput.viewId&&!S.a.isNullOrEmpty(t.gridInput.viewId)?t.gridInput.viewId:null)||Object(C.a)(e,t.entityTypeName,I.a.MAIN_APPLICATION_VIEW));return{quickFindText:"",currentViewId:null,clearQuickFind:!1,primaryNameAttribute:Object(A.E)(e,t.entityTypeName),styleProps:a,quickFindRNStyleProps:o,shouldUseFilter:!(Object(je.e)(t.contextString)||Object(je.d)(t.contextString)||Object(je.g)(t.contextString)&&d),resourceStrings:s,isGridPaginationStateFeatureEnabled:i,currentViewIdToRestore:p,shouldGridSearchUseCurrentView:Object(oe.l)(e),isGridSearchCanUseCurrentViewFeatureEnabled:Object(G.a)(e,z.Db,z.h),isQuickFindImprovementsFeatureEnabled:Object(G.a)(e,z.ad,z.tc),viewPortWidth:Object(Ye.c)(e)}}}),(function(e,t){return{applyQuickFind:function(r,n,i,a,o,s){if(i&&s){var c=[{filterType:1,filterExpressionOrValue:r}];i.entityTypeName===y.a&&c.push({filterType:2,filterExpressionOrValue:t.entityTypeName}),t.updateGridPaginationStateHandler(c,t.id),t.resetPagingInfoForEnhancedPaging()}return e(Object(Xe.a)(r,n,a,o))},clearQuickFind:function(r,n,i,a,o){if(i){t.updateGridPaginationStateHandler([{filterType:1,filterExpressionOrValue:null}],t.id)}return e(Object(Xe.b)(r,n,a,o))},applyGridFilter:function(r,n){e(Object(Oe.n)(r,t.id,n))}}}),null,{forwardRef:!0})(Ze);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var $e=function(e){return function(e,t,r,n,a,o){var s=(null==o?void 0:o.seeMoreTooltip)||Object(x.c)(t,P.SEE_MORE_TOOL_TIP),l=(null==o?void 0:o.seeMoreLabel)||Object(x.c)(t,P.SEE_MORE_LABEL),d=s;return(null==o?void 0:o.uniqueLabel)&&(d+=" "+o.uniqueLabel),i.createElement(c.a,{style:r},i.createElement(_e.a,{key:"seeMoreBtn",id:"seemore-btn",title:s,style:n,onClick:e,tabIndex:0,accessibilityLabel:d,describedByElementId:null},i.createElement(u.a,{style:a},l)))}(e.onSeeMoreClick,e.resourceStrings,e.containerStyle,e.buttonStyle,e.seeMoreTextStyle,e.localizedStrings)};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var et=r("s2by"),tt=r("/45f"),rt=r("sgPk"),nt=r("WS0f"),it=r("fE8x");var at=r("Cgjg"),ot=r("FPMG"),st=r("0bF2"),ct=r("bCrZ"),lt=r("Wye+"),ut=r("Ds7n"),dt=r("d26+"),pt=r("7oc5"),ht=r("tcXs"),gt=r("c0jI"),mt=r("t8f4"),ft=r("QAhb"),bt=r("8egQ");var yt=r("5cS+"),vt=r("whwt"),_t=r("ASFs"),St=r("Z46F"),Ot=r("LWFb"),Ct=r("kyRo"),It=r("buKK"),jt=r("+D0h"),Pt=r("6FBX"),Ft=r("LnR7"),Tt=r("pLx/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function wt(e){return i.createElement(le.a,{loader:function(){return Promise.all([r.e(9),r.e(10),r.e(11),r.e(13),r.e(12),r.e(14),r.e(15),r.e(17),r.e(21),r.e(34)]).then(r.bind(null,"GDLi")).then((function(e){return e.DataSetExpressionBuilder}))},props:e})}wt.displayName="DataSetExpressionBuilderLazyLoadComponent";var Et=r("/U1C"),xt=r("RrHr"),Nt=r("zpQF"),At=r("/0Gr"),kt=r("TUxu"),Mt=r("/j9Z"),Dt=r("VcAV"),Rt=r("swEE");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Bt(e){return i.createElement(le.a,{loader:function(){return Promise.all([r.e(9),r.e(10),r.e(11),r.e(13),r.e(12),r.e(14),r.e(16),r.e(113),r.e(33)]).then(r.bind(null,"pnQ/")).then((function(e){return e.ColumnEditor}))},props:e})}Bt.displayName="ColumnEditorLazyLoadComponent";var Lt=r("2Sll"),Vt=r("ozuu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
Object(Lt.a)();var zt=y.x+".DataSetHost",Gt=zt+".AdvancedFind.Open",Wt=zt+".AdvancedFind.Discard",Ht=function(e){function t(t){var r=e.call(this,t)||this;return r._quickFindCommandBarId="showQuickFind",r._changeVisualizationCommandBarId="changeVisualization",r._savedDefault=null,r._savedFormInfo=null,r._currentFilterValue=null,r._addedCommandListFromHost=[],r._addedCommandListFromControl=[],r._addedCommandListFromHostParent=[],r._memoizedConfiguration=null,r._memoizedResourceStrings=null,r._memoizedViewConfigurations=null,r._memoizedButtonList=null,r._parentSwitchVisualizationButton=null,r._keyIndex=0,r._width=0,r._height=0,r._isFirstRequestComplete=!1,r._isPreNavigationEventAttached=!1,r._offlineSqlQueryRetrieveState=0,r._dataSetQuickFindRef=i.createRef(),r._isSubGridFirstLoad=!1,r._minWidthForChartPlusGridReflow=640,r._isReflowLayoutVertical=!1,r._isSwitchVisualizationInitialized=!1,r._accessibilityId=1,r._incrementLastPage=function(){r.props.pageNumber===r.state.pagingInfo.lastPageNumber&&r.setState({pagingInfo:Object(n.__assign)(Object(n.__assign)({},r.state.pagingInfo),{lastPageNumber:r.state.pagingInfo.lastPageNumber+1})})},r._setFirstPage=function(e){r.setState({pagingInfo:Object(n.__assign)(Object(n.__assign)({},r.state.pagingInfo),{firstPageNumber:e})})},r._seeMorePopup=r._seeMorePopup.bind(r),r._onSendControlCommandsEventFired=r._onSendControlCommandsEventFired.bind(r),r._onSelectedOrderColumnChangeFired=r._onSelectedOrderColumnChangeFired.bind(r),r._onParentPagePreNavigationEventFired=r._onParentPagePreNavigationEventFired.bind(r),r._onFilterChange=r._onFilterChange.bind(r),r._onActivityTypeMenuDismissed=r._onActivityTypeMenuDismissed.bind(r),r._updateDataSetLoadingStateEvent=r._updateDataSetLoadingStateEvent.bind(r),r._updateFilterValue=r._updateFilterValue.bind(r),r._onRollupViewToggleChanged=r._onRollupViewToggleChanged.bind(r),r._onQuickFind=r._onQuickFind.bind(r),r._onItemIconPointerDown=r._onItemIconPointerDown.bind(r),r._onViewChanged=r._onViewChanged.bind(r),r._onControlLoadedError=r._onControlLoadedError.bind(r),r._updatePagingInfo=r._updatePagingInfo.bind(r),r._updateFilterExpressionStrings=r._updateFilterExpressionStrings.bind(r),r._configureDataSetControlParams=r._configureDataSetControlParams.bind(r),r._openManageDuplicatesDialog=r._openManageDuplicatesDialog.bind(r),r._showInnerError=r._showInnerError.bind(r),r._isInSeeMoreState=r._isInSeeMoreState.bind(r),r._getChartPaneText=r._getChartPaneText.bind(r),r.onMeasuring=r.onMeasuring.bind(r),r.closeFilterPanel=r.closeFilterPanel.bind(r),r._clearActivityTypeFilter=r._clearActivityTypeFilter.bind(r),r._updateCurrentPageNumber=r._updateCurrentPageNumber.bind(r),r._isNativePlatform=null!=t.platformType&&t.platformType===b.b.Native,r._currentPagingString=null,r._preSeeMoreCachedPagingString=null,r._boundOnRecordsSelected=null,r._pageNumberToRestoreForEnhancedPaging=r.props.pageNumberForEnhancedPaging,r._shouldResetPagingForEnhancedPaging=!1,r._previousSortingInfo=null,r._resetProcessedForEnhancedPaging=!0,r.state={quickFindVisibility:!1,addedCommandList:[],inSeeMoreState:!1,pagingInfo:{firstPageNumber:Object(nt.a)(r.props.pageNumberForEnhancedPaging)?1:r.props.pageNumberForEnhancedPaging,lastPageNumber:Object(nt.a)(r.props.pageNumberForEnhancedPaging)?1:r.props.pageNumberForEnhancedPaging,currentPageNumber:Object(nt.a)(r.props.pageNumberForEnhancedPaging)?1:r.props.pageNumberForEnhancedPaging,pageShift:0,isGridScrolledToBottom:!1},compositeControlInitState:k.a.Uninitialized,controlLoadErrorMessage:null,controlLoadInnerErrorMessage:null,loadingState:0,isFilterPanelOpen:!1,columnEditorPanelOpen:!1,isAdvancedFilterEdited:!1},r._parentDefinedProps={eventListeners:[{eventname:"sendgridcontrolcommandstohostcommandbar",eventhandler:[r._onSendControlCommandsEventFired]},{eventname:"onselectedordercolumnchange",eventhandler:[r._onSelectedOrderColumnChangeFired]},{eventname:"parentPagePreNavigation",eventhandler:[r._onParentPagePreNavigationEventFired]},{eventname:"sendpaginginfotopagingcontrol",eventhandler:[r._updatePagingInfo]},{eventname:"sendfilterexpressionstringstodatasethost",eventhandler:[r._updateFilterExpressionStrings]},{eventname:"updatedatasethostloadingstate",eventhandler:[r._updateDataSetLoadingStateEvent]},{eventname:"openmanageduplicatesdialog",eventhandler:[r._openManageDuplicatesDialog]},{eventname:"showinnererror",eventhandler:[r._showInnerError]},{eventname:"sendcurrentpagenumber",eventhandler:[r._updateCurrentPageNumber]}],containerStyleOverrides:{rootContainer:{flex:Object(je.e)(t.contextString)?"1 1 100%":"1 1 auto",minHeight:"0"}},onControlLoadedError:r._onControlLoadedError},r._seeMoreHelper=new f.a,r}return Object(n.__extends)(t,e),t.prototype._logInfo=function(e){this._tracer&&this._tracer.info(e)},t.prototype._updateDataSetLoadingStateEvent=function(e){this._updateDataSetLoadingState(e.value)},t.prototype._updateDataSetLoadingState=function(e,t){var r=this;void 0===t&&(t={}),(1===e&&this.props.featureControlProps.isGridProgressIndicatorFeatureEnabled||1!==e)&&(this.setState(Object.assign(t,{loadingState:e})),this._currentLoadingTimeoutIdentifier&&clearTimeout(this._currentLoadingTimeoutIdentifier),this._currentLoadingTimeoutIdentifier=null,1===e&&(this._currentLoadingTimeoutIdentifier=setTimeout((function(){r._updateDataSetLoadingState(2)}),3e4)))},t.prototype._openManageDuplicatesDialog=function(e){!this.props.isOffline&&e&&e.entityReference&&e.reject&&this.props.openManageDuplicatesDialog(e)},t.prototype._showInnerError=function(e){this.props.showInnerError(e)},t.prototype._updatePagingInfo=function(e){e&&e.currentPageNumber>0&&(this.props.setNewPageRequested(this.props.id,this.props.contextToken,!1),this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&(this._resetProcessedForEnhancedPaging||1!==e.currentPageNumber||(this._resetProcessedForEnhancedPaging=!0,this._pageNumberToRestoreForEnhancedPaging=1),this.props.pageNumberForEnhancedPaging!==e.currentPageNumber&&this.props.updatePageNumberForEnhancedPaging(e.currentPageNumber,this.props.contextToken)),Object(_t.e)(this.state.pagingInfo,e)||this.setState({pagingInfo:e}))},t.prototype._updateCurrentPageNumber=function(e){e&&e.currentPageNumber>0&&this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,e.currentPageNumber)},t.prototype._updateFilterExpressionStrings=function(e){if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&e&&(e.nativeFilterExpressionString||e.dataSetFilterExpressionString)){var t=[{filterType:5,filterExpressionOrValue:e.nativeFilterExpressionString},{filterType:6,filterExpressionOrValue:e.dataSetFilterExpressionString}];this.props.updateGridPaginationStateHandler(t,this.props.id),this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1)}},t.prototype._setResetPagingInfoForEnhancedPaging=function(){this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&this._isNativePlatform&&(this._shouldResetPagingForEnhancedPaging=!0)},t.prototype._resetPagingInfoForEnhancedPaging=function(){this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&this._isNativePlatform&&(this.setState({pagingInfo:{firstPageNumber:1,lastPageNumber:1,currentPageNumber:1,pageShift:0,isGridScrolledToBottom:!1}}),this._pageNumberToRestoreForEnhancedPaging=1)},t.prototype._onControlLoadedError=function(e){var t=e?e.message:null;this._logTelemetryData(t),this._setControlLoadError()},t.prototype._setControlLoadError=function(e){void 0===e&&(e=P.GRID_CONTROL_LOAD_ERROR),this.setState({controlLoadErrorMessage:Object(x.c)(this.props.resourceStrings,e)})},t.prototype._logTelemetryData=function(e){this._tracer&&this._tracer.error("Loading for the grid failed because of error :"+(e||"CustomControl_Calendar_ErrorView_DefaultMessage"))},t.prototype._renderTitle=function(){if(!this.props.descriptor)return null;var e=this.props.descriptor,t=e.ShowLabel,r=e.Name,n=e.Label,a=this._isWidthLessThanViewportSm()?this.props.styles.titleMobileStyle:this.props.styles.titleStyle;return t&&n?i.createElement(u.a,{key:r,semanticTag:"div",style:a},n):null},t.prototype.onMeasuring=function(e,t){if(this._height=t,!(Math.abs(this._width-e)<50)&&(this._width=e,!this._getCachedSize()||e!==this._getCachedSize().width||t&&t!==this._getCachedSize().height)){var r={},n=this._seeMoreHelper.shouldGivePoppedOutDimensions(!0),i=this._seeMoreHelper.getSeeMorePopupInfo(),a=n?i.endWidthInner:e,o=[];!this._isWidthInitialized()&&e>0&&(r.isWidthInitialized=!0,o.push("isWidthInitialized:"+r.isWidthInitialized));var s=a<=this.props.viewportSm;s!==this._isWidthLessThanViewportSm()&&(r.isWidthLessThanViewportSm=s,o.push("isWidthLessThanViewportSm:"+s));var c=a<=this.props.viewportM;c!==this._isWidthLessThanViewportM()&&(r.isWidthLessThanViewportM=c,o.push("isWidthLessThanViewportM:"+c));var l=a<this._minWidthForChartPlusGridReflow;l!==this._isWidthLessThanMinWidthForChartPlusGridReflow()&&(r.isWidthLessThanMinWidthForChartPlusGridReflow=l,o.push("isWidthLessThanMinWidthForChartPlusGridReflow:"+l));var u=this._jumpBarShouldRenderAsFlyout(a);u!==this._isJumpBarRenderingAsFlyout()&&(r.isJumpBarRenderingAsFlyout=u,o.push("isJumpBarRenderingAsFlyout:"+u));var d=a>480;d!==this._isWidthGreaterThan480()&&(r.isWidthGreaterThan480=d,o.push("isWidthGreaterThan480:"+d));var p=n?i.endHeightInner:t,h=p>240;h!==this._isHeightGreaterThan240()&&(r.isHeightGreaterThan240=h,o.push("isHeightGreaterThan240:"+h)),0!==e&&0!==t||this._tracer&&this._tracer.warn("The measuring service returned width or height as 0. The new dimensions are width is "+e+" and height is "+t);var g=!1,m=this.props.quickFindProps&&s&&!this._checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot();m!==this._showCommandBarButtonSearch()&&(r.showCommandBarButtonSearch=m,o.push("showCommandBarButtonSearch:"+m),g=!0);var f=Object(je.e)(this.props.contextString)||Object(je.d)(this.props.contextString)&&this.props.featureControlProps.isChartOnAssociatedGridEnabled;if(f!==this._showCommandBarButtonShowChart()&&(r.showCommandBarButtonShowChart=f,o.push("showCommandBarButtonShowChart:"+f),g=!0),o.length>0){o.push("currentWidth:"+e),o.push("currentHeight:"+t),o.push("usePoppedOutDimensions:"+n),o.push("newWidth:"+a),o.push("newHeight:"+p),o.push("commandBarNeedsUpdate:"+g);var b=o.join(",");this._logInfo("onMeasuring change: "+b)}this._getCachedSize()&&this._getCachedSize().update&&(this._cachedSize=this._getCachedSize().update({width:e,height:t,isWidthInitialized:e>0,isWidthLessThanViewportSm:s,isWidthLessThanViewportM:c,isWidthLessThanMinWidthForChartPlusGridReflow:l,isJumpBarRenderingAsFlyout:u,isWidthGreaterThan480:d,isHeightGreaterThan240:h,showCommandBarButtonSearch:m,showCommandBarButtonShowChart:f}));var y=r;g&&(y=Object.assign(y,this._getUpdateAddedCommandList(m,f))),Object.keys(y).length&&this.setState(y)}},t.prototype._getUpdateAddedCommandList=function(e,t){var r=this;if(this._addedCommandListFromHost=[],e&&(this._logInfo("Adding search button to commandbar for DataSethost."),this._addedCommandListFromHost.push({Icon:"SearchButton",DisplayText:Object(x.c)(this.props.resourceStrings,P.QUICK_FIND_COMMANDBAR_TEXT),Id:this._quickFindCommandBarId,execute:this._onQuickFind})),this.props.isQueryMode){this._logInfo("Adding clear query button to commandbar for DataSethost.");var n=this._getClearQueryText();this._addedCommandListFromHost.push({Icon:"ClearDefault",DisplayText:n,Tooltip:{title:n},Id:"ClearQuery",execute:function(){return r.props.clearQuery()}})}if(!this.props.isOffline&&t){this._logInfo("Adding show chart button to commandbar for DataSethost.");var i=this._getChartPaneText();this._addedCommandListFromHost.push({Icon:"SelectChart",DisplayText:i,Tooltip:{title:i},Id:"ShowChartPane",execute:function(){return r.props.toggleChartPane(r.props.id,r.props.contextToken,!r.props.showChart)}})}return this._onAddedCommandListChange(!1)},t.prototype._onViewChanged=function(e,t,r){var n,i=this;void 0===r&&(r=!0),r&&this._updateDataSetLoadingState(1);var a=this.props.descriptor?this.props.descriptor.Id:null;this._logInfo("The view for the grid changed. The new view parameters for the view are - NewViewId : "+e+", EntityTypeName : "+t+"and ControlName : "+a),this._resetPagingInfoForEnhancedPaging(),null===(n=this._dataSetQuickFindRef.current)||void 0===n||n.clearSearchBar();var o=this.props.gridInput&&this.props.gridInput.entityTypeName.toLowerCase()===F.a;this.props.updateView(this.props.id,a,e,t,this.props.commandBarProps&&this.props.commandBarProps.commandManagerId,this.props.contextToken,this.props.userId,this.props.featureControlProps&&this.props.featureControlProps.isQueueFilterPerfUCIEnabled,o).then((function(){i.props.nonCompositionProps&&i.props.nonCompositionProps.setPageInputViewId&&i.props.nonCompositionProps.setPageInputViewId(e),i.state.controlLoadErrorMessage&&i.setState({controlLoadErrorMessage:null})}),(function(e){i._logInfo(e.message),i._setControlLoadError()}))},t.prototype._onItemIconPointerDown=function(e,t,r,n,i){this._logInfo("Trying to set default view for user. The new view parameters for the view are - NewViewId : "+t+", EntityTypeName : "+e+", ViewType : "+r+"and Unpin  : "+i);var a=se(this._currentFilterValue);return this.props.updateUserDefaultGridView(e,t,r,n,a,i)},t.prototype._onQuickFind=function(){this.setState({quickFindVisibility:!this.state.quickFindVisibility})},t.prototype._getChartPaneText=function(){var e=this.props,t=e.resourceStrings;return e.showChart?Object(x.c)(t,P.CHARTS_HIDE_CHART_PANE_LABEL):Object(x.c)(t,P.CHARTS_SHOW_CHART_PANE_LABEL)},t.prototype._getClearQueryText=function(){return"Clear query"},t.prototype._updateFilterValue=function(e){this._currentFilterValue=e},t.prototype._onFilterChange=function(e,t){void 0===t&&(t=this.props.gridEntityTypeName),this._logInfo("Applying grid filter, the new value received is "+e),2===this.state.loadingState&&this._updateDataSetLoadingState(1),this._updateFilterValue(e);var r=Object(et.a)(this.props.viewSelectorProps.entityTypeName,this.props.userId,this.props.contextToken,this.props.featureControlProps.isQueueFilterPerfUCIEnabled,this.props.entityIsActivityType).getFilterExpression(e,this.props.userSetting,t);this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1),this._setResetPagingInfoForEnhancedPaging(),this.props.applyGridFilter(r,e,this.props.contextToken)},t.prototype._clearActivityTypeFilter=function(){this.props.applyActivityTypeFilter("","",this.props.contextToken)},t.prototype._onActivityTypeMenuDismissed=function(e){if(!this.props.isOffline){var t=e.join(","),r=function(e,t){if(null!=e){if(e.indexOf("selectAllKey")>-1||0===e.length||null!=t&&t.length===e.length)return null;for(var r=null,n=[],i=0;i<e.length;i++)n.push({attributeName:"activitytypecode",conditionOperator:0,value:e[i]});return n&&n.length>0&&(r={conditions:n,filterOperator:1}),r}}(e,this.props.entityFilterProps.filterOptionsForActivityType),n=r?JSON.stringify(r):"";void 0===this.props.entityFilterProps.activityTypePreviousValues?this.props.applyActivityTypeFilter(n,t,this.props.contextToken):t!==this.props.entityFilterProps.activityTypePreviousValues&&this._shouldActivitySelectAllFilterFire(t,this.props.entityFilterProps.activityTypePreviousValues,this.props.entityFilterProps.isActivityFilterSelectAllEnabled)&&(this._logInfo("Applying activity type grid filter, the new value received is "+t),2===this.state.loadingState&&this._updateDataSetLoadingState(1),this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1),this._setResetPagingInfoForEnhancedPaging(),this.props.applyActivityTypeFilter(n,t,this.props.contextToken));var i=[{name:"ActivityTypeFilterUsage",value:"Initiated"},{name:"SelectedActivityTypeFilterCount",value:e.length},{name:"ActivityTypeFilterDropDownCount",value:this.props.entityFilterProps.filterOptionsForActivityType.length}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentSuccess&&this.context.EventManager.ReportComponentSuccess(zt,i)}},t.prototype._shouldActivitySelectAllFilterFire=function(e,t,r){if(r){var n=!1,i=!1;return(t.indexOf("selectAllKey")>-1||""===t)&&(n=!0),(e.indexOf("selectAllKey")>-1||""===e)&&(i=!0),!(n&&i)}return!0},t.prototype._onRollupViewToggleChanged=function(e){this._logInfo("Toggling rollupView control, the new value received is "+e),this.props.toggleGridRollupView(e,this.props.contextToken)},t.prototype._updateFilterOnViewSelectorChange=function(e){this._logInfo("Updating dataset with the existing filter selection for activity pointer"),this._onFilterChange(this._currentFilterValue,e)},t.prototype._onSendControlCommandsEventFired=function(e){this._logInfo("Adding control commands to command bar. The command to be added are : "+e),e!==this._addedCommandListFromControl&&(this._addedCommandListFromControl=e,this._onAddedCommandListChange())},t.prototype._onSelectedOrderColumnChangeFired=function(e){if(this._logInfo("Updating jumpbar filter based on the selected order column"),this.props.featureControlProps.isJumpBarShouldHonorSortingFeatureEnabled&&this.props.jumpBarProps){var t=e.columnSortingName;t=Object(Fe.d)(t,e.columnSortingType,e.primaryNameAttribute);var r=Object(Fe.b)(this.props.jumpBarProps.selectedFilter,t);this.props.onSelectedOrderColumnChange(r,this.props.contextToken)}},t.prototype._onParentPagePreNavigationEventFired=function(e){var t=this;e&&Array.isArray(e)&&e.length>0&&!this._isPreNavigationEventAttached&&this.context&&this.context.Router&&this.context.Router.registerPreNavigationHandler&&(this._tracer&&this._tracer.info("Adding control preNavigation handlers to the router"),e.forEach((function(e){return t.context.Router.registerPreNavigationHandler((function(){try{return e()}catch(e){t.context&&t.context.EventManager&&t.context.EventManager.ReportComponentFailure&&t.context.EventManager.ReportComponentFailure(zt,e,null,[{name:"subComponent",value:"onPreNavigation"}])}return Promise.resolve(!0)}))})),this._isPreNavigationEventAttached=!0)},t.prototype._createSwitchVisualization=function(e,t){var r=this;return function(){switch(r._keyIndex++,r.props.contextString){case y.h.ASSOCIATEDGRID:r.props.switchAssociatedGridVisualization(r.props.id,r.props.entityTypeName,r.props.controlId,r.props.viewId,e,r.props.nonCompositionProps&&r.props.nonCompositionProps.viewConfigurations,r.props.nonCompositionProps&&r.props.nonCompositionProps.gridConfigurations,"VIEW_CONFIG"===t);break;case y.h.SUBGRID:r.props.switchSubgridVisualization(r.props.id,e,r.props.controlId);break;case y.h.GRID:default:if(r.props.featureControlProps.isGridPaginationStateFeatureEnabled&&r.props.gridInput){r.props.updateGridPaginationStateHandler([{filterType:3,filterExpressionOrValue:null}],r.props.id),r.props.setCustomFilter("",0,r.props.id,r.props.contextToken)}"VIEW_CONFIG"===t?r.props.switchViewConfiguration(r.props.id,r.props.contextToken,e,r.props.controlId,!1):r.props.switchHomepageConfiguration(r.props.id,r.props.contextToken,e,r.props.controlId,!0)}}},t.prototype._updateChangeVisualizationButtons=function(e){var t=this,r=this.props.nonCompositionProps&&this.props.nonCompositionProps.gridConfigurations,n=this.props.nonCompositionProps&&this.props.nonCompositionProps.viewConfigurations,i=!1;this._parentSwitchVisualizationButton||(this._parentSwitchVisualizationButton={Icon:"SelectChart",DisplayText:Object(x.c)(this.props.resourceStrings,P.SWITCH_VISUALIZATION_BUTTON_LABEL),Id:this._changeVisualizationCommandBarId+"-Parent",WillOpenFlyout:!0,Children:null}),this._memoizedConfiguration===this.props.updatedConfiguration&&this._memoizedViewConfigurations===n&&this._memoizedResourceStrings===this.props.switchVisualizationResourceStrings||this.props.switchVisualizationResourceStrings&&(this._memoizedConfiguration=this.props.updatedConfiguration,this._memoizedViewConfigurations=n,this._memoizedResourceStrings=this.props.switchVisualizationResourceStrings,this._memoizedButtonList=[],Object(gt.c)(r,n,this.props.updatedConfiguration,this.props,this.props.contextString,e).forEach((function(r){if(!(Object(gt.a)(t.props.updatedConfiguration,r.configuration)||r.configuration.isDefaultConfig&&t.props.updatedConfiguration.isDefaultConfig||t.props.featureControlProps.isDisableEditableGridControlOnPhoneFeatureEnabled&&Object(oe.g)(r.configuration,parseInt(e,10)))){var n={Icon:"SelectChart",DisplayText:""+Object(gt.b)(t.props.switchVisualizationResourceStrings,r.configuration),Id:t._changeVisualizationCommandBarId+"-"+r.configuration.Name+"-"+r.formFactor,execute:t._createSwitchVisualization(r.configuration,r.configurationType),IsInFlyout:!0};t._memoizedButtonList.push(n),i=!0}}))),!this._isSwitchVisualizationInitialized&&this.props.commandBarProps&&(Object(gt.d)(this.props.retrieveControlResourceStringsForSwitchVisualization,this.context,r,n,this.props.updatedConfiguration,this.props,this.props.contextString,e),this._isSwitchVisualizationInitialized=!0),this._parentSwitchVisualizationButton.Children=this._memoizedButtonList,i&&this._onAddedCommandListChange()},t.prototype._onAddedCommandListChange=function(e){var t,r,n,i;void 0===e&&(e=!0);var a=[],o=[],s=(null===(r=null===(t=this._parentSwitchVisualizationButton)||void 0===t?void 0:t.Children)||void 0===r?void 0:r.length)>0;if(this.props.featureControlProps.isShowAsButtonFirstEnabled&&s&&o.push(this._parentSwitchVisualizationButton),o.push.apply(o,this._addedCommandListFromControl),o.push.apply(o,this._addedCommandListFromHost),(null===(i=null===(n=this.props.nonCompositionProps)||void 0===n?void 0:n.addedCommandListFromHostParent)||void 0===i?void 0:i.length)>0&&a.push.apply(a,this.props.nonCompositionProps.addedCommandListFromHostParent),!this.props.featureControlProps.isShowAsButtonFirstEnabled&&s&&a.push(this._parentSwitchVisualizationButton),!e)return{addedCommandList:o,appendedCommandList:a};this&&this.setState&&this.setState({addedCommandList:o,appendedCommandList:a})},t.prototype._seeMoreCallback=function(e){this.setState({inSeeMoreState:!this.state.inSeeMoreState})},t.prototype._seeMorePopup=function(e,t){void 0===t&&(t=!1),!0===e?(this._preSeeMoreCachedPagingString=this._currentPagingString,this._currentPagingString=null):(this._currentPagingString=this._preSeeMoreCachedPagingString,this._preSeeMoreCachedPagingString=null),this._keyIndex++,this._seeMoreHelper.seeMorePopup(this._getDataSetHostRootElement(),this._seeMoreCallback.bind(this),e,t,this.props.isRTL)},t.prototype._getDataSetHostRootElement=function(){return a.findDOMNode(this)},t.prototype._onRecordsSelectedCallback=function(e,t){this._logInfo("onRecordsSelected for DataSetHost. New selected rows are "+t);for(var r=[],n=0,i=t;n<i.length;n++){var a=i[n];r.push(new S.a(a))}if(this.props.markSelectedRows(this.props.id,this.props.contextToken,r),e){var o=this.props.updatedConfiguration.Parameters[this.props.nestedGridDatasetName];this.props.markSelectedRelatedEntity(this.props.id,this.props.contextToken,o.TargetEntityType)}else this.props.markSelectedRelatedEntity(this.props.id,this.props.contextToken,null);this.props.isGridEditable&&t.length>0&&this.props.rowProperties(this.props.id,this.props.contextToken,r),this.props.isGridEditable&&(this._logInfo("Running onRecordSelect for EditableGrid"),this.props.runOnRecordSelect(this.props.id,this.props.contextToken,r)),!e&&this._onRecordsSelectedParent&&(this._logInfo("onRecordsSelected: Calling onRecordsSelected callback for the parent control"),this._onRecordsSelectedParent(t))},t.prototype.markGridFirstRequestComplete=function(){this._isFirstRequestComplete=!0},t.prototype._isDataSetHostKnownError=function(e){return!(!e||""===e)&&(-1!==e.indexOf(St.a.getHexErrorCodeFromInt(2415919120))||!(-1===e.indexOf(St.a.getHexErrorCodeFromInt(-2147093999))||this.props.offlineProps.isEntityAvailableForOffline&&this.props.offlineProps.isOfflineAvailableForUse))},t.prototype._onDataSetUpdateCallback=function(e){this._logInfo("DataSetUpdated for DataSetHost control");var t=[{name:"currentPagingString",value:e&&e.existedPagingString||""}];this.markGridFirstRequestComplete(),this._currentPagingString!==e.existedPagingString&&t.push({name:"previousPagingString",value:this._currentPagingString});var r=!1;e.error?(r=this._isDataSetHostKnownError(e.errorMessage)||!Object(Dt.b)(e.innerError),e.innerError&&t.push({name:"InnerErrorMessage",value:e.innerError}),this.context.EventManager.ReportComponentFailure(zt,new Error(e.errorMessage||""),null,t)):this.context.EventManager.ReportComponentSuccess(zt,t);var n={};if(r)n={compositeControlInitState:k.a.Error,controlLoadErrorMessage:e.errorMessage},e.innerError&&(n.controlLoadInnerErrorMessage=e.innerError);else{this.props.updateFetchXml(this.props.id,this.props.contextToken,e.fetchXmlInUse);var i=null;if(e.existedFilteringString){var a=JSON.parse(e.existedFilteringString);i=Object(g.j)(a,We.CrmXmlEncode),this.props.setCustomFilter(i,0,this.props.id,this.props.contextToken)}if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled){var o=[],s=!1,c=null;e.existedValidSortingArrayString&&(c=e.existedValidSortingArrayString);var l=!Object(nt.a)(c)&&JSON.parse(c);if(l&&l instanceof Array&&l.length>0&&c!==this.props.gridSortingInfo&&(this.props.gridInput&&o.push({filterType:7,filterExpressionOrValue:c}),s=!0),s){if(e.existedPagingString){var u=JSON.parse(e.existedPagingString);u.firstPageNumber&&(this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,u.firstPageNumber),this.props.gridInput&&this._setResetPagingInfoForEnhancedPaging())}this.props.gridInput&&this.props.updateGridPaginationStateHandler(o,this.props.id)}}this.props.updateQueryKey(e.newQueryKey,this.props.id,this.props.contextToken),this.props.updatePagingData(this.props.id,this.props.contextToken,e.existedPagingString),this.props.setNewPageRequested(this.props.id,this.props.contextToken,!1),this._logInfo("onDataSetUpdate: eventPagingString: "+e.existedPagingString),this._currentPagingString=e.existedPagingString}2!==this.state.loadingState?this._updateDataSetLoadingState(2,n):this.setState(n),this._accessibilityId++},t.prototype._configureDataSetControlParams=function(){if(this.props.updatedConfiguration){var e=this.props.updatedConfiguration.Parameters[this.props.primaryDataSetName];if(e){!Object(nt.a)(e.onRecordsSelected)&&Object(nt.a)(this._onRecordsSelectedParent)&&e.onRecordsSelected!==this._boundOnRecordsSelected&&(this._onRecordsSelectedParent=e.onRecordsSelected),this._isFirstRequestComplete&&(e.FirstDataRequestType=0),Object(nt.a)(this._boundOnRecordsSelected)&&(this._boundOnRecordsSelected=this._onRecordsSelectedCallback.bind(this,!1)),e.onRecordsSelected=this._boundOnRecordsSelected,e.onDataSetUpdate=this._onDataSetUpdateCallback.bind(this);var t=this.props.descriptor,r=1,n=this.state.pagingInfo.lastPageNumber;this.props.isGridEditable||this._isNativePlatform?this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this._isNativePlatform&&(r=this.state.pagingInfo.firstPageNumber):(r=this.props.pageNumber,n=this.props.pageNumber);var i={firstPageNumber:r,lastPageNumber:n,pageSize:!this._isInSeeMoreState()&&t&&t.Parameters&&t.Parameters[y.q]&&parseInt(t.Parameters[y.q],10)||this.props.recordsPerPageSetting,pagingRefreshInput:this.props.pagingRefreshInput?this.props.pagingRefreshInput.toString():""},a=Object(Ve.a)(this._currentPagingString);if(a&&a.pageSize&&(this._logInfo("Updating pageSize based on _receivedPagingStringData.pageSize to "+a.pageSize),i.pageSize=a.pageSize),e.PagingInput={Static:!0,Value:JSON.stringify(i)},this.props.refreshCounter){var o=this.props.refreshCounter.toString();if(e.RefreshInput={Value:parseInt(o,10),Static:!0},!Object(nt.a)(this.props.customFilter)&&!Object(nt.a)(this.props.customFilter.customFilterXml)&&this.props.customFilter.source&&1===this.props.customFilter.source){var s=Object(g.i)(this.props.customFilter.customFilterXml);e.FilteringInput={Static:!0,Value:JSON.stringify(s)}}}if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput){if(!Object(nt.a)(this.props.customFilter)&&!Object(nt.a)(this.props.customFilter.customFilterXml)){s=Object(g.i)(this.props.customFilter.customFilterXml);e.FilteringInput={Static:!0,Value:JSON.stringify(s)}}var c=!Object(nt.a)(this.props.gridSortingInfo)&&JSON.parse(this.props.gridSortingInfo),l=c&&c instanceof Array&&c.length>0,u=!Object(nt.a)(this._previousSortingInfo)&&JSON.parse(this._previousSortingInfo),d=u&&u instanceof Array&&u.length>0;(l||d&&this.props.gridSortingInfo!==this._previousSortingInfo)&&(this._previousSortingInfo=this.props.gridSortingInfo,e.SortingInput={Static:!0,Value:this.props.gridSortingInfo})}this.props.gridEntityTypeName&&(e.EntityName=this.props.gridEntityTypeName)}this._addExtraParametersToConfiguration();var p=this.props.updatedConfiguration.Parameters[this.props.nestedGridDatasetName];if(p&&(p.onRecordsSelected=this._onRecordsSelectedCallback.bind(this,!0),this.props.refreshCounter)){o=this.props.refreshCounter.toString();p.RefreshInput={Value:parseInt(o,10),Static:!0}}}},t.prototype._addExtraParametersToConfiguration=function(){if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&(this.props.updatedConfiguration.Parameters.NativeFilterExpressionToRestore={Usage:1,Static:!0,Value:this.props.nativeFilterExpression},!Object(nt.a)(this._pageNumberToRestoreForEnhancedPaging))){var e=this._pageNumberToRestoreForEnhancedPaging;this._pageNumberToRestoreForEnhancedPaging>1&&(this._shouldResetPagingForEnhancedPaging||!this._resetProcessedForEnhancedPaging)&&(this._shouldResetPagingForEnhancedPaging=!1,this._resetProcessedForEnhancedPaging=!1,e=-1),this.props.updatedConfiguration.Parameters.PageNumberToRestore={Usage:1,Static:!0,Value:e}}this.props.lookupAttributeForRecordHierarchy&&this.props.gridInput&&(this.props.updatedConfiguration.Parameters.LookupAttributeNameForHierarchy={Usage:1,Static:!0,Value:this.props.lookupAttributeForRecordHierarchy})},t.prototype._renderAccessibilityNotification=function(e){var t,r=e+"_accessibility",n={left:"-3000%",width:"0%",height:"0%",position:"absolute"};this.props.featureControlProps.isAssociatedGridHeightEnabled&&(n.overflow="hidden");var a=Object(x.c)(this.props.resourceStrings,P.GRID_LOADING_PLACEHOLDER).replace("{0}",this.props.entityDisplayName),o=2===this.state.loadingState?null!==(t=this.props.notificationMessage)&&void 0!==t?t:"":a;return i.createElement(c.a,{key:r+"_"+this._accessibilityId,id:r,style:n,role:we.s,notificationType:ze.b},o)},t.prototype._renderQuickFind=function(){var e=this._showNewQuickFindSearchBarForMobile();if(this.props.quickFindProps&&this._isWidthInitialized()){if(this._isWidthLessThanViewportSm()&&(this.state.quickFindVisibility||e)){var t=Object.assign(this.props.quickFindProps,{focusSearchBoxAfterRender:!0});return i.createElement(c.a,{key:"quickFind",style:this.props.styles.quickFindMobileStyle},i.createElement(Je,Object(n.__assign)({},t,{updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,resetPagingInfoForEnhancedPaging:this._resetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),ref:this._dataSetQuickFindRef,showNewQuickFindSearchBarForMobile:e})))}if(!this._isWidthLessThanViewportSm())return Object(je.g)(this.props.contextString)?i.createElement(c.a,{style:this.props.styles.quickFindContainerStyle},this._getQuickFind()):this._getQuickFind()}return null},t.prototype._renderAdvancedFilter=function(){var e=this;return this._isWidthInitialized()&&this.props.showAdvancedFilter&&this.props.quickFindProps&&i.createElement(_e.a,{key:"openAdvancedFilter",id:"open-advanced-filter",iconType:"filter",title:Object(x.c)(this.props.resourceStrings,Et.c.OpenAdvancedFiltersTitleAndAria),style:this.props.styles.advancedFilterButtonStyles,onClick:function(){e._renderAdvancedFindPanel()},tabIndex:0,accessibilityLabel:Object(x.c)(this.props.resourceStrings,Et.c.OpenAdvancedFiltersTitleAndAria)},i.createElement(Z.b,{id:"filter",accessibilityHidden:!0,type:p.a.Filter}))},t.prototype._renderAdvancedFindPanel=function(){var e,t=this;this._updateDataSetLoadingState(1);var r=[{name:"entityName",value:this.props.entityTypeName},{name:"ViewId",value:null===(e=this.props.viewId)||void 0===e?void 0:e.guid}];this.props.retrieveRelatedEntitiesMetadata(this.props.entityTypeName).then((function(){t.setState({isFilterPanelOpen:!0}),t._updateDataSetLoadingState(2),t.context.EventManager.ReportComponentSuccess(Gt,r)}),(function(e){t._tracer.error(null==e?void 0:e.message),t._updateDataSetLoadingState(2),t.context.EventManager.ReportComponentFailure(Gt,new Error(e),r)}))},t.prototype._renderDiscardChanges=function(){var e=this;if(this.props.showAdvancedFilter&&this.props.isViewEdited&&this._isWidthInitialized()&&!this.props.showColumnEditor)return i.createElement(_e.a,{key:"clearAdvancedFilter",id:"clear-advanced-filter",iconType:"clearFilter",title:Object(x.c)(this.props.resourceStrings,P.AdvancedFind_DiscardButton_Title),style:this.props.styles.advancedFilterButtonStyles,onClick:function(){var t;e.props.removeEditedViewPageMap(e.props.gridInput.pageToEditedViewMapId.guid,e.props.viewId),e._clearCustomFilterAndUpdateControlKeyIndex();var r=[{name:"entityName",value:e.props.entityTypeName},{name:"ViewId",value:null===(t=e.props.viewId)||void 0===t?void 0:t.guid}];e.context.EventManager.ReportComponentSuccess(Wt,r)},tabIndex:0,accessibilityLabel:Object(x.c)(this.props.resourceStrings,P.AdvancedFilter_DiscardButton_AccessibilityLabel)},i.createElement(Z.b,{id:"clearFilter",type:p.a.GlobalFilterClearAll}))},t.prototype._renderColumnEditor=function(){var e=this;if(this.props.showColumnEditor&&this._isWidthInitialized()){var t=Object(x.c)(this.props.resourceStrings,P.ColumnEditorButton);return i.createElement(Vt.a,{key:"columnEditorBtn",id:"columnEditor-btn",iconProps:{iconName:"ColumnOptions",style:{color:"black"}},title:t,"aria-label":t,onClick:function(){return e.setState({columnEditorPanelOpen:!0})},style:this.props.styles.columnEditorButtonStyle})}},t.prototype._clearCustomFilterAndUpdateControlKeyIndex=function(){var e=this;this.props.setCustomFilter("",0,this.props.id,this.props.contextToken).then((function(){e._keyIndex++,e._onViewChanged(e.props.viewId.guid,e.props.entityTypeName,!1)}))},t.prototype._getQuickFind=function(){return i.createElement(c.a,{key:"quickFind",style:this.props.styles.quickFindStyle},i.createElement(Je,Object(n.__assign)({},this.props.quickFindProps,{updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,resetPagingInfoForEnhancedPaging:this._resetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),ref:this._dataSetQuickFindRef})))},t.prototype._renderViewSelector=function(){if(this.props.viewSelectorProps&&this._isWidthInitialized()){var e=this._isWidthLessThanViewportSm()?this.props.styles.viewSelectorOuterMobileStyle:this.props.styles.viewSelectorOuterStyle;return i.createElement(c.a,{key:"viewSelector",style:e},i.createElement(K,Object(n.__assign)({isGridRoot:Object(je.e)(this.props.contextString)},this.props.viewSelectorProps,{isTablet:this._isWidthLessThanViewportM(),isPhone:this._isWidthLessThanViewportSm(),key:"dataSetHostView",onChange:this._onViewChanged,onItemIconPointerDown:this._onItemIconPointerDown,rootZIndex:this._isInSeeMoreState(),isRTL:this.props.isRTL,removeEditedViewPageMap:this.props.removeEditedViewPageMap})))}return this._renderTitle()},t.prototype._renderQueueFilter=function(){if((this.props.entityTypeName===Pt.Bb||this.props.entityTypeName===Ft.a)&&this.props.queueFilterProps&&this._isWidthInitialized()){var e=this._isWidthLessThanViewportSm()?this.props.styles.filterContainerMobileStyle:this.props.styles.filterContainerStyle;return i.createElement(ce,Object(n.__assign)({},this.props.queueFilterProps,{key:"queueFilter",onFilterChange:this._onFilterChange,updateFilterValue:this._updateFilterValue,resourceStrings:this.props.resourceStrings,style:e,isGridPaginationStateFeatureEnabled:this.props.featureControlProps.isGridPaginationStateFeatureEnabled}))}return null},t.prototype._renderEntityFilter=function(){if(this.props.entityFilterProps&&this._isWidthInitialized()){var e=this._isWidthLessThanViewportSm(),t=e?this.props.styles.filterContainerMobileStyle:this.props.styles.filterContainerStyle,r=this.props.styles.activityTypeFilterContainerStyle;return i.createElement(me,Object(n.__assign)({},this.props.entityFilterProps,{onToggleChange:this._onRollupViewToggleChanged,key:"EntityFilterDataSet",onFilterChange:this._onFilterChange,onActivityTypeChange:this._onActivityTypeMenuDismissed,onActivityTypeFilterClear:this._clearActivityTypeFilter,gridEntityName:this.props.gridEntityTypeName,resourceStrings:this.props.resourceStrings,containerStyle:t,activityTypeContainerStyle:r,rootZIndex:this._isInSeeMoreState(),isGridPaginationStateFeatureEnabled:this.props.featureControlProps.isGridPaginationStateFeatureEnabled,isMobile:e}))}return null},t.prototype._renderDataSetChart=function(){return this.props.chartProps&&this._isWidthInitialized()?(this.props.chartProps.isLayoutVertical=this._isReflowLayoutVertical,i.createElement(_,Object(n.__assign)({},this.props.chartProps,{style:this._isReflowLayoutVertical?this._isWidthLessThanViewportSm()?this.props.styles.reflowChartMobileStyle:this.props.styles.reflowChartStyle:this.props.styles.chartStyle,key:"pageChartDataSet",closeChartPaneHandler:this.props.toggleChartPane}))):null},t.prototype._renderBackButtonForGridInMobile=function(){return this.props.commandBarProps&&this._isWidthInitialized()&&Object(je.e)(this.props.contextString)&&this._isWidthLessThanViewportSm()&&this.props.backButtonEnabled?i.createElement($.a,{pageId:this.props.id,overwriteStyle:{borderWidth:0,height:"auto",padding:0,margin:"-8px 0"}}):null},t.prototype._renderCommandBar=function(){var e=this;if(!this.props.commandBarProps||!this._isWidthInitialized())return null;this._commandBarLoadedPromise||(this._commandBarLoadedPromise=new Promise((function(t){e._commandBarLoadedResolve=t}))),this._commandManagerId=this._commandManagerId||this.props.commandBarProps.commandManagerId||Object(fe.a)();var t=this.props.styles.commandManagerContainerStyle,r=this.props.styles.commandBarStyle;this._isWidthLessThanViewportSm()&&(t=this.props.styles.commandManagerContainerMobileStyle,r=this.props.styles.commandBarMobileInnerStyle);var a=Object(je.e)(this.props.contextString);return Object(Y.b)(this.props.commandBarRefreshProps,r,this._isWidthLessThanViewportSm(),t),i.createElement(ie,Object(n.__assign)({},this.props.commandBarProps,{key:"commandBarDataSet",addedCommandList:this.state.addedCommandList,appendedCommandList:this.state.appendedCommandList,metaDataLoadedResolve:this._commandBarLoadedResolve,commandManagerId:this._commandManagerId,style:t,commandbarStyles:r,rootZIndex:this._isInSeeMoreState(),customControlType:this.props.updatedConfiguration.CustomControlId,isGridRoot:a,collapsed:this._isWidthLessThanViewportSm(),isNativeMode:this._isNativeSubgrid()}))},t.prototype._renderFooter=function(){var e=!1;if(this.props.totalResultCount<=this.props.pageSize&&!this.props.totalRecordCountLimitExceeded&&Object(je.g)(this.props.contextString)&&!this._isInSeeMoreState()&&!this.props.jumpBarProps&&!(e=this._shouldRenderSeeMoreButton()))return this._logInfo("Hiding the footer for the subgrid because there is less than 2 pages of data"),null;if(this._isWidthInitialized()&&(this.props.jumpBarProps||this.props.pagingProps)){var t=this._isJumpBarRenderingAsFlyout()?this.props.styles.footerMobileStyle:this.props.isGridEditable?this.props.styles.footerEditableGridStyle:Object(n.__assign)(Object(n.__assign)({},this.props.styles.footerOuterStyle),this.props.jumpBarProps?this.props.styles.defaultFooterHeightStyle:this.props.styles.jumpBarLessFooterHeightStyle);if(!this.props.isGridEditable)return this._hideJumpbarForMobile()?null:i.createElement(c.a,{key:"dataSetFooter_"+this.props.id,style:t},!e&&this._renderJumpBar(),i.createElement(c.a,{key:"dataSetPagingContainer_"+this.props.id,style:this.props.styles.footerPagingContainer},this._renderPaging(e),this._renderSeeMoreButton()));if(this.props.jumpBarProps)return i.createElement(c.a,{key:"dataSetFooter_"+this.props.id,style:t},this._renderJumpBar());this._logInfo("Hiding the footer for the editable grid because the jump bar props is null")}return this._logInfo("Hiding the footer for the grid because the width for the controld is 0 or the jump bar props is null or paging props is null"),null},t.prototype._jumpBarShouldRenderAsFlyout=function(e){var t=Object(x.c)(this.props.resourceStrings,P.JUMPBAR_ALPHABET);if(t){var r=t.split(","),n=e-100,i=this._isJumpBarRenderingAsFlyout()?.5:-.5;return!!r&&n/r.length<=32+i}return!1},t.prototype._renderJumpBar=function(){var e=null;return this._isJumpBarRenderingAsFlyout()&&(e=this.props.styles.jumpBarButtonContainerStyle),this.props.jumpBarProps?i.createElement(c.a,{key:"jumpBar_"+this.props.id,style:e},i.createElement(Me,Object(n.__assign)({},this.props.jumpBarProps,{rootZIndex:this._isInSeeMoreState(),controlKey:this.props.controlKey,renderMobile:this._isJumpBarRenderingAsFlyout(),isDeviceSizeSmall:!this._isWidthGreaterThan480(),isRTL:this.props.isRTL,isGridRoot:Object(je.e)(this.props.contextString),updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,setResetPagingInfoForEnhancedPaging:this._setResetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),isMobile:this._isWidthLessThanViewportM()}))):null},t.prototype._renderPaging=function(e){var t=Object(je.f)(this.props),r=!this.props.hasCustomDataProvider&&Object(nt.a)(this.props.totalRecordCountLimitExceeded);return t&&this._logInfo("Hiding the paging button for the grid because the sharepoint grid does not support paging"),this.props.pagingProps?i.createElement(Ue,Object(n.__assign)({},this.props.pagingProps,{pagingInfo:this.state.pagingInfo,shouldPagingTextRender:!e,incrementLastPage:this._incrementLastPage,setFirstPage:this._setFirstPage,enhancedPagingDisabled:!e&&!t&&!this._isNativePlatform,pagingTextDisabled:r,gridTotalRecordsCountLimit:this.props.gridTotalRecordsCountLimit,isGridRoot:Object(je.e)(this.props.contextString),updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),isServerOffline:this.props.isOffline})):null},t.prototype.renderDataSetHostComponent=function(e,t,r,a,o){var s,u,d,g,f=this,b=[],v=this._isWidthLessThanViewportSm();this._isReflowLayoutVertical=!(!this._isWidthLessThanMinWidthForChartPlusGridReflow()||!this.props.chartProps);try{var _=this._getDataSetHostErrorMessage();if(Object(nt.a)(_)||this.state.compositeControlInitState===k.a.Initializing){if(this._isWidthInitialized()||Object(je.g)(this.props.contextString)&&this.state.compositeControlInitState!==k.a.Initializing){this._isShowChartChanged&&(this._getUpdateAddedCommandList(this._showCommandBarButtonSearch(),this._showCommandBarButtonShowChart()),this._onAddedCommandListChange(),this._isShowChartChanged=!1);var S=(Object(je.e)(this.props.contextString)||Object(je.d)(this.props.contextString))&&this.props.entityIsActivityType;v||Object(je.g)(this.props.contextString)?(this.props.viewSelectorProps||this.props.quickFindProps||this.props.entityFilterProps||this.props.queueFilterProps||this.props.commandBarProps)&&(this.props.featureControlProps.isInMobileModeForOct2019&&Object(je.e)(this.props.contextString)&&(o=Object(n.__assign)(Object(n.__assign)({},o),{display:"none"})),b.push(i.createElement(c.a,{key:"dataSetHeader_"+this.props.id,style:r},this._renderHeader([this._renderBackButtonForGridInMobile(),this._renderViewSelector(),this._renderCommandBar()],o),this._renderQuickFind(),S||this.props.entityFilterProps&&this.props.entityFilterProps.isRollupViewSupported&&this.props.contextString===y.h.ASSOCIATEDGRID?this._renderEntityFilter():this._renderQueueFilter()))):(b.push(this._renderCommandBar()),(this.props.viewSelectorProps||this.props.quickFindProps||this.props.entityFilterProps||this.props.queueFilterProps)&&b.push(i.createElement(c.a,{key:"dataSetHeader_"+this.props.id,style:r},this._renderHeader([this._renderViewSelector(),this._renderDiscardChanges(),this._renderColumnEditor(),this._renderAdvancedFilter(),this._renderQuickFind()],o),S||this.props.entityFilterProps&&this.props.entityFilterProps.isRollupViewSupported&&this.props.contextString===y.h.ASSOCIATEDGRID?this._renderEntityFilter():this._renderQueueFilter())));var O=this.props.chartProps&&this._isReflowLayoutVertical?this.props.styles.reflowdataSetContentBodyStyle:this.props.styles.dataSetContentBodyStyle;if(this.props.featureControlProps.isAssociatedGridHeightEnabled&&Object(je.d)(this.props.contextString)&&(O=Object(n.__assign)(Object(n.__assign)({},O),{flexBasis:"0px"})),this.props.chartProps&&!this._isReflowLayoutVertical&&this.props.featureControlProps.isSuiterChartEnabled||this._showNewQuickFindSearchBarForMobile()){O=Object(n.__assign)(Object(n.__assign)({},O),{borderTop:"1px solid #d8d8d8"})}var C=(null===(g=null===(d=null===(u=this.props)||void 0===u?void 0:u.configuration)||void 0===d?void 0:d.Parameters)||void 0===g?void 0:g.EnableSubGridAutoCollapse)&&this.props.configuration.Parameters.EnableSubGridAutoCollapse,I=C&&C.Value,j=this.props.featureControlProps.isSubGridAutoCollapseEnabled&&Object(je.g)(this.props.contextString)&&"true"===I;j&&0===this.props.totalResultCount&&(O=Object(n.__assign)(Object(n.__assign)({},O),{display:"none"})),this.props.featureControlProps.isSubGridRemoveMinHeightEnabled&&j&&(O=Object(n.__assign)(Object(n.__assign)({},O),{minHeight:"0px"}));var F=v&&Object(je.e)(this.props.contextString),T=this._parentDefinedProps;this.props.parentDefinedControlProps&&(T.height=this.props.parentDefinedControlProps.height>0&&this._seeMoreHelper.getSeeMorePopupStatus()===m.b.NotInUse?this.props.parentDefinedControlProps.height:void 0,T.width=this.props.parentDefinedControlProps.width>0&&this._seeMoreHelper.getSeeMorePopupStatus()===m.b.NotInUse?this.props.parentDefinedControlProps.width:void 0,T.decorators=this.props.parentDefinedControlProps.decorators,T.propertyBagOverrides=this.props.parentDefinedControlProps.propertyBagOverrides),T.parentInSeeMoreMode=this._seeMoreHelper.getSeeMorePopupStatus()!==m.b.NotInUse,T.containerStyleOverrides=this._getCombinedContainerStyleOverrides();var w=null;this.props.chartProps&&this._isWidthInitialized()&&(w={width:"70%"});var E=Ae.a.getInstance().get_IsBrowserIE()?Object.assign(a,{flex:"1 1 100%"}):a;b.push(i.createElement(c.a,{key:"dataSetContentBody_"+this.props.id,style:O},this._renderDataSetChart(),i.createElement(c.a,{key:"dataSetBody_"+this.props.id,style:!0===this._isReflowLayoutVertical?this.props.styles.reflowGridStyle:Object.assign(E,w),className:this._isInSeeMoreState()?"seeMore":void 0,testhooks:{id:"data-set-body-container"}},i.createElement(h.c,{key:this.props.controlKey+this._keyIndex,controlId:this.props.controlId,id:this.props.id,formInfo:this._savedFormInfo,configuration:this.props.updatedConfiguration,descriptor:this.props.descriptor?this.props.descriptor:this._savedDefault,systemDefinedProperties:this.props.systemDefinedProperties,rowSpan:this.props.rowSpan,parentDefinedControlProps:T,parentContextToken:this.props.contextToken,contextString:this.props.contextString,externalCommandManagerId:this._commandManagerId,externalCommandPromise:this._commandBarLoadedPromise,shouldRender:this.props.nonCompositionProps?this.props.nonCompositionProps.shouldRender:void 0}),F?null:this._renderFooter()))),F&&b.push(this._renderFooter()),b.push(this._renderAccessibilityNotification(e)),b=b.concat(this._renderAccessibilityComponent(e))}}else if(2!==this.state.loadingState&&this._updateDataSetLoadingState(2),b.push(i.createElement(c.a,{key:"dataSetHeader_"+this.props.id,style:r},this._renderHeader([this._renderViewSelector()],o))),this._isWidthInitialized()){var N={fontSize:this._isHeightGreaterThan240()&&this._isWidthGreaterThan480()?"4.5em":"2em",color:"red"},A=Object(x.c)(this.props.resourceStrings,P.SEE_MORE_DETAILS);b.push(i.createElement(c.a,null,i.createElement(l.a,{id:"gridErrorContainer"+this.props.id,text:_,icon:p.a.DetailsPageClose,iconStyle:N}),this.state.controlLoadInnerErrorMessage&&!this._isDataSetHostKnownError(this.state.controlLoadErrorMessage)&&i.createElement(c.a,{style:{display:"flex",justifyContent:"center"}},i.createElement(ve.a,{key:"gridInnerErrorMessage",href:"#",accessibilityLabel:A,onClick:function(){f.props.showInnerError(f.state.controlLoadInnerErrorMessage)}},A))))}var M=Object(n.__assign)(Object(n.__assign)({},t),this.state.controlLoadInnerErrorMessage&&{backgroundColor:"#FFFFFF"});return i.createElement(c.a,{style:M,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0,id:e,key:e,testhooks:(s={id:e},s[Ot.b]=this.props.previewId,s[Ot.c]=20,s),semanticTag:this.props.semanticTag},b)}catch(e){this._onControlLoadedError(e)}},t.prototype._getDataSetHostErrorMessage=function(){var e,t=null;if(this.props.hasReadRolePrivilege)if(this.props.isUCIEntity||this.props.hasCustomDataProvider)if(this.props.offlineProps.isOfflineSqlQueryAvailable)t=this.props.isOffline&&this.state.controlLoadErrorMessage&&!this.props.hasCustomDataProvider?this.props.offlineProps.isEntityAvailableForOffline?this.props.offlineProps.isOfflineAvailableForUse?this.state.controlLoadErrorMessage:Object(x.c)(this.props.resourceStrings,P.OFFLINE_NOT_READY_FOR_USE):Object(x.c)(this.props.resourceStrings,P.ENTITY_NOT_AVAILABLE_IN_PROFILE):this.state.controlLoadErrorMessage;else{var r="";this.props.offlineProps.offlineErrorMessageKey&&(r=Object(x.c)(this.props.resourceStrings,this.props.offlineProps.offlineErrorMessageKey)),r||(r=Object(x.c)(this.props.resourceStrings,P.VIEW_NOTAVAILABLE_IN_OFFLINE)),t=r}else{var n=this.props.entityDisplayName?this.props.entityDisplayName:this.props.entityTypeName,i=Object(x.c)(this.props.resourceStrings,P.UCI_DISABLED_ENTITY_ERROR);t=String.format(i,n)}else t=Object(x.c)(this.props.resourceStrings,P.READ_PRIVILEGE_VIOLATION_KEY);return Object(nt.a)(t)||null===(e=this._tracer)||void 0===e||e.error(zt+"._getDataSetHostErrorMessage : "+t,this.props.isOffline&&this.props.offlineProps.offlineGridErrorTelemetryParams),t},t.prototype._renderHeader=function(e,t){void 0===e&&(e=[]);var r=(e||[]).filter((function(e){return!!e}));return r.length?i.createElement(c.a,{key:"dataSetHeaderInner_"+this.props.id,style:t},r):null},t.prototype._getParentDefinedPropsDecoratorValue=function(e){return this.props.parentDefinedControlProps&&this.props.parentDefinedControlProps.decorators&&this.props.parentDefinedControlProps.decorators[e]},t.prototype._shouldRenderSeeMoreButton=function(){return this._getParentDefinedPropsDecoratorValue("ShowSeeMore")&&!!this.props.totalResultCount},t.prototype._renderSeeMoreButton=function(){var e=Object(je.g)(this.props.contextString),t=Object(je.d)(this.props.contextString),r=this._seeMoreHelper.getSeeMorePopupStatus(),n=Object(je.f)(this.props);return!((e||t)&&!n)||r===m.b.PopFadeIn||r===m.b.PoppedOut||r===m.b.ReturnFadeOutAndMove||this.props.totalResultCount>=0&&this.props.totalResultCount<=this.props.pageSize&&!this._shouldRenderSeeMoreButton()||!this._isNativePlatform?(this._logInfo("Hiding the See more button for the grid because the grid does not support see more or there is less than 2 pages of data"),null):i.createElement($e,{onSeeMoreClick:this._seeMorePopup.bind(this,!0,!1),resourceStrings:this.props.resourceStrings,containerStyle:this.props.styles.seeMoreButtonContainerStyle,buttonStyle:this.props.styles.seeMoreButtonStyle,seeMoreTextStyle:this.props.styles.seeMoreButtonTextStyle,localizedStrings:this._getSeeMoreLocalizedStrings()})},t.prototype._getSeeMoreLocalizedStrings=function(){var e=null;return this.props.viewSelectorProps&&this.props.viewSelectorProps.title?e=this.props.viewSelectorProps.title:this.props.descriptor.ShowLabel&&this.props.descriptor.Label?e=this.props.descriptor.Label:this.props.entityDisplayName&&(e=this.props.entityDisplayName),this._isNativeSubgrid()?{uniqueLabel:e,seeMoreLabel:Object(x.c)(this.props.resourceStrings,P.SEE_ALL_LABEL),seeMoreTooltip:Object(x.c)(this.props.resourceStrings,P.SEE_ALL_TOOL_TIP)}:{uniqueLabel:e}},t.prototype._isStreamOnSuiterDashboard=function(){return this.props.featureControlProps.isSuiterDashboardEnabled&&Object(je.g)(this.props.contextString)&&this.props.configuration&&this.props.configuration.Parameters&&this.props.configuration.Parameters.UseDefaultCardFormForList&&this.props.configuration.Parameters.UseDefaultCardFormForList.Value},t.prototype._renderProgressIndicator=function(){var e="datasethost-progress-indicator";this.props.descriptor&&(e+="-"+this.props.descriptor.Id);var t=Object(n.__assign)({},this.props.styles.dataSetChangingProgressIndicatorContainerStyle),r=this.props.styles.progressIndicatorContainerStyle;return 1===this.state.loadingState?(t.width=this._width,t.height=Math.max(this._height,100)):0===this.state.loadingState&&this._isStreamOnSuiterDashboard()&&(r=Object(n.__assign)(Object(n.__assign)({},r),{borderBottom:"none"})),i.createElement(c.a,{key:"progressIndicatorContainer",id:"progressIndicatorContainer",style:0===this.state.loadingState?r:t},i.createElement(c.a,{key:"progressIndicator",id:"progressIndicator",style:0===this.state.loadingState?this.props.styles.progressIndicatorStyle:this.props.styles.dataSetChangingProgressIndicatorStyle},i.createElement(d.a,{key:e,id:e,testhooks:{id:e},style:this.props.styles.datasethostProgressIndicatorStyle,progressType:"ring",displayDelay:0===this.state.loadingState&&2e3,active:!0})))},t.prototype.componentWillUnmount=function(){this._seeMoreHelper&&this._seeMoreHelper.destroy(),clearTimeout(this._statusTimeout),this._statusTimeout=null},Object.defineProperty(t.prototype,"_tracer",{get:function(){return this.context?this.context.TraceManager.getTracer(y.z):null},enumerable:!1,configurable:!0}),t.prototype._updateStatus=function(e){var t=this;this.state.statusMessage===e||this._isSubGridFirstLoad||(clearTimeout(this._statusTimeout),this._statusTimeout=setTimeout((function(){return t.setState({statusMessage:e})}),1e3))},t.prototype.render=function(){var e,t,r,a,o,s=this;if(Object(nt.a)(this.props.updatedConfiguration))return this._logInfo("DataSetHost not rendered. Configuration is null"),null;if(!this.props.isInitialized&&this.props.contextToken&&this.props.primaryDataSetName&&this.state.compositeControlInitState!==k.a.Error){var l=this.props.updatedConfiguration.Parameters[this.props.primaryDataSetName];if(!l)return this._logInfo("DataSetHost not rendered. DataSet is not initialized and configuration does not contain primary dataset name."),null;if(this.state.compositeControlInitState===k.a.Uninitialized){this.setState({compositeControlInitState:k.a.Initializing});var d=this.props.viewId?this.props.viewId:l.ViewId?S.a.parse(l.ViewId):null,p=this.props.gridEntityTypeName||l.TargetEntityType||l.EntityName;if(!p&&!this.props.hasCustomDataProvider)return this._tracer&&this._tracer.error("DataSetHost not rendered. Reason: entityName unknown"),null;this.props&&this.props.hasCustomDataProvider&&this._logInfo("render: Initializing DataSetHost, id "+this.props.controlId+", for custom data provider"),this._logInfo("Initializing grid for "+d+" view and "+p+" entity."),this.props.initializeGrid(d,p,this.props.commandBarProps&&this.props.commandBarProps.commandManagerId,this.props.contextToken).then((function(){s._logInfo("Initialized grid for "+d+" view and "+p+" entity."),s.setState({compositeControlInitState:k.a.Initialized})}),(function(e){var t=e instanceof Error?e.message:e;-1!==tt.c.indexOf(t)?s._setControlLoadError(t):s._tracer&&s._tracer.error("Grid initialization failed. Reason: "+t),s.setState({compositeControlInitState:k.a.Error})}))}return this._logInfo("DataSetHost not rendered. Either state is not initialized or resource strings are not initialized"),null}if(this.props&&this.props.nonCompositionProps&&this.props.nonCompositionProps.addedCommandListFromHostParent&&this._addedCommandListFromHostParent!==this.props.nonCompositionProps.addedCommandListFromHostParent&&(this._addedCommandListFromHostParent=this.props.nonCompositionProps.addedCommandListFromHostParent,this._onAddedCommandListChange()),this.props.descriptor&&this.props.descriptor.Parameters){var h=this.props.descriptor.Parameters[y.c];if(this._isWidthLessThanViewportSm()&&h&&"false"===h)return this._logInfo("DataSetHost not rendered. Available on phone is set to false"),null}this._configureDataSetControlParams(),this._updateViewSelectorProps(this.props),!this.props.viewId||!(null===(e=this.props.nonCompositionProps)||void 0===e?void 0:e.setPageInputViewId)||this.props.viewId.guid===(null===(r=null===(t=this.props.gridInput)||void 0===t?void 0:t.viewId)||void 0===r?void 0:r.guid)&&(null===(a=this.props.gridInput)||void 0===a?void 0:a.viewType)||this.props.savedQueryType===I.a.QUICKFIND_SEARCH||this.props.nonCompositionProps.setPageInputViewId(this.props.viewId.guid),this._savedDefault&&this.props.controlId===this._savedDefault.Id||(this._savedDefault={Id:this.props.controlId,HasContext:!0,Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1}),this.props.formInfo&&(this._savedFormInfo=this.props.formInfo,null!=this.props.ribbonId&&(this._savedFormInfo.RibbonId=this.props.ribbonId));var g=this.props.descriptor&&this.props.descriptor.DomId&&this.props.descriptor.Id?this.props.descriptor.DomId.includes(this.props.descriptor.Id)?this.props.descriptor.DomId:this.props.descriptor.Id:this.props.id,f="dataSetRoot_"+g,b=this.props.styles,v=b.containerStyle,_=b.headerStyle,O=this.props.styles,C=O.rootStyle,j=O.headerInnerStyle,P=O.bodyStyle;this._updateChangeVisualizationButtons(this.props.updatedConfiguration.FormFactor.toString());var F=v,T={shadowStyle:null,innerStyle:null,outerStyle:null};this._isWidthLessThanViewportSm()&&(P=this.props.styles.bodyMobileStyle,j=this.props.styles.headerInnerMobileStyle);var w=this._seeMoreHelper.getSeeMorePopupStatus(),E=this._seeMoreHelper.getSeeMorePopupInfo();w!==m.b.NotInUse&&(T=m.a.getCustomControlFancyPopoutStyles(this.props.renderer,w,E),w!==m.b.ReturnFadeIn&&(F={height:E.startHeight,width:E.startWidth},C=Object(n.__assign)(Object(n.__assign)({},C),{height:E.endHeightInner-48})));var x=this.renderDataSetHostComponent(f,C,_,P,j),N=(this._getDataSetHostRootElement(),this._seeMorePopup.bind(this,!1)),A=this.props.isRTL,M=function(e,t,r,n,a,o,s,l){void 0===l&&(l=!1);var u=a||o,d="DataSetHostContainer";return i.createElement(c.a,{key:d,id:d+"_"+s,style:u,testhooks:{id:d}},e.renderCloseButton(n,!0,!1,l),e.renderSpacer(!0,!1),t)}(this._seeMoreHelper,x,0,N,T.innerStyle,C,f,A),D=Object(n.__assign)({},T.outerStyle?T.outerStyle:C);0===this.state.loadingState?(D.visibility="hidden",D.maxHeight="0"):1===this.state.loadingState&&(D=Object(n.__assign)(Object(n.__assign)({},D),{opacity:"0.6",pointerEvents:"none",minHeight:this._height}));var R=function(e,t,r,n){var a=t||{width:"100%"},o=n?we.e:null;return i.createElement(c.a,{key:"DataSetHostOuterContainer",id:r+"_outer",style:a,role:o},e)}(M,D,f,(null===(o=this._seeMoreHelper)||void 0===o?void 0:o.getSeeMorePopupStatus())!==m.b.NotInUse),B=function(e,t){return t=t||{display:"none"},i.createElement(c.a,{key:"shadow",id:e?e+"shadow":null,style:t})}(f,T.shadowStyle),L="datassethost_root_view_"+g+"_"+f,V=Ae.a.getInstance().get_IsBrowserIE()&&Object(je.g)(this.props.contextString)?{overflow:"visible"}:{},z=this.props.styles.mobileSubGridContainerStyles,G=Object.assign(F,V);return this._isNativePlatform&&Object(je.g)(this.props.contextString)&&this.props.featureControlProps.isInMobileModeForApril2020&&this.props.featureControlProps.isSubgridImprovementsEnabled&&(G=Object(n.__assign)(Object(n.__assign)({},G),z)),i.createElement(c.a,{key:L,style:G},i.createElement(u.a,{role:we.s,notificationType:ze.b,style:{left:"-3000%",width:"0%",height:"0%",position:"absolute"}},this.state.statusMessage),B,R,this.props.showAdvancedFilter&&this.state.isFilterPanelOpen&&i.createElement(wt,{controlId:this.props.controlId,controlKey:this.props.controlKey,id:this.props.id,contextToken:this.props.contextToken,entityTypeName:this.props.entityTypeName,fetchXML:this.props.fetchXML,filterPanelOpen:this.state.isFilterPanelOpen,viewId:this.props.viewId,gridInput:this.props.gridInput,updateFetchXml:this.props.updateFetchXml,updatePageInput:this.props.updatePageInput,closeFilterPanel:this.closeFilterPanel,onViewChanged:this._onViewChanged,setAdvancedPanelApplyClick:function(){s._clearCustomFilterAndUpdateControlKeyIndex(),s.setState({isAdvancedFilterEdited:!0})},originalView:this.props.originalView,resourceStrings:this.props.resourceStrings,telemetryMonitorAdvancedFindDiscard:Wt,resetAdvancedFilter:function(){return s.setState({isAdvancedFilterEdited:!1})}}),this.props.showColumnEditor&&i.createElement(Bt,{entityTypeName:this.props.entityTypeName,onViewChanged:this._onViewChanged,columnEditorPanelOpen:this.state.columnEditorPanelOpen,columnEditorPanelDismiss:function(){return s.setState({columnEditorPanelOpen:!1})},viewId:this.props.viewId,pageId:this.props.id,gridInput:this.props.gridInput,updatePageInput:this.props.updatePageInput,fetchXML:this.props.fetchXML,isAdvancedFindFilterEdited:this.state.isAdvancedFilterEdited}),2!==this.state.loadingState?this._renderProgressIndicator():null)},t.prototype.componentDidMount=function(){this._getUpdateAddedCommandList(this._showCommandBarButtonSearch(),this._showCommandBarButtonShowChart())},t.prototype.closeFilterPanel=function(){this.setState({isFilterPanelOpen:!1})},t.prototype.componentWillReceiveProps=function(e){var t=this;(Object(je.e)(this.props.contextString)||Object(je.g)(this.props.contextString)||Object(je.d)(this.props.contextString))&&!this.props.isOffline&&e.isOffline&&0===this._offlineSqlQueryRetrieveState&&this.props.offlineProps.isEmptyOfflineSqlQuery&&(this._offlineSqlQueryRetrieveState=1,this.props.retrieveView(this.props.entityTypeName,this.props.savedQueryType,this.props.viewType,this.props.viewId,!1).then((function(){t._offlineSqlQueryRetrieveState=2;var e=[{name:"scenario",value:"Called retrieveView"},{name:"entityTypeName",value:t.props.entityTypeName},{name:"viewId",value:S.a.toString(t.props.viewId)}];t.context&&t.context.EventManager&&t.context.EventManager.ReportComponentSuccess&&t.context.EventManager.ReportComponentSuccess(zt+".componentWillReceiveProps",e)})).catch((function(e){t._offlineSqlQueryRetrieveState=2;var r=[{name:"scenario",value:"Called retrieveView"},{name:"error",value:e&&e.message},{name:"entityTypeName",value:t.props.entityTypeName},{name:"viewId",value:S.a.toString(t.props.viewId)},{name:"viewType",value:t.props.viewType},{name:"savedQueryType",value:t.props.savedQueryType}];t.context&&t.context.EventManager&&t.context.EventManager.ReportComponentFailure&&t.context.EventManager.ReportComponentFailure(zt+".componentWillReceiveProps",e,null,r)}))),this._isShowChartChanged=this.props.showChart!==e.showChart},t.prototype.shouldComponentUpdate=function(e){return this.props.entityTypeName===F.a&&this.props.gridEntityTypeName!==e.gridEntityTypeName&&this._currentFilterValue?(this._updateFilterOnViewSelectorChange(e.gridEntityTypeName),!1):1!==this._offlineSqlQueryRetrieveState&&(0!==e.refreshCounter&&this.props.refreshCounter!==e.refreshCounter&&2===this.state.loadingState&&this._updateDataSetLoadingState(1),!0)},t.prototype.componentDidUpdate=function(){this._seeMoreHelper.getSeeMorePopupStatus()!==m.b.NotInUse&&this._seeMoreHelper.checkOnPopupStatus(!0,!1,this._getDataSetHostRootElement());var e=Object(x.c)(this.props.resourceStrings,P.GRID_LOADING_PLACEHOLDER).replace("{0}",this.props.entityDisplayName),t=2===this.state.loadingState?this.props.notificationMessage:e;Object(je.g)(this.props.contextString)&&(0===this.state.loadingState?this._isSubGridFirstLoad=!0:1===this.state.loadingState&&(this._isSubGridFirstLoad=!1)),this._updateStatus(t)},t.prototype._renderAccessibilityComponent=function(e){var t=e+"Accessibility";if(Object(je.e)(this.props.contextString)){var r=[];if(this.props.viewSelectorProps){var n=this.props.viewSelectorProps.id;r.push(i.createElement(Te.a,{key:t,rootElementId:e,isModal:!1,shouldManageFocus:!0,defaultFocusId:n}))}else r.push(i.createElement(Te.a,{key:t,rootElementId:e,isModal:!1,shouldManageFocus:!0}));return r}return null},t.prototype._isInSeeMoreState=function(){var e=this._seeMoreHelper.getSeeMorePopupStatus();return e!==m.b.NotInUse&&e!==m.b.ReturnFadeOutAndMove&&e!==m.b.ReturnFadeIn},t.prototype._isNativeSubgrid=function(){return Object(je.g)(this.props.contextString)&&this.props.clientHostSubtype===Rt.a.Phone&&this.props.featureControlProps.isInMobileModeForOct2019&&this.props.featureControlProps.isInMobileModeForApril2020&&this.props.featureControlProps.isSubgridImprovementsEnabled},t.prototype._getCombinedContainerStyleOverrides=function(){var e=this._parentDefinedProps.containerStyleOverrides,t=this.props.parentDefinedControlProps&&this.props.parentDefinedControlProps.containerStyleOverrides;return Object.assign(e,t,{rootContainer:Object.assign(e.rootContainer,{flex:Object(je.e)(this.props.contextString)||this._isInSeeMoreState()?"1 1 100%":"1 1 auto"},t&&t.rootContainer),primaryInnerContainer:this._isInSeeMoreState()?{flex:"1 1 100%",minHeight:"0"}:{}})},t.prototype._updateViewSelectorProps=function(e){if(e.descriptor&&e.viewSelectorProps&&e.descriptor.Parameters){var t=e.descriptor.Parameters[y.B],r=t?t.toString().split(","):null,n=r?r.map((function(e){return S.a.tryParse(e)})):null;e.viewSelectorProps.viewIds=n||null}},t.prototype._getCachedSize=function(){return this._cachedSize||(this._cachedSize=this.props.cachedSize),this._cachedSize},t.prototype._isWidthInitialized=function(){return this.state.isWidthInitialized||this._getCachedSize()&&this._getCachedSize().isWidthInitialized||!1},t.prototype._isWidthLessThanViewportSm=function(){return this.state.isWidthLessThanViewportSm||this._getCachedSize()&&this._getCachedSize().isWidthLessThanViewportSm||!1},t.prototype._isWidthLessThanViewportM=function(){return this.state.isWidthLessThanViewportM||this._getCachedSize()&&this._getCachedSize().isWidthLessThanViewportM||!1},t.prototype._isWidthLessThanMinWidthForChartPlusGridReflow=function(){return this.state.isWidthLessThanMinWidthForChartPlusGridReflow||this._getCachedSize()&&this._getCachedSize().isWidthLessThanMinWidthForChartPlusGridReflow||!1},t.prototype._isWidthGreaterThan480=function(){return this.state.isWidthGreaterThan480||this._getCachedSize()&&this._getCachedSize().isWidthGreaterThan480||!1},t.prototype._isHeightGreaterThan240=function(){return this.state.isHeightGreaterThan240||this._getCachedSize()&&this._getCachedSize().isHeightGreaterThan240||!1},t.prototype._showCommandBarButtonSearch=function(){return this.state.showCommandBarButtonSearch||this._getCachedSize()&&this._getCachedSize().showCommandBarButtonSearch||!1},t.prototype._showCommandBarButtonShowChart=function(){return this.state.showCommandBarButtonShowChart||this._getCachedSize()&&this._getCachedSize().showCommandBarButtonShowChart||!1},t.prototype._isJumpBarRenderingAsFlyout=function(){return this.state.isJumpBarRenderingAsFlyout||this._getCachedSize()&&this._getCachedSize().isJumpBarRenderingAsFlyout||!1},t.prototype._hideJumpbarForMobile=function(){return this.props.featureControlProps.isJumpbarFeatureForMobileEnabled&&this._isWidthLessThanViewportSm()&&(Object(je.e)(this.props.contextString)||Object(je.d)(this.props.contextString))&&this.props.featureControlProps.isInMobileModeForApril2020},t.prototype._showNewQuickFindSearchBarForMobile=function(){var e,t;return this._checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot()&&this._isWidthLessThanViewportSm()&&((null===(e=this.props.configuration)||void 0===e?void 0:e.CustomControlId)===y.p||(null===(t=this.props.configuration)||void 0===t?void 0:t.Name)===y.m)},t.prototype._checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot=function(){return this.props.featureControlProps.isQuickFindImprovementsEnabled&&this.props.featureControlProps.isInMobileModeForApril2020&&Object(je.e)(this.props.contextString)},t}(i.Component);function Ut(e,t){return i.createElement(Ht,Object(n.__assign)({},e,{renderer:t.renderer}))}Ht.displayName="DataSetHost",Ht.contextType=Ct.a,Ut.contextTypes={renderer:o.object};var qt=Object(s.a)(je.i,(function(e,t){return{initializeGrid:function(r,n,i,a){var o=rt.a.fromXmlAndSql("","",r).getQueryState(),s=t.descriptor&&t.descriptor.Parameters?t.descriptor.Parameters[y.r]:null,c=t.descriptor&&t.descriptor.Parameters&&t.descriptor.Parameters[y.s]?parseInt(t.descriptor.Parameters[y.s],10):null;i||(i=Object(oe.c)(t.id,a));var l=e(Object(ct.d)(o,n,t.id,a,t.descriptor,s,c,void 0,i)),u=e(Object(yt.b)(n,r,t.id)),d=e(Object(E.e)(P.labelList));return Promise.all([l,d,u])},removeEditedViewPageMap:function(t,r){return e(Object(xt.c)(t,r.guid))},updatePageInput:function(t,r){return e(Object(Nt.b)(t,r))},updateView:function(r,n,i,a,o,s,c,l,u){var d=e(Object(lt.a)(r,s,n,i,a)).then((function(){return e(Object(ht.a)(r,o))})),p=S.a.tryParseOrNull(i),h=e(Object(yt.b)(a,p,r)),g=Promise.resolve(null);if(u){var m=Object(et.a)(a,c,s,l,!0);g=e(m.getFilterOptionsAction())}return Promise.all([d,h,g]).then((function(){if(Object(je.e)(t.contextString)){t.updateGridPaginationStateHandler([{filterType:0,filterExpressionOrValue:null}],t.id)}e(Object(Oe.m)("",r,s)),e(Object(Oe.n)("",r,s)),e(Object(Oe.j)("",r,s)),e(Object(at.b)("",0,r,s))}))},retrieveView:function(t,r,n,i,a){return e(Object(w.a)(t,r,n,i,!1))},markSelectedRows:function(t,r,n){return e(Object(Be.b)(t,r,n))},markSelectedRelatedEntity:function(t,r,n){return e(Object(Le.b)(t,r,n))},rowProperties:function(t,r,n){return e(Object(ut.b)(t,r,n))},updateFetchXml:function(t,r,n){return e(Object(dt.b)(t,r,n))},applyGridFilter:function(r,n,i){if(Object(je.e)(t.contextString)){var a=[{filterType:8,filterExpressionOrValue:r},{filterType:11,filterExpressionOrValue:n}];t.updateGridPaginationStateHandler(a,t.id)}e(Object(Oe.k)(n,t.id,i)),e(Object(Oe.l)(r,t.id,i))},applyActivityTypeFilter:function(r,n,i){if(Object(je.e)(t.contextString)){var a=[{filterType:9,filterExpressionOrValue:r},{filterType:10,filterExpressionOrValue:n}];t.updateGridPaginationStateHandler(a,t.id)}e(Object(Oe.h)(n,t.id,i)),e(Object(Oe.i)(r,t.id,i))},onSelectedOrderColumnChange:function(r,n){e(Object(Oe.o)(r,t.id,n))},toggleGridRollupView:function(r,n){e(Object(pt.b)(r,t.id,n))},updatePagingData:function(t,r,n){return e(Object(ot.b)(t,r,n))},updateQueryKey:function(t,r,n){e(Object(st.b)(t,r,n))},setCustomFilter:function(t,r,n,i){return e(Object(at.b)(t,r,n,i))},runOnRecordSelect:function(r,n,i){e(function(e,t,r,n,i){return{type:"dataset.run.on.record.select",sync:!0,execute:function(i,a){var o=i.dispatch,s=i.getState,c=a.TraceManager.getTracer(y.z),l=y.x+".RunOnRecordAction";try{if(a&&a.ScriptManager){var u=a.ScriptManager.getContainer(e);if(u&&n&&1===n.length){var d=Object(it.c)(s()),p=Object(it.b)(s());d&&(o(u.getEventManager().addGridOnRecordSelectHandlers(t)),o(u.getEventManager().addGridOnChangeHandlers(t))),(d||p)&&o(u.getEventManager().runOnRecordSelect(t,r)),c.info("Triggered the action for {0} selected records"+n.length),a.EventManager.ReportComponentSuccess(l)}}}catch(e){var h="Triggered action for selected records failed with error : "+e.message;a.EventManager.ReportComponentFailure(l,Error(h))}}}}(r,n,n.controlName?n.controlName:"entity_control",i,Object(je.e)(t.contextString)||Object(je.g)(t.contextString)))},retrieveRelatedEntitiesMetadata:function(t){return e(Object(At.a)(t))},switchHomepageConfiguration:function(t,r,n,i,a){e(Object(gt.g)(t,r,n,i,a))},switchViewConfiguration:function(t,r,n,i,a){e(Object(gt.i)(t,r,n,i,a))},switchSubgridVisualization:function(t,r,n){e(Object(gt.h)(t,r,n))},switchAssociatedGridVisualization:function(t,r,n,i,a,o,s,c){e(c?Object(gt.f)(t,r,n,i,a,o,s):Object(gt.e)(t,r,n,a,s))},toggleChartPane:function(t,r,n){e(Object(vt.b)(t,r,n))},clearQuery:function(){e(Object(Tt.a)())},updateUserDefaultGridView:function(t,r,n,i,a,o){return e(function(e,t,r,n,i,a){return{type:"grid.update.userdefaultview",execute:function(o,s){var c=s.TraceManager.getTracer(y.z),l=y.x+".updateUserDefaultGridViewAction";try{c.info("Updating the user default view for the grid.");var u=o.getState(),d=new ft.a("usersettings",Object(Ke.q)(u)),p=Object(A.h)(u,e);if(!d||!p.ObjectTypeCode)return Promise.resolve();a&&(t="",r="",i=[],n="");for(var h=[],g=0,m=i;g<m.length;g++){var f=m[g],b=S.a.tryParse(f),v=S.a.externalGuid(b);h.push(v)}var _=String.format("<DefaultGridViews><DefaultGridView><EntityTypeCode>{0}</EntityTypeCode><ChildEntityName>{1}</ChildEntityName><QueueId>{2}</QueueId><ViewId>{3}</ViewId><ViewType>{4}</ViewType></DefaultGridView></DefaultGridViews>",p.ObjectTypeCode,n||"",1===h.length?h.toString():"",S.a.externalGuid(S.a.tryParse(t)),r);o.dispatch(Object(mt.f)(d,{personalizationsettings:_}));var O={ViewId:t,ViewType:+r,QueueId:i.toString()};return o.dispatch(Object(bt.f)(O,e)),s.EventManager.ReportComponentSuccess(l),Promise.resolve()}catch(e){var C="Failed to update user default grid view with error : "+e.message;s.EventManager.ReportComponentFailure(l,Error(C))}}}}(t,r,n,i,a,o))},updateCurrentPageNumber:function(t,r,n){return e(Object(Ne.b)(t,r,n))},setNewPageRequested:function(t,r,n){e(Object(Re.b)(t,r,n))},retrieveControlResourceStringsForSwitchVisualization:function(t){var r=t.filter((function(e){return null!=e}));return e(Object(E.e)(r))},updatePageNumberForEnhancedPaging:function(e){if(Object(je.e)(t.contextString)){var r=[{filterType:12,filterExpressionOrValue:e}];t.updateGridPaginationStateHandler(r,t.id)}},openManageDuplicatesDialog:function(t){e(Object(It.a)(null,null,ft.a.fromExternalEntityReference(t.entityReference))).then((function(r){if(0===r.status)return e(Object(jt.a)(r.pageId)).then((function(e){"ignore_save"===e.value.param_lastButtonClicked&&t.reject()}))}))},showInnerError:function(r){var n=new Mt.a(r,null,null,null,null,{stack:r+" "+(new Error).stack,message:r});e(Object(kt.a)(t.id,n))}}}))(Ut)},otMa:function(e,t,r){"use strict";r.d(t,"c",(function(){return s})),r.d(t,"e",(function(){return c})),r.d(t,"b",(function(){return l})),r.d(t,"a",(function(){return u})),r.d(t,"d",(function(){return d}));var n=r("rn9m"),i=r("Roat"),a=r("U56z"),o="customcontrol.propertybag.device.isoperationavailable";function s(){return{type:o,execute:function(e,t){return new n.a(t,e).isOperationAvailable(a.b.getBarcodeValue.name)},sync:!0}}function c(){return{type:o,execute:function(e,t){return new i.a(t,e).isOperationAvailable(a.f.takePicture.name)},sync:!0}}function l(){return{type:o,execute:function(e,t){return new i.a(t,e).isOperationAvailable(a.f.captureVideo.name)},sync:!0}}function u(){return{type:o,execute:function(e,t){return new i.a(t,e).isOperationAvailable(a.f.captureAudio.name)},sync:!0}}function d(){return{type:o,execute:function(){return!1},sync:!0}}},ovDt:function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n=r("c/eZ"),i=r("nuS9"),a=r("4fxQ"),o=r("4E+q"),s=r("gvL4"),c=r("H/hG"),l=r("YWpA"),u=r("Wi7Z"),d=r("1AYO"),p=r("ar+e"),h=r("9rQ4"),g=r("MGMD"),m=r("7sMj"),f=r("nVTU"),b=r("hp1u"),y=function(e){function t(t){var r=e.call(this,t)||this;return r._keyDownHandler=r._keyDownHandler.bind(r),r}return Object(n.__extends)(t,e),t.prototype.render=function(){var e,t=this;if(!this.props.relatedEntityItem)return null;var r=null;if(this.props.relatedEntityItem&&this.props.relatedEntityItem.webResourceIcon)r=i.createElement(b.a,{source:this.props.relatedEntityItem.webResourceIcon,style:this.props.style.navLinkImageStyle});else if(this.props.relatedEntityItem.isCustomEntity){var a={entityReference:new f.a(this.props.relatedEntityItem.entityName)},o=i.createElement(m.a,Object(n.__assign)({},a));r=i.createElement(c.a,{key:this.props.relatedEntityItem.id+"_Related",id:this.props.relatedEntityItem.id+"_Related",style:this.props.style.entityIconStyle}," ",o," ")}else r=this.props.relatedEntityItem.icon?i.createElement(c.a,{key:this.props.relatedEntityItem.id+"_Related",id:this.props.relatedEntityItem.id+"_Related",style:this.props.style.entityIconStyle},this.props.relatedEntityItem.icon):i.createElement(l.a,{key:this.props.relatedEntityItem.id+"_Related",id:this.props.relatedEntityItem.id+"_Related",style:this.props.style.tileStyle,testhooks:{id:this.props.relatedEntityItem.id}});return i.createElement(l.a,Object(n.__assign)({key:this.props.relatedEntityItem.id,id:this.props.relatedEntityItem.id,style:this.props.style.sectionStyle,role:u.n,accessibilityLabel:this.props.relatedEntityItem.title+" "+this.props.relatedItemsArea,tabIndex:0,onClick:function(){return t.props.handleRelatedEntityCallBack(t.props.relatedEntityItem)},onKeyDown:this._keyDownHandler},((e={})[g.a.LearningPathDOMAttributeName]="form-tab-relatedEntity-"+this.props.relatedEntityItem.id,e),{testhooks:{id:"form-tab-relatedEntity-"+this.props.relatedEntityItem.id}}),r,i.createElement(c.a,{style:this.props.style.entityTitleStyle},this.props.relatedEntityItem.title))},t.prototype._keyDownHandler=function(e){e.keyCode===h.a.Tab&&e.preventDefault()},t}(i.Component),v=r("B73A"),_=r("akzq"),S=r("wV3W"),O=r("aPRd"),C=r("7EJx");var I=r("lU69"),j=r("Ww2r"),P=r("PreP"),F=r("Srej"),T=Object(I.a)(),w=function(e){function t(t){var r=e.call(this,t)||this;return r._tabKeyDownScope="tabs",r._relatedKeyDownScope="relatedItems",r._moveFocus=r._moveFocus.bind(r),r._handleKeyCodeNavigation=r._handleKeyCodeNavigation.bind(r),r._ulOverFlowTabsRef=r._ulOverFlowTabsRef.bind(r),r._handleOutsideClick=r._handleOutsideClick.bind(r),r._relatedItemSelected=r._relatedItemSelected.bind(r),r._tabItemSelected=r._tabItemSelected.bind(r),r.state={selectedIndex:-1,keyDownScope:r._tabKeyDownScope},r}return Object(n.__extends)(t,e),t.prototype._renderRelatedEntitiesList=function(e,t){var r=this,n={sectionStyle:this.props.relatedEntitySectionStyle,tileStyle:this.props.tileStyle,entityTitleStyle:this.props.entityTitleStyle,entityIconStyle:this.props.entityIconStyle,navLinkImageStyle:this.props.navLinkImageStyle};if(e&&e.length){var a=[];return e.forEach((function(e){e.show&&(r._relatedEntityIds.push(e.id),a.push(i.createElement(y,{key:e.id,ref:e.id,relatedEntityItem:e,relatedItemsArea:t,handleRelatedEntityCallBack:r._relatedItemSelected,style:n})))})),a}},t.prototype._tabItemSelected=function(e){this.props.selectTab(e)},t.prototype._relatedItemSelected=function(e){this.setState({selectedIndex:-1,keyDownScope:this._tabKeyDownScope}),this.props.selectRelatedEntity(e)},t.prototype._handleOutsideClick=function(e){e&&e.target&&e.target.id!==Object(F.g)("related_tab",this.props.id)&&e.target.id!==Object(F.g)("more_tab",this.props.id)&&(this.props.closeFlyout(e),this.setState({selectedIndex:-1}))},t.prototype._ulOverFlowTabsRef=function(e){this._overFlowTabList=e},t.prototype._shortcutHandler=function(e){var t,r,n,a,o=e.EVENT;if(this._overFlowTabList&&(n=i.Children.count(this._overFlowTabList.props.children)),this._relatedEntityIds&&(a=this._relatedEntityIds.length),this._relatedEntityIds&&!this._overFlowTabList&&(this.setState({keyDownScope:this._relatedKeyDownScope}),a=this._relatedEntityIds.length),this._overFlowTabList&&this.state.keyDownScope===this._tabKeyDownScope?(t=n,r=a):this._relatedEntityIds&&this.state.keyDownScope===this._relatedKeyDownScope&&(t=a,r=n),this._relatedEntityIds||this._overFlowTabList){var s=0===n?this._relatedKeyDownScope:this._tabKeyDownScope;if(o.keyCode===h.a.DownArrow)o.preventDefault(),this._handleKeyCodeNavigation(h.a.DownArrow,n,a,t,r);else if(o.keyCode===h.a.UpArrow)o.preventDefault(),this._handleKeyCodeNavigation(h.a.UpArrow,n,a,t,r);else if(o.keyCode===h.a.Escape)this.props.closeFlyout(o),this.setState({selectedIndex:-1,keyDownScope:s}),this._moveFocusToLastTab();else if(o.keyCode===h.a.Enter){if(this.state.keyDownScope===this._relatedKeyDownScope){var c=o.target;if(c.id!==Object(F.g)("related_tab",this.props.id)){var l=this._getRelatedItem(c.id);this._relatedItemSelected(l)}}else this._tabItemSelected(o);this.setState({selectedIndex:-1,keyDownScope:s})}else o.keyCode===h.a.Tab&&o.preventDefault()}},t.prototype._moveFocusToLastTab=function(){if(this.props.tabNavigatorList){var e=a.findDOMNode(this.props.tabNavigatorList),t=e.childNodes.length-1;t>-1&&e.childNodes[t].focus()}},t.prototype._handleKeyCodeNavigation=function(e,t,r,n,i){var a,o=h.a.DownArrow===e?this.state.selectedIndex+1:this.state.selectedIndex-1,s=0===this.state.selectedIndex&&h.a.UpArrow===e;this.state.keyDownScope===this._relatedKeyDownScope?a=s&&t?t:r:this.state.keyDownScope===this._tabKeyDownScope&&(a=s&&r?r:t);var c=(o+a)%a,l=-1;if(h.a.DownArrow===e&&o===a&&i?l=0:h.a.UpArrow===e&&-1===o&&i&&(l=a-1),l>-1){var u=this.state.keyDownScope===this._tabKeyDownScope?this._relatedKeyDownScope:this._tabKeyDownScope;this.setState({keyDownScope:u})}this._moveFocus(c,this.state.keyDownScope)},t.prototype._moveFocus=function(e,t){var r,n,i=this;t===this._relatedKeyDownScope?r=a.findDOMNode(this.refs[this._relatedEntityIds[e]]):t===this._tabKeyDownScope&&(n=a.findDOMNode(this._overFlowTabList).childNodes[e]),(r||n)&&this.setState({selectedIndex:e},(function(){var e=t===i._relatedKeyDownScope?r:n;e&&(e.tabIndex=0,e.focus())}))},t.prototype._createKeyboardShortcuts=function(){var e=Object(j.c)(this.props.resourceStrings,P.a),t=Object(j.c)(this.props.resourceStrings,P.b),r=Object(j.c)(this.props.resourceStrings,P.f),n=Object(j.c)(this.props.resourceStrings,P.d),i=Object(j.c)(this.props.resourceStrings,P.c),a=Object(j.c)(this.props.resourceStrings,P.e),o=this._shortcutHandler.bind(this),s=[],c=new v.a([h.a.UpArrow],o,!0,e,r),l=new v.a([h.a.DownArrow],o,!0,e,t),u=new v.a([h.a.Escape],o,!0,e,n),d=new v.a([h.a.Enter],o,!0,e,i),p=new v.a([h.a.Tab],o,!0,e,a);return s.push(c),s.push(l),s.push(u),s.push(d),s.push(p),s},t.prototype._getRelatedEntityContainer=function(){var e=[],t=[];if(this._relatedEntityIds=[],this.props.moreTabItems&&this.props.moreTabItems.length&&e.push(i.createElement(s.a,{key:"OverFlowTabList",role:u.r,ref:this._ulOverFlowTabsRef,onClick:this._tabItemSelected},this.props.moreTabItems)),this.props.isShowNavigation&&!this.props.isInCreateMode){if(this.props.relatedEntitiesList)for(var r=0;r<this.props.relatedEntitiesList.length;r++){var n=this.props.relatedEntitiesList[r];n&&n.relatedItems&&n.relatedItems.find((function(e){return!1!==e.show}))&&e.push(i.createElement(l.a,{key:"related_"+n.areaName+r,style:this.props.tabStyle},i.createElement(l.a,{key:"related_area_"+n.areaName+r,style:this.props.areaNameContainerStyle},i.createElement(c.a,{key:"areaName_"+n.areaName,accessibilityLabel:n.areaName},n.areaName)),this._renderRelatedEntitiesList(n.relatedItems,n.areaName)))}if((null==this.props.relatedEntitiesList||0===this._relatedEntityIds.length)&&this.props.retrieveMissingRelatedEntitiesFinished&&this.props.relativeElementId===Object(F.g)("related_tab",this.props.id)){var a=Object(j.c)(this.props.resourceStrings,P.g);e.push(i.createElement(l.a,{key:"related_noData",style:this.props.tabStyle},i.createElement(l.a,{key:"related_entity_noData_container",style:this.props.noDataContainerStyle},i.createElement(c.a,{key:"related_entity_noData_available_text",id:"related_entity_noData_available_text",accessibilityLabel:a,tabIndex:0,role:u.n},a))))}}return t.push(i.createElement(l.a,{key:"related_flyout",role:u.l,style:this.props.relatedItemsSectionsContainerStyle},e)),t},t.prototype._getRelatedItem=function(e){if(this.props.relatedEntitiesList)for(var t=0;t<this.props.relatedEntitiesList.length;t++)if(this.props.relatedEntitiesList[t].relatedItems){var r=this.props.relatedEntitiesList[t].relatedItems.find((function(t){return t&&t.id===e}));if(r)return r}},t.prototype.render=function(){return this.props.isFlyoutOpened?i.createElement(l.a,{key:"relatedEntityContainer",id:"relatedEntityContainer",ownsElementId:T},i.createElement(_.a,{key:"relatedEntityFlyoutAccessibility",rootElementId:T,keyboardShortcuts:this._createKeyboardShortcuts(),shouldManageFocus:!1}),i.createElement(d.a,{key:T,id:T,testhooks:{id:T},flyoutDirection:d.b.down,relativeToElementId:this.props.relativeElementId,positionType:"relative",flyoutStyle:this.props.flyoutStyle,onOutsideClick:this._handleOutsideClick},this._getRelatedEntityContainer())):null},t.prototype.componentDidUpdate=function(){-1===this.state.selectedIndex&&(this._overFlowTabList||this._relatedEntityIds)&&this.props.isFlyoutOpened&&(this._overFlowTabList&&this.state.keyDownScope===this._tabKeyDownScope?this._moveFocus(0,this._tabKeyDownScope):this._relatedEntityIds&&this._moveFocus(0,this._relatedKeyDownScope))},t}(i.Component);w.displayName="TabFlyout";var E=Object(o.a)((function(){var e,t,r,n,i=(e=null,t=null,r=null,n=null,function(i){var a=Object(O.c)(i),o=Object(S.a)(i),s=Object(C.g)(i);return t===o&&r===a&&n===s||(e={relatedItemsSectionsContainerStyle:{display:"block",width:"100%"},relatedEntitySectionStyle:{paddingTop:o.sizes.Measures.Measure050,paddingBottom:o.sizes.Measures.Measure050,height:"auto",maxHeight:o.sizes.Measures.Measure300,lineHeight:o.sizes.Measures.Measure150,overflow:"hidden",cursor:o.display.PointerCursorStyle},tabStyle:{display:"block",marginTop:0,marginBottom:o.sizes.Measures.Measure075},tileStyle:{width:o.sizes.Measures.Measure150,height:o.sizes.Measures.Measure150,marginRight:o.sizes.Measures.Measure100,backgroundColor:o.colors.SemanticZoomTileBackground},flyoutStyle:{borderColor:"#ffffff",borderWidth:"1px",borderStyle:"solid",borderTopWidth:0,paddingLeft:o.sizes.Measures.Measure150,paddingRight:o.sizes.Measures.Measure150,paddingTop:o.sizes.Measures.Measure100,paddingBottom:o.sizes.Measures.Measure025,maxWidth:"22.86rem",minWidth:o.sizes.DockablePanel.PanelWidthM,maxHeight:o.sizes.Flyout.MaxHeight,boxShadow:o.shadows.Shadow01,backgroundColor:o.colors.BaseColor.White,width:a<o.sizes.Breakpoints.DimensionXS?"95%":void 0,height:a<o.sizes.Breakpoints.DimensionXS?"60%":void 0,margin:a<o.sizes.Breakpoints.DimensionXS?"0 2.5%":void 0},areaNameContainerStyle:{paddingTop:o.sizes.Measures.Measure050,paddingBottom:o.sizes.Measures.Measure050,height:o.sizes.Measures.Measure150,lineHeight:o.sizes.Measures.Measure150,borderBottom:o.borders.Border02,fontSize:o.fontSizes.Font100,fontFamily:o.fontFamilies.Semibold,color:o.colors.BaseColor.Grey.Grey7},entityTitleStyle:{fontSize:o.fontSizes.Font100,fontFamily:o.fontFamilies.Regular,color:o.colors.BaseColor.Grey.Grey7},entityIconStyle:{fontFamily:"Dyn CRM Symbol",fontSize:"16px",width:o.sizes.Measures.Measure115,marginLeft:s?o.sizes.Measures.Measure100:0,marginRight:s?0:o.sizes.Measures.Measure100},noDataContainerStyle:{paddingTop:o.sizes.Measures.Measure050,paddingBottom:o.sizes.Measures.Measure050,height:o.sizes.Measures.Measure150,lineHeight:o.sizes.Measures.Measure150,fontSize:o.fontSizes.Font100,fontFamily:o.fontFamilies.Semibold,color:o.colors.BaseColor.Grey.Grey7},navLinkImageStyle:{width:"16px",height:"16px",marginLeft:s?o.sizes.Measures.Measure100:0,marginRight:s?0:o.sizes.Measures.Measure100,marginTop:"2px"}},t=o,r=a,n=s),e}),a=Object(j.h)(),o=Object(p.f)();return function(e,t){var r=i(e),n=a(e,P.h),s=o(e,t);return{tileStyle:r.tileStyle,flyoutStyle:r.flyoutStyle,tabStyle:r.tabStyle,navLinkImageStyle:r.navLinkImageStyle,relatedEntitySectionStyle:r.relatedEntitySectionStyle,relatedItemsSectionsContainerStyle:r.relatedItemsSectionsContainerStyle,areaNameContainerStyle:r.areaNameContainerStyle,entityTitleStyle:r.entityTitleStyle,entityIconStyle:r.entityIconStyle,resourceStrings:n,noDataContainerStyle:r.noDataContainerStyle,relatedEntitiesList:s,isShowNavigation:Object(p.h)(e,t)}}}))(w)},ozeM:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="formHeaderTitle"},p5Y6:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("HSdq"),i=r("aGOT"),a=r("Sscr");function o(e){return{type:"form.cancel.async",execute:function(t){var r=t.dispatch,o=t.getState,s=Object(a.j)(o(),e),c=Object(n.ac)(o(),e,s);return r(Object(i.c)(e,c,s)),Promise.resolve()}}}},"pLx/":function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("Z1aD"),i=r("45T4");function a(e,t){return Object(n.a)(i.a,{},t,e)}},r0tX:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n;r.d(t,"a",(function(){return n})),function(e){e.collapsed="collapsed",e.expanded="expanded",e.floating="floating",e.getDefaultDisplayState=function(){return e.collapsed}}(n||(n={}))},r3Bs:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n=function(){function e(e,t){this._traversedPath=e,this._stageId=t}return Object.defineProperty(e.prototype,"traversedPath",{get:function(){return this._traversedPath},set:function(e){this._traversedPath=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stageId",{get:function(){return this._stageId},set:function(e){this._stageId=e},enumerable:!1,configurable:!0}),e}(),i=r("3INI"),a=r("9r0m"),o=function(){function e(){}return Object.defineProperty(e.prototype,"globalPathAndActiveStage",{get:function(){return this._globalPathAndActiveStage},set:function(e){(e||this._globalPathAndActiveStage||this._globalPathAndActiveStage.stageId===e.stageId)&&(this._globalPathAndActiveStage=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"navigationEntities",{get:function(){return this._navigationEntities},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"navigationEntityIdsByEntityLogicalName",{get:function(){return this._navigationEntityIdsByEntityLogicalName},enumerable:!1,configurable:!0}),e.prototype.InitGlobalPathAndActiveStage=function(e){this._updateNavigationDictionary(e.navigationEntities),this.UpdateGlobalPathAndActiveStage(e.traversedPath,e.activeStageId)},e.prototype.UpdateGlobalPathAndActiveStage=function(e,t){this.globalPathAndActiveStage=new n(new i.a(e),t)},e.prototype._updateNavigationDictionary=function(e){if(e){this._navigationEntities=e,this._navigationEntityIdsByEntityLogicalName={};for(var t=0;t<e.length;t++)this._navigationEntityIdsByEntityLogicalName[e[t].entityLogicalName]=new a.a(e[t].id)}},e}()},r7Ib:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o}));var n=r("Sscr"),i=r("uO/V"),a="grid.setCommandManagerId";function o(e,t,r){return{type:"grid.setCommandManagerId.async",execute:function(o,s){var c=o.dispatch,l=(o.getState,s.TraceManager.getTracer(i.z)),u=i.x+".setCommandManagerIdAction";try{l.info("Updating the command manager id for the grid.");var d=Object(n.v)(r);return c(function(e,t,r){return{type:a,payload:t,meta:{pageId:e,dataSetContextKey:r}}}(e,t,d)),s.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){var p="Updating the command manager id for the grid failed with error : "+e.message;s.EventManager.ReportComponentFailure(u,Error(p))}}}}},rbxJ:function(e,t,r){"use strict";r.d(t,"i",(function(){return pe})),r.d(t,"g",(function(){return ne})),r.d(t,"e",(function(){return ie})),r.d(t,"d",(function(){return ae})),r.d(t,"f",(function(){return ge})),r.d(t,"h",(function(){return me})),r.d(t,"c",(function(){return se})),r.d(t,"a",(function(){return de})),r.d(t,"b",(function(){return ue}));var n=r("c/eZ"),i=r("9r0m"),a=r("swEE"),o=r("NxDw"),s=r("G7N+"),c=r("S2mk"),l=r("UOiB"),u=r("Fas2"),d=r("r2h9"),p=r("lMVv"),h=r("7EJx"),g=r("EGsq"),m=r("Ww2r"),f=r("RlP9"),b=r("z9yS"),y=r("uO/V"),v=r("Gemh"),_=r("Sscr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function S(){var e=null,t=null,r=null;return function(n,i){var a=i.parentContextToken,o=i.contextString,s=function(e,t){var r=t.parentContextToken;switch(t.contextString){case y.h.ASSOCIATEDGRID:var n=Object(v.gb)(e,t,r);return _.a(r,n.relationshipName,n.ordinal);case y.h.SUBGRID:if(t.descriptor&&t.descriptor.StreamId)return _.o(r,t.descriptor.Name,t.descriptor.StreamId,!!t.descriptor.IsTile);var i=_.p(r,t.descriptor.Name),a=i&&i.parentContextToken?i.parentContextToken.entityTypeName:null;return i.relationshipType=se(e,t,a,i),i;case y.h.GRID:return _.k(e,t.id);case y.h.CUSTOM:return _.c(r,t.controlId);default:return r}}(n,i);return(r!==o||O(e,s)||O(t,a))&&(e=s,t=a,r=o),e}}function O(e,t){return e&&t?e.entityTypeName!==t.entityTypeName||e.controlName!==t.controlName||(e.formId&&e.formId.guid)!==(t.formId&&t.formId.guid)||(e.recordId&&e.recordId.guid)!==(t.recordId&&t.recordId.guid)||e.relationshipName!==t.relationshipName||e.roleOrd!==t.roleOrd:e!==t}var C=r("jf1O"),I=r("perk"),j=r("/3Li"),P=r("0u+G"),F=r("wV3W"),T=r("DgF7"),w=r("Wg6j"),E=r("WS0f"),x=r("VWqI"),N=r("Ev4I"),A=r("JlqV"),k=r("cZkS"),M=r("qC0c"),D=r("c0jI"),R=r("jigW"),B=r("sOTk"),L=r("7pqb"),V=r("s2by"),z=r("VnpK"),G=r("CIm2"),W=r("+6eZ"),H=r("3/zo"),U=r("oVzJ"),q=r("2OIc"),X=r("/V8d"),K=r("M6d0"),Q=r("Oiu5"),Y=r("/U1C"),Z=r("W51q"),J=r("c56u"),$=r("F2uj"),ee=r("HF9s"),te=r("c96h"),re=r("TCzx");function ne(e){return e===y.h.SUBGRID}function ie(e){return e===y.h.GRID}function ae(e){return e===y.h.ASSOCIATEDGRID}function oe(e){switch(e){case y.h.ASSOCIATEDGRID:case y.h.SUBGRID:return"div";case y.h.GRID:default:return"section"}}function se(e,t,r,n){var i=r?Object(p.G)(e,r,n.relationshipName):null;if(null===i&&t.descriptor&&t.descriptor.Parameters){var a=t.descriptor.Parameters[y.F.RELATIONSHIP_NAME],o=t.descriptor.Parameters[y.F.TARGET_ENTITY_TYPE];a&&r?i=Object(p.G)(e,r,a):a&&o&&(i=Object(p.G)(e,o,a))}return i}function ce(){var e=null,t=null;return function(r){return e!==r.contextString&&(e=r.contextString,t=function(e){switch(e.contextString){case y.h.ASSOCIATEDGRID:case y.h.SUBGRID:return[d.a.SUB_GRID,d.a.MAIN_APPLICATION_VIEW];case y.h.GRID:return e.isAdvancedFindView?[d.a.ADVANCED_SEARCH]:[d.a.MAIN_APPLICATION_VIEW];default:return[d.a.MAIN_APPLICATION_VIEW]}}(r)),t}}function le(e){return e&&[e.CustomControlId,e.Name].some((function(e){return-1!==X.a.indexOf(e)}))}function ue(e,t,r){if(!e||!e.contextTokenType||e.contextTokenType!==l.a.AssociatedGrid&&e.contextTokenType!==l.a.MainGrid)return null;switch(t){case"displayChart":return!1;case"displayCommandBar":return!0;case"displayIndex":return le(r);case"displayQuickFind":case"displayViewSelector":return!0}return null}function de(){var e=null,t=null;return function(r,n,i){if(e&&t===n.CustomControlId)return e;var a=n&&n.CustomControlId?n.CustomControlId:null;if(!a)return null;var o=Object(v.ab)(r,a),s=Object(q.e)(r,a);if(o&&s&&s.Properties.DataSetDefinitions&&s.Properties.DataSetDefinitions[o]&&s.Properties.DataSetDefinitions[o].CDSDataSetOptions){var c=s.Properties.DataSetDefinitions[o].CDSDataSetOptions;e={displayChart:c.hasOwnProperty("displayChart")?c.displayChart:ue(i,"displayChart",n),displayCommandBar:c.hasOwnProperty("displayCommandBar")?c.displayCommandBar:ue(i,"displayCommandBar",n),displayIndex:c.hasOwnProperty("displayIndex")?c.displayIndex:ue(i,"displayIndex",n),displayQuickFind:c.hasOwnProperty("displayQuickFind")?c.displayQuickFind:ue(i,"displayQuickFind",n),displayViewSelector:c.hasOwnProperty("displayViewSelector")?c.displayViewSelector:ue(i,"displayViewSelector",n)},t=n.CustomControlId}return e}}function pe(){var e,t,r,l,_,O,z,q,X,ue,de,pe,ge,ye,ve,_e,Se,Oe,Ce,Ie,je,Pe,Fe,Te,we,Ee,xe,Ne,Ae,ke,Me,De,Re,Be,Le,Ve,ze=null,Ge=null,We=null,He=null,Ue="",qe=null,Xe=null,Ke=null,Qe=null,Ye=null,Ze=null,Je=null,$e=null,et=(t=null,function(e,r,n,i){var a=t;switch(Object(E.b)(i)&&(i=r.contextString),i){case y.h.ASSOCIATEDGRID:a=Object(u.b)(n);break;case y.h.SUBGRID:a=Object(u.l)(n);break;case y.h.GRID:default:a=Object(u.h)(n)}return a!==t&&(t=a),t}),tt=Object(C.a)(),rt=S(),nt=(r=null,_=null,l=function(e,t,r){var n,a,s,l,u;if(Object(v.ib)(e,t.id,r)){n=Object(v.T)(e,t.id,r);var d=Object(v.qb)(e,n,t.id);a=d&&d.entityLogicalName,u=d&&d.isUserView,s=Object(v.r)(e,t.id,r,a),l=Object(v.s)(e,t.id,r)!==b.a.savedvisualization}else{var p=Object(v.ab)(e,t.configuration.CustomControlId);if(p){var h=t.configuration.Parameters[p];h&&(n=h.ViewId&&new i.a(h.ViewId),a=h.TargetEntityType,s=h.VisualizationId&&new i.a(h.VisualizationId),l=!(!h.IsUserChart||"true"!==h.IsUserChart),u=!(!h.IsUserView||"true"!==h.IsUserView))}}if(!i.a.isNullOrEmpty(n)&&s&&a){var g=Object(v.q)(e,t.id,r),m=Object(v.p)(e,t.id,r),f=Object(v.C)(e,t.id,r),S=he(e,t,r,f,!0),O=Object(v.N)(e,t.id,r),C=e.user&&e.user.userId,I=Object(M.c)(e,k.Zc),j=Object(V.a)(a,C,r,I),P=j&&j.getFilterAndLinkedEntities(f&&f.activityOrQueueFilterValue?f.activityOrQueueFilterValue:void 0),F=P&&null!==P.linkEntities?JSON.stringify(P.linkEntities):null,w=Object(M.a)(e,k.Od,k.h),E=!w||w&&Object(T.a)(e)===o.a.MobileApplication,x=w,N=ae(t.contextString)?Object(c.p)(y.d,a,i.a.toString(n),i.a.toString(s),r.relationshipName,O,l,u,S,F,x):Object(c.t)(y.d,a,i.a.toString(n),i.a.toString(s),O,g,l,m,u,S,F,E,x);if(_){var A=N&&N.CustomControlId?N.CustomControlId:null;if((B=Object(v.ab)(e,A))&&N.Parameters[B]){var D=N.Parameters[B],R=_.Parameters[B];D.ViewId===R.ViewId&&D.VisualizationId===R.VisualizationId&&D.EntityName===R.EntityName&&D.HighchartFilterExpression===R.HighchartFilterExpression&&D.ChartDrillDownParameters===R.ChartDrillDownParameters&&D.ExtraFilters===R.ExtraFilters||(_=N)}}else _=N}else if(_&&a&&!s){var B;A=_.CustomControlId,(B=Object(v.ab)(e,A))&&_.Parameters[B]&&a!==(R=_.Parameters[B]).EntityName&&(_=null)}return _},function(e,t,n){var i=l(e,t,n),a=t.id;return r&&r.configuration===i&&r.id===a||(r={configuration:i,id:a,chartId:y.d,showChart:!0,contextToken:n}),r}),it=(O=null,function(e,t,r,n,i,a){var o=a.commandBarStyle,s=t.id,c=se(e,t,r&&r.parentContextToken?r.parentContextToken.entityTypeName:null,r),l=Object(v.w)(e,s,r);return O&&O.commandManagerId===l&&O.pageId===s&&O.ribbonId===i&&O.relationshipType===c&&O.contextToken===r&&O.style===o||(O={commandManagerId:l,pageId:s,ribbonId:i,relationshipType:c,contextToken:r,style:o}),O}),at=(z=null,q=ce(),function(e,t,r,n,a,o){var s,c=o.viewSelectorStyle,l=i.a.toString(a),u=q(t),p=Object(v.nb)(t.id,l),g=ie(t.contextString),m=g,b=t.contextString,y=Object(v.Z)(e),_=Object(h.g)(e),S=Object(v.qb)(e,a,t.id),O=S?S.title:null,C=d.a.MAIN_APPLICATION_VIEW;ne(b)?C=d.a.SUB_GRID:g&&t.isAdvancedFindView&&(C=d.a.ADVANCED_SEARCH);var I=Object(f.a)(e,n,C),j=I||i.a.EMPTY,P=Object(B.g)(e,null==t?void 0:t.id),F=Object(v.rb)(e,null===(s=null==P?void 0:P.pageToEditedViewMapId)||void 0===s?void 0:s.guid,null==a?void 0:a.guid);return z&&z.id===p&&z.entityTypeName===n&&z.selectedViewId===l&&z.queryViewSelectorTypes===u&&z.shouldDisplayNestedViewSelector===m&&z.isRTL===_&&z.defaultViewId===j&&z.isEdited===!!F||(z={id:p,pageId:t.id,title:O,entityTypeName:n,selectedViewId:l,style:c,queryViewSelectorTypes:u,shouldDisplayNestedViewSelector:m,contextString:b,pinnedActivityView:y,isRTL:_,defaultViewId:j,isAdvancedFindView:t.isQueryMode&&t.isAdvancedFindView,isEdited:!!F,pageToEditedViewMapId:null==P?void 0:P.pageToEditedViewMapId}),z}),ot=(X=null,function(e,t,r,n,i){var a=t.id,o=Object(v.G)(e,t),s=Object(h.w)(e),c=i.filterComboStyle,l=Object(B.g)(e,a).entityFilterValue;return X&&X.id===a&&X.entityTypeName===n&&X.filterOptions===o&&X.comboBoxStyle===c&&X.userSetting===s&&l===X.previousValue||(X={id:a,filterOptions:o,entityTypeName:n,updateFilterValue:null,onFilterChange:null,resourceStrings:null,userSetting:s,style:null,comboBoxStyle:c,previousValue:l}),X}),st=(ue=null,function(e,t,r,i,a){var o=t.id,s=Object(v.G)(e,t,i),c=Object(Q.a)(e),l=a.filterComboStyle,u=a.dueDateComboBoxStyles,d=a.activityTypeComboBoxStyles,p=Object(R.h)(e,r.relationshipName,ae(t.contextString)),g=!Object(A.b)(e),m=Object(v.kb)(e,o,r),f=Object(h.g)(e),b=Object(F.a)(e),y=Object(B.g)(e,o),_=y.entityFilterValue,S=y.activityTypeFilterValue,O=Object(M.a)(e,k.a,k.h),C=Object(M.a)(e,k.a,k.Lc),j=Object(v.ub)(e,i),P=Object(M.c)(e,k.Zc),T=Object(V.a)(i,e.user.userId,r,P,j),w=T&&T.getFilterLabelResourceKey(),E=I.ACTIVITY_MGMT_ACTIVITY_TYPE_LABEL,x=I.ACTIVITY_MGMT_DUE_DATE_LABEL;if(!ue||ue.id!==o||ue.entityTypeName!==i||ue.filterOptions!==s||ue.comboBoxStyle!==l||ue.dueDatecomboBoxStyle!==u||ue.activityTypecomboBoxStyle!==d||ue.labelStyle!==a.filterLabelStyle||ue.activityMgmtLabelStyle!==a.activityMgmtLabelStyle||ue.isActivityManagementFeatureEnabled!==O||ue.filterOptionsForActivityType!==c||ue.isRollupViewSupported!==p||ue.isOffline!==g||ue.toggleValue!==m||ue.isRTL!==f||ue.theme!==b||ue.previousValue!==_||ue.activityTypePreviousValues!==S||ue.isActivityFilterSelectAllEnabled!==C||ue.entityIsActivityType!==j){var N={isRollupViewSupported:p,isOffline:g,toggleValue:m,onToggleChange:null,isRTL:f,theme:b};ue=Object(n.__assign)({id:o,filterOptions:s,filterOptionsForActivityType:c,entityTypeName:i,onFilterChange:null,onActivityTypeChange:null,onActivityTypeFilterClear:null,gridEntityName:null,resourceStrings:null,comboBoxStyle:l,dueDatecomboBoxStyle:u,activityTypecomboBoxStyle:d,containerStyle:null,activityTypeContainerStyle:null,labelStyle:a.filterLabelStyle,activityMgmtLabelStyle:a.activityMgmtLabelStyle,previousValue:_,activityTypePreviousValues:S,isActivityManagementFeatureEnabled:O,activityViewContainerStyle:a.activityViewContainerStyle,entityFilterLabelResourceString:w,activityTypeFilterLabelResourceString:E,dueDateFilterLabelResourceString:x,isActivityFilterSelectAllEnabled:C,isRTL:f,entityIsActivityType:j},N)}return ue}),ct=(de=null,pe=[1041,2052,3076,1028,1042],function(e,t,r,n,i,a){var o=e.id,s=e.descriptor&&e.descriptor.Id?e.descriptor.Id:null,c=i?JSON.parse(i).conditions[0]:null,l=function(e,t){if(t=t?t.value.replace("%","").toUpperCase():null,e){var r=me(e.split(",")[0]),n=r[1].split("|");if(n&&t===n[0])return r[1]}return t}(Object(m.c)(a,I.JUMPBAR_ALPHABET),c);return pe.indexOf(n)>-1?de=null:de&&de.id===o&&de.contextToken===t&&de.entityTypeName===r&&de.selectedFilter===l||(de={id:o,uniqueId:s,contextToken:t,entityTypeName:r,selectedFilter:l,languageId:n}),de}),lt=(ge=null,function(e,t,r,n){var i=e.id,a=e.contextString;return ge&&ge.id===i&&ge.contextToken===t&&ge.entityTypeName===r&&ge.gridInput===n||(ge={id:i,contextToken:t,entityTypeName:r,contextString:a,gridInput:n}),ge}),ut=(ye=null,function(e,t,r){var n=e.id,i=e.contextString;return ye&&ye.id===n&&ye.contextToken===t||(ye={id:n,contextToken:t,contextString:i}),ye}),dt=Object(m.h)(),pt=(Se=null,Oe=null,je=null,ke={useSkypeProtocol:Ce={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},gridPageNumber:Ie={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},isNewPageRequested:Pe={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},enhancedPagingDisabled:Fe={Type:"WholeNumber.None",Usage:1,Static:!0,Value:!1,Primary:!1},isActivityTypeFilterDisabled:Te={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},showAddNewCommand:we={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},emptySubgridIconAndTextChanges:Ee={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},emptyGridChangesIfQuickFindImprovementsEnabled:xe={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},headerDialogOnTop:Ne={Type:"TwoOptions",Usage:1,Static:!0,Value:!1,Primary:!1},headerDialogPreventDismissOnScroll:Ae={Type:"TwoOptions",Usage:1,Static:!0,Value:!1,Primary:!1}},function(e,t,r){var i=Object(T.e)(e),s=Object(g.x)(e).useSkypeProtocol,c=Object(v.x)(e,t.id,r),l=Object(v.X)(e,t.id,r);l||je===c||(je=c),ve||(ve=Object(j.a)(e),_e=null!=ve&&ve===P.b.Native);var u=!_e,d=Object(M.a)(e,k.a,k.h),p=t.systemDefinedProperties,h=c!==je&&l,m=u!==Fe.Value,f=!1;d&&(ae(t.contextString)||ie(t.contextString))&&(f=!0);var b=!1;Object(U.a)(e)&&ne(t.contextString)&&(b=!0);var y=!1;Object(U.a)(e)&&Object(M.c)(e,k.Md)&&ne(t.contextString)&&Object(T.a)(e)===o.a.MobileApplication&&(y=!0);var _=!1;if(Object(U.a)(e)&&Object(M.c)(e,k.ad)&&ie(t.contextString)&&Object(T.a)(e)===o.a.MobileApplication){var S=Object(v.C)(e,t.id,r);(null==S?void 0:S.quickFind)&&(_=!0)}var O=!ie(t.contextString)&&a.a.Tablet===i,C=a.a.Tablet===i&&!ae(t.contextString)||"Web"===Object(T.k)(e)&&!re.a.getInstance().get_IsAndroid()&&!re.a.getInstance().get_IsWindows()&&!re.a.getInstance().get_isIPhone();if(i!==Se||s!==Oe||h||m||l!==Pe.Value||f!==Te.Value||b!==we.Value||y!==Ee.Value||_!==xe.Value||O!==Ne.Value||C!==Ae.Value){Se=i,Oe=s,Ie.Value=c,je=c,Pe.Value=l,Fe.Value=u,Te.Value=f,we.Value=b,Ee.Value=y,xe.Value=_,Ne.Value=O,Ae.Value=C;var I=null==Se?s:null;(I!==Ce.Value||h||m)&&(Ce.Value=I,ke=Object(n.__assign)(Object(n.__assign)({},p),{useSkypeProtocol:Ce,gridPageNumber:Ie,isNewPageRequested:Pe,enhancedPagingDisabled:Fe,isActivityTypeFilterDisabled:Te,showAddNewCommand:we,emptySubgridIconAndTextChanges:Ee,emptyGridChangesIfQuickFindImprovementsEnabled:xe,headerDialogOnTop:Ne,headerDialogPreventDismissOnScroll:Ae}))}return ke}),ht=(Me=null,De=null,function(e,t,r){return e&&(De&&Me===e&&!r||(De=Object(n.__assign)({},e),e.Parameters&&(De.Parameters=Object(n.__assign)({},e.Parameters),t&&e.Parameters[t]&&(De.Parameters[t]=Object(n.__assign)({},e.Parameters[t]),e.Parameters[t].Columns&&(De.Parameters[t].Columns=e.Parameters[t].Columns.slice(0)))),Me=e)),De}),gt=Object(w.s)(),mt=(Re=[],function(e,t,r,n,i,a,o,s,c,l,u){return Re&&Re.length&&Re.splice(0,Re.length),Re.push({name:L.b.IsGridRoot,value:e},{name:L.b.IsSubGrid,value:t},{name:L.b.IsAssociatedGrid,value:r},{name:L.b.EntityName,value:n},{name:L.b.ViewId,value:i},{name:L.b.IsEmptyFetch,value:a},{name:L.b.IsEmptyOfflineSqlQuery,value:o},{name:L.b.IsValidFetchXmlForOfflineUsage,value:s},{name:L.b.IsEntityAvailableForOfflineUsage,value:c},{name:L.b.OfflineConfigurationErrorCode,value:l},{name:L.b.RelatedEntityUnavailableOffline,value:u}),Re}),ft=(Be=null,function(e){return Be||(Be={isGridPaginationStateFeatureEnabled:Object(M.a)(e,k.zb),isAssociatedGridHeightEnabled:Object(R.e)(e),isChartOnAssociatedGridEnabled:Object(M.a)(e,k.x,k.h,k.i),isGridProgressIndicatorFeatureEnabled:Object(M.a)(e,k.Ab),isInMobileModeForOct2019:Object(U.b)(e),isJumpBarShouldHonorSortingFeatureEnabled:Object(M.a)(e,k.ac),isJumpbarFeatureForMobileEnabled:Object(M.c)(e,k.Kb),isSuiterChartEnabled:Object(M.a)(e,k.Od,k.h),isSuiterDashboardEnabled:Object(M.a)(e,k.Pd,k.h),isAdvancedFindEnabled:Object(Z.a)(e),isDisableEditableGridControlOnPhoneFeatureEnabled:Object(M.c)(e,k.O),isInMobileModeForApril2020:Object(U.a)(e),isSubgridImprovementsEnabled:Object(M.c)(e,k.Md),isSubGridAutoCollapseEnabled:Object(M.a)(e,k.Jd,k.Lc),isSubGridRemoveMinHeightEnabled:Object(M.a)(e,k.Ld,k.Lc),isQuickFindImprovementsEnabled:Object(M.c)(e,k.ad),isShowAsButtonFirstEnabled:Object(M.c)(e,k.Bd),isColumnEditorButtonEnabled:Object(v.tb)(e),isQueueFilterPerfUCIEnabled:Object(M.c)(e,k.Zc)}),Be}),bt=(Le={fetchXML:null,entityName:null,isOffline:null},Ve={error:!1,errorCode:null,relatedEntityUnavailableOffline:null},function(e,t,r,n){if(Le.entityName!==r||Le.fetchXML!==t||Le.isOffline!==n)if(Object(N.k)(r)){var i=Object(N.b)(e,t);Ve={error:i.error,errorCode:i.error?I.LINKED_ENTITY_NOT_SUPPORTED:null,relatedEntityUnavailableOffline:i.relatedEntityUnavailableOffline},Le={fetchXML:t,entityName:r,isOffline:n}}else Ve={error:!0,errorCode:I.ACTIVITY_ENTITY_NOT_SUPPORTED_OFFLINE},Le={fetchXML:t,entityName:r,isOffline:n};return Ve});return function(t,r){var a,o=Object(h.w)(t),c=rt(t,r),l=Object(v.v)(t,r.id,c),u=c.relationshipName,b=c.roleOrd,_=Object(v.N)(t,r.id,c),S=Object(v.I)(t,r.id,c),O=Object(v.x)(t,r.id,c),C=r.descriptor,w=be.bind(null,r,C),L=r.configuration,z=L&&L.CustomControlId?L.CustomControlId:null,U=Object(j.a)(t),q=Object(T.e)(t),X=Object(v.ab)(t,z)||(r.contextString===y.h.CUSTOM?y.g:null),Q=ie(r.contextString),Z=ft(t),re=Object(v.A)(t,c,r),se=null,ce=!1,ue=null,de=Object(v.t)(t,r.id,c),pe=Object(v.C)(t,r.id,c);Q&&(se=Object(B.g)(t,r.id),Z.isGridPaginationStateFeatureEnabled&&((ue=se.gridSortingInfo)&&(Object(E.a)(Qe)||Qe!==ue)&&(Qe=ue,ce=!0),de&&(Object(E.a)(Ye)||Ye!==de.customFilterXml)&&(Ye=de.customFilterXml,ce=!0)),(pe&&Object(E.a)(Ze)||Ze!==pe)&&(Ze=pe,ce=!0));var ge=ht(L,X,ce),me=ge&&ge.Parameters?ge.Parameters[X]:null,ye=ae(r.contextString),ve=ne(r.contextString),_e=!Object(A.b)(t),Se=Object(v.jb)(t,c,r),Oe=me&&!!me.DataProvider,Ce=me&&!!me.BoundViewParams,Ie=Object(g.x)(t),je=Ie&&Ie.gridTotalRecordCountLimit?Ie.gridTotalRecordCountLimit:5e3,Pe=Object(v.ib)(t,r.id,c),Fe=le(r.configuration),Te=le(r.configuration);if(null!=r.nonCompositionProps){var we=L&&L.FormFactor&&L.FormFactor.toString(),Ee=Object(D.c)(r.nonCompositionProps.gridConfigurations,r.nonCompositionProps.viewConfigurations,L,null,y.h.GRID,we).map((function(e){return e.configuration.DisplayNameKey})),xe=dt(t,Ee);(!Ke&&""!==Object(m.c)(xe,Ee[0])||Ke!==xe)&&(Ke=xe)}var Ne=!!l,Ae=Object(v.T)(t,r.id,c)||(C&&C.Parameters&&C.Parameters.ViewId?i.a.parse(C.Parameters.ViewId):null),ke=Object(v.qb)(t,Ae,r.id),Me=(null==ke?void 0:ke.isUserView)?d.b.userview:d.b.savedview,De=null==ke?void 0:ke.queryType,Re=null==ke?void 0:ke.entityLogicalName;Re&&Re!==We&&(We=Re);var Be=Object(p.h)(t,We),Le=!_e&&U===P.b.Web&&Q&&Z.isAdvancedFindEnabled&&(null==Be?void 0:Be.IsValidForAdvancedFind);if(!Xe||e!==Le){var Ve=Object(n.__spreadArrays)(I.labelList);Le&&(Ve=Object(n.__spreadArrays)(Ve,[Y.c.OpenAdvancedFiltersTitleAndAria]));var yt=dt(t,Ve);""!==Object(m.c)(yt,I.JUMPBAR_ALL_TITLE)?(Xe=yt,e=Le):Ne=!1}var vt=Object(v.W)(t,z);vt&&vt!==qe&&(qe=vt);var _t=tt(t,r);le(r.configuration)&&(Object.assign(_t.bodyStyle,{flexDirection:"column"}),Object.assign(_t.bodyMobileStyle,{flexDirection:"column"}));var St=Object(v.F)(t,r.id,c)||(C&&C.Parameters&&C.Parameters[y.u]?C.Parameters[y.u]:null),Ot=St;Q&&(Ot=se.entityTypeName);var Ct=Object(x.b)(t,St);Be&&Be.Initialized===s.a.Initialized||Oe||Ce||(Ne=!1);var It=Be?Be.DisplayName:"",jt=Object(g.t)(t),Pt=Object(p.i)(t,St),Ft=!(ke&&ke.fetchXML),Tt=ke&&ke.viewId,wt=bt(t,Ft?"":ke.fetchXML,We,_e),Et=!Ft&&!wt.error,xt=null!=ke&&Object(E.b)(ke.offlineSqlQuery),Nt=Object(N.l)(t,We),At=mt(Q,ve,ye,We,Tt?Tt.guid:null,Ft,xt,Et,Nt,wt.error&&wt.errorCode||"",wt.error&&wt.relatedEntityUnavailableOffline||""),kt=!((Q||ye||ve)&&ke&&ke.fetchXML&&_e&&Nt)||!xt&&Et,Mt="";if(kt?Nt||(Mt=I.ENTITY_NOT_AVAILABLE_IN_PROFILE):xt?Mt=I.SQL_QUERY_NOT_AVAILABLE:wt.error&&(Mt=wt.errorCode),me){me.TargetEntityType&&St!==me.TargetEntityType&&(St=me.TargetEntityType),me.ExtraFilters=he(t,r,c,pe,!1);var Dt=function(e,t,r,n,i){var a=[],o=Object(v.q)(e,t.id,r);if(o){var s=JSON.parse(o);if(s.conditions)for(var c=0,l=s.conditions;c<l.length;c++){var u=l[c];u.linkEntityExpressions&&(a=a.concat(u.linkEntityExpressions))}}var d=e.user&&e.user.userId,p=Object(M.c)(e,k.Zc),h=Object(v.ub)(e,n),g=Object(V.a)(n,d,r,p,h),m=g&&g.getFilterAndLinkedEntities(i&&void 0!==i.activityOrQueueFilterValue?i.activityOrQueueFilterValue:G.a,i&&!i.activityOrQueue);m&&m.linkEntities&&(a=a.concat(m.linkEntities));return(m=m||{filter:null,linkEntities:null}).linkEntities=a,m}(t,r,c,St,pe);if(Dt&&Dt.filter&&(me.ExtraFilters?me.ExtraFilters.push(JSON.stringify(Dt.filter)):me.ExtraFilters=[JSON.stringify(Dt.filter)]),Dt&&Dt.linkEntities&&Dt.linkEntities.length>0){var Rt={Static:!0,Value:Object(W.b)(Dt.linkEntities)};if(me.LinkingInput){Rt=me.LinkingInput;var Bt=Object(W.a)(me.LinkingInput.Value);if(Bt){var Lt=new H.a;Bt.forEach((function(e){Lt.addLinkedEntity(e)})),Dt.linkEntities.forEach((function(e){Lt.addLinkedEntity(e)})),Rt.Value=Object(W.b)(Lt.getLinkedEntities())}}me.LinkingInput=Rt}if(Ae){var Vt=i.a.toString(Ae);Vt!==me.ViewId&&(me.ViewId=Vt)}else Ae=i.a.tryParseOrNull(me.ViewId);(C&&C.Parameters?"false"===C.Parameters[y.F.ENABLE_CONTEXTUALACTIONS]:null)&&(ge.Parameters[y.i]={Usage:1,Static:!0,Type:"Enum",Value:!1,Primary:!1})}St&&St!==He&&(He=St);var zt=Object(p.r)(t,St)&&r.contextString===y.h.GRID?v.a:St,Gt=me&&me.CommandBarContext,Wt=et(t,r,zt,Gt),Ht=function(e,t,r){var n=Object(v.qb)(e,t,r);return n&&n.grid&&n.grid.rows&&n.grid.rows[0]&&n.grid.rows[0].cells}(t,Ae,r.id),Ut=null==Ht?void 0:Ht.map((function(e){return e.name})),qt=null==Ge?void 0:Ge.map((function(e){return e.name}));(JSON.stringify(Ut)!==JSON.stringify(qt)||(Ae&&Ae.guid)!==(ze&&ze.guid)||u===Je&&b!==$e)&&(ze=Ae,$e=b,Ue=(C&&C.Id?C.Id:"")+(new Date).getTime(),Ge=Ht),u&&u!==Je&&(Je=u);var Xt=Object(v.o)(t,St),Kt=Xt?Xt.lookupAttribute:null;me&&(function(e,t,r,n,i,a,o){var s=Object(p.h)(e,n);if(s&&le(t.configuration)){var c=y.b;r.Columns||(r.Columns=[]),n!==v.a||i&&i.some((function(e){return e.name===c}))||r.Columns.find((function(e){return e.Name===c}))||r.Columns.push({Alias:c,DataType:"",Type:"",Name:c});var l=s&&s.PrimaryNameAttribute,u=i&&i.some((function(e){return e.name===l}));if(!l||u||r.Columns.some((function(e){return e.Name===l}))||r.Columns.push({Alias:l,DataType:"",Type:"",Name:l}),!Object(v.vb)(t.configuration.Parameters)){var d=Object(R.a)(s.PrimaryImageAttribute);d&&!r.Columns.find((function(e){return e.Name===d}))&&r.Columns.push({Alias:K.d,DataType:"SingleLine.Text",Type:"",Name:d}),Object(M.a)(e,k.ub)&&a&&o&&(r.Columns.find((function(e){return e.Name===v.c}))||r.Columns.push({Alias:v.c,DataType:"Whole.None",Type:"",Name:v.c,PreventMetadataRequest:!0}),r.Columns.find((function(e){return e.Name===a}))||r.Columns.push({Alias:a,DataType:"Lookup.Simple",Type:"",Name:a}))}}}(t,r,me,St,Ge,Kt,!Object(E.a)(se)),function(e,t,r,n,i){if(!Object(v.vb)(t.configuration.Parameters))return;(null==i?void 0:i.some((function(t){var r;return(null===(r=Object($.a)(e,n,t.name))||void 0===r?void 0:r.Type)===ee.a.moneyType})))&&(r.Columns.some((function(e){return e.Alias===y.A}))||r.Columns.push({Alias:y.A,DataType:"Lookup.Simple",Type:"",Name:K.w}))}(t,r,me,St,Ge));var Qt=!St||(Object(x.i)(St)||Object(x.g)(t,St,2,0)&&function(e,t){var r=!0;t&&t.forEach((function(t){if(t.relatedEntityName&&!(r=Object(x.g)(e,t.relatedEntityName,2,0)))return!1}));return r}(t,Ge)),Yt=Object(v.Y)(t,r.id,c),Zt=Yt?JSON.parse(Yt):null,Jt=Zt?Zt.totalResultCount:null,$t=Zt?Zt.pageSize:null,er=null!==Jt&&Jt>-1?0===Jt?Object(m.c)(Xe,I.NO_DATA_AVAILABLE):String.format(I.X_RECORDS_PRESENT,Jt):"",tr=gt(t,Q),rr=!(null!=U&&U===P.b.Native),nr=Object(v.rb)(t,null===(a=null==se?void 0:se.pageToEditedViewMapId)||void 0===a?void 0:a.guid,null==Ae?void 0:Ae.guid),ir={isEmptyOfflineSqlQuery:xt,isEntityAvailableForOffline:Nt,isOfflineSqlQueryAvailable:kt,offlineErrorMessageKey:Mt,isOfflineAvailableForUse:Object(J.w)(t),offlineGridErrorTelemetryParams:At},ar=Object(te.d)(t),or=Object(f.c)(t,ze),sr=!_e&&U===P.b.Web&&Q&&Z.isColumnEditorButtonEnabled&&!ye&&!ve,cr=Object(v.ub)(t,St);return{showAdvancedFilter:Le,isViewEdited:!!nr,isInitialized:Ne,viewId:ze,customFilter:de,gridEntityTypeName:We,chartEntityTypeName:We,isUCIEntity:Ct,totalRecordCountLimitExceeded:Se,chartProps:Pe?nt(t,r,c):null,viewDescriptor:ke,commandBarProps:w(y.E.COMMANDBAR_ENABLED,!0,y.F.ENABLE_CONTEXTUALACTIONS,X,!0)?it(t,r,c,C,Wt,_t):null,viewSelectorProps:Ot&&w(y.E.VIEWSELECTOR_ENABLED,!0,y.F.ENABLE_VIEW_PICKER,X)?at(t,r,c,Ot,ze,_t):null,queueFilterProps:L&&w(null,!0,y.F.ENABLE_QUEUEFILTER,X)?ot(t,r,c,St,_t):null,entityFilterProps:_e||!cr&&!Object(R.h)(t,Je,ye)?null:st(t,r,c,St,_t),jumpBarProps:w(y.E.JUMPBAR_ENABLED,Fe,y.F.ENABLE_JUMPBAR,X)&&fe(r)?ct(r,c,St,o.languageId,pe?pe.jumpBar:null,Xe):null,quickFindProps:w(y.E.QUICKFIND_ENABLED,!0,y.F.ENABLE_QUICKFIND,X)?lt(r,c,St,se):null,pagingProps:w(y.E.PAGING_ENABLED,Te,null,X)?ut(r,c,St):null,contextToken:c,controlKey:Ue,styles:_t,refreshCounter:_,pagingRefreshInput:S,pageNumber:O,ribbonId:Wt,semanticTag:oe(r.contextString),recordsPerPageSetting:Object(h.h)(t),userSetting:o,hasReadRolePrivilege:Qt,resourceStrings:Xe,switchVisualizationResourceStrings:Ke,entityTypeName:He,primaryDataSetName:X,nestedGridDatasetName:qe,viewportSm:Object(F.a)(t).sizes.Breakpoints.DimensionS,viewportM:Object(F.a)(t).sizes.Breakpoints.DimensionM,systemDefinedProperties:pt(t,r,c),platformType:Object(j.a)(t),isGridEditable:Object(v.vb)(L?L.Parameters:null),notificationMessage:er,totalResultCount:Jt,pageSize:$t,offlineProps:ir,isRTL:Object(h.g)(t),entityDisplayName:It,isOffline:_e,showChart:Pe,entityIconVectorName:Pt,webResourceUrl:jt,hasCustomDataProvider:Oe,commandBarRefreshProps:tr,updatedConfiguration:ge,offlineGridErrorTelemetryParams:At,gridInput:se,gridTotalRecordsCountLimit:je,gridSortingInfo:ue,nativeFilterExpression:Z.isGridPaginationStateFeatureEnabled&&se?se.nativeFilterExpression:null,pageNumberForEnhancedPaging:Z.isGridPaginationStateFeatureEnabled&&!rr&&se?se.gridPageNumber:null,userId:t.user&&t.user.userId||null,lookupAttributeForRecordHierarchy:Kt,fetchXML:re,viewType:Me,savedQueryType:De,featureControlProps:Z,clientHostSubtype:q,backButtonEnabled:ar,originalView:or,showColumnEditor:sr,entityIsActivityType:cr}}}function he(e,t,r,n,i){if(!n)return[];var a=ie(t.contextString),o=ae(t.contextString),s=ne(t.contextString)&&Object(M.c)(e,k.bd),c=[];for(var l in n)c.push([l,n[l]]);var u=c.reduce((function(e,t){var r=t[0],n=t[1];return(a||o||s)&&"quickFind"===r||("activityOrQueueFilterValue"===r||"activityTypeSelectedValues"===r)||!n||e.push(n),e}),[]);if(i){var d=Object(v.t)(e,t.id,r);if(d&&d.customFilterXml){var p=Object(z.i)(d.customFilterXml),h=JSON.stringify(p);h&&u.push(h)}}else{var g=Object(v.q)(e,t.id,r);g&&u.push(g)}return u}function ge(e){var t=e.configuration&&"MscrmControls.SharepointAssociatedGrid.SharepointControl"===e.configuration.CustomControlId;return t||(t=e.configuration&&"MscrmControls.SharepointAssociatedGrid.SharepointControl"===e.configuration.Name),t}function me(e){if(!e&&"("!==e[0]||")"!==e[e.length-1])throw new Error(String.format("Resource string group must be in the format (A:a).  The format {0} is invalid.",e));var t=(e=(e=e.replace("(","")).replace(")","")).split(":");if(2!==t.length)throw new Error("Resource string group must have a search list defined.  E.g : (A:a).");return t}function fe(e){var t,r,n;return"no"!==(null===(n=null===(r=null===(t=e.configuration)||void 0===t?void 0:t.Parameters)||void 0===r?void 0:r.EnableJumpBar)||void 0===n?void 0:n.Value)}function be(e,t,r,n,i,a,o){var s=e.dataSetUIOptions,c=n;if(o=!!Object(E.a)(o)||o,!s&&e.configuration&&e.configuration.Parameters){var l=e.configuration.Parameters[a];l&&l[y.f]&&(s=l[y.f])}var u=t&&t.Parameters&&t.Parameters[i]?"true"===t.Parameters[i]:o;return s&&r&&!Object(E.a)(s[r])&&(c=s[r]),c&&u}},slAZ:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"d",(function(){return s})),r.d(t,"c",(function(){return a})),r.d(t,"f",(function(){return c})),r.d(t,"b",(function(){return o})),r.d(t,"e",(function(){return l}));var n=r("Sscr"),i="controls.addCustomFilter",a="controls.startCustomFilter",o="controls.endCustomFilter";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function s(e,t,r,a,o){var s=Object(n.v)(a);return{type:i,payload:{customFilter:o,entityLogicalName:r},meta:{pageId:e,controlName:t,contextKey:s}}}function c(e,t,r){var i=Object(n.v)(r);return{type:a,payload:{},meta:{pageId:e,controlName:t,contextKey:i}}}function l(e,t,r){var i=Object(n.v)(r);return{type:o,payload:{},meta:{pageId:e,controlName:t,contextKey:i}}}},u3BH:function(e,t,r){"use strict";r.d(t,"a",(function(){return T}));var n=r("sOTk"),i=r("uOa9"),a=r("Sscr"),o=r("QAhb"),s=r("HSdq"),c=r("qC0c"),l=r("cZkS"),u=r("EGsq"),d=r("aPRd"),p=r("wV3W"),h=r("yHpA"),g=r("9rlF"),m=r("9r0m"),f=r("TV33"),b=r("H9Ho"),y=r("uQP8"),v=r("OTOS"),_=r("T2Xs"),S=r("7pqb"),O=function(){function e(e){this.previousReturn={EnableInMobile:!1,PowerBIGroupId:"",PowerBIDashboardId:"",PowerBIReportId:"",PowerBIFilter:"",TileId:"",TileUrl:"",PowerBIType:0,IsPowerBIEnabled:!1,FirstPartyIntegrationSiteUrl:"",PowerBISignedInState:"",setPowerBISignedInState:P,beginSecureSessionForResource:P},this._propKey=e}return e.prototype.linkToParameter=function(e,t){var r=this,n=t.setPowerBISignedInState;e.setPowerBISignedInState=function(e){return n(r._pageId,e)};var i=t.beginSecureSessionForResource;e.beginSecureSessionForResource=i},e.prototype.retrievePowerBIObject=function(e,t,r,g){var m,f;this._pageId=t.id;var b,O,F,T=t.descriptor.Parameters,w=Object(i.b)(e),E=r.Parameters[this._propKey],x=Object(u.z)(e);Object(c.c)(e,l.Wc)&&(O=T.PowerBIReportId,F=E.PowerBIReportId,T.PowerBIFilter&&(b=function(e,t,r){var i=Object(n.g)(e,t),c=i.entityTypeName,l=i.id,u=Object(a.j)(e,t),d=Object(s.ac)(e,t,u),p=new o.a(c,l);try{var g=JSON.parse(r),m=g.Filter,f=g.Alias;for(var b in f){var y=f[b],v=Object(h.d)(e,d,p,y),O=v&&j(v)||null;if(Array.isArray(O)){var P=O.map((function(e){return I(e,!1)})).join(",");m=m.split(b).join(P)}else m=C(m,[{placeholder:'"'+b+'"',value:I(O,!0)},{placeholder:"'"+b+"'",value:null===O?I(O,!0):"'"+encodeURIComponent(O)+"'"},{placeholder:b,value:I(O,!1)}])}return m}catch(e){return void _.a.error(S.w,[{name:"errorCategory",value:"PowerBIFilter"},{name:"errorMessage",value:null==e?void 0:e.message},{name:"callstack",value:null==e?void 0:e.stack},{name:"filter",value:r}])}}(e,this._pageId,T.PowerBIFilter)));var N=Object(y.a)(e,this._pageId).powerBISignedInState,A=Object(v.b)(e,this._pageId),k=Object(d.c)(e),M=Object(p.a)(e);return this.previousReturn={EnableInMobile:"true"===(null===(m=E.EnableInMobile)||void 0===m?void 0:m.toString().toLowerCase())||"true"===(null===(f=T.EnableInMobile)||void 0===f?void 0:f.toString().toLowerCase()),PowerBIGroupId:E.PowerBIGroupId||T.PowerBIGroupId,PowerBIDashboardId:E.PowerBIDashboardId||T.PowerBIDashboardId,PowerBIReportId:F||O,PowerBIFilter:b,TileId:E.TileId||T.TileId,TileUrl:E.TileUrl||T.TileUrl,PowerBIType:parseInt(E.PowerBIType,10)||parseInt(T.Type,10)||0,IsPowerBIEnabled:w.isPowerBIEnabled,FirstPartyIntegrationSiteUrl:w.firstPartyIntegrationSiteUrl,PowerBISignedInState:N,Tenant:x,ForceMobile:k<=M.sizes.Breakpoints.DimensionS,FormId:A,setPowerBISignedInState:P,beginSecureSessionForResource:P},this.previousReturn},e.prototype.getLatestData=function(){return this.previousReturn},e}();function C(e,t,r){void 0===r&&(r=0);var n=t[r],i=n.placeholder,a=n.value,o=e.split(i),s=r+1;if(s<t.length)for(var c in o)o[c]=C(o[c],t,s);return e=o.join(a)}function I(e,t){if(!t&&(null==e?void 0:e.length)>0){var r=Number(e);if(!isNaN(r)&&r.toString()===e)return JSON.stringify(r)}return JSON.stringify(e)}function j(e){if(Object(g.i)(e))return e.valueString;if(Object(g.g)(e))return m.a.toString(e.id);if(Object(g.k)(e))return e.reference&&m.a.toString(e.reference.id);if(Object(g.j)(e))return!Object(b.a)(e.value)&&e.value.toString();if(Object(g.h)(e)){var t=Object(f.h)(e);if(t)return t.map((function(e){return m.a.toString(m.a.fromExternalGuid(e.id))}))}else if(Object(g.f)(e)&&e.innerValue)return j(e.innerValue)}function P(){throw new Error("Not Replaced")}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var F="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlPowerBISelector";function T(){return function(e,t,r,n,i){_.a.info(r.controlId+"."+F+": createGetPowerBIData started");var a=new O(e);return a.retrievePowerBIObject(t,r,n,i),_.a.info(r.controlId+"."+F+": createGetPowerBIData finished"),a}}},uCYK:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="footer.visible";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r){var a=Object(n.v)(t);return{type:i,payload:r,meta:{pageId:e,contextKey:a}}}},"v/Fs":function(e,t,r){"use strict";r.d(t,"c",(function(){return v})),r.d(t,"d",(function(){return _})),r.d(t,"b",(function(){return S})),r.d(t,"a",(function(){return O}));var n=r("4E+q"),i=r("3/Bp"),a=r("nuS9"),o=r("2p2B"),s=r("sOTk"),c=r("UGbr"),l=r("9r0m"),u=r("xc1f"),d=r("Sscr"),p=r("HSdq"),h=r("TCDU"),g=r("r529"),m=r("Z1aD"),f=r("I0a0"),b=r("CUpQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function y(e,t){return e(Object(c.e)(t,1))}function v(e){var t=Object(n.c)(),r=Object(n.d)((function(t){return Object(d.j)(t,e)}),n.b),p=Object(n.d)((function(t){return Object(s.g)(t,e)})),m=_(e),f=m.isInCreateMode,b=m.isDirty,v=a.useCallback((function(){t(Object(o.b)(r,e,i.b)),p&&p.id&&!l.a.isNullOrEmpty(p.id)?y(t,e):t(Object(c.f)(e,u.a,!0,1,!1)).then((function(n){n&&Object(c.d)(t,r,e)}))}),[r,t,e,p]),S=a.useCallback((function(){t(f?Object(g.b)():Object(h.a)(e))}),[t,f,e]);return a.useMemo((function(){return{save:v,discard:S,isInCreateMode:f,isDirty:b}}),[S,b,f,v])}function _(e){var t=Object(n.d)((function(t){return Object(s.m)(t,e)})),r=Object(n.d)((function(r){return t||Object(p.Nb)(r,e,Object(d.j)(r,e))}));return{isInCreateMode:t,isDirty:r}}function S(e){var t=Object(n.c)(),r=Object(f.a)([b.n])[b.n],i=Object(n.d)((function(t){return Object(s.g)(t,e)})).entityTypeName;return a.useMemo((function(){return[{save:function(){return y(t,e).then((function(){return t(Object(m.a)(u.a,{entityTypeName:i},e))}))},label:r}]}),[t,i,e,r])}function O(e){var t=e.pageId,r=e.children,n=v(t);return r(n.save,n.isDirty)}},vqdi:function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n=r("OROb"),i=r("lMVv"),a=r("sgPk"),o=r("C8Q/"),s=r("ig6i"),c=r("cm3g"),l=r("9r0m"),u=r("HSdq"),d=r("Sscr"),p=r("sOTk"),h=r("Gemh"),g=r("0hZT"),m=r("fE8x"),f=r("r454"),b=r("cZkS"),y=r("qC0c"),v=r("EcZf"),_=r("YEEA");function S(e,t,r,S,O,C,I,j){return void 0===I&&(I=!1),{type:"embeddedEntity.save",execute:function(S,P){var F,T=S.getState(),w=new l.a(r),E=Object(d.f)(j,w,t);switch(Object(p.l)(T,e)){case g.a:F=Object(h.R)(T,e,E);break;default:F=Object(u.ac)(T,e,E)}var x=Object(m.c)(T),N=Object(m.b)(T);if((x||N)&&"Dashboard"!==Object(p.l)(T,e)){var A=P.ScriptManager.getContainer(e).getEventManager();if(S.dispatch(A.runOnSave(j,1,null,r)))return Promise.reject(Object(_.b)(T,e,2200000005,""))}return S.dispatch(Object(n.c)(F,I,O)).then((function(n){var u=Object(h.qb)(T,new l.a(C),e),d=Object(i.h)(T,t),p=a.a.fromXmlAndSql(u.fetchXML,u.offlineSqlQuery,u.viewId,null,u.entityLogicalName,S.getState);return p.where(new o.a("eq",new s.a(t,d.PrimaryIdAttribute),new c.a(r))),S.dispatch(Object(v.d)(p.getQueryState())).then((function(){return n}))})).catch((function(e){return Object(y.a)(T,b.xb)&&F&&S.dispatch(Object(f.b)(F,!1)),Promise.reject(e)}))}}}},w82B:function(e,t,r){"use strict";r.d(t,"a",(function(){return P}));var n=r("cZkS"),i=r("9r0m"),a=r("G7N+"),o=r("9LTA"),s=r("8Fmj"),c=r("7dGM"),l=r("dUXI"),u=r("y5DA"),d=r("gBKR"),p=r("mGpW"),h=r("olrR"),g=r("Ww2r"),m=r("RlP9"),f=r("kl3Z"),b=r("+Z9T"),y=r("vUcA"),v=r("Z46F"),_=r("WS0f"),S=r("KDdL"),O=r("8ADW");function C(e,t,r){return{type:"chartData.retrieve.preReq_async",execute:function(n,C){var I=n.dispatch,j=n.getState,P=j(),F=O.b+".chartData.retrieve.preReq_async",T=e.visualizationId,w=e.viewId;return I(Object(h.a)(t,void 0,e.viewType,w)).then((function(){P=j();var n=Object(m.c)(P,w);if(!function(e,t,n,i){if(!n||!n.fetchXML)return Object(u.a)(e,t,Object(g.b)(e,l.g),i,r),!1;return!0}(P,I,n,e))return Promise.resolve(null);var h=I(Object(s.a)(t,e.visualizationType,T)),b=I(Object(p.e)(l.A));return Promise.all([h,b]).then((function(){var t,s;P=j();var h=Object(c.a)(P,T);if(function(e){if(e&&e.WebResourceId)return!0;return!1}(h))return Object(o.d)(P,I,i.a.toString(e.visualizationId),i.a.toString(e.viewId),r),Promise.resolve(e);if(!function(e,t,n,i){if(n){if(n.initialized===a.a.Error){var o=Object(y.a)(n.errorCode)||l.u;return t(Object(p.e)([o])).then((function(){var n=Object(g.b)(e,o);Object(u.a)(e,t,n,i,r)}),(function(){Object(u.a)(e,t,Object(g.b)(e,l.u),i,r)})),!1}return!!n.DataDescription||(Object(u.a)(e,t,Object(g.b)(e,l.o),i,r),!1)}return!1}(P,I,h,e))return Promise.resolve(null);e.initialized||(e.initialize(h.DataDescription,n.fetchXML,h.PresentationDescription,n.title,n.entityLogicalName,h.Name,h.PrimaryEntityTypeCode,!1),e.setupAggregationQueries());var m={},b=e.dataDefinition.allAttributeNamesByEntity;Array.from(b.keys()).map((function(e){var t=Array.from(b.get(e).keys());m[e]=t}));var v=Object(f.c)(n).filter((function(e){return-1===e.indexOf(".")}));if(v&&v.length>0){var O=n.entityLogicalName;O in m?(t=m[O]).push.apply(t,v):m[O]=v}try{var w=h.PresentationDescription,E=Object(S.a)(w);if(!Object(_.b)(w)&&E.length>0){var x=n.entityLogicalName,N=[];N.push(function(e,t){var r=t[2]?t[2].toLowerCase():"";if(r.substring(0,e.length)!==e)return"";return r.substring(e.length+1,r.length)}(x,E)),x in m?(s=m[x]).push.apply(s,N):m[x]=N}}catch(e){var A="Failed to retrieve entity metadata attributes for Chart Series with error : "+e.message;C.EventManager.ReportComponentFailure(F,Error(A))}return I(Object(d.e)(m)).then((function(){return e}))}),(function(t){return Object(u.b)(t.getNegativeErrorCode(),j(),I,Object(g.b)(j(),l.q),e,r),Promise.resolve(null)}))}),(function(t){var n=t&&!Object(b.a)(t.errorCode)&&t.errorCode,i=Object(y.a)(n),a=i?Object(g.b)(P,i):"retrieve chart failed. error code: "+v.a.getHexErrorCodeFromInt(n);return Object(u.a)(P,I,a,e,r),Promise.resolve(null)}))}}}var I=r("Fpc+"),j=r("qC0c");function P(e,t,r,s){return void 0===s&&(s=!1),{type:"chartData.retrieve.async",execute:function(l,u){var d=l.dispatch,p=l.getState,h=[];try{h.push({name:O.g,value:i.a.toString(e.viewId)}),h.push({name:O.h,value:i.a.toString(e.visualizationId)});var g=p(),m=e.visualizationId,f=i.a.toString(m),b=e.viewId,y=i.a.toString(b);if(!Object(S.b)(p,d,u,h,e,t,r))return Promise.resolve();var v=void 0,_=Object(j.c)(g,n.rd);return((v=_?Object(c.e)(g,e.getStorageKey()):Object(c.d)(g,f,y))===a.a.Initialized&&Object(c.b)(g,f,y)||v===a.a.Initializing)&&!s?Promise.resolve():(d(_?Object(S.d)(e.getStorageKey(),I.c):Object(S.c)(f,y,I.c)),d(C(e,t,r)).then((function(e){if(!e||e.isWebResourceChart)return Promise.resolve();var n=e;return d(Object(o.b)(n,t,r))})))}catch(e){return u.EventManager.ReportComponentFailure(S.f+".retrieveChartData",Error(e),O.b,h),Promise.reject(e)}}}}},whwt:function(e,t,r){"use strict";r.d(t,"a",(function(){return y})),r.d(t,"b",(function(){return v}));var n=r("Sscr"),i=r("uO/V"),a=r("8Fmj"),o=r("RlP9"),s=r("9r0m"),c=r("Gemh"),l=r("7dGM"),u=r("lMVv"),d=r("Zdrd"),p=r("cqI9"),h=r("z9yS"),g=r("mGpW"),m=r("dUXI"),f=r("JlqV"),b=r("zETL"),y="chart.showChart.update";function v(e,t,r){return{type:"chart.showChart.update.async",execute:function(y,v){var S=y.dispatch,O=y.getState,C=v.TraceManager.getTracer(i.z),I=i.x+".updateShowChartAction";try{C.info("Updating the show chart"),t||(t=Object(n.k)(O(),e));var j=O(),P=Object(n.v)(t),F=Object(c.T)(j,e,t),T=Object(o.c)(j,F),w=T&&T.entityLogicalName,E=Object(c.r)(j,e,t,w),x=Object(c.s)(j,e,t),N=Object(l.a)(j,E),A=N&&N.PrimaryEntityTypeCode,k=A&&Object(u.m)(j,parseInt(A,10));w&&k&&w!==k&&(E=null,x=h.a.savedvisualization);var M=Object(l.i)(j,w);if(E&&M&&M.chartTypes&&Object.keys(M.chartTypes).length>0){var D=s.a.toString(E);x=D in M.chartTypes[h.a[h.a.savedvisualization]]?h.a.savedvisualization:h.a.uservisualization}return r?Object(f.b)(O())?(S(Object(g.e)(m.A)).then((function(){S(Object(a.a)(w,x,E)).then((function(r){return s.a.isNullOrEmpty(r)?(x=h.a.uservisualization,S(Object(d.b)(e,t,x)).then((function(){return S(Object(a.a)(w,x,E)).then((function(e){return Promise.resolve(e)}))}))):Promise.resolve(r)})).then((function(n){var i=s.a.toString(n);Promise.all([S(Object(p.b)(e,t,i)),S(Object(d.b)(e,t,x)),S(_(e,P,r))]).then((function(){return v.EventManager.ReportComponentSuccess(I),S(Object(b.b)(e,t)),Promise.resolve()}))}))})).catch((function(e){return v.EventManager.ReportComponentFailure(I,Error("Retrieve resource strings for chart failed")),Promise.reject(e)})),Promise.resolve()):Promise.resolve():(S(_(e,P,r)),v.EventManager.ReportComponentSuccess(I),Promise.resolve())}catch(e){var R="Update the show chart failed with error : "+e.message;v.EventManager.ReportComponentFailure(I,Error(R))}}}}function _(e,t,r){return{type:y,payload:{name:"showChart",value:r},meta:{pageId:e,dataSetContextKey:t}}}},x6Ak:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("Sscr"),i="refresh.timer";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r){var a=Object(n.x)(t);return{type:i,payload:null,meta:{pageId:e,contextKey:a,controlName:r}}}},xirW:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r("UOiB"),i=r("Sscr"),a=r("krRo"),o="attribute.notification.update";function s(e,t,r,s,c){return{type:"attribute.notification.add.clear.form.notification",sync:!0,execute:function(e,l){e.dispatch(function(e,t,r,s){if(s&&s.contextTokenType&&s.contextTokenType===n.a.GridRow)return Object(a.d)(e,s,t,r);var c=Object(i.x)(s);return{type:o,payload:r,meta:{pageId:e,contextKey:c,dataFieldName:t}}}(t,r,s,c))}}}},y5DA:function(e,t,r){"use strict";r.d(t,"c",(function(){return d})),r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return h}));var n=r("9LTA"),i=r("Ww2r"),a=r("dUXI"),o=r("BuSU"),s=r("Je7O"),c=r("cZkS"),l=r("qC0c"),u=r("9r0m");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function d(e,t,r,n,o){var s=null;if(s=Object(i.b)(e,a.q),"function"==typeof r.get_ErrorCode)switch(r.get_ErrorCode()){case-2147093999:s=Object(i.b)(e,a.r);break;case-2147220960:s=Object(i.b)(e,a.o);break;case-2147164125:s=Object(i.b)(e,a.a);break;case-2147164130:case-2147164126:s=Object(i.b)(e,a.j);break;case-2147217149:s=Object(i.b)(e,a.i);break;case-2147217098:s=Object(i.b)(e,a.x);break;case-2147220969:case-2147187962:s=Object(i.b)(e,a.p);break;default:r.get_Message()&&(s=s+" "+r.get_Message())}p(e,t,s,n,o)}function p(e,t,r,i,a){var d;d=function(e){var t=Object(o.a)();return t.ErrorInformation=new s.a,t.ErrorInformation.set_ErrorDescription(e),t}(r),Object(l.c)(e,c.rd)?(t(Object(n.a)(i.getStorageKey(),d)),Object(n.e)(e,t,i.getStorageKey(),a)):(t(Object(n.c)(u.a.toString(i.visualizationId)||u.a.EMPTYGUIDSTRING,u.a.toString(i.viewId)||u.a.EMPTYGUIDSTRING,d)),Object(n.d)(e,t,u.a.toString(i.visualizationId)||u.a.EMPTYGUIDSTRING,u.a.toString(i.viewId)||u.a.EMPTYGUIDSTRING,a))}function h(e,t,r,n,o,s){p(t,r,-2147220960===e?Object(i.b)(t,a.o):n,o,s)}},ya7l:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("4Tx6"),i=r("Z1aD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function a(e,t,r,a,o,s,c,l){var u={powerBIEmbedUrl:t,powerBIGroupId:r,powerBIDashboardId:a,powerBITileId:o,powerBIReportId:s,powerBIReportUrl:c,powerBIComponentTypeCode:l};return Object(i.a)(n.a,u,e,{target:"dialog"})}},zSKH:function(e,t,r){"use strict";r.d(t,"a",(function(){return ae}));var n=r("c/eZ"),i=r("nuS9"),a=r("lU69"),o=r("4E+q"),s=r("HSdq"),c=r("sOTk"),l=r("HRxj"),u=r("YWpA"),d=r("H/hG"),p=r("wV3W"),h=r("vO+w"),g=r("LAsh");var m=r("Sscr"),f=r("f3SV"),b=r("3wMZ"),y=r("yji3"),v=r("UIMH"),_=r("Tr6b"),S=r("Wi7Z"),O=r("MGMD"),C=r("5olG"),I=r("Ww2r"),j=r("Ingk"),P=r("swEE"),F=r("DgF7"),T=r("i8/j"),w=r("LWFb"),E=r("kyRo"),x=r("Srej"),N=r("uQP8"),A=r("NiE3"),k=r("2OIc"),M=r("HHlV"),D=r("iFdD"),R=function(e){function t(t){var r=e.call(this,t)||this;return r.onMeasuring=r.onMeasuring.bind(r),r.state={columnLayout:window.innerWidth<=t.breakpointForSectionReflow?1:null,forceSmallLayout:null},r}return Object(n.__extends)(t,e),t.prototype.onMeasuring=function(e){if(e>0){var t=this._getColumnLayout(e),r=this.props.customStyle&&this.props.customStyle.paddingLeft?parseFloat(this.props.customStyle.paddingLeft.toString()):0,n=this.props.customStyle&&this.props.customStyle.paddingLeft?parseFloat(this.props.customStyle.paddingRight.toString()):0,i=e-Object(C.a)(r+n)<this.props.cellBreakPointWidthInPx;t===this.state.columnLayout&&this.state.forceSmallLayout===i||this.setState({columnLayout:t,forceSmallLayout:i});var a=[{name:"currentWidth",value:e},{name:"currentColumnLayout",value:t.toString()}];this.context.TraceManager.getTracer("Forms.Section").debug("Column layout for section",a)}},t.prototype._transformStyle=function(){var e=null===this.state.columnLayout?{visibility:"hidden"}:null,t=this.props.pageType&&"quickcreate"===this.props.pageType?{boxShadow:"none"}:null,r=this._isSectionSidePaddingAdded()?null:{paddingLeft:"0px",paddingRight:"0px"},i=this._isSectionTopPaddingAdded()?null:{paddingTop:"0px"};return Object(n.__assign)(Object(n.__assign)(Object(n.__assign)(Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},this.props.sectionStyle),this.props.customStyle),e),t),r),i)},t.prototype._isSectionSidePaddingAdded=function(){return!this.props.noSidePaddingMode||this.props.clientHostSubtype!==P.a.Phone},t.prototype._isSectionTopPaddingAdded=function(){return(!this.props.noTopPaddingMode||1!==this.props.descriptor.Columns)&&!this._isSectionSidePaddingAdded()||this.props.clientHostSubtype!==P.a.Phone},t.prototype._sectionHasSingleColumnCells=function(e){for(var t=0,r=e;t<r.length;t++)for(var n=0,i=r[t].Cells;n<i.length;n++){var a=i[n];if(a.ControlName&&a.ColSpan>1)return!1}return!0},t.prototype._getColumnLayout=function(e){return e>0&&e<this.props.breakpointForSectionReflow?1:0},t.prototype._renderRowsAsColumns=function(e){for(var t,r,a=[],o=[],s=0;s<this.props.numberOfColumns;s++)a[s]=[];for(var c=0;c<e.length;c++)o[c]=[];for(var d=0,p=0,h=e;p<h.length;p++){s=0;for(var g=0,m=h[p].Cells;g<m.length;g++){for(var f=m[g];o[d][s]&&s<this.props.numberOfColumns;)s++;if(a[s]){for(var b=d;b<d+f.RowSpan;b++)o[b]||(o[b]=[]),o[b][s]=!0;var y=Object(C.a)(this.props.cellHeightInRem)*f.RowSpan,v=Object(n.__assign)(Object(n.__assign)({},this.props.cellContainerStyle),this.props.customCellContainerStyle),S=!0;f.ControlName&&this.props.controlVisibilityByName&&-1!==Object.keys(this.props.controlVisibilityByName).indexOf(f.ControlName)&&(S=this.props.controlVisibilityByName[f.ControlName]);var O=i.createElement(u.a,{key:f.Id,style:v},i.createElement(l.a,{domId:Object(x.g)(f.DomId,this.props.id),previewId:f.PreviewId,id:this.props.id,controlName:f.ControlName,userSpacer:f.UserSpacer,rowSpan:f.RowSpan,columnSpan:1,autoExpand:f.AutoExpand,style:this.props.cellStyle,cellSizeMode:this.state.forceSmallLayout?2:0,shouldRender:this.props.shouldRender,scope:_.a.EditForm,overriddenVisibility:S,availableForPhone:f.AvailableForPhone,inDialogWithZIndex:this.props.inDialogWithZIndex,intersectionObserverHelper:this._getIntersectionObserverHelperForCell(),cellLabelPosition:null===(r=null===(t=this.props.descriptor)||void 0===t?void 0:t.CellLabel)||void 0===r?void 0:r.Position,isParentPaddingAdded:this._isSectionSidePaddingAdded()})),I=i.createElement(u.a,{style:Object(n.__assign)(Object(n.__assign)({},this.props.spacerContainerStyle),{minHeight:y.toString()+"px"})},i.createElement(u.a,{style:this.props.spacerStyle}));a[s].push(f.ControlName?O:f.UserSpacer?I:null)}s++}d++}var j=0===this.state.columnLayout?Math.floor(100/this.props.numberOfColumns)+"%":"100%",P=[];for(s=0;s<this.props.numberOfColumns;s++){var F=s<this.props.numberOfColumns-1?{paddingRight:"1.5rem"}:{};P.push(i.createElement(u.a,{style:Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},this.props.columnStyle),{width:j}),F)},a[s]))}return i.createElement(u.a,{key:"section-columns-wrapper",style:this.props.columnsWrapperStyle},P)},t.prototype._renderRowsAfterReflow=function(e){for(var t,r,a=[],o=0,s=e;o<s.length;o++)for(var c=0,d=s[o].Cells;c<d.length;c++){var p=d[c];if(p.ControlName){var h=!0;this.props.controlVisibilityByName&&-1!==Object.keys(this.props.controlVisibilityByName).indexOf(p.ControlName)&&(h=this.props.controlVisibilityByName[p.ControlName]),a.push(i.createElement(l.a,{key:p.Id,id:this.props.id,domId:Object(x.g)(p.DomId,this.props.id),previewId:p.PreviewId,controlName:p.ControlName,rowSpan:p.RowSpan,columnSpan:p.ColSpan,autoExpand:p.AutoExpand,cellSizeMode:this.state.forceSmallLayout?2:0,shouldRender:this.props.shouldRender,style:Object(n.__assign)(Object(n.__assign)({},this.props.cellStyle),this.props.reflowCellStyle),availableForPhone:p.AvailableForPhone,overriddenVisibility:h,inDialogWithZIndex:this.props.inDialogWithZIndex,intersectionObserverHelper:this._getIntersectionObserverHelperForCell(),isParentPaddingAdded:this._isSectionSidePaddingAdded(),cellLabelPosition:null===(r=null===(t=this.props.descriptor)||void 0===t?void 0:t.CellLabel)||void 0===r?void 0:r.Position}))}}return i.createElement(u.a,null,a)},t.prototype._renderRowsInTable=function(e){var t,r,o=[],s=[],c=Object(C.a)(this.props.cellHeightInRem);for(var d in e){o=[];for(var p=0,h=e[d].Cells;p<h.length;p++){var g=h[p],m=c*g.RowSpan,_=!0;g.ControlName&&this.props.controlVisibilityByName&&-1!==Object.keys(this.props.controlVisibilityByName).indexOf(g.ControlName)&&(_=this.props.controlVisibilityByName[g.ControlName]);var O=g.ControlName?i.createElement(l.a,{key:g.Id,id:this.props.id,domId:Object(x.g)(g.DomId,this.props.id),previewId:g.PreviewId,controlName:g.ControlName,rowSpan:g.RowSpan,columnSpan:g.ColSpan,autoExpand:g.AutoExpand,style:this.props.cellStyle,cellSizeMode:this.state.forceSmallLayout?2:0,shouldRender:this.props.shouldRender,availableForPhone:g.AvailableForPhone,overriddenVisibility:_,inDialogWithZIndex:this.props.inDialogWithZIndex,intersectionObserverHelper:this._getIntersectionObserverHelperForCell(),isParentPaddingAdded:this._isSectionSidePaddingAdded(),cellLabelPosition:null===(r=null===(t=this.props.descriptor)||void 0===t?void 0:t.CellLabel)||void 0===r?void 0:r.Position}):g.UserSpacer?i.createElement(u.a,{style:Object(n.__assign)(Object(n.__assign)({},this.props.spacerContainerStyle),{minHeight:m.toString()+"px"})},i.createElement(u.a,{style:this.props.spacerStyle})):i.createElement(u.a,{style:this.props.emptyCellStyle});g.ControlName&&void 0!==_&&!_||o.push(i.createElement(v.a,{role:S.r,style:this.props.tableCellStyle,id:Object(x.g)(Object(a.a)(),this.props.id),key:g.Id,rowSpan:g.RowSpan,colSpan:g.ColSpan},O))}s.push(i.createElement(y.a,{role:S.r,key:this.props.id+"_row_"+d},o))}return i.createElement(b.a,{role:S.r,style:this.props.tableStyle,key:this.props.id+"_table"},i.createElement(f.a,{role:S.r,key:this.props.id+"_tablebody"},s))},t.prototype._renderLegend=function(e,t){var r;return t&&e?i.createElement(d.a,{semanticTag:"legend",style:this._isSectionSidePaddingAdded()?this.props.legendStyle:this.props.legendNoSectionSidePaddingStyle},i.createElement(d.a,Object(n.__assign)({semanticTag:"h2",style:this.props.legendTextStyle},((r={})[O.a.LearningPathDOMAttributeName]="form-sectionHeader-"+this.props.sectionName,r),{testhooks:{id:"form-sectionHeader-"+this.props.sectionName},title:e}),e)):null},t.prototype._renderHeaderFooterFields=function(e){var t=this;return e.map((function(e){var r,a;return i.createElement(l.a,{key:e.Id,id:t.props.id,previewId:e.PreviewId,controlName:e.Name,shouldRender:t.props.shouldRender,cellSizeMode:t.state.forceSmallLayout?2:0,style:Object(n.__assign)(Object(n.__assign)({},t.props.cellStyle),t.props.headerFooterFieldCellStyle),inDialogWithZIndex:t.props.inDialogWithZIndex,intersectionObserverHelper:t._getIntersectionObserverHelperForCell(),cellLabelPosition:null===(a=null===(r=t.props.descriptor)||void 0===r?void 0:r.CellLabel)||void 0===a?void 0:a.Position})}))},t.prototype._renderHeaderFooterSection=function(){for(var e,t="headerFooterFieldSection",r=!1,n=(this.props.shouldRenderHeaderFields?this.props.headerFields:[]).concat(this.props.shouldRenderFooterFields?this.props.footerFields:[]),a=0,o=n;a<o.length;a++){if(o[a].Visible){r=!0;break}}if(!((this.props.shouldRenderHeaderFields&&0!==this.props.headerFields.length||this.props.shouldRenderFooterFields&&0!==this.props.footerFields.length)&&r))return null;var s=this._transformStyle();return i.createElement(u.a,{onMeasuring:this.onMeasuring,isRequestedMeasuring:!0,id:t,semanticTag:"section",style:s,testhooks:(e={id:t},e[w.b]=this.props.headerPreviewId,e[w.c]=5,e),accessibilityLabel:"Header and Footer"},i.createElement(u.a,{key:"field-set-wrapper",style:this.props.contentStyle},null!==this.state.columnLayout&&null!==this.state.forceSmallLayout&&this._renderHeaderFooterFields(n)))},t.prototype._renderContent=function(){var e,t=this.props.label,r=this.props.descriptor,n=r.Rows,a=r.ShowLabel;return e=1===this.props.numberOfColumns||this._sectionHasSingleColumnCells(n)?this._renderRowsAsColumns(n):1===this.state.columnLayout?this._renderRowsAfterReflow(n):this._renderRowsInTable(n),i.createElement(u.a,{key:"field-set-wrapper",style:this.props.contentStyle},this._renderLegend(t,a),e)},t.prototype.render=function(){var e;if(this.props.isHeaderOrFooterSection)return this.props.clientHostSubtype!==P.a.Phone||this.props.isHeaderSectionAvailableForPhone||this.props.isFooterSectionAvailableForPhone?this._renderHeaderFooterSection():null;var t=this.props.descriptor;if(!t)return null;if(this.props.clientHostSubtype===P.a.Phone&&null!==t.AvailableForPhone&&void 0!==t.AvailableForPhone&&!t.AvailableForPhone)return null;if(!this.props.visible)return null;if(!this.props.shouldSectionRender)return null;var r=null!==this.state.columnLayout&&null!==this.state.forceSmallLayout,n=r?this._transformStyle():void 0,a=this.props.label?this.props.label:null;return i.createElement(u.a,{onMeasuring:this.onMeasuring,isRequestedMeasuring:!0,id:t.DomId,style:n,semanticTag:"section",testhooks:(e={id:this.props.sectionName},e[w.b]=this.props.descriptor.PreviewId,e[w.c]=5,e),accessibilityLabel:a},r&&this._renderContent())},t.prototype._getIntersectionObserverHelperForCell=function(){return this.props.isHeaderOrFooterSection?null:this.props.intersectionObserverHelper},t}(i.Component);function B(){var e,t;return function(r){return t!==r&&(e=function(e){if(!e)return null;var t=0;switch(e.Columns){case 1:t=1;break;case 11:t=2;break;case 111:t=3;break;case 1111:t=4}for(var r=0,n=0,i=e.Rows;n<i.length;n++){var a=i[n].Cells.reduce((function(e,t){return e+(t.ColSpan?t.ColSpan:1)}),0);r=Math.max(r,a)}return Math.max(r,t)}(t=r)),e}}R.displayName="Section";var L=Object(o.a)((function(){var e,t,r,n,i=(e=null,t=null,r=null,n=null,function(i,a){var o,s=Object(p.a)(i),c=Object(h.c)(i),l=Object(h.a)(i),u=null==l?void 0:l.Colors;if(t!==s||r!==c||n!==u){t=s,r=c,n=u;var d=Object(g.a)(s);e={sectionStyle:{display:"block",backgroundColor:c?null===(o=null==u?void 0:u.Palette)||void 0===o?void 0:o.Primary01:s.colors.BaseColor.White,boxShadow:"0px 0px 9px -1px "+s.colors.BaseColor.White},contentStyle:{flex:"1 1 auto",display:"block",width:"100%"},columnsWrapperStyle:{flex:"1 1 auto",flexWrap:"wrap",flexDirection:"row"},columnStyle:{display:"block",boxSizing:"border-box"},cellContainerStyle:{display:"block",flex:"0 1 auto",width:"100%"},headerStyle:{color:s.colors.MainThemeColor.MainColor1.Fill||"#000080",fontSize:s.fontSizes.Header.Header3,fontWeight:600},tableStyle:{width:"100%",tableLayout:"fixed"},emptyCellContainerStyle:{flex:"0 1 auto",whiteSpace:"nowrap",overflow:"hidden"},emptyCellStyle:{width:"100%"},spacerContainerStyle:{flex:"0 1 auto",width:"100%",whiteSpace:"nowrap",overflow:"hidden"},spacerStyle:{width:"100%"},tableCellStyle:{height:"1px"},reflowCellStyle:{flex:"1 1 auto"},headerFooterFieldCellStyle:{flex:"1 1 auto"},legendStyle:{height:s.sizes.Measures.Measure225,lineHeight:s.sizes.Measures.Measure225,marginBottom:s.sizes.Measures.Measure025,width:"inherit"},legendNoSectionSidePaddingStyle:{height:s.sizes.Measures.Measure225,lineHeight:s.sizes.Measures.Measure225,marginBottom:s.sizes.Measures.Measure025,paddingLeft:d.paddingLeft,paddingRight:d.paddingRight,width:"auto"},legendTextStyle:{color:s.colors.BaseColor.Grey.Grey7,fontSize:s.fontSizes.Font125,fontFamily:s.fontFamilies.Regular,fontWeight:"normal",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}}}return e}),a=Object(s.ed)(),o=Object(s.dd)(),l=B(),u=Object(I.h)(),d=Object(s.bd)();return function(e,t){var r=Object(m.j)(e,t.id),n=Object(s.qc)(e,t,r),h=Object(s.fb)(e,t,r),g=Object(N.b)(e,t.id,r),f=h&&h.Header,b=f&&Object(x.g)(f.DomId,t.id),y=f&&f.PreviewId,v=Object(s.gd)(e,t,r),_=Object(s.tc)(e,t,r),S=Object(s.rc)(e,t,r),O=Object(c.k)(e,t),I=a(e,{id:t.id,contextToken:r}),P=o(e,{id:t.id,contextToken:r}),w=i(e,t),E=Object(A.b)(e,0),R=function e(t,r,n,i){var a,o,s,c,l,u,d,p,h,g,m,f,b=null===(c=null===(s=null===(o=null===(a=null==n?void 0:n.Rows)||void 0===a?void 0:a[0])||void 0===o?void 0:o.Cells)||void 0===s?void 0:s[0])||void 0===c?void 0:c.ControlName;if(Object(k.c)(t,null===(u=null===(l=null==i?void 0:i.Controls)||void 0===l?void 0:l[b])||void 0===u?void 0:u.UniqueId,null==i?void 0:i.Id)===M.d){var y=Object(D.b)(r,b),v=null===(d=Object(N.a)(t,y))||void 0===d?void 0:d.formId;if(!y||!v)return{firstControlName:b,firstControlComponentId:r,firstControlFormId:null==i?void 0:i.Id};var _=Object(T.j)(t,v),S=null===(f=null===(m=null===(g=null===(h=null===(p=null==_?void 0:_.Tabs)||void 0===p?void 0:p[0])||void 0===h?void 0:h.Columns)||void 0===g?void 0:g[0])||void 0===m?void 0:m.SectionNames)||void 0===f?void 0:f[0];return e(t,y,Object(T.t)(t,v,S),_)}return{firstControlName:b,firstControlComponentId:r,firstControlFormId:null==i?void 0:i.Id}}(e,t.id,n,h),B=R.firstControlName,L=R.firstControlComponentId,V=R.firstControlFormId,z=Object(A.a)(e,L,V,B),G=d(e,t,r),W=Object(p.a)(e),H=l(n),U=function(e,t){if(!e||!t)return null;var r=Object(C.c)();return t*e.sizes.Section.SectionWidth-2*(t-1)*r}(W,H),q=u(e,j.a),X=Object(F.e)(e),K=Object(T.q)(e,g),Q=Object(T.p)(e,g),Y=W.sizes.Section.CellBreakPointWidth;return{sectionStyle:w.sectionStyle,contentStyle:w.contentStyle,columnsWrapperStyle:w.columnsWrapperStyle,columnStyle:w.columnStyle,cellContainerStyle:w.cellContainerStyle,headerStyle:w.headerStyle,tableStyle:w.tableStyle,emptyCellContainerStyle:w.emptyCellContainerStyle,emptyCellStyle:w.emptyCellStyle,spacerContainerStyle:w.spacerContainerStyle,spacerStyle:w.spacerStyle,tableCellStyle:w.tableCellStyle,reflowCellStyle:w.reflowCellStyle,headerFooterFieldCellStyle:w.headerFooterFieldCellStyle,legendStyle:w.legendStyle,legendNoSectionSidePaddingStyle:w.legendNoSectionSidePaddingStyle,legendTextStyle:w.legendTextStyle,noSidePaddingMode:E,noTopPaddingMode:z,descriptor:n,headerDomId:b,headerPreviewId:y,shouldSectionRender:v,visible:_,mediumBreakpoint:W.sizes.Breakpoints.DimensionM,label:S,pageType:O,headerFields:I,footerFields:P,numberOfColumns:H,breakpointForSectionReflow:U,cellHeightInRem:W.sizes.Section.cellHeightInRem,clientHostSubtype:X,resourceStrings:q,controlVisibilityByName:G,isHeaderSectionAvailableForPhone:K,isFooterSectionAvailableForPhone:Q,cellBreakPointWidthInPx:Y}}}))(R);R.contextType=E.a;var V=r("ASFs"),z=r("NJzV"),G=r("S2mk"),W=r("7EJx");function H(e){var t=Object(n.__assign)(Object(n.__assign)({},e.referencePanelSectionStyle),e.customStyle);return e.isRTL?Object(n.__assign)(Object(n.__assign)({},t),{paddingLeft:"0rem"}):Object(n.__assign)(Object(n.__assign)({},t),{paddingRight:"0rem"})}function U(e){if(!e.visible)return null;var t=Object(G.B)("MscrmControls.Containers.ReferencePanelControl"),r=e.sectionDescriptor.DomId,n=isNaN(Number.parseInt(e.sectionDescriptor.Height,10))?10:Number.parseInt(e.sectionDescriptor.Height,10);return i.createElement(u.a,{id:r,style:H(e),semanticTag:"section",testhooks:{id:e.sectionName}},i.createElement(z.c,{key:"MscrmControls.Containers.ReferencePanelControl",controlId:"MscrmControls.Containers.ReferencePanelControl",id:e.id,descriptor:e.controlDescriptor,configuration:t,parentContextToken:e.contextToken,rowSpan:n}))}U.displayName="ReferencePanelSection";var q=Object(o.a)((function(){var e,t,r,n,i,a=(e=null,t=null,function(r,n){var i=Object(p.a)(r);return t!==i&&(t=i,e={referencePanelSectionStyle:{display:"block",backgroundColor:i.colors.BaseColor.White,boxShadow:"0px 0px 9px -1px "+i.colors.BaseColor.White},contentStyle:{flex:"1 1 auto",display:"block",width:"100%"},spacerContainerStyle:{flex:"0 1 auto",width:"100%",whiteSpace:"nowrap",overflow:"hidden"},spacerStyle:{width:"100%"},legendStyle:{height:i.sizes.Measures.Measure225,lineHeight:i.sizes.Measures.Measure225,marginBottom:i.sizes.Measures.Measure025},legendTextStyle:{color:i.colors.BaseColor.Blue.Blue4,fontSize:i.fontSizes.Font125,fontFamily:i.fontFamilies.Regular,fontWeight:"normal",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}}),e}),o=(n="",function(e,t,i){return i.Name!==n&&(r={Id:i.Name+"_control",Label:i.Label,Name:i.Name+"_control",ShowLabel:i.ShowLabel,Visible:i.Visible,Disabled:!1},n=i.Name),r}),l=(i=null,function(e,t){var r=Object(m.j)(e,t.id);return Object(V.e)(i,r)||(i=r),i});return function(e,t){var r=l(e,t),n=Object(s.qc)(e,t,r),i=o(e,t,n),u=Object(s.gd)(e,t,r),d=Object(s.tc)(e,t,r),p=Object(s.rc)(e,t,r),h=Object(c.k)(e,t),g=a(e,t),m=Object(W.g)(e);return{contextToken:r,referencePanelSectionStyle:g.referencePanelSectionStyle,contentStyle:g.contentStyle,spacerContainerStyle:g.spacerContainerStyle,spacerStyle:g.spacerStyle,legendStyle:g.legendStyle,legendTextStyle:g.legendTextStyle,sectionDescriptor:n,controlDescriptor:i,shouldSectionRender:u,visible:d,label:p,pageType:h,isRTL:m}}}))(U);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var X=r("qC0c"),K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.transformDeviceStyle=function(){return Object(n.__assign)(Object(n.__assign)({},this.props.columnStyle.columnStyle),this.props.customStyle)},t.prototype.render=function(){var e=this,t=this.props.column,r=null==t?void 0:t.SectionNames[0],n=[];if(this.props.shouldRenderHeaderFields||this.props.shouldRenderFooterFields){n.push(i.createElement(L,{key:"headerFooterSection",id:this.props.id,sectionName:"headerFooterSection",isHeaderOrFooterSection:!0,shouldRender:this.props.shouldRender,shouldRenderHeaderFields:this.props.shouldRenderHeaderFields,shouldRenderFooterFields:this.props.shouldRenderFooterFields,customStyle:this.props.sectionStyle,cellStyle:this.props.cellStyle,customCellContainerStyle:this.props.cellContainerStyle,inDialogWithZIndex:this.props.inDialogWithZIndex,intersectionObserverHelper:this.props.intersectionObserverHelper}))}return t.SectionNames.map((function(t){e.props.referencePanelSectionNames&&e.props.referencePanelSectionNames.length>0&&e.props.referencePanelSectionNames.indexOf(t)>-1?n.push(i.createElement(q,{id:e.props.id,key:t,sectionName:t,shouldRender:e.props.shouldRender,customStyle:e.props.sectionStyle})):n.push(i.createElement(L,{key:t,id:e.props.id,sectionName:t,shouldRender:e.props.shouldRender,customStyle:e.props.sectionStyle,cellStyle:e.props.cellStyle,customCellContainerStyle:e.props.cellContainerStyle,inDialogWithZIndex:e.props.inDialogWithZIndex,intersectionObserverHelper:e.props.intersectionObserverHelper}))})),i.createElement(u.a,{id:r,semanticTag:"section",ref:this.props.descriptorDomId,style:this.transformDeviceStyle(),role:S.r},n)},t}(i.Component);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */K.displayName="Column";var Q=Object(o.a)((function(){var e,t,r,n,i=(e=null,t=null,function(r,n){var i=Object(p.a)(r);return t!==i&&(t=i,e={columnStyle:{display:"block"}}),e}),a=function(e,t){return n!==t&&(n=t,r=t.SectionNames.filter((function(t){return Object(s.Mb)(e,t)}))),r};return function(e,t){var r=Object(m.j)(e,t.id),n=Object(s.p)(e,t,r),o=i(e,t),c=Object(X.b)(e,"ReferencePanelControl")?a(e,n):null;return{column:n,columnStyle:o,shouldRenderHeaderFields:t.renderHeaderFields,shouldRenderFooterFields:t.renderFooterFields,referencePanelSectionNames:c}}}))(K),Y=r("aPRd");var Z=r("QJW6"),J=r("C+i/"),$=r("cZkS"),ee=r("/zIU"),te=r("TCzx"),re=r("iyBA"),ne=r("LAqF"),ie=function(e){function t(t,r){var n=e.call(this,t,r)||this;if(n._shouldRenderContents=!1,n.state={numberOfFormComponentSectionColumns:null},!(te.a.getInstance().get_IsIOS()&&ne.a.get_Instance().get_device().get_DeviceState().get_IsNarratorActive())&&t.isIntersectionObserverEnabled&&t.viewportElementId&&t.pageName===ee.a.EditForm&&!r.AccessibilityManager.isClientAPISetFocusScheduled())try{n._setupIntersectionObserver(t.viewportElementId,t.formLazyLoadConfigFlag)}catch(e){n.context.TraceManager.getTracer("Forms.Tab").warn("Failed to initialize intersection observer with error: "+e.message)}return n._formComponentSectionColumnMeasuringCallback=n._formComponentSectionColumnMeasuringCallback.bind(n),n}return Object(n.__extends)(t,e),t.prototype._formComponentSectionColumnMeasuringCallback=function(e){var t=this.props.descriptor,r=null,n=function(){var e,r,n=document.getElementById(null===(r=null===(e=t.Columns[0])||void 0===e?void 0:e.SectionNames)||void 0===r?void 0:r[0]);return n?getComputedStyle(n).width:null};if(0!==e&&(this._lastViewWidth!==e||this._lastFirstSectionWidth!==(r=n()))){this._lastViewWidth=e,this._lastFirstSectionWidth=r||n();var i=this._getFormComponentSectionColumns(this.props.descriptor,this.props.isDeviceWidthLessThanDimensionS);this.state.numberOfFormComponentSectionColumns!==i&&this.setState({numberOfFormComponentSectionColumns:i})}},t.prototype._getFormComponentSectionColumns=function(e,t){var r,n,i,a,o,s,c,l,u;if(!(null==e?void 0:e.Columns))return null;if(e.Columns.length>1&&!t){var d=document.getElementById(null===(n=null===(r=e.Columns[0])||void 0===r?void 0:r.SectionNames)||void 0===n?void 0:n[0]),p=document.getElementById(null===(a=null===(i=e.Columns[1])||void 0===i?void 0:i.SectionNames)||void 0===a?void 0:a[0]),h=document.getElementById(null===(s=null===(o=e.Columns[2])||void 0===o?void 0:o.SectionNames)||void 0===s?void 0:s[0]);if(d&&p){var g=null===(c=d.getBoundingClientRect())||void 0===c?void 0:c.top,m=null===(l=p.getBoundingClientRect())||void 0===l?void 0:l.top;if(g&&m)if(h){var f=null===(u=h.getBoundingClientRect())||void 0===u?void 0:u.top;if(f&&g===m&&g===f&&m===f)return 3;if(g===m)return 2}else if(g===m)return 2}}return 1},t.prototype._renderColumns=function(e){for(var t=[],r=0;r<e.Columns.length;r++){var a=!1,o=!1;0===r&&this.props.firstVisibleTab&&this.props.tabId===this.props.firstVisibleTab.Id&&(a=this.props.showHeaderFieldsRenderInSection&&this.props.renderHeaderFields,o=this.props.showFooterFieldsRenderInSection&&this.props.renderFooterFields);var s=e.Columns[r].Width,c={},l=this.props.isDeviceWidthLessThanDimensionS?{flex:(parseInt(s,10)/10).toString()+" "+this.props.sectionWidthInPx.toString()+"px",minWidth:0}:{flex:(parseInt(s,10)/10).toString(),minWidth:this.props.sectionWidthInPx},u=this.props.isRTL?{paddingLeft:"1.5rem"}:{paddingRight:"1.5rem"},d=this.state.numberOfFormComponentSectionColumns;d?(r<d-1&&(l=Object.assign(l,u)),1===d&&(c=this.props.sectionFullBleedStyle)):this.props.isFormComponentInstance&&((e.Columns.length<=1||this.props.isDeviceWidthLessThanDimensionS)&&(c=this.props.sectionFullBleedStyle),r<e.Columns.length-1&&!this.props.isDeviceWidthLessThanDimensionS&&(l=Object.assign(l,u)));var p=Object(n.__assign)(Object(n.__assign)({},this.props.columnStyle),l),h=Object(n.__assign)(Object(n.__assign)({},this.props.sectionStyle),c);t.push(i.createElement(Q,{key:r,tabName:this.props.tabId,columnIndex:r,id:this.props.id,renderHeaderFields:a,renderFooterFields:o,descriptorDomId:Object(x.g)(this.props.descriptor.DomId,this.props.id),shouldRender:!0,customStyle:p,sectionStyle:h,cellStyle:this.props.cellStyle,cellContainerStyle:this.props.cellContainerStyle,inDialogWithZIndex:this.props.inDialogWithZIndex,intersectionObserverHelper:this._intersectionObserverHelper}))}return t},t.prototype.componentWillUnmount=function(){this._cleanupIntersectionObserverHelper()},t.prototype._cleanupIntersectionObserverHelper=function(){this._intersectionObserverHelper&&(this.context.IntersectionObserverManager.delete(this.props.tabId),this._intersectionObserverHelper.cleanup(),this._intersectionObserverHelper=null)},t.prototype._setupIntersectionObserver=function(e,t){if(!this._intersectionObserverHelper&&e){var r=document.getElementById(e);if(r){var n={root:r,rootMargin:"50%",threshold:0};this._intersectionObserverHelper=new J.b(n,this.context.EventManager,t),this.context.IntersectionObserverManager.set(this.props.tabId,this._intersectionObserverHelper)}}},t.prototype._renderSingleComponent=function(){return this.props.firstCell?i.createElement(l.a,{key:0,domId:Object(x.g)(this.props.firstCell.DomId,this.props.id),previewId:this.props.firstCell.PreviewId,id:this.props.id,controlName:this.props.firstCell.ControlName,userSpacer:this.props.firstCell.UserSpacer,rowSpan:this.props.firstCell.RowSpan,columnSpan:1,autoExpand:this.props.firstCell.AutoExpand,style:this.props.cellStyle,cellSizeMode:0,shouldRender:!0,scope:_.a.EditForm,availableForPhone:this.props.firstCell.AvailableForPhone,inDialogWithZIndex:this.props.inDialogWithZIndex,cellLabelPosition:1,isParentPaddingAdded:!0,useControlWrapper:!1}):null},t.prototype.render=function(){var e,t=this.props.descriptor;if(!t)return null;if(this._shouldRenderContents=this._shouldRenderContents||this.props.showTab,!this._shouldRenderContents||!this.props.visible||this.props.clientHostSubtype===P.a.Phone&&null!==t.AvailableForPhone&&void 0!==t.AvailableForPhone&&!t.AvailableForPhone)return null;var r=this.props.showTab?this.props.tabContainerStyle:this.props.hiddenTabStyle;r=this.props.singleComponent&&this.props.showTab?this.props.expandedTabContainerStyle:Object(n.__assign)(Object(n.__assign)({},r),this.props.style);var a=Z.a.getInstance().getDisableScrollStyle()?"forceNewStackContextInert":"forceNewStackContext";return i.createElement(u.a,{id:t.DomId,ref:t.DomId,testhooks:(e={id:"tabpanel-"+this.props.tabName},e[w.b]=t.PreviewId,e[O.a.LearningPathDOMAttributeSuffix]="tabpanel-"+this.props.tabName,e),style:r,role:this.props.pageName===ee.a.Dialog||this.props.pageName===ee.a.ModalDialog||this.props.pageName===ee.a.QuickCreateForm||this.props.isFormComponentInstance?S.r:S.v,accessibilityLabel:this.props.pageName===ee.a.Dialog||this.props.pageName===ee.a.ModalDialog||this.props.pageName===ee.a.QuickCreateForm||this.props.isFormComponentInstance?null:this.props.label,"aria-hidden":!this.props.showTab,explicitStyles:a,onMeasuring:this._formComponentSectionColumnMeasuringCallback,isRequestedMeasuring:this.props.isFormComponentInstance},this.props.singleComponent?this._renderSingleComponent():this._renderColumns(t))},t}(i.Component);ie.displayName="Tab";var ae=Object(o.a)((function(){var e,t,r,n=(e=null,t=null,r=null,function(n,i){var a=Object(p.a)(n),o=Object(Y.c)(n),c=Object(s.Ib)(n,i.id);return t===a&&r===o||(t=a,r=o,e={tabContainerStyle:{width:"100%",flexWrap:"wrap",overflowY:"auto",overflowX:"hidden",flexDirection:"row",flex:"1 0 0px",backgroundColor:c?"#F8F7F6":void 0},hiddenTabStyle:{width:"100%",overflowX:"hidden",display:"none"},customFooterRootStyle:{width:"100%",display:"block",position:"fixed",left:o<=a.sizes.Breakpoints.DimensionS?a.sizes.Measures.Measure050:a.sizes.Measures.Measure150,bottom:0,marginLeft:o<=a.sizes.Breakpoints.DimensionS?"-0.5rem":"-1.5rem",marginRight:o<=a.sizes.Breakpoints.DimensionS?"-0.5rem":"-1.5rem"},expandedTabContainerStyle:{display:"flex",width:"100%",flexWrap:"wrap",overflowY:"visible",overflowX:"hidden",flexDirection:"row",flex:"1 0 0px"},sectionFullBleedStyle:{paddingTop:"0px",paddingLeft:"0px",paddingBottom:"0px",paddingRight:"0px",borderWidth:"0px",marginBottom:"0px"}}),e}),i=null;return function(e,t){var r,a=Object(m.j)(e,t.id);Object(V.e)(i,a)||(i=a);var o=Object(s.Fc)(e,t.id,t.tabId,a),l=Object(s.Kc)(e,t.tabId,t.id,a),u=Object(s.Hc)(e,t.tabId,t.id,a),d=Object(p.a)(e),h=Object(F.e)(e),g=Object(s.Y)(e,t,a),f=n(e,t),b=d.sizes.Section.SectionWidth,y=Object(s.xc)(e,t,a),v=Object(X.c)(e,$.Q)&&J.a,_=Object(c.l)(e,t.id),S=Object(Y.c)(e)<e.theme.sizes.Breakpoints.DimensionS,O=!1!==Object(re.d)(e,"formlazyload")&&!0!==Object(re.d)(e,"testmode"),C=Object(s.Eb)(e,t.id),I=Object(W.g)(e),j="singleComponent"===(null===(r=Object(s.Jc)(e,t.id,t.tabId,a))||void 0===r?void 0:r.contentType),P=j?function(e,t,r,n){for(var i=0,a=e.Columns||[];i<a.length;i++){var o=a[i];if(o)for(var c=0,l=o.SectionNames||[];c<l.length;c++){var u=l[c],d=Object(s.qc)(t,{id:r.id,sectionName:u},n),p=Object(s.tc)(t,{id:r.id,sectionName:u},n);if(d&&!1!==p)for(var h=0,g=d.Rows||[];h<g.length;h++){var m=g[h];if(m&&!1!==m.Visible)for(var f=0,b=m.Cells||[];f<b.length;f++){var y=b[f];if(y&&!1!==y.Visible)return y}}}}return null}(o,e,t,a):null;return{descriptor:o,visible:l,label:u,hiddenTabStyle:f.hiddenTabStyle,tabContainerStyle:f.tabContainerStyle,customFooterRootStyle:f.customFooterRootStyle,expandedTabContainerStyle:f.expandedTabContainerStyle,sectionFullBleedStyle:f.sectionFullBleedStyle,clientHostSubtype:h,firstVisibleTab:g,contextToken:i,sectionWidthInPx:b,showHeaderFieldsRenderInSection:y,isIntersectionObserverEnabled:v,pageName:_,isDeviceWidthLessThanDimensionS:S,formLazyLoadConfigFlag:O,isFormComponentInstance:C,isRTL:I,singleComponent:j,firstCell:P}}}))(ie);ie.contextType=E.a},zWnx:function(e,t,r){"use strict";r.d(t,"a",(function(){return Wt})),r.d(t,"b",(function(){return Ht}));var n=r("c/eZ"),i=r("9r0m"),a=r("QAhb"),o=r("Eoze"),s=r("TCcM"),c=r("7z0H"),l=r("8aRo"),u=r("Pm+b"),d=r("y3ek"),p=r("i8/j"),h=r("mGpW"),g=r("NWJ/"),m=r("rQCE"),f=r("zXhH"),b=r("TJkj"),y=r("sOTk"),v=r("IfuP"),_=r("T576"),S=r("Sscr"),O=r("zmaG"),C=r.n(O),I=r("7pqb"),j=r("h82J"),P=r("ApiM"),F=r("F2uj"),T=r("BWVO"),w=r("kvLG"),E=r("IiPO"),x=r("ObKm");function N(e){var t={};for(var r in e){var n={fieldName:r,value:e[r]};t[r]=n}return t}var A=r("uwKl"),k=r("ed60"),M=r("l9h5"),D=r("vYfn"),R=r("qC0c"),B=r("5fD4");var L=r("WS0f"),V=r("lMVv"),z=r("gk6Q"),G=r("2ojE"),W=r("LhJP"),H=r.p+"scripts/WorkflowObjectModel.js?v=1.4.9962-v91onpremise",U=r("pflg"),q=r("uQP8");function X(e,t,r,n,o,c,l,u,d,p,h){var g=Object(s.e)(e(),c),m=c&&c.etn||"",f=Object(V.p)(e(),m),b=c&&c.id?i.a.toString(c.id):"",y=u.correlationId,_={};_[I.b.BpfProcessControlRenderParameters.ProcessId]=i.a.toString(l),_[I.b.BpfProcessControlRenderParameters.BusinessProcessFlowInstanceId]=Object(L.a)(g)?"":i.a.toString(g),_[I.b.BpfProcessControlRenderParameters.EntityTypeCode]=Object(L.a)(f)?"":f.toString(),_[I.b.BpfProcessControlRenderParameters.EntityId]=b,_[I.b.BpfProcessControlRenderParameters.CorrelationId]=y,_[I.b.BpfProcessControlRenderParameters.PageId]=n,C.a.addKeyPerformanceIndicator("BPF.RenderProcessControl",_);var S=[{name:"CorrelationId",value:y},{name:"ContextId",value:u.contextId},{name:"ActionStack",value:u.stack},{name:"entityTypeCode",value:f},{name:"entityId",value:b}],O=d.AssetLoader.loadScript(H),j=t(Object(v.a)(l,c,p));return Promise.all([O,j]).then((function(u){
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var d;t((d=!0,{type:B.b,payload:{workflowObjectModelLibraryLoaded:d}}));var g=u[1];if(!g)return Promise.resolve();r.info("retrieveBusinessProcessFlow promise resolved successfully.");var m=e(),f=Promise.resolve(),b=[];if(Object(R.c)(m,"FCB.EnableBPFNonDefaultCustomControls")&&(Object(L.a)(p)||p.then((function(){f=function(e,t,r,n,o,c){var l=Promise.resolve(),u=c;if(t&&t.businessProcessFlows&&Object.keys(t.businessProcessFlows).length>0){if(u===i.a.EMPTY&&!Object(L.a)(o)){var d=Object(s.b)(o)(e,o.etn);u=d&&d.businessProcessFlowId?d.businessProcessFlowId:t.businessProcessFlows[Object.keys(t.businessProcessFlows)[0]].businessProcessFlowId}var p=u!==i.a.EMPTY?t.businessProcessFlows[u.guid].businessProcessFlowUniqueName:null;if(Object(L.a)(p)){if(!Object(L.a)(t)&&!Object(L.a)(t.businessProcessFlows)&&Object.keys(t.businessProcessFlows).length>0){var h=[];h.push({name:"BPF Id",value:t.businessProcessFlows[Object.keys(t.businessProcessFlows)[0]].businessProcessFlowId.guid},{name:"BPF UniqueName",value:t.businessProcessFlows[Object.keys(t.businessProcessFlows)[0]].businessProcessFlowUniqueName},{name:"currentProcessId",value:u?u.guid:""},{name:"BPF Name",value:t.businessProcessFlows[Object.keys(t.businessProcessFlows)[0]].businessProcessFlowName}),n.error("BPF descriptor does not contain unique name which is required to load BPF Entity form descriptor",h)}}else l=r(Object(D.b)(new a.a(p),null))}return l}(m,g,t,r,c,l)}))),c.id===i.a.EMPTY){var y=Object(U.a)(h),v=Object(U.b)(h);if(b.push(t(Object(M.b)(!1,c))),y&&v)return b.push(t(Object(A.b)(y,c))),b.push(t(Object(k.b)(v,c))),Promise.all(b).then((function(i){return K(c,o,n,t,e,r)}));var _=l;if(i.a.isNullOrEmpty(_)&&(_=Object(s.d)(m,c.etn)),!i.a.isNullOrEmpty(_))return b.push(t(Object(A.b)(_,c))),b.push(t(Object(k.b)(i.a.EMPTY,c))),Promise.all(b).then((function(i){return K(c,o,n,t,e,r,!0)}))}return Promise.all([p,f]).then((function(){return K(c,o,n,t,e,r)}))})).then((function(){var e=Object(z.a)(n);e&&(S.push.apply(S,e.getTelemetryParams()),Object(G.c)(W.l,S,d))})).catch((function(t){var i=h&&h.entityTypeName?new a.a(h.entityTypeName,h.id):null,o=Object(G.a)(e(),i,n,d);return o&&(S.push.apply(S,o),r.error("Error while executing loadBusinessProcessFlow in the retrieveBusinessProcessFlow promise.",S),Object(G.b)(W.l,t,null,S,d,c,e())),Promise.resolve(null)}))}function K(e,t,r,n,a,o,c){void 0===c&&(c=!1);var l=[],u=Promise.resolve(),d=a(),p=Object(s.e)(d,e);if(!i.a.isNullOrEmpty(p)){var h=Object(_.a)(d,p);if(h&&h.businessProcessFlowStepEntityAttributeControls){o.debug("BusinessProcessFlowDescriptor is valid.",l);var g=h.businessProcessFlowStepEntityAttributeControls[e.etn];if(g&&Object.keys(g).length){l.push({name:"bpfControls.length",value:Object.keys(g).length}),o.debug("bpfControls is valid.",l);var m=Object(S.v)(t),f=Object(q.a)(d,r),y=f&&f.metadata&&f.metadata[m]&&f.metadata[m].attributes,v={};for(var O in g){var C=g[O].DataFieldName;if(!(v[C]||y&&C in y)){var I=Object(F.a)(d,e.etn,C);I&&(v[C]=I)}}var A=Q(n,g,r,t);n(Object(P.c)(t,r,v)),n(Object(P.d)(t,r,A)),u=n(function(e,t,r,n,i,a){return void 0===a&&(a=!1),{type:"clientapi.add.controls",execute:function(o,s){try{return Object(b.b)("bpf.initialization",(function(){var s=o.dispatch(Object(j.b)(t,e));if(s&&s.data&&s.ui){var c=s.data.entity,l=s.ui;if(c&&c.attributes){if(r){var u=c.attributes;for(var d in r){var p=r[d],h=u.get(d);if(!h){var g=Object(T.b)(o,e,t,d,c,l,r[d]);g&&(u.add(d,g),h=u.get(d))}if(p&&h){var m="picklist"===p.Type&&0===p.OptionSetType&&p.DefaultValue&&p.DefaultValue>-1,f="boolean"===p.Type&&3===p.OptionSetType&&p.DefaultValue;if(a&&(m||f)&&!h.getValue()){var b={};b[d]=p.DefaultValue;var y=N(b);o.dispatch(Object(x.a)(t,y,!0,!0))}}else{var v=[];v.push({name:"BpfAttribute",value:d}),i.debug("BPF Attribute cannot be null.",v)}}}n&&l.addControls(n)}}})),Promise.resolve()}catch(t){var c=E.a.getInstance().getEventParameters(e);throw w.a.getInstance().eventManager.ReportComponentFailure("ClientApi.AddBpfFieldsToXrmCollection.addBpfFieldsToXrmCollection",t,null,c),t}},shouldReceiveFullStore:!0}}(t,r,v,A=Q(n,g,r,t),o,c))}else o.debug("bpfControls is invalid.",l)}else o.debug("BusinessProcessFlowDescriptor is invalid.",l)}return u}function Q(e,t,r,i){var a={},o=e(Object(j.b)(r,i));return Object(b.b)("bpf.initialization",(function(){if(o&&o.data&&o.ui){var e=o.ui;if(t){var r=[];e.controls.forEach((function(e){return r.push(e.getName())}));var i=new Set(r),s=Object.keys(t),c={};if(i&&s&&s.length>0)return s.filter((function(e){return!i.has(e)})).forEach((function(e){var r;(r={})[e]=t[e],c=r,a=Object(n.__assign)(Object(n.__assign)({},a),c)})),a}}return t}))}var Y=r("M6d0"),Z=r("JECh"),J=r("dEPU"),$=r("3NtJ"),ee=r("HSdq"),te=r("+ieV"),re=r("Z1aD"),ne=r("zsi3"),ie=r("xm8q"),ae=r("okRr"),oe=r("UOUy"),se=r("DRVD"),ce=r.n(se),le=r("CCTC"),ue=r("hadW"),de=function(){function e(e,t,r,n,i){var a=this;this._callback=i,this._callbackCalled=!1,this._editReadyTime=0,this._controlsShouldRender=[];var o=[ue.a.guid,ue.b.guid,ue.g.guid],s=Object(p.g)(e,t,r,n);s&&Object.keys(s).forEach((function(e){var t=s[e];e&&t&&t.Visible&&o.indexOf(t.ClassId.guid)<0&&a._controlsShouldRender.push(e)}))}return e.prototype.writeMarker=function(e,t,r){this._receivedEvent(e,t,r)},e.prototype.writeRetroactiveTimespan=function(e,t,r,n){this._receivedEvent(e,t+r,n)},e.prototype.startTimespan=function(e,t,r){var n=this;return function(i,a){n._receivedEvent(e,t+i,r)}},e.prototype._receivedEvent=function(e,t,r){if(!this._callbackCalled){var n=e.getName();if(n===le.m){var i=this._getControlName(r);this._controlsShouldRender.indexOf(i)>=0&&this._editReadyTime<t&&(this._editReadyTime=t)}else"FormOnloadCompleteEvent"===n?this._editReadyTime<t&&(this._editReadyTime=t):n===le.i&&(this._callbackCalled=!0,this._callback({timestamp:this._editReadyTime}))}},e.prototype._getControlName=function(e){var t=e[le.l];return t||null},e}();function pe(e,t,r,n,a,o){var s=new de(e,t,r,o,(function(e){ce.a.removeTransport(s);var t=n&&n.id?n.id.guid:"null";!function(e,t,r,n,a){C.a.addKeyPerformanceIndicator(n,{formId:i.a.toString(e),recordId:t,etn:r},a)}(r,t,a,"RenderedEditReady",e.timestamp)}));ce.a.registerTransport(s,[O.KPI_ZONE,le.g,le.d])}var he=r("M8mM"),ge=r("oj0s"),me=r("u3BH"),fe=r("XNwl"),be=r("Srej"),ye=r("Ff8i"),ve=r("/j9Z"),_e=r("+l2M"),Se=r("lRv2"),Oe=r("2OIc"),Ce=r("HHlV");function Ie(e,t,r){var n=e.controls[t];n||(n=e.controls[t]={numPresent:0,numVisible:0}),n.numPresent++,r&&n.numVisible++}function je(e,t,r,n,i){if(n){var a=n.ParentSectionName;a&&-1===r.sections.indexOf(a)&&r.sections.push(a);var o=Object(_e.F)(n.ClassId);Object(Oe.c)(e,n.UniqueId,t)===Ce.d&&(o=Ce.d),Ie(r,o,n.Visible),function(e,t,r){t&&r&&r[t.Name]&&(t.Parameters&&"true"===t.Parameters[Se.a]?Ie(e,"QuickFormCardsByParameter",t.Visible):Ie(e,"QuickFormsByParameter",t.Visible))}(r,n,i)}}var Pe=r("oPeH"),Fe=r("cQE4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Te(e,t,r,n,i,a,o,s){!function(e,t,r,n){var i=Object(V.h)(e,t);i&&n.push({name:"IsCustomEntity",value:i.IsCustomEntity},{name:"IsActivityEntity",value:i.IsActivity});if(r){var a=Object(V.k)(e,r);n.push({name:"HasEntityImage",value:null!=a&&a.trim().length>0})}}(e,i,a,s),function(e,t,r,n,i){var a=Object(p.d)(e,n,t);if(a){var o=Object.keys(a),s={},c=Object(p.r)(e,n);o.forEach((function(i){var o=a[i];!function(e,t,r,n,i,a,o){if(a&&i&&a.ParentTabId){var s=a.ParentTabId,c=i[s];if(!c){var l=Object(ee.Jc)(e,t,s,r);c={tabName:s,sections:[],controls:{},contentType:"cardSections"},(null==l?void 0:l.contentType)&&(c.contentType=l.contentType),i[s]=c}je(e,n,c,a,o)}}(e,t,r,n,s,o,c)}));var l=Object(ee.N)(e,n),u=Object(ee.uc)(e,t,r);i.push({name:"defaultTabId",value:l},{name:"selectedTabId",value:u},{name:"FormComplexitiesByTab",value:JSON.stringify(s)})}}(e,t,r,n,s),function(e,t){e&&null!=e.bodyOnly&&t.push({name:"BodyOnly",value:e.bodyOnly})}(o,s);var c=Object(p.w)(e,n);null!=c&&s.push({name:"NumTabs",value:c});var l=Object(p.u)(e,n);null!=l&&s.push({name:"NumSections",value:l});var u=Object(p.j)(e,n);u&&s.push({name:"HeaderDensity",value:u.HeaderDensity});var d=0,h=Object(p.e)(e,n,t);if(null!=h){for(var g=[],m=0,f=h;m<f.length;m++){var b=f[m];"header_process"!==b.Name&&(g.push(b),Object(ee.t)(e,{id:t,controlName:b.Name},r)&&d++)}s.push({name:"NumHeaderFields",value:g.length}),s.push({name:"NumReadOnlyHeaderFields",value:d});var y=g.filter((function(e){return!Object(Pe.k)(e)}));s.push({name:"NumHeaderV2UnsupportedControls",value:y.length})}var v=Object(Pe.f)(e,t,r);v&&(s.push({name:"HeaderCommandBarVisible",value:v.commandBarVisible}),s.push({name:"HeaderBodyVisible",value:v.bodyVisible}),s.push({name:"HeaderTabNavigatorVisible",value:v.tabNavigatorVisible}));var _=Object(Fe.a)(e,t,r);_&&s.push({name:"FooterVisible",value:_.visible});var S=Object(p.c)(e,n,t);null!=S&&s.push({name:"NumFooterFields",value:S.length})}var we,Ee,xe=r("KvcU"),Ne=r("ar+e"),Ae=r("/W63"),ke=r("YEEA"),Me=r("XjtF"),De=r("JlqV"),Re=r("LBS5"),Be=r("Ww2r"),Le=r("Ro59"),Ve=r("2p2B"),ze=r("3/Bp"),Ge=r("+XB9"),We=r("F314"),He=r("6q56"),Ue=r("jWor"),qe=r("GUnN"),Xe=r("TiXY"),Ke=r("cZkS"),Qe=r("yHpA"),Ye=r("sRzG"),Ze=r("G7N+"),Je=function(e){this.type=e.type,this.raw=Object(n.__assign)({},e.raw),this.attributes=Object(n.__assign)({},e.attributes),this.error=e.error,this.errorMessage=e.errorMessage,this.security=Object(n.__assign)({},e.security),this.timerParameterAttributeValues=Object(n.__assign)({},e.timerParameterAttributeValues),this.timerParameters=Object(n.__assign)({},e.timerParameters),this.timerState=e.timerState,this.serverTimeDifferenceInSeconds=e.serverTimeDifferenceInSeconds,this.timerControlId=e.timerControlId,this.telemetryParameters=Object(n.__assign)({},e.telemetryParameters)},$e=r("OTOS");!function(e){e[e.CancelCondition=0]="CancelCondition",e[e.FailureCondition=1]="FailureCondition",e[e.FailureTimeField=2]="FailureTimeField",e[e.PauseCondition=3]="PauseCondition",e[e.SuccessCondition=4]="SuccessCondition",e[e.WarningCondition=5]="WarningCondition"}(we||(we={})),function(e){e[e.NoPrivilege=0]="NoPrivilege",e[e.NotSet=1]="NotSet",e[e.InProgress=2]="InProgress",e[e.Warning=3]="Warning",e[e.Violated=4]="Violated",e[e.Succeeded=5]="Succeeded",e[e.Unsucceeded=6]="Unsucceeded",e[e.Canceled=7]="Canceled",e[e.Paused=8]="Paused"}(Ee||(Ee={}));var et=function(){function e(e,t,r){this._entityName="",this._propValue=new Je({type:"",raw:null,attributes:{},error:!1,errorMessage:"",security:{},timerParameterAttributeValues:{},timerParameters:{},timerState:Ee.NotSet,serverTimeDifferenceInSeconds:null!=r?r:0,timerControlId:t,telemetryParameters:{}})}return e.prototype._getTimeRemainingInMilliseconds=function(e){var t=(new Date).toUTCString();return new Date(e).getTime()-new Date(t).getTime()+1e3*this._propValue.serverTimeDifferenceInSeconds},e.prototype._getTimerParameterAttributes=function(){var e,t=[];return this._propValue&&(e=this._propValue.timerParameters)?(t.push(e.CancelConditionName),t.push(e.FailureConditionName),t.push(e.FailureTimeField),t.push(e.PauseConditionName),t.push(e.SuccessConditionName),t.push(e.WarningConditionName),t):t},e.prototype._updateTimerContext=function(e,t,r,n){var i,a=!0,o={},s=this._getTimerParameterAttributes(),c=Object(ee.ac)(e,r,n);i=0;for(var l=0,u=s;l<u.length;l++){var d=u[l];if(Object(L.b)(d))i++;else{var p=d;if(Object(L.b)(o[p])){var h=Object(Qe.d)(e,c,this._entityRef,p),g=Object(F.a)(e,this._entityName,p);null!=g&&null!=g.IsValidForRead&&(a=g.IsValidForRead&&a),o[p]=h}this._updateTimerParameterAttributeValues(i++,o[p])}}this._updateTimerState(a)},e.prototype._updateTimerParameterAttributeValues=function(e,t){var r=this._propValue.timerParameterAttributeValues;switch(e){case we.CancelCondition:var n=t;r.CancelConditionAttributeValue=n&&n.valueString;break;case we.FailureCondition:var i=t;r.FailureConditionAttributeValue=i&&i.valueString;break;case we.FailureTimeField:var a=t;r.FailureTimeFieldAttributeValue=a&&a.value;break;case we.PauseCondition:var o=t;r.PauseConditionAttributeValue=o&&o.valueString;break;case we.SuccessCondition:var s=t;r.SuccessConditionAttributeValue=s&&s.valueString;break;case we.WarningCondition:var c=t;r.WarningConditionAttributeValue=c&&c.valueString}this._propValue.timerParameterAttributeValues=r},e.prototype._updateTimerState=function(e){var t,r,n=Ee.Violated;this._propValue&&(t=this._propValue.timerParameters)&&(r=this._propValue.timerParameterAttributeValues)&&(n=e?null==t.FailureTimeField||Object(L.b)(r.FailureTimeFieldAttributeValue)?Ee.NotSet:Object(L.b)(t.FailureConditionName)||Object(L.b)(t.FailureConditionValue)||r.FailureConditionAttributeValue!==t.FailureConditionValue?Object(L.b)(t.CancelConditionName)||Object(L.b)(t.CancelConditionValue)||r.CancelConditionAttributeValue!==t.CancelConditionValue?Object(L.b)(t.SuccessConditionName)||Object(L.b)(t.SuccessConditionValue)||r.SuccessConditionAttributeValue!==t.SuccessConditionValue?Object(L.b)(t.PauseConditionName)||Object(L.b)(t.PauseConditionValue)||r.PauseConditionAttributeValue!==t.PauseConditionValue?this._getTimeRemainingInMilliseconds(r.FailureTimeFieldAttributeValue)>0?Object(L.b)(t.WarningConditionName)||Object(L.b)(t.WarningConditionValue)||r.WarningConditionAttributeValue!==t.WarningConditionValue?Ee.InProgress:Ee.Warning:Ee.Violated:Ee.Paused:Ee.Succeeded:Ee.Canceled:Ee.Unsucceeded:Ee.NoPrivilege,this._propValue.timerState=n)},e.prototype.getLatestData=function(){return this._propValue},e.prototype.linkToParameter=function(e,t){},e.prototype.getTimerData=function(e,t,r,n,o,c){var l=null,u=i.a.EMPTY,d=n.Parameters[e],h=i.a.EMPTY;if(!d||!this._propValue)return this._propValue;var g=0===d.Usage,m=r.id,f=d&&d.TimerParameters;if(!g||!f)return this._propValue;if(this._propValue.type=d.Type,this._propValue.timerParameters=f,r.formInfo&&(u=new i.a(r.formInfo.FormId),l=r.formInfo.EntityName,h=new i.a(r.formInfo.RecordId)),i.a.isNullOrEmpty(u)&&(u=Object($e.b)(t,r.id)),Object(L.b)(l)&&o&&(l=o.entityTypeName),i.a.isNullOrEmpty(h)&&o&&(h=o.id),i.a.isNullOrEmpty(u)||i.a.isNullOrEmpty(h)||Object(L.b)(l))return this._propValue;if(this._entityName=l,this._entityRef=new a.a(l,h),!this._entityRef)return this._propValue;if(!Object(Ye.b)(t,u)){var b=Object(s.b)(this._entityRef)(t,this._entityRef.etn);if(!b||!Object(Ze.b)(b.initialized))return this._propValue}if(this._updateTimerContext(t,r,m,c),r.descriptor.Parameters.timerState=this._propValue.timerState,null!=t){if(t.organization&&(t.organization.organizationId&&(this._propValue.telemetryParameters.OrgId=t.organization.organizationId.guid),t.organization.organizationSettings&&null!=t.organization.organizationSettings.isTrialOrganization&&(this._propValue.telemetryParameters.IsTrialOrganization=t.organization.organizationSettings.isTrialOrganization.toString())),t.user&&t.user.userId&&(this._propValue.telemetryParameters.UserId=t.user.userId.guid),!Object(L.b)(l)&&t.metadata&&(t.metadata.entities&&t.metadata.entities[l]&&(null!=t.metadata.entities[l].IsActivity&&(this._propValue.telemetryParameters.IsActivity=t.metadata.entities[l].IsActivity.toString()),null!=t.metadata.entities[l].IsCustomEntity&&(this._propValue.telemetryParameters.IsCustomEntity=t.metadata.entities[l].IsCustomEntity.toString()),"true"===this._propValue.telemetryParameters.IsCustomEntity?this._propValue.telemetryParameters.EntityName="":this._propValue.telemetryParameters.EntityName=l,t.metadata.entities[l].ObjectTypeCode&&(this._propValue.telemetryParameters.EntityTypeCode=t.metadata.entities[l].ObjectTypeCode.toString())),!i.a.isNullOrEmpty(u))){var y=Object(p.j)(t,u);y.FormType&&(this._propValue.telemetryParameters.FormType=y.FormType.toString()),this._propValue.telemetryParameters.FormId=u.guid}this._propValue.telemetryParameters.IsSLAEnabled=""}return this._propValue},e}(),tt=r("T2Xs"),rt="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlTimerSelector";function nt(){var e={},t={},r={};return function(n,a,o,s,c,l){tt.a.info(o.controlId+"."+rt+": createGetTimerData started");var u,d=!1;u=o.formInfo&&o.formInfo.RecordId?new i.a(o.formInfo.RecordId):c.id,t.hasOwnProperty(n)&&t[n]&&!i.a.isNullOrEmpty(u)||(t[n]=new et(n,o.controlId,function(e){if(e&&e.currentServerTime)return e.currentServerTime.serverTimeDiffInSeconds;return 0}(a)));var p,h,g=t[n],m=g.getTimerData(n,a,o,s,c,l);return null!=m?r.hasOwnProperty(n)&&r[n]&&(p=m,h=r[n],p.timerControlId===h.timerControlId&&p.timerState===h.timerState&&p.timerParameterAttributeValues.FailureTimeFieldAttributeValue===h.timerParameterAttributeValues.FailureTimeFieldAttributeValue)||(d=!0):null!=r[n]&&(d=!0),d&&(r[n]=new Je(m),e[n]=g),tt.a.info(o.controlId+"."+rt+": createGetTimerData finished"),r[n]}}var it=r("455M"),at=r("n+eO");function ot(){var e={};return function(t,r,n,i,a){if(tt.a.info(n.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlBusinessProcessSelector PageId."+n.id+": createGetBusinessProcessFlowData started"),!e[t]||at.a.Instance.hasChanged(r,a,e[t].ProcessWrapper,n.id)){var o=at.a.Instance.getBusinessProcessFlowWrapper(n.id,a);(!o||o.stages&&o.stages.length>0)&&(e[t]={ProcessWrapper:o,Type:it.a.BusinessProcessFlow})}return tt.a.info(n.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlBusinessProcessSelector PageId."+n.id+": createGetBusinessProcessFlowData finished"),e[t]}}var st=r("1Dls"),ct=r("S2mk"),lt=function(){function e(){}return e.prototype.getComponentNameByControlId=function(e){throw new Error("Not initialized.")},e.prototype.getComponentPropsByControlId=function(e){throw new Error("Not initialized.")},e.prototype.addSessionTab=function(e,t){throw new Error("Not initialized.")},e.prototype.closeSessionTab=function(e,t){throw new Error("Not initialized.")},e.prototype.updateSessionTab=function(e,t){throw new Error("Not initialized")},e.prototype.closeAllSessionTabs=function(e){throw new Error("Not initialized.")},e.prototype.dismissMessage=function(e){throw new Error("Not initialized.")},e.prototype.cleanReferencePanelState=function(e){throw new Error("Not initialized.")},e.prototype.initializeReferencePanelControl=function(e,t){throw new Error("Not initialized.")},e.prototype.markActiveTab=function(e,t,r){throw new Error("Not initialized.")},e}(),ut=r("wV3W"),dt=r("PQ2H"),pt=r("DgF7"),ht=r("swEE"),gt=r("NxDw"),mt=r("+Z9T"),ft=r("Gemh"),bt=r("U0B9"),yt=r("Oqm9"),vt=function(){function e(){this.objectWrapperType=1,this._referencePanelQuickFormCollectionControl="b68b05f0-a46d-43f8-843b-917920af806a",this._quickFormComponentName="MscrmControls.Containers.QuickForm",this._quickForm_Type="Form.QuickForm",this._searchWidgetComponentName="MscrmControls.KbSearchControl.KbSearchControl",this._searchWidget_Type="SearchWidget.SearchWidget",this._searchWidget_ControlId="KbSearchControl|",this._gridType="Grid",this._subGridType="subgrid",this._enableIndex="EnableJumpBar",this._enableViewSelector="EnableViewPicker",this._enableQuickFind="EnableQuickFind",this._memoizedComponents={},this.previousReferencePanelParameter=null}return e.prototype.retrieveReferencePanelObject=function(e,t,r,i){var o=this;this._pageId=t.id;var s,c=new a.a(r.entityTypeName,r.id),l=Object($e.b)(e,t.id),u=Object(p.j)(e,l),d=Object(ut.a)(e),h=null,g="",m="";Object.keys(u.Sections).map((function(t){if(Object(ee.Mb)(e,t))return h=u.Sections[t],void(g=t)}));var f=Object(yt.c)(e,t.id);if(m=this._isActiveTabHidden(e,t.id,l,f,i)?this._getNextVisibleControlId(e,t.id,l,i,f.controlNames):f.activeTabId,s=h&&h.Height?Number.parseInt(h.Height,10):10,s*=d.sizes.Section.cellHeightInRem,!this.previousReferencePanelParameter){var b=new lt;b.formDescriptor=Object(n.__assign)({},u),b.referencePanelSectionName=g,b.height=s,b.getComponentPropsByControlId=this.getComponentPropsByControlId.bind(this,u,e,c,t,i),b.getComponentNameByControlId=this.getComponentNameByControlId.bind(this,u,e);var y=Object(pt.a)(e),v=Object(pt.e)(e),_=[];return u.Sections[h.Name].Rows.forEach((function(r){return r.Cells.forEach((function(r){var n=u.Controls[r.ControlName],a=Object(ee.C)(e,t.id,r.ControlName,i),s=Object(ee.t)(e,{id:t.id,controlName:r.ControlName},i);if((y!==gt.a.MobileApplication||Object(mt.a)(n.Parameters.ShowOnMobileClient)||"true"===n.Parameters.ShowOnMobileClient)&&(v!==ht.a.Phone||Object(mt.a)(r.AvailableForPhone)||r.AvailableForPhone)&&r.Visible){var c=o._cloneControlWithControlState(n,a,s);_.push(c)}}))})),b.activeTabId=m,b.controls=_,b.addSessionTab=null,b.updateSessionTab=null,b.closeAllSessionTabs=null,b.closeSessionTab=null,b.dismissMessage=null,b.markActiveTab=null,b.initializeReferencePanelControl=null,b.cleanReferencePanelState=null,b.sessionTabs=[],this.previousReferencePanelParameter=b,this.previousReferencePanelParameter}if(f&&(this.previousReferencePanelParameter.activeTabId!==f.activeTabId||null!==this.previousReferencePanelParameter.messageId&&null===f.messageId||null===this.previousReferencePanelParameter.messageId&&null!==f.messageId||this.previousReferencePanelParameter.messageId&&f.messageId&&this.previousReferencePanelParameter.messageId!==f.messageId||this._sessionTabsChanged(f)||this._staticTabsChanged(e,t.id,l,f)||this._quickViewFormChanged(u,e,c,f.activeTabId,t,i)||this._controlStateChanged(f,e,t.id,i))){var S=new lt;S.sessionTabs=f.sessionTabs.slice(),S.activeTabId=m,S.messageId=f.messageId;var O=f.controlNames&&f.controlNames.length?f.controlNames:this.previousReferencePanelParameter.controls.map((function(e){return e.Name}));S.controls=O.map((function(r){var n=Object(p.b)(e,t.id,l,r),a=Object(ee.C)(e,t.id,r,i),s=Object(ee.t)(e,{id:t.id,controlName:r},i);return o._cloneControlWithControlState(n,a,s)})),S.formDescriptor=Object(n.__assign)({},u),S.height=s,S.referencePanelSectionName=g,S.addSessionTab=this.previousReferencePanelParameter.addSessionTab,S.updateSessionTab=this.previousReferencePanelParameter.updateSessionTab,S.closeAllSessionTabs=this.previousReferencePanelParameter.closeAllSessionTabs,S.closeSessionTab=this.previousReferencePanelParameter.closeSessionTab,S.dismissMessage=this.previousReferencePanelParameter.dismissMessage,S.markActiveTab=this.previousReferencePanelParameter.markActiveTab,S.initializeReferencePanelControl=this.previousReferencePanelParameter.initializeReferencePanelControl,S.cleanReferencePanelState=this.previousReferencePanelParameter.cleanReferencePanelState,this.previousReferencePanelParameter=S}return this.previousReferencePanelParameter.getComponentNameByControlId=this.getComponentNameByControlId.bind(this,u,e),this.previousReferencePanelParameter.getComponentPropsByControlId=this.getComponentPropsByControlId.bind(this,u,e,c,t,i),this.previousReferencePanelParameter},e.prototype._controlStateChanged=function(e,t,r,n){if(!e||!e.controlNames||0===e.controlNames.length||!this.previousReferencePanelParameter)return!1;for(var i=0;i<e.controlNames.length;i++){var a=e.controlNames[i],o=Object(ee.C)(t,r,a,n),s=Object(ee.t)(t,{id:r,controlName:a},n);if(this.previousReferencePanelParameter.controls[i].Visible!==(null==o?void 0:o.visible)||this.previousReferencePanelParameter.controls[i].Label!==(null==o?void 0:o.label)||this.previousReferencePanelParameter.controls[i].Disabled!==s)return!0}return!1},e.prototype._isActiveTabHidden=function(e,t,r,n,i){for(var a=0,o=n.controlNames;a<o.length;a++){var s=o[a],c=Object(p.b)(e,t,r,s),l=Object(ee.G)(e,{id:t,controlName:s},i);if((null==c?void 0:c.Id)===n.activeTabId&&!0!==l)return!0}return!1},e.prototype._getNextVisibleControlId=function(e,t,r,n,i){var a;if(!i||!i.length)return null;for(var o=0,s=i;o<s.length;o++){var c=s[o];if(Object(ee.G)(e,{id:t,controlName:c},n))return null===(a=Object(p.b)(e,t,r,c))||void 0===a?void 0:a.Id}return null},e.prototype._staticTabsChanged=function(e,t,r,n){for(var i=0;i<n.controlNames.length;i++){var a=n.controlNames[i];if(Object(p.b)(e,t,r,a).Id!==this.previousReferencePanelParameter.controls[i].Id)return!0}return!1},e.prototype._sessionTabsChanged=function(e){if(null!==this.previousReferencePanelParameter.sessionTabs&&null===e.sessionTabs||null===this.previousReferencePanelParameter.sessionTabs&&null!==e.sessionTabs||this.previousReferencePanelParameter.sessionTabs&&e.sessionTabs&&this.previousReferencePanelParameter.sessionTabs.length!==e.sessionTabs.length)return!0;for(var t=0;t<e.sessionTabs.length;t++)if(e.sessionTabs[t].id!==this.previousReferencePanelParameter.sessionTabs[t].id)return!0;return!1},e.prototype._quickViewFormChanged=function(e,t,r,n,i,a){if(this._isQuickViewFormControl(e.Controls[n])){var o=Object(ee.ac)(t,i.id,a);return Object(s.j)(t,r,e.Controls[n].DataFieldName)!==Object(Qe.d)(t,o,r,e.Controls[n].DataFieldName)}return!1},e.prototype._isQuickViewFormControl=function(e){return e&&e.ClassId&&e.ClassId.guid.toString()===this._referencePanelQuickFormCollectionControl},e.prototype.linkToParameter=function(e,t){var r=t.addSessionTab;e.addSessionTab=this.executeAddSessionTab.bind(this,r);var n=t.updateSessionTab;e.updateSessionTab=this.executeUpdateSessionTab.bind(this,n);var i=t.closeAllSessionTabs;e.closeAllSessionTabs=this.executeCloseAllSessionTabs.bind(this,i);var a=t.closeSessionTab;e.closeSessionTab=this.executeCloseSessionTab.bind(this,a);var o=t.dismissMessage;e.dismissMessage=this.executeDismissMessage.bind(this,o);var s=t.markActiveTab;e.markActiveTab=this.executeMarkActiveTab.bind(this,s);var c=t.initializeReferencePanelControl;e.initializeReferencePanelControl=this.executeInitializeReferencePanelControl.bind(this,c);var l=t.cleanReferencePanelState;e.cleanReferencePanelState=this.executeCleanReferencePanelState.bind(this,l)},e.prototype.executeAddSessionTab=function(e,t){e(t,this._pageId)},e.prototype.executeUpdateSessionTab=function(e,t){e(t,this._pageId)},e.prototype.executeInitializeReferencePanelControl=function(e,t){e(t,this._pageId)},e.prototype.executeCloseSessionTab=function(e,t){e(t,this._pageId)},e.prototype.executeCloseAllSessionTabs=function(e){e(this._pageId)},e.prototype.executeDismissMessage=function(e){e(this._pageId)},e.prototype.executeCleanReferencePanelState=function(e){e(this._pageId)},e.prototype.executeMarkActiveTab=function(e,t,r){e(t,r,this._pageId)},e.prototype.getComponentNameByControlId=function(t,r,n){var i=t.Controls[n];if(!e._isControlDefaultMapping(t,n))return i.UniqueId;if(i.ClassId&&i.ClassId.guid.toString()===this._referencePanelQuickFormCollectionControl)return this._quickFormComponentName;var a=e._getDefaultControlConfiguration(t,r,n);return Object(ct.z)(a)},e.prototype.getComponentPropsByControlId=function(t,r,n,i,a,o,s){var c;void 0===s&&(s=!1),tt.a.info("CustomControlFramework.Models.Wrapper.ReferencePanelObjectWrapper: getComponentPropsByControlId started"),this._memoizedComponents[o]||(this._memoizedComponents[o]={controlId:o});var l,u=this._memoizedComponents[o],d=t.Controls[o],h=e._forceReadOnlyGridOnPhone(r,t,d);if(e._isControlDefaultMapping(t,o)||s||!t.ControlConfigurations[d.UniqueId].CustomControls[0]||h)if(o&&!d)if(o.indexOf(this._searchWidget_ControlId)>=0)l={FormFactor:2,CustomControlId:this._searchWidgetComponentName,Name:o.replace(this._searchWidget_ControlId,""),DisplayNameKey:o.replace(this._searchWidget_ControlId,""),Version:"1.0.0",Parameters:{value:{Static:!1,Type:this._searchWidget_Type}},ShouldOverrideControlVisible:!1};else{var g=o.split("|")[0],m=Object(dt.a)(6),f=Object(p.h)(r,g,m);l={FormFactor:2,CustomControlId:this._quickFormComponentName,Name:o,DisplayNameKey:o,Version:"1.0.0",Parameters:{value:{Static:!1,Type:this._quickForm_Type,Value:f.guid+":quick|"+o}},ShouldOverrideControlVisible:!1}}else l=e._getDefaultControlConfiguration(t,r,o);else l=t.ControlConfigurations[d.UniqueId].CustomControls[0];if(this._isQuickViewFormControl(d)){var b=Object(ee.ac)(r,i.id,a),y=Object(Qe.d)(r,b,n,d.DataFieldName);if(y&&y.validationResult&&y.validationResult.isValueValid)for(var v=(new DOMParser).parseFromString(d.Parameters[0].Value,"text/xml").getElementsByTagName("QuickFormId"),_=0;_<v.length;_++)if(v[_].attributes.entityname&&v[_].attributes.entityname.nodeValue===(null===(c=y.reference)||void 0===c?void 0:c.etn)){l.Parameters.value.Value=v[_].textContent+"|"+d.DataFieldName;break}}var S={configuration:l,descriptor:d};return(d&&d.ClassId&&"02d4264b-47e2-4b4c-aa95-f439f3f4d458"===d.ClassId.guid.toString()||h)&&this._updateConfigurationForSubGridControl(S),u.componentProps&&S.configuration===u.componentProps.configuration&&S.descriptor===u.componentProps.descriptor||(u.componentProps=S),tt.a.info("CustomControlFramework.Models.Wrapper.ReferencePanelObjectWrapper: getComponentPropsByControlId finished"),u.componentProps},e.prototype._updateConfigurationForSubGridControl=function(e){var t={DataSetUIOptions:{displayCommandBar:!0,displayIndex:e.descriptor.Parameters[this._enableIndex],displayQuickFind:e.descriptor.Parameters[this._enableQuickFind],displayViewSelector:e.descriptor.Parameters[this._enableViewSelector]}};Object.assign(e.configuration.Parameters[this._gridType],t),e.contextString=this._subGridType},e._isControlDefaultMapping=function(e,t){var r=e.Controls[t];return!r||!r.UniqueId||!e.ControlConfigurations[r.UniqueId]},e._forceReadOnlyGridOnPhone=function(e,t,r){return t&&t.ControlConfigurations&&r&&r.UniqueId&&t.ControlConfigurations[r.UniqueId]&&t.ControlConfigurations[r.UniqueId].CustomControls&&Object(ft.xb)(e,t.ControlConfigurations[r.UniqueId].CustomControls[0],Object(bt.b)(e))},e._getDefaultControlConfiguration=function(t,r,n){tt.a.info("CustomControlFramework.Models.Wrapper.ReferencePanelObjectWrapper: _getDefaultControlConfiguration started");var a=t.Controls[n],o=t.EntityLogicalName,s=Object(Se.b)(r,o,a),c=e._forceReadOnlyGridOnPhone(r,t,a)?"02d4264b-47e2-4b4c-aa95-f439f3f4d458":a.ClassId&&i.a.toString(a.ClassId);return tt.a.info("CustomControlFramework.Models.Wrapper.ReferencePanelObjectWrapper: _getDefaultControlConfiguration finished"),Object(ct.q)(a.Id,a.DataFieldName,s,a,o,c)},e.prototype._cloneControlWithControlState=function(e,t,r){return Object(n.__assign)(Object(n.__assign)({},e),{Label:null==t?void 0:t.label,Visible:null==t?void 0:t.visible,Disabled:r})},e.prototype.getLatestData=function(){return this.previousReferencePanelParameter},e}();function _t(){tt.a.info("CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlReferencePanelSelector: createGetReferencePanelData started");var e={},t={},r={};return function(n,i,a,o,s,c){var l=!1;t.hasOwnProperty(n)&&t[n]||(t[n]=new vt);var u=t[n],d=u.retrieveReferencePanelObject(i,a,s,c);return r.hasOwnProperty(n)&&r[n]&&d===r[n]||(l=!0),l&&(r[n]=d,e[n]=u),tt.a.info("CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlReferencePanelSelector: createGetReferencePanelData finished"),e[n]}}var St=r("ZEX9"),Ot=r("7EJx"),Ct=r("Axwz"),It=r("3Ng8"),jt=r("RK8T"),Pt=r("1n14"),Ft=r("c9Dq"),Tt=r("lU69"),wt=r("Xlzu");var Et=r("s0Zj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function xt(e,t,r){return{type:"tab.expandinitial.sync",sync:!0,execute:function(n){var i=n.dispatch;i(Nt(t,r)),i({type:Et.a,payload:!1,meta:{pageId:t,contextKey:Object(S.v)(r),tabId:e}})}}}function Nt(e,t){return{type:"tab.collapseinitial.sync",sync:!0,execute:function(r){var n,i,a=r.dispatch,o=(0,r.getState)(),s=Object(q.a)(o,e),c=Object(S.v)(t),l=null===(i=null===(n=null==s?void 0:s.forms)||void 0===n?void 0:n[c])||void 0===i?void 0:i.tabs;if(l)for(var u in l)if(!l[u].collapsed){a({type:Et.a,payload:!0,meta:{pageId:e,contextKey:c,tabId:u}});break}}}}var At=r("iFdD");var kt=r("iN5/"),Mt=r("8wET"),Dt=r("exUJ"),Rt=r("b/oW");var Bt=r("UTiY"),Lt=r("RYq1"),Vt=r("Gt1u"),zt=r("B188");var Gt=r("dcAs");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Wt(e){var t=[];return function(r){return{type:"initialize.editFormAction.async",execute:function(b,v,_){var O=b.dispatch,j=b.getState,P=j(),F=Object(ee.Ib)(P,e),T=Object(ee.Eb)(P,e),w=v.TraceManager.getTracer(Object(ee.S)(F,"initializeAction")),E=Object(ee.R)(F,"initializeAction");!function(e){Object(St.b)(nt,it.a.Timer),Object(St.b)(ot,it.a.BusinessProcessFlow),Object(St.b)(Object(st.a)(e),it.a.SearchWidget,it.a.ReferencePanelSearchWidget),Object(St.b)(_t,it.a.ReferencePanel),Object(St.b)(me.a,it.a.PowerBI)}(O),function(e,t,r){if(!r){var n=function(e){return function(t,r){return Object(At.a)(e),Promise.resolve()}}(e);t.Router.registerPreCloseHandler(e,n)}}(e,v,T);var x,N,A,k,M,D=Object(y.g)(j(),e),B=D.formId,L=i.a.toString(B),z=D.entityTypeName,G=D.id,W=i.a.isNullOrEmpty(G),H=i.a.toString(G),U=D.selectedTabId,q=D.selectedRelatedEntity,Q=Z.g+z,se=new a.a(z,G);t.push({name:"CorrelationId",value:_.correlationId},{name:"ContextId",value:_.contextId},{name:"ActionStack",value:_.stack},{name:"InitialFormId",value:L},{name:"EntityName",value:z},{name:"entityId",value:H},{name:"PageId",value:e},{name:"IsMainFormDialog",value:F.toString()}),w.info("Executing edit form initialize action.",t);var ue=Object(S.j)(j(),e);t.push({name:"ContextToken",value:JSON.stringify(ue)}),O(Object(Re.b)(ue,e,D.entityTypeName,G));var de=function(e,t,r,n,a){if(r&&r.error)return Promise.reject(r.error);if(r&&!0===r.noFormsFound)return Promise.reject(2200000017);var o=r&&r.updatedFormId;if(!o||i.a.equals(o,i.a.EMPTY)){var s="Form descriptor is null or not defined";throw t.error(s,a),new ve.a(s)}return e(Object(ge.c)(o,n)).then((function(){return o}))}(O,w,r,z,t),_e=Object(It.a)(P,e),Se=O(Object(h.e)(_e)).then((function(){t.push({name:"RetrievedResourceStringsTimeStamp",value:Date.now()}),w.info("Got resource strings",t)})),Ie=T?Promise.resolve():O(Object(J.a)(Q)),je=Object(ye.h)(j());return de.then((function(r){r!==B&&t.push({name:"FormId",value:i.a.toString(r)});var h=Object(c.e)(j,O,w,_,G,z,e);B=r,se.id===i.a.EMPTY&&O(Object(Ge.b)(se));var b=Object(ee.N)(j(),B),F=U||(q?q.id:b);O(Object(Ct.b)(e,F)),F&&(!function(e,t,r,n,i){var a,o=Object(ee.db)(e(),r,n,!1,(function(e,t){return Object(p.g)(e,r,t,i)})),s=Object(p.j)(e(),n),c=null;for(var l in s.Controls){var u=s.Controls[l];if(Object(Oe.c)(e(),u.UniqueId,n)===Ce.d){(a={})[l]=u,c=a;break}}var d=Object(ee.gc)(e(),n,i).map((function(t){return Object(ee.db)(e(),r,t)}));d.push(o),c&&d.push(Object(ee.db)(e(),r,n,!1,(function(){return c})));var h=d.reduce((function(e,t){for(var r in t)e[r]=t[r];return e}),{}),g=[];for(var l in h)g.push(t(Object(Me.a)(h[l])));Promise.all(g)}(j,O,e,B,F),pe(j(),e,B,se,z,F)),N=Object(l.a)(j(),z);var E=Object(p.j)(j(),B);k=Object(ge.d)(O,E.InlineQuickForms,P,v);var L=O(Object(o.f)(E.FormLibraries));return h.then((function(){return Promise.all([Se]).then((function(){return function(e,t,r){if(e&&r&&r.Controls&&e.clientHost&&e.clientHost.subtype===ht.a.Phone){var a=r.Controls.notescontrol;if(a&&a.ParentSectionName){var o,s=r.Tabs[0],c=s.Columns.findIndex((function(e){return(o=e.SectionNames.indexOf(a.ParentSectionName))>-1}));if(!(c<0)){var l=s.Columns[c],u=Object(n.__assign)(Object(n.__assign)({},l),{SectionNames:[a.ParentSectionName]});l.SectionNames.length>1?l.SectionNames.splice(o,1):s.Columns.splice(c,1);var d=Object(n.__assign)({},r);d.Tabs.push(Object(n.__assign)(Object(n.__assign)({},s),{Id:"tab_"+i.a.newGuid().guid,Name:"TIMELINEWALL_TAB_SYSTEM_GENERATED",Label:Object(Be.b)(e,"L_InteractionWall_Title"),Columns:[u],DomId:Object(Tt.a)(),LabelId:null})),d.TabNames.splice(1,0,"TIMELINEWALL_TAB_SYSTEM_GENERATED");var p={};p[i.a.toString(d.Id)]=d;var h={forms:p};t({type:wt.a,payload:h})}}}}(j(),O,E),O(Object(c.h)(B,e,ue,je)).then((function(){A=O(Object(oe.b)(D.entityTypeName,B)).then((function(t){return O(Object(oe.c)(e,ue,t))})),w.info("initializeForm promise resolved successfully."),O(Object(g.b)(e,m.a.MetadataRetrieved))}))})).catch((function(e){t.push({name:"loadResourceStringsBeforeInitializeForm.reason",value:Object(qe.e)(e)}),w.error("Could not load resource strings prior to InitializeForm",t),Object(ve.b)(e)}))})).then((function(){var r=Ht(j(),O,e,w,se,B,D,N),l=D&&D.data&&D.data[Y.r],h=Object(c.d)(j(),O,z,e,v,_,l).then((function(){return T||Object(ee.n)(P)?Promise.resolve():X(j,O,w,e,ue,se,i.a.tryParse(D.processId),_,v,r,D)})),A=Object(He.d)(j(),e,B,ue,F,!1,!1,W);M=Object(We.a)(j,O,w,v.EventManager,e,E,G,A).inProgress,Promise.all(Object(n.__spreadArrays)([r],M)).then(he.c);var k=v.ScriptManager.initializeContainerForClientApi(e,!Object(ee.Eb)(j(),e));return function(e,t,r,n,i,a){if(t)e(Object($.b)(r,a,t)),e(xt(t,r,a));else if(n){var o=n.id,s=n.title,c=n.entityName,l=n.relationshipName,u=n.ordinal,d=Object(S.a)(a,l,u),p={id:o,title:s,entityName:c,isSelected:!0,relationshipName:l};e(Object(Ae.a)(r,d,p)),e(Nt(r,a))}else i&&(e(Object($.b)(r,a,i)),e(xt(i,r,a)))}(O,U,e,q,b,ue),k.then((function(){return function(e,t,r,n,i,a,o){return n.info("createXrmForm promise resolved successfully."),Object(c.j)(e,t,r,i,a,n,o).then((function(){n.info("loadScripts promise defined in loadScriptsAfterClientApi() function resolved successfully.",o)})).catch((function(e){return o.push({name:"loadScripts.reason",value:Object(qe.e)(e)}),n.error("Error while executing loadScripts promise defined in loadScriptsAfterClientApi() function.",o),Promise.resolve()}))}(j(),v,O,w,B,e,t).then((function(){return Object(R.c)(j(),Ke.nd)||O(Object(g.b)(e,m.a.OnLoadReady)),r.then((function(){w.info("loadRecordData promise resolved successfully."),function(e,t,r,n){if(r.id===i.a.EMPTY)return;var o=Object(V.h)(e,r.etn),c=Object(ee.ec)(e,r.etn,r.id);if(!c){var l=[];if(l.push({name:"title",value:""+c}),l.push({name:"identifier.etn",value:r.etn}),l.push({name:"identifier.id",value:i.a.toString(r.id)}),o){var u=new a.a(r.etn,r.id),d=Object(s.j)(e,u,o.PrimaryNameAttribute);l.push({name:"entityDetails.PrimaryNameAttribute",value:o.PrimaryNameAttribute}),l.push({name:"nonFormattedPrimaryNameAttributeValue has value",value:!!d})}else l.push({name:"entityDetails",value:""+o});n.EventManager.ReportComponentFailure("MRU.EditForm.InitializeAction",new Error("Title for recent item is null or empty."),"Analyze event parameters to understand why Title is empty.",l)}var p={RecordType:ae.a.Entity,EntityTypeName:r.etn,LastAccessed:new Date,ObjectId:r.id,Title:c,IconPath:Object(V.j)(e,r.etn,r.id),HasPrimaryImageField:o&&!!o.PrimaryImageAttribute};t(Object(ie.b)(p))}(j(),O,se,v);var r=function(e,t,r,n,i){var a=[],o=Object(Ne.f)()(e(),{id:r,isFromInitializeAction:!0});if(o){var s=null,c=null;o.forEach((function(e){if(e&&e.relatedItems&&(a=a.concat(e.relatedItems),t.id&&t.navItemId))for(var r=0,i=e.relatedItems;r<i.length;r++){var o=i[r];if(o.id.toLowerCase()===t.navItemId.toLowerCase()){c={id:o.id,title:o.title,isSelected:!0,entityName:o.entityName,relationshipName:o.relationshipName},s=Object(S.a)(n,o.relationshipName,o.ordinal);break}}}));var l=Object(Ot.w)(e()),u=l?l.languageId:null;if(i(Object(Ue.b)(r,a,u)),c&&s)return i(Object(Ae.a)(r,s,c)).then((function(a){if(t.bodyOnly){var o=Object(be.b)(r,t.entityTypeName,e(),a,n);if(o)return i(Object(fe.c)(r,o)),!0}}))}return Promise.resolve(!1)}(j,D,e,ue,O);if(function(e,t,r,n,i){var a=Object(s.t)(e,i);if(!a)return;for(var o=0;o<a.length;o++){var c=a[o],l=[];if(c.Parameters)for(var u=function(t){var a=c.Parameters[t];if(a.ParameterType===Pt.a.Attribute){var o=Object(s.j)(e,i,a.Data);if(o){var u=o.reference,d=function(){var e={entityTypeName:u.etn,id:u.id};n(Object(re.a)("EditForm",e,r))};l.push({Label:u.name,Handler:d})}}else a.ParameterType===Pt.a.String&&l.push({Label:a.Data})},d=0;d<c.Parameters.length;d++)u(d);var p=ne.a.information;switch(c.Severity){case Ft.a.Warning:p=ne.a.warning;break;case Ft.a.Error:p=ne.a.error}n(Object(te.c)(t,r,c.Message,p,"serverNotification_"+o,void 0,l))}}(j(),ue,e,O,se),x=function(e,t,r,n,a,c,l,u,d,h){var g=[],m=Object(ee.fc)(e,n,a),f=Object(ee.gc)(e,l,u),b=function(l){var u=Object(ee.C)(e,n,l,a),b=u?u.dataFieldName:null,y=Object(s.j)(e,c,b);if(y){var v=y.reference;if(!v)return"break";var _=m[l][v.etn];if(!i.a.isNullOrEmpty(_)){var S=f.indexOf(_)>=0;if(S){var O=Object(V.h)(e,v.etn),C=[];O&&!!O.PrimaryImageAttribute&&C.push(Object(be.a)(O.PrimaryImageAttribute,null,null));var I=t(Object(o.e)(v,_,null,C,!0)).catch((function(e){var t=v.id?v.id.guid:"Invalid associated recordId.";d.push({name:"retrieveRecordDataForForm.Reason",value:Object(qe.e)(e)},{name:"associatedRecordId",value:t},{name:"entityRef.etn",value:v.etn}),r.error("Error while executing dataPromise promise by calling loadQuickFormsData() function. Check EventContext for retrieveRecordDataForForm.Reason to see which catch block this error occurred.",d),Object(ve.b)(e)}));g.push(I)}if(Object(De.b)(e)){var j=Object(He.j)(e,n,[_],a,S);if(v.id&&j&&Object.keys(j).length>0){var P=Object(p.j)(e,_),F=Object(We.a)((function(){return e}),t,r,h.EventManager,n,P,v.id,j).inProgress;g.push.apply(g,F)}}}}};for(var y in m){if("break"===b(y))break}return Promise.all(g).then((function(){g.length<=0&&r.warn("No dataPromises within EditForm while calling loadQuickFormsData() function.",d)})).catch((function(e){d.push({name:"Promise.all.Reason",value:Object(qe.e)(e)}),r.error("Error with dataPromises in EditForm while calling loadQuickFormsData() function. Check EventContext for Promise.all.Reason to see which catch block this error occurred.",d)}))}(j(),O,w,e,ue,se,B,F,t,v),O(Object(f.a)(e,ue)),i.a.isNullOrEmpty(D.id)){var n=Object(p.j)(j(),B),l=[Y.q,Y.u,Y.v,Y.w];Object(c.c)(j(),O,z,e,l,n.Attributes,ue,w,t)}return h.then((function(){return Object(R.c)(j(),Ke.L)&&O(Object(Xe.c)(z,e,ue)),L.then((function(){var n;(Object(R.c)(j(),Ke.nd)&&O(Object(g.b)(e,m.a.OnLoadReady)),Object(c.k)(j(),v,O,ue,e,w,t),W)&&v.ScriptManager.getContainer(e).getEventManager().addOnProcessChangeEvent(ue,(function(){!T&&O(function(e){return{type:"Forms.EditForm.InjectBPFFields",sync:!0,execute:function(t,r,n){var i=t.dispatch,o=t.getState,c=o(),l=Object(y.g)(c,e);if(l){var u=l.id,d=new a.a(l.entityTypeName,u),p=Object(S.j)(c,e);if(Object(s.e)(c,d)){var h=r.TraceManager.getTracer("initializeNewBpf.editFormAction.async");return K(d,p,e,i,o,h)}}}}}(e)),O(Object(Xe.c)(z,e,ue))}));O(Object(u.a)(!0,e,ue)),!T&&!Object(ee.q)(P)&&O(Object(d.a)(Q,e,e,ue)),ce.a.createEvent("FormOnloadCompleteEvent",le.g).createMarker(),O(Object(g.b)(e,m.a.EditReady)),C.a.addCommonKpiParameters(((n={})[I.b.FormId]=i.a.toString(B),n)),r.then((function(t){if(!t){var r=Object(be.c)(e,z,j(),ue);r&&O(Object(fe.c)(e,r))}}))})).catch((function(e){t.push({name:"retrieveRecordDataForOrganization.Reason",value:Object(qe.e)(e)}),Object(ve.b)(e)}))})).catch((function(e){t.push({name:"loadBusinessProcessFlow.Reason",value:Object(qe.e)(e)}),Object(ve.b)(e)}))})).catch((function(e){t.push({name:"loadRecordData.Reason",value:Object(qe.e)(e)}),w.error("Error while executing loadRecordData promise. Check EventContext for retrieveRecordDataForOrganization.Reason, loadBusinessProcessFlow.Reason and loadRecordData.Reason to see which catch block this error occurred.",t),Object(ve.b)(e)}))})).catch((function(e){t.push({name:"loadScriptsAfterClientApi.Reason",value:Object(qe.e)(e)}),Object(ve.b)(e)}))})).catch((function(e){t.push({name:"initializeContainer.Reason",value:Object(qe.e)(e)}),Object(ve.b)(e)}))})).catch((function(e){var r=e;r&&r.getNegativeErrorCode&&-2147220969===r.getNegativeErrorCode()&&O(Object(xe.c)(G,Object(De.b)(j()))),t.push({name:"checkEntityEnabledForUCIPromise.Reason",value:Object(qe.e)(e)}),Object(ve.b)(e)}))})).then((function(){return Promise.all([Se,Ie,x,A,k]).then((function(){!function(e,t,r,n){var i=Object(y.g)(e,r);Object(ee.kb)(e,{id:r},t)&&i.isOfflineSyncError&&(n(Object(Ve.b)(t,r,ze.c)),n(Object(te.c)(t,r,Object(Be.b)(e,Le.e),ne.a.error,"osn_"+(new Date).getMilliseconds())))}(j(),ue,e,O)}))})).then((function(){Te(j(),e,ue,B,z,se,D,t),v.EventManager.ReportComponentSuccess(E,t),O(Object(g.b)(e,m.a.FullLoad)),
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,r,n,a){Object(kt.b)((function(){var o,c,l,u,d,p,h,g=e(),m=[];for(var f in a.Controls){var b=a.Controls[f];if(Object(Oe.c)(g,b.UniqueId,a.Id)===Ce.d){var y=Object(s.j)(g,n,b.DataFieldName),v=null===(o=null==y?void 0:y.reference)||void 0===o?void 0:o.etn,_=null===(c=null==y?void 0:y.reference)||void 0===c?void 0:c.id;if(!_||!v)continue;var S=null===(l=Object(ee.Mc)(g,{id:t,controlName:f},r))||void 0===l?void 0:l.initializationIntent,O=Object(Oe.b)(g,b.UniqueId,a.Id),C=Object(bt.b)(g),I=(null===(p=null===(d=null===(u=null==O?void 0:O.CustomControls)||void 0===u?void 0:u[C])||void 0===d?void 0:d.Parameters)||void 0===p?void 0:p.QuickForms).Value,j=void 0;if(I&&(j=i.a.tryParseOrNull(null===(h=Object(Mt.a)(I,v))||void 0===h?void 0:h[v])),Object(Dt.a)(e(),t,f))continue;if("fullload"===S){var P={entityTypeName:v,pageType:"entityrecord",formId:j,id:_};m.push({input:P,controlName:f})}}}m.reduce((function(r,n){return r.then((function(){var r=Object(Dt.a)(e(),t,n.controlName);return r?Promise.resolve():new Promise((function(i,a){Object(kt.b)((function(){if(r=Object(Dt.a)(e(),t,n.controlName))return i();Object(Rt.a)(Object(At.b)(t,n.controlName),n.input).then((function(){return i()}))}),"initialize form component")}))}))}),Promise.resolve())}),"load form components")}(j,e,ue,se,Object(p.j)(P,B)),function(e,t,r,i){Object(zt.a)()&&(e(function(e){var t=[];return{type:"formChecker.RelatedMenu.async",execute:function(r,i){var a,o=r.dispatch,s=r.getState;return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,c,l,u,d,p,g,m,f,b,v,_;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return r=s(),c=null===(a=null==i?void 0:i.TraceManager)||void 0===a?void 0:a.getTracer(""+I.k+I.p),l=Object(It.b)(),[4,o(Object(h.e)(l))];case 1:return n.sent(),u=s(),d=Object(Be.e)(u,l),p=[],Object(Ne.h)(u,{id:e})?(f=Object(Ne.f)(),b=f(r,{id:e,getAllMenuItemsForFormChecker:!0}),v=Object(y.g)(u,e),_=null==v?void 0:v.entityTypeName,null==b||b.forEach((function(e){e&&e.relatedItems&&e.relatedItems.forEach((function(t){var r,n,i,a;if(t){var o=(null===(r=t.displayStateReason)||void 0===r?void 0:r.reason)?Object(Be.c)(d,t.displayStateReason.reason):null,s=t.labelSource?Object(Be.c)(d,t.labelSource):null,c={Id:t.id,Label:t.title,Area:e.areaName,"Primary Entity":_,"Related Entity":t.entityName,Relationship:t.relationshipName,Displayed:null===(i=null===(n=t.displayStateReason)||void 0===n?void 0:n.displayed)||void 0===i?void 0:i.toString(),"Displayed State Reason":"["+(null===(a=t.displayStateReason)||void 0===a?void 0:a.reason)+"]"+(o?": "+o:""),"Label Source":"["+t.labelSource+"]"+(s?": "+s:"")};p.push(c)}}))}))):(g=Ne.a.NotDisplayed_ShowNavigationItemsOptionDisabled,m=g.reason?Object(Be.c)(d,g.reason):null,p.push({Displayed:"false","Displayed State Reason":"["+g.reason+"]"+(m?": "+m:"")})),t.push({name:I.v,value:I.p}),t.push({name:I.p,value:JSON.stringify(p)}),null==c||c.warn(I.n,t),[2]}}))}))}}}(t)),e(Object(Gt.a)(t,r,i)))}(O,e,ue,z),Promise.all(M).catch((function(){w.warn("Executing edit form initialize action : controlPromises.",t)}))})).catch((function(r){if(Te(j(),e,ue,B,z,se,D,t),2200000017===r){var n=Object(ke.b)(j(),e,2200000017);O(Object(Bt.b)(n,!0,e)).then((function(){O(Object(Lt.e)(e,"dismiss"))}))}else O(Object(Vt.b)(e,Object(ve.c)(r))),Object(ke.h)(j(),e,r,t,v,E),Object(ve.b)(r)}))},getFailureParameters:function(e){return Object(ke.a)(e,t),t}}}}function Ht(e,t,r,n,s,c,l,u){var d=Object(ee.Eb)(e,r)?null:function(e,t){var r=i.a.tryParseOrNull(e.processId),n=i.a.tryParseOrNull(e.processInstanceId);if(t&&t.etn&&t.id&&r&&n){var o=a.a.toLegacyEntityReference(new a.a("businessprocessflowinstance",r)),s=a.a.toLegacyEntityReference(new a.a("businessprocessflowinstance",n));return new jt.a(a.a.toLegacyEntityReference(t),o,s)}return new jt.a(a.a.toLegacyEntityReference(t),null,null)}(l,s);return t(Object(o.e)(s,c,d,u,!0)).then((function(){ce.a.createEvent("DataLoaded",le.g).createMarker()})).catch((function(e){var t=[{name:"retrieveRecordDataForForm.Reason",value:Object(qe.e)(e)}];Object(ke.a)(e,t),n.error("Error while executing retrieveRecordDataForForm promise defined in loadRecordData() function. Check EventContext for retrieveRecordDataForForm.Reason to see which catch block this error occurred.",t),Object(ve.b)(e)}))}},"zt+H":function(e,t,r){"use strict";r.d(t,"d",(function(){return d})),r.d(t,"e",(function(){return p})),r.d(t,"b",(function(){return i})),r.d(t,"f",(function(){return o})),r.d(t,"i",(function(){return s})),r.d(t,"g",(function(){return c})),r.d(t,"c",(function(){return l})),r.d(t,"h",(function(){return a})),r.d(t,"a",(function(){return u}));var n=r("zPLw"),i="#FDE7E9",a="#107C10",o="#A80000",s="#D83B01",c="#6E6F77",l="#E8EAEC",u=32;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function d(e){return e===n.a?i:e===n.e?"#FED9CC":e===n.c?"#E1DFDD":e===n.d?"#DFF6DD":"#FFF4CE"}function p(e){return e===n.a?o:e===n.e?s:e===n.d?a:c}},zvr0:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return o}));var n=r("c/eZ"),i=r("Sscr"),a=r("uQP8"),o="control.update.unboundOutputs";function s(e,t,r,s){return{type:"control.update.unboundOutputs.async",execute:function(c){var l=c.dispatch,u=c.getState;if(!Object.keys(s).length)return Promise.resolve();var d=u(),p=Object(a.a)(d,e),h=!1,g=Object(i.v)(r),m=Object(n.__assign)({},p.forms[g].controlUnboundOutputs);for(var f in s){var b=s[f],y=t+"."+f;m[y]!==b&&(m[y]=b,h=!0)}return h&&l(function(e,t,r){return{type:o,payload:{controlUnboundOutputs:r},meta:{pageId:e,contextKey:t}}}(e,g,m)),Promise.resolve()}}}}}]),window.bundleExecutionMarkers["scripts/es5/modelformcomponent.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();