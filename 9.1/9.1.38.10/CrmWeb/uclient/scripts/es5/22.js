(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/22.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[22,70],{"0z0R":function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n("GUnN"),r=n("Ww2r"),i=n("JlqV"),c=n("kh6f"),o=n("mGpW"),s=n("Vm/X"),l=n("MLbG");function f(e,t){return{type:"offline.alert.dialog.async",execute:function(n,f){var u=n.dispatch,b=n.getState;if(Object(i.b)(b()))return c.c.info("Offline: Server is available"),Promise.resolve();var O=["Dialog_Button_Ok",e];return u(Object(o.e)(O)).then((function(){var n=Object(r.b)(b(),"Dialog_Button_Ok"),i=Object(r.b)(b(),e);return u(Object(l.a)(s.a,i,null,n,null,void 0,void 0,void 0,void 0,void 0,t)).then((function(e){return 0===e.status?(c.c.info("Offline: Alert dialog is created successfully with message "+i),Promise.resolve()):(c.c.error("Offline: Error in Sync error dialog creation "+Object(a.e)(e.error)),Promise.reject(e.error))}))})).catch((function(e){return c.c.error("Offline: Error in alert dialog creation "+Object(a.e)(e)),Promise.reject(e)}))}}}},"766A":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a="set.user.offline.status";function r(e){return{type:a,payload:{isUserSelectOffline:e}}}},"96h0":function(e,t,n){"use strict";n.r(t),n.d(t,"OFFLINE_UPSYNC_HANDLE_ACTION",(function(){return U})),n.d(t,"initializeOfflineUpsyncProcessAsyncAction",(function(){return P}));var a=n("c/eZ"),r=n("H9DM"),i=n("GUnN"),c=n("Ww2r"),o=n("kh6f"),s=n("evh6"),l=n("MLbG"),f=n("+D0h"),u=n("mGpW"),b=n("Vm/X"),O=n("KjDZ"),d=n("WS0f");var p=n("hzb9"),y=n("pkDq"),v=n("rcZN"),S=n("ygXU"),j=n("iJR5"),m=n("VnuK"),g=n("qC0c"),h=n("cZkS"),_=n("US37"),D=n("ZaNp"),U="offline.upsync.process.async",C=null;function P(e){return void 0===e&&(e=!1),{type:U,execute:function(t,n){var r=t.dispatch,i=t.getState;return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,c,o;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return t=Object(v.b)(i()),e||t!==S.a.Completed?null==C?[3,2]:[4,C]:[2,Promise.resolve()];case 1:return a.sent(),[3,6];case 2:return a.trys.push([2,4,5,6]),[4,C=K(i,r,n)];case 3:return a.sent(),[3,6];case 4:throw(c=a.sent())instanceof j.a||(o=(null==c?void 0:c.message)||"Unexpected upsync error",c=j.a.FromMessage(o)),c;case 5:return C=null,[7];case 6:return[2]}}))}))}}}function w(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return Object(g.c)(e(),h.l)&&Object(D.e)(e())?(n=["offline_notification_reconnect_success_text"],[4,t(Object(u.e)(n))]):[3,2];case 1:a.sent(),r=Object(c.b)(e(),n[0]),i={id:"upsync_complete_toast",level:1,message:r,title:null,type:1,onCloseHandler:null},t(Object(_.b)(!1)),t(Object(m.b)(i)),a.label=2;case 2:return[2]}}))}))}function K(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,(function(){var v,S,j,m,g;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:v=new Date,S="Offline: Upsync",a.label=1;case 1:return a.trys.push([1,11,,12]),[4,n.OfflineProvider.hasItemsToUpsync().nativePromise()];case 2:if(!a.sent())return[3,9];o.c.info("OFFLINE : OfflineUpsyncHandler : Has Items To Upsync"),t(Object(p.b)()),a.label=3;case 3:return a.trys.push([3,8,,9]),[4,n.OfflineProvider.startPlayback().nativePromise()];case 4:return j=a.sent(),t(Object(y.b)()),Object(d.a)(j)||0!==j.get_errorCount()?[3,6]:[4,w(e,t)];case 5:return a.sent(),o.c.info("OFFLINE : OfflineUpsyncHandler : Upsync done without conflict"),[3,7];case 6:o.c.warn("OFFLINE : OfflineUpsyncHandler : Upsync done with conflict"),t((h=String(j.get_lastSuccessfulSaveOnCrm()),{type:"offline.syncerror.dialog.async",execute:function(e,t){var n=e.dispatch,a=e.getState,r=["L_Show_Details_Text","Sync_Status_Error_Message","L_Last_Save_To_CRM_Server_Text","Sync_Status_Dialog_Title","Dialog_Button_Ok"];return n(Object(u.e)(r)).then((function(){var e=Object(c.e)(a(),r),t=Object(c.c)(e,"L_Show_Details_Text"),u=Object(c.c)(e,"Sync_Status_Error_Message"),p=Object(c.c)(e,"L_Last_Save_To_CRM_Server_Text"),y=Object(c.c)(e,"Sync_Status_Dialog_Title"),v=Object(c.c)(e,"Dialog_Button_Ok"),S=u+"\n"+p,j="";return j=Object(d.b)(O.a.get_OverallSyncErrorMessage())?S.replace("{0}",h):O.a.get_OverallSyncErrorMessage(),n(Object(l.a)(b.c,j,{},t,y,"",v)).then((function(e){return 0===e.status?n(Object(f.a)(e.pageId)).then((function(t){t.value.confirmed&&n(Object(s.a)("syncerror",e.pageId,null,null,null,null,null))})):(o.c.error("Offline: Error in Sync error dialog creation "+Object(i.e)(e.error)),Promise.reject(e.error))}))})).catch((function(e){return o.c.error("Offline: Error in Sync error dialog creation "+Object(i.e)(e)),Promise.reject(e)}))}})),a.label=7;case 7:return n.EventManager.ReportComponentSuccess(S),n.EventManager.ReportComponentPerformance(S,"Time Taken in ms",+new Date-+v),[2];case 8:return m=a.sent(),o.c.error("OFFLINE : OfflineUpsyncHandler : Upsync Error"),t(Object(r.b)()),n.EventManager.ReportComponentFailure(S,m),n.EventManager.ReportComponentPerformance(S,"Time Taken in ms",+new Date-+v),[2,Promise.reject(m)];case 9:return o.c.info("OFFLINE : OfflineUpsyncHandler : Upsync has no items to sync"),t(Object(y.b)()),[4,w(e,t)];case 10:return a.sent(),[3,12];case 11:return g=a.sent(),o.c.error("OFFLINE : OfflineUpsyncHandler : hasItemsToUpsync Handler Failed"),[2,Promise.reject(g)];case 12:return[2]}var h}))}))}},AqHJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a="offline.set.reinitializeoffline";function r(e){return{type:a,payload:{reInitializeOffline:e}}}},GUUD:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a="offline.set.client.version";function r(e){return{type:a,payload:{clientVersion:e}}}},H9DM:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("ygXU"),r="offline.upsync.pending";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(){var e={upSyncStatus:a.a.Pending};return{type:r,payload:e}}},"He+0":function(e,t,n){"use strict";n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return d}));var a=n("AX1v"),r=n("gKZ6"),i=n("nlyT"),c=n("AqHJ"),o=n("kh6f"),s=n("L+41"),l=n("5iz+");var f=n("0z0R"),u=n("c56u"),b=n("JlqV"),O="offline.opt.status";function d(e){return{type:"offline.opt.status.save",execute:function(t){var n=t.dispatch,O=(0,t.getState)(),d=Object(u.p)(O)===a.a.Enabled;if(e!==d)if(e)n(p(a.a.Enabled));else{if(!Object(b.b)(O))return n(Object(f.a)("Settings_Offline_DisableSync_Information_Message",void 0));!
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){e(Object(r.b)(!0)),e(p(a.a.Disabled)),o.c.info("Offline: OfflineDisable: disableOffline: The offline feature status is disabled"),e(Object(i.c)(s.a.NotAvailable,l.a.None)),o.c.info("Offline: OfflineDisable: disableOffline: The offline status is set to "+s.a.NotAvailable),e(Object(c.b)(!0)),o.c.info("Offline: offlineDisable: disableOffline: Completed")}(n)}return Promise.resolve()}}}function p(e){return{type:O,payload:{offlineFeatureStatus:e}}}},O3n1:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a="offline.set.entity.plural.name";function r(e){return{type:a,payload:{entityPluralName:e}}}},OJ8X:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var a=n("pdOk"),r=n("x9BS"),i=n("xSKp"),c=n("O3n1"),o=n("zvmu"),s=n("UsTu"),l=n("He+0"),f=n("xC+Q"),u=n("y+tj"),b=n("fwX8"),O=n("GUnN"),d=n("9r0m"),p=n("WS0f"),y=n("kh6f"),v=n("oPba"),S=n("H/RR"),j=n("7A4K"),m=n("h/9p"),g=n("nK7r"),h=n("BvBP"),_=n("AX1v"),D=n("GUUD"),U=n("766A"),C=n("qC0c"),P=n("cZkS");function w(){return{type:"offline.retrieve.sessionstate",execute:function(e,t){var n,w,K,I,E,A=e.dispatch,F=[],M=(0,e.getState)(),T=Object(h.e)(M),N=Object(C.c)(M,P.je);return F.push(t.DataSource.retrieveSessionState(S.a.isMobileOfflineOptedInKey)),F.push(t.DataSource.retrieveSessionState(S.a.OfflineProfileDataKey)),F.push(t.DataSource.retrieveSessionState(S.a.offlineDatabaseInformationKey)),F.push(t.DataSource.retrieveSessionState(S.a.OfflineDatabaseKey)),F.push(t.DataSource.retrieveSessionState(S.a.OfflinePrimaryAvailableEntitiesKey)),F.push(t.DataSource.retrieveSessionState(S.a.OfflineEntityPluralNamesKey)),F.push(t.DataSource.retrieveSessionState(a.a)),F.push(t.DataSource.retrieveSessionState(a.d)),F.push(t.DataSource.retrieveSessionState(a.c)),F.push(t.DataSource.retrieveSessionState(S.a.OfflineDisabledInfoKey)),T&&(F.push(t.DataSource.retrieveSessionState(S.a.OfflineApplyApplicationMetadataChangesKey)),n=F.length-1,F.push(t.DataSource.retrieveSessionState(S.a.ClientVersionKey)),w=F.length-1,F.push(t.DataSource.retrieveSessionState(S.a.IsOfflineFirstTimeSyncCompletedKey)),K=F.length-1,F.push(t.DataSource.retrieveSessionState(S.a.IsFirstApplyApplicationMetadataChangesDoneKey)),I=F.length-1),N&&(F.push(t.DataSource.retrieveSessionState(S.a.IsUserSelectOffline)),E=F.length-1),Promise.all(F).then((function(e){var O=Object(p.a)(e[0])?null:e[0],h=Object(p.a)(e[1])?null:e[1],C=Object(p.a)(e[2])?null:e[2],P=Object(p.a)(e[3])?null:e[3],F=Object(p.a)(e[4])?null:e[4],M=Object(p.a)(e[5])?null:e[5],x=Object(p.a)(e[6])?null:e[6],k=Object(p.a)(e[7])?null:e[7],L=Object(p.a)(e[8])?null:e[8],V=Object(p.a)(e[9])?null:e[9],R=Object(p.a)(O)||Object(p.a)(O[S.a.isMobileOfflineOptedInKey])?_.a.Default:parseInt(O[S.a.isMobileOfflineOptedInKey],10),H=Object(p.a)(h)||Object(p.a)(h[S.a.OfflineProfileIdKey])?d.a.EMPTY:d.a.parse(h[S.a.OfflineProfileIdKey]),B=Object(p.a)(h)||Object(p.a)(h[S.a.OfflineProfileVersionKey])?"":h[S.a.OfflineProfileVersionKey],z=Object(p.a)(h)||Object(p.a)(h[S.a.OfflineProfileAvailableEntitiesKey])?null:h[S.a.OfflineProfileAvailableEntitiesKey],G=Object(p.a)(C)||Object(p.a)(C[S.a.norsyncServerConnectionStringKey])?"":C[S.a.norsyncServerConnectionStringKey],X=!Object(p.a)(C)&&!Object(p.a)(C[S.a.isTrialOrganizationKey])&&C[S.a.isTrialOrganizationKey],q=!(!Object(p.a)(C)&&!Object(p.a)(C[S.a.isMocaOfflineFCBEnabledKey]))||Object(v.a)(C[S.a.isMocaOfflineFCBEnabledKey]),J=Object(p.a)(P)||Object(p.a)(P[S.a.OfflineDatabaseKey])?"":P[S.a.OfflineDatabaseKey],Z=Object(p.a)(V)||Object(p.a)(V[S.a.OfflineDisabledEntitiesKey])?null:V[S.a.OfflineDisabledEntitiesKey],W=Object(p.a)(V)||Object(p.a)(V[S.a.MetadataVersionUsedKey])?null:V[S.a.MetadataVersionUsedKey],Q=Object(p.a)(k)||Object(p.a)(k[a.d])?null:k[a.d],Y=!Object(p.a)(L)&&!Object(p.a)(L[a.c])&&L[a.c];if(N){var $=Object(p.a)(e[E])?null:e[E],ee=!Object(p.a)($)&&!Object(p.a)($[S.a.IsUserSelectOffline])&&$[S.a.IsUserSelectOffline];ee&&(y.c.warn("offlineUpdateStateTreeFromSessionState:Setting IsServerAvailable= false as user selected to work in offline mode"),t.DataSource.set_IsServerAvailable(!1)),A(Object(U.b)(ee))}if(A(Object(l.b)(R)),A(Object(u.b)(H,B,z)),A(Object(b.b)(G)),A(Object(s.b)(X)),A(Object(o.b)(q)),A(Object(r.b)(J)),A(Object(f.b)(F)),A(Object(i.a)(Z,W)),A(Object(c.b)(M)),A(Object(j.b)(x)),A(Object(a.i)({syncStatus:Q,metadataAvailable:Y})),T){var te=Object(p.a)(e[n])?null:e[n],ne=!Object(p.a)(te)&&!Object(p.a)(te[S.a.OfflineApplyApplicationMetadataChangesKey])&&te[S.a.OfflineApplyApplicationMetadataChangesKey];A(Object(m.d)(ne));var ae=Object(p.a)(e[w])?null:e[w],re=Object(p.a)(ae)||Object(p.a)(ae[S.a.ClientVersionKey])?"":ae[S.a.ClientVersionKey];A(Object(D.b)(re));var ie=Object(p.a)(e[K])?null:e[K],ce=!Object(p.a)(ie)&&!Object(p.a)(ie[S.a.IsOfflineFirstTimeSyncCompletedKey])&&ie[S.a.IsOfflineFirstTimeSyncCompletedKey];A(Object(g.b)(ce));var oe=Object(p.a)(e[I])?null:e[I],se=!Object(p.a)(oe)&&!Object(p.a)(oe[S.a.IsFirstApplyApplicationMetadataChangesDoneKey])&&oe[S.a.IsFirstApplyApplicationMetadataChangesDoneKey];A(Object(m.f)(se))}return y.c.info("Offline: offlineUpdateStateTreeFromSessionState: RetrieveMobileofflineInformation: Success"),Promise.resolve(!0)})).catch((function(e){return y.c.error("Offline: offlineUpdateStateTreeFromSessionState: RetrieveMobileofflineInformation: Failed"+Object(O.e)(e)),Promise.reject(e)}))}}}},"UBp/":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a;n.d(t,"a",(function(){return a})),function(e){e.LogicalName="LogicalName",e.Id="id",e.Reference="@",e.NullString="null",e.GuidString="@GUID",e.CommandString="Command",e.CommandOperationString="CommandOperation",e.DotSeperator=".",e.CommaSeperator=",",e.DefaultIndex=0,e.FirstIndex=1,e.NegatedReference="!@",e.DateTimeNowString="@DateTime.Now",e.OppCloseDateString="@OpportunityClose.actualend",e.CreateStep="Create",e.RetrieveStep="Retrieve",e.UpdateStep="Update",e.DeleteStep="Delete",e.SetValueStep="SetValue",e.ConditionStep="Condition",e.FailureStep="Failure",e.ActivityString="activity",e.BusinessProcessFlowInstance="businessprocessflowinstance",e.OfflineData="OfflineData",e.tag="tag",e.OfflinePlayback="offlinePlayback",e.OfflinePlaybackUrlParameter="?"+e.tag+"="+e.OfflinePlayback}(a||(a={}))},UsTu:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a="offline.is.trial.organization.set";function r(e){return{type:a,payload:{isTrialOrganization:e}}}},fwX8:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a="offline.norsync.server.connection.string.set";function r(e){return{type:a,payload:{norsyncServerConnectionString:e}}}},gFjC:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a="offline.disabled.entities.update";function r(e,t,n){return{type:a,payload:{offlineDisabledEntities:e,lastMetadataVersionUsedForValidation:t,offlineDisabledPrimaryEntities:n}}}},gKZ6:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a="offline.database.cleanup";function r(e){return{type:a,payload:{isDbCleanupNeeded:e}}}},hzb9:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("ygXU"),r="offline.upsync.start";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(){var e={upSyncStatus:a.a.InProgress};return{type:r,payload:e}}},nK7r:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a="offline.first.time.sync.completed";function r(e){return{type:a,payload:{isOfflineFirstTimeSyncCompleted:e}}}},pkDq:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("ygXU"),r="offline.upsync.completed";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(){var e={upSyncStatus:a.a.Completed};return{type:r,payload:e}}},x9BS:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a="offline.database.update";function r(e){return{type:a,payload:{existingDatabaseName:e}}}},"xC+Q":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a="offline.available.primary.entities.update";function r(e){return{type:a,payload:{offlineAvailablePrimaryEntities:e}}}},xSKp:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n("gFjC"),r=n("GUnN"),i=n("lMVv"),c=n("Ev4I"),o=n("WS0f"),s=n("kh6f"),l=n("gBKR");function f(e,t){return{type:"offline.disabled.info",execute:function(n,f){var u=n.dispatch,b=n.getState;if(Object(o.a)(e))return Promise.resolve();for(var O=[],d=0,p=e;d<p.length;d++){var y=p[d];O.push(u(Object(l.f)(y,!1,null)))}return Promise.all(O).then((function(){for(var n=b(),r=[],l=Object(c.g)(n),f=0,O=e;f<O.length;f++){var d=O[f],p=Object(i.h)(n,d);Object(o.a)(p)||Object(o.a)(p.EntityLogicalName)||Object(o.a)(l)||Object(o.a)(l[p.EntityLogicalName])||r.push(p.EntityLogicalName)}return s.c.warn("Offline.createOfflineDisabledInfoUpdateAction: Primary entities disabled for offline, entities are not in primary available entities or we don't have metadata: "+r.toString()),u(Object(a.b)(e,t,r)),Promise.resolve()})).catch((function(e){return s.c.error("Offline: offlineDisabledUpdateInfoAsyncAction: createOfflineDisabledInfoUpdateAction: failed with error "+Object(r.e)(e)),Promise.reject(e)}))}}}},"y+tj":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a="offline.profile.set";function r(e,t,n){return{type:a,payload:{profileId:e,profileVersion:t,profileAvailableEntities:n}}}},zvmu:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a="offline.fcb.set";function r(e){return{type:a,payload:{isMocaOfflineFeatureEnabled:e}}}}}]),window.bundleExecutionMarkers["scripts/es5/22.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();