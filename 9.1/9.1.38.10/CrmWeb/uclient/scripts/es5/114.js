(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/114.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[114],{"+//z":function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.KeyQuery=void 0;var a=r("UZ+8"),o=r("GSc/"),u=r("lMa+"),l=function(e){function t(t,r){var n=e.call(this,t)||this;return n._overrideKey=null,n._sourceId=r,n}return i(t,e),t.prototype.get_key=function(){if(!a.IsNullOrUndefinedOrEmptyString(this._overrideKey))return this._overrideKey;var e,t=u.LegacyGuid.tryCreate(this._sourceId);return e=t.equals(u.LegacyGuid.get_empty())?this._sourceId:t.toString(),this.get_EntityLogicalName()+","+e+","+this.get_returnTotalRecordCount()},t.prototype.get_DataLayerInternalCachingKey=function(){return this.get_key()+"::"+this.get_PageNumber()},t.prototype.get_SourceId=function(){return this._sourceId},t.prototype.get_OverrideKey=function(){return this._overrideKey},t.prototype.get_PublicKey=function(){return this._publicKey},t.prototype.set_OverrideKey=function(e){return this._overrideKey=e,e},t.prototype.set_PublicKey=function(e){return this._publicKey=e,this._publicKey},t.prototype.generateNorSyncAttributeName=function(e,t,r){return t},t.prototype.get_id=function(){return this.get_key()},t}(o.LegacyQuery);t.KeyQuery=l},"+u6Z":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n;Object.defineProperty(t,"__esModule",{value:!0}),t.getPartyListAttributeNames=t.getParticipationTypeMask=t.ParticipationTypeMask=void 0,function(e){e[e.Sender=1]="Sender",e[e.ToRecipient=2]="ToRecipient",e[e.CCRecipient=3]="CCRecipient",e[e.BccRecipient=4]="BccRecipient",e[e.RequiredAttendee=5]="RequiredAttendee",e[e.OptionalAttendee=6]="OptionalAttendee",e[e.Organizer=7]="Organizer",e[e.Regarding=8]="Regarding",e[e.Owner=9]="Owner",e[e.Resource=10]="Resource",e[e.Customer=11]="Customer",e[e.Partner=12]="Partner"}(n||(n={})),t.ParticipationTypeMask=n,t.getPartyListAttributeNames=function(e){switch(e){case"campaignactivity":return["partners","from"];case"fax":return["from","to"];case"email":case"letter":return["from","to","cc","bcc"];case"phonecall":return["from","to"];case"appointment":return["optionalattendees","organizer","requiredattendees"];case"campaignresponse":return["customer","partner","from"];case"recurringappointmentmaster":return["optionalattendees","organizer","requiredattendees"];case"serviceappointment":return["customers","resources"];default:return["bcc","cc","customers","optionalattendees","organizer","requiredattendees","resources","sendermailboxid","to","from"]}},t.getParticipationTypeMask=function(e,t){switch((e+"."+t).toLowerCase()){case"campaignactivity.from":case"campaignresponse.from":case"fax.from":case"email.from":case"letter.from":case"phonecall.from":return n.Sender;case"email.to":case"fax.to":case"letter.to":case"phonecall.to":return n.ToRecipient;case"email.cc":return n.CCRecipient;case"email.bcc":case"letter.bcc":return n.BccRecipient;case"appointment.optionalattendees":case"recurringappointmentmaster.optionalattendees":return n.OptionalAttendee;case"appointment.organizer":case"recurringappointmentmaster.organizer":return n.Organizer;case"appointment.requiredattendees":case"recurringappointmentmaster.requiredattendees":return n.RequiredAttendee;case"campaignresponse.customer":case"serviceappointment.customer":return n.Customer;case"serviceappointment.resources":return n.Resource;case"campaignactivity.partners":case"campaignresponse.partner":return n.Partner;default:return function(e){switch(e){case"bcc":return n.BccRecipient;case"cc":return n.CCRecipient;case"customers":return n.Customer;case"partners":return n.Partner;case"optionalattendees":return n.OptionalAttendee;case"organizer":return n.Organizer;case"requiredattendees":return n.RequiredAttendee;case"resources":return n.Resource;case"sendermailboxid":case"from":return n.Sender;case"to":return n.ToRecipient;case"regarding":return n.Regarding;case"owner":return n.Owner;default:return}}(t)}}},"/vtY":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeSnapshotWrapper=void 0;var n=r("1LmJ"),i=r("fr82"),a=r("UZ+8"),o=function(){function e(e,t,r){if(n.assert(!a.IsNullOrUndefined(e),"XPathEvaluator should not be null"),n.assert(!a.IsNullOrUndefined(t),"Node list obj should not be null"),this._list=[],t instanceof XPathResult)for(var o=t,u=0;u<o.snapshotLength;u++)this._list.push(new i.XPathEvaluatorWrapper(e,o.snapshotItem(u),r));else{var l=t;for(u=0;u<l.length;u++)this._list.push(new i.XPathEvaluatorWrapper(e,l[u],r))}}return e.prototype.get_count=function(){return this._list.length},e.prototype.get_item=function(e){return this._list[e]},e}();t.NodeSnapshotWrapper=o},"0DNP":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallingContext=void 0;var n=r("UZ+8"),i=function(){function e(t,r,i){this._callerPriority=0,this._callerName=n.IsNullOrUndefinedOrEmptyString(r)?e.unknown:r,this._callerPriority=i}return e.prototype.get_callerName=function(){return this._callerName},e.prototype.get_Stack=function(){return this._stack},e.prototype.AppendCallStack=function(e){n.IsNullOrUndefined(e)||(n.IsNullOrUndefined(this._stack)?this._stack=e:this._stack=this._stack+":"+e)},e.prototype.get_callerPriority=function(){return this._callerPriority},e.prototype.IsPreloadCall=function(){return!1},e.unknown="unknown",e}();
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */t.CallingContext=i},"0f0B":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XmlEvaluatorType=void 0,function(e){e[e[void 0]=-1]="undefined",e[e.xPath=0]="xPath",e[e.domParser=1]="domParser"}(t.XmlEvaluatorType||(t.XmlEvaluatorType={}))},"0hOr":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.getAttributeType=t.isDependentOptionSetAttribute=t.getEntityAttributesByType=t.getDependentOptionSetAttributes=t.getPrimaryAttributeName=t.getSelectedAttributesForEntity=t.getAttributeTypes=t.getMissingAttributes=t.getAttributeDescriptor=t.getUnboundAttributes=t.getAttributesForEntity=void 0;var n=r("i2et"),i=r("Mx+d");function a(e,t){var r,n;return e&&(null==e?void 0:e.metadata)&&(null===(r=null==e?void 0:e.metadata)||void 0===r?void 0:r.attributes)?null===(n=null==e?void 0:e.metadata)||void 0===n?void 0:n.attributes[t]:null}function o(e,t,r){var n=a(e,t);if(!n)return null;if(0===r.length)return n;var i={};return r.forEach((function(e){n.hasOwnProperty(e)&&(i[e]=n[e])})),i}function u(e,t,r){var n=a(e,t);return n&&n.hasOwnProperty(r)?n[r]:null}t.getAttributesForEntity=a,t.getMissingAttributes=function(e,t,r){if(!r||!r.length)return[];var n=a(e,t);if(!n)return r;for(var i=[],o=0;o<r.length;o++)n[r[o]]||i.push(r[o]);return i},t.getSelectedAttributesForEntity=o,t.getUnboundAttributes=function(e,t){return a(e,t)},t.getAttributeDescriptor=u,t.getAttributeTypes=function(e,t,r){var n={},i=a(r,t);return i&&(e&&e.length?e.forEach((function(e){i[e]&&(n[e]=i[e].Type)})):Object.keys(i).forEach((function(e){n[e]=i[e].Type}))),n},t.getAttributeType=function(e,t,r){var n=a(r,t);return n&&n[e]?n[e].Type:null},t.getPrimaryAttributeName=function(e,t){var r=i.getEntityDescriptor(e,t);return r&&r.PrimaryNameAttribute?r.PrimaryNameAttribute:null},t.getDependentOptionSetAttributes=function(e,t,r){if(!r||0===r.length)return null;var i=o(e,t,r);if(!i)return null;var a={};for(var u in i){var l=i[u];l.Type!==n.AttributeType.PickList&&l.Type!==n.AttributeType.MultiSelectPickList||!(l.ParentPicklistLogicalName||l.ChildPicklistLogicalNames&&l.ChildPicklistLogicalNames.length>0)||(a[u]=l)}return a},t.getEntityAttributesByType=function(e,t,r){var n,i,a={};if((null==e?void 0:e.metadata)&&(null===(n=null==e?void 0:e.metadata)||void 0===n?void 0:n.attributes)){var o=null===(i=null==e?void 0:e.metadata)||void 0===i?void 0:i.attributes[t];for(var u in o)o[u].Type===r&&(a[u]=o[u])}return a},t.isDependentOptionSetAttribute=function(e,t,r){var n=u(e,t,r);return!(!n||!(n.ParentPicklistLogicalName||n.ChildPicklistLogicalNames&&n.ChildPicklistLogicalNames.length>0))}},"1LmJ":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.assert=void 0,t.assert=function(e,t){}},"3Cvv":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DescriptorSet=void 0;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n=r("Ct6E"),i=r("UZ+8"),a=r("IUwF"),o=r("8c4H"),u=function(){function e(){this._descriptors={}}return e.prototype.get_descriptors=function(){return this._descriptors},e.prototype.tryGetDescriptor=function(e){return i.IsNullOrUndefined(this._descriptors[o.DescriptorFormat[e]])?"":this._descriptors[o.DescriptorFormat[e]].Data},e.prototype.updateDescriptorSet=function(e,t){o.DescriptorFormat[e]in this.get_descriptors()?this._descriptors[o.DescriptorFormat[e]].Data=t:this._descriptors[o.DescriptorFormat[e]]=new a.DescriptorData(e,t)},e.createFromFetchXml=function(t){var r=new e;return r._descriptors[o.DescriptorFormat[o.DescriptorFormat.FetchXml]]=new a.DescriptorData(o.DescriptorFormat.FetchXml,t),r},e.createDescriptorSet=function(t,r,i){var u=new e;if(r===n.MetadataType.fetchXml)if(t instanceof Array)for(var l=0;l<t.length;l++){var s=t[l];(s.Format!==o.DescriptorFormat.Sql||i)&&(u.get_descriptors()[o.DescriptorFormat[s.Format]]=new a.DescriptorData(s.Format,s.Data))}else"string"==typeof t&&(u.get_descriptors()[o.DescriptorFormat[o.DescriptorFormat.FetchXml]]=new a.DescriptorData(o.DescriptorFormat.FetchXml,t));else u.get_descriptors()[o.DescriptorFormat[0]]=new a.DescriptorData(0,t);return u},e}();t.DescriptorSet=u},"3v6g":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function u(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,u)}l((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o},u=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.parseResponseForRowVersion=t._splitByBoundary=t.parseBatchResponse=t.getEntityIdFromResponse=t.parseResponseAsGuid=void 0;var l=r("XGkY"),s=r("5vhp"),c=r("mE2v");function d(e){var t=c.getHttpHeader(e.headers,"OData-EntityId");if(t){var r=t.indexOf("(")+1,n=t.substring(r,t.length-1);return l.Guid.tryParse(n)}return null}function f(e,t){if(!t)return[];var r="--"+e+"\r\n";0===t.indexOf(r)||(r="--"+e+"\n");var n=t.split(r);if(n.splice(0,1),n.length>0){var i=n[n.length-1],a=i.indexOf("--"+e);n[n.length-1]=i.substring(0,a)}return n}function p(e,t){var r=t.indexOf(":");if(r>=0){var n=t.substring(0,r),i=t.substring(r+1).trim();e[n]=i}return e}function y(e){var t,r,n=-1!==e.indexOf("\r\n\r\n"),i=e.trim().split(n?"\r\n\r\n":"\n\n"),o=-1,u=null,l=null,c="",d="";if(i.length>0){var f=null;i.length>1&&(f=i[1].split(n?"\r\n":"\n"));var y=null;null!=f&&(y=f.slice(1),l=/(HTTP\/\d\.\d) (\d+) (.*)/gi.exec(f[0]));var v=i[0].split(n?"\r\n":"\n");if(null!=v)try{for(var m=a(v),g=m.next();!g.done;g=m.next()){var _=g.value;0===_.toLowerCase().indexOf("content-id:")&&(null==y||y.push(_))}}catch(e){t={error:e}}finally{try{g&&!g.done&&(r=m.return)&&r.call(m)}finally{if(t)throw t.error}}if(o=l&&l.length>=3?Number(l[2]):0,y){var E=y.reduce(p,{});u=new s.FetchLikeHeaders(E)}i.length>1&&(d=i[2]),null!=l&&l.length>2&&(c=l[3])}return h(o,c,u,d)}function h(e,t,r,n){return{status:e,ok:200<=e&&299>=e,statusText:t,headers:r,clone:function(){return Object.assign({},this)},json:function(){return Promise.resolve(n?JSON.parse(n):null)},text:function(){return Promise.resolve(n)}}}t.parseResponseAsGuid=d,t.getEntityIdFromResponse=function(e,t){return n(this,void 0,void 0,(function(){var r,n;return i(this,(function(i){switch(i.label){case 0:return(r=d(t))?[3,2]:[4,t.json()];case 1:return n=i.sent(),[2,l.Guid.tryParse(n[e])];case 2:return[2,r]}}))}))},t._splitByBoundary=f,t.parseBatchResponse=function(e,t){return n(this,void 0,void 0,(function(){var r,n,o,l,s,d,p,v,m,g,_,E,O,b,N,R,T,A,S;return i(this,(function(i){switch(i.label){case 0:return null==t||t.AppendCallStack("Parsers.parseBatchResponse"),[4,e.text()];case 1:r=i.sent(),n=[],e.headers?(l=/boundary=(.*)/,s=c.getHttpHeader(e.headers,"Content-Type"),d=s&&l.test(s)&&l&&s.match(l),o=d&&d.length>1?d[1]:""):o=r.substr(r.indexOf("batchresponse"),r.indexOf("\r\n")-2),p=f(o,r);try{for(v=a(p),m=v.next();!m.done;m=v.next())g=m.value,(_=/^\s*Content-Type: .*boundary=(.*)\r?\n/gi.exec(g))?(E=_[1],O=g.indexOf("--"+E),b=g.slice(O),N=f(E,b),R=N.map(y),n.push.apply(n,u(R))):(T=y(g),n.push(T))}catch(e){A={error:e}}finally{try{m&&!m.done&&(S=v.return)&&S.call(v)}finally{if(A)throw A.error}}return 0===n.length&&(T=h(e.status,e.statusText,e.headers,r),n.push(T)),[2,n]}}))}))},t.parseResponseForRowVersion=function(e){var t=c.getHttpHeader(e.headers,"ETag");if(!t)return null;var r=t.indexOf('"')+1;return t.substring(r,t.length-1)}},"4/PP":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.deserializeErrorResponse=void 0;var n=r("bOB9"),i=r("UZ+8"),a=r("RHls"),o=r("mE2v"),u=r("vqTk"),l=r("n8WZ"),s=r("8xE/");function c(e,t,r){var n,o,u,l,s,f,p,y=null===(n=e.code)||void 0===n?void 0:n.toString();if(i.IsNullOrUndefinedOrEmptyString(y)&&(y=null===(o=e.ErrorCode)||void 0===o?void 0:o.toString(),i.IsNullOrUndefinedOrEmptyString(y)?r.error("Unexpected server error response - no error code"):r.error("Unexpected server error response - error code provided as ErrorCode")),!i.IsNullOrUndefinedOrEmptyString(y)){var h=y.toLowerCase().startsWith("0x")?16:10;p=parseInt(y.toString(),h)}var v=null===(u=e.message)||void 0===u?void 0:u.toString();i.IsNullOrUndefinedOrEmptyString(v)&&(v=null===(l=e.Message)||void 0===l?void 0:l.toString(),i.IsNullOrUndefinedOrEmptyString(v)?r.error("Unexpected server error response - no message"):r.error("Unexpected server error response - message provided as Message"));var m=null===(s=e.stacktrace)||void 0===s?void 0:s.toString();i.IsNullOrUndefinedOrEmptyString(m)&&(m=null===(f=e.StackTrace)||void 0===f?void 0:f.toString(),i.IsNullOrUndefinedOrEmptyString(m)||r.error("Unexpected server error response - message provided as Message"));var g=e.innererror,_=null;i.IsNullOrUndefined(g)||(_=c(g,t,r));var E=d(p,t.status);return new a.ErrorStatus(v,E,null,_,null,null,null,null,null,null,m)}function d(e,t){if(0!==e)return e;switch(t){case 400:return s.ErrorCodes.unknownBadRequestError;case 401:return s.ErrorCodes.UnknownUnauthorizedError;case 403:return s.ErrorCodes.unknownForbiddenError;case 404:return s.ErrorCodes.unknownNotFoundError;case 429:return s.ErrorCodes.UnknownTooManyRequestsError;case 500:return s.ErrorCodes.unknownInternalServerError;case 501:return s.ErrorCodes.unknownNotImplementedServerError;case 502:return s.ErrorCodes.unknownBadGatewayError;case 503:return s.ErrorCodes.unknownServiceUnavailableError;case 504:return s.ErrorCodes.unknownGatewayTimeoutError;default:return s.ErrorCodes.UnknownUnexpectedGenericError}}t.deserializeErrorResponse=function(e,t,r,s){var f,p=e&&e.toLowerCase().indexOf("<!doctype html")>-1;(f=p?function(e,t,r){var n=d(0,t.status);return new a.ErrorStatus(e,n)}(e,t):function(e,t,r){try{var n=JSON.parse(e),o=n.error,u=void 0;return i.IsNullOrUndefined(o)?(r.error("Unexpected server error response - no error at top level"),u=c(n,t,r)):u=c(o,t,r),u}catch(o){return r.error("Failure during error parsing: "+o.message),new a.ErrorStatus(e)}}(e,t,s)).httpStatusCode=t.status;var y=t.headers?o.getHttpHeader(t.headers,u.HEADER.RETRY_AFTER):null;f.retryAfter=y;var h=t.headers?o.getHttpHeader(t.headers,u.HEADER.CONTENT_ID):null;if(h){var v=Number.parseInt(h,10);v>-1&&(f.faultedRequestIndex=v)}var m=t.headers?o.getHttpHeader(t.headers,u.HEADER.SERVER_REQUEST_ID):n.UNKNOWN,g=t.headers?o.getHttpHeader(t.headers,u.HEADER.CLIENT_REQUEST_ID):n.UNKNOWN;f.serverResponseId=m,f.clientRequestId=g;var _=t&&0===t.status;return r.push({name:l.MDS_EVENT_PARAMETERS.ODATA_ERROR_RESPONSE_IS_HTML_TYPE,value:p}),r.push({name:l.MDS_EVENT_PARAMETERS.IS_ERROR_IN_OFFLINE,value:_}),f}},"54+h":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.buildFunctionRequest=void 0;var n=r("vqTk"),i=r("u+qd");t.buildFunctionRequest=function(e,t){var r;try{return{urlParameters:i.getODataUrlForFunction(e,t),additionalHeaders:(r={},r[n.HEADER.ACCEPT]=n.HEADER_VALUES.APPLICATION_JSON,r[n.HEADER.PREFER]=n.HEADER_VALUES.ANNOTATIONS,r),method:"GET"}}catch(e){return{serializationFailure:e.message}}}},"5vhp":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.FetchLikeHeaders=void 0;var n=function(){function e(e){this._headers=e}return e.prototype[Symbol.iterator]=function(){throw new Error("Method not implemented.")},e.prototype.entries=function(){throw new Error("Method not implemented.")},e.prototype.keys=function(){throw new Error("Method not implemented.")},e.prototype.values=function(){throw new Error("Method not implemented.")},e.prototype.append=function(e,t){this._headers[e]=t},e.prototype.get=function(e){return this._headers[e]},e.prototype.has=function(e){return this._headers.hasOwnProperty(e)},e.prototype.delete=function(e){delete this._headers[e]},e.prototype.set=function(e,t){this._headers[e]=t},e.prototype.forEach=function(e){for(var t in this._headers)e(this._headers[t],t,this)},e}();t.FetchLikeHeaders=n},"6/7M":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.GC_UPDATE_DATA_ACTION=t.GC_REMOVE_DATA_ACTION=t.garbageCollectorDataReducer=void 0;var n=r("MXGD"),i=r("8s0g");t.GC_REMOVE_DATA_ACTION="gc.data.remove";t.GC_UPDATE_DATA_ACTION="gc.data.update";var a={},o=["gc.data.update","gc.data.remove"],u=["gc.data.update","gc.data.remove"],l={};function s(e,t){if(0===Object.keys(t).length)return e;var r=Object.assign({},e);for(var n in t){var i=t[n];for(var a in i)r[n]||(r[n]=t[n]),r[n][a]=t[n][a]}return Object.freeze(r)}function c(e,t){if(0===Object.keys(t).length)return e;var r={};for(var n in e){var i=e[n];if(void 0===t[n])r[n]=e[n];else for(var a in i)void 0===t[n][a]&&(r[n]||(r[n]={}),r[n][a]=t[n][a])}return Object.freeze(r)}var d=["gc.data.update","gc.data.remove"];var f={entities:function(e,t){return void 0===e&&(e=l),-1!==o.indexOf(t.type)&&t&&t.payload&&t.payload.entities?"gc.data.remove"===t.type?c(e,t.payload.entities):s(e,t.payload.entities):e},lists:function(e,t){return void 0===e&&(e=a),-1!==d.indexOf(t.type)&&t&&t.payload&&t.payload.lists?"gc.data.remove"===t.type?i.gcGenericRemoveItems(e,t.payload.lists):i.gcGenericAddItems(e,t.payload.lists):e},charts:function(e,t){return void 0===e&&(e=l),-1!==u.indexOf(t.type)&&t&&t.payload&&t.payload.charts?"gc.data.remove"===t.type?c(e,t.payload.charts):s(e,t.payload.charts):e},chartData:function(e,t){return void 0===e&&(e=a),-1!==u.indexOf(t.type)&&t&&t.payload&&t.payload.chartData?"gc.data.remove"===t.type?i.gcGenericRemoveItems(e,t.payload.chartData):i.gcGenericAddItems(e,t.payload.chartData):e}},p=n.combineReducers(f);t.garbageCollectorDataReducer=p},"8c4H":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DescriptorFormat=void 0,function(e){e[e.Json=0]="Json",e[e.FetchXml=1]="FetchXml",e[e.Sql=2]="Sql",e[e.LayoutXml=3]="LayoutXml"}(t.DescriptorFormat||(t.DescriptorFormat={}))},"8s0g":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.gcGenericRemoveItems=t.gcGenericAddItems=t.gcMetadataRibbonsReducer=t.gcMetadataEntitiesReducer=void 0;var n=r("wEu3"),i=[n.UPDATE_GC_METADATA_REFCOUNT_ACTION,n.GC_REMOVE_METADATA],a={};function o(e,t){if(0===Object.keys(t).length)return e;var r=Object.assign({},e);for(var n in t)r[n]=Object.freeze(t[n]);return Object.freeze(r)}function u(e,t){if(0===Object.keys(t).length)return e;var r={};for(var n in e)void 0===t[n]&&(r[n]=e[n]);return Object.freeze(r)}t.gcMetadataEntitiesReducer=function(e,t){return void 0===e&&(e=a),-1!==i.indexOf(t.type)&&t&&t.payload&&t.payload.entities?t.type===n.GC_REMOVE_METADATA?u(e,t.payload.entities):o(e,t.payload.entities):e},t.gcMetadataRibbonsReducer=function(e,t){return void 0===e&&(e=a),-1!==i.indexOf(t.type)&&t&&t.payload&&t.payload.ribbons?t.type===n.GC_REMOVE_METADATA?u(e,t.payload.ribbons):o(e,t.payload.ribbons):e},t.gcGenericAddItems=o,t.gcGenericRemoveItems=u},"8xE/":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n;Object.defineProperty(t,"__esModule",{value:!0}),t.isNonReportableErrorCode=t.ErrorCodes=void 0,function(e){e[e.MetadataNoMapping=2147749377]="MetadataNoMapping",e[e.ObjectDoesNotExist=2147746327]="ObjectDoesNotExist"}(n||(n={})),function(e){e[e.InvalidEntity=2147868684]="InvalidEntity",e[e.unknownBadRequestError=2147951697]="unknownBadRequestError",e[e.UnknownUnauthorizedError=2147951872]="UnknownUnauthorizedError",e[e.unknownForbiddenError=2147951873]="unknownForbiddenError",e[e.unknownNotFoundError=2147951874]="unknownNotFoundError",e[e.UnknownTooManyRequestsError=2147951875]="UnknownTooManyRequestsError",e[e.unknownInternalServerError=2147951876]="unknownInternalServerError",e[e.unknownNotImplementedServerError=2147951877]="unknownNotImplementedServerError",e[e.unknownBadGatewayError=2147951878]="unknownBadGatewayError",e[e.unknownServiceUnavailableError=2147951879]="unknownServiceUnavailableError",e[e.unknownGatewayTimeoutError=2147951880]="unknownGatewayTimeoutError",e[e.UnknownUnexpectedGenericError=2147951881]="UnknownUnexpectedGenericError"}(t.ErrorCodes||(t.ErrorCodes={})),t.isNonReportableErrorCode=function(e){e<0&&(e=4294967295+e+1);var t=[n.MetadataNoMapping,n.ObjectDoesNotExist];return null!=e&&t.indexOf(e)>-1}},A64d:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function u(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,u)}l((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.addRequestId=t.fromODataContract=t.fromQueryState=void 0;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a=r("bOB9"),o=r("XGkY"),u=r("UZ+8"),l=r("l7wu"),s=r("oMGx"),c=r("Mx+d"),d=r("vqTk"),f=r("a5Wk");function p(e){return{type:"odatabuilder.fromodatacontract.async",execute:function(t,r){var a=t.getState,o=t.dispatch;return n(this,void 0,void 0,(function(){var t,u,c;return i(this,(function(d){switch(d.label){case 0:return(t=r.TraceManager.getTracer(l.MDL_COMPONENT_NAMES.ODataBuilder)).info(v()+" Create a SerializedRequest from OData Contract."),u=a(),"ExecuteMultiple"!==e.getMetadata().operationName?[3,2]:[4,o((h=e,{type:"odatabuilder.fromexecutemutipleodatacontract.async",execute:function(e,t){var r=e.dispatch;return n(this,void 0,void 0,(function(){var e,a,o,u=this;return i(this,(function(l){switch(l.label){case 0:return e=h.requests,a=e.map((function(e){return n(u,void 0,void 0,(function(){var t=this;return i(this,(function(a){switch(a.label){case 0:return s.isODataContract(e)?[4,r(p(e))]:[3,2];case 1:return[2,a.sent()];case 2:return s.isChangeSet(e)?[4,Promise.all(e.map((function(e){return n(t,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,r(p(e))];case 1:return[2,t.sent()]}}))}))})))]:[3,4];case 3:return[2,a.sent()];case 4:throw Error("value should be of type OData contract or Changeset")}}))}))})),[4,Promise.all(a)];case 1:return o=l.sent(),[2,f.buildBatchRequest(o,t)]}}))}))}}))];case 1:return c=d.sent(),[3,3];case 2:c=s.buildRequest(u,e),d.label=3;case 3:return[2,y(u,r,c,t)]}var h}))}))}}}function y(e,t,r,a){return n(this,void 0,void 0,(function(){var n,l,s,c;return i(this,(function(i){switch(i.label){case 0:return null==a||a.info(v()+" Add Headers to Serialized Request"),u.IsNullOrUndefined(r.additionalHeaders)&&(r.additionalHeaders={}),[4,h(e,t,r,a)];case 1:return i.sent(),r&&r.additionalHeaders&&!r.additionalHeaders.hasOwnProperty(d.HEADER.CONTENT_TYPE)&&(r.additionalHeaders[d.HEADER.CONTENT_TYPE]=d.HEADER_VALUES.APPLICATION_JSON),t.DataLayerConfiguration.useConsistencyStrong&&(r.additionalHeaders[d.HEADER.CONSISTENCY]=d.HEADER_VALUES.STRONG),r&&r.additionalHeaders&&!r.additionalHeaders.hasOwnProperty(d.HEADER.CLIENT_REQUEST_ID)&&(r.additionalHeaders[d.HEADER.CLIENT_REQUEST_ID]=o.Guid.newGuid().guid),(c={})[d.HEADER.SESSION_ID]=t.EventManager.getCurrentSessionId(),c[d.HEADER.ACTIVITY_ID]=t.EventManager.getActivityId(),n=c,Object.assign(r.additionalHeaders,n),u.IsNullOrUndefined(r.urlParameters)||(l=r.endpoint||d.WEB_API_URL_FRAGMENT,s=t.DataLayerConfiguration.baseUri.replace(/\/$/,""),r.urlParameters=""+s+l+r.urlParameters,r.urlParameters=r.urlParameters.replace(/\t|\r|\n/g,"")),[2,r]}}))}))}function h(e,t,r,a){var o;return n(this,void 0,void 0,(function(){var e,n;return i(this,(function(i){switch(i.label){case 0:return[4,null===(o=t.DataLayerConfiguration.AuthenticationProvider)||void 0===o?void 0:o.getAuthToken()];case 1:return(e=i.sent())&&r&&r.additionalHeaders?(n="Bearer "+e,r.additionalHeaders[d.HEADER.AUTHORIZATION_HEADER]=n):null==a||a.warn(v()+" Authorization token is null or empty "),[2,r]}}))}))}function v(e){return"["+(e||l.PREFIX.ODataBuilder)+"]"}t.fromQueryState=function(e){return{type:"odatabuilder.fromquerystate.async",execute:function(t,r){var u=t.getState;return n(this,void 0,void 0,(function(){var t,n,s,f,p,h;return i(this,(function(i){return(t=r.TraceManager.getTracer(l.MDL_COMPONENT_NAMES.ODataBuilder)).info(v()+" Create a SerializedRequest from Query State."),n=e.viewId&&o.Guid.toString(e.viewId),s=c.getEntitySetName(u(),e.entityLogicalName),f=e.fetchXml?encodeURIComponent(e.fetchXml):"",function(e,t,r){e&&e.additionalHeaders&&(t.viewId&&(e.additionalHeaders[d.HEADER.VIEW_ID_HINT]=o.Guid.toString(t.viewId)),t.pageSize&&(e.additionalHeaders[d.HEADER.PAGESIZE_HINT]=t.pageSize.toFixed()),t.pageNumber&&(e.additionalHeaders[d.HEADER.PAGE_NUMBER_HINT]=t.pageNumber.toFixed()),t.searchString&&(e.additionalHeaders[d.HEADER.SEARCH_HINT]=t.searchString),t.wheres&&t.wheres.length>0&&(e.additionalHeaders[d.HEADER.FILTER_HINT]=t.wheres.toString()),t.sorts&&t.sorts.length>0&&(e.additionalHeaders[d.HEADER.ORDERBY_HINT]=t.sorts.toString()),t.selects&&t.selects.length>0&&(e.additionalHeaders[d.HEADER.SELECT_HINT]=t.selects.toString()),t.linkEntities&&t.linkEntities.length>0&&(e.additionalHeaders[d.HEADER.LINK_HINT]=t.linkEntities.toString()))}(p={urlParameters:s+"?fetchXml="+f,additionalHeaders:(h={},h[d.HEADER.PREFER]=d.HEADER_VALUES.ANNOTATIONS,h[d.HEADER.ACCEPT]=d.HEADER_VALUES.APPLICATION_JSON,h[d.HEADER.SOURCE_ID]=null!=n?n:a.UNKNOWN,h),method:"GET"},e),[2,y(u(),r,p,t)]}))}))}}},t.fromODataContract=p,t.addRequestId=function(e,t){null!=e&&null!=t&&(null==e.additionalHeaders||e.additionalHeaders.hasOwnProperty(d.HEADER.CLIENT_REQUEST_ID)||(e.additionalHeaders[d.HEADER.CLIENT_REQUEST_ID]=t))}},AHn5:function(e,t,r){"use strict";var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.RelatedEntityCollection=void 0;var i=r("WPdH"),a=r("JH5K"),o=function(){function e(e){a.throwOnNullOrUndefinedArgument(e,"entityCollections"),this._entityCollections=e,this._relatedEntityQueries=this._entityCollections.map((function(e){return e.get_value().get_query()}))}return e.prototype.get_entityCollections=function(){return this._entityCollections},e.prototype.get_relatedEntityQueries=function(){return this._relatedEntityQueries},e.prototype.getObjectData=function(){var e,t,r={},i=[];try{for(var a=n(this._entityCollections),o=a.next();!o.done;o=a.next()){var u=o.value,l={};l.key=u.get_key().getObjectData(),l.value=u.get_value().getObjectData(),i.push(l)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return r.entitycollections=i,r},e.prototype.getByRelationship=function(e){var t,r;try{for(var i=n(this._entityCollections),a=i.next();!a.done;a=i.next()){var o=a.value;if(o.get_key().equals(e))return o.get_value()}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return null},e.prototype.addRelationship=function(e,t){for(var r=0;r<this._entityCollections.length;r++)if(this._entityCollections[r].get_key().equals(e))return void(this._entityCollections[r]=new i.KeyValuePair(e,t));this._entityCollections.push(new i.KeyValuePair(e,t))},e}();t.RelatedEntityCollection=o},AYBo:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntityCollection=void 0;var n=r("VmZv"),i=r("UZ+8"),a=r("PVp+"),o=r("JH5K"),u=function(){function e(e,t,r,n,i,a){var u,l;if(this._moreRecords=!1,this._totalRecordCount=0,this._totalRecordCountLimitExceeded=!1,o.throwOnNullOrUndefinedArgument(e,"entities"),this._moreRecords=t,this._totalRecordCount=r,this._totalRecordCountLimitExceeded=n,this._entities=e,this._query=i,a){var s=null===(l=null===(u=this._entities)||void 0===u?void 0:u[0])||void 0===l?void 0:l.get_clientRetrieveOptions();s&&this.set_clientRetrieveOptions(s)}}return e.prototype.get_entities=function(){return this._entities},e.prototype.get_moreRecords=function(){return this._moreRecords},e.prototype.get_totalRecordCountLimitExceeded=function(){return this._totalRecordCountLimitExceeded},e.prototype.get_totalRecordCount=function(){return this._totalRecordCount},e.prototype.get_count=function(){return this.get_entities().length},e.prototype.get_query=function(){return this._query},e.prototype.set_query=function(e){this._query=e},e.prototype.get_key=function(){return!i.IsNullOrUndefined(this._query)&&this._query.get_key?this._query.get_key():""},e.prototype.get_clientRetrieveOptions=function(){return this._clientRetrieveOptions},e.prototype.set_clientRetrieveOptions=function(e){if(this._clientRetrieveOptions=e,!i.IsNullOrUndefined(this._clientRetrieveOptions))for(var t=0;t<this._entities.length;t++)i.IsNullOrUndefined(this._entities[t].get_clientRetrieveOptions())&&this._entities[t].set_clientRetrieveOptions(this._clientRetrieveOptions)},e.prototype.get_item=function(e){return this.get_entities()[e]},e.prototype.getObjectData=function(){for(var e={},t=new Array(this.get_entities().length),r=0;r<this.get_entities().length;r++)t[r]=this.get_entities()[r].getObjectData();return e.entities=t,e.morerecords=this._moreRecords,e.totalrecordcount=this._totalRecordCount,e.totalRecordCountLimitExceeded=this._totalRecordCountLimitExceeded,i.IsNullOrUndefined(this._clientRetrieveOptions)||(e.clientretrieveoptions=this._clientRetrieveOptions.getObjectData()),e},e.prototype.add=function(e){this._entities.push(e)},e.createFromObjectData=function(t){for(var r=new Array(0),i=t.entities,o=0;o<i.length;o++)r[o]=n.EntityRecord.createFromObjectData(i[o]);return new e(r,t.morerecords,t.totalrecordcount,"totalRecordCountLimitExceeded"in t&&t.totalRecordCountLimitExceeded,null,"clientretrieveoptions"in t?a.ClientRetrieveOptions.createFromObjectData(t.clientretrieveoptions):null)},e}();t.EntityCollection=u,u.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityCollection"},BpGS:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyEntityReference=void 0;var n=r("JH5K"),i=r("UZ+8"),a=r("lMa+"),o=function(){function e(e,t,r,a){this.TypeCode=0,n.throwOnNullOrUndefinedArgument(e,"logicalName"),n.throwOnNullOrUndefinedArgument(t,"id"),this.LogicalName=e,t&&(this.Id=t),i.IsNullOrUndefined(r)||(this.Name=r),i.IsNullOrUndefined(a)||this.set_rowVersion(a),this.TypeName=e,this.TypeDisplayName=e}return e.prototype.get_key=function(){return this.Id.toString()},e.prototype.get_identifier=function(){return this.Id.toString()},e.prototype.get_modelType=function(){return this.LogicalName},e.prototype.get_rowVersion=function(){return this.__RowVersion},e.prototype.set_rowVersion=function(e){return this.__RowVersion=e,e},e.prototype.getObjectData=function(){return{logicalname:this.LogicalName,id:this.Id.getObjectData(),name:this.Name,rowversion:!i.IsNullOrUndefined(this.get_rowVersion())&&this.get_rowVersion()}},e.prototype.equals=function(t){if(t instanceof e){var r=t;return r.LogicalName===this.LogicalName&&this.Id.equals(r.Id)&&this.Name===r.Name}return!1},e.prototype.toString=function(){return this.LogicalName+this.Id.toString()},e.prototype.getValue=function(t){return this[e._UppercaseFirstCharacter(t)]},e.prototype.setValue=function(t,r){this[e._UppercaseFirstCharacter(t)]=r},e.get_empty=function(){return e._empty||(e._empty=new e("",a.LegacyGuid.get_empty(),""))},e.createFromObjectData=function(t){var r=t.logicalname,n=a.LegacyGuid.createFromObjectData(t.id),i=t.name;return t.rowversion?new e(r,n,i,t.rowversion):new e(r,n,i)},e._UppercaseFirstCharacter=function(e){return e.substr(0,1).toUpperCase()+e.substr(1)},e}();t.LegacyEntityReference=o},Bt9n:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isExpression=t.isEntityNameTerm=t.isValueTerm=t.isAttributeTerm=void 0,t.isAttributeTerm=function(e){return!!e.attributeName},t.isValueTerm=function(e){return!!e.value},t.isEntityNameTerm=function(e){return!!e.entityName},t.isExpression=function(e){return!!e.terms}},CGvr:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.extractIfMatchHeaderForConcurrency=t.buildUpdateRequest=void 0;var n=r("Mx+d"),i=r("vqTk"),a=r("qIJm"),o=r("evga");t.extractIfMatchHeaderForConcurrency=function(e,t){return e===a.ConcurrencyBehavior.IfRowVersionMatches&&t?'W/"'+t+'"':"*"},t.buildUpdateRequest=function(e,t,r,a,u,l,s,c,d,f){var p;void 0===u&&(u=!0);var y=n.getEntitySetName(e,t)+"("+r+")";c&&(y+=c);var h={urlParameters:y,method:"PATCH",additionalHeaders:(p={},p[i.HEADER.MSCRM_SUPPRESS_DUPLICATION_DETECTION]=u.toString(),p[i.HEADER.IF_MATCH]=l||"*",p[i.HEADER.AUTO_DISASSOCIATE]="true",p),body:f?a:JSON.stringify(a)};return d&&Object.assign(h.additionalHeaders,d),s&&h.additionalHeaders&&(h.additionalHeaders[o.RETRIEVE_ROW_VERSION_HEADER]="true"),h}},DCxx:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.urlEncode=t.xmlEncode=t.xmlAttributeEncode=void 0;var n=r("UZ+8");function i(e){return"CRMEntityReferenceOpen"+(1024*(e.charCodeAt(0)-55296)+(1023&e.charCodeAt(1))+65536).toString(16)+"CRMEntityReferenceClose"}function a(e,t){if(n.IsNullOrUndefinedOrEmptyString(e))return e;if("string"!=typeof e&&(e=e),null!=t){t.length>1&&(t=t.charAt(0));var r=o(t),a=new RegExp(t,"g");return e.replace(a,r)}return function(e,t){return(e=(e=t(e=(e=e.replace(new RegExp("([\\uD800-\\uDBFF][\\uDC00-\\uDFFF])","g"),i)).replace(new RegExp("[\\uD800-\\uDFFF]","g"),"�"))).replace(/CRMEntityReferenceOpen/g,"&#x")).replace(/CRMEntityReferenceClose/g,";")}(e,o)}function o(e){return function(e){var t,r="",n="",i=0;if(null===e)return null;if(""===e)return"";for(var a=0;a<e.length;a++)n+=(t=e.charCodeAt(a))>96&&t<123||t>64&&t<91||32===t||t>47&&t<58||46===t||44===t||45===t||95===t?String.fromCharCode(t):"&#"+t+";",500==++i&&(r+=n,n="",i=0);return n.length&&(r+=n),r}(e)}t.xmlAttributeEncode=function(e){return n.IsNullOrUndefined(e)?"":a(e)},t.xmlEncode=function(e){return n.IsNullOrUndefined(e)?"":a(e)},t.urlEncode=function(e){return""}},DVFg:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Condition=void 0;var n=r("UZ+8"),i=function(){function e(e,t,r){this._set_attributeName(e),this.set_operator(t),this.set_value(r)}return e.prototype.get_entityName=function(){return n.IsNullOrUndefined(this._entityName)&&(this._entityName=""),this._entityName},e.prototype.set_entityName=function(e){return this._entityName=e,e},e.prototype.get_attributeName=function(){return this._AttributeName},e.prototype._set_attributeName=function(e){return this._AttributeName=e,e},e.prototype.get_operator=function(){return this._Operator},e.prototype.set_operator=function(e){return this._Operator=e,e},e.prototype.get_value=function(){return this._Value},e.prototype.set_value=function(e){this._Value=e},e.prototype._get_conditionName=function(){return this._ConditionName},e.prototype.set_conditionName=function(e){return this._ConditionName=e,e},e.prototype.clone=function(){var t=new e(this.get_attributeName(),this.get_operator(),this.get_value());return t.set_entityName(this.get_entityName()),t.set_conditionName(this._get_conditionName()),t},e}();t.Condition=i},DepX:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.buildDeleteRequest=void 0;var n=r("Mx+d"),i=r("vqTk");t.buildDeleteRequest=function(e,t,r,a){var o=n.getEntitySetName(e,t.etn)+"("+t.id.guid+")";a&&(o=o+"/"+a);var u={urlParameters:o,method:"DELETE"};return a||(void 0!==u.additionalHeaders&&null!==u.additionalHeaders||(u.additionalHeaders={}),u.additionalHeaders[i.HEADER.IF_MATCH]=r||"*"),u}},EY1R:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function u(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,u)}l((n=n.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},l=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.addAttributes=t.requestAdditionalMetadataForRequest=t.executeOData=t.EXECUTE_ODATA_OPERATION=void 0;var s=r("Y0ua"),c=r("XGkY"),d=r("nRuH"),f=r("n8WZ"),p=a(r("bMRw")),y=r("gkFy"),h=r("geC1"),v=r("RHls"),m=r("oMGx"),g=r("RslU");t.EXECUTE_ODATA_OPERATION="executeOData.execute";function _(e,t,r){e.hasOwnProperty(t)?e[t]&&(e[t]=r?Array.from(new Set(e[t].concat(r))):null):e[t]=r}function E(e,t){var r,n;if(m.isChangeSet(t))return t.reduce(E,{});if(m.isODataContract(t)){var i=null;if(!t||"function"!=typeof t.getMetadata||!(i=t.getMetadata()))return e;if("Create"===i.operationName){var a=t,o=y.determineReturnedColumns(a.payload);_(e,a.etn,o)}else if("Update"===i.operationName){var u=t;o=y.determineReturnedColumns(u.payload);_(e,u.etn,o)}else if("Delete"===i.operationName){_(e,t.entityReference.entityType,[])}else{var s=function e(t){var r,n,i,a,o,u,s=null,c=null;if(!t||"function"!=typeof t.getMetadata||!(s=t.getMetadata())||!(c=s.parameterTypes))return[];var d=new Set;try{for(var f=l(Object.keys(t)),y=f.next();!y.done;y=f.next()){var v=y.value,m=t[v];if(null!=m)if(s.boundParameter===v)c[v].structuralProperty===p.ODataStructuralProperty.Collection?d.add(m):d.add(m.entityType);else if(c[v])switch(c[v].structuralProperty){case p.ODataStructuralProperty.Collection:if(m&&m.length)if(m[0].getMetadata){var g=m;try{for(var _=(i=void 0,l(g)),E=_.next();!E.done;E=_.next()){e(E.value).forEach((function(e){return d.add(e)}))}}catch(e){i={error:e}}finally{try{E&&!E.done&&(a=_.return)&&a.call(_)}finally{if(i)throw i.error}}}else if(-1===h.ODataPrimitives.indexOf(c[v].typeName)){var O=m;try{for(var b=(o=void 0,l(O)),N=b.next();!N.done;N=b.next()){var R=N.value;"object"==typeof R&&"entityType"in R&&"id"in R&&d.add(R.entityType)}}catch(e){o={error:e}}finally{try{N&&!N.done&&(u=b.return)&&u.call(b)}finally{if(o)throw o.error}}}break;case p.ODataStructuralProperty.EntityType:"object"==typeof m&&"entityType"in m&&"id"in m&&d.add(m.entityType);break;case p.ODataStructuralProperty.ComplexType:e(m).forEach((function(e){return d.add(e)}))}}}catch(e){r={error:e}}finally{try{y&&!y.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}return Array.from(d)}(t);try{for(var c=l(s),d=c.next();!d.done;d=c.next()){_(e,d.value,[])}}catch(e){r={error:e}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}}return e}throw new v.ErrorStatus("unsupported request")}t.executeOData=function(e,r){var n=[];return{type:t.EXECUTE_ODATA_OPERATION,execute:function(t){var i=t.dispatch;return o(this,void 0,void 0,(function(){var t;return u(this,(function(a){return t=new d.UCIContext(c.Guid.newGuid().guid),n.push({name:s.EVENT_PARAMETERS.CLIENT_REQUEST_ID,value:t.RequestId()}),r&&r.push({name:s.EVENT_PARAMETERS.CLIENT_REQUEST_ID,value:t.RequestId()}),[2,i(f.execute(e,n))]}))}))},getFailureParameters:function(){return n}}},t.requestAdditionalMetadataForRequest=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{type:"executeOData.requestAdditionalMetadata.async",execute:function(t,r){var n=t.dispatch;t.getState;return o(this,void 0,void 0,(function(){var t;return u(this,(function(r){switch(r.label){case 0:return e?(t=e.reduce(E,{}),[4,n(g.retrieveEntities(t))]):[2];case 1:return r.sent(),[2]}}))}))}}},t.addAttributes=_},FHhg:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.EntityReference=void 0;var n=r("XGkY"),i=r("BpGS"),a=function(){function e(e,t,r){this.etn=e,this.id=t||n.Guid.EMPTY,this.name=r,Object.freeze(this)}return e.toString=function(e){return e.etn+":"+n.Guid.toString(e.id)},e.equals=function(t,r){var n=e.equalsIgnoreName(t,r);return t&&r?(t.name&&r.name&&(n=n&&t.name===r.name),n):n},e.equalsIgnoreName=function(e,t){return!e&&!t||!(!e||!t)&&(e.etn===t.etn&&n.Guid.equals(e.id,t.id))},e.toLegacyEntityReference=function(e){return new i.LegacyEntityReference(e.etn,n.Guid.toLegacyGuid(e.id),e.name)},e.fromLegacyEntityReference=function(t){return new e(t.LogicalName,n.Guid.fromLegacyGuid(t.Id),t.Name)},e.fromExternalEntityReference=function(t){return new e(t.entityType,n.Guid.fromExternalGuid(t.id))},e.legacyToExternalEntityReference=function(e){return{id:n.Guid.externalGuid(n.Guid.fromLegacyGuid(e.Id)),entityType:e.LogicalName}},e.toExternalEntityReference=function(e){return{id:n.Guid.externalGuid(e.id),entityType:e.etn}},e.EMPTY=new e(""),e}();t.EntityReference=a},"GSc/":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyQuery=void 0;var n=r("mVtf"),i=r("iWcK"),a=r("iDsU"),o=r("8c4H"),u=r("IUwF"),l=r("lqZx"),s=r("3Cvv"),c=r("UZ+8"),d=r("SJSp"),f=function(){function e(e){this._columnSet=null,this._descriptorSet=null,this._noLock=!1,this._pageNumber=1,this._pageSize=1,this._entityLogicalName=null,this._returnTotalRecordCount=!1,this._status=[],this._pagingCookie="",c.IsNullOrUndefined(e)||this._CreateQuery(e)}return e.prototype.get_ColumnSet=function(){return this._columnSet},e.prototype.set_ColumnSet=function(e){return this._columnSet=e,e},e.prototype.set_ColumnNames=function(e){return this._columnNames=e,e},e.prototype.get_DescriptorSet=function(){return this._descriptorSet},Object.defineProperty(e.prototype,"queryStatus",{get:function(){return this._status},enumerable:!1,configurable:!0}),e.prototype._set_DescriptorSet=function(e){return this._descriptorSet=e,e},e.prototype.get_FetchXml=function(){var t,r,i,a=this.rawFetchXmlDoc;return a&&a.firstChild&&(null===(t=a.firstChild)||void 0===t?void 0:t.nodeName)&&(null===(r=a.firstChild)||void 0===r?void 0:r.nodeName)!==e._FetchXmlNodeName?this.get_rawFetchXml():(d.setFetchXmlParameters(this.rawFetchXmlDoc,this.get_PageSize(),this.get_PageNumber(),!0,this._get_NoLock()),a&&!c.IsNullOrUndefinedOrEmptyString(this.get_PagingCookie())&&a.firstChild.attributes.setNamedItem(l.XmlNode.createAttribute(a,e._PagingCookieXmlAttributeName,this.get_PagingCookie())),null===(i=n.create(a))||void 0===i?void 0:i.get_outerXml())},e.prototype.set_FetchXml=function(t){if(c.IsNullOrUndefinedOrEmptyString(t)||"<"!==t.substr(0,1))this.set_ColumnSet(new a.LegacyColumnSet(new Array(0)));else{var r=n.parseXmlDocument(t);if(this.rawFetchXmlDoc=r,!c.IsNullOrUndefined(r)){var o=n.create(r),u=null==o?void 0:o.selectSingleNode("/"+e._FetchXmlNodeName);if(u&&!c.IsNullOrUndefined(u)){var l=u.getAttribute(e._PageNumberXmlAttributeName);c.IsNullOrUndefined(l)||this.set_PageNumber(+l),l=u.getAttribute(e._PageSizeXmlAttributeName),c.IsNullOrUndefined(l)||this.set_PageSize(+l),l=u.getAttribute(e._PagingCookieXmlAttributeName),c.IsNullOrUndefined(l)||this.set_PagingCookie(l);var s=null==o?void 0:o.selectSingleNode("/fetch/entity");if(s&&!c.IsNullOrUndefined(s)&&this.set_EntityLogicalName(s.getAttribute("name")),o&&!c.IsNullOrUndefined(o.selectSingleNode("/fetch/entity/all-attributes")))this.set_ColumnSet(i.AllColumns.get_instance());else{var d=[],f=null==o?void 0:o.selectNodes("/fetch/entity/attribute");if(f)for(var p=0;p<f.get_count();p++){var y=f.get_item(p);if(y&&y.getAttribute("name")){var h=y.getAttribute("name");d.push(h)}}this.set_ColumnSet(new a.LegacyColumnSet(d))}var v=!!r&&r.firstChild.attributes.getNamedItem(e._ReturnTotalRecordCountAttributeName);this._returnTotalRecordCount=c.IsNullOrUndefined(v)?e._DefaultReturnTotalRecordCountValue:"true"===v}}}return t},e.prototype.get_PageNumber=function(){return this._pageNumber},e.prototype.set_PageNumber=function(e){if(e<1)throw Error("PageNumber cannot be less than 1");return this._pageNumber=e,e},e.prototype._get_NoLock=function(){return this._noLock},e.prototype.set_NoLock=function(e){return this._noLock=e,e},e.prototype.get_PageSize=function(){return this._pageSize},e.prototype.set_PageSize=function(e){return this._pageSize=e,e},e.prototype.get_PagingCookie=function(){return this._pagingCookie},e.prototype.set_PagingCookie=function(e){return c.IsNullOrUndefinedOrEmptyString(e)&&(this._pagingCookie=""),this._pagingCookie=e,e},e.prototype.get_EntityLogicalName=function(){return this._entityLogicalName},e.prototype.set_EntityLogicalName=function(e){return this._entityLogicalName=e,e},e.prototype.get_returnTotalRecordCount=function(){return this._returnTotalRecordCount},e.prototype.get_id=function(){return this.get_rawFetchXml()},e.prototype.get_RawSql=function(){var e;return null===(e=this.get_DescriptorSet())||void 0===e?void 0:e.tryGetDescriptor(o.DescriptorFormat.Sql)},e.prototype.set_RawSql=function(e){var t;return c.IsNullOrUndefined(this._descriptorSet)||null===(t=this._descriptorSet)||void 0===t||t.updateDescriptorSet(o.DescriptorFormat.Sql,e),e},e.prototype.get_rawFetchXml=function(){var e;return this.rawFetchXmlDoc?null===(e=n.create(this.rawFetchXmlDoc))||void 0===e?void 0:e.get_outerXml():""},e.prototype.get_FetchXmlForAliasedValues=function(){return this._fetchXmlForAliasedValues},e.prototype.set_FetchXmlForAliasedValues=function(e){this._fetchXmlForAliasedValues=e},e.prototype._CreateQuery=function(e){if(e instanceof s.DescriptorSet)for(var t in this._descriptorSet=new s.DescriptorSet,e.get_descriptors()){var r=e.get_descriptors()[t];this._descriptorSet.get_descriptors()[o.DescriptorFormat[r.Format]]=new u.DescriptorData(r.Format,r.Data),r.Format===o.DescriptorFormat.FetchXml&&this.set_FetchXml(r.Data)}else this.set_FetchXml(e.toString()),this._set_DescriptorSet(s.DescriptorSet.createFromFetchXml(e.toString()))},e.prototype.toString=function(){return"Query: "+this.get_rawFetchXml()},e.prototype.GetColumnNamesFromFetch=function(){return c.IsNullOrUndefined(this._columnNames)?d.getColumnNamesFromFetch(this.rawFetchXmlDoc):this._columnNames},e.prototype.generateNorSyncAttributeName=function(e,t,r){return t},e.get_empty=function(){return new e("")},e._PageNumberXmlAttributeName="page",e._PageSizeXmlAttributeName="count",e._PagingCookieXmlAttributeName="paging-cookie",e._ReturnTotalRecordCountAttributeName="returntotalrecordcount",e._FetchXmlNodeName="fetch",e._DefaultReturnTotalRecordCountValue=!0,e}();t.LegacyQuery=f},Gvsb:function(e,t,r){"use strict";var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.Expression=void 0;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var i=r("Bt9n"),a=r("SV4j"),o=r("Z7iH"),u=r("XGkY"),l=function(){function e(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._hint="",this._operator=e,this._terms=t}return Object.defineProperty(e.prototype,"operator",{get:function(){return this._operator},set:function(e){this._operator=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hint",{get:function(){return this._hint},set:function(e){this._hint=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"terms",{get:function(){return this._terms},set:function(e){this._terms=e},enumerable:!1,configurable:!0}),e._isSimpleCondition=function(e){return e.terms.every((function(e){return!i.isExpression(e)}))},e._toLegacyConditionParameters=function(e){var t,r,a,o="",u="";try{for(var l=n(e.terms),s=l.next();!s.done;s=l.next()){var c=s.value;i.isAttributeTerm(c)?o=c.attributeName:i.isValueTerm(c)?a=c.value:i.isEntityNameTerm(c)&&(u=c.entityName)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=l.return)&&r.call(l)}finally{if(t)throw t.error}}return{attributeName:o,operator:e.operator,value:a,entityName:u}},e.toLegacyFilterExpression=function(t,r){var i,l,s="or"===t.operator?a.LogicalOperator.Or:a.LogicalOperator.And,c=u.Guid.newGuid().guid,d=new o.FilterExpression(s,c,null,r?null:t.hint);if(e._isSimpleCondition(t)){var f=e._toLegacyConditionParameters(t),p=f.attributeName,y=f.operator,h=f.value,v=f.entityName;d.addCondition(p,y,h,v)}else{var m=r;try{for(var g=n(t.terms),_=g.next();!_.done;_=g.next()){var E=_.value;d.addFilterExpression(e.toLegacyFilterExpression(E,m)),m=m||!!E.hint}}catch(e){i={error:e}}finally{try{_&&!_.done&&(l=g.return)&&l.call(g)}finally{if(i)throw i.error}}}return d},e}();t.Expression=l},ILcb:function(e,t,r){"use strict";var n=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.buildContextFilter=t.ModernQueryBuilder=void 0;var a=r("SJSp"),o=r("XGkY"),u=r("KIVe"),l=r("SXiu"),s=r("Gvsb"),c=function(){function e(e){this._query=e?Object.assign({},e):{},this._query.selects=this._query.selects||[],this._selectsInKey=this._query.selects?this._query.selects.map((function(e){return!0})):[],this._query.linkEntities=this._query.linkEntities||[],this._query.sorts=this._query.sorts||[],this._query.wheres=this._query.wheres||[],this._query.contextFiltersAndIds=this._query.contextFiltersAndIds||[],this._query.searchString=this._query.searchString||"",this._query.isQuickFindSearch=this._query.isQuickFindSearch||!1,this._childCountAttributes=[],this._isFetchXmlParsed=!1,this._query.isFetchXmlModified=this._query.isFetchXmlModified||!1,this._resetSort=!1}return Object.defineProperty(e.prototype,"fetchDocument",{get:function(){return this._isFetchXmlParsed||this._parseFetchXmlFromString(this._query.fetchXml),this._fetchDocument},enumerable:!1,configurable:!0}),e.prototype._parseFetchXmlFromString=function(e){e&&(this._fetchDocument=a.parseFetchXmlFromString(e),this._isFetchXmlParsed=!0)},e.fromView=function(t,r){var n=new e;return n._query.viewId=t,n._query.searchString=r||"",n},e.fromXml=function(t,r,n){var i=new e;return i._query.fetchXml=t,i._query.viewId=r,i._query.searchString=n,i},e.fromState=function(t){return new e(t)},e.prototype.select=function(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];for(var a=[],o=0;o<r.length;o++)this._query.selects&&-1===this._query.selects.indexOf(r[o])&&a.push(r[o]);return this._query.selects&&(e=this._query.selects).push.apply(e,i(a)),(t=this._selectsInKey).push.apply(t,i(a.map((function(e){return!0})))),this},e.prototype.selectInternal=function(e,t){return void 0===t&&(t=!0),this._query.selects&&-1===this._query.selects.indexOf(e)&&(this._query.selects.push(e),this._selectsInKey.push(t)),this},e.prototype.addLinkedEntity=function(e,t){var r=a.buildLinkedEntityNode(e,t);return this._query.linkEntities&&this._query.linkEntities.push(r),this},e.prototype.orderBy=function(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=!0),this._query.sorts&&this._query.sorts.push(e+(t?" desc":" asc")),this._resetSort=r,this},e.prototype.addChildCountAttribute=function(e){return this._childCountAttributes.push(e),this},e.prototype.applyContextFilter=function(e,t,r,n){void 0===n&&(n=u.RelationshipRoleOrdinal.Referencing);var i=d(e,this._query.entityLogicalName||a.getEntityFromFetch(this.fetchDocument),n,r),l=o.Guid.toString(t);return this._query.contextFiltersAndIds&&this._query.contextFiltersAndIds.push(l+"="+i),this},e.prototype.toFetchXml=function(e){if(function(e){e&&!e.pageNumber&&(e.pageNumber=1);e&&!e.pageSize&&(e.pageSize=25);e&&(e.useModernQueryBuilder=!0)}(this._query),!this.fetchDocument){if(!e)throw l.createUciError("ModernQueryBuilder: getState function not provided");if(!this._query.viewId)throw Error("ModernQueryBuilder: view id not provided to retrieve fetch xml for the view")}if(!this.fetchDocument)throw Error("ModernQueryBuilder: fetch xml not provided");return this._query.isFetchXmlModified||this._applyModificationsToFetchXml(),a.setFetchXmlParameters(this.fetchDocument,this._query.pageSize,this._query.pageNumber,true,false),(new XMLSerializer).serializeToString(this.fetchDocument)},e.prototype.getQueryState=function(e){return this._query.fetchXml=this.toFetchXml(e),this._query.entityLogicalName||(this._query.entityLogicalName=a.getEntityFromFetch(this.fetchDocument)),this._query.key=this.getKey(),this._query},Object.defineProperty(e.prototype,"pageSize",{get:function(){return this._query.pageSize},set:function(e){this._query.pageSize=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageNumber",{get:function(){return this._query.pageNumber},set:function(e){this._query.pageNumber=e},enumerable:!1,configurable:!0}),e.prototype.getKey=function(){var e=this;return this._query.selects?this._getBaseKey()+": "+this._query.selects.filter((function(t,r){return e._selectsInKey[r]}))+": "+this._query.wheres+": "+this._query.sorts+": "+this._query.contextFiltersAndIds+": "+this._query.linkEntities+": "+this._query.isQuickFindSearch+": "+this._query.searchString+": "+this._query.pageSize:null},e.prototype.getPublicKey=function(){var e=this;return this._query.selects?this._getBaseKey()+": "+this._query.selects.filter((function(t,r){return e._selectsInKey[r]}))+": "+this._query.sorts+": "+this._query.contextFiltersAndIds+": "+this._query.linkEntities+": "+this._query.pageSize:null},e.prototype._getBaseKey=function(){return this._query.viewId?this._query.entityLogicalName+"-"+o.Guid.toString(this._query.viewId):o.Guid.toString(this._query.viewId)},e.prototype._applyModificationsToFetchXml=function(){var e=this;this._query.selects&&this._query.selects.length>0&&(a.isFetchAll(this.fetchDocument)||a.addColumns(this.fetchDocument,this._query.selects)),this._query.linkEntities&&this._query.linkEntities.length>0&&this._query.linkEntities.forEach((function(t){return a.addLinkedEntity(e.fetchDocument,t)})),this._query.wheres&&this._query.wheres.length>0&&this._query.wheres.forEach((function(t){return a.addFilters(e.fetchDocument,t)})),this._resetSort&&a.removeOrderElements(this.fetchDocument),this._query.sorts&&this._query.sorts.length>0&&this._query.sorts.forEach((function(t){var r=t.split(" ");a.addSort(e.fetchDocument,r[0],"desc"===r[1])})),this._childCountAttributes.length>0&&this._childCountAttributes.forEach((function(t){return a.addChildCountAttribute(e.fetchDocument,t)})),this._query.contextFiltersAndIds&&this._query.contextFiltersAndIds.length>0&&this._query.contextFiltersAndIds.forEach((function(t){var r=t.indexOf("="),n=t.substring(0,r),i=t.substring(r+1,t.length);a.addContextFilter(e.fetchDocument,i,n)})),this._query.isFetchXmlModified=!0},e.prototype.applyRollupContextFilter=function(){throw new Error("Not implemented")},e.prototype.where=function(e,t,r){var n=s.Expression.toLegacyFilterExpression(e,r).toFetchXml();return this._query&&(t?this._query.wheres=[n]:this._query.wheres&&this._query.wheres.push(n)),this},e.prototype.setDefaultPageSize=function(){throw new Error("Not implemented")},e.prototype.getFirstError=function(){throw new Error("Not implemented")},e.prototype.addExistingContextFilterToKey=function(){throw new Error("Not implemented")},e.prototype.validateLinkedEntity=function(){throw new Error("Not implemented")},Object.defineProperty(e.prototype,"fetchXml",{get:function(){throw new Error("Not implemented")},enumerable:!1,configurable:!0}),e}();function d(e,t,r,n){return null}t.ModernQueryBuilder=c,t.buildContextFilter=d},IUwF:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.DescriptorData=void 0;var n=function(e,t){this.Format=0,this.Format=e,this.Data=t};t.DescriptorData=n},IvJe:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.FieldValueRetrievalBehavior=t.getFormattedFieldValue=t.getRelatedEntityRecordByNavigationProperty=t.getRelatedEntityRecordsByNavigationProperty=t.isEmptyField=t.getRelatedEntityLogicalNames=t.getAttributeNamesWithNoMetadata=t.getListPageSize=t.getLegacyValueForField=t.getListTotalRecordsCount=t.getPagingCookie=t.getListInitializedState=t.getList=t.getListPageRecords=t.getFieldValue=t.getRecordInitState=t.getCurrentBusinessProcessFlowInstanceId=t.getCurrentBusinessProcessFlowId=t.createRecordSelector=t.getListPageRecordIds=t.getEntityRecordById=t.getEntityRecords=t.getData=void 0;var u,l=r("i2et"),s=a(r("rMjw")),c=r("XGkY"),d=r("mdZd"),f=r("FHhg"),p=r("pdzI"),y=r("UZ+8"),h=r("AYBo"),v=r("VmZv"),m=r("WSZO"),g=r("AHn5"),_=r("NV9l"),E=r("0hOr"),O=r("Mx+d");function b(e){return e?e.data:null}function N(e,t){var r=b(e);return r&&r.entities&&r.entities.hasOwnProperty(t)?r.entities[t]:null}function R(e,t,r){var n=N(e,t);return n?n[r]:null}function T(e,t,r){var n=R(e,t.etn,c.Guid.toString(t.id));if(n&&n.fields&&n.fields.hasOwnProperty(r)){var i=n.fields[r];if(i)return i.list}return null}function A(e){return function(t){var r=N(t,e.etn);if(r){var n=c.Guid.toString(e.id);if(r.hasOwnProperty(n))return r[n]}return null}}function S(e,t){var r=b(e);return r&&r.lists&&r.lists.hasOwnProperty(t)?r.lists[t]:null}function D(e,t,r,n){var i=S(e,t);if(i){if(n)return i.records;if(i.pages&&r&&r>0){var a=i.pages[r];if(a&&i.records)return i.records.slice(a.startIndex,a.startIndex+i.pageSize)}}return null}function C(e,t,r,n){var i,a,u,l={initialized:t.initialized,identifier:r,fields:{}};if(t&&l&&l.fields)if(n&&n.length)try{for(var s=o(n),c=s.next();!c.done;c=s.next()){var d=c.value;l.fields[d]=null===(u=t.fields)||void 0===u?void 0:u[d]}}catch(e){i={error:e}}finally{try{c&&!c.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}else l.fields=t.fields;return l}function P(e,t){return void 0===t&&(t=u.LatestEntered),t===u.LastValid?e.value:e.validationResult.userInput||e.value}function w(e,t,r,n){var i,a;switch(void 0===n&&(n=u.LatestEntered),r){case l.AttributeType.PartyList:var s=[],p=t;try{for(var y=o(p.list),m=y.next();!m.done;m=y.next()){var O=m.value,b={},N={},R={},T={};for(var A in O.fields){var S=O.fields[A],D=I(e,"activityparty",A,S);if(D){b[A]=D;var C=E.getAttributeDescriptor(e,"activityparty",A);if(C&&(N[A]=C.Type,_.isPlainValue(S))){var w=S;R[A]=w.formatted||null,T[A]=w.formatted||null}}}var M=new v.EntityRecord(f.EntityReference.toLegacyEntityReference(O.identifier),b,N,R,T,new g.RelatedEntityCollection([]));s.push(M)}}catch(e){i={error:e}}finally{try{m&&!m.done&&(a=y.return)&&a.call(y)}finally{if(i)throw i.error}}return new h.EntityCollection(s,!1,s.length,!1,null,null);case l.AttributeType.Date:case l.AttributeType.DateTime:var F=P(t,n),x=Date.parse(F);return isNaN(x)?F:new Date(x);case l.AttributeType.PickList:case l.AttributeType.Boolean:case l.AttributeType.State:case l.AttributeType.Status:var L=t,U=L?L.label:null,k=L?parseInt(L.valueString,10):null;return k&&isNaN(k)&&(k=null),new d.OptionMetadata(U,k,-1,-1,[],null,null);case l.AttributeType.Customer:case l.AttributeType.Lookup:case l.AttributeType.Owner:var V=t;return V&&V.reference?f.EntityReference.toLegacyEntityReference(V.reference):null;case l.AttributeType.UniqueIdentifier:var j=t;return c.Guid.toLegacyGuid(j.id);case l.AttributeType.MultiSelectPickList:var q=P(t,n);return-1===q||null===q?null:Array.isArray(q)?q:q.split(",").map((function(e){return parseInt(e,10)}));case l.AttributeType.Decimal:case l.AttributeType.Double:case l.AttributeType.Integer:case l.AttributeType.String:case l.AttributeType.BigInt:case l.AttributeType.Unknown:case l.AttributeType.Memo:case l.AttributeType.Money:case l.AttributeType.CalendarRules:case l.AttributeType.Virtual:default:return P(t,n)}}function I(e,t,r,n,i){if(void 0===i&&(i=u.LatestEntered),_.isAliasedValue(n)){var a=new m.LegacyAliasedValue(n.entityLogicalName,n.attributeLogicalName,l.AttributeType.AliasedValue);return n.innerType===l.AttributeType.Integer?a.set_value(w(e,n.innerValue,l.AttributeType.Integer,i)):a.set_value(I(e,n.entityLogicalName,n.attributeLogicalName,n.innerValue)),a}var o=E.getAttributeDescriptor(e,t,r);if(!o||!o.Type)return null;var s=o.Type;return n?w(e,n,s,i):s===l.AttributeType.PartyList?new h.EntityCollection([],!1,0,!1):null}t.getData=b,t.getEntityRecords=N,t.getEntityRecordById=R,t.getRelatedEntityRecordsByNavigationProperty=T,t.getRelatedEntityRecordByNavigationProperty=function(e,t,r,n){var i,a,u=T(e,t,r);if(u){var l=O.getRelationshipTypeByNavigationProperty(e,t.etn,r);if(l===s.RelationshipType.OneToManyRelationship)try{for(var c=o(u),d=c.next();!d.done;d=c.next()){var f=d.value;if(f&&f.fields){var p=f.fields.hasOwnProperty("regardingfieldname")?f.fields.regardingfieldname:null;if(n===_.getFormattedValueFromField(p))return f}}}catch(e){i={error:e}}finally{try{d&&!d.done&&(a=c.return)&&a.call(c)}finally{if(i)throw i.error}}else if(l===s.RelationshipType.ManyToOneRelationship)return u[0]}return null},t.createRecordSelector=A,t.getRecordInitState=function(e,t){var r;if(A(t)){var n=null===(r=A(t))||void 0===r?void 0:r(e,t.etn);return n&&n.hasOwnProperty("initialized")?n.initialized:null}return null},t.getFieldValue=function(e,t,r){var n;if(t&&A(t)){var i=null===(n=A(t))||void 0===n?void 0:n(e,t.etn);if(i&&i.fields){if(i.fields.hasOwnProperty(r))return i.fields[r];if("productidname"===r&&-1!==["opportunityproduct","quotedetail","salesorderdetail","invoicedetail"].indexOf(t.etn)){var a=i.fields.productid;if(a){var o=a.reference;if(o&&o.hasOwnProperty("name"))return o.name}}}}return null},t.getFormattedFieldValue=function(e,t,r){return{value:e,timestamp:t||new Date,validationResult:r||{isValueValid:!0,errorMessage:null,errorId:null,userInput:""}}},t.getCurrentBusinessProcessFlowId=function(e,t){var r;if(A(t)){var n=null===(r=A(t))||void 0===r?void 0:r(e,t.etn);if(n&&n.businessProcessFlowId)return n.businessProcessFlowId}return null},t.getCurrentBusinessProcessFlowInstanceId=function(e,t){var r;if(A(t)){var n=null===(r=A(t))||void 0===r?void 0:r(e,t.etn);if(n&&n.businessProcessFlowInstanceId)return n.businessProcessFlowInstanceId}return null},t.getList=S,t.getListInitializedState=function(e,t){var r=S(e,t);return r?r.initialized:p.InitState.Uninitialized},t.getListPageRecordIds=D,t.getListPageRecords=function(e,t,r,n,i){var a,u,l=D(e,t,r,i),s=[];if(!l)return null;try{for(var c=o(l),d=c.next();!d.done;d=c.next()){var f=d.value,p=A(f);if(p){var y=p(e,f.etn);if(y){var h=C(0,y,f,n);s.push(h)}}}}catch(e){a={error:e}}finally{try{d&&!d.done&&(u=c.return)&&u.call(c)}finally{if(a)throw a.error}}return s},t.getListTotalRecordsCount=function(e,t){var r=S(e,t);return r?r.totalRecordCount:null},t.getPagingCookie=function(e,t,r){var n=S(e,t);return n&&n.pages&&n.pages[r]&&n.pages[r].pagingCookie?n.pages[r].pagingCookie:null},function(e){e[e.LatestEntered=0]="LatestEntered",e[e.LastValid=1]="LastValid"}(u||(u={})),t.FieldValueRetrievalBehavior=u,t.isEmptyField=function e(t,r,n,i,a){if(void 0===a&&(a=u.LatestEntered),!t)return!0;if(_.isAliasedValue(t))return e(t.innerValue,r,n,i,a);var o=E.getAttributeDescriptor(r,n,i);if(!o||!o.Type)return function e(t){return _.isPicklistValue(t)?!t.valueString:_.isGuidValue(t)?c.Guid.isNullOrEmpty(t.id):_.isReferenceValue(t)?!t.reference:_.isPlainValue(t)?!t.value:_.isAliasedValue(t)?e(t.innerValue):!!_.isPartylistValue(t)&&!t.list}(t);var s=!1;switch(o.Type){case l.AttributeType.PartyList:var d=t;d&&d.list&&d.list.length>0&&(s=!0);break;case l.AttributeType.Boolean:var f=t;!f||"1"!==f.valueString&&"0"!==f.valueString||(s=!0);break;case l.AttributeType.PickList:case l.AttributeType.State:case l.AttributeType.Status:var p=t;p&&"-1"!==p.valueString&&!y.IsNullOrUndefinedOrEmptyString(p.valueString)&&(s=!0);break;case l.AttributeType.MultiSelectPickList:var h=P(t,a);-1===h||y.IsNullOrUndefinedOrEmptyString(h)||(s=!0);break;case l.AttributeType.Customer:case l.AttributeType.Lookup:case l.AttributeType.Owner:var v=t;v&&!y.IsNullOrUndefinedOrEmptyString(v.reference)&&(s=!0);break;case l.AttributeType.UniqueIdentifier:var m=t;m&&!y.IsNullOrUndefinedOrEmptyString(m.id)&&(s=!0);break;case l.AttributeType.Date:case l.AttributeType.DateTime:case l.AttributeType.Decimal:case l.AttributeType.Double:case l.AttributeType.Integer:case l.AttributeType.String:case l.AttributeType.BigInt:case l.AttributeType.Unknown:case l.AttributeType.Memo:case l.AttributeType.Money:case l.AttributeType.CalendarRules:case l.AttributeType.Virtual:default:var g=P(t,a);y.IsNullOrUndefinedOrEmptyString(g)||(s=!0)}return!s},t.getLegacyValueForField=I,t.getListPageSize=function(e,t){var r=S(e,t);return r&&r.pageSize?r.pageSize:null},t.getAttributeNamesWithNoMetadata=function(e,t){var r=t.get_identifier(),n=E.getAttributesForEntity(e,r.LogicalName);if(n){var i=Object.keys(n);return t.get_fieldNames().filter((function(e){return i&&-1===i.indexOf(e)}))}return t.get_fieldNames()},t.getRelatedEntityLogicalNames=function(e,t){var r,n,i,a,u=t.get_identifier(),s=t.get_fieldNames(),c=E.getAttributesForEntity(e,u.LogicalName),d=new Set;try{for(var f=o(s),p=f.next();!p.done;p=f.next()){var y=p.value,h=c[y];if(!h)throw new Error("The metadata for "+y+" attribute is missing in the state tree.");if(h.Type===l.AttributeType.PartyList){var v=t.getValue(y).get_entities();try{for(var m=(i=void 0,o(v)),g=m.next();!g.done;g=m.next()){var _=g.value;d.add(_.get_identifier().LogicalName)}}catch(e){i={error:e}}finally{try{g&&!g.done&&(a=m.return)&&a.call(m)}finally{if(i)throw i.error}}}if(h.Type===l.AttributeType.Lookup||h.Type===l.AttributeType.Customer||h.Type===l.AttributeType.Owner){var O=t.getValue(y);O&&O.LogicalName&&d.add(O.LogicalName)}}}catch(e){r={error:e}}finally{try{p&&!p.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}return Array.from(d)}},JH5K:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throwOnAssert=t.throwOnOutOfRange=t.throwOnNotEquals=t.throwOnNullOrEmptyArgument=t.throwOnUndefinedArgument=t.throwOnNullOrUndefinedArgument=t.throwOnNullArgument=void 0;var n=r("UZ+8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */t.throwOnNullArgument=function(e,t){if(null===e)throw Error(t+"Argument can't be null")},t.throwOnNullOrUndefinedArgument=function(e,t){if(n.IsNullOrUndefined(e))throw Error(t+"Argument can't be null or undefined")},t.throwOnUndefinedArgument=function(e,t){if(void 0===e)throw Error(t+"Argument can't be undefined")},t.throwOnNullOrEmptyArgument=function(e,t){if(!e||!e.length)throw Error(t+"Argument can't be null or empty")},t.throwOnNotEquals=function(e,t,r){if(e!==t)throw Error(r+"Argument is "+e+"but should be equal to "+t)},t.throwOnOutOfRange=function(e,t,r,n){if(e<t||e>r)throw Error(n)},t.throwOnAssert=function(e,t){if(!e)throw Error("ExceptionHelpers.ThrowOnAssert("+t+")")}},KIVe:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n;Object.defineProperty(t,"__esModule",{value:!0}),t.RelationshipRoleOrdinal=void 0,function(e){e[e.Referencing=1]="Referencing",e[e.AssociationEntity=2]="AssociationEntity"}(n||(n={})),t.RelationshipRoleOrdinal=n},"Kz3/":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.removeReference=t.addReference=void 0,t.addReference=function(e,t){if(e||(e=[]),-1===e.indexOf(t))return e.push(t),e},t.removeReference=function(e,t){if(e){var r=e.indexOf(t);return-1!==r?1===e.length?[]:(e.splice(r,1),e):void 0}}},LEFC:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.MetadataQuery=void 0;var o=a(r("bMRw")),u=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{MetadataType:{typeName:"Edm.String",structuralProperty:o.ODataStructuralProperty.PrimitiveType},MetadataSubtype:{typeName:"Edm.String",structuralProperty:o.ODataStructuralProperty.PrimitiveType},EntityLogicalName:{typeName:"Edm.String",structuralProperty:o.ODataStructuralProperty.PrimitiveType},MetadataId:{typeName:"Edm.Guid",structuralProperty:o.ODataStructuralProperty.PrimitiveType},MetadataName:{typeName:"Edm.String",structuralProperty:o.ODataStructuralProperty.PrimitiveType},MetadataNames:{typeName:"Edm.String",structuralProperty:o.ODataStructuralProperty.Collection},GetDefault:{typeName:"Edm.Boolean",structuralProperty:o.ODataStructuralProperty.PrimitiveType},DependencyDepth:{typeName:"Microsoft.Dynamics.CRM.DependencyDepth",structuralProperty:o.ODataStructuralProperty.EnumerationType,enumProperties:[,{name:"Unknown",value:0},{name:"OnDemandWithContext",value:1},{name:"OnDemandWithoutContext",value:2},{name:"OnDemandContextOnly",value:3},{name:"Offline",value:4},{name:"Mobile",value:5},{name:"UserContext",value:6}]},ChangedAfter:{typeName:"Edm.String",structuralProperty:o.ODataStructuralProperty.PrimitiveType},Exclude:{typeName:"Edm.Guid",structuralProperty:o.ODataStructuralProperty.Collection},AppId:{typeName:"Edm.Guid",structuralProperty:o.ODataStructuralProperty.PrimitiveType}}}},e}();t.MetadataQuery=u},MXGD:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.combineReducers=void 0,t.combineReducers=function(e){return function(e){return function(t,r){var i,a,o=void 0===t?{}:t,u={},l=!1,s=Object.keys(e);try{for(var c=n(s),d=c.next();!d.done;d=c.next()){var f=d.value,p=e[f],y=o[f],h=p(y,r);u[f]=h,l=l||h!==y}}catch(e){i={error:e}}finally{try{d&&!d.done&&(a=c.return)&&a.call(c)}finally{if(i)throw i.error}}var v=l?u:o;return Object.freeze(v)}}(function(e){var t,r,i={},a=Object.keys(e);try{for(var o=n(a),u=o.next();!u.done;u=o.next()){var l=u.value;i[l]=e[l]}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return i}(e))}},"Mx+d":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.getRelationShipByNavigationProperty=t.getRelationshipTypeByNavigationProperty=t.getEntityIconVectorName=t.getManyToManyRelationships=t.getPrimaryNameAttribute=t.getAttributeNamesFromEntityMetadata=t.getPrimaryIdAttribute=t.getRelationshipType=t.getManyToManyRelationship=t.getManyToOneRelationship=t.getManyToOneRelationshipByNavigationProperty=t.getManyToOneRelationshipByReferencedEntity=t.getOnetoManyRelationShipByNavigationProperty=t.getAllOneToManyRelationshipByReferencingEntity=t.getManyToOneRelationShipByNavigationProperty=t.getActivityPartyNavigationPropertyRelationship=t.getOneToManyRelationship=t.getHasStateCode=t.getManyToOneRelationships=t.getOneToManyRelationships=t.getDisplayName=t.getDisplayCollectionName=t.getIsIntersectFlag=t.getIsActivityFlag=t.getActivities=t.getEntitySetName=t.getEntitiesDescriptors=t.getEntityDescriptor=t.getEntityTypeCode=t.getEntityInitState=t.getEntityLogicalNameFromSetName=void 0;var u=r("pdzI"),l=a(r("rMjw")),s={systemuser:"systemusers",team:"teams"};function c(e,t){return e&&(null==e?void 0:e.metadata)&&(null==e?void 0:e.metadata.entities)?null==e?void 0:e.metadata.entities[t]:null}function d(e,t){var r=c(e,t);return!(!r||!r.hasOwnProperty("IsActivity"))&&r.IsActivity}function f(e){return e&&(null==e?void 0:e.metadata)?null==e?void 0:e.metadata.entities:null}function p(e,t){var r=c(e,t);return r&&r.OneToManyRelationships?r.OneToManyRelationships:null}function y(e,t){var r=c(e,t);return r?r.ManyToOneRelationships:null}function h(e,t,r){var n=p(e,t);return n&&n.hasOwnProperty(r)?n[r]:null}function v(e,t,r){var n=c(e,t);return n&&n.ManyToOneRelationships&&n.ManyToOneRelationships.hasOwnProperty(r)?n.ManyToOneRelationships[r]:null}function m(e,t,r,n){var i=c(e,t);if(i&&i.ManyToOneRelationships)for(var a in i.ManyToOneRelationships){var o=i.ManyToOneRelationships[a];if(o.ReferencedEntity===r&&o.ReferencingAttribute===n)return o}return null}function g(e,t,r){var n=c(e,t);return n&&n.ManyToManyRelationships&&n.ManyToManyRelationships.hasOwnProperty(r)?n.ManyToManyRelationships[r]:null}function _(e,t,r){var n,i,a=p(e,t);if(a)try{for(var u=o(Object.keys(a)),l=u.next();!l.done;l=u.next()){var s=a[l.value];if(s.ReferencedEntityNavigationPropertyName===r)return s}}catch(e){n={error:e}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}return null}function E(e,t,r){var n,i,a=y(e,t);if(a)try{for(var u=o(Object.keys(a)),l=u.next();!l.done;l=u.next()){var s=a[l.value];if(s.ReferencingEntityNavigationPropertyName===r)return s}}catch(e){n={error:e}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}return null}t.getEntityDescriptor=c,t.getEntityInitState=function(e,t){var r=c(e,t);return r?r.Initialized:u.InitState.Uninitialized},t.getEntityLogicalNameFromSetName=function(e,t){if(!e||!(null==e?void 0:e.metadata)||!(null==e?void 0:e.metadata.entities))return null;var r=null==e?void 0:e.metadata.entities;for(var n in r)if(r[n].EntitySetName===t)return r[n].EntityLogicalName;return null},t.getEntityTypeCode=function(e,t){var r;return null==c(e,t)?null:null===(r=c(e,t))||void 0===r?void 0:r.ObjectTypeCode},t.getEntitySetName=function(e,t){var r=c(e,t);if(r&&r.EntitySetName)return r.EntitySetName;var n=s[t];return n||null},t.getActivities=function(e){var t=f(e),r={};for(var n in t)d(e,n)&&(r[n]=t[n]);return r},t.getIsActivityFlag=d,t.getHasStateCode=function(e,t){var r=c(e,t);return!(!r||!r.hasOwnProperty("HasStateCode"))&&r.HasStateCode},t.getIsIntersectFlag=function(e,t){var r=c(e,t);return!(!r||!r.hasOwnProperty("IsIntersect"))&&r.IsIntersect},t.getEntitiesDescriptors=f,t.getDisplayCollectionName=function(e,t){var r=c(e,t);return r&&r.DisplayCollectionName?r.DisplayCollectionName:null},t.getDisplayName=function(e,t){var r=c(e,t);return r&&r.DisplayName?r.DisplayName:null},t.getOneToManyRelationships=p,t.getManyToOneRelationships=y,t.getOneToManyRelationship=h,t.getAllOneToManyRelationshipByReferencingEntity=function(e,t,r){var n=p(e,t);if(!n)return null;var i=[];for(var a in n){var o=n[a];o.ReferencedEntity===t&&o.ReferencingEntity===r&&i.push(o)}return i},t.getManyToOneRelationship=v,t.getManyToOneRelationshipByReferencedEntity=function(e,t,r,n){var i=m(e,t,r,n);if(!i){var a=c(e,t);a&&a.ManyToOneRelationships&&a.IsActivity&&(i=m(e,"activitypointer",r,n))}return i},t.getActivityPartyNavigationPropertyRelationship=function(e,t){var r=p(e,t);if(!r)return null;var n=[];for(var i in r){var a=r[i];if(a.ReferencedEntity===t&&"activityparty"===a.ReferencingEntity){if("campaignactivity"===t&&"campaignactivity_activity_parties"!==i||"bulkoperation"===t&&"bulkoperation_activity_parties"!==i)continue;n.push(a)}}return 1===n.length?n[0]:null},t.getManyToOneRelationshipByNavigationProperty=function(e,t,r){var n=c(e,t);if(n&&n.ManyToOneRelationships)for(var i in n.ManyToOneRelationships){var a=n.ManyToOneRelationships[i];if(a.ReferencingEntityNavigationPropertyName===r)return a}return null},t.getManyToManyRelationship=g,t.getRelationshipType=function(e,t,r){return h(e,t,r)?l.RelationshipType.OneToManyRelationship:g(e,t,r)?l.RelationshipType.ManyToManyRelationship:v(e,t,r)?l.RelationshipType.None:null},t.getOnetoManyRelationShipByNavigationProperty=_,t.getManyToOneRelationShipByNavigationProperty=E,t.getRelationShipByNavigationProperty=function(e,t,r){var n=E(e,t,r);return n||_(e,t,r)},t.getRelationshipTypeByNavigationProperty=function(e,t,r){return _(e,t,r)?l.RelationshipType.OneToManyRelationship:E(e,t,r)?l.RelationshipType.ManyToOneRelationship:l.RelationshipType.None},t.getPrimaryIdAttribute=function(e,t){return e&&(null==e?void 0:e.metadata)&&(null==e?void 0:e.metadata.entities)&&t&&(null==e?void 0:e.metadata.entities[t])?null==e?void 0:e.metadata.entities[t].PrimaryIdAttribute:null},t.getAttributeNamesFromEntityMetadata=function(e,t){var r=c(e,t);return r?new Set(r.AttributeNames):null},t.getPrimaryNameAttribute=function(e,t){var r=t?c(e,t):null;return r&&r.PrimaryNameAttribute?r.PrimaryNameAttribute:null},t.getManyToManyRelationships=function(e,t){var r=c(e,t);return r&&r.ManyToManyRelationships?r.ManyToManyRelationships:null},t.getEntityIconVectorName=function(e,t){var r=c(e,t);return r&&r.IconVectorName?r.IconVectorName:null}},"N/D8":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OptionMetadata=void 0;var n=function(){function e(e,t,r,n,i,a,o){this._val=0,this._state=0,this._defaultStatus=0,this._allowedStatusTransitions=null,this._color=null,this._invariantName=null,this._label=e,this._val=t,this._state=r,this._defaultStatus=n,this._allowedStatusTransitions=i,this._color=a,this._invariantName=o}return e.prototype.get_Label=function(){return this._label},e.prototype.set_Label=function(e){return this._label=e,e},e.prototype.get_ValueString=function(){return this._val.toString()},e.prototype.get_allowedStatusTransitions=function(){return this._allowedStatusTransitions},e.prototype.get_color=function(){return this._color},e.prototype.get_value=function(){return this._val},e.prototype.get_state=function(){return this._state},e.prototype.get_defaultStatus=function(){return this._defaultStatus},e.prototype.get_invariantName=function(){return this._invariantName},e.prototype.getObjectData=function(){return{label:this._label,value:this._val,state:this._state,defaultstatus:this._defaultStatus,allowedstatustransitions:this._allowedStatusTransitions,color:this._color,invariantname:this._invariantName}},e.prototype.getODataObject=function(){return{Value:this._val,Color:this._color,Label:this._label,DefaultStatus:this._defaultStatus,State:this._state,TransitionData:this._allowedStatusTransitions,InvariantName:this._invariantName}},e.createFromPicklistItem=function(t){if(t instanceof e)return t;return new e(t.get_Label(),+t,-1,-1,null,null,null)},e.createFromObjectData=function(t){return new e(t.label,t.value,"state"in t?t.state:-1,"defaultstatus"in t?t.defaultstatus:-1,"allowedstatustransitions"in t?t.allowedstatustransitions:null,"color"in t?t.color:null,t.invariantname)},e.createFromOData=function(t){return new e(t.Label,t.Value,"State"in t?t.State:-1,"DefaultStatus"in t?t.DefaultStatus:-1,"TransitionData"in t?t.TransitionData:null,"Color"in t?t.Color:null,t.Description)},e}();t.OptionMetadata=n,n.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.OptionMetadata"},NV9l:function(e,t,r){"use strict";var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.getEntityReferenceFromField=t.getEntityReferenceIdFromField=t.getRawValueFromField=t.getPickListValueFromField=t.getFormattedValueFromField=t.isPartylistValue=t.isAliasedValue=t.isPlainValue=t.isReferenceValue=t.isGuidValue=t.isPicklistValue=void 0;var i=r("XGkY");function a(e){return!!e&&e.hasOwnProperty("label")}function o(e){return!!e&&e.hasOwnProperty("id")}function u(e){return!!e&&e.hasOwnProperty("reference")}function l(e){return!!e&&e.hasOwnProperty("value")}function s(e){return!!e&&e.hasOwnProperty("innerValue")}function c(e){return!!e&&e.hasOwnProperty("list")}function d(e){return e?e.toString():null}function f(e){return e&&a(e)?e.valueString:null}t.getFormattedValueFromField=function e(t){var r,f;if(t){if(l(t)){if(t.validationResult&&!t.validationResult.isValueValid){var p=t.validationResult.userInput;return p&&(null==p?void 0:p.toString())}return t.formatted||t.value&&t.value.toString()}if(a(t))return t.label;if(o(t))return i.Guid.toString(t.id);if(u(t))return t.reference&&t.reference.name||null;if(s(t))return e(t.innerValue);if(c(t)){var y="";try{for(var h=n(t.list),v=h.next();!v.done;v=h.next()){var m=v.value,g=void 0;m.fields&&(g=m.fields.partyid?m.fields.partyid:m.fields.addressused?m.fields.addressused:null)&&(y=""!==y?y+", "+e(g):e(g))}}catch(e){r={error:e}}finally{try{v&&!v.done&&(f=h.return)&&f.call(h)}finally{if(r)throw r.error}}return y}return d(t)}return null},t.getRawValueFromField=function e(t){return t?l(t)?t.value:a(t)?f(t):o(t)?t.id:u(t)?t.reference:s(t)?e(t.innerValue):c(t)?t.list:d(t):null},t.isPicklistValue=a,t.isGuidValue=o,t.isReferenceValue=u,t.isPlainValue=l,t.isAliasedValue=s,t.isPartylistValue=c,t.getPickListValueFromField=f,t.getEntityReferenceIdFromField=function(e){return e&&u(e)&&e.reference&&e.reference.id||null},t.getEntityReferenceFromField=function(e){return u(e)&&e.reference||null}},NgZN:function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),a=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(a(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.DOMParserNodeWrapper=void 0;var u=r("lqZx"),l=r("1LmJ"),s=r("xvCR"),c=r("UZ+8"),d=function(e){function t(t,r){var n=e.call(this)||this;return l.assert(!c.IsNullOrUndefined(t),"The element should not be null"),n._element=t,n._namespaces=c.IsNullOrUndefined(r)?{}:r,n}return i(t,e),t.prototype.get_innerText=function(){return this._element.hasChildNodes()?this._element.firstChild.nodeValue:null},t.prototype.get_outerXml=function(){return(new XMLSerializer).serializeToString(this._element)},t.prototype.get_tagName=function(){return this._element.nodeName},t.prototype.get_domParserElement=function(){return this._element},t.prototype.getAttribute=function(e){return this._element.getAttribute(e)},t.prototype.addNamespace=function(e,t){this._namespaces[e]=t},t.prototype.selectSingleNode=function(e){var t=this._SelectDOMParserElements(e,!0);if(t.get_count())return t.get_item(0)},t.prototype.selectNodes=function(e){return this._SelectDOMParserElements(e,!1)},t.prototype.getElementsByTagName=function(e){var r,n=this;r=c.IsNullOrUndefined(this._element.ownerDocument)?this._element.getElementsByTagName(e):this._element.ownerDocument.getElementsByTagName(e);for(var i=[],a=0;a<r.length;a++)i.push(r[a]);var u=this._GetElementsByTagNameWithDefaultNamespace(e);i.push.apply(i,o(u));var l=i.map((function(e){return new t(e,n._namespaces)}));return new s.DOMParserNodeListWrapper(l)},t.prototype.childNodes=function(){for(var e=[],r=0,n=this._element.childNodes.length;r<n;r++)e.push(new t(this._element.childNodes[r],this._namespaces));return new s.DOMParserNodeListWrapper(e)},t.prototype.hasChildNodes=function(){return this._element.hasChildNodes()},t.prototype._SelectDOMParserElements=function(e,r){var n=this,i=[];if(e.startsWith("// ")||e.startsWith(".// ")){var a=2,u=!1;e.startsWith(".")&&(a++,u=!0);var l=(e=e.substr(a)).indexOf("/"),d=void 0,f=void 0;l<0?(d=e,f=null):(d=e.substr(0,l),f=e.substr(l+1));var p=void 0,y=void 0;(l=d.indexOf("["))<0?(p=d,y=null):(p=d.substr(0,l),l=(y=d.substr(l+1)).indexOf("]"),y=y.substr(0,l));var h=void 0;h=u||c.IsNullOrUndefined(this._element.ownerDocument)?this._element.getElementsByTagName(p):this._element.ownerDocument.getElementsByTagName(p);for(var v=[],m=0;m<h.length;m++)v.push(h[m]);var g=this._GetElementsByTagNameWithDefaultNamespace(p);v.push.apply(v,o(g));var _=v;v.length>0&&null!==y&&(_=this._FilterDOMParserElementList(v,y)),i=_.length&&null!==f?this._SearchDOMParserElementList(_,f,r):_}else e.startsWith("/")?(c.IsNullOrUndefined(this._element.ownerDocument)?i.push(this._element):i.push(this._element.ownerDocument),i=this._SearchDOMParserElementList(i,e.substr(1),r)):(i.push(this._element),i=this._SearchDOMParserElementList(i,e,r));var E=i.map((function(e){return new t(e,n._namespaces)}));return new s.DOMParserNodeListWrapper(E)},t.prototype._SearchDOMParserElementList=function(e,t,r){return r?this._SearchSingleNodeDOMParserElementList(e,t):this._SearchNodesDOMParserElementList(e,t)},t.prototype._SearchSingleNodeDOMParserElementList=function(e,t){if(c.IsNullOrUndefined(t)||t.length<1)return e;for(var r=[],n=0;n<e.length;n++){var i=this._SearchSingleNodeDOMParserElement(e[n],t);if(i){r.push(i);break}}return r},t.prototype._SearchSingleNodeDOMParserElement=function(e,t){if(c.IsNullOrUndefined(t)||t.length<1)return e;var r,n,i,a,o=t.indexOf("/");o<0?(r=t,n=null):(r=t.substr(0,o),n=t.substr(o+1)),(o=r.indexOf("["))<0?(i=r,a=null):(i=r.substr(0,o),o=(a=r.substr(o+1)).indexOf("]"),a=a.substr(0,o));for(var u=null,l=0,s=e.childNodes.length;l<s;l++)if(this._IsNodeNameEqual(e.childNodes[l],i)){var d=[e.childNodes[l]],f=d;if(null!==a&&(f=this._FilterDOMParserElementList(d,a)),f.length>0){if(null===n){u=f[0];break}if(u=this._SearchSingleNodeDOMParserElement(f[0],n))break}}return u},t.prototype._SearchNodesDOMParserElementList=function(e,t){if(c.IsNullOrUndefined(t)||t.length<1)return e;var r,n,i=t.indexOf("/");i<0?(r=t,n=null):(r=t.substr(0,i),n=t.substr(i+1));for(var a,u=[],l=0;l<e.length;l++)(a=this._SearchDOMParserElement(e[l],r)).length>0&&u.push.apply(u,o(a));return u.length&&null!==n?this._SearchNodesDOMParserElementList(u,n):u},t.prototype._SearchDOMParserElement=function(e,t){var r,n,i=t.indexOf("[");i<0?(r=t,n=null):(r=t.substr(0,i),i=(n=t.substr(i+1)).indexOf("]"),n=n.substr(0,i));for(var a=[],o=0,u=e.childNodes.length;o<u;o++)this._IsNodeNameEqual(e.childNodes[o],r)&&a.push(e.childNodes[o]);var l=a;return a.length>0&&null!==n&&(l=this._FilterDOMParserElementList(a,n)),l},t.prototype._FilterDOMParserElementList=function(e,t){var r=t.startsWith("@");r&&(t=t.substr(1));var n,i,a=t.indexOf("=");a<0?(n=t,i=null):(n=t.substr(0,a),i=(i=(i=t.substr(a+1)).substr(1)).substr(0,i.length-1));for(var o=[],u=0;u<e.length;u++){var l=e[u];(r&&this._FilterDOMParserElementAttribute(l,n,i)||this._FilterDOMParserElementChildElement(l,n,i))&&o.push(l)}return o},t.prototype._FilterDOMParserElementAttribute=function(e,t,r){return null===r?e.hasAttribute(t):r===e.getAttribute(t)},t.prototype._FilterDOMParserElementChildElement=function(e,t,r){for(var n,i,a,o=0,u=null===(n=null==e?void 0:e.childNodes)||void 0===n?void 0:n.length;o<u;o++)if(this._IsNodeNameEqual(e.childNodes[o],t)){if(null===r)return!0;if((null===(a=null===(i=e.childNodes[o])||void 0===i?void 0:i.firstChild)||void 0===a?void 0:a.nodeValue)===r)return!0}return!1},t.prototype._GetElementsByTagNameWithDefaultNamespace=function(e){var t=[],r=this._GetNamespaceForFullName(e);if(c.IsNullOrUndefined(r)||r.length<1)return t;var n,i=this._GetLocalNameForFullName(e);n=c.IsNullOrUndefined(this._element.ownerDocument)?this._element.getElementsByTagName(i):this._element.ownerDocument.getElementsByTagName(i);for(var a=0;a<n.length;a++)n[a].namespaceURI===r&&t.push(n[a]);return t},t.prototype._GetNamespaceForFullName=function(e){var t=e.indexOf(":");if(t<0)return"";var r=e.substr(0,t);return this._namespaces[r]},t.prototype._GetLocalNameForFullName=function(e){var t=e.indexOf(":");return t<0?e:e.substr(t+1)},t.prototype._IsNodeNameEqual=function(e,t){if(e.nodeName===t||"*"===t)return!0;var r=this._GetNamespaceForFullName(t);if(c.IsNullOrUndefined(r)||r.length<1)return!1;var n=this._GetLocalNameForFullName(t);return e.namespaceURI===r&&e.localName===n},t}(u.XmlNode);t.DOMParserNodeWrapper=d},OMC6:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveEntityMetadata=t.RETRIEVE_ENTITY_METADATA=void 0;t.RETRIEVE_ENTITY_METADATA="entityMetadata.retrieve",t.retrieveEntityMetadata=function(e){return{type:"entityMetadata.retrieve",payload:e}}},"PVp+":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClientRetrieveOptions=void 0;var n=r("ink8"),i=r("ugCW"),a=r("UZ+8"),o=function(){function e(e,t,r){this._cachePriority=0,this._retrievalStrategy=0,this._cachePriority=e,this._retrievalStrategy=t,this._timestamp=r||new Date}return e.prototype.get_timestamp=function(){return this._timestamp},e.prototype.get_cachePriority=function(){return this._cachePriority},e.prototype.set_cachePriority=function(e){return this._cachePriority=e,e},e.prototype.get_retrievalStrategy=function(){return this._retrievalStrategy},e.prototype.set_retrievalStrategy=function(e){return this._retrievalStrategy=e,e},e.prototype.get_sortableTimestamp=function(){return e.getSortableString(this._timestamp)},e.prototype.getObjectData=function(){var t={};return t[e.timestampPath]=this.get_sortableTimestamp(),t.priority_timestamp=e.priorityTimestampKey(this._cachePriority,this._timestamp),t},e.prototype.update=function(e){a.IsNullOrUndefined(e)||(this._timestamp=e._timestamp,e._cachePriority<this._cachePriority&&(this._cachePriority=e._cachePriority))},e.shouldBeCached=function(e){return!a.IsNullOrUndefined(e)&&e.get_cachePriority()!==n.CachePriority.NotCached},e.getSortableString=function(e){return e.toDateString()},e.priorityTimestampKey=function(t,r){return t+"|"+e.getSortableString(r)},e.createFromObjectData=function(t){var r=new Date(t[e.timestampPath]);return new e(+t.priority_timestamp.substr(0,1),i.RetrievalStrategy.LocalAndRemote,r)},e.timestampPath="timestamp",e.embeddedPriorityTimestampPath="clientretrieveoptions.priority_timestamp",e}();t.ClientRetrieveOptions=o},Q6jc:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DependencyType=t.EncodeRule=t.RollupType=t.TargetFieldType=t.OrderType=t.LogicalOperator=t.JoinOperator=t.DependencyDepth=t.ConditionOperator=void 0,function(e){e[e.Equal=0]="Equal",e[e.NotEqual=1]="NotEqual",e[e.GreaterThan=2]="GreaterThan",e[e.LessThan=3]="LessThan",e[e.GreaterEqual=4]="GreaterEqual",e[e.LessEqual=5]="LessEqual",e[e.Like=6]="Like",e[e.NotLike=7]="NotLike",e[e.In=8]="In",e[e.NotIn=9]="NotIn",e[e.Between=10]="Between",e[e.NotBetween=11]="NotBetween",e[e.Null=12]="Null",e[e.NotNull=13]="NotNull",e[e.Yesterday=14]="Yesterday",e[e.Today=15]="Today",e[e.Tomorrow=16]="Tomorrow",e[e.Last7Days=17]="Last7Days",e[e.Next7Days=18]="Next7Days",e[e.LastWeek=19]="LastWeek",e[e.ThisWeek=20]="ThisWeek",e[e.NextWeek=21]="NextWeek",e[e.LastMonth=22]="LastMonth",e[e.ThisMonth=23]="ThisMonth",e[e.NextMonth=24]="NextMonth",e[e.On=25]="On",e[e.OnOrBefore=26]="OnOrBefore",e[e.OnOrAfter=27]="OnOrAfter",e[e.LastYear=28]="LastYear",e[e.ThisYear=29]="ThisYear",e[e.NextYear=30]="NextYear",e[e.LastXHours=31]="LastXHours",e[e.NextXHours=32]="NextXHours",e[e.LastXDays=33]="LastXDays",e[e.NextXDays=34]="NextXDays",e[e.LastXWeeks=35]="LastXWeeks",e[e.NextXWeeks=36]="NextXWeeks",e[e.LastXMonths=37]="LastXMonths",e[e.NextXMonths=38]="NextXMonths",e[e.LastXYears=39]="LastXYears",e[e.NextXYears=40]="NextXYears",e[e.EqualUserId=41]="EqualUserId",e[e.NotEqualUserId=42]="NotEqualUserId",e[e.EqualBusinessId=43]="EqualBusinessId",e[e.NotEqualBusinessId=44]="NotEqualBusinessId",e[e.ChildOf=45]="ChildOf",e[e.Mask=46]="Mask",e[e.NotMask=47]="NotMask",e[e.MasksSelect=48]="MasksSelect",e[e.Contains=49]="Contains",e[e.DoesNotContain=50]="DoesNotContain",e[e.EqualUserLanguage=51]="EqualUserLanguage",e[e.NotOn=52]="NotOn",e[e.OlderThanXMonths=53]="OlderThanXMonths",e[e.BeginsWith=54]="BeginsWith",e[e.DoesNotBeginWith=55]="DoesNotBeginWith",e[e.EndsWith=56]="EndsWith",e[e.DoesNotEndWith=57]="DoesNotEndWith",e[e.ThisFiscalYear=58]="ThisFiscalYear",e[e.ThisFiscalPeriod=59]="ThisFiscalPeriod",e[e.NextFiscalYear=60]="NextFiscalYear",e[e.NextFiscalPeriod=61]="NextFiscalPeriod",e[e.LastFiscalYear=62]="LastFiscalYear",e[e.LastFiscalPeriod=63]="LastFiscalPeriod",e[e.LastXFiscalYears=64]="LastXFiscalYears",e[e.LastXFiscalPeriods=65]="LastXFiscalPeriods",e[e.NextXFiscalYears=66]="NextXFiscalYears",e[e.NextXFiscalPeriods=67]="NextXFiscalPeriods",e[e.InFiscalYear=68]="InFiscalYear",e[e.InFiscalPeriod=69]="InFiscalPeriod",e[e.InFiscalPeriodAndYear=70]="InFiscalPeriodAndYear",e[e.InOrBeforeFiscalPeriodAndYear=71]="InOrBeforeFiscalPeriodAndYear",e[e.InOrAfterFiscalPeriodAndYear=72]="InOrAfterFiscalPeriodAndYear",e[e.EqualUserTeams=73]="EqualUserTeams",e[e.EqualUserOrUserTeams=74]="EqualUserOrUserTeams",e[e.Under=75]="Under",e[e.NotUnder=76]="NotUnder",e[e.UnderOrEqual=77]="UnderOrEqual",e[e.Above=78]="Above",e[e.AboveOrEqual=79]="AboveOrEqual",e[e.EqualUserOrUserHierarchy=80]="EqualUserOrUserHierarchy",e[e.EqualUserOrUserHierarchyAndTeams=81]="EqualUserOrUserHierarchyAndTeams",e[e.OlderThanXYears=82]="OlderThanXYears",e[e.OlderThanXWeeks=83]="OlderThanXWeeks",e[e.OlderThanXDays=84]="OlderThanXDays",e[e.OlderThanXHours=85]="OlderThanXHours",e[e.OlderThanXMinutes=86]="OlderThanXMinutes"}(t.ConditionOperator||(t.ConditionOperator={})),function(e){e[e.Unknown=0]="Unknown",e[e.OnDemandWithContext=1]="OnDemandWithContext",e[e.OnDemandWithoutContext=2]="OnDemandWithoutContext",e[e.OnDemandContextOnly=3]="OnDemandContextOnly",e[e.Offline=4]="Offline",e[e.Mobile=5]="Mobile",e[e.UserContext=6]="UserContext"}(t.DependencyDepth||(t.DependencyDepth={})),function(e){e[e.Inner=0]="Inner",e[e.LeftOuter=1]="LeftOuter",e[e.Natural=2]="Natural",e[e.MatchFirstRowUsingCrossApply=3]="MatchFirstRowUsingCrossApply",e[e.In=4]="In",e[e.Exists=5]="Exists"}(t.JoinOperator||(t.JoinOperator={})),function(e){e[e.And=0]="And",e[e.Or=1]="Or",e[e.Not=2]="Not"}(t.LogicalOperator||(t.LogicalOperator={})),function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending"}(t.OrderType||(t.OrderType={})),function(e){e[e.All=0]="All",e[e.ValidForCreate=1]="ValidForCreate",e[e.ValidForUpdate=2]="ValidForUpdate",e[e.ValidForRead=3]="ValidForRead"}(t.TargetFieldType||(t.TargetFieldType={})),function(e){e[e.None=0]="None",e[e.Related=1]="Related",e[e.Extended=2]="Extended"}(t.RollupType||(t.RollupType={})),function(e){e[e.None=0]="None",e[e.SingleQuotesURL=1]="SingleQuotesURL",e[e.DoubleQuotesURL=2]="DoubleQuotesURL",e[e.NoQuotesURL=3]="NoQuotesURL",e[e.Contract=4]="Contract",e[e.JsonifyURL=5]="JsonifyURL"}(t.EncodeRule||(t.EncodeRule={})),function(e){e[e.NewData=1]="NewData",e[e.ExistingData=2]="ExistingData"}(t.DependencyType||(t.DependencyType={}))},RHls:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.convertErrorAndRethrow=t.convertToErrorStatus=t.ErrorStatus=void 0;var i=r("SXiu"),a=function(){function e(t,r,n,a,o,u,l,s,c,d,f,p,y,h,v,m,g,_){void 0===p&&(p=!1),void 0===y&&(y=-1),void 0===h&&(h=null);var E=r||e.DEFAULT_ERROR_CODE,O=d,b=i.createUciError(t,E,s,c,O,f,p);return b.message||(b.message=E.toString()),b.errorParameters||(b.errorParameters=[]),l&&b.errorParameters.push({name:"ErrorDetails",value:l}),u&&b.errorParameters.push({name:"ErrorFault",value:u}),o&&b.errorParameters.push({name:"ErrorSource",value:o}),n&&b.errorParameters.push({name:"Exception",value:n.message}),f&&b.errorParameters.push({name:"ErrorStack",value:f}),b._errorSource=o,b._exception=n,b._innerError=a,b._errorFault=u,b._details=l,b.blockErrorReporting=p,b.faultedRequestIndex=y,b.faultedSnapshotId=h,b.httpStatusCode=v,b.clientRequestId=m,b.serverResponseId=g,b.retryAfter=_,e._addErrorStatusProps(b),b}return e.fromErrorCode=function(t,r){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var a=e._getErrorMessage(t,r,n),o=new e(a,r);return o},e.fromExistingError=function(t){var r=t;return r.name||(r.name=i.UCI_ERROR_NAME),void 0===r.errorCode&&(r.errorCode=e.DEFAULT_ERROR_CODE),void 0===r.blockErrorReporting&&(r.blockErrorReporting=!1),void 0===r.faultedRequestIndex&&(r.faultedRequestIndex=-1),e._addErrorStatusProps(r),r},e._addErrorStatusProps=function(t){var r,i,a=Object.getOwnPropertyNames(e.prototype);try{for(var o=n(a),u=o.next();!u.done;u=o.next()){var l=u.value,s=Object.getOwnPropertyDescriptor(e.prototype,l);Object.defineProperty(t,l,s)}}catch(e){r={error:e}}finally{try{u&&!u.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}},e.createEmpty=function(){return new e("ErrorStatus created with no information",this.DEFAULT_ERROR_CODE)},e._getErrorMessageResourceId=function(e){var t=e;return t<0&&(t=t+4294967295+1),"Error_Message_0x"+t.toString(16)},e._getErrorMessage=function(t,r){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return e._getErrorMessageResourceId(r)},Object.defineProperty(e.prototype,"errorFault",{get:function(){return this._errorFault},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"details",{get:function(){return this._details},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exception",{get:function(){return this._exception},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"innerError",{get:function(){return this._innerError},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"errorSource",{get:function(){return this._errorSource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localizedMessage",{get:function(){if(this.message){var e=/, Error details: (.*)$/gi.exec(this.message);if(e&&e.length>1){var t=e[1];return"'"===t[0]&&"'"===t[t.length-1]?t.substring(1,t.length-1):t}}return null},enumerable:!1,configurable:!0}),e.prototype.containsErrorCode=function(e){return this.getNegativeErrorCode()===e||!!this._innerError&&this._innerError.containsErrorCode(e)},e.prototype.getNegativeErrorCode=function(){return function(e){var t=e;e>0&&(t=~~e);return t}(this.errorCode)},e.DEFAULT_ERROR_MESSAGE_ID="Error_Message_Generic_Mobile_Client",e.DEFAULT_ERROR_CODE=0,e}();function o(e){return e?e instanceof Error?a.fromExistingError(e):e:a.createEmpty()}t.ErrorStatus=a,t.convertErrorAndRethrow=function(e){throw o(e)},t.convertToErrorStatus=o},RslU:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function u(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,u)}l((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveEntityMetadataErrorEnd=t.retrieveEntities=t.retrieveEntity=t.getUpdatedEntityRefCount=t.RETRIEVE_ENTITY_ACTION=t.ENTITY_TYPE=t.RETRIEVE_ENTITY_ASYNC=void 0;var o=r("pdzI"),u=r("f6dx"),l=r("0hOr"),s=r("Mx+d"),c=r("RHls"),d=r("wEu3"),f=r("Kz3/"),p=r("c7Ce"),y=r("OMC6");t.RETRIEVE_ENTITY_ASYNC="entity.retrieve.async";var h=["activityparty"];function v(e,t,r){return n(this,void 0,void 0,(function(){var n,a,o;return i(this,(function(i){switch(i.label){case 0:if(!(n=t.DataLayerConfiguration.MetadataProvider))return[3,5];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,n.retrieveEntities(r)];case 2:return a=i.sent(),e((l=a,{type:u.GET_CLIENT_METADATA,payload:l})),[2,a];case 3:throw o=i.sent(),e(O(Object.keys(r))),o;case 4:return[3,6];case 5:throw new c.ErrorStatus("No metadata provider, GCM scenario is not yet supported");case 6:return[2]}var l}))}))}function m(e,t,r,n,i){var a,u,c={},f={};for(var p in r){var y=void 0,h=r[p],v=s.getEntityDescriptor(e,p);if(g(p)){var m=_(e,p,n,i,null===(a=n.DataLayerConfiguration.GarbageCollectionProvider)||void 0===a?void 0:a.getCurrentPage());m&&(f[p]=m)}v&&v.Initialized!==o.InitState.Uninitialized&&v.Initialized!==o.InitState.Partial?(y=l.getMissingAttributes(e,p,null!==(u=null!=h?h:v.AttributeNames)&&void 0!==u?u:[])).length>0&&(c[p]=y&&y.sort().filter((function(e,t,r){return r.indexOf(e)===t}))):c[p]=h&&h.sort().filter((function(e,t,r){return r.indexOf(e)===t}))}return Object.keys(f).length>0&&t(d.updateGCMetadataRefCount(f)),c}function g(e){return-1===h.indexOf(e)}function _(e,t,r,n,i){var a,o;if(!e)return null;if(!i&&(i=null===(a=r.DataLayerConfiguration.GarbageCollectionProvider)||void 0===a?void 0:a.getCurrentPage(),n)){var u=r.TraceManager.getTracer("RetrieveEntity"),l="getUpdatedEntityRefCount() called without pageId, action stack is : "+n.stack;u.info(l);var s=[];s.push({name:"errorString",value:l}),r.EventManager.ReportComponentSuccess("RetrieveEntity",s)}if(i&&""!==i){var c=p.getGCEntityMetadataRefCount(e,t),d=null==c?void 0:c.slice();return null!==(o=f.addReference(d,i))&&void 0!==o?o:null}return null}function E(e,t){var r,n,i={entities:{},attributes:{}};try{for(var o=a(t),u=o.next();!u.done;u=o.next()){var c=u.value;i.entities&&(i.entities[c]=s.getEntityDescriptor(e,c)),i.attributes&&(i.attributes[c]=l.getAttributesForEntity(e,c))}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i}function O(e){var t={};e.forEach((function(e){t[e]={Initialized:o.InitState.Error}}));var r={entities:t};return y.retrieveEntityMetadata(r)}t.ENTITY_TYPE="entity",t.RETRIEVE_ENTITY_ACTION="entity.retrieve",t.getUpdatedEntityRefCount=_,t.retrieveEntity=function(e,r,a){return{type:t.RETRIEVE_ENTITY_ASYNC,execute:function(t,o,u){var l=t.dispatch,s=t.getState;return n(this,void 0,void 0,(function(){var t,n,c;return i(this,(function(i){return(c={})[e]=r?null:null!=a?a:[],t=c,n=m(s(),l,t,o,u),0===Object.keys(n).length?[2,E(s(),[e])]:[2,v(l,o,n)]}))}))}}},t.retrieveEntities=function(e){return{type:t.RETRIEVE_ENTITY_ASYNC,execute:function(t,r,a){var o=t.dispatch,u=t.getState;return n(this,void 0,void 0,(function(){var t;return i(this,(function(n){try{return e&&0!==Object.keys(e).length?(t=m(u(),o,e,r,a),0===Object.keys(t).length?[2,E(u(),Object.keys(e))]:[2,v(o,r,t)]):[2,Promise.resolve({})]}catch(e){c.convertErrorAndRethrow(e)}return[2]}))}))}}},t.retrieveEntityMetadataErrorEnd=O},SJSp:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addFilters=t.ParseXml=t.getAttributesMapFromFetch=t.getColumnSetFromFetch=t.setFetchXmlParameters=t.addContextFilter=t.createManyToManyContextFilter=t.createOneToManyContextFilter=t.removeOrderElements=t.createOrderElement=t.findLinkEntitySort=t.addSort=t.addChildCountAttribute=t.buildLinkedEntityNode=t.addLinkedEntity=t.addColumns=t.isFetchAll=t.getEntityFromFetch=t.getColumnNamesFromFetch=t.getNodeAttributeValueByName=t.parseFetchXmlFromString=t.compress=void 0;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n=r("UZ+8"),i=r("iWcK"),a=r("iDsU"),o=r("mVtf"),u=r("EY1R");function l(e){return(new DOMParser).parseFromString(e,"text/xml")}function s(e,t){if(!n.IsNullOrUndefined(e)&&!n.IsNullOrUndefined(e.attributes)){var r=e.attributes.getNamedItem(t);if(!n.IsNullOrUndefined(r))return null==r?void 0:r.nodeValue}return null}function c(e,t,r){var n=e.createAttribute(t);return n.value=r,n}function d(e,t,r){return s(e,r)===s(t,r)}function f(e){var t,r,i;if(n.IsNullOrUndefined(e)||null==e)return null;if(p(e))return null;for(var a=[],o=e.getElementsByTagName("attribute"),u=0;u<o.length;u++){var l=o[u],s=null===(t=l.attributes.getNamedItem("name"))||void 0===t?void 0:t.nodeValue;if("link-entity"!==(null===(r=l.parentNode)||void 0===r?void 0:r.nodeName)||n.IsNullOrUndefined(l.parentNode.attributes.getNamedItem("alias")))a[u]=s;else{var c=null===(i=l.parentNode.attributes.getNamedItem("alias"))||void 0===i?void 0:i.nodeValue;a[u]=c+"."+s}}return a}function p(e){return!!e&&e.getElementsByTagName("all-attributes").length>0}function y(e,t,r){for(var n,i,a=e.getElementsByTagName("link-entity"),o=0;o<a.length;o++){var u=a[o];if(u.attributes.getNamedItem("alias")&&(null===(n=u.attributes.getNamedItem("alias"))||void 0===n?void 0:n.nodeValue)===t)for(var l=u.childNodes,s=0;s<l.length;s++){var c=l[s];if("attribute"===c.nodeName&&(null===(i=c.attributes.getNamedItem("name"))||void 0===i?void 0:i.nodeValue)===r)return u}}return null}function h(e,t,r){var n=e.createElement("order");return n.attributes.setNamedItem(c(e,"attribute",t)),n.attributes.setNamedItem(c(e,"descending",r.toString())),n}function v(e,t,r,n){return'<link-entity name="'+e+'" from="'+t+'" to="'+r+'" alias="bb">\n\t<filter type="and">\n\t\t<condition attribute="'+(n||t)+'" operator="eq" uitype="'+e+'" />\n\t</filter>\n\t</link-entity>'}t.compress=function(e){return e.replace(/[\r\n\t]/g,"").replace(/ \/>/g,"/>")},t.parseFetchXmlFromString=l,t.getNodeAttributeValueByName=s,t.getAttributesMapFromFetch=function(e){var t,r,i=o.parseXmlDocument(e);if(!i)return{};for(var a=i.getElementsByTagName("entity")[0].getAttribute("name"),l=((t={})[a]=[],t),s=i.getElementsByTagName("attribute"),c=0;c<s.length;c++){var d=s[c],f=null===(r=d.attributes.getNamedItem("name"))||void 0===r?void 0:r.nodeValue;if(d&&d.parentNode&&"link-entity"===d.parentNode.nodeName&&!n.IsNullOrUndefined(d.parentNode.getAttribute("name"))){var p=d.parentNode.getAttribute("name"),y=d.getAttribute("name");p&&y&&u.addAttributes(l,p,[y])}else a&&u.addAttributes(l,a,[f])}return l},t.getColumnNamesFromFetch=f,t.getEntityFromFetch=function(e){var t=e.getElementsByTagName("entity");return n.IsNullOrUndefined(t)||n.IsNullOrUndefined(t[0])?null:t[0].getAttribute("name")},t.isFetchAll=p,t.addColumns=function(e,t){if(!n.IsNullOrUndefined(t)&&t.length&&!n.IsNullOrUndefined(e)){var r=f(e),i=e.getElementsByTagName("entity");if(i&&i[0])for(var a=i[0].firstChild,o=0;o<t.length;o++)if(-1===(null==r?void 0:r.indexOf(t[o]))){var u=e.createElement("attribute");u.attributes.setNamedItem(c(e,"name",t[o])),i[0].insertBefore(u,a)}}},t.buildLinkedEntityNode=function(e,t){var r='<link-entity name="'+e.name+'" from="'+e.from+'" to="'+e.to+'"';if(r+=e.linkType?' link-type="'+e.linkType+'"':"",r+=e.alias?' alias="'+e.alias+'"':"",0===t.length)return r+=" />";r+=">";for(var n=0;n<t.length;n++)r+='<attribute name="'+t[n]+'" />';return r+="</link-entity>"},t.addLinkedEntity=function(e,t){if(!n.IsNullOrUndefinedOrEmptyString(t)){var r=e.getElementsByTagName("entity")[0],i=!1,a=l(t),o=e.getElementsByTagName("link-entity");if(!n.IsNullOrUndefined(o))for(var u=["alias","name","from","to","link-type"],s=function(e){if(u.every((function(t){return d(o[e],a.documentElement,t)}))){for(var t=0;t<a.documentElement.childNodes.length;t++)o[e].appendChild(a.documentElement.childNodes[t].cloneNode());i=!0}},c=0;c<o.length;c++)s(c);i||n.IsNullOrUndefined(r)||r.appendChild(a.documentElement)}},t.addChildCountAttribute=function(e,t){var r=e.createElement("attribute");r.attributes.setNamedItem(c(e,"name",t)),r.attributes.setNamedItem(c(e,"rowaggregate","CountChildren")),r.attributes.setNamedItem(c(e,"alias","HierarchyDataChildCount6dcd9e4c001441b09237d51a34853d55")),e.getElementsByTagName("entity")[0].appendChild(r)},t.addFilters=function(e,t){if(!e)throw new Error("Invalid fetch xml document is passed");var r=o.parseXmlDocument(t),n=e.getElementsByTagName("entity")[0];r&&n.appendChild(r.firstChild)},t.addSort=function(e,t,r){var n;if(-1===t.indexOf("."))n=e.getElementsByTagName("entity")[0];else{var i=t.split(".");if(2===i.length)n=y(e,i[0],t=i[1])}if(n){for(var a=n.getElementsByTagName("order"),o=h(e,t,r),u=!1,l=0;l<a.length;l++)if(d(a[l],o,"attribute")){u=!0,a[l].setAttribute("descending",r?"true":"false");break}u||n.appendChild(o)}},t.findLinkEntitySort=y,t.createOrderElement=h,t.removeOrderElements=function(e){for(var t,r=e.getElementsByTagName("order");r.length;){var n=r[0];null===(t=n.parentNode)||void 0===t||t.removeChild(n)}},t.createOneToManyContextFilter=v,t.createManyToManyContextFilter=function(e,t,r,n,i,a){return'<link-entity name="'+e+'" intersect="true" visible="false" to="'+t+'" from="'+a+'">\n\t'+v(n,i,r)+"\n</link-entity>"},t.addContextFilter=function(e,t,r){if(!n.IsNullOrUndefinedOrEmptyString(r)&&!n.IsNullOrUndefinedOrEmptyString(t)){var i=e.getElementsByTagName("entity")[0],a=l(t),o=a.getElementsByTagName("condition")[0];n.IsNullOrUndefined(o)||o.attributes.setNamedItem(c(a,"value",r)),n.IsNullOrUndefined(i)||i.appendChild(a.firstChild)}},t.setFetchXmlParameters=function(e,t,r,i,a){if(e){if(e&&e.firstChild&&"fetch"!==e.firstChild.nodeName)return;n.IsNullOrUndefined(e.firstChild.attributes.getNamedItem("returntotalrecordcount"))&&e.firstChild.attributes.setNamedItem(c(e,"returntotalrecordcount",i.toString())),e.firstChild.attributes.setNamedItem(c(e,"page",r.toString())),e.firstChild.attributes.setNamedItem(c(e,"count",t.toString())),e.firstChild.attributes.setNamedItem(c(e,"no-lock",a.toString()))}},t.getColumnSetFromFetch=function(e){if(p(e))return i.AllColumns.get_instance();var t=o.create(e),r=[],n=null==t?void 0:t.selectNodes("/fetch/entity/attribute");if(n&&n.get_count())for(var u=0;u<n.get_count();u++){var l=n.get_item(u);l&&r.push(l.getAttribute("name"))}return new a.LegacyColumnSet(r)},t.ParseXml=function(e){if(window.hasOwnProperty("DOMParser"))return(new DOMParser).parseFromString(e,"text/xml");if(window.hasOwnProperty("ActiveXObject")){var t=new window.ActiveXObject("Microsoft.XMLDOM");return t.async=!1,t.loadXML(e),t}return null}},SV4j:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogicalOperator=void 0,function(e){e[e.And=0]="And",e[e.Or=1]="Or",e[e.Not=2]="Not"}(t.LogicalOperator||(t.LogicalOperator={}))},SXiu:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.isINavigationErrorStatus=t.addErrorParameters=t.cloneUciError=t.createUciError=t.UCI_ERROR_NAME=void 0;t.UCI_ERROR_NAME="UciError";t.createUciError=function(e,t,r,n,i,a,o){void 0===o&&(o=!1);var u=new Error(e);return u.name="UciError",u.errorCode=t,u.errorParameters=r,u.displayTitle=n,u.displayMessage=i,u.blockErrorReporting=o,a&&(u.stack=a),u},t.cloneUciError=function(e){if(!e){var t=new Error("Received blank error object");return t.name="UciError",t.errorCode=2147746581,t}var r=new Error(e.message);return r.name="UciError",r.errorCode=e.errorCode||2147746581,r.errorParameters=e.errorParameters,r.displayTitle=e.displayTitle,r.displayMessage=e.displayMessage,r.blockErrorReporting=e.blockErrorReporting,r.innerError=e.innerError,e.stack&&(r.stack=e.stack),r},t.addErrorParameters=function(e,t){e&&t&&(e.errorParameters?e.errorParameters=e.errorParameters.concat(t):e.errorParameters=t)},t.isINavigationErrorStatus=function(e){return e&&e.errorCode}},SywK:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.QUERYBUILDER_TRACE_CATEGORY_ID=t.queryStateToTelemetryParameters=t.QueryBuilderTelemetryHelper=void 0;var n=r("XGkY");t.QUERYBUILDER_TRACE_CATEGORY_ID="QueryBuilder";var i=function(){function e(){this._telemetryMessage="",this._telemetryParameters=[],this._operations=[]}return e.prototype.addOperation=function(e,t){this._telemetryMessage="to"===e||"from"===e?this._telemetryMessage?this._telemetryMessage+", "+t:t:this._telemetryMessage?this._telemetryMessage+", "+e:e,t&&this._operations.push({name:e,value:t})},e.prototype.addQueryInfoAndSendLog=function(t,r){e.tracer&&(this._addTelemetryParameter("viewId",t),this._addTelemetryParameter("entityLogicalName",r),this._addTelemetryParameter("operations",this._operations),e.tracer.info("[QueryBuilder] "+r+"-"+t+": "+this._telemetryMessage,this._telemetryParameters))},e.prototype._addTelemetryParameter=function(e,t){t&&this._telemetryParameters.push({name:e,value:t})},e}();t.QueryBuilderTelemetryHelper=i,t.queryStateToTelemetryParameters=function(e){var t,r,i,a,o,u,l,s,c,d=[];if(e){(null==e?void 0:e.viewId)&&d.push({name:"viewId",value:n.Guid.toString(null==e?void 0:e.viewId)}),(null==e?void 0:e.entityLogicalName)&&d.push({name:"entityLogicalName",value:null==e?void 0:e.entityLogicalName}),(null==e?void 0:e.useModernQueryBuilder)&&d.push({name:"useModernQueryBuilder",value:null==e?void 0:e.useModernQueryBuilder});var f=[];f.push({name:"isQuickFindSearch",value:null==e?void 0:e.isQuickFindSearch}),null===(t=null==e?void 0:e.sorts)||void 0===t||t.forEach((function(e){f.push({name:"orderBy",value:e})})),(null===(r=null==e?void 0:e.wheres)||void 0===r?void 0:r.length)&&(null===(i=null==e?void 0:e.wheres)||void 0===i?void 0:i.length)>0&&f.push({name:"where",value:null===(a=null==e?void 0:e.wheres)||void 0===a?void 0:a.length}),(null===(o=null==e?void 0:e.selects)||void 0===o?void 0:o.length)&&(null===(u=null==e?void 0:e.selects)||void 0===u?void 0:u.length)>0&&f.push({name:"select",value:null===(l=null==e?void 0:e.selects)||void 0===l?void 0:l.toString()}),null===(s=null==e?void 0:e.linkEntities)||void 0===s||s.forEach((function(e){f.push({name:"addLinkedEntity",value:e})})),null===(c=null==e?void 0:e.contextFiltersAndIds)||void 0===c||c.forEach((function(e){f.push({name:"applyContextFilter",value:e})})),(null==e?void 0:e.rollupType)&&f.push({name:"applyRollupContextFilter",value:null==e?void 0:e.rollupType.toString()}),d.push({name:"operations",value:f})}return d}},"UZ+8":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.isUrl=t.IsNullOrUndefinedOrEmptyString=t.IsNullOrUndefined=void 0;var n=/(http|https):\/\/(\w+:{0,1}\w*)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%!\-\/]))?/,i=/(dynamicsxrm):\/\/(\w+:{0,1}\w*)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%!\-\/]))?/,a=/^\/([0-9a-zA-Z_]+\/)?main.aspx/;function o(e){return null==e}t.IsNullOrUndefined=o,t.IsNullOrUndefinedOrEmptyString=function(e){return!!o(e)||"string"==typeof e&&""===e.trim()},t.isUrl=function(e){return n.test(e)||i.test(e)||a.test(e)}},VmZv:function(e,t,r){"use strict";var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.EntityRecord=void 0;var i=r("i2et"),a=r("lMa+"),o=r("FHhg"),u=r("UZ+8"),l=r("0hOr"),s=r("IvJe"),c=r("W2pJ"),d=r("JH5K"),f=r("iWcK"),p=r("iDsU"),y=r("PVp+"),h=r("AYBo"),v=r("WSZO"),m=r("BpGS"),g=r("N/D8"),_=r("AHn5"),E=function(){function e(t,r,n,i,a,o,l,s){this._accessRights=0,t instanceof e?(r=t._fields,n=t._fieldTypes,i=t._formattedValues,a=t._numericFormattedValues,o=t._relatedEntities,s=t._clientRetrieveOptions,this._identifier=t._identifier):this._identifier=t,d.throwOnNullOrUndefinedArgument(this._identifier,"identifier"),d.throwOnNullOrUndefinedArgument(r,"fields"),d.throwOnNullOrUndefinedArgument(n,"fieldTypes"),d.throwOnNullOrUndefinedArgument(i,"formattedValues"),d.throwOnNullOrUndefinedArgument(a,"numericFormattedValues"),d.throwOnNullOrUndefinedArgument(o,"relatedEntities"),this._fields=r,this._fieldTypes=n,this._formattedValues=i,this._numericFormattedValues=a,this._relatedEntities=o,this._columnSet=u.IsNullOrUndefined(l)?new p.LegacyColumnSet(new Array(0)):l,this.updateColumnSet(this.get_fieldNames()),this._changedFieldNames=[],this._cleanFields={},this._clientRetrieveOptions=s,this._accessRights=0;var c=this.getValue("activitytypecode");"activitypointer"===this._identifier.LogicalName&&c?this._actionableIdentifier=new m.LegacyEntityReference(c,this._identifier.Id):this._actionableIdentifier=this._identifier,this._userSharedAttributePrivileges={}}return Object.defineProperty(e.prototype,"fields",{get:function(){return this._fields},enumerable:!1,configurable:!0}),e.prototype.get_identifier=function(){return this._identifier},e.prototype.get_actionableIdentifier=function(){return this._actionableIdentifier},e.prototype.get_fieldTypes=function(){return this._fieldTypes},e.prototype.get_formattedValues=function(){return this._formattedValues},e.prototype.get_numericFormattedValues=function(){return this._numericFormattedValues},e.prototype.get_relatedEntities=function(){return this._relatedEntities},e.prototype.get_fieldNames=function(){var e=[],t=this._fields;for(var r in t){var n={key:r,value:t[r]};e.push(n.key)}return e},e.prototype.get_changedFieldNames=function(){return this._changedFieldNames},e.prototype.get_columnSet=function(){return this._columnSet},e.prototype.get_key=function(){return this.get_identifier().get_key()},e.prototype.get_clientRetrieveOptions=function(){return this._clientRetrieveOptions},e.prototype.set_clientRetrieveOptions=function(e){var t,r;this._clientRetrieveOptions=e;try{for(var i=n(this._relatedEntities.get_entityCollections()),a=i.next();!a.done;a=i.next()){a.value.get_value().set_clientRetrieveOptions(e)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},e.prototype.get_accessRights=function(){return this._accessRights},e.prototype.set_accessRights=function(e){this._accessRights=e},e.prototype.get_userSharedAttributePrivileges=function(){return this._userSharedAttributePrivileges},e.prototype.set_userSharedAttributePrivileges=function(e){this._userSharedAttributePrivileges=e},e.prototype.get_entityRecordForProcess=function(){return this._entityRecordForProcess},e.prototype.set_entityRecordForProcess=function(e){return this._entityRecordForProcess=e,e},e.prototype.get_globalNavigationData=function(){return this._globalNavigationData},e.prototype.set_globalNavigationData=function(e){this._globalNavigationData=e},e.prototype.isDirty=function(){return this.get_changedFieldNames().length>0},e.prototype.clone=function(){var t=this.getObjectData(),r=t.columnset;u.IsNullOrUndefined(r)||(r.columns=r.columns.slice());var n=t.formattedfields,i={};for(var a in n){i[(c={key:a,value:n[a]}).key]=c.value}var o=t.numericformattedfields,l={};for(var s in o){var c;l[(c={key:s,value:o[s]}).key]=c.value}return t.formattedfields=i,t.numericformattedfields=l,e.createFromObjectData(t)},e.prototype.getObjectData=function(){var e=this._columnSet instanceof f.AllColumns;return{identifier:this._identifier.getObjectData(),fields:this._GetFieldsObjectData(),fieldtypes:{},formattedfields:this._formattedValues,numericformattedfields:this._numericFormattedValues,allcolumns:e,columnset:e?void 0:this._columnSet.getObjectData(),clientretrieveoptions:u.IsNullOrUndefined(this._clientRetrieveOptions)?void 0:this._clientRetrieveOptions.getObjectData(),accessrights:this._accessRights,sharedattributeprivileges:{},entityrecordforprocess:u.IsNullOrUndefined(this.get_entityRecordForProcess())?void 0:this.get_entityRecordForProcess().getObjectData(),globalnavigationdata:u.IsNullOrUndefined(this.get_globalNavigationData())?void 0:this.get_globalNavigationData().getObjectData()}},e.prototype._GetFieldsObjectData=function(){var e=this;return Object.keys(this._fields).reduce((function(t,r){return t[r]=e.getFieldObjectData(r),t}),{})},e.prototype.getFieldObjectData=function(t){return e.InternalGetFieldObjectData(this.getValue(t),this._fieldTypes[t])},e.prototype.getFields=function(){return this._GetFieldsObjectData()},e.prototype.hasValue=function(e){return e in this._fields},e.prototype.hasField=function(e){return e in this._fieldTypes},e.prototype.getValue=function(e){return this._fields[e]},e.prototype.getFormattedValue=function(e){return u.IsNullOrUndefined(this.get_formattedValues()[e])?this.get_fieldTypes()[e]===i.AttributeType.AliasedValue?this.getValue(e).get_value():this.getValue(e):this.get_formattedValues()[e]},e.prototype.getNumericFormattedValue=function(e){return this._numericFormattedValues[e]||this.getFormattedValue(e)},e.prototype.setValue=function(e,t){if(!(e in this.get_fieldTypes()))throw Error(e);t&&t.get_Label&&t.get_ValueString?this._fields[e]=g.OptionMetadata.createFromPicklistItem(t):this._fields[e]=t,this.updateColumnSet([e])},e.prototype.markFieldChanged=function(e){var t,r;if(this.get_changedFieldNames().indexOf(e)<0&&(this._cleanFields[e]=this._fields[e],this.get_changedFieldNames().push(e),this._fields[e]instanceof h.EntityCollection))try{for(var i=n(this._fields[e].get_entities()),a=i.next();!a.done;a=i.next()){a.value._MarkAllFieldsChanged()}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},e.prototype._MarkAllFieldsChanged=function(){var e,t;try{for(var r=n(this.get_fieldNames()),i=r.next();!i.done;i=r.next()){var a=i.value;this.markFieldChanged(a)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},e.prototype.resetChanges=function(){this._changedFieldNames=[],this._cleanFields={}},e.prototype.mergeChanges=function(e){u.IsNullOrUndefined(this._clientRetrieveOptions)?this._clientRetrieveOptions=e._clientRetrieveOptions:this._clientRetrieveOptions.update(e._clientRetrieveOptions),this.set_accessRights(e.get_accessRights()),this.mergeEntityRecordFields(e),this._entityRecordForProcess=e._entityRecordForProcess,this._globalNavigationData=e._globalNavigationData},e.prototype.mergeEntityRecordFields=function(e){var t=e._fields;for(var r in t){(l={key:r,value:t[r]}).key in this._fields&&c.areValuesEqual(this._fields[l.key],l.value)||(this._fields[l.key]=l.value)}var n=e._fieldTypes;for(var i in n){var a=(l={key:i,value:n[i]}).key;a in this._fieldTypes||(this._fieldTypes[a]=e._fieldTypes[a]),a in this._fields&&!(a in e._fields)&&(delete this._fields[a],delete this._formattedValues[a],delete this._numericFormattedValues[a])}var o=e._formattedValues;for(var u in o){var l;(l={key:u,value:o[u]}).key in this._formattedValues&&c.areValuesEqual(this._formattedValues[l.key],l.value)||(this._formattedValues[l.key]=l.value)}e.get_columnSet()instanceof f.AllColumns?this.updateColumnSet(e.get_columnSet()):this.updateColumnSet(this.get_fieldNames())},e.prototype.initializeValue=function(e,t,r){this._fields[e]=t,e in this._fieldTypes||(this._fieldTypes[e]=r),this.updateColumnSet([e])},e.prototype.updateColumnSet=function(e,t){var r,i,a,o,l,s;if(e=e,!(this.get_columnSet()instanceof f.AllColumns)){if(e instanceof f.AllColumns)this._columnSet=f.AllColumns.get_instance();else{var c=void 0;c=e instanceof p.LegacyColumnSet?e.get_Columns():e;var d=this._columnSet;try{for(var y=n(c),h=y.next();!h.done;h=y.next()){var v=h.value;d.get_Columns().indexOf(v)<0&&d.get_Columns().push(v)}}catch(e){r={error:e}}finally{try{h&&!h.done&&(i=y.return)&&i.call(y)}finally{if(r)throw r.error}}}if(!u.IsNullOrUndefined(t)&&t&&(null==t?void 0:t.length)>0)try{for(var m=n(t),g=m.next();!g.done;g=m.next()){var _=g.value,E=this.get_relatedEntities().getByRelationship(_.get_relationship());if(E)try{for(var O=(l=void 0,n(E.get_entities())),b=O.next();!b.done;b=O.next()){b.value.updateColumnSet(_.get_ColumnSet())}}catch(e){l={error:e}}finally{try{b&&!b.done&&(s=O.return)&&s.call(O)}finally{if(l)throw l.error}}}}catch(e){a={error:e}}finally{try{g&&!g.done&&(o=m.return)&&o.call(m)}finally{if(a)throw a.error}}}},e.createFromObjectData=function(t){var r,n,i={},a=t.identifier&&m.LegacyEntityReference.createFromObjectData(t.identifier),o=e.createFieldsFromObjectData(t.fields,i);r=t.allcolumns?f.AllColumns.get_instance():p.LegacyColumnSet.createFromObjectData(t.columnset),t.clientretrieveoptions&&(n=y.ClientRetrieveOptions.createFromObjectData(t.clientretrieveoptions));var l=new e(a,o,i,t.formattedfields,t.numericformattedfields,new _.RelatedEntityCollection(new Array(0)),r,n);l.set_accessRights(t.accessrights);var s=t.entityrecordforprocess;u.IsNullOrUndefined(s)||l.set_entityRecordForProcess(e.createFromObjectData(s));var c=t.globalnavigationdata;return u.IsNullOrUndefined(c)||l.set_globalNavigationData(e.createFromObjectData(c)),l},e.createSingleFieldFromObjectData=function(t,r){return e.InternalCreateFieldFromObjectData(t,r)},e.createFieldsFromObjectData=function(t,r){var n={};for(var i in t){var a={key:i,value:t[i]};n[a.key]=e.InternalCreateFieldFromObjectData(a.value,r[a.key])}return n},e.InternalCreateFieldFromObjectData=function(e,t){if(u.IsNullOrUndefined(e))return null;switch(t){case i.AttributeType.AliasedValue:return v.LegacyAliasedValue.createFromObjectData(e);case i.AttributeType.Customer:case i.AttributeType.Lookup:case i.AttributeType.Owner:return m.LegacyEntityReference.createFromObjectData(e);case i.AttributeType.UniqueIdentifier:return a.LegacyGuid.createFromObjectData(e);case i.AttributeType.DateTime:return new Date(Date.parse(e));case i.AttributeType.Status:case i.AttributeType.State:case i.AttributeType.Boolean:case i.AttributeType.PickList:return g.OptionMetadata.createFromObjectData(e);case i.AttributeType.PartyList:return h.EntityCollection.createFromObjectData(e);default:return e}},e.InternalGetFieldObjectData=function(e,t){if(u.IsNullOrUndefined(e))return null;switch(t){case i.AttributeType.AliasedValue:return e.getObjectData();case i.AttributeType.Customer:case i.AttributeType.Lookup:case i.AttributeType.Owner:case i.AttributeType.UniqueIdentifier:return e.getObjectData();case i.AttributeType.DateTime:return e.toString();case i.AttributeType.Status:case i.AttributeType.State:case i.AttributeType.Boolean:case i.AttributeType.PickList:case i.AttributeType.PartyList:return e.getObjectData();default:return e}},e.recordDataToLegacyEntityRecord=function(t,r,n,i,a,u){void 0===u&&(u=s.FieldValueRetrievalBehavior.LatestEntered);var c=new e(o.EntityReference.toLegacyEntityReference(r),{},{},{},{},new _.RelatedEntityCollection([]));for(var d in n){var f=l.getAttributeDescriptor(t,r.etn,d);if(f){var p=s.getLegacyValueForField(t,r.etn,d,n[d],u);c.initializeValue(d,p,f.Type),c.markFieldChanged(d)}else{var y="Attribute "+d+" for entity "+r.etn+" could not be found.";a.warn("EntityRecord "+y)}}return c},e}();t.EntityRecord=E},W2pJ:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.areValuesEqual=void 0;var n=r("lMa+");t.areValuesEqual=function e(t,r){return!t&&!r||!(!t&&r||t&&!r)&&(t instanceof n.LegacyGuid&&r instanceof n.LegacyGuid||t.equals&&r.equals?t.equals(r):t.get_ValueString&&t.get_Label&&r.get_ValueString&&r.get_Label?t.get_ValueString()===r.get_ValueString()&&t.get_Label()===r.get_Label():t.get_value&&r.get_value?e(t.get_value(),r.get_value()):(t instanceof Date&&r instanceof Date&&(t=t.valueOf(),r=r.valueOf()),t===r))}},WPdH:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeyValuePair=void 0;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n=function(){function e(e,t){this._key=e,this._value=t}return e.prototype.get_key=function(){return this._key},e.prototype.get_value=function(){return this._value},e}();t.KeyValuePair=n},WSZO:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyAliasedValue=void 0;var n=r("VmZv"),i=function(){function e(e,t,r){this._entityLogicalName=e,this._attributeLogicalName=t,this._attributeType=r}return e.prototype.get_entityLogicalName=function(){return this._entityLogicalName},e.prototype.get_attributeLogicalName=function(){return this._attributeLogicalName},e.prototype.get_attributeType=function(){return this._attributeType},e.prototype.get_value=function(){return this._innerValue},e.prototype.set_value=function(e){return this._innerValue=e,e},e.prototype.getObjectData=function(){return{entityLogicalName:this._entityLogicalName,attributeLogicalName:this._attributeLogicalName,attributeType:this._attributeType,value:n.EntityRecord.InternalGetFieldObjectData(this._innerValue,this._attributeType)}},e.createFromObjectData=function(t){var r=t.attributeLogicalName,i=t.entityLogicalName,a=t.attributeType,o=t.value,u=a,l=new e(i,r,u);return l.set_value(n.EntityRecord.InternalCreateFieldFromObjectData(o,u)),l},e}();t.LegacyAliasedValue=i,i.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.AliasedValue"},Z7iH:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilterExpression=void 0;var n=r("DVFg"),i=r("SV4j"),a=r("DCxx"),o=r("UZ+8"),u=function(){function e(e,t,r,n){this._FilterOperator=0,this._IsQuickFindFields=!1,this._set_filterOperator(e),this.set_filterExpressionId(t),this._set_filterExpressions([]),o.IsNullOrUndefined(r)?this._set_isQuickFindFields(!1):this._set_isQuickFindFields(r),o.IsNullOrUndefined(n)?this._set_hint(null):this._set_hint(n)}return e.prototype.get_filterExpressionId=function(){return this._FilterExpressionId},e.prototype.set_filterExpressionId=function(e){this._FilterExpressionId=e},e.prototype.get_filterOperator=function(){return this._FilterOperator},e.prototype._set_filterOperator=function(e){return this._FilterOperator=e,e},e.prototype.get_isQuickFindFields=function(){return this._IsQuickFindFields},e.prototype._set_isQuickFindFields=function(e){return this._IsQuickFindFields=e,e},e.prototype.get_hint=function(){return this._Hint},e.prototype._set_hint=function(e){this._Hint=e},e.prototype.get_conditions=function(){return this._Conditions},e.prototype._set_conditions=function(e){return this._Conditions=e,e},e.prototype.get_filterExpressions=function(){return this._FilterExpressions},e.prototype._set_filterExpressions=function(e){return this._FilterExpressions=e,e},e.prototype.addCondition=function(e,t,r,i,a){r=r,a=o.IsNullOrUndefined(a)?"":a;var u=new n.Condition(e,t,r);return u.set_entityName(i),u.set_conditionName(a),this.get_conditions()||this._set_conditions([]),this.get_conditions().push(u),this},e.prototype.addFilterExpression=function(e){return e?(this.get_filterExpressions()||this._set_filterExpressions([]),this.get_filterExpressions().push(e),this):this},e.prototype.clone=function(){var t=new e(this.get_filterOperator(),this.get_filterExpressionId());if(this.get_conditions()){t._set_conditions([]);for(var r=0;r<this.get_conditions().length;r++)t.get_conditions().push(this.get_conditions()[r].clone())}else t._set_conditions(null);if(this.get_filterExpressions()){t._set_filterExpressions([]);for(r=0;r<this.get_filterExpressions().length;r++)t.get_filterExpressions().push(this.get_filterExpressions()[r].clone())}else t._set_filterExpressions(null);return t},e.prototype.toFetchXml=function(){return e._CreateXmlFilter(this)},e._CreateXmlFilter=function(t){var r="";if(!t||!(t.get_filterExpressions()&&t.get_filterExpressions().length||t.get_conditions()&&t.get_conditions().length))return r;if(t.get_conditions()){t.get_conditions().length>0&&(r+='<filter type="'+i.LogicalOperator[t.get_filterOperator()].toLowerCase()+'"',t.get_isQuickFindFields()&&(r+=' isquickfindfields="1"'),r+=">",o.IsNullOrUndefinedOrEmptyString(t.get_hint())||(r+=' hint="'+t.get_hint().toLowerCase()+'"'));for(var n=0;n<t.get_conditions().length;n++){var u=t.get_conditions()[n];if(r+="<condition ",o.IsNullOrUndefinedOrEmptyString(u.get_entityName())||(r+='entityname="'+u.get_entityName()+'" '),u.get_value())if("string"==typeof u.get_value())r+='attribute="'+u.get_attributeName()+'" operator="'+u.get_operator()+'" value="'+a.xmlAttributeEncode(u.get_value())+'" />';else{var l=u.get_value();r+='attribute="'+u.get_attributeName()+'" operator="'+u.get_operator()+'">';for(var s=0;s<l.length;s++)r+="<value>"+a.xmlEncode(l[s])+"</value>";r+="</condition>"}else r+='attribute="'+u.get_attributeName()+'" operator="'+u.get_operator()+'"/>'}t.get_conditions().length>0&&(r+="</filter>")}else{t.get_filterExpressions().length>1&&(r+='<filter type="'+i.LogicalOperator[t.get_filterOperator()].toLowerCase()+'"',t.get_hint()&&(r+=' hint="'+t.get_hint().toLowerCase()+'"'),r+=">");for(n=0;n<t.get_filterExpressions().length;n++)r+=e._CreateXmlFilter(t.get_filterExpressions()[n]);t.get_filterExpressions().length>1&&(r+="</filter>")}return r},e}();t.FilterExpression=u},a5Wk:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.buildBatchRequest=void 0;var i=r("bOB9"),a=r("vqTk");function o(e,t,r){var i,a,o="",l=1;try{for(var s=n(r),c=s.next();!c.done;c=s.next()){var d=c.value;if(d.serializationFailure)throw d.serializationFailure;o+="--"+t+"\n",o+="Content-Type: application/http\nContent-Transfer-Encoding: binary\n",o+="Content-ID: "+l+++"\n",o+="\n",o+=u(e,d)}}catch(e){i={error:e}}finally{try{c&&!c.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}return o+="--"+t+"--\n"}function u(e,t){var r=t.method+" "+e+t.urlParameters+" HTTP/1.1\n";for(var n in t.additionalHeaders)n!==i.HEADER.CONTENT_TYPE&&"GET"!==t.method&&(r+=n+": "+t.additionalHeaders[n]+"\n");return"GET"!==t.method&&(r+=i.HEADER.CONTENT_TYPE+": application/json;type=entry\n"),r+="\n",t.body&&(r+=t.body),r}function l(e){return e+"_"+new Date(Date.now()).getTime()}t.buildBatchRequest=function(e,t,r){var s,c,d;if(!e||!e.length)return{serializationFailure:"Attempted to create an OData batch with empty list of requests"};var f="";r||(r=l("batch"));var p=t.DataLayerConfiguration.useAbsolutePaths?"":""+t.DataLayerConfiguration.baseUri+a.WEB_API_URL_FRAGMENT;try{for(var y=n(e),h=y.next();!h.done;h=y.next()){var v=h.value;f+="--"+r+"\n";var m="";if(Array.isArray(v)){var g=v,_=l("changeset");m=o(p,_,g),f+="Content-Type: multipart/mixed;boundary="+_+"\n"}else{var E=v;if(E.serializationFailure)return E;m=u(p,E),f+="Content-Type: application/http\nContent-Transfer-Encoding: binary\n"}f+="\n",f+=m,f+="\n"}}catch(e){s={error:e}}finally{try{h&&!h.done&&(c=y.return)&&c.call(y)}finally{if(s)throw s.error}}var O="--"+r+"--\r\n\0";return f.endsWith(O+"\n")?f=f.substr(0,f.length-1):f+=O,{urlParameters:"$batch",additionalHeaders:(d={},d[i.HEADER.CONTENT_TYPE]="multipart/mixed;boundary="+r,d.Accept=a.HEADER_VALUES.APPLICATION_JSON,d),body:f,method:"POST"}}},aiEo:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFetchXmlForAliasedValues=t.deserializeEntityCollection=t.parseQueryForAliasedValues=void 0;var n=r("UZ+8"),i=r("AYBo"),a=r("mVtf"),o=r("GSc/"),u=r("EY1R"),l=r("0hOr"),s=r("Mx+d"),c=r("SJSp"),d=r("gkFy");function f(e){for(var t={},r={},n=(new DOMParser).parseFromString(e,"text/xml"),i=n.getElementsByTagName("link-entity"),a=0;a<i.length;++a){var o=i[a],l=o.getAttribute("alias"),s=o.getAttribute("name"),c=o.getElementsByTagName("attribute");if(c.length)for(var d=0;d<c.length;++d){var f=c.item(d),p=l+"."+(_=f?f.getAttribute("name"):null),y=l+"_x002e_"+_;t[p]={alias:l,aliasedEtn:s,aliasedValueFieldName:_,oDataAlias:[p,y],oDataSeparator:[".","_x002e_"]},t[y]={alias:l,aliasedEtn:s,aliasedValueFieldName:_,oDataAlias:[y,p],oDataSeparator:["_x002e_","."]},u.addAttributes(r,s,[_])}}var h=n.querySelectorAll("entity > attribute[alias]"),v=n.getElementsByTagName("entity"),m=v&&v[0]?v[0].getAttribute("name"):"";for(a=0;a<h.length;++a){var g=h[a],_=(l=g.getAttribute("alias"),g.getAttribute("name")),E=g.getAttribute("rowaggregate");t[""+_]={alias:l,aliasedValueEtn:m,aliasedValueFieldName:_,oDataAlias:[""+l],oDataSeparator:[""],isAttributeAlias:!0,rowaggregate:E}}return{aliasedValueDescriptors:t,entity2AttributesMap:r}}t.deserializeEntityCollection=function(e,t,r,u,f,p,y,h,v,m){void 0===h&&(h=d.PayloadFormat.OData);var g=t instanceof o.LegacyQuery?null==t?void 0:t.get_EntityLogicalName():null==t?void 0:t.entityLogicalName,_=s.getEntityDescriptor(e,g),E=l.getAttributesForEntity(e,g),O=a.parseXmlDocument(t instanceof o.LegacyQuery?null==t?void 0:t.get_FetchXml():null==t?void 0:t.fetchXml),b=t instanceof o.LegacyQuery?null==t?void 0:t.GetColumnNamesFromFetch():c.getColumnNamesFromFetch(O),N=function(e,t){var r=[];if(t===d.PayloadFormat.SQL&&e.rows&&e.rows.length){r=[];for(var n=0;n<e.rows.length;n++)r.push(e.rows.item(n))}else r=t===d.PayloadFormat.OData&&e&&e.value&&e.value.length?e.value:[];return r}(u,h).map((function(n){return d.createEntityRecordFromResponse(e,n,_,E,b,t instanceof o.LegacyQuery?null==t?void 0:t.get_ColumnSet():c.getColumnSetFromFetch(O),null,r,y,h)}));return function(e,t,r,a,u,l,s){n.IsNullOrUndefined(s)&&(s=e["@Microsoft.Dynamics.CRM.totalrecordcountlimitexceeded"]||!1);s?a=-1:n.IsNullOrUndefined(a)&&(a=e["@Microsoft.Dynamics.CRM.totalrecordcount"]||r.length);n.IsNullOrUndefined(l)&&(l=e["@Microsoft.Dynamics.CRM.morerecords"]);u&&t instanceof o.LegacyQuery&&(null==t||t.set_PagingCookie(u));return new i.EntityCollection(r,l,a,s,t instanceof o.LegacyQuery?t:null)}(u,t,N,f,p,v,m)},t.parseQueryForAliasedValues=function(e){return f(null==e?void 0:e.get_FetchXml())},t.parseFetchXmlForAliasedValues=f},atuF:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.serializeEntityRecord=void 0;var i=r("i2et"),a=r("XGkY"),o=r("FHhg"),u=r("pdzI"),l=r("jLS2");function s(e){var t,r;if(!e)throw new Error("Legacy entity record is null");var i=e.get_fieldNames(),a=e.get_fieldTypes(),s={},d=new Date;if(i)try{for(var f=n(i),p=f.next();!p.done;p=f.next()){var y=p.value,h=a[y],v=e.getValue(y);null!==v?s[y]=c(y,h,v,e,d):s[y]=null}}catch(e){t={error:e}}finally{try{p&&!p.done&&(r=f.return)&&r.call(f)}finally{if(t)throw t.error}}var m,g,_=e.get_globalNavigationData();if(_){var E=o.EntityReference.fromLegacyEntityReference(_.get_identifier());E&&(g=E.id);var O=_.getValue("processid");if(O)m=o.EntityReference.fromLegacyEntityReference(O).id}return{initialized:u.InitState.Initialized,identifier:o.EntityReference.fromLegacyEntityReference(e.get_identifier()),accessRights:l.serializeAccessRights(e),fields:s,businessProcessFlowId:m,businessProcessFlowInstanceId:g}}function c(e,t,r,u,l){var d,f,p,y,h={errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1};switch(t){case i.AttributeType.Boolean:case i.AttributeType.PickList:case i.AttributeType.State:case i.AttributeType.Status:var v=r;return{label:v.get_Label(),valueString:v.get_ValueString(),timestamp:l,validationResult:h};case i.AttributeType.UniqueIdentifier:var m=r;return{id:a.Guid.fromLegacyGuid(m),timestamp:l,validationResult:h};case i.AttributeType.Customer:case i.AttributeType.Lookup:case i.AttributeType.Owner:var g=r;return{reference:o.EntityReference.fromLegacyEntityReference(g),timestamp:l,validationResult:h};case i.AttributeType.AliasedValue:var _=r,E=_.get_entityLogicalName(),O=_.get_attributeLogicalName(),b=_.get_attributeType();return{attributeLogicalName:O,entityLogicalName:E,innerValue:c(e,b,_.get_value(),u,l),timestamp:l,validationResult:h,innerType:b};case i.AttributeType.PartyList:var N=r,R=[];try{for(var T=n(N.get_entities()),A=T.next();!A.done;A=T.next()){var S=A.value;R.push(s(S))}}catch(e){d={error:e}}finally{try{A&&!A.done&&(f=T.return)&&f.call(T)}finally{if(d)throw d.error}}return{list:R,timestamp:l,validationResult:h};case i.AttributeType.NavigationProperty:var D=r,C=[];try{for(var P=n(D),w=P.next();!w.done;w=P.next()){var I=w.value;C.push(s(I))}}catch(e){p={error:e}}finally{try{w&&!w.done&&(y=P.return)&&y.call(P)}finally{if(p)throw p.error}}return{list:C,timestamp:l,validationResult:h};default:t===i.AttributeType.DateTime&&(r=r&&r.toISOString());var M=u.get_formattedValues();if(M.hasOwnProperty(e))return{value:r,formatted:M[e],timestamp:l,validationResult:h};var F=u.get_numericFormattedValues();return F.hasOwnProperty(e)?{value:r,formatted:F[e],timestamp:l,validationResult:h}:{value:r,timestamp:l,validationResult:h}}}t.serializeEntityRecord=s},bMRw:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.ODataOperationType=t.ODataStructuralProperty=void 0,function(e){e[e.Unknown=0]="Unknown",e[e.PrimitiveType=1]="PrimitiveType",e[e.ComplexType=2]="ComplexType",e[e.EnumerationType=3]="EnumerationType",e[e.Collection=4]="Collection",e[e.EntityType=5]="EntityType"}(t.ODataStructuralProperty||(t.ODataStructuralProperty={})),function(e){e[e.Action=0]="Action",e[e.Function=1]="Function",e[e.CRUD=2]="CRUD",e[e.ExecuteMultiple=3]="ExecuteMultiple"}(t.ODataOperationType||(t.ODataOperationType={}))},c5ne:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function u(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,u)}l((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveGridDataSucceeded=t.getUpdatedRefCount=t.GRID_CLASS_ID=t.retrieveGridData=t.RETRIEVE_GRID_DATA_ACTION=void 0;var a=r("Y0ua"),o=r("XGkY"),u=r("Kz3/"),l=r("pdzI"),s=r("nRuH"),c=r("+//z"),d=r("n8WZ"),f=r("SywK"),p=r("UZ+8"),y=r("f6dx");Object.defineProperty(t,"RETRIEVE_GRID_DATA_ACTION",{enumerable:!0,get:function(){return y.RETRIEVE_GRID_DATA_ACTION}});var h=r("l7wu"),v=r("ILcb"),m=r("Mx+d"),g=r("c7Ce"),_=r("e3wK"),E=r("RHls"),O=r("djz1"),b=r("RslU");function N(e){return{type:y.RETRIEVE_GRID_DATA_ACTION,payload:e}}function R(e,t,r,n,i,a){for(var u,s,c,d,f,y,h=O.serializeEntityCollection(i),v={},m=[],g={},E=0;E<h.length;E++){var b=null===(d=h[E].identifier)||void 0===d?void 0:d.etn;if(b){var N=o.Guid.toString(null===(f=h[E].identifier)||void 0===f?void 0:f.id);if(p.IsNullOrUndefined(b)||p.IsNullOrUndefined(N)||v[b]||(v[b]={}),v[b][N]=h[E],m.push(null===(y=h[E])||void 0===y?void 0:y.identifier),e){var R=T(e,b,a,N);if(b&&R)if(g[b])g[b][N]=R;else{var A=((u={})[N]=R,u);g[b]=A}}}}var S={entities:v,lists:(s={},s[r]={initialized:l.InitState.Initialized,lastRetrieved:new Date,records:m,pages:(c={},c[n.pageNumber]={pagingCookie:null==n?void 0:n.pagingCookie,startGuid:m&&m.length&&m[0].id,startIndex:0,moreRecords:i.get_moreRecords()},c),pageSize:null==n?void 0:n.pageSize,totalRecordCount:i.get_totalRecordCount(),totalRecordCountLimitExceeded:i.get_totalRecordCountLimitExceeded()},s)};return function(e,t,r,n,i,a,o){var u={},l=T(e,r,n,i,a);i&&l&&(u[i]=l);if(o&&Object.keys(o).length>0||u&&Object.keys(u).length>0){var s={entities:o,lists:u};t(_.gcUpdateData(s))}}(e,t,a,null,null,r,g),S}function T(e,t,r,n,i){var a,o;if(!e)return null;if(n&&""!==n)if(i){var l=g.getGCListQueryDataRefCount(e,i),s=null==l?void 0:l.slice();if(s)return null!==(a=u.addReference(s,n))&&void 0!==a?a:null}else if(t&&r){var c=g.getGCEntityRecordDataRefCount(e,t,r),d=null==c?void 0:c.slice();if(d)return null!==(o=u.addReference(d,n))&&void 0!==o?o:null}return null}t.GRID_CLASS_ID="E7A81278-8635-4D9E-8D4D-59480B391C5B",t.retrieveGridData=function(e,t){void 0===t&&(t=!1);var r=[];return{type:"gridData.retrieve.async",execute:function(u,p,g){var _,O=u.getState,T=u.dispatch;return n(this,void 0,void 0,(function(){var n,u,A,S,D,C,P,w,I,M,F;return i(this,(function(i){switch(i.label){case 0:if(i.trys.push([0,3,,4]),n=new s.UCIContext(o.Guid.newGuid().guid,null==g?void 0:g.isPreloadCall),r.push({name:a.EVENT_PARAMETERS.CLIENT_REQUEST_ID,value:n.RequestId()}),r.push({name:"isRefresh",value:t}),u=(null==e?void 0:e.key)||"query",!(A=null==e?void 0:e.entityLogicalName))throw new E.ErrorStatus("Unable to execute query without entity logical name");return S=v.ModernQueryBuilder.fromState(e),[4,T(b.retrieveEntity(A,!1))];case 1:if(i.sent(),D=O(),!(C=m.getPrimaryIdAttribute(D,A)))throw new E.ErrorStatus("Unable to identify primary id of entity "+A);return S.selectInternal(C,!1),P=S.getQueryState(O),r.push({name:f.QUERYBUILDER_TRACE_CATEGORY_ID,value:f.queryStateToTelemetryParameters(e)}),T(function(e,t,r){var n;void 0===r&&(r=!1);var i=t instanceof c.KeyQuery?null==t?void 0:t.get_PageSize():null==t?void 0:t.pageSize,a={lists:(n={},n[e]={initialized:r?l.InitState.Refreshing:l.InitState.Initializing,pageSize:i},n)};return{type:y.RETRIEVE_GRID_DATA_ACTION,payload:a}}(u,P,t)),[4,T(d.retrieveMultiple(e))];case 2:return w=i.sent(),I=null===(_=p.DataLayerConfiguration.GarbageCollectionProvider)||void 0===_?void 0:_.getCurrentPage(),M=R(D,T,u,e,w,I),T(N(M)),p.EventManager.ReportComponentSuccess(h.RETRIEVE_GRID_DATA,r),[2,M];case 3:return F=i.sent(),p.EventManager.ReportComponentFailure(h.RETRIEVE_GRID_DATA,r),E.convertErrorAndRethrow(F),[3,4];case 4:return[2]}}))}))},getFailureParameters:function(){return r},getSuccessParameters:function(){return r}}},t.retrieveGridDataSucceeded=function(e,t,r,n,i,a){return N(R(e,t,n,i,a,r))},t.getUpdatedRefCount=T},c7Ce:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function n(e){return e&&e.garbageCollector?e.garbageCollector.metadata:null}function i(e){return e&&e.garbageCollector?e.garbageCollector.data:null}Object.defineProperty(t,"__esModule",{value:!0}),t.getGCListQueryDataRefCount=t.getGCListsData=t.getGCChartStorageKeyRefCount=t.getGCChartVisualizationViewRefCount=t.getGCChartDataByStorageKey=t.getGCChartsData=t.getGCEntityRecordDataRefCount=t.getGCEntitiesData=t.getGCEntityMetadataRefCount=t.getGCEntitiesMetadata=t.getGCRibbonMetadataRefCount=t.getGCRibbonsMetadata=void 0,t.getGCRibbonsMetadata=function(e){var t,r=n(e);return r&&null!==(t=r.ribbons)&&void 0!==t?t:null},t.getGCRibbonMetadataRefCount=function(e,t){var r=n(e);return r&&r.ribbons?r.ribbons[t]:null},t.getGCEntitiesMetadata=function(e){var t,r=n(e);return r&&null!==(t=r.entities)&&void 0!==t?t:null},t.getGCEntityMetadataRefCount=function(e,t){var r=n(e);return r&&r.entities?r.entities[t]:null},t.getGCEntitiesData=function(e){var t=i(e);return t&&t.entities?t.entities:null},t.getGCEntityRecordDataRefCount=function(e,t,r){var n=i(e);return n&&n.entities&&n.entities[t]?n.entities[t][r]:null},t.getGCChartsData=function(e){var t=i(e);return t&&t.charts?t.charts:null},t.getGCChartDataByStorageKey=function(e){var t=i(e);return t&&t.chartData?t.chartData:null},t.getGCChartVisualizationViewRefCount=function(e,t,r){var n=i(e);return n&&n.charts&&n.charts[t]?n.charts[t][r]:null},t.getGCChartStorageKeyRefCount=function(e,t){var r=i(e);return r&&r.chartData&&r.chartData[t]?r.chartData[t]:null},t.getGCListsData=function(e){var t=i(e);return t&&t.lists?t.lists:null},t.getGCListQueryDataRefCount=function(e,t){var r=i(e);return r&&r.lists&&r.lists[t]?r.lists[t]:null}},djz1:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.serializeEntityCollection=void 0;var n=r("atuF");t.serializeEntityCollection=function(e){var t=e.get_entities(),r=e.get_query(),i=[];r&&(null==r?void 0:r.GetColumnNamesFromFetch)&&(i=null==r?void 0:r.GetColumnNamesFromFetch());for(var a=[],o=0;o<t.length;o++){var u=n.serializeEntityRecord(t[o]);u.queryColumnNames=i,delete u.accessRights,a.push(u)}return a}},e3wK:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.gcUpdateDataEntities=t.gcUpdateData=t.garbageCollectDataNode=void 0;var n=r("XGkY"),i=r("Kz3/"),a=r("f6dx"),o=r("6/7M"),u=r("c7Ce"),l=r("c5ne");function s(e){return{type:o.GC_UPDATE_DATA_ACTION,payload:e}}t.garbageCollectDataNode=function(e){return{type:"garbage.collect.data.sync",sync:!0,execute:function(t,r){var n,o,l,c=t.dispatch,d=(0,t.getState)(),f={},p={},y=u.getGCEntitiesData(d);for(var h in y){var v=y[h];for(var m in v){var g=(R=null===(o=v[m])||void 0===o?void 0:o.slice())&&i.removeReference(R,e);if(g)if(0===g.length)if(p[h])p[h][m]=null;else{var _=((n={})[m]=null,n);p[h]=_}else f[h]||(f[h]={}),f[h][m]=g}}var E={},O={},b=u.getGCListsData(d);for(var N in b){var R,T=(R=null===(l=b[N])||void 0===l?void 0:l.slice())&&i.removeReference(R,e);T&&(0===T.length?O[N]=null:E[N]=T)}var A,S={},D={},C={},P={};(Object.keys(f).length>0||Object.keys(E).length>0||Object.keys(S).length>0||Object.keys(C).length>0)&&c(s({entities:f,lists:E,charts:S,chartData:C}));(Object.keys(p).length>0||Object.keys(O).length>0||Object.keys(D).length>0||Object.keys(P).length>0)&&c((A={entities:p,lists:O,charts:D,chartData:P},{type:a.GC_REMOVE_DATA_ACTION,payload:A}))}}},t.gcUpdateDataEntities=function(e){return{type:"garbage.collector.update.data.entities.sync",sync:!0,execute:function(t,r){for(var i,a,o=t.dispatch,u=t.getState,c=null===(a=r.DataLayerConfiguration.GarbageCollectionProvider)||void 0===a?void 0:a.getCurrentPage(),d={},f=0;f<e.length;f++){var p=n.Guid.toString(e[f].id),y=e[f].etn,h=l.getUpdatedRefCount(u(),y,p,c);if(h)if(d[y])d[y][p]=h;else{var v=((i={})[p]=h,i);d[y]=v}}Object.keys(d).length>0&&o(s({entities:d}))}}},t.gcUpdateData=s},e9z0:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.buildRetrieveRequestWithURLParams=t.buildRetrieveContract=void 0;var u=r("i2et"),l=a(r("rMjw")),s=r("XGkY"),c=r("UZ+8"),d=r("+u6Z"),f=r("Mx+d"),p=r("RHls"),y=r("xl8k"),h=r("vqTk"),v=r("uzdi"),m=r("0hOr");t.buildRetrieveContract=function(e,t,r,n,i){var a,g,_,E,O,b=[],N=[];try{for(var R=o(r),T=R.next();!T.done;T=R.next()){var A=T.value,S=m.getAttributeDescriptor(e,t.etn,A);if(!S)throw new p.ErrorStatus("Cannot serialize a request with no attribute metadata for "+t.etn+"."+A);if(S.Type===u.AttributeType.PartyList){if(!(O=f.getActivityPartyNavigationPropertyRelationship(e,t.etn))){E="The relationship for the partylist attribute "+A+" is not found in the state tree or is invalid";break}var D=d.getParticipationTypeMask(t.etn,A);if(void 0===D)throw new p.ErrorStatus("Unknown participation type mask for attribute "+A);N.push(D)}else S&&-1!==y.SupportedLookupProperties.indexOf(S.Type)?b.push("_"+A+"_value"):b.push(A)}}catch(e){a={error:e}}finally{try{T&&!T.done&&(g=R.return)&&g.call(R)}finally{if(a)throw a.error}}var C="";if(N.length){var P="$filter=Microsoft.Dynamics.CRM.In(PropertyName='participationtypemask',PropertyValues=["+N.map((function(e){return"'"+e+"'"}))+"])";C="&$expand="+O.ReferencedEntityNavigationPropertyName+"("+P+")"}var w=function(e,t,r,n){var i,a,s,p,h,v="",g=[];if(n){var _="";try{for(var E=o(n),O=E.next();!O.done;O=E.next()){var b=O.value,N=b.get_relationShipName(),R=b.get_columnNames(),T=[],A=f.getRelationShipByNavigationProperty(e,t.etn,N);if(A){var S=f.getRelationshipTypeByNavigationProperty(e,t.etn,N)===l.RelationshipType.OneToManyRelationship?A.ReferencingEntity:A.ReferencedEntity;try{for(var D=(s=void 0,o(R)),C=D.next();!C.done;C=D.next()){var P=C.value,w=m.getAttributeDescriptor(e,S,P);if(!w){h="Cannot serialize a request with no attribute metadata for "+S+"."+P;break}if(w.Type===u.AttributeType.PartyList){if(!f.getActivityPartyNavigationPropertyRelationship(e,S)){h="The relationship for the partylist attribute "+P+" is not found in the state tree or is invalid";break}var I=d.getParticipationTypeMask(S,P);if(void 0===I){h="Unknown participation type mask for attribute "+P;break}g.push(I)}else w&&-1!==y.SupportedLookupProperties.indexOf(w.Type)?T.push("_"+P+"_value"):T.push(P)}}catch(e){s={error:e}}finally{try{C&&!C.done&&(p=D.return)&&p.call(D)}finally{if(s)throw s.error}}}T&&T.length>0&&(_=c.IsNullOrUndefinedOrEmptyString(_)?N+"($select="+T.join(",")+")":_+","+N+"($select="+T.join(",")+")")}}catch(e){i={error:e}}finally{try{O&&!O.done&&(a=E.return)&&a.call(E)}finally{if(i)throw i.error}}v="&$expand="+_}if(h&&r){r.TraceManager.getTracer("RetrieveRequestSerializer").error(h)}return v}(e,t,n,i),I=new v.ODataRetrieveWithUrlParamsRequest(t.etn,s.Guid.toString(t.id),"?$select="+b.join(",")+C+w,((_={})[h.HEADER.PREFER]=h.HEADER_VALUES.ANNOTATIONS,_[h.HEADER.ACCEPT]=h.HEADER_VALUES.APPLICATION_JSON,_[h.HEADER.MSCRM_RETURN_NOTIFICATIONS]="true",_));return E&&n&&n.TraceManager.getTracer("RetrieveRequestSerializer").error(E),I},t.buildRetrieveRequestWithURLParams=function(e,t,r,n,i,a){var o,u=i&&"number"==typeof i?",odata.maxpagesize="+i:"",l={urlParameters:""+f.getEntitySetName(e,t)+(s.Guid.isNullOrEmpty(s.Guid.tryParse(r))?"":"("+r+")")+(n||""),additionalHeaders:(o={},o[h.HEADER.PREFER]=""+h.HEADER_VALUES.ANNOTATIONS+u,o[h.HEADER.ACCEPT]=h.HEADER_VALUES.APPLICATION_JSON,o[h.HEADER.MSCRM_RETURN_NOTIFICATIONS]="true",o),method:"GET"};return a&&"object"==typeof a&&Object.assign(l.additionalHeaders,a),l}},evga:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function u(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,u)}l((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.RETRIEVE_ROW_VERSION_HEADER=t.requestAdditionalMetadataForEntityRecord=t.buildCreateRequest=void 0;var a=r("RslU"),o=r("IvJe"),u=r("Mx+d"),l=r("vqTk");t.RETRIEVE_ROW_VERSION_HEADER="ReturnRowVersion",t.buildCreateRequest=function(e,t,r,n,i){var a;void 0===n&&(n=!0);var o={urlParameters:""+u.getEntitySetName(e,t),body:JSON.stringify(r),additionalHeaders:(a={},a[l.HEADER.ACCEPT]=l.HEADER_VALUES.APPLICATION_JSON,a[l.HEADER.MSCRM_SUPPRESS_DUPLICATION_DETECTION]=n.toString(),a),method:"POST"};return o&&o.additionalHeaders&&i&&(o.additionalHeaders.ReturnRowVersion="true"),o},t.requestAdditionalMetadataForEntityRecord=function(e){return{type:"REQUEST_ADDITIONAL_METADATA_FOR_ENTITY_RECORD",execute:function(t,r){var u=t.dispatch,l=t.getState;return n(this,void 0,void 0,(function(){var t;return i(this,(function(r){switch(r.label){case 0:return(t=o.getRelatedEntityLogicalNames(l(),e).reduce((function(e,t){return e[t]=[],e}),{}))[e.get_identifier().LogicalName]=o.getAttributeNamesWithNoMetadata(l(),e),[4,u(a.retrieveEntities(t))];case 1:return r.sent(),[2]}}))}))}}}},f6dx:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.REMOVE_ENTITY_RECORD_ACTION=t.REFRESH_RECORD_DATA_ACTION=t.RETRIEVE_RECORD_DATA_ACTION=t.RETRIEVE_LOOKUP_DATA_ACTION=t.GET_CLIENT_METADATA=t.GC_REMOVE_DATA_ACTION=t.RETRIEVE_ENTITY_METADATA=t.RETRIEVE_GRID_DATA_ACTION=void 0,t.RETRIEVE_GRID_DATA_ACTION="retrieve.grid.data.action",t.RETRIEVE_ENTITY_METADATA="retrieve.entity.metadata",t.GC_REMOVE_DATA_ACTION="gc.remove.data.action",t.GET_CLIENT_METADATA="get.client.metadata",t.RETRIEVE_LOOKUP_DATA_ACTION="retrieve.lookup.data.action",t.RETRIEVE_RECORD_DATA_ACTION="retrieve.record.data.action",t.REFRESH_RECORD_DATA_ACTION="refresh.record.data.action",t.REMOVE_ENTITY_RECORD_ACTION="remove.entity.record.action"},fr82:function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.XPathEvaluatorWrapper=void 0;var a=r("lqZx"),o=r("1LmJ"),u=r("s1MM"),l=r("/vtY"),s=r("UZ+8"),c=function(e){function t(t,r,n){var i=e.call(this)||this;return i._namespaces=null,i._evaluator=null,i._element=null,o.assert(!s.IsNullOrUndefined(t),"The XPathEvaluator should not be null"),i._evaluator=t,i._element=s.IsNullOrUndefined(r)?t:r,i._namespaces=s.IsNullOrUndefined(n)?{}:n,i}return i(t,e),t.prototype.get_innerText=function(){var e,t,r;return(null===(e=this._element)||void 0===e?void 0:e.hasChildNodes())?null===(r=null===(t=this._element)||void 0===t?void 0:t.firstChild)||void 0===r?void 0:r.nodeValue:null},t.prototype.get_outerXml=function(){return(new XMLSerializer).serializeToString(this._element)},t.prototype.get_tagName=function(){var e;return null===(e=this._element)||void 0===e?void 0:e.tagName},t.prototype.get_domParserElement=function(){return this._element},t.prototype.addNamespace=function(e,t){this._namespaces&&(this._namespaces[e]=t)},t.prototype.selectSingleNode=function(e){var r,n=null===(r=this._evaluator)||void 0===r?void 0:r.evaluate(e,this._element,null,u.XPathResultType.FIRST_ORDERED_NODE_TYPE,null);return s.IsNullOrUndefined(null==n?void 0:n.singleNodeValue)?null:new t(this._evaluator,null==n?void 0:n.singleNodeValue,this._namespaces)},t.prototype.selectNodes=function(e){var t;return new l.NodeSnapshotWrapper(this._evaluator,null===(t=this._evaluator)||void 0===t?void 0:t.evaluate(e,this._element,null,u.XPathResultType.ORDERED_NODE_SNAPSHOT_TYPE,null),this._namespaces)},t.prototype.getAttribute=function(e){var t;return null===(t=this._element)||void 0===t?void 0:t.getAttribute(e)},t.prototype.getElementsByTagName=function(e){var t;return new l.NodeSnapshotWrapper(this._evaluator,null===(t=this._element)||void 0===t?void 0:t.getElementsByTagName(e),this._namespaces)},t.prototype.childNodes=function(){var e;return new l.NodeSnapshotWrapper(this._evaluator,null===(e=this._element)||void 0===e?void 0:e.childNodes,this._namespaces)},t.prototype.hasChildNodes=function(){var e;return null===(e=this._element)||void 0===e?void 0:e.hasChildNodes()},t}(a.XmlNode);t.XPathEvaluatorWrapper=c},geC1:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o},a=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.getAttributeBindForOData=t.encodeURIComponentForOData=t.getEnumValueMetadata=t.serializeEntityType=t.transformToODataValue=t.buildEntityPayload=t.OutputFormat=t.ODataPrimitives=void 0;var o,u=r("i2et"),l=r("uCvz"),s=r("XGkY"),c=r("FHhg"),d=r("UZ+8"),f=r("gkFy"),p=r("+u6Z"),y=r("0hOr"),h=r("IvJe"),v=r("Mx+d");function m(e){var t=encodeURIComponent(e);if(-1!==t.indexOf("'")){return t.replace(/\'/g,"''")}return t}function g(e,t){var r=v.getActivityPartyNavigationPropertyRelationship(e,t);if(r&&r.ReferencedEntityNavigationPropertyName)return r.ReferencedEntityNavigationPropertyName}function _(e,t,r,n,i){var a,h,m,_;void 0===i&&(i=o.Server);var b=n.getValue(r);if(!e||!t||!r||void 0===b||i===o.Client&&null===b)return{};var N=null,R={},T=n.get_fieldTypes(),A=null;if(T[r]===u.AttributeType.AliasedValue){var S=b;N=S.get_attributeType(),R[r+"@OData.Community.Display.V1.AttributeName"]=S.get_attributeLogicalName(),A=y.getAttributeDescriptor(e,S.get_entityLogicalName(),S.get_attributeLogicalName()),b=S.get_value()}else{if(!(A=y.getAttributeDescriptor(e,t,r)))return{};N=A.Type}switch(N){case u.AttributeType.MultiSelectPickList:if(d.IsNullOrUndefined(b))return{};var D=b.length>0?b.join(","):null;if(D&&i===o.Client){var C=A.OptionSet?null==A?void 0:A.OptionSet.length:0;R[f.getFormattedValueAnnotation(r)]=b.map((function(e){for(var t,r,n,i,a=0;a<C;a++)if(e===(null===(r=null===(t=null==A?void 0:A.OptionSet)||void 0===t?void 0:t[a])||void 0===r?void 0:r.Value))return null===(i=null===(n=null==A?void 0:A.OptionSet)||void 0===n?void 0:n[a])||void 0===i?void 0:i.Label;return""})).join(";")}return R[r]=D,R;case u.AttributeType.PartyList:if(d.IsNullOrUndefined(b))return{};var P=b.get_entities(),w=g(e,t);if(!w)return{};var I=p.getParticipationTypeMask(t,r),M=P.map((function(t){var r=t.getValue("partyid"),n=t.getValue("activitypartyid"),i=n?n.toString():null,a=c.EntityReference.fromLegacyEntityReference(r);return O(e,I,a,i)}));return R[w]=M,R;case u.AttributeType.Boolean:if(d.IsNullOrUndefined(b))return{};var F=b.get_ValueString();return i===o.Client&&(R[f.getFormattedValueAnnotation(r)]=b.get_Label()),R[r]="0"===F||"1"===F?"1"===F:null,R;case u.AttributeType.PickList:case u.AttributeType.State:case u.AttributeType.Status:return d.IsNullOrUndefined(b)?{}:(i===o.Client&&(R[f.getFormattedValueAnnotation(r)]=b.get_Label()),R[r]=b.getValue("value"),R);case u.AttributeType.Customer:case u.AttributeType.Lookup:case u.AttributeType.Owner:var x=f.getLookupPropertyName(r);if(d.IsNullOrUndefined(b))return(a={})[x]=null,a;var L=b,U=v.getEntitySetName(e,L.LogicalName),k=null===(m=s.Guid.fromLegacyGuid(L.Id))||void 0===m?void 0:m.guid,V=null;if(N===u.AttributeType.Owner&&(V=v.getManyToOneRelationshipByReferencedEntity(e,t,"owner",r)),d.IsNullOrUndefined(V)&&(V=v.getManyToOneRelationshipByReferencedEntity(e,t,L.LogicalName,r)),N===u.AttributeType.Owner&&d.IsNullOrUndefined(V))return{};if(d.IsNullOrUndefined(V))throw new Error("Unable to find many-to-one relationship, entity: "+t+", referenced entity: "+L.LogicalName+", field: "+r);return i===o.Server?R[E(V.ReferencingEntityNavigationPropertyName)]="/"+U+"("+k+")":(R[f.getFormattedValueAnnotation(x)]=L.Name,R[f.getLookupLogicalNameAnnotation(x)]=L.LogicalName,R[x]=k),R;case u.AttributeType.UniqueIdentifier:return d.IsNullOrUndefined(b)?{}:(R[r]=null===(_=s.Guid.fromLegacyGuid(b))||void 0===_?void 0:_.guid,R);case u.AttributeType.Date:case u.AttributeType.DateTime:if(d.IsNullOrUndefined(b))return(h={})[r]=null,h;if(A.Behavior===l.DateTimeFieldBehavior.DateOnly&&"function"==typeof b.toISOString){var j=b.toISOString().match(/(\d{4}-\d{2}-\d{2})T\d{2}\:\d{2}\:\d{2}\.\d{3}[+-Z]/i);j[1]&&(i===o.Client&&(R[f.getFormattedValueAnnotation(r)]=n.getFormattedValue(r)),R[r]=j[1])}else i===o.Client?(R[f.getFormattedValueAnnotation(r)]=n.getFormattedValue(r),R[r]=b.toISOString().replace(/.\d{3}Z/,"Z")):R[r]=b;return R;case u.AttributeType.Money:case u.AttributeType.Decimal:case u.AttributeType.Double:case u.AttributeType.Integer:case u.AttributeType.BigInt:if(i===o.Client){if(d.IsNullOrUndefined(b))return{};R[f.getFormattedValueAnnotation(r)]=n.getNumericFormattedValue(r)}return R[r]=b,R;default:return R[r]=b,R}}function E(e){return e+"@odata.bind"}function O(e,t,r,n){var i,a=r.id.guid,o=r.etn;if("unresolvedaddress"===o){var u={addressused:r.name,participationtypemask:t};return d.IsNullOrUndefined(n)||(u.activitypartyid=n),u}var l=v.getEntitySetName(e,o),s=v.getActivityPartyNavigationPropertyRelationship(e,o);if(d.IsNullOrUndefined(s))throw new Error("Unable to find one-to-many relationship, entity: "+o+", referencing entity: activityparty");var c=((i={})[s.ReferencingEntityNavigationPropertyName+"@odata.bind"]="/"+l+"("+a+")",i.participationtypemask=t,i);return d.IsNullOrUndefined(n)||(c.activitypartyid=n),c}t.ODataPrimitives=["Edm.Boolean","Edm.String","Edm.Byte","Edm.Decimal","Edm.Double","Edm.Int16","Edm.Int32","Edm.Int64","Edm.SByte","Edm.Single","Edm.Date","Edm.Guid","Edm.DateTimeOffset","Edm.Duration","Edm.Stream","Edm.Binary","Edm.TimeOfDay","Edm.Geography","Edm.GeographyPoint","Edm.GeographyLineString","Edm.GeographyPolygon","Edm.GeographyMultiPoint","Edm.GeographyMultiLineString","Edm.GeographyMultiPolygon","Edm.GeographyCollection","Edm.Geometry","Edm.GeometryPoint","Edm.GeometryLineString","Edm.GeometryPolygon","Edm.GeometryMultiPoint","Edm.GeometryMultiLineString","Edm.GeometryMultiPolygon","Edm.GeometryCollection"],function(e){e[e.Server=0]="Server",e[e.Client=1]="Client"}(o||(o={})),t.OutputFormat=o,t.serializeEntityType=function(e,t,r,n){if(void 0===r&&(r=!1),void 0===n&&(n=!1),d.IsNullOrUndefined(t))return"null";if("object"==typeof t&&"entityType"in t&&"id"in t){var i=function(e,t,r){var n;if(r){var i=v.getEntityDescriptor(e,t.entityType);return(n={"@odata.type":"Microsoft.Dynamics.CRM."+t.entityType})[i.PrimaryKeyName]=s.Guid.fromExternalGuid(t.id).guid,n}return{"@odata.id":v.getEntitySetName(e,t.entityType)+"("+s.Guid.fromExternalGuid(t.id).guid+")"}}(e,t,r),a=JSON.stringify(i);return n?m(a):a}var o=JSON.stringify(t);return n?m(o):o},t.encodeURIComponentForOData=m,t.getEnumValueMetadata=function(e,t){return null!=e&&t&&t.enumProperties&&t.enumProperties.length?t.enumProperties.filter((function(t){return t.value===e}))[0]:null},t.buildEntityPayload=function e(t,r,i){var u,l,d,f;void 0===i&&(i=o.Server);var y=r.get_identifier(),m=y.LogicalName,E=[];if(r)if(i===o.Server){var b=r.get_changedFieldNames();b&&(E=b)}else E=r.get_fieldNames();var N=E.reduce((function(e,n){var a=_(t,m,n,r,i),o=Object.keys(e),u=Object.keys(a)[0];return o&&-1!==o.indexOf(u)&&a[u]&&a[u].length?(e[u]=e[u].concat(a[u]),e):Object.assign(a,e)}),{}),R=v.getEntityDescriptor(t,m);if(R&&R.IsActivity){var T=p.getPartyListAttributeNames(m),A=E.filter((function(e){return T.indexOf(e)>-1})),S=T.filter((function(e){return-1===A.indexOf(e)}));if(A.length&&S.length){var D=[],C=null===(f=h.createRecordSelector(c.EntityReference.fromLegacyEntityReference(y)))||void 0===f?void 0:f(t,m);if(C&&C.fields){try{for(var P=n(S),w=P.next();!w.done;w=P.next()){var I=w.value;if(I in C.fields){var M=C.fields[I].list.map((function(e){var r,n,i,a,o,u=(null===(r=e.fields)||void 0===r?void 0:r.participationtypemask)?Number((null===(n=e.fields)||void 0===n?void 0:n.participationtypemask).valueString):0,l=null===(i=e.fields)||void 0===i?void 0:i.partyid,d=null===(a=e.fields)||void 0===a?void 0:a.activitypartyid,f=d&&!s.Guid.isNullOrEmpty(d.id)?s.Guid.toString(d.id):void 0,p=l?l.reference:new c.EntityReference("unresolvedaddress",s.Guid.EMPTY,(null===(o=e.fields)||void 0===o?void 0:o.addressused).value);return O(t,u,p,f)}));D.push.apply(D,a(M))}}}catch(e){u={error:e}}finally{try{w&&!w.done&&(l=P.return)&&l.call(P)}finally{if(u)throw u.error}}}var F=g(t,m);F&&(N[F]?(d=N[F]).push.apply(d,a(D)):0!==D.length&&(N[F]=D))}}var x=r.get_relatedEntities();return i===o.Client&&x&&x.get_entityCollections()&&x.get_entityCollections().forEach((function(r){var n=r.get_value().get_entities().map((function(r){return e(t,r,i)})),a=n&&1===n.length&&v.getManyToOneRelationshipByNavigationProperty(t,m,r.get_key().get_schemaName())?n[0]:n;N[r.get_key().get_schemaName()]=a})),N},t.transformToODataValue=_,t.getAttributeBindForOData=E},gkFy:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function u(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,u)}l((n=n.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},l=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.uniqueMerge=t.PayloadFormat=t.getFormattedValueAnnotation=t.getLookupLogicalNameAnnotation=t.getLookupPropertyName=t.determineReturnedColumn=t.determineReturnedColumns=t.createEntityRecordFromResponseAsync=t.createEntityRecordFromResponse=t.REMOVE_NOTIFICATIONS=t.ADD_NOTIFICATIONS=void 0;var s,c=r("i2et"),d=a(r("rMjw")),f=r("XGkY"),p=r("EY1R"),y=r("RslU"),h=r("FHhg"),v=r("UZ+8"),m=r("AYBo"),g=r("VmZv"),_=r("WSZO"),E=r("N/D8"),O=r("AHn5"),b=r("+u6Z"),N=r("0hOr"),R=r("Mx+d"),T=r("uCvz");function A(e,t,r,n,i,a,o,u,p,y,m){void 0===y&&(y=s.OData);var _=o||r?r.PrimaryIdAttribute:void 0;i||(i=D(t,y)),-1===i.indexOf("versionnumber")&&t.hasOwnProperty("@odata.etag")&&i.push("versionnumber");var E=_&&"string"==typeof t[_]?new f.Guid(t[_]):f.Guid.EMPTY,T=new h.EntityReference(r.EntityLogicalName,E),A=h.EntityReference.toLegacyEntityReference(T),S=null;u&&!v.IsNullOrUndefined(u)&&(S=u.aliasedValueDescriptors);var C=function(e,t,r,n,i,a,o,u,p){var y,m,_;void 0===p&&(p=s.OData);var E={fieldTypes:{},formattedValues:{},numericFormattedValues:{},fields:{}},T=function(t){if(v.IsNullOrUndefinedOrEmptyString(t)){var y=[{name:"EntityLogicalName",value:null!=r?r.EntityLogicalName:"null"}];return o&&o.warn("Empty field name encountered while trying to construct entity record",y),"continue"}if("versionnumber"===t){var m=c.AttributeType.BigInt;E.fields[t]=M(e,i,t,m,r,n,!1,a,o,p),E.fieldTypes[t]=m}else if(u&&i&&i.hasOwnProperty(t)&&i[t]&&u.filter((function(e){return e.get_relationShipName()===t})).length>0)!function(e,t,r,n,i,a,o){var u,s,p,y,v,m,_,E;if(o)try{for(var b=l(o),T=b.next();!T.done;T=b.next()){var A=T.value,S=void 0,D=A.get_relationShipName();if(D===t){var C=R.getRelationShipByNavigationProperty(e,r.EntityLogicalName,D);if(C){var P=R.getRelationshipTypeByNavigationProperty(e,r.EntityLogicalName,D),w=P===d.RelationshipType.OneToManyRelationship?C.ReferencingEntity:C.ReferencedEntity,I=A.get_columnNames(),F=N.getAttributesForEntity(e,w);if(F){var x=[],L=R.getEntityDescriptor(e,w),U=null==L?void 0:L.PrimaryKeyName;if(P===d.RelationshipType.OneToManyRelationship){var k=n[D];try{for(var V=(p=void 0,l(k)),j=V.next();!j.done;j=V.next()){var q=j.value,G={fieldTypes:{},formattedValues:{},numericFormattedValues:{},fields:{}},H=new f.Guid(q[U]),B=new h.EntityReference(null==L?void 0:L.EntityLogicalName,H),X=h.EntityReference.toLegacyEntityReference(B);if(I)try{for(var z=(v=void 0,l(I)),Y=z.next();!Y.done;Y=z.next()){var W=Y.value;if(F.hasOwnProperty(W)){var Q=M(e,q,W,S=F[W].Type,L,F,!1,null,a);G.fields[W]=Q,G.fieldTypes[W]=S}}}catch(e){v={error:e}}finally{try{Y&&!Y.done&&(m=z.return)&&m.call(z)}finally{if(v)throw v.error}}var K=new g.EntityRecord(X,G.fields,G.fieldTypes,G.formattedValues,G.numericFormattedValues,new O.RelatedEntityCollection([]));x.push(K)}}catch(e){p={error:e}}finally{try{j&&!j.done&&(y=V.return)&&y.call(V)}finally{if(p)throw p.error}}}else if(P===d.RelationshipType.ManyToOneRelationship){q=n[D],G={fieldTypes:{},formattedValues:{},numericFormattedValues:{},fields:{}},H=new f.Guid(q[U]),B=new h.EntityReference(null==L?void 0:L.EntityLogicalName,H),X=h.EntityReference.toLegacyEntityReference(B);if(I)try{for(var Z=(_=void 0,l(I)),J=Z.next();!J.done;J=Z.next()){W=J.value;if(F.hasOwnProperty(W)){S=F[W].Type;Q=M(e,n[t],W,S,L,F,!1,null,a);G.fields[W]=Q,G.fieldTypes[W]=S}}}catch(e){_={error:e}}finally{try{J&&!J.done&&(E=Z.return)&&E.call(Z)}finally{if(_)throw _.error}}K=new g.EntityRecord(X,G.fields,G.fieldTypes,G.formattedValues,G.numericFormattedValues,new O.RelatedEntityCollection([]));x.push(K)}i.fields[D]=x,i.fieldTypes[D]=c.AttributeType.NavigationProperty}}}}}catch(e){u={error:e}}finally{try{T&&!T.done&&(s=b.return)&&s.call(b)}finally{if(u)throw u.error}}}(e,t,r,i,E,o,u);else{var T=!1,A=!!a&&a.hasOwnProperty(t);if(!A&&null==n[t])return"continue";var S=i.hasOwnProperty(F(t,i,a,A));if(S||(S=i.hasOwnProperty(L(t,p,A))),!S){var D=x(e,t,r,i,a,A);T=S=D&&i.hasOwnProperty(D)&&i[D].filter((function(e){return e.participationtypemask===b.getParticipationTypeMask(A&&a?a[t].aliasedValueEtn:r.EntityLogicalName,A&&a?a[t].aliasedValueFieldName:t)})).length>0}if(S){m=A?c.AttributeType.AliasedValue:n[t].Type;var C=!(!a||!(null===(_=a[t])||void 0===_?void 0:_.isAttributeAlias)),P=F(t,i,a,A&&C),w=!!(A&&a&&a[t]&&a[t].oDataAlias.length>1),U=F(t,i,a,w);E.fields[P]=M(e,i,U,m,r,n,T,A?a:null,o,p),E.fieldTypes[P]=m,function(e,t,r,n,i,a,o){if(i===s.OData){var u=I(t);n.hasOwnProperty(u)&&(r.formattedValues[t]=n[u])}}(0,U,E,i,p)}}};try{for(var A=l(t),S=A.next();!S.done;S=A.next()){T(S.value)}}catch(e){y={error:e}}finally{try{S&&!S.done&&(m=A.return)&&m.call(A)}finally{if(y)throw y.error}}return E}(e,i,r,n,t,S,p,m,y);return new g.EntityRecord(A,C.fields,C.fieldTypes,C.formattedValues,C.numericFormattedValues,new O.RelatedEntityCollection([]),a)}function S(e,t){var r,n,i=new Set(e||[]),a=e&&e.slice(0)?e.slice(0):[];if(t)try{for(var o=l(t),u=o.next();!u.done;u=o.next()){var s=u.value;i.has(s)||a.push(s)}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a}function D(e,t){void 0===t&&(t=s.OData);var r=Object.keys(e).reduce((function(e,r){return-1===r.indexOf("@")&&e.add(C(r,t)),e}),new Set);return Array.from(r)}function C(e,t){void 0===t&&(t=s.OData);var r=null;return(r=t===s.OData?e.match(/_(\w+)_value/i):e.match(/(\w+\.?\w+)!(id|name|logicalname)$/i))&&r[1]?r[1]:e}!function(e){e[e.OData=0]="OData",e[e.SQL=1]="SQL"}(s||(s={})),t.PayloadFormat=s,t.createEntityRecordFromResponse=A,t.createEntityRecordFromResponseAsync=function(e,t,r,n,i,a,c,f,h){return void 0===f&&(f=s.OData),{type:"CREATE_ENTITY_RECORD_FROM_RESPONSE_ASYNC",execute:function(s,v){var m=s.getState,g=s.dispatch;return o(this,void 0,void 0,(function(){var o,s,v,_,E;return u(this,(function(u){switch(u.label){case 0:return o=D(e,f),s=function(e,t,r,n,i,a){var o,u,s,c,f=S(r,n).filter((function(e){return-1===e.indexOf(".")}));f&&f.length>0?i?(c=i.entity2AttributesMap?i.entity2AttributesMap:{},p.addAttributes(c,t,f)):((o={})[t]=f,c=o):c={};if(a)try{for(var y=l(a),h=y.next();!h.done;h=y.next()){var v=h.value,m=v.get_relationShipName(),g=R.getRelationShipByNavigationProperty(e,t,m);if(g){var _=R.getRelationshipTypeByNavigationProperty(e,t,m)===d.RelationshipType.OneToManyRelationship?g.ReferencingEntity:g.ReferencedEntity,E=v.get_columnNames();p.addAttributes(c,_,E)}}}catch(e){u={error:e}}finally{try{h&&!h.done&&(s=y.return)&&s.call(y)}finally{if(u)throw u.error}}return c}(m(),t,r,o,a,h),[4,g(y.retrieveEntities(s))];case 1:return u.sent(),v=N.getAttributesForEntity(m(),t),_=R.getEntityDescriptor(m(),t),E=(r||[]).concat(s[t]?s[t].filter((function(e){return v.hasOwnProperty(e)})):[]),[2,A(m(),e,_,v,E,n,i,a,c,f,h)]}}))}))}}},t.uniqueMerge=S,t.determineReturnedColumns=D,t.determineReturnedColumn=C;t.ADD_NOTIFICATIONS="notifications.add";function P(e){return"_"+e+"_value"}function w(e){return e+"@Microsoft.Dynamics.CRM.lookuplogicalname"}function I(e){return e+"@OData.Community.Display.V1.FormattedValue"}function M(e,t,r,n,i,a,o,u,l,d){var p;void 0===d&&(d=s.OData);var y,g=L(r,d);if("versionnumber"===r&&d===s.OData&&t["@odata.etag"]){var O=t["@odata.etag"].match(/W\/\"([0-9a-zA-Z]+)\"/);if(O&&O[1])return O[1]}if(!(o||t.hasOwnProperty(r)||t.hasOwnProperty(g)||u))return null;var S=null;if(a&&a[r]&&-1!==[c.AttributeType.Lookup,c.AttributeType.Customer,c.AttributeType.Owner].indexOf(a[r].Type))u&&u.hasOwnProperty(r)&&(g=L(r,d,!0)),y=t[g];else if(a&&a[r]){var D=U(u,t,r),C=u&&u[r]&&u[r].oDataAlias&&u[r].oDataAlias[D]||r;if(S=u&&u[r]&&u[r].rowaggregate||null,y=t[C],u&&u[r]&&u[r].isAttributeAlias&&v.IsNullOrUndefined(S))return y}else y=t[r];if(!o&&null===y)return null;switch(n){case c.AttributeType.AliasedValue:if(u){var P=u[r],F=P.aliasedValueEtn,k=P.aliasedValueFieldName,V=R.getEntityDescriptor(e,F),j=N.getAttributeDescriptor(e,F,k),q=void 0;q=S&&"CountChildren"===S?c.AttributeType.Integer:null==j?void 0:j.Type;var G=new _.LegacyAliasedValue(F,k,q);return null==(y=M(e,t,r,q,V,((p={})[r]=j,p),o,u,l,d))?null:(G.set_value(y),G)}return null;case c.AttributeType.Customer:case c.AttributeType.Lookup:case c.AttributeType.Owner:var H=t[function(e,t,r){void 0===r&&(r=s.OData);return r===s.OData?w(t):e+"!logicalname"}(r,g,d)],B=t[function(e,t,r){void 0===r&&(r=s.OData);return r===s.OData?I(t):e+"!name"}(r,g,d)];if(H&&y)return h.EntityReference.toLegacyEntityReference(new h.EntityReference(H,new f.Guid(y),B));var X=[];return X.push({name:"EntityLogicalName",value:null==a[r]?"null":a[r].EntityLogicalName}),X.push({name:"Attribute Name",value:null==a[r]?"null":a[r].LogicalName}),X.push({name:"Lookup Field EntityLogicalName",value:null==H?"null":H}),X.push({name:"FieldValue",value:null==y?"null":y}),X.push({name:"lookupFormattedValue",value:null==B?"null":B}),function(e,t,r){null==r||r.error(e,t)}("_constructFieldValue: Lookup Field EntityLogicalName or FieldValue is null",X),null;case c.AttributeType.UniqueIdentifier:var z=f.Guid.tryParseOrNull(y);return z?f.Guid.toLegacyGuid(z):null;case c.AttributeType.DateTime:var Y=void 0;return d===s.OData&&(Y=a&&a[r]&&a[r].Behavior===T.DateTimeFieldBehavior.TimeZoneIndependent?y.replace(/-\d{2}:\d{2}$/,"Z"):y),v.IsNullOrUndefinedOrEmptyString(y)?null:new Date(Date.parse(Y));case c.AttributeType.Status:case c.AttributeType.State:case c.AttributeType.Boolean:case c.AttributeType.PickList:var W=t[I(r)],Q=void 0,K=a[r].OptionSet;return K&&(null==y&&K.DefaultValue&&-1!==K.DefaultValue&&(y=K.DefaultValue),null!=y&&(Q=K.find((function(e){return Number(e.Value)===Number(y)})))),Q?new E.OptionMetadata(W||Q.Label,Q.Value,null,null,null,Q.Color,null):new E.OptionMetadata(W,y,null,null,null,null,null);case c.AttributeType.PartyList:return function(e,t,r,n,i,a){void 0===a&&(a=!1);if(n&&n.OneToManyRelationships){var o=x(e,t,n,r,i,a);if(!o)return null;var u=r[o];if(!u)return null;var l=R.getEntityDescriptor(e,"activityparty"),s=N.getAttributesForEntity(e,"activityparty"),c=Object.keys(s),d=u.filter((function(e){return e.participationtypemask===b.getParticipationTypeMask(a?i[t].aliasedValueEtn:n.EntityLogicalName,a?i[t].aliasedValueFieldName:t)})).map((function(t){return A(e,t,l,s,c)}));return new m.EntityCollection(d,!1,d.length,!1,null,null)}return new m.EntityCollection([],!1,0,!1,null,null)}(e,r,t,i,u,null!=u&&null!=u[r]);default:return y}}function F(e,t,r,n){if(void 0===n&&(n=!1),n&&r&&r[e]){var i=U(r,t,e);return r[e].oDataAlias[i]}return e}function x(e,t,r,n,i,a){void 0===a&&(a=!1);var o=a?i[t].aliasedValueEtn:r.EntityLogicalName,u=R.getActivityPartyNavigationPropertyRelationship(e,o);if(!u)return null;if(a){var l=U(i,n,t);return""+i[t].alias+i[t].oDataSeparator[l]+u.ReferencedEntityNavigationPropertyName}return""+u.ReferencedEntityNavigationPropertyName}function L(e,t,r){return void 0===t&&(t=s.OData),void 0===r&&(r=!1),t===s.OData?r?e:P(e):e+"!id"}function U(e,t,r){if(e&&e.hasOwnProperty(r)&&e[r].oDataAlias.length>0)for(var n=0;n<e[r].oDataAlias.length;n++)if(t.hasOwnProperty(e[r].oDataAlias[n]))return n;return 0}t.REMOVE_NOTIFICATIONS="notification.remove",t.getLookupPropertyName=P,t.getLookupLogicalNameAnnotation=w,t.getFormattedValueAnnotation=I},iDsU:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyColumnSet=void 0;var n=r("iWcK"),i=function(){function e(e){this._columns=e}return e.prototype.get_Columns=function(){return this._columns},e.prototype.get_isEmpty=function(){return!(this._columns.length>0)},e.prototype.getObjectData=function(){var e={};return e.columns=this._columns,e},e.prototype.getDifference=function(t){var r=this;return t instanceof n.AllColumns?t:new e(t.get_Columns().filter((function(e){return r.get_Columns().indexOf(e)<0})))},e.createFromObjectData=function(t){return new e(t.columns)},e}();t.LegacyColumnSet=i},iWcK:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AllColumns=void 0;var n=r("iDsU"),i=function(){function e(){}return e.prototype.get_isEmpty=function(){return!1},e.prototype.getDifference=function(e){return new n.LegacyColumnSet(new Array(0))},e.get_instance=function(){return e._instance||(e._instance=new e)},e._instance=null,e}();t.AllColumns=i},ink8:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CachePriority=void 0,function(e){e[e.Workspace=0]="Workspace",e[e.Medium=1]="Medium",e[e.NotCached=2]="NotCached"}(t.CachePriority||(t.CachePriority={}))},jLS2:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.serializeAccessRights=void 0;var n=r("XGkY");t.serializeAccessRights=function(e){var t={recordPrivileges:e.get_accessRights()},r=e.get_userSharedAttributePrivileges();if(r){var i={};for(var a in r){var o=r[a];i[a]={accessRightsMask:o.get_AccessRightsMask(),attributeId:n.Guid.fromLegacyGuid(o.get_AttributeId()),canCreate:o.get_CanCreate(),canRead:o.get_CanRead(),canUpdate:o.get_CanUpdate()}}t.attributePrivileges=i}return t}},l7wu:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.RETRIEVE_GRID_DATA=t.PREFIX=t.MDL_COMPONENT_NAMES=t.MDL_ID=void 0,t.MDL_ID="ModernDataLayer",t.MDL_COMPONENT_NAMES={ODataBuilder:t.MDL_ID+".ODataBuilder",ModernDataSource:t.MDL_ID+".ModernDataSource",ExpressionRuntime:t.MDL_ID+".ExpressionRuntime",QueryBuilder:t.MDL_ID+".QueryBuilder",UserContext:t.MDL_ID+".UserContext",AuthenticationProvider:t.MDL_ID+".AuthenticationProvider"},t.PREFIX={ODataBuilder:"ODataBuilder",ModernDataSource:"ModernDataSource",ExpressionRuntimeHost:"ExpressionRuntimeHost",ModernQueryBuilder:"ModernQueryBuilder"},t.RETRIEVE_GRID_DATA="RetrieveGridData"},lqZx:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XmlNode=void 0;var n=function(){function e(){}return e.createAttribute=function(e,t,r){if(e){var n=e.createAttribute(t);return n.value=r,n}return null},e}();t.XmlNode=n},mE2v:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.getHttpHeader=void 0,t.getHttpHeader=function(e,t){if(!e)return null;var r=e.get(t);return r||(r=e.get(t.toLowerCase())),r}},mVtf:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseXmlDocument=t.create=void 0;var n=r("JH5K"),i=r("NgZN"),a=r("fr82"),o=r("0f0B"),u=r("UZ+8"),l=r("SJSp"),s=o.XmlEvaluatorType.undefined;function c(){return s}function d(e){return s=e,e}t.create=function(e){return u.IsNullOrUndefined(e)?null:(c()===o.XmlEvaluatorType.undefined&&function(e){if(function(e){var t=document.evaluate,r=document.createNSResolver&&document.createNSResolver(e),n=!1;return!u.IsNullOrUndefined(t)&&r&&!n}(e)){var t=new a.XPathEvaluatorWrapper(e);try{t.selectSingleNode("/root"),d(0)}catch(e){}}c()===o.XmlEvaluatorType.undefined&&(r=window.DOMParser,u.IsNullOrUndefined(r)||d(o.XmlEvaluatorType.domParser));var r;c()===o.XmlEvaluatorType.undefined&&n.throwOnNullOrUndefinedArgument(c(),"PreferredXmlEvaluator")}(e),c()?new i.DOMParserNodeWrapper(e):new a.XPathEvaluatorWrapper(e))},t.parseXmlDocument=function(e){var t=l.ParseXml(e);if(null!=t){var r=t.getElementsByTagName("parsererror");!u.IsNullOrUndefined(r)&&r.length>0&&(t=null)}return t}},n8WZ:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function u(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,u)}l((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.parseJsonResponse=t.retrieve=t.retrieveMultiple=t.execute=t.MDS_EVENT_PARAMETERS=void 0;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a=r("bOB9"),o=r("Y0ua"),u=r("H+3G"),l=r("Wysk"),s=r("EY1R"),c=r("RslU"),d=r("vqTk"),f=r("A64d"),p=r("4/PP"),y=r("3v6g"),h=r("aiEo"),v=r("e9z0"),m=r("gkFy"),g=r("rRZs"),_=r("RHls"),E=r("SJSp"),O=r("mE2v"),b=r("8xE/"),N=r("l7wu");function R(e,t,r){return n(this,void 0,void 0,(function(){var n,a;return i(this,(function(i){switch(i.label){case 0:return n={TraceManager:r.TraceManager,EventManager:r.EventManager,SqlExecutor:{}},a=D(e),null==t||t.info(P()+" Execute the request in Modern Data Layer Component"),[4,new l.ODataExecutor({},n).execute(a)];case 1:return[2,i.sent()]}}))}))}function T(e,t,r,a){var l,s;return n(this,void 0,void 0,(function(){var n,c,d;return i(this,(function(i){switch(i.label){case 0:return n=performance.now(),c=null===(s=(l=a.EventManager).getScenarioTracker)||void 0===s?void 0:s.call(l,o.ScenarioType.Load,"Storage:ModernDataLayer"),function(e,t){t.push({name:o.EVENT_PARAMETERS.CLIENT_REQUEST_ID,value:w(e)}),t.push({name:o.EVENT_PARAMETERS.CLIENT_TYPE,value:"remote"});var r=u.getRequestType(D(e));t.push({name:o.EVENT_PARAMETERS.OPERATION_TYPE,value:r})}(e,[]),[4,R(e,r,a)];case 1:return d=i.sent(),[2,A(t(),d,e,n,a,r,!1,c)]}}))}))}function A(e,r,u,l,s,c,f,p){return n(this,void 0,void 0,(function(){var e,n,h,v;return i(this,(function(i){switch(i.label){case 0:return e=performance.now()-l,(n=[]).push({name:o.EVENT_PARAMETERS.RESPONSE_TIME,value:e}),function(e,r,n,i){void 0===i&&(i=!1);var u=e.headers?O.getHttpHeader(e.headers,d.HEADER.SERVER_REQUEST_ID):a.UNKNOWN,l=e.status?e.status:null,s=e.type?e.type:null,c=e.statusText?e.statusText:a.UNKNOWN,f=e.url?g.trimUrl(e.url):a.UNKNOWN,p=e.headers?O.getHttpHeader(e.headers,d.HEADER.CONTENT_LENGTH):a.UNKNOWN;g.canLogDetailsOfRequest(e.url)&&r.push({name:o.EVENT_PARAMETERS.RESPONSE_URL,value:f});r.push({name:o.EVENT_PARAMETERS.HTTP_STATUS_CODE,value:l}),r.push({name:o.EVENT_PARAMETERS.HTTP_RESPONSE_TYPE,value:s}),r.push({name:o.EVENT_PARAMETERS.HTTP_RESPONSE_STATUS_TEXT,value:c}),r.push({name:o.EVENT_PARAMETERS.SERVER_REQUEST_ID,value:u||a.UNKNOWN}),r.push({name:o.EVENT_PARAMETERS.RESPONSE_SIZE_IN_BYTES,value:p||a.UNKNOWN}),r.push({name:t.MDS_EVENT_PARAMETERS.IS_BATCH_REQUEST,value:i}),r.push({name:t.MDS_EVENT_PARAMETERS.IS_EXPRESSION_RUNTIME_REQUEST,value:n})}(r,n,f,"$batch"===u.urlParameters),r.ok?(null==p||p.complete(n),s.EventManager.ReportComponentSuccess("Storage:ModernDataLayer",n),[2,r]):[3,1];case 1:return r.url&&-1!==r.url.indexOf("$batch")||u&&u.urlParameters&&-1!==u.urlParameters.indexOf("$batch")?[4,y.parseBatchResponse(r)]:[3,3];case 2:return(h=i.sent()).length>0&&(v=h.find((function(e){return!e.ok})))?[2,S(v,s,n,c,p)]:(c&&c.error("Batch response parsing has failed",n),[2,S(r,s,n,c,p)]);case 3:return null==c||c.error(P()+" Modern Data Layer component returns Error Response - Convert error to CRM Error.",n),[2,S(r,s,n,c,p)]}}))}))}function S(e,r,o,u,l){return n(this,void 0,void 0,(function(){var n,s,c,d,f,y;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e.text()];case 1:return s=i.sent(),n=p.deserializeErrorResponse(s,e,o,u),g.canLogDetailsOfRequest(e.url)&&(o.push({name:"Odata-Error-Response-Complete-text",value:s}),o.push({name:"Crm-Error-Response-From-OdataResponse",value:JSON.stringify(n)})),c=n.message||"Request Failure",o.push({name:t.MDS_EVENT_PARAMETERS.CRM_ERROR_CODE,value:n.errorCode}),n.stack&&o.push({name:t.MDS_EVENT_PARAMETERS.CRM_CALL_STACK,value:n.stack}),o.push({name:t.MDS_EVENT_PARAMETERS.CRM_ERROR_MESSAGE,value:c}),d=e?e.status:null,[400,404,500,503].indexOf(d)>-1&&!b.isNonReportableErrorCode(n.errorCode)?(f=new _.ErrorStatus(c,n.errorCode,void 0,null,null,null,null,o,null,null,null,!1,-1,null,d,n.clientRequestId,n.serverResponseId),null==l||l.failure(o),r.EventManager.ReportComponentFailure("Storage:ModernDataLayer",f,void 0,o)):null==u||u.error(c,o),[3,3];case 2:throw i.sent(),null==u||u.error(P()+" Modern Data Layer component : Exception occurred while creating error response.",o),y=b.ErrorCodes.unknownInternalServerError,new _.ErrorStatus(a.UNKNOWN,y);case 3:throw n}}))}))}function D(e){return{url:e.urlParameters,method:e.method,additionalHeaders:e.additionalHeaders,body:e.body}}function C(e,t,r){return n(this,void 0,void 0,(function(){var n;return i(this,(function(i){if(null==r||r.AppendCallStack("WebAPIService.parseJsonResponse"),e)return(n=O.getHttpHeader(e.headers,d.HEADER.CONTENT_TYPE))&&n.indexOf("text/html")>-1?(null==r||r.AppendCallStack("WebAPIService.response.text"),[2,e.text().then((function(r){throw p.deserializeErrorResponse(r,e,[],t)}))]):(null==r||r.AppendCallStack("WebAPIService.response.json"),[2,e.json()]);throw new _.ErrorStatus("Null response from server")}))}))}function P(e){return"["+(e||N.PREFIX.ModernDataSource)+"]"}function w(e){var t;return(null===(t=null==e?void 0:e.additionalHeaders)||void 0===t?void 0:t[d.HEADER.CLIENT_REQUEST_ID])||a.UNKNOWN}t.MDS_EVENT_PARAMETERS={CRM_ERROR_CODE:"Crm-Error-Code",CRM_ERROR_MESSAGE:"Crm-Error-Message",CRM_CALL_STACK:"Crm-Call-Stack",IS_BATCH_REQUEST:"IsBatchRequest",IS_EXPRESSION_RUNTIME_REQUEST:"IS_EXPRESSION_RUNTIME_REQUEST",IS_ERROR_IN_OFFLINE:"ErrorInOffline",ODATA_ERROR_RESPONSE_IS_HTML_TYPE:"Odata-Error-Response-Is-Html-Type"},t.execute=function(e,t,r){return{type:"modernDataSource.execute.odata.async",execute:function(t,r){var a=t.getState,o=t.dispatch;return n(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return(t=r.TraceManager.getTracer(N.MDL_COMPONENT_NAMES.ModernDataSource)).info(P()+" Execute legacy request."),[4,o(s.requestAdditionalMetadataForRequest(e))];case 1:return n.sent(),[4,o(f.fromODataContract(e))];case 2:return[2,T(n.sent(),a,t,r)]}}))}))}}},t.retrieveMultiple=function(e){return{type:"moderndatasource.retrievemultiple.async",execute:function(t,r){var a=t.getState,o=t.dispatch;return n(this,void 0,void 0,(function(){var t,n,u,l,s;return i(this,(function(i){switch(i.label){case 0:return(t=r.TraceManager.getTracer(N.MDL_COMPONENT_NAMES.ModernDataSource)).info(P()+" Retrieve multiple is executing"),n=E.getAttributesMapFromFetch(null==e?void 0:e.fetchXml),[4,o(c.retrieveEntities(n))];case 1:return i.sent(),[4,o(f.fromQueryState(e))];case 2:return u=i.sent(),l=h.parseFetchXmlForAliasedValues(null==e?void 0:e.fetchXml),[4,T(u,a,t,r)];case 3:return[4,C(i.sent(),t)];case 4:return s=i.sent(),[2,h.deserializeEntityCollection(a(),e,l,s)]}}))}))}}},t.retrieve=function(e,t){return{type:"moderndatasource.retrieve.async",execute:function(r,a){var o=r.getState,u=r.dispatch;return n(this,void 0,void 0,(function(){var r,n;return i(this,(function(i){switch(i.label){case 0:return(r=a.TraceManager.getTracer(N.MDL_COMPONENT_NAMES.ModernDataSource)).info(P()+" Retrieve is executing"),[4,u(c.retrieveEntity(e.etn,!0))];case 1:return i.sent(),[4,u(f.fromODataContract(v.buildRetrieveContract(o(),e,t)))];case 2:return[4,T(i.sent(),o,r,a)];case 3:return[4,C(i.sent(),r)];case 4:return n=i.sent(),[4,u(m.createEntityRecordFromResponseAsync(n,e.etn,t,void 0,void 0,void 0,r))];case 5:return[2,i.sent()]}}))}))}}},t.parseJsonResponse=C},nRuH:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.UCIContext=void 0;var a=function(e){function t(t,r){void 0===r&&(r=!1);var n=e.call(this,t)||this;return n._isPreloadCall=!1,n.requestId=t,n._isPreloadCall=r,n}return i(t,e),t.prototype.RequestId=function(){return this.requestId},t.prototype.IsPreloadCall=function(){return this._isPreloadCall},t.prototype.toString=function(){return"["+this.RequestId()+"]"},t}(r("0DNP").CallingContext);t.UCIContext=a},oMGx:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function u(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,u)}l((n=n.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.isODataContract=t.isChangeSet=t.buildRequest=t.executeMultiple=void 0;var l=r("FHhg"),s=r("n8WZ"),c=r("evga"),d=r("DepX"),f=a(r("bMRw")),p=r("uzdi"),y=r("3v6g"),h=r("e9z0"),v=r("CGvr"),m=r("54+h");t.executeMultiple=function(e){return{type:"executeOData.batch.async",execute:function(t){var r=t.dispatch;return o(this,void 0,void 0,(function(){var t,n;return u(this,(function(i){switch(i.label){case 0:return t=new p.ODataExecuteMultipleRequest(e),[4,r(s.execute(t))];case 1:return n=i.sent(),[2,y.parseBatchResponse(n)]}}))}))}}},t.buildRequest=function(e,t){if(!t)return{serializationFailure:"Cannot build the serialized request: the request object is empty"};if(!t.getMetadata())return{serializationFailure:"Cannot build the serialized request: the request object does not contain metadata definition"};switch(t.getMetadata().operationType){case f.ODataOperationType.Function:return m.buildFunctionRequest(e,t);case f.ODataOperationType.CRUD:return function(e,t){switch(t.getMetadata().operationName){case"Create":var r=t;return c.buildCreateRequest(e,r.etn,r.payload,r.suppressDupeDetection);case"RetrieveWithUrlParams":var n=t;return h.buildRetrieveRequestWithURLParams(e,n.etn,n.id,n.urlParams,n.maxPageSize,n.headers);case"Update":var i=t;return v.buildUpdateRequest(e,i.etn,i.id,i.payload,i.suppressDupeDetection,null,!1,i.urlParams,i.headers,i.isBinaryPayload);case"Delete":var a=t,o=l.EntityReference.fromExternalEntityReference(a.entityReference);return d.buildDeleteRequest(e,o,null,a.attributeName);default:return{serializationFailure:"Cannot convert ODataContract with "+t.getMetadata().operationName+" operation into a serialized request"}}}(e,t);default:return{serializationFailure:"Cannot build the serialized request: the operation type is not supported"}}},t.isODataContract=function(e){return e&&e.getMetadata},t.isChangeSet=function(e){return e&&Array.isArray(e)&&e.length>0&&e[0].getMetadata}},pdzI:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n;Object.defineProperty(t,"__esModule",{value:!0}),t.isDataUsable=t.InitState=void 0,function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized",e[e.Refreshing=3]="Refreshing",e[e.Error=4]="Error",e[e.Partial=5]="Partial"}(n||(n={})),t.InitState=n,t.isDataUsable=function(e){return e===n.Initialized||e===n.Refreshing}},qIJm:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConcurrencyBehavior=void 0,function(e){e[e.Default=0]="Default",e[e.IfRowVersionMatches=1]="IfRowVersionMatches",e[e.AlwaysOverwrite=2]="AlwaysOverwrite"}(t.ConcurrencyBehavior||(t.ConcurrencyBehavior={}))},rRZs:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.canLogDetailsOfRequest=t.trimUrl=void 0;var n=r("UZ+8");function i(e){return!n.IsNullOrUndefined(e)&&(-1!==e.indexOf("GetClientMetadata")||-1!==e.indexOf("EntityDefinitions")||-1!==e.indexOf("SyncClientMetadata"))}t.trimUrl=function(e){if(n.IsNullOrUndefined(e))return e;if(i(e))return e;if(-1!==e.indexOf("fetchXml=")){var t=e.indexOf("fetchXml="),r=decodeURIComponent(e.substring(e.indexOf("fetchXml=")+"fetchXml=".length,e.length));return e.substring(0,t+"fetchXml=".length)+function(e){var t=new DOMParser,r=new XMLSerializer,n="X";if(e){var i=t.parseFromString(e,"text/xml");if(i){var a=Array.prototype.slice.call(i.getElementsByTagName("condition"));return a&&a.forEach((function(e){e.getAttribute("value")&&e.setAttribute("value",n),e.getAttribute("uiname")&&e.setAttribute("uiname",n);var t=Array.prototype.slice.call(e.getElementsByTagName("value"));t&&t.forEach((function(e){e.getAttribute("uiname")&&e.setAttribute("uiname",n),e.textContent=n}))})),r.serializeToString(i)}return null}return null}(r)}var a=e.indexOf("?");if(-1===a){var o=e.indexOf("=");return-1===o?e:e.substring(0,o)}return e.substring(0,a)},t.canLogDetailsOfRequest=i},s1MM:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XPathResultType=void 0,function(e){e[e.ANY_TYPE=0]="ANY_TYPE",e[e.NUMBER_TYPE=1]="NUMBER_TYPE",e[e.STRING_TYPE=2]="STRING_TYPE",e[e.BOOLEAN_TYPE=3]="BOOLEAN_TYPE",e[e.UNORDERED_NODE_ITERATOR_TYPE=4]="UNORDERED_NODE_ITERATOR_TYPE",e[e.ORDERED_NODE_ITERATOR_TYPE=5]="ORDERED_NODE_ITERATOR_TYPE",e[e.UNORDERED_NODE_SNAPSHOT_TYPE=6]="UNORDERED_NODE_SNAPSHOT_TYPE",e[e.ORDERED_NODE_SNAPSHOT_TYPE=7]="ORDERED_NODE_SNAPSHOT_TYPE",e[e.ANY_UNORDERED_NODE_TYPE=8]="ANY_UNORDERED_NODE_TYPE",e[e.FIRST_ORDERED_NODE_TYPE=9]="FIRST_ORDERED_NODE_TYPE"}(t.XPathResultType||(t.XPathResultType={}))},"u+qd":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.serializeComplexTypeParameter=t.serializeIntoURLFragment=t.getODataUrlForFunction=t.serializeContract=void 0;var o=a(r("bMRw")),u=r("XGkY"),l=r("Mx+d"),s=r("Q6jc"),c=r("geC1"),d=r("LEFC"),f={COLON:encodeURIComponent(":"),OPEN_BRACKET:encodeURIComponent("{"),CLOSED_BRACKET:encodeURIComponent("}"),COMMA:encodeURIComponent(","),EQUAL:encodeURIComponent("=")};function p(e,t){var r=t.getMetadata().boundParameter,n=[],i=Object.keys(t).filter((function(e){return e!==r})).map((function(r){var i=t.getMetadata().parameterTypes[r],a=_(e,t,r,!1,!0);return void 0!==i&&o.ODataStructuralProperty.EnumerationType===i.structuralProperty?r+"="+a:(n.push("@"+r+"="+a),r+"=@"+r)}));return n.length?"("+i.join(",")+")?"+n.join("&"):"("+i.join(",")+")"}function y(e,t,r,n){switch(e){case"Edm.String":return h(e,t,r,n);case"Edm.Guid":return h(e,t.guid,r,n);case"Edm.DateTimeOffset":if("object"==typeof t&&"function"==typeof t.toISOString)return h(e,t.toISOString(),r,n);default:return h("Edm.UndefinedType",t,r,n)}}function h(e,t,r,n){switch(function(e,t,r){var n=r?t?s.EncodeRule.DoubleQuotesURL:s.EncodeRule.NoQuotesURL:s.EncodeRule.Contract;return n===s.EncodeRule.Contract?"Edm.UndefinedType"===e?n=s.EncodeRule.None:"Edm.String"===e&&(n=s.EncodeRule.JsonifyURL):n===s.EncodeRule.NoQuotesURL&&"Edm.String"===e?n=s.EncodeRule.SingleQuotesURL:n===s.EncodeRule.DoubleQuotesURL&&"Edm.UndefinedType"===e&&(n=s.EncodeRule.NoQuotesURL),n}(e,r,n)){case s.EncodeRule.JsonifyURL:return JSON.stringify(t);case s.EncodeRule.SingleQuotesURL:return"'"+c.encodeURIComponentForOData(t)+"'";case s.EncodeRule.DoubleQuotesURL:return'"'+c.encodeURIComponentForOData(t)+'"';case s.EncodeRule.NoQuotesURL:return c.encodeURIComponentForOData(t);case s.EncodeRule.Contract:return'"'+t+'"';default:return t}}function v(e,t,r,n){if(void 0===n&&(n=!1),t){var i="{",a="",o=n?f.COLON:":";if(r){var u=t.getMetadata().typeName;u&&r.typeName!==u&&(i+='"@odata.type"'+o+'"'+u+'"',a=",")}for(var l in t)if("function"!=typeof t[l]){var s=_(e,t,l,!0,n);if(m(t,l,s))continue;i+=a+'"'+l+'"'+o+s,a||(a=",")}return i+"}"}return"null"}function m(e,t,r){if(e instanceof d.MetadataQuery){if([null,"null","[]",""].indexOf(r)>=0)return!0;if("DependencyDepth"===t&&e[t]===s.DependencyDepth.OnDemandWithoutContext)return!0}return!1}function g(e,t,r,n){var i=c.getEnumValueMetadata(e,t);return null==i?"":r?h(t.typeName,i.name,r,n):t.typeName+"'"+i.name+"'"}function _(e,t,r,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1);var a=t.getMetadata(),u=t[r];if(r&&0===r.indexOf("@odata."))return'"'+u+'"';var l=a.parameterTypes[r];if(void 0===l)return null;switch(l.structuralProperty){case o.ODataStructuralProperty.PrimitiveType:return null==u?null:"MetadataSubtype"===r&&"Edm.String"===l.typeName?'"'+u+'"':y(l.typeName,u,n,i);case o.ODataStructuralProperty.EntityType:return c.serializeEntityType(e,u,n,i);case o.ODataStructuralProperty.ComplexType:return v(e,u,l,i);case o.ODataStructuralProperty.EnumerationType:return g(u,l,n,i);case o.ODataStructuralProperty.Collection:return u?u.length?u[0].getMetadata?"["+u.map((function(t){return v(e,t,void 0,i)})).join(",")+"]":-1!==c.ODataPrimitives.indexOf(l.typeName)?"["+u.map((function(e){return y(l.typeName,e,n,i)})).join(",")+"]":l.enumProperties?"["+u.map((function(e){return g(e,l,n,i)})).join(",")+"]":"number"==typeof u[0]?"["+u.map((function(e){return y("Edm.String",e,n,i)})).join(",")+"]":"["+u.map((function(t){return c.serializeEntityType(e,t,n,i)})).join(",")+"]":"[]":"null";default:return null}}t.serializeIntoURLFragment=p,t.serializeContract=v,t.serializeComplexTypeParameter=_,t.getODataUrlForFunction=function(e,t){return""+function(e,t,r){if(!t)throw new Error("Cannot generate base URL for the OData call: the routine name is empty.");if(!r)throw new Error("Cannot generate base URL for the OData call: the request is empty.");if(!r.getMetadata())throw new Error("Cannot generate base URL for the OData call: the request metadata is empty.");var n=r.getMetadata().boundParameter;if(n){var i=r.getMetadata();if(!i||!i.parameterTypes||!i.parameterTypes[n])return null;if(i.parameterTypes[n].structuralProperty===o.ODataStructuralProperty.Collection){var a=i.parameterTypes[n].typeName&&i.parameterTypes[n].typeName.split(".").pop();return a&&(s=l.getEntitySetName(e,a))?s+"/Microsoft.Dynamics.CRM."+t:null}var s,c=r[n];return(s=l.getEntitySetName(e,c.entityType))+"("+u.Guid.fromExternalGuid(c.id).guid+")/Microsoft.Dynamics.CRM."+t}return""+t}(e,t.getMetadata().operationName,t)+p(e,t)}},ugCW:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RetrievalStrategy=void 0,function(e){e[e.Local=0]="Local",e[e.Remote=1]="Remote",e[e.LocalAndRemote=2]="LocalAndRemote"}(t.RetrievalStrategy||(t.RetrievalStrategy={}))},uzdi:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ODataExecuteMultipleRequest=t.ODataRetrieveWithUrlParamsRequest=t.ODataDeleteRequest=t.ODataUpdateRequest=t.ODataCreateRequest=void 0;var o=a(r("bMRw")),u=function(){function e(e,t,r){void 0===r&&(r=!0),this.etn=e,this.payload=t,this.suppressDupeDetection=r}return e.prototype.getMetadata=function(){return{boundParameter:void 0,parameterTypes:{},operationName:"Create",operationType:o.ODataOperationType.CRUD}},e}();t.ODataCreateRequest=u;var l=function(){function e(e,t,r,n,i,a,o){this.etn=e,this.id=t,this.payload=r,this.urlParams=n,this.headers=i,this.isBinaryPayload=a,this.suppressDupeDetection=o}return e.prototype.getMetadata=function(){return{boundParameter:void 0,parameterTypes:{},operationName:"Update",operationType:o.ODataOperationType.CRUD}},e}();t.ODataUpdateRequest=l;var s=function(){function e(e,t){this.entityReference=e,this.attributeName=t}return e.prototype.getMetadata=function(){return{boundParameter:void 0,parameterTypes:{entityReference:{typeName:"mscrm.crmbaseentity",structuralProperty:o.ODataStructuralProperty.EntityType}},operationName:"Delete",operationType:o.ODataOperationType.CRUD}},e}();t.ODataDeleteRequest=s;var c=function(){function e(e,t,r,n,i){this.etn=e,this.id=t,this.urlParams=r,this.headers=n,this.maxPageSize=i}return e.prototype.getMetadata=function(){return{boundParameter:void 0,parameterTypes:{},operationName:"RetrieveWithUrlParams",operationType:o.ODataOperationType.CRUD}},e}();t.ODataRetrieveWithUrlParamsRequest=c;var d=function(){function e(e){this.requests=e}return e.prototype.getMetadata=function(){return{boundParameter:void 0,parameterTypes:{},operationName:"ExecuteMultiple",operationType:o.ODataOperationType.ExecuteMultiple}},e}();t.ODataExecuteMultipleRequest=d},vqTk:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.APP_ENTITY=t.WEB_API_URL_FRAGMENT=t.HEADER_VALUES=t.HEADER=void 0,
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
t.HEADER={ACCEPT:"Accept",PREFER:"Prefer",AUTO_DISASSOCIATE:"AutoDisassociate",IF_MATCH:"If-match",AUTHORIZATION_HEADER:"Authorization",CONSISTENCY:"Consistency",CONTENT_LENGTH:"Content-Length",CONTENT_TYPE:"Content-Type",CONTENT_ID:"Content-Id",RETRY_AFTER:"Retry-After",MSCRM_SUPPRESS_DUPLICATION_DETECTION:"MSCRM.SuppressDuplicateDetection",MSCRM_RETURN_NOTIFICATIONS:"MSCRM.ReturnNotifications",CLIENT_REQUEST_ID:"x-ms-client-request-id",SERVER_REQUEST_ID:"x-ms-service-request-id",SESSION_ID:"x-ms-client-session-id",ACTIVITY_ID:"x-ms-client-activity-id",SOURCE_ID:"x-ms-source-id",CORRELATION_ID:"x-ms-correlation-id",MS_USER_AGENT:"x-ms-user-agent",VIEW_ID_HINT:"x-ms-mdl-viewId",PAGESIZE_HINT:"x-ms-mdl-pageSize",PAGE_NUMBER_HINT:"x-ms-mdl-pageNumber",SEARCH_HINT:"x-ms-mdl-search",FILTER_HINT:"x-ms-mdl-filter",ORDERBY_HINT:"x-ms-mdl-orderby",SELECT_HINT:"x-ms-mdl-select",LINK_HINT:"x-ms-mdl-link",EXECUTION_HINT:"x-ms-mdl-execution-hints"},t.HEADER_VALUES={APPLICATION_JSON:"application/json",TEXT_HTML:"text/html",ANNOTATIONS:'odata.include-annotations="*"',STRONG:"Strong"},t.WEB_API_URL_FRAGMENT="/api/data/v9.0/",t.APP_ENTITY="appmodules"},wEu3:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.GARBAGE_COLLECT_METADATA_ACTION_SYNC=t.UPDATE_GC_METADATA_REFCOUNT_ACTION=t.updateGCMetadataRefCount=t.GC_REMOVE_METADATA=t.replaceEntityWithPlaceholder=t.gcRemoveMetadata=t.garbageCollectMetadata=void 0;var n=r("Kz3/"),i=r("pdzI"),a=r("Mx+d"),o=r("c7Ce");t.GARBAGE_COLLECT_METADATA_ACTION_SYNC="garbage.collect.metadata.sync";t.GC_REMOVE_METADATA="gc.metadata.remove";function u(e,t,r,n){var o=a.getEntityDescriptor(e,t);if(o){var u={Initialized:i.InitState.Uninitialized,EntityLogicalName:o.EntityLogicalName,IsActivity:o.IsActivity};r[t]=u,n[t]=null}}function l(e){return{type:"gc.metadata.remove",payload:e}}function s(e,t){return{type:"gc.metadata.update.refcount",payload:{entities:e,ribbons:t}}}t.UPDATE_GC_METADATA_REFCOUNT_ACTION="gc.metadata.update.refcount",t.garbageCollectMetadata=function(e){return{type:"garbage.collect.metadata.sync",sync:!0,execute:function(t,r){var i,a=t.dispatch,c=(0,t.getState)(),d={},f={},p={},y=o.getGCEntitiesMetadata(c);for(var h in y){var v=null===(i=y[h])||void 0===i?void 0:i.slice(),m=v&&n.removeReference(v,e);m&&(0===m.length?u(c,h,d,f):p[h]=m)}var g={};((Object.keys(g).length>0||Object.keys(p).length>0)&&a(s(p,g)),Object.keys(d).length>0)&&a(l({entities:d,attributes:f}))}}},t.replaceEntityWithPlaceholder=u,t.gcRemoveMetadata=l,t.updateGCMetadataRefCount=s},xl8k:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.SupportedLookupProperties=void 0;var n=r("i2et");t.SupportedLookupProperties=[n.AttributeType.Owner,n.AttributeType.Customer,n.AttributeType.Lookup]},xvCR:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DOMParserNodeListWrapper=void 0;var n=r("1LmJ"),i=r("UZ+8"),a=function(){function e(e){n.assert(!i.IsNullOrUndefined(e),"Node list obj should not be null"),this._list=e}return e.prototype.get_count=function(){return this._list.length},e.prototype.get_item=function(e){return this._list[e]},e}();t.DOMParserNodeListWrapper=a}}]),window.bundleExecutionMarkers["scripts/es5/114.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();