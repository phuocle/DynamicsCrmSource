(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/3.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[3],{"6Jxj":function(t,e,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r,i,a,o;n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"d",(function(){return o})),function(t){t.FilterQueryOption="$filter",t.ExpandQueryOption="$expand",t.SelectQueryOption="$select",t.TopQueryOption="$top",t.SkipTokenQueryOption="$skiptoken",t.OrderByQueryOption="$orderby",t.FetchXmlQueryOption="fetchXml",t.GetOnlyRelatedEntity="$getOnlyRelatedEntity",t.ODataOrderByAscending="asc",t.ODataOrderByDescending="desc",t.ODataNextLinkString="@odata.nextLink"}(r||(r={})),function(t){t.Equal="eq",t.NotEqual="ne",t.Null="null",t.NotNull="not-null",t.In="in",t.NotIn="not-in",t.Like="like",t.NotLike="not-like",t.BeginsWith="begins-with",t.NotBeginWith="not-begin-with",t.EndsWith="ends-with",t.NotEndWith="not-end-with",t.GreaterThan="gt",t.GreaterThanEqual="ge",t.LessThan="lt",t.LessThanEqual="le",t.EqualsUserId="eq-userid",t.NotEqualsUserId="ne-userid",t.EqualsUserTeams="eq-userteams",t.EqualsUserOrUserTeams="eq-useroruserteams"}(i||(i={})),function(t){t.ActivityParty="activityparty",t.OwnerId="ownerid",t.Value="value",t.RawGuid="rawguid",t.Id="id",t.LogicalName="logicalname",t.Name="name",t.PartyId="partyid",t.TransactionCurrencyId="transactioncurrencyid",t.TransactionCurrency="transactioncurrency",t.ColumnDelimiter="!",t.Fields="fields",t.VersionNumber="versionnumber",t.RowVersion="RowVersion"}(a||(a={})),function(t){t.API="API",t.EntityType="entityType",t.Id="id",t.Attributes="attributes",t.Options="options",t.MaxPageSize="maxPageSize",t.retrieveRecord="{Xrm.Mobile.offline}.{retrieveRecord}"}(o||(o={}))},SApI:function(t,e,n){"use strict";n.d(e,"b",(function(){return N})),n.d(e,"a",(function(){return x})),n.d(e,"g",(function(){return L})),n.d(e,"e",(function(){return T})),n.d(e,"d",(function(){return V})),n.d(e,"c",(function(){return B})),n.d(e,"f",(function(){return q}));var r=n("/j9Z"),i=n("GUnN"),a=n("F2uj"),o=n("lMVv"),s=n("jF+8"),u=n("BvBP"),l=n("Ev4I"),c=n("c56u"),g=n("hRGi"),p=n("7EJx"),d=n("9r0m"),h=n("VWqI"),f=n("JlqV"),y=n("kh6f"),b=n("oPba"),_=n("6Jxj"),m=n("gBKR"),O=n("+h4s"),v=n("hFf+"),j=n("MSdU"),w=n("/XLd"),S=n("L+Os"),C=n("AX1v"),E=n("L+41"),A=n("WS0f");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function N(t,e,n){return new Promise((function(a,p){if(!Object(u.a)(n.getState()))throw new r.a(Object(s.a)(-7e3),-7e3);return Object(f.b)(n.getState())?(y.c.error("Offline.XrmOfflineValidators.basicValidator: Cant call offline Client APIs in online mode for this entity"),p(new r.a(Object(s.a)(-7002),-7002))):Object(c.p)(n.getState())!==C.a.Enabled?(y.c.error("Offline.XrmOfflineValidators.basicValidator: Cant call offline Client APIs in when the user isnt opted in for this entity:"),p(new r.a(Object(s.a)(-7001),-7001))):Object(c.q)(n.getState())!==E.a.Available?(y.c.error("Offline.XrmOfflineValidators.basicValidator: Cant call offline Client APIs when status is not marked as available (offline db is not available) for this entity:"),p(new r.a(Object(s.a)(-7003),-7003))):(y.c.info("Offline.XrmOfflineValidators.basicValidator: Base level validations completed for entity:"+t+" & request type:"+e.toString()),void n.dispatch(Object(m.f)(t,!0,null)).then((function(){var i=n.getState();if(Object(o.h)(i,t)){var u=Object(o.h)(n.getState(),t).Id,c=Object(g.b)(n.getState());if(!c||c.indexOf(t)<0)return y.c.error("Offline.XrmOfflineValidators.basicValidator: Cant call offline Client APIs when "+u+"is not present in user's profile"),p(new r.a(Object(s.a)(-7015,[t]),-7015));if(-1===Object(l.j)(n.getState()).indexOf(t))return y.c.error("Offline.XrmOfflineValidators.basicValidator: Cant call offline Client APIs when "+u+"is marked offline disabled."),p(new r.a(Object(s.a)(-7016,[t]),-7016));var d=4===e||5===e?2:0===e?1:1===e?3:4;return!Object(o.s)(i,t)&&t!==_.b.ActivityParty||2===d?Object(h.g)(n.getState(),t,d,-1)?(y.c.info("Offline.XrmOfflineValidators.basicValidator: Entity level validations completed for entity:"+t+" & request type:"+e.toString()),a()):(y.c.error("Offline.XrmOfflineValidators.basicValidator: Cant call offline Client APIs for "+u+" as the user dont have permission for operation:"+d.toString()),p(new r.a(Object(s.a)(-7010,[d.toString()]),-7010))):(y.c.error("Offline.XrmOfflineValidators.basicValidator: Cant call offline Client APIs for "+u+" with operation:"+d.toString()+" as only read operation is allowed for it."),p(new r.a(Object(s.a)(-7034),-7034)))}return y.c.error("Offline.XrmOfflineValidators.basicValidator: Entity metadata not present in state tree for this entity"),p(new r.a(Object(s.a)(-7017,[t]),-7017))})).catch((function(t){return y.c.error("Offline.XrmOfflineValidators.basicValidator: Retrieval of metadata failed for entity with error:"+Object(i.e)(t)),p(t)})))}))}function x(t,e,n,o){Object.keys(o).forEach((function(u){var l,c,g,h,f,b,m=o[u],C=n[u];if(!Object(A.a)(C)){var E=!0;try{switch(m){case"integer":case"bigint":isNaN(parseInt(C.toString(),10))?(y.c.error("Invalid value for attribute "+u+" type of "+m),E=!1):C=parseInt(C.toString(),10);break;case"decimal":case"double":case"money":isNaN(parseFloat(C.toString()))&&(y.c.error("Invalid value for attribute "+u+" type of "+m),E=!1);break;case"datetime":var N=Object(a.a)(e.getState(),t,u);C="DateOnly"===N.Format?Object(O.l)(Object(O.q)(C),Object(p.l)(e.getState()),N.Behavior,Object(p.k)(e.getState())):Object(O.l)(C,Object(p.l)(e.getState()),N.Behavior,Object(p.k)(e.getState()));break;case"boolean":"true"===C.toString().toLowerCase()||"false"===C.toString().toLowerCase()?((l={})[_.b.Value]="true"===C.toString().toLowerCase()?"1":"0",C=l):(y.c.error("Invalid value for attribute "+u+" type of "+m),E=!1);break;case"state":case"status":case"picklist":isNaN(parseInt(C.toString(),10))?(y.c.error("Invalid value for attribute "+u+" type of "+m),E=!1):((c={})[_.b.Value]=parseInt(C.toString(),10),C=c);break;case"uniqueidentifier":(g={})[_.b.RawGuid]=C.toString(),C=g;break;case"lookup":case"customer":case"owner":(function(t){return!(null===t||"object"!=typeof t||t instanceof Array||t instanceof Date)})(C)&&C[_.b.Id]&&C[_.b.LogicalName]?C=k(C):(y.c.error("Invalid value for attribute "+u+" type of "+m),E=!1);break;case"partylist":C instanceof Array&&C.length>0?(h=C,f=[],b=new j.a(_.b.ActivityParty,d.a.toLegacyGuid(d.a.EMPTY)),h.map((function(t){var e,n;if(!t[_.b.Id]||!t[_.b.LogicalName])throw new Error("invalid value for party list attribute ");f.push(new v.a(b,((e={})[_.b.PartyId]=v.a.createSingleFieldFromObjectData(k(t),"lookup"),e),((n={})[_.b.PartyId]="lookup",n),{},{},new w.a([])))})),C=new S.a(f,!0,f.length,!1,null)):(y.c.error("Invalid value for attribute "+u+" type of "+m),E=!1);break;case"string":case"memo":case"unknown":case"entityname":break;default:throw new r.a(Object(s.a)(-7013,[u]),-7013)}if(!E)throw new Error("Invalid value for attribute "+u+" type of "+m);"partylist"!==m&&(C=v.a.createSingleFieldFromObjectData(C,m))}catch(t){throw y.c.error(" formatting of attribute value failed with "+Object(i.e)(t)),t}n[u]=C}}))}function k(t){var e,n;return(e={})[_.b.Id]=((n={})[_.b.RawGuid]=t[_.b.Id],n),e[_.b.LogicalName]=t[_.b.LogicalName],e[_.b.Name]=function(t){if(!t)return typeof t==typeof Number||Object.propertyIsEnumerable(typeof t)?0:typeof t!=typeof Boolean&&null;return t}(t[_.b.Name]),e}function L(t,e,n,a){var u,l=!0,c=!1,g=new Map;try{return Object.keys(n.get_queryParameters()).forEach((function(p){switch(p){case _.c.SelectQueryOption:if(Q(p,t,c)){l=!1;var d=null;try{d=n.get_select()}catch(t){throw y.c.error("Offline.XrmOfflineValidators.optionsValidator: Invalid value "+p),new r.a(Object(s.a)(-7020,[p]),-7020)}if(!d||!d.get_attributeNames()||0===d.get_attributeNames().length)throw y.c.error("Offline.XrmOfflineValidators.optionsValidator: Value cannot be null "+p),new r.a(Object(s.a)(-7019,[p]),-7019);F(e,d.get_attributeNames(),a)}break;case _.c.ExpandQueryOption:if(Q(p,t,c)){var h;l=!1;try{h=n.get_expand()}catch(t){throw y.c.error("Offline.XrmOfflineValidators.optionsValidator: Invalid value "+p),new r.a(Object(s.a)(-7020,[p]),-7020)}if(!h||!h.get_expandTerms()||0===h.get_expandTerms().length)throw y.c.error("Offline.XrmOfflineValidators.optionsValidator: Value cannot be null "+p),new r.a(Object(s.a)(-7019,[p]),-7019);var f=Object(o.h)(a.getState(),e)?Object(o.h)(a.getState(),e).Id:null;u=function(t,e){return e.dispatch(Object(m.f)(t,!0,[])).then((function(){var n=Object(o.h)(e.getState(),t);if(!n)throw new r.a(Object(s.a)(-7017,[t]),-7017);var i=new Map;return n.OneToManyRelationships&&Object.keys(n.OneToManyRelationships).forEach((function(t){var e=n.OneToManyRelationships[t];i.set(e.ReferencedEntityNavigationPropertyName,{schemaName:e.SchemaName,relationshipType:0})})),n.ManyToOneRelationships&&Object.keys(n.ManyToOneRelationships).forEach((function(t){var e=n.ManyToOneRelationships[t];i.set(e.ReferencingEntityNavigationPropertyName,{schemaName:e.SchemaName,relationshipType:2})})),n.ManyToManyRelationships&&Object.keys(n.ManyToManyRelationships).forEach((function(e){var r=n.ManyToManyRelationships[e];r.Entity1LogicalName===t?i.set(r.Entity1NavigationPropertyName,{schemaName:r.SchemaName,relationshipType:1}):i.set(r.Entity2NavigationPropertyName,{schemaName:r.SchemaName,relationshipType:1})})),i})).catch((function(n){var r=Object(o.h)(e.getState(),t)?Object(o.h)(e.getState(),t).Id:null;return y.c.error("Offline.XrmOfflineValidators.getNavigationPropertiesForEntity: Entity Metadata could not be retrieved for entity "+r+" with error "+Object(i.e)(n)),Promise.reject(n)})).catch((function(n){var r=Object(o.h)(e.getState(),t)?Object(o.h)(e.getState(),t).Id:null;return y.c.error("Offline.XrmOfflineValidators.getNavigationPropertiesForEntity: Navigation properties for entity "+r+" could not be retrieved with error "+Object(i.e)(n)),Promise.reject(n)}))}(e,a).then((function(t){if(!t)throw y.c.error("Offline.XrmOfflineValidators.optionsValidator: Navigation property is undefined for entity "+f+" in "+p),new r.a(Object(s.a)(-7021,[e]),-7021);return h.get_expandTerms().forEach((function(n){if(!t.has(n.get_navigationProperty()))throw y.c.error("Offline.XrmOfflineValidators.optionsValidator: Navigation property "+n.get_navigationProperty()+" is invalid for entity "+f+" in "+p),new r.a(Object(s.a)(-7022,[n.get_navigationProperty(),e]),-7022);g.set(n.get_navigationProperty(),t.get(n.get_navigationProperty()))})),Promise.resolve(g)})).catch((function(t){throw y.c.error("Offline.XrmOfflineValidators.optionsValidator: Entity Metadata could not be retrieved for "+f+" in "+p+" with error "+Object(i.e)(t)),new r.a(Object(s.a)(-7017,[e]),-7017)}))}break;case _.c.TopQueryOption:if(Q(p,t,c)){l=!1;var O=0;try{O=n.get_top()}catch(t){throw y.c.error("Offline.XrmOfflineValidators.optionsValidator: Invalid value "+p),new r.a(Object(s.a)(-7020,[p]),-7020)}if(O<=0)throw y.c.error("Offline.XrmOfflineValidators.optionsValidator: Value must be a non-negative number "+p),new r.a(Object(s.a)(-7023),-7023)}break;case _.c.OrderByQueryOption:if(Q(p,t,c)){l=!1;var v=[],j=null;try{j=n.get_orderBy()}catch(t){throw y.c.error("Offline.XrmOfflineValidators.optionsValidator: Invalid value "+p),new r.a(Object(s.a)(-7020,[p]),-7020)}if(!j||0===j.get_orderByTermTokens().length)throw y.c.error("Offline.XrmOfflineValidators.optionsValidator: Value cannot be null "+p),new r.a(Object(s.a)(-7019,[p]),-7019);j.get_orderByTermTokens().forEach((function(t){v.push(t.get_attributeName())})),v&&v.length>0&&F(e,v,a)}break;case _.c.FilterQueryOption:if(Q(p,t,c)){l=!1;var w=null;try{w=n.get_filter()}catch(t){throw y.c.error("Offline.XrmOfflineValidators.optionsValidator: Invalid value "+p),new r.a(Object(s.a)(-7020,[p]),-7020)}if(!w||!w.get_filterExpression())throw y.c.error("Offline.XrmOfflineValidators.optionsValidator: Value cannot be null "+p),new r.a(Object(s.a)(-7019,[p]),-7019);!function t(e,n,i){if(n){var a=[];if(n.get_conditions()){n.get_conditions().forEach((function(t){a.push(t.get_attributeName())}));var o=T(a,e,i.getState());n.get_conditions().forEach((function(t){try{var e=o[t.get_attributeName()];!function(t,e,n){switch(e){case"unknown":case"entityimage":case"managedproperty":case"partylist":throw new Error(String.format("Attribute "+t+" is not supported in filter query option."));case"boolean":case"customer":case"entityname":case"lookup":case"memo":case"owner":case"picklist":case"state":case"status":case"string":case"uniqueidentifier":if(n!==_.a.Equal&&n!==_.a.NotEqual)throw new Error(String.format("Operator "+n+" is not supported with attribute "+t+" in filter query option."))}}(t.get_attributeName(),e,t.get_operator())}catch(e){throw new r.a(Object(s.a)(-7027,["Attribute(Name = "+t.get_attributeName()+", type = "+o[t.get_attributeName()]+", Condition = "+t.get_operator()+")"]),-7027)}}))}n.get_filterExpressions()&&n.get_filterExpressions().length>0&&n.get_filterExpressions().forEach((function(n){t(e,n,i)}))}}(e,w.get_filterExpression(),a)}break;case _.c.FetchXmlQueryOption:if(!l)throw y.c.error("Offline.XrmOfflineValidators.optionsValidator: No other query options are supported "+p),new r.a(Object(s.a)(-7026),-7026);if(Q(p,t,c)){c=!0;var S=n.get_fetchXml();try{var C=(new DOMParser).parseFromString(S,"text/xml");if(!C)throw y.c.error("Offline.XrmOfflineValidators.optionsValidator: Invalid FetchXML "+p),new r.a(Object(s.a)(-7025),-7025);if(!C.getElementsByTagName("fetch")[0])throw y.c.error("Offline.XrmOfflineValidators.optionsValidator: Invalid FetchXML "+p),new r.a(Object(s.a)(-7025),-7025)}catch(t){throw y.c.error("Offline.XrmOfflineValidators.optionsValidator: Invalid FetchXML "+p),new r.a(Object(s.a)(-7025),-7025)}}break;default:if(Q(p,t,c)){var E=n.get_queryParameters()[p];switch(l=!1,p){case _.c.SkipTokenQueryOption:if(!E||isNaN(parseInt(E.toString(),10))||parseInt(E.toString(),10)<=0)throw y.c.error("Offline.XrmOfflineValidators.optionsValidator: Invalid Retrieve option "+p),new r.a(Object(s.a)(-7028,[p]),-7028);break;case _.c.GetOnlyRelatedEntity:if(!E||!Object(b.a)(E.toString()))throw y.c.error("Offline.XrmOfflineValidators.optionsValidator: Invalid Retrieve option "+p),new r.a(Object(s.a)(-7028,[p]),-7028);break;default:throw y.c.error("Offline.XrmOfflineValidators.optionsValidator: Invalid option "+p),new r.a(Object(s.a)(-7027),-7027)}}}})),u||Promise.resolve(g)}catch(t){return Promise.reject(t)}}function Q(t,e,n){var i=!1;switch(t){case _.c.SelectQueryOption:case _.c.ExpandQueryOption:case _.c.GetOnlyRelatedEntity:i=!0;break;case _.c.TopQueryOption:case _.c.OrderByQueryOption:case _.c.FilterQueryOption:case _.c.FetchXmlQueryOption:case _.c.SkipTokenQueryOption:i=5===e}if(!i)throw y.c.error("Offline.XrmOfflineValidators.isOptionValid: Retrieve query option not supported:"+t),new r.a(Object(s.a)(-7028,[t]),-7028);if(n)throw i=!1,y.c.error("Offline.XrmOfflineValidators.isOptionValid: No query options with fetch XML:"+t),new r.a(Object(s.a)(-7026),-7026);return i}function F(t,e,n){var r=n.getState(),i=Object(a.d)(r,t);if(!i)throw y.c.error("Offline.XrmOfflineValidators.areAttributesSupported: No attribute metadata is available in the state tree."),new Error("Attribute Metadata not found while validation attributes in query options.");e&&e.length>0&&e.forEach((function(e){var n=V(r,t,e);if(!i[n])throw new Error("Invalid Attribute name.");if(!function(t){switch(t){case"unknown":case"decimal":case"double":case"integer":case"memo":case"money":case"string":case"uniqueidentifier":case"bigint":case"owner":case"customer":case"lookup":case"datetime":case"picklist":case"state":case"status":case"boolean":case"entityname":return!0;default:return!1}}(i[n].Type)||i[n].AttributeOf)throw new Error(String.format("Attribute type "+i[n].Type+" for attribute "+i[n].LogicalName+" not supported in offline."))}))}function T(t,e,n){var r=t.map((function(t){return V(n,e,t)}));return Object(a.c)(r,e,n)}function V(t,e,n){var r=q(n),i=B(n);return r&&2===r.length&&Object(a.a)(t,e,r[1])?r[1]:i&&2===i.length&&Object(a.a)(t,e,i[1])?i[1]:n}function B(t){return t.match(/^(.*)@odata.bind$/)}function q(t){return t.match(/^_(.*)_value$/)}},"jF+8":function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r,i=n("kh6f"),a=((r={})[-7e3.toString()]="Your organization has not opted in for the Mobile Offline feature.",r[-7001..toString()]="You must opt in to the Offline mode to use this feature. ",r[-7002..toString()]="This feature is not available when you are connected to Dynamics 365 server.",r[-7003..toString()]="The Offline Data Store is not ready to  perform the operation.",r[-7004..toString()]="{0}�is a required parameter and cannot be null.",r[-7005..toString()]="{0} is an invalid value for the field.",r[-7006..toString()]="{0} is an invalid GUID.",r[-7007..toString()]="Max Page Size� should be a number.",r[-7008..toString()]="Max Page Size should be a positive integer.",r[-7009..toString()]='Option Parameter should begin with "?".',r[-7010..toString()]="{0} operation doesn�t have privilege to perform the operation.",r[-7011..toString()]="Attribute Metadata not found for entity {0}.",r[-7012..toString()]="Specified attributes are Invalid.",r[-7013..toString()]="Attribute {0} is not supported in offline mode.",r[-7014..toString()]="Entity {0} is not supported.",r[-7015..toString()]="Entity {0} is not enabled.",r[-7016..toString()]="Entity {0} is not available due to a mismatch in metadata.",r[-7017..toString()]="Entity Metadata not found for entity {0}.",r[-7018..toString()]="Specified query option string is invalid.",r[-7019..toString()]="The value of {0} query option cannot be null.",r[-7020..toString()]="Invalid value specified for the {0} query option.",r[-7021..toString()]="Specified Navigation Property not found for entity {0}.",r[-7022..toString()]="Navigation Property {0} is not present for entity {1}.",r[-7023..toString()]="The value of $top query option must be a non-negative number.",r[-7024..toString()]='Invalid direction suffix specified in the $orderby query option. Use the "asc" or "desc" suffix to specify ascending or descending order respectively.',r[-7025..toString()]="Specified FetchXML is invalid.",r[-7026..toString()]="No other query options are supported with the FetchXML option.",r[-7027..toString()]="Query option {0} is not supported.",r[-7028..toString()]="Retrieve doesn�t support query option {0}.",r[-7029..toString()]="Record not found.",r[-7030..toString()]="Error occurred during SQL generation.",r[-7031..toString()]="Error occurred while executing SQL.",r[-7032..toString()]="An unexpected error occurred.",r[-7033..toString()]="Invalid value specified for attribute {0}.",r[-7034..toString()]="Create or update or delete action on Activity Party and Intersect Entity are not allowed.",r);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function o(t,e){if(t&&a[t.toString()]){var n=a[t.toString()];return e&&e.length>0&&(n=String.format(n,e)),n}throw i.c.error("Offline.XrmOfflineErrors.getErrorCodeMessage: Cant return error message for an invalid error code:"+t),new Error("XrmOfflineErrors: Cant return error message for an invalid error code:"+t)}},kJGL:function(t,e,n){"use strict";n.d(e,"a",(function(){return Kt})),n.d(e,"b",(function(){return Zt})),n.d(e,"c",(function(){return Ht}));var r=n("Sn3h"),i=n("/j9Z"),a=n("GUnN"),o=n("F2uj"),s=n("lMVv"),u=n("jF+8"),l=n("9r0m"),c=n("kh6f"),g=n("oPba"),p=n("6Jxj"),d=n("sgPk"),h=n("gBKR"),f=n("l8p4"),y=n("fL8u"),b=n("Z55s"),_=n("Kn4q");var m,O=n("tvev"),v=n("iJR5"),j=n("c/eZ"),w=n("WS0f"),S=function(){function t(t,e,n){this._name=null,this._entity=null,this._name=t,this._entity=n}return t.prototype.get_entity=function(){return this._entity},t.prototype.get_name=function(){return this._name},t}(),C=n("xh8K"),E=n("29Rm"),A=function(){function t(t,e,n,r){this._name=null,this._descending=!1,this._entity=null,this._name=t,this._descending=n,this._entity=r}return t.prototype.get_entity=function(){return this._entity},t.prototype.get_descending=function(){return this._descending},t.prototype.get_name=function(){return this._name},t}(),N=n("+Iuh"),x=function(){function t(e,n,r){this.joinType=0,this.fetchXmlDoc=null,this.entityName=null,this.attributesByName=null,this.attributes=null,this.orderByAttributes=null,this.groupByAttributes=null,this.aggregateAttributes=null,this.linkedEntities=null,this.parentEntity=null,this.baseEntity=null,this.filterExpression=null,this.hasAggregate=!1,this.tableAlias=null,this.tableAliasCount=0,this.tableAliases=null,this.useLimitStatement=!0,this.top=t._defaultTopValue,this.offset=t._defaultOffsetValue,this.entityName=e,this.tableAliasCount=0,this.tableAliases=[],this.tableAlias=this.generateTableAlias(this.entityName),this.attributes=new Array(0),this.attributesByName={},this.orderByAttributes=new Array(0),this.groupByAttributes=new Array(0),this.aggregateAttributes=new Array(0),this.linkedEntities=new Array(0),this.alias=null,this.parentEntity=n,n?(this.baseEntity=n.baseEntity,this.joinType=Object(w.a)(r)?t.innerJoin:r):this.baseEntity=this}return t.prototype.get_top=function(){return this.top},t.prototype.set_top=function(t){return this.top=t,t},t.prototype.get_offset=function(){return this.offset},t.prototype.set_offset=function(t){return this.offset=t,t},t.prototype.get_linkedEntities=function(){return this.linkedEntities},t.prototype.get_joinType=function(){return this.joinType},t.prototype.get_orderByAttributes=function(){return this.orderByAttributes},t.prototype.get_attributesByName=function(){return this.attributesByName},t.prototype.get_attributes=function(){return this.attributes},t.prototype.get_entityName=function(){return this.entityName},t.prototype.get_Alias=function(){return this.alias},t.prototype.get_fetchXml=function(){return Object(w.a)(this.fetchXmlDoc)?"":Object(N.a)(this.fetchXmlDoc.firstChild).get_outerXml()},t.prototype.get_parentEntity=function(){return this.parentEntity},t.prototype.get_baseEntity=function(){return this.baseEntity},t.prototype.get_filterExpression=function(){return this.filterExpression},t.prototype.set_filterExpression=function(t){return this.filterExpression=t,t},t.prototype.get_tableAlias=function(){return this.tableAlias},t.prototype.get_useLimitStatement=function(){return this.useLimitStatement},t.prototype.set_useLimitStatement=function(t){return this.useLimitStatement=t,t},t.prototype.generateTableAlias=function(t){if(!Object(w.b)(t)){var e=String.format("{0}{1}",t,this.tableAliasCount++);return this.tableAliases.push(e),e}return""},t.prototype.initialize=function(t){this.fetchXmlDoc=Object(N.b)(t.get_outerXml()),this.hasAggregate="true"===this.getAttributeValue(t,"aggregate");var e=this.getAttributeValue(t,"count");e&&(this.top=Number.parseInvariant(e));var n=this.getAttributeValue(t,"page");n&&(this.offset=Number.parseInvariant(n));var r=t.selectSingleNode("entity");if(Object(w.a)(r)&&"link-entity"===t.get_tagName()&&(r=t),Object(w.a)(this.parentEntity)){var i=this.getAttributeValue(r,"name");this.tableAliasCount=0,this.tableAliases=[],this.tableAlias=this.generateTableAlias(i),this.baseEntity=this}this._parser(r)},t.prototype.initializeFromFetchXml=function(t){var e=Object(N.b)(t);this.initialize(Object(N.a)(e).selectSingleNode("fetch"))},t.prototype.removeAttributesAndOrder=function(t){for(var e=new Array(0),n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];switch(i.nodeName){case"attribute":case"order":e[e.length]=i;break;case"link-entity":this.removeAttributesAndOrder(i)}}for(n=0;n<e.length;n++)t.removeChild(e[n])},t.prototype.addAttribute=function(t,e){var n=new S(t,null,this);this.get_attributesByName()[t]=n,this.get_attributes()[this.get_attributes().length]=n},t.prototype.addOrderByAttribute=function(t,e){var n=new A(t,this.tableAlias,e,this);this.orderByAttributes[this.orderByAttributes.length]=n},t.prototype._parser=function(t){this.entityName=this.getAttributeValue(t,"name");for(var e=t.childNodes(),n=0;n<e.get_count();n++){var r=e.get_item(n);if(!Object(w.a)(r.get_tagName()))switch(r.get_tagName().toLocaleLowerCase()){case"attribute":var i=this.getAttributeValue(r,"name"),a=this.getAttributeValue(r,"alias"),o=new S(i,a,this);this.attributesByName[a||i]=o,this.attributes[this.attributes.length]=o,this.getAttributeValue(r,"aggregate")&&(this.aggregateAttributes[this.aggregateAttributes.length]=o);var s=this.getAttributeValue(r,"groupby");s&&"true"===s&&(this.groupByAttributes[this.groupByAttributes.length]=o);break;case"order":var u=this.getAttributeValue(r,"alias"),l=this.getAttributeValue(r,"attribute"),c=this.getAttributeValue(r,"descending"),g=new A(l,u,!!c&&"true"===c,this);this.orderByAttributes[this.orderByAttributes.length]=g;break;case"link-entity":var p=this.getAttributeValue(r,"name"),d=this.getAttributeValue(r,"from"),h=this.getAttributeValue(r,"to"),f=this.getAttributeValue(r,"alias"),y=new k(p,this);y.setLinkProperties(d,h,"eq",this.getLinkType(r),f),y.initialize(r),this.linkedEntities[this.linkedEntities.length]=y;break;case"filter":var b=this.getAttributeValue(r,"type"),_=0;b&&"or"===b.toLowerCase()&&(_=E.a.Or),this.filterExpression=new C.a(_,this.get_entityName()),this.filterExpression=this.filterParser(r,this.filterExpression)}}},t.prototype.filterParser=function(t,e){for(var n=t.childNodes(),r=0;r<n.get_count();r++){var i=n.get_item(r);if(!Object(w.a)(i.get_tagName()))switch(i.get_tagName().toLocaleLowerCase()){case"filter":var a=this.getAttributeValue(i,"type"),o=0;a&&"or"===a.toLowerCase()&&(o=E.a.Or);var s=new C.a(o,"tempValue");s=this.filterParser(i,s),e.addFilterExpression(s);break;case"condition":var u=this.getAttributeValue(i,"attribute"),l=this.getAttributeValue(i,"operator"),c=this.getAttributeValue(i,"value"),g=this.getAttributeValue(i,"uitype");if(r||e.set_filterExpressionId(u),Object(w.b)(c)){var p=i.childNodes();if(p.get_count()>0){for(var d=[],h=0;h<p.get_count();h++){var f=p.get_item(h);Object(w.a)(f.get_innerText())||d.push(p.get_item(h).get_innerText())}e.addCondition(u,l,d)}else e.addCondition(u,l);if(e.get_conditions().length>0)e.get_conditions()[e.get_conditions().length-1].set_entityName(g)}else e.addCondition(u,l,c)}}return e},t.prototype.getAttributeValue=function(t,e){return t.getAttribute(e)},t.prototype.getLinkType=function(e){var n=this.getAttributeValue(e,"link-type");if(!n)return t.innerJoin;switch(n){case"natural":return t._naturalJoin;case"inner":return t.innerJoin;case"outer":return t._leftOuterJoin;case"matchfirstrowusingcrossapply":return t._matchFirstRowUsingCrossApply;case"exists":return t._exists;case"in":return t._inSubquery;default:throw Error.create("EntityQueryExpression.GetLinkType: Invalid join type!")}},t.innerJoin=0,t._leftOuterJoin=1,t._naturalJoin=2,t._matchFirstRowUsingCrossApply=3,t._inSubquery=4,t._exists=5,t._defaultTopValue=5e3,t._defaultOffsetValue=1,t}(),k=function(t){function e(e,n,r){var i=t.call(this)||this;return i._linkToAttribute=null,i._linkFromAttribute=null,i._conditionOperator=null,i.entityName=e,i.attributes=new Array(0),i.attributesByName={},i.orderByAttributes=new Array(0),i.groupByAttributes=new Array(0),i.aggregateAttributes=new Array(0),i.linkedEntities=new Array(0),i.parentEntity=n,n&&(i.baseEntity=n.get_baseEntity(),i.tableAlias=i.baseEntity.generateTableAlias(i.entityName),i.joinType=Object(w.a)(r)?x.innerJoin:r),i}return Object(j.__extends)(e,t),e.prototype.get_linkToAttribute=function(){return this._linkToAttribute},e.prototype.get_linkFromAttribute=function(){return this._linkFromAttribute},e.prototype.get_conditionOperator=function(){return this._conditionOperator},e.prototype.setLinkProperties=function(t,e,n,r,i){this._linkFromAttribute=t,this._linkToAttribute=e,this._conditionOperator=n,this.joinType=r,this.alias=i},e}(x),L=n("MSdU"),Q=n("g8d3"),F=n("sMyT"),T=n("cgrB"),V=n("nlF/"),B=n("cJfs"),q=function(){function t(){this._EntityQueryExpression=null,this._Visitor=null,this._Strategy=null}return t.prototype.get_entityQueryExpression=function(){return this._EntityQueryExpression},t.prototype.set_entityQueryExpression=function(t){return this._EntityQueryExpression=t,t},t.prototype.get_visitor=function(){return this._Visitor},t.prototype.set_visitor=function(t){return this._Visitor=t,t},t.prototype.get_strategy=function(){return this._Strategy},t.prototype.set_strategy=function(t){return this._Strategy=t,t},t}(),I=function(){},P=n("n3Go");!function(t){t[t.inner=0]="inner",t[t.leftOuter=1]="leftOuter",t[t.outer=2]="outer"}(m||(m={}));var M=n("en4/");function D(t){switch(t.toLowerCase()){case"eq":case"eq-userid":return"=";case"ne":case"ne-userid":return"!=";case"gt":return">";case"ge":return">=";case"lt":return"<";case"le":return"<=";case"like":case"begins-with":case"ends-with":return"like";case"not-like":case"not-begin-with":case"not-end-with":return"not like";case"eq-userteams":case"eq-useroruserteams":case"in":return"in";case"not-in":return"not in";case"between":return"between";case"not-between":return"not between";case"not-null":return"is not null";case"null":return"is null";default:throw Error.create("Invalid condition operator type!")}}function X(t){switch(t){case 0:return"and";case E.a.Or:return"or";default:throw Error.create("Invalid logical operator type!")}}function R(t,e){var n=M.a.get_DefaultInstance().get_MetadataCache().getAttributeMetadata(e,t);if(!Object(w.a)(n))return n;throw Error.create(Object(P.a)("Attribute {0} is not present in the metadata for entity {1}",t,e))}var U=function(t){function e(e){var n=t.call(this)||this;return n._strategy=null,n._tableAlias="",n._entityName="",n._strategy=e,n}return Object(j.__extends)(e,t),e.prototype._visitAttributeExpression=function(t){this._strategy.addAttribute(t,this._tableAlias)},e.prototype._visitColumnSetExpression=function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];this._visitAttributeExpression(r)}},e.prototype._visitConditionExpression=function(t){!function(t){switch(t){case"ne":case"not-in":case"not-like":case"not-begin-with":case"not-end-with":return!0;default:return!1}}(t.get_operator())?this._strategy.addCondition(t.get_attributeName(),t.get_operator(),t.get_value(),this._entityName,this._tableAlias):(this._strategy.beginWritingFilter(E.a.Or),this._strategy.addCondition(t.get_attributeName(),t.get_operator(),t.get_value(),this._entityName,this._tableAlias),this._strategy.addCondition(t.get_attributeName(),"null",null,this._entityName,this._tableAlias),this._strategy.endWritingFilter())},e.prototype._visitFilterExpression=function(t){if(!Object(w.a)(t)){if(this._strategy.beginWritingFilter(t.get_filterOperator()),!Object(w.a)(t.get_conditions()))for(var e=0,n=t.get_conditions();e<n.length;e++){var r=n[e];this._visitConditionExpression(r)}if(!Object(w.a)(t.get_filterExpressions()))for(var i=0,a=t.get_filterExpressions();i<a.length;i++){var o=a[i];this._visitFilterExpression(o)}this._strategy.endWritingFilter()}},e.prototype._visitLinkEntityExpression=function(t){var e=this._entityName;this._tableAlias=t.get_tableAlias(),this._entityName=t.get_entityName(),this._strategy.beginWritingLinkEntity(t),this._visitColumnSetExpression(t.get_attributes()),this._visitFilterExpression(t.get_filterExpression()),this._strategy.addLinkEntityFromClause(t);for(var n=0,r=t.get_orderByAttributes();n<r.length;n++){var i=r[n];this._visitOrderByQueryExpression(i)}this._strategy.endWritingLinkEntity(t);for(var a=0,o=t.get_linkedEntities();a<o.length;a++){var s=o[a];this._visitLinkEntityExpression(s)}this._entityName=e},e.prototype._visitOrderByQueryExpression=function(t){this._strategy.addOrderByClause(t,this._tableAlias)},e.prototype.visitEntityExpression=function(t){this._tableAlias=t.get_tableAlias(),this._entityName=t.get_entityName(),this._strategy.addLimitClause(t),this._strategy.addOffsetClause(t),this._visitColumnSetExpression(t.get_attributes());for(var e=0,n=t.get_orderByAttributes();e<n.length;e++){var r=n[e];this._visitOrderByQueryExpression(r)}this._strategy.addFromClause(t),this._visitFilterExpression(t.get_filterExpression());for(var i=0,a=t.get_linkedEntities();i<a.length;i++){var o=a[i];this._visitLinkEntityExpression(o)}},e}(I),G=function(t){function e(e,n){var r=t.call(this)||this;return r.set_strategy(e),r.set_visitor(new U(e)),r.set_entityQueryExpression(n),r}return Object(j.__extends)(e,t),e.prototype.getSql=function(){return this.get_visitor().visitEntityExpression(this.get_entityQueryExpression()),this.get_strategy().generateQueryText()},e}(q),W=n("hvVs"),J=function(){function t(){this.dateTimeBehavior=0}return t.prototype.validateAttribute=function(t,e){var n=R(t,e);if("datetime"!==n.get_type())throw Error.create("Attribute Type is not DateTime though the given condition operator is of DateTime type.");this.dateTimeBehavior=n.get_behavior()},t.prototype.getQueryForCondition=function(t,e,n,r){return this.validateAttribute(t,n),this.generateSQLiteQueryString(t,e,n,r)},t}(),z=n("86Ds"),K=n("LOQU"),$=function(t){function e(){var e=t.call(this)||this;return e.xValue=0,e.endUTCDate=null,e.currUTCDateMidnight=null,e}return Object(j.__extends)(e,t),e.prototype.setXValue=function(t){Object(z.b)(t,"Last X input Value"),this.xValue=Number.parseLocale(t),Object(z.a)(this.xValue,"Last X input Value cannot be negative")},e.prototype.setEndDate=function(){var t=Object(K.f)();this.endUTCDate=Object(K.a)(t,this.dateTimeBehavior),t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0),this.currUTCDateMidnight=Object(K.a)(t,this.dateTimeBehavior)},e}(J),Y=n("+h4s"),Z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){this.setXValue(r),this.setEndDate();var i=Object(Y.c)(this.currUTCDateMidnight,-1*this.xValue);return Object(K.d)(e,t,i,this.endUTCDate)},e}($),H=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){return"7",(new Z).getQueryForCondition(t,e,n,"7")},e}(J),tt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){var i=Object(K.f)(),a=new Date(i.getFullYear(),i.getMonth(),1),o=Object(Y.d)(a,-1);return o=Object(K.a)(o,this.dateTimeBehavior),a=Object(K.a)(a,this.dateTimeBehavior),Object(K.c)(e,t,o,a)},e}(J),et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){var i=Object(K.g)(),a=Object(Y.e)(i,-1);return a=Object(K.a)(a,this.dateTimeBehavior),i=Object(K.a)(i,this.dateTimeBehavior),Object(K.c)(e,t,a,i)},e}(J),nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){this.setXValue(r),this.setEndDate();var i=Object(Y.d)(this.currUTCDateMidnight,-1*this.xValue);return Object(K.d)(e,t,i,this.endUTCDate)},e}($),rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){this.setXValue(r),this.setEndDate();var i=Object(Y.e)(this.currUTCDateMidnight,-1*this.xValue);return Object(K.d)(e,t,i,this.endUTCDate)},e}($),it=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){this.setXValue(r),this.setEndDate();var i=Object(Y.f)(this.currUTCDateMidnight,-1*this.xValue);return Object(K.d)(e,t,i,this.endUTCDate)},e}($),at=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){var i=Object(K.f)(),a=new Date(i.getFullYear(),0,1),o=Object(Y.f)(a,-1);return o=Object(K.a)(o,this.dateTimeBehavior),a=Object(K.a)(a,this.dateTimeBehavior),Object(K.c)(e,t,o,a)},e}(J),ot=function(t){function e(){var e=t.call(this)||this;return e.xValue=0,e.startUTCDate=null,e.currUTCDateMidnight=null,e}return Object(j.__extends)(e,t),e.prototype.setXValue=function(t){Object(z.b)(t,"Next X input Value"),this.xValue=Number.parseLocale(t),Object(z.a)(this.xValue,"Next X input Value cannot be negative")},e.prototype.setStartDate=function(){var t=Object(K.f)();this.startUTCDate=Object(K.a)(t,this.dateTimeBehavior),(t.getHours()||t.getMinutes()||t.getSeconds()||t.getMilliseconds())&&(t=Object(Y.c)(t,1)),t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0),this.currUTCDateMidnight=Object(K.a)(t,this.dateTimeBehavior)},e}(J),st=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){this.setXValue(r),this.setStartDate();var i=Object(Y.c)(this.currUTCDateMidnight,this.xValue);return Object(K.c)(e,t,this.startUTCDate,i)},e}(ot),ut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){return"7",(new st).getQueryForCondition(t,e,n,"7")},e}(J),lt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){var i=Object(K.f)(),a=new Date(i.getFullYear(),i.getMonth(),1),o=Object(Y.d)(a,1),s=Object(Y.d)(o,1);return o=Object(K.a)(o,this.dateTimeBehavior),s=Object(K.a)(s,this.dateTimeBehavior),Object(K.c)(e,t,o,s)},e}(J),ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){var i=Object(K.g)(),a=Object(Y.e)(i,1),o=Object(Y.e)(a,1);return a=Object(K.a)(a,this.dateTimeBehavior),o=Object(K.a)(o,this.dateTimeBehavior),Object(K.c)(e,t,a,o)},e}(J),gt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){this.setXValue(r),this.setStartDate();var i=Object(Y.d)(this.currUTCDateMidnight,this.xValue);return Object(K.c)(e,t,this.startUTCDate,i)},e}(ot),pt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){this.setXValue(r),this.setStartDate();var i=Object(Y.e)(this.currUTCDateMidnight,this.xValue);return Object(K.c)(e,t,this.startUTCDate,i)},e}(ot),dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){this.setXValue(r),this.setStartDate();var i=Object(Y.f)(this.currUTCDateMidnight,this.xValue);return Object(K.c)(e,t,this.startUTCDate,i)},e}(ot),ht=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){var i=Object(K.f)(),a=new Date(i.getFullYear(),0,1),o=Object(Y.f)(a,1),s=Object(Y.f)(o,1);return o=Object(K.a)(o,this.dateTimeBehavior),s=Object(K.a)(s,this.dateTimeBehavior),Object(K.c)(e,t,o,s)},e}(J),ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){var i=Object(K.b)(r);i=Object(K.e)(i);var a=Object(Y.c)(i,1);return i=Object(K.a)(i,this.dateTimeBehavior),a=Object(K.a)(a,this.dateTimeBehavior),Object(K.c)(e,t,i,a)},e}(J),yt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){var i=Object(K.b)(r);i=Object(K.e)(i);var a=Object(K.a)(i,this.dateTimeBehavior);return this._CreateQuery(e,t,a)},e.prototype._CreateQuery=function(t,e,n){var r=Object(P.a)("rtrim([{0}].[{1}])",t,e),i=Object(Y.r)(n);return Object(P.a)(" {0} >= {1} ",r,i)},e}(J),bt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){var i=Object(K.b)(r);i=Object(K.e)(i),i=Object(Y.c)(i,1);var a=Object(K.a)(i,this.dateTimeBehavior);return this._CreateQuery(e,t,a)},e.prototype._CreateQuery=function(t,e,n){var r=Object(P.a)("rtrim([{0}].[{1}])",t,e),i=Object(Y.r)(n);return Object(P.a)(" {0} < {1} ",r,i)},e}(J),_t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){var i=Object(K.f)(),a=new Date(i.getFullYear(),i.getMonth(),1),o=Object(Y.d)(a,1);return a=Object(K.a)(a,this.dateTimeBehavior),o=Object(K.a)(o,this.dateTimeBehavior),Object(K.c)(e,t,a,o)},e}(J),mt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){var i=Object(K.g)(),a=Object(Y.e)(i,1);return i=Object(K.a)(i,this.dateTimeBehavior),a=Object(K.a)(a,this.dateTimeBehavior),Object(K.c)(e,t,i,a)},e}(J),Ot=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){var i=Object(K.f)(),a=new Date(i.getFullYear(),0,1),o=Object(Y.f)(a,1);return a=Object(K.a)(a,this.dateTimeBehavior),o=Object(K.a)(o,this.dateTimeBehavior),Object(K.c)(e,t,a,o)},e}(J),vt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQuery=function(t,e,n,r){var i=Object(K.f)(),a=Object(Y.c)(i,r);return(new ft).getQueryForCondition(t,e,n,a)},e}(J),jt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){return this.generateSQLiteQuery(t,e,n,0)},e}(vt),wt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){return this.generateSQLiteQuery(t,e,n,1)},e}(vt),St=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.__extends)(e,t),e.prototype.generateSQLiteQueryString=function(t,e,n,r){return this.generateSQLiteQuery(t,e,n,-1)},e}(vt),Ct=function(){function t(){this._LimitClause=null,this._OffsetClause=null,this._SelectClause=null,this._FromClause=null,this._JoinClauses=null,this._WhereClause=null,this._OrderByClause=null,this._DistinctClause=null,this._MUIAttributes=null,this._set_limitClause(new Sys.StringBuilder),this._set_offsetClause(new Sys.StringBuilder),this._set_selectClause(new Sys.StringBuilder),this.set_fromClause(null),this._set_joinClauses([]),this._set_whereClause(new Sys.StringBuilder),this._set_orderByClause(new Sys.StringBuilder),this._set_distinctClause(new Sys.StringBuilder),this._set_muiAttributes({})}return t.prototype.get_limitClause=function(){return this._LimitClause},t.prototype._set_limitClause=function(t){return this._LimitClause=t,t},t.prototype.get_offsetClause=function(){return this._OffsetClause},t.prototype._set_offsetClause=function(t){return this._OffsetClause=t,t},t.prototype.get_selectClause=function(){return this._SelectClause},t.prototype._set_selectClause=function(t){return this._SelectClause=t,t},t.prototype.get_fromClause=function(){return this._FromClause},t.prototype.set_fromClause=function(t){return this._FromClause=t,t},t.prototype.get_joinClauses=function(){return this._JoinClauses},t.prototype._set_joinClauses=function(t){return this._JoinClauses=t,t},t.prototype.get_whereClause=function(){return this._WhereClause},t.prototype._set_whereClause=function(t){return this._WhereClause=t,t},t.prototype.get_orderByClause=function(){return this._OrderByClause},t.prototype._set_orderByClause=function(t){return this._OrderByClause=t,t},t.prototype.get_distinctClause=function(){return this._DistinctClause},t.prototype._set_distinctClause=function(t){return this._DistinctClause=t,t},t.prototype.get_muiAttributes=function(){return this._MUIAttributes},t.prototype._set_muiAttributes=function(t){return this._MUIAttributes=t,t},t}(),Et=function(){function t(t,e,n){this._FromClauseFormat=null,this._Entity=null,this._set_fromClauseFormat(e),this._set_entity(n)}return t.prototype.get_fromClauseFormat=function(){return this._FromClauseFormat},t.prototype._set_fromClauseFormat=function(t){return this._FromClauseFormat=t,t},t.prototype.get_entity=function(){return this._Entity},t.prototype._set_entity=function(t){return this._Entity=t,t},t}(),At=function(){function t(t){this._sqlClause=null,this._logicalOperator=null,this._conditionCount=0,this._logicalOperator=t,this._sqlClause=new Sys.StringBuilder,this._conditionCount=0}return t.prototype.appendCondition=function(t){Object(w.b)(t)||(this._conditionCount>0&&this._sqlClause.append(Object(P.a)(" {0} ",this._logicalOperator)),this._sqlClause.append(t),this._conditionCount++)},t.prototype.getSql=function(){return this._sqlClause.toString().length>0?"("+this._sqlClause.toString()+")":""},t}(),Nt=function(){function t(){this._ConditionBuilders=null,this.set_conditionBuilders([])}return t.prototype.BeginWritingFilter=function(t){this.get_conditionBuilders().push(this.createConditionBuilder(t))},t.prototype.EndWritingFilter=function(){var t=this.get_conditionBuilders()[this.get_conditionBuilders().length-1];if(this.get_conditionBuilders().splice(this.get_conditionBuilders().length-1,1),this.get_conditionBuilders().length>0)this.get_conditionBuilders()[this.get_conditionBuilders().length-1].appendCondition(t.getSql());else{var e=t.getSql();this.get_WhereClause().toString().length>0&&e.length>0&&this.get_WhereClause().append(Object(P.a)(" {0} ",X(0))),this.get_WhereClause().append(e)}},t.prototype.createConditionBuilder=function(t){return new At(X(t))},t.prototype.AppendCondition=function(t){this.get_conditionBuilders()[this.get_conditionBuilders().length-1].appendCondition(t)},t.prototype.GetSql=function(){return this.get_WhereClause().toString()},t.prototype.get_conditionBuilders=function(){return this._ConditionBuilders},t.prototype.set_conditionBuilders=function(t){return this._ConditionBuilders=t,t},t}(),xt=function(t){function e(){var e=t.call(this)||this;return e._whereClause=new Sys.StringBuilder,e}return Object(j.__extends)(e,t),e.prototype.get_WhereClause=function(){return this._whereClause},e.prototype.GetSql=function(){if(0!==this.get_conditionBuilders().length)throw Error.create("The ConditionBuilders stack is not empty - the generation of the LinkEntityPredicate is not complete, which means the SQL cannot be generated for it yet");return t.prototype.GetSql.call(this)},e.prototype.Reset=function(){this._whereClause.clear(),this.set_conditionBuilders([])},e}(Nt),kt=function(){function t(t,e,n){this._JoinCount=0,this._AttributeMetadata=null,this.set_attributeMetadata(t),this.set_joinCount(n)}return t.prototype.get_joinCount=function(){return this._JoinCount},t.prototype.set_joinCount=function(t){return this._JoinCount=t,t},t.prototype.get_attributeMetadata=function(){return this._AttributeMetadata},t.prototype.set_attributeMetadata=function(t){return this._AttributeMetadata=t,t},t}(),Lt=function(t){function e(e){var n=t.call(this)||this;return n._set_queryContainer(e),n}return Object(j.__extends)(e,t),e.prototype.get_WhereClause=function(){return this.get_queryContainer().get_whereClause()},e.prototype.get_queryContainer=function(){return this._QueryContainer},e.prototype._set_queryContainer=function(t){return this._QueryContainer=t,t},e}(Nt),Qt=n("DlaX"),Ft=function(){function t(){this.queryContainer=null,this._predicateBuilders=null,this.localizedLabelJoinCounter=-1,this.queryContainer=new Ct,this._predicateBuilders=[],this._predicateBuilders.push(new Lt(this.queryContainer))}return t.prototype.get_muiAttributes=function(){return this.queryContainer.get_muiAttributes()},t.prototype.get_languageId=function(){return M.a.get_DefaultInstance().get_UserContext().get_UserSettings().get_languageId()},t.prototype.get_baseLanguageId=function(){return M.a.get_DefaultInstance().get_UserContext().get_organizationSettings().get_languageCode()},t.prototype.get_needTwoJoinsToLocalizedLabelTable=function(){return this.get_languageId()!==this.get_baseLanguageId()},t.prototype._get_CurrentPredicateBuilder=function(){return this._predicateBuilders[this._predicateBuilders.length-1]},t.prototype.addAttribute=function(t,e){this.throwIfNullOrUndefined(t.get_entity(),"AttributeQueryExpression has no parent EntityQueryExpression");var n=M.a.get_DefaultInstance().get_MetadataCache().getAttributeMetadata(t.get_entity().get_entityName(),t.get_name());this.throwIfNullOrUndefined(n,Object(P.a)("attributeMetadata: {0}.{1}",t.get_entity().get_entityName(),t.get_name())),this.throwIfAttributeUnsupported(n);var r=t.get_entity().get_entityName(),i=M.a.get_DefaultInstance().get_MetadataCache().getEntityMetadata(r);this.throwIfNullOrUndefined(i,Object(P.a)("entityMetadata: ",r)),this._HasMultipleLabels(n,i)?this.queryContainer.get_selectClause().append(this._GetLocalizedAttributeName(e,n,i)):this.queryContainer.get_selectClause().append(Object(P.a)("{0} [{1}].[{2}] as [{3}]",Object(w.b)(this.queryContainer.get_selectClause().toString())?"":",",e,this.getAttributePhysicalName(t.get_name(),t.get_entity().get_entityName()),this._GetResultColumnName(t))),this.addChildAttributes(t.get_name(),t.get_entity().get_entityName(),e)},t.prototype._GetResultColumnName=function(t){var e=this.getAttributePhysicalName(t.get_name(),t.get_entity().get_entityName());return Object(w.b)(t.get_entity().get_Alias())||(e=t.get_entity().get_Alias()+"."+e),e},t.prototype.addFromClause=function(t){var e=new Sys.StringBuilder;e.append(Object(P.a)("[{{0}}] as [{1}]",t.get_entityName(),t.get_tableAlias())),e.append(this.localizedOuterJoinClause(t).toString()),this.queryContainer.set_fromClause(new Et(t.get_tableAlias(),e.toString(),t.get_entityName()))},t.prototype.addLinkEntityFromClause=function(t){var e=t.get_parentEntity().get_tableAlias(),n=new Sys.StringBuilder,r=this._GetLinkAttribute(t,t.get_linkToAttribute(),t.get_parentEntity().get_entityName()),i=this._GetLinkAttribute(t,t.get_linkFromAttribute(),t.get_entityName()),a=this.getAttributePhysicalName(r,t.get_parentEntity().get_entityName()),o=this.getAttributePhysicalName(i,t.get_entityName()),s=Object(P.a)(" [{1}].[{0}] ",a,e);if(n.append(Object(P.a)(" {0} ",function(t){switch(t){case 0:return"inner join";case m.leftOuter:return"left outer join";default:throw Error.create("Invalid join operator type!")}}(t.get_joinType()))),n.append(Object(P.a)("[{0}] as [{1}]",t.get_entityName(),t.get_tableAlias())),n.append(Object(P.a)(" on ({0} {1} [{2}].[{3}]",s,D(t.get_conditionOperator()),t.get_tableAlias(),o)),this._get_CurrentPredicateBuilder()instanceof xt){var u=this._get_CurrentPredicateBuilder();if(null!==u){var l=u.GetSql();l.length>0&&n.append(Object(P.a)(" and {0}",l)),u.Reset(),n.append(")")}}n.append(this.localizedOuterJoinClause(t).toString()),this.queryContainer.get_joinClauses().push(new Et(t.get_tableAlias(),n.toString(),t.get_entityName()))},t.prototype._GetLinkAttribute=function(t,e,n){var r=e;if((Object(w.a)(r)||Object(w.b)(r))&&!Object(w.a)(n)){var i=M.a.get_DefaultInstance().get_MetadataCache().getEntityMetadata(n);Object(w.a)(i)||(r=i.get_primaryIdAttribute())}return r},t.prototype.addCondition=function(t,e,n,r,i){var a,o=new Sys.StringBuilder,s=this.getAttributePhysicalName(t,r),u="";if(this.throwIfOperationOnAttributeNotSupported(t,r,e),!Object(w.a)(n)||this._IsConditionWithNoValue(e))switch(e){case"in":case"not-in":var l=new Sys.StringBuilder;a=n;for(var c=0;c<a.length;c++)l.toString().length>0&&l.append(", "),l.append(Object(P.a)("'{0}'",this._GetOperandValue(t,r,a[c])));u=Object(P.a)("({0})",l.toString()),o.append(this.getQueryForCondition(i,t,r,e,u));break;case"between":case"not between":a=n,u=Object(P.a)("'{0}' and '{1}'",this._GetOperandValue(t,r,a[0]),this._GetOperandValue(t,r,a[1])),o.append(this.getQueryForCondition(i,t,r,e,u));break;case"begins-with":case"ends-with":case"not-begin-with":case"not-end-with":"begins-with"===e||"not-begin-with"===e?u=Object(P.a)("'{0}%'",this._GetOperandValue(t,r,n)):"ends-with"!==e&&"not-end-with"!==e||(u=Object(P.a)("'%{0}'",this._GetOperandValue(t,r,n))),o.append(this.getQueryForCondition(i,t,r,e,u));break;case"eq-userid":case"ne-userid":u=Object(P.a)("'{0}'",M.a.get_DefaultInstance().get_UserContext().get_UserId().toString()),o.append(this.getQueryForCondition(i,t,r,e,u));break;case"eq-userteams":case"eq-useroruserteams":u=this._GenerateConditionForOwnerTypeOperator(e,i,s),o.append(this.getQueryForCondition(i,t,r,e,u));break;case"on":var g=new ft;o.append(g.getQueryForCondition(s,i,r,n));break;case"on-or-before":var p=new bt;o.append(p.getQueryForCondition(s,i,r,n));break;case"on-or-after":var d=new yt;o.append(d.getQueryForCondition(s,i,r,n));break;case"today":var h=new jt;o.append(h.getQueryForCondition(s,i,r,n));break;case"yesterday":var f=new St;o.append(f.getQueryForCondition(s,i,r,n));break;case"tomorrow":var y=new wt;o.append(y.getQueryForCondition(s,i,r,n));break;case"last-week":var b=new et;o.append(b.getQueryForCondition(s,i,r,n));break;case"this-week":var _=new mt;o.append(_.getQueryForCondition(s,i,r,n));break;case"next-week":var m=new ct;o.append(m.getQueryForCondition(s,i,r,n));break;case"last-month":var O=new tt;o.append(O.getQueryForCondition(s,i,r,n));break;case"this-month":var v=new _t;o.append(v.getQueryForCondition(s,i,r,n));break;case"next-month":var j=new lt;o.append(j.getQueryForCondition(s,i,r,n));break;case"last-year":var S=new at;o.append(S.getQueryForCondition(s,i,r,n));break;case"this-year":var C=new Ot;o.append(C.getQueryForCondition(s,i,r,n));break;case"next-year":var E=new ht;o.append(E.getQueryForCondition(s,i,r,n));break;case"last-seven-days":var A=new H;o.append(A.getQueryForCondition(s,i,r,n));break;case"next-seven-days":var N=new ut;o.append(N.getQueryForCondition(s,i,r,n));break;case"last-x-days":var x=new Z;o.append(x.getQueryForCondition(s,i,r,n));break;case"next-x-days":var k=new st;o.append(k.getQueryForCondition(s,i,r,n));break;case"last-x-weeks":var L=new rt;o.append(L.getQueryForCondition(s,i,r,n));break;case"next-x-weeks":var Q=new pt;o.append(Q.getQueryForCondition(s,i,r,n));break;case"last-x-months":var F=new nt;o.append(F.getQueryForCondition(s,i,r,n));break;case"next-x-months":var T=new gt;o.append(T.getQueryForCondition(s,i,r,n));break;case"last-x-years":var V=new it;o.append(V.getQueryForCondition(s,i,r,n));break;case"next-x-years":var B=new dt;o.append(B.getQueryForCondition(s,i,r,n));break;case"null":o.append(Object(P.a)("[{0}].[{1}] is null ",i,s));break;case"not-null":o.append(Object(P.a)("[{0}].[{1}] is not null ",i,s));break;default:u=Object(P.a)("'{0}'",this._GetOperandValue(t,r,n)),o.append(this.getQueryForCondition(i,t,r,e,u))}this._get_CurrentPredicateBuilder().AppendCondition(o.toString())},t.prototype.throwIfOperationOnAttributeNotSupported=function(t,e,n){},t.prototype.getQueryForCondition=function(t,e,n,r,i){var a=new Sys.StringBuilder;return this._AddQueryForConditionAttribute(e,n,t,a),a.append(Object(P.a)(" {0} {1}",D(r),i)),a.toString()},t.prototype.beginWritingFilter=function(t){this._get_CurrentPredicateBuilder().BeginWritingFilter(t)},t.prototype.endWritingFilter=function(){this._get_CurrentPredicateBuilder().EndWritingFilter()},t.prototype.beginWritingLinkEntity=function(t){var e=new xt;this._predicateBuilders.push(e)},t.prototype.endWritingLinkEntity=function(t){this._predicateBuilders.splice(this._predicateBuilders.length-1,1)},t.prototype.addChildAttributes=function(t,e,n){},t.prototype.throwIfAttributeUnsupported=function(t){},t.prototype.throwIfNullOrUndefined=function(t,e){if(Object(w.a)(t))throw Error.create(Object(P.a)("Argument {0} cannot be null or undefined",e))},t.prototype.addLimitClause=function(t){if(!Object(w.a)(t.get_top())&&t.get_useLimitStatement()){if(t.get_top()<0)throw Error.create("Limit must be a positive integer");this.queryContainer.get_limitClause().append(Object(P.a)(" LIMIT {0}",t.get_top()))}},t.prototype.addOffsetClause=function(t){if(!Object(w.a)(t.get_offset())&&t.get_useLimitStatement()){if(t.get_offset()<0)throw Error.create("Offset must be a positive integer");t.get_offset()>0&&this.queryContainer.get_limitClause().append(Object(P.a)(" OFFSET {0}",t.get_offset()))}},t.prototype.addOrderByClause=function(t,e){if(Object(w.a)(t.get_entity()))throw Error.create("orderByQueryExpression has no parent EntityQueryExpression");this.queryContainer.get_orderByClause().toString().length>0&&(this.queryContainer.get_orderByClause().appendLine(),this.queryContainer.get_orderByClause().append(", "));var n=new Sys.StringBuilder;n.append(Object(P.a)("[{0}].[{1}]",e,this.getAttributePhysicalName(t.get_name(),t.get_entity().get_entityName()))),n.append(Object(P.a)(" {0}",t.get_descending()?"desc":"asc")),this.queryContainer.get_orderByClause().append(n)},t.prototype.generateQueryText=function(){var t=new Sys.StringBuilder;return this._GenerateSelectQuery(t),t.toString()},t.prototype.getAttributePhysicalName=function(t,e){return t},t.prototype._AddQueryForConditionAttribute=function(t,e,n,r){if(function(t,e){var n=R(t,e);if(!Object(w.a)(n.get_attributeOf()))switch(R(n.get_attributeOf(),e).get_type()){case"boolean":case"picklist":case"state":case"status":return!0;default:return!1}return!1}(t,e)){var i=R(t,e),a=R(i.get_attributeOf(),e);this._AddPicklistCaseStatement(a,r,n)}else r.append(Object(P.a)("[{0}].[{1}]",n,this.getAttributePhysicalName(t,e)))},t.prototype._AddPicklistCaseStatement=function(t,e,n){var r=t.get_optionSet();if(Object(w.a)(r)||Object(w.a)(r.get_options())||0===Object.keys(r.get_options()).length)e.append(" null ");else{e.append(Object(P.a)("case [{0}].[{1}]",n,t.get_logicalName()));var i=r.get_options();for(var a in i){var o={key:a,value:i[a]}.value;e.append(Object(P.a)(" when {0} then '{1}'",o.get_value(),o.get_Label()))}e.append(" else null"),e.append(" end ")}},t.prototype._GenerateSelectQuery=function(t){t.append("select \n"),this.queryContainer.get_distinctClause().toString().length>0&&t.append(Object(P.a)("{0} ",this.queryContainer.get_distinctClause().toString()));var e=this._GenerateFromClause();t.append(Object(P.a)("{0} \nfrom\n {1}",this.queryContainer.get_selectClause().toString(),e)),this._get_CurrentPredicateBuilder().get_WhereClause().toString().length>0&&t.append(Object(P.a)(" \nwhere\n {0} COLLATE NOCASE",this._get_CurrentPredicateBuilder().get_WhereClause().toString())),this.queryContainer.get_orderByClause().toString().length>0&&t.append(Object(P.a)(" order by\n {0}",this.queryContainer.get_orderByClause().toString())),this.queryContainer.get_limitClause().toString().length>0&&t.append(Object(P.a)("{0} ",this.queryContainer.get_limitClause().toString())),this.queryContainer.get_offsetClause().toString().length>0&&t.append(Object(P.a)("{0} ",this.queryContainer.get_offsetClause().toString()))},t.prototype._GenerateFromClause=function(){var t=new Sys.StringBuilder;t.append(Object(P.a)(this.queryContainer.get_fromClause().get_fromClauseFormat(),this.queryContainer.get_fromClause().get_entity()));for(var e=0,n=this.queryContainer.get_joinClauses();e<n.length;e++){var r=n[e];t.append(Object(P.a)(r.get_fromClauseFormat(),r.get_entity()))}return t.toString()},t.prototype._GetOperandValue=function(t,e,n){if(Object(w.a)(t)||Object(w.a)(e))throw Error.create("Attribute name or entity name cannot be null or undefined");var r=R(t,e),i=this._IsEntityNameAttribute(r)?this._GetEntityName(n):n;return this._FormatOperandValue(i,r.get_type())},t.prototype._FormatOperandValue=function(t,e){if(!Object(w.a)(t))switch(e){case"lookup":case"customer":case"owner":case"uniqueidentifier":var n=new O.a(t.toString());t=n.toString();break;case"datetime":t=Object(Qt.d)(t).trim()}return t},t.prototype._IsEntityNameAttribute=function(t){return!Object(w.a)(t)&&"entityname"===t.get_type()},t.prototype._GetEntityName=function(t){Object(w.a)(t)&&Error.create("Entity with null otc is not possible");var e=M.a.get_DefaultInstance().get_MetadataCache().getEntityMetadataByTypeCode(t).get_logicalName();return Object(w.a)(e)&&Error.create(Object(P.a)("Entity with otc {0} is not found in cache",t)),e},t.prototype.localizedOuterJoinClause=function(t){var e=new Sys.StringBuilder,n=t.get_tableAlias();if(n in this.get_muiAttributes())for(var r=t.get_entityName(),i=M.a.get_DefaultInstance().get_MetadataCache().getEntityMetadata(r),a=0;a<this.get_muiAttributes()[n].length;a++)e.append(this.getLocalizedLabelJoinClause(this.get_muiAttributes()[n][a],n,i));return e},t.prototype.getLocalizedLabelJoinClause=function(t,e,n){var r=new Sys.StringBuilder,i=t.get_joinCount(),a="LL"+i;return r.append(this.getLocalizedLabelJoinQuery(e,n.get_primaryIdAttribute(),this.get_languageId(),a,t.get_attributeMetadata().get_logicalName())),this.get_needTwoJoinsToLocalizedLabelTable()&&(a="LL"+ ++i,r.append(this.getLocalizedLabelJoinQuery(e,n.get_primaryIdAttribute(),this.get_baseLanguageId(),a,t.get_attributeMetadata().get_logicalName()))),r},t.prototype.getLocalizedLabelJoinQuery=function(t,e,n,r,i){var a=new Sys.StringBuilder;return a.append(String.format('\n left outer join {0} as "{1}" on ("{1}".[ObjectId] = "{2}".{3} and "{1}".LanguageId = {4} and "{1}".{5} like "%{6}%" )',"businessdatalocalizedlabel",r,t,e,n,"objectcolumnname",i)),a},t.prototype._HasMultipleLabels=function(t,e){return!(Object(w.a)(t)||!t.get_isLocalizable()||Object(w.a)(e)||!e.get_usesBusinessDataLabelTable()||!this.get_needTwoJoinsToLocalizedLabelTable())},t.prototype._GetLocalizedAttributeName=function(t,e,n){this.localizedLabelJoinCounter++,t in this.get_muiAttributes()||(this.get_muiAttributes()[t]=[]),this.get_muiAttributes()[t].push(new kt(e,n,this.localizedLabelJoinCounter));var r=Object(P.a)('"LL{0}".Label',this.localizedLabelJoinCounter.toString());this.localizedLabelJoinCounter++;var i=Object(P.a)('"LL{0}".Label',this.localizedLabelJoinCounter.toString());return Object(P.a)(" {4} cast(coalesce({0},{1}, [{2}].[{3}]) as varchar(2000)) as [{3}] ",r,i,t,e.get_logicalName(),Object(w.b)(this.queryContainer.get_selectClause().toString())?"":",")},t.prototype._IsConditionWithNoValue=function(t){return this._IsOwnerTypeOperator(t)||Object(K.h)(t)||this._IsNullOperator(t)},t.prototype._IsNullOperator=function(t){switch(t){case"null":case"not-null":return!0;default:return!1}},t.prototype._IsOwnerTypeOperator=function(t){switch(t){case"eq-userid":case"ne-userid":case"eq-userteams":case"eq-useroruserteams":return!0;default:return!1}},t.prototype._GenerateConditionForOwnerTypeOperator=function(t,e,n){var r=M.a.get_DefaultInstance().get_UserContext().get_UserId().toString(),i=new Sys.StringBuilder(String.format("(SELECT TeamId FROM TeamMembership WHERE SystemUserId = '{0}')",r));return"eq-useroruserteams"===t&&i.append(Object(P.a)(" or {0}.[{1}] = '{2}'",e,n,r)),i.toString()},t}(),Tt=n("wfK0"),Vt=n("cBeX"),Bt=n("WE7+");var qt,It=n("9L5C"),Pt=n("3cK6"),Mt=((qt={}).uniqueidentifier=["null","not-null","in","not-in","eq","ne","gt","ge","lt","le","eq-userid","ne-userid"],qt.boolean=["null","not-null","eq","ne","like","not-like","begins-with","not-begin-with","ends-with","not-end-with","in","not-in"],qt.string=["null","not-null","eq","ne","like","not-like","begins-with","not-begin-with","ends-with","not-end-with"],qt.picklist=["null","not-null","eq","ne","like","not-like","begins-with","not-begin-with","ends-with","not-end-with","in","not-in"],qt.state=["null","not-null","eq","ne","like","not-like","begins-with","not-begin-with","ends-with","not-end-with","in","not-in"],qt.status=["null","not-null","eq","ne","like","not-like","begins-with","not-begin-with","ends-with","not-end-with","in","not-in"],qt.entityname=["null","not-null","eq","ne","like","not-like","begins-with","not-begin-with","ends-with","not-end-with","in","not-in"],qt.customer=["null","not-null","eq","ne","in","not-in"],qt.lookup=["null","not-null","in","not-in","eq","ne","eq-userid","ne-userid"],qt.owner=["null","not-null","in","not-in","eq","ne","eq-userid","ne-userid","eq-userteams","eq-useroruserteams"],qt.integer=["eq","ne","null","not-null","gt","ge","lt","le"],qt.bigint=["eq","ne","null","not-null","gt","ge","lt","le"],qt.double=["eq","ne","null","not-null","gt","ge","lt","le"],qt.decimal=["eq","ne","null","not-null","gt","ge","lt","le"],qt.money=["eq","ne","null","not-null","gt","ge","lt","le"],qt.datetime=["on-or-after","on","on-or-before","today","tomorrow","yesterday","next-seven-days","last-seven-days","next-week","last-week","this-week","next-month","last-month","this-month","next-year","last-year","this-year","last-x-days","next-x-days","last-x-weeks","next-x-weeks","last-x-months","next-x-months","last-x-years","next-x-years","not-null","null","not-null","eq","ne","gt","ge","lt","le"],qt),Dt=function(t){function e(){var e=t.call(this)||this;return e._attributeMapper=new Tt.a,e}return Object(j.__extends)(e,t),e.prototype.addChildAttributes=function(t,e,n){this.throwIfNullOrUndefined(t,"attributeName"),this.throwIfNullOrUndefined(e,"entityName");var r=M.a.get_DefaultInstance().get_MetadataCache().getAttributeMetadata(e,t);this.throwIfNullOrUndefined(r,Object(P.a)("attributeMetadata: {0}.{1}",e,t)),this._attributeMapper.isComplexAttribute(r.get_type())&&this._AddChildAttributesInternal(t,r,e,n)},e.prototype._AddChildAttributesInternal=function(t,e,n,r){for(var i=Object(It.a)(t,e.get_type()),a=this.getAttributePhysicalName(t,n),o=0,s=i;o<s.length;o++){var u=s[o];u!==a&&this.queryContainer.get_selectClause().append(Object(P.a)("{0} [{1}].[{2}] as [{2}]",Object(w.b)(this.queryContainer.get_selectClause().toString())?"":",",r,u))}},e.prototype.throwIfAttributeUnsupported=function(t){if(!function(t){var e=!0;return Object(Vt.d)(t.get_type())&&(Bt.a.get_DefaultInstance().get_offlineTypescriptInterface().isDssOfflineEnabled()||Object(w.a)(t.get_attributeOf()))||(e=!1),e}(t))throw Error.create(Object(P.a)("Attribute type {0} for attribute {1} not supported in offline",t.get_type(),t.get_logicalName()))},e.prototype.getAttributePhysicalName=function(t,e){if(Object(w.a)(t)||Object(w.a)(e))throw Error.create("Attribute name or entity name cannot be null or undefined");var n=null;return(t=Object(Pt.a)(M.a.get_DefaultInstance().get_MetadataCache(),e,t,Object(W.a)((function(){return n}),(function(t){return n=t})))).endsWith("]")&&t.startsWith("[")&&(t=t.substring(1,t.length-1)),t},e.prototype.throwIfOperationOnAttributeNotSupported=function(t,e,n){if(Object(w.a)(t)||Object(w.a)(e))throw Error.create("Attribute name or entity name cannot be null or undefined");var r=R(t,e);if(!Object(w.a)(r)&&r.get_type()in Mt&&Mt[r.get_type()].indexOf(n)<0)throw Error.create(Object(P.a)("Condition Operation {0} is not supported on Attribute Type {1}",n,r.get_type()))},e.prototype.getLocalizedLabelJoinQuery=function(t,e,n,r,i){var a=new Sys.StringBuilder;return a.append(String.format('\n left outer join {0} as "{1}" on ("{1}".[ObjectId!id] = "{2}".{3} and "{1}".LanguageId = {4} and "{1}".{5} like "%{6}%" )',"businessdatalocalizedlabel",r,t,e,n,"objectcolumnname",i)),a},e}(Ft),Xt=n("qe9Z"),Rt=n("7WOp"),Ut=n("CO6B"),Gt=n("QAhb"),Wt=n("SApI"),Jt=n("Ev4I"),zt=n("GYKs"),Kt={createSqlfromEntityQueryExpression:function(t){t.set_useLimitStatement(!1);var e=new G(new Dt,t);try{return e.getSql()}catch(t){throw c.c.error("Error While Generating Sql "),t}},convertToOdataFormatResponse:function(t,e,n){var r=t.get_fieldNames();r&&r.length>0&&r.forEach((function(n){e&&e.get_select()&&e.get_select().get_attributeNames().length&&-1===e.get_select().get_attributeNames().indexOf(n)||t.markFieldChanged(n)}));return Object(Rt.b)(n.getState(),t,1)},addNextPageLinkIfRequired:function(t,e,n,r,i){var a;if(n&&!(r&&r.get_top()>0&&Kt.getPageNumber(r)*Kt.getPageSize(r,i)>=r.get_top())){var o="";if(r.get_skipToken()){o="?";var s=r.get_queryParameters();Object.keys(s).forEach((function(t){t===p.c.SkipTokenQueryOption&&(s[p.c.SkipTokenQueryOption]=e.get_offset()+1),o+=String.format("&{0}={1}",t,s[t])}))}else o=r.get_requestUri()?r.get_requestUri()+String.format("&{0}={1}",p.c.SkipTokenQueryOption,e.get_offset()+1):"?"+String.format("&{0}={1}",p.c.SkipTokenQueryOption,e.get_offset()+1);t[p.c.ODataNextLinkString]=((a={})[p.d.API]=p.d.retrieveRecord,a[p.d.EntityType]=e.get_entityName(),a[p.d.Options]=o,a[p.d.MaxPageSize]=i,a)}},getRelationshipFetchXml:function(t,e,n,r){var i=null;if(e){var a=["schemaName","relationshipType"],o=e[a[0]];switch(e[a[1]]){case 2:var u=Object(s.x)(r,t,o);i=String.format('<fetch mapping=\'logical\'><entity name=\'{0}\'><attribute name=\'{1}\'/><link-entity name="{2}" from="{3}" to="{4}" alias="{2}_1"><filter type="and"><condition attribute="{5}" operator="eq" uitype="{2}" /></filter></link-entity></entity></fetch>',u.ReferencedEntity,Object(s.h)(r,u.ReferencedEntity).PrimaryKeyName,u.ReferencingEntity,u.ReferencingAttribute,u.ReferencedAttribute,Object(s.h)(r,u.ReferencingEntity).PrimaryKeyName);break;case 0:var l=Object(s.B)(r,t,o),c=d.a.fromXml(String.format("<fetch mapping='logical'><entity name='{0}'><attribute name='{1}'/></entity></fetch>",l.ReferencingEntity,Object(s.h)(r,l.ReferencingEntity).PrimaryKeyName));c.applyContextFilter(o,n,r),i=c.getKeyQuery().get_FetchXml();break;case 1:var g=Object(s.u)(r,t,o),p=void 0;p=g.Entity1LogicalName===t?g.Entity2LogicalName:g.Entity1LogicalName;var h=d.a.fromXml(String.format("<fetch mapping='logical'><entity name='{0}'><attribute name='{1}'/></entity></fetch>",p,Object(s.h)(r,p).PrimaryKeyName));h.applyContextFilter(o,n,r),i=h.getKeyQuery().get_FetchXml()}}return i},createEntityQueryExpressionFromFetchXml:function(t){if(!t||""===t)throw new Error("FetchXml string is empty or null");var e=new x(null);try{e.initializeFromFetchXml(t)}catch(t){throw c.c.error("Exception in Create Entity Query Expression From FetchXml is "+Object(a.e)(t)),new Error("Exception in Create Entity Query Expression From FetchXml")}return e},createEntityQueryExpressionFromODataUri:function(t,e,n,r){if(!e||""===e)throw new Error("entityName is null or empty");if(!n)throw new Error("oDataqueryOptions object is null or undefined");var i=new x(e);if(n.get_select()&&n.get_select().get_attributeNames().length>0){c.c.info("oDataqueryOptions has select option");var a=i.get_tableAlias();n.get_select().get_attributeNames().forEach((function(n){i.addAttribute(Object(Wt.d)(t,e,n),a)}))}n.get_filter()&&n.get_filter().get_filterExpression()?i.set_filterExpression(n.get_filter().get_filterExpression()):c.c.info("oDataqueryOptions has no filter option"),n.get_orderBy()&&n.get_orderBy().get_orderByTermTokens().length>0&&(c.c.info("oDataqueryOptions has orderby option"),n.get_orderBy().get_orderByTermTokens().forEach((function(t){i.addOrderByAttribute(t.get_attributeName(),t.get_isDescending())})));return i.set_top(Kt.getPageSize(n,r)),i.set_offset(Kt.getPageNumber(n)),i},createQueryFromEntityQueryExpression:function(t,e){var n=Kt.createSqlfromEntityQueryExpression(t);c.c.info("Sql generated from EQE of entity: "+t.get_entityName()+" with sql value: "+n);var r=new Xt.a(new V.a,e);return r.set_EntityLogicalName(t.get_entityName()),Yt(r,t,n),r.set_PageSize(t.get_top()),r.set_PageNumber(t.get_offset()),r},convertToRetrieveMultipleOdataFormat:function(t,e,n,r,i){var a,o=new Array,u=e.get_entities(),l=u.length;n&&n.get_top()>0&&t.get_top()<n.get_top()&&n.get_top()-t.get_offset()*t.get_top()<0&&(l=n.get_top()-(t.get_offset()-1)*t.get_top());for(var c=function(e){var r=Kt.convertToOdataFormatResponse(u[e],n,i);n&&n.get_expand()&&n.get_expand().get_expandTerms().forEach((function(n){var a;r[n.get_navigationProperty().concat(p.c.ODataNextLinkString)]=((a={})[p.d.API]=p.d.retrieveRecord,a[p.d.Id]=u[e].get_identifier().get_identifier().toString(),a[p.d.EntityType]=t.get_entityName(),a[p.d.Options]=String.format("?$select={0}&{1}&$getOnlyRelatedEntity=true",Object(s.D)(i.getState(),t.get_entityName()),n.get_expandTermString()),a),r[n.get_navigationProperty()]={}})),o.push(r)},g=0;g<l;g++)c(g);var d=((a={})[p.b.Value]=o,a);return Kt.addNextPageLinkIfRequired(d,t,e.get_moreRecords(),n,r),d},getRelatedEntities:function(t,e,n,r){var o=[];try{if(!t)throw c.c.error("Record value is null"),new i.a("Record value is null");if(!e||0===e.get_expandTerms().length)return Promise.resolve(t);e.get_expandTerms().forEach((function(e){var a=e.get_navigationProperty();if(c.c.info("Expand expression has navigation property value is "+a),!n.has(a))throw c.c.error("Navigation property is not present"),new i.a(Object(u.a)(-7022,[a,t.get_identifier().LogicalName]),-7022);var s=n.get(a);o.push(Kt.retrieveMultipleRecordsFromNavProp(s,t,e,r))}))}catch(t){return c.c.error("getRelatedEntities fails "+Object(a.e)(t)),Promise.reject(v.a.FromMessage(t.message,null))}return Promise.all(o).then((function(e){return e.forEach((function(e){var n=e,r=n.get_query().get_relationship();t.get_relatedEntities().addRelationship(r,n)})),Promise.resolve(t)})).catch((function(t){return c.c.error("getRelatedEntities fails "+Object(a.e)(t)),Promise.reject(t)}))},addAttributeToEQE:function(t,e,n){if(!t)throw new Error("EntityQueryExpression is null");if(0!==t.get_attributes().length||e&&e.get_selectOption()&&0!==e.get_selectOption().get_attributeNames().length){var r=new Array;if(e&&e.get_selectOption()&&e.get_selectOption().get_attributeNames().length>0){c.c.info("Expand has attribute and length is "+e.get_selectOption().get_attributeNames().length),t.get_attributes().forEach((function(t){r.push(t.get_name())}));var i=t.get_tableAlias();e.get_selectOption().get_attributeNames().forEach((function(e){-1===r.indexOf(e)&&(t.addAttribute(e,i),r.push(e))}))}var a=Object(s.D)(n,t.get_entityName());c.c.info("Primaryid attribute is "+a),-1===r.indexOf(a)&&t.addAttribute(a,null)}else{c.c.info("Query expression or select token has no attributes, so adding all attributes to the query expression.");var u=Object(o.d)(n,t.get_entityName());for(var l in u){var g=u[l];$t(g.Type)&&!g.AttributeOf&&t.addAttribute(l,null)}}},convertToRetrieveOdataFormat:function(t,e,n){var r={};if(e.get_queryParameters()&&e.get_queryParameters()[p.c.GetOnlyRelatedEntity]&&Object(g.a)(e.get_queryParameters()[p.c.GetOnlyRelatedEntity].toString())){var i=new Array;if(t&&t.get_relatedEntities()&&t.get_relatedEntities().get_entityCollections()&&t.get_relatedEntities().get_entityCollections().length>0)t.get_relatedEntities().get_entityCollections()[0].get_value().get_entities().forEach((function(t){i.push(Kt.convertToOdataFormatResponse(t,null,n))}));r[p.b.Value]=i}else r=Kt.convertToOdataFormatResponse(t,e,n);return r},getPageNumber:function(t){var e=t&&t.get_skipToken()?Object(r.b)(t.get_skipToken()):1;return c.c.info("oDataqueryOptions has pageNumber is "+e),e},getPageSize:function(t,e){var n=e&&e<5e3?e:5e3;t&&t.get_top()&&t.get_top()>0&&n>t.get_top()&&(n=t.get_top());return c.c.info("oDataqueryOptions has maxPageSize is "+e+" and pageSize is "+n),n},getEntityFromRelationShip:function(t,e,n){var r=["schemaName","relationshipType"],i=t[r[0]];switch(t[r[1]]){case 2:return Object(s.x)(e,n,i).ReferencedEntity;case 0:return Object(s.B)(e,n,i).ReferencingEntity;case 1:var a=Object(s.u)(e,n,i);return a.Entity1LogicalName===n?a.Entity2LogicalName:a.Entity1LogicalName}return null},updateLinkExpressionWithFilterValues:function(t,e,n){t.get_linkedEntities().forEach((function(t){t.get_entityName()===e&&Kt.updateConditionsWithFilterValues(t.get_filterExpression(),e,n),Kt.updateLinkExpressionWithFilterValues(t,e,n)}))},updateConditionsWithFilterValues:function(t,e,n){t&&(t.get_conditions()&&t.get_conditions().forEach((function(t){t.get_entityName()===e&&(t.set_value(l.a.toString(l.a.fromLegacyGuid(n.get_identifier().Id))),t.set_operator("eq"))})),t.get_filterExpressions()&&t.get_filterExpressions().forEach((function(t){Kt.updateConditionsWithFilterValues(t,e,n)})))},retrieveMultipleRecordsFromNavProp:function(t,e,n,r){return r.dispatch(Object(h.f)(Kt.getEntityFromRelationShip(t,r.getState(),e.get_identifier().LogicalName),!0,[])).then((function(){var a=Kt.getRelationshipFetchXml(e.get_identifier().LogicalName,t,l.a.fromLegacyGuid(e.get_identifier().Id),r.getState());if(!a)throw c.c.error("Invalid Fetch Xml for navigation property "),new i.a(Object(u.a)(-7025),-7025);var o=Kt.createEntityQueryExpressionFromFetchXml(a);Kt.updateLinkExpressionWithFilterValues(o,e.get_identifier().LogicalName,e),Kt.addAttributeToEQE(o,n,r.getState());var s=new F.a(new Q.a(n.get_navigationProperty()),new L.a(o.get_entityName(),l.a.toLegacyGuid(l.a.newGuid())),""),g=Kt.createSqlfromEntityQueryExpression(o);return c.c.info("Sql generated from EQE of entity: "+o.get_entityName()+" with sql value: "+g),s.set_EntityLogicalName(o.get_entityName()),Yt(s,o,g),s.set_PageSize(5e3),r.dispatch(Object(f.a)(s,null))}),(function(t){return c.c.error("Offline.XrmOfflineUtils.retrieveMultipleRecordsFromNavProp: Entity Metadata could not be retrieved with error "+Object(a.e)(t)),Promise.reject(t)})).catch((function(t){return c.c.error("Offline.XrmOfflineUtils.retrieveMultipleRecordsFromNavProp: Multiple records could not be retrieved with error "+Object(a.e)(t)),Promise.reject(t)}))},getEntityMapFromQueryExpression:function t(e){var n;return e.get_linkedEntities().reduce((function(e,n){return Object.assign(e,t(n))}),((n={})[e.get_entityName()]=null,n))},createSqlfromFetchXMLAsync:function(t,e){var n=Kt.createEntityQueryExpressionFromFetchXml(e),r=Kt.getEntityMapFromQueryExpression(n);return t.dispatch(Object(h.e)(r)).then((function(){return Promise.resolve(Kt.createSqlfromEntityQueryExpression(n))})).catch((function(t){return c.c.error("createSqlfromFetchXMLAsync fails because all entities in fetch are not present: "+Object(a.e)(t)),Promise.reject(t)}))},createSqlfromFetchXMLSync:function(t,e,n){if(Object(Jt.l)(t,n))try{var r=Kt.createEntityQueryExpressionFromFetchXml(e);return Kt.createSqlfromEntityQueryExpression(r)}catch(t){return c.c.error("createSqlfromFetchXMLSync: Error While Generating Sql from fetch"),""}return""},parseResponseAsEntityReference:function(t,e){var n={};return n[p.b.Id]=Object(zt.c)(t).guid,n[p.b.LogicalName]=e,n}};function $t(t){switch(t){case"unknown":case"decimal":case"double":case"integer":case"memo":case"money":case"string":case"uniqueidentifier":case"bigint":case"owner":case"customer":case"lookup":case"datetime":case"picklist":case"state":case"status":case"boolean":case"entityname":return!0;default:return!1}}function Yt(t,e,n){t.set_ColumnSet(new T.a([])),t.set_ColumnNames(function t(e){return e.get_attributes().map((function(t){var n=e.get_Alias();return n?n+"."+t.get_name():t.get_name()})).concat(e.get_linkedEntities().reduce((function(e,n){return e.concat(t(n))}),[]))}(e)),t.get_DescriptorSet().updateDescriptorSet(B.a.Sql,n),t.set_FetchXmlForAliasedValues(function(t){var e=t.get_fetchXml();if(e)return Object(Ut.d)(e);return null}(e))}function Zt(t,e,n,r){var i=e&&e.get_fetchXml()&&e.get_fetchXml().length>0?Kt.createEntityQueryExpressionFromFetchXml(e.get_fetchXml()):Kt.createEntityQueryExpressionFromODataUri(r.getState(),t,e,n);Kt.addAttributeToEQE(i,null,r.getState());var o=Kt.getEntityMapFromQueryExpression(i);return r.dispatch(Object(h.e)(o)).then((function(){return r.dispatch(Object(f.a)(Kt.createQueryFromEntityQueryExpression(i,O.a.newGuid().toString()),null)).then((function(t){return Promise.resolve(Kt.convertToRetrieveMultipleOdataFormat(i,t,e,n,r))})).catch((function(t){return c.c.error("retrieveMultipleRecordAsyncAction fails"+Object(a.e)(t)),Promise.reject(t)}))})).catch((function(t){return c.c.error("retrieveEntities fails"+Object(a.e)(t)),Promise.reject(t)}))}function Ht(t,e,n,r,i){var u,g,p,d,h=n.get_select(),f=h&&h.get_attributeNames().length>0?h.get_attributeNames().map((function(e){return Object(Wt.d)(i.getState(),t,e)})):[],m=new Gt.a(t,new l.a(e)),O=new Array,v=Object(o.j)(i.getState(),t,f);if(Object.keys(v).forEach((function(t){var e=v[t];$t(e.Type)&&!e.AttributeOf&&O.push(t)})),0!==f.length){var j=Object(s.D)(i.getState(),t);-1===O.indexOf(j)&&O.push(j)}return i.dispatch((u=Gt.a.toLegacyEntityReference(m),g=new T.a(O),p=null,d=null,{type:"offline.retrieve.records",execute:function(t,e){return t.dispatch,t.getState,e.DataSource.retrieve(u,g,new y.a(b.a.NotCached,_.a.Local),p,d).nativePromise().then((function(t){return c.c.info("Able to successfully retrieve record from offline db"),Promise.resolve(t)})).catch((function(t){return c.c.error("DataSource.retrieve fails "+Object(a.e)(t)),Promise.reject(t)}))}})).then((function(t){return Kt.getRelatedEntities(t.clone(),n.get_expand(),r,i).then((function(t){return Promise.resolve(Kt.convertToRetrieveOdataFormat(t,n,i))})).catch((function(t){return c.c.error("getRelatedEntities fails "+Object(a.e)(t)),Promise.reject(t)}))})).catch((function(t){return c.c.error("DataSource.retrieve fails "+Object(a.e)(t)),Promise.reject(t)}))}},l8p4:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("GUnN"),i=n("kh6f"),a=n("fL8u"),o=n("Z55s"),s=n("Kn4q");function u(t,e){return{type:"offline.retrieve.multiple.records",execute:function(n,u){n.dispatch,n.getState;return u.DataSource.retrieveMultiple(t,new a.a(o.a.NotCached,s.a.Local),e).nativePromise().then((function(t){return i.c.info("Able to successfully retrieve multiple record from offline db"),Promise.resolve(t)})).catch((function(t){return i.c.error("Unable to Retrieve multiple record in offline db "+Object(r.e)(t)),Promise.reject(t)}))}}}}}]),window.bundleExecutionMarkers["scripts/es5/3.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();